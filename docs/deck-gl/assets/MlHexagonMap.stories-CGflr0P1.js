const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./index.es-B-rftL1C.js","./iframe-BT3yCmoB.js","./preload-helper-D9Z9MdNV.js","./iframe-DG6F43G8.css","./index-Dv7VPlJ0.js","./index-BRXCys0p.js"])))=>i.map(i=>d[i]);
import{j as K,P as q_,r as Nd}from"./index-Dv7VPlJ0.js";import{g as od,V as jw,r as ee,R as ht,a as eW,c as Op,b as Lb}from"./iframe-BT3yCmoB.js";import{_ as XC}from"./preload-helper-D9Z9MdNV.js";var aw={exports:{}};/**
 * MapLibre GL JS
 * @license 3-Clause BSD. Full text of license: https://github.com/maplibre/maplibre-gl-js/blob/v5.7.1/LICENSE.txt
 */var vie=aw.exports,q6;function _ie(){return q6||(q6=1,(function(t,e){(function(r,n){t.exports=n()})(vie,(function(){var r={},n={};function i(s,o,u){if(n[s]=u,s==="index"){var h="var sharedModule = {}; ("+n.shared+")(sharedModule); ("+n.worker+")(sharedModule);",f={};return n.shared(f),n.index(r,f),typeof window<"u"&&r.setWorkerUrl(window.URL.createObjectURL(new Blob([h],{type:"text/javascript"}))),r}}i("shared",["exports"],(function(s){function o(p,c,d,x){return new(d||(d=Promise))((function(T,D){function F(ae){try{X(x.next(ae))}catch(se){D(se)}}function V(ae){try{X(x.throw(ae))}catch(se){D(se)}}function X(ae){var se;ae.done?T(ae.value):(se=ae.value,se instanceof d?se:new d((function(ve){ve(se)}))).then(F,V)}X((x=x.apply(p,c||[])).next())}))}function u(p,c){this.x=p,this.y=c}function h(p){return p&&p.__esModule&&Object.prototype.hasOwnProperty.call(p,"default")?p.default:p}var f,g;typeof SuppressedError=="function"&&SuppressedError,u.prototype={clone(){return new u(this.x,this.y)},add(p){return this.clone()._add(p)},sub(p){return this.clone()._sub(p)},multByPoint(p){return this.clone()._multByPoint(p)},divByPoint(p){return this.clone()._divByPoint(p)},mult(p){return this.clone()._mult(p)},div(p){return this.clone()._div(p)},rotate(p){return this.clone()._rotate(p)},rotateAround(p,c){return this.clone()._rotateAround(p,c)},matMult(p){return this.clone()._matMult(p)},unit(){return this.clone()._unit()},perp(){return this.clone()._perp()},round(){return this.clone()._round()},mag(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals(p){return this.x===p.x&&this.y===p.y},dist(p){return Math.sqrt(this.distSqr(p))},distSqr(p){const c=p.x-this.x,d=p.y-this.y;return c*c+d*d},angle(){return Math.atan2(this.y,this.x)},angleTo(p){return Math.atan2(this.y-p.y,this.x-p.x)},angleWith(p){return this.angleWithSep(p.x,p.y)},angleWithSep(p,c){return Math.atan2(this.x*c-this.y*p,this.x*p+this.y*c)},_matMult(p){const c=p[2]*this.x+p[3]*this.y;return this.x=p[0]*this.x+p[1]*this.y,this.y=c,this},_add(p){return this.x+=p.x,this.y+=p.y,this},_sub(p){return this.x-=p.x,this.y-=p.y,this},_mult(p){return this.x*=p,this.y*=p,this},_div(p){return this.x/=p,this.y/=p,this},_multByPoint(p){return this.x*=p.x,this.y*=p.y,this},_divByPoint(p){return this.x/=p.x,this.y/=p.y,this},_unit(){return this._div(this.mag()),this},_perp(){const p=this.y;return this.y=this.x,this.x=-p,this},_rotate(p){const c=Math.cos(p),d=Math.sin(p),x=d*this.x+c*this.y;return this.x=c*this.x-d*this.y,this.y=x,this},_rotateAround(p,c){const d=Math.cos(p),x=Math.sin(p),T=c.y+x*(this.x-c.x)+d*(this.y-c.y);return this.x=c.x+d*(this.x-c.x)-x*(this.y-c.y),this.y=T,this},_round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},constructor:u},u.convert=function(p){if(p instanceof u)return p;if(Array.isArray(p))return new u(+p[0],+p[1]);if(p.x!==void 0&&p.y!==void 0)return new u(+p.x,+p.y);throw new Error("Expected [x, y] or {x, y} point format")};var b=(function(){if(g)return f;function p(c,d,x,T){this.cx=3*c,this.bx=3*(x-c)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*d,this.by=3*(T-d)-this.cy,this.ay=1-this.cy-this.by,this.p1x=c,this.p1y=d,this.p2x=x,this.p2y=T}return g=1,f=p,p.prototype={sampleCurveX:function(c){return((this.ax*c+this.bx)*c+this.cx)*c},sampleCurveY:function(c){return((this.ay*c+this.by)*c+this.cy)*c},sampleCurveDerivativeX:function(c){return(3*this.ax*c+2*this.bx)*c+this.cx},solveCurveX:function(c,d){if(d===void 0&&(d=1e-6),c<0)return 0;if(c>1)return 1;for(var x=c,T=0;T<8;T++){var D=this.sampleCurveX(x)-c;if(Math.abs(D)<d)return x;var F=this.sampleCurveDerivativeX(x);if(Math.abs(F)<1e-6)break;x-=D/F}var V=0,X=1;for(x=c,T=0;T<20&&(D=this.sampleCurveX(x),!(Math.abs(D-c)<d));T++)c>D?V=x:X=x,x=.5*(X-V)+V;return x},solve:function(c,d){return this.sampleCurveY(this.solveCurveX(c,d))}},f})(),v=h(b);let S,E;function P(){return S==null&&(S=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")&&typeof createImageBitmap=="function"),S}function k(){if(E==null&&(E=!1,P())){const c=new OffscreenCanvas(5,5).getContext("2d",{willReadFrequently:!0});if(c){for(let x=0;x<25;x++){const T=4*x;c.fillStyle=`rgb(${T},${T+1},${T+2})`,c.fillRect(x%5,Math.floor(x/5),1,1)}const d=c.getImageData(0,0,5,5).data;for(let x=0;x<100;x++)if(x%4!=3&&d[x]!==x){E=!0;break}}}return E||!1}var L=1e-6,O=typeof Float32Array<"u"?Float32Array:Array;function M(){var p=new O(9);return O!=Float32Array&&(p[1]=0,p[2]=0,p[3]=0,p[5]=0,p[6]=0,p[7]=0),p[0]=1,p[4]=1,p[8]=1,p}function z(p){return p[0]=1,p[1]=0,p[2]=0,p[3]=0,p[4]=0,p[5]=1,p[6]=0,p[7]=0,p[8]=0,p[9]=0,p[10]=1,p[11]=0,p[12]=0,p[13]=0,p[14]=0,p[15]=1,p}function B(){var p=new O(3);return O!=Float32Array&&(p[0]=0,p[1]=0,p[2]=0),p}function q(p){var c=p[0],d=p[1],x=p[2];return Math.sqrt(c*c+d*d+x*x)}function W(p,c,d){var x=new O(3);return x[0]=p,x[1]=c,x[2]=d,x}function G(p,c,d){return p[0]=c[0]+d[0],p[1]=c[1]+d[1],p[2]=c[2]+d[2],p}function ie(p,c,d){return p[0]=c[0]*d,p[1]=c[1]*d,p[2]=c[2]*d,p}function Q(p,c,d){var x=c[0],T=c[1],D=c[2],F=d[0],V=d[1],X=d[2];return p[0]=T*X-D*V,p[1]=D*F-x*X,p[2]=x*V-T*F,p}var H,ne=q;function oe(p,c,d){var x=c[0],T=c[1],D=c[2],F=c[3];return p[0]=d[0]*x+d[4]*T+d[8]*D+d[12]*F,p[1]=d[1]*x+d[5]*T+d[9]*D+d[13]*F,p[2]=d[2]*x+d[6]*T+d[10]*D+d[14]*F,p[3]=d[3]*x+d[7]*T+d[11]*D+d[15]*F,p}function ce(){var p=new O(4);return O!=Float32Array&&(p[0]=0,p[1]=0,p[2]=0),p[3]=1,p}function fe(p,c,d,x){var T=arguments.length>4&&arguments[4]!==void 0?arguments[4]:"zyx",D=Math.PI/360;c*=D,x*=D,d*=D;var F=Math.sin(c),V=Math.cos(c),X=Math.sin(d),ae=Math.cos(d),se=Math.sin(x),ve=Math.cos(x);switch(T){case"xyz":p[0]=F*ae*ve+V*X*se,p[1]=V*X*ve-F*ae*se,p[2]=V*ae*se+F*X*ve,p[3]=V*ae*ve-F*X*se;break;case"xzy":p[0]=F*ae*ve-V*X*se,p[1]=V*X*ve-F*ae*se,p[2]=V*ae*se+F*X*ve,p[3]=V*ae*ve+F*X*se;break;case"yxz":p[0]=F*ae*ve+V*X*se,p[1]=V*X*ve-F*ae*se,p[2]=V*ae*se-F*X*ve,p[3]=V*ae*ve+F*X*se;break;case"yzx":p[0]=F*ae*ve+V*X*se,p[1]=V*X*ve+F*ae*se,p[2]=V*ae*se-F*X*ve,p[3]=V*ae*ve-F*X*se;break;case"zxy":p[0]=F*ae*ve-V*X*se,p[1]=V*X*ve+F*ae*se,p[2]=V*ae*se+F*X*ve,p[3]=V*ae*ve-F*X*se;break;case"zyx":p[0]=F*ae*ve-V*X*se,p[1]=V*X*ve+F*ae*se,p[2]=V*ae*se-F*X*ve,p[3]=V*ae*ve+F*X*se;break;default:throw new Error("Unknown angle order "+T)}return p}function Me(){var p=new O(2);return O!=Float32Array&&(p[0]=0,p[1]=0),p}function me(p,c){var d=new O(2);return d[0]=p,d[1]=c,d}B(),H=new O(4),O!=Float32Array&&(H[0]=0,H[1]=0,H[2]=0,H[3]=0),B(),W(1,0,0),W(0,1,0),ce(),ce(),M(),Me();const we=8192;function Te(p,c,d){return c*(we/(p.tileSize*Math.pow(2,d-p.tileID.overscaledZ)))}function ke(p,c){return(p%c+c)%c}function he(p,c,d){return p*(1-d)+c*d}function Ee(p){if(p<=0)return 0;if(p>=1)return 1;const c=p*p,d=c*p;return 4*(p<.5?d:3*(p-c)+d-.75)}function xe(p,c,d,x){const T=new v(p,c,d,x);return D=>T.solve(D)}const Ne=xe(.25,.1,.25,1);function Oe(p,c,d){return Math.min(d,Math.max(c,p))}function $e(p,c,d){const x=d-c,T=((p-c)%x+x)%x+c;return T===c?d:T}function De(p,...c){for(const d of c)for(const x in d)p[x]=d[x];return p}let it=1;function Ye(p,c,d){const x={};for(const T in p)x[T]=c.call(this,p[T],T,p);return x}function rt(p,c,d){const x={};for(const T in p)c.call(this,p[T],T,p)&&(x[T]=p[T]);return x}function Ie(p){return Array.isArray(p)?p.map(Ie):typeof p=="object"&&p?Ye(p,Ie):p}const Mt={};function at(p){Mt[p]||(typeof console<"u"&&console.warn(p),Mt[p]=!0)}function je(p,c,d){return(d.y-p.y)*(c.x-p.x)>(c.y-p.y)*(d.x-p.x)}function Xt(p){return typeof WorkerGlobalScope<"u"&&p!==void 0&&p instanceof WorkerGlobalScope}let Yt=null;function pr(p){return typeof ImageBitmap<"u"&&p instanceof ImageBitmap}const vt="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";function yr(p,c,d,x,T){return o(this,void 0,void 0,(function*(){if(typeof VideoFrame>"u")throw new Error("VideoFrame not supported");const D=new VideoFrame(p,{timestamp:0});try{const F=D?.format;if(!F||!F.startsWith("BGR")&&!F.startsWith("RGB"))throw new Error(`Unrecognized format ${F}`);const V=F.startsWith("BGR"),X=new Uint8ClampedArray(x*T*4);if(yield D.copyTo(X,(function(ae,se,ve,Le,ze){const Ue=4*Math.max(-se,0),Ze=(Math.max(0,ve)-ve)*Le*4+Ue,st=4*Le,wt=Math.max(0,se),Wt=Math.max(0,ve);return{rect:{x:wt,y:Wt,width:Math.min(ae.width,se+Le)-wt,height:Math.min(ae.height,ve+ze)-Wt},layout:[{offset:Ze,stride:st}]}})(p,c,d,x,T)),V)for(let ae=0;ae<X.length;ae+=4){const se=X[ae];X[ae]=X[ae+2],X[ae+2]=se}return X}finally{D.close()}}))}let _r,cr;function Er(p,c,d,x){return p.addEventListener(c,d,x),{unsubscribe:()=>{p.removeEventListener(c,d,x)}}}function wr(p){return p*Math.PI/180}function er(p){return p/Math.PI*180}const lr={touchstart:!0,touchmove:!0,touchmoveWindow:!0,touchend:!0,touchcancel:!0},Ar={dblclick:!0,click:!0,mouseover:!0,mouseout:!0,mousedown:!0,mousemove:!0,mousemoveWindow:!0,mouseup:!0,mouseupWindow:!0,contextmenu:!0,wheel:!0},ir="AbortError";function nt(){return new Error(ir)}const _e={MAX_PARALLEL_IMAGE_REQUESTS:16,MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:8,MAX_TILE_CACHE_ZOOM_LEVELS:5,REGISTERED_PROTOCOLS:{},WORKER_URL:""};function be(p){return _e.REGISTERED_PROTOCOLS[p.substring(0,p.indexOf("://"))]}const qe="global-dispatcher";class Qe extends Error{constructor(c,d,x,T){super(`AJAXError: ${d} (${c}): ${x}`),this.status=c,this.statusText=d,this.url=x,this.body=T}}const ot=()=>Xt(self)?self.worker&&self.worker.referrer:(window.location.protocol==="blob:"?window.parent:window).location.href,et=function(p,c){if(/:\/\//.test(p.url)&&!/^https?:|^file:/.test(p.url)){const x=be(p.url);if(x)return x(p,c);if(Xt(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:p,targetMapId:qe},c)}if(!(/^file:/.test(d=p.url)||/^file:/.test(ot())&&!/^\w+:/.test(d))){if(fetch&&Request&&AbortController&&Object.prototype.hasOwnProperty.call(Request.prototype,"signal"))return(function(x,T){return o(this,void 0,void 0,(function*(){const D=new Request(x.url,{method:x.method||"GET",body:x.body,credentials:x.credentials,headers:x.headers,cache:x.cache,referrer:ot(),signal:T.signal});let F,V;x.type!=="json"||D.headers.has("Accept")||D.headers.set("Accept","application/json");try{F=yield fetch(D)}catch(ae){throw new Qe(0,ae.message,x.url,new Blob)}if(!F.ok){const ae=yield F.blob();throw new Qe(F.status,F.statusText,x.url,ae)}V=x.type==="arrayBuffer"||x.type==="image"?F.arrayBuffer():x.type==="json"?F.json():F.text();const X=yield V;if(T.signal.aborted)throw nt();return{data:X,cacheControl:F.headers.get("Cache-Control"),expires:F.headers.get("Expires")}}))})(p,c);if(Xt(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:p,mustQueue:!0,targetMapId:qe},c)}var d;return(function(x,T){return new Promise(((D,F)=>{var V;const X=new XMLHttpRequest;X.open(x.method||"GET",x.url,!0),x.type!=="arrayBuffer"&&x.type!=="image"||(X.responseType="arraybuffer");for(const ae in x.headers)X.setRequestHeader(ae,x.headers[ae]);x.type==="json"&&(X.responseType="text",!((V=x.headers)===null||V===void 0)&&V.Accept||X.setRequestHeader("Accept","application/json")),X.withCredentials=x.credentials==="include",X.onerror=()=>{F(new Error(X.statusText))},X.onload=()=>{if(!T.signal.aborted)if((X.status>=200&&X.status<300||X.status===0)&&X.response!==null){let ae=X.response;if(x.type==="json")try{ae=JSON.parse(X.response)}catch(se){return void F(se)}D({data:ae,cacheControl:X.getResponseHeader("Cache-Control"),expires:X.getResponseHeader("Expires")})}else{const ae=new Blob([X.response],{type:X.getResponseHeader("Content-Type")});F(new Qe(X.status,X.statusText,x.url,ae))}},T.signal.addEventListener("abort",(()=>{X.abort(),F(nt())})),X.send(x.body)}))})(p,c)};function Lt(p){if(!p||p.indexOf("://")<=0||p.indexOf("data:image/")===0||p.indexOf("blob:")===0)return!0;const c=new URL(p),d=window.location;return c.protocol===d.protocol&&c.host===d.host}function _t(p,c,d){d[p]&&d[p].indexOf(c)!==-1||(d[p]=d[p]||[],d[p].push(c))}function jt(p,c,d){if(d&&d[p]){const x=d[p].indexOf(c);x!==-1&&d[p].splice(x,1)}}class Jt{constructor(c,d={}){De(this,d),this.type=c}}class Kt extends Jt{constructor(c,d={}){super("error",De({error:c},d))}}class Rr{on(c,d){return this._listeners=this._listeners||{},_t(c,d,this._listeners),{unsubscribe:()=>{this.off(c,d)}}}off(c,d){return jt(c,d,this._listeners),jt(c,d,this._oneTimeListeners),this}once(c,d){return d?(this._oneTimeListeners=this._oneTimeListeners||{},_t(c,d,this._oneTimeListeners),this):new Promise((x=>this.once(c,x)))}fire(c,d){typeof c=="string"&&(c=new Jt(c,d||{}));const x=c.type;if(this.listens(x)){c.target=this;const T=this._listeners&&this._listeners[x]?this._listeners[x].slice():[];for(const V of T)V.call(this,c);const D=this._oneTimeListeners&&this._oneTimeListeners[x]?this._oneTimeListeners[x].slice():[];for(const V of D)jt(x,V,this._oneTimeListeners),V.call(this,c);const F=this._eventedParent;F&&(De(c,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),F.fire(c))}else c instanceof Kt&&console.error(c.error);return this}listens(c){return this._listeners&&this._listeners[c]&&this._listeners[c].length>0||this._oneTimeListeners&&this._oneTimeListeners[c]&&this._oneTimeListeners[c].length>0||this._eventedParent&&this._eventedParent.listens(c)}setEventedParent(c,d){return this._eventedParent=c,this._eventedParentData=d,this}}var bt={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},centerAltitude:{type:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},roll:{type:"number",default:0,units:"degrees"},state:{type:"state",default:{}},light:{type:"light"},sky:{type:"sky"},projection:{type:"projection"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"sprite"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{},custom:{}},default:"mapbox"},redFactor:{type:"number",default:1},blueFactor:{type:"number",default:1},greenFactor:{type:"number",default:1},baseShift:{type:"number",default:0},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{required:!0,type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},"color-relief":{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_color-relief","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"padding",default:[2],units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-variable-anchor-offset":{type:"variableAnchorOffsetCollection",requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_color-relief":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},sky:{"sky-color":{type:"color","property-type":"data-constant",default:"#88C6FC",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-ground-blend":{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-fog-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"sky-horizon-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"atmosphere-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},terrain:{source:{type:"string",required:!0},exaggeration:{type:"number",minimum:0,default:1}},projection:{type:{type:"projectionDefinition",default:"mercator","property-type":"data-constant",transition:!1,expression:{interpolated:!0,parameters:["zoom"]}}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_color-relief","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"numberArray",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-altitude":{type:"numberArray",default:45,minimum:0,maximum:90,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"colorArray",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"colorArray",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-method":{type:"enum",values:{standard:{},basic:{},combined:{},igor:{},multidirectional:{}},default:"standard",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},"paint_color-relief":{"color-relief-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"color-relief-color":{type:"color",transition:!1,expression:{interpolated:!0,parameters:["elevation"]},"property-type":"color-ramp"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}};const Tr=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function Ur(p,c){const d={};for(const x in p)x!=="ref"&&(d[x]=p[x]);return Tr.forEach((x=>{x in c&&(d[x]=c[x])})),d}function Gr(p,c){if(Array.isArray(p)){if(!Array.isArray(c)||p.length!==c.length)return!1;for(let d=0;d<p.length;d++)if(!Gr(p[d],c[d]))return!1;return!0}if(typeof p=="object"&&p!==null&&c!==null){if(typeof c!="object"||Object.keys(p).length!==Object.keys(c).length)return!1;for(const d in p)if(!Gr(p[d],c[d]))return!1;return!0}return p===c}function Jr(p,c){p.push(c)}function ar(p,c,d){Jr(d,{command:"addSource",args:[p,c[p]]})}function ti(p,c,d){Jr(c,{command:"removeSource",args:[p]}),d[p]=!0}function un(p,c,d,x){ti(p,d,x),ar(p,c,d)}function ri(p,c,d){let x;for(x in p[d])if(Object.prototype.hasOwnProperty.call(p[d],x)&&x!=="data"&&!Gr(p[d][x],c[d][x]))return!1;for(x in c[d])if(Object.prototype.hasOwnProperty.call(c[d],x)&&x!=="data"&&!Gr(p[d][x],c[d][x]))return!1;return!0}function Ae(p,c,d,x,T,D){p=p||{},c=c||{};for(const F in p)Object.prototype.hasOwnProperty.call(p,F)&&(Gr(p[F],c[F])||d.push({command:D,args:[x,F,c[F],T]}));for(const F in c)Object.prototype.hasOwnProperty.call(c,F)&&!Object.prototype.hasOwnProperty.call(p,F)&&(Gr(p[F],c[F])||d.push({command:D,args:[x,F,c[F],T]}))}function Be(p){return p.id}function mt(p,c){return p[c.id]=c,p}class pt{constructor(c,d,x,T){this.message=(c?`${c}: `:"")+x,T&&(this.identifier=T),d!=null&&d.__line__&&(this.line=d.__line__)}}function Ir(p,...c){for(const d of c)for(const x in d)p[x]=d[x];return p}class Fr extends Error{constructor(c,d){super(d),this.message=d,this.key=c}}class qn{constructor(c,d=[]){this.parent=c,this.bindings={};for(const[x,T]of d)this.bindings[x]=T}concat(c){return new qn(this,c)}get(c){if(this.bindings[c])return this.bindings[c];if(this.parent)return this.parent.get(c);throw new Error(`${c} not found in scope.`)}has(c){return!!this.bindings[c]||!!this.parent&&this.parent.has(c)}}const Oi={kind:"null"},zr={kind:"number"},bn={kind:"string"},Tn={kind:"boolean"},Mi={kind:"color"},pi={kind:"projectionDefinition"},Wi={kind:"object"},Fn={kind:"value"},Ia={kind:"collator"},ma={kind:"formatted"},Gi={kind:"padding"},Ka={kind:"colorArray"},xa={kind:"numberArray"},Ui={kind:"resolvedImage"},oo={kind:"variableAnchorOffsetCollection"};function Ja(p,c){return{kind:"array",itemType:p,N:c}}function Hn(p){if(p.kind==="array"){const c=Hn(p.itemType);return typeof p.N=="number"?`array<${c}, ${p.N}>`:p.itemType.kind==="value"?"array":`array<${c}>`}return p.kind}const bu=[Oi,zr,bn,Tn,Mi,pi,ma,Wi,Ja(Fn),Gi,xa,Ka,Ui,oo];function ru(p,c){if(c.kind==="error")return null;if(p.kind==="array"){if(c.kind==="array"&&(c.N===0&&c.itemType.kind==="value"||!ru(p.itemType,c.itemType))&&(typeof p.N!="number"||p.N===c.N))return null}else{if(p.kind===c.kind)return null;if(p.kind==="value"){for(const d of bu)if(!ru(d,c))return null}}return`Expected ${Hn(p)} but found ${Hn(c)} instead.`}function Pa(p,c){return c.some((d=>d.kind===p.kind))}function wa(p,c){return c.some((d=>d==="null"?p===null:d==="array"?Array.isArray(p):d==="object"?p&&!Array.isArray(p)&&typeof p=="object":d===typeof p))}function Wo(p,c){return p.kind==="array"&&c.kind==="array"?p.itemType.kind===c.itemType.kind&&typeof p.N=="number":p.kind===c.kind}const No=.96422,ls=.82521,kc=4/29,Sa=6/29,Mc=3*Sa*Sa,Rc=Sa*Sa*Sa,vl=Math.PI/180,Qs=180/Math.PI;function Ha(p){return(p%=360)<0&&(p+=360),p}function so([p,c,d,x]){let T,D;const F=el((.2225045*(p=ka(p))+.7168786*(c=ka(c))+.0606169*(d=ka(d)))/1);p===c&&c===d?T=D=F:(T=el((.4360747*p+.3850649*c+.1430804*d)/No),D=el((.0139322*p+.0971045*c+.7141733*d)/ls));const V=116*F-16;return[V<0?0:V,500*(T-F),200*(F-D),x]}function ka(p){return p<=.04045?p/12.92:Math.pow((p+.055)/1.055,2.4)}function el(p){return p>Rc?Math.pow(p,1/3):p/Mc+kc}function xu([p,c,d,x]){let T=(p+16)/116,D=isNaN(c)?T:T+c/500,F=isNaN(d)?T:T-d/200;return T=1*J(T),D=No*J(D),F=ls*J(F),[wu(3.1338561*D-1.6168667*T-.4906146*F),wu(-.9787684*D+1.9161415*T+.033454*F),wu(.0719453*D-.2289914*T+1.4052427*F),x]}function wu(p){return(p=p<=.00304?12.92*p:1.055*Math.pow(p,1/2.4)-.055)<0?0:p>1?1:p}function J(p){return p>Sa?p*p*p:Mc*(p-kc)}const pe=Object.hasOwn||function(p,c){return Object.prototype.hasOwnProperty.call(p,c)};function Xe(p,c){return pe(p,c)?p[c]:void 0}function Tt(p){return parseInt(p.padEnd(2,p),16)/255}function Nt(p,c){return kt(c?p/100:p,0,1)}function kt(p,c,d){return Math.min(Math.max(c,p),d)}function Gt(p){return!p.some(Number.isNaN)}const $r={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};function Yr(p,c,d){return p+d*(c-p)}function Hr(p,c,d){return p.map(((x,T)=>Yr(x,c[T],d)))}class kr{constructor(c,d,x,T=1,D=!0){this.r=c,this.g=d,this.b=x,this.a=T,D||(this.r*=T,this.g*=T,this.b*=T,T||this.overwriteGetter("rgb",[c,d,x,T]))}static parse(c){if(c instanceof kr)return c;if(typeof c!="string")return;const d=(function(x){if((x=x.toLowerCase().trim())==="transparent")return[0,0,0,0];const T=Xe($r,x);if(T){const[F,V,X]=T;return[F/255,V/255,X/255,1]}if(x.startsWith("#")&&/^#(?:[0-9a-f]{3,4}|[0-9a-f]{6}|[0-9a-f]{8})$/.test(x)){const F=x.length<6?1:2;let V=1;return[Tt(x.slice(V,V+=F)),Tt(x.slice(V,V+=F)),Tt(x.slice(V,V+=F)),Tt(x.slice(V,V+F)||"ff")]}if(x.startsWith("rgb")){const F=x.match(/^rgba?\(\s*([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(F){const[V,X,ae,se,ve,Le,ze,Ue,Ze,st,wt,Wt]=F,Rt=[se||" ",ze||" ",st].join("");if(Rt==="  "||Rt==="  /"||Rt===",,"||Rt===",,,"){const Ft=[ae,Le,Ze].join(""),gr=Ft==="%%%"?100:Ft===""?255:0;if(gr){const Cr=[kt(+X/gr,0,1),kt(+ve/gr,0,1),kt(+Ue/gr,0,1),wt?Nt(+wt,Wt):1];if(Gt(Cr))return Cr}}return}}const D=x.match(/^hsla?\(\s*([\de.+-]+)(?:deg)?(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(D){const[F,V,X,ae,se,ve,Le,ze,Ue]=D,Ze=[X||" ",se||" ",Le].join("");if(Ze==="  "||Ze==="  /"||Ze===",,"||Ze===",,,"){const st=[+V,kt(+ae,0,100),kt(+ve,0,100),ze?Nt(+ze,Ue):1];if(Gt(st))return(function([wt,Wt,Rt,Ft]){function gr(Cr){const Wr=(Cr+wt/30)%12,yn=Wt*Math.min(Rt,1-Rt);return Rt-yn*Math.max(-1,Math.min(Wr-3,9-Wr,1))}return wt=Ha(wt),Wt/=100,Rt/=100,[gr(0),gr(8),gr(4),Ft]})(st)}}})(c);return d?new kr(...d,!1):void 0}get rgb(){const{r:c,g:d,b:x,a:T}=this,D=T||1/0;return this.overwriteGetter("rgb",[c/D,d/D,x/D,T])}get hcl(){return this.overwriteGetter("hcl",(function(c){const[d,x,T,D]=so(c),F=Math.sqrt(x*x+T*T);return[Math.round(1e4*F)?Ha(Math.atan2(T,x)*Qs):NaN,F,d,D]})(this.rgb))}get lab(){return this.overwriteGetter("lab",so(this.rgb))}overwriteGetter(c,d){return Object.defineProperty(this,c,{value:d}),d}toString(){const[c,d,x,T]=this.rgb;return`rgba(${[c,d,x].map((D=>Math.round(255*D))).join(",")},${T})`}static interpolate(c,d,x,T="rgb"){switch(T){case"rgb":{const[D,F,V,X]=Hr(c.rgb,d.rgb,x);return new kr(D,F,V,X,!1)}case"hcl":{const[D,F,V,X]=c.hcl,[ae,se,ve,Le]=d.hcl;let ze,Ue;if(isNaN(D)||isNaN(ae))isNaN(D)?isNaN(ae)?ze=NaN:(ze=ae,V!==1&&V!==0||(Ue=se)):(ze=D,ve!==1&&ve!==0||(Ue=F));else{let Rt=ae-D;ae>D&&Rt>180?Rt-=360:ae<D&&D-ae>180&&(Rt+=360),ze=D+x*Rt}const[Ze,st,wt,Wt]=(function([Rt,Ft,gr,Cr]){return Rt=isNaN(Rt)?0:Rt*vl,xu([gr,Math.cos(Rt)*Ft,Math.sin(Rt)*Ft,Cr])})([ze,Ue??Yr(F,se,x),Yr(V,ve,x),Yr(X,Le,x)]);return new kr(Ze,st,wt,Wt,!1)}case"lab":{const[D,F,V,X]=xu(Hr(c.lab,d.lab,x));return new kr(D,F,V,X,!1)}}}}kr.black=new kr(0,0,0,1),kr.white=new kr(1,1,1,1),kr.transparent=new kr(0,0,0,0),kr.red=new kr(1,0,0,1);class Qr{constructor(c,d,x){this.sensitivity=c?d?"variant":"case":d?"accent":"base",this.locale=x,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(c,d){return this.collator.compare(c,d)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}const Qn=["bottom","center","top"];class Ei{constructor(c,d,x,T,D,F){this.text=c,this.image=d,this.scale=x,this.fontStack=T,this.textColor=D,this.verticalAlign=F}}class En{constructor(c){this.sections=c}static fromString(c){return new En([new Ei(c,null,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some((c=>c.text.length!==0||c.image&&c.image.name.length!==0))}static factory(c){return c instanceof En?c:En.fromString(c)}toString(){return this.sections.length===0?"":this.sections.map((c=>c.text)).join("")}}class pn{constructor(c){this.values=c.slice()}static parse(c){if(c instanceof pn)return c;if(typeof c=="number")return new pn([c,c,c,c]);if(Array.isArray(c)&&!(c.length<1||c.length>4)){for(const d of c)if(typeof d!="number")return;switch(c.length){case 1:c=[c[0],c[0],c[0],c[0]];break;case 2:c=[c[0],c[1],c[0],c[1]];break;case 3:c=[c[0],c[1],c[2],c[1]]}return new pn(c)}}toString(){return JSON.stringify(this.values)}static interpolate(c,d,x){return new pn(Hr(c.values,d.values,x))}}class Mr{constructor(c){this.values=c.slice()}static parse(c){if(c instanceof Mr)return c;if(typeof c=="number")return new Mr([c]);if(Array.isArray(c)){for(const d of c)if(typeof d!="number")return;return new Mr(c)}}toString(){return JSON.stringify(this.values)}static interpolate(c,d,x){return new Mr(Hr(c.values,d.values,x))}}class cn{constructor(c){this.values=c.slice()}static parse(c){if(c instanceof cn)return c;if(typeof c=="string"){const x=kr.parse(c);return x?new cn([x]):void 0}if(!Array.isArray(c))return;const d=[];for(const x of c){if(typeof x!="string")return;const T=kr.parse(x);if(!T)return;d.push(T)}return new cn(d)}toString(){return JSON.stringify(this.values)}static interpolate(c,d,x,T="rgb"){const D=[];if(c.values.length!=d.values.length)throw new Error(`colorArray: Arrays have mismatched length (${c.values.length} vs. ${d.values.length}), cannot interpolate.`);for(let F=0;F<c.values.length;F++)D.push(kr.interpolate(c.values[F],d.values[F],x,T));return new cn(D)}}class Wn extends Error{constructor(c){super(c),this.name="RuntimeError"}toJSON(){return this.message}}const Ma=new Set(["center","left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"]);class Ci{constructor(c){this.values=c.slice()}static parse(c){if(c instanceof Ci)return c;if(Array.isArray(c)&&!(c.length<1)&&c.length%2==0){for(let d=0;d<c.length;d+=2){const x=c[d],T=c[d+1];if(typeof x!="string"||!Ma.has(x)||!Array.isArray(T)||T.length!==2||typeof T[0]!="number"||typeof T[1]!="number")return}return new Ci(c)}}toString(){return JSON.stringify(this.values)}static interpolate(c,d,x){const T=c.values,D=d.values;if(T.length!==D.length)throw new Wn(`Cannot interpolate values of different length. from: ${c.toString()}, to: ${d.toString()}`);const F=[];for(let V=0;V<T.length;V+=2){if(T[V]!==D[V])throw new Wn(`Cannot interpolate values containing mismatched anchors. from[${V}]: ${T[V]}, to[${V}]: ${D[V]}`);F.push(T[V]);const[X,ae]=T[V+1],[se,ve]=D[V+1];F.push([Yr(X,se,x),Yr(ae,ve,x)])}return new Ci(F)}}class Ra{constructor(c){this.name=c.name,this.available=c.available}toString(){return this.name}static fromString(c){return c?new Ra({name:c,available:!1}):null}}class gi{constructor(c,d,x){this.from=c,this.to=d,this.transition=x}static interpolate(c,d,x){return new gi(c,d,x)}static parse(c){return c instanceof gi?c:Array.isArray(c)&&c.length===3&&typeof c[0]=="string"&&typeof c[1]=="string"&&typeof c[2]=="number"?new gi(c[0],c[1],c[2]):typeof c=="object"&&typeof c.from=="string"&&typeof c.to=="string"&&typeof c.transition=="number"?new gi(c.from,c.to,c.transition):typeof c=="string"?new gi(c,c,1):void 0}}function jn(p,c,d,x){return typeof p=="number"&&p>=0&&p<=255&&typeof c=="number"&&c>=0&&c<=255&&typeof d=="number"&&d>=0&&d<=255?x===void 0||typeof x=="number"&&x>=0&&x<=1?null:`Invalid rgba value [${[p,c,d,x].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof x=="number"?[p,c,d,x]:[p,c,d]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function us(p){if(p===null||typeof p=="string"||typeof p=="boolean"||typeof p=="number"||p instanceof gi||p instanceof kr||p instanceof Qr||p instanceof En||p instanceof pn||p instanceof Mr||p instanceof cn||p instanceof Ci||p instanceof Ra)return!0;if(Array.isArray(p)){for(const c of p)if(!us(c))return!1;return!0}if(typeof p=="object"){for(const c in p)if(!us(p[c]))return!1;return!0}return!1}function Un(p){if(p===null)return Oi;if(typeof p=="string")return bn;if(typeof p=="boolean")return Tn;if(typeof p=="number")return zr;if(p instanceof kr)return Mi;if(p instanceof gi)return pi;if(p instanceof Qr)return Ia;if(p instanceof En)return ma;if(p instanceof pn)return Gi;if(p instanceof Mr)return xa;if(p instanceof cn)return Ka;if(p instanceof Ci)return oo;if(p instanceof Ra)return Ui;if(Array.isArray(p)){const c=p.length;let d;for(const x of p){const T=Un(x);if(d){if(d===T)continue;d=Fn;break}d=T}return Ja(d||Fn,c)}return Wi}function Nn(p){const c=typeof p;return p===null?"":c==="string"||c==="number"||c==="boolean"?String(p):p instanceof kr||p instanceof gi||p instanceof En||p instanceof pn||p instanceof Mr||p instanceof cn||p instanceof Ci||p instanceof Ra?p.toString():JSON.stringify(p)}class Go{constructor(c,d){this.type=c,this.value=d}static parse(c,d){if(c.length!==2)return d.error(`'literal' expression requires exactly one argument, but found ${c.length-1} instead.`);if(!us(c[1]))return d.error("invalid value");const x=c[1];let T=Un(x);const D=d.expectedType;return T.kind!=="array"||T.N!==0||!D||D.kind!=="array"||typeof D.N=="number"&&D.N!==0||(T=D),new Go(T,x)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}}const Yn={string:bn,number:zr,boolean:Tn,object:Wi};class Do{constructor(c,d){this.type=c,this.args=d}static parse(c,d){if(c.length<2)return d.error("Expected at least one argument.");let x,T=1;const D=c[0];if(D==="array"){let V,X;if(c.length>2){const ae=c[1];if(typeof ae!="string"||!(ae in Yn)||ae==="object")return d.error('The item type argument of "array" must be one of string, number, boolean',1);V=Yn[ae],T++}else V=Fn;if(c.length>3){if(c[2]!==null&&(typeof c[2]!="number"||c[2]<0||c[2]!==Math.floor(c[2])))return d.error('The length argument to "array" must be a positive integer literal',2);X=c[2],T++}x=Ja(V,X)}else{if(!Yn[D])throw new Error(`Types doesn't contain name = ${D}`);x=Yn[D]}const F=[];for(;T<c.length;T++){const V=d.parse(c[T],T,Fn);if(!V)return null;F.push(V)}return new Do(x,F)}evaluate(c){for(let d=0;d<this.args.length;d++){const x=this.args[d].evaluate(c);if(!ru(this.type,Un(x)))return x;if(d===this.args.length-1)throw new Wn(`Expected value to be of type ${Hn(this.type)}, but found ${Hn(Un(x))} instead.`)}throw new Error}eachChild(c){this.args.forEach(c)}outputDefined(){return this.args.every((c=>c.outputDefined()))}}const To={"to-boolean":Tn,"to-color":Mi,"to-number":zr,"to-string":bn};class Xo{constructor(c,d){this.type=c,this.args=d}static parse(c,d){if(c.length<2)return d.error("Expected at least one argument.");const x=c[0];if(!To[x])throw new Error(`Can't parse ${x} as it is not part of the known types`);if((x==="to-boolean"||x==="to-string")&&c.length!==2)return d.error("Expected one argument.");const T=To[x],D=[];for(let F=1;F<c.length;F++){const V=d.parse(c[F],F,Fn);if(!V)return null;D.push(V)}return new Xo(T,D)}evaluate(c){switch(this.type.kind){case"boolean":return!!this.args[0].evaluate(c);case"color":{let d,x;for(const T of this.args){if(d=T.evaluate(c),x=null,d instanceof kr)return d;if(typeof d=="string"){const D=c.parseColor(d);if(D)return D}else if(Array.isArray(d)&&(x=d.length<3||d.length>4?`Invalid rgba value ${JSON.stringify(d)}: expected an array containing either three or four numeric values.`:jn(d[0],d[1],d[2],d[3]),!x))return new kr(d[0]/255,d[1]/255,d[2]/255,d[3])}throw new Wn(x||`Could not parse color from value '${typeof d=="string"?d:JSON.stringify(d)}'`)}case"padding":{let d;for(const x of this.args){d=x.evaluate(c);const T=pn.parse(d);if(T)return T}throw new Wn(`Could not parse padding from value '${typeof d=="string"?d:JSON.stringify(d)}'`)}case"numberArray":{let d;for(const x of this.args){d=x.evaluate(c);const T=Mr.parse(d);if(T)return T}throw new Wn(`Could not parse numberArray from value '${typeof d=="string"?d:JSON.stringify(d)}'`)}case"colorArray":{let d;for(const x of this.args){d=x.evaluate(c);const T=cn.parse(d);if(T)return T}throw new Wn(`Could not parse colorArray from value '${typeof d=="string"?d:JSON.stringify(d)}'`)}case"variableAnchorOffsetCollection":{let d;for(const x of this.args){d=x.evaluate(c);const T=Ci.parse(d);if(T)return T}throw new Wn(`Could not parse variableAnchorOffsetCollection from value '${typeof d=="string"?d:JSON.stringify(d)}'`)}case"number":{let d=null;for(const x of this.args){if(d=x.evaluate(c),d===null)return 0;const T=Number(d);if(!isNaN(T))return T}throw new Wn(`Could not convert ${JSON.stringify(d)} to number.`)}case"formatted":return En.fromString(Nn(this.args[0].evaluate(c)));case"resolvedImage":return Ra.fromString(Nn(this.args[0].evaluate(c)));case"projectionDefinition":return this.args[0].evaluate(c);default:return Nn(this.args[0].evaluate(c))}}eachChild(c){this.args.forEach(c)}outputDefined(){return this.args.every((c=>c.outputDefined()))}}const tl=["Unknown","Point","LineString","Polygon"];class nu{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache=new Map,this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?tl[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(c){let d=this._parseColorCache.get(c);return d||(d=kr.parse(c),this._parseColorCache.set(c,d)),d}}class _l{constructor(c,d,x=[],T,D=new qn,F=[]){this.registry=c,this.path=x,this.key=x.map((V=>`[${V}]`)).join(""),this.scope=D,this.errors=F,this.expectedType=T,this._isConstant=d}parse(c,d,x,T,D={}){return d?this.concat(d,x,T)._parse(c,D):this._parse(c,D)}_parse(c,d){function x(T,D,F){return F==="assert"?new Do(D,[T]):F==="coerce"?new Xo(D,[T]):T}if(c!==null&&typeof c!="string"&&typeof c!="boolean"&&typeof c!="number"||(c=["literal",c]),Array.isArray(c)){if(c.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const T=c[0];if(typeof T!="string")return this.error(`Expression name must be a string, but found ${typeof T} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const D=this.registry[T];if(D){let F=D.parse(c,this);if(!F)return null;if(this.expectedType){const V=this.expectedType,X=F.type;if(V.kind!=="string"&&V.kind!=="number"&&V.kind!=="boolean"&&V.kind!=="object"&&V.kind!=="array"||X.kind!=="value"){if(V.kind==="projectionDefinition"&&["string","array"].includes(X.kind)||["color","formatted","resolvedImage"].includes(V.kind)&&["value","string"].includes(X.kind)||["padding","numberArray"].includes(V.kind)&&["value","number","array"].includes(X.kind)||V.kind==="colorArray"&&["value","string","array"].includes(X.kind)||V.kind==="variableAnchorOffsetCollection"&&["value","array"].includes(X.kind))F=x(F,V,d.typeAnnotation||"coerce");else if(this.checkSubtype(V,X))return null}else F=x(F,V,d.typeAnnotation||"assert")}if(!(F instanceof Go)&&F.type.kind!=="resolvedImage"&&this._isConstant(F)){const V=new nu;try{F=new Go(F.type,F.evaluate(V))}catch(X){return this.error(X.message),null}}return F}return this.error(`Unknown expression "${T}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(c===void 0?"'undefined' value invalid. Use null instead.":typeof c=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof c} instead.`)}concat(c,d,x){const T=typeof c=="number"?this.path.concat(c):this.path,D=x?this.scope.concat(x):this.scope;return new _l(this.registry,this._isConstant,T,d||null,D,this.errors)}error(c,...d){const x=`${this.key}${d.map((T=>`[${T}]`)).join("")}`;this.errors.push(new Fr(x,c))}checkSubtype(c,d){const x=ru(c,d);return x&&this.error(x),x}}class Co{constructor(c,d){this.type=d.type,this.bindings=[].concat(c),this.result=d}evaluate(c){return this.result.evaluate(c)}eachChild(c){for(const d of this.bindings)c(d[1]);c(this.result)}static parse(c,d){if(c.length<4)return d.error(`Expected at least 3 arguments, but found ${c.length-1} instead.`);const x=[];for(let D=1;D<c.length-1;D+=2){const F=c[D];if(typeof F!="string")return d.error(`Expected string, but found ${typeof F} instead.`,D);if(/[^a-zA-Z0-9_]/.test(F))return d.error("Variable names must contain only alphanumeric characters or '_'.",D);const V=d.parse(c[D+1],D+1);if(!V)return null;x.push([F,V])}const T=d.parse(c[c.length-1],c.length-1,d.expectedType,x);return T?new Co(x,T):null}outputDefined(){return this.result.outputDefined()}}class rl{constructor(c,d){this.type=d.type,this.name=c,this.boundExpression=d}static parse(c,d){if(c.length!==2||typeof c[1]!="string")return d.error("'var' expression requires exactly one string literal argument.");const x=c[1];return d.scope.has(x)?new rl(x,d.scope.get(x)):d.error(`Unknown variable "${x}". Make sure "${x}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(c){return this.boundExpression.evaluate(c)}eachChild(){}outputDefined(){return!1}}class bl{constructor(c,d,x){this.type=c,this.index=d,this.input=x}static parse(c,d){if(c.length!==3)return d.error(`Expected 2 arguments, but found ${c.length-1} instead.`);const x=d.parse(c[1],1,zr),T=d.parse(c[2],2,Ja(d.expectedType||Fn));return x&&T?new bl(T.type.itemType,x,T):null}evaluate(c){const d=this.index.evaluate(c),x=this.input.evaluate(c);if(d<0)throw new Wn(`Array index out of bounds: ${d} < 0.`);if(d>=x.length)throw new Wn(`Array index out of bounds: ${d} > ${x.length-1}.`);if(d!==Math.floor(d))throw new Wn(`Array index must be an integer, but found ${d} instead.`);return x[d]}eachChild(c){c(this.index),c(this.input)}outputDefined(){return!1}}class lo{constructor(c,d){this.type=Tn,this.needle=c,this.haystack=d}static parse(c,d){if(c.length!==3)return d.error(`Expected 2 arguments, but found ${c.length-1} instead.`);const x=d.parse(c[1],1,Fn),T=d.parse(c[2],2,Fn);return x&&T?Pa(x.type,[Tn,bn,zr,Oi,Fn])?new lo(x,T):d.error(`Expected first argument to be of type boolean, string, number or null, but found ${Hn(x.type)} instead`):null}evaluate(c){const d=this.needle.evaluate(c),x=this.haystack.evaluate(c);if(!x)return!1;if(!wa(d,["boolean","string","number","null"]))throw new Wn(`Expected first argument to be of type boolean, string, number or null, but found ${Hn(Un(d))} instead.`);if(!wa(x,["string","array"]))throw new Wn(`Expected second argument to be of type array or string, but found ${Hn(Un(x))} instead.`);return x.indexOf(d)>=0}eachChild(c){c(this.needle),c(this.haystack)}outputDefined(){return!0}}class uo{constructor(c,d,x){this.type=zr,this.needle=c,this.haystack=d,this.fromIndex=x}static parse(c,d){if(c.length<=2||c.length>=5)return d.error(`Expected 3 or 4 arguments, but found ${c.length-1} instead.`);const x=d.parse(c[1],1,Fn),T=d.parse(c[2],2,Fn);if(!x||!T)return null;if(!Pa(x.type,[Tn,bn,zr,Oi,Fn]))return d.error(`Expected first argument to be of type boolean, string, number or null, but found ${Hn(x.type)} instead`);if(c.length===4){const D=d.parse(c[3],3,zr);return D?new uo(x,T,D):null}return new uo(x,T)}evaluate(c){const d=this.needle.evaluate(c),x=this.haystack.evaluate(c);if(!wa(d,["boolean","string","number","null"]))throw new Wn(`Expected first argument to be of type boolean, string, number or null, but found ${Hn(Un(d))} instead.`);let T;if(this.fromIndex&&(T=this.fromIndex.evaluate(c)),wa(x,["string"])){const D=x.indexOf(d,T);return D===-1?-1:[...x.slice(0,D)].length}if(wa(x,["array"]))return x.indexOf(d,T);throw new Wn(`Expected second argument to be of type array or string, but found ${Hn(Un(x))} instead.`)}eachChild(c){c(this.needle),c(this.haystack),this.fromIndex&&c(this.fromIndex)}outputDefined(){return!1}}class na{constructor(c,d,x,T,D,F){this.inputType=c,this.type=d,this.input=x,this.cases=T,this.outputs=D,this.otherwise=F}static parse(c,d){if(c.length<5)return d.error(`Expected at least 4 arguments, but found only ${c.length-1}.`);if(c.length%2!=1)return d.error("Expected an even number of arguments.");let x,T;d.expectedType&&d.expectedType.kind!=="value"&&(T=d.expectedType);const D={},F=[];for(let ae=2;ae<c.length-1;ae+=2){let se=c[ae];const ve=c[ae+1];Array.isArray(se)||(se=[se]);const Le=d.concat(ae);if(se.length===0)return Le.error("Expected at least one branch label.");for(const Ue of se){if(typeof Ue!="number"&&typeof Ue!="string")return Le.error("Branch labels must be numbers or strings.");if(typeof Ue=="number"&&Math.abs(Ue)>Number.MAX_SAFE_INTEGER)return Le.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof Ue=="number"&&Math.floor(Ue)!==Ue)return Le.error("Numeric branch labels must be integer values.");if(x){if(Le.checkSubtype(x,Un(Ue)))return null}else x=Un(Ue);if(D[String(Ue)]!==void 0)return Le.error("Branch labels must be unique.");D[String(Ue)]=F.length}const ze=d.parse(ve,ae,T);if(!ze)return null;T=T||ze.type,F.push(ze)}const V=d.parse(c[1],1,Fn);if(!V)return null;const X=d.parse(c[c.length-1],c.length-1,T);return X?V.type.kind!=="value"&&d.concat(1).checkSubtype(x,V.type)?null:new na(x,T,V,D,F,X):null}evaluate(c){const d=this.input.evaluate(c);return(Un(d)===this.inputType&&this.outputs[this.cases[d]]||this.otherwise).evaluate(c)}eachChild(c){c(this.input),this.outputs.forEach(c),c(this.otherwise)}outputDefined(){return this.outputs.every((c=>c.outputDefined()))&&this.otherwise.outputDefined()}}class Da{constructor(c,d,x){this.type=c,this.branches=d,this.otherwise=x}static parse(c,d){if(c.length<4)return d.error(`Expected at least 3 arguments, but found only ${c.length-1}.`);if(c.length%2!=0)return d.error("Expected an odd number of arguments.");let x;d.expectedType&&d.expectedType.kind!=="value"&&(x=d.expectedType);const T=[];for(let F=1;F<c.length-1;F+=2){const V=d.parse(c[F],F,Tn);if(!V)return null;const X=d.parse(c[F+1],F+1,x);if(!X)return null;T.push([V,X]),x=x||X.type}const D=d.parse(c[c.length-1],c.length-1,x);if(!D)return null;if(!x)throw new Error("Can't infer output type");return new Da(x,T,D)}evaluate(c){for(const[d,x]of this.branches)if(d.evaluate(c))return x.evaluate(c);return this.otherwise.evaluate(c)}eachChild(c){for(const[d,x]of this.branches)c(d),c(x);c(this.otherwise)}outputDefined(){return this.branches.every((([c,d])=>d.outputDefined()))&&this.otherwise.outputDefined()}}class le{constructor(c,d,x,T){this.type=c,this.input=d,this.beginIndex=x,this.endIndex=T}static parse(c,d){if(c.length<=2||c.length>=5)return d.error(`Expected 3 or 4 arguments, but found ${c.length-1} instead.`);const x=d.parse(c[1],1,Fn),T=d.parse(c[2],2,zr);if(!x||!T)return null;if(!Pa(x.type,[Ja(Fn),bn,Fn]))return d.error(`Expected first argument to be of type array or string, but found ${Hn(x.type)} instead`);if(c.length===4){const D=d.parse(c[3],3,zr);return D?new le(x.type,x,T,D):null}return new le(x.type,x,T)}evaluate(c){const d=this.input.evaluate(c),x=this.beginIndex.evaluate(c);let T;if(this.endIndex&&(T=this.endIndex.evaluate(c)),wa(d,["string"]))return[...d].slice(x,T).join("");if(wa(d,["array"]))return d.slice(x,T);throw new Wn(`Expected first argument to be of type array or string, but found ${Hn(Un(d))} instead.`)}eachChild(c){c(this.input),c(this.beginIndex),this.endIndex&&c(this.endIndex)}outputDefined(){return!1}}function Ve(p,c){const d=p.length-1;let x,T,D=0,F=d,V=0;for(;D<=F;)if(V=Math.floor((D+F)/2),x=p[V],T=p[V+1],x<=c){if(V===d||c<T)return V;D=V+1}else{if(!(x>c))throw new Wn("Input is not a number.");F=V-1}return 0}class dt{constructor(c,d,x){this.type=c,this.input=d,this.labels=[],this.outputs=[];for(const[T,D]of x)this.labels.push(T),this.outputs.push(D)}static parse(c,d){if(c.length-1<4)return d.error(`Expected at least 4 arguments, but found only ${c.length-1}.`);if((c.length-1)%2!=0)return d.error("Expected an even number of arguments.");const x=d.parse(c[1],1,zr);if(!x)return null;const T=[];let D=null;d.expectedType&&d.expectedType.kind!=="value"&&(D=d.expectedType);for(let F=1;F<c.length;F+=2){const V=F===1?-1/0:c[F],X=c[F+1],ae=F,se=F+1;if(typeof V!="number")return d.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',ae);if(T.length&&T[T.length-1][0]>=V)return d.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',ae);const ve=d.parse(X,se,D);if(!ve)return null;D=D||ve.type,T.push([V,ve])}return new dt(D,x,T)}evaluate(c){const d=this.labels,x=this.outputs;if(d.length===1)return x[0].evaluate(c);const T=this.input.evaluate(c);if(T<=d[0])return x[0].evaluate(c);const D=d.length;return T>=d[D-1]?x[D-1].evaluate(c):x[Ve(d,T)].evaluate(c)}eachChild(c){c(this.input);for(const d of this.outputs)c(d)}outputDefined(){return this.outputs.every((c=>c.outputDefined()))}}function Dt(p){return p&&p.__esModule&&Object.prototype.hasOwnProperty.call(p,"default")?p.default:p}var nr,Lr,Zr=(function(){if(Lr)return nr;function p(c,d,x,T){this.cx=3*c,this.bx=3*(x-c)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*d,this.by=3*(T-d)-this.cy,this.ay=1-this.cy-this.by,this.p1x=c,this.p1y=d,this.p2x=x,this.p2y=T}return Lr=1,nr=p,p.prototype={sampleCurveX:function(c){return((this.ax*c+this.bx)*c+this.cx)*c},sampleCurveY:function(c){return((this.ay*c+this.by)*c+this.cy)*c},sampleCurveDerivativeX:function(c){return(3*this.ax*c+2*this.bx)*c+this.cx},solveCurveX:function(c,d){if(d===void 0&&(d=1e-6),c<0)return 0;if(c>1)return 1;for(var x=c,T=0;T<8;T++){var D=this.sampleCurveX(x)-c;if(Math.abs(D)<d)return x;var F=this.sampleCurveDerivativeX(x);if(Math.abs(F)<1e-6)break;x-=D/F}var V=0,X=1;for(x=c,T=0;T<20&&(D=this.sampleCurveX(x),!(Math.abs(D-c)<d));T++)c>D?V=x:X=x,x=.5*(X-V)+V;return x},solve:function(c,d){return this.sampleCurveY(this.solveCurveX(c,d))}},nr})(),kn=Dt(Zr);class wn{constructor(c,d,x,T,D){this.type=c,this.operator=d,this.interpolation=x,this.input=T,this.labels=[],this.outputs=[];for(const[F,V]of D)this.labels.push(F),this.outputs.push(V)}static interpolationFactor(c,d,x,T){let D=0;if(c.name==="exponential")D=ni(d,c.base,x,T);else if(c.name==="linear")D=ni(d,1,x,T);else if(c.name==="cubic-bezier"){const F=c.controlPoints;D=new kn(F[0],F[1],F[2],F[3]).solve(ni(d,1,x,T))}return D}static parse(c,d){let[x,T,D,...F]=c;if(!Array.isArray(T)||T.length===0)return d.error("Expected an interpolation type expression.",1);if(T[0]==="linear")T={name:"linear"};else if(T[0]==="exponential"){const ae=T[1];if(typeof ae!="number")return d.error("Exponential interpolation requires a numeric base.",1,1);T={name:"exponential",base:ae}}else{if(T[0]!=="cubic-bezier")return d.error(`Unknown interpolation type ${String(T[0])}`,1,0);{const ae=T.slice(1);if(ae.length!==4||ae.some((se=>typeof se!="number"||se<0||se>1)))return d.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);T={name:"cubic-bezier",controlPoints:ae}}}if(c.length-1<4)return d.error(`Expected at least 4 arguments, but found only ${c.length-1}.`);if((c.length-1)%2!=0)return d.error("Expected an even number of arguments.");if(D=d.parse(D,2,zr),!D)return null;const V=[];let X=null;x!=="interpolate-hcl"&&x!=="interpolate-lab"||d.expectedType==Ka?d.expectedType&&d.expectedType.kind!=="value"&&(X=d.expectedType):X=Mi;for(let ae=0;ae<F.length;ae+=2){const se=F[ae],ve=F[ae+1],Le=ae+3,ze=ae+4;if(typeof se!="number")return d.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',Le);if(V.length&&V[V.length-1][0]>=se)return d.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',Le);const Ue=d.parse(ve,ze,X);if(!Ue)return null;X=X||Ue.type,V.push([se,Ue])}return Wo(X,zr)||Wo(X,pi)||Wo(X,Mi)||Wo(X,Gi)||Wo(X,xa)||Wo(X,Ka)||Wo(X,oo)||Wo(X,Ja(zr))?new wn(X,x,T,D,V):d.error(`Type ${Hn(X)} is not interpolatable.`)}evaluate(c){const d=this.labels,x=this.outputs;if(d.length===1)return x[0].evaluate(c);const T=this.input.evaluate(c);if(T<=d[0])return x[0].evaluate(c);const D=d.length;if(T>=d[D-1])return x[D-1].evaluate(c);const F=Ve(d,T),V=wn.interpolationFactor(this.interpolation,T,d[F],d[F+1]),X=x[F].evaluate(c),ae=x[F+1].evaluate(c);switch(this.operator){case"interpolate":switch(this.type.kind){case"number":return Yr(X,ae,V);case"color":return kr.interpolate(X,ae,V);case"padding":return pn.interpolate(X,ae,V);case"colorArray":return cn.interpolate(X,ae,V);case"numberArray":return Mr.interpolate(X,ae,V);case"variableAnchorOffsetCollection":return Ci.interpolate(X,ae,V);case"array":return Hr(X,ae,V);case"projectionDefinition":return gi.interpolate(X,ae,V)}case"interpolate-hcl":switch(this.type.kind){case"color":return kr.interpolate(X,ae,V,"hcl");case"colorArray":return cn.interpolate(X,ae,V,"hcl")}case"interpolate-lab":switch(this.type.kind){case"color":return kr.interpolate(X,ae,V,"lab");case"colorArray":return cn.interpolate(X,ae,V,"lab")}}}eachChild(c){c(this.input);for(const d of this.outputs)c(d)}outputDefined(){return this.outputs.every((c=>c.outputDefined()))}}function ni(p,c,d,x){const T=x-d,D=p-d;return T===0?0:c===1?D/T:(Math.pow(c,D)-1)/(Math.pow(c,T)-1)}const oi={color:kr.interpolate,number:Yr,padding:pn.interpolate,numberArray:Mr.interpolate,colorArray:cn.interpolate,variableAnchorOffsetCollection:Ci.interpolate,array:Hr};class Ii{constructor(c,d){this.type=c,this.args=d}static parse(c,d){if(c.length<2)return d.error("Expected at least one argument.");let x=null;const T=d.expectedType;T&&T.kind!=="value"&&(x=T);const D=[];for(const V of c.slice(1)){const X=d.parse(V,1+D.length,x,void 0,{typeAnnotation:"omit"});if(!X)return null;x=x||X.type,D.push(X)}if(!x)throw new Error("No output type");const F=T&&D.some((V=>ru(T,V.type)));return new Ii(F?Fn:x,D)}evaluate(c){let d,x=null,T=0;for(const D of this.args)if(T++,x=D.evaluate(c),x&&x instanceof Ra&&!x.available&&(d||(d=x.name),x=null,T===this.args.length&&(x=d)),x!==null)break;return x}eachChild(c){this.args.forEach(c)}outputDefined(){return this.args.every((c=>c.outputDefined()))}}function $i(p,c){return p==="=="||p==="!="?c.kind==="boolean"||c.kind==="string"||c.kind==="number"||c.kind==="null"||c.kind==="value":c.kind==="string"||c.kind==="number"||c.kind==="value"}function Bi(p,c,d,x){return x.compare(c,d)===0}function Ti(p,c,d){const x=p!=="=="&&p!=="!=";return class tW{constructor(D,F,V){this.type=Tn,this.lhs=D,this.rhs=F,this.collator=V,this.hasUntypedArgument=D.type.kind==="value"||F.type.kind==="value"}static parse(D,F){if(D.length!==3&&D.length!==4)return F.error("Expected two or three arguments.");const V=D[0];let X=F.parse(D[1],1,Fn);if(!X)return null;if(!$i(V,X.type))return F.concat(1).error(`"${V}" comparisons are not supported for type '${Hn(X.type)}'.`);let ae=F.parse(D[2],2,Fn);if(!ae)return null;if(!$i(V,ae.type))return F.concat(2).error(`"${V}" comparisons are not supported for type '${Hn(ae.type)}'.`);if(X.type.kind!==ae.type.kind&&X.type.kind!=="value"&&ae.type.kind!=="value")return F.error(`Cannot compare types '${Hn(X.type)}' and '${Hn(ae.type)}'.`);x&&(X.type.kind==="value"&&ae.type.kind!=="value"?X=new Do(ae.type,[X]):X.type.kind!=="value"&&ae.type.kind==="value"&&(ae=new Do(X.type,[ae])));let se=null;if(D.length===4){if(X.type.kind!=="string"&&ae.type.kind!=="string"&&X.type.kind!=="value"&&ae.type.kind!=="value")return F.error("Cannot use collator to compare non-string types.");if(se=F.parse(D[3],3,Ia),!se)return null}return new tW(X,ae,se)}evaluate(D){const F=this.lhs.evaluate(D),V=this.rhs.evaluate(D);if(x&&this.hasUntypedArgument){const X=Un(F),ae=Un(V);if(X.kind!==ae.kind||X.kind!=="string"&&X.kind!=="number")throw new Wn(`Expected arguments for "${p}" to be (string, string) or (number, number), but found (${X.kind}, ${ae.kind}) instead.`)}if(this.collator&&!x&&this.hasUntypedArgument){const X=Un(F),ae=Un(V);if(X.kind!=="string"||ae.kind!=="string")return c(D,F,V)}return this.collator?d(D,F,V,this.collator.evaluate(D)):c(D,F,V)}eachChild(D){D(this.lhs),D(this.rhs),this.collator&&D(this.collator)}outputDefined(){return!0}}}const Fa=Ti("==",(function(p,c,d){return c===d}),Bi),fa=Ti("!=",(function(p,c,d){return c!==d}),(function(p,c,d,x){return!Bi(0,c,d,x)})),Qa=Ti("<",(function(p,c,d){return c<d}),(function(p,c,d,x){return x.compare(c,d)<0})),bs=Ti(">",(function(p,c,d){return c>d}),(function(p,c,d,x){return x.compare(c,d)>0})),nl=Ti("<=",(function(p,c,d){return c<=d}),(function(p,c,d,x){return x.compare(c,d)<=0})),Su=Ti(">=",(function(p,c,d){return c>=d}),(function(p,c,d,x){return x.compare(c,d)>=0}));class Fo{constructor(c,d,x){this.type=Ia,this.locale=x,this.caseSensitive=c,this.diacriticSensitive=d}static parse(c,d){if(c.length!==2)return d.error("Expected one argument.");const x=c[1];if(typeof x!="object"||Array.isArray(x))return d.error("Collator options argument must be an object.");const T=d.parse(x["case-sensitive"]!==void 0&&x["case-sensitive"],1,Tn);if(!T)return null;const D=d.parse(x["diacritic-sensitive"]!==void 0&&x["diacritic-sensitive"],1,Tn);if(!D)return null;let F=null;return x.locale&&(F=d.parse(x.locale,1,bn),!F)?null:new Fo(T,D,F)}evaluate(c){return new Qr(this.caseSensitive.evaluate(c),this.diacriticSensitive.evaluate(c),this.locale?this.locale.evaluate(c):null)}eachChild(c){c(this.caseSensitive),c(this.diacriticSensitive),this.locale&&c(this.locale)}outputDefined(){return!1}}class Dl{constructor(c,d,x,T,D){this.type=bn,this.number=c,this.locale=d,this.currency=x,this.minFractionDigits=T,this.maxFractionDigits=D}static parse(c,d){if(c.length!==3)return d.error("Expected two arguments.");const x=d.parse(c[1],1,zr);if(!x)return null;const T=c[2];if(typeof T!="object"||Array.isArray(T))return d.error("NumberFormat options argument must be an object.");let D=null;if(T.locale&&(D=d.parse(T.locale,1,bn),!D))return null;let F=null;if(T.currency&&(F=d.parse(T.currency,1,bn),!F))return null;let V=null;if(T["min-fraction-digits"]&&(V=d.parse(T["min-fraction-digits"],1,zr),!V))return null;let X=null;return T["max-fraction-digits"]&&(X=d.parse(T["max-fraction-digits"],1,zr),!X)?null:new Dl(x,D,F,V,X)}evaluate(c){return new Intl.NumberFormat(this.locale?this.locale.evaluate(c):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(c):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(c):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(c):void 0}).format(this.number.evaluate(c))}eachChild(c){c(this.number),this.locale&&c(this.locale),this.currency&&c(this.currency),this.minFractionDigits&&c(this.minFractionDigits),this.maxFractionDigits&&c(this.maxFractionDigits)}outputDefined(){return!1}}class aa{constructor(c){this.type=ma,this.sections=c}static parse(c,d){if(c.length<2)return d.error("Expected at least one argument.");const x=c[1];if(!Array.isArray(x)&&typeof x=="object")return d.error("First argument must be an image or text section.");const T=[];let D=!1;for(let F=1;F<=c.length-1;++F){const V=c[F];if(D&&typeof V=="object"&&!Array.isArray(V)){D=!1;let X=null;if(V["font-scale"]&&(X=d.parse(V["font-scale"],1,zr),!X))return null;let ae=null;if(V["text-font"]&&(ae=d.parse(V["text-font"],1,Ja(bn)),!ae))return null;let se=null;if(V["text-color"]&&(se=d.parse(V["text-color"],1,Mi),!se))return null;let ve=null;if(V["vertical-align"]){if(typeof V["vertical-align"]=="string"&&!Qn.includes(V["vertical-align"]))return d.error(`'vertical-align' must be one of: 'bottom', 'center', 'top' but found '${V["vertical-align"]}' instead.`);if(ve=d.parse(V["vertical-align"],1,bn),!ve)return null}const Le=T[T.length-1];Le.scale=X,Le.font=ae,Le.textColor=se,Le.verticalAlign=ve}else{const X=d.parse(c[F],1,Fn);if(!X)return null;const ae=X.type.kind;if(ae!=="string"&&ae!=="value"&&ae!=="null"&&ae!=="resolvedImage")return d.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");D=!0,T.push({content:X,scale:null,font:null,textColor:null,verticalAlign:null})}}return new aa(T)}evaluate(c){return new En(this.sections.map((d=>{const x=d.content.evaluate(c);return Un(x)===Ui?new Ei("",x,null,null,null,d.verticalAlign?d.verticalAlign.evaluate(c):null):new Ei(Nn(x),null,d.scale?d.scale.evaluate(c):null,d.font?d.font.evaluate(c).join(","):null,d.textColor?d.textColor.evaluate(c):null,d.verticalAlign?d.verticalAlign.evaluate(c):null)})))}eachChild(c){for(const d of this.sections)c(d.content),d.scale&&c(d.scale),d.font&&c(d.font),d.textColor&&c(d.textColor),d.verticalAlign&&c(d.verticalAlign)}outputDefined(){return!1}}class xl{constructor(c){this.type=Ui,this.input=c}static parse(c,d){if(c.length!==2)return d.error("Expected two arguments.");const x=d.parse(c[1],1,bn);return x?new xl(x):d.error("No image name provided.")}evaluate(c){const d=this.input.evaluate(c),x=Ra.fromString(d);return x&&c.availableImages&&(x.available=c.availableImages.indexOf(d)>-1),x}eachChild(c){c(this.input)}outputDefined(){return!1}}class iu{constructor(c){this.type=zr,this.input=c}static parse(c,d){if(c.length!==2)return d.error(`Expected 1 argument, but found ${c.length-1} instead.`);const x=d.parse(c[1],1);return x?x.type.kind!=="array"&&x.type.kind!=="string"&&x.type.kind!=="value"?d.error(`Expected argument of type string or array, but found ${Hn(x.type)} instead.`):new iu(x):null}evaluate(c){const d=this.input.evaluate(c);if(typeof d=="string")return[...d].length;if(Array.isArray(d))return d.length;throw new Wn(`Expected value to be of type string or array, but found ${Hn(Un(d))} instead.`)}eachChild(c){c(this.input)}outputDefined(){return!1}}const co=8192;function eo(p,c){const d=(180+p[0])/360,x=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+p[1]*Math.PI/360)))/360,T=Math.pow(2,c.z);return[Math.round(d*T*co),Math.round(x*T*co)]}function xo(p,c){const d=Math.pow(2,c.z);return[(T=(p[0]/co+c.x)/d,360*T-180),(x=(p[1]/co+c.y)/d,360/Math.PI*Math.atan(Math.exp((180-360*x)*Math.PI/180))-90)];var x,T}function Ba(p,c){p[0]=Math.min(p[0],c[0]),p[1]=Math.min(p[1],c[1]),p[2]=Math.max(p[2],c[0]),p[3]=Math.max(p[3],c[1])}function Yo(p,c){return!(p[0]<=c[0]||p[2]>=c[2]||p[1]<=c[1]||p[3]>=c[3])}function Eu(p,c,d){const x=p[0]-c[0],T=p[1]-c[1],D=p[0]-d[0],F=p[1]-d[1];return x*F-D*T==0&&x*D<=0&&T*F<=0}function Ea(p,c,d,x){return(T=[x[0]-d[0],x[1]-d[1]])[0]*(D=[c[0]-p[0],c[1]-p[1]])[1]-T[1]*D[0]!=0&&!(!Hu(p,c,d,x)||!Hu(d,x,p,c));var T,D}function lh(p,c,d){for(const x of d)for(let T=0;T<x.length-1;++T)if(Ea(p,c,x[T],x[T+1]))return!0;return!1}function cs(p,c,d=!1){let x=!1;for(const V of c)for(let X=0;X<V.length-1;X++){if(Eu(p,V[X],V[X+1]))return d;(D=V[X])[1]>(T=p)[1]!=(F=V[X+1])[1]>T[1]&&T[0]<(F[0]-D[0])*(T[1]-D[1])/(F[1]-D[1])+D[0]&&(x=!x)}var T,D,F;return x}function au(p,c){for(const d of c)if(cs(p,d))return!0;return!1}function Wa(p,c){for(const d of p)if(!cs(d,c))return!1;for(let d=0;d<p.length-1;++d)if(lh(p[d],p[d+1],c))return!1;return!0}function Fs(p,c){for(const d of c)if(Wa(p,d))return!0;return!1}function Hu(p,c,d,x){const T=x[0]-d[0],D=x[1]-d[1],F=(p[0]-d[0])*D-T*(p[1]-d[1]),V=(c[0]-d[0])*D-T*(c[1]-d[1]);return F>0&&V<0||F<0&&V>0}function Wu(p,c,d){const x=[];for(let T=0;T<p.length;T++){const D=[];for(let F=0;F<p[T].length;F++){const V=eo(p[T][F],d);Ba(c,V),D.push(V)}x.push(D)}return x}function wl(p,c,d){const x=[];for(let T=0;T<p.length;T++){const D=Wu(p[T],c,d);x.push(D)}return x}function Fl(p,c,d,x){if(p[0]<d[0]||p[0]>d[2]){const T=.5*x;let D=p[0]-d[0]>T?-x:d[0]-p[0]>T?x:0;D===0&&(D=p[0]-d[2]>T?-x:d[2]-p[0]>T?x:0),p[0]+=D}Ba(c,p)}function Ao(p,c,d,x){const T=Math.pow(2,x.z)*co,D=[x.x*co,x.y*co],F=[];for(const V of p)for(const X of V){const ae=[X.x+D[0],X.y+D[1]];Fl(ae,c,d,T),F.push(ae)}return F}function ho(p,c,d,x){const T=Math.pow(2,x.z)*co,D=[x.x*co,x.y*co],F=[];for(const X of p){const ae=[];for(const se of X){const ve=[se.x+D[0],se.y+D[1]];Ba(c,ve),ae.push(ve)}F.push(ae)}if(c[2]-c[0]<=T/2){(V=c)[0]=V[1]=1/0,V[2]=V[3]=-1/0;for(const X of F)for(const ae of X)Fl(ae,c,d,T)}var V;return F}class Bs{constructor(c,d){this.type=Tn,this.geojson=c,this.geometries=d}static parse(c,d){if(c.length!==2)return d.error(`'within' expression requires exactly one argument, but found ${c.length-1} instead.`);if(us(c[1])){const x=c[1];if(x.type==="FeatureCollection"){const T=[];for(const D of x.features){const{type:F,coordinates:V}=D.geometry;F==="Polygon"&&T.push(V),F==="MultiPolygon"&&T.push(...V)}if(T.length)return new Bs(x,{type:"MultiPolygon",coordinates:T})}else if(x.type==="Feature"){const T=x.geometry.type;if(T==="Polygon"||T==="MultiPolygon")return new Bs(x,x.geometry)}else if(x.type==="Polygon"||x.type==="MultiPolygon")return new Bs(x,x)}return d.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(c){if(c.geometry()!=null&&c.canonicalID()!=null){if(c.geometryType()==="Point")return(function(d,x){const T=[1/0,1/0,-1/0,-1/0],D=[1/0,1/0,-1/0,-1/0],F=d.canonicalID();if(x.type==="Polygon"){const V=Wu(x.coordinates,D,F),X=Ao(d.geometry(),T,D,F);if(!Yo(T,D))return!1;for(const ae of X)if(!cs(ae,V))return!1}if(x.type==="MultiPolygon"){const V=wl(x.coordinates,D,F),X=Ao(d.geometry(),T,D,F);if(!Yo(T,D))return!1;for(const ae of X)if(!au(ae,V))return!1}return!0})(c,this.geometries);if(c.geometryType()==="LineString")return(function(d,x){const T=[1/0,1/0,-1/0,-1/0],D=[1/0,1/0,-1/0,-1/0],F=d.canonicalID();if(x.type==="Polygon"){const V=Wu(x.coordinates,D,F),X=ho(d.geometry(),T,D,F);if(!Yo(T,D))return!1;for(const ae of X)if(!Wa(ae,V))return!1}if(x.type==="MultiPolygon"){const V=wl(x.coordinates,D,F),X=ho(d.geometry(),T,D,F);if(!Yo(T,D))return!1;for(const ae of X)if(!Fs(ae,V))return!1}return!0})(c,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}}let wo=class{constructor(p=[],c=(d,x)=>d<x?-1:d>x?1:0){if(this.data=p,this.length=this.data.length,this.compare=c,this.length>0)for(let d=(this.length>>1)-1;d>=0;d--)this._down(d)}push(p){this.data.push(p),this._up(this.length++)}pop(){if(this.length===0)return;const p=this.data[0],c=this.data.pop();return--this.length>0&&(this.data[0]=c,this._down(0)),p}peek(){return this.data[0]}_up(p){const{data:c,compare:d}=this,x=c[p];for(;p>0;){const T=p-1>>1,D=c[T];if(d(x,D)>=0)break;c[p]=D,p=T}c[p]=x}_down(p){const{data:c,compare:d}=this,x=this.length>>1,T=c[p];for(;p<x;){let D=1+(p<<1);const F=D+1;if(F<this.length&&d(c[F],c[D])<0&&(D=F),d(c[D],T)>=0)break;c[p]=c[D],p=D}c[p]=T}};function Bl(p,c,d=0,x=p.length-1,T=zl){for(;x>d;){if(x-d>600){const X=x-d+1,ae=c-d+1,se=Math.log(X),ve=.5*Math.exp(2*se/3),Le=.5*Math.sqrt(se*ve*(X-ve)/X)*(ae-X/2<0?-1:1);Bl(p,c,Math.max(d,Math.floor(c-ae*ve/X+Le)),Math.min(x,Math.floor(c+(X-ae)*ve/X+Le)),T)}const D=p[c];let F=d,V=x;for(hs(p,d,c),T(p[x],D)>0&&hs(p,d,x);F<V;){for(hs(p,F,V),F++,V--;T(p[F],D)<0;)F++;for(;T(p[V],D)>0;)V--}T(p[d],D)===0?hs(p,d,V):(V++,hs(p,V,x)),V<=c&&(d=V+1),c<=V&&(x=V-1)}}function hs(p,c,d){const x=p[c];p[c]=p[d],p[d]=x}function zl(p,c){return p<c?-1:p>c?1:0}function ya(p,c){if(p.length<=1)return[p];const d=[];let x,T;for(const D of p){const F=il(D);F!==0&&(D.area=Math.abs(F),T===void 0&&(T=F<0),T===F<0?(x&&d.push(x),x=[D]):x.push(D))}if(x&&d.push(x),c>1)for(let D=0;D<d.length;D++)d[D].length<=c||(Bl(d[D],c,1,d[D].length-1,Tu),d[D]=d[D].slice(0,c));return d}function Tu(p,c){return c.area-p.area}function il(p){let c=0;for(let d,x,T=0,D=p.length,F=D-1;T<D;F=T++)d=p[T],x=p[F],c+=(x.x-d.x)*(d.y+x.y);return c}const zs=1/298.257223563,jl=zs*(2-zs),Cu=Math.PI/180;class js{constructor(c){const d=6378.137*Cu*1e3,x=Math.cos(c*Cu),T=1/(1-jl*(1-x*x)),D=Math.sqrt(T);this.kx=d*D*x,this.ky=d*D*T*(1-jl)}distance(c,d){const x=this.wrap(c[0]-d[0])*this.kx,T=(c[1]-d[1])*this.ky;return Math.sqrt(x*x+T*T)}pointOnLine(c,d){let x,T,D,F,V=1/0;for(let X=0;X<c.length-1;X++){let ae=c[X][0],se=c[X][1],ve=this.wrap(c[X+1][0]-ae)*this.kx,Le=(c[X+1][1]-se)*this.ky,ze=0;ve===0&&Le===0||(ze=(this.wrap(d[0]-ae)*this.kx*ve+(d[1]-se)*this.ky*Le)/(ve*ve+Le*Le),ze>1?(ae=c[X+1][0],se=c[X+1][1]):ze>0&&(ae+=ve/this.kx*ze,se+=Le/this.ky*ze)),ve=this.wrap(d[0]-ae)*this.kx,Le=(d[1]-se)*this.ky;const Ue=ve*ve+Le*Le;Ue<V&&(V=Ue,x=ae,T=se,D=X,F=ze)}return{point:[x,T],index:D,t:Math.max(0,Math.min(1,F))}}wrap(c){for(;c<-180;)c+=360;for(;c>180;)c-=360;return c}}function ou(p,c){return c[0]-p[0]}function Ul(p){return p[1]-p[0]+1}function $t(p,c){return p[1]>=p[0]&&p[1]<c}function tr(p,c){if(p[0]>p[1])return[null,null];const d=Ul(p);if(c){if(d===2)return[p,null];const T=Math.floor(d/2);return[[p[0],p[0]+T],[p[0]+T,p[1]]]}if(d===1)return[p,null];const x=Math.floor(d/2)-1;return[[p[0],p[0]+x],[p[0]+x+1,p[1]]]}function sn(p,c){if(!$t(c,p.length))return[1/0,1/0,-1/0,-1/0];const d=[1/0,1/0,-1/0,-1/0];for(let x=c[0];x<=c[1];++x)Ba(d,p[x]);return d}function Cn(p){const c=[1/0,1/0,-1/0,-1/0];for(const d of p)for(const x of d)Ba(c,x);return c}function bi(p){return p[0]!==-1/0&&p[1]!==-1/0&&p[2]!==1/0&&p[3]!==1/0}function An(p,c,d){if(!bi(p)||!bi(c))return NaN;let x=0,T=0;return p[2]<c[0]&&(x=c[0]-p[2]),p[0]>c[2]&&(x=p[0]-c[2]),p[1]>c[3]&&(T=p[1]-c[3]),p[3]<c[1]&&(T=c[1]-p[3]),d.distance([0,0],[x,T])}function A(p,c,d){const x=d.pointOnLine(c,p);return d.distance(p,x.point)}function y(p,c,d,x,T){const D=Math.min(A(p,[d,x],T),A(c,[d,x],T)),F=Math.min(A(d,[p,c],T),A(x,[p,c],T));return Math.min(D,F)}function _(p,c,d,x,T){if(!$t(c,p.length)||!$t(x,d.length))return 1/0;let D=1/0;for(let F=c[0];F<c[1];++F){const V=p[F],X=p[F+1];for(let ae=x[0];ae<x[1];++ae){const se=d[ae],ve=d[ae+1];if(Ea(V,X,se,ve))return 0;D=Math.min(D,y(V,X,se,ve,T))}}return D}function I(p,c,d,x,T){if(!$t(c,p.length)||!$t(x,d.length))return NaN;let D=1/0;for(let F=c[0];F<=c[1];++F)for(let V=x[0];V<=x[1];++V)if(D=Math.min(D,T.distance(p[F],d[V])),D===0)return D;return D}function U(p,c,d){if(cs(p,c,!0))return 0;let x=1/0;for(const T of c){const D=T[0],F=T[T.length-1];if(D!==F&&(x=Math.min(x,A(p,[F,D],d)),x===0))return x;const V=d.pointOnLine(T,p);if(x=Math.min(x,d.distance(p,V.point)),x===0)return x}return x}function re(p,c,d,x){if(!$t(c,p.length))return NaN;for(let D=c[0];D<=c[1];++D)if(cs(p[D],d,!0))return 0;let T=1/0;for(let D=c[0];D<c[1];++D){const F=p[D],V=p[D+1];for(const X of d)for(let ae=0,se=X.length,ve=se-1;ae<se;ve=ae++){const Le=X[ve],ze=X[ae];if(Ea(F,V,Le,ze))return 0;T=Math.min(T,y(F,V,Le,ze,x))}}return T}function ye(p,c){for(const d of p)for(const x of d)if(cs(x,c,!0))return!0;return!1}function Re(p,c,d,x=1/0){const T=Cn(p),D=Cn(c);if(x!==1/0&&An(T,D,d)>=x)return x;if(Yo(T,D)){if(ye(p,c))return 0}else if(ye(c,p))return 0;let F=1/0;for(const V of p)for(let X=0,ae=V.length,se=ae-1;X<ae;se=X++){const ve=V[se],Le=V[X];for(const ze of c)for(let Ue=0,Ze=ze.length,st=Ze-1;Ue<Ze;st=Ue++){const wt=ze[st],Wt=ze[Ue];if(Ea(ve,Le,wt,Wt))return 0;F=Math.min(F,y(ve,Le,wt,Wt,d))}}return F}function Ke(p,c,d,x,T,D){if(!D)return;const F=An(sn(x,D),T,d);F<c&&p.push([F,D,[0,0]])}function yt(p,c,d,x,T,D,F){if(!D||!F)return;const V=An(sn(x,D),sn(T,F),d);V<c&&p.push([V,D,F])}function Zt(p,c,d,x,T=1/0){let D=Math.min(x.distance(p[0],d[0][0]),T);if(D===0)return D;const F=new wo([[0,[0,p.length-1],[0,0]]],ou),V=Cn(d);for(;F.length>0;){const X=F.pop();if(X[0]>=D)continue;const ae=X[1],se=c?50:100;if(Ul(ae)<=se){if(!$t(ae,p.length))return NaN;if(c){const ve=re(p,ae,d,x);if(isNaN(ve)||ve===0)return ve;D=Math.min(D,ve)}else for(let ve=ae[0];ve<=ae[1];++ve){const Le=U(p[ve],d,x);if(D=Math.min(D,Le),D===0)return 0}}else{const ve=tr(ae,c);Ke(F,D,x,p,V,ve[0]),Ke(F,D,x,p,V,ve[1])}}return D}function ur(p,c,d,x,T,D=1/0){let F=Math.min(D,T.distance(p[0],d[0]));if(F===0)return F;const V=new wo([[0,[0,p.length-1],[0,d.length-1]]],ou);for(;V.length>0;){const X=V.pop();if(X[0]>=F)continue;const ae=X[1],se=X[2],ve=c?50:100,Le=x?50:100;if(Ul(ae)<=ve&&Ul(se)<=Le){if(!$t(ae,p.length)&&$t(se,d.length))return NaN;let ze;if(c&&x)ze=_(p,ae,d,se,T),F=Math.min(F,ze);else if(c&&!x){const Ue=p.slice(ae[0],ae[1]+1);for(let Ze=se[0];Ze<=se[1];++Ze)if(ze=A(d[Ze],Ue,T),F=Math.min(F,ze),F===0)return F}else if(!c&&x){const Ue=d.slice(se[0],se[1]+1);for(let Ze=ae[0];Ze<=ae[1];++Ze)if(ze=A(p[Ze],Ue,T),F=Math.min(F,ze),F===0)return F}else ze=I(p,ae,d,se,T),F=Math.min(F,ze)}else{const ze=tr(ae,c),Ue=tr(se,x);yt(V,F,T,p,d,ze[0],Ue[0]),yt(V,F,T,p,d,ze[0],Ue[1]),yt(V,F,T,p,d,ze[1],Ue[0]),yt(V,F,T,p,d,ze[1],Ue[1])}}return F}function Vr(p){return p.type==="MultiPolygon"?p.coordinates.map((c=>({type:"Polygon",coordinates:c}))):p.type==="MultiLineString"?p.coordinates.map((c=>({type:"LineString",coordinates:c}))):p.type==="MultiPoint"?p.coordinates.map((c=>({type:"Point",coordinates:c}))):[p]}class gn{constructor(c,d){this.type=zr,this.geojson=c,this.geometries=d}static parse(c,d){if(c.length!==2)return d.error(`'distance' expression requires exactly one argument, but found ${c.length-1} instead.`);if(us(c[1])){const x=c[1];if(x.type==="FeatureCollection")return new gn(x,x.features.map((T=>Vr(T.geometry))).flat());if(x.type==="Feature")return new gn(x,Vr(x.geometry));if("type"in x&&"coordinates"in x)return new gn(x,Vr(x))}return d.error("'distance' expression requires valid geojson object that contains polygon geometry type.")}evaluate(c){if(c.geometry()!=null&&c.canonicalID()!=null){if(c.geometryType()==="Point")return(function(d,x){const T=d.geometry(),D=T.flat().map((X=>xo([X.x,X.y],d.canonical)));if(T.length===0)return NaN;const F=new js(D[0][1]);let V=1/0;for(const X of x){switch(X.type){case"Point":V=Math.min(V,ur(D,!1,[X.coordinates],!1,F,V));break;case"LineString":V=Math.min(V,ur(D,!1,X.coordinates,!0,F,V));break;case"Polygon":V=Math.min(V,Zt(D,!1,X.coordinates,F,V))}if(V===0)return V}return V})(c,this.geometries);if(c.geometryType()==="LineString")return(function(d,x){const T=d.geometry(),D=T.flat().map((X=>xo([X.x,X.y],d.canonical)));if(T.length===0)return NaN;const F=new js(D[0][1]);let V=1/0;for(const X of x){switch(X.type){case"Point":V=Math.min(V,ur(D,!0,[X.coordinates],!1,F,V));break;case"LineString":V=Math.min(V,ur(D,!0,X.coordinates,!0,F,V));break;case"Polygon":V=Math.min(V,Zt(D,!0,X.coordinates,F,V))}if(V===0)return V}return V})(c,this.geometries);if(c.geometryType()==="Polygon")return(function(d,x){const T=d.geometry();if(T.length===0||T[0].length===0)return NaN;const D=ya(T,0).map((X=>X.map((ae=>ae.map((se=>xo([se.x,se.y],d.canonical))))))),F=new js(D[0][0][0][1]);let V=1/0;for(const X of x)for(const ae of D){switch(X.type){case"Point":V=Math.min(V,Zt([X.coordinates],!1,ae,F,V));break;case"LineString":V=Math.min(V,Zt(X.coordinates,!0,ae,F,V));break;case"Polygon":V=Math.min(V,Re(ae,X.coordinates,F,V))}if(V===0)return V}return V})(c,this.geometries)}return NaN}eachChild(){}outputDefined(){return!0}}class Rn{constructor(c){this.type=Fn,this.key=c}static parse(c,d){if(c.length!==2)return d.error(`Expected 1 argument, but found ${c.length-1} instead.`);const x=c[1];return x==null?d.error("Global state property must be defined."):typeof x!="string"?d.error(`Global state property must be string, but found ${typeof c[1]} instead.`):new Rn(x)}evaluate(c){var d;const x=(d=c.globals)===null||d===void 0?void 0:d.globalState;return x&&Object.keys(x).length!==0?Xe(x,this.key):null}eachChild(){}outputDefined(){return!1}}const Vn={"==":Fa,"!=":fa,">":bs,"<":Qa,">=":Su,"<=":nl,array:Do,at:bl,boolean:Do,case:Da,coalesce:Ii,collator:Fo,format:aa,image:xl,in:lo,"index-of":uo,interpolate:wn,"interpolate-hcl":wn,"interpolate-lab":wn,length:iu,let:Co,literal:Go,match:na,number:Do,"number-format":Dl,object:Do,slice:le,step:dt,string:Do,"to-boolean":Xo,"to-color":Xo,"to-number":Xo,"to-string":Xo,var:rl,within:Bs,distance:gn,"global-state":Rn};class In{constructor(c,d,x,T){this.name=c,this.type=d,this._evaluate=x,this.args=T}evaluate(c){return this._evaluate(c,this.args)}eachChild(c){this.args.forEach(c)}outputDefined(){return!1}static parse(c,d){const x=c[0],T=In.definitions[x];if(!T)return d.error(`Unknown expression "${x}". If you wanted a literal array, use ["literal", [...]].`,0);const D=Array.isArray(T)?T[0]:T.type,F=Array.isArray(T)?[[T[1],T[2]]]:T.overloads,V=F.filter((([ae])=>!Array.isArray(ae)||ae.length===c.length-1));let X=null;for(const[ae,se]of V){X=new _l(d.registry,Ga,d.path,null,d.scope);const ve=[];let Le=!1;for(let ze=1;ze<c.length;ze++){const Ue=c[ze],Ze=Array.isArray(ae)?ae[ze-1]:ae.type,st=X.parse(Ue,1+ve.length,Ze);if(!st){Le=!0;break}ve.push(st)}if(!Le)if(Array.isArray(ae)&&ae.length!==ve.length)X.error(`Expected ${ae.length} arguments, but found ${ve.length} instead.`);else{for(let ze=0;ze<ve.length;ze++){const Ue=Array.isArray(ae)?ae[ze]:ae.type,Ze=ve[ze];X.concat(ze+1).checkSubtype(Ue,Ze.type)}if(X.errors.length===0)return new In(x,D,se,ve)}}if(V.length===1)d.errors.push(...X.errors);else{const ae=(V.length?V:F).map((([ve])=>{return Le=ve,Array.isArray(Le)?`(${Le.map(Hn).join(", ")})`:`(${Hn(Le.type)}...)`;var Le})).join(" | "),se=[];for(let ve=1;ve<c.length;ve++){const Le=d.parse(c[ve],1+se.length);if(!Le)return null;se.push(Hn(Le.type))}d.error(`Expected arguments of type ${ae}, but found (${se.join(", ")}) instead.`)}return null}static register(c,d){In.definitions=d;for(const x in d)c[x]=In}}function Dn(p,[c,d,x,T]){c=c.evaluate(p),d=d.evaluate(p),x=x.evaluate(p);const D=T?T.evaluate(p):1,F=jn(c,d,x,D);if(F)throw new Wn(F);return new kr(c/255,d/255,x/255,D,!1)}function Qi(p,c){return p in c}function ia(p,c){const d=c[p];return d===void 0?null:d}function Ta(p){return{type:p}}function Ga(p){if(p instanceof rl)return Ga(p.boundExpression);if(p instanceof In&&p.name==="error"||p instanceof Fo||p instanceof Bs||p instanceof gn||p instanceof Rn)return!1;const c=p instanceof Xo||p instanceof Do;let d=!0;return p.eachChild((x=>{d=c?d&&Ga(x):d&&x instanceof Go})),!!d&&Bo(p)&&Vl(p,["zoom","heatmap-density","elevation","line-progress","accumulated","is-supported-script"])}function Bo(p){if(p instanceof In&&(p.name==="get"&&p.args.length===1||p.name==="feature-state"||p.name==="has"&&p.args.length===1||p.name==="properties"||p.name==="geometry-type"||p.name==="id"||/^filter-/.test(p.name))||p instanceof Bs||p instanceof gn)return!1;let c=!0;return p.eachChild((d=>{c&&!Bo(d)&&(c=!1)})),c}function xs(p){if(p instanceof In&&p.name==="feature-state")return!1;let c=!0;return p.eachChild((d=>{c&&!xs(d)&&(c=!1)})),c}function Vl(p,c){if(p instanceof In&&c.indexOf(p.name)>=0)return!1;let d=!0;return p.eachChild((x=>{d&&!Vl(x,c)&&(d=!1)})),d}function Gu(p){return{result:"success",value:p}}function Us(p){return{result:"error",value:p}}function Zo(p){return p["property-type"]==="data-driven"||p["property-type"]==="cross-faded-data-driven"}function uc(p){return!!p.expression&&p.expression.parameters.indexOf("zoom")>-1}function Sl(p){return!!p.expression&&p.expression.interpolated}function Zn(p){return p instanceof Number?"number":p instanceof String?"string":p instanceof Boolean?"boolean":Array.isArray(p)?"array":p===null?"null":typeof p}function zo(p){return typeof p=="object"&&p!==null&&!Array.isArray(p)&&Un(p)===Wi}function Oc(p){return p}function uh(p,c){const d=p.stops&&typeof p.stops[0][0]=="object",x=d||!(d||p.property!==void 0),T=p.type||(Sl(c)?"exponential":"interval"),D=(function(se){switch(se.type){case"color":return kr.parse;case"padding":return pn.parse;case"numberArray":return Mr.parse;case"colorArray":return cn.parse;default:return null}})(c);if(D&&((p=Ir({},p)).stops&&(p.stops=p.stops.map((se=>[se[0],D(se[1])]))),p.default=D(p.default?p.default:c.default)),p.colorSpace&&(F=p.colorSpace)!=="rgb"&&F!=="hcl"&&F!=="lab")throw new Error(`Unknown color space: "${p.colorSpace}"`);var F;const V=(function(se){switch(se){case"exponential":return ap;case"interval":return ip;case"categorical":return cc;case"identity":return ey;default:throw new Error(`Unknown function type "${se}"`)}})(T);let X,ae;if(T==="categorical"){X=Object.create(null);for(const se of p.stops)X[se[0]]=se[1];ae=typeof p.stops[0][0]}if(d){const se={},ve=[];for(let Ue=0;Ue<p.stops.length;Ue++){const Ze=p.stops[Ue],st=Ze[0].zoom;se[st]===void 0&&(se[st]={zoom:st,type:p.type,property:p.property,default:p.default,stops:[]},ve.push(st)),se[st].stops.push([Ze[0].value,Ze[1]])}const Le=[];for(const Ue of ve)Le.push([se[Ue].zoom,uh(se[Ue],c)]);const ze={name:"linear"};return{kind:"composite",interpolationType:ze,interpolationFactor:wn.interpolationFactor.bind(void 0,ze),zoomStops:Le.map((Ue=>Ue[0])),evaluate:({zoom:Ue},Ze)=>ap({stops:Le,base:p.base},c,Ue).evaluate(Ue,Ze)}}if(x){const se=T==="exponential"?{name:"exponential",base:p.base!==void 0?p.base:1}:null;return{kind:"camera",interpolationType:se,interpolationFactor:wn.interpolationFactor.bind(void 0,se),zoomStops:p.stops.map((ve=>ve[0])),evaluate:({zoom:ve})=>V(p,c,ve,X,ae)}}return{kind:"source",evaluate(se,ve){const Le=ve&&ve.properties?ve.properties[p.property]:void 0;return Le===void 0?$l(p.default,c.default):V(p,c,Le,X,ae)}}}function $l(p,c,d){return p!==void 0?p:c!==void 0?c:d!==void 0?d:void 0}function cc(p,c,d,x,T){return $l(typeof d===T?x[d]:void 0,p.default,c.default)}function ip(p,c,d){if(Zn(d)!=="number")return $l(p.default,c.default);const x=p.stops.length;if(x===1||d<=p.stops[0][0])return p.stops[0][1];if(d>=p.stops[x-1][0])return p.stops[x-1][1];const T=Ve(p.stops.map((D=>D[0])),d);return p.stops[T][1]}function ap(p,c,d){const x=p.base!==void 0?p.base:1;if(Zn(d)!=="number")return $l(p.default,c.default);const T=p.stops.length;if(T===1||d<=p.stops[0][0])return p.stops[0][1];if(d>=p.stops[T-1][0])return p.stops[T-1][1];const D=Ve(p.stops.map((se=>se[0])),d),F=(function(se,ve,Le,ze){const Ue=ze-Le,Ze=se-Le;return Ue===0?0:ve===1?Ze/Ue:(Math.pow(ve,Ze)-1)/(Math.pow(ve,Ue)-1)})(d,x,p.stops[D][0],p.stops[D+1][0]),V=p.stops[D][1],X=p.stops[D+1][1],ae=oi[c.type]||Oc;return typeof V.evaluate=="function"?{evaluate(...se){const ve=V.evaluate.apply(void 0,se),Le=X.evaluate.apply(void 0,se);if(ve!==void 0&&Le!==void 0)return ae(ve,Le,F,p.colorSpace)}}:ae(V,X,F,p.colorSpace)}function ey(p,c,d){switch(c.type){case"color":d=kr.parse(d);break;case"formatted":d=En.fromString(d.toString());break;case"resolvedImage":d=Ra.fromString(d.toString());break;case"padding":d=pn.parse(d);break;case"colorArray":d=cn.parse(d);break;case"numberArray":d=Mr.parse(d);break;default:Zn(d)===c.type||c.type==="enum"&&c.values[d]||(d=void 0)}return $l(d,p.default,c.default)}In.register(Vn,{error:[{kind:"error"},[bn],(p,[c])=>{throw new Wn(c.evaluate(p))}],typeof:[bn,[Fn],(p,[c])=>Hn(Un(c.evaluate(p)))],"to-rgba":[Ja(zr,4),[Mi],(p,[c])=>{const[d,x,T,D]=c.evaluate(p).rgb;return[255*d,255*x,255*T,D]}],rgb:[Mi,[zr,zr,zr],Dn],rgba:[Mi,[zr,zr,zr,zr],Dn],has:{type:Tn,overloads:[[[bn],(p,[c])=>Qi(c.evaluate(p),p.properties())],[[bn,Wi],(p,[c,d])=>Qi(c.evaluate(p),d.evaluate(p))]]},get:{type:Fn,overloads:[[[bn],(p,[c])=>ia(c.evaluate(p),p.properties())],[[bn,Wi],(p,[c,d])=>ia(c.evaluate(p),d.evaluate(p))]]},"feature-state":[Fn,[bn],(p,[c])=>ia(c.evaluate(p),p.featureState||{})],properties:[Wi,[],p=>p.properties()],"geometry-type":[bn,[],p=>p.geometryType()],id:[Fn,[],p=>p.id()],zoom:[zr,[],p=>p.globals.zoom],"heatmap-density":[zr,[],p=>p.globals.heatmapDensity||0],elevation:[zr,[],p=>p.globals.elevation||0],"line-progress":[zr,[],p=>p.globals.lineProgress||0],accumulated:[Fn,[],p=>p.globals.accumulated===void 0?null:p.globals.accumulated],"+":[zr,Ta(zr),(p,c)=>{let d=0;for(const x of c)d+=x.evaluate(p);return d}],"*":[zr,Ta(zr),(p,c)=>{let d=1;for(const x of c)d*=x.evaluate(p);return d}],"-":{type:zr,overloads:[[[zr,zr],(p,[c,d])=>c.evaluate(p)-d.evaluate(p)],[[zr],(p,[c])=>-c.evaluate(p)]]},"/":[zr,[zr,zr],(p,[c,d])=>c.evaluate(p)/d.evaluate(p)],"%":[zr,[zr,zr],(p,[c,d])=>c.evaluate(p)%d.evaluate(p)],ln2:[zr,[],()=>Math.LN2],pi:[zr,[],()=>Math.PI],e:[zr,[],()=>Math.E],"^":[zr,[zr,zr],(p,[c,d])=>Math.pow(c.evaluate(p),d.evaluate(p))],sqrt:[zr,[zr],(p,[c])=>Math.sqrt(c.evaluate(p))],log10:[zr,[zr],(p,[c])=>Math.log(c.evaluate(p))/Math.LN10],ln:[zr,[zr],(p,[c])=>Math.log(c.evaluate(p))],log2:[zr,[zr],(p,[c])=>Math.log(c.evaluate(p))/Math.LN2],sin:[zr,[zr],(p,[c])=>Math.sin(c.evaluate(p))],cos:[zr,[zr],(p,[c])=>Math.cos(c.evaluate(p))],tan:[zr,[zr],(p,[c])=>Math.tan(c.evaluate(p))],asin:[zr,[zr],(p,[c])=>Math.asin(c.evaluate(p))],acos:[zr,[zr],(p,[c])=>Math.acos(c.evaluate(p))],atan:[zr,[zr],(p,[c])=>Math.atan(c.evaluate(p))],min:[zr,Ta(zr),(p,c)=>Math.min(...c.map((d=>d.evaluate(p))))],max:[zr,Ta(zr),(p,c)=>Math.max(...c.map((d=>d.evaluate(p))))],abs:[zr,[zr],(p,[c])=>Math.abs(c.evaluate(p))],round:[zr,[zr],(p,[c])=>{const d=c.evaluate(p);return d<0?-Math.round(-d):Math.round(d)}],floor:[zr,[zr],(p,[c])=>Math.floor(c.evaluate(p))],ceil:[zr,[zr],(p,[c])=>Math.ceil(c.evaluate(p))],"filter-==":[Tn,[bn,Fn],(p,[c,d])=>p.properties()[c.value]===d.value],"filter-id-==":[Tn,[Fn],(p,[c])=>p.id()===c.value],"filter-type-==":[Tn,[bn],(p,[c])=>p.geometryType()===c.value],"filter-<":[Tn,[bn,Fn],(p,[c,d])=>{const x=p.properties()[c.value],T=d.value;return typeof x==typeof T&&x<T}],"filter-id-<":[Tn,[Fn],(p,[c])=>{const d=p.id(),x=c.value;return typeof d==typeof x&&d<x}],"filter->":[Tn,[bn,Fn],(p,[c,d])=>{const x=p.properties()[c.value],T=d.value;return typeof x==typeof T&&x>T}],"filter-id->":[Tn,[Fn],(p,[c])=>{const d=p.id(),x=c.value;return typeof d==typeof x&&d>x}],"filter-<=":[Tn,[bn,Fn],(p,[c,d])=>{const x=p.properties()[c.value],T=d.value;return typeof x==typeof T&&x<=T}],"filter-id-<=":[Tn,[Fn],(p,[c])=>{const d=p.id(),x=c.value;return typeof d==typeof x&&d<=x}],"filter->=":[Tn,[bn,Fn],(p,[c,d])=>{const x=p.properties()[c.value],T=d.value;return typeof x==typeof T&&x>=T}],"filter-id->=":[Tn,[Fn],(p,[c])=>{const d=p.id(),x=c.value;return typeof d==typeof x&&d>=x}],"filter-has":[Tn,[Fn],(p,[c])=>c.value in p.properties()],"filter-has-id":[Tn,[],p=>p.id()!==null&&p.id()!==void 0],"filter-type-in":[Tn,[Ja(bn)],(p,[c])=>c.value.indexOf(p.geometryType())>=0],"filter-id-in":[Tn,[Ja(Fn)],(p,[c])=>c.value.indexOf(p.id())>=0],"filter-in-small":[Tn,[bn,Ja(Fn)],(p,[c,d])=>d.value.indexOf(p.properties()[c.value])>=0],"filter-in-large":[Tn,[bn,Ja(Fn)],(p,[c,d])=>(function(x,T,D,F){for(;D<=F;){const V=D+F>>1;if(T[V]===x)return!0;T[V]>x?F=V-1:D=V+1}return!1})(p.properties()[c.value],d.value,0,d.value.length-1)],all:{type:Tn,overloads:[[[Tn,Tn],(p,[c,d])=>c.evaluate(p)&&d.evaluate(p)],[Ta(Tn),(p,c)=>{for(const d of c)if(!d.evaluate(p))return!1;return!0}]]},any:{type:Tn,overloads:[[[Tn,Tn],(p,[c,d])=>c.evaluate(p)||d.evaluate(p)],[Ta(Tn),(p,c)=>{for(const d of c)if(d.evaluate(p))return!0;return!1}]]},"!":[Tn,[Tn],(p,[c])=>!c.evaluate(p)],"is-supported-script":[Tn,[bn],(p,[c])=>{const d=p.globals&&p.globals.isSupportedScript;return!d||d(c.evaluate(p))}],upcase:[bn,[bn],(p,[c])=>c.evaluate(p).toUpperCase()],downcase:[bn,[bn],(p,[c])=>c.evaluate(p).toLowerCase()],concat:[bn,Ta(Fn),(p,c)=>c.map((d=>Nn(d.evaluate(p)))).join("")],"resolved-locale":[bn,[Ia],(p,[c])=>c.evaluate(p).resolvedLocale()]});class fd{constructor(c,d){this.expression=c,this._warningHistory={},this._evaluator=new nu,this._defaultValue=d?(function(x){if(x.type==="color"&&zo(x.default))return new kr(0,0,0,0);switch(x.type){case"color":return kr.parse(x.default)||null;case"padding":return pn.parse(x.default)||null;case"numberArray":return Mr.parse(x.default)||null;case"colorArray":return cn.parse(x.default)||null;case"variableAnchorOffsetCollection":return Ci.parse(x.default)||null;case"projectionDefinition":return gi.parse(x.default)||null;default:return x.default===void 0?null:x.default}})(d):null,this._enumValues=d&&d.type==="enum"?d.values:null}evaluateWithoutErrorHandling(c,d,x,T,D,F){return this._evaluator.globals=c,this._evaluator.feature=d,this._evaluator.featureState=x,this._evaluator.canonical=T,this._evaluator.availableImages=D||null,this._evaluator.formattedSection=F,this.expression.evaluate(this._evaluator)}evaluate(c,d,x,T,D,F){this._evaluator.globals=c,this._evaluator.feature=d||null,this._evaluator.featureState=x||null,this._evaluator.canonical=T,this._evaluator.availableImages=D||null,this._evaluator.formattedSection=F||null;try{const V=this.expression.evaluate(this._evaluator);if(V==null||typeof V=="number"&&V!=V)return this._defaultValue;if(this._enumValues&&!(V in this._enumValues))throw new Wn(`Expected value to be one of ${Object.keys(this._enumValues).map((X=>JSON.stringify(X))).join(", ")}, but found ${JSON.stringify(V)} instead.`);return V}catch(V){return this._warningHistory[V.message]||(this._warningHistory[V.message]=!0,typeof console<"u"&&console.warn(V.message)),this._defaultValue}}}function _f(p){return Array.isArray(p)&&p.length>0&&typeof p[0]=="string"&&p[0]in Vn}function ch(p,c){const d=new _l(Vn,Ga,[],c?(function(T){const D={color:Mi,string:bn,number:zr,enum:bn,boolean:Tn,formatted:ma,padding:Gi,numberArray:xa,colorArray:Ka,projectionDefinition:pi,resolvedImage:Ui,variableAnchorOffsetCollection:oo};return T.type==="array"?Ja(D[T.value]||Fn,T.length):D[T.type]})(c):void 0),x=d.parse(p,void 0,void 0,void 0,c&&c.type==="string"?{typeAnnotation:"coerce"}:void 0);return x?Gu(new fd(x,c)):Us(d.errors)}class Bh{constructor(c,d){this.kind=c,this._styleExpression=d,this.isStateDependent=c!=="constant"&&!xs(d.expression),this.globalStateRefs=pd(d.expression)}evaluateWithoutErrorHandling(c,d,x,T,D,F){return this._styleExpression.evaluateWithoutErrorHandling(c,d,x,T,D,F)}evaluate(c,d,x,T,D,F){return this._styleExpression.evaluate(c,d,x,T,D,F)}}class dg{constructor(c,d,x,T){this.kind=c,this.zoomStops=x,this._styleExpression=d,this.isStateDependent=c!=="camera"&&!xs(d.expression),this.globalStateRefs=pd(d.expression),this.interpolationType=T}evaluateWithoutErrorHandling(c,d,x,T,D,F){return this._styleExpression.evaluateWithoutErrorHandling(c,d,x,T,D,F)}evaluate(c,d,x,T,D,F){return this._styleExpression.evaluate(c,d,x,T,D,F)}interpolationFactor(c,d,x){return this.interpolationType?wn.interpolationFactor(this.interpolationType,c,d,x):0}}function ty(p,c){const d=ch(p,c);if(d.result==="error")return d;const x=d.value.expression,T=Bo(x);if(!T&&!Zo(c))return Us([new Fr("","data expressions not supported")]);const D=Vl(x,["zoom"]);if(!D&&!uc(c))return Us([new Fr("","zoom expressions not supported")]);const F=dd(x);return F||D?F instanceof Fr?Us([F]):F instanceof wn&&!Sl(c)?Us([new Fr("",'"interpolate" expressions cannot be used with this property')]):Gu(F?new dg(T?"camera":"composite",d.value,F.labels,F instanceof wn?F.interpolation:void 0):new Bh(T?"constant":"source",d.value)):Us([new Fr("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class bf{constructor(c,d){this._parameters=c,this._specification=d,Ir(this,uh(this._parameters,this._specification))}static deserialize(c){return new bf(c._parameters,c._specification)}static serialize(c){return{_parameters:c._parameters,_specification:c._specification}}}function dd(p){let c=null;if(p instanceof Co)c=dd(p.result);else if(p instanceof Ii){for(const d of p.args)if(c=dd(d),c)break}else(p instanceof dt||p instanceof wn)&&p.input instanceof In&&p.input.name==="zoom"&&(c=p);return c instanceof Fr||p.eachChild((d=>{const x=dd(d);x instanceof Fr?c=x:!c&&x?c=new Fr("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):c&&x&&c!==x&&(c=new Fr("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))})),c}function pd(p,c=new Set){return p instanceof Rn&&c.add(p.key),p.eachChild((d=>{pd(d,c)})),c}function op(p){if(p===!0||p===!1)return!0;if(!Array.isArray(p)||p.length===0)return!1;switch(p[0]){case"has":return p.length>=2&&p[1]!=="$id"&&p[1]!=="$type";case"in":return p.length>=3&&(typeof p[1]!="string"||Array.isArray(p[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return p.length!==3||Array.isArray(p[1])||Array.isArray(p[2]);case"any":case"all":for(const c of p.slice(1))if(!op(c)&&typeof c!="boolean")return!1;return!0;default:return!0}}const pg={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function zh(p){if(p==null)return{filter:()=>!0,needGeometry:!1,getGlobalStateRefs:()=>new Set};op(p)||(p=Xu(p));const c=ch(p,pg);if(c.result==="error")throw new Error(c.value.map((d=>`${d.key}: ${d.message}`)).join(", "));return{filter:(d,x,T)=>c.value.evaluate(d,x,{},T),needGeometry:xf(p),getGlobalStateRefs:()=>pd(c.value.expression)}}function gd(p,c){return p<c?-1:p>c?1:0}function xf(p){if(!Array.isArray(p))return!1;if(p[0]==="within"||p[0]==="distance")return!0;for(let c=1;c<p.length;c++)if(xf(p[c]))return!0;return!1}function Xu(p){if(!p)return!0;const c=p[0];return p.length<=1?c!=="any":c==="=="?gg(p[1],p[2],"=="):c==="!="?sp(gg(p[1],p[2],"==")):c==="<"||c===">"||c==="<="||c===">="?gg(p[1],p[2],c):c==="any"?(d=p.slice(1),["any"].concat(d.map(Xu))):c==="all"?["all"].concat(p.slice(1).map(Xu)):c==="none"?["all"].concat(p.slice(1).map(Xu).map(sp)):c==="in"?ry(p[1],p.slice(2)):c==="!in"?sp(ry(p[1],p.slice(2))):c==="has"?mg(p[1]):c!=="!has"||sp(mg(p[1]));var d}function gg(p,c,d){switch(p){case"$type":return[`filter-type-${d}`,c];case"$id":return[`filter-id-${d}`,c];default:return[`filter-${d}`,p,c]}}function ry(p,c){if(c.length===0)return!1;switch(p){case"$type":return["filter-type-in",["literal",c]];case"$id":return["filter-id-in",["literal",c]];default:return c.length>200&&!c.some((d=>typeof d!=typeof c[0]))?["filter-in-large",p,["literal",c.sort(gd)]]:["filter-in-small",p,["literal",c]]}}function mg(p){switch(p){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",p]}}function sp(p){return["!",p]}function yg(p){const c=typeof p;if(c==="number"||c==="boolean"||c==="string"||p==null)return JSON.stringify(p);if(Array.isArray(p)){let T="[";for(const D of p)T+=`${yg(D)},`;return`${T}]`}const d=Object.keys(p).sort();let x="{";for(let T=0;T<d.length;T++)x+=`${JSON.stringify(d[T])}:${yg(p[d[T]])},`;return`${x}}`}function Y0(p){let c="";for(const d of Tr)c+=`/${yg(p[d])}`;return c}function vg(p){const c=p.value;return c?[new pt(p.key,c,"constants have been deprecated as of v8")]:[]}function va(p){return p instanceof Number||p instanceof String||p instanceof Boolean?p.valueOf():p}function Ko(p){if(Array.isArray(p))return p.map(Ko);if(p instanceof Object&&!(p instanceof Number||p instanceof String||p instanceof Boolean)){const c={};for(const d in p)c[d]=Ko(p[d]);return c}return va(p)}function Jo(p){const c=p.key,d=p.value,x=p.valueSpec||{},T=p.objectElementValidators||{},D=p.style,F=p.styleSpec,V=p.validateSpec;let X=[];const ae=Zn(d);if(ae!=="object")return[new pt(c,d,`object expected, ${ae} found`)];for(const se in d){const ve=se.split(".")[0],Le=Xe(x,ve)||x["*"];let ze;if(Xe(T,ve))ze=T[ve];else if(Xe(x,ve))ze=V;else if(T["*"])ze=T["*"];else{if(!x["*"]){X.push(new pt(c,d[se],`unknown property "${se}"`));continue}ze=V}X=X.concat(ze({key:(c&&`${c}.`)+se,value:d[se],valueSpec:Le,style:D,styleSpec:F,object:d,objectKey:se,validateSpec:V},d))}for(const se in x)T[se]||x[se].required&&x[se].default===void 0&&d[se]===void 0&&X.push(new pt(c,d,`missing required property "${se}"`));return X}function lp(p){const c=p.value,d=p.valueSpec,x=p.style,T=p.styleSpec,D=p.key,F=p.arrayElementValidator||p.validateSpec;if(Zn(c)!=="array")return[new pt(D,c,`array expected, ${Zn(c)} found`)];if(d.length&&c.length!==d.length)return[new pt(D,c,`array length ${d.length} expected, length ${c.length} found`)];if(d["min-length"]&&c.length<d["min-length"])return[new pt(D,c,`array length at least ${d["min-length"]} expected, length ${c.length} found`)];let V={type:d.value,values:d.values};T.$version<7&&(V.function=d.function),Zn(d.value)==="object"&&(V=d.value);let X=[];for(let ae=0;ae<c.length;ae++)X=X.concat(F({array:c,arrayIndex:ae,value:c[ae],valueSpec:V,validateSpec:p.validateSpec,style:x,styleSpec:T,key:`${D}[${ae}]`}));return X}function wf(p){const c=p.key,d=p.value,x=p.valueSpec;let T=Zn(d);return T==="number"&&d!=d&&(T="NaN"),T!=="number"?[new pt(c,d,`number expected, ${T} found`)]:"minimum"in x&&d<x.minimum?[new pt(c,d,`${d} is less than the minimum value ${x.minimum}`)]:"maximum"in x&&d>x.maximum?[new pt(c,d,`${d} is greater than the maximum value ${x.maximum}`)]:[]}function Lc(p){const c=p.valueSpec,d=va(p.value.type);let x,T,D,F={};const V=d!=="categorical"&&p.value.property===void 0,X=!V,ae=Zn(p.value.stops)==="array"&&Zn(p.value.stops[0])==="array"&&Zn(p.value.stops[0][0])==="object",se=Jo({key:p.key,value:p.value,valueSpec:p.styleSpec.function,validateSpec:p.validateSpec,style:p.style,styleSpec:p.styleSpec,objectElementValidators:{stops:function(ze){if(d==="identity")return[new pt(ze.key,ze.value,'identity function may not have a "stops" property')];let Ue=[];const Ze=ze.value;return Ue=Ue.concat(lp({key:ze.key,value:Ze,valueSpec:ze.valueSpec,validateSpec:ze.validateSpec,style:ze.style,styleSpec:ze.styleSpec,arrayElementValidator:ve})),Zn(Ze)==="array"&&Ze.length===0&&Ue.push(new pt(ze.key,Ze,"array must have at least one stop")),Ue},default:function(ze){return ze.validateSpec({key:ze.key,value:ze.value,valueSpec:c,validateSpec:ze.validateSpec,style:ze.style,styleSpec:ze.styleSpec})}}});return d==="identity"&&V&&se.push(new pt(p.key,p.value,'missing required property "property"')),d==="identity"||p.value.stops||se.push(new pt(p.key,p.value,'missing required property "stops"')),d==="exponential"&&p.valueSpec.expression&&!Sl(p.valueSpec)&&se.push(new pt(p.key,p.value,"exponential functions not supported")),p.styleSpec.$version>=8&&(X&&!Zo(p.valueSpec)?se.push(new pt(p.key,p.value,"property functions not supported")):V&&!uc(p.valueSpec)&&se.push(new pt(p.key,p.value,"zoom functions not supported"))),d!=="categorical"&&!ae||p.value.property!==void 0||se.push(new pt(p.key,p.value,'"property" property is required')),se;function ve(ze){let Ue=[];const Ze=ze.value,st=ze.key;if(Zn(Ze)!=="array")return[new pt(st,Ze,`array expected, ${Zn(Ze)} found`)];if(Ze.length!==2)return[new pt(st,Ze,`array length 2 expected, length ${Ze.length} found`)];if(ae){if(Zn(Ze[0])!=="object")return[new pt(st,Ze,`object expected, ${Zn(Ze[0])} found`)];if(Ze[0].zoom===void 0)return[new pt(st,Ze,"object stop key must have zoom")];if(Ze[0].value===void 0)return[new pt(st,Ze,"object stop key must have value")];if(D&&D>va(Ze[0].zoom))return[new pt(st,Ze[0].zoom,"stop zoom values must appear in ascending order")];va(Ze[0].zoom)!==D&&(D=va(Ze[0].zoom),T=void 0,F={}),Ue=Ue.concat(Jo({key:`${st}[0]`,value:Ze[0],valueSpec:{zoom:{}},validateSpec:ze.validateSpec,style:ze.style,styleSpec:ze.styleSpec,objectElementValidators:{zoom:wf,value:Le}}))}else Ue=Ue.concat(Le({key:`${st}[0]`,value:Ze[0],validateSpec:ze.validateSpec,style:ze.style,styleSpec:ze.styleSpec},Ze));return _f(Ko(Ze[1]))?Ue.concat([new pt(`${st}[1]`,Ze[1],"expressions are not allowed in function stops.")]):Ue.concat(ze.validateSpec({key:`${st}[1]`,value:Ze[1],valueSpec:c,validateSpec:ze.validateSpec,style:ze.style,styleSpec:ze.styleSpec}))}function Le(ze,Ue){const Ze=Zn(ze.value),st=va(ze.value),wt=ze.value!==null?ze.value:Ue;if(x){if(Ze!==x)return[new pt(ze.key,wt,`${Ze} stop domain type must match previous stop domain type ${x}`)]}else x=Ze;if(Ze!=="number"&&Ze!=="string"&&Ze!=="boolean")return[new pt(ze.key,wt,"stop domain value must be a number, string, or boolean")];if(Ze!=="number"&&d!=="categorical"){let Wt=`number expected, ${Ze} found`;return Zo(c)&&d===void 0&&(Wt+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new pt(ze.key,wt,Wt)]}return d!=="categorical"||Ze!=="number"||isFinite(st)&&Math.floor(st)===st?d!=="categorical"&&Ze==="number"&&T!==void 0&&st<T?[new pt(ze.key,wt,"stop domain values must appear in ascending order")]:(T=st,d==="categorical"&&st in F?[new pt(ze.key,wt,"stop domain values must be unique")]:(F[st]=!0,[])):[new pt(ze.key,wt,`integer expected, found ${st}`)]}}function ws(p){const c=(p.expressionContext==="property"?ty:ch)(Ko(p.value),p.valueSpec);if(c.result==="error")return c.value.map((x=>new pt(`${p.key}${x.key}`,p.value,x.message)));const d=c.value.expression||c.value._styleExpression.expression;if(p.expressionContext==="property"&&p.propertyKey==="text-font"&&!d.outputDefined())return[new pt(p.key,p.value,`Invalid data expression for "${p.propertyKey}". Output values must be contained as literals within the expression.`)];if(p.expressionContext==="property"&&p.propertyType==="layout"&&!xs(d))return[new pt(p.key,p.value,'"feature-state" data expressions are not supported with layout properties.')];if(p.expressionContext==="filter"&&!xs(d))return[new pt(p.key,p.value,'"feature-state" data expressions are not supported with filters.')];if(p.expressionContext&&p.expressionContext.indexOf("cluster")===0){if(!Vl(d,["zoom","feature-state"]))return[new pt(p.key,p.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(p.expressionContext==="cluster-initial"&&!Bo(d))return[new pt(p.key,p.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function up(p){const c=p.key,d=p.value,x=Zn(d);return x!=="string"?[new pt(c,d,`color expected, ${x} found`)]:kr.parse(String(d))?[]:[new pt(c,d,`color expected, "${d}" found`)]}function Nc(p){const c=p.key,d=p.value,x=p.valueSpec,T=[];return Array.isArray(x.values)?x.values.indexOf(va(d))===-1&&T.push(new pt(c,d,`expected one of [${x.values.join(", ")}], ${JSON.stringify(d)} found`)):Object.keys(x.values).indexOf(va(d))===-1&&T.push(new pt(c,d,`expected one of [${Object.keys(x.values).join(", ")}], ${JSON.stringify(d)} found`)),T}function cp(p){return op(Ko(p.value))?ws(Ir({},p,{expressionContext:"filter",valueSpec:{value:"boolean"}})):_g(p)}function _g(p){const c=p.value,d=p.key;if(Zn(c)!=="array")return[new pt(d,c,`array expected, ${Zn(c)} found`)];const x=p.styleSpec;let T,D=[];if(c.length<1)return[new pt(d,c,"filter array must have at least 1 element")];switch(D=D.concat(Nc({key:`${d}[0]`,value:c[0],valueSpec:x.filter_operator,style:p.style,styleSpec:p.styleSpec})),va(c[0])){case"<":case"<=":case">":case">=":c.length>=2&&va(c[1])==="$type"&&D.push(new pt(d,c,`"$type" cannot be use with operator "${c[0]}"`));case"==":case"!=":c.length!==3&&D.push(new pt(d,c,`filter array for operator "${c[0]}" must have 3 elements`));case"in":case"!in":c.length>=2&&(T=Zn(c[1]),T!=="string"&&D.push(new pt(`${d}[1]`,c[1],`string expected, ${T} found`)));for(let F=2;F<c.length;F++)T=Zn(c[F]),va(c[1])==="$type"?D=D.concat(Nc({key:`${d}[${F}]`,value:c[F],valueSpec:x.geometry_type,style:p.style,styleSpec:p.styleSpec})):T!=="string"&&T!=="number"&&T!=="boolean"&&D.push(new pt(`${d}[${F}]`,c[F],`string, number, or boolean expected, ${T} found`));break;case"any":case"all":case"none":for(let F=1;F<c.length;F++)D=D.concat(_g({key:`${d}[${F}]`,value:c[F],style:p.style,styleSpec:p.styleSpec}));break;case"has":case"!has":T=Zn(c[1]),c.length!==2?D.push(new pt(d,c,`filter array for "${c[0]}" operator must have 2 elements`)):T!=="string"&&D.push(new pt(`${d}[1]`,c[1],`string expected, ${T} found`))}return D}function bg(p,c){const d=p.key,x=p.validateSpec,T=p.style,D=p.styleSpec,F=p.value,V=p.objectKey,X=D[`${c}_${p.layerType}`];if(!X)return[];const ae=V.match(/^(.*)-transition$/);if(c==="paint"&&ae&&X[ae[1]]&&X[ae[1]].transition)return x({key:d,value:F,valueSpec:D.transition,style:T,styleSpec:D});const se=p.valueSpec||X[V];if(!se)return[new pt(d,F,`unknown property "${V}"`)];let ve;if(Zn(F)==="string"&&Zo(se)&&!se.tokens&&(ve=/^{([^}]+)}$/.exec(F)))return[new pt(d,F,`"${V}" does not support interpolation syntax
Use an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(ve[1])} }\`.`)];const Le=[];return p.layerType==="symbol"&&(V==="text-field"&&T&&!T.glyphs&&Le.push(new pt(d,F,'use of "text-field" requires a style "glyphs" property')),V==="text-font"&&zo(Ko(F))&&va(F.type)==="identity"&&Le.push(new pt(d,F,'"text-font" does not support identity functions'))),Le.concat(x({key:p.key,value:F,valueSpec:se,style:T,styleSpec:D,expressionContext:"property",propertyType:c,propertyKey:V}))}function xg(p){return bg(p,"paint")}function ny(p){return bg(p,"layout")}function md(p){let c=[];const d=p.value,x=p.key,T=p.style,D=p.styleSpec;if(Zn(d)!=="object")return[new pt(x,d,`object expected, ${Zn(d)} found`)];d.type||d.ref||c.push(new pt(x,d,'either "type" or "ref" is required'));let F=va(d.type);const V=va(d.ref);if(d.id){const X=va(d.id);for(let ae=0;ae<p.arrayIndex;ae++){const se=T.layers[ae];va(se.id)===X&&c.push(new pt(x,d.id,`duplicate layer id "${d.id}", previously used at line ${se.id.__line__}`))}}if("ref"in d){let X;["type","source","source-layer","filter","layout"].forEach((ae=>{ae in d&&c.push(new pt(x,d[ae],`"${ae}" is prohibited for ref layers`))})),T.layers.forEach((ae=>{va(ae.id)===V&&(X=ae)})),X?X.ref?c.push(new pt(x,d.ref,"ref cannot reference another ref layer")):F=va(X.type):c.push(new pt(x,d.ref,`ref layer "${V}" not found`))}else if(F!=="background")if(d.source){const X=T.sources&&T.sources[d.source],ae=X&&va(X.type);X?ae==="vector"&&F==="raster"?c.push(new pt(x,d.source,`layer "${d.id}" requires a raster source`)):ae!=="raster-dem"&&F==="hillshade"||ae!=="raster-dem"&&F==="color-relief"?c.push(new pt(x,d.source,`layer "${d.id}" requires a raster-dem source`)):ae==="raster"&&F!=="raster"?c.push(new pt(x,d.source,`layer "${d.id}" requires a vector source`)):ae!=="vector"||d["source-layer"]?ae==="raster-dem"&&F!=="hillshade"&&F!=="color-relief"?c.push(new pt(x,d.source,"raster-dem source can only be used with layer type 'hillshade' or 'color-relief'.")):F!=="line"||!d.paint||!d.paint["line-gradient"]||ae==="geojson"&&X.lineMetrics||c.push(new pt(x,d,`layer "${d.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):c.push(new pt(x,d,`layer "${d.id}" must specify a "source-layer"`)):c.push(new pt(x,d.source,`source "${d.source}" not found`))}else c.push(new pt(x,d,'missing required property "source"'));return c=c.concat(Jo({key:x,value:d,valueSpec:D.layer,style:p.style,styleSpec:p.styleSpec,validateSpec:p.validateSpec,objectElementValidators:{"*":()=>[],type:()=>p.validateSpec({key:`${x}.type`,value:d.type,valueSpec:D.layer.type,style:p.style,styleSpec:p.styleSpec,validateSpec:p.validateSpec,object:d,objectKey:"type"}),filter:cp,layout:X=>Jo({layer:d,key:X.key,value:X.value,style:X.style,styleSpec:X.styleSpec,validateSpec:X.validateSpec,objectElementValidators:{"*":ae=>ny(Ir({layerType:F},ae))}}),paint:X=>Jo({layer:d,key:X.key,value:X.value,style:X.style,styleSpec:X.styleSpec,validateSpec:X.validateSpec,objectElementValidators:{"*":ae=>xg(Ir({layerType:F},ae))}})}})),c}function ql(p){const c=p.value,d=p.key,x=Zn(c);return x!=="string"?[new pt(d,c,`string expected, ${x} found`)]:[]}const hc={promoteId:function({key:p,value:c}){if(Zn(c)==="string")return ql({key:p,value:c});{const d=[];for(const x in c)d.push(...ql({key:`${p}.${x}`,value:c[x]}));return d}}};function al(p){const c=p.value,d=p.key,x=p.styleSpec,T=p.style,D=p.validateSpec;if(!c.type)return[new pt(d,c,'"type" is required')];const F=va(c.type);let V;switch(F){case"vector":case"raster":return V=Jo({key:d,value:c,valueSpec:x[`source_${F.replace("-","_")}`],style:p.style,styleSpec:x,objectElementValidators:hc,validateSpec:D}),V;case"raster-dem":return V=(function(X){var ae;const se=(ae=X.sourceName)!==null&&ae!==void 0?ae:"",ve=X.value,Le=X.styleSpec,ze=Le.source_raster_dem,Ue=X.style;let Ze=[];const st=Zn(ve);if(ve===void 0)return Ze;if(st!=="object")return Ze.push(new pt("source_raster_dem",ve,`object expected, ${st} found`)),Ze;const wt=va(ve.encoding)==="custom",Wt=["redFactor","greenFactor","blueFactor","baseShift"],Rt=X.value.encoding?`"${X.value.encoding}"`:"Default";for(const Ft in ve)!wt&&Wt.includes(Ft)?Ze.push(new pt(Ft,ve[Ft],`In "${se}": "${Ft}" is only valid when "encoding" is set to "custom". ${Rt} encoding found`)):ze[Ft]?Ze=Ze.concat(X.validateSpec({key:Ft,value:ve[Ft],valueSpec:ze[Ft],validateSpec:X.validateSpec,style:Ue,styleSpec:Le})):Ze.push(new pt(Ft,ve[Ft],`unknown property "${Ft}"`));return Ze})({sourceName:d,value:c,style:p.style,styleSpec:x,validateSpec:D}),V;case"geojson":if(V=Jo({key:d,value:c,valueSpec:x.source_geojson,style:T,styleSpec:x,validateSpec:D,objectElementValidators:hc}),c.cluster)for(const X in c.clusterProperties){const[ae,se]=c.clusterProperties[X],ve=typeof ae=="string"?[ae,["accumulated"],["get",X]]:ae;V.push(...ws({key:`${d}.${X}.map`,value:se,expressionContext:"cluster-map"})),V.push(...ws({key:`${d}.${X}.reduce`,value:ve,expressionContext:"cluster-reduce"}))}return V;case"video":return Jo({key:d,value:c,valueSpec:x.source_video,style:T,validateSpec:D,styleSpec:x});case"image":return Jo({key:d,value:c,valueSpec:x.source_image,style:T,validateSpec:D,styleSpec:x});case"canvas":return[new pt(d,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Nc({key:`${d}.type`,value:c.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]}})}}function Sf(p){const c=p.value,d=p.styleSpec,x=d.light,T=p.style;let D=[];const F=Zn(c);if(c===void 0)return D;if(F!=="object")return D=D.concat([new pt("light",c,`object expected, ${F} found`)]),D;for(const V in c){const X=V.match(/^(.*)-transition$/);D=D.concat(X&&x[X[1]]&&x[X[1]].transition?p.validateSpec({key:V,value:c[V],valueSpec:d.transition,validateSpec:p.validateSpec,style:T,styleSpec:d}):x[V]?p.validateSpec({key:V,value:c[V],valueSpec:x[V],validateSpec:p.validateSpec,style:T,styleSpec:d}):[new pt(V,c[V],`unknown property "${V}"`)])}return D}function hp(p){const c=p.value,d=p.styleSpec,x=d.sky,T=p.style,D=Zn(c);if(c===void 0)return[];if(D!=="object")return[new pt("sky",c,`object expected, ${D} found`)];let F=[];for(const V in c)F=F.concat(x[V]?p.validateSpec({key:V,value:c[V],valueSpec:x[V],style:T,styleSpec:d}):[new pt(V,c[V],`unknown property "${V}"`)]);return F}function iy(p){const c=p.value,d=p.styleSpec,x=d.terrain,T=p.style;let D=[];const F=Zn(c);if(c===void 0)return D;if(F!=="object")return D=D.concat([new pt("terrain",c,`object expected, ${F} found`)]),D;for(const V in c)D=D.concat(x[V]?p.validateSpec({key:V,value:c[V],valueSpec:x[V],validateSpec:p.validateSpec,style:T,styleSpec:d}):[new pt(V,c[V],`unknown property "${V}"`)]);return D}function ay(p){let c=[];const d=p.value,x=p.key;if(Array.isArray(d)){const T=[],D=[];for(const F in d)d[F].id&&T.includes(d[F].id)&&c.push(new pt(x,d,`all the sprites' ids must be unique, but ${d[F].id} is duplicated`)),T.push(d[F].id),d[F].url&&D.includes(d[F].url)&&c.push(new pt(x,d,`all the sprites' URLs must be unique, but ${d[F].url} is duplicated`)),D.push(d[F].url),c=c.concat(Jo({key:`${x}[${F}]`,value:d[F],valueSpec:{id:{type:"string",required:!0},url:{type:"string",required:!0}},validateSpec:p.validateSpec}));return c}return ql({key:x,value:d})}function Ef(p){return c=p.value,c&&c.constructor===Object?[]:[new pt(p.key,p.value,`object expected, ${Zn(p.value)} found`)];var c}const wg={"*":()=>[],array:lp,boolean:function(p){const c=p.value,d=p.key,x=Zn(c);return x!=="boolean"?[new pt(d,c,`boolean expected, ${x} found`)]:[]},number:wf,color:up,constants:vg,enum:Nc,filter:cp,function:Lc,layer:md,object:Jo,source:al,light:Sf,sky:hp,terrain:iy,projection:function(p){const c=p.value,d=p.styleSpec,x=d.projection,T=p.style,D=Zn(c);if(c===void 0)return[];if(D!=="object")return[new pt("projection",c,`object expected, ${D} found`)];let F=[];for(const V in c)F=F.concat(x[V]?p.validateSpec({key:V,value:c[V],valueSpec:x[V],style:T,styleSpec:d}):[new pt(V,c[V],`unknown property "${V}"`)]);return F},projectionDefinition:function(p){const c=p.key;let d=p.value;d=d instanceof String?d.valueOf():d;const x=Zn(d);return x!=="array"||(function(T){return Array.isArray(T)&&T.length===3&&typeof T[0]=="string"&&typeof T[1]=="string"&&typeof T[2]=="number"})(d)||(function(T){return!!["interpolate","step","literal"].includes(T[0])})(d)?["array","string"].includes(x)?[]:[new pt(c,d,`projection expected, invalid type "${x}" found`)]:[new pt(c,d,`projection expected, invalid array ${JSON.stringify(d)} found`)]},string:ql,formatted:function(p){return ql(p).length===0?[]:ws(p)},resolvedImage:function(p){return ql(p).length===0?[]:ws(p)},padding:function(p){const c=p.key,d=p.value;if(Zn(d)==="array"){if(d.length<1||d.length>4)return[new pt(c,d,`padding requires 1 to 4 values; ${d.length} values found`)];const x={type:"number"};let T=[];for(let D=0;D<d.length;D++)T=T.concat(p.validateSpec({key:`${c}[${D}]`,value:d[D],validateSpec:p.validateSpec,valueSpec:x}));return T}return wf({key:c,value:d,valueSpec:{}})},numberArray:function(p){const c=p.key,d=p.value;if(Zn(d)==="array"){const x={type:"number"};if(d.length<1)return[new pt(c,d,"array length at least 1 expected, length 0 found")];let T=[];for(let D=0;D<d.length;D++)T=T.concat(p.validateSpec({key:`${c}[${D}]`,value:d[D],validateSpec:p.validateSpec,valueSpec:x}));return T}return wf({key:c,value:d,valueSpec:{}})},colorArray:function(p){const c=p.key,d=p.value;if(Zn(d)==="array"){if(d.length<1)return[new pt(c,d,"array length at least 1 expected, length 0 found")];let x=[];for(let T=0;T<d.length;T++)x=x.concat(up({key:`${c}[${T}]`,value:d[T]}));return x}return up({key:c,value:d})},variableAnchorOffsetCollection:function(p){const c=p.key,d=p.value,x=Zn(d),T=p.styleSpec;if(x!=="array"||d.length<1||d.length%2!=0)return[new pt(c,d,"variableAnchorOffsetCollection requires a non-empty array of even length")];let D=[];for(let F=0;F<d.length;F+=2)D=D.concat(Nc({key:`${c}[${F}]`,value:d[F],valueSpec:T.layout_symbol["text-anchor"]})),D=D.concat(lp({key:`${c}[${F+1}]`,value:d[F+1],valueSpec:{length:2,value:"number"},validateSpec:p.validateSpec,style:p.style,styleSpec:T}));return D},sprite:ay,state:Ef};function Tf(p){const c=p.value,d=p.valueSpec,x=p.styleSpec;return p.validateSpec=Tf,d.expression&&zo(va(c))?Lc(p):d.expression&&_f(Ko(c))?ws(p):d.type&&wg[d.type]?wg[d.type](p):Jo(Ir({},p,{valueSpec:d.type?x[d.type]:d}))}function oy(p){const c=p.value,d=p.key,x=ql(p);return x.length||(c.indexOf("{fontstack}")===-1&&x.push(new pt(d,c,'"glyphs" url must include a "{fontstack}" token')),c.indexOf("{range}")===-1&&x.push(new pt(d,c,'"glyphs" url must include a "{range}" token'))),x}function El(p,c=bt){let d=[];return d=d.concat(Tf({key:"",value:p,valueSpec:c.$root,styleSpec:c,style:p,validateSpec:Tf,objectElementValidators:{glyphs:oy,"*":()=>[]}})),p.constants&&(d=d.concat(vg({key:"constants",value:p.constants}))),Cf(d)}function Hl(p){return function(c){return p({...c,validateSpec:Tf})}}function Cf(p){return[].concat(p).sort(((c,d)=>c.line-d.line))}function Yu(p){return function(...c){return Cf(p.apply(this,c))}}El.source=Yu(Hl(al)),El.sprite=Yu(Hl(ay)),El.glyphs=Yu(Hl(oy)),El.light=Yu(Hl(Sf)),El.sky=Yu(Hl(hp)),El.terrain=Yu(Hl(iy)),El.state=Yu(Hl(Ef)),El.layer=Yu(Hl(md)),El.filter=Yu(Hl(cp)),El.paintProperty=Yu(Hl(xg)),El.layoutProperty=Yu(Hl(ny));const jh=El,$=jh.light,Z=jh.sky,de=jh.paintProperty,Pe=jh.layoutProperty;function He(p,c){let d=!1;if(c&&c.length)for(const x of c)p.fire(new Kt(new Error(x.message))),d=!0;return d}class Je{constructor(c,d,x){const T=this.cells=[];if(c instanceof ArrayBuffer){this.arrayBuffer=c;const F=new Int32Array(this.arrayBuffer);c=F[0],this.d=(d=F[1])+2*(x=F[2]);for(let X=0;X<this.d*this.d;X++){const ae=F[3+X],se=F[3+X+1];T.push(ae===se?null:F.subarray(ae,se))}const V=F[3+T.length+1];this.keys=F.subarray(F[3+T.length],V),this.bboxes=F.subarray(V),this.insert=this._insertReadonly}else{this.d=d+2*x;for(let F=0;F<this.d*this.d;F++)T.push([]);this.keys=[],this.bboxes=[]}this.n=d,this.extent=c,this.padding=x,this.scale=d/c,this.uid=0;const D=x/d*c;this.min=-D,this.max=c+D}insert(c,d,x,T,D){this._forEachCell(d,x,T,D,this._insertCell,this.uid++,void 0,void 0),this.keys.push(c),this.bboxes.push(d),this.bboxes.push(x),this.bboxes.push(T),this.bboxes.push(D)}_insertReadonly(){throw new Error("Cannot insert into a GridIndex created from an ArrayBuffer.")}_insertCell(c,d,x,T,D,F){this.cells[D].push(F)}query(c,d,x,T,D){const F=this.min,V=this.max;if(c<=F&&d<=F&&V<=x&&V<=T&&!D)return Array.prototype.slice.call(this.keys);{const X=[];return this._forEachCell(c,d,x,T,this._queryCell,X,{},D),X}}_queryCell(c,d,x,T,D,F,V,X){const ae=this.cells[D];if(ae!==null){const se=this.keys,ve=this.bboxes;for(let Le=0;Le<ae.length;Le++){const ze=ae[Le];if(V[ze]===void 0){const Ue=4*ze;(X?X(ve[Ue+0],ve[Ue+1],ve[Ue+2],ve[Ue+3]):c<=ve[Ue+2]&&d<=ve[Ue+3]&&x>=ve[Ue+0]&&T>=ve[Ue+1])?(V[ze]=!0,F.push(se[ze])):V[ze]=!1}}}}_forEachCell(c,d,x,T,D,F,V,X){const ae=this._convertToCellCoord(c),se=this._convertToCellCoord(d),ve=this._convertToCellCoord(x),Le=this._convertToCellCoord(T);for(let ze=ae;ze<=ve;ze++)for(let Ue=se;Ue<=Le;Ue++){const Ze=this.d*Ue+ze;if((!X||X(this._convertFromCellCoord(ze),this._convertFromCellCoord(Ue),this._convertFromCellCoord(ze+1),this._convertFromCellCoord(Ue+1)))&&D.call(this,c,d,x,T,Ze,F,V,X))return}}_convertFromCellCoord(c){return(c-this.padding)/this.scale}_convertToCellCoord(c){return Math.max(0,Math.min(this.d-1,Math.floor(c*this.scale)+this.padding))}toArrayBuffer(){if(this.arrayBuffer)return this.arrayBuffer;const c=this.cells,d=3+this.cells.length+1+1;let x=0;for(let F=0;F<this.cells.length;F++)x+=this.cells[F].length;const T=new Int32Array(d+x+this.keys.length+this.bboxes.length);T[0]=this.extent,T[1]=this.n,T[2]=this.padding;let D=d;for(let F=0;F<c.length;F++){const V=c[F];T[3+F]=D,T.set(V,D),D+=V.length}return T[3+c.length]=D,T.set(this.keys,D),D+=this.keys.length,T[3+c.length+1]=D,T.set(this.bboxes,D),D+=this.bboxes.length,T.buffer}static serialize(c,d){const x=c.toArrayBuffer();return d&&d.push(x),{buffer:x}}static deserialize(c){return new Je(c.buffer)}}const tt={};function We(p,c,d={}){if(tt[p])throw new Error(`${p} is already registered.`);Object.defineProperty(c,"_classRegistryKey",{value:p,writeable:!1}),tt[p]={klass:c,omit:d.omit||[],shallow:d.shallow||[]}}We("Object",Object),We("Set",Set),We("TransferableGridIndex",Je),We("Color",kr),We("Error",Error),We("AJAXError",Qe),We("ResolvedImage",Ra),We("StylePropertyFunction",bf),We("StyleExpression",fd,{omit:["_evaluator"]}),We("ZoomDependentExpression",dg),We("ZoomConstantExpression",Bh),We("CompoundExpression",In,{omit:["_evaluate"]});for(const p in Vn)Vn[p]._classRegistryKey||We(`Expression_${p}`,Vn[p]);function ft(p){return p&&typeof ArrayBuffer<"u"&&(p instanceof ArrayBuffer||p.constructor&&p.constructor.name==="ArrayBuffer")}function Et(p){return p.$name||p.constructor._classRegistryKey}function Vt(p){return!(function(c){if(c===null||typeof c!="object")return!1;const d=Et(c);return!(!d||d==="Object")})(p)&&(p==null||typeof p=="boolean"||typeof p=="number"||typeof p=="string"||p instanceof Boolean||p instanceof Number||p instanceof String||p instanceof Date||p instanceof RegExp||p instanceof Blob||p instanceof Error||ft(p)||pr(p)||ArrayBuffer.isView(p)||p instanceof ImageData)}function vr(p,c){if(Vt(p))return(ft(p)||pr(p))&&c&&c.push(p),ArrayBuffer.isView(p)&&c&&c.push(p.buffer),p instanceof ImageData&&c&&c.push(p.data.buffer),p;if(Array.isArray(p)){const D=[];for(const F of p)D.push(vr(F,c));return D}if(typeof p!="object")throw new Error("can't serialize object of type "+typeof p);const d=Et(p);if(!d)throw new Error(`can't serialize object of unregistered class ${p.constructor.name}`);if(!tt[d])throw new Error(`${d} is not registered.`);const{klass:x}=tt[d],T=x.serialize?x.serialize(p,c):{};if(x.serialize){if(c&&T===c[c.length-1])throw new Error("statically serialized object won't survive transfer of $name property")}else{for(const D in p){if(!p.hasOwnProperty(D)||tt[d].omit.indexOf(D)>=0)continue;const F=p[D];T[D]=tt[d].shallow.indexOf(D)>=0?F:vr(F,c)}p instanceof Error&&(T.message=p.message)}if(T.$name)throw new Error("$name property is reserved for worker serialization logic.");return d!=="Object"&&(T.$name=d),T}function St(p){if(Vt(p))return p;if(Array.isArray(p))return p.map(St);if(typeof p!="object")throw new Error("can't deserialize object of type "+typeof p);const c=Et(p)||"Object";if(!tt[c])throw new Error(`can't deserialize unregistered class ${c}`);const{klass:d}=tt[c];if(!d)throw new Error(`can't deserialize unregistered class ${c}`);if(d.deserialize)return d.deserialize(p);const x=Object.create(d.prototype);for(const T of Object.keys(p)){if(T==="$name")continue;const D=p[T];x[T]=tt[c].shallow.indexOf(T)>=0?D:St(D)}return x}class Qt{constructor(){this.first=!0}update(c,d){const x=Math.floor(c);return this.first?(this.first=!1,this.lastIntegerZoom=x,this.lastIntegerZoomTime=0,this.lastZoom=c,this.lastFloorZoom=x,!0):(this.lastFloorZoom>x?(this.lastIntegerZoom=x+1,this.lastIntegerZoomTime=d):this.lastFloorZoom<x&&(this.lastIntegerZoom=x,this.lastIntegerZoomTime=d),c!==this.lastZoom&&(this.lastZoom=c,this.lastFloorZoom=x,!0))}}const Ut={"Latin-1 Supplement":p=>p>=128&&p<=255,"Hangul Jamo":p=>p>=4352&&p<=4607,Khmer:p=>p>=6016&&p<=6143,"General Punctuation":p=>p>=8192&&p<=8303,"Letterlike Symbols":p=>p>=8448&&p<=8527,"Number Forms":p=>p>=8528&&p<=8591,"Miscellaneous Technical":p=>p>=8960&&p<=9215,"Control Pictures":p=>p>=9216&&p<=9279,"Optical Character Recognition":p=>p>=9280&&p<=9311,"Enclosed Alphanumerics":p=>p>=9312&&p<=9471,"Geometric Shapes":p=>p>=9632&&p<=9727,"Miscellaneous Symbols":p=>p>=9728&&p<=9983,"Miscellaneous Symbols and Arrows":p=>p>=11008&&p<=11263,"Ideographic Description Characters":p=>p>=12272&&p<=12287,"CJK Symbols and Punctuation":p=>p>=12288&&p<=12351,Hiragana:p=>p>=12352&&p<=12447,Katakana:p=>p>=12448&&p<=12543,Kanbun:p=>p>=12688&&p<=12703,"CJK Strokes":p=>p>=12736&&p<=12783,"Enclosed CJK Letters and Months":p=>p>=12800&&p<=13055,"CJK Compatibility":p=>p>=13056&&p<=13311,"Yijing Hexagram Symbols":p=>p>=19904&&p<=19967,"CJK Unified Ideographs":p=>p>=19968&&p<=40959,"Hangul Syllables":p=>p>=44032&&p<=55215,"Private Use Area":p=>p>=57344&&p<=63743,"Vertical Forms":p=>p>=65040&&p<=65055,"CJK Compatibility Forms":p=>p>=65072&&p<=65103,"Small Form Variants":p=>p>=65104&&p<=65135,"Halfwidth and Fullwidth Forms":p=>p>=65280&&p<=65519};function Or(p){for(const c of p)if(Kn(c.charCodeAt(0)))return!0;return!1}function xr(p){for(const c of p)if(!rn(c.charCodeAt(0)))return!1;return!0}function Nr(p){const c=p.map((d=>{try{return new RegExp(`\\p{sc=${d}}`,"u").source}catch{return null}})).filter((d=>d));return new RegExp(c.join("|"),"u")}const jr=Nr(["Arab","Dupl","Mong","Ougr","Syrc"]);function rn(p){return!jr.test(String.fromCodePoint(p))}const Kr=Nr(["Bopo","Hani","Hira","Kana","Kits","Nshu","Tang","Yiii"]);function Kn(p){return!(p!==746&&p!==747&&(p<4352||!(Ut["CJK Compatibility Forms"](p)&&!(p>=65097&&p<=65103)||Ut["CJK Compatibility"](p)||Ut["CJK Strokes"](p)||!(!Ut["CJK Symbols and Punctuation"](p)||p>=12296&&p<=12305||p>=12308&&p<=12319||p===12336)||Ut["Enclosed CJK Letters and Months"](p)||Ut["Ideographic Description Characters"](p)||Ut.Kanbun(p)||Ut.Katakana(p)&&p!==12540||!(!Ut["Halfwidth and Fullwidth Forms"](p)||p===65288||p===65289||p===65293||p>=65306&&p<=65310||p===65339||p===65341||p===65343||p>=65371&&p<=65503||p===65507||p>=65512&&p<=65519)||!(!Ut["Small Form Variants"](p)||p>=65112&&p<=65118||p>=65123&&p<=65126)||Ut["Vertical Forms"](p)||Ut["Yijing Hexagram Symbols"](p)||new RegExp("\\p{sc=Cans}","u").test(String.fromCodePoint(p))||new RegExp("\\p{sc=Hang}","u").test(String.fromCodePoint(p))||Kr.test(String.fromCodePoint(p)))))}function zn(p){return!(Kn(p)||(function(c){return!!(Ut["Latin-1 Supplement"](c)&&(c===167||c===169||c===174||c===177||c===188||c===189||c===190||c===215||c===247)||Ut["General Punctuation"](c)&&(c===8214||c===8224||c===8225||c===8240||c===8241||c===8251||c===8252||c===8258||c===8263||c===8264||c===8265||c===8273)||Ut["Letterlike Symbols"](c)||Ut["Number Forms"](c)||Ut["Miscellaneous Technical"](c)&&(c>=8960&&c<=8967||c>=8972&&c<=8991||c>=8996&&c<=9e3||c===9003||c>=9085&&c<=9114||c>=9150&&c<=9165||c===9167||c>=9169&&c<=9179||c>=9186&&c<=9215)||Ut["Control Pictures"](c)&&c!==9251||Ut["Optical Character Recognition"](c)||Ut["Enclosed Alphanumerics"](c)||Ut["Geometric Shapes"](c)||Ut["Miscellaneous Symbols"](c)&&!(c>=9754&&c<=9759)||Ut["Miscellaneous Symbols and Arrows"](c)&&(c>=11026&&c<=11055||c>=11088&&c<=11097||c>=11192&&c<=11243)||Ut["CJK Symbols and Punctuation"](c)||Ut.Katakana(c)||Ut["Private Use Area"](c)||Ut["CJK Compatibility Forms"](c)||Ut["Small Form Variants"](c)||Ut["Halfwidth and Fullwidth Forms"](c)||c===8734||c===8756||c===8757||c>=9984&&c<=10087||c>=10102&&c<=10131||c===65532||c===65533)})(p))}const Li=Nr(["Adlm","Arab","Armi","Avst","Chrs","Cprt","Egyp","Elym","Gara","Hatr","Hebr","Hung","Khar","Lydi","Mand","Mani","Mend","Merc","Mero","Narb","Nbat","Nkoo","Orkh","Palm","Phli","Phlp","Phnx","Prti","Rohg","Samr","Sarb","Sogo","Syrc","Thaa","Todr","Yezi"]);function Gn(p){return Li.test(String.fromCodePoint(p))}function ea(p,c){return!(!c&&Gn(p)||p>=2304&&p<=3583||p>=3840&&p<=4255||Ut.Khmer(p))}function Qo(p){for(const c of p)if(Gn(c.charCodeAt(0)))return!0;return!1}const yi=new class{constructor(){this.TIMEOUT=5e3,this.applyArabicShaping=null,this.processBidirectionalText=null,this.processStyledBidirectionalText=null,this.pluginStatus="unavailable",this.pluginURL=null,this.loadScriptResolve=()=>{}}setState(p){this.pluginStatus=p.pluginStatus,this.pluginURL=p.pluginURL}getState(){return{pluginStatus:this.pluginStatus,pluginURL:this.pluginURL}}setMethods(p){if(yi.isParsed())throw new Error("RTL text plugin already registered.");this.applyArabicShaping=p.applyArabicShaping,this.processBidirectionalText=p.processBidirectionalText,this.processStyledBidirectionalText=p.processStyledBidirectionalText,this.loadScriptResolve()}isParsed(){return this.applyArabicShaping!=null&&this.processBidirectionalText!=null&&this.processStyledBidirectionalText!=null}getRTLTextPluginStatus(){return this.pluginStatus}syncState(p,c){return o(this,void 0,void 0,(function*(){if(this.isParsed())return this.getState();if(p.pluginStatus!=="loading")return this.setState(p),p;const d=p.pluginURL,x=new Promise((D=>{this.loadScriptResolve=D}));c(d);const T=new Promise((D=>setTimeout((()=>D()),this.TIMEOUT)));if(yield Promise.race([x,T]),this.isParsed()){const D={pluginStatus:"loaded",pluginURL:d};return this.setState(D),D}throw this.setState({pluginStatus:"error",pluginURL:""}),new Error(`RTL Text Plugin failed to import scripts from ${d}`)}))}};class mn{constructor(c,d){this.zoom=c,d?(this.now=d.now||0,this.fadeDuration=d.fadeDuration||0,this.zoomHistory=d.zoomHistory||new Qt,this.transition=d.transition||{},this.globalState=d.globalState||{}):(this.now=0,this.fadeDuration=0,this.zoomHistory=new Qt,this.transition={},this.globalState={})}isSupportedScript(c){return(function(d,x){for(const T of d)if(!ea(T.charCodeAt(0),x))return!1;return!0})(c,yi.getRTLTextPluginStatus()==="loaded")}crossFadingFactor(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){const c=this.zoom,d=c-Math.floor(c),x=this.crossFadingFactor();return c>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:d+(1-d)*x}:{fromScale:.5,toScale:1,t:1-(1-x)*d}}}class _n{constructor(c,d){this.property=c,this.value=d,this.expression=(function(x,T){if(zo(x))return new bf(x,T);if(_f(x)){const D=ty(x,T);if(D.result==="error")throw new Error(D.value.map((F=>`${F.key}: ${F.message}`)).join(", "));return D.value}{let D=x;return T.type==="color"&&typeof x=="string"?D=kr.parse(x):T.type!=="padding"||typeof x!="number"&&!Array.isArray(x)?T.type!=="numberArray"||typeof x!="number"&&!Array.isArray(x)?T.type!=="colorArray"||typeof x!="string"&&!Array.isArray(x)?T.type==="variableAnchorOffsetCollection"&&Array.isArray(x)?D=Ci.parse(x):T.type==="projectionDefinition"&&typeof x=="string"&&(D=gi.parse(x)):D=cn.parse(x):D=Mr.parse(x):D=pn.parse(x),{globalStateRefs:new Set,kind:"constant",evaluate:()=>D}}})(d===void 0?c.specification.default:d,c.specification),this._evaluate=this.expression.evaluate}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}getGlobalStateRefs(){return this.expression.globalStateRefs||new Set}possiblyEvaluate(c,d,x){return this.property.possiblyEvaluate(this,c,d,x)}setGlobalState(c){this.expression.evaluate=(d,x,T,D,F,V)=>(d.globalState=c,this._evaluate.call(this.expression,d,x,T,D,F,V))}}class So{constructor(c){this.property=c,this.value=new _n(c,void 0)}transitioned(c,d){return new ta(this.property,this.value,d,De({},c.transition,this.transition),c.now)}untransitioned(){return new ta(this.property,this.value,null,{},0)}}class ki{constructor(c){this._properties=c,this._values=Object.create(c.defaultTransitionablePropertyValues)}getValue(c){return Ie(this._values[c].value.value)}setValue(c,d){Object.prototype.hasOwnProperty.call(this._values,c)||(this._values[c]=new So(this._values[c].property)),this._values[c].value=new _n(this._values[c].property,d===null?void 0:Ie(d))}getTransition(c){return Ie(this._values[c].transition)}setTransition(c,d){Object.prototype.hasOwnProperty.call(this._values,c)||(this._values[c]=new So(this._values[c].property)),this._values[c].transition=Ie(d)||void 0}serialize(){const c={};for(const d of Object.keys(this._values)){const x=this.getValue(d);x!==void 0&&(c[d]=x);const T=this.getTransition(d);T!==void 0&&(c[`${d}-transition`]=T)}return c}transitioned(c,d){const x=new za(this._properties);for(const T of Object.keys(this._values))x._values[T]=this._values[T].transitioned(c,d._values[T]);return x}untransitioned(){const c=new za(this._properties);for(const d of Object.keys(this._values))c._values[d]=this._values[d].untransitioned();return c}}class ta{constructor(c,d,x,T,D){this.property=c,this.value=d,this.begin=D+T.delay||0,this.end=this.begin+T.duration||0,c.specification.transition&&(T.delay||T.duration)&&(this.prior=x)}possiblyEvaluate(c,d,x){const T=c.now||0,D=this.value.possiblyEvaluate(c,d,x),F=this.prior;if(F){if(T>this.end)return this.prior=null,D;if(this.value.isDataDriven())return this.prior=null,D;if(T<this.begin)return F.possiblyEvaluate(c,d,x);{const V=(T-this.begin)/(this.end-this.begin);return this.property.interpolate(F.possiblyEvaluate(c,d,x),D,Ee(V))}}return D}}class za{constructor(c){this._properties=c,this._values=Object.create(c.defaultTransitioningPropertyValues)}possiblyEvaluate(c,d,x){const T=new to(this._properties);for(const D of Object.keys(this._values))T._values[D]=this._values[D].possiblyEvaluate(c,d,x);return T}hasTransition(){for(const c of Object.keys(this._values))if(this._values[c].prior)return!0;return!1}}class Ss{constructor(c){this._properties=c,this._values=Object.create(c.defaultPropertyValues),this._globalState={}}hasValue(c){return this._values[c].value!==void 0}getValue(c){return Ie(this._values[c].value)}setValue(c,d){this._values[c]=new _n(this._values[c].property,d===null?void 0:Ie(d)),this._values[c].setGlobalState(this._globalState)}serialize(){const c={};for(const d of Object.keys(this._values)){const x=this.getValue(d);x!==void 0&&(c[d]=x)}return c}possiblyEvaluate(c,d,x){const T=new to(this._properties);for(const D of Object.keys(this._values))T._values[D]=this._values[D].possiblyEvaluate(c,d,x);return T}setGlobalState(c){this._globalState=c;for(const d of Object.values(this._values))d.setGlobalState(c)}}class fo{constructor(c,d,x){this.property=c,this.value=d,this.parameters=x}isConstant(){return this.value.kind==="constant"}constantOr(c){return this.value.kind==="constant"?this.value.value:c}evaluate(c,d,x,T){return this.property.evaluate(this.value,this.parameters,c,d,x,T)}}class to{constructor(c){this._properties=c,this._values=Object.create(c.defaultPossiblyEvaluatedValues)}get(c){return this._values[c]}}class xn{constructor(c){this.specification=c}possiblyEvaluate(c,d){if(c.isDataDriven())throw new Error("Value should not be data driven");return c.expression.evaluate(d)}interpolate(c,d,x){const T=oi[this.specification.type];return T?T(c,d,x):c}}class On{constructor(c,d){this.specification=c,this.overrides=d}possiblyEvaluate(c,d,x,T){return new fo(this,c.expression.kind==="constant"||c.expression.kind==="camera"?{kind:"constant",value:c.expression.evaluate(d,null,{},x,T)}:c.expression,d)}interpolate(c,d,x){if(c.value.kind!=="constant"||d.value.kind!=="constant")return c;if(c.value.value===void 0||d.value.value===void 0)return new fo(this,{kind:"constant",value:void 0},c.parameters);const T=oi[this.specification.type];if(T){const D=T(c.value.value,d.value.value,x);return new fo(this,{kind:"constant",value:D},c.parameters)}return c}evaluate(c,d,x,T,D,F){return c.kind==="constant"?c.value:c.evaluate(d,x,T,D,F)}}class Io extends On{possiblyEvaluate(c,d,x,T){if(c.value===void 0)return new fo(this,{kind:"constant",value:void 0},d);if(c.expression.kind==="constant"){const D=c.expression.evaluate(d,null,{},x,T),F=c.property.specification.type==="resolvedImage"&&typeof D!="string"?D.name:D,V=this._calculate(F,F,F,d);return new fo(this,{kind:"constant",value:V},d)}if(c.expression.kind==="camera"){const D=this._calculate(c.expression.evaluate({zoom:d.zoom-1}),c.expression.evaluate({zoom:d.zoom}),c.expression.evaluate({zoom:d.zoom+1}),d);return new fo(this,{kind:"constant",value:D},d)}return new fo(this,c.expression,d)}evaluate(c,d,x,T,D,F){if(c.kind==="source"){const V=c.evaluate(d,x,T,D,F);return this._calculate(V,V,V,d)}return c.kind==="composite"?this._calculate(c.evaluate({zoom:Math.floor(d.zoom)-1},x,T),c.evaluate({zoom:Math.floor(d.zoom)},x,T),c.evaluate({zoom:Math.floor(d.zoom)+1},x,T),d):c.value}_calculate(c,d,x,T){return T.zoom>T.zoomHistory.lastIntegerZoom?{from:c,to:d}:{from:x,to:d}}interpolate(c){return c}}class zi{constructor(c){this.specification=c}possiblyEvaluate(c,d,x,T){if(c.value!==void 0){if(c.expression.kind==="constant"){const D=c.expression.evaluate(d,null,{},x,T);return this._calculate(D,D,D,d)}return this._calculate(c.expression.evaluate(new mn(Math.floor(d.zoom-1),d)),c.expression.evaluate(new mn(Math.floor(d.zoom),d)),c.expression.evaluate(new mn(Math.floor(d.zoom+1),d)),d)}}_calculate(c,d,x,T){return T.zoom>T.zoomHistory.lastIntegerZoom?{from:c,to:d}:{from:x,to:d}}interpolate(c){return c}}class la{constructor(c){this.specification=c}possiblyEvaluate(c,d,x,T){return!!c.expression.evaluate(d,null,{},x,T)}interpolate(){return!1}}class ra{constructor(c){this.properties=c,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(const d in c){const x=c[d];x.specification.overridable&&this.overridableProperties.push(d);const T=this.defaultPropertyValues[d]=new _n(x,void 0),D=this.defaultTransitionablePropertyValues[d]=new So(x);this.defaultTransitioningPropertyValues[d]=D.untransitioned(),this.defaultPossiblyEvaluatedValues[d]=T.possiblyEvaluate({})}}}We("DataDrivenProperty",On),We("DataConstantProperty",xn),We("CrossFadedDataDrivenProperty",Io),We("CrossFadedProperty",zi),We("ColorRampProperty",la);const _a="-transition";class Oa extends Rr{constructor(c,d){if(super(),this.id=c.id,this.type=c.type,this._featureFilter={filter:()=>!0,needGeometry:!1,getGlobalStateRefs:()=>new Set},c.type!=="custom"&&(this.metadata=c.metadata,this.minzoom=c.minzoom,this.maxzoom=c.maxzoom,this._globalState={},c.type!=="background"&&(this.source=c.source,this.sourceLayer=c["source-layer"],this.filter=c.filter,this._featureFilter=zh(c.filter)),d.layout&&(this._unevaluatedLayout=new Ss(d.layout)),d.paint)){this._transitionablePaint=new ki(d.paint);for(const x in c.paint)this.setPaintProperty(x,c.paint[x],{validate:!1});for(const x in c.layout)this.setLayoutProperty(x,c.layout[x],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new to(d.paint)}}setFilter(c){this.filter=c,this._featureFilter=zh(c)}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(c){return c==="visibility"?this.visibility:this._unevaluatedLayout.getValue(c)}getLayoutAffectingGlobalStateRefs(){const c=new Set;if(this._unevaluatedLayout)for(const d in this._unevaluatedLayout._values){const x=this._unevaluatedLayout._values[d];for(const T of x.getGlobalStateRefs())c.add(T)}for(const d of this._featureFilter.getGlobalStateRefs())c.add(d);return c}getPaintAffectingGlobalStateRefs(){var c;const d=new globalThis.Map;if(this._transitionablePaint)for(const x in this._transitionablePaint._values){const T=this._transitionablePaint._values[x].value;for(const D of T.getGlobalStateRefs()){const F=(c=d.get(D))!==null&&c!==void 0?c:[];F.push({name:x,value:T.value}),d.set(D,F)}}return d}setLayoutProperty(c,d,x={}){d!=null&&this._validate(Pe,`layers.${this.id}.layout.${c}`,c,d,x)||(c!=="visibility"?this._unevaluatedLayout.setValue(c,d):this.visibility=d)}getPaintProperty(c){return c.endsWith(_a)?this._transitionablePaint.getTransition(c.slice(0,-11)):this._transitionablePaint.getValue(c)}setPaintProperty(c,d,x={}){if(d!=null&&this._validate(de,`layers.${this.id}.paint.${c}`,c,d,x))return!1;if(c.endsWith(_a))return this._transitionablePaint.setTransition(c.slice(0,-11),d||void 0),!1;{const T=this._transitionablePaint._values[c],D=T.property.specification["property-type"]==="cross-faded-data-driven",F=T.value.isDataDriven(),V=T.value;this._transitionablePaint.setValue(c,d),this._handleSpecialPaintPropertyUpdate(c);const X=this._transitionablePaint._values[c].value;return X.isDataDriven()||F||D||this._handleOverridablePaintPropertyUpdate(c,V,X)}}_handleSpecialPaintPropertyUpdate(c){}_handleOverridablePaintPropertyUpdate(c,d,x){return!1}isHidden(c){return!!(this.minzoom&&c<this.minzoom)||!!(this.maxzoom&&c>=this.maxzoom)||this.visibility==="none"}updateTransitions(c){this._transitioningPaint=this._transitionablePaint.transitioned(c,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(c,d){c.globalState=this._globalState,c.getCrossfadeParameters&&(this._crossfadeParameters=c.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(c,void 0,d)),this.paint=this._transitioningPaint.possiblyEvaluate(c,void 0,d)}setGlobalState(c){this._globalState=c,this._unevaluatedLayout&&this._unevaluatedLayout.setGlobalState(c)}serialize(){const c={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(c.layout=c.layout||{},c.layout.visibility=this.visibility),rt(c,((d,x)=>!(d===void 0||x==="layout"&&!Object.keys(d).length||x==="paint"&&!Object.keys(d).length)))}_validate(c,d,x,T,D={}){return(!D||D.validate!==!1)&&He(this,c.call(jh,{key:d,layerType:this.type,objectKey:x,value:T,styleSpec:bt,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const c in this.paint._values){const d=this.paint.get(c);if(d instanceof fo&&Zo(d.property.specification)&&(d.value.kind==="source"||d.value.kind==="composite")&&d.value.isStateDependent)return!0}return!1}}const Zu={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class ro{constructor(c,d){this._structArray=c,this._pos1=d*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class Ni{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(c,d){return c._trim(),d&&(c.isTransferred=!0,d.push(c.arrayBuffer)),{length:c.length,arrayBuffer:c.arrayBuffer}}static deserialize(c){const d=Object.create(this.prototype);return d.arrayBuffer=c.arrayBuffer,d.length=c.length,d.capacity=c.arrayBuffer.byteLength/d.bytesPerElement,d._refreshViews(),d}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(c){this.reserve(c),this.length=c}reserve(c){if(c>this.capacity){this.capacity=Math.max(c,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const d=this.uint8;this._refreshViews(),d&&this.uint8.set(d)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}}function wi(p,c=1){let d=0,x=0;return{members:p.map((T=>{const D=Zu[T.type].BYTES_PER_ELEMENT,F=d=Po(d,Math.max(c,D)),V=T.components||1;return x=Math.max(x,D),d+=D*V,{name:T.name,type:T.type,components:V,offset:F}})),size:Po(d,Math.max(x,c)),alignment:c}}function Po(p,c){return Math.ceil(p/c)*c}class Es extends Ni{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(c,d){const x=this.length;return this.resize(x+1),this.emplace(x,c,d)}emplace(c,d,x){const T=2*c;return this.int16[T+0]=d,this.int16[T+1]=x,c}}Es.prototype.bytesPerElement=4,We("StructArrayLayout2i4",Es);class es extends Ni{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(c,d,x){const T=this.length;return this.resize(T+1),this.emplace(T,c,d,x)}emplace(c,d,x,T){const D=3*c;return this.int16[D+0]=d,this.int16[D+1]=x,this.int16[D+2]=T,c}}es.prototype.bytesPerElement=6,We("StructArrayLayout3i6",es);class Tl extends Ni{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(c,d,x,T){const D=this.length;return this.resize(D+1),this.emplace(D,c,d,x,T)}emplace(c,d,x,T,D){const F=4*c;return this.int16[F+0]=d,this.int16[F+1]=x,this.int16[F+2]=T,this.int16[F+3]=D,c}}Tl.prototype.bytesPerElement=8,We("StructArrayLayout4i8",Tl);class Ts extends Ni{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(c,d,x,T,D,F){const V=this.length;return this.resize(V+1),this.emplace(V,c,d,x,T,D,F)}emplace(c,d,x,T,D,F,V){const X=6*c;return this.int16[X+0]=d,this.int16[X+1]=x,this.int16[X+2]=T,this.int16[X+3]=D,this.int16[X+4]=F,this.int16[X+5]=V,c}}Ts.prototype.bytesPerElement=12,We("StructArrayLayout2i4i12",Ts);class ts extends Ni{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(c,d,x,T,D,F){const V=this.length;return this.resize(V+1),this.emplace(V,c,d,x,T,D,F)}emplace(c,d,x,T,D,F,V){const X=4*c,ae=8*c;return this.int16[X+0]=d,this.int16[X+1]=x,this.uint8[ae+4]=T,this.uint8[ae+5]=D,this.uint8[ae+6]=F,this.uint8[ae+7]=V,c}}ts.prototype.bytesPerElement=8,We("StructArrayLayout2i4ub8",ts);class Vs extends Ni{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(c,d){const x=this.length;return this.resize(x+1),this.emplace(x,c,d)}emplace(c,d,x){const T=2*c;return this.float32[T+0]=d,this.float32[T+1]=x,c}}Vs.prototype.bytesPerElement=8,We("StructArrayLayout2f8",Vs);class Ca extends Ni{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(c,d,x,T,D,F,V,X,ae,se){const ve=this.length;return this.resize(ve+1),this.emplace(ve,c,d,x,T,D,F,V,X,ae,se)}emplace(c,d,x,T,D,F,V,X,ae,se,ve){const Le=10*c;return this.uint16[Le+0]=d,this.uint16[Le+1]=x,this.uint16[Le+2]=T,this.uint16[Le+3]=D,this.uint16[Le+4]=F,this.uint16[Le+5]=V,this.uint16[Le+6]=X,this.uint16[Le+7]=ae,this.uint16[Le+8]=se,this.uint16[Le+9]=ve,c}}Ca.prototype.bytesPerElement=20,We("StructArrayLayout10ui20",Ca);class fs extends Ni{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(c,d,x,T,D,F,V,X,ae,se,ve,Le){const ze=this.length;return this.resize(ze+1),this.emplace(ze,c,d,x,T,D,F,V,X,ae,se,ve,Le)}emplace(c,d,x,T,D,F,V,X,ae,se,ve,Le,ze){const Ue=12*c;return this.int16[Ue+0]=d,this.int16[Ue+1]=x,this.int16[Ue+2]=T,this.int16[Ue+3]=D,this.uint16[Ue+4]=F,this.uint16[Ue+5]=V,this.uint16[Ue+6]=X,this.uint16[Ue+7]=ae,this.int16[Ue+8]=se,this.int16[Ue+9]=ve,this.int16[Ue+10]=Le,this.int16[Ue+11]=ze,c}}fs.prototype.bytesPerElement=24,We("StructArrayLayout4i4ui4i24",fs);class su extends Ni{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(c,d,x){const T=this.length;return this.resize(T+1),this.emplace(T,c,d,x)}emplace(c,d,x,T){const D=3*c;return this.float32[D+0]=d,this.float32[D+1]=x,this.float32[D+2]=T,c}}su.prototype.bytesPerElement=12,We("StructArrayLayout3f12",su);class Dc extends Ni{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(c){const d=this.length;return this.resize(d+1),this.emplace(d,c)}emplace(c,d){return this.uint32[1*c+0]=d,c}}Dc.prototype.bytesPerElement=4,We("StructArrayLayout1ul4",Dc);class Au extends Ni{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(c,d,x,T,D,F,V,X,ae){const se=this.length;return this.resize(se+1),this.emplace(se,c,d,x,T,D,F,V,X,ae)}emplace(c,d,x,T,D,F,V,X,ae,se){const ve=10*c,Le=5*c;return this.int16[ve+0]=d,this.int16[ve+1]=x,this.int16[ve+2]=T,this.int16[ve+3]=D,this.int16[ve+4]=F,this.int16[ve+5]=V,this.uint32[Le+3]=X,this.uint16[ve+8]=ae,this.uint16[ve+9]=se,c}}Au.prototype.bytesPerElement=20,We("StructArrayLayout6i1ul2ui20",Au);class ds extends Ni{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(c,d,x,T,D,F){const V=this.length;return this.resize(V+1),this.emplace(V,c,d,x,T,D,F)}emplace(c,d,x,T,D,F,V){const X=6*c;return this.int16[X+0]=d,this.int16[X+1]=x,this.int16[X+2]=T,this.int16[X+3]=D,this.int16[X+4]=F,this.int16[X+5]=V,c}}ds.prototype.bytesPerElement=12,We("StructArrayLayout2i2i2i12",ds);class R extends Ni{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(c,d,x,T,D){const F=this.length;return this.resize(F+1),this.emplace(F,c,d,x,T,D)}emplace(c,d,x,T,D,F){const V=4*c,X=8*c;return this.float32[V+0]=d,this.float32[V+1]=x,this.float32[V+2]=T,this.int16[X+6]=D,this.int16[X+7]=F,c}}R.prototype.bytesPerElement=16,We("StructArrayLayout2f1f2i16",R);class l extends Ni{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(c,d,x,T,D,F){const V=this.length;return this.resize(V+1),this.emplace(V,c,d,x,T,D,F)}emplace(c,d,x,T,D,F,V){const X=16*c,ae=4*c,se=8*c;return this.uint8[X+0]=d,this.uint8[X+1]=x,this.float32[ae+1]=T,this.float32[ae+2]=D,this.int16[se+6]=F,this.int16[se+7]=V,c}}l.prototype.bytesPerElement=16,We("StructArrayLayout2ub2f2i16",l);class m extends Ni{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(c,d,x){const T=this.length;return this.resize(T+1),this.emplace(T,c,d,x)}emplace(c,d,x,T){const D=3*c;return this.uint16[D+0]=d,this.uint16[D+1]=x,this.uint16[D+2]=T,c}}m.prototype.bytesPerElement=6,We("StructArrayLayout3ui6",m);class w extends Ni{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(c,d,x,T,D,F,V,X,ae,se,ve,Le,ze,Ue,Ze,st,wt){const Wt=this.length;return this.resize(Wt+1),this.emplace(Wt,c,d,x,T,D,F,V,X,ae,se,ve,Le,ze,Ue,Ze,st,wt)}emplace(c,d,x,T,D,F,V,X,ae,se,ve,Le,ze,Ue,Ze,st,wt,Wt){const Rt=24*c,Ft=12*c,gr=48*c;return this.int16[Rt+0]=d,this.int16[Rt+1]=x,this.uint16[Rt+2]=T,this.uint16[Rt+3]=D,this.uint32[Ft+2]=F,this.uint32[Ft+3]=V,this.uint32[Ft+4]=X,this.uint16[Rt+10]=ae,this.uint16[Rt+11]=se,this.uint16[Rt+12]=ve,this.float32[Ft+7]=Le,this.float32[Ft+8]=ze,this.uint8[gr+36]=Ue,this.uint8[gr+37]=Ze,this.uint8[gr+38]=st,this.uint32[Ft+10]=wt,this.int16[Rt+22]=Wt,c}}w.prototype.bytesPerElement=48,We("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",w);class C extends Ni{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(c,d,x,T,D,F,V,X,ae,se,ve,Le,ze,Ue,Ze,st,wt,Wt,Rt,Ft,gr,Cr,Wr,yn,an,hn,Xn,ln){const fn=this.length;return this.resize(fn+1),this.emplace(fn,c,d,x,T,D,F,V,X,ae,se,ve,Le,ze,Ue,Ze,st,wt,Wt,Rt,Ft,gr,Cr,Wr,yn,an,hn,Xn,ln)}emplace(c,d,x,T,D,F,V,X,ae,se,ve,Le,ze,Ue,Ze,st,wt,Wt,Rt,Ft,gr,Cr,Wr,yn,an,hn,Xn,ln,fn){const Dr=32*c,hi=16*c;return this.int16[Dr+0]=d,this.int16[Dr+1]=x,this.int16[Dr+2]=T,this.int16[Dr+3]=D,this.int16[Dr+4]=F,this.int16[Dr+5]=V,this.int16[Dr+6]=X,this.int16[Dr+7]=ae,this.uint16[Dr+8]=se,this.uint16[Dr+9]=ve,this.uint16[Dr+10]=Le,this.uint16[Dr+11]=ze,this.uint16[Dr+12]=Ue,this.uint16[Dr+13]=Ze,this.uint16[Dr+14]=st,this.uint16[Dr+15]=wt,this.uint16[Dr+16]=Wt,this.uint16[Dr+17]=Rt,this.uint16[Dr+18]=Ft,this.uint16[Dr+19]=gr,this.uint16[Dr+20]=Cr,this.uint16[Dr+21]=Wr,this.uint16[Dr+22]=yn,this.uint32[hi+12]=an,this.float32[hi+13]=hn,this.float32[hi+14]=Xn,this.uint16[Dr+30]=ln,this.uint16[Dr+31]=fn,c}}C.prototype.bytesPerElement=64,We("StructArrayLayout8i15ui1ul2f2ui64",C);class N extends Ni{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(c){const d=this.length;return this.resize(d+1),this.emplace(d,c)}emplace(c,d){return this.float32[1*c+0]=d,c}}N.prototype.bytesPerElement=4,We("StructArrayLayout1f4",N);class j extends Ni{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(c,d,x){const T=this.length;return this.resize(T+1),this.emplace(T,c,d,x)}emplace(c,d,x,T){const D=3*c;return this.uint16[6*c+0]=d,this.float32[D+1]=x,this.float32[D+2]=T,c}}j.prototype.bytesPerElement=12,We("StructArrayLayout1ui2f12",j);class Y extends Ni{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(c,d,x){const T=this.length;return this.resize(T+1),this.emplace(T,c,d,x)}emplace(c,d,x,T){const D=4*c;return this.uint32[2*c+0]=d,this.uint16[D+2]=x,this.uint16[D+3]=T,c}}Y.prototype.bytesPerElement=8,We("StructArrayLayout1ul2ui8",Y);class te extends Ni{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(c,d){const x=this.length;return this.resize(x+1),this.emplace(x,c,d)}emplace(c,d,x){const T=2*c;return this.uint16[T+0]=d,this.uint16[T+1]=x,c}}te.prototype.bytesPerElement=4,We("StructArrayLayout2ui4",te);class ue extends Ni{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(c){const d=this.length;return this.resize(d+1),this.emplace(d,c)}emplace(c,d){return this.uint16[1*c+0]=d,c}}ue.prototype.bytesPerElement=2,We("StructArrayLayout1ui2",ue);class ge extends Ni{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(c,d,x,T){const D=this.length;return this.resize(D+1),this.emplace(D,c,d,x,T)}emplace(c,d,x,T,D){const F=4*c;return this.float32[F+0]=d,this.float32[F+1]=x,this.float32[F+2]=T,this.float32[F+3]=D,c}}ge.prototype.bytesPerElement=16,We("StructArrayLayout4f16",ge);class Ce extends ro{get anchorPointX(){return this._structArray.int16[this._pos2+0]}get anchorPointY(){return this._structArray.int16[this._pos2+1]}get x1(){return this._structArray.int16[this._pos2+2]}get y1(){return this._structArray.int16[this._pos2+3]}get x2(){return this._structArray.int16[this._pos2+4]}get y2(){return this._structArray.int16[this._pos2+5]}get featureIndex(){return this._structArray.uint32[this._pos4+3]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+8]}get bucketIndex(){return this._structArray.uint16[this._pos2+9]}get anchorPoint(){return new u(this.anchorPointX,this.anchorPointY)}}Ce.prototype.size=20;class Se extends Au{get(c){return new Ce(this,c)}}We("CollisionBoxArray",Se);class Fe extends ro{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+2]}get numGlyphs(){return this._structArray.uint16[this._pos2+3]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+2]}get lineStartIndex(){return this._structArray.uint32[this._pos4+3]}get lineLength(){return this._structArray.uint32[this._pos4+4]}get segment(){return this._structArray.uint16[this._pos2+10]}get lowerSize(){return this._structArray.uint16[this._pos2+11]}get upperSize(){return this._structArray.uint16[this._pos2+12]}get lineOffsetX(){return this._structArray.float32[this._pos4+7]}get lineOffsetY(){return this._structArray.float32[this._pos4+8]}get writingMode(){return this._structArray.uint8[this._pos1+36]}get placedOrientation(){return this._structArray.uint8[this._pos1+37]}set placedOrientation(c){this._structArray.uint8[this._pos1+37]=c}get hidden(){return this._structArray.uint8[this._pos1+38]}set hidden(c){this._structArray.uint8[this._pos1+38]=c}get crossTileID(){return this._structArray.uint32[this._pos4+10]}set crossTileID(c){this._structArray.uint32[this._pos4+10]=c}get associatedIconIndex(){return this._structArray.int16[this._pos2+22]}}Fe.prototype.size=48;class Ge extends w{get(c){return new Fe(this,c)}}We("PlacedSymbolArray",Ge);class ut extends ro{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+2]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+3]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+4]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+5]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+6]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+7]}get key(){return this._structArray.uint16[this._pos2+8]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+9]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+10]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+11]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+12]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+13]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+14]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get featureIndex(){return this._structArray.uint16[this._pos2+17]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+18]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+19]}get numIconVertices(){return this._structArray.uint16[this._pos2+20]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+21]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+22]}get crossTileID(){return this._structArray.uint32[this._pos4+12]}set crossTileID(c){this._structArray.uint32[this._pos4+12]=c}get textBoxScale(){return this._structArray.float32[this._pos4+13]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+14]}get textAnchorOffsetStartIndex(){return this._structArray.uint16[this._pos2+30]}get textAnchorOffsetEndIndex(){return this._structArray.uint16[this._pos2+31]}}ut.prototype.size=64;class lt extends C{get(c){return new ut(this,c)}}We("SymbolInstanceArray",lt);class ct extends N{getoffsetX(c){return this.float32[1*c+0]}}We("GlyphOffsetArray",ct);class xt extends es{getx(c){return this.int16[3*c+0]}gety(c){return this.int16[3*c+1]}gettileUnitDistanceFromAnchor(c){return this.int16[3*c+2]}}We("SymbolLineVertexArray",xt);class Pt extends ro{get textAnchor(){return this._structArray.uint16[this._pos2+0]}get textOffset0(){return this._structArray.float32[this._pos4+1]}get textOffset1(){return this._structArray.float32[this._pos4+2]}}Pt.prototype.size=12;class Ct extends j{get(c){return new Pt(this,c)}}We("TextAnchorOffsetArray",Ct);class Ot extends ro{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}}Ot.prototype.size=8;class Bt extends Y{get(c){return new Ot(this,c)}}We("FeatureIndexArray",Bt);class At extends Es{}class qt extends Es{}class Sr extends Es{}class fr extends Ts{}class dr extends ts{}class mr extends Vs{}class tn extends Ca{}class nn extends fs{}class qr extends su{}class Ln extends Dc{}class Pi extends ds{}class Xi extends l{}class da extends m{}class oa extends te{}const ua=wi([{name:"a_pos",components:2,type:"Int16"}],4),{members:ba}=ua;class ci{constructor(c=[]){this._forceNewSegmentOnNextPrepare=!1,this.segments=c}prepareSegment(c,d,x,T){const D=this.segments[this.segments.length-1];return c>ci.MAX_VERTEX_ARRAY_LENGTH&&at(`Max vertices per segment is ${ci.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${c}. Consider using the \`fillLargeMeshArrays\` function if you require meshes with more than ${ci.MAX_VERTEX_ARRAY_LENGTH} vertices.`),this._forceNewSegmentOnNextPrepare||!D||D.vertexLength+c>ci.MAX_VERTEX_ARRAY_LENGTH||D.sortKey!==T?this.createNewSegment(d,x,T):D}createNewSegment(c,d,x){const T={vertexOffset:c.length,primitiveOffset:d.length,vertexLength:0,primitiveLength:0,vaos:{}};return x!==void 0&&(T.sortKey=x),this._forceNewSegmentOnNextPrepare=!1,this.segments.push(T),T}getOrCreateLatestSegment(c,d,x){return this.prepareSegment(0,c,d,x)}forceNewSegmentOnNextPrepare(){this._forceNewSegmentOnNextPrepare=!0}get(){return this.segments}destroy(){for(const c of this.segments)for(const d in c.vaos)c.vaos[d].destroy()}static simpleSegment(c,d,x,T){return new ci([{vertexOffset:c,primitiveOffset:d,vertexLength:x,primitiveLength:T,vaos:{},sortKey:0}])}}function ca(p,c){return 256*(p=Oe(Math.floor(p),0,255))+Oe(Math.floor(c),0,255)}ci.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,We("SegmentVector",ci);const ko=wi([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]);var rs,Cs,$s,lu={exports:{}},Af={exports:{}},If={exports:{}},fp=(function(){if($s)return lu.exports;$s=1;var p=(rs||(rs=1,Af.exports=function(d,x){var T,D,F,V,X,ae,se,ve;for(D=d.length-(T=3&d.length),F=x,X=3432918353,ae=461845907,ve=0;ve<D;)se=255&d.charCodeAt(ve)|(255&d.charCodeAt(++ve))<<8|(255&d.charCodeAt(++ve))<<16|(255&d.charCodeAt(++ve))<<24,++ve,F=27492+(65535&(V=5*(65535&(F=(F^=se=(65535&(se=(se=(65535&se)*X+(((se>>>16)*X&65535)<<16)&4294967295)<<15|se>>>17))*ae+(((se>>>16)*ae&65535)<<16)&4294967295)<<13|F>>>19))+((5*(F>>>16)&65535)<<16)&4294967295))+((58964+(V>>>16)&65535)<<16);switch(se=0,T){case 3:se^=(255&d.charCodeAt(ve+2))<<16;case 2:se^=(255&d.charCodeAt(ve+1))<<8;case 1:F^=se=(65535&(se=(se=(65535&(se^=255&d.charCodeAt(ve)))*X+(((se>>>16)*X&65535)<<16)&4294967295)<<15|se>>>17))*ae+(((se>>>16)*ae&65535)<<16)&4294967295}return F^=d.length,F=2246822507*(65535&(F^=F>>>16))+((2246822507*(F>>>16)&65535)<<16)&4294967295,F=3266489909*(65535&(F^=F>>>13))+((3266489909*(F>>>16)&65535)<<16)&4294967295,(F^=F>>>16)>>>0}),Af.exports),c=(Cs||(Cs=1,If.exports=function(d,x){for(var T,D=d.length,F=x^D,V=0;D>=4;)T=1540483477*(65535&(T=255&d.charCodeAt(V)|(255&d.charCodeAt(++V))<<8|(255&d.charCodeAt(++V))<<16|(255&d.charCodeAt(++V))<<24))+((1540483477*(T>>>16)&65535)<<16),F=1540483477*(65535&F)+((1540483477*(F>>>16)&65535)<<16)^(T=1540483477*(65535&(T^=T>>>24))+((1540483477*(T>>>16)&65535)<<16)),D-=4,++V;switch(D){case 3:F^=(255&d.charCodeAt(V+2))<<16;case 2:F^=(255&d.charCodeAt(V+1))<<8;case 1:F=1540483477*(65535&(F^=255&d.charCodeAt(V)))+((1540483477*(F>>>16)&65535)<<16)}return F=1540483477*(65535&(F^=F>>>13))+((1540483477*(F>>>16)&65535)<<16),(F^=F>>>15)>>>0}),If.exports);return lu.exports=p,lu.exports.murmur3=p,lu.exports.murmur2=c,lu.exports})(),dp=h(fp);class yd{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(c,d,x,T){this.ids.push(vd(c)),this.positions.push(d,x,T)}getPositions(c){if(!this.indexed)throw new Error("Trying to get index, but feature positions are not indexed");const d=vd(c);let x=0,T=this.ids.length-1;for(;x<T;){const F=x+T>>1;this.ids[F]>=d?T=F:x=F+1}const D=[];for(;this.ids[x]===d;)D.push({index:this.positions[3*x],start:this.positions[3*x+1],end:this.positions[3*x+2]}),x++;return D}static serialize(c,d){const x=new Float64Array(c.ids),T=new Uint32Array(c.positions);return Iu(x,T,0,x.length-1),d&&d.push(x.buffer,T.buffer),{ids:x,positions:T}}static deserialize(c){const d=new yd;return d.ids=c.ids,d.positions=c.positions,d.indexed=!0,d}}function vd(p){const c=+p;return!isNaN(c)&&c<=Number.MAX_SAFE_INTEGER?c:dp(String(p))}function Iu(p,c,d,x){for(;d<x;){const T=p[d+x>>1];let D=d-1,F=x+1;for(;;){do D++;while(p[D]<T);do F--;while(p[F]>T);if(D>=F)break;Fc(p,D,F),Fc(c,3*D,3*F),Fc(c,3*D+1,3*F+1),Fc(c,3*D+2,3*F+2)}F-d<x-F?(Iu(p,c,d,F),d=F+1):(Iu(p,c,F+1,x),x=F)}}function Fc(p,c,d){const x=p[c];p[c]=p[d],p[d]=x}We("FeaturePositionMap",yd);class uu{constructor(c,d){this.gl=c.gl,this.location=d}}class Pf extends uu{constructor(c,d){super(c,d),this.current=0}set(c){this.current!==c&&(this.current=c,this.gl.uniform1f(this.location,c))}}class As extends uu{constructor(c,d){super(c,d),this.current=[0,0,0,0]}set(c){c[0]===this.current[0]&&c[1]===this.current[1]&&c[2]===this.current[2]&&c[3]===this.current[3]||(this.current=c,this.gl.uniform4f(this.location,c[0],c[1],c[2],c[3]))}}class qs extends uu{constructor(c,d){super(c,d),this.current=kr.transparent}set(c){c.r===this.current.r&&c.g===this.current.g&&c.b===this.current.b&&c.a===this.current.a||(this.current=c,this.gl.uniform4f(this.location,c.r,c.g,c.b,c.a))}}const fc=new Float32Array(16);function Is(p){return[ca(255*p.r,255*p.g),ca(255*p.b,255*p.a)]}class Sg{constructor(c,d,x){this.value=c,this.uniformNames=d.map((T=>`u_${T}`)),this.type=x}setUniform(c,d,x){c.set(x.constantOr(this.value))}getBinding(c,d,x){return this.type==="color"?new qs(c,d):new Pf(c,d)}}class pp{constructor(c,d){this.uniformNames=d.map((x=>`u_${x}`)),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(c,d){this.pixelRatioFrom=d.pixelRatio,this.pixelRatioTo=c.pixelRatio,this.patternFrom=d.tlbr,this.patternTo=c.tlbr}setUniform(c,d,x,T){const D=T==="u_pattern_to"?this.patternTo:T==="u_pattern_from"?this.patternFrom:T==="u_pixel_ratio_to"?this.pixelRatioTo:T==="u_pixel_ratio_from"?this.pixelRatioFrom:null;D&&c.set(D)}getBinding(c,d,x){return x.substr(0,9)==="u_pattern"?new As(c,d):new Pf(c,d)}}class Uh{constructor(c,d,x,T){this.expression=c,this.type=x,this.maxValue=0,this.paintVertexAttributes=d.map((D=>({name:`a_${D}`,type:"Float32",components:x==="color"?2:1,offset:0}))),this.paintVertexArray=new T}populatePaintArray(c,d,x){const T=this.paintVertexArray.length,D=this.expression.evaluate(new mn(0,x),d,{},x.canonical,[],x.formattedSection);this.paintVertexArray.resize(c),this._setPaintValue(T,c,D)}updatePaintArray(c,d,x,T,D){const F=this.expression.evaluate(new mn(0,D),x,T);this._setPaintValue(c,d,F)}_setPaintValue(c,d,x){if(this.type==="color"){const T=Is(x);for(let D=c;D<d;D++)this.paintVertexArray.emplace(D,T[0],T[1])}else{for(let T=c;T<d;T++)this.paintVertexArray.emplace(T,x);this.maxValue=Math.max(this.maxValue,Math.abs(x))}}upload(c){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=c.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Bc{constructor(c,d,x,T,D,F){this.expression=c,this.uniformNames=d.map((V=>`u_${V}_t`)),this.type=x,this.useIntegerZoom=T,this.zoom=D,this.maxValue=0,this.paintVertexAttributes=d.map((V=>({name:`a_${V}`,type:"Float32",components:x==="color"?4:2,offset:0}))),this.paintVertexArray=new F}populatePaintArray(c,d,x){const T=this.expression.evaluate(new mn(this.zoom,x),d,{},x.canonical,[],x.formattedSection),D=this.expression.evaluate(new mn(this.zoom+1,x),d,{},x.canonical,[],x.formattedSection),F=this.paintVertexArray.length;this.paintVertexArray.resize(c),this._setPaintValue(F,c,T,D)}updatePaintArray(c,d,x,T,D){const F=this.expression.evaluate(new mn(this.zoom,D),x,T),V=this.expression.evaluate(new mn(this.zoom+1,D),x,T);this._setPaintValue(c,d,F,V)}_setPaintValue(c,d,x,T){if(this.type==="color"){const D=Is(x),F=Is(T);for(let V=c;V<d;V++)this.paintVertexArray.emplace(V,D[0],D[1],F[0],F[1])}else{for(let D=c;D<d;D++)this.paintVertexArray.emplace(D,x,T);this.maxValue=Math.max(this.maxValue,Math.abs(x),Math.abs(T))}}upload(c){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=c.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(c,d){const x=this.useIntegerZoom?Math.floor(d.zoom):d.zoom,T=Oe(this.expression.interpolationFactor(x,this.zoom,this.zoom+1),0,1);c.set(T)}getBinding(c,d,x){return new Pf(c,d)}}class kf{constructor(c,d,x,T,D,F){this.expression=c,this.type=d,this.useIntegerZoom=x,this.zoom=T,this.layerId=F,this.zoomInPaintVertexArray=new D,this.zoomOutPaintVertexArray=new D}populatePaintArray(c,d,x){const T=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(c),this.zoomOutPaintVertexArray.resize(c),this._setPaintValues(T,c,d.patterns&&d.patterns[this.layerId],x.imagePositions)}updatePaintArray(c,d,x,T,D){this._setPaintValues(c,d,x.patterns&&x.patterns[this.layerId],D.imagePositions)}_setPaintValues(c,d,x,T){if(!T||!x)return;const{min:D,mid:F,max:V}=x,X=T[D],ae=T[F],se=T[V];if(X&&ae&&se)for(let ve=c;ve<d;ve++)this.zoomInPaintVertexArray.emplace(ve,ae.tl[0],ae.tl[1],ae.br[0],ae.br[1],X.tl[0],X.tl[1],X.br[0],X.br[1],ae.pixelRatio,X.pixelRatio),this.zoomOutPaintVertexArray.emplace(ve,ae.tl[0],ae.tl[1],ae.br[0],ae.br[1],se.tl[0],se.tl[1],se.br[0],se.br[1],ae.pixelRatio,se.pixelRatio)}upload(c){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=c.createVertexBuffer(this.zoomInPaintVertexArray,ko.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=c.createVertexBuffer(this.zoomOutPaintVertexArray,ko.members,this.expression.isStateDependent))}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class bx{constructor(c,d,x){this.binders={},this._buffers=[];const T=[];for(const D in c.paint._values){if(!x(D))continue;const F=c.paint.get(D);if(!(F instanceof fo&&Zo(F.property.specification)))continue;const V=xx(D,c.type),X=F.value,ae=F.property.specification.type,se=F.property.useIntegerZoom,ve=F.property.specification["property-type"],Le=ve==="cross-faded"||ve==="cross-faded-data-driven";if(X.kind==="constant")this.binders[D]=Le?new pp(X.value,V):new Sg(X.value,V,ae),T.push(`/u_${D}`);else if(X.kind==="source"||Le){const ze=Z0(D,ae,"source");this.binders[D]=Le?new kf(X,ae,se,d,ze,c.id):new Uh(X,V,ae,ze),T.push(`/a_${D}`)}else{const ze=Z0(D,ae,"composite");this.binders[D]=new Bc(X,V,ae,se,d,ze),T.push(`/z_${D}`)}}this.cacheKey=T.sort().join("")}getMaxValue(c){const d=this.binders[c];return d instanceof Uh||d instanceof Bc?d.maxValue:0}populatePaintArrays(c,d,x){for(const T in this.binders){const D=this.binders[T];(D instanceof Uh||D instanceof Bc||D instanceof kf)&&D.populatePaintArray(c,d,x)}}setConstantPatternPositions(c,d){for(const x in this.binders){const T=this.binders[x];T instanceof pp&&T.setConstantPatternPositions(c,d)}}updatePaintArrays(c,d,x,T,D){let F=!1;for(const V in c){const X=d.getPositions(V);for(const ae of X){const se=x.feature(ae.index);for(const ve in this.binders){const Le=this.binders[ve];if((Le instanceof Uh||Le instanceof Bc||Le instanceof kf)&&Le.expression.isStateDependent===!0){const ze=T.paint.get(ve);Le.expression=ze.value,Le.updatePaintArray(ae.start,ae.end,se,c[V],D),F=!0}}}}return F}defines(){const c=[];for(const d in this.binders){const x=this.binders[d];(x instanceof Sg||x instanceof pp)&&c.push(...x.uniformNames.map((T=>`#define HAS_UNIFORM_${T}`)))}return c}getBinderAttributes(){const c=[];for(const d in this.binders){const x=this.binders[d];if(x instanceof Uh||x instanceof Bc)for(let T=0;T<x.paintVertexAttributes.length;T++)c.push(x.paintVertexAttributes[T].name);else if(x instanceof kf)for(let T=0;T<ko.members.length;T++)c.push(ko.members[T].name)}return c}getBinderUniforms(){const c=[];for(const d in this.binders){const x=this.binders[d];if(x instanceof Sg||x instanceof pp||x instanceof Bc)for(const T of x.uniformNames)c.push(T)}return c}getPaintVertexBuffers(){return this._buffers}getUniforms(c,d){const x=[];for(const T in this.binders){const D=this.binders[T];if(D instanceof Sg||D instanceof pp||D instanceof Bc){for(const F of D.uniformNames)if(d[F]){const V=D.getBinding(c,d[F],F);x.push({name:F,property:T,binding:V})}}}return x}setUniforms(c,d,x,T){for(const{name:D,property:F,binding:V}of d)this.binders[F].setUniform(V,T,x.get(F),D)}updatePaintBuffers(c){this._buffers=[];for(const d in this.binders){const x=this.binders[d];if(c&&x instanceof kf){const T=c.fromScale===2?x.zoomInPaintVertexBuffer:x.zoomOutPaintVertexBuffer;T&&this._buffers.push(T)}else(x instanceof Uh||x instanceof Bc)&&x.paintVertexBuffer&&this._buffers.push(x.paintVertexBuffer)}}upload(c){for(const d in this.binders){const x=this.binders[d];(x instanceof Uh||x instanceof Bc||x instanceof kf)&&x.upload(c)}this.updatePaintBuffers()}destroy(){for(const c in this.binders){const d=this.binders[c];(d instanceof Uh||d instanceof Bc||d instanceof kf)&&d.destroy()}}}class Ku{constructor(c,d,x=()=>!0){this.programConfigurations={};for(const T of c)this.programConfigurations[T.id]=new bx(T,d,x);this.needsUpload=!1,this._featureMap=new yd,this._bufferOffset=0}populatePaintArrays(c,d,x,T){for(const D in this.programConfigurations)this.programConfigurations[D].populatePaintArrays(c,d,T);d.id!==void 0&&this._featureMap.add(d.id,x,this._bufferOffset,c),this._bufferOffset=c,this.needsUpload=!0}updatePaintArrays(c,d,x,T){for(const D of x)this.needsUpload=this.programConfigurations[D.id].updatePaintArrays(c,this._featureMap,d,D,T)||this.needsUpload}get(c){return this.programConfigurations[c]}upload(c){if(this.needsUpload){for(const d in this.programConfigurations)this.programConfigurations[d].upload(c);this.needsUpload=!1}}destroy(){for(const c in this.programConfigurations)this.programConfigurations[c].destroy()}}function xx(p,c){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[p]||[p.replace(`${c}-`,"").replace(/-/g,"_")]}function Z0(p,c,d){const x={color:{source:Vs,composite:ge},number:{source:N,composite:Vs}},T=(function(D){return{"line-pattern":{source:tn,composite:tn},"fill-pattern":{source:tn,composite:tn},"fill-extrusion-pattern":{source:tn,composite:tn}}[D]})(p);return T&&T[d]||x[c][d]}We("ConstantBinder",Sg),We("CrossFadedConstantBinder",pp),We("SourceExpressionBinder",Uh),We("CrossFadedCompositeBinder",kf),We("CompositeExpressionBinder",Bc),We("ProgramConfiguration",bx,{omit:["_buffers"]}),We("ProgramConfigurationSet",Ku);const sy=Math.pow(2,14)-1,ly=-sy-1;function Mf(p){const c=we/p.extent,d=p.loadGeometry();for(let x=0;x<d.length;x++){const T=d[x];for(let D=0;D<T.length;D++){const F=T[D],V=Math.round(F.x*c),X=Math.round(F.y*c);F.x=Oe(V,ly,sy),F.y=Oe(X,ly,sy),(V<F.x||V>F.x+1||X<F.y||X>F.y+1)&&at("Geometry exceeds allowed extent, reduce your vector tile buffer size")}}return d}function Vh(p,c){return{type:p.type,id:p.id,properties:p.properties,geometry:c?Mf(p):[]}}const cD=-32768;function Ere(p,c,d,x,T){p.emplaceBack(cD+8*c+x,cD+8*d+T)}class uC{constructor(c){this.zoom=c.zoom,this.globalState=c.globalState,this.overscaling=c.overscaling,this.layers=c.layers,this.layerIds=this.layers.map((d=>d.id)),this.index=c.index,this.hasPattern=!1,this.layoutVertexArray=new qt,this.indexArray=new da,this.segments=new ci,this.programConfigurations=new Ku(c.layers,c.zoom),this.stateDependentLayerIds=this.layers.filter((d=>d.isStateDependent())).map((d=>d.id))}populate(c,d,x){const T=this.layers[0],D=[];let F=null,V=!1,X=T.type==="heatmap";if(T.type==="circle"){const se=T;F=se.layout.get("circle-sort-key"),V=!F.isConstant(),X=X||se.paint.get("circle-pitch-alignment")==="map"}const ae=X?d.subdivisionGranularity.circle:1;for(const{feature:se,id:ve,index:Le,sourceLayerIndex:ze}of c){const Ue=this.layers[0]._featureFilter.needGeometry,Ze=Vh(se,Ue);if(!this.layers[0]._featureFilter.filter(new mn(this.zoom,{globalState:this.globalState}),Ze,x))continue;const st=V?F.evaluate(Ze,{},x):void 0,wt={id:ve,properties:se.properties,type:se.type,sourceLayerIndex:ze,index:Le,geometry:Ue?Ze.geometry:Mf(se),patterns:{},sortKey:st};D.push(wt)}V&&D.sort(((se,ve)=>se.sortKey-ve.sortKey));for(const se of D){const{geometry:ve,index:Le,sourceLayerIndex:ze}=se,Ue=c[Le].feature;this.addFeature(se,ve,Le,x,ae),d.featureIndex.insert(Ue,ve,Le,ze,this.index)}}update(c,d,x){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(c,d,this.stateDependentLayers,{imagePositions:x,globalState:this.globalState})}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(c){this.uploaded||(this.layoutVertexBuffer=c.createVertexBuffer(this.layoutVertexArray,ba),this.indexBuffer=c.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(c),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(c,d,x,T,D=1){let F;switch(D){case 1:F=[0,7];break;case 3:F=[0,2,5,7];break;case 5:F=[0,1,3,4,6,7];break;case 7:F=[0,1,2,3,4,5,6,7];break;default:throw new Error(`Invalid circle bucket granularity: ${D}; valid values are 1, 3, 5, 7.`)}const V=F.length;for(const X of d)for(const ae of X){const se=ae.x,ve=ae.y;if(se<0||se>=we||ve<0||ve>=we)continue;const Le=this.segments.prepareSegment(V*V,this.layoutVertexArray,this.indexArray,c.sortKey),ze=Le.vertexLength;for(let Ue=0;Ue<V;Ue++)for(let Ze=0;Ze<V;Ze++)Ere(this.layoutVertexArray,se,ve,F[Ze],F[Ue]);for(let Ue=0;Ue<V-1;Ue++)for(let Ze=0;Ze<V-1;Ze++){const st=ze+Ue*V+Ze,wt=ze+(Ue+1)*V+Ze;this.indexArray.emplaceBack(st,wt+1,st+1),this.indexArray.emplaceBack(st,wt,wt+1)}Le.vertexLength+=V*V,Le.primitiveLength+=(V-1)*(V-1)*2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,c,x,{imagePositions:{},canonical:T,globalState:this.globalState})}}function hD(p,c){for(let d=0;d<p.length;d++)if(uy(c,p[d]))return!0;for(let d=0;d<c.length;d++)if(uy(p,c[d]))return!0;return!!cC(p,c)}function Tre(p,c,d){return!!uy(p,c)||!!hC(c,p,d)}function fD(p,c){if(p.length===1)return pD(c,p[0]);for(let d=0;d<c.length;d++){const x=c[d];for(let T=0;T<x.length;T++)if(uy(p,x[T]))return!0}for(let d=0;d<p.length;d++)if(pD(c,p[d]))return!0;for(let d=0;d<c.length;d++)if(cC(p,c[d]))return!0;return!1}function Cre(p,c,d){if(p.length>1){if(cC(p,c))return!0;for(let x=0;x<c.length;x++)if(hC(c[x],p,d))return!0}for(let x=0;x<p.length;x++)if(hC(p[x],c,d))return!0;return!1}function cC(p,c){if(p.length===0||c.length===0)return!1;for(let d=0;d<p.length-1;d++){const x=p[d],T=p[d+1];for(let D=0;D<c.length-1;D++)if(Are(x,T,c[D],c[D+1]))return!0}return!1}function Are(p,c,d,x){return je(p,d,x)!==je(c,d,x)&&je(p,c,d)!==je(p,c,x)}function hC(p,c,d){const x=d*d;if(c.length===1)return p.distSqr(c[0])<x;for(let T=1;T<c.length;T++)if(dD(p,c[T-1],c[T])<x)return!0;return!1}function dD(p,c,d){const x=c.distSqr(d);if(x===0)return p.distSqr(c);const T=((p.x-c.x)*(d.x-c.x)+(p.y-c.y)*(d.y-c.y))/x;return p.distSqr(T<0?c:T>1?d:d.sub(c)._mult(T)._add(c))}function pD(p,c){let d,x,T,D=!1;for(let F=0;F<p.length;F++){d=p[F];for(let V=0,X=d.length-1;V<d.length;X=V++)x=d[V],T=d[X],x.y>c.y!=T.y>c.y&&c.x<(T.x-x.x)*(c.y-x.y)/(T.y-x.y)+x.x&&(D=!D)}return D}function uy(p,c){let d=!1;for(let x=0,T=p.length-1;x<p.length;T=x++){const D=p[x],F=p[T];D.y>c.y!=F.y>c.y&&c.x<(F.x-D.x)*(c.y-D.y)/(F.y-D.y)+D.x&&(d=!d)}return d}function Ire(p,c,d){const x=d[0],T=d[2];if(p.x<x.x&&c.x<x.x||p.x>T.x&&c.x>T.x||p.y<x.y&&c.y<x.y||p.y>T.y&&c.y>T.y)return!1;const D=je(p,c,d[0]);return D!==je(p,c,d[1])||D!==je(p,c,d[2])||D!==je(p,c,d[3])}function K0(p,c,d){const x=c.paint.get(p).value;return x.kind==="constant"?x.value:d.programConfigurations.get(c.id).getMaxValue(p)}function wx(p){return Math.sqrt(p[0]*p[0]+p[1]*p[1])}function Sx(p,c,d,x,T){if(!c[0]&&!c[1])return p;const D=u.convert(c)._mult(T);d==="viewport"&&D._rotate(-x);const F=[];for(let V=0;V<p.length;V++)F.push(p[V].sub(D));return F}let gD,mD;We("CircleBucket",uC,{omit:["layers"]});var Pre={get paint(){return mD=mD||new ra({"circle-radius":new On(bt.paint_circle["circle-radius"]),"circle-color":new On(bt.paint_circle["circle-color"]),"circle-blur":new On(bt.paint_circle["circle-blur"]),"circle-opacity":new On(bt.paint_circle["circle-opacity"]),"circle-translate":new xn(bt.paint_circle["circle-translate"]),"circle-translate-anchor":new xn(bt.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new xn(bt.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new xn(bt.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new On(bt.paint_circle["circle-stroke-width"]),"circle-stroke-color":new On(bt.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new On(bt.paint_circle["circle-stroke-opacity"])})},get layout(){return gD=gD||new ra({"circle-sort-key":new On(bt.layout_circle["circle-sort-key"])})}};class kre extends Oa{constructor(c){super(c,Pre)}createBucket(c){return new uC(c)}queryRadius(c){const d=c;return K0("circle-radius",this,d)+K0("circle-stroke-width",this,d)+wx(this.paint.get("circle-translate"))}queryIntersectsFeature({queryGeometry:c,feature:d,featureState:x,geometry:T,transform:D,pixelsToTileUnits:F,unwrappedTileID:V,getElevation:X}){const ae=Sx(c,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),-D.bearingInRadians,F),se=this.paint.get("circle-radius").evaluate(d,x)+this.paint.get("circle-stroke-width").evaluate(d,x),ve=this.paint.get("circle-pitch-alignment")==="map",Le=ve?ae:(function(Ue,Ze,st,wt){return Ue.map((Wt=>yD(Wt,Ze,st,wt)))})(ae,D,V,X),ze=ve?se*F:se;for(const Ue of T)for(const Ze of Ue){const st=ve?Ze:yD(Ze,D,V,X);let wt=ze;const Wt=D.projectTileCoordinates(Ze.x,Ze.y,V,X).signedDistanceFromCamera;if(this.paint.get("circle-pitch-scale")==="viewport"&&this.paint.get("circle-pitch-alignment")==="map"?wt*=Wt/D.cameraToCenterDistance:this.paint.get("circle-pitch-scale")==="map"&&this.paint.get("circle-pitch-alignment")==="viewport"&&(wt*=D.cameraToCenterDistance/Wt),Tre(Le,st,wt))return!0}return!1}}function yD(p,c,d,x){const T=c.projectTileCoordinates(p.x,p.y,d,x).point;return new u((.5*T.x+.5)*c.width,(.5*-T.y+.5)*c.height)}class vD extends uC{}let _D;We("HeatmapBucket",vD,{omit:["layers"]});var Mre={get paint(){return _D=_D||new ra({"heatmap-radius":new On(bt.paint_heatmap["heatmap-radius"]),"heatmap-weight":new On(bt.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new xn(bt.paint_heatmap["heatmap-intensity"]),"heatmap-color":new la(bt.paint_heatmap["heatmap-color"]),"heatmap-opacity":new xn(bt.paint_heatmap["heatmap-opacity"])})}};function fC(p,{width:c,height:d},x,T){if(T){if(T instanceof Uint8ClampedArray)T=new Uint8Array(T.buffer);else if(T.length!==c*d*x)throw new RangeError(`mismatched image size. expected: ${T.length} but got: ${c*d*x}`)}else T=new Uint8Array(c*d*x);return p.width=c,p.height=d,p.data=T,p}function bD(p,{width:c,height:d},x){if(c===p.width&&d===p.height)return;const T=fC({},{width:c,height:d},x);dC(p,T,{x:0,y:0},{x:0,y:0},{width:Math.min(p.width,c),height:Math.min(p.height,d)},x),p.width=c,p.height=d,p.data=T.data}function dC(p,c,d,x,T,D){if(T.width===0||T.height===0)return c;if(T.width>p.width||T.height>p.height||d.x>p.width-T.width||d.y>p.height-T.height)throw new RangeError("out of range source coordinates for image copy");if(T.width>c.width||T.height>c.height||x.x>c.width-T.width||x.y>c.height-T.height)throw new RangeError("out of range destination coordinates for image copy");const F=p.data,V=c.data;if(F===V)throw new Error("srcData equals dstData, so image is already copied");for(let X=0;X<T.height;X++){const ae=((d.y+X)*p.width+d.x)*D,se=((x.y+X)*c.width+x.x)*D;for(let ve=0;ve<T.width*D;ve++)V[se+ve]=F[ae+ve]}return c}class J0{constructor(c,d){fC(this,c,1,d)}resize(c){bD(this,c,1)}clone(){return new J0({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(c,d,x,T,D){dC(c,d,x,T,D,1)}}class Ju{constructor(c,d){fC(this,c,4,d)}resize(c){bD(this,c,4)}replace(c,d){d?this.data.set(c):this.data=c instanceof Uint8ClampedArray?new Uint8Array(c.buffer):c}clone(){return new Ju({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(c,d,x,T,D){dC(c,d,x,T,D,4)}setPixel(c,d,x){const T=4*(c*this.width+d);this.data[T+0]=Math.round(255*x.r/x.a),this.data[T+1]=Math.round(255*x.g/x.a),this.data[T+2]=Math.round(255*x.b/x.a),this.data[T+3]=Math.round(255*x.a)}}function xD(p){const c={},d=p.resolution||256,x=p.clips?p.clips.length:1,T=p.image||new Ju({width:d,height:x});if(Math.log(d)/Math.LN2%1!=0)throw new Error(`width is not a power of 2 - ${d}`);const D=(F,V,X)=>{c[p.evaluationKey]=X;const ae=p.expression.evaluate(c);T.setPixel(F/4/d,V/4,ae)};if(p.clips)for(let F=0,V=0;F<x;++F,V+=4*d)for(let X=0,ae=0;X<d;X++,ae+=4){const se=X/(d-1),{start:ve,end:Le}=p.clips[F];D(V,ae,ve*(1-se)+Le*se)}else for(let F=0,V=0;F<d;F++,V+=4)D(0,V,F/(d-1));return T}We("AlphaImage",J0),We("RGBAImage",Ju);const pC="big-fb";class Rre extends Oa{createBucket(c){return new vD(c)}constructor(c){super(c,Mre),this.heatmapFbos=new Map,this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(c){c==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=xD({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbos.has(pC)&&this.heatmapFbos.delete(pC)}queryRadius(){return 0}queryIntersectsFeature(){return!1}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}}let wD;var Ore={get paint(){return wD=wD||new ra({"hillshade-illumination-direction":new xn(bt.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-altitude":new xn(bt.paint_hillshade["hillshade-illumination-altitude"]),"hillshade-illumination-anchor":new xn(bt.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new xn(bt.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new xn(bt.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new xn(bt.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new xn(bt.paint_hillshade["hillshade-accent-color"]),"hillshade-method":new xn(bt.paint_hillshade["hillshade-method"])})}};class Lre extends Oa{constructor(c){super(c,Ore),this.recalculate({zoom:0,zoomHistory:{}},void 0)}getIlluminationProperties(){let c=this.paint.get("hillshade-illumination-direction").values,d=this.paint.get("hillshade-illumination-altitude").values,x=this.paint.get("hillshade-highlight-color").values,T=this.paint.get("hillshade-shadow-color").values;const D=Math.max(c.length,d.length,x.length,T.length);c=c.concat(Array(D-c.length).fill(c.at(-1))),d=d.concat(Array(D-d.length).fill(d.at(-1))),x=x.concat(Array(D-x.length).fill(x.at(-1))),T=T.concat(Array(D-T.length).fill(T.at(-1)));const F=d.map(wr);return{directionRadians:c.map(wr),altitudeRadians:F,shadowColor:T,highlightColor:x}}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}}let SD;var Nre={get paint(){return SD=SD||new ra({"color-relief-opacity":new xn(bt["paint_color-relief"]["color-relief-opacity"]),"color-relief-color":new la(bt["paint_color-relief"]["color-relief-color"])})}};class gC{constructor(c,d,x,T){this.context=c,this.format=x,this.texture=c.gl.createTexture(),this.update(d,T)}update(c,d,x){const{width:T,height:D}=c,F=!(this.size&&this.size[0]===T&&this.size[1]===D||x),{context:V}=this,{gl:X}=V;if(this.useMipmap=!!(d&&d.useMipmap),X.bindTexture(X.TEXTURE_2D,this.texture),V.pixelStoreUnpackFlipY.set(!1),V.pixelStoreUnpack.set(1),V.pixelStoreUnpackPremultiplyAlpha.set(this.format===X.RGBA&&(!d||d.premultiply!==!1)),F)this.size=[T,D],c instanceof HTMLImageElement||c instanceof HTMLCanvasElement||c instanceof HTMLVideoElement||c instanceof ImageData||pr(c)?X.texImage2D(X.TEXTURE_2D,0,this.format,this.format,X.UNSIGNED_BYTE,c):X.texImage2D(X.TEXTURE_2D,0,this.format,T,D,0,this.format,X.UNSIGNED_BYTE,c.data);else{const{x:ae,y:se}=x||{x:0,y:0};c instanceof HTMLImageElement||c instanceof HTMLCanvasElement||c instanceof HTMLVideoElement||c instanceof ImageData||pr(c)?X.texSubImage2D(X.TEXTURE_2D,0,ae,se,X.RGBA,X.UNSIGNED_BYTE,c):X.texSubImage2D(X.TEXTURE_2D,0,ae,se,T,D,X.RGBA,X.UNSIGNED_BYTE,c.data)}this.useMipmap&&this.isSizePowerOfTwo()&&X.generateMipmap(X.TEXTURE_2D),V.pixelStoreUnpackFlipY.setDefault(),V.pixelStoreUnpack.setDefault(),V.pixelStoreUnpackPremultiplyAlpha.setDefault()}bind(c,d,x){const{context:T}=this,{gl:D}=T;D.bindTexture(D.TEXTURE_2D,this.texture),x!==D.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(x=D.LINEAR),c!==this.filter&&(D.texParameteri(D.TEXTURE_2D,D.TEXTURE_MAG_FILTER,c),D.texParameteri(D.TEXTURE_2D,D.TEXTURE_MIN_FILTER,x||c),this.filter=c),d!==this.wrap&&(D.texParameteri(D.TEXTURE_2D,D.TEXTURE_WRAP_S,d),D.texParameteri(D.TEXTURE_2D,D.TEXTURE_WRAP_T,d),this.wrap=d)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:c}=this.context;c.deleteTexture(this.texture),this.texture=null}}class ED{constructor(c,d,x,T=1,D=1,F=1,V=0){if(this.uid=c,d.height!==d.width)throw new RangeError("DEM tiles must be square");if(x&&!["mapbox","terrarium","custom"].includes(x))return void at(`"${x}" is not a valid encoding type. Valid types include "mapbox", "terrarium" and "custom".`);this.stride=d.height;const X=this.dim=d.height-2;switch(this.data=new Uint32Array(d.data.buffer),x){case"terrarium":this.redFactor=256,this.greenFactor=1,this.blueFactor=1/256,this.baseShift=32768;break;case"custom":this.redFactor=T,this.greenFactor=D,this.blueFactor=F,this.baseShift=V;break;default:this.redFactor=6553.6,this.greenFactor=25.6,this.blueFactor=.1,this.baseShift=1e4}for(let ae=0;ae<X;ae++)this.data[this._idx(-1,ae)]=this.data[this._idx(0,ae)],this.data[this._idx(X,ae)]=this.data[this._idx(X-1,ae)],this.data[this._idx(ae,-1)]=this.data[this._idx(ae,0)],this.data[this._idx(ae,X)]=this.data[this._idx(ae,X-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(X,-1)]=this.data[this._idx(X-1,0)],this.data[this._idx(-1,X)]=this.data[this._idx(0,X-1)],this.data[this._idx(X,X)]=this.data[this._idx(X-1,X-1)],this.min=Number.MAX_SAFE_INTEGER,this.max=Number.MIN_SAFE_INTEGER;for(let ae=0;ae<X;ae++)for(let se=0;se<X;se++){const ve=this.get(ae,se);ve>this.max&&(this.max=ve),ve<this.min&&(this.min=ve)}}get(c,d){const x=new Uint8Array(this.data.buffer),T=4*this._idx(c,d);return this.unpack(x[T],x[T+1],x[T+2])}getUnpackVector(){return[this.redFactor,this.greenFactor,this.blueFactor,this.baseShift]}_idx(c,d){if(c<-1||c>=this.dim+1||d<-1||d>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(d+1)*this.stride+(c+1)}unpack(c,d,x){return c*this.redFactor+d*this.greenFactor+x*this.blueFactor-this.baseShift}pack(c){return TD(c,this.getUnpackVector())}getPixels(){return new Ju({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(c,d,x){if(this.dim!==c.dim)throw new Error("dem dimension mismatch");let T=d*this.dim,D=d*this.dim+this.dim,F=x*this.dim,V=x*this.dim+this.dim;switch(d){case-1:T=D-1;break;case 1:D=T+1}switch(x){case-1:F=V-1;break;case 1:V=F+1}const X=-d*this.dim,ae=-x*this.dim;for(let se=F;se<V;se++)for(let ve=T;ve<D;ve++)this.data[this._idx(ve,se)]=c.data[this._idx(ve+X,se+ae)]}}function TD(p,c){const d=c[0],x=c[1],T=c[2],D=c[3],F=Math.min(d,x,T),V=Math.round((p+D)/F);return{r:Math.floor(V*F/d)%256,g:Math.floor(V*F/x)%256,b:Math.floor(V*F/T)%256}}We("DEMData",ED);class Dre extends Oa{constructor(c){super(c,Nre)}_createColorRamp(c){const d={elevationStops:[],colorStops:[]},x=this._transitionablePaint._values["color-relief-color"].value.expression;if(x instanceof Bh&&x._styleExpression.expression instanceof wn){this.colorRampExpression=x;const F=x._styleExpression.expression;d.elevationStops=F.labels,d.colorStops=[];for(const V of d.elevationStops)d.colorStops.push(F.evaluate({globals:{elevation:V}}))}if(d.elevationStops.length<1&&(d.elevationStops=[0],d.colorStops=[kr.transparent]),d.elevationStops.length<2&&(d.elevationStops.push(d.elevationStops[0]+1),d.colorStops.push(d.colorStops[0])),d.elevationStops.length<=c)return d;const T={elevationStops:[],colorStops:[]},D=(d.elevationStops.length-1)/(c-1);for(let F=0;F<d.elevationStops.length-.5;F+=D)T.elevationStops.push(d.elevationStops[Math.round(F)]),T.colorStops.push(d.colorStops[Math.round(F)]);return at(`Too many colors in specification of ${this.id} color-relief layer, may not render properly.`),T}_colorRampChanged(){return this.colorRampExpression!=this._transitionablePaint._values["color-relief-color"].value.expression}getColorRampTextures(c,d,x){if(this.colorRampTextures&&!this._colorRampChanged())return this.colorRampTextures;const T=this._createColorRamp(d),D=new Ju({width:T.colorStops.length,height:1}),F=new Ju({width:T.colorStops.length,height:1});for(let V=0;V<T.elevationStops.length;V++){const X=TD(T.elevationStops[V],x);F.setPixel(0,V,new kr(X.r/255,X.g/255,X.b/255,1)),D.setPixel(0,V,T.colorStops[V])}return this.colorRampTextures={elevationTexture:new gC(c,F,c.gl.RGBA),colorTexture:new gC(c,D,c.gl.RGBA)},this.colorRampTextures}hasOffscreenPass(){return this.visibility!=="none"&&!!this.colorRampTextures}}const Fre=wi([{name:"a_pos",components:2,type:"Int16"}],4),{members:Bre}=Fre;function mC(p,c,d){const x=d.patternDependencies;let T=!1;for(const D of c){const F=D.paint.get(`${p}-pattern`);F.isConstant()||(T=!0);const V=F.constantOr(null);V&&(T=!0,x[V.to]=!0,x[V.from]=!0)}return T}function yC(p,c,d,x,T){const{zoom:D,globalState:F}=x,V=T.patternDependencies;for(const X of c){const ae=X.paint.get(`${p}-pattern`).value;if(ae.kind!=="constant"){let se=ae.evaluate({zoom:D-1,globalState:F},d,{},T.availableImages),ve=ae.evaluate({zoom:D,globalState:F},d,{},T.availableImages),Le=ae.evaluate({zoom:D+1,globalState:F},d,{},T.availableImages);se=se&&se.name?se.name:se,ve=ve&&ve.name?ve.name:ve,Le=Le&&Le.name?Le.name:Le,V[se]=!0,V[ve]=!0,V[Le]=!0,d.patterns[X.id]={min:se,mid:ve,max:Le}}}return d}function CD(p,c,d,x,T){let D;if(T===(function(F,V,X,ae){let se=0;for(let ve=V,Le=X-ae;ve<X;ve+=ae)se+=(F[Le]-F[ve])*(F[ve+1]+F[Le+1]),Le=ve;return se})(p,c,d,x)>0)for(let F=c;F<d;F+=x)D=kD(F/x|0,p[F],p[F+1],D);else for(let F=d-x;F>=c;F-=x)D=kD(F/x|0,p[F],p[F+1],D);return D&&cy(D,D.next)&&(r_(D),D=D.next),D}function Eg(p,c){if(!p)return p;c||(c=p);let d,x=p;do if(d=!1,x.steiner||!cy(x,x.next)&&ps(x.prev,x,x.next)!==0)x=x.next;else{if(r_(x),x=c=x.prev,x===x.next)break;d=!0}while(d||x!==c);return c}function Q0(p,c,d,x,T,D,F){if(!p)return;!F&&D&&(function(X,ae,se,ve){let Le=X;do Le.z===0&&(Le.z=vC(Le.x,Le.y,ae,se,ve)),Le.prevZ=Le.prev,Le.nextZ=Le.next,Le=Le.next;while(Le!==X);Le.prevZ.nextZ=null,Le.prevZ=null,(function(ze){let Ue,Ze=1;do{let st,wt=ze;ze=null;let Wt=null;for(Ue=0;wt;){Ue++;let Rt=wt,Ft=0;for(let Cr=0;Cr<Ze&&(Ft++,Rt=Rt.nextZ,Rt);Cr++);let gr=Ze;for(;Ft>0||gr>0&&Rt;)Ft!==0&&(gr===0||!Rt||wt.z<=Rt.z)?(st=wt,wt=wt.nextZ,Ft--):(st=Rt,Rt=Rt.nextZ,gr--),Wt?Wt.nextZ=st:ze=st,st.prevZ=Wt,Wt=st;wt=Rt}Wt.nextZ=null,Ze*=2}while(Ue>1)})(Le)})(p,x,T,D);let V=p;for(;p.prev!==p.next;){const X=p.prev,ae=p.next;if(D?jre(p,x,T,D):zre(p))c.push(X.i,p.i,ae.i),r_(p),p=ae.next,V=ae.next;else if((p=ae)===V){F?F===1?Q0(p=Ure(Eg(p),c),c,d,x,T,D,2):F===2&&Vre(p,c,d,x,T,D):Q0(Eg(p),c,d,x,T,D,1);break}}}function zre(p){const c=p.prev,d=p,x=p.next;if(ps(c,d,x)>=0)return!1;const T=c.x,D=d.x,F=x.x,V=c.y,X=d.y,ae=x.y,se=Math.min(T,D,F),ve=Math.min(V,X,ae),Le=Math.max(T,D,F),ze=Math.max(V,X,ae);let Ue=x.next;for(;Ue!==c;){if(Ue.x>=se&&Ue.x<=Le&&Ue.y>=ve&&Ue.y<=ze&&e_(T,V,D,X,F,ae,Ue.x,Ue.y)&&ps(Ue.prev,Ue,Ue.next)>=0)return!1;Ue=Ue.next}return!0}function jre(p,c,d,x){const T=p.prev,D=p,F=p.next;if(ps(T,D,F)>=0)return!1;const V=T.x,X=D.x,ae=F.x,se=T.y,ve=D.y,Le=F.y,ze=Math.min(V,X,ae),Ue=Math.min(se,ve,Le),Ze=Math.max(V,X,ae),st=Math.max(se,ve,Le),wt=vC(ze,Ue,c,d,x),Wt=vC(Ze,st,c,d,x);let Rt=p.prevZ,Ft=p.nextZ;for(;Rt&&Rt.z>=wt&&Ft&&Ft.z<=Wt;){if(Rt.x>=ze&&Rt.x<=Ze&&Rt.y>=Ue&&Rt.y<=st&&Rt!==T&&Rt!==F&&e_(V,se,X,ve,ae,Le,Rt.x,Rt.y)&&ps(Rt.prev,Rt,Rt.next)>=0||(Rt=Rt.prevZ,Ft.x>=ze&&Ft.x<=Ze&&Ft.y>=Ue&&Ft.y<=st&&Ft!==T&&Ft!==F&&e_(V,se,X,ve,ae,Le,Ft.x,Ft.y)&&ps(Ft.prev,Ft,Ft.next)>=0))return!1;Ft=Ft.nextZ}for(;Rt&&Rt.z>=wt;){if(Rt.x>=ze&&Rt.x<=Ze&&Rt.y>=Ue&&Rt.y<=st&&Rt!==T&&Rt!==F&&e_(V,se,X,ve,ae,Le,Rt.x,Rt.y)&&ps(Rt.prev,Rt,Rt.next)>=0)return!1;Rt=Rt.prevZ}for(;Ft&&Ft.z<=Wt;){if(Ft.x>=ze&&Ft.x<=Ze&&Ft.y>=Ue&&Ft.y<=st&&Ft!==T&&Ft!==F&&e_(V,se,X,ve,ae,Le,Ft.x,Ft.y)&&ps(Ft.prev,Ft,Ft.next)>=0)return!1;Ft=Ft.nextZ}return!0}function Ure(p,c){let d=p;do{const x=d.prev,T=d.next.next;!cy(x,T)&&ID(x,d,d.next,T)&&t_(x,T)&&t_(T,x)&&(c.push(x.i,d.i,T.i),r_(d),r_(d.next),d=p=T),d=d.next}while(d!==p);return Eg(d)}function Vre(p,c,d,x,T,D){let F=p;do{let V=F.next.next;for(;V!==F.prev;){if(F.i!==V.i&&Gre(F,V)){let X=PD(F,V);return F=Eg(F,F.next),X=Eg(X,X.next),Q0(F,c,d,x,T,D,0),void Q0(X,c,d,x,T,D,0)}V=V.next}F=F.next}while(F!==p)}function $re(p,c){let d=p.x-c.x;return d===0&&(d=p.y-c.y,d===0)&&(d=(p.next.y-p.y)/(p.next.x-p.x)-(c.next.y-c.y)/(c.next.x-c.x)),d}function qre(p,c){const d=(function(T,D){let F=D;const V=T.x,X=T.y;let ae,se=-1/0;if(cy(T,F))return F;do{if(cy(T,F.next))return F.next;if(X<=F.y&&X>=F.next.y&&F.next.y!==F.y){const Ze=F.x+(X-F.y)*(F.next.x-F.x)/(F.next.y-F.y);if(Ze<=V&&Ze>se&&(se=Ze,ae=F.x<F.next.x?F:F.next,Ze===V))return ae}F=F.next}while(F!==D);if(!ae)return null;const ve=ae,Le=ae.x,ze=ae.y;let Ue=1/0;F=ae;do{if(V>=F.x&&F.x>=Le&&V!==F.x&&AD(X<ze?V:se,X,Le,ze,X<ze?se:V,X,F.x,F.y)){const Ze=Math.abs(X-F.y)/(V-F.x);t_(F,T)&&(Ze<Ue||Ze===Ue&&(F.x>ae.x||F.x===ae.x&&Hre(ae,F)))&&(ae=F,Ue=Ze)}F=F.next}while(F!==ve);return ae})(p,c);if(!d)return c;const x=PD(d,p);return Eg(x,x.next),Eg(d,d.next)}function Hre(p,c){return ps(p.prev,p,c.prev)<0&&ps(c.next,p,p.next)<0}function vC(p,c,d,x,T){return(p=1431655765&((p=858993459&((p=252645135&((p=16711935&((p=(p-d)*T|0)|p<<8))|p<<4))|p<<2))|p<<1))|(c=1431655765&((c=858993459&((c=252645135&((c=16711935&((c=(c-x)*T|0)|c<<8))|c<<4))|c<<2))|c<<1))<<1}function Wre(p){let c=p,d=p;do(c.x<d.x||c.x===d.x&&c.y<d.y)&&(d=c),c=c.next;while(c!==p);return d}function AD(p,c,d,x,T,D,F,V){return(T-F)*(c-V)>=(p-F)*(D-V)&&(p-F)*(x-V)>=(d-F)*(c-V)&&(d-F)*(D-V)>=(T-F)*(x-V)}function e_(p,c,d,x,T,D,F,V){return!(p===F&&c===V)&&AD(p,c,d,x,T,D,F,V)}function Gre(p,c){return p.next.i!==c.i&&p.prev.i!==c.i&&!(function(d,x){let T=d;do{if(T.i!==d.i&&T.next.i!==d.i&&T.i!==x.i&&T.next.i!==x.i&&ID(T,T.next,d,x))return!0;T=T.next}while(T!==d);return!1})(p,c)&&(t_(p,c)&&t_(c,p)&&(function(d,x){let T=d,D=!1;const F=(d.x+x.x)/2,V=(d.y+x.y)/2;do T.y>V!=T.next.y>V&&T.next.y!==T.y&&F<(T.next.x-T.x)*(V-T.y)/(T.next.y-T.y)+T.x&&(D=!D),T=T.next;while(T!==d);return D})(p,c)&&(ps(p.prev,p,c.prev)||ps(p,c.prev,c))||cy(p,c)&&ps(p.prev,p,p.next)>0&&ps(c.prev,c,c.next)>0)}function ps(p,c,d){return(c.y-p.y)*(d.x-c.x)-(c.x-p.x)*(d.y-c.y)}function cy(p,c){return p.x===c.x&&p.y===c.y}function ID(p,c,d,x){const T=Tx(ps(p,c,d)),D=Tx(ps(p,c,x)),F=Tx(ps(d,x,p)),V=Tx(ps(d,x,c));return T!==D&&F!==V||!(T!==0||!Ex(p,d,c))||!(D!==0||!Ex(p,x,c))||!(F!==0||!Ex(d,p,x))||!(V!==0||!Ex(d,c,x))}function Ex(p,c,d){return c.x<=Math.max(p.x,d.x)&&c.x>=Math.min(p.x,d.x)&&c.y<=Math.max(p.y,d.y)&&c.y>=Math.min(p.y,d.y)}function Tx(p){return p>0?1:p<0?-1:0}function t_(p,c){return ps(p.prev,p,p.next)<0?ps(p,c,p.next)>=0&&ps(p,p.prev,c)>=0:ps(p,c,p.prev)<0||ps(p,p.next,c)<0}function PD(p,c){const d=_C(p.i,p.x,p.y),x=_C(c.i,c.x,c.y),T=p.next,D=c.prev;return p.next=c,c.prev=p,d.next=T,T.prev=d,x.next=d,d.prev=x,D.next=x,x.prev=D,x}function kD(p,c,d,x){const T=_C(p,c,d);return x?(T.next=x.next,T.prev=x,x.next.prev=T,x.next=T):(T.prev=T,T.next=T),T}function r_(p){p.next.prev=p.prev,p.prev.next=p.next,p.prevZ&&(p.prevZ.nextZ=p.nextZ),p.nextZ&&(p.nextZ.prevZ=p.prevZ)}function _C(p,c,d){return{i:p,x:c,y:d,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}class hy{constructor(c,d){if(d>c)throw new Error("Min granularity must not be greater than base granularity.");this._baseZoomGranularity=c,this._minGranularity=d}getGranularityForZoomLevel(c){return Math.max(Math.floor(this._baseZoomGranularity/(1<<c)),this._minGranularity,1)}}class Cx{constructor(c){this.fill=c.fill,this.line=c.line,this.tile=c.tile,this.stencil=c.stencil,this.circle=c.circle}}Cx.noSubdivision=new Cx({fill:new hy(0,0),line:new hy(0,0),tile:new hy(0,0),stencil:new hy(0,0),circle:1}),We("SubdivisionGranularityExpression",hy),We("SubdivisionGranularitySetting",Cx);const fy=-32768,n_=32767;class Xre{constructor(c,d){this._vertexBuffer=[],this._vertexDictionary=new Map,this._used=!1,this._granularity=c,this._granularityCellSize=we/c,this._canonical=d}_getKey(c,d){return(c+=32768)<<16|d+32768}_vertexToIndex(c,d){if(c<-32768||d<-32768||c>32767||d>32767)throw new Error("Vertex coordinates are out of signed 16 bit integer range.");const x=0|Math.round(c),T=0|Math.round(d),D=this._getKey(x,T);if(this._vertexDictionary.has(D))return this._vertexDictionary.get(D);const F=this._vertexBuffer.length/2;return this._vertexDictionary.set(D,F),this._vertexBuffer.push(x,T),F}_subdivideTrianglesScanline(c){if(this._granularity<2)return(function(T,D){const F=[];for(let V=0;V<D.length;V+=3){const X=D[V],ae=D[V+1],se=D[V+2],ve=T[2*X],Le=T[2*X+1];(T[2*ae]-ve)*(T[2*se+1]-Le)-(T[2*ae+1]-Le)*(T[2*se]-ve)>0?(F.push(X),F.push(se),F.push(ae)):(F.push(X),F.push(ae),F.push(se))}return F})(this._vertexBuffer,c);const d=[],x=c.length;for(let T=0;T<x;T+=3){const D=[c[T+0],c[T+1],c[T+2]],F=[this._vertexBuffer[2*c[T+0]+0],this._vertexBuffer[2*c[T+0]+1],this._vertexBuffer[2*c[T+1]+0],this._vertexBuffer[2*c[T+1]+1],this._vertexBuffer[2*c[T+2]+0],this._vertexBuffer[2*c[T+2]+1]];let V=1/0,X=1/0,ae=-1/0,se=-1/0;for(let Ze=0;Ze<3;Ze++){const st=F[2*Ze],wt=F[2*Ze+1];V=Math.min(V,st),ae=Math.max(ae,st),X=Math.min(X,wt),se=Math.max(se,wt)}if(V===ae||X===se)continue;const ve=Math.floor(V/this._granularityCellSize),Le=Math.ceil(ae/this._granularityCellSize),ze=Math.floor(X/this._granularityCellSize),Ue=Math.ceil(se/this._granularityCellSize);if(ve!==Le||ze!==Ue)for(let Ze=ze;Ze<Ue;Ze++){const st=this._scanlineGenerateVertexRingForCellRow(Ze,F,D);Yre(this._vertexBuffer,st,d)}else d.push(...D)}return d}_scanlineGenerateVertexRingForCellRow(c,d,x){const T=c*this._granularityCellSize,D=T+this._granularityCellSize,F=[];for(let V=0;V<3;V++){const X=d[2*V],ae=d[2*V+1],se=d[2*(V+1)%6],ve=d[(2*(V+1)+1)%6],Le=d[2*(V+2)%6],ze=d[(2*(V+2)+1)%6],Ue=se-X,Ze=ve-ae,st=Ue===0,wt=Ze===0,Wt=(T-ae)/Ze,Rt=(D-ae)/Ze,Ft=Math.min(Wt,Rt),gr=Math.max(Wt,Rt);if(!wt&&(Ft>=1||gr<=0)||wt&&(ae<T||ae>D)){ve>=T&&ve<=D&&F.push(x[(V+1)%3]);continue}!wt&&Ft>0&&F.push(this._vertexToIndex(X+Ue*Ft,ae+Ze*Ft));const Cr=X+Ue*Math.max(Ft,0),Wr=X+Ue*Math.min(gr,1);st||this._generateIntraEdgeVertices(F,X,ae,se,ve,Cr,Wr),!wt&&gr<1&&F.push(this._vertexToIndex(X+Ue*gr,ae+Ze*gr)),(wt||ve>=T&&ve<=D)&&F.push(x[(V+1)%3]),!wt&&(ve<=T||ve>=D)&&this._generateInterEdgeVertices(F,X,ae,se,ve,Le,ze,Wr,T,D)}return F}_generateIntraEdgeVertices(c,d,x,T,D,F,V){const X=T-d,ae=D-x,se=ae===0,ve=se?Math.min(d,T):Math.min(F,V),Le=se?Math.max(d,T):Math.max(F,V),ze=Math.floor(ve/this._granularityCellSize)+1,Ue=Math.ceil(Le/this._granularityCellSize)-1;if(se?d<T:F<V)for(let Ze=ze;Ze<=Ue;Ze++){const st=Ze*this._granularityCellSize;c.push(this._vertexToIndex(st,x+ae*(st-d)/X))}else for(let Ze=Ue;Ze>=ze;Ze--){const st=Ze*this._granularityCellSize;c.push(this._vertexToIndex(st,x+ae*(st-d)/X))}}_generateInterEdgeVertices(c,d,x,T,D,F,V,X,ae,se){const ve=D-x,Le=F-T,ze=V-D,Ue=(ae-D)/ze,Ze=(se-D)/ze,st=Math.min(Ue,Ze),wt=Math.max(Ue,Ze),Wt=T+Le*st;let Rt=Math.floor(Math.min(Wt,X)/this._granularityCellSize)+1,Ft=Math.ceil(Math.max(Wt,X)/this._granularityCellSize)-1,gr=X<Wt;const Cr=ze===0;if(Cr&&(V===ae||V===se))return;if(Cr||st>=1||wt<=0){const yn=x-V,an=F+(d-F)*Math.min((ae-V)/yn,(se-V)/yn);Rt=Math.floor(Math.min(an,X)/this._granularityCellSize)+1,Ft=Math.ceil(Math.max(an,X)/this._granularityCellSize)-1,gr=X<an}const Wr=ve>0?se:ae;if(gr)for(let yn=Rt;yn<=Ft;yn++)c.push(this._vertexToIndex(yn*this._granularityCellSize,Wr));else for(let yn=Ft;yn>=Rt;yn--)c.push(this._vertexToIndex(yn*this._granularityCellSize,Wr))}_generateOutline(c){const d=[];for(const x of c){const T=Tg(x,this._granularity,!0),D=this._pointArrayToIndices(T),F=[];for(let V=1;V<D.length;V++)F.push(D[V-1]),F.push(D[V]);d.push(F)}return d}_handlePoles(c){let d=!1,x=!1;this._canonical&&(this._canonical.y===0&&(d=!0),this._canonical.y===(1<<this._canonical.z)-1&&(x=!0)),(d||x)&&this._fillPoles(c,d,x)}_ensureNoPoleVertices(){const c=this._vertexBuffer;for(let d=0;d<c.length;d+=2){const x=c[d+1];x===fy&&(c[d+1]=-32767),x===n_&&(c[d+1]=32766)}}_generatePoleQuad(c,d,x,T,D,F){T>D!=(F===fy)?(c.push(d),c.push(x),c.push(this._vertexToIndex(T,F)),c.push(x),c.push(this._vertexToIndex(D,F)),c.push(this._vertexToIndex(T,F))):(c.push(x),c.push(d),c.push(this._vertexToIndex(T,F)),c.push(this._vertexToIndex(D,F)),c.push(x),c.push(this._vertexToIndex(T,F)))}_fillPoles(c,d,x){const T=this._vertexBuffer,D=we,F=c.length;for(let V=2;V<F;V+=3){const X=c[V-2],ae=c[V-1],se=c[V],ve=T[2*X],Le=T[2*X+1],ze=T[2*ae],Ue=T[2*ae+1],Ze=T[2*se],st=T[2*se+1];d&&(Le===0&&Ue===0&&this._generatePoleQuad(c,X,ae,ve,ze,fy),Ue===0&&st===0&&this._generatePoleQuad(c,ae,se,ze,Ze,fy),st===0&&Le===0&&this._generatePoleQuad(c,se,X,Ze,ve,fy)),x&&(Le===D&&Ue===D&&this._generatePoleQuad(c,X,ae,ve,ze,n_),Ue===D&&st===D&&this._generatePoleQuad(c,ae,se,ze,Ze,n_),st===D&&Le===D&&this._generatePoleQuad(c,se,X,Ze,ve,n_))}}_initializeVertices(c){for(let d=0;d<c.length;d+=2)this._vertexToIndex(c[d],c[d+1])}subdividePolygonInternal(c,d){if(this._used)throw new Error("Subdivision: multiple use not allowed.");this._used=!0;const{flattened:x,holeIndices:T}=(function(V){const X=[],ae=[];for(const se of V)if(se.length!==0){se!==V[0]&&X.push(ae.length/2);for(let ve=0;ve<se.length;ve++)ae.push(se[ve].x),ae.push(se[ve].y)}return{flattened:ae,holeIndices:X}})(c);let D;this._initializeVertices(x);try{const V=(function(ae,se,ve=2){const Le=se&&se.length,ze=Le?se[0]*ve:ae.length;let Ue=CD(ae,0,ze,ve,!0);const Ze=[];if(!Ue||Ue.next===Ue.prev)return Ze;let st,wt,Wt;if(Le&&(Ue=(function(Rt,Ft,gr,Cr){const Wr=[];for(let yn=0,an=Ft.length;yn<an;yn++){const hn=CD(Rt,Ft[yn]*Cr,yn<an-1?Ft[yn+1]*Cr:Rt.length,Cr,!1);hn===hn.next&&(hn.steiner=!0),Wr.push(Wre(hn))}Wr.sort($re);for(let yn=0;yn<Wr.length;yn++)gr=qre(Wr[yn],gr);return gr})(ae,se,Ue,ve)),ae.length>80*ve){st=ae[0],wt=ae[1];let Rt=st,Ft=wt;for(let gr=ve;gr<ze;gr+=ve){const Cr=ae[gr],Wr=ae[gr+1];Cr<st&&(st=Cr),Wr<wt&&(wt=Wr),Cr>Rt&&(Rt=Cr),Wr>Ft&&(Ft=Wr)}Wt=Math.max(Rt-st,Ft-wt),Wt=Wt!==0?32767/Wt:0}return Q0(Ue,Ze,ve,st,wt,Wt,0),Ze})(x,T),X=this._convertIndices(x,V);D=this._subdivideTrianglesScanline(X)}catch(V){console.error(V)}let F=[];return d&&(F=this._generateOutline(c)),this._ensureNoPoleVertices(),this._handlePoles(D),{verticesFlattened:this._vertexBuffer,indicesTriangles:D,indicesLineList:F}}_convertIndices(c,d){const x=[];for(let T=0;T<d.length;T++)x.push(this._vertexToIndex(c[2*d[T]],c[2*d[T]+1]));return x}_pointArrayToIndices(c){const d=[];for(let x=0;x<c.length;x++){const T=c[x];d.push(this._vertexToIndex(T.x,T.y))}return d}}function MD(p,c,d,x=!0){return new Xre(d,c).subdividePolygonInternal(p,x)}function Tg(p,c,d=!1){if(!p||p.length<1)return[];if(p.length<2)return[];const x=p[0],T=p[p.length-1],D=d&&(x.x!==T.x||x.y!==T.y);if(c<2)return D?[...p,p[0]]:[...p];const F=Math.floor(we/c),V=[];V.push(new u(p[0].x,p[0].y));const X=p.length,ae=D?X:X-1;for(let se=0;se<ae;se++){const ve=p[se],Le=se<X-1?p[se+1]:p[0],ze=ve.x,Ue=ve.y,Ze=Le.x,st=Le.y,wt=ze!==Ze,Wt=Ue!==st;if(!wt&&!Wt)continue;const Rt=Ze-ze,Ft=st-Ue,gr=Math.abs(Rt),Cr=Math.abs(Ft);let Wr=ze,yn=Ue;for(;;){const hn=Rt>0?(Math.floor(Wr/F)+1)*F:(Math.ceil(Wr/F)-1)*F,Xn=Ft>0?(Math.floor(yn/F)+1)*F:(Math.ceil(yn/F)-1)*F,ln=Math.abs(Wr-hn),fn=Math.abs(yn-Xn),Dr=Math.abs(Wr-Ze),hi=Math.abs(yn-st),xi=wt?ln/gr:Number.POSITIVE_INFINITY,ei=Wt?fn/Cr:Number.POSITIVE_INFINITY;if((Dr<=ln||!wt)&&(hi<=fn||!Wt))break;if(xi<ei&&wt||!Wt){Wr=hn,yn+=Ft*xi;const Bn=new u(Wr,Math.round(yn));V[V.length-1].x===Bn.x&&V[V.length-1].y===Bn.y||V.push(Bn)}else{Wr+=Rt*ei,yn=Xn;const Bn=new u(Math.round(Wr),yn);V[V.length-1].x===Bn.x&&V[V.length-1].y===Bn.y||V.push(Bn)}}const an=new u(Ze,st);V[V.length-1].x===an.x&&V[V.length-1].y===an.y||V.push(an)}return V}function Yre(p,c,d){if(c.length===0)throw new Error("Subdivision vertex ring is empty.");let x=0,T=p[2*c[0]];for(let X=1;X<c.length;X++){const ae=p[2*c[X]];ae<T&&(T=ae,x=X)}const D=c.length;let F=x,V=(F+1)%D;for(;;){const X=F-1>=0?F-1:D-1,ae=(V+1)%D,se=p[2*c[X]],ve=p[2*c[ae]],Le=p[2*c[F]],ze=p[2*c[F]+1],Ue=p[2*c[V]+1];let Ze=!1;if(se<ve)Ze=!0;else if(se>ve)Ze=!1;else{const st=Ue-ze,wt=-(p[2*c[V]]-Le),Wt=ze<Ue?1:-1;((se-Le)*st+(p[2*c[X]+1]-ze)*wt)*Wt>((ve-Le)*st+(p[2*c[ae]+1]-ze)*wt)*Wt&&(Ze=!0)}if(Ze){const st=c[X],wt=c[F],Wt=c[V];st!==wt&&st!==Wt&&wt!==Wt&&d.push(Wt,wt,st),F--,F<0&&(F=D-1)}else{const st=c[ae],wt=c[F],Wt=c[V];st!==wt&&st!==Wt&&wt!==Wt&&d.push(Wt,wt,st),V++,V>=D&&(V=0)}if(X===ae)break}}function RD(p,c,d,x,T,D,F,V,X){const ae=T.length/2,se=F&&V&&X;if(ae<ci.MAX_VERTEX_ARRAY_LENGTH){const ve=c.prepareSegment(ae,d,x),Le=ve.vertexLength;for(let Ze=0;Ze<D.length;Ze+=3)x.emplaceBack(Le+D[Ze],Le+D[Ze+1],Le+D[Ze+2]);let ze,Ue;ve.vertexLength+=ae,ve.primitiveLength+=D.length/3,se&&(Ue=F.prepareSegment(ae,d,V),ze=Ue.vertexLength,Ue.vertexLength+=ae);for(let Ze=0;Ze<T.length;Ze+=2)p(T[Ze],T[Ze+1]);if(se)for(let Ze=0;Ze<X.length;Ze++){const st=X[Ze];for(let wt=1;wt<st.length;wt+=2)V.emplaceBack(ze+st[wt-1],ze+st[wt]);Ue.primitiveLength+=st.length/2}}else(function(ve,Le,ze,Ue,Ze,st){const wt=[];for(let Cr=0;Cr<Ue.length/2;Cr++)wt.push(-1);const Wt={count:0};let Rt=0,Ft=ve.getOrCreateLatestSegment(Le,ze),gr=Ft.vertexLength;for(let Cr=2;Cr<Ze.length;Cr+=3){const Wr=Ze[Cr-2],yn=Ze[Cr-1],an=Ze[Cr];let hn=wt[Wr]<Rt,Xn=wt[yn]<Rt,ln=wt[an]<Rt;Ft.vertexLength+((hn?1:0)+(Xn?1:0)+(ln?1:0))>ci.MAX_VERTEX_ARRAY_LENGTH&&(Ft=ve.createNewSegment(Le,ze),Rt=Wt.count,hn=!0,Xn=!0,ln=!0,gr=0);const fn=i_(wt,Ue,st,Wt,Wr,hn,Ft),Dr=i_(wt,Ue,st,Wt,yn,Xn,Ft),hi=i_(wt,Ue,st,Wt,an,ln,Ft);ze.emplaceBack(gr+fn-Rt,gr+Dr-Rt,gr+hi-Rt),Ft.primitiveLength++}})(c,d,x,T,D,p),se&&(function(ve,Le,ze,Ue,Ze,st){const wt=[];for(let Cr=0;Cr<Ue.length/2;Cr++)wt.push(-1);const Wt={count:0};let Rt=0,Ft=ve.getOrCreateLatestSegment(Le,ze),gr=Ft.vertexLength;for(let Cr=0;Cr<Ze.length;Cr++){const Wr=Ze[Cr];for(let yn=1;yn<Ze[Cr].length;yn+=2){const an=Wr[yn-1],hn=Wr[yn];let Xn=wt[an]<Rt,ln=wt[hn]<Rt;Ft.vertexLength+((Xn?1:0)+(ln?1:0))>ci.MAX_VERTEX_ARRAY_LENGTH&&(Ft=ve.createNewSegment(Le,ze),Rt=Wt.count,Xn=!0,ln=!0,gr=0);const fn=i_(wt,Ue,st,Wt,an,Xn,Ft),Dr=i_(wt,Ue,st,Wt,hn,ln,Ft);ze.emplaceBack(gr+fn-Rt,gr+Dr-Rt),Ft.primitiveLength++}}})(F,d,V,T,X,p),c.forceNewSegmentOnNextPrepare(),F?.forceNewSegmentOnNextPrepare()}function i_(p,c,d,x,T,D,F){if(D){const V=x.count;return d(c[2*T],c[2*T+1]),p[T]=x.count,x.count++,F.vertexLength++,V}return p[T]}class bC{constructor(c){this.zoom=c.zoom,this.globalState=c.globalState,this.overscaling=c.overscaling,this.layers=c.layers,this.layerIds=this.layers.map((d=>d.id)),this.index=c.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new Sr,this.indexArray=new da,this.indexArray2=new oa,this.programConfigurations=new Ku(c.layers,c.zoom),this.segments=new ci,this.segments2=new ci,this.stateDependentLayerIds=this.layers.filter((d=>d.isStateDependent())).map((d=>d.id))}populate(c,d,x){this.hasPattern=mC("fill",this.layers,d);const T=this.layers[0].layout.get("fill-sort-key"),D=!T.isConstant(),F=[];for(const{feature:V,id:X,index:ae,sourceLayerIndex:se}of c){const ve=this.layers[0]._featureFilter.needGeometry,Le=Vh(V,ve);if(!this.layers[0]._featureFilter.filter(new mn(this.zoom,{globalState:this.globalState}),Le,x))continue;const ze=D?T.evaluate(Le,{},x,d.availableImages):void 0,Ue={id:X,properties:V.properties,type:V.type,sourceLayerIndex:se,index:ae,geometry:ve?Le.geometry:Mf(V),patterns:{},sortKey:ze};F.push(Ue)}D&&F.sort(((V,X)=>V.sortKey-X.sortKey));for(const V of F){const{geometry:X,index:ae,sourceLayerIndex:se}=V;if(this.hasPattern){const ve=yC("fill",this.layers,V,{zoom:this.zoom,globalState:this.globalState},d);this.patternFeatures.push(ve)}else this.addFeature(V,X,ae,x,{},d.subdivisionGranularity);d.featureIndex.insert(c[ae].feature,X,ae,se,this.index)}}update(c,d,x){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(c,d,this.stateDependentLayers,{imagePositions:x,globalState:this.globalState})}addFeatures(c,d,x){for(const T of this.patternFeatures)this.addFeature(T,T.geometry,T.index,d,x,c.subdivisionGranularity)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(c){this.uploaded||(this.layoutVertexBuffer=c.createVertexBuffer(this.layoutVertexArray,Bre),this.indexBuffer=c.createIndexBuffer(this.indexArray),this.indexBuffer2=c.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(c),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(c,d,x,T,D,F){for(const V of ya(d,500)){const X=MD(V,T,F.fill.getGranularityForZoomLevel(T.z)),ae=this.layoutVertexArray;RD(((se,ve)=>{ae.emplaceBack(se,ve)}),this.segments,this.layoutVertexArray,this.indexArray,X.verticesFlattened,X.indicesTriangles,this.segments2,this.indexArray2,X.indicesLineList)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,c,x,{imagePositions:D,canonical:T,globalState:this.globalState})}}let OD,LD;We("FillBucket",bC,{omit:["layers","patternFeatures"]});var Zre={get paint(){return LD=LD||new ra({"fill-antialias":new xn(bt.paint_fill["fill-antialias"]),"fill-opacity":new On(bt.paint_fill["fill-opacity"]),"fill-color":new On(bt.paint_fill["fill-color"]),"fill-outline-color":new On(bt.paint_fill["fill-outline-color"]),"fill-translate":new xn(bt.paint_fill["fill-translate"]),"fill-translate-anchor":new xn(bt.paint_fill["fill-translate-anchor"]),"fill-pattern":new Io(bt.paint_fill["fill-pattern"])})},get layout(){return OD=OD||new ra({"fill-sort-key":new On(bt.layout_fill["fill-sort-key"])})}};class Kre extends Oa{constructor(c){super(c,Zre)}recalculate(c,d){super.recalculate(c,d);const x=this.paint._values["fill-outline-color"];x.value.kind==="constant"&&x.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(c){return new bC(c)}queryRadius(){return wx(this.paint.get("fill-translate"))}queryIntersectsFeature({queryGeometry:c,geometry:d,transform:x,pixelsToTileUnits:T}){return fD(Sx(c,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),-x.bearingInRadians,T),d)}isTileClipped(){return!0}}const Jre=wi([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4),Qre=wi([{name:"a_centroid",components:2,type:"Int16"}],4),{members:ene}=Jre;class dy{constructor(c,d,x,T,D){this.properties={},this.extent=x,this.type=0,this.id=void 0,this._pbf=c,this._geometry=-1,this._keys=T,this._values=D,c.readFields(tne,this,d)}loadGeometry(){const c=this._pbf;c.pos=this._geometry;const d=c.readVarint()+c.pos,x=[];let T,D=1,F=0,V=0,X=0;for(;c.pos<d;){if(F<=0){const ae=c.readVarint();D=7&ae,F=ae>>3}if(F--,D===1||D===2)V+=c.readSVarint(),X+=c.readSVarint(),D===1&&(T&&x.push(T),T=[]),T&&T.push(new u(V,X));else{if(D!==7)throw new Error(`unknown command ${D}`);T&&T.push(T[0].clone())}}return T&&x.push(T),x}bbox(){const c=this._pbf;c.pos=this._geometry;const d=c.readVarint()+c.pos;let x=1,T=0,D=0,F=0,V=1/0,X=-1/0,ae=1/0,se=-1/0;for(;c.pos<d;){if(T<=0){const ve=c.readVarint();x=7&ve,T=ve>>3}if(T--,x===1||x===2)D+=c.readSVarint(),F+=c.readSVarint(),D<V&&(V=D),D>X&&(X=D),F<ae&&(ae=F),F>se&&(se=F);else if(x!==7)throw new Error(`unknown command ${x}`)}return[V,ae,X,se]}toGeoJSON(c,d,x){const T=this.extent*Math.pow(2,x),D=this.extent*c,F=this.extent*d,V=this.loadGeometry();function X(Le){return[360*(Le.x+D)/T-180,360/Math.PI*Math.atan(Math.exp((1-2*(Le.y+F)/T)*Math.PI))-90]}function ae(Le){return Le.map(X)}let se;if(this.type===1){const Le=[];for(const Ue of V)Le.push(Ue[0]);const ze=ae(Le);se=Le.length===1?{type:"Point",coordinates:ze[0]}:{type:"MultiPoint",coordinates:ze}}else if(this.type===2){const Le=V.map(ae);se=Le.length===1?{type:"LineString",coordinates:Le[0]}:{type:"MultiLineString",coordinates:Le}}else{if(this.type!==3)throw new Error("unknown feature type");{const Le=(function(Ue){const Ze=Ue.length;if(Ze<=1)return[Ue];const st=[];let wt,Wt;for(let Rt=0;Rt<Ze;Rt++){const Ft=rne(Ue[Rt]);Ft!==0&&(Wt===void 0&&(Wt=Ft<0),Wt===Ft<0?(wt&&st.push(wt),wt=[Ue[Rt]]):wt&&wt.push(Ue[Rt]))}return wt&&st.push(wt),st})(V),ze=[];for(const Ue of Le)ze.push(Ue.map(ae));se=ze.length===1?{type:"Polygon",coordinates:ze[0]}:{type:"MultiPolygon",coordinates:ze}}}const ve={type:"Feature",geometry:se,properties:this.properties};return this.id!=null&&(ve.id=this.id),ve}}function tne(p,c,d){p===1?c.id=d.readVarint():p===2?(function(x,T){const D=x.readVarint()+x.pos;for(;x.pos<D;){const F=T._keys[x.readVarint()],V=T._values[x.readVarint()];T.properties[F]=V}})(d,c):p===3?c.type=d.readVarint():p===4&&(c._geometry=d.pos)}function rne(p){let c=0;for(let d,x,T=0,D=p.length,F=D-1;T<D;F=T++)d=p[T],x=p[F],c+=(x.x-d.x)*(d.y+x.y);return c}dy.types=["Unknown","Point","LineString","Polygon"];class ND{constructor(c,d){this.version=1,this.name="",this.extent=4096,this.length=0,this._pbf=c,this._keys=[],this._values=[],this._features=[],c.readFields(nne,this,d),this.length=this._features.length}feature(c){if(c<0||c>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[c];const d=this._pbf.readVarint()+this._pbf.pos;return new dy(this._pbf,d,this.extent,this._keys,this._values)}}function nne(p,c,d){p===15?c.version=d.readVarint():p===1?c.name=d.readString():p===5?c.extent=d.readVarint():p===2?c._features.push(d.pos):p===3?c._keys.push(d.readString()):p===4&&c._values.push((function(x){let T=null;const D=x.readVarint()+x.pos;for(;x.pos<D;){const F=x.readVarint()>>3;T=F===1?x.readString():F===2?x.readFloat():F===3?x.readDouble():F===4?x.readVarint64():F===5?x.readVarint():F===6?x.readSVarint():F===7?x.readBoolean():null}if(T==null)throw new Error("unknown feature value");return T})(d))}class DD{constructor(c,d){this.layers=c.readFields(ine,{},d)}}function ine(p,c,d){if(p===3){const x=new ND(d,d.readVarint()+d.pos);x.length&&(c[x.name]=x)}}const xC=Math.pow(2,13);function a_(p,c,d,x,T,D,F,V){p.emplaceBack(c,d,2*Math.floor(x*xC)+F,T*xC*2,D*xC*2,Math.round(V))}class wC{constructor(c){this.zoom=c.zoom,this.globalState=c.globalState,this.overscaling=c.overscaling,this.layers=c.layers,this.layerIds=this.layers.map((d=>d.id)),this.index=c.index,this.hasPattern=!1,this.layoutVertexArray=new fr,this.centroidVertexArray=new At,this.indexArray=new da,this.programConfigurations=new Ku(c.layers,c.zoom),this.segments=new ci,this.stateDependentLayerIds=this.layers.filter((d=>d.isStateDependent())).map((d=>d.id))}populate(c,d,x){this.features=[],this.hasPattern=mC("fill-extrusion",this.layers,d);for(const{feature:T,id:D,index:F,sourceLayerIndex:V}of c){const X=this.layers[0]._featureFilter.needGeometry,ae=Vh(T,X);if(!this.layers[0]._featureFilter.filter(new mn(this.zoom,{globalState:this.globalState}),ae,x))continue;const se={id:D,sourceLayerIndex:V,index:F,geometry:X?ae.geometry:Mf(T),properties:T.properties,type:T.type,patterns:{}};this.hasPattern?this.features.push(yC("fill-extrusion",this.layers,se,{zoom:this.zoom,globalState:this.globalState},d)):this.addFeature(se,se.geometry,F,x,{},d.subdivisionGranularity),d.featureIndex.insert(T,se.geometry,F,V,this.index,!0)}}addFeatures(c,d,x){for(const T of this.features){const{geometry:D}=T;this.addFeature(T,D,T.index,d,x,c.subdivisionGranularity)}}update(c,d,x){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(c,d,this.stateDependentLayers,{imagePositions:x,globalState:this.globalState})}isEmpty(){return this.layoutVertexArray.length===0&&this.centroidVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(c){this.uploaded||(this.layoutVertexBuffer=c.createVertexBuffer(this.layoutVertexArray,ene),this.centroidVertexBuffer=c.createVertexBuffer(this.centroidVertexArray,Qre.members,!0),this.indexBuffer=c.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(c),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.centroidVertexBuffer.destroy())}addFeature(c,d,x,T,D,F){for(const V of ya(d,500)){const X={x:0,y:0,sampleCount:0},ae=this.layoutVertexArray.length;this.processPolygon(X,T,c,V,F);const se=this.layoutVertexArray.length-ae,ve=Math.floor(X.x/X.sampleCount),Le=Math.floor(X.y/X.sampleCount);for(let ze=0;ze<se;ze++)this.centroidVertexArray.emplaceBack(ve,Le)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,c,x,{imagePositions:D,canonical:T,globalState:this.globalState})}processPolygon(c,d,x,T,D){if(T.length<1||FD(T[0]))return;for(const ve of T)ve.length!==0&&ane(c,ve);const F={segment:this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray)},V=D.fill.getGranularityForZoomLevel(d.z),X=dy.types[x.type]==="Polygon";for(const ve of T){if(ve.length===0||FD(ve))continue;const Le=Tg(ve,V,X);this._generateSideFaces(Le,F)}if(!X)return;const ae=MD(T,d,V,!1),se=this.layoutVertexArray;RD(((ve,Le)=>{a_(se,ve,Le,0,0,1,1,0)}),this.segments,this.layoutVertexArray,this.indexArray,ae.verticesFlattened,ae.indicesTriangles)}_generateSideFaces(c,d){let x=0;for(let T=1;T<c.length;T++){const D=c[T],F=c[T-1];if(one(D,F))continue;d.segment.vertexLength+4>ci.MAX_VERTEX_ARRAY_LENGTH&&(d.segment=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));const V=D.sub(F)._perp()._unit(),X=F.dist(D);x+X>32768&&(x=0),a_(this.layoutVertexArray,D.x,D.y,V.x,V.y,0,0,x),a_(this.layoutVertexArray,D.x,D.y,V.x,V.y,0,1,x),x+=X,a_(this.layoutVertexArray,F.x,F.y,V.x,V.y,0,0,x),a_(this.layoutVertexArray,F.x,F.y,V.x,V.y,0,1,x);const ae=d.segment.vertexLength;this.indexArray.emplaceBack(ae,ae+2,ae+1),this.indexArray.emplaceBack(ae+1,ae+2,ae+3),d.segment.vertexLength+=4,d.segment.primitiveLength+=2}}}function ane(p,c){for(let d=0;d<c.length;d++){const x=c[d];d===c.length-1&&c[0].x===x.x&&c[0].y===x.y||(p.x+=x.x,p.y+=x.y,p.sampleCount++)}}function one(p,c){return p.x===c.x&&(p.x<0||p.x>we)||p.y===c.y&&(p.y<0||p.y>we)}function FD(p){return p.every((c=>c.x<0))||p.every((c=>c.x>we))||p.every((c=>c.y<0))||p.every((c=>c.y>we))}let BD;We("FillExtrusionBucket",wC,{omit:["layers","features"]});var sne={get paint(){return BD=BD||new ra({"fill-extrusion-opacity":new xn(bt["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new On(bt["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new xn(bt["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new xn(bt["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new Io(bt["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new On(bt["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new On(bt["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new xn(bt["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})}};class lne extends Oa{constructor(c){super(c,sne)}createBucket(c){return new wC(c)}queryRadius(){return wx(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}queryIntersectsFeature({queryGeometry:c,feature:d,featureState:x,geometry:T,transform:D,pixelsToTileUnits:F,pixelPosMatrix:V}){const X=Sx(c,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),-D.bearingInRadians,F),ae=this.paint.get("fill-extrusion-height").evaluate(d,x),se=this.paint.get("fill-extrusion-base").evaluate(d,x),ve=(function(ze,Ue){const Ze=[];for(const st of ze){const wt=[st.x,st.y,0,1];oe(wt,wt,Ue),Ze.push(new u(wt[0]/wt[3],wt[1]/wt[3]))}return Ze})(X,V),Le=(function(ze,Ue,Ze,st){const wt=[],Wt=[],Rt=st[8]*Ue,Ft=st[9]*Ue,gr=st[10]*Ue,Cr=st[11]*Ue,Wr=st[8]*Ze,yn=st[9]*Ze,an=st[10]*Ze,hn=st[11]*Ze;for(const Xn of ze){const ln=[],fn=[];for(const Dr of Xn){const hi=Dr.x,xi=Dr.y,ei=st[0]*hi+st[4]*xi+st[12],Bn=st[1]*hi+st[5]*xi+st[13],Yi=st[2]*hi+st[6]*xi+st[14],jo=st[3]*hi+st[7]*xi+st[15],Hs=Yi+gr,Gl=jo+Cr,jc=ei+Wr,Qu=Bn+yn,Cl=Yi+an,Mo=jo+hn,sl=new u((ei+Rt)/Gl,(Bn+Ft)/Gl);sl.z=Hs/Gl,ln.push(sl);const Al=new u(jc/Mo,Qu/Mo);Al.z=Cl/Mo,fn.push(Al)}wt.push(ln),Wt.push(fn)}return[wt,Wt]})(T,se,ae,V);return(function(ze,Ue,Ze){let st=1/0;fD(Ze,Ue)&&(st=zD(Ze,Ue[0]));for(let wt=0;wt<Ue.length;wt++){const Wt=Ue[wt],Rt=ze[wt];for(let Ft=0;Ft<Wt.length-1;Ft++){const gr=Wt[Ft],Cr=[gr,Wt[Ft+1],Rt[Ft+1],Rt[Ft],gr];hD(Ze,Cr)&&(st=Math.min(st,zD(Ze,Cr)))}}return st!==1/0&&st})(Le[0],Le[1],ve)}}function o_(p,c){return p.x*c.x+p.y*c.y}function zD(p,c){if(p.length===1){let d=0;const x=c[d++];let T;for(;!T||x.equals(T);)if(T=c[d++],!T)return 1/0;for(;d<c.length;d++){const D=c[d],F=p[0],V=T.sub(x),X=D.sub(x),ae=F.sub(x),se=o_(V,V),ve=o_(V,X),Le=o_(X,X),ze=o_(ae,V),Ue=o_(ae,X),Ze=se*Le-ve*ve,st=(Le*ze-ve*Ue)/Ze,wt=(se*Ue-ve*ze)/Ze,Wt=x.z*(1-st-wt)+T.z*st+D.z*wt;if(isFinite(Wt))return Wt}return 1/0}{let d=1/0;for(const x of c)d=Math.min(d,x.z);return d}}const une=wi([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4),{members:cne}=une,hne=wi([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]),{members:fne}=hne,dne=Math.cos(Math.PI/180*37.5),jD=Math.pow(2,14)/.5;class SC{constructor(c){this.zoom=c.zoom,this.globalState=c.globalState,this.overscaling=c.overscaling,this.layers=c.layers,this.layerIds=this.layers.map((d=>d.id)),this.index=c.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach((d=>{this.gradients[d.id]={}})),this.layoutVertexArray=new dr,this.layoutVertexArray2=new mr,this.indexArray=new da,this.programConfigurations=new Ku(c.layers,c.zoom),this.segments=new ci,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter((d=>d.isStateDependent())).map((d=>d.id))}populate(c,d,x){this.hasPattern=mC("line",this.layers,d);const T=this.layers[0].layout.get("line-sort-key"),D=!T.isConstant(),F=[];for(const{feature:V,id:X,index:ae,sourceLayerIndex:se}of c){const ve=this.layers[0]._featureFilter.needGeometry,Le=Vh(V,ve);if(!this.layers[0]._featureFilter.filter(new mn(this.zoom,{globalState:this.globalState}),Le,x))continue;const ze=D?T.evaluate(Le,{},x):void 0,Ue={id:X,properties:V.properties,type:V.type,sourceLayerIndex:se,index:ae,geometry:ve?Le.geometry:Mf(V),patterns:{},sortKey:ze};F.push(Ue)}D&&F.sort(((V,X)=>V.sortKey-X.sortKey));for(const V of F){const{geometry:X,index:ae,sourceLayerIndex:se}=V;if(this.hasPattern){const ve=yC("line",this.layers,V,{zoom:this.zoom,globalState:this.globalState},d);this.patternFeatures.push(ve)}else this.addFeature(V,X,ae,x,{},d.subdivisionGranularity);d.featureIndex.insert(c[ae].feature,X,ae,se,this.index)}}update(c,d,x){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(c,d,this.stateDependentLayers,{imagePositions:x,globalState:this.globalState})}addFeatures(c,d,x){for(const T of this.patternFeatures)this.addFeature(T,T.geometry,T.index,d,x,c.subdivisionGranularity)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(c){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=c.createVertexBuffer(this.layoutVertexArray2,fne)),this.layoutVertexBuffer=c.createVertexBuffer(this.layoutVertexArray,cne),this.indexBuffer=c.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(c),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(c){if(c.properties&&Object.prototype.hasOwnProperty.call(c.properties,"mapbox_clip_start")&&Object.prototype.hasOwnProperty.call(c.properties,"mapbox_clip_end"))return{start:+c.properties.mapbox_clip_start,end:+c.properties.mapbox_clip_end}}addFeature(c,d,x,T,D,F){const V=this.layers[0].layout,X=V.get("line-join").evaluate(c,{}),ae=V.get("line-cap"),se=V.get("line-miter-limit"),ve=V.get("line-round-limit");this.lineClips=this.lineFeatureClips(c);for(const Le of d)this.addLine(Le,c,X,ae,se,ve,T,F);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,c,x,{imagePositions:D,canonical:T,globalState:this.globalState})}addLine(c,d,x,T,D,F,V,X){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,c=Tg(c,V?X.line.getGranularityForZoomLevel(V.z):1),this.lineClips){this.lineClipsArray.push(this.lineClips);for(let Rt=0;Rt<c.length-1;Rt++)this.totalDistance+=c[Rt].dist(c[Rt+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const ae=dy.types[d.type]==="Polygon";let se=c.length;for(;se>=2&&c[se-1].equals(c[se-2]);)se--;let ve=0;for(;ve<se-1&&c[ve].equals(c[ve+1]);)ve++;if(se<(ae?3:2))return;x==="bevel"&&(D=1.05);const Le=this.overscaling<=16?122880/(512*this.overscaling):0,ze=this.segments.prepareSegment(10*se,this.layoutVertexArray,this.indexArray);let Ue,Ze,st,wt,Wt;this.e1=this.e2=-1,ae&&(Ue=c[se-2],Wt=c[ve].sub(Ue)._unit()._perp());for(let Rt=ve;Rt<se;Rt++){if(st=Rt===se-1?ae?c[ve+1]:void 0:c[Rt+1],st&&c[Rt].equals(st))continue;Wt&&(wt=Wt),Ue&&(Ze=Ue),Ue=c[Rt],Wt=st?st.sub(Ue)._unit()._perp():wt,wt=wt||Wt;let Ft=wt.add(Wt);Ft.x===0&&Ft.y===0||Ft._unit();const gr=wt.x*Wt.x+wt.y*Wt.y,Cr=Ft.x*Wt.x+Ft.y*Wt.y,Wr=Cr!==0?1/Cr:1/0,yn=2*Math.sqrt(2-2*Cr),an=Cr<dne&&Ze&&st,hn=wt.x*Wt.y-wt.y*Wt.x>0;if(an&&Rt>ve){const fn=Ue.dist(Ze);if(fn>2*Le){const Dr=Ue.sub(Ue.sub(Ze)._mult(Le/fn)._round());this.updateDistance(Ze,Dr),this.addCurrentVertex(Dr,wt,0,0,ze),Ze=Dr}}const Xn=Ze&&st;let ln=Xn?x:ae?"butt":T;if(Xn&&ln==="round"&&(Wr<F?ln="miter":Wr<=2&&(ln="fakeround")),ln==="miter"&&Wr>D&&(ln="bevel"),ln==="bevel"&&(Wr>2&&(ln="flipbevel"),Wr<D&&(ln="miter")),Ze&&this.updateDistance(Ze,Ue),ln==="miter")Ft._mult(Wr),this.addCurrentVertex(Ue,Ft,0,0,ze);else if(ln==="flipbevel"){if(Wr>100)Ft=Wt.mult(-1);else{const fn=Wr*wt.add(Wt).mag()/wt.sub(Wt).mag();Ft._perp()._mult(fn*(hn?-1:1))}this.addCurrentVertex(Ue,Ft,0,0,ze),this.addCurrentVertex(Ue,Ft.mult(-1),0,0,ze)}else if(ln==="bevel"||ln==="fakeround"){const fn=-Math.sqrt(Wr*Wr-1),Dr=hn?fn:0,hi=hn?0:fn;if(Ze&&this.addCurrentVertex(Ue,wt,Dr,hi,ze),ln==="fakeround"){const xi=Math.round(180*yn/Math.PI/20);for(let ei=1;ei<xi;ei++){let Bn=ei/xi;if(Bn!==.5){const jo=Bn-.5;Bn+=Bn*jo*(Bn-1)*((1.0904+gr*(gr*(3.55645-1.43519*gr)-3.2452))*jo*jo+(.848013+gr*(.215638*gr-1.06021)))}const Yi=Wt.sub(wt)._mult(Bn)._add(wt)._unit()._mult(hn?-1:1);this.addHalfVertex(Ue,Yi.x,Yi.y,!1,hn,0,ze)}}st&&this.addCurrentVertex(Ue,Wt,-Dr,-hi,ze)}else if(ln==="butt")this.addCurrentVertex(Ue,Ft,0,0,ze);else if(ln==="square"){const fn=Ze?1:-1;this.addCurrentVertex(Ue,Ft,fn,fn,ze)}else ln==="round"&&(Ze&&(this.addCurrentVertex(Ue,wt,0,0,ze),this.addCurrentVertex(Ue,wt,1,1,ze,!0)),st&&(this.addCurrentVertex(Ue,Wt,-1,-1,ze,!0),this.addCurrentVertex(Ue,Wt,0,0,ze)));if(an&&Rt<se-1){const fn=Ue.dist(st);if(fn>2*Le){const Dr=Ue.add(st.sub(Ue)._mult(Le/fn)._round());this.updateDistance(Ue,Dr),this.addCurrentVertex(Dr,Wt,0,0,ze),Ue=Dr}}}}addCurrentVertex(c,d,x,T,D,F=!1){const V=d.y*T-d.x,X=-d.y-d.x*T;this.addHalfVertex(c,d.x+d.y*x,d.y-d.x*x,F,!1,x,D),this.addHalfVertex(c,V,X,F,!0,-T,D),this.distance>jD/2&&this.totalDistance===0&&(this.distance=0,this.updateScaledDistance(),this.addCurrentVertex(c,d,x,T,D,F))}addHalfVertex({x:c,y:d},x,T,D,F,V,X){const ae=.5*(this.lineClips?this.scaledDistance*(jD-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((c<<1)+(D?1:0),(d<<1)+(F?1:0),Math.round(63*x)+128,Math.round(63*T)+128,1+(V===0?0:V<0?-1:1)|(63&ae)<<2,ae>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);const se=X.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,se,this.e2),X.primitiveLength++),F?this.e2=se:this.e1=se}updateScaledDistance(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance}updateDistance(c,d){this.distance+=c.dist(d),this.updateScaledDistance()}}let UD,VD;We("LineBucket",SC,{omit:["layers","patternFeatures"]});var $D={get paint(){return VD=VD||new ra({"line-opacity":new On(bt.paint_line["line-opacity"]),"line-color":new On(bt.paint_line["line-color"]),"line-translate":new xn(bt.paint_line["line-translate"]),"line-translate-anchor":new xn(bt.paint_line["line-translate-anchor"]),"line-width":new On(bt.paint_line["line-width"]),"line-gap-width":new On(bt.paint_line["line-gap-width"]),"line-offset":new On(bt.paint_line["line-offset"]),"line-blur":new On(bt.paint_line["line-blur"]),"line-dasharray":new zi(bt.paint_line["line-dasharray"]),"line-pattern":new Io(bt.paint_line["line-pattern"]),"line-gradient":new la(bt.paint_line["line-gradient"])})},get layout(){return UD=UD||new ra({"line-cap":new xn(bt.layout_line["line-cap"]),"line-join":new On(bt.layout_line["line-join"]),"line-miter-limit":new xn(bt.layout_line["line-miter-limit"]),"line-round-limit":new xn(bt.layout_line["line-round-limit"]),"line-sort-key":new On(bt.layout_line["line-sort-key"])})}};class pne extends On{possiblyEvaluate(c,d){return d=new mn(Math.floor(d.zoom),{now:d.now,fadeDuration:d.fadeDuration,zoomHistory:d.zoomHistory,transition:d.transition}),super.possiblyEvaluate(c,d)}evaluate(c,d,x,T){return d=De({},d,{zoom:Math.floor(d.zoom)}),super.evaluate(c,d,x,T)}}let Ax;class gne extends Oa{constructor(c){super(c,$D),this.gradientVersion=0,Ax||(Ax=new pne($D.paint.properties["line-width"].specification),Ax.useIntegerZoom=!0)}_handleSpecialPaintPropertyUpdate(c){if(c==="line-gradient"){const d=this.gradientExpression();this.stepInterpolant=!!(function(x){return x._styleExpression!==void 0})(d)&&d._styleExpression.expression instanceof dt,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(c,d){super.recalculate(c,d),this.paint._values["line-floorwidth"]=Ax.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,c)}createBucket(c){return new SC(c)}queryRadius(c){const d=c,x=qD(K0("line-width",this,d),K0("line-gap-width",this,d)),T=K0("line-offset",this,d);return x/2+Math.abs(T)+wx(this.paint.get("line-translate"))}queryIntersectsFeature({queryGeometry:c,feature:d,featureState:x,geometry:T,transform:D,pixelsToTileUnits:F}){const V=Sx(c,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),-D.bearingInRadians,F),X=F/2*qD(this.paint.get("line-width").evaluate(d,x),this.paint.get("line-gap-width").evaluate(d,x)),ae=this.paint.get("line-offset").evaluate(d,x);return ae&&(T=(function(se,ve){const Le=[];for(let ze=0;ze<se.length;ze++){const Ue=se[ze],Ze=[];for(let st=0;st<Ue.length;st++){const wt=Ue[st-1],Wt=Ue[st],Rt=Ue[st+1],Ft=st===0?new u(0,0):Wt.sub(wt)._unit()._perp(),gr=st===Ue.length-1?new u(0,0):Rt.sub(Wt)._unit()._perp(),Cr=Ft._add(gr)._unit(),Wr=Cr.x*gr.x+Cr.y*gr.y;Wr!==0&&Cr._mult(1/Wr),Ze.push(Cr._mult(ve)._add(Wt))}Le.push(Ze)}return Le})(T,ae*F)),(function(se,ve,Le){for(let ze=0;ze<ve.length;ze++){const Ue=ve[ze];if(se.length>=3){for(let Ze=0;Ze<Ue.length;Ze++)if(uy(se,Ue[Ze]))return!0}if(Cre(se,Ue,Le))return!0}return!1})(V,T,X)}isTileClipped(){return!0}}function qD(p,c){return c>0?c+2*p:p}const mne=wi([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),yne=wi([{name:"a_projected_pos",components:3,type:"Float32"}],4);wi([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const vne=wi([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"},{name:"a_box_real",components:2,type:"Int16"}]);wi([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const HD=wi([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),_ne=wi([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function bne(p,c,d){return p.sections.forEach((x=>{x.text=(function(T,D,F){const V=D.layout.get("text-transform").evaluate(F,{});return V==="uppercase"?T=T.toLocaleUpperCase():V==="lowercase"&&(T=T.toLocaleLowerCase()),yi.applyArabicShaping&&(T=yi.applyArabicShaping(T)),T})(x.text,c,d)})),p}wi([{name:"triangle",components:3,type:"Uint16"}]),wi([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),wi([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Uint16",name:"textAnchorOffsetStartIndex"},{type:"Uint16",name:"textAnchorOffsetEndIndex"}]),wi([{type:"Float32",name:"offsetX"}]),wi([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]),wi([{type:"Uint16",name:"textAnchor"},{type:"Float32",components:2,name:"textOffset"}]);const s_={"!":"","#":"",$:"","%":"","&":"","(":"",")":"","*":"","+":"",",":"","-":"",".":"","/":"",":":"",";":"","<":"","=":"",">":"","?":"","@":"","[":"","\\":"","]":"","^":"",_:"","`":"","{":"","|":"","}":"","~":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":""};var ol=24;const EC=4294967296,WD=1/EC,GD=typeof TextDecoder>"u"?null:new TextDecoder("utf-8");class TC{constructor(c=new Uint8Array(16)){this.buf=ArrayBuffer.isView(c)?c:new Uint8Array(c),this.dataView=new DataView(this.buf.buffer),this.pos=0,this.type=0,this.length=this.buf.length}readFields(c,d,x=this.length){for(;this.pos<x;){const T=this.readVarint(),D=T>>3,F=this.pos;this.type=7&T,c(D,d,this),this.pos===F&&this.skip(T)}return d}readMessage(c,d){return this.readFields(c,d,this.readVarint()+this.pos)}readFixed32(){const c=this.dataView.getUint32(this.pos,!0);return this.pos+=4,c}readSFixed32(){const c=this.dataView.getInt32(this.pos,!0);return this.pos+=4,c}readFixed64(){const c=this.dataView.getUint32(this.pos,!0)+this.dataView.getUint32(this.pos+4,!0)*EC;return this.pos+=8,c}readSFixed64(){const c=this.dataView.getUint32(this.pos,!0)+this.dataView.getInt32(this.pos+4,!0)*EC;return this.pos+=8,c}readFloat(){const c=this.dataView.getFloat32(this.pos,!0);return this.pos+=4,c}readDouble(){const c=this.dataView.getFloat64(this.pos,!0);return this.pos+=8,c}readVarint(c){const d=this.buf;let x,T;return T=d[this.pos++],x=127&T,T<128?x:(T=d[this.pos++],x|=(127&T)<<7,T<128?x:(T=d[this.pos++],x|=(127&T)<<14,T<128?x:(T=d[this.pos++],x|=(127&T)<<21,T<128?x:(T=d[this.pos],x|=(15&T)<<28,(function(D,F,V){const X=V.buf;let ae,se;if(se=X[V.pos++],ae=(112&se)>>4,se<128||(se=X[V.pos++],ae|=(127&se)<<3,se<128)||(se=X[V.pos++],ae|=(127&se)<<10,se<128)||(se=X[V.pos++],ae|=(127&se)<<17,se<128)||(se=X[V.pos++],ae|=(127&se)<<24,se<128)||(se=X[V.pos++],ae|=(1&se)<<31,se<128))return py(D,ae,F);throw new Error("Expected varint not more than 10 bytes")})(x,c,this)))))}readVarint64(){return this.readVarint(!0)}readSVarint(){const c=this.readVarint();return c%2==1?(c+1)/-2:c/2}readBoolean(){return!!this.readVarint()}readString(){const c=this.readVarint()+this.pos,d=this.pos;return this.pos=c,c-d>=12&&GD?GD.decode(this.buf.subarray(d,c)):(function(x,T,D){let F="",V=T;for(;V<D;){const X=x[V];let ae,se,ve,Le=null,ze=X>239?4:X>223?3:X>191?2:1;if(V+ze>D)break;ze===1?X<128&&(Le=X):ze===2?(ae=x[V+1],(192&ae)==128&&(Le=(31&X)<<6|63&ae,Le<=127&&(Le=null))):ze===3?(ae=x[V+1],se=x[V+2],(192&ae)==128&&(192&se)==128&&(Le=(15&X)<<12|(63&ae)<<6|63&se,(Le<=2047||Le>=55296&&Le<=57343)&&(Le=null))):ze===4&&(ae=x[V+1],se=x[V+2],ve=x[V+3],(192&ae)==128&&(192&se)==128&&(192&ve)==128&&(Le=(15&X)<<18|(63&ae)<<12|(63&se)<<6|63&ve,(Le<=65535||Le>=1114112)&&(Le=null))),Le===null?(Le=65533,ze=1):Le>65535&&(Le-=65536,F+=String.fromCharCode(Le>>>10&1023|55296),Le=56320|1023&Le),F+=String.fromCharCode(Le),V+=ze}return F})(this.buf,d,c)}readBytes(){const c=this.readVarint()+this.pos,d=this.buf.subarray(this.pos,c);return this.pos=c,d}readPackedVarint(c=[],d){const x=this.readPackedEnd();for(;this.pos<x;)c.push(this.readVarint(d));return c}readPackedSVarint(c=[]){const d=this.readPackedEnd();for(;this.pos<d;)c.push(this.readSVarint());return c}readPackedBoolean(c=[]){const d=this.readPackedEnd();for(;this.pos<d;)c.push(this.readBoolean());return c}readPackedFloat(c=[]){const d=this.readPackedEnd();for(;this.pos<d;)c.push(this.readFloat());return c}readPackedDouble(c=[]){const d=this.readPackedEnd();for(;this.pos<d;)c.push(this.readDouble());return c}readPackedFixed32(c=[]){const d=this.readPackedEnd();for(;this.pos<d;)c.push(this.readFixed32());return c}readPackedSFixed32(c=[]){const d=this.readPackedEnd();for(;this.pos<d;)c.push(this.readSFixed32());return c}readPackedFixed64(c=[]){const d=this.readPackedEnd();for(;this.pos<d;)c.push(this.readFixed64());return c}readPackedSFixed64(c=[]){const d=this.readPackedEnd();for(;this.pos<d;)c.push(this.readSFixed64());return c}readPackedEnd(){return this.type===2?this.readVarint()+this.pos:this.pos+1}skip(c){const d=7&c;if(d===0)for(;this.buf[this.pos++]>127;);else if(d===2)this.pos=this.readVarint()+this.pos;else if(d===5)this.pos+=4;else{if(d!==1)throw new Error(`Unimplemented type: ${d}`);this.pos+=8}}writeTag(c,d){this.writeVarint(c<<3|d)}realloc(c){let d=this.length||16;for(;d<this.pos+c;)d*=2;if(d!==this.length){const x=new Uint8Array(d);x.set(this.buf),this.buf=x,this.dataView=new DataView(x.buffer),this.length=d}}finish(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)}writeFixed32(c){this.realloc(4),this.dataView.setInt32(this.pos,c,!0),this.pos+=4}writeSFixed32(c){this.realloc(4),this.dataView.setInt32(this.pos,c,!0),this.pos+=4}writeFixed64(c){this.realloc(8),this.dataView.setInt32(this.pos,-1&c,!0),this.dataView.setInt32(this.pos+4,Math.floor(c*WD),!0),this.pos+=8}writeSFixed64(c){this.realloc(8),this.dataView.setInt32(this.pos,-1&c,!0),this.dataView.setInt32(this.pos+4,Math.floor(c*WD),!0),this.pos+=8}writeVarint(c){(c=+c||0)>268435455||c<0?(function(d,x){let T,D;if(d>=0?(T=d%4294967296|0,D=d/4294967296|0):(T=~(-d%4294967296),D=~(-d/4294967296),4294967295^T?T=T+1|0:(T=0,D=D+1|0)),d>=18446744073709552e3||d<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");x.realloc(10),(function(F,V,X){X.buf[X.pos++]=127&F|128,F>>>=7,X.buf[X.pos++]=127&F|128,F>>>=7,X.buf[X.pos++]=127&F|128,F>>>=7,X.buf[X.pos++]=127&F|128,X.buf[X.pos]=127&(F>>>=7)})(T,0,x),(function(F,V){const X=(7&F)<<4;V.buf[V.pos++]|=X|((F>>>=3)?128:0),F&&(V.buf[V.pos++]=127&F|((F>>>=7)?128:0),F&&(V.buf[V.pos++]=127&F|((F>>>=7)?128:0),F&&(V.buf[V.pos++]=127&F|((F>>>=7)?128:0),F&&(V.buf[V.pos++]=127&F|((F>>>=7)?128:0),F&&(V.buf[V.pos++]=127&F)))))})(D,x)})(c,this):(this.realloc(4),this.buf[this.pos++]=127&c|(c>127?128:0),c<=127||(this.buf[this.pos++]=127&(c>>>=7)|(c>127?128:0),c<=127||(this.buf[this.pos++]=127&(c>>>=7)|(c>127?128:0),c<=127||(this.buf[this.pos++]=c>>>7&127))))}writeSVarint(c){this.writeVarint(c<0?2*-c-1:2*c)}writeBoolean(c){this.writeVarint(+c)}writeString(c){c=String(c),this.realloc(4*c.length),this.pos++;const d=this.pos;this.pos=(function(T,D,F){for(let V,X,ae=0;ae<D.length;ae++){if(V=D.charCodeAt(ae),V>55295&&V<57344){if(!X){V>56319||ae+1===D.length?(T[F++]=239,T[F++]=191,T[F++]=189):X=V;continue}if(V<56320){T[F++]=239,T[F++]=191,T[F++]=189,X=V;continue}V=X-55296<<10|V-56320|65536,X=null}else X&&(T[F++]=239,T[F++]=191,T[F++]=189,X=null);V<128?T[F++]=V:(V<2048?T[F++]=V>>6|192:(V<65536?T[F++]=V>>12|224:(T[F++]=V>>18|240,T[F++]=V>>12&63|128),T[F++]=V>>6&63|128),T[F++]=63&V|128)}return F})(this.buf,c,this.pos);const x=this.pos-d;x>=128&&XD(d,x,this),this.pos=d-1,this.writeVarint(x),this.pos+=x}writeFloat(c){this.realloc(4),this.dataView.setFloat32(this.pos,c,!0),this.pos+=4}writeDouble(c){this.realloc(8),this.dataView.setFloat64(this.pos,c,!0),this.pos+=8}writeBytes(c){const d=c.length;this.writeVarint(d),this.realloc(d);for(let x=0;x<d;x++)this.buf[this.pos++]=c[x]}writeRawMessage(c,d){this.pos++;const x=this.pos;c(d,this);const T=this.pos-x;T>=128&&XD(x,T,this),this.pos=x-1,this.writeVarint(T),this.pos+=T}writeMessage(c,d,x){this.writeTag(c,2),this.writeRawMessage(d,x)}writePackedVarint(c,d){d.length&&this.writeMessage(c,xne,d)}writePackedSVarint(c,d){d.length&&this.writeMessage(c,wne,d)}writePackedBoolean(c,d){d.length&&this.writeMessage(c,Tne,d)}writePackedFloat(c,d){d.length&&this.writeMessage(c,Sne,d)}writePackedDouble(c,d){d.length&&this.writeMessage(c,Ene,d)}writePackedFixed32(c,d){d.length&&this.writeMessage(c,Cne,d)}writePackedSFixed32(c,d){d.length&&this.writeMessage(c,Ane,d)}writePackedFixed64(c,d){d.length&&this.writeMessage(c,Ine,d)}writePackedSFixed64(c,d){d.length&&this.writeMessage(c,Pne,d)}writeBytesField(c,d){this.writeTag(c,2),this.writeBytes(d)}writeFixed32Field(c,d){this.writeTag(c,5),this.writeFixed32(d)}writeSFixed32Field(c,d){this.writeTag(c,5),this.writeSFixed32(d)}writeFixed64Field(c,d){this.writeTag(c,1),this.writeFixed64(d)}writeSFixed64Field(c,d){this.writeTag(c,1),this.writeSFixed64(d)}writeVarintField(c,d){this.writeTag(c,0),this.writeVarint(d)}writeSVarintField(c,d){this.writeTag(c,0),this.writeSVarint(d)}writeStringField(c,d){this.writeTag(c,2),this.writeString(d)}writeFloatField(c,d){this.writeTag(c,5),this.writeFloat(d)}writeDoubleField(c,d){this.writeTag(c,1),this.writeDouble(d)}writeBooleanField(c,d){this.writeVarintField(c,+d)}}function py(p,c,d){return d?4294967296*c+(p>>>0):4294967296*(c>>>0)+(p>>>0)}function XD(p,c,d){const x=c<=16383?1:c<=2097151?2:c<=268435455?3:Math.floor(Math.log(c)/(7*Math.LN2));d.realloc(x);for(let T=d.pos-1;T>=p;T--)d.buf[T+x]=d.buf[T]}function xne(p,c){for(let d=0;d<p.length;d++)c.writeVarint(p[d])}function wne(p,c){for(let d=0;d<p.length;d++)c.writeSVarint(p[d])}function Sne(p,c){for(let d=0;d<p.length;d++)c.writeFloat(p[d])}function Ene(p,c){for(let d=0;d<p.length;d++)c.writeDouble(p[d])}function Tne(p,c){for(let d=0;d<p.length;d++)c.writeBoolean(p[d])}function Cne(p,c){for(let d=0;d<p.length;d++)c.writeFixed32(p[d])}function Ane(p,c){for(let d=0;d<p.length;d++)c.writeSFixed32(p[d])}function Ine(p,c){for(let d=0;d<p.length;d++)c.writeFixed64(p[d])}function Pne(p,c){for(let d=0;d<p.length;d++)c.writeSFixed64(p[d])}function kne(p,c,d){p===1&&d.readMessage(Mne,c)}function Mne(p,c,d){if(p===3){const{id:x,bitmap:T,width:D,height:F,left:V,top:X,advance:ae}=d.readMessage(Rne,{});c.push({id:x,bitmap:new J0({width:D+6,height:F+6},T),metrics:{width:D,height:F,left:V,top:X,advance:ae}})}}function Rne(p,c,d){p===1?c.id=d.readVarint():p===2?c.bitmap=d.readBytes():p===3?c.width=d.readVarint():p===4?c.height=d.readVarint():p===5?c.left=d.readSVarint():p===6?c.top=d.readSVarint():p===7&&(c.advance=d.readVarint())}function YD(p){let c=0,d=0;for(const F of p)c+=F.w*F.h,d=Math.max(d,F.w);p.sort(((F,V)=>V.h-F.h));const x=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(c/.95)),d),h:1/0}];let T=0,D=0;for(const F of p)for(let V=x.length-1;V>=0;V--){const X=x[V];if(!(F.w>X.w||F.h>X.h)){if(F.x=X.x,F.y=X.y,D=Math.max(D,F.y+F.h),T=Math.max(T,F.x+F.w),F.w===X.w&&F.h===X.h){const ae=x.pop();ae&&V<x.length&&(x[V]=ae)}else F.h===X.h?(X.x+=F.w,X.w-=F.w):F.w===X.w?(X.y+=F.h,X.h-=F.h):(x.push({x:X.x+F.w,y:X.y,w:X.w-F.w,h:F.h}),X.y+=F.h,X.h-=F.h);break}}return{w:T,h:D,fill:c/(T*D)||0}}class CC{constructor(c,{pixelRatio:d,version:x,stretchX:T,stretchY:D,content:F,textFitWidth:V,textFitHeight:X}){this.paddedRect=c,this.pixelRatio=d,this.stretchX=T,this.stretchY=D,this.content=F,this.version=x,this.textFitWidth=V,this.textFitHeight=X}get tl(){return[this.paddedRect.x+1,this.paddedRect.y+1]}get br(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]}get tlbr(){return this.tl.concat(this.br)}get displaySize(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]}}class ZD{constructor(c,d){const x={},T={};this.haveRenderCallbacks=[];const D=[];this.addImages(c,x,D),this.addImages(d,T,D);const{w:F,h:V}=YD(D),X=new Ju({width:F||1,height:V||1});for(const ae in c){const se=c[ae],ve=x[ae].paddedRect;Ju.copy(se.data,X,{x:0,y:0},{x:ve.x+1,y:ve.y+1},se.data)}for(const ae in d){const se=d[ae],ve=T[ae].paddedRect,Le=ve.x+1,ze=ve.y+1,Ue=se.data.width,Ze=se.data.height;Ju.copy(se.data,X,{x:0,y:0},{x:Le,y:ze},se.data),Ju.copy(se.data,X,{x:0,y:Ze-1},{x:Le,y:ze-1},{width:Ue,height:1}),Ju.copy(se.data,X,{x:0,y:0},{x:Le,y:ze+Ze},{width:Ue,height:1}),Ju.copy(se.data,X,{x:Ue-1,y:0},{x:Le-1,y:ze},{width:1,height:Ze}),Ju.copy(se.data,X,{x:0,y:0},{x:Le+Ue,y:ze},{width:1,height:Ze})}this.image=X,this.iconPositions=x,this.patternPositions=T}addImages(c,d,x){for(const T in c){const D=c[T],F={x:0,y:0,w:D.data.width+2,h:D.data.height+2};x.push(F),d[T]=new CC(F,D),D.hasRenderCallback&&this.haveRenderCallbacks.push(T)}}patchUpdatedImages(c,d){c.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const x in c.updatedImages)this.patchUpdatedImage(this.iconPositions[x],c.getImage(x),d),this.patchUpdatedImage(this.patternPositions[x],c.getImage(x),d)}patchUpdatedImage(c,d,x){if(!c||!d||c.version===d.version)return;c.version=d.version;const[T,D]=c.tl;x.update(d.data,void 0,{x:T,y:D})}}var gp;We("ImagePosition",CC),We("ImageAtlas",ZD),s.ao=void 0,(gp=s.ao||(s.ao={}))[gp.none=0]="none",gp[gp.horizontal=1]="horizontal",gp[gp.vertical=2]="vertical",gp[gp.horizontalOnly=3]="horizontalOnly";class l_{constructor(){this.scale=1,this.fontStack="",this.imageName=null,this.verticalAlign="bottom"}static forText(c,d,x){const T=new l_;return T.scale=c||1,T.fontStack=d,T.verticalAlign=x||"bottom",T}static forImage(c,d){const x=new l_;return x.imageName=c,x.verticalAlign=d||"bottom",x}}class gy{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(c,d){const x=new gy;for(let T=0;T<c.sections.length;T++){const D=c.sections[T];D.image?x.addImageSection(D):x.addTextSection(D,d)}return x}length(){return this.text.length}getSection(c){return this.sections[this.sectionIndex[c]]}getSectionIndex(c){return this.sectionIndex[c]}getCharCode(c){return this.text.charCodeAt(c)}verticalizePunctuation(){this.text=(function(c){let d="";for(let x=0;x<c.length;x++){const T=c.charCodeAt(x+1)||null,D=c.charCodeAt(x-1)||null;d+=T&&zn(T)&&!s_[c[x+1]]||D&&zn(D)&&!s_[c[x-1]]||!s_[c[x]]?c[x]:s_[c[x]]}return d})(this.text)}trim(){let c=0;for(let x=0;x<this.text.length&&Px[this.text.charCodeAt(x)];x++)c++;let d=this.text.length;for(let x=this.text.length-1;x>=0&&x>=c&&Px[this.text.charCodeAt(x)];x--)d--;this.text=this.text.substring(c,d),this.sectionIndex=this.sectionIndex.slice(c,d)}substring(c,d){const x=new gy;return x.text=this.text.substring(c,d),x.sectionIndex=this.sectionIndex.slice(c,d),x.sections=this.sections,x}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce(((c,d)=>Math.max(c,this.sections[d].scale)),0)}getMaxImageSize(c){let d=0,x=0;for(let T=0;T<this.length();T++){const D=this.getSection(T);if(D.imageName){const F=c[D.imageName];if(!F)continue;const V=F.displaySize;d=Math.max(d,V[0]),x=Math.max(x,V[1])}}return{maxImageWidth:d,maxImageHeight:x}}addTextSection(c,d){this.text+=c.text,this.sections.push(l_.forText(c.scale,c.fontStack||d,c.verticalAlign));const x=this.sections.length-1;for(let T=0;T<c.text.length;++T)this.sectionIndex.push(x)}addImageSection(c){const d=c.image?c.image.name:"";if(d.length===0)return void at("Can't add FormattedSection with an empty image.");const x=this.getNextImageSectionCharCode();x?(this.text+=String.fromCharCode(x),this.sections.push(l_.forImage(d,c.verticalAlign)),this.sectionIndex.push(this.sections.length-1)):at("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function Ix(p,c,d,x,T,D,F,V,X,ae,se,ve,Le,ze,Ue){const Ze=gy.fromFeature(p,T);let st;ve===s.ao.vertical&&Ze.verticalizePunctuation();const{processBidirectionalText:wt,processStyledBidirectionalText:Wt}=yi;if(wt&&Ze.sections.length===1){st=[];const gr=wt(Ze.toString(),AC(Ze,ae,D,c,x,ze));for(const Cr of gr){const Wr=new gy;Wr.text=Cr,Wr.sections=Ze.sections;for(let yn=0;yn<Cr.length;yn++)Wr.sectionIndex.push(0);st.push(Wr)}}else if(Wt){st=[];const gr=Wt(Ze.text,Ze.sectionIndex,AC(Ze,ae,D,c,x,ze));for(const Cr of gr){const Wr=new gy;Wr.text=Cr[0],Wr.sectionIndex=Cr[1],Wr.sections=Ze.sections,st.push(Wr)}}else st=(function(gr,Cr){const Wr=[],yn=gr.text;let an=0;for(const hn of Cr)Wr.push(gr.substring(an,hn)),an=hn;return an<yn.length&&Wr.push(gr.substring(an,yn.length)),Wr})(Ze,AC(Ze,ae,D,c,x,ze));const Rt=[],Ft={positionedLines:Rt,text:Ze.toString(),top:se[1],bottom:se[1],left:se[0],right:se[0],writingMode:ve,iconsInText:!1,verticalizable:!1};return(function(gr,Cr,Wr,yn,an,hn,Xn,ln,fn,Dr,hi,xi){let ei=0,Bn=0,Yi=0,jo=0;const Hs=ln==="right"?1:ln==="left"?0:.5,Gl=ol/xi;let jc=0;for(const Mo of an){Mo.trim();const sl=Mo.getMaxScale(),Al={positionedGlyphs:[],lineOffset:0};gr.positionedLines[jc]=Al;const Il=Al.positionedGlyphs;let Pu=0;if(!Mo.length()){Bn+=hn,++jc;continue}const Uc=Dne(yn,Mo,Gl);for(let ec=0;ec<Mo.length();ec++){const Ws=Mo.getSection(ec),ul=Mo.getSectionIndex(ec),cl=Mo.getCharCode(ec),Ps=Fne(fn,hi,cl);let po;if(Ws.imageName){if(gr.iconsInText=!0,Ws.scale=Ws.scale*Gl,po=zne(Ws,Ps,sl,Uc,yn),!po)continue;Pu=Math.max(Pu,po.imageOffset)}else if(po=Bne(Ws,cl,Ps,Uc,Cr,Wr),!po)continue;const{rect:$h,metrics:_y,baselineOffset:qh}=po;Il.push({glyph:cl,imageName:Ws.imageName,x:ei,y:Bn+qh+-17,vertical:Ps,scale:Ws.scale,fontStack:Ws.fontStack,sectionIndex:ul,metrics:_y,rect:$h}),Ps?(gr.verticalizable=!0,ei+=(Ws.imageName?_y.advance:ol)*Ws.scale+Dr):ei+=_y.advance*Ws.scale+Dr}Il.length!==0&&(Yi=Math.max(ei-Dr,Yi),jne(Il,0,Il.length-1,Hs)),ei=0,Al.lineOffset=Math.max(Pu,(sl-1)*ol);const ll=hn*sl+Pu;Bn+=ll,jo=Math.max(ll,jo),++jc}const{horizontalAlign:Qu,verticalAlign:Cl}=IC(Xn);(function(Mo,sl,Al,Il,Pu,Uc,ll,ec,Ws){const ul=(sl-Al)*Pu;let cl=0;cl=Uc!==ll?-ec*Il- -17:-Il*Ws*ll+.5*ll;for(const Ps of Mo)for(const po of Ps.positionedGlyphs)po.x+=ul,po.y+=cl})(gr.positionedLines,Hs,Qu,Cl,Yi,jo,hn,Bn,an.length),gr.top+=-Cl*Bn,gr.bottom=gr.top+Bn,gr.left+=-Qu*Yi,gr.right=gr.left+Yi})(Ft,c,d,x,st,F,V,X,ve,ae,Le,Ue),!(function(gr){for(const Cr of gr)if(Cr.positionedGlyphs.length!==0)return!1;return!0})(Rt)&&Ft}const Px={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},One={10:!0,32:!0,38:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0},Lne={40:!0};function KD(p,c,d,x,T,D){if(c.imageName){const F=x[c.imageName];return F?F.displaySize[0]*c.scale*ol/D+T:0}{const F=d[c.fontStack],V=F&&F[p];return V?V.metrics.advance*c.scale+T:0}}function JD(p,c,d,x){const T=Math.pow(p-c,2);return x?p<c?T/2:2*T:T+Math.abs(d)*d}function Nne(p,c,d){let x=0;return p===10&&(x-=1e4),d&&(x+=150),p!==40&&p!==65288||(x+=50),c!==41&&c!==65289||(x+=50),x}function QD(p,c,d,x,T,D){let F=null,V=JD(c,d,T,D);for(const X of x){const ae=JD(c-X.x,d,T,D)+X.badness;ae<=V&&(F=X,V=ae)}return{index:p,x:c,priorBreak:F,badness:V}}function e6(p){return p?e6(p.priorBreak).concat(p.index):[]}function AC(p,c,d,x,T,D){if(!p)return[];const F=[],V=(function(ve,Le,ze,Ue,Ze,st){let wt=0;for(let Wt=0;Wt<ve.length();Wt++){const Rt=ve.getSection(Wt);wt+=KD(ve.getCharCode(Wt),Rt,Ue,Ze,Le,st)}return wt/Math.max(1,Math.ceil(wt/ze))})(p,c,d,x,T,D),X=p.text.indexOf("")>=0;let ae=0;for(let ve=0;ve<p.length();ve++){const Le=p.getSection(ve),ze=p.getCharCode(ve);if(Px[ze]||(ae+=KD(ze,Le,x,T,c,D)),ve<p.length()-1){const Ue=!((se=ze)<11904)&&(!!Ut["CJK Compatibility Forms"](se)||!!Ut["CJK Compatibility"](se)||!!Ut["CJK Strokes"](se)||!!Ut["CJK Symbols and Punctuation"](se)||!!Ut["Enclosed CJK Letters and Months"](se)||!!Ut["Halfwidth and Fullwidth Forms"](se)||!!Ut["Ideographic Description Characters"](se)||!!Ut["Vertical Forms"](se)||Kr.test(String.fromCodePoint(se)));(One[ze]||Ue||Le.imageName||ve!==p.length()-2&&Lne[p.getCharCode(ve+1)])&&F.push(QD(ve+1,ae,V,F,Nne(ze,p.getCharCode(ve+1),Ue&&X),!1))}}var se;return e6(QD(p.length(),ae,V,F,0,!0))}function IC(p){let c=.5,d=.5;switch(p){case"right":case"top-right":case"bottom-right":c=1;break;case"left":case"top-left":case"bottom-left":c=0}switch(p){case"bottom":case"bottom-right":case"bottom-left":d=1;break;case"top":case"top-right":case"top-left":d=0}return{horizontalAlign:c,verticalAlign:d}}function Dne(p,c,d){const x=c.getMaxScale()*ol,{maxImageWidth:T,maxImageHeight:D}=c.getMaxImageSize(p),F=Math.max(x,D*d);return{verticalLineContentWidth:Math.max(x,T*d),horizontalLineContentHeight:F}}function t6(p){switch(p){case"top":return 0;case"center":return .5;default:return 1}}function Fne(p,c,d){return!(p===s.ao.horizontal||!c&&!Kn(d)||c&&(Px[d]||(x=d,new RegExp("\\p{sc=Arab}","u").test(String.fromCodePoint(x)))));var x}function Bne(p,c,d,x,T,D){const F=D[p.fontStack],V=(function(ae,se,ve,Le){if(ae&&ae.rect)return ae;const ze=se[ve.fontStack],Ue=ze&&ze[Le];return Ue?{rect:null,metrics:Ue.metrics}:null})(F&&F[c],T,p,c);if(V===null)return null;let X;if(d)X=x.verticalLineContentWidth-p.scale*ol;else{const ae=t6(p.verticalAlign);X=(x.horizontalLineContentHeight-p.scale*ol)*ae}return{rect:V.rect,metrics:V.metrics,baselineOffset:X}}function zne(p,c,d,x,T){const D=T[p.imageName];if(!D)return null;const F=D.paddedRect,V=D.displaySize,X={width:V[0],height:V[1],left:1,top:-3,advance:c?V[1]:V[0]};let ae;if(c)ae=x.verticalLineContentWidth-V[1]*p.scale;else{const se=t6(p.verticalAlign);ae=(x.horizontalLineContentHeight-V[1]*p.scale)*se}return{rect:F,metrics:X,baselineOffset:ae,imageOffset:(c?V[0]:V[1])*p.scale-ol*d}}function jne(p,c,d,x){if(x===0)return;const T=p[d],D=(p[d].x+T.metrics.advance*T.scale)*x;for(let F=c;F<=d;F++)p[F].x-=D}function Une(p,c,d){const{horizontalAlign:x,verticalAlign:T}=IC(d),D=c[0]-p.displaySize[0]*x,F=c[1]-p.displaySize[1]*T;return{image:p,top:F,bottom:F+p.displaySize[1],left:D,right:D+p.displaySize[0]}}function r6(p){var c,d;let x=p.left,T=p.top,D=p.right-x,F=p.bottom-T;const V=(c=p.image.textFitWidth)!==null&&c!==void 0?c:"stretchOrShrink",X=(d=p.image.textFitHeight)!==null&&d!==void 0?d:"stretchOrShrink",ae=(p.image.content[2]-p.image.content[0])/(p.image.content[3]-p.image.content[1]);if(X==="proportional"){if(V==="stretchOnly"&&D/F<ae||V==="proportional"){const se=Math.ceil(F*ae);x*=se/D,D=se}}else if(V==="proportional"&&X==="stretchOnly"&&ae!==0&&D/F>ae){const se=Math.ceil(D/ae);T*=se/F,F=se}return{x1:x,y1:T,x2:x+D,y2:T+F}}function n6(p,c,d,x,T,D){const F=p.image;let V;if(F.content){const st=F.content,wt=F.pixelRatio||1;V=[st[0]/wt,st[1]/wt,F.displaySize[0]-st[2]/wt,F.displaySize[1]-st[3]/wt]}const X=c.left*D,ae=c.right*D;let se,ve,Le,ze;d==="width"||d==="both"?(ze=T[0]+X-x[3],ve=T[0]+ae+x[1]):(ze=T[0]+(X+ae-F.displaySize[0])/2,ve=ze+F.displaySize[0]);const Ue=c.top*D,Ze=c.bottom*D;return d==="height"||d==="both"?(se=T[1]+Ue-x[0],Le=T[1]+Ze+x[2]):(se=T[1]+(Ue+Ze-F.displaySize[1])/2,Le=se+F.displaySize[1]),{image:F,top:se,right:ve,bottom:Le,left:ze,collisionPadding:V}}const _d=128,mp=32640;function i6(p,c){const{expression:d}=c;if(d.kind==="constant")return{kind:"constant",layoutSize:d.evaluate(new mn(p+1))};if(d.kind==="source")return{kind:"source"};{const{zoomStops:x,interpolationType:T}=d;let D=0;for(;D<x.length&&x[D]<=p;)D++;D=Math.max(0,D-1);let F=D;for(;F<x.length&&x[F]<p+1;)F++;F=Math.min(x.length-1,F);const V=x[D],X=x[F];return d.kind==="composite"?{kind:"composite",minZoom:V,maxZoom:X,interpolationType:T}:{kind:"camera",minZoom:V,maxZoom:X,minSize:d.evaluate(new mn(V)),maxSize:d.evaluate(new mn(X)),interpolationType:T}}}function PC(p,c,d){let x="never";const T=p.get(c);return T?x=T:p.get(d)&&(x="always"),x}const Vne=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function kx(p,c,d,x,T,D,F,V,X,ae,se,ve,Le){const ze=V?Math.min(mp,Math.round(V[0])):0,Ue=V?Math.min(mp,Math.round(V[1])):0;p.emplaceBack(c,d,Math.round(32*x),Math.round(32*T),D,F,(ze<<1)+(X?1:0),Ue,16*ae,16*se,256*ve,256*Le)}function kC(p,c,d){p.emplaceBack(c.x,c.y,d),p.emplaceBack(c.x,c.y,d),p.emplaceBack(c.x,c.y,d),p.emplaceBack(c.x,c.y,d)}function $ne(p){for(const c of p.sections)if(Qo(c.text))return!0;return!1}class MC{constructor(c){this.layoutVertexArray=new nn,this.indexArray=new da,this.programConfigurations=c,this.segments=new ci,this.dynamicLayoutVertexArray=new qr,this.opacityVertexArray=new Ln,this.hasVisibleVertices=!1,this.placedSymbolArray=new Ge}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(c,d,x,T){this.isEmpty()||(x&&(this.layoutVertexBuffer=c.createVertexBuffer(this.layoutVertexArray,mne.members),this.indexBuffer=c.createIndexBuffer(this.indexArray,d),this.dynamicLayoutVertexBuffer=c.createVertexBuffer(this.dynamicLayoutVertexArray,yne.members,!0),this.opacityVertexBuffer=c.createVertexBuffer(this.opacityVertexArray,Vne,!0),this.opacityVertexBuffer.itemSize=1),(x||T)&&this.programConfigurations.upload(c))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}}We("SymbolBuffers",MC);class RC{constructor(c,d,x){this.layoutVertexArray=new c,this.layoutAttributes=d,this.indexArray=new x,this.segments=new ci,this.collisionVertexArray=new Xi}upload(c){this.layoutVertexBuffer=c.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=c.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=c.createVertexBuffer(this.collisionVertexArray,vne.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())}}We("CollisionBuffers",RC);class my{constructor(c){this.collisionBoxArray=c.collisionBoxArray,this.zoom=c.zoom,this.globalState=c.globalState,this.overscaling=c.overscaling,this.layers=c.layers,this.layerIds=this.layers.map((F=>F.id)),this.index=c.index,this.pixelRatio=c.pixelRatio,this.sourceLayerIndex=c.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[];const d=this.layers[0]._unevaluatedLayout._values;this.textSizeData=i6(this.zoom,d["text-size"]),this.iconSizeData=i6(this.zoom,d["icon-size"]);const x=this.layers[0].layout,T=x.get("symbol-sort-key"),D=x.get("symbol-z-order");this.canOverlap=PC(x,"text-overlap","text-allow-overlap")!=="never"||PC(x,"icon-overlap","icon-allow-overlap")!=="never"||x.get("text-ignore-placement")||x.get("icon-ignore-placement"),this.sortFeaturesByKey=D!=="viewport-y"&&!T.isConstant(),this.sortFeaturesByY=(D==="viewport-y"||D==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,x.get("symbol-placement")==="point"&&(this.writingModes=x.get("text-writing-mode").map((F=>s.ao[F]))),this.stateDependentLayerIds=this.layers.filter((F=>F.isStateDependent())).map((F=>F.id)),this.sourceID=c.sourceID}createArrays(){this.text=new MC(new Ku(this.layers,this.zoom,(c=>/^text/.test(c)))),this.icon=new MC(new Ku(this.layers,this.zoom,(c=>/^icon/.test(c)))),this.glyphOffsetArray=new ct,this.lineVertexArray=new xt,this.symbolInstances=new lt,this.textAnchorOffsets=new Ct}calculateGlyphDependencies(c,d,x,T,D){for(let F=0;F<c.length;F++)if(d[c.charCodeAt(F)]=!0,(x||T)&&D){const V=s_[c.charAt(F)];V&&(d[V.charCodeAt(0)]=!0)}}populate(c,d,x){const T=this.layers[0],D=T.layout,F=D.get("text-font"),V=D.get("text-field"),X=D.get("icon-image"),ae=(V.value.kind!=="constant"||V.value.value instanceof En&&!V.value.value.isEmpty()||V.value.value.toString().length>0)&&(F.value.kind!=="constant"||F.value.value.length>0),se=X.value.kind!=="constant"||!!X.value.value||Object.keys(X.parameters).length>0,ve=D.get("symbol-sort-key");if(this.features=[],!ae&&!se)return;const Le=d.iconDependencies,ze=d.glyphDependencies,Ue=d.availableImages,Ze=new mn(this.zoom,{globalState:this.globalState});for(const{feature:st,id:wt,index:Wt,sourceLayerIndex:Rt}of c){const Ft=T._featureFilter.needGeometry,gr=Vh(st,Ft);if(!T._featureFilter.filter(Ze,gr,x))continue;let Cr,Wr;if(Ft||(gr.geometry=Mf(st)),ae){const an=T.getValueAndResolveTokens("text-field",gr,x,Ue),hn=En.factory(an),Xn=this.hasRTLText=this.hasRTLText||$ne(hn);(!Xn||yi.getRTLTextPluginStatus()==="unavailable"||Xn&&yi.isParsed())&&(Cr=bne(hn,T,gr))}if(se){const an=T.getValueAndResolveTokens("icon-image",gr,x,Ue);Wr=an instanceof Ra?an:Ra.fromString(an)}if(!Cr&&!Wr)continue;const yn=this.sortFeaturesByKey?ve.evaluate(gr,{},x):void 0;if(this.features.push({id:wt,text:Cr,icon:Wr,index:Wt,sourceLayerIndex:Rt,geometry:gr.geometry,properties:st.properties,type:dy.types[st.type],sortKey:yn}),Wr&&(Le[Wr.name]=!0),Cr){const an=F.evaluate(gr,{},x).join(","),hn=D.get("text-rotation-alignment")!=="viewport"&&D.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(s.ao.vertical)>=0;for(const Xn of Cr.sections)if(Xn.image)Le[Xn.image.name]=!0;else{const ln=Or(Cr.toString()),fn=Xn.fontStack||an,Dr=ze[fn]=ze[fn]||{};this.calculateGlyphDependencies(Xn.text,Dr,hn,this.allowVerticalPlacement,ln)}}}D.get("symbol-placement")==="line"&&(this.features=(function(st){const wt={},Wt={},Rt=[];let Ft=0;function gr(an){Rt.push(st[an]),Ft++}function Cr(an,hn,Xn){const ln=Wt[an];return delete Wt[an],Wt[hn]=ln,Rt[ln].geometry[0].pop(),Rt[ln].geometry[0]=Rt[ln].geometry[0].concat(Xn[0]),ln}function Wr(an,hn,Xn){const ln=wt[hn];return delete wt[hn],wt[an]=ln,Rt[ln].geometry[0].shift(),Rt[ln].geometry[0]=Xn[0].concat(Rt[ln].geometry[0]),ln}function yn(an,hn,Xn){const ln=Xn?hn[0][hn[0].length-1]:hn[0][0];return`${an}:${ln.x}:${ln.y}`}for(let an=0;an<st.length;an++){const hn=st[an],Xn=hn.geometry,ln=hn.text?hn.text.toString():null;if(!ln){gr(an);continue}const fn=yn(ln,Xn),Dr=yn(ln,Xn,!0);if(fn in Wt&&Dr in wt&&Wt[fn]!==wt[Dr]){const hi=Wr(fn,Dr,Xn),xi=Cr(fn,Dr,Rt[hi].geometry);delete wt[fn],delete Wt[Dr],Wt[yn(ln,Rt[xi].geometry,!0)]=xi,Rt[hi].geometry=null}else fn in Wt?Cr(fn,Dr,Xn):Dr in wt?Wr(fn,Dr,Xn):(gr(an),wt[fn]=Ft-1,Wt[Dr]=Ft-1)}return Rt.filter((an=>an.geometry))})(this.features)),this.sortFeaturesByKey&&this.features.sort(((st,wt)=>st.sortKey-wt.sortKey))}update(c,d,x){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(c,d,this.layers,{imagePositions:x,globalState:this.globalState}),this.icon.programConfigurations.updatePaintArrays(c,d,this.layers,{imagePositions:x,globalState:this.globalState}))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(c){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(c),this.iconCollisionBox.upload(c)),this.text.upload(c,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(c,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(c,d){const x=this.lineVertexArray.length;if(c.segment!==void 0){let T=c.dist(d[c.segment+1]),D=c.dist(d[c.segment]);const F={};for(let V=c.segment+1;V<d.length;V++)F[V]={x:d[V].x,y:d[V].y,tileUnitDistanceFromAnchor:T},V<d.length-1&&(T+=d[V+1].dist(d[V]));for(let V=c.segment||0;V>=0;V--)F[V]={x:d[V].x,y:d[V].y,tileUnitDistanceFromAnchor:D},V>0&&(D+=d[V-1].dist(d[V]));for(let V=0;V<d.length;V++){const X=F[V];this.lineVertexArray.emplaceBack(X.x,X.y,X.tileUnitDistanceFromAnchor)}}return{lineStartIndex:x,lineLength:this.lineVertexArray.length-x}}addSymbols(c,d,x,T,D,F,V,X,ae,se,ve,Le){const ze=c.indexArray,Ue=c.layoutVertexArray,Ze=c.segments.prepareSegment(4*d.length,Ue,ze,this.canOverlap?F.sortKey:void 0),st=this.glyphOffsetArray.length,wt=Ze.vertexLength,Wt=this.allowVerticalPlacement&&V===s.ao.vertical?Math.PI/2:0,Rt=F.text&&F.text.sections;for(let Ft=0;Ft<d.length;Ft++){const{tl:gr,tr:Cr,bl:Wr,br:yn,tex:an,pixelOffsetTL:hn,pixelOffsetBR:Xn,minFontScaleX:ln,minFontScaleY:fn,glyphOffset:Dr,isSDF:hi,sectionIndex:xi}=d[Ft],ei=Ze.vertexLength,Bn=Dr[1];kx(Ue,X.x,X.y,gr.x,Bn+gr.y,an.x,an.y,x,hi,hn.x,hn.y,ln,fn),kx(Ue,X.x,X.y,Cr.x,Bn+Cr.y,an.x+an.w,an.y,x,hi,Xn.x,hn.y,ln,fn),kx(Ue,X.x,X.y,Wr.x,Bn+Wr.y,an.x,an.y+an.h,x,hi,hn.x,Xn.y,ln,fn),kx(Ue,X.x,X.y,yn.x,Bn+yn.y,an.x+an.w,an.y+an.h,x,hi,Xn.x,Xn.y,ln,fn),kC(c.dynamicLayoutVertexArray,X,Wt),ze.emplaceBack(ei,ei+2,ei+1),ze.emplaceBack(ei+1,ei+2,ei+3),Ze.vertexLength+=4,Ze.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(Dr[0]),Ft!==d.length-1&&xi===d[Ft+1].sectionIndex||c.programConfigurations.populatePaintArrays(Ue.length,F,F.index,{imagePositions:{},canonical:Le,formattedSection:Rt&&Rt[xi],globalState:this.globalState})}c.placedSymbolArray.emplaceBack(X.x,X.y,st,this.glyphOffsetArray.length-st,wt,ae,se,X.segment,x?x[0]:0,x?x[1]:0,T[0],T[1],V,0,!1,0,ve)}_addCollisionDebugVertex(c,d,x,T,D,F){return d.emplaceBack(0,0),c.emplaceBack(x.x,x.y,T,D,Math.round(F.x),Math.round(F.y))}addCollisionDebugVertices(c,d,x,T,D,F,V){const X=D.segments.prepareSegment(4,D.layoutVertexArray,D.indexArray),ae=X.vertexLength,se=D.layoutVertexArray,ve=D.collisionVertexArray,Le=V.anchorX,ze=V.anchorY;this._addCollisionDebugVertex(se,ve,F,Le,ze,new u(c,d)),this._addCollisionDebugVertex(se,ve,F,Le,ze,new u(x,d)),this._addCollisionDebugVertex(se,ve,F,Le,ze,new u(x,T)),this._addCollisionDebugVertex(se,ve,F,Le,ze,new u(c,T)),X.vertexLength+=4;const Ue=D.indexArray;Ue.emplaceBack(ae,ae+1),Ue.emplaceBack(ae+1,ae+2),Ue.emplaceBack(ae+2,ae+3),Ue.emplaceBack(ae+3,ae),X.primitiveLength+=4}addDebugCollisionBoxes(c,d,x,T){for(let D=c;D<d;D++){const F=this.collisionBoxArray.get(D);this.addCollisionDebugVertices(F.x1,F.y1,F.x2,F.y2,T?this.textCollisionBox:this.iconCollisionBox,F.anchorPoint,x)}}generateCollisionDebugBuffers(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new RC(Pi,HD.members,oa),this.iconCollisionBox=new RC(Pi,HD.members,oa);for(let c=0;c<this.symbolInstances.length;c++){const d=this.symbolInstances.get(c);this.addDebugCollisionBoxes(d.textBoxStartIndex,d.textBoxEndIndex,d,!0),this.addDebugCollisionBoxes(d.verticalTextBoxStartIndex,d.verticalTextBoxEndIndex,d,!0),this.addDebugCollisionBoxes(d.iconBoxStartIndex,d.iconBoxEndIndex,d,!1),this.addDebugCollisionBoxes(d.verticalIconBoxStartIndex,d.verticalIconBoxEndIndex,d,!1)}}_deserializeCollisionBoxesForSymbol(c,d,x,T,D,F,V,X,ae){const se={};for(let ve=d;ve<x;ve++){const Le=c.get(ve);se.textBox={x1:Le.x1,y1:Le.y1,x2:Le.x2,y2:Le.y2,anchorPointX:Le.anchorPointX,anchorPointY:Le.anchorPointY},se.textFeatureIndex=Le.featureIndex;break}for(let ve=T;ve<D;ve++){const Le=c.get(ve);se.verticalTextBox={x1:Le.x1,y1:Le.y1,x2:Le.x2,y2:Le.y2,anchorPointX:Le.anchorPointX,anchorPointY:Le.anchorPointY},se.verticalTextFeatureIndex=Le.featureIndex;break}for(let ve=F;ve<V;ve++){const Le=c.get(ve);se.iconBox={x1:Le.x1,y1:Le.y1,x2:Le.x2,y2:Le.y2,anchorPointX:Le.anchorPointX,anchorPointY:Le.anchorPointY},se.iconFeatureIndex=Le.featureIndex;break}for(let ve=X;ve<ae;ve++){const Le=c.get(ve);se.verticalIconBox={x1:Le.x1,y1:Le.y1,x2:Le.x2,y2:Le.y2,anchorPointX:Le.anchorPointX,anchorPointY:Le.anchorPointY},se.verticalIconFeatureIndex=Le.featureIndex;break}return se}deserializeCollisionBoxes(c){this.collisionArrays=[];for(let d=0;d<this.symbolInstances.length;d++){const x=this.symbolInstances.get(d);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(c,x.textBoxStartIndex,x.textBoxEndIndex,x.verticalTextBoxStartIndex,x.verticalTextBoxEndIndex,x.iconBoxStartIndex,x.iconBoxEndIndex,x.verticalIconBoxStartIndex,x.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(c,d){const x=c.placedSymbolArray.get(d),T=x.vertexStartIndex+4*x.numGlyphs;for(let D=x.vertexStartIndex;D<T;D+=4)c.indexArray.emplaceBack(D,D+2,D+1),c.indexArray.emplaceBack(D+1,D+2,D+3)}getSortedSymbolIndexes(c){if(this.sortedAngle===c&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const d=Math.sin(c),x=Math.cos(c),T=[],D=[],F=[];for(let V=0;V<this.symbolInstances.length;++V){F.push(V);const X=this.symbolInstances.get(V);T.push(0|Math.round(d*X.anchorX+x*X.anchorY)),D.push(X.featureIndex)}return F.sort(((V,X)=>T[V]-T[X]||D[X]-D[V])),F}addToSortKeyRanges(c,d){const x=this.sortKeyRanges[this.sortKeyRanges.length-1];x&&x.sortKey===d?x.symbolInstanceEnd=c+1:this.sortKeyRanges.push({sortKey:d,symbolInstanceStart:c,symbolInstanceEnd:c+1})}sortFeatures(c){if(this.sortFeaturesByY&&this.sortedAngle!==c&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(c),this.sortedAngle=c,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const d of this.symbolInstanceIndexes){const x=this.symbolInstances.get(d);this.featureSortOrder.push(x.featureIndex),[x.rightJustifiedTextSymbolIndex,x.centerJustifiedTextSymbolIndex,x.leftJustifiedTextSymbolIndex].forEach(((T,D,F)=>{T>=0&&F.indexOf(T)===D&&this.addIndicesForPlacedSymbol(this.text,T)})),x.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,x.verticalPlacedTextSymbolIndex),x.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,x.placedIconSymbolIndex),x.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,x.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}let a6,o6;We("SymbolBucket",my,{omit:["layers","collisionBoxArray","features","compareText"]}),my.MAX_GLYPHS=65535,my.addDynamicAttributes=kC;var OC={get paint(){return o6=o6||new ra({"icon-opacity":new On(bt.paint_symbol["icon-opacity"]),"icon-color":new On(bt.paint_symbol["icon-color"]),"icon-halo-color":new On(bt.paint_symbol["icon-halo-color"]),"icon-halo-width":new On(bt.paint_symbol["icon-halo-width"]),"icon-halo-blur":new On(bt.paint_symbol["icon-halo-blur"]),"icon-translate":new xn(bt.paint_symbol["icon-translate"]),"icon-translate-anchor":new xn(bt.paint_symbol["icon-translate-anchor"]),"text-opacity":new On(bt.paint_symbol["text-opacity"]),"text-color":new On(bt.paint_symbol["text-color"],{runtimeType:Mi,getOverride:p=>p.textColor,hasOverride:p=>!!p.textColor}),"text-halo-color":new On(bt.paint_symbol["text-halo-color"]),"text-halo-width":new On(bt.paint_symbol["text-halo-width"]),"text-halo-blur":new On(bt.paint_symbol["text-halo-blur"]),"text-translate":new xn(bt.paint_symbol["text-translate"]),"text-translate-anchor":new xn(bt.paint_symbol["text-translate-anchor"])})},get layout(){return a6=a6||new ra({"symbol-placement":new xn(bt.layout_symbol["symbol-placement"]),"symbol-spacing":new xn(bt.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new xn(bt.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new On(bt.layout_symbol["symbol-sort-key"]),"symbol-z-order":new xn(bt.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new xn(bt.layout_symbol["icon-allow-overlap"]),"icon-overlap":new xn(bt.layout_symbol["icon-overlap"]),"icon-ignore-placement":new xn(bt.layout_symbol["icon-ignore-placement"]),"icon-optional":new xn(bt.layout_symbol["icon-optional"]),"icon-rotation-alignment":new xn(bt.layout_symbol["icon-rotation-alignment"]),"icon-size":new On(bt.layout_symbol["icon-size"]),"icon-text-fit":new xn(bt.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new xn(bt.layout_symbol["icon-text-fit-padding"]),"icon-image":new On(bt.layout_symbol["icon-image"]),"icon-rotate":new On(bt.layout_symbol["icon-rotate"]),"icon-padding":new On(bt.layout_symbol["icon-padding"]),"icon-keep-upright":new xn(bt.layout_symbol["icon-keep-upright"]),"icon-offset":new On(bt.layout_symbol["icon-offset"]),"icon-anchor":new On(bt.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new xn(bt.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new xn(bt.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new xn(bt.layout_symbol["text-rotation-alignment"]),"text-field":new On(bt.layout_symbol["text-field"]),"text-font":new On(bt.layout_symbol["text-font"]),"text-size":new On(bt.layout_symbol["text-size"]),"text-max-width":new On(bt.layout_symbol["text-max-width"]),"text-line-height":new xn(bt.layout_symbol["text-line-height"]),"text-letter-spacing":new On(bt.layout_symbol["text-letter-spacing"]),"text-justify":new On(bt.layout_symbol["text-justify"]),"text-radial-offset":new On(bt.layout_symbol["text-radial-offset"]),"text-variable-anchor":new xn(bt.layout_symbol["text-variable-anchor"]),"text-variable-anchor-offset":new On(bt.layout_symbol["text-variable-anchor-offset"]),"text-anchor":new On(bt.layout_symbol["text-anchor"]),"text-max-angle":new xn(bt.layout_symbol["text-max-angle"]),"text-writing-mode":new xn(bt.layout_symbol["text-writing-mode"]),"text-rotate":new On(bt.layout_symbol["text-rotate"]),"text-padding":new xn(bt.layout_symbol["text-padding"]),"text-keep-upright":new xn(bt.layout_symbol["text-keep-upright"]),"text-transform":new On(bt.layout_symbol["text-transform"]),"text-offset":new On(bt.layout_symbol["text-offset"]),"text-allow-overlap":new xn(bt.layout_symbol["text-allow-overlap"]),"text-overlap":new xn(bt.layout_symbol["text-overlap"]),"text-ignore-placement":new xn(bt.layout_symbol["text-ignore-placement"]),"text-optional":new xn(bt.layout_symbol["text-optional"])})}};class s6{constructor(c){if(c.property.overrides===void 0)throw new Error("overrides must be provided to instantiate FormatSectionOverride class");this.type=c.property.overrides?c.property.overrides.runtimeType:Oi,this.defaultValue=c}evaluate(c){if(c.formattedSection){const d=this.defaultValue.property.overrides;if(d&&d.hasOverride(c.formattedSection))return d.getOverride(c.formattedSection)}return c.feature&&c.featureState?this.defaultValue.evaluate(c.feature,c.featureState):this.defaultValue.property.specification.default}eachChild(c){this.defaultValue.isConstant()||c(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}We("FormatSectionOverride",s6,{omit:["defaultValue"]});class Mx extends Oa{constructor(c){super(c,OC)}recalculate(c,d){if(super.recalculate(c,d),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")==="map"?"map":"viewport"),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){const x=this.layout.get("text-writing-mode");if(x){const T=[];for(const D of x)T.indexOf(D)<0&&T.push(D);this.layout._values["text-writing-mode"]=T}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()}getValueAndResolveTokens(c,d,x,T){const D=this.layout.get(c).evaluate(d,{},x,T),F=this._unevaluatedLayout._values[c];return F.isDataDriven()||_f(F.value)||!D?D:(function(V,X){return X.replace(/{([^{}]+)}/g,((ae,se)=>V&&se in V?String(V[se]):""))})(d.properties,D)}createBucket(c){return new my(c)}queryRadius(){return 0}queryIntersectsFeature(){throw new Error("Should take a different path in FeatureIndex")}_setPaintOverrides(){for(const c of OC.paint.overridableProperties){if(!Mx.hasPaintOverride(this.layout,c))continue;const d=this.paint.get(c),x=new s6(d),T=new fd(x,d.property.specification);let D=null;D=d.value.kind==="constant"||d.value.kind==="source"?new Bh("source",T):new dg("composite",T,d.value.zoomStops),this.paint._values[c]=new fo(d.property,D,d.parameters)}}_handleOverridablePaintPropertyUpdate(c,d,x){return!(!this.layout||d.isDataDriven()||x.isDataDriven())&&Mx.hasPaintOverride(this.layout,c)}static hasPaintOverride(c,d){const x=c.get("text-field"),T=OC.paint.properties[d];let D=!1;const F=V=>{for(const X of V)if(T.overrides&&T.overrides.hasOverride(X))return void(D=!0)};if(x.value.kind==="constant"&&x.value.value instanceof En)F(x.value.value.sections);else if(x.value.kind==="source"||x.value.kind==="composite"){const V=ae=>{D||(ae instanceof Go&&Un(ae.value)===ma?F(ae.value.sections):ae instanceof aa?F(ae.sections):ae.eachChild(V))},X=x.value;X._styleExpression&&V(X._styleExpression.expression)}return D}}let l6;var qne={get paint(){return l6=l6||new ra({"background-color":new xn(bt.paint_background["background-color"]),"background-pattern":new zi(bt.paint_background["background-pattern"]),"background-opacity":new xn(bt.paint_background["background-opacity"])})}};class Hne extends Oa{constructor(c){super(c,qne)}}let u6;var Wne={get paint(){return u6=u6||new ra({"raster-opacity":new xn(bt.paint_raster["raster-opacity"]),"raster-hue-rotate":new xn(bt.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new xn(bt.paint_raster["raster-brightness-min"]),"raster-brightness-max":new xn(bt.paint_raster["raster-brightness-max"]),"raster-saturation":new xn(bt.paint_raster["raster-saturation"]),"raster-contrast":new xn(bt.paint_raster["raster-contrast"]),"raster-resampling":new xn(bt.paint_raster["raster-resampling"]),"raster-fade-duration":new xn(bt.paint_raster["raster-fade-duration"])})}};class Gne extends Oa{constructor(c){super(c,Wne)}}class Xne extends Oa{constructor(c){super(c,{}),this.onAdd=d=>{this.implementation.onAdd&&this.implementation.onAdd(d,d.painter.context.gl)},this.onRemove=d=>{this.implementation.onRemove&&this.implementation.onRemove(d,d.painter.context.gl)},this.implementation=c}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){throw new Error("Custom layers cannot be serialized")}}class Yne{constructor(c){this._methodToThrottle=c,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._methodToThrottle()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout((()=>{this._triggered=!1,this._methodToThrottle()}),0))}remove(){delete this._channel,this._methodToThrottle=()=>{}}}const Zne={once:!0},LC=63710088e-1;class yp{constructor(c,d){if(isNaN(c)||isNaN(d))throw new Error(`Invalid LngLat object: (${c}, ${d})`);if(this.lng=+c,this.lat=+d,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new yp($e(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(c){const d=Math.PI/180,x=this.lat*d,T=c.lat*d,D=Math.sin(x)*Math.sin(T)+Math.cos(x)*Math.cos(T)*Math.cos((c.lng-this.lng)*d);return LC*Math.acos(Math.min(D,1))}static convert(c){if(c instanceof yp)return c;if(Array.isArray(c)&&(c.length===2||c.length===3))return new yp(Number(c[0]),Number(c[1]));if(!Array.isArray(c)&&typeof c=="object"&&c!==null)return new yp(Number("lng"in c?c.lng:c.lon),Number(c.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}const c6=2*Math.PI*LC;function h6(p){return c6*Math.cos(p*Math.PI/180)}function f6(p){return(180+p)/360}function d6(p){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+p*Math.PI/360)))/360}function p6(p,c){return p/h6(c)}function NC(p){return 360/Math.PI*Math.atan(Math.exp((180-360*p)*Math.PI/180))-90}function g6(p,c){return p*h6(NC(c))}class u_{constructor(c,d,x=0){this.x=+c,this.y=+d,this.z=+x}static fromLngLat(c,d=0){const x=yp.convert(c);return new u_(f6(x.lng),d6(x.lat),p6(d,x.lat))}toLngLat(){return new yp(360*this.x-180,NC(this.y))}toAltitude(){return g6(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/c6*(c=NC(this.y),1/Math.cos(c*Math.PI/180));var c}}function m6(p,c,d){var x=2*Math.PI*6378137/256/Math.pow(2,d);return[p*x-2*Math.PI*6378137/2,c*x-2*Math.PI*6378137/2]}class DC{constructor(c,d,x){if(!(function(T,D,F){return!(T<0||T>25||F<0||F>=Math.pow(2,T)||D<0||D>=Math.pow(2,T))})(c,d,x))throw new Error(`x=${d}, y=${x}, z=${c} outside of bounds. 0<=x<${Math.pow(2,c)}, 0<=y<${Math.pow(2,c)} 0<=z<=25 `);this.z=c,this.x=d,this.y=x,this.key=yy(0,c,c,d,x)}equals(c){return this.z===c.z&&this.x===c.x&&this.y===c.y}url(c,d,x){const T=(F=this.y,V=this.z,X=m6(256*(D=this.x),256*(F=Math.pow(2,V)-F-1),V),ae=m6(256*(D+1),256*(F+1),V),X[0]+","+X[1]+","+ae[0]+","+ae[1]);var D,F,V,X,ae;const se=(function(ve,Le,ze){let Ue,Ze="";for(let st=ve;st>0;st--)Ue=1<<st-1,Ze+=(Le&Ue?1:0)+(ze&Ue?2:0);return Ze})(this.z,this.x,this.y);return c[(this.x+this.y)%c.length].replace(/{prefix}/g,(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(x==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace(/{ratio}/g,d>1?"@2x":"").replace(/{quadkey}/g,se).replace(/{bbox-epsg-3857}/g,T)}isChildOf(c){const d=this.z-c.z;return d>0&&c.x===this.x>>d&&c.y===this.y>>d}getTilePoint(c){const d=Math.pow(2,this.z);return new u((c.x*d-this.x)*we,(c.y*d-this.y)*we)}toString(){return`${this.z}/${this.x}/${this.y}`}}class y6{constructor(c,d){this.wrap=c,this.canonical=d,this.key=yy(c,d.z,d.z,d.x,d.y)}}class zc{constructor(c,d,x,T,D){if(this.terrainRttPosMatrix32f=null,c<x)throw new Error(`overscaledZ should be >= z; overscaledZ = ${c}; z = ${x}`);this.overscaledZ=c,this.wrap=d,this.canonical=new DC(x,+T,+D),this.key=yy(d,c,x,T,D)}clone(){return new zc(this.overscaledZ,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)}equals(c){return this.overscaledZ===c.overscaledZ&&this.wrap===c.wrap&&this.canonical.equals(c.canonical)}scaledTo(c){if(c>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${c}; overscaledZ = ${this.overscaledZ}`);const d=this.canonical.z-c;return c>this.canonical.z?new zc(c,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new zc(c,this.wrap,c,this.canonical.x>>d,this.canonical.y>>d)}calculateScaledKey(c,d){if(c>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${c}; overscaledZ = ${this.overscaledZ}`);const x=this.canonical.z-c;return c>this.canonical.z?yy(this.wrap*+d,c,this.canonical.z,this.canonical.x,this.canonical.y):yy(this.wrap*+d,c,c,this.canonical.x>>x,this.canonical.y>>x)}isChildOf(c){if(c.wrap!==this.wrap)return!1;const d=this.canonical.z-c.canonical.z;return c.overscaledZ===0||c.overscaledZ<this.overscaledZ&&c.canonical.x===this.canonical.x>>d&&c.canonical.y===this.canonical.y>>d}children(c){if(this.overscaledZ>=c)return[new zc(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const d=this.canonical.z+1,x=2*this.canonical.x,T=2*this.canonical.y;return[new zc(d,this.wrap,d,x,T),new zc(d,this.wrap,d,x+1,T),new zc(d,this.wrap,d,x,T+1),new zc(d,this.wrap,d,x+1,T+1)]}isLessThan(c){return this.wrap<c.wrap||!(this.wrap>c.wrap)&&(this.overscaledZ<c.overscaledZ||!(this.overscaledZ>c.overscaledZ)&&(this.canonical.x<c.canonical.x||!(this.canonical.x>c.canonical.x)&&this.canonical.y<c.canonical.y))}wrapped(){return new zc(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(c){return new zc(this.overscaledZ,c,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new y6(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}getTilePoint(c){return this.canonical.getTilePoint(new u_(c.x-this.wrap,c.y))}}function yy(p,c,d,x,T){(p*=2)<0&&(p=-1*p-1);const D=1<<d;return(D*D*p+D*T+x).toString(36)+d.toString(36)+c.toString(36)}function c_(p,c){return c?p.properties[c]:p.id}We("CanonicalTileID",DC),We("OverscaledTileID",zc,{omit:["terrainRttPosMatrix32f"]});class Cg{constructor(){this.minX=1/0,this.maxX=-1/0,this.minY=1/0,this.maxY=-1/0}extend(c){return this.minX=Math.min(this.minX,c.x),this.minY=Math.min(this.minY,c.y),this.maxX=Math.max(this.maxX,c.x),this.maxY=Math.max(this.maxY,c.y),this}expandBy(c){return this.minX-=c,this.minY-=c,this.maxX+=c,this.maxY+=c,(this.minX>this.maxX||this.minY>this.maxY)&&(this.minX=1/0,this.maxX=-1/0,this.minY=1/0,this.maxY=-1/0),this}shrinkBy(c){return this.expandBy(-c)}map(c){const d=new Cg;return d.extend(c(new u(this.minX,this.minY))),d.extend(c(new u(this.maxX,this.minY))),d.extend(c(new u(this.minX,this.maxY))),d.extend(c(new u(this.maxX,this.maxY))),d}static fromPoints(c){const d=new Cg;for(const x of c)d.extend(x);return d}contains(c){return c.x>=this.minX&&c.x<=this.maxX&&c.y>=this.minY&&c.y<=this.maxY}empty(){return this.minX>this.maxX}width(){return this.maxX-this.minX}height(){return this.maxY-this.minY}covers(c){return!this.empty()&&!c.empty()&&c.minX>=this.minX&&c.maxX<=this.maxX&&c.minY>=this.minY&&c.maxY<=this.maxY}intersects(c){return!this.empty()&&!c.empty()&&c.minX<=this.maxX&&c.maxX>=this.minX&&c.minY<=this.maxY&&c.maxY>=this.minY}}class v6{constructor(c){this._stringToNumber={},this._numberToString=[];for(let d=0;d<c.length;d++){const x=c[d];this._stringToNumber[x]=d,this._numberToString[d]=x}}encode(c){return this._stringToNumber[c]}decode(c){if(c>=this._numberToString.length)throw new Error(`Out of bounds. Index requested n=${c} can't be >= this._numberToString.length ${this._numberToString.length}`);return this._numberToString[c]}}class _6{constructor(c,d,x,T,D){this.type="Feature",this._vectorTileFeature=c,c._z=d,c._x=x,c._y=T,this.properties=c.properties,this.id=D}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry}set geometry(c){this._geometry=c}toJSON(){const c={geometry:this.geometry};for(const d in this)d!=="_geometry"&&d!=="_vectorTileFeature"&&(c[d]=this[d]);return c}}class b6{constructor(c,d){this.tileID=c,this.x=c.canonical.x,this.y=c.canonical.y,this.z=c.canonical.z,this.grid=new Je(we,16,0),this.grid3D=new Je(we,16,0),this.featureIndexArray=new Bt,this.promoteId=d}insert(c,d,x,T,D,F){const V=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(x,T,D);const X=F?this.grid3D:this.grid;for(let ae=0;ae<d.length;ae++){const se=d[ae],ve=[1/0,1/0,-1/0,-1/0];for(let Le=0;Le<se.length;Le++){const ze=se[Le];ve[0]=Math.min(ve[0],ze.x),ve[1]=Math.min(ve[1],ze.y),ve[2]=Math.max(ve[2],ze.x),ve[3]=Math.max(ve[3],ze.y)}ve[0]<we&&ve[1]<we&&ve[2]>=0&&ve[3]>=0&&X.insert(V,ve[0],ve[1],ve[2],ve[3])}}loadVTLayers(){return this.vtLayers||(this.vtLayers=new DD(new TC(this.rawTileData)).layers,this.sourceLayerCoder=new v6(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers}query(c,d,x,T){this.loadVTLayers();const D=c.params,F=we/c.tileSize/c.scale,V=zh(D.filter),X=c.queryGeometry,ae=c.queryPadding*F,se=Cg.fromPoints(X),ve=this.grid.query(se.minX-ae,se.minY-ae,se.maxX+ae,se.maxY+ae),Le=Cg.fromPoints(c.cameraQueryGeometry).expandBy(ae),ze=this.grid3D.query(Le.minX,Le.minY,Le.maxX,Le.maxY,((st,wt,Wt,Rt)=>(function(Ft,gr,Cr,Wr,yn){for(const hn of Ft)if(gr<=hn.x&&Cr<=hn.y&&Wr>=hn.x&&yn>=hn.y)return!0;const an=[new u(gr,Cr),new u(gr,yn),new u(Wr,yn),new u(Wr,Cr)];if(Ft.length>2){for(const hn of an)if(uy(Ft,hn))return!0}for(let hn=0;hn<Ft.length-1;hn++)if(Ire(Ft[hn],Ft[hn+1],an))return!0;return!1})(c.cameraQueryGeometry,st-ae,wt-ae,Wt+ae,Rt+ae)));for(const st of ze)ve.push(st);ve.sort(Kne);const Ue={};let Ze;for(let st=0;st<ve.length;st++){const wt=ve[st];if(wt===Ze)continue;Ze=wt;const Wt=this.featureIndexArray.get(wt);let Rt=null;this.loadMatchingFeature(Ue,Wt.bucketIndex,Wt.sourceLayerIndex,Wt.featureIndex,V,D.layers,D.availableImages,d,x,T,((Ft,gr,Cr)=>(Rt||(Rt=Mf(Ft)),gr.queryIntersectsFeature({queryGeometry:X,feature:Ft,featureState:Cr,geometry:Rt,zoom:this.z,transform:c.transform,pixelsToTileUnits:F,pixelPosMatrix:c.pixelPosMatrix,unwrappedTileID:this.tileID.toUnwrapped(),getElevation:c.getElevation}))))}return Ue}loadMatchingFeature(c,d,x,T,D,F,V,X,ae,se,ve){const Le=this.bucketLayerIDs[d];if(F&&!Le.some((st=>F.has(st))))return;const ze=this.sourceLayerCoder.decode(x),Ue=this.vtLayers[ze].feature(T);if(D.needGeometry){const st=Vh(Ue,!0);if(!D.filter(new mn(this.tileID.overscaledZ),st,this.tileID.canonical))return}else if(!D.filter(new mn(this.tileID.overscaledZ),Ue))return;const Ze=this.getId(Ue,ze);for(let st=0;st<Le.length;st++){const wt=Le[st];if(F&&!F.has(wt))continue;const Wt=X[wt];if(!Wt)continue;let Rt={};Ze&&se&&(Rt=se.getState(Wt.sourceLayer||"_geojsonTileLayer",Ze));const Ft=De({},ae[wt]);Ft.paint=x6(Ft.paint,Wt.paint,Ue,Rt,V),Ft.layout=x6(Ft.layout,Wt.layout,Ue,Rt,V);const gr=!ve||ve(Ue,Wt,Rt);if(!gr)continue;const Cr=new _6(Ue,this.z,this.x,this.y,Ze);Cr.layer=Ft;let Wr=c[wt];Wr===void 0&&(Wr=c[wt]=[]),Wr.push({featureIndex:T,feature:Cr,intersectionZ:gr})}}lookupSymbolFeatures(c,d,x,T,D,F,V,X){const ae={};this.loadVTLayers();const se=zh(D);for(const ve of c)this.loadMatchingFeature(ae,x,T,ve,se,F,V,X,d);return ae}hasLayer(c){for(const d of this.bucketLayerIDs)for(const x of d)if(c===x)return!0;return!1}getId(c,d){var x;let T=c.id;return this.promoteId&&(T=c.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[d]],typeof T=="boolean"&&(T=Number(T)),T===void 0&&(!((x=c.properties)===null||x===void 0)&&x.cluster)&&this.promoteId&&(T=Number(c.properties.cluster_id))),T}}function x6(p,c,d,x,T){return Ye(p,((D,F)=>{const V=c instanceof to?c.get(F):null;return V&&V.evaluate?V.evaluate(d,x,T):V}))}function Kne(p,c){return c-p}function w6(p,c,d,x,T){const D=[];for(let F=0;F<p.length;F++){const V=p[F];let X;for(let ae=0;ae<V.length-1;ae++){let se=V[ae],ve=V[ae+1];se.x<c&&ve.x<c||(se.x<c?se=new u(c,se.y+(c-se.x)/(ve.x-se.x)*(ve.y-se.y))._round():ve.x<c&&(ve=new u(c,se.y+(c-se.x)/(ve.x-se.x)*(ve.y-se.y))._round()),se.y<d&&ve.y<d||(se.y<d?se=new u(se.x+(d-se.y)/(ve.y-se.y)*(ve.x-se.x),d)._round():ve.y<d&&(ve=new u(se.x+(d-se.y)/(ve.y-se.y)*(ve.x-se.x),d)._round()),se.x>=x&&ve.x>=x||(se.x>=x?se=new u(x,se.y+(x-se.x)/(ve.x-se.x)*(ve.y-se.y))._round():ve.x>=x&&(ve=new u(x,se.y+(x-se.x)/(ve.x-se.x)*(ve.y-se.y))._round()),se.y>=T&&ve.y>=T||(se.y>=T?se=new u(se.x+(T-se.y)/(ve.y-se.y)*(ve.x-se.x),T)._round():ve.y>=T&&(ve=new u(se.x+(T-se.y)/(ve.y-se.y)*(ve.x-se.x),T)._round()),X&&se.equals(X[X.length-1])||(X=[se],D.push(X)),X.push(ve)))))}}return D}We("FeatureIndex",b6,{omit:["rawTileData","sourceLayerCoder"]});class vp extends u{constructor(c,d,x,T){super(c,d),this.angle=x,T!==void 0&&(this.segment=T)}clone(){return new vp(this.x,this.y,this.angle,this.segment)}}function S6(p,c,d,x,T){if(c.segment===void 0||d===0)return!0;let D=c,F=c.segment+1,V=0;for(;V>-d/2;){if(F--,F<0)return!1;V-=p[F].dist(D),D=p[F]}V+=p[F].dist(p[F+1]),F++;const X=[];let ae=0;for(;V<d/2;){const se=p[F],ve=p[F+1];if(!ve)return!1;let Le=p[F-1].angleTo(se)-se.angleTo(ve);for(Le=Math.abs((Le+3*Math.PI)%(2*Math.PI)-Math.PI),X.push({distance:V,angleDelta:Le}),ae+=Le;V-X[0].distance>x;)ae-=X.shift().angleDelta;if(ae>T)return!1;F++,V+=se.dist(ve)}return!0}function E6(p){let c=0;for(let d=0;d<p.length-1;d++)c+=p[d].dist(p[d+1]);return c}function T6(p,c,d){return p?.6*c*d:0}function C6(p,c){return Math.max(p?p.right-p.left:0,c?c.right-c.left:0)}function Jne(p,c,d,x,T,D){const F=T6(d,T,D),V=C6(d,x)*D;let X=0;const ae=E6(p)/2;for(let se=0;se<p.length-1;se++){const ve=p[se],Le=p[se+1],ze=ve.dist(Le);if(X+ze>ae){const Ue=(ae-X)/ze,Ze=oi.number(ve.x,Le.x,Ue),st=oi.number(ve.y,Le.y,Ue),wt=new vp(Ze,st,Le.angleTo(ve),se);return wt._round(),!F||S6(p,wt,V,F,c)?wt:void 0}X+=ze}}function Qne(p,c,d,x,T,D,F,V,X){const ae=T6(x,D,F),se=C6(x,T),ve=se*F,Le=p[0].x===0||p[0].x===X||p[0].y===0||p[0].y===X;return c-ve<c/4&&(c=ve+c/4),A6(p,Le?c/2*V%c:(se/2+2*D)*F*V%c,c,ae,d,ve,Le,!1,X)}function A6(p,c,d,x,T,D,F,V,X){const ae=D/2,se=E6(p);let ve=0,Le=c-d,ze=[];for(let Ue=0;Ue<p.length-1;Ue++){const Ze=p[Ue],st=p[Ue+1],wt=Ze.dist(st),Wt=st.angleTo(Ze);for(;Le+d<ve+wt;){Le+=d;const Rt=(Le-ve)/wt,Ft=oi.number(Ze.x,st.x,Rt),gr=oi.number(Ze.y,st.y,Rt);if(Ft>=0&&Ft<X&&gr>=0&&gr<X&&Le-ae>=0&&Le+ae<=se){const Cr=new vp(Ft,gr,Wt,Ue);Cr._round(),x&&!S6(p,Cr,D,x,T)||ze.push(Cr)}}ve+=wt}return V||ze.length||F||(ze=A6(p,ve/2,d,x,T,D,F,!0,X)),ze}function I6(p,c,d,x){const T=[],D=p.image,F=D.pixelRatio,V=D.paddedRect.w-2,X=D.paddedRect.h-2;let ae={x1:p.left,y1:p.top,x2:p.right,y2:p.bottom};const se=D.stretchX||[[0,V]],ve=D.stretchY||[[0,X]],Le=(Dr,hi)=>Dr+hi[1]-hi[0],ze=se.reduce(Le,0),Ue=ve.reduce(Le,0),Ze=V-ze,st=X-Ue;let wt=0,Wt=ze,Rt=0,Ft=Ue,gr=0,Cr=Ze,Wr=0,yn=st;if(D.content&&x){const Dr=D.content,hi=Dr[2]-Dr[0],xi=Dr[3]-Dr[1];(D.textFitWidth||D.textFitHeight)&&(ae=r6(p)),wt=Rx(se,0,Dr[0]),Rt=Rx(ve,0,Dr[1]),Wt=Rx(se,Dr[0],Dr[2]),Ft=Rx(ve,Dr[1],Dr[3]),gr=Dr[0]-wt,Wr=Dr[1]-Rt,Cr=hi-Wt,yn=xi-Ft}const an=ae.x1,hn=ae.y1,Xn=ae.x2-an,ln=ae.y2-hn,fn=(Dr,hi,xi,ei)=>{const Bn=Ox(Dr.stretch-wt,Wt,Xn,an),Yi=Lx(Dr.fixed-gr,Cr,Dr.stretch,ze),jo=Ox(hi.stretch-Rt,Ft,ln,hn),Hs=Lx(hi.fixed-Wr,yn,hi.stretch,Ue),Gl=Ox(xi.stretch-wt,Wt,Xn,an),jc=Lx(xi.fixed-gr,Cr,xi.stretch,ze),Qu=Ox(ei.stretch-Rt,Ft,ln,hn),Cl=Lx(ei.fixed-Wr,yn,ei.stretch,Ue),Mo=new u(Bn,jo),sl=new u(Gl,jo),Al=new u(Gl,Qu),Il=new u(Bn,Qu),Pu=new u(Yi/F,Hs/F),Uc=new u(jc/F,Cl/F),ll=c*Math.PI/180;if(ll){const ul=Math.sin(ll),cl=Math.cos(ll),Ps=[cl,-ul,ul,cl];Mo._matMult(Ps),sl._matMult(Ps),Il._matMult(Ps),Al._matMult(Ps)}const ec=Dr.stretch+Dr.fixed,Ws=hi.stretch+hi.fixed;return{tl:Mo,tr:sl,bl:Il,br:Al,tex:{x:D.paddedRect.x+1+ec,y:D.paddedRect.y+1+Ws,w:xi.stretch+xi.fixed-ec,h:ei.stretch+ei.fixed-Ws},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:Pu,pixelOffsetBR:Uc,minFontScaleX:Cr/F/Xn,minFontScaleY:yn/F/ln,isSDF:d}};if(x&&(D.stretchX||D.stretchY)){const Dr=P6(se,Ze,ze),hi=P6(ve,st,Ue);for(let xi=0;xi<Dr.length-1;xi++){const ei=Dr[xi],Bn=Dr[xi+1];for(let Yi=0;Yi<hi.length-1;Yi++)T.push(fn(ei,hi[Yi],Bn,hi[Yi+1]))}}else T.push(fn({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:V+1},{fixed:0,stretch:X+1}));return T}function Rx(p,c,d){let x=0;for(const T of p)x+=Math.max(c,Math.min(d,T[1]))-Math.max(c,Math.min(d,T[0]));return x}function P6(p,c,d){const x=[{fixed:-1,stretch:0}];for(const[T,D]of p){const F=x[x.length-1];x.push({fixed:T-F.stretch,stretch:F.stretch}),x.push({fixed:T-F.stretch,stretch:F.stretch+(D-T)})}return x.push({fixed:c+1,stretch:d}),x}function Ox(p,c,d,x){return p/c*d+x}function Lx(p,c,d,x){return p-c*d/x}We("Anchor",vp);class Nx{constructor(c,d,x,T,D,F,V,X,ae,se){var ve;if(this.boxStartIndex=c.length,ae){let Le=F.top,ze=F.bottom;const Ue=F.collisionPadding;Ue&&(Le-=Ue[1],ze+=Ue[3]);let Ze=ze-Le;Ze>0&&(Ze=Math.max(10,Ze),this.circleDiameter=Ze)}else{const Le=!((ve=F.image)===null||ve===void 0)&&ve.content&&(F.image.textFitWidth||F.image.textFitHeight)?r6(F):{x1:F.left,y1:F.top,x2:F.right,y2:F.bottom};Le.y1=Le.y1*V-X[0],Le.y2=Le.y2*V+X[2],Le.x1=Le.x1*V-X[3],Le.x2=Le.x2*V+X[1];const ze=F.collisionPadding;if(ze&&(Le.x1-=ze[0]*V,Le.y1-=ze[1]*V,Le.x2+=ze[2]*V,Le.y2+=ze[3]*V),se){const Ue=new u(Le.x1,Le.y1),Ze=new u(Le.x2,Le.y1),st=new u(Le.x1,Le.y2),wt=new u(Le.x2,Le.y2),Wt=se*Math.PI/180;Ue._rotate(Wt),Ze._rotate(Wt),st._rotate(Wt),wt._rotate(Wt),Le.x1=Math.min(Ue.x,Ze.x,st.x,wt.x),Le.x2=Math.max(Ue.x,Ze.x,st.x,wt.x),Le.y1=Math.min(Ue.y,Ze.y,st.y,wt.y),Le.y2=Math.max(Ue.y,Ze.y,st.y,wt.y)}c.emplaceBack(d.x,d.y,Le.x1,Le.y1,Le.x2,Le.y2,x,T,D)}this.boxEndIndex=c.length}}class eie{constructor(c=[],d=(x,T)=>x<T?-1:x>T?1:0){if(this.data=c,this.length=this.data.length,this.compare=d,this.length>0)for(let x=(this.length>>1)-1;x>=0;x--)this._down(x)}push(c){this.data.push(c),this._up(this.length++)}pop(){if(this.length===0)return;const c=this.data[0],d=this.data.pop();return--this.length>0&&(this.data[0]=d,this._down(0)),c}peek(){return this.data[0]}_up(c){const{data:d,compare:x}=this,T=d[c];for(;c>0;){const D=c-1>>1,F=d[D];if(x(T,F)>=0)break;d[c]=F,c=D}d[c]=T}_down(c){const{data:d,compare:x}=this,T=this.length>>1,D=d[c];for(;c<T;){let F=1+(c<<1);const V=F+1;if(V<this.length&&x(d[V],d[F])<0&&(F=V),x(d[F],D)>=0)break;d[c]=d[F],c=F}d[c]=D}}function tie(p,c=1,d=!1){const x=Cg.fromPoints(p[0]),T=Math.min(x.width(),x.height());let D=T/2;const F=new eie([],rie),{minX:V,minY:X,maxX:ae,maxY:se}=x;if(T===0)return new u(V,X);for(let ze=V;ze<ae;ze+=T)for(let Ue=X;Ue<se;Ue+=T)F.push(new vy(ze+D,Ue+D,D,p));let ve=(function(ze){let Ue=0,Ze=0,st=0;const wt=ze[0];for(let Wt=0,Rt=wt.length,Ft=Rt-1;Wt<Rt;Ft=Wt++){const gr=wt[Wt],Cr=wt[Ft],Wr=gr.x*Cr.y-Cr.x*gr.y;Ze+=(gr.x+Cr.x)*Wr,st+=(gr.y+Cr.y)*Wr,Ue+=3*Wr}return new vy(Ze/Ue,st/Ue,0,ze)})(p),Le=F.length;for(;F.length;){const ze=F.pop();(ze.d>ve.d||!ve.d)&&(ve=ze,d&&console.log("found best %d after %d probes",Math.round(1e4*ze.d)/1e4,Le)),ze.max-ve.d<=c||(D=ze.h/2,F.push(new vy(ze.p.x-D,ze.p.y-D,D,p)),F.push(new vy(ze.p.x+D,ze.p.y-D,D,p)),F.push(new vy(ze.p.x-D,ze.p.y+D,D,p)),F.push(new vy(ze.p.x+D,ze.p.y+D,D,p)),Le+=4)}return d&&(console.log(`num probes: ${Le}`),console.log(`best distance: ${ve.d}`)),ve.p}function rie(p,c){return c.max-p.max}function vy(p,c,d,x){this.p=new u(p,c),this.h=d,this.d=(function(T,D){let F=!1,V=1/0;for(let X=0;X<D.length;X++){const ae=D[X];for(let se=0,ve=ae.length,Le=ve-1;se<ve;Le=se++){const ze=ae[se],Ue=ae[Le];ze.y>T.y!=Ue.y>T.y&&T.x<(Ue.x-ze.x)*(T.y-ze.y)/(Ue.y-ze.y)+ze.x&&(F=!F),V=Math.min(V,dD(T,ze,Ue))}}return(F?1:-1)*Math.sqrt(V)})(this.p,x),this.max=this.d+this.h*Math.SQRT2}var Wl;s.aE=void 0,(Wl=s.aE||(s.aE={}))[Wl.center=1]="center",Wl[Wl.left=2]="left",Wl[Wl.right=3]="right",Wl[Wl.top=4]="top",Wl[Wl.bottom=5]="bottom",Wl[Wl["top-left"]=6]="top-left",Wl[Wl["top-right"]=7]="top-right",Wl[Wl["bottom-left"]=8]="bottom-left",Wl[Wl["bottom-right"]=9]="bottom-right";const FC=Number.POSITIVE_INFINITY;function k6(p,c){return c[1]!==FC?(function(d,x,T){let D=0,F=0;switch(x=Math.abs(x),T=Math.abs(T),d){case"top-right":case"top-left":case"top":F=T-7;break;case"bottom-right":case"bottom-left":case"bottom":F=7-T}switch(d){case"top-right":case"bottom-right":case"right":D=-x;break;case"top-left":case"bottom-left":case"left":D=x}return[D,F]})(p,c[0],c[1]):(function(d,x){let T=0,D=0;x<0&&(x=0);const F=x/Math.SQRT2;switch(d){case"top-right":case"top-left":D=F-7;break;case"bottom-right":case"bottom-left":D=7-F;break;case"bottom":D=7-x;break;case"top":D=x-7}switch(d){case"top-right":case"bottom-right":T=-F;break;case"top-left":case"bottom-left":T=F;break;case"left":T=x;break;case"right":T=-x}return[T,D]})(p,c[0])}function M6(p,c,d){var x;const T=p.layout,D=(x=T.get("text-variable-anchor-offset"))===null||x===void 0?void 0:x.evaluate(c,{},d);if(D){const V=D.values,X=[];for(let ae=0;ae<V.length;ae+=2){const se=X[ae]=V[ae],ve=V[ae+1].map((Le=>Le*ol));se.startsWith("top")?ve[1]-=7:se.startsWith("bottom")&&(ve[1]+=7),X[ae+1]=ve}return new Ci(X)}const F=T.get("text-variable-anchor");if(F){let V;V=p._unevaluatedLayout.getValue("text-radial-offset")!==void 0?[T.get("text-radial-offset").evaluate(c,{},d)*ol,FC]:T.get("text-offset").evaluate(c,{},d).map((ae=>ae*ol));const X=[];for(const ae of F)X.push(ae,k6(ae,V));return new Ci(X)}return null}function BC(p){switch(p){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function nie(p,c,d,x,T,D,F,V,X,ae,se,ve){let Le=D.textMaxSize.evaluate(c,{});Le===void 0&&(Le=F);const ze=p.layers[0].layout,Ue=ze.get("icon-offset").evaluate(c,{},se),Ze=O6(d.horizontal),st=F/24,wt=p.tilePixelRatio*st,Wt=p.tilePixelRatio*Le/24,Rt=p.tilePixelRatio*V,Ft=p.tilePixelRatio*ze.get("symbol-spacing"),gr=ze.get("text-padding")*p.tilePixelRatio,Cr=(function(xi,ei,Bn,Yi=1){const jo=xi.get("icon-padding").evaluate(ei,{},Bn),Hs=jo&&jo.values;return[Hs[0]*Yi,Hs[1]*Yi,Hs[2]*Yi,Hs[3]*Yi]})(ze,c,se,p.tilePixelRatio),Wr=ze.get("text-max-angle")/180*Math.PI,yn=ze.get("text-rotation-alignment")!=="viewport"&&ze.get("symbol-placement")!=="point",an=ze.get("icon-rotation-alignment")==="map"&&ze.get("symbol-placement")!=="point",hn=ze.get("symbol-placement"),Xn=Ft/2,ln=ze.get("icon-text-fit");let fn;x&&ln!=="none"&&(p.allowVerticalPlacement&&d.vertical&&(fn=n6(x,d.vertical,ln,ze.get("icon-text-fit-padding"),Ue,st)),Ze&&(x=n6(x,Ze,ln,ze.get("icon-text-fit-padding"),Ue,st)));const Dr=se?ve.line.getGranularityForZoomLevel(se.z):1,hi=(xi,ei)=>{ei.x<0||ei.x>=we||ei.y<0||ei.y>=we||(function(Bn,Yi,jo,Hs,Gl,jc,Qu,Cl,Mo,sl,Al,Il,Pu,Uc,ll,ec,Ws,ul,cl,Ps,po,$h,_y,qh,oie){const by=Bn.addToLineVertexArray(Yi,jo);let Ag,xy,wy,Sy,F6=0,B6=0,z6=0,j6=0,WC=-1,GC=-1;const bd={};let U6=dp("");if(Bn.allowVerticalPlacement&&Hs.vertical){const cu=Cl.layout.get("text-rotate").evaluate(po,{},qh)+90;wy=new Nx(Mo,Yi,sl,Al,Il,Hs.vertical,Pu,Uc,ll,cu),Qu&&(Sy=new Nx(Mo,Yi,sl,Al,Il,Qu,Ws,ul,ll,cu))}if(Gl){const cu=Cl.layout.get("icon-rotate").evaluate(po,{}),Vc=Cl.layout.get("icon-text-fit")!=="none",Ig=I6(Gl,cu,_y,Vc),Wh=Qu?I6(Qu,cu,_y,Vc):void 0;xy=new Nx(Mo,Yi,sl,Al,Il,Gl,Ws,ul,!1,cu),F6=4*Ig.length;const Pg=Bn.iconSizeData;let Rf=null;Pg.kind==="source"?(Rf=[_d*Cl.layout.get("icon-size").evaluate(po,{})],Rf[0]>mp&&at(`${Bn.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)):Pg.kind==="composite"&&(Rf=[_d*$h.compositeIconSizes[0].evaluate(po,{},qh),_d*$h.compositeIconSizes[1].evaluate(po,{},qh)],(Rf[0]>mp||Rf[1]>mp)&&at(`${Bn.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)),Bn.addSymbols(Bn.icon,Ig,Rf,Ps,cl,po,s.ao.none,Yi,by.lineStartIndex,by.lineLength,-1,qh),WC=Bn.icon.placedSymbolArray.length-1,Wh&&(B6=4*Wh.length,Bn.addSymbols(Bn.icon,Wh,Rf,Ps,cl,po,s.ao.vertical,Yi,by.lineStartIndex,by.lineLength,-1,qh),GC=Bn.icon.placedSymbolArray.length-1)}const V6=Object.keys(Hs.horizontal);for(const cu of V6){const Vc=Hs.horizontal[cu];if(!Ag){U6=dp(Vc.text);const Wh=Cl.layout.get("text-rotate").evaluate(po,{},qh);Ag=new Nx(Mo,Yi,sl,Al,Il,Vc,Pu,Uc,ll,Wh)}const Ig=Vc.positionedLines.length===1;if(z6+=R6(Bn,Yi,Vc,jc,Cl,ll,po,ec,by,Hs.vertical?s.ao.horizontal:s.ao.horizontalOnly,Ig?V6:[cu],bd,WC,$h,qh),Ig)break}Hs.vertical&&(j6+=R6(Bn,Yi,Hs.vertical,jc,Cl,ll,po,ec,by,s.ao.vertical,["vertical"],bd,GC,$h,qh));const sie=Ag?Ag.boxStartIndex:Bn.collisionBoxArray.length,lie=Ag?Ag.boxEndIndex:Bn.collisionBoxArray.length,uie=wy?wy.boxStartIndex:Bn.collisionBoxArray.length,cie=wy?wy.boxEndIndex:Bn.collisionBoxArray.length,hie=xy?xy.boxStartIndex:Bn.collisionBoxArray.length,fie=xy?xy.boxEndIndex:Bn.collisionBoxArray.length,die=Sy?Sy.boxStartIndex:Bn.collisionBoxArray.length,pie=Sy?Sy.boxEndIndex:Bn.collisionBoxArray.length;let Hh=-1;const Fx=(cu,Vc)=>cu&&cu.circleDiameter?Math.max(cu.circleDiameter,Vc):Vc;Hh=Fx(Ag,Hh),Hh=Fx(wy,Hh),Hh=Fx(xy,Hh),Hh=Fx(Sy,Hh);const $6=Hh>-1?1:0;$6&&(Hh*=oie/ol),Bn.glyphOffsetArray.length>=my.MAX_GLYPHS&&at("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),po.sortKey!==void 0&&Bn.addToSortKeyRanges(Bn.symbolInstances.length,po.sortKey);const gie=M6(Cl,po,qh),[mie,yie]=(function(cu,Vc){const Ig=cu.length,Wh=Vc?.values;if(Wh?.length>0)for(let Pg=0;Pg<Wh.length;Pg+=2){const Rf=Wh[Pg+1];cu.emplaceBack(s.aE[Wh[Pg]],Rf[0],Rf[1])}return[Ig,cu.length]})(Bn.textAnchorOffsets,gie);Bn.symbolInstances.emplaceBack(Yi.x,Yi.y,bd.right>=0?bd.right:-1,bd.center>=0?bd.center:-1,bd.left>=0?bd.left:-1,bd.vertical||-1,WC,GC,U6,sie,lie,uie,cie,hie,fie,die,pie,sl,z6,j6,F6,B6,$6,0,Pu,Hh,mie,yie)})(p,ei,xi,d,x,T,fn,p.layers[0],p.collisionBoxArray,c.index,c.sourceLayerIndex,p.index,wt,[gr,gr,gr,gr],yn,X,Rt,Cr,an,Ue,c,D,ae,se,F)};if(hn==="line")for(const xi of w6(c.geometry,0,0,we,we)){const ei=Tg(xi,Dr),Bn=Qne(ei,Ft,Wr,d.vertical||Ze,x,24,Wt,p.overscaling,we);for(const Yi of Bn)Ze&&iie(p,Ze.text,Xn,Yi)||hi(ei,Yi)}else if(hn==="line-center"){for(const xi of c.geometry)if(xi.length>1){const ei=Tg(xi,Dr),Bn=Jne(ei,Wr,d.vertical||Ze,x,24,Wt);Bn&&hi(ei,Bn)}}else if(c.type==="Polygon")for(const xi of ya(c.geometry,0)){const ei=tie(xi,16);hi(Tg(xi[0],Dr,!0),new vp(ei.x,ei.y,0))}else if(c.type==="LineString")for(const xi of c.geometry){const ei=Tg(xi,Dr);hi(ei,new vp(ei[0].x,ei[0].y,0))}else if(c.type==="Point")for(const xi of c.geometry)for(const ei of xi)hi([ei],new vp(ei.x,ei.y,0))}function R6(p,c,d,x,T,D,F,V,X,ae,se,ve,Le,ze,Ue){const Ze=(function(Wt,Rt,Ft,gr,Cr,Wr,yn,an){const hn=gr.layout.get("text-rotate").evaluate(Wr,{})*Math.PI/180,Xn=[];for(const ln of Rt.positionedLines)for(const fn of ln.positionedGlyphs){if(!fn.rect)continue;const Dr=fn.rect||{};let hi=4,xi=!0,ei=1,Bn=0;const Yi=(Cr||an)&&fn.vertical,jo=fn.metrics.advance*fn.scale/2;if(an&&Rt.verticalizable&&(Bn=ln.lineOffset/2-(fn.imageName?-(ol-fn.metrics.width*fn.scale)/2:(fn.scale-1)*ol)),fn.imageName){const ul=yn[fn.imageName];xi=ul.sdf,ei=ul.pixelRatio,hi=1/ei}const Hs=Cr?[fn.x+jo,fn.y]:[0,0];let Gl=Cr?[0,0]:[fn.x+jo+Ft[0],fn.y+Ft[1]-Bn],jc=[0,0];Yi&&(jc=Gl,Gl=[0,0]);const Qu=fn.metrics.isDoubleResolution?2:1,Cl=(fn.metrics.left-hi)*fn.scale-jo+Gl[0],Mo=(-fn.metrics.top-hi)*fn.scale+Gl[1],sl=Cl+Dr.w/Qu*fn.scale/ei,Al=Mo+Dr.h/Qu*fn.scale/ei,Il=new u(Cl,Mo),Pu=new u(sl,Mo),Uc=new u(Cl,Al),ll=new u(sl,Al);if(Yi){const ul=new u(-jo,jo- -17),cl=-Math.PI/2,Ps=12-jo,po=new u(22-Ps,-(fn.imageName?Ps:0)),$h=new u(...jc);Il._rotateAround(cl,ul)._add(po)._add($h),Pu._rotateAround(cl,ul)._add(po)._add($h),Uc._rotateAround(cl,ul)._add(po)._add($h),ll._rotateAround(cl,ul)._add(po)._add($h)}if(hn){const ul=Math.sin(hn),cl=Math.cos(hn),Ps=[cl,-ul,ul,cl];Il._matMult(Ps),Pu._matMult(Ps),Uc._matMult(Ps),ll._matMult(Ps)}const ec=new u(0,0),Ws=new u(0,0);Xn.push({tl:Il,tr:Pu,bl:Uc,br:ll,tex:Dr,writingMode:Rt.writingMode,glyphOffset:Hs,sectionIndex:fn.sectionIndex,isSDF:xi,pixelOffsetTL:ec,pixelOffsetBR:Ws,minFontScaleX:0,minFontScaleY:0})}return Xn})(0,d,V,T,D,F,x,p.allowVerticalPlacement),st=p.textSizeData;let wt=null;st.kind==="source"?(wt=[_d*T.layout.get("text-size").evaluate(F,{})],wt[0]>mp&&at(`${p.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)):st.kind==="composite"&&(wt=[_d*ze.compositeTextSizes[0].evaluate(F,{},Ue),_d*ze.compositeTextSizes[1].evaluate(F,{},Ue)],(wt[0]>mp||wt[1]>mp)&&at(`${p.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)),p.addSymbols(p.text,Ze,wt,V,D,F,ae,c,X.lineStartIndex,X.lineLength,Le,Ue);for(const Wt of se)ve[Wt]=p.text.placedSymbolArray.length-1;return 4*Ze.length}function O6(p){for(const c in p)return p[c];return null}function iie(p,c,d,x){const T=p.compareText;if(c in T){const D=T[c];for(let F=D.length-1;F>=0;F--)if(x.dist(D[F])<d)return!0}else T[c]=[];return T[c].push(x),!1}const L6=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class zC{static from(c){if(!(c instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[d,x]=new Uint8Array(c,0,2);if(d!==219)throw new Error("Data does not appear to be in a KDBush format.");const T=x>>4;if(T!==1)throw new Error(`Got v${T} data when expected v1.`);const D=L6[15&x];if(!D)throw new Error("Unrecognized array type.");const[F]=new Uint16Array(c,2,1),[V]=new Uint32Array(c,4,1);return new zC(V,F,D,c)}constructor(c,d=64,x=Float64Array,T){if(isNaN(c)||c<0)throw new Error(`Unpexpected numItems value: ${c}.`);this.numItems=+c,this.nodeSize=Math.min(Math.max(+d,2),65535),this.ArrayType=x,this.IndexArrayType=c<65536?Uint16Array:Uint32Array;const D=L6.indexOf(this.ArrayType),F=2*c*this.ArrayType.BYTES_PER_ELEMENT,V=c*this.IndexArrayType.BYTES_PER_ELEMENT,X=(8-V%8)%8;if(D<0)throw new Error(`Unexpected typed array class: ${x}.`);T&&T instanceof ArrayBuffer?(this.data=T,this.ids=new this.IndexArrayType(this.data,8,c),this.coords=new this.ArrayType(this.data,8+V+X,2*c),this._pos=2*c,this._finished=!0):(this.data=new ArrayBuffer(8+F+V+X),this.ids=new this.IndexArrayType(this.data,8,c),this.coords=new this.ArrayType(this.data,8+V+X,2*c),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+D]),new Uint16Array(this.data,2,1)[0]=d,new Uint32Array(this.data,4,1)[0]=c)}add(c,d){const x=this._pos>>1;return this.ids[x]=x,this.coords[this._pos++]=c,this.coords[this._pos++]=d,x}finish(){const c=this._pos>>1;if(c!==this.numItems)throw new Error(`Added ${c} items when expected ${this.numItems}.`);return jC(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(c,d,x,T){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:D,coords:F,nodeSize:V}=this,X=[0,D.length-1,0],ae=[];for(;X.length;){const se=X.pop()||0,ve=X.pop()||0,Le=X.pop()||0;if(ve-Le<=V){for(let st=Le;st<=ve;st++){const wt=F[2*st],Wt=F[2*st+1];wt>=c&&wt<=x&&Wt>=d&&Wt<=T&&ae.push(D[st])}continue}const ze=Le+ve>>1,Ue=F[2*ze],Ze=F[2*ze+1];Ue>=c&&Ue<=x&&Ze>=d&&Ze<=T&&ae.push(D[ze]),(se===0?c<=Ue:d<=Ze)&&(X.push(Le),X.push(ze-1),X.push(1-se)),(se===0?x>=Ue:T>=Ze)&&(X.push(ze+1),X.push(ve),X.push(1-se))}return ae}within(c,d,x){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:T,coords:D,nodeSize:F}=this,V=[0,T.length-1,0],X=[],ae=x*x;for(;V.length;){const se=V.pop()||0,ve=V.pop()||0,Le=V.pop()||0;if(ve-Le<=F){for(let st=Le;st<=ve;st++)D6(D[2*st],D[2*st+1],c,d)<=ae&&X.push(T[st]);continue}const ze=Le+ve>>1,Ue=D[2*ze],Ze=D[2*ze+1];D6(Ue,Ze,c,d)<=ae&&X.push(T[ze]),(se===0?c-x<=Ue:d-x<=Ze)&&(V.push(Le),V.push(ze-1),V.push(1-se)),(se===0?c+x>=Ue:d+x>=Ze)&&(V.push(ze+1),V.push(ve),V.push(1-se))}return X}}function jC(p,c,d,x,T,D){if(T-x<=d)return;const F=x+T>>1;N6(p,c,F,x,T,D),jC(p,c,d,x,F-1,1-D),jC(p,c,d,F+1,T,1-D)}function N6(p,c,d,x,T,D){for(;T>x;){if(T-x>600){const ae=T-x+1,se=d-x+1,ve=Math.log(ae),Le=.5*Math.exp(2*ve/3),ze=.5*Math.sqrt(ve*Le*(ae-Le)/ae)*(se-ae/2<0?-1:1);N6(p,c,d,Math.max(x,Math.floor(d-se*Le/ae+ze)),Math.min(T,Math.floor(d+(ae-se)*Le/ae+ze)),D)}const F=c[2*d+D];let V=x,X=T;for(h_(p,c,x,d),c[2*T+D]>F&&h_(p,c,x,T);V<X;){for(h_(p,c,V,X),V++,X--;c[2*V+D]<F;)V++;for(;c[2*X+D]>F;)X--}c[2*x+D]===F?h_(p,c,x,X):(X++,h_(p,c,X,T)),X<=d&&(x=X+1),d<=X&&(T=X-1)}}function h_(p,c,d,x){UC(p,d,x),UC(c,2*d,2*x),UC(c,2*d+1,2*x+1)}function UC(p,c,d){const x=p[c];p[c]=p[d],p[d]=x}function D6(p,c,d,x){const T=p-d,D=c-x;return T*T+D*D}var VC;s.cx=void 0,(VC=s.cx||(s.cx={})).create="create",VC.load="load",VC.fullLoad="fullLoad";let Dx=null,f_=[];const $C=1e3/60,qC="loadTime",HC="fullLoadTime",aie={mark(p){performance.mark(p)},frame(p){const c=p;Dx!=null&&f_.push(c-Dx),Dx=c},clearMetrics(){Dx=null,f_=[],performance.clearMeasures(qC),performance.clearMeasures(HC);for(const p in s.cx)performance.clearMarks(s.cx[p])},getPerformanceMetrics(){performance.measure(qC,s.cx.create,s.cx.load),performance.measure(HC,s.cx.create,s.cx.fullLoad);const p=performance.getEntriesByName(qC)[0].duration,c=performance.getEntriesByName(HC)[0].duration,d=f_.length,x=1/(f_.reduce(((D,F)=>D+F),0)/d/1e3),T=f_.filter((D=>D>$C)).reduce(((D,F)=>D+(F-$C)/$C),0);return{loadTime:p,fullLoadTime:c,fps:x,percentDroppedFrames:T/(d+T)*100,totalFrames:d}}};s.$=we,s.A=O,s.B=function([p,c,d]){return c+=90,c*=Math.PI/180,d*=Math.PI/180,{x:p*Math.cos(c)*Math.sin(d),y:p*Math.sin(c)*Math.sin(d),z:p*Math.cos(d)}},s.C=oi,s.D=xn,s.E=Rr,s.F=mn,s.G=Z,s.H=function(p){if(Yt==null){const c=p.navigator?p.navigator.userAgent:null;Yt=!!p.safari||!(!c||!(/\b(iPad|iPhone|iPod)\b/.test(c)||c.match("Safari")&&!c.match("Chrome")))}return Yt},s.I=CC,s.J=class{constructor(p,c){this.target=p,this.mapId=c,this.resolveRejects={},this.tasks={},this.taskQueue=[],this.abortControllers={},this.messageHandlers={},this.invoker=new Yne((()=>this.process())),this.subscription=Er(this.target,"message",(d=>this.receive(d)),!1),this.globalScope=Xt(self)?p:window}registerMessageHandler(p,c){this.messageHandlers[p]=c}sendAsync(p,c){return new Promise(((d,x)=>{const T=Math.round(1e18*Math.random()).toString(36).substring(0,10),D=c?Er(c.signal,"abort",(()=>{D?.unsubscribe(),delete this.resolveRejects[T];const X={id:T,type:"<cancel>",origin:location.origin,targetMapId:p.targetMapId,sourceMapId:this.mapId};this.target.postMessage(X)}),Zne):null;this.resolveRejects[T]={resolve:X=>{D?.unsubscribe(),d(X)},reject:X=>{D?.unsubscribe(),x(X)}};const F=[],V=Object.assign(Object.assign({},p),{id:T,sourceMapId:this.mapId,origin:location.origin,data:vr(p.data,F)});this.target.postMessage(V,{transfer:F})}))}receive(p){const c=p.data,d=c.id;if(!(c.origin!=="file://"&&location.origin!=="file://"&&c.origin!=="resource://android"&&location.origin!=="resource://android"&&c.origin!==location.origin||c.targetMapId&&this.mapId!==c.targetMapId)){if(c.type==="<cancel>"){delete this.tasks[d];const x=this.abortControllers[d];return delete this.abortControllers[d],void(x&&x.abort())}if(Xt(self)||c.mustQueue)return this.tasks[d]=c,this.taskQueue.push(d),void this.invoker.trigger();this.processTask(d,c)}}process(){if(this.taskQueue.length===0)return;const p=this.taskQueue.shift(),c=this.tasks[p];delete this.tasks[p],this.taskQueue.length>0&&this.invoker.trigger(),c&&this.processTask(p,c)}processTask(p,c){return o(this,void 0,void 0,(function*(){if(c.type==="<response>"){const T=this.resolveRejects[p];return delete this.resolveRejects[p],T?void(c.error?T.reject(St(c.error)):T.resolve(St(c.data))):void 0}if(!this.messageHandlers[c.type])return void this.completeTask(p,new Error(`Could not find a registered handler for ${c.type}, map ID: ${this.mapId}, available handlers: ${Object.keys(this.messageHandlers).join(", ")}`));const d=St(c.data),x=new AbortController;this.abortControllers[p]=x;try{const T=yield this.messageHandlers[c.type](c.sourceMapId,d,x);this.completeTask(p,null,T)}catch(T){this.completeTask(p,T)}}))}completeTask(p,c,d){const x=[];delete this.abortControllers[p];const T={id:p,type:"<response>",sourceMapId:this.mapId,origin:location.origin,error:c?vr(c):null,data:vr(d,x)};this.target.postMessage(T,{transfer:x})}remove(){this.invoker.remove(),this.subscription.unsubscribe()}},s.K=qe,s.L=function(){var p=new O(16);return O!=Float32Array&&(p[1]=0,p[2]=0,p[3]=0,p[4]=0,p[6]=0,p[7]=0,p[8]=0,p[9]=0,p[11]=0,p[12]=0,p[13]=0,p[14]=0),p[0]=1,p[5]=1,p[10]=1,p[15]=1,p},s.M=function(p,c,d){var x,T,D,F,V,X,ae,se,ve,Le,ze,Ue,Ze=d[0],st=d[1],wt=d[2];return c===p?(p[12]=c[0]*Ze+c[4]*st+c[8]*wt+c[12],p[13]=c[1]*Ze+c[5]*st+c[9]*wt+c[13],p[14]=c[2]*Ze+c[6]*st+c[10]*wt+c[14],p[15]=c[3]*Ze+c[7]*st+c[11]*wt+c[15]):(T=c[1],D=c[2],F=c[3],V=c[4],X=c[5],ae=c[6],se=c[7],ve=c[8],Le=c[9],ze=c[10],Ue=c[11],p[0]=x=c[0],p[1]=T,p[2]=D,p[3]=F,p[4]=V,p[5]=X,p[6]=ae,p[7]=se,p[8]=ve,p[9]=Le,p[10]=ze,p[11]=Ue,p[12]=x*Ze+V*st+ve*wt+c[12],p[13]=T*Ze+X*st+Le*wt+c[13],p[14]=D*Ze+ae*st+ze*wt+c[14],p[15]=F*Ze+se*st+Ue*wt+c[15]),p},s.N=function(p,c,d){var x=d[0],T=d[1],D=d[2];return p[0]=c[0]*x,p[1]=c[1]*x,p[2]=c[2]*x,p[3]=c[3]*x,p[4]=c[4]*T,p[5]=c[5]*T,p[6]=c[6]*T,p[7]=c[7]*T,p[8]=c[8]*D,p[9]=c[9]*D,p[10]=c[10]*D,p[11]=c[11]*D,p[12]=c[12],p[13]=c[13],p[14]=c[14],p[15]=c[15],p},s.O=function(p,c,d){var x=c[0],T=c[1],D=c[2],F=c[3],V=c[4],X=c[5],ae=c[6],se=c[7],ve=c[8],Le=c[9],ze=c[10],Ue=c[11],Ze=c[12],st=c[13],wt=c[14],Wt=c[15],Rt=d[0],Ft=d[1],gr=d[2],Cr=d[3];return p[0]=Rt*x+Ft*V+gr*ve+Cr*Ze,p[1]=Rt*T+Ft*X+gr*Le+Cr*st,p[2]=Rt*D+Ft*ae+gr*ze+Cr*wt,p[3]=Rt*F+Ft*se+gr*Ue+Cr*Wt,p[4]=(Rt=d[4])*x+(Ft=d[5])*V+(gr=d[6])*ve+(Cr=d[7])*Ze,p[5]=Rt*T+Ft*X+gr*Le+Cr*st,p[6]=Rt*D+Ft*ae+gr*ze+Cr*wt,p[7]=Rt*F+Ft*se+gr*Ue+Cr*Wt,p[8]=(Rt=d[8])*x+(Ft=d[9])*V+(gr=d[10])*ve+(Cr=d[11])*Ze,p[9]=Rt*T+Ft*X+gr*Le+Cr*st,p[10]=Rt*D+Ft*ae+gr*ze+Cr*wt,p[11]=Rt*F+Ft*se+gr*Ue+Cr*Wt,p[12]=(Rt=d[12])*x+(Ft=d[13])*V+(gr=d[14])*ve+(Cr=d[15])*Ze,p[13]=Rt*T+Ft*X+gr*Le+Cr*st,p[14]=Rt*D+Ft*ae+gr*ze+Cr*wt,p[15]=Rt*F+Ft*se+gr*Ue+Cr*Wt,p},s.P=u,s.Q=function(p,c){const d={};for(let x=0;x<c.length;x++){const T=c[x];T in p&&(d[T]=p[T])}return d},s.R=Ju,s.S=yp,s.T=gC,s.U=d6,s.V=f6,s.W=P,s.X=k,s.Y=yr,s.Z=zc,s._=o,s.a=_e,s.a$=ne,s.a0=function(p,c){var d,x,T,D,F;if(!p)return c??{};if(!c)return p;let V=Object.assign({},p);if(c.removeAll&&(V={removeAll:!0}),c.remove){const X=new Set(c.remove);V.add&&(V.add=V.add.filter((se=>!X.has(se.id)))),V.update&&(V.update=V.update.filter((se=>!X.has(se.id))));const ae=new Set(((d=p.add)!==null&&d!==void 0?d:[]).map((se=>se.id)));c.remove=c.remove.filter((se=>!ae.has(se)))}if(c.remove){const X=new Set(V.remove?V.remove.concat(c.remove):c.remove);V.remove=Array.from(X.values())}if(c.add){const X=V.add?V.add.concat(c.add):c.add,ae=new Map(X.map((se=>[se.id,se])));V.add=Array.from(ae.values())}if(c.update){const X=new Map((x=V.update)===null||x===void 0?void 0:x.map((ae=>[ae.id,ae])));for(const ae of c.update){const se=(T=X.get(ae.id))!==null&&T!==void 0?T:{id:ae.id};ae.newGeometry&&(se.newGeometry=ae.newGeometry),ae.addOrUpdateProperties&&(se.addOrUpdateProperties=((D=se.addOrUpdateProperties)!==null&&D!==void 0?D:[]).concat(ae.addOrUpdateProperties)),ae.removeProperties&&(se.removeProperties=((F=se.removeProperties)!==null&&F!==void 0?F:[]).concat(ae.removeProperties)),ae.removeAllProperties&&(se.removeAllProperties=!0),X.set(ae.id,se)}V.update=Array.from(X.values())}return V.remove&&V.add&&(V.remove=V.remove.filter((X=>V.add.findIndex((ae=>ae.id===X))===-1))),V},s.a1=u_,s.a2=Cg,s.a3=25,s.a4=DC,s.a5=p=>{const c=window.document.createElement("video");return c.muted=!0,new Promise((d=>{c.onloadstart=()=>{d(c)};for(const x of p){const T=window.document.createElement("source");Lt(x)||(c.crossOrigin="Anonymous"),T.src=x,c.appendChild(T)}}))},s.a6=pt,s.a7=function(){return it++},s.a8=Se,s.a9=my,s.aA=function(p){let c=1/0,d=1/0,x=-1/0,T=-1/0;for(const D of p)c=Math.min(c,D.x),d=Math.min(d,D.y),x=Math.max(x,D.x),T=Math.max(T,D.y);return[c,d,x,T]},s.aB=ol,s.aC=Te,s.aD=function(p,c,d,x,T=!1){if(!d[0]&&!d[1])return[0,0];const D=T?x==="map"?-p.bearingInRadians:0:x==="viewport"?p.bearingInRadians:0;if(D){const F=Math.sin(D),V=Math.cos(D);d=[d[0]*V-d[1]*F,d[0]*F+d[1]*V]}return[T?d[0]:Te(c,d[0],p.zoom),T?d[1]:Te(c,d[1],p.zoom)]},s.aF=PC,s.aG=BC,s.aH=IC,s.aI=zC,s.aJ=wi,s.aK=Cx,s.aL=At,s.aM=ci,s.aN=da,s.aO=$e,s.aP=er,s.aQ=g6,s.aR=ie,s.aS=G,s.aT=function(p){var c=new O(3);return c[0]=p[0],c[1]=p[1],c[2]=p[2],c},s.aU=function(p,c,d){return p[0]=c[0]-d[0],p[1]=c[1]-d[1],p[2]=c[2]-d[2],p},s.aV=function(p,c){var d=c[0],x=c[1],T=c[2],D=d*d+x*x+T*T;return D>0&&(D=1/Math.sqrt(D)),p[0]=c[0]*D,p[1]=c[1]*D,p[2]=c[2]*D,p},s.aW=Q,s.aX=function(p,c){return p[0]*c[0]+p[1]*c[1]+p[2]*c[2]},s.aY=function(p,c,d){return p[0]=c[0]*d[0],p[1]=c[1]*d[1],p[2]=c[2]*d[2],p[3]=c[3]*d[3],p},s.aZ=q,s.a_=function(p,c,d){const x=c[0]*d[0]+c[1]*d[1]+c[2]*d[2];return x===0?null:(-(p[0]*d[0]+p[1]*d[1]+p[2]*d[2])-d[3])/x},s.aa=zh,s.ab=Vh,s.ac=_6,s.ad=function(p){const c={};if(p.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,((d,x,T,D)=>{const F=T||D;return c[x]=!F||F.toLowerCase(),""})),c["max-age"]){const d=parseInt(c["max-age"],10);isNaN(d)?delete c["max-age"]:c["max-age"]=d}return c},s.ae=wr,s.af=function(p){return Math.pow(2,p)},s.ag=z,s.ah=Oe,s.ai=85.051129,s.aj=p6,s.ak=function(p){return Math.log(p)/Math.LN2},s.al=function(p){var c=p[0],d=p[1];return c*c+d*d},s.am=function(p,c){const d=[];for(const x in p)x in c||d.push(x);return d},s.an=function(p,c){let d=0,x=0;if(p.kind==="constant")x=p.layoutSize;else if(p.kind!=="source"){const{interpolationType:T,minZoom:D,maxZoom:F}=p,V=T?Oe(wn.interpolationFactor(T,c,D,F),0,1):0;p.kind==="camera"?x=oi.number(p.minSize,p.maxSize,V):d=V}return{uSizeT:d,uSize:x}},s.ap=function(p,{uSize:c,uSizeT:d},{lowerSize:x,upperSize:T}){return p.kind==="source"?x/_d:p.kind==="composite"?oi.number(x/_d,T/_d,d):c},s.aq=function(p,c){var d=c[0],x=c[1],T=c[2],D=c[3],F=c[4],V=c[5],X=c[6],ae=c[7],se=c[8],ve=c[9],Le=c[10],ze=c[11],Ue=c[12],Ze=c[13],st=c[14],wt=c[15],Wt=d*V-x*F,Rt=d*X-T*F,Ft=d*ae-D*F,gr=x*X-T*V,Cr=x*ae-D*V,Wr=T*ae-D*X,yn=se*Ze-ve*Ue,an=se*st-Le*Ue,hn=se*wt-ze*Ue,Xn=ve*st-Le*Ze,ln=ve*wt-ze*Ze,fn=Le*wt-ze*st,Dr=Wt*fn-Rt*ln+Ft*Xn+gr*hn-Cr*an+Wr*yn;return Dr?(p[0]=(V*fn-X*ln+ae*Xn)*(Dr=1/Dr),p[1]=(T*ln-x*fn-D*Xn)*Dr,p[2]=(Ze*Wr-st*Cr+wt*gr)*Dr,p[3]=(Le*Cr-ve*Wr-ze*gr)*Dr,p[4]=(X*hn-F*fn-ae*an)*Dr,p[5]=(d*fn-T*hn+D*an)*Dr,p[6]=(st*Ft-Ue*Wr-wt*Rt)*Dr,p[7]=(se*Wr-Le*Ft+ze*Rt)*Dr,p[8]=(F*ln-V*hn+ae*yn)*Dr,p[9]=(x*hn-d*ln-D*yn)*Dr,p[10]=(Ue*Cr-Ze*Ft+wt*Wt)*Dr,p[11]=(ve*Ft-se*Cr-ze*Wt)*Dr,p[12]=(V*an-F*Xn-X*yn)*Dr,p[13]=(d*Xn-x*an+T*yn)*Dr,p[14]=(Ze*Rt-Ue*gr-st*Wt)*Dr,p[15]=(se*gr-ve*Rt+Le*Wt)*Dr,p):null},s.ar=Me,s.as=function(p){var c=p[0],d=p[1];return Math.sqrt(c*c+d*d)},s.at=function(p){return p[0]=0,p[1]=0,p},s.au=function(p,c,d){return p[0]=c[0]*d,p[1]=c[1]*d,p},s.av=kC,s.aw=oe,s.ax=function(p,c,d,x){const T=c.y-p.y,D=c.x-p.x,F=x.y-d.y,V=x.x-d.x,X=F*D-V*T;if(X===0)return null;const ae=(V*(p.y-d.y)-F*(p.x-d.x))/X;return new u(p.x+ae*D,p.y+ae*T)},s.ay=w6,s.az=hD,s.b=pr,s.b$=class extends R{},s.b0=function(p,c,d){return p[0]=c[0]*d,p[1]=c[1]*d,p[2]=c[2]*d,p[3]=c[3]*d,p},s.b1=function(p,c){return p[0]*c[0]+p[1]*c[1]+p[2]*c[2]+p[3]},s.b2=y6,s.b3=yy,s.b4=function(p,c,d,x,T){var D=1/Math.tan(c/2);if(p[0]=D/d,p[1]=0,p[2]=0,p[3]=0,p[4]=0,p[5]=D,p[6]=0,p[7]=0,p[8]=0,p[9]=0,p[11]=-1,p[12]=0,p[13]=0,p[15]=0,T!=null&&T!==1/0){var F=1/(x-T);p[10]=(T+x)*F,p[14]=2*T*x*F}else p[10]=-1,p[14]=-2*x;return p},s.b5=function(p){var c=new O(16);return c[0]=p[0],c[1]=p[1],c[2]=p[2],c[3]=p[3],c[4]=p[4],c[5]=p[5],c[6]=p[6],c[7]=p[7],c[8]=p[8],c[9]=p[9],c[10]=p[10],c[11]=p[11],c[12]=p[12],c[13]=p[13],c[14]=p[14],c[15]=p[15],c},s.b6=function(p,c,d){var x=Math.sin(d),T=Math.cos(d),D=c[0],F=c[1],V=c[2],X=c[3],ae=c[4],se=c[5],ve=c[6],Le=c[7];return c!==p&&(p[8]=c[8],p[9]=c[9],p[10]=c[10],p[11]=c[11],p[12]=c[12],p[13]=c[13],p[14]=c[14],p[15]=c[15]),p[0]=D*T+ae*x,p[1]=F*T+se*x,p[2]=V*T+ve*x,p[3]=X*T+Le*x,p[4]=ae*T-D*x,p[5]=se*T-F*x,p[6]=ve*T-V*x,p[7]=Le*T-X*x,p},s.b7=function(p,c,d){var x=Math.sin(d),T=Math.cos(d),D=c[4],F=c[5],V=c[6],X=c[7],ae=c[8],se=c[9],ve=c[10],Le=c[11];return c!==p&&(p[0]=c[0],p[1]=c[1],p[2]=c[2],p[3]=c[3],p[12]=c[12],p[13]=c[13],p[14]=c[14],p[15]=c[15]),p[4]=D*T+ae*x,p[5]=F*T+se*x,p[6]=V*T+ve*x,p[7]=X*T+Le*x,p[8]=ae*T-D*x,p[9]=se*T-F*x,p[10]=ve*T-V*x,p[11]=Le*T-X*x,p},s.b8=function(){const p=new Float32Array(16);return z(p),p},s.b9=function(){const p=new Float64Array(16);return z(p),p},s.bA=function(p,c){const d=ke(p,360),x=ke(c,360),T=x-d,D=x>d?T-360:T+360;return Math.abs(T)<Math.abs(D)?T:D},s.bB=function(p){return p[0]=0,p[1]=0,p[2]=0,p},s.bC=function(p,c,d,x){const T=Math.sqrt(p*p+c*c),D=Math.sqrt(d*d+x*x);p/=T,c/=T,d/=D,x/=D;const F=Math.acos(p*d+c*x);return-c*d+p*x>0?F:-F},s.bD=function(p,c){const d=ke(p,2*Math.PI),x=ke(c,2*Math.PI);return Math.min(Math.abs(d-x),Math.abs(d-x+2*Math.PI),Math.abs(d-x-2*Math.PI))},s.bE=function(){const p={},c=bt.$version;for(const d in bt.$root){const x=bt.$root[d];if(x.required){let T=null;T=d==="version"?c:x.type==="array"?[]:{},T!=null&&(p[d]=T)}}return p},s.bF=Qt,s.bG=ot,s.bH=function p(c,d){if(Array.isArray(c)){if(!Array.isArray(d)||c.length!==d.length)return!1;for(let x=0;x<c.length;x++)if(!p(c[x],d[x]))return!1;return!0}if(typeof c=="object"&&c!==null&&d!==null){if(typeof d!="object"||Object.keys(c).length!==Object.keys(d).length)return!1;for(const x in c)if(!p(c[x],d[x]))return!1;return!0}return c===d},s.bI=function(p){p=p.slice();const c=Object.create(null);for(let d=0;d<p.length;d++)c[p[d].id]=p[d];for(let d=0;d<p.length;d++)"ref"in p[d]&&(p[d]=Ur(p[d],c[p[d].ref]));return p},s.bJ=function(p){if(p.type==="custom")return new Xne(p);switch(p.type){case"background":return new Hne(p);case"circle":return new kre(p);case"color-relief":return new Dre(p);case"fill":return new Kre(p);case"fill-extrusion":return new lne(p);case"heatmap":return new Rre(p);case"hillshade":return new Lre(p);case"line":return new gne(p);case"raster":return new Gne(p);case"symbol":return new Mx(p)}},s.bK=Ie,s.bL=function(p,c){if(!p)return[{command:"setStyle",args:[c]}];let d=[];try{if(!Gr(p.version,c.version))return[{command:"setStyle",args:[c]}];Gr(p.center,c.center)||d.push({command:"setCenter",args:[c.center]}),Gr(p.state,c.state)||d.push({command:"setGlobalState",args:[c.state]}),Gr(p.centerAltitude,c.centerAltitude)||d.push({command:"setCenterAltitude",args:[c.centerAltitude]}),Gr(p.zoom,c.zoom)||d.push({command:"setZoom",args:[c.zoom]}),Gr(p.bearing,c.bearing)||d.push({command:"setBearing",args:[c.bearing]}),Gr(p.pitch,c.pitch)||d.push({command:"setPitch",args:[c.pitch]}),Gr(p.roll,c.roll)||d.push({command:"setRoll",args:[c.roll]}),Gr(p.sprite,c.sprite)||d.push({command:"setSprite",args:[c.sprite]}),Gr(p.glyphs,c.glyphs)||d.push({command:"setGlyphs",args:[c.glyphs]}),Gr(p.transition,c.transition)||d.push({command:"setTransition",args:[c.transition]}),Gr(p.light,c.light)||d.push({command:"setLight",args:[c.light]}),Gr(p.terrain,c.terrain)||d.push({command:"setTerrain",args:[c.terrain]}),Gr(p.sky,c.sky)||d.push({command:"setSky",args:[c.sky]}),Gr(p.projection,c.projection)||d.push({command:"setProjection",args:[c.projection]});const x={},T=[];(function(F,V,X,ae){let se;for(se in V=V||{},F=F||{})Object.prototype.hasOwnProperty.call(F,se)&&(Object.prototype.hasOwnProperty.call(V,se)||ti(se,X,ae));for(se in V)Object.prototype.hasOwnProperty.call(V,se)&&(Object.prototype.hasOwnProperty.call(F,se)?Gr(F[se],V[se])||(F[se].type==="geojson"&&V[se].type==="geojson"&&ri(F,V,se)?Jr(X,{command:"setGeoJSONSourceData",args:[se,V[se].data]}):un(se,V,X,ae)):ar(se,V,X))})(p.sources,c.sources,T,x);const D=[];p.layers&&p.layers.forEach((F=>{"source"in F&&x[F.source]?d.push({command:"removeLayer",args:[F.id]}):D.push(F)})),d=d.concat(T),(function(F,V,X){V=V||[];const ae=(F=F||[]).map(Be),se=V.map(Be),ve=F.reduce(mt,{}),Le=V.reduce(mt,{}),ze=ae.slice(),Ue=Object.create(null);let Ze,st,wt,Wt,Rt;for(let Ft=0,gr=0;Ft<ae.length;Ft++)Ze=ae[Ft],Object.prototype.hasOwnProperty.call(Le,Ze)?gr++:(Jr(X,{command:"removeLayer",args:[Ze]}),ze.splice(ze.indexOf(Ze,gr),1));for(let Ft=0,gr=0;Ft<se.length;Ft++)Ze=se[se.length-1-Ft],ze[ze.length-1-Ft]!==Ze&&(Object.prototype.hasOwnProperty.call(ve,Ze)?(Jr(X,{command:"removeLayer",args:[Ze]}),ze.splice(ze.lastIndexOf(Ze,ze.length-gr),1)):gr++,Wt=ze[ze.length-Ft],Jr(X,{command:"addLayer",args:[Le[Ze],Wt]}),ze.splice(ze.length-Ft,0,Ze),Ue[Ze]=!0);for(let Ft=0;Ft<se.length;Ft++)if(Ze=se[Ft],st=ve[Ze],wt=Le[Ze],!Ue[Ze]&&!Gr(st,wt))if(Gr(st.source,wt.source)&&Gr(st["source-layer"],wt["source-layer"])&&Gr(st.type,wt.type)){for(Rt in Ae(st.layout,wt.layout,X,Ze,null,"setLayoutProperty"),Ae(st.paint,wt.paint,X,Ze,null,"setPaintProperty"),Gr(st.filter,wt.filter)||Jr(X,{command:"setFilter",args:[Ze,wt.filter]}),Gr(st.minzoom,wt.minzoom)&&Gr(st.maxzoom,wt.maxzoom)||Jr(X,{command:"setLayerZoomRange",args:[Ze,wt.minzoom,wt.maxzoom]}),st)Object.prototype.hasOwnProperty.call(st,Rt)&&Rt!=="layout"&&Rt!=="paint"&&Rt!=="filter"&&Rt!=="metadata"&&Rt!=="minzoom"&&Rt!=="maxzoom"&&(Rt.indexOf("paint.")===0?Ae(st[Rt],wt[Rt],X,Ze,Rt.slice(6),"setPaintProperty"):Gr(st[Rt],wt[Rt])||Jr(X,{command:"setLayerProperty",args:[Ze,Rt,wt[Rt]]}));for(Rt in wt)Object.prototype.hasOwnProperty.call(wt,Rt)&&!Object.prototype.hasOwnProperty.call(st,Rt)&&Rt!=="layout"&&Rt!=="paint"&&Rt!=="filter"&&Rt!=="metadata"&&Rt!=="minzoom"&&Rt!=="maxzoom"&&(Rt.indexOf("paint.")===0?Ae(st[Rt],wt[Rt],X,Ze,Rt.slice(6),"setPaintProperty"):Gr(st[Rt],wt[Rt])||Jr(X,{command:"setLayerProperty",args:[Ze,Rt,wt[Rt]]}))}else Jr(X,{command:"removeLayer",args:[Ze]}),Wt=ze[ze.lastIndexOf(Ze)+1],Jr(X,{command:"addLayer",args:[wt,Wt]})})(D,c.layers,d)}catch(x){console.warn("Unable to compute style diff:",x),d=[{command:"setStyle",args:[c]}]}return d},s.bM=function(p){const c=[],d=p.id;return d===void 0&&c.push({message:`layers.${d}: missing required property "id"`}),p.render===void 0&&c.push({message:`layers.${d}: missing required method "render"`}),p.renderingMode&&p.renderingMode!=="2d"&&p.renderingMode!=="3d"&&c.push({message:`layers.${d}: property "renderingMode" must be either "2d" or "3d"`}),c},s.bN=Ye,s.bO=rt,s.bP=class extends uu{constructor(p,c){super(p,c),this.current=0}set(p){this.current!==p&&(this.current=p,this.gl.uniform1i(this.location,p))}},s.bQ=qs,s.bR=class extends uu{constructor(p,c){super(p,c),this.current=fc}set(p){if(p[12]!==this.current[12]||p[0]!==this.current[0])return this.current=p,void this.gl.uniformMatrix4fv(this.location,!1,p);for(let c=1;c<16;c++)if(p[c]!==this.current[c]){this.current=p,this.gl.uniformMatrix4fv(this.location,!1,p);break}}},s.bS=As,s.bT=class extends uu{constructor(p,c){super(p,c),this.current=[0,0,0]}set(p){p[0]===this.current[0]&&p[1]===this.current[1]&&p[2]===this.current[2]||(this.current=p,this.gl.uniform3f(this.location,p[0],p[1],p[2]))}},s.bU=class extends uu{constructor(p,c){super(p,c),this.current=[0,0]}set(p){p[0]===this.current[0]&&p[1]===this.current[1]||(this.current=p,this.gl.uniform2f(this.location,p[0],p[1]))}},s.bV=M,s.bW=function(p,c){var d=Math.sin(c),x=Math.cos(c);return p[0]=x,p[1]=d,p[2]=0,p[3]=-d,p[4]=x,p[5]=0,p[6]=0,p[7]=0,p[8]=1,p},s.bX=function(p,c,d){var x=c[0],T=c[1],D=c[2];return p[0]=x*d[0]+T*d[3]+D*d[6],p[1]=x*d[1]+T*d[4]+D*d[7],p[2]=x*d[2]+T*d[5]+D*d[8],p},s.bY=function(p,c,d,x,T,D,F){var V=1/(c-d),X=1/(x-T),ae=1/(D-F);return p[0]=-2*V,p[1]=0,p[2]=0,p[3]=0,p[4]=0,p[5]=-2*X,p[6]=0,p[7]=0,p[8]=0,p[9]=0,p[10]=2*ae,p[11]=0,p[12]=(c+d)*V,p[13]=(T+x)*X,p[14]=(F+D)*ae,p[15]=1,p},s.bZ=class extends uu{constructor(p,c){super(p,c),this.current=new Array}set(p){if(p!=this.current){this.current=p;const c=new Float32Array(4*p.length);for(let d=0;d<p.length;d++)c[4*d]=p[d].r,c[4*d+1]=p[d].g,c[4*d+2]=p[d].b,c[4*d+3]=p[d].a;this.gl.uniform4fv(this.location,c)}}},s.b_=class extends uu{constructor(p,c){super(p,c),this.current=new Array}set(p){if(p!=this.current){this.current=p;const c=new Float32Array(p);this.gl.uniform1fv(this.location,c)}}},s.ba=function(){return new Float64Array(16)},s.bb=function(p,c,d){const x=new Float64Array(4);return fe(x,p,c-90,d),x},s.bc=function(p,c,d,x){var T,D,F,V,X,ae=c[0],se=c[1],ve=c[2],Le=c[3],ze=d[0],Ue=d[1],Ze=d[2],st=d[3];return(D=ae*ze+se*Ue+ve*Ze+Le*st)<0&&(D=-D,ze=-ze,Ue=-Ue,Ze=-Ze,st=-st),1-D>L?(T=Math.acos(D),F=Math.sin(T),V=Math.sin((1-x)*T)/F,X=Math.sin(x*T)/F):(V=1-x,X=x),p[0]=V*ae+X*ze,p[1]=V*se+X*Ue,p[2]=V*ve+X*Ze,p[3]=V*Le+X*st,p},s.bd=function(p){const c=new Float64Array(9);var d,x,T,D,F,V,X,ae,se,ve,Le,ze,Ue,Ze,st,wt,Wt,Rt;ve=(T=(x=p)[0])*(X=T+T),Le=(D=x[1])*X,Ue=(F=x[2])*X,Ze=F*(ae=D+D),wt=(V=x[3])*X,Wt=V*ae,Rt=V*(se=F+F),(d=c)[0]=1-(ze=D*ae)-(st=F*se),d[3]=Le-Rt,d[6]=Ue+Wt,d[1]=Le+Rt,d[4]=1-ve-st,d[7]=Ze-wt,d[2]=Ue-Wt,d[5]=Ze+wt,d[8]=1-ve-ze;const Ft=er(-Math.asin(Oe(c[2],-1,1)));let gr,Cr;return Math.hypot(c[5],c[8])<.001?(gr=0,Cr=-er(Math.atan2(c[3],c[4]))):(gr=er(c[5]===0&&c[8]===0?0:Math.atan2(c[5],c[8])),Cr=er(c[1]===0&&c[0]===0?0:Math.atan2(c[1],c[0]))),{roll:gr,pitch:Ft+90,bearing:Cr}},s.be=function(p,c){return p.roll==c.roll&&p.pitch==c.pitch&&p.bearing==c.bearing},s.bf=kr,s.bg=Pf,s.bh=fy,s.bi=n_,s.bj=hy,s.bk=he,s.bl=Ee,s.bm=gi,s.bn=function(p,c,d,x,T){return he(x,T,Oe((p-c)/(d-c),0,1))},s.bo=ke,s.bp=function(){return new Float64Array(3)},s.bq=function(p,c,d,x){return p[0]=c[0]+d[0]*x,p[1]=c[1]+d[1]*x,p[2]=c[2]+d[2]*x,p},s.br=fe,s.bs=function(p,c,d){var x=d[0],T=d[1],D=d[2],F=d[3],V=c[0],X=c[1],ae=c[2],se=T*ae-D*X,ve=D*V-x*ae,Le=x*X-T*V;return p[0]=V+F*(se+=se)+T*(Le+=Le)-D*(ve+=ve),p[1]=X+F*ve+D*se-x*Le,p[2]=ae+F*Le+x*ve-T*se,p},s.bt=function(p,c,d){const x=(T=[p[0],p[1],p[2],c[0],c[1],c[2],d[0],d[1],d[2]])[0]*((se=T[8])*(F=T[4])-(V=T[5])*(ae=T[7]))+T[1]*(-se*(D=T[3])+V*(X=T[6]))+T[2]*(ae*D-F*X);var T,D,F,V,X,ae,se;if(x===0)return null;const ve=Q([],[c[0],c[1],c[2]],[d[0],d[1],d[2]]),Le=Q([],[d[0],d[1],d[2]],[p[0],p[1],p[2]]),ze=Q([],[p[0],p[1],p[2]],[c[0],c[1],c[2]]),Ue=ie([],ve,-p[3]);return G(Ue,Ue,ie([],Le,-c[3])),G(Ue,Ue,ie([],ze,-d[3])),ie(Ue,Ue,1/x),Ue},s.bu=LC,s.bv=function(){return new Float64Array(4)},s.bw=function(p,c,d,x){var T=[],D=[];return T[0]=c[0]-d[0],T[1]=c[1]-d[1],T[2]=c[2]-d[2],D[0]=T[0]*Math.cos(x)-T[1]*Math.sin(x),D[1]=T[0]*Math.sin(x)+T[1]*Math.cos(x),D[2]=T[2],p[0]=D[0]+d[0],p[1]=D[1]+d[1],p[2]=D[2]+d[2],p},s.bx=function(p,c,d,x){var T=[],D=[];return T[0]=c[0]-d[0],T[1]=c[1]-d[1],T[2]=c[2]-d[2],D[0]=T[0],D[1]=T[1]*Math.cos(x)-T[2]*Math.sin(x),D[2]=T[1]*Math.sin(x)+T[2]*Math.cos(x),p[0]=D[0]+d[0],p[1]=D[1]+d[1],p[2]=D[2]+d[2],p},s.by=function(p,c,d,x){var T=[],D=[];return T[0]=c[0]-d[0],T[1]=c[1]-d[1],T[2]=c[2]-d[2],D[0]=T[2]*Math.sin(x)+T[0]*Math.cos(x),D[1]=T[1],D[2]=T[2]*Math.cos(x)-T[0]*Math.sin(x),p[0]=D[0]+d[0],p[1]=D[1]+d[1],p[2]=D[2]+d[2],p},s.bz=function(p,c,d){var x=Math.sin(d),T=Math.cos(d),D=c[0],F=c[1],V=c[2],X=c[3],ae=c[8],se=c[9],ve=c[10],Le=c[11];return c!==p&&(p[4]=c[4],p[5]=c[5],p[6]=c[6],p[7]=c[7],p[12]=c[12],p[13]=c[13],p[14]=c[14],p[15]=c[15]),p[0]=D*T-ae*x,p[1]=F*T-se*x,p[2]=V*T-ve*x,p[3]=X*T-Le*x,p[8]=D*x+ae*T,p[9]=F*x+se*T,p[10]=V*x+ve*T,p[11]=X*x+Le*T,p},s.c=nt,s.c0=_ne,s.c1=class extends m{},s.c2=pC,s.c3=function(p){return p<=1?1:Math.pow(2,Math.ceil(Math.log(p)/Math.LN2))},s.c4=xD,s.c5=function(p,c,d){var x=c[0],T=c[1],D=c[2],F=d[3]*x+d[7]*T+d[11]*D+d[15];return p[0]=(d[0]*x+d[4]*T+d[8]*D+d[12])/(F=F||1),p[1]=(d[1]*x+d[5]*T+d[9]*D+d[13])/F,p[2]=(d[2]*x+d[6]*T+d[10]*D+d[14])/F,p},s.c6=class extends Tl{},s.c7=class extends ue{},s.c8=function(p,c){return p[0]===c[0]&&p[1]===c[1]&&p[2]===c[2]&&p[3]===c[3]&&p[4]===c[4]&&p[5]===c[5]&&p[6]===c[6]&&p[7]===c[7]&&p[8]===c[8]&&p[9]===c[9]&&p[10]===c[10]&&p[11]===c[11]&&p[12]===c[12]&&p[13]===c[13]&&p[14]===c[14]&&p[15]===c[15]},s.c9=function(p,c){var d=p[0],x=p[1],T=p[2],D=p[3],F=p[4],V=p[5],X=p[6],ae=p[7],se=p[8],ve=p[9],Le=p[10],ze=p[11],Ue=p[12],Ze=p[13],st=p[14],wt=p[15],Wt=c[0],Rt=c[1],Ft=c[2],gr=c[3],Cr=c[4],Wr=c[5],yn=c[6],an=c[7],hn=c[8],Xn=c[9],ln=c[10],fn=c[11],Dr=c[12],hi=c[13],xi=c[14],ei=c[15];return Math.abs(d-Wt)<=L*Math.max(1,Math.abs(d),Math.abs(Wt))&&Math.abs(x-Rt)<=L*Math.max(1,Math.abs(x),Math.abs(Rt))&&Math.abs(T-Ft)<=L*Math.max(1,Math.abs(T),Math.abs(Ft))&&Math.abs(D-gr)<=L*Math.max(1,Math.abs(D),Math.abs(gr))&&Math.abs(F-Cr)<=L*Math.max(1,Math.abs(F),Math.abs(Cr))&&Math.abs(V-Wr)<=L*Math.max(1,Math.abs(V),Math.abs(Wr))&&Math.abs(X-yn)<=L*Math.max(1,Math.abs(X),Math.abs(yn))&&Math.abs(ae-an)<=L*Math.max(1,Math.abs(ae),Math.abs(an))&&Math.abs(se-hn)<=L*Math.max(1,Math.abs(se),Math.abs(hn))&&Math.abs(ve-Xn)<=L*Math.max(1,Math.abs(ve),Math.abs(Xn))&&Math.abs(Le-ln)<=L*Math.max(1,Math.abs(Le),Math.abs(ln))&&Math.abs(ze-fn)<=L*Math.max(1,Math.abs(ze),Math.abs(fn))&&Math.abs(Ue-Dr)<=L*Math.max(1,Math.abs(Ue),Math.abs(Dr))&&Math.abs(Ze-hi)<=L*Math.max(1,Math.abs(Ze),Math.abs(hi))&&Math.abs(st-xi)<=L*Math.max(1,Math.abs(st),Math.abs(xi))&&Math.abs(wt-ei)<=L*Math.max(1,Math.abs(wt),Math.abs(ei))},s.cA=function(p,c){_e.REGISTERED_PROTOCOLS[p]=c},s.cB=function(p){delete _e.REGISTERED_PROTOCOLS[p]},s.cC=function(p,c){const d={};for(let T=0;T<p.length;T++){const D=c&&c[p[T].id]||Y0(p[T]);c&&(c[p[T].id]=D);let F=d[D];F||(F=d[D]=[]),F.push(p[T])}const x=[];for(const T in d)x.push(d[T]);return x},s.cD=We,s.cE=v6,s.cF=b6,s.cG=ZD,s.cH=function(p){p.bucket.createArrays(),p.bucket.tilePixelRatio=we/(512*p.bucket.overscaling),p.bucket.compareText={},p.bucket.iconsNeedLinear=!1;const c=p.bucket.layers[0],d=c.layout,x=c._unevaluatedLayout._values,T={layoutIconSize:x["icon-size"].possiblyEvaluate(new mn(p.bucket.zoom+1),p.canonical),layoutTextSize:x["text-size"].possiblyEvaluate(new mn(p.bucket.zoom+1),p.canonical),textMaxSize:x["text-size"].possiblyEvaluate(new mn(18))};if(p.bucket.textSizeData.kind==="composite"){const{minZoom:ae,maxZoom:se}=p.bucket.textSizeData;T.compositeTextSizes=[x["text-size"].possiblyEvaluate(new mn(ae),p.canonical),x["text-size"].possiblyEvaluate(new mn(se),p.canonical)]}if(p.bucket.iconSizeData.kind==="composite"){const{minZoom:ae,maxZoom:se}=p.bucket.iconSizeData;T.compositeIconSizes=[x["icon-size"].possiblyEvaluate(new mn(ae),p.canonical),x["icon-size"].possiblyEvaluate(new mn(se),p.canonical)]}const D=d.get("text-line-height")*ol,F=d.get("text-rotation-alignment")!=="viewport"&&d.get("symbol-placement")!=="point",V=d.get("text-keep-upright"),X=d.get("text-size");for(const ae of p.bucket.features){const se=d.get("text-font").evaluate(ae,{},p.canonical).join(","),ve=X.evaluate(ae,{},p.canonical),Le=T.layoutTextSize.evaluate(ae,{},p.canonical),ze=T.layoutIconSize.evaluate(ae,{},p.canonical),Ue={horizontal:{},vertical:void 0},Ze=ae.text;let st,wt=[0,0];if(Ze){const Ft=Ze.toString(),gr=d.get("text-letter-spacing").evaluate(ae,{},p.canonical)*ol,Cr=xr(Ft)?gr:0,Wr=d.get("text-anchor").evaluate(ae,{},p.canonical),yn=M6(c,ae,p.canonical);if(!yn){const ln=d.get("text-radial-offset").evaluate(ae,{},p.canonical);wt=ln?k6(Wr,[ln*ol,FC]):d.get("text-offset").evaluate(ae,{},p.canonical).map((fn=>fn*ol))}let an=F?"center":d.get("text-justify").evaluate(ae,{},p.canonical);const hn=d.get("symbol-placement")==="point"?d.get("text-max-width").evaluate(ae,{},p.canonical)*ol:1/0,Xn=()=>{p.bucket.allowVerticalPlacement&&Or(Ft)&&(Ue.vertical=Ix(Ze,p.glyphMap,p.glyphPositions,p.imagePositions,se,hn,D,Wr,"left",Cr,wt,s.ao.vertical,!0,Le,ve))};if(!F&&yn){const ln=new Set;if(an==="auto")for(let Dr=0;Dr<yn.values.length;Dr+=2)ln.add(BC(yn.values[Dr]));else ln.add(an);let fn=!1;for(const Dr of ln)if(!Ue.horizontal[Dr])if(fn)Ue.horizontal[Dr]=Ue.horizontal[0];else{const hi=Ix(Ze,p.glyphMap,p.glyphPositions,p.imagePositions,se,hn,D,"center",Dr,Cr,wt,s.ao.horizontal,!1,Le,ve);hi&&(Ue.horizontal[Dr]=hi,fn=hi.positionedLines.length===1)}Xn()}else{an==="auto"&&(an=BC(Wr));const ln=Ix(Ze,p.glyphMap,p.glyphPositions,p.imagePositions,se,hn,D,Wr,an,Cr,wt,s.ao.horizontal,!1,Le,ve);ln&&(Ue.horizontal[an]=ln),Xn(),Or(Ft)&&F&&V&&(Ue.vertical=Ix(Ze,p.glyphMap,p.glyphPositions,p.imagePositions,se,hn,D,Wr,an,Cr,wt,s.ao.vertical,!1,Le,ve))}}let Wt=!1;if(ae.icon&&ae.icon.name){const Ft=p.imageMap[ae.icon.name];Ft&&(st=Une(p.imagePositions[ae.icon.name],d.get("icon-offset").evaluate(ae,{},p.canonical),d.get("icon-anchor").evaluate(ae,{},p.canonical)),Wt=!!Ft.sdf,p.bucket.sdfIcons===void 0?p.bucket.sdfIcons=Wt:p.bucket.sdfIcons!==Wt&&at("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(Ft.pixelRatio!==p.bucket.pixelRatio||d.get("icon-rotate").constantOr(1)!==0)&&(p.bucket.iconsNeedLinear=!0))}const Rt=O6(Ue.horizontal)||Ue.vertical;p.bucket.iconsInText=!!Rt&&Rt.iconsInText,(Rt||st)&&nie(p.bucket,ae,Ue,st,p.imageMap,T,Le,ze,wt,Wt,p.canonical,p.subdivisionGranularity)}p.showCollisionBoxes&&p.bucket.generateCollisionDebugBuffers()},s.cI=SC,s.cJ=bC,s.cK=wC,s.cL=DD,s.cM=TC,s.cN=class{constructor(p){this._marks={start:[p.url,"start"].join("#"),end:[p.url,"end"].join("#"),measure:p.url.toString()},performance.mark(this._marks.start)}finish(){performance.mark(this._marks.end);let p=performance.getEntriesByName(this._marks.measure);return p.length===0&&(performance.measure(this._marks.measure,this._marks.start,this._marks.end),p=performance.getEntriesByName(this._marks.measure),performance.clearMarks(this._marks.start),performance.clearMarks(this._marks.end),performance.clearMeasures(this._marks.measure)),p}},s.cO=function(p,c,d,x,T){return o(this,void 0,void 0,(function*(){if(k())try{return yield yr(p,c,d,x,T)}catch{}return(function(D,F,V,X,ae){const se=D.width,ve=D.height;_r&&cr||(_r=new OffscreenCanvas(se,ve),cr=_r.getContext("2d",{willReadFrequently:!0})),_r.width=se,_r.height=ve,cr.drawImage(D,0,0,se,ve);const Le=cr.getImageData(F,V,X,ae);return cr.clearRect(0,0,se,ve),Le.data})(p,c,d,x,T)}))},s.cP=ED,s.cQ=h,s.cR=ND,s.cS=dy,s.cT=ch,s.cU=function(p,c){const d=new Map;if(p!=null)if(p.type==="Feature")d.set(c_(p,c),p);else for(const x of p.features)d.set(c_(x,c),x);return d},s.cV=function(p,c){if(p==null)return!0;if(p.type==="Feature")return c_(p,c)!=null;if(p.type==="FeatureCollection"){const d=new Set;for(const x of p.features){const T=c_(x,c);if(T==null||d.has(T))return!1;d.add(T)}return!0}return!1},s.cW=function(p,c,d){var x,T,D,F;if(c.removeAll&&p.clear(),c.remove)for(const V of c.remove)p.delete(V);if(c.add)for(const V of c.add){const X=c_(V,d);X!=null&&p.set(X,V)}if(c.update)for(const V of c.update){let X=p.get(V.id);if(X==null)continue;const ae=!V.removeAllProperties&&(((x=V.removeProperties)===null||x===void 0?void 0:x.length)>0||((T=V.addOrUpdateProperties)===null||T===void 0?void 0:T.length)>0);if((V.newGeometry||V.removeAllProperties||ae)&&(X=Object.assign({},X),p.set(V.id,X),ae&&(X.properties=Object.assign({},X.properties))),V.newGeometry&&(X.geometry=V.newGeometry),V.removeAllProperties)X.properties={};else if(((D=V.removeProperties)===null||D===void 0?void 0:D.length)>0)for(const se of V.removeProperties)Object.prototype.hasOwnProperty.call(X.properties,se)&&delete X.properties[se];if(((F=V.addOrUpdateProperties)===null||F===void 0?void 0:F.length)>0)for(const{key:se,value:ve}of V.addOrUpdateProperties)X.properties[se]=ve}},s.cX=yi,s.ca=function(p,c){return p[0]=c[0],p[1]=c[1],p[2]=c[2],p[3]=c[3],p[4]=c[4],p[5]=c[5],p[6]=c[6],p[7]=c[7],p[8]=c[8],p[9]=c[9],p[10]=c[10],p[11]=c[11],p[12]=c[12],p[13]=c[13],p[14]=c[14],p[15]=c[15],p},s.cb=p=>p.type==="symbol",s.cc=p=>p.type==="circle",s.cd=p=>p.type==="heatmap",s.ce=p=>p.type==="line",s.cf=p=>p.type==="fill",s.cg=p=>p.type==="fill-extrusion",s.ch=p=>p.type==="hillshade",s.ci=p=>p.type==="color-relief",s.cj=p=>p.type==="raster",s.ck=p=>p.type==="background",s.cl=p=>p.type==="custom",s.cm=xe,s.cn=function(p,c,d){const x=me(c.x-d.x,c.y-d.y),T=me(p.x-d.x,p.y-d.y);var D,F;return er(Math.atan2(x[0]*T[1]-x[1]*T[0],(D=x)[0]*(F=T)[0]+D[1]*F[1]))},s.co=Ne,s.cp=function(p,c){return Ar[c]&&(p instanceof MouseEvent||p instanceof WheelEvent)},s.cq=function(p,c){return lr[c]&&"touches"in p},s.cr=function(p){return lr[p]||Ar[p]},s.cs=function(p,c,d){var x=c[0],T=c[1];return p[0]=d[0]*x+d[4]*T+d[12],p[1]=d[1]*x+d[5]*T+d[13],p},s.ct=function(p,c){const{x:d,y:x}=u_.fromLngLat(c);return!(p<0||p>25||x<0||x>=1||d<0||d>=1)},s.cu=function(p,c){return p[0]=c[0],p[1]=0,p[2]=0,p[3]=0,p[4]=0,p[5]=c[1],p[6]=0,p[7]=0,p[8]=0,p[9]=0,p[10]=c[2],p[11]=0,p[12]=0,p[13]=0,p[14]=0,p[15]=1,p},s.cv=class extends es{},s.cw=aie,s.cy=function(p){return p.message===ir},s.cz=Qe,s.d=Lt,s.e=De,s.f=p=>o(void 0,void 0,void 0,(function*(){if(p.byteLength===0)return createImageBitmap(new ImageData(1,1));const c=new Blob([new Uint8Array(p)],{type:"image/png"});try{return createImageBitmap(c)}catch(d){throw new Error(`Could not load image because of ${d.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`)}})),s.g=be,s.h=p=>new Promise(((c,d)=>{const x=new Image;x.onload=()=>{c(x),URL.revokeObjectURL(x.src),x.onload=null,window.requestAnimationFrame((()=>{x.src=vt}))},x.onerror=()=>d(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const T=new Blob([new Uint8Array(p)],{type:"image/png"});x.src=p.byteLength?URL.createObjectURL(T):vt})),s.i=Xt,s.j=(p,c)=>et(De(p,{type:"json"}),c),s.k=Kt,s.l=Jt,s.m=et,s.n=(p,c)=>et(De(p,{type:"arrayBuffer"}),c),s.o=function(p){return new TC(p).readFields(kne,[])},s.p=YD,s.q=J0,s.r=ra,s.s=Er,s.t=ki,s.u=Ut,s.v=bt,s.w=at,s.x=$,s.y=He,s.z=jh})),i("worker",["./shared"],(function(s){class o{constructor(_e){this.keyCache={},_e&&this.replace(_e)}replace(_e){this._layerConfigs={},this._layers={},this.update(_e,[])}update(_e,be){for(const Qe of _e){this._layerConfigs[Qe.id]=Qe;const ot=this._layers[Qe.id]=s.bJ(Qe);ot._featureFilter=s.aa(ot.filter),this.keyCache[Qe.id]&&delete this.keyCache[Qe.id]}for(const Qe of be)delete this.keyCache[Qe],delete this._layerConfigs[Qe],delete this._layers[Qe];this.familiesBySource={};const qe=s.cC(Object.values(this._layerConfigs),this.keyCache);for(const Qe of qe){const ot=Qe.map((Kt=>this._layers[Kt.id])),et=ot[0];if(et.visibility==="none")continue;const Lt=et.source||"";let _t=this.familiesBySource[Lt];_t||(_t=this.familiesBySource[Lt]={});const jt=et.sourceLayer||"_geojsonTileLayer";let Jt=_t[jt];Jt||(Jt=_t[jt]=[]),Jt.push(ot)}}}class u{constructor(_e){const be={},qe=[];for(const Lt in _e){const _t=_e[Lt],jt=be[Lt]={};for(const Jt in _t){const Kt=_t[+Jt];if(!Kt||Kt.bitmap.width===0||Kt.bitmap.height===0)continue;const Rr={x:0,y:0,w:Kt.bitmap.width+2,h:Kt.bitmap.height+2};qe.push(Rr),jt[Jt]={rect:Rr,metrics:Kt.metrics}}}const{w:Qe,h:ot}=s.p(qe),et=new s.q({width:Qe||1,height:ot||1});for(const Lt in _e){const _t=_e[Lt];for(const jt in _t){const Jt=_t[+jt];if(!Jt||Jt.bitmap.width===0||Jt.bitmap.height===0)continue;const Kt=be[Lt][jt].rect;s.q.copy(Jt.bitmap,et,{x:0,y:0},{x:Kt.x+1,y:Kt.y+1},Jt.bitmap)}}this.image=et,this.positions=be}}s.cD("GlyphAtlas",u);class h{constructor(_e){this.tileID=new s.Z(_e.tileID.overscaledZ,_e.tileID.wrap,_e.tileID.canonical.z,_e.tileID.canonical.x,_e.tileID.canonical.y),this.uid=_e.uid,this.zoom=_e.zoom,this.pixelRatio=_e.pixelRatio,this.tileSize=_e.tileSize,this.source=_e.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=_e.showCollisionBoxes,this.collectResourceTiming=!!_e.collectResourceTiming,this.returnDependencies=!!_e.returnDependencies,this.promoteId=_e.promoteId,this.inFlightDependencies=[],this.globalState=_e.globalState}parse(_e,be,qe,Qe,ot){return s._(this,void 0,void 0,(function*(){this.status="parsing",this.data=_e,this.collisionBoxArray=new s.a8;const et=new s.cE(Object.keys(_e.layers).sort()),Lt=new s.cF(this.tileID,this.promoteId);Lt.bucketLayerIDs=[];const _t={},jt={featureIndex:Lt,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:qe,subdivisionGranularity:ot},Jt=be.familiesBySource[this.source];for(const Ae in Jt){const Be=_e.layers[Ae];if(!Be)continue;Be.version===1&&s.w(`Vector tile source "${this.source}" layer "${Ae}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const mt=et.encode(Ae),pt=[];for(let Ir=0;Ir<Be.length;Ir++){const Fr=Be.feature(Ir),qn=Lt.getId(Fr,Ae);pt.push({feature:Fr,id:qn,index:Ir,sourceLayerIndex:mt})}for(const Ir of Jt[Ae]){const Fr=Ir[0];Fr.source!==this.source&&s.w(`layer.source = ${Fr.source} does not equal this.source = ${this.source}`),Fr.minzoom&&this.zoom<Math.floor(Fr.minzoom)||Fr.maxzoom&&this.zoom>=Fr.maxzoom||Fr.visibility!=="none"&&(f(Ir,this.zoom,qe,this.globalState),(_t[Fr.id]=Fr.createBucket({index:Lt.bucketLayerIDs.length,layers:Ir,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:mt,sourceID:this.source,globalState:this.globalState})).populate(pt,jt,this.tileID.canonical),Lt.bucketLayerIDs.push(Ir.map((qn=>qn.id))))}}const Kt=s.bN(jt.glyphDependencies,(Ae=>Object.keys(Ae).map(Number)));this.inFlightDependencies.forEach((Ae=>Ae?.abort())),this.inFlightDependencies=[];let Rr=Promise.resolve({});if(Object.keys(Kt).length){const Ae=new AbortController;this.inFlightDependencies.push(Ae),Rr=Qe.sendAsync({type:"GG",data:{stacks:Kt,source:this.source,tileID:this.tileID,type:"glyphs"}},Ae)}const bt=Object.keys(jt.iconDependencies);let Tr=Promise.resolve({});if(bt.length){const Ae=new AbortController;this.inFlightDependencies.push(Ae),Tr=Qe.sendAsync({type:"GI",data:{icons:bt,source:this.source,tileID:this.tileID,type:"icons"}},Ae)}const Ur=Object.keys(jt.patternDependencies);let Gr=Promise.resolve({});if(Ur.length){const Ae=new AbortController;this.inFlightDependencies.push(Ae),Gr=Qe.sendAsync({type:"GI",data:{icons:Ur,source:this.source,tileID:this.tileID,type:"patterns"}},Ae)}const[Jr,ar,ti]=yield Promise.all([Rr,Tr,Gr]),un=new u(Jr),ri=new s.cG(ar,ti);for(const Ae in _t){const Be=_t[Ae];Be instanceof s.a9?(f(Be.layers,this.zoom,qe,this.globalState),s.cH({bucket:Be,glyphMap:Jr,glyphPositions:un.positions,imageMap:ar,imagePositions:ri.iconPositions,showCollisionBoxes:this.showCollisionBoxes,canonical:this.tileID.canonical,subdivisionGranularity:jt.subdivisionGranularity})):Be.hasPattern&&(Be instanceof s.cI||Be instanceof s.cJ||Be instanceof s.cK)&&(f(Be.layers,this.zoom,qe,this.globalState),Be.addFeatures(jt,this.tileID.canonical,ri.patternPositions))}return this.status="done",{buckets:Object.values(_t).filter((Ae=>!Ae.isEmpty())),featureIndex:Lt,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:un.image,imageAtlas:ri,glyphMap:this.returnDependencies?Jr:null,iconMap:this.returnDependencies?ar:null,glyphPositions:this.returnDependencies?un.positions:null}}))}}function f(nt,_e,be,qe){const Qe=new s.F(_e);for(const ot of nt)ot.setGlobalState(qe),ot.recalculate(Qe,be)}class g{constructor(_e,be,qe){this.actor=_e,this.layerIndex=be,this.availableImages=qe,this.fetching={},this.loading={},this.loaded={}}loadVectorTile(_e,be){return s._(this,void 0,void 0,(function*(){const qe=yield s.n(_e.request,be);try{return{vectorTile:new s.cL(new s.cM(qe.data)),rawData:qe.data,cacheControl:qe.cacheControl,expires:qe.expires}}catch(Qe){const ot=new Uint8Array(qe.data);let et=`Unable to parse the tile at ${_e.request.url}, `;throw et+=ot[0]===31&&ot[1]===139?"please make sure the data is not gzipped and that you have configured the relevant header in the server":`got error: ${Qe.message}`,new Error(et)}}))}loadTile(_e){return s._(this,void 0,void 0,(function*(){const be=_e.uid,qe=!!(_e&&_e.request&&_e.request.collectResourceTiming)&&new s.cN(_e.request),Qe=new h(_e);this.loading[be]=Qe;const ot=new AbortController;Qe.abort=ot;try{const et=yield this.loadVectorTile(_e,ot);if(delete this.loading[be],!et)return null;const Lt=et.rawData,_t={};et.expires&&(_t.expires=et.expires),et.cacheControl&&(_t.cacheControl=et.cacheControl);const jt={};if(qe){const Kt=qe.finish();Kt&&(jt.resourceTiming=JSON.parse(JSON.stringify(Kt)))}Qe.vectorTile=et.vectorTile;const Jt=Qe.parse(et.vectorTile,this.layerIndex,this.availableImages,this.actor,_e.subdivisionGranularity);this.loaded[be]=Qe,this.fetching[be]={rawTileData:Lt,cacheControl:_t,resourceTiming:jt};try{const Kt=yield Jt;return s.e({rawTileData:Lt.slice(0)},Kt,_t,jt)}finally{delete this.fetching[be]}}catch(et){throw delete this.loading[be],Qe.status="done",this.loaded[be]=Qe,et}}))}reloadTile(_e){return s._(this,void 0,void 0,(function*(){const be=_e.uid;if(!this.loaded||!this.loaded[be])throw new Error("Should not be trying to reload a tile that was never loaded or has been removed");const qe=this.loaded[be];if(qe.showCollisionBoxes=_e.showCollisionBoxes,qe.globalState=_e.globalState,qe.status==="parsing"){const Qe=yield qe.parse(qe.vectorTile,this.layerIndex,this.availableImages,this.actor,_e.subdivisionGranularity);let ot;if(this.fetching[be]){const{rawTileData:et,cacheControl:Lt,resourceTiming:_t}=this.fetching[be];delete this.fetching[be],ot=s.e({rawTileData:et.slice(0)},Qe,Lt,_t)}else ot=Qe;return ot}if(qe.status==="done"&&qe.vectorTile)return qe.parse(qe.vectorTile,this.layerIndex,this.availableImages,this.actor,_e.subdivisionGranularity)}))}abortTile(_e){return s._(this,void 0,void 0,(function*(){const be=this.loading,qe=_e.uid;be&&be[qe]&&be[qe].abort&&(be[qe].abort.abort(),delete be[qe])}))}removeTile(_e){return s._(this,void 0,void 0,(function*(){this.loaded&&this.loaded[_e.uid]&&delete this.loaded[_e.uid]}))}}class b{constructor(){this.loaded={}}loadTile(_e){return s._(this,void 0,void 0,(function*(){const{uid:be,encoding:qe,rawImageData:Qe,redFactor:ot,greenFactor:et,blueFactor:Lt,baseShift:_t}=_e,jt=Qe.width+2,Jt=Qe.height+2,Kt=s.b(Qe)?new s.R({width:jt,height:Jt},yield s.cO(Qe,-1,-1,jt,Jt)):Qe,Rr=new s.cP(be,Kt,qe,ot,et,Lt,_t);return this.loaded=this.loaded||{},this.loaded[be]=Rr,Rr}))}removeTile(_e){const be=this.loaded,qe=_e.uid;be&&be[qe]&&delete be[qe]}}var v,S,E=(function(){if(S)return v;function nt(be,qe){if(be.length!==0){_e(be[0],qe);for(var Qe=1;Qe<be.length;Qe++)_e(be[Qe],!qe)}}function _e(be,qe){for(var Qe=0,ot=0,et=0,Lt=be.length,_t=Lt-1;et<Lt;_t=et++){var jt=(be[et][0]-be[_t][0])*(be[_t][1]+be[et][1]),Jt=Qe+jt;ot+=Math.abs(Qe)>=Math.abs(jt)?Qe-Jt+jt:jt-Jt+Qe,Qe=Jt}Qe+ot>=0!=!!qe&&be.reverse()}return S=1,v=function be(qe,Qe){var ot,et=qe&&qe.type;if(et==="FeatureCollection")for(ot=0;ot<qe.features.length;ot++)be(qe.features[ot],Qe);else if(et==="GeometryCollection")for(ot=0;ot<qe.geometries.length;ot++)be(qe.geometries[ot],Qe);else if(et==="Feature")be(qe.geometry,Qe);else if(et==="Polygon")nt(qe.coordinates,Qe);else if(et==="MultiPolygon")for(ot=0;ot<qe.coordinates.length;ot++)nt(qe.coordinates[ot],Qe);return qe}})(),P=s.cQ(E);class k extends s.cS{constructor(_e,be){super(new s.cM,0,be,[],[]),this.feature=_e,this.type=_e.type,this.properties=_e.tags?_e.tags:{},"id"in _e&&(typeof _e.id=="string"?this.id=parseInt(_e.id,10):typeof _e.id!="number"||isNaN(_e.id)||(this.id=_e.id))}loadGeometry(){const _e=[],be=this.feature.type===1?[this.feature.geometry]:this.feature.geometry;for(const qe of be){const Qe=[];for(const ot of qe)Qe.push(new s.P(ot[0],ot[1]));_e.push(Qe)}return _e}}class L extends s.cR{constructor(_e,be){super(new s.cM),this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.version=be?be.version:1,this.extent=be?be.extent:4096,this.length=_e.length,this.features=_e}feature(_e){return new k(this.features[_e],this.extent)}}function O(nt,_e){_e.writeVarintField(15,nt.version||1),_e.writeStringField(1,nt.name||""),_e.writeVarintField(5,nt.extent||4096);const be={keys:[],values:[],keycache:{},valuecache:{}};for(let ot=0;ot<nt.length;ot++)be.feature=nt.feature(ot),_e.writeMessage(2,M,be);const qe=be.keys;for(const ot of qe)_e.writeStringField(3,ot);const Qe=be.values;for(const ot of Qe)_e.writeMessage(4,G,ot)}function M(nt,_e){if(!nt.feature)return;const be=nt.feature;be.id!==void 0&&_e.writeVarintField(1,be.id),_e.writeMessage(2,z,nt),_e.writeVarintField(3,be.type),_e.writeMessage(4,W,be)}function z(nt,_e){for(const be in nt.feature?.properties){let qe=nt.feature.properties[be],Qe=nt.keycache[be];if(qe===null)continue;Qe===void 0&&(nt.keys.push(be),Qe=nt.keys.length-1,nt.keycache[be]=Qe),_e.writeVarint(Qe),typeof qe!="string"&&typeof qe!="boolean"&&typeof qe!="number"&&(qe=JSON.stringify(qe));const ot=typeof qe+":"+qe;let et=nt.valuecache[ot];et===void 0&&(nt.values.push(qe),et=nt.values.length-1,nt.valuecache[ot]=et),_e.writeVarint(et)}}function B(nt,_e){return(_e<<3)+(7&nt)}function q(nt){return nt<<1^nt>>31}function W(nt,_e){const be=nt.loadGeometry(),qe=nt.type;let Qe=0,ot=0;for(const et of be){let Lt=1;qe===1&&(Lt=et.length),_e.writeVarint(B(1,Lt));const _t=qe===3?et.length-1:et.length;for(let jt=0;jt<_t;jt++){jt===1&&qe!==1&&_e.writeVarint(B(2,_t-1));const Jt=et[jt].x-Qe,Kt=et[jt].y-ot;_e.writeVarint(q(Jt)),_e.writeVarint(q(Kt)),Qe+=Jt,ot+=Kt}nt.type===3&&_e.writeVarint(B(7,1))}}function G(nt,_e){const be=typeof nt;be==="string"?_e.writeStringField(1,nt):be==="boolean"?_e.writeBooleanField(7,nt):be==="number"&&(nt%1!=0?_e.writeDoubleField(3,nt):nt<0?_e.writeSVarintField(6,nt):_e.writeVarintField(5,nt))}const ie={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:nt=>nt},Q=Math.fround||(H=new Float32Array(1),nt=>(H[0]=+nt,H[0]));var H;class ne{constructor(_e){this.options=Object.assign(Object.create(ie),_e),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(_e){const{log:be,minZoom:qe,maxZoom:Qe}=this.options;be&&console.time("total time");const ot=`prepare ${_e.length} points`;be&&console.time(ot),this.points=_e;const et=[];for(let _t=0;_t<_e.length;_t++){const jt=_e[_t];if(!jt.geometry)continue;const[Jt,Kt]=jt.geometry.coordinates,Rr=Q(fe(Jt)),bt=Q(Me(Kt));et.push(Rr,bt,1/0,_t,-1,1),this.options.reduce&&et.push(0)}let Lt=this.trees[Qe+1]=this._createTree(et);be&&console.timeEnd(ot);for(let _t=Qe;_t>=qe;_t--){const jt=+Date.now();Lt=this.trees[_t]=this._createTree(this._cluster(Lt,_t)),be&&console.log("z%d: %d clusters in %dms",_t,Lt.numItems,+Date.now()-jt)}return be&&console.timeEnd("total time"),this}getClusters(_e,be){let qe=((_e[0]+180)%360+360)%360-180;const Qe=Math.max(-90,Math.min(90,_e[1]));let ot=_e[2]===180?180:((_e[2]+180)%360+360)%360-180;const et=Math.max(-90,Math.min(90,_e[3]));if(_e[2]-_e[0]>=360)qe=-180,ot=180;else if(qe>ot){const Kt=this.getClusters([qe,Qe,180,et],be),Rr=this.getClusters([-180,Qe,ot,et],be);return Kt.concat(Rr)}const Lt=this.trees[this._limitZoom(be)],_t=Lt.range(fe(qe),Me(et),fe(ot),Me(Qe)),jt=Lt.data,Jt=[];for(const Kt of _t){const Rr=this.stride*Kt;Jt.push(jt[Rr+5]>1?oe(jt,Rr,this.clusterProps):this.points[jt[Rr+3]])}return Jt}getChildren(_e){const be=this._getOriginId(_e),qe=this._getOriginZoom(_e),Qe="No cluster with the specified id.",ot=this.trees[qe];if(!ot)throw new Error(Qe);const et=ot.data;if(be*this.stride>=et.length)throw new Error(Qe);const Lt=this.options.radius/(this.options.extent*Math.pow(2,qe-1)),_t=ot.within(et[be*this.stride],et[be*this.stride+1],Lt),jt=[];for(const Jt of _t){const Kt=Jt*this.stride;et[Kt+4]===_e&&jt.push(et[Kt+5]>1?oe(et,Kt,this.clusterProps):this.points[et[Kt+3]])}if(jt.length===0)throw new Error(Qe);return jt}getLeaves(_e,be,qe){const Qe=[];return this._appendLeaves(Qe,_e,be=be||10,qe=qe||0,0),Qe}getTile(_e,be,qe){const Qe=this.trees[this._limitZoom(_e)],ot=Math.pow(2,_e),{extent:et,radius:Lt}=this.options,_t=Lt/et,jt=(qe-_t)/ot,Jt=(qe+1+_t)/ot,Kt={features:[]};return this._addTileFeatures(Qe.range((be-_t)/ot,jt,(be+1+_t)/ot,Jt),Qe.data,be,qe,ot,Kt),be===0&&this._addTileFeatures(Qe.range(1-_t/ot,jt,1,Jt),Qe.data,ot,qe,ot,Kt),be===ot-1&&this._addTileFeatures(Qe.range(0,jt,_t/ot,Jt),Qe.data,-1,qe,ot,Kt),Kt.features.length?Kt:null}getClusterExpansionZoom(_e){let be=this._getOriginZoom(_e)-1;for(;be<=this.options.maxZoom;){const qe=this.getChildren(_e);if(be++,qe.length!==1)break;_e=qe[0].properties.cluster_id}return be}_appendLeaves(_e,be,qe,Qe,ot){const et=this.getChildren(be);for(const Lt of et){const _t=Lt.properties;if(_t&&_t.cluster?ot+_t.point_count<=Qe?ot+=_t.point_count:ot=this._appendLeaves(_e,_t.cluster_id,qe,Qe,ot):ot<Qe?ot++:_e.push(Lt),_e.length===qe)break}return ot}_createTree(_e){const be=new s.aI(_e.length/this.stride|0,this.options.nodeSize,Float32Array);for(let qe=0;qe<_e.length;qe+=this.stride)be.add(_e[qe],_e[qe+1]);return be.finish(),be.data=_e,be}_addTileFeatures(_e,be,qe,Qe,ot,et){for(const Lt of _e){const _t=Lt*this.stride,jt=be[_t+5]>1;let Jt,Kt,Rr;if(jt)Jt=ce(be,_t,this.clusterProps),Kt=be[_t],Rr=be[_t+1];else{const Ur=this.points[be[_t+3]];Jt=Ur.properties;const[Gr,Jr]=Ur.geometry.coordinates;Kt=fe(Gr),Rr=Me(Jr)}const bt={type:1,geometry:[[Math.round(this.options.extent*(Kt*ot-qe)),Math.round(this.options.extent*(Rr*ot-Qe))]],tags:Jt};let Tr;Tr=jt||this.options.generateId?be[_t+3]:this.points[be[_t+3]].id,Tr!==void 0&&(bt.id=Tr),et.features.push(bt)}}_limitZoom(_e){return Math.max(this.options.minZoom,Math.min(Math.floor(+_e),this.options.maxZoom+1))}_cluster(_e,be){const{radius:qe,extent:Qe,reduce:ot,minPoints:et}=this.options,Lt=qe/(Qe*Math.pow(2,be)),_t=_e.data,jt=[],Jt=this.stride;for(let Kt=0;Kt<_t.length;Kt+=Jt){if(_t[Kt+2]<=be)continue;_t[Kt+2]=be;const Rr=_t[Kt],bt=_t[Kt+1],Tr=_e.within(_t[Kt],_t[Kt+1],Lt),Ur=_t[Kt+5];let Gr=Ur;for(const Jr of Tr){const ar=Jr*Jt;_t[ar+2]>be&&(Gr+=_t[ar+5])}if(Gr>Ur&&Gr>=et){let Jr,ar=Rr*Ur,ti=bt*Ur,un=-1;const ri=(Kt/Jt<<5)+(be+1)+this.points.length;for(const Ae of Tr){const Be=Ae*Jt;if(_t[Be+2]<=be)continue;_t[Be+2]=be;const mt=_t[Be+5];ar+=_t[Be]*mt,ti+=_t[Be+1]*mt,_t[Be+4]=ri,ot&&(Jr||(Jr=this._map(_t,Kt,!0),un=this.clusterProps.length,this.clusterProps.push(Jr)),ot(Jr,this._map(_t,Be)))}_t[Kt+4]=ri,jt.push(ar/Gr,ti/Gr,1/0,ri,-1,Gr),ot&&jt.push(un)}else{for(let Jr=0;Jr<Jt;Jr++)jt.push(_t[Kt+Jr]);if(Gr>1)for(const Jr of Tr){const ar=Jr*Jt;if(!(_t[ar+2]<=be)){_t[ar+2]=be;for(let ti=0;ti<Jt;ti++)jt.push(_t[ar+ti])}}}}return jt}_getOriginId(_e){return _e-this.points.length>>5}_getOriginZoom(_e){return(_e-this.points.length)%32}_map(_e,be,qe){if(_e[be+5]>1){const et=this.clusterProps[_e[be+6]];return qe?Object.assign({},et):et}const Qe=this.points[_e[be+3]].properties,ot=this.options.map(Qe);return qe&&ot===Qe?Object.assign({},ot):ot}}function oe(nt,_e,be){return{type:"Feature",id:nt[_e+3],properties:ce(nt,_e,be),geometry:{type:"Point",coordinates:[(qe=nt[_e],360*(qe-.5)),me(nt[_e+1])]}};var qe}function ce(nt,_e,be){const qe=nt[_e+5],Qe=qe>=1e4?`${Math.round(qe/1e3)}k`:qe>=1e3?Math.round(qe/100)/10+"k":qe,ot=nt[_e+6],et=ot===-1?{}:Object.assign({},be[ot]);return Object.assign(et,{cluster:!0,cluster_id:nt[_e+3],point_count:qe,point_count_abbreviated:Qe})}function fe(nt){return nt/360+.5}function Me(nt){const _e=Math.sin(nt*Math.PI/180),be=.5-.25*Math.log((1+_e)/(1-_e))/Math.PI;return be<0?0:be>1?1:be}function me(nt){const _e=(180-360*nt)*Math.PI/180;return 360*Math.atan(Math.exp(_e))/Math.PI-90}function we(nt,_e,be,qe){let Qe=qe;const ot=_e+(be-_e>>1);let et,Lt=be-_e;const _t=nt[_e],jt=nt[_e+1],Jt=nt[be],Kt=nt[be+1];for(let Rr=_e+3;Rr<be;Rr+=3){const bt=Te(nt[Rr],nt[Rr+1],_t,jt,Jt,Kt);if(bt>Qe)et=Rr,Qe=bt;else if(bt===Qe){const Tr=Math.abs(Rr-ot);Tr<Lt&&(et=Rr,Lt=Tr)}}Qe>qe&&(et-_e>3&&we(nt,_e,et,qe),nt[et+2]=Qe,be-et>3&&we(nt,et,be,qe))}function Te(nt,_e,be,qe,Qe,ot){let et=Qe-be,Lt=ot-qe;if(et!==0||Lt!==0){const _t=((nt-be)*et+(_e-qe)*Lt)/(et*et+Lt*Lt);_t>1?(be=Qe,qe=ot):_t>0&&(be+=et*_t,qe+=Lt*_t)}return et=nt-be,Lt=_e-qe,et*et+Lt*Lt}function ke(nt,_e,be,qe){const Qe={id:nt??null,type:_e,geometry:be,tags:qe,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};if(_e==="Point"||_e==="MultiPoint"||_e==="LineString")he(Qe,be);else if(_e==="Polygon")he(Qe,be[0]);else if(_e==="MultiLineString")for(const ot of be)he(Qe,ot);else if(_e==="MultiPolygon")for(const ot of be)he(Qe,ot[0]);return Qe}function he(nt,_e){for(let be=0;be<_e.length;be+=3)nt.minX=Math.min(nt.minX,_e[be]),nt.minY=Math.min(nt.minY,_e[be+1]),nt.maxX=Math.max(nt.maxX,_e[be]),nt.maxY=Math.max(nt.maxY,_e[be+1])}function Ee(nt,_e,be,qe){if(!_e.geometry)return;const Qe=_e.geometry.coordinates;if(Qe&&Qe.length===0)return;const ot=_e.geometry.type,et=Math.pow(be.tolerance/((1<<be.maxZoom)*be.extent),2);let Lt=[],_t=_e.id;if(be.promoteId?_t=_e.properties[be.promoteId]:be.generateId&&(_t=qe||0),ot==="Point")xe(Qe,Lt);else if(ot==="MultiPoint")for(const jt of Qe)xe(jt,Lt);else if(ot==="LineString")Ne(Qe,Lt,et,!1);else if(ot==="MultiLineString"){if(be.lineMetrics){for(const jt of Qe)Lt=[],Ne(jt,Lt,et,!1),nt.push(ke(_t,"LineString",Lt,_e.properties));return}Oe(Qe,Lt,et,!1)}else if(ot==="Polygon")Oe(Qe,Lt,et,!0);else{if(ot!=="MultiPolygon"){if(ot==="GeometryCollection"){for(const jt of _e.geometry.geometries)Ee(nt,{id:_t,geometry:jt,properties:_e.properties},be,qe);return}throw new Error("Input data is not a valid GeoJSON object.")}for(const jt of Qe){const Jt=[];Oe(jt,Jt,et,!0),Lt.push(Jt)}}nt.push(ke(_t,ot,Lt,_e.properties))}function xe(nt,_e){_e.push($e(nt[0]),De(nt[1]),0)}function Ne(nt,_e,be,qe){let Qe,ot,et=0;for(let _t=0;_t<nt.length;_t++){const jt=$e(nt[_t][0]),Jt=De(nt[_t][1]);_e.push(jt,Jt,0),_t>0&&(et+=qe?(Qe*Jt-jt*ot)/2:Math.sqrt(Math.pow(jt-Qe,2)+Math.pow(Jt-ot,2))),Qe=jt,ot=Jt}const Lt=_e.length-3;_e[2]=1,we(_e,0,Lt,be),_e[Lt+2]=1,_e.size=Math.abs(et),_e.start=0,_e.end=_e.size}function Oe(nt,_e,be,qe){for(let Qe=0;Qe<nt.length;Qe++){const ot=[];Ne(nt[Qe],ot,be,qe),_e.push(ot)}}function $e(nt){return nt/360+.5}function De(nt){const _e=Math.sin(nt*Math.PI/180),be=.5-.25*Math.log((1+_e)/(1-_e))/Math.PI;return be<0?0:be>1?1:be}function it(nt,_e,be,qe,Qe,ot,et,Lt){if(qe/=_e,ot>=(be/=_e)&&et<qe)return nt;if(et<be||ot>=qe)return null;const _t=[];for(const jt of nt){const Jt=jt.geometry;let Kt=jt.type;const Rr=Qe===0?jt.minX:jt.minY,bt=Qe===0?jt.maxX:jt.maxY;if(Rr>=be&&bt<qe){_t.push(jt);continue}if(bt<be||Rr>=qe)continue;let Tr=[];if(Kt==="Point"||Kt==="MultiPoint")Ye(Jt,Tr,be,qe,Qe);else if(Kt==="LineString")rt(Jt,Tr,be,qe,Qe,!1,Lt.lineMetrics);else if(Kt==="MultiLineString")Mt(Jt,Tr,be,qe,Qe,!1);else if(Kt==="Polygon")Mt(Jt,Tr,be,qe,Qe,!0);else if(Kt==="MultiPolygon")for(const Ur of Jt){const Gr=[];Mt(Ur,Gr,be,qe,Qe,!0),Gr.length&&Tr.push(Gr)}if(Tr.length){if(Lt.lineMetrics&&Kt==="LineString"){for(const Ur of Tr)_t.push(ke(jt.id,Kt,Ur,jt.tags));continue}Kt!=="LineString"&&Kt!=="MultiLineString"||(Tr.length===1?(Kt="LineString",Tr=Tr[0]):Kt="MultiLineString"),Kt!=="Point"&&Kt!=="MultiPoint"||(Kt=Tr.length===3?"Point":"MultiPoint"),_t.push(ke(jt.id,Kt,Tr,jt.tags))}}return _t.length?_t:null}function Ye(nt,_e,be,qe,Qe){for(let ot=0;ot<nt.length;ot+=3){const et=nt[ot+Qe];et>=be&&et<=qe&&at(_e,nt[ot],nt[ot+1],nt[ot+2])}}function rt(nt,_e,be,qe,Qe,ot,et){let Lt=Ie(nt);const _t=Qe===0?je:Xt;let jt,Jt,Kt=nt.start;for(let Gr=0;Gr<nt.length-3;Gr+=3){const Jr=nt[Gr],ar=nt[Gr+1],ti=nt[Gr+2],un=nt[Gr+3],ri=nt[Gr+4],Ae=Qe===0?Jr:ar,Be=Qe===0?un:ri;let mt=!1;et&&(jt=Math.sqrt(Math.pow(Jr-un,2)+Math.pow(ar-ri,2))),Ae<be?Be>be&&(Jt=_t(Lt,Jr,ar,un,ri,be),et&&(Lt.start=Kt+jt*Jt)):Ae>qe?Be<qe&&(Jt=_t(Lt,Jr,ar,un,ri,qe),et&&(Lt.start=Kt+jt*Jt)):at(Lt,Jr,ar,ti),Be<be&&Ae>=be&&(Jt=_t(Lt,Jr,ar,un,ri,be),mt=!0),Be>qe&&Ae<=qe&&(Jt=_t(Lt,Jr,ar,un,ri,qe),mt=!0),!ot&&mt&&(et&&(Lt.end=Kt+jt*Jt),_e.push(Lt),Lt=Ie(nt)),et&&(Kt+=jt)}let Rr=nt.length-3;const bt=nt[Rr],Tr=nt[Rr+1],Ur=Qe===0?bt:Tr;Ur>=be&&Ur<=qe&&at(Lt,bt,Tr,nt[Rr+2]),Rr=Lt.length-3,ot&&Rr>=3&&(Lt[Rr]!==Lt[0]||Lt[Rr+1]!==Lt[1])&&at(Lt,Lt[0],Lt[1],Lt[2]),Lt.length&&_e.push(Lt)}function Ie(nt){const _e=[];return _e.size=nt.size,_e.start=nt.start,_e.end=nt.end,_e}function Mt(nt,_e,be,qe,Qe,ot){for(const et of nt)rt(et,_e,be,qe,Qe,ot,!1)}function at(nt,_e,be,qe){nt.push(_e,be,qe)}function je(nt,_e,be,qe,Qe,ot){const et=(ot-_e)/(qe-_e);return at(nt,ot,be+(Qe-be)*et,1),et}function Xt(nt,_e,be,qe,Qe,ot){const et=(ot-be)/(Qe-be);return at(nt,_e+(qe-_e)*et,ot,1),et}function Yt(nt,_e){const be=[];for(let qe=0;qe<nt.length;qe++){const Qe=nt[qe],ot=Qe.type;let et;if(ot==="Point"||ot==="MultiPoint"||ot==="LineString")et=pr(Qe.geometry,_e);else if(ot==="MultiLineString"||ot==="Polygon"){et=[];for(const Lt of Qe.geometry)et.push(pr(Lt,_e))}else if(ot==="MultiPolygon"){et=[];for(const Lt of Qe.geometry){const _t=[];for(const jt of Lt)_t.push(pr(jt,_e));et.push(_t)}}be.push(ke(Qe.id,ot,et,Qe.tags))}return be}function pr(nt,_e){const be=[];be.size=nt.size,nt.start!==void 0&&(be.start=nt.start,be.end=nt.end);for(let qe=0;qe<nt.length;qe+=3)be.push(nt[qe]+_e,nt[qe+1],nt[qe+2]);return be}function vt(nt,_e){if(nt.transformed)return nt;const be=1<<nt.z,qe=nt.x,Qe=nt.y;for(const ot of nt.features){const et=ot.geometry,Lt=ot.type;if(ot.geometry=[],Lt===1)for(let _t=0;_t<et.length;_t+=2)ot.geometry.push(yr(et[_t],et[_t+1],_e,be,qe,Qe));else for(let _t=0;_t<et.length;_t++){const jt=[];for(let Jt=0;Jt<et[_t].length;Jt+=2)jt.push(yr(et[_t][Jt],et[_t][Jt+1],_e,be,qe,Qe));ot.geometry.push(jt)}}return nt.transformed=!0,nt}function yr(nt,_e,be,qe,Qe,ot){return[Math.round(be*(nt*qe-Qe)),Math.round(be*(_e*qe-ot))]}function _r(nt,_e,be,qe,Qe){const ot=_e===Qe.maxZoom?0:Qe.tolerance/((1<<_e)*Qe.extent),et={features:[],numPoints:0,numSimplified:0,numFeatures:nt.length,source:null,x:be,y:qe,z:_e,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0};for(const Lt of nt)cr(et,Lt,ot,Qe);return et}function cr(nt,_e,be,qe){const Qe=_e.geometry,ot=_e.type,et=[];if(nt.minX=Math.min(nt.minX,_e.minX),nt.minY=Math.min(nt.minY,_e.minY),nt.maxX=Math.max(nt.maxX,_e.maxX),nt.maxY=Math.max(nt.maxY,_e.maxY),ot==="Point"||ot==="MultiPoint")for(let Lt=0;Lt<Qe.length;Lt+=3)et.push(Qe[Lt],Qe[Lt+1]),nt.numPoints++,nt.numSimplified++;else if(ot==="LineString")Er(et,Qe,nt,be,!1,!1);else if(ot==="MultiLineString"||ot==="Polygon")for(let Lt=0;Lt<Qe.length;Lt++)Er(et,Qe[Lt],nt,be,ot==="Polygon",Lt===0);else if(ot==="MultiPolygon")for(let Lt=0;Lt<Qe.length;Lt++){const _t=Qe[Lt];for(let jt=0;jt<_t.length;jt++)Er(et,_t[jt],nt,be,!0,jt===0)}if(et.length){let Lt=_e.tags||null;if(ot==="LineString"&&qe.lineMetrics){Lt={};for(const jt in _e.tags)Lt[jt]=_e.tags[jt];Lt.mapbox_clip_start=Qe.start/Qe.size,Lt.mapbox_clip_end=Qe.end/Qe.size}const _t={geometry:et,type:ot==="Polygon"||ot==="MultiPolygon"?3:ot==="LineString"||ot==="MultiLineString"?2:1,tags:Lt};_e.id!==null&&(_t.id=_e.id),nt.features.push(_t)}}function Er(nt,_e,be,qe,Qe,ot){const et=qe*qe;if(qe>0&&_e.size<(Qe?et:qe))return void(be.numPoints+=_e.length/3);const Lt=[];for(let _t=0;_t<_e.length;_t+=3)(qe===0||_e[_t+2]>et)&&(be.numSimplified++,Lt.push(_e[_t],_e[_t+1])),be.numPoints++;Qe&&(function(_t,jt){let Jt=0;for(let Kt=0,Rr=_t.length,bt=Rr-2;Kt<Rr;bt=Kt,Kt+=2)Jt+=(_t[Kt]-_t[bt])*(_t[Kt+1]+_t[bt+1]);if(Jt>0===jt)for(let Kt=0,Rr=_t.length;Kt<Rr/2;Kt+=2){const bt=_t[Kt],Tr=_t[Kt+1];_t[Kt]=_t[Rr-2-Kt],_t[Kt+1]=_t[Rr-1-Kt],_t[Rr-2-Kt]=bt,_t[Rr-1-Kt]=Tr}})(Lt,ot),nt.push(Lt)}const wr={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0};class er{constructor(_e,be){const qe=(be=this.options=(function(ot,et){for(const Lt in et)ot[Lt]=et[Lt];return ot})(Object.create(wr),be)).debug;if(qe&&console.time("preprocess data"),be.maxZoom<0||be.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(be.promoteId&&be.generateId)throw new Error("promoteId and generateId cannot be used together.");let Qe=(function(ot,et){const Lt=[];if(ot.type==="FeatureCollection")for(let _t=0;_t<ot.features.length;_t++)Ee(Lt,ot.features[_t],et,_t);else Ee(Lt,ot.type==="Feature"?ot:{geometry:ot},et);return Lt})(_e,be);this.tiles={},this.tileCoords=[],qe&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",be.indexMaxZoom,be.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),Qe=(function(ot,et){const Lt=et.buffer/et.extent;let _t=ot;const jt=it(ot,1,-1-Lt,Lt,0,-1,2,et),Jt=it(ot,1,1-Lt,2+Lt,0,-1,2,et);return(jt||Jt)&&(_t=it(ot,1,-Lt,1+Lt,0,-1,2,et)||[],jt&&(_t=Yt(jt,1).concat(_t)),Jt&&(_t=_t.concat(Yt(Jt,-1)))),_t})(Qe,be),Qe.length&&this.splitTile(Qe,0,0,0),qe&&(Qe.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}splitTile(_e,be,qe,Qe,ot,et,Lt){const _t=[_e,be,qe,Qe],jt=this.options,Jt=jt.debug;for(;_t.length;){Qe=_t.pop(),qe=_t.pop(),be=_t.pop(),_e=_t.pop();const Kt=1<<be,Rr=lr(be,qe,Qe);let bt=this.tiles[Rr];if(!bt&&(Jt>1&&console.time("creation"),bt=this.tiles[Rr]=_r(_e,be,qe,Qe,jt),this.tileCoords.push({z:be,x:qe,y:Qe}),Jt)){Jt>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",be,qe,Qe,bt.numFeatures,bt.numPoints,bt.numSimplified),console.timeEnd("creation"));const mt=`z${be}`;this.stats[mt]=(this.stats[mt]||0)+1,this.total++}if(bt.source=_e,ot==null){if(be===jt.indexMaxZoom||bt.numPoints<=jt.indexMaxPoints)continue}else{if(be===jt.maxZoom||be===ot)continue;if(ot!=null){const mt=ot-be;if(qe!==et>>mt||Qe!==Lt>>mt)continue}}if(bt.source=null,_e.length===0)continue;Jt>1&&console.time("clipping");const Tr=.5*jt.buffer/jt.extent,Ur=.5-Tr,Gr=.5+Tr,Jr=1+Tr;let ar=null,ti=null,un=null,ri=null,Ae=it(_e,Kt,qe-Tr,qe+Gr,0,bt.minX,bt.maxX,jt),Be=it(_e,Kt,qe+Ur,qe+Jr,0,bt.minX,bt.maxX,jt);_e=null,Ae&&(ar=it(Ae,Kt,Qe-Tr,Qe+Gr,1,bt.minY,bt.maxY,jt),ti=it(Ae,Kt,Qe+Ur,Qe+Jr,1,bt.minY,bt.maxY,jt),Ae=null),Be&&(un=it(Be,Kt,Qe-Tr,Qe+Gr,1,bt.minY,bt.maxY,jt),ri=it(Be,Kt,Qe+Ur,Qe+Jr,1,bt.minY,bt.maxY,jt),Be=null),Jt>1&&console.timeEnd("clipping"),_t.push(ar||[],be+1,2*qe,2*Qe),_t.push(ti||[],be+1,2*qe,2*Qe+1),_t.push(un||[],be+1,2*qe+1,2*Qe),_t.push(ri||[],be+1,2*qe+1,2*Qe+1)}}getTile(_e,be,qe){_e=+_e,be=+be,qe=+qe;const Qe=this.options,{extent:ot,debug:et}=Qe;if(_e<0||_e>24)return null;const Lt=1<<_e,_t=lr(_e,be=be+Lt&Lt-1,qe);if(this.tiles[_t])return vt(this.tiles[_t],ot);et>1&&console.log("drilling down to z%d-%d-%d",_e,be,qe);let jt,Jt=_e,Kt=be,Rr=qe;for(;!jt&&Jt>0;)Jt--,Kt>>=1,Rr>>=1,jt=this.tiles[lr(Jt,Kt,Rr)];return jt&&jt.source?(et>1&&(console.log("found parent tile z%d-%d-%d",Jt,Kt,Rr),console.time("drilling down")),this.splitTile(jt.source,Jt,Kt,Rr,_e,be,qe),et>1&&console.timeEnd("drilling down"),this.tiles[_t]?vt(this.tiles[_t],ot):null):null}}function lr(nt,_e,be){return 32*((1<<nt)*be+_e)+nt}class Ar extends g{constructor(){super(...arguments),this._dataUpdateable=new Map}loadVectorTile(_e,be){return s._(this,void 0,void 0,(function*(){const qe=_e.tileID.canonical;if(!this._geoJSONIndex)throw new Error("Unable to parse the data into a cluster or geojson");const Qe=this._geoJSONIndex.getTile(qe.z,qe.x,qe.y);if(!Qe)return null;const ot=new L(Qe.features,{version:2,extent:s.$});let et=(function(Lt){const _t=new s.cM;return(function(jt,Jt){for(const Kt in jt.layers)Jt.writeMessage(3,O,jt.layers[Kt])})(Lt,_t),_t.finish()})(ot);return et.byteOffset===0&&et.byteLength===et.buffer.byteLength||(et=new Uint8Array(et)),{vectorTile:ot,rawData:et.buffer}}))}loadData(_e){return s._(this,void 0,void 0,(function*(){var be;(be=this._pendingRequest)===null||be===void 0||be.abort();const qe=!!(_e&&_e.request&&_e.request.collectResourceTiming)&&new s.cN(_e.request);this._pendingRequest=new AbortController;try{this._pendingData=this.loadAndProcessGeoJSON(_e,this._pendingRequest);const Qe=yield this._pendingData;this._geoJSONIndex=_e.cluster?new ne((function({superclusterOptions:et,clusterProperties:Lt}){if(!Lt||!et)return et;const _t={},jt={},Jt={accumulated:null,zoom:0},Kt={properties:null},Rr=Object.keys(Lt);for(const bt of Rr){const[Tr,Ur]=Lt[bt],Gr=s.cT(Ur),Jr=s.cT(typeof Tr=="string"?[Tr,["accumulated"],["get",bt]]:Tr);_t[bt]=Gr.value,jt[bt]=Jr.value}return et.map=bt=>{Kt.properties=bt;const Tr={};for(const Ur of Rr)Tr[Ur]=_t[Ur].evaluate(Jt,Kt);return Tr},et.reduce=(bt,Tr)=>{Kt.properties=Tr;for(const Ur of Rr)Jt.accumulated=bt[Ur],bt[Ur]=jt[Ur].evaluate(Jt,Kt)},et})(_e)).load(Qe.features):(function(et,Lt){return new er(et,Lt)})(Qe,_e.geojsonVtOptions),this.loaded={};const ot={data:Qe};if(qe){const et=qe.finish();et&&(ot.resourceTiming={},ot.resourceTiming[_e.source]=JSON.parse(JSON.stringify(et)))}return ot}catch(Qe){if(delete this._pendingRequest,s.cy(Qe))return{abandoned:!0};throw Qe}}))}getData(){return s._(this,void 0,void 0,(function*(){return this._pendingData}))}reloadTile(_e){const be=this.loaded;return be&&be[_e.uid]?super.reloadTile(_e):this.loadTile(_e)}loadAndProcessGeoJSON(_e,be){return s._(this,void 0,void 0,(function*(){let qe=yield this.loadGeoJSON(_e,be);if(delete this._pendingRequest,typeof qe!="object")throw new Error(`Input data given to '${_e.source}' is not a valid GeoJSON object.`);if(P(qe,!0),_e.filter){const Qe=s.cT(_e.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(Qe.result==="error")throw new Error(Qe.value.map((et=>`${et.key}: ${et.message}`)).join(", "));qe={type:"FeatureCollection",features:qe.features.filter((et=>Qe.value.evaluate({zoom:0},et)))}}return qe}))}loadGeoJSON(_e,be){return s._(this,void 0,void 0,(function*(){const{promoteId:qe}=_e;if(_e.request){const Qe=yield s.j(_e.request,be);return this._dataUpdateable=s.cV(Qe.data,qe)?s.cU(Qe.data,qe):void 0,Qe.data}if(typeof _e.data=="string")try{const Qe=JSON.parse(_e.data);return this._dataUpdateable=s.cV(Qe,qe)?s.cU(Qe,qe):void 0,Qe}catch{throw new Error(`Input data given to '${_e.source}' is not a valid GeoJSON object.`)}if(!_e.dataDiff)throw new Error(`Input data given to '${_e.source}' is not a valid GeoJSON object.`);if(!this._dataUpdateable)throw new Error(`Cannot update existing geojson data in ${_e.source}`);return s.cW(this._dataUpdateable,_e.dataDiff,qe),{type:"FeatureCollection",features:Array.from(this._dataUpdateable.values())}}))}removeSource(_e){return s._(this,void 0,void 0,(function*(){this._pendingRequest&&this._pendingRequest.abort()}))}getClusterExpansionZoom(_e){return this._geoJSONIndex.getClusterExpansionZoom(_e.clusterId)}getClusterChildren(_e){return this._geoJSONIndex.getChildren(_e.clusterId)}getClusterLeaves(_e){return this._geoJSONIndex.getLeaves(_e.clusterId,_e.limit,_e.offset)}}class ir{constructor(_e){this.self=_e,this.actor=new s.J(_e),this.layerIndexes={},this.availableImages={},this.workerSources={},this.demWorkerSources={},this.externalWorkerSourceTypes={},this.self.registerWorkerSource=(be,qe)=>{if(this.externalWorkerSourceTypes[be])throw new Error(`Worker source with name "${be}" already registered.`);this.externalWorkerSourceTypes[be]=qe},this.self.addProtocol=s.cA,this.self.removeProtocol=s.cB,this.self.registerRTLTextPlugin=be=>{s.cX.setMethods(be)},this.actor.registerMessageHandler("LDT",((be,qe)=>this._getDEMWorkerSource(be,qe.source).loadTile(qe))),this.actor.registerMessageHandler("RDT",((be,qe)=>s._(this,void 0,void 0,(function*(){this._getDEMWorkerSource(be,qe.source).removeTile(qe)})))),this.actor.registerMessageHandler("GCEZ",((be,qe)=>s._(this,void 0,void 0,(function*(){return this._getWorkerSource(be,qe.type,qe.source).getClusterExpansionZoom(qe)})))),this.actor.registerMessageHandler("GCC",((be,qe)=>s._(this,void 0,void 0,(function*(){return this._getWorkerSource(be,qe.type,qe.source).getClusterChildren(qe)})))),this.actor.registerMessageHandler("GCL",((be,qe)=>s._(this,void 0,void 0,(function*(){return this._getWorkerSource(be,qe.type,qe.source).getClusterLeaves(qe)})))),this.actor.registerMessageHandler("LD",((be,qe)=>this._getWorkerSource(be,qe.type,qe.source).loadData(qe))),this.actor.registerMessageHandler("GD",((be,qe)=>this._getWorkerSource(be,qe.type,qe.source).getData())),this.actor.registerMessageHandler("LT",((be,qe)=>this._getWorkerSource(be,qe.type,qe.source).loadTile(qe))),this.actor.registerMessageHandler("RT",((be,qe)=>this._getWorkerSource(be,qe.type,qe.source).reloadTile(qe))),this.actor.registerMessageHandler("AT",((be,qe)=>this._getWorkerSource(be,qe.type,qe.source).abortTile(qe))),this.actor.registerMessageHandler("RMT",((be,qe)=>this._getWorkerSource(be,qe.type,qe.source).removeTile(qe))),this.actor.registerMessageHandler("RS",((be,qe)=>s._(this,void 0,void 0,(function*(){if(!this.workerSources[be]||!this.workerSources[be][qe.type]||!this.workerSources[be][qe.type][qe.source])return;const Qe=this.workerSources[be][qe.type][qe.source];delete this.workerSources[be][qe.type][qe.source],Qe.removeSource!==void 0&&Qe.removeSource(qe)})))),this.actor.registerMessageHandler("RM",(be=>s._(this,void 0,void 0,(function*(){delete this.layerIndexes[be],delete this.availableImages[be],delete this.workerSources[be],delete this.demWorkerSources[be]})))),this.actor.registerMessageHandler("SR",((be,qe)=>s._(this,void 0,void 0,(function*(){this.referrer=qe})))),this.actor.registerMessageHandler("SRPS",((be,qe)=>this._syncRTLPluginState(be,qe))),this.actor.registerMessageHandler("IS",((be,qe)=>s._(this,void 0,void 0,(function*(){this.self.importScripts(qe)})))),this.actor.registerMessageHandler("SI",((be,qe)=>this._setImages(be,qe))),this.actor.registerMessageHandler("UL",((be,qe)=>s._(this,void 0,void 0,(function*(){this._getLayerIndex(be).update(qe.layers,qe.removedIds)})))),this.actor.registerMessageHandler("SL",((be,qe)=>s._(this,void 0,void 0,(function*(){this._getLayerIndex(be).replace(qe)}))))}_setImages(_e,be){return s._(this,void 0,void 0,(function*(){this.availableImages[_e]=be;for(const qe in this.workerSources[_e]){const Qe=this.workerSources[_e][qe];for(const ot in Qe)Qe[ot].availableImages=be}}))}_syncRTLPluginState(_e,be){return s._(this,void 0,void 0,(function*(){return yield s.cX.syncState(be,this.self.importScripts)}))}_getAvailableImages(_e){let be=this.availableImages[_e];return be||(be=[]),be}_getLayerIndex(_e){let be=this.layerIndexes[_e];return be||(be=this.layerIndexes[_e]=new o),be}_getWorkerSource(_e,be,qe){if(this.workerSources[_e]||(this.workerSources[_e]={}),this.workerSources[_e][be]||(this.workerSources[_e][be]={}),!this.workerSources[_e][be][qe]){const Qe={sendAsync:(ot,et)=>(ot.targetMapId=_e,this.actor.sendAsync(ot,et))};switch(be){case"vector":this.workerSources[_e][be][qe]=new g(Qe,this._getLayerIndex(_e),this._getAvailableImages(_e));break;case"geojson":this.workerSources[_e][be][qe]=new Ar(Qe,this._getLayerIndex(_e),this._getAvailableImages(_e));break;default:this.workerSources[_e][be][qe]=new this.externalWorkerSourceTypes[be](Qe,this._getLayerIndex(_e),this._getAvailableImages(_e))}}return this.workerSources[_e][be][qe]}_getDEMWorkerSource(_e,be){return this.demWorkerSources[_e]||(this.demWorkerSources[_e]={}),this.demWorkerSources[_e][be]||(this.demWorkerSources[_e][be]=new b),this.demWorkerSources[_e][be]}}return s.i(self)&&(self.worker=new ir(self)),ir})),i("index",["exports","./shared"],(function(s,o){var u="5.7.1";function h(){var R=new o.A(4);return o.A!=Float32Array&&(R[1]=0,R[2]=0),R[0]=1,R[3]=1,R}let f,g;const b={now:typeof performance<"u"&&performance&&performance.now?performance.now.bind(performance):Date.now.bind(Date),frame(R,l,m){const w=requestAnimationFrame((N=>{C(),l(N)})),{unsubscribe:C}=o.s(R.signal,"abort",(()=>{C(),cancelAnimationFrame(w),m(o.c())}),!1)},frameAsync(R){return new Promise(((l,m)=>{this.frame(R,l,m)}))},getImageData(R,l=0){return this.getImageCanvasContext(R).getImageData(-l,-l,R.width+2*l,R.height+2*l)},getImageCanvasContext(R){const l=window.document.createElement("canvas"),m=l.getContext("2d",{willReadFrequently:!0});if(!m)throw new Error("failed to create canvas 2d context");return l.width=R.width,l.height=R.height,m.drawImage(R,0,0,R.width,R.height),m},resolveURL:R=>(f||(f=document.createElement("a")),f.href=R,f.href),hardwareConcurrency:typeof navigator<"u"&&navigator.hardwareConcurrency||4,get prefersReducedMotion(){return!!matchMedia&&(g==null&&(g=matchMedia("(prefers-reduced-motion: reduce)")),g.matches)}};class v{static testProp(l){if(!v.docStyle)return l[0];for(let m=0;m<l.length;m++)if(l[m]in v.docStyle)return l[m];return l[0]}static create(l,m,w){const C=window.document.createElement(l);return m!==void 0&&(C.className=m),w&&w.appendChild(C),C}static createNS(l,m){return window.document.createElementNS(l,m)}static disableDrag(){v.docStyle&&v.selectProp&&(v.userSelect=v.docStyle[v.selectProp],v.docStyle[v.selectProp]="none")}static enableDrag(){v.docStyle&&v.selectProp&&(v.docStyle[v.selectProp]=v.userSelect)}static setTransform(l,m){l.style[v.transformProp]=m}static addEventListener(l,m,w,C={}){l.addEventListener(m,w,"passive"in C?C:C.capture)}static removeEventListener(l,m,w,C={}){l.removeEventListener(m,w,"passive"in C?C:C.capture)}static suppressClickInternal(l){l.preventDefault(),l.stopPropagation(),window.removeEventListener("click",v.suppressClickInternal,!0)}static suppressClick(){window.addEventListener("click",v.suppressClickInternal,!0),window.setTimeout((()=>{window.removeEventListener("click",v.suppressClickInternal,!0)}),0)}static getScale(l){const m=l.getBoundingClientRect();return{x:m.width/l.offsetWidth||1,y:m.height/l.offsetHeight||1,boundingClientRect:m}}static getPoint(l,m,w){const C=m.boundingClientRect;return new o.P((w.clientX-C.left)/m.x-l.clientLeft,(w.clientY-C.top)/m.y-l.clientTop)}static mousePos(l,m){const w=v.getScale(l);return v.getPoint(l,w,m)}static touchPos(l,m){const w=[],C=v.getScale(l);for(let N=0;N<m.length;N++)w.push(v.getPoint(l,C,m[N]));return w}static mouseButton(l){return l.button}static remove(l){l.parentNode&&l.parentNode.removeChild(l)}static sanitize(l){const m=new DOMParser().parseFromString(l,"text/html").body||document.createElement("body"),w=m.querySelectorAll("script");for(const C of w)C.remove();return v.clean(m),m.innerHTML}static isPossiblyDangerous(l,m){const w=m.replace(/\s+/g,"").toLowerCase();return!(!["src","href","xlink:href"].includes(l)||!w.includes("javascript:")&&!w.includes("data:"))||!!l.startsWith("on")||void 0}static clean(l){const m=l.children;for(const w of m)v.removeAttributes(w),v.clean(w)}static removeAttributes(l){for(const{name:m,value:w}of l.attributes)v.isPossiblyDangerous(m,w)&&l.removeAttribute(m)}}v.docStyle=typeof window<"u"&&window.document&&window.document.documentElement.style,v.selectProp=v.testProp(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),v.transformProp=v.testProp(["transform","WebkitTransform"]);const S={supported:!1,testSupport:function(R){!k&&P&&(L?O(R):E=R)}};let E,P,k=!1,L=!1;function O(R){const l=R.createTexture();R.bindTexture(R.TEXTURE_2D,l);try{if(R.texImage2D(R.TEXTURE_2D,0,R.RGBA,R.RGBA,R.UNSIGNED_BYTE,P),R.isContextLost())return;S.supported=!0}catch{}R.deleteTexture(l),k=!0}var M;typeof document<"u"&&(P=document.createElement("img"),P.onload=()=>{E&&O(E),E=null,L=!0},P.onerror=()=>{k=!0,E=null},P.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA="),(function(R){let l,m,w,C;R.resetRequestQueue=()=>{l=[],m=0,w=0,C={}},R.addThrottleControl=te=>{const ue=w++;return C[ue]=te,ue},R.removeThrottleControl=te=>{delete C[te],j()},R.getImage=(te,ue,ge=!0)=>new Promise(((Ce,Se)=>{S.supported&&(te.headers||(te.headers={}),te.headers.accept="image/webp,*/*"),o.e(te,{type:"image"}),l.push({abortController:ue,requestParameters:te,supportImageRefresh:ge,state:"queued",onError:Fe=>{Se(Fe)},onSuccess:Fe=>{Ce(Fe)}}),j()}));const N=te=>o._(this,void 0,void 0,(function*(){te.state="running";const{requestParameters:ue,supportImageRefresh:ge,onError:Ce,onSuccess:Se,abortController:Fe}=te,Ge=ge===!1&&!o.i(self)&&!o.g(ue.url)&&(!ue.headers||Object.keys(ue.headers).reduce(((ct,xt)=>ct&&xt==="accept"),!0));m++;const ut=Ge?Y(ue,Fe):o.m(ue,Fe);try{const ct=yield ut;delete te.abortController,te.state="completed",ct.data instanceof HTMLImageElement||o.b(ct.data)?Se(ct):ct.data&&Se({data:yield(lt=ct.data,typeof createImageBitmap=="function"?o.f(lt):o.h(lt)),cacheControl:ct.cacheControl,expires:ct.expires})}catch(ct){delete te.abortController,Ce(ct)}finally{m--,j()}var lt})),j=()=>{const te=(()=>{for(const ue of Object.keys(C))if(C[ue]())return!0;return!1})()?o.a.MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:o.a.MAX_PARALLEL_IMAGE_REQUESTS;for(let ue=m;ue<te&&l.length>0;ue++){const ge=l.shift();ge.abortController.signal.aborted?ue--:N(ge)}},Y=(te,ue)=>new Promise(((ge,Ce)=>{const Se=new Image,Fe=te.url,Ge=te.credentials;Ge&&Ge==="include"?Se.crossOrigin="use-credentials":(Ge&&Ge==="same-origin"||!o.d(Fe))&&(Se.crossOrigin="anonymous"),ue.signal.addEventListener("abort",(()=>{Se.src="",Ce(o.c())})),Se.fetchPriority="high",Se.onload=()=>{Se.onerror=Se.onload=null,ge({data:Se})},Se.onerror=()=>{Se.onerror=Se.onload=null,ue.signal.aborted||Ce(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))},Se.src=Fe}))})(M||(M={})),M.resetRequestQueue();class z{constructor(l){this._transformRequestFn=l??null}transformRequest(l,m){return this._transformRequestFn&&this._transformRequestFn(l,m)||{url:l}}setTransformRequest(l){this._transformRequestFn=l}}function B(R){const l=[];if(typeof R=="string")l.push({id:"default",url:R});else if(R&&R.length>0){const m=[];for(const{id:w,url:C}of R){const N=`${w}${C}`;m.indexOf(N)===-1&&(m.push(N),l.push({id:w,url:C}))}}return l}function q(R,l,m){try{const w=new URL(R);return w.pathname+=`${l}${m}`,w.toString()}catch{throw new Error(`Invalid sprite URL "${R}", must be absolute. Modify style specification directly or use TransformStyleFunction to correct the issue dynamically`)}}function W(R){const{userImage:l}=R;return!!(l&&l.render&&l.render())&&(R.data.replace(new Uint8Array(l.data.buffer)),!0)}class G extends o.E{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new o.R({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(l){if(this.loaded!==l&&(this.loaded=l,l)){for(const{ids:m,promiseResolve:w}of this.requestors)w(this._getImagesForIds(m));this.requestors=[]}}getImage(l){const m=this.images[l];if(m&&!m.data&&m.spriteData){const w=m.spriteData;m.data=new o.R({width:w.width,height:w.height},w.context.getImageData(w.x,w.y,w.width,w.height).data),m.spriteData=null}return m}addImage(l,m){if(this.images[l])throw new Error(`Image id ${l} already exist, use updateImage instead`);this._validate(l,m)&&(this.images[l]=m)}_validate(l,m){let w=!0;const C=m.data||m.spriteData;return this._validateStretch(m.stretchX,C&&C.width)||(this.fire(new o.k(new Error(`Image "${l}" has invalid "stretchX" value`))),w=!1),this._validateStretch(m.stretchY,C&&C.height)||(this.fire(new o.k(new Error(`Image "${l}" has invalid "stretchY" value`))),w=!1),this._validateContent(m.content,m)||(this.fire(new o.k(new Error(`Image "${l}" has invalid "content" value`))),w=!1),w}_validateStretch(l,m){if(!l)return!0;let w=0;for(const C of l){if(C[0]<w||C[1]<C[0]||m<C[1])return!1;w=C[1]}return!0}_validateContent(l,m){if(!l)return!0;if(l.length!==4)return!1;const w=m.spriteData,C=w&&w.width||m.data.width,N=w&&w.height||m.data.height;return!(l[0]<0||C<l[0]||l[1]<0||N<l[1]||l[2]<0||C<l[2]||l[3]<0||N<l[3]||l[2]<l[0]||l[3]<l[1])}updateImage(l,m,w=!0){const C=this.getImage(l);if(w&&(C.data.width!==m.data.width||C.data.height!==m.data.height))throw new Error(`size mismatch between old image (${C.data.width}x${C.data.height}) and new image (${m.data.width}x${m.data.height}).`);m.version=C.version+1,this.images[l]=m,this.updatedImages[l]=!0}removeImage(l){const m=this.images[l];delete this.images[l],delete this.patterns[l],m.userImage&&m.userImage.onRemove&&m.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(l){return new Promise(((m,w)=>{let C=!0;if(!this.isLoaded())for(const N of l)this.images[N]||(C=!1);this.isLoaded()||C?m(this._getImagesForIds(l)):this.requestors.push({ids:l,promiseResolve:m})}))}_getImagesForIds(l){const m={};for(const w of l){let C=this.getImage(w);C||(this.fire(new o.l("styleimagemissing",{id:w})),C=this.getImage(w)),C?m[w]={data:C.data.clone(),pixelRatio:C.pixelRatio,sdf:C.sdf,version:C.version,stretchX:C.stretchX,stretchY:C.stretchY,content:C.content,textFitWidth:C.textFitWidth,textFitHeight:C.textFitHeight,hasRenderCallback:!!(C.userImage&&C.userImage.render)}:o.w(`Image "${w}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}return m}getPixelSize(){const{width:l,height:m}=this.atlasImage;return{width:l,height:m}}getPattern(l){const m=this.patterns[l],w=this.getImage(l);if(!w)return null;if(m&&m.position.version===w.version)return m.position;if(m)m.position.version=w.version;else{const C={w:w.data.width+2,h:w.data.height+2,x:0,y:0},N=new o.I(C,w);this.patterns[l]={bin:C,position:N}}return this._updatePatternAtlas(),this.patterns[l].position}bind(l){const m=l.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new o.T(l,this.atlasImage,m.RGBA),this.atlasTexture.bind(m.LINEAR,m.CLAMP_TO_EDGE)}_updatePatternAtlas(){const l=[];for(const N in this.patterns)l.push(this.patterns[N].bin);const{w:m,h:w}=o.p(l),C=this.atlasImage;C.resize({width:m||1,height:w||1});for(const N in this.patterns){const{bin:j}=this.patterns[N],Y=j.x+1,te=j.y+1,ue=this.getImage(N).data,ge=ue.width,Ce=ue.height;o.R.copy(ue,C,{x:0,y:0},{x:Y,y:te},{width:ge,height:Ce}),o.R.copy(ue,C,{x:0,y:Ce-1},{x:Y,y:te-1},{width:ge,height:1}),o.R.copy(ue,C,{x:0,y:0},{x:Y,y:te+Ce},{width:ge,height:1}),o.R.copy(ue,C,{x:ge-1,y:0},{x:Y-1,y:te},{width:1,height:Ce}),o.R.copy(ue,C,{x:0,y:0},{x:Y+ge,y:te},{width:1,height:Ce})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(l){for(const m of l){if(this.callbackDispatchedThisFrame[m])continue;this.callbackDispatchedThisFrame[m]=!0;const w=this.getImage(m);w||o.w(`Image with ID: "${m}" was not found`),W(w)&&this.updateImage(m,w)}}}const ie=1e20;function Q(R,l,m,w,C,N,j,Y,te){for(let ue=l;ue<l+w;ue++)H(R,m*N+ue,N,C,j,Y,te);for(let ue=m;ue<m+C;ue++)H(R,ue*N+l,1,w,j,Y,te)}function H(R,l,m,w,C,N,j){N[0]=0,j[0]=-ie,j[1]=ie,C[0]=R[l];for(let Y=1,te=0,ue=0;Y<w;Y++){C[Y]=R[l+Y*m];const ge=Y*Y;do{const Ce=N[te];ue=(C[Y]-C[Ce]+ge-Ce*Ce)/(Y-Ce)/2}while(ue<=j[te]&&--te>-1);te++,N[te]=Y,j[te]=ue,j[te+1]=ie}for(let Y=0,te=0;Y<w;Y++){for(;j[te+1]<Y;)te++;const ue=N[te],ge=Y-ue;R[l+Y*m]=C[ue]+ge*ge}}class ne{constructor(l,m,w){this.requestManager=l,this.localIdeographFontFamily=m,this.entries={},this.lang=w}setURL(l){this.url=l}getGlyphs(l){return o._(this,void 0,void 0,(function*(){const m=[];for(const N in l)for(const j of l[N])m.push(this._getAndCacheGlyphsPromise(N,j));const w=yield Promise.all(m),C={};for(const{stack:N,id:j,glyph:Y}of w)C[N]||(C[N]={}),C[N][j]=Y&&{id:Y.id,bitmap:Y.bitmap.clone(),metrics:Y.metrics};return C}))}_getAndCacheGlyphsPromise(l,m){return o._(this,void 0,void 0,(function*(){let w=this.entries[l];w||(w=this.entries[l]={glyphs:{},requests:{},ranges:{}});let C=w.glyphs[m];if(C!==void 0)return{stack:l,id:m,glyph:C};if(C=this._tinySDF(w,l,m),C)return w.glyphs[m]=C,{stack:l,id:m,glyph:C};const N=Math.floor(m/256);if(256*N>65535)throw new Error("glyphs > 65535 not supported");if(w.ranges[N])return{stack:l,id:m,glyph:C};if(!this.url)throw new Error("glyphsUrl is not set");if(!w.requests[N]){const Y=ne.loadGlyphRange(l,N,this.url,this.requestManager);w.requests[N]=Y}const j=yield w.requests[N];for(const Y in j)this._doesCharSupportLocalGlyph(+Y)||(w.glyphs[+Y]=j[+Y]);return w.ranges[N]=!0,{stack:l,id:m,glyph:j[m]||null}}))}_doesCharSupportLocalGlyph(l){return!!this.localIdeographFontFamily&&(new RegExp("\\p{Ideo}|\\p{sc=Hang}|\\p{sc=Hira}|\\p{sc=Kana}","u").test(String.fromCodePoint(l))||o.u["CJK Unified Ideographs"](l)||o.u["Hangul Syllables"](l)||o.u.Hiragana(l)||o.u.Katakana(l)||o.u["CJK Symbols and Punctuation"](l)||o.u["Halfwidth and Fullwidth Forms"](l))}_tinySDF(l,m,w){const C=this.localIdeographFontFamily;if(!C||!this._doesCharSupportLocalGlyph(w))return;let N=l.tinySDF;if(!N){let Y="400";/bold/i.test(m)?Y="900":/medium/i.test(m)?Y="500":/light/i.test(m)&&(Y="200"),N=l.tinySDF=new ne.TinySDF({fontSize:48,buffer:6,radius:16,cutoff:.25,lang:this.lang,fontFamily:C,fontWeight:Y})}const j=N.draw(String.fromCharCode(w));return{id:w,bitmap:new o.q({width:j.width||60,height:j.height||60},j.data),metrics:{width:j.glyphWidth/2||24,height:j.glyphHeight/2||24,left:j.glyphLeft/2+.5||0,top:j.glyphTop/2-27.5||-8,advance:j.glyphAdvance/2||24,isDoubleResolution:!0}}}}ne.loadGlyphRange=function(R,l,m,w){return o._(this,void 0,void 0,(function*(){const C=256*l,N=C+255,j=w.transformRequest(m.replace("{fontstack}",R).replace("{range}",`${C}-${N}`),"Glyphs"),Y=yield o.n(j,new AbortController);if(!Y||!Y.data)throw new Error(`Could not load glyph range. range: ${l}, ${C}-${N}`);const te={};for(const ue of o.o(Y.data))te[ue.id]=ue;return te}))},ne.TinySDF=class{constructor({fontSize:R=24,buffer:l=3,radius:m=8,cutoff:w=.25,fontFamily:C="sans-serif",fontWeight:N="normal",fontStyle:j="normal",lang:Y=null}={}){this.buffer=l,this.cutoff=w,this.radius=m,this.lang=Y;const te=this.size=R+4*l,ue=this._createCanvas(te),ge=this.ctx=ue.getContext("2d",{willReadFrequently:!0});ge.font=`${j} ${N} ${R}px ${C}`,ge.textBaseline="alphabetic",ge.textAlign="left",ge.fillStyle="black",this.gridOuter=new Float64Array(te*te),this.gridInner=new Float64Array(te*te),this.f=new Float64Array(te),this.z=new Float64Array(te+1),this.v=new Uint16Array(te)}_createCanvas(R){const l=document.createElement("canvas");return l.width=l.height=R,l}draw(R){const{width:l,actualBoundingBoxAscent:m,actualBoundingBoxDescent:w,actualBoundingBoxLeft:C,actualBoundingBoxRight:N}=this.ctx.measureText(R),j=Math.ceil(m),Y=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(N-C))),te=Math.min(this.size-this.buffer,j+Math.ceil(w)),ue=Y+2*this.buffer,ge=te+2*this.buffer,Ce=Math.max(ue*ge,0),Se=new Uint8ClampedArray(Ce),Fe={data:Se,width:ue,height:ge,glyphWidth:Y,glyphHeight:te,glyphTop:j,glyphLeft:0,glyphAdvance:l};if(Y===0||te===0)return Fe;const{ctx:Ge,buffer:ut,gridInner:lt,gridOuter:ct}=this;this.lang&&(Ge.lang=this.lang),Ge.clearRect(ut,ut,Y,te),Ge.fillText(R,ut,ut+j);const xt=Ge.getImageData(ut,ut,Y,te);ct.fill(ie,0,Ce),lt.fill(0,0,Ce);for(let Pt=0;Pt<te;Pt++)for(let Ct=0;Ct<Y;Ct++){const Ot=xt.data[4*(Pt*Y+Ct)+3]/255;if(Ot===0)continue;const Bt=(Pt+ut)*ue+Ct+ut;if(Ot===1)ct[Bt]=0,lt[Bt]=ie;else{const At=.5-Ot;ct[Bt]=At>0?At*At:0,lt[Bt]=At<0?At*At:0}}Q(ct,0,0,ue,ge,ue,this.f,this.v,this.z),Q(lt,ut,ut,Y,te,ue,this.f,this.v,this.z);for(let Pt=0;Pt<Ce;Pt++){const Ct=Math.sqrt(ct[Pt])-Math.sqrt(lt[Pt]);Se[Pt]=Math.round(255-255*(Ct/this.radius+this.cutoff))}return Fe}};class oe{constructor(){this.specification=o.v.light.position}possiblyEvaluate(l,m){return o.B(l.expression.evaluate(m))}interpolate(l,m,w){return{x:o.C.number(l.x,m.x,w),y:o.C.number(l.y,m.y,w),z:o.C.number(l.z,m.z,w)}}}let ce;class fe extends o.E{constructor(l){super(),ce=ce||new o.r({anchor:new o.D(o.v.light.anchor),position:new oe,color:new o.D(o.v.light.color),intensity:new o.D(o.v.light.intensity)}),this._transitionable=new o.t(ce),this.setLight(l),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(l,m={}){if(!this._validate(o.x,l,m))for(const w in l){const C=l[w];w.endsWith("-transition")?this._transitionable.setTransition(w.slice(0,-11),C):this._transitionable.setValue(w,C)}}updateTransitions(l){this._transitioning=this._transitionable.transitioned(l,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(l){this.properties=this._transitioning.possiblyEvaluate(l)}_validate(l,m,w){return(!w||w.validate!==!1)&&o.y(this,l.call(o.z,{value:m,style:{glyphs:!0,sprite:!0},styleSpec:o.v}))}}const Me=new o.r({"sky-color":new o.D(o.v.sky["sky-color"]),"horizon-color":new o.D(o.v.sky["horizon-color"]),"fog-color":new o.D(o.v.sky["fog-color"]),"fog-ground-blend":new o.D(o.v.sky["fog-ground-blend"]),"horizon-fog-blend":new o.D(o.v.sky["horizon-fog-blend"]),"sky-horizon-blend":new o.D(o.v.sky["sky-horizon-blend"]),"atmosphere-blend":new o.D(o.v.sky["atmosphere-blend"])});class me extends o.E{constructor(l){super(),this._transitionable=new o.t(Me),this.setSky(l),this._transitioning=this._transitionable.untransitioned(),this.recalculate(new o.F(0))}setSky(l,m={}){if(!this._validate(o.G,l,m)){l||(l={"sky-color":"transparent","horizon-color":"transparent","fog-color":"transparent","fog-ground-blend":1,"atmosphere-blend":0});for(const w in l){const C=l[w];w.endsWith("-transition")?this._transitionable.setTransition(w.slice(0,-11),C):this._transitionable.setValue(w,C)}}}getSky(){return this._transitionable.serialize()}updateTransitions(l){this._transitioning=this._transitionable.transitioned(l,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(l){this.properties=this._transitioning.possiblyEvaluate(l)}_validate(l,m,w={}){return w?.validate!==!1&&o.y(this,l.call(o.z,o.e({value:m,style:{glyphs:!0,sprite:!0},styleSpec:o.v})))}calculateFogBlendOpacity(l){return l<60?0:l<70?(l-60)/10:1}}class we{constructor(l,m){this.width=l,this.height=m,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}}getDash(l,m){const w=l.join(",")+String(m);return this.dashEntry[w]||(this.dashEntry[w]=this.addDash(l,m)),this.dashEntry[w]}getDashRanges(l,m,w){const C=[];let N=l.length%2==1?-l[l.length-1]*w:0,j=l[0]*w,Y=!0;C.push({left:N,right:j,isDash:Y,zeroLength:l[0]===0});let te=l[0];for(let ue=1;ue<l.length;ue++){Y=!Y;const ge=l[ue];N=te*w,te+=ge,j=te*w,C.push({left:N,right:j,isDash:Y,zeroLength:ge===0})}return C}addRoundDash(l,m,w){const C=m/2;for(let N=-w;N<=w;N++){const j=this.width*(this.nextRow+w+N);let Y=0,te=l[Y];for(let ue=0;ue<this.width;ue++){ue/te.right>1&&(te=l[++Y]);const ge=Math.abs(ue-te.left),Ce=Math.abs(ue-te.right),Se=Math.min(ge,Ce);let Fe;const Ge=N/w*(C+1);if(te.isDash){const ut=C-Math.abs(Ge);Fe=Math.sqrt(Se*Se+ut*ut)}else Fe=C-Math.sqrt(Se*Se+Ge*Ge);this.data[j+ue]=Math.max(0,Math.min(255,Fe+128))}}}addRegularDash(l){for(let Y=l.length-1;Y>=0;--Y){const te=l[Y],ue=l[Y+1];te.zeroLength?l.splice(Y,1):ue&&ue.isDash===te.isDash&&(ue.left=te.left,l.splice(Y,1))}const m=l[0],w=l[l.length-1];m.isDash===w.isDash&&(m.left=w.left-this.width,w.right=m.right+this.width);const C=this.width*this.nextRow;let N=0,j=l[N];for(let Y=0;Y<this.width;Y++){Y/j.right>1&&(j=l[++N]);const te=Math.abs(Y-j.left),ue=Math.abs(Y-j.right),ge=Math.min(te,ue);this.data[C+Y]=Math.max(0,Math.min(255,(j.isDash?ge:-ge)+128))}}addDash(l,m){const w=m?7:0,C=2*w+1;if(this.nextRow+C>this.height)return o.w("LineAtlas out of space"),null;let N=0;for(let Y=0;Y<l.length;Y++)N+=l[Y];if(N!==0){const Y=this.width/N,te=this.getDashRanges(l,this.width,Y);m?this.addRoundDash(te,Y,w):this.addRegularDash(te)}const j={y:(this.nextRow+w+.5)/this.height,height:2*w/this.height,width:N};return this.nextRow+=C,this.dirty=!0,j}bind(l){const m=l.gl;this.texture?(m.bindTexture(m.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,m.texSubImage2D(m.TEXTURE_2D,0,0,0,this.width,this.height,m.ALPHA,m.UNSIGNED_BYTE,this.data))):(this.texture=m.createTexture(),m.bindTexture(m.TEXTURE_2D,this.texture),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_WRAP_S,m.REPEAT),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_WRAP_T,m.REPEAT),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_MIN_FILTER,m.LINEAR),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_MAG_FILTER,m.LINEAR),m.texImage2D(m.TEXTURE_2D,0,m.ALPHA,this.width,this.height,0,m.ALPHA,m.UNSIGNED_BYTE,this.data))}}const Te="maplibre_preloaded_worker_pool";class ke{constructor(){this.active={}}acquire(l){if(!this.workers)for(this.workers=[];this.workers.length<ke.workerCount;)this.workers.push(new Worker(o.a.WORKER_URL));return this.active[l]=!0,this.workers.slice()}release(l){delete this.active[l],this.numActive()===0&&(this.workers.forEach((m=>{m.terminate()})),this.workers=null)}isPreloaded(){return!!this.active[Te]}numActive(){return Object.keys(this.active).length}}const he=Math.floor(b.hardwareConcurrency/2);let Ee,xe;function Ne(){return Ee||(Ee=new ke),Ee}ke.workerCount=o.H(globalThis)?Math.max(Math.min(he,3),1):1;class Oe{constructor(l,m){this.workerPool=l,this.actors=[],this.currentActor=0,this.id=m;const w=this.workerPool.acquire(m);for(let C=0;C<w.length;C++){const N=new o.J(w[C],m);N.name=`Worker ${C}`,this.actors.push(N)}if(!this.actors.length)throw new Error("No actors found")}broadcast(l,m){const w=[];for(const C of this.actors)w.push(C.sendAsync({type:l,data:m}));return Promise.all(w)}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(l=!0){this.actors.forEach((m=>{m.remove()})),this.actors=[],l&&this.workerPool.release(this.id)}registerMessageHandler(l,m){for(const w of this.actors)w.registerMessageHandler(l,m)}}function $e(){return xe||(xe=new Oe(Ne(),o.K),xe.registerMessageHandler("GR",((R,l,m)=>o.m(l,m)))),xe}function De(R,l){const m=o.L();return o.M(m,m,[1,1,0]),o.N(m,m,[.5*R.width,.5*R.height,1]),R.calculatePosMatrix?o.O(m,m,R.calculatePosMatrix(l.toUnwrapped())):m}function it(R,l,m,w,C,N,j){var Y;const te=(function(Se,Fe,Ge){if(Se)for(const ut of Se){const lt=Fe[ut];if(lt&&lt.source===Ge&&lt.type==="fill-extrusion")return!0}else for(const ut in Fe){const lt=Fe[ut];if(lt.source===Ge&&lt.type==="fill-extrusion")return!0}return!1})((Y=C?.layers)!==null&&Y!==void 0?Y:null,l,R.id),ue=N.maxPitchScaleFactor(),ge=R.tilesIn(w,ue,te);ge.sort(Ye);const Ce=[];for(const Se of ge)Ce.push({wrappedTileID:Se.tileID.wrapped().key,queryResults:Se.tile.queryRenderedFeatures(l,m,R._state,Se.queryGeometry,Se.cameraQueryGeometry,Se.scale,C,N,ue,De(R.transform,Se.tileID),j?(Fe,Ge)=>j(Se.tileID,Fe,Ge):void 0)});return(function(Se,Fe){for(const Ge in Se)for(const ut of Se[Ge])rt(ut,Fe);return Se})((function(Se){const Fe={},Ge={};for(const ut of Se){const lt=ut.queryResults,ct=ut.wrappedTileID,xt=Ge[ct]=Ge[ct]||{};for(const Pt in lt){const Ct=lt[Pt],Ot=xt[Pt]=xt[Pt]||{},Bt=Fe[Pt]=Fe[Pt]||[];for(const At of Ct)Ot[At.featureIndex]||(Ot[At.featureIndex]=!0,Bt.push(At))}}return Fe})(Ce),R)}function Ye(R,l){const m=R.tileID,w=l.tileID;return m.overscaledZ-w.overscaledZ||m.canonical.y-w.canonical.y||m.wrap-w.wrap||m.canonical.x-w.canonical.x}function rt(R,l){const m=R.feature,w=l.getFeatureState(m.layer["source-layer"],m.id);m.source=m.layer.source,m.layer["source-layer"]&&(m.sourceLayer=m.layer["source-layer"]),m.state=w}function Ie(R,l,m){return o._(this,void 0,void 0,(function*(){let w=R;if(R.url?w=(yield o.j(l.transformRequest(R.url,"Source"),m)).data:yield b.frameAsync(m),!w)return null;const C=o.Q(o.e(w,R),["tiles","minzoom","maxzoom","attribution","bounds","scheme","tileSize","encoding"]);return"vector_layers"in w&&w.vector_layers&&(C.vectorLayerIds=w.vector_layers.map((N=>N.id))),C}))}class Mt{constructor(l,m){l&&(m?this.setSouthWest(l).setNorthEast(m):Array.isArray(l)&&(l.length===4?this.setSouthWest([l[0],l[1]]).setNorthEast([l[2],l[3]]):this.setSouthWest(l[0]).setNorthEast(l[1])))}setNorthEast(l){return this._ne=l instanceof o.S?new o.S(l.lng,l.lat):o.S.convert(l),this}setSouthWest(l){return this._sw=l instanceof o.S?new o.S(l.lng,l.lat):o.S.convert(l),this}extend(l){const m=this._sw,w=this._ne;let C,N;if(l instanceof o.S)C=l,N=l;else{if(!(l instanceof Mt))return Array.isArray(l)?l.length===4||l.every(Array.isArray)?this.extend(Mt.convert(l)):this.extend(o.S.convert(l)):l&&("lng"in l||"lon"in l)&&"lat"in l?this.extend(o.S.convert(l)):this;if(C=l._sw,N=l._ne,!C||!N)return this}return m||w?(m.lng=Math.min(C.lng,m.lng),m.lat=Math.min(C.lat,m.lat),w.lng=Math.max(N.lng,w.lng),w.lat=Math.max(N.lat,w.lat)):(this._sw=new o.S(C.lng,C.lat),this._ne=new o.S(N.lng,N.lat)),this}getCenter(){return new o.S((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new o.S(this.getWest(),this.getNorth())}getSouthEast(){return new o.S(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(l){const{lng:m,lat:w}=o.S.convert(l);let C=this._sw.lng<=m&&m<=this._ne.lng;return this._sw.lng>this._ne.lng&&(C=this._sw.lng>=m&&m>=this._ne.lng),this._sw.lat<=w&&w<=this._ne.lat&&C}static convert(l){return l instanceof Mt?l:l&&new Mt(l)}static fromLngLat(l,m=0){const w=360*m/40075017,C=w/Math.cos(Math.PI/180*l.lat);return new Mt(new o.S(l.lng-C,l.lat-w),new o.S(l.lng+C,l.lat+w))}adjustAntiMeridian(){const l=new o.S(this._sw.lng,this._sw.lat),m=new o.S(this._ne.lng,this._ne.lat);return new Mt(l,l.lng>m.lng?new o.S(m.lng+360,m.lat):m)}}class at{constructor(l,m,w){this.bounds=Mt.convert(this.validateBounds(l)),this.minzoom=m||0,this.maxzoom=w||24}validateBounds(l){return Array.isArray(l)&&l.length===4?[Math.max(-180,l[0]),Math.max(-90,l[1]),Math.min(180,l[2]),Math.min(90,l[3])]:[-180,-90,180,90]}contains(l){const m=Math.pow(2,l.z),w=Math.floor(o.V(this.bounds.getWest())*m),C=Math.floor(o.U(this.bounds.getNorth())*m),N=Math.ceil(o.V(this.bounds.getEast())*m),j=Math.ceil(o.U(this.bounds.getSouth())*m);return l.x>=w&&l.x<N&&l.y>=C&&l.y<j}}class je extends o.E{constructor(l,m,w,C){if(super(),this.id=l,this.dispatcher=w,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,o.e(this,o.Q(m,["url","scheme","tileSize","promoteId"])),this._options=o.e({type:"vector"},m),this._collectResourceTiming=m.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(C)}load(){return o._(this,void 0,void 0,(function*(){this._loaded=!1,this.fire(new o.l("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const l=yield Ie(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,this.map.style.sourceCaches[this.id].clearTiles(),l&&(o.e(this,l),l.bounds&&(this.tileBounds=new at(l.bounds,this.minzoom,this.maxzoom)),this.fire(new o.l("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new o.l("data",{dataType:"source",sourceDataType:"content"})))}catch(l){this._tileJSONRequest=null,this.fire(new o.k(l))}}))}loaded(){return this._loaded}hasTile(l){return!this.tileBounds||this.tileBounds.contains(l.canonical)}onAdd(l){this.map=l,this.load()}setSourceProperty(l){this._tileJSONRequest&&this._tileJSONRequest.abort(),l(),this.load()}setTiles(l){return this.setSourceProperty((()=>{this._options.tiles=l})),this}setUrl(l){return this.setSourceProperty((()=>{this.url=l,this._options.url=l})),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}serialize(){return o.e({},this._options)}loadTile(l){return o._(this,void 0,void 0,(function*(){const m=l.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),w={request:this.map._requestManager.transformRequest(m,"Tile"),uid:l.uid,tileID:l.tileID,zoom:l.tileID.overscaledZ,tileSize:this.tileSize*l.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,subdivisionGranularity:this.map.style.projection.subdivisionGranularity,globalState:this.map.getGlobalState()};w.request.collectResourceTiming=this._collectResourceTiming;let C="RT";if(l.actor&&l.state!=="expired"){if(l.state==="loading")return new Promise(((N,j)=>{l.reloadPromise={resolve:N,reject:j}}))}else l.actor=this.dispatcher.getActor(),C="LT";l.abortController=new AbortController;try{const N=yield l.actor.sendAsync({type:C,data:w},l.abortController);if(delete l.abortController,l.aborted)return;this._afterTileLoadWorkerResponse(l,N)}catch(N){if(delete l.abortController,l.aborted)return;if(N&&N.status!==404)throw N;this._afterTileLoadWorkerResponse(l,null)}}))}_afterTileLoadWorkerResponse(l,m){if(m&&m.resourceTiming&&(l.resourceTiming=m.resourceTiming),m&&this.map._refreshExpiredTiles&&l.setExpiryData(m),l.loadVectorData(m,this.map.painter),l.reloadPromise){const w=l.reloadPromise;l.reloadPromise=null,this.loadTile(l).then(w.resolve).catch(w.reject)}}abortTile(l){return o._(this,void 0,void 0,(function*(){l.abortController&&(l.abortController.abort(),delete l.abortController),l.actor&&(yield l.actor.sendAsync({type:"AT",data:{uid:l.uid,type:this.type,source:this.id}}))}))}unloadTile(l){return o._(this,void 0,void 0,(function*(){l.unloadVectorData(),l.actor&&(yield l.actor.sendAsync({type:"RMT",data:{uid:l.uid,type:this.type,source:this.id}}))}))}hasTransition(){return!1}}class Xt extends o.E{constructor(l,m,w,C){super(),this.id=l,this.dispatcher=w,this.setEventedParent(C),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=o.e({type:"raster"},m),o.e(this,o.Q(m,["url","scheme","tileSize"]))}load(){return o._(this,arguments,void 0,(function*(l=!1){this._loaded=!1,this.fire(new o.l("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const m=yield Ie(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,m&&(o.e(this,m),m.bounds&&(this.tileBounds=new at(m.bounds,this.minzoom,this.maxzoom)),this.fire(new o.l("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new o.l("data",{dataType:"source",sourceDataType:"content",sourceDataChanged:l})))}catch(m){this._tileJSONRequest=null,this.fire(new o.k(m))}}))}loaded(){return this._loaded}onAdd(l){this.map=l,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}setSourceProperty(l){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null),l(),this.load(!0)}setTiles(l){return this.setSourceProperty((()=>{this._options.tiles=l})),this}setUrl(l){return this.setSourceProperty((()=>{this.url=l,this._options.url=l})),this}serialize(){return o.e({},this._options)}hasTile(l){return!this.tileBounds||this.tileBounds.contains(l.canonical)}loadTile(l){return o._(this,void 0,void 0,(function*(){const m=l.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);l.abortController=new AbortController;try{const w=yield M.getImage(this.map._requestManager.transformRequest(m,"Tile"),l.abortController,this.map._refreshExpiredTiles);if(delete l.abortController,l.aborted)return void(l.state="unloaded");if(w&&w.data){this.map._refreshExpiredTiles&&(w.cacheControl||w.expires)&&l.setExpiryData({cacheControl:w.cacheControl,expires:w.expires});const C=this.map.painter.context,N=C.gl,j=w.data;l.texture=this.map.painter.getTileTexture(j.width),l.texture?l.texture.update(j,{useMipmap:!0}):(l.texture=new o.T(C,j,N.RGBA,{useMipmap:!0}),l.texture.bind(N.LINEAR,N.CLAMP_TO_EDGE,N.LINEAR_MIPMAP_NEAREST)),l.state="loaded"}}catch(w){if(delete l.abortController,l.aborted)l.state="unloaded";else if(w)throw l.state="errored",w}}))}abortTile(l){return o._(this,void 0,void 0,(function*(){l.abortController&&(l.abortController.abort(),delete l.abortController)}))}unloadTile(l){return o._(this,void 0,void 0,(function*(){l.texture&&this.map.painter.saveTileTexture(l.texture)}))}hasTransition(){return!1}}class Yt extends Xt{constructor(l,m,w,C){super(l,m,w,C),this.type="raster-dem",this.maxzoom=22,this._options=o.e({type:"raster-dem"},m),this.encoding=m.encoding||"mapbox",this.redFactor=m.redFactor,this.greenFactor=m.greenFactor,this.blueFactor=m.blueFactor,this.baseShift=m.baseShift}loadTile(l){return o._(this,void 0,void 0,(function*(){const m=l.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),w=this.map._requestManager.transformRequest(m,"Tile");l.neighboringTiles=this._getNeighboringTiles(l.tileID),l.abortController=new AbortController;try{const C=yield M.getImage(w,l.abortController,this.map._refreshExpiredTiles);if(delete l.abortController,l.aborted)return void(l.state="unloaded");if(C&&C.data){const N=C.data;this.map._refreshExpiredTiles&&(C.cacheControl||C.expires)&&l.setExpiryData({cacheControl:C.cacheControl,expires:C.expires});const j=o.b(N)&&o.W()?N:yield this.readImageNow(N),Y={type:this.type,uid:l.uid,source:this.id,rawImageData:j,encoding:this.encoding,redFactor:this.redFactor,greenFactor:this.greenFactor,blueFactor:this.blueFactor,baseShift:this.baseShift};if(!l.actor||l.state==="expired"){l.actor=this.dispatcher.getActor();const te=yield l.actor.sendAsync({type:"LDT",data:Y});l.dem=te,l.needsHillshadePrepare=!0,l.needsTerrainPrepare=!0,l.state="loaded"}}}catch(C){if(delete l.abortController,l.aborted)l.state="unloaded";else if(C)throw l.state="errored",C}}))}readImageNow(l){return o._(this,void 0,void 0,(function*(){if(typeof VideoFrame<"u"&&o.X()){const m=l.width+2,w=l.height+2;try{return new o.R({width:m,height:w},yield o.Y(l,-1,-1,m,w))}catch{}}return b.getImageData(l,1)}))}_getNeighboringTiles(l){const m=l.canonical,w=Math.pow(2,m.z),C=(m.x-1+w)%w,N=m.x===0?l.wrap-1:l.wrap,j=(m.x+1+w)%w,Y=m.x+1===w?l.wrap+1:l.wrap,te={};return te[new o.Z(l.overscaledZ,N,m.z,C,m.y).key]={backfilled:!1},te[new o.Z(l.overscaledZ,Y,m.z,j,m.y).key]={backfilled:!1},m.y>0&&(te[new o.Z(l.overscaledZ,N,m.z,C,m.y-1).key]={backfilled:!1},te[new o.Z(l.overscaledZ,l.wrap,m.z,m.x,m.y-1).key]={backfilled:!1},te[new o.Z(l.overscaledZ,Y,m.z,j,m.y-1).key]={backfilled:!1}),m.y+1<w&&(te[new o.Z(l.overscaledZ,N,m.z,C,m.y+1).key]={backfilled:!1},te[new o.Z(l.overscaledZ,l.wrap,m.z,m.x,m.y+1).key]={backfilled:!1},te[new o.Z(l.overscaledZ,Y,m.z,j,m.y+1).key]={backfilled:!1}),te}unloadTile(l){return o._(this,void 0,void 0,(function*(){l.demTexture&&this.map.painter.saveTileTexture(l.demTexture),l.fbo&&(l.fbo.destroy(),delete l.fbo),l.dem&&delete l.dem,delete l.neighboringTiles,l.state="unloaded",l.actor&&(yield l.actor.sendAsync({type:"RDT",data:{type:this.type,uid:l.uid,source:this.id}}))}))}}class pr extends o.E{constructor(l,m,w,C){super(),this.id=l,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._isUpdatingWorker=!1,this._pendingWorkerUpdate={data:m.data},this.actor=w.getActor(),this.setEventedParent(C),this._data=m.data,this._options=o.e({},m),this._collectResourceTiming=m.collectResourceTiming,m.maxzoom!==void 0&&(this.maxzoom=m.maxzoom),m.type&&(this.type=m.type),m.attribution&&(this.attribution=m.attribution),this.promoteId=m.promoteId,m.clusterMaxZoom!==void 0&&this.maxzoom<=m.clusterMaxZoom&&o.w(`The maxzoom value "${this.maxzoom}" is expected to be greater than the clusterMaxZoom value "${m.clusterMaxZoom}".`),this.workerOptions=o.e({source:this.id,cluster:m.cluster||!1,geojsonVtOptions:{buffer:this._pixelsToTileUnits(m.buffer!==void 0?m.buffer:128),tolerance:this._pixelsToTileUnits(m.tolerance!==void 0?m.tolerance:.375),extent:o.$,maxZoom:this.maxzoom,lineMetrics:m.lineMetrics||!1,generateId:m.generateId||!1},superclusterOptions:{maxZoom:this._getClusterMaxZoom(m.clusterMaxZoom),minPoints:Math.max(2,m.clusterMinPoints||2),extent:o.$,radius:this._pixelsToTileUnits(m.clusterRadius||50),log:!1,generateId:m.generateId||!1},clusterProperties:m.clusterProperties,filter:m.filter},m.workerOptions),typeof this.promoteId=="string"&&(this.workerOptions.promoteId=this.promoteId)}_pixelsToTileUnits(l){return l*(o.$/this.tileSize)}_getClusterMaxZoom(l){const m=l?Math.round(l):this.maxzoom-1;return Number.isInteger(l)||l===void 0||o.w(`Integer expected for option 'clusterMaxZoom': provided value "${l}" rounded to "${m}"`),m}load(){return o._(this,void 0,void 0,(function*(){yield this._updateWorkerData()}))}onAdd(l){this.map=l,this.load()}setData(l){return this._data=l,this._pendingWorkerUpdate={data:l},this._updateWorkerData(),this}updateData(l){return this._pendingWorkerUpdate.diff=o.a0(this._pendingWorkerUpdate.diff,l),this._updateWorkerData(),this}getData(){return o._(this,void 0,void 0,(function*(){const l=o.e({type:this.type},this.workerOptions);return this.actor.sendAsync({type:"GD",data:l})}))}getCoordinatesFromGeometry(l){return l.type==="GeometryCollection"?l.geometries.map((m=>m.coordinates)).flat(1/0):l.coordinates.flat(1/0)}getBounds(){return o._(this,void 0,void 0,(function*(){const l=new Mt,m=yield this.getData();let w;switch(m.type){case"FeatureCollection":w=m.features.map((C=>this.getCoordinatesFromGeometry(C.geometry))).flat(1/0);break;case"Feature":w=this.getCoordinatesFromGeometry(m.geometry);break;default:w=this.getCoordinatesFromGeometry(m)}if(w.length==0)return l;for(let C=0;C<w.length-1;C+=2)l.extend([w[C],w[C+1]]);return l}))}setClusterOptions(l){return this.workerOptions.cluster=l.cluster,l&&(l.clusterRadius!==void 0&&(this.workerOptions.superclusterOptions.radius=this._pixelsToTileUnits(l.clusterRadius)),l.clusterMaxZoom!==void 0&&(this.workerOptions.superclusterOptions.maxZoom=this._getClusterMaxZoom(l.clusterMaxZoom))),this._updateWorkerData(),this}getClusterExpansionZoom(l){return this.actor.sendAsync({type:"GCEZ",data:{type:this.type,clusterId:l,source:this.id}})}getClusterChildren(l){return this.actor.sendAsync({type:"GCC",data:{type:this.type,clusterId:l,source:this.id}})}getClusterLeaves(l,m,w){return this.actor.sendAsync({type:"GCL",data:{type:this.type,source:this.id,clusterId:l,limit:m,offset:w}})}_updateWorkerData(){return o._(this,void 0,void 0,(function*(){if(this._isUpdatingWorker)return;const{data:l,diff:m}=this._pendingWorkerUpdate;if(!l&&!m)return void o.w(`No data or diff provided to GeoJSONSource ${this.id}.`);const w=o.e({type:this.type},this.workerOptions);l?(typeof l=="string"?(w.request=this.map._requestManager.transformRequest(b.resolveURL(l),"Source"),w.request.collectResourceTiming=this._collectResourceTiming):w.data=JSON.stringify(l),this._pendingWorkerUpdate.data=void 0):m&&(w.dataDiff=m,this._pendingWorkerUpdate.diff=void 0),this._isUpdatingWorker=!0,this.fire(new o.l("dataloading",{dataType:"source"}));try{const C=yield this.actor.sendAsync({type:"LD",data:w});if(this._isUpdatingWorker=!1,this._removed||C.abandoned)return void this.fire(new o.l("dataabort",{dataType:"source"}));this._data=C.data;let N=null;C.resourceTiming&&C.resourceTiming[this.id]&&(N=C.resourceTiming[this.id].slice(0));const j={dataType:"source"};this._collectResourceTiming&&N&&N.length>0&&o.e(j,{resourceTiming:N}),this.fire(new o.l("data",Object.assign(Object.assign({},j),{sourceDataType:"metadata"}))),this.fire(new o.l("data",Object.assign(Object.assign({},j),{sourceDataType:"content"})))}catch(C){if(this._isUpdatingWorker=!1,this._removed)return void this.fire(new o.l("dataabort",{dataType:"source"}));this.fire(new o.k(C))}finally{(this._pendingWorkerUpdate.data||this._pendingWorkerUpdate.diff)&&this._updateWorkerData()}}))}loaded(){return!this._isUpdatingWorker&&this._pendingWorkerUpdate.data===void 0&&this._pendingWorkerUpdate.diff===void 0}loadTile(l){return o._(this,void 0,void 0,(function*(){const m=l.actor?"RT":"LT";l.actor=this.actor;const w={type:this.type,uid:l.uid,tileID:l.tileID,zoom:l.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,subdivisionGranularity:this.map.style.projection.subdivisionGranularity,globalState:this.map.getGlobalState()};l.abortController=new AbortController;const C=yield this.actor.sendAsync({type:m,data:w},l.abortController);delete l.abortController,l.unloadVectorData(),l.aborted||l.loadVectorData(C,this.map.painter,m==="RT")}))}abortTile(l){return o._(this,void 0,void 0,(function*(){l.abortController&&(l.abortController.abort(),delete l.abortController),l.aborted=!0}))}unloadTile(l){return o._(this,void 0,void 0,(function*(){l.unloadVectorData(),yield this.actor.sendAsync({type:"RMT",data:{uid:l.uid,type:this.type,source:this.id}})}))}onRemove(){this._removed=!0,this.actor.sendAsync({type:"RS",data:{type:this.type,source:this.id}})}serialize(){return o.e({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}}class vt extends o.E{constructor(l,m,w,C){super(),this.flippedWindingOrder=!1,this.id=l,this.dispatcher=w,this.coordinates=m.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(C),this.options=m}load(l){return o._(this,void 0,void 0,(function*(){this._loaded=!1,this.fire(new o.l("dataloading",{dataType:"source"})),this.url=this.options.url,this._request=new AbortController;try{const m=yield M.getImage(this.map._requestManager.transformRequest(this.url,"Image"),this._request);this._request=null,this._loaded=!0,m&&m.data&&(this.image=m.data,l&&(this.coordinates=l),this._finishLoading())}catch(m){this._request=null,this._loaded=!0,this.fire(new o.k(m))}}))}loaded(){return this._loaded}updateImage(l){return l.url?(this._request&&(this._request.abort(),this._request=null),this.options.url=l.url,this.load(l.coordinates).finally((()=>{this.texture=null})),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new o.l("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(l){this.map=l,this.load()}onRemove(){this._request&&(this._request.abort(),this._request=null)}setCoordinates(l){this.coordinates=l;const m=l.map(o.a1.fromLngLat);var w;return this.tileID=(function(C){const N=o.a2.fromPoints(C),j=N.width(),Y=N.height(),te=Math.max(j,Y),ue=Math.max(0,Math.floor(-Math.log(te)/Math.LN2)),ge=Math.pow(2,ue);return new o.a4(ue,Math.floor((N.minX+N.maxX)/2*ge),Math.floor((N.minY+N.maxY)/2*ge))})(m),this.terrainTileRanges=this._getOverlappingTileRanges(m),this.minzoom=this.maxzoom=this.tileID.z,this.tileCoords=m.map((C=>this.tileID.getTilePoint(C)._round())),this.flippedWindingOrder=((w=this.tileCoords)[1].x-w[0].x)*(w[2].y-w[0].y)-(w[1].y-w[0].y)*(w[2].x-w[0].x)<0,this.fire(new o.l("data",{dataType:"source",sourceDataType:"content"})),this}prepare(){if(Object.keys(this.tiles).length===0||!this.image)return;const l=this.map.painter.context,m=l.gl;this.texture||(this.texture=new o.T(l,this.image,m.RGBA),this.texture.bind(m.LINEAR,m.CLAMP_TO_EDGE));let w=!1;for(const C in this.tiles){const N=this.tiles[C];N.state!=="loaded"&&(N.state="loaded",N.texture=this.texture,w=!0)}w&&this.fire(new o.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}loadTile(l){return o._(this,void 0,void 0,(function*(){this.tileID&&this.tileID.equals(l.tileID.canonical)?(this.tiles[String(l.tileID.wrap)]=l,l.buckets={}):l.state="errored"}))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}_getOverlappingTileRanges(l){const{minX:m,minY:w,maxX:C,maxY:N}=o.a2.fromPoints(l),j={};for(let Y=0;Y<=o.a3;Y++){const te=Math.pow(2,Y),ue=Math.floor(m*te),ge=Math.floor(w*te),Ce=Math.floor(C*te),Se=Math.floor(N*te);j[Y]={minTileX:ue,minTileY:ge,maxTileX:Ce,maxTileY:Se}}return j}}class yr extends vt{constructor(l,m,w,C){super(l,m,w,C),this.roundZoom=!0,this.type="video",this.options=m}load(){return o._(this,void 0,void 0,(function*(){this._loaded=!1;const l=this.options;this.urls=[];for(const m of l.urls)this.urls.push(this.map._requestManager.transformRequest(m,"Source").url);try{const m=yield o.a5(this.urls);if(this._loaded=!0,!m)return;this.video=m,this.video.loop=!0,this.video.addEventListener("playing",(()=>{this.map.triggerRepaint()})),this.map&&this.video.play(),this._finishLoading()}catch(m){this.fire(new o.k(m))}}))}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(l){if(this.video){const m=this.video.seekable;l<m.start(0)||l>m.end(0)?this.fire(new o.k(new o.a6(`sources.${this.id}`,null,`Playback for this video can be set only between the ${m.start(0)} and ${m.end(0)}-second mark.`))):this.video.currentTime=l}}getVideo(){return this.video}onAdd(l){this.map||(this.map=l,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const l=this.map.painter.context,m=l.gl;this.texture?this.video.paused||(this.texture.bind(m.LINEAR,m.CLAMP_TO_EDGE),m.texSubImage2D(m.TEXTURE_2D,0,0,0,m.RGBA,m.UNSIGNED_BYTE,this.video)):(this.texture=new o.T(l,this.video,m.RGBA),this.texture.bind(m.LINEAR,m.CLAMP_TO_EDGE));let w=!1;for(const C in this.tiles){const N=this.tiles[C];N.state!=="loaded"&&(N.state="loaded",N.texture=this.texture,w=!0)}w&&this.fire(new o.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}}class _r extends vt{constructor(l,m,w,C){super(l,m,w,C),m.coordinates?Array.isArray(m.coordinates)&&m.coordinates.length===4&&!m.coordinates.some((N=>!Array.isArray(N)||N.length!==2||N.some((j=>typeof j!="number"))))||this.fire(new o.k(new o.a6(`sources.${l}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new o.k(new o.a6(`sources.${l}`,null,'missing required property "coordinates"'))),m.animate&&typeof m.animate!="boolean"&&this.fire(new o.k(new o.a6(`sources.${l}`,null,'optional "animate" property must be a boolean value'))),m.canvas?typeof m.canvas=="string"||m.canvas instanceof HTMLCanvasElement||this.fire(new o.k(new o.a6(`sources.${l}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new o.k(new o.a6(`sources.${l}`,null,'missing required property "canvas"'))),this.options=m,this.animate=m.animate===void 0||m.animate}load(){return o._(this,void 0,void 0,(function*(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new o.k(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}))}getCanvas(){return this.canvas}onAdd(l){this.map=l,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let l=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,l=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,l=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const m=this.map.painter.context,w=m.gl;this.texture?(l||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new o.T(m,this.canvas,w.RGBA,{premultiply:!0});let C=!1;for(const N in this.tiles){const j=this.tiles[N];j.state!=="loaded"&&(j.state="loaded",j.texture=this.texture,C=!0)}C&&this.fire(new o.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const l of[this.canvas.width,this.canvas.height])if(isNaN(l)||l<=0)return!0;return!1}}const cr={},Er=R=>{switch(R){case"geojson":return pr;case"image":return vt;case"raster":return Xt;case"raster-dem":return Yt;case"vector":return je;case"video":return yr;case"canvas":return _r}return cr[R]},wr="RTLPluginLoaded";class er extends o.E{constructor(){super(...arguments),this.status="unavailable",this.url=null,this.dispatcher=$e()}_syncState(l){return this.status=l,this.dispatcher.broadcast("SRPS",{pluginStatus:l,pluginURL:this.url}).catch((m=>{throw this.status="error",m}))}getRTLTextPluginStatus(){return this.status}clearRTLTextPlugin(){this.status="unavailable",this.url=null}setRTLTextPlugin(l){return o._(this,arguments,void 0,(function*(m,w=!1){if(this.url)throw new Error("setRTLTextPlugin cannot be called multiple times.");if(this.url=b.resolveURL(m),!this.url)throw new Error(`requested url ${m} is invalid`);if(this.status==="unavailable"){if(!w)return this._requestImport();this.status="deferred",this._syncState(this.status)}else if(this.status==="requested")return this._requestImport()}))}_requestImport(){return o._(this,void 0,void 0,(function*(){yield this._syncState("loading"),this.status="loaded",this.fire(new o.l(wr))}))}lazyLoad(){this.status==="unavailable"?this.status="requested":this.status==="deferred"&&this._requestImport()}}let lr=null;function Ar(){return lr||(lr=new er),lr}class ir{constructor(l,m){this.timeAdded=0,this.fadeEndTime=0,this.tileID=l,this.uid=o.a7(),this.uses=0,this.tileSize=m,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.rtt=[],this.rttCoords={},this.expiredRequestCount=0,this.state="loading"}registerFadeDuration(l){const m=l+this.timeAdded;m<this.fadeEndTime||(this.fadeEndTime=m)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}clearTextures(l){this.demTexture&&l.saveTileTexture(this.demTexture),this.demTexture=null}loadVectorData(l,m,w){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",l){l.featureIndex&&(this.latestFeatureIndex=l.featureIndex,l.rawTileData?(this.latestRawTileData=l.rawTileData,this.latestFeatureIndex.rawTileData=l.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=l.collisionBoxArray,this.buckets=(function(C,N){const j={};if(!N)return j;for(const Y of C){const te=Y.layerIds.map((ue=>N.getLayer(ue))).filter(Boolean);if(te.length!==0){Y.layers=te,Y.stateDependentLayerIds&&(Y.stateDependentLayers=Y.stateDependentLayerIds.map((ue=>te.filter((ge=>ge.id===ue))[0])));for(const ue of te)j[ue.id]=Y}}return j})(l.buckets,m?.style),this.hasSymbolBuckets=!1;for(const C in this.buckets){const N=this.buckets[C];if(N instanceof o.a9){if(this.hasSymbolBuckets=!0,!w)break;N.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const C in this.buckets){const N=this.buckets[C];if(N instanceof o.a9&&N.hasRTLText){this.hasRTLText=!0,Ar().lazyLoad();break}}this.queryPadding=0;for(const C in this.buckets){const N=this.buckets[C];this.queryPadding=Math.max(this.queryPadding,m.style.getLayer(C).queryRadius(N))}l.imageAtlas&&(this.imageAtlas=l.imageAtlas),l.glyphAtlasImage&&(this.glyphAtlasImage=l.glyphAtlasImage)}else this.collisionBoxArray=new o.a8}unloadVectorData(){for(const l in this.buckets)this.buckets[l].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"}getBucket(l){return this.buckets[l.id]}upload(l){for(const w in this.buckets){const C=this.buckets[w];C.uploadPending()&&C.upload(l)}const m=l.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new o.T(l,this.imageAtlas.image,m.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new o.T(l,this.glyphAtlasImage,m.ALPHA),this.glyphAtlasImage=null)}prepare(l){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(l,this.imageAtlasTexture)}queryRenderedFeatures(l,m,w,C,N,j,Y,te,ue,ge,Ce){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:C,cameraQueryGeometry:N,scale:j,tileSize:this.tileSize,pixelPosMatrix:ge,transform:te,params:Y,queryPadding:this.queryPadding*ue,getElevation:Ce},l,m,w):{}}querySourceFeatures(l,m){const w=this.latestFeatureIndex;if(!w||!w.rawTileData)return;const C=w.loadVTLayers(),N=m&&m.sourceLayer?m.sourceLayer:"",j=C._geojsonTileLayer||C[N];if(!j)return;const Y=o.aa(m&&m.filter),{z:te,x:ue,y:ge}=this.tileID.canonical,Ce={z:te,x:ue,y:ge};for(let Se=0;Se<j.length;Se++){const Fe=j.feature(Se);if(Y.needGeometry){const lt=o.ab(Fe,!0);if(!Y.filter(new o.F(this.tileID.overscaledZ),lt,this.tileID.canonical))continue}else if(!Y.filter(new o.F(this.tileID.overscaledZ),Fe))continue;const Ge=w.getId(Fe,N),ut=new o.ac(Fe,te,ue,ge,Ge);ut.tile=Ce,l.push(ut)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(l){const m=this.expirationTime;if(l.cacheControl){const w=o.ad(l.cacheControl);w["max-age"]&&(this.expirationTime=Date.now()+1e3*w["max-age"])}else l.expires&&(this.expirationTime=new Date(l.expires).getTime());if(this.expirationTime){const w=Date.now();let C=!1;if(this.expirationTime>w)C=!1;else if(m)if(this.expirationTime<m)C=!0;else{const N=this.expirationTime-m;N?this.expirationTime=w+Math.max(N,3e4):C=!0}else C=!0;C?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(l,m){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(l).length===0)return;const w=this.latestFeatureIndex.loadVTLayers();for(const C in this.buckets){if(!m.style.hasLayer(C))continue;const N=this.buckets[C],j=N.layers[0].sourceLayer||"_geojsonTileLayer",Y=w[j],te=l[j];if(!Y||!te||Object.keys(te).length===0)continue;N.update(te,Y,this.imageAtlas&&this.imageAtlas.patternPositions||{});const ue=m&&m.style&&m.style.getLayer(C);ue&&(this.queryPadding=Math.max(this.queryPadding,ue.queryRadius(N)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<b.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(l){this.symbolFadeHoldUntil=b.now()+l}setDependencies(l,m){const w={};for(const C of m)w[C]=!0;this.dependencies[l]=w}hasDependency(l,m){for(const w of l){const C=this.dependencies[w];if(C){for(const N of m)if(C[N])return!0}}return!1}}class nt{constructor(l,m){this.max=l,this.onRemove=m,this.reset()}reset(){for(const l in this.data)for(const m of this.data[l])m.timeout&&clearTimeout(m.timeout),this.onRemove(m.value);return this.data={},this.order=[],this}add(l,m,w){const C=l.wrapped().key;this.data[C]===void 0&&(this.data[C]=[]);const N={value:m,timeout:void 0};if(w!==void 0&&(N.timeout=setTimeout((()=>{this.remove(l,N)}),w)),this.data[C].push(N),this.order.push(C),this.order.length>this.max){const j=this._getAndRemoveByKey(this.order[0]);j&&this.onRemove(j)}return this}has(l){return l.wrapped().key in this.data}getAndRemove(l){return this.has(l)?this._getAndRemoveByKey(l.wrapped().key):null}_getAndRemoveByKey(l){const m=this.data[l].shift();return m.timeout&&clearTimeout(m.timeout),this.data[l].length===0&&delete this.data[l],this.order.splice(this.order.indexOf(l),1),m.value}getByKey(l){const m=this.data[l];return m?m[0].value:null}get(l){return this.has(l)?this.data[l.wrapped().key][0].value:null}remove(l,m){if(!this.has(l))return this;const w=l.wrapped().key,C=m===void 0?0:this.data[w].indexOf(m),N=this.data[w][C];return this.data[w].splice(C,1),N.timeout&&clearTimeout(N.timeout),this.data[w].length===0&&delete this.data[w],this.onRemove(N.value),this.order.splice(this.order.indexOf(w),1),this}setMaxSize(l){for(this.max=l;this.order.length>this.max;){const m=this._getAndRemoveByKey(this.order[0]);m&&this.onRemove(m)}return this}filter(l){const m=[];for(const w in this.data)for(const C of this.data[w])l(C.value)||m.push(C);for(const w of m)this.remove(w.value.tileID,w)}}class _e{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(l,m,w){const C=String(m);if(this.stateChanges[l]=this.stateChanges[l]||{},this.stateChanges[l][C]=this.stateChanges[l][C]||{},o.e(this.stateChanges[l][C],w),this.deletedStates[l]===null){this.deletedStates[l]={};for(const N in this.state[l])N!==C&&(this.deletedStates[l][N]=null)}else if(this.deletedStates[l]&&this.deletedStates[l][C]===null){this.deletedStates[l][C]={};for(const N in this.state[l][C])w[N]||(this.deletedStates[l][C][N]=null)}else for(const N in w)this.deletedStates[l]&&this.deletedStates[l][C]&&this.deletedStates[l][C][N]===null&&delete this.deletedStates[l][C][N]}removeFeatureState(l,m,w){if(this.deletedStates[l]===null)return;const C=String(m);if(this.deletedStates[l]=this.deletedStates[l]||{},w&&m!==void 0)this.deletedStates[l][C]!==null&&(this.deletedStates[l][C]=this.deletedStates[l][C]||{},this.deletedStates[l][C][w]=null);else if(m!==void 0)if(this.stateChanges[l]&&this.stateChanges[l][C])for(w in this.deletedStates[l][C]={},this.stateChanges[l][C])this.deletedStates[l][C][w]=null;else this.deletedStates[l][C]=null;else this.deletedStates[l]=null}getState(l,m){const w=String(m),C=o.e({},(this.state[l]||{})[w],(this.stateChanges[l]||{})[w]);if(this.deletedStates[l]===null)return{};if(this.deletedStates[l]){const N=this.deletedStates[l][m];if(N===null)return{};for(const j in N)delete C[j]}return C}initializeTileState(l,m){l.setFeatureState(this.state,m)}coalesceChanges(l,m){const w={};for(const C in this.stateChanges){this.state[C]=this.state[C]||{};const N={};for(const j in this.stateChanges[C])this.state[C][j]||(this.state[C][j]={}),o.e(this.state[C][j],this.stateChanges[C][j]),N[j]=this.state[C][j];w[C]=N}for(const C in this.deletedStates){this.state[C]=this.state[C]||{};const N={};if(this.deletedStates[C]===null)for(const j in this.state[C])N[j]={},this.state[C][j]={};else for(const j in this.deletedStates[C]){if(this.deletedStates[C][j]===null)this.state[C][j]={};else for(const Y of Object.keys(this.deletedStates[C][j]))delete this.state[C][j][Y];N[j]=this.state[C][j]}w[C]=w[C]||{},o.e(w[C],N)}if(this.stateChanges={},this.deletedStates={},Object.keys(w).length!==0)for(const C in l)l[C].setFeatureState(w,m)}}const be=89.25;function qe(R,l){const m=o.ah(l.lat,-o.ai,o.ai);return new o.P(o.V(l.lng)*R,o.U(m)*R)}function Qe(R,l){return new o.a1(l.x/R,l.y/R).toLngLat()}function ot(R){return R.cameraToCenterDistance*Math.min(.85*Math.tan(o.ae(90-R.pitch)),Math.tan(o.ae(be-R.pitch)))}function et(R,l){const m=R.canonical,w=l/o.af(m.z),C=m.x+Math.pow(2,m.z)*R.wrap,N=o.ag(new Float64Array(16));return o.M(N,N,[C*w,m.y*w,0]),o.N(N,N,[w/o.$,w/o.$,1]),N}function Lt(R,l,m,w,C){const N=o.a1.fromLngLat(R,l),j=C*o.aj(1,R.lat),Y=j*Math.cos(o.ae(m)),te=Math.sqrt(j*j-Y*Y),ue=te*Math.sin(o.ae(-w)),ge=te*Math.cos(o.ae(-w));return new o.a1(N.x+ue,N.y+ge,N.z+Y)}function _t(R,l,m){const w=l.intersectsFrustum(R);if(!m||w===0)return w;const C=l.intersectsPlane(m);return C===0?0:w===2&&C===2?2:1}function jt(R,l,m){let w=0;const C=(m-l)/10;for(let N=0;N<10;N++)w+=C*Math.pow(Math.cos(l+(N+.5)/10*(m-l)),R);return w}function Jt(R,l){return function(m,w,C,N,j){const Y=2*((R-1)/o.ak(Math.cos(o.ae(be-j))/Math.cos(o.ae(be)))-1),te=Math.acos(C/N),ue=2*jt(Y-1,0,o.ae(j/2)),ge=Math.min(o.ae(be),te+o.ae(j/2)),Ce=jt(Y-1,Math.min(ge,te-o.ae(j/2)),ge),Se=Math.atan(w/C),Fe=Math.hypot(w,C);let Ge=m;return Ge+=o.ak(N/Fe/Math.max(.5,Math.cos(o.ae(j/2)))),Ge+=Y*o.ak(Math.cos(Se))/2,Ge-=o.ak(Math.max(1,Ce/ue/l))/2,Ge}}const Kt=Jt(9.314,3);function Rr(R,l){const m=(l.roundZoom?Math.round:Math.floor)(R.zoom+o.ak(R.tileSize/l.tileSize));return Math.max(0,m)}function bt(R,l){const m=R.getCameraFrustum(),w=R.getClippingPlane(),C=R.screenPointToMercatorCoordinate(R.getCameraPoint()),N=o.a1.fromLngLat(R.center,R.elevation);C.z=N.z+Math.cos(R.pitchInRadians)*R.cameraToCenterDistance/R.worldSize;const j=R.getCoveringTilesDetailsProvider(),Y=j.allowVariableZoom(R,l),te=Rr(R,l),ue=l.minzoom||0,ge=l.maxzoom!==void 0?l.maxzoom:R.maxZoom,Ce=Math.min(Math.max(0,te),ge),Se=Math.pow(2,Ce),Fe=[Se*C.x,Se*C.y,0],Ge=[Se*N.x,Se*N.y,0],ut=Math.hypot(N.x-C.x,N.y-C.y),lt=Math.abs(N.z-C.z),ct=Math.hypot(ut,lt),xt=Ot=>({zoom:0,x:0,y:0,wrap:Ot,fullyVisible:!1}),Pt=[],Ct=[];if(R.renderWorldCopies&&j.allowWorldCopies())for(let Ot=1;Ot<=3;Ot++)Pt.push(xt(-Ot)),Pt.push(xt(Ot));for(Pt.push(xt(0));Pt.length>0;){const Ot=Pt.pop(),Bt=Ot.x,At=Ot.y;let qt=Ot.fullyVisible;const Sr={x:Bt,y:At,z:Ot.zoom},fr=j.getTileBoundingVolume(Sr,Ot.wrap,R.elevation,l);if(!qt){const nn=_t(m,fr,w);if(nn===0)continue;qt=nn===2}const dr=j.distanceToTile2d(C.x,C.y,Sr,fr);let mr=te;Y&&(mr=(l.calculateTileZoom||Kt)(R.zoom+o.ak(R.tileSize/l.tileSize),dr,lt,ct,R.fov)),mr=(l.roundZoom?Math.round:Math.floor)(mr),mr=Math.max(0,mr);const tn=Math.min(mr,ge);if(Ot.wrap=j.getWrap(N,Sr,Ot.wrap),Ot.zoom>=tn){if(Ot.zoom<ue)continue;const nn=Ce-Ot.zoom,qr=Fe[0]-.5-(Bt<<nn),Ln=Fe[1]-.5-(At<<nn),Pi=l.reparseOverscaled?Math.max(Ot.zoom,mr):Ot.zoom;Ct.push({tileID:new o.Z(Ot.zoom===ge?Pi:Ot.zoom,Ot.wrap,Ot.zoom,Bt,At),distanceSq:o.al([Ge[0]-.5-Bt,Ge[1]-.5-At]),tileDistanceToCamera:Math.sqrt(qr*qr+Ln*Ln)})}else for(let nn=0;nn<4;nn++)Pt.push({zoom:Ot.zoom+1,x:(Bt<<1)+nn%2,y:(At<<1)+(nn>>1),wrap:Ot.wrap,fullyVisible:qt})}return Ct.sort(((Ot,Bt)=>Ot.distanceSq-Bt.distanceSq)).map((Ot=>Ot.tileID))}const Tr=o.a2.fromPoints([new o.P(0,0),new o.P(o.$,o.$)]);class Ur extends o.E{constructor(l,m,w){super(),this.id=l,this.dispatcher=w,this.on("data",(C=>this._dataHandler(C))),this.on("dataloading",(()=>{this._sourceErrored=!1})),this.on("error",(()=>{this._sourceErrored=this._source.loaded()})),this._source=((C,N,j,Y)=>{const te=new(Er(N.type))(C,N,j,Y);if(te.id!==C)throw new Error(`Expected Source id to be ${C} instead of ${te.id}`);return te})(l,m,w,this),this._tiles={},this._cache=new nt(0,(C=>this._unloadTile(C))),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._maxTileCacheZoomLevels=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new _e,this._didEmitContent=!1,this._updated=!1}onAdd(l){this.map=l,this._maxTileCacheSize=l?l._maxTileCacheSize:null,this._maxTileCacheZoomLevels=l?l._maxTileCacheZoomLevels:null,this._source&&this._source.onAdd&&this._source.onAdd(l)}onRemove(l){this.clearTiles(),this._source&&this._source.onRemove&&this._source.onRemove(l)}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;if(!(this.used===void 0&&this.usedForTerrain===void 0||this.used||this.usedForTerrain))return!0;if(!this._updated)return!1;for(const l in this._tiles){const m=this._tiles[l];if(m.state!=="loaded"&&m.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const l=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,l&&this.reload(),this.transform&&this.update(this.transform,this.terrain)}_loadTile(l,m,w){return o._(this,void 0,void 0,(function*(){try{yield this._source.loadTile(l),this._tileLoaded(l,m,w)}catch(C){l.state="errored",C.status!==404?this._source.fire(new o.k(C,{tile:l})):this.update(this.transform,this.terrain)}}))}_unloadTile(l){this._source.unloadTile&&this._source.unloadTile(l)}_abortTile(l){this._source.abortTile&&this._source.abortTile(l),this._source.fire(new o.l("dataabort",{tile:l,coord:l.tileID,dataType:"source"}))}serialize(){return this._source.serialize()}prepare(l){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const m in this._tiles){const w=this._tiles[m];w.upload(l),w.prepare(this.map.style.imageManager)}}getIds(){return Object.values(this._tiles).map((l=>l.tileID)).sort(Gr).map((l=>l.key))}getRenderableIds(l){const m=[];for(const w in this._tiles)this._isIdRenderable(w,l)&&m.push(this._tiles[w]);return l?m.sort(((w,C)=>{const N=w.tileID,j=C.tileID,Y=new o.P(N.canonical.x,N.canonical.y)._rotate(-this.transform.bearingInRadians),te=new o.P(j.canonical.x,j.canonical.y)._rotate(-this.transform.bearingInRadians);return N.overscaledZ-j.overscaledZ||te.y-Y.y||te.x-Y.x})).map((w=>w.tileID.key)):m.map((w=>w.tileID)).sort(Gr).map((w=>w.key))}hasRenderableParent(l){const m=this.findLoadedParent(l,0);return!!m&&this._isIdRenderable(m.tileID.key)}_isIdRenderable(l,m){return this._tiles[l]&&this._tiles[l].hasData()&&!this._coveredTiles[l]&&(m||!this._tiles[l].holdingForFade())}reload(l){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const m in this._tiles)l?this._reloadTile(m,"expired"):this._tiles[m].state!=="errored"&&this._reloadTile(m,"reloading")}}_reloadTile(l,m){return o._(this,void 0,void 0,(function*(){const w=this._tiles[l];w&&(w.state!=="loading"&&(w.state=m),yield this._loadTile(w,l,m))}))}_tileLoaded(l,m,w){l.timeAdded=b.now(),w==="expired"&&(l.refreshedUponExpiration=!0),this._setTileReloadTimer(m,l),this.getSource().type==="raster-dem"&&l.dem&&this._backfillDEM(l),this._state.initializeTileState(l,this.map?this.map.painter:null),l.aborted||this._source.fire(new o.l("data",{dataType:"source",tile:l,coord:l.tileID}))}_backfillDEM(l){const m=this.getRenderableIds();for(let C=0;C<m.length;C++){const N=m[C];if(l.neighboringTiles&&l.neighboringTiles[N]){const j=this.getTileByID(N);w(l,j),w(j,l)}}function w(C,N){C.needsHillshadePrepare=!0,C.needsTerrainPrepare=!0;let j=N.tileID.canonical.x-C.tileID.canonical.x;const Y=N.tileID.canonical.y-C.tileID.canonical.y,te=Math.pow(2,C.tileID.canonical.z),ue=N.tileID.key;j===0&&Y===0||Math.abs(Y)>1||(Math.abs(j)>1&&(Math.abs(j+te)===1?j+=te:Math.abs(j-te)===1&&(j-=te)),N.dem&&C.dem&&(C.dem.backfillBorder(N.dem,j,Y),C.neighboringTiles&&C.neighboringTiles[ue]&&(C.neighboringTiles[ue].backfilled=!0)))}}getTile(l){return this.getTileByID(l.key)}getTileByID(l){return this._tiles[l]}_retainLoadedChildren(l,m,w,C){for(const N in this._tiles){let j=this._tiles[N];if(C[N]||!j.hasData()||j.tileID.overscaledZ<=m||j.tileID.overscaledZ>w)continue;let Y=j.tileID;for(;j&&j.tileID.overscaledZ>m+1;){const ue=j.tileID.scaledTo(j.tileID.overscaledZ-1);j=this._tiles[ue.key],j&&j.hasData()&&(Y=ue)}let te=Y;for(;te.overscaledZ>m;)if(te=te.scaledTo(te.overscaledZ-1),l[te.key]||l[te.canonical.key]){C[Y.key]=Y;break}}}findLoadedParent(l,m){if(l.key in this._loadedParentTiles){const w=this._loadedParentTiles[l.key];return w&&w.tileID.overscaledZ>=m?w:null}for(let w=l.overscaledZ-1;w>=m;w--){const C=l.scaledTo(w),N=this._getLoadedTile(C);if(N)return N}}findLoadedSibling(l){return this._getLoadedTile(l)}_getLoadedTile(l){const m=this._tiles[l.key];return m&&m.hasData()?m:this._cache.getByKey(l.wrapped().key)}updateCacheSize(l){const m=Math.ceil(l.width/this._source.tileSize)+1,w=Math.ceil(l.height/this._source.tileSize)+1,C=Math.floor(m*w*(this._maxTileCacheZoomLevels===null?o.a.MAX_TILE_CACHE_ZOOM_LEVELS:this._maxTileCacheZoomLevels)),N=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,C):C;this._cache.setMaxSize(N)}handleWrapJump(l){const m=Math.round((l-(this._prevLng===void 0?l:this._prevLng))/360);if(this._prevLng=l,m){const w={};for(const C in this._tiles){const N=this._tiles[C];N.tileID=N.tileID.unwrapTo(N.tileID.wrap+m),w[N.tileID.key]=N}this._tiles=w;for(const C in this._timers)clearTimeout(this._timers[C]),delete this._timers[C];for(const C in this._tiles)this._setTileReloadTimer(C,this._tiles[C])}}_updateCoveredAndRetainedTiles(l,m,w,C,N,j){const Y={},te={},ue=Object.keys(l),ge=b.now();for(const Ce of ue){const Se=l[Ce],Fe=this._tiles[Ce];if(!Fe||Fe.fadeEndTime!==0&&Fe.fadeEndTime<=ge)continue;const Ge=this.findLoadedParent(Se,m),ut=this.findLoadedSibling(Se),lt=Ge||ut||null;lt&&(this._addTile(lt.tileID),Y[lt.tileID.key]=lt.tileID),te[Ce]=Se}this._retainLoadedChildren(te,C,w,l);for(const Ce in Y)l[Ce]||(this._coveredTiles[Ce]=!0,l[Ce]=Y[Ce]);if(j){const Ce={},Se={};for(const Fe of N)this._tiles[Fe.key].hasData()?Ce[Fe.key]=Fe:Se[Fe.key]=Fe;for(const Fe in Se){const Ge=Se[Fe].children(this._source.maxzoom);this._tiles[Ge[0].key]&&this._tiles[Ge[1].key]&&this._tiles[Ge[2].key]&&this._tiles[Ge[3].key]&&(Ce[Ge[0].key]=l[Ge[0].key]=Ge[0],Ce[Ge[1].key]=l[Ge[1].key]=Ge[1],Ce[Ge[2].key]=l[Ge[2].key]=Ge[2],Ce[Ge[3].key]=l[Ge[3].key]=Ge[3],delete Se[Fe])}for(const Fe in Se){const Ge=Se[Fe],ut=this.findLoadedParent(Ge,this._source.minzoom),lt=this.findLoadedSibling(Ge),ct=ut||lt||null;if(ct){Ce[ct.tileID.key]=l[ct.tileID.key]=ct.tileID;for(const xt in Ce)Ce[xt].isChildOf(ct.tileID)&&delete Ce[xt]}}for(const Fe in this._tiles)Ce[Fe]||(this._coveredTiles[Fe]=!0)}}update(l,m){if(!this._sourceLoaded||this._paused)return;let w;this.transform=l,this.terrain=m,this.updateCacheSize(l),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?w=l.getVisibleUnwrappedCoordinates(this._source.tileID).map((ge=>new o.Z(ge.canonical.z,ge.wrap,ge.canonical.z,ge.canonical.x,ge.canonical.y))):(w=bt(l,{tileSize:this.usedForTerrain?this.tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:!this.usedForTerrain&&this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled,terrain:m,calculateTileZoom:this._source.calculateTileZoom}),this._source.hasTile&&(w=w.filter((ge=>this._source.hasTile(ge))))):w=[];const C=Rr(l,this._source),N=Math.max(C-Ur.maxOverzooming,this._source.minzoom),j=Math.max(C+Ur.maxUnderzooming,this._source.minzoom);if(this.usedForTerrain){const ge={};for(const Ce of w)if(Ce.canonical.z>this._source.minzoom){const Se=Ce.scaledTo(Ce.canonical.z-1);ge[Se.key]=Se;const Fe=Ce.scaledTo(Math.max(this._source.minzoom,Math.min(Ce.canonical.z,5)));ge[Fe.key]=Fe}w=w.concat(Object.values(ge))}const Y=w.length===0&&!this._updated&&this._didEmitContent;this._updated=!0,Y&&this.fire(new o.l("data",{sourceDataType:"idle",dataType:"source",sourceId:this.id}));const te=this._updateRetainedTiles(w,C);Jr(this._source.type)&&this._updateCoveredAndRetainedTiles(te,N,j,C,w,m);for(const ge in te)this._tiles[ge].clearFadeHold();const ue=o.am(this._tiles,te);for(const ge of ue){const Ce=this._tiles[ge];Ce.hasSymbolBuckets&&!Ce.holdingForFade()?Ce.setHoldDuration(this.map._fadeDuration):Ce.hasSymbolBuckets&&!Ce.symbolFadeFinished()||this._removeTile(ge)}this._updateLoadedParentTileCache(),this._updateLoadedSiblingTileCache()}releaseSymbolFadeTiles(){for(const l in this._tiles)this._tiles[l].holdingForFade()&&this._removeTile(l)}_updateRetainedTiles(l,m){var w;const C={},N={},j=Math.max(m-Ur.maxOverzooming,this._source.minzoom),Y=Math.max(m+Ur.maxUnderzooming,this._source.minzoom),te={};for(const ue of l){const ge=this._addTile(ue);C[ue.key]=ue,ge.hasData()||m<this._source.maxzoom&&(te[ue.key]=ue)}this._retainLoadedChildren(te,m,Y,C);for(const ue of l){let ge=this._tiles[ue.key];if(ge.hasData())continue;if(m+1>this._source.maxzoom){const Se=ue.children(this._source.maxzoom)[0],Fe=this.getTile(Se);if(Fe&&Fe.hasData()){C[Se.key]=Se;continue}}else{const Se=ue.children(this._source.maxzoom);if(C[Se[0].key]&&C[Se[1].key]&&C[Se[2].key]&&C[Se[3].key])continue}let Ce=ge.wasRequested();for(let Se=ue.overscaledZ-1;Se>=j;--Se){const Fe=ue.scaledTo(Se);if(N[Fe.key])break;if(N[Fe.key]=!0,ge=this.getTile(Fe),!ge&&Ce&&(ge=this._addTile(Fe)),ge){const Ge=ge.hasData();if((Ge||!(!((w=this.map)===null||w===void 0)&&w.cancelPendingTileRequestsWhileZooming)||Ce)&&(C[Fe.key]=Fe),Ce=ge.wasRequested(),Ge)break}}}return C}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const l in this._tiles){const m=[];let w,C=this._tiles[l].tileID;for(;C.overscaledZ>0;){if(C.key in this._loadedParentTiles){w=this._loadedParentTiles[C.key];break}m.push(C.key);const N=C.scaledTo(C.overscaledZ-1);if(w=this._getLoadedTile(N),w)break;C=N}for(const N of m)this._loadedParentTiles[N]=w}}_updateLoadedSiblingTileCache(){this._loadedSiblingTiles={};for(const l in this._tiles){const m=this._tiles[l].tileID,w=this._getLoadedTile(m);this._loadedSiblingTiles[m.key]=w}}_addTile(l){let m=this._tiles[l.key];if(m)return m;m=this._cache.getAndRemove(l),m&&(this._setTileReloadTimer(l.key,m),m.tileID=l,this._state.initializeTileState(m,this.map?this.map.painter:null),this._cacheTimers[l.key]&&(clearTimeout(this._cacheTimers[l.key]),delete this._cacheTimers[l.key],this._setTileReloadTimer(l.key,m)));const w=m;return m||(m=new ir(l,this._source.tileSize*l.overscaleFactor()),this._loadTile(m,l.key,m.state)),m.uses++,this._tiles[l.key]=m,w||this._source.fire(new o.l("dataloading",{tile:m,coord:m.tileID,dataType:"source"})),m}_setTileReloadTimer(l,m){l in this._timers&&(clearTimeout(this._timers[l]),delete this._timers[l]);const w=m.getExpiryTimeout();w&&(this._timers[l]=setTimeout((()=>{this._reloadTile(l,"expired"),delete this._timers[l]}),w))}refreshTiles(l){for(const m in this._tiles)(this._isIdRenderable(m)||this._tiles[m].state=="errored")&&l.some((w=>w.equals(this._tiles[m].tileID.canonical)))&&this._reloadTile(m,"expired")}_removeTile(l){const m=this._tiles[l];m&&(m.uses--,delete this._tiles[l],this._timers[l]&&(clearTimeout(this._timers[l]),delete this._timers[l]),m.uses>0||(m.hasData()&&m.state!=="reloading"?this._cache.add(m.tileID,m,m.getExpiryTimeout()):(m.aborted=!0,this._abortTile(m),this._unloadTile(m))))}_dataHandler(l){const m=l.sourceDataType;l.dataType==="source"&&m==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&l.dataType==="source"&&m==="content"&&(this.reload(l.sourceDataChanged),this.transform&&this.update(this.transform,this.terrain),this._didEmitContent=!0)}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const l in this._tiles)this._removeTile(l);this._cache.reset()}tilesIn(l,m,w){const C=[],N=this.transform;if(!N)return C;const j=N.getCoveringTilesDetailsProvider().allowWorldCopies(),Y=w?N.getCameraQueryGeometry(l):l,te=Fe=>N.screenPointToMercatorCoordinate(Fe,this.terrain),ue=this.transformBbox(l,te,!j),ge=this.transformBbox(Y,te,!j),Ce=this.getIds(),Se=o.a2.fromPoints(ge);for(let Fe=0;Fe<Ce.length;Fe++){const Ge=this._tiles[Ce[Fe]];if(Ge.holdingForFade())continue;const ut=j?[Ge.tileID]:[Ge.tileID.unwrapTo(-1),Ge.tileID.unwrapTo(0)],lt=Math.pow(2,N.zoom-Ge.tileID.overscaledZ),ct=m*Ge.queryPadding*o.$/Ge.tileSize/lt;for(const xt of ut){const Pt=Se.map((Ct=>xt.getTilePoint(new o.a1(Ct.x,Ct.y))));if(Pt.expandBy(ct),Pt.intersects(Tr)){const Ct=ue.map((Bt=>xt.getTilePoint(Bt))),Ot=ge.map((Bt=>xt.getTilePoint(Bt)));C.push({tile:Ge,tileID:j?xt:xt.unwrapTo(0),queryGeometry:Ct,cameraQueryGeometry:Ot,scale:lt})}}}return C}transformBbox(l,m,w){let C=l.map(m);if(w){const N=o.a2.fromPoints(l);N.shrinkBy(.001*Math.min(N.width(),N.height()));const j=N.map(m);o.a2.fromPoints(C).covers(j)||(C=C.map((Y=>Y.x>.5?new o.a1(Y.x-1,Y.y,Y.z):Y)))}return C}getVisibleCoordinates(l){const m=this.getRenderableIds(l).map((w=>this._tiles[w].tileID));return this.transform&&this.transform.populateCache(m),m}hasTransition(){if(this._source.hasTransition())return!0;if(Jr(this._source.type)){const l=b.now();for(const m in this._tiles)if(this._tiles[m].fadeEndTime>=l)return!0}return!1}setFeatureState(l,m,w){this._state.updateState(l=l||"_geojsonTileLayer",m,w)}removeFeatureState(l,m,w){this._state.removeFeatureState(l=l||"_geojsonTileLayer",m,w)}getFeatureState(l,m){return this._state.getState(l=l||"_geojsonTileLayer",m)}setDependencies(l,m,w){const C=this._tiles[l];C&&C.setDependencies(m,w)}reloadTilesForDependencies(l,m){for(const w in this._tiles)this._tiles[w].hasDependency(l,m)&&this._reloadTile(w,"reloading");this._cache.filter((w=>!w.hasDependency(l,m)))}}function Gr(R,l){const m=Math.abs(2*R.wrap)-+(R.wrap<0),w=Math.abs(2*l.wrap)-+(l.wrap<0);return R.overscaledZ-l.overscaledZ||w-m||l.canonical.y-R.canonical.y||l.canonical.x-R.canonical.x}function Jr(R){return R==="raster"||R==="image"||R==="video"}Ur.maxOverzooming=10,Ur.maxUnderzooming=3;class ar{constructor(l,m){this.reset(l,m)}reset(l,m){this.points=l||[],this._distances=[0];for(let w=1;w<this.points.length;w++)this._distances[w]=this._distances[w-1]+this.points[w].dist(this.points[w-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(m||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(l){if(this.points.length===1)return this.points[0];l=o.ah(l,0,1);let m=1,w=this._distances[m];const C=l*this.paddedLength+this.padding;for(;w<C&&m<this._distances.length;)w=this._distances[++m];const N=m-1,j=this._distances[N],Y=w-j,te=Y>0?(C-j)/Y:0;return this.points[N].mult(1-te).add(this.points[m].mult(te))}}function ti(R,l){let m=!0;return R==="always"||R!=="never"&&l!=="never"||(m=!1),m}class un{constructor(l,m,w){const C=this.boxCells=[],N=this.circleCells=[];this.xCellCount=Math.ceil(l/w),this.yCellCount=Math.ceil(m/w);for(let j=0;j<this.xCellCount*this.yCellCount;j++)C.push([]),N.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=l,this.height=m,this.xScale=this.xCellCount/l,this.yScale=this.yCellCount/m,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(l,m,w,C,N){this._forEachCell(m,w,C,N,this._insertBoxCell,this.boxUid++),this.boxKeys.push(l),this.bboxes.push(m),this.bboxes.push(w),this.bboxes.push(C),this.bboxes.push(N)}insertCircle(l,m,w,C){this._forEachCell(m-C,w-C,m+C,w+C,this._insertCircleCell,this.circleUid++),this.circleKeys.push(l),this.circles.push(m),this.circles.push(w),this.circles.push(C)}_insertBoxCell(l,m,w,C,N,j){this.boxCells[N].push(j)}_insertCircleCell(l,m,w,C,N,j){this.circleCells[N].push(j)}_query(l,m,w,C,N,j,Y){if(w<0||l>this.width||C<0||m>this.height)return[];const te=[];if(l<=0&&m<=0&&this.width<=w&&this.height<=C){if(N)return[{key:null,x1:l,y1:m,x2:w,y2:C}];for(let ue=0;ue<this.boxKeys.length;ue++)te.push({key:this.boxKeys[ue],x1:this.bboxes[4*ue],y1:this.bboxes[4*ue+1],x2:this.bboxes[4*ue+2],y2:this.bboxes[4*ue+3]});for(let ue=0;ue<this.circleKeys.length;ue++){const ge=this.circles[3*ue],Ce=this.circles[3*ue+1],Se=this.circles[3*ue+2];te.push({key:this.circleKeys[ue],x1:ge-Se,y1:Ce-Se,x2:ge+Se,y2:Ce+Se})}}else this._forEachCell(l,m,w,C,this._queryCell,te,{hitTest:N,overlapMode:j,seenUids:{box:{},circle:{}}},Y);return te}query(l,m,w,C){return this._query(l,m,w,C,!1,null)}hitTest(l,m,w,C,N,j){return this._query(l,m,w,C,!0,N,j).length>0}hitTestCircle(l,m,w,C,N){const j=l-w,Y=l+w,te=m-w,ue=m+w;if(Y<0||j>this.width||ue<0||te>this.height)return!1;const ge=[];return this._forEachCell(j,te,Y,ue,this._queryCellCircle,ge,{hitTest:!0,overlapMode:C,circle:{x:l,y:m,radius:w},seenUids:{box:{},circle:{}}},N),ge.length>0}_queryCell(l,m,w,C,N,j,Y,te){const{seenUids:ue,hitTest:ge,overlapMode:Ce}=Y,Se=this.boxCells[N];if(Se!==null){const Ge=this.bboxes;for(const ut of Se)if(!ue.box[ut]){ue.box[ut]=!0;const lt=4*ut,ct=this.boxKeys[ut];if(l<=Ge[lt+2]&&m<=Ge[lt+3]&&w>=Ge[lt+0]&&C>=Ge[lt+1]&&(!te||te(ct))&&(!ge||!ti(Ce,ct.overlapMode))&&(j.push({key:ct,x1:Ge[lt],y1:Ge[lt+1],x2:Ge[lt+2],y2:Ge[lt+3]}),ge))return!0}}const Fe=this.circleCells[N];if(Fe!==null){const Ge=this.circles;for(const ut of Fe)if(!ue.circle[ut]){ue.circle[ut]=!0;const lt=3*ut,ct=this.circleKeys[ut];if(this._circleAndRectCollide(Ge[lt],Ge[lt+1],Ge[lt+2],l,m,w,C)&&(!te||te(ct))&&(!ge||!ti(Ce,ct.overlapMode))){const xt=Ge[lt],Pt=Ge[lt+1],Ct=Ge[lt+2];if(j.push({key:ct,x1:xt-Ct,y1:Pt-Ct,x2:xt+Ct,y2:Pt+Ct}),ge)return!0}}}return!1}_queryCellCircle(l,m,w,C,N,j,Y,te){const{circle:ue,seenUids:ge,overlapMode:Ce}=Y,Se=this.boxCells[N];if(Se!==null){const Ge=this.bboxes;for(const ut of Se)if(!ge.box[ut]){ge.box[ut]=!0;const lt=4*ut,ct=this.boxKeys[ut];if(this._circleAndRectCollide(ue.x,ue.y,ue.radius,Ge[lt+0],Ge[lt+1],Ge[lt+2],Ge[lt+3])&&(!te||te(ct))&&!ti(Ce,ct.overlapMode))return j.push(!0),!0}}const Fe=this.circleCells[N];if(Fe!==null){const Ge=this.circles;for(const ut of Fe)if(!ge.circle[ut]){ge.circle[ut]=!0;const lt=3*ut,ct=this.circleKeys[ut];if(this._circlesCollide(Ge[lt],Ge[lt+1],Ge[lt+2],ue.x,ue.y,ue.radius)&&(!te||te(ct))&&!ti(Ce,ct.overlapMode))return j.push(!0),!0}}}_forEachCell(l,m,w,C,N,j,Y,te){const ue=this._convertToXCellCoord(l),ge=this._convertToYCellCoord(m),Ce=this._convertToXCellCoord(w),Se=this._convertToYCellCoord(C);for(let Fe=ue;Fe<=Ce;Fe++)for(let Ge=ge;Ge<=Se;Ge++)if(N.call(this,l,m,w,C,this.xCellCount*Ge+Fe,j,Y,te))return}_convertToXCellCoord(l){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(l*this.xScale)))}_convertToYCellCoord(l){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(l*this.yScale)))}_circlesCollide(l,m,w,C,N,j){const Y=C-l,te=N-m,ue=w+j;return ue*ue>Y*Y+te*te}_circleAndRectCollide(l,m,w,C,N,j,Y){const te=(j-C)/2,ue=Math.abs(l-(C+te));if(ue>te+w)return!1;const ge=(Y-N)/2,Ce=Math.abs(m-(N+ge));if(Ce>ge+w)return!1;if(ue<=te||Ce<=ge)return!0;const Se=ue-te,Fe=Ce-ge;return Se*Se+Fe*Fe<=w*w}}function ri(R,l,m){const w=o.L();if(!R){const{vecSouth:Ce,vecEast:Se}=Be(l),Fe=h();Fe[0]=Se[0],Fe[1]=Se[1],Fe[2]=Ce[0],Fe[3]=Ce[1],C=Fe,(ge=(j=(N=Fe)[0])*(ue=N[3])-(te=N[2])*(Y=N[1]))&&(C[0]=ue*(ge=1/ge),C[1]=-Y*ge,C[2]=-te*ge,C[3]=j*ge),w[0]=Fe[0],w[1]=Fe[1],w[4]=Fe[2],w[5]=Fe[3]}var C,N,j,Y,te,ue,ge;return o.N(w,w,[1/m,1/m,1]),w}function Ae(R,l,m,w){if(R){const C=o.L();if(!l){const{vecSouth:N,vecEast:j}=Be(m);C[0]=j[0],C[1]=j[1],C[4]=N[0],C[5]=N[1]}return o.N(C,C,[w,w,1]),C}return m.pixelsToClipSpaceMatrix}function Be(R){const l=Math.cos(R.rollInRadians),m=Math.sin(R.rollInRadians),w=Math.cos(R.pitchInRadians),C=Math.cos(R.bearingInRadians),N=Math.sin(R.bearingInRadians),j=o.ar();j[0]=-C*w*m-N*l,j[1]=-N*w*m+C*l;const Y=o.as(j);Y<1e-9?o.at(j):o.au(j,j,1/Y);const te=o.ar();te[0]=C*w*l-N*m,te[1]=N*w*l+C*m;const ue=o.as(te);return ue<1e-9?o.at(te):o.au(te,te,1/ue),{vecEast:te,vecSouth:j}}function mt(R,l,m,w){let C;w?(C=[R,l,w(R,l),1],o.aw(C,C,m)):(C=[R,l,0,1],xa(C,C,m));const N=C[3];return{point:new o.P(C[0]/N,C[1]/N),signedDistanceFromCamera:N,isOccluded:!1}}function pt(R,l){return .5+R/l*.5}function Ir(R,l){return R.x>=-l[0]&&R.x<=l[0]&&R.y>=-l[1]&&R.y<=l[1]}function Fr(R,l,m,w,C,N,j,Y,te,ue,ge,Ce,Se){const Fe=m?R.textSizeData:R.iconSizeData,Ge=o.an(Fe,l.transform.zoom),ut=[256/l.width*2+1,256/l.height*2+1],lt=m?R.text.dynamicLayoutVertexArray:R.icon.dynamicLayoutVertexArray;lt.clear();const ct=R.lineVertexArray,xt=m?R.text.placedSymbolArray:R.icon.placedSymbolArray,Pt=l.transform.width/l.transform.height;let Ct=!1;for(let Ot=0;Ot<xt.length;Ot++){const Bt=xt.get(Ot);if(Bt.hidden||Bt.writingMode===o.ao.vertical&&!Ct){Ka(Bt.numGlyphs,lt);continue}Ct=!1;const At=new o.P(Bt.anchorX,Bt.anchorY),qt={getElevation:Se,pitchedLabelPlaneMatrix:w,lineVertexArray:ct,pitchWithMap:N,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},transform:l.transform,tileAnchorPoint:At,unwrappedTileID:te,width:ue,height:ge,translation:Ce},Sr=Wi(Bt.anchorX,Bt.anchorY,qt);if(!Ir(Sr.point,ut)){Ka(Bt.numGlyphs,lt);continue}const fr=pt(l.transform.cameraToCenterDistance,Sr.signedDistanceFromCamera),dr=o.ap(Fe,Ge,Bt),mr=N?dr*l.transform.getPitchedTextCorrection(Bt.anchorX,Bt.anchorY,te)/fr:dr*fr,tn=zr({projectionContext:qt,pitchedLabelPlaneMatrixInverse:C,symbol:Bt,fontSize:mr,flip:!1,keepUpright:j,glyphOffsetArray:R.glyphOffsetArray,dynamicLayoutVertexArray:lt,aspectRatio:Pt,rotateToLine:Y});Ct=tn.useVertical,(tn.notEnoughRoom||Ct||tn.needsFlipping&&zr({projectionContext:qt,pitchedLabelPlaneMatrixInverse:C,symbol:Bt,fontSize:mr,flip:!0,keepUpright:j,glyphOffsetArray:R.glyphOffsetArray,dynamicLayoutVertexArray:lt,aspectRatio:Pt,rotateToLine:Y}).notEnoughRoom)&&Ka(Bt.numGlyphs,lt)}m?R.text.dynamicLayoutVertexBuffer.updateData(lt):R.icon.dynamicLayoutVertexBuffer.updateData(lt)}function qn(R,l,m,w,C,N,j,Y){const te=N.glyphStartIndex+N.numGlyphs,ue=N.lineStartIndex,ge=N.lineStartIndex+N.lineLength,Ce=l.getoffsetX(N.glyphStartIndex),Se=l.getoffsetX(te-1),Fe=ma(R*Ce,m,w,C,N.segment,ue,ge,Y,j);if(!Fe)return null;const Ge=ma(R*Se,m,w,C,N.segment,ue,ge,Y,j);return Ge?Y.projectionCache.anyProjectionOccluded?null:{first:Fe,last:Ge}:null}function Oi(R,l,m,w){return R===o.ao.horizontal&&Math.abs(m.y-l.y)>Math.abs(m.x-l.x)*w?{useVertical:!0}:(R===o.ao.vertical?l.y<m.y:l.x>m.x)?{needsFlipping:!0}:null}function zr(R){const{projectionContext:l,pitchedLabelPlaneMatrixInverse:m,symbol:w,fontSize:C,flip:N,keepUpright:j,glyphOffsetArray:Y,dynamicLayoutVertexArray:te,aspectRatio:ue,rotateToLine:ge}=R,Ce=C/24,Se=w.lineOffsetX*Ce,Fe=w.lineOffsetY*Ce;let Ge;if(w.numGlyphs>1){const ut=w.glyphStartIndex+w.numGlyphs,lt=w.lineStartIndex,ct=w.lineStartIndex+w.lineLength,xt=qn(Ce,Y,Se,Fe,N,w,ge,l);if(!xt)return{notEnoughRoom:!0};const Pt=pi(xt.first.point.x,xt.first.point.y,l,m),Ct=pi(xt.last.point.x,xt.last.point.y,l,m);if(j&&!N){const Ot=Oi(w.writingMode,Pt,Ct,ue);if(Ot)return Ot}Ge=[xt.first];for(let Ot=w.glyphStartIndex+1;Ot<ut-1;Ot++){const Bt=ma(Ce*Y.getoffsetX(Ot),Se,Fe,N,w.segment,lt,ct,l,ge);if(!Bt)return{notEnoughRoom:!0};Ge.push(Bt)}Ge.push(xt.last)}else{if(j&&!N){const lt=Mi(l.tileAnchorPoint.x,l.tileAnchorPoint.y,l).point,ct=w.lineStartIndex+w.segment+1,xt=new o.P(l.lineVertexArray.getx(ct),l.lineVertexArray.gety(ct)),Pt=Mi(xt.x,xt.y,l),Ct=Pt.signedDistanceFromCamera>0?Pt.point:bn(l.tileAnchorPoint,xt,lt,1,l),Ot=pi(lt.x,lt.y,l,m),Bt=pi(Ct.x,Ct.y,l,m),At=Oi(w.writingMode,Ot,Bt,ue);if(At)return At}const ut=ma(Ce*Y.getoffsetX(w.glyphStartIndex),Se,Fe,N,w.segment,w.lineStartIndex,w.lineStartIndex+w.lineLength,l,ge);if(!ut||l.projectionCache.anyProjectionOccluded)return{notEnoughRoom:!0};Ge=[ut]}for(const ut of Ge)o.av(te,ut.point,ut.angle);return{}}function bn(R,l,m,w,C){const N=R.add(R.sub(l)._unit()),j=Mi(N.x,N.y,C).point,Y=m.sub(j);return m.add(Y._mult(w/Y.mag()))}function Tn(R,l,m){const w=l.projectionCache;if(w.projections[R])return w.projections[R];const C=new o.P(l.lineVertexArray.getx(R),l.lineVertexArray.gety(R)),N=Mi(C.x,C.y,l);if(N.signedDistanceFromCamera>0)return w.projections[R]=N.point,w.anyProjectionOccluded=w.anyProjectionOccluded||N.isOccluded,N.point;const j=R-m.direction;return bn(m.distanceFromAnchor===0?l.tileAnchorPoint:new o.P(l.lineVertexArray.getx(j),l.lineVertexArray.gety(j)),C,m.previousVertex,m.absOffsetX-m.distanceFromAnchor+1,l)}function Mi(R,l,m){const w=R+m.translation[0],C=l+m.translation[1];let N;return m.pitchWithMap?(N=mt(w,C,m.pitchedLabelPlaneMatrix,m.getElevation),N.isOccluded=!1):(N=m.transform.projectTileCoordinates(w,C,m.unwrappedTileID,m.getElevation),N.point.x=(.5*N.point.x+.5)*m.width,N.point.y=(.5*-N.point.y+.5)*m.height),N}function pi(R,l,m,w){if(m.pitchWithMap){const C=[R,l,0,1];return o.aw(C,C,w),m.transform.projectTileCoordinates(C[0]/C[3],C[1]/C[3],m.unwrappedTileID,m.getElevation).point}return{x:R/m.width*2-1,y:1-l/m.height*2}}function Wi(R,l,m){return m.transform.projectTileCoordinates(R,l,m.unwrappedTileID,m.getElevation)}function Fn(R,l,m){return R._unit()._perp()._mult(l*m)}function Ia(R,l,m,w,C,N,j,Y,te){if(Y.projectionCache.offsets[R])return Y.projectionCache.offsets[R];const ue=m.add(l);if(R+te.direction<w||R+te.direction>=C)return Y.projectionCache.offsets[R]=ue,ue;const ge=Tn(R+te.direction,Y,te),Ce=Fn(ge.sub(m),j,te.direction),Se=m.add(Ce),Fe=ge.add(Ce);return Y.projectionCache.offsets[R]=o.ax(N,ue,Se,Fe)||ue,Y.projectionCache.offsets[R]}function ma(R,l,m,w,C,N,j,Y,te){const ue=w?R-l:R+l;let ge=ue>0?1:-1,Ce=0;w&&(ge*=-1,Ce=Math.PI),ge<0&&(Ce+=Math.PI);let Se,Fe=ge>0?N+C:N+C+1;Y.projectionCache.cachedAnchorPoint?Se=Y.projectionCache.cachedAnchorPoint:(Se=Mi(Y.tileAnchorPoint.x,Y.tileAnchorPoint.y,Y).point,Y.projectionCache.cachedAnchorPoint=Se);let Ge,ut,lt=Se,ct=Se,xt=0,Pt=0;const Ct=Math.abs(ue),Ot=[];let Bt;for(;xt+Pt<=Ct;){if(Fe+=ge,Fe<N||Fe>=j)return null;xt+=Pt,ct=lt,ut=Ge;const Sr={absOffsetX:Ct,direction:ge,distanceFromAnchor:xt,previousVertex:ct};if(lt=Tn(Fe,Y,Sr),m===0)Ot.push(ct),Bt=lt.sub(ct);else{let fr;const dr=lt.sub(ct);fr=dr.mag()===0?Fn(Tn(Fe+ge,Y,Sr).sub(lt),m,ge):Fn(dr,m,ge),ut||(ut=ct.add(fr)),Ge=Ia(Fe,fr,lt,N,j,ut,m,Y,Sr),Ot.push(ut),Bt=Ge.sub(ut)}Pt=Bt.mag()}const At=Bt._mult((Ct-xt)/Pt)._add(ut||ct),qt=Ce+Math.atan2(lt.y-ct.y,lt.x-ct.x);return Ot.push(At),{point:At,angle:te?qt:0,path:Ot}}const Gi=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function Ka(R,l){for(let m=0;m<R;m++){const w=l.length;l.resize(w+4),l.float32.set(Gi,3*w)}}function xa(R,l,m){const w=l[0],C=l[1];return R[0]=m[0]*w+m[4]*C+m[12],R[1]=m[1]*w+m[5]*C+m[13],R[3]=m[3]*w+m[7]*C+m[15],R}const Ui=100;class oo{constructor(l,m=new un(l.width+200,l.height+200,25),w=new un(l.width+200,l.height+200,25)){this.transform=l,this.grid=m,this.ignoredGrid=w,this.pitchFactor=Math.cos(l.pitch*Math.PI/180)*l.cameraToCenterDistance,this.screenRightBoundary=l.width+Ui,this.screenBottomBoundary=l.height+Ui,this.gridRightBoundary=l.width+200,this.gridBottomBoundary=l.height+200,this.perspectiveRatioCutoff=.6}placeCollisionBox(l,m,w,C,N,j,Y,te,ue,ge,Ce,Se){const Fe=this.projectAndGetPerspectiveRatio(l.anchorPointX+te[0],l.anchorPointY+te[1],N,ge,Se),Ge=w*Fe.perspectiveRatio;let ut;if(j||Y)ut=this._projectCollisionBox(l,Ge,C,N,j,Y,te,Fe,ge,Ce,Se);else{const Bt=Fe.x+(Ce?Ce.x*Ge:0),At=Fe.y+(Ce?Ce.y*Ge:0);ut={allPointsOccluded:!1,box:[Bt+l.x1*Ge,At+l.y1*Ge,Bt+l.x2*Ge,At+l.y2*Ge]}}const[lt,ct,xt,Pt]=ut.box,Ct=j?ut.allPointsOccluded:Fe.isOccluded;let Ot=Ct;return Ot||(Ot=Fe.perspectiveRatio<this.perspectiveRatioCutoff),Ot||(Ot=!this.isInsideGrid(lt,ct,xt,Pt)),Ot||m!=="always"&&this.grid.hitTest(lt,ct,xt,Pt,m,ue)?{box:[lt,ct,xt,Pt],placeable:!1,offscreen:!1,occluded:Ct}:{box:[lt,ct,xt,Pt],placeable:!0,offscreen:this.isOffscreen(lt,ct,xt,Pt),occluded:Ct}}placeCollisionCircles(l,m,w,C,N,j,Y,te,ue,ge,Ce,Se,Fe,Ge){const ut=[],lt=new o.P(m.anchorX,m.anchorY),ct=this.getPerspectiveRatio(lt.x,lt.y,j,Ge),xt=(ue?N*this.transform.getPitchedTextCorrection(m.anchorX,m.anchorY,j)/ct:N*ct)/o.aB,Pt={getElevation:Ge,pitchedLabelPlaneMatrix:Y,lineVertexArray:w,pitchWithMap:ue,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},transform:this.transform,tileAnchorPoint:lt,unwrappedTileID:j,width:this.transform.width,height:this.transform.height,translation:Fe},Ct=qn(xt,C,m.lineOffsetX*xt,m.lineOffsetY*xt,!1,m,!1,Pt);let Ot=!1,Bt=!1,At=!0;if(Ct){const qt=.5*Ce*ct+Se,Sr=new o.P(-100,-100),fr=new o.P(this.screenRightBoundary,this.screenBottomBoundary),dr=new ar,mr=Ct.first,tn=Ct.last;let nn=[];for(let Pi=mr.path.length-1;Pi>=1;Pi--)nn.push(mr.path[Pi]);for(let Pi=1;Pi<tn.path.length;Pi++)nn.push(tn.path[Pi]);const qr=2.5*qt;if(ue){const Pi=this.projectPathToScreenSpace(nn,Pt);nn=Pi.some((Xi=>Xi.signedDistanceFromCamera<=0))?[]:Pi.map((Xi=>Xi.point))}let Ln=[];if(nn.length>0){const Pi=nn[0].clone(),Xi=nn[0].clone();for(let da=1;da<nn.length;da++)Pi.x=Math.min(Pi.x,nn[da].x),Pi.y=Math.min(Pi.y,nn[da].y),Xi.x=Math.max(Xi.x,nn[da].x),Xi.y=Math.max(Xi.y,nn[da].y);Ln=Pi.x>=Sr.x&&Xi.x<=fr.x&&Pi.y>=Sr.y&&Xi.y<=fr.y?[nn]:Xi.x<Sr.x||Pi.x>fr.x||Xi.y<Sr.y||Pi.y>fr.y?[]:o.ay([nn],Sr.x,Sr.y,fr.x,fr.y)}for(const Pi of Ln){dr.reset(Pi,.25*qt);let Xi=0;Xi=dr.length<=.5*qt?1:Math.ceil(dr.paddedLength/qr)+1;for(let da=0;da<Xi;da++){const oa=da/Math.max(Xi-1,1),ua=dr.lerp(oa),ba=ua.x+Ui,ci=ua.y+Ui;ut.push(ba,ci,qt,0);const ca=ba-qt,ko=ci-qt,rs=ba+qt,Cs=ci+qt;if(At=At&&this.isOffscreen(ca,ko,rs,Cs),Bt=Bt||this.isInsideGrid(ca,ko,rs,Cs),l!=="always"&&this.grid.hitTestCircle(ba,ci,qt,l,ge)&&(Ot=!0,!te))return{circles:[],offscreen:!1,collisionDetected:Ot}}}}return{circles:!te&&Ot||!Bt||ct<this.perspectiveRatioCutoff?[]:ut,offscreen:At,collisionDetected:Ot}}projectPathToScreenSpace(l,m){const w=(function(C,N){const j=o.L();return o.aq(j,N.pitchedLabelPlaneMatrix),C.map((Y=>{const te=mt(Y.x,Y.y,j,N.getElevation),ue=N.transform.projectTileCoordinates(te.point.x,te.point.y,N.unwrappedTileID,N.getElevation);return ue.point.x=(.5*ue.point.x+.5)*N.width,ue.point.y=(.5*-ue.point.y+.5)*N.height,ue}))})(l,m);return(function(C){let N=0,j=0,Y=0,te=0;for(let ue=0;ue<C.length;ue++)C[ue].isOccluded?(Y=ue+1,te=0):(te++,te>j&&(j=te,N=Y));return C.slice(N,N+j)})(w)}queryRenderedSymbols(l){if(l.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const m=[],w=new o.a2;for(const Ce of l){const Se=new o.P(Ce.x+Ui,Ce.y+Ui);w.extend(Se),m.push(Se)}const{minX:C,minY:N,maxX:j,maxY:Y}=w,te=this.grid.query(C,N,j,Y).concat(this.ignoredGrid.query(C,N,j,Y)),ue={},ge={};for(const Ce of te){const Se=Ce.key;if(ue[Se.bucketInstanceId]===void 0&&(ue[Se.bucketInstanceId]={}),ue[Se.bucketInstanceId][Se.featureIndex])continue;const Fe=[new o.P(Ce.x1,Ce.y1),new o.P(Ce.x2,Ce.y1),new o.P(Ce.x2,Ce.y2),new o.P(Ce.x1,Ce.y2)];o.az(m,Fe)&&(ue[Se.bucketInstanceId][Se.featureIndex]=!0,ge[Se.bucketInstanceId]===void 0&&(ge[Se.bucketInstanceId]=[]),ge[Se.bucketInstanceId].push(Se.featureIndex))}return ge}insertCollisionBox(l,m,w,C,N,j){(w?this.ignoredGrid:this.grid).insert({bucketInstanceId:C,featureIndex:N,collisionGroupID:j,overlapMode:m},l[0],l[1],l[2],l[3])}insertCollisionCircles(l,m,w,C,N,j){const Y=w?this.ignoredGrid:this.grid,te={bucketInstanceId:C,featureIndex:N,collisionGroupID:j,overlapMode:m};for(let ue=0;ue<l.length;ue+=4)Y.insertCircle(te,l[ue],l[ue+1],l[ue+2])}projectAndGetPerspectiveRatio(l,m,w,C,N){if(N){let j;C?(j=[l,m,C(l,m),1],o.aw(j,j,N)):(j=[l,m,0,1],xa(j,j,N));const Y=j[3];return{x:(j[0]/Y+1)/2*this.transform.width+Ui,y:(-j[1]/Y+1)/2*this.transform.height+Ui,perspectiveRatio:.5+this.transform.cameraToCenterDistance/Y*.5,isOccluded:!1,signedDistanceFromCamera:Y}}{const j=this.transform.projectTileCoordinates(l,m,w,C);return{x:(j.point.x+1)/2*this.transform.width+Ui,y:(1-j.point.y)/2*this.transform.height+Ui,perspectiveRatio:.5+this.transform.cameraToCenterDistance/j.signedDistanceFromCamera*.5,isOccluded:j.isOccluded,signedDistanceFromCamera:j.signedDistanceFromCamera}}}getPerspectiveRatio(l,m,w,C){const N=this.transform.projectTileCoordinates(l,m,w,C);return .5+this.transform.cameraToCenterDistance/N.signedDistanceFromCamera*.5}isOffscreen(l,m,w,C){return w<Ui||l>=this.screenRightBoundary||C<Ui||m>this.screenBottomBoundary}isInsideGrid(l,m,w,C){return w>=0&&l<this.gridRightBoundary&&C>=0&&m<this.gridBottomBoundary}getViewportMatrix(){const l=o.ag([]);return o.M(l,l,[-100,-100,0]),l}_projectCollisionBox(l,m,w,C,N,j,Y,te,ue,ge,Ce){let Se=1,Fe=0,Ge=0,ut=1;const lt=l.anchorPointX+Y[0],ct=l.anchorPointY+Y[1];if(j&&!N){const nn=this.projectAndGetPerspectiveRatio(lt+1,ct,C,ue,Ce),qr=nn.x-te.x,Ln=Math.atan((nn.y-te.y)/qr)+(qr<0?Math.PI:0),Pi=Math.sin(Ln),Xi=Math.cos(Ln);Se=Xi,Fe=Pi,Ge=-Pi,ut=Xi}else if(!j&&N){const nn=Be(this.transform);Se=nn.vecEast[0],Fe=nn.vecEast[1],Ge=nn.vecSouth[0],ut=nn.vecSouth[1]}let xt=te.x,Pt=te.y,Ct=m;N&&(xt=lt,Pt=ct,Ct=Math.pow(2,-(this.transform.zoom-w.overscaledZ)),Ct*=this.transform.getPitchedTextCorrection(lt,ct,C),ge||(Ct*=o.ah(.5+te.signedDistanceFromCamera/this.transform.cameraToCenterDistance*.5,0,4))),ge&&(xt+=Se*ge.x*Ct+Ge*ge.y*Ct,Pt+=Fe*ge.x*Ct+ut*ge.y*Ct);const Ot=l.x1*Ct,Bt=l.x2*Ct,At=(Ot+Bt)/2,qt=l.y1*Ct,Sr=l.y2*Ct,fr=(qt+Sr)/2,dr=[{offsetX:Ot,offsetY:qt},{offsetX:At,offsetY:qt},{offsetX:Bt,offsetY:qt},{offsetX:Bt,offsetY:fr},{offsetX:Bt,offsetY:Sr},{offsetX:At,offsetY:Sr},{offsetX:Ot,offsetY:Sr},{offsetX:Ot,offsetY:fr}];let mr=[];for(const{offsetX:nn,offsetY:qr}of dr)mr.push(new o.P(xt+Se*nn+Ge*qr,Pt+Fe*nn+ut*qr));let tn=!1;if(N){const nn=mr.map((qr=>this.projectAndGetPerspectiveRatio(qr.x,qr.y,C,ue,Ce)));tn=nn.some((qr=>!qr.isOccluded)),mr=nn.map((qr=>new o.P(qr.x,qr.y)))}else tn=!0;return{box:o.aA(mr),allPointsOccluded:!tn}}}class Ja{constructor(l,m,w,C){this.opacity=l?Math.max(0,Math.min(1,l.opacity+(l.placed?m:-m))):C&&w?1:0,this.placed=w}isHidden(){return this.opacity===0&&!this.placed}}class Hn{constructor(l,m,w,C,N){this.text=new Ja(l?l.text:null,m,w,N),this.icon=new Ja(l?l.icon:null,m,C,N)}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class bu{constructor(l,m,w){this.text=l,this.icon=m,this.skipFade=w}}class ru{constructor(l,m,w,C,N){this.bucketInstanceId=l,this.featureIndex=m,this.sourceLayerIndex=w,this.bucketIndex=C,this.tileID=N}}class Pa{constructor(l){this.crossSourceCollisions=l,this.maxGroupID=0,this.collisionGroups={}}get(l){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[l]){const m=++this.maxGroupID;this.collisionGroups[l]={ID:m,predicate:w=>w.collisionGroupID===m}}return this.collisionGroups[l]}}function wa(R,l,m,w,C){const{horizontalAlign:N,verticalAlign:j}=o.aH(R);return new o.P(-(N-.5)*l+w[0]*C,-(j-.5)*m+w[1]*C)}class Wo{constructor(l,m,w,C,N){this.transform=l.clone(),this.terrain=m,this.collisionIndex=new oo(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=w,this.retainedQueryData={},this.collisionGroups=new Pa(C),this.collisionCircleArrays={},this.collisionBoxArrays=new Map,this.prevPlacement=N,N&&(N.prevPlacement=void 0),this.placedOrientations={}}_getTerrainElevationFunc(l){const m=this.terrain;return m?(w,C)=>m.getElevation(l,w,C):null}getBucketParts(l,m,w,C){const N=w.getBucket(m),j=w.latestFeatureIndex;if(!N||!j||m.id!==N.layerIds[0])return;const Y=w.collisionBoxArray,te=N.layers[0].layout,ue=N.layers[0].paint,ge=Math.pow(2,this.transform.zoom-w.tileID.overscaledZ),Ce=w.tileSize/o.$,Se=w.tileID.toUnwrapped(),Fe=te.get("text-rotation-alignment")==="map",Ge=o.aC(w,1,this.transform.zoom),ut=o.aD(this.collisionIndex.transform,w,ue.get("text-translate"),ue.get("text-translate-anchor")),lt=o.aD(this.collisionIndex.transform,w,ue.get("icon-translate"),ue.get("icon-translate-anchor")),ct=ri(Fe,this.transform,Ge);this.retainedQueryData[N.bucketInstanceId]=new ru(N.bucketInstanceId,j,N.sourceLayerIndex,N.index,w.tileID);const xt={bucket:N,layout:te,translationText:ut,translationIcon:lt,unwrappedTileID:Se,pitchedLabelPlaneMatrix:ct,scale:ge,textPixelRatio:Ce,holdingForFade:w.holdingForFade(),collisionBoxArray:Y,partiallyEvaluatedTextSize:o.an(N.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(N.sourceID)};if(C)for(const Pt of N.sortKeyRanges){const{sortKey:Ct,symbolInstanceStart:Ot,symbolInstanceEnd:Bt}=Pt;l.push({sortKey:Ct,symbolInstanceStart:Ot,symbolInstanceEnd:Bt,parameters:xt})}else l.push({symbolInstanceStart:0,symbolInstanceEnd:N.symbolInstances.length,parameters:xt})}attemptAnchorPlacement(l,m,w,C,N,j,Y,te,ue,ge,Ce,Se,Fe,Ge,ut,lt,ct,xt,Pt,Ct){const Ot=o.aE[l.textAnchor],Bt=[l.textOffset0,l.textOffset1],At=wa(Ot,w,C,Bt,N),qt=this.collisionIndex.placeCollisionBox(m,Se,te,ue,ge,Y,j,lt,Ce.predicate,Pt,At,Ct);if((!xt||this.collisionIndex.placeCollisionBox(xt,Se,te,ue,ge,Y,j,ct,Ce.predicate,Pt,At,Ct).placeable)&&qt.placeable){let Sr;if(this.prevPlacement&&this.prevPlacement.variableOffsets[Fe.crossTileID]&&this.prevPlacement.placements[Fe.crossTileID]&&this.prevPlacement.placements[Fe.crossTileID].text&&(Sr=this.prevPlacement.variableOffsets[Fe.crossTileID].anchor),Fe.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");return this.variableOffsets[Fe.crossTileID]={textOffset:Bt,width:w,height:C,anchor:Ot,textBoxScale:N,prevAnchor:Sr},this.markUsedJustification(Ge,Ot,Fe,ut),Ge.allowVerticalPlacement&&(this.markUsedOrientation(Ge,ut,Fe),this.placedOrientations[Fe.crossTileID]=ut),{shift:At,placedGlyphBoxes:qt}}}placeLayerBucketPart(l,m,w){const{bucket:C,layout:N,translationText:j,translationIcon:Y,unwrappedTileID:te,pitchedLabelPlaneMatrix:ue,textPixelRatio:ge,holdingForFade:Ce,collisionBoxArray:Se,partiallyEvaluatedTextSize:Fe,collisionGroup:Ge}=l.parameters,ut=N.get("text-optional"),lt=N.get("icon-optional"),ct=o.aF(N,"text-overlap","text-allow-overlap"),xt=ct==="always",Pt=o.aF(N,"icon-overlap","icon-allow-overlap"),Ct=Pt==="always",Ot=N.get("text-rotation-alignment")==="map",Bt=N.get("text-pitch-alignment")==="map",At=N.get("icon-text-fit")!=="none",qt=N.get("symbol-z-order")==="viewport-y",Sr=xt&&(Ct||!C.hasIconData()||lt),fr=Ct&&(xt||!C.hasTextData()||ut);!C.collisionArrays&&Se&&C.deserializeCollisionBoxes(Se);const dr=this.retainedQueryData[C.bucketInstanceId].tileID,mr=this._getTerrainElevationFunc(dr),tn=this.transform.getFastPathSimpleProjectionMatrix(dr),nn=(qr,Ln,Pi)=>{var Xi,da;if(m[qr.crossTileID])return;if(Ce)return void(this.placements[qr.crossTileID]=new bu(!1,!1,!1));let oa=!1,ua=!1,ba=!0,ci=null,ca={box:null,placeable:!1,offscreen:null,occluded:!1},ko={placeable:!1},rs=null,Cs=null,$s=null,lu=0,Af=0,If=0;Ln.textFeatureIndex?lu=Ln.textFeatureIndex:qr.useRuntimeCollisionCircles&&(lu=qr.featureIndex),Ln.verticalTextFeatureIndex&&(Af=Ln.verticalTextFeatureIndex);const fp=Ln.textBox;if(fp){const Iu=As=>{let qs=o.ao.horizontal;if(C.allowVerticalPlacement&&!As&&this.prevPlacement){const fc=this.prevPlacement.placedOrientations[qr.crossTileID];fc&&(this.placedOrientations[qr.crossTileID]=fc,qs=fc,this.markUsedOrientation(C,qs,qr))}return qs},Fc=(As,qs)=>{if(C.allowVerticalPlacement&&qr.numVerticalGlyphVertices>0&&Ln.verticalTextBox){for(const fc of C.writingModes)if(fc===o.ao.vertical?(ca=qs(),ko=ca):ca=As(),ca&&ca.placeable)break}else ca=As()},uu=qr.textAnchorOffsetStartIndex,Pf=qr.textAnchorOffsetEndIndex;if(Pf===uu){const As=(qs,fc)=>{const Is=this.collisionIndex.placeCollisionBox(qs,ct,ge,dr,te,Bt,Ot,j,Ge.predicate,mr,void 0,tn);return Is&&Is.placeable&&(this.markUsedOrientation(C,fc,qr),this.placedOrientations[qr.crossTileID]=fc),Is};Fc((()=>As(fp,o.ao.horizontal)),(()=>{const qs=Ln.verticalTextBox;return C.allowVerticalPlacement&&qr.numVerticalGlyphVertices>0&&qs?As(qs,o.ao.vertical):{box:null,offscreen:null}})),Iu(ca&&ca.placeable)}else{let As=o.aE[(da=(Xi=this.prevPlacement)===null||Xi===void 0?void 0:Xi.variableOffsets[qr.crossTileID])===null||da===void 0?void 0:da.anchor];const qs=(Is,Sg,pp)=>{const Uh=Is.x2-Is.x1,Bc=Is.y2-Is.y1,kf=qr.textBoxScale,bx=At&&Pt==="never"?Sg:null;let Ku=null,xx=ct==="never"?1:2,Z0="never";As&&xx++;for(let sy=0;sy<xx;sy++){for(let ly=uu;ly<Pf;ly++){const Mf=C.textAnchorOffsets.get(ly);if(As&&Mf.textAnchor!==As)continue;const Vh=this.attemptAnchorPlacement(Mf,Is,Uh,Bc,kf,Ot,Bt,ge,dr,te,Ge,Z0,qr,C,pp,j,Y,bx,mr);if(Vh&&(Ku=Vh.placedGlyphBoxes,Ku&&Ku.placeable))return oa=!0,ci=Vh.shift,Ku}As?As=null:Z0=ct}return w&&!Ku&&(Ku={box:this.collisionIndex.placeCollisionBox(fp,"always",ge,dr,te,Bt,Ot,j,Ge.predicate,mr,void 0,tn).box,offscreen:!1,placeable:!1,occluded:!1}),Ku};Fc((()=>qs(fp,Ln.iconBox,o.ao.horizontal)),(()=>{const Is=Ln.verticalTextBox;return C.allowVerticalPlacement&&(!ca||!ca.placeable)&&qr.numVerticalGlyphVertices>0&&Is?qs(Is,Ln.verticalIconBox,o.ao.vertical):{box:null,occluded:!0,offscreen:null}})),ca&&(oa=ca.placeable,ba=ca.offscreen);const fc=Iu(ca&&ca.placeable);if(!oa&&this.prevPlacement){const Is=this.prevPlacement.variableOffsets[qr.crossTileID];Is&&(this.variableOffsets[qr.crossTileID]=Is,this.markUsedJustification(C,Is.anchor,qr,fc))}}}if(rs=ca,oa=rs&&rs.placeable,ba=rs&&rs.offscreen,qr.useRuntimeCollisionCircles){const Iu=C.text.placedSymbolArray.get(qr.centerJustifiedTextSymbolIndex),Fc=o.ap(C.textSizeData,Fe,Iu),uu=N.get("text-padding");Cs=this.collisionIndex.placeCollisionCircles(ct,Iu,C.lineVertexArray,C.glyphOffsetArray,Fc,te,ue,w,Bt,Ge.predicate,qr.collisionCircleDiameter,uu,j,mr),Cs.circles.length&&Cs.collisionDetected&&!w&&o.w("Collisions detected, but collision boxes are not shown"),oa=xt||Cs.circles.length>0&&!Cs.collisionDetected,ba=ba&&Cs.offscreen}if(Ln.iconFeatureIndex&&(If=Ln.iconFeatureIndex),Ln.iconBox){const Iu=Fc=>this.collisionIndex.placeCollisionBox(Fc,Pt,ge,dr,te,Bt,Ot,Y,Ge.predicate,mr,At&&ci?ci:void 0,tn);ko&&ko.placeable&&Ln.verticalIconBox?($s=Iu(Ln.verticalIconBox),ua=$s.placeable):($s=Iu(Ln.iconBox),ua=$s.placeable),ba=ba&&$s.offscreen}const dp=ut||qr.numHorizontalGlyphVertices===0&&qr.numVerticalGlyphVertices===0,yd=lt||qr.numIconVertices===0;dp||yd?yd?dp||(ua=ua&&oa):oa=ua&&oa:ua=oa=ua&&oa;const vd=ua&&$s.placeable;if(oa&&rs.placeable&&this.collisionIndex.insertCollisionBox(rs.box,ct,N.get("text-ignore-placement"),C.bucketInstanceId,ko&&ko.placeable&&Af?Af:lu,Ge.ID),vd&&this.collisionIndex.insertCollisionBox($s.box,Pt,N.get("icon-ignore-placement"),C.bucketInstanceId,If,Ge.ID),Cs&&oa&&this.collisionIndex.insertCollisionCircles(Cs.circles,ct,N.get("text-ignore-placement"),C.bucketInstanceId,lu,Ge.ID),w&&this.storeCollisionData(C.bucketInstanceId,Pi,Ln,rs,$s,Cs),qr.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");if(C.bucketInstanceId===0)throw new Error("bucket.bucketInstanceId can't be 0");this.placements[qr.crossTileID]=new bu((oa||Sr)&&!rs?.occluded,(ua||fr)&&!$s?.occluded,ba||C.justReloaded),m[qr.crossTileID]=!0};if(qt){if(l.symbolInstanceStart!==0)throw new Error("bucket.bucketInstanceId should be 0");const qr=C.getSortedSymbolIndexes(-this.transform.bearingInRadians);for(let Ln=qr.length-1;Ln>=0;--Ln){const Pi=qr[Ln];nn(C.symbolInstances.get(Pi),C.collisionArrays[Pi],Pi)}}else for(let qr=l.symbolInstanceStart;qr<l.symbolInstanceEnd;qr++)nn(C.symbolInstances.get(qr),C.collisionArrays[qr],qr);C.justReloaded=!1}storeCollisionData(l,m,w,C,N,j){if(w.textBox||w.iconBox){let Y,te;this.collisionBoxArrays.has(l)?Y=this.collisionBoxArrays.get(l):(Y=new Map,this.collisionBoxArrays.set(l,Y)),Y.has(m)?te=Y.get(m):(te={text:null,icon:null},Y.set(m,te)),w.textBox&&(te.text=C.box),w.iconBox&&(te.icon=N.box)}if(j){let Y=this.collisionCircleArrays[l];Y===void 0&&(Y=this.collisionCircleArrays[l]=[]);for(let te=0;te<j.circles.length;te+=4)Y.push(j.circles[te+0]-Ui),Y.push(j.circles[te+1]-Ui),Y.push(j.circles[te+2]),Y.push(j.collisionDetected?1:0)}}markUsedJustification(l,m,w,C){let N;N=C===o.ao.vertical?w.verticalPlacedTextSymbolIndex:{left:w.leftJustifiedTextSymbolIndex,center:w.centerJustifiedTextSymbolIndex,right:w.rightJustifiedTextSymbolIndex}[o.aG(m)];const j=[w.leftJustifiedTextSymbolIndex,w.centerJustifiedTextSymbolIndex,w.rightJustifiedTextSymbolIndex,w.verticalPlacedTextSymbolIndex];for(const Y of j)Y>=0&&(l.text.placedSymbolArray.get(Y).crossTileID=N>=0&&Y!==N?0:w.crossTileID)}markUsedOrientation(l,m,w){const C=m===o.ao.horizontal||m===o.ao.horizontalOnly?m:0,N=m===o.ao.vertical?m:0,j=[w.leftJustifiedTextSymbolIndex,w.centerJustifiedTextSymbolIndex,w.rightJustifiedTextSymbolIndex];for(const Y of j)l.text.placedSymbolArray.get(Y).placedOrientation=C;w.verticalPlacedTextSymbolIndex&&(l.text.placedSymbolArray.get(w.verticalPlacedTextSymbolIndex).placedOrientation=N)}commit(l){this.commitTime=l,this.zoomAtLastRecencyCheck=this.transform.zoom;const m=this.prevPlacement;let w=!1;this.prevZoomAdjustment=m?m.zoomAdjustment(this.transform.zoom):0;const C=m?m.symbolFadeChange(l):1,N=m?m.opacities:{},j=m?m.variableOffsets:{},Y=m?m.placedOrientations:{};for(const te in this.placements){const ue=this.placements[te],ge=N[te];ge?(this.opacities[te]=new Hn(ge,C,ue.text,ue.icon),w=w||ue.text!==ge.text.placed||ue.icon!==ge.icon.placed):(this.opacities[te]=new Hn(null,C,ue.text,ue.icon,ue.skipFade),w=w||ue.text||ue.icon)}for(const te in N){const ue=N[te];if(!this.opacities[te]){const ge=new Hn(ue,C,!1,!1);ge.isHidden()||(this.opacities[te]=ge,w=w||ue.text.placed||ue.icon.placed)}}for(const te in j)this.variableOffsets[te]||!this.opacities[te]||this.opacities[te].isHidden()||(this.variableOffsets[te]=j[te]);for(const te in Y)this.placedOrientations[te]||!this.opacities[te]||this.opacities[te].isHidden()||(this.placedOrientations[te]=Y[te]);if(m&&m.lastPlacementChangeTime===void 0)throw new Error("Last placement time for previous placement is not defined");w?this.lastPlacementChangeTime=l:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=m?m.lastPlacementChangeTime:l)}updateLayerOpacities(l,m){const w={};for(const C of m){const N=C.getBucket(l);N&&C.latestFeatureIndex&&l.id===N.layerIds[0]&&this.updateBucketOpacities(N,C.tileID,w,C.collisionBoxArray)}}updateBucketOpacities(l,m,w,C){l.hasTextData()&&(l.text.opacityVertexArray.clear(),l.text.hasVisibleVertices=!1),l.hasIconData()&&(l.icon.opacityVertexArray.clear(),l.icon.hasVisibleVertices=!1),l.hasIconCollisionBoxData()&&l.iconCollisionBox.collisionVertexArray.clear(),l.hasTextCollisionBoxData()&&l.textCollisionBox.collisionVertexArray.clear();const N=l.layers[0],j=N.layout,Y=new Hn(null,0,!1,!1,!0),te=j.get("text-allow-overlap"),ue=j.get("icon-allow-overlap"),ge=N._unevaluatedLayout.hasValue("text-variable-anchor")||N._unevaluatedLayout.hasValue("text-variable-anchor-offset"),Ce=j.get("text-rotation-alignment")==="map",Se=j.get("text-pitch-alignment")==="map",Fe=j.get("icon-text-fit")!=="none",Ge=new Hn(null,0,te&&(ue||!l.hasIconData()||j.get("icon-optional")),ue&&(te||!l.hasTextData()||j.get("text-optional")),!0);!l.collisionArrays&&C&&(l.hasIconCollisionBoxData()||l.hasTextCollisionBoxData())&&l.deserializeCollisionBoxes(C);const ut=(ct,xt,Pt)=>{for(let Ct=0;Ct<xt/4;Ct++)ct.opacityVertexArray.emplaceBack(Pt);ct.hasVisibleVertices=ct.hasVisibleVertices||Pt!==so},lt=this.collisionBoxArrays.get(l.bucketInstanceId);for(let ct=0;ct<l.symbolInstances.length;ct++){const xt=l.symbolInstances.get(ct),{numHorizontalGlyphVertices:Pt,numVerticalGlyphVertices:Ct,crossTileID:Ot}=xt;let Bt=this.opacities[Ot];w[Ot]?Bt=Y:Bt||(Bt=Ge,this.opacities[Ot]=Bt),w[Ot]=!0;const At=xt.numIconVertices>0,qt=this.placedOrientations[xt.crossTileID],Sr=qt===o.ao.vertical,fr=qt===o.ao.horizontal||qt===o.ao.horizontalOnly;if(Pt>0||Ct>0){const mr=Ha(Bt.text);ut(l.text,Pt,Sr?so:mr),ut(l.text,Ct,fr?so:mr);const tn=Bt.text.isHidden();[xt.rightJustifiedTextSymbolIndex,xt.centerJustifiedTextSymbolIndex,xt.leftJustifiedTextSymbolIndex].forEach((Ln=>{Ln>=0&&(l.text.placedSymbolArray.get(Ln).hidden=tn||Sr?1:0)})),xt.verticalPlacedTextSymbolIndex>=0&&(l.text.placedSymbolArray.get(xt.verticalPlacedTextSymbolIndex).hidden=tn||fr?1:0);const nn=this.variableOffsets[xt.crossTileID];nn&&this.markUsedJustification(l,nn.anchor,xt,qt);const qr=this.placedOrientations[xt.crossTileID];qr&&(this.markUsedJustification(l,"left",xt,qr),this.markUsedOrientation(l,qr,xt))}if(At){const mr=Ha(Bt.icon),tn=!(Fe&&xt.verticalPlacedIconSymbolIndex&&Sr);xt.placedIconSymbolIndex>=0&&(ut(l.icon,xt.numIconVertices,tn?mr:so),l.icon.placedSymbolArray.get(xt.placedIconSymbolIndex).hidden=Bt.icon.isHidden()),xt.verticalPlacedIconSymbolIndex>=0&&(ut(l.icon,xt.numVerticalIconVertices,tn?so:mr),l.icon.placedSymbolArray.get(xt.verticalPlacedIconSymbolIndex).hidden=Bt.icon.isHidden())}const dr=lt&&lt.has(ct)?lt.get(ct):{text:null,icon:null};if(l.hasIconCollisionBoxData()||l.hasTextCollisionBoxData()){const mr=l.collisionArrays[ct];if(mr){let tn=new o.P(0,0);if(mr.textBox||mr.verticalTextBox){let nn=!0;if(ge){const qr=this.variableOffsets[Ot];qr?(tn=wa(qr.anchor,qr.width,qr.height,qr.textOffset,qr.textBoxScale),Ce&&tn._rotate(Se?-this.transform.bearingInRadians:this.transform.bearingInRadians)):nn=!1}if(mr.textBox||mr.verticalTextBox){let qr;mr.textBox&&(qr=Sr),mr.verticalTextBox&&(qr=fr),No(l.textCollisionBox.collisionVertexArray,Bt.text.placed,!nn||qr,dr.text,tn.x,tn.y)}}if(mr.iconBox||mr.verticalIconBox){const nn=!!(!fr&&mr.verticalIconBox);let qr;mr.iconBox&&(qr=nn),mr.verticalIconBox&&(qr=!nn),No(l.iconCollisionBox.collisionVertexArray,Bt.icon.placed,qr,dr.icon,Fe?tn.x:0,Fe?tn.y:0)}}}}if(l.sortFeatures(-this.transform.bearingInRadians),this.retainedQueryData[l.bucketInstanceId]&&(this.retainedQueryData[l.bucketInstanceId].featureSortOrder=l.featureSortOrder),l.hasTextData()&&l.text.opacityVertexBuffer&&l.text.opacityVertexBuffer.updateData(l.text.opacityVertexArray),l.hasIconData()&&l.icon.opacityVertexBuffer&&l.icon.opacityVertexBuffer.updateData(l.icon.opacityVertexArray),l.hasIconCollisionBoxData()&&l.iconCollisionBox.collisionVertexBuffer&&l.iconCollisionBox.collisionVertexBuffer.updateData(l.iconCollisionBox.collisionVertexArray),l.hasTextCollisionBoxData()&&l.textCollisionBox.collisionVertexBuffer&&l.textCollisionBox.collisionVertexBuffer.updateData(l.textCollisionBox.collisionVertexArray),l.text.opacityVertexArray.length!==l.text.layoutVertexArray.length/4)throw new Error(`bucket.text.opacityVertexArray.length (= ${l.text.opacityVertexArray.length}) !== bucket.text.layoutVertexArray.length (= ${l.text.layoutVertexArray.length}) / 4`);if(l.icon.opacityVertexArray.length!==l.icon.layoutVertexArray.length/4)throw new Error(`bucket.icon.opacityVertexArray.length (= ${l.icon.opacityVertexArray.length}) !== bucket.icon.layoutVertexArray.length (= ${l.icon.layoutVertexArray.length}) / 4`);l.bucketInstanceId in this.collisionCircleArrays&&(l.collisionCircleArray=this.collisionCircleArrays[l.bucketInstanceId],delete this.collisionCircleArrays[l.bucketInstanceId])}symbolFadeChange(l){return this.fadeDuration===0?1:(l-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(l){return Math.max(0,(this.transform.zoom-l)/1.5)}hasTransitions(l){return this.stale||l-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(l,m){const w=this.zoomAtLastRecencyCheck===m?1-this.zoomAdjustment(m):1;return this.zoomAtLastRecencyCheck=m,this.commitTime+this.fadeDuration*w>l}setStale(){this.stale=!0}}function No(R,l,m,w,C,N){w&&w.length!==0||(w=[0,0,0,0]);const j=w[0]-Ui,Y=w[1]-Ui,te=w[2]-Ui,ue=w[3]-Ui;R.emplaceBack(l?1:0,m?1:0,C||0,N||0,j,Y),R.emplaceBack(l?1:0,m?1:0,C||0,N||0,te,Y),R.emplaceBack(l?1:0,m?1:0,C||0,N||0,te,ue),R.emplaceBack(l?1:0,m?1:0,C||0,N||0,j,ue)}const ls=Math.pow(2,25),kc=Math.pow(2,24),Sa=Math.pow(2,17),Mc=Math.pow(2,16),Rc=Math.pow(2,9),vl=Math.pow(2,8),Qs=Math.pow(2,1);function Ha(R){if(R.opacity===0&&!R.placed)return 0;if(R.opacity===1&&R.placed)return 4294967295;const l=R.placed?1:0,m=Math.floor(127*R.opacity);return m*ls+l*kc+m*Sa+l*Mc+m*Rc+l*vl+m*Qs+l}const so=0;class ka{constructor(l){this._sortAcrossTiles=l.layout.get("symbol-z-order")!=="viewport-y"&&!l.layout.get("symbol-sort-key").isConstant(),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(l,m,w,C,N){const j=this._bucketParts;for(;this._currentTileIndex<l.length;)if(m.getBucketParts(j,C,l[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,N())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,j.sort(((Y,te)=>Y.sortKey-te.sortKey)));this._currentPartIndex<j.length;)if(m.placeLayerBucketPart(j[this._currentPartIndex],this._seenCrossTileIDs,w),this._currentPartIndex++,N())return!0;return!1}}class el{constructor(l,m,w,C,N,j,Y,te){this.placement=new Wo(l,m,j,Y,te),this._currentPlacementIndex=w.length-1,this._forceFullPlacement=C,this._showCollisionBoxes=N,this._done=!1}isDone(){return this._done}continuePlacement(l,m,w){const C=b.now(),N=()=>!this._forceFullPlacement&&b.now()-C>2;for(;this._currentPlacementIndex>=0;){const j=m[l[this._currentPlacementIndex]],Y=this.placement.collisionIndex.transform.zoom;if(j.type==="symbol"&&(!j.minzoom||j.minzoom<=Y)&&(!j.maxzoom||j.maxzoom>Y)){if(this._inProgressLayer||(this._inProgressLayer=new ka(j)),this._inProgressLayer.continuePlacement(w[j.source],this.placement,this._showCollisionBoxes,j,N))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(l){return this.placement.commit(l),this.placement}}const xu=512/o.$/2;class wu{constructor(l,m,w){this.tileID=l,this.bucketInstanceId=w,this._symbolsByKey={};const C=new Map;for(let N=0;N<m.length;N++){const j=m.get(N),Y=j.key,te=C.get(Y);te?te.push(j):C.set(Y,[j])}for(const[N,j]of C){const Y={positions:j.map((te=>({x:Math.floor(te.anchorX*xu),y:Math.floor(te.anchorY*xu)}))),crossTileIDs:j.map((te=>te.crossTileID))};if(Y.positions.length>128){const te=new o.aI(Y.positions.length,16,Uint16Array);for(const{x:ue,y:ge}of Y.positions)te.add(ue,ge);te.finish(),delete Y.positions,Y.index=te}this._symbolsByKey[N]=Y}}getScaledCoordinates(l,m){const{x:w,y:C,z:N}=this.tileID.canonical,{x:j,y:Y,z:te}=m.canonical,ue=xu/Math.pow(2,te-N),ge=(Y*o.$+l.anchorY)*ue,Ce=C*o.$*xu;return{x:Math.floor((j*o.$+l.anchorX)*ue-w*o.$*xu),y:Math.floor(ge-Ce)}}findMatches(l,m,w){const C=this.tileID.canonical.z<m.canonical.z?1:Math.pow(2,this.tileID.canonical.z-m.canonical.z);for(let N=0;N<l.length;N++){const j=l.get(N);if(j.crossTileID)continue;const Y=this._symbolsByKey[j.key];if(!Y)continue;const te=this.getScaledCoordinates(j,m);if(Y.index){const ue=Y.index.range(te.x-C,te.y-C,te.x+C,te.y+C).sort();for(const ge of ue){const Ce=Y.crossTileIDs[ge];if(!w[Ce]){w[Ce]=!0,j.crossTileID=Ce;break}}}else if(Y.positions)for(let ue=0;ue<Y.positions.length;ue++){const ge=Y.positions[ue],Ce=Y.crossTileIDs[ue];if(Math.abs(ge.x-te.x)<=C&&Math.abs(ge.y-te.y)<=C&&!w[Ce]){w[Ce]=!0,j.crossTileID=Ce;break}}}}getCrossTileIDsLists(){return Object.values(this._symbolsByKey).map((({crossTileIDs:l})=>l))}}class J{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class pe{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(l){const m=Math.round((l-this.lng)/360);if(m!==0)for(const w in this.indexes){const C=this.indexes[w],N={};for(const j in C){const Y=C[j];Y.tileID=Y.tileID.unwrapTo(Y.tileID.wrap+m),N[Y.tileID.key]=Y}this.indexes[w]=N}this.lng=l}addBucket(l,m,w){if(this.indexes[l.overscaledZ]&&this.indexes[l.overscaledZ][l.key]){if(this.indexes[l.overscaledZ][l.key].bucketInstanceId===m.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(l.overscaledZ,this.indexes[l.overscaledZ][l.key])}for(let N=0;N<m.symbolInstances.length;N++)m.symbolInstances.get(N).crossTileID=0;this.usedCrossTileIDs[l.overscaledZ]||(this.usedCrossTileIDs[l.overscaledZ]={});const C=this.usedCrossTileIDs[l.overscaledZ];for(const N in this.indexes){const j=this.indexes[N];if(Number(N)>l.overscaledZ)for(const Y in j){const te=j[Y];te.tileID.isChildOf(l)&&te.findMatches(m.symbolInstances,l,C)}else{const Y=j[l.scaledTo(Number(N)).key];Y&&Y.findMatches(m.symbolInstances,l,C)}}for(let N=0;N<m.symbolInstances.length;N++){const j=m.symbolInstances.get(N);j.crossTileID||(j.crossTileID=w.generate(),C[j.crossTileID]=!0)}return this.indexes[l.overscaledZ]===void 0&&(this.indexes[l.overscaledZ]={}),this.indexes[l.overscaledZ][l.key]=new wu(l,m.symbolInstances,m.bucketInstanceId),!0}removeBucketCrossTileIDs(l,m){for(const w of m.getCrossTileIDsLists())for(const C of w)delete this.usedCrossTileIDs[l][C]}removeStaleBuckets(l){let m=!1;for(const w in this.indexes){const C=this.indexes[w];for(const N in C)l[C[N].bucketInstanceId]||(this.removeBucketCrossTileIDs(w,C[N]),delete C[N],m=!0)}return m}}class Xe{constructor(){this.layerIndexes={},this.crossTileIDs=new J,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(l,m,w){let C=this.layerIndexes[l.id];C===void 0&&(C=this.layerIndexes[l.id]=new pe);let N=!1;const j={};C.handleWrapJump(w);for(const Y of m){const te=Y.getBucket(l);te&&l.id===te.layerIds[0]&&(te.bucketInstanceId||(te.bucketInstanceId=++this.maxBucketInstanceId),C.addBucket(Y.tileID,te,this.crossTileIDs)&&(N=!0),j[te.bucketInstanceId]=!0)}return C.removeStaleBuckets(j)&&(N=!0),N}pruneUnusedLayers(l){const m={};l.forEach((w=>{m[w]=!0}));for(const w in this.layerIndexes)m[w]||delete this.layerIndexes[w]}}var Tt="void main() {fragColor=vec4(1.0);}";const Nt={prelude:kt(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
out highp vec4 fragColor;`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}mat3 rotationMatrixFromAxisAngle(vec3 u,float angle) {float c=cos(angle);float s=sin(angle);float c2=1.0-c;return mat3(u.x*u.x*c2+      c,u.x*u.y*c2-u.z*s,u.x*u.z*c2+u.y*s,u.y*u.x*c2+u.z*s,u.y*u.y*c2+    c,u.y*u.z*c2-u.x*s,u.z*u.x*c2-u.y*s,u.z*u.y*c2+u.x*s,u.z*u.z*c2+    c
);}
#ifdef TERRAIN3D
uniform sampler2D u_terrain;uniform float u_terrain_dim;uniform mat4 u_terrain_matrix;uniform vec4 u_terrain_unpack;uniform float u_terrain_exaggeration;uniform highp sampler2D u_depth;
#endif
const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitShifts=vec4(1.)/bitSh;highp float unpack(highp vec4 color) {return dot(color,bitShifts);}highp float depthOpacity(vec3 frag) {
#ifdef TERRAIN3D
highp float d=unpack(texture(u_depth,frag.xy*0.5+0.5))+0.0001-frag.z;return 1.0-max(0.0,min(1.0,-d*500.0));
#else
return 1.0;
#endif
}float calculate_visibility(vec4 pos) {
#ifdef TERRAIN3D
vec3 frag=pos.xyz/pos.w;highp float d=depthOpacity(frag);if (d > 0.95) return 1.0;return (d+depthOpacity(frag+vec3(0.0,0.01,0.0)))/2.0;
#else
return 1.0;
#endif
}float ele(vec2 pos) {
#ifdef TERRAIN3D
vec4 rgb=(texture(u_terrain,pos)*255.0)*u_terrain_unpack;return rgb.r+rgb.g+rgb.b-u_terrain_unpack.a;
#else
return 0.0;
#endif
}float get_elevation(vec2 pos) {
#ifdef TERRAIN3D
#ifdef GLOBE
if ((pos.y <-32767.5) || (pos.y > 32766.5)) {return 0.0;}
#endif
vec2 coord=(u_terrain_matrix*vec4(pos,0.0,1.0)).xy*u_terrain_dim+1.0;vec2 f=fract(coord);vec2 c=(floor(coord)+0.5)/(u_terrain_dim+2.0);float d=1.0/(u_terrain_dim+2.0);float tl=ele(c);float tr=ele(c+vec2(d,0.0));float bl=ele(c+vec2(0.0,d));float br=ele(c+vec2(d,d));float elevation=mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);return elevation*u_terrain_exaggeration;
#else
return 0.0;
#endif
}const float PI=3.141592653589793;uniform mat4 u_projection_matrix;`),projectionMercator:kt("","float projectLineThickness(float tileY) {return 1.0;}float projectCircleRadius(float tileY) {return 1.0;}vec4 projectTile(vec2 p) {vec4 result=u_projection_matrix*vec4(p,0.0,1.0);return result;}vec4 projectTile(vec2 p,vec2 rawPos) {vec4 result=u_projection_matrix*vec4(p,0.0,1.0);if (rawPos.y <-32767.5 || rawPos.y > 32766.5) {result.z=-10000000.0;}return result;}vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_projection_matrix*vec4(posInTile,elevation,1.0);}vec4 projectTileFor3D(vec2 posInTile,float elevation) {return projectTileWithElevation(posInTile,elevation);}"),projectionGlobe:kt("",`#define GLOBE_RADIUS 6371008.8
uniform highp vec4 u_projection_tile_mercator_coords;uniform highp vec4 u_projection_clipping_plane;uniform highp float u_projection_transition;uniform mat4 u_projection_fallback_matrix;vec3 globeRotateVector(vec3 vec,vec2 angles) {vec3 axisRight=vec3(vec.z,0.0,-vec.x);vec3 axisUp=cross(axisRight,vec);axisRight=normalize(axisRight);axisUp=normalize(axisUp);vec2 t=tan(angles);return normalize(vec+axisRight*t.x+axisUp*t.y);}mat3 globeGetRotationMatrix(vec3 spherePos) {vec3 axisRight=vec3(spherePos.z,0.0,-spherePos.x);vec3 axisDown=cross(axisRight,spherePos);axisRight=normalize(axisRight);axisDown=normalize(axisDown);return mat3(axisRight,axisDown,spherePos
);}float circumferenceRatioAtTileY(float tileY) {float mercator_pos_y=u_projection_tile_mercator_coords.y+u_projection_tile_mercator_coords.w*tileY;float spherical_y=2.0*atan(exp(PI-(mercator_pos_y*PI*2.0)))-PI*0.5;return cos(spherical_y);}float projectLineThickness(float tileY) {float thickness=1.0/circumferenceRatioAtTileY(tileY); 
if (u_projection_transition < 0.999) {return mix(1.0,thickness,u_projection_transition);} else {return thickness;}}vec3 projectToSphere(vec2 translatedPos,vec2 rawPos) {vec2 mercator_pos=u_projection_tile_mercator_coords.xy+u_projection_tile_mercator_coords.zw*translatedPos;vec2 spherical;spherical.x=mercator_pos.x*PI*2.0+PI;spherical.y=2.0*atan(exp(PI-(mercator_pos.y*PI*2.0)))-PI*0.5;float len=cos(spherical.y);vec3 pos=vec3(sin(spherical.x)*len,sin(spherical.y),cos(spherical.x)*len
);if (rawPos.y <-32767.5) {pos=vec3(0.0,1.0,0.0);}if (rawPos.y > 32766.5) {pos=vec3(0.0,-1.0,0.0);}return pos;}vec3 projectToSphere(vec2 posInTile) {return projectToSphere(posInTile,vec2(0.0,0.0));}float globeComputeClippingZ(vec3 spherePos) {return (1.0-(dot(spherePos,u_projection_clipping_plane.xyz)+u_projection_clipping_plane.w));}vec4 interpolateProjection(vec2 posInTile,vec3 spherePos,float elevation) {vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);vec4 globePosition=u_projection_matrix*vec4(elevatedPos,1.0);globePosition.z=globeComputeClippingZ(elevatedPos)*globePosition.w;if (u_projection_transition > 0.999) {return globePosition;}vec4 flatPosition=u_projection_fallback_matrix*vec4(posInTile,elevation,1.0);const float z_globeness_threshold=0.2;vec4 result=globePosition;result.z=mix(0.0,globePosition.z,clamp((u_projection_transition-z_globeness_threshold)/(1.0-z_globeness_threshold),0.0,1.0));result.xyw=mix(flatPosition.xyw,globePosition.xyw,u_projection_transition);if ((posInTile.y <-32767.5) || (posInTile.y > 32766.5)) {result=globePosition;const float poles_hidden_anim_percentage=0.02;result.z=mix(globePosition.z,100.0,pow(max((1.0-u_projection_transition)/poles_hidden_anim_percentage,0.0),8.0));}return result;}vec4 interpolateProjectionFor3D(vec2 posInTile,vec3 spherePos,float elevation) {vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);vec4 globePosition=u_projection_matrix*vec4(elevatedPos,1.0);if (u_projection_transition > 0.999) {return globePosition;}vec4 fallbackPosition=u_projection_fallback_matrix*vec4(posInTile,elevation,1.0);return mix(fallbackPosition,globePosition,u_projection_transition);}vec4 projectTile(vec2 posInTile) {return interpolateProjection(posInTile,projectToSphere(posInTile),0.0);}vec4 projectTile(vec2 posInTile,vec2 rawPos) {return interpolateProjection(posInTile,projectToSphere(posInTile,rawPos),0.0);}vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return interpolateProjection(posInTile,projectToSphere(posInTile),elevation);}vec4 projectTileFor3D(vec2 posInTile,float elevation) {vec3 spherePos=projectToSphere(posInTile,posInTile);return interpolateProjectionFor3D(posInTile,spherePos,elevation);}`),background:kt(`uniform vec4 u_color;uniform float u_opacity;void main() {fragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"in vec2 a_pos;void main() {gl_Position=projectTile(a_pos);}"),backgroundPattern:kt(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);fragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;void main() {gl_Position=projectTile(a_pos);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),circle:kt(`in vec3 v_data;in float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);float antialiased_blur=v_data.z;float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));fragColor=v_visibility*opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);const float epsilon=0.5/255.0;if (fragColor.r < epsilon && fragColor.g < epsilon && fragColor.b < epsilon && fragColor.a < epsilon) {discard;}
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform highp float u_globe_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;uniform vec2 u_translate;in vec2 a_pos;out vec3 v_data;out float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 pos_raw=a_pos+32768.0;vec2 extrude=vec2(mod(pos_raw,8.0)/7.0*2.0-1.0);vec2 circle_center=floor(pos_raw/8.0)+u_translate;float ele=get_elevation(circle_center);v_visibility=calculate_visibility(projectTileWithElevation(circle_center,ele));if (u_pitch_with_map) {
#ifdef GLOBE
vec3 center_vector=projectToSphere(circle_center);
#endif
float angle_scale=u_globe_extrude_scale;vec2 corner_position=circle_center;if (u_scale_with_map) {angle_scale*=(radius+stroke_width);corner_position+=extrude*u_extrude_scale*(radius+stroke_width);} else {
#ifdef GLOBE
vec4 projected_center=interpolateProjection(circle_center,center_vector,ele);
#else
vec4 projected_center=projectTileWithElevation(circle_center,ele);
#endif
corner_position+=extrude*u_extrude_scale*(radius+stroke_width)*(projected_center.w/u_camera_to_center_distance);angle_scale*=(radius+stroke_width)*(projected_center.w/u_camera_to_center_distance);}
#ifdef GLOBE
vec2 angles=extrude*angle_scale;vec3 corner_vector=globeRotateVector(center_vector,angles);gl_Position=interpolateProjection(corner_position,corner_vector,ele);
#else
gl_Position=projectTileWithElevation(corner_position,ele);
#endif
} else {gl_Position=projectTileWithElevation(circle_center,ele);if (gl_Position.z/gl_Position.w > 1.0) {gl_Position.xy=vec2(10000.0);}if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}float antialiasblur=-max(1.0/u_device_pixel_ratio/(radius+stroke_width),blur);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),clippingMask:kt(Tt,"in vec2 a_pos;void main() {gl_Position=projectTile(a_pos);}"),heatmap:kt(`uniform highp float u_intensity;in vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);fragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;uniform highp float u_globe_extrude_scale;in vec2 a_pos;out vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 pos_raw=a_pos+32768.0;vec2 unscaled_extrude=vec2(mod(pos_raw,8.0)/7.0*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 circle_center=floor(pos_raw/8.0);
#ifdef GLOBE
vec2 angles=v_extrude*radius*u_globe_extrude_scale;vec3 center_vector=projectToSphere(circle_center);vec3 corner_vector=globeRotateVector(center_vector,angles);gl_Position=interpolateProjection(circle_center+extrude,corner_vector,0.0);
#else
gl_Position=projectTileFor3D(circle_center+extrude,get_elevation(circle_center));
#endif
}`),heatmapTexture:kt(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;in vec2 v_pos;void main() {float t=texture(u_image,v_pos).r;vec4 color=texture(u_color_ramp,vec2(t,0.5));fragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),collisionBox:kt("in float v_placed;in float v_notUsed;void main() {float alpha=0.5;fragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {fragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {fragColor*=.1;}}","in vec2 a_anchor_pos;in vec2 a_placed;in vec2 a_box_real;uniform vec2 u_pixel_extrude_scale;out float v_placed;out float v_notUsed;void main() {gl_Position=projectTileWithElevation(a_anchor_pos,get_elevation(a_anchor_pos));gl_Position.xy=((a_box_real+0.5)*u_pixel_extrude_scale*2.0-1.0)*vec2(1.0,-1.0)*gl_Position.w;if (gl_Position.z/gl_Position.w < 1.1) {gl_Position.z=0.5;}v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:kt("in float v_radius;in vec2 v_extrude;in float v_collision;void main() {float alpha=0.5;float stroke_radius=0.9;float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);fragColor=color*alpha*opacity_t;}","in vec2 a_pos;in float a_radius;in vec2 a_flags;uniform vec2 u_viewport_size;out float v_radius;out vec2 v_extrude;out float v_collision;void main() {float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_collision=collision;gl_Position=vec4((a_pos/u_viewport_size*2.0-1.0)*vec2(1.0,-1.0),0.0,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),colorRelief:kt(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;uniform vec4 u_unpack;uniform sampler2D u_elevation_stops;uniform sampler2D u_color_stops;uniform int u_color_ramp_size;uniform float u_opacity;in vec2 v_pos;float getElevation(vec2 coord) {vec4 data=texture(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack);}float getElevationStop(int stop) {float x=(float(stop)+0.5)/float(u_color_ramp_size);vec4 data=texture(u_elevation_stops,vec2(x,0))*255.0;data.a=-1.0;return dot(data,u_unpack);}void main() {float el=getElevation(v_pos);int r=(u_color_ramp_size-1);int l=0;float el_l=getElevationStop(l);float el_r=getElevationStop(r);while(r-l > 1){int m=(r+l)/2;float el_m=getElevationStop(m);if(el < el_m){r=m;el_r=el_m;}else
{l=m;el_l=el_m;}}float x=(float(l)+(el-el_l)/(el_r-el_l)+0.5)/float(u_color_ramp_size);fragColor=u_opacity*texture(u_color_stops,vec2(x,0));
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform vec2 u_dimension;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=projectTile(a_pos,a_pos);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_pos/8192.0)*scale+epsilon;if (a_pos.y <-32767.5) {v_pos.y=0.0;}if (a_pos.y > 32766.5) {v_pos.y=1.0;}}"),debug:kt("uniform highp vec4 u_color;uniform sampler2D u_overlay;in vec2 v_uv;void main() {vec4 overlay_color=texture(u_overlay,v_uv);fragColor=mix(u_color,overlay_color,overlay_color.a);}","in vec2 a_pos;out vec2 v_uv;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=projectTileWithElevation(a_pos*u_overlay_scale,get_elevation(a_pos));}"),depth:kt(Tt,`in vec2 a_pos;void main() {
#ifdef GLOBE
gl_Position=projectTileFor3D(a_pos,0.0);
#else
gl_Position=u_projection_matrix*vec4(a_pos,0.0,1.0);
#endif
}`),fill:kt(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
fragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_fill_translate;in vec2 a_pos;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=projectTile(a_pos+u_fill_translate,a_pos);}`),fillOutline:kt(`in vec2 v_pos;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);fragColor=outline_color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_world;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=projectTile(a_pos+u_fill_translate,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
}`),fillOutlinePattern:kt(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;in vec2 v_pos_a;in vec2 v_pos_b;in vec2 v_pos;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);fragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;out vec2 v_pos;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=projectTile(a_pos+u_fill_translate,a_pos);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
}`),fillPattern:kt(`#ifdef GL_ES
precision highp float;
#endif
uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);fragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=projectTile(a_pos+u_fill_translate,a_pos);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),fillExtrusion:kt(`in vec4 v_color;void main() {fragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp vec3 u_lightpos_globe;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec2 u_fill_translate;in vec2 a_pos;in vec4 a_normal_ed;
#ifdef TERRAIN3D
in vec2 a_centroid;
#endif
out vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float elevation=t > 0.0 ? height : base;vec2 posInTile=a_pos+u_fill_translate;
#ifdef GLOBE
vec3 spherePos=projectToSphere(posInTile,a_pos);gl_Position=interpolateProjectionFor3D(posInTile,spherePos,elevation);
#else
gl_Position=u_projection_matrix*vec4(posInTile,elevation,1.0);
#endif
float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;vec3 normalForLighting=normal/16384.0;float directional=clamp(dot(normalForLighting,u_lightpos),0.0,1.0);
#ifdef GLOBE
mat3 rotMatrix=globeGetRotationMatrix(spherePos);normalForLighting=rotMatrix*normalForLighting;directional=mix(directional,clamp(dot(normalForLighting,u_lightpos_globe),0.0,1.0),u_projection_transition);
#endif
directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),fillExtrusionPattern:kt(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;in vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);fragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec2 u_fill_translate;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp vec3 u_lightpos_globe;uniform lowp float u_lightintensity;in vec2 a_pos;in vec4 a_normal_ed;
#ifdef TERRAIN3D
in vec2 a_centroid;
#endif
#ifdef GLOBE
out vec3 v_sphere_pos;
#endif
out vec2 v_pos_a;out vec2 v_pos_b;out vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float elevation=t > 0.0 ? height : base;vec2 posInTile=a_pos+u_fill_translate;
#ifdef GLOBE
vec3 spherePos=projectToSphere(posInTile,a_pos);vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);v_sphere_pos=elevatedPos;gl_Position=interpolateProjectionFor3D(posInTile,spherePos,elevation);
#else
gl_Position=u_projection_matrix*vec4(posInTile,elevation,1.0);
#endif
vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,elevation*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),hillshadePrepare:kt(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack);}void main() {vec2 epsilon=1.0/u_dimension;float tileSize=u_dimension.x-2.0;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))*tileSize/pow(2.0,exaggeration+(28.2562-u_zoom));fragColor=clamp(vec4(deriv.x/8.0+0.5,deriv.y/8.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:kt(`uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_latrange;uniform float u_exaggeration;uniform vec4 u_accent;uniform int u_method;uniform float u_altitudes[NUM_ILLUMINATION_SOURCES];uniform float u_azimuths[NUM_ILLUMINATION_SOURCES];uniform vec4 u_shadows[NUM_ILLUMINATION_SOURCES];uniform vec4 u_highlights[NUM_ILLUMINATION_SOURCES];
#define PI 3.141592653589793
#define STANDARD 0
#define COMBINED 1
#define IGOR 2
#define MULTIDIRECTIONAL 3
#define BASIC 4
float get_aspect(vec2 deriv){return deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);}void igor_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;float aspect=get_aspect(deriv);float azimuth=u_azimuths[0]+PI;float slope_stength=atan(length(deriv))*2.0/PI;float aspect_strength=1.0-abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);float shadow_strength=slope_stength*aspect_strength;float highlight_strength=slope_stength*(1.0-aspect_strength);fragColor=u_shadows[0]*shadow_strength+u_highlights[0]*highlight_strength;}void standard_hillshade(vec2 deriv){float azimuth=u_azimuths[0]+PI;float slope=atan(0.625*length(deriv));float aspect=get_aspect(deriv);float intensity=u_exaggeration;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadows[0],u_highlights[0],shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);fragColor=accent_color*(1.0-shade_color.a)+shade_color;}void basic_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;float azimuth=u_azimuths[0]+PI;float cos_az=cos(azimuth);float sin_az=sin(azimuth);float cos_alt=cos(u_altitudes[0]);float sin_alt=sin(u_altitudes[0]);float cang=(sin_alt-(deriv.y*cos_az*cos_alt-deriv.x*sin_az*cos_alt))/sqrt(1.0+dot(deriv,deriv));float shade=clamp(cang,0.0,1.0);if(shade > 0.5){fragColor=u_highlights[0]*(2.0*shade-1.0);}else
{fragColor=u_shadows[0]*(1.0-2.0*shade);}}void multidirectional_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;fragColor=vec4(0,0,0,0);for(int i=0; i < NUM_ILLUMINATION_SOURCES; i++){float cos_alt=cos(u_altitudes[i]);float sin_alt=sin(u_altitudes[i]);float cos_az=-cos(u_azimuths[i]);float sin_az=-sin(u_azimuths[i]);float cang=(sin_alt-(deriv.y*cos_az*cos_alt-deriv.x*sin_az*cos_alt))/sqrt(1.0+dot(deriv,deriv));float shade=clamp(cang,0.0,1.0);if(shade > 0.5){fragColor+=u_highlights[i]*(2.0*shade-1.0)/float(NUM_ILLUMINATION_SOURCES);}else
{fragColor+=u_shadows[i]*(1.0-2.0*shade)/float(NUM_ILLUMINATION_SOURCES);}}}void combined_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;float azimuth=u_azimuths[0]+PI;float cos_az=cos(azimuth);float sin_az=sin(azimuth);float cos_alt=cos(u_altitudes[0]);float sin_alt=sin(u_altitudes[0]);float cang=acos((sin_alt-(deriv.y*cos_az*cos_alt-deriv.x*sin_az*cos_alt))/sqrt(1.0+dot(deriv,deriv)));cang=clamp(cang,0.0,PI/2.0);float shade=cang*atan(length(deriv))*4.0/PI/PI;float highlight=(PI/2.0-cang)*atan(length(deriv))*4.0/PI/PI;fragColor=u_shadows[0]*shade+u_highlights[0]*highlight;}void main() {vec4 pixel=texture(u_image,v_pos);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));vec2 deriv=((pixel.rg*8.0)-4.0)/scaleFactor;if (u_method==BASIC) {basic_hillshade(deriv);} else if (u_method==COMBINED) {combined_hillshade(deriv);} else if (u_method==IGOR) {igor_hillshade(deriv);} else if (u_method==MULTIDIRECTIONAL) {multidirectional_hillshade(deriv);} else if (u_method==STANDARD) {standard_hillshade(deriv);} else {standard_hillshade(deriv);}
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=projectTile(a_pos,a_pos);v_pos=a_pos/8192.0;if (a_pos.y <-32767.5) {v_pos.y=0.0;}if (a_pos.y > 32766.5) {v_pos.y=1.0;}}"),line:kt(`uniform lowp float u_device_pixel_ratio;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp float v_linesofar;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),lineGradient:kt(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;in highp vec2 v_uv;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture(u_image,v_uv);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
in vec2 a_pos_normal;in vec4 a_data;in float a_uv_x;in float a_split_index;uniform vec2 u_translation;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp vec2 v_uv;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),linePattern:kt(`#ifdef GL_ES
precision highp float;
#endif
uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;in vec2 v_normal;in vec2 v_width2;in float v_linesofar;in float v_gamma_scale;in float v_width;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture(u_image,pos_a),texture(u_image,pos_b),u_fade);fragColor=color*alpha*opacity;
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;out vec2 v_normal;out vec2 v_width2;out float v_linesofar;out float v_gamma_scale;out float v_width;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),lineSDF:kt(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;in vec2 v_normal;in vec2 v_width2;in vec2 v_tex_a;in vec2 v_tex_b;in float v_gamma_scale;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture(u_image,v_tex_a).a;float sdfdist_b=texture(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;out vec2 v_normal;out vec2 v_width2;out vec2 v_tex_a;out vec2 v_tex_b;out float v_gamma_scale;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}`),raster:kt(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;in vec2 v_pos0;in vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture(u_image0,v_pos0);vec4 color1=texture(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);fragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;uniform vec4 u_coords_top;uniform vec4 u_coords_bottom;in vec2 a_pos;out vec2 v_pos0;out vec2 v_pos1;void main() {vec2 fractionalPos=a_pos/8192.0;vec2 position=mix(mix(u_coords_top.xy,u_coords_top.zw,fractionalPos.x),mix(u_coords_bottom.xy,u_coords_bottom.zw,fractionalPos.x),fractionalPos.y);gl_Position=projectTile(position,position);v_pos0=((fractionalPos-0.5)/u_buffer_scale)+0.5;
#ifdef GLOBE
if (a_pos.y <-32767.5) {v_pos0.y=0.0;}if (a_pos.y > 32766.5) {v_pos0.y=1.0;}
#endif
v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}`),symbolIcon:kt(`uniform sampler2D u_texture;in vec2 v_tex;in float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;fragColor=texture(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec4 a_pixeloffset;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;out vec2 v_tex;out float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}gl_Position=finalPos;v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float visibility=calculate_visibility(projectedPoint);v_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));}`),symbolSDF:kt(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;in vec2 v_data0;in vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float inner_edge=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);inner_edge=inner_edge+gamma*gamma_scale;}lowp float dist=texture(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(inner_edge-gamma_scaled,inner_edge+gamma_scaled,dist);if (u_is_halo) {lowp float halo_edge=(6.0-halo_width/fontScale)/SDF_PX;alpha=min(smoothstep(halo_edge-gamma_scaled,halo_edge+gamma_scaled,dist),1.0-alpha);}fragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec4 a_pixeloffset;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_translation;uniform float u_pitched_scale;out vec2 v_data0;out vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),symbolTextAndIcon:kt(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;in vec4 v_data0;in vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;fragColor=texture(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);fragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;out vec4 v_data0;out vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map && !u_is_along_line) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`),terrain:kt("uniform sampler2D u_texture;uniform vec4 u_fog_color;uniform vec4 u_horizon_color;uniform float u_fog_ground_blend;uniform float u_fog_ground_blend_opacity;uniform float u_horizon_fog_blend;uniform bool u_is_globe_mode;in vec2 v_texture_pos;in float v_fog_depth;const float gamma=2.2;vec4 gammaToLinear(vec4 color) {return pow(color,vec4(gamma));}vec4 linearToGamma(vec4 color) {return pow(color,vec4(1.0/gamma));}void main() {vec4 surface_color=texture(u_texture,vec2(v_texture_pos.x,1.0-v_texture_pos.y));if (!u_is_globe_mode && v_fog_depth > u_fog_ground_blend) {vec4 surface_color_linear=gammaToLinear(surface_color);float blend_color=smoothstep(0.0,1.0,max((v_fog_depth-u_horizon_fog_blend)/(1.0-u_horizon_fog_blend),0.0));vec4 fog_horizon_color_linear=mix(gammaToLinear(u_fog_color),gammaToLinear(u_horizon_color),blend_color);float factor_fog=max(v_fog_depth-u_fog_ground_blend,0.0)/(1.0-u_fog_ground_blend);fragColor=linearToGamma(mix(surface_color_linear,fog_horizon_color_linear,pow(factor_fog,2.0)*u_fog_ground_blend_opacity));} else {fragColor=surface_color;}}","in vec3 a_pos3d;uniform mat4 u_fog_matrix;uniform float u_ele_delta;out vec2 v_texture_pos;out float v_fog_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=projectTileFor3D(a_pos3d.xy,get_elevation(a_pos3d.xy)-ele_delta);vec4 pos=u_fog_matrix*vec4(a_pos3d.xy,ele,1.0);v_fog_depth=pos.z/pos.w*0.5+0.5;}"),terrainDepth:kt("in float v_depth;const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitMsk=vec4(0.,vec3(1./256.0));highp vec4 pack(highp float value) {highp vec4 comp=fract(value*bitSh);comp-=comp.xxyz*bitMsk;return comp;}void main() {fragColor=pack(v_depth);}","in vec3 a_pos3d;uniform float u_ele_delta;out float v_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;gl_Position=projectTileFor3D(a_pos3d.xy,ele-ele_delta);v_depth=gl_Position.z/gl_Position.w;}"),terrainCoords:kt("precision mediump float;uniform sampler2D u_texture;uniform float u_terrain_coords_id;in vec2 v_texture_pos;void main() {vec4 rgba=texture(u_texture,v_texture_pos);fragColor=vec4(rgba.r,rgba.g,rgba.b,u_terrain_coords_id);}","in vec3 a_pos3d;uniform float u_ele_delta;out vec2 v_texture_pos;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=projectTileFor3D(a_pos3d.xy,ele-ele_delta);}"),projectionErrorMeasurement:kt("in vec4 v_output_error_encoded;void main() {fragColor=v_output_error_encoded;}","in vec2 a_pos;uniform highp float u_input;uniform highp float u_output_expected;out vec4 v_output_error_encoded;void main() {float real_output=2.0*atan(exp(PI-(u_input*PI*2.0)))-PI*0.5;float error=real_output-u_output_expected;float abs_error=abs(error)*128.0;v_output_error_encoded.x=min(floor(abs_error*256.0),255.0)/255.0;abs_error-=v_output_error_encoded.x;v_output_error_encoded.y=min(floor(abs_error*65536.0),255.0)/255.0;abs_error-=v_output_error_encoded.x/255.0;v_output_error_encoded.z=min(floor(abs_error*16777216.0),255.0)/255.0;v_output_error_encoded.w=error >=0.0 ? 1.0 : 0.0;gl_Position=vec4(a_pos,0.0,1.0);}"),atmosphere:kt(`in vec3 view_direction;uniform vec3 u_sun_pos;uniform vec3 u_globe_position;uniform float u_globe_radius;uniform float u_atmosphere_blend;/**Shader use from https:*Made some change to adapt to MapLibre Globe geometry*/const float PI=3.141592653589793;const int iSteps=5;const int jSteps=3;/*radius of the planet*/const float EARTH_RADIUS=6371e3;/*radius of the atmosphere*/const float ATMOS_RADIUS=6471e3;vec2 rsi(vec3 r0,vec3 rd,float sr) {float a=dot(rd,rd);float b=2.0*dot(rd,r0);float c=dot(r0,r0)-(sr*sr);float d=(b*b)-4.0*a*c;if (d < 0.0) return vec2(1e5,-1e5);return vec2((-b-sqrt(d))/(2.0*a),(-b+sqrt(d))/(2.0*a));}vec4 atmosphere(vec3 r,vec3 r0,vec3 pSun,float iSun,float rPlanet,float rAtmos,vec3 kRlh,float kMie,float shRlh,float shMie,float g) {pSun=normalize(pSun);r=normalize(r);vec2 p=rsi(r0,r,rAtmos);if (p.x > p.y) {return vec4(0.0,0.0,0.0,1.0);}if (p.x < 0.0) {p.x=0.0;}vec3 pos=r0+r*p.x;vec2 p2=rsi(r0,r,rPlanet);if (p2.x <=p2.y && p2.x > 0.0) {p.y=min(p.y,p2.x);}float iStepSize=(p.y-p.x)/float(iSteps);float iTime=p.x+iStepSize*0.5;vec3 totalRlh=vec3(0,0,0);vec3 totalMie=vec3(0,0,0);float iOdRlh=0.0;float iOdMie=0.0;float mu=dot(r,pSun);float mumu=mu*mu;float gg=g*g;float pRlh=3.0/(16.0*PI)*(1.0+mumu);float pMie=3.0/(8.0*PI)*((1.0-gg)*(mumu+1.0))/(pow(1.0+gg-2.0*mu*g,1.5)*(2.0+gg));for (int i=0; i < iSteps; i++) {vec3 iPos=r0+r*iTime;float iHeight=length(iPos)-rPlanet;float odStepRlh=exp(-iHeight/shRlh)*iStepSize;float odStepMie=exp(-iHeight/shMie)*iStepSize;iOdRlh+=odStepRlh;iOdMie+=odStepMie;float jStepSize=rsi(iPos,pSun,rAtmos).y/float(jSteps);float jTime=jStepSize*0.5;float jOdRlh=0.0;float jOdMie=0.0;for (int j=0; j < jSteps; j++) {vec3 jPos=iPos+pSun*jTime;float jHeight=length(jPos)-rPlanet;jOdRlh+=exp(-jHeight/shRlh)*jStepSize;jOdMie+=exp(-jHeight/shMie)*jStepSize;jTime+=jStepSize;}vec3 attn=exp(-(kMie*(iOdMie+jOdMie)+kRlh*(iOdRlh+jOdRlh)));totalRlh+=odStepRlh*attn;totalMie+=odStepMie*attn;iTime+=iStepSize;}float opacity=exp(-(length(kRlh)*length(totalRlh)+kMie*length(totalMie)));vec3 color=iSun*(pRlh*kRlh*totalRlh+pMie*kMie*totalMie);return vec4(color,opacity);}void main() {vec3 scale_camera_pos=-u_globe_position*EARTH_RADIUS/u_globe_radius;vec4 color=atmosphere(normalize(view_direction),scale_camera_pos,u_sun_pos,22.0,EARTH_RADIUS,ATMOS_RADIUS,vec3(5.5e-6,13.0e-6,22.4e-6),21e-6,8e3,1.2e3,0.758
);color.rgb=1.0-exp(-1.0*color.rgb);color=pow(color,vec4(1.0/2.2));fragColor=vec4(color.rgb,1.0-color.a)*u_atmosphere_blend;}`,"in vec2 a_pos;uniform mat4 u_inv_proj_matrix;out vec3 view_direction;void main() {view_direction=(u_inv_proj_matrix*vec4(a_pos,0.0,1.0)).xyz;gl_Position=vec4(a_pos,0.0,1.0);}"),sky:kt("uniform vec4 u_sky_color;uniform vec4 u_horizon_color;uniform vec2 u_horizon;uniform vec2 u_horizon_normal;uniform float u_sky_horizon_blend;uniform float u_sky_blend;void main() {float x=gl_FragCoord.x;float y=gl_FragCoord.y;float blend=(y-u_horizon.y)*u_horizon_normal.y+(x-u_horizon.x)*u_horizon_normal.x;if (blend > 0.0) {if (blend < u_sky_horizon_blend) {fragColor=mix(u_sky_color,u_horizon_color,pow(1.0-blend/u_sky_horizon_blend,2.0));} else {fragColor=u_sky_color;}}fragColor=mix(fragColor,vec4(vec3(0.0),0.0),u_sky_blend);}","in vec2 a_pos;void main() {gl_Position=vec4(a_pos,1.0,1.0);}")};function kt(R,l){const m=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,w=l.match(/in ([\w]+) ([\w]+)/g),C=R.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),N=l.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),j=N?N.concat(C):C,Y={};return{fragmentSource:R=R.replace(m,((te,ue,ge,Ce,Se)=>(Y[Se]=!0,ue==="define"?`
#ifndef HAS_UNIFORM_u_${Se}
in ${ge} ${Ce} ${Se};
#else
uniform ${ge} ${Ce} u_${Se};
#endif
`:`
#ifdef HAS_UNIFORM_u_${Se}
    ${ge} ${Ce} ${Se} = u_${Se};
#endif
`))),vertexSource:l=l.replace(m,((te,ue,ge,Ce,Se)=>{const Fe=Ce==="float"?"vec2":"vec4",Ge=Se.match(/color/)?"color":Fe;return Y[Se]?ue==="define"?`
#ifndef HAS_UNIFORM_u_${Se}
uniform lowp float u_${Se}_t;
in ${ge} ${Fe} a_${Se};
out ${ge} ${Ce} ${Se};
#else
uniform ${ge} ${Ce} u_${Se};
#endif
`:Ge==="vec4"?`
#ifndef HAS_UNIFORM_u_${Se}
    ${Se} = a_${Se};
#else
    ${ge} ${Ce} ${Se} = u_${Se};
#endif
`:`
#ifndef HAS_UNIFORM_u_${Se}
    ${Se} = unpack_mix_${Ge}(a_${Se}, u_${Se}_t);
#else
    ${ge} ${Ce} ${Se} = u_${Se};
#endif
`:ue==="define"?`
#ifndef HAS_UNIFORM_u_${Se}
uniform lowp float u_${Se}_t;
in ${ge} ${Fe} a_${Se};
#else
uniform ${ge} ${Ce} u_${Se};
#endif
`:Ge==="vec4"?`
#ifndef HAS_UNIFORM_u_${Se}
    ${ge} ${Ce} ${Se} = a_${Se};
#else
    ${ge} ${Ce} ${Se} = u_${Se};
#endif
`:`
#ifndef HAS_UNIFORM_u_${Se}
    ${ge} ${Ce} ${Se} = unpack_mix_${Ge}(a_${Se}, u_${Se}_t);
#else
    ${ge} ${Ce} ${Se} = u_${Se};
#endif
`})),staticAttributes:w,staticUniforms:j}}class Gt{constructor(l,m,w){this.vertexBuffer=l,this.indexBuffer=m,this.segments=w}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.vertexBuffer=null,this.indexBuffer=null,this.segments=null}}var $r=o.aJ([{name:"a_pos",type:"Int16",components:2}]);const Yr="#define PROJECTION_MERCATOR",Hr="mercator";class kr{constructor(){this._cachedMesh=null}get name(){return"mercator"}get useSubdivision(){return!1}get shaderVariantName(){return Hr}get shaderDefine(){return Yr}get shaderPreludeCode(){return Nt.projectionMercator}get vertexShaderPreludeCode(){return Nt.projectionMercator.vertexSource}get subdivisionGranularity(){return o.aK.noSubdivision}get useGlobeControls(){return!1}get transitionState(){return 0}get latitudeErrorCorrectionRadians(){return 0}destroy(){}updateGPUdependent(l){}getMeshFromTileID(l,m,w,C,N){if(this._cachedMesh)return this._cachedMesh;const j=new o.aL;j.emplaceBack(0,0),j.emplaceBack(o.$,0),j.emplaceBack(0,o.$),j.emplaceBack(o.$,o.$);const Y=l.createVertexBuffer(j,$r.members),te=o.aM.simpleSegment(0,0,4,2),ue=new o.aN;ue.emplaceBack(1,0,2),ue.emplaceBack(1,2,3);const ge=l.createIndexBuffer(ue);return this._cachedMesh=new Gt(Y,ge,te),this._cachedMesh}recalculate(){}hasTransition(){return!1}setErrorQueryLatitudeDegrees(l){}}class Qr{constructor(l=0,m=0,w=0,C=0){if(isNaN(l)||l<0||isNaN(m)||m<0||isNaN(w)||w<0||isNaN(C)||C<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=l,this.bottom=m,this.left=w,this.right=C}interpolate(l,m,w){return m.top!=null&&l.top!=null&&(this.top=o.C.number(l.top,m.top,w)),m.bottom!=null&&l.bottom!=null&&(this.bottom=o.C.number(l.bottom,m.bottom,w)),m.left!=null&&l.left!=null&&(this.left=o.C.number(l.left,m.left,w)),m.right!=null&&l.right!=null&&(this.right=o.C.number(l.right,m.right,w)),this}getCenter(l,m){const w=o.ah((this.left+l-this.right)/2,0,l),C=o.ah((this.top+m-this.bottom)/2,0,m);return new o.P(w,C)}equals(l){return this.top===l.top&&this.bottom===l.bottom&&this.left===l.left&&this.right===l.right}clone(){return new Qr(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}function Qn(R,l){if(!R.renderWorldCopies||R.lngRange)return;const m=l.lng-R.center.lng;l.lng+=m>180?-360:m<-180?360:0}function Ei(R){return Math.max(0,Math.floor(R))}class En{constructor(l,m,w,C,N,j){this._callbacks=l,this._tileSize=512,this._renderWorldCopies=j===void 0||!!j,this._minZoom=m||0,this._maxZoom=w||22,this._minPitch=C??0,this._maxPitch=N??60,this.setMaxBounds(),this._width=0,this._height=0,this._center=new o.S(0,0),this._elevation=0,this._zoom=0,this._tileZoom=Ei(this._zoom),this._scale=o.af(this._zoom),this._bearingInRadians=0,this._fovInRadians=.6435011087932844,this._pitchInRadians=0,this._rollInRadians=0,this._unmodified=!0,this._edgeInsets=new Qr,this._minElevationForCurrentTile=0,this._autoCalculateNearFarZ=!0}apply(l,m,w){this._latRange=l.latRange,this._lngRange=l.lngRange,this._width=l.width,this._height=l.height,this._center=l.center,this._elevation=l.elevation,this._minElevationForCurrentTile=l.minElevationForCurrentTile,this._zoom=l.zoom,this._tileZoom=Ei(this._zoom),this._scale=o.af(this._zoom),this._bearingInRadians=l.bearingInRadians,this._fovInRadians=l.fovInRadians,this._pitchInRadians=l.pitchInRadians,this._rollInRadians=l.rollInRadians,this._unmodified=l.unmodified,this._edgeInsets=new Qr(l.padding.top,l.padding.bottom,l.padding.left,l.padding.right),this._minZoom=l.minZoom,this._maxZoom=l.maxZoom,this._minPitch=l.minPitch,this._maxPitch=l.maxPitch,this._renderWorldCopies=l.renderWorldCopies,this._cameraToCenterDistance=l.cameraToCenterDistance,this._nearZ=l.nearZ,this._farZ=l.farZ,this._autoCalculateNearFarZ=!w&&l.autoCalculateNearFarZ,m&&this._constrain(),this._calcMatrices()}get pixelsToClipSpaceMatrix(){return this._pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._clipSpaceToPixelsMatrix}get minElevationForCurrentTile(){return this._minElevationForCurrentTile}setMinElevationForCurrentTile(l){this._minElevationForCurrentTile=l}get tileSize(){return this._tileSize}get tileZoom(){return this._tileZoom}get scale(){return this._scale}get width(){return this._width}get height(){return this._height}get bearingInRadians(){return this._bearingInRadians}get lngRange(){return this._lngRange}get latRange(){return this._latRange}get pixelsToGLUnits(){return this._pixelsToGLUnits}get minZoom(){return this._minZoom}setMinZoom(l){this._minZoom!==l&&(this._minZoom=l,this.setZoom(this.getConstrained(this._center,this.zoom).zoom))}get maxZoom(){return this._maxZoom}setMaxZoom(l){this._maxZoom!==l&&(this._maxZoom=l,this.setZoom(this.getConstrained(this._center,this.zoom).zoom))}get minPitch(){return this._minPitch}setMinPitch(l){this._minPitch!==l&&(this._minPitch=l,this.setPitch(Math.max(this.pitch,l)))}get maxPitch(){return this._maxPitch}setMaxPitch(l){this._maxPitch!==l&&(this._maxPitch=l,this.setPitch(Math.min(this.pitch,l)))}get renderWorldCopies(){return this._renderWorldCopies}setRenderWorldCopies(l){l===void 0?l=!0:l===null&&(l=!1),this._renderWorldCopies=l}get worldSize(){return this._tileSize*this._scale}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new o.P(this._width,this._height)}get bearing(){return this._bearingInRadians/Math.PI*180}setBearing(l){const m=o.aO(l,-180,180)*Math.PI/180;var w,C,N,j,Y,te,ue,ge,Ce;this._bearingInRadians!==m&&(this._unmodified=!1,this._bearingInRadians=m,this._calcMatrices(),this._rotationMatrix=h(),w=this._rotationMatrix,N=-this._bearingInRadians,j=(C=this._rotationMatrix)[0],Y=C[1],te=C[2],ue=C[3],ge=Math.sin(N),Ce=Math.cos(N),w[0]=j*Ce+te*ge,w[1]=Y*Ce+ue*ge,w[2]=j*-ge+te*Ce,w[3]=Y*-ge+ue*Ce)}get rotationMatrix(){return this._rotationMatrix}get pitchInRadians(){return this._pitchInRadians}get pitch(){return this._pitchInRadians/Math.PI*180}setPitch(l){const m=o.ah(l,this.minPitch,this.maxPitch)/180*Math.PI;this._pitchInRadians!==m&&(this._unmodified=!1,this._pitchInRadians=m,this._calcMatrices())}get rollInRadians(){return this._rollInRadians}get roll(){return this._rollInRadians/Math.PI*180}setRoll(l){const m=l/180*Math.PI;this._rollInRadians!==m&&(this._unmodified=!1,this._rollInRadians=m,this._calcMatrices())}get fovInRadians(){return this._fovInRadians}get fov(){return o.aP(this._fovInRadians)}setFov(l){l=o.ah(l,.1,150),this.fov!==l&&(this._unmodified=!1,this._fovInRadians=o.ae(l),this._calcMatrices())}get zoom(){return this._zoom}setZoom(l){const m=this.getConstrained(this._center,l).zoom;this._zoom!==m&&(this._unmodified=!1,this._zoom=m,this._tileZoom=Math.max(0,Math.floor(m)),this._scale=o.af(m),this._constrain(),this._calcMatrices())}get center(){return this._center}setCenter(l){l.lat===this._center.lat&&l.lng===this._center.lng||(this._unmodified=!1,this._center=l,this._constrain(),this._calcMatrices())}get elevation(){return this._elevation}setElevation(l){l!==this._elevation&&(this._elevation=l,this._constrain(),this._calcMatrices())}get padding(){return this._edgeInsets.toJSON()}setPadding(l){this._edgeInsets.equals(l)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,l,1),this._calcMatrices())}get centerPoint(){return this._edgeInsets.getCenter(this._width,this._height)}get pixelsPerMeter(){return this._pixelPerMeter}get unmodified(){return this._unmodified}get cameraToCenterDistance(){return this._cameraToCenterDistance}get nearZ(){return this._nearZ}get farZ(){return this._farZ}get autoCalculateNearFarZ(){return this._autoCalculateNearFarZ}overrideNearFarZ(l,m){this._autoCalculateNearFarZ=!1,this._nearZ=l,this._farZ=m,this._calcMatrices()}clearNearFarZOverride(){this._autoCalculateNearFarZ=!0,this._calcMatrices()}isPaddingEqual(l){return this._edgeInsets.equals(l)}interpolatePadding(l,m,w){this._unmodified=!1,this._edgeInsets.interpolate(l,m,w),this._constrain(),this._calcMatrices()}resize(l,m,w=!0){this._width=l,this._height=m,w&&this._constrain(),this._calcMatrices()}getMaxBounds(){return this._latRange&&this._latRange.length===2&&this._lngRange&&this._lngRange.length===2?new Mt([this._lngRange[0],this._latRange[0]],[this._lngRange[1],this._latRange[1]]):null}setMaxBounds(l){l?(this._lngRange=[l.getWest(),l.getEast()],this._latRange=[l.getSouth(),l.getNorth()],this._constrain()):(this._lngRange=null,this._latRange=[-o.ai,o.ai])}getConstrained(l,m){return this._callbacks.getConstrained(l,m)}getCameraQueryGeometry(l,m){if(m.length===1)return[m[0],l];{const{minX:w,minY:C,maxX:N,maxY:j}=o.a2.fromPoints(m).extend(l);return[new o.P(w,C),new o.P(N,C),new o.P(N,j),new o.P(w,j),new o.P(w,C)]}}_constrain(){if(!this.center||!this._width||!this._height||this._constraining)return;this._constraining=!0;const l=this._unmodified,{center:m,zoom:w}=this.getConstrained(this.center,this.zoom);this.setCenter(m),this.setZoom(w),this._unmodified=l,this._constraining=!1}_calcMatrices(){if(this._width&&this._height){this._pixelsToGLUnits=[2/this._width,-2/this._height];let l=o.ag(new Float64Array(16));o.N(l,l,[this._width/2,-this._height/2,1]),o.M(l,l,[1,-1,0]),this._clipSpaceToPixelsMatrix=l,l=o.ag(new Float64Array(16)),o.N(l,l,[1,-1,1]),o.M(l,l,[-1,-1,0]),o.N(l,l,[2/this._width,2/this._height,1]),this._pixelsToClipSpaceMatrix=l,this._cameraToCenterDistance=.5/Math.tan(this.fovInRadians/2)*this._height}this._callbacks.calcMatrices()}calculateCenterFromCameraLngLatAlt(l,m,w,C){const N=w!==void 0?w:this.bearing,j=C=C!==void 0?C:this.pitch,Y=o.a1.fromLngLat(l,m),te=-Math.cos(o.ae(j)),ue=Math.sin(o.ae(j)),ge=ue*Math.sin(o.ae(N)),Ce=-ue*Math.cos(o.ae(N));let Se=this.elevation;const Fe=m-Se;let Ge;te*Fe>=0||Math.abs(te)<.1?(Ge=1e4,Se=m+Ge*te):Ge=-Fe/te;let ut,lt,ct=o.aQ(1,Y.y),xt=0;do{if(xt+=1,xt>10)break;lt=Ge/ct,ut=new o.a1(Y.x+ge*lt,Y.y+Ce*lt),ct=1/ut.meterInMercatorCoordinateUnits()}while(Math.abs(Ge-lt*ct)>1e-12);return{center:ut.toLngLat(),elevation:Se,zoom:o.ak(this.height/2/Math.tan(this.fovInRadians/2)/lt/this.tileSize)}}recalculateZoomAndCenter(l){if(this.elevation-l==0)return;const m=o.aj(1,this.center.lat)*this.worldSize,w=this.cameraToCenterDistance/m,C=o.a1.fromLngLat(this.center,this.elevation),N=Lt(this.center,this.elevation,this.pitch,this.bearing,w);this._elevation=l;const j=this.calculateCenterFromCameraLngLatAlt(N.toLngLat(),o.aQ(N.z,C.y),this.bearing,this.pitch);this._elevation=j.elevation,this._center=j.center,this.setZoom(j.zoom)}getCameraPoint(){const l=Math.tan(this.pitchInRadians)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new o.P(l*Math.sin(this.rollInRadians),l*Math.cos(this.rollInRadians)))}getCameraAltitude(){return Math.cos(this.pitchInRadians)*this._cameraToCenterDistance/this._pixelPerMeter+this.elevation}getCameraLngLat(){const l=o.aj(1,this.center.lat)*this.worldSize;return Lt(this.center,this.elevation,this.pitch,this.bearing,this.cameraToCenterDistance/l).toLngLat()}getMercatorTileCoordinates(l){if(!l)return[0,0,1,1];const m=l.canonical.z>=0?1<<l.canonical.z:Math.pow(2,l.canonical.z);return[l.canonical.x/m,l.canonical.y/m,1/m/o.$,1/m/o.$]}}class pn{constructor(l,m){this.min=l,this.max=m,this.center=o.aR([],o.aS([],this.min,this.max),.5)}quadrant(l){const m=[l%2==0,l<2],w=o.aT(this.min),C=o.aT(this.max);for(let N=0;N<m.length;N++)w[N]=m[N]?this.min[N]:this.center[N],C[N]=m[N]?this.center[N]:this.max[N];return C[2]=this.max[2],new pn(w,C)}distanceX(l){return Math.max(Math.min(this.max[0],l[0]),this.min[0])-l[0]}distanceY(l){return Math.max(Math.min(this.max[1],l[1]),this.min[1])-l[1]}intersectsFrustum(l){let m=!0;for(let w=0;w<l.planes.length;w++){const C=this.intersectsPlane(l.planes[w]);if(C===0)return 0;C===1&&(m=!1)}return m?2:l.aabb.min[0]>this.max[0]||l.aabb.min[1]>this.max[1]||l.aabb.min[2]>this.max[2]||l.aabb.max[0]<this.min[0]||l.aabb.max[1]<this.min[1]||l.aabb.max[2]<this.min[2]?0:1}intersectsPlane(l){let m=l[3],w=l[3];for(let C=0;C<3;C++)l[C]>0?(m+=l[C]*this.min[C],w+=l[C]*this.max[C]):(w+=l[C]*this.min[C],m+=l[C]*this.max[C]);return m>=0?2:w<0?0:1}}class Mr{distanceToTile2d(l,m,w,C){const N=C.distanceX([l,m]),j=C.distanceY([l,m]);return Math.hypot(N,j)}getWrap(l,m,w){return w}getTileBoundingVolume(l,m,w,C){var N,j;let Y=0,te=0;if(C?.terrain){const ge=new o.Z(l.z,m,l.z,l.x,l.y),Ce=C.terrain.getMinMaxElevation(ge);Y=(N=Ce.minElevation)!==null&&N!==void 0?N:Math.min(0,w),te=(j=Ce.maxElevation)!==null&&j!==void 0?j:Math.max(0,w)}const ue=1<<l.z;return new pn([m+l.x/ue,l.y/ue,Y],[m+(l.x+1)/ue,(l.y+1)/ue,te])}allowVariableZoom(l,m){const w=l.fov*(Math.abs(Math.cos(l.rollInRadians))*l.height+Math.abs(Math.sin(l.rollInRadians))*l.width)/l.height,C=o.ah(78.5-w/2,0,60);return!!m.terrain||l.pitch>C}allowWorldCopies(){return!0}prepareNextFrame(){}}class cn{constructor(l,m,w){this.points=l,this.planes=m,this.aabb=w}static fromInvProjectionMatrix(l,m=1,w=0,C,N){const j=N?[[6,5,4],[0,1,2],[0,3,7],[2,1,5],[3,2,6],[0,4,5]]:[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]],Y=Math.pow(2,w),te=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map((Se=>(function(Fe,Ge,ut,lt){const ct=o.aw([],Fe,Ge),xt=1/ct[3]/ut*lt;return o.aY(ct,ct,[xt,xt,1/ct[3],xt])})(Se,l,m,Y)));C&&(function(Se,Fe,Ge,ut){const lt=ut?4:0,ct=ut?0:4;let xt=0;const Pt=[],Ct=[];for(let At=0;At<4;At++){const qt=o.aU([],Se[At+ct],Se[At+lt]),Sr=o.aZ(qt);o.aR(qt,qt,1/Sr),Pt.push(Sr),Ct.push(qt)}for(let At=0;At<4;At++){const qt=o.a_(Se[At+lt],Ct[At],Ge);xt=qt!==null&&qt>=0?Math.max(xt,qt):Math.max(xt,Pt[At])}const Ot=(function(At,qt){const Sr=o.aU([],At[qt[0]],At[qt[1]]),fr=o.aU([],At[qt[2]],At[qt[1]]),dr=[0,0,0,0];return o.aV(dr,o.aW([],Sr,fr)),dr[3]=-o.aX(dr,At[qt[0]]),dr})(Se,Fe),Bt=(function(At,qt){const Sr=o.a$(At),fr=o.b0([],At,1/Sr),dr=o.aU([],qt,o.aR([],fr,o.aX(qt,fr))),mr=o.a$(dr);if(mr>0){const tn=Math.sqrt(1-fr[3]*fr[3]),nn=o.aR([],fr,-fr[3]),qr=o.aS([],nn,o.aR([],dr,tn/mr));return o.b1(qt,qr)}return null})(Ge,Ot);if(Bt!==null){const At=Bt/o.aX(Ct[0],Ot);xt=Math.min(xt,At)}for(let At=0;At<4;At++){const qt=Math.min(xt,Pt[At]);Se[At+ct]=[Se[At+lt][0]+Ct[At][0]*qt,Se[At+lt][1]+Ct[At][1]*qt,Se[At+lt][2]+Ct[At][2]*qt,1]}})(te,j[0],C,N);const ue=j.map((Se=>{const Fe=o.aU([],te[Se[0]],te[Se[1]]),Ge=o.aU([],te[Se[2]],te[Se[1]]),ut=o.aV([],o.aW([],Fe,Ge)),lt=-o.aX(ut,te[Se[1]]);return ut.concat(lt)})),ge=[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY],Ce=[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY];for(const Se of te)for(let Fe=0;Fe<3;Fe++)ge[Fe]=Math.min(ge[Fe],Se[Fe]),Ce[Fe]=Math.max(Ce[Fe],Se[Fe]);return new cn(te,ue,new pn(ge,Ce))}}class Wn{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(l){this._helper.setMinZoom(l)}setMaxZoom(l){this._helper.setMaxZoom(l)}setMinPitch(l){this._helper.setMinPitch(l)}setMaxPitch(l){this._helper.setMaxPitch(l)}setRenderWorldCopies(l){this._helper.setRenderWorldCopies(l)}setBearing(l){this._helper.setBearing(l)}setPitch(l){this._helper.setPitch(l)}setRoll(l){this._helper.setRoll(l)}setFov(l){this._helper.setFov(l)}setZoom(l){this._helper.setZoom(l)}setCenter(l){this._helper.setCenter(l)}setElevation(l){this._helper.setElevation(l)}setMinElevationForCurrentTile(l){this._helper.setMinElevationForCurrentTile(l)}setPadding(l){this._helper.setPadding(l)}interpolatePadding(l,m,w){return this._helper.interpolatePadding(l,m,w)}isPaddingEqual(l){return this._helper.isPaddingEqual(l)}resize(l,m,w=!0){this._helper.resize(l,m,w)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(l){this._helper.setMaxBounds(l)}overrideNearFarZ(l,m){this._helper.overrideNearFarZ(l,m)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(l){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),l)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}setTransitionState(l,m){}constructor(l,m,w,C,N){this._posMatrixCache=new Map,this._alignedPosMatrixCache=new Map,this._fogMatrixCacheF32=new Map,this._helper=new En({calcMatrices:()=>{this._calcMatrices()},getConstrained:(j,Y)=>this.getConstrained(j,Y)},l,m,w,C,N),this._coveringTilesDetailsProvider=new Mr}clone(){const l=new Wn;return l.apply(this),l}apply(l,m,w){this._helper.apply(l,m,w)}get cameraPosition(){return this._cameraPosition}get projectionMatrix(){return this._projectionMatrix}get modelViewProjectionMatrix(){return this._viewProjMatrix}get inverseProjectionMatrix(){return this._invProjMatrix}get mercatorMatrix(){return this._mercatorMatrix}getVisibleUnwrappedCoordinates(l){const m=[new o.b2(0,l)];if(this._helper._renderWorldCopies){const w=this.screenPointToMercatorCoordinate(new o.P(0,0)),C=this.screenPointToMercatorCoordinate(new o.P(this._helper._width,0)),N=this.screenPointToMercatorCoordinate(new o.P(this._helper._width,this._helper._height)),j=this.screenPointToMercatorCoordinate(new o.P(0,this._helper._height)),Y=Math.floor(Math.min(w.x,C.x,N.x,j.x)),te=Math.floor(Math.max(w.x,C.x,N.x,j.x)),ue=1;for(let ge=Y-ue;ge<=te+ue;ge++)ge!==0&&m.push(new o.b2(ge,l))}return m}getCameraFrustum(){return cn.fromInvProjectionMatrix(this._invViewProjMatrix,this.worldSize)}getClippingPlane(){return null}getCoveringTilesDetailsProvider(){return this._coveringTilesDetailsProvider}recalculateZoomAndCenter(l){const m=this.screenPointToLocation(this.centerPoint,l),w=l?l.getElevationForLngLatZoom(m,this._helper._tileZoom):0;this._helper.recalculateZoomAndCenter(w)}setLocationAtPoint(l,m){const w=o.aj(this.elevation,this.center.lat),C=this.screenPointToMercatorCoordinateAtZ(m,w),N=this.screenPointToMercatorCoordinateAtZ(this.centerPoint,w),j=o.a1.fromLngLat(l),Y=new o.a1(j.x-(C.x-N.x),j.y-(C.y-N.y));this.setCenter(Y?.toLngLat()),this._helper._renderWorldCopies&&this.setCenter(this.center.wrap())}locationToScreenPoint(l,m){return m?this.coordinatePoint(o.a1.fromLngLat(l),m.getElevationForLngLatZoom(l,this._helper._tileZoom),this._pixelMatrix3D):this.coordinatePoint(o.a1.fromLngLat(l))}screenPointToLocation(l,m){var w;return(w=this.screenPointToMercatorCoordinate(l,m))===null||w===void 0?void 0:w.toLngLat()}screenPointToMercatorCoordinate(l,m){if(m){const w=m.pointCoordinate(l);if(w!=null)return w}return this.screenPointToMercatorCoordinateAtZ(l)}screenPointToMercatorCoordinateAtZ(l,m){const w=m||0,C=[l.x,l.y,0,1],N=[l.x,l.y,1,1];o.aw(C,C,this._pixelMatrixInverse),o.aw(N,N,this._pixelMatrixInverse);const j=C[3],Y=N[3],te=C[1]/j,ue=N[1]/Y,ge=C[2]/j,Ce=N[2]/Y,Se=ge===Ce?0:(w-ge)/(Ce-ge);return new o.a1(o.C.number(C[0]/j,N[0]/Y,Se)/this.worldSize,o.C.number(te,ue,Se)/this.worldSize,w)}coordinatePoint(l,m=0,w=this._pixelMatrix){const C=[l.x*this.worldSize,l.y*this.worldSize,m,1];return o.aw(C,C,w),new o.P(C[0]/C[3],C[1]/C[3])}getBounds(){const l=Math.max(0,this._helper._height/2-ot(this));return new Mt().extend(this.screenPointToLocation(new o.P(0,l))).extend(this.screenPointToLocation(new o.P(this._helper._width,l))).extend(this.screenPointToLocation(new o.P(this._helper._width,this._helper._height))).extend(this.screenPointToLocation(new o.P(0,this._helper._height)))}isPointOnMapSurface(l,m){return m?m.pointCoordinate(l)!=null:l.y>this.height/2-ot(this)}calculatePosMatrix(l,m=!1,w){var C;const N=(C=l.key)!==null&&C!==void 0?C:o.b3(l.wrap,l.canonical.z,l.canonical.z,l.canonical.x,l.canonical.y),j=m?this._alignedPosMatrixCache:this._posMatrixCache;if(j.has(N)){const ue=j.get(N);return w?ue.f32:ue.f64}const Y=et(l,this.worldSize);o.O(Y,m?this._alignedProjMatrix:this._viewProjMatrix,Y);const te={f64:Y,f32:new Float32Array(Y)};return j.set(N,te),w?te.f32:te.f64}calculateFogMatrix(l){const m=l.key,w=this._fogMatrixCacheF32;if(w.has(m))return w.get(m);const C=et(l,this.worldSize);return o.O(C,this._fogMatrix,C),w.set(m,new Float32Array(C)),w.get(m)}getConstrained(l,m){m=o.ah(+m,this.minZoom,this.maxZoom);const w={center:new o.S(l.lng,l.lat),zoom:m};let C=this._helper._lngRange;if(!this._helper._renderWorldCopies&&C===null){const Pt=179.9999999999;C=[-Pt,Pt]}const N=this.tileSize*o.af(w.zoom);let j=0,Y=N,te=0,ue=N,ge=0,Ce=0;const{x:Se,y:Fe}=this.size;if(this._helper._latRange){const Pt=this._helper._latRange;j=o.U(Pt[1])*N,Y=o.U(Pt[0])*N,Y-j<Fe&&(ge=Fe/(Y-j))}C&&(te=o.aO(o.V(C[0])*N,0,N),ue=o.aO(o.V(C[1])*N,0,N),ue<te&&(ue+=N),ue-te<Se&&(Ce=Se/(ue-te)));const{x:Ge,y:ut}=qe(N,l);let lt,ct;const xt=Math.max(Ce||0,ge||0);if(xt){const Pt=new o.P(Ce?(ue+te)/2:Ge,ge?(Y+j)/2:ut);return w.center=Qe(N,Pt).wrap(),w.zoom+=o.ak(xt),w}if(this._helper._latRange){const Pt=Fe/2;ut-Pt<j&&(ct=j+Pt),ut+Pt>Y&&(ct=Y-Pt)}if(C){const Pt=(te+ue)/2;let Ct=Ge;this._helper._renderWorldCopies&&(Ct=o.aO(Ge,Pt-N/2,Pt+N/2));const Ot=Se/2;Ct-Ot<te&&(lt=te+Ot),Ct+Ot>ue&&(lt=ue-Ot)}if(lt!==void 0||ct!==void 0){const Pt=new o.P(lt??Ge,ct??ut);w.center=Qe(N,Pt).wrap()}return w}calculateCenterFromCameraLngLatAlt(l,m,w,C){return this._helper.calculateCenterFromCameraLngLatAlt(l,m,w,C)}_calculateNearFarZIfNeeded(l,m,w){if(!this._helper.autoCalculateNearFarZ)return;const C=Math.min(this.elevation,this.minElevationForCurrentTile,this.getCameraAltitude()-100),N=l-C*this._helper._pixelPerMeter/Math.cos(m),j=C<0?N:l,Y=Math.PI/2+this.pitchInRadians,te=o.ae(this.fov)*(Math.abs(Math.cos(o.ae(this.roll)))*this.height+Math.abs(Math.sin(o.ae(this.roll)))*this.width)/this.height*(.5+w.y/this.height),ue=Math.sin(te)*j/Math.sin(o.ah(Math.PI-Y-te,.01,Math.PI-.01)),ge=ot(this),Ce=Math.atan(ge/this._helper.cameraToCenterDistance),Se=o.ae(.75),Fe=Ce>Se?2*Ce*(.5+w.y/(2*ge)):Se,Ge=Math.sin(Fe)*j/Math.sin(o.ah(Math.PI-Y-Fe,.01,Math.PI-.01)),ut=Math.min(ue,Ge);this._helper._farZ=1.01*(Math.cos(Math.PI/2-m)*ut+j),this._helper._nearZ=this._helper._height/50}_calcMatrices(){if(!this._helper._height)return;const l=this.centerOffset,m=qe(this.worldSize,this.center),w=m.x,C=m.y;this._helper._pixelPerMeter=o.aj(1,this.center.lat)*this.worldSize;const N=o.ae(Math.min(this.pitch,be)),j=Math.max(this._helper.cameraToCenterDistance/2,this._helper.cameraToCenterDistance+this._helper._elevation*this._helper._pixelPerMeter/Math.cos(N));let Y;this._calculateNearFarZIfNeeded(j,N,l),Y=new Float64Array(16),o.b4(Y,this.fovInRadians,this._helper._width/this._helper._height,this._helper._nearZ,this._helper._farZ),this._invProjMatrix=new Float64Array(16),o.aq(this._invProjMatrix,Y),Y[8]=2*-l.x/this._helper._width,Y[9]=2*l.y/this._helper._height,this._projectionMatrix=o.b5(Y),o.N(Y,Y,[1,-1,1]),o.M(Y,Y,[0,0,-this._helper.cameraToCenterDistance]),o.b6(Y,Y,-this.rollInRadians),o.b7(Y,Y,this.pitchInRadians),o.b6(Y,Y,-this.bearingInRadians),o.M(Y,Y,[-w,-C,0]),this._mercatorMatrix=o.N([],Y,[this.worldSize,this.worldSize,this.worldSize]),o.N(Y,Y,[1,1,this._helper._pixelPerMeter]),this._pixelMatrix=o.O(new Float64Array(16),this.clipSpaceToPixelsMatrix,Y),o.M(Y,Y,[0,0,-this.elevation]),this._viewProjMatrix=Y,this._invViewProjMatrix=o.aq([],Y);const te=[0,0,-1,1];o.aw(te,te,this._invViewProjMatrix),this._cameraPosition=[te[0]/te[3],te[1]/te[3],te[2]/te[3]],this._fogMatrix=new Float64Array(16),o.b4(this._fogMatrix,this.fovInRadians,this.width/this.height,j,this._helper._farZ),this._fogMatrix[8]=2*-l.x/this.width,this._fogMatrix[9]=2*l.y/this.height,o.N(this._fogMatrix,this._fogMatrix,[1,-1,1]),o.M(this._fogMatrix,this._fogMatrix,[0,0,-this.cameraToCenterDistance]),o.b6(this._fogMatrix,this._fogMatrix,-this.rollInRadians),o.b7(this._fogMatrix,this._fogMatrix,this.pitchInRadians),o.b6(this._fogMatrix,this._fogMatrix,-this.bearingInRadians),o.M(this._fogMatrix,this._fogMatrix,[-w,-C,0]),o.N(this._fogMatrix,this._fogMatrix,[1,1,this._helper._pixelPerMeter]),o.M(this._fogMatrix,this._fogMatrix,[0,0,-this.elevation]),this._pixelMatrix3D=o.O(new Float64Array(16),this.clipSpaceToPixelsMatrix,Y);const ue=this._helper._width%2/2,ge=this._helper._height%2/2,Ce=Math.cos(this.bearingInRadians),Se=Math.sin(-this.bearingInRadians),Fe=w-Math.round(w)+Ce*ue+Se*ge,Ge=C-Math.round(C)+Ce*ge+Se*ue,ut=new Float64Array(Y);if(o.M(ut,ut,[Fe>.5?Fe-1:Fe,Ge>.5?Ge-1:Ge,0]),this._alignedProjMatrix=ut,Y=o.aq(new Float64Array(16),this._pixelMatrix),!Y)throw new Error("failed to invert matrix");this._pixelMatrixInverse=Y,this._clearMatrixCaches()}_clearMatrixCaches(){this._posMatrixCache.clear(),this._alignedPosMatrixCache.clear(),this._fogMatrixCacheF32.clear()}maxPitchScaleFactor(){if(!this._pixelMatrixInverse)return 1;const l=this.screenPointToMercatorCoordinate(new o.P(0,0)),m=[l.x*this.worldSize,l.y*this.worldSize,0,1];return o.aw(m,m,this._pixelMatrix)[3]/this._helper.cameraToCenterDistance}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){const l=o.aj(1,this.center.lat)*this.worldSize;return Lt(this.center,this.elevation,this.pitch,this.bearing,this._helper.cameraToCenterDistance/l).toLngLat()}lngLatToCameraDepth(l,m){const w=o.a1.fromLngLat(l),C=[w.x*this.worldSize,w.y*this.worldSize,m,1];return o.aw(C,C,this._viewProjMatrix),C[2]/C[3]}getProjectionData(l){const{overscaledTileID:m,aligned:w,applyTerrainMatrix:C}=l,N=this._helper.getMercatorTileCoordinates(m),j=m?this.calculatePosMatrix(m,w,!0):null;let Y;return Y=m&&m.terrainRttPosMatrix32f&&C?m.terrainRttPosMatrix32f:j||o.b8(),{mainMatrix:Y,tileMercatorCoords:N,clippingPlane:[0,0,0,0],projectionTransition:0,fallbackMatrix:Y}}isLocationOccluded(l){return!1}getPixelScale(){return 1}getCircleRadiusCorrection(){return 1}getPitchedTextCorrection(l,m,w){return 1}transformLightDirection(l){return o.aT(l)}getRayDirectionFromPixel(l){throw new Error("Not implemented.")}projectTileCoordinates(l,m,w,C){const N=this.calculatePosMatrix(w);let j;C?(j=[l,m,C(l,m),1],o.aw(j,j,N)):(j=[l,m,0,1],xa(j,j,N));const Y=j[3];return{point:new o.P(j[0]/Y,j[1]/Y),signedDistanceFromCamera:Y,isOccluded:!1}}populateCache(l){for(const m of l)this.calculatePosMatrix(m)}getMatrixForModel(l,m){const w=o.a1.fromLngLat(l,m),C=w.meterInMercatorCoordinateUnits(),N=o.b9();return o.M(N,N,[w.x,w.y,w.z]),o.b6(N,N,Math.PI),o.b7(N,N,Math.PI/2),o.N(N,N,[-C,C,C]),N}getProjectionDataForCustomLayer(l=!0){const m=new o.Z(0,0,0,0,0),w=this.getProjectionData({overscaledTileID:m,applyGlobeMatrix:l}),C=et(m,this.worldSize);o.O(C,this._viewProjMatrix,C),w.tileMercatorCoords=[0,0,1,1];const N=[o.$,o.$,this.worldSize/this._helper.pixelsPerMeter],j=o.ba();return o.N(j,C,N),w.fallbackMatrix=j,w.mainMatrix=j,w}getFastPathSimpleProjectionMatrix(l){return this.calculatePosMatrix(l)}}function Ma(){o.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.")}function Ci(R){if(R.useSlerp)if(R.k<1){const l=o.bb(R.startEulerAngles.roll,R.startEulerAngles.pitch,R.startEulerAngles.bearing),m=o.bb(R.endEulerAngles.roll,R.endEulerAngles.pitch,R.endEulerAngles.bearing),w=new Float64Array(4);o.bc(w,l,m,R.k);const C=o.bd(w);R.tr.setRoll(C.roll),R.tr.setPitch(C.pitch),R.tr.setBearing(C.bearing)}else R.tr.setRoll(R.endEulerAngles.roll),R.tr.setPitch(R.endEulerAngles.pitch),R.tr.setBearing(R.endEulerAngles.bearing);else R.tr.setRoll(o.C.number(R.startEulerAngles.roll,R.endEulerAngles.roll,R.k)),R.tr.setPitch(o.C.number(R.startEulerAngles.pitch,R.endEulerAngles.pitch,R.k)),R.tr.setBearing(o.C.number(R.startEulerAngles.bearing,R.endEulerAngles.bearing,R.k))}function Ra(R,l,m,w,C){const N=C.padding,j=qe(C.worldSize,m.getNorthWest()),Y=qe(C.worldSize,m.getNorthEast()),te=qe(C.worldSize,m.getSouthEast()),ue=qe(C.worldSize,m.getSouthWest()),ge=o.ae(-w),Ce=j.rotate(ge),Se=Y.rotate(ge),Fe=te.rotate(ge),Ge=ue.rotate(ge),ut=new o.P(Math.max(Ce.x,Se.x,Ge.x,Fe.x),Math.max(Ce.y,Se.y,Ge.y,Fe.y)),lt=new o.P(Math.min(Ce.x,Se.x,Ge.x,Fe.x),Math.min(Ce.y,Se.y,Ge.y,Fe.y)),ct=ut.sub(lt),xt=(C.width-(N.left+N.right+l.left+l.right))/ct.x,Pt=(C.height-(N.top+N.bottom+l.top+l.bottom))/ct.y;if(Pt<0||xt<0)return void Ma();const Ct=Math.min(o.ak(C.scale*Math.min(xt,Pt)),R.maxZoom),Ot=o.P.convert(R.offset),Bt=new o.P((l.left-l.right)/2,(l.top-l.bottom)/2).rotate(o.ae(w)),At=Ot.add(Bt).mult(C.scale/o.af(Ct));return{center:Qe(C.worldSize,j.add(te).div(2).sub(At)),zoom:Ct,bearing:w}}class gi{get useGlobeControls(){return!1}handlePanInertia(l,m){const w=l.mag(),C=Math.abs(ot(m));return{easingOffset:l.mult(Math.min(.75*C/w,1)),easingCenter:m.center}}handleMapControlsRollPitchBearingZoom(l,m){l.bearingDelta&&m.setBearing(m.bearing+l.bearingDelta),l.pitchDelta&&m.setPitch(m.pitch+l.pitchDelta),l.rollDelta&&m.setRoll(m.roll+l.rollDelta),l.zoomDelta&&m.setZoom(m.zoom+l.zoomDelta)}handleMapControlsPan(l,m,w){l.around.distSqr(m.centerPoint)<.01||m.setLocationAtPoint(w,l.around)}cameraForBoxAndBearing(l,m,w,C,N){return Ra(l,m,w,C,N)}handleJumpToCenterZoom(l,m){l.zoom!==(m.zoom!==void 0?+m.zoom:l.zoom)&&l.setZoom(+m.zoom),m.center!==void 0&&l.setCenter(o.S.convert(m.center))}handleEaseTo(l,m){const w=l.zoom,C=l.padding,N={roll:l.roll,pitch:l.pitch,bearing:l.bearing},j={roll:m.roll===void 0?l.roll:m.roll,pitch:m.pitch===void 0?l.pitch:m.pitch,bearing:m.bearing===void 0?l.bearing:m.bearing},Y=m.zoom!==void 0,te=!l.isPaddingEqual(m.padding);let ue=!1;const ge=Y?+m.zoom:l.zoom;let Ce=l.centerPoint.add(m.offsetAsPoint);const Se=l.screenPointToLocation(Ce),{center:Fe,zoom:Ge}=l.getConstrained(o.S.convert(m.center||Se),ge??w);Qn(l,Fe);const ut=qe(l.worldSize,Se),lt=qe(l.worldSize,Fe).sub(ut),ct=o.af(Ge-w);return ue=Ge!==w,{easeFunc:xt=>{if(ue&&l.setZoom(o.C.number(w,Ge,xt)),o.be(N,j)||Ci({startEulerAngles:N,endEulerAngles:j,tr:l,k:xt,useSlerp:N.roll!=j.roll}),te&&(l.interpolatePadding(C,m.padding,xt),Ce=l.centerPoint.add(m.offsetAsPoint)),m.around)l.setLocationAtPoint(m.around,m.aroundPoint);else{const Pt=o.af(l.zoom-w),Ct=Ge>w?Math.min(2,ct):Math.max(.5,ct),Ot=Math.pow(Ct,1-xt),Bt=Qe(l.worldSize,ut.add(lt.mult(xt*Ot)).mult(Pt));l.setLocationAtPoint(l.renderWorldCopies?Bt.wrap():Bt,Ce)}},isZooming:ue,elevationCenter:Fe}}handleFlyTo(l,m){const w=m.zoom!==void 0,C=l.zoom,N=l.getConstrained(o.S.convert(m.center||m.locationAtOffset),w?+m.zoom:C),j=N.center,Y=N.zoom;Qn(l,j);const te=qe(l.worldSize,m.locationAtOffset),ue=qe(l.worldSize,j).sub(te),ge=ue.mag(),Ce=o.af(Y-C);let Se;if(m.minZoom!==void 0){const Fe=Math.min(+m.minZoom,C,Y),Ge=l.getConstrained(j,Fe).zoom;Se=o.af(Ge-C)}return{easeFunc:(Fe,Ge,ut,lt)=>{l.setZoom(Fe===1?Y:C+o.ak(Ge));const ct=Fe===1?j:Qe(l.worldSize,te.add(ue.mult(ut)).mult(Ge));l.setLocationAtPoint(l.renderWorldCopies?ct.wrap():ct,lt)},scaleOfZoom:Ce,targetCenter:j,scaleOfMinZoom:Se,pixelPathLength:ge}}}class jn{constructor(l,m,w){this.blendFunction=l,this.blendColor=m,this.mask=w}}jn.Replace=[1,0],jn.disabled=new jn(jn.Replace,o.bf.transparent,[!1,!1,!1,!1]),jn.unblended=new jn(jn.Replace,o.bf.transparent,[!0,!0,!0,!0]),jn.alphaBlended=new jn([1,771],o.bf.transparent,[!0,!0,!0,!0]);const us=2305;class Un{constructor(l,m,w){this.enable=l,this.mode=m,this.frontFace=w}}Un.disabled=new Un(!1,1029,us),Un.backCCW=new Un(!0,1029,us),Un.frontCCW=new Un(!0,1028,us);class Nn{constructor(l,m,w){this.func=l,this.mask=m,this.range=w}}Nn.ReadOnly=!1,Nn.ReadWrite=!0,Nn.disabled=new Nn(519,Nn.ReadOnly,[0,1]);const Go=7680;class Yn{constructor(l,m,w,C,N,j){this.test=l,this.ref=m,this.mask=w,this.fail=C,this.depthFail=N,this.pass=j}}Yn.disabled=new Yn({func:519,mask:0},0,0,Go,Go,Go);const Do=new WeakMap;function To(R){var l;if(Do.has(R))return Do.get(R);{const m=(l=R.getParameter(R.VERSION))===null||l===void 0?void 0:l.startsWith("WebGL 2.0");return Do.set(R,m),m}}class Xo{get awaitingQuery(){return!!this._readbackQueue}constructor(l){this._readbackWaitFrames=4,this._measureWaitFrames=6,this._texWidth=1,this._texHeight=1,this._measuredError=0,this._updateCount=0,this._lastReadbackFrame=-1e3,this._readbackQueue=null,this._cachedRenderContext=l;const m=l.context,w=m.gl;this._texFormat=w.RGBA,this._texType=w.UNSIGNED_BYTE;const C=new o.aL;C.emplaceBack(-1,-1),C.emplaceBack(2,-1),C.emplaceBack(-1,2);const N=new o.aN;N.emplaceBack(0,1,2),this._fullscreenTriangle=new Gt(m.createVertexBuffer(C,$r.members),m.createIndexBuffer(N),o.aM.simpleSegment(0,0,C.length,N.length)),this._resultBuffer=new Uint8Array(4),m.activeTexture.set(w.TEXTURE1);const j=w.createTexture();w.bindTexture(w.TEXTURE_2D,j),w.texParameteri(w.TEXTURE_2D,w.TEXTURE_WRAP_S,w.CLAMP_TO_EDGE),w.texParameteri(w.TEXTURE_2D,w.TEXTURE_WRAP_T,w.CLAMP_TO_EDGE),w.texParameteri(w.TEXTURE_2D,w.TEXTURE_MIN_FILTER,w.NEAREST),w.texParameteri(w.TEXTURE_2D,w.TEXTURE_MAG_FILTER,w.NEAREST),w.texImage2D(w.TEXTURE_2D,0,this._texFormat,this._texWidth,this._texHeight,0,this._texFormat,this._texType,null),this._fbo=m.createFramebuffer(this._texWidth,this._texHeight,!1,!1),this._fbo.colorAttachment.set(j),To(w)&&(this._pbo=w.createBuffer(),w.bindBuffer(w.PIXEL_PACK_BUFFER,this._pbo),w.bufferData(w.PIXEL_PACK_BUFFER,4,w.STREAM_READ),w.bindBuffer(w.PIXEL_PACK_BUFFER,null))}destroy(){const l=this._cachedRenderContext.context.gl;this._fullscreenTriangle.destroy(),this._fbo.destroy(),l.deleteBuffer(this._pbo),this._fullscreenTriangle=null,this._fbo=null,this._pbo=null,this._resultBuffer=null}updateErrorLoop(l,m){const w=this._updateCount;return this._readbackQueue?w>=this._readbackQueue.frameNumberIssued+this._readbackWaitFrames&&this._tryReadback():w>=this._lastReadbackFrame+this._measureWaitFrames&&this._renderErrorTexture(l,m),this._updateCount++,this._measuredError}_bindFramebuffer(){const l=this._cachedRenderContext.context,m=l.gl;l.activeTexture.set(m.TEXTURE1),m.bindTexture(m.TEXTURE_2D,this._fbo.colorAttachment.get()),l.bindFramebuffer.set(this._fbo.framebuffer)}_renderErrorTexture(l,m){const w=this._cachedRenderContext.context,C=w.gl;if(this._bindFramebuffer(),w.viewport.set([0,0,this._texWidth,this._texHeight]),w.clear({color:o.bf.transparent}),this._cachedRenderContext.useProgram("projectionErrorMeasurement").draw(w,C.TRIANGLES,Nn.disabled,Yn.disabled,jn.unblended,Un.disabled,((N,j)=>({u_input:N,u_output_expected:j}))(l,m),null,null,"$clipping",this._fullscreenTriangle.vertexBuffer,this._fullscreenTriangle.indexBuffer,this._fullscreenTriangle.segments),this._pbo&&To(C)){C.bindBuffer(C.PIXEL_PACK_BUFFER,this._pbo),C.readBuffer(C.COLOR_ATTACHMENT0),C.readPixels(0,0,this._texWidth,this._texHeight,this._texFormat,this._texType,0),C.bindBuffer(C.PIXEL_PACK_BUFFER,null);const N=C.fenceSync(C.SYNC_GPU_COMMANDS_COMPLETE,0);C.flush(),this._readbackQueue={frameNumberIssued:this._updateCount,sync:N}}else this._readbackQueue={frameNumberIssued:this._updateCount,sync:null}}_tryReadback(){const l=this._cachedRenderContext.context.gl;if(this._pbo&&this._readbackQueue&&To(l)){const m=l.clientWaitSync(this._readbackQueue.sync,0,0);if(m===l.WAIT_FAILED)return o.w("WebGL2 clientWaitSync failed."),this._readbackQueue=null,void(this._lastReadbackFrame=this._updateCount);if(m===l.TIMEOUT_EXPIRED)return;l.bindBuffer(l.PIXEL_PACK_BUFFER,this._pbo),l.getBufferSubData(l.PIXEL_PACK_BUFFER,0,this._resultBuffer,0,4),l.bindBuffer(l.PIXEL_PACK_BUFFER,null)}else this._bindFramebuffer(),l.readPixels(0,0,this._texWidth,this._texHeight,this._texFormat,this._texType,this._resultBuffer);this._readbackQueue=null,this._measuredError=Xo._parseRGBA8float(this._resultBuffer),this._lastReadbackFrame=this._updateCount}static _parseRGBA8float(l){let m=0;return m+=l[0]/256,m+=l[1]/65536,m+=l[2]/16777216,l[3]<127&&(m=-m),m/128}}const tl=o.$/128;function nu(R,l){const m=R.granularity!==void 0?Math.max(R.granularity,1):1,w=m+(R.generateBorders?2:0),C=m+(R.extendToNorthPole||R.generateBorders?1:0)+(R.extendToSouthPole||R.generateBorders?1:0),N=w+1,j=C+1,Y=R.generateBorders?-1:0,te=R.generateBorders||R.extendToNorthPole?-1:0,ue=m+(R.generateBorders?1:0),ge=m+(R.generateBorders||R.extendToSouthPole?1:0),Ce=N*j,Se=w*C*6,Fe=N*j>65536;if(Fe&&l==="16bit")throw new Error("Granularity is too large and meshes would not fit inside 16 bit vertex indices.");const Ge=Fe||l==="32bit",ut=new Int16Array(2*Ce);let lt=0;for(let Pt=te;Pt<=ge;Pt++)for(let Ct=Y;Ct<=ue;Ct++){let Ot=Ct/m*o.$;Ct===-1&&(Ot=-tl),Ct===m+1&&(Ot=o.$+tl);let Bt=Pt/m*o.$;Pt===-1&&(Bt=R.extendToNorthPole?o.bh:-tl),Pt===m+1&&(Bt=R.extendToSouthPole?o.bi:o.$+tl),ut[lt++]=Ot,ut[lt++]=Bt}const ct=Ge?new Uint32Array(Se):new Uint16Array(Se);let xt=0;for(let Pt=0;Pt<C;Pt++)for(let Ct=0;Ct<w;Ct++){const Ot=Ct+1+Pt*N,Bt=Ct+(Pt+1)*N,At=Ct+1+(Pt+1)*N;ct[xt++]=Ct+Pt*N,ct[xt++]=Bt,ct[xt++]=Ot,ct[xt++]=Ot,ct[xt++]=Bt,ct[xt++]=At}return{vertices:ut.buffer.slice(0),indices:ct.buffer.slice(0),uses32bitIndices:Ge}}const _l=new o.aK({fill:new o.bj(128,2),line:new o.bj(512,0),tile:new o.bj(128,32),stencil:new o.bj(128,1),circle:3});class Co{constructor(){this._tileMeshCache={},this._errorCorrectionUsable=0,this._errorMeasurementLastValue=0,this._errorCorrectionPreviousValue=0,this._errorMeasurementLastChangeTime=-1e3}get name(){return"vertical-perspective"}get transitionState(){return 1}get useSubdivision(){return!0}get shaderVariantName(){return"globe"}get shaderDefine(){return"#define GLOBE"}get shaderPreludeCode(){return Nt.projectionGlobe}get vertexShaderPreludeCode(){return Nt.projectionMercator.vertexSource}get subdivisionGranularity(){return _l}get useGlobeControls(){return!0}get latitudeErrorCorrectionRadians(){return this._errorCorrectionUsable}destroy(){this._errorMeasurement&&this._errorMeasurement.destroy()}updateGPUdependent(l){this._errorMeasurement||(this._errorMeasurement=new Xo(l));const m=o.U(this._errorQueryLatitudeDegrees),w=2*Math.atan(Math.exp(Math.PI-m*Math.PI*2))-.5*Math.PI,C=this._errorMeasurement.updateErrorLoop(m,w),N=b.now();C!==this._errorMeasurementLastValue&&(this._errorCorrectionPreviousValue=this._errorCorrectionUsable,this._errorMeasurementLastValue=C,this._errorMeasurementLastChangeTime=N);const j=Math.min(Math.max((N-this._errorMeasurementLastChangeTime)/1e3/.5,0),1);this._errorCorrectionUsable=o.bk(this._errorCorrectionPreviousValue,-this._errorMeasurementLastValue,o.bl(j))}_getMeshKey(l){return`${l.granularity.toString(36)}_${l.generateBorders?"b":""}${l.extendToNorthPole?"n":""}${l.extendToSouthPole?"s":""}`}getMeshFromTileID(l,m,w,C,N){const j=(N==="stencil"?_l.stencil:_l.tile).getGranularityForZoomLevel(m.z);return this._getMesh(l,{granularity:j,generateBorders:w,extendToNorthPole:m.y===0&&C,extendToSouthPole:m.y===(1<<m.z)-1&&C})}_getMesh(l,m){const w=this._getMeshKey(m);if(w in this._tileMeshCache)return this._tileMeshCache[w];const C=(function(N,j){const Y=nu(j,"16bit"),te=o.aL.deserialize({arrayBuffer:Y.vertices,length:Y.vertices.byteLength/2/2}),ue=o.aN.deserialize({arrayBuffer:Y.indices,length:Y.indices.byteLength/2/3});return new Gt(N.createVertexBuffer(te,$r.members),N.createIndexBuffer(ue),o.aM.simpleSegment(0,0,te.length,ue.length))})(l,m);return this._tileMeshCache[w]=C,C}recalculate(l){}hasTransition(){const l=b.now();let m=!1;return m=m||(l-this._errorMeasurementLastChangeTime)/1e3<.7,m=m||this._errorMeasurement&&this._errorMeasurement.awaitingQuery,m}setErrorQueryLatitudeDegrees(l){this._errorQueryLatitudeDegrees=l}}const rl=new o.r({type:new o.D(o.v.projection.type)});class bl extends o.E{constructor(l){super(),this._transitionable=new o.t(rl),this.setProjection(l),this._transitioning=this._transitionable.untransitioned(),this.recalculate(new o.F(0)),this._mercatorProjection=new kr,this._verticalPerspectiveProjection=new Co}get transitionState(){const l=this.properties.get("type");if(typeof l=="string"&&l==="mercator")return 0;if(typeof l=="string"&&l==="vertical-perspective")return 1;if(l instanceof o.bm){if(l.from==="vertical-perspective"&&l.to==="mercator")return 1-l.transition;if(l.from==="mercator"&&l.to==="vertical-perspective")return l.transition}return 1}get useGlobeRendering(){return this.transitionState>0}get latitudeErrorCorrectionRadians(){return this._verticalPerspectiveProjection.latitudeErrorCorrectionRadians}get currentProjection(){return this.useGlobeRendering?this._verticalPerspectiveProjection:this._mercatorProjection}get name(){return"globe"}get useSubdivision(){return this.currentProjection.useSubdivision}get shaderVariantName(){return this.currentProjection.shaderVariantName}get shaderDefine(){return this.currentProjection.shaderDefine}get shaderPreludeCode(){return this.currentProjection.shaderPreludeCode}get vertexShaderPreludeCode(){return this.currentProjection.vertexShaderPreludeCode}get subdivisionGranularity(){return this.currentProjection.subdivisionGranularity}get useGlobeControls(){return this.transitionState>0}destroy(){this._mercatorProjection.destroy(),this._verticalPerspectiveProjection.destroy()}updateGPUdependent(l){this._mercatorProjection.updateGPUdependent(l),this._verticalPerspectiveProjection.updateGPUdependent(l)}getMeshFromTileID(l,m,w,C,N){return this.currentProjection.getMeshFromTileID(l,m,w,C,N)}setProjection(l){this._transitionable.setValue("type",l?.type||"mercator")}updateTransitions(l){this._transitioning=this._transitionable.transitioned(l,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()||this.currentProjection.hasTransition()}recalculate(l){this.properties=this._transitioning.possiblyEvaluate(l)}setErrorQueryLatitudeDegrees(l){this._verticalPerspectiveProjection.setErrorQueryLatitudeDegrees(l),this._mercatorProjection.setErrorQueryLatitudeDegrees(l)}}function lo(R){const l=Da(R.worldSize,R.center.lat);return 2*Math.PI*l}function uo(R,l,m,w,C){const N=1/(1<<C),j=l/o.$*N+w*N,Y=o.bo((R/o.$*N+m*N)*Math.PI*2+Math.PI,2*Math.PI),te=2*Math.atan(Math.exp(Math.PI-j*Math.PI*2))-.5*Math.PI,ue=Math.cos(te),ge=new Float64Array(3);return ge[0]=Math.sin(Y)*ue,ge[1]=Math.sin(te),ge[2]=Math.cos(Y)*ue,ge}function na(R){return(function(l,m){const w=Math.cos(m),C=new Float64Array(3);return C[0]=Math.sin(l)*w,C[1]=Math.sin(m),C[2]=Math.cos(l)*w,C})(R.lng*Math.PI/180,R.lat*Math.PI/180)}function Da(R,l){return R/(2*Math.PI)/Math.cos(l*Math.PI/180)}function le(R){const l=Math.asin(R[1])/Math.PI*180,m=Math.sqrt(R[0]*R[0]+R[2]*R[2]);if(m>1e-6){const w=R[0]/m,C=Math.acos(R[2]/m),N=(w>0?C:-C)/Math.PI*180;return new o.S(o.aO(N,-180,180),l)}return new o.S(0,l)}function Ve(R){return Math.cos(R*Math.PI/180)}function dt(R,l){const m=Ve(R),w=Ve(l);return o.ak(w/m)}function Dt(R,l){const m=R.rotate(l.bearingInRadians),w=l.zoom+dt(l.center.lat,0),C=o.bk(1/Ve(l.center.lat),1/Ve(Math.min(Math.abs(l.center.lat),60)),o.bn(w,7,3,0,1)),N=360/lo({worldSize:l.worldSize,center:{lat:l.center.lat}});return new o.S(l.center.lng-m.x*N*C,o.ah(l.center.lat+m.y*N,-o.ai,o.ai))}function nr(R){const l=.5*R,m=Math.sin(l),w=Math.cos(l);return Math.log(m+w)-Math.log(w-m)}function Lr(R,l,m,w){const C=R.lat+m*w;if(Math.abs(m)>1){const N=(Math.sign(R.lat+m)!==Math.sign(R.lat)?-Math.abs(R.lat):Math.abs(R.lat))*Math.PI/180,j=Math.abs(R.lat+m)*Math.PI/180,Y=nr(N+w*(j-N)),te=nr(N),ue=nr(j);return new o.S(R.lng+l*((Y-te)/(ue-te)),C)}return new o.S(R.lng+l*w,C)}class Zr{constructor(l){this._cachePrevious=new Map,this._cache=new Map,this._hadAnyChanges=!1,this._boundingVolumeFactory=l}swapBuffers(){if(!this._hadAnyChanges)return;const l=this._cachePrevious;this._cachePrevious=this._cache,this._cache=l,this._cache.clear(),this._hadAnyChanges=!1}getTileBoundingVolume(l,m,w,C){const N=`${l.z}_${l.x}_${l.y}_${C?.terrain?"t":""}`,j=this._cache.get(N);if(j)return j;const Y=this._cachePrevious.get(N);if(Y)return this._cache.set(N,Y),Y;const te=this._boundingVolumeFactory(l,m,w,C);return this._cache.set(N,te),this._hadAnyChanges=!0,te}}class kn{constructor(l,m,w,C){this.min=w,this.max=C,this.points=l,this.planes=m}static fromAabb(l,m){const w=[];for(let C=0;C<8;C++)w.push([1&~C?l[0]:m[0],(C>>1&1)==1?m[1]:l[1],(C>>2&1)==1?m[2]:l[2]]);return new kn(w,[[-1,0,0,m[0]],[1,0,0,-l[0]],[0,-1,0,m[1]],[0,1,0,-l[1]],[0,0,-1,m[2]],[0,0,1,-l[2]]],l,m)}static fromCenterSizeAngles(l,m,w){const C=o.br([],w[0],w[1],w[2]),N=o.bs([],[m[0],0,0],C),j=o.bs([],[0,m[1],0],C),Y=o.bs([],[0,0,m[2]],C),te=[...l],ue=[...l];for(let Ce=0;Ce<8;Ce++)for(let Se=0;Se<3;Se++){const Fe=l[Se]+N[Se]*(1&~Ce?-1:1)+j[Se]*((Ce>>1&1)==1?1:-1)+Y[Se]*((Ce>>2&1)==1?1:-1);te[Se]=Math.min(te[Se],Fe),ue[Se]=Math.max(ue[Se],Fe)}const ge=[];for(let Ce=0;Ce<8;Ce++){const Se=[...l];o.aS(Se,Se,o.aR([],N,1&~Ce?-1:1)),o.aS(Se,Se,o.aR([],j,(Ce>>1&1)==1?1:-1)),o.aS(Se,Se,o.aR([],Y,(Ce>>2&1)==1?1:-1)),ge.push(Se)}return new kn(ge,[[...N,-o.aX(N,ge[0])],[...j,-o.aX(j,ge[0])],[...Y,-o.aX(Y,ge[0])],[-N[0],-N[1],-N[2],-o.aX(N,ge[7])],[-j[0],-j[1],-j[2],-o.aX(j,ge[7])],[-Y[0],-Y[1],-Y[2],-o.aX(Y,ge[7])]],te,ue)}intersectsFrustum(l){let m=!0;const w=this.points.length,C=this.planes.length,N=l.planes.length,j=l.points.length;for(let Y=0;Y<N;Y++){const te=l.planes[Y];let ue=0;for(let ge=0;ge<w;ge++){const Ce=this.points[ge];te[0]*Ce[0]+te[1]*Ce[1]+te[2]*Ce[2]+te[3]>=0&&ue++}if(ue===0)return 0;ue<w&&(m=!1)}if(m)return 2;for(let Y=0;Y<C;Y++){const te=this.planes[Y];let ue=0;for(let ge=0;ge<j;ge++){const Ce=l.points[ge];te[0]*Ce[0]+te[1]*Ce[1]+te[2]*Ce[2]+te[3]>=0&&ue++}if(ue===0)return 0}return 1}intersectsPlane(l){const m=this.points.length;let w=0;for(let C=0;C<m;C++){const N=this.points[C];l[0]*N[0]+l[1]*N[1]+l[2]*N[2]+l[3]>=0&&w++}return w===m?2:w===0?0:1}}function wn(R,l,m){const w=R-l;return w<0?-w:Math.max(0,w-m)}function ni(R,l,m,w,C){const N=R-m;let j;return j=N<0?Math.min(-N,1+N-C):N>1?Math.min(Math.max(N-C,0),1-N):0,Math.max(j,wn(l,w,C))}class oi{constructor(){this._boundingVolumeCache=new Zr(this._computeTileBoundingVolume)}prepareNextFrame(){this._boundingVolumeCache.swapBuffers()}distanceToTile2d(l,m,w,C){const N=1<<w.z,j=1/N,Y=w.x/N,te=w.y/N;let ue=2;return ue=Math.min(ue,ni(l,m,Y,te,j)),ue=Math.min(ue,ni(l,m,Y+.5,-te-j,j)),ue=Math.min(ue,ni(l,m,Y+.5,2-te-j,j)),ue}getWrap(l,m,w){const C=1<<m.z,N=1/C,j=m.x/C,Y=wn(l.x,j,N),te=wn(l.x,j-1,N),ue=wn(l.x,j+1,N),ge=Math.min(Y,te,ue);return ge===ue?1:ge===te?-1:0}allowVariableZoom(l,m){return Rr(l,m)>4}allowWorldCopies(){return!1}getTileBoundingVolume(l,m,w,C){return this._boundingVolumeCache.getTileBoundingVolume(l,m,w,C)}_computeTileBoundingVolume(l,m,w,C){var N,j;let Y=0,te=0;if(C?.terrain){const ue=new o.Z(l.z,m,l.z,l.x,l.y),ge=C.terrain.getMinMaxElevation(ue);Y=(N=ge.minElevation)!==null&&N!==void 0?N:Math.min(0,w),te=(j=ge.maxElevation)!==null&&j!==void 0?j:Math.max(0,w)}if(Y/=o.bu,te/=o.bu,Y+=1,te+=1,l.z<=0)return kn.fromAabb([-te,-te,-te],[te,te,te]);if(l.z===1)return kn.fromAabb([l.x===0?-te:0,l.y===0?0:-te,-te],[l.x===0?0:te,l.y===0?te:0,te]);{const ue=[uo(0,0,l.x,l.y,l.z),uo(o.$,0,l.x,l.y,l.z),uo(o.$,o.$,l.x,l.y,l.z),uo(0,o.$,l.x,l.y,l.z)],ge=[];for(const dr of ue)ge.push(o.aR([],dr,te));if(te!==Y)for(const dr of ue)ge.push(o.aR([],dr,Y));l.y===0&&ge.push([0,1,0]),l.y===(1<<l.z)-1&&ge.push([0,-1,0]);const Ce=[1,1,1],Se=[-1,-1,-1];for(const dr of ge)for(let mr=0;mr<3;mr++)Ce[mr]=Math.min(Ce[mr],dr[mr]),Se[mr]=Math.max(Se[mr],dr[mr]);const Fe=uo(o.$/2,o.$/2,l.x,l.y,l.z),Ge=o.aW([],[0,1,0],Fe);o.aV(Ge,Ge);const ut=o.aW([],Fe,Ge);o.aV(ut,ut);const lt=o.aW([],ue[2],ue[1]);o.aV(lt,lt);const ct=o.aW([],ue[0],ue[3]);o.aV(ct,ct),ge.push(o.aR([],Fe,te)),l.y>=(1<<l.z)/2&&ge.push(o.aR([],uo(o.$/2,0,l.x,l.y,l.z),te)),l.y<(1<<l.z)/2&&ge.push(o.aR([],uo(o.$/2,o.$,l.x,l.y,l.z),te));const xt=Ii(Fe,ge),Pt=Ii(ut,ge),Ct=[-Fe[0],-Fe[1],-Fe[2],xt.max],Ot=[Fe[0],Fe[1],Fe[2],-xt.min],Bt=[-ut[0],-ut[1],-ut[2],Pt.max],At=[ut[0],ut[1],ut[2],-Pt.min],qt=[...lt,0],Sr=[...ct,0],fr=[];return l.y===0?fr.push(o.bt(Sr,qt,Ct),o.bt(Sr,qt,Ot)):fr.push(o.bt(Bt,qt,Ct),o.bt(Bt,qt,Ot),o.bt(Bt,Sr,Ct),o.bt(Bt,Sr,Ot)),l.y===(1<<l.z)-1?fr.push(o.bt(Sr,qt,Ct),o.bt(Sr,qt,Ot)):fr.push(o.bt(At,qt,Ct),o.bt(At,qt,Ot),o.bt(At,Sr,Ct),o.bt(At,Sr,Ot)),new kn(fr,[Ct,Ot,Bt,At,qt,Sr],Ce,Se)}}}function Ii(R,l){let m=1/0,w=-1/0;for(const C of l){const N=o.aX(R,C);m=Math.min(m,N),w=Math.max(w,N)}return{min:m,max:w}}class $i{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(l){this._helper.setMinZoom(l)}setMaxZoom(l){this._helper.setMaxZoom(l)}setMinPitch(l){this._helper.setMinPitch(l)}setMaxPitch(l){this._helper.setMaxPitch(l)}setRenderWorldCopies(l){this._helper.setRenderWorldCopies(l)}setBearing(l){this._helper.setBearing(l)}setPitch(l){this._helper.setPitch(l)}setRoll(l){this._helper.setRoll(l)}setFov(l){this._helper.setFov(l)}setZoom(l){this._helper.setZoom(l)}setCenter(l){this._helper.setCenter(l)}setElevation(l){this._helper.setElevation(l)}setMinElevationForCurrentTile(l){this._helper.setMinElevationForCurrentTile(l)}setPadding(l){this._helper.setPadding(l)}interpolatePadding(l,m,w){return this._helper.interpolatePadding(l,m,w)}isPaddingEqual(l){return this._helper.isPaddingEqual(l)}resize(l,m){this._helper.resize(l,m)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(l){this._helper.setMaxBounds(l)}overrideNearFarZ(l,m){this._helper.overrideNearFarZ(l,m)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(l){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),l)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}setTransitionState(l){}constructor(){this._cachedClippingPlane=o.bv(),this._projectionMatrix=o.b9(),this._globeViewProjMatrix32f=o.b8(),this._globeViewProjMatrixNoCorrection=o.b9(),this._globeViewProjMatrixNoCorrectionInverted=o.b9(),this._globeProjMatrixInverted=o.b9(),this._cameraPosition=o.bp(),this._globeLatitudeErrorCorrectionRadians=0,this._helper=new En({calcMatrices:()=>{this._calcMatrices()},getConstrained:(l,m)=>this.getConstrained(l,m)}),this._coveringTilesDetailsProvider=new oi}clone(){const l=new $i;return l.apply(this),l}apply(l,m){this._globeLatitudeErrorCorrectionRadians=m||0,this._helper.apply(l)}get projectionMatrix(){return this._projectionMatrix}get modelViewProjectionMatrix(){return this._globeViewProjMatrixNoCorrection}get inverseProjectionMatrix(){return this._globeProjMatrixInverted}get cameraPosition(){const l=o.bp();return l[0]=this._cameraPosition[0],l[1]=this._cameraPosition[1],l[2]=this._cameraPosition[2],l}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}getProjectionData(l){const{overscaledTileID:m,applyGlobeMatrix:w}=l,C=this._helper.getMercatorTileCoordinates(m);return{mainMatrix:this._globeViewProjMatrix32f,tileMercatorCoords:C,clippingPlane:this._cachedClippingPlane,projectionTransition:w?1:0,fallbackMatrix:this._globeViewProjMatrix32f}}_computeClippingPlane(l){const m=this.pitchInRadians,w=this.cameraToCenterDistance/l,C=Math.sin(m)*w,N=Math.cos(m)*w+1,j=1/Math.sqrt(C*C+N*N)*1;let Y=-C,te=N;const ue=Math.sqrt(Y*Y+te*te);Y/=ue,te/=ue;const ge=[0,Y,te];o.bw(ge,ge,[0,0,0],-this.bearingInRadians),o.bx(ge,ge,[0,0,0],-1*this.center.lat*Math.PI/180),o.by(ge,ge,[0,0,0],this.center.lng*Math.PI/180);const Ce=1/o.aZ(ge);return o.aR(ge,ge,Ce),[...ge,-j*Ce]}isLocationOccluded(l){return!this.isSurfacePointVisible(na(l))}transformLightDirection(l){const m=this._helper._center.lng*Math.PI/180,w=this._helper._center.lat*Math.PI/180,C=Math.cos(w),N=[Math.sin(m)*C,Math.sin(w),Math.cos(m)*C],j=[N[2],0,-N[0]],Y=[0,0,0];o.aW(Y,j,N),o.aV(j,j),o.aV(Y,Y);const te=[0,0,0];return o.aV(te,[j[0]*l[0]+Y[0]*l[1]+N[0]*l[2],j[1]*l[0]+Y[1]*l[1]+N[1]*l[2],j[2]*l[0]+Y[2]*l[1]+N[2]*l[2]]),te}getPixelScale(){return 1/Math.cos(this._helper._center.lat*Math.PI/180)}getCircleRadiusCorrection(){return Math.cos(this._helper._center.lat*Math.PI/180)}getPitchedTextCorrection(l,m,w){const C=(function(Y,te,ue){const ge=1/(1<<ue.z);return new o.a1(Y/o.$*ge+ue.x*ge,te/o.$*ge+ue.y*ge)})(l,m,w.canonical),N=(j=C.y,[o.bo(C.x*Math.PI*2+Math.PI,2*Math.PI),2*Math.atan(Math.exp(Math.PI-j*Math.PI*2))-.5*Math.PI]);var j;return this.getCircleRadiusCorrection()/Math.cos(N[1])}projectTileCoordinates(l,m,w,C){const N=w.canonical,j=uo(l,m,N.x,N.y,N.z),Y=1+(C?C(l,m):0)/o.bu,te=[j[0]*Y,j[1]*Y,j[2]*Y,1];o.aw(te,te,this._globeViewProjMatrixNoCorrection);const ue=this._cachedClippingPlane,ge=ue[0]*j[0]+ue[1]*j[1]+ue[2]*j[2]+ue[3]<0;return{point:new o.P(te[0]/te[3],te[1]/te[3]),signedDistanceFromCamera:te[3],isOccluded:ge}}_calcMatrices(){if(!this._helper._width||!this._helper._height)return;const l=Da(this.worldSize,this.center.lat),m=o.ba(),w=o.ba();this._helper.autoCalculateNearFarZ&&(this._helper._nearZ=.5,this._helper._farZ=this.cameraToCenterDistance+2*l),o.b4(m,this.fovInRadians,this.width/this.height,this._helper._nearZ,this._helper._farZ);const C=this.centerOffset;m[8]=2*-C.x/this._helper._width,m[9]=2*C.y/this._helper._height,this._projectionMatrix=o.b5(m),this._globeProjMatrixInverted=o.ba(),o.aq(this._globeProjMatrixInverted,m),o.M(m,m,[0,0,-this.cameraToCenterDistance]),o.b6(m,m,this.rollInRadians),o.b7(m,m,-this.pitchInRadians),o.b6(m,m,this.bearingInRadians),o.M(m,m,[0,0,-l]);const N=o.bp();N[0]=l,N[1]=l,N[2]=l,o.b7(w,m,this.center.lat*Math.PI/180),o.bz(w,w,-this.center.lng*Math.PI/180),o.N(w,w,N),this._globeViewProjMatrixNoCorrection=w,o.b7(m,m,this.center.lat*Math.PI/180-this._globeLatitudeErrorCorrectionRadians),o.bz(m,m,-this.center.lng*Math.PI/180),o.N(m,m,N),this._globeViewProjMatrix32f=new Float32Array(m),this._globeViewProjMatrixNoCorrectionInverted=o.ba(),o.aq(this._globeViewProjMatrixNoCorrectionInverted,w);const j=o.bp();this._cameraPosition=o.bp(),this._cameraPosition[2]=this.cameraToCenterDistance/l,o.bw(this._cameraPosition,this._cameraPosition,j,-this.rollInRadians),o.bx(this._cameraPosition,this._cameraPosition,j,this.pitchInRadians),o.bw(this._cameraPosition,this._cameraPosition,j,-this.bearingInRadians),o.aS(this._cameraPosition,this._cameraPosition,[0,0,1]),o.bx(this._cameraPosition,this._cameraPosition,j,-this.center.lat*Math.PI/180),o.by(this._cameraPosition,this._cameraPosition,j,this.center.lng*Math.PI/180),this._cachedClippingPlane=this._computeClippingPlane(l);const Y=o.b5(this._globeViewProjMatrixNoCorrectionInverted);o.N(Y,Y,[1,1,-1]),this._cachedFrustum=cn.fromInvProjectionMatrix(Y,1,0,this._cachedClippingPlane,!0)}calculateFogMatrix(l){o.w("calculateFogMatrix is not supported on globe projection.");const m=o.ba();return o.ag(m),m}getVisibleUnwrappedCoordinates(l){return[new o.b2(0,l)]}getCameraFrustum(){return this._cachedFrustum}getClippingPlane(){return this._cachedClippingPlane}getCoveringTilesDetailsProvider(){return this._coveringTilesDetailsProvider}recalculateZoomAndCenter(l){l&&o.w("terrain is not fully supported on vertical perspective projection."),this._helper.recalculateZoomAndCenter(0)}maxPitchScaleFactor(){return 1}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){return this._helper.getCameraLngLat()}lngLatToCameraDepth(l,m){if(!this._globeViewProjMatrixNoCorrection)return 1;const w=na(l);o.aR(w,w,1+m/o.bu);const C=o.bv();return o.aw(C,[w[0],w[1],w[2],1],this._globeViewProjMatrixNoCorrection),C[2]/C[3]}populateCache(l){}getBounds(){const l=.5*this.width,m=.5*this.height,w=[new o.P(0,0),new o.P(l,0),new o.P(this.width,0),new o.P(this.width,m),new o.P(this.width,this.height),new o.P(l,this.height),new o.P(0,this.height),new o.P(0,m)],C=[];for(const Ce of w)C.push(this.unprojectScreenPoint(Ce));let N=0,j=0,Y=0,te=0;const ue=this.center;for(const Ce of C){const Se=o.bA(ue.lng,Ce.lng),Fe=o.bA(ue.lat,Ce.lat);Se<j&&(j=Se),Se>N&&(N=Se),Fe<te&&(te=Fe),Fe>Y&&(Y=Fe)}const ge=[ue.lng+j,ue.lat+te,ue.lng+N,ue.lat+Y];return this.isSurfacePointOnScreen([0,1,0])&&(ge[3]=90,ge[0]=-180,ge[2]=180),this.isSurfacePointOnScreen([0,-1,0])&&(ge[1]=-90,ge[0]=-180,ge[2]=180),new Mt(ge)}getConstrained(l,m){const w=o.ah(l.lat,-o.ai,o.ai),C=o.ah(+m,this.minZoom+dt(0,w),this.maxZoom);return{center:new o.S(l.lng,w),zoom:C}}calculateCenterFromCameraLngLatAlt(l,m,w,C){return this._helper.calculateCenterFromCameraLngLatAlt(l,m,w,C)}setLocationAtPoint(l,m){const w=na(this.unprojectScreenPoint(m)),C=na(l),N=o.bp();o.bB(N);const j=o.bp();o.by(j,w,N,-this.center.lng*Math.PI/180),o.bx(j,j,N,this.center.lat*Math.PI/180);const Y=C[0]*C[0]+C[2]*C[2],te=j[0]*j[0];if(Y<te)return;const ue=Math.sqrt(Y-te),ge=-ue,Ce=o.bC(C[0],C[2],j[0],ue),Se=o.bC(C[0],C[2],j[0],ge),Fe=o.bp();o.by(Fe,C,N,-Ce);const Ge=o.bC(Fe[1],Fe[2],j[1],j[2]),ut=o.bp();o.by(ut,C,N,-Se);const lt=o.bC(ut[1],ut[2],j[1],j[2]),ct=.5*Math.PI,xt=Ge>=-ct&&Ge<=ct,Pt=lt>=-ct&&lt<=ct;let Ct,Ot;if(xt&&Pt){const Sr=this.center.lng*Math.PI/180,fr=this.center.lat*Math.PI/180;o.bD(Ce,Sr)+o.bD(Ge,fr)<o.bD(Se,Sr)+o.bD(lt,fr)?(Ct=Ce,Ot=Ge):(Ct=Se,Ot=lt)}else if(xt)Ct=Ce,Ot=Ge;else{if(!Pt)return;Ct=Se,Ot=lt}const Bt=Ct/Math.PI*180,At=Ot/Math.PI*180,qt=this.center.lat;this.setCenter(new o.S(Bt,o.ah(At,-90,90))),this.setZoom(this.zoom+dt(qt,this.center.lat))}locationToScreenPoint(l,m){const w=na(l);if(m){const C=m.getElevationForLngLatZoom(l,this._helper._tileZoom);o.aR(w,w,1+C/o.bu)}return this._projectSurfacePointToScreen(w)}_projectSurfacePointToScreen(l){const m=o.bv();return o.aw(m,[...l,1],this._globeViewProjMatrixNoCorrection),m[0]/=m[3],m[1]/=m[3],new o.P((.5*m[0]+.5)*this.width,(.5*-m[1]+.5)*this.height)}screenPointToMercatorCoordinate(l,m){if(m){const w=m.pointCoordinate(l);if(w)return w}return o.a1.fromLngLat(this.unprojectScreenPoint(l))}screenPointToLocation(l,m){var w;return(w=this.screenPointToMercatorCoordinate(l,m))===null||w===void 0?void 0:w.toLngLat()}isPointOnMapSurface(l,m){const w=this._cameraPosition,C=this.getRayDirectionFromPixel(l);return!!this.rayPlanetIntersection(w,C)}getRayDirectionFromPixel(l){const m=o.bv();m[0]=l.x/this.width*2-1,m[1]=-1*(l.y/this.height*2-1),m[2]=1,m[3]=1,o.aw(m,m,this._globeViewProjMatrixNoCorrectionInverted),m[0]/=m[3],m[1]/=m[3],m[2]/=m[3];const w=o.bp();w[0]=m[0]-this._cameraPosition[0],w[1]=m[1]-this._cameraPosition[1],w[2]=m[2]-this._cameraPosition[2];const C=o.bp();return o.aV(C,w),C}isSurfacePointVisible(l){const m=this._cachedClippingPlane;return m[0]*l[0]+m[1]*l[1]+m[2]*l[2]+m[3]>=0}isSurfacePointOnScreen(l){if(!this.isSurfacePointVisible(l))return!1;const m=o.bv();return o.aw(m,[...l,1],this._globeViewProjMatrixNoCorrection),m[0]/=m[3],m[1]/=m[3],m[2]/=m[3],m[0]>-1&&m[0]<1&&m[1]>-1&&m[1]<1&&m[2]>-1&&m[2]<1}rayPlanetIntersection(l,m){const w=o.aX(l,m),C=o.bp(),N=o.bp();o.aR(N,m,w),o.aU(C,l,N);const j=1-o.aX(C,C);if(j<0)return null;const Y=o.aX(l,l)-1,te=-w+(w<0?1:-1)*Math.sqrt(j),ue=Y/te,ge=te;return{tMin:Math.min(ue,ge),tMax:Math.max(ue,ge)}}unprojectScreenPoint(l){const m=this._cameraPosition,w=this.getRayDirectionFromPixel(l),C=this.rayPlanetIntersection(m,w);if(C){const ge=o.bp();o.aS(ge,m,[w[0]*C.tMin,w[1]*C.tMin,w[2]*C.tMin]);const Ce=o.bp();return o.aV(Ce,ge),le(Ce)}const N=this._cachedClippingPlane,j=N[0]*w[0]+N[1]*w[1]+N[2]*w[2],Y=-o.b1(N,m)/j,te=o.bp();if(Y>0)o.aS(te,m,[w[0]*Y,w[1]*Y,w[2]*Y]);else{const ge=o.bp();o.aS(ge,m,[2*w[0],2*w[1],2*w[2]]);const Ce=o.b1(this._cachedClippingPlane,ge);o.aU(te,ge,[this._cachedClippingPlane[0]*Ce,this._cachedClippingPlane[1]*Ce,this._cachedClippingPlane[2]*Ce])}const ue=(function(ge){const Ce=o.bp();return Ce[0]=ge[0]*-ge[3],Ce[1]=ge[1]*-ge[3],Ce[2]=ge[2]*-ge[3],{center:Ce,radius:Math.sqrt(1-ge[3]*ge[3])}})(N);return le((function(ge,Ce,Se){const Fe=o.bp();o.aU(Fe,Se,ge);const Ge=o.bp();return o.bq(Ge,ge,Fe,Ce/o.a$(Fe)),Ge})(ue.center,ue.radius,te))}getMatrixForModel(l,m){const w=o.S.convert(l),C=1/o.bu,N=o.b9();return o.bz(N,N,w.lng/180*Math.PI),o.b7(N,N,-w.lat/180*Math.PI),o.M(N,N,[0,0,1+m/o.bu]),o.b7(N,N,.5*Math.PI),o.N(N,N,[C,C,C]),N}getProjectionDataForCustomLayer(l=!0){const m=this.getProjectionData({overscaledTileID:new o.Z(0,0,0,0,0),applyGlobeMatrix:l});return m.tileMercatorCoords=[0,0,1,1],m}getFastPathSimpleProjectionMatrix(l){}}class Bi{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(l){this._helper.setMinZoom(l)}setMaxZoom(l){this._helper.setMaxZoom(l)}setMinPitch(l){this._helper.setMinPitch(l)}setMaxPitch(l){this._helper.setMaxPitch(l)}setRenderWorldCopies(l){this._helper.setRenderWorldCopies(l)}setBearing(l){this._helper.setBearing(l)}setPitch(l){this._helper.setPitch(l)}setRoll(l){this._helper.setRoll(l)}setFov(l){this._helper.setFov(l)}setZoom(l){this._helper.setZoom(l)}setCenter(l){this._helper.setCenter(l)}setElevation(l){this._helper.setElevation(l)}setMinElevationForCurrentTile(l){this._helper.setMinElevationForCurrentTile(l)}setPadding(l){this._helper.setPadding(l)}interpolatePadding(l,m,w){return this._helper.interpolatePadding(l,m,w)}isPaddingEqual(l){return this._helper.isPaddingEqual(l)}resize(l,m,w=!0){this._helper.resize(l,m,w)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(l){this._helper.setMaxBounds(l)}overrideNearFarZ(l,m){this._helper.overrideNearFarZ(l,m)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(l){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),l)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}get isGlobeRendering(){return this._globeness>0}setTransitionState(l,m){this._globeness=l,this._globeLatitudeErrorCorrectionRadians=m,this._calcMatrices(),this._verticalPerspectiveTransform.getCoveringTilesDetailsProvider().prepareNextFrame(),this._mercatorTransform.getCoveringTilesDetailsProvider().prepareNextFrame()}get currentTransform(){return this.isGlobeRendering?this._verticalPerspectiveTransform:this._mercatorTransform}constructor(){this._globeLatitudeErrorCorrectionRadians=0,this._globeness=1,this._helper=new En({calcMatrices:()=>{this._calcMatrices()},getConstrained:(l,m)=>this.getConstrained(l,m)}),this._globeness=1,this._mercatorTransform=new Wn,this._verticalPerspectiveTransform=new $i}clone(){const l=new Bi;return l._globeness=this._globeness,l._globeLatitudeErrorCorrectionRadians=this._globeLatitudeErrorCorrectionRadians,l.apply(this),l}apply(l){this._helper.apply(l),this._mercatorTransform.apply(this),this._verticalPerspectiveTransform.apply(this,this._globeLatitudeErrorCorrectionRadians)}get projectionMatrix(){return this.currentTransform.projectionMatrix}get modelViewProjectionMatrix(){return this.currentTransform.modelViewProjectionMatrix}get inverseProjectionMatrix(){return this.currentTransform.inverseProjectionMatrix}get cameraPosition(){return this.currentTransform.cameraPosition}getProjectionData(l){const m=this._mercatorTransform.getProjectionData(l),w=this._verticalPerspectiveTransform.getProjectionData(l);return{mainMatrix:this.isGlobeRendering?w.mainMatrix:m.mainMatrix,clippingPlane:w.clippingPlane,tileMercatorCoords:w.tileMercatorCoords,projectionTransition:l.applyGlobeMatrix?this._globeness:0,fallbackMatrix:m.fallbackMatrix}}isLocationOccluded(l){return this.currentTransform.isLocationOccluded(l)}transformLightDirection(l){return this.currentTransform.transformLightDirection(l)}getPixelScale(){return o.bk(this._mercatorTransform.getPixelScale(),this._verticalPerspectiveTransform.getPixelScale(),this._globeness)}getCircleRadiusCorrection(){return o.bk(this._mercatorTransform.getCircleRadiusCorrection(),this._verticalPerspectiveTransform.getCircleRadiusCorrection(),this._globeness)}getPitchedTextCorrection(l,m,w){const C=this._mercatorTransform.getPitchedTextCorrection(l,m,w),N=this._verticalPerspectiveTransform.getPitchedTextCorrection(l,m,w);return o.bk(C,N,this._globeness)}projectTileCoordinates(l,m,w,C){return this.currentTransform.projectTileCoordinates(l,m,w,C)}_calcMatrices(){this._helper._width&&this._helper._height&&(this._verticalPerspectiveTransform.apply(this,this._globeLatitudeErrorCorrectionRadians),this._helper._nearZ=this._verticalPerspectiveTransform.nearZ,this._helper._farZ=this._verticalPerspectiveTransform.farZ,this._mercatorTransform.apply(this,!0,this.isGlobeRendering),this._helper._nearZ=this._mercatorTransform.nearZ,this._helper._farZ=this._mercatorTransform.farZ)}calculateFogMatrix(l){return this.currentTransform.calculateFogMatrix(l)}getVisibleUnwrappedCoordinates(l){return this.currentTransform.getVisibleUnwrappedCoordinates(l)}getCameraFrustum(){return this.currentTransform.getCameraFrustum()}getClippingPlane(){return this.currentTransform.getClippingPlane()}getCoveringTilesDetailsProvider(){return this.currentTransform.getCoveringTilesDetailsProvider()}recalculateZoomAndCenter(l){this._mercatorTransform.recalculateZoomAndCenter(l),this._verticalPerspectiveTransform.recalculateZoomAndCenter(l)}maxPitchScaleFactor(){return this._mercatorTransform.maxPitchScaleFactor()}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){return this._helper.getCameraLngLat()}lngLatToCameraDepth(l,m){return this.currentTransform.lngLatToCameraDepth(l,m)}populateCache(l){this._mercatorTransform.populateCache(l),this._verticalPerspectiveTransform.populateCache(l)}getBounds(){return this.currentTransform.getBounds()}getConstrained(l,m){return this.currentTransform.getConstrained(l,m)}calculateCenterFromCameraLngLatAlt(l,m,w,C){return this._helper.calculateCenterFromCameraLngLatAlt(l,m,w,C)}setLocationAtPoint(l,m){if(!this.isGlobeRendering)return this._mercatorTransform.setLocationAtPoint(l,m),void this.apply(this._mercatorTransform);this._verticalPerspectiveTransform.setLocationAtPoint(l,m),this.apply(this._verticalPerspectiveTransform)}locationToScreenPoint(l,m){return this.currentTransform.locationToScreenPoint(l,m)}screenPointToMercatorCoordinate(l,m){return this.currentTransform.screenPointToMercatorCoordinate(l,m)}screenPointToLocation(l,m){return this.currentTransform.screenPointToLocation(l,m)}isPointOnMapSurface(l,m){return this.currentTransform.isPointOnMapSurface(l,m)}getRayDirectionFromPixel(l){return this._verticalPerspectiveTransform.getRayDirectionFromPixel(l)}getMatrixForModel(l,m){return this.currentTransform.getMatrixForModel(l,m)}getProjectionDataForCustomLayer(l=!0){const m=this._mercatorTransform.getProjectionDataForCustomLayer(l);if(!this.isGlobeRendering)return m;const w=this._verticalPerspectiveTransform.getProjectionDataForCustomLayer(l);return w.fallbackMatrix=m.mainMatrix,w}getFastPathSimpleProjectionMatrix(l){return this.currentTransform.getFastPathSimpleProjectionMatrix(l)}}class Ti{get useGlobeControls(){return!0}handlePanInertia(l,m){const w=Dt(l,m);return Math.abs(w.lng-m.center.lng)>180&&(w.lng=m.center.lng+179.5*Math.sign(w.lng-m.center.lng)),{easingCenter:w,easingOffset:new o.P(0,0)}}handleMapControlsRollPitchBearingZoom(l,m){const w=l.around,C=m.screenPointToLocation(w);l.bearingDelta&&m.setBearing(m.bearing+l.bearingDelta),l.pitchDelta&&m.setPitch(m.pitch+l.pitchDelta),l.rollDelta&&m.setRoll(m.roll+l.rollDelta);const N=m.zoom;l.zoomDelta&&m.setZoom(m.zoom+l.zoomDelta);const j=m.zoom-N;if(j===0)return;const Y=o.bA(m.center.lng,C.lng),te=Y/(Math.abs(Y/180)+1),ue=o.bA(m.center.lat,C.lat),ge=m.getRayDirectionFromPixel(w),Ce=m.cameraPosition,Se=-1*o.aX(Ce,ge),Fe=o.bp();o.aS(Fe,Ce,[ge[0]*Se,ge[1]*Se,ge[2]*Se]);const Ge=o.aZ(Fe)-1,ut=Math.exp(.5*-Math.max(Ge-.3,0)),lt=Da(m.worldSize,m.center.lat)/Math.min(m.width,m.height),ct=o.bn(lt,.9,.5,1,.25),xt=(1-o.af(-j))*Math.min(ut,ct),Pt=m.center.lat,Ct=m.zoom,Ot=new o.S(m.center.lng+te*xt,o.ah(m.center.lat+ue*xt,-o.ai,o.ai));m.setLocationAtPoint(C,w);const Bt=m.center,At=o.bn(Math.abs(Y),45,85,0,1),qt=o.bn(lt,.75,.35,0,1),Sr=Math.pow(Math.max(At,qt),.25),fr=o.bA(Bt.lng,Ot.lng),dr=o.bA(Bt.lat,Ot.lat);m.setCenter(new o.S(Bt.lng+fr*Sr,Bt.lat+dr*Sr).wrap()),m.setZoom(Ct+dt(Pt,m.center.lat))}handleMapControlsPan(l,m,w){if(!l.panDelta)return;const C=m.center.lat,N=m.zoom;m.setCenter(Dt(l.panDelta,m).wrap()),m.setZoom(N+dt(C,m.center.lat))}cameraForBoxAndBearing(l,m,w,C,N){const j=Ra(l,m,w,C,N),Y=m.left/N.width*2-1,te=(N.width-m.right)/N.width*2-1,ue=m.top/N.height*-2+1,ge=(N.height-m.bottom)/N.height*-2+1,Ce=o.bA(w.getWest(),w.getEast())<0,Se=Ce?w.getEast():w.getWest(),Fe=Ce?w.getWest():w.getEast(),Ge=Math.max(w.getNorth(),w.getSouth()),ut=Math.min(w.getNorth(),w.getSouth()),lt=Se+.5*o.bA(Se,Fe),ct=Ge+.5*o.bA(Ge,ut),xt=N.clone();xt.setCenter(j.center),xt.setBearing(j.bearing),xt.setPitch(0),xt.setRoll(0),xt.setZoom(j.zoom);const Pt=xt.modelViewProjectionMatrix,Ct=[na(w.getNorthWest()),na(w.getNorthEast()),na(w.getSouthWest()),na(w.getSouthEast()),na(new o.S(Fe,ct)),na(new o.S(Se,ct)),na(new o.S(lt,Ge)),na(new o.S(lt,ut))],Ot=na(j.center);let Bt=Number.POSITIVE_INFINITY;for(const At of Ct)Y<0&&(Bt=Ti.getLesserNonNegativeNonNull(Bt,Ti.solveVectorScale(At,Ot,Pt,"x",Y))),te>0&&(Bt=Ti.getLesserNonNegativeNonNull(Bt,Ti.solveVectorScale(At,Ot,Pt,"x",te))),ue>0&&(Bt=Ti.getLesserNonNegativeNonNull(Bt,Ti.solveVectorScale(At,Ot,Pt,"y",ue))),ge<0&&(Bt=Ti.getLesserNonNegativeNonNull(Bt,Ti.solveVectorScale(At,Ot,Pt,"y",ge)));if(Number.isFinite(Bt)&&Bt!==0)return j.zoom=xt.zoom+o.ak(Bt),j;Ma()}handleJumpToCenterZoom(l,m){const w=l.center.lat,C=l.getConstrained(m.center?o.S.convert(m.center):l.center,l.zoom).center;l.setCenter(C.wrap());const N=m.zoom!==void 0?+m.zoom:l.zoom+dt(w,C.lat);l.zoom!==N&&l.setZoom(N)}handleEaseTo(l,m){const w=l.zoom,C=l.center,N=l.padding,j={roll:l.roll,pitch:l.pitch,bearing:l.bearing},Y={roll:m.roll===void 0?l.roll:m.roll,pitch:m.pitch===void 0?l.pitch:m.pitch,bearing:m.bearing===void 0?l.bearing:m.bearing},te=m.zoom!==void 0,ue=!l.isPaddingEqual(m.padding);let ge=!1;const Ce=m.center?o.S.convert(m.center):C,Se=l.getConstrained(Ce,w).center;Qn(l,Se);const Fe=l.clone();Fe.setCenter(Se),Fe.setZoom(te?+m.zoom:w+dt(C.lat,Ce.lat)),Fe.setBearing(m.bearing);const Ge=new o.P(o.ah(l.centerPoint.x+m.offsetAsPoint.x,0,l.width),o.ah(l.centerPoint.y+m.offsetAsPoint.y,0,l.height));Fe.setLocationAtPoint(Se,Ge);const ut=(m.offset&&m.offsetAsPoint.mag())>0?Fe.center:Se,lt=te?+m.zoom:w+dt(C.lat,ut.lat),ct=w+dt(C.lat,0),xt=lt+dt(ut.lat,0),Pt=o.bA(C.lng,ut.lng),Ct=o.bA(C.lat,ut.lat),Ot=o.af(xt-ct);return ge=lt!==w,{easeFunc:Bt=>{if(o.be(j,Y)||Ci({startEulerAngles:j,endEulerAngles:Y,tr:l,k:Bt,useSlerp:j.roll!=Y.roll}),ue&&l.interpolatePadding(N,m.padding,Bt),m.around)o.w("Easing around a point is not supported under globe projection."),l.setLocationAtPoint(m.around,m.aroundPoint);else{const At=xt>ct?Math.min(2,Ot):Math.max(.5,Ot),qt=Math.pow(At,1-Bt),Sr=Lr(C,Pt,Ct,Bt*qt);l.setCenter(Sr.wrap())}if(ge){const At=o.C.number(ct,xt,Bt)+dt(0,l.center.lat);l.setZoom(At)}},isZooming:ge,elevationCenter:ut}}handleFlyTo(l,m){const w=m.zoom!==void 0,C=l.center,N=l.zoom,j=l.padding,Y=!l.isPaddingEqual(m.padding),te=l.getConstrained(o.S.convert(m.center||m.locationAtOffset),N).center,ue=w?+m.zoom:l.zoom+dt(l.center.lat,te.lat),ge=l.clone();ge.setCenter(te),ge.setZoom(ue),ge.setBearing(m.bearing);const Ce=new o.P(o.ah(l.centerPoint.x+m.offsetAsPoint.x,0,l.width),o.ah(l.centerPoint.y+m.offsetAsPoint.y,0,l.height));ge.setLocationAtPoint(te,Ce);const Se=ge.center;Qn(l,Se);const Fe=(function(Ct,Ot,Bt){const At=na(Ot),qt=na(Bt),Sr=o.aX(At,qt),fr=Math.acos(Sr),dr=lo(Ct);return fr/(2*Math.PI)*dr})(l,C,Se),Ge=N+dt(C.lat,0),ut=ue+dt(Se.lat,0),lt=o.af(ut-Ge);let ct;if(typeof m.minZoom=="number"){const Ct=+m.minZoom+dt(Se.lat,0),Ot=Math.min(Ct,Ge,ut)+dt(0,Se.lat),Bt=l.getConstrained(Se,Ot).zoom+dt(Se.lat,0);ct=o.af(Bt-Ge)}const xt=o.bA(C.lng,Se.lng),Pt=o.bA(C.lat,Se.lat);return{easeFunc:(Ct,Ot,Bt,At)=>{const qt=Lr(C,xt,Pt,Bt);Y&&l.interpolatePadding(j,m.padding,Ct);const Sr=Ct===1?Se:qt;l.setCenter(Sr.wrap());const fr=Ge+o.ak(Ot);l.setZoom(Ct===1?ue:fr+dt(0,Sr.lat))},scaleOfZoom:lt,targetCenter:Se,scaleOfMinZoom:ct,pixelPathLength:Fe}}static solveVectorScale(l,m,w,C,N){const j=C==="x"?[w[0],w[4],w[8],w[12]]:[w[1],w[5],w[9],w[13]],Y=[w[3],w[7],w[11],w[15]],te=l[0]*j[0]+l[1]*j[1]+l[2]*j[2],ue=l[0]*Y[0]+l[1]*Y[1]+l[2]*Y[2],ge=m[0]*j[0]+m[1]*j[1]+m[2]*j[2],Ce=m[0]*Y[0]+m[1]*Y[1]+m[2]*Y[2];return ge+N*ue===te+N*Ce||Y[3]*(te-ge)+j[3]*(Ce-ue)+te*Ce==ge*ue?null:(ge+j[3]-N*Ce-N*Y[3])/(ge-te-N*Ce+N*ue)}static getLesserNonNegativeNonNull(l,m){return m!==null&&m>=0&&m<l?m:l}}class Fa{constructor(l){this._globe=l,this._mercatorCameraHelper=new gi,this._verticalPerspectiveCameraHelper=new Ti}get useGlobeControls(){return this._globe.useGlobeRendering}get currentHelper(){return this.useGlobeControls?this._verticalPerspectiveCameraHelper:this._mercatorCameraHelper}handlePanInertia(l,m){return this.currentHelper.handlePanInertia(l,m)}handleMapControlsRollPitchBearingZoom(l,m){return this.currentHelper.handleMapControlsRollPitchBearingZoom(l,m)}handleMapControlsPan(l,m,w){this.currentHelper.handleMapControlsPan(l,m,w)}cameraForBoxAndBearing(l,m,w,C,N){return this.currentHelper.cameraForBoxAndBearing(l,m,w,C,N)}handleJumpToCenterZoom(l,m){this.currentHelper.handleJumpToCenterZoom(l,m)}handleEaseTo(l,m){return this.currentHelper.handleEaseTo(l,m)}handleFlyTo(l,m){return this.currentHelper.handleFlyTo(l,m)}}const fa=(R,l)=>o.y(R,l&&l.filter((m=>m.identifier!=="source.canvas"))),Qa=o.bE();class bs extends o.E{constructor(l,m={}){var w,C;super(),this._rtlPluginLoaded=()=>{for(const j in this.sourceCaches){const Y=this.sourceCaches[j].getSource().type;Y!=="vector"&&Y!=="geojson"||this.sourceCaches[j].reload()}},this.map=l,this.dispatcher=new Oe(Ne(),l._getMapId()),this.dispatcher.registerMessageHandler("GG",((j,Y)=>this.getGlyphs(j,Y))),this.dispatcher.registerMessageHandler("GI",((j,Y)=>this.getImages(j,Y))),this.imageManager=new G,this.imageManager.setEventedParent(this);const N=((w=l._container)===null||w===void 0?void 0:w.lang)||typeof document<"u"&&((C=document.documentElement)===null||C===void 0?void 0:C.lang)||void 0;this.glyphManager=new ne(l._requestManager,m.localIdeographFontFamily,N),this.lineAtlas=new we(256,512),this.crossTileSymbolIndex=new Xe,this._spritesImagesIds={},this._layers={},this._order=[],this.sourceCaches={},this.zoomHistory=new o.bF,this._loaded=!1,this._availableImages=[],this._globalState={},this._resetUpdates(),this.dispatcher.broadcast("SR",o.bG()),Ar().on(wr,this._rtlPluginLoaded),this.on("data",(j=>{if(j.dataType!=="source"||j.sourceDataType!=="metadata")return;const Y=this.sourceCaches[j.sourceId];if(!Y)return;const te=Y.getSource();if(te&&te.vectorLayerIds)for(const ue in this._layers){const ge=this._layers[ue];ge.source===te.id&&this._validateLayer(ge)}}))}setGlobalStateProperty(l,m){var w,C,N;this._checkLoaded();const j=m===null?(N=(C=(w=this.stylesheet.state)===null||w===void 0?void 0:w[l])===null||C===void 0?void 0:C.default)!==null&&N!==void 0?N:null:m;if(o.bH(j,this._globalState[l]))return this;this._globalState[l]=j,this._applyGlobalStateChanges([l])}getGlobalState(){return this._globalState}setGlobalState(l){this._checkLoaded();const m=[];for(const w in l)!o.bH(this._globalState[w],l[w].default)&&(m.push(w),this._globalState[w]=l[w].default);this._applyGlobalStateChanges(m)}_applyGlobalStateChanges(l){if(l.length===0)return;const m=new Set;for(const w in this._layers){const C=this._layers[w],N=C.getLayoutAffectingGlobalStateRefs(),j=C.getPaintAffectingGlobalStateRefs();for(const Y of l)if(N.has(Y)&&m.add(C.source),j.has(Y))for(const{name:te,value:ue}of j.get(Y))this._updatePaintProperty(C,te,ue)}for(const w in this.sourceCaches)m.has(w)&&(this._reloadSource(w),this._changed=!0)}loadURL(l,m={},w){this.fire(new o.l("dataloading",{dataType:"style"})),m.validate=typeof m.validate!="boolean"||m.validate;const C=this.map._requestManager.transformRequest(l,"Style");this._loadStyleRequest=new AbortController;const N=this._loadStyleRequest;o.j(C,this._loadStyleRequest).then((j=>{this._loadStyleRequest=null,this._load(j.data,m,w)})).catch((j=>{this._loadStyleRequest=null,j&&!N.signal.aborted&&this.fire(new o.k(j))}))}loadJSON(l,m={},w){this.fire(new o.l("dataloading",{dataType:"style"})),this._frameRequest=new AbortController,b.frameAsync(this._frameRequest).then((()=>{this._frameRequest=null,m.validate=m.validate!==!1,this._load(l,m,w)})).catch((()=>{}))}loadEmpty(){this.fire(new o.l("dataloading",{dataType:"style"})),this._load(Qa,{validate:!1})}_load(l,m,w){var C,N;let j=m.transformStyle?m.transformStyle(w,l):l;if(!m.validate||!fa(this,o.z(j))){j=Object.assign({},j),this._loaded=!0,this.stylesheet=j;for(const Y in j.sources)this.addSource(Y,j.sources[Y],{validate:!1});j.sprite?this._loadSprite(j.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(j.glyphs),this._createLayers(),this.light=new fe(this.stylesheet.light),this._setProjectionInternal(((C=this.stylesheet.projection)===null||C===void 0?void 0:C.type)||"mercator"),this.sky=new me(this.stylesheet.sky),this.map.setTerrain((N=this.stylesheet.terrain)!==null&&N!==void 0?N:null),this.fire(new o.l("data",{dataType:"style"})),this.fire(new o.l("style.load"))}}_createLayers(){var l;const m=o.bI(this.stylesheet.layers);this.dispatcher.broadcast("SL",m),this._order=m.map((w=>w.id)),this._layers={},this.setGlobalState((l=this.stylesheet.state)!==null&&l!==void 0?l:null),this._serializedLayers=null;for(const w of m){const C=o.bJ(w);C.setEventedParent(this,{layer:{id:w.id}}),C.setGlobalState(this._globalState),this._layers[w.id]=C}}_loadSprite(l,m=!1,w=void 0){let C;this.imageManager.setLoaded(!1),this._spriteRequest=new AbortController,(function(N,j,Y,te){return o._(this,void 0,void 0,(function*(){const ue=B(N),ge=Y>1?"@2x":"",Ce={},Se={};for(const{id:Fe,url:Ge}of ue){const ut=j.transformRequest(q(Ge,ge,".json"),"SpriteJSON");Ce[Fe]=o.j(ut,te);const lt=j.transformRequest(q(Ge,ge,".png"),"SpriteImage");Se[Fe]=M.getImage(lt,te)}return yield Promise.all([...Object.values(Ce),...Object.values(Se)]),(function(Fe,Ge){return o._(this,void 0,void 0,(function*(){const ut={};for(const lt in Fe){ut[lt]={};const ct=b.getImageCanvasContext((yield Ge[lt]).data),xt=(yield Fe[lt]).data;for(const Pt in xt){const{width:Ct,height:Ot,x:Bt,y:At,sdf:qt,pixelRatio:Sr,stretchX:fr,stretchY:dr,content:mr,textFitWidth:tn,textFitHeight:nn}=xt[Pt];ut[lt][Pt]={data:null,pixelRatio:Sr,sdf:qt,stretchX:fr,stretchY:dr,content:mr,textFitWidth:tn,textFitHeight:nn,spriteData:{width:Ct,height:Ot,x:Bt,y:At,context:ct}}}}return ut}))})(Ce,Se)}))})(l,this.map._requestManager,this.map.getPixelRatio(),this._spriteRequest).then((N=>{if(this._spriteRequest=null,N)for(const j in N){this._spritesImagesIds[j]=[];const Y=this._spritesImagesIds[j]?this._spritesImagesIds[j].filter((te=>!(te in N))):[];for(const te of Y)this.imageManager.removeImage(te),this._changedImages[te]=!0;for(const te in N[j]){const ue=j==="default"?te:`${j}:${te}`;this._spritesImagesIds[j].push(ue),ue in this.imageManager.images?this.imageManager.updateImage(ue,N[j][te],!1):this.imageManager.addImage(ue,N[j][te]),m&&(this._changedImages[ue]=!0)}}})).catch((N=>{this._spriteRequest=null,C=N,this.fire(new o.k(C))})).finally((()=>{this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),m&&(this._changed=!0),this.dispatcher.broadcast("SI",this._availableImages),this.fire(new o.l("data",{dataType:"style"})),w&&w(C)}))}_unloadSprite(){for(const l of Object.values(this._spritesImagesIds).flat())this.imageManager.removeImage(l),this._changedImages[l]=!0;this._spritesImagesIds={},this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new o.l("data",{dataType:"style"}))}_validateLayer(l){const m=this.sourceCaches[l.source];if(!m)return;const w=l.sourceLayer;if(!w)return;const C=m.getSource();(C.type==="geojson"||C.vectorLayerIds&&C.vectorLayerIds.indexOf(w)===-1)&&this.fire(new o.k(new Error(`Source layer "${w}" does not exist on source "${C.id}" as specified by style layer "${l.id}".`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const l in this.sourceCaches)if(!this.sourceCaches[l].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeByIds(l,m=!1){const w=this._serializedAllLayers();if(!l||l.length===0)return Object.values(m?o.bK(w):w);const C=[];for(const N of l)if(w[N]){const j=m?o.bK(w[N]):w[N];C.push(j)}return C}_serializedAllLayers(){let l=this._serializedLayers;if(l)return l;l=this._serializedLayers={};const m=Object.keys(this._layers);for(const w of m){const C=this._layers[w];C.type!=="custom"&&(l[w]=C.serialize())}return l}hasTransitions(){var l,m,w;if(!((l=this.light)===null||l===void 0)&&l.hasTransition()||!((m=this.sky)===null||m===void 0)&&m.hasTransition()||!((w=this.projection)===null||w===void 0)&&w.hasTransition())return!0;for(const C in this.sourceCaches)if(this.sourceCaches[C].hasTransition())return!0;for(const C in this._layers)if(this._layers[C].hasTransition())return!0;return!1}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading.")}update(l){if(!this._loaded)return;const m=this._changed;if(m){const C=Object.keys(this._updatedLayers),N=Object.keys(this._removedLayers);(C.length||N.length)&&this._updateWorkerLayers(C,N);for(const j in this._updatedSources){const Y=this._updatedSources[j];if(Y==="reload")this._reloadSource(j);else{if(Y!=="clear")throw new Error(`Invalid action ${Y}`);this._clearSource(j)}}this._updateTilesForChangedImages(),this._updateTilesForChangedGlyphs();for(const j in this._updatedPaintProps)this._layers[j].updateTransitions(l);this.light.updateTransitions(l),this.sky.updateTransitions(l),this._resetUpdates()}const w={};for(const C in this.sourceCaches){const N=this.sourceCaches[C];w[C]=N.used,N.used=!1}for(const C of this._order){const N=this._layers[C];N.recalculate(l,this._availableImages),!N.isHidden(l.zoom)&&N.source&&(this.sourceCaches[N.source].used=!0)}for(const C in w){const N=this.sourceCaches[C];!!w[C]!=!!N.used&&N.fire(new o.l("data",{sourceDataType:"visibility",dataType:"source",sourceId:C}))}this.light.recalculate(l),this.sky.recalculate(l),this.projection.recalculate(l),this.z=l.zoom,m&&this.fire(new o.l("data",{dataType:"style"}))}_updateTilesForChangedImages(){const l=Object.keys(this._changedImages);if(l.length){for(const m in this.sourceCaches)this.sourceCaches[m].reloadTilesForDependencies(["icons","patterns"],l);this._changedImages={}}}_updateTilesForChangedGlyphs(){if(this._glyphsDidChange){for(const l in this.sourceCaches)this.sourceCaches[l].reloadTilesForDependencies(["glyphs"],[""]);this._glyphsDidChange=!1}}_updateWorkerLayers(l,m){this.dispatcher.broadcast("UL",{layers:this._serializeByIds(l,!1),removedIds:m})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={},this._glyphsDidChange=!1}setState(l,m={}){var w;this._checkLoaded();const C=this.serialize();if(l=m.transformStyle?m.transformStyle(C,l):l,((w=m.validate)===null||w===void 0||w)&&fa(this,o.z(l)))return!1;(l=o.bK(l)).layers=o.bI(l.layers);const N=o.bL(C,l),j=this._getOperationsToPerform(N);if(j.unimplemented.length>0)throw new Error(`Unimplemented: ${j.unimplemented.join(", ")}.`);if(j.operations.length===0)return!1;for(const Y of j.operations)Y();return this.stylesheet=l,this._serializedLayers=null,!0}_getOperationsToPerform(l){const m=[],w=[];for(const C of l)switch(C.command){case"setCenter":case"setZoom":case"setBearing":case"setPitch":case"setRoll":continue;case"addLayer":m.push((()=>this.addLayer.apply(this,C.args)));break;case"removeLayer":m.push((()=>this.removeLayer.apply(this,C.args)));break;case"setPaintProperty":m.push((()=>this.setPaintProperty.apply(this,C.args)));break;case"setLayoutProperty":m.push((()=>this.setLayoutProperty.apply(this,C.args)));break;case"setFilter":m.push((()=>this.setFilter.apply(this,C.args)));break;case"addSource":m.push((()=>this.addSource.apply(this,C.args)));break;case"removeSource":m.push((()=>this.removeSource.apply(this,C.args)));break;case"setLayerZoomRange":m.push((()=>this.setLayerZoomRange.apply(this,C.args)));break;case"setLight":m.push((()=>this.setLight.apply(this,C.args)));break;case"setGeoJSONSourceData":m.push((()=>this.setGeoJSONSourceData.apply(this,C.args)));break;case"setGlyphs":m.push((()=>this.setGlyphs.apply(this,C.args)));break;case"setSprite":m.push((()=>this.setSprite.apply(this,C.args)));break;case"setTerrain":m.push((()=>this.map.setTerrain.apply(this,C.args)));break;case"setSky":m.push((()=>this.setSky.apply(this,C.args)));break;case"setProjection":this.setProjection.apply(this,C.args);break;case"setGlobalState":m.push((()=>this.setGlobalState.apply(this,C.args)));break;case"setTransition":m.push((()=>{}));break;default:w.push(C.command)}return{operations:m,unimplemented:w}}addImage(l,m){if(this.getImage(l))return this.fire(new o.k(new Error(`An image named "${l}" already exists.`)));this.imageManager.addImage(l,m),this._afterImageUpdated(l)}updateImage(l,m){this.imageManager.updateImage(l,m)}getImage(l){return this.imageManager.getImage(l)}removeImage(l){if(!this.getImage(l))return this.fire(new o.k(new Error(`An image named "${l}" does not exist.`)));this.imageManager.removeImage(l),this._afterImageUpdated(l)}_afterImageUpdated(l){this._availableImages=this.imageManager.listImages(),this._changedImages[l]=!0,this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new o.l("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this.imageManager.listImages()}addSource(l,m,w={}){if(this._checkLoaded(),this.sourceCaches[l]!==void 0)throw new Error(`Source "${l}" already exists.`);if(!m.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(m).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(m.type)>=0&&this._validate(o.z.source,`sources.${l}`,m,null,w))return;this.map&&this.map._collectResourceTiming&&(m.collectResourceTiming=!0);const C=this.sourceCaches[l]=new Ur(l,m,this.dispatcher);C.style=this,C.setEventedParent(this,(()=>({isSourceLoaded:C.loaded(),source:C.serialize(),sourceId:l}))),C.onAdd(this.map),this._changed=!0}removeSource(l){if(this._checkLoaded(),this.sourceCaches[l]===void 0)throw new Error("There is no source with this ID");for(const w in this._layers)if(this._layers[w].source===l)return this.fire(new o.k(new Error(`Source "${l}" cannot be removed while layer "${w}" is using it.`)));const m=this.sourceCaches[l];delete this.sourceCaches[l],delete this._updatedSources[l],m.fire(new o.l("data",{sourceDataType:"metadata",dataType:"source",sourceId:l})),m.setEventedParent(null),m.onRemove(this.map),this._changed=!0}setGeoJSONSourceData(l,m){if(this._checkLoaded(),this.sourceCaches[l]===void 0)throw new Error(`There is no source with this ID=${l}`);const w=this.sourceCaches[l].getSource();if(w.type!=="geojson")throw new Error(`geojsonSource.type is ${w.type}, which is !== 'geojson`);w.setData(m),this._changed=!0}getSource(l){return this.sourceCaches[l]&&this.sourceCaches[l].getSource()}addLayer(l,m,w={}){this._checkLoaded();const C=l.id;if(this.getLayer(C))return void this.fire(new o.k(new Error(`Layer "${C}" already exists on this map.`)));let N;if(l.type==="custom"){if(fa(this,o.bM(l)))return;N=o.bJ(l)}else{if("source"in l&&typeof l.source=="object"&&(this.addSource(C,l.source),l=o.bK(l),l=o.e(l,{source:C})),this._validate(o.z.layer,`layers.${C}`,l,{arrayIndex:-1},w))return;N=o.bJ(l),this._validateLayer(N),N.setEventedParent(this,{layer:{id:C}})}const j=m?this._order.indexOf(m):this._order.length;if(m&&j===-1)this.fire(new o.k(new Error(`Cannot add layer "${C}" before non-existing layer "${m}".`)));else{if(this._order.splice(j,0,C),this._layerOrderChanged=!0,this._layers[C]=N,this._removedLayers[C]&&N.source&&N.type!=="custom"){const Y=this._removedLayers[C];delete this._removedLayers[C],Y.type!==N.type?this._updatedSources[N.source]="clear":(this._updatedSources[N.source]="reload",this.sourceCaches[N.source].pause())}this._updateLayer(N),N.onAdd&&N.onAdd(this.map)}}moveLayer(l,m){if(this._checkLoaded(),this._changed=!0,!this._layers[l])return void this.fire(new o.k(new Error(`The layer '${l}' does not exist in the map's style and cannot be moved.`)));if(l===m)return;const w=this._order.indexOf(l);this._order.splice(w,1);const C=m?this._order.indexOf(m):this._order.length;m&&C===-1?this.fire(new o.k(new Error(`Cannot move layer "${l}" before non-existing layer "${m}".`))):(this._order.splice(C,0,l),this._layerOrderChanged=!0)}removeLayer(l){this._checkLoaded();const m=this._layers[l];if(!m)return void this.fire(new o.k(new Error(`Cannot remove non-existing layer "${l}".`)));m.setEventedParent(null);const w=this._order.indexOf(l);this._order.splice(w,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[l]=m,delete this._layers[l],this._serializedLayers&&delete this._serializedLayers[l],delete this._updatedLayers[l],delete this._updatedPaintProps[l],m.onRemove&&m.onRemove(this.map)}getLayer(l){return this._layers[l]}getLayersOrder(){return[...this._order]}hasLayer(l){return l in this._layers}setLayerZoomRange(l,m,w){this._checkLoaded();const C=this.getLayer(l);C?C.minzoom===m&&C.maxzoom===w||(m!=null&&(C.minzoom=m),w!=null&&(C.maxzoom=w),this._updateLayer(C)):this.fire(new o.k(new Error(`Cannot set the zoom range of non-existing layer "${l}".`)))}setFilter(l,m,w={}){this._checkLoaded();const C=this.getLayer(l);if(C){if(!o.bH(C.filter,m))return m==null?(C.setFilter(void 0),void this._updateLayer(C)):void(this._validate(o.z.filter,`layers.${C.id}.filter`,m,null,w)||(C.setFilter(o.bK(m)),this._updateLayer(C)))}else this.fire(new o.k(new Error(`Cannot filter non-existing layer "${l}".`)))}getFilter(l){return o.bK(this.getLayer(l).filter)}setLayoutProperty(l,m,w,C={}){this._checkLoaded();const N=this.getLayer(l);N?o.bH(N.getLayoutProperty(m),w)||(N.setLayoutProperty(m,w,C),this._updateLayer(N)):this.fire(new o.k(new Error(`Cannot style non-existing layer "${l}".`)))}getLayoutProperty(l,m){const w=this.getLayer(l);if(w)return w.getLayoutProperty(m);this.fire(new o.k(new Error(`Cannot get style of non-existing layer "${l}".`)))}setPaintProperty(l,m,w,C={}){this._checkLoaded();const N=this.getLayer(l);N?o.bH(N.getPaintProperty(m),w)||this._updatePaintProperty(N,m,w,C):this.fire(new o.k(new Error(`Cannot style non-existing layer "${l}".`)))}_updatePaintProperty(l,m,w,C={}){l.setPaintProperty(m,w,C)&&this._updateLayer(l),this._changed=!0,this._updatedPaintProps[l.id]=!0,this._serializedLayers=null}getPaintProperty(l,m){return this.getLayer(l).getPaintProperty(m)}setFeatureState(l,m){this._checkLoaded();const w=l.source,C=l.sourceLayer,N=this.sourceCaches[w];if(N===void 0)return void this.fire(new o.k(new Error(`The source '${w}' does not exist in the map's style.`)));const j=N.getSource().type;j==="geojson"&&C?this.fire(new o.k(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):j!=="vector"||C?(l.id===void 0&&this.fire(new o.k(new Error("The feature id parameter must be provided."))),N.setFeatureState(C,l.id,m)):this.fire(new o.k(new Error("The sourceLayer parameter must be provided for vector source types.")))}removeFeatureState(l,m){this._checkLoaded();const w=l.source,C=this.sourceCaches[w];if(C===void 0)return void this.fire(new o.k(new Error(`The source '${w}' does not exist in the map's style.`)));const N=C.getSource().type,j=N==="vector"?l.sourceLayer:void 0;N!=="vector"||j?m&&typeof l.id!="string"&&typeof l.id!="number"?this.fire(new o.k(new Error("A feature id is required to remove its specific state property."))):C.removeFeatureState(j,l.id,m):this.fire(new o.k(new Error("The sourceLayer parameter must be provided for vector source types.")))}getFeatureState(l){this._checkLoaded();const m=l.source,w=l.sourceLayer,C=this.sourceCaches[m];if(C!==void 0)return C.getSource().type!=="vector"||w?(l.id===void 0&&this.fire(new o.k(new Error("The feature id parameter must be provided."))),C.getFeatureState(w,l.id)):void this.fire(new o.k(new Error("The sourceLayer parameter must be provided for vector source types.")));this.fire(new o.k(new Error(`The source '${m}' does not exist in the map's style.`)))}getTransition(){return o.e({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){if(!this._loaded)return;const l=o.bN(this.sourceCaches,(N=>N.serialize())),m=this._serializeByIds(this._order,!0),w=this.map.getTerrain()||void 0,C=this.stylesheet;return o.bO({version:C.version,name:C.name,metadata:C.metadata,light:C.light,sky:C.sky,center:C.center,zoom:C.zoom,bearing:C.bearing,pitch:C.pitch,sprite:C.sprite,glyphs:C.glyphs,transition:C.transition,projection:C.projection,sources:l,layers:m,terrain:w},(N=>N!==void 0))}_updateLayer(l){this._updatedLayers[l.id]=!0,l.source&&!this._updatedSources[l.source]&&this.sourceCaches[l.source].getSource().type!=="raster"&&(this._updatedSources[l.source]="reload",this.sourceCaches[l.source].pause()),this._serializedLayers=null,this._changed=!0}_flattenAndSortRenderedFeatures(l){const m=j=>this._layers[j].type==="fill-extrusion",w={},C=[];for(let j=this._order.length-1;j>=0;j--){const Y=this._order[j];if(m(Y)){w[Y]=j;for(const te of l){const ue=te[Y];if(ue)for(const ge of ue)C.push(ge)}}}C.sort(((j,Y)=>Y.intersectionZ-j.intersectionZ));const N=[];for(let j=this._order.length-1;j>=0;j--){const Y=this._order[j];if(m(Y))for(let te=C.length-1;te>=0;te--){const ue=C[te].feature;if(w[ue.layer.id]<j)break;N.push(ue),C.pop()}else for(const te of l){const ue=te[Y];if(ue)for(const ge of ue)N.push(ge.feature)}}return N}queryRenderedFeatures(l,m,w){m&&m.filter&&this._validate(o.z.filter,"queryRenderedFeatures.filter",m.filter,null,m);const C={};if(m&&m.layers){if(!(Array.isArray(m.layers)||m.layers instanceof Set))return this.fire(new o.k(new Error("parameters.layers must be an Array or a Set of strings"))),[];for(const ue of m.layers){const ge=this._layers[ue];if(!ge)return this.fire(new o.k(new Error(`The layer '${ue}' does not exist in the map's style and cannot be queried for features.`))),[];C[ge.source]=!0}}const N=[];m.availableImages=this._availableImages;const j=this._serializedAllLayers(),Y=m.layers instanceof Set?m.layers:Array.isArray(m.layers)?new Set(m.layers):null,te=Object.assign(Object.assign({},m),{layers:Y});for(const ue in this.sourceCaches)m.layers&&!C[ue]||N.push(it(this.sourceCaches[ue],this._layers,j,l,te,w,this.map.terrain?(ge,Ce,Se)=>this.map.terrain.getElevation(ge,Ce,Se):void 0));return this.placement&&N.push((function(ue,ge,Ce,Se,Fe,Ge,ut){const lt={},ct=Ge.queryRenderedSymbols(Se),xt=[];for(const Pt of Object.keys(ct).map(Number))xt.push(ut[Pt]);xt.sort(Ye);for(const Pt of xt){const Ct=Pt.featureIndex.lookupSymbolFeatures(ct[Pt.bucketInstanceId],ge,Pt.bucketIndex,Pt.sourceLayerIndex,Fe.filter,Fe.layers,Fe.availableImages,ue);for(const Ot in Ct){const Bt=lt[Ot]=lt[Ot]||[],At=Ct[Ot];At.sort(((qt,Sr)=>{const fr=Pt.featureSortOrder;if(fr){const dr=fr.indexOf(qt.featureIndex);return fr.indexOf(Sr.featureIndex)-dr}return Sr.featureIndex-qt.featureIndex}));for(const qt of At)Bt.push(qt)}}return(function(Pt,Ct,Ot){for(const Bt in Pt)for(const At of Pt[Bt])rt(At,Ot[Ct[Bt].source]);return Pt})(lt,ue,Ce)})(this._layers,j,this.sourceCaches,l,te,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(N)}querySourceFeatures(l,m){m&&m.filter&&this._validate(o.z.filter,"querySourceFeatures.filter",m.filter,null,m);const w=this.sourceCaches[l];return w?(function(C,N){const j=C.getRenderableIds().map((ue=>C.getTileByID(ue))),Y=[],te={};for(let ue=0;ue<j.length;ue++){const ge=j[ue],Ce=ge.tileID.canonical.key;te[Ce]||(te[Ce]=!0,ge.querySourceFeatures(Y,N))}return Y})(w,m):[]}getLight(){return this.light.getLight()}setLight(l,m={}){this._checkLoaded();const w=this.light.getLight();let C=!1;for(const j in l)if(!o.bH(l[j],w[j])){C=!0;break}if(!C)return;const N={now:b.now(),transition:o.e({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(l,m),this.light.updateTransitions(N)}getProjection(){var l;return(l=this.stylesheet)===null||l===void 0?void 0:l.projection}setProjection(l){if(this._checkLoaded(),this.projection){if(this.projection.name===l.type)return;this.projection.destroy(),delete this.projection}this.stylesheet.projection=l,this._setProjectionInternal(l.type)}getSky(){var l;return(l=this.stylesheet)===null||l===void 0?void 0:l.sky}setSky(l,m={}){this._checkLoaded();const w=this.getSky();let C=!1;if(!l&&!w)return;if(l&&!w)C=!0;else if(!l&&w)C=!0;else for(const j in l)if(!o.bH(l[j],w[j])){C=!0;break}if(!C)return;const N={now:b.now(),transition:o.e({duration:300,delay:0},this.stylesheet.transition)};this.stylesheet.sky=l,this.sky.setSky(l,m),this.sky.updateTransitions(N)}_setProjectionInternal(l){const m=(function(w){if(Array.isArray(w)){const C=new bl({type:w});return{projection:C,transform:new Bi,cameraHelper:new Fa(C)}}switch(w){case"mercator":return{projection:new kr,transform:new Wn,cameraHelper:new gi};case"globe":{const C=new bl({type:["interpolate",["linear"],["zoom"],11,"vertical-perspective",12,"mercator"]});return{projection:C,transform:new Bi,cameraHelper:new Fa(C)}}case"vertical-perspective":return{projection:new Co,transform:new $i,cameraHelper:new Ti};default:return o.w(`Unknown projection name: ${w}. Falling back to mercator projection.`),{projection:new kr,transform:new Wn,cameraHelper:new gi}}})(l);this.projection=m.projection,this.map.migrateProjection(m.transform,m.cameraHelper);for(const w in this.sourceCaches)this.sourceCaches[w].reload()}_validate(l,m,w,C,N={}){return(!N||N.validate!==!1)&&fa(this,l.call(o.z,o.e({key:m,style:this.serialize(),value:w,styleSpec:o.v},C)))}_remove(l=!0){this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._loadStyleRequest&&(this._loadStyleRequest.abort(),this._loadStyleRequest=null),this._spriteRequest&&(this._spriteRequest.abort(),this._spriteRequest=null),Ar().off(wr,this._rtlPluginLoaded);for(const m in this._layers)this._layers[m].setEventedParent(null);for(const m in this.sourceCaches){const w=this.sourceCaches[m];w.setEventedParent(null),w.onRemove(this.map)}this.imageManager.setEventedParent(null),this.setEventedParent(null),l&&this.dispatcher.broadcast("RM",void 0),this.dispatcher.remove(l)}_clearSource(l){this.sourceCaches[l].clearTiles()}_reloadSource(l){this.sourceCaches[l].resume(),this.sourceCaches[l].reload()}_updateSources(l){for(const m in this.sourceCaches)this.sourceCaches[m].update(l,this.map.terrain)}_generateCollisionBoxes(){for(const l in this.sourceCaches)this._reloadSource(l)}_updatePlacement(l,m,w,C,N=!1){let j=!1,Y=!1;const te={};for(const ue of this._order){const ge=this._layers[ue];if(ge.type!=="symbol")continue;if(!te[ge.source]){const Se=this.sourceCaches[ge.source];te[ge.source]=Se.getRenderableIds(!0).map((Fe=>Se.getTileByID(Fe))).sort(((Fe,Ge)=>Ge.tileID.overscaledZ-Fe.tileID.overscaledZ||(Fe.tileID.isLessThan(Ge.tileID)?-1:1)))}const Ce=this.crossTileSymbolIndex.addLayer(ge,te[ge.source],l.center.lng);j=j||Ce}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((N=N||this._layerOrderChanged||w===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(b.now(),l.zoom))&&(this.pauseablePlacement=new el(l,this.map.terrain,this._order,N,m,w,C,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,te),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(b.now()),Y=!0),j&&this.pauseablePlacement.placement.setStale()),Y||j)for(const ue of this._order){const ge=this._layers[ue];ge.type==="symbol"&&this.placement.updateLayerOpacities(ge,te[ge.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(b.now())}_releaseSymbolFadeTiles(){for(const l in this.sourceCaches)this.sourceCaches[l].releaseSymbolFadeTiles()}getImages(l,m){return o._(this,void 0,void 0,(function*(){const w=yield this.imageManager.getImages(m.icons);this._updateTilesForChangedImages();const C=this.sourceCaches[m.source];return C&&C.setDependencies(m.tileID.key,m.type,m.icons),w}))}getGlyphs(l,m){return o._(this,void 0,void 0,(function*(){const w=yield this.glyphManager.getGlyphs(m.stacks),C=this.sourceCaches[m.source];return C&&C.setDependencies(m.tileID.key,m.type,[""]),w}))}getGlyphsUrl(){return this.stylesheet.glyphs||null}setGlyphs(l,m={}){this._checkLoaded(),l&&this._validate(o.z.glyphs,"glyphs",l,null,m)||(this._glyphsDidChange=!0,this.stylesheet.glyphs=l,this.glyphManager.entries={},this.glyphManager.setURL(l))}addSprite(l,m,w={},C){this._checkLoaded();const N=[{id:l,url:m}],j=[...B(this.stylesheet.sprite),...N];this._validate(o.z.sprite,"sprite",j,null,w)||(this.stylesheet.sprite=j,this._loadSprite(N,!0,C))}removeSprite(l){this._checkLoaded();const m=B(this.stylesheet.sprite);if(m.find((w=>w.id===l))){if(this._spritesImagesIds[l])for(const w of this._spritesImagesIds[l])this.imageManager.removeImage(w),this._changedImages[w]=!0;m.splice(m.findIndex((w=>w.id===l)),1),this.stylesheet.sprite=m.length>0?m:void 0,delete this._spritesImagesIds[l],this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new o.l("data",{dataType:"style"}))}else this.fire(new o.k(new Error(`Sprite "${l}" doesn't exists on this map.`)))}getSprite(){return B(this.stylesheet.sprite)}setSprite(l,m={},w){this._checkLoaded(),l&&this._validate(o.z.sprite,"sprite",l,null,m)||(this.stylesheet.sprite=l,l?this._loadSprite(l,!0,w):(this._unloadSprite(),w&&w(null)))}}var nl=o.aJ([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);class Su{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(l,m,w,C,N,j,Y,te,ue){this.context=l;let ge=this.boundPaintVertexBuffers.length!==C.length;for(let Ce=0;!ge&&Ce<C.length;Ce++)this.boundPaintVertexBuffers[Ce]!==C[Ce]&&(ge=!0);!this.vao||this.boundProgram!==m||this.boundLayoutVertexBuffer!==w||ge||this.boundIndexBuffer!==N||this.boundVertexOffset!==j||this.boundDynamicVertexBuffer!==Y||this.boundDynamicVertexBuffer2!==te||this.boundDynamicVertexBuffer3!==ue?this.freshBind(m,w,C,N,j,Y,te,ue):(l.bindVertexArray.set(this.vao),Y&&Y.bind(),N&&N.dynamicDraw&&N.bind(),te&&te.bind(),ue&&ue.bind())}freshBind(l,m,w,C,N,j,Y,te){const ue=l.numAttributes,ge=this.context,Ce=ge.gl;this.vao&&this.destroy(),this.vao=ge.createVertexArray(),ge.bindVertexArray.set(this.vao),this.boundProgram=l,this.boundLayoutVertexBuffer=m,this.boundPaintVertexBuffers=w,this.boundIndexBuffer=C,this.boundVertexOffset=N,this.boundDynamicVertexBuffer=j,this.boundDynamicVertexBuffer2=Y,this.boundDynamicVertexBuffer3=te,m.enableAttributes(Ce,l);for(const Se of w)Se.enableAttributes(Ce,l);j&&j.enableAttributes(Ce,l),Y&&Y.enableAttributes(Ce,l),te&&te.enableAttributes(Ce,l),m.bind(),m.setVertexAttribPointers(Ce,l,N);for(const Se of w)Se.bind(),Se.setVertexAttribPointers(Ce,l,N);j&&(j.bind(),j.setVertexAttribPointers(Ce,l,N)),C&&C.bind(),Y&&(Y.bind(),Y.setVertexAttribPointers(Ce,l,N)),te&&(te.bind(),te.setVertexAttribPointers(Ce,l,N)),ge.currentNumAttributes=ue}destroy(){this.vao&&(this.context.deleteVertexArray(this.vao),this.vao=null)}}const Fo=(R,l,m,w,C)=>({u_texture:0,u_ele_delta:R,u_fog_matrix:l,u_fog_color:m?m.properties.get("fog-color"):o.bf.white,u_fog_ground_blend:m?m.properties.get("fog-ground-blend"):1,u_fog_ground_blend_opacity:C?0:m?m.calculateFogBlendOpacity(w):0,u_horizon_color:m?m.properties.get("horizon-color"):o.bf.white,u_horizon_fog_blend:m?m.properties.get("horizon-fog-blend"):1,u_is_globe_mode:C?1:0}),Dl={mainMatrix:"u_projection_matrix",tileMercatorCoords:"u_projection_tile_mercator_coords",clippingPlane:"u_projection_clipping_plane",projectionTransition:"u_projection_transition",fallbackMatrix:"u_projection_fallback_matrix"};function aa(R){const l=[];for(let m=0;m<R.length;m++){if(R[m]===null)continue;const w=R[m].split(" ");l.push(w.pop())}return l}class xl{constructor(l,m,w,C,N,j,Y,te,ue=[]){const ge=l.gl;this.program=ge.createProgram();const Ce=aa(m.staticAttributes),Se=w?w.getBinderAttributes():[],Fe=Ce.concat(Se),Ge=Nt.prelude.staticUniforms?aa(Nt.prelude.staticUniforms):[],ut=Y.staticUniforms?aa(Y.staticUniforms):[],lt=m.staticUniforms?aa(m.staticUniforms):[],ct=w?w.getBinderUniforms():[],xt=Ge.concat(ut).concat(lt).concat(ct),Pt=[];for(const fr of xt)Pt.indexOf(fr)<0&&Pt.push(fr);const Ct=w?w.defines():[];To(ge)&&Ct.unshift("#version 300 es"),N&&Ct.push("#define OVERDRAW_INSPECTOR;"),j&&Ct.push("#define TERRAIN3D;"),te&&Ct.push(te),ue&&Ct.push(...ue);let Ot=Ct.concat(Nt.prelude.fragmentSource,Y.fragmentSource,m.fragmentSource).join(`
`),Bt=Ct.concat(Nt.prelude.vertexSource,Y.vertexSource,m.vertexSource).join(`
`);To(ge)||(Ot=(function(fr){return fr.replace(/\bin\s/g,"varying ").replace("out highp vec4 fragColor;","").replace(/fragColor/g,"gl_FragColor").replace(/texture\(/g,"texture2D(")})(Ot),Bt=(function(fr){return fr.replace(/\bin\s/g,"attribute ").replace(/\bout\s/g,"varying ").replace(/texture\(/g,"texture2D(")})(Bt));const At=ge.createShader(ge.FRAGMENT_SHADER);if(ge.isContextLost())return void(this.failedToCreate=!0);if(ge.shaderSource(At,Ot),ge.compileShader(At),!ge.getShaderParameter(At,ge.COMPILE_STATUS))throw new Error(`Could not compile fragment shader: ${ge.getShaderInfoLog(At)}`);ge.attachShader(this.program,At);const qt=ge.createShader(ge.VERTEX_SHADER);if(ge.isContextLost())return void(this.failedToCreate=!0);if(ge.shaderSource(qt,Bt),ge.compileShader(qt),!ge.getShaderParameter(qt,ge.COMPILE_STATUS))throw new Error(`Could not compile vertex shader: ${ge.getShaderInfoLog(qt)}`);ge.attachShader(this.program,qt),this.attributes={};const Sr={};this.numAttributes=Fe.length;for(let fr=0;fr<this.numAttributes;fr++)Fe[fr]&&(ge.bindAttribLocation(this.program,fr,Fe[fr]),this.attributes[Fe[fr]]=fr);if(ge.linkProgram(this.program),!ge.getProgramParameter(this.program,ge.LINK_STATUS))throw new Error(`Program failed to link: ${ge.getProgramInfoLog(this.program)}`);ge.deleteShader(qt),ge.deleteShader(At);for(let fr=0;fr<Pt.length;fr++){const dr=Pt[fr];if(dr&&!Sr[dr]){const mr=ge.getUniformLocation(this.program,dr);mr&&(Sr[dr]=mr)}}this.fixedUniforms=C(l,Sr),this.terrainUniforms=((fr,dr)=>({u_depth:new o.bP(fr,dr.u_depth),u_terrain:new o.bP(fr,dr.u_terrain),u_terrain_dim:new o.bg(fr,dr.u_terrain_dim),u_terrain_matrix:new o.bR(fr,dr.u_terrain_matrix),u_terrain_unpack:new o.bS(fr,dr.u_terrain_unpack),u_terrain_exaggeration:new o.bg(fr,dr.u_terrain_exaggeration)}))(l,Sr),this.projectionUniforms=((fr,dr)=>({u_projection_matrix:new o.bR(fr,dr.u_projection_matrix),u_projection_tile_mercator_coords:new o.bS(fr,dr.u_projection_tile_mercator_coords),u_projection_clipping_plane:new o.bS(fr,dr.u_projection_clipping_plane),u_projection_transition:new o.bg(fr,dr.u_projection_transition),u_projection_fallback_matrix:new o.bR(fr,dr.u_projection_fallback_matrix)}))(l,Sr),this.binderUniforms=w?w.getUniforms(l,Sr):[]}draw(l,m,w,C,N,j,Y,te,ue,ge,Ce,Se,Fe,Ge,ut,lt,ct,xt,Pt){const Ct=l.gl;if(this.failedToCreate)return;if(l.program.set(this.program),l.setDepthMode(w),l.setStencilMode(C),l.setColorMode(N),l.setCullFace(j),te){l.activeTexture.set(Ct.TEXTURE2),Ct.bindTexture(Ct.TEXTURE_2D,te.depthTexture),l.activeTexture.set(Ct.TEXTURE3),Ct.bindTexture(Ct.TEXTURE_2D,te.texture);for(const Bt in this.terrainUniforms)this.terrainUniforms[Bt].set(te[Bt])}if(ue)for(const Bt in ue)this.projectionUniforms[Dl[Bt]].set(ue[Bt]);if(Y)for(const Bt in this.fixedUniforms)this.fixedUniforms[Bt].set(Y[Bt]);lt&&lt.setUniforms(l,this.binderUniforms,Ge,{zoom:ut});let Ot=0;switch(m){case Ct.LINES:Ot=2;break;case Ct.TRIANGLES:Ot=3;break;case Ct.LINE_STRIP:Ot=1}for(const Bt of Fe.get()){const At=Bt.vaos||(Bt.vaos={});(At[ge]||(At[ge]=new Su)).bind(l,this,Ce,lt?lt.getPaintVertexBuffers():[],Se,Bt.vertexOffset,ct,xt,Pt),Ct.drawElements(m,Bt.primitiveLength*Ot,Ct.UNSIGNED_SHORT,Bt.primitiveOffset*Ot*2)}}}function iu(R,l,m){const w=1/o.aC(m,1,l.transform.tileZoom),C=Math.pow(2,m.tileID.overscaledZ),N=m.tileSize*Math.pow(2,l.transform.tileZoom)/C,j=N*(m.tileID.canonical.x+m.tileID.wrap*C),Y=N*m.tileID.canonical.y;return{u_image:0,u_texsize:m.imageAtlasTexture.size,u_scale:[w,R.fromScale,R.toScale],u_fade:R.t,u_pixel_coord_upper:[j>>16,Y>>16],u_pixel_coord_lower:[65535&j,65535&Y]}}const co=(R,l,m,w)=>{const C=R.style.light,N=C.properties.get("position"),j=[N.x,N.y,N.z],Y=o.bV();C.properties.get("anchor")==="viewport"&&o.bW(Y,R.transform.bearingInRadians),o.bX(j,j,Y);const te=R.transform.transformLightDirection(j),ue=C.properties.get("color");return{u_lightpos:j,u_lightpos_globe:te,u_lightintensity:C.properties.get("intensity"),u_lightcolor:[ue.r,ue.g,ue.b],u_vertical_gradient:+l,u_opacity:m,u_fill_translate:w}},eo=(R,l,m,w,C,N,j)=>o.e(co(R,l,m,w),iu(N,R,j),{u_height_factor:-Math.pow(2,C.overscaledZ)/j.tileSize/8}),xo=(R,l,m,w)=>o.e(iu(l,R,m),{u_fill_translate:w}),Ba=(R,l)=>({u_world:R,u_fill_translate:l}),Yo=(R,l,m,w,C)=>o.e(xo(R,l,m,C),{u_world:w}),Eu=(R,l,m,w,C)=>{const N=R.transform;let j,Y,te=0;if(m.paint.get("circle-pitch-alignment")==="map"){const ue=o.aC(l,1,N.zoom);j=!0,Y=[ue,ue],te=ue/(o.$*Math.pow(2,l.tileID.overscaledZ))*2*Math.PI*C}else j=!1,Y=N.pixelsToGLUnits;return{u_camera_to_center_distance:N.cameraToCenterDistance,u_scale_with_map:+(m.paint.get("circle-pitch-scale")==="map"),u_pitch_with_map:+j,u_device_pixel_ratio:R.pixelRatio,u_extrude_scale:Y,u_globe_extrude_scale:te,u_translate:w}},Ea=R=>({u_pixel_extrude_scale:[1/R.width,1/R.height]}),lh=R=>({u_viewport_size:[R.width,R.height]}),cs=(R,l=1)=>({u_color:R,u_overlay:0,u_overlay_scale:l}),au=(R,l,m,w)=>{const C=o.aC(R,1,l)/(o.$*Math.pow(2,R.tileID.overscaledZ))*2*Math.PI*w;return{u_extrude_scale:o.aC(R,1,l),u_intensity:m,u_globe_extrude_scale:C}},Wa=(R,l,m,w)=>{const C=o.L();o.bY(C,0,R.width,R.height,0,0,1);const N=R.context.gl;return{u_matrix:C,u_world:[N.drawingBufferWidth,N.drawingBufferHeight],u_image:m,u_color_ramp:w,u_opacity:l.paint.get("heatmap-opacity")}},Fs=(R,l,m)=>{const w=m.paint.get("hillshade-accent-color");let C;switch(m.paint.get("hillshade-method")){case"basic":C=4;break;case"combined":C=1;break;case"igor":C=2;break;case"multidirectional":C=3;break;default:C=0}const N=m.getIlluminationProperties();for(let j=0;j<N.directionRadians.length;j++)m.paint.get("hillshade-illumination-anchor")==="viewport"&&(N.directionRadians[j]+=R.transform.bearingInRadians);return{u_image:0,u_latrange:Wu(0,l.tileID),u_exaggeration:m.paint.get("hillshade-exaggeration"),u_altitudes:N.altitudeRadians,u_azimuths:N.directionRadians,u_accent:w,u_method:C,u_highlights:N.highlightColor,u_shadows:N.shadowColor}},Hu=(R,l)=>{const m=l.stride,w=o.L();return o.bY(w,0,o.$,-o.$,0,0,1),o.M(w,w,[0,-o.$,0]),{u_matrix:w,u_image:1,u_dimension:[m,m],u_zoom:R.overscaledZ,u_unpack:l.getUnpackVector()}};function Wu(R,l){const m=Math.pow(2,l.canonical.z),w=l.canonical.y;return[new o.a1(0,w/m).toLngLat().lat,new o.a1(0,(w+1)/m).toLngLat().lat]}const wl=(R,l,m=0)=>({u_image:0,u_unpack:l.getUnpackVector(),u_dimension:[l.stride,l.stride],u_elevation_stops:1,u_color_stops:4,u_color_ramp_size:m,u_opacity:R.paint.get("color-relief-opacity")}),Fl=(R,l,m,w)=>{const C=R.transform;return{u_translation:Bl(R,l,m),u_ratio:w/o.aC(l,1,C.zoom),u_device_pixel_ratio:R.pixelRatio,u_units_to_pixels:[1/C.pixelsToGLUnits[0],1/C.pixelsToGLUnits[1]]}},Ao=(R,l,m,w,C)=>o.e(Fl(R,l,m,w),{u_image:0,u_image_height:C}),ho=(R,l,m,w,C)=>{const N=R.transform,j=wo(l,N);return{u_translation:Bl(R,l,m),u_texsize:l.imageAtlasTexture.size,u_ratio:w/o.aC(l,1,N.zoom),u_device_pixel_ratio:R.pixelRatio,u_image:0,u_scale:[j,C.fromScale,C.toScale],u_fade:C.t,u_units_to_pixels:[1/N.pixelsToGLUnits[0],1/N.pixelsToGLUnits[1]]}},Bs=(R,l,m,w,C,N)=>{const j=R.lineAtlas,Y=wo(l,R.transform),te=m.layout.get("line-cap")==="round",ue=j.getDash(C.from,te),ge=j.getDash(C.to,te),Ce=ue.width*N.fromScale,Se=ge.width*N.toScale;return o.e(Fl(R,l,m,w),{u_patternscale_a:[Y/Ce,-ue.height/2],u_patternscale_b:[Y/Se,-ge.height/2],u_sdfgamma:j.width/(256*Math.min(Ce,Se)*R.pixelRatio)/2,u_image:0,u_tex_y_a:ue.y,u_tex_y_b:ge.y,u_mix:N.t})};function wo(R,l){return 1/o.aC(R,1,l.tileZoom)}function Bl(R,l,m){return o.aD(R.transform,l,m.paint.get("line-translate"),m.paint.get("line-translate-anchor"))}const hs=(R,l,m,w,C)=>{return{u_tl_parent:R,u_scale_parent:l,u_buffer_scale:1,u_fade_t:m.mix,u_opacity:m.opacity*w.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:w.paint.get("raster-brightness-min"),u_brightness_high:w.paint.get("raster-brightness-max"),u_saturation_factor:(j=w.paint.get("raster-saturation"),j>0?1-1/(1.001-j):-j),u_contrast_factor:(N=w.paint.get("raster-contrast"),N>0?1/(1-N):1+N),u_spin_weights:zl(w.paint.get("raster-hue-rotate")),u_coords_top:[C[0].x,C[0].y,C[1].x,C[1].y],u_coords_bottom:[C[3].x,C[3].y,C[2].x,C[2].y]};var N,j};function zl(R){R*=Math.PI/180;const l=Math.sin(R),m=Math.cos(R);return[(2*m+1)/3,(-Math.sqrt(3)*l-m+1)/3,(Math.sqrt(3)*l-m+1)/3]}const ya=(R,l,m,w,C,N,j,Y,te,ue,ge,Ce,Se)=>{const Fe=j.transform;return{u_is_size_zoom_constant:+(R==="constant"||R==="source"),u_is_size_feature_constant:+(R==="constant"||R==="camera"),u_size_t:l?l.uSizeT:0,u_size:l?l.uSize:0,u_camera_to_center_distance:Fe.cameraToCenterDistance,u_pitch:Fe.pitch/360*2*Math.PI,u_rotate_symbol:+m,u_aspect_ratio:Fe.width/Fe.height,u_fade_change:j.options.fadeDuration?j.symbolFadeChange:1,u_label_plane_matrix:Y,u_coord_matrix:te,u_is_text:+ge,u_pitch_with_map:+w,u_is_along_line:C,u_is_variable_anchor:N,u_texsize:Ce,u_texture:0,u_translation:ue,u_pitched_scale:Se}},Tu=(R,l,m,w,C,N,j,Y,te,ue,ge,Ce,Se,Fe)=>{const Ge=j.transform;return o.e(ya(R,l,m,w,C,N,j,Y,te,ue,ge,Ce,Fe),{u_gamma_scale:w?Math.cos(Ge.pitch*Math.PI/180)*Ge.cameraToCenterDistance:1,u_device_pixel_ratio:j.pixelRatio,u_is_halo:1})},il=(R,l,m,w,C,N,j,Y,te,ue,ge,Ce,Se)=>o.e(Tu(R,l,m,w,C,N,j,Y,te,ue,!0,ge,0,Se),{u_texsize_icon:Ce,u_texture_icon:1}),zs=(R,l)=>({u_opacity:R,u_color:l}),jl=(R,l,m,w,C)=>o.e((function(N,j,Y,te){const ue=Y.imageManager.getPattern(N.from.toString()),ge=Y.imageManager.getPattern(N.to.toString()),{width:Ce,height:Se}=Y.imageManager.getPixelSize(),Fe=Math.pow(2,te.tileID.overscaledZ),Ge=te.tileSize*Math.pow(2,Y.transform.tileZoom)/Fe,ut=Ge*(te.tileID.canonical.x+te.tileID.wrap*Fe),lt=Ge*te.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:ue.tl,u_pattern_br_a:ue.br,u_pattern_tl_b:ge.tl,u_pattern_br_b:ge.br,u_texsize:[Ce,Se],u_mix:j.t,u_pattern_size_a:ue.displaySize,u_pattern_size_b:ge.displaySize,u_scale_a:j.fromScale,u_scale_b:j.toScale,u_tile_units_to_pixels:1/o.aC(te,1,Y.transform.tileZoom),u_pixel_coord_upper:[ut>>16,lt>>16],u_pixel_coord_lower:[65535&ut,65535&lt]}})(m,C,l,w),{u_opacity:R}),Cu=(R,l)=>{},js={fillExtrusion:(R,l)=>({u_lightpos:new o.bT(R,l.u_lightpos),u_lightpos_globe:new o.bT(R,l.u_lightpos_globe),u_lightintensity:new o.bg(R,l.u_lightintensity),u_lightcolor:new o.bT(R,l.u_lightcolor),u_vertical_gradient:new o.bg(R,l.u_vertical_gradient),u_opacity:new o.bg(R,l.u_opacity),u_fill_translate:new o.bU(R,l.u_fill_translate)}),fillExtrusionPattern:(R,l)=>({u_lightpos:new o.bT(R,l.u_lightpos),u_lightpos_globe:new o.bT(R,l.u_lightpos_globe),u_lightintensity:new o.bg(R,l.u_lightintensity),u_lightcolor:new o.bT(R,l.u_lightcolor),u_vertical_gradient:new o.bg(R,l.u_vertical_gradient),u_height_factor:new o.bg(R,l.u_height_factor),u_opacity:new o.bg(R,l.u_opacity),u_fill_translate:new o.bU(R,l.u_fill_translate),u_image:new o.bP(R,l.u_image),u_texsize:new o.bU(R,l.u_texsize),u_pixel_coord_upper:new o.bU(R,l.u_pixel_coord_upper),u_pixel_coord_lower:new o.bU(R,l.u_pixel_coord_lower),u_scale:new o.bT(R,l.u_scale),u_fade:new o.bg(R,l.u_fade)}),fill:(R,l)=>({u_fill_translate:new o.bU(R,l.u_fill_translate)}),fillPattern:(R,l)=>({u_image:new o.bP(R,l.u_image),u_texsize:new o.bU(R,l.u_texsize),u_pixel_coord_upper:new o.bU(R,l.u_pixel_coord_upper),u_pixel_coord_lower:new o.bU(R,l.u_pixel_coord_lower),u_scale:new o.bT(R,l.u_scale),u_fade:new o.bg(R,l.u_fade),u_fill_translate:new o.bU(R,l.u_fill_translate)}),fillOutline:(R,l)=>({u_world:new o.bU(R,l.u_world),u_fill_translate:new o.bU(R,l.u_fill_translate)}),fillOutlinePattern:(R,l)=>({u_world:new o.bU(R,l.u_world),u_image:new o.bP(R,l.u_image),u_texsize:new o.bU(R,l.u_texsize),u_pixel_coord_upper:new o.bU(R,l.u_pixel_coord_upper),u_pixel_coord_lower:new o.bU(R,l.u_pixel_coord_lower),u_scale:new o.bT(R,l.u_scale),u_fade:new o.bg(R,l.u_fade),u_fill_translate:new o.bU(R,l.u_fill_translate)}),circle:(R,l)=>({u_camera_to_center_distance:new o.bg(R,l.u_camera_to_center_distance),u_scale_with_map:new o.bP(R,l.u_scale_with_map),u_pitch_with_map:new o.bP(R,l.u_pitch_with_map),u_extrude_scale:new o.bU(R,l.u_extrude_scale),u_device_pixel_ratio:new o.bg(R,l.u_device_pixel_ratio),u_globe_extrude_scale:new o.bg(R,l.u_globe_extrude_scale),u_translate:new o.bU(R,l.u_translate)}),collisionBox:(R,l)=>({u_pixel_extrude_scale:new o.bU(R,l.u_pixel_extrude_scale)}),collisionCircle:(R,l)=>({u_viewport_size:new o.bU(R,l.u_viewport_size)}),debug:(R,l)=>({u_color:new o.bQ(R,l.u_color),u_overlay:new o.bP(R,l.u_overlay),u_overlay_scale:new o.bg(R,l.u_overlay_scale)}),depth:Cu,clippingMask:Cu,heatmap:(R,l)=>({u_extrude_scale:new o.bg(R,l.u_extrude_scale),u_intensity:new o.bg(R,l.u_intensity),u_globe_extrude_scale:new o.bg(R,l.u_globe_extrude_scale)}),heatmapTexture:(R,l)=>({u_matrix:new o.bR(R,l.u_matrix),u_world:new o.bU(R,l.u_world),u_image:new o.bP(R,l.u_image),u_color_ramp:new o.bP(R,l.u_color_ramp),u_opacity:new o.bg(R,l.u_opacity)}),hillshade:(R,l)=>({u_image:new o.bP(R,l.u_image),u_latrange:new o.bU(R,l.u_latrange),u_exaggeration:new o.bg(R,l.u_exaggeration),u_altitudes:new o.b_(R,l.u_altitudes),u_azimuths:new o.b_(R,l.u_azimuths),u_accent:new o.bQ(R,l.u_accent),u_method:new o.bP(R,l.u_method),u_shadows:new o.bZ(R,l.u_shadows),u_highlights:new o.bZ(R,l.u_highlights)}),hillshadePrepare:(R,l)=>({u_matrix:new o.bR(R,l.u_matrix),u_image:new o.bP(R,l.u_image),u_dimension:new o.bU(R,l.u_dimension),u_zoom:new o.bg(R,l.u_zoom),u_unpack:new o.bS(R,l.u_unpack)}),colorRelief:(R,l)=>({u_image:new o.bP(R,l.u_image),u_unpack:new o.bS(R,l.u_unpack),u_dimension:new o.bU(R,l.u_dimension),u_elevation_stops:new o.bP(R,l.u_elevation_stops),u_color_stops:new o.bP(R,l.u_color_stops),u_color_ramp_size:new o.bP(R,l.u_color_ramp_size),u_opacity:new o.bg(R,l.u_opacity)}),line:(R,l)=>({u_translation:new o.bU(R,l.u_translation),u_ratio:new o.bg(R,l.u_ratio),u_device_pixel_ratio:new o.bg(R,l.u_device_pixel_ratio),u_units_to_pixels:new o.bU(R,l.u_units_to_pixels)}),lineGradient:(R,l)=>({u_translation:new o.bU(R,l.u_translation),u_ratio:new o.bg(R,l.u_ratio),u_device_pixel_ratio:new o.bg(R,l.u_device_pixel_ratio),u_units_to_pixels:new o.bU(R,l.u_units_to_pixels),u_image:new o.bP(R,l.u_image),u_image_height:new o.bg(R,l.u_image_height)}),linePattern:(R,l)=>({u_translation:new o.bU(R,l.u_translation),u_texsize:new o.bU(R,l.u_texsize),u_ratio:new o.bg(R,l.u_ratio),u_device_pixel_ratio:new o.bg(R,l.u_device_pixel_ratio),u_image:new o.bP(R,l.u_image),u_units_to_pixels:new o.bU(R,l.u_units_to_pixels),u_scale:new o.bT(R,l.u_scale),u_fade:new o.bg(R,l.u_fade)}),lineSDF:(R,l)=>({u_translation:new o.bU(R,l.u_translation),u_ratio:new o.bg(R,l.u_ratio),u_device_pixel_ratio:new o.bg(R,l.u_device_pixel_ratio),u_units_to_pixels:new o.bU(R,l.u_units_to_pixels),u_patternscale_a:new o.bU(R,l.u_patternscale_a),u_patternscale_b:new o.bU(R,l.u_patternscale_b),u_sdfgamma:new o.bg(R,l.u_sdfgamma),u_image:new o.bP(R,l.u_image),u_tex_y_a:new o.bg(R,l.u_tex_y_a),u_tex_y_b:new o.bg(R,l.u_tex_y_b),u_mix:new o.bg(R,l.u_mix)}),raster:(R,l)=>({u_tl_parent:new o.bU(R,l.u_tl_parent),u_scale_parent:new o.bg(R,l.u_scale_parent),u_buffer_scale:new o.bg(R,l.u_buffer_scale),u_fade_t:new o.bg(R,l.u_fade_t),u_opacity:new o.bg(R,l.u_opacity),u_image0:new o.bP(R,l.u_image0),u_image1:new o.bP(R,l.u_image1),u_brightness_low:new o.bg(R,l.u_brightness_low),u_brightness_high:new o.bg(R,l.u_brightness_high),u_saturation_factor:new o.bg(R,l.u_saturation_factor),u_contrast_factor:new o.bg(R,l.u_contrast_factor),u_spin_weights:new o.bT(R,l.u_spin_weights),u_coords_top:new o.bS(R,l.u_coords_top),u_coords_bottom:new o.bS(R,l.u_coords_bottom)}),symbolIcon:(R,l)=>({u_is_size_zoom_constant:new o.bP(R,l.u_is_size_zoom_constant),u_is_size_feature_constant:new o.bP(R,l.u_is_size_feature_constant),u_size_t:new o.bg(R,l.u_size_t),u_size:new o.bg(R,l.u_size),u_camera_to_center_distance:new o.bg(R,l.u_camera_to_center_distance),u_pitch:new o.bg(R,l.u_pitch),u_rotate_symbol:new o.bP(R,l.u_rotate_symbol),u_aspect_ratio:new o.bg(R,l.u_aspect_ratio),u_fade_change:new o.bg(R,l.u_fade_change),u_label_plane_matrix:new o.bR(R,l.u_label_plane_matrix),u_coord_matrix:new o.bR(R,l.u_coord_matrix),u_is_text:new o.bP(R,l.u_is_text),u_pitch_with_map:new o.bP(R,l.u_pitch_with_map),u_is_along_line:new o.bP(R,l.u_is_along_line),u_is_variable_anchor:new o.bP(R,l.u_is_variable_anchor),u_texsize:new o.bU(R,l.u_texsize),u_texture:new o.bP(R,l.u_texture),u_translation:new o.bU(R,l.u_translation),u_pitched_scale:new o.bg(R,l.u_pitched_scale)}),symbolSDF:(R,l)=>({u_is_size_zoom_constant:new o.bP(R,l.u_is_size_zoom_constant),u_is_size_feature_constant:new o.bP(R,l.u_is_size_feature_constant),u_size_t:new o.bg(R,l.u_size_t),u_size:new o.bg(R,l.u_size),u_camera_to_center_distance:new o.bg(R,l.u_camera_to_center_distance),u_pitch:new o.bg(R,l.u_pitch),u_rotate_symbol:new o.bP(R,l.u_rotate_symbol),u_aspect_ratio:new o.bg(R,l.u_aspect_ratio),u_fade_change:new o.bg(R,l.u_fade_change),u_label_plane_matrix:new o.bR(R,l.u_label_plane_matrix),u_coord_matrix:new o.bR(R,l.u_coord_matrix),u_is_text:new o.bP(R,l.u_is_text),u_pitch_with_map:new o.bP(R,l.u_pitch_with_map),u_is_along_line:new o.bP(R,l.u_is_along_line),u_is_variable_anchor:new o.bP(R,l.u_is_variable_anchor),u_texsize:new o.bU(R,l.u_texsize),u_texture:new o.bP(R,l.u_texture),u_gamma_scale:new o.bg(R,l.u_gamma_scale),u_device_pixel_ratio:new o.bg(R,l.u_device_pixel_ratio),u_is_halo:new o.bP(R,l.u_is_halo),u_translation:new o.bU(R,l.u_translation),u_pitched_scale:new o.bg(R,l.u_pitched_scale)}),symbolTextAndIcon:(R,l)=>({u_is_size_zoom_constant:new o.bP(R,l.u_is_size_zoom_constant),u_is_size_feature_constant:new o.bP(R,l.u_is_size_feature_constant),u_size_t:new o.bg(R,l.u_size_t),u_size:new o.bg(R,l.u_size),u_camera_to_center_distance:new o.bg(R,l.u_camera_to_center_distance),u_pitch:new o.bg(R,l.u_pitch),u_rotate_symbol:new o.bP(R,l.u_rotate_symbol),u_aspect_ratio:new o.bg(R,l.u_aspect_ratio),u_fade_change:new o.bg(R,l.u_fade_change),u_label_plane_matrix:new o.bR(R,l.u_label_plane_matrix),u_coord_matrix:new o.bR(R,l.u_coord_matrix),u_is_text:new o.bP(R,l.u_is_text),u_pitch_with_map:new o.bP(R,l.u_pitch_with_map),u_is_along_line:new o.bP(R,l.u_is_along_line),u_is_variable_anchor:new o.bP(R,l.u_is_variable_anchor),u_texsize:new o.bU(R,l.u_texsize),u_texsize_icon:new o.bU(R,l.u_texsize_icon),u_texture:new o.bP(R,l.u_texture),u_texture_icon:new o.bP(R,l.u_texture_icon),u_gamma_scale:new o.bg(R,l.u_gamma_scale),u_device_pixel_ratio:new o.bg(R,l.u_device_pixel_ratio),u_is_halo:new o.bP(R,l.u_is_halo),u_translation:new o.bU(R,l.u_translation),u_pitched_scale:new o.bg(R,l.u_pitched_scale)}),background:(R,l)=>({u_opacity:new o.bg(R,l.u_opacity),u_color:new o.bQ(R,l.u_color)}),backgroundPattern:(R,l)=>({u_opacity:new o.bg(R,l.u_opacity),u_image:new o.bP(R,l.u_image),u_pattern_tl_a:new o.bU(R,l.u_pattern_tl_a),u_pattern_br_a:new o.bU(R,l.u_pattern_br_a),u_pattern_tl_b:new o.bU(R,l.u_pattern_tl_b),u_pattern_br_b:new o.bU(R,l.u_pattern_br_b),u_texsize:new o.bU(R,l.u_texsize),u_mix:new o.bg(R,l.u_mix),u_pattern_size_a:new o.bU(R,l.u_pattern_size_a),u_pattern_size_b:new o.bU(R,l.u_pattern_size_b),u_scale_a:new o.bg(R,l.u_scale_a),u_scale_b:new o.bg(R,l.u_scale_b),u_pixel_coord_upper:new o.bU(R,l.u_pixel_coord_upper),u_pixel_coord_lower:new o.bU(R,l.u_pixel_coord_lower),u_tile_units_to_pixels:new o.bg(R,l.u_tile_units_to_pixels)}),terrain:(R,l)=>({u_texture:new o.bP(R,l.u_texture),u_ele_delta:new o.bg(R,l.u_ele_delta),u_fog_matrix:new o.bR(R,l.u_fog_matrix),u_fog_color:new o.bQ(R,l.u_fog_color),u_fog_ground_blend:new o.bg(R,l.u_fog_ground_blend),u_fog_ground_blend_opacity:new o.bg(R,l.u_fog_ground_blend_opacity),u_horizon_color:new o.bQ(R,l.u_horizon_color),u_horizon_fog_blend:new o.bg(R,l.u_horizon_fog_blend),u_is_globe_mode:new o.bg(R,l.u_is_globe_mode)}),terrainDepth:(R,l)=>({u_ele_delta:new o.bg(R,l.u_ele_delta)}),terrainCoords:(R,l)=>({u_texture:new o.bP(R,l.u_texture),u_terrain_coords_id:new o.bg(R,l.u_terrain_coords_id),u_ele_delta:new o.bg(R,l.u_ele_delta)}),projectionErrorMeasurement:(R,l)=>({u_input:new o.bg(R,l.u_input),u_output_expected:new o.bg(R,l.u_output_expected)}),atmosphere:(R,l)=>({u_sun_pos:new o.bT(R,l.u_sun_pos),u_atmosphere_blend:new o.bg(R,l.u_atmosphere_blend),u_globe_position:new o.bT(R,l.u_globe_position),u_globe_radius:new o.bg(R,l.u_globe_radius),u_inv_proj_matrix:new o.bR(R,l.u_inv_proj_matrix)}),sky:(R,l)=>({u_sky_color:new o.bQ(R,l.u_sky_color),u_horizon_color:new o.bQ(R,l.u_horizon_color),u_horizon:new o.bU(R,l.u_horizon),u_horizon_normal:new o.bU(R,l.u_horizon_normal),u_sky_horizon_blend:new o.bg(R,l.u_sky_horizon_blend),u_sky_blend:new o.bg(R,l.u_sky_blend)})};class ou{constructor(l,m,w){this.context=l;const C=l.gl;this.buffer=C.createBuffer(),this.dynamicDraw=!!w,this.context.unbindVAO(),l.bindElementBuffer.set(this.buffer),C.bufferData(C.ELEMENT_ARRAY_BUFFER,m.arrayBuffer,this.dynamicDraw?C.DYNAMIC_DRAW:C.STATIC_DRAW),this.dynamicDraw||delete m.arrayBuffer}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(l){const m=this.context.gl;if(!this.dynamicDraw)throw new Error("Attempted to update data while not in dynamic mode.");this.context.unbindVAO(),this.bind(),m.bufferSubData(m.ELEMENT_ARRAY_BUFFER,0,l.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const Ul={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class $t{constructor(l,m,w,C){this.length=m.length,this.attributes=w,this.itemSize=m.bytesPerElement,this.dynamicDraw=C,this.context=l;const N=l.gl;this.buffer=N.createBuffer(),l.bindVertexBuffer.set(this.buffer),N.bufferData(N.ARRAY_BUFFER,m.arrayBuffer,this.dynamicDraw?N.DYNAMIC_DRAW:N.STATIC_DRAW),this.dynamicDraw||delete m.arrayBuffer}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(l){if(l.length!==this.length)throw new Error(`Length of new data is ${l.length}, which doesn't match current length of ${this.length}`);const m=this.context.gl;this.bind(),m.bufferSubData(m.ARRAY_BUFFER,0,l.arrayBuffer)}enableAttributes(l,m){for(let w=0;w<this.attributes.length;w++){const C=m.attributes[this.attributes[w].name];C!==void 0&&l.enableVertexAttribArray(C)}}setVertexAttribPointers(l,m,w){for(let C=0;C<this.attributes.length;C++){const N=this.attributes[C],j=m.attributes[N.name];j!==void 0&&l.vertexAttribPointer(j,N.components,l[Ul[N.type]],!1,this.itemSize,N.offset+this.itemSize*(w||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class tr{constructor(l){this.gl=l.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(l){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class sn extends tr{getDefault(){return o.bf.transparent}set(l){const m=this.current;(l.r!==m.r||l.g!==m.g||l.b!==m.b||l.a!==m.a||this.dirty)&&(this.gl.clearColor(l.r,l.g,l.b,l.a),this.current=l,this.dirty=!1)}}class Cn extends tr{getDefault(){return 1}set(l){(l!==this.current||this.dirty)&&(this.gl.clearDepth(l),this.current=l,this.dirty=!1)}}class bi extends tr{getDefault(){return 0}set(l){(l!==this.current||this.dirty)&&(this.gl.clearStencil(l),this.current=l,this.dirty=!1)}}class An extends tr{getDefault(){return[!0,!0,!0,!0]}set(l){const m=this.current;(l[0]!==m[0]||l[1]!==m[1]||l[2]!==m[2]||l[3]!==m[3]||this.dirty)&&(this.gl.colorMask(l[0],l[1],l[2],l[3]),this.current=l,this.dirty=!1)}}class A extends tr{getDefault(){return!0}set(l){(l!==this.current||this.dirty)&&(this.gl.depthMask(l),this.current=l,this.dirty=!1)}}class y extends tr{getDefault(){return 255}set(l){(l!==this.current||this.dirty)&&(this.gl.stencilMask(l),this.current=l,this.dirty=!1)}}class _ extends tr{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(l){const m=this.current;(l.func!==m.func||l.ref!==m.ref||l.mask!==m.mask||this.dirty)&&(this.gl.stencilFunc(l.func,l.ref,l.mask),this.current=l,this.dirty=!1)}}class I extends tr{getDefault(){const l=this.gl;return[l.KEEP,l.KEEP,l.KEEP]}set(l){const m=this.current;(l[0]!==m[0]||l[1]!==m[1]||l[2]!==m[2]||this.dirty)&&(this.gl.stencilOp(l[0],l[1],l[2]),this.current=l,this.dirty=!1)}}class U extends tr{getDefault(){return!1}set(l){if(l===this.current&&!this.dirty)return;const m=this.gl;l?m.enable(m.STENCIL_TEST):m.disable(m.STENCIL_TEST),this.current=l,this.dirty=!1}}class re extends tr{getDefault(){return[0,1]}set(l){const m=this.current;(l[0]!==m[0]||l[1]!==m[1]||this.dirty)&&(this.gl.depthRange(l[0],l[1]),this.current=l,this.dirty=!1)}}class ye extends tr{getDefault(){return!1}set(l){if(l===this.current&&!this.dirty)return;const m=this.gl;l?m.enable(m.DEPTH_TEST):m.disable(m.DEPTH_TEST),this.current=l,this.dirty=!1}}class Re extends tr{getDefault(){return this.gl.LESS}set(l){(l!==this.current||this.dirty)&&(this.gl.depthFunc(l),this.current=l,this.dirty=!1)}}class Ke extends tr{getDefault(){return!1}set(l){if(l===this.current&&!this.dirty)return;const m=this.gl;l?m.enable(m.BLEND):m.disable(m.BLEND),this.current=l,this.dirty=!1}}class yt extends tr{getDefault(){const l=this.gl;return[l.ONE,l.ZERO]}set(l){const m=this.current;(l[0]!==m[0]||l[1]!==m[1]||this.dirty)&&(this.gl.blendFunc(l[0],l[1]),this.current=l,this.dirty=!1)}}class Zt extends tr{getDefault(){return o.bf.transparent}set(l){const m=this.current;(l.r!==m.r||l.g!==m.g||l.b!==m.b||l.a!==m.a||this.dirty)&&(this.gl.blendColor(l.r,l.g,l.b,l.a),this.current=l,this.dirty=!1)}}class ur extends tr{getDefault(){return this.gl.FUNC_ADD}set(l){(l!==this.current||this.dirty)&&(this.gl.blendEquation(l),this.current=l,this.dirty=!1)}}class Vr extends tr{getDefault(){return!1}set(l){if(l===this.current&&!this.dirty)return;const m=this.gl;l?m.enable(m.CULL_FACE):m.disable(m.CULL_FACE),this.current=l,this.dirty=!1}}class gn extends tr{getDefault(){return this.gl.BACK}set(l){(l!==this.current||this.dirty)&&(this.gl.cullFace(l),this.current=l,this.dirty=!1)}}class Rn extends tr{getDefault(){return this.gl.CCW}set(l){(l!==this.current||this.dirty)&&(this.gl.frontFace(l),this.current=l,this.dirty=!1)}}class Vn extends tr{getDefault(){return null}set(l){(l!==this.current||this.dirty)&&(this.gl.useProgram(l),this.current=l,this.dirty=!1)}}class In extends tr{getDefault(){return this.gl.TEXTURE0}set(l){(l!==this.current||this.dirty)&&(this.gl.activeTexture(l),this.current=l,this.dirty=!1)}}class Dn extends tr{getDefault(){const l=this.gl;return[0,0,l.drawingBufferWidth,l.drawingBufferHeight]}set(l){const m=this.current;(l[0]!==m[0]||l[1]!==m[1]||l[2]!==m[2]||l[3]!==m[3]||this.dirty)&&(this.gl.viewport(l[0],l[1],l[2],l[3]),this.current=l,this.dirty=!1)}}class Qi extends tr{getDefault(){return null}set(l){if(l===this.current&&!this.dirty)return;const m=this.gl;m.bindFramebuffer(m.FRAMEBUFFER,l),this.current=l,this.dirty=!1}}class ia extends tr{getDefault(){return null}set(l){if(l===this.current&&!this.dirty)return;const m=this.gl;m.bindRenderbuffer(m.RENDERBUFFER,l),this.current=l,this.dirty=!1}}class Ta extends tr{getDefault(){return null}set(l){if(l===this.current&&!this.dirty)return;const m=this.gl;m.bindTexture(m.TEXTURE_2D,l),this.current=l,this.dirty=!1}}class Ga extends tr{getDefault(){return null}set(l){if(l===this.current&&!this.dirty)return;const m=this.gl;m.bindBuffer(m.ARRAY_BUFFER,l),this.current=l,this.dirty=!1}}class Bo extends tr{getDefault(){return null}set(l){const m=this.gl;m.bindBuffer(m.ELEMENT_ARRAY_BUFFER,l),this.current=l,this.dirty=!1}}class xs extends tr{getDefault(){return null}set(l){var m;if(l===this.current&&!this.dirty)return;const w=this.gl;To(w)?w.bindVertexArray(l):(m=w.getExtension("OES_vertex_array_object"))===null||m===void 0||m.bindVertexArrayOES(l),this.current=l,this.dirty=!1}}class Vl extends tr{getDefault(){return 4}set(l){if(l===this.current&&!this.dirty)return;const m=this.gl;m.pixelStorei(m.UNPACK_ALIGNMENT,l),this.current=l,this.dirty=!1}}class Gu extends tr{getDefault(){return!1}set(l){if(l===this.current&&!this.dirty)return;const m=this.gl;m.pixelStorei(m.UNPACK_PREMULTIPLY_ALPHA_WEBGL,l),this.current=l,this.dirty=!1}}class Us extends tr{getDefault(){return!1}set(l){if(l===this.current&&!this.dirty)return;const m=this.gl;m.pixelStorei(m.UNPACK_FLIP_Y_WEBGL,l),this.current=l,this.dirty=!1}}class Zo extends tr{constructor(l,m){super(l),this.context=l,this.parent=m}getDefault(){return null}}class uc extends Zo{setDirty(){this.dirty=!0}set(l){if(l===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const m=this.gl;m.framebufferTexture2D(m.FRAMEBUFFER,m.COLOR_ATTACHMENT0,m.TEXTURE_2D,l,0),this.current=l,this.dirty=!1}}class Sl extends Zo{set(l){if(l===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const m=this.gl;m.framebufferRenderbuffer(m.FRAMEBUFFER,m.DEPTH_ATTACHMENT,m.RENDERBUFFER,l),this.current=l,this.dirty=!1}}class Zn extends Zo{set(l){if(l===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const m=this.gl;m.framebufferRenderbuffer(m.FRAMEBUFFER,m.DEPTH_STENCIL_ATTACHMENT,m.RENDERBUFFER,l),this.current=l,this.dirty=!1}}const zo="Framebuffer is not complete";class Oc{constructor(l,m,w,C,N){this.context=l,this.width=m,this.height=w;const j=l.gl,Y=this.framebuffer=j.createFramebuffer();if(this.colorAttachment=new uc(l,Y),C)this.depthAttachment=N?new Zn(l,Y):new Sl(l,Y);else if(N)throw new Error("Stencil cannot be set without depth");if(j.checkFramebufferStatus(j.FRAMEBUFFER)!==j.FRAMEBUFFER_COMPLETE)throw new Error(zo)}destroy(){const l=this.context.gl,m=this.colorAttachment.get();if(m&&l.deleteTexture(m),this.depthAttachment){const w=this.depthAttachment.get();w&&l.deleteRenderbuffer(w)}l.deleteFramebuffer(this.framebuffer)}}class uh{constructor(l){var m,w;if(this.gl=l,this.clearColor=new sn(this),this.clearDepth=new Cn(this),this.clearStencil=new bi(this),this.colorMask=new An(this),this.depthMask=new A(this),this.stencilMask=new y(this),this.stencilFunc=new _(this),this.stencilOp=new I(this),this.stencilTest=new U(this),this.depthRange=new re(this),this.depthTest=new ye(this),this.depthFunc=new Re(this),this.blend=new Ke(this),this.blendFunc=new yt(this),this.blendColor=new Zt(this),this.blendEquation=new ur(this),this.cullFace=new Vr(this),this.cullFaceSide=new gn(this),this.frontFace=new Rn(this),this.program=new Vn(this),this.activeTexture=new In(this),this.viewport=new Dn(this),this.bindFramebuffer=new Qi(this),this.bindRenderbuffer=new ia(this),this.bindTexture=new Ta(this),this.bindVertexBuffer=new Ga(this),this.bindElementBuffer=new Bo(this),this.bindVertexArray=new xs(this),this.pixelStoreUnpack=new Vl(this),this.pixelStoreUnpackPremultiplyAlpha=new Gu(this),this.pixelStoreUnpackFlipY=new Us(this),this.extTextureFilterAnisotropic=l.getExtension("EXT_texture_filter_anisotropic")||l.getExtension("MOZ_EXT_texture_filter_anisotropic")||l.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=l.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.maxTextureSize=l.getParameter(l.MAX_TEXTURE_SIZE),To(l)){this.HALF_FLOAT=l.HALF_FLOAT;const C=l.getExtension("EXT_color_buffer_half_float");this.RGBA16F=(m=l.RGBA16F)!==null&&m!==void 0?m:C?.RGBA16F_EXT,this.RGB16F=(w=l.RGB16F)!==null&&w!==void 0?w:C?.RGB16F_EXT,l.getExtension("EXT_color_buffer_float")}else{l.getExtension("EXT_color_buffer_half_float"),l.getExtension("OES_texture_half_float_linear");const C=l.getExtension("OES_texture_half_float");this.HALF_FLOAT=C?.HALF_FLOAT_OES}}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArray.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(l,m){return new ou(this,l,m)}createVertexBuffer(l,m,w){return new $t(this,l,m,w)}createRenderbuffer(l,m,w){const C=this.gl,N=C.createRenderbuffer();return this.bindRenderbuffer.set(N),C.renderbufferStorage(C.RENDERBUFFER,l,m,w),this.bindRenderbuffer.set(null),N}createFramebuffer(l,m,w,C){return new Oc(this,l,m,w,C)}clear({color:l,depth:m,stencil:w}){const C=this.gl;let N=0;l&&(N|=C.COLOR_BUFFER_BIT,this.clearColor.set(l),this.colorMask.set([!0,!0,!0,!0])),m!==void 0&&(N|=C.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(m),this.depthMask.set(!0)),w!==void 0&&(N|=C.STENCIL_BUFFER_BIT,this.clearStencil.set(w),this.stencilMask.set(255)),C.clear(N)}setCullFace(l){l.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(l.mode),this.frontFace.set(l.frontFace))}setDepthMode(l){l.func!==this.gl.ALWAYS||l.mask?(this.depthTest.set(!0),this.depthFunc.set(l.func),this.depthMask.set(l.mask),this.depthRange.set(l.range)):this.depthTest.set(!1)}setStencilMode(l){l.test.func!==this.gl.ALWAYS||l.mask?(this.stencilTest.set(!0),this.stencilMask.set(l.mask),this.stencilOp.set([l.fail,l.depthFail,l.pass]),this.stencilFunc.set({func:l.test.func,ref:l.ref,mask:l.test.mask})):this.stencilTest.set(!1)}setColorMode(l){o.bH(l.blendFunction,jn.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(l.blendFunction),this.blendColor.set(l.blendColor)),this.colorMask.set(l.mask)}createVertexArray(){var l;return To(this.gl)?this.gl.createVertexArray():(l=this.gl.getExtension("OES_vertex_array_object"))===null||l===void 0?void 0:l.createVertexArrayOES()}deleteVertexArray(l){var m;return To(this.gl)?this.gl.deleteVertexArray(l):(m=this.gl.getExtension("OES_vertex_array_object"))===null||m===void 0?void 0:m.deleteVertexArrayOES(l)}unbindVAO(){this.bindVertexArray.set(null)}}let $l;function cc(R,l,m,w,C){const N=R.context,j=R.transform,Y=N.gl,te=R.useProgram("collisionBox"),ue=[];let ge=0,Ce=0;for(let ct=0;ct<w.length;ct++){const xt=w[ct],Pt=l.getTile(xt).getBucket(m);if(!Pt)continue;const Ct=C?Pt.textCollisionBox:Pt.iconCollisionBox,Ot=Pt.collisionCircleArray;Ot.length>0&&(ue.push({circleArray:Ot,circleOffset:Ce,coord:xt}),ge+=Ot.length/4,Ce=ge),Ct&&te.draw(N,Y.LINES,Nn.disabled,Yn.disabled,R.colorModeForRenderPass(),Un.disabled,Ea(R.transform),R.style.map.terrain&&R.style.map.terrain.getTerrainData(xt),j.getProjectionData({overscaledTileID:xt,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),m.id,Ct.layoutVertexBuffer,Ct.indexBuffer,Ct.segments,null,R.transform.zoom,null,null,Ct.collisionVertexBuffer)}if(!C||!ue.length)return;const Se=R.useProgram("collisionCircle"),Fe=new o.b$;Fe.resize(4*ge),Fe._trim();let Ge=0;for(const ct of ue)for(let xt=0;xt<ct.circleArray.length/4;xt++){const Pt=4*xt,Ct=ct.circleArray[Pt+0],Ot=ct.circleArray[Pt+1],Bt=ct.circleArray[Pt+2],At=ct.circleArray[Pt+3];Fe.emplace(Ge++,Ct,Ot,Bt,At,0),Fe.emplace(Ge++,Ct,Ot,Bt,At,1),Fe.emplace(Ge++,Ct,Ot,Bt,At,2),Fe.emplace(Ge++,Ct,Ot,Bt,At,3)}(!$l||$l.length<2*ge)&&($l=(function(ct){const xt=2*ct,Pt=new o.c1;Pt.resize(xt),Pt._trim();for(let Ct=0;Ct<xt;Ct++){const Ot=6*Ct;Pt.uint16[Ot+0]=4*Ct+0,Pt.uint16[Ot+1]=4*Ct+1,Pt.uint16[Ot+2]=4*Ct+2,Pt.uint16[Ot+3]=4*Ct+2,Pt.uint16[Ot+4]=4*Ct+3,Pt.uint16[Ot+5]=4*Ct+0}return Pt})(ge));const ut=N.createIndexBuffer($l,!0),lt=N.createVertexBuffer(Fe,o.c0.members,!0);for(const ct of ue){const xt=lh(R.transform);Se.draw(N,Y.TRIANGLES,Nn.disabled,Yn.disabled,R.colorModeForRenderPass(),Un.disabled,xt,R.style.map.terrain&&R.style.map.terrain.getTerrainData(ct.coord),null,m.id,lt,ut,o.aM.simpleSegment(0,2*ct.circleOffset,ct.circleArray.length,ct.circleArray.length/2),null,R.transform.zoom,null,null,null)}lt.destroy(),ut.destroy()}const ip=o.ag(new Float32Array(16));function ap(R,l,m,w,C,N){const{horizontalAlign:j,verticalAlign:Y}=o.aH(R);return new o.P((-(j-.5)*l/C+w[0])*N,(-(Y-.5)*m/C+w[1])*N)}function ey(R,l,m,w,C,N){const j=l.tileAnchorPoint.add(new o.P(l.translation[0],l.translation[1]));if(l.pitchWithMap){let Y=w.mult(N);m||(Y=Y.rotate(-C));const te=j.add(Y);return mt(te.x,te.y,l.pitchedLabelPlaneMatrix,l.getElevation).point}if(m){const Y=Mi(l.tileAnchorPoint.x+1,l.tileAnchorPoint.y,l).point.sub(R),te=Math.atan(Y.y/Y.x)+(Y.x<0?Math.PI:0);return R.add(w.rotate(te))}return R.add(w)}function fd(R,l,m,w,C,N,j,Y,te,ue,ge,Ce){const Se=R.text.placedSymbolArray,Fe=R.text.dynamicLayoutVertexArray,Ge=R.icon.dynamicLayoutVertexArray,ut={};Fe.clear();for(let lt=0;lt<Se.length;lt++){const ct=Se.get(lt),xt=ct.hidden||!ct.crossTileID||R.allowVerticalPlacement&&!ct.placedOrientation?null:w[ct.crossTileID];if(xt){const Pt=new o.P(ct.anchorX,ct.anchorY),Ct={getElevation:Ce,width:C.width,height:C.height,pitchedLabelPlaneMatrix:N,pitchWithMap:m,transform:C,tileAnchorPoint:Pt,translation:ue,unwrappedTileID:ge},Ot=m?Wi(Pt.x,Pt.y,Ct):Mi(Pt.x,Pt.y,Ct),Bt=pt(C.cameraToCenterDistance,Ot.signedDistanceFromCamera);let At=o.ap(R.textSizeData,Y,ct)*Bt/o.aB;m&&(At*=R.tilePixelRatio/j);const{width:qt,height:Sr,anchor:fr,textOffset:dr,textBoxScale:mr}=xt,tn=ap(fr,qt,Sr,dr,mr,At),nn=C.getPitchedTextCorrection(Pt.x+ue[0],Pt.y+ue[1],ge),qr=ey(Ot.point,Ct,l,tn,-C.bearingInRadians,nn),Ln=R.allowVerticalPlacement&&ct.placedOrientation===o.ao.vertical?Math.PI/2:0;for(let Pi=0;Pi<ct.numGlyphs;Pi++)o.av(Fe,qr,Ln);te&&ct.associatedIconIndex>=0&&(ut[ct.associatedIconIndex]={shiftedAnchor:qr,angle:Ln})}else Ka(ct.numGlyphs,Fe)}if(te){Ge.clear();const lt=R.icon.placedSymbolArray;for(let ct=0;ct<lt.length;ct++){const xt=lt.get(ct);if(xt.hidden)Ka(xt.numGlyphs,Ge);else{const Pt=ut[ct];if(Pt)for(let Ct=0;Ct<xt.numGlyphs;Ct++)o.av(Ge,Pt.shiftedAnchor,Pt.angle);else Ka(xt.numGlyphs,Ge)}}R.icon.dynamicLayoutVertexBuffer.updateData(Ge)}R.text.dynamicLayoutVertexBuffer.updateData(Fe)}function _f(R,l,m){return m.iconsInText&&l?"symbolTextAndIcon":R?"symbolSDF":"symbolIcon"}function ch(R,l,m,w,C,N,j,Y,te,ue,ge,Ce,Se){const Fe=R.context,Ge=Fe.gl,ut=R.transform,lt=Y==="map",ct=te==="map",xt=Y!=="viewport"&&m.layout.get("symbol-placement")!=="point",Pt=lt&&!ct&&!xt,Ct=!m.layout.get("symbol-sort-key").isConstant();let Ot=!1;const Bt=R.getDepthModeForSublayer(0,Nn.ReadOnly),At=m._unevaluatedLayout.hasValue("text-variable-anchor")||m._unevaluatedLayout.hasValue("text-variable-anchor-offset"),qt=[],Sr=ut.getCircleRadiusCorrection();for(const fr of w){const dr=l.getTile(fr),mr=dr.getBucket(m);if(!mr)continue;const tn=C?mr.text:mr.icon;if(!tn||!tn.segments.get().length||!tn.hasVisibleVertices)continue;const nn=tn.programConfigurations.get(m.id),qr=C||mr.sdfIcons,Ln=C?mr.textSizeData:mr.iconSizeData,Pi=ct||ut.pitch!==0,Xi=R.useProgram(_f(qr,C,mr),nn),da=o.an(Ln,ut.zoom),oa=R.style.map.terrain&&R.style.map.terrain.getTerrainData(fr);let ua,ba,ci,ca,ko=[0,0],rs=null;if(C)ba=dr.glyphAtlasTexture,ci=Ge.LINEAR,ua=dr.glyphAtlasTexture.size,mr.iconsInText&&(ko=dr.imageAtlasTexture.size,rs=dr.imageAtlasTexture,ca=Pi||R.options.rotating||R.options.zooming||Ln.kind==="composite"||Ln.kind==="camera"?Ge.LINEAR:Ge.NEAREST);else{const As=m.layout.get("icon-size").constantOr(0)!==1||mr.iconsNeedLinear;ba=dr.imageAtlasTexture,ci=qr||R.options.rotating||R.options.zooming||As||Pi?Ge.LINEAR:Ge.NEAREST,ua=dr.imageAtlasTexture.size}const Cs=o.aC(dr,1,R.transform.zoom),$s=ri(lt,R.transform,Cs),lu=o.L();o.aq(lu,$s);const Af=Ae(ct,lt,R.transform,Cs),If=o.aD(ut,dr,N,j),fp=ut.getProjectionData({overscaledTileID:fr,applyGlobeMatrix:!Se,applyTerrainMatrix:!0}),dp=At&&mr.hasTextData(),yd=m.layout.get("icon-text-fit")!=="none"&&dp&&mr.hasIconData();if(xt){const As=R.style.map.terrain?(fc,Is)=>R.style.map.terrain.getElevation(fr,fc,Is):null,qs=m.layout.get("text-rotation-alignment")==="map";Fr(mr,R,C,$s,lu,ct,ue,qs,fr.toUnwrapped(),ut.width,ut.height,If,As)}const vd=C&&At||yd,Iu=xt||vd?ip:ct?$s:R.transform.clipSpaceToPixelsMatrix,Fc=qr&&m.paint.get(C?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let uu;uu=qr?mr.iconsInText?il(Ln.kind,da,Pt,ct,xt,vd,R,Iu,Af,If,ua,ko,Sr):Tu(Ln.kind,da,Pt,ct,xt,vd,R,Iu,Af,If,C,ua,0,Sr):ya(Ln.kind,da,Pt,ct,xt,vd,R,Iu,Af,If,C,ua,Sr);const Pf={program:Xi,buffers:tn,uniformValues:uu,projectionData:fp,atlasTexture:ba,atlasTextureIcon:rs,atlasInterpolation:ci,atlasInterpolationIcon:ca,isSDF:qr,hasHalo:Fc};if(Ct&&mr.canOverlap){Ot=!0;const As=tn.segments.get();for(const qs of As)qt.push({segments:new o.aM([qs]),sortKey:qs.sortKey,state:Pf,terrainData:oa})}else qt.push({segments:tn.segments,sortKey:0,state:Pf,terrainData:oa})}Ot&&qt.sort(((fr,dr)=>fr.sortKey-dr.sortKey));for(const fr of qt){const dr=fr.state;if(Fe.activeTexture.set(Ge.TEXTURE0),dr.atlasTexture.bind(dr.atlasInterpolation,Ge.CLAMP_TO_EDGE),dr.atlasTextureIcon&&(Fe.activeTexture.set(Ge.TEXTURE1),dr.atlasTextureIcon&&dr.atlasTextureIcon.bind(dr.atlasInterpolationIcon,Ge.CLAMP_TO_EDGE)),dr.isSDF){const mr=dr.uniformValues;dr.hasHalo&&(mr.u_is_halo=1,Bh(dr.buffers,fr.segments,m,R,dr.program,Bt,ge,Ce,mr,dr.projectionData,fr.terrainData)),mr.u_is_halo=0}Bh(dr.buffers,fr.segments,m,R,dr.program,Bt,ge,Ce,dr.uniformValues,dr.projectionData,fr.terrainData)}}function Bh(R,l,m,w,C,N,j,Y,te,ue,ge){const Ce=w.context;C.draw(Ce,Ce.gl.TRIANGLES,N,j,Y,Un.backCCW,te,ge,ue,m.id,R.layoutVertexBuffer,R.indexBuffer,l,m.paint,w.transform.zoom,R.programConfigurations.get(m.id),R.dynamicLayoutVertexBuffer,R.opacityVertexBuffer)}function dg(R,l,m,w,C){const N=R.context,j=N.gl,Y=Yn.disabled,te=new jn([j.ONE,j.ONE],o.bf.transparent,[!0,!0,!0,!0]),ue=l.getBucket(m);if(!ue)return;const ge=w.key;let Ce=m.heatmapFbos.get(ge);Ce||(Ce=bf(N,l.tileSize,l.tileSize),m.heatmapFbos.set(ge,Ce)),N.bindFramebuffer.set(Ce.framebuffer),N.viewport.set([0,0,l.tileSize,l.tileSize]),N.clear({color:o.bf.transparent});const Se=ue.programConfigurations.get(m.id),Fe=R.useProgram("heatmap",Se,!C),Ge=R.transform.getProjectionData({overscaledTileID:l.tileID,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),ut=R.style.map.terrain.getTerrainData(w);Fe.draw(N,j.TRIANGLES,Nn.disabled,Y,te,Un.disabled,au(l,R.transform.zoom,m.paint.get("heatmap-intensity"),1),ut,Ge,m.id,ue.layoutVertexBuffer,ue.indexBuffer,ue.segments,m.paint,R.transform.zoom,Se)}function ty(R,l,m,w,C){const N=R.context,j=N.gl,Y=R.transform;N.setColorMode(R.colorModeForRenderPass());const te=dd(N,l),ue=m.key,ge=l.heatmapFbos.get(ue);if(!ge)return;N.activeTexture.set(j.TEXTURE0),j.bindTexture(j.TEXTURE_2D,ge.colorAttachment.get()),N.activeTexture.set(j.TEXTURE1),te.bind(j.LINEAR,j.CLAMP_TO_EDGE);const Ce=Y.getProjectionData({overscaledTileID:m,applyTerrainMatrix:C,applyGlobeMatrix:!w});R.useProgram("heatmapTexture").draw(N,j.TRIANGLES,Nn.disabled,Yn.disabled,R.colorModeForRenderPass(),Un.disabled,Wa(R,l,0,1),null,Ce,l.id,R.rasterBoundsBuffer,R.quadTriangleIndexBuffer,R.rasterBoundsSegments,l.paint,Y.zoom),ge.destroy(),l.heatmapFbos.delete(ue)}function bf(R,l,m){var w,C;const N=R.gl,j=N.createTexture();N.bindTexture(N.TEXTURE_2D,j),N.texParameteri(N.TEXTURE_2D,N.TEXTURE_WRAP_S,N.CLAMP_TO_EDGE),N.texParameteri(N.TEXTURE_2D,N.TEXTURE_WRAP_T,N.CLAMP_TO_EDGE),N.texParameteri(N.TEXTURE_2D,N.TEXTURE_MIN_FILTER,N.LINEAR),N.texParameteri(N.TEXTURE_2D,N.TEXTURE_MAG_FILTER,N.LINEAR);const Y=(w=R.HALF_FLOAT)!==null&&w!==void 0?w:N.UNSIGNED_BYTE,te=(C=R.RGBA16F)!==null&&C!==void 0?C:N.RGBA;N.texImage2D(N.TEXTURE_2D,0,te,l,m,0,N.RGBA,Y,null);const ue=R.createFramebuffer(l,m,!1,!1);return ue.colorAttachment.set(j),ue}function dd(R,l){return l.colorRampTexture||(l.colorRampTexture=new o.T(R,l.colorRamp,R.gl.RGBA)),l.colorRampTexture}function pd(R,l,m,w,C){if(!m||!w||!w.imageAtlas)return;const N=w.imageAtlas.patternPositions;let j=N[m.to.toString()],Y=N[m.from.toString()];if(!j&&Y&&(j=Y),!Y&&j&&(Y=j),!j||!Y){const te=C.getPaintProperty(l);j=N[te],Y=N[te]}j&&Y&&R.setConstantPatternPositions(j,Y)}function op(R,l,m,w,C,N,j,Y){const te=R.context.gl,ue="fill-pattern",ge=m.paint.get(ue),Ce=ge&&ge.constantOr(1),Se=m.getCrossfadeParameters();let Fe,Ge,ut,lt,ct;const xt=R.transform,Pt=m.paint.get("fill-translate"),Ct=m.paint.get("fill-translate-anchor");j?(Ge=Ce&&!m.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",Fe=te.LINES):(Ge=Ce?"fillPattern":"fill",Fe=te.TRIANGLES);const Ot=ge.constantOr(null);for(const Bt of w){const At=l.getTile(Bt);if(Ce&&!At.patternsLoaded())continue;const qt=At.getBucket(m);if(!qt)continue;const Sr=qt.programConfigurations.get(m.id),fr=R.useProgram(Ge,Sr),dr=R.style.map.terrain&&R.style.map.terrain.getTerrainData(Bt);Ce&&(R.context.activeTexture.set(te.TEXTURE0),At.imageAtlasTexture.bind(te.LINEAR,te.CLAMP_TO_EDGE),Sr.updatePaintBuffers(Se)),pd(Sr,ue,Ot,At,m);const mr=xt.getProjectionData({overscaledTileID:Bt,applyGlobeMatrix:!Y,applyTerrainMatrix:!0}),tn=o.aD(xt,At,Pt,Ct);if(j){lt=qt.indexBuffer2,ct=qt.segments2;const qr=[te.drawingBufferWidth,te.drawingBufferHeight];ut=Ge==="fillOutlinePattern"&&Ce?Yo(R,Se,At,qr,tn):Ba(qr,tn)}else lt=qt.indexBuffer,ct=qt.segments,ut=Ce?xo(R,Se,At,tn):{u_fill_translate:tn};const nn=R.stencilModeForClipping(Bt);fr.draw(R.context,Fe,C,nn,N,Un.backCCW,ut,dr,mr,m.id,qt.layoutVertexBuffer,lt,ct,m.paint,R.transform.zoom,Sr)}}function pg(R,l,m,w,C,N,j,Y){const te=R.context,ue=te.gl,ge="fill-extrusion-pattern",Ce=m.paint.get(ge),Se=Ce.constantOr(1),Fe=m.getCrossfadeParameters(),Ge=m.paint.get("fill-extrusion-opacity"),ut=Ce.constantOr(null),lt=R.transform;for(const ct of w){const xt=l.getTile(ct),Pt=xt.getBucket(m);if(!Pt)continue;const Ct=R.style.map.terrain&&R.style.map.terrain.getTerrainData(ct),Ot=Pt.programConfigurations.get(m.id),Bt=R.useProgram(Se?"fillExtrusionPattern":"fillExtrusion",Ot);Se&&(R.context.activeTexture.set(ue.TEXTURE0),xt.imageAtlasTexture.bind(ue.LINEAR,ue.CLAMP_TO_EDGE),Ot.updatePaintBuffers(Fe));const At=lt.getProjectionData({overscaledTileID:ct,applyGlobeMatrix:!Y,applyTerrainMatrix:!0});pd(Ot,ge,ut,xt,m);const qt=o.aD(lt,xt,m.paint.get("fill-extrusion-translate"),m.paint.get("fill-extrusion-translate-anchor")),Sr=m.paint.get("fill-extrusion-vertical-gradient"),fr=Se?eo(R,Sr,Ge,qt,ct,Fe,xt):co(R,Sr,Ge,qt);Bt.draw(te,te.gl.TRIANGLES,C,N,j,Un.backCCW,fr,Ct,At,m.id,Pt.layoutVertexBuffer,Pt.indexBuffer,Pt.segments,m.paint,R.transform.zoom,Ot,R.style.map.terrain&&Pt.centroidVertexBuffer)}}function zh(R,l,m,w,C,N,j,Y,te){var ue;const ge=R.style.projection,Ce=R.context,Se=R.transform,Fe=Ce.gl,Ge=[`#define NUM_ILLUMINATION_SOURCES ${m.paint.get("hillshade-highlight-color").values.length}`],ut=R.useProgram("hillshade",null,!1,Ge),lt=!R.options.moving;for(const ct of w){const xt=l.getTile(ct),Pt=xt.fbo;if(!Pt)continue;const Ct=ge.getMeshFromTileID(Ce,ct.canonical,Y,!0,"raster"),Ot=(ue=R.style.map.terrain)===null||ue===void 0?void 0:ue.getTerrainData(ct);Ce.activeTexture.set(Fe.TEXTURE0),Fe.bindTexture(Fe.TEXTURE_2D,Pt.colorAttachment.get());const Bt=Se.getProjectionData({overscaledTileID:ct,aligned:lt,applyGlobeMatrix:!te,applyTerrainMatrix:!0});ut.draw(Ce,Fe.TRIANGLES,N,C[ct.overscaledZ],j,Un.backCCW,Fs(R,xt,m),Ot,Bt,m.id,Ct.vertexBuffer,Ct.indexBuffer,Ct.segments)}}function gd(R,l,m,w,C,N,j,Y,te){var ue;const ge=R.style.projection,Ce=R.context,Se=R.transform,Fe=Ce.gl,Ge=R.useProgram("colorRelief"),ut=!R.options.moving;let lt=!0,ct=0;for(const xt of w){const Pt=l.getTile(xt),Ct=Pt.dem;if(lt){const fr=Fe.getParameter(Fe.MAX_TEXTURE_SIZE),{elevationTexture:dr,colorTexture:mr}=m.getColorRampTextures(Ce,fr,Ct.getUnpackVector());Ce.activeTexture.set(Fe.TEXTURE1),dr.bind(Fe.NEAREST,Fe.CLAMP_TO_EDGE),Ce.activeTexture.set(Fe.TEXTURE4),mr.bind(Fe.LINEAR,Fe.CLAMP_TO_EDGE),lt=!1,ct=dr.size[0]}if(!Ct||!Ct.data)continue;const Ot=Ct.stride,Bt=Ct.getPixels();if(Ce.activeTexture.set(Fe.TEXTURE0),Ce.pixelStoreUnpackPremultiplyAlpha.set(!1),Pt.demTexture=Pt.demTexture||R.getTileTexture(Ot),Pt.demTexture){const fr=Pt.demTexture;fr.update(Bt,{premultiply:!1}),fr.bind(Fe.LINEAR,Fe.CLAMP_TO_EDGE)}else Pt.demTexture=new o.T(Ce,Bt,Fe.RGBA,{premultiply:!1}),Pt.demTexture.bind(Fe.LINEAR,Fe.CLAMP_TO_EDGE);const At=ge.getMeshFromTileID(Ce,xt.canonical,Y,!0,"raster"),qt=(ue=R.style.map.terrain)===null||ue===void 0?void 0:ue.getTerrainData(xt),Sr=Se.getProjectionData({overscaledTileID:xt,aligned:ut,applyGlobeMatrix:!te,applyTerrainMatrix:!0});Ge.draw(Ce,Fe.TRIANGLES,N,C[xt.overscaledZ],j,Un.backCCW,wl(m,Pt.dem,ct),qt,Sr,m.id,At.vertexBuffer,At.indexBuffer,At.segments)}}const xf=[new o.P(0,0),new o.P(o.$,0),new o.P(o.$,o.$),new o.P(0,o.$)];function Xu(R,l,m,w,C,N,j,Y,te=!1,ue=!1){const ge=w[w.length-1].overscaledZ,Ce=R.context,Se=Ce.gl,Fe=R.useProgram("raster"),Ge=R.transform,ut=R.style.projection,lt=R.colorModeForRenderPass(),ct=!R.options.moving;for(const xt of w){const Pt=R.getDepthModeForSublayer(xt.overscaledZ-ge,m.paint.get("raster-opacity")===1?Nn.ReadWrite:Nn.ReadOnly,Se.LESS),Ct=l.getTile(xt);Ct.registerFadeDuration(m.paint.get("raster-fade-duration"));const Ot=l.findLoadedParent(xt,0),Bt=l.findLoadedSibling(xt),At=gg(Ct,Ot||Bt||null,l,m,R.transform,R.style.map.terrain);let qt,Sr;const fr=m.paint.get("raster-resampling")==="nearest"?Se.NEAREST:Se.LINEAR;Ce.activeTexture.set(Se.TEXTURE0),Ct.texture.bind(fr,Se.CLAMP_TO_EDGE,Se.LINEAR_MIPMAP_NEAREST),Ce.activeTexture.set(Se.TEXTURE1),Ot?(Ot.texture.bind(fr,Se.CLAMP_TO_EDGE,Se.LINEAR_MIPMAP_NEAREST),qt=Math.pow(2,Ot.tileID.overscaledZ-Ct.tileID.overscaledZ),Sr=[Ct.tileID.canonical.x*qt%1,Ct.tileID.canonical.y*qt%1]):Ct.texture.bind(fr,Se.CLAMP_TO_EDGE,Se.LINEAR_MIPMAP_NEAREST),Ct.texture.useMipmap&&Ce.extTextureFilterAnisotropic&&R.transform.pitch>20&&Se.texParameterf(Se.TEXTURE_2D,Ce.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,Ce.extTextureFilterAnisotropicMax);const dr=R.style.map.terrain&&R.style.map.terrain.getTerrainData(xt),mr=Ge.getProjectionData({overscaledTileID:xt,aligned:ct,applyGlobeMatrix:!ue,applyTerrainMatrix:!0}),tn=hs(Sr||[0,0],qt||1,At,m,Y),nn=ut.getMeshFromTileID(Ce,xt.canonical,N,j,"raster");Fe.draw(Ce,Se.TRIANGLES,Pt,C?C[xt.overscaledZ]:Yn.disabled,lt,te?Un.frontCCW:Un.backCCW,tn,dr,mr,m.id,nn.vertexBuffer,nn.indexBuffer,nn.segments)}}function gg(R,l,m,w,C,N){const j=w.paint.get("raster-fade-duration");if(!N&&j>0){const Y=b.now(),te=(Y-R.timeAdded)/j,ue=l?(Y-l.timeAdded)/j:-1,ge=m.getSource(),Ce=Rr(C,{tileSize:ge.tileSize,roundZoom:ge.roundZoom}),Se=!l||Math.abs(l.tileID.overscaledZ-Ce)>Math.abs(R.tileID.overscaledZ-Ce),Fe=Se&&R.refreshedUponExpiration?1:o.ah(Se?te:1-ue,0,1);return R.refreshedUponExpiration&&te>=1&&(R.refreshedUponExpiration=!1),l?{opacity:1,mix:1-Fe}:{opacity:Fe,mix:0}}return{opacity:1,mix:0}}const ry=new o.bf(1,0,0,1),mg=new o.bf(0,1,0,1),sp=new o.bf(0,0,1,1),yg=new o.bf(1,0,1,1),Y0=new o.bf(0,1,1,1);function vg(R,l,m,w){Ko(R,0,l+m/2,R.transform.width,m,w)}function va(R,l,m,w){Ko(R,l-m/2,0,m,R.transform.height,w)}function Ko(R,l,m,w,C,N){const j=R.context,Y=j.gl;Y.enable(Y.SCISSOR_TEST),Y.scissor(l*R.pixelRatio,m*R.pixelRatio,w*R.pixelRatio,C*R.pixelRatio),j.clear({color:N}),Y.disable(Y.SCISSOR_TEST)}function Jo(R,l,m){const w=R.context,C=w.gl,N=R.useProgram("debug"),j=Nn.disabled,Y=Yn.disabled,te=R.colorModeForRenderPass(),ue="$debug",ge=R.style.map.terrain&&R.style.map.terrain.getTerrainData(m);w.activeTexture.set(C.TEXTURE0);const Ce=l.getTileByID(m.key).latestRawTileData,Se=Math.floor((Ce&&Ce.byteLength||0)/1024),Fe=l.getTile(m).tileSize,Ge=512/Math.min(Fe,512)*(m.overscaledZ/R.transform.zoom)*.5;let ut=m.canonical.toString();m.overscaledZ!==m.canonical.z&&(ut+=` => ${m.overscaledZ}`),(function(ct,xt){ct.initDebugOverlayCanvas();const Pt=ct.debugOverlayCanvas,Ct=ct.context.gl,Ot=ct.debugOverlayCanvas.getContext("2d");Ot.clearRect(0,0,Pt.width,Pt.height),Ot.shadowColor="white",Ot.shadowBlur=2,Ot.lineWidth=1.5,Ot.strokeStyle="white",Ot.textBaseline="top",Ot.font="bold 36px Open Sans, sans-serif",Ot.fillText(xt,5,5),Ot.strokeText(xt,5,5),ct.debugOverlayTexture.update(Pt),ct.debugOverlayTexture.bind(Ct.LINEAR,Ct.CLAMP_TO_EDGE)})(R,`${ut} ${Se}kB`);const lt=R.transform.getProjectionData({overscaledTileID:m,applyGlobeMatrix:!0,applyTerrainMatrix:!0});N.draw(w,C.TRIANGLES,j,Y,jn.alphaBlended,Un.disabled,cs(o.bf.transparent,Ge),null,lt,ue,R.debugBuffer,R.quadTriangleIndexBuffer,R.debugSegments),N.draw(w,C.LINE_STRIP,j,Y,te,Un.disabled,cs(o.bf.red),ge,lt,ue,R.debugBuffer,R.tileBorderIndexBuffer,R.debugSegments)}function lp(R,l,m,w){const{isRenderingGlobe:C}=w,N=R.context,j=N.gl,Y=R.transform,te=R.colorModeForRenderPass(),ue=R.getDepthModeFor3D(),ge=R.useProgram("terrain");N.bindFramebuffer.set(null),N.viewport.set([0,0,R.width,R.height]);for(const Ce of m){const Se=l.getTerrainMesh(Ce.tileID),Fe=R.renderToTexture.getTexture(Ce),Ge=l.getTerrainData(Ce.tileID);N.activeTexture.set(j.TEXTURE0),j.bindTexture(j.TEXTURE_2D,Fe.texture);const ut=l.getMeshFrameDelta(Y.zoom),lt=Y.calculateFogMatrix(Ce.tileID.toUnwrapped()),ct=Fo(ut,lt,R.style.sky,Y.pitch,C),xt=Y.getProjectionData({overscaledTileID:Ce.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0});ge.draw(N,j.TRIANGLES,ue,Yn.disabled,te,Un.backCCW,ct,Ge,xt,"terrain",Se.vertexBuffer,Se.indexBuffer,Se.segments)}}function wf(R,l){if(!l.mesh){const m=new o.aL;m.emplaceBack(-1,-1),m.emplaceBack(1,-1),m.emplaceBack(1,1),m.emplaceBack(-1,1);const w=new o.aN;w.emplaceBack(0,1,2),w.emplaceBack(0,2,3),l.mesh=new Gt(R.createVertexBuffer(m,$r.members),R.createIndexBuffer(w),o.aM.simpleSegment(0,0,m.length,w.length))}return l.mesh}class Lc{constructor(l,m){this.context=new uh(l),this.transform=m,this._tileTextures={},this.terrainFacilitator={dirty:!0,matrix:o.ag(new Float64Array(16)),renderTime:0},this.setup(),this.numSublayers=Ur.maxUnderzooming+Ur.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new Xe}resize(l,m,w){if(this.width=Math.floor(l*w),this.height=Math.floor(m*w),this.pixelRatio=w,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const C of this.style._order)this.style._layers[C].resize()}setup(){const l=this.context,m=new o.aL;m.emplaceBack(0,0),m.emplaceBack(o.$,0),m.emplaceBack(0,o.$),m.emplaceBack(o.$,o.$),this.tileExtentBuffer=l.createVertexBuffer(m,$r.members),this.tileExtentSegments=o.aM.simpleSegment(0,0,4,2);const w=new o.aL;w.emplaceBack(0,0),w.emplaceBack(o.$,0),w.emplaceBack(0,o.$),w.emplaceBack(o.$,o.$),this.debugBuffer=l.createVertexBuffer(w,$r.members),this.debugSegments=o.aM.simpleSegment(0,0,4,5);const C=new o.c6;C.emplaceBack(0,0,0,0),C.emplaceBack(o.$,0,o.$,0),C.emplaceBack(0,o.$,0,o.$),C.emplaceBack(o.$,o.$,o.$,o.$),this.rasterBoundsBuffer=l.createVertexBuffer(C,nl.members),this.rasterBoundsSegments=o.aM.simpleSegment(0,0,4,2);const N=new o.aL;N.emplaceBack(0,0),N.emplaceBack(o.$,0),N.emplaceBack(0,o.$),N.emplaceBack(o.$,o.$),this.rasterBoundsBufferPosOnly=l.createVertexBuffer(N,$r.members),this.rasterBoundsSegmentsPosOnly=o.aM.simpleSegment(0,0,4,5);const j=new o.aL;j.emplaceBack(0,0),j.emplaceBack(1,0),j.emplaceBack(0,1),j.emplaceBack(1,1),this.viewportBuffer=l.createVertexBuffer(j,$r.members),this.viewportSegments=o.aM.simpleSegment(0,0,4,2);const Y=new o.c7;Y.emplaceBack(0),Y.emplaceBack(1),Y.emplaceBack(3),Y.emplaceBack(2),Y.emplaceBack(0),this.tileBorderIndexBuffer=l.createIndexBuffer(Y);const te=new o.aN;te.emplaceBack(1,0,2),te.emplaceBack(1,2,3),this.quadTriangleIndexBuffer=l.createIndexBuffer(te);const ue=this.context.gl;this.stencilClearMode=new Yn({func:ue.ALWAYS,mask:0},0,255,ue.ZERO,ue.ZERO,ue.ZERO),this.tileExtentMesh=new Gt(this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}clearStencil(){const l=this.context,m=l.gl;this.nextStencilID=1,this.currentStencilSource=void 0;const w=o.L();o.bY(w,0,this.width,this.height,0,0,1),o.N(w,w,[m.drawingBufferWidth,m.drawingBufferHeight,0]);const C={mainMatrix:w,tileMercatorCoords:[0,0,1,1],clippingPlane:[0,0,0,0],projectionTransition:0,fallbackMatrix:w};this.useProgram("clippingMask",null,!0).draw(l,m.TRIANGLES,Nn.disabled,this.stencilClearMode,jn.disabled,Un.disabled,null,null,C,"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}_renderTileClippingMasks(l,m,w){if(this.currentStencilSource===l.source||!l.isTileClipped()||!m||!m.length)return;this.currentStencilSource=l.source,this.nextStencilID+m.length>256&&this.clearStencil();const C=this.context;C.setColorMode(jn.disabled),C.setDepthMode(Nn.disabled);const N={};for(const j of m)N[j.key]=this.nextStencilID++;this._renderTileMasks(N,m,w,!0),this._renderTileMasks(N,m,w,!1),this._tileClippingMaskIDs=N}_renderTileMasks(l,m,w,C){const N=this.context,j=N.gl,Y=this.style.projection,te=this.transform,ue=this.useProgram("clippingMask");for(const ge of m){const Ce=l[ge.key],Se=this.style.map.terrain&&this.style.map.terrain.getTerrainData(ge),Fe=Y.getMeshFromTileID(this.context,ge.canonical,C,!0,"stencil"),Ge=te.getProjectionData({overscaledTileID:ge,applyGlobeMatrix:!w,applyTerrainMatrix:!0});ue.draw(N,j.TRIANGLES,Nn.disabled,new Yn({func:j.ALWAYS,mask:0},Ce,255,j.KEEP,j.KEEP,j.REPLACE),jn.disabled,w?Un.disabled:Un.backCCW,null,Se,Ge,"$clipping",Fe.vertexBuffer,Fe.indexBuffer,Fe.segments)}}_renderTilesDepthBuffer(){const l=this.context,m=l.gl,w=this.style.projection,C=this.transform,N=this.useProgram("depth"),j=this.getDepthModeFor3D(),Y=bt(C,{tileSize:C.tileSize});for(const te of Y){const ue=this.style.map.terrain&&this.style.map.terrain.getTerrainData(te),ge=w.getMeshFromTileID(this.context,te.canonical,!0,!0,"raster"),Ce=C.getProjectionData({overscaledTileID:te,applyGlobeMatrix:!0,applyTerrainMatrix:!0});N.draw(l,m.TRIANGLES,j,Yn.disabled,jn.disabled,Un.backCCW,null,ue,Ce,"$clipping",ge.vertexBuffer,ge.indexBuffer,ge.segments)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const l=this.nextStencilID++,m=this.context.gl;return new Yn({func:m.NOTEQUAL,mask:255},l,255,m.KEEP,m.KEEP,m.REPLACE)}stencilModeForClipping(l){const m=this.context.gl;return new Yn({func:m.EQUAL,mask:255},this._tileClippingMaskIDs[l.key],0,m.KEEP,m.KEEP,m.REPLACE)}getStencilConfigForOverlapAndUpdateStencilID(l){const m=this.context.gl,w=l.sort(((j,Y)=>Y.overscaledZ-j.overscaledZ)),C=w[w.length-1].overscaledZ,N=w[0].overscaledZ-C+1;if(N>1){this.currentStencilSource=void 0,this.nextStencilID+N>256&&this.clearStencil();const j={};for(let Y=0;Y<N;Y++)j[Y+C]=new Yn({func:m.GEQUAL,mask:255},Y+this.nextStencilID,255,m.KEEP,m.KEEP,m.REPLACE);return this.nextStencilID+=N,[j,w]}return[{[C]:Yn.disabled},w]}stencilConfigForOverlapTwoPass(l){const m=this.context.gl,w=l.sort(((j,Y)=>Y.overscaledZ-j.overscaledZ)),C=w[w.length-1].overscaledZ,N=w[0].overscaledZ-C+1;if(this.clearStencil(),N>1){const j={},Y={};for(let te=0;te<N;te++)j[te+C]=new Yn({func:m.GREATER,mask:255},N+1+te,255,m.KEEP,m.KEEP,m.REPLACE),Y[te+C]=new Yn({func:m.GREATER,mask:255},1+te,255,m.KEEP,m.KEEP,m.REPLACE);return this.nextStencilID=2*N+1,[j,Y,w]}return this.nextStencilID=3,[{[C]:new Yn({func:m.GREATER,mask:255},2,255,m.KEEP,m.KEEP,m.REPLACE)},{[C]:new Yn({func:m.GREATER,mask:255},1,255,m.KEEP,m.KEEP,m.REPLACE)},w]}colorModeForRenderPass(){const l=this.context.gl;return this._showOverdrawInspector?new jn([l.CONSTANT_COLOR,l.ONE],new o.bf(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?jn.unblended:jn.alphaBlended}getDepthModeForSublayer(l,m,w){if(!this.opaquePassEnabledForLayer())return Nn.disabled;const C=1-((1+this.currentLayer)*this.numSublayers+l)*this.depthEpsilon;return new Nn(w||this.context.gl.LEQUAL,m,[C,C])}getDepthModeFor3D(){return new Nn(this.context.gl.LEQUAL,Nn.ReadWrite,this.depthRangeFor3D)}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(l,m){var w,C;this.style=l,this.options=m,this.lineAtlas=l.lineAtlas,this.imageManager=l.imageManager,this.glyphManager=l.glyphManager,this.symbolFadeChange=l.placement.symbolFadeChange(b.now()),this.imageManager.beginFrame();const N=this.style._order,j=this.style.sourceCaches,Y={},te={},ue={},ge={isRenderingToTexture:!1,isRenderingGlobe:((w=l.projection)===null||w===void 0?void 0:w.transitionState)>0};for(const Se in j){const Fe=j[Se];Fe.used&&Fe.prepare(this.context),Y[Se]=Fe.getVisibleCoordinates(!1),te[Se]=Y[Se].slice().reverse(),ue[Se]=Fe.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let Se=0;Se<N.length;Se++)if(this.style._layers[N[Se]].is3D()){this.opaquePassCutoff=Se;break}this.maybeDrawDepthAndCoords(!1),this.renderToTexture&&(this.renderToTexture.prepareForRender(this.style,this.transform.zoom),this.opaquePassCutoff=0),this.renderPass="offscreen";for(const Se of N){const Fe=this.style._layers[Se];if(!Fe.hasOffscreenPass()||Fe.isHidden(this.transform.zoom))continue;const Ge=te[Fe.source];(Fe.type==="custom"||Ge.length)&&this.renderLayer(this,j[Fe.source],Fe,Ge,ge)}if((C=this.style.projection)===null||C===void 0||C.updateGPUdependent({context:this.context,useProgram:Se=>this.useProgram(Se)}),this.context.viewport.set([0,0,this.width,this.height]),this.context.bindFramebuffer.set(null),this.context.clear({color:m.showOverdrawInspector?o.bf.black:o.bf.transparent,depth:1}),this.clearStencil(),this.style.sky&&(function(Se,Fe){const Ge=Se.context,ut=Ge.gl,lt=((Bt,At,qt)=>{const Sr=Math.cos(At.rollInRadians),fr=Math.sin(At.rollInRadians),dr=ot(At),mr=At.getProjectionData({overscaledTileID:null,applyGlobeMatrix:!0,applyTerrainMatrix:!0}).projectionTransition;return{u_sky_color:Bt.properties.get("sky-color"),u_horizon_color:Bt.properties.get("horizon-color"),u_horizon:[(At.width/2-dr*fr)*qt,(At.height/2+dr*Sr)*qt],u_horizon_normal:[-fr,Sr],u_sky_horizon_blend:Bt.properties.get("sky-horizon-blend")*At.height/2*qt,u_sky_blend:mr}})(Fe,Se.style.map.transform,Se.pixelRatio),ct=new Nn(ut.LEQUAL,Nn.ReadWrite,[0,1]),xt=Yn.disabled,Pt=Se.colorModeForRenderPass(),Ct=Se.useProgram("sky"),Ot=wf(Ge,Fe);Ct.draw(Ge,ut.TRIANGLES,ct,xt,Pt,Un.disabled,lt,null,void 0,"sky",Ot.vertexBuffer,Ot.indexBuffer,Ot.segments)})(this,this.style.sky),this._showOverdrawInspector=m.showOverdrawInspector,this.depthRangeFor3D=[0,1-(l._order.length+2)*this.numSublayers*this.depthEpsilon],!this.renderToTexture)for(this.renderPass="opaque",this.currentLayer=N.length-1;this.currentLayer>=0;this.currentLayer--){const Se=this.style._layers[N[this.currentLayer]],Fe=j[Se.source],Ge=Y[Se.source];this._renderTileClippingMasks(Se,Ge,!1),this.renderLayer(this,Fe,Se,Ge,ge)}this.renderPass="translucent";let Ce=!1;for(this.currentLayer=0;this.currentLayer<N.length;this.currentLayer++){const Se=this.style._layers[N[this.currentLayer]],Fe=j[Se.source];if(this.renderToTexture&&this.renderToTexture.renderLayer(Se,ge))continue;this.opaquePassEnabledForLayer()||Ce||(Ce=!0,ge.isRenderingGlobe&&!this.style.map.terrain&&this._renderTilesDepthBuffer());const Ge=(Se.type==="symbol"?ue:te)[Se.source];this._renderTileClippingMasks(Se,Y[Se.source],!!this.renderToTexture),this.renderLayer(this,Fe,Se,Ge,ge)}if(ge.isRenderingGlobe&&(function(Se,Fe,Ge){const ut=Se.context,lt=ut.gl,ct=Se.useProgram("atmosphere"),xt=new Nn(lt.LEQUAL,Nn.ReadOnly,[0,1]),Pt=Se.transform,Ct=(function(mr,tn){const nn=mr.properties.get("position"),qr=[-nn.x,-nn.y,-nn.z],Ln=o.ag(new Float64Array(16));return mr.properties.get("anchor")==="map"&&(o.b6(Ln,Ln,tn.rollInRadians),o.b7(Ln,Ln,-tn.pitchInRadians),o.b6(Ln,Ln,tn.bearingInRadians),o.b7(Ln,Ln,tn.center.lat*Math.PI/180),o.bz(Ln,Ln,-tn.center.lng*Math.PI/180)),o.c5(qr,qr,Ln),qr})(Ge,Se.transform),Ot=Pt.getProjectionData({overscaledTileID:null,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),Bt=Fe.properties.get("atmosphere-blend")*Ot.projectionTransition;if(Bt===0)return;const At=Da(Pt.worldSize,Pt.center.lat),qt=Pt.inverseProjectionMatrix,Sr=new Float64Array(4);Sr[3]=1,o.aw(Sr,Sr,Pt.modelViewProjectionMatrix),Sr[0]/=Sr[3],Sr[1]/=Sr[3],Sr[2]/=Sr[3],Sr[3]=1,o.aw(Sr,Sr,qt),Sr[0]/=Sr[3],Sr[1]/=Sr[3],Sr[2]/=Sr[3],Sr[3]=1;const fr=((mr,tn,nn,qr,Ln)=>({u_sun_pos:mr,u_atmosphere_blend:tn,u_globe_position:nn,u_globe_radius:qr,u_inv_proj_matrix:Ln}))(Ct,Bt,[Sr[0],Sr[1],Sr[2]],At,qt),dr=wf(ut,Fe);ct.draw(ut,lt.TRIANGLES,xt,Yn.disabled,jn.alphaBlended,Un.disabled,fr,null,null,"atmosphere",dr.vertexBuffer,dr.indexBuffer,dr.segments)})(this,this.style.sky,this.style.light),this.options.showTileBoundaries){const Se=(function(Fe,Ge){let ut=null;const lt=Object.values(Fe._layers).flatMap((Ct=>Ct.source&&!Ct.isHidden(Ge)?[Fe.sourceCaches[Ct.source]]:[])),ct=lt.filter((Ct=>Ct.getSource().type==="vector")),xt=lt.filter((Ct=>Ct.getSource().type!=="vector")),Pt=Ct=>{(!ut||ut.getSource().maxzoom<Ct.getSource().maxzoom)&&(ut=Ct)};return ct.forEach((Ct=>Pt(Ct))),ut||xt.forEach((Ct=>Pt(Ct))),ut})(this.style,this.transform.zoom);Se&&(function(Fe,Ge,ut){for(let lt=0;lt<ut.length;lt++)Jo(Fe,Ge,ut[lt])})(this,Se,Se.getVisibleCoordinates())}this.options.showPadding&&(function(Se){const Fe=Se.transform.padding;vg(Se,Se.transform.height-(Fe.top||0),3,ry),vg(Se,Fe.bottom||0,3,mg),va(Se,Fe.left||0,3,sp),va(Se,Se.transform.width-(Fe.right||0),3,yg);const Ge=Se.transform.centerPoint;(function(ut,lt,ct,xt){Ko(ut,lt-1,ct-10,2,20,xt),Ko(ut,lt-10,ct-1,20,2,xt)})(Se,Ge.x,Se.transform.height-Ge.y,Y0)})(this),this.context.setDefault()}maybeDrawDepthAndCoords(l){if(!this.style||!this.style.map||!this.style.map.terrain)return;const m=this.terrainFacilitator.matrix,w=this.transform.modelViewProjectionMatrix;let C=this.terrainFacilitator.dirty;C||(C=l?!o.c8(m,w):!o.c9(m,w)),C||(C=this.style.map.terrain.sourceCache.anyTilesAfterTime(this.terrainFacilitator.renderTime)),C&&(o.ca(m,w),this.terrainFacilitator.renderTime=Date.now(),this.terrainFacilitator.dirty=!1,(function(N,j){const Y=N.context,te=Y.gl,ue=N.transform,ge=jn.unblended,Ce=new Nn(te.LEQUAL,Nn.ReadWrite,[0,1]),Se=j.sourceCache.getRenderableTiles(),Fe=N.useProgram("terrainDepth");Y.bindFramebuffer.set(j.getFramebuffer("depth").framebuffer),Y.viewport.set([0,0,N.width/devicePixelRatio,N.height/devicePixelRatio]),Y.clear({color:o.bf.transparent,depth:1});for(const Ge of Se){const ut=j.getTerrainMesh(Ge.tileID),lt=j.getTerrainData(Ge.tileID),ct=ue.getProjectionData({overscaledTileID:Ge.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0}),xt={u_ele_delta:j.getMeshFrameDelta(ue.zoom)};Fe.draw(Y,te.TRIANGLES,Ce,Yn.disabled,ge,Un.backCCW,xt,lt,ct,"terrain",ut.vertexBuffer,ut.indexBuffer,ut.segments)}Y.bindFramebuffer.set(null),Y.viewport.set([0,0,N.width,N.height])})(this,this.style.map.terrain),(function(N,j){const Y=N.context,te=Y.gl,ue=N.transform,ge=jn.unblended,Ce=new Nn(te.LEQUAL,Nn.ReadWrite,[0,1]),Se=j.getCoordsTexture(),Fe=j.sourceCache.getRenderableTiles(),Ge=N.useProgram("terrainCoords");Y.bindFramebuffer.set(j.getFramebuffer("coords").framebuffer),Y.viewport.set([0,0,N.width/devicePixelRatio,N.height/devicePixelRatio]),Y.clear({color:o.bf.transparent,depth:1}),j.coordsIndex=[];for(const ut of Fe){const lt=j.getTerrainMesh(ut.tileID),ct=j.getTerrainData(ut.tileID);Y.activeTexture.set(te.TEXTURE0),te.bindTexture(te.TEXTURE_2D,Se.texture);const xt={u_terrain_coords_id:(255-j.coordsIndex.length)/255,u_texture:0,u_ele_delta:j.getMeshFrameDelta(ue.zoom)},Pt=ue.getProjectionData({overscaledTileID:ut.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0});Ge.draw(Y,te.TRIANGLES,Ce,Yn.disabled,ge,Un.backCCW,xt,ct,Pt,"terrain",lt.vertexBuffer,lt.indexBuffer,lt.segments),j.coordsIndex.push(ut.tileID.key)}Y.bindFramebuffer.set(null),Y.viewport.set([0,0,N.width,N.height])})(this,this.style.map.terrain))}renderLayer(l,m,w,C,N){w.isHidden(this.transform.zoom)||(w.type==="background"||w.type==="custom"||(C||[]).length)&&(this.id=w.id,o.cb(w)?(function(j,Y,te,ue,ge,Ce){if(j.renderPass!=="translucent")return;const{isRenderingToTexture:Se}=Ce,Fe=Yn.disabled,Ge=j.colorModeForRenderPass();(te._unevaluatedLayout.hasValue("text-variable-anchor")||te._unevaluatedLayout.hasValue("text-variable-anchor-offset"))&&(function(ut,lt,ct,xt,Pt,Ct,Ot,Bt,At){const qt=lt.transform,Sr=lt.style.map.terrain,fr=Pt==="map",dr=Ct==="map";for(const mr of ut){const tn=xt.getTile(mr),nn=tn.getBucket(ct);if(!nn||!nn.text||!nn.text.segments.get().length)continue;const qr=o.an(nn.textSizeData,qt.zoom),Ln=o.aC(tn,1,lt.transform.zoom),Pi=ri(fr,lt.transform,Ln),Xi=ct.layout.get("icon-text-fit")!=="none"&&nn.hasIconData();if(qr){const da=Math.pow(2,qt.zoom-tn.tileID.overscaledZ),oa=Sr?(ua,ba)=>Sr.getElevation(mr,ua,ba):null;fd(nn,fr,dr,At,qt,Pi,da,qr,Xi,o.aD(qt,tn,Ot,Bt),mr.toUnwrapped(),oa)}}})(ue,j,te,Y,te.layout.get("text-rotation-alignment"),te.layout.get("text-pitch-alignment"),te.paint.get("text-translate"),te.paint.get("text-translate-anchor"),ge),te.paint.get("icon-opacity").constantOr(1)!==0&&ch(j,Y,te,ue,!1,te.paint.get("icon-translate"),te.paint.get("icon-translate-anchor"),te.layout.get("icon-rotation-alignment"),te.layout.get("icon-pitch-alignment"),te.layout.get("icon-keep-upright"),Fe,Ge,Se),te.paint.get("text-opacity").constantOr(1)!==0&&ch(j,Y,te,ue,!0,te.paint.get("text-translate"),te.paint.get("text-translate-anchor"),te.layout.get("text-rotation-alignment"),te.layout.get("text-pitch-alignment"),te.layout.get("text-keep-upright"),Fe,Ge,Se),Y.map.showCollisionBoxes&&(cc(j,Y,te,ue,!0),cc(j,Y,te,ue,!1))})(l,m,w,C,this.style.placement.variableOffsets,N):o.cc(w)?(function(j,Y,te,ue,ge){if(j.renderPass!=="translucent")return;const{isRenderingToTexture:Ce}=ge,Se=te.paint.get("circle-opacity"),Fe=te.paint.get("circle-stroke-width"),Ge=te.paint.get("circle-stroke-opacity"),ut=!te.layout.get("circle-sort-key").isConstant();if(Se.constantOr(1)===0&&(Fe.constantOr(1)===0||Ge.constantOr(1)===0))return;const lt=j.context,ct=lt.gl,xt=j.transform,Pt=j.getDepthModeForSublayer(0,Nn.ReadOnly),Ct=Yn.disabled,Ot=j.colorModeForRenderPass(),Bt=[],At=xt.getCircleRadiusCorrection();for(let qt=0;qt<ue.length;qt++){const Sr=ue[qt],fr=Y.getTile(Sr),dr=fr.getBucket(te);if(!dr)continue;const mr=te.paint.get("circle-translate"),tn=te.paint.get("circle-translate-anchor"),nn=o.aD(xt,fr,mr,tn),qr=dr.programConfigurations.get(te.id),Ln=j.useProgram("circle",qr),Pi=dr.layoutVertexBuffer,Xi=dr.indexBuffer,da=j.style.map.terrain&&j.style.map.terrain.getTerrainData(Sr),oa={programConfiguration:qr,program:Ln,layoutVertexBuffer:Pi,indexBuffer:Xi,uniformValues:Eu(j,fr,te,nn,At),terrainData:da,projectionData:xt.getProjectionData({overscaledTileID:Sr,applyGlobeMatrix:!Ce,applyTerrainMatrix:!0})};if(ut){const ua=dr.segments.get();for(const ba of ua)Bt.push({segments:new o.aM([ba]),sortKey:ba.sortKey,state:oa})}else Bt.push({segments:dr.segments,sortKey:0,state:oa})}ut&&Bt.sort(((qt,Sr)=>qt.sortKey-Sr.sortKey));for(const qt of Bt){const{programConfiguration:Sr,program:fr,layoutVertexBuffer:dr,indexBuffer:mr,uniformValues:tn,terrainData:nn,projectionData:qr}=qt.state;fr.draw(lt,ct.TRIANGLES,Pt,Ct,Ot,Un.backCCW,tn,nn,qr,te.id,dr,mr,qt.segments,te.paint,j.transform.zoom,Sr)}})(l,m,w,C,N):o.cd(w)?(function(j,Y,te,ue,ge){if(te.paint.get("heatmap-opacity")===0)return;const Ce=j.context,{isRenderingToTexture:Se,isRenderingGlobe:Fe}=ge;if(j.style.map.terrain){for(const Ge of ue){const ut=Y.getTile(Ge);Y.hasRenderableParent(Ge)||(j.renderPass==="offscreen"?dg(j,ut,te,Ge,Fe):j.renderPass==="translucent"&&ty(j,te,Ge,Se,Fe))}Ce.viewport.set([0,0,j.width,j.height])}else j.renderPass==="offscreen"?(function(Ge,ut,lt,ct){const xt=Ge.context,Pt=xt.gl,Ct=Ge.transform,Ot=Yn.disabled,Bt=new jn([Pt.ONE,Pt.ONE],o.bf.transparent,[!0,!0,!0,!0]);(function(At,qt,Sr){const fr=At.gl;At.activeTexture.set(fr.TEXTURE1),At.viewport.set([0,0,qt.width/4,qt.height/4]);let dr=Sr.heatmapFbos.get(o.c2);dr?(fr.bindTexture(fr.TEXTURE_2D,dr.colorAttachment.get()),At.bindFramebuffer.set(dr.framebuffer)):(dr=bf(At,qt.width/4,qt.height/4),Sr.heatmapFbos.set(o.c2,dr))})(xt,Ge,lt),xt.clear({color:o.bf.transparent});for(let At=0;At<ct.length;At++){const qt=ct[At];if(ut.hasRenderableParent(qt))continue;const Sr=ut.getTile(qt),fr=Sr.getBucket(lt);if(!fr)continue;const dr=fr.programConfigurations.get(lt.id),mr=Ge.useProgram("heatmap",dr),tn=Ct.getProjectionData({overscaledTileID:qt,applyGlobeMatrix:!0,applyTerrainMatrix:!1}),nn=Ct.getCircleRadiusCorrection();mr.draw(xt,Pt.TRIANGLES,Nn.disabled,Ot,Bt,Un.backCCW,au(Sr,Ct.zoom,lt.paint.get("heatmap-intensity"),nn),null,tn,lt.id,fr.layoutVertexBuffer,fr.indexBuffer,fr.segments,lt.paint,Ct.zoom,dr)}xt.viewport.set([0,0,Ge.width,Ge.height])})(j,Y,te,ue):j.renderPass==="translucent"&&(function(Ge,ut){const lt=Ge.context,ct=lt.gl;lt.setColorMode(Ge.colorModeForRenderPass());const xt=ut.heatmapFbos.get(o.c2);xt&&(lt.activeTexture.set(ct.TEXTURE0),ct.bindTexture(ct.TEXTURE_2D,xt.colorAttachment.get()),lt.activeTexture.set(ct.TEXTURE1),dd(lt,ut).bind(ct.LINEAR,ct.CLAMP_TO_EDGE),Ge.useProgram("heatmapTexture").draw(lt,ct.TRIANGLES,Nn.disabled,Yn.disabled,Ge.colorModeForRenderPass(),Un.disabled,Wa(Ge,ut,0,1),null,null,ut.id,Ge.viewportBuffer,Ge.quadTriangleIndexBuffer,Ge.viewportSegments,ut.paint,Ge.transform.zoom))})(j,te)})(l,m,w,C,N):o.ce(w)?(function(j,Y,te,ue,ge){if(j.renderPass!=="translucent")return;const{isRenderingToTexture:Ce}=ge,Se=te.paint.get("line-opacity"),Fe=te.paint.get("line-width");if(Se.constantOr(1)===0||Fe.constantOr(1)===0)return;const Ge=j.getDepthModeForSublayer(0,Nn.ReadOnly),ut=j.colorModeForRenderPass(),lt=te.paint.get("line-dasharray"),ct=te.paint.get("line-pattern"),xt=ct.constantOr(1),Pt=te.paint.get("line-gradient"),Ct=te.getCrossfadeParameters(),Ot=xt?"linePattern":lt?"lineSDF":Pt?"lineGradient":"line",Bt=j.context,At=Bt.gl,qt=j.transform;let Sr=!0;for(const fr of ue){const dr=Y.getTile(fr);if(xt&&!dr.patternsLoaded())continue;const mr=dr.getBucket(te);if(!mr)continue;const tn=mr.programConfigurations.get(te.id),nn=j.context.program.get(),qr=j.useProgram(Ot,tn),Ln=Sr||qr.program!==nn,Pi=j.style.map.terrain&&j.style.map.terrain.getTerrainData(fr),Xi=ct.constantOr(null);if(Xi&&dr.imageAtlas){const ci=dr.imageAtlas,ca=ci.patternPositions[Xi.to.toString()],ko=ci.patternPositions[Xi.from.toString()];ca&&ko&&tn.setConstantPatternPositions(ca,ko)}const da=qt.getProjectionData({overscaledTileID:fr,applyGlobeMatrix:!Ce,applyTerrainMatrix:!0}),oa=qt.getPixelScale(),ua=xt?ho(j,dr,te,oa,Ct):lt?Bs(j,dr,te,oa,lt,Ct):Pt?Ao(j,dr,te,oa,mr.lineClipsArray.length):Fl(j,dr,te,oa);if(xt)Bt.activeTexture.set(At.TEXTURE0),dr.imageAtlasTexture.bind(At.LINEAR,At.CLAMP_TO_EDGE),tn.updatePaintBuffers(Ct);else if(lt&&(Ln||j.lineAtlas.dirty))Bt.activeTexture.set(At.TEXTURE0),j.lineAtlas.bind(Bt);else if(Pt){const ci=mr.gradients[te.id];let ca=ci.texture;if(te.gradientVersion!==ci.version){let ko=256;if(te.stepInterpolant){const rs=Y.getSource().maxzoom,Cs=fr.canonical.z===rs?Math.ceil(1<<j.transform.maxZoom-fr.canonical.z):1;ko=o.ah(o.c3(mr.maxLineLength/o.$*1024*Cs),256,Bt.maxTextureSize)}ci.gradient=o.c4({expression:te.gradientExpression(),evaluationKey:"lineProgress",resolution:ko,image:ci.gradient||void 0,clips:mr.lineClipsArray}),ci.texture?ci.texture.update(ci.gradient):ci.texture=new o.T(Bt,ci.gradient,At.RGBA),ci.version=te.gradientVersion,ca=ci.texture}Bt.activeTexture.set(At.TEXTURE0),ca.bind(te.stepInterpolant?At.NEAREST:At.LINEAR,At.CLAMP_TO_EDGE)}const ba=j.stencilModeForClipping(fr);qr.draw(Bt,At.TRIANGLES,Ge,ba,ut,Un.disabled,ua,Pi,da,te.id,mr.layoutVertexBuffer,mr.indexBuffer,mr.segments,te.paint,j.transform.zoom,tn,mr.layoutVertexBuffer2),Sr=!1}})(l,m,w,C,N):o.cf(w)?(function(j,Y,te,ue,ge){const Ce=te.paint.get("fill-color"),Se=te.paint.get("fill-opacity");if(Se.constantOr(1)===0)return;const{isRenderingToTexture:Fe}=ge,Ge=j.colorModeForRenderPass(),ut=te.paint.get("fill-pattern"),lt=j.opaquePassEnabledForLayer()&&!ut.constantOr(1)&&Ce.constantOr(o.bf.transparent).a===1&&Se.constantOr(0)===1?"opaque":"translucent";if(j.renderPass===lt){const ct=j.getDepthModeForSublayer(1,j.renderPass==="opaque"?Nn.ReadWrite:Nn.ReadOnly);op(j,Y,te,ue,ct,Ge,!1,Fe)}if(j.renderPass==="translucent"&&te.paint.get("fill-antialias")){const ct=j.getDepthModeForSublayer(te.getPaintProperty("fill-outline-color")?2:0,Nn.ReadOnly);op(j,Y,te,ue,ct,Ge,!0,Fe)}})(l,m,w,C,N):o.cg(w)?(function(j,Y,te,ue,ge){const Ce=te.paint.get("fill-extrusion-opacity");if(Ce===0)return;const{isRenderingToTexture:Se}=ge;if(j.renderPass==="translucent"){const Fe=new Nn(j.context.gl.LEQUAL,Nn.ReadWrite,j.depthRangeFor3D);if(Ce!==1||te.paint.get("fill-extrusion-pattern").constantOr(1))pg(j,Y,te,ue,Fe,Yn.disabled,jn.disabled,Se),pg(j,Y,te,ue,Fe,j.stencilModeFor3D(),j.colorModeForRenderPass(),Se);else{const Ge=j.colorModeForRenderPass();pg(j,Y,te,ue,Fe,Yn.disabled,Ge,Se)}}})(l,m,w,C,N):o.ch(w)?(function(j,Y,te,ue,ge){if(j.renderPass!=="offscreen"&&j.renderPass!=="translucent")return;const{isRenderingToTexture:Ce}=ge,Se=j.context,Fe=j.style.projection.useSubdivision,Ge=j.getDepthModeForSublayer(0,Nn.ReadOnly),ut=j.colorModeForRenderPass();if(j.renderPass==="offscreen")(function(lt,ct,xt,Pt,Ct,Ot,Bt){const At=lt.context,qt=At.gl;for(const Sr of xt){const fr=ct.getTile(Sr),dr=fr.dem;if(!dr||!dr.data||!fr.needsHillshadePrepare)continue;const mr=dr.dim,tn=dr.stride,nn=dr.getPixels();if(At.activeTexture.set(qt.TEXTURE1),At.pixelStoreUnpackPremultiplyAlpha.set(!1),fr.demTexture=fr.demTexture||lt.getTileTexture(tn),fr.demTexture){const Ln=fr.demTexture;Ln.update(nn,{premultiply:!1}),Ln.bind(qt.NEAREST,qt.CLAMP_TO_EDGE)}else fr.demTexture=new o.T(At,nn,qt.RGBA,{premultiply:!1}),fr.demTexture.bind(qt.NEAREST,qt.CLAMP_TO_EDGE);At.activeTexture.set(qt.TEXTURE0);let qr=fr.fbo;if(!qr){const Ln=new o.T(At,{width:mr,height:mr,data:null},qt.RGBA);Ln.bind(qt.LINEAR,qt.CLAMP_TO_EDGE),qr=fr.fbo=At.createFramebuffer(mr,mr,!0,!1),qr.colorAttachment.set(Ln.texture)}At.bindFramebuffer.set(qr.framebuffer),At.viewport.set([0,0,mr,mr]),lt.useProgram("hillshadePrepare").draw(At,qt.TRIANGLES,Ct,Ot,Bt,Un.disabled,Hu(fr.tileID,dr),null,null,Pt.id,lt.rasterBoundsBuffer,lt.quadTriangleIndexBuffer,lt.rasterBoundsSegments),fr.needsHillshadePrepare=!1}})(j,Y,ue,te,Ge,Yn.disabled,ut),Se.viewport.set([0,0,j.width,j.height]);else if(j.renderPass==="translucent")if(Fe){const[lt,ct,xt]=j.stencilConfigForOverlapTwoPass(ue);zh(j,Y,te,xt,lt,Ge,ut,!1,Ce),zh(j,Y,te,xt,ct,Ge,ut,!0,Ce)}else{const[lt,ct]=j.getStencilConfigForOverlapAndUpdateStencilID(ue);zh(j,Y,te,ct,lt,Ge,ut,!1,Ce)}})(l,m,w,C,N):o.ci(w)?(function(j,Y,te,ue,ge){if(j.renderPass!=="translucent"||!ue.length)return;const{isRenderingToTexture:Ce}=ge,Se=j.style.projection.useSubdivision,Fe=j.getDepthModeForSublayer(0,Nn.ReadOnly),Ge=j.colorModeForRenderPass();if(Se){const[ut,lt,ct]=j.stencilConfigForOverlapTwoPass(ue);gd(j,Y,te,ct,ut,Fe,Ge,!1,Ce),gd(j,Y,te,ct,lt,Fe,Ge,!0,Ce)}else{const[ut,lt]=j.getStencilConfigForOverlapAndUpdateStencilID(ue);gd(j,Y,te,lt,ut,Fe,Ge,!1,Ce)}})(l,m,w,C,N):o.cj(w)?(function(j,Y,te,ue,ge){if(j.renderPass!=="translucent"||te.paint.get("raster-opacity")===0||!ue.length)return;const{isRenderingToTexture:Ce}=ge,Se=Y.getSource(),Fe=j.style.projection.useSubdivision;if(Se instanceof vt)Xu(j,Y,te,ue,null,!1,!1,Se.tileCoords,Se.flippedWindingOrder,Ce);else if(Fe){const[Ge,ut,lt]=j.stencilConfigForOverlapTwoPass(ue);Xu(j,Y,te,lt,Ge,!1,!0,xf,!1,Ce),Xu(j,Y,te,lt,ut,!0,!0,xf,!1,Ce)}else{const[Ge,ut]=j.getStencilConfigForOverlapAndUpdateStencilID(ue);Xu(j,Y,te,ut,Ge,!1,!0,xf,!1,Ce)}})(l,m,w,C,N):o.ck(w)?(function(j,Y,te,ue,ge){const Ce=te.paint.get("background-color"),Se=te.paint.get("background-opacity");if(Se===0)return;const{isRenderingToTexture:Fe}=ge,Ge=j.context,ut=Ge.gl,lt=j.style.projection,ct=j.transform,xt=ct.tileSize,Pt=te.paint.get("background-pattern");if(j.isPatternMissing(Pt))return;const Ct=!Pt&&Ce.a===1&&Se===1&&j.opaquePassEnabledForLayer()?"opaque":"translucent";if(j.renderPass!==Ct)return;const Ot=Yn.disabled,Bt=j.getDepthModeForSublayer(0,Ct==="opaque"?Nn.ReadWrite:Nn.ReadOnly),At=j.colorModeForRenderPass(),qt=j.useProgram(Pt?"backgroundPattern":"background"),Sr=ue||bt(ct,{tileSize:xt,terrain:j.style.map.terrain});Pt&&(Ge.activeTexture.set(ut.TEXTURE0),j.imageManager.bind(j.context));const fr=te.getCrossfadeParameters();for(const dr of Sr){const mr=ct.getProjectionData({overscaledTileID:dr,applyGlobeMatrix:!Fe,applyTerrainMatrix:!0}),tn=Pt?jl(Se,j,Pt,{tileID:dr,tileSize:xt},fr):zs(Se,Ce),nn=j.style.map.terrain&&j.style.map.terrain.getTerrainData(dr),qr=lt.getMeshFromTileID(Ge,dr.canonical,!1,!0,"raster");qt.draw(Ge,ut.TRIANGLES,Bt,Ot,At,Un.backCCW,tn,nn,mr,te.id,qr.vertexBuffer,qr.indexBuffer,qr.segments)}})(l,0,w,C,N):o.cl(w)&&(function(j,Y,te,ue){const{isRenderingGlobe:ge}=ue,Ce=j.context,Se=te.implementation,Fe=j.style.projection,Ge=j.transform,ut=Ge.getProjectionDataForCustomLayer(ge),lt={farZ:Ge.farZ,nearZ:Ge.nearZ,fov:Ge.fov*Math.PI/180,modelViewProjectionMatrix:Ge.modelViewProjectionMatrix,projectionMatrix:Ge.projectionMatrix,shaderData:{variantName:Fe.shaderVariantName,vertexShaderPrelude:`const float PI = 3.141592653589793;
uniform mat4 u_projection_matrix;
${Fe.shaderPreludeCode.vertexSource}`,define:Fe.shaderDefine},defaultProjectionData:ut},ct=Se.renderingMode?Se.renderingMode:"2d";if(j.renderPass==="offscreen"){const xt=Se.prerender;xt&&(j.setCustomLayerDefaults(),Ce.setColorMode(j.colorModeForRenderPass()),xt.call(Se,Ce.gl,lt),Ce.setDirty(),j.setBaseState())}else if(j.renderPass==="translucent"){j.setCustomLayerDefaults(),Ce.setColorMode(j.colorModeForRenderPass()),Ce.setStencilMode(Yn.disabled);const xt=ct==="3d"?j.getDepthModeFor3D():j.getDepthModeForSublayer(0,Nn.ReadOnly);Ce.setDepthMode(xt),Se.render(Ce.gl,lt),Ce.setDirty(),j.setBaseState(),Ce.bindFramebuffer.set(null)}})(l,0,w,N))}saveTileTexture(l){const m=this._tileTextures[l.size[0]];m?m.push(l):this._tileTextures[l.size[0]]=[l]}getTileTexture(l){const m=this._tileTextures[l];return m&&m.length>0?m.pop():null}isPatternMissing(l){if(!l)return!1;if(!l.from||!l.to)return!0;const m=this.imageManager.getPattern(l.from.toString()),w=this.imageManager.getPattern(l.to.toString());return!m||!w}useProgram(l,m,w=!1,C=[]){this.cache=this.cache||{};const N=!!this.style.map.terrain,j=this.style.projection,Y=w?Nt.projectionMercator:j.shaderPreludeCode,te=w?Yr:j.shaderDefine,ue=l+(m?m.cacheKey:"")+`/${w?Hr:j.shaderVariantName}`+(this._showOverdrawInspector?"/overdraw":"")+(N?"/terrain":"")+(C?`/${C.join("/")}`:"");return this.cache[ue]||(this.cache[ue]=new xl(this.context,Nt[l],m,js[l],this._showOverdrawInspector,N,Y,te,C)),this.cache[ue]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const l=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(l.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new o.T(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this.debugOverlayTexture&&this.debugOverlayTexture.destroy()}overLimit(){const{drawingBufferWidth:l,drawingBufferHeight:m}=this.context.gl;return this.width!==l||this.height!==m}}function ws(R,l){let m,w=!1,C=null,N=null;const j=()=>{C=null,w&&(R.apply(N,m),C=setTimeout(j,l),w=!1)};return(...Y)=>(w=!0,N=this,m=Y,C||j(),C)}class up{constructor(l){this._getCurrentHash=()=>{const m=window.location.hash.replace("#","");if(this._hashName){let w;return m.split("&").map((C=>C.split("="))).forEach((C=>{C[0]===this._hashName&&(w=C)})),(w&&w[1]||"").split("/")}return m.split("/")},this._onHashChange=()=>{const m=this._getCurrentHash();if(!this._isValidHash(m))return!1;const w=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(m[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+m[2],+m[1]],zoom:+m[0],bearing:w,pitch:+(m[4]||0)}),!0},this._updateHashUnthrottled=()=>{const m=window.location.href.replace(/(#.*)?$/,this.getHashString());window.history.replaceState(window.history.state,null,m)},this._removeHash=()=>{const m=this._getCurrentHash();if(m.length===0)return;const w=m.join("/");let C=w;C.split("&").length>0&&(C=C.split("&")[0]),this._hashName&&(C=`${this._hashName}=${w}`);let N=window.location.hash.replace(C,"");N.startsWith("#&")?N=N.slice(0,1)+N.slice(2):N==="#"&&(N="");let j=window.location.href.replace(/(#.+)?$/,N);j=j.replace("&&","&"),window.history.replaceState(window.history.state,null,j)},this._updateHash=ws(this._updateHashUnthrottled,300),this._hashName=l&&encodeURIComponent(l)}addTo(l){return this._map=l,addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this}remove(){return removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),this._removeHash(),delete this._map,this}getHashString(l){const m=this._map.getCenter(),w=Math.round(100*this._map.getZoom())/100,C=Math.ceil((w*Math.LN2+Math.log(512/360/.5))/Math.LN10),N=Math.pow(10,C),j=Math.round(m.lng*N)/N,Y=Math.round(m.lat*N)/N,te=this._map.getBearing(),ue=this._map.getPitch();let ge="";if(ge+=l?`/${j}/${Y}/${w}`:`${w}/${Y}/${j}`,(te||ue)&&(ge+="/"+Math.round(10*te)/10),ue&&(ge+=`/${Math.round(ue)}`),this._hashName){const Ce=this._hashName;let Se=!1;const Fe=window.location.hash.slice(1).split("&").map((Ge=>{const ut=Ge.split("=")[0];return ut===Ce?(Se=!0,`${ut}=${ge}`):Ge})).filter((Ge=>Ge));return Se||Fe.push(`${Ce}=${ge}`),`#${Fe.join("&")}`}return`#${ge}`}_isValidHash(l){if(l.length<3||l.some(isNaN))return!1;try{new o.S(+l[2],+l[1])}catch{return!1}const m=+l[0],w=+(l[3]||0),C=+(l[4]||0);return m>=this._map.getMinZoom()&&m<=this._map.getMaxZoom()&&w>=-180&&w<=180&&C>=this._map.getMinPitch()&&C<=this._map.getMaxPitch()}}const Nc={linearity:.3,easing:o.cm(0,0,.3,1)},cp=o.e({deceleration:2500,maxSpeed:1400},Nc),_g=o.e({deceleration:20,maxSpeed:1400},Nc),bg=o.e({deceleration:1e3,maxSpeed:360},Nc),xg=o.e({deceleration:1e3,maxSpeed:90},Nc),ny=o.e({deceleration:1e3,maxSpeed:360},Nc);class md{constructor(l){this._map=l,this.clear()}clear(){this._inertiaBuffer=[]}record(l){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:b.now(),settings:l})}_drainInertiaBuffer(){const l=this._inertiaBuffer,m=b.now();for(;l.length>0&&m-l[0].time>160;)l.shift()}_onMoveEnd(l){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const m={zoom:0,bearing:0,pitch:0,roll:0,pan:new o.P(0,0),pinchAround:void 0,around:void 0};for(const{settings:N}of this._inertiaBuffer)m.zoom+=N.zoomDelta||0,m.bearing+=N.bearingDelta||0,m.pitch+=N.pitchDelta||0,m.roll+=N.rollDelta||0,N.panDelta&&m.pan._add(N.panDelta),N.around&&(m.around=N.around),N.pinchAround&&(m.pinchAround=N.pinchAround);const w=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,C={};if(m.pan.mag()){const N=hc(m.pan.mag(),w,o.e({},cp,l||{})),j=m.pan.mult(N.amount/m.pan.mag()),Y=this._map.cameraHelper.handlePanInertia(j,this._map.transform);C.center=Y.easingCenter,C.offset=Y.easingOffset,ql(C,N)}if(m.zoom){const N=hc(m.zoom,w,_g);C.zoom=this._map.transform.zoom+N.amount,ql(C,N)}if(m.bearing){const N=hc(m.bearing,w,bg);C.bearing=this._map.transform.bearing+o.ah(N.amount,-179,179),ql(C,N)}if(m.pitch){const N=hc(m.pitch,w,xg);C.pitch=this._map.transform.pitch+N.amount,ql(C,N)}if(m.roll){const N=hc(m.roll,w,ny);C.roll=this._map.transform.roll+o.ah(N.amount,-179,179),ql(C,N)}if(C.zoom||C.bearing){const N=m.pinchAround===void 0?m.around:m.pinchAround;C.around=N?this._map.unproject(N):this._map.getCenter()}return this.clear(),o.e(C,{noMoveStart:!0})}}function ql(R,l){(!R.duration||R.duration<l.duration)&&(R.duration=l.duration,R.easing=l.easing)}function hc(R,l,m){const{maxSpeed:w,linearity:C,deceleration:N}=m,j=o.ah(R*C/(l/1e3),-w,w),Y=Math.abs(j)/(N*C);return{easing:m.easing,duration:1e3*Y,amount:j*(Y/2)}}class al extends o.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(l,m,w,C={}){w=w instanceof MouseEvent?w:new MouseEvent(l,w);const N=v.mousePos(m.getCanvas(),w),j=m.unproject(N);super(l,o.e({point:N,lngLat:j,originalEvent:w},C)),this._defaultPrevented=!1,this.target=m}}class Sf extends o.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(l,m,w){const C=l==="touchend"?w.changedTouches:w.touches,N=v.touchPos(m.getCanvasContainer(),C),j=N.map((te=>m.unproject(te))),Y=N.reduce(((te,ue,ge,Ce)=>te.add(ue.div(Ce.length))),new o.P(0,0));super(l,{points:N,point:Y,lngLats:j,lngLat:m.unproject(Y),originalEvent:w}),this._defaultPrevented=!1}}class hp extends o.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(l,m,w){super(l,{originalEvent:w}),this._defaultPrevented=!1}}class iy{constructor(l,m){this._map=l,this._clickTolerance=m.clickTolerance}reset(){delete this._mousedownPos}wheel(l){return this._firePreventable(new hp(l.type,this._map,l))}mousedown(l,m){return this._mousedownPos=m,this._firePreventable(new al(l.type,this._map,l))}mouseup(l){this._map.fire(new al(l.type,this._map,l))}click(l,m){this._mousedownPos&&this._mousedownPos.dist(m)>=this._clickTolerance||this._map.fire(new al(l.type,this._map,l))}dblclick(l){return this._firePreventable(new al(l.type,this._map,l))}mouseover(l){this._map.fire(new al(l.type,this._map,l))}mouseout(l){this._map.fire(new al(l.type,this._map,l))}touchstart(l){return this._firePreventable(new Sf(l.type,this._map,l))}touchmove(l){this._map.fire(new Sf(l.type,this._map,l))}touchend(l){this._map.fire(new Sf(l.type,this._map,l))}touchcancel(l){this._map.fire(new Sf(l.type,this._map,l))}_firePreventable(l){if(this._map.fire(l),l.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class ay{constructor(l){this._map=l}reset(){this._delayContextMenu=!1,this._ignoreContextMenu=!0,delete this._contextMenuEvent}mousemove(l){this._map.fire(new al(l.type,this._map,l))}mousedown(){this._delayContextMenu=!0,this._ignoreContextMenu=!1}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new al("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(l){this._delayContextMenu?this._contextMenuEvent=l:this._ignoreContextMenu||this._map.fire(new al(l.type,this._map,l)),this._map.listens("contextmenu")&&l.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Ef{constructor(l){this._map=l}get transform(){return this._map._requestedCameraState||this._map.transform}get center(){return{lng:this.transform.center.lng,lat:this.transform.center.lat}}get zoom(){return this.transform.zoom}get pitch(){return this.transform.pitch}get bearing(){return this.transform.bearing}unproject(l){return this.transform.screenPointToLocation(o.P.convert(l),this._map.terrain)}}class wg{constructor(l,m){this._map=l,this._tr=new Ef(l),this._el=l.getCanvasContainer(),this._container=l.getContainer(),this._clickTolerance=m.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(l,m){this.isEnabled()&&l.shiftKey&&l.button===0&&(v.disableDrag(),this._startPos=this._lastPos=m,this._active=!0)}mousemoveWindow(l,m){if(!this._active)return;const w=m;if(this._lastPos.equals(w)||!this._box&&w.dist(this._startPos)<this._clickTolerance)return;const C=this._startPos;this._lastPos=w,this._box||(this._box=v.create("div","maplibregl-boxzoom",this._container),this._container.classList.add("maplibregl-crosshair"),this._fireEvent("boxzoomstart",l));const N=Math.min(C.x,w.x),j=Math.max(C.x,w.x),Y=Math.min(C.y,w.y),te=Math.max(C.y,w.y);v.setTransform(this._box,`translate(${N}px,${Y}px)`),this._box.style.width=j-N+"px",this._box.style.height=te-Y+"px"}mouseupWindow(l,m){if(!this._active||l.button!==0)return;const w=this._startPos,C=m;if(this.reset(),v.suppressClick(),w.x!==C.x||w.y!==C.y)return this._map.fire(new o.l("boxzoomend",{originalEvent:l})),{cameraAnimation:N=>N.fitScreenCoordinates(w,C,this._tr.bearing,{linear:!0})};this._fireEvent("boxzoomcancel",l)}keydown(l){this._active&&l.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",l))}reset(){this._active=!1,this._container.classList.remove("maplibregl-crosshair"),this._box&&(v.remove(this._box),this._box=null),v.enableDrag(),delete this._startPos,delete this._lastPos}_fireEvent(l,m){return this._map.fire(new o.l(l,{originalEvent:m}))}}function Tf(R,l){if(R.length!==l.length)throw new Error(`The number of touches and points are not equal - touches ${R.length}, points ${l.length}`);const m={};for(let w=0;w<R.length;w++)m[R[w].identifier]=l[w];return m}class oy{constructor(l){this.reset(),this.numTouches=l.numTouches}reset(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}touchstart(l,m,w){(this.centroid||w.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=l.timeStamp),w.length===this.numTouches&&(this.centroid=(function(C){const N=new o.P(0,0);for(const j of C)N._add(j);return N.div(C.length)})(m),this.touches=Tf(w,m)))}touchmove(l,m,w){if(this.aborted||!this.centroid)return;const C=Tf(w,m);for(const N in this.touches){const j=C[N];(!j||j.dist(this.touches[N])>30)&&(this.aborted=!0)}}touchend(l,m,w){if((!this.centroid||l.timeStamp-this.startTime>500)&&(this.aborted=!0),w.length===0){const C=!this.aborted&&this.centroid;if(this.reset(),C)return C}}}class El{constructor(l){this.singleTap=new oy(l),this.numTaps=l.numTaps,this.reset()}reset(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}touchstart(l,m,w){this.singleTap.touchstart(l,m,w)}touchmove(l,m,w){this.singleTap.touchmove(l,m,w)}touchend(l,m,w){const C=this.singleTap.touchend(l,m,w);if(C){const N=l.timeStamp-this.lastTime<500,j=!this.lastTap||this.lastTap.dist(C)<30;if(N&&j||this.reset(),this.count++,this.lastTime=l.timeStamp,this.lastTap=C,this.count===this.numTaps)return this.reset(),C}}}class Hl{constructor(l){this._tr=new Ef(l),this._zoomIn=new El({numTouches:1,numTaps:2}),this._zoomOut=new El({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(l,m,w){this._zoomIn.touchstart(l,m,w),this._zoomOut.touchstart(l,m,w)}touchmove(l,m,w){this._zoomIn.touchmove(l,m,w),this._zoomOut.touchmove(l,m,w)}touchend(l,m,w){const C=this._zoomIn.touchend(l,m,w),N=this._zoomOut.touchend(l,m,w),j=this._tr;return C?(this._active=!0,l.preventDefault(),setTimeout((()=>this.reset()),0),{cameraAnimation:Y=>Y.easeTo({duration:300,zoom:j.zoom+1,around:j.unproject(C)},{originalEvent:l})}):N?(this._active=!0,l.preventDefault(),setTimeout((()=>this.reset()),0),{cameraAnimation:Y=>Y.easeTo({duration:300,zoom:j.zoom-1,around:j.unproject(N)},{originalEvent:l})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Cf{constructor(l){this._enabled=!!l.enable,this._moveStateManager=l.moveStateManager,this._clickTolerance=l.clickTolerance||1,this._moveFunction=l.move,this._activateOnStart=!!l.activateOnStart,l.assignEvents(this),this.reset()}reset(l){this._active=!1,this._moved=!1,delete this._lastPoint,this._moveStateManager.endMove(l)}_move(...l){const m=this._moveFunction(...l);if(m.bearingDelta||m.pitchDelta||m.rollDelta||m.around||m.panDelta)return this._active=!0,m}dragStart(l,m){this.isEnabled()&&!this._lastPoint&&this._moveStateManager.isValidStartEvent(l)&&(this._moveStateManager.startMove(l),this._lastPoint=Array.isArray(m)?m[0]:m,this._activateOnStart&&this._lastPoint&&(this._active=!0))}dragMove(l,m){if(!this.isEnabled())return;const w=this._lastPoint;if(!w)return;if(l.preventDefault(),!this._moveStateManager.isValidMoveEvent(l))return void this.reset(l);const C=Array.isArray(m)?m[0]:m;return!this._moved&&C.dist(w)<this._clickTolerance?void 0:(this._moved=!0,this._lastPoint=C,this._move(w,C))}dragEnd(l){this.isEnabled()&&this._lastPoint&&this._moveStateManager.isValidEndEvent(l)&&(this._moved&&v.suppressClick(),this.reset(l))}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}getClickTolerance(){return this._clickTolerance}}const Yu=0,jh=2,$={[Yu]:1,[jh]:2};class Z{constructor(l){this._correctEvent=l.checkCorrectEvent}startMove(l){const m=v.mouseButton(l);this._eventButton=m}endMove(l){delete this._eventButton}isValidStartEvent(l){return this._correctEvent(l)}isValidMoveEvent(l){return!(function(m,w){const C=$[w];return m.buttons===void 0||(m.buttons&C)!==C})(l,this._eventButton)}isValidEndEvent(l){return v.mouseButton(l)===this._eventButton}}class de{constructor(){this._firstTouch=void 0}_isOneFingerTouch(l){return l.targetTouches.length===1}_isSameTouchEvent(l){return l.targetTouches[0].identifier===this._firstTouch}startMove(l){this._firstTouch=l.targetTouches[0].identifier}endMove(l){delete this._firstTouch}isValidStartEvent(l){return this._isOneFingerTouch(l)}isValidMoveEvent(l){return this._isOneFingerTouch(l)&&this._isSameTouchEvent(l)}isValidEndEvent(l){return this._isOneFingerTouch(l)&&this._isSameTouchEvent(l)}}class Pe{constructor(l=new Z({checkCorrectEvent:()=>!0}),m=new de){this.mouseMoveStateManager=l,this.oneFingerTouchMoveStateManager=m}_executeRelevantHandler(l,m,w){return l instanceof MouseEvent?m(l):typeof TouchEvent<"u"&&l instanceof TouchEvent?w(l):void 0}startMove(l){this._executeRelevantHandler(l,(m=>this.mouseMoveStateManager.startMove(m)),(m=>this.oneFingerTouchMoveStateManager.startMove(m)))}endMove(l){this._executeRelevantHandler(l,(m=>this.mouseMoveStateManager.endMove(m)),(m=>this.oneFingerTouchMoveStateManager.endMove(m)))}isValidStartEvent(l){return this._executeRelevantHandler(l,(m=>this.mouseMoveStateManager.isValidStartEvent(m)),(m=>this.oneFingerTouchMoveStateManager.isValidStartEvent(m)))}isValidMoveEvent(l){return this._executeRelevantHandler(l,(m=>this.mouseMoveStateManager.isValidMoveEvent(m)),(m=>this.oneFingerTouchMoveStateManager.isValidMoveEvent(m)))}isValidEndEvent(l){return this._executeRelevantHandler(l,(m=>this.mouseMoveStateManager.isValidEndEvent(m)),(m=>this.oneFingerTouchMoveStateManager.isValidEndEvent(m)))}}const He=R=>{R.mousedown=R.dragStart,R.mousemoveWindow=R.dragMove,R.mouseup=R.dragEnd,R.contextmenu=l=>{l.preventDefault()}};class Je{constructor(l,m){this._clickTolerance=l.clickTolerance||1,this._map=m,this.reset()}reset(){this._active=!1,this._touches={},this._sum=new o.P(0,0)}_shouldBePrevented(l){return l<(this._map.cooperativeGestures.isEnabled()?2:1)}touchstart(l,m,w){return this._calculateTransform(l,m,w)}touchmove(l,m,w){if(this._active){if(!this._shouldBePrevented(w.length))return l.preventDefault(),this._calculateTransform(l,m,w);this._map.cooperativeGestures.notifyGestureBlocked("touch_pan",l)}}touchend(l,m,w){this._calculateTransform(l,m,w),this._active&&this._shouldBePrevented(w.length)&&this.reset()}touchcancel(){this.reset()}_calculateTransform(l,m,w){w.length>0&&(this._active=!0);const C=Tf(w,m),N=new o.P(0,0),j=new o.P(0,0);let Y=0;for(const ue in C){const ge=C[ue],Ce=this._touches[ue];Ce&&(N._add(ge),j._add(ge.sub(Ce)),Y++,C[ue]=ge)}if(this._touches=C,this._shouldBePrevented(Y)||!j.mag())return;const te=j.div(Y);return this._sum._add(te),this._sum.mag()<this._clickTolerance?void 0:{around:N.div(Y),panDelta:te}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class tt{constructor(){this.reset()}reset(){this._active=!1,delete this._firstTwoTouches}touchstart(l,m,w){this._firstTwoTouches||w.length<2||(this._firstTwoTouches=[w[0].identifier,w[1].identifier],this._start([m[0],m[1]]))}touchmove(l,m,w){if(!this._firstTwoTouches)return;l.preventDefault();const[C,N]=this._firstTwoTouches,j=We(w,m,C),Y=We(w,m,N);if(!j||!Y)return;const te=this._aroundCenter?null:j.add(Y).div(2);return this._move([j,Y],te,l)}touchend(l,m,w){if(!this._firstTwoTouches)return;const[C,N]=this._firstTwoTouches,j=We(w,m,C),Y=We(w,m,N);j&&Y||(this._active&&v.suppressClick(),this.reset())}touchcancel(){this.reset()}enable(l){this._enabled=!0,this._aroundCenter=!!l&&l.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}}function We(R,l,m){for(let w=0;w<R.length;w++)if(R[w].identifier===m)return l[w]}function ft(R,l){return Math.log(R/l)/Math.LN2}class Et extends tt{reset(){super.reset(),delete this._distance,delete this._startDistance}_start(l){this._startDistance=this._distance=l[0].dist(l[1])}_move(l,m){const w=this._distance;if(this._distance=l[0].dist(l[1]),this._active||!(Math.abs(ft(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:ft(this._distance,w),pinchAround:m}}}function Vt(R,l){return 180*R.angleWith(l)/Math.PI}class vr extends tt{reset(){super.reset(),delete this._minDiameter,delete this._startVector,delete this._vector}_start(l){this._startVector=this._vector=l[0].sub(l[1]),this._minDiameter=l[0].dist(l[1])}_move(l,m,w){const C=this._vector;if(this._vector=l[0].sub(l[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:Vt(this._vector,C),pinchAround:m}}_isBelowThreshold(l){this._minDiameter=Math.min(this._minDiameter,l.mag());const m=25/(Math.PI*this._minDiameter)*360,w=Vt(l,this._startVector);return Math.abs(w)<m}}function St(R){return Math.abs(R.y)>Math.abs(R.x)}class Qt extends tt{constructor(l){super(),this._currentTouchCount=0,this._map=l}reset(){super.reset(),this._valid=void 0,delete this._firstMove,delete this._lastPoints}touchstart(l,m,w){super.touchstart(l,m,w),this._currentTouchCount=w.length}_start(l){this._lastPoints=l,St(l[0].sub(l[1]))&&(this._valid=!1)}_move(l,m,w){if(this._map.cooperativeGestures.isEnabled()&&this._currentTouchCount<3)return;const C=l[0].sub(this._lastPoints[0]),N=l[1].sub(this._lastPoints[1]);return this._valid=this.gestureBeginsVertically(C,N,w.timeStamp),this._valid?(this._lastPoints=l,this._active=!0,{pitchDelta:(C.y+N.y)/2*-.5}):void 0}gestureBeginsVertically(l,m,w){if(this._valid!==void 0)return this._valid;const C=l.mag()>=2,N=m.mag()>=2;if(!C&&!N)return;if(!C||!N)return this._firstMove===void 0&&(this._firstMove=w),w-this._firstMove<100&&void 0;const j=l.y>0==m.y>0;return St(l)&&St(m)&&j}}const Ut={panStep:100,bearingStep:15,pitchStep:10};class Or{constructor(l){this._tr=new Ef(l);const m=Ut;this._panStep=m.panStep,this._bearingStep=m.bearingStep,this._pitchStep=m.pitchStep,this._rotationDisabled=!1}reset(){this._active=!1}keydown(l){if(l.altKey||l.ctrlKey||l.metaKey)return;let m=0,w=0,C=0,N=0,j=0;switch(l.keyCode){case 61:case 107:case 171:case 187:m=1;break;case 189:case 109:case 173:m=-1;break;case 37:l.shiftKey?w=-1:(l.preventDefault(),N=-1);break;case 39:l.shiftKey?w=1:(l.preventDefault(),N=1);break;case 38:l.shiftKey?C=1:(l.preventDefault(),j=-1);break;case 40:l.shiftKey?C=-1:(l.preventDefault(),j=1);break;default:return}return this._rotationDisabled&&(w=0,C=0),{cameraAnimation:Y=>{const te=this._tr;Y.easeTo({duration:300,easeId:"keyboardHandler",easing:xr,zoom:m?Math.round(te.zoom)+m*(l.shiftKey?2:1):te.zoom,bearing:te.bearing+w*this._bearingStep,pitch:te.pitch+C*this._pitchStep,offset:[-N*this._panStep,-j*this._panStep],center:te.center},{originalEvent:l})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function xr(R){return R*(2-R)}const Nr=4.000244140625,jr=1/450;class rn{constructor(l,m){this._onTimeout=w=>{this._type="wheel",this._delta-=this._lastValue,this._active||this._start(w)},this._map=l,this._tr=new Ef(l),this._triggerRenderFrame=m,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=jr}setZoomRate(l){this._defaultZoomRate=l}setWheelZoomRate(l){this._wheelZoomRate=l}isEnabled(){return!!this._enabled}isActive(){return!!this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(l){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!l&&l.around==="center")}disable(){this.isEnabled()&&(this._enabled=!1)}_shouldBePrevented(l){return!!this._map.cooperativeGestures.isEnabled()&&!(l.ctrlKey||this._map.cooperativeGestures.isBypassed(l))}wheel(l){if(!this.isEnabled())return;if(this._shouldBePrevented(l))return void this._map.cooperativeGestures.notifyGestureBlocked("wheel_zoom",l);let m=l.deltaMode===WheelEvent.DOM_DELTA_LINE?40*l.deltaY:l.deltaY;const w=b.now(),C=w-(this._lastWheelEventTime||0);this._lastWheelEventTime=w,m!==0&&m%Nr==0?this._type="wheel":m!==0&&Math.abs(m)<4?this._type="trackpad":C>400?(this._type=null,this._lastValue=m,this._timeout=setTimeout(this._onTimeout,40,l)):this._type||(this._type=Math.abs(C*m)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,m+=this._lastValue)),l.shiftKey&&m&&(m/=4),this._type&&(this._lastWheelEvent=l,this._delta-=m,this._active||this._start(l)),l.preventDefault()}_start(l){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const m=v.mousePos(this._map.getCanvas(),l),w=this._tr;this._aroundPoint=this._aroundCenter?w.transform.locationToScreenPoint(o.S.convert(w.center)):m,this._frameId||(this._frameId=!0,this._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const l=this._tr.transform;if(typeof this._lastExpectedZoom=="number"){const Y=l.zoom-this._lastExpectedZoom;typeof this._startZoom=="number"&&(this._startZoom+=Y),typeof this._targetZoom=="number"&&(this._targetZoom+=Y)}if(this._delta!==0){const Y=this._type==="wheel"&&Math.abs(this._delta)>Nr?this._wheelZoomRate:this._defaultZoomRate;let te=2/(1+Math.exp(-Math.abs(this._delta*Y)));this._delta<0&&te!==0&&(te=1/te);const ue=typeof this._targetZoom!="number"?l.scale:o.af(this._targetZoom);this._targetZoom=l.getConstrained(l.getCameraLngLat(),o.ak(ue*te)).zoom,this._type==="wheel"&&(this._startZoom=l.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}const m=typeof this._targetZoom!="number"?l.zoom:this._targetZoom,w=this._startZoom,C=this._easing;let N,j=!1;if(this._type==="wheel"&&w&&C){const Y=b.now()-this._lastWheelEventTime,te=Math.min((Y+5)/200,1),ue=C(te);N=o.C.number(w,m,ue),te<1?this._frameId||(this._frameId=!0):j=!0}else N=m,j=!0;return this._active=!0,j&&(this._active=!1,this._finishTimeout=setTimeout((()=>{this._zooming=!1,this._triggerRenderFrame(),delete this._targetZoom,delete this._lastExpectedZoom,delete this._finishTimeout}),200)),this._lastExpectedZoom=N,{noInertia:!0,needsRenderFrame:!j,zoomDelta:N-l.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}_smoothOutEasing(l){let m=o.co;if(this._prevEase){const w=this._prevEase,C=(b.now()-w.start)/w.duration,N=w.easing(C+.01)-w.easing(C),j=.27/Math.sqrt(N*N+1e-4)*.01,Y=Math.sqrt(.0729-j*j);m=o.cm(j,Y,.25,1)}return this._prevEase={start:b.now(),duration:l,easing:m},m}reset(){this._active=!1,this._zooming=!1,delete this._targetZoom,delete this._lastExpectedZoom,this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout)}}class Kr{constructor(l,m){this._clickZoom=l,this._tapZoom=m}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class Kn{constructor(l){this._tr=new Ef(l),this.reset()}reset(){this._active=!1}dblclick(l,m){return l.preventDefault(),{cameraAnimation:w=>{w.easeTo({duration:300,zoom:this._tr.zoom+(l.shiftKey?-1:1),around:this._tr.unproject(m)},{originalEvent:l})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class zn{constructor(){this._tap=new El({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,delete this._tapPoint,this._tap.reset()}touchstart(l,m,w){if(!this._swipePoint)if(this._tapTime){const C=m[0],N=l.timeStamp-this._tapTime<500,j=this._tapPoint.dist(C)<30;N&&j?w.length>0&&(this._swipePoint=C,this._swipeTouch=w[0].identifier):this.reset()}else this._tap.touchstart(l,m,w)}touchmove(l,m,w){if(this._tapTime){if(this._swipePoint){if(w[0].identifier!==this._swipeTouch)return;const C=m[0],N=C.y-this._swipePoint.y;return this._swipePoint=C,l.preventDefault(),this._active=!0,{zoomDelta:N/128}}}else this._tap.touchmove(l,m,w)}touchend(l,m,w){if(this._tapTime)this._swipePoint&&w.length===0&&this.reset();else{const C=this._tap.touchend(l,m,w);C&&(this._tapTime=l.timeStamp,this._tapPoint=C)}}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Li{constructor(l,m,w){this._el=l,this._mousePan=m,this._touchPan=w}enable(l){this._inertiaOptions=l||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("maplibregl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("maplibregl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class Gn{constructor(l,m,w,C){this._pitchWithRotate=l.pitchWithRotate,this._rollEnabled=l.rollEnabled,this._mouseRotate=m,this._mousePitch=w,this._mouseRoll=C}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable(),this._rollEnabled&&this._mouseRoll.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable(),this._mouseRoll.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())&&(!this._rollEnabled||this._mouseRoll.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()||this._mouseRoll.isActive()}}class ea{constructor(l,m,w,C){this._el=l,this._touchZoom=m,this._touchRotate=w,this._tapDragZoom=C,this._rotationDisabled=!1,this._enabled=!0}enable(l){this._touchZoom.enable(l),this._rotationDisabled||this._touchRotate.enable(l),this._tapDragZoom.enable(),this._el.classList.add("maplibregl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("maplibregl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}class Qo{constructor(l,m){this._bypassKey=navigator.userAgent.indexOf("Mac")!==-1?"metaKey":"ctrlKey",this._map=l,this._options=m,this._enabled=!1}isActive(){return!1}reset(){}_setupUI(){if(this._container)return;const l=this._map.getCanvasContainer();l.classList.add("maplibregl-cooperative-gestures"),this._container=v.create("div","maplibregl-cooperative-gesture-screen",l);let m=this._map._getUIString("CooperativeGesturesHandler.WindowsHelpText");this._bypassKey==="metaKey"&&(m=this._map._getUIString("CooperativeGesturesHandler.MacHelpText"));const w=this._map._getUIString("CooperativeGesturesHandler.MobileHelpText"),C=document.createElement("div");C.className="maplibregl-desktop-message",C.textContent=m,this._container.appendChild(C);const N=document.createElement("div");N.className="maplibregl-mobile-message",N.textContent=w,this._container.appendChild(N),this._container.setAttribute("aria-hidden","true")}_destroyUI(){this._container&&(v.remove(this._container),this._map.getCanvasContainer().classList.remove("maplibregl-cooperative-gestures")),delete this._container}enable(){this._setupUI(),this._enabled=!0}disable(){this._enabled=!1,this._destroyUI()}isEnabled(){return this._enabled}isBypassed(l){return l[this._bypassKey]}notifyGestureBlocked(l,m){this._enabled&&(this._map.fire(new o.l("cooperativegestureprevented",{gestureType:l,originalEvent:m})),this._container.classList.add("maplibregl-show"),setTimeout((()=>{this._container.classList.remove("maplibregl-show")}),100))}}const yi=R=>R.zoom||R.drag||R.roll||R.pitch||R.rotate;class mn extends o.l{}function _n(R){return R.panDelta&&R.panDelta.mag()||R.zoomDelta||R.bearingDelta||R.pitchDelta||R.rollDelta}class So{constructor(l,m){this.handleWindowEvent=C=>{this.handleEvent(C,`${C.type}Window`)},this.handleEvent=(C,N)=>{if(C.type==="blur")return void this.stop(!0);this._updatingCamera=!0;const j=C.type==="renderFrame"?void 0:C,Y={needsRenderFrame:!1},te={},ue={};for(const{handlerName:Se,handler:Fe,allowed:Ge}of this._handlers){if(!Fe.isEnabled())continue;let ut;if(this._blockedByActive(ue,Ge,Se))Fe.reset();else if(Fe[N||C.type]){if(o.cp(C,N||C.type)){const lt=v.mousePos(this._map.getCanvas(),C);ut=Fe[N||C.type](C,lt)}else if(o.cq(C,N||C.type)){const lt=this._getMapTouches(C.touches),ct=v.touchPos(this._map.getCanvas(),lt);ut=Fe[N||C.type](C,ct,lt)}else o.cr(N||C.type)||(ut=Fe[N||C.type](C));this.mergeHandlerResult(Y,te,ut,Se,j),ut&&ut.needsRenderFrame&&this._triggerRenderFrame()}(ut||Fe.isActive())&&(ue[Se]=Fe)}const ge={};for(const Se in this._previousActiveHandlers)ue[Se]||(ge[Se]=j);this._previousActiveHandlers=ue,(Object.keys(ge).length||_n(Y))&&(this._changes.push([Y,te,ge]),this._triggerRenderFrame()),(Object.keys(ue).length||_n(Y))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:Ce}=Y;Ce&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],Ce(this._map))},this._map=l,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new md(l),this._bearingSnap=m.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(m);const w=this._el;this._listeners=[[w,"touchstart",{passive:!0}],[w,"touchmove",{passive:!1}],[w,"touchend",void 0],[w,"touchcancel",void 0],[w,"mousedown",void 0],[w,"mousemove",void 0],[w,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[w,"mouseover",void 0],[w,"mouseout",void 0],[w,"dblclick",void 0],[w,"click",void 0],[w,"keydown",{capture:!1}],[w,"keyup",void 0],[w,"wheel",{passive:!1}],[w,"contextmenu",void 0],[window,"blur",void 0]];for(const[C,N,j]of this._listeners)v.addEventListener(C,N,C===document?this.handleWindowEvent:this.handleEvent,j)}destroy(){for(const[l,m,w]of this._listeners)v.removeEventListener(l,m,l===document?this.handleWindowEvent:this.handleEvent,w)}_addDefaultHandlers(l){const m=this._map,w=m.getCanvasContainer();this._add("mapEvent",new iy(m,l));const C=m.boxZoom=new wg(m,l);this._add("boxZoom",C),l.interactive&&l.boxZoom&&C.enable();const N=m.cooperativeGestures=new Qo(m,l.cooperativeGestures);this._add("cooperativeGestures",N),l.cooperativeGestures&&N.enable();const j=new Hl(m),Y=new Kn(m);m.doubleClickZoom=new Kr(Y,j),this._add("tapZoom",j),this._add("clickZoom",Y),l.interactive&&l.doubleClickZoom&&m.doubleClickZoom.enable();const te=new zn;this._add("tapDragZoom",te);const ue=m.touchPitch=new Qt(m);this._add("touchPitch",ue),l.interactive&&l.touchPitch&&m.touchPitch.enable(l.touchPitch);const ge=()=>m.project(m.getCenter()),Ce=(function({enable:Ct,clickTolerance:Ot,aroundCenter:Bt=!0,minPixelCenterThreshold:At=100,rotateDegreesPerPixelMoved:qt=.8},Sr){const fr=new Z({checkCorrectEvent:dr=>v.mouseButton(dr)===0&&dr.ctrlKey||v.mouseButton(dr)===2&&!dr.ctrlKey});return new Cf({clickTolerance:Ot,move:(dr,mr)=>{const tn=Sr();if(Bt&&Math.abs(tn.y-dr.y)>At)return{bearingDelta:o.cn(new o.P(dr.x,mr.y),mr,tn)};let nn=(mr.x-dr.x)*qt;return Bt&&mr.y<tn.y&&(nn=-nn),{bearingDelta:nn}},moveStateManager:fr,enable:Ct,assignEvents:He})})(l,ge),Se=(function({enable:Ct,clickTolerance:Ot,pitchDegreesPerPixelMoved:Bt=-.5}){const At=new Z({checkCorrectEvent:qt=>v.mouseButton(qt)===0&&qt.ctrlKey||v.mouseButton(qt)===2});return new Cf({clickTolerance:Ot,move:(qt,Sr)=>({pitchDelta:(Sr.y-qt.y)*Bt}),moveStateManager:At,enable:Ct,assignEvents:He})})(l),Fe=(function({enable:Ct,clickTolerance:Ot,rollDegreesPerPixelMoved:Bt=.3},At){const qt=new Z({checkCorrectEvent:Sr=>v.mouseButton(Sr)===2&&Sr.ctrlKey});return new Cf({clickTolerance:Ot,move:(Sr,fr)=>{const dr=At();let mr=(fr.x-Sr.x)*Bt;return fr.y<dr.y&&(mr=-mr),{rollDelta:mr}},moveStateManager:qt,enable:Ct,assignEvents:He})})(l,ge);m.dragRotate=new Gn(l,Ce,Se,Fe),this._add("mouseRotate",Ce,["mousePitch"]),this._add("mousePitch",Se,["mouseRotate","mouseRoll"]),this._add("mouseRoll",Fe,["mousePitch"]),l.interactive&&l.dragRotate&&m.dragRotate.enable();const Ge=(function({enable:Ct,clickTolerance:Ot}){const Bt=new Z({checkCorrectEvent:At=>v.mouseButton(At)===0&&!At.ctrlKey});return new Cf({clickTolerance:Ot,move:(At,qt)=>({around:qt,panDelta:qt.sub(At)}),activateOnStart:!0,moveStateManager:Bt,enable:Ct,assignEvents:He})})(l),ut=new Je(l,m);m.dragPan=new Li(w,Ge,ut),this._add("mousePan",Ge),this._add("touchPan",ut,["touchZoom","touchRotate"]),l.interactive&&l.dragPan&&m.dragPan.enable(l.dragPan);const lt=new vr,ct=new Et;m.touchZoomRotate=new ea(w,ct,lt,te),this._add("touchRotate",lt,["touchPan","touchZoom"]),this._add("touchZoom",ct,["touchPan","touchRotate"]),l.interactive&&l.touchZoomRotate&&m.touchZoomRotate.enable(l.touchZoomRotate);const xt=m.scrollZoom=new rn(m,(()=>this._triggerRenderFrame()));this._add("scrollZoom",xt,["mousePan"]),l.interactive&&l.scrollZoom&&m.scrollZoom.enable(l.scrollZoom);const Pt=m.keyboard=new Or(m);this._add("keyboard",Pt),l.interactive&&l.keyboard&&m.keyboard.enable(),this._add("blockableMapEvent",new ay(m))}_add(l,m,w){this._handlers.push({handlerName:l,handler:m,allowed:w}),this._handlersById[l]=m}stop(l){if(!this._updatingCamera){for(const{handler:m}of this._handlers)m.reset();this._inertia.clear(),this._fireEvents({},{},l),this._changes=[]}}isActive(){for(const{handler:l}of this._handlers)if(l.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!yi(this._eventsInProgress)||this.isZooming()}_blockedByActive(l,m,w){for(const C in l)if(C!==w&&(!m||m.indexOf(C)<0))return!0;return!1}_getMapTouches(l){const m=[];for(const w of l)this._el.contains(w.target)&&m.push(w);return m}mergeHandlerResult(l,m,w,C,N){if(!w)return;o.e(l,w);const j={handlerName:C,originalEvent:w.originalEvent||N};w.zoomDelta!==void 0&&(m.zoom=j),w.panDelta!==void 0&&(m.drag=j),w.rollDelta!==void 0&&(m.roll=j),w.pitchDelta!==void 0&&(m.pitch=j),w.bearingDelta!==void 0&&(m.rotate=j)}_applyChanges(){const l={},m={},w={};for(const[C,N,j]of this._changes)C.panDelta&&(l.panDelta=(l.panDelta||new o.P(0,0))._add(C.panDelta)),C.zoomDelta&&(l.zoomDelta=(l.zoomDelta||0)+C.zoomDelta),C.bearingDelta&&(l.bearingDelta=(l.bearingDelta||0)+C.bearingDelta),C.pitchDelta&&(l.pitchDelta=(l.pitchDelta||0)+C.pitchDelta),C.rollDelta&&(l.rollDelta=(l.rollDelta||0)+C.rollDelta),C.around!==void 0&&(l.around=C.around),C.pinchAround!==void 0&&(l.pinchAround=C.pinchAround),C.noInertia&&(l.noInertia=C.noInertia),o.e(m,N),o.e(w,j);this._updateMapTransform(l,m,w),this._changes=[]}_updateMapTransform(l,m,w){const C=this._map,N=C._getTransformForUpdate(),j=C.terrain;if(!(_n(l)||j&&this._terrainMovement))return this._fireEvents(m,w,!0);C._stop(!0);let{panDelta:Y,zoomDelta:te,bearingDelta:ue,pitchDelta:ge,rollDelta:Ce,around:Se,pinchAround:Fe}=l;Fe!==void 0&&(Se=Fe),Se=Se||C.transform.centerPoint,j&&!N.isPointOnMapSurface(Se)&&(Se=N.centerPoint);const Ge={panDelta:Y,zoomDelta:te,rollDelta:Ce,pitchDelta:ge,bearingDelta:ue,around:Se};this._map.cameraHelper.useGlobeControls&&!N.isPointOnMapSurface(Se)&&(Se=N.centerPoint);const ut=Se.distSqr(N.centerPoint)<.01?N.center:N.screenPointToLocation(Y?Se.sub(Y):Se);j?(this._map.cameraHelper.handleMapControlsRollPitchBearingZoom(Ge,N),this._terrainMovement||!m.drag&&!m.zoom?m.drag&&this._terrainMovement?N.setCenter(N.screenPointToLocation(N.centerPoint.sub(Y))):this._map.cameraHelper.handleMapControlsPan(Ge,N,ut):(this._terrainMovement=!0,this._map._elevationFreeze=!0,this._map.cameraHelper.handleMapControlsPan(Ge,N,ut))):(this._map.cameraHelper.handleMapControlsRollPitchBearingZoom(Ge,N),this._map.cameraHelper.handleMapControlsPan(Ge,N,ut)),C._applyUpdatedTransform(N),this._map._update(),l.noInertia||this._inertia.record(l),this._fireEvents(m,w,!0)}_fireEvents(l,m,w){const C=yi(this._eventsInProgress),N=yi(l),j={};for(const Ce in l){const{originalEvent:Se}=l[Ce];this._eventsInProgress[Ce]||(j[`${Ce}start`]=Se),this._eventsInProgress[Ce]=l[Ce]}!C&&N&&this._fireEvent("movestart",N.originalEvent);for(const Ce in j)this._fireEvent(Ce,j[Ce]);N&&this._fireEvent("move",N.originalEvent);for(const Ce in l){const{originalEvent:Se}=l[Ce];this._fireEvent(Ce,Se)}const Y={};let te;for(const Ce in this._eventsInProgress){const{handlerName:Se,originalEvent:Fe}=this._eventsInProgress[Ce];this._handlersById[Se].isActive()||(delete this._eventsInProgress[Ce],te=m[Se]||Fe,Y[`${Ce}end`]=te)}for(const Ce in Y)this._fireEvent(Ce,Y[Ce]);const ue=yi(this._eventsInProgress),ge=(C||N)&&!ue;if(ge&&this._terrainMovement){this._map._elevationFreeze=!1,this._terrainMovement=!1;const Ce=this._map._getTransformForUpdate();this._map.getCenterClampedToGround()&&Ce.recalculateZoomAndCenter(this._map.terrain),this._map._applyUpdatedTransform(Ce)}if(w&&ge){this._updatingCamera=!0;const Ce=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),Se=Fe=>Fe!==0&&-this._bearingSnap<Fe&&Fe<this._bearingSnap;!Ce||!Ce.essential&&b.prefersReducedMotion?(this._map.fire(new o.l("moveend",{originalEvent:te})),Se(this._map.getBearing())&&this._map.resetNorth()):(Se(Ce.bearing||this._map.getBearing())&&(Ce.bearing=0),Ce.freezeElevation=!0,this._map.easeTo(Ce,{originalEvent:te})),this._updatingCamera=!1}}_fireEvent(l,m){this._map.fire(new o.l(l,m?{originalEvent:m}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add((l=>{delete this._frameId,this.handleEvent(new mn("renderFrame",{timeStamp:l})),this._applyChanges()}))}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}class ki extends o.E{constructor(l,m,w){super(),this._renderFrameCallback=()=>{const C=Math.min((b.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(C)),C<1&&this._easeFrameId?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},this._moving=!1,this._zooming=!1,this.transform=l,this._bearingSnap=w.bearingSnap,this.cameraHelper=m,this.on("moveend",(()=>{delete this._requestedCameraState}))}migrateProjection(l,m){l.apply(this.transform),this.transform=l,this.cameraHelper=m}getCenter(){return new o.S(this.transform.center.lng,this.transform.center.lat)}setCenter(l,m){return this.jumpTo({center:l},m)}getCenterElevation(){return this.transform.elevation}setCenterElevation(l,m){return this.jumpTo({elevation:l},m),this}getCenterClampedToGround(){return this._centerClampedToGround}setCenterClampedToGround(l){this._centerClampedToGround=l}panBy(l,m,w){return l=o.P.convert(l).mult(-1),this.panTo(this.transform.center,o.e({offset:l},m),w)}panTo(l,m,w){return this.easeTo(o.e({center:l},m),w)}getZoom(){return this.transform.zoom}setZoom(l,m){return this.jumpTo({zoom:l},m),this}zoomTo(l,m,w){return this.easeTo(o.e({zoom:l},m),w)}zoomIn(l,m){return this.zoomTo(this.getZoom()+1,l,m),this}zoomOut(l,m){return this.zoomTo(this.getZoom()-1,l,m),this}getVerticalFieldOfView(){return this.transform.fov}setVerticalFieldOfView(l,m){return l!=this.transform.fov&&(this.transform.setFov(l),this.fire(new o.l("movestart",m)).fire(new o.l("move",m)).fire(new o.l("moveend",m))),this}getBearing(){return this.transform.bearing}setBearing(l,m){return this.jumpTo({bearing:l},m),this}getPadding(){return this.transform.padding}setPadding(l,m){return this.jumpTo({padding:l},m),this}rotateTo(l,m,w){return this.easeTo(o.e({bearing:l},m),w)}resetNorth(l,m){return this.rotateTo(0,o.e({duration:1e3},l),m),this}resetNorthPitch(l,m){return this.easeTo(o.e({bearing:0,pitch:0,roll:0,duration:1e3},l),m),this}snapToNorth(l,m){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(l,m):this}getPitch(){return this.transform.pitch}setPitch(l,m){return this.jumpTo({pitch:l},m),this}getRoll(){return this.transform.roll}setRoll(l,m){return this.jumpTo({roll:l},m),this}cameraForBounds(l,m){l=Mt.convert(l).adjustAntiMeridian();const w=m&&m.bearing||0;return this._cameraForBoxAndBearing(l.getNorthWest(),l.getSouthEast(),w,m)}_cameraForBoxAndBearing(l,m,w,C){const N={top:0,bottom:0,right:0,left:0};if(typeof(C=o.e({padding:N,offset:[0,0],maxZoom:this.transform.maxZoom},C)).padding=="number"){const ue=C.padding;C.padding={top:ue,bottom:ue,right:ue,left:ue}}const j=o.e(N,C.padding);C.padding=j;const Y=this.transform,te=new Mt(l,m);return this.cameraHelper.cameraForBoxAndBearing(C,j,te,w,Y)}fitBounds(l,m,w){return this._fitInternal(this.cameraForBounds(l,m),m,w)}fitScreenCoordinates(l,m,w,C,N){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.screenPointToLocation(o.P.convert(l)),this.transform.screenPointToLocation(o.P.convert(m)),w,C),C,N)}_fitInternal(l,m,w){return l?(delete(m=o.e(l,m)).padding,m.linear?this.easeTo(m,w):this.flyTo(m,w)):this}jumpTo(l,m){this.stop();const w=this._getTransformForUpdate();let C=!1,N=!1,j=!1;const Y=w.zoom;this.cameraHelper.handleJumpToCenterZoom(w,l);const te=w.zoom!==Y;return"elevation"in l&&w.elevation!==+l.elevation&&w.setElevation(+l.elevation),"bearing"in l&&w.bearing!==+l.bearing&&(C=!0,w.setBearing(+l.bearing)),"pitch"in l&&w.pitch!==+l.pitch&&(N=!0,w.setPitch(+l.pitch)),"roll"in l&&w.roll!==+l.roll&&(j=!0,w.setRoll(+l.roll)),l.padding==null||w.isPaddingEqual(l.padding)||w.setPadding(l.padding),this._applyUpdatedTransform(w),this.fire(new o.l("movestart",m)).fire(new o.l("move",m)),te&&this.fire(new o.l("zoomstart",m)).fire(new o.l("zoom",m)).fire(new o.l("zoomend",m)),C&&this.fire(new o.l("rotatestart",m)).fire(new o.l("rotate",m)).fire(new o.l("rotateend",m)),N&&this.fire(new o.l("pitchstart",m)).fire(new o.l("pitch",m)).fire(new o.l("pitchend",m)),j&&this.fire(new o.l("rollstart",m)).fire(new o.l("roll",m)).fire(new o.l("rollend",m)),this.fire(new o.l("moveend",m))}calculateCameraOptionsFromTo(l,m,w,C=0){const N=o.a1.fromLngLat(l,m),j=o.a1.fromLngLat(w,C),Y=j.x-N.x,te=j.y-N.y,ue=j.z-N.z,ge=Math.hypot(Y,te,ue);if(ge===0)throw new Error("Can't calculate camera options with same From and To");const Ce=Math.hypot(Y,te),Se=o.ak(this.transform.cameraToCenterDistance/ge/this.transform.tileSize),Fe=180*Math.atan2(Y,-te)/Math.PI;let Ge=180*Math.acos(Ce/ge)/Math.PI;return Ge=ue<0?90-Ge:90+Ge,{center:j.toLngLat(),elevation:C,zoom:Se,pitch:Ge,bearing:Fe}}calculateCameraOptionsFromCameraLngLatAltRotation(l,m,w,C,N){const j=this.transform.calculateCenterFromCameraLngLatAlt(l,m,w,C);return{center:j.center,elevation:j.elevation,zoom:j.zoom,bearing:w,pitch:C,roll:N}}easeTo(l,m){this._stop(!1,l.easeId),((l=o.e({offset:[0,0],duration:500,easing:o.co},l)).animate===!1||!l.essential&&b.prefersReducedMotion)&&(l.duration=0);const w=this._getTransformForUpdate(),C=this.getBearing(),N=w.pitch,j=w.roll,Y="bearing"in l?this._normalizeBearing(l.bearing,C):C,te="pitch"in l?+l.pitch:N,ue="roll"in l?this._normalizeBearing(l.roll,j):j,ge="padding"in l?l.padding:w.padding,Ce=o.P.convert(l.offset);let Se,Fe;l.around&&(Se=o.S.convert(l.around),Fe=w.locationToScreenPoint(Se));const Ge={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching,rolling:this._rolling},ut=this.cameraHelper.handleEaseTo(w,{bearing:Y,pitch:te,roll:ue,padding:ge,around:Se,aroundPoint:Fe,offsetAsPoint:Ce,offset:l.offset,zoom:l.zoom,center:l.center});return this._rotating=this._rotating||C!==Y,this._pitching=this._pitching||te!==N,this._rolling=this._rolling||ue!==j,this._padding=!w.isPaddingEqual(ge),this._zooming=this._zooming||ut.isZooming,this._easeId=l.easeId,this._prepareEase(m,l.noMoveStart,Ge),this.terrain&&this._prepareElevation(ut.elevationCenter),this._ease((lt=>{ut.easeFunc(lt),this.terrain&&!l.freezeElevation&&this._updateElevation(lt),this._applyUpdatedTransform(w),this._fireMoveEvents(m)}),(lt=>{this.terrain&&l.freezeElevation&&this._finalizeElevation(),this._afterEase(m,lt)}),l),this}_prepareEase(l,m,w={}){this._moving=!0,m||w.moving||this.fire(new o.l("movestart",l)),this._zooming&&!w.zooming&&this.fire(new o.l("zoomstart",l)),this._rotating&&!w.rotating&&this.fire(new o.l("rotatestart",l)),this._pitching&&!w.pitching&&this.fire(new o.l("pitchstart",l)),this._rolling&&!w.rolling&&this.fire(new o.l("rollstart",l))}_prepareElevation(l){this._elevationCenter=l,this._elevationStart=this.transform.elevation,this._elevationTarget=this.terrain.getElevationForLngLatZoom(l,this.transform.tileZoom),this._elevationFreeze=!0}_updateElevation(l){this._elevationStart!==void 0&&this._elevationCenter!==void 0||this._prepareElevation(this.transform.center),this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom));const m=this.terrain.getElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);if(l<1&&m!==this._elevationTarget){const w=this._elevationTarget-this._elevationStart;this._elevationStart+=l*(w-(m-(w*l+this._elevationStart))/(1-l)),this._elevationTarget=m}this.transform.setElevation(o.C.number(this._elevationStart,this._elevationTarget,l))}_finalizeElevation(){this._elevationFreeze=!1,this.getCenterClampedToGround()&&this.transform.recalculateZoomAndCenter(this.terrain)}_getTransformForUpdate(){return this.transformCameraUpdate||this.terrain?(this._requestedCameraState||(this._requestedCameraState=this.transform.clone()),this._requestedCameraState):this.transform}_elevateCameraIfInsideTerrain(l){if(!this.terrain&&l.elevation>=0&&l.pitch<=90)return{};const m=l.getCameraLngLat(),w=l.getCameraAltitude(),C=this.terrain?this.terrain.getElevationForLngLatZoom(m,l.zoom):0;if(w<C){const N=this.calculateCameraOptionsFromTo(m,C,l.center,l.elevation);return{pitch:N.pitch,zoom:N.zoom}}return{}}_applyUpdatedTransform(l){const m=[];if(m.push((C=>this._elevateCameraIfInsideTerrain(C))),this.transformCameraUpdate&&m.push((C=>this.transformCameraUpdate(C))),!m.length)return;const w=l.clone();for(const C of m){const N=w.clone(),{center:j,zoom:Y,roll:te,pitch:ue,bearing:ge,elevation:Ce}=C(N);j&&N.setCenter(j),Ce!==void 0&&N.setElevation(Ce),Y!==void 0&&N.setZoom(Y),te!==void 0&&N.setRoll(te),ue!==void 0&&N.setPitch(ue),ge!==void 0&&N.setBearing(ge),w.apply(N)}this.transform.apply(w)}_fireMoveEvents(l){this.fire(new o.l("move",l)),this._zooming&&this.fire(new o.l("zoom",l)),this._rotating&&this.fire(new o.l("rotate",l)),this._pitching&&this.fire(new o.l("pitch",l)),this._rolling&&this.fire(new o.l("roll",l))}_afterEase(l,m){if(this._easeId&&m&&this._easeId===m)return;delete this._easeId;const w=this._zooming,C=this._rotating,N=this._pitching,j=this._rolling;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._rolling=!1,this._padding=!1,w&&this.fire(new o.l("zoomend",l)),C&&this.fire(new o.l("rotateend",l)),N&&this.fire(new o.l("pitchend",l)),j&&this.fire(new o.l("rollend",l)),this.fire(new o.l("moveend",l))}flyTo(l,m){if(!l.essential&&b.prefersReducedMotion){const mr=o.Q(l,["center","zoom","bearing","pitch","roll","elevation"]);return this.jumpTo(mr,m)}this.stop(),l=o.e({offset:[0,0],speed:1.2,curve:1.42,easing:o.co},l);const w=this._getTransformForUpdate(),C=w.bearing,N=w.pitch,j=w.roll,Y=w.padding,te="bearing"in l?this._normalizeBearing(l.bearing,C):C,ue="pitch"in l?+l.pitch:N,ge="roll"in l?this._normalizeBearing(l.roll,j):j,Ce="padding"in l?l.padding:w.padding,Se=o.P.convert(l.offset);let Fe=w.centerPoint.add(Se);const Ge=w.screenPointToLocation(Fe),ut=this.cameraHelper.handleFlyTo(w,{bearing:te,pitch:ue,roll:ge,padding:Ce,locationAtOffset:Ge,offsetAsPoint:Se,center:l.center,minZoom:l.minZoom,zoom:l.zoom});let lt=l.curve;const ct=Math.max(w.width,w.height),xt=ct/ut.scaleOfZoom,Pt=ut.pixelPathLength;typeof ut.scaleOfMinZoom=="number"&&(lt=Math.sqrt(ct/ut.scaleOfMinZoom/Pt*2));const Ct=lt*lt;function Ot(mr){const tn=(xt*xt-ct*ct+(mr?-1:1)*Ct*Ct*Pt*Pt)/(2*(mr?xt:ct)*Ct*Pt);return Math.log(Math.sqrt(tn*tn+1)-tn)}function Bt(mr){return(Math.exp(mr)-Math.exp(-mr))/2}function At(mr){return(Math.exp(mr)+Math.exp(-mr))/2}const qt=Ot(!1);let Sr=function(mr){return At(qt)/At(qt+lt*mr)},fr=function(mr){return ct*((At(qt)*(Bt(tn=qt+lt*mr)/At(tn))-Bt(qt))/Ct)/Pt;var tn},dr=(Ot(!0)-qt)/lt;if(Math.abs(Pt)<2e-6||!isFinite(dr)){if(Math.abs(ct-xt)<1e-6)return this.easeTo(l,m);const mr=xt<ct?-1:1;dr=Math.abs(Math.log(xt/ct))/lt,fr=()=>0,Sr=tn=>Math.exp(mr*lt*tn)}return l.duration="duration"in l?+l.duration:1e3*dr/("screenSpeed"in l?+l.screenSpeed/lt:+l.speed),l.maxDuration&&l.duration>l.maxDuration&&(l.duration=0),this._zooming=!0,this._rotating=C!==te,this._pitching=ue!==N,this._rolling=ge!==j,this._padding=!w.isPaddingEqual(Ce),this._prepareEase(m,!1),this.terrain&&this._prepareElevation(ut.targetCenter),this._ease((mr=>{const tn=mr*dr,nn=1/Sr(tn),qr=fr(tn);this._rotating&&w.setBearing(o.C.number(C,te,mr)),this._pitching&&w.setPitch(o.C.number(N,ue,mr)),this._rolling&&w.setRoll(o.C.number(j,ge,mr)),this._padding&&(w.interpolatePadding(Y,Ce,mr),Fe=w.centerPoint.add(Se)),ut.easeFunc(mr,nn,qr,Fe),this.terrain&&!l.freezeElevation&&this._updateElevation(mr),this._applyUpdatedTransform(w),this._fireMoveEvents(m)}),(()=>{this.terrain&&l.freezeElevation&&this._finalizeElevation(),this._afterEase(m)}),l),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(l,m){var w;if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){const C=this._onEaseEnd;delete this._onEaseEnd,C.call(this,m)}return l||(w=this.handlers)===null||w===void 0||w.stop(!1),this}_ease(l,m,w){w.animate===!1||w.duration===0?(l(1),m()):(this._easeStart=b.now(),this._easeOptions=w,this._onEaseFrame=l,this._onEaseEnd=m,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_normalizeBearing(l,m){l=o.aO(l,-180,180);const w=Math.abs(l-m);return Math.abs(l-360-m)<w&&(l-=360),Math.abs(l+360-m)<w&&(l+=360),l}queryTerrainElevation(l){return this.terrain?this.terrain.getElevationForLngLatZoom(o.S.convert(l),this.transform.tileZoom):null}}const ta={compact:!0,customAttribution:'<a href="https://maplibre.org/" target="_blank">MapLibre</a>'};class za{constructor(l=ta){this._toggleAttribution=()=>{this._container.classList.contains("maplibregl-compact")&&(this._container.classList.contains("maplibregl-compact-show")?(this._container.setAttribute("open",""),this._container.classList.remove("maplibregl-compact-show")):(this._container.classList.add("maplibregl-compact-show"),this._container.removeAttribute("open")))},this._updateData=m=>{!m||m.sourceDataType!=="metadata"&&m.sourceDataType!=="visibility"&&m.dataType!=="style"&&m.type!=="terrain"||this._updateAttributions()},this._updateCompact=()=>{this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact===!1?this._container.setAttribute("open",""):this._container.classList.contains("maplibregl-compact")||this._container.classList.contains("maplibregl-attrib-empty")||(this._container.setAttribute("open",""),this._container.classList.add("maplibregl-compact","maplibregl-compact-show")):(this._container.setAttribute("open",""),this._container.classList.contains("maplibregl-compact")&&this._container.classList.remove("maplibregl-compact","maplibregl-compact-show"))},this._updateCompactMinimize=()=>{this._container.classList.contains("maplibregl-compact")&&this._container.classList.contains("maplibregl-compact-show")&&this._container.classList.remove("maplibregl-compact-show")},this.options=l}getDefaultPosition(){return"bottom-right"}onAdd(l){return this._map=l,this._compact=this.options.compact,this._container=v.create("details","maplibregl-ctrl maplibregl-ctrl-attrib"),this._compactButton=v.create("summary","maplibregl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=v.create("div","maplibregl-ctrl-attrib-inner",this._container),this._updateAttributions(),this._updateCompact(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("terrain",this._updateData),this._map.on("resize",this._updateCompact),this._map.on("drag",this._updateCompactMinimize),this._container}onRemove(){v.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("terrain",this._updateData),this._map.off("resize",this._updateCompact),this._map.off("drag",this._updateCompactMinimize),this._map=void 0,this._compact=void 0,this._attribHTML=void 0}_setElementTitle(l,m){const w=this._map._getUIString(`AttributionControl.${m}`);l.title=w,l.setAttribute("aria-label",w)}_updateAttributions(){if(!this._map.style)return;let l=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?l=l.concat(this.options.customAttribution.map((C=>typeof C!="string"?"":C))):typeof this.options.customAttribution=="string"&&l.push(this.options.customAttribution)),this._map.style.stylesheet){const C=this._map.style.stylesheet;this.styleOwner=C.owner,this.styleId=C.id}const m=this._map.style.sourceCaches;for(const C in m){const N=m[C];if(N.used||N.usedForTerrain){const j=N.getSource();j.attribution&&l.indexOf(j.attribution)<0&&l.push(j.attribution)}}l=l.filter((C=>String(C).trim())),l.sort(((C,N)=>C.length-N.length)),l=l.filter(((C,N)=>{for(let j=N+1;j<l.length;j++)if(l[j].indexOf(C)>=0)return!1;return!0}));const w=l.join(" | ");w!==this._attribHTML&&(this._attribHTML=w,l.length?(this._innerContainer.innerHTML=v.sanitize(w),this._container.classList.remove("maplibregl-attrib-empty")):this._container.classList.add("maplibregl-attrib-empty"),this._updateCompact(),this._editLink=null)}}class Ss{constructor(l={}){this._updateCompact=()=>{const m=this._container.children;if(m.length){const w=m[0];this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact!==!1&&w.classList.add("maplibregl-compact"):w.classList.remove("maplibregl-compact")}},this.options=l}getDefaultPosition(){return"bottom-left"}onAdd(l){this._map=l,this._compact=this.options&&this.options.compact,this._container=v.create("div","maplibregl-ctrl");const m=v.create("a","maplibregl-ctrl-logo");return m.target="_blank",m.rel="noopener nofollow",m.href="https://maplibre.org/",m.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),m.setAttribute("rel","noopener nofollow"),this._container.appendChild(m),this._container.style.display="block",this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){v.remove(this._container),this._map.off("resize",this._updateCompact),this._map=void 0,this._compact=void 0}}class fo{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(l){const m=++this._id;return this._queue.push({callback:l,id:m,cancelled:!1}),m}remove(l){const m=this._currentlyRunning,w=m?this._queue.concat(m):this._queue;for(const C of w)if(C.id===l)return void(C.cancelled=!0)}run(l=0){if(this._currentlyRunning)throw new Error("Attempting to run(), but is already running.");const m=this._currentlyRunning=this._queue;this._queue=[];for(const w of m)if(!w.cancelled&&(w.callback(l),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}var to=o.aJ([{name:"a_pos3d",type:"Int16",components:3}]);class xn extends o.E{constructor(l){super(),this._lastTilesetChange=b.now(),this.sourceCache=l,this._tiles={},this._renderableTilesKeys=[],this._sourceTileCache={},this.minzoom=0,this.maxzoom=22,this.deltaZoom=1,this.tileSize=l._source.tileSize*2**this.deltaZoom,l.usedForTerrain=!0,l.tileSize=this.tileSize}destruct(){this.sourceCache.usedForTerrain=!1,this.sourceCache.tileSize=null}update(l,m){this.sourceCache.update(l,m),this._renderableTilesKeys=[];const w={};for(const C of bt(l,{tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,reparseOverscaled:!1,terrain:m,calculateTileZoom:this.sourceCache._source.calculateTileZoom}))w[C.key]=!0,this._renderableTilesKeys.push(C.key),this._tiles[C.key]||(C.terrainRttPosMatrix32f=new Float64Array(16),o.bY(C.terrainRttPosMatrix32f,0,o.$,o.$,0,0,1),this._tiles[C.key]=new ir(C,this.tileSize),this._lastTilesetChange=b.now());for(const C in this._tiles)w[C]||delete this._tiles[C]}freeRtt(l){for(const m in this._tiles){const w=this._tiles[m];(!l||w.tileID.equals(l)||w.tileID.isChildOf(l)||l.isChildOf(w.tileID))&&(w.rtt=[])}}getRenderableTiles(){return this._renderableTilesKeys.map((l=>this.getTileByID(l)))}getTileByID(l){return this._tiles[l]}getTerrainCoords(l,m){return m?this._getTerrainCoordsForTileRanges(l,m):this._getTerrainCoordsForRegularTile(l)}_getTerrainCoordsForRegularTile(l){const m={};for(const w of this._renderableTilesKeys){const C=this._tiles[w].tileID,N=l.clone(),j=o.ba();if(C.canonical.equals(l.canonical))o.bY(j,0,o.$,o.$,0,0,1);else if(C.canonical.isChildOf(l.canonical)){const Y=C.canonical.z-l.canonical.z,te=C.canonical.x-(C.canonical.x>>Y<<Y),ue=C.canonical.y-(C.canonical.y>>Y<<Y),ge=o.$>>Y;o.bY(j,0,ge,ge,0,0,1),o.M(j,j,[-te*ge,-ue*ge,0])}else{if(!l.canonical.isChildOf(C.canonical))continue;{const Y=l.canonical.z-C.canonical.z,te=l.canonical.x-(l.canonical.x>>Y<<Y),ue=l.canonical.y-(l.canonical.y>>Y<<Y),ge=o.$>>Y;o.bY(j,0,o.$,o.$,0,0,1),o.M(j,j,[te*ge,ue*ge,0]),o.N(j,j,[1/2**Y,1/2**Y,0])}}N.terrainRttPosMatrix32f=new Float32Array(j),m[w]=N}return m}_getTerrainCoordsForTileRanges(l,m){const w={};for(const C of this._renderableTilesKeys){const N=this._tiles[C].tileID;if(!this._isWithinTileRanges(N,m))continue;const j=l.clone(),Y=o.ba();if(N.canonical.z===l.canonical.z){const te=l.canonical.x-N.canonical.x,ue=l.canonical.y-N.canonical.y;o.bY(Y,0,o.$,o.$,0,0,1),o.M(Y,Y,[te*o.$,ue*o.$,0])}else if(N.canonical.z>l.canonical.z){const te=N.canonical.z-l.canonical.z,ue=N.canonical.x-(N.canonical.x>>te<<te),ge=N.canonical.y-(N.canonical.y>>te<<te),Ce=l.canonical.x-(N.canonical.x>>te),Se=l.canonical.y-(N.canonical.y>>te),Fe=o.$>>te;o.bY(Y,0,Fe,Fe,0,0,1),o.M(Y,Y,[-ue*Fe+Ce*o.$,-ge*Fe+Se*o.$,0])}else{const te=l.canonical.z-N.canonical.z,ue=l.canonical.x-(l.canonical.x>>te<<te),ge=l.canonical.y-(l.canonical.y>>te<<te),Ce=(l.canonical.x>>te)-N.canonical.x,Se=(l.canonical.y>>te)-N.canonical.y,Fe=o.$<<te;o.bY(Y,0,Fe,Fe,0,0,1),o.M(Y,Y,[ue*o.$+Ce*Fe,ge*o.$+Se*Fe,0])}j.terrainRttPosMatrix32f=new Float32Array(Y),w[C]=j}return w}getSourceTile(l,m){const w=this.sourceCache._source;let C=l.overscaledZ-this.deltaZoom;if(C>w.maxzoom&&(C=w.maxzoom),C<w.minzoom)return null;this._sourceTileCache[l.key]||(this._sourceTileCache[l.key]=l.scaledTo(C).key);let N=this.sourceCache.getTileByID(this._sourceTileCache[l.key]);if((!N||!N.dem)&&m)for(;C>=w.minzoom&&(!N||!N.dem);)N=this.sourceCache.getTileByID(l.scaledTo(C--).key);return N}anyTilesAfterTime(l=Date.now()){return this._lastTilesetChange>=l}_isWithinTileRanges(l,m){return m[l.canonical.z]&&l.canonical.x>=m[l.canonical.z].minTileX&&l.canonical.x<=m[l.canonical.z].maxTileX&&l.canonical.y>=m[l.canonical.z].minTileY&&l.canonical.y<=m[l.canonical.z].maxTileY}}class On{constructor(l,m,w){this._meshCache={},this.painter=l,this.sourceCache=new xn(m),this.options=w,this.exaggeration=typeof w.exaggeration=="number"?w.exaggeration:1,this.qualityFactor=2,this.meshSize=128,this._demMatrixCache={},this.coordsIndex=[],this._coordsTextureSize=1024}getDEMElevation(l,m,w,C=o.$){var N;if(!(m>=0&&m<C&&w>=0&&w<C))return 0;const j=this.getTerrainData(l),Y=(N=j.tile)===null||N===void 0?void 0:N.dem;if(!Y)return 0;const te=o.cs([],[m/C*o.$,w/C*o.$],j.u_terrain_matrix),ue=[te[0]*Y.dim,te[1]*Y.dim],ge=Math.floor(ue[0]),Ce=Math.floor(ue[1]),Se=ue[0]-ge,Fe=ue[1]-Ce;return Y.get(ge,Ce)*(1-Se)*(1-Fe)+Y.get(ge+1,Ce)*Se*(1-Fe)+Y.get(ge,Ce+1)*(1-Se)*Fe+Y.get(ge+1,Ce+1)*Se*Fe}getElevationForLngLatZoom(l,m){if(!o.ct(m,l.wrap()))return 0;const{tileID:w,mercatorX:C,mercatorY:N}=this._getOverscaledTileIDFromLngLatZoom(l,m);return this.getElevation(w,C%o.$,N%o.$,o.$)}getElevation(l,m,w,C=o.$){return this.getDEMElevation(l,m,w,C)*this.exaggeration}getTerrainData(l){if(!this._emptyDemTexture){const C=this.painter.context,N=new o.R({width:1,height:1},new Uint8Array(4));this._emptyDepthTexture=new o.T(C,N,C.gl.RGBA,{premultiply:!1}),this._emptyDemUnpack=[0,0,0,0],this._emptyDemTexture=new o.T(C,new o.R({width:1,height:1}),C.gl.RGBA,{premultiply:!1}),this._emptyDemTexture.bind(C.gl.NEAREST,C.gl.CLAMP_TO_EDGE),this._emptyDemMatrix=o.ag([])}const m=this.sourceCache.getSourceTile(l,!0);if(m&&m.dem&&(!m.demTexture||m.needsTerrainPrepare)){const C=this.painter.context;m.demTexture=this.painter.getTileTexture(m.dem.stride),m.demTexture?m.demTexture.update(m.dem.getPixels(),{premultiply:!1}):m.demTexture=new o.T(C,m.dem.getPixels(),C.gl.RGBA,{premultiply:!1}),m.demTexture.bind(C.gl.NEAREST,C.gl.CLAMP_TO_EDGE),m.needsTerrainPrepare=!1}const w=m&&m+m.tileID.key+l.key;if(w&&!this._demMatrixCache[w]){const C=this.sourceCache.sourceCache._source.maxzoom;let N=l.canonical.z-m.tileID.canonical.z;l.overscaledZ>l.canonical.z&&(l.canonical.z>=C?N=l.canonical.z-C:o.w("cannot calculate elevation if elevation maxzoom > source.maxzoom"));const j=l.canonical.x-(l.canonical.x>>N<<N),Y=l.canonical.y-(l.canonical.y>>N<<N),te=o.cu(new Float64Array(16),[1/(o.$<<N),1/(o.$<<N),0]);o.M(te,te,[j*o.$,Y*o.$,0]),this._demMatrixCache[l.key]={matrix:te,coord:l}}return{u_depth:2,u_terrain:3,u_terrain_dim:m&&m.dem&&m.dem.dim||1,u_terrain_matrix:w?this._demMatrixCache[l.key].matrix:this._emptyDemMatrix,u_terrain_unpack:m&&m.dem&&m.dem.getUnpackVector()||this._emptyDemUnpack,u_terrain_exaggeration:this.exaggeration,texture:(m&&m.demTexture||this._emptyDemTexture).texture,depthTexture:(this._fboDepthTexture||this._emptyDepthTexture).texture,tile:m}}getFramebuffer(l){const m=this.painter,w=m.width/devicePixelRatio,C=m.height/devicePixelRatio;return!this._fbo||this._fbo.width===w&&this._fbo.height===C||(this._fbo.destroy(),this._fboCoordsTexture.destroy(),this._fboDepthTexture.destroy(),delete this._fbo,delete this._fboDepthTexture,delete this._fboCoordsTexture),this._fboCoordsTexture||(this._fboCoordsTexture=new o.T(m.context,{width:w,height:C,data:null},m.context.gl.RGBA,{premultiply:!1}),this._fboCoordsTexture.bind(m.context.gl.NEAREST,m.context.gl.CLAMP_TO_EDGE)),this._fboDepthTexture||(this._fboDepthTexture=new o.T(m.context,{width:w,height:C,data:null},m.context.gl.RGBA,{premultiply:!1}),this._fboDepthTexture.bind(m.context.gl.NEAREST,m.context.gl.CLAMP_TO_EDGE)),this._fbo||(this._fbo=m.context.createFramebuffer(w,C,!0,!1),this._fbo.depthAttachment.set(m.context.createRenderbuffer(m.context.gl.DEPTH_COMPONENT16,w,C))),this._fbo.colorAttachment.set(l==="coords"?this._fboCoordsTexture.texture:this._fboDepthTexture.texture),this._fbo}getCoordsTexture(){const l=this.painter.context;if(this._coordsTexture)return this._coordsTexture;const m=new Uint8Array(this._coordsTextureSize*this._coordsTextureSize*4);for(let N=0,j=0;N<this._coordsTextureSize;N++)for(let Y=0;Y<this._coordsTextureSize;Y++,j+=4)m[j+0]=255&Y,m[j+1]=255&N,m[j+2]=Y>>8<<4|N>>8,m[j+3]=0;const w=new o.R({width:this._coordsTextureSize,height:this._coordsTextureSize},new Uint8Array(m.buffer)),C=new o.T(l,w,l.gl.RGBA,{premultiply:!1});return C.bind(l.gl.NEAREST,l.gl.CLAMP_TO_EDGE),this._coordsTexture=C,C}pointCoordinate(l){this.painter.maybeDrawDepthAndCoords(!0);const m=new Uint8Array(4),w=this.painter.context,C=w.gl,N=Math.round(l.x*this.painter.pixelRatio/devicePixelRatio),j=Math.round(l.y*this.painter.pixelRatio/devicePixelRatio),Y=Math.round(this.painter.height/devicePixelRatio);w.bindFramebuffer.set(this.getFramebuffer("coords").framebuffer),C.readPixels(N,Y-j-1,1,1,C.RGBA,C.UNSIGNED_BYTE,m),w.bindFramebuffer.set(null);const te=m[0]+(m[2]>>4<<8),ue=m[1]+((15&m[2])<<8),ge=this.coordsIndex[255-m[3]],Ce=ge&&this.sourceCache.getTileByID(ge);if(!Ce)return null;const Se=this._coordsTextureSize,Fe=(1<<Ce.tileID.canonical.z)*Se;return new o.a1((Ce.tileID.canonical.x*Se+te)/Fe+Ce.tileID.wrap,(Ce.tileID.canonical.y*Se+ue)/Fe,this.getElevation(Ce.tileID,te,ue,Se))}depthAtPoint(l){const m=new Uint8Array(4),w=this.painter.context,C=w.gl;return w.bindFramebuffer.set(this.getFramebuffer("depth").framebuffer),C.readPixels(l.x,this.painter.height/devicePixelRatio-l.y-1,1,1,C.RGBA,C.UNSIGNED_BYTE,m),w.bindFramebuffer.set(null),(m[0]/16777216+m[1]/65536+m[2]/256+m[3])/256}getTerrainMesh(l){var m;const w=((m=this.painter.style.projection)===null||m===void 0?void 0:m.transitionState)>0,C=w&&l.canonical.y===0,N=w&&l.canonical.y===(1<<l.canonical.z)-1,j=`m_${C?"n":""}_${N?"s":""}`;if(this._meshCache[j])return this._meshCache[j];const Y=this.painter.context,te=new o.cv,ue=new o.aN,ge=this.meshSize,Ce=o.$/ge,Se=ge*ge;for(let At=0;At<=ge;At++)for(let qt=0;qt<=ge;qt++)te.emplaceBack(qt*Ce,At*Ce,0);for(let At=0;At<Se;At+=ge+1)for(let qt=0;qt<ge;qt++)ue.emplaceBack(qt+At,ge+qt+At+1,ge+qt+At+2),ue.emplaceBack(qt+At,ge+qt+At+2,qt+At+1);const Fe=te.length,Ge=Fe+(ge+1),ut=(ge+1)*ge,lt=C?o.bh:0,ct=C?0:1,xt=N?o.bi:o.$,Pt=N?0:1;for(let At=0;At<=ge;At++)te.emplaceBack(At*Ce,lt,ct);for(let At=0;At<=ge;At++)te.emplaceBack(At*Ce,xt,Pt);for(let At=0;At<ge;At++)ue.emplaceBack(ut+At,Ge+At,Ge+At+1),ue.emplaceBack(ut+At,Ge+At+1,ut+At+1),ue.emplaceBack(0+At,Fe+At+1,Fe+At),ue.emplaceBack(0+At,0+At+1,Fe+At+1);const Ct=te.length,Ot=Ct+2*(ge+1);for(const At of[0,1])for(let qt=0;qt<=ge;qt++)for(const Sr of[0,1])te.emplaceBack(At*o.$,qt*Ce,Sr);for(let At=0;At<2*ge;At+=2)ue.emplaceBack(Ct+At,Ct+At+1,Ct+At+3),ue.emplaceBack(Ct+At,Ct+At+3,Ct+At+2),ue.emplaceBack(Ot+At,Ot+At+3,Ot+At+1),ue.emplaceBack(Ot+At,Ot+At+2,Ot+At+3);const Bt=new Gt(Y.createVertexBuffer(te,to.members),Y.createIndexBuffer(ue),o.aM.simpleSegment(0,0,te.length,ue.length));return this._meshCache[j]=Bt,Bt}getMeshFrameDelta(l){return 2*Math.PI*o.bu/Math.pow(2,Math.max(l,0))/5}getMinTileElevationForLngLatZoom(l,m){var w;const{tileID:C}=this._getOverscaledTileIDFromLngLatZoom(l,m);return(w=this.getMinMaxElevation(C).minElevation)!==null&&w!==void 0?w:0}getMinMaxElevation(l){const m=this.getTerrainData(l).tile,w={minElevation:null,maxElevation:null};return m&&m.dem&&(w.minElevation=m.dem.min*this.exaggeration,w.maxElevation=m.dem.max*this.exaggeration),w}_getOverscaledTileIDFromLngLatZoom(l,m){const w=o.a1.fromLngLat(l.wrap()),C=(1<<m)*o.$,N=w.x*C,j=w.y*C,Y=Math.floor(N/o.$),te=Math.floor(j/o.$);return{tileID:new o.Z(m,0,m,Y,te),mercatorX:N,mercatorY:j}}}class Io{constructor(l,m,w){this._context=l,this._size=m,this._tileSize=w,this._objects=[],this._recentlyUsed=[],this._stamp=0}destruct(){for(const l of this._objects)l.texture.destroy(),l.fbo.destroy()}_createObject(l){const m=this._context.createFramebuffer(this._tileSize,this._tileSize,!0,!0),w=new o.T(this._context,{width:this._tileSize,height:this._tileSize,data:null},this._context.gl.RGBA);return w.bind(this._context.gl.LINEAR,this._context.gl.CLAMP_TO_EDGE),this._context.extTextureFilterAnisotropic&&this._context.gl.texParameterf(this._context.gl.TEXTURE_2D,this._context.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,this._context.extTextureFilterAnisotropicMax),m.depthAttachment.set(this._context.createRenderbuffer(this._context.gl.DEPTH_STENCIL,this._tileSize,this._tileSize)),m.colorAttachment.set(w.texture),{id:l,fbo:m,texture:w,stamp:-1,inUse:!1}}getObjectForId(l){return this._objects[l]}useObject(l){l.inUse=!0,this._recentlyUsed=this._recentlyUsed.filter((m=>l.id!==m)),this._recentlyUsed.push(l.id)}stampObject(l){l.stamp=++this._stamp}getOrCreateFreeObject(){for(const m of this._recentlyUsed)if(!this._objects[m].inUse)return this._objects[m];if(this._objects.length>=this._size)throw new Error("No free RenderPool available, call freeAllObjects() required!");const l=this._createObject(this._objects.length);return this._objects.push(l),l}freeObject(l){l.inUse=!1}freeAllObjects(){for(const l of this._objects)this.freeObject(l)}isFull(){return!(this._objects.length<this._size)&&this._objects.some((l=>!l.inUse))===!1}}const zi={background:!0,fill:!0,line:!0,raster:!0,hillshade:!0,"color-relief":!0};class la{constructor(l,m){this.painter=l,this.terrain=m,this.pool=new Io(l.context,30,m.sourceCache.tileSize*m.qualityFactor)}destruct(){this.pool.destruct()}getTexture(l){return this.pool.getObjectForId(l.rtt[this._stacks.length-1].id).texture}prepareForRender(l,m){this._stacks=[],this._prevType=null,this._rttTiles=[],this._renderableTiles=this.terrain.sourceCache.getRenderableTiles(),this._renderableLayerIds=l._order.filter((w=>!l._layers[w].isHidden(m))),this._coordsAscending={};for(const w in l.sourceCaches){this._coordsAscending[w]={};const C=l.sourceCaches[w].getVisibleCoordinates(),N=l.sourceCaches[w].getSource(),j=N instanceof vt?N.terrainTileRanges:null;for(const Y of C){const te=this.terrain.sourceCache.getTerrainCoords(Y,j);for(const ue in te)this._coordsAscending[w][ue]||(this._coordsAscending[w][ue]=[]),this._coordsAscending[w][ue].push(te[ue])}}this._coordsAscendingStr={};for(const w of l._order){const C=l._layers[w],N=C.source;if(zi[C.type]&&!this._coordsAscendingStr[N]){this._coordsAscendingStr[N]={};for(const j in this._coordsAscending[N])this._coordsAscendingStr[N][j]=this._coordsAscending[N][j].map((Y=>Y.key)).sort().join()}}for(const w of this._renderableTiles)for(const C in this._coordsAscendingStr){const N=this._coordsAscendingStr[C][w.tileID.key];N&&N!==w.rttCoords[C]&&(w.rtt=[])}}renderLayer(l,m){if(l.isHidden(this.painter.transform.zoom))return!1;const w=Object.assign(Object.assign({},m),{isRenderingToTexture:!0}),C=l.type,N=this.painter,j=this._renderableLayerIds[this._renderableLayerIds.length-1]===l.id;if(zi[C]&&(this._prevType&&zi[this._prevType]||this._stacks.push([]),this._prevType=C,this._stacks[this._stacks.length-1].push(l.id),!j))return!0;if(zi[this._prevType]||zi[C]&&j){this._prevType=C;const Y=this._stacks.length-1,te=this._stacks[Y]||[];for(const ue of this._renderableTiles){if(this.pool.isFull()&&(lp(this.painter,this.terrain,this._rttTiles,w),this._rttTiles=[],this.pool.freeAllObjects()),this._rttTiles.push(ue),ue.rtt[Y]){const Ce=this.pool.getObjectForId(ue.rtt[Y].id);if(Ce.stamp===ue.rtt[Y].stamp){this.pool.useObject(Ce);continue}}const ge=this.pool.getOrCreateFreeObject();this.pool.useObject(ge),this.pool.stampObject(ge),ue.rtt[Y]={id:ge.id,stamp:ge.stamp},N.context.bindFramebuffer.set(ge.fbo.framebuffer),N.context.clear({color:o.bf.transparent,stencil:0}),N.currentStencilSource=void 0;for(let Ce=0;Ce<te.length;Ce++){const Se=N.style._layers[te[Ce]],Fe=Se.source?this._coordsAscending[Se.source][ue.tileID.key]:[ue.tileID];N.context.viewport.set([0,0,ge.fbo.width,ge.fbo.height]),N._renderTileClippingMasks(Se,Fe,!0),N.renderLayer(N,N.style.sourceCaches[Se.source],Se,Fe,w),Se.source&&(ue.rttCoords[Se.source]=this._coordsAscendingStr[Se.source][ue.tileID.key])}}return lp(this.painter,this.terrain,this._rttTiles,w),this._rttTiles=[],this.pool.freeAllObjects(),zi[C]}return!1}}const ra={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"MapLibre logo","Map.Title":"Map","Marker.Title":"Map marker","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","Popup.Close":"Close popup","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm","GlobeControl.Enable":"Enable globe","GlobeControl.Disable":"Disable globe","TerrainControl.Enable":"Enable terrain","TerrainControl.Disable":"Disable terrain","CooperativeGesturesHandler.WindowsHelpText":"Use Ctrl + scroll to zoom the map","CooperativeGesturesHandler.MacHelpText":"Use  + scroll to zoom the map","CooperativeGesturesHandler.MobileHelpText":"Use two fingers to move the map"},_a=u,Oa={hash:!1,interactive:!0,bearingSnap:7,attributionControl:ta,maplibreLogo:!1,refreshExpiredTiles:!0,canvasContextAttributes:{antialias:!1,preserveDrawingBuffer:!1,powerPreference:"high-performance",failIfMajorPerformanceCaveat:!1,desynchronized:!1,contextType:void 0},scrollZoom:!0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,trackResize:!0,center:[0,0],elevation:0,zoom:0,bearing:0,pitch:0,roll:0,renderWorldCopies:!0,maxTileCacheSize:null,maxTileCacheZoomLevels:o.a.MAX_TILE_CACHE_ZOOM_LEVELS,transformRequest:null,transformCameraUpdate:null,fadeDuration:300,crossSourceCollisions:!0,clickTolerance:3,localIdeographFontFamily:"sans-serif",pitchWithRotate:!0,rollEnabled:!1,validateStyle:!0,maxCanvasSize:[4096,4096],cancelPendingTileRequestsWhileZooming:!0,centerClampedToGround:!0},Zu={showCompass:!0,showZoom:!0,visualizePitch:!1,visualizeRoll:!0};class ro{constructor(l,m,w=!1){this.mousedown=N=>{this.startMove(N,v.mousePos(this.element,N)),v.addEventListener(window,"mousemove",this.mousemove),v.addEventListener(window,"mouseup",this.mouseup)},this.mousemove=N=>{this.move(N,v.mousePos(this.element,N))},this.mouseup=N=>{this._rotatePitchHandler.dragEnd(N),this.offTemp()},this.touchstart=N=>{N.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=v.touchPos(this.element,N.targetTouches)[0],this.startMove(N,this._startPos),v.addEventListener(window,"touchmove",this.touchmove,{passive:!1}),v.addEventListener(window,"touchend",this.touchend))},this.touchmove=N=>{N.targetTouches.length!==1?this.reset():(this._lastPos=v.touchPos(this.element,N.targetTouches)[0],this.move(N,this._lastPos))},this.touchend=N=>{N.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),delete this._startPos,delete this._lastPos,this.offTemp()},this.reset=()=>{this._rotatePitchHandler.reset(),delete this._startPos,delete this._lastPos,this.offTemp()},this._clickTolerance=10,this.element=m;const C=new Pe;this._rotatePitchHandler=new Cf({clickTolerance:3,move:(N,j)=>{const Y=m.getBoundingClientRect(),te=new o.P((Y.bottom-Y.top)/2,(Y.right-Y.left)/2);return{bearingDelta:o.cn(new o.P(N.x,j.y),j,te),pitchDelta:w?-.5*(j.y-N.y):void 0}},moveStateManager:C,enable:!0,assignEvents:()=>{}}),this.map=l,v.addEventListener(m,"mousedown",this.mousedown),v.addEventListener(m,"touchstart",this.touchstart,{passive:!1}),v.addEventListener(m,"touchcancel",this.reset)}startMove(l,m){this._rotatePitchHandler.dragStart(l,m),v.disableDrag()}move(l,m){const w=this.map,{bearingDelta:C,pitchDelta:N}=this._rotatePitchHandler.dragMove(l,m)||{};C&&w.setBearing(w.getBearing()+C),N&&w.setPitch(w.getPitch()+N)}off(){const l=this.element;v.removeEventListener(l,"mousedown",this.mousedown),v.removeEventListener(l,"touchstart",this.touchstart,{passive:!1}),v.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),v.removeEventListener(window,"touchend",this.touchend),v.removeEventListener(l,"touchcancel",this.reset),this.offTemp()}offTemp(){v.enableDrag(),v.removeEventListener(window,"mousemove",this.mousemove),v.removeEventListener(window,"mouseup",this.mouseup),v.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),v.removeEventListener(window,"touchend",this.touchend)}}let Ni;function wi(R,l,m,w=!1){if(w||!m.getCoveringTilesDetailsProvider().allowWorldCopies())return R?.wrap();const C=new o.S(R.lng,R.lat);if(R=new o.S(R.lng,R.lat),l){const N=new o.S(R.lng-360,R.lat),j=new o.S(R.lng+360,R.lat),Y=m.locationToScreenPoint(R).distSqr(l);m.locationToScreenPoint(N).distSqr(l)<Y?R=N:m.locationToScreenPoint(j).distSqr(l)<Y&&(R=j)}for(;Math.abs(R.lng-m.center.lng)>180;){const N=m.locationToScreenPoint(R);if(N.x>=0&&N.y>=0&&N.x<=m.width&&N.y<=m.height)break;R.lng>m.center.lng?R.lng-=360:R.lng+=360}return R.lng!==C.lng&&m.isPointOnMapSurface(m.locationToScreenPoint(R))?R:C}const Po={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function Es(R,l,m){const w=R.classList;for(const C in Po)w.remove(`maplibregl-${m}-anchor-${C}`);w.add(`maplibregl-${m}-anchor-${l}`)}class es extends o.E{constructor(l){if(super(),this._onKeyPress=m=>{const w=m.code,C=m.charCode||m.keyCode;w!=="Space"&&w!=="Enter"&&C!==32&&C!==13||this.togglePopup()},this._onMapClick=m=>{const w=m.originalEvent.target,C=this._element;this._popup&&(w===C||C.contains(w))&&this.togglePopup()},this._update=m=>{if(!this._map)return;const w=this._map.loaded()&&!this._map.isMoving();(m?.type==="terrain"||m?.type==="render"&&!w)&&this._map.once("render",this._update),this._lngLat=wi(this._lngLat,this._flatPos,this._map.transform),this._flatPos=this._pos=this._map.project(this._lngLat)._add(this._offset),this._map.terrain&&(this._flatPos=this._map.transform.locationToScreenPoint(this._lngLat)._add(this._offset));let C="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?C=`rotateZ(${this._rotation}deg)`:this._rotationAlignment==="map"&&(C=`rotateZ(${this._rotation-this._map.getBearing()}deg)`);let N="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?N="rotateX(0deg)":this._pitchAlignment==="map"&&(N=`rotateX(${this._map.getPitch()}deg)`),this._subpixelPositioning||m&&m.type!=="moveend"||(this._pos=this._pos.round()),v.setTransform(this._element,`${Po[this._anchor]} translate(${this._pos.x}px, ${this._pos.y}px) ${N} ${C}`),b.frameAsync(new AbortController).then((()=>{this._updateOpacity(m&&m.type==="moveend")})).catch((()=>{}))},this._onMove=m=>{if(!this._isDragging){const w=this._clickTolerance||this._map._clickTolerance;this._isDragging=m.point.dist(this._pointerdownPos)>=w}this._isDragging&&(this._pos=m.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new o.l("dragstart"))),this.fire(new o.l("drag")))},this._onUp=()=>{this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new o.l("dragend")),this._state="inactive"},this._addDragHandler=m=>{this._element.contains(m.originalEvent.target)&&(m.preventDefault(),this._positionDelta=m.point.sub(this._pos).add(this._offset),this._pointerdownPos=m.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},this._anchor=l&&l.anchor||"center",this._color=l&&l.color||"#3FB1CE",this._scale=l&&l.scale||1,this._draggable=l&&l.draggable||!1,this._clickTolerance=l&&l.clickTolerance||0,this._subpixelPositioning=l&&l.subpixelPositioning||!1,this._isDragging=!1,this._state="inactive",this._rotation=l&&l.rotation||0,this._rotationAlignment=l&&l.rotationAlignment||"auto",this._pitchAlignment=l&&l.pitchAlignment&&l.pitchAlignment!=="auto"?l.pitchAlignment:this._rotationAlignment,this.setOpacity(l?.opacity,l?.opacityWhenCovered),l&&l.element)this._element=l.element,this._offset=o.P.convert(l&&l.offset||[0,0]);else{this._defaultMarker=!0,this._element=v.create("div");const m=v.createNS("http://www.w3.org/2000/svg","svg"),w=41,C=27;m.setAttributeNS(null,"display","block"),m.setAttributeNS(null,"height",`${w}px`),m.setAttributeNS(null,"width",`${C}px`),m.setAttributeNS(null,"viewBox",`0 0 ${C} ${w}`);const N=v.createNS("http://www.w3.org/2000/svg","g");N.setAttributeNS(null,"stroke","none"),N.setAttributeNS(null,"stroke-width","1"),N.setAttributeNS(null,"fill","none"),N.setAttributeNS(null,"fill-rule","evenodd");const j=v.createNS("http://www.w3.org/2000/svg","g");j.setAttributeNS(null,"fill-rule","nonzero");const Y=v.createNS("http://www.w3.org/2000/svg","g");Y.setAttributeNS(null,"transform","translate(3.0, 29.0)"),Y.setAttributeNS(null,"fill","#000000");const te=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];for(const ct of te){const xt=v.createNS("http://www.w3.org/2000/svg","ellipse");xt.setAttributeNS(null,"opacity","0.04"),xt.setAttributeNS(null,"cx","10.5"),xt.setAttributeNS(null,"cy","5.80029008"),xt.setAttributeNS(null,"rx",ct.rx),xt.setAttributeNS(null,"ry",ct.ry),Y.appendChild(xt)}const ue=v.createNS("http://www.w3.org/2000/svg","g");ue.setAttributeNS(null,"fill",this._color);const ge=v.createNS("http://www.w3.org/2000/svg","path");ge.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),ue.appendChild(ge);const Ce=v.createNS("http://www.w3.org/2000/svg","g");Ce.setAttributeNS(null,"opacity","0.25"),Ce.setAttributeNS(null,"fill","#000000");const Se=v.createNS("http://www.w3.org/2000/svg","path");Se.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),Ce.appendChild(Se);const Fe=v.createNS("http://www.w3.org/2000/svg","g");Fe.setAttributeNS(null,"transform","translate(6.0, 7.0)"),Fe.setAttributeNS(null,"fill","#FFFFFF");const Ge=v.createNS("http://www.w3.org/2000/svg","g");Ge.setAttributeNS(null,"transform","translate(8.0, 8.0)");const ut=v.createNS("http://www.w3.org/2000/svg","circle");ut.setAttributeNS(null,"fill","#000000"),ut.setAttributeNS(null,"opacity","0.25"),ut.setAttributeNS(null,"cx","5.5"),ut.setAttributeNS(null,"cy","5.5"),ut.setAttributeNS(null,"r","5.4999962");const lt=v.createNS("http://www.w3.org/2000/svg","circle");lt.setAttributeNS(null,"fill","#FFFFFF"),lt.setAttributeNS(null,"cx","5.5"),lt.setAttributeNS(null,"cy","5.5"),lt.setAttributeNS(null,"r","5.4999962"),Ge.appendChild(ut),Ge.appendChild(lt),j.appendChild(Y),j.appendChild(ue),j.appendChild(Ce),j.appendChild(Fe),j.appendChild(Ge),m.appendChild(j),m.setAttributeNS(null,"height",w*this._scale+"px"),m.setAttributeNS(null,"width",C*this._scale+"px"),this._element.appendChild(m),this._offset=o.P.convert(l&&l.offset||[0,-14])}if(this._element.classList.add("maplibregl-marker"),this._element.addEventListener("dragstart",(m=>{m.preventDefault()})),this._element.addEventListener("mousedown",(m=>{m.preventDefault()})),Es(this._element,this._anchor,"marker"),l&&l.className)for(const m of l.className.split(" "))this._element.classList.add(m);this._popup=null}addTo(l){return this.remove(),this._map=l,this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label",l._getUIString("Marker.Title")),l.getCanvasContainer().appendChild(this._element),l.on("move",this._update),l.on("moveend",this._update),l.on("terrain",this._update),l.on("projectiontransition",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this}remove(){return this._opacityTimeout&&(clearTimeout(this._opacityTimeout),delete this._opacityTimeout),this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("terrain",this._update),this._map.off("projectiontransition",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),v.remove(this._element),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(l){return this._lngLat=o.S.convert(l),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this}getElement(){return this._element}setPopup(l){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),l){if(!("offset"in l.options)){const C=Math.abs(13.5)/Math.SQRT2;l.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[C,-1*(38.1-13.5+C)],"bottom-right":[-C,-1*(38.1-13.5+C)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=l,this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this}setSubpixelPositioning(l){return this._subpixelPositioning=l,this}getPopup(){return this._popup}togglePopup(){const l=this._popup;return this._element.style.opacity===this._opacityWhenCovered?this:l?(l.isOpen()?l.remove():(l.setLngLat(this._lngLat),l.addTo(this._map)),this):this}_updateOpacity(l=!1){var m,w;const C=(m=this._map)===null||m===void 0?void 0:m.terrain,N=this._map.transform.isLocationOccluded(this._lngLat);if(!C||N){const Fe=N?this._opacityWhenCovered:this._opacity;return void(this._element.style.opacity!==Fe&&(this._element.style.opacity=Fe))}if(l)this._opacityTimeout=null;else{if(this._opacityTimeout)return;this._opacityTimeout=setTimeout((()=>{this._opacityTimeout=null}),100)}const j=this._map,Y=j.terrain.depthAtPoint(this._pos),te=j.terrain.getElevationForLngLatZoom(this._lngLat,j.transform.tileZoom);if(j.transform.lngLatToCameraDepth(this._lngLat,te)-Y<.006)return void(this._element.style.opacity=this._opacity);const ue=-this._offset.y/j.transform.pixelsPerMeter,ge=Math.sin(j.getPitch()*Math.PI/180)*ue,Ce=j.terrain.depthAtPoint(new o.P(this._pos.x,this._pos.y-this._offset.y)),Se=j.transform.lngLatToCameraDepth(this._lngLat,te+ge)-Ce>.006;!((w=this._popup)===null||w===void 0)&&w.isOpen()&&Se&&this._popup.remove(),this._element.style.opacity=Se?this._opacityWhenCovered:this._opacity}getOffset(){return this._offset}setOffset(l){return this._offset=o.P.convert(l),this._update(),this}addClassName(l){this._element.classList.add(l)}removeClassName(l){this._element.classList.remove(l)}toggleClassName(l){return this._element.classList.toggle(l)}setDraggable(l){return this._draggable=!!l,this._map&&(l?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(l){return this._rotation=l||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(l){return this._rotationAlignment=l||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(l){return this._pitchAlignment=l&&l!=="auto"?l:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}setOpacity(l,m){return(this._opacity===void 0||l===void 0&&m===void 0)&&(this._opacity="1",this._opacityWhenCovered="0.2"),l!==void 0&&(this._opacity=l),m!==void 0&&(this._opacityWhenCovered=m),this._map&&this._updateOpacity(!0),this}}const Tl={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0};let Ts=0,ts=!1;const Vs={maxWidth:100,unit:"metric"};function Ca(R,l,m){const w=m&&m.maxWidth||100,C=R._container.clientHeight/2,N=R._container.clientWidth/2,j=R.unproject([N-w/2,C]),Y=R.unproject([N+w/2,C]),te=Math.round(R.project(Y).x-R.project(j).x),ue=Math.min(w,te,R._container.clientWidth),ge=j.distanceTo(Y);if(m&&m.unit==="imperial"){const Ce=3.2808*ge;Ce>5280?fs(l,ue,Ce/5280,R._getUIString("ScaleControl.Miles")):fs(l,ue,Ce,R._getUIString("ScaleControl.Feet"))}else m&&m.unit==="nautical"?fs(l,ue,ge/1852,R._getUIString("ScaleControl.NauticalMiles")):ge>=1e3?fs(l,ue,ge/1e3,R._getUIString("ScaleControl.Kilometers")):fs(l,ue,ge,R._getUIString("ScaleControl.Meters"))}function fs(R,l,m,w){const C=(function(N){const j=Math.pow(10,`${Math.floor(N)}`.length-1);let Y=N/j;return Y=Y>=10?10:Y>=5?5:Y>=3?3:Y>=2?2:Y>=1?1:(function(te){const ue=Math.pow(10,Math.ceil(-Math.log(te)/Math.LN10));return Math.round(te*ue)/ue})(Y),j*Y})(m);R.style.width=l*(C/m)+"px",R.innerHTML=`${C}&nbsp;${w}`}const su={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px",subpixelPositioning:!1,locationOccludedOpacity:void 0},Dc=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function Au(R){if(R){if(typeof R=="number"){const l=Math.round(Math.abs(R)/Math.SQRT2);return{center:new o.P(0,0),top:new o.P(0,R),"top-left":new o.P(l,l),"top-right":new o.P(-l,l),bottom:new o.P(0,-R),"bottom-left":new o.P(l,-l),"bottom-right":new o.P(-l,-l),left:new o.P(R,0),right:new o.P(-R,0)}}if(R instanceof o.P||Array.isArray(R)){const l=o.P.convert(R);return{center:l,top:l,"top-left":l,"top-right":l,bottom:l,"bottom-left":l,"bottom-right":l,left:l,right:l}}return{center:o.P.convert(R.center||[0,0]),top:o.P.convert(R.top||[0,0]),"top-left":o.P.convert(R["top-left"]||[0,0]),"top-right":o.P.convert(R["top-right"]||[0,0]),bottom:o.P.convert(R.bottom||[0,0]),"bottom-left":o.P.convert(R["bottom-left"]||[0,0]),"bottom-right":o.P.convert(R["bottom-right"]||[0,0]),left:o.P.convert(R.left||[0,0]),right:o.P.convert(R.right||[0,0])}}return Au(new o.P(0,0))}const ds=u;s.AJAXError=o.cz,s.Event=o.l,s.Evented=o.E,s.LngLat=o.S,s.MercatorCoordinate=o.a1,s.Point=o.P,s.addProtocol=o.cA,s.config=o.a,s.removeProtocol=o.cB,s.AttributionControl=za,s.BoxZoomHandler=wg,s.CanvasSource=_r,s.CooperativeGesturesHandler=Qo,s.DoubleClickZoomHandler=Kr,s.DragPanHandler=Li,s.DragRotateHandler=Gn,s.EdgeInsets=Qr,s.FullscreenControl=class extends o.E{constructor(R={}){super(),this._onFullscreenChange=()=>{var l;let m=window.document.fullscreenElement||window.document.mozFullScreenElement||window.document.webkitFullscreenElement||window.document.msFullscreenElement;for(;!((l=m?.shadowRoot)===null||l===void 0)&&l.fullscreenElement;)m=m.shadowRoot.fullscreenElement;m===this._container!==this._fullscreen&&this._handleFullscreenChange()},this._onClickFullscreen=()=>{this._isFullscreen()?this._exitFullscreen():this._requestFullscreen()},this._fullscreen=!1,R&&R.container&&(R.container instanceof HTMLElement?this._container=R.container:o.w("Full screen control 'container' must be a DOM element.")),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in document&&(this._fullscreenchange="MSFullscreenChange")}onAdd(R){return this._map=R,this._container||(this._container=this._map.getContainer()),this._controlContainer=v.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),this._controlContainer}onRemove(){v.remove(this._controlContainer),this._map=null,window.document.removeEventListener(this._fullscreenchange,this._onFullscreenChange)}_setupUI(){const R=this._fullscreenButton=v.create("button","maplibregl-ctrl-fullscreen",this._controlContainer);v.create("span","maplibregl-ctrl-icon",R).setAttribute("aria-hidden","true"),R.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),window.document.addEventListener(this._fullscreenchange,this._onFullscreenChange)}_updateTitle(){const R=this._getTitle();this._fullscreenButton.setAttribute("aria-label",R),this._fullscreenButton.title=R}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_handleFullscreenChange(){this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("maplibregl-ctrl-shrink"),this._fullscreenButton.classList.toggle("maplibregl-ctrl-fullscreen"),this._updateTitle(),this._fullscreen?(this.fire(new o.l("fullscreenstart")),this._prevCooperativeGesturesEnabled=this._map.cooperativeGestures.isEnabled(),this._map.cooperativeGestures.disable()):(this.fire(new o.l("fullscreenend")),this._prevCooperativeGesturesEnabled&&this._map.cooperativeGestures.enable())}_exitFullscreen(){window.document.exitFullscreen?window.document.exitFullscreen():window.document.mozCancelFullScreen?window.document.mozCancelFullScreen():window.document.msExitFullscreen?window.document.msExitFullscreen():window.document.webkitCancelFullScreen?window.document.webkitCancelFullScreen():this._togglePseudoFullScreen()}_requestFullscreen(){this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen?this._container.webkitRequestFullscreen():this._togglePseudoFullScreen()}_togglePseudoFullScreen(){this._container.classList.toggle("maplibregl-pseudo-fullscreen"),this._handleFullscreenChange(),this._map.resize()}},s.GeoJSONSource=pr,s.GeolocateControl=class extends o.E{constructor(R){super(),this._onSuccess=l=>{if(this._map){if(this._isOutOfMapMaxBounds(l))return this._setErrorState(),this.fire(new o.l("outofmaxbounds",l)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=l,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background");break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(l),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(l),this.options.showUserLocation&&this._dotElement.classList.remove("maplibregl-user-location-dot-stale"),this.fire(new o.l("geolocate",l)),this._finish()}},this._updateCamera=l=>{const m=new o.S(l.coords.longitude,l.coords.latitude),w=l.coords.accuracy,C=this._map.getBearing(),N=o.e({bearing:C},this.options.fitBoundsOptions),j=Mt.fromLngLat(m,w);this._map.fitBounds(j,N,{geolocateSource:!0})},this._updateMarker=l=>{if(l){const m=new o.S(l.coords.longitude,l.coords.latitude);this._accuracyCircleMarker.setLngLat(m).addTo(this._map),this._userLocationDotMarker.setLngLat(m).addTo(this._map),this._accuracy=l.coords.accuracy,this._updateCircleRadiusIfNeeded()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},this._onUpdate=()=>{this._updateCircleRadiusIfNeeded()},this._onError=l=>{if(this._map){if(l.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const m=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=m,this._geolocateButton.setAttribute("aria-label",m),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(l.code===3&&ts)return;this.options.trackUserLocation&&this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("maplibregl-user-location-dot-stale"),this.fire(new o.l("error",l)),this._finish()}},this._finish=()=>{this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},this._setupUI=()=>{this._map&&(this._container.addEventListener("contextmenu",(l=>l.preventDefault())),this._geolocateButton=v.create("button","maplibregl-ctrl-geolocate",this._container),v.create("span","maplibregl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",this._geolocateButton.disabled=!0)},this._finishSetupUI=l=>{if(this._map){if(l===!1){o.w("Geolocation support is not available so the GeolocateControl will be disabled.");const m=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=m,this._geolocateButton.setAttribute("aria-label",m)}else{const m=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.disabled=!1,this._geolocateButton.title=m,this._geolocateButton.setAttribute("aria-label",m)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=v.create("div","maplibregl-user-location-dot"),this._userLocationDotMarker=new es({element:this._dotElement}),this._circleElement=v.create("div","maplibregl-user-location-accuracy-circle"),this._accuracyCircleMarker=new es({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onUpdate),this._map.on("move",this._onUpdate),this._map.on("rotate",this._onUpdate),this._map.on("pitch",this._onUpdate)),this._geolocateButton.addEventListener("click",(()=>this.trigger())),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",(m=>{const w=m?.[0]instanceof ResizeObserverEntry;m.geolocateSource||this._watchState!=="ACTIVE_LOCK"||w||this._map.isZooming()||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this.fire(new o.l("trackuserlocationend")),this.fire(new o.l("userlocationlostfocus")))}))}},this.options=o.e({},Tl,R)}onAdd(R){return this._map=R,this._container=v.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),(function(){return o._(this,arguments,void 0,(function*(l=!1){if(Ni!==void 0&&!l)return Ni;if(window.navigator.permissions===void 0)return Ni=!!window.navigator.geolocation,Ni;try{Ni=(yield window.navigator.permissions.query({name:"geolocation"})).state!=="denied"}catch{Ni=!!window.navigator.geolocation}return Ni}))})().then((l=>this._finishSetupUI(l))),this._container}onRemove(){this._geolocationWatchID!==void 0&&(window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),v.remove(this._container),this._map.off("zoom",this._onUpdate),this._map.off("move",this._onUpdate),this._map.off("rotate",this._onUpdate),this._map.off("pitch",this._onUpdate),this._map=void 0,Ts=0,ts=!1}_isOutOfMapMaxBounds(R){const l=this._map.getMaxBounds(),m=R.coords;return l&&(m.longitude<l.getWest()||m.longitude>l.getEast()||m.latitude<l.getSouth()||m.latitude>l.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"ACTIVE_ERROR":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}}_updateCircleRadiusIfNeeded(){const R=this._userLocationDotMarker.getLngLat();if(!(this.options.showUserLocation&&this.options.showAccuracyCircle&&this._accuracy&&R))return;const l=this._map.project(R),m=this._map.unproject([l.x+100,l.y]),w=R.distanceTo(m)/100,C=2*this._accuracy/w;this._circleElement.style.width=`${C.toFixed(2)}px`,this._circleElement.style.height=`${C.toFixed(2)}px`}trigger(){if(!this._setup)return o.w("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new o.l("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":Ts--,ts=!1,this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this.fire(new o.l("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new o.l("trackuserlocationstart")),this.fire(new o.l("userlocationfocus"));break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"OFF":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let R;this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),Ts++,Ts>1?(R={maximumAge:6e5,timeout:0},ts=!0):(R=this.options.positionOptions,ts=!1),this._geolocationWatchID=window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,R)}}else window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_clearWatch(){window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},s.GlobeControl=class{constructor(){this._toggleProjection=()=>{var R;const l=(R=this._map.getProjection())===null||R===void 0?void 0:R.type;this._map.setProjection(l!=="mercator"&&l?{type:"mercator"}:{type:"globe"}),this._updateGlobeIcon()},this._updateGlobeIcon=()=>{var R;this._globeButton.classList.remove("maplibregl-ctrl-globe"),this._globeButton.classList.remove("maplibregl-ctrl-globe-enabled"),((R=this._map.getProjection())===null||R===void 0?void 0:R.type)==="globe"?(this._globeButton.classList.add("maplibregl-ctrl-globe-enabled"),this._globeButton.title=this._map._getUIString("GlobeControl.Disable")):(this._globeButton.classList.add("maplibregl-ctrl-globe"),this._globeButton.title=this._map._getUIString("GlobeControl.Enable"))}}onAdd(R){return this._map=R,this._container=v.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._globeButton=v.create("button","maplibregl-ctrl-globe",this._container),v.create("span","maplibregl-ctrl-icon",this._globeButton).setAttribute("aria-hidden","true"),this._globeButton.type="button",this._globeButton.addEventListener("click",this._toggleProjection),this._updateGlobeIcon(),this._map.on("styledata",this._updateGlobeIcon),this._container}onRemove(){v.remove(this._container),this._map.off("styledata",this._updateGlobeIcon),this._globeButton.removeEventListener("click",this._toggleProjection),this._map=void 0}},s.Hash=up,s.ImageSource=vt,s.KeyboardHandler=Or,s.LngLatBounds=Mt,s.LogoControl=Ss,s.Map=class extends ki{constructor(R){var l,m;o.cw.mark(o.cx.create);const w=Object.assign(Object.assign(Object.assign({},Oa),R),{canvasContextAttributes:Object.assign(Object.assign({},Oa.canvasContextAttributes),R.canvasContextAttributes)});if(w.minZoom!=null&&w.maxZoom!=null&&w.minZoom>w.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(w.minPitch!=null&&w.maxPitch!=null&&w.minPitch>w.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(w.minPitch!=null&&w.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(w.maxPitch!=null&&w.maxPitch>180)throw new Error("maxPitch must be less than or equal to 180");const C=new Wn,N=new gi;if(w.minZoom!==void 0&&C.setMinZoom(w.minZoom),w.maxZoom!==void 0&&C.setMaxZoom(w.maxZoom),w.minPitch!==void 0&&C.setMinPitch(w.minPitch),w.maxPitch!==void 0&&C.setMaxPitch(w.maxPitch),w.renderWorldCopies!==void 0&&C.setRenderWorldCopies(w.renderWorldCopies),super(C,N,{bearingSnap:w.bearingSnap}),this._idleTriggered=!1,this._crossFadingFactor=1,this._renderTaskQueue=new fo,this._controls=[],this._mapId=o.a7(),this._contextLost=Y=>{Y.preventDefault(),this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this.fire(new o.l("webglcontextlost",{originalEvent:Y}))},this._contextRestored=Y=>{this._setupPainter(),this.resize(),this._update(),this.fire(new o.l("webglcontextrestored",{originalEvent:Y}))},this._onMapScroll=Y=>{if(Y.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},this._onWindowOnline=()=>{this._update()},this._interactive=w.interactive,this._maxTileCacheSize=w.maxTileCacheSize,this._maxTileCacheZoomLevels=w.maxTileCacheZoomLevels,this._canvasContextAttributes=Object.assign({},w.canvasContextAttributes),this._trackResize=w.trackResize===!0,this._bearingSnap=w.bearingSnap,this._centerClampedToGround=w.centerClampedToGround,this._refreshExpiredTiles=w.refreshExpiredTiles===!0,this._fadeDuration=w.fadeDuration,this._crossSourceCollisions=w.crossSourceCollisions===!0,this._collectResourceTiming=w.collectResourceTiming===!0,this._locale=Object.assign(Object.assign({},ra),w.locale),this._clickTolerance=w.clickTolerance,this._overridePixelRatio=w.pixelRatio,this._maxCanvasSize=w.maxCanvasSize,this.transformCameraUpdate=w.transformCameraUpdate,this.cancelPendingTileRequestsWhileZooming=w.cancelPendingTileRequestsWhileZooming===!0,this._imageQueueHandle=M.addThrottleControl((()=>this.isMoving())),this._requestManager=new z(w.transformRequest),typeof w.container=="string"){if(this._container=document.getElementById(w.container),!this._container)throw new Error(`Container '${w.container}' not found.`)}else{if(!(w.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=w.container}if(w.maxBounds&&this.setMaxBounds(w.maxBounds),this._setupContainer(),this._setupPainter(),this.on("move",(()=>this._update(!1))),this.on("moveend",(()=>this._update(!1))),this.on("zoom",(()=>this._update(!0))),this.on("terrain",(()=>{this.painter.terrainFacilitator.dirty=!0,this._update(!0)})),this.once("idle",(()=>{this._idleTriggered=!0})),typeof window<"u"){addEventListener("online",this._onWindowOnline,!1);let Y=!1;const te=ws((ue=>{this._trackResize&&!this._removed&&(this.resize(ue),this.redraw())}),50);this._resizeObserver=new ResizeObserver((ue=>{Y?te(ue):Y=!0})),this._resizeObserver.observe(this._container)}this.handlers=new So(this,w),this._hash=w.hash&&new up(typeof w.hash=="string"&&w.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:w.center,elevation:w.elevation,zoom:w.zoom,bearing:w.bearing,pitch:w.pitch,roll:w.roll}),w.bounds&&(this.resize(),this.fitBounds(w.bounds,o.e({},w.fitBoundsOptions,{duration:0}))));const j=typeof w.style=="string"||((m=(l=w.style)===null||l===void 0?void 0:l.projection)===null||m===void 0?void 0:m.type)!=="globe";this.resize(null,j),this._localIdeographFontFamily=w.localIdeographFontFamily,this._validateStyle=w.validateStyle,w.style&&this.setStyle(w.style,{localIdeographFontFamily:w.localIdeographFontFamily}),w.attributionControl&&this.addControl(new za(typeof w.attributionControl=="boolean"?void 0:w.attributionControl)),w.maplibreLogo&&this.addControl(new Ss,w.logoPosition),this.on("style.load",(()=>{if(j||this._resizeTransform(),this.transform.unmodified){const Y=o.Q(this.style.stylesheet,["center","zoom","bearing","pitch","roll"]);this.jumpTo(Y)}})),this.on("data",(Y=>{this._update(Y.dataType==="style"),this.fire(new o.l(`${Y.dataType}data`,Y))})),this.on("dataloading",(Y=>{this.fire(new o.l(`${Y.dataType}dataloading`,Y))})),this.on("dataabort",(Y=>{this.fire(new o.l("sourcedataabort",Y))}))}_getMapId(){return this._mapId}setGlobalStateProperty(R,l){return this.style.setGlobalStateProperty(R,l),this._update(!0)}getGlobalState(){return this.style.getGlobalState()}addControl(R,l){if(l===void 0&&(l=R.getDefaultPosition?R.getDefaultPosition():"top-right"),!R||!R.onAdd)return this.fire(new o.k(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const m=R.onAdd(this);this._controls.push(R);const w=this._controlPositions[l];return l.indexOf("bottom")!==-1?w.insertBefore(m,w.firstChild):w.appendChild(m),this}removeControl(R){if(!R||!R.onRemove)return this.fire(new o.k(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const l=this._controls.indexOf(R);return l>-1&&this._controls.splice(l,1),R.onRemove(this),this}hasControl(R){return this._controls.indexOf(R)>-1}coveringTiles(R){return bt(this.transform,R)}calculateCameraOptionsFromTo(R,l,m,w){return w==null&&this.terrain&&(w=this.terrain.getElevationForLngLatZoom(m,this.transform.tileZoom)),super.calculateCameraOptionsFromTo(R,l,m,w)}resize(R,l=!0){const[m,w]=this._containerDimensions(),C=this._getClampedPixelRatio(m,w);if(this._resizeCanvas(m,w,C),this.painter.resize(m,w,C),this.painter.overLimit()){const j=this.painter.context.gl;this._maxCanvasSize=[j.drawingBufferWidth,j.drawingBufferHeight];const Y=this._getClampedPixelRatio(m,w);this._resizeCanvas(m,w,Y),this.painter.resize(m,w,Y)}this._resizeTransform(l);const N=!this._moving;return N&&(this.stop(),this.fire(new o.l("movestart",R)).fire(new o.l("move",R))),this.fire(new o.l("resize",R)),N&&this.fire(new o.l("moveend",R)),this}_resizeTransform(R=!0){var l;const[m,w]=this._containerDimensions();this.transform.resize(m,w,R),(l=this._requestedCameraState)===null||l===void 0||l.resize(m,w,R)}_getClampedPixelRatio(R,l){const{0:m,1:w}=this._maxCanvasSize,C=this.getPixelRatio(),N=R*C,j=l*C;return Math.min(N>m?m/N:1,j>w?w/j:1)*C}getPixelRatio(){var R;return(R=this._overridePixelRatio)!==null&&R!==void 0?R:devicePixelRatio}setPixelRatio(R){this._overridePixelRatio=R,this.resize()}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()}setMaxBounds(R){return this.transform.setMaxBounds(Mt.convert(R)),this._update()}setMinZoom(R){if((R=R??-2)>=-2&&R<=this.transform.maxZoom)return this.transform.setMinZoom(R),this._update(),this.getZoom()<R&&this.setZoom(R),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(R){if((R=R??22)>=this.transform.minZoom)return this.transform.setMaxZoom(R),this._update(),this.getZoom()>R&&this.setZoom(R),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(R){if((R=R??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(R>=0&&R<=this.transform.maxPitch)return this.transform.setMinPitch(R),this._update(),this.getPitch()<R&&this.setPitch(R),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(R){if((R=R??60)>180)throw new Error("maxPitch must be less than or equal to 180");if(R>=this.transform.minPitch)return this.transform.setMaxPitch(R),this._update(),this.getPitch()>R&&this.setPitch(R),this;throw new Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(R){return this.transform.setRenderWorldCopies(R),this._update()}project(R){return this.transform.locationToScreenPoint(o.S.convert(R),this.style&&this.terrain)}unproject(R){return this.transform.screenPointToLocation(o.P.convert(R),this.terrain)}isMoving(){var R;return this._moving||((R=this.handlers)===null||R===void 0?void 0:R.isMoving())}isZooming(){var R;return this._zooming||((R=this.handlers)===null||R===void 0?void 0:R.isZooming())}isRotating(){var R;return this._rotating||((R=this.handlers)===null||R===void 0?void 0:R.isRotating())}_createDelegatedListener(R,l,m){if(R==="mouseenter"||R==="mouseover"){let w=!1;return{layers:l,listener:m,delegates:{mousemove:N=>{const j=l.filter((te=>this.getLayer(te))),Y=j.length!==0?this.queryRenderedFeatures(N.point,{layers:j}):[];Y.length?w||(w=!0,m.call(this,new al(R,this,N.originalEvent,{features:Y}))):w=!1},mouseout:()=>{w=!1}}}}if(R==="mouseleave"||R==="mouseout"){let w=!1;return{layers:l,listener:m,delegates:{mousemove:j=>{const Y=l.filter((te=>this.getLayer(te)));(Y.length!==0?this.queryRenderedFeatures(j.point,{layers:Y}):[]).length?w=!0:w&&(w=!1,m.call(this,new al(R,this,j.originalEvent)))},mouseout:j=>{w&&(w=!1,m.call(this,new al(R,this,j.originalEvent)))}}}}{const w=C=>{const N=l.filter((Y=>this.getLayer(Y))),j=N.length!==0?this.queryRenderedFeatures(C.point,{layers:N}):[];j.length&&(C.features=j,m.call(this,C),delete C.features)};return{layers:l,listener:m,delegates:{[R]:w}}}}_saveDelegatedListener(R,l){this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[R]=this._delegatedListeners[R]||[],this._delegatedListeners[R].push(l)}_removeDelegatedListener(R,l,m){if(!this._delegatedListeners||!this._delegatedListeners[R])return;const w=this._delegatedListeners[R];for(let C=0;C<w.length;C++){const N=w[C];if(N.listener===m&&N.layers.length===l.length&&N.layers.every((j=>l.includes(j)))){for(const j in N.delegates)this.off(j,N.delegates[j]);return void w.splice(C,1)}}}on(R,l,m){if(m===void 0)return super.on(R,l);const w=typeof l=="string"?[l]:l,C=this._createDelegatedListener(R,w,m);this._saveDelegatedListener(R,C);for(const N in C.delegates)this.on(N,C.delegates[N]);return{unsubscribe:()=>{this._removeDelegatedListener(R,w,m)}}}once(R,l,m){if(m===void 0)return super.once(R,l);const w=typeof l=="string"?[l]:l,C=this._createDelegatedListener(R,w,m);for(const N in C.delegates){const j=C.delegates[N];C.delegates[N]=(...Y)=>{this._removeDelegatedListener(R,w,m),j(...Y)}}this._saveDelegatedListener(R,C);for(const N in C.delegates)this.once(N,C.delegates[N]);return this}off(R,l,m){return m===void 0?super.off(R,l):(this._removeDelegatedListener(R,typeof l=="string"?[l]:l,m),this)}queryRenderedFeatures(R,l){if(!this.style)return[];let m;const w=R instanceof o.P||Array.isArray(R),C=w?R:[[0,0],[this.transform.width,this.transform.height]];if(l=l||(w?{}:R)||{},C instanceof o.P||typeof C[0]=="number")m=[o.P.convert(C)];else{const N=o.P.convert(C[0]),j=o.P.convert(C[1]);m=[N,new o.P(j.x,N.y),j,new o.P(N.x,j.y),N]}return this.style.queryRenderedFeatures(m,l,this.transform)}querySourceFeatures(R,l){return this.style.querySourceFeatures(R,l)}setStyle(R,l){return(l=o.e({},{localIdeographFontFamily:this._localIdeographFontFamily,validate:this._validateStyle},l)).diff!==!1&&l.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&R?(this._diffStyle(R,l),this):(this._localIdeographFontFamily=l.localIdeographFontFamily,this._updateStyle(R,l))}setTransformRequest(R){return this._requestManager.setTransformRequest(R),this}_getUIString(R){const l=this._locale[R];if(l==null)throw new Error(`Missing UI string '${R}'`);return l}_updateStyle(R,l){var m,w;if(l.transformStyle&&this.style&&!this.style._loaded)return void this.style.once("style.load",(()=>this._updateStyle(R,l)));const C=this.style&&l.transformStyle?this.style.serialize():void 0;return this.style&&(this.style.setEventedParent(null),this.style._remove(!R)),R?(this.style=new bs(this,l||{}),this.style.setEventedParent(this,{style:this.style}),typeof R=="string"?this.style.loadURL(R,l,C):this.style.loadJSON(R,l,C),this):((w=(m=this.style)===null||m===void 0?void 0:m.projection)===null||w===void 0||w.destroy(),delete this.style,this)}_lazyInitEmptyStyle(){this.style||(this.style=new bs(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(R,l){if(typeof R=="string"){const m=this._requestManager.transformRequest(R,"Style");o.j(m,new AbortController).then((w=>{this._updateDiff(w.data,l)})).catch((w=>{w&&this.fire(new o.k(w))}))}else typeof R=="object"&&this._updateDiff(R,l)}_updateDiff(R,l){try{this.style.setState(R,l)&&this._update(!0)}catch(m){o.w(`Unable to perform style diff: ${m.message||m.error||m}.  Rebuilding the style from scratch.`),this._updateStyle(R,l)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():o.w("There is no style added to the map.")}addSource(R,l){return this._lazyInitEmptyStyle(),this.style.addSource(R,l),this._update(!0)}isSourceLoaded(R){const l=this.style&&this.style.sourceCaches[R];if(l!==void 0)return l.loaded();this.fire(new o.k(new Error(`There is no source with ID '${R}'`)))}setTerrain(R){if(this.style._checkLoaded(),this._terrainDataCallback&&this.style.off("data",this._terrainDataCallback),R){const l=this.style.sourceCaches[R.source];if(!l)throw new Error(`cannot load terrain, because there exists no source with ID: ${R.source}`);this.terrain===null&&l.reload();for(const m in this.style._layers){const w=this.style._layers[m];w.type==="hillshade"&&w.source===R.source&&o.w("You are using the same source for a hillshade layer and for 3D terrain. Please consider using two separate sources to improve rendering quality."),w.type==="color-relief"&&w.source===R.source&&o.w("You are using the same source for a color-relief layer and for 3D terrain. Please consider using two separate sources to improve rendering quality.")}this.terrain=new On(this.painter,l,R),this.painter.renderToTexture=new la(this.painter,this.terrain),this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this._terrainDataCallback=m=>{var w;m.dataType==="style"?this.terrain.sourceCache.freeRtt():m.dataType==="source"&&m.tile&&(m.sourceId!==R.source||this._elevationFreeze||(this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this._centerClampedToGround&&this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))),((w=m.source)===null||w===void 0?void 0:w.type)==="image"?this.terrain.sourceCache.freeRtt():this.terrain.sourceCache.freeRtt(m.tile.tileID))},this.style.on("data",this._terrainDataCallback)}else this.terrain&&this.terrain.sourceCache.destruct(),this.terrain=null,this.painter.renderToTexture&&this.painter.renderToTexture.destruct(),this.painter.renderToTexture=null,this.transform.setMinElevationForCurrentTile(0),this._centerClampedToGround&&this.transform.setElevation(0);return this.fire(new o.l("terrain",{terrain:R})),this}getTerrain(){var R,l;return(l=(R=this.terrain)===null||R===void 0?void 0:R.options)!==null&&l!==void 0?l:null}areTilesLoaded(){const R=this.style&&this.style.sourceCaches;for(const l in R){const m=R[l]._tiles;for(const w in m){const C=m[w];if(C.state!=="loaded"&&C.state!=="errored")return!1}}return!0}removeSource(R){return this.style.removeSource(R),this._update(!0)}getSource(R){return this.style.getSource(R)}setSourceTileLodParams(R,l,m){if(m){const w=this.getSource(m);if(!w)throw new Error(`There is no source with ID "${m}", cannot set LOD parameters`);w.calculateTileZoom=Jt(Math.max(1,R),Math.max(1,l))}else for(const w in this.style.sourceCaches)this.style.sourceCaches[w].getSource().calculateTileZoom=Jt(Math.max(1,R),Math.max(1,l));return this._update(!0),this}refreshTiles(R,l){const m=this.style.sourceCaches[R];if(!m)throw new Error(`There is no source cache with ID "${R}", cannot refresh tile`);l===void 0?m.reload(!0):m.refreshTiles(l.map((w=>new o.a4(w.z,w.x,w.y))))}addImage(R,l,m={}){const{pixelRatio:w=1,sdf:C=!1,stretchX:N,stretchY:j,content:Y,textFitWidth:te,textFitHeight:ue}=m;if(this._lazyInitEmptyStyle(),!(l instanceof HTMLImageElement||o.b(l))){if(l.width===void 0||l.height===void 0)return this.fire(new o.k(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));{const{width:ge,height:Ce,data:Se}=l,Fe=l;return this.style.addImage(R,{data:new o.R({width:ge,height:Ce},new Uint8Array(Se)),pixelRatio:w,stretchX:N,stretchY:j,content:Y,textFitWidth:te,textFitHeight:ue,sdf:C,version:0,userImage:Fe}),Fe.onAdd&&Fe.onAdd(this,R),this}}{const{width:ge,height:Ce,data:Se}=b.getImageData(l);this.style.addImage(R,{data:new o.R({width:ge,height:Ce},Se),pixelRatio:w,stretchX:N,stretchY:j,content:Y,textFitWidth:te,textFitHeight:ue,sdf:C,version:0})}}updateImage(R,l){const m=this.style.getImage(R);if(!m)return this.fire(new o.k(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const w=l instanceof HTMLImageElement||o.b(l)?b.getImageData(l):l,{width:C,height:N,data:j}=w;if(C===void 0||N===void 0)return this.fire(new o.k(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(C!==m.data.width||N!==m.data.height)return this.fire(new o.k(new Error("The width and height of the updated image must be that same as the previous version of the image")));const Y=!(l instanceof HTMLImageElement||o.b(l));return m.data.replace(j,Y),this.style.updateImage(R,m),this}getImage(R){return this.style.getImage(R)}hasImage(R){return R?!!this.style.getImage(R):(this.fire(new o.k(new Error("Missing required image id"))),!1)}removeImage(R){this.style.removeImage(R)}loadImage(R){return M.getImage(this._requestManager.transformRequest(R,"Image"),new AbortController)}listImages(){return this.style.listImages()}addLayer(R,l){return this._lazyInitEmptyStyle(),this.style.addLayer(R,l),this._update(!0)}moveLayer(R,l){return this.style.moveLayer(R,l),this._update(!0)}removeLayer(R){return this.style.removeLayer(R),this._update(!0)}getLayer(R){return this.style.getLayer(R)}getLayersOrder(){return this.style.getLayersOrder()}setLayerZoomRange(R,l,m){return this.style.setLayerZoomRange(R,l,m),this._update(!0)}setFilter(R,l,m={}){return this.style.setFilter(R,l,m),this._update(!0)}getFilter(R){return this.style.getFilter(R)}setPaintProperty(R,l,m,w={}){return this.style.setPaintProperty(R,l,m,w),this._update(!0)}getPaintProperty(R,l){return this.style.getPaintProperty(R,l)}setLayoutProperty(R,l,m,w={}){return this.style.setLayoutProperty(R,l,m,w),this._update(!0)}getLayoutProperty(R,l){return this.style.getLayoutProperty(R,l)}setGlyphs(R,l={}){return this._lazyInitEmptyStyle(),this.style.setGlyphs(R,l),this._update(!0)}getGlyphs(){return this.style.getGlyphsUrl()}addSprite(R,l,m={}){return this._lazyInitEmptyStyle(),this.style.addSprite(R,l,m,(w=>{w||this._update(!0)})),this}removeSprite(R){return this._lazyInitEmptyStyle(),this.style.removeSprite(R),this._update(!0)}getSprite(){return this.style.getSprite()}setSprite(R,l={}){return this._lazyInitEmptyStyle(),this.style.setSprite(R,l,(m=>{m||this._update(!0)})),this}setLight(R,l={}){return this._lazyInitEmptyStyle(),this.style.setLight(R,l),this._update(!0)}getLight(){return this.style.getLight()}setSky(R,l={}){return this._lazyInitEmptyStyle(),this.style.setSky(R,l),this._update(!0)}getSky(){return this.style.getSky()}setFeatureState(R,l){return this.style.setFeatureState(R,l),this._update()}removeFeatureState(R,l){return this.style.removeFeatureState(R,l),this._update()}getFeatureState(R){return this.style.getFeatureState(R)}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}_containerDimensions(){let R=0,l=0;return this._container&&(R=this._container.clientWidth||400,l=this._container.clientHeight||300),[R,l]}_setupContainer(){const R=this._container;R.classList.add("maplibregl-map");const l=this._canvasContainer=v.create("div","maplibregl-canvas-container",R);this._interactive&&l.classList.add("maplibregl-interactive"),this._canvas=v.create("canvas","maplibregl-canvas",l),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex",this._interactive?"0":"-1"),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region");const m=this._containerDimensions(),w=this._getClampedPixelRatio(m[0],m[1]);this._resizeCanvas(m[0],m[1],w);const C=this._controlContainer=v.create("div","maplibregl-control-container",R),N=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach((j=>{N[j]=v.create("div",`maplibregl-ctrl-${j} `,C)})),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(R,l,m){this._canvas.width=Math.floor(m*R),this._canvas.height=Math.floor(m*l),this._canvas.style.width=`${R}px`,this._canvas.style.height=`${l}px`}_setupPainter(){const R=Object.assign(Object.assign({},this._canvasContextAttributes),{alpha:!0,depth:!0,stencil:!0,premultipliedAlpha:!0});let l=null;this._canvas.addEventListener("webglcontextcreationerror",(w=>{l={requestedAttributes:R},w&&(l.statusMessage=w.statusMessage,l.type=w.type)}),{once:!0});let m=null;if(m=this._canvasContextAttributes.contextType?this._canvas.getContext(this._canvasContextAttributes.contextType,R):this._canvas.getContext("webgl2",R)||this._canvas.getContext("webgl",R),!m){const w="Failed to initialize WebGL";throw l?(l.message=w,new Error(JSON.stringify(l))):new Error(w)}this.painter=new Lc(m,this.transform),S.testSupport(m)}migrateProjection(R,l){super.migrateProjection(R,l),this.painter.transform=R,this.fire(new o.l("projectiontransition",{newProjection:this.style.projection.name}))}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(R){return this.style&&this.style._loaded?(this._styleDirty=this._styleDirty||R,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(R){return this._update(),this._renderTaskQueue.add(R)}_cancelRenderFrame(R){this._renderTaskQueue.remove(R)}_render(R){var l,m,w,C,N;const j=this._idleTriggered?this._fadeDuration:0,Y=((l=this.style.projection)===null||l===void 0?void 0:l.transitionState)>0;if(this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(R),this._removed)return;let te=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;const Ce=this.transform.zoom,Se=b.now();this.style.zoomHistory.update(Ce,Se);const Fe=new o.F(Ce,{now:Se,fadeDuration:j,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition(),globalState:this.style.getGlobalState()}),Ge=Fe.crossFadingFactor();Ge===1&&Ge===this._crossFadingFactor||(te=!0,this._crossFadingFactor=Ge),this.style.update(Fe)}const ue=((m=this.style.projection)===null||m===void 0?void 0:m.transitionState)>0!==Y;(w=this.style.projection)===null||w===void 0||w.setErrorQueryLatitudeDegrees(this.transform.center.lat),this.transform.setTransitionState((C=this.style.projection)===null||C===void 0?void 0:C.transitionState,(N=this.style.projection)===null||N===void 0?void 0:N.latitudeErrorCorrectionRadians),this.style&&(this._sourcesDirty||ue)&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this.terrain?(this.terrain.sourceCache.update(this.transform,this.terrain),this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),!this._elevationFreeze&&this._centerClampedToGround&&this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))):(this.transform.setMinElevationForCurrentTile(0),this._centerClampedToGround&&this.transform.setElevation(0)),this._placementDirty=this.style&&this.style._updatePlacement(this.transform,this.showCollisionBoxes,j,this._crossSourceCollisions,ue),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:j,showPadding:this.showPadding}),this.fire(new o.l("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,o.cw.mark(o.cx.load),this.fire(new o.l("load"))),this.style&&(this.style.hasTransitions()||te)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles();const ge=this._sourcesDirty||this._styleDirty||this._placementDirty;return ge||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new o.l("idle")),!this._loaded||this._fullyLoaded||ge||(this._fullyLoaded=!0,o.cw.mark(o.cx.fullLoad)),this}redraw(){return this.style&&(this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._render(0)),this}remove(){var R;this._hash&&this._hash.remove();for(const m of this._controls)m.onRemove(this);this._controls=[],this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),typeof window<"u"&&removeEventListener("online",this._onWindowOnline,!1),M.removeThrottleControl(this._imageQueueHandle),(R=this._resizeObserver)===null||R===void 0||R.disconnect();const l=this.painter.context.gl.getExtension("WEBGL_lose_context");l?.loseContext&&l.loseContext(),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),v.remove(this._canvasContainer),v.remove(this._controlContainer),this._container.removeEventListener("scroll",this._onMapScroll,!1),this._container.classList.remove("maplibregl-map"),o.cw.clearMetrics(),this._removed=!0,this.fire(new o.l("remove"))}triggerRepaint(){this.style&&!this._frameRequest&&(this._frameRequest=new AbortController,b.frame(this._frameRequest,(R=>{o.cw.frame(R),this._frameRequest=null;try{this._render(R)}catch(l){if(!o.cy(l)&&!(function(m){return m.message===zo})(l))throw l}}),(()=>{})))}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(R){this._showTileBoundaries!==R&&(this._showTileBoundaries=R,this._update())}get showPadding(){return!!this._showPadding}set showPadding(R){this._showPadding!==R&&(this._showPadding=R,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(R){this._showCollisionBoxes!==R&&(this._showCollisionBoxes=R,R?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(R){this._showOverdrawInspector!==R&&(this._showOverdrawInspector=R,this._update())}get repaint(){return!!this._repaint}set repaint(R){this._repaint!==R&&(this._repaint=R,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(R){this._vertices=R,this._update()}get version(){return _a}getCameraTargetElevation(){return this.transform.elevation}getProjection(){return this.style.getProjection()}setProjection(R){return this._lazyInitEmptyStyle(),this.style.setProjection(R),this._update(!0)}},s.MapMouseEvent=al,s.MapTouchEvent=Sf,s.MapWheelEvent=hp,s.Marker=es,s.NavigationControl=class{constructor(R){this._updateZoomButtons=()=>{const l=this._map.getZoom(),m=l===this._map.getMaxZoom(),w=l===this._map.getMinZoom();this._zoomInButton.disabled=m,this._zoomOutButton.disabled=w,this._zoomInButton.setAttribute("aria-disabled",m.toString()),this._zoomOutButton.setAttribute("aria-disabled",w.toString())},this._rotateCompassArrow=()=>{this._compassIcon.style.transform=this.options.visualizePitch&&this.options.visualizeRoll?`scale(${1/Math.pow(Math.cos(this._map.transform.pitchInRadians),.5)}) rotateZ(${-this._map.transform.roll}deg) rotateX(${this._map.transform.pitch}deg) rotateZ(${-this._map.transform.bearing}deg)`:this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(this._map.transform.pitchInRadians),.5)}) rotateX(${this._map.transform.pitch}deg) rotateZ(${-this._map.transform.bearing}deg)`:this.options.visualizeRoll?`rotate(${-this._map.transform.bearing-this._map.transform.roll}deg)`:`rotate(${-this._map.transform.bearing}deg)`},this._setButtonTitle=(l,m)=>{const w=this._map._getUIString(`NavigationControl.${m}`);l.title=w,l.setAttribute("aria-label",w)},this.options=o.e({},Zu,R),this._container=v.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._container.addEventListener("contextmenu",(l=>l.preventDefault())),this.options.showZoom&&(this._zoomInButton=this._createButton("maplibregl-ctrl-zoom-in",(l=>this._map.zoomIn({},{originalEvent:l}))),v.create("span","maplibregl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("maplibregl-ctrl-zoom-out",(l=>this._map.zoomOut({},{originalEvent:l}))),v.create("span","maplibregl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(this._compass=this._createButton("maplibregl-ctrl-compass",(l=>{this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:l}):this._map.resetNorth({},{originalEvent:l})})),this._compassIcon=v.create("span","maplibregl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}onAdd(R){return this._map=R,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this.options.visualizeRoll&&this._map.on("roll",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new ro(this._map,this._compass,this.options.visualizePitch)),this._container}onRemove(){v.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this.options.visualizeRoll&&this._map.off("roll",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map}_createButton(R,l){const m=v.create("button",R,this._container);return m.type="button",m.addEventListener("click",l),m}},s.Popup=class extends o.E{constructor(R){super(),this._updateOpacity=()=>{this.options.locationOccludedOpacity!==void 0&&(this._container.style.opacity=this._map.transform.isLocationOccluded(this.getLngLat())?`${this.options.locationOccludedOpacity}`:"")},this.remove=()=>(this._content&&v.remove(this._content),this._container&&(v.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),this._map._canvasContainer.classList.remove("maplibregl-track-pointer"),delete this._map,this.fire(new o.l("close"))),this),this._onMouseUp=l=>{this._update(l.point)},this._onMouseMove=l=>{this._update(l.point)},this._onDrag=l=>{this._update(l.point)},this._update=l=>{if(!this._map||!this._lngLat&&!this._trackPointer||!this._content)return;if(!this._container){if(this._container=v.create("div","maplibregl-popup",this._map.getContainer()),this._tip=v.create("div","maplibregl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className)for(const j of this.options.className.split(" "))this._container.classList.add(j);this._closeButton&&this._closeButton.setAttribute("aria-label",this._map._getUIString("Popup.Close")),this._trackPointer&&this._container.classList.add("maplibregl-popup-track-pointer")}if(this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._lngLat=wi(this._lngLat,this._flatPos,this._map.transform,this._trackPointer),this._trackPointer&&!l)return;const m=this._flatPos=this._pos=this._trackPointer&&l?l:this._map.project(this._lngLat);this._map.terrain&&(this._flatPos=this._trackPointer&&l?l:this._map.transform.locationToScreenPoint(this._lngLat));let w=this.options.anchor;const C=Au(this.options.offset);if(!w){const j=this._container.offsetWidth,Y=this._container.offsetHeight;let te;te=m.y+C.bottom.y<Y?["top"]:m.y>this._map.transform.height-Y?["bottom"]:[],m.x<j/2?te.push("left"):m.x>this._map.transform.width-j/2&&te.push("right"),w=te.length===0?"bottom":te.join("-")}let N=m.add(C[w]);this.options.subpixelPositioning||(N=N.round()),v.setTransform(this._container,`${Po[w]} translate(${N.x}px,${N.y}px)`),Es(this._container,w,"popup"),this._updateOpacity()},this._onClose=()=>{this.remove()},this.options=o.e(Object.create(su),R)}addTo(R){return this._map&&this.remove(),this._map=R,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")):this._map.on("move",this._update),this.fire(new o.l("open")),this}isOpen(){return!!this._map}getLngLat(){return this._lngLat}setLngLat(R){return this._lngLat=o.S.convert(R),this._pos=null,this._flatPos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.remove("maplibregl-track-pointer")),this}trackPointer(){return this._trackPointer=!0,this._pos=null,this._flatPos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")),this}getElement(){return this._container}setText(R){return this.setDOMContent(document.createTextNode(R))}setHTML(R){const l=document.createDocumentFragment(),m=document.createElement("body");let w;for(m.innerHTML=R;w=m.firstChild,w;)l.appendChild(w);return this.setDOMContent(l)}getMaxWidth(){var R;return(R=this._container)===null||R===void 0?void 0:R.style.maxWidth}setMaxWidth(R){return this.options.maxWidth=R,this._update(),this}setDOMContent(R){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=v.create("div","maplibregl-popup-content",this._container);return this._content.appendChild(R),this._createCloseButton(),this._update(),this._focusFirstElement(),this}addClassName(R){return this._container&&this._container.classList.add(R),this}removeClassName(R){return this._container&&this._container.classList.remove(R),this}setOffset(R){return this.options.offset=R,this._update(),this}toggleClassName(R){if(this._container)return this._container.classList.toggle(R)}setSubpixelPositioning(R){this.options.subpixelPositioning=R}_createCloseButton(){this.options.closeButton&&(this._closeButton=v.create("button","maplibregl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const R=this._container.querySelector(Dc);R&&R.focus()}},s.RasterDEMTileSource=Yt,s.RasterTileSource=Xt,s.ScaleControl=class{constructor(R){this._onMove=()=>{Ca(this._map,this._container,this.options)},this.setUnit=l=>{this.options.unit=l,Ca(this._map,this._container,this.options)},this.options=Object.assign(Object.assign({},Vs),R)}getDefaultPosition(){return"bottom-left"}onAdd(R){return this._map=R,this._container=v.create("div","maplibregl-ctrl maplibregl-ctrl-scale",R.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){v.remove(this._container),this._map.off("move",this._onMove),this._map=void 0}},s.ScrollZoomHandler=rn,s.Style=bs,s.TerrainControl=class{constructor(R){this._toggleTerrain=()=>{this._map.getTerrain()?this._map.setTerrain(null):this._map.setTerrain(this.options),this._updateTerrainIcon()},this._updateTerrainIcon=()=>{this._terrainButton.classList.remove("maplibregl-ctrl-terrain"),this._terrainButton.classList.remove("maplibregl-ctrl-terrain-enabled"),this._map.terrain?(this._terrainButton.classList.add("maplibregl-ctrl-terrain-enabled"),this._terrainButton.title=this._map._getUIString("TerrainControl.Disable")):(this._terrainButton.classList.add("maplibregl-ctrl-terrain"),this._terrainButton.title=this._map._getUIString("TerrainControl.Enable"))},this.options=R}onAdd(R){return this._map=R,this._container=v.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._terrainButton=v.create("button","maplibregl-ctrl-terrain",this._container),v.create("span","maplibregl-ctrl-icon",this._terrainButton).setAttribute("aria-hidden","true"),this._terrainButton.type="button",this._terrainButton.addEventListener("click",this._toggleTerrain),this._updateTerrainIcon(),this._map.on("terrain",this._updateTerrainIcon),this._container}onRemove(){v.remove(this._container),this._map.off("terrain",this._updateTerrainIcon),this._map=void 0}},s.TwoFingersTouchPitchHandler=Qt,s.TwoFingersTouchRotateHandler=vr,s.TwoFingersTouchZoomHandler=Et,s.TwoFingersTouchZoomRotateHandler=ea,s.VectorTileSource=je,s.VideoSource=yr,s.addSourceType=(R,l)=>o._(void 0,void 0,void 0,(function*(){if(Er(R))throw new Error(`A source type called "${R}" already exists.`);((m,w)=>{cr[m]=w})(R,l)})),s.clearPrewarmedResources=function(){const R=Ee;R&&(R.isPreloaded()&&R.numActive()===1?(R.release(Te),Ee=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},s.createTileMesh=nu,s.getMaxParallelImageRequests=function(){return o.a.MAX_PARALLEL_IMAGE_REQUESTS},s.getRTLTextPluginStatus=function(){return Ar().getRTLTextPluginStatus()},s.getVersion=function(){return ds},s.getWorkerCount=function(){return ke.workerCount},s.getWorkerUrl=function(){return o.a.WORKER_URL},s.importScriptInWorkers=function(R){return $e().broadcast("IS",R)},s.prewarm=function(){Ne().acquire(Te)},s.setMaxParallelImageRequests=function(R){o.a.MAX_PARALLEL_IMAGE_REQUESTS=R},s.setRTLTextPlugin=function(R,l){return Ar().setRTLTextPlugin(R,l)},s.setWorkerCount=function(R){ke.workerCount=R},s.setWorkerUrl=function(R){o.a.WORKER_URL=R}}));var a=r;return a}))})(aw)),aw.exports}var kE=_ie();const lP=od(kE);class bie{registeredElements;baseLayers;firstSymbolLayer;eventHandlers;wrapper;initRegisteredElements;addNativeMaplibreFunctionsAndProps;map;style;styleJson;addSource;addControl;on;cleanup;constructor(e){const r=this;this.registeredElements={},this.baseLayers=[],this.firstSymbolLayer=void 0,this.eventHandlers={layerchange:[],viewportchange:[],addsource:[],addlayer:[]},this.wrapper={on:(o,u,h,f)=>{if(!r.eventHandlers[o])return;typeof h=="string"&&(f=h,h={}),r.eventHandlers[o].push({handler:u,options:h});const g=[o,u];f&&typeof f=="string"&&(r.initRegisteredElements(f),r.registeredElements[f].wrapperEvents.push(g))},off:(o,u)=>{r.eventHandlers[o]&&(r.eventHandlers[o]=r.eventHandlers[o].filter(h=>Object.is(h.handler,u)?!1:h))},fire:(o,u)=>{if(!r.eventHandlers[o])return;const h=u||window,f=new Event(o);r.eventHandlers[o].forEach(function(g){g.handler.call(h,f,r,u)})},layerState:[],layerStateString:"",oldLayerStateStrings:{},buildLayerObject:o=>{if(o)return{id:o.id,type:o.type,visible:o.visibility!=="none",baseLayer:r.baseLayers.indexOf(o.id)!==-1}},buildLayerObjects:()=>r.map.style._order.map(o=>r.wrapper.buildLayerObject(r.map.style._layers[o])).filter(o=>typeof o<"u"),refreshLayerState:()=>{r.wrapper.layerState=r.wrapper.buildLayerObjects(),JSON.stringify(r.wrapper.layerState)!==r.wrapper.layerStateString&&(r.wrapper.fire("layerchange"),r.wrapper.layerStateString=JSON.stringify(r.wrapper.layerState))},viewportState:{center:{lng:0,lat:0},zoom:0,bearing:0,pitch:0},viewportStateString:"{}",oldViewportStateString:"{}",getViewport:()=>typeof r.map.getCenter=="function"?{center:(({lng:o,lat:u})=>({lng:o,lat:u}))(r.map.getCenter()),zoom:r.map.getZoom(),bearing:r.map.getBearing(),pitch:r.map.getPitch()}:{center:{lng:0,lat:0},zoom:0,bearing:0,pitch:0},refreshViewport:()=>{r.wrapper.viewportState=r.wrapper.getViewport()}},this.cancelled=!1,this.initRegisteredElements=(o,u)=>{(typeof r.registeredElements[o]>"u"||typeof u<"u"&&u)&&(r.registeredElements[o]={layers:[],sources:[],images:[],events:[],controls:[],wrapperEvents:[]})},this.addLayer=(o,u,h)=>r.map.style?(h&&typeof h=="string"&&typeof o.id<"u"&&(r.initRegisteredElements(h),r.registeredElements[h].layers.push(o.id),o?.source&&typeof o?.source!="string"&&r.registeredElements[h].sources.push(o.id)),r.map.addLayer(o,u),r.wrapper.fire("addlayer",{layer_id:o.id}),this):this,this.addSource=(o,u,h)=>r.map.style?(h&&typeof h=="string"&&typeof o<"u"&&(r.initRegisteredElements(h),r.registeredElements[h].sources.push(o)),r.map.addSource(o,u),r.wrapper.fire("addsource",{source_id:o}),this):this,this.addImage=(o,u,h,f)=>r.map.style?typeof h=="string"&&typeof f>"u"?r.addImage(o,u,void 0,h):(f&&typeof f=="string"&&typeof o<"u"&&(r.initRegisteredElements(f),r.registeredElements[f].images.push(o)),r.map.addImage(o,u,h),this):this,this.on=(o,u,h,f)=>{if(typeof h=="string"&&typeof u=="function")return r.on.call(r,o,void 0,u,h);let g=[o,u,h];return u||(g=[o,h]),f&&typeof f=="string"&&(r.initRegisteredElements(f),r.registeredElements[f].events.push(g)),r.map.on(...g),this},this.addControl=(o,u,h)=>(h&&typeof h=="string"&&(r.initRegisteredElements(h),r.registeredElements[h].controls.push(o)),r.map.addControl(o,u),this),this.cleanup=o=>{r.map.style&&typeof r.registeredElements[o]<"u"&&(r.registeredElements[o].layers.forEach(u=>{r.map.style.getLayer(u)&&r.map.style.removeLayer(u)}),r.registeredElements[o].sources.forEach(u=>{r.map.style.getSource(u)&&r.map.style.removeSource(u)}),r.registeredElements[o].images.forEach(u=>{r.map.hasImage(u)&&r.map.style.removeImage(u)}),r.registeredElements[o].events.forEach(u=>{r.map.off(...u)}),r.registeredElements[o].controls.forEach(u=>{r.map.removeControl(u)}),r.registeredElements[o].wrapperEvents.forEach(u=>{r.wrapper.off(...u)}),r.initRegisteredElements(o,!0))},["moveLayer","removeLayer","removeSource","setPaintProperty","setLayoutProperty"].forEach(o=>{this[o]=(...u)=>(r.map&&r.map.style&&typeof r.map.style[o]=="function"&&r.map.style[o](...u),r.map._update?r.map._update(!0):void 0)}),["getLayer","getSource","listImages","getPaintProperty","getLayoutProperty","removeImage"].forEach(o=>{this[o]=(...u)=>r.map&&r.map.style?r.map.style[o](...u):!1}),this.addNativeMaplibreFunctionsAndProps=()=>{Object.getOwnPropertyNames(Object.getPrototypeOf(this.map)).forEach(o=>{typeof this[o]>"u"&&(this[o]=(...u)=>r.map[o](...u))}),Object.keys(this.map).forEach(o=>{typeof this[o]>"u"&&(this[o]=r.map[o])})},["getZoom","setZoom","getCenter","setCenter","getBearing","setBearing","getPitch","setPitch","jumpTo","flyTo","panTo","panBy","panBy","zoomTo","zoomIn","zoomOut","getPadding","setPadding","rotateTo","resetNorth","resetNorthPitch","snapToNorth","cameraForBounds","fitBounds","fitScreenCoordinates","getFreeCameraOptions","setFreeCameraOptions","easeTo","stop"].forEach(o=>{this[o]=(...u)=>{if(typeof r.map[o]=="function")return r.map[o].call(r.map,...u)}}),(async()=>{typeof e.mapOptions.style=="string"&&e.mapOptions.style.indexOf("mapbox://")===-1&&await fetch(e.mapOptions.style).then(o=>{if(o.ok)return o.json();throw new Error("error loading map style.json")}).then(o=>{o.layers.forEach(u=>{r.baseLayers.push(u.id),!r.firstSymbolLayer&&u.type==="symbol"&&(r.firstSymbolLayer=u.id)}),r.styleJson=o,e.mapOptions.style=o}).catch(o=>{console.log(o)}),r.map=new kE.Map(e.mapOptions),r.addNativeMaplibreFunctionsAndProps(),r.wrapper.refreshViewport(),r.wrapper.fire("viewportchange"),r.map.on("load",()=>{r.addNativeMaplibreFunctionsAndProps()}),r.map.on("move",()=>{r.wrapper.viewportState=r.wrapper.getViewport(),r.wrapper.fire("viewportchange")}),r.map.on("idle",()=>{r.wrapper.refreshLayerState()}),r.map.on("data",()=>{r.wrapper.refreshLayerState()}),typeof e.onReady=="function"&&e.onReady(r.map,r)})()}}function $d(t,...e){const r=new URL(`https://mui.com/production-error/?code=${t}`);return e.forEach(n=>r.searchParams.append("args[]",n)),`Minified MUI error #${t}; visit ${r} for the full message.`}const nf="$$material";function Uw(){return Uw=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Uw.apply(null,arguments)}function xie(t){if(t.sheet)return t.sheet;for(var e=0;e<document.styleSheets.length;e++)if(document.styleSheets[e].ownerNode===t)return document.styleSheets[e]}function wie(t){var e=document.createElement("style");return e.setAttribute("data-emotion",t.key),t.nonce!==void 0&&e.setAttribute("nonce",t.nonce),e.appendChild(document.createTextNode("")),e.setAttribute("data-s",""),e}var Sie=(function(){function t(r){var n=this;this._insertTag=function(i){var a;n.tags.length===0?n.insertionPoint?a=n.insertionPoint.nextSibling:n.prepend?a=n.container.firstChild:a=n.before:a=n.tags[n.tags.length-1].nextSibling,n.container.insertBefore(i,a),n.tags.push(i)},this.isSpeedy=r.speedy===void 0?!0:r.speedy,this.tags=[],this.ctr=0,this.nonce=r.nonce,this.key=r.key,this.container=r.container,this.prepend=r.prepend,this.insertionPoint=r.insertionPoint,this.before=null}var e=t.prototype;return e.hydrate=function(n){n.forEach(this._insertTag)},e.insert=function(n){this.ctr%(this.isSpeedy?65e3:1)===0&&this._insertTag(wie(this));var i=this.tags[this.tags.length-1];if(this.isSpeedy){var a=xie(i);try{a.insertRule(n,a.cssRules.length)}catch{}}else i.appendChild(document.createTextNode(n));this.ctr++},e.flush=function(){this.tags.forEach(function(n){var i;return(i=n.parentNode)==null?void 0:i.removeChild(n)}),this.tags=[],this.ctr=0},t})(),Bu="-ms-",Vw="-moz-",Ua="-webkit-",rW="comm",yR="rule",vR="decl",Eie="@import",nW="@keyframes",Tie="@layer",Cie=Math.abs,ME=String.fromCharCode,Aie=Object.assign;function Iie(t,e){return pu(t,0)^45?(((e<<2^pu(t,0))<<2^pu(t,1))<<2^pu(t,2))<<2^pu(t,3):0}function iW(t){return t.trim()}function Pie(t,e){return(t=e.exec(t))?t[0]:t}function Va(t,e,r){return t.replace(e,r)}function uP(t,e){return t.indexOf(e)}function pu(t,e){return t.charCodeAt(e)|0}function q1(t,e,r){return t.slice(e,r)}function Uf(t){return t.length}function _R(t){return t.length}function Bx(t,e){return e.push(t),t}function kie(t,e){return t.map(e).join("")}var RE=1,Kv=1,aW=0,Sc=0,pl=0,I0="";function OE(t,e,r,n,i,a,s){return{value:t,root:e,parent:r,type:n,props:i,children:a,line:RE,column:Kv,length:s,return:""}}function d_(t,e){return Aie(OE("",null,null,"",null,null,0),t,{length:-t.length},e)}function Mie(){return pl}function Rie(){return pl=Sc>0?pu(I0,--Sc):0,Kv--,pl===10&&(Kv=1,RE--),pl}function Qc(){return pl=Sc<aW?pu(I0,Sc++):0,Kv++,pl===10&&(Kv=1,RE++),pl}function Yf(){return pu(I0,Sc)}function ow(){return Sc}function Nb(t,e){return q1(I0,t,e)}function H1(t){switch(t){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function oW(t){return RE=Kv=1,aW=Uf(I0=t),Sc=0,[]}function sW(t){return I0="",t}function sw(t){return iW(Nb(Sc-1,cP(t===91?t+2:t===40?t+1:t)))}function Oie(t){for(;(pl=Yf())&&pl<33;)Qc();return H1(t)>2||H1(pl)>3?"":" "}function Lie(t,e){for(;--e&&Qc()&&!(pl<48||pl>102||pl>57&&pl<65||pl>70&&pl<97););return Nb(t,ow()+(e<6&&Yf()==32&&Qc()==32))}function cP(t){for(;Qc();)switch(pl){case t:return Sc;case 34:case 39:t!==34&&t!==39&&cP(pl);break;case 40:t===41&&cP(t);break;case 92:Qc();break}return Sc}function Nie(t,e){for(;Qc()&&t+pl!==57;)if(t+pl===84&&Yf()===47)break;return"/*"+Nb(e,Sc-1)+"*"+ME(t===47?t:Qc())}function Die(t){for(;!H1(Yf());)Qc();return Nb(t,Sc)}function Fie(t){return sW(lw("",null,null,null,[""],t=oW(t),0,[0],t))}function lw(t,e,r,n,i,a,s,o,u){for(var h=0,f=0,g=s,b=0,v=0,S=0,E=1,P=1,k=1,L=0,O="",M=i,z=a,B=n,q=O;P;)switch(S=L,L=Qc()){case 40:if(S!=108&&pu(q,g-1)==58){uP(q+=Va(sw(L),"&","&\f"),"&\f")!=-1&&(k=-1);break}case 34:case 39:case 91:q+=sw(L);break;case 9:case 10:case 13:case 32:q+=Oie(S);break;case 92:q+=Lie(ow()-1,7);continue;case 47:switch(Yf()){case 42:case 47:Bx(Bie(Nie(Qc(),ow()),e,r),u);break;default:q+="/"}break;case 123*E:o[h++]=Uf(q)*k;case 125*E:case 59:case 0:switch(L){case 0:case 125:P=0;case 59+f:k==-1&&(q=Va(q,/\f/g,"")),v>0&&Uf(q)-g&&Bx(v>32?W6(q+";",n,r,g-1):W6(Va(q," ","")+";",n,r,g-2),u);break;case 59:q+=";";default:if(Bx(B=H6(q,e,r,h,f,i,o,O,M=[],z=[],g),a),L===123)if(f===0)lw(q,e,B,B,M,a,g,o,z);else switch(b===99&&pu(q,3)===110?100:b){case 100:case 108:case 109:case 115:lw(t,B,B,n&&Bx(H6(t,B,B,0,0,i,o,O,i,M=[],g),z),i,z,g,o,n?M:z);break;default:lw(q,B,B,B,[""],z,0,o,z)}}h=f=v=0,E=k=1,O=q="",g=s;break;case 58:g=1+Uf(q),v=S;default:if(E<1){if(L==123)--E;else if(L==125&&E++==0&&Rie()==125)continue}switch(q+=ME(L),L*E){case 38:k=f>0?1:(q+="\f",-1);break;case 44:o[h++]=(Uf(q)-1)*k,k=1;break;case 64:Yf()===45&&(q+=sw(Qc())),b=Yf(),f=g=Uf(O=q+=Die(ow())),L++;break;case 45:S===45&&Uf(q)==2&&(E=0)}}return a}function H6(t,e,r,n,i,a,s,o,u,h,f){for(var g=i-1,b=i===0?a:[""],v=_R(b),S=0,E=0,P=0;S<n;++S)for(var k=0,L=q1(t,g+1,g=Cie(E=s[S])),O=t;k<v;++k)(O=iW(E>0?b[k]+" "+L:Va(L,/&\f/g,b[k])))&&(u[P++]=O);return OE(t,e,r,i===0?yR:o,u,h,f)}function Bie(t,e,r){return OE(t,e,r,rW,ME(Mie()),q1(t,2,-2),0)}function W6(t,e,r,n){return OE(t,e,r,vR,q1(t,0,n),q1(t,n+1,-1),n)}function Bv(t,e){for(var r="",n=_R(t),i=0;i<n;i++)r+=e(t[i],i,t,e)||"";return r}function zie(t,e,r,n){switch(t.type){case Tie:if(t.children.length)break;case Eie:case vR:return t.return=t.return||t.value;case rW:return"";case nW:return t.return=t.value+"{"+Bv(t.children,n)+"}";case yR:t.value=t.props.join(",")}return Uf(r=Bv(t.children,n))?t.return=t.value+"{"+r+"}":""}function jie(t){var e=_R(t);return function(r,n,i,a){for(var s="",o=0;o<e;o++)s+=t[o](r,n,i,a)||"";return s}}function Uie(t){return function(e){e.root||(e=e.return)&&t(e)}}function lW(t){var e=Object.create(null);return function(r){return e[r]===void 0&&(e[r]=t(r)),e[r]}}var Vie=function(e,r,n){for(var i=0,a=0;i=a,a=Yf(),i===38&&a===12&&(r[n]=1),!H1(a);)Qc();return Nb(e,Sc)},$ie=function(e,r){var n=-1,i=44;do switch(H1(i)){case 0:i===38&&Yf()===12&&(r[n]=1),e[n]+=Vie(Sc-1,r,n);break;case 2:e[n]+=sw(i);break;case 4:if(i===44){e[++n]=Yf()===58?"&\f":"",r[n]=e[n].length;break}default:e[n]+=ME(i)}while(i=Qc());return e},qie=function(e,r){return sW($ie(oW(e),r))},G6=new WeakMap,Hie=function(e){if(!(e.type!=="rule"||!e.parent||e.length<1)){for(var r=e.value,n=e.parent,i=e.column===n.column&&e.line===n.line;n.type!=="rule";)if(n=n.parent,!n)return;if(!(e.props.length===1&&r.charCodeAt(0)!==58&&!G6.get(n))&&!i){G6.set(e,!0);for(var a=[],s=qie(r,a),o=n.props,u=0,h=0;u<s.length;u++)for(var f=0;f<o.length;f++,h++)e.props[h]=a[u]?s[u].replace(/&\f/g,o[f]):o[f]+" "+s[u]}}},Wie=function(e){if(e.type==="decl"){var r=e.value;r.charCodeAt(0)===108&&r.charCodeAt(2)===98&&(e.return="",e.value="")}};function uW(t,e){switch(Iie(t,e)){case 5103:return Ua+"print-"+t+t;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return Ua+t+t;case 5349:case 4246:case 4810:case 6968:case 2756:return Ua+t+Vw+t+Bu+t+t;case 6828:case 4268:return Ua+t+Bu+t+t;case 6165:return Ua+t+Bu+"flex-"+t+t;case 5187:return Ua+t+Va(t,/(\w+).+(:[^]+)/,Ua+"box-$1$2"+Bu+"flex-$1$2")+t;case 5443:return Ua+t+Bu+"flex-item-"+Va(t,/flex-|-self/,"")+t;case 4675:return Ua+t+Bu+"flex-line-pack"+Va(t,/align-content|flex-|-self/,"")+t;case 5548:return Ua+t+Bu+Va(t,"shrink","negative")+t;case 5292:return Ua+t+Bu+Va(t,"basis","preferred-size")+t;case 6060:return Ua+"box-"+Va(t,"-grow","")+Ua+t+Bu+Va(t,"grow","positive")+t;case 4554:return Ua+Va(t,/([^-])(transform)/g,"$1"+Ua+"$2")+t;case 6187:return Va(Va(Va(t,/(zoom-|grab)/,Ua+"$1"),/(image-set)/,Ua+"$1"),t,"")+t;case 5495:case 3959:return Va(t,/(image-set\([^]*)/,Ua+"$1$`$1");case 4968:return Va(Va(t,/(.+:)(flex-)?(.*)/,Ua+"box-pack:$3"+Bu+"flex-pack:$3"),/s.+-b[^;]+/,"justify")+Ua+t+t;case 4095:case 3583:case 4068:case 2532:return Va(t,/(.+)-inline(.+)/,Ua+"$1$2")+t;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(Uf(t)-1-e>6)switch(pu(t,e+1)){case 109:if(pu(t,e+4)!==45)break;case 102:return Va(t,/(.+:)(.+)-([^]+)/,"$1"+Ua+"$2-$3$1"+Vw+(pu(t,e+3)==108?"$3":"$2-$3"))+t;case 115:return~uP(t,"stretch")?uW(Va(t,"stretch","fill-available"),e)+t:t}break;case 4949:if(pu(t,e+1)!==115)break;case 6444:switch(pu(t,Uf(t)-3-(~uP(t,"!important")&&10))){case 107:return Va(t,":",":"+Ua)+t;case 101:return Va(t,/(.+:)([^;!]+)(;|!.+)?/,"$1"+Ua+(pu(t,14)===45?"inline-":"")+"box$3$1"+Ua+"$2$3$1"+Bu+"$2box$3")+t}break;case 5936:switch(pu(t,e+11)){case 114:return Ua+t+Bu+Va(t,/[svh]\w+-[tblr]{2}/,"tb")+t;case 108:return Ua+t+Bu+Va(t,/[svh]\w+-[tblr]{2}/,"tb-rl")+t;case 45:return Ua+t+Bu+Va(t,/[svh]\w+-[tblr]{2}/,"lr")+t}return Ua+t+Bu+t+t}return t}var Gie=function(e,r,n,i){if(e.length>-1&&!e.return)switch(e.type){case vR:e.return=uW(e.value,e.length);break;case nW:return Bv([d_(e,{value:Va(e.value,"@","@"+Ua)})],i);case yR:if(e.length)return kie(e.props,function(a){switch(Pie(a,/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":return Bv([d_(e,{props:[Va(a,/:(read-\w+)/,":"+Vw+"$1")]})],i);case"::placeholder":return Bv([d_(e,{props:[Va(a,/:(plac\w+)/,":"+Ua+"input-$1")]}),d_(e,{props:[Va(a,/:(plac\w+)/,":"+Vw+"$1")]}),d_(e,{props:[Va(a,/:(plac\w+)/,Bu+"input-$1")]})],i)}return""})}},Xie=[Gie],Yie=function(e){var r=e.key;if(r==="css"){var n=document.querySelectorAll("style[data-emotion]:not([data-s])");Array.prototype.forEach.call(n,function(E){var P=E.getAttribute("data-emotion");P.indexOf(" ")!==-1&&(document.head.appendChild(E),E.setAttribute("data-s",""))})}var i=e.stylisPlugins||Xie,a={},s,o=[];s=e.container||document.head,Array.prototype.forEach.call(document.querySelectorAll('style[data-emotion^="'+r+' "]'),function(E){for(var P=E.getAttribute("data-emotion").split(" "),k=1;k<P.length;k++)a[P[k]]=!0;o.push(E)});var u,h=[Hie,Wie];{var f,g=[zie,Uie(function(E){f.insert(E)})],b=jie(h.concat(i,g)),v=function(P){return Bv(Fie(P),b)};u=function(P,k,L,O){f=L,v(P?P+"{"+k.styles+"}":k.styles),O&&(S.inserted[k.name]=!0)}}var S={key:r,sheet:new Sie({key:r,container:s,nonce:e.nonce,speedy:e.speedy,prepend:e.prepend,insertionPoint:e.insertionPoint}),nonce:e.nonce,inserted:a,registered:{},insert:u};return S.sheet.hydrate(o),S},YC={exports:{}},Xa={};/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var X6;function Zie(){if(X6)return Xa;X6=1;var t=typeof Symbol=="function"&&Symbol.for,e=t?Symbol.for("react.element"):60103,r=t?Symbol.for("react.portal"):60106,n=t?Symbol.for("react.fragment"):60107,i=t?Symbol.for("react.strict_mode"):60108,a=t?Symbol.for("react.profiler"):60114,s=t?Symbol.for("react.provider"):60109,o=t?Symbol.for("react.context"):60110,u=t?Symbol.for("react.async_mode"):60111,h=t?Symbol.for("react.concurrent_mode"):60111,f=t?Symbol.for("react.forward_ref"):60112,g=t?Symbol.for("react.suspense"):60113,b=t?Symbol.for("react.suspense_list"):60120,v=t?Symbol.for("react.memo"):60115,S=t?Symbol.for("react.lazy"):60116,E=t?Symbol.for("react.block"):60121,P=t?Symbol.for("react.fundamental"):60117,k=t?Symbol.for("react.responder"):60118,L=t?Symbol.for("react.scope"):60119;function O(z){if(typeof z=="object"&&z!==null){var B=z.$$typeof;switch(B){case e:switch(z=z.type,z){case u:case h:case n:case a:case i:case g:return z;default:switch(z=z&&z.$$typeof,z){case o:case f:case S:case v:case s:return z;default:return B}}case r:return B}}}function M(z){return O(z)===h}return Xa.AsyncMode=u,Xa.ConcurrentMode=h,Xa.ContextConsumer=o,Xa.ContextProvider=s,Xa.Element=e,Xa.ForwardRef=f,Xa.Fragment=n,Xa.Lazy=S,Xa.Memo=v,Xa.Portal=r,Xa.Profiler=a,Xa.StrictMode=i,Xa.Suspense=g,Xa.isAsyncMode=function(z){return M(z)||O(z)===u},Xa.isConcurrentMode=M,Xa.isContextConsumer=function(z){return O(z)===o},Xa.isContextProvider=function(z){return O(z)===s},Xa.isElement=function(z){return typeof z=="object"&&z!==null&&z.$$typeof===e},Xa.isForwardRef=function(z){return O(z)===f},Xa.isFragment=function(z){return O(z)===n},Xa.isLazy=function(z){return O(z)===S},Xa.isMemo=function(z){return O(z)===v},Xa.isPortal=function(z){return O(z)===r},Xa.isProfiler=function(z){return O(z)===a},Xa.isStrictMode=function(z){return O(z)===i},Xa.isSuspense=function(z){return O(z)===g},Xa.isValidElementType=function(z){return typeof z=="string"||typeof z=="function"||z===n||z===h||z===a||z===i||z===g||z===b||typeof z=="object"&&z!==null&&(z.$$typeof===S||z.$$typeof===v||z.$$typeof===s||z.$$typeof===o||z.$$typeof===f||z.$$typeof===P||z.$$typeof===k||z.$$typeof===L||z.$$typeof===E)},Xa.typeOf=O,Xa}var Y6;function Kie(){return Y6||(Y6=1,YC.exports=Zie()),YC.exports}var ZC,Z6;function Jie(){if(Z6)return ZC;Z6=1;var t=Kie(),e={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},r={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},n={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},i={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},a={};a[t.ForwardRef]=n,a[t.Memo]=i;function s(S){return t.isMemo(S)?i:a[S.$$typeof]||e}var o=Object.defineProperty,u=Object.getOwnPropertyNames,h=Object.getOwnPropertySymbols,f=Object.getOwnPropertyDescriptor,g=Object.getPrototypeOf,b=Object.prototype;function v(S,E,P){if(typeof E!="string"){if(b){var k=g(E);k&&k!==b&&v(S,k,P)}var L=u(E);h&&(L=L.concat(h(E)));for(var O=s(S),M=s(E),z=0;z<L.length;++z){var B=L[z];if(!r[B]&&!(P&&P[B])&&!(M&&M[B])&&!(O&&O[B])){var q=f(E,B);try{o(S,B,q)}catch{}}}}return S}return ZC=v,ZC}Jie();var Qie=!0;function cW(t,e,r){var n="";return r.split(" ").forEach(function(i){t[i]!==void 0?e.push(t[i]+";"):i&&(n+=i+" ")}),n}var bR=function(e,r,n){var i=e.key+"-"+r.name;(n===!1||Qie===!1)&&e.registered[i]===void 0&&(e.registered[i]=r.styles)},xR=function(e,r,n){bR(e,r,n);var i=e.key+"-"+r.name;if(e.inserted[r.name]===void 0){var a=r;do e.insert(r===a?"."+i:"",a,e.sheet,!0),a=a.next;while(a!==void 0)}};function eae(t){for(var e=0,r,n=0,i=t.length;i>=4;++n,i-=4)r=t.charCodeAt(n)&255|(t.charCodeAt(++n)&255)<<8|(t.charCodeAt(++n)&255)<<16|(t.charCodeAt(++n)&255)<<24,r=(r&65535)*1540483477+((r>>>16)*59797<<16),r^=r>>>24,e=(r&65535)*1540483477+((r>>>16)*59797<<16)^(e&65535)*1540483477+((e>>>16)*59797<<16);switch(i){case 3:e^=(t.charCodeAt(n+2)&255)<<16;case 2:e^=(t.charCodeAt(n+1)&255)<<8;case 1:e^=t.charCodeAt(n)&255,e=(e&65535)*1540483477+((e>>>16)*59797<<16)}return e^=e>>>13,e=(e&65535)*1540483477+((e>>>16)*59797<<16),((e^e>>>15)>>>0).toString(36)}var tae={animationIterationCount:1,aspectRatio:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,scale:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},rae=/[A-Z]|^ms/g,nae=/_EMO_([^_]+?)_([^]*?)_EMO_/g,hW=function(e){return e.charCodeAt(1)===45},K6=function(e){return e!=null&&typeof e!="boolean"},KC=lW(function(t){return hW(t)?t:t.replace(rae,"-$&").toLowerCase()}),J6=function(e,r){switch(e){case"animation":case"animationName":if(typeof r=="string")return r.replace(nae,function(n,i,a){return Vf={name:i,styles:a,next:Vf},i})}return tae[e]!==1&&!hW(e)&&typeof r=="number"&&r!==0?r+"px":r};function W1(t,e,r){if(r==null)return"";var n=r;if(n.__emotion_styles!==void 0)return n;switch(typeof r){case"boolean":return"";case"object":{var i=r;if(i.anim===1)return Vf={name:i.name,styles:i.styles,next:Vf},i.name;var a=r;if(a.styles!==void 0){var s=a.next;if(s!==void 0)for(;s!==void 0;)Vf={name:s.name,styles:s.styles,next:Vf},s=s.next;var o=a.styles+";";return o}return iae(t,e,r)}case"function":{if(t!==void 0){var u=Vf,h=r(t);return Vf=u,W1(t,e,h)}break}}var f=r;if(e==null)return f;var g=e[f];return g!==void 0?g:f}function iae(t,e,r){var n="";if(Array.isArray(r))for(var i=0;i<r.length;i++)n+=W1(t,e,r[i])+";";else for(var a in r){var s=r[a];if(typeof s!="object"){var o=s;e!=null&&e[o]!==void 0?n+=a+"{"+e[o]+"}":K6(o)&&(n+=KC(a)+":"+J6(a,o)+";")}else if(Array.isArray(s)&&typeof s[0]=="string"&&(e==null||e[s[0]]===void 0))for(var u=0;u<s.length;u++)K6(s[u])&&(n+=KC(a)+":"+J6(a,s[u])+";");else{var h=W1(t,e,s);switch(a){case"animation":case"animationName":{n+=KC(a)+":"+h+";";break}default:n+=a+"{"+h+"}"}}}return n}var Q6=/label:\s*([^\s;{]+)\s*(;|$)/g,Vf;function Db(t,e,r){if(t.length===1&&typeof t[0]=="object"&&t[0]!==null&&t[0].styles!==void 0)return t[0];var n=!0,i="";Vf=void 0;var a=t[0];if(a==null||a.raw===void 0)n=!1,i+=W1(r,e,a);else{var s=a;i+=s[0]}for(var o=1;o<t.length;o++)if(i+=W1(r,e,t[o]),n){var u=a;i+=u[o]}Q6.lastIndex=0;for(var h="",f;(f=Q6.exec(i))!==null;)h+="-"+f[1];var g=eae(i)+h;return{name:g,styles:i,next:Vf}}var aae=function(e){return e()},fW=jw.useInsertionEffect?jw.useInsertionEffect:!1,dW=fW||aae,eF=fW||ee.useLayoutEffect,pW=ee.createContext(typeof HTMLElement<"u"?Yie({key:"css"}):null);pW.Provider;var wR=function(e){return ee.forwardRef(function(r,n){var i=ee.useContext(pW);return e(r,i,n)})},Fb=ee.createContext({}),SR={}.hasOwnProperty,hP="__EMOTION_TYPE_PLEASE_DO_NOT_USE__",oae=function(e,r){var n={};for(var i in r)SR.call(r,i)&&(n[i]=r[i]);return n[hP]=e,n},sae=function(e){var r=e.cache,n=e.serialized,i=e.isStringTag;return bR(r,n,i),dW(function(){return xR(r,n,i)}),null},lae=wR(function(t,e,r){var n=t.css;typeof n=="string"&&e.registered[n]!==void 0&&(n=e.registered[n]);var i=t[hP],a=[n],s="";typeof t.className=="string"?s=cW(e.registered,a,t.className):t.className!=null&&(s=t.className+" ");var o=Db(a,void 0,ee.useContext(Fb));s+=e.key+"-"+o.name;var u={};for(var h in t)SR.call(t,h)&&h!=="css"&&h!==hP&&(u[h]=t[h]);return u.className=s,r&&(u.ref=r),ee.createElement(ee.Fragment,null,ee.createElement(sae,{cache:e,serialized:o,isStringTag:typeof i=="string"}),ee.createElement(i,u))}),uae=lae,tF=function(e,r){var n=arguments;if(r==null||!SR.call(r,"css"))return ee.createElement.apply(void 0,n);var i=n.length,a=new Array(i);a[0]=uae,a[1]=oae(e,r);for(var s=2;s<i;s++)a[s]=n[s];return ee.createElement.apply(null,a)};(function(t){var e;e||(e=t.JSX||(t.JSX={}))})(tF||(tF={}));var gW=wR(function(t,e){var r=t.styles,n=Db([r],void 0,ee.useContext(Fb)),i=ee.useRef();return eF(function(){var a=e.key+"-global",s=new e.sheet.constructor({key:a,nonce:e.sheet.nonce,container:e.sheet.container,speedy:e.sheet.isSpeedy}),o=!1,u=document.querySelector('style[data-emotion="'+a+" "+n.name+'"]');return e.sheet.tags.length&&(s.before=e.sheet.tags[0]),u!==null&&(o=!0,u.setAttribute("data-emotion",a),s.hydrate([u])),i.current=[s,o],function(){s.flush()}},[e]),eF(function(){var a=i.current,s=a[0],o=a[1];if(o){a[1]=!1;return}if(n.next!==void 0&&xR(e,n.next,!0),s.tags.length){var u=s.tags[s.tags.length-1].nextElementSibling;s.before=u,s.flush()}e.insert("",n,s,!1)},[e,n.name]),null});function ER(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];return Db(e)}function Bb(){var t=ER.apply(void 0,arguments),e="animation-"+t.name;return{name:e,styles:"@keyframes "+e+"{"+t.styles+"}",anim:1,toString:function(){return"_EMO_"+this.name+"_"+this.styles+"_EMO_"}}}var cae=/^((children|dangerouslySetInnerHTML|key|ref|autoFocus|defaultValue|defaultChecked|innerHTML|suppressContentEditableWarning|suppressHydrationWarning|valueLink|abbr|accept|acceptCharset|accessKey|action|allow|allowUserMedia|allowPaymentRequest|allowFullScreen|allowTransparency|alt|async|autoComplete|autoPlay|capture|cellPadding|cellSpacing|challenge|charSet|checked|cite|classID|className|cols|colSpan|content|contentEditable|contextMenu|controls|controlsList|coords|crossOrigin|data|dateTime|decoding|default|defer|dir|disabled|disablePictureInPicture|disableRemotePlayback|download|draggable|encType|enterKeyHint|fetchpriority|fetchPriority|form|formAction|formEncType|formMethod|formNoValidate|formTarget|frameBorder|headers|height|hidden|high|href|hrefLang|htmlFor|httpEquiv|id|inputMode|integrity|is|keyParams|keyType|kind|label|lang|list|loading|loop|low|marginHeight|marginWidth|max|maxLength|media|mediaGroup|method|min|minLength|multiple|muted|name|nonce|noValidate|open|optimum|pattern|placeholder|playsInline|popover|popoverTarget|popoverTargetAction|poster|preload|profile|radioGroup|readOnly|referrerPolicy|rel|required|reversed|role|rows|rowSpan|sandbox|scope|scoped|scrolling|seamless|selected|shape|size|sizes|slot|span|spellCheck|src|srcDoc|srcLang|srcSet|start|step|style|summary|tabIndex|target|title|translate|type|useMap|value|width|wmode|wrap|about|datatype|inlist|prefix|property|resource|typeof|vocab|autoCapitalize|autoCorrect|autoSave|color|incremental|fallback|inert|itemProp|itemScope|itemType|itemID|itemRef|on|option|results|security|unselectable|accentHeight|accumulate|additive|alignmentBaseline|allowReorder|alphabetic|amplitude|arabicForm|ascent|attributeName|attributeType|autoReverse|azimuth|baseFrequency|baselineShift|baseProfile|bbox|begin|bias|by|calcMode|capHeight|clip|clipPathUnits|clipPath|clipRule|colorInterpolation|colorInterpolationFilters|colorProfile|colorRendering|contentScriptType|contentStyleType|cursor|cx|cy|d|decelerate|descent|diffuseConstant|direction|display|divisor|dominantBaseline|dur|dx|dy|edgeMode|elevation|enableBackground|end|exponent|externalResourcesRequired|fill|fillOpacity|fillRule|filter|filterRes|filterUnits|floodColor|floodOpacity|focusable|fontFamily|fontSize|fontSizeAdjust|fontStretch|fontStyle|fontVariant|fontWeight|format|from|fr|fx|fy|g1|g2|glyphName|glyphOrientationHorizontal|glyphOrientationVertical|glyphRef|gradientTransform|gradientUnits|hanging|horizAdvX|horizOriginX|ideographic|imageRendering|in|in2|intercept|k|k1|k2|k3|k4|kernelMatrix|kernelUnitLength|kerning|keyPoints|keySplines|keyTimes|lengthAdjust|letterSpacing|lightingColor|limitingConeAngle|local|markerEnd|markerMid|markerStart|markerHeight|markerUnits|markerWidth|mask|maskContentUnits|maskUnits|mathematical|mode|numOctaves|offset|opacity|operator|order|orient|orientation|origin|overflow|overlinePosition|overlineThickness|panose1|paintOrder|pathLength|patternContentUnits|patternTransform|patternUnits|pointerEvents|points|pointsAtX|pointsAtY|pointsAtZ|preserveAlpha|preserveAspectRatio|primitiveUnits|r|radius|refX|refY|renderingIntent|repeatCount|repeatDur|requiredExtensions|requiredFeatures|restart|result|rotate|rx|ry|scale|seed|shapeRendering|slope|spacing|specularConstant|specularExponent|speed|spreadMethod|startOffset|stdDeviation|stemh|stemv|stitchTiles|stopColor|stopOpacity|strikethroughPosition|strikethroughThickness|string|stroke|strokeDasharray|strokeDashoffset|strokeLinecap|strokeLinejoin|strokeMiterlimit|strokeOpacity|strokeWidth|surfaceScale|systemLanguage|tableValues|targetX|targetY|textAnchor|textDecoration|textRendering|textLength|to|transform|u1|u2|underlinePosition|underlineThickness|unicode|unicodeBidi|unicodeRange|unitsPerEm|vAlphabetic|vHanging|vIdeographic|vMathematical|values|vectorEffect|version|vertAdvY|vertOriginX|vertOriginY|viewBox|viewTarget|visibility|widths|wordSpacing|writingMode|x|xHeight|x1|x2|xChannelSelector|xlinkActuate|xlinkArcrole|xlinkHref|xlinkRole|xlinkShow|xlinkTitle|xlinkType|xmlBase|xmlns|xmlnsXlink|xmlLang|xmlSpace|y|y1|y2|yChannelSelector|z|zoomAndPan|for|class|autofocus)|(([Dd][Aa][Tt][Aa]|[Aa][Rr][Ii][Aa]|x)-.*))$/,hae=lW(function(t){return cae.test(t)||t.charCodeAt(0)===111&&t.charCodeAt(1)===110&&t.charCodeAt(2)<91}),fae=hae,dae=function(e){return e!=="theme"},rF=function(e){return typeof e=="string"&&e.charCodeAt(0)>96?fae:dae},nF=function(e,r,n){var i;if(r){var a=r.shouldForwardProp;i=e.__emotion_forwardProp&&a?function(s){return e.__emotion_forwardProp(s)&&a(s)}:a}return typeof i!="function"&&n&&(i=e.__emotion_forwardProp),i},pae=function(e){var r=e.cache,n=e.serialized,i=e.isStringTag;return bR(r,n,i),dW(function(){return xR(r,n,i)}),null},gae=function t(e,r){var n=e.__emotion_real===e,i=n&&e.__emotion_base||e,a,s;r!==void 0&&(a=r.label,s=r.target);var o=nF(e,r,n),u=o||rF(i),h=!u("as");return function(){var f=arguments,g=n&&e.__emotion_styles!==void 0?e.__emotion_styles.slice(0):[];if(a!==void 0&&g.push("label:"+a+";"),f[0]==null||f[0].raw===void 0)g.push.apply(g,f);else{var b=f[0];g.push(b[0]);for(var v=f.length,S=1;S<v;S++)g.push(f[S],b[S])}var E=wR(function(P,k,L){var O=h&&P.as||i,M="",z=[],B=P;if(P.theme==null){B={};for(var q in P)B[q]=P[q];B.theme=ee.useContext(Fb)}typeof P.className=="string"?M=cW(k.registered,z,P.className):P.className!=null&&(M=P.className+" ");var W=Db(g.concat(z),k.registered,B);M+=k.key+"-"+W.name,s!==void 0&&(M+=" "+s);var G=h&&o===void 0?rF(O):u,ie={};for(var Q in P)h&&Q==="as"||G(Q)&&(ie[Q]=P[Q]);return ie.className=M,L&&(ie.ref=L),ee.createElement(ee.Fragment,null,ee.createElement(pae,{cache:k,serialized:W,isStringTag:typeof O=="string"}),ee.createElement(O,ie))});return E.displayName=a!==void 0?a:"Styled("+(typeof i=="string"?i:i.displayName||i.name||"Component")+")",E.defaultProps=e.defaultProps,E.__emotion_real=E,E.__emotion_base=i,E.__emotion_styles=g,E.__emotion_forwardProp=o,Object.defineProperty(E,"toString",{value:function(){return"."+s}}),E.withComponent=function(P,k){var L=t(P,Uw({},r,k,{shouldForwardProp:nF(E,k,!0)}));return L.apply(void 0,g)},E}},mae=["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","marquee","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","title","tr","track","u","ul","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","tspan"],fP=gae.bind(null);mae.forEach(function(t){fP[t]=fP(t)});var JC={exports:{}},QC,iF;function yae(){if(iF)return QC;iF=1;var t="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";return QC=t,QC}var e3,aF;function vae(){if(aF)return e3;aF=1;var t=yae();function e(){}function r(){}return r.resetWarningCache=e,e3=function(){function n(s,o,u,h,f,g){if(g!==t){var b=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw b.name="Invariant Violation",b}}n.isRequired=n;function i(){return n}var a={array:n,bigint:n,bool:n,func:n,number:n,object:n,string:n,symbol:n,any:n,arrayOf:i,element:n,elementType:n,instanceOf:i,node:n,objectOf:i,oneOf:i,oneOfType:i,shape:i,exact:i,checkPropTypes:r,resetWarningCache:e};return a.PropTypes=a,a},e3}var oF;function _ae(){return oF||(oF=1,JC.exports=vae()()),JC.exports}var bae=_ae();const Pn=od(bae);function xae(t){return t==null||Object.keys(t).length===0}function mW(t){const{styles:e,defaultTheme:r={}}=t,n=typeof e=="function"?i=>e(xae(i)?r:i):e;return K.jsx(gW,{styles:n})}function yW(t,e){return fP(t,e)}function wae(t,e){Array.isArray(t.__emotion_styles)&&(t.__emotion_styles=e(t.__emotion_styles))}const sF=[];function Vp(t){return sF[0]=t,Db(sF)}var t3={exports:{}},go={};/**
 * @license React
 * react-is.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var lF;function Sae(){if(lF)return go;lF=1;var t=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),a=Symbol.for("react.consumer"),s=Symbol.for("react.context"),o=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),h=Symbol.for("react.suspense_list"),f=Symbol.for("react.memo"),g=Symbol.for("react.lazy"),b=Symbol.for("react.view_transition"),v=Symbol.for("react.client.reference");function S(E){if(typeof E=="object"&&E!==null){var P=E.$$typeof;switch(P){case t:switch(E=E.type,E){case r:case i:case n:case u:case h:case b:return E;default:switch(E=E&&E.$$typeof,E){case s:case o:case g:case f:return E;case a:return E;default:return P}}case e:return P}}}return go.ContextConsumer=a,go.ContextProvider=s,go.Element=t,go.ForwardRef=o,go.Fragment=r,go.Lazy=g,go.Memo=f,go.Portal=e,go.Profiler=i,go.StrictMode=n,go.Suspense=u,go.SuspenseList=h,go.isContextConsumer=function(E){return S(E)===a},go.isContextProvider=function(E){return S(E)===s},go.isElement=function(E){return typeof E=="object"&&E!==null&&E.$$typeof===t},go.isForwardRef=function(E){return S(E)===o},go.isFragment=function(E){return S(E)===r},go.isLazy=function(E){return S(E)===g},go.isMemo=function(E){return S(E)===f},go.isPortal=function(E){return S(E)===e},go.isProfiler=function(E){return S(E)===i},go.isStrictMode=function(E){return S(E)===n},go.isSuspense=function(E){return S(E)===u},go.isSuspenseList=function(E){return S(E)===h},go.isValidElementType=function(E){return typeof E=="string"||typeof E=="function"||E===r||E===i||E===n||E===u||E===h||typeof E=="object"&&E!==null&&(E.$$typeof===g||E.$$typeof===f||E.$$typeof===s||E.$$typeof===a||E.$$typeof===o||E.$$typeof===v||E.getModuleId!==void 0)},go.typeOf=S,go}var uF;function Eae(){return uF||(uF=1,t3.exports=Sae()),t3.exports}var vW=Eae();function $f(t){if(typeof t!="object"||t===null)return!1;const e=Object.getPrototypeOf(t);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)}function _W(t){if(ee.isValidElement(t)||vW.isValidElementType(t)||!$f(t))return t;const e={};return Object.keys(t).forEach(r=>{e[r]=_W(t[r])}),e}function Vu(t,e,r={clone:!0}){const n=r.clone?{...t}:t;return $f(t)&&$f(e)&&Object.keys(e).forEach(i=>{ee.isValidElement(e[i])||vW.isValidElementType(e[i])?n[i]=e[i]:$f(e[i])&&Object.prototype.hasOwnProperty.call(t,i)&&$f(t[i])?n[i]=Vu(t[i],e[i],r):r.clone?n[i]=$f(e[i])?_W(e[i]):e[i]:n[i]=e[i]}),n}const Tae=t=>{const e=Object.keys(t).map(r=>({key:r,val:t[r]}))||[];return e.sort((r,n)=>r.val-n.val),e.reduce((r,n)=>({...r,[n.key]:n.val}),{})};function Cae(t){const{values:e={xs:0,sm:600,md:900,lg:1200,xl:1536},unit:r="px",step:n=5,...i}=t,a=Tae(e),s=Object.keys(a);function o(b){return`@media (min-width:${typeof e[b]=="number"?e[b]:b}${r})`}function u(b){return`@media (max-width:${(typeof e[b]=="number"?e[b]:b)-n/100}${r})`}function h(b,v){const S=s.indexOf(v);return`@media (min-width:${typeof e[b]=="number"?e[b]:b}${r}) and (max-width:${(S!==-1&&typeof e[s[S]]=="number"?e[s[S]]:v)-n/100}${r})`}function f(b){return s.indexOf(b)+1<s.length?h(b,s[s.indexOf(b)+1]):o(b)}function g(b){const v=s.indexOf(b);return v===0?o(s[1]):v===s.length-1?u(s[v]):h(b,s[s.indexOf(b)+1]).replace("@media","@media not all and")}return{keys:s,values:a,up:o,down:u,between:h,only:f,not:g,unit:r,...i}}function cF(t,e){if(!t.containerQueries)return e;const r=Object.keys(e).filter(n=>n.startsWith("@container")).sort((n,i)=>{const a=/min-width:\s*([0-9.]+)/;return+(n.match(a)?.[1]||0)-+(i.match(a)?.[1]||0)});return r.length?r.reduce((n,i)=>{const a=e[i];return delete n[i],n[i]=a,n},{...e}):e}function Aae(t,e){return e==="@"||e.startsWith("@")&&(t.some(r=>e.startsWith(`@${r}`))||!!e.match(/^@\d/))}function Iae(t,e){const r=e.match(/^@([^/]+)?\/?(.+)?$/);if(!r)return null;const[,n,i]=r,a=Number.isNaN(+n)?n||0:+n;return t.containerQueries(i).up(a)}function Pae(t){const e=(a,s)=>a.replace("@media",s?`@container ${s}`:"@container");function r(a,s){a.up=(...o)=>e(t.breakpoints.up(...o),s),a.down=(...o)=>e(t.breakpoints.down(...o),s),a.between=(...o)=>e(t.breakpoints.between(...o),s),a.only=(...o)=>e(t.breakpoints.only(...o),s),a.not=(...o)=>{const u=e(t.breakpoints.not(...o),s);return u.includes("not all and")?u.replace("not all and ","").replace("min-width:","width<").replace("max-width:","width>").replace("and","or"):u}}const n={},i=a=>(r(n,a),n);return r(i),{...t,containerQueries:i}}const kae={borderRadius:4};function v1(t,e){return e?Vu(t,e,{clone:!1}):t}const LE={xs:0,sm:600,md:900,lg:1200,xl:1536},hF={keys:["xs","sm","md","lg","xl"],up:t=>`@media (min-width:${LE[t]}px)`},Mae={containerQueries:t=>({up:e=>{let r=typeof e=="number"?e:LE[e]||e;return typeof r=="number"&&(r=`${r}px`),t?`@container ${t} (min-width:${r})`:`@container (min-width:${r})`}})};function qd(t,e,r){const n=t.theme||{};if(Array.isArray(e)){const a=n.breakpoints||hF;return e.reduce((s,o,u)=>(s[a.up(a.keys[u])]=r(e[u]),s),{})}if(typeof e=="object"){const a=n.breakpoints||hF;return Object.keys(e).reduce((s,o)=>{if(Aae(a.keys,o)){const u=Iae(n.containerQueries?n:Mae,o);u&&(s[u]=r(e[o],o))}else if(Object.keys(a.values||LE).includes(o)){const u=a.up(o);s[u]=r(e[o],o)}else{const u=o;s[u]=e[u]}return s},{})}return r(e)}function Rae(t={}){return t.keys?.reduce((r,n)=>{const i=t.up(n);return r[i]={},r},{})||{}}function fF(t,e){return t.reduce((r,n)=>{const i=r[n];return(!i||Object.keys(i).length===0)&&delete r[n],r},e)}function on(t){if(typeof t!="string")throw new Error($d(7));return t.charAt(0).toUpperCase()+t.slice(1)}function NE(t,e,r=!0){if(!e||typeof e!="string")return null;if(t&&t.vars&&r){const n=`vars.${e}`.split(".").reduce((i,a)=>i&&i[a]?i[a]:null,t);if(n!=null)return n}return e.split(".").reduce((n,i)=>n&&n[i]!=null?n[i]:null,t)}function $w(t,e,r,n=r){let i;return typeof t=="function"?i=t(r):Array.isArray(t)?i=t[r]||n:i=NE(t,r)||n,e&&(i=e(i,n,t)),i}function Js(t){const{prop:e,cssProperty:r=t.prop,themeKey:n,transform:i}=t,a=s=>{if(s[e]==null)return null;const o=s[e],u=s.theme,h=NE(u,n)||{};return qd(s,o,g=>{let b=$w(h,i,g);return g===b&&typeof g=="string"&&(b=$w(h,i,`${e}${g==="default"?"":on(g)}`,g)),r===!1?b:{[r]:b}})};return a.propTypes={},a.filterProps=[e],a}function Oae(t){const e={};return r=>(e[r]===void 0&&(e[r]=t(r)),e[r])}const Lae={m:"margin",p:"padding"},Nae={t:"Top",r:"Right",b:"Bottom",l:"Left",x:["Left","Right"],y:["Top","Bottom"]},dF={marginX:"mx",marginY:"my",paddingX:"px",paddingY:"py"},Dae=Oae(t=>{if(t.length>2)if(dF[t])t=dF[t];else return[t];const[e,r]=t.split(""),n=Lae[e],i=Nae[r]||"";return Array.isArray(i)?i.map(a=>n+a):[n+i]}),TR=["m","mt","mr","mb","ml","mx","my","margin","marginTop","marginRight","marginBottom","marginLeft","marginX","marginY","marginInline","marginInlineStart","marginInlineEnd","marginBlock","marginBlockStart","marginBlockEnd"],CR=["p","pt","pr","pb","pl","px","py","padding","paddingTop","paddingRight","paddingBottom","paddingLeft","paddingX","paddingY","paddingInline","paddingInlineStart","paddingInlineEnd","paddingBlock","paddingBlockStart","paddingBlockEnd"];[...TR,...CR];function zb(t,e,r,n){const i=NE(t,e,!0)??r;return typeof i=="number"||typeof i=="string"?a=>typeof a=="string"?a:typeof i=="string"?i.startsWith("var(")&&a===0?0:i.startsWith("var(")&&a===1?i:`calc(${a} * ${i})`:i*a:Array.isArray(i)?a=>{if(typeof a=="string")return a;const s=Math.abs(a),o=i[s];return a>=0?o:typeof o=="number"?-o:typeof o=="string"&&o.startsWith("var(")?`calc(-1 * ${o})`:`-${o}`}:typeof i=="function"?i:()=>{}}function AR(t){return zb(t,"spacing",8)}function jb(t,e){return typeof e=="string"||e==null?e:t(e)}function Fae(t,e){return r=>t.reduce((n,i)=>(n[i]=jb(e,r),n),{})}function Bae(t,e,r,n){if(!e.includes(r))return null;const i=Dae(r),a=Fae(i,n),s=t[r];return qd(t,s,a)}function bW(t,e){const r=AR(t.theme);return Object.keys(t).map(n=>Bae(t,e,n,r)).reduce(v1,{})}function Rs(t){return bW(t,TR)}Rs.propTypes={};Rs.filterProps=TR;function Os(t){return bW(t,CR)}Os.propTypes={};Os.filterProps=CR;function xW(t=8,e=AR({spacing:t})){if(t.mui)return t;const r=(...n)=>(n.length===0?[1]:n).map(a=>{const s=e(a);return typeof s=="number"?`${s}px`:s}).join(" ");return r.mui=!0,r}function DE(...t){const e=t.reduce((n,i)=>(i.filterProps.forEach(a=>{n[a]=i}),n),{}),r=n=>Object.keys(n).reduce((i,a)=>e[a]?v1(i,e[a](n)):i,{});return r.propTypes={},r.filterProps=t.reduce((n,i)=>n.concat(i.filterProps),[]),r}function mh(t){return typeof t!="number"?t:`${t}px solid`}function Nh(t,e){return Js({prop:t,themeKey:"borders",transform:e})}const zae=Nh("border",mh),jae=Nh("borderTop",mh),Uae=Nh("borderRight",mh),Vae=Nh("borderBottom",mh),$ae=Nh("borderLeft",mh),qae=Nh("borderColor"),Hae=Nh("borderTopColor"),Wae=Nh("borderRightColor"),Gae=Nh("borderBottomColor"),Xae=Nh("borderLeftColor"),Yae=Nh("outline",mh),Zae=Nh("outlineColor"),FE=t=>{if(t.borderRadius!==void 0&&t.borderRadius!==null){const e=zb(t.theme,"shape.borderRadius",4),r=n=>({borderRadius:jb(e,n)});return qd(t,t.borderRadius,r)}return null};FE.propTypes={};FE.filterProps=["borderRadius"];DE(zae,jae,Uae,Vae,$ae,qae,Hae,Wae,Gae,Xae,FE,Yae,Zae);const BE=t=>{if(t.gap!==void 0&&t.gap!==null){const e=zb(t.theme,"spacing",8),r=n=>({gap:jb(e,n)});return qd(t,t.gap,r)}return null};BE.propTypes={};BE.filterProps=["gap"];const zE=t=>{if(t.columnGap!==void 0&&t.columnGap!==null){const e=zb(t.theme,"spacing",8),r=n=>({columnGap:jb(e,n)});return qd(t,t.columnGap,r)}return null};zE.propTypes={};zE.filterProps=["columnGap"];const jE=t=>{if(t.rowGap!==void 0&&t.rowGap!==null){const e=zb(t.theme,"spacing",8),r=n=>({rowGap:jb(e,n)});return qd(t,t.rowGap,r)}return null};jE.propTypes={};jE.filterProps=["rowGap"];const Kae=Js({prop:"gridColumn"}),Jae=Js({prop:"gridRow"}),Qae=Js({prop:"gridAutoFlow"}),eoe=Js({prop:"gridAutoColumns"}),toe=Js({prop:"gridAutoRows"}),roe=Js({prop:"gridTemplateColumns"}),noe=Js({prop:"gridTemplateRows"}),ioe=Js({prop:"gridTemplateAreas"}),aoe=Js({prop:"gridArea"});DE(BE,zE,jE,Kae,Jae,Qae,eoe,toe,roe,noe,ioe,aoe);function zv(t,e){return e==="grey"?e:t}const ooe=Js({prop:"color",themeKey:"palette",transform:zv}),soe=Js({prop:"bgcolor",cssProperty:"backgroundColor",themeKey:"palette",transform:zv}),loe=Js({prop:"backgroundColor",themeKey:"palette",transform:zv});DE(ooe,soe,loe);function Yc(t){return t<=1&&t!==0?`${t*100}%`:t}const uoe=Js({prop:"width",transform:Yc}),IR=t=>{if(t.maxWidth!==void 0&&t.maxWidth!==null){const e=r=>{const n=t.theme?.breakpoints?.values?.[r]||LE[r];return n?t.theme?.breakpoints?.unit!=="px"?{maxWidth:`${n}${t.theme.breakpoints.unit}`}:{maxWidth:n}:{maxWidth:Yc(r)}};return qd(t,t.maxWidth,e)}return null};IR.filterProps=["maxWidth"];const coe=Js({prop:"minWidth",transform:Yc}),hoe=Js({prop:"height",transform:Yc}),foe=Js({prop:"maxHeight",transform:Yc}),doe=Js({prop:"minHeight",transform:Yc});Js({prop:"size",cssProperty:"width",transform:Yc});Js({prop:"size",cssProperty:"height",transform:Yc});const poe=Js({prop:"boxSizing"});DE(uoe,IR,coe,hoe,foe,doe,poe);const Ub={border:{themeKey:"borders",transform:mh},borderTop:{themeKey:"borders",transform:mh},borderRight:{themeKey:"borders",transform:mh},borderBottom:{themeKey:"borders",transform:mh},borderLeft:{themeKey:"borders",transform:mh},borderColor:{themeKey:"palette"},borderTopColor:{themeKey:"palette"},borderRightColor:{themeKey:"palette"},borderBottomColor:{themeKey:"palette"},borderLeftColor:{themeKey:"palette"},outline:{themeKey:"borders",transform:mh},outlineColor:{themeKey:"palette"},borderRadius:{themeKey:"shape.borderRadius",style:FE},color:{themeKey:"palette",transform:zv},bgcolor:{themeKey:"palette",cssProperty:"backgroundColor",transform:zv},backgroundColor:{themeKey:"palette",transform:zv},p:{style:Os},pt:{style:Os},pr:{style:Os},pb:{style:Os},pl:{style:Os},px:{style:Os},py:{style:Os},padding:{style:Os},paddingTop:{style:Os},paddingRight:{style:Os},paddingBottom:{style:Os},paddingLeft:{style:Os},paddingX:{style:Os},paddingY:{style:Os},paddingInline:{style:Os},paddingInlineStart:{style:Os},paddingInlineEnd:{style:Os},paddingBlock:{style:Os},paddingBlockStart:{style:Os},paddingBlockEnd:{style:Os},m:{style:Rs},mt:{style:Rs},mr:{style:Rs},mb:{style:Rs},ml:{style:Rs},mx:{style:Rs},my:{style:Rs},margin:{style:Rs},marginTop:{style:Rs},marginRight:{style:Rs},marginBottom:{style:Rs},marginLeft:{style:Rs},marginX:{style:Rs},marginY:{style:Rs},marginInline:{style:Rs},marginInlineStart:{style:Rs},marginInlineEnd:{style:Rs},marginBlock:{style:Rs},marginBlockStart:{style:Rs},marginBlockEnd:{style:Rs},displayPrint:{cssProperty:!1,transform:t=>({"@media print":{display:t}})},display:{},overflow:{},textOverflow:{},visibility:{},whiteSpace:{},flexBasis:{},flexDirection:{},flexWrap:{},justifyContent:{},alignItems:{},alignContent:{},order:{},flex:{},flexGrow:{},flexShrink:{},alignSelf:{},justifyItems:{},justifySelf:{},gap:{style:BE},rowGap:{style:jE},columnGap:{style:zE},gridColumn:{},gridRow:{},gridAutoFlow:{},gridAutoColumns:{},gridAutoRows:{},gridTemplateColumns:{},gridTemplateRows:{},gridTemplateAreas:{},gridArea:{},position:{},zIndex:{themeKey:"zIndex"},top:{},right:{},bottom:{},left:{},boxShadow:{themeKey:"shadows"},width:{transform:Yc},maxWidth:{style:IR},minWidth:{transform:Yc},height:{transform:Yc},maxHeight:{transform:Yc},minHeight:{transform:Yc},boxSizing:{},font:{themeKey:"font"},fontFamily:{themeKey:"typography"},fontSize:{themeKey:"typography"},fontStyle:{themeKey:"typography"},fontWeight:{themeKey:"typography"},letterSpacing:{},textTransform:{},lineHeight:{},textAlign:{},typography:{cssProperty:!1,themeKey:"typography"}};function goe(...t){const e=t.reduce((n,i)=>n.concat(Object.keys(i)),[]),r=new Set(e);return t.every(n=>r.size===Object.keys(n).length)}function moe(t,e){return typeof t=="function"?t(e):t}function yoe(){function t(r,n,i,a){const s={[r]:n,theme:i},o=a[r];if(!o)return{[r]:n};const{cssProperty:u=r,themeKey:h,transform:f,style:g}=o;if(n==null)return null;if(h==="typography"&&n==="inherit")return{[r]:n};const b=NE(i,h)||{};return g?g(s):qd(s,n,S=>{let E=$w(b,f,S);return S===E&&typeof S=="string"&&(E=$w(b,f,`${r}${S==="default"?"":on(S)}`,S)),u===!1?E:{[u]:E}})}function e(r){const{sx:n,theme:i={},nested:a}=r||{};if(!n)return null;const s=i.unstable_sxConfig??Ub;function o(u){let h=u;if(typeof u=="function")h=u(i);else if(typeof u!="object")return u;if(!h)return null;const f=Rae(i.breakpoints),g=Object.keys(f);let b=f;return Object.keys(h).forEach(v=>{const S=moe(h[v],i);if(S!=null)if(typeof S=="object")if(s[v])b=v1(b,t(v,S,i,s));else{const E=qd({theme:i},S,P=>({[v]:P}));goe(E,S)?b[v]=e({sx:S,theme:i,nested:!0}):b=v1(b,E)}else b=v1(b,t(v,S,i,s))}),!a&&i.modularCssLayers?{"@layer sx":cF(i,fF(g,b))}:cF(i,fF(g,b))}return Array.isArray(n)?n.map(o):o(n)}return e}const Yp=yoe();Yp.filterProps=["sx"];function voe(t,e){const r=this;if(r.vars){if(!r.colorSchemes?.[t]||typeof r.getColorSchemeSelector!="function")return{};let n=r.getColorSchemeSelector(t);return n==="&"?e:((n.includes("data-")||n.includes("."))&&(n=`*:where(${n.replace(/\s*&$/,"")}) &`),{[n]:e})}return r.palette.mode===t?e:{}}function UE(t={},...e){const{breakpoints:r={},palette:n={},spacing:i,shape:a={},...s}=t,o=Cae(r),u=xW(i);let h=Vu({breakpoints:o,direction:"ltr",components:{},palette:{mode:"light",...n},spacing:u,shape:{...kae,...a}},s);return h=Pae(h),h.applyStyles=voe,h=e.reduce((f,g)=>Vu(f,g),h),h.unstable_sxConfig={...Ub,...s?.unstable_sxConfig},h.unstable_sx=function(g){return Yp({sx:g,theme:this})},h}function _oe(t){return Object.keys(t).length===0}function VE(t=null){const e=ee.useContext(Fb);return!e||_oe(e)?t:e}const boe=UE();function Vb(t=boe){return VE(t)}function r3(t){const e=Vp(t);return t!==e&&e.styles?(e.styles.match(/^@layer\s+[^{]*$/)||(e.styles=`@layer global{${e.styles}}`),e):t}function wW({styles:t,themeId:e,defaultTheme:r={}}){const n=Vb(r),i=e&&n[e]||n;let a=typeof t=="function"?t(i):t;return i.modularCssLayers&&(Array.isArray(a)?a=a.map(s=>r3(typeof s=="function"?s(i):s)):a=r3(a)),K.jsx(mW,{styles:a})}const xoe=t=>{const e={systemProps:{},otherProps:{}},r=t?.theme?.unstable_sxConfig??Ub;return Object.keys(t).forEach(n=>{r[n]?e.systemProps[n]=t[n]:e.otherProps[n]=t[n]}),e};function PR(t){const{sx:e,...r}=t,{systemProps:n,otherProps:i}=xoe(r);let a;return Array.isArray(e)?a=[n,...e]:typeof e=="function"?a=(...s)=>{const o=e(...s);return $f(o)?{...n,...o}:n}:a={...n,...e},{...i,sx:a}}const pF=t=>t,woe=()=>{let t=pF;return{configure(e){t=e},generate(e){return t(e)},reset(){t=pF}}},kR=woe();function SW(t){var e,r,n="";if(typeof t=="string"||typeof t=="number")n+=t;else if(typeof t=="object")if(Array.isArray(t)){var i=t.length;for(e=0;e<i;e++)t[e]&&(r=SW(t[e]))&&(n&&(n+=" "),n+=r)}else for(r in t)t[r]&&(n&&(n+=" "),n+=r);return n}function Sn(){for(var t,e,r=0,n="",i=arguments.length;r<i;r++)(t=arguments[r])&&(e=SW(t))&&(n&&(n+=" "),n+=e);return n}function EW(t={}){const{themeId:e,defaultTheme:r,defaultClassName:n="MuiBox-root",generateClassName:i}=t,a=yW("div",{shouldForwardProp:o=>o!=="theme"&&o!=="sx"&&o!=="as"})(Yp);return ee.forwardRef(function(u,h){const f=Vb(r),{className:g,component:b="div",...v}=PR(u);return K.jsx(a,{as:b,ref:h,className:Sn(g,i?i(n):n),theme:e&&f[e]||f,...v})})}const Soe={active:"active",checked:"checked",completed:"completed",disabled:"disabled",error:"error",expanded:"expanded",focused:"focused",focusVisible:"focusVisible",open:"open",readOnly:"readOnly",required:"required",selected:"selected"};function fi(t,e,r="Mui"){const n=Soe[e];return n?`${r}-${n}`:`${kR.generate(t)}-${e}`}function ui(t,e,r="Mui"){const n={};return e.forEach(i=>{n[i]=fi(t,i,r)}),n}const Eoe=ui("MuiBox",["root"]),Yy=EW({defaultClassName:Eoe.root,generateClassName:kR.generate});function TW(t){const{variants:e,...r}=t,n={variants:e,style:Vp(r),isProcessed:!0};return n.style===r||e&&e.forEach(i=>{typeof i.style!="function"&&(i.style=Vp(i.style))}),n}const Toe=UE();function n3(t){return t!=="ownerState"&&t!=="theme"&&t!=="sx"&&t!=="as"}function Yg(t,e){return e&&t&&typeof t=="object"&&t.styles&&!t.styles.startsWith("@layer")&&(t.styles=`@layer ${e}{${String(t.styles)}}`),t}function Coe(t){return t?(e,r)=>r[t]:null}function Aoe(t,e,r){t.theme=Poe(t.theme)?r:t.theme[e]||t.theme}function uw(t,e,r){const n=typeof e=="function"?e(t):e;if(Array.isArray(n))return n.flatMap(i=>uw(t,i,r));if(Array.isArray(n?.variants)){let i;if(n.isProcessed)i=r?Yg(n.style,r):n.style;else{const{variants:a,...s}=n;i=r?Yg(Vp(s),r):s}return CW(t,n.variants,[i],r)}return n?.isProcessed?r?Yg(Vp(n.style),r):n.style:r?Yg(Vp(n),r):n}function CW(t,e,r=[],n=void 0){let i;e:for(let a=0;a<e.length;a+=1){const s=e[a];if(typeof s.props=="function"){if(i??={...t,...t.ownerState,ownerState:t.ownerState},!s.props(i))continue}else for(const o in s.props)if(t[o]!==s.props[o]&&t.ownerState?.[o]!==s.props[o])continue e;typeof s.style=="function"?(i??={...t,...t.ownerState,ownerState:t.ownerState},r.push(n?Yg(Vp(s.style(i)),n):s.style(i))):r.push(n?Yg(Vp(s.style),n):s.style)}return r}function AW(t={}){const{themeId:e,defaultTheme:r=Toe,rootShouldForwardProp:n=n3,slotShouldForwardProp:i=n3}=t;function a(o){Aoe(o,e,r)}return(o,u={})=>{wae(o,B=>B.filter(q=>q!==Yp));const{name:h,slot:f,skipVariantsResolver:g,skipSx:b,overridesResolver:v=Coe(Moe(f)),...S}=u,E=h&&h.startsWith("Mui")||f?"components":"custom",P=g!==void 0?g:f&&f!=="Root"&&f!=="root"||!1,k=b||!1;let L=n3;f==="Root"||f==="root"?L=n:f?L=i:koe(o)&&(L=void 0);const O=yW(o,{shouldForwardProp:L,label:Ioe(),...S}),M=B=>{if(B.__emotion_real===B)return B;if(typeof B=="function")return function(W){return uw(W,B,W.theme.modularCssLayers?E:void 0)};if($f(B)){const q=TW(B);return function(G){return q.variants?uw(G,q,G.theme.modularCssLayers?E:void 0):G.theme.modularCssLayers?Yg(q.style,E):q.style}}return B},z=(...B)=>{const q=[],W=B.map(M),G=[];if(q.push(a),h&&v&&G.push(function(ne){const ce=ne.theme.components?.[h]?.styleOverrides;if(!ce)return null;const fe={};for(const Me in ce)fe[Me]=uw(ne,ce[Me],ne.theme.modularCssLayers?"theme":void 0);return v(ne,fe)}),h&&!P&&G.push(function(ne){const ce=ne.theme?.components?.[h]?.variants;return ce?CW(ne,ce,[],ne.theme.modularCssLayers?"theme":void 0):null}),k||G.push(Yp),Array.isArray(W[0])){const H=W.shift(),ne=new Array(q.length).fill(""),oe=new Array(G.length).fill("");let ce;ce=[...ne,...H,...oe],ce.raw=[...ne,...H.raw,...oe],q.unshift(ce)}const ie=[...q,...W,...G],Q=O(...ie);return o.muiName&&(Q.muiName=o.muiName),Q};return O.withConfig&&(z.withConfig=O.withConfig),z}}function Ioe(t,e){return void 0}function Poe(t){for(const e in t)return!1;return!0}function koe(t){return typeof t=="string"&&t.charCodeAt(0)>96}function Moe(t){return t&&t.charAt(0).toLowerCase()+t.slice(1)}const Fm=AW();function G1(t,e,r=!1){const n={...e};for(const i in t)if(Object.prototype.hasOwnProperty.call(t,i)){const a=i;if(a==="components"||a==="slots")n[a]={...t[a],...n[a]};else if(a==="componentsProps"||a==="slotProps"){const s=t[a],o=e[a];if(!o)n[a]=s||{};else if(!s)n[a]=o;else{n[a]={...o};for(const u in s)if(Object.prototype.hasOwnProperty.call(s,u)){const h=u;n[a][h]=G1(s[h],o[h],r)}}}else a==="className"&&r&&e.className?n.className=Sn(t?.className,e?.className):a==="style"&&r&&e.style?n.style={...t?.style,...e?.style}:n[a]===void 0&&(n[a]=t[a])}return n}function IW(t){const{theme:e,name:r,props:n}=t;return!e||!e.components||!e.components[r]||!e.components[r].defaultProps?n:G1(e.components[r].defaultProps,n)}function Roe({props:t,name:e,defaultTheme:r,themeId:n}){let i=Vb(r);return n&&(i=i[n]||i),IW({theme:i,name:e,props:t})}const yu=typeof window<"u"?ee.useLayoutEffect:ee.useEffect;function Ooe(t,e,r,n,i){const[a,s]=ee.useState(()=>i&&r?r(t).matches:n?n(t).matches:e);return yu(()=>{if(!r)return;const o=r(t),u=()=>{s(o.matches)};return u(),o.addEventListener("change",u),()=>{o.removeEventListener("change",u)}},[t,r]),a}const Loe={...jw},PW=Loe.useSyncExternalStore;function Noe(t,e,r,n,i){const a=ee.useCallback(()=>e,[e]),s=ee.useMemo(()=>{if(i&&r)return()=>r(t).matches;if(n!==null){const{matches:f}=n(t);return()=>f}return a},[a,t,n,i,r]),[o,u]=ee.useMemo(()=>{if(r===null)return[a,()=>()=>{}];const f=r(t);return[()=>f.matches,g=>(f.addEventListener("change",g),()=>{f.removeEventListener("change",g)})]},[a,r,t]);return PW(u,o,s)}function kW(t={}){const{themeId:e}=t;return function(n,i={}){let a=VE();a&&e&&(a=a[e]||a);const s=typeof window<"u"&&typeof window.matchMedia<"u",{defaultMatches:o=!1,matchMedia:u=s?window.matchMedia:null,ssrMatchMedia:h=null,noSsr:f=!1}=IW({name:"MuiUseMediaQuery",props:i,theme:a});let g=typeof n=="function"?n(a):n;return g=g.replace(/^@media( ?)/m,""),g.includes("print")&&console.warn(["MUI: You have provided a `print` query to the `useMediaQuery` hook.","Using the print media query to modify print styles can lead to unexpected results.","Consider using the `displayPrint` field in the `sx` prop instead.","More information about `displayPrint` on our docs: https://mui.com/system/display/#display-in-print."].join(`
`)),(PW!==void 0?Noe:Ooe)(g,o,u,h,f)}}kW();function Zy(t,e=Number.MIN_SAFE_INTEGER,r=Number.MAX_SAFE_INTEGER){return Math.max(e,Math.min(t,r))}function MR(t,e=0,r=1){return Zy(t,e,r)}function Doe(t){t=t.slice(1);const e=new RegExp(`.{1,${t.length>=6?2:1}}`,"g");let r=t.match(e);return r&&r[0].length===1&&(r=r.map(n=>n+n)),r?`rgb${r.length===4?"a":""}(${r.map((n,i)=>i<3?parseInt(n,16):Math.round(parseInt(n,16)/255*1e3)/1e3).join(", ")})`:""}function Zp(t){if(t.type)return t;if(t.charAt(0)==="#")return Zp(Doe(t));const e=t.indexOf("("),r=t.substring(0,e);if(!["rgb","rgba","hsl","hsla","color"].includes(r))throw new Error($d(9,t));let n=t.substring(e+1,t.length-1),i;if(r==="color"){if(n=n.split(" "),i=n.shift(),n.length===4&&n[3].charAt(0)==="/"&&(n[3]=n[3].slice(1)),!["srgb","display-p3","a98-rgb","prophoto-rgb","rec-2020"].includes(i))throw new Error($d(10,i))}else n=n.split(",");return n=n.map(a=>parseFloat(a)),{type:r,values:n,colorSpace:i}}const Foe=t=>{const e=Zp(t);return e.values.slice(0,3).map((r,n)=>e.type.includes("hsl")&&n!==0?`${r}%`:r).join(" ")},H_=(t,e)=>{try{return Foe(t)}catch{return t}};function $E(t){const{type:e,colorSpace:r}=t;let{values:n}=t;return e.includes("rgb")?n=n.map((i,a)=>a<3?parseInt(i,10):i):e.includes("hsl")&&(n[1]=`${n[1]}%`,n[2]=`${n[2]}%`),e.includes("color")?n=`${r} ${n.join(" ")}`:n=`${n.join(", ")}`,`${e}(${n})`}function MW(t){t=Zp(t);const{values:e}=t,r=e[0],n=e[1]/100,i=e[2]/100,a=n*Math.min(i,1-i),s=(h,f=(h+r/30)%12)=>i-a*Math.max(Math.min(f-3,9-f,1),-1);let o="rgb";const u=[Math.round(s(0)*255),Math.round(s(8)*255),Math.round(s(4)*255)];return t.type==="hsla"&&(o+="a",u.push(e[3])),$E({type:o,values:u})}function dP(t){t=Zp(t);let e=t.type==="hsl"||t.type==="hsla"?Zp(MW(t)).values:t.values;return e=e.map(r=>(t.type!=="color"&&(r/=255),r<=.03928?r/12.92:((r+.055)/1.055)**2.4)),Number((.2126*e[0]+.7152*e[1]+.0722*e[2]).toFixed(3))}function Boe(t,e){const r=dP(t),n=dP(e);return(Math.max(r,n)+.05)/(Math.min(r,n)+.05)}function qw(t,e){return t=Zp(t),e=MR(e),(t.type==="rgb"||t.type==="hsl")&&(t.type+="a"),t.type==="color"?t.values[3]=`/${e}`:t.values[3]=e,$E(t)}function kg(t,e,r){try{return qw(t,e)}catch{return t}}function qE(t,e){if(t=Zp(t),e=MR(e),t.type.includes("hsl"))t.values[2]*=1-e;else if(t.type.includes("rgb")||t.type.includes("color"))for(let r=0;r<3;r+=1)t.values[r]*=1-e;return $E(t)}function no(t,e,r){try{return qE(t,e)}catch{return t}}function HE(t,e){if(t=Zp(t),e=MR(e),t.type.includes("hsl"))t.values[2]+=(100-t.values[2])*e;else if(t.type.includes("rgb"))for(let r=0;r<3;r+=1)t.values[r]+=(255-t.values[r])*e;else if(t.type.includes("color"))for(let r=0;r<3;r+=1)t.values[r]+=(1-t.values[r])*e;return $E(t)}function io(t,e,r){try{return HE(t,e)}catch{return t}}function pP(t,e=.15){return dP(t)>.5?qE(t,e):HE(t,e)}function zx(t,e,r){try{return pP(t,e)}catch{return t}}const RW=ee.createContext(null);function RR(){return ee.useContext(RW)}const zoe=typeof Symbol=="function"&&Symbol.for,joe=zoe?Symbol.for("mui.nested"):"__THEME_NESTED__";function Uoe(t,e){return typeof e=="function"?e(t):{...t,...e}}function Voe(t){const{children:e,theme:r}=t,n=RR(),i=ee.useMemo(()=>{const a=n===null?{...r}:Uoe(n,r);return a!=null&&(a[joe]=n!==null),a},[r,n]);return K.jsx(RW.Provider,{value:i,children:e})}const OW=ee.createContext();function $oe({value:t,...e}){return K.jsx(OW.Provider,{value:t??!0,...e})}const $b=()=>ee.useContext(OW)??!1,LW=ee.createContext(void 0);function qoe({value:t,children:e}){return K.jsx(LW.Provider,{value:t,children:e})}function Hoe(t){const{theme:e,name:r,props:n}=t;if(!e||!e.components||!e.components[r])return n;const i=e.components[r];return i.defaultProps?G1(i.defaultProps,n,e.components.mergeClassNameAndStyle):!i.styleOverrides&&!i.variants?G1(i,n,e.components.mergeClassNameAndStyle):n}function Woe({props:t,name:e}){const r=ee.useContext(LW);return Hoe({props:t,name:e,theme:{components:r}})}let gF=0;function Goe(t){const[e,r]=ee.useState(t),n=t||e;return ee.useEffect(()=>{e==null&&(gF+=1,r(`mui-${gF}`))},[e]),n}const Xoe={...jw},mF=Xoe.useId;function ag(t){if(mF!==void 0){const e=mF();return t??e}return Goe(t)}function Yoe(t){const e=VE(),r=ag()||"",{modularCssLayers:n}=t;let i="mui.global, mui.components, mui.theme, mui.custom, mui.sx";return!n||e!==null?i="":typeof n=="string"?i=n.replace(/mui(?!\.)/g,i):i=`@layer ${i};`,yu(()=>{const a=document.querySelector("head");if(!a)return;const s=a.firstChild;if(i){if(s&&s.hasAttribute?.("data-mui-layer-order")&&s.getAttribute("data-mui-layer-order")===r)return;const o=document.createElement("style");o.setAttribute("data-mui-layer-order",r),o.textContent=i,a.prepend(o)}else a.querySelector(`style[data-mui-layer-order="${r}"]`)?.remove()},[i,r]),i?K.jsx(wW,{styles:i}):null}const yF={};function vF(t,e,r,n=!1){return ee.useMemo(()=>{const i=t&&e[t]||e;if(typeof r=="function"){const a=r(i),s=t?{...e,[t]:a}:a;return n?()=>s:s}return t?{...e,[t]:r}:{...e,...r}},[t,e,r,n])}function NW(t){const{children:e,theme:r,themeId:n}=t,i=VE(yF),a=RR()||yF,s=vF(n,i,r),o=vF(n,a,r,!0),u=(n?s[n]:s).direction==="rtl",h=Yoe(s);return K.jsx(Voe,{theme:o,children:K.jsx(Fb.Provider,{value:s,children:K.jsx($oe,{value:u,children:K.jsxs(qoe,{value:n?s[n].components:s.components,children:[h,e]})})})})}const _F={theme:void 0};function Zoe(t){let e,r;return function(i){let a=e;return(a===void 0||i.theme!==r)&&(_F.theme=i.theme,a=TW(t(_F)),e=a,r=i.theme),a}}const OR="mode",LR="color-scheme",Koe="data-color-scheme";function Joe(t){const{defaultMode:e="system",defaultLightColorScheme:r="light",defaultDarkColorScheme:n="dark",modeStorageKey:i=OR,colorSchemeStorageKey:a=LR,attribute:s=Koe,colorSchemeNode:o="document.documentElement",nonce:u}=t||{};let h="",f=s;if(s==="class"&&(f=".%s"),s==="data"&&(f="[data-%s]"),f.startsWith(".")){const b=f.substring(1);h+=`${o}.classList.remove('${b}'.replace('%s', light), '${b}'.replace('%s', dark));
      ${o}.classList.add('${b}'.replace('%s', colorScheme));`}const g=f.match(/\[([^[\]]+)\]/);if(g){const[b,v]=g[1].split("=");v||(h+=`${o}.removeAttribute('${b}'.replace('%s', light));
      ${o}.removeAttribute('${b}'.replace('%s', dark));`),h+=`
      ${o}.setAttribute('${b}'.replace('%s', colorScheme), ${v?`${v}.replace('%s', colorScheme)`:'""'});`}else h+=`${o}.setAttribute('${f}', colorScheme);`;return K.jsx("script",{suppressHydrationWarning:!0,nonce:typeof window>"u"?u:"",dangerouslySetInnerHTML:{__html:`(function() {
try {
  let colorScheme = '';
  const mode = localStorage.getItem('${i}') || '${e}';
  const dark = localStorage.getItem('${a}-dark') || '${n}';
  const light = localStorage.getItem('${a}-light') || '${r}';
  if (mode === 'system') {
    // handle system mode
    const mql = window.matchMedia('(prefers-color-scheme: dark)');
    if (mql.matches) {
      colorScheme = dark
    } else {
      colorScheme = light
    }
  }
  if (mode === 'light') {
    colorScheme = light;
  }
  if (mode === 'dark') {
    colorScheme = dark;
  }
  if (colorScheme) {
    ${h}
  }
} catch(e){}})();`}},"mui-color-scheme-init")}function Qoe(){}const ese=({key:t,storageWindow:e})=>(!e&&typeof window<"u"&&(e=window),{get(r){if(typeof window>"u")return;if(!e)return r;let n;try{n=e.localStorage.getItem(t)}catch{}return n||r},set:r=>{if(e)try{e.localStorage.setItem(t,r)}catch{}},subscribe:r=>{if(!e)return Qoe;const n=i=>{const a=i.newValue;i.key===t&&r(a)};return e.addEventListener("storage",n),()=>{e.removeEventListener("storage",n)}}});function i3(){}function bF(t){if(typeof window<"u"&&typeof window.matchMedia=="function"&&t==="system")return window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"}function DW(t,e){if(t.mode==="light"||t.mode==="system"&&t.systemMode==="light")return e("light");if(t.mode==="dark"||t.mode==="system"&&t.systemMode==="dark")return e("dark")}function tse(t){return DW(t,e=>{if(e==="light")return t.lightColorScheme;if(e==="dark")return t.darkColorScheme})}function rse(t){const{defaultMode:e="light",defaultLightColorScheme:r,defaultDarkColorScheme:n,supportedColorSchemes:i=[],modeStorageKey:a=OR,colorSchemeStorageKey:s=LR,storageWindow:o=typeof window>"u"?void 0:window,storageManager:u=ese,noSsr:h=!1}=t,f=i.join(","),g=i.length>1,b=ee.useMemo(()=>u?.({key:a,storageWindow:o}),[u,a,o]),v=ee.useMemo(()=>u?.({key:`${s}-light`,storageWindow:o}),[u,s,o]),S=ee.useMemo(()=>u?.({key:`${s}-dark`,storageWindow:o}),[u,s,o]),[E,P]=ee.useState(()=>{const W=b?.get(e)||e,G=v?.get(r)||r,ie=S?.get(n)||n;return{mode:W,systemMode:bF(W),lightColorScheme:G,darkColorScheme:ie}}),[k,L]=ee.useState(h||!g);ee.useEffect(()=>{L(!0)},[]);const O=tse(E),M=ee.useCallback(W=>{P(G=>{if(W===G.mode)return G;const ie=W??e;return b?.set(ie),{...G,mode:ie,systemMode:bF(ie)}})},[b,e]),z=ee.useCallback(W=>{W?typeof W=="string"?W&&!f.includes(W)?console.error(`\`${W}\` does not exist in \`theme.colorSchemes\`.`):P(G=>{const ie={...G};return DW(G,Q=>{Q==="light"&&(v?.set(W),ie.lightColorScheme=W),Q==="dark"&&(S?.set(W),ie.darkColorScheme=W)}),ie}):P(G=>{const ie={...G},Q=W.light===null?r:W.light,H=W.dark===null?n:W.dark;return Q&&(f.includes(Q)?(ie.lightColorScheme=Q,v?.set(Q)):console.error(`\`${Q}\` does not exist in \`theme.colorSchemes\`.`)),H&&(f.includes(H)?(ie.darkColorScheme=H,S?.set(H)):console.error(`\`${H}\` does not exist in \`theme.colorSchemes\`.`)),ie}):P(G=>(v?.set(r),S?.set(n),{...G,lightColorScheme:r,darkColorScheme:n}))},[f,v,S,r,n]),B=ee.useCallback(W=>{E.mode==="system"&&P(G=>{const ie=W?.matches?"dark":"light";return G.systemMode===ie?G:{...G,systemMode:ie}})},[E.mode]),q=ee.useRef(B);return q.current=B,ee.useEffect(()=>{if(typeof window.matchMedia!="function"||!g)return;const W=(...ie)=>q.current(...ie),G=window.matchMedia("(prefers-color-scheme: dark)");return G.addListener(W),W(G),()=>{G.removeListener(W)}},[g]),ee.useEffect(()=>{if(g){const W=b?.subscribe(Q=>{(!Q||["light","dark","system"].includes(Q))&&M(Q||e)})||i3,G=v?.subscribe(Q=>{(!Q||f.match(Q))&&z({light:Q})})||i3,ie=S?.subscribe(Q=>{(!Q||f.match(Q))&&z({dark:Q})})||i3;return()=>{W(),G(),ie()}}},[z,M,f,e,o,g,b,v,S]),{...E,mode:k?E.mode:void 0,systemMode:k?E.systemMode:void 0,colorScheme:k?O:void 0,setMode:M,setColorScheme:z}}const nse="*{-webkit-transition:none!important;-moz-transition:none!important;-o-transition:none!important;-ms-transition:none!important;transition:none!important}";function ise(t){const{themeId:e,theme:r={},modeStorageKey:n=OR,colorSchemeStorageKey:i=LR,disableTransitionOnChange:a=!1,defaultColorScheme:s,resolveTheme:o}=t,u={allColorSchemes:[],colorScheme:void 0,darkColorScheme:void 0,lightColorScheme:void 0,mode:void 0,setColorScheme:()=>{},setMode:()=>{},systemMode:void 0},h=ee.createContext(void 0),f=()=>ee.useContext(h)||u,g={},b={};function v(k){const{children:L,theme:O,modeStorageKey:M=n,colorSchemeStorageKey:z=i,disableTransitionOnChange:B=a,storageManager:q,storageWindow:W=typeof window>"u"?void 0:window,documentNode:G=typeof document>"u"?void 0:document,colorSchemeNode:ie=typeof document>"u"?void 0:document.documentElement,disableNestedContext:Q=!1,disableStyleSheetGeneration:H=!1,defaultMode:ne="system",forceThemeRerender:oe=!1,noSsr:ce}=k,fe=ee.useRef(!1),Me=RR(),me=ee.useContext(h),we=!!me&&!Q,Te=ee.useMemo(()=>O||(typeof r=="function"?r():r),[O]),ke=Te[e],he=ke||Te,{colorSchemes:Ee=g,components:xe=b,cssVarPrefix:Ne}=he,Oe=Object.keys(Ee).filter(lr=>!!Ee[lr]).join(","),$e=ee.useMemo(()=>Oe.split(","),[Oe]),De=typeof s=="string"?s:s.light,it=typeof s=="string"?s:s.dark,Ye=Ee[De]&&Ee[it]?ne:Ee[he.defaultColorScheme]?.palette?.mode||he.palette?.mode,{mode:rt,setMode:Ie,systemMode:Mt,lightColorScheme:at,darkColorScheme:je,colorScheme:Xt,setColorScheme:Yt}=rse({supportedColorSchemes:$e,defaultLightColorScheme:De,defaultDarkColorScheme:it,modeStorageKey:M,colorSchemeStorageKey:z,defaultMode:Ye,storageManager:q,storageWindow:W,noSsr:ce});let pr=rt,vt=Xt;we&&(pr=me.mode,vt=me.colorScheme);let yr=vt||he.defaultColorScheme;he.vars&&!oe&&(yr=he.defaultColorScheme);const _r=ee.useMemo(()=>{const lr=he.generateThemeVars?.()||he.vars,Ar={...he,components:xe,colorSchemes:Ee,cssVarPrefix:Ne,vars:lr};if(typeof Ar.generateSpacing=="function"&&(Ar.spacing=Ar.generateSpacing()),yr){const ir=Ee[yr];ir&&typeof ir=="object"&&Object.keys(ir).forEach(nt=>{ir[nt]&&typeof ir[nt]=="object"?Ar[nt]={...Ar[nt],...ir[nt]}:Ar[nt]=ir[nt]})}return o?o(Ar):Ar},[he,yr,xe,Ee,Ne]),cr=he.colorSchemeSelector;yu(()=>{if(vt&&ie&&cr&&cr!=="media"){const lr=cr;let Ar=cr;if(lr==="class"&&(Ar=".%s"),lr==="data"&&(Ar="[data-%s]"),lr?.startsWith("data-")&&!lr.includes("%s")&&(Ar=`[${lr}="%s"]`),Ar.startsWith("."))ie.classList.remove(...$e.map(ir=>Ar.substring(1).replace("%s",ir))),ie.classList.add(Ar.substring(1).replace("%s",vt));else{const ir=Ar.replace("%s",vt).match(/\[([^\]]+)\]/);if(ir){const[nt,_e]=ir[1].split("=");_e||$e.forEach(be=>{ie.removeAttribute(nt.replace(vt,be))}),ie.setAttribute(nt,_e?_e.replace(/"|'/g,""):"")}else ie.setAttribute(Ar,vt)}}},[vt,cr,ie,$e]),ee.useEffect(()=>{let lr;if(B&&fe.current&&G){const Ar=G.createElement("style");Ar.appendChild(G.createTextNode(nse)),G.head.appendChild(Ar),window.getComputedStyle(G.body),lr=setTimeout(()=>{G.head.removeChild(Ar)},1)}return()=>{clearTimeout(lr)}},[vt,B,G]),ee.useEffect(()=>(fe.current=!0,()=>{fe.current=!1}),[]);const Er=ee.useMemo(()=>({allColorSchemes:$e,colorScheme:vt,darkColorScheme:je,lightColorScheme:at,mode:pr,setColorScheme:Yt,setMode:Ie,systemMode:Mt}),[$e,vt,je,at,pr,Yt,Ie,Mt,_r.colorSchemeSelector]);let wr=!0;(H||he.cssVariables===!1||we&&Me?.cssVarPrefix===Ne)&&(wr=!1);const er=K.jsxs(ee.Fragment,{children:[K.jsx(NW,{themeId:ke?e:void 0,theme:_r,children:L}),wr&&K.jsx(mW,{styles:_r.generateStyleSheets?.()||[]})]});return we?er:K.jsx(h.Provider,{value:Er,children:er})}const S=typeof s=="string"?s:s.light,E=typeof s=="string"?s:s.dark;return{CssVarsProvider:v,useColorScheme:f,getInitColorSchemeScript:k=>Joe({colorSchemeStorageKey:i,defaultLightColorScheme:S,defaultDarkColorScheme:E,modeStorageKey:n,...k})}}function ase(t=""){function e(...n){if(!n.length)return"";const i=n[0];return typeof i=="string"&&!i.match(/(#|\(|\)|(-?(\d*\.)?\d+)(px|em|%|ex|ch|rem|vw|vh|vmin|vmax|cm|mm|in|pt|pc))|^(-?(\d*\.)?\d+)$|(\d+ \d+ \d+)/)?`, var(--${t?`${t}-`:""}${i}${e(...n.slice(1))})`:`, ${i}`}return(n,...i)=>`var(--${t?`${t}-`:""}${n}${e(...i)})`}const xF=(t,e,r,n=[])=>{let i=t;e.forEach((a,s)=>{s===e.length-1?Array.isArray(i)?i[Number(a)]=r:i&&typeof i=="object"&&(i[a]=r):i&&typeof i=="object"&&(i[a]||(i[a]=n.includes(a)?[]:{}),i=i[a])})},ose=(t,e,r)=>{function n(i,a=[],s=[]){Object.entries(i).forEach(([o,u])=>{(!r||r&&!r([...a,o]))&&u!=null&&(typeof u=="object"&&Object.keys(u).length>0?n(u,[...a,o],Array.isArray(u)?[...s,o]:s):e([...a,o],u,s))})}n(t)},sse=(t,e)=>typeof e=="number"?["lineHeight","fontWeight","opacity","zIndex"].some(n=>t.includes(n))||t[t.length-1].toLowerCase().includes("opacity")?e:`${e}px`:e;function a3(t,e){const{prefix:r,shouldSkipGeneratingVar:n}=e||{},i={},a={},s={};return ose(t,(o,u,h)=>{if((typeof u=="string"||typeof u=="number")&&(!n||!n(o,u))){const f=`--${r?`${r}-`:""}${o.join("-")}`,g=sse(o,u);Object.assign(i,{[f]:g}),xF(a,o,`var(${f})`,h),xF(s,o,`var(${f}, ${g})`,h)}},o=>o[0]==="vars"),{css:i,vars:a,varsWithDefaults:s}}function lse(t,e={}){const{getSelector:r=k,disableCssColorScheme:n,colorSchemeSelector:i,enableContrastVars:a}=e,{colorSchemes:s={},components:o,defaultColorScheme:u="light",...h}=t,{vars:f,css:g,varsWithDefaults:b}=a3(h,e);let v=b;const S={},{[u]:E,...P}=s;if(Object.entries(P||{}).forEach(([M,z])=>{const{vars:B,css:q,varsWithDefaults:W}=a3(z,e);v=Vu(v,W),S[M]={css:q,vars:B}}),E){const{css:M,vars:z,varsWithDefaults:B}=a3(E,e);v=Vu(v,B),S[u]={css:M,vars:z}}function k(M,z){let B=i;if(i==="class"&&(B=".%s"),i==="data"&&(B="[data-%s]"),i?.startsWith("data-")&&!i.includes("%s")&&(B=`[${i}="%s"]`),M){if(B==="media")return t.defaultColorScheme===M?":root":{[`@media (prefers-color-scheme: ${s[M]?.palette?.mode||M})`]:{":root":z}};if(B)return t.defaultColorScheme===M?`:root, ${B.replace("%s",String(M))}`:B.replace("%s",String(M))}return":root"}return{vars:v,generateThemeVars:()=>{let M={...f};return Object.entries(S).forEach(([,{vars:z}])=>{M=Vu(M,z)}),M},generateStyleSheets:()=>{const M=[],z=t.defaultColorScheme||"light";function B(G,ie){Object.keys(ie).length&&M.push(typeof G=="string"?{[G]:{...ie}}:G)}B(r(void 0,{...g}),g);const{[z]:q,...W}=S;if(q){const{css:G}=q,ie=s[z]?.palette?.mode,Q=!n&&ie?{colorScheme:ie,...G}:{...G};B(r(z,{...Q}),Q)}return Object.entries(W).forEach(([G,{css:ie}])=>{const Q=s[G]?.palette?.mode,H=!n&&Q?{colorScheme:Q,...ie}:{...ie};B(r(G,{...H}),H)}),a&&M.push({":root":{"--__l-threshold":"0.7","--__l":"clamp(0, (l / var(--__l-threshold) - 1) * -infinity, 1)","--__a":"clamp(0.87, (l / var(--__l-threshold) - 1) * -infinity, 1)"}}),M}}}function use(t){return function(r){return t==="media"?`@media (prefers-color-scheme: ${r})`:t?t.startsWith("data-")&&!t.includes("%s")?`[${t}="${r}"] &`:t==="class"?`.${r} &`:t==="data"?`[data-${r}] &`:`${t.replace("%s",r)} &`:"&"}}function di(t,e,r=void 0){const n={};for(const i in t){const a=t[i];let s="",o=!0;for(let u=0;u<a.length;u+=1){const h=a[u];h&&(s+=(o===!0?"":" ")+e(h),o=!1,r&&r[h]&&(s+=" "+r[h]))}n[i]=s}return n}function _1(t,e){return ee.isValidElement(t)&&e.indexOf(t.type.muiName??t.type?._payload?.value?.muiName)!==-1}const cse=(t,e)=>t.filter(r=>e.includes(r)),P0=(t,e,r)=>{const n=t.keys[0];Array.isArray(e)?e.forEach((i,a)=>{r((s,o)=>{a<=t.keys.length-1&&(a===0?Object.assign(s,o):s[t.up(t.keys[a])]=o)},i)}):e&&typeof e=="object"?(Object.keys(e).length>t.keys.length?t.keys:cse(t.keys,Object.keys(e))).forEach(a=>{if(t.keys.includes(a)){const s=e[a];s!==void 0&&r((o,u)=>{n===a?Object.assign(o,u):o[t.up(a)]=u},s)}}):(typeof e=="number"||typeof e=="string")&&r((i,a)=>{Object.assign(i,a)},e)};function Hw(t){return`--Grid-${t}Spacing`}function WE(t){return`--Grid-parent-${t}Spacing`}const wF="--Grid-columns",jv="--Grid-parent-columns",hse=({theme:t,ownerState:e})=>{const r={};return P0(t.breakpoints,e.size,(n,i)=>{let a={};i==="grow"&&(a={flexBasis:0,flexGrow:1,maxWidth:"100%"}),i==="auto"&&(a={flexBasis:"auto",flexGrow:0,flexShrink:0,maxWidth:"none",width:"auto"}),typeof i=="number"&&(a={flexGrow:0,flexBasis:"auto",width:`calc(100% * ${i} / var(${jv}) - (var(${jv}) - ${i}) * (var(${WE("column")}) / var(${jv})))`}),n(r,a)}),r},fse=({theme:t,ownerState:e})=>{const r={};return P0(t.breakpoints,e.offset,(n,i)=>{let a={};i==="auto"&&(a={marginLeft:"auto"}),typeof i=="number"&&(a={marginLeft:i===0?"0px":`calc(100% * ${i} / var(${jv}) + var(${WE("column")}) * ${i} / var(${jv}))`}),n(r,a)}),r},dse=({theme:t,ownerState:e})=>{if(!e.container)return{};const r={[wF]:12};return P0(t.breakpoints,e.columns,(n,i)=>{const a=i??12;n(r,{[wF]:a,"> *":{[jv]:a}})}),r},pse=({theme:t,ownerState:e})=>{if(!e.container)return{};const r={};return P0(t.breakpoints,e.rowSpacing,(n,i)=>{const a=typeof i=="string"?i:t.spacing?.(i);n(r,{[Hw("row")]:a,"> *":{[WE("row")]:a}})}),r},gse=({theme:t,ownerState:e})=>{if(!e.container)return{};const r={};return P0(t.breakpoints,e.columnSpacing,(n,i)=>{const a=typeof i=="string"?i:t.spacing?.(i);n(r,{[Hw("column")]:a,"> *":{[WE("column")]:a}})}),r},mse=({theme:t,ownerState:e})=>{if(!e.container)return{};const r={};return P0(t.breakpoints,e.direction,(n,i)=>{n(r,{flexDirection:i})}),r},yse=({ownerState:t})=>({minWidth:0,boxSizing:"border-box",...t.container&&{display:"flex",flexWrap:"wrap",...t.wrap&&t.wrap!=="wrap"&&{flexWrap:t.wrap},gap:`var(${Hw("row")}) var(${Hw("column")})`}}),vse=t=>{const e=[];return Object.entries(t).forEach(([r,n])=>{n!==!1&&n!==void 0&&e.push(`grid-${r}-${String(n)}`)}),e},_se=(t,e="xs")=>{function r(n){return n===void 0?!1:typeof n=="string"&&!Number.isNaN(Number(n))||typeof n=="number"&&n>0}if(r(t))return[`spacing-${e}-${String(t)}`];if(typeof t=="object"&&!Array.isArray(t)){const n=[];return Object.entries(t).forEach(([i,a])=>{r(a)&&n.push(`spacing-${i}-${String(a)}`)}),n}return[]},bse=t=>t===void 0?[]:typeof t=="object"?Object.entries(t).map(([e,r])=>`direction-${e}-${r}`):[`direction-xs-${String(t)}`];function xse(t,e){t.item!==void 0&&delete t.item,t.zeroMinWidth!==void 0&&delete t.zeroMinWidth,e.keys.forEach(r=>{t[r]!==void 0&&delete t[r]})}const wse=UE(),Sse=Fm("div",{name:"MuiGrid",slot:"Root"});function Ese(t){return Roe({props:t,name:"MuiGrid",defaultTheme:wse})}function Tse(t={}){const{createStyledComponent:e=Sse,useThemeProps:r=Ese,useTheme:n=Vb,componentName:i="MuiGrid"}=t,a=(h,f)=>{const{container:g,direction:b,spacing:v,wrap:S,size:E}=h,P={root:["root",g&&"container",S!=="wrap"&&`wrap-xs-${String(S)}`,...bse(b),...vse(E),...g?_se(v,f.breakpoints.keys[0]):[]]};return di(P,k=>fi(i,k),{})};function s(h,f,g=()=>!0){const b={};return h===null||(Array.isArray(h)?h.forEach((v,S)=>{v!==null&&g(v)&&f.keys[S]&&(b[f.keys[S]]=v)}):typeof h=="object"?Object.keys(h).forEach(v=>{const S=h[v];S!=null&&g(S)&&(b[v]=S)}):b[f.keys[0]]=h),b}const o=e(dse,gse,pse,hse,mse,yse,fse),u=ee.forwardRef(function(f,g){const b=n(),v=r(f),S=PR(v);xse(S,b.breakpoints);const{className:E,children:P,columns:k=12,container:L=!1,component:O="div",direction:M="row",wrap:z="wrap",size:B={},offset:q={},spacing:W=0,rowSpacing:G=W,columnSpacing:ie=W,unstable_level:Q=0,...H}=S,ne=s(B,b.breakpoints,ke=>ke!==!1),oe=s(q,b.breakpoints),ce=f.columns??(Q?void 0:k),fe=f.spacing??(Q?void 0:W),Me=f.rowSpacing??f.spacing??(Q?void 0:G),me=f.columnSpacing??f.spacing??(Q?void 0:ie),we={...S,level:Q,columns:ce,container:L,direction:M,wrap:z,spacing:fe,rowSpacing:Me,columnSpacing:me,size:ne,offset:oe},Te=a(we,b);return K.jsx(o,{ref:g,as:O,ownerState:we,className:Sn(Te.root,E),...H,children:ee.Children.map(P,ke=>ee.isValidElement(ke)&&_1(ke,["Grid"])&&L&&ke.props.container?ee.cloneElement(ke,{unstable_level:ke.props?.unstable_level??Q+1}):ke)})});return u.muiName="Grid",u}const X1={black:"#000",white:"#fff"},Cse={50:"#fafafa",100:"#f5f5f5",200:"#eeeeee",300:"#e0e0e0",400:"#bdbdbd",500:"#9e9e9e",600:"#757575",700:"#616161",800:"#424242",900:"#212121",A100:"#f5f5f5",A200:"#eeeeee",A400:"#bdbdbd",A700:"#616161"},Ey={50:"#f3e5f5",200:"#ce93d8",300:"#ba68c8",400:"#ab47bc",500:"#9c27b0",700:"#7b1fa2"},Ty={300:"#e57373",400:"#ef5350",500:"#f44336",700:"#d32f2f",800:"#c62828"},p_={300:"#ffb74d",400:"#ffa726",500:"#ff9800",700:"#f57c00",900:"#e65100"},Cy={50:"#e3f2fd",200:"#90caf9",400:"#42a5f5",700:"#1976d2",800:"#1565c0"},Ay={300:"#4fc3f7",400:"#29b6f6",500:"#03a9f4",700:"#0288d1",900:"#01579b"},Iy={300:"#81c784",400:"#66bb6a",500:"#4caf50",700:"#388e3c",800:"#2e7d32",900:"#1b5e20"};function FW(){return{text:{primary:"rgba(0, 0, 0, 0.87)",secondary:"rgba(0, 0, 0, 0.6)",disabled:"rgba(0, 0, 0, 0.38)"},divider:"rgba(0, 0, 0, 0.12)",background:{paper:X1.white,default:X1.white},action:{active:"rgba(0, 0, 0, 0.54)",hover:"rgba(0, 0, 0, 0.04)",hoverOpacity:.04,selected:"rgba(0, 0, 0, 0.08)",selectedOpacity:.08,disabled:"rgba(0, 0, 0, 0.26)",disabledBackground:"rgba(0, 0, 0, 0.12)",disabledOpacity:.38,focus:"rgba(0, 0, 0, 0.12)",focusOpacity:.12,activatedOpacity:.12}}}const BW=FW();function zW(){return{text:{primary:X1.white,secondary:"rgba(255, 255, 255, 0.7)",disabled:"rgba(255, 255, 255, 0.5)",icon:"rgba(255, 255, 255, 0.5)"},divider:"rgba(255, 255, 255, 0.12)",background:{paper:"#121212",default:"#121212"},action:{active:X1.white,hover:"rgba(255, 255, 255, 0.08)",hoverOpacity:.08,selected:"rgba(255, 255, 255, 0.16)",selectedOpacity:.16,disabled:"rgba(255, 255, 255, 0.3)",disabledBackground:"rgba(255, 255, 255, 0.12)",disabledOpacity:.38,focus:"rgba(255, 255, 255, 0.12)",focusOpacity:.12,activatedOpacity:.24}}}const gP=zW();function SF(t,e,r,n){const i=n.light||n,a=n.dark||n*1.5;t[e]||(t.hasOwnProperty(r)?t[e]=t[r]:e==="light"?t.light=HE(t.main,i):e==="dark"&&(t.dark=qE(t.main,a)))}function EF(t,e,r,n,i){const a=i.light||i,s=i.dark||i*1.5;e[r]||(e.hasOwnProperty(n)?e[r]=e[n]:r==="light"?e.light=`color-mix(in ${t}, ${e.main}, #fff ${(a*100).toFixed(0)}%)`:r==="dark"&&(e.dark=`color-mix(in ${t}, ${e.main}, #000 ${(s*100).toFixed(0)}%)`))}function Ase(t="light"){return t==="dark"?{main:Cy[200],light:Cy[50],dark:Cy[400]}:{main:Cy[700],light:Cy[400],dark:Cy[800]}}function Ise(t="light"){return t==="dark"?{main:Ey[200],light:Ey[50],dark:Ey[400]}:{main:Ey[500],light:Ey[300],dark:Ey[700]}}function Pse(t="light"){return t==="dark"?{main:Ty[500],light:Ty[300],dark:Ty[700]}:{main:Ty[700],light:Ty[400],dark:Ty[800]}}function kse(t="light"){return t==="dark"?{main:Ay[400],light:Ay[300],dark:Ay[700]}:{main:Ay[700],light:Ay[500],dark:Ay[900]}}function Mse(t="light"){return t==="dark"?{main:Iy[400],light:Iy[300],dark:Iy[700]}:{main:Iy[800],light:Iy[500],dark:Iy[900]}}function Rse(t="light"){return t==="dark"?{main:p_[400],light:p_[300],dark:p_[700]}:{main:"#ed6c02",light:p_[500],dark:p_[900]}}function Ose(t){return`oklch(from ${t} var(--__l) 0 h / var(--__a))`}function NR(t){const{mode:e="light",contrastThreshold:r=3,tonalOffset:n=.2,colorSpace:i,...a}=t,s=t.primary||Ase(e),o=t.secondary||Ise(e),u=t.error||Pse(e),h=t.info||kse(e),f=t.success||Mse(e),g=t.warning||Rse(e);function b(P){return i?Ose(P):Boe(P,gP.text.primary)>=r?gP.text.primary:BW.text.primary}const v=({color:P,name:k,mainShade:L=500,lightShade:O=300,darkShade:M=700})=>{if(P={...P},!P.main&&P[L]&&(P.main=P[L]),!P.hasOwnProperty("main"))throw new Error($d(11,k?` (${k})`:"",L));if(typeof P.main!="string")throw new Error($d(12,k?` (${k})`:"",JSON.stringify(P.main)));return i?(EF(i,P,"light",O,n),EF(i,P,"dark",M,n)):(SF(P,"light",O,n),SF(P,"dark",M,n)),P.contrastText||(P.contrastText=b(P.main)),P};let S;return e==="light"?S=FW():e==="dark"&&(S=zW()),Vu({common:{...X1},mode:e,primary:v({color:s,name:"primary"}),secondary:v({color:o,name:"secondary",mainShade:"A400",lightShade:"A200",darkShade:"A700"}),error:v({color:u,name:"error"}),warning:v({color:g,name:"warning"}),info:v({color:h,name:"info"}),success:v({color:f,name:"success"}),grey:Cse,contrastThreshold:r,getContrastText:b,augmentColor:v,tonalOffset:n,...S},a)}function Lse(t){const e={};return Object.entries(t).forEach(n=>{const[i,a]=n;typeof a=="object"&&(e[i]=`${a.fontStyle?`${a.fontStyle} `:""}${a.fontVariant?`${a.fontVariant} `:""}${a.fontWeight?`${a.fontWeight} `:""}${a.fontStretch?`${a.fontStretch} `:""}${a.fontSize||""}${a.lineHeight?`/${a.lineHeight} `:""}${a.fontFamily||""}`)}),e}function Nse(t,e){return{toolbar:{minHeight:56,[t.up("xs")]:{"@media (orientation: landscape)":{minHeight:48}},[t.up("sm")]:{minHeight:64}},...e}}function Dse(t){return Math.round(t*1e5)/1e5}const TF={textTransform:"uppercase"},CF='"Roboto", "Helvetica", "Arial", sans-serif';function jW(t,e){const{fontFamily:r=CF,fontSize:n=14,fontWeightLight:i=300,fontWeightRegular:a=400,fontWeightMedium:s=500,fontWeightBold:o=700,htmlFontSize:u=16,allVariants:h,pxToRem:f,...g}=typeof e=="function"?e(t):e,b=n/14,v=f||(P=>`${P/u*b}rem`),S=(P,k,L,O,M)=>({fontFamily:r,fontWeight:P,fontSize:v(k),lineHeight:L,...r===CF?{letterSpacing:`${Dse(O/k)}em`}:{},...M,...h}),E={h1:S(i,96,1.167,-1.5),h2:S(i,60,1.2,-.5),h3:S(a,48,1.167,0),h4:S(a,34,1.235,.25),h5:S(a,24,1.334,0),h6:S(s,20,1.6,.15),subtitle1:S(a,16,1.75,.15),subtitle2:S(s,14,1.57,.1),body1:S(a,16,1.5,.15),body2:S(a,14,1.43,.15),button:S(s,14,1.75,.4,TF),caption:S(a,12,1.66,.4),overline:S(a,12,2.66,1,TF),inherit:{fontFamily:"inherit",fontWeight:"inherit",fontSize:"inherit",lineHeight:"inherit",letterSpacing:"inherit"}};return Vu({htmlFontSize:u,pxToRem:v,fontFamily:r,fontSize:n,fontWeightLight:i,fontWeightRegular:a,fontWeightMedium:s,fontWeightBold:o,...E},g,{clone:!1})}const Fse=.2,Bse=.14,zse=.12;function ns(...t){return[`${t[0]}px ${t[1]}px ${t[2]}px ${t[3]}px rgba(0,0,0,${Fse})`,`${t[4]}px ${t[5]}px ${t[6]}px ${t[7]}px rgba(0,0,0,${Bse})`,`${t[8]}px ${t[9]}px ${t[10]}px ${t[11]}px rgba(0,0,0,${zse})`].join(",")}const jse=["none",ns(0,2,1,-1,0,1,1,0,0,1,3,0),ns(0,3,1,-2,0,2,2,0,0,1,5,0),ns(0,3,3,-2,0,3,4,0,0,1,8,0),ns(0,2,4,-1,0,4,5,0,0,1,10,0),ns(0,3,5,-1,0,5,8,0,0,1,14,0),ns(0,3,5,-1,0,6,10,0,0,1,18,0),ns(0,4,5,-2,0,7,10,1,0,2,16,1),ns(0,5,5,-3,0,8,10,1,0,3,14,2),ns(0,5,6,-3,0,9,12,1,0,3,16,2),ns(0,6,6,-3,0,10,14,1,0,4,18,3),ns(0,6,7,-4,0,11,15,1,0,4,20,3),ns(0,7,8,-4,0,12,17,2,0,5,22,4),ns(0,7,8,-4,0,13,19,2,0,5,24,4),ns(0,7,9,-4,0,14,21,2,0,5,26,4),ns(0,8,9,-5,0,15,22,2,0,6,28,5),ns(0,8,10,-5,0,16,24,2,0,6,30,5),ns(0,8,11,-5,0,17,26,2,0,6,32,5),ns(0,9,11,-5,0,18,28,2,0,7,34,6),ns(0,9,12,-6,0,19,29,2,0,7,36,6),ns(0,10,13,-6,0,20,31,3,0,8,38,7),ns(0,10,13,-6,0,21,33,3,0,8,40,7),ns(0,10,14,-6,0,22,35,3,0,8,42,7),ns(0,11,14,-7,0,23,36,3,0,9,44,8),ns(0,11,15,-7,0,24,38,3,0,9,46,8)],Use={easeInOut:"cubic-bezier(0.4, 0, 0.2, 1)",easeOut:"cubic-bezier(0.0, 0, 0.2, 1)",easeIn:"cubic-bezier(0.4, 0, 1, 1)",sharp:"cubic-bezier(0.4, 0, 0.6, 1)"},UW={shortest:150,shorter:200,short:250,standard:300,complex:375,enteringScreen:225,leavingScreen:195};function AF(t){return`${Math.round(t)}ms`}function Vse(t){if(!t)return 0;const e=t/36;return Math.min(Math.round((4+15*e**.25+e/5)*10),3e3)}function $se(t){const e={...Use,...t.easing},r={...UW,...t.duration};return{getAutoHeightDuration:Vse,create:(i=["all"],a={})=>{const{duration:s=r.standard,easing:o=e.easeInOut,delay:u=0,...h}=a;return(Array.isArray(i)?i:[i]).map(f=>`${f} ${typeof s=="string"?s:AF(s)} ${o} ${typeof u=="string"?u:AF(u)}`).join(",")},...t,easing:e,duration:r}}const qse={mobileStepper:1e3,fab:1050,speedDial:1050,appBar:1100,drawer:1200,modal:1300,snackbar:1400,tooltip:1500};function Hse(t){return $f(t)||typeof t>"u"||typeof t=="string"||typeof t=="boolean"||typeof t=="number"||Array.isArray(t)}function VW(t={}){const e={...t};function r(n){const i=Object.entries(n);for(let a=0;a<i.length;a++){const[s,o]=i[a];!Hse(o)||s.startsWith("unstable_")?delete n[s]:$f(o)&&(n[s]={...o},r(n[s]))}}return r(e),`import { unstable_createBreakpoints as createBreakpoints, createTransitions } from '@mui/material/styles';

const theme = ${JSON.stringify(e,null,2)};

theme.breakpoints = createBreakpoints(theme.breakpoints || {});
theme.transitions = createTransitions(theme.transitions || {});

export default theme;`}function IF(t){return typeof t=="number"?`${(t*100).toFixed(0)}%`:`calc((${t}) * 100%)`}const Wse=t=>{if(!Number.isNaN(+t))return+t;const e=t.match(/\d*\.?\d+/g);if(!e)return 0;let r=0;for(let n=0;n<e.length;n+=1)r+=+e[n];return r};function Gse(t){Object.assign(t,{alpha(e,r){const n=this||t;return n.colorSpace?`oklch(from ${e} l c h / ${typeof r=="string"?`calc(${r})`:r})`:n.vars?`rgba(${e.replace(/var\(--([^,\s)]+)(?:,[^)]+)?\)+/g,"var(--$1Channel)")} / ${typeof r=="string"?`calc(${r})`:r})`:qw(e,Wse(r))},lighten(e,r){const n=this||t;return n.colorSpace?`color-mix(in ${n.colorSpace}, ${e}, #fff ${IF(r)})`:HE(e,r)},darken(e,r){const n=this||t;return n.colorSpace?`color-mix(in ${n.colorSpace}, ${e}, #000 ${IF(r)})`:qE(e,r)}})}function mP(t={},...e){const{breakpoints:r,mixins:n={},spacing:i,palette:a={},transitions:s={},typography:o={},shape:u,colorSpace:h,...f}=t;if(t.vars&&t.generateThemeVars===void 0)throw new Error($d(20));const g=NR({...a,colorSpace:h}),b=UE(t);let v=Vu(b,{mixins:Nse(b.breakpoints,n),palette:g,shadows:jse.slice(),typography:jW(g,o),transitions:$se(s),zIndex:{...qse}});return v=Vu(v,f),v=e.reduce((S,E)=>Vu(S,E),v),v.unstable_sxConfig={...Ub,...f?.unstable_sxConfig},v.unstable_sx=function(E){return Yp({sx:E,theme:this})},v.toRuntimeSource=VW,Gse(v),v}function yP(t){let e;return t<1?e=5.11916*t**2:e=4.5*Math.log(t+1)+2,Math.round(e*10)/1e3}const Xse=[...Array(25)].map((t,e)=>{if(e===0)return"none";const r=yP(e);return`linear-gradient(rgba(255 255 255 / ${r}), rgba(255 255 255 / ${r}))`});function $W(t){return{inputPlaceholder:t==="dark"?.5:.42,inputUnderline:t==="dark"?.7:.42,switchTrackDisabled:t==="dark"?.2:.12,switchTrack:t==="dark"?.3:.38}}function qW(t){return t==="dark"?Xse:[]}function Yse(t){const{palette:e={mode:"light"},opacity:r,overlays:n,colorSpace:i,...a}=t,s=NR({...e,colorSpace:i});return{palette:s,opacity:{...$W(s.mode),...r},overlays:n||qW(s.mode),...a}}function Zse(t){return!!t[0].match(/(cssVarPrefix|colorSchemeSelector|modularCssLayers|rootSelector|typography|mixins|breakpoints|direction|transitions)/)||!!t[0].match(/sxConfig$/)||t[0]==="palette"&&!!t[1]?.match(/(mode|contrastThreshold|tonalOffset)/)}const Kse=t=>[...[...Array(25)].map((e,r)=>`--${t?`${t}-`:""}overlays-${r}`),`--${t?`${t}-`:""}palette-AppBar-darkBg`,`--${t?`${t}-`:""}palette-AppBar-darkColor`],Jse=t=>(e,r)=>{const n=t.rootSelector||":root",i=t.colorSchemeSelector;let a=i;if(i==="class"&&(a=".%s"),i==="data"&&(a="[data-%s]"),i?.startsWith("data-")&&!i.includes("%s")&&(a=`[${i}="%s"]`),t.defaultColorScheme===e){if(e==="dark"){const s={};return Kse(t.cssVarPrefix).forEach(o=>{s[o]=r[o],delete r[o]}),a==="media"?{[n]:r,"@media (prefers-color-scheme: dark)":{[n]:s}}:a?{[a.replace("%s",e)]:s,[`${n}, ${a.replace("%s",e)}`]:r}:{[n]:{...r,...s}}}if(a&&a!=="media")return`${n}, ${a.replace("%s",String(e))}`}else if(e){if(a==="media")return{[`@media (prefers-color-scheme: ${String(e)})`]:{[n]:r}};if(a)return a.replace("%s",String(e))}return n};function Qse(t,e){e.forEach(r=>{t[r]||(t[r]={})})}function Br(t,e,r){!t[e]&&r&&(t[e]=r)}function W_(t){return typeof t!="string"||!t.startsWith("hsl")?t:MW(t)}function xd(t,e){`${e}Channel`in t||(t[`${e}Channel`]=H_(W_(t[e])))}function ele(t){return typeof t=="number"?`${t}px`:typeof t=="string"||typeof t=="function"||Array.isArray(t)?t:"8px"}const Of=t=>{try{return t()}catch{}},tle=(t="mui")=>ase(t);function o3(t,e,r,n,i){if(!r)return;r=r===!0?{}:r;const a=i==="dark"?"dark":"light";if(!n){e[i]=Yse({...r,palette:{mode:a,...r?.palette},colorSpace:t});return}const{palette:s,...o}=mP({...n,palette:{mode:a,...r?.palette},colorSpace:t});return e[i]={...r,palette:s,opacity:{...$W(a),...r?.opacity},overlays:r?.overlays||qW(a)},o}function rle(t={},...e){const{colorSchemes:r={light:!0},defaultColorScheme:n,disableCssColorScheme:i=!1,cssVarPrefix:a="mui",nativeColor:s=!1,shouldSkipGeneratingVar:o=Zse,colorSchemeSelector:u=r.light&&r.dark?"media":void 0,rootSelector:h=":root",...f}=t,g=Object.keys(r)[0],b=n||(r.light&&g!=="light"?"light":g),v=tle(a),{[b]:S,light:E,dark:P,...k}=r,L={...k};let O=S;if((b==="dark"&&!("dark"in r)||b==="light"&&!("light"in r))&&(O=!0),!O)throw new Error($d(21,b));let M;s&&(M="oklch");const z=o3(M,L,O,f,b);E&&!L.light&&o3(M,L,E,void 0,"light"),P&&!L.dark&&o3(M,L,P,void 0,"dark");let B={defaultColorScheme:b,...z,cssVarPrefix:a,colorSchemeSelector:u,rootSelector:h,getCssVar:v,colorSchemes:L,font:{...Lse(z.typography),...z.font},spacing:ele(f.spacing)};Object.keys(B.colorSchemes).forEach(Q=>{const H=B.colorSchemes[Q].palette,ne=ce=>{const fe=ce.split("-"),Me=fe[1],me=fe[2];return v(ce,H[Me][me])};H.mode==="light"&&(Br(H.common,"background","#fff"),Br(H.common,"onBackground","#000")),H.mode==="dark"&&(Br(H.common,"background","#000"),Br(H.common,"onBackground","#fff"));function oe(ce,fe,Me){if(M){let me;return ce===kg&&(me=`transparent ${((1-Me)*100).toFixed(0)}%`),ce===no&&(me=`#000 ${(Me*100).toFixed(0)}%`),ce===io&&(me=`#fff ${(Me*100).toFixed(0)}%`),`color-mix(in ${M}, ${fe}, ${me})`}return ce(fe,Me)}if(Qse(H,["Alert","AppBar","Avatar","Button","Chip","FilledInput","LinearProgress","Skeleton","Slider","SnackbarContent","SpeedDialAction","StepConnector","StepContent","Switch","TableCell","Tooltip"]),H.mode==="light"){Br(H.Alert,"errorColor",oe(no,H.error.light,.6)),Br(H.Alert,"infoColor",oe(no,H.info.light,.6)),Br(H.Alert,"successColor",oe(no,H.success.light,.6)),Br(H.Alert,"warningColor",oe(no,H.warning.light,.6)),Br(H.Alert,"errorFilledBg",ne("palette-error-main")),Br(H.Alert,"infoFilledBg",ne("palette-info-main")),Br(H.Alert,"successFilledBg",ne("palette-success-main")),Br(H.Alert,"warningFilledBg",ne("palette-warning-main")),Br(H.Alert,"errorFilledColor",Of(()=>H.getContrastText(H.error.main))),Br(H.Alert,"infoFilledColor",Of(()=>H.getContrastText(H.info.main))),Br(H.Alert,"successFilledColor",Of(()=>H.getContrastText(H.success.main))),Br(H.Alert,"warningFilledColor",Of(()=>H.getContrastText(H.warning.main))),Br(H.Alert,"errorStandardBg",oe(io,H.error.light,.9)),Br(H.Alert,"infoStandardBg",oe(io,H.info.light,.9)),Br(H.Alert,"successStandardBg",oe(io,H.success.light,.9)),Br(H.Alert,"warningStandardBg",oe(io,H.warning.light,.9)),Br(H.Alert,"errorIconColor",ne("palette-error-main")),Br(H.Alert,"infoIconColor",ne("palette-info-main")),Br(H.Alert,"successIconColor",ne("palette-success-main")),Br(H.Alert,"warningIconColor",ne("palette-warning-main")),Br(H.AppBar,"defaultBg",ne("palette-grey-100")),Br(H.Avatar,"defaultBg",ne("palette-grey-400")),Br(H.Button,"inheritContainedBg",ne("palette-grey-300")),Br(H.Button,"inheritContainedHoverBg",ne("palette-grey-A100")),Br(H.Chip,"defaultBorder",ne("palette-grey-400")),Br(H.Chip,"defaultAvatarColor",ne("palette-grey-700")),Br(H.Chip,"defaultIconColor",ne("palette-grey-700")),Br(H.FilledInput,"bg","rgba(0, 0, 0, 0.06)"),Br(H.FilledInput,"hoverBg","rgba(0, 0, 0, 0.09)"),Br(H.FilledInput,"disabledBg","rgba(0, 0, 0, 0.12)"),Br(H.LinearProgress,"primaryBg",oe(io,H.primary.main,.62)),Br(H.LinearProgress,"secondaryBg",oe(io,H.secondary.main,.62)),Br(H.LinearProgress,"errorBg",oe(io,H.error.main,.62)),Br(H.LinearProgress,"infoBg",oe(io,H.info.main,.62)),Br(H.LinearProgress,"successBg",oe(io,H.success.main,.62)),Br(H.LinearProgress,"warningBg",oe(io,H.warning.main,.62)),Br(H.Skeleton,"bg",M?oe(kg,H.text.primary,.11):`rgba(${ne("palette-text-primaryChannel")} / 0.11)`),Br(H.Slider,"primaryTrack",oe(io,H.primary.main,.62)),Br(H.Slider,"secondaryTrack",oe(io,H.secondary.main,.62)),Br(H.Slider,"errorTrack",oe(io,H.error.main,.62)),Br(H.Slider,"infoTrack",oe(io,H.info.main,.62)),Br(H.Slider,"successTrack",oe(io,H.success.main,.62)),Br(H.Slider,"warningTrack",oe(io,H.warning.main,.62));const ce=M?oe(no,H.background.default,.6825):zx(H.background.default,.8);Br(H.SnackbarContent,"bg",ce),Br(H.SnackbarContent,"color",Of(()=>M?gP.text.primary:H.getContrastText(ce))),Br(H.SpeedDialAction,"fabHoverBg",zx(H.background.paper,.15)),Br(H.StepConnector,"border",ne("palette-grey-400")),Br(H.StepContent,"border",ne("palette-grey-400")),Br(H.Switch,"defaultColor",ne("palette-common-white")),Br(H.Switch,"defaultDisabledColor",ne("palette-grey-100")),Br(H.Switch,"primaryDisabledColor",oe(io,H.primary.main,.62)),Br(H.Switch,"secondaryDisabledColor",oe(io,H.secondary.main,.62)),Br(H.Switch,"errorDisabledColor",oe(io,H.error.main,.62)),Br(H.Switch,"infoDisabledColor",oe(io,H.info.main,.62)),Br(H.Switch,"successDisabledColor",oe(io,H.success.main,.62)),Br(H.Switch,"warningDisabledColor",oe(io,H.warning.main,.62)),Br(H.TableCell,"border",oe(io,oe(kg,H.divider,1),.88)),Br(H.Tooltip,"bg",oe(kg,H.grey[700],.92))}if(H.mode==="dark"){Br(H.Alert,"errorColor",oe(io,H.error.light,.6)),Br(H.Alert,"infoColor",oe(io,H.info.light,.6)),Br(H.Alert,"successColor",oe(io,H.success.light,.6)),Br(H.Alert,"warningColor",oe(io,H.warning.light,.6)),Br(H.Alert,"errorFilledBg",ne("palette-error-dark")),Br(H.Alert,"infoFilledBg",ne("palette-info-dark")),Br(H.Alert,"successFilledBg",ne("palette-success-dark")),Br(H.Alert,"warningFilledBg",ne("palette-warning-dark")),Br(H.Alert,"errorFilledColor",Of(()=>H.getContrastText(H.error.dark))),Br(H.Alert,"infoFilledColor",Of(()=>H.getContrastText(H.info.dark))),Br(H.Alert,"successFilledColor",Of(()=>H.getContrastText(H.success.dark))),Br(H.Alert,"warningFilledColor",Of(()=>H.getContrastText(H.warning.dark))),Br(H.Alert,"errorStandardBg",oe(no,H.error.light,.9)),Br(H.Alert,"infoStandardBg",oe(no,H.info.light,.9)),Br(H.Alert,"successStandardBg",oe(no,H.success.light,.9)),Br(H.Alert,"warningStandardBg",oe(no,H.warning.light,.9)),Br(H.Alert,"errorIconColor",ne("palette-error-main")),Br(H.Alert,"infoIconColor",ne("palette-info-main")),Br(H.Alert,"successIconColor",ne("palette-success-main")),Br(H.Alert,"warningIconColor",ne("palette-warning-main")),Br(H.AppBar,"defaultBg",ne("palette-grey-900")),Br(H.AppBar,"darkBg",ne("palette-background-paper")),Br(H.AppBar,"darkColor",ne("palette-text-primary")),Br(H.Avatar,"defaultBg",ne("palette-grey-600")),Br(H.Button,"inheritContainedBg",ne("palette-grey-800")),Br(H.Button,"inheritContainedHoverBg",ne("palette-grey-700")),Br(H.Chip,"defaultBorder",ne("palette-grey-700")),Br(H.Chip,"defaultAvatarColor",ne("palette-grey-300")),Br(H.Chip,"defaultIconColor",ne("palette-grey-300")),Br(H.FilledInput,"bg","rgba(255, 255, 255, 0.09)"),Br(H.FilledInput,"hoverBg","rgba(255, 255, 255, 0.13)"),Br(H.FilledInput,"disabledBg","rgba(255, 255, 255, 0.12)"),Br(H.LinearProgress,"primaryBg",oe(no,H.primary.main,.5)),Br(H.LinearProgress,"secondaryBg",oe(no,H.secondary.main,.5)),Br(H.LinearProgress,"errorBg",oe(no,H.error.main,.5)),Br(H.LinearProgress,"infoBg",oe(no,H.info.main,.5)),Br(H.LinearProgress,"successBg",oe(no,H.success.main,.5)),Br(H.LinearProgress,"warningBg",oe(no,H.warning.main,.5)),Br(H.Skeleton,"bg",M?oe(kg,H.text.primary,.13):`rgba(${ne("palette-text-primaryChannel")} / 0.13)`),Br(H.Slider,"primaryTrack",oe(no,H.primary.main,.5)),Br(H.Slider,"secondaryTrack",oe(no,H.secondary.main,.5)),Br(H.Slider,"errorTrack",oe(no,H.error.main,.5)),Br(H.Slider,"infoTrack",oe(no,H.info.main,.5)),Br(H.Slider,"successTrack",oe(no,H.success.main,.5)),Br(H.Slider,"warningTrack",oe(no,H.warning.main,.5));const ce=M?oe(io,H.background.default,.985):zx(H.background.default,.98);Br(H.SnackbarContent,"bg",ce),Br(H.SnackbarContent,"color",Of(()=>M?BW.text.primary:H.getContrastText(ce))),Br(H.SpeedDialAction,"fabHoverBg",zx(H.background.paper,.15)),Br(H.StepConnector,"border",ne("palette-grey-600")),Br(H.StepContent,"border",ne("palette-grey-600")),Br(H.Switch,"defaultColor",ne("palette-grey-300")),Br(H.Switch,"defaultDisabledColor",ne("palette-grey-600")),Br(H.Switch,"primaryDisabledColor",oe(no,H.primary.main,.55)),Br(H.Switch,"secondaryDisabledColor",oe(no,H.secondary.main,.55)),Br(H.Switch,"errorDisabledColor",oe(no,H.error.main,.55)),Br(H.Switch,"infoDisabledColor",oe(no,H.info.main,.55)),Br(H.Switch,"successDisabledColor",oe(no,H.success.main,.55)),Br(H.Switch,"warningDisabledColor",oe(no,H.warning.main,.55)),Br(H.TableCell,"border",oe(no,oe(kg,H.divider,1),.68)),Br(H.Tooltip,"bg",oe(kg,H.grey[700],.92))}xd(H.background,"default"),xd(H.background,"paper"),xd(H.common,"background"),xd(H.common,"onBackground"),xd(H,"divider"),Object.keys(H).forEach(ce=>{const fe=H[ce];ce!=="tonalOffset"&&fe&&typeof fe=="object"&&(fe.main&&Br(H[ce],"mainChannel",H_(W_(fe.main))),fe.light&&Br(H[ce],"lightChannel",H_(W_(fe.light))),fe.dark&&Br(H[ce],"darkChannel",H_(W_(fe.dark))),fe.contrastText&&Br(H[ce],"contrastTextChannel",H_(W_(fe.contrastText))),ce==="text"&&(xd(H[ce],"primary"),xd(H[ce],"secondary")),ce==="action"&&(fe.active&&xd(H[ce],"active"),fe.selected&&xd(H[ce],"selected")))})}),B=e.reduce((Q,H)=>Vu(Q,H),B);const q={prefix:a,disableCssColorScheme:i,shouldSkipGeneratingVar:o,getSelector:Jse(B),enableContrastVars:s},{vars:W,generateThemeVars:G,generateStyleSheets:ie}=lse(B,q);return B.vars=W,Object.entries(B.colorSchemes[B.defaultColorScheme]).forEach(([Q,H])=>{B[Q]=H}),B.generateThemeVars=G,B.generateStyleSheets=ie,B.generateSpacing=function(){return xW(f.spacing,AR(this))},B.getColorSchemeSelector=use(u),B.spacing=B.generateSpacing(),B.shouldSkipGeneratingVar=o,B.unstable_sxConfig={...Ub,...f?.unstable_sxConfig},B.unstable_sx=function(H){return Yp({sx:H,theme:this})},B.toRuntimeSource=VW,B}function PF(t,e,r){t.colorSchemes&&r&&(t.colorSchemes[e]={...r!==!0&&r,palette:NR({...r===!0?{}:r.palette,mode:e})})}function k0(t={},...e){const{palette:r,cssVariables:n=!1,colorSchemes:i=r?void 0:{light:!0},defaultColorScheme:a=r?.mode,...s}=t,o=a||"light",u=i?.[o],h={...i,...r?{[o]:{...typeof u!="boolean"&&u,palette:r}}:void 0};if(n===!1){if(!("colorSchemes"in t))return mP(t,...e);let f=r;"palette"in t||h[o]&&(h[o]!==!0?f=h[o].palette:o==="dark"&&(f={mode:"dark"}));const g=mP({...t,palette:f},...e);return g.defaultColorScheme=o,g.colorSchemes=h,g.palette.mode==="light"&&(g.colorSchemes.light={...h.light!==!0&&h.light,palette:g.palette},PF(g,"dark",h.dark)),g.palette.mode==="dark"&&(g.colorSchemes.dark={...h.dark!==!0&&h.dark,palette:g.palette},PF(g,"light",h.light)),g}return!r&&!("light"in h)&&o==="light"&&(h.light=!0),rle({...s,colorSchemes:h,defaultColorScheme:o,...typeof n!="boolean"&&n},...e)}const DR=k0();function Tc(){const t=Vb(DR);return t[nf]||t}function GE(t){return t!=="ownerState"&&t!=="theme"&&t!=="sx"&&t!=="as"}const yl=t=>GE(t)&&t!=="classes",Pr=AW({themeId:nf,defaultTheme:DR,rootShouldForwardProp:yl});function nle({theme:t,...e}){const r=nf in t?t[nf]:void 0;return K.jsx(NW,{...e,themeId:r?nf:void 0,theme:r||t})}const jx={colorSchemeStorageKey:"mui-color-scheme",defaultLightColorScheme:"light",defaultDarkColorScheme:"dark",modeStorageKey:"mui-mode"},{CssVarsProvider:ile}=ise({themeId:nf,theme:()=>k0({cssVariables:!0}),colorSchemeStorageKey:jx.colorSchemeStorageKey,modeStorageKey:jx.modeStorageKey,defaultColorScheme:{light:jx.defaultLightColorScheme,dark:jx.defaultDarkColorScheme},resolveTheme:t=>{const e={...t,typography:jW(t.palette,t.typography)};return e.unstable_sx=function(n){return Yp({sx:n,theme:this})},e}}),ale=ile;function HW({theme:t,...e}){const r=ee.useMemo(()=>{if(typeof t=="function")return t;const n=nf in t?t[nf]:t;return"colorSchemes"in n?null:"vars"in n?t:{...t,vars:null}},[t]);return r?K.jsx(nle,{theme:r,...e}):K.jsx(ale,{theme:t,...e})}const ole=k0({palette:{mode:"light"}}),sle=k0({palette:{mode:"dark"}}),lle=t=>({...t==="light"?ole:sle,palette:{mode:t,...t==="dark"?{primary:{main:"#009EE0"},secondary:{main:"#747577"},background:{paper:"#313131"},text:{primary:"#FFF",contrast:"#000"},topToolbar:{barColor:"#000"},navigation:{buttonColor:"#fff",navColor:"#313131",navHover:"#747577"},GPS:{GPSActiveColor:"#fff",GPSInactiveColor:"#fff",GPSActiveBackgroundColor:"#747577"},compass:{compColor:"#313131",compHover:"#747577",compStroke:"#d3dce1",compNorth:"#cf003f",compSouth:"#d3dcf0"}}:{primary:{main:"#009EE0"},secondary:{main:"#747577"},text:{primary:"#000",contrast:"#fff"},topToolbar:{barColor:"#fff"},navigation:{buttonColor:"#747577",navColor:"#fff",navHover:"#f5f5f5"},GPS:{GPSActiveColor:"#009EE0",GPSInactiveColor:"#747577",GPSActiveBackgroundColor:"#fff"},compass:{compColor:"#fff",compHover:"#f5f5f5",compStroke:"#009ee0",compNorth:"#cf003f",compSouth:"#d3dcf0"}}}}),WW=t=>{const e=lle(t&&["light","dark"].includes(t)?t:"light");return k0(e,{components:{MuiTypography:{styleOverrides:{root:{}}},MuiAppBar:{styleOverrides:{root:{backgroundColor:e.palette.topToolbar.barColor}}},MuiButton:{variants:[{props:{variant:"navtools"},style:{minWidth:"20px",minHeight:"20px",fontWeight:600,[e.breakpoints.down("md")]:{width:"50px",height:"50px",fontSize:"1.4em"},[e.breakpoints.up("md")]:{width:"30px",height:"30px",fontSize:"1.2em"},color:e.palette.text.primary,backgroundColor:e.palette.navigation.navColor,borderRadius:"23%",margin:"0.15px",marginTop:"4px",":hover":{backgroundColor:e.palette.navigation.navHover}}}]},MuiListItemText:{styleOverrides:{primary:({ownerState:r})=>r?.variant==="layerlist"?{fontSize:"0.9rem"}:{},secondary:({ownerState:r})=>r?.variant==="layerlist"?{fontSize:"0.7rem"}:{}}}}})};try{MapcomponentsTheme.displayName="MapcomponentsTheme",MapcomponentsTheme.__docgenInfo={description:"",displayName:"MapcomponentsTheme",props:{}}}catch{}const $u={source_openmaptiles_url:"https://wms.wheregroup.com/tileserver/tile/world-0-14.json",sprite:"https://wms.wheregroup.com/tileserver/sprites/osm-bright",glyphs:"https://wms.wheregroup.com/tileserver/fonts/{fontstack}/{range}.pbf",sourceOptions_tiles:["https://wms.wheregroup.com/tileserver/tile/world-0-14/{z}/{x}/{y}.pbf"]},fu=[];for(let t=0;t<256;++t)fu.push((t+256).toString(16).slice(1));function ule(t,e=0){return(fu[t[e+0]]+fu[t[e+1]]+fu[t[e+2]]+fu[t[e+3]]+"-"+fu[t[e+4]]+fu[t[e+5]]+"-"+fu[t[e+6]]+fu[t[e+7]]+"-"+fu[t[e+8]]+fu[t[e+9]]+"-"+fu[t[e+10]]+fu[t[e+11]]+fu[t[e+12]]+fu[t[e+13]]+fu[t[e+14]]+fu[t[e+15]]).toLowerCase()}let s3;const cle=new Uint8Array(16);function hle(){if(!s3){if(typeof crypto>"u"||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");s3=crypto.getRandomValues.bind(crypto)}return s3(cle)}const fle=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),kF={randomUUID:fle};function _c(t,e,r){if(kF.randomUUID&&!t)return kF.randomUUID();t=t||{};const n=t.random??t.rng?.()??hle();if(n.length<16)throw new Error("Random bytes length must be >= 16");return n[6]=n[6]&15|64,n[8]=n[8]&63|128,ule(n)}const FR=ht.createContext({});function vP(t){const[e,r]=ht.useState([]),[n,i]=ht.useState([]),[a,s]=ht.useState([]),[o,u]=ht.useState($u.sourceOptions_tiles[0]),h=ee.useMemo(()=>({layerId:"openmaptiles",sourceOptions:{type:"vector",tiles:[o]}}),[o]),f=E=>{if(!E)return;const P=[],k=[];E.layers.forEach((L,O)=>{L.type==="symbol"?k.push(L):(O===0&&(L.id=E.name||"background"),P.push(L))}),i(P),s(k)};ee.useEffect(()=>{if(e.filter(E=>!E?.id).length){const E=[...e];E.forEach(P=>{P?.id||(P.id=_c())}),r(E)}},[e]);const g=ee.useCallback((E,P)=>{const k=e?.filter?.(L=>L.id===E);if(k.length>0){const L=[...e],O=k[0],M=e.indexOf(O),z=P(M);z>=0&&z<=e.length-1&&(L.splice(M,1),L.splice(z,0,O),r(L))}},[e]),b=ee.useCallback(E=>{g(E,P=>P+1)},[g]),v=ee.useCallback(E=>{g(E,P=>P-1)},[g]),S={layers:e,setLayers:r,backgroundLayers:n,setBackgroundLayers:i,symbolLayers:a,setSymbolLayers:s,updateStyle:f,vtLayerConfig:h,tileUrl:o,setTileUrl:u,moveUp:v,moveDown:b,moveLayer:g};return K.jsx(FR.Provider,{value:S,children:t.children})}try{vP.displayName="LayerContextProvider",vP.__docgenInfo={description:"",displayName:"LayerContextProvider",props:{}}}catch{}const og=ht.createContext({}),_P=({children:t})=>{const[e,r]=ee.useState(void 0),[n,i]=ee.useState([]),a=ee.useRef([]),s=ee.useRef({}),o=f=>{if(f){typeof s.current[f]<"u"&&delete s.current[f];const g=a.current.indexOf(f);g>-1&&a.current.splice(g,1),i([...a.current]),a.current.length===0&&e&&r(void 0)}else o("anonymous_map")},h={map:e,setMap:f=>{if(r(f),n.length===0){const g="anonymous_map";i([...n,g]),s.current[g]=f}},maps:s.current,mapIds:n,registerMap:(f,g)=>{f&&g&&(s.current[f]=g,a.current.push(f),i([...a.current]),(!e||e?.cancelled===!0)&&r(g))},removeMap:o,mapExists:f=>f&&Object.keys(s.current).indexOf(f)===-1?!1:!(!f&&!e),getMap:f=>f&&n.indexOf(f)!==-1?s.current[f]:!f&&e?e:null};return K.jsx(og.Provider,{value:h,children:K.jsx(vP,{children:K.jsx(HW,{theme:WW("light"),children:t})})})};try{_P.displayName="MapComponentsProvider",_P.__docgenInfo={description:`MapComponentsProvider must be imported and wrapped around component where at least one of its child nodes requires access to a MapLibre-gl or openlayers instance that is registered in this mapContext.
MapComponentsProvider must be used one level higher than the first use of MapContext.

MapComponentsProvider requires at least one use of the MapLibreMap component somewhere down the component tree that will create the MapLibre-gl object and set the reference at MapContext.map. For MapLibre maps it is a good idea to provide a mapId attribute to the MapLibreMap Component even if you are only using a single map instance at start. It will make a later transition to using multiple instances within the same project much easier.`,displayName:"MapComponentsProvider",props:{}}}catch{}const GW={mapId:void 0,options:{center:{lng:8.607,lat:53.1409349},zoom:11,container:"",style:{version:8,name:"blank",center:[0,0],zoom:0,sources:{},sprite:"https://wms.wheregroup.com/tileserver/sprites/osm-bright",glyphs:"https://wms.wheregroup.com/tileserver/fonts/{fontstack}/{range}.pbf",layers:[{id:"_background",type:"background",paint:{"background-color":"rgba(0,0,0,0)"}}]}}},XW=t=>{const e=ee.useRef(null),r=ee.useRef(null),n=ee.useContext(og),i=ee.useRef(t.mapId),a=ee.useRef(!1),s=ee.useRef(t.options?.style);return ee.useEffect(()=>{const o=i.current;return()=>{a.current=!1,n.removeMap(o),e.current&&(e.current.map?.remove?.(),e.current.cancelled=!0,e.current=null)}},[]),ee.useEffect(()=>{a.current||r.current&&(a.current=!0,t?.options?.style&&(s.current=JSON.stringify(t.options.style)),e.current=new bie({mapOptions:{style:"",...t.options,...t?.options?.style?{}:{style:GW?.options?.style},container:r.current},onReady:(o,u)=>{o.once("load",()=>{u?.cancelled?o.remove():(window._map=o,t.mapId?n.registerMap(t.mapId,u):n.setMap(u))})}}))},[t.options,t.mapId]),ee.useEffect(()=>{if(e.current?.map&&t?.options?.style){const o=JSON.stringify(t.options.style);s.current!==o&&(s.current=o,e.current.map.setStyle(t.options.style))}},[t?.options?.style]),K.jsx("div",{ref:r,className:"mapContainer",style:t.style})};XW.defaultProps=GW;function XE(t){const e=ee.useContext(og),r=ee.useRef(!1),n=ee.useRef(null),[i,a]=ee.useState(),s=ee.useRef(void 0),[o,u]=ee.useState([]),h=ee.useRef(""),f=ee.useRef(_c()),g=ee.useCallback(v=>!t?.filter?.includeBaseLayers&&v?.baseLayer?!1:typeof t.filter?.matchLayerIds<"u"?t.filter.matchLayerIds instanceof RegExp?t.filter.matchLayerIds.test(v.id):v.id.includes(t.filter.matchLayerIds):!0,[t.filter]),b=ee.useCallback(()=>{if(!n.current)return;const v=n.current.wrapper.layerState.filter(g),S=JSON.stringify(v);h.current!==S&&(h.current=S,u(v))},[g]);return ee.useEffect(()=>{const v=f.current;return()=>{n.current&&(n.current.cleanup(v),n.current=null),r.current=!1}},[]),ee.useEffect(()=>{if(!(!e.mapExists(t.mapId)||r.current)){if(r.current=!0,n.current=e.getMap(t.mapId),!n.current){r.current=!1;return}t?.watch?.viewport&&(a(n.current.wrapper.viewportState),n.current.wrapper.on("viewportchange",()=>{s.current!==n.current?.wrapper.viewportStateString&&a(n.current?.wrapper.viewportState)},f.current)),t?.watch?.layers&&(b(),n.current.wrapper.on("layerchange",b,{includeBaseLayers:t?.filter?.includeBaseLayers,matchLayerIds:t?.filter?.matchLayerIds},f.current))}},[e.mapIds,e,t.mapId,b,t]),{layers:o,viewport:i}}XE.defaultProps={mapId:void 0,watch:{layers:!0,sources:!1,viewport:!1},filter:{includeBaseLayers:!1}};function ha(t){const e=ee.useContext(og),[r,n]=ee.useState({map:void 0,ready:!1}),i=XE({mapId:t?.mapId,watch:{viewport:!1,layers:!!t?.waitForLayer,sources:!1},filter:{includeBaseLayers:!0}}),a=ee.useRef(null),s=ee.useRef(_c()),o=()=>{a.current&&a.current.cleanup(s.current)};return ee.useEffect(()=>()=>{o(),a.current=null},[]),ee.useEffect(()=>{if(a.current&&a.current.cancelled===!0&&(a.current=null,n({map:void 0,ready:!1})),!(a.current||!e.mapExists(t?.mapId))){if(t?.waitForLayer){let u=!1;if(i?.layers?.forEach(h=>{h.id===t?.waitForLayer&&(u=!0)}),!u)return}a.current=e.getMap(t?.mapId),n({map:a.current,ready:!0})}},[e.mapIds,i.layers,e,t]),{map:r.map,mapIsReady:r.ready,componentId:s.current,layers:i.layers,cleanup:o}}function bP(...t){return t.reduce((e,r)=>r==null?e:function(...i){e.apply(this,i),r.apply(this,i)},()=>{})}function dle(t){return K.jsx(wW,{...t,defaultTheme:DR,themeId:nf})}function ple(t){return function(r){return K.jsx(dle,{styles:typeof t=="function"?n=>t({theme:n,...r}):t})}}function gle(){return PR}const si=Zoe;function _i(t){return Woe(t)}function mle(t){return fi("MuiSvgIcon",t)}ui("MuiSvgIcon",["root","colorPrimary","colorSecondary","colorAction","colorError","colorDisabled","fontSizeInherit","fontSizeSmall","fontSizeMedium","fontSizeLarge"]);const yle=t=>{const{color:e,fontSize:r,classes:n}=t,i={root:["root",e!=="inherit"&&`color${on(e)}`,`fontSize${on(r)}`]};return di(i,mle,n)},vle=Pr("svg",{name:"MuiSvgIcon",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.root,r.color!=="inherit"&&e[`color${on(r.color)}`],e[`fontSize${on(r.fontSize)}`]]}})(si(({theme:t})=>({userSelect:"none",width:"1em",height:"1em",display:"inline-block",flexShrink:0,transition:t.transitions?.create?.("fill",{duration:(t.vars??t).transitions?.duration?.shorter}),variants:[{props:e=>!e.hasSvgAsChild,style:{fill:"currentColor"}},{props:{fontSize:"inherit"},style:{fontSize:"inherit"}},{props:{fontSize:"small"},style:{fontSize:t.typography?.pxToRem?.(20)||"1.25rem"}},{props:{fontSize:"medium"},style:{fontSize:t.typography?.pxToRem?.(24)||"1.5rem"}},{props:{fontSize:"large"},style:{fontSize:t.typography?.pxToRem?.(35)||"2.1875rem"}},...Object.entries((t.vars??t).palette).filter(([,e])=>e&&e.main).map(([e])=>({props:{color:e},style:{color:(t.vars??t).palette?.[e]?.main}})),{props:{color:"action"},style:{color:(t.vars??t).palette?.action?.active}},{props:{color:"disabled"},style:{color:(t.vars??t).palette?.action?.disabled}},{props:{color:"inherit"},style:{color:void 0}}]}))),xP=ee.forwardRef(function(e,r){const n=_i({props:e,name:"MuiSvgIcon"}),{children:i,className:a,color:s="inherit",component:o="svg",fontSize:u="medium",htmlColor:h,inheritViewBox:f=!1,titleAccess:g,viewBox:b="0 0 24 24",...v}=n,S=ee.isValidElement(i)&&i.type==="svg",E={...n,color:s,component:o,fontSize:u,instanceFontSize:e.fontSize,inheritViewBox:f,viewBox:b,hasSvgAsChild:S},P={};f||(P.viewBox=b);const k=yle(E);return K.jsxs(vle,{as:o,className:Sn(k.root,a),focusable:"false",color:h,"aria-hidden":g?void 0:!0,role:g?"img":void 0,ref:r,...P,...v,...S&&i.props,ownerState:E,children:[S?i.props.children:i,g?K.jsx("title",{children:g}):null]})});xP.muiName="SvgIcon";function Hi(t,e){function r(n,i){return K.jsx(xP,{"data-testid":void 0,ref:i,...n,children:t})}return r.muiName=xP.muiName,ee.memo(ee.forwardRef(r))}function BR(t,e=166){let r;function n(...i){const a=()=>{t.apply(this,i)};clearTimeout(r),r=setTimeout(a,e)}return n.clear=()=>{clearTimeout(r)},n}function os(t){return t&&t.ownerDocument||document}function sc(t){return os(t).defaultView||window}function MF(t,e){typeof t=="function"?t(e):t&&(t.current=e)}function pm(t){const{controlled:e,default:r,name:n,state:i="value"}=t,{current:a}=ee.useRef(e!==void 0),[s,o]=ee.useState(r),u=a?e:s,h=ee.useCallback(f=>{a||o(f)},[]);return[u,h]}function Ql(t){const e=ee.useRef(t);return yu(()=>{e.current=t}),ee.useRef((...r)=>(0,e.current)(...r)).current}function Lo(...t){const e=ee.useRef(void 0),r=ee.useCallback(n=>{const i=t.map(a=>{if(a==null)return null;if(typeof a=="function"){const s=a,o=s(n);return typeof o=="function"?o:()=>{s(null)}}return a.current=n,()=>{a.current=null}});return()=>{i.forEach(a=>a?.())}},t);return ee.useMemo(()=>t.every(n=>n==null)?null:n=>{e.current&&(e.current(),e.current=void 0),n!=null&&(e.current=r(n))},t)}function _le(t,e){const r=t.charCodeAt(2);return t[0]==="o"&&t[1]==="n"&&r>=65&&r<=90&&typeof e=="function"}function Y1(t,e){if(!t)return e;function r(s,o){const u={};return Object.keys(o).forEach(h=>{_le(h,o[h])&&typeof s[h]=="function"&&(u[h]=(...f)=>{s[h](...f),o[h](...f)})}),u}if(typeof t=="function"||typeof e=="function")return s=>{const o=typeof e=="function"?e(s):e,u=typeof t=="function"?t({...s,...o}):t,h=Sn(s?.className,o?.className,u?.className),f=r(u,o);return{...o,...u,...f,...!!h&&{className:h},...o?.style&&u?.style&&{style:{...o.style,...u.style}},...o?.sx&&u?.sx&&{sx:[...Array.isArray(o.sx)?o.sx:[o.sx],...Array.isArray(u.sx)?u.sx:[u.sx]]}}};const n=e,i=r(t,n),a=Sn(n?.className,t?.className);return{...e,...t,...i,...!!a&&{className:a},...n?.style&&t?.style&&{style:{...n.style,...t.style}},...n?.sx&&t?.sx&&{sx:[...Array.isArray(n.sx)?n.sx:[n.sx],...Array.isArray(t.sx)?t.sx:[t.sx]]}}}function YW(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}function wP(t,e){return wP=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},wP(t,e)}function ZW(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,wP(t,e)}const RF={disabled:!1},Ww=ht.createContext(null);var ble=function(e){return e.scrollTop},G_="unmounted",Bg="exited",zg="entering",Ky="entered",SP="exiting",Dh=(function(t){ZW(e,t);function e(n,i){var a;a=t.call(this,n,i)||this;var s=i,o=s&&!s.isMounting?n.enter:n.appear,u;return a.appearStatus=null,n.in?o?(u=Bg,a.appearStatus=zg):u=Ky:n.unmountOnExit||n.mountOnEnter?u=G_:u=Bg,a.state={status:u},a.nextCallback=null,a}e.getDerivedStateFromProps=function(i,a){var s=i.in;return s&&a.status===G_?{status:Bg}:null};var r=e.prototype;return r.componentDidMount=function(){this.updateStatus(!0,this.appearStatus)},r.componentDidUpdate=function(i){var a=null;if(i!==this.props){var s=this.state.status;this.props.in?s!==zg&&s!==Ky&&(a=zg):(s===zg||s===Ky)&&(a=SP)}this.updateStatus(!1,a)},r.componentWillUnmount=function(){this.cancelNextCallback()},r.getTimeouts=function(){var i=this.props.timeout,a,s,o;return a=s=o=i,i!=null&&typeof i!="number"&&(a=i.exit,s=i.enter,o=i.appear!==void 0?i.appear:s),{exit:a,enter:s,appear:o}},r.updateStatus=function(i,a){if(i===void 0&&(i=!1),a!==null)if(this.cancelNextCallback(),a===zg){if(this.props.unmountOnExit||this.props.mountOnEnter){var s=this.props.nodeRef?this.props.nodeRef.current:q_.findDOMNode(this);s&&ble(s)}this.performEnter(i)}else this.performExit();else this.props.unmountOnExit&&this.state.status===Bg&&this.setState({status:G_})},r.performEnter=function(i){var a=this,s=this.props.enter,o=this.context?this.context.isMounting:i,u=this.props.nodeRef?[o]:[q_.findDOMNode(this),o],h=u[0],f=u[1],g=this.getTimeouts(),b=o?g.appear:g.enter;if(!i&&!s||RF.disabled){this.safeSetState({status:Ky},function(){a.props.onEntered(h)});return}this.props.onEnter(h,f),this.safeSetState({status:zg},function(){a.props.onEntering(h,f),a.onTransitionEnd(b,function(){a.safeSetState({status:Ky},function(){a.props.onEntered(h,f)})})})},r.performExit=function(){var i=this,a=this.props.exit,s=this.getTimeouts(),o=this.props.nodeRef?void 0:q_.findDOMNode(this);if(!a||RF.disabled){this.safeSetState({status:Bg},function(){i.props.onExited(o)});return}this.props.onExit(o),this.safeSetState({status:SP},function(){i.props.onExiting(o),i.onTransitionEnd(s.exit,function(){i.safeSetState({status:Bg},function(){i.props.onExited(o)})})})},r.cancelNextCallback=function(){this.nextCallback!==null&&(this.nextCallback.cancel(),this.nextCallback=null)},r.safeSetState=function(i,a){a=this.setNextCallback(a),this.setState(i,a)},r.setNextCallback=function(i){var a=this,s=!0;return this.nextCallback=function(o){s&&(s=!1,a.nextCallback=null,i(o))},this.nextCallback.cancel=function(){s=!1},this.nextCallback},r.onTransitionEnd=function(i,a){this.setNextCallback(a);var s=this.props.nodeRef?this.props.nodeRef.current:q_.findDOMNode(this),o=i==null&&!this.props.addEndListener;if(!s||o){setTimeout(this.nextCallback,0);return}if(this.props.addEndListener){var u=this.props.nodeRef?[this.nextCallback]:[s,this.nextCallback],h=u[0],f=u[1];this.props.addEndListener(h,f)}i!=null&&setTimeout(this.nextCallback,i)},r.render=function(){var i=this.state.status;if(i===G_)return null;var a=this.props,s=a.children;a.in,a.mountOnEnter,a.unmountOnExit,a.appear,a.enter,a.exit,a.timeout,a.addEndListener,a.onEnter,a.onEntering,a.onEntered,a.onExit,a.onExiting,a.onExited,a.nodeRef;var o=YW(a,["children","in","mountOnEnter","unmountOnExit","appear","enter","exit","timeout","addEndListener","onEnter","onEntering","onEntered","onExit","onExiting","onExited","nodeRef"]);return ht.createElement(Ww.Provider,{value:null},typeof s=="function"?s(i,o):ht.cloneElement(ht.Children.only(s),o))},e})(ht.Component);Dh.contextType=Ww;Dh.propTypes={};function Py(){}Dh.defaultProps={in:!1,mountOnEnter:!1,unmountOnExit:!1,appear:!1,enter:!0,exit:!0,onEnter:Py,onEntering:Py,onEntered:Py,onExit:Py,onExiting:Py,onExited:Py};Dh.UNMOUNTED=G_;Dh.EXITED=Bg;Dh.ENTERING=zg;Dh.ENTERED=Ky;Dh.EXITING=SP;function xle(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function zR(t,e){var r=function(a){return e&&ee.isValidElement(a)?e(a):a},n=Object.create(null);return t&&ee.Children.map(t,function(i){return i}).forEach(function(i){n[i.key]=r(i)}),n}function wle(t,e){t=t||{},e=e||{};function r(f){return f in e?e[f]:t[f]}var n=Object.create(null),i=[];for(var a in t)a in e?i.length&&(n[a]=i,i=[]):i.push(a);var s,o={};for(var u in e){if(n[u])for(s=0;s<n[u].length;s++){var h=n[u][s];o[n[u][s]]=r(h)}o[u]=r(u)}for(s=0;s<i.length;s++)o[i[s]]=r(i[s]);return o}function Zg(t,e,r){return r[e]!=null?r[e]:t.props[e]}function Sle(t,e){return zR(t.children,function(r){return ee.cloneElement(r,{onExited:e.bind(null,r),in:!0,appear:Zg(r,"appear",t),enter:Zg(r,"enter",t),exit:Zg(r,"exit",t)})})}function Ele(t,e,r){var n=zR(t.children),i=wle(e,n);return Object.keys(i).forEach(function(a){var s=i[a];if(ee.isValidElement(s)){var o=a in e,u=a in n,h=e[a],f=ee.isValidElement(h)&&!h.props.in;u&&(!o||f)?i[a]=ee.cloneElement(s,{onExited:r.bind(null,s),in:!0,exit:Zg(s,"exit",t),enter:Zg(s,"enter",t)}):!u&&o&&!f?i[a]=ee.cloneElement(s,{in:!1}):u&&o&&ee.isValidElement(h)&&(i[a]=ee.cloneElement(s,{onExited:r.bind(null,s),in:h.props.in,exit:Zg(s,"exit",t),enter:Zg(s,"enter",t)}))}}),i}var Tle=Object.values||function(t){return Object.keys(t).map(function(e){return t[e]})},Cle={component:"div",childFactory:function(e){return e}},jR=(function(t){ZW(e,t);function e(n,i){var a;a=t.call(this,n,i)||this;var s=a.handleExited.bind(xle(a));return a.state={contextValue:{isMounting:!0},handleExited:s,firstRender:!0},a}var r=e.prototype;return r.componentDidMount=function(){this.mounted=!0,this.setState({contextValue:{isMounting:!1}})},r.componentWillUnmount=function(){this.mounted=!1},e.getDerivedStateFromProps=function(i,a){var s=a.children,o=a.handleExited,u=a.firstRender;return{children:u?Sle(i,o):Ele(i,s,o),firstRender:!1}},r.handleExited=function(i,a){var s=zR(this.props.children);i.key in s||(i.props.onExited&&i.props.onExited(a),this.mounted&&this.setState(function(o){var u=Uw({},o.children);return delete u[i.key],{children:u}}))},r.render=function(){var i=this.props,a=i.component,s=i.childFactory,o=YW(i,["component","childFactory"]),u=this.state.contextValue,h=Tle(this.state.children).map(s);return delete o.appear,delete o.enter,delete o.exit,a===null?ht.createElement(Ww.Provider,{value:u},h):ht.createElement(Ww.Provider,{value:u},ht.createElement(a,o,h))},e})(ht.Component);jR.propTypes={};jR.defaultProps=Cle;const OF={};function KW(t,e){const r=ee.useRef(OF);return r.current===OF&&(r.current=t(e)),r}const Ale=[];function Ile(t){ee.useEffect(t,Ale)}class YE{static create(){return new YE}currentId=null;start(e,r){this.clear(),this.currentId=setTimeout(()=>{this.currentId=null,r()},e)}clear=()=>{this.currentId!==null&&(clearTimeout(this.currentId),this.currentId=null)};disposeEffect=()=>this.clear}function Lp(){const t=KW(YE.create).current;return Ile(t.disposeEffect),t}const UR=t=>t.scrollTop;function Hd(t,e){const{timeout:r,easing:n,style:i={}}=t;return{duration:i.transitionDuration??(typeof r=="number"?r:r[e.mode]||0),easing:i.transitionTimingFunction??(typeof n=="object"?n[e.mode]:n),delay:i.transitionDelay}}function Ple(t){return fi("MuiCollapse",t)}ui("MuiCollapse",["root","horizontal","vertical","entered","hidden","wrapper","wrapperInner"]);const kle=t=>{const{orientation:e,classes:r}=t,n={root:["root",`${e}`],entered:["entered"],hidden:["hidden"],wrapper:["wrapper",`${e}`],wrapperInner:["wrapperInner",`${e}`]};return di(n,Ple,r)},Mle=Pr("div",{name:"MuiCollapse",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.root,e[r.orientation],r.state==="entered"&&e.entered,r.state==="exited"&&!r.in&&r.collapsedSize==="0px"&&e.hidden]}})(si(({theme:t})=>({height:0,overflow:"hidden",transition:t.transitions.create("height"),variants:[{props:{orientation:"horizontal"},style:{height:"auto",width:0,transition:t.transitions.create("width")}},{props:{state:"entered"},style:{height:"auto",overflow:"visible"}},{props:{state:"entered",orientation:"horizontal"},style:{width:"auto"}},{props:({ownerState:e})=>e.state==="exited"&&!e.in&&e.collapsedSize==="0px",style:{visibility:"hidden"}}]}))),Rle=Pr("div",{name:"MuiCollapse",slot:"Wrapper"})({display:"flex",width:"100%",variants:[{props:{orientation:"horizontal"},style:{width:"auto",height:"100%"}}]}),Ole=Pr("div",{name:"MuiCollapse",slot:"WrapperInner"})({width:"100%",variants:[{props:{orientation:"horizontal"},style:{width:"auto",height:"100%"}}]}),EP=ee.forwardRef(function(e,r){const n=_i({props:e,name:"MuiCollapse"}),{addEndListener:i,children:a,className:s,collapsedSize:o="0px",component:u,easing:h,in:f,onEnter:g,onEntered:b,onEntering:v,onExit:S,onExited:E,onExiting:P,orientation:k="vertical",style:L,timeout:O=UW.standard,TransitionComponent:M=Dh,...z}=n,B={...n,orientation:k,collapsedSize:o},q=kle(B),W=Tc(),G=Lp(),ie=ee.useRef(null),Q=ee.useRef(),H=typeof o=="number"?`${o}px`:o,ne=k==="horizontal",oe=ne?"width":"height",ce=ee.useRef(null),fe=Lo(r,ce),Me=Oe=>$e=>{if(Oe){const De=ce.current;$e===void 0?Oe(De):Oe(De,$e)}},me=()=>ie.current?ie.current[ne?"clientWidth":"clientHeight"]:0,we=Me((Oe,$e)=>{ie.current&&ne&&(ie.current.style.position="absolute"),Oe.style[oe]=H,g&&g(Oe,$e)}),Te=Me((Oe,$e)=>{const De=me();ie.current&&ne&&(ie.current.style.position="");const{duration:it,easing:Ye}=Hd({style:L,timeout:O,easing:h},{mode:"enter"});if(O==="auto"){const rt=W.transitions.getAutoHeightDuration(De);Oe.style.transitionDuration=`${rt}ms`,Q.current=rt}else Oe.style.transitionDuration=typeof it=="string"?it:`${it}ms`;Oe.style[oe]=`${De}px`,Oe.style.transitionTimingFunction=Ye,v&&v(Oe,$e)}),ke=Me((Oe,$e)=>{Oe.style[oe]="auto",b&&b(Oe,$e)}),he=Me(Oe=>{Oe.style[oe]=`${me()}px`,S&&S(Oe)}),Ee=Me(E),xe=Me(Oe=>{const $e=me(),{duration:De,easing:it}=Hd({style:L,timeout:O,easing:h},{mode:"exit"});if(O==="auto"){const Ye=W.transitions.getAutoHeightDuration($e);Oe.style.transitionDuration=`${Ye}ms`,Q.current=Ye}else Oe.style.transitionDuration=typeof De=="string"?De:`${De}ms`;Oe.style[oe]=H,Oe.style.transitionTimingFunction=it,P&&P(Oe)}),Ne=Oe=>{O==="auto"&&G.start(Q.current||0,Oe),i&&i(ce.current,Oe)};return K.jsx(M,{in:f,onEnter:we,onEntered:ke,onEntering:Te,onExit:he,onExited:Ee,onExiting:xe,addEndListener:Ne,nodeRef:ce,timeout:O==="auto"?null:O,...z,children:(Oe,{ownerState:$e,...De})=>K.jsx(Mle,{as:u,className:Sn(q.root,s,{entered:q.entered,exited:!f&&H==="0px"&&q.hidden}[Oe]),style:{[ne?"minWidth":"minHeight"]:H,...L},ref:fe,ownerState:{...B,state:Oe},...De,children:K.jsx(Rle,{ownerState:{...B,state:Oe},className:q.wrapper,ref:ie,children:K.jsx(Ole,{ownerState:{...B,state:Oe},className:q.wrapperInner,children:a})})})})});EP&&(EP.muiSupportAuto=!0);function Lle(t){return fi("MuiPaper",t)}ui("MuiPaper",["root","rounded","outlined","elevation","elevation0","elevation1","elevation2","elevation3","elevation4","elevation5","elevation6","elevation7","elevation8","elevation9","elevation10","elevation11","elevation12","elevation13","elevation14","elevation15","elevation16","elevation17","elevation18","elevation19","elevation20","elevation21","elevation22","elevation23","elevation24"]);const Nle=t=>{const{square:e,elevation:r,variant:n,classes:i}=t,a={root:["root",n,!e&&"rounded",n==="elevation"&&`elevation${r}`]};return di(a,Lle,i)},Dle=Pr("div",{name:"MuiPaper",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.root,e[r.variant],!r.square&&e.rounded,r.variant==="elevation"&&e[`elevation${r.elevation}`]]}})(si(({theme:t})=>({backgroundColor:(t.vars||t).palette.background.paper,color:(t.vars||t).palette.text.primary,transition:t.transitions.create("box-shadow"),variants:[{props:({ownerState:e})=>!e.square,style:{borderRadius:t.shape.borderRadius}},{props:{variant:"outlined"},style:{border:`1px solid ${(t.vars||t).palette.divider}`}},{props:{variant:"elevation"},style:{boxShadow:"var(--Paper-shadow)",backgroundImage:"var(--Paper-overlay)"}}]}))),Th=ee.forwardRef(function(e,r){const n=_i({props:e,name:"MuiPaper"}),i=Tc(),{className:a,component:s="div",elevation:o=1,square:u=!1,variant:h="elevation",...f}=n,g={...n,component:s,elevation:o,square:u,variant:h},b=Nle(g);return K.jsx(Dle,{as:s,ownerState:g,className:Sn(b.root,a),ref:r,...f,style:{...h==="elevation"&&{"--Paper-shadow":(i.vars||i).shadows[o],...i.vars&&{"--Paper-overlay":i.vars.overlays?.[o]},...!i.vars&&i.palette.mode==="dark"&&{"--Paper-overlay":`linear-gradient(${qw("#fff",yP(o))}, ${qw("#fff",yP(o))})`}},...f.style}})}),JW=ee.createContext({});function Zf(t){return typeof t=="string"}function QW(t,e,r){return t===void 0||Zf(t)?e:{...e,ownerState:{...e.ownerState,...r}}}function eG(t,e,r){return typeof t=="function"?t(e,r):t}function rm(t,e=[]){if(t===void 0)return{};const r={};return Object.keys(t).filter(n=>n.match(/^on[A-Z]/)&&typeof t[n]=="function"&&!e.includes(n)).forEach(n=>{r[n]=t[n]}),r}function LF(t){if(t===void 0)return{};const e={};return Object.keys(t).filter(r=>!(r.match(/^on[A-Z]/)&&typeof t[r]=="function")).forEach(r=>{e[r]=t[r]}),e}function tG(t){const{getSlotProps:e,additionalProps:r,externalSlotProps:n,externalForwardedProps:i,className:a}=t;if(!e){const v=Sn(r?.className,a,i?.className,n?.className),S={...r?.style,...i?.style,...n?.style},E={...r,...i,...n};return v.length>0&&(E.className=v),Object.keys(S).length>0&&(E.style=S),{props:E,internalRef:void 0}}const s=rm({...i,...n}),o=LF(n),u=LF(i),h=e(s),f=Sn(h?.className,r?.className,a,i?.className,n?.className),g={...h?.style,...r?.style,...i?.style,...n?.style},b={...h,...r,...u,...o};return f.length>0&&(b.className=f),Object.keys(g).length>0&&(b.style=g),{props:b,internalRef:h.ref}}function Si(t,e){const{className:r,elementType:n,ownerState:i,externalForwardedProps:a,internalForwardedProps:s,shouldForwardComponentProp:o=!1,...u}=e,{component:h,slots:f={[t]:void 0},slotProps:g={[t]:void 0},...b}=a,v=f[t]||n,S=eG(g[t],i),{props:{component:E,...P},internalRef:k}=tG({className:r,...u,externalForwardedProps:t==="root"?b:void 0,externalSlotProps:S}),L=Lo(k,S?.ref,e.ref),O=t==="root"?E||h:E,M=QW(v,{...t==="root"&&!h&&!f[t]&&s,...t!=="root"&&!f[t]&&s,...P,...O&&!o&&{as:O},...O&&o&&{component:O},ref:L},i);return[v,M]}function Fle(t){return fi("MuiAccordion",t)}const Ux=ui("MuiAccordion",["root","heading","rounded","expanded","disabled","gutters","region"]),Ble=t=>{const{classes:e,square:r,expanded:n,disabled:i,disableGutters:a}=t;return di({root:["root",!r&&"rounded",n&&"expanded",i&&"disabled",!a&&"gutters"],heading:["heading"],region:["region"]},Fle,e)},zle=Pr(Th,{name:"MuiAccordion",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[{[`& .${Ux.region}`]:e.region},e.root,!r.square&&e.rounded,!r.disableGutters&&e.gutters]}})(si(({theme:t})=>{const e={duration:t.transitions.duration.shortest};return{position:"relative",transition:t.transitions.create(["margin"],e),overflowAnchor:"none","&::before":{position:"absolute",left:0,top:-1,right:0,height:1,content:'""',opacity:1,backgroundColor:(t.vars||t).palette.divider,transition:t.transitions.create(["opacity","background-color"],e)},"&:first-of-type":{"&::before":{display:"none"}},[`&.${Ux.expanded}`]:{"&::before":{opacity:0},"&:first-of-type":{marginTop:0},"&:last-of-type":{marginBottom:0},"& + &":{"&::before":{display:"none"}}},[`&.${Ux.disabled}`]:{backgroundColor:(t.vars||t).palette.action.disabledBackground}}}),si(({theme:t})=>({variants:[{props:e=>!e.square,style:{borderRadius:0,"&:first-of-type":{borderTopLeftRadius:(t.vars||t).shape.borderRadius,borderTopRightRadius:(t.vars||t).shape.borderRadius},"&:last-of-type":{borderBottomLeftRadius:(t.vars||t).shape.borderRadius,borderBottomRightRadius:(t.vars||t).shape.borderRadius,"@supports (-ms-ime-align: auto)":{borderBottomLeftRadius:0,borderBottomRightRadius:0}}}},{props:e=>!e.disableGutters,style:{[`&.${Ux.expanded}`]:{margin:"16px 0"}}}]}))),jle=Pr("h3",{name:"MuiAccordion",slot:"Heading"})({all:"unset"}),Ule=Pr("div",{name:"MuiAccordion",slot:"Region"})({}),Vle=ee.forwardRef(function(e,r){const n=_i({props:e,name:"MuiAccordion"}),{children:i,className:a,defaultExpanded:s=!1,disabled:o=!1,disableGutters:u=!1,expanded:h,onChange:f,square:g=!1,slots:b={},slotProps:v={},TransitionComponent:S,TransitionProps:E,...P}=n,[k,L]=pm({controlled:h,default:s,name:"Accordion",state:"expanded"}),O=ee.useCallback(Te=>{L(!k),f&&f(Te,!k)},[k,f,L]),[M,...z]=ee.Children.toArray(i),B=ee.useMemo(()=>({expanded:k,disabled:o,disableGutters:u,toggle:O}),[k,o,u,O]),q={...n,square:g,disabled:o,disableGutters:u,expanded:k},W=Ble(q),G={transition:S,...b},ie={transition:E,...v},Q={slots:G,slotProps:ie},[H,ne]=Si("root",{elementType:zle,externalForwardedProps:{...Q,...P},className:Sn(W.root,a),shouldForwardComponentProp:!0,ownerState:q,ref:r,additionalProps:{square:g}}),[oe,ce]=Si("heading",{elementType:jle,externalForwardedProps:Q,className:W.heading,ownerState:q}),[fe,Me]=Si("transition",{elementType:EP,externalForwardedProps:Q,ownerState:q}),[me,we]=Si("region",{elementType:Ule,externalForwardedProps:Q,ownerState:q,className:W.region,additionalProps:{"aria-labelledby":M.props.id,id:M.props["aria-controls"],role:"region"}});return K.jsxs(H,{...ne,children:[K.jsx(oe,{...ce,children:K.jsx(JW.Provider,{value:B,children:M})}),K.jsx(fe,{in:k,timeout:"auto",...Me,children:K.jsx(me,{...we,children:z})})]})});function Jv(t){try{return t.matches(":focus-visible")}catch{}return!1}class Gw{static create(){return new Gw}static use(){const e=KW(Gw.create).current,[r,n]=ee.useState(!1);return e.shouldMount=r,e.setShouldMount=n,ee.useEffect(e.mountEffect,[r]),e}constructor(){this.ref={current:null},this.mounted=null,this.didMount=!1,this.shouldMount=!1,this.setShouldMount=null}mount(){return this.mounted||(this.mounted=qle(),this.shouldMount=!0,this.setShouldMount(this.shouldMount)),this.mounted}mountEffect=()=>{this.shouldMount&&!this.didMount&&this.ref.current!==null&&(this.didMount=!0,this.mounted.resolve())};start(...e){this.mount().then(()=>this.ref.current?.start(...e))}stop(...e){this.mount().then(()=>this.ref.current?.stop(...e))}pulsate(...e){this.mount().then(()=>this.ref.current?.pulsate(...e))}}function $le(){return Gw.use()}function qle(){let t,e;const r=new Promise((n,i)=>{t=n,e=i});return r.resolve=t,r.reject=e,r}function Hle(t){const{className:e,classes:r,pulsate:n=!1,rippleX:i,rippleY:a,rippleSize:s,in:o,onExited:u,timeout:h}=t,[f,g]=ee.useState(!1),b=Sn(e,r.ripple,r.rippleVisible,n&&r.ripplePulsate),v={width:s,height:s,top:-(s/2)+a,left:-(s/2)+i},S=Sn(r.child,f&&r.childLeaving,n&&r.childPulsate);return!o&&!f&&g(!0),ee.useEffect(()=>{if(!o&&u!=null){const E=setTimeout(u,h);return()=>{clearTimeout(E)}}},[u,o,h]),K.jsx("span",{className:b,style:v,children:K.jsx("span",{className:S})})}const ph=ui("MuiTouchRipple",["root","ripple","rippleVisible","ripplePulsate","child","childLeaving","childPulsate"]),TP=550,Wle=80,Gle=Bb`
  0% {
    transform: scale(0);
    opacity: 0.1;
  }

  100% {
    transform: scale(1);
    opacity: 0.3;
  }
`,Xle=Bb`
  0% {
    opacity: 1;
  }

  100% {
    opacity: 0;
  }
`,Yle=Bb`
  0% {
    transform: scale(1);
  }

  50% {
    transform: scale(0.92);
  }

  100% {
    transform: scale(1);
  }
`,Zle=Pr("span",{name:"MuiTouchRipple",slot:"Root"})({overflow:"hidden",pointerEvents:"none",position:"absolute",zIndex:0,top:0,right:0,bottom:0,left:0,borderRadius:"inherit"}),Kle=Pr(Hle,{name:"MuiTouchRipple",slot:"Ripple"})`
  opacity: 0;
  position: absolute;

  &.${ph.rippleVisible} {
    opacity: 0.3;
    transform: scale(1);
    animation-name: ${Gle};
    animation-duration: ${TP}ms;
    animation-timing-function: ${({theme:t})=>t.transitions.easing.easeInOut};
  }

  &.${ph.ripplePulsate} {
    animation-duration: ${({theme:t})=>t.transitions.duration.shorter}ms;
  }

  & .${ph.child} {
    opacity: 1;
    display: block;
    width: 100%;
    height: 100%;
    border-radius: 50%;
    background-color: currentColor;
  }

  & .${ph.childLeaving} {
    opacity: 0;
    animation-name: ${Xle};
    animation-duration: ${TP}ms;
    animation-timing-function: ${({theme:t})=>t.transitions.easing.easeInOut};
  }

  & .${ph.childPulsate} {
    position: absolute;
    /* @noflip */
    left: 0px;
    top: 0;
    animation-name: ${Yle};
    animation-duration: 2500ms;
    animation-timing-function: ${({theme:t})=>t.transitions.easing.easeInOut};
    animation-iteration-count: infinite;
    animation-delay: 200ms;
  }
`,Jle=ee.forwardRef(function(e,r){const n=_i({props:e,name:"MuiTouchRipple"}),{center:i=!1,classes:a={},className:s,...o}=n,[u,h]=ee.useState([]),f=ee.useRef(0),g=ee.useRef(null);ee.useEffect(()=>{g.current&&(g.current(),g.current=null)},[u]);const b=ee.useRef(!1),v=Lp(),S=ee.useRef(null),E=ee.useRef(null),P=ee.useCallback(M=>{const{pulsate:z,rippleX:B,rippleY:q,rippleSize:W,cb:G}=M;h(ie=>[...ie,K.jsx(Kle,{classes:{ripple:Sn(a.ripple,ph.ripple),rippleVisible:Sn(a.rippleVisible,ph.rippleVisible),ripplePulsate:Sn(a.ripplePulsate,ph.ripplePulsate),child:Sn(a.child,ph.child),childLeaving:Sn(a.childLeaving,ph.childLeaving),childPulsate:Sn(a.childPulsate,ph.childPulsate)},timeout:TP,pulsate:z,rippleX:B,rippleY:q,rippleSize:W},f.current)]),f.current+=1,g.current=G},[a]),k=ee.useCallback((M={},z={},B=()=>{})=>{const{pulsate:q=!1,center:W=i||z.pulsate,fakeElement:G=!1}=z;if(M?.type==="mousedown"&&b.current){b.current=!1;return}M?.type==="touchstart"&&(b.current=!0);const ie=G?null:E.current,Q=ie?ie.getBoundingClientRect():{width:0,height:0,left:0,top:0};let H,ne,oe;if(W||M===void 0||M.clientX===0&&M.clientY===0||!M.clientX&&!M.touches)H=Math.round(Q.width/2),ne=Math.round(Q.height/2);else{const{clientX:ce,clientY:fe}=M.touches&&M.touches.length>0?M.touches[0]:M;H=Math.round(ce-Q.left),ne=Math.round(fe-Q.top)}if(W)oe=Math.sqrt((2*Q.width**2+Q.height**2)/3),oe%2===0&&(oe+=1);else{const ce=Math.max(Math.abs((ie?ie.clientWidth:0)-H),H)*2+2,fe=Math.max(Math.abs((ie?ie.clientHeight:0)-ne),ne)*2+2;oe=Math.sqrt(ce**2+fe**2)}M?.touches?S.current===null&&(S.current=()=>{P({pulsate:q,rippleX:H,rippleY:ne,rippleSize:oe,cb:B})},v.start(Wle,()=>{S.current&&(S.current(),S.current=null)})):P({pulsate:q,rippleX:H,rippleY:ne,rippleSize:oe,cb:B})},[i,P,v]),L=ee.useCallback(()=>{k({},{pulsate:!0})},[k]),O=ee.useCallback((M,z)=>{if(v.clear(),M?.type==="touchend"&&S.current){S.current(),S.current=null,v.start(0,()=>{O(M,z)});return}S.current=null,h(B=>B.length>0?B.slice(1):B),g.current=z},[v]);return ee.useImperativeHandle(r,()=>({pulsate:L,start:k,stop:O}),[L,k,O]),K.jsx(Zle,{className:Sn(ph.root,a.root,s),ref:E,...o,children:K.jsx(jR,{component:null,exit:!0,children:u})})});function Qle(t){return fi("MuiButtonBase",t)}const eue=ui("MuiButtonBase",["root","disabled","focusVisible"]),tue=t=>{const{disabled:e,focusVisible:r,focusVisibleClassName:n,classes:i}=t,s=di({root:["root",e&&"disabled",r&&"focusVisible"]},Qle,i);return r&&n&&(s.root+=` ${n}`),s},rue=Pr("button",{name:"MuiButtonBase",slot:"Root"})({display:"inline-flex",alignItems:"center",justifyContent:"center",position:"relative",boxSizing:"border-box",WebkitTapHighlightColor:"transparent",backgroundColor:"transparent",outline:0,border:0,margin:0,borderRadius:0,padding:0,cursor:"pointer",userSelect:"none",verticalAlign:"middle",MozAppearance:"none",WebkitAppearance:"none",textDecoration:"none",color:"inherit","&::-moz-focus-inner":{borderStyle:"none"},[`&.${eue.disabled}`]:{pointerEvents:"none",cursor:"default"},"@media print":{colorAdjust:"exact"}}),M0=ee.forwardRef(function(e,r){const n=_i({props:e,name:"MuiButtonBase"}),{action:i,centerRipple:a=!1,children:s,className:o,component:u="button",disabled:h=!1,disableRipple:f=!1,disableTouchRipple:g=!1,focusRipple:b=!1,focusVisibleClassName:v,LinkComponent:S="a",onBlur:E,onClick:P,onContextMenu:k,onDragLeave:L,onFocus:O,onFocusVisible:M,onKeyDown:z,onKeyUp:B,onMouseDown:q,onMouseLeave:W,onMouseUp:G,onTouchEnd:ie,onTouchMove:Q,onTouchStart:H,tabIndex:ne=0,TouchRippleProps:oe,touchRippleRef:ce,type:fe,...Me}=n,me=ee.useRef(null),we=$le(),Te=Lo(we.ref,ce),[ke,he]=ee.useState(!1);h&&ke&&he(!1),ee.useImperativeHandle(i,()=>({focusVisible:()=>{he(!0),me.current.focus()}}),[]);const Ee=we.shouldMount&&!f&&!h;ee.useEffect(()=>{ke&&b&&!f&&we.pulsate()},[f,b,ke,we]);const xe=wd(we,"start",q,g),Ne=wd(we,"stop",k,g),Oe=wd(we,"stop",L,g),$e=wd(we,"stop",G,g),De=wd(we,"stop",cr=>{ke&&cr.preventDefault(),W&&W(cr)},g),it=wd(we,"start",H,g),Ye=wd(we,"stop",ie,g),rt=wd(we,"stop",Q,g),Ie=wd(we,"stop",cr=>{Jv(cr.target)||he(!1),E&&E(cr)},!1),Mt=Ql(cr=>{me.current||(me.current=cr.currentTarget),Jv(cr.target)&&(he(!0),M&&M(cr)),O&&O(cr)}),at=()=>{const cr=me.current;return u&&u!=="button"&&!(cr.tagName==="A"&&cr.href)},je=Ql(cr=>{b&&!cr.repeat&&ke&&cr.key===" "&&we.stop(cr,()=>{we.start(cr)}),cr.target===cr.currentTarget&&at()&&cr.key===" "&&cr.preventDefault(),z&&z(cr),cr.target===cr.currentTarget&&at()&&cr.key==="Enter"&&!h&&(cr.preventDefault(),P&&P(cr))}),Xt=Ql(cr=>{b&&cr.key===" "&&ke&&!cr.defaultPrevented&&we.stop(cr,()=>{we.pulsate(cr)}),B&&B(cr),P&&cr.target===cr.currentTarget&&at()&&cr.key===" "&&!cr.defaultPrevented&&P(cr)});let Yt=u;Yt==="button"&&(Me.href||Me.to)&&(Yt=S);const pr={};Yt==="button"?(pr.type=fe===void 0?"button":fe,pr.disabled=h):(!Me.href&&!Me.to&&(pr.role="button"),h&&(pr["aria-disabled"]=h));const vt=Lo(r,me),yr={...n,centerRipple:a,component:u,disabled:h,disableRipple:f,disableTouchRipple:g,focusRipple:b,tabIndex:ne,focusVisible:ke},_r=tue(yr);return K.jsxs(rue,{as:Yt,className:Sn(_r.root,o),ownerState:yr,onBlur:Ie,onClick:P,onContextMenu:Ne,onFocus:Mt,onKeyDown:je,onKeyUp:Xt,onMouseDown:xe,onMouseLeave:De,onMouseUp:$e,onDragLeave:Oe,onTouchEnd:Ye,onTouchMove:rt,onTouchStart:it,ref:vt,tabIndex:h?-1:ne,type:fe,...pr,...Me,children:[s,Ee?K.jsx(Jle,{ref:Te,center:a,...oe}):null]})});function wd(t,e,r,n=!1){return Ql(i=>(r&&r(i),n||t[e](i),!0))}function nue(t){return fi("MuiAccordionSummary",t)}const bv=ui("MuiAccordionSummary",["root","expanded","focusVisible","disabled","gutters","contentGutters","content","expandIconWrapper"]),iue=t=>{const{classes:e,expanded:r,disabled:n,disableGutters:i}=t;return di({root:["root",r&&"expanded",n&&"disabled",!i&&"gutters"],focusVisible:["focusVisible"],content:["content",r&&"expanded",!i&&"contentGutters"],expandIconWrapper:["expandIconWrapper",r&&"expanded"]},nue,e)},aue=Pr(M0,{name:"MuiAccordionSummary",slot:"Root"})(si(({theme:t})=>{const e={duration:t.transitions.duration.shortest};return{display:"flex",width:"100%",minHeight:48,padding:t.spacing(0,2),transition:t.transitions.create(["min-height","background-color"],e),[`&.${bv.focusVisible}`]:{backgroundColor:(t.vars||t).palette.action.focus},[`&.${bv.disabled}`]:{opacity:(t.vars||t).palette.action.disabledOpacity},[`&:hover:not(.${bv.disabled})`]:{cursor:"pointer"},variants:[{props:r=>!r.disableGutters,style:{[`&.${bv.expanded}`]:{minHeight:64}}}]}})),oue=Pr("span",{name:"MuiAccordionSummary",slot:"Content"})(si(({theme:t})=>({display:"flex",textAlign:"start",flexGrow:1,margin:"12px 0",variants:[{props:e=>!e.disableGutters,style:{transition:t.transitions.create(["margin"],{duration:t.transitions.duration.shortest}),[`&.${bv.expanded}`]:{margin:"20px 0"}}}]}))),sue=Pr("span",{name:"MuiAccordionSummary",slot:"ExpandIconWrapper"})(si(({theme:t})=>({display:"flex",color:(t.vars||t).palette.action.active,transform:"rotate(0deg)",transition:t.transitions.create("transform",{duration:t.transitions.duration.shortest}),[`&.${bv.expanded}`]:{transform:"rotate(180deg)"}}))),lue=ee.forwardRef(function(e,r){const n=_i({props:e,name:"MuiAccordionSummary"}),{children:i,className:a,expandIcon:s,focusVisibleClassName:o,onClick:u,slots:h,slotProps:f,...g}=n,{disabled:b=!1,disableGutters:v,expanded:S,toggle:E}=ee.useContext(JW),P=ie=>{E&&E(ie),u&&u(ie)},k={...n,expanded:S,disabled:b,disableGutters:v},L=iue(k),O={slots:h,slotProps:f},[M,z]=Si("root",{ref:r,shouldForwardComponentProp:!0,className:Sn(L.root,a),elementType:aue,externalForwardedProps:{...O,...g},ownerState:k,additionalProps:{focusRipple:!1,disableRipple:!0,disabled:b,"aria-expanded":S,focusVisibleClassName:Sn(L.focusVisible,o)},getSlotProps:ie=>({...ie,onClick:Q=>{ie.onClick?.(Q),P(Q)}})}),[B,q]=Si("content",{className:L.content,elementType:oue,externalForwardedProps:O,ownerState:k}),[W,G]=Si("expandIconWrapper",{className:L.expandIconWrapper,elementType:sue,externalForwardedProps:O,ownerState:k});return K.jsxs(M,{...z,children:[K.jsx(B,{...q,children:i}),s&&K.jsx(W,{...G,children:s})]})});function uue(t){return typeof t.main=="string"}function cue(t,e=[]){if(!uue(t))return!1;for(const r of e)if(!t.hasOwnProperty(r)||typeof t[r]!="string")return!1;return!0}function Nl(t=[]){return([,e])=>e&&cue(e,t)}function hue(t){return fi("MuiCircularProgress",t)}ui("MuiCircularProgress",["root","determinate","indeterminate","colorPrimary","colorSecondary","svg","circle","circleDeterminate","circleIndeterminate","circleDisableShrink"]);const _p=44,CP=Bb`
  0% {
    transform: rotate(0deg);
  }

  100% {
    transform: rotate(360deg);
  }
`,AP=Bb`
  0% {
    stroke-dasharray: 1px, 200px;
    stroke-dashoffset: 0;
  }

  50% {
    stroke-dasharray: 100px, 200px;
    stroke-dashoffset: -15px;
  }

  100% {
    stroke-dasharray: 1px, 200px;
    stroke-dashoffset: -126px;
  }
`,fue=typeof CP!="string"?ER`
        animation: ${CP} 1.4s linear infinite;
      `:null,due=typeof AP!="string"?ER`
        animation: ${AP} 1.4s ease-in-out infinite;
      `:null,pue=t=>{const{classes:e,variant:r,color:n,disableShrink:i}=t,a={root:["root",r,`color${on(n)}`],svg:["svg"],circle:["circle",`circle${on(r)}`,i&&"circleDisableShrink"]};return di(a,hue,e)},gue=Pr("span",{name:"MuiCircularProgress",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.root,e[r.variant],e[`color${on(r.color)}`]]}})(si(({theme:t})=>({display:"inline-block",variants:[{props:{variant:"determinate"},style:{transition:t.transitions.create("transform")}},{props:{variant:"indeterminate"},style:fue||{animation:`${CP} 1.4s linear infinite`}},...Object.entries(t.palette).filter(Nl()).map(([e])=>({props:{color:e},style:{color:(t.vars||t).palette[e].main}}))]}))),mue=Pr("svg",{name:"MuiCircularProgress",slot:"Svg"})({display:"block"}),yue=Pr("circle",{name:"MuiCircularProgress",slot:"Circle",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.circle,e[`circle${on(r.variant)}`],r.disableShrink&&e.circleDisableShrink]}})(si(({theme:t})=>({stroke:"currentColor",variants:[{props:{variant:"determinate"},style:{transition:t.transitions.create("stroke-dashoffset")}},{props:{variant:"indeterminate"},style:{strokeDasharray:"80px, 200px",strokeDashoffset:0}},{props:({ownerState:e})=>e.variant==="indeterminate"&&!e.disableShrink,style:due||{animation:`${AP} 1.4s ease-in-out infinite`}}]}))),ZE=ee.forwardRef(function(e,r){const n=_i({props:e,name:"MuiCircularProgress"}),{className:i,color:a="primary",disableShrink:s=!1,size:o=40,style:u,thickness:h=3.6,value:f=0,variant:g="indeterminate",...b}=n,v={...n,color:a,disableShrink:s,size:o,thickness:h,value:f,variant:g},S=pue(v),E={},P={},k={};if(g==="determinate"){const L=2*Math.PI*((_p-h)/2);E.strokeDasharray=L.toFixed(3),k["aria-valuenow"]=Math.round(f),E.strokeDashoffset=`${((100-f)/100*L).toFixed(3)}px`,P.transform="rotate(-90deg)"}return K.jsx(gue,{className:Sn(S.root,i),style:{width:o,height:o,...P,...u},ownerState:v,ref:r,role:"progressbar",...k,...b,children:K.jsx(mue,{className:S.svg,ownerState:v,viewBox:`${_p/2} ${_p/2} ${_p} ${_p}`,children:K.jsx(yue,{className:S.circle,style:E,ownerState:v,cx:_p,cy:_p,r:(_p-h)/2,fill:"none",strokeWidth:h})})})});function vue(t){return fi("MuiIconButton",t)}const NF=ui("MuiIconButton",["root","disabled","colorInherit","colorPrimary","colorSecondary","colorError","colorInfo","colorSuccess","colorWarning","edgeStart","edgeEnd","sizeSmall","sizeMedium","sizeLarge","loading","loadingIndicator","loadingWrapper"]),_ue=t=>{const{classes:e,disabled:r,color:n,edge:i,size:a,loading:s}=t,o={root:["root",s&&"loading",r&&"disabled",n!=="default"&&`color${on(n)}`,i&&`edge${on(i)}`,`size${on(a)}`],loadingIndicator:["loadingIndicator"],loadingWrapper:["loadingWrapper"]};return di(o,vue,e)},bue=Pr(M0,{name:"MuiIconButton",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.root,r.loading&&e.loading,r.color!=="default"&&e[`color${on(r.color)}`],r.edge&&e[`edge${on(r.edge)}`],e[`size${on(r.size)}`]]}})(si(({theme:t})=>({textAlign:"center",flex:"0 0 auto",fontSize:t.typography.pxToRem(24),padding:8,borderRadius:"50%",color:(t.vars||t).palette.action.active,transition:t.transitions.create("background-color",{duration:t.transitions.duration.shortest}),variants:[{props:e=>!e.disableRipple,style:{"--IconButton-hoverBg":t.alpha((t.vars||t).palette.action.active,(t.vars||t).palette.action.hoverOpacity),"&:hover":{backgroundColor:"var(--IconButton-hoverBg)","@media (hover: none)":{backgroundColor:"transparent"}}}},{props:{edge:"start"},style:{marginLeft:-12}},{props:{edge:"start",size:"small"},style:{marginLeft:-3}},{props:{edge:"end"},style:{marginRight:-12}},{props:{edge:"end",size:"small"},style:{marginRight:-3}}]})),si(({theme:t})=>({variants:[{props:{color:"inherit"},style:{color:"inherit"}},...Object.entries(t.palette).filter(Nl()).map(([e])=>({props:{color:e},style:{color:(t.vars||t).palette[e].main}})),...Object.entries(t.palette).filter(Nl()).map(([e])=>({props:{color:e},style:{"--IconButton-hoverBg":t.alpha((t.vars||t).palette[e].main,(t.vars||t).palette.action.hoverOpacity)}})),{props:{size:"small"},style:{padding:5,fontSize:t.typography.pxToRem(18)}},{props:{size:"large"},style:{padding:12,fontSize:t.typography.pxToRem(28)}}],[`&.${NF.disabled}`]:{backgroundColor:"transparent",color:(t.vars||t).palette.action.disabled},[`&.${NF.loading}`]:{color:"transparent"}}))),xue=Pr("span",{name:"MuiIconButton",slot:"LoadingIndicator"})(({theme:t})=>({display:"none",position:"absolute",visibility:"visible",top:"50%",left:"50%",transform:"translate(-50%, -50%)",color:(t.vars||t).palette.action.disabled,variants:[{props:{loading:!0},style:{display:"flex"}}]})),eh=ee.forwardRef(function(e,r){const n=_i({props:e,name:"MuiIconButton"}),{edge:i=!1,children:a,className:s,color:o="default",disabled:u=!1,disableFocusRipple:h=!1,size:f="medium",id:g,loading:b=null,loadingIndicator:v,...S}=n,E=ag(g),P=v??K.jsx(ZE,{"aria-labelledby":E,color:"inherit",size:16}),k={...n,edge:i,color:o,disabled:u,disableFocusRipple:h,loading:b,loadingIndicator:P,size:f},L=_ue(k);return K.jsxs(bue,{id:b?E:g,className:Sn(L.root,s),centerRipple:!0,focusRipple:!h,disabled:u||b,ref:r,...S,ownerState:k,children:[typeof b=="boolean"&&K.jsx("span",{className:L.loadingWrapper,style:{display:"contents"},children:K.jsx(xue,{className:L.loadingIndicator,ownerState:k,children:b&&P})}),a]})});function wue(t){return fi("MuiTypography",t)}const DF=ui("MuiTypography",["root","h1","h2","h3","h4","h5","h6","subtitle1","subtitle2","body1","body2","inherit","button","caption","overline","alignLeft","alignRight","alignCenter","alignJustify","noWrap","gutterBottom","paragraph"]),Sue={primary:!0,secondary:!0,error:!0,info:!0,success:!0,warning:!0,textPrimary:!0,textSecondary:!0,textDisabled:!0},Eue=gle(),Tue=t=>{const{align:e,gutterBottom:r,noWrap:n,paragraph:i,variant:a,classes:s}=t,o={root:["root",a,t.align!=="inherit"&&`align${on(e)}`,r&&"gutterBottom",n&&"noWrap",i&&"paragraph"]};return di(o,wue,s)},Cue=Pr("span",{name:"MuiTypography",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.root,r.variant&&e[r.variant],r.align!=="inherit"&&e[`align${on(r.align)}`],r.noWrap&&e.noWrap,r.gutterBottom&&e.gutterBottom,r.paragraph&&e.paragraph]}})(si(({theme:t})=>({margin:0,variants:[{props:{variant:"inherit"},style:{font:"inherit",lineHeight:"inherit",letterSpacing:"inherit"}},...Object.entries(t.typography).filter(([e,r])=>e!=="inherit"&&r&&typeof r=="object").map(([e,r])=>({props:{variant:e},style:r})),...Object.entries(t.palette).filter(Nl()).map(([e])=>({props:{color:e},style:{color:(t.vars||t).palette[e].main}})),...Object.entries(t.palette?.text||{}).filter(([,e])=>typeof e=="string").map(([e])=>({props:{color:`text${on(e)}`},style:{color:(t.vars||t).palette.text[e]}})),{props:({ownerState:e})=>e.align!=="inherit",style:{textAlign:"var(--Typography-textAlign)"}},{props:({ownerState:e})=>e.noWrap,style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"}},{props:({ownerState:e})=>e.gutterBottom,style:{marginBottom:"0.35em"}},{props:({ownerState:e})=>e.paragraph,style:{marginBottom:16}}]}))),FF={h1:"h1",h2:"h2",h3:"h3",h4:"h4",h5:"h5",h6:"h6",subtitle1:"h6",subtitle2:"h6",body1:"p",body2:"p",inherit:"p"},vs=ee.forwardRef(function(e,r){const{color:n,...i}=_i({props:e,name:"MuiTypography"}),a=!Sue[n],s=Eue({...i,...a&&{color:n}}),{align:o="inherit",className:u,component:h,gutterBottom:f=!1,noWrap:g=!1,paragraph:b=!1,variant:v="body1",variantMapping:S=FF,...E}=s,P={...s,align:o,color:n,className:u,component:h,gutterBottom:f,noWrap:g,paragraph:b,variant:v,variantMapping:S},k=h||(b?"p":S[v]||FF[v])||"span",L=Tue(P);return K.jsx(Cue,{as:k,ref:r,className:Sn(L.root,u),...E,ownerState:P,style:{...o!=="inherit"&&{"--Typography-textAlign":o},...E.style}})});function Aue(t){return fi("MuiAppBar",t)}ui("MuiAppBar",["root","positionFixed","positionAbsolute","positionSticky","positionStatic","positionRelative","colorDefault","colorPrimary","colorSecondary","colorInherit","colorTransparent","colorError","colorInfo","colorSuccess","colorWarning"]);const Iue=t=>{const{color:e,position:r,classes:n}=t,i={root:["root",`color${on(e)}`,`position${on(r)}`]};return di(i,Aue,n)},BF=(t,e)=>t?`${t?.replace(")","")}, ${e})`:e,Pue=Pr(Th,{name:"MuiAppBar",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.root,e[`position${on(r.position)}`],e[`color${on(r.color)}`]]}})(si(({theme:t})=>({display:"flex",flexDirection:"column",width:"100%",boxSizing:"border-box",flexShrink:0,variants:[{props:{position:"fixed"},style:{position:"fixed",zIndex:(t.vars||t).zIndex.appBar,top:0,left:"auto",right:0,"@media print":{position:"absolute"}}},{props:{position:"absolute"},style:{position:"absolute",zIndex:(t.vars||t).zIndex.appBar,top:0,left:"auto",right:0}},{props:{position:"sticky"},style:{position:"sticky",zIndex:(t.vars||t).zIndex.appBar,top:0,left:"auto",right:0}},{props:{position:"static"},style:{position:"static"}},{props:{position:"relative"},style:{position:"relative"}},{props:{color:"inherit"},style:{"--AppBar-color":"inherit"}},{props:{color:"default"},style:{"--AppBar-background":t.vars?t.vars.palette.AppBar.defaultBg:t.palette.grey[100],"--AppBar-color":t.vars?t.vars.palette.text.primary:t.palette.getContrastText(t.palette.grey[100]),...t.applyStyles("dark",{"--AppBar-background":t.vars?t.vars.palette.AppBar.defaultBg:t.palette.grey[900],"--AppBar-color":t.vars?t.vars.palette.text.primary:t.palette.getContrastText(t.palette.grey[900])})}},...Object.entries(t.palette).filter(Nl(["contrastText"])).map(([e])=>({props:{color:e},style:{"--AppBar-background":(t.vars??t).palette[e].main,"--AppBar-color":(t.vars??t).palette[e].contrastText}})),{props:e=>e.enableColorOnDark===!0&&!["inherit","transparent"].includes(e.color),style:{backgroundColor:"var(--AppBar-background)",color:"var(--AppBar-color)"}},{props:e=>e.enableColorOnDark===!1&&!["inherit","transparent"].includes(e.color),style:{backgroundColor:"var(--AppBar-background)",color:"var(--AppBar-color)",...t.applyStyles("dark",{backgroundColor:t.vars?BF(t.vars.palette.AppBar.darkBg,"var(--AppBar-background)"):null,color:t.vars?BF(t.vars.palette.AppBar.darkColor,"var(--AppBar-color)"):null})}},{props:{color:"transparent"},style:{"--AppBar-background":"transparent","--AppBar-color":"inherit",backgroundColor:"var(--AppBar-background)",color:"var(--AppBar-color)",...t.applyStyles("dark",{backgroundImage:"none"})}}]}))),kue=ee.forwardRef(function(e,r){const n=_i({props:e,name:"MuiAppBar"}),{className:i,color:a="primary",enableColorOnDark:s=!1,position:o="fixed",...u}=n,h={...n,color:a,position:o,enableColorOnDark:s},f=Iue(h);return K.jsx(Pue,{square:!0,component:"header",ownerState:h,elevation:4,className:Sn(f.root,i,o==="fixed"&&"mui-fixed"),ref:r,...u})});var bc="top",Ch="bottom",Ah="right",xc="left",VR="auto",qb=[bc,Ch,Ah,xc],Qv="start",Z1="end",Mue="clippingParents",rG="viewport",g_="popper",Rue="reference",zF=qb.reduce(function(t,e){return t.concat([e+"-"+Qv,e+"-"+Z1])},[]),nG=[].concat(qb,[VR]).reduce(function(t,e){return t.concat([e,e+"-"+Qv,e+"-"+Z1])},[]),Oue="beforeRead",Lue="read",Nue="afterRead",Due="beforeMain",Fue="main",Bue="afterMain",zue="beforeWrite",jue="write",Uue="afterWrite",Vue=[Oue,Lue,Nue,Due,Fue,Bue,zue,jue,Uue];function td(t){return t?(t.nodeName||"").toLowerCase():null}function th(t){if(t==null)return window;if(t.toString()!=="[object Window]"){var e=t.ownerDocument;return e&&e.defaultView||window}return t}function gm(t){var e=th(t).Element;return t instanceof e||t instanceof Element}function _h(t){var e=th(t).HTMLElement;return t instanceof e||t instanceof HTMLElement}function $R(t){if(typeof ShadowRoot>"u")return!1;var e=th(t).ShadowRoot;return t instanceof e||t instanceof ShadowRoot}function $ue(t){var e=t.state;Object.keys(e.elements).forEach(function(r){var n=e.styles[r]||{},i=e.attributes[r]||{},a=e.elements[r];!_h(a)||!td(a)||(Object.assign(a.style,n),Object.keys(i).forEach(function(s){var o=i[s];o===!1?a.removeAttribute(s):a.setAttribute(s,o===!0?"":o)}))})}function que(t){var e=t.state,r={popper:{position:e.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(e.elements.popper.style,r.popper),e.styles=r,e.elements.arrow&&Object.assign(e.elements.arrow.style,r.arrow),function(){Object.keys(e.elements).forEach(function(n){var i=e.elements[n],a=e.attributes[n]||{},s=Object.keys(e.styles.hasOwnProperty(n)?e.styles[n]:r[n]),o=s.reduce(function(u,h){return u[h]="",u},{});!_h(i)||!td(i)||(Object.assign(i.style,o),Object.keys(a).forEach(function(u){i.removeAttribute(u)}))})}}const Hue={name:"applyStyles",enabled:!0,phase:"write",fn:$ue,effect:que,requires:["computeStyles"]};function Kf(t){return t.split("-")[0]}var nm=Math.max,Xw=Math.min,e0=Math.round;function IP(){var t=navigator.userAgentData;return t!=null&&t.brands&&Array.isArray(t.brands)?t.brands.map(function(e){return e.brand+"/"+e.version}).join(" "):navigator.userAgent}function iG(){return!/^((?!chrome|android).)*safari/i.test(IP())}function t0(t,e,r){e===void 0&&(e=!1),r===void 0&&(r=!1);var n=t.getBoundingClientRect(),i=1,a=1;e&&_h(t)&&(i=t.offsetWidth>0&&e0(n.width)/t.offsetWidth||1,a=t.offsetHeight>0&&e0(n.height)/t.offsetHeight||1);var s=gm(t)?th(t):window,o=s.visualViewport,u=!iG()&&r,h=(n.left+(u&&o?o.offsetLeft:0))/i,f=(n.top+(u&&o?o.offsetTop:0))/a,g=n.width/i,b=n.height/a;return{width:g,height:b,top:f,right:h+g,bottom:f+b,left:h,x:h,y:f}}function qR(t){var e=t0(t),r=t.offsetWidth,n=t.offsetHeight;return Math.abs(e.width-r)<=1&&(r=e.width),Math.abs(e.height-n)<=1&&(n=e.height),{x:t.offsetLeft,y:t.offsetTop,width:r,height:n}}function aG(t,e){var r=e.getRootNode&&e.getRootNode();if(t.contains(e))return!0;if(r&&$R(r)){var n=e;do{if(n&&t.isSameNode(n))return!0;n=n.parentNode||n.host}while(n)}return!1}function Wd(t){return th(t).getComputedStyle(t)}function Wue(t){return["table","td","th"].indexOf(td(t))>=0}function sg(t){return((gm(t)?t.ownerDocument:t.document)||window.document).documentElement}function KE(t){return td(t)==="html"?t:t.assignedSlot||t.parentNode||($R(t)?t.host:null)||sg(t)}function jF(t){return!_h(t)||Wd(t).position==="fixed"?null:t.offsetParent}function Gue(t){var e=/firefox/i.test(IP()),r=/Trident/i.test(IP());if(r&&_h(t)){var n=Wd(t);if(n.position==="fixed")return null}var i=KE(t);for($R(i)&&(i=i.host);_h(i)&&["html","body"].indexOf(td(i))<0;){var a=Wd(i);if(a.transform!=="none"||a.perspective!=="none"||a.contain==="paint"||["transform","perspective"].indexOf(a.willChange)!==-1||e&&a.willChange==="filter"||e&&a.filter&&a.filter!=="none")return i;i=i.parentNode}return null}function Hb(t){for(var e=th(t),r=jF(t);r&&Wue(r)&&Wd(r).position==="static";)r=jF(r);return r&&(td(r)==="html"||td(r)==="body"&&Wd(r).position==="static")?e:r||Gue(t)||e}function HR(t){return["top","bottom"].indexOf(t)>=0?"x":"y"}function b1(t,e,r){return nm(t,Xw(e,r))}function Xue(t,e,r){var n=b1(t,e,r);return n>r?r:n}function oG(){return{top:0,right:0,bottom:0,left:0}}function sG(t){return Object.assign({},oG(),t)}function lG(t,e){return e.reduce(function(r,n){return r[n]=t,r},{})}var Yue=function(e,r){return e=typeof e=="function"?e(Object.assign({},r.rects,{placement:r.placement})):e,sG(typeof e!="number"?e:lG(e,qb))};function Zue(t){var e,r=t.state,n=t.name,i=t.options,a=r.elements.arrow,s=r.modifiersData.popperOffsets,o=Kf(r.placement),u=HR(o),h=[xc,Ah].indexOf(o)>=0,f=h?"height":"width";if(!(!a||!s)){var g=Yue(i.padding,r),b=qR(a),v=u==="y"?bc:xc,S=u==="y"?Ch:Ah,E=r.rects.reference[f]+r.rects.reference[u]-s[u]-r.rects.popper[f],P=s[u]-r.rects.reference[u],k=Hb(a),L=k?u==="y"?k.clientHeight||0:k.clientWidth||0:0,O=E/2-P/2,M=g[v],z=L-b[f]-g[S],B=L/2-b[f]/2+O,q=b1(M,B,z),W=u;r.modifiersData[n]=(e={},e[W]=q,e.centerOffset=q-B,e)}}function Kue(t){var e=t.state,r=t.options,n=r.element,i=n===void 0?"[data-popper-arrow]":n;i!=null&&(typeof i=="string"&&(i=e.elements.popper.querySelector(i),!i)||aG(e.elements.popper,i)&&(e.elements.arrow=i))}const Jue={name:"arrow",enabled:!0,phase:"main",fn:Zue,effect:Kue,requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function r0(t){return t.split("-")[1]}var Que={top:"auto",right:"auto",bottom:"auto",left:"auto"};function ece(t,e){var r=t.x,n=t.y,i=e.devicePixelRatio||1;return{x:e0(r*i)/i||0,y:e0(n*i)/i||0}}function UF(t){var e,r=t.popper,n=t.popperRect,i=t.placement,a=t.variation,s=t.offsets,o=t.position,u=t.gpuAcceleration,h=t.adaptive,f=t.roundOffsets,g=t.isFixed,b=s.x,v=b===void 0?0:b,S=s.y,E=S===void 0?0:S,P=typeof f=="function"?f({x:v,y:E}):{x:v,y:E};v=P.x,E=P.y;var k=s.hasOwnProperty("x"),L=s.hasOwnProperty("y"),O=xc,M=bc,z=window;if(h){var B=Hb(r),q="clientHeight",W="clientWidth";if(B===th(r)&&(B=sg(r),Wd(B).position!=="static"&&o==="absolute"&&(q="scrollHeight",W="scrollWidth")),B=B,i===bc||(i===xc||i===Ah)&&a===Z1){M=Ch;var G=g&&B===z&&z.visualViewport?z.visualViewport.height:B[q];E-=G-n.height,E*=u?1:-1}if(i===xc||(i===bc||i===Ch)&&a===Z1){O=Ah;var ie=g&&B===z&&z.visualViewport?z.visualViewport.width:B[W];v-=ie-n.width,v*=u?1:-1}}var Q=Object.assign({position:o},h&&Que),H=f===!0?ece({x:v,y:E},th(r)):{x:v,y:E};if(v=H.x,E=H.y,u){var ne;return Object.assign({},Q,(ne={},ne[M]=L?"0":"",ne[O]=k?"0":"",ne.transform=(z.devicePixelRatio||1)<=1?"translate("+v+"px, "+E+"px)":"translate3d("+v+"px, "+E+"px, 0)",ne))}return Object.assign({},Q,(e={},e[M]=L?E+"px":"",e[O]=k?v+"px":"",e.transform="",e))}function tce(t){var e=t.state,r=t.options,n=r.gpuAcceleration,i=n===void 0?!0:n,a=r.adaptive,s=a===void 0?!0:a,o=r.roundOffsets,u=o===void 0?!0:o,h={placement:Kf(e.placement),variation:r0(e.placement),popper:e.elements.popper,popperRect:e.rects.popper,gpuAcceleration:i,isFixed:e.options.strategy==="fixed"};e.modifiersData.popperOffsets!=null&&(e.styles.popper=Object.assign({},e.styles.popper,UF(Object.assign({},h,{offsets:e.modifiersData.popperOffsets,position:e.options.strategy,adaptive:s,roundOffsets:u})))),e.modifiersData.arrow!=null&&(e.styles.arrow=Object.assign({},e.styles.arrow,UF(Object.assign({},h,{offsets:e.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:u})))),e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-placement":e.placement})}const rce={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:tce,data:{}};var Vx={passive:!0};function nce(t){var e=t.state,r=t.instance,n=t.options,i=n.scroll,a=i===void 0?!0:i,s=n.resize,o=s===void 0?!0:s,u=th(e.elements.popper),h=[].concat(e.scrollParents.reference,e.scrollParents.popper);return a&&h.forEach(function(f){f.addEventListener("scroll",r.update,Vx)}),o&&u.addEventListener("resize",r.update,Vx),function(){a&&h.forEach(function(f){f.removeEventListener("scroll",r.update,Vx)}),o&&u.removeEventListener("resize",r.update,Vx)}}const ice={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:nce,data:{}};var ace={left:"right",right:"left",bottom:"top",top:"bottom"};function cw(t){return t.replace(/left|right|bottom|top/g,function(e){return ace[e]})}var oce={start:"end",end:"start"};function VF(t){return t.replace(/start|end/g,function(e){return oce[e]})}function WR(t){var e=th(t),r=e.pageXOffset,n=e.pageYOffset;return{scrollLeft:r,scrollTop:n}}function GR(t){return t0(sg(t)).left+WR(t).scrollLeft}function sce(t,e){var r=th(t),n=sg(t),i=r.visualViewport,a=n.clientWidth,s=n.clientHeight,o=0,u=0;if(i){a=i.width,s=i.height;var h=iG();(h||!h&&e==="fixed")&&(o=i.offsetLeft,u=i.offsetTop)}return{width:a,height:s,x:o+GR(t),y:u}}function lce(t){var e,r=sg(t),n=WR(t),i=(e=t.ownerDocument)==null?void 0:e.body,a=nm(r.scrollWidth,r.clientWidth,i?i.scrollWidth:0,i?i.clientWidth:0),s=nm(r.scrollHeight,r.clientHeight,i?i.scrollHeight:0,i?i.clientHeight:0),o=-n.scrollLeft+GR(t),u=-n.scrollTop;return Wd(i||r).direction==="rtl"&&(o+=nm(r.clientWidth,i?i.clientWidth:0)-a),{width:a,height:s,x:o,y:u}}function XR(t){var e=Wd(t),r=e.overflow,n=e.overflowX,i=e.overflowY;return/auto|scroll|overlay|hidden/.test(r+i+n)}function uG(t){return["html","body","#document"].indexOf(td(t))>=0?t.ownerDocument.body:_h(t)&&XR(t)?t:uG(KE(t))}function x1(t,e){var r;e===void 0&&(e=[]);var n=uG(t),i=n===((r=t.ownerDocument)==null?void 0:r.body),a=th(n),s=i?[a].concat(a.visualViewport||[],XR(n)?n:[]):n,o=e.concat(s);return i?o:o.concat(x1(KE(s)))}function PP(t){return Object.assign({},t,{left:t.x,top:t.y,right:t.x+t.width,bottom:t.y+t.height})}function uce(t,e){var r=t0(t,!1,e==="fixed");return r.top=r.top+t.clientTop,r.left=r.left+t.clientLeft,r.bottom=r.top+t.clientHeight,r.right=r.left+t.clientWidth,r.width=t.clientWidth,r.height=t.clientHeight,r.x=r.left,r.y=r.top,r}function $F(t,e,r){return e===rG?PP(sce(t,r)):gm(e)?uce(e,r):PP(lce(sg(t)))}function cce(t){var e=x1(KE(t)),r=["absolute","fixed"].indexOf(Wd(t).position)>=0,n=r&&_h(t)?Hb(t):t;return gm(n)?e.filter(function(i){return gm(i)&&aG(i,n)&&td(i)!=="body"}):[]}function hce(t,e,r,n){var i=e==="clippingParents"?cce(t):[].concat(e),a=[].concat(i,[r]),s=a[0],o=a.reduce(function(u,h){var f=$F(t,h,n);return u.top=nm(f.top,u.top),u.right=Xw(f.right,u.right),u.bottom=Xw(f.bottom,u.bottom),u.left=nm(f.left,u.left),u},$F(t,s,n));return o.width=o.right-o.left,o.height=o.bottom-o.top,o.x=o.left,o.y=o.top,o}function cG(t){var e=t.reference,r=t.element,n=t.placement,i=n?Kf(n):null,a=n?r0(n):null,s=e.x+e.width/2-r.width/2,o=e.y+e.height/2-r.height/2,u;switch(i){case bc:u={x:s,y:e.y-r.height};break;case Ch:u={x:s,y:e.y+e.height};break;case Ah:u={x:e.x+e.width,y:o};break;case xc:u={x:e.x-r.width,y:o};break;default:u={x:e.x,y:e.y}}var h=i?HR(i):null;if(h!=null){var f=h==="y"?"height":"width";switch(a){case Qv:u[h]=u[h]-(e[f]/2-r[f]/2);break;case Z1:u[h]=u[h]+(e[f]/2-r[f]/2);break}}return u}function K1(t,e){e===void 0&&(e={});var r=e,n=r.placement,i=n===void 0?t.placement:n,a=r.strategy,s=a===void 0?t.strategy:a,o=r.boundary,u=o===void 0?Mue:o,h=r.rootBoundary,f=h===void 0?rG:h,g=r.elementContext,b=g===void 0?g_:g,v=r.altBoundary,S=v===void 0?!1:v,E=r.padding,P=E===void 0?0:E,k=sG(typeof P!="number"?P:lG(P,qb)),L=b===g_?Rue:g_,O=t.rects.popper,M=t.elements[S?L:b],z=hce(gm(M)?M:M.contextElement||sg(t.elements.popper),u,f,s),B=t0(t.elements.reference),q=cG({reference:B,element:O,placement:i}),W=PP(Object.assign({},O,q)),G=b===g_?W:B,ie={top:z.top-G.top+k.top,bottom:G.bottom-z.bottom+k.bottom,left:z.left-G.left+k.left,right:G.right-z.right+k.right},Q=t.modifiersData.offset;if(b===g_&&Q){var H=Q[i];Object.keys(ie).forEach(function(ne){var oe=[Ah,Ch].indexOf(ne)>=0?1:-1,ce=[bc,Ch].indexOf(ne)>=0?"y":"x";ie[ne]+=H[ce]*oe})}return ie}function fce(t,e){e===void 0&&(e={});var r=e,n=r.placement,i=r.boundary,a=r.rootBoundary,s=r.padding,o=r.flipVariations,u=r.allowedAutoPlacements,h=u===void 0?nG:u,f=r0(n),g=f?o?zF:zF.filter(function(S){return r0(S)===f}):qb,b=g.filter(function(S){return h.indexOf(S)>=0});b.length===0&&(b=g);var v=b.reduce(function(S,E){return S[E]=K1(t,{placement:E,boundary:i,rootBoundary:a,padding:s})[Kf(E)],S},{});return Object.keys(v).sort(function(S,E){return v[S]-v[E]})}function dce(t){if(Kf(t)===VR)return[];var e=cw(t);return[VF(t),e,VF(e)]}function pce(t){var e=t.state,r=t.options,n=t.name;if(!e.modifiersData[n]._skip){for(var i=r.mainAxis,a=i===void 0?!0:i,s=r.altAxis,o=s===void 0?!0:s,u=r.fallbackPlacements,h=r.padding,f=r.boundary,g=r.rootBoundary,b=r.altBoundary,v=r.flipVariations,S=v===void 0?!0:v,E=r.allowedAutoPlacements,P=e.options.placement,k=Kf(P),L=k===P,O=u||(L||!S?[cw(P)]:dce(P)),M=[P].concat(O).reduce(function(xe,Ne){return xe.concat(Kf(Ne)===VR?fce(e,{placement:Ne,boundary:f,rootBoundary:g,padding:h,flipVariations:S,allowedAutoPlacements:E}):Ne)},[]),z=e.rects.reference,B=e.rects.popper,q=new Map,W=!0,G=M[0],ie=0;ie<M.length;ie++){var Q=M[ie],H=Kf(Q),ne=r0(Q)===Qv,oe=[bc,Ch].indexOf(H)>=0,ce=oe?"width":"height",fe=K1(e,{placement:Q,boundary:f,rootBoundary:g,altBoundary:b,padding:h}),Me=oe?ne?Ah:xc:ne?Ch:bc;z[ce]>B[ce]&&(Me=cw(Me));var me=cw(Me),we=[];if(a&&we.push(fe[H]<=0),o&&we.push(fe[Me]<=0,fe[me]<=0),we.every(function(xe){return xe})){G=Q,W=!1;break}q.set(Q,we)}if(W)for(var Te=S?3:1,ke=function(Ne){var Oe=M.find(function($e){var De=q.get($e);if(De)return De.slice(0,Ne).every(function(it){return it})});if(Oe)return G=Oe,"break"},he=Te;he>0;he--){var Ee=ke(he);if(Ee==="break")break}e.placement!==G&&(e.modifiersData[n]._skip=!0,e.placement=G,e.reset=!0)}}const gce={name:"flip",enabled:!0,phase:"main",fn:pce,requiresIfExists:["offset"],data:{_skip:!1}};function qF(t,e,r){return r===void 0&&(r={x:0,y:0}),{top:t.top-e.height-r.y,right:t.right-e.width+r.x,bottom:t.bottom-e.height+r.y,left:t.left-e.width-r.x}}function HF(t){return[bc,Ah,Ch,xc].some(function(e){return t[e]>=0})}function mce(t){var e=t.state,r=t.name,n=e.rects.reference,i=e.rects.popper,a=e.modifiersData.preventOverflow,s=K1(e,{elementContext:"reference"}),o=K1(e,{altBoundary:!0}),u=qF(s,n),h=qF(o,i,a),f=HF(u),g=HF(h);e.modifiersData[r]={referenceClippingOffsets:u,popperEscapeOffsets:h,isReferenceHidden:f,hasPopperEscaped:g},e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-reference-hidden":f,"data-popper-escaped":g})}const yce={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:mce};function vce(t,e,r){var n=Kf(t),i=[xc,bc].indexOf(n)>=0?-1:1,a=typeof r=="function"?r(Object.assign({},e,{placement:t})):r,s=a[0],o=a[1];return s=s||0,o=(o||0)*i,[xc,Ah].indexOf(n)>=0?{x:o,y:s}:{x:s,y:o}}function _ce(t){var e=t.state,r=t.options,n=t.name,i=r.offset,a=i===void 0?[0,0]:i,s=nG.reduce(function(f,g){return f[g]=vce(g,e.rects,a),f},{}),o=s[e.placement],u=o.x,h=o.y;e.modifiersData.popperOffsets!=null&&(e.modifiersData.popperOffsets.x+=u,e.modifiersData.popperOffsets.y+=h),e.modifiersData[n]=s}const bce={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:_ce};function xce(t){var e=t.state,r=t.name;e.modifiersData[r]=cG({reference:e.rects.reference,element:e.rects.popper,placement:e.placement})}const wce={name:"popperOffsets",enabled:!0,phase:"read",fn:xce,data:{}};function Sce(t){return t==="x"?"y":"x"}function Ece(t){var e=t.state,r=t.options,n=t.name,i=r.mainAxis,a=i===void 0?!0:i,s=r.altAxis,o=s===void 0?!1:s,u=r.boundary,h=r.rootBoundary,f=r.altBoundary,g=r.padding,b=r.tether,v=b===void 0?!0:b,S=r.tetherOffset,E=S===void 0?0:S,P=K1(e,{boundary:u,rootBoundary:h,padding:g,altBoundary:f}),k=Kf(e.placement),L=r0(e.placement),O=!L,M=HR(k),z=Sce(M),B=e.modifiersData.popperOffsets,q=e.rects.reference,W=e.rects.popper,G=typeof E=="function"?E(Object.assign({},e.rects,{placement:e.placement})):E,ie=typeof G=="number"?{mainAxis:G,altAxis:G}:Object.assign({mainAxis:0,altAxis:0},G),Q=e.modifiersData.offset?e.modifiersData.offset[e.placement]:null,H={x:0,y:0};if(B){if(a){var ne,oe=M==="y"?bc:xc,ce=M==="y"?Ch:Ah,fe=M==="y"?"height":"width",Me=B[M],me=Me+P[oe],we=Me-P[ce],Te=v?-W[fe]/2:0,ke=L===Qv?q[fe]:W[fe],he=L===Qv?-W[fe]:-q[fe],Ee=e.elements.arrow,xe=v&&Ee?qR(Ee):{width:0,height:0},Ne=e.modifiersData["arrow#persistent"]?e.modifiersData["arrow#persistent"].padding:oG(),Oe=Ne[oe],$e=Ne[ce],De=b1(0,q[fe],xe[fe]),it=O?q[fe]/2-Te-De-Oe-ie.mainAxis:ke-De-Oe-ie.mainAxis,Ye=O?-q[fe]/2+Te+De+$e+ie.mainAxis:he+De+$e+ie.mainAxis,rt=e.elements.arrow&&Hb(e.elements.arrow),Ie=rt?M==="y"?rt.clientTop||0:rt.clientLeft||0:0,Mt=(ne=Q?.[M])!=null?ne:0,at=Me+it-Mt-Ie,je=Me+Ye-Mt,Xt=b1(v?Xw(me,at):me,Me,v?nm(we,je):we);B[M]=Xt,H[M]=Xt-Me}if(o){var Yt,pr=M==="x"?bc:xc,vt=M==="x"?Ch:Ah,yr=B[z],_r=z==="y"?"height":"width",cr=yr+P[pr],Er=yr-P[vt],wr=[bc,xc].indexOf(k)!==-1,er=(Yt=Q?.[z])!=null?Yt:0,lr=wr?cr:yr-q[_r]-W[_r]-er+ie.altAxis,Ar=wr?yr+q[_r]+W[_r]-er-ie.altAxis:Er,ir=v&&wr?Xue(lr,yr,Ar):b1(v?lr:cr,yr,v?Ar:Er);B[z]=ir,H[z]=ir-yr}e.modifiersData[n]=H}}const Tce={name:"preventOverflow",enabled:!0,phase:"main",fn:Ece,requiresIfExists:["offset"]};function Cce(t){return{scrollLeft:t.scrollLeft,scrollTop:t.scrollTop}}function Ace(t){return t===th(t)||!_h(t)?WR(t):Cce(t)}function Ice(t){var e=t.getBoundingClientRect(),r=e0(e.width)/t.offsetWidth||1,n=e0(e.height)/t.offsetHeight||1;return r!==1||n!==1}function Pce(t,e,r){r===void 0&&(r=!1);var n=_h(e),i=_h(e)&&Ice(e),a=sg(e),s=t0(t,i,r),o={scrollLeft:0,scrollTop:0},u={x:0,y:0};return(n||!n&&!r)&&((td(e)!=="body"||XR(a))&&(o=Ace(e)),_h(e)?(u=t0(e,!0),u.x+=e.clientLeft,u.y+=e.clientTop):a&&(u.x=GR(a))),{x:s.left+o.scrollLeft-u.x,y:s.top+o.scrollTop-u.y,width:s.width,height:s.height}}function kce(t){var e=new Map,r=new Set,n=[];t.forEach(function(a){e.set(a.name,a)});function i(a){r.add(a.name);var s=[].concat(a.requires||[],a.requiresIfExists||[]);s.forEach(function(o){if(!r.has(o)){var u=e.get(o);u&&i(u)}}),n.push(a)}return t.forEach(function(a){r.has(a.name)||i(a)}),n}function Mce(t){var e=kce(t);return Vue.reduce(function(r,n){return r.concat(e.filter(function(i){return i.phase===n}))},[])}function Rce(t){var e;return function(){return e||(e=new Promise(function(r){Promise.resolve().then(function(){e=void 0,r(t())})})),e}}function Oce(t){var e=t.reduce(function(r,n){var i=r[n.name];return r[n.name]=i?Object.assign({},i,n,{options:Object.assign({},i.options,n.options),data:Object.assign({},i.data,n.data)}):n,r},{});return Object.keys(e).map(function(r){return e[r]})}var WF={placement:"bottom",modifiers:[],strategy:"absolute"};function GF(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];return!e.some(function(n){return!(n&&typeof n.getBoundingClientRect=="function")})}function Lce(t){t===void 0&&(t={});var e=t,r=e.defaultModifiers,n=r===void 0?[]:r,i=e.defaultOptions,a=i===void 0?WF:i;return function(o,u,h){h===void 0&&(h=a);var f={placement:"bottom",orderedModifiers:[],options:Object.assign({},WF,a),modifiersData:{},elements:{reference:o,popper:u},attributes:{},styles:{}},g=[],b=!1,v={state:f,setOptions:function(k){var L=typeof k=="function"?k(f.options):k;E(),f.options=Object.assign({},a,f.options,L),f.scrollParents={reference:gm(o)?x1(o):o.contextElement?x1(o.contextElement):[],popper:x1(u)};var O=Mce(Oce([].concat(n,f.options.modifiers)));return f.orderedModifiers=O.filter(function(M){return M.enabled}),S(),v.update()},forceUpdate:function(){if(!b){var k=f.elements,L=k.reference,O=k.popper;if(GF(L,O)){f.rects={reference:Pce(L,Hb(O),f.options.strategy==="fixed"),popper:qR(O)},f.reset=!1,f.placement=f.options.placement,f.orderedModifiers.forEach(function(ie){return f.modifiersData[ie.name]=Object.assign({},ie.data)});for(var M=0;M<f.orderedModifiers.length;M++){if(f.reset===!0){f.reset=!1,M=-1;continue}var z=f.orderedModifiers[M],B=z.fn,q=z.options,W=q===void 0?{}:q,G=z.name;typeof B=="function"&&(f=B({state:f,options:W,name:G,instance:v})||f)}}}},update:Rce(function(){return new Promise(function(P){v.forceUpdate(),P(f)})}),destroy:function(){E(),b=!0}};if(!GF(o,u))return v;v.setOptions(h).then(function(P){!b&&h.onFirstUpdate&&h.onFirstUpdate(P)});function S(){f.orderedModifiers.forEach(function(P){var k=P.name,L=P.options,O=L===void 0?{}:L,M=P.effect;if(typeof M=="function"){var z=M({state:f,name:k,instance:v,options:O}),B=function(){};g.push(z||B)}})}function E(){g.forEach(function(P){return P()}),g=[]}return v}}var Nce=[ice,wce,rce,Hue,bce,gce,Tce,Jue,yce],Dce=Lce({defaultModifiers:Nce});function zf(t){const{elementType:e,externalSlotProps:r,ownerState:n,skipResolvingSlotProps:i=!1,...a}=t,s=i?{}:eG(r,n),{props:o,internalRef:u}=tG({...a,externalSlotProps:s}),h=Lo(u,s?.ref,t.additionalProps?.ref);return QW(e,{...o,ref:h},n)}function lg(t){return parseInt(ee.version,10)>=19?t?.props?.ref||null:t?.ref||null}function Fce(t){return typeof t=="function"?t():t}const hG=ee.forwardRef(function(e,r){const{children:n,container:i,disablePortal:a=!1}=e,[s,o]=ee.useState(null),u=Lo(ee.isValidElement(n)?lg(n):null,r);if(yu(()=>{a||o(Fce(i)||document.body)},[i,a]),yu(()=>{if(s&&!a)return MF(r,s),()=>{MF(r,null)}},[r,s,a]),a){if(ee.isValidElement(n)){const h={ref:u};return ee.cloneElement(n,h)}return n}return s&&Nd.createPortal(n,s)});function Bce(t){return fi("MuiPopper",t)}ui("MuiPopper",["root"]);function zce(t,e){if(e==="ltr")return t;switch(t){case"bottom-end":return"bottom-start";case"bottom-start":return"bottom-end";case"top-end":return"top-start";case"top-start":return"top-end";default:return t}}function kP(t){return typeof t=="function"?t():t}function jce(t){return t.nodeType!==void 0}const Uce=t=>{const{classes:e}=t;return di({root:["root"]},Bce,e)},Vce={},$ce=ee.forwardRef(function(e,r){const{anchorEl:n,children:i,direction:a,disablePortal:s,modifiers:o,open:u,placement:h,popperOptions:f,popperRef:g,slotProps:b={},slots:v={},TransitionProps:S,ownerState:E,...P}=e,k=ee.useRef(null),L=Lo(k,r),O=ee.useRef(null),M=Lo(O,g),z=ee.useRef(M);yu(()=>{z.current=M},[M]),ee.useImperativeHandle(g,()=>O.current,[]);const B=zce(h,a),[q,W]=ee.useState(B),[G,ie]=ee.useState(kP(n));ee.useEffect(()=>{O.current&&O.current.forceUpdate()}),ee.useEffect(()=>{n&&ie(kP(n))},[n]),yu(()=>{if(!G||!u)return;const ce=me=>{W(me.placement)};let fe=[{name:"preventOverflow",options:{altBoundary:s}},{name:"flip",options:{altBoundary:s}},{name:"onUpdate",enabled:!0,phase:"afterWrite",fn:({state:me})=>{ce(me)}}];o!=null&&(fe=fe.concat(o)),f&&f.modifiers!=null&&(fe=fe.concat(f.modifiers));const Me=Dce(G,k.current,{placement:B,...f,modifiers:fe});return z.current(Me),()=>{Me.destroy(),z.current(null)}},[G,s,o,u,f,B]);const Q={placement:q};S!==null&&(Q.TransitionProps=S);const H=Uce(e),ne=v.root??"div",oe=zf({elementType:ne,externalSlotProps:b.root,externalForwardedProps:P,additionalProps:{role:"tooltip",ref:L},ownerState:e,className:H.root});return K.jsx(ne,{...oe,children:typeof i=="function"?i(Q):i})}),qce=ee.forwardRef(function(e,r){const{anchorEl:n,children:i,container:a,direction:s="ltr",disablePortal:o=!1,keepMounted:u=!1,modifiers:h,open:f,placement:g="bottom",popperOptions:b=Vce,popperRef:v,style:S,transition:E=!1,slotProps:P={},slots:k={},...L}=e,[O,M]=ee.useState(!0),z=()=>{M(!1)},B=()=>{M(!0)};if(!u&&!f&&(!E||O))return null;let q;if(a)q=a;else if(n){const ie=kP(n);q=ie&&jce(ie)?os(ie).body:os(null).body}const W=!f&&u&&(!E||O)?"none":void 0,G=E?{in:f,onEnter:z,onExited:B}:void 0;return K.jsx(hG,{disablePortal:o,container:q,children:K.jsx($ce,{anchorEl:n,direction:s,disablePortal:o,modifiers:h,ref:r,open:E?!O:f,placement:g,popperOptions:b,popperRef:v,slotProps:P,slots:k,...L,style:{position:"fixed",top:0,left:0,display:W,...S},TransitionProps:G,children:i})})}),Hce=Pr(qce,{name:"MuiPopper",slot:"Root"})({}),fG=ee.forwardRef(function(e,r){const n=$b(),i=_i({props:e,name:"MuiPopper"}),{anchorEl:a,component:s,components:o,componentsProps:u,container:h,disablePortal:f,keepMounted:g,modifiers:b,open:v,placement:S,popperOptions:E,popperRef:P,transition:k,slots:L,slotProps:O,...M}=i,z=L?.root??o?.Root,B={anchorEl:a,container:h,disablePortal:f,keepMounted:g,modifiers:b,open:v,placement:S,popperOptions:E,popperRef:P,transition:k,...M};return K.jsx(Hce,{as:s,direction:n?"rtl":"ltr",slots:{root:z},slotProps:O??u,...B,ref:r})});function $x(t){return parseInt(t,10)||0}const Wce={shadow:{visibility:"hidden",position:"absolute",overflow:"hidden",height:0,top:0,left:0,transform:"translateZ(0)"}};function Gce(t){for(const e in t)return!1;return!0}function XF(t){return Gce(t)||t.outerHeightStyle===0&&!t.overflowing}const Xce=ee.forwardRef(function(e,r){const{onChange:n,maxRows:i,minRows:a=1,style:s,value:o,...u}=e,{current:h}=ee.useRef(o!=null),f=ee.useRef(null),g=Lo(r,f),b=ee.useRef(null),v=ee.useRef(null),S=ee.useCallback(()=>{const O=f.current,M=v.current;if(!O||!M)return;const B=sc(O).getComputedStyle(O);if(B.width==="0px")return{outerHeightStyle:0,overflowing:!1};M.style.width=B.width,M.value=O.value||e.placeholder||"x",M.value.slice(-1)===`
`&&(M.value+=" ");const q=B.boxSizing,W=$x(B.paddingBottom)+$x(B.paddingTop),G=$x(B.borderBottomWidth)+$x(B.borderTopWidth),ie=M.scrollHeight;M.value="x";const Q=M.scrollHeight;let H=ie;a&&(H=Math.max(Number(a)*Q,H)),i&&(H=Math.min(Number(i)*Q,H)),H=Math.max(H,Q);const ne=H+(q==="border-box"?W+G:0),oe=Math.abs(H-ie)<=1;return{outerHeightStyle:ne,overflowing:oe}},[i,a,e.placeholder]),E=Ql(()=>{const O=f.current,M=S();if(!O||!M||XF(M))return!1;const z=M.outerHeightStyle;return b.current!=null&&b.current!==z}),P=ee.useCallback(()=>{const O=f.current,M=S();if(!O||!M||XF(M))return;const z=M.outerHeightStyle;b.current!==z&&(b.current=z,O.style.height=`${z}px`),O.style.overflow=M.overflowing?"hidden":""},[S]),k=ee.useRef(-1);yu(()=>{const O=BR(P),M=f?.current;if(!M)return;const z=sc(M);z.addEventListener("resize",O);let B;return typeof ResizeObserver<"u"&&(B=new ResizeObserver(()=>{E()&&(B.unobserve(M),cancelAnimationFrame(k.current),P(),k.current=requestAnimationFrame(()=>{B.observe(M)}))}),B.observe(M)),()=>{O.clear(),cancelAnimationFrame(k.current),z.removeEventListener("resize",O),B&&B.disconnect()}},[S,P,E]),yu(()=>{P()});const L=O=>{h||P();const M=O.target,z=M.value.length,B=M.value.endsWith(`
`),q=M.selectionStart===z;B&&q&&M.setSelectionRange(z,z),n&&n(O)};return K.jsxs(ee.Fragment,{children:[K.jsx("textarea",{value:o,onChange:L,ref:g,rows:a,style:s,...u}),K.jsx("textarea",{"aria-hidden":!0,className:e.className,readOnly:!0,ref:v,tabIndex:-1,style:{...Wce.shadow,...s,paddingTop:0,paddingBottom:0}})]})});function ug({props:t,states:e,muiFormControl:r}){return e.reduce((n,i)=>(n[i]=t[i],r&&typeof t[i]>"u"&&(n[i]=r[i]),n),{})}const YR=ee.createContext(void 0);function sd(){return ee.useContext(YR)}function YF(t){return t!=null&&!(Array.isArray(t)&&t.length===0)}function Yw(t,e=!1){return t&&(YF(t.value)&&t.value!==""||e&&YF(t.defaultValue)&&t.defaultValue!=="")}function Yce(t){return t.startAdornment}function Zce(t){return fi("MuiInputBase",t)}const n0=ui("MuiInputBase",["root","formControl","focused","disabled","adornedStart","adornedEnd","error","sizeSmall","multiline","colorSecondary","fullWidth","hiddenLabel","readOnly","input","inputSizeSmall","inputMultiline","inputTypeSearch","inputAdornedStart","inputAdornedEnd","inputHiddenLabel"]);var ZF;const JE=(t,e)=>{const{ownerState:r}=t;return[e.root,r.formControl&&e.formControl,r.startAdornment&&e.adornedStart,r.endAdornment&&e.adornedEnd,r.error&&e.error,r.size==="small"&&e.sizeSmall,r.multiline&&e.multiline,r.color&&e[`color${on(r.color)}`],r.fullWidth&&e.fullWidth,r.hiddenLabel&&e.hiddenLabel]},QE=(t,e)=>{const{ownerState:r}=t;return[e.input,r.size==="small"&&e.inputSizeSmall,r.multiline&&e.inputMultiline,r.type==="search"&&e.inputTypeSearch,r.startAdornment&&e.inputAdornedStart,r.endAdornment&&e.inputAdornedEnd,r.hiddenLabel&&e.inputHiddenLabel]},Kce=t=>{const{classes:e,color:r,disabled:n,error:i,endAdornment:a,focused:s,formControl:o,fullWidth:u,hiddenLabel:h,multiline:f,readOnly:g,size:b,startAdornment:v,type:S}=t,E={root:["root",`color${on(r)}`,n&&"disabled",i&&"error",u&&"fullWidth",s&&"focused",o&&"formControl",b&&b!=="medium"&&`size${on(b)}`,f&&"multiline",v&&"adornedStart",a&&"adornedEnd",h&&"hiddenLabel",g&&"readOnly"],input:["input",n&&"disabled",S==="search"&&"inputTypeSearch",f&&"inputMultiline",b==="small"&&"inputSizeSmall",h&&"inputHiddenLabel",v&&"inputAdornedStart",a&&"inputAdornedEnd",g&&"readOnly"]};return di(E,Zce,e)},eT=Pr("div",{name:"MuiInputBase",slot:"Root",overridesResolver:JE})(si(({theme:t})=>({...t.typography.body1,color:(t.vars||t).palette.text.primary,lineHeight:"1.4375em",boxSizing:"border-box",position:"relative",cursor:"text",display:"inline-flex",alignItems:"center",[`&.${n0.disabled}`]:{color:(t.vars||t).palette.text.disabled,cursor:"default"},variants:[{props:({ownerState:e})=>e.multiline,style:{padding:"4px 0 5px"}},{props:({ownerState:e,size:r})=>e.multiline&&r==="small",style:{paddingTop:1}},{props:({ownerState:e})=>e.fullWidth,style:{width:"100%"}}]}))),tT=Pr("input",{name:"MuiInputBase",slot:"Input",overridesResolver:QE})(si(({theme:t})=>{const e=t.palette.mode==="light",r={color:"currentColor",...t.vars?{opacity:t.vars.opacity.inputPlaceholder}:{opacity:e?.42:.5},transition:t.transitions.create("opacity",{duration:t.transitions.duration.shorter})},n={opacity:"0 !important"},i=t.vars?{opacity:t.vars.opacity.inputPlaceholder}:{opacity:e?.42:.5};return{font:"inherit",letterSpacing:"inherit",color:"currentColor",padding:"4px 0 5px",border:0,boxSizing:"content-box",background:"none",height:"1.4375em",margin:0,WebkitTapHighlightColor:"transparent",display:"block",minWidth:0,width:"100%","&::-webkit-input-placeholder":r,"&::-moz-placeholder":r,"&::-ms-input-placeholder":r,"&:focus":{outline:0},"&:invalid":{boxShadow:"none"},"&::-webkit-search-decoration":{WebkitAppearance:"none"},[`label[data-shrink=false] + .${n0.formControl} &`]:{"&::-webkit-input-placeholder":n,"&::-moz-placeholder":n,"&::-ms-input-placeholder":n,"&:focus::-webkit-input-placeholder":i,"&:focus::-moz-placeholder":i,"&:focus::-ms-input-placeholder":i},[`&.${n0.disabled}`]:{opacity:1,WebkitTextFillColor:(t.vars||t).palette.text.disabled},variants:[{props:({ownerState:a})=>!a.disableInjectingGlobalStyles,style:{animationName:"mui-auto-fill-cancel",animationDuration:"10ms","&:-webkit-autofill":{animationDuration:"5000s",animationName:"mui-auto-fill"}}},{props:{size:"small"},style:{paddingTop:1}},{props:({ownerState:a})=>a.multiline,style:{height:"auto",resize:"none",padding:0,paddingTop:0}},{props:{type:"search"},style:{MozAppearance:"textfield"}}]}})),KF=ple({"@keyframes mui-auto-fill":{from:{display:"block"}},"@keyframes mui-auto-fill-cancel":{from:{display:"block"}}}),ZR=ee.forwardRef(function(e,r){const n=_i({props:e,name:"MuiInputBase"}),{"aria-describedby":i,autoComplete:a,autoFocus:s,className:o,color:u,components:h={},componentsProps:f={},defaultValue:g,disabled:b,disableInjectingGlobalStyles:v,endAdornment:S,error:E,fullWidth:P=!1,id:k,inputComponent:L="input",inputProps:O={},inputRef:M,margin:z,maxRows:B,minRows:q,multiline:W=!1,name:G,onBlur:ie,onChange:Q,onClick:H,onFocus:ne,onKeyDown:oe,onKeyUp:ce,placeholder:fe,readOnly:Me,renderSuffix:me,rows:we,size:Te,slotProps:ke={},slots:he={},startAdornment:Ee,type:xe="text",value:Ne,...Oe}=n,$e=O.value!=null?O.value:Ne,{current:De}=ee.useRef($e!=null),it=ee.useRef(),Ye=ee.useCallback(be=>{},[]),rt=Lo(it,M,O.ref,Ye),[Ie,Mt]=ee.useState(!1),at=sd(),je=ug({props:n,muiFormControl:at,states:["color","disabled","error","hiddenLabel","size","required","filled"]});je.focused=at?at.focused:Ie,ee.useEffect(()=>{!at&&b&&Ie&&(Mt(!1),ie&&ie())},[at,b,Ie,ie]);const Xt=at&&at.onFilled,Yt=at&&at.onEmpty,pr=ee.useCallback(be=>{Yw(be)?Xt&&Xt():Yt&&Yt()},[Xt,Yt]);yu(()=>{De&&pr({value:$e})},[$e,pr,De]);const vt=be=>{ne&&ne(be),O.onFocus&&O.onFocus(be),at&&at.onFocus?at.onFocus(be):Mt(!0)},yr=be=>{ie&&ie(be),O.onBlur&&O.onBlur(be),at&&at.onBlur?at.onBlur(be):Mt(!1)},_r=(be,...qe)=>{if(!De){const Qe=be.target||it.current;if(Qe==null)throw new Error($d(1));pr({value:Qe.value})}O.onChange&&O.onChange(be,...qe),Q&&Q(be,...qe)};ee.useEffect(()=>{pr(it.current)},[]);const cr=be=>{it.current&&be.currentTarget===be.target&&it.current.focus(),H&&H(be)};let Er=L,wr=O;W&&Er==="input"&&(we?wr={type:void 0,minRows:we,maxRows:we,...wr}:wr={type:void 0,maxRows:B,minRows:q,...wr},Er=Xce);const er=be=>{pr(be.animationName==="mui-auto-fill-cancel"?it.current:{value:"x"})};ee.useEffect(()=>{at&&at.setAdornedStart(!!Ee)},[at,Ee]);const lr={...n,color:je.color||"primary",disabled:je.disabled,endAdornment:S,error:je.error,focused:je.focused,formControl:at,fullWidth:P,hiddenLabel:je.hiddenLabel,multiline:W,size:je.size,startAdornment:Ee,type:xe},Ar=Kce(lr),ir=he.root||h.Root||eT,nt=ke.root||f.root||{},_e=he.input||h.Input||tT;return wr={...wr,...ke.input??f.input},K.jsxs(ee.Fragment,{children:[!v&&typeof KF=="function"&&(ZF||(ZF=K.jsx(KF,{}))),K.jsxs(ir,{...nt,ref:r,onClick:cr,...Oe,...!Zf(ir)&&{ownerState:{...lr,...nt.ownerState}},className:Sn(Ar.root,nt.className,o,Me&&"MuiInputBase-readOnly"),children:[Ee,K.jsx(YR.Provider,{value:null,children:K.jsx(_e,{"aria-invalid":je.error,"aria-describedby":i,autoComplete:a,autoFocus:s,defaultValue:g,disabled:je.disabled,id:k,onAnimationStart:er,name:G,placeholder:fe,readOnly:Me,required:je.required,rows:we,value:$e,onKeyDown:oe,onKeyUp:ce,type:xe,...wr,...!Zf(_e)&&{as:Er,ownerState:{...lr,...wr.ownerState}},ref:rt,className:Sn(Ar.input,wr.className,Me&&"MuiInputBase-readOnly"),onBlur:yr,onChange:_r,onFocus:vt})}),S,me?me({...je,startAdornment:Ee}):null]})]})});function Jce(t){return fi("MuiInput",t)}const m_={...n0,...ui("MuiInput",["root","underline","input"])};function Qce(t){return fi("MuiOutlinedInput",t)}const Lf={...n0,...ui("MuiOutlinedInput",["root","notchedOutline","input"])};function ehe(t){return fi("MuiFilledInput",t)}const Mg={...n0,...ui("MuiFilledInput",["root","underline","input","adornedStart","adornedEnd","sizeSmall","multiline","hiddenLabel"])},the=Hi(K.jsx("path",{d:"M7 10l5 5 5-5z"})),rhe=Hi(K.jsx("path",{d:"M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"}));function nhe(t){return fi("MuiAvatar",t)}ui("MuiAvatar",["root","colorDefault","circular","rounded","square","img","fallback"]);const ihe=t=>{const{classes:e,variant:r,colorDefault:n}=t;return di({root:["root",r,n&&"colorDefault"],img:["img"],fallback:["fallback"]},nhe,e)},ahe=Pr("div",{name:"MuiAvatar",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.root,e[r.variant],r.colorDefault&&e.colorDefault]}})(si(({theme:t})=>({position:"relative",display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0,width:40,height:40,fontFamily:t.typography.fontFamily,fontSize:t.typography.pxToRem(20),lineHeight:1,borderRadius:"50%",overflow:"hidden",userSelect:"none",variants:[{props:{variant:"rounded"},style:{borderRadius:(t.vars||t).shape.borderRadius}},{props:{variant:"square"},style:{borderRadius:0}},{props:{colorDefault:!0},style:{color:(t.vars||t).palette.background.default,...t.vars?{backgroundColor:t.vars.palette.Avatar.defaultBg}:{backgroundColor:t.palette.grey[400],...t.applyStyles("dark",{backgroundColor:t.palette.grey[600]})}}}]}))),ohe=Pr("img",{name:"MuiAvatar",slot:"Img"})({width:"100%",height:"100%",textAlign:"center",objectFit:"cover",color:"transparent",textIndent:1e4}),she=Pr(rhe,{name:"MuiAvatar",slot:"Fallback"})({width:"75%",height:"75%"});function lhe({crossOrigin:t,referrerPolicy:e,src:r,srcSet:n}){const[i,a]=ee.useState(!1);return ee.useEffect(()=>{if(!r&&!n)return;a(!1);let s=!0;const o=new Image;return o.onload=()=>{s&&a("loaded")},o.onerror=()=>{s&&a("error")},o.crossOrigin=t,o.referrerPolicy=e,o.src=r,n&&(o.srcset=n),()=>{s=!1}},[t,e,r,n]),i}const dG=ee.forwardRef(function(e,r){const n=_i({props:e,name:"MuiAvatar"}),{alt:i,children:a,className:s,component:o="div",slots:u={},slotProps:h={},imgProps:f,sizes:g,src:b,srcSet:v,variant:S="circular",...E}=n;let P=null;const k={...n,component:o,variant:S},L=lhe({...f,...typeof h.img=="function"?h.img(k):h.img,src:b,srcSet:v}),O=b||v,M=O&&L!=="error";k.colorDefault=!M,delete k.ownerState;const z=ihe(k),[B,q]=Si("root",{ref:r,className:Sn(z.root,s),elementType:ahe,externalForwardedProps:{slots:u,slotProps:h,component:o,...E},ownerState:k}),[W,G]=Si("img",{className:z.img,elementType:ohe,externalForwardedProps:{slots:u,slotProps:{img:{...f,...h.img}}},additionalProps:{alt:i,src:b,srcSet:v,sizes:g},ownerState:k}),[ie,Q]=Si("fallback",{className:z.fallback,elementType:she,externalForwardedProps:{slots:u,slotProps:h},shouldForwardComponentProp:!0,ownerState:k});return M?P=K.jsx(W,{...G}):a||a===0?P=a:O&&i?P=i[0]:P=K.jsx(ie,{...Q}),K.jsx(B,{...q,children:P})}),uhe={entering:{opacity:1},entered:{opacity:1}},MP=ee.forwardRef(function(e,r){const n=Tc(),i={enter:n.transitions.duration.enteringScreen,exit:n.transitions.duration.leavingScreen},{addEndListener:a,appear:s=!0,children:o,easing:u,in:h,onEnter:f,onEntered:g,onEntering:b,onExit:v,onExited:S,onExiting:E,style:P,timeout:k=i,TransitionComponent:L=Dh,...O}=e,M=ee.useRef(null),z=Lo(M,lg(o),r),B=oe=>ce=>{if(oe){const fe=M.current;ce===void 0?oe(fe):oe(fe,ce)}},q=B(b),W=B((oe,ce)=>{UR(oe);const fe=Hd({style:P,timeout:k,easing:u},{mode:"enter"});oe.style.webkitTransition=n.transitions.create("opacity",fe),oe.style.transition=n.transitions.create("opacity",fe),f&&f(oe,ce)}),G=B(g),ie=B(E),Q=B(oe=>{const ce=Hd({style:P,timeout:k,easing:u},{mode:"exit"});oe.style.webkitTransition=n.transitions.create("opacity",ce),oe.style.transition=n.transitions.create("opacity",ce),v&&v(oe)}),H=B(S),ne=oe=>{a&&a(M.current,oe)};return K.jsx(L,{appear:s,in:h,nodeRef:M,onEnter:W,onEntered:G,onEntering:q,onExit:Q,onExited:H,onExiting:ie,addEndListener:ne,timeout:k,...O,children:(oe,{ownerState:ce,...fe})=>ee.cloneElement(o,{style:{opacity:0,visibility:oe==="exited"&&!h?"hidden":void 0,...uhe[oe],...P,...o.props.style},ref:z,...fe})})});function che(t){return fi("MuiBackdrop",t)}ui("MuiBackdrop",["root","invisible"]);const hhe=t=>{const{classes:e,invisible:r}=t;return di({root:["root",r&&"invisible"]},che,e)},fhe=Pr("div",{name:"MuiBackdrop",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.root,r.invisible&&e.invisible]}})({position:"fixed",display:"flex",alignItems:"center",justifyContent:"center",right:0,bottom:0,top:0,left:0,backgroundColor:"rgba(0, 0, 0, 0.5)",WebkitTapHighlightColor:"transparent",variants:[{props:{invisible:!0},style:{backgroundColor:"transparent"}}]}),pG=ee.forwardRef(function(e,r){const n=_i({props:e,name:"MuiBackdrop"}),{children:i,className:a,component:s="div",invisible:o=!1,open:u,components:h={},componentsProps:f={},slotProps:g={},slots:b={},TransitionComponent:v,transitionDuration:S,...E}=n,P={...n,component:s,invisible:o},k=hhe(P),L={transition:v,root:h.Root,...b},O={...f,...g},M={component:s,slots:L,slotProps:O},[z,B]=Si("root",{elementType:fhe,externalForwardedProps:M,className:Sn(k.root,a),ownerState:P}),[q,W]=Si("transition",{elementType:MP,externalForwardedProps:M,ownerState:P});return K.jsx(q,{in:u,timeout:S,...E,...W,children:K.jsx(z,{"aria-hidden":!0,...B,classes:k,ref:r,children:i})})}),dhe=ui("MuiBox",["root"]),phe=k0(),Vo=EW({themeId:nf,defaultTheme:phe,defaultClassName:dhe.root,generateClassName:kR.generate});function ghe(t){return fi("MuiButton",t)}const Rg=ui("MuiButton",["root","text","textInherit","textPrimary","textSecondary","textSuccess","textError","textInfo","textWarning","outlined","outlinedInherit","outlinedPrimary","outlinedSecondary","outlinedSuccess","outlinedError","outlinedInfo","outlinedWarning","contained","containedInherit","containedPrimary","containedSecondary","containedSuccess","containedError","containedInfo","containedWarning","disableElevation","focusVisible","disabled","colorInherit","colorPrimary","colorSecondary","colorSuccess","colorError","colorInfo","colorWarning","textSizeSmall","textSizeMedium","textSizeLarge","outlinedSizeSmall","outlinedSizeMedium","outlinedSizeLarge","containedSizeSmall","containedSizeMedium","containedSizeLarge","sizeMedium","sizeSmall","sizeLarge","fullWidth","startIcon","endIcon","icon","iconSizeSmall","iconSizeMedium","iconSizeLarge","loading","loadingWrapper","loadingIconPlaceholder","loadingIndicator","loadingPositionCenter","loadingPositionStart","loadingPositionEnd"]),gG=ee.createContext({}),mG=ee.createContext(void 0),mhe=t=>{const{color:e,disableElevation:r,fullWidth:n,size:i,variant:a,loading:s,loadingPosition:o,classes:u}=t,h={root:["root",s&&"loading",a,`${a}${on(e)}`,`size${on(i)}`,`${a}Size${on(i)}`,`color${on(e)}`,r&&"disableElevation",n&&"fullWidth",s&&`loadingPosition${on(o)}`],startIcon:["icon","startIcon",`iconSize${on(i)}`],endIcon:["icon","endIcon",`iconSize${on(i)}`],loadingIndicator:["loadingIndicator"],loadingWrapper:["loadingWrapper"]},f=di(h,ghe,u);return{...u,...f}},yG=[{props:{size:"small"},style:{"& > *:nth-of-type(1)":{fontSize:18}}},{props:{size:"medium"},style:{"& > *:nth-of-type(1)":{fontSize:20}}},{props:{size:"large"},style:{"& > *:nth-of-type(1)":{fontSize:22}}}],yhe=Pr(M0,{shouldForwardProp:t=>yl(t)||t==="classes",name:"MuiButton",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.root,e[r.variant],e[`${r.variant}${on(r.color)}`],e[`size${on(r.size)}`],e[`${r.variant}Size${on(r.size)}`],r.color==="inherit"&&e.colorInherit,r.disableElevation&&e.disableElevation,r.fullWidth&&e.fullWidth,r.loading&&e.loading]}})(si(({theme:t})=>{const e=t.palette.mode==="light"?t.palette.grey[300]:t.palette.grey[800],r=t.palette.mode==="light"?t.palette.grey.A100:t.palette.grey[700];return{...t.typography.button,minWidth:64,padding:"6px 16px",border:0,borderRadius:(t.vars||t).shape.borderRadius,transition:t.transitions.create(["background-color","box-shadow","border-color","color"],{duration:t.transitions.duration.short}),"&:hover":{textDecoration:"none"},[`&.${Rg.disabled}`]:{color:(t.vars||t).palette.action.disabled},variants:[{props:{variant:"contained"},style:{color:"var(--variant-containedColor)",backgroundColor:"var(--variant-containedBg)",boxShadow:(t.vars||t).shadows[2],"&:hover":{boxShadow:(t.vars||t).shadows[4],"@media (hover: none)":{boxShadow:(t.vars||t).shadows[2]}},"&:active":{boxShadow:(t.vars||t).shadows[8]},[`&.${Rg.focusVisible}`]:{boxShadow:(t.vars||t).shadows[6]},[`&.${Rg.disabled}`]:{color:(t.vars||t).palette.action.disabled,boxShadow:(t.vars||t).shadows[0],backgroundColor:(t.vars||t).palette.action.disabledBackground}}},{props:{variant:"outlined"},style:{padding:"5px 15px",border:"1px solid currentColor",borderColor:"var(--variant-outlinedBorder, currentColor)",backgroundColor:"var(--variant-outlinedBg)",color:"var(--variant-outlinedColor)",[`&.${Rg.disabled}`]:{border:`1px solid ${(t.vars||t).palette.action.disabledBackground}`}}},{props:{variant:"text"},style:{padding:"6px 8px",color:"var(--variant-textColor)",backgroundColor:"var(--variant-textBg)"}},...Object.entries(t.palette).filter(Nl()).map(([n])=>({props:{color:n},style:{"--variant-textColor":(t.vars||t).palette[n].main,"--variant-outlinedColor":(t.vars||t).palette[n].main,"--variant-outlinedBorder":t.alpha((t.vars||t).palette[n].main,.5),"--variant-containedColor":(t.vars||t).palette[n].contrastText,"--variant-containedBg":(t.vars||t).palette[n].main,"@media (hover: hover)":{"&:hover":{"--variant-containedBg":(t.vars||t).palette[n].dark,"--variant-textBg":t.alpha((t.vars||t).palette[n].main,(t.vars||t).palette.action.hoverOpacity),"--variant-outlinedBorder":(t.vars||t).palette[n].main,"--variant-outlinedBg":t.alpha((t.vars||t).palette[n].main,(t.vars||t).palette.action.hoverOpacity)}}}})),{props:{color:"inherit"},style:{color:"inherit",borderColor:"currentColor","--variant-containedBg":t.vars?t.vars.palette.Button.inheritContainedBg:e,"@media (hover: hover)":{"&:hover":{"--variant-containedBg":t.vars?t.vars.palette.Button.inheritContainedHoverBg:r,"--variant-textBg":t.alpha((t.vars||t).palette.text.primary,(t.vars||t).palette.action.hoverOpacity),"--variant-outlinedBg":t.alpha((t.vars||t).palette.text.primary,(t.vars||t).palette.action.hoverOpacity)}}}},{props:{size:"small",variant:"text"},style:{padding:"4px 5px",fontSize:t.typography.pxToRem(13)}},{props:{size:"large",variant:"text"},style:{padding:"8px 11px",fontSize:t.typography.pxToRem(15)}},{props:{size:"small",variant:"outlined"},style:{padding:"3px 9px",fontSize:t.typography.pxToRem(13)}},{props:{size:"large",variant:"outlined"},style:{padding:"7px 21px",fontSize:t.typography.pxToRem(15)}},{props:{size:"small",variant:"contained"},style:{padding:"4px 10px",fontSize:t.typography.pxToRem(13)}},{props:{size:"large",variant:"contained"},style:{padding:"8px 22px",fontSize:t.typography.pxToRem(15)}},{props:{disableElevation:!0},style:{boxShadow:"none","&:hover":{boxShadow:"none"},[`&.${Rg.focusVisible}`]:{boxShadow:"none"},"&:active":{boxShadow:"none"},[`&.${Rg.disabled}`]:{boxShadow:"none"}}},{props:{fullWidth:!0},style:{width:"100%"}},{props:{loadingPosition:"center"},style:{transition:t.transitions.create(["background-color","box-shadow","border-color"],{duration:t.transitions.duration.short}),[`&.${Rg.loading}`]:{color:"transparent"}}}]}})),vhe=Pr("span",{name:"MuiButton",slot:"StartIcon",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.startIcon,r.loading&&e.startIconLoadingStart,e[`iconSize${on(r.size)}`]]}})(({theme:t})=>({display:"inherit",marginRight:8,marginLeft:-4,variants:[{props:{size:"small"},style:{marginLeft:-2}},{props:{loadingPosition:"start",loading:!0},style:{transition:t.transitions.create(["opacity"],{duration:t.transitions.duration.short}),opacity:0}},{props:{loadingPosition:"start",loading:!0,fullWidth:!0},style:{marginRight:-8}},...yG]})),_he=Pr("span",{name:"MuiButton",slot:"EndIcon",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.endIcon,r.loading&&e.endIconLoadingEnd,e[`iconSize${on(r.size)}`]]}})(({theme:t})=>({display:"inherit",marginRight:-4,marginLeft:8,variants:[{props:{size:"small"},style:{marginRight:-2}},{props:{loadingPosition:"end",loading:!0},style:{transition:t.transitions.create(["opacity"],{duration:t.transitions.duration.short}),opacity:0}},{props:{loadingPosition:"end",loading:!0,fullWidth:!0},style:{marginLeft:-8}},...yG]})),bhe=Pr("span",{name:"MuiButton",slot:"LoadingIndicator"})(({theme:t})=>({display:"none",position:"absolute",visibility:"visible",variants:[{props:{loading:!0},style:{display:"flex"}},{props:{loadingPosition:"start"},style:{left:14}},{props:{loadingPosition:"start",size:"small"},style:{left:10}},{props:{variant:"text",loadingPosition:"start"},style:{left:6}},{props:{loadingPosition:"center"},style:{left:"50%",transform:"translate(-50%)",color:(t.vars||t).palette.action.disabled}},{props:{loadingPosition:"end"},style:{right:14}},{props:{loadingPosition:"end",size:"small"},style:{right:10}},{props:{variant:"text",loadingPosition:"end"},style:{right:6}},{props:{loadingPosition:"start",fullWidth:!0},style:{position:"relative",left:-10}},{props:{loadingPosition:"end",fullWidth:!0},style:{position:"relative",right:-10}}]})),JF=Pr("span",{name:"MuiButton",slot:"LoadingIconPlaceholder"})({display:"inline-block",width:"1em",height:"1em"}),Ji=ee.forwardRef(function(e,r){const n=ee.useContext(gG),i=ee.useContext(mG),a=G1(n,e),s=_i({props:a,name:"MuiButton"}),{children:o,color:u="primary",component:h="button",className:f,disabled:g=!1,disableElevation:b=!1,disableFocusRipple:v=!1,endIcon:S,focusVisibleClassName:E,fullWidth:P=!1,id:k,loading:L=null,loadingIndicator:O,loadingPosition:M="center",size:z="medium",startIcon:B,type:q,variant:W="text",...G}=s,ie=ag(k),Q=O??K.jsx(ZE,{"aria-labelledby":ie,color:"inherit",size:16}),H={...s,color:u,component:h,disabled:g,disableElevation:b,disableFocusRipple:v,fullWidth:P,loading:L,loadingIndicator:Q,loadingPosition:M,size:z,type:q,variant:W},ne=mhe(H),oe=(B||L&&M==="start")&&K.jsx(vhe,{className:ne.startIcon,ownerState:H,children:B||K.jsx(JF,{className:ne.loadingIconPlaceholder,ownerState:H})}),ce=(S||L&&M==="end")&&K.jsx(_he,{className:ne.endIcon,ownerState:H,children:S||K.jsx(JF,{className:ne.loadingIconPlaceholder,ownerState:H})}),fe=i||"",Me=typeof L=="boolean"?K.jsx("span",{className:ne.loadingWrapper,style:{display:"contents"},children:L&&K.jsx(bhe,{className:ne.loadingIndicator,ownerState:H,children:Q})}):null;return K.jsxs(yhe,{ownerState:H,className:Sn(n.className,ne.root,f,fe),component:h,disabled:g||L,focusRipple:!v,focusVisibleClassName:Sn(ne.focusVisible,E),ref:r,type:q,id:L?ie:k,...G,classes:ne,children:[oe,M!=="end"&&Me,o,M==="end"&&Me,ce]})});function xhe(t){return ee.Children.toArray(t).filter(e=>ee.isValidElement(e))}function whe(t){return fi("MuiButtonGroup",t)}const Ki=ui("MuiButtonGroup",["root","contained","outlined","text","disableElevation","disabled","firstButton","fullWidth","horizontal","vertical","colorPrimary","colorSecondary","grouped","groupedHorizontal","groupedVertical","groupedText","groupedTextHorizontal","groupedTextVertical","groupedTextPrimary","groupedTextSecondary","groupedOutlined","groupedOutlinedHorizontal","groupedOutlinedVertical","groupedOutlinedPrimary","groupedOutlinedSecondary","groupedContained","groupedContainedHorizontal","groupedContainedVertical","groupedContainedPrimary","groupedContainedSecondary","lastButton","middleButton"]),She=(t,e)=>{const{ownerState:r}=t;return[{[`& .${Ki.grouped}`]:e.grouped},{[`& .${Ki.grouped}`]:e[`grouped${on(r.orientation)}`]},{[`& .${Ki.grouped}`]:e[`grouped${on(r.variant)}`]},{[`& .${Ki.grouped}`]:e[`grouped${on(r.variant)}${on(r.orientation)}`]},{[`& .${Ki.grouped}`]:e[`grouped${on(r.variant)}${on(r.color)}`]},{[`& .${Ki.firstButton}`]:e.firstButton},{[`& .${Ki.lastButton}`]:e.lastButton},{[`& .${Ki.middleButton}`]:e.middleButton},e.root,e[r.variant],r.disableElevation===!0&&e.disableElevation,r.fullWidth&&e.fullWidth,r.orientation==="vertical"&&e.vertical]},Ehe=t=>{const{classes:e,color:r,disabled:n,disableElevation:i,fullWidth:a,orientation:s,variant:o}=t,u={root:["root",o,s,a&&"fullWidth",i&&"disableElevation",`color${on(r)}`],grouped:["grouped",`grouped${on(s)}`,`grouped${on(o)}`,`grouped${on(o)}${on(s)}`,`grouped${on(o)}${on(r)}`,n&&"disabled"],firstButton:["firstButton"],lastButton:["lastButton"],middleButton:["middleButton"]};return di(u,whe,e)},The=Pr("div",{name:"MuiButtonGroup",slot:"Root",overridesResolver:She})(si(({theme:t})=>({display:"inline-flex",borderRadius:(t.vars||t).shape.borderRadius,variants:[{props:{variant:"contained"},style:{boxShadow:(t.vars||t).shadows[2]}},{props:{disableElevation:!0},style:{boxShadow:"none"}},{props:{fullWidth:!0},style:{width:"100%"}},{props:{orientation:"vertical"},style:{flexDirection:"column",[`& .${Ki.lastButton},& .${Ki.middleButton}`]:{borderTopRightRadius:0,borderTopLeftRadius:0},[`& .${Ki.firstButton},& .${Ki.middleButton}`]:{borderBottomRightRadius:0,borderBottomLeftRadius:0}}},{props:{orientation:"horizontal"},style:{[`& .${Ki.firstButton},& .${Ki.middleButton}`]:{borderTopRightRadius:0,borderBottomRightRadius:0},[`& .${Ki.lastButton},& .${Ki.middleButton}`]:{borderTopLeftRadius:0,borderBottomLeftRadius:0}}},{props:{variant:"text",orientation:"horizontal"},style:{[`& .${Ki.firstButton},& .${Ki.middleButton}`]:{borderRight:t.vars?`1px solid ${t.alpha(t.vars.palette.common.onBackground,.23)}`:`1px solid ${t.palette.mode==="light"?"rgba(0, 0, 0, 0.23)":"rgba(255, 255, 255, 0.23)"}`,[`&.${Ki.disabled}`]:{borderRight:`1px solid ${(t.vars||t).palette.action.disabled}`}}}},{props:{variant:"text",orientation:"vertical"},style:{[`& .${Ki.firstButton},& .${Ki.middleButton}`]:{borderBottom:t.vars?`1px solid ${t.alpha(t.vars.palette.common.onBackground,.23)}`:`1px solid ${t.palette.mode==="light"?"rgba(0, 0, 0, 0.23)":"rgba(255, 255, 255, 0.23)"}`,[`&.${Ki.disabled}`]:{borderBottom:`1px solid ${(t.vars||t).palette.action.disabled}`}}}},...Object.entries(t.palette).filter(Nl()).flatMap(([e])=>[{props:{variant:"text",color:e},style:{[`& .${Ki.firstButton},& .${Ki.middleButton}`]:{borderColor:t.alpha((t.vars||t).palette[e].main,.5)}}}]),{props:{variant:"outlined",orientation:"horizontal"},style:{[`& .${Ki.firstButton},& .${Ki.middleButton}`]:{borderRightColor:"transparent","&:hover":{borderRightColor:"currentColor"}},[`& .${Ki.lastButton},& .${Ki.middleButton}`]:{marginLeft:-1}}},{props:{variant:"outlined",orientation:"vertical"},style:{[`& .${Ki.firstButton},& .${Ki.middleButton}`]:{borderBottomColor:"transparent","&:hover":{borderBottomColor:"currentColor"}},[`& .${Ki.lastButton},& .${Ki.middleButton}`]:{marginTop:-1}}},{props:{variant:"contained",orientation:"horizontal"},style:{[`& .${Ki.firstButton},& .${Ki.middleButton}`]:{borderRight:`1px solid ${(t.vars||t).palette.grey[400]}`,[`&.${Ki.disabled}`]:{borderRight:`1px solid ${(t.vars||t).palette.action.disabled}`}}}},{props:{variant:"contained",orientation:"vertical"},style:{[`& .${Ki.firstButton},& .${Ki.middleButton}`]:{borderBottom:`1px solid ${(t.vars||t).palette.grey[400]}`,[`&.${Ki.disabled}`]:{borderBottom:`1px solid ${(t.vars||t).palette.action.disabled}`}}}},...Object.entries(t.palette).filter(Nl(["dark"])).map(([e])=>({props:{variant:"contained",color:e},style:{[`& .${Ki.firstButton},& .${Ki.middleButton}`]:{borderColor:(t.vars||t).palette[e].dark}}}))],[`& .${Ki.grouped}`]:{minWidth:40,boxShadow:"none",props:{variant:"contained"},style:{"&:hover":{boxShadow:"none"}}}}))),RP=ee.forwardRef(function(e,r){const n=_i({props:e,name:"MuiButtonGroup"}),{children:i,className:a,color:s="primary",component:o="div",disabled:u=!1,disableElevation:h=!1,disableFocusRipple:f=!1,disableRipple:g=!1,fullWidth:b=!1,orientation:v="horizontal",size:S="medium",variant:E="outlined",...P}=n,k={...n,color:s,component:o,disabled:u,disableElevation:h,disableFocusRipple:f,disableRipple:g,fullWidth:b,orientation:v,size:S,variant:E},L=Ehe(k),O=ee.useMemo(()=>({className:L.grouped,color:s,disabled:u,disableElevation:h,disableFocusRipple:f,disableRipple:g,fullWidth:b,size:S,variant:E}),[s,u,h,f,g,b,S,E,L.grouped]),M=xhe(i),z=M.length,B=q=>{const W=q===0,G=q===z-1;return W&&G?"":W?L.firstButton:G?L.lastButton:L.middleButton};return K.jsx(The,{as:o,role:"group",className:Sn(L.root,a),ref:r,ownerState:k,...P,children:K.jsx(gG.Provider,{value:O,children:M.map((q,W)=>K.jsx(mG.Provider,{value:B(W),children:q},W))})})});function Che(t){return fi("PrivateSwitchBase",t)}ui("PrivateSwitchBase",["root","checked","disabled","input","edgeStart","edgeEnd"]);const Ahe=t=>{const{classes:e,checked:r,disabled:n,edge:i}=t,a={root:["root",r&&"checked",n&&"disabled",i&&`edge${on(i)}`],input:["input"]};return di(a,Che,e)},Ihe=Pr(M0,{name:"MuiSwitchBase"})({padding:9,borderRadius:"50%",variants:[{props:{edge:"start",size:"small"},style:{marginLeft:-3}},{props:({edge:t,ownerState:e})=>t==="start"&&e.size!=="small",style:{marginLeft:-12}},{props:{edge:"end",size:"small"},style:{marginRight:-3}},{props:({edge:t,ownerState:e})=>t==="end"&&e.size!=="small",style:{marginRight:-12}}]}),Phe=Pr("input",{name:"MuiSwitchBase",shouldForwardProp:yl})({cursor:"inherit",position:"absolute",opacity:0,width:"100%",height:"100%",top:0,left:0,margin:0,padding:0,zIndex:1}),vG=ee.forwardRef(function(e,r){const{autoFocus:n,checked:i,checkedIcon:a,defaultChecked:s,disabled:o,disableFocusRipple:u=!1,edge:h=!1,icon:f,id:g,inputProps:b,inputRef:v,name:S,onBlur:E,onChange:P,onFocus:k,readOnly:L,required:O=!1,tabIndex:M,type:z,value:B,slots:q={},slotProps:W={},...G}=e,[ie,Q]=pm({controlled:i,default:!!s,name:"SwitchBase",state:"checked"}),H=sd(),ne=Ne=>{k&&k(Ne),H&&H.onFocus&&H.onFocus(Ne)},oe=Ne=>{E&&E(Ne),H&&H.onBlur&&H.onBlur(Ne)},ce=Ne=>{if(Ne.nativeEvent.defaultPrevented)return;const Oe=Ne.target.checked;Q(Oe),P&&P(Ne,Oe)};let fe=o;H&&typeof fe>"u"&&(fe=H.disabled);const Me=z==="checkbox"||z==="radio",me={...e,checked:ie,disabled:fe,disableFocusRipple:u,edge:h},we=Ahe(me),Te={slots:q,slotProps:{input:b,...W}},[ke,he]=Si("root",{ref:r,elementType:Ihe,className:we.root,shouldForwardComponentProp:!0,externalForwardedProps:{...Te,component:"span",...G},getSlotProps:Ne=>({...Ne,onFocus:Oe=>{Ne.onFocus?.(Oe),ne(Oe)},onBlur:Oe=>{Ne.onBlur?.(Oe),oe(Oe)}}),ownerState:me,additionalProps:{centerRipple:!0,focusRipple:!u,disabled:fe,role:void 0,tabIndex:null}}),[Ee,xe]=Si("input",{ref:v,elementType:Phe,className:we.input,externalForwardedProps:Te,getSlotProps:Ne=>({...Ne,onChange:Oe=>{Ne.onChange?.(Oe),ce(Oe)}}),ownerState:me,additionalProps:{autoFocus:n,checked:i,defaultChecked:s,disabled:fe,id:Me?g:void 0,name:S,readOnly:L,required:O,tabIndex:M,type:z,...z==="checkbox"&&B===void 0?{}:{value:B}}});return K.jsxs(ke,{...he,children:[K.jsx(Ee,{...xe}),ie?a:f]})}),khe=Hi(K.jsx("path",{d:"M19 5v14H5V5h14m0-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2z"})),Mhe=Hi(K.jsx("path",{d:"M19 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.11 0 2-.9 2-2V5c0-1.1-.89-2-2-2zm-9 14l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"})),Rhe=Hi(K.jsx("path",{d:"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-2 10H7v-2h10v2z"}));function Ohe(t){return fi("MuiCheckbox",t)}const l3=ui("MuiCheckbox",["root","checked","disabled","indeterminate","colorPrimary","colorSecondary","sizeSmall","sizeMedium"]),Lhe=t=>{const{classes:e,indeterminate:r,color:n,size:i}=t,a={root:["root",r&&"indeterminate",`color${on(n)}`,`size${on(i)}`]},s=di(a,Ohe,e);return{...e,...s}},Nhe=Pr(vG,{shouldForwardProp:t=>yl(t)||t==="classes",name:"MuiCheckbox",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.root,r.indeterminate&&e.indeterminate,e[`size${on(r.size)}`],r.color!=="default"&&e[`color${on(r.color)}`]]}})(si(({theme:t})=>({color:(t.vars||t).palette.text.secondary,variants:[{props:{color:"default",disableRipple:!1},style:{"&:hover":{backgroundColor:t.alpha((t.vars||t).palette.action.active,(t.vars||t).palette.action.hoverOpacity)}}},...Object.entries(t.palette).filter(Nl()).map(([e])=>({props:{color:e,disableRipple:!1},style:{"&:hover":{backgroundColor:t.alpha((t.vars||t).palette[e].main,(t.vars||t).palette.action.hoverOpacity)}}})),...Object.entries(t.palette).filter(Nl()).map(([e])=>({props:{color:e},style:{[`&.${l3.checked}, &.${l3.indeterminate}`]:{color:(t.vars||t).palette[e].main},[`&.${l3.disabled}`]:{color:(t.vars||t).palette.action.disabled}}})),{props:{disableRipple:!1},style:{"&:hover":{"@media (hover: none)":{backgroundColor:"transparent"}}}}]}))),Dhe=K.jsx(Mhe,{}),Fhe=K.jsx(khe,{}),Bhe=K.jsx(Rhe,{}),i0=ee.forwardRef(function(e,r){const n=_i({props:e,name:"MuiCheckbox"}),{checkedIcon:i=Dhe,color:a="primary",icon:s=Fhe,indeterminate:o=!1,indeterminateIcon:u=Bhe,inputProps:h,size:f="medium",disableRipple:g=!1,className:b,slots:v={},slotProps:S={},...E}=n,P=o?u:s,k=o?u:i,L={...n,disableRipple:g,color:a,indeterminate:o,size:f},O=Lhe(L),M=S.input??h,[z,B]=Si("root",{ref:r,elementType:Nhe,className:Sn(O.root,b),shouldForwardComponentProp:!0,externalForwardedProps:{slots:v,slotProps:S,...E},ownerState:L,additionalProps:{type:"checkbox",icon:ee.cloneElement(P,{fontSize:P.props.fontSize??f}),checkedIcon:ee.cloneElement(k,{fontSize:k.props.fontSize??f}),disableRipple:g,slots:v,slotProps:{input:Y1(typeof M=="function"?M(L):M,{"data-indeterminate":o})}}});return K.jsx(z,{...B,classes:O})});function QF(t){return t.substring(2).toLowerCase()}function zhe(t,e){return e.documentElement.clientWidth<t.clientX||e.documentElement.clientHeight<t.clientY}function jhe(t){const{children:e,disableReactTree:r=!1,mouseEvent:n="onClick",onClickAway:i,touchEvent:a="onTouchEnd"}=t,s=ee.useRef(!1),o=ee.useRef(null),u=ee.useRef(!1),h=ee.useRef(!1);ee.useEffect(()=>(setTimeout(()=>{u.current=!0},0),()=>{u.current=!1}),[]);const f=Lo(lg(e),o),g=Ql(S=>{const E=h.current;h.current=!1;const P=os(o.current);if(!u.current||!o.current||"clientX"in S&&zhe(S,P))return;if(s.current){s.current=!1;return}let k;S.composedPath?k=S.composedPath().includes(o.current):k=!P.documentElement.contains(S.target)||o.current.contains(S.target),!k&&(r||!E)&&i(S)}),b=S=>E=>{h.current=!0;const P=e.props[S];P&&P(E)},v={ref:f};return a!==!1&&(v[a]=b(a)),ee.useEffect(()=>{if(a!==!1){const S=QF(a),E=os(o.current),P=()=>{s.current=!0};return E.addEventListener(S,g),E.addEventListener("touchmove",P),()=>{E.removeEventListener(S,g),E.removeEventListener("touchmove",P)}}},[g,a]),n!==!1&&(v[n]=b(n)),ee.useEffect(()=>{if(n!==!1){const S=QF(n),E=os(o.current);return E.addEventListener(S,g),()=>{E.removeEventListener(S,g)}}},[g,n]),ee.cloneElement(e,v)}function _G(t=window){const e=t.document.documentElement.clientWidth;return t.innerWidth-e}function Uhe(t){const e=os(t);return e.body===t?sc(t).innerWidth>e.documentElement.clientWidth:t.scrollHeight>t.clientHeight}function w1(t,e){e?t.setAttribute("aria-hidden","true"):t.removeAttribute("aria-hidden")}function e8(t){return parseInt(sc(t).getComputedStyle(t).paddingRight,10)||0}function Vhe(t){const r=["TEMPLATE","SCRIPT","STYLE","LINK","MAP","META","NOSCRIPT","PICTURE","COL","COLGROUP","PARAM","SLOT","SOURCE","TRACK"].includes(t.tagName),n=t.tagName==="INPUT"&&t.getAttribute("type")==="hidden";return r||n}function t8(t,e,r,n,i){const a=[e,r,...n];[].forEach.call(t.children,s=>{const o=!a.includes(s),u=!Vhe(s);o&&u&&w1(s,i)})}function u3(t,e){let r=-1;return t.some((n,i)=>e(n)?(r=i,!0):!1),r}function $he(t,e){const r=[],n=t.container;if(!e.disableScrollLock){if(Uhe(n)){const s=_G(sc(n));r.push({value:n.style.paddingRight,property:"padding-right",el:n}),n.style.paddingRight=`${e8(n)+s}px`;const o=os(n).querySelectorAll(".mui-fixed");[].forEach.call(o,u=>{r.push({value:u.style.paddingRight,property:"padding-right",el:u}),u.style.paddingRight=`${e8(u)+s}px`})}let a;if(n.parentNode instanceof DocumentFragment)a=os(n).body;else{const s=n.parentElement,o=sc(n);a=s?.nodeName==="HTML"&&o.getComputedStyle(s).overflowY==="scroll"?s:n}r.push({value:a.style.overflow,property:"overflow",el:a},{value:a.style.overflowX,property:"overflow-x",el:a},{value:a.style.overflowY,property:"overflow-y",el:a}),a.style.overflow="hidden"}return()=>{r.forEach(({value:a,el:s,property:o})=>{a?s.style.setProperty(o,a):s.style.removeProperty(o)})}}function qhe(t){const e=[];return[].forEach.call(t.children,r=>{r.getAttribute("aria-hidden")==="true"&&e.push(r)}),e}class Hhe{constructor(){this.modals=[],this.containers=[]}add(e,r){let n=this.modals.indexOf(e);if(n!==-1)return n;n=this.modals.length,this.modals.push(e),e.modalRef&&w1(e.modalRef,!1);const i=qhe(r);t8(r,e.mount,e.modalRef,i,!0);const a=u3(this.containers,s=>s.container===r);return a!==-1?(this.containers[a].modals.push(e),n):(this.containers.push({modals:[e],container:r,restore:null,hiddenSiblings:i}),n)}mount(e,r){const n=u3(this.containers,a=>a.modals.includes(e)),i=this.containers[n];i.restore||(i.restore=$he(i,r))}remove(e,r=!0){const n=this.modals.indexOf(e);if(n===-1)return n;const i=u3(this.containers,s=>s.modals.includes(e)),a=this.containers[i];if(a.modals.splice(a.modals.indexOf(e),1),this.modals.splice(n,1),a.modals.length===0)a.restore&&a.restore(),e.modalRef&&w1(e.modalRef,r),t8(a.container,e.mount,e.modalRef,a.hiddenSiblings,!1),this.containers.splice(i,1);else{const s=a.modals[a.modals.length-1];s.modalRef&&w1(s.modalRef,!1)}return n}isTopModal(e){return this.modals.length>0&&this.modals[this.modals.length-1]===e}}const Whe=["input","select","textarea","a[href]","button","[tabindex]","audio[controls]","video[controls]",'[contenteditable]:not([contenteditable="false"])'].join(",");function Ghe(t){const e=parseInt(t.getAttribute("tabindex")||"",10);return Number.isNaN(e)?t.contentEditable==="true"||(t.nodeName==="AUDIO"||t.nodeName==="VIDEO"||t.nodeName==="DETAILS")&&t.getAttribute("tabindex")===null?0:t.tabIndex:e}function Xhe(t){if(t.tagName!=="INPUT"||t.type!=="radio"||!t.name)return!1;const e=n=>t.ownerDocument.querySelector(`input[type="radio"]${n}`);let r=e(`[name="${t.name}"]:checked`);return r||(r=e(`[name="${t.name}"]`)),r!==t}function Yhe(t){return!(t.disabled||t.tagName==="INPUT"&&t.type==="hidden"||Xhe(t))}function Zhe(t){const e=[],r=[];return Array.from(t.querySelectorAll(Whe)).forEach((n,i)=>{const a=Ghe(n);a===-1||!Yhe(n)||(a===0?e.push(n):r.push({documentOrder:i,tabIndex:a,node:n}))}),r.sort((n,i)=>n.tabIndex===i.tabIndex?n.documentOrder-i.documentOrder:n.tabIndex-i.tabIndex).map(n=>n.node).concat(e)}function Khe(){return!0}function Jhe(t){const{children:e,disableAutoFocus:r=!1,disableEnforceFocus:n=!1,disableRestoreFocus:i=!1,getTabbable:a=Zhe,isEnabled:s=Khe,open:o}=t,u=ee.useRef(!1),h=ee.useRef(null),f=ee.useRef(null),g=ee.useRef(null),b=ee.useRef(null),v=ee.useRef(!1),S=ee.useRef(null),E=Lo(lg(e),S),P=ee.useRef(null);ee.useEffect(()=>{!o||!S.current||(v.current=!r)},[r,o]),ee.useEffect(()=>{if(!o||!S.current)return;const O=os(S.current);return S.current.contains(O.activeElement)||(S.current.hasAttribute("tabIndex")||S.current.setAttribute("tabIndex","-1"),v.current&&S.current.focus()),()=>{i||(g.current&&g.current.focus&&(u.current=!0,g.current.focus()),g.current=null)}},[o]),ee.useEffect(()=>{if(!o||!S.current)return;const O=os(S.current),M=q=>{P.current=q,!(n||!s()||q.key!=="Tab")&&O.activeElement===S.current&&q.shiftKey&&(u.current=!0,f.current&&f.current.focus())},z=()=>{const q=S.current;if(q===null)return;if(!O.hasFocus()||!s()||u.current){u.current=!1;return}if(q.contains(O.activeElement)||n&&O.activeElement!==h.current&&O.activeElement!==f.current)return;if(O.activeElement!==b.current)b.current=null;else if(b.current!==null)return;if(!v.current)return;let W=[];if((O.activeElement===h.current||O.activeElement===f.current)&&(W=a(S.current)),W.length>0){const G=!!(P.current?.shiftKey&&P.current?.key==="Tab"),ie=W[0],Q=W[W.length-1];typeof ie!="string"&&typeof Q!="string"&&(G?Q.focus():ie.focus())}else q.focus()};O.addEventListener("focusin",z),O.addEventListener("keydown",M,!0);const B=setInterval(()=>{O.activeElement&&O.activeElement.tagName==="BODY"&&z()},50);return()=>{clearInterval(B),O.removeEventListener("focusin",z),O.removeEventListener("keydown",M,!0)}},[r,n,i,s,o,a]);const k=O=>{g.current===null&&(g.current=O.relatedTarget),v.current=!0,b.current=O.target;const M=e.props.onFocus;M&&M(O)},L=O=>{g.current===null&&(g.current=O.relatedTarget),v.current=!0};return K.jsxs(ee.Fragment,{children:[K.jsx("div",{tabIndex:o?0:-1,onFocus:L,ref:h,"data-testid":"sentinelStart"}),ee.cloneElement(e,{ref:E,onFocus:k}),K.jsx("div",{tabIndex:o?0:-1,onFocus:L,ref:f,"data-testid":"sentinelEnd"})]})}function Qhe(t){return typeof t=="function"?t():t}function efe(t){return t?t.props.hasOwnProperty("in"):!1}const r8=()=>{},qx=new Hhe;function tfe(t){const{container:e,disableEscapeKeyDown:r=!1,disableScrollLock:n=!1,closeAfterTransition:i=!1,onTransitionEnter:a,onTransitionExited:s,children:o,onClose:u,open:h,rootRef:f}=t,g=ee.useRef({}),b=ee.useRef(null),v=ee.useRef(null),S=Lo(v,f),[E,P]=ee.useState(!h),k=efe(o);let L=!0;(t["aria-hidden"]==="false"||t["aria-hidden"]===!1)&&(L=!1);const O=()=>os(b.current),M=()=>(g.current.modalRef=v.current,g.current.mount=b.current,g.current),z=()=>{qx.mount(M(),{disableScrollLock:n}),v.current&&(v.current.scrollTop=0)},B=Ql(()=>{const ce=Qhe(e)||O().body;qx.add(M(),ce),v.current&&z()}),q=()=>qx.isTopModal(M()),W=Ql(ce=>{b.current=ce,ce&&(h&&q()?z():v.current&&w1(v.current,L))}),G=ee.useCallback(()=>{qx.remove(M(),L)},[L]);ee.useEffect(()=>()=>{G()},[G]),ee.useEffect(()=>{h?B():(!k||!i)&&G()},[h,G,k,i,B]);const ie=ce=>fe=>{ce.onKeyDown?.(fe),!(fe.key!=="Escape"||fe.which===229||!q())&&(r||(fe.stopPropagation(),u&&u(fe,"escapeKeyDown")))},Q=ce=>fe=>{ce.onClick?.(fe),fe.target===fe.currentTarget&&u&&u(fe,"backdropClick")};return{getRootProps:(ce={})=>{const fe=rm(t);delete fe.onTransitionEnter,delete fe.onTransitionExited;const Me={...fe,...ce};return{role:"presentation",...Me,onKeyDown:ie(Me),ref:S}},getBackdropProps:(ce={})=>{const fe=ce;return{"aria-hidden":!0,...fe,onClick:Q(fe),open:h}},getTransitionProps:()=>{const ce=()=>{P(!1),a&&a()},fe=()=>{P(!0),s&&s(),i&&G()};return{onEnter:bP(ce,o?.props.onEnter??r8),onExited:bP(fe,o?.props.onExited??r8)}},rootRef:S,portalRef:W,isTopModal:q,exited:E,hasTransition:k}}function rfe(t){return fi("MuiModal",t)}ui("MuiModal",["root","hidden","backdrop"]);const nfe=t=>{const{open:e,exited:r,classes:n}=t;return di({root:["root",!e&&r&&"hidden"],backdrop:["backdrop"]},rfe,n)},ife=Pr("div",{name:"MuiModal",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.root,!r.open&&r.exited&&e.hidden]}})(si(({theme:t})=>({position:"fixed",zIndex:(t.vars||t).zIndex.modal,right:0,bottom:0,top:0,left:0,variants:[{props:({ownerState:e})=>!e.open&&e.exited,style:{visibility:"hidden"}}]}))),afe=Pr(pG,{name:"MuiModal",slot:"Backdrop"})({zIndex:-1}),KR=ee.forwardRef(function(e,r){const n=_i({name:"MuiModal",props:e}),{BackdropComponent:i=afe,BackdropProps:a,classes:s,className:o,closeAfterTransition:u=!1,children:h,container:f,component:g,components:b={},componentsProps:v={},disableAutoFocus:S=!1,disableEnforceFocus:E=!1,disableEscapeKeyDown:P=!1,disablePortal:k=!1,disableRestoreFocus:L=!1,disableScrollLock:O=!1,hideBackdrop:M=!1,keepMounted:z=!1,onClose:B,onTransitionEnter:q,onTransitionExited:W,open:G,slotProps:ie={},slots:Q={},theme:H,...ne}=n,oe={...n,closeAfterTransition:u,disableAutoFocus:S,disableEnforceFocus:E,disableEscapeKeyDown:P,disablePortal:k,disableRestoreFocus:L,disableScrollLock:O,hideBackdrop:M,keepMounted:z},{getRootProps:ce,getBackdropProps:fe,getTransitionProps:Me,portalRef:me,isTopModal:we,exited:Te,hasTransition:ke}=tfe({...oe,rootRef:r}),he={...oe,exited:Te},Ee=nfe(he),xe={};if(h.props.tabIndex===void 0&&(xe.tabIndex="-1"),ke){const{onEnter:Ye,onExited:rt}=Me();xe.onEnter=Ye,xe.onExited=rt}const Ne={slots:{root:b.Root,backdrop:b.Backdrop,...Q},slotProps:{...v,...ie}},[Oe,$e]=Si("root",{ref:r,elementType:ife,externalForwardedProps:{...Ne,...ne,component:g},getSlotProps:ce,ownerState:he,className:Sn(o,Ee?.root,!he.open&&he.exited&&Ee?.hidden)}),[De,it]=Si("backdrop",{ref:a?.ref,elementType:i,externalForwardedProps:Ne,shouldForwardComponentProp:!0,additionalProps:a,getSlotProps:Ye=>fe({...Ye,onClick:rt=>{Ye?.onClick&&Ye.onClick(rt)}}),className:Sn(a?.className,Ee?.backdrop),ownerState:he});return!z&&!G&&(!ke||Te)?null:K.jsx(hG,{ref:me,container:f,disablePortal:k,children:K.jsxs(Oe,{...$e,children:[!M&&i?K.jsx(De,{...it}):null,K.jsx(Jhe,{disableEnforceFocus:E,disableAutoFocus:S,disableRestoreFocus:L,isEnabled:we,open:G,children:ee.cloneElement(h,xe)})]})})});function ofe(t){return fi("MuiDialog",t)}const c3=ui("MuiDialog",["root","scrollPaper","scrollBody","container","paper","paperScrollPaper","paperScrollBody","paperWidthFalse","paperWidthXs","paperWidthSm","paperWidthMd","paperWidthLg","paperWidthXl","paperFullWidth","paperFullScreen"]),bG=ee.createContext({}),sfe=Pr(pG,{name:"MuiDialog",slot:"Backdrop",overrides:(t,e)=>e.backdrop})({zIndex:-1}),lfe=t=>{const{classes:e,scroll:r,maxWidth:n,fullWidth:i,fullScreen:a}=t,s={root:["root"],container:["container",`scroll${on(r)}`],paper:["paper",`paperScroll${on(r)}`,`paperWidth${on(String(n))}`,i&&"paperFullWidth",a&&"paperFullScreen"]};return di(s,ofe,e)},ufe=Pr(KR,{name:"MuiDialog",slot:"Root"})({"@media print":{position:"absolute !important"}}),cfe=Pr("div",{name:"MuiDialog",slot:"Container",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.container,e[`scroll${on(r.scroll)}`]]}})({height:"100%","@media print":{height:"auto"},outline:0,variants:[{props:{scroll:"paper"},style:{display:"flex",justifyContent:"center",alignItems:"center"}},{props:{scroll:"body"},style:{overflowY:"auto",overflowX:"hidden",textAlign:"center","&::after":{content:'""',display:"inline-block",verticalAlign:"middle",height:"100%",width:"0"}}}]}),hfe=Pr(Th,{name:"MuiDialog",slot:"Paper",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.paper,e[`scrollPaper${on(r.scroll)}`],e[`paperWidth${on(String(r.maxWidth))}`],r.fullWidth&&e.paperFullWidth,r.fullScreen&&e.paperFullScreen]}})(si(({theme:t})=>({margin:32,position:"relative",overflowY:"auto","@media print":{overflowY:"visible",boxShadow:"none"},variants:[{props:{scroll:"paper"},style:{display:"flex",flexDirection:"column",maxHeight:"calc(100% - 64px)"}},{props:{scroll:"body"},style:{display:"inline-block",verticalAlign:"middle",textAlign:"initial"}},{props:({ownerState:e})=>!e.maxWidth,style:{maxWidth:"calc(100% - 64px)"}},{props:{maxWidth:"xs"},style:{maxWidth:t.breakpoints.unit==="px"?Math.max(t.breakpoints.values.xs,444):`max(${t.breakpoints.values.xs}${t.breakpoints.unit}, 444px)`,[`&.${c3.paperScrollBody}`]:{[t.breakpoints.down(Math.max(t.breakpoints.values.xs,444)+64)]:{maxWidth:"calc(100% - 64px)"}}}},...Object.keys(t.breakpoints.values).filter(e=>e!=="xs").map(e=>({props:{maxWidth:e},style:{maxWidth:`${t.breakpoints.values[e]}${t.breakpoints.unit}`,[`&.${c3.paperScrollBody}`]:{[t.breakpoints.down(t.breakpoints.values[e]+64)]:{maxWidth:"calc(100% - 64px)"}}}})),{props:({ownerState:e})=>e.fullWidth,style:{width:"calc(100% - 64px)"}},{props:({ownerState:e})=>e.fullScreen,style:{margin:0,width:"100%",maxWidth:"100%",height:"100%",maxHeight:"none",borderRadius:0,[`&.${c3.paperScrollBody}`]:{margin:0,maxWidth:"100%"}}}]}))),JR=ee.forwardRef(function(e,r){const n=_i({props:e,name:"MuiDialog"}),i=Tc(),a={enter:i.transitions.duration.enteringScreen,exit:i.transitions.duration.leavingScreen},{"aria-describedby":s,"aria-labelledby":o,"aria-modal":u=!0,BackdropComponent:h,BackdropProps:f,children:g,className:b,disableEscapeKeyDown:v=!1,fullScreen:S=!1,fullWidth:E=!1,maxWidth:P="sm",onClick:k,onClose:L,open:O,PaperComponent:M=Th,PaperProps:z={},scroll:B="paper",slots:q={},slotProps:W={},TransitionComponent:G=MP,transitionDuration:ie=a,TransitionProps:Q,...H}=n,ne={...n,disableEscapeKeyDown:v,fullScreen:S,fullWidth:E,maxWidth:P,scroll:B},oe=lfe(ne),ce=ee.useRef(),fe=Mt=>{ce.current=Mt.target===Mt.currentTarget},Me=Mt=>{k&&k(Mt),ce.current&&(ce.current=null,L&&L(Mt,"backdropClick"))},me=ag(o),we=ee.useMemo(()=>({titleId:me}),[me]),Te={transition:G,...q},ke={transition:Q,paper:z,backdrop:f,...W},he={slots:Te,slotProps:ke},[Ee,xe]=Si("root",{elementType:ufe,shouldForwardComponentProp:!0,externalForwardedProps:he,ownerState:ne,className:Sn(oe.root,b),ref:r}),[Ne,Oe]=Si("backdrop",{elementType:sfe,shouldForwardComponentProp:!0,externalForwardedProps:he,ownerState:ne}),[$e,De]=Si("paper",{elementType:hfe,shouldForwardComponentProp:!0,externalForwardedProps:he,ownerState:ne,className:Sn(oe.paper,z.className)}),[it,Ye]=Si("container",{elementType:cfe,externalForwardedProps:he,ownerState:ne,className:oe.container}),[rt,Ie]=Si("transition",{elementType:MP,externalForwardedProps:he,ownerState:ne,additionalProps:{appear:!0,in:O,timeout:ie,role:"presentation"}});return K.jsx(Ee,{closeAfterTransition:!0,slots:{backdrop:Ne},slotProps:{backdrop:{transitionDuration:ie,as:h,...Oe}},disableEscapeKeyDown:v,onClose:L,open:O,onClick:Me,...xe,...H,children:K.jsx(rt,{...Ie,children:K.jsx(it,{onMouseDown:fe,...Ye,children:K.jsx($e,{as:M,elevation:24,role:"dialog","aria-describedby":s,"aria-labelledby":me,"aria-modal":u,...De,children:K.jsx(bG.Provider,{value:we,children:g})})})})})});function ffe(t){return fi("MuiDialogActions",t)}ui("MuiDialogActions",["root","spacing"]);const dfe=t=>{const{classes:e,disableSpacing:r}=t;return di({root:["root",!r&&"spacing"]},ffe,e)},pfe=Pr("div",{name:"MuiDialogActions",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.root,!r.disableSpacing&&e.spacing]}})({display:"flex",alignItems:"center",padding:8,justifyContent:"flex-end",flex:"0 0 auto",variants:[{props:({ownerState:t})=>!t.disableSpacing,style:{"& > :not(style) ~ :not(style)":{marginLeft:8}}}]}),Wb=ee.forwardRef(function(e,r){const n=_i({props:e,name:"MuiDialogActions"}),{className:i,disableSpacing:a=!1,...s}=n,o={...n,disableSpacing:a},u=dfe(o);return K.jsx(pfe,{className:Sn(u.root,i),ownerState:o,ref:r,...s})});function gfe(t){return fi("MuiDialogContent",t)}ui("MuiDialogContent",["root","dividers"]);function mfe(t){return fi("MuiDialogTitle",t)}const yfe=ui("MuiDialogTitle",["root"]),vfe=t=>{const{classes:e,dividers:r}=t;return di({root:["root",r&&"dividers"]},gfe,e)},_fe=Pr("div",{name:"MuiDialogContent",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.root,r.dividers&&e.dividers]}})(si(({theme:t})=>({flex:"1 1 auto",WebkitOverflowScrolling:"touch",overflowY:"auto",padding:"20px 24px",variants:[{props:({ownerState:e})=>e.dividers,style:{padding:"16px 24px",borderTop:`1px solid ${(t.vars||t).palette.divider}`,borderBottom:`1px solid ${(t.vars||t).palette.divider}`}},{props:({ownerState:e})=>!e.dividers,style:{[`.${yfe.root} + &`]:{paddingTop:0}}}]}))),QR=ee.forwardRef(function(e,r){const n=_i({props:e,name:"MuiDialogContent"}),{className:i,dividers:a=!1,...s}=n,o={...n,dividers:a},u=vfe(o);return K.jsx(_fe,{className:Sn(u.root,i),ownerState:o,ref:r,...s})});function bfe(t){return fi("MuiDialogContentText",t)}ui("MuiDialogContentText",["root"]);const xfe=t=>{const{classes:e}=t,n=di({root:["root"]},bfe,e);return{...e,...n}},wfe=Pr(vs,{shouldForwardProp:t=>yl(t)||t==="classes",name:"MuiDialogContentText",slot:"Root"})({}),Sfe=ee.forwardRef(function(e,r){const n=_i({props:e,name:"MuiDialogContentText"}),{children:i,className:a,...s}=n,o=xfe(s);return K.jsx(wfe,{component:"p",variant:"body1",color:"textSecondary",ref:r,ownerState:s,className:Sn(o.root,a),...n,classes:o})}),Efe=t=>{const{classes:e}=t;return di({root:["root"]},mfe,e)},Tfe=Pr(vs,{name:"MuiDialogTitle",slot:"Root"})({padding:"16px 24px",flex:"0 0 auto"}),Bm=ee.forwardRef(function(e,r){const n=_i({props:e,name:"MuiDialogTitle"}),{className:i,id:a,...s}=n,o=n,u=Efe(o),{titleId:h=a}=ee.useContext(bG);return K.jsx(Tfe,{component:"h2",className:Sn(u.root,i),ownerState:o,ref:r,variant:"h6",id:a??h,...s})});function Cfe(t){return fi("MuiDivider",t)}const n8=ui("MuiDivider",["root","absolute","fullWidth","inset","middle","flexItem","light","vertical","withChildren","withChildrenVertical","textAlignRight","textAlignLeft","wrapper","wrapperVertical"]),Afe=t=>{const{absolute:e,children:r,classes:n,flexItem:i,light:a,orientation:s,textAlign:o,variant:u}=t;return di({root:["root",e&&"absolute",u,a&&"light",s==="vertical"&&"vertical",i&&"flexItem",r&&"withChildren",r&&s==="vertical"&&"withChildrenVertical",o==="right"&&s!=="vertical"&&"textAlignRight",o==="left"&&s!=="vertical"&&"textAlignLeft"],wrapper:["wrapper",s==="vertical"&&"wrapperVertical"]},Cfe,n)},Ife=Pr("div",{name:"MuiDivider",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.root,r.absolute&&e.absolute,e[r.variant],r.light&&e.light,r.orientation==="vertical"&&e.vertical,r.flexItem&&e.flexItem,r.children&&e.withChildren,r.children&&r.orientation==="vertical"&&e.withChildrenVertical,r.textAlign==="right"&&r.orientation!=="vertical"&&e.textAlignRight,r.textAlign==="left"&&r.orientation!=="vertical"&&e.textAlignLeft]}})(si(({theme:t})=>({margin:0,flexShrink:0,borderWidth:0,borderStyle:"solid",borderColor:(t.vars||t).palette.divider,borderBottomWidth:"thin",variants:[{props:{absolute:!0},style:{position:"absolute",bottom:0,left:0,width:"100%"}},{props:{light:!0},style:{borderColor:t.alpha((t.vars||t).palette.divider,.08)}},{props:{variant:"inset"},style:{marginLeft:72}},{props:{variant:"middle",orientation:"horizontal"},style:{marginLeft:t.spacing(2),marginRight:t.spacing(2)}},{props:{variant:"middle",orientation:"vertical"},style:{marginTop:t.spacing(1),marginBottom:t.spacing(1)}},{props:{orientation:"vertical"},style:{height:"100%",borderBottomWidth:0,borderRightWidth:"thin"}},{props:{flexItem:!0},style:{alignSelf:"stretch",height:"auto"}},{props:({ownerState:e})=>!!e.children,style:{display:"flex",textAlign:"center",border:0,borderTopStyle:"solid",borderLeftStyle:"solid","&::before, &::after":{content:'""',alignSelf:"center"}}},{props:({ownerState:e})=>e.children&&e.orientation!=="vertical",style:{"&::before, &::after":{width:"100%",borderTop:`thin solid ${(t.vars||t).palette.divider}`,borderTopStyle:"inherit"}}},{props:({ownerState:e})=>e.orientation==="vertical"&&e.children,style:{flexDirection:"column","&::before, &::after":{height:"100%",borderLeft:`thin solid ${(t.vars||t).palette.divider}`,borderLeftStyle:"inherit"}}},{props:({ownerState:e})=>e.textAlign==="right"&&e.orientation!=="vertical",style:{"&::before":{width:"90%"},"&::after":{width:"10%"}}},{props:({ownerState:e})=>e.textAlign==="left"&&e.orientation!=="vertical",style:{"&::before":{width:"10%"},"&::after":{width:"90%"}}}]}))),Pfe=Pr("span",{name:"MuiDivider",slot:"Wrapper",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.wrapper,r.orientation==="vertical"&&e.wrapperVertical]}})(si(({theme:t})=>({display:"inline-block",paddingLeft:`calc(${t.spacing(1)} * 1.2)`,paddingRight:`calc(${t.spacing(1)} * 1.2)`,whiteSpace:"nowrap",variants:[{props:{orientation:"vertical"},style:{paddingTop:`calc(${t.spacing(1)} * 1.2)`,paddingBottom:`calc(${t.spacing(1)} * 1.2)`}}]}))),OP=ee.forwardRef(function(e,r){const n=_i({props:e,name:"MuiDivider"}),{absolute:i=!1,children:a,className:s,orientation:o="horizontal",component:u=a||o==="vertical"?"div":"hr",flexItem:h=!1,light:f=!1,role:g=u!=="hr"?"separator":void 0,textAlign:b="center",variant:v="fullWidth",...S}=n,E={...n,absolute:i,component:u,flexItem:h,light:f,orientation:o,role:g,textAlign:b,variant:v},P=Afe(E);return K.jsx(Ife,{as:u,className:Sn(P.root,s),role:g,ref:r,ownerState:E,"aria-orientation":g==="separator"&&(u!=="hr"||o==="vertical")?o:void 0,...S,children:a?K.jsx(Pfe,{className:P.wrapper,ownerState:E,children:a}):null})});OP&&(OP.muiSkipListHighlight=!0);function kfe(t,e,r){const n=e.getBoundingClientRect(),i=r&&r.getBoundingClientRect(),a=sc(e);let s;if(e.fakeTransform)s=e.fakeTransform;else{const h=a.getComputedStyle(e);s=h.getPropertyValue("-webkit-transform")||h.getPropertyValue("transform")}let o=0,u=0;if(s&&s!=="none"&&typeof s=="string"){const h=s.split("(")[1].split(")")[0].split(",");o=parseInt(h[4],10),u=parseInt(h[5],10)}return t==="left"?i?`translateX(${i.right+o-n.left}px)`:`translateX(${a.innerWidth+o-n.left}px)`:t==="right"?i?`translateX(-${n.right-i.left-o}px)`:`translateX(-${n.left+n.width-o}px)`:t==="up"?i?`translateY(${i.bottom+u-n.top}px)`:`translateY(${a.innerHeight+u-n.top}px)`:i?`translateY(-${n.top-i.top+n.height-u}px)`:`translateY(-${n.top+n.height-u}px)`}function Mfe(t){return typeof t=="function"?t():t}function Hx(t,e,r){const n=Mfe(r),i=kfe(t,e,n);i&&(e.style.webkitTransform=i,e.style.transform=i)}const Rfe=ee.forwardRef(function(e,r){const n=Tc(),i={enter:n.transitions.easing.easeOut,exit:n.transitions.easing.sharp},a={enter:n.transitions.duration.enteringScreen,exit:n.transitions.duration.leavingScreen},{addEndListener:s,appear:o=!0,children:u,container:h,direction:f="down",easing:g=i,in:b,onEnter:v,onEntered:S,onEntering:E,onExit:P,onExited:k,onExiting:L,style:O,timeout:M=a,TransitionComponent:z=Dh,...B}=e,q=ee.useRef(null),W=Lo(lg(u),q,r),G=me=>we=>{me&&(we===void 0?me(q.current):me(q.current,we))},ie=G((me,we)=>{Hx(f,me,h),UR(me),v&&v(me,we)}),Q=G((me,we)=>{const Te=Hd({timeout:M,style:O,easing:g},{mode:"enter"});me.style.webkitTransition=n.transitions.create("-webkit-transform",{...Te}),me.style.transition=n.transitions.create("transform",{...Te}),me.style.webkitTransform="none",me.style.transform="none",E&&E(me,we)}),H=G(S),ne=G(L),oe=G(me=>{const we=Hd({timeout:M,style:O,easing:g},{mode:"exit"});me.style.webkitTransition=n.transitions.create("-webkit-transform",we),me.style.transition=n.transitions.create("transform",we),Hx(f,me,h),P&&P(me)}),ce=G(me=>{me.style.webkitTransition="",me.style.transition="",k&&k(me)}),fe=me=>{s&&s(q.current,me)},Me=ee.useCallback(()=>{q.current&&Hx(f,q.current,h)},[f,h]);return ee.useEffect(()=>{if(b||f==="down"||f==="right")return;const me=BR(()=>{q.current&&Hx(f,q.current,h)}),we=sc(q.current);return we.addEventListener("resize",me),()=>{me.clear(),we.removeEventListener("resize",me)}},[f,b,h]),ee.useEffect(()=>{b||Me()},[b,Me]),K.jsx(z,{nodeRef:q,onEnter:ie,onEntered:H,onEntering:Q,onExit:oe,onExited:ce,onExiting:ne,addEndListener:fe,appear:o,in:b,timeout:M,...B,children:(me,{ownerState:we,...Te})=>ee.cloneElement(u,{ref:W,style:{visibility:me==="exited"&&!b?"hidden":void 0,...O,...u.props.style},...Te})})});function Ofe(t){return fi("MuiDrawer",t)}ui("MuiDrawer",["root","docked","paper","anchorLeft","anchorRight","anchorTop","anchorBottom","paperAnchorLeft","paperAnchorRight","paperAnchorTop","paperAnchorBottom","paperAnchorDockedLeft","paperAnchorDockedRight","paperAnchorDockedTop","paperAnchorDockedBottom","modal"]);const xG=(t,e)=>{const{ownerState:r}=t;return[e.root,(r.variant==="permanent"||r.variant==="persistent")&&e.docked,e.modal]},Lfe=t=>{const{classes:e,anchor:r,variant:n}=t,i={root:["root",`anchor${on(r)}`],docked:[(n==="permanent"||n==="persistent")&&"docked"],modal:["modal"],paper:["paper",`paperAnchor${on(r)}`,n!=="temporary"&&`paperAnchorDocked${on(r)}`]};return di(i,Ofe,e)},Nfe=Pr(KR,{name:"MuiDrawer",slot:"Root",overridesResolver:xG})(si(({theme:t})=>({zIndex:(t.vars||t).zIndex.drawer}))),Dfe=Pr("div",{shouldForwardProp:yl,name:"MuiDrawer",slot:"Docked",skipVariantsResolver:!1,overridesResolver:xG})({flex:"0 0 auto"}),Ffe=Pr(Th,{name:"MuiDrawer",slot:"Paper",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.paper,e[`paperAnchor${on(r.anchor)}`],r.variant!=="temporary"&&e[`paperAnchorDocked${on(r.anchor)}`]]}})(si(({theme:t})=>({overflowY:"auto",display:"flex",flexDirection:"column",height:"100%",flex:"1 0 auto",zIndex:(t.vars||t).zIndex.drawer,WebkitOverflowScrolling:"touch",position:"fixed",top:0,outline:0,variants:[{props:{anchor:"left"},style:{left:0}},{props:{anchor:"top"},style:{top:0,left:0,right:0,height:"auto",maxHeight:"100%"}},{props:{anchor:"right"},style:{right:0}},{props:{anchor:"bottom"},style:{top:"auto",left:0,bottom:0,right:0,height:"auto",maxHeight:"100%"}},{props:({ownerState:e})=>e.anchor==="left"&&e.variant!=="temporary",style:{borderRight:`1px solid ${(t.vars||t).palette.divider}`}},{props:({ownerState:e})=>e.anchor==="top"&&e.variant!=="temporary",style:{borderBottom:`1px solid ${(t.vars||t).palette.divider}`}},{props:({ownerState:e})=>e.anchor==="right"&&e.variant!=="temporary",style:{borderLeft:`1px solid ${(t.vars||t).palette.divider}`}},{props:({ownerState:e})=>e.anchor==="bottom"&&e.variant!=="temporary",style:{borderTop:`1px solid ${(t.vars||t).palette.divider}`}}]}))),wG={left:"right",right:"left",top:"down",bottom:"up"};function Vg(t){return["left","right"].includes(t)}function X_({direction:t},e){return t==="rtl"&&Vg(e)?wG[e]:e}const eO=ee.forwardRef(function(e,r){const n=_i({props:e,name:"MuiDrawer"}),i=Tc(),a=$b(),s={enter:i.transitions.duration.enteringScreen,exit:i.transitions.duration.leavingScreen},{anchor:o="left",BackdropProps:u,children:h,className:f,elevation:g=16,hideBackdrop:b=!1,ModalProps:{BackdropProps:v,...S}={},onClose:E,open:P=!1,PaperProps:k={},SlideProps:L,TransitionComponent:O,transitionDuration:M=s,variant:z="temporary",slots:B={},slotProps:q={},...W}=n,G=ee.useRef(!1);ee.useEffect(()=>{G.current=!0},[]);const ie=X_({direction:a?"rtl":"ltr"},o),H={...n,anchor:o,elevation:g,open:P,variant:z,...W},ne=Lfe(H),oe={slots:{transition:O,...B},slotProps:{paper:k,transition:L,...q,backdrop:Y1(q.backdrop||{...u,...v},{transitionDuration:M})}},[ce,fe]=Si("root",{ref:r,elementType:Nfe,className:Sn(ne.root,ne.modal,f),shouldForwardComponentProp:!0,ownerState:H,externalForwardedProps:{...oe,...W,...S},additionalProps:{open:P,onClose:E,hideBackdrop:b,slots:{backdrop:oe.slots.backdrop},slotProps:{backdrop:oe.slotProps.backdrop}}}),[Me,me]=Si("paper",{elementType:Ffe,shouldForwardComponentProp:!0,className:Sn(ne.paper,k.className),ownerState:H,externalForwardedProps:oe,additionalProps:{elevation:z==="temporary"?g:0,square:!0,...z==="temporary"&&{role:"dialog","aria-modal":"true"}}}),[we,Te]=Si("docked",{elementType:Dfe,ref:r,className:Sn(ne.root,ne.docked,f),ownerState:H,externalForwardedProps:oe,additionalProps:W}),[ke,he]=Si("transition",{elementType:Rfe,ownerState:H,externalForwardedProps:oe,additionalProps:{in:P,direction:wG[ie],timeout:M,appear:G.current}}),Ee=K.jsx(Me,{...me,children:h});if(z==="permanent")return K.jsx(we,{...Te,children:Ee});const xe=K.jsx(ke,{...he,children:Ee});return z==="persistent"?K.jsx(we,{...Te,children:xe}):K.jsx(ce,{...fe,children:xe})}),Bfe=t=>{const{classes:e,disableUnderline:r,startAdornment:n,endAdornment:i,size:a,hiddenLabel:s,multiline:o}=t,u={root:["root",!r&&"underline",n&&"adornedStart",i&&"adornedEnd",a==="small"&&`size${on(a)}`,s&&"hiddenLabel",o&&"multiline"],input:["input"]},h=di(u,ehe,e);return{...e,...h}},zfe=Pr(eT,{shouldForwardProp:t=>yl(t)||t==="classes",name:"MuiFilledInput",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[...JE(t,e),!r.disableUnderline&&e.underline]}})(si(({theme:t})=>{const e=t.palette.mode==="light",r=e?"rgba(0, 0, 0, 0.42)":"rgba(255, 255, 255, 0.7)",n=e?"rgba(0, 0, 0, 0.06)":"rgba(255, 255, 255, 0.09)",i=e?"rgba(0, 0, 0, 0.09)":"rgba(255, 255, 255, 0.13)",a=e?"rgba(0, 0, 0, 0.12)":"rgba(255, 255, 255, 0.12)";return{position:"relative",backgroundColor:t.vars?t.vars.palette.FilledInput.bg:n,borderTopLeftRadius:(t.vars||t).shape.borderRadius,borderTopRightRadius:(t.vars||t).shape.borderRadius,transition:t.transitions.create("background-color",{duration:t.transitions.duration.shorter,easing:t.transitions.easing.easeOut}),"&:hover":{backgroundColor:t.vars?t.vars.palette.FilledInput.hoverBg:i,"@media (hover: none)":{backgroundColor:t.vars?t.vars.palette.FilledInput.bg:n}},[`&.${Mg.focused}`]:{backgroundColor:t.vars?t.vars.palette.FilledInput.bg:n},[`&.${Mg.disabled}`]:{backgroundColor:t.vars?t.vars.palette.FilledInput.disabledBg:a},variants:[{props:({ownerState:s})=>!s.disableUnderline,style:{"&::after":{left:0,bottom:0,content:'""',position:"absolute",right:0,transform:"scaleX(0)",transition:t.transitions.create("transform",{duration:t.transitions.duration.shorter,easing:t.transitions.easing.easeOut}),pointerEvents:"none"},[`&.${Mg.focused}:after`]:{transform:"scaleX(1) translateX(0)"},[`&.${Mg.error}`]:{"&::before, &::after":{borderBottomColor:(t.vars||t).palette.error.main}},"&::before":{borderBottom:`1px solid ${t.vars?t.alpha(t.vars.palette.common.onBackground,t.vars.opacity.inputUnderline):r}`,left:0,bottom:0,content:'"\\00a0"',position:"absolute",right:0,transition:t.transitions.create("border-bottom-color",{duration:t.transitions.duration.shorter}),pointerEvents:"none"},[`&:hover:not(.${Mg.disabled}, .${Mg.error}):before`]:{borderBottom:`1px solid ${(t.vars||t).palette.text.primary}`},[`&.${Mg.disabled}:before`]:{borderBottomStyle:"dotted"}}},...Object.entries(t.palette).filter(Nl()).map(([s])=>({props:{disableUnderline:!1,color:s},style:{"&::after":{borderBottom:`2px solid ${(t.vars||t).palette[s]?.main}`}}})),{props:({ownerState:s})=>s.startAdornment,style:{paddingLeft:12}},{props:({ownerState:s})=>s.endAdornment,style:{paddingRight:12}},{props:({ownerState:s})=>s.multiline,style:{padding:"25px 12px 8px"}},{props:({ownerState:s,size:o})=>s.multiline&&o==="small",style:{paddingTop:21,paddingBottom:4}},{props:({ownerState:s})=>s.multiline&&s.hiddenLabel,style:{paddingTop:16,paddingBottom:17}},{props:({ownerState:s})=>s.multiline&&s.hiddenLabel&&s.size==="small",style:{paddingTop:8,paddingBottom:9}}]}})),jfe=Pr(tT,{name:"MuiFilledInput",slot:"Input",overridesResolver:QE})(si(({theme:t})=>({paddingTop:25,paddingRight:12,paddingBottom:8,paddingLeft:12,...!t.vars&&{"&:-webkit-autofill":{WebkitBoxShadow:t.palette.mode==="light"?null:"0 0 0 100px #266798 inset",WebkitTextFillColor:t.palette.mode==="light"?null:"#fff",caretColor:t.palette.mode==="light"?null:"#fff",borderTopLeftRadius:"inherit",borderTopRightRadius:"inherit"}},...t.vars&&{"&:-webkit-autofill":{borderTopLeftRadius:"inherit",borderTopRightRadius:"inherit"},[t.getColorSchemeSelector("dark")]:{"&:-webkit-autofill":{WebkitBoxShadow:"0 0 0 100px #266798 inset",WebkitTextFillColor:"#fff",caretColor:"#fff"}}},variants:[{props:{size:"small"},style:{paddingTop:21,paddingBottom:4}},{props:({ownerState:e})=>e.hiddenLabel,style:{paddingTop:16,paddingBottom:17}},{props:({ownerState:e})=>e.startAdornment,style:{paddingLeft:0}},{props:({ownerState:e})=>e.endAdornment,style:{paddingRight:0}},{props:({ownerState:e})=>e.hiddenLabel&&e.size==="small",style:{paddingTop:8,paddingBottom:9}},{props:({ownerState:e})=>e.multiline,style:{paddingTop:0,paddingBottom:0,paddingLeft:0,paddingRight:0}}]}))),tO=ee.forwardRef(function(e,r){const n=_i({props:e,name:"MuiFilledInput"}),{disableUnderline:i=!1,components:a={},componentsProps:s,fullWidth:o=!1,hiddenLabel:u,inputComponent:h="input",multiline:f=!1,slotProps:g,slots:b={},type:v="text",...S}=n,E={...n,disableUnderline:i,fullWidth:o,inputComponent:h,multiline:f,type:v},P=Bfe(n),k={root:{ownerState:E},input:{ownerState:E}},L=g??s?Vu(k,g??s):k,O=b.root??a.Root??zfe,M=b.input??a.Input??jfe;return K.jsx(ZR,{slots:{root:O,input:M},slotProps:L,fullWidth:o,inputComponent:h,multiline:f,ref:r,type:v,...S,classes:P})});tO.muiName="Input";function Ufe(t){return fi("MuiFormControl",t)}ui("MuiFormControl",["root","marginNone","marginNormal","marginDense","fullWidth","disabled"]);const Vfe=t=>{const{classes:e,margin:r,fullWidth:n}=t,i={root:["root",r!=="none"&&`margin${on(r)}`,n&&"fullWidth"]};return di(i,Ufe,e)},$fe=Pr("div",{name:"MuiFormControl",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.root,e[`margin${on(r.margin)}`],r.fullWidth&&e.fullWidth]}})({display:"inline-flex",flexDirection:"column",position:"relative",minWidth:0,padding:0,margin:0,border:0,verticalAlign:"top",variants:[{props:{margin:"normal"},style:{marginTop:16,marginBottom:8}},{props:{margin:"dense"},style:{marginTop:8,marginBottom:4}},{props:{fullWidth:!0},style:{width:"100%"}}]}),Zc=ee.forwardRef(function(e,r){const n=_i({props:e,name:"MuiFormControl"}),{children:i,className:a,color:s="primary",component:o="div",disabled:u=!1,error:h=!1,focused:f,fullWidth:g=!1,hiddenLabel:b=!1,margin:v="none",required:S=!1,size:E="medium",variant:P="outlined",...k}=n,L={...n,color:s,component:o,disabled:u,error:h,fullWidth:g,hiddenLabel:b,margin:v,required:S,size:E,variant:P},O=Vfe(L),[M,z]=ee.useState(()=>{let ce=!1;return i&&ee.Children.forEach(i,fe=>{if(!_1(fe,["Input","Select"]))return;const Me=_1(fe,["Select"])?fe.props.input:fe;Me&&Yce(Me.props)&&(ce=!0)}),ce}),[B,q]=ee.useState(()=>{let ce=!1;return i&&ee.Children.forEach(i,fe=>{_1(fe,["Input","Select"])&&(Yw(fe.props,!0)||Yw(fe.props.inputProps,!0))&&(ce=!0)}),ce}),[W,G]=ee.useState(!1);u&&W&&G(!1);const ie=f!==void 0&&!u?f:W;let Q;ee.useRef(!1);const H=ee.useCallback(()=>{q(!0)},[]),ne=ee.useCallback(()=>{q(!1)},[]),oe=ee.useMemo(()=>({adornedStart:M,setAdornedStart:z,color:s,disabled:u,error:h,filled:B,focused:ie,fullWidth:g,hiddenLabel:b,size:E,onBlur:()=>{G(!1)},onFocus:()=>{G(!0)},onEmpty:ne,onFilled:H,registerEffect:Q,required:S,variant:P}),[M,s,u,h,B,ie,g,b,Q,ne,H,S,E,P]);return K.jsx(YR.Provider,{value:oe,children:K.jsx($fe,{as:o,ownerState:L,className:Sn(O.root,a),ref:r,...k,children:i})})});function qfe(t){return fi("MuiFormControlLabel",t)}const Y_=ui("MuiFormControlLabel",["root","labelPlacementStart","labelPlacementTop","labelPlacementBottom","disabled","label","error","required","asterisk"]),Hfe=t=>{const{classes:e,disabled:r,labelPlacement:n,error:i,required:a}=t,s={root:["root",r&&"disabled",`labelPlacement${on(n)}`,i&&"error",a&&"required"],label:["label",r&&"disabled"],asterisk:["asterisk",i&&"error"]};return di(s,qfe,e)},Wfe=Pr("label",{name:"MuiFormControlLabel",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[{[`& .${Y_.label}`]:e.label},e.root,e[`labelPlacement${on(r.labelPlacement)}`]]}})(si(({theme:t})=>({display:"inline-flex",alignItems:"center",cursor:"pointer",verticalAlign:"middle",WebkitTapHighlightColor:"transparent",marginLeft:-11,marginRight:16,[`&.${Y_.disabled}`]:{cursor:"default"},[`& .${Y_.label}`]:{[`&.${Y_.disabled}`]:{color:(t.vars||t).palette.text.disabled}},variants:[{props:{labelPlacement:"start"},style:{flexDirection:"row-reverse",marginRight:-11}},{props:{labelPlacement:"top"},style:{flexDirection:"column-reverse"}},{props:{labelPlacement:"bottom"},style:{flexDirection:"column"}},{props:({labelPlacement:e})=>e==="start"||e==="top"||e==="bottom",style:{marginLeft:16}}]}))),Gfe=Pr("span",{name:"MuiFormControlLabel",slot:"Asterisk"})(si(({theme:t})=>({[`&.${Y_.error}`]:{color:(t.vars||t).palette.error.main}}))),LP=ee.forwardRef(function(e,r){const n=_i({props:e,name:"MuiFormControlLabel"}),{checked:i,className:a,componentsProps:s={},control:o,disabled:u,disableTypography:h,inputRef:f,label:g,labelPlacement:b="end",name:v,onChange:S,required:E,slots:P={},slotProps:k={},value:L,...O}=n,M=sd(),z=u??o.props.disabled??M?.disabled,B=E??o.props.required,q={disabled:z,required:B};["checked","name","onChange","value","inputRef"].forEach(ce=>{typeof o.props[ce]>"u"&&typeof n[ce]<"u"&&(q[ce]=n[ce])});const W=ug({props:n,muiFormControl:M,states:["error"]}),G={...n,disabled:z,labelPlacement:b,required:B,error:W.error},ie=Hfe(G),Q={slots:P,slotProps:{...s,...k}},[H,ne]=Si("typography",{elementType:vs,externalForwardedProps:Q,ownerState:G});let oe=g;return oe!=null&&oe.type!==vs&&!h&&(oe=K.jsx(H,{component:"span",...ne,className:Sn(ie.label,ne?.className),children:oe})),K.jsxs(Wfe,{className:Sn(ie.root,a),ownerState:G,ref:r,...O,children:[ee.cloneElement(o,q),B?K.jsxs("div",{children:[oe,K.jsxs(Gfe,{ownerState:G,"aria-hidden":!0,className:ie.asterisk,children:["","*"]})]}):oe]})});function Xfe(t){return fi("MuiFormGroup",t)}ui("MuiFormGroup",["root","row","error"]);const Yfe=t=>{const{classes:e,row:r,error:n}=t;return di({root:["root",r&&"row",n&&"error"]},Xfe,e)},Zfe=Pr("div",{name:"MuiFormGroup",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.root,r.row&&e.row]}})({display:"flex",flexDirection:"column",flexWrap:"wrap",variants:[{props:{row:!0},style:{flexDirection:"row"}}]}),SG=ee.forwardRef(function(e,r){const n=_i({props:e,name:"MuiFormGroup"}),{className:i,row:a=!1,...s}=n,o=sd(),u=ug({props:n,muiFormControl:o,states:["error"]}),h={...n,row:a,error:u.error},f=Yfe(h);return K.jsx(Zfe,{className:Sn(f.root,i),ownerState:h,ref:r,...s})});function Kfe(t){return fi("MuiFormHelperText",t)}const i8=ui("MuiFormHelperText",["root","error","disabled","sizeSmall","sizeMedium","contained","focused","filled","required"]);var a8;const Jfe=t=>{const{classes:e,contained:r,size:n,disabled:i,error:a,filled:s,focused:o,required:u}=t,h={root:["root",i&&"disabled",a&&"error",n&&`size${on(n)}`,r&&"contained",o&&"focused",s&&"filled",u&&"required"]};return di(h,Kfe,e)},Qfe=Pr("p",{name:"MuiFormHelperText",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.root,r.size&&e[`size${on(r.size)}`],r.contained&&e.contained,r.filled&&e.filled]}})(si(({theme:t})=>({color:(t.vars||t).palette.text.secondary,...t.typography.caption,textAlign:"left",marginTop:3,marginRight:0,marginBottom:0,marginLeft:0,[`&.${i8.disabled}`]:{color:(t.vars||t).palette.text.disabled},[`&.${i8.error}`]:{color:(t.vars||t).palette.error.main},variants:[{props:{size:"small"},style:{marginTop:4}},{props:({ownerState:e})=>e.contained,style:{marginLeft:14,marginRight:14}}]}))),ede=ee.forwardRef(function(e,r){const n=_i({props:e,name:"MuiFormHelperText"}),{children:i,className:a,component:s="p",disabled:o,error:u,filled:h,focused:f,margin:g,required:b,variant:v,...S}=n,E=sd(),P=ug({props:n,muiFormControl:E,states:["variant","size","disabled","error","filled","focused","required"]}),k={...n,component:s,contained:P.variant==="filled"||P.variant==="outlined",variant:P.variant,size:P.size,disabled:P.disabled,error:P.error,filled:P.filled,focused:P.focused,required:P.required};delete k.ownerState;const L=Jfe(k);return K.jsx(Qfe,{as:s,className:Sn(L.root,a),ref:r,...S,ownerState:k,children:i===" "?a8||(a8=K.jsx("span",{className:"notranslate","aria-hidden":!0,children:""})):i})});function tde(t){return fi("MuiFormLabel",t)}const S1=ui("MuiFormLabel",["root","colorSecondary","focused","disabled","error","filled","required","asterisk"]),rde=t=>{const{classes:e,color:r,focused:n,disabled:i,error:a,filled:s,required:o}=t,u={root:["root",`color${on(r)}`,i&&"disabled",a&&"error",s&&"filled",n&&"focused",o&&"required"],asterisk:["asterisk",a&&"error"]};return di(u,tde,e)},nde=Pr("label",{name:"MuiFormLabel",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.root,r.color==="secondary"&&e.colorSecondary,r.filled&&e.filled]}})(si(({theme:t})=>({color:(t.vars||t).palette.text.secondary,...t.typography.body1,lineHeight:"1.4375em",padding:0,position:"relative",variants:[...Object.entries(t.palette).filter(Nl()).map(([e])=>({props:{color:e},style:{[`&.${S1.focused}`]:{color:(t.vars||t).palette[e].main}}})),{props:{},style:{[`&.${S1.disabled}`]:{color:(t.vars||t).palette.text.disabled},[`&.${S1.error}`]:{color:(t.vars||t).palette.error.main}}}]}))),ide=Pr("span",{name:"MuiFormLabel",slot:"Asterisk"})(si(({theme:t})=>({[`&.${S1.error}`]:{color:(t.vars||t).palette.error.main}}))),EG=ee.forwardRef(function(e,r){const n=_i({props:e,name:"MuiFormLabel"}),{children:i,className:a,color:s,component:o="label",disabled:u,error:h,filled:f,focused:g,required:b,...v}=n,S=sd(),E=ug({props:n,muiFormControl:S,states:["color","required","focused","disabled","error","filled"]}),P={...n,color:E.color||"primary",component:o,disabled:E.disabled,error:E.error,filled:E.filled,focused:E.focused,required:E.required},k=rde(P);return K.jsxs(nde,{as:o,ownerState:P,className:Sn(k.root,a),ref:r,...v,children:[i,E.required&&K.jsxs(ide,{ownerState:P,"aria-hidden":!0,className:k.asterisk,children:["","*"]})]})}),Dd=Tse({createStyledComponent:Pr("div",{name:"MuiGrid",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.root,r.container&&e.container]}}),componentName:"MuiGrid",useThemeProps:t=>_i({props:t,name:"MuiGrid"}),useTheme:Tc});function NP(t){return`scale(${t}, ${t**2})`}const ade={entering:{opacity:1,transform:NP(1)},entered:{opacity:1,transform:"none"}},h3=typeof navigator<"u"&&/^((?!chrome|android).)*(safari|mobile)/i.test(navigator.userAgent)&&/(os |version\/)15(.|_)4/i.test(navigator.userAgent),J1=ee.forwardRef(function(e,r){const{addEndListener:n,appear:i=!0,children:a,easing:s,in:o,onEnter:u,onEntered:h,onEntering:f,onExit:g,onExited:b,onExiting:v,style:S,timeout:E="auto",TransitionComponent:P=Dh,...k}=e,L=Lp(),O=ee.useRef(),M=Tc(),z=ee.useRef(null),B=Lo(z,lg(a),r),q=ce=>fe=>{if(ce){const Me=z.current;fe===void 0?ce(Me):ce(Me,fe)}},W=q(f),G=q((ce,fe)=>{UR(ce);const{duration:Me,delay:me,easing:we}=Hd({style:S,timeout:E,easing:s},{mode:"enter"});let Te;E==="auto"?(Te=M.transitions.getAutoHeightDuration(ce.clientHeight),O.current=Te):Te=Me,ce.style.transition=[M.transitions.create("opacity",{duration:Te,delay:me}),M.transitions.create("transform",{duration:h3?Te:Te*.666,delay:me,easing:we})].join(","),u&&u(ce,fe)}),ie=q(h),Q=q(v),H=q(ce=>{const{duration:fe,delay:Me,easing:me}=Hd({style:S,timeout:E,easing:s},{mode:"exit"});let we;E==="auto"?(we=M.transitions.getAutoHeightDuration(ce.clientHeight),O.current=we):we=fe,ce.style.transition=[M.transitions.create("opacity",{duration:we,delay:Me}),M.transitions.create("transform",{duration:h3?we:we*.666,delay:h3?Me:Me||we*.333,easing:me})].join(","),ce.style.opacity=0,ce.style.transform=NP(.75),g&&g(ce)}),ne=q(b),oe=ce=>{E==="auto"&&L.start(O.current||0,ce),n&&n(z.current,ce)};return K.jsx(P,{appear:i,in:o,nodeRef:z,onEnter:G,onEntered:ie,onEntering:W,onExit:H,onExited:ne,onExiting:Q,addEndListener:oe,timeout:E==="auto"?null:E,...k,children:(ce,{ownerState:fe,...Me})=>ee.cloneElement(a,{style:{opacity:0,transform:NP(.75),visibility:ce==="exited"&&!o?"hidden":void 0,...ade[ce],...S,...a.props.style},ref:B,...Me})})});J1&&(J1.muiSupportAuto=!0);const ode=t=>{const{classes:e,disableUnderline:r}=t,i=di({root:["root",!r&&"underline"],input:["input"]},Jce,e);return{...e,...i}},sde=Pr(eT,{shouldForwardProp:t=>yl(t)||t==="classes",name:"MuiInput",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[...JE(t,e),!r.disableUnderline&&e.underline]}})(si(({theme:t})=>{let r=t.palette.mode==="light"?"rgba(0, 0, 0, 0.42)":"rgba(255, 255, 255, 0.7)";return t.vars&&(r=t.alpha(t.vars.palette.common.onBackground,t.vars.opacity.inputUnderline)),{position:"relative",variants:[{props:({ownerState:n})=>n.formControl,style:{"label + &":{marginTop:16}}},{props:({ownerState:n})=>!n.disableUnderline,style:{"&::after":{left:0,bottom:0,content:'""',position:"absolute",right:0,transform:"scaleX(0)",transition:t.transitions.create("transform",{duration:t.transitions.duration.shorter,easing:t.transitions.easing.easeOut}),pointerEvents:"none"},[`&.${m_.focused}:after`]:{transform:"scaleX(1) translateX(0)"},[`&.${m_.error}`]:{"&::before, &::after":{borderBottomColor:(t.vars||t).palette.error.main}},"&::before":{borderBottom:`1px solid ${r}`,left:0,bottom:0,content:'"\\00a0"',position:"absolute",right:0,transition:t.transitions.create("border-bottom-color",{duration:t.transitions.duration.shorter}),pointerEvents:"none"},[`&:hover:not(.${m_.disabled}, .${m_.error}):before`]:{borderBottom:`2px solid ${(t.vars||t).palette.text.primary}`,"@media (hover: none)":{borderBottom:`1px solid ${r}`}},[`&.${m_.disabled}:before`]:{borderBottomStyle:"dotted"}}},...Object.entries(t.palette).filter(Nl()).map(([n])=>({props:{color:n,disableUnderline:!1},style:{"&::after":{borderBottom:`2px solid ${(t.vars||t).palette[n].main}`}}}))]}})),lde=Pr(tT,{name:"MuiInput",slot:"Input",overridesResolver:QE})({}),rO=ee.forwardRef(function(e,r){const n=_i({props:e,name:"MuiInput"}),{disableUnderline:i=!1,components:a={},componentsProps:s,fullWidth:o=!1,inputComponent:u="input",multiline:h=!1,slotProps:f,slots:g={},type:b="text",...v}=n,S=ode(n),P={root:{ownerState:{disableUnderline:i}}},k=f??s?Vu(f??s,P):P,L=g.root??a.Root??sde,O=g.input??a.Input??lde;return K.jsx(ZR,{slots:{root:L,input:O},slotProps:k,fullWidth:o,inputComponent:u,multiline:h,ref:r,type:b,...v,classes:S})});rO.muiName="Input";function ude(t){return fi("MuiInputLabel",t)}ui("MuiInputLabel",["root","focused","disabled","error","required","asterisk","formControl","sizeSmall","shrink","animated","standard","filled","outlined"]);const cde=t=>{const{classes:e,formControl:r,size:n,shrink:i,disableAnimation:a,variant:s,required:o}=t,u={root:["root",r&&"formControl",!a&&"animated",i&&"shrink",n&&n!=="medium"&&`size${on(n)}`,s],asterisk:[o&&"asterisk"]},h=di(u,ude,e);return{...e,...h}},hde=Pr(EG,{shouldForwardProp:t=>yl(t)||t==="classes",name:"MuiInputLabel",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[{[`& .${S1.asterisk}`]:e.asterisk},e.root,r.formControl&&e.formControl,r.size==="small"&&e.sizeSmall,r.shrink&&e.shrink,!r.disableAnimation&&e.animated,r.focused&&e.focused,e[r.variant]]}})(si(({theme:t})=>({display:"block",transformOrigin:"top left",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",maxWidth:"100%",variants:[{props:({ownerState:e})=>e.formControl,style:{position:"absolute",left:0,top:0,transform:"translate(0, 20px) scale(1)"}},{props:{size:"small"},style:{transform:"translate(0, 17px) scale(1)"}},{props:({ownerState:e})=>e.shrink,style:{transform:"translate(0, -1.5px) scale(0.75)",transformOrigin:"top left",maxWidth:"133%"}},{props:({ownerState:e})=>!e.disableAnimation,style:{transition:t.transitions.create(["color","transform","max-width"],{duration:t.transitions.duration.shorter,easing:t.transitions.easing.easeOut})}},{props:{variant:"filled"},style:{zIndex:1,pointerEvents:"none",transform:"translate(12px, 16px) scale(1)",maxWidth:"calc(100% - 24px)"}},{props:{variant:"filled",size:"small"},style:{transform:"translate(12px, 13px) scale(1)"}},{props:({variant:e,ownerState:r})=>e==="filled"&&r.shrink,style:{userSelect:"none",pointerEvents:"auto",transform:"translate(12px, 7px) scale(0.75)",maxWidth:"calc(133% - 24px)"}},{props:({variant:e,ownerState:r,size:n})=>e==="filled"&&r.shrink&&n==="small",style:{transform:"translate(12px, 4px) scale(0.75)"}},{props:{variant:"outlined"},style:{zIndex:1,pointerEvents:"none",transform:"translate(14px, 16px) scale(1)",maxWidth:"calc(100% - 24px)"}},{props:{variant:"outlined",size:"small"},style:{transform:"translate(14px, 9px) scale(1)"}},{props:({variant:e,ownerState:r})=>e==="outlined"&&r.shrink,style:{userSelect:"none",pointerEvents:"auto",maxWidth:"calc(133% - 32px)",transform:"translate(14px, -9px) scale(0.75)"}}]}))),$p=ee.forwardRef(function(e,r){const n=_i({name:"MuiInputLabel",props:e}),{disableAnimation:i=!1,margin:a,shrink:s,variant:o,className:u,...h}=n,f=sd();let g=s;typeof g>"u"&&f&&(g=f.filled||f.focused||f.adornedStart);const b=ug({props:n,muiFormControl:f,states:["size","variant","required","focused"]}),v={...n,disableAnimation:i,formControl:f,shrink:g,size:b.size,variant:b.variant,required:b.required,focused:b.focused},S=cde(v);return K.jsx(hde,{"data-shrink":g,ref:r,className:Sn(S.root,u),...h,ownerState:v,classes:S})}),bh=ee.createContext({});function fde(t){return fi("MuiList",t)}ui("MuiList",["root","padding","dense","subheader"]);const dde=t=>{const{classes:e,disablePadding:r,dense:n,subheader:i}=t;return di({root:["root",!r&&"padding",n&&"dense",i&&"subheader"]},fde,e)},pde=Pr("ul",{name:"MuiList",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.root,!r.disablePadding&&e.padding,r.dense&&e.dense,r.subheader&&e.subheader]}})({listStyle:"none",margin:0,padding:0,position:"relative",variants:[{props:({ownerState:t})=>!t.disablePadding,style:{paddingTop:8,paddingBottom:8}},{props:({ownerState:t})=>t.subheader,style:{paddingTop:0}}]}),ff=ee.forwardRef(function(e,r){const n=_i({props:e,name:"MuiList"}),{children:i,className:a,component:s="ul",dense:o=!1,disablePadding:u=!1,subheader:h,...f}=n,g=ee.useMemo(()=>({dense:o}),[o]),b={...n,component:s,dense:o,disablePadding:u},v=dde(b);return K.jsx(bh.Provider,{value:g,children:K.jsxs(pde,{as:s,className:Sn(v.root,a),ref:r,ownerState:b,...f,children:[h,i]})})});function gde(t){return fi("MuiListItem",t)}ui("MuiListItem",["root","container","dense","alignItemsFlexStart","divider","gutters","padding","secondaryAction"]);function mde(t){return fi("MuiListItemButton",t)}const Jy=ui("MuiListItemButton",["root","focusVisible","dense","alignItemsFlexStart","disabled","divider","gutters","selected"]),yde=(t,e)=>{const{ownerState:r}=t;return[e.root,r.dense&&e.dense,r.alignItems==="flex-start"&&e.alignItemsFlexStart,r.divider&&e.divider,!r.disableGutters&&e.gutters]},vde=t=>{const{alignItems:e,classes:r,dense:n,disabled:i,disableGutters:a,divider:s,selected:o}=t,h=di({root:["root",n&&"dense",!a&&"gutters",s&&"divider",i&&"disabled",e==="flex-start"&&"alignItemsFlexStart",o&&"selected"]},mde,r);return{...r,...h}},_de=Pr(M0,{shouldForwardProp:t=>yl(t)||t==="classes",name:"MuiListItemButton",slot:"Root",overridesResolver:yde})(si(({theme:t})=>({display:"flex",flexGrow:1,justifyContent:"flex-start",alignItems:"center",position:"relative",textDecoration:"none",minWidth:0,boxSizing:"border-box",textAlign:"left",paddingTop:8,paddingBottom:8,transition:t.transitions.create("background-color",{duration:t.transitions.duration.shortest}),"&:hover":{textDecoration:"none",backgroundColor:(t.vars||t).palette.action.hover,"@media (hover: none)":{backgroundColor:"transparent"}},[`&.${Jy.selected}`]:{backgroundColor:t.alpha((t.vars||t).palette.primary.main,(t.vars||t).palette.action.selectedOpacity),[`&.${Jy.focusVisible}`]:{backgroundColor:t.alpha((t.vars||t).palette.primary.main,`${(t.vars||t).palette.action.selectedOpacity} + ${(t.vars||t).palette.action.focusOpacity}`)}},[`&.${Jy.selected}:hover`]:{backgroundColor:t.alpha((t.vars||t).palette.primary.main,`${(t.vars||t).palette.action.selectedOpacity} + ${(t.vars||t).palette.action.hoverOpacity}`),"@media (hover: none)":{backgroundColor:t.alpha((t.vars||t).palette.primary.main,(t.vars||t).palette.action.selectedOpacity)}},[`&.${Jy.focusVisible}`]:{backgroundColor:(t.vars||t).palette.action.focus},[`&.${Jy.disabled}`]:{opacity:(t.vars||t).palette.action.disabledOpacity},variants:[{props:({ownerState:e})=>e.divider,style:{borderBottom:`1px solid ${(t.vars||t).palette.divider}`,backgroundClip:"padding-box"}},{props:{alignItems:"flex-start"},style:{alignItems:"flex-start"}},{props:({ownerState:e})=>!e.disableGutters,style:{paddingLeft:16,paddingRight:16}},{props:({ownerState:e})=>e.dense,style:{paddingTop:4,paddingBottom:4}}]}))),TG=ee.forwardRef(function(e,r){const n=_i({props:e,name:"MuiListItemButton"}),{alignItems:i="center",autoFocus:a=!1,component:s="div",children:o,dense:u=!1,disableGutters:h=!1,divider:f=!1,focusVisibleClassName:g,selected:b=!1,className:v,...S}=n,E=ee.useContext(bh),P=ee.useMemo(()=>({dense:u||E.dense||!1,alignItems:i,disableGutters:h}),[i,E.dense,u,h]),k=ee.useRef(null);yu(()=>{a&&k.current&&k.current.focus()},[a]);const L={...n,alignItems:i,dense:P.dense,disableGutters:h,divider:f,selected:b},O=vde(L),M=Lo(k,r);return K.jsx(bh.Provider,{value:P,children:K.jsx(_de,{ref:M,href:S.href||S.to,component:(S.href||S.to)&&s==="div"?"button":s,focusVisibleClassName:Sn(O.focusVisible,g),ownerState:L,className:Sn(O.root,v),...S,classes:O,children:o})})});function bde(t){return fi("MuiListItemSecondaryAction",t)}ui("MuiListItemSecondaryAction",["root","disableGutters"]);const xde=t=>{const{disableGutters:e,classes:r}=t;return di({root:["root",e&&"disableGutters"]},bde,r)},wde=Pr("div",{name:"MuiListItemSecondaryAction",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.root,r.disableGutters&&e.disableGutters]}})({position:"absolute",right:16,top:"50%",transform:"translateY(-50%)",variants:[{props:({ownerState:t})=>t.disableGutters,style:{right:0}}]}),CG=ee.forwardRef(function(e,r){const n=_i({props:e,name:"MuiListItemSecondaryAction"}),{className:i,...a}=n,s=ee.useContext(bh),o={...n,disableGutters:s.disableGutters},u=xde(o);return K.jsx(wde,{className:Sn(u.root,i),ownerState:o,ref:r,...a})});CG.muiName="ListItemSecondaryAction";const Sde=(t,e)=>{const{ownerState:r}=t;return[e.root,r.dense&&e.dense,r.alignItems==="flex-start"&&e.alignItemsFlexStart,r.divider&&e.divider,!r.disableGutters&&e.gutters,!r.disablePadding&&e.padding,r.hasSecondaryAction&&e.secondaryAction]},Ede=t=>{const{alignItems:e,classes:r,dense:n,disableGutters:i,disablePadding:a,divider:s,hasSecondaryAction:o}=t;return di({root:["root",n&&"dense",!i&&"gutters",!a&&"padding",s&&"divider",e==="flex-start"&&"alignItemsFlexStart",o&&"secondaryAction"],container:["container"]},gde,r)},Tde=Pr("div",{name:"MuiListItem",slot:"Root",overridesResolver:Sde})(si(({theme:t})=>({display:"flex",justifyContent:"flex-start",alignItems:"center",position:"relative",textDecoration:"none",width:"100%",boxSizing:"border-box",textAlign:"left",variants:[{props:({ownerState:e})=>!e.disablePadding,style:{paddingTop:8,paddingBottom:8}},{props:({ownerState:e})=>!e.disablePadding&&e.dense,style:{paddingTop:4,paddingBottom:4}},{props:({ownerState:e})=>!e.disablePadding&&!e.disableGutters,style:{paddingLeft:16,paddingRight:16}},{props:({ownerState:e})=>!e.disablePadding&&!!e.secondaryAction,style:{paddingRight:48}},{props:({ownerState:e})=>!!e.secondaryAction,style:{[`& > .${Jy.root}`]:{paddingRight:48}}},{props:{alignItems:"flex-start"},style:{alignItems:"flex-start"}},{props:({ownerState:e})=>e.divider,style:{borderBottom:`1px solid ${(t.vars||t).palette.divider}`,backgroundClip:"padding-box"}},{props:({ownerState:e})=>e.button,style:{transition:t.transitions.create("background-color",{duration:t.transitions.duration.shortest}),"&:hover":{textDecoration:"none",backgroundColor:(t.vars||t).palette.action.hover,"@media (hover: none)":{backgroundColor:"transparent"}}}},{props:({ownerState:e})=>e.hasSecondaryAction,style:{paddingRight:48}}]}))),Cde=Pr("li",{name:"MuiListItem",slot:"Container"})({position:"relative"}),Ih=ee.forwardRef(function(e,r){const n=_i({props:e,name:"MuiListItem"}),{alignItems:i="center",children:a,className:s,component:o,components:u={},componentsProps:h={},ContainerComponent:f="li",ContainerProps:{className:g,...b}={},dense:v=!1,disableGutters:S=!1,disablePadding:E=!1,divider:P=!1,secondaryAction:k,slotProps:L={},slots:O={},...M}=n,z=ee.useContext(bh),B=ee.useMemo(()=>({dense:v||z.dense||!1,alignItems:i,disableGutters:S}),[i,z.dense,v,S]),q=ee.useRef(null),W=ee.Children.toArray(a),G=W.length&&_1(W[W.length-1],["ListItemSecondaryAction"]),ie={...n,alignItems:i,dense:B.dense,disableGutters:S,disablePadding:E,divider:P,hasSecondaryAction:G},Q=Ede(ie),H=Lo(q,r),ne=O.root||u.Root||Tde,oe=L.root||h.root||{},ce={className:Sn(Q.root,oe.className,s),...M};let fe=o||"li";return G?(fe=!ce.component&&!o?"div":fe,f==="li"&&(fe==="li"?fe="div":ce.component==="li"&&(ce.component="div")),K.jsx(bh.Provider,{value:B,children:K.jsxs(Cde,{as:f,className:Sn(Q.container,g),ref:H,ownerState:ie,...b,children:[K.jsx(ne,{...oe,...!Zf(ne)&&{as:fe,ownerState:{...ie,...oe.ownerState}},...ce,children:W}),W.pop()]})})):K.jsx(bh.Provider,{value:B,children:K.jsxs(ne,{...oe,as:fe,ref:H,...!Zf(ne)&&{ownerState:{...ie,...oe.ownerState}},...ce,children:[W,k&&K.jsx(CG,{children:k})]})})});function Ade(t){return fi("MuiListItemAvatar",t)}ui("MuiListItemAvatar",["root","alignItemsFlexStart"]);const Ide=t=>{const{alignItems:e,classes:r}=t;return di({root:["root",e==="flex-start"&&"alignItemsFlexStart"]},Ade,r)},Pde=Pr("div",{name:"MuiListItemAvatar",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.root,r.alignItems==="flex-start"&&e.alignItemsFlexStart]}})({minWidth:56,flexShrink:0,variants:[{props:{alignItems:"flex-start"},style:{marginTop:8}}]}),AG=ee.forwardRef(function(e,r){const n=_i({props:e,name:"MuiListItemAvatar"}),{className:i,...a}=n,s=ee.useContext(bh),o={...n,alignItems:s.alignItems},u=Ide(o);return K.jsx(Pde,{className:Sn(u.root,i),ownerState:o,ref:r,...a})});function kde(t){return fi("MuiListItemIcon",t)}const o8=ui("MuiListItemIcon",["root","alignItemsFlexStart"]),Mde=t=>{const{alignItems:e,classes:r}=t;return di({root:["root",e==="flex-start"&&"alignItemsFlexStart"]},kde,r)},Rde=Pr("div",{name:"MuiListItemIcon",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.root,r.alignItems==="flex-start"&&e.alignItemsFlexStart]}})(si(({theme:t})=>({minWidth:56,color:(t.vars||t).palette.action.active,flexShrink:0,display:"inline-flex",variants:[{props:{alignItems:"flex-start"},style:{marginTop:8}}]}))),Q1=ee.forwardRef(function(e,r){const n=_i({props:e,name:"MuiListItemIcon"}),{className:i,...a}=n,s=ee.useContext(bh),o={...n,alignItems:s.alignItems},u=Mde(o);return K.jsx(Rde,{className:Sn(u.root,i),ownerState:o,ref:r,...a})});function Ode(t){return fi("MuiListItemText",t)}const xv=ui("MuiListItemText",["root","multiline","dense","inset","primary","secondary"]),Lde=t=>{const{classes:e,inset:r,primary:n,secondary:i,dense:a}=t;return di({root:["root",r&&"inset",a&&"dense",n&&i&&"multiline"],primary:["primary"],secondary:["secondary"]},Ode,e)},Nde=Pr("div",{name:"MuiListItemText",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[{[`& .${xv.primary}`]:e.primary},{[`& .${xv.secondary}`]:e.secondary},e.root,r.inset&&e.inset,r.primary&&r.secondary&&e.multiline,r.dense&&e.dense]}})({flex:"1 1 auto",minWidth:0,marginTop:4,marginBottom:4,[`.${DF.root}:where(& .${xv.primary})`]:{display:"block"},[`.${DF.root}:where(& .${xv.secondary})`]:{display:"block"},variants:[{props:({ownerState:t})=>t.primary&&t.secondary,style:{marginTop:6,marginBottom:6}},{props:({ownerState:t})=>t.inset,style:{paddingLeft:56}}]}),yh=ee.forwardRef(function(e,r){const n=_i({props:e,name:"MuiListItemText"}),{children:i,className:a,disableTypography:s=!1,inset:o=!1,primary:u,primaryTypographyProps:h,secondary:f,secondaryTypographyProps:g,slots:b={},slotProps:v={},...S}=n,{dense:E}=ee.useContext(bh);let P=u??i,k=f;const L={...n,disableTypography:s,inset:o,primary:!!P,secondary:!!k,dense:E},O=Lde(L),M={slots:b,slotProps:{primary:h,secondary:g,...v}},[z,B]=Si("root",{className:Sn(O.root,a),elementType:Nde,externalForwardedProps:{...M,...S},ownerState:L,ref:r}),[q,W]=Si("primary",{className:O.primary,elementType:vs,externalForwardedProps:M,ownerState:L}),[G,ie]=Si("secondary",{className:O.secondary,elementType:vs,externalForwardedProps:M,ownerState:L});return P!=null&&P.type!==vs&&!s&&(P=K.jsx(q,{variant:E?"body2":"body1",component:W?.variant?void 0:"span",...W,children:P})),k!=null&&k.type!==vs&&!s&&(k=K.jsx(G,{variant:"body2",color:"textSecondary",...ie,children:k})),K.jsxs(z,{...B,children:[P,k]})});function f3(t,e,r){return t===e?t.firstChild:e&&e.nextElementSibling?e.nextElementSibling:r?null:t.firstChild}function s8(t,e,r){return t===e?r?t.firstChild:t.lastChild:e&&e.previousElementSibling?e.previousElementSibling:r?null:t.lastChild}function IG(t,e){if(e===void 0)return!0;let r=t.innerText;return r===void 0&&(r=t.textContent),r=r.trim().toLowerCase(),r.length===0?!1:e.repeating?r[0]===e.keys[0]:r.startsWith(e.keys.join(""))}function y_(t,e,r,n,i,a){let s=!1,o=i(t,e,e?r:!1);for(;o;){if(o===t.firstChild){if(s)return!1;s=!0}const u=n?!1:o.disabled||o.getAttribute("aria-disabled")==="true";if(!o.hasAttribute("tabindex")||!IG(o,a)||u)o=i(t,o,r);else return o.focus(),!0}return!1}const Dde=ee.forwardRef(function(e,r){const{actions:n,autoFocus:i=!1,autoFocusItem:a=!1,children:s,className:o,disabledItemsFocusable:u=!1,disableListWrap:h=!1,onKeyDown:f,variant:g="selectedMenu",...b}=e,v=ee.useRef(null),S=ee.useRef({keys:[],repeating:!0,previousKeyMatched:!0,lastTime:null});yu(()=>{i&&v.current.focus()},[i]),ee.useImperativeHandle(n,()=>({adjustStyleForScrollbar:(O,{direction:M})=>{const z=!v.current.style.width;if(O.clientHeight<v.current.clientHeight&&z){const B=`${_G(sc(O))}px`;v.current.style[M==="rtl"?"paddingLeft":"paddingRight"]=B,v.current.style.width=`calc(100% + ${B})`}return v.current}}),[]);const E=O=>{const M=v.current,z=O.key;if(O.ctrlKey||O.metaKey||O.altKey){f&&f(O);return}const q=os(M).activeElement;if(z==="ArrowDown")O.preventDefault(),y_(M,q,h,u,f3);else if(z==="ArrowUp")O.preventDefault(),y_(M,q,h,u,s8);else if(z==="Home")O.preventDefault(),y_(M,null,h,u,f3);else if(z==="End")O.preventDefault(),y_(M,null,h,u,s8);else if(z.length===1){const W=S.current,G=z.toLowerCase(),ie=performance.now();W.keys.length>0&&(ie-W.lastTime>500?(W.keys=[],W.repeating=!0,W.previousKeyMatched=!0):W.repeating&&G!==W.keys[0]&&(W.repeating=!1)),W.lastTime=ie,W.keys.push(G);const Q=q&&!W.repeating&&IG(q,W);W.previousKeyMatched&&(Q||y_(M,q,!1,u,f3,W))?O.preventDefault():W.previousKeyMatched=!1}f&&f(O)},P=Lo(v,r);let k=-1;ee.Children.forEach(s,(O,M)=>{if(!ee.isValidElement(O)){k===M&&(k+=1,k>=s.length&&(k=-1));return}O.props.disabled||(g==="selectedMenu"&&O.props.selected||k===-1)&&(k=M),k===M&&(O.props.disabled||O.props.muiSkipListHighlight||O.type.muiSkipListHighlight)&&(k+=1,k>=s.length&&(k=-1))});const L=ee.Children.map(s,(O,M)=>{if(M===k){const z={};return a&&(z.autoFocus=!0),O.props.tabIndex===void 0&&g==="selectedMenu"&&(z.tabIndex=0),ee.cloneElement(O,z)}return O});return K.jsx(ff,{role:"menu",ref:P,className:o,onKeyDown:E,tabIndex:i?0:-1,...b,children:L})});function Fde(t){return fi("MuiPopover",t)}ui("MuiPopover",["root","paper"]);function l8(t,e){let r=0;return typeof e=="number"?r=e:e==="center"?r=t.height/2:e==="bottom"&&(r=t.height),r}function u8(t,e){let r=0;return typeof e=="number"?r=e:e==="center"?r=t.width/2:e==="right"&&(r=t.width),r}function c8(t){return[t.horizontal,t.vertical].map(e=>typeof e=="number"?`${e}px`:e).join(" ")}function Wx(t){return typeof t=="function"?t():t}const Bde=t=>{const{classes:e}=t;return di({root:["root"],paper:["paper"]},Fde,e)},zde=Pr(KR,{name:"MuiPopover",slot:"Root"})({}),PG=Pr(Th,{name:"MuiPopover",slot:"Paper"})({position:"absolute",overflowY:"auto",overflowX:"hidden",minWidth:16,minHeight:16,maxWidth:"calc(100% - 32px)",maxHeight:"calc(100% - 32px)",outline:0}),jde=ee.forwardRef(function(e,r){const n=_i({props:e,name:"MuiPopover"}),{action:i,anchorEl:a,anchorOrigin:s={vertical:"top",horizontal:"left"},anchorPosition:o,anchorReference:u="anchorEl",children:h,className:f,container:g,elevation:b=8,marginThreshold:v=16,open:S,PaperProps:E={},slots:P={},slotProps:k={},transformOrigin:L={vertical:"top",horizontal:"left"},TransitionComponent:O,transitionDuration:M="auto",TransitionProps:z={},disableScrollLock:B=!1,...q}=n,W=ee.useRef(),G={...n,anchorOrigin:s,anchorReference:u,elevation:b,marginThreshold:v,transformOrigin:L,TransitionComponent:O,transitionDuration:M,TransitionProps:z},ie=Bde(G),Q=ee.useCallback(()=>{if(u==="anchorPosition")return o;const Ye=Wx(a),Ie=(Ye&&Ye.nodeType===1?Ye:os(W.current).body).getBoundingClientRect();return{top:Ie.top+l8(Ie,s.vertical),left:Ie.left+u8(Ie,s.horizontal)}},[a,s.horizontal,s.vertical,o,u]),H=ee.useCallback(Ye=>({vertical:l8(Ye,L.vertical),horizontal:u8(Ye,L.horizontal)}),[L.horizontal,L.vertical]),ne=ee.useCallback(Ye=>{const rt={width:Ye.offsetWidth,height:Ye.offsetHeight},Ie=H(rt);if(u==="none")return{top:null,left:null,transformOrigin:c8(Ie)};const Mt=Q();let at=Mt.top-Ie.vertical,je=Mt.left-Ie.horizontal;const Xt=at+rt.height,Yt=je+rt.width,pr=sc(Wx(a)),vt=pr.innerHeight-v,yr=pr.innerWidth-v;if(v!==null&&at<v){const _r=at-v;at-=_r,Ie.vertical+=_r}else if(v!==null&&Xt>vt){const _r=Xt-vt;at-=_r,Ie.vertical+=_r}if(v!==null&&je<v){const _r=je-v;je-=_r,Ie.horizontal+=_r}else if(Yt>yr){const _r=Yt-yr;je-=_r,Ie.horizontal+=_r}return{top:`${Math.round(at)}px`,left:`${Math.round(je)}px`,transformOrigin:c8(Ie)}},[a,u,Q,H,v]),[oe,ce]=ee.useState(S),fe=ee.useCallback(()=>{const Ye=W.current;if(!Ye)return;const rt=ne(Ye);rt.top!==null&&Ye.style.setProperty("top",rt.top),rt.left!==null&&(Ye.style.left=rt.left),Ye.style.transformOrigin=rt.transformOrigin,ce(!0)},[ne]);ee.useEffect(()=>(B&&window.addEventListener("scroll",fe),()=>window.removeEventListener("scroll",fe)),[a,B,fe]);const Me=()=>{fe()},me=()=>{ce(!1)};ee.useEffect(()=>{S&&fe()}),ee.useImperativeHandle(i,()=>S?{updatePosition:()=>{fe()}}:null,[S,fe]),ee.useEffect(()=>{if(!S)return;const Ye=BR(()=>{fe()}),rt=sc(Wx(a));return rt.addEventListener("resize",Ye),()=>{Ye.clear(),rt.removeEventListener("resize",Ye)}},[a,S,fe]);let we=M;const Te={slots:{transition:O,...P},slotProps:{transition:z,paper:E,...k}},[ke,he]=Si("transition",{elementType:J1,externalForwardedProps:Te,ownerState:G,getSlotProps:Ye=>({...Ye,onEntering:(rt,Ie)=>{Ye.onEntering?.(rt,Ie),Me()},onExited:rt=>{Ye.onExited?.(rt),me()}}),additionalProps:{appear:!0,in:S}});M==="auto"&&!ke.muiSupportAuto&&(we=void 0);const Ee=g||(a?os(Wx(a)).body:void 0),[xe,{slots:Ne,slotProps:Oe,...$e}]=Si("root",{ref:r,elementType:zde,externalForwardedProps:{...Te,...q},shouldForwardComponentProp:!0,additionalProps:{slots:{backdrop:P.backdrop},slotProps:{backdrop:Y1(typeof k.backdrop=="function"?k.backdrop(G):k.backdrop,{invisible:!0})},container:Ee,open:S},ownerState:G,className:Sn(ie.root,f)}),[De,it]=Si("paper",{ref:W,className:ie.paper,elementType:PG,externalForwardedProps:Te,shouldForwardComponentProp:!0,additionalProps:{elevation:b,style:oe?void 0:{opacity:0}},ownerState:G});return K.jsx(xe,{...$e,...!Zf(xe)&&{slots:Ne,slotProps:Oe,disableScrollLock:B},children:K.jsx(ke,{...he,timeout:we,children:K.jsx(De,{...it,children:h})})})});function Ude(t){return fi("MuiMenu",t)}ui("MuiMenu",["root","paper","list"]);const Vde={vertical:"top",horizontal:"right"},$de={vertical:"top",horizontal:"left"},qde=t=>{const{classes:e}=t;return di({root:["root"],paper:["paper"],list:["list"]},Ude,e)},Hde=Pr(jde,{shouldForwardProp:t=>yl(t)||t==="classes",name:"MuiMenu",slot:"Root"})({}),Wde=Pr(PG,{name:"MuiMenu",slot:"Paper"})({maxHeight:"calc(100% - 96px)",WebkitOverflowScrolling:"touch"}),Gde=Pr(Dde,{name:"MuiMenu",slot:"List"})({outline:0}),kG=ee.forwardRef(function(e,r){const n=_i({props:e,name:"MuiMenu"}),{autoFocus:i=!0,children:a,className:s,disableAutoFocusItem:o=!1,MenuListProps:u={},onClose:h,open:f,PaperProps:g={},PopoverClasses:b,transitionDuration:v="auto",TransitionProps:{onEntering:S,...E}={},variant:P="selectedMenu",slots:k={},slotProps:L={},...O}=n,M=$b(),z={...n,autoFocus:i,disableAutoFocusItem:o,MenuListProps:u,onEntering:S,PaperProps:g,transitionDuration:v,TransitionProps:E,variant:P},B=qde(z),q=i&&!o&&f,W=ee.useRef(null),G=(we,Te)=>{W.current&&W.current.adjustStyleForScrollbar(we,{direction:M?"rtl":"ltr"}),S&&S(we,Te)},ie=we=>{we.key==="Tab"&&(we.preventDefault(),h&&h(we,"tabKeyDown"))};let Q=-1;ee.Children.map(a,(we,Te)=>{ee.isValidElement(we)&&(we.props.disabled||(P==="selectedMenu"&&we.props.selected||Q===-1)&&(Q=Te))});const H={slots:k,slotProps:{list:u,transition:E,paper:g,...L}},ne=zf({elementType:k.root,externalSlotProps:L.root,ownerState:z,className:[B.root,s]}),[oe,ce]=Si("paper",{className:B.paper,elementType:Wde,externalForwardedProps:H,shouldForwardComponentProp:!0,ownerState:z}),[fe,Me]=Si("list",{className:Sn(B.list,u.className),elementType:Gde,shouldForwardComponentProp:!0,externalForwardedProps:H,getSlotProps:we=>({...we,onKeyDown:Te=>{ie(Te),we.onKeyDown?.(Te)}}),ownerState:z}),me=typeof H.slotProps.transition=="function"?H.slotProps.transition(z):H.slotProps.transition;return K.jsx(Hde,{onClose:h,anchorOrigin:{vertical:"bottom",horizontal:M?"right":"left"},transformOrigin:M?Vde:$de,slots:{root:k.root,paper:oe,backdrop:k.backdrop,...k.transition&&{transition:k.transition}},slotProps:{root:ne,paper:ce,backdrop:typeof L.backdrop=="function"?L.backdrop(z):L.backdrop,transition:{...me,onEntering:(...we)=>{G(...we),me?.onEntering?.(...we)}}},open:f,ref:r,transitionDuration:v,ownerState:z,...O,classes:b,children:K.jsx(fe,{actions:W,autoFocus:i&&(Q===-1||o),autoFocusItem:q,variant:P,...Me,children:a})})});function Xde(t){return fi("MuiMenuItem",t)}const v_=ui("MuiMenuItem",["root","focusVisible","dense","disabled","divider","gutters","selected"]),Yde=(t,e)=>{const{ownerState:r}=t;return[e.root,r.dense&&e.dense,r.divider&&e.divider,!r.disableGutters&&e.gutters]},Zde=t=>{const{disabled:e,dense:r,divider:n,disableGutters:i,selected:a,classes:s}=t,u=di({root:["root",r&&"dense",e&&"disabled",!i&&"gutters",n&&"divider",a&&"selected"]},Xde,s);return{...s,...u}},Kde=Pr(M0,{shouldForwardProp:t=>yl(t)||t==="classes",name:"MuiMenuItem",slot:"Root",overridesResolver:Yde})(si(({theme:t})=>({...t.typography.body1,display:"flex",justifyContent:"flex-start",alignItems:"center",position:"relative",textDecoration:"none",minHeight:48,paddingTop:6,paddingBottom:6,boxSizing:"border-box",whiteSpace:"nowrap","&:hover":{textDecoration:"none",backgroundColor:(t.vars||t).palette.action.hover,"@media (hover: none)":{backgroundColor:"transparent"}},[`&.${v_.selected}`]:{backgroundColor:t.alpha((t.vars||t).palette.primary.main,(t.vars||t).palette.action.selectedOpacity),[`&.${v_.focusVisible}`]:{backgroundColor:t.alpha((t.vars||t).palette.primary.main,`${(t.vars||t).palette.action.selectedOpacity} + ${(t.vars||t).palette.action.focusOpacity}`)}},[`&.${v_.selected}:hover`]:{backgroundColor:t.alpha((t.vars||t).palette.primary.main,`${(t.vars||t).palette.action.selectedOpacity} + ${(t.vars||t).palette.action.hoverOpacity}`),"@media (hover: none)":{backgroundColor:t.alpha((t.vars||t).palette.primary.main,(t.vars||t).palette.action.selectedOpacity)}},[`&.${v_.focusVisible}`]:{backgroundColor:(t.vars||t).palette.action.focus},[`&.${v_.disabled}`]:{opacity:(t.vars||t).palette.action.disabledOpacity},[`& + .${n8.root}`]:{marginTop:t.spacing(1),marginBottom:t.spacing(1)},[`& + .${n8.inset}`]:{marginLeft:52},[`& .${xv.root}`]:{marginTop:0,marginBottom:0},[`& .${xv.inset}`]:{paddingLeft:36},[`& .${o8.root}`]:{minWidth:36},variants:[{props:({ownerState:e})=>!e.disableGutters,style:{paddingLeft:16,paddingRight:16}},{props:({ownerState:e})=>e.divider,style:{borderBottom:`1px solid ${(t.vars||t).palette.divider}`,backgroundClip:"padding-box"}},{props:({ownerState:e})=>!e.dense,style:{[t.breakpoints.up("sm")]:{minHeight:"auto"}}},{props:({ownerState:e})=>e.dense,style:{minHeight:32,paddingTop:4,paddingBottom:4,...t.typography.body2,[`& .${o8.root} svg`]:{fontSize:"1.25rem"}}}]}))),im=ee.forwardRef(function(e,r){const n=_i({props:e,name:"MuiMenuItem"}),{autoFocus:i=!1,component:a="li",dense:s=!1,divider:o=!1,disableGutters:u=!1,focusVisibleClassName:h,role:f="menuitem",tabIndex:g,className:b,...v}=n,S=ee.useContext(bh),E=ee.useMemo(()=>({dense:s||S.dense||!1,disableGutters:u}),[S.dense,s,u]),P=ee.useRef(null);yu(()=>{i&&P.current&&P.current.focus()},[i]);const k={...n,dense:E.dense,divider:o,disableGutters:u},L=Zde(n),O=Lo(P,r);let M;return n.disabled||(M=g!==void 0?g:-1),K.jsx(bh.Provider,{value:E,children:K.jsx(Kde,{ref:O,role:f,tabIndex:M,component:a,focusVisibleClassName:Sn(L.focusVisible,h),className:Sn(L.root,b),...v,ownerState:k,classes:L})})});function Jde(t){return fi("MuiNativeSelect",t)}const nO=ui("MuiNativeSelect",["root","select","multiple","filled","outlined","standard","disabled","icon","iconOpen","iconFilled","iconOutlined","iconStandard","nativeInput","error"]),Qde=t=>{const{classes:e,variant:r,disabled:n,multiple:i,open:a,error:s}=t,o={select:["select",r,n&&"disabled",i&&"multiple",s&&"error"],icon:["icon",`icon${on(r)}`,a&&"iconOpen",n&&"disabled"]};return di(o,Jde,e)},MG=Pr("select",{name:"MuiNativeSelect"})(({theme:t})=>({MozAppearance:"none",WebkitAppearance:"none",userSelect:"none",borderRadius:0,cursor:"pointer","&:focus":{borderRadius:0},[`&.${nO.disabled}`]:{cursor:"default"},"&[multiple]":{height:"auto"},"&:not([multiple]) option, &:not([multiple]) optgroup":{backgroundColor:(t.vars||t).palette.background.paper},variants:[{props:({ownerState:e})=>e.variant!=="filled"&&e.variant!=="outlined",style:{"&&&":{paddingRight:24,minWidth:16}}},{props:{variant:"filled"},style:{"&&&":{paddingRight:32}}},{props:{variant:"outlined"},style:{borderRadius:(t.vars||t).shape.borderRadius,"&:focus":{borderRadius:(t.vars||t).shape.borderRadius},"&&&":{paddingRight:32}}}]})),epe=Pr(MG,{name:"MuiNativeSelect",slot:"Select",shouldForwardProp:yl,overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.select,e[r.variant],r.error&&e.error,{[`&.${nO.multiple}`]:e.multiple}]}})({}),RG=Pr("svg",{name:"MuiNativeSelect"})(({theme:t})=>({position:"absolute",right:0,top:"calc(50% - .5em)",pointerEvents:"none",color:(t.vars||t).palette.action.active,[`&.${nO.disabled}`]:{color:(t.vars||t).palette.action.disabled},variants:[{props:({ownerState:e})=>e.open,style:{transform:"rotate(180deg)"}},{props:{variant:"filled"},style:{right:7}},{props:{variant:"outlined"},style:{right:7}}]})),tpe=Pr(RG,{name:"MuiNativeSelect",slot:"Icon",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.icon,r.variant&&e[`icon${on(r.variant)}`],r.open&&e.iconOpen]}})({}),rpe=ee.forwardRef(function(e,r){const{className:n,disabled:i,error:a,IconComponent:s,inputRef:o,variant:u="standard",...h}=e,f={...e,disabled:i,variant:u,error:a},g=Qde(f);return K.jsxs(ee.Fragment,{children:[K.jsx(epe,{ownerState:f,className:Sn(g.select,n),disabled:i,ref:o||r,...h}),e.multiple?null:K.jsx(tpe,{as:s,ownerState:f,className:g.icon})]})});function npe(t){const{children:e,defer:r=!1,fallback:n=null}=t,[i,a]=ee.useState(!1);return yu(()=>{r||a(!0)},[r]),ee.useEffect(()=>{r&&a(!0)},[r]),i?e:n}var h8;const ipe=Pr("fieldset",{name:"MuiNotchedOutlined",shouldForwardProp:yl})({textAlign:"left",position:"absolute",bottom:0,right:0,top:-5,left:0,margin:0,padding:"0 8px",pointerEvents:"none",borderRadius:"inherit",borderStyle:"solid",borderWidth:1,overflow:"hidden",minWidth:"0%"}),ape=Pr("legend",{name:"MuiNotchedOutlined",shouldForwardProp:yl})(si(({theme:t})=>({float:"unset",width:"auto",overflow:"hidden",variants:[{props:({ownerState:e})=>!e.withLabel,style:{padding:0,lineHeight:"11px",transition:t.transitions.create("width",{duration:150,easing:t.transitions.easing.easeOut})}},{props:({ownerState:e})=>e.withLabel,style:{display:"block",padding:0,height:11,fontSize:"0.75em",visibility:"hidden",maxWidth:.01,transition:t.transitions.create("max-width",{duration:50,easing:t.transitions.easing.easeOut}),whiteSpace:"nowrap","& > span":{paddingLeft:5,paddingRight:5,display:"inline-block",opacity:0,visibility:"visible"}}},{props:({ownerState:e})=>e.withLabel&&e.notched,style:{maxWidth:"100%",transition:t.transitions.create("max-width",{duration:100,easing:t.transitions.easing.easeOut,delay:50})}}]})));function ope(t){const{children:e,classes:r,className:n,label:i,notched:a,...s}=t,o=i!=null&&i!=="",u={...t,notched:a,withLabel:o};return K.jsx(ipe,{"aria-hidden":!0,className:n,ownerState:u,...s,children:K.jsx(ape,{ownerState:u,children:o?K.jsx("span",{children:i}):h8||(h8=K.jsx("span",{className:"notranslate","aria-hidden":!0,children:""}))})})}const spe=t=>{const{classes:e}=t,n=di({root:["root"],notchedOutline:["notchedOutline"],input:["input"]},Qce,e);return{...e,...n}},lpe=Pr(eT,{shouldForwardProp:t=>yl(t)||t==="classes",name:"MuiOutlinedInput",slot:"Root",overridesResolver:JE})(si(({theme:t})=>{const e=t.palette.mode==="light"?"rgba(0, 0, 0, 0.23)":"rgba(255, 255, 255, 0.23)";return{position:"relative",borderRadius:(t.vars||t).shape.borderRadius,[`&:hover .${Lf.notchedOutline}`]:{borderColor:(t.vars||t).palette.text.primary},"@media (hover: none)":{[`&:hover .${Lf.notchedOutline}`]:{borderColor:t.vars?t.alpha(t.vars.palette.common.onBackground,.23):e}},[`&.${Lf.focused} .${Lf.notchedOutline}`]:{borderWidth:2},variants:[...Object.entries(t.palette).filter(Nl()).map(([r])=>({props:{color:r},style:{[`&.${Lf.focused} .${Lf.notchedOutline}`]:{borderColor:(t.vars||t).palette[r].main}}})),{props:{},style:{[`&.${Lf.error} .${Lf.notchedOutline}`]:{borderColor:(t.vars||t).palette.error.main},[`&.${Lf.disabled} .${Lf.notchedOutline}`]:{borderColor:(t.vars||t).palette.action.disabled}}},{props:({ownerState:r})=>r.startAdornment,style:{paddingLeft:14}},{props:({ownerState:r})=>r.endAdornment,style:{paddingRight:14}},{props:({ownerState:r})=>r.multiline,style:{padding:"16.5px 14px"}},{props:({ownerState:r,size:n})=>r.multiline&&n==="small",style:{padding:"8.5px 14px"}}]}})),upe=Pr(ope,{name:"MuiOutlinedInput",slot:"NotchedOutline"})(si(({theme:t})=>{const e=t.palette.mode==="light"?"rgba(0, 0, 0, 0.23)":"rgba(255, 255, 255, 0.23)";return{borderColor:t.vars?t.alpha(t.vars.palette.common.onBackground,.23):e}})),cpe=Pr(tT,{name:"MuiOutlinedInput",slot:"Input",overridesResolver:QE})(si(({theme:t})=>({padding:"16.5px 14px",...!t.vars&&{"&:-webkit-autofill":{WebkitBoxShadow:t.palette.mode==="light"?null:"0 0 0 100px #266798 inset",WebkitTextFillColor:t.palette.mode==="light"?null:"#fff",caretColor:t.palette.mode==="light"?null:"#fff",borderRadius:"inherit"}},...t.vars&&{"&:-webkit-autofill":{borderRadius:"inherit"},[t.getColorSchemeSelector("dark")]:{"&:-webkit-autofill":{WebkitBoxShadow:"0 0 0 100px #266798 inset",WebkitTextFillColor:"#fff",caretColor:"#fff"}}},variants:[{props:{size:"small"},style:{padding:"8.5px 14px"}},{props:({ownerState:e})=>e.multiline,style:{padding:0}},{props:({ownerState:e})=>e.startAdornment,style:{paddingLeft:0}},{props:({ownerState:e})=>e.endAdornment,style:{paddingRight:0}}]}))),rT=ee.forwardRef(function(e,r){const n=_i({props:e,name:"MuiOutlinedInput"}),{components:i={},fullWidth:a=!1,inputComponent:s="input",label:o,multiline:u=!1,notched:h,slots:f={},slotProps:g={},type:b="text",...v}=n,S=spe(n),E=sd(),P=ug({props:n,muiFormControl:E,states:["color","disabled","error","focused","hiddenLabel","size","required"]}),k={...n,color:P.color||"primary",disabled:P.disabled,error:P.error,focused:P.focused,formControl:E,fullWidth:a,hiddenLabel:P.hiddenLabel,multiline:u,size:P.size,type:b},L=f.root??i.Root??lpe,O=f.input??i.Input??cpe,[M,z]=Si("notchedOutline",{elementType:upe,className:S.notchedOutline,shouldForwardComponentProp:!0,ownerState:k,externalForwardedProps:{slots:f,slotProps:g},additionalProps:{label:o!=null&&o!==""&&P.required?K.jsxs(ee.Fragment,{children:[o,"","*"]}):o}});return K.jsx(ZR,{slots:{root:L,input:O},slotProps:g,renderSuffix:B=>K.jsx(M,{...z,notched:typeof h<"u"?h:!!(B.startAdornment||B.filled||B.focused)}),fullWidth:a,inputComponent:s,multiline:u,ref:r,type:b,...v,classes:{...S,notchedOutline:null}})});rT.muiName="Input";const hpe=Hi(K.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8z"})),fpe=Hi(K.jsx("path",{d:"M8.465 8.465C9.37 7.56 10.62 7 12 7C14.76 7 17 9.24 17 12C17 13.38 16.44 14.63 15.535 15.535C14.63 16.44 13.38 17 12 17C9.24 17 7 14.76 7 12C7 10.62 7.56 9.37 8.465 8.465Z"})),dpe=Pr("span",{name:"MuiRadioButtonIcon",shouldForwardProp:yl})({position:"relative",display:"flex"}),ppe=Pr(hpe,{name:"MuiRadioButtonIcon"})({transform:"scale(1)"}),gpe=Pr(fpe,{name:"MuiRadioButtonIcon"})(si(({theme:t})=>({left:0,position:"absolute",transform:"scale(0)",transition:t.transitions.create("transform",{easing:t.transitions.easing.easeIn,duration:t.transitions.duration.shortest}),variants:[{props:{checked:!0},style:{transform:"scale(1)",transition:t.transitions.create("transform",{easing:t.transitions.easing.easeOut,duration:t.transitions.duration.shortest})}}]})));function OG(t){const{checked:e=!1,classes:r={},fontSize:n}=t,i={...t,checked:e};return K.jsxs(dpe,{className:r.root,ownerState:i,children:[K.jsx(ppe,{fontSize:n,className:r.background,ownerState:i}),K.jsx(gpe,{fontSize:n,className:r.dot,ownerState:i})]})}const LG=ee.createContext(void 0);function mpe(){return ee.useContext(LG)}function ype(t){return fi("MuiRadio",t)}const f8=ui("MuiRadio",["root","checked","disabled","colorPrimary","colorSecondary","sizeSmall"]),vpe=t=>{const{classes:e,color:r,size:n}=t,i={root:["root",`color${on(r)}`,n!=="medium"&&`size${on(n)}`]};return{...e,...di(i,ype,e)}},_pe=Pr(vG,{shouldForwardProp:t=>yl(t)||t==="classes",name:"MuiRadio",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.root,r.size!=="medium"&&e[`size${on(r.size)}`],e[`color${on(r.color)}`]]}})(si(({theme:t})=>({color:(t.vars||t).palette.text.secondary,[`&.${f8.disabled}`]:{color:(t.vars||t).palette.action.disabled},variants:[{props:{color:"default",disabled:!1,disableRipple:!1},style:{"&:hover":{backgroundColor:t.alpha((t.vars||t).palette.action.active,(t.vars||t).palette.action.hoverOpacity)}}},...Object.entries(t.palette).filter(Nl()).map(([e])=>({props:{color:e,disabled:!1,disableRipple:!1},style:{"&:hover":{backgroundColor:t.alpha((t.vars||t).palette[e].main,(t.vars||t).palette.action.hoverOpacity)}}})),...Object.entries(t.palette).filter(Nl()).map(([e])=>({props:{color:e,disabled:!1},style:{[`&.${f8.checked}`]:{color:(t.vars||t).palette[e].main}}})),{props:{disableRipple:!1},style:{"&:hover":{"@media (hover: none)":{backgroundColor:"transparent"}}}}]})));function bpe(t,e){return typeof e=="object"&&e!==null?t===e:String(t)===String(e)}const xpe=K.jsx(OG,{checked:!0}),wpe=K.jsx(OG,{}),d8=ee.forwardRef(function(e,r){const n=_i({props:e,name:"MuiRadio"}),{checked:i,checkedIcon:a=xpe,color:s="primary",icon:o=wpe,name:u,onChange:h,size:f="medium",className:g,disabled:b,disableRipple:v=!1,slots:S={},slotProps:E={},inputProps:P,...k}=n,L=sd();let O=b;L&&typeof O>"u"&&(O=L.disabled),O??=!1;const M={...n,disabled:O,disableRipple:v,color:s,size:f},z=vpe(M),B=mpe();let q=i;const W=bP(h,B&&B.onChange);let G=u;B&&(typeof q>"u"&&(q=bpe(B.value,n.value)),typeof G>"u"&&(G=B.name));const ie=E.input??P,[Q,H]=Si("root",{ref:r,elementType:_pe,className:Sn(z.root,g),shouldForwardComponentProp:!0,externalForwardedProps:{slots:S,slotProps:E,...k},getSlotProps:ne=>({...ne,onChange:(oe,...ce)=>{ne.onChange?.(oe,...ce),W(oe,...ce)}}),ownerState:M,additionalProps:{type:"radio",icon:ee.cloneElement(o,{fontSize:o.props.fontSize??f}),checkedIcon:ee.cloneElement(a,{fontSize:a.props.fontSize??f}),disabled:O,name:G,checked:q,slots:S,slotProps:{input:typeof ie=="function"?ie(M):ie}}});return K.jsx(Q,{...H,classes:z})});function Spe(t){return fi("MuiRadioGroup",t)}ui("MuiRadioGroup",["root","row","error"]);const Epe=t=>{const{classes:e,row:r,error:n}=t;return di({root:["root",r&&"row",n&&"error"]},Spe,e)},Tpe=ee.forwardRef(function(e,r){const{actions:n,children:i,className:a,defaultValue:s,name:o,onChange:u,value:h,...f}=e,g=ee.useRef(null),b=Epe(e),[v,S]=pm({controlled:h,default:s,name:"RadioGroup"});ee.useImperativeHandle(n,()=>({focus:()=>{let L=g.current.querySelector("input:not(:disabled):checked");L||(L=g.current.querySelector("input:not(:disabled)")),L&&L.focus()}}),[]);const E=Lo(r,g),P=ag(o),k=ee.useMemo(()=>({name:P,onChange(L){S(L.target.value),u&&u(L,L.target.value)},value:v}),[P,u,S,v]);return K.jsx(LG.Provider,{value:k,children:K.jsx(SG,{role:"radiogroup",ref:E,className:Sn(b.root,a),...f,children:i})})}),Cpe={border:0,clip:"rect(0 0 0 0)",height:"1px",margin:"-1px",overflow:"hidden",padding:0,position:"absolute",whiteSpace:"nowrap",width:"1px"};function NG(t){return fi("MuiSelect",t)}const __=ui("MuiSelect",["root","select","multiple","filled","outlined","standard","disabled","focused","icon","iconOpen","iconFilled","iconOutlined","iconStandard","nativeInput","error"]);var p8;const Ape=Pr(MG,{name:"MuiSelect",slot:"Select",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[{[`&.${__.select}`]:e.select},{[`&.${__.select}`]:e[r.variant]},{[`&.${__.error}`]:e.error},{[`&.${__.multiple}`]:e.multiple}]}})({[`&.${__.select}`]:{height:"auto",minHeight:"1.4375em",textOverflow:"ellipsis",whiteSpace:"nowrap",overflow:"hidden"}}),Ipe=Pr(RG,{name:"MuiSelect",slot:"Icon",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.icon,r.variant&&e[`icon${on(r.variant)}`],r.open&&e.iconOpen]}})({}),Ppe=Pr("input",{shouldForwardProp:t=>GE(t)&&t!=="classes",name:"MuiSelect",slot:"NativeInput"})({bottom:0,left:0,position:"absolute",opacity:0,pointerEvents:"none",width:"100%",boxSizing:"border-box"});function g8(t,e){return typeof e=="object"&&e!==null?t===e:String(t)===String(e)}function kpe(t){return t==null||typeof t=="string"&&!t.trim()}const Mpe=t=>{const{classes:e,variant:r,disabled:n,multiple:i,open:a,error:s}=t,o={select:["select",r,n&&"disabled",i&&"multiple",s&&"error"],icon:["icon",`icon${on(r)}`,a&&"iconOpen",n&&"disabled"],nativeInput:["nativeInput"]};return di(o,NG,e)},Rpe=ee.forwardRef(function(e,r){const{"aria-describedby":n,"aria-label":i,autoFocus:a,autoWidth:s,children:o,className:u,defaultOpen:h,defaultValue:f,disabled:g,displayEmpty:b,error:v=!1,IconComponent:S,inputRef:E,labelId:P,MenuProps:k={},multiple:L,name:O,onBlur:M,onChange:z,onClose:B,onFocus:q,onOpen:W,open:G,readOnly:ie,renderValue:Q,required:H,SelectDisplayProps:ne={},tabIndex:oe,type:ce,value:fe,variant:Me="standard",...me}=e,[we,Te]=pm({controlled:fe,default:f,name:"Select"}),[ke,he]=pm({controlled:G,default:h,name:"Select"}),Ee=ee.useRef(null),xe=ee.useRef(null),[Ne,Oe]=ee.useState(null),{current:$e}=ee.useRef(G!=null),[De,it]=ee.useState(),Ye=Lo(r,E),rt=ee.useCallback(et=>{xe.current=et,et&&Oe(et)},[]),Ie=Ne?.parentNode;ee.useImperativeHandle(Ye,()=>({focus:()=>{xe.current.focus()},node:Ee.current,value:we}),[we]),ee.useEffect(()=>{h&&ke&&Ne&&!$e&&(it(s?null:Ie.clientWidth),xe.current.focus())},[Ne,s]),ee.useEffect(()=>{a&&xe.current.focus()},[a]),ee.useEffect(()=>{if(!P)return;const et=os(xe.current).getElementById(P);if(et){const Lt=()=>{getSelection().isCollapsed&&xe.current.focus()};return et.addEventListener("click",Lt),()=>{et.removeEventListener("click",Lt)}}},[P]);const Mt=(et,Lt)=>{et?W&&W(Lt):B&&B(Lt),$e||(it(s?null:Ie.clientWidth),he(et))},at=et=>{et.button===0&&(et.preventDefault(),xe.current.focus(),Mt(!0,et))},je=et=>{Mt(!1,et)},Xt=ee.Children.toArray(o),Yt=et=>{const Lt=Xt.find(_t=>_t.props.value===et.target.value);Lt!==void 0&&(Te(Lt.props.value),z&&z(et,Lt))},pr=et=>Lt=>{let _t;if(Lt.currentTarget.hasAttribute("tabindex")){if(L){_t=Array.isArray(we)?we.slice():[];const jt=we.indexOf(et.props.value);jt===-1?_t.push(et.props.value):_t.splice(jt,1)}else _t=et.props.value;if(et.props.onClick&&et.props.onClick(Lt),we!==_t&&(Te(_t),z)){const jt=Lt.nativeEvent||Lt,Jt=new jt.constructor(jt.type,jt);Object.defineProperty(Jt,"target",{writable:!0,value:{value:_t,name:O}}),z(Jt,et)}L||Mt(!1,Lt)}},vt=et=>{ie||[" ","ArrowUp","ArrowDown","Enter"].includes(et.key)&&(et.preventDefault(),Mt(!0,et))},yr=Ne!==null&&ke,_r=et=>{!yr&&M&&(Object.defineProperty(et,"target",{writable:!0,value:{value:we,name:O}}),M(et))};delete me["aria-invalid"];let cr,Er;const wr=[];let er=!1;(Yw({value:we})||b)&&(Q?cr=Q(we):er=!0);const lr=Xt.map(et=>{if(!ee.isValidElement(et))return null;let Lt;if(L){if(!Array.isArray(we))throw new Error($d(2));Lt=we.some(_t=>g8(_t,et.props.value)),Lt&&er&&wr.push(et.props.children)}else Lt=g8(we,et.props.value),Lt&&er&&(Er=et.props.children);return ee.cloneElement(et,{"aria-selected":Lt?"true":"false",onClick:pr(et),onKeyUp:_t=>{_t.key===" "&&_t.preventDefault(),et.props.onKeyUp&&et.props.onKeyUp(_t)},role:"option",selected:Lt,value:void 0,"data-value":et.props.value})});er&&(L?wr.length===0?cr=null:cr=wr.reduce((et,Lt,_t)=>(et.push(Lt),_t<wr.length-1&&et.push(", "),et),[]):cr=Er);let Ar=De;!s&&$e&&Ne&&(Ar=Ie.clientWidth);let ir;typeof oe<"u"?ir=oe:ir=g?null:0;const nt=ne.id||(O?`mui-component-select-${O}`:void 0),_e={...e,variant:Me,value:we,open:yr,error:v},be=Mpe(_e),qe={...k.PaperProps,...typeof k.slotProps?.paper=="function"?k.slotProps.paper(_e):k.slotProps?.paper},Qe={...k.MenuListProps,...typeof k.slotProps?.list=="function"?k.slotProps.list(_e):k.slotProps?.list},ot=ag();return K.jsxs(ee.Fragment,{children:[K.jsx(Ape,{as:"div",ref:rt,tabIndex:ir,role:"combobox","aria-controls":yr?ot:void 0,"aria-disabled":g?"true":void 0,"aria-expanded":yr?"true":"false","aria-haspopup":"listbox","aria-label":i,"aria-labelledby":[P,nt].filter(Boolean).join(" ")||void 0,"aria-describedby":n,"aria-required":H?"true":void 0,"aria-invalid":v?"true":void 0,onKeyDown:vt,onMouseDown:g||ie?null:at,onBlur:_r,onFocus:q,...ne,ownerState:_e,className:Sn(ne.className,be.select,u),id:nt,children:kpe(cr)?p8||(p8=K.jsx("span",{className:"notranslate","aria-hidden":!0,children:""})):cr}),K.jsx(Ppe,{"aria-invalid":v,value:Array.isArray(we)?we.join(","):we,name:O,ref:Ee,"aria-hidden":!0,onChange:Yt,tabIndex:-1,disabled:g,className:be.nativeInput,autoFocus:a,required:H,...me,ownerState:_e}),K.jsx(Ipe,{as:S,className:be.icon,ownerState:_e}),K.jsx(kG,{id:`menu-${O||""}`,anchorEl:Ie,open:yr,onClose:je,anchorOrigin:{vertical:"bottom",horizontal:"center"},transformOrigin:{vertical:"top",horizontal:"center"},...k,slotProps:{...k.slotProps,list:{"aria-labelledby":P,role:"listbox","aria-multiselectable":L?"true":void 0,disableListWrap:!0,id:ot,...Qe},paper:{...qe,style:{minWidth:Ar,...qe!=null?qe.style:null}}},children:lr})]})}),Ope=t=>{const{classes:e}=t,n=di({root:["root"]},NG,e);return{...e,...n}},iO={name:"MuiSelect",slot:"Root",shouldForwardProp:t=>yl(t)&&t!=="variant"},Lpe=Pr(rO,iO)(""),Npe=Pr(rT,iO)(""),Dpe=Pr(tO,iO)(""),qp=ee.forwardRef(function(e,r){const n=_i({name:"MuiSelect",props:e}),{autoWidth:i=!1,children:a,classes:s={},className:o,defaultOpen:u=!1,displayEmpty:h=!1,IconComponent:f=the,id:g,input:b,inputProps:v,label:S,labelId:E,MenuProps:P,multiple:k=!1,native:L=!1,onClose:O,onOpen:M,open:z,renderValue:B,SelectDisplayProps:q,variant:W="outlined",...G}=n,ie=L?rpe:Rpe,Q=sd(),H=ug({props:n,muiFormControl:Q,states:["variant","error"]}),ne=H.variant||W,oe={...n,variant:ne,classes:s},ce=Ope(oe),{root:fe,...Me}=ce,me=b||{standard:K.jsx(Lpe,{ownerState:oe}),outlined:K.jsx(Npe,{label:S,ownerState:oe}),filled:K.jsx(Dpe,{ownerState:oe})}[ne],we=Lo(r,lg(me));return K.jsx(ee.Fragment,{children:ee.cloneElement(me,{inputComponent:ie,inputProps:{children:a,error:H.error,IconComponent:f,variant:ne,type:void 0,multiple:k,...L?{id:g}:{autoWidth:i,defaultOpen:u,displayEmpty:h,labelId:E,MenuProps:P,onClose:O,onOpen:M,open:z,renderValue:B,SelectDisplayProps:{id:g,...q}},...v,classes:v?Vu(Me,v.classes):Me,...b?b.props.inputProps:{}},...(k&&L||h)&&ne==="outlined"?{notched:!0}:{},ref:we,className:Sn(me.props.className,o,ce.root),...!b&&{variant:ne},...G})})});qp.muiName="Select";function Fpe(t,e,r=(n,i)=>n===i){return t.length===e.length&&t.every((n,i)=>r(n,e[i]))}const Bpe=2;function ky(t,e,r,n,i){return r===1?Math.min(t+e,i):Math.max(t-e,n)}function DG(t,e){return t-e}function m8(t,e){const{index:r}=t.reduce((n,i,a)=>{const s=Math.abs(e-i);return n===null||s<n.distance||s===n.distance?{distance:s,index:a}:n},null)??{};return r}function Gx(t,e){if(e.current!==void 0&&t.changedTouches){const r=t;for(let n=0;n<r.changedTouches.length;n+=1){const i=r.changedTouches[n];if(i.identifier===e.current)return{x:i.clientX,y:i.clientY}}return!1}return{x:t.clientX,y:t.clientY}}function Zw(t,e,r){return(t-e)*100/(r-e)}function zpe(t,e,r){return(r-e)*t+e}function jpe(t){if(Math.abs(t)<1){const r=t.toExponential().split("e-"),n=r[0].split(".")[1];return(n?n.length:0)+parseInt(r[1],10)}const e=t.toString().split(".")[1];return e?e.length:0}function Upe(t,e,r){const n=Math.round((t-r)/e)*e+r;return Number(n.toFixed(jpe(e)))}function y8({values:t,newValue:e,index:r}){const n=t.slice();return n[r]=e,n.sort(DG)}function Xx({sliderRef:t,activeIndex:e,setActive:r}){const n=os(t.current);(!t.current?.contains(n.activeElement)||Number(n?.activeElement?.getAttribute("data-index"))!==e)&&t.current?.querySelector(`[type="range"][data-index="${e}"]`).focus(),r&&r(e)}function Yx(t,e){return typeof t=="number"&&typeof e=="number"?t===e:typeof t=="object"&&typeof e=="object"?Fpe(t,e):!1}const Vpe={horizontal:{offset:t=>({left:`${t}%`}),leap:t=>({width:`${t}%`})},"horizontal-reverse":{offset:t=>({right:`${t}%`}),leap:t=>({width:`${t}%`})},vertical:{offset:t=>({bottom:`${t}%`}),leap:t=>({height:`${t}%`})}},$pe=t=>t;let Zx;function v8(){return Zx===void 0&&(typeof CSS<"u"&&typeof CSS.supports=="function"?Zx=CSS.supports("touch-action","none"):Zx=!0),Zx}function qpe(t){const{"aria-labelledby":e,defaultValue:r,disabled:n=!1,disableSwap:i=!1,isRtl:a=!1,marks:s=!1,max:o=100,min:u=0,name:h,onChange:f,onChangeCommitted:g,orientation:b="horizontal",rootRef:v,scale:S=$pe,step:E=1,shiftStep:P=10,tabIndex:k,value:L}=t,O=ee.useRef(void 0),[M,z]=ee.useState(-1),[B,q]=ee.useState(-1),[W,G]=ee.useState(!1),ie=ee.useRef(0),Q=ee.useRef(null),[H,ne]=pm({controlled:L,default:r??u,name:"Slider"}),oe=f&&((er,lr,Ar)=>{const ir=er.nativeEvent||er,nt=new ir.constructor(ir.type,ir);Object.defineProperty(nt,"target",{writable:!0,value:{value:lr,name:h}}),Q.current=lr,f(nt,lr,Ar)}),ce=Array.isArray(H);let fe=ce?H.slice().sort(DG):[H];fe=fe.map(er=>er==null?u:Zy(er,u,o));const Me=s===!0&&E!==null?[...Array(Math.floor((o-u)/E)+1)].map((er,lr)=>({value:u+E*lr})):s||[],me=Me.map(er=>er.value),[we,Te]=ee.useState(-1),ke=ee.useRef(null),he=Lo(v,ke),Ee=er=>lr=>{const Ar=Number(lr.currentTarget.getAttribute("data-index"));Jv(lr.target)&&Te(Ar),q(Ar),er?.onFocus?.(lr)},xe=er=>lr=>{Jv(lr.target)||Te(-1),q(-1),er?.onBlur?.(lr)},Ne=(er,lr)=>{const Ar=Number(er.currentTarget.getAttribute("data-index")),ir=fe[Ar],nt=me.indexOf(ir);let _e=lr;if(Me&&E==null){const be=me[me.length-1];_e>=be?_e=be:_e<=me[0]?_e=me[0]:_e=_e<ir?me[nt-1]:me[nt+1]}if(_e=Zy(_e,u,o),ce){i&&(_e=Zy(_e,fe[Ar-1]||-1/0,fe[Ar+1]||1/0));const be=_e;_e=y8({values:fe,newValue:_e,index:Ar});let qe=Ar;i||(qe=_e.indexOf(be)),Xx({sliderRef:ke,activeIndex:qe})}ne(_e),Te(Ar),oe&&!Yx(_e,H)&&oe(er,_e,Ar),g&&g(er,Q.current??_e)},Oe=er=>lr=>{if(["ArrowUp","ArrowDown","ArrowLeft","ArrowRight","PageUp","PageDown","Home","End"].includes(lr.key)){lr.preventDefault();const Ar=Number(lr.currentTarget.getAttribute("data-index")),ir=fe[Ar];let nt=null;if(E!=null){const _e=lr.shiftKey?P:E;switch(lr.key){case"ArrowUp":nt=ky(ir,_e,1,u,o);break;case"ArrowRight":nt=ky(ir,_e,a?-1:1,u,o);break;case"ArrowDown":nt=ky(ir,_e,-1,u,o);break;case"ArrowLeft":nt=ky(ir,_e,a?1:-1,u,o);break;case"PageUp":nt=ky(ir,P,1,u,o);break;case"PageDown":nt=ky(ir,P,-1,u,o);break;case"Home":nt=u;break;case"End":nt=o;break}}else if(Me){const _e=me[me.length-1],be=me.indexOf(ir),qe=[a?"ArrowRight":"ArrowLeft","ArrowDown","PageDown","Home"],Qe=[a?"ArrowLeft":"ArrowRight","ArrowUp","PageUp","End"];qe.includes(lr.key)?be===0?nt=me[0]:nt=me[be-1]:Qe.includes(lr.key)&&(be===me.length-1?nt=_e:nt=me[be+1])}nt!=null&&Ne(lr,nt)}er?.onKeyDown?.(lr)};yu(()=>{n&&ke.current.contains(document.activeElement)&&document.activeElement?.blur()},[n]),n&&M!==-1&&z(-1),n&&we!==-1&&Te(-1);const $e=er=>lr=>{er.onChange?.(lr),Ne(lr,lr.target.valueAsNumber)},De=ee.useRef(void 0);let it=b;a&&b==="horizontal"&&(it+="-reverse");const Ye=({finger:er,move:lr=!1})=>{const{current:Ar}=ke,{width:ir,height:nt,bottom:_e,left:be}=Ar.getBoundingClientRect();let qe;it.startsWith("vertical")?qe=(_e-er.y)/nt:qe=(er.x-be)/ir,it.includes("-reverse")&&(qe=1-qe);let Qe;if(Qe=zpe(qe,u,o),E)Qe=Upe(Qe,E,u);else{const et=m8(me,Qe);Qe=me[et]}Qe=Zy(Qe,u,o);let ot=0;if(ce){lr?ot=De.current:ot=m8(fe,Qe),i&&(Qe=Zy(Qe,fe[ot-1]||-1/0,fe[ot+1]||1/0));const et=Qe;Qe=y8({values:fe,newValue:Qe,index:ot}),i&&lr||(ot=Qe.indexOf(et),De.current=ot)}return{newValue:Qe,activeIndex:ot}},rt=Ql(er=>{const lr=Gx(er,O);if(!lr)return;if(ie.current+=1,er.type==="mousemove"&&er.buttons===0){Ie(er);return}const{newValue:Ar,activeIndex:ir}=Ye({finger:lr,move:!0});Xx({sliderRef:ke,activeIndex:ir,setActive:z}),ne(Ar),!W&&ie.current>Bpe&&G(!0),oe&&!Yx(Ar,H)&&oe(er,Ar,ir)}),Ie=Ql(er=>{const lr=Gx(er,O);if(G(!1),!lr)return;const{newValue:Ar}=Ye({finger:lr,move:!0});z(-1),er.type==="touchend"&&q(-1),g&&g(er,Q.current??Ar),O.current=void 0,at()}),Mt=Ql(er=>{if(n)return;v8()||er.preventDefault();const lr=er.changedTouches[0];lr!=null&&(O.current=lr.identifier);const Ar=Gx(er,O);if(Ar!==!1){const{newValue:nt,activeIndex:_e}=Ye({finger:Ar});Xx({sliderRef:ke,activeIndex:_e,setActive:z}),ne(nt),oe&&!Yx(nt,H)&&oe(er,nt,_e)}ie.current=0;const ir=os(ke.current);ir.addEventListener("touchmove",rt,{passive:!0}),ir.addEventListener("touchend",Ie,{passive:!0})}),at=ee.useCallback(()=>{const er=os(ke.current);er.removeEventListener("mousemove",rt),er.removeEventListener("mouseup",Ie),er.removeEventListener("touchmove",rt),er.removeEventListener("touchend",Ie)},[Ie,rt]);ee.useEffect(()=>{const{current:er}=ke;return er.addEventListener("touchstart",Mt,{passive:v8()}),()=>{er.removeEventListener("touchstart",Mt),at()}},[at,Mt]),ee.useEffect(()=>{n&&at()},[n,at]);const je=er=>lr=>{if(er.onMouseDown?.(lr),n||lr.defaultPrevented||lr.button!==0)return;lr.preventDefault();const Ar=Gx(lr,O);if(Ar!==!1){const{newValue:nt,activeIndex:_e}=Ye({finger:Ar});Xx({sliderRef:ke,activeIndex:_e,setActive:z}),ne(nt),oe&&!Yx(nt,H)&&oe(lr,nt,_e)}ie.current=0;const ir=os(ke.current);ir.addEventListener("mousemove",rt,{passive:!0}),ir.addEventListener("mouseup",Ie)},Xt=Zw(ce?fe[0]:u,u,o),Yt=Zw(fe[fe.length-1],u,o)-Xt,pr=(er={})=>{const lr=rm(er),Ar={onMouseDown:je(lr||{})},ir={...lr,...Ar};return{...er,ref:he,...ir}},vt=er=>lr=>{er.onMouseOver?.(lr);const Ar=Number(lr.currentTarget.getAttribute("data-index"));q(Ar)},yr=er=>lr=>{er.onMouseLeave?.(lr),q(-1)},_r=(er={})=>{const lr=rm(er),Ar={onMouseOver:vt(lr||{}),onMouseLeave:yr(lr||{})};return{...er,...lr,...Ar}},cr=er=>({pointerEvents:M!==-1&&M!==er?"none":void 0});let Er;return b==="vertical"&&(Er=a?"vertical-rl":"vertical-lr"),{active:M,axis:it,axisProps:Vpe,dragging:W,focusedThumbIndex:we,getHiddenInputProps:(er={})=>{const lr=rm(er),Ar={onChange:$e(lr||{}),onFocus:Ee(lr||{}),onBlur:xe(lr||{}),onKeyDown:Oe(lr||{})},ir={...lr,...Ar};return{tabIndex:k,"aria-labelledby":e,"aria-orientation":b,"aria-valuemax":S(o),"aria-valuemin":S(u),name:h,type:"range",min:t.min,max:t.max,step:t.step===null&&t.marks?"any":t.step??void 0,disabled:n,...er,...ir,style:{...Cpe,direction:a?"rtl":"ltr",width:"100%",height:"100%",writingMode:Er}}},getRootProps:pr,getThumbProps:_r,marks:Me,open:B,range:ce,rootRef:he,trackLeap:Yt,trackOffset:Xt,values:fe,getThumbStyle:cr}}const Hpe=t=>!t||!Zf(t);function Wpe(t){return fi("MuiSlider",t)}const vh=ui("MuiSlider",["root","active","colorPrimary","colorSecondary","colorError","colorInfo","colorSuccess","colorWarning","disabled","dragging","focusVisible","mark","markActive","marked","markLabel","markLabelActive","rail","sizeSmall","thumb","thumbColorPrimary","thumbColorSecondary","thumbColorError","thumbColorSuccess","thumbColorInfo","thumbColorWarning","track","trackInverted","trackFalse","thumbSizeSmall","valueLabel","valueLabelOpen","valueLabelCircle","valueLabelLabel","vertical"]),Gpe=t=>{const{open:e}=t;return{offset:Sn(e&&vh.valueLabelOpen),circle:vh.valueLabelCircle,label:vh.valueLabelLabel}};function Xpe(t){const{children:e,className:r,value:n}=t,i=Gpe(t);return e?ee.cloneElement(e,{className:e.props.className},K.jsxs(ee.Fragment,{children:[e.props.children,K.jsx("span",{className:Sn(i.offset,r),"aria-hidden":!0,children:K.jsx("span",{className:i.circle,children:K.jsx("span",{className:i.label,children:n})})})]})):null}function _8(t){return t}const Ype=Pr("span",{name:"MuiSlider",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.root,e[`color${on(r.color)}`],r.size!=="medium"&&e[`size${on(r.size)}`],r.marked&&e.marked,r.orientation==="vertical"&&e.vertical,r.track==="inverted"&&e.trackInverted,r.track===!1&&e.trackFalse]}})(si(({theme:t})=>({borderRadius:12,boxSizing:"content-box",display:"inline-block",position:"relative",cursor:"pointer",touchAction:"none",WebkitTapHighlightColor:"transparent","@media print":{colorAdjust:"exact"},[`&.${vh.disabled}`]:{pointerEvents:"none",cursor:"default",color:(t.vars||t).palette.grey[400]},[`&.${vh.dragging}`]:{[`& .${vh.thumb}, & .${vh.track}`]:{transition:"none"}},variants:[...Object.entries(t.palette).filter(Nl()).map(([e])=>({props:{color:e},style:{color:(t.vars||t).palette[e].main}})),{props:{orientation:"horizontal"},style:{height:4,width:"100%",padding:"13px 0","@media (pointer: coarse)":{padding:"20px 0"}}},{props:{orientation:"horizontal",size:"small"},style:{height:2}},{props:{orientation:"horizontal",marked:!0},style:{marginBottom:20}},{props:{orientation:"vertical"},style:{height:"100%",width:4,padding:"0 13px","@media (pointer: coarse)":{padding:"0 20px"}}},{props:{orientation:"vertical",size:"small"},style:{width:2}},{props:{orientation:"vertical",marked:!0},style:{marginRight:44}}]}))),Zpe=Pr("span",{name:"MuiSlider",slot:"Rail"})({display:"block",position:"absolute",borderRadius:"inherit",backgroundColor:"currentColor",opacity:.38,variants:[{props:{orientation:"horizontal"},style:{width:"100%",height:"inherit",top:"50%",transform:"translateY(-50%)"}},{props:{orientation:"vertical"},style:{height:"100%",width:"inherit",left:"50%",transform:"translateX(-50%)"}},{props:{track:"inverted"},style:{opacity:1}}]}),Kpe=Pr("span",{name:"MuiSlider",slot:"Track"})(si(({theme:t})=>({display:"block",position:"absolute",borderRadius:"inherit",border:"1px solid currentColor",backgroundColor:"currentColor",transition:t.transitions.create(["left","width","bottom","height"],{duration:t.transitions.duration.shortest}),variants:[{props:{size:"small"},style:{border:"none"}},{props:{orientation:"horizontal"},style:{height:"inherit",top:"50%",transform:"translateY(-50%)"}},{props:{orientation:"vertical"},style:{width:"inherit",left:"50%",transform:"translateX(-50%)"}},{props:{track:!1},style:{display:"none"}},...Object.entries(t.palette).filter(Nl()).map(([e])=>({props:{color:e,track:"inverted"},style:{...t.vars?{backgroundColor:t.vars.palette.Slider[`${e}Track`],borderColor:t.vars.palette.Slider[`${e}Track`]}:{backgroundColor:t.lighten(t.palette[e].main,.62),borderColor:t.lighten(t.palette[e].main,.62),...t.applyStyles("dark",{backgroundColor:t.darken(t.palette[e].main,.5)}),...t.applyStyles("dark",{borderColor:t.darken(t.palette[e].main,.5)})}}}))]}))),Jpe=Pr("span",{name:"MuiSlider",slot:"Thumb",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.thumb,e[`thumbColor${on(r.color)}`],r.size!=="medium"&&e[`thumbSize${on(r.size)}`]]}})(si(({theme:t})=>({position:"absolute",width:20,height:20,boxSizing:"border-box",borderRadius:"50%",outline:0,backgroundColor:"currentColor",display:"flex",alignItems:"center",justifyContent:"center",transition:t.transitions.create(["box-shadow","left","bottom"],{duration:t.transitions.duration.shortest}),"&::before":{position:"absolute",content:'""',borderRadius:"inherit",width:"100%",height:"100%",boxShadow:(t.vars||t).shadows[2]},"&::after":{position:"absolute",content:'""',borderRadius:"50%",width:42,height:42,top:"50%",left:"50%",transform:"translate(-50%, -50%)"},[`&.${vh.disabled}`]:{"&:hover":{boxShadow:"none"}},variants:[{props:{size:"small"},style:{width:12,height:12,"&::before":{boxShadow:"none"}}},{props:{orientation:"horizontal"},style:{top:"50%",transform:"translate(-50%, -50%)"}},{props:{orientation:"vertical"},style:{left:"50%",transform:"translate(-50%, 50%)"}},...Object.entries(t.palette).filter(Nl()).map(([e])=>({props:{color:e},style:{[`&:hover, &.${vh.focusVisible}`]:{boxShadow:`0px 0px 0px 8px ${t.alpha((t.vars||t).palette[e].main,.16)}`,"@media (hover: none)":{boxShadow:"none"}},[`&.${vh.active}`]:{boxShadow:`0px 0px 0px 14px ${t.alpha((t.vars||t).palette[e].main,.16)}`}}}))]}))),Qpe=Pr(Xpe,{name:"MuiSlider",slot:"ValueLabel"})(si(({theme:t})=>({zIndex:1,whiteSpace:"nowrap",...t.typography.body2,fontWeight:500,transition:t.transitions.create(["transform"],{duration:t.transitions.duration.shortest}),position:"absolute",backgroundColor:(t.vars||t).palette.grey[600],borderRadius:2,color:(t.vars||t).palette.common.white,display:"flex",alignItems:"center",justifyContent:"center",padding:"0.25rem 0.75rem",variants:[{props:{orientation:"horizontal"},style:{transform:"translateY(-100%) scale(0)",top:"-10px",transformOrigin:"bottom center","&::before":{position:"absolute",content:'""',width:8,height:8,transform:"translate(-50%, 50%) rotate(45deg)",backgroundColor:"inherit",bottom:0,left:"50%"},[`&.${vh.valueLabelOpen}`]:{transform:"translateY(-100%) scale(1)"}}},{props:{orientation:"vertical"},style:{transform:"translateY(-50%) scale(0)",right:"30px",top:"50%",transformOrigin:"right center","&::before":{position:"absolute",content:'""',width:8,height:8,transform:"translate(-50%, -50%) rotate(45deg)",backgroundColor:"inherit",right:-8,top:"50%"},[`&.${vh.valueLabelOpen}`]:{transform:"translateY(-50%) scale(1)"}}},{props:{size:"small"},style:{fontSize:t.typography.pxToRem(12),padding:"0.25rem 0.5rem"}},{props:{orientation:"vertical",size:"small"},style:{right:"20px"}}]}))),ege=Pr("span",{name:"MuiSlider",slot:"Mark",shouldForwardProp:t=>GE(t)&&t!=="markActive",overridesResolver:(t,e)=>{const{markActive:r}=t;return[e.mark,r&&e.markActive]}})(si(({theme:t})=>({position:"absolute",width:2,height:2,borderRadius:1,backgroundColor:"currentColor",variants:[{props:{orientation:"horizontal"},style:{top:"50%",transform:"translate(-1px, -50%)"}},{props:{orientation:"vertical"},style:{left:"50%",transform:"translate(-50%, 1px)"}},{props:{markActive:!0},style:{backgroundColor:(t.vars||t).palette.background.paper,opacity:.8}}]}))),tge=Pr("span",{name:"MuiSlider",slot:"MarkLabel",shouldForwardProp:t=>GE(t)&&t!=="markLabelActive"})(si(({theme:t})=>({...t.typography.body2,color:(t.vars||t).palette.text.secondary,position:"absolute",whiteSpace:"nowrap",variants:[{props:{orientation:"horizontal"},style:{top:30,transform:"translateX(-50%)","@media (pointer: coarse)":{top:40}}},{props:{orientation:"vertical"},style:{left:36,transform:"translateY(50%)","@media (pointer: coarse)":{left:44}}},{props:{markLabelActive:!0},style:{color:(t.vars||t).palette.text.primary}}]}))),rge=t=>{const{disabled:e,dragging:r,marked:n,orientation:i,track:a,classes:s,color:o,size:u}=t,h={root:["root",e&&"disabled",r&&"dragging",n&&"marked",i==="vertical"&&"vertical",a==="inverted"&&"trackInverted",a===!1&&"trackFalse",o&&`color${on(o)}`,u&&`size${on(u)}`],rail:["rail"],track:["track"],mark:["mark"],markActive:["markActive"],markLabel:["markLabel"],markLabelActive:["markLabelActive"],valueLabel:["valueLabel"],thumb:["thumb",e&&"disabled",u&&`thumbSize${on(u)}`,o&&`thumbColor${on(o)}`],active:["active"],disabled:["disabled"],focusVisible:["focusVisible"]};return di(h,Wpe,s)},nge=({children:t})=>t,aO=ee.forwardRef(function(e,r){const n=_i({props:e,name:"MuiSlider"}),i=$b(),{"aria-label":a,"aria-valuetext":s,"aria-labelledby":o,component:u="span",components:h={},componentsProps:f={},color:g="primary",classes:b,className:v,disableSwap:S=!1,disabled:E=!1,getAriaLabel:P,getAriaValueText:k,marks:L=!1,max:O=100,min:M=0,name:z,onChange:B,onChangeCommitted:q,orientation:W="horizontal",shiftStep:G=10,size:ie="medium",step:Q=1,scale:H=_8,slotProps:ne,slots:oe,tabIndex:ce,track:fe="normal",value:Me,valueLabelDisplay:me="off",valueLabelFormat:we=_8,...Te}=n,ke={...n,isRtl:i,max:O,min:M,classes:b,disabled:E,disableSwap:S,orientation:W,marks:L,color:g,size:ie,step:Q,shiftStep:G,scale:H,track:fe,valueLabelDisplay:me,valueLabelFormat:we},{axisProps:he,getRootProps:Ee,getHiddenInputProps:xe,getThumbProps:Ne,open:Oe,active:$e,axis:De,focusedThumbIndex:it,range:Ye,dragging:rt,marks:Ie,values:Mt,trackOffset:at,trackLeap:je,getThumbStyle:Xt}=qpe({...ke,rootRef:r});ke.marked=Ie.length>0&&Ie.some(bt=>bt.label),ke.dragging=rt,ke.focusedThumbIndex=it;const Yt=rge(ke),pr=oe?.root??h.Root??Ype,vt=oe?.rail??h.Rail??Zpe,yr=oe?.track??h.Track??Kpe,_r=oe?.thumb??h.Thumb??Jpe,cr=oe?.valueLabel??h.ValueLabel??Qpe,Er=oe?.mark??h.Mark??ege,wr=oe?.markLabel??h.MarkLabel??tge,er=oe?.input??h.Input??"input",lr=ne?.root??f.root,Ar=ne?.rail??f.rail,ir=ne?.track??f.track,nt=ne?.thumb??f.thumb,_e=ne?.valueLabel??f.valueLabel,be=ne?.mark??f.mark,qe=ne?.markLabel??f.markLabel,Qe=ne?.input??f.input,ot=zf({elementType:pr,getSlotProps:Ee,externalSlotProps:lr,externalForwardedProps:Te,additionalProps:{...Hpe(pr)&&{as:u}},ownerState:{...ke,...lr?.ownerState},className:[Yt.root,v]}),et=zf({elementType:vt,externalSlotProps:Ar,ownerState:ke,className:Yt.rail}),Lt=zf({elementType:yr,externalSlotProps:ir,additionalProps:{style:{...he[De].offset(at),...he[De].leap(je)}},ownerState:{...ke,...ir?.ownerState},className:Yt.track}),_t=zf({elementType:_r,getSlotProps:Ne,externalSlotProps:nt,ownerState:{...ke,...nt?.ownerState},className:Yt.thumb}),jt=zf({elementType:cr,externalSlotProps:_e,ownerState:{...ke,..._e?.ownerState},className:Yt.valueLabel}),Jt=zf({elementType:Er,externalSlotProps:be,ownerState:ke,className:Yt.mark}),Kt=zf({elementType:wr,externalSlotProps:qe,ownerState:ke,className:Yt.markLabel}),Rr=zf({elementType:er,getSlotProps:xe,externalSlotProps:Qe,ownerState:ke});return K.jsxs(pr,{...ot,children:[K.jsx(vt,{...et}),K.jsx(yr,{...Lt}),Ie.filter(bt=>bt.value>=M&&bt.value<=O).map((bt,Tr)=>{const Ur=Zw(bt.value,M,O),Gr=he[De].offset(Ur);let Jr;return fe===!1?Jr=Mt.includes(bt.value):Jr=fe==="normal"&&(Ye?bt.value>=Mt[0]&&bt.value<=Mt[Mt.length-1]:bt.value<=Mt[0])||fe==="inverted"&&(Ye?bt.value<=Mt[0]||bt.value>=Mt[Mt.length-1]:bt.value>=Mt[0]),K.jsxs(ee.Fragment,{children:[K.jsx(Er,{"data-index":Tr,...Jt,...!Zf(Er)&&{markActive:Jr},style:{...Gr,...Jt.style},className:Sn(Jt.className,Jr&&Yt.markActive)}),bt.label!=null?K.jsx(wr,{"aria-hidden":!0,"data-index":Tr,...Kt,...!Zf(wr)&&{markLabelActive:Jr},style:{...Gr,...Kt.style},className:Sn(Yt.markLabel,Kt.className,Jr&&Yt.markLabelActive),children:bt.label}):null]},Tr)}),Mt.map((bt,Tr)=>{const Ur=Zw(bt,M,O),Gr=he[De].offset(Ur),Jr=me==="off"?nge:cr;return K.jsx(Jr,{...!Zf(Jr)&&{valueLabelFormat:we,valueLabelDisplay:me,value:typeof we=="function"?we(H(bt),Tr):we,index:Tr,open:Oe===Tr||$e===Tr||me==="on",disabled:E},...jt,children:K.jsx(_r,{"data-index":Tr,..._t,className:Sn(Yt.thumb,_t.className,$e===Tr&&Yt.active,it===Tr&&Yt.focusVisible),style:{...Gr,...Xt(Tr),..._t.style},children:K.jsx(er,{"data-index":Tr,"aria-label":P?P(Tr):a,"aria-valuenow":H(bt),"aria-labelledby":o,"aria-valuetext":k?k(H(bt),Tr):s,value:Mt[Tr],...Rr})})},Tr)})]})});function ige(t={}){const{autoHideDuration:e=null,disableWindowBlurListener:r=!1,onClose:n,open:i,resumeHideDuration:a}=t,s=Lp();ee.useEffect(()=>{if(!i)return;function k(L){L.defaultPrevented||L.key==="Escape"&&n?.(L,"escapeKeyDown")}return document.addEventListener("keydown",k),()=>{document.removeEventListener("keydown",k)}},[i,n]);const o=Ql((k,L)=>{n?.(k,L)}),u=Ql(k=>{!n||k==null||s.start(k,()=>{o(null,"timeout")})});ee.useEffect(()=>(i&&u(e),s.clear),[i,e,u,s]);const h=k=>{n?.(k,"clickaway")},f=s.clear,g=ee.useCallback(()=>{e!=null&&u(a??e*.5)},[e,a,u]),b=k=>L=>{const O=k.onBlur;O?.(L),g()},v=k=>L=>{const O=k.onFocus;O?.(L),f()},S=k=>L=>{const O=k.onMouseEnter;O?.(L),f()},E=k=>L=>{const O=k.onMouseLeave;O?.(L),g()};return ee.useEffect(()=>{if(!r&&i)return window.addEventListener("focus",g),window.addEventListener("blur",f),()=>{window.removeEventListener("focus",g),window.removeEventListener("blur",f)}},[r,i,g,f]),{getRootProps:(k={})=>{const L={...rm(t),...rm(k)};return{role:"presentation",...k,...L,onBlur:b(L),onFocus:v(L),onMouseEnter:S(L),onMouseLeave:E(L)}},onClickAway:h}}function age(t){return fi("MuiSnackbarContent",t)}ui("MuiSnackbarContent",["root","message","action"]);const oge=t=>{const{classes:e}=t;return di({root:["root"],action:["action"],message:["message"]},age,e)},sge=Pr(Th,{name:"MuiSnackbarContent",slot:"Root"})(si(({theme:t})=>{const e=t.palette.mode==="light"?.8:.98;return{...t.typography.body2,color:t.vars?t.vars.palette.SnackbarContent.color:t.palette.getContrastText(pP(t.palette.background.default,e)),backgroundColor:t.vars?t.vars.palette.SnackbarContent.bg:pP(t.palette.background.default,e),display:"flex",alignItems:"center",flexWrap:"wrap",padding:"6px 16px",flexGrow:1,[t.breakpoints.up("sm")]:{flexGrow:"initial",minWidth:288}}})),lge=Pr("div",{name:"MuiSnackbarContent",slot:"Message"})({padding:"8px 0"}),uge=Pr("div",{name:"MuiSnackbarContent",slot:"Action"})({display:"flex",alignItems:"center",marginLeft:"auto",paddingLeft:16,marginRight:-8}),cge=ee.forwardRef(function(e,r){const n=_i({props:e,name:"MuiSnackbarContent"}),{action:i,className:a,message:s,role:o="alert",...u}=n,h=n,f=oge(h);return K.jsxs(sge,{role:o,elevation:6,className:Sn(f.root,a),ownerState:h,ref:r,...u,children:[K.jsx(lge,{className:f.message,ownerState:h,children:s}),i?K.jsx(uge,{className:f.action,ownerState:h,children:i}):null]})});function hge(t){return fi("MuiSnackbar",t)}ui("MuiSnackbar",["root","anchorOriginTopCenter","anchorOriginBottomCenter","anchorOriginTopRight","anchorOriginBottomRight","anchorOriginTopLeft","anchorOriginBottomLeft"]);const fge=t=>{const{classes:e,anchorOrigin:r}=t,n={root:["root",`anchorOrigin${on(r.vertical)}${on(r.horizontal)}`]};return di(n,hge,e)},dge=Pr("div",{name:"MuiSnackbar",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.root,e[`anchorOrigin${on(r.anchorOrigin.vertical)}${on(r.anchorOrigin.horizontal)}`]]}})(si(({theme:t})=>({zIndex:(t.vars||t).zIndex.snackbar,position:"fixed",display:"flex",left:8,right:8,justifyContent:"center",alignItems:"center",variants:[{props:({ownerState:e})=>e.anchorOrigin.vertical==="top",style:{top:8,[t.breakpoints.up("sm")]:{top:24}}},{props:({ownerState:e})=>e.anchorOrigin.vertical!=="top",style:{bottom:8,[t.breakpoints.up("sm")]:{bottom:24}}},{props:({ownerState:e})=>e.anchorOrigin.horizontal==="left",style:{justifyContent:"flex-start",[t.breakpoints.up("sm")]:{left:24,right:"auto"}}},{props:({ownerState:e})=>e.anchorOrigin.horizontal==="right",style:{justifyContent:"flex-end",[t.breakpoints.up("sm")]:{right:24,left:"auto"}}},{props:({ownerState:e})=>e.anchorOrigin.horizontal==="center",style:{[t.breakpoints.up("sm")]:{left:"50%",right:"auto",transform:"translateX(-50%)"}}}]}))),pge=ee.forwardRef(function(e,r){const n=_i({props:e,name:"MuiSnackbar"}),i=Tc(),a={enter:i.transitions.duration.enteringScreen,exit:i.transitions.duration.leavingScreen},{action:s,anchorOrigin:{vertical:o,horizontal:u}={vertical:"bottom",horizontal:"left"},autoHideDuration:h=null,children:f,className:g,ClickAwayListenerProps:b,ContentProps:v,disableWindowBlurListener:S=!1,message:E,onBlur:P,onClose:k,onFocus:L,onMouseEnter:O,onMouseLeave:M,open:z,resumeHideDuration:B,slots:q={},slotProps:W={},TransitionComponent:G,transitionDuration:ie=a,TransitionProps:{onEnter:Q,onExited:H,...ne}={},...oe}=n,ce={...n,anchorOrigin:{vertical:o,horizontal:u},autoHideDuration:h,disableWindowBlurListener:S,TransitionComponent:G,transitionDuration:ie},fe=fge(ce),{getRootProps:Me,onClickAway:me}=ige({...ce}),[we,Te]=ee.useState(!0),ke=Mt=>{Te(!0),H&&H(Mt)},he=(Mt,at)=>{Te(!1),Q&&Q(Mt,at)},Ee={slots:{transition:G,...q},slotProps:{content:v,clickAwayListener:b,transition:ne,...W}},[xe,Ne]=Si("root",{ref:r,className:[fe.root,g],elementType:dge,getSlotProps:Me,externalForwardedProps:{...Ee,...oe},ownerState:ce}),[Oe,{ownerState:$e,...De}]=Si("clickAwayListener",{elementType:jhe,externalForwardedProps:Ee,getSlotProps:Mt=>({onClickAway:(...at)=>{const je=at[0];Mt.onClickAway?.(...at),!je?.defaultMuiPrevented&&me(...at)}}),ownerState:ce}),[it,Ye]=Si("content",{elementType:cge,shouldForwardComponentProp:!0,externalForwardedProps:Ee,additionalProps:{message:E,action:s},ownerState:ce}),[rt,Ie]=Si("transition",{elementType:J1,externalForwardedProps:Ee,getSlotProps:Mt=>({onEnter:(...at)=>{Mt.onEnter?.(...at),he(...at)},onExited:(...at)=>{Mt.onExited?.(...at),ke(...at)}}),additionalProps:{appear:!0,in:z,timeout:ie,direction:o==="top"?"down":"up"},ownerState:ce});return!z&&we?null:K.jsx(Oe,{...De,...q.clickAwayListener&&{ownerState:$e},children:K.jsx(xe,{...Ne,children:K.jsx(rt,{...Ie,children:f||K.jsx(it,{...Ye})})})})});function gge(t){return fi("MuiTooltip",t)}const Ls=ui("MuiTooltip",["popper","popperInteractive","popperArrow","popperClose","tooltip","tooltipArrow","touch","tooltipPlacementLeft","tooltipPlacementRight","tooltipPlacementTop","tooltipPlacementBottom","arrow"]);function mge(t){return Math.round(t*1e5)/1e5}const yge=t=>{const{classes:e,disableInteractive:r,arrow:n,touch:i,placement:a}=t,s={popper:["popper",!r&&"popperInteractive",n&&"popperArrow"],tooltip:["tooltip",n&&"tooltipArrow",i&&"touch",`tooltipPlacement${on(a.split("-")[0])}`],arrow:["arrow"]};return di(s,gge,e)},vge=Pr(fG,{name:"MuiTooltip",slot:"Popper",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.popper,!r.disableInteractive&&e.popperInteractive,r.arrow&&e.popperArrow,!r.open&&e.popperClose]}})(si(({theme:t})=>({zIndex:(t.vars||t).zIndex.tooltip,pointerEvents:"none",variants:[{props:({ownerState:e})=>!e.disableInteractive,style:{pointerEvents:"auto"}},{props:({open:e})=>!e,style:{pointerEvents:"none"}},{props:({ownerState:e})=>e.arrow,style:{[`&[data-popper-placement*="bottom"] .${Ls.arrow}`]:{top:0,marginTop:"-0.71em","&::before":{transformOrigin:"0 100%"}},[`&[data-popper-placement*="top"] .${Ls.arrow}`]:{bottom:0,marginBottom:"-0.71em","&::before":{transformOrigin:"100% 0"}},[`&[data-popper-placement*="right"] .${Ls.arrow}`]:{height:"1em",width:"0.71em","&::before":{transformOrigin:"100% 100%"}},[`&[data-popper-placement*="left"] .${Ls.arrow}`]:{height:"1em",width:"0.71em","&::before":{transformOrigin:"0 0"}}}},{props:({ownerState:e})=>e.arrow&&!e.isRtl,style:{[`&[data-popper-placement*="right"] .${Ls.arrow}`]:{left:0,marginLeft:"-0.71em"}}},{props:({ownerState:e})=>e.arrow&&!!e.isRtl,style:{[`&[data-popper-placement*="right"] .${Ls.arrow}`]:{right:0,marginRight:"-0.71em"}}},{props:({ownerState:e})=>e.arrow&&!e.isRtl,style:{[`&[data-popper-placement*="left"] .${Ls.arrow}`]:{right:0,marginRight:"-0.71em"}}},{props:({ownerState:e})=>e.arrow&&!!e.isRtl,style:{[`&[data-popper-placement*="left"] .${Ls.arrow}`]:{left:0,marginLeft:"-0.71em"}}}]}))),_ge=Pr("div",{name:"MuiTooltip",slot:"Tooltip",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.tooltip,r.touch&&e.touch,r.arrow&&e.tooltipArrow,e[`tooltipPlacement${on(r.placement.split("-")[0])}`]]}})(si(({theme:t})=>({backgroundColor:t.vars?t.vars.palette.Tooltip.bg:t.alpha(t.palette.grey[700],.92),borderRadius:(t.vars||t).shape.borderRadius,color:(t.vars||t).palette.common.white,fontFamily:t.typography.fontFamily,padding:"4px 8px",fontSize:t.typography.pxToRem(11),maxWidth:300,margin:2,wordWrap:"break-word",fontWeight:t.typography.fontWeightMedium,[`.${Ls.popper}[data-popper-placement*="left"] &`]:{transformOrigin:"right center"},[`.${Ls.popper}[data-popper-placement*="right"] &`]:{transformOrigin:"left center"},[`.${Ls.popper}[data-popper-placement*="top"] &`]:{transformOrigin:"center bottom",marginBottom:"14px"},[`.${Ls.popper}[data-popper-placement*="bottom"] &`]:{transformOrigin:"center top",marginTop:"14px"},variants:[{props:({ownerState:e})=>e.arrow,style:{position:"relative",margin:0}},{props:({ownerState:e})=>e.touch,style:{padding:"8px 16px",fontSize:t.typography.pxToRem(14),lineHeight:`${mge(16/14)}em`,fontWeight:t.typography.fontWeightRegular}},{props:({ownerState:e})=>!e.isRtl,style:{[`.${Ls.popper}[data-popper-placement*="left"] &`]:{marginRight:"14px"},[`.${Ls.popper}[data-popper-placement*="right"] &`]:{marginLeft:"14px"}}},{props:({ownerState:e})=>!e.isRtl&&e.touch,style:{[`.${Ls.popper}[data-popper-placement*="left"] &`]:{marginRight:"24px"},[`.${Ls.popper}[data-popper-placement*="right"] &`]:{marginLeft:"24px"}}},{props:({ownerState:e})=>!!e.isRtl,style:{[`.${Ls.popper}[data-popper-placement*="left"] &`]:{marginLeft:"14px"},[`.${Ls.popper}[data-popper-placement*="right"] &`]:{marginRight:"14px"}}},{props:({ownerState:e})=>!!e.isRtl&&e.touch,style:{[`.${Ls.popper}[data-popper-placement*="left"] &`]:{marginLeft:"24px"},[`.${Ls.popper}[data-popper-placement*="right"] &`]:{marginRight:"24px"}}},{props:({ownerState:e})=>e.touch,style:{[`.${Ls.popper}[data-popper-placement*="top"] &`]:{marginBottom:"24px"}}},{props:({ownerState:e})=>e.touch,style:{[`.${Ls.popper}[data-popper-placement*="bottom"] &`]:{marginTop:"24px"}}}]}))),bge=Pr("span",{name:"MuiTooltip",slot:"Arrow"})(si(({theme:t})=>({overflow:"hidden",position:"absolute",width:"1em",height:"0.71em",boxSizing:"border-box",color:t.vars?t.vars.palette.Tooltip.bg:t.alpha(t.palette.grey[700],.9),"&::before":{content:'""',margin:"auto",display:"block",width:"100%",height:"100%",backgroundColor:"currentColor",transform:"rotate(45deg)"}})));let Kx=!1;const b8=new YE;let b_={x:0,y:0};function Jx(t,e){return(r,...n)=>{e&&e(r,...n),t(r,...n)}}const Np=ee.forwardRef(function(e,r){const n=_i({props:e,name:"MuiTooltip"}),{arrow:i=!1,children:a,classes:s,components:o={},componentsProps:u={},describeChild:h=!1,disableFocusListener:f=!1,disableHoverListener:g=!1,disableInteractive:b=!1,disableTouchListener:v=!1,enterDelay:S=100,enterNextDelay:E=0,enterTouchDelay:P=700,followCursor:k=!1,id:L,leaveDelay:O=0,leaveTouchDelay:M=1500,onClose:z,onOpen:B,open:q,placement:W="bottom",PopperComponent:G,PopperProps:ie={},slotProps:Q={},slots:H={},title:ne,TransitionComponent:oe,TransitionProps:ce,...fe}=n,Me=ee.isValidElement(a)?a:K.jsx("span",{children:a}),me=Tc(),we=$b(),[Te,ke]=ee.useState(),[he,Ee]=ee.useState(null),xe=ee.useRef(!1),Ne=b||k,Oe=Lp(),$e=Lp(),De=Lp(),it=Lp(),[Ye,rt]=pm({controlled:q,default:!1,name:"Tooltip",state:"open"});let Ie=Ye;const Mt=ag(L),at=ee.useRef(),je=Ql(()=>{at.current!==void 0&&(document.body.style.WebkitUserSelect=at.current,at.current=void 0),it.clear()});ee.useEffect(()=>je,[je]);const Xt=ar=>{b8.clear(),Kx=!0,rt(!0),B&&!Ie&&B(ar)},Yt=Ql(ar=>{b8.start(800+O,()=>{Kx=!1}),rt(!1),z&&Ie&&z(ar),Oe.start(me.transitions.duration.shortest,()=>{xe.current=!1})}),pr=ar=>{xe.current&&ar.type!=="touchstart"||(Te&&Te.removeAttribute("title"),$e.clear(),De.clear(),S||Kx&&E?$e.start(Kx?E:S,()=>{Xt(ar)}):Xt(ar))},vt=ar=>{$e.clear(),De.start(O,()=>{Yt(ar)})},[,yr]=ee.useState(!1),_r=ar=>{Jv(ar.target)||(yr(!1),vt(ar))},cr=ar=>{Te||ke(ar.currentTarget),Jv(ar.target)&&(yr(!0),pr(ar))},Er=ar=>{xe.current=!0;const ti=Me.props;ti.onTouchStart&&ti.onTouchStart(ar)},wr=ar=>{Er(ar),De.clear(),Oe.clear(),je(),at.current=document.body.style.WebkitUserSelect,document.body.style.WebkitUserSelect="none",it.start(P,()=>{document.body.style.WebkitUserSelect=at.current,pr(ar)})},er=ar=>{Me.props.onTouchEnd&&Me.props.onTouchEnd(ar),je(),De.start(M,()=>{Yt(ar)})};ee.useEffect(()=>{if(!Ie)return;function ar(ti){ti.key==="Escape"&&Yt(ti)}return document.addEventListener("keydown",ar),()=>{document.removeEventListener("keydown",ar)}},[Yt,Ie]);const lr=Lo(lg(Me),ke,r);!ne&&ne!==0&&(Ie=!1);const Ar=ee.useRef(),ir=ar=>{const ti=Me.props;ti.onMouseMove&&ti.onMouseMove(ar),b_={x:ar.clientX,y:ar.clientY},Ar.current&&Ar.current.update()},nt={},_e=typeof ne=="string";h?(nt.title=!Ie&&_e&&!g?ne:null,nt["aria-describedby"]=Ie?Mt:null):(nt["aria-label"]=_e?ne:null,nt["aria-labelledby"]=Ie&&!_e?Mt:null);const be={...nt,...fe,...Me.props,className:Sn(fe.className,Me.props.className),onTouchStart:Er,ref:lr,...k?{onMouseMove:ir}:{}},qe={};v||(be.onTouchStart=wr,be.onTouchEnd=er),g||(be.onMouseOver=Jx(pr,be.onMouseOver),be.onMouseLeave=Jx(vt,be.onMouseLeave),Ne||(qe.onMouseOver=pr,qe.onMouseLeave=vt)),f||(be.onFocus=Jx(cr,be.onFocus),be.onBlur=Jx(_r,be.onBlur),Ne||(qe.onFocus=cr,qe.onBlur=_r));const Qe={...n,isRtl:we,arrow:i,disableInteractive:Ne,placement:W,PopperComponentProp:G,touch:xe.current},ot=typeof Q.popper=="function"?Q.popper(Qe):Q.popper,et=ee.useMemo(()=>{let ar=[{name:"arrow",enabled:!!he,options:{element:he,padding:4}}];return ie.popperOptions?.modifiers&&(ar=ar.concat(ie.popperOptions.modifiers)),ot?.popperOptions?.modifiers&&(ar=ar.concat(ot.popperOptions.modifiers)),{...ie.popperOptions,...ot?.popperOptions,modifiers:ar}},[he,ie.popperOptions,ot?.popperOptions]),Lt=yge(Qe),_t=typeof Q.transition=="function"?Q.transition(Qe):Q.transition,jt={slots:{popper:o.Popper,transition:o.Transition??oe,tooltip:o.Tooltip,arrow:o.Arrow,...H},slotProps:{arrow:Q.arrow??u.arrow,popper:{...ie,...ot??u.popper},tooltip:Q.tooltip??u.tooltip,transition:{...ce,..._t??u.transition}}},[Jt,Kt]=Si("popper",{elementType:vge,externalForwardedProps:jt,ownerState:Qe,className:Sn(Lt.popper,ie?.className)}),[Rr,bt]=Si("transition",{elementType:J1,externalForwardedProps:jt,ownerState:Qe}),[Tr,Ur]=Si("tooltip",{elementType:_ge,className:Lt.tooltip,externalForwardedProps:jt,ownerState:Qe}),[Gr,Jr]=Si("arrow",{elementType:bge,className:Lt.arrow,externalForwardedProps:jt,ownerState:Qe,ref:Ee});return K.jsxs(ee.Fragment,{children:[ee.cloneElement(Me,be),K.jsx(Jt,{as:G??fG,placement:W,anchorEl:k?{getBoundingClientRect:()=>({top:b_.y,left:b_.x,right:b_.x,bottom:b_.y,width:0,height:0})}:Te,popperRef:Ar,open:Te?Ie:!1,id:Mt,transition:!0,...qe,...Kt,popperOptions:et,children:({TransitionProps:ar})=>K.jsx(Rr,{timeout:me.transitions.duration.shorter,...ar,...bt,children:K.jsxs(Tr,{...Ur,children:[ne,i?K.jsx(Gr,{...Jr}):null]})})})]})}),xge=Pr("div",{name:"MuiSwipeArea",shouldForwardProp:yl})(si(({theme:t})=>({position:"fixed",top:0,left:0,bottom:0,zIndex:t.zIndex.drawer-1,variants:[{props:{anchor:"left"},style:{right:"auto"}},{props:{anchor:"right"},style:{left:"auto",right:0}},{props:{anchor:"top"},style:{bottom:"auto",right:0}},{props:{anchor:"bottom"},style:{top:"auto",bottom:0,right:0}}]}))),wge=ee.forwardRef(function(e,r){const{anchor:n,classes:i={},className:a,width:s,style:o,...u}=e,h=e;return K.jsx(xge,{className:Sn("PrivateSwipeArea-root",i.root,i[`anchor${on(n)}`],a),ref:r,style:{[Vg(n)?"width":"height"]:s,...o},ownerState:h,...u})}),Qx=3,d3=20;let Sd=null;function p3(t,e,r){return t==="right"?r.body.offsetWidth-e[0].pageX:e[0].pageX}function g3(t,e,r){return t==="bottom"?r.innerHeight-e[0].clientY:e[0].clientY}function x_(t,e){return t?e.clientWidth:e.clientHeight}function x8(t,e,r,n){return Math.min(Math.max(r?e-t:n+e-t,0),n)}function Sge(t,e){const r=[];for(;t&&t!==e.parentElement;){const n=sc(e).getComputedStyle(t);n.getPropertyValue("position")==="absolute"||n.getPropertyValue("overflow-x")==="hidden"||(t.clientWidth>0&&t.scrollWidth>t.clientWidth||t.clientHeight>0&&t.scrollHeight>t.clientHeight)&&r.push(t),t=t.parentElement}return r}function Ege({domTreeShapes:t,start:e,current:r,anchor:n}){const i={scrollPosition:{x:"scrollLeft",y:"scrollTop"},scrollLength:{x:"scrollWidth",y:"scrollHeight"},clientLength:{x:"clientWidth",y:"clientHeight"}};return t.some(a=>{let s=r>=e;(n==="top"||n==="left")&&(s=!s);const o=n==="left"||n==="right"?"x":"y",u=Math.round(a[i.scrollPosition[o]]),h=u>0,f=u+a[i.clientLength[o]]<a[i.scrollLength[o]];return!!(s&&f||!s&&h)})}const Tge=typeof navigator<"u"&&/iPad|iPhone|iPod/.test(navigator.userAgent),Cge=ee.forwardRef(function(e,r){const n=_i({name:"MuiSwipeableDrawer",props:e}),i=Tc(),a={enter:i.transitions.duration.enteringScreen,exit:i.transitions.duration.leavingScreen},{anchor:s="left",disableBackdropTransition:o=!1,disableDiscovery:u=!1,disableSwipeToOpen:h=Tge,hideBackdrop:f,hysteresis:g=.52,allowSwipeInChildren:b=!1,minFlingVelocity:v=450,ModalProps:{BackdropProps:S,...E}={},onClose:P,onOpen:k,open:L=!1,PaperProps:O={},SwipeAreaProps:M,swipeAreaWidth:z=20,transitionDuration:B=a,variant:q="temporary",slots:W={},slotProps:G={},...ie}=n,[Q,H]=ee.useState(!1),ne=ee.useRef({isSwiping:null}),oe=ee.useRef(),ce=ee.useRef(),fe=ee.useRef(),Me=Lo(O.ref,fe),me=ee.useRef(!1),we=ee.useRef();yu(()=>{we.current=null},[L]);const Te=ee.useCallback(($e,De={})=>{const{mode:it=null,changeTransition:Ye=!0}=De,rt=X_(i,s),Ie=["right","bottom"].includes(rt)?1:-1,Mt=Vg(s),at=Mt?`translate(${Ie*$e}px, 0)`:`translate(0, ${Ie*$e}px)`,je=fe.current.style;je.webkitTransform=at,je.transform=at;let Xt="";if(it&&(Xt=i.transitions.create("all",Hd({easing:void 0,style:void 0,timeout:B},{mode:it}))),Ye&&(je.webkitTransition=Xt,je.transition=Xt),!o&&!f){const Yt=ce.current.style;Yt.opacity=1-$e/x_(Mt,fe.current),Ye&&(Yt.webkitTransition=Xt,Yt.transition=Xt)}},[s,o,f,i,B]),ke=Ql($e=>{if(!me.current)return;if(Sd=null,me.current=!1,Nd.flushSync(()=>{H(!1)}),!ne.current.isSwiping){ne.current.isSwiping=null;return}ne.current.isSwiping=null;const De=X_(i,s),it=Vg(s);let Ye;it?Ye=p3(De,$e.changedTouches,os($e.currentTarget)):Ye=g3(De,$e.changedTouches,sc($e.currentTarget));const rt=it?ne.current.startX:ne.current.startY,Ie=x_(it,fe.current),Mt=x8(Ye,rt,L,Ie),at=Mt/Ie;if(Math.abs(ne.current.velocity)>v&&(we.current=Math.abs((Ie-Mt)/ne.current.velocity)*1e3),L){ne.current.velocity>v||at>g?P():Te(0,{mode:"exit"});return}ne.current.velocity<-v||1-at>g?k():Te(x_(it,fe.current),{mode:"enter"})}),he=($e=!1)=>{if(!Q){($e||!(u&&b))&&Nd.flushSync(()=>{H(!0)});const De=Vg(s);!L&&fe.current&&Te(x_(De,fe.current)+(u?15:-d3),{changeTransition:!1}),ne.current.velocity=0,ne.current.lastTime=null,ne.current.lastTranslate=null,ne.current.paperHit=!1,me.current=!0}},Ee=Ql($e=>{if(!fe.current||!me.current||Sd!==null&&Sd!==ne.current)return;he(!0);const De=X_(i,s),it=Vg(s),Ye=p3(De,$e.touches,os($e.currentTarget)),rt=g3(De,$e.touches,sc($e.currentTarget));if(L&&fe.current.contains($e.target)&&Sd===null){const Xt=Sge($e.target,fe.current);if(Ege({domTreeShapes:Xt,start:it?ne.current.startX:ne.current.startY,current:it?Ye:rt,anchor:s})){Sd=!0;return}Sd=ne.current}if(ne.current.isSwiping==null){const Xt=Math.abs(Ye-ne.current.startX),Yt=Math.abs(rt-ne.current.startY),pr=it?Xt>Yt&&Xt>Qx:Yt>Xt&&Yt>Qx;if(pr&&$e.cancelable&&$e.preventDefault(),pr===!0||(it?Yt>Qx:Xt>Qx)){if(ne.current.isSwiping=pr,!pr){ke($e);return}ne.current.startX=Ye,ne.current.startY=rt,!u&&!L&&(it?ne.current.startX-=d3:ne.current.startY-=d3)}}if(!ne.current.isSwiping)return;const Ie=x_(it,fe.current);let Mt=it?ne.current.startX:ne.current.startY;L&&!ne.current.paperHit&&(Mt=Math.min(Mt,Ie));const at=x8(it?Ye:rt,Mt,L,Ie);if(L)if(ne.current.paperHit)at===0&&(ne.current.startX=Ye,ne.current.startY=rt);else if(it?Ye<Ie:rt<Ie)ne.current.paperHit=!0,ne.current.startX=Ye,ne.current.startY=rt;else return;ne.current.lastTranslate===null&&(ne.current.lastTranslate=at,ne.current.lastTime=performance.now()+1);const je=(at-ne.current.lastTranslate)/(performance.now()-ne.current.lastTime)*1e3;ne.current.velocity=ne.current.velocity*.4+je*.6,ne.current.lastTranslate=at,ne.current.lastTime=performance.now(),$e.cancelable&&$e.preventDefault(),Te(at)}),xe=Ql($e=>{if($e.defaultPrevented||$e.defaultMuiPrevented||L&&(f||!ce.current.contains($e.target))&&!fe.current.contains($e.target))return;const De=X_(i,s),it=Vg(s),Ye=p3(De,$e.touches,os($e.currentTarget)),rt=g3(De,$e.touches,sc($e.currentTarget));if(!L){if(h||!($e.target===oe.current||fe.current?.contains($e.target)&&(typeof b=="function"?b($e,oe.current,fe.current):b)))return;if(it){if(Ye>z)return}else if(rt>z)return}$e.defaultMuiPrevented=!0,Sd=null,ne.current.startX=Ye,ne.current.startY=rt,he()});ee.useEffect(()=>{if(q==="temporary"){const $e=os(fe.current);return $e.addEventListener("touchstart",xe),$e.addEventListener("touchmove",Ee,{passive:!L}),$e.addEventListener("touchend",ke),()=>{$e.removeEventListener("touchstart",xe),$e.removeEventListener("touchmove",Ee,{passive:!L}),$e.removeEventListener("touchend",ke)}}},[q,L,xe,Ee,ke]),ee.useEffect(()=>()=>{Sd===ne.current&&(Sd=null)},[]),ee.useEffect(()=>{L||H(!1)},[L]);const[Ne,Oe]=Si("swipeArea",{ref:oe,elementType:wge,ownerState:n,externalForwardedProps:{slots:W,slotProps:{swipeArea:M,...G}},additionalProps:{width:z,anchor:s}});return K.jsxs(ee.Fragment,{children:[K.jsx(eO,{open:q==="temporary"&&Q?!0:L,variant:q,ModalProps:{BackdropProps:{...S,ref:ce},...q==="temporary"&&{keepMounted:!0},...E},hideBackdrop:f,anchor:s,transitionDuration:we.current||B,onClose:P,ref:r,slots:W,slotProps:{...G,backdrop:Y1(G.backdrop??S,{ref:ce}),paper:Y1(G.paper??O,{style:{pointerEvents:q==="temporary"&&!L&&!b?"none":""},ref:Me})},...ie}),!h&&q==="temporary"&&K.jsx(npe,{children:K.jsx(Ne,{...Oe})})]})});function Age(t){return fi("MuiToolbar",t)}ui("MuiToolbar",["root","gutters","regular","dense"]);const Ige=t=>{const{classes:e,disableGutters:r,variant:n}=t;return di({root:["root",!r&&"gutters",n]},Age,e)},Pge=Pr("div",{name:"MuiToolbar",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.root,!r.disableGutters&&e.gutters,e[r.variant]]}})(si(({theme:t})=>({position:"relative",display:"flex",alignItems:"center",variants:[{props:({ownerState:e})=>!e.disableGutters,style:{paddingLeft:t.spacing(2),paddingRight:t.spacing(2),[t.breakpoints.up("sm")]:{paddingLeft:t.spacing(3),paddingRight:t.spacing(3)}}},{props:{variant:"dense"},style:{minHeight:48}},{props:{variant:"regular"},style:t.mixins.toolbar}]}))),kge=ee.forwardRef(function(e,r){const n=_i({props:e,name:"MuiToolbar"}),{className:i,component:a="div",disableGutters:s=!1,variant:o="regular",...u}=n,h={...n,component:a,disableGutters:s,variant:o},f=Ige(h);return K.jsx(Pge,{as:a,className:Sn(f.root,i),ref:r,ownerState:h,...u})});function Mge(t){return fi("MuiTextField",t)}ui("MuiTextField",["root"]);const Rge={standard:rO,filled:tO,outlined:rT},Oge=t=>{const{classes:e}=t;return di({root:["root"]},Mge,e)},Lge=Pr(Zc,{name:"MuiTextField",slot:"Root"})({}),nT=ee.forwardRef(function(e,r){const n=_i({props:e,name:"MuiTextField"}),{autoComplete:i,autoFocus:a=!1,children:s,className:o,color:u="primary",defaultValue:h,disabled:f=!1,error:g=!1,FormHelperTextProps:b,fullWidth:v=!1,helperText:S,id:E,InputLabelProps:P,inputProps:k,InputProps:L,inputRef:O,label:M,maxRows:z,minRows:B,multiline:q=!1,name:W,onBlur:G,onChange:ie,onFocus:Q,placeholder:H,required:ne=!1,rows:oe,select:ce=!1,SelectProps:fe,slots:Me={},slotProps:me={},type:we,value:Te,variant:ke="outlined",...he}=n,Ee={...n,autoFocus:a,color:u,disabled:f,error:g,fullWidth:v,multiline:q,required:ne,select:ce,variant:ke},xe=Oge(Ee),Ne=ag(E),Oe=S&&Ne?`${Ne}-helper-text`:void 0,$e=M&&Ne?`${Ne}-label`:void 0,De=Rge[ke],it={slots:Me,slotProps:{input:L,inputLabel:P,htmlInput:k,formHelperText:b,select:fe,...me}},Ye={},rt=it.slotProps.inputLabel;ke==="outlined"&&(rt&&typeof rt.shrink<"u"&&(Ye.notched=rt.shrink),Ye.label=M),ce&&((!fe||!fe.native)&&(Ye.id=void 0),Ye["aria-describedby"]=void 0);const[Ie,Mt]=Si("root",{elementType:Lge,shouldForwardComponentProp:!0,externalForwardedProps:{...it,...he},ownerState:Ee,className:Sn(xe.root,o),ref:r,additionalProps:{disabled:f,error:g,fullWidth:v,required:ne,color:u,variant:ke}}),[at,je]=Si("input",{elementType:De,externalForwardedProps:it,additionalProps:Ye,ownerState:Ee}),[Xt,Yt]=Si("inputLabel",{elementType:$p,externalForwardedProps:it,ownerState:Ee}),[pr,vt]=Si("htmlInput",{elementType:"input",externalForwardedProps:it,ownerState:Ee}),[yr,_r]=Si("formHelperText",{elementType:ede,externalForwardedProps:it,ownerState:Ee}),[cr,Er]=Si("select",{elementType:qp,externalForwardedProps:it,ownerState:Ee}),wr=K.jsx(at,{"aria-describedby":Oe,autoComplete:i,autoFocus:a,defaultValue:h,fullWidth:v,multiline:q,name:W,rows:oe,maxRows:z,minRows:B,type:we,value:Te,id:Ne,inputRef:O,onBlur:G,onChange:ie,onFocus:Q,placeholder:H,inputProps:vt,slots:{input:Me.htmlInput?pr:void 0},...je});return K.jsxs(Ie,{...Mt,children:[M!=null&&M!==""&&K.jsx(Xt,{htmlFor:Ne,id:$e,...Yt,children:M}),ce?K.jsx(cr,{"aria-describedby":Oe,id:Ne,labelId:$e,value:Te,input:wr,...Er,children:s}):wr,S&&K.jsx(yr,{id:Oe,..._r,children:S})]})}),Gb=kW({themeId:nf}),Nge=Hi(K.jsx("path",{d:"M5 15H3v4c0 1.1.9 2 2 2h4v-2H5zM5 5h4V3H5c-1.1 0-2 .9-2 2v4h2zm14-2h-4v2h4v4h2V5c0-1.1-.9-2-2-2m0 16h-4v2h4c1.1 0 2-.9 2-2v-4h-2zM12 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3"})),DP=t=>{const e=ha({mapId:t.mapId,waitForLayer:t.insertBeforeLayer}),[r,n]=ee.useState(!1),i=()=>{navigator.geolocation.getCurrentPosition(a,s)},a=ee.useCallback(o=>{e.map?.map.setCenter?.([o.coords.longitude,o.coords.latitude])},[e.map]),s=()=>{console.log("Access of user location denied"),n(!0)};return K.jsx(K.Fragment,{children:K.jsx(Ji,{variant:"navtools",sx:o=>({zIndex:1002,color:r?t.offColor??o.palette.navigation.buttonColor:t.onColor??o.palette.navigation.buttonColor}),onClick:i,disabled:r,children:K.jsx(Nge,{sx:{fontSize:{xs:"1.4em",md:"1em"}}})})})};try{DP.displayName="MlCenterPosition",DP.__docgenInfo={description:"Component template",displayName:"MlCenterPosition",props:{mapId:{defaultValue:null,description:"Id of the target MapLibre instance in mapContext",name:"mapId",required:!1,type:{name:"string | undefined"}},insertBeforeLayer:{defaultValue:null,description:`Id of an existing layer in the mapLibre instance to help specify the layer order
This layer will be visually beneath the layer with the "insertBeforeLayer" id.`,name:"insertBeforeLayer",required:!1,type:{name:"string | undefined"}},onColor:{defaultValue:null,description:"Active button font color",name:"onColor",required:!1,type:{name:"string | undefined"}},offColor:{defaultValue:null,description:"Inactive button font color",name:"offColor",required:!1,type:{name:"string | undefined"}},style:{defaultValue:null,description:"CSS style object that is applied to the button component",name:"style",required:!1,type:{name:"SxProps<Theme> | undefined"}}}}}catch{}const w8=t=>{const e=ha({mapId:t.mapId});return console.log(e.componentId+" remove this log"),K.jsx(K.Fragment,{})};try{w8.displayName="MlComponentTemplate",w8.__docgenInfo={description:"Component description",displayName:"MlComponentTemplate",props:{mapId:{defaultValue:null,description:"Id of the target MapLibre instance in mapContext",name:"mapId",required:!1,type:{name:"string | undefined"}}}}}catch{}const Dge=Hi(K.jsx("path",{d:"M19 8H5c-1.66 0-3 1.34-3 3v6h4v4h12v-4h4v-6c0-1.66-1.34-3-3-3m-3 11H8v-5h8zm3-7c-.55 0-1-.45-1-1s.45-1 1-1 1 .45 1 1-.45 1-1 1m-1-9H6v4h12z"}));function ao(t){"@babel/helpers - typeof";return ao=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ao(t)}var of=Uint8Array,Kc=Uint16Array,oO=Int32Array,sO=new of([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),lO=new of([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),S8=new of([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),FG=function(t,e){for(var r=new Kc(31),n=0;n<31;++n)r[n]=e+=1<<t[n-1];for(var i=new oO(r[30]),n=1;n<30;++n)for(var a=r[n];a<r[n+1];++a)i[a]=a-r[n]<<5|n;return{b:r,r:i}},BG=FG(sO,2),Fge=BG.b,FP=BG.r;Fge[28]=258,FP[258]=28;var Bge=FG(lO,0),E8=Bge.r,BP=new Kc(32768);for(var qo=0;qo<32768;++qo){var bp=(qo&43690)>>1|(qo&21845)<<1;bp=(bp&52428)>>2|(bp&13107)<<2,bp=(bp&61680)>>4|(bp&3855)<<4,BP[qo]=((bp&65280)>>8|(bp&255)<<8)>>1}var E1=(function(t,e,r){for(var n=t.length,i=0,a=new Kc(e);i<n;++i)t[i]&&++a[t[i]-1];var s=new Kc(e);for(i=1;i<e;++i)s[i]=s[i-1]+a[i-1]<<1;var o;if(r){o=new Kc(1<<e);var u=15-e;for(i=0;i<n;++i)if(t[i])for(var h=i<<4|t[i],f=e-t[i],g=s[t[i]-1]++<<f,b=g|(1<<f)-1;g<=b;++g)o[BP[g]>>u]=h}else for(o=new Kc(n),i=0;i<n;++i)t[i]&&(o[i]=BP[s[t[i]-1]++]>>15-t[i]);return o}),mm=new of(288);for(var qo=0;qo<144;++qo)mm[qo]=8;for(var qo=144;qo<256;++qo)mm[qo]=9;for(var qo=256;qo<280;++qo)mm[qo]=7;for(var qo=280;qo<288;++qo)mm[qo]=8;var Kw=new of(32);for(var qo=0;qo<32;++qo)Kw[qo]=5;var zge=E1(mm,9,0),jge=E1(Kw,5,0),zG=function(t){return(t+7)/8|0},Uge=function(t,e,r){return(r==null||r>t.length)&&(r=t.length),new of(t.subarray(e,r))},Ed=function(t,e,r){r<<=e&7;var n=e/8|0;t[n]|=r,t[n+1]|=r>>8},w_=function(t,e,r){r<<=e&7;var n=e/8|0;t[n]|=r,t[n+1]|=r>>8,t[n+2]|=r>>16},m3=function(t,e){for(var r=[],n=0;n<t.length;++n)t[n]&&r.push({s:n,f:t[n]});var i=r.length,a=r.slice();if(!i)return{t:UG,l:0};if(i==1){var s=new of(r[0].s+1);return s[r[0].s]=1,{t:s,l:1}}r.sort(function(z,B){return z.f-B.f}),r.push({s:-1,f:25001});var o=r[0],u=r[1],h=0,f=1,g=2;for(r[0]={s:-1,f:o.f+u.f,l:o,r:u};f!=i-1;)o=r[r[h].f<r[g].f?h++:g++],u=r[h!=f&&r[h].f<r[g].f?h++:g++],r[f++]={s:-1,f:o.f+u.f,l:o,r:u};for(var b=a[0].s,n=1;n<i;++n)a[n].s>b&&(b=a[n].s);var v=new Kc(b+1),S=zP(r[f-1],v,0);if(S>e){var n=0,E=0,P=S-e,k=1<<P;for(a.sort(function(B,q){return v[q.s]-v[B.s]||B.f-q.f});n<i;++n){var L=a[n].s;if(v[L]>e)E+=k-(1<<S-v[L]),v[L]=e;else break}for(E>>=P;E>0;){var O=a[n].s;v[O]<e?E-=1<<e-v[O]++-1:++n}for(;n>=0&&E;--n){var M=a[n].s;v[M]==e&&(--v[M],++E)}S=e}return{t:new of(v),l:S}},zP=function(t,e,r){return t.s==-1?Math.max(zP(t.l,e,r+1),zP(t.r,e,r+1)):e[t.s]=r},T8=function(t){for(var e=t.length;e&&!t[--e];);for(var r=new Kc(++e),n=0,i=t[0],a=1,s=function(u){r[n++]=u},o=1;o<=e;++o)if(t[o]==i&&o!=e)++a;else{if(!i&&a>2){for(;a>138;a-=138)s(32754);a>2&&(s(a>10?a-11<<5|28690:a-3<<5|12305),a=0)}else if(a>3){for(s(i),--a;a>6;a-=6)s(8304);a>2&&(s(a-3<<5|8208),a=0)}for(;a--;)s(i);a=1,i=t[o]}return{c:r.subarray(0,n),n:e}},S_=function(t,e){for(var r=0,n=0;n<e.length;++n)r+=t[n]*e[n];return r},jG=function(t,e,r){var n=r.length,i=zG(e+2);t[i]=n&255,t[i+1]=n>>8,t[i+2]=t[i]^255,t[i+3]=t[i+1]^255;for(var a=0;a<n;++a)t[i+a+4]=r[a];return(i+4+n)*8},C8=function(t,e,r,n,i,a,s,o,u,h,f){Ed(e,f++,r),++i[256];for(var g=m3(i,15),b=g.t,v=g.l,S=m3(a,15),E=S.t,P=S.l,k=T8(b),L=k.c,O=k.n,M=T8(E),z=M.c,B=M.n,q=new Kc(19),W=0;W<L.length;++W)++q[L[W]&31];for(var W=0;W<z.length;++W)++q[z[W]&31];for(var G=m3(q,7),ie=G.t,Q=G.l,H=19;H>4&&!ie[S8[H-1]];--H);var ne=h+5<<3,oe=S_(i,mm)+S_(a,Kw)+s,ce=S_(i,b)+S_(a,E)+s+14+3*H+S_(q,ie)+2*q[16]+3*q[17]+7*q[18];if(u>=0&&ne<=oe&&ne<=ce)return jG(e,f,t.subarray(u,u+h));var fe,Me,me,we;if(Ed(e,f,1+(ce<oe)),f+=2,ce<oe){fe=E1(b,v,0),Me=b,me=E1(E,P,0),we=E;var Te=E1(ie,Q,0);Ed(e,f,O-257),Ed(e,f+5,B-1),Ed(e,f+10,H-4),f+=14;for(var W=0;W<H;++W)Ed(e,f+3*W,ie[S8[W]]);f+=3*H;for(var ke=[L,z],he=0;he<2;++he)for(var Ee=ke[he],W=0;W<Ee.length;++W){var xe=Ee[W]&31;Ed(e,f,Te[xe]),f+=ie[xe],xe>15&&(Ed(e,f,Ee[W]>>5&127),f+=Ee[W]>>12)}}else fe=zge,Me=mm,me=jge,we=Kw;for(var W=0;W<o;++W){var Ne=n[W];if(Ne>255){var xe=Ne>>18&31;w_(e,f,fe[xe+257]),f+=Me[xe+257],xe>7&&(Ed(e,f,Ne>>23&31),f+=sO[xe]);var Oe=Ne&31;w_(e,f,me[Oe]),f+=we[Oe],Oe>3&&(w_(e,f,Ne>>5&8191),f+=lO[Oe])}else w_(e,f,fe[Ne]),f+=Me[Ne]}return w_(e,f,fe[256]),f+Me[256]},Vge=new oO([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),UG=new of(0),$ge=function(t,e,r,n,i,a){var s=a.z||t.length,o=new of(n+s+5*(1+Math.ceil(s/7e3))+i),u=o.subarray(n,o.length-i),h=a.l,f=(a.r||0)&7;if(e){f&&(u[0]=a.r>>3);for(var g=Vge[e-1],b=g>>13,v=g&8191,S=(1<<r)-1,E=a.p||new Kc(32768),P=a.h||new Kc(S+1),k=Math.ceil(r/3),L=2*k,O=function(at){return(t[at]^t[at+1]<<k^t[at+2]<<L)&S},M=new oO(25e3),z=new Kc(288),B=new Kc(32),q=0,W=0,G=a.i||0,ie=0,Q=a.w||0,H=0;G+2<s;++G){var ne=O(G),oe=G&32767,ce=P[ne];if(E[oe]=ce,P[ne]=oe,Q<=G){var fe=s-G;if((q>7e3||ie>24576)&&(fe>423||!h)){f=C8(t,u,0,M,z,B,W,ie,H,G-H,f),ie=q=W=0,H=G;for(var Me=0;Me<286;++Me)z[Me]=0;for(var Me=0;Me<30;++Me)B[Me]=0}var me=2,we=0,Te=v,ke=oe-ce&32767;if(fe>2&&ne==O(G-ke))for(var he=Math.min(b,fe)-1,Ee=Math.min(32767,G),xe=Math.min(258,fe);ke<=Ee&&--Te&&oe!=ce;){if(t[G+me]==t[G+me-ke]){for(var Ne=0;Ne<xe&&t[G+Ne]==t[G+Ne-ke];++Ne);if(Ne>me){if(me=Ne,we=ke,Ne>he)break;for(var Oe=Math.min(ke,Ne-2),$e=0,Me=0;Me<Oe;++Me){var De=G-ke+Me&32767,it=E[De],Ye=De-it&32767;Ye>$e&&($e=Ye,ce=De)}}}oe=ce,ce=E[oe],ke+=oe-ce&32767}if(we){M[ie++]=268435456|FP[me]<<18|E8[we];var rt=FP[me]&31,Ie=E8[we]&31;W+=sO[rt]+lO[Ie],++z[257+rt],++B[Ie],Q=G+me,++q}else M[ie++]=t[G],++z[t[G]]}}for(G=Math.max(G,Q);G<s;++G)M[ie++]=t[G],++z[t[G]];f=C8(t,u,h,M,z,B,W,ie,H,G-H,f),h||(a.r=f&7|u[f/8|0]<<3,f-=7,a.h=P,a.p=E,a.i=G,a.w=Q)}else{for(var G=a.w||0;G<s+h;G+=65535){var Mt=G+65535;Mt>=s&&(u[f/8|0]=h,Mt=s),f=jG(u,f+1,t.subarray(G,Mt))}a.i=s}return Uge(o,0,n+zG(f)+i)},VG=function(){var t=1,e=0;return{p:function(r){for(var n=t,i=e,a=r.length|0,s=0;s!=a;){for(var o=Math.min(s+2655,a);s<o;++s)i+=n+=r[s];n=(n&65535)+15*(n>>16),i=(i&65535)+15*(i>>16)}t=n,e=i},d:function(){return t%=65521,e%=65521,(t&255)<<24|(t&65280)<<8|(e&255)<<8|e>>8}}},qge=function(t,e,r,n,i){if(!i&&(i={l:1},e.dictionary)){var a=e.dictionary.subarray(-32768),s=new of(a.length+t.length);s.set(a),s.set(t,a.length),t=s,i.w=a.length}return $ge(t,e.level==null?6:e.level,e.mem==null?i.l?Math.ceil(Math.max(8,Math.min(13,Math.log(t.length)))*1.5):20:12+e.mem,r,n,i)},$G=function(t,e,r){for(;r;++e)t[e]=r,r>>>=8},Hge=function(t,e){var r=e.level,n=r==0?0:r<6?1:r==9?3:2;if(t[0]=120,t[1]=n<<6|(e.dictionary&&32),t[1]|=31-(t[0]<<8|t[1])%31,e.dictionary){var i=VG();i.p(e.dictionary),$G(t,2,i.d())}};function jP(t,e){e||(e={});var r=VG();r.p(t);var n=qge(t,e,e.dictionary?6:2,4);return Hge(n,e),$G(n,n.length-4,r.d()),n}var Wge=typeof TextDecoder<"u"&&new TextDecoder,Gge=0;try{Wge.decode(UG,{stream:!0}),Gge=1}catch{}function Xge(t){if(Array.isArray(t))return t}function Yge(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,i,a,s,o=[],u=!0,h=!1;try{if(a=(r=r.call(t)).next,e!==0)for(;!(u=(n=a.call(r)).done)&&(o.push(n.value),o.length!==e);u=!0);}catch(f){h=!0,i=f}finally{try{if(!u&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(h)throw i}}return o}}function A8(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function Zge(t,e){if(t){if(typeof t=="string")return A8(t,e);var r={}.toString.call(t).slice(8,-1);return r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set"?Array.from(t):r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?A8(t,e):void 0}}function Kge(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function I8(t,e){return Xge(t)||Yge(t,e)||Zge(t,e)||Kge()}function P8(t,e="utf8"){return new TextDecoder(e).decode(t)}const Jge=new TextEncoder;function Qge(t){return Jge.encode(t)}const eme=1024*8,tme=(()=>{const t=new Uint8Array(4),e=new Uint32Array(t.buffer);return!((e[0]=1)&t[0])})(),y3={int8:globalThis.Int8Array,uint8:globalThis.Uint8Array,int16:globalThis.Int16Array,uint16:globalThis.Uint16Array,int32:globalThis.Int32Array,uint32:globalThis.Uint32Array,uint64:globalThis.BigUint64Array,int64:globalThis.BigInt64Array,float32:globalThis.Float32Array,float64:globalThis.Float64Array};class uO{buffer;byteLength;byteOffset;length;offset;lastWrittenByte;littleEndian;_data;_mark;_marks;constructor(e=eme,r={}){let n=!1;typeof e=="number"?e=new ArrayBuffer(e):(n=!0,this.lastWrittenByte=e.byteLength);const i=r.offset?r.offset>>>0:0,a=e.byteLength-i;let s=i;(ArrayBuffer.isView(e)||e instanceof uO)&&(e.byteLength!==e.buffer.byteLength&&(s=e.byteOffset+i),e=e.buffer),n?this.lastWrittenByte=a:this.lastWrittenByte=0,this.buffer=e,this.length=a,this.byteLength=a,this.byteOffset=s,this.offset=0,this.littleEndian=!0,this._data=new DataView(this.buffer,s,a),this._mark=0,this._marks=[]}available(e=1){return this.offset+e<=this.length}isLittleEndian(){return this.littleEndian}setLittleEndian(){return this.littleEndian=!0,this}isBigEndian(){return!this.littleEndian}setBigEndian(){return this.littleEndian=!1,this}skip(e=1){return this.offset+=e,this}back(e=1){return this.offset-=e,this}seek(e){return this.offset=e,this}mark(){return this._mark=this.offset,this}reset(){return this.offset=this._mark,this}pushMark(){return this._marks.push(this.offset),this}popMark(){const e=this._marks.pop();if(e===void 0)throw new Error("Mark stack empty");return this.seek(e),this}rewind(){return this.offset=0,this}ensureAvailable(e=1){if(!this.available(e)){const n=(this.offset+e)*2,i=new Uint8Array(n);i.set(new Uint8Array(this.buffer)),this.buffer=i.buffer,this.length=n,this.byteLength=n,this._data=new DataView(this.buffer)}return this}readBoolean(){return this.readUint8()!==0}readInt8(){return this._data.getInt8(this.offset++)}readUint8(){return this._data.getUint8(this.offset++)}readByte(){return this.readUint8()}readBytes(e=1){return this.readArray(e,"uint8")}readArray(e,r){const n=y3[r].BYTES_PER_ELEMENT*e,i=this.byteOffset+this.offset,a=this.buffer.slice(i,i+n);if(this.littleEndian===tme&&r!=="uint8"&&r!=="int8"){const o=new Uint8Array(this.buffer.slice(i,i+n));o.reverse();const u=new y3[r](o.buffer);return this.offset+=n,u.reverse(),u}const s=new y3[r](a);return this.offset+=n,s}readInt16(){const e=this._data.getInt16(this.offset,this.littleEndian);return this.offset+=2,e}readUint16(){const e=this._data.getUint16(this.offset,this.littleEndian);return this.offset+=2,e}readInt32(){const e=this._data.getInt32(this.offset,this.littleEndian);return this.offset+=4,e}readUint32(){const e=this._data.getUint32(this.offset,this.littleEndian);return this.offset+=4,e}readFloat32(){const e=this._data.getFloat32(this.offset,this.littleEndian);return this.offset+=4,e}readFloat64(){const e=this._data.getFloat64(this.offset,this.littleEndian);return this.offset+=8,e}readBigInt64(){const e=this._data.getBigInt64(this.offset,this.littleEndian);return this.offset+=8,e}readBigUint64(){const e=this._data.getBigUint64(this.offset,this.littleEndian);return this.offset+=8,e}readChar(){return String.fromCharCode(this.readInt8())}readChars(e=1){let r="";for(let n=0;n<e;n++)r+=this.readChar();return r}readUtf8(e=1){return P8(this.readBytes(e))}decodeText(e=1,r="utf8"){return P8(this.readBytes(e),r)}writeBoolean(e){return this.writeUint8(e?255:0),this}writeInt8(e){return this.ensureAvailable(1),this._data.setInt8(this.offset++,e),this._updateLastWrittenByte(),this}writeUint8(e){return this.ensureAvailable(1),this._data.setUint8(this.offset++,e),this._updateLastWrittenByte(),this}writeByte(e){return this.writeUint8(e)}writeBytes(e){this.ensureAvailable(e.length);for(let r=0;r<e.length;r++)this._data.setUint8(this.offset++,e[r]);return this._updateLastWrittenByte(),this}writeInt16(e){return this.ensureAvailable(2),this._data.setInt16(this.offset,e,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeUint16(e){return this.ensureAvailable(2),this._data.setUint16(this.offset,e,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeInt32(e){return this.ensureAvailable(4),this._data.setInt32(this.offset,e,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeUint32(e){return this.ensureAvailable(4),this._data.setUint32(this.offset,e,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat32(e){return this.ensureAvailable(4),this._data.setFloat32(this.offset,e,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat64(e){return this.ensureAvailable(8),this._data.setFloat64(this.offset,e,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigInt64(e){return this.ensureAvailable(8),this._data.setBigInt64(this.offset,e,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigUint64(e){return this.ensureAvailable(8),this._data.setBigUint64(this.offset,e,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeChar(e){return this.writeUint8(e.charCodeAt(0))}writeChars(e){for(let r=0;r<e.length;r++)this.writeUint8(e.charCodeAt(r));return this}writeUtf8(e){return this.writeBytes(Qge(e))}toArray(){return new Uint8Array(this.buffer,this.byteOffset,this.lastWrittenByte)}getWrittenByteLength(){return this.lastWrittenByte-this.byteOffset}_updateLastWrittenByte(){this.offset>this.lastWrittenByte&&(this.lastWrittenByte=this.offset)}}function R0(t){let e=t.length;for(;--e>=0;)t[e]=0}const rme=3,nme=258,qG=29,ime=256,ame=ime+1+qG,HG=30,ome=512,sme=new Array((ame+2)*2);R0(sme);const lme=new Array(HG*2);R0(lme);const ume=new Array(ome);R0(ume);const cme=new Array(nme-rme+1);R0(cme);const hme=new Array(qG);R0(hme);const fme=new Array(HG);R0(fme);const dme=(t,e,r,n)=>{let i=t&65535|0,a=t>>>16&65535|0,s=0;for(;r!==0;){s=r>2e3?2e3:r,r-=s;do i=i+e[n++]|0,a=a+i|0;while(--s);i%=65521,a%=65521}return i|a<<16|0};var UP=dme;const pme=()=>{let t,e=[];for(var r=0;r<256;r++){t=r;for(var n=0;n<8;n++)t=t&1?3988292384^t>>>1:t>>>1;e[r]=t}return e},gme=new Uint32Array(pme()),mme=(t,e,r,n)=>{const i=gme,a=n+r;t^=-1;for(let s=n;s<a;s++)t=t>>>8^i[(t^e[s])&255];return t^-1};var Nf=mme,VP={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},WG={Z_NO_FLUSH:0,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_DEFLATED:8};const yme=(t,e)=>Object.prototype.hasOwnProperty.call(t,e);var vme=function(t){const e=Array.prototype.slice.call(arguments,1);for(;e.length;){const r=e.shift();if(r){if(typeof r!="object")throw new TypeError(r+"must be non-object");for(const n in r)yme(r,n)&&(t[n]=r[n])}}return t},_me=t=>{let e=0;for(let n=0,i=t.length;n<i;n++)e+=t[n].length;const r=new Uint8Array(e);for(let n=0,i=0,a=t.length;n<a;n++){let s=t[n];r.set(s,i),i+=s.length}return r},GG={assign:vme,flattenChunks:_me};let XG=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{XG=!1}const eb=new Uint8Array(256);for(let t=0;t<256;t++)eb[t]=t>=252?6:t>=248?5:t>=240?4:t>=224?3:t>=192?2:1;eb[254]=eb[254]=1;var bme=t=>{if(typeof TextEncoder=="function"&&TextEncoder.prototype.encode)return new TextEncoder().encode(t);let e,r,n,i,a,s=t.length,o=0;for(i=0;i<s;i++)r=t.charCodeAt(i),(r&64512)===55296&&i+1<s&&(n=t.charCodeAt(i+1),(n&64512)===56320&&(r=65536+(r-55296<<10)+(n-56320),i++)),o+=r<128?1:r<2048?2:r<65536?3:4;for(e=new Uint8Array(o),a=0,i=0;a<o;i++)r=t.charCodeAt(i),(r&64512)===55296&&i+1<s&&(n=t.charCodeAt(i+1),(n&64512)===56320&&(r=65536+(r-55296<<10)+(n-56320),i++)),r<128?e[a++]=r:r<2048?(e[a++]=192|r>>>6,e[a++]=128|r&63):r<65536?(e[a++]=224|r>>>12,e[a++]=128|r>>>6&63,e[a++]=128|r&63):(e[a++]=240|r>>>18,e[a++]=128|r>>>12&63,e[a++]=128|r>>>6&63,e[a++]=128|r&63);return e};const xme=(t,e)=>{if(e<65534&&t.subarray&&XG)return String.fromCharCode.apply(null,t.length===e?t:t.subarray(0,e));let r="";for(let n=0;n<e;n++)r+=String.fromCharCode(t[n]);return r};var wme=(t,e)=>{const r=e||t.length;if(typeof TextDecoder=="function"&&TextDecoder.prototype.decode)return new TextDecoder().decode(t.subarray(0,e));let n,i;const a=new Array(r*2);for(i=0,n=0;n<r;){let s=t[n++];if(s<128){a[i++]=s;continue}let o=eb[s];if(o>4){a[i++]=65533,n+=o-1;continue}for(s&=o===2?31:o===3?15:7;o>1&&n<r;)s=s<<6|t[n++]&63,o--;if(o>1){a[i++]=65533;continue}s<65536?a[i++]=s:(s-=65536,a[i++]=55296|s>>10&1023,a[i++]=56320|s&1023)}return xme(a,i)},Sme=(t,e)=>{e=e||t.length,e>t.length&&(e=t.length);let r=e-1;for(;r>=0&&(t[r]&192)===128;)r--;return r<0||r===0?e:r+eb[t[r]]>e?r:e},$P={string2buf:bme,buf2string:wme,utf8border:Sme};function Eme(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}var Tme=Eme;const e2=16209,Cme=16191;var Ame=function(e,r){let n,i,a,s,o,u,h,f,g,b,v,S,E,P,k,L,O,M,z,B,q,W,G,ie;const Q=e.state;n=e.next_in,G=e.input,i=n+(e.avail_in-5),a=e.next_out,ie=e.output,s=a-(r-e.avail_out),o=a+(e.avail_out-257),u=Q.dmax,h=Q.wsize,f=Q.whave,g=Q.wnext,b=Q.window,v=Q.hold,S=Q.bits,E=Q.lencode,P=Q.distcode,k=(1<<Q.lenbits)-1,L=(1<<Q.distbits)-1;e:do{S<15&&(v+=G[n++]<<S,S+=8,v+=G[n++]<<S,S+=8),O=E[v&k];t:for(;;){if(M=O>>>24,v>>>=M,S-=M,M=O>>>16&255,M===0)ie[a++]=O&65535;else if(M&16){z=O&65535,M&=15,M&&(S<M&&(v+=G[n++]<<S,S+=8),z+=v&(1<<M)-1,v>>>=M,S-=M),S<15&&(v+=G[n++]<<S,S+=8,v+=G[n++]<<S,S+=8),O=P[v&L];r:for(;;){if(M=O>>>24,v>>>=M,S-=M,M=O>>>16&255,M&16){if(B=O&65535,M&=15,S<M&&(v+=G[n++]<<S,S+=8,S<M&&(v+=G[n++]<<S,S+=8)),B+=v&(1<<M)-1,B>u){e.msg="invalid distance too far back",Q.mode=e2;break e}if(v>>>=M,S-=M,M=a-s,B>M){if(M=B-M,M>f&&Q.sane){e.msg="invalid distance too far back",Q.mode=e2;break e}if(q=0,W=b,g===0){if(q+=h-M,M<z){z-=M;do ie[a++]=b[q++];while(--M);q=a-B,W=ie}}else if(g<M){if(q+=h+g-M,M-=g,M<z){z-=M;do ie[a++]=b[q++];while(--M);if(q=0,g<z){M=g,z-=M;do ie[a++]=b[q++];while(--M);q=a-B,W=ie}}}else if(q+=g-M,M<z){z-=M;do ie[a++]=b[q++];while(--M);q=a-B,W=ie}for(;z>2;)ie[a++]=W[q++],ie[a++]=W[q++],ie[a++]=W[q++],z-=3;z&&(ie[a++]=W[q++],z>1&&(ie[a++]=W[q++]))}else{q=a-B;do ie[a++]=ie[q++],ie[a++]=ie[q++],ie[a++]=ie[q++],z-=3;while(z>2);z&&(ie[a++]=ie[q++],z>1&&(ie[a++]=ie[q++]))}}else if((M&64)===0){O=P[(O&65535)+(v&(1<<M)-1)];continue r}else{e.msg="invalid distance code",Q.mode=e2;break e}break}}else if((M&64)===0){O=E[(O&65535)+(v&(1<<M)-1)];continue t}else if(M&32){Q.mode=Cme;break e}else{e.msg="invalid literal/length code",Q.mode=e2;break e}break}}while(n<i&&a<o);z=S>>3,n-=z,S-=z<<3,v&=(1<<S)-1,e.next_in=n,e.next_out=a,e.avail_in=n<i?5+(i-n):5-(n-i),e.avail_out=a<o?257+(o-a):257-(a-o),Q.hold=v,Q.bits=S};const My=15,k8=852,M8=592,R8=0,v3=1,O8=2,Ime=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),Pme=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),kme=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),Mme=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]),Rme=(t,e,r,n,i,a,s,o)=>{const u=o.bits;let h=0,f=0,g=0,b=0,v=0,S=0,E=0,P=0,k=0,L=0,O,M,z,B,q,W=null,G;const ie=new Uint16Array(My+1),Q=new Uint16Array(My+1);let H=null,ne,oe,ce;for(h=0;h<=My;h++)ie[h]=0;for(f=0;f<n;f++)ie[e[r+f]]++;for(v=u,b=My;b>=1&&ie[b]===0;b--);if(v>b&&(v=b),b===0)return i[a++]=1<<24|64<<16|0,i[a++]=1<<24|64<<16|0,o.bits=1,0;for(g=1;g<b&&ie[g]===0;g++);for(v<g&&(v=g),P=1,h=1;h<=My;h++)if(P<<=1,P-=ie[h],P<0)return-1;if(P>0&&(t===R8||b!==1))return-1;for(Q[1]=0,h=1;h<My;h++)Q[h+1]=Q[h]+ie[h];for(f=0;f<n;f++)e[r+f]!==0&&(s[Q[e[r+f]]++]=f);if(t===R8?(W=H=s,G=20):t===v3?(W=Ime,H=Pme,G=257):(W=kme,H=Mme,G=0),L=0,f=0,h=g,q=a,S=v,E=0,z=-1,k=1<<v,B=k-1,t===v3&&k>k8||t===O8&&k>M8)return 1;for(;;){ne=h-E,s[f]+1<G?(oe=0,ce=s[f]):s[f]>=G?(oe=H[s[f]-G],ce=W[s[f]-G]):(oe=96,ce=0),O=1<<h-E,M=1<<S,g=M;do M-=O,i[q+(L>>E)+M]=ne<<24|oe<<16|ce|0;while(M!==0);for(O=1<<h-1;L&O;)O>>=1;if(O!==0?(L&=O-1,L+=O):L=0,f++,--ie[h]===0){if(h===b)break;h=e[r+s[f]]}if(h>v&&(L&B)!==z){for(E===0&&(E=v),q+=g,S=h-E,P=1<<S;S+E<b&&(P-=ie[S+E],!(P<=0));)S++,P<<=1;if(k+=1<<S,t===v3&&k>k8||t===O8&&k>M8)return 1;z=L&B,i[z]=v<<24|S<<16|q-a|0}}return L!==0&&(i[q+L]=h-E<<24|64<<16|0),o.bits=v,0};var T1=Rme;const Ome=0,YG=1,ZG=2,{Z_FINISH:L8,Z_BLOCK:Lme,Z_TREES:t2,Z_OK:ym,Z_STREAM_END:Nme,Z_NEED_DICT:Dme,Z_STREAM_ERROR:Ph,Z_DATA_ERROR:KG,Z_MEM_ERROR:JG,Z_BUF_ERROR:Fme,Z_DEFLATED:N8}=WG,iT=16180,D8=16181,F8=16182,B8=16183,z8=16184,j8=16185,U8=16186,V8=16187,$8=16188,q8=16189,Jw=16190,Td=16191,_3=16192,H8=16193,b3=16194,W8=16195,G8=16196,X8=16197,Y8=16198,r2=16199,n2=16200,Z8=16201,K8=16202,J8=16203,Q8=16204,eB=16205,x3=16206,tB=16207,rB=16208,is=16209,QG=16210,eX=16211,Bme=852,zme=592,jme=15,Ume=jme,nB=t=>(t>>>24&255)+(t>>>8&65280)+((t&65280)<<8)+((t&255)<<24);function Vme(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const zm=t=>{if(!t)return 1;const e=t.state;return!e||e.strm!==t||e.mode<iT||e.mode>eX?1:0},tX=t=>{if(zm(t))return Ph;const e=t.state;return t.total_in=t.total_out=e.total=0,t.msg="",e.wrap&&(t.adler=e.wrap&1),e.mode=iT,e.last=0,e.havedict=0,e.flags=-1,e.dmax=32768,e.head=null,e.hold=0,e.bits=0,e.lencode=e.lendyn=new Int32Array(Bme),e.distcode=e.distdyn=new Int32Array(zme),e.sane=1,e.back=-1,ym},rX=t=>{if(zm(t))return Ph;const e=t.state;return e.wsize=0,e.whave=0,e.wnext=0,tX(t)},nX=(t,e)=>{let r;if(zm(t))return Ph;const n=t.state;return e<0?(r=0,e=-e):(r=(e>>4)+5,e<48&&(e&=15)),e&&(e<8||e>15)?Ph:(n.window!==null&&n.wbits!==e&&(n.window=null),n.wrap=r,n.wbits=e,rX(t))},iX=(t,e)=>{if(!t)return Ph;const r=new Vme;t.state=r,r.strm=t,r.window=null,r.mode=iT;const n=nX(t,e);return n!==ym&&(t.state=null),n},$me=t=>iX(t,Ume);let iB=!0,w3,S3;const qme=t=>{if(iB){w3=new Int32Array(512),S3=new Int32Array(32);let e=0;for(;e<144;)t.lens[e++]=8;for(;e<256;)t.lens[e++]=9;for(;e<280;)t.lens[e++]=7;for(;e<288;)t.lens[e++]=8;for(T1(YG,t.lens,0,288,w3,0,t.work,{bits:9}),e=0;e<32;)t.lens[e++]=5;T1(ZG,t.lens,0,32,S3,0,t.work,{bits:5}),iB=!1}t.lencode=w3,t.lenbits=9,t.distcode=S3,t.distbits=5},aX=(t,e,r,n)=>{let i;const a=t.state;return a.window===null&&(a.wsize=1<<a.wbits,a.wnext=0,a.whave=0,a.window=new Uint8Array(a.wsize)),n>=a.wsize?(a.window.set(e.subarray(r-a.wsize,r),0),a.wnext=0,a.whave=a.wsize):(i=a.wsize-a.wnext,i>n&&(i=n),a.window.set(e.subarray(r-n,r-n+i),a.wnext),n-=i,n?(a.window.set(e.subarray(r-n,r),0),a.wnext=n,a.whave=a.wsize):(a.wnext+=i,a.wnext===a.wsize&&(a.wnext=0),a.whave<a.wsize&&(a.whave+=i))),0},Hme=(t,e)=>{let r,n,i,a,s,o,u,h,f,g,b,v,S,E,P=0,k,L,O,M,z,B,q,W;const G=new Uint8Array(4);let ie,Q;const H=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(zm(t)||!t.output||!t.input&&t.avail_in!==0)return Ph;r=t.state,r.mode===Td&&(r.mode=_3),s=t.next_out,i=t.output,u=t.avail_out,a=t.next_in,n=t.input,o=t.avail_in,h=r.hold,f=r.bits,g=o,b=u,W=ym;e:for(;;)switch(r.mode){case iT:if(r.wrap===0){r.mode=_3;break}for(;f<16;){if(o===0)break e;o--,h+=n[a++]<<f,f+=8}if(r.wrap&2&&h===35615){r.wbits===0&&(r.wbits=15),r.check=0,G[0]=h&255,G[1]=h>>>8&255,r.check=Nf(r.check,G,2,0),h=0,f=0,r.mode=D8;break}if(r.head&&(r.head.done=!1),!(r.wrap&1)||(((h&255)<<8)+(h>>8))%31){t.msg="incorrect header check",r.mode=is;break}if((h&15)!==N8){t.msg="unknown compression method",r.mode=is;break}if(h>>>=4,f-=4,q=(h&15)+8,r.wbits===0&&(r.wbits=q),q>15||q>r.wbits){t.msg="invalid window size",r.mode=is;break}r.dmax=1<<r.wbits,r.flags=0,t.adler=r.check=1,r.mode=h&512?q8:Td,h=0,f=0;break;case D8:for(;f<16;){if(o===0)break e;o--,h+=n[a++]<<f,f+=8}if(r.flags=h,(r.flags&255)!==N8){t.msg="unknown compression method",r.mode=is;break}if(r.flags&57344){t.msg="unknown header flags set",r.mode=is;break}r.head&&(r.head.text=h>>8&1),r.flags&512&&r.wrap&4&&(G[0]=h&255,G[1]=h>>>8&255,r.check=Nf(r.check,G,2,0)),h=0,f=0,r.mode=F8;case F8:for(;f<32;){if(o===0)break e;o--,h+=n[a++]<<f,f+=8}r.head&&(r.head.time=h),r.flags&512&&r.wrap&4&&(G[0]=h&255,G[1]=h>>>8&255,G[2]=h>>>16&255,G[3]=h>>>24&255,r.check=Nf(r.check,G,4,0)),h=0,f=0,r.mode=B8;case B8:for(;f<16;){if(o===0)break e;o--,h+=n[a++]<<f,f+=8}r.head&&(r.head.xflags=h&255,r.head.os=h>>8),r.flags&512&&r.wrap&4&&(G[0]=h&255,G[1]=h>>>8&255,r.check=Nf(r.check,G,2,0)),h=0,f=0,r.mode=z8;case z8:if(r.flags&1024){for(;f<16;){if(o===0)break e;o--,h+=n[a++]<<f,f+=8}r.length=h,r.head&&(r.head.extra_len=h),r.flags&512&&r.wrap&4&&(G[0]=h&255,G[1]=h>>>8&255,r.check=Nf(r.check,G,2,0)),h=0,f=0}else r.head&&(r.head.extra=null);r.mode=j8;case j8:if(r.flags&1024&&(v=r.length,v>o&&(v=o),v&&(r.head&&(q=r.head.extra_len-r.length,r.head.extra||(r.head.extra=new Uint8Array(r.head.extra_len)),r.head.extra.set(n.subarray(a,a+v),q)),r.flags&512&&r.wrap&4&&(r.check=Nf(r.check,n,v,a)),o-=v,a+=v,r.length-=v),r.length))break e;r.length=0,r.mode=U8;case U8:if(r.flags&2048){if(o===0)break e;v=0;do q=n[a+v++],r.head&&q&&r.length<65536&&(r.head.name+=String.fromCharCode(q));while(q&&v<o);if(r.flags&512&&r.wrap&4&&(r.check=Nf(r.check,n,v,a)),o-=v,a+=v,q)break e}else r.head&&(r.head.name=null);r.length=0,r.mode=V8;case V8:if(r.flags&4096){if(o===0)break e;v=0;do q=n[a+v++],r.head&&q&&r.length<65536&&(r.head.comment+=String.fromCharCode(q));while(q&&v<o);if(r.flags&512&&r.wrap&4&&(r.check=Nf(r.check,n,v,a)),o-=v,a+=v,q)break e}else r.head&&(r.head.comment=null);r.mode=$8;case $8:if(r.flags&512){for(;f<16;){if(o===0)break e;o--,h+=n[a++]<<f,f+=8}if(r.wrap&4&&h!==(r.check&65535)){t.msg="header crc mismatch",r.mode=is;break}h=0,f=0}r.head&&(r.head.hcrc=r.flags>>9&1,r.head.done=!0),t.adler=r.check=0,r.mode=Td;break;case q8:for(;f<32;){if(o===0)break e;o--,h+=n[a++]<<f,f+=8}t.adler=r.check=nB(h),h=0,f=0,r.mode=Jw;case Jw:if(r.havedict===0)return t.next_out=s,t.avail_out=u,t.next_in=a,t.avail_in=o,r.hold=h,r.bits=f,Dme;t.adler=r.check=1,r.mode=Td;case Td:if(e===Lme||e===t2)break e;case _3:if(r.last){h>>>=f&7,f-=f&7,r.mode=x3;break}for(;f<3;){if(o===0)break e;o--,h+=n[a++]<<f,f+=8}switch(r.last=h&1,h>>>=1,f-=1,h&3){case 0:r.mode=H8;break;case 1:if(qme(r),r.mode=r2,e===t2){h>>>=2,f-=2;break e}break;case 2:r.mode=G8;break;case 3:t.msg="invalid block type",r.mode=is}h>>>=2,f-=2;break;case H8:for(h>>>=f&7,f-=f&7;f<32;){if(o===0)break e;o--,h+=n[a++]<<f,f+=8}if((h&65535)!==(h>>>16^65535)){t.msg="invalid stored block lengths",r.mode=is;break}if(r.length=h&65535,h=0,f=0,r.mode=b3,e===t2)break e;case b3:r.mode=W8;case W8:if(v=r.length,v){if(v>o&&(v=o),v>u&&(v=u),v===0)break e;i.set(n.subarray(a,a+v),s),o-=v,a+=v,u-=v,s+=v,r.length-=v;break}r.mode=Td;break;case G8:for(;f<14;){if(o===0)break e;o--,h+=n[a++]<<f,f+=8}if(r.nlen=(h&31)+257,h>>>=5,f-=5,r.ndist=(h&31)+1,h>>>=5,f-=5,r.ncode=(h&15)+4,h>>>=4,f-=4,r.nlen>286||r.ndist>30){t.msg="too many length or distance symbols",r.mode=is;break}r.have=0,r.mode=X8;case X8:for(;r.have<r.ncode;){for(;f<3;){if(o===0)break e;o--,h+=n[a++]<<f,f+=8}r.lens[H[r.have++]]=h&7,h>>>=3,f-=3}for(;r.have<19;)r.lens[H[r.have++]]=0;if(r.lencode=r.lendyn,r.lenbits=7,ie={bits:r.lenbits},W=T1(Ome,r.lens,0,19,r.lencode,0,r.work,ie),r.lenbits=ie.bits,W){t.msg="invalid code lengths set",r.mode=is;break}r.have=0,r.mode=Y8;case Y8:for(;r.have<r.nlen+r.ndist;){for(;P=r.lencode[h&(1<<r.lenbits)-1],k=P>>>24,L=P>>>16&255,O=P&65535,!(k<=f);){if(o===0)break e;o--,h+=n[a++]<<f,f+=8}if(O<16)h>>>=k,f-=k,r.lens[r.have++]=O;else{if(O===16){for(Q=k+2;f<Q;){if(o===0)break e;o--,h+=n[a++]<<f,f+=8}if(h>>>=k,f-=k,r.have===0){t.msg="invalid bit length repeat",r.mode=is;break}q=r.lens[r.have-1],v=3+(h&3),h>>>=2,f-=2}else if(O===17){for(Q=k+3;f<Q;){if(o===0)break e;o--,h+=n[a++]<<f,f+=8}h>>>=k,f-=k,q=0,v=3+(h&7),h>>>=3,f-=3}else{for(Q=k+7;f<Q;){if(o===0)break e;o--,h+=n[a++]<<f,f+=8}h>>>=k,f-=k,q=0,v=11+(h&127),h>>>=7,f-=7}if(r.have+v>r.nlen+r.ndist){t.msg="invalid bit length repeat",r.mode=is;break}for(;v--;)r.lens[r.have++]=q}}if(r.mode===is)break;if(r.lens[256]===0){t.msg="invalid code -- missing end-of-block",r.mode=is;break}if(r.lenbits=9,ie={bits:r.lenbits},W=T1(YG,r.lens,0,r.nlen,r.lencode,0,r.work,ie),r.lenbits=ie.bits,W){t.msg="invalid literal/lengths set",r.mode=is;break}if(r.distbits=6,r.distcode=r.distdyn,ie={bits:r.distbits},W=T1(ZG,r.lens,r.nlen,r.ndist,r.distcode,0,r.work,ie),r.distbits=ie.bits,W){t.msg="invalid distances set",r.mode=is;break}if(r.mode=r2,e===t2)break e;case r2:r.mode=n2;case n2:if(o>=6&&u>=258){t.next_out=s,t.avail_out=u,t.next_in=a,t.avail_in=o,r.hold=h,r.bits=f,Ame(t,b),s=t.next_out,i=t.output,u=t.avail_out,a=t.next_in,n=t.input,o=t.avail_in,h=r.hold,f=r.bits,r.mode===Td&&(r.back=-1);break}for(r.back=0;P=r.lencode[h&(1<<r.lenbits)-1],k=P>>>24,L=P>>>16&255,O=P&65535,!(k<=f);){if(o===0)break e;o--,h+=n[a++]<<f,f+=8}if(L&&(L&240)===0){for(M=k,z=L,B=O;P=r.lencode[B+((h&(1<<M+z)-1)>>M)],k=P>>>24,L=P>>>16&255,O=P&65535,!(M+k<=f);){if(o===0)break e;o--,h+=n[a++]<<f,f+=8}h>>>=M,f-=M,r.back+=M}if(h>>>=k,f-=k,r.back+=k,r.length=O,L===0){r.mode=eB;break}if(L&32){r.back=-1,r.mode=Td;break}if(L&64){t.msg="invalid literal/length code",r.mode=is;break}r.extra=L&15,r.mode=Z8;case Z8:if(r.extra){for(Q=r.extra;f<Q;){if(o===0)break e;o--,h+=n[a++]<<f,f+=8}r.length+=h&(1<<r.extra)-1,h>>>=r.extra,f-=r.extra,r.back+=r.extra}r.was=r.length,r.mode=K8;case K8:for(;P=r.distcode[h&(1<<r.distbits)-1],k=P>>>24,L=P>>>16&255,O=P&65535,!(k<=f);){if(o===0)break e;o--,h+=n[a++]<<f,f+=8}if((L&240)===0){for(M=k,z=L,B=O;P=r.distcode[B+((h&(1<<M+z)-1)>>M)],k=P>>>24,L=P>>>16&255,O=P&65535,!(M+k<=f);){if(o===0)break e;o--,h+=n[a++]<<f,f+=8}h>>>=M,f-=M,r.back+=M}if(h>>>=k,f-=k,r.back+=k,L&64){t.msg="invalid distance code",r.mode=is;break}r.offset=O,r.extra=L&15,r.mode=J8;case J8:if(r.extra){for(Q=r.extra;f<Q;){if(o===0)break e;o--,h+=n[a++]<<f,f+=8}r.offset+=h&(1<<r.extra)-1,h>>>=r.extra,f-=r.extra,r.back+=r.extra}if(r.offset>r.dmax){t.msg="invalid distance too far back",r.mode=is;break}r.mode=Q8;case Q8:if(u===0)break e;if(v=b-u,r.offset>v){if(v=r.offset-v,v>r.whave&&r.sane){t.msg="invalid distance too far back",r.mode=is;break}v>r.wnext?(v-=r.wnext,S=r.wsize-v):S=r.wnext-v,v>r.length&&(v=r.length),E=r.window}else E=i,S=s-r.offset,v=r.length;v>u&&(v=u),u-=v,r.length-=v;do i[s++]=E[S++];while(--v);r.length===0&&(r.mode=n2);break;case eB:if(u===0)break e;i[s++]=r.length,u--,r.mode=n2;break;case x3:if(r.wrap){for(;f<32;){if(o===0)break e;o--,h|=n[a++]<<f,f+=8}if(b-=u,t.total_out+=b,r.total+=b,r.wrap&4&&b&&(t.adler=r.check=r.flags?Nf(r.check,i,b,s-b):UP(r.check,i,b,s-b)),b=u,r.wrap&4&&(r.flags?h:nB(h))!==r.check){t.msg="incorrect data check",r.mode=is;break}h=0,f=0}r.mode=tB;case tB:if(r.wrap&&r.flags){for(;f<32;){if(o===0)break e;o--,h+=n[a++]<<f,f+=8}if(r.wrap&4&&h!==(r.total&4294967295)){t.msg="incorrect length check",r.mode=is;break}h=0,f=0}r.mode=rB;case rB:W=Nme;break e;case is:W=KG;break e;case QG:return JG;case eX:default:return Ph}return t.next_out=s,t.avail_out=u,t.next_in=a,t.avail_in=o,r.hold=h,r.bits=f,(r.wsize||b!==t.avail_out&&r.mode<is&&(r.mode<x3||e!==L8))&&aX(t,t.output,t.next_out,b-t.avail_out),g-=t.avail_in,b-=t.avail_out,t.total_in+=g,t.total_out+=b,r.total+=b,r.wrap&4&&b&&(t.adler=r.check=r.flags?Nf(r.check,i,b,t.next_out-b):UP(r.check,i,b,t.next_out-b)),t.data_type=r.bits+(r.last?64:0)+(r.mode===Td?128:0)+(r.mode===r2||r.mode===b3?256:0),(g===0&&b===0||e===L8)&&W===ym&&(W=Fme),W},Wme=t=>{if(zm(t))return Ph;let e=t.state;return e.window&&(e.window=null),t.state=null,ym},Gme=(t,e)=>{if(zm(t))return Ph;const r=t.state;return(r.wrap&2)===0?Ph:(r.head=e,e.done=!1,ym)},Xme=(t,e)=>{const r=e.length;let n,i,a;return zm(t)||(n=t.state,n.wrap!==0&&n.mode!==Jw)?Ph:n.mode===Jw&&(i=1,i=UP(i,e,r,0),i!==n.check)?KG:(a=aX(t,e,r,r),a?(n.mode=QG,JG):(n.havedict=1,ym))};var Yme=rX,Zme=nX,Kme=tX,Jme=$me,Qme=iX,eye=Hme,tye=Wme,rye=Gme,nye=Xme,iye="pako inflate (from Nodeca project)",Pd={inflateReset:Yme,inflateReset2:Zme,inflateResetKeep:Kme,inflateInit:Jme,inflateInit2:Qme,inflate:eye,inflateEnd:tye,inflateGetHeader:rye,inflateSetDictionary:nye,inflateInfo:iye};function aye(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}var oye=aye;const oX=Object.prototype.toString,{Z_NO_FLUSH:sye,Z_FINISH:lye,Z_OK:tb,Z_STREAM_END:E3,Z_NEED_DICT:T3,Z_STREAM_ERROR:uye,Z_DATA_ERROR:aB,Z_MEM_ERROR:cye}=WG;function Xb(t){this.options=GG.assign({chunkSize:1024*64,windowBits:15,to:""},t||{});const e=this.options;e.raw&&e.windowBits>=0&&e.windowBits<16&&(e.windowBits=-e.windowBits,e.windowBits===0&&(e.windowBits=-15)),e.windowBits>=0&&e.windowBits<16&&!(t&&t.windowBits)&&(e.windowBits+=32),e.windowBits>15&&e.windowBits<48&&(e.windowBits&15)===0&&(e.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new Tme,this.strm.avail_out=0;let r=Pd.inflateInit2(this.strm,e.windowBits);if(r!==tb)throw new Error(VP[r]);if(this.header=new oye,Pd.inflateGetHeader(this.strm,this.header),e.dictionary&&(typeof e.dictionary=="string"?e.dictionary=$P.string2buf(e.dictionary):oX.call(e.dictionary)==="[object ArrayBuffer]"&&(e.dictionary=new Uint8Array(e.dictionary)),e.raw&&(r=Pd.inflateSetDictionary(this.strm,e.dictionary),r!==tb)))throw new Error(VP[r])}Xb.prototype.push=function(t,e){const r=this.strm,n=this.options.chunkSize,i=this.options.dictionary;let a,s,o;if(this.ended)return!1;for(e===~~e?s=e:s=e===!0?lye:sye,oX.call(t)==="[object ArrayBuffer]"?r.input=new Uint8Array(t):r.input=t,r.next_in=0,r.avail_in=r.input.length;;){for(r.avail_out===0&&(r.output=new Uint8Array(n),r.next_out=0,r.avail_out=n),a=Pd.inflate(r,s),a===T3&&i&&(a=Pd.inflateSetDictionary(r,i),a===tb?a=Pd.inflate(r,s):a===aB&&(a=T3));r.avail_in>0&&a===E3&&r.state.wrap>0&&t[r.next_in]!==0;)Pd.inflateReset(r),a=Pd.inflate(r,s);switch(a){case uye:case aB:case T3:case cye:return this.onEnd(a),this.ended=!0,!1}if(o=r.avail_out,r.next_out&&(r.avail_out===0||a===E3))if(this.options.to==="string"){let u=$P.utf8border(r.output,r.next_out),h=r.next_out-u,f=$P.buf2string(r.output,u);r.next_out=h,r.avail_out=n-h,h&&r.output.set(r.output.subarray(u,u+h),0),this.onData(f)}else this.onData(r.output.length===r.next_out?r.output:r.output.subarray(0,r.next_out));if(!(a===tb&&o===0)){if(a===E3)return a=Pd.inflateEnd(this.strm),this.onEnd(a),this.ended=!0,!0;if(r.avail_in===0)break}}return!0};Xb.prototype.onData=function(t){this.chunks.push(t)};Xb.prototype.onEnd=function(t){t===tb&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=GG.flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg};function hye(t,e){const r=new Xb(e);if(r.push(t),r.err)throw r.msg||VP[r.err];return r.result}var fye=Xb,dye=hye,pye={Inflate:fye,inflate:dye};const{Inflate:gye,inflate:mye}=pye;var oB=gye,yye=mye;const sX=[];for(let t=0;t<256;t++){let e=t;for(let r=0;r<8;r++)e&1?e=3988292384^e>>>1:e=e>>>1;sX[t]=e}const sB=4294967295;function vye(t,e,r){let n=t;for(let i=0;i<r;i++)n=sX[(n^e[i])&255]^n>>>8;return n}function _ye(t,e){return(vye(sB,t,e)^sB)>>>0}function lB(t,e,r){const n=t.readUint32(),i=_ye(new Uint8Array(t.buffer,t.byteOffset+t.offset-e-4,e),e);if(i!==n)throw new Error(`CRC mismatch for chunk ${r}. Expected ${n}, found ${i}`)}function lX(t,e,r){for(let n=0;n<r;n++)e[n]=t[n]}function uX(t,e,r,n){let i=0;for(;i<n;i++)e[i]=t[i];for(;i<r;i++)e[i]=t[i]+e[i-n]&255}function cX(t,e,r,n){let i=0;if(r.length===0)for(;i<n;i++)e[i]=t[i];else for(;i<n;i++)e[i]=t[i]+r[i]&255}function hX(t,e,r,n,i){let a=0;if(r.length===0){for(;a<i;a++)e[a]=t[a];for(;a<n;a++)e[a]=t[a]+(e[a-i]>>1)&255}else{for(;a<i;a++)e[a]=t[a]+(r[a]>>1)&255;for(;a<n;a++)e[a]=t[a]+(e[a-i]+r[a]>>1)&255}}function fX(t,e,r,n,i){let a=0;if(r.length===0){for(;a<i;a++)e[a]=t[a];for(;a<n;a++)e[a]=t[a]+e[a-i]&255}else{for(;a<i;a++)e[a]=t[a]+r[a]&255;for(;a<n;a++)e[a]=t[a]+bye(e[a-i],r[a],r[a-i])&255}}function bye(t,e,r){const n=t+e-r,i=Math.abs(n-t),a=Math.abs(n-e),s=Math.abs(n-r);return i<=a&&i<=s?t:a<=s?e:r}function xye(t,e,r,n,i,a){switch(t){case 0:lX(e,r,i);break;case 1:uX(e,r,i,a);break;case 2:cX(e,r,n,i);break;case 3:hX(e,r,n,i,a);break;case 4:fX(e,r,n,i,a);break;default:throw new Error(`Unsupported filter: ${t}`)}}const wye=new Uint16Array([255]),Sye=new Uint8Array(wye.buffer),Eye=Sye[0]===255;function Tye(t){const{data:e,width:r,height:n,channels:i,depth:a}=t,s=[{x:0,y:0,xStep:8,yStep:8},{x:4,y:0,xStep:8,yStep:8},{x:0,y:4,xStep:4,yStep:8},{x:2,y:0,xStep:4,yStep:4},{x:0,y:2,xStep:2,yStep:4},{x:1,y:0,xStep:2,yStep:2},{x:0,y:1,xStep:1,yStep:2}],o=Math.ceil(a/8)*i,u=new Uint8Array(n*r*o);let h=0;for(let f=0;f<7;f++){const g=s[f],b=Math.ceil((r-g.x)/g.xStep),v=Math.ceil((n-g.y)/g.yStep);if(b<=0||v<=0)continue;const S=b*o,E=new Uint8Array(S);for(let P=0;P<v;P++){const k=e[h++],L=e.subarray(h,h+S);h+=S;const O=new Uint8Array(S);xye(k,L,O,E,S,o),E.set(O);for(let M=0;M<b;M++){const z=g.x+M*g.xStep,B=g.y+P*g.yStep;if(!(z>=r||B>=n))for(let q=0;q<o;q++)u[(B*r+z)*o+q]=O[M*o+q]}}}if(a===16){const f=new Uint16Array(u.buffer);if(Eye)for(let g=0;g<f.length;g++)f[g]=Cye(f[g]);return f}else return u}function Cye(t){return(t&255)<<8|t>>8&255}const Aye=new Uint16Array([255]),Iye=new Uint8Array(Aye.buffer),Pye=Iye[0]===255,kye=new Uint8Array(0);function uB(t){const{data:e,width:r,height:n,channels:i,depth:a}=t,s=Math.ceil(a/8)*i,o=Math.ceil(a/8*i*r),u=new Uint8Array(n*o);let h=kye,f=0,g,b;for(let v=0;v<n;v++){switch(g=e.subarray(f+1,f+1+o),b=u.subarray(v*o,(v+1)*o),e[f]){case 0:lX(g,b,o);break;case 1:uX(g,b,o,s);break;case 2:cX(g,b,h,o);break;case 3:hX(g,b,h,o,s);break;case 4:fX(g,b,h,o,s);break;default:throw new Error(`Unsupported filter: ${e[f]}`)}h=b,f+=o+1}if(a===16){const v=new Uint16Array(u.buffer);if(Pye)for(let S=0;S<v.length;S++)v[S]=Mye(v[S]);return v}else return u}function Mye(t){return(t&255)<<8|t>>8&255}const hw=Uint8Array.of(137,80,78,71,13,10,26,10);function cB(t){if(!Rye(t.readBytes(hw.length)))throw new Error("wrong PNG signature")}function Rye(t){if(t.length<hw.length)return!1;for(let e=0;e<hw.length;e++)if(t[e]!==hw[e])return!1;return!0}const Oye="tEXt",Lye=0,dX=new TextDecoder("latin1");function Nye(t){if(Fye(t),t.length===0||t.length>79)throw new Error("keyword length must be between 1 and 79")}const Dye=/^[\u0000-\u00FF]*$/;function Fye(t){if(!Dye.test(t))throw new Error("invalid latin1 text")}function Bye(t,e,r){const n=pX(e);t[n]=zye(e,r-n.length-1)}function pX(t){for(t.mark();t.readByte()!==Lye;);const e=t.offset;t.reset();const r=dX.decode(t.readBytes(e-t.offset-1));return t.skip(1),Nye(r),r}function zye(t,e){return dX.decode(t.readBytes(e))}const $c={UNKNOWN:-1,GREYSCALE:0,TRUECOLOUR:2,INDEXED_COLOUR:3,GREYSCALE_ALPHA:4,TRUECOLOUR_ALPHA:6},C3={UNKNOWN:-1,DEFLATE:0},hB={UNKNOWN:-1,ADAPTIVE:0},A3={UNKNOWN:-1,NO_INTERLACE:0,ADAM7:1},i2={NONE:0,BACKGROUND:1,PREVIOUS:2},I3={SOURCE:0,OVER:1};class jye extends uO{_checkCrc;_inflator;_png;_apng;_end;_hasPalette;_palette;_hasTransparency;_transparency;_compressionMethod;_filterMethod;_interlaceMethod;_colorType;_isAnimated;_numberOfFrames;_numberOfPlays;_frames;_writingDataChunks;constructor(e,r={}){super(e);const{checkCrc:n=!1}=r;this._checkCrc=n,this._inflator=new oB,this._png={width:-1,height:-1,channels:-1,data:new Uint8Array(0),depth:1,text:{}},this._apng={width:-1,height:-1,channels:-1,depth:1,numberOfFrames:1,numberOfPlays:0,text:{},frames:[]},this._end=!1,this._hasPalette=!1,this._palette=[],this._hasTransparency=!1,this._transparency=new Uint16Array(0),this._compressionMethod=C3.UNKNOWN,this._filterMethod=hB.UNKNOWN,this._interlaceMethod=A3.UNKNOWN,this._colorType=$c.UNKNOWN,this._isAnimated=!1,this._numberOfFrames=1,this._numberOfPlays=0,this._frames=[],this._writingDataChunks=!1,this.setBigEndian()}decode(){for(cB(this);!this._end;){const e=this.readUint32(),r=this.readChars(4);this.decodeChunk(e,r)}return this.decodeImage(),this._png}decodeApng(){for(cB(this);!this._end;){const e=this.readUint32(),r=this.readChars(4);this.decodeApngChunk(e,r)}return this.decodeApngImage(),this._apng}decodeChunk(e,r){const n=this.offset;switch(r){case"IHDR":this.decodeIHDR();break;case"PLTE":this.decodePLTE(e);break;case"IDAT":this.decodeIDAT(e);break;case"IEND":this._end=!0;break;case"tRNS":this.decodetRNS(e);break;case"iCCP":this.decodeiCCP(e);break;case Oye:Bye(this._png.text,this,e);break;case"pHYs":this.decodepHYs();break;default:this.skip(e);break}if(this.offset-n!==e)throw new Error(`Length mismatch while decoding chunk ${r}`);this._checkCrc?lB(this,e+4,r):this.skip(4)}decodeApngChunk(e,r){const n=this.offset;switch(r!=="fdAT"&&r!=="IDAT"&&this._writingDataChunks&&this.pushDataToFrame(),r){case"acTL":this.decodeACTL();break;case"fcTL":this.decodeFCTL();break;case"fdAT":this.decodeFDAT(e);break;default:this.decodeChunk(e,r),this.offset=n+e;break}if(this.offset-n!==e)throw new Error(`Length mismatch while decoding chunk ${r}`);this._checkCrc?lB(this,e+4,r):this.skip(4)}decodeIHDR(){const e=this._png;e.width=this.readUint32(),e.height=this.readUint32(),e.depth=Uye(this.readUint8());const r=this.readUint8();this._colorType=r;let n;switch(r){case $c.GREYSCALE:n=1;break;case $c.TRUECOLOUR:n=3;break;case $c.INDEXED_COLOUR:n=1;break;case $c.GREYSCALE_ALPHA:n=2;break;case $c.TRUECOLOUR_ALPHA:n=4;break;case $c.UNKNOWN:default:throw new Error(`Unknown color type: ${r}`)}if(this._png.channels=n,this._compressionMethod=this.readUint8(),this._compressionMethod!==C3.DEFLATE)throw new Error(`Unsupported compression method: ${this._compressionMethod}`);this._filterMethod=this.readUint8(),this._interlaceMethod=this.readUint8()}decodeACTL(){this._numberOfFrames=this.readUint32(),this._numberOfPlays=this.readUint32(),this._isAnimated=!0}decodeFCTL(){const e={sequenceNumber:this.readUint32(),width:this.readUint32(),height:this.readUint32(),xOffset:this.readUint32(),yOffset:this.readUint32(),delayNumber:this.readUint16(),delayDenominator:this.readUint16(),disposeOp:this.readUint8(),blendOp:this.readUint8(),data:new Uint8Array(0)};this._frames.push(e)}decodePLTE(e){if(e%3!==0)throw new RangeError(`PLTE field length must be a multiple of 3. Got ${e}`);const r=e/3;this._hasPalette=!0;const n=[];this._palette=n;for(let i=0;i<r;i++)n.push([this.readUint8(),this.readUint8(),this.readUint8()])}decodeIDAT(e){this._writingDataChunks=!0;const r=e,n=this.offset+this.byteOffset;if(this._inflator.push(new Uint8Array(this.buffer,n,r)),this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);this.skip(e)}decodeFDAT(e){this._writingDataChunks=!0;let r=e,n=this.offset+this.byteOffset;if(n+=4,r-=4,this._inflator.push(new Uint8Array(this.buffer,n,r)),this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);this.skip(e)}decodetRNS(e){switch(this._colorType){case $c.GREYSCALE:case $c.TRUECOLOUR:{if(e%2!==0)throw new RangeError(`tRNS chunk length must be a multiple of 2. Got ${e}`);if(e/2>this._png.width*this._png.height)throw new Error(`tRNS chunk contains more alpha values than there are pixels (${e/2} vs ${this._png.width*this._png.height})`);this._hasTransparency=!0,this._transparency=new Uint16Array(e/2);for(let r=0;r<e/2;r++)this._transparency[r]=this.readUint16();break}case $c.INDEXED_COLOUR:{if(e>this._palette.length)throw new Error(`tRNS chunk contains more alpha values than there are palette colors (${e} vs ${this._palette.length})`);let r=0;for(;r<e;r++){const n=this.readByte();this._palette[r].push(n)}for(;r<this._palette.length;r++)this._palette[r].push(255);break}case $c.UNKNOWN:case $c.GREYSCALE_ALPHA:case $c.TRUECOLOUR_ALPHA:default:throw new Error(`tRNS chunk is not supported for color type ${this._colorType}`)}}decodeiCCP(e){const r=pX(this),n=this.readUint8();if(n!==C3.DEFLATE)throw new Error(`Unsupported iCCP compression method: ${n}`);const i=this.readBytes(e-r.length-2);this._png.iccEmbeddedProfile={name:r,profile:yye(i)}}decodepHYs(){const e=this.readUint32(),r=this.readUint32(),n=this.readByte();this._png.resolution={x:e,y:r,unit:n}}decodeApngImage(){this._apng.width=this._png.width,this._apng.height=this._png.height,this._apng.channels=this._png.channels,this._apng.depth=this._png.depth,this._apng.numberOfFrames=this._numberOfFrames,this._apng.numberOfPlays=this._numberOfPlays,this._apng.text=this._png.text,this._apng.resolution=this._png.resolution;for(let e=0;e<this._numberOfFrames;e++){const r={sequenceNumber:this._frames[e].sequenceNumber,delayNumber:this._frames[e].delayNumber,delayDenominator:this._frames[e].delayDenominator,data:this._apng.depth===8?new Uint8Array(this._apng.width*this._apng.height*this._apng.channels):new Uint16Array(this._apng.width*this._apng.height*this._apng.channels)},n=this._frames.at(e);if(n){if(n.data=uB({data:n.data,width:n.width,height:n.height,channels:this._apng.channels,depth:this._apng.depth}),this._hasPalette&&(this._apng.palette=this._palette),this._hasTransparency&&(this._apng.transparency=this._transparency),e===0||n.xOffset===0&&n.yOffset===0&&n.width===this._png.width&&n.height===this._png.height)r.data=n.data;else{const i=this._apng.frames.at(e-1);this.disposeFrame(n,i,r),this.addFrameDataToCanvas(r,n)}this._apng.frames.push(r)}}return this._apng}disposeFrame(e,r,n){switch(e.disposeOp){case i2.NONE:break;case i2.BACKGROUND:for(let i=0;i<this._png.height;i++)for(let a=0;a<this._png.width;a++){const s=(i*e.width+a)*this._png.channels;for(let o=0;o<this._png.channels;o++)n.data[s+o]=0}break;case i2.PREVIOUS:n.data.set(r.data);break;default:throw new Error("Unknown disposeOp")}}addFrameDataToCanvas(e,r){const n=1<<this._png.depth,i=(a,s)=>{const o=((a+r.yOffset)*this._png.width+r.xOffset+s)*this._png.channels,u=(a*r.width+s)*this._png.channels;return{index:o,frameIndex:u}};switch(r.blendOp){case I3.SOURCE:for(let a=0;a<r.height;a++)for(let s=0;s<r.width;s++){const{index:o,frameIndex:u}=i(a,s);for(let h=0;h<this._png.channels;h++)e.data[o+h]=r.data[u+h]}break;case I3.OVER:for(let a=0;a<r.height;a++)for(let s=0;s<r.width;s++){const{index:o,frameIndex:u}=i(a,s);for(let h=0;h<this._png.channels;h++){const f=r.data[u+this._png.channels-1]/n,g=h%(this._png.channels-1)===0?1:r.data[u+h],b=Math.floor(f*g+(1-f)*e.data[o+h]);e.data[o+h]+=b}}break;default:throw new Error("Unknown blendOp")}}decodeImage(){if(this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);const e=this._isAnimated?(this._frames?.at(0)).data:this._inflator.result;if(this._filterMethod!==hB.ADAPTIVE)throw new Error(`Filter method ${this._filterMethod} not supported`);if(this._interlaceMethod===A3.NO_INTERLACE)this._png.data=uB({data:e,width:this._png.width,height:this._png.height,channels:this._png.channels,depth:this._png.depth});else if(this._interlaceMethod===A3.ADAM7)this._png.data=Tye({data:e,width:this._png.width,height:this._png.height,channels:this._png.channels,depth:this._png.depth});else throw new Error(`Interlace method ${this._interlaceMethod} not supported`);this._hasPalette&&(this._png.palette=this._palette),this._hasTransparency&&(this._png.transparency=this._transparency)}pushDataToFrame(){const e=this._inflator.result,r=this._frames.at(-1);r?r.data=e:this._frames.push({sequenceNumber:0,width:this._png.width,height:this._png.height,xOffset:0,yOffset:0,delayNumber:0,delayDenominator:0,disposeOp:i2.NONE,blendOp:I3.SOURCE,data:e}),this._inflator=new oB,this._writingDataChunks=!1}}function Uye(t){if(t!==1&&t!==2&&t!==4&&t!==8&&t!==16)throw new Error(`invalid bit depth: ${t}`);return t}var fB;(function(t){t[t.UNKNOWN=0]="UNKNOWN",t[t.METRE=1]="METRE"})(fB||(fB={}));function Vye(t,e){return new jye(t,e).decode()}var Ri=(function(){return typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:this})();function P3(){Ri.console&&typeof Ri.console.log=="function"&&Ri.console.log.apply(Ri.console,arguments)}var Eo={log:P3,warn:function(t){Ri.console&&(typeof Ri.console.warn=="function"?Ri.console.warn.apply(Ri.console,arguments):P3.call(null,arguments))},error:function(t){Ri.console&&(typeof Ri.console.error=="function"?Ri.console.error.apply(Ri.console,arguments):P3(t))}};function k3(t,e,r){var n=new XMLHttpRequest;n.open("GET",t),n.responseType="blob",n.onload=function(){jg(n.response,e,r)},n.onerror=function(){Eo.error("could not download file")},n.send()}function dB(t){var e=new XMLHttpRequest;e.open("HEAD",t,!1);try{e.send()}catch{}return e.status>=200&&e.status<=299}function a2(t){try{t.dispatchEvent(new MouseEvent("click"))}catch{var e=document.createEvent("MouseEvents");e.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),t.dispatchEvent(e)}}var jg=Ri.saveAs||((typeof window>"u"?"undefined":ao(window))!=="object"||window!==Ri?function(){}:typeof HTMLAnchorElement<"u"&&"download"in HTMLAnchorElement.prototype?function(t,e,r){var n=Ri.URL||Ri.webkitURL,i=document.createElement("a");e=e||t.name||"download",i.download=e,i.rel="noopener",typeof t=="string"?(i.href=t,i.origin!==location.origin?dB(i.href)?k3(t,e,r):a2(i,i.target="_blank"):a2(i)):(i.href=n.createObjectURL(t),setTimeout(function(){n.revokeObjectURL(i.href)},4e4),setTimeout(function(){a2(i)},0))}:"msSaveOrOpenBlob"in navigator?function(t,e,r){if(e=e||t.name||"download",typeof t=="string")if(dB(t))k3(t,e,r);else{var n=document.createElement("a");n.href=t,n.target="_blank",setTimeout(function(){a2(n)})}else navigator.msSaveOrOpenBlob((function(i,a){return a===void 0?a={autoBom:!1}:ao(a)!=="object"&&(Eo.warn("Deprecated: Expected third argument to be a object"),a={autoBom:!a}),a.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(i.type)?new Blob(["\uFEFF",i],{type:i.type}):i})(t,r),e)}:function(t,e,r,n){if((n=n||open("","_blank"))&&(n.document.title=n.document.body.innerText="downloading..."),typeof t=="string")return k3(t,e,r);var i=t.type==="application/octet-stream",a=/constructor/i.test(Ri.HTMLElement)||Ri.safari,s=/CriOS\/[\d]+/.test(navigator.userAgent);if((s||i&&a)&&(typeof FileReader>"u"?"undefined":ao(FileReader))==="object"){var o=new FileReader;o.onloadend=function(){var f=o.result;f=s?f:f.replace(/^data:[^;]*;/,"data:attachment/file;"),n?n.location.href=f:location=f,n=null},o.readAsDataURL(t)}else{var u=Ri.URL||Ri.webkitURL,h=u.createObjectURL(t);n?n.location=h:location.href=h,n=null,setTimeout(function(){u.revokeObjectURL(h)},4e4)}});/**
 * A class to parse color values
 * @author Stoyan Stefanov <sstoo@gmail.com>
 * {@link   http://www.phpied.com/rgb-color-parser-in-javascript/}
 * @license Use it if you like it
 */function gX(t){var e;t=t||"",this.ok=!1,t.charAt(0)=="#"&&(t=t.substr(1,6)),t={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"}[t=(t=t.replace(/ /g,"")).toLowerCase()]||t;for(var r=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(o){return[parseInt(o[1]),parseInt(o[2]),parseInt(o[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(o){return[parseInt(o[1],16),parseInt(o[2],16),parseInt(o[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(o){return[parseInt(o[1]+o[1],16),parseInt(o[2]+o[2],16),parseInt(o[3]+o[3],16)]}}],n=0;n<r.length;n++){var i=r[n].re,a=r[n].process,s=i.exec(t);s&&(e=a(s),this.r=e[0],this.g=e[1],this.b=e[2],this.ok=!0)}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toHex=function(){var o=this.r.toString(16),u=this.g.toString(16),h=this.b.toString(16);return o.length==1&&(o="0"+o),u.length==1&&(u="0"+u),h.length==1&&(h="0"+h),"#"+o+u+h}}var fw=Ri.atob.bind(Ri),pB=Ri.btoa.bind(Ri);/**
 * @license
 * Joseph Myers does not specify a particular license for his work.
 *
 * Author: Joseph Myers
 * Accessed from: http://www.myersdaily.org/joseph/javascript/md5.js
 *
 * Modified by: Owen Leong
 */function M3(t,e){var r=t[0],n=t[1],i=t[2],a=t[3];r=ku(r,n,i,a,e[0],7,-680876936),a=ku(a,r,n,i,e[1],12,-389564586),i=ku(i,a,r,n,e[2],17,606105819),n=ku(n,i,a,r,e[3],22,-1044525330),r=ku(r,n,i,a,e[4],7,-176418897),a=ku(a,r,n,i,e[5],12,1200080426),i=ku(i,a,r,n,e[6],17,-1473231341),n=ku(n,i,a,r,e[7],22,-45705983),r=ku(r,n,i,a,e[8],7,1770035416),a=ku(a,r,n,i,e[9],12,-1958414417),i=ku(i,a,r,n,e[10],17,-42063),n=ku(n,i,a,r,e[11],22,-1990404162),r=ku(r,n,i,a,e[12],7,1804603682),a=ku(a,r,n,i,e[13],12,-40341101),i=ku(i,a,r,n,e[14],17,-1502002290),r=Mu(r,n=ku(n,i,a,r,e[15],22,1236535329),i,a,e[1],5,-165796510),a=Mu(a,r,n,i,e[6],9,-1069501632),i=Mu(i,a,r,n,e[11],14,643717713),n=Mu(n,i,a,r,e[0],20,-373897302),r=Mu(r,n,i,a,e[5],5,-701558691),a=Mu(a,r,n,i,e[10],9,38016083),i=Mu(i,a,r,n,e[15],14,-660478335),n=Mu(n,i,a,r,e[4],20,-405537848),r=Mu(r,n,i,a,e[9],5,568446438),a=Mu(a,r,n,i,e[14],9,-1019803690),i=Mu(i,a,r,n,e[3],14,-187363961),n=Mu(n,i,a,r,e[8],20,1163531501),r=Mu(r,n,i,a,e[13],5,-1444681467),a=Mu(a,r,n,i,e[2],9,-51403784),i=Mu(i,a,r,n,e[7],14,1735328473),r=Ru(r,n=Mu(n,i,a,r,e[12],20,-1926607734),i,a,e[5],4,-378558),a=Ru(a,r,n,i,e[8],11,-2022574463),i=Ru(i,a,r,n,e[11],16,1839030562),n=Ru(n,i,a,r,e[14],23,-35309556),r=Ru(r,n,i,a,e[1],4,-1530992060),a=Ru(a,r,n,i,e[4],11,1272893353),i=Ru(i,a,r,n,e[7],16,-155497632),n=Ru(n,i,a,r,e[10],23,-1094730640),r=Ru(r,n,i,a,e[13],4,681279174),a=Ru(a,r,n,i,e[0],11,-358537222),i=Ru(i,a,r,n,e[3],16,-722521979),n=Ru(n,i,a,r,e[6],23,76029189),r=Ru(r,n,i,a,e[9],4,-640364487),a=Ru(a,r,n,i,e[12],11,-421815835),i=Ru(i,a,r,n,e[15],16,530742520),r=Ou(r,n=Ru(n,i,a,r,e[2],23,-995338651),i,a,e[0],6,-198630844),a=Ou(a,r,n,i,e[7],10,1126891415),i=Ou(i,a,r,n,e[14],15,-1416354905),n=Ou(n,i,a,r,e[5],21,-57434055),r=Ou(r,n,i,a,e[12],6,1700485571),a=Ou(a,r,n,i,e[3],10,-1894986606),i=Ou(i,a,r,n,e[10],15,-1051523),n=Ou(n,i,a,r,e[1],21,-2054922799),r=Ou(r,n,i,a,e[8],6,1873313359),a=Ou(a,r,n,i,e[15],10,-30611744),i=Ou(i,a,r,n,e[6],15,-1560198380),n=Ou(n,i,a,r,e[13],21,1309151649),r=Ou(r,n,i,a,e[4],6,-145523070),a=Ou(a,r,n,i,e[11],10,-1120210379),i=Ou(i,a,r,n,e[2],15,718787259),n=Ou(n,i,a,r,e[9],21,-343485551),t[0]=Dp(r,t[0]),t[1]=Dp(n,t[1]),t[2]=Dp(i,t[2]),t[3]=Dp(a,t[3])}function aT(t,e,r,n,i,a){return e=Dp(Dp(e,t),Dp(n,a)),Dp(e<<i|e>>>32-i,r)}function ku(t,e,r,n,i,a,s){return aT(e&r|~e&n,t,e,i,a,s)}function Mu(t,e,r,n,i,a,s){return aT(e&n|r&~n,t,e,i,a,s)}function Ru(t,e,r,n,i,a,s){return aT(e^r^n,t,e,i,a,s)}function Ou(t,e,r,n,i,a,s){return aT(r^(e|~n),t,e,i,a,s)}function mX(t){var e,r=t.length,n=[1732584193,-271733879,-1732584194,271733878];for(e=64;e<=t.length;e+=64)M3(n,$ye(t.substring(e-64,e)));t=t.substring(e-64);var i=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(e=0;e<t.length;e++)i[e>>2]|=t.charCodeAt(e)<<(e%4<<3);if(i[e>>2]|=128<<(e%4<<3),e>55)for(M3(n,i),e=0;e<16;e++)i[e]=0;return i[14]=8*r,M3(n,i),n}function $ye(t){var e,r=[];for(e=0;e<64;e+=4)r[e>>2]=t.charCodeAt(e)+(t.charCodeAt(e+1)<<8)+(t.charCodeAt(e+2)<<16)+(t.charCodeAt(e+3)<<24);return r}var gB="0123456789abcdef".split("");function qye(t){for(var e="",r=0;r<4;r++)e+=gB[t>>8*r+4&15]+gB[t>>8*r&15];return e}function Hye(t){return String.fromCharCode(255&t,(65280&t)>>8,(16711680&t)>>16,(4278190080&t)>>24)}function qP(t){return mX(t).map(Hye).join("")}var Wye=(function(t){for(var e=0;e<t.length;e++)t[e]=qye(t[e]);return t.join("")})(mX("hello"))!="5d41402abc4b2a76b9719d911017c592";function Dp(t,e){if(Wye){var r=(65535&t)+(65535&e);return(t>>16)+(e>>16)+(r>>16)<<16|65535&r}return t+e&4294967295}/**
 * @license
 * FPDF is released under a permissive license: there is no usage restriction.
 * You may embed it freely in your application (commercial or not), with or
 * without modifications.
 *
 * Reference: http://www.fpdf.org/en/script/script37.php
 */function HP(t,e){var r,n,i,a;if(t!==r){for(var s=(i=t,a=1+(256/t.length|0),new Array(a+1).join(i)),o=[],u=0;u<256;u++)o[u]=u;var h=0;for(u=0;u<256;u++){var f=o[u];h=(h+f+s.charCodeAt(u))%256,o[u]=o[h],o[h]=f}r=t,n=o}else o=n;var g=e.length,b=0,v=0,S="";for(u=0;u<g;u++)v=(v+(f=o[b=(b+1)%256]))%256,o[b]=o[v],o[v]=f,s=o[(o[b]+o[v])%256],S+=String.fromCharCode(e.charCodeAt(u)^s);return S}/**
 * @license
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 * Author: Owen Leong (@owenl131)
 * Date: 15 Oct 2020
 * References:
 * https://www.cs.cmu.edu/~dst/Adobe/Gallery/anon21jul01-pdf-encryption.txt
 * https://github.com/foliojs/pdfkit/blob/master/lib/security.js
 * http://www.fpdf.org/en/script/script37.php
 */var mB={print:4,modify:8,copy:16,"annot-forms":32};function Qy(t,e,r,n){this.v=1,this.r=2;var i=192;t.forEach(function(o){if(mB.perm!==void 0)throw new Error("Invalid permission: "+o);i+=mB[o]}),this.padding="(N^NuAd\0NV\b..\0h>/\fdSiz";var a=(e+this.padding).substr(0,32),s=(r+this.padding).substr(0,32);this.O=this.processOwnerPassword(a,s),this.P=-(1+(255^i)),this.encryptionKey=qP(a+this.O+this.lsbFirstWord(this.P)+this.hexToBytes(n)).substr(0,5),this.U=HP(this.encryptionKey,this.padding)}function ev(t){if(/[^\u0000-\u00ff]/.test(t))throw new Error("Invalid PDF Name Object: "+t+", Only accept ASCII characters.");for(var e="",r=t.length,n=0;n<r;n++){var i=t.charCodeAt(n);e+=i<33||i===35||i===37||i===40||i===41||i===47||i===60||i===62||i===91||i===93||i===123||i===125||i>126?"#"+("0"+i.toString(16)).slice(-2):t[n]}return e}function yB(t){if(ao(t)!=="object")throw new Error("Invalid Context passed to initialize PubSub (jsPDF-module)");var e={};this.subscribe=function(r,n,i){if(i=i||!1,typeof r!="string"||typeof n!="function"||typeof i!="boolean")throw new Error("Invalid arguments passed to PubSub.subscribe (jsPDF-module)");e.hasOwnProperty(r)||(e[r]={});var a=Math.random().toString(35);return e[r][a]=[n,!!i],a},this.unsubscribe=function(r){for(var n in e)if(e[n][r])return delete e[n][r],Object.keys(e[n]).length===0&&delete e[n],!0;return!1},this.publish=function(r){if(e.hasOwnProperty(r)){var n=Array.prototype.slice.call(arguments,1),i=[];for(var a in e[r]){var s=e[r][a];try{s[0].apply(t,n)}catch(o){Ri.console&&Eo.error("jsPDF PubSub Error",o.message,o)}s[1]&&i.push(a)}i.length&&i.forEach(this.unsubscribe)}},this.getTopics=function(){return e}}function Qw(t){if(!(this instanceof Qw))return new Qw(t);var e="opacity,stroke-opacity".split(",");for(var r in t)t.hasOwnProperty(r)&&e.indexOf(r)>=0&&(this[r]=t[r]);this.id="",this.objectNumber=-1}function yX(t,e){this.gState=t,this.matrix=e,this.id="",this.objectNumber=-1}function $g(t,e,r,n,i){if(!(this instanceof $g))return new $g(t,e,r,n,i);this.type=t==="axial"?2:3,this.coords=e,this.colors=r,yX.call(this,n,i)}function wv(t,e,r,n,i){if(!(this instanceof wv))return new wv(t,e,r,n,i);this.boundingBox=t,this.xStep=e,this.yStep=r,this.stream="",this.cloneIndex=0,yX.call(this,n,i)}function li(t){var e,r=typeof arguments[0]=="string"?arguments[0]:"p",n=arguments[1],i=arguments[2],a=arguments[3],s=[],o=1,u=16,h="S",f=null;ao(t=t||{})==="object"&&(r=t.orientation,n=t.unit||n,i=t.format||i,a=t.compress||t.compressPdf||a,(f=t.encryption||null)!==null&&(f.userPassword=f.userPassword||"",f.ownerPassword=f.ownerPassword||"",f.userPermissions=f.userPermissions||[]),o=typeof t.userUnit=="number"?Math.abs(t.userUnit):1,t.precision!==void 0&&(e=t.precision),t.floatPrecision!==void 0&&(u=t.floatPrecision),h=t.defaultPathOperation||"S"),s=t.filters||(a===!0?["FlateEncode"]:s),n=n||"mm",r=(""+(r||"P")).toLowerCase();var g=t.putOnlyUsedFonts||!1,b={},v={internal:{},__private__:{}};v.__private__.PubSub=yB;var S="1.3",E=v.__private__.getPdfVersion=function(){return S};v.__private__.setPdfVersion=function(le){S=le};var P={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};v.__private__.getPageFormats=function(){return P};var k=v.__private__.getPageFormat=function(le){return P[le]};i=i||"a4";var L="compat",O="advanced",M=L;function z(){this.saveGraphicsState(),je(new un(_e,0,0,-_e,0,na()*_e).toString()+" cm"),this.setFontSize(this.getFontSize()/_e),h="n",M=O}function B(){this.restoreGraphicsState(),h="S",M=L}var q=v.__private__.combineFontStyleAndFontWeight=function(le,Ve){if(le=="bold"&&Ve=="normal"||le=="bold"&&Ve==400||le=="normal"&&Ve=="italic"||le=="bold"&&Ve=="italic")throw new Error("Invalid Combination of fontweight and fontstyle");return Ve&&(le=Ve==400||Ve==="normal"?le==="italic"?"italic":"normal":Ve!=700&&Ve!=="bold"||le!=="normal"?(Ve==700?"bold":Ve)+""+le:"bold"),le};v.advancedAPI=function(le){var Ve=M===L;return Ve&&z.call(this),typeof le!="function"||(le(this),Ve&&B.call(this)),this},v.compatAPI=function(le){var Ve=M===O;return Ve&&B.call(this),typeof le!="function"||(le(this),Ve&&z.call(this)),this},v.isAdvancedAPI=function(){return M===O};var W,G=function(le){if(M!==O)throw new Error(le+" is only available in 'advanced' API mode. You need to call advancedAPI() first.")},ie=v.roundToPrecision=v.__private__.roundToPrecision=function(le,Ve){var dt=e||Ve;if(isNaN(le)||isNaN(dt))throw new Error("Invalid argument passed to jsPDF.roundToPrecision");return le.toFixed(dt).replace(/0+$/,"")};W=v.hpf=v.__private__.hpf=typeof u=="number"?function(le){if(isNaN(le))throw new Error("Invalid argument passed to jsPDF.hpf");return ie(le,u)}:u==="smart"?function(le){if(isNaN(le))throw new Error("Invalid argument passed to jsPDF.hpf");return ie(le,le>-1&&le<1?16:5)}:function(le){if(isNaN(le))throw new Error("Invalid argument passed to jsPDF.hpf");return ie(le,16)};var Q=v.f2=v.__private__.f2=function(le){if(isNaN(le))throw new Error("Invalid argument passed to jsPDF.f2");return ie(le,2)},H=v.__private__.f3=function(le){if(isNaN(le))throw new Error("Invalid argument passed to jsPDF.f3");return ie(le,3)},ne=v.scale=v.__private__.scale=function(le){if(isNaN(le))throw new Error("Invalid argument passed to jsPDF.scale");return M===L?le*_e:M===O?le:void 0},oe=function(le){return ne((function(Ve){return M===L?na()-Ve:M===O?Ve:void 0})(le))};v.__private__.setPrecision=v.setPrecision=function(le){typeof parseInt(le,10)=="number"&&(e=parseInt(le,10))};var ce,fe="00000000000000000000000000000000",Me=v.__private__.getFileId=function(){return fe},me=v.__private__.setFileId=function(le){return fe=le!==void 0&&/^[a-fA-F0-9]{32}$/.test(le)?le.toUpperCase():fe.split("").map(function(){return"ABCDEF0123456789".charAt(Math.floor(16*Math.random()))}).join(""),f!==null&&(ka=new Qy(f.userPermissions,f.userPassword,f.ownerPassword,fe)),fe};v.setFileId=function(le){return me(le),this},v.getFileId=function(){return Me()};var we=v.__private__.convertDateToPDFDate=function(le){var Ve=le.getTimezoneOffset(),dt=Ve<0?"+":"-",Dt=Math.floor(Math.abs(Ve/60)),nr=Math.abs(Ve%60),Lr=[dt,xe(Dt),"'",xe(nr),"'"].join("");return["D:",le.getFullYear(),xe(le.getMonth()+1),xe(le.getDate()),xe(le.getHours()),xe(le.getMinutes()),xe(le.getSeconds()),Lr].join("")},Te=v.__private__.convertPDFDateToDate=function(le){var Ve=parseInt(le.substr(2,4),10),dt=parseInt(le.substr(6,2),10)-1,Dt=parseInt(le.substr(8,2),10),nr=parseInt(le.substr(10,2),10),Lr=parseInt(le.substr(12,2),10),Zr=parseInt(le.substr(14,2),10);return new Date(Ve,dt,Dt,nr,Lr,Zr,0)},ke=v.__private__.setCreationDate=function(le){var Ve;if(le===void 0&&(le=new Date),le instanceof Date)Ve=we(le);else{if(!/^D:(20[0-2][0-9]|203[0-7]|19[7-9][0-9])(0[0-9]|1[0-2])([0-2][0-9]|3[0-1])(0[0-9]|1[0-9]|2[0-3])(0[0-9]|[1-5][0-9])(0[0-9]|[1-5][0-9])(\+0[0-9]|\+1[0-4]|-0[0-9]|-1[0-1])'(0[0-9]|[1-5][0-9])'?$/.test(le))throw new Error("Invalid argument passed to jsPDF.setCreationDate");Ve=le}return ce=Ve},he=v.__private__.getCreationDate=function(le){var Ve=ce;return le==="jsDate"&&(Ve=Te(ce)),Ve};v.setCreationDate=function(le){return ke(le),this},v.getCreationDate=function(le){return he(le)};var Ee,xe=v.__private__.padd2=function(le){return("0"+parseInt(le)).slice(-2)},Ne=v.__private__.padd2Hex=function(le){return("00"+(le=le.toString())).substr(le.length)},Oe=0,$e=[],De=[],it=0,Ye=[],rt=[],Ie=!1,Mt=De;v.__private__.setCustomOutputDestination=function(le){Ie=!0,Mt=le};var at=function(le){Ie||(Mt=le)};v.__private__.resetCustomOutputDestination=function(){Ie=!1,Mt=De};var je=v.__private__.out=function(le){return le=le.toString(),it+=le.length+1,Mt.push(le),Mt},Xt=v.__private__.write=function(le){return je(arguments.length===1?le.toString():Array.prototype.join.call(arguments," "))},Yt=v.__private__.getArrayBuffer=function(le){for(var Ve=le.length,dt=new ArrayBuffer(Ve),Dt=new Uint8Array(dt);Ve--;)Dt[Ve]=le.charCodeAt(Ve);return dt},pr=[["Helvetica","helvetica","normal","WinAnsiEncoding"],["Helvetica-Bold","helvetica","bold","WinAnsiEncoding"],["Helvetica-Oblique","helvetica","italic","WinAnsiEncoding"],["Helvetica-BoldOblique","helvetica","bolditalic","WinAnsiEncoding"],["Courier","courier","normal","WinAnsiEncoding"],["Courier-Bold","courier","bold","WinAnsiEncoding"],["Courier-Oblique","courier","italic","WinAnsiEncoding"],["Courier-BoldOblique","courier","bolditalic","WinAnsiEncoding"],["Times-Roman","times","normal","WinAnsiEncoding"],["Times-Bold","times","bold","WinAnsiEncoding"],["Times-Italic","times","italic","WinAnsiEncoding"],["Times-BoldItalic","times","bolditalic","WinAnsiEncoding"],["ZapfDingbats","zapfdingbats","normal",null],["Symbol","symbol","normal",null]];v.__private__.getStandardFonts=function(){return pr};var vt=t.fontSize||16;v.__private__.setFontSize=v.setFontSize=function(le){return vt=M===O?le/_e:le,this};var yr,_r=v.__private__.getFontSize=v.getFontSize=function(){return M===L?vt:vt*_e},cr=t.R2L||!1;v.__private__.setR2L=v.setR2L=function(le){return cr=le,this},v.__private__.getR2L=v.getR2L=function(){return cr};var Er,wr=v.__private__.setZoomMode=function(le){if(/^(?:\d+\.\d*|\d*\.\d+|\d+)%$/.test(le))yr=le;else if(isNaN(le)){if([void 0,null,"fullwidth","fullheight","fullpage","original"].indexOf(le)===-1)throw new Error('zoom must be Integer (e.g. 2), a percentage Value (e.g. 300%) or fullwidth, fullheight, fullpage, original. "'+le+'" is not recognized.');yr=le}else yr=parseInt(le,10)};v.__private__.getZoomMode=function(){return yr};var er,lr=v.__private__.setPageMode=function(le){if([void 0,null,"UseNone","UseOutlines","UseThumbs","FullScreen"].indexOf(le)==-1)throw new Error('Page mode must be one of UseNone, UseOutlines, UseThumbs, or FullScreen. "'+le+'" is not recognized.');Er=le};v.__private__.getPageMode=function(){return Er};var Ar=v.__private__.setLayoutMode=function(le){if([void 0,null,"continuous","single","twoleft","tworight","two"].indexOf(le)==-1)throw new Error('Layout mode must be one of continuous, single, twoleft, tworight. "'+le+'" is not recognized.');er=le};v.__private__.getLayoutMode=function(){return er},v.__private__.setDisplayMode=v.setDisplayMode=function(le,Ve,dt){return wr(le),Ar(Ve),lr(dt),this};var ir={title:"",subject:"",author:"",keywords:"",creator:""};v.__private__.getDocumentProperty=function(le){if(Object.keys(ir).indexOf(le)===-1)throw new Error("Invalid argument passed to jsPDF.getDocumentProperty");return ir[le]},v.__private__.getDocumentProperties=function(){return ir},v.__private__.setDocumentProperties=v.setProperties=v.setDocumentProperties=function(le){for(var Ve in ir)ir.hasOwnProperty(Ve)&&le[Ve]&&(ir[Ve]=le[Ve]);return this},v.__private__.setDocumentProperty=function(le,Ve){if(Object.keys(ir).indexOf(le)===-1)throw new Error("Invalid arguments passed to jsPDF.setDocumentProperty");return ir[le]=Ve};var nt,_e,be,qe,Qe,ot={},et={},Lt=[],_t={},jt={},Jt={},Kt={},Rr=null,bt=0,Tr=[],Ur=new yB(v),Gr=t.hotfixes||[],Jr={},ar={},ti=[],un=function le(Ve,dt,Dt,nr,Lr,Zr){if(!(this instanceof le))return new le(Ve,dt,Dt,nr,Lr,Zr);isNaN(Ve)&&(Ve=1),isNaN(dt)&&(dt=0),isNaN(Dt)&&(Dt=0),isNaN(nr)&&(nr=1),isNaN(Lr)&&(Lr=0),isNaN(Zr)&&(Zr=0),this._matrix=[Ve,dt,Dt,nr,Lr,Zr]};Object.defineProperty(un.prototype,"sx",{get:function(){return this._matrix[0]},set:function(le){this._matrix[0]=le}}),Object.defineProperty(un.prototype,"shy",{get:function(){return this._matrix[1]},set:function(le){this._matrix[1]=le}}),Object.defineProperty(un.prototype,"shx",{get:function(){return this._matrix[2]},set:function(le){this._matrix[2]=le}}),Object.defineProperty(un.prototype,"sy",{get:function(){return this._matrix[3]},set:function(le){this._matrix[3]=le}}),Object.defineProperty(un.prototype,"tx",{get:function(){return this._matrix[4]},set:function(le){this._matrix[4]=le}}),Object.defineProperty(un.prototype,"ty",{get:function(){return this._matrix[5]},set:function(le){this._matrix[5]=le}}),Object.defineProperty(un.prototype,"a",{get:function(){return this._matrix[0]},set:function(le){this._matrix[0]=le}}),Object.defineProperty(un.prototype,"b",{get:function(){return this._matrix[1]},set:function(le){this._matrix[1]=le}}),Object.defineProperty(un.prototype,"c",{get:function(){return this._matrix[2]},set:function(le){this._matrix[2]=le}}),Object.defineProperty(un.prototype,"d",{get:function(){return this._matrix[3]},set:function(le){this._matrix[3]=le}}),Object.defineProperty(un.prototype,"e",{get:function(){return this._matrix[4]},set:function(le){this._matrix[4]=le}}),Object.defineProperty(un.prototype,"f",{get:function(){return this._matrix[5]},set:function(le){this._matrix[5]=le}}),Object.defineProperty(un.prototype,"rotation",{get:function(){return Math.atan2(this.shx,this.sx)}}),Object.defineProperty(un.prototype,"scaleX",{get:function(){return this.decompose().scale.sx}}),Object.defineProperty(un.prototype,"scaleY",{get:function(){return this.decompose().scale.sy}}),Object.defineProperty(un.prototype,"isIdentity",{get:function(){return this.sx===1&&this.shy===0&&this.shx===0&&this.sy===1&&this.tx===0&&this.ty===0}}),un.prototype.join=function(le){return[this.sx,this.shy,this.shx,this.sy,this.tx,this.ty].map(W).join(le)},un.prototype.multiply=function(le){var Ve=le.sx*this.sx+le.shy*this.shx,dt=le.sx*this.shy+le.shy*this.sy,Dt=le.shx*this.sx+le.sy*this.shx,nr=le.shx*this.shy+le.sy*this.sy,Lr=le.tx*this.sx+le.ty*this.shx+this.tx,Zr=le.tx*this.shy+le.ty*this.sy+this.ty;return new un(Ve,dt,Dt,nr,Lr,Zr)},un.prototype.decompose=function(){var le=this.sx,Ve=this.shy,dt=this.shx,Dt=this.sy,nr=this.tx,Lr=this.ty,Zr=Math.sqrt(le*le+Ve*Ve),kn=(le/=Zr)*dt+(Ve/=Zr)*Dt;dt-=le*kn,Dt-=Ve*kn;var wn=Math.sqrt(dt*dt+Dt*Dt);return kn/=wn,le*(Dt/=wn)<Ve*(dt/=wn)&&(le=-le,Ve=-Ve,kn=-kn,Zr=-Zr),{scale:new un(Zr,0,0,wn,0,0),translate:new un(1,0,0,1,nr,Lr),rotate:new un(le,Ve,-Ve,le,0,0),skew:new un(1,0,kn,1,0,0)}},un.prototype.toString=function(le){return this.join(" ")},un.prototype.inversed=function(){var le=this.sx,Ve=this.shy,dt=this.shx,Dt=this.sy,nr=this.tx,Lr=this.ty,Zr=1/(le*Dt-Ve*dt),kn=Dt*Zr,wn=-Ve*Zr,ni=-dt*Zr,oi=le*Zr;return new un(kn,wn,ni,oi,-kn*nr-ni*Lr,-wn*nr-oi*Lr)},un.prototype.applyToPoint=function(le){var Ve=le.x*this.sx+le.y*this.shx+this.tx,dt=le.x*this.shy+le.y*this.sy+this.ty;return new nu(Ve,dt)},un.prototype.applyToRectangle=function(le){var Ve=this.applyToPoint(le),dt=this.applyToPoint(new nu(le.x+le.w,le.y+le.h));return new _l(Ve.x,Ve.y,dt.x-Ve.x,dt.y-Ve.y)},un.prototype.clone=function(){var le=this.sx,Ve=this.shy,dt=this.shx,Dt=this.sy,nr=this.tx,Lr=this.ty;return new un(le,Ve,dt,Dt,nr,Lr)},v.Matrix=un;var ri=v.matrixMult=function(le,Ve){return Ve.multiply(le)},Ae=new un(1,0,0,1,0,0);v.unitMatrix=v.identityMatrix=Ae;var Be=function(le,Ve){if(!jt[le]){var dt=(Ve instanceof $g?"Sh":"P")+(Object.keys(_t).length+1).toString(10);Ve.id=dt,jt[le]=dt,_t[dt]=Ve,Ur.publish("addPattern",Ve)}};v.ShadingPattern=$g,v.TilingPattern=wv,v.addShadingPattern=function(le,Ve){return G("addShadingPattern()"),Be(le,Ve),this},v.beginTilingPattern=function(le){G("beginTilingPattern()"),rl(le.boundingBox[0],le.boundingBox[1],le.boundingBox[2]-le.boundingBox[0],le.boundingBox[3]-le.boundingBox[1],le.matrix)},v.endTilingPattern=function(le,Ve){G("endTilingPattern()"),Ve.stream=rt[Ee].join(`
`),Be(le,Ve),Ur.publish("endTilingPattern",Ve),ti.pop().restore()};var mt,pt=v.__private__.newObject=function(){var le=Ir();return Fr(le,!0),le},Ir=v.__private__.newObjectDeferred=function(){return Oe++,$e[Oe]=function(){return it},Oe},Fr=function(le,Ve){return Ve=typeof Ve=="boolean"&&Ve,$e[le]=it,Ve&&je(le+" 0 obj"),le},qn=v.__private__.newAdditionalObject=function(){var le={objId:Ir(),content:""};return Ye.push(le),le},Oi=Ir(),zr=Ir(),bn=v.__private__.decodeColorString=function(le){var Ve=le.split(" ");if(Ve.length!==2||Ve[1]!=="g"&&Ve[1]!=="G")Ve.length!==5||Ve[4]!=="k"&&Ve[4]!=="K"||(Ve=[(1-Ve[0])*(1-Ve[3]),(1-Ve[1])*(1-Ve[3]),(1-Ve[2])*(1-Ve[3]),"r"]);else{var dt=parseFloat(Ve[0]);Ve=[dt,dt,dt,"r"]}for(var Dt="#",nr=0;nr<3;nr++)Dt+=("0"+Math.floor(255*parseFloat(Ve[nr])).toString(16)).slice(-2);return Dt},Tn=v.__private__.encodeColorString=function(le){var Ve;typeof le=="string"&&(le={ch1:le});var dt=le.ch1,Dt=le.ch2,nr=le.ch3,Lr=le.ch4,Zr=le.pdfColorType==="draw"?["G","RG","K"]:["g","rg","k"];if(typeof dt=="string"&&dt.charAt(0)!=="#"){var kn=new gX(dt);if(kn.ok)dt=kn.toHex();else if(!/^\d*\.?\d*$/.test(dt))throw new Error('Invalid color "'+dt+'" passed to jsPDF.encodeColorString.')}if(typeof dt=="string"&&/^#[0-9A-Fa-f]{3}$/.test(dt)&&(dt="#"+dt[1]+dt[1]+dt[2]+dt[2]+dt[3]+dt[3]),typeof dt=="string"&&/^#[0-9A-Fa-f]{6}$/.test(dt)){var wn=parseInt(dt.substr(1),16);dt=wn>>16&255,Dt=wn>>8&255,nr=255&wn}if(Dt===void 0||Lr===void 0&&dt===Dt&&Dt===nr)Ve=typeof dt=="string"?dt+" "+Zr[0]:le.precision===2?Q(dt/255)+" "+Zr[0]:H(dt/255)+" "+Zr[0];else if(Lr===void 0||ao(Lr)==="object"){if(Lr&&!isNaN(Lr.a)&&Lr.a===0)return["1.","1.","1.",Zr[1]].join(" ");Ve=typeof dt=="string"?[dt,Dt,nr,Zr[1]].join(" "):le.precision===2?[Q(dt/255),Q(Dt/255),Q(nr/255),Zr[1]].join(" "):[H(dt/255),H(Dt/255),H(nr/255),Zr[1]].join(" ")}else Ve=typeof dt=="string"?[dt,Dt,nr,Lr,Zr[2]].join(" "):le.precision===2?[Q(dt),Q(Dt),Q(nr),Q(Lr),Zr[2]].join(" "):[H(dt),H(Dt),H(nr),H(Lr),Zr[2]].join(" ");return Ve},Mi=v.__private__.getFilters=function(){return s},pi=v.__private__.putStream=function(le){var Ve=(le=le||{}).data||"",dt=le.filters||Mi(),Dt=le.alreadyAppliedFilters||[],nr=le.addLength1||!1,Lr=Ve.length,Zr=le.objectId,kn=function(Fa){return Fa};if(f!==null&&Zr===void 0)throw new Error("ObjectId must be passed to putStream for file encryption");f!==null&&(kn=ka.encryptor(Zr,0));var wn={};dt===!0&&(dt=["FlateEncode"]);var ni=le.additionalKeyValues||[],oi=(wn=li.API.processDataByFilters!==void 0?li.API.processDataByFilters(Ve,dt):{data:Ve,reverseChain:[]}).reverseChain+(Array.isArray(Dt)?Dt.join(" "):Dt.toString());if(wn.data.length!==0&&(ni.push({key:"Length",value:wn.data.length}),nr===!0&&ni.push({key:"Length1",value:Lr})),oi.length!=0)if(oi.split("/").length-1==1)ni.push({key:"Filter",value:oi});else{ni.push({key:"Filter",value:"["+oi+"]"});for(var Ii=0;Ii<ni.length;Ii+=1)if(ni[Ii].key==="DecodeParms"){for(var $i=[],Bi=0;Bi<wn.reverseChain.split("/").length-1;Bi+=1)$i.push("null");$i.push(ni[Ii].value),ni[Ii].value="["+$i.join(" ")+"]"}}je("<<");for(var Ti=0;Ti<ni.length;Ti++)je("/"+ni[Ti].key+" "+ni[Ti].value);je(">>"),wn.data.length!==0&&(je("stream"),je(kn(wn.data)),je("endstream"))},Wi=v.__private__.putPage=function(le){var Ve=le.number,dt=le.data,Dt=le.objId,nr=le.contentsObjId;Fr(Dt,!0),je("<</Type /Page"),je("/Parent "+le.rootDictionaryObjId+" 0 R"),je("/Resources "+le.resourceDictionaryObjId+" 0 R"),je("/MediaBox ["+parseFloat(W(le.mediaBox.bottomLeftX))+" "+parseFloat(W(le.mediaBox.bottomLeftY))+" "+W(le.mediaBox.topRightX)+" "+W(le.mediaBox.topRightY)+"]"),le.cropBox!==null&&je("/CropBox ["+W(le.cropBox.bottomLeftX)+" "+W(le.cropBox.bottomLeftY)+" "+W(le.cropBox.topRightX)+" "+W(le.cropBox.topRightY)+"]"),le.bleedBox!==null&&je("/BleedBox ["+W(le.bleedBox.bottomLeftX)+" "+W(le.bleedBox.bottomLeftY)+" "+W(le.bleedBox.topRightX)+" "+W(le.bleedBox.topRightY)+"]"),le.trimBox!==null&&je("/TrimBox ["+W(le.trimBox.bottomLeftX)+" "+W(le.trimBox.bottomLeftY)+" "+W(le.trimBox.topRightX)+" "+W(le.trimBox.topRightY)+"]"),le.artBox!==null&&je("/ArtBox ["+W(le.artBox.bottomLeftX)+" "+W(le.artBox.bottomLeftY)+" "+W(le.artBox.topRightX)+" "+W(le.artBox.topRightY)+"]"),typeof le.userUnit=="number"&&le.userUnit!==1&&je("/UserUnit "+le.userUnit),Ur.publish("putPage",{objId:Dt,pageContext:Tr[Ve],pageNumber:Ve,page:dt}),je("/Contents "+nr+" 0 R"),je(">>"),je("endobj");var Lr=dt.join(`
`);return M===O&&(Lr+=`
Q`),Fr(nr,!0),pi({data:Lr,filters:Mi(),objectId:nr}),je("endobj"),Dt},Fn=v.__private__.putPages=function(){var le,Ve,dt=[];for(le=1;le<=bt;le++)Tr[le].objId=Ir(),Tr[le].contentsObjId=Ir();for(le=1;le<=bt;le++)dt.push(Wi({number:le,data:rt[le],objId:Tr[le].objId,contentsObjId:Tr[le].contentsObjId,mediaBox:Tr[le].mediaBox,cropBox:Tr[le].cropBox,bleedBox:Tr[le].bleedBox,trimBox:Tr[le].trimBox,artBox:Tr[le].artBox,userUnit:Tr[le].userUnit,rootDictionaryObjId:Oi,resourceDictionaryObjId:zr}));Fr(Oi,!0),je("<</Type /Pages");var Dt="/Kids [";for(Ve=0;Ve<bt;Ve++)Dt+=dt[Ve]+" 0 R ";je(Dt+"]"),je("/Count "+bt),je(">>"),je("endobj"),Ur.publish("postPutPages")},Ia=function(le){Ur.publish("putFont",{font:le,out:je,newObject:pt,putStream:pi}),le.isAlreadyPutted!==!0&&(le.objectNumber=pt(),je("<<"),je("/Type /Font"),je("/BaseFont /"+ev(le.postScriptName)),je("/Subtype /Type1"),typeof le.encoding=="string"&&je("/Encoding /"+le.encoding),je("/FirstChar 32"),je("/LastChar 255"),je(">>"),je("endobj"))},ma=function(le){le.objectNumber=pt();var Ve=[];Ve.push({key:"Type",value:"/XObject"}),Ve.push({key:"Subtype",value:"/Form"}),Ve.push({key:"BBox",value:"["+[W(le.x),W(le.y),W(le.x+le.width),W(le.y+le.height)].join(" ")+"]"}),Ve.push({key:"Matrix",value:"["+le.matrix.toString()+"]"});var dt=le.pages[1].join(`
`);pi({data:dt,additionalKeyValues:Ve,objectId:le.objectNumber}),je("endobj")},Gi=function(le,Ve){Ve||(Ve=21);var dt=pt(),Dt=(function(Zr,kn){var wn,ni=[],oi=1/(kn-1);for(wn=0;wn<1;wn+=oi)ni.push(wn);if(ni.push(1),Zr[0].offset!=0){var Ii={offset:0,color:Zr[0].color};Zr.unshift(Ii)}if(Zr[Zr.length-1].offset!=1){var $i={offset:1,color:Zr[Zr.length-1].color};Zr.push($i)}for(var Bi="",Ti=0,Fa=0;Fa<ni.length;Fa++){for(wn=ni[Fa];wn>Zr[Ti+1].offset;)Ti++;var fa=Zr[Ti].offset,Qa=(wn-fa)/(Zr[Ti+1].offset-fa),bs=Zr[Ti].color,nl=Zr[Ti+1].color;Bi+=Ne(Math.round((1-Qa)*bs[0]+Qa*nl[0]).toString(16))+Ne(Math.round((1-Qa)*bs[1]+Qa*nl[1]).toString(16))+Ne(Math.round((1-Qa)*bs[2]+Qa*nl[2]).toString(16))}return Bi.trim()})(le.colors,Ve),nr=[];nr.push({key:"FunctionType",value:"0"}),nr.push({key:"Domain",value:"[0.0 1.0]"}),nr.push({key:"Size",value:"["+Ve+"]"}),nr.push({key:"BitsPerSample",value:"8"}),nr.push({key:"Range",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),nr.push({key:"Decode",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),pi({data:Dt,additionalKeyValues:nr,alreadyAppliedFilters:["/ASCIIHexDecode"],objectId:dt}),je("endobj"),le.objectNumber=pt(),je("<< /ShadingType "+le.type),je("/ColorSpace /DeviceRGB");var Lr="/Coords ["+W(parseFloat(le.coords[0]))+" "+W(parseFloat(le.coords[1]))+" ";le.type===2?Lr+=W(parseFloat(le.coords[2]))+" "+W(parseFloat(le.coords[3])):Lr+=W(parseFloat(le.coords[2]))+" "+W(parseFloat(le.coords[3]))+" "+W(parseFloat(le.coords[4]))+" "+W(parseFloat(le.coords[5])),je(Lr+="]"),le.matrix&&je("/Matrix ["+le.matrix.toString()+"]"),je("/Function "+dt+" 0 R"),je("/Extend [true true]"),je(">>"),je("endobj")},Ka=function(le,Ve){var dt=Ir(),Dt=pt();Ve.push({resourcesOid:dt,objectOid:Dt}),le.objectNumber=Dt;var nr=[];nr.push({key:"Type",value:"/Pattern"}),nr.push({key:"PatternType",value:"1"}),nr.push({key:"PaintType",value:"1"}),nr.push({key:"TilingType",value:"1"}),nr.push({key:"BBox",value:"["+le.boundingBox.map(W).join(" ")+"]"}),nr.push({key:"XStep",value:W(le.xStep)}),nr.push({key:"YStep",value:W(le.yStep)}),nr.push({key:"Resources",value:dt+" 0 R"}),le.matrix&&nr.push({key:"Matrix",value:"["+le.matrix.toString()+"]"}),pi({data:le.stream,additionalKeyValues:nr,objectId:le.objectNumber}),je("endobj")},xa=function(le){for(var Ve in le.objectNumber=pt(),je("<<"),le)switch(Ve){case"opacity":je("/ca "+Q(le[Ve]));break;case"stroke-opacity":je("/CA "+Q(le[Ve]))}je(">>"),je("endobj")},Ui=function(le){Fr(le.resourcesOid,!0),je("<<"),je("/ProcSet [/PDF /Text /ImageB /ImageC /ImageI]"),(function(){for(var Ve in je("/Font <<"),ot)ot.hasOwnProperty(Ve)&&(g===!1||g===!0&&b.hasOwnProperty(Ve))&&je("/"+Ve+" "+ot[Ve].objectNumber+" 0 R");je(">>")})(),(function(){if(Object.keys(_t).length>0){for(var Ve in je("/Shading <<"),_t)_t.hasOwnProperty(Ve)&&_t[Ve]instanceof $g&&_t[Ve].objectNumber>=0&&je("/"+Ve+" "+_t[Ve].objectNumber+" 0 R");Ur.publish("putShadingPatternDict"),je(">>")}})(),(function(Ve){if(Object.keys(_t).length>0){for(var dt in je("/Pattern <<"),_t)_t.hasOwnProperty(dt)&&_t[dt]instanceof v.TilingPattern&&_t[dt].objectNumber>=0&&_t[dt].objectNumber<Ve&&je("/"+dt+" "+_t[dt].objectNumber+" 0 R");Ur.publish("putTilingPatternDict"),je(">>")}})(le.objectOid),(function(){if(Object.keys(Jt).length>0){var Ve;for(Ve in je("/ExtGState <<"),Jt)Jt.hasOwnProperty(Ve)&&Jt[Ve].objectNumber>=0&&je("/"+Ve+" "+Jt[Ve].objectNumber+" 0 R");Ur.publish("putGStateDict"),je(">>")}})(),(function(){for(var Ve in je("/XObject <<"),Jr)Jr.hasOwnProperty(Ve)&&Jr[Ve].objectNumber>=0&&je("/"+Ve+" "+Jr[Ve].objectNumber+" 0 R");Ur.publish("putXobjectDict"),je(">>")})(),je(">>"),je("endobj")},oo=function(le){et[le.fontName]=et[le.fontName]||{},et[le.fontName][le.fontStyle]=le.id},Ja=function(le,Ve,dt,Dt,nr){var Lr={id:"F"+(Object.keys(ot).length+1).toString(10),postScriptName:le,fontName:Ve,fontStyle:dt,encoding:Dt,isStandardFont:nr||!1,metadata:{}};return Ur.publish("addFont",{font:Lr,instance:this}),ot[Lr.id]=Lr,oo(Lr),Lr.id},Hn=v.__private__.pdfEscape=v.pdfEscape=function(le,Ve){return(function(dt,Dt){var nr,Lr,Zr,kn,wn,ni,oi,Ii,$i;if(Zr=(Dt=Dt||{}).sourceEncoding||"Unicode",wn=Dt.outputEncoding,(Dt.autoencode||wn)&&ot[nt].metadata&&ot[nt].metadata[Zr]&&ot[nt].metadata[Zr].encoding&&(kn=ot[nt].metadata[Zr].encoding,!wn&&ot[nt].encoding&&(wn=ot[nt].encoding),!wn&&kn.codePages&&(wn=kn.codePages[0]),typeof wn=="string"&&(wn=kn[wn]),wn)){for(oi=!1,ni=[],nr=0,Lr=dt.length;nr<Lr;nr++)(Ii=wn[dt.charCodeAt(nr)])?ni.push(String.fromCharCode(Ii)):ni.push(dt[nr]),ni[nr].charCodeAt(0)>>8&&(oi=!0);dt=ni.join("")}for(nr=dt.length;oi===void 0&&nr!==0;)dt.charCodeAt(nr-1)>>8&&(oi=!0),nr--;if(!oi)return dt;for(ni=Dt.noBOM?[]:[254,255],nr=0,Lr=dt.length;nr<Lr;nr++){if(($i=(Ii=dt.charCodeAt(nr))>>8)>>8)throw new Error("Character at position "+nr+" of string '"+dt+"' exceeds 16bits. Cannot be encoded into UCS-2 BE");ni.push($i),ni.push(Ii-($i<<8))}return String.fromCharCode.apply(void 0,ni)})(le,Ve).replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},bu=v.__private__.beginPage=function(le){rt[++bt]=[],Tr[bt]={objId:0,contentsObjId:0,userUnit:Number(o),artBox:null,bleedBox:null,cropBox:null,trimBox:null,mediaBox:{bottomLeftX:0,bottomLeftY:0,topRightX:Number(le[0]),topRightY:Number(le[1])}},wa(bt),at(rt[Ee])},ru=function(le,Ve){var dt,Dt,nr;switch(r=Ve||r,typeof le=="string"&&(dt=k(le.toLowerCase()),Array.isArray(dt)&&(Dt=dt[0],nr=dt[1])),Array.isArray(le)&&(Dt=le[0]*_e,nr=le[1]*_e),isNaN(Dt)&&(Dt=i[0],nr=i[1]),(Dt>14400||nr>14400)&&(Eo.warn("A page in a PDF can not be wider or taller than 14400 userUnit. jsPDF limits the width/height to 14400"),Dt=Math.min(14400,Dt),nr=Math.min(14400,nr)),i=[Dt,nr],r.substr(0,1)){case"l":nr>Dt&&(i=[nr,Dt]);break;case"p":Dt>nr&&(i=[nr,Dt])}bu(i),Mr(En),je(us),To!==0&&je(To+" J"),Xo!==0&&je(Xo+" j"),Ur.publish("addPage",{pageNumber:bt})},Pa=function(le){le>0&&le<=bt&&(rt.splice(le,1),Tr.splice(le,1),bt--,Ee>bt&&(Ee=bt),this.setPage(Ee))},wa=function(le){le>0&&le<=bt&&(Ee=le)},Wo=v.__private__.getNumberOfPages=v.getNumberOfPages=function(){return rt.length-1},No=function(le,Ve,dt){var Dt,nr=void 0;return dt=dt||{},le=le!==void 0?le:ot[nt].fontName,Ve=Ve!==void 0?Ve:ot[nt].fontStyle,Dt=le.toLowerCase(),et[Dt]!==void 0&&et[Dt][Ve]!==void 0?nr=et[Dt][Ve]:et[le]!==void 0&&et[le][Ve]!==void 0?nr=et[le][Ve]:dt.disableWarning===!1&&Eo.warn("Unable to look up font label for font '"+le+"', '"+Ve+"'. Refer to getFontList() for available fonts."),nr||dt.noFallback||(nr=et.times[Ve])==null&&(nr=et.times.normal),nr},ls=v.__private__.putInfo=function(){var le=pt(),Ve=function(Dt){return Dt};for(var dt in f!==null&&(Ve=ka.encryptor(le,0)),je("<<"),je("/Producer ("+Hn(Ve("jsPDF "+li.version))+")"),ir)ir.hasOwnProperty(dt)&&ir[dt]&&je("/"+dt.substr(0,1).toUpperCase()+dt.substr(1)+" ("+Hn(Ve(ir[dt]))+")");je("/CreationDate ("+Hn(Ve(ce))+")"),je(">>"),je("endobj")},kc=v.__private__.putCatalog=function(le){var Ve=(le=le||{}).rootDictionaryObjId||Oi;switch(pt(),je("<<"),je("/Type /Catalog"),je("/Pages "+Ve+" 0 R"),yr||(yr="fullwidth"),yr){case"fullwidth":je("/OpenAction [3 0 R /FitH null]");break;case"fullheight":je("/OpenAction [3 0 R /FitV null]");break;case"fullpage":je("/OpenAction [3 0 R /Fit]");break;case"original":je("/OpenAction [3 0 R /XYZ null null 1]");break;default:var dt=""+yr;dt.substr(dt.length-1)==="%"&&(yr=parseInt(yr)/100),typeof yr=="number"&&je("/OpenAction [3 0 R /XYZ null null "+Q(yr)+"]")}switch(er||(er="continuous"),er){case"continuous":je("/PageLayout /OneColumn");break;case"single":je("/PageLayout /SinglePage");break;case"two":case"twoleft":je("/PageLayout /TwoColumnLeft");break;case"tworight":je("/PageLayout /TwoColumnRight")}Er&&je("/PageMode /"+Er),Ur.publish("putCatalog"),je(">>"),je("endobj")},Sa=v.__private__.putTrailer=function(){je("trailer"),je("<<"),je("/Size "+(Oe+1)),je("/Root "+Oe+" 0 R"),je("/Info "+(Oe-1)+" 0 R"),f!==null&&je("/Encrypt "+ka.oid+" 0 R"),je("/ID [ <"+fe+"> <"+fe+"> ]"),je(">>")},Mc=v.__private__.putHeader=function(){je("%PDF-"+S),je("%")},Rc=v.__private__.putXRef=function(){var le="0000000000";je("xref"),je("0 "+(Oe+1)),je("0000000000 65535 f ");for(var Ve=1;Ve<=Oe;Ve++)typeof $e[Ve]=="function"?je((le+$e[Ve]()).slice(-10)+" 00000 n "):$e[Ve]!==void 0?je((le+$e[Ve]).slice(-10)+" 00000 n "):je("0000000000 00000 n ")},vl=v.__private__.buildDocument=function(){var le;Oe=0,it=0,De=[],$e=[],Ye=[],Oi=Ir(),zr=Ir(),at(De),Ur.publish("buildDocument"),Mc(),Fn(),(function(){Ur.publish("putAdditionalObjects");for(var dt=0;dt<Ye.length;dt++){var Dt=Ye[dt];Fr(Dt.objId,!0),je(Dt.content),je("endobj")}Ur.publish("postPutAdditionalObjects")})(),le=[],(function(){for(var dt in ot)ot.hasOwnProperty(dt)&&(g===!1||g===!0&&b.hasOwnProperty(dt))&&Ia(ot[dt])})(),(function(){var dt;for(dt in Jt)Jt.hasOwnProperty(dt)&&xa(Jt[dt])})(),(function(){for(var dt in Jr)Jr.hasOwnProperty(dt)&&ma(Jr[dt])})(),(function(dt){var Dt;for(Dt in _t)_t.hasOwnProperty(Dt)&&(_t[Dt]instanceof $g?Gi(_t[Dt]):_t[Dt]instanceof wv&&Ka(_t[Dt],dt))})(le),Ur.publish("putResources"),le.forEach(Ui),Ui({resourcesOid:zr,objectOid:Number.MAX_SAFE_INTEGER}),Ur.publish("postPutResources"),f!==null&&(ka.oid=pt(),je("<<"),je("/Filter /Standard"),je("/V "+ka.v),je("/R "+ka.r),je("/U <"+ka.toHexString(ka.U)+">"),je("/O <"+ka.toHexString(ka.O)+">"),je("/P "+ka.P),je(">>"),je("endobj")),ls(),kc();var Ve=it;return Rc(),Sa(),je("startxref"),je(""+Ve),je("%%EOF"),at(rt[Ee]),De.join(`
`)},Qs=v.__private__.getBlob=function(le){return new Blob([Yt(le)],{type:"application/pdf"})},Ha=v.output=v.__private__.output=(mt=function(le,Ve){switch(typeof(Ve=Ve||{})=="string"?Ve={filename:Ve}:Ve.filename=Ve.filename||"generated.pdf",le){case void 0:return vl();case"save":v.save(Ve.filename);break;case"arraybuffer":return Yt(vl());case"blob":return Qs(vl());case"bloburi":case"bloburl":if(Ri.URL!==void 0&&typeof Ri.URL.createObjectURL=="function")return Ri.URL&&Ri.URL.createObjectURL(Qs(vl()))||void 0;Eo.warn("bloburl is not supported by your system, because URL.createObjectURL is not supported by your browser.");break;case"datauristring":case"dataurlstring":var dt="",Dt=vl();try{dt=pB(Dt)}catch{dt=pB(unescape(encodeURIComponent(Dt)))}return"data:application/pdf;filename="+Ve.filename+";base64,"+dt;case"pdfobjectnewwindow":if(Object.prototype.toString.call(Ri)==="[object Window]"){var nr="https://cdnjs.cloudflare.com/ajax/libs/pdfobject/2.1.1/pdfobject.min.js",Lr=' integrity="sha512-4ze/a9/4jqu+tX9dfOqJYSvyYd5M6qum/3HpCLr+/Jqf0whc37VUbkpNGHR7/8pSnCFw47T1fmIpwBV7UySh3g==" crossorigin="anonymous"';Ve.pdfObjectUrl&&(nr=Ve.pdfObjectUrl,Lr="");var Zr='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><script src="'+nr+'"'+Lr+'><\/script><script >PDFObject.embed("'+this.output("dataurlstring")+'", '+JSON.stringify(Ve)+");<\/script></body></html>",kn=Ri.open();return kn!==null&&kn.document.write(Zr),kn}throw new Error("The option pdfobjectnewwindow just works in a browser-environment.");case"pdfjsnewwindow":if(Object.prototype.toString.call(Ri)==="[object Window]"){var wn='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe id="pdfViewer" src="'+(Ve.pdfJsUrl||"examples/PDF.js/web/viewer.html")+"?file=&downloadName="+Ve.filename+'" width="500px" height="400px" /></body></html>',ni=Ri.open();if(ni!==null){ni.document.write(wn);var oi=this;ni.document.documentElement.querySelector("#pdfViewer").onload=function(){ni.document.title=Ve.filename,ni.document.documentElement.querySelector("#pdfViewer").contentWindow.PDFViewerApplication.open(oi.output("bloburl"))}}return ni}throw new Error("The option pdfjsnewwindow just works in a browser-environment.");case"dataurlnewwindow":if(Object.prototype.toString.call(Ri)!=="[object Window]")throw new Error("The option dataurlnewwindow just works in a browser-environment.");var Ii='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe src="'+this.output("datauristring",Ve)+'"></iframe></body></html>',$i=Ri.open();if($i!==null&&($i.document.write(Ii),$i.document.title=Ve.filename),$i||typeof safari>"u")return $i;break;case"datauri":case"dataurl":return Ri.document.location.href=this.output("datauristring",Ve);default:return null}},mt.foo=function(){try{return mt.apply(this,arguments)}catch(dt){var le=dt.stack||"";~le.indexOf(" at ")&&(le=le.split(" at ")[1]);var Ve="Error in function "+le.split(`
`)[0].split("<")[0]+": "+dt.message;if(!Ri.console)throw new Error(Ve);Ri.console.error(Ve,dt),Ri.alert&&alert(Ve)}},mt.foo.bar=mt,mt.foo),so=function(le){return Array.isArray(Gr)===!0&&Gr.indexOf(le)>-1};switch(n){case"pt":_e=1;break;case"mm":_e=72/25.4;break;case"cm":_e=72/2.54;break;case"in":_e=72;break;case"px":_e=so("px_scaling")==1?.75:96/72;break;case"pc":case"em":_e=12;break;case"ex":_e=6;break;default:if(typeof n!="number")throw new Error("Invalid unit: "+n);_e=n}var ka=null;ke(),me();var el=v.__private__.getPageInfo=v.getPageInfo=function(le){if(isNaN(le)||le%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfo");return{objId:Tr[le].objId,pageNumber:le,pageContext:Tr[le]}},xu=v.__private__.getPageInfoByObjId=function(le){if(isNaN(le)||le%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfoByObjId");for(var Ve in Tr)if(Tr[Ve].objId===le)break;return el(Ve)},wu=v.__private__.getCurrentPageInfo=v.getCurrentPageInfo=function(){return{objId:Tr[Ee].objId,pageNumber:Ee,pageContext:Tr[Ee]}};v.addPage=function(){return ru.apply(this,arguments),this},v.setPage=function(){return wa.apply(this,arguments),at.call(this,rt[Ee]),this},v.insertPage=function(le){return this.addPage(),this.movePage(Ee,le),this},v.movePage=function(le,Ve){var dt,Dt;if(le>Ve){dt=rt[le],Dt=Tr[le];for(var nr=le;nr>Ve;nr--)rt[nr]=rt[nr-1],Tr[nr]=Tr[nr-1];rt[Ve]=dt,Tr[Ve]=Dt,this.setPage(Ve)}else if(le<Ve){dt=rt[le],Dt=Tr[le];for(var Lr=le;Lr<Ve;Lr++)rt[Lr]=rt[Lr+1],Tr[Lr]=Tr[Lr+1];rt[Ve]=dt,Tr[Ve]=Dt,this.setPage(Ve)}return this},v.deletePage=function(){return Pa.apply(this,arguments),this},v.__private__.text=v.text=function(le,Ve,dt,Dt,nr){var Lr,Zr,kn,wn,ni,oi,Ii,$i,Bi,Ti=(Dt=Dt||{}).scope||this;if(typeof le=="number"&&typeof Ve=="number"&&(typeof dt=="string"||Array.isArray(dt))){var Fa=dt;dt=Ve,Ve=le,le=Fa}if(arguments[3]instanceof un==0?(kn=arguments[4],wn=arguments[5],ao(Ii=arguments[3])==="object"&&Ii!==null||(typeof kn=="string"&&(wn=kn,kn=null),typeof Ii=="string"&&(wn=Ii,Ii=null),typeof Ii=="number"&&(kn=Ii,Ii=null),Dt={flags:Ii,angle:kn,align:wn})):(G("The transform parameter of text() with a Matrix value"),Bi=nr),isNaN(Ve)||isNaN(dt)||le==null)throw new Error("Invalid arguments passed to jsPDF.text");if(le.length===0)return Ti;var fa,Qa="",bs=typeof Dt.lineHeightFactor=="number"?Dt.lineHeightFactor:Ei,nl=Ti.internal.scaleFactor;function Su(An){return An=An.split("	").join(Array(Dt.TabLen||9).join(" ")),Hn(An,Ii)}function Fo(An){for(var A,y=An.concat(),_=[],I=y.length;I--;)typeof(A=y.shift())=="string"?_.push(A):Array.isArray(An)&&(A.length===1||A[1]===void 0&&A[2]===void 0)?_.push(A[0]):_.push([A[0],A[1],A[2]]);return _}function Dl(An,A){var y;if(typeof An=="string")y=A(An)[0];else if(Array.isArray(An)){for(var _,I,U=An.concat(),re=[],ye=U.length;ye--;)typeof(_=U.shift())=="string"?re.push(A(_)[0]):Array.isArray(_)&&typeof _[0]=="string"&&(I=A(_[0],_[1],_[2]),re.push([I[0],I[1],I[2]]));y=re}return y}var aa=!1,xl=!0;if(typeof le=="string")aa=!0;else if(Array.isArray(le)){var iu=le.concat();Zr=[];for(var co,eo=iu.length;eo--;)(typeof(co=iu.shift())!="string"||Array.isArray(co)&&typeof co[0]!="string")&&(xl=!1);aa=xl}if(aa===!1)throw new Error('Type of text must be string or Array. "'+le+'" is not recognized.');typeof le=="string"&&(le=le.match(/[\r?\n]/)?le.split(/\r\n|\r|\n/g):[le]);var xo=vt/Ti.internal.scaleFactor,Ba=xo*(bs-1);switch(Dt.baseline){case"bottom":dt-=Ba;break;case"top":dt+=xo-Ba;break;case"hanging":dt+=xo-2*Ba;break;case"middle":dt+=xo/2-Ba}if((oi=Dt.maxWidth||0)>0&&(typeof le=="string"?le=Ti.splitTextToSize(le,oi):Object.prototype.toString.call(le)==="[object Array]"&&(le=le.reduce(function(An,A){return An.concat(Ti.splitTextToSize(A,oi))},[]))),Lr={text:le,x:Ve,y:dt,options:Dt,mutex:{pdfEscape:Hn,activeFontKey:nt,fonts:ot,activeFontSize:vt}},Ur.publish("preProcessText",Lr),le=Lr.text,kn=(Dt=Lr.options).angle,Bi instanceof un==0&&kn&&typeof kn=="number"){kn*=Math.PI/180,Dt.rotationDirection===0&&(kn=-kn),M===O&&(kn=-kn);var Yo=Math.cos(kn),Eu=Math.sin(kn);Bi=new un(Yo,Eu,-Eu,Yo,0,0)}else kn&&kn instanceof un&&(Bi=kn);M!==O||Bi||(Bi=Ae),(ni=Dt.charSpace||Yn)!==void 0&&(Qa+=W(ne(ni))+` Tc
`,this.setCharSpace(this.getCharSpace()||0)),($i=Dt.horizontalScale)!==void 0&&(Qa+=W(100*$i)+` Tz
`),Dt.lang;var Ea=-1,lh=Dt.renderingMode!==void 0?Dt.renderingMode:Dt.stroke,cs=Ti.internal.getCurrentPageInfo().pageContext;switch(lh){case 0:case!1:case"fill":Ea=0;break;case 1:case!0:case"stroke":Ea=1;break;case 2:case"fillThenStroke":Ea=2;break;case 3:case"invisible":Ea=3;break;case 4:case"fillAndAddForClipping":Ea=4;break;case 5:case"strokeAndAddPathForClipping":Ea=5;break;case 6:case"fillThenStrokeAndAddToPathForClipping":Ea=6;break;case 7:case"addToPathForClipping":Ea=7}var au=cs.usedRenderingMode!==void 0?cs.usedRenderingMode:-1;Ea!==-1?Qa+=Ea+` Tr
`:au!==-1&&(Qa+=`0 Tr
`),Ea!==-1&&(cs.usedRenderingMode=Ea),wn=Dt.align||"left";var Wa,Fs=vt*bs,Hu=Ti.internal.pageSize.getWidth(),Wu=ot[nt];ni=Dt.charSpace||Yn,oi=Dt.maxWidth||0,Ii=Object.assign({autoencode:!0,noBOM:!0},Dt.flags);var wl=[],Fl=function(An){return Ti.getStringUnitWidth(An,{font:Wu,charSpace:ni,fontSize:vt,doKerning:!1})*vt/nl};if(Object.prototype.toString.call(le)==="[object Array]"){var Ao;Zr=Fo(le),wn!=="left"&&(Wa=Zr.map(Fl));var ho,Bs=0;if(wn==="right"){Ve-=Wa[0],le=[],eo=Zr.length;for(var wo=0;wo<eo;wo++)wo===0?(ho=Ci(Ve),Ao=Ra(dt)):(ho=ne(Bs-Wa[wo]),Ao=-Fs),le.push([Zr[wo],ho,Ao]),Bs=Wa[wo]}else if(wn==="center"){Ve-=Wa[0]/2,le=[],eo=Zr.length;for(var Bl=0;Bl<eo;Bl++)Bl===0?(ho=Ci(Ve),Ao=Ra(dt)):(ho=ne((Bs-Wa[Bl])/2),Ao=-Fs),le.push([Zr[Bl],ho,Ao]),Bs=Wa[Bl]}else if(wn==="left"){le=[],eo=Zr.length;for(var hs=0;hs<eo;hs++)le.push(Zr[hs])}else if(wn==="justify"&&Wu.encoding==="Identity-H"){le=[],eo=Zr.length,oi=oi!==0?oi:Hu;for(var zl=0,ya=0;ya<eo;ya++)if(Ao=ya===0?Ra(dt):-Fs,ho=ya===0?Ci(Ve):zl,ya<eo-1){var Tu=ne((oi-Wa[ya])/(Zr[ya].split(" ").length-1)),il=Zr[ya].split(" ");le.push([il[0]+" ",ho,Ao]),zl=0;for(var zs=1;zs<il.length;zs++){var jl=(Fl(il[zs-1]+" "+il[zs])-Fl(il[zs]))*nl+Tu;zs==il.length-1?le.push([il[zs],jl,0]):le.push([il[zs]+" ",jl,0]),zl-=jl}}else le.push([Zr[ya],ho,Ao]);le.push(["",zl,0])}else{if(wn!=="justify")throw new Error('Unrecognized alignment option, use "left", "center", "right" or "justify".');for(le=[],eo=Zr.length,oi=oi!==0?oi:Hu,ya=0;ya<eo;ya++)Ao=ya===0?Ra(dt):-Fs,ho=ya===0?Ci(Ve):0,ya<eo-1?wl.push(W(ne((oi-Wa[ya])/(Zr[ya].split(" ").length-1)))):wl.push(0),le.push([Zr[ya],ho,Ao])}}(typeof Dt.R2L=="boolean"?Dt.R2L:cr)===!0&&(le=Dl(le,function(An,A,y){return[An.split("").reverse().join(""),A,y]})),Lr={text:le,x:Ve,y:dt,options:Dt,mutex:{pdfEscape:Hn,activeFontKey:nt,fonts:ot,activeFontSize:vt}},Ur.publish("postProcessText",Lr),le=Lr.text,fa=Lr.mutex.isHex||!1;var Cu=ot[nt].encoding;Cu!=="WinAnsiEncoding"&&Cu!=="StandardEncoding"||(le=Dl(le,function(An,A,y){return[Su(An),A,y]})),Zr=Fo(le),le=[];for(var js,ou,Ul,$t=Array.isArray(Zr[0])?1:0,tr="",sn=function(An,A,y){var _="";return y instanceof un?(y=typeof Dt.angle=="number"?ri(y,new un(1,0,0,1,An,A)):ri(new un(1,0,0,1,An,A),y),M===O&&(y=ri(new un(1,0,0,-1,0,0),y)),_=y.join(" ")+` Tm
`):_=W(An)+" "+W(A)+` Td
`,_},Cn=0;Cn<Zr.length;Cn++){switch(tr="",$t){case 1:Ul=(fa?"<":"(")+Zr[Cn][0]+(fa?">":")"),js=parseFloat(Zr[Cn][1]),ou=parseFloat(Zr[Cn][2]);break;case 0:Ul=(fa?"<":"(")+Zr[Cn]+(fa?">":")"),js=Ci(Ve),ou=Ra(dt)}wl!==void 0&&wl[Cn]!==void 0&&(tr=wl[Cn]+` Tw
`),Cn===0?le.push(tr+sn(js,ou,Bi)+Ul):$t===0?le.push(tr+Ul):$t===1&&le.push(tr+sn(js,ou,Bi)+Ul)}le=$t===0?le.join(` Tj
T* `):le.join(` Tj
`),le+=` Tj
`;var bi=`BT
/`;return bi+=nt+" "+vt+` Tf
`,bi+=W(vt*bs)+` TL
`,bi+=Nn+`
`,bi+=Qa,bi+=le,je(bi+="ET"),b[nt]=!0,Ti};var J=v.__private__.clip=v.clip=function(le){return je(le==="evenodd"?"W*":"W"),this};v.clipEvenOdd=function(){return J("evenodd")},v.__private__.discardPath=v.discardPath=function(){return je("n"),this};var pe=v.__private__.isValidStyle=function(le){var Ve=!1;return[void 0,null,"S","D","F","DF","FD","f","f*","B","B*","n"].indexOf(le)!==-1&&(Ve=!0),Ve};v.__private__.setDefaultPathOperation=v.setDefaultPathOperation=function(le){return pe(le)&&(h=le),this};var Xe=v.__private__.getStyle=v.getStyle=function(le){var Ve=h;switch(le){case"D":case"S":Ve="S";break;case"F":Ve="f";break;case"FD":case"DF":Ve="B";break;case"f":case"f*":case"B":case"B*":Ve=le}return Ve},Tt=v.close=function(){return je("h"),this};v.stroke=function(){return je("S"),this},v.fill=function(le){return Nt("f",le),this},v.fillEvenOdd=function(le){return Nt("f*",le),this},v.fillStroke=function(le){return Nt("B",le),this},v.fillStrokeEvenOdd=function(le){return Nt("B*",le),this};var Nt=function(le,Ve){ao(Ve)==="object"?$r(Ve,le):je(le)},kt=function(le){le===null||M===O&&le===void 0||(le=Xe(le),je(le))};function Gt(le,Ve,dt,Dt,nr){var Lr=new wv(Ve||this.boundingBox,dt||this.xStep,Dt||this.yStep,this.gState,nr||this.matrix);Lr.stream=this.stream;var Zr=le+"$$"+this.cloneIndex+++"$$";return Be(Zr,Lr),Lr}var $r=function(le,Ve){var dt=jt[le.key],Dt=_t[dt];if(Dt instanceof $g)je("q"),je(Yr(Ve)),Dt.gState&&v.setGState(Dt.gState),je(le.matrix.toString()+" cm"),je("/"+dt+" sh"),je("Q");else if(Dt instanceof wv){var nr=new un(1,0,0,-1,0,na());le.matrix&&(nr=nr.multiply(le.matrix||Ae),dt=Gt.call(Dt,le.key,le.boundingBox,le.xStep,le.yStep,nr).id),je("q"),je("/Pattern cs"),je("/"+dt+" scn"),Dt.gState&&v.setGState(Dt.gState),je(Ve),je("Q")}},Yr=function(le){switch(le){case"f":case"F":case"n":return"W n";case"f*":return"W* n";case"B":case"S":return"W S";case"B*":return"W* S"}},Hr=v.moveTo=function(le,Ve){return je(W(ne(le))+" "+W(oe(Ve))+" m"),this},kr=v.lineTo=function(le,Ve){return je(W(ne(le))+" "+W(oe(Ve))+" l"),this},Qr=v.curveTo=function(le,Ve,dt,Dt,nr,Lr){return je([W(ne(le)),W(oe(Ve)),W(ne(dt)),W(oe(Dt)),W(ne(nr)),W(oe(Lr)),"c"].join(" ")),this};v.__private__.line=v.line=function(le,Ve,dt,Dt,nr){if(isNaN(le)||isNaN(Ve)||isNaN(dt)||isNaN(Dt)||!pe(nr))throw new Error("Invalid arguments passed to jsPDF.line");return M===L?this.lines([[dt-le,Dt-Ve]],le,Ve,[1,1],nr||"S"):this.lines([[dt-le,Dt-Ve]],le,Ve,[1,1]).stroke()},v.__private__.lines=v.lines=function(le,Ve,dt,Dt,nr,Lr){var Zr,kn,wn,ni,oi,Ii,$i,Bi,Ti,Fa,fa,Qa;if(typeof le=="number"&&(Qa=dt,dt=Ve,Ve=le,le=Qa),Dt=Dt||[1,1],Lr=Lr||!1,isNaN(Ve)||isNaN(dt)||!Array.isArray(le)||!Array.isArray(Dt)||!pe(nr)||typeof Lr!="boolean")throw new Error("Invalid arguments passed to jsPDF.lines");for(Hr(Ve,dt),Zr=Dt[0],kn=Dt[1],ni=le.length,Fa=Ve,fa=dt,wn=0;wn<ni;wn++)(oi=le[wn]).length===2?(Fa=oi[0]*Zr+Fa,fa=oi[1]*kn+fa,kr(Fa,fa)):(Ii=oi[0]*Zr+Fa,$i=oi[1]*kn+fa,Bi=oi[2]*Zr+Fa,Ti=oi[3]*kn+fa,Fa=oi[4]*Zr+Fa,fa=oi[5]*kn+fa,Qr(Ii,$i,Bi,Ti,Fa,fa));return Lr&&Tt(),kt(nr),this},v.path=function(le){for(var Ve=0;Ve<le.length;Ve++){var dt=le[Ve],Dt=dt.c;switch(dt.op){case"m":Hr(Dt[0],Dt[1]);break;case"l":kr(Dt[0],Dt[1]);break;case"c":Qr.apply(this,Dt);break;case"h":Tt()}}return this},v.__private__.rect=v.rect=function(le,Ve,dt,Dt,nr){if(isNaN(le)||isNaN(Ve)||isNaN(dt)||isNaN(Dt)||!pe(nr))throw new Error("Invalid arguments passed to jsPDF.rect");return M===L&&(Dt=-Dt),je([W(ne(le)),W(oe(Ve)),W(ne(dt)),W(ne(Dt)),"re"].join(" ")),kt(nr),this},v.__private__.triangle=v.triangle=function(le,Ve,dt,Dt,nr,Lr,Zr){if(isNaN(le)||isNaN(Ve)||isNaN(dt)||isNaN(Dt)||isNaN(nr)||isNaN(Lr)||!pe(Zr))throw new Error("Invalid arguments passed to jsPDF.triangle");return this.lines([[dt-le,Dt-Ve],[nr-dt,Lr-Dt],[le-nr,Ve-Lr]],le,Ve,[1,1],Zr,!0),this},v.__private__.roundedRect=v.roundedRect=function(le,Ve,dt,Dt,nr,Lr,Zr){if(isNaN(le)||isNaN(Ve)||isNaN(dt)||isNaN(Dt)||isNaN(nr)||isNaN(Lr)||!pe(Zr))throw new Error("Invalid arguments passed to jsPDF.roundedRect");var kn=4/3*(Math.SQRT2-1);return nr=Math.min(nr,.5*dt),Lr=Math.min(Lr,.5*Dt),this.lines([[dt-2*nr,0],[nr*kn,0,nr,Lr-Lr*kn,nr,Lr],[0,Dt-2*Lr],[0,Lr*kn,-nr*kn,Lr,-nr,Lr],[2*nr-dt,0],[-nr*kn,0,-nr,-Lr*kn,-nr,-Lr],[0,2*Lr-Dt],[0,-Lr*kn,nr*kn,-Lr,nr,-Lr]],le+nr,Ve,[1,1],Zr,!0),this},v.__private__.ellipse=v.ellipse=function(le,Ve,dt,Dt,nr){if(isNaN(le)||isNaN(Ve)||isNaN(dt)||isNaN(Dt)||!pe(nr))throw new Error("Invalid arguments passed to jsPDF.ellipse");var Lr=4/3*(Math.SQRT2-1)*dt,Zr=4/3*(Math.SQRT2-1)*Dt;return Hr(le+dt,Ve),Qr(le+dt,Ve-Zr,le+Lr,Ve-Dt,le,Ve-Dt),Qr(le-Lr,Ve-Dt,le-dt,Ve-Zr,le-dt,Ve),Qr(le-dt,Ve+Zr,le-Lr,Ve+Dt,le,Ve+Dt),Qr(le+Lr,Ve+Dt,le+dt,Ve+Zr,le+dt,Ve),kt(nr),this},v.__private__.circle=v.circle=function(le,Ve,dt,Dt){if(isNaN(le)||isNaN(Ve)||isNaN(dt)||!pe(Dt))throw new Error("Invalid arguments passed to jsPDF.circle");return this.ellipse(le,Ve,dt,dt,Dt)},v.setFont=function(le,Ve,dt){return dt&&(Ve=q(Ve,dt)),nt=No(le,Ve,{disableWarning:!1}),this};var Qn=v.__private__.getFont=v.getFont=function(){return ot[No.apply(v,arguments)]};v.__private__.getFontList=v.getFontList=function(){var le,Ve,dt={};for(le in et)if(et.hasOwnProperty(le))for(Ve in dt[le]=[],et[le])et[le].hasOwnProperty(Ve)&&dt[le].push(Ve);return dt},v.addFont=function(le,Ve,dt,Dt,nr){var Lr=["StandardEncoding","MacRomanEncoding","Identity-H","WinAnsiEncoding"];return arguments[3]&&Lr.indexOf(arguments[3])!==-1?nr=arguments[3]:arguments[3]&&Lr.indexOf(arguments[3])==-1&&(dt=q(dt,Dt)),Ja.call(this,le,Ve,dt,nr=nr||"Identity-H")};var Ei,En=t.lineWidth||.200025,pn=v.__private__.getLineWidth=v.getLineWidth=function(){return En},Mr=v.__private__.setLineWidth=v.setLineWidth=function(le){return En=le,je(W(ne(le))+" w"),this};v.__private__.setLineDash=li.API.setLineDash=li.API.setLineDashPattern=function(le,Ve){if(le=le||[],Ve=Ve||0,isNaN(Ve)||!Array.isArray(le))throw new Error("Invalid arguments passed to jsPDF.setLineDash");return le=le.map(function(dt){return W(ne(dt))}).join(" "),Ve=W(ne(Ve)),je("["+le+"] "+Ve+" d"),this};var cn=v.__private__.getLineHeight=v.getLineHeight=function(){return vt*Ei};v.__private__.getLineHeight=v.getLineHeight=function(){return vt*Ei};var Wn=v.__private__.setLineHeightFactor=v.setLineHeightFactor=function(le){return typeof(le=le||1.15)=="number"&&(Ei=le),this},Ma=v.__private__.getLineHeightFactor=v.getLineHeightFactor=function(){return Ei};Wn(t.lineHeight);var Ci=v.__private__.getHorizontalCoordinate=function(le){return ne(le)},Ra=v.__private__.getVerticalCoordinate=function(le){return M===O?le:Tr[Ee].mediaBox.topRightY-Tr[Ee].mediaBox.bottomLeftY-ne(le)},gi=v.__private__.getHorizontalCoordinateString=v.getHorizontalCoordinateString=function(le){return W(Ci(le))},jn=v.__private__.getVerticalCoordinateString=v.getVerticalCoordinateString=function(le){return W(Ra(le))},us=t.strokeColor||"0 G";v.__private__.getStrokeColor=v.getDrawColor=function(){return bn(us)},v.__private__.setStrokeColor=v.setDrawColor=function(le,Ve,dt,Dt){return us=Tn({ch1:le,ch2:Ve,ch3:dt,ch4:Dt,pdfColorType:"draw",precision:2}),je(us),this};var Un=t.fillColor||"0 g";v.__private__.getFillColor=v.getFillColor=function(){return bn(Un)},v.__private__.setFillColor=v.setFillColor=function(le,Ve,dt,Dt){return Un=Tn({ch1:le,ch2:Ve,ch3:dt,ch4:Dt,pdfColorType:"fill",precision:2}),je(Un),this};var Nn=t.textColor||"0 g",Go=v.__private__.getTextColor=v.getTextColor=function(){return bn(Nn)};v.__private__.setTextColor=v.setTextColor=function(le,Ve,dt,Dt){return Nn=Tn({ch1:le,ch2:Ve,ch3:dt,ch4:Dt,pdfColorType:"text",precision:3}),this};var Yn=t.charSpace,Do=v.__private__.getCharSpace=v.getCharSpace=function(){return parseFloat(Yn||0)};v.__private__.setCharSpace=v.setCharSpace=function(le){if(isNaN(le))throw new Error("Invalid argument passed to jsPDF.setCharSpace");return Yn=le,this};var To=0;v.CapJoinStyles={0:0,butt:0,but:0,miter:0,1:1,round:1,rounded:1,circle:1,2:2,projecting:2,project:2,square:2,bevel:2},v.__private__.setLineCap=v.setLineCap=function(le){var Ve=v.CapJoinStyles[le];if(Ve===void 0)throw new Error("Line cap style of '"+le+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return To=Ve,je(Ve+" J"),this};var Xo=0;v.__private__.setLineJoin=v.setLineJoin=function(le){var Ve=v.CapJoinStyles[le];if(Ve===void 0)throw new Error("Line join style of '"+le+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return Xo=Ve,je(Ve+" j"),this},v.__private__.setLineMiterLimit=v.__private__.setMiterLimit=v.setLineMiterLimit=v.setMiterLimit=function(le){if(le=le||0,isNaN(le))throw new Error("Invalid argument passed to jsPDF.setLineMiterLimit");return je(W(ne(le))+" M"),this},v.GState=Qw,v.setGState=function(le){(le=typeof le=="string"?Jt[Kt[le]]:tl(null,le)).equals(Rr)||(je("/"+le.id+" gs"),Rr=le)};var tl=function(le,Ve){if(!le||!Kt[le]){var dt=!1;for(var Dt in Jt)if(Jt.hasOwnProperty(Dt)&&Jt[Dt].equals(Ve)){dt=!0;break}if(dt)Ve=Jt[Dt];else{var nr="GS"+(Object.keys(Jt).length+1).toString(10);Jt[nr]=Ve,Ve.id=nr}return le&&(Kt[le]=Ve.id),Ur.publish("addGState",Ve),Ve}};v.addGState=function(le,Ve){return tl(le,Ve),this},v.saveGraphicsState=function(){return je("q"),Lt.push({key:nt,size:vt,color:Nn}),this},v.restoreGraphicsState=function(){je("Q");var le=Lt.pop();return nt=le.key,vt=le.size,Nn=le.color,Rr=null,this},v.setCurrentTransformationMatrix=function(le){return je(le.toString()+" cm"),this},v.comment=function(le){return je("#"+le),this};var nu=function(le,Ve){var dt=le||0;Object.defineProperty(this,"x",{enumerable:!0,get:function(){return dt},set:function(Lr){isNaN(Lr)||(dt=parseFloat(Lr))}});var Dt=Ve||0;Object.defineProperty(this,"y",{enumerable:!0,get:function(){return Dt},set:function(Lr){isNaN(Lr)||(Dt=parseFloat(Lr))}});var nr="pt";return Object.defineProperty(this,"type",{enumerable:!0,get:function(){return nr},set:function(Lr){nr=Lr.toString()}}),this},_l=function(le,Ve,dt,Dt){nu.call(this,le,Ve),this.type="rect";var nr=dt||0;Object.defineProperty(this,"w",{enumerable:!0,get:function(){return nr},set:function(Zr){isNaN(Zr)||(nr=parseFloat(Zr))}});var Lr=Dt||0;return Object.defineProperty(this,"h",{enumerable:!0,get:function(){return Lr},set:function(Zr){isNaN(Zr)||(Lr=parseFloat(Zr))}}),this},Co=function(){this.page=bt,this.currentPage=Ee,this.pages=rt.slice(0),this.pagesContext=Tr.slice(0),this.x=be,this.y=qe,this.matrix=Qe,this.width=lo(Ee),this.height=na(Ee),this.outputDestination=Mt,this.id="",this.objectNumber=-1};Co.prototype.restore=function(){bt=this.page,Ee=this.currentPage,Tr=this.pagesContext,rt=this.pages,be=this.x,qe=this.y,Qe=this.matrix,uo(Ee,this.width),Da(Ee,this.height),Mt=this.outputDestination};var rl=function(le,Ve,dt,Dt,nr){ti.push(new Co),bt=Ee=0,rt=[],be=le,qe=Ve,Qe=nr,bu([dt,Dt])};for(var bl in v.beginFormObject=function(le,Ve,dt,Dt,nr){return rl(le,Ve,dt,Dt,nr),this},v.endFormObject=function(le){return(function(Ve){if(ar[Ve])ti.pop().restore();else{var dt=new Co,Dt="Xo"+(Object.keys(Jr).length+1).toString(10);dt.id=Dt,ar[Ve]=Dt,Jr[Dt]=dt,Ur.publish("addFormObject",dt),ti.pop().restore()}})(le),this},v.doFormObject=function(le,Ve){var dt=Jr[ar[le]];return je("q"),je(Ve.toString()+" cm"),je("/"+dt.id+" Do"),je("Q"),this},v.getFormObject=function(le){var Ve=Jr[ar[le]];return{x:Ve.x,y:Ve.y,width:Ve.width,height:Ve.height,matrix:Ve.matrix}},v.save=function(le,Ve){return le=le||"generated.pdf",(Ve=Ve||{}).returnPromise=Ve.returnPromise||!1,Ve.returnPromise===!1?(jg(Qs(vl()),le),typeof jg.unload=="function"&&Ri.setTimeout&&setTimeout(jg.unload,911),this):new Promise(function(dt,Dt){try{var nr=jg(Qs(vl()),le);typeof jg.unload=="function"&&Ri.setTimeout&&setTimeout(jg.unload,911),dt(nr)}catch(Lr){Dt(Lr.message)}})},li.API)li.API.hasOwnProperty(bl)&&(bl==="events"&&li.API.events.length?(function(le,Ve){var dt,Dt,nr;for(nr=Ve.length-1;nr!==-1;nr--)dt=Ve[nr][0],Dt=Ve[nr][1],le.subscribe.apply(le,[dt].concat(typeof Dt=="function"?[Dt]:Dt))})(Ur,li.API.events):v[bl]=li.API[bl]);var lo=v.getPageWidth=function(le){return(Tr[le=le||Ee].mediaBox.topRightX-Tr[le].mediaBox.bottomLeftX)/_e},uo=v.setPageWidth=function(le,Ve){Tr[le].mediaBox.topRightX=Ve*_e+Tr[le].mediaBox.bottomLeftX},na=v.getPageHeight=function(le){return(Tr[le=le||Ee].mediaBox.topRightY-Tr[le].mediaBox.bottomLeftY)/_e},Da=v.setPageHeight=function(le,Ve){Tr[le].mediaBox.topRightY=Ve*_e+Tr[le].mediaBox.bottomLeftY};return v.internal={pdfEscape:Hn,getStyle:Xe,getFont:Qn,getFontSize:_r,getCharSpace:Do,getTextColor:Go,getLineHeight:cn,getLineHeightFactor:Ma,getLineWidth:pn,write:Xt,getHorizontalCoordinate:Ci,getVerticalCoordinate:Ra,getCoordinateString:gi,getVerticalCoordinateString:jn,collections:{},newObject:pt,newAdditionalObject:qn,newObjectDeferred:Ir,newObjectDeferredBegin:Fr,getFilters:Mi,putStream:pi,events:Ur,scaleFactor:_e,pageSize:{getWidth:function(){return lo(Ee)},setWidth:function(le){uo(Ee,le)},getHeight:function(){return na(Ee)},setHeight:function(le){Da(Ee,le)}},encryptionOptions:f,encryption:ka,getEncryptor:function(le){return f!==null?ka.encryptor(le,0):function(Ve){return Ve}},output:Ha,getNumberOfPages:Wo,pages:rt,out:je,f2:Q,f3:H,getPageInfo:el,getPageInfoByObjId:xu,getCurrentPageInfo:wu,getPDFVersion:E,Point:nu,Rectangle:_l,Matrix:un,hasHotfix:so},Object.defineProperty(v.internal.pageSize,"width",{get:function(){return lo(Ee)},set:function(le){uo(Ee,le)},enumerable:!0,configurable:!0}),Object.defineProperty(v.internal.pageSize,"height",{get:function(){return na(Ee)},set:function(le){Da(Ee,le)},enumerable:!0,configurable:!0}),(function(le){for(var Ve=0,dt=pr.length;Ve<dt;Ve++){var Dt=Ja.call(this,le[Ve][0],le[Ve][1],le[Ve][2],pr[Ve][3],!0);g===!1&&(b[Dt]=!0);var nr=le[Ve][0].split("-");oo({id:Dt,fontName:nr[0],fontStyle:nr[1]||""})}Ur.publish("addFonts",{fonts:ot,dictionary:et})}).call(v,pr),nt="F1",ru(i,r),Ur.publish("initialized"),v}Qy.prototype.lsbFirstWord=function(t){return String.fromCharCode(255&t,t>>8&255,t>>16&255,t>>24&255)},Qy.prototype.toHexString=function(t){return t.split("").map(function(e){return("0"+(255&e.charCodeAt(0)).toString(16)).slice(-2)}).join("")},Qy.prototype.hexToBytes=function(t){for(var e=[],r=0;r<t.length;r+=2)e.push(String.fromCharCode(parseInt(t.substr(r,2),16)));return e.join("")},Qy.prototype.processOwnerPassword=function(t,e){return HP(qP(e).substr(0,5),t)},Qy.prototype.encryptor=function(t,e){var r=qP(this.encryptionKey+String.fromCharCode(255&t,t>>8&255,t>>16&255,255&e,e>>8&255)).substr(0,10);return function(n){return HP(r,n)}},Qw.prototype.equals=function(t){var e,r="id,objectNumber,equals";if(!t||ao(t)!==ao(this))return!1;var n=0;for(e in this)if(!(r.indexOf(e)>=0)){if(this.hasOwnProperty(e)&&!t.hasOwnProperty(e)||this[e]!==t[e])return!1;n++}for(e in t)t.hasOwnProperty(e)&&r.indexOf(e)<0&&n--;return n===0},li.API={events:[]},li.version="3.0.2";var Ns=li.API,cO=1,jm=function(t){return t.replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},Ry=function(t){return t.replace(/\\\\/g,"\\").replace(/\\\(/g,"(").replace(/\\\)/g,")")},ji=function(t){return t.toFixed(2)},xp=function(t){return t.toFixed(5)};Ns.__acroform__={};var Cc=function(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t},vB=function(t){return t*cO},Bf=function(t){var e=new _X,r=Jn.internal.getHeight(t)||0,n=Jn.internal.getWidth(t)||0;return e.BBox=[0,0,Number(ji(n)),Number(ji(r))],e},Gye=Ns.__acroform__.setBit=function(t,e){if(t=t||0,e=e||0,isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBit");return t|1<<e},Xye=Ns.__acroform__.clearBit=function(t,e){if(t=t||0,e=e||0,isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBit");return t&~(1<<e)},Yye=Ns.__acroform__.getBit=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBit");return t&1<<e?1:0},Gs=Ns.__acroform__.getBitForPdf=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBitForPdf");return Yye(t,e-1)},Xs=Ns.__acroform__.setBitForPdf=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBitForPdf");return Gye(t,e-1)},Ys=Ns.__acroform__.clearBitForPdf=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBitForPdf");return Xye(t,e-1)},Zye=Ns.__acroform__.calculateCoordinates=function(t,e){var r=e.internal.getHorizontalCoordinate,n=e.internal.getVerticalCoordinate,i=t[0],a=t[1],s=t[2],o=t[3],u={};return u.lowerLeft_X=r(i)||0,u.lowerLeft_Y=n(a+o)||0,u.upperRight_X=r(i+s)||0,u.upperRight_Y=n(a)||0,[Number(ji(u.lowerLeft_X)),Number(ji(u.lowerLeft_Y)),Number(ji(u.upperRight_X)),Number(ji(u.upperRight_Y))]},Kye=function(t){if(t.appearanceStreamContent)return t.appearanceStreamContent;if(t.V||t.DV){var e=[],r=t._V||t.DV,n=WP(t,r),i=t.scope.internal.getFont(t.fontName,t.fontStyle).id;e.push("/Tx BMC"),e.push("q"),e.push("BT"),e.push(t.scope.__private__.encodeColorString(t.color)),e.push("/"+i+" "+ji(n.fontSize)+" Tf"),e.push("1 0 0 1 0 0 Tm"),e.push(n.text),e.push("ET"),e.push("Q"),e.push("EMC");var a=Bf(t);return a.scope=t.scope,a.stream=e.join(`
`),a}},WP=function(t,e){var r=t.fontSize===0?t.maxFontSize:t.fontSize,n={text:"",fontSize:""},i=(e=(e=e.substr(0,1)=="("?e.substr(1):e).substr(e.length-1)==")"?e.substr(0,e.length-1):e).split(" ");i=t.multiline?i.map(function(Q){return Q.split(`
`)}):i.map(function(Q){return[Q]});var a=r,s=Jn.internal.getHeight(t)||0;s=s<0?-s:s;var o=Jn.internal.getWidth(t)||0;o=o<0?-o:o;var u=function(Q,H,ne){if(Q+1<i.length){var oe=H+" "+i[Q+1][0];return o2(oe,t,ne).width<=o-4}return!1};a++;e:for(;a>0;){e="",a--;var h,f,g=o2("3",t,a).height,b=t.multiline?s-a:(s-g)/2,v=b+=2,S=0,E=0,P=0;if(a<=0){e=`(...) Tj
`,e+="% Width of Text: "+o2(e,t,a=12).width+", FieldWidth:"+o+`
`;break}for(var k="",L=0,O=0;O<i.length;O++)if(i.hasOwnProperty(O)){var M=!1;if(i[O].length!==1&&P!==i[O].length-1){if((g+2)*(L+2)+2>s)continue e;k+=i[O][P],M=!0,E=O,O--}else{k=(k+=i[O][P]+" ").substr(k.length-1)==" "?k.substr(0,k.length-1):k;var z=parseInt(O),B=u(z,k,a),q=O>=i.length-1;if(B&&!q){k+=" ",P=0;continue}if(B||q){if(q)E=z;else if(t.multiline&&(g+2)*(L+2)+2>s)continue e}else{if(!t.multiline||(g+2)*(L+2)+2>s)continue e;E=z}}for(var W="",G=S;G<=E;G++){var ie=i[G];if(t.multiline){if(G===E){W+=ie[P]+" ",P=(P+1)%ie.length;continue}if(G===S){W+=ie[ie.length-1]+" ";continue}}W+=ie[0]+" "}switch(W=W.substr(W.length-1)==" "?W.substr(0,W.length-1):W,f=o2(W,t,a).width,t.textAlign){case"right":h=o-f-2;break;case"center":h=(o-f)/2;break;default:h=2}e+=ji(h)+" "+ji(v)+` Td
`,e+="("+jm(W)+`) Tj
`,e+=-ji(h)+` 0 Td
`,v=-(a+2),f=0,S=M?E:E+1,L++,k=""}break}return n.text=e,n.fontSize=a,n},o2=function(t,e,r){var n=e.scope.internal.getFont(e.fontName,e.fontStyle),i=e.scope.getStringUnitWidth(t,{font:n,fontSize:parseFloat(r),charSpace:0})*parseFloat(r);return{height:e.scope.getStringUnitWidth("3",{font:n,fontSize:parseFloat(r),charSpace:0})*parseFloat(r)*1.5,width:i}},Jye={fields:[],xForms:[],acroFormDictionaryRoot:null,printedOut:!1,internal:null,isInitialized:!1},Qye=function(t,e){var r={type:"reference",object:t};e.internal.getPageInfo(t.page).pageContext.annotations.find(function(n){return n.type===r.type&&n.object===r.object})===void 0&&e.internal.getPageInfo(t.page).pageContext.annotations.push(r)},eve=function(t,e){if(e.scope=t,t.internal!==void 0&&(t.internal.acroformPlugin===void 0||t.internal.acroformPlugin.isInitialized===!1)){if(df.FieldNum=0,t.internal.acroformPlugin=JSON.parse(JSON.stringify(Jye)),t.internal.acroformPlugin.acroFormDictionaryRoot)throw new Error("Exception while creating AcroformDictionary");cO=t.internal.scaleFactor,t.internal.acroformPlugin.acroFormDictionaryRoot=new bX,t.internal.acroformPlugin.acroFormDictionaryRoot.scope=t,t.internal.acroformPlugin.acroFormDictionaryRoot._eventID=t.internal.events.subscribe("postPutResources",function(){(function(r){r.internal.events.unsubscribe(r.internal.acroformPlugin.acroFormDictionaryRoot._eventID),delete r.internal.acroformPlugin.acroFormDictionaryRoot._eventID,r.internal.acroformPlugin.printedOut=!0})(t)}),t.internal.events.subscribe("buildDocument",function(){(function(r){r.internal.acroformPlugin.acroFormDictionaryRoot.objId=void 0;var n=r.internal.acroformPlugin.acroFormDictionaryRoot.Fields;for(var i in n)if(n.hasOwnProperty(i)){var a=n[i];a.objId=void 0,a.hasAnnotation&&Qye(a,r)}})(t)}),t.internal.events.subscribe("putCatalog",function(){(function(r){if(r.internal.acroformPlugin.acroFormDictionaryRoot===void 0)throw new Error("putCatalogCallback: Root missing.");r.internal.write("/AcroForm "+r.internal.acroformPlugin.acroFormDictionaryRoot.objId+" 0 R")})(t)}),t.internal.events.subscribe("postPutPages",function(r){(function(n,i){var a=!n;for(var s in n||(i.internal.newObjectDeferredBegin(i.internal.acroformPlugin.acroFormDictionaryRoot.objId,!0),i.internal.acroformPlugin.acroFormDictionaryRoot.putStream()),n=n||i.internal.acroformPlugin.acroFormDictionaryRoot.Kids)if(n.hasOwnProperty(s)){var o=n[s],u=[],h=o.Rect;if(o.Rect&&(o.Rect=Zye(o.Rect,i)),i.internal.newObjectDeferredBegin(o.objId,!0),o.DA=Jn.createDefaultAppearanceStream(o),ao(o)==="object"&&typeof o.getKeyValueListForStream=="function"&&(u=o.getKeyValueListForStream()),o.Rect=h,o.hasAppearanceStream&&!o.appearanceStreamContent){var f=Kye(o);u.push({key:"AP",value:"<</N "+f+">>"}),i.internal.acroformPlugin.xForms.push(f)}if(o.appearanceStreamContent){var g="";for(var b in o.appearanceStreamContent)if(o.appearanceStreamContent.hasOwnProperty(b)){var v=o.appearanceStreamContent[b];if(g+="/"+b+" ",g+="<<",Object.keys(v).length>=1||Array.isArray(v)){for(var s in v)if(v.hasOwnProperty(s)){var S=v[s];typeof S=="function"&&(S=S.call(i,o)),g+="/"+s+" "+S+" ",i.internal.acroformPlugin.xForms.indexOf(S)>=0||i.internal.acroformPlugin.xForms.push(S)}}else typeof(S=v)=="function"&&(S=S.call(i,o)),g+="/"+s+" "+S,i.internal.acroformPlugin.xForms.indexOf(S)>=0||i.internal.acroformPlugin.xForms.push(S);g+=">>"}u.push({key:"AP",value:`<<
`+g+">>"})}i.internal.putStream({additionalKeyValues:u,objectId:o.objId}),i.internal.out("endobj")}a&&(function(E,P){for(var k in E)if(E.hasOwnProperty(k)){var L=k,O=E[k];P.internal.newObjectDeferredBegin(O.objId,!0),ao(O)==="object"&&typeof O.putStream=="function"&&O.putStream(),delete E[L]}})(i.internal.acroformPlugin.xForms,i)})(r,t)}),t.internal.acroformPlugin.isInitialized=!0}},vX=Ns.__acroform__.arrayToPdfArray=function(t,e,r){var n=function(s){return s};if(Array.isArray(t)){for(var i="[",a=0;a<t.length;a++)switch(a!==0&&(i+=" "),ao(t[a])){case"boolean":case"number":case"object":i+=t[a].toString();break;case"string":t[a].substr(0,1)!=="/"?(e!==void 0&&r&&(n=r.internal.getEncryptor(e)),i+="("+jm(n(t[a].toString()))+")"):i+=t[a].toString()}return i+"]"}throw new Error("Invalid argument passed to jsPDF.__acroform__.arrayToPdfArray")},R3=function(t,e,r){var n=function(i){return i};return e!==void 0&&r&&(n=r.internal.getEncryptor(e)),(t=t||"").toString(),"("+jm(n(t))+")"},Hf=function(){this._objId=void 0,this._scope=void 0,Object.defineProperty(this,"objId",{get:function(){if(this._objId===void 0){if(this.scope===void 0)return;this._objId=this.scope.internal.newObjectDeferred()}return this._objId},set:function(t){this._objId=t}}),Object.defineProperty(this,"scope",{value:this._scope,writable:!0})};Hf.prototype.toString=function(){return this.objId+" 0 R"},Hf.prototype.putStream=function(){var t=this.getKeyValueListForStream();this.scope.internal.putStream({data:this.stream,additionalKeyValues:t,objectId:this.objId}),this.scope.internal.out("endobj")},Hf.prototype.getKeyValueListForStream=function(){var t=[],e=Object.getOwnPropertyNames(this).filter(function(a){return a!="content"&&a!="appearanceStreamContent"&&a!="scope"&&a!="objId"&&a.substring(0,1)!="_"});for(var r in e)if(Object.getOwnPropertyDescriptor(this,e[r]).configurable===!1){var n=e[r],i=this[n];i&&(Array.isArray(i)?t.push({key:n,value:vX(i,this.objId,this.scope)}):i instanceof Hf?(i.scope=this.scope,t.push({key:n,value:i.objId+" 0 R"})):typeof i!="function"&&t.push({key:n,value:i}))}return t};var _X=function(){Hf.call(this),Object.defineProperty(this,"Type",{value:"/XObject",configurable:!1,writable:!0}),Object.defineProperty(this,"Subtype",{value:"/Form",configurable:!1,writable:!0}),Object.defineProperty(this,"FormType",{value:1,configurable:!1,writable:!0});var t,e=[];Object.defineProperty(this,"BBox",{configurable:!1,get:function(){return e},set:function(r){e=r}}),Object.defineProperty(this,"Resources",{value:"2 0 R",configurable:!1,writable:!0}),Object.defineProperty(this,"stream",{enumerable:!1,configurable:!0,set:function(r){t=r.trim()},get:function(){return t||null}})};Cc(_X,Hf);var bX=function(){Hf.call(this);var t,e=[];Object.defineProperty(this,"Kids",{enumerable:!1,configurable:!0,get:function(){return e.length>0?e:void 0}}),Object.defineProperty(this,"Fields",{enumerable:!1,configurable:!1,get:function(){return e}}),Object.defineProperty(this,"DA",{enumerable:!1,configurable:!1,get:function(){if(t){var r=function(n){return n};return this.scope&&(r=this.scope.internal.getEncryptor(this.objId)),"("+jm(r(t))+")"}},set:function(r){t=r}})};Cc(bX,Hf);var df=function t(){Hf.call(this);var e=4;Object.defineProperty(this,"F",{enumerable:!1,configurable:!1,get:function(){return e},set:function(k){if(isNaN(k))throw new Error('Invalid value "'+k+'" for attribute F supplied.');e=k}}),Object.defineProperty(this,"showWhenPrinted",{enumerable:!0,configurable:!0,get:function(){return!!Gs(e,3)},set:function(k){k?this.F=Xs(e,3):this.F=Ys(e,3)}});var r=0;Object.defineProperty(this,"Ff",{enumerable:!1,configurable:!1,get:function(){return r},set:function(k){if(isNaN(k))throw new Error('Invalid value "'+k+'" for attribute Ff supplied.');r=k}});var n=[];Object.defineProperty(this,"Rect",{enumerable:!1,configurable:!1,get:function(){if(n.length!==0)return n},set:function(k){n=k!==void 0?k:[]}}),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[0])?0:n[0]},set:function(k){n[0]=k}}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[1])?0:n[1]},set:function(k){n[1]=k}}),Object.defineProperty(this,"width",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[2])?0:n[2]},set:function(k){n[2]=k}}),Object.defineProperty(this,"height",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[3])?0:n[3]},set:function(k){n[3]=k}});var i="";Object.defineProperty(this,"FT",{enumerable:!0,configurable:!1,get:function(){return i},set:function(k){switch(k){case"/Btn":case"/Tx":case"/Ch":case"/Sig":i=k;break;default:throw new Error('Invalid value "'+k+'" for attribute FT supplied.')}}});var a=null;Object.defineProperty(this,"T",{enumerable:!0,configurable:!1,get:function(){if(!a||a.length<1){if(this instanceof eS)return;a="FieldObject"+t.FieldNum++}var k=function(L){return L};return this.scope&&(k=this.scope.internal.getEncryptor(this.objId)),"("+jm(k(a))+")"},set:function(k){a=k.toString()}}),Object.defineProperty(this,"fieldName",{configurable:!0,enumerable:!0,get:function(){return a},set:function(k){a=k}});var s="helvetica";Object.defineProperty(this,"fontName",{enumerable:!0,configurable:!0,get:function(){return s},set:function(k){s=k}});var o="normal";Object.defineProperty(this,"fontStyle",{enumerable:!0,configurable:!0,get:function(){return o},set:function(k){o=k}});var u=0;Object.defineProperty(this,"fontSize",{enumerable:!0,configurable:!0,get:function(){return u},set:function(k){u=k}});var h=void 0;Object.defineProperty(this,"maxFontSize",{enumerable:!0,configurable:!0,get:function(){return h===void 0?50/cO:h},set:function(k){h=k}});var f="black";Object.defineProperty(this,"color",{enumerable:!0,configurable:!0,get:function(){return f},set:function(k){f=k}});var g="/F1 0 Tf 0 g";Object.defineProperty(this,"DA",{enumerable:!0,configurable:!1,get:function(){if(!(!g||this instanceof eS||this instanceof am))return R3(g,this.objId,this.scope)},set:function(k){k=k.toString(),g=k}});var b=null;Object.defineProperty(this,"DV",{enumerable:!1,configurable:!1,get:function(){if(b)return this instanceof Zl==0?R3(b,this.objId,this.scope):b},set:function(k){k=k.toString(),b=this instanceof Zl==0?k.substr(0,1)==="("?Ry(k.substr(1,k.length-2)):Ry(k):k}}),Object.defineProperty(this,"defaultValue",{enumerable:!0,configurable:!0,get:function(){return this instanceof Zl==1?Ry(b.substr(1,b.length-1)):b},set:function(k){k=k.toString(),b=this instanceof Zl==1?"/"+k:k}});var v=null;Object.defineProperty(this,"_V",{enumerable:!1,configurable:!1,get:function(){if(v)return v},set:function(k){this.V=k}}),Object.defineProperty(this,"V",{enumerable:!1,configurable:!1,get:function(){if(v)return this instanceof Zl==0?R3(v,this.objId,this.scope):v},set:function(k){k=k.toString(),v=this instanceof Zl==0?k.substr(0,1)==="("?Ry(k.substr(1,k.length-2)):Ry(k):k}}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,get:function(){return this instanceof Zl==1?Ry(v.substr(1,v.length-1)):v},set:function(k){k=k.toString(),v=this instanceof Zl==1?"/"+k:k}}),Object.defineProperty(this,"hasAnnotation",{enumerable:!0,configurable:!0,get:function(){return this.Rect}}),Object.defineProperty(this,"Type",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Annot":null}}),Object.defineProperty(this,"Subtype",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Widget":null}});var S,E=!1;Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return E},set:function(k){k=!!k,E=k}}),Object.defineProperty(this,"page",{enumerable:!0,configurable:!0,get:function(){if(S)return S},set:function(k){S=k}}),Object.defineProperty(this,"readOnly",{enumerable:!0,configurable:!0,get:function(){return!!Gs(this.Ff,1)},set:function(k){k?this.Ff=Xs(this.Ff,1):this.Ff=Ys(this.Ff,1)}}),Object.defineProperty(this,"required",{enumerable:!0,configurable:!0,get:function(){return!!Gs(this.Ff,2)},set:function(k){k?this.Ff=Xs(this.Ff,2):this.Ff=Ys(this.Ff,2)}}),Object.defineProperty(this,"noExport",{enumerable:!0,configurable:!0,get:function(){return!!Gs(this.Ff,3)},set:function(k){k?this.Ff=Xs(this.Ff,3):this.Ff=Ys(this.Ff,3)}});var P=null;Object.defineProperty(this,"Q",{enumerable:!0,configurable:!1,get:function(){if(P!==null)return P},set:function(k){if([0,1,2].indexOf(k)===-1)throw new Error('Invalid value "'+k+'" for attribute Q supplied.');P=k}}),Object.defineProperty(this,"textAlign",{get:function(){var k;switch(P){case 0:default:k="left";break;case 1:k="center";break;case 2:k="right"}return k},configurable:!0,enumerable:!0,set:function(k){switch(k){case"right":case 2:P=2;break;case"center":case 1:P=1;break;default:P=0}}})};Cc(df,Hf);var Uv=function(){df.call(this),this.FT="/Ch",this.V="()",this.fontName="zapfdingbats";var t=0;Object.defineProperty(this,"TI",{enumerable:!0,configurable:!1,get:function(){return t},set:function(r){t=r}}),Object.defineProperty(this,"topIndex",{enumerable:!0,configurable:!0,get:function(){return t},set:function(r){t=r}});var e=[];Object.defineProperty(this,"Opt",{enumerable:!0,configurable:!1,get:function(){return vX(e,this.objId,this.scope)},set:function(r){var n,i;i=[],typeof(n=r)=="string"&&(i=(function(a,s,o){o||(o=1);for(var u,h=[];u=s.exec(a);)h.push(u[o]);return h})(n,/\((.*?)\)/g)),e=i}}),this.getOptions=function(){return e},this.setOptions=function(r){e=r,this.sort&&e.sort()},this.addOption=function(r){r=(r=r||"").toString(),e.push(r),this.sort&&e.sort()},this.removeOption=function(r,n){for(n=n||!1,r=(r=r||"").toString();e.indexOf(r)!==-1&&(e.splice(e.indexOf(r),1),n!==!1););},Object.defineProperty(this,"combo",{enumerable:!0,configurable:!0,get:function(){return!!Gs(this.Ff,18)},set:function(r){r?this.Ff=Xs(this.Ff,18):this.Ff=Ys(this.Ff,18)}}),Object.defineProperty(this,"edit",{enumerable:!0,configurable:!0,get:function(){return!!Gs(this.Ff,19)},set:function(r){this.combo===!0&&(r?this.Ff=Xs(this.Ff,19):this.Ff=Ys(this.Ff,19))}}),Object.defineProperty(this,"sort",{enumerable:!0,configurable:!0,get:function(){return!!Gs(this.Ff,20)},set:function(r){r?(this.Ff=Xs(this.Ff,20),e.sort()):this.Ff=Ys(this.Ff,20)}}),Object.defineProperty(this,"multiSelect",{enumerable:!0,configurable:!0,get:function(){return!!Gs(this.Ff,22)},set:function(r){r?this.Ff=Xs(this.Ff,22):this.Ff=Ys(this.Ff,22)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!Gs(this.Ff,23)},set:function(r){r?this.Ff=Xs(this.Ff,23):this.Ff=Ys(this.Ff,23)}}),Object.defineProperty(this,"commitOnSelChange",{enumerable:!0,configurable:!0,get:function(){return!!Gs(this.Ff,27)},set:function(r){r?this.Ff=Xs(this.Ff,27):this.Ff=Ys(this.Ff,27)}}),this.hasAppearanceStream=!1};Cc(Uv,df);var Vv=function(){Uv.call(this),this.fontName="helvetica",this.combo=!1};Cc(Vv,Uv);var $v=function(){Vv.call(this),this.combo=!0};Cc($v,Vv);var dw=function(){$v.call(this),this.edit=!0};Cc(dw,$v);var Zl=function(){df.call(this),this.FT="/Btn",Object.defineProperty(this,"noToggleToOff",{enumerable:!0,configurable:!0,get:function(){return!!Gs(this.Ff,15)},set:function(r){r?this.Ff=Xs(this.Ff,15):this.Ff=Ys(this.Ff,15)}}),Object.defineProperty(this,"radio",{enumerable:!0,configurable:!0,get:function(){return!!Gs(this.Ff,16)},set:function(r){r?this.Ff=Xs(this.Ff,16):this.Ff=Ys(this.Ff,16)}}),Object.defineProperty(this,"pushButton",{enumerable:!0,configurable:!0,get:function(){return!!Gs(this.Ff,17)},set:function(r){r?this.Ff=Xs(this.Ff,17):this.Ff=Ys(this.Ff,17)}}),Object.defineProperty(this,"radioIsUnison",{enumerable:!0,configurable:!0,get:function(){return!!Gs(this.Ff,26)},set:function(r){r?this.Ff=Xs(this.Ff,26):this.Ff=Ys(this.Ff,26)}});var t,e={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var r=function(a){return a};if(this.scope&&(r=this.scope.internal.getEncryptor(this.objId)),Object.keys(e).length!==0){var n,i=[];for(n in i.push("<<"),e)i.push("/"+n+" ("+jm(r(e[n]))+")");return i.push(">>"),i.join(`
`)}},set:function(r){ao(r)==="object"&&(e=r)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return e.CA||""},set:function(r){typeof r=="string"&&(e.CA=r)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return t},set:function(r){t=r}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return t.substr(1,t.length-1)},set:function(r){t="/"+r}})};Cc(Zl,df);var pw=function(){Zl.call(this),this.pushButton=!0};Cc(pw,Zl);var qv=function(){Zl.call(this),this.radio=!0,this.pushButton=!1;var t=[];Object.defineProperty(this,"Kids",{enumerable:!0,configurable:!1,get:function(){return t},set:function(e){t=e!==void 0?e:[]}})};Cc(qv,Zl);var eS=function(){var t,e;df.call(this),Object.defineProperty(this,"Parent",{enumerable:!1,configurable:!1,get:function(){return t},set:function(i){t=i}}),Object.defineProperty(this,"optionName",{enumerable:!1,configurable:!0,get:function(){return e},set:function(i){e=i}});var r,n={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var i=function(o){return o};this.scope&&(i=this.scope.internal.getEncryptor(this.objId));var a,s=[];for(a in s.push("<<"),n)s.push("/"+a+" ("+jm(i(n[a]))+")");return s.push(">>"),s.join(`
`)},set:function(i){ao(i)==="object"&&(n=i)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return n.CA||""},set:function(i){typeof i=="string"&&(n.CA=i)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return r},set:function(i){r=i}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return r.substr(1,r.length-1)},set:function(i){r="/"+i}}),this.caption="l",this.appearanceState="Off",this._AppearanceType=Jn.RadioButton.Circle,this.appearanceStreamContent=this._AppearanceType.createAppearanceStream(this.optionName)};Cc(eS,df),qv.prototype.setAppearance=function(t){if(!("createAppearanceStream"in t)||!("getCA"in t))throw new Error("Couldn't assign Appearance to RadioButton. Appearance was Invalid!");for(var e in this.Kids)if(this.Kids.hasOwnProperty(e)){var r=this.Kids[e];r.appearanceStreamContent=t.createAppearanceStream(r.optionName),r.caption=t.getCA()}},qv.prototype.createOption=function(t){var e=new eS;return e.Parent=this,e.optionName=t,this.Kids.push(e),tve.call(this.scope,e),e};var gw=function(){Zl.call(this),this.fontName="zapfdingbats",this.caption="3",this.appearanceState="On",this.value="On",this.textAlign="center",this.appearanceStreamContent=Jn.CheckBox.createAppearanceStream()};Cc(gw,Zl);var am=function(){df.call(this),this.FT="/Tx",Object.defineProperty(this,"multiline",{enumerable:!0,configurable:!0,get:function(){return!!Gs(this.Ff,13)},set:function(e){e?this.Ff=Xs(this.Ff,13):this.Ff=Ys(this.Ff,13)}}),Object.defineProperty(this,"fileSelect",{enumerable:!0,configurable:!0,get:function(){return!!Gs(this.Ff,21)},set:function(e){e?this.Ff=Xs(this.Ff,21):this.Ff=Ys(this.Ff,21)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!Gs(this.Ff,23)},set:function(e){e?this.Ff=Xs(this.Ff,23):this.Ff=Ys(this.Ff,23)}}),Object.defineProperty(this,"doNotScroll",{enumerable:!0,configurable:!0,get:function(){return!!Gs(this.Ff,24)},set:function(e){e?this.Ff=Xs(this.Ff,24):this.Ff=Ys(this.Ff,24)}}),Object.defineProperty(this,"comb",{enumerable:!0,configurable:!0,get:function(){return!!Gs(this.Ff,25)},set:function(e){e?this.Ff=Xs(this.Ff,25):this.Ff=Ys(this.Ff,25)}}),Object.defineProperty(this,"richText",{enumerable:!0,configurable:!0,get:function(){return!!Gs(this.Ff,26)},set:function(e){e?this.Ff=Xs(this.Ff,26):this.Ff=Ys(this.Ff,26)}});var t=null;Object.defineProperty(this,"MaxLen",{enumerable:!0,configurable:!1,get:function(){return t},set:function(e){t=e}}),Object.defineProperty(this,"maxLength",{enumerable:!0,configurable:!0,get:function(){return t},set:function(e){Number.isInteger(e)&&(t=e)}}),Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return this.V||this.DV}})};Cc(am,df);var mw=function(){am.call(this),Object.defineProperty(this,"password",{enumerable:!0,configurable:!0,get:function(){return!!Gs(this.Ff,14)},set:function(t){t?this.Ff=Xs(this.Ff,14):this.Ff=Ys(this.Ff,14)}}),this.password=!0};Cc(mw,am);var Jn={CheckBox:{createAppearanceStream:function(){return{N:{On:Jn.CheckBox.YesNormal},D:{On:Jn.CheckBox.YesPushDown,Off:Jn.CheckBox.OffPushDown}}},YesPushDown:function(t){var e=Bf(t);e.scope=t.scope;var r=[],n=t.scope.internal.getFont(t.fontName,t.fontStyle).id,i=t.scope.__private__.encodeColorString(t.color),a=WP(t,t.caption);return r.push("0.749023 g"),r.push("0 0 "+ji(Jn.internal.getWidth(t))+" "+ji(Jn.internal.getHeight(t))+" re"),r.push("f"),r.push("BMC"),r.push("q"),r.push("0 0 1 rg"),r.push("/"+n+" "+ji(a.fontSize)+" Tf "+i),r.push("BT"),r.push(a.text),r.push("ET"),r.push("Q"),r.push("EMC"),e.stream=r.join(`
`),e},YesNormal:function(t){var e=Bf(t);e.scope=t.scope;var r=t.scope.internal.getFont(t.fontName,t.fontStyle).id,n=t.scope.__private__.encodeColorString(t.color),i=[],a=Jn.internal.getHeight(t),s=Jn.internal.getWidth(t),o=WP(t,t.caption);return i.push("1 g"),i.push("0 0 "+ji(s)+" "+ji(a)+" re"),i.push("f"),i.push("q"),i.push("0 0 1 rg"),i.push("0 0 "+ji(s-1)+" "+ji(a-1)+" re"),i.push("W"),i.push("n"),i.push("0 g"),i.push("BT"),i.push("/"+r+" "+ji(o.fontSize)+" Tf "+n),i.push(o.text),i.push("ET"),i.push("Q"),e.stream=i.join(`
`),e},OffPushDown:function(t){var e=Bf(t);e.scope=t.scope;var r=[];return r.push("0.749023 g"),r.push("0 0 "+ji(Jn.internal.getWidth(t))+" "+ji(Jn.internal.getHeight(t))+" re"),r.push("f"),e.stream=r.join(`
`),e}},RadioButton:{Circle:{createAppearanceStream:function(t){var e={D:{Off:Jn.RadioButton.Circle.OffPushDown},N:{}};return e.N[t]=Jn.RadioButton.Circle.YesNormal,e.D[t]=Jn.RadioButton.Circle.YesPushDown,e},getCA:function(){return"l"},YesNormal:function(t){var e=Bf(t);e.scope=t.scope;var r=[],n=Jn.internal.getWidth(t)<=Jn.internal.getHeight(t)?Jn.internal.getWidth(t)/4:Jn.internal.getHeight(t)/4;n=Number((.9*n).toFixed(5));var i=Jn.internal.Bezier_C,a=Number((n*i).toFixed(5));return r.push("q"),r.push("1 0 0 1 "+xp(Jn.internal.getWidth(t)/2)+" "+xp(Jn.internal.getHeight(t)/2)+" cm"),r.push(n+" 0 m"),r.push(n+" "+a+" "+a+" "+n+" 0 "+n+" c"),r.push("-"+a+" "+n+" -"+n+" "+a+" -"+n+" 0 c"),r.push("-"+n+" -"+a+" -"+a+" -"+n+" 0 -"+n+" c"),r.push(a+" -"+n+" "+n+" -"+a+" "+n+" 0 c"),r.push("f"),r.push("Q"),e.stream=r.join(`
`),e},YesPushDown:function(t){var e=Bf(t);e.scope=t.scope;var r=[],n=Jn.internal.getWidth(t)<=Jn.internal.getHeight(t)?Jn.internal.getWidth(t)/4:Jn.internal.getHeight(t)/4;n=Number((.9*n).toFixed(5));var i=Number((2*n).toFixed(5)),a=Number((i*Jn.internal.Bezier_C).toFixed(5)),s=Number((n*Jn.internal.Bezier_C).toFixed(5));return r.push("0.749023 g"),r.push("q"),r.push("1 0 0 1 "+xp(Jn.internal.getWidth(t)/2)+" "+xp(Jn.internal.getHeight(t)/2)+" cm"),r.push(i+" 0 m"),r.push(i+" "+a+" "+a+" "+i+" 0 "+i+" c"),r.push("-"+a+" "+i+" -"+i+" "+a+" -"+i+" 0 c"),r.push("-"+i+" -"+a+" -"+a+" -"+i+" 0 -"+i+" c"),r.push(a+" -"+i+" "+i+" -"+a+" "+i+" 0 c"),r.push("f"),r.push("Q"),r.push("0 g"),r.push("q"),r.push("1 0 0 1 "+xp(Jn.internal.getWidth(t)/2)+" "+xp(Jn.internal.getHeight(t)/2)+" cm"),r.push(n+" 0 m"),r.push(n+" "+s+" "+s+" "+n+" 0 "+n+" c"),r.push("-"+s+" "+n+" -"+n+" "+s+" -"+n+" 0 c"),r.push("-"+n+" -"+s+" -"+s+" -"+n+" 0 -"+n+" c"),r.push(s+" -"+n+" "+n+" -"+s+" "+n+" 0 c"),r.push("f"),r.push("Q"),e.stream=r.join(`
`),e},OffPushDown:function(t){var e=Bf(t);e.scope=t.scope;var r=[],n=Jn.internal.getWidth(t)<=Jn.internal.getHeight(t)?Jn.internal.getWidth(t)/4:Jn.internal.getHeight(t)/4;n=Number((.9*n).toFixed(5));var i=Number((2*n).toFixed(5)),a=Number((i*Jn.internal.Bezier_C).toFixed(5));return r.push("0.749023 g"),r.push("q"),r.push("1 0 0 1 "+xp(Jn.internal.getWidth(t)/2)+" "+xp(Jn.internal.getHeight(t)/2)+" cm"),r.push(i+" 0 m"),r.push(i+" "+a+" "+a+" "+i+" 0 "+i+" c"),r.push("-"+a+" "+i+" -"+i+" "+a+" -"+i+" 0 c"),r.push("-"+i+" -"+a+" -"+a+" -"+i+" 0 -"+i+" c"),r.push(a+" -"+i+" "+i+" -"+a+" "+i+" 0 c"),r.push("f"),r.push("Q"),e.stream=r.join(`
`),e}},Cross:{createAppearanceStream:function(t){var e={D:{Off:Jn.RadioButton.Cross.OffPushDown},N:{}};return e.N[t]=Jn.RadioButton.Cross.YesNormal,e.D[t]=Jn.RadioButton.Cross.YesPushDown,e},getCA:function(){return"8"},YesNormal:function(t){var e=Bf(t);e.scope=t.scope;var r=[],n=Jn.internal.calculateCross(t);return r.push("q"),r.push("1 1 "+ji(Jn.internal.getWidth(t)-2)+" "+ji(Jn.internal.getHeight(t)-2)+" re"),r.push("W"),r.push("n"),r.push(ji(n.x1.x)+" "+ji(n.x1.y)+" m"),r.push(ji(n.x2.x)+" "+ji(n.x2.y)+" l"),r.push(ji(n.x4.x)+" "+ji(n.x4.y)+" m"),r.push(ji(n.x3.x)+" "+ji(n.x3.y)+" l"),r.push("s"),r.push("Q"),e.stream=r.join(`
`),e},YesPushDown:function(t){var e=Bf(t);e.scope=t.scope;var r=Jn.internal.calculateCross(t),n=[];return n.push("0.749023 g"),n.push("0 0 "+ji(Jn.internal.getWidth(t))+" "+ji(Jn.internal.getHeight(t))+" re"),n.push("f"),n.push("q"),n.push("1 1 "+ji(Jn.internal.getWidth(t)-2)+" "+ji(Jn.internal.getHeight(t)-2)+" re"),n.push("W"),n.push("n"),n.push(ji(r.x1.x)+" "+ji(r.x1.y)+" m"),n.push(ji(r.x2.x)+" "+ji(r.x2.y)+" l"),n.push(ji(r.x4.x)+" "+ji(r.x4.y)+" m"),n.push(ji(r.x3.x)+" "+ji(r.x3.y)+" l"),n.push("s"),n.push("Q"),e.stream=n.join(`
`),e},OffPushDown:function(t){var e=Bf(t);e.scope=t.scope;var r=[];return r.push("0.749023 g"),r.push("0 0 "+ji(Jn.internal.getWidth(t))+" "+ji(Jn.internal.getHeight(t))+" re"),r.push("f"),e.stream=r.join(`
`),e}}},createDefaultAppearanceStream:function(t){var e=t.scope.internal.getFont(t.fontName,t.fontStyle).id,r=t.scope.__private__.encodeColorString(t.color);return"/"+e+" "+t.fontSize+" Tf "+r}};Jn.internal={Bezier_C:.551915024494,calculateCross:function(t){var e=Jn.internal.getWidth(t),r=Jn.internal.getHeight(t),n=Math.min(e,r);return{x1:{x:(e-n)/2,y:(r-n)/2+n},x2:{x:(e-n)/2+n,y:(r-n)/2},x3:{x:(e-n)/2,y:(r-n)/2},x4:{x:(e-n)/2+n,y:(r-n)/2+n}}}},Jn.internal.getWidth=function(t){var e=0;return ao(t)==="object"&&(e=vB(t.Rect[2])),e},Jn.internal.getHeight=function(t){var e=0;return ao(t)==="object"&&(e=vB(t.Rect[3])),e};var tve=Ns.addField=function(t){if(eve(this,t),!(t instanceof df))throw new Error("Invalid argument passed to jsPDF.addField.");var e;return(e=t).scope.internal.acroformPlugin.printedOut&&(e.scope.internal.acroformPlugin.printedOut=!1,e.scope.internal.acroformPlugin.acroFormDictionaryRoot=null),e.scope.internal.acroformPlugin.acroFormDictionaryRoot.Fields.push(e),t.page=t.scope.internal.getCurrentPageInfo().pageNumber,this};Ns.AcroFormChoiceField=Uv,Ns.AcroFormListBox=Vv,Ns.AcroFormComboBox=$v,Ns.AcroFormEditBox=dw,Ns.AcroFormButton=Zl,Ns.AcroFormPushButton=pw,Ns.AcroFormRadioButton=qv,Ns.AcroFormCheckBox=gw,Ns.AcroFormTextField=am,Ns.AcroFormPasswordField=mw,Ns.AcroFormAppearance=Jn,Ns.AcroForm={ChoiceField:Uv,ListBox:Vv,ComboBox:$v,EditBox:dw,Button:Zl,PushButton:pw,RadioButton:qv,CheckBox:gw,TextField:am,PasswordField:mw,Appearance:Jn},li.AcroForm={ChoiceField:Uv,ListBox:Vv,ComboBox:$v,EditBox:dw,Button:Zl,PushButton:pw,RadioButton:qv,CheckBox:gw,TextField:am,PasswordField:mw,Appearance:Jn};li.AcroForm;function xX(t){return t.reduce(function(e,r,n){return e[r]=n,e},{})}(function(t){var e="addImage_";t.__addimage__={};var r="UNKNOWN",n={PNG:[[137,80,78,71]],TIFF:[[77,77,0,42],[73,73,42,0]],JPEG:[[255,216,255,224,void 0,void 0,74,70,73,70,0],[255,216,255,225,void 0,void 0,69,120,105,102,0,0],[255,216,255,219],[255,216,255,238]],JPEG2000:[[0,0,0,12,106,80,32,32]],GIF87a:[[71,73,70,56,55,97]],GIF89a:[[71,73,70,56,57,97]],WEBP:[[82,73,70,70,void 0,void 0,void 0,void 0,87,69,66,80]],BMP:[[66,77],[66,65],[67,73],[67,80],[73,67],[80,84]]},i=t.__addimage__.getImageFileTypeByImageData=function(Q,H){var ne,oe,ce,fe,Me,me=r;if((H=H||r)==="RGBA"||Q.data!==void 0&&Q.data instanceof Uint8ClampedArray&&"height"in Q&&"width"in Q)return"RGBA";if(B(Q))for(Me in n)for(ce=n[Me],ne=0;ne<ce.length;ne+=1){for(fe=!0,oe=0;oe<ce[ne].length;oe+=1)if(ce[ne][oe]!==void 0&&ce[ne][oe]!==Q[oe]){fe=!1;break}if(fe===!0){me=Me;break}}else for(Me in n)for(ce=n[Me],ne=0;ne<ce.length;ne+=1){for(fe=!0,oe=0;oe<ce[ne].length;oe+=1)if(ce[ne][oe]!==void 0&&ce[ne][oe]!==Q.charCodeAt(oe)){fe=!1;break}if(fe===!0){me=Me;break}}return me===r&&H!==r&&(me=H),me},a=function Q(H){for(var ne=this.internal.write,oe=this.internal.putStream,ce=(0,this.internal.getFilters)();ce.indexOf("FlateEncode")!==-1;)ce.splice(ce.indexOf("FlateEncode"),1);H.objectId=this.internal.newObject();var fe=[];if(fe.push({key:"Type",value:"/XObject"}),fe.push({key:"Subtype",value:"/Image"}),fe.push({key:"Width",value:H.width}),fe.push({key:"Height",value:H.height}),H.colorSpace===k.INDEXED?fe.push({key:"ColorSpace",value:"[/Indexed /DeviceRGB "+(H.palette.length/3-1)+" "+("sMask"in H&&H.sMask!==void 0?H.objectId+2:H.objectId+1)+" 0 R]"}):(fe.push({key:"ColorSpace",value:"/"+H.colorSpace}),H.colorSpace===k.DEVICE_CMYK&&fe.push({key:"Decode",value:"[1 0 1 0 1 0 1 0]"})),fe.push({key:"BitsPerComponent",value:H.bitsPerComponent}),"decodeParameters"in H&&H.decodeParameters!==void 0&&fe.push({key:"DecodeParms",value:"<<"+H.decodeParameters+">>"}),"transparency"in H&&Array.isArray(H.transparency)){for(var Me="",me=0,we=H.transparency.length;me<we;me++)Me+=H.transparency[me]+" "+H.transparency[me]+" ";fe.push({key:"Mask",value:"["+Me+"]"})}H.sMask!==void 0&&fe.push({key:"SMask",value:H.objectId+1+" 0 R"});var Te=H.filter!==void 0?["/"+H.filter]:void 0;if(oe({data:H.data,additionalKeyValues:fe,alreadyAppliedFilters:Te,objectId:H.objectId}),ne("endobj"),"sMask"in H&&H.sMask!==void 0){var ke=(H.predictor!=null?"/Predictor "+H.predictor:"")+" /Colors 1 /BitsPerComponent 8 /Columns "+H.width,he={width:H.width,height:H.height,colorSpace:"DeviceGray",bitsPerComponent:H.bitsPerComponent,decodeParameters:ke,data:H.sMask};"filter"in H&&(he.filter=H.filter),Q.call(this,he)}if(H.colorSpace===k.INDEXED){var Ee=this.internal.newObject();oe({data:W(new Uint8Array(H.palette)),objectId:Ee}),ne("endobj")}},s=function(){var Q=this.internal.collections[e+"images"];for(var H in Q)a.call(this,Q[H])},o=function(){var Q,H=this.internal.collections[e+"images"],ne=this.internal.write;for(var oe in H)ne("/I"+(Q=H[oe]).index,Q.objectId,"0","R")},u=function(){this.internal.collections[e+"images"]||(this.internal.collections[e+"images"]={},this.internal.events.subscribe("putResources",s),this.internal.events.subscribe("putXobjectDict",o))},h=function(){var Q=this.internal.collections[e+"images"];return u.call(this),Q},f=function(){return Object.keys(this.internal.collections[e+"images"]).length},g=function(Q){return typeof t["process"+Q.toUpperCase()]=="function"},b=function(Q){return ao(Q)==="object"&&Q.nodeType===1},v=function(Q,H){if(Q.nodeName==="IMG"&&Q.hasAttribute("src")){var ne=""+Q.getAttribute("src");if(ne.indexOf("data:image/")===0)return fw(unescape(ne).split("base64,").pop());var oe=t.loadFile(ne,!0);if(oe!==void 0)return oe}if(Q.nodeName==="CANVAS"){if(Q.width===0||Q.height===0)throw new Error("Given canvas must have data. Canvas width: "+Q.width+", height: "+Q.height);var ce;switch(H){case"PNG":ce="image/png";break;case"WEBP":ce="image/webp";break;default:ce="image/jpeg"}return fw(Q.toDataURL(ce,1).split("base64,").pop())}},S=function(Q){var H=this.internal.collections[e+"images"];if(H){for(var ne in H)if(Q===H[ne].alias)return H[ne]}},E=function(Q,H,ne){return Q||H||(Q=-96,H=-96),Q<0&&(Q=-1*ne.width*72/Q/this.internal.scaleFactor),H<0&&(H=-1*ne.height*72/H/this.internal.scaleFactor),Q===0&&(Q=H*ne.width/ne.height),H===0&&(H=Q*ne.height/ne.width),[Q,H]},P=function(Q,H,ne,oe,ce,fe){var Me=E.call(this,ne,oe,ce),me=this.internal.getCoordinateString,we=this.internal.getVerticalCoordinateString,Te=h.call(this);if(ne=Me[0],oe=Me[1],Te[ce.index]=ce,fe){fe*=Math.PI/180;var ke=Math.cos(fe),he=Math.sin(fe),Ee=function(Ne){return Ne.toFixed(4)},xe=[Ee(ke),Ee(he),Ee(-1*he),Ee(ke),0,0,"cm"]}this.internal.write("q"),fe?(this.internal.write([1,"0","0",1,me(Q),we(H+oe),"cm"].join(" ")),this.internal.write(xe.join(" ")),this.internal.write([me(ne),"0","0",me(oe),"0","0","cm"].join(" "))):this.internal.write([me(ne),"0","0",me(oe),me(Q),we(H+oe),"cm"].join(" ")),this.isAdvancedAPI()&&this.internal.write([1,0,0,-1,0,0,"cm"].join(" ")),this.internal.write("/I"+ce.index+" Do"),this.internal.write("Q")},k=t.color_spaces={DEVICE_RGB:"DeviceRGB",DEVICE_GRAY:"DeviceGray",DEVICE_CMYK:"DeviceCMYK",CAL_GREY:"CalGray",CAL_RGB:"CalRGB",LAB:"Lab",ICC_BASED:"ICCBased",INDEXED:"Indexed",PATTERN:"Pattern",SEPARATION:"Separation",DEVICE_N:"DeviceN"};t.decode={DCT_DECODE:"DCTDecode",FLATE_DECODE:"FlateDecode",LZW_DECODE:"LZWDecode",JPX_DECODE:"JPXDecode",JBIG2_DECODE:"JBIG2Decode",ASCII85_DECODE:"ASCII85Decode",ASCII_HEX_DECODE:"ASCIIHexDecode",RUN_LENGTH_DECODE:"RunLengthDecode",CCITT_FAX_DECODE:"CCITTFaxDecode"};var L=t.image_compression={NONE:"NONE",FAST:"FAST",MEDIUM:"MEDIUM",SLOW:"SLOW"},O=t.__addimage__.sHashCode=function(Q){var H,ne,oe=0;if(typeof Q=="string")for(ne=Q.length,H=0;H<ne;H++)oe=(oe<<5)-oe+Q.charCodeAt(H),oe|=0;else if(B(Q))for(ne=Q.byteLength/2,H=0;H<ne;H++)oe=(oe<<5)-oe+Q[H],oe|=0;return oe},M=t.__addimage__.validateStringAsBase64=function(Q){(Q=Q||"").toString().trim();var H=!0;return Q.length===0&&(H=!1),Q.length%4!=0&&(H=!1),/^[A-Za-z0-9+/]+$/.test(Q.substr(0,Q.length-2))===!1&&(H=!1),/^[A-Za-z0-9/][A-Za-z0-9+/]|[A-Za-z0-9+/]=|==$/.test(Q.substr(-2))===!1&&(H=!1),H},z=t.__addimage__.extractImageFromDataUrl=function(Q){if(Q==null||!(Q=Q.trim()).startsWith("data:"))return null;var H=Q.indexOf(",");return H<0?null:Q.substring(0,H).trim().endsWith("base64")?Q.substring(H+1):null};t.__addimage__.isArrayBuffer=function(Q){return Q instanceof ArrayBuffer};var B=t.__addimage__.isArrayBufferView=function(Q){return Q instanceof Int8Array||Q instanceof Uint8Array||Q instanceof Uint8ClampedArray||Q instanceof Int16Array||Q instanceof Uint16Array||Q instanceof Int32Array||Q instanceof Uint32Array||Q instanceof Float32Array||Q instanceof Float64Array},q=t.__addimage__.binaryStringToUint8Array=function(Q){for(var H=Q.length,ne=new Uint8Array(H),oe=0;oe<H;oe++)ne[oe]=Q.charCodeAt(oe);return ne},W=t.__addimage__.arrayBufferToBinaryString=function(Q){for(var H="",ne=B(Q)?Q:new Uint8Array(Q),oe=0;oe<ne.length;oe+=8192)H+=String.fromCharCode.apply(null,ne.subarray(oe,oe+8192));return H};t.addImage=function(){var Q,H,ne,oe,ce,fe,Me,me,we;if(typeof arguments[1]=="number"?(H=r,ne=arguments[1],oe=arguments[2],ce=arguments[3],fe=arguments[4],Me=arguments[5],me=arguments[6],we=arguments[7]):(H=arguments[1],ne=arguments[2],oe=arguments[3],ce=arguments[4],fe=arguments[5],Me=arguments[6],me=arguments[7],we=arguments[8]),ao(Q=arguments[0])==="object"&&!b(Q)&&"imageData"in Q){var Te=Q;Q=Te.imageData,H=Te.format||H||r,ne=Te.x||ne||0,oe=Te.y||oe||0,ce=Te.w||Te.width||ce,fe=Te.h||Te.height||fe,Me=Te.alias||Me,me=Te.compression||me,we=Te.rotation||Te.angle||we}var ke=this.internal.getFilters();if(me===void 0&&ke.indexOf("FlateEncode")!==-1&&(me="SLOW"),isNaN(ne)||isNaN(oe))throw new Error("Invalid coordinates passed to jsPDF.addImage");u.call(this);var he=G.call(this,Q,H,Me,me);return P.call(this,ne,oe,ce,fe,he,we),this};var G=function(Q,H,ne,oe){var ce,fe,Me;if(typeof Q=="string"&&i(Q)===r){Q=unescape(Q);var me=ie(Q,!1);(me!==""||(me=t.loadFile(Q,!0))!==void 0)&&(Q=me)}if(b(Q)&&(Q=v(Q,H)),H=i(Q,H),!g(H))throw new Error("addImage does not support files of type '"+H+"', please ensure that a plugin for '"+H+"' support is added.");if(((Me=ne)==null||Me.length===0)&&(ne=(function(we){return typeof we=="string"||B(we)?O(we):B(we.data)?O(we.data):null})(Q)),(ce=S.call(this,ne))||(Q instanceof Uint8Array||H==="RGBA"||(fe=Q,Q=q(Q)),ce=this["process"+H.toUpperCase()](Q,f.call(this),ne,(function(we){return we&&typeof we=="string"&&(we=we.toUpperCase()),we in t.image_compression?we:L.NONE})(oe),fe)),!ce)throw new Error("An unknown error occurred whilst processing the image.");return ce},ie=t.__addimage__.convertBase64ToBinaryString=function(Q,H){H=typeof H!="boolean"||H;var ne,oe="";if(typeof Q=="string"){var ce;ne=(ce=z(Q))!==null&&ce!==void 0?ce:Q;try{oe=fw(ne)}catch(fe){if(H)throw M(ne)?new Error("atob-Error in jsPDF.convertBase64ToBinaryString "+fe.message):new Error("Supplied Data is not a valid base64-String jsPDF.convertBase64ToBinaryString ")}}return oe};t.getImageProperties=function(Q){var H,ne,oe="";if(b(Q)&&(Q=v(Q)),typeof Q=="string"&&i(Q)===r&&((oe=ie(Q,!1))===""&&(oe=t.loadFile(Q)||""),Q=oe),ne=i(Q),!g(ne))throw new Error("addImage does not support files of type '"+ne+"', please ensure that a plugin for '"+ne+"' support is added.");if(Q instanceof Uint8Array||(Q=q(Q)),!(H=this["process"+ne.toUpperCase()](Q)))throw new Error("An unknown error occurred whilst processing the image");return H.fileType=ne,H}})(li.API),(function(t){var e=function(r){if(r!==void 0&&r!="")return!0};li.API.events.push(["addPage",function(r){this.internal.getPageInfo(r.pageNumber).pageContext.annotations=[]}]),t.events.push(["putPage",function(r){for(var n,i,a,s=this.internal.getCoordinateString,o=this.internal.getVerticalCoordinateString,u=this.internal.getPageInfoByObjId(r.objId),h=r.pageContext.annotations,f=!1,g=0;g<h.length&&!f;g++)switch((n=h[g]).type){case"link":(e(n.options.url)||e(n.options.pageNumber))&&(f=!0);break;case"reference":case"text":case"freetext":f=!0}if(f!=0){this.internal.write("/Annots [");for(var b=0;b<h.length;b++){n=h[b];var v=this.internal.pdfEscape,S=this.internal.getEncryptor(r.objId);switch(n.type){case"reference":this.internal.write(" "+n.object.objId+" 0 R ");break;case"text":var E=this.internal.newAdditionalObject(),P=this.internal.newAdditionalObject(),k=this.internal.getEncryptor(E.objId),L=n.title||"Note";a="<</Type /Annot /Subtype /Text "+(i="/Rect ["+s(n.bounds.x)+" "+o(n.bounds.y+n.bounds.h)+" "+s(n.bounds.x+n.bounds.w)+" "+o(n.bounds.y)+"] ")+"/Contents ("+v(k(n.contents))+")",a+=" /Popup "+P.objId+" 0 R",a+=" /P "+u.objId+" 0 R",a+=" /T ("+v(k(L))+") >>",E.content=a;var O=E.objId+" 0 R";a="<</Type /Annot /Subtype /Popup "+(i="/Rect ["+s(n.bounds.x+30)+" "+o(n.bounds.y+n.bounds.h)+" "+s(n.bounds.x+n.bounds.w+30)+" "+o(n.bounds.y)+"] ")+" /Parent "+O,n.open&&(a+=" /Open true"),a+=" >>",P.content=a,this.internal.write(E.objId,"0 R",P.objId,"0 R");break;case"freetext":i="/Rect ["+s(n.bounds.x)+" "+o(n.bounds.y)+" "+s(n.bounds.x+n.bounds.w)+" "+o(n.bounds.y+n.bounds.h)+"] ";var M=n.color||"#000000";a="<</Type /Annot /Subtype /FreeText "+i+"/Contents ("+v(S(n.contents))+")",a+=" /DS(font: Helvetica,sans-serif 12.0pt; text-align:left; color:#"+M+")",a+=" /Border [0 0 0]",a+=" >>",this.internal.write(a);break;case"link":if(n.options.name){var z=this.annotations._nameMap[n.options.name];n.options.pageNumber=z.page,n.options.top=z.y}else n.options.top||(n.options.top=0);if(i="/Rect ["+n.finalBounds.x+" "+n.finalBounds.y+" "+n.finalBounds.w+" "+n.finalBounds.h+"] ",a="",n.options.url)a="<</Type /Annot /Subtype /Link "+i+"/Border [0 0 0] /A <</S /URI /URI ("+v(S(n.options.url))+") >>";else if(n.options.pageNumber)switch(a="<</Type /Annot /Subtype /Link "+i+"/Border [0 0 0] /Dest ["+this.internal.getPageInfo(n.options.pageNumber).objId+" 0 R",n.options.magFactor=n.options.magFactor||"XYZ",n.options.magFactor){case"Fit":a+=" /Fit]";break;case"FitH":a+=" /FitH "+n.options.top+"]";break;case"FitV":n.options.left=n.options.left||0,a+=" /FitV "+n.options.left+"]";break;default:var B=o(n.options.top);n.options.left=n.options.left||0,n.options.zoom===void 0&&(n.options.zoom=0),a+=" /XYZ "+n.options.left+" "+B+" "+n.options.zoom+"]"}a!=""&&(a+=" >>",this.internal.write(a))}}this.internal.write("]")}}]),t.createAnnotation=function(r){var n=this.internal.getCurrentPageInfo();switch(r.type){case"link":this.link(r.bounds.x,r.bounds.y,r.bounds.w,r.bounds.h,r);break;case"text":case"freetext":n.pageContext.annotations.push(r)}},t.link=function(r,n,i,a,s){var o=this.internal.getCurrentPageInfo(),u=this.internal.getCoordinateString,h=this.internal.getVerticalCoordinateString;o.pageContext.annotations.push({finalBounds:{x:u(r),y:h(n),w:u(r+i),h:h(n+a)},options:s,type:"link"})},t.textWithLink=function(r,n,i,a){var s,o,u=this.getTextWidth(r),h=this.internal.getLineHeight()/this.internal.scaleFactor;if(a.maxWidth!==void 0){o=a.maxWidth;var f=this.splitTextToSize(r,o).length;s=Math.ceil(h*f)}else o=u,s=h;return this.text(r,n,i,a),i+=.2*h,a.align==="center"&&(n-=u/2),a.align==="right"&&(n-=u),this.link(n,i-h,o,s,a),u},t.getTextWidth=function(r){var n=this.internal.getFontSize();return this.getStringUnitWidth(r)*n/this.internal.scaleFactor}})(li.API),(function(t){var e={1569:[65152],1570:[65153,65154],1571:[65155,65156],1572:[65157,65158],1573:[65159,65160],1574:[65161,65162,65163,65164],1575:[65165,65166],1576:[65167,65168,65169,65170],1577:[65171,65172],1578:[65173,65174,65175,65176],1579:[65177,65178,65179,65180],1580:[65181,65182,65183,65184],1581:[65185,65186,65187,65188],1582:[65189,65190,65191,65192],1583:[65193,65194],1584:[65195,65196],1585:[65197,65198],1586:[65199,65200],1587:[65201,65202,65203,65204],1588:[65205,65206,65207,65208],1589:[65209,65210,65211,65212],1590:[65213,65214,65215,65216],1591:[65217,65218,65219,65220],1592:[65221,65222,65223,65224],1593:[65225,65226,65227,65228],1594:[65229,65230,65231,65232],1601:[65233,65234,65235,65236],1602:[65237,65238,65239,65240],1603:[65241,65242,65243,65244],1604:[65245,65246,65247,65248],1605:[65249,65250,65251,65252],1606:[65253,65254,65255,65256],1607:[65257,65258,65259,65260],1608:[65261,65262],1609:[65263,65264,64488,64489],1610:[65265,65266,65267,65268],1649:[64336,64337],1655:[64477],1657:[64358,64359,64360,64361],1658:[64350,64351,64352,64353],1659:[64338,64339,64340,64341],1662:[64342,64343,64344,64345],1663:[64354,64355,64356,64357],1664:[64346,64347,64348,64349],1667:[64374,64375,64376,64377],1668:[64370,64371,64372,64373],1670:[64378,64379,64380,64381],1671:[64382,64383,64384,64385],1672:[64392,64393],1676:[64388,64389],1677:[64386,64387],1678:[64390,64391],1681:[64396,64397],1688:[64394,64395],1700:[64362,64363,64364,64365],1702:[64366,64367,64368,64369],1705:[64398,64399,64400,64401],1709:[64467,64468,64469,64470],1711:[64402,64403,64404,64405],1713:[64410,64411,64412,64413],1715:[64406,64407,64408,64409],1722:[64414,64415],1723:[64416,64417,64418,64419],1726:[64426,64427,64428,64429],1728:[64420,64421],1729:[64422,64423,64424,64425],1733:[64480,64481],1734:[64473,64474],1735:[64471,64472],1736:[64475,64476],1737:[64482,64483],1739:[64478,64479],1740:[64508,64509,64510,64511],1744:[64484,64485,64486,64487],1746:[64430,64431],1747:[64432,64433]},r={65247:{65154:65269,65156:65271,65160:65273,65166:65275},65248:{65154:65270,65156:65272,65160:65274,65166:65276},65165:{65247:{65248:{65258:65010}}},1617:{1612:64606,1613:64607,1614:64608,1615:64609,1616:64610}},n={1612:64606,1613:64607,1614:64608,1615:64609,1616:64610},i=[1570,1571,1573,1575];t.__arabicParser__={};var a=t.__arabicParser__.isInArabicSubstitutionA=function(E){return e[E.charCodeAt(0)]!==void 0},s=t.__arabicParser__.isArabicLetter=function(E){return typeof E=="string"&&/^[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDFF\uFE70-\uFEFF]+$/.test(E)},o=t.__arabicParser__.isArabicEndLetter=function(E){return s(E)&&a(E)&&e[E.charCodeAt(0)].length<=2},u=t.__arabicParser__.isArabicAlfLetter=function(E){return s(E)&&i.indexOf(E.charCodeAt(0))>=0};t.__arabicParser__.arabicLetterHasIsolatedForm=function(E){return s(E)&&a(E)&&e[E.charCodeAt(0)].length>=1};var h=t.__arabicParser__.arabicLetterHasFinalForm=function(E){return s(E)&&a(E)&&e[E.charCodeAt(0)].length>=2};t.__arabicParser__.arabicLetterHasInitialForm=function(E){return s(E)&&a(E)&&e[E.charCodeAt(0)].length>=3};var f=t.__arabicParser__.arabicLetterHasMedialForm=function(E){return s(E)&&a(E)&&e[E.charCodeAt(0)].length==4},g=t.__arabicParser__.resolveLigatures=function(E){var P=0,k=r,L="",O=0;for(P=0;P<E.length;P+=1)k[E.charCodeAt(P)]!==void 0?(O++,typeof(k=k[E.charCodeAt(P)])=="number"&&(L+=String.fromCharCode(k),k=r,O=0),P===E.length-1&&(k=r,L+=E.charAt(P-(O-1)),P-=O-1,O=0)):(k=r,L+=E.charAt(P-O),P-=O,O=0);return L};t.__arabicParser__.isArabicDiacritic=function(E){return E!==void 0&&n[E.charCodeAt(0)]!==void 0};var b=t.__arabicParser__.getCorrectForm=function(E,P,k){return s(E)?a(E)===!1?-1:!h(E)||!s(P)&&!s(k)||!s(k)&&o(P)||o(E)&&!s(P)||o(E)&&u(P)||o(E)&&o(P)?0:f(E)&&s(P)&&!o(P)&&s(k)&&h(k)?3:o(E)||!s(k)?1:2:-1},v=function(E){var P=0,k=0,L=0,O="",M="",z="",B=(E=E||"").split("\\s+"),q=[];for(P=0;P<B.length;P+=1){for(q.push(""),k=0;k<B[P].length;k+=1)O=B[P][k],M=B[P][k-1],z=B[P][k+1],s(O)?(L=b(O,M,z),q[P]+=L!==-1?String.fromCharCode(e[O.charCodeAt(0)][L]):O):q[P]+=O;q[P]=g(q[P])}return q.join(" ")},S=t.__arabicParser__.processArabic=t.processArabic=function(){var E,P=typeof arguments[0]=="string"?arguments[0]:arguments[0].text,k=[];if(Array.isArray(P)){var L=0;for(k=[],L=0;L<P.length;L+=1)Array.isArray(P[L])?k.push([v(P[L][0]),P[L][1],P[L][2]]):k.push([v(P[L])]);E=k}else E=v(P);return typeof arguments[0]=="string"?E:(arguments[0].text=E,arguments[0])};t.events.push(["preProcessText",S])})(li.API),li.API.autoPrint=function(t){var e;return(t=t||{}).variant=t.variant||"non-conform",t.variant==="javascript"?this.addJS("print({});"):(this.internal.events.subscribe("postPutResources",function(){e=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /Named"),this.internal.out("/Type /Action"),this.internal.out("/N /Print"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){this.internal.out("/OpenAction "+e+" 0 R")})),this},(function(t){var e=function(){var r=void 0;Object.defineProperty(this,"pdf",{get:function(){return r},set:function(o){r=o}});var n=150;Object.defineProperty(this,"width",{get:function(){return n},set:function(o){n=isNaN(o)||Number.isInteger(o)===!1||o<0?150:o,this.getContext("2d").pageWrapXEnabled&&(this.getContext("2d").pageWrapX=n+1)}});var i=300;Object.defineProperty(this,"height",{get:function(){return i},set:function(o){i=isNaN(o)||Number.isInteger(o)===!1||o<0?300:o,this.getContext("2d").pageWrapYEnabled&&(this.getContext("2d").pageWrapY=i+1)}});var a=[];Object.defineProperty(this,"childNodes",{get:function(){return a},set:function(o){a=o}});var s={};Object.defineProperty(this,"style",{get:function(){return s},set:function(o){s=o}}),Object.defineProperty(this,"parentNode",{})};e.prototype.getContext=function(r,n){var i;if((r=r||"2d")!=="2d")return null;for(i in n)this.pdf.context2d.hasOwnProperty(i)&&(this.pdf.context2d[i]=n[i]);return this.pdf.context2d._canvas=this,this.pdf.context2d},e.prototype.toDataURL=function(){throw new Error("toDataURL is not implemented.")},t.events.push(["initialized",function(){this.canvas=new e,this.canvas.pdf=this}])})(li.API),(function(t){var e={left:0,top:0,bottom:0,right:0},r=!1,n=function(){this.internal.__cell__===void 0&&(this.internal.__cell__={},this.internal.__cell__.padding=3,this.internal.__cell__.headerFunction=void 0,this.internal.__cell__.margins=Object.assign({},e),this.internal.__cell__.margins.width=this.getPageWidth(),i.call(this))},i=function(){this.internal.__cell__.lastCell=new a,this.internal.__cell__.pages=1},a=function(){var u=arguments[0];Object.defineProperty(this,"x",{enumerable:!0,get:function(){return u},set:function(E){u=E}});var h=arguments[1];Object.defineProperty(this,"y",{enumerable:!0,get:function(){return h},set:function(E){h=E}});var f=arguments[2];Object.defineProperty(this,"width",{enumerable:!0,get:function(){return f},set:function(E){f=E}});var g=arguments[3];Object.defineProperty(this,"height",{enumerable:!0,get:function(){return g},set:function(E){g=E}});var b=arguments[4];Object.defineProperty(this,"text",{enumerable:!0,get:function(){return b},set:function(E){b=E}});var v=arguments[5];Object.defineProperty(this,"lineNumber",{enumerable:!0,get:function(){return v},set:function(E){v=E}});var S=arguments[6];return Object.defineProperty(this,"align",{enumerable:!0,get:function(){return S},set:function(E){S=E}}),this};a.prototype.clone=function(){return new a(this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align)},a.prototype.toArray=function(){return[this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align]},t.setHeaderFunction=function(u){return n.call(this),this.internal.__cell__.headerFunction=typeof u=="function"?u:void 0,this},t.getTextDimensions=function(u,h){n.call(this);var f=(h=h||{}).fontSize||this.getFontSize(),g=h.font||this.getFont(),b=h.scaleFactor||this.internal.scaleFactor,v=0,S=0,E=0,P=this;if(!Array.isArray(u)&&typeof u!="string"){if(typeof u!="number")throw new Error("getTextDimensions expects text-parameter to be of type String or type Number or an Array of Strings.");u=String(u)}var k=h.maxWidth;k>0?typeof u=="string"?u=this.splitTextToSize(u,k):Object.prototype.toString.call(u)==="[object Array]"&&(u=u.reduce(function(O,M){return O.concat(P.splitTextToSize(M,k))},[])):u=Array.isArray(u)?u:[u];for(var L=0;L<u.length;L++)v<(E=this.getStringUnitWidth(u[L],{font:g})*f)&&(v=E);return v!==0&&(S=u.length),{w:v/=b,h:Math.max((S*f*this.getLineHeightFactor()-f*(this.getLineHeightFactor()-1))/b,0)}},t.cellAddPage=function(){n.call(this),this.addPage();var u=this.internal.__cell__.margins||e;return this.internal.__cell__.lastCell=new a(u.left,u.top,void 0,void 0),this.internal.__cell__.pages+=1,this};var s=t.cell=function(){var u;u=arguments[0]instanceof a?arguments[0]:new a(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5]),n.call(this);var h=this.internal.__cell__.lastCell,f=this.internal.__cell__.padding,g=this.internal.__cell__.margins||e,b=this.internal.__cell__.tableHeaderRow,v=this.internal.__cell__.printHeaders;return h.lineNumber!==void 0&&(h.lineNumber===u.lineNumber?(u.x=(h.x||0)+(h.width||0),u.y=h.y||0):h.y+h.height+u.height+g.bottom>this.getPageHeight()?(this.cellAddPage(),u.y=g.top,v&&b&&(this.printHeaderRow(u.lineNumber,!0),u.y+=b[0].height)):u.y=h.y+h.height||u.y),u.text[0]!==void 0&&(this.rect(u.x,u.y,u.width,u.height,r===!0?"FD":void 0),u.align==="right"?this.text(u.text,u.x+u.width-f,u.y+f,{align:"right",baseline:"top"}):u.align==="center"?this.text(u.text,u.x+u.width/2,u.y+f,{align:"center",baseline:"top",maxWidth:u.width-f-f}):this.text(u.text,u.x+f,u.y+f,{align:"left",baseline:"top",maxWidth:u.width-f-f})),this.internal.__cell__.lastCell=u,this};t.table=function(u,h,f,g,b){if(n.call(this),!f)throw new Error("No data for PDF table.");var v,S,E,P,k=[],L=[],O=[],M={},z={},B=[],q=[],W=(b=b||{}).autoSize||!1,G=b.printHeaders!==!1,ie=b.css&&b.css["font-size"]!==void 0?16*b.css["font-size"]:b.fontSize||12,Q=b.margins||Object.assign({width:this.getPageWidth()},e),H=typeof b.padding=="number"?b.padding:3,ne=b.headerBackgroundColor||"#c8c8c8",oe=b.headerTextColor||"#000";if(i.call(this),this.internal.__cell__.printHeaders=G,this.internal.__cell__.margins=Q,this.internal.__cell__.table_font_size=ie,this.internal.__cell__.padding=H,this.internal.__cell__.headerBackgroundColor=ne,this.internal.__cell__.headerTextColor=oe,this.setFontSize(ie),g==null)L=k=Object.keys(f[0]),O=k.map(function(){return"left"});else if(Array.isArray(g)&&ao(g[0])==="object")for(k=g.map(function(Te){return Te.name}),L=g.map(function(Te){return Te.prompt||Te.name||""}),O=g.map(function(Te){return Te.align||"left"}),v=0;v<g.length;v+=1)z[g[v].name]=.7499990551181103*g[v].width;else Array.isArray(g)&&typeof g[0]=="string"&&(L=k=g,O=k.map(function(){return"left"}));if(W||Array.isArray(g)&&typeof g[0]=="string")for(v=0;v<k.length;v+=1){for(M[P=k[v]]=f.map(function(Te){return Te[P]}),this.setFont(void 0,"bold"),B.push(this.getTextDimensions(L[v],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w),S=M[P],this.setFont(void 0,"normal"),E=0;E<S.length;E+=1)B.push(this.getTextDimensions(S[E],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w);z[P]=Math.max.apply(null,B)+H+H,B=[]}if(G){var ce={};for(v=0;v<k.length;v+=1)ce[k[v]]={},ce[k[v]].text=L[v],ce[k[v]].align=O[v];var fe=o.call(this,ce,z);q=k.map(function(Te){return new a(u,h,z[Te],fe,ce[Te].text,void 0,ce[Te].align)}),this.setTableHeaderRow(q),this.printHeaderRow(1,!1)}var Me=g.reduce(function(Te,ke){return Te[ke.name]=ke.align,Te},{});for(v=0;v<f.length;v+=1){"rowStart"in b&&b.rowStart instanceof Function&&b.rowStart({row:v,data:f[v]},this);var me=o.call(this,f[v],z);for(E=0;E<k.length;E+=1){var we=f[v][k[E]];"cellStart"in b&&b.cellStart instanceof Function&&b.cellStart({row:v,col:E,data:we},this),s.call(this,new a(u,h,z[k[E]],me,we,v+2,Me[k[E]]))}}return this.internal.__cell__.table_x=u,this.internal.__cell__.table_y=h,this};var o=function(u,h){var f=this.internal.__cell__.padding,g=this.internal.__cell__.table_font_size,b=this.internal.scaleFactor;return Object.keys(u).map(function(v){var S=u[v];return this.splitTextToSize(S.hasOwnProperty("text")?S.text:S,h[v]-f-f)},this).map(function(v){return this.getLineHeightFactor()*v.length*g/b+f+f},this).reduce(function(v,S){return Math.max(v,S)},0)};t.setTableHeaderRow=function(u){n.call(this),this.internal.__cell__.tableHeaderRow=u},t.printHeaderRow=function(u,h){if(n.call(this),!this.internal.__cell__.tableHeaderRow)throw new Error("Property tableHeaderRow does not exist.");var f;if(r=!0,typeof this.internal.__cell__.headerFunction=="function"){var g=this.internal.__cell__.headerFunction(this,this.internal.__cell__.pages);this.internal.__cell__.lastCell=new a(g[0],g[1],g[2],g[3],void 0,-1)}this.setFont(void 0,"bold");for(var b=[],v=0;v<this.internal.__cell__.tableHeaderRow.length;v+=1){f=this.internal.__cell__.tableHeaderRow[v].clone(),h&&(f.y=this.internal.__cell__.margins.top||0,b.push(f)),f.lineNumber=u;var S=this.getTextColor();this.setTextColor(this.internal.__cell__.headerTextColor),this.setFillColor(this.internal.__cell__.headerBackgroundColor),s.call(this,f),this.setTextColor(S)}b.length>0&&this.setTableHeaderRow(b),this.setFont(void 0,"normal"),r=!1}})(li.API);var wX={italic:["italic","oblique","normal"],oblique:["oblique","italic","normal"],normal:["normal","oblique","italic"]},SX=["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded"],GP=xX(SX),EX=[100,200,300,400,500,600,700,800,900],rve=xX(EX);function O3(t){var e=t.family.replace(/"|'/g,"").toLowerCase(),r=(function(a){return wX[a=a||"normal"]?a:"normal"})(t.style),n=(function(a){return a?typeof a=="number"?a>=100&&a<=900&&a%100==0?a:400:/^\d00$/.test(a)?parseInt(a):a==="bold"?700:400:400})(t.weight),i=(function(a){return typeof GP[a=a||"normal"]=="number"?a:"normal"})(t.stretch);return{family:e,style:r,weight:n,stretch:i,src:t.src||[],ref:t.ref||{name:e,style:[i,r,n].join(" ")}}}function _B(t,e,r,n){var i;for(i=r;i>=0&&i<e.length;i+=n)if(t[e[i]])return t[e[i]];for(i=r;i>=0&&i<e.length;i-=n)if(t[e[i]])return t[e[i]]}var nve={"sans-serif":"helvetica",fixed:"courier",monospace:"courier",terminal:"courier",cursive:"times",fantasy:"times",serif:"times"},bB={caption:"times",icon:"times",menu:"times","message-box":"times","small-caption":"times","status-bar":"times"};function xB(t){return[t.stretch,t.style,t.weight,t.family].join(" ")}function wB(t){return t.trimLeft()}function ive(t,e){for(var r=0;r<t.length;){if(t.charAt(r)===e)return[t.substring(0,r),t.substring(r+1)];r+=1}return null}function ave(t){var e=t.match(/^(-[a-z_]|[a-z_])[a-z0-9_-]*/i);return e===null?null:[e[0],t.substring(e[0].length)]}var s2,SB,EB,Oy,l2,TB,CB,AB,L3=["times"];function IB(t,e,r,n){var i=4,a=kB;switch(n){case li.API.image_compression.FAST:i=1,a=PB;break;case li.API.image_compression.MEDIUM:i=6,a=MB;break;case li.API.image_compression.SLOW:i=9,a=RB}t=(function(o,u,h,f){for(var g,b=o.length/u,v=new Uint8Array(o.length+b),S=[ove,PB,kB,MB,RB],E=0;E<b;E+=1){var P=E*u,k=o.subarray(P,P+u);if(f)v.set(f(k,h,g),P+E);else{for(var L=S.length,O=[],M=0;M<L;M+=1)O[M]=S[M](k,h,g);var z=lve(O.concat());v.set(O[z],P+E)}g=k}return v})(t,e,r,a);var s=jP(t,{level:i});return li.API.__addimage__.arrayBufferToBinaryString(s)}function ove(t){var e=Array.apply([],t);return e.unshift(0),e}function PB(t,e){var r=t.length,n=[];n[0]=1;for(var i=0;i<r;i+=1){var a=t[i-e]||0;n[i+1]=t[i]-a+256&255}return n}function kB(t,e,r){var n=t.length,i=[];i[0]=2;for(var a=0;a<n;a+=1){var s=r&&r[a]||0;i[a+1]=t[a]-s+256&255}return i}function MB(t,e,r){var n=t.length,i=[];i[0]=3;for(var a=0;a<n;a+=1){var s=t[a-e]||0,o=r&&r[a]||0;i[a+1]=t[a]+256-(s+o>>>1)&255}return i}function RB(t,e,r){var n=t.length,i=[];i[0]=4;for(var a=0;a<n;a+=1){var s=sve(t[a-e]||0,r&&r[a]||0,r&&r[a-e]||0);i[a+1]=t[a]-s+256&255}return i}function sve(t,e,r){if(t===e&&e===r)return t;var n=Math.abs(e-r),i=Math.abs(t-r),a=Math.abs(t+e-r-r);return n<=i&&n<=a?t:i<=a?e:r}function lve(t){var e=t.map(function(r){return r.reduce(function(n,i){return n+Math.abs(i)},0)});return e.indexOf(Math.min.apply(null,e))}function N3(t,e,r){var n=e*r,i=Math.floor(n/8),a=16-(n-8*i+r),s=(1<<r)-1;return TX(t,i)>>a&s}function OB(t,e,r,n){var i=r*n,a=Math.floor(i/8),s=16-(i-8*a+n),o=(1<<n)-1,u=(e&o)<<s;(function(h,f,g){if(f+1<h.byteLength)h.setUint16(f,g,!1);else{var b=g>>8&255;h.setUint8(f,b)}})(t,a,TX(t,a)&~(o<<s)&65535|u)}function TX(t,e){return e+1<t.byteLength?t.getUint16(e,!1):t.getUint8(e)<<8}function uve(t){var e=0;if(t[e++]!==71||t[e++]!==73||t[e++]!==70||t[e++]!==56||(t[e++]+1&253)!=56||t[e++]!==97)throw new Error("Invalid GIF 87a/89a header.");var r=t[e++]|t[e++]<<8,n=t[e++]|t[e++]<<8,i=t[e++],a=i>>7,s=1<<1+(7&i);t[e++],t[e++];var o=null,u=null;a&&(o=e,u=s,e+=3*s);var h=!0,f=[],g=0,b=null,v=0,S=null;for(this.width=r,this.height=n;h&&e<t.length;)switch(t[e++]){case 33:switch(t[e++]){case 255:if(t[e]!==11||t[e+1]==78&&t[e+2]==69&&t[e+3]==84&&t[e+4]==83&&t[e+5]==67&&t[e+6]==65&&t[e+7]==80&&t[e+8]==69&&t[e+9]==50&&t[e+10]==46&&t[e+11]==48&&t[e+12]==3&&t[e+13]==1&&t[e+16]==0)e+=14,S=t[e++]|t[e++]<<8,e++;else for(e+=12;;){if(!((Q=t[e++])>=0))throw Error("Invalid block size");if(Q===0)break;e+=Q}break;case 249:if(t[e++]!==4||t[e+4]!==0)throw new Error("Invalid graphics extension block.");var E=t[e++];g=t[e++]|t[e++]<<8,b=t[e++],1&E||(b=null),v=E>>2&7,e++;break;case 254:for(;;){if(!((Q=t[e++])>=0))throw Error("Invalid block size");if(Q===0)break;e+=Q}break;default:throw new Error("Unknown graphic control label: 0x"+t[e-1].toString(16))}break;case 44:var P=t[e++]|t[e++]<<8,k=t[e++]|t[e++]<<8,L=t[e++]|t[e++]<<8,O=t[e++]|t[e++]<<8,M=t[e++],z=M>>6&1,B=1<<1+(7&M),q=o,W=u,G=!1;M>>7&&(G=!0,q=e,W=B,e+=3*B);var ie=e;for(e++;;){var Q;if(!((Q=t[e++])>=0))throw Error("Invalid block size");if(Q===0)break;e+=Q}f.push({x:P,y:k,width:L,height:O,has_local_palette:G,palette_offset:q,palette_size:W,data_offset:ie,data_length:e-ie,transparent_index:b,interlaced:!!z,delay:g,disposal:v});break;case 59:h=!1;break;default:throw new Error("Unknown gif block: 0x"+t[e-1].toString(16))}this.numFrames=function(){return f.length},this.loopCount=function(){return S},this.frameInfo=function(H){if(H<0||H>=f.length)throw new Error("Frame index out of range.");return f[H]},this.decodeAndBlitFrameBGRA=function(H,ne){var oe=this.frameInfo(H),ce=oe.width*oe.height,fe=new Uint8Array(ce);LB(t,oe.data_offset,fe,ce);var Me=oe.palette_offset,me=oe.transparent_index;me===null&&(me=256);var we=oe.width,Te=r-we,ke=we,he=4*(oe.y*r+oe.x),Ee=4*((oe.y+oe.height)*r+oe.x),xe=he,Ne=4*Te;oe.interlaced===!0&&(Ne+=4*r*7);for(var Oe=8,$e=0,De=fe.length;$e<De;++$e){var it=fe[$e];if(ke===0&&(ke=we,(xe+=Ne)>=Ee&&(Ne=4*Te+4*r*(Oe-1),xe=he+(we+Te)*(Oe<<1),Oe>>=1)),it===me)xe+=4;else{var Ye=t[Me+3*it],rt=t[Me+3*it+1],Ie=t[Me+3*it+2];ne[xe++]=Ie,ne[xe++]=rt,ne[xe++]=Ye,ne[xe++]=255}--ke}},this.decodeAndBlitFrameRGBA=function(H,ne){var oe=this.frameInfo(H),ce=oe.width*oe.height,fe=new Uint8Array(ce);LB(t,oe.data_offset,fe,ce);var Me=oe.palette_offset,me=oe.transparent_index;me===null&&(me=256);var we=oe.width,Te=r-we,ke=we,he=4*(oe.y*r+oe.x),Ee=4*((oe.y+oe.height)*r+oe.x),xe=he,Ne=4*Te;oe.interlaced===!0&&(Ne+=4*r*7);for(var Oe=8,$e=0,De=fe.length;$e<De;++$e){var it=fe[$e];if(ke===0&&(ke=we,(xe+=Ne)>=Ee&&(Ne=4*Te+4*r*(Oe-1),xe=he+(we+Te)*(Oe<<1),Oe>>=1)),it===me)xe+=4;else{var Ye=t[Me+3*it],rt=t[Me+3*it+1],Ie=t[Me+3*it+2];ne[xe++]=Ye,ne[xe++]=rt,ne[xe++]=Ie,ne[xe++]=255}--ke}}}function LB(t,e,r,n){for(var i=t[e++],a=1<<i,s=a+1,o=s+1,u=i+1,h=(1<<u)-1,f=0,g=0,b=0,v=t[e++],S=new Int32Array(4096),E=null;;){for(;f<16&&v!==0;)g|=t[e++]<<f,f+=8,v===1?v=t[e++]:--v;if(f<u)break;var P=g&h;if(g>>=u,f-=u,P!==a){if(P===s)break;for(var k=P<o?P:E,L=0,O=k;O>a;)O=S[O]>>8,++L;var M=O;if(b+L+(k!==P?1:0)>n)return void Eo.log("Warning, gif stream longer than expected.");r[b++]=M;var z=b+=L;for(k!==P&&(r[b++]=M),O=k;L--;)O=S[O],r[--z]=255&O,O>>=8;E!==null&&o<4096&&(S[o++]=E<<8|M,o>=h+1&&u<12&&(++u,h=h<<1|1)),E=P}else o=s+1,h=(1<<(u=i+1))-1,E=null}return b!==n&&Eo.log("Warning, gif stream shorter than expected."),r}/**
 * @license
  Copyright (c) 2008, Adobe Systems Incorporated
  All rights reserved.

  Redistribution and use in source and binary forms, with or without 
  modification, are permitted provided that the following conditions are
  met:

  * Redistributions of source code must retain the above copyright notice, 
    this list of conditions and the following disclaimer.
  
  * Redistributions in binary form must reproduce the above copyright
    notice, this list of conditions and the following disclaimer in the 
    documentation and/or other materials provided with the distribution.
  
  * Neither the name of Adobe Systems Incorporated nor the names of its 
    contributors may be used to endorse or promote products derived from 
    this software without specific prior written permission.

  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS
  IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO,
  THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
  PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR 
  CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
  EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
  PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
  PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
  SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
*/function D3(t){var e,r,n,i,a,s=Math.floor,o=new Array(64),u=new Array(64),h=new Array(64),f=new Array(64),g=new Array(65535),b=new Array(65535),v=new Array(64),S=new Array(64),E=[],P=0,k=7,L=new Array(64),O=new Array(64),M=new Array(64),z=new Array(256),B=new Array(2048),q=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],W=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],G=[0,1,2,3,4,5,6,7,8,9,10,11],ie=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],Q=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],H=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],ne=[0,1,2,3,4,5,6,7,8,9,10,11],oe=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],ce=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function fe(he,Ee){for(var xe=0,Ne=0,Oe=new Array,$e=1;$e<=16;$e++){for(var De=1;De<=he[$e];De++)Oe[Ee[Ne]]=[],Oe[Ee[Ne]][0]=xe,Oe[Ee[Ne]][1]=$e,Ne++,xe++;xe*=2}return Oe}function Me(he){for(var Ee=he[0],xe=he[1]-1;xe>=0;)Ee&1<<xe&&(P|=1<<k),xe--,--k<0&&(P==255?(me(255),me(0)):me(P),k=7,P=0)}function me(he){E.push(he)}function we(he){me(he>>8&255),me(255&he)}function Te(he,Ee,xe,Ne,Oe){for(var $e,De=Oe[0],it=Oe[240],Ye=(function(vt,yr){var _r,cr,Er,wr,er,lr,Ar,ir,nt,_e,be=0;for(nt=0;nt<8;++nt){_r=vt[be],cr=vt[be+1],Er=vt[be+2],wr=vt[be+3],er=vt[be+4],lr=vt[be+5],Ar=vt[be+6];var qe=_r+(ir=vt[be+7]),Qe=_r-ir,ot=cr+Ar,et=cr-Ar,Lt=Er+lr,_t=Er-lr,jt=wr+er,Jt=wr-er,Kt=qe+jt,Rr=qe-jt,bt=ot+Lt,Tr=ot-Lt;vt[be]=Kt+bt,vt[be+4]=Kt-bt;var Ur=.707106781*(Tr+Rr);vt[be+2]=Rr+Ur,vt[be+6]=Rr-Ur;var Gr=.382683433*((Kt=Jt+_t)-(Tr=et+Qe)),Jr=.5411961*Kt+Gr,ar=1.306562965*Tr+Gr,ti=.707106781*(bt=_t+et),un=Qe+ti,ri=Qe-ti;vt[be+5]=ri+Jr,vt[be+3]=ri-Jr,vt[be+1]=un+ar,vt[be+7]=un-ar,be+=8}for(be=0,nt=0;nt<8;++nt){_r=vt[be],cr=vt[be+8],Er=vt[be+16],wr=vt[be+24],er=vt[be+32],lr=vt[be+40],Ar=vt[be+48];var Ae=_r+(ir=vt[be+56]),Be=_r-ir,mt=cr+Ar,pt=cr-Ar,Ir=Er+lr,Fr=Er-lr,qn=wr+er,Oi=wr-er,zr=Ae+qn,bn=Ae-qn,Tn=mt+Ir,Mi=mt-Ir;vt[be]=zr+Tn,vt[be+32]=zr-Tn;var pi=.707106781*(Mi+bn);vt[be+16]=bn+pi,vt[be+48]=bn-pi;var Wi=.382683433*((zr=Oi+Fr)-(Mi=pt+Be)),Fn=.5411961*zr+Wi,Ia=1.306562965*Mi+Wi,ma=.707106781*(Tn=Fr+pt),Gi=Be+ma,Ka=Be-ma;vt[be+40]=Ka+Fn,vt[be+24]=Ka-Fn,vt[be+8]=Gi+Ia,vt[be+56]=Gi-Ia,be++}for(nt=0;nt<64;++nt)_e=vt[nt]*yr[nt],v[nt]=_e>0?_e+.5|0:_e-.5|0;return v})(he,Ee),rt=0;rt<64;++rt)S[q[rt]]=Ye[rt];var Ie=S[0]-xe;xe=S[0],Ie==0?Me(Ne[0]):(Me(Ne[b[$e=32767+Ie]]),Me(g[$e]));for(var Mt=63;Mt>0&&S[Mt]==0;)Mt--;if(Mt==0)return Me(De),xe;for(var at,je=1;je<=Mt;){for(var Xt=je;S[je]==0&&je<=Mt;)++je;var Yt=je-Xt;if(Yt>=16){at=Yt>>4;for(var pr=1;pr<=at;++pr)Me(it);Yt&=15}$e=32767+S[je],Me(Oe[(Yt<<4)+b[$e]]),Me(g[$e]),je++}return Mt!=63&&Me(De),xe}function ke(he){he=Math.min(Math.max(he,1),100),a!=he&&((function(Ee){for(var xe=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],Ne=0;Ne<64;Ne++){var Oe=s((xe[Ne]*Ee+50)/100);Oe=Math.min(Math.max(Oe,1),255),o[q[Ne]]=Oe}for(var $e=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],De=0;De<64;De++){var it=s(($e[De]*Ee+50)/100);it=Math.min(Math.max(it,1),255),u[q[De]]=it}for(var Ye=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],rt=0,Ie=0;Ie<8;Ie++)for(var Mt=0;Mt<8;Mt++)h[rt]=1/(o[q[rt]]*Ye[Ie]*Ye[Mt]*8),f[rt]=1/(u[q[rt]]*Ye[Ie]*Ye[Mt]*8),rt++})(he<50?Math.floor(5e3/he):Math.floor(200-2*he)),a=he)}this.encode=function(he,Ee){Ee&&ke(Ee),E=new Array,P=0,k=7,we(65496),we(65504),we(16),me(74),me(70),me(73),me(70),me(0),me(1),me(1),me(0),we(1),we(1),me(0),me(0),(function(){we(65499),we(132),me(0);for(var cr=0;cr<64;cr++)me(o[cr]);me(1);for(var Er=0;Er<64;Er++)me(u[Er])})(),(function(cr,Er){we(65472),we(17),me(8),we(Er),we(cr),me(3),me(1),me(17),me(0),me(2),me(17),me(1),me(3),me(17),me(1)})(he.width,he.height),(function(){we(65476),we(418),me(0);for(var cr=0;cr<16;cr++)me(W[cr+1]);for(var Er=0;Er<=11;Er++)me(G[Er]);me(16);for(var wr=0;wr<16;wr++)me(ie[wr+1]);for(var er=0;er<=161;er++)me(Q[er]);me(1);for(var lr=0;lr<16;lr++)me(H[lr+1]);for(var Ar=0;Ar<=11;Ar++)me(ne[Ar]);me(17);for(var ir=0;ir<16;ir++)me(oe[ir+1]);for(var nt=0;nt<=161;nt++)me(ce[nt])})(),we(65498),we(12),me(3),me(1),me(0),me(2),me(17),me(3),me(17),me(0),me(63),me(0);var xe=0,Ne=0,Oe=0;P=0,k=7,this.encode.displayName="_encode_";for(var $e,De,it,Ye,rt,Ie,Mt,at,je,Xt=he.data,Yt=he.width,pr=he.height,vt=4*Yt,yr=0;yr<pr;){for($e=0;$e<vt;){for(rt=vt*yr+$e,Mt=-1,at=0,je=0;je<64;je++)Ie=rt+(at=je>>3)*vt+(Mt=4*(7&je)),yr+at>=pr&&(Ie-=vt*(yr+1+at-pr)),$e+Mt>=vt&&(Ie-=$e+Mt-vt+4),De=Xt[Ie++],it=Xt[Ie++],Ye=Xt[Ie++],L[je]=(B[De]+B[it+256|0]+B[Ye+512|0]>>16)-128,O[je]=(B[De+768|0]+B[it+1024|0]+B[Ye+1280|0]>>16)-128,M[je]=(B[De+1280|0]+B[it+1536|0]+B[Ye+1792|0]>>16)-128;xe=Te(L,h,xe,e,n),Ne=Te(O,f,Ne,r,i),Oe=Te(M,f,Oe,r,i),$e+=32}yr+=8}if(k>=0){var _r=[];_r[1]=k+1,_r[0]=(1<<k+1)-1,Me(_r)}return we(65497),new Uint8Array(E)},t=t||50,(function(){for(var he=String.fromCharCode,Ee=0;Ee<256;Ee++)z[Ee]=he(Ee)})(),e=fe(W,G),r=fe(H,ne),n=fe(ie,Q),i=fe(oe,ce),(function(){for(var he=1,Ee=2,xe=1;xe<=15;xe++){for(var Ne=he;Ne<Ee;Ne++)b[32767+Ne]=xe,g[32767+Ne]=[],g[32767+Ne][1]=xe,g[32767+Ne][0]=Ne;for(var Oe=-(Ee-1);Oe<=-he;Oe++)b[32767+Oe]=xe,g[32767+Oe]=[],g[32767+Oe][1]=xe,g[32767+Oe][0]=Ee-1+Oe;he<<=1,Ee<<=1}})(),(function(){for(var he=0;he<256;he++)B[he]=19595*he,B[he+256|0]=38470*he,B[he+512|0]=7471*he+32768,B[he+768|0]=-11059*he,B[he+1024|0]=-21709*he,B[he+1280|0]=32768*he+8421375,B[he+1536|0]=-27439*he,B[he+1792|0]=-5329*he})(),ke(t)}/**
 * @license
 * Copyright (c) 2017 Aras Abbasi
 *
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 */function Gh(t,e){if(this.pos=0,this.buffer=t,this.datav=new DataView(t.buffer),this.is_with_alpha=!!e,this.bottom_up=!0,this.flag=String.fromCharCode(this.buffer[0])+String.fromCharCode(this.buffer[1]),this.pos+=2,["BM","BA","CI","CP","IC","PT"].indexOf(this.flag)===-1)throw new Error("Invalid BMP File");this.parseHeader(),this.parseBGR()}function NB(t){function e(G){if(!G)throw Error("assert :P")}function r(G,ie,Q){for(var H=0;4>H;H++)if(G[ie+H]!=Q.charCodeAt(H))return!0;return!1}function n(G,ie,Q,H,ne){for(var oe=0;oe<ne;oe++)G[ie+oe]=Q[H+oe]}function i(G,ie,Q,H){for(var ne=0;ne<H;ne++)G[ie+ne]=Q}function a(G){return new Int32Array(G)}function s(G,ie){for(var Q=[],H=0;H<G;H++)Q.push(new ie);return Q}function o(G,ie){var Q=[];return(function H(ne,oe,ce){for(var fe=ce[oe],Me=0;Me<fe&&(ne.push(ce.length>oe+1?[]:new ie),!(ce.length<oe+1));Me++)H(ne[Me],oe+1,ce)})(Q,0,G),Q}var u=function(){var G=this;function ie($,Z){for(var de=1<<Z-1>>>0;$&de;)de>>>=1;return de?($&de-1)+de:$}function Q($,Z,de,Pe,He){e(!(Pe%de));do $[Z+(Pe-=de)]=He;while(0<Pe)}function H($,Z,de,Pe,He){if(e(2328>=He),512>=He)var Je=a(512);else if((Je=a(He))==null)return 0;return(function(tt,We,ft,Et,Vt,vr){var St,Qt,Ut=We,Or=1<<ft,xr=a(16),Nr=a(16);for(e(Vt!=0),e(Et!=null),e(tt!=null),e(0<ft),Qt=0;Qt<Vt;++Qt){if(15<Et[Qt])return 0;++xr[Et[Qt]]}if(xr[0]==Vt)return 0;for(Nr[1]=0,St=1;15>St;++St){if(xr[St]>1<<St)return 0;Nr[St+1]=Nr[St]+xr[St]}for(Qt=0;Qt<Vt;++Qt)St=Et[Qt],0<Et[Qt]&&(vr[Nr[St]++]=Qt);if(Nr[15]==1)return(Et=new ne).g=0,Et.value=vr[0],Q(tt,Ut,1,Or,Et),Or;var jr,rn=-1,Kr=Or-1,Kn=0,zn=1,Li=1,Gn=1<<ft;for(Qt=0,St=1,Vt=2;St<=ft;++St,Vt<<=1){if(zn+=Li<<=1,0>(Li-=xr[St]))return 0;for(;0<xr[St];--xr[St])(Et=new ne).g=St,Et.value=vr[Qt++],Q(tt,Ut+Kn,Vt,Gn,Et),Kn=ie(Kn,St)}for(St=ft+1,Vt=2;15>=St;++St,Vt<<=1){if(zn+=Li<<=1,0>(Li-=xr[St]))return 0;for(;0<xr[St];--xr[St]){if(Et=new ne,(Kn&Kr)!=rn){for(Ut+=Gn,jr=1<<(rn=St)-ft;15>rn&&!(0>=(jr-=xr[rn]));)++rn,jr<<=1;Or+=Gn=1<<(jr=rn-ft),tt[We+(rn=Kn&Kr)].g=jr+ft,tt[We+rn].value=Ut-We-rn}Et.g=St-ft,Et.value=vr[Qt++],Q(tt,Ut+(Kn>>ft),Vt,Gn,Et),Kn=ie(Kn,St)}}return zn!=2*Nr[15]-1?0:Or})($,Z,de,Pe,He,Je)}function ne(){this.value=this.g=0}function oe(){this.value=this.g=0}function ce(){this.G=s(5,ne),this.H=a(5),this.jc=this.Qb=this.qb=this.nd=0,this.pd=s(wo,oe)}function fe($,Z,de,Pe){e($!=null),e(Z!=null),e(2147483648>Pe),$.Ca=254,$.I=0,$.b=-8,$.Ka=0,$.oa=Z,$.pa=de,$.Jd=Z,$.Yc=de+Pe,$.Zc=4<=Pe?de+Pe-4+1:de,De($)}function Me($,Z){for(var de=0;0<Z--;)de|=Ye($,128)<<Z;return de}function me($,Z){var de=Me($,Z);return it($)?-de:de}function we($,Z,de,Pe){var He,Je=0;for(e($!=null),e(Z!=null),e(4294967288>Pe),$.Sb=Pe,$.Ra=0,$.u=0,$.h=0,4<Pe&&(Pe=4),He=0;He<Pe;++He)Je+=Z[de+He]<<8*He;$.Ra=Je,$.bb=Pe,$.oa=Z,$.pa=de}function Te($){for(;8<=$.u&&$.bb<$.Sb;)$.Ra>>>=8,$.Ra+=$.oa[$.pa+$.bb]<<zl-8>>>0,++$.bb,$.u-=8;Ne($)&&($.h=1,$.u=0)}function ke($,Z){if(e(0<=Z),!$.h&&Z<=hs){var de=xe($)&Bl[Z];return $.u+=Z,Te($),de}return $.h=1,$.u=0}function he(){this.b=this.Ca=this.I=0,this.oa=[],this.pa=0,this.Jd=[],this.Yc=0,this.Zc=[],this.Ka=0}function Ee(){this.Ra=0,this.oa=[],this.h=this.u=this.bb=this.Sb=this.pa=0}function xe($){return $.Ra>>>($.u&zl-1)>>>0}function Ne($){return e($.bb<=$.Sb),$.h||$.bb==$.Sb&&$.u>zl}function Oe($,Z){$.u=Z,$.h=Ne($)}function $e($){$.u>=ya&&(e($.u>=ya),Te($))}function De($){e($!=null&&$.oa!=null),$.pa<$.Zc?($.I=($.oa[$.pa++]|$.I<<8)>>>0,$.b+=8):(e($!=null&&$.oa!=null),$.pa<$.Yc?($.b+=8,$.I=$.oa[$.pa++]|$.I<<8):$.Ka?$.b=0:($.I<<=8,$.b+=8,$.Ka=1))}function it($){return Me($,1)}function Ye($,Z){var de=$.Ca;0>$.b&&De($);var Pe=$.b,He=de*Z>>>8,Je=($.I>>>Pe>He)+0;for(Je?(de-=He,$.I-=He+1<<Pe>>>0):de=He+1,Pe=de,He=0;256<=Pe;)He+=8,Pe>>=8;return Pe=7^He+Tu[Pe],$.b-=Pe,$.Ca=(de<<Pe)-1,Je}function rt($,Z,de){$[Z+0]=de>>24&255,$[Z+1]=de>>16&255,$[Z+2]=de>>8&255,$[Z+3]=255&de}function Ie($,Z){return $[Z+0]|$[Z+1]<<8}function Mt($,Z){return Ie($,Z)|$[Z+2]<<16}function at($,Z){return Ie($,Z)|Ie($,Z+2)<<16}function je($,Z){var de=1<<Z;return e($!=null),e(0<Z),$.X=a(de),$.X==null?0:($.Mb=32-Z,$.Xa=Z,1)}function Xt($,Z){e($!=null),e(Z!=null),e($.Xa==Z.Xa),n(Z.X,0,$.X,0,1<<Z.Xa)}function Yt(){this.X=[],this.Xa=this.Mb=0}function pr($,Z,de,Pe){e(de!=null),e(Pe!=null);var He=de[0],Je=Pe[0];return He==0&&(He=($*Je+Z/2)/Z),Je==0&&(Je=(Z*He+$/2)/$),0>=He||0>=Je?0:(de[0]=He,Pe[0]=Je,1)}function vt($,Z){return $+(1<<Z)-1>>>Z}function yr($,Z){return((4278255360&$)+(4278255360&Z)>>>0&4278255360)+((16711935&$)+(16711935&Z)>>>0&16711935)>>>0}function _r($,Z){G[Z]=function(de,Pe,He,Je,tt,We,ft){var Et;for(Et=0;Et<tt;++Et){var Vt=G[$](We[ft+Et-1],He,Je+Et);We[ft+Et]=yr(de[Pe+Et],Vt)}}}function cr(){this.ud=this.hd=this.jd=0}function Er($,Z){return((4278124286&($^Z))>>>1)+($&Z)>>>0}function wr($){return 0<=$&&256>$?$:0>$?0:255<$?255:void 0}function er($,Z){return wr($+($-Z+.5>>1))}function lr($,Z,de){return Math.abs(Z-de)-Math.abs($-de)}function Ar($,Z,de,Pe,He,Je,tt){for(Pe=Je[tt-1],de=0;de<He;++de)Je[tt+de]=Pe=yr($[Z+de],Pe)}function ir($,Z,de,Pe,He){var Je;for(Je=0;Je<de;++Je){var tt=$[Z+Je],We=tt>>8&255,ft=16711935&(ft=(ft=16711935&tt)+((We<<16)+We));Pe[He+Je]=(4278255360&tt)+ft>>>0}}function nt($,Z){Z.jd=255&$,Z.hd=$>>8&255,Z.ud=$>>16&255}function _e($,Z,de,Pe,He,Je){var tt;for(tt=0;tt<Pe;++tt){var We=Z[de+tt],ft=We>>>8,Et=We,Vt=255&(Vt=(Vt=We>>>16)+(($.jd<<24>>24)*(ft<<24>>24)>>>5));Et=255&(Et=(Et+=($.hd<<24>>24)*(ft<<24>>24)>>>5)+(($.ud<<24>>24)*(Vt<<24>>24)>>>5)),He[Je+tt]=(4278255360&We)+(Vt<<16)+Et}}function be($,Z,de,Pe,He){G[Z]=function(Je,tt,We,ft,Et,Vt,vr,St,Qt){for(ft=vr;ft<St;++ft)for(vr=0;vr<Qt;++vr)Et[Vt++]=He(We[Pe(Je[tt++])])},G[$]=function(Je,tt,We,ft,Et,Vt,vr){var St=8>>Je.b,Qt=Je.Ea,Ut=Je.K[0],Or=Je.w;if(8>St)for(Je=(1<<Je.b)-1,Or=(1<<St)-1;tt<We;++tt){var xr,Nr=0;for(xr=0;xr<Qt;++xr)xr&Je||(Nr=Pe(ft[Et++])),Vt[vr++]=He(Ut[Nr&Or]),Nr>>=St}else G["VP8LMapColor"+de](ft,Et,Ut,Or,Vt,vr,tt,We,Qt)}}function qe($,Z,de,Pe,He){for(de=Z+de;Z<de;){var Je=$[Z++];Pe[He++]=Je>>16&255,Pe[He++]=Je>>8&255,Pe[He++]=255&Je}}function Qe($,Z,de,Pe,He){for(de=Z+de;Z<de;){var Je=$[Z++];Pe[He++]=Je>>16&255,Pe[He++]=Je>>8&255,Pe[He++]=255&Je,Pe[He++]=Je>>24&255}}function ot($,Z,de,Pe,He){for(de=Z+de;Z<de;){var Je=(tt=$[Z++])>>16&240|tt>>12&15,tt=240&tt|tt>>28&15;Pe[He++]=Je,Pe[He++]=tt}}function et($,Z,de,Pe,He){for(de=Z+de;Z<de;){var Je=(tt=$[Z++])>>16&248|tt>>13&7,tt=tt>>5&224|tt>>3&31;Pe[He++]=Je,Pe[He++]=tt}}function Lt($,Z,de,Pe,He){for(de=Z+de;Z<de;){var Je=$[Z++];Pe[He++]=255&Je,Pe[He++]=Je>>8&255,Pe[He++]=Je>>16&255}}function _t($,Z,de,Pe,He,Je){if(Je==0)for(de=Z+de;Z<de;)rt(Pe,((Je=$[Z++])[0]>>24|Je[1]>>8&65280|Je[2]<<8&16711680|Je[3]<<24)>>>0),He+=32;else n(Pe,He,$,Z,de)}function jt($,Z){G[Z][0]=G[$+"0"],G[Z][1]=G[$+"1"],G[Z][2]=G[$+"2"],G[Z][3]=G[$+"3"],G[Z][4]=G[$+"4"],G[Z][5]=G[$+"5"],G[Z][6]=G[$+"6"],G[Z][7]=G[$+"7"],G[Z][8]=G[$+"8"],G[Z][9]=G[$+"9"],G[Z][10]=G[$+"10"],G[Z][11]=G[$+"11"],G[Z][12]=G[$+"12"],G[Z][13]=G[$+"13"],G[Z][14]=G[$+"0"],G[Z][15]=G[$+"0"]}function Jt($){return $==fd||$==_f||$==ch||$==Bh}function Kt(){this.eb=[],this.size=this.A=this.fb=0}function Rr(){this.y=[],this.f=[],this.ea=[],this.F=[],this.Tc=this.Ed=this.Cd=this.Fd=this.lb=this.Db=this.Ab=this.fa=this.J=this.W=this.N=this.O=0}function bt(){this.Rd=this.height=this.width=this.S=0,this.f={},this.f.RGBA=new Kt,this.f.kb=new Rr,this.sd=null}function Tr(){this.width=[0],this.height=[0],this.Pd=[0],this.Qd=[0],this.format=[0]}function Ur(){this.Id=this.fd=this.Md=this.hb=this.ib=this.da=this.bd=this.cd=this.j=this.v=this.Da=this.Sd=this.ob=0}function Gr($){return alert("todo:WebPSamplerProcessPlane"),$.T}function Jr($,Z){var de=$.T,Pe=Z.ba.f.RGBA,He=Pe.eb,Je=Pe.fb+$.ka*Pe.A,tt=ws[Z.ba.S],We=$.y,ft=$.O,Et=$.f,Vt=$.N,vr=$.ea,St=$.W,Qt=Z.cc,Ut=Z.dc,Or=Z.Mc,xr=Z.Nc,Nr=$.ka,jr=$.ka+$.T,rn=$.U,Kr=rn+1>>1;for(Nr==0?tt(We,ft,null,null,Et,Vt,vr,St,Et,Vt,vr,St,He,Je,null,null,rn):(tt(Z.ec,Z.fc,We,ft,Qt,Ut,Or,xr,Et,Vt,vr,St,He,Je-Pe.A,He,Je,rn),++de);Nr+2<jr;Nr+=2)Qt=Et,Ut=Vt,Or=vr,xr=St,Vt+=$.Rc,St+=$.Rc,Je+=2*Pe.A,tt(We,(ft+=2*$.fa)-$.fa,We,ft,Qt,Ut,Or,xr,Et,Vt,vr,St,He,Je-Pe.A,He,Je,rn);return ft+=$.fa,$.j+jr<$.o?(n(Z.ec,Z.fc,We,ft,rn),n(Z.cc,Z.dc,Et,Vt,Kr),n(Z.Mc,Z.Nc,vr,St,Kr),de--):1&jr||tt(We,ft,null,null,Et,Vt,vr,St,Et,Vt,vr,St,He,Je+Pe.A,null,null,rn),de}function ar($,Z,de){var Pe=$.F,He=[$.J];if(Pe!=null){var Je=$.U,tt=Z.ba.S,We=tt==ip||tt==ch;Z=Z.ba.f.RGBA;var ft=[0],Et=$.ka;ft[0]=$.T,$.Kb&&(Et==0?--ft[0]:(--Et,He[0]-=$.width),$.j+$.ka+$.T==$.o&&(ft[0]=$.o-$.j-Et));var Vt=Z.eb;Et=Z.fb+Et*Z.A,$=Ga(Pe,He[0],$.width,Je,ft,Vt,Et+(We?0:3),Z.A),e(de==ft),$&&Jt(tt)&&ia(Vt,Et,We,Je,ft,Z.A)}return 0}function ti($){var Z=$.ma,de=Z.ba.S,Pe=11>de,He=de==uh||de==cc||de==ip||de==ap||de==12||Jt(de);if(Z.memory=null,Z.Ib=null,Z.Jb=null,Z.Nd=null,!Ao(Z.Oa,$,He?11:12))return 0;if(He&&Jt(de)&&xl(),$.da)alert("todo:use_scaling");else{if(Pe){if(Z.Ib=Gr,$.Kb){if(de=$.U+1>>1,Z.memory=a($.U+2*de),Z.memory==null)return 0;Z.ec=Z.memory,Z.fc=0,Z.cc=Z.ec,Z.dc=Z.fc+$.U,Z.Mc=Z.cc,Z.Nc=Z.dc+de,Z.Ib=Jr,xl()}}else alert("todo:EmitYUV");He&&(Z.Jb=ar,Pe&&Dl())}if(Pe&&!hp){for($=0;256>$;++$)iy[$]=89858*($-128)+ql>>md,wg[$]=-22014*($-128)+ql,Ef[$]=-45773*($-128),ay[$]=113618*($-128)+ql>>md;for($=hc;$<al;++$)Z=76283*($-16)+ql>>md,Tf[$-hc]=Wa(Z,255),oy[$-hc]=Wa(Z+8>>4,15);hp=1}return 1}function un($){var Z=$.ma,de=$.U,Pe=$.T;return e(!(1&$.ka)),0>=de||0>=Pe?0:(de=Z.Ib($,Z),Z.Jb!=null&&Z.Jb($,Z,de),Z.Dc+=de,1)}function ri($){$.ma.memory=null}function Ae($,Z,de,Pe){return ke($,8)!=47?0:(Z[0]=ke($,14)+1,de[0]=ke($,14)+1,Pe[0]=ke($,1),ke($,3)!=0?0:!$.h)}function Be($,Z){if(4>$)return $+1;var de=$-2>>1;return(2+(1&$)<<de)+ke(Z,de)+1}function mt($,Z){return 120<Z?Z-120:1<=(de=((de=op[Z-1])>>4)*$+(8-(15&de)))?de:1;var de}function pt($,Z,de){var Pe=xe(de),He=$[Z+=255&Pe].g-8;return 0<He&&(Oe(de,de.u+8),Pe=xe(de),Z+=$[Z].value,Z+=Pe&(1<<He)-1),Oe(de,de.u+$[Z].g),$[Z].value}function Ir($,Z,de){return de.g+=$.g,de.value+=$.value<<Z>>>0,e(8>=de.g),$.g}function Fr($,Z,de){var Pe=$.xc;return e((Z=Pe==0?0:$.vc[$.md*(de>>Pe)+(Z>>Pe)])<$.Wb),$.Ya[Z]}function qn($,Z,de,Pe){var He=$.ab,Je=$.c*Z,tt=$.C;Z=tt+Z;var We=de,ft=Pe;for(Pe=$.Ta,de=$.Ua;0<He--;){var Et=$.gc[He],Vt=tt,vr=Z,St=We,Qt=ft,Ut=(ft=Pe,We=de,Et.Ea);switch(e(Vt<vr),e(vr<=Et.nc),Et.hc){case 2:jl(St,Qt,(vr-Vt)*Ut,ft,We);break;case 0:var Or=Vt,xr=vr,Nr=ft,jr=We,rn=(Gn=Et).Ea;Or==0&&(il(St,Qt,null,null,1,Nr,jr),Ar(St,Qt+1,0,0,rn-1,Nr,jr+1),Qt+=rn,jr+=rn,++Or);for(var Kr=1<<Gn.b,Kn=Kr-1,zn=vt(rn,Gn.b),Li=Gn.K,Gn=Gn.w+(Or>>Gn.b)*zn;Or<xr;){var ea=Li,Qo=Gn,yi=1;for(zs(St,Qt,Nr,jr-rn,1,Nr,jr);yi<rn;){var mn=(yi&~Kn)+Kr;mn>rn&&(mn=rn),(0,$t[ea[Qo++]>>8&15])(St,Qt+ +yi,Nr,jr+yi-rn,mn-yi,Nr,jr+yi),yi=mn}Qt+=rn,jr+=rn,++Or&Kn||(Gn+=zn)}vr!=Et.nc&&n(ft,We-Ut,ft,We+(vr-Vt-1)*Ut,Ut);break;case 1:for(Ut=St,xr=Qt,rn=(St=Et.Ea)-(jr=St&~(Nr=(Qt=1<<Et.b)-1)),Or=vt(St,Et.b),Kr=Et.K,Et=Et.w+(Vt>>Et.b)*Or;Vt<vr;){for(Kn=Kr,zn=Et,Li=new cr,Gn=xr+jr,ea=xr+St;xr<Gn;)nt(Kn[zn++],Li),tr(Li,Ut,xr,Qt,ft,We),xr+=Qt,We+=Qt;xr<ea&&(nt(Kn[zn++],Li),tr(Li,Ut,xr,rn,ft,We),xr+=rn,We+=rn),++Vt&Nr||(Et+=Or)}break;case 3:if(St==ft&&Qt==We&&0<Et.b){for(xr=ft,St=Ut=We+(vr-Vt)*Ut-(jr=(vr-Vt)*vt(Et.Ea,Et.b)),Qt=ft,Nr=We,Or=[],jr=(rn=jr)-1;0<=jr;--jr)Or[jr]=Qt[Nr+jr];for(jr=rn-1;0<=jr;--jr)xr[St+jr]=Or[jr];Cu(Et,Vt,vr,ft,Ut,ft,We)}else Cu(Et,Vt,vr,St,Qt,ft,We)}We=Pe,ft=de}ft!=de&&n(Pe,de,We,ft,Je)}function Oi($,Z){var de=$.V,Pe=$.Ba+$.c*$.C,He=Z-$.C;if(e(Z<=$.l.o),e(16>=He),0<He){var Je=$.l,tt=$.Ta,We=$.Ua,ft=Je.width;if(qn($,He,de,Pe),He=We=[We],e((de=$.C)<(Pe=Z)),e(Je.v<Je.va),Pe>Je.o&&(Pe=Je.o),de<Je.j){var Et=Je.j-de;de=Je.j,He[0]+=Et*ft}if(de>=Pe?de=0:(He[0]+=4*Je.v,Je.ka=de-Je.j,Je.U=Je.va-Je.v,Je.T=Pe-de,de=1),de){if(We=We[0],11>(de=$.ca).S){var Vt=de.f.RGBA,vr=(Pe=de.S,He=Je.U,Je=Je.T,Et=Vt.eb,Vt.A),St=Je;for(Vt=Vt.fb+$.Ma*Vt.A;0<St--;){var Qt=tt,Ut=We,Or=He,xr=Et,Nr=Vt;switch(Pe){case Oc:sn(Qt,Ut,Or,xr,Nr);break;case uh:Cn(Qt,Ut,Or,xr,Nr);break;case fd:Cn(Qt,Ut,Or,xr,Nr),ia(xr,Nr,0,Or,1,0);break;case $l:A(Qt,Ut,Or,xr,Nr);break;case cc:_t(Qt,Ut,Or,xr,Nr,1);break;case _f:_t(Qt,Ut,Or,xr,Nr,1),ia(xr,Nr,0,Or,1,0);break;case ip:_t(Qt,Ut,Or,xr,Nr,0);break;case ch:_t(Qt,Ut,Or,xr,Nr,0),ia(xr,Nr,1,Or,1,0);break;case ap:bi(Qt,Ut,Or,xr,Nr);break;case Bh:bi(Qt,Ut,Or,xr,Nr),Ta(xr,Nr,Or,1,0);break;case ey:An(Qt,Ut,Or,xr,Nr);break;default:e(0)}We+=ft,Vt+=vr}$.Ma+=Je}else alert("todo:EmitRescaledRowsYUVA");e($.Ma<=de.height)}}$.C=Z,e($.C<=$.i)}function zr($){var Z;if(0<$.ua)return 0;for(Z=0;Z<$.Wb;++Z){var de=$.Ya[Z].G,Pe=$.Ya[Z].H;if(0<de[1][Pe[1]+0].g||0<de[2][Pe[2]+0].g||0<de[3][Pe[3]+0].g)return 0}return 1}function bn($,Z,de,Pe,He,Je){if($.Z!=0){var tt=$.qd,We=$.rd;for(e(Lc[$.Z]!=null);Z<de;++Z)Lc[$.Z](tt,We,Pe,He,Pe,He,Je),tt=Pe,We=He,He+=Je;$.qd=tt,$.rd=We}}function Tn($,Z){var de=$.l.ma,Pe=de.Z==0||de.Z==1?$.l.j:$.C;if(Pe=$.C<Pe?Pe:$.C,e(Z<=$.l.o),Z>Pe){var He=$.l.width,Je=de.ca,tt=de.tb+He*Pe,We=$.V,ft=$.Ba+$.c*Pe,Et=$.gc;e($.ab==1),e(Et[0].hc==3),ou(Et[0],Pe,Z,We,ft,Je,tt),bn(de,Pe,Z,Je,tt,He)}$.C=$.Ma=Z}function Mi($,Z,de,Pe,He,Je,tt){var We=$.$/Pe,ft=$.$%Pe,Et=$.m,Vt=$.s,vr=de+$.$,St=vr;He=de+Pe*He;var Qt=de+Pe*Je,Ut=280+Vt.ua,Or=$.Pb?We:16777216,xr=0<Vt.ua?Vt.Wa:null,Nr=Vt.wc,jr=vr<Qt?Fr(Vt,ft,We):null;e($.C<Je),e(Qt<=He);var rn=!1;e:for(;;){for(;rn||vr<Qt;){var Kr=0;if(We>=Or){var Kn=vr-de;e((Or=$).Pb),Or.wd=Or.m,Or.xd=Kn,0<Or.s.ua&&Xt(Or.s.Wa,Or.s.vb),Or=We+zh}if(ft&Nr||(jr=Fr(Vt,ft,We)),e(jr!=null),jr.Qb&&(Z[vr]=jr.qb,rn=!0),!rn)if($e(Et),jr.jc){Kr=Et,Kn=Z;var zn=vr,Li=jr.pd[xe(Kr)&wo-1];e(jr.jc),256>Li.g?(Oe(Kr,Kr.u+Li.g),Kn[zn]=Li.value,Kr=0):(Oe(Kr,Kr.u+Li.g-256),e(256<=Li.value),Kr=Li.value),Kr==0&&(rn=!0)}else Kr=pt(jr.G[0],jr.H[0],Et);if(Et.h)break;if(rn||256>Kr){if(!rn)if(jr.nd)Z[vr]=(jr.qb|Kr<<8)>>>0;else{if($e(Et),rn=pt(jr.G[1],jr.H[1],Et),$e(Et),Kn=pt(jr.G[2],jr.H[2],Et),zn=pt(jr.G[3],jr.H[3],Et),Et.h)break;Z[vr]=(zn<<24|rn<<16|Kr<<8|Kn)>>>0}if(rn=!1,++vr,++ft>=Pe&&(ft=0,++We,tt!=null&&We<=Je&&!(We%16)&&tt($,We),xr!=null))for(;St<vr;)Kr=Z[St++],xr.X[(506832829*Kr&4294967295)>>>xr.Mb]=Kr}else if(280>Kr){if(Kr=Be(Kr-256,Et),Kn=pt(jr.G[4],jr.H[4],Et),$e(Et),Kn=mt(Pe,Kn=Be(Kn,Et)),Et.h)break;if(vr-de<Kn||He-vr<Kr)break e;for(zn=0;zn<Kr;++zn)Z[vr+zn]=Z[vr+zn-Kn];for(vr+=Kr,ft+=Kr;ft>=Pe;)ft-=Pe,++We,tt!=null&&We<=Je&&!(We%16)&&tt($,We);if(e(vr<=He),ft&Nr&&(jr=Fr(Vt,ft,We)),xr!=null)for(;St<vr;)Kr=Z[St++],xr.X[(506832829*Kr&4294967295)>>>xr.Mb]=Kr}else{if(!(Kr<Ut))break e;for(rn=Kr-280,e(xr!=null);St<vr;)Kr=Z[St++],xr.X[(506832829*Kr&4294967295)>>>xr.Mb]=Kr;Kr=vr,e(!(rn>>>(Kn=xr).Xa)),Z[Kr]=Kn.X[rn],rn=!0}rn||e(Et.h==Ne(Et))}if($.Pb&&Et.h&&vr<He)e($.m.h),$.a=5,$.m=$.wd,$.$=$.xd,0<$.s.ua&&Xt($.s.vb,$.s.Wa);else{if(Et.h)break e;tt?.($,We>Je?Je:We),$.a=0,$.$=vr-de}return 1}return $.a=3,0}function pi($){e($!=null),$.vc=null,$.yc=null,$.Ya=null;var Z=$.Wa;Z!=null&&(Z.X=null),$.vb=null,e($!=null)}function Wi(){var $=new $i;return $==null?null:($.a=0,$.xb=wf,jt("Predictor","VP8LPredictors"),jt("Predictor","VP8LPredictors_C"),jt("PredictorAdd","VP8LPredictorsAdd"),jt("PredictorAdd","VP8LPredictorsAdd_C"),jl=ir,tr=_e,sn=qe,Cn=Qe,bi=ot,An=et,A=Lt,G.VP8LMapColor32b=js,G.VP8LMapColor8b=Ul,$)}function Fn($,Z,de,Pe,He){var Je=1,tt=[$],We=[Z],ft=Pe.m,Et=Pe.s,Vt=null,vr=0;e:for(;;){if(de)for(;Je&&ke(ft,1);){var St=tt,Qt=We,Ut=Pe,Or=1,xr=Ut.m,Nr=Ut.gc[Ut.ab],jr=ke(xr,2);if(Ut.Oc&1<<jr)Je=0;else{switch(Ut.Oc|=1<<jr,Nr.hc=jr,Nr.Ea=St[0],Nr.nc=Qt[0],Nr.K=[null],++Ut.ab,e(4>=Ut.ab),jr){case 0:case 1:Nr.b=ke(xr,3)+2,Or=Fn(vt(Nr.Ea,Nr.b),vt(Nr.nc,Nr.b),0,Ut,Nr.K),Nr.K=Nr.K[0];break;case 3:var rn,Kr=ke(xr,8)+1,Kn=16<Kr?0:4<Kr?1:2<Kr?2:3;if(St[0]=vt(Nr.Ea,Kn),Nr.b=Kn,rn=Or=Fn(Kr,1,0,Ut,Nr.K)){var zn,Li=Kr,Gn=Nr,ea=1<<(8>>Gn.b),Qo=a(ea);if(Qo==null)rn=0;else{var yi=Gn.K[0],mn=Gn.w;for(Qo[0]=Gn.K[0][0],zn=1;zn<1*Li;++zn)Qo[zn]=yr(yi[mn+zn],Qo[zn-1]);for(;zn<4*ea;++zn)Qo[zn]=0;Gn.K[0]=null,Gn.K[0]=Qo,rn=1}}Or=rn;break;case 2:break;default:e(0)}Je=Or}}if(tt=tt[0],We=We[0],Je&&ke(ft,1)&&!(Je=1<=(vr=ke(ft,4))&&11>=vr)){Pe.a=3;break e}var _n;if(_n=Je)t:{var So,ki,ta,za=Pe,Ss=tt,fo=We,to=vr,xn=de,On=za.m,Io=za.s,zi=[null],la=1,ra=0,_a=pg[to];r:for(;;){if(xn&&ke(On,1)){var Oa=ke(On,3)+2,Zu=vt(Ss,Oa),ro=vt(fo,Oa),Ni=Zu*ro;if(!Fn(Zu,ro,0,za,zi))break r;for(zi=zi[0],Io.xc=Oa,So=0;So<Ni;++So){var wi=zi[So]>>8&65535;zi[So]=wi,wi>=la&&(la=wi+1)}}if(On.h)break r;for(ki=0;5>ki;++ki){var Po=bf[ki];!ki&&0<to&&(Po+=1<<to),ra<Po&&(ra=Po)}var Es=s(la*_a,ne),es=la,Tl=s(es,ce);if(Tl==null)var Ts=null;else e(65536>=es),Ts=Tl;var ts=a(ra);if(Ts==null||ts==null||Es==null){za.a=1;break r}var Vs=Es;for(So=ta=0;So<la;++So){var Ca=Ts[So],fs=Ca.G,su=Ca.H,Dc=0,Au=1,ds=0;for(ki=0;5>ki;++ki){Po=bf[ki],fs[ki]=Vs,su[ki]=ta,!ki&&0<to&&(Po+=1<<to);i:{var R,l=Po,m=za,w=ts,C=Vs,N=ta,j=0,Y=m.m,te=ke(Y,1);if(i(w,0,0,l),te){var ue=ke(Y,1)+1,ge=ke(Y,1),Ce=ke(Y,ge==0?1:8);w[Ce]=1,ue==2&&(w[Ce=ke(Y,8)]=1);var Se=1}else{var Fe=a(19),Ge=ke(Y,4)+4;if(19<Ge){m.a=3;var ut=0;break i}for(R=0;R<Ge;++R)Fe[pd[R]]=ke(Y,3);var lt=void 0,ct=void 0,xt=m,Pt=Fe,Ct=l,Ot=w,Bt=0,At=xt.m,qt=8,Sr=s(128,ne);n:for(;H(Sr,0,7,Pt,19);){if(ke(At,1)){var fr=2+2*ke(At,3);if((lt=2+ke(At,fr))>Ct)break n}else lt=Ct;for(ct=0;ct<Ct&&lt--;){$e(At);var dr=Sr[0+(127&xe(At))];Oe(At,At.u+dr.g);var mr=dr.value;if(16>mr)Ot[ct++]=mr,mr!=0&&(qt=mr);else{var tn=mr==16,nn=mr-16,qr=ty[nn],Ln=ke(At,dg[nn])+qr;if(ct+Ln>Ct)break n;for(var Pi=tn?qt:0;0<Ln--;)Ot[ct++]=Pi}}Bt=1;break n}Bt||(xt.a=3),Se=Bt}(Se=Se&&!Y.h)&&(j=H(C,N,8,w,l)),Se&&j!=0?ut=j:(m.a=3,ut=0)}if(ut==0)break r;if(Au&&dd[ki]==1&&(Au=Vs[ta].g==0),Dc+=Vs[ta].g,ta+=ut,3>=ki){var Xi,da=ts[0];for(Xi=1;Xi<Po;++Xi)ts[Xi]>da&&(da=ts[Xi]);ds+=da}}if(Ca.nd=Au,Ca.Qb=0,Au&&(Ca.qb=(fs[3][su[3]+0].value<<24|fs[1][su[1]+0].value<<16|fs[2][su[2]+0].value)>>>0,Dc==0&&256>fs[0][su[0]+0].value&&(Ca.Qb=1,Ca.qb+=fs[0][su[0]+0].value<<8)),Ca.jc=!Ca.Qb&&6>ds,Ca.jc){var oa,ua=Ca;for(oa=0;oa<wo;++oa){var ba=oa,ci=ua.pd[ba],ca=ua.G[0][ua.H[0]+ba];256<=ca.value?(ci.g=ca.g+256,ci.value=ca.value):(ci.g=0,ci.value=0,ba>>=Ir(ca,8,ci),ba>>=Ir(ua.G[1][ua.H[1]+ba],16,ci),ba>>=Ir(ua.G[2][ua.H[2]+ba],0,ci),Ir(ua.G[3][ua.H[3]+ba],24,ci))}}}Io.vc=zi,Io.Wb=la,Io.Ya=Ts,Io.yc=Es,_n=1;break t}_n=0}if(!(Je=_n)){Pe.a=3;break e}if(0<vr){if(Et.ua=1<<vr,!je(Et.Wa,vr)){Pe.a=1,Je=0;break e}}else Et.ua=0;var ko=Pe,rs=tt,Cs=We,$s=ko.s,lu=$s.xc;if(ko.c=rs,ko.i=Cs,$s.md=vt(rs,lu),$s.wc=lu==0?-1:(1<<lu)-1,de){Pe.xb=lp;break e}if((Vt=a(tt*We))==null){Pe.a=1,Je=0;break e}Je=(Je=Mi(Pe,Vt,0,tt,We,We,null))&&!ft.h;break e}return Je?(He!=null?He[0]=Vt:(e(Vt==null),e(de)),Pe.$=0,de||pi(Et)):pi(Et),Je}function Ia($,Z){var de=$.c*$.i,Pe=de+Z+16*Z;return e($.c<=Z),$.V=a(Pe),$.V==null?($.Ta=null,$.Ua=0,$.a=1,0):($.Ta=$.V,$.Ua=$.Ba+de+Z,1)}function ma($,Z){var de=$.C,Pe=Z-de,He=$.V,Je=$.Ba+$.c*de;for(e(Z<=$.l.o);0<Pe;){var tt=16<Pe?16:Pe,We=$.l.ma,ft=$.l.width,Et=ft*tt,Vt=We.ca,vr=We.tb+ft*de,St=$.Ta,Qt=$.Ua;qn($,tt,He,Je),Bo(St,Qt,Vt,vr,Et),bn(We,de,de+tt,Vt,vr,ft),Pe-=tt,He+=tt*$.c,de+=tt}e(de==Z),$.C=$.Ma=Z}function Gi(){this.ub=this.yd=this.td=this.Rb=0}function Ka(){this.Kd=this.Ld=this.Ud=this.Td=this.i=this.c=0}function xa(){this.Fb=this.Bb=this.Cb=0,this.Zb=a(4),this.Lb=a(4)}function Ui(){this.Yb=(function(){var $=[];return(function Z(de,Pe,He){for(var Je=He[Pe],tt=0;tt<Je&&(de.push(He.length>Pe+1?[]:0),!(He.length<Pe+1));tt++)Z(de[tt],Pe+1,He)})($,0,[3,11]),$})()}function oo(){this.jb=a(3),this.Wc=o([4,8],Ui),this.Xc=o([4,17],Ui)}function Ja(){this.Pc=this.wb=this.Tb=this.zd=0,this.vd=new a(4),this.od=new a(4)}function Hn(){this.ld=this.La=this.dd=this.tc=0}function bu(){this.Na=this.la=0}function ru(){this.Sc=[0,0],this.Eb=[0,0],this.Qc=[0,0],this.ia=this.lc=0}function Pa(){this.ad=a(384),this.Za=0,this.Ob=a(16),this.$b=this.Ad=this.ia=this.Gc=this.Hc=this.Dd=0}function wa(){this.uc=this.M=this.Nb=0,this.wa=Array(new Hn),this.Y=0,this.ya=Array(new Pa),this.aa=0,this.l=new ls}function Wo(){this.y=a(16),this.f=a(8),this.ea=a(8)}function No(){this.cb=this.a=0,this.sc="",this.m=new he,this.Od=new Gi,this.Kc=new Ka,this.ed=new Ja,this.Qa=new xa,this.Ic=this.$c=this.Aa=0,this.D=new wa,this.Xb=this.Va=this.Hb=this.zb=this.yb=this.Ub=this.za=0,this.Jc=s(8,he),this.ia=0,this.pb=s(4,ru),this.Pa=new oo,this.Bd=this.kc=0,this.Ac=[],this.Bc=0,this.zc=[0,0,0,0],this.Gd=Array(new Wo),this.Hd=0,this.rb=Array(new bu),this.sb=0,this.wa=Array(new Hn),this.Y=0,this.oc=[],this.pc=0,this.sa=[],this.ta=0,this.qa=[],this.ra=0,this.Ha=[],this.B=this.R=this.Ia=0,this.Ec=[],this.M=this.ja=this.Vb=this.Fc=0,this.ya=Array(new Pa),this.L=this.aa=0,this.gd=o([4,2],Hn),this.ga=null,this.Fa=[],this.Cc=this.qc=this.P=0,this.Gb=[],this.Uc=0,this.mb=[],this.nb=0,this.rc=[],this.Ga=this.Vc=0}function ls(){this.T=this.U=this.ka=this.height=this.width=0,this.y=[],this.f=[],this.ea=[],this.Rc=this.fa=this.W=this.N=this.O=0,this.ma="void",this.put="VP8IoPutHook",this.ac="VP8IoSetupHook",this.bc="VP8IoTeardownHook",this.ha=this.Kb=0,this.data=[],this.hb=this.ib=this.da=this.o=this.j=this.va=this.v=this.Da=this.ob=this.w=0,this.F=[],this.J=0}function kc(){var $=new No;return $!=null&&($.a=0,$.sc="OK",$.cb=0,$.Xb=0,Xu||(Xu=vl)),$}function Sa($,Z,de){return $.a==0&&($.a=Z,$.sc=de,$.cb=0),0}function Mc($,Z,de){return 3<=de&&$[Z+0]==157&&$[Z+1]==1&&$[Z+2]==42}function Rc($,Z){if($==null)return 0;if($.a=0,$.sc="OK",Z==null)return Sa($,2,"null VP8Io passed to VP8GetHeaders()");var de=Z.data,Pe=Z.w,He=Z.ha;if(4>He)return Sa($,7,"Truncated header.");var Je=de[Pe+0]|de[Pe+1]<<8|de[Pe+2]<<16,tt=$.Od;if(tt.Rb=!(1&Je),tt.td=Je>>1&7,tt.yd=Je>>4&1,tt.ub=Je>>5,3<tt.td)return Sa($,3,"Incorrect keyframe parameters.");if(!tt.yd)return Sa($,4,"Frame not displayable.");Pe+=3,He-=3;var We=$.Kc;if(tt.Rb){if(7>He)return Sa($,7,"cannot parse picture header");if(!Mc(de,Pe,He))return Sa($,3,"Bad code word");We.c=16383&(de[Pe+4]<<8|de[Pe+3]),We.Td=de[Pe+4]>>6,We.i=16383&(de[Pe+6]<<8|de[Pe+5]),We.Ud=de[Pe+6]>>6,Pe+=7,He-=7,$.za=We.c+15>>4,$.Ub=We.i+15>>4,Z.width=We.c,Z.height=We.i,Z.Da=0,Z.j=0,Z.v=0,Z.va=Z.width,Z.o=Z.height,Z.da=0,Z.ib=Z.width,Z.hb=Z.height,Z.U=Z.width,Z.T=Z.height,i((Je=$.Pa).jb,0,255,Je.jb.length),e((Je=$.Qa)!=null),Je.Cb=0,Je.Bb=0,Je.Fb=1,i(Je.Zb,0,0,Je.Zb.length),i(Je.Lb,0,0,Je.Lb)}if(tt.ub>He)return Sa($,7,"bad partition length");fe(Je=$.m,de,Pe,tt.ub),Pe+=tt.ub,He-=tt.ub,tt.Rb&&(We.Ld=it(Je),We.Kd=it(Je)),We=$.Qa;var ft,Et=$.Pa;if(e(Je!=null),e(We!=null),We.Cb=it(Je),We.Cb){if(We.Bb=it(Je),it(Je)){for(We.Fb=it(Je),ft=0;4>ft;++ft)We.Zb[ft]=it(Je)?me(Je,7):0;for(ft=0;4>ft;++ft)We.Lb[ft]=it(Je)?me(Je,6):0}if(We.Bb)for(ft=0;3>ft;++ft)Et.jb[ft]=it(Je)?Me(Je,8):255}else We.Bb=0;if(Je.Ka)return Sa($,3,"cannot parse segment header");if((We=$.ed).zd=it(Je),We.Tb=Me(Je,6),We.wb=Me(Je,3),We.Pc=it(Je),We.Pc&&it(Je)){for(Et=0;4>Et;++Et)it(Je)&&(We.vd[Et]=me(Je,6));for(Et=0;4>Et;++Et)it(Je)&&(We.od[Et]=me(Je,6))}if($.L=We.Tb==0?0:We.zd?1:2,Je.Ka)return Sa($,3,"cannot parse filter header");var Vt=He;if(He=ft=Pe,Pe=ft+Vt,We=Vt,$.Xb=(1<<Me($.m,2))-1,Vt<3*(Et=$.Xb))de=7;else{for(ft+=3*Et,We-=3*Et,Vt=0;Vt<Et;++Vt){var vr=de[He+0]|de[He+1]<<8|de[He+2]<<16;vr>We&&(vr=We),fe($.Jc[+Vt],de,ft,vr),ft+=vr,We-=vr,He+=3}fe($.Jc[+Et],de,ft,We),de=ft<Pe?0:5}if(de!=0)return Sa($,de,"cannot parse partitions");for(de=Me(ft=$.m,7),He=it(ft)?me(ft,4):0,Pe=it(ft)?me(ft,4):0,We=it(ft)?me(ft,4):0,Et=it(ft)?me(ft,4):0,ft=it(ft)?me(ft,4):0,Vt=$.Qa,vr=0;4>vr;++vr){if(Vt.Cb){var St=Vt.Zb[vr];Vt.Fb||(St+=de)}else{if(0<vr){$.pb[vr]=$.pb[0];continue}St=de}var Qt=$.pb[vr];Qt.Sc[0]=gd[Wa(St+He,127)],Qt.Sc[1]=xf[Wa(St+0,127)],Qt.Eb[0]=2*gd[Wa(St+Pe,127)],Qt.Eb[1]=101581*xf[Wa(St+We,127)]>>16,8>Qt.Eb[1]&&(Qt.Eb[1]=8),Qt.Qc[0]=gd[Wa(St+Et,117)],Qt.Qc[1]=xf[Wa(St+ft,127)],Qt.lc=St+ft}if(!tt.Rb)return Sa($,4,"Not a key frame.");for(it(Je),tt=$.Pa,de=0;4>de;++de){for(He=0;8>He;++He)for(Pe=0;3>Pe;++Pe)for(We=0;11>We;++We)Et=Ye(Je,Y0[de][He][Pe][We])?Me(Je,8):sp[de][He][Pe][We],tt.Wc[de][He].Yb[Pe][We]=Et;for(He=0;17>He;++He)tt.Xc[de][He]=tt.Wc[de][vg[He]]}return $.kc=it(Je),$.kc&&($.Bd=Me(Je,8)),$.cb=1}function vl($,Z,de,Pe,He,Je,tt){var We=Z[He].Yb[de];for(de=0;16>He;++He){if(!Ye($,We[de+0]))return He;for(;!Ye($,We[de+1]);)if(We=Z[++He].Yb[0],de=0,He==16)return 16;var ft=Z[He+1].Yb;if(Ye($,We[de+2])){var Et=$,Vt=0;if(Ye(Et,(St=We)[(vr=de)+3]))if(Ye(Et,St[vr+6])){for(We=0,vr=2*(Vt=Ye(Et,St[vr+8]))+(St=Ye(Et,St[vr+9+Vt])),Vt=0,St=gg[vr];St[We];++We)Vt+=Vt+Ye(Et,St[We]);Vt+=3+(8<<vr)}else Ye(Et,St[vr+7])?(Vt=7+2*Ye(Et,165),Vt+=Ye(Et,145)):Vt=5+Ye(Et,159);else Vt=Ye(Et,St[vr+4])?3+Ye(Et,St[vr+5]):2;We=ft[2]}else Vt=1,We=ft[1];ft=tt+ry[He],0>(Et=$).b&&De(Et);var vr,St=Et.b,Qt=(vr=Et.Ca>>1)-(Et.I>>St)>>31;--Et.b,Et.Ca+=Qt,Et.Ca|=1,Et.I-=(vr+1&Qt)<<St,Je[ft]=((Vt^Qt)-Qt)*Pe[(0<He)+0]}return 16}function Qs($){var Z=$.rb[$.sb-1];Z.la=0,Z.Na=0,i($.zc,0,0,$.zc.length),$.ja=0}function Ha($,Z,de,Pe,He){He=$[Z+de+32*Pe]+(He>>3),$[Z+de+32*Pe]=-256&He?0>He?0:255:He}function so($,Z,de,Pe,He,Je){Ha($,Z,0,de,Pe+He),Ha($,Z,1,de,Pe+Je),Ha($,Z,2,de,Pe-Je),Ha($,Z,3,de,Pe-He)}function ka($){return(20091*$>>16)+$}function el($,Z,de,Pe){var He,Je=0,tt=a(16);for(He=0;4>He;++He){var We=$[Z+0]+$[Z+8],ft=$[Z+0]-$[Z+8],Et=(35468*$[Z+4]>>16)-ka($[Z+12]),Vt=ka($[Z+4])+(35468*$[Z+12]>>16);tt[Je+0]=We+Vt,tt[Je+1]=ft+Et,tt[Je+2]=ft-Et,tt[Je+3]=We-Vt,Je+=4,Z++}for(He=Je=0;4>He;++He)We=($=tt[Je+0]+4)+tt[Je+8],ft=$-tt[Je+8],Et=(35468*tt[Je+4]>>16)-ka(tt[Je+12]),Ha(de,Pe,0,0,We+(Vt=ka(tt[Je+4])+(35468*tt[Je+12]>>16))),Ha(de,Pe,1,0,ft+Et),Ha(de,Pe,2,0,ft-Et),Ha(de,Pe,3,0,We-Vt),Je++,Pe+=32}function xu($,Z,de,Pe){var He=$[Z+0]+4,Je=35468*$[Z+4]>>16,tt=ka($[Z+4]),We=35468*$[Z+1]>>16;so(de,Pe,0,He+tt,$=ka($[Z+1]),We),so(de,Pe,1,He+Je,$,We),so(de,Pe,2,He-Je,$,We),so(de,Pe,3,He-tt,$,We)}function wu($,Z,de,Pe,He){el($,Z,de,Pe),He&&el($,Z+16,de,Pe+4)}function J($,Z,de,Pe){_($,Z+0,de,Pe,1),_($,Z+32,de,Pe+128,1)}function pe($,Z,de,Pe){var He;for($=$[Z+0]+4,He=0;4>He;++He)for(Z=0;4>Z;++Z)Ha(de,Pe,Z,He,$)}function Xe($,Z,de,Pe){$[Z+0]&&re($,Z+0,de,Pe),$[Z+16]&&re($,Z+16,de,Pe+4),$[Z+32]&&re($,Z+32,de,Pe+128),$[Z+48]&&re($,Z+48,de,Pe+128+4)}function Tt($,Z,de,Pe){var He,Je=a(16);for(He=0;4>He;++He){var tt=$[Z+0+He]+$[Z+12+He],We=$[Z+4+He]+$[Z+8+He],ft=$[Z+4+He]-$[Z+8+He],Et=$[Z+0+He]-$[Z+12+He];Je[0+He]=tt+We,Je[8+He]=tt-We,Je[4+He]=Et+ft,Je[12+He]=Et-ft}for(He=0;4>He;++He)tt=($=Je[0+4*He]+3)+Je[3+4*He],We=Je[1+4*He]+Je[2+4*He],ft=Je[1+4*He]-Je[2+4*He],Et=$-Je[3+4*He],de[Pe+0]=tt+We>>3,de[Pe+16]=Et+ft>>3,de[Pe+32]=tt-We>>3,de[Pe+48]=Et-ft>>3,Pe+=64}function Nt($,Z,de){var Pe,He=Z-32,Je=Zn,tt=255-$[He-1];for(Pe=0;Pe<de;++Pe){var We,ft=Je,Et=tt+$[Z-1];for(We=0;We<de;++We)$[Z+We]=ft[Et+$[He+We]];Z+=32}}function kt($,Z){Nt($,Z,4)}function Gt($,Z){Nt($,Z,8)}function $r($,Z){Nt($,Z,16)}function Yr($,Z){var de;for(de=0;16>de;++de)n($,Z+32*de,$,Z-32,16)}function Hr($,Z){var de;for(de=16;0<de;--de)i($,Z,$[Z-1],16),Z+=32}function kr($,Z,de){var Pe;for(Pe=0;16>Pe;++Pe)i(Z,de+32*Pe,$,16)}function Qr($,Z){var de,Pe=16;for(de=0;16>de;++de)Pe+=$[Z-1+32*de]+$[Z+de-32];kr(Pe>>5,$,Z)}function Qn($,Z){var de,Pe=8;for(de=0;16>de;++de)Pe+=$[Z-1+32*de];kr(Pe>>4,$,Z)}function Ei($,Z){var de,Pe=8;for(de=0;16>de;++de)Pe+=$[Z+de-32];kr(Pe>>4,$,Z)}function En($,Z){kr(128,$,Z)}function pn($,Z,de){return $+2*Z+de+2>>2}function Mr($,Z){var de,Pe=Z-32;for(Pe=new Uint8Array([pn($[Pe-1],$[Pe+0],$[Pe+1]),pn($[Pe+0],$[Pe+1],$[Pe+2]),pn($[Pe+1],$[Pe+2],$[Pe+3]),pn($[Pe+2],$[Pe+3],$[Pe+4])]),de=0;4>de;++de)n($,Z+32*de,Pe,0,Pe.length)}function cn($,Z){var de=$[Z-1],Pe=$[Z-1+32],He=$[Z-1+64],Je=$[Z-1+96];rt($,Z+0,16843009*pn($[Z-1-32],de,Pe)),rt($,Z+32,16843009*pn(de,Pe,He)),rt($,Z+64,16843009*pn(Pe,He,Je)),rt($,Z+96,16843009*pn(He,Je,Je))}function Wn($,Z){var de,Pe=4;for(de=0;4>de;++de)Pe+=$[Z+de-32]+$[Z-1+32*de];for(Pe>>=3,de=0;4>de;++de)i($,Z+32*de,Pe,4)}function Ma($,Z){var de=$[Z-1+0],Pe=$[Z-1+32],He=$[Z-1+64],Je=$[Z-1-32],tt=$[Z+0-32],We=$[Z+1-32],ft=$[Z+2-32],Et=$[Z+3-32];$[Z+0+96]=pn(Pe,He,$[Z-1+96]),$[Z+1+96]=$[Z+0+64]=pn(de,Pe,He),$[Z+2+96]=$[Z+1+64]=$[Z+0+32]=pn(Je,de,Pe),$[Z+3+96]=$[Z+2+64]=$[Z+1+32]=$[Z+0+0]=pn(tt,Je,de),$[Z+3+64]=$[Z+2+32]=$[Z+1+0]=pn(We,tt,Je),$[Z+3+32]=$[Z+2+0]=pn(ft,We,tt),$[Z+3+0]=pn(Et,ft,We)}function Ci($,Z){var de=$[Z+1-32],Pe=$[Z+2-32],He=$[Z+3-32],Je=$[Z+4-32],tt=$[Z+5-32],We=$[Z+6-32],ft=$[Z+7-32];$[Z+0+0]=pn($[Z+0-32],de,Pe),$[Z+1+0]=$[Z+0+32]=pn(de,Pe,He),$[Z+2+0]=$[Z+1+32]=$[Z+0+64]=pn(Pe,He,Je),$[Z+3+0]=$[Z+2+32]=$[Z+1+64]=$[Z+0+96]=pn(He,Je,tt),$[Z+3+32]=$[Z+2+64]=$[Z+1+96]=pn(Je,tt,We),$[Z+3+64]=$[Z+2+96]=pn(tt,We,ft),$[Z+3+96]=pn(We,ft,ft)}function Ra($,Z){var de=$[Z-1+0],Pe=$[Z-1+32],He=$[Z-1+64],Je=$[Z-1-32],tt=$[Z+0-32],We=$[Z+1-32],ft=$[Z+2-32],Et=$[Z+3-32];$[Z+0+0]=$[Z+1+64]=Je+tt+1>>1,$[Z+1+0]=$[Z+2+64]=tt+We+1>>1,$[Z+2+0]=$[Z+3+64]=We+ft+1>>1,$[Z+3+0]=ft+Et+1>>1,$[Z+0+96]=pn(He,Pe,de),$[Z+0+64]=pn(Pe,de,Je),$[Z+0+32]=$[Z+1+96]=pn(de,Je,tt),$[Z+1+32]=$[Z+2+96]=pn(Je,tt,We),$[Z+2+32]=$[Z+3+96]=pn(tt,We,ft),$[Z+3+32]=pn(We,ft,Et)}function gi($,Z){var de=$[Z+0-32],Pe=$[Z+1-32],He=$[Z+2-32],Je=$[Z+3-32],tt=$[Z+4-32],We=$[Z+5-32],ft=$[Z+6-32],Et=$[Z+7-32];$[Z+0+0]=de+Pe+1>>1,$[Z+1+0]=$[Z+0+64]=Pe+He+1>>1,$[Z+2+0]=$[Z+1+64]=He+Je+1>>1,$[Z+3+0]=$[Z+2+64]=Je+tt+1>>1,$[Z+0+32]=pn(de,Pe,He),$[Z+1+32]=$[Z+0+96]=pn(Pe,He,Je),$[Z+2+32]=$[Z+1+96]=pn(He,Je,tt),$[Z+3+32]=$[Z+2+96]=pn(Je,tt,We),$[Z+3+64]=pn(tt,We,ft),$[Z+3+96]=pn(We,ft,Et)}function jn($,Z){var de=$[Z-1+0],Pe=$[Z-1+32],He=$[Z-1+64],Je=$[Z-1+96];$[Z+0+0]=de+Pe+1>>1,$[Z+2+0]=$[Z+0+32]=Pe+He+1>>1,$[Z+2+32]=$[Z+0+64]=He+Je+1>>1,$[Z+1+0]=pn(de,Pe,He),$[Z+3+0]=$[Z+1+32]=pn(Pe,He,Je),$[Z+3+32]=$[Z+1+64]=pn(He,Je,Je),$[Z+3+64]=$[Z+2+64]=$[Z+0+96]=$[Z+1+96]=$[Z+2+96]=$[Z+3+96]=Je}function us($,Z){var de=$[Z-1+0],Pe=$[Z-1+32],He=$[Z-1+64],Je=$[Z-1+96],tt=$[Z-1-32],We=$[Z+0-32],ft=$[Z+1-32],Et=$[Z+2-32];$[Z+0+0]=$[Z+2+32]=de+tt+1>>1,$[Z+0+32]=$[Z+2+64]=Pe+de+1>>1,$[Z+0+64]=$[Z+2+96]=He+Pe+1>>1,$[Z+0+96]=Je+He+1>>1,$[Z+3+0]=pn(We,ft,Et),$[Z+2+0]=pn(tt,We,ft),$[Z+1+0]=$[Z+3+32]=pn(de,tt,We),$[Z+1+32]=$[Z+3+64]=pn(Pe,de,tt),$[Z+1+64]=$[Z+3+96]=pn(He,Pe,de),$[Z+1+96]=pn(Je,He,Pe)}function Un($,Z){var de;for(de=0;8>de;++de)n($,Z+32*de,$,Z-32,8)}function Nn($,Z){var de;for(de=0;8>de;++de)i($,Z,$[Z-1],8),Z+=32}function Go($,Z,de){var Pe;for(Pe=0;8>Pe;++Pe)i(Z,de+32*Pe,$,8)}function Yn($,Z){var de,Pe=8;for(de=0;8>de;++de)Pe+=$[Z+de-32]+$[Z-1+32*de];Go(Pe>>4,$,Z)}function Do($,Z){var de,Pe=4;for(de=0;8>de;++de)Pe+=$[Z+de-32];Go(Pe>>3,$,Z)}function To($,Z){var de,Pe=4;for(de=0;8>de;++de)Pe+=$[Z-1+32*de];Go(Pe>>3,$,Z)}function Xo($,Z){Go(128,$,Z)}function tl($,Z,de){var Pe=$[Z-de],He=$[Z+0],Je=3*(He-Pe)+uc[1020+$[Z-2*de]-$[Z+de]],tt=Sl[112+(Je+4>>3)];$[Z-de]=Zn[255+Pe+Sl[112+(Je+3>>3)]],$[Z+0]=Zn[255+He-tt]}function nu($,Z,de,Pe){var He=$[Z+0],Je=$[Z+de];return zo[255+$[Z-2*de]-$[Z-de]]>Pe||zo[255+Je-He]>Pe}function _l($,Z,de,Pe){return 4*zo[255+$[Z-de]-$[Z+0]]+zo[255+$[Z-2*de]-$[Z+de]]<=Pe}function Co($,Z,de,Pe,He){var Je=$[Z-3*de],tt=$[Z-2*de],We=$[Z-de],ft=$[Z+0],Et=$[Z+de],Vt=$[Z+2*de],vr=$[Z+3*de];return 4*zo[255+We-ft]+zo[255+tt-Et]>Pe?0:zo[255+$[Z-4*de]-Je]<=He&&zo[255+Je-tt]<=He&&zo[255+tt-We]<=He&&zo[255+vr-Vt]<=He&&zo[255+Vt-Et]<=He&&zo[255+Et-ft]<=He}function rl($,Z,de,Pe){var He=2*Pe+1;for(Pe=0;16>Pe;++Pe)_l($,Z+Pe,de,He)&&tl($,Z+Pe,de)}function bl($,Z,de,Pe){var He=2*Pe+1;for(Pe=0;16>Pe;++Pe)_l($,Z+Pe*de,1,He)&&tl($,Z+Pe*de,1)}function lo($,Z,de,Pe){var He;for(He=3;0<He;--He)rl($,Z+=4*de,de,Pe)}function uo($,Z,de,Pe){var He;for(He=3;0<He;--He)bl($,Z+=4,de,Pe)}function na($,Z,de,Pe,He,Je,tt,We){for(Je=2*Je+1;0<He--;){if(Co($,Z,de,Je,tt))if(nu($,Z,de,We))tl($,Z,de);else{var ft=$,Et=Z,Vt=de,vr=ft[Et-2*Vt],St=ft[Et-Vt],Qt=ft[Et+0],Ut=ft[Et+Vt],Or=ft[Et+2*Vt],xr=27*(jr=uc[1020+3*(Qt-St)+uc[1020+vr-Ut]])+63>>7,Nr=18*jr+63>>7,jr=9*jr+63>>7;ft[Et-3*Vt]=Zn[255+ft[Et-3*Vt]+jr],ft[Et-2*Vt]=Zn[255+vr+Nr],ft[Et-Vt]=Zn[255+St+xr],ft[Et+0]=Zn[255+Qt-xr],ft[Et+Vt]=Zn[255+Ut-Nr],ft[Et+2*Vt]=Zn[255+Or-jr]}Z+=Pe}}function Da($,Z,de,Pe,He,Je,tt,We){for(Je=2*Je+1;0<He--;){if(Co($,Z,de,Je,tt))if(nu($,Z,de,We))tl($,Z,de);else{var ft=$,Et=Z,Vt=de,vr=ft[Et-Vt],St=ft[Et+0],Qt=ft[Et+Vt],Ut=Sl[112+(4+(Or=3*(St-vr))>>3)],Or=Sl[112+(Or+3>>3)],xr=Ut+1>>1;ft[Et-2*Vt]=Zn[255+ft[Et-2*Vt]+xr],ft[Et-Vt]=Zn[255+vr+Or],ft[Et+0]=Zn[255+St-Ut],ft[Et+Vt]=Zn[255+Qt-xr]}Z+=Pe}}function le($,Z,de,Pe,He,Je){na($,Z,de,1,16,Pe,He,Je)}function Ve($,Z,de,Pe,He,Je){na($,Z,1,de,16,Pe,He,Je)}function dt($,Z,de,Pe,He,Je){var tt;for(tt=3;0<tt;--tt)Da($,Z+=4*de,de,1,16,Pe,He,Je)}function Dt($,Z,de,Pe,He,Je){var tt;for(tt=3;0<tt;--tt)Da($,Z+=4,1,de,16,Pe,He,Je)}function nr($,Z,de,Pe,He,Je,tt,We){na($,Z,He,1,8,Je,tt,We),na(de,Pe,He,1,8,Je,tt,We)}function Lr($,Z,de,Pe,He,Je,tt,We){na($,Z,1,He,8,Je,tt,We),na(de,Pe,1,He,8,Je,tt,We)}function Zr($,Z,de,Pe,He,Je,tt,We){Da($,Z+4*He,He,1,8,Je,tt,We),Da(de,Pe+4*He,He,1,8,Je,tt,We)}function kn($,Z,de,Pe,He,Je,tt,We){Da($,Z+4,1,He,8,Je,tt,We),Da(de,Pe+4,1,He,8,Je,tt,We)}function wn(){this.ba=new bt,this.ec=[],this.cc=[],this.Mc=[],this.Dc=this.Nc=this.dc=this.fc=0,this.Oa=new Ur,this.memory=0,this.Ib="OutputFunc",this.Jb="OutputAlphaFunc",this.Nd="OutputRowFunc"}function ni(){this.data=[],this.offset=this.kd=this.ha=this.w=0,this.na=[],this.xa=this.gb=this.Ja=this.Sa=this.P=0}function oi(){this.nc=this.Ea=this.b=this.hc=0,this.K=[],this.w=0}function Ii(){this.ua=0,this.Wa=new Yt,this.vb=new Yt,this.md=this.xc=this.wc=0,this.vc=[],this.Wb=0,this.Ya=new ce,this.yc=new ne}function $i(){this.xb=this.a=0,this.l=new ls,this.ca=new bt,this.V=[],this.Ba=0,this.Ta=[],this.Ua=0,this.m=new Ee,this.Pb=0,this.wd=new Ee,this.Ma=this.$=this.C=this.i=this.c=this.xd=0,this.s=new Ii,this.ab=0,this.gc=s(4,oi),this.Oc=0}function Bi(){this.Lc=this.Z=this.$a=this.i=this.c=0,this.l=new ls,this.ic=0,this.ca=[],this.tb=0,this.qd=null,this.rd=0}function Ti($,Z,de,Pe,He,Je,tt){for($=$==null?0:$[Z+0],Z=0;Z<tt;++Z)He[Je+Z]=$+de[Pe+Z]&255,$=He[Je+Z]}function Fa($,Z,de,Pe,He,Je,tt){var We;if($==null)Ti(null,null,de,Pe,He,Je,tt);else for(We=0;We<tt;++We)He[Je+We]=$[Z+We]+de[Pe+We]&255}function fa($,Z,de,Pe,He,Je,tt){if($==null)Ti(null,null,de,Pe,He,Je,tt);else{var We,ft=$[Z+0],Et=ft,Vt=ft;for(We=0;We<tt;++We)Et=Vt+(ft=$[Z+We])-Et,Vt=de[Pe+We]+(-256&Et?0>Et?0:255:Et)&255,Et=ft,He[Je+We]=Vt}}function Qa($,Z,de,Pe){var He=Z.width,Je=Z.o;if(e($!=null&&Z!=null),0>de||0>=Pe||de+Pe>Je)return null;if(!$.Cc){if($.ga==null){var tt;if($.ga=new Bi,(tt=$.ga==null)||(tt=Z.width*Z.o,e($.Gb.length==0),$.Gb=a(tt),$.Uc=0,$.Gb==null?tt=0:($.mb=$.Gb,$.nb=$.Uc,$.rc=null,tt=1),tt=!tt),!tt){tt=$.ga;var We=$.Fa,ft=$.P,Et=$.qc,Vt=$.mb,vr=$.nb,St=ft+1,Qt=Et-1,Ut=tt.l;if(e(We!=null&&Vt!=null&&Z!=null),Lc[0]=null,Lc[1]=Ti,Lc[2]=Fa,Lc[3]=fa,tt.ca=Vt,tt.tb=vr,tt.c=Z.width,tt.i=Z.height,e(0<tt.c&&0<tt.i),1>=Et)Z=0;else if(tt.$a=3&We[ft+0],tt.Z=We[ft+0]>>2&3,tt.Lc=We[ft+0]>>4&3,ft=We[ft+0]>>6&3,0>tt.$a||1<tt.$a||4<=tt.Z||1<tt.Lc||ft)Z=0;else if(Ut.put=un,Ut.ac=ti,Ut.bc=ri,Ut.ma=tt,Ut.width=Z.width,Ut.height=Z.height,Ut.Da=Z.Da,Ut.v=Z.v,Ut.va=Z.va,Ut.j=Z.j,Ut.o=Z.o,tt.$a)e:{e(tt.$a==1),Z=Wi();t:for(;;){if(Z==null){Z=0;break e}if(e(tt!=null),tt.mc=Z,Z.c=tt.c,Z.i=tt.i,Z.l=tt.l,Z.l.ma=tt,Z.l.width=tt.c,Z.l.height=tt.i,Z.a=0,we(Z.m,We,St,Qt),!Fn(tt.c,tt.i,1,Z,null)||(Z.ab==1&&Z.gc[0].hc==3&&zr(Z.s)?(tt.ic=1,We=Z.c*Z.i,Z.Ta=null,Z.Ua=0,Z.V=a(We),Z.Ba=0,Z.V==null?(Z.a=1,Z=0):Z=1):(tt.ic=0,Z=Ia(Z,tt.c)),!Z))break t;Z=1;break e}tt.mc=null,Z=0}else Z=Qt>=tt.c*tt.i;tt=!Z}if(tt)return null;$.ga.Lc!=1?$.Ga=0:Pe=Je-de}e($.ga!=null),e(de+Pe<=Je);e:{if(Z=(We=$.ga).c,Je=We.l.o,We.$a==0){if(St=$.rc,Qt=$.Vc,Ut=$.Fa,ft=$.P+1+de*Z,Et=$.mb,Vt=$.nb+de*Z,e(ft<=$.P+$.qc),We.Z!=0)for(e(Lc[We.Z]!=null),tt=0;tt<Pe;++tt)Lc[We.Z](St,Qt,Ut,ft,Et,Vt,Z),St=Et,Qt=Vt,Vt+=Z,ft+=Z;else for(tt=0;tt<Pe;++tt)n(Et,Vt,Ut,ft,Z),St=Et,Qt=Vt,Vt+=Z,ft+=Z;$.rc=St,$.Vc=Qt}else{if(e(We.mc!=null),Z=de+Pe,e((tt=We.mc)!=null),e(Z<=tt.i),tt.C>=Z)Z=1;else if(We.ic||Dl(),We.ic){We=tt.V,St=tt.Ba,Qt=tt.c;var Or=tt.i,xr=(Ut=1,ft=tt.$/Qt,Et=tt.$%Qt,Vt=tt.m,vr=tt.s,tt.$),Nr=Qt*Or,jr=Qt*Z,rn=vr.wc,Kr=xr<jr?Fr(vr,Et,ft):null;e(xr<=Nr),e(Z<=Or),e(zr(vr));t:for(;;){for(;!Vt.h&&xr<jr;){if(Et&rn||(Kr=Fr(vr,Et,ft)),e(Kr!=null),$e(Vt),256>(Or=pt(Kr.G[0],Kr.H[0],Vt)))We[St+xr]=Or,++xr,++Et>=Qt&&(Et=0,++ft<=Z&&!(ft%16)&&Tn(tt,ft));else{if(!(280>Or)){Ut=0;break t}Or=Be(Or-256,Vt);var Kn,zn=pt(Kr.G[4],Kr.H[4],Vt);if($e(Vt),!(xr>=(zn=mt(Qt,zn=Be(zn,Vt)))&&Nr-xr>=Or)){Ut=0;break t}for(Kn=0;Kn<Or;++Kn)We[St+xr+Kn]=We[St+xr+Kn-zn];for(xr+=Or,Et+=Or;Et>=Qt;)Et-=Qt,++ft<=Z&&!(ft%16)&&Tn(tt,ft);xr<jr&&Et&rn&&(Kr=Fr(vr,Et,ft))}e(Vt.h==Ne(Vt))}Tn(tt,ft>Z?Z:ft);break t}!Ut||Vt.h&&xr<Nr?(Ut=0,tt.a=Vt.h?5:3):tt.$=xr,Z=Ut}else Z=Mi(tt,tt.V,tt.Ba,tt.c,tt.i,Z,ma);if(!Z){Pe=0;break e}}de+Pe>=Je&&($.Cc=1),Pe=1}if(!Pe)return null;if($.Cc&&((Pe=$.ga)!=null&&(Pe.mc=null),$.ga=null,0<$.Ga))return alert("todo:WebPDequantizeLevels"),null}return $.nb+de*He}function bs($,Z,de,Pe,He,Je){for(;0<He--;){var tt,We=$,ft=Z+(de?1:0),Et=$,Vt=Z+(de?0:3);for(tt=0;tt<Pe;++tt){var vr=Et[Vt+4*tt];vr!=255&&(vr*=32897,We[ft+4*tt+0]=We[ft+4*tt+0]*vr>>23,We[ft+4*tt+1]=We[ft+4*tt+1]*vr>>23,We[ft+4*tt+2]=We[ft+4*tt+2]*vr>>23)}Z+=Je}}function nl($,Z,de,Pe,He){for(;0<Pe--;){var Je;for(Je=0;Je<de;++Je){var tt=$[Z+2*Je+0],We=15&(Et=$[Z+2*Je+1]),ft=4369*We,Et=(240&Et|Et>>4)*ft>>16;$[Z+2*Je+0]=(240&tt|tt>>4)*ft>>16&240|(15&tt|tt<<4)*ft>>16>>4&15,$[Z+2*Je+1]=240&Et|We}Z+=He}}function Su($,Z,de,Pe,He,Je,tt,We){var ft,Et,Vt=255;for(Et=0;Et<He;++Et){for(ft=0;ft<Pe;++ft){var vr=$[Z+ft];Je[tt+4*ft]=vr,Vt&=vr}Z+=de,tt+=We}return Vt!=255}function Fo($,Z,de,Pe,He){var Je;for(Je=0;Je<He;++Je)de[Pe+Je]=$[Z+Je]>>8}function Dl(){ia=bs,Ta=nl,Ga=Su,Bo=Fo}function aa($,Z,de){G[$]=function(Pe,He,Je,tt,We,ft,Et,Vt,vr,St,Qt,Ut,Or,xr,Nr,jr,rn){var Kr,Kn=rn-1>>1,zn=We[ft+0]|Et[Vt+0]<<16,Li=vr[St+0]|Qt[Ut+0]<<16;e(Pe!=null);var Gn=3*zn+Li+131074>>2;for(Z(Pe[He+0],255&Gn,Gn>>16,Or,xr),Je!=null&&(Gn=3*Li+zn+131074>>2,Z(Je[tt+0],255&Gn,Gn>>16,Nr,jr)),Kr=1;Kr<=Kn;++Kr){var ea=We[ft+Kr]|Et[Vt+Kr]<<16,Qo=vr[St+Kr]|Qt[Ut+Kr]<<16,yi=zn+ea+Li+Qo+524296,mn=yi+2*(ea+Li)>>3;Gn=mn+zn>>1,zn=(yi=yi+2*(zn+Qo)>>3)+ea>>1,Z(Pe[He+2*Kr-1],255&Gn,Gn>>16,Or,xr+(2*Kr-1)*de),Z(Pe[He+2*Kr-0],255&zn,zn>>16,Or,xr+(2*Kr-0)*de),Je!=null&&(Gn=yi+Li>>1,zn=mn+Qo>>1,Z(Je[tt+2*Kr-1],255&Gn,Gn>>16,Nr,jr+(2*Kr-1)*de),Z(Je[tt+2*Kr+0],255&zn,zn>>16,Nr,jr+(2*Kr+0)*de)),zn=ea,Li=Qo}1&rn||(Gn=3*zn+Li+131074>>2,Z(Pe[He+rn-1],255&Gn,Gn>>16,Or,xr+(rn-1)*de),Je!=null&&(Gn=3*Li+zn+131074>>2,Z(Je[tt+rn-1],255&Gn,Gn>>16,Nr,jr+(rn-1)*de)))}}function xl(){ws[Oc]=up,ws[uh]=cp,ws[$l]=Nc,ws[cc]=_g,ws[ip]=bg,ws[ap]=xg,ws[ey]=ny,ws[fd]=cp,ws[_f]=_g,ws[ch]=bg,ws[Bh]=xg}function iu($){return $&-16384?0>$?0:255:$>>Sf}function co($,Z){return iu((19077*$>>8)+(26149*Z>>8)-14234)}function eo($,Z,de){return iu((19077*$>>8)-(6419*Z>>8)-(13320*de>>8)+8708)}function xo($,Z){return iu((19077*$>>8)+(33050*Z>>8)-17685)}function Ba($,Z,de,Pe,He){Pe[He+0]=co($,de),Pe[He+1]=eo($,Z,de),Pe[He+2]=xo($,Z)}function Yo($,Z,de,Pe,He){Pe[He+0]=xo($,Z),Pe[He+1]=eo($,Z,de),Pe[He+2]=co($,de)}function Eu($,Z,de,Pe,He){var Je=eo($,Z,de);Z=Je<<3&224|xo($,Z)>>3,Pe[He+0]=248&co($,de)|Je>>5,Pe[He+1]=Z}function Ea($,Z,de,Pe,He){var Je=240&xo($,Z)|15;Pe[He+0]=240&co($,de)|eo($,Z,de)>>4,Pe[He+1]=Je}function lh($,Z,de,Pe,He){Pe[He+0]=255,Ba($,Z,de,Pe,He+1)}function cs($,Z,de,Pe,He){Yo($,Z,de,Pe,He),Pe[He+3]=255}function au($,Z,de,Pe,He){Ba($,Z,de,Pe,He),Pe[He+3]=255}function Wa($,Z){return 0>$?0:$>Z?Z:$}function Fs($,Z,de){G[$]=function(Pe,He,Je,tt,We,ft,Et,Vt,vr){for(var St=Vt+(-2&vr)*de;Vt!=St;)Z(Pe[He+0],Je[tt+0],We[ft+0],Et,Vt),Z(Pe[He+1],Je[tt+0],We[ft+0],Et,Vt+de),He+=2,++tt,++ft,Vt+=2*de;1&vr&&Z(Pe[He+0],Je[tt+0],We[ft+0],Et,Vt)}}function Hu($,Z,de){return de==0?$==0?Z==0?6:5:Z==0?4:0:de}function Wu($,Z,de,Pe,He){switch($>>>30){case 3:_(Z,de,Pe,He,0);break;case 2:I(Z,de,Pe,He);break;case 1:re(Z,de,Pe,He)}}function wl($,Z){var de,Pe,He=Z.M,Je=Z.Nb,tt=$.oc,We=$.pc+40,ft=$.oc,Et=$.pc+584,Vt=$.oc,vr=$.pc+600;for(de=0;16>de;++de)tt[We+32*de-1]=129;for(de=0;8>de;++de)ft[Et+32*de-1]=129,Vt[vr+32*de-1]=129;for(0<He?tt[We-1-32]=ft[Et-1-32]=Vt[vr-1-32]=129:(i(tt,We-32-1,127,21),i(ft,Et-32-1,127,9),i(Vt,vr-32-1,127,9)),Pe=0;Pe<$.za;++Pe){var St=Z.ya[Z.aa+Pe];if(0<Pe){for(de=-1;16>de;++de)n(tt,We+32*de-4,tt,We+32*de+12,4);for(de=-1;8>de;++de)n(ft,Et+32*de-4,ft,Et+32*de+4,4),n(Vt,vr+32*de-4,Vt,vr+32*de+4,4)}var Qt=$.Gd,Ut=$.Hd+Pe,Or=St.ad,xr=St.Hc;if(0<He&&(n(tt,We-32,Qt[Ut].y,0,16),n(ft,Et-32,Qt[Ut].f,0,8),n(Vt,vr-32,Qt[Ut].ea,0,8)),St.Za){var Nr=tt,jr=We-32+16;for(0<He&&(Pe>=$.za-1?i(Nr,jr,Qt[Ut].y[15],4):n(Nr,jr,Qt[Ut+1].y,0,4)),de=0;4>de;de++)Nr[jr+128+de]=Nr[jr+256+de]=Nr[jr+384+de]=Nr[jr+0+de];for(de=0;16>de;++de,xr<<=2)Nr=tt,jr=We+El[de],Ko[St.Ob[de]](Nr,jr),Wu(xr,Or,16*+de,Nr,jr)}else if(Nr=Hu(Pe,He,St.Ob[0]),va[Nr](tt,We),xr!=0)for(de=0;16>de;++de,xr<<=2)Wu(xr,Or,16*+de,tt,We+El[de]);for(de=St.Gc,Nr=Hu(Pe,He,St.Dd),Jo[Nr](ft,Et),Jo[Nr](Vt,vr),xr=Or,Nr=ft,jr=Et,255&(St=0|de)&&(170&St?U(xr,256,Nr,jr):ye(xr,256,Nr,jr)),St=Vt,xr=vr,255&(de>>=8)&&(170&de?U(Or,320,St,xr):ye(Or,320,St,xr)),He<$.Ub-1&&(n(Qt[Ut].y,0,tt,We+480,16),n(Qt[Ut].f,0,ft,Et+224,8),n(Qt[Ut].ea,0,Vt,vr+224,8)),de=8*Je*$.B,Qt=$.sa,Ut=$.ta+16*Pe+16*Je*$.R,Or=$.qa,St=$.ra+8*Pe+de,xr=$.Ha,Nr=$.Ia+8*Pe+de,de=0;16>de;++de)n(Qt,Ut+de*$.R,tt,We+32*de,16);for(de=0;8>de;++de)n(Or,St+de*$.B,ft,Et+32*de,8),n(xr,Nr+de*$.B,Vt,vr+32*de,8)}}function Fl($,Z,de,Pe,He,Je,tt,We,ft){var Et=[0],Vt=[0],vr=0,St=ft!=null?ft.kd:0,Qt=ft??new ni;if($==null||12>de)return 7;Qt.data=$,Qt.w=Z,Qt.ha=de,Z=[Z],de=[de],Qt.gb=[Qt.gb];e:{var Ut=Z,Or=de,xr=Qt.gb;if(e($!=null),e(Or!=null),e(xr!=null),xr[0]=0,12<=Or[0]&&!r($,Ut[0],"RIFF")){if(r($,Ut[0]+8,"WEBP")){xr=3;break e}var Nr=at($,Ut[0]+4);if(12>Nr||4294967286<Nr){xr=3;break e}if(St&&Nr>Or[0]-8){xr=7;break e}xr[0]=Nr,Ut[0]+=12,Or[0]-=12}xr=0}if(xr!=0)return xr;for(Nr=0<Qt.gb[0],de=de[0];;){e:{var jr=$;Or=Z,xr=de;var rn=Et,Kr=Vt,Kn=Ut=[0];if((Gn=vr=[vr])[0]=0,8>xr[0])xr=7;else{if(!r(jr,Or[0],"VP8X")){if(at(jr,Or[0]+4)!=10){xr=3;break e}if(18>xr[0]){xr=7;break e}var zn=at(jr,Or[0]+8),Li=1+Mt(jr,Or[0]+12);if(2147483648<=Li*(jr=1+Mt(jr,Or[0]+15))){xr=3;break e}Kn!=null&&(Kn[0]=zn),rn!=null&&(rn[0]=Li),Kr!=null&&(Kr[0]=jr),Or[0]+=18,xr[0]-=18,Gn[0]=1}xr=0}}if(vr=vr[0],Ut=Ut[0],xr!=0)return xr;if(Or=!!(2&Ut),!Nr&&vr)return 3;if(Je!=null&&(Je[0]=!!(16&Ut)),tt!=null&&(tt[0]=Or),We!=null&&(We[0]=0),tt=Et[0],Ut=Vt[0],vr&&Or&&ft==null){xr=0;break}if(4>de){xr=7;break}if(Nr&&vr||!Nr&&!vr&&!r($,Z[0],"ALPH")){de=[de],Qt.na=[Qt.na],Qt.P=[Qt.P],Qt.Sa=[Qt.Sa];e:{zn=$,xr=Z,Nr=de;var Gn=Qt.gb;rn=Qt.na,Kr=Qt.P,Kn=Qt.Sa,Li=22,e(zn!=null),e(Nr!=null),jr=xr[0];var ea=Nr[0];for(e(rn!=null),e(Kn!=null),rn[0]=null,Kr[0]=null,Kn[0]=0;;){if(xr[0]=jr,Nr[0]=ea,8>ea){xr=7;break e}var Qo=at(zn,jr+4);if(4294967286<Qo){xr=3;break e}var yi=8+Qo+1&-2;if(Li+=yi,0<Gn&&Li>Gn){xr=3;break e}if(!r(zn,jr,"VP8 ")||!r(zn,jr,"VP8L")){xr=0;break e}if(ea[0]<yi){xr=7;break e}r(zn,jr,"ALPH")||(rn[0]=zn,Kr[0]=jr+8,Kn[0]=Qo),jr+=yi,ea-=yi}}if(de=de[0],Qt.na=Qt.na[0],Qt.P=Qt.P[0],Qt.Sa=Qt.Sa[0],xr!=0)break}de=[de],Qt.Ja=[Qt.Ja],Qt.xa=[Qt.xa];e:if(Gn=$,xr=Z,Nr=de,rn=Qt.gb[0],Kr=Qt.Ja,Kn=Qt.xa,zn=xr[0],jr=!r(Gn,zn,"VP8 "),Li=!r(Gn,zn,"VP8L"),e(Gn!=null),e(Nr!=null),e(Kr!=null),e(Kn!=null),8>Nr[0])xr=7;else{if(jr||Li){if(Gn=at(Gn,zn+4),12<=rn&&Gn>rn-12){xr=3;break e}if(St&&Gn>Nr[0]-8){xr=7;break e}Kr[0]=Gn,xr[0]+=8,Nr[0]-=8,Kn[0]=Li}else Kn[0]=5<=Nr[0]&&Gn[zn+0]==47&&!(Gn[zn+4]>>5),Kr[0]=Nr[0];xr=0}if(de=de[0],Qt.Ja=Qt.Ja[0],Qt.xa=Qt.xa[0],Z=Z[0],xr!=0)break;if(4294967286<Qt.Ja)return 3;if(We==null||Or||(We[0]=Qt.xa?2:1),tt=[tt],Ut=[Ut],Qt.xa){if(5>de){xr=7;break}We=tt,St=Ut,Or=Je,$==null||5>de?$=0:5<=de&&$[Z+0]==47&&!($[Z+4]>>5)?(Nr=[0],Gn=[0],rn=[0],we(Kr=new Ee,$,Z,de),Ae(Kr,Nr,Gn,rn)?(We!=null&&(We[0]=Nr[0]),St!=null&&(St[0]=Gn[0]),Or!=null&&(Or[0]=rn[0]),$=1):$=0):$=0}else{if(10>de){xr=7;break}We=Ut,$==null||10>de||!Mc($,Z+3,de-3)?$=0:(St=$[Z+0]|$[Z+1]<<8|$[Z+2]<<16,Or=16383&($[Z+7]<<8|$[Z+6]),$=16383&($[Z+9]<<8|$[Z+8]),1&St||3<(St>>1&7)||!(St>>4&1)||St>>5>=Qt.Ja||!Or||!$?$=0:(tt&&(tt[0]=Or),We&&(We[0]=$),$=1))}if(!$||(tt=tt[0],Ut=Ut[0],vr&&(Et[0]!=tt||Vt[0]!=Ut)))return 3;ft!=null&&(ft[0]=Qt,ft.offset=Z-ft.w,e(4294967286>Z-ft.w),e(ft.offset==ft.ha-de));break}return xr==0||xr==7&&vr&&ft==null?(Je!=null&&(Je[0]|=Qt.na!=null&&0<Qt.na.length),Pe!=null&&(Pe[0]=tt),He!=null&&(He[0]=Ut),0):xr}function Ao($,Z,de){var Pe=Z.width,He=Z.height,Je=0,tt=0,We=Pe,ft=He;if(Z.Da=$!=null&&0<$.Da,Z.Da&&(We=$.cd,ft=$.bd,Je=$.v,tt=$.j,11>de||(Je&=-2,tt&=-2),0>Je||0>tt||0>=We||0>=ft||Je+We>Pe||tt+ft>He))return 0;if(Z.v=Je,Z.j=tt,Z.va=Je+We,Z.o=tt+ft,Z.U=We,Z.T=ft,Z.da=$!=null&&0<$.da,Z.da){if(!pr(We,ft,de=[$.ib],Je=[$.hb]))return 0;Z.ib=de[0],Z.hb=Je[0]}return Z.ob=$!=null&&$.ob,Z.Kb=$==null||!$.Sd,Z.da&&(Z.ob=Z.ib<3*Pe/4&&Z.hb<3*He/4,Z.Kb=0),1}function ho($){if($==null)return 2;if(11>$.S){var Z=$.f.RGBA;Z.fb+=($.height-1)*Z.A,Z.A=-Z.A}else Z=$.f.kb,$=$.height,Z.O+=($-1)*Z.fa,Z.fa=-Z.fa,Z.N+=($-1>>1)*Z.Ab,Z.Ab=-Z.Ab,Z.W+=($-1>>1)*Z.Db,Z.Db=-Z.Db,Z.F!=null&&(Z.J+=($-1)*Z.lb,Z.lb=-Z.lb);return 0}function Bs($,Z,de,Pe){if(Pe==null||0>=$||0>=Z)return 2;if(de!=null){if(de.Da){var He=de.cd,Je=de.bd,tt=-2&de.v,We=-2&de.j;if(0>tt||0>We||0>=He||0>=Je||tt+He>$||We+Je>Z)return 2;$=He,Z=Je}if(de.da){if(!pr($,Z,He=[de.ib],Je=[de.hb]))return 2;$=He[0],Z=Je[0]}}Pe.width=$,Pe.height=Z;e:{var ft=Pe.width,Et=Pe.height;if($=Pe.S,0>=ft||0>=Et||!($>=Oc&&13>$))$=2;else{if(0>=Pe.Rd&&Pe.sd==null){tt=Je=He=Z=0;var Vt=(We=ft*jh[$])*Et;if(11>$||(Je=(Et+1)/2*(Z=(ft+1)/2),$==12&&(tt=(He=ft)*Et)),(Et=a(Vt+2*Je+tt))==null){$=1;break e}Pe.sd=Et,11>$?((ft=Pe.f.RGBA).eb=Et,ft.fb=0,ft.A=We,ft.size=Vt):((ft=Pe.f.kb).y=Et,ft.O=0,ft.fa=We,ft.Fd=Vt,ft.f=Et,ft.N=0+Vt,ft.Ab=Z,ft.Cd=Je,ft.ea=Et,ft.W=0+Vt+Je,ft.Db=Z,ft.Ed=Je,$==12&&(ft.F=Et,ft.J=0+Vt+2*Je),ft.Tc=tt,ft.lb=He)}if(Z=1,He=Pe.S,Je=Pe.width,tt=Pe.height,He>=Oc&&13>He)if(11>He)$=Pe.f.RGBA,Z&=(We=Math.abs($.A))*(tt-1)+Je<=$.size,Z&=We>=Je*jh[He],Z&=$.eb!=null;else{$=Pe.f.kb,We=(Je+1)/2,Vt=(tt+1)/2,ft=Math.abs($.fa),Et=Math.abs($.Ab);var vr=Math.abs($.Db),St=Math.abs($.lb),Qt=St*(tt-1)+Je;Z&=ft*(tt-1)+Je<=$.Fd,Z&=Et*(Vt-1)+We<=$.Cd,Z=(Z&=vr*(Vt-1)+We<=$.Ed)&ft>=Je&Et>=We&vr>=We,Z&=$.y!=null,Z&=$.f!=null,Z&=$.ea!=null,He==12&&(Z&=St>=Je,Z&=Qt<=$.Tc,Z&=$.F!=null)}else Z=0;$=Z?0:2}}return $!=0||de!=null&&de.fd&&($=ho(Pe)),$}var wo=64,Bl=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535,131071,262143,524287,1048575,2097151,4194303,8388607,16777215],hs=24,zl=32,ya=8,Tu=[0,0,1,1,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7];_r("Predictor0","PredictorAdd0"),G.Predictor0=function(){return 4278190080},G.Predictor1=function($){return $},G.Predictor2=function($,Z,de){return Z[de+0]},G.Predictor3=function($,Z,de){return Z[de+1]},G.Predictor4=function($,Z,de){return Z[de-1]},G.Predictor5=function($,Z,de){return Er(Er($,Z[de+1]),Z[de+0])},G.Predictor6=function($,Z,de){return Er($,Z[de-1])},G.Predictor7=function($,Z,de){return Er($,Z[de+0])},G.Predictor8=function($,Z,de){return Er(Z[de-1],Z[de+0])},G.Predictor9=function($,Z,de){return Er(Z[de+0],Z[de+1])},G.Predictor10=function($,Z,de){return Er(Er($,Z[de-1]),Er(Z[de+0],Z[de+1]))},G.Predictor11=function($,Z,de){var Pe=Z[de+0];return 0>=lr(Pe>>24&255,$>>24&255,(Z=Z[de-1])>>24&255)+lr(Pe>>16&255,$>>16&255,Z>>16&255)+lr(Pe>>8&255,$>>8&255,Z>>8&255)+lr(255&Pe,255&$,255&Z)?Pe:$},G.Predictor12=function($,Z,de){var Pe=Z[de+0];return(wr(($>>24&255)+(Pe>>24&255)-((Z=Z[de-1])>>24&255))<<24|wr(($>>16&255)+(Pe>>16&255)-(Z>>16&255))<<16|wr(($>>8&255)+(Pe>>8&255)-(Z>>8&255))<<8|wr((255&$)+(255&Pe)-(255&Z)))>>>0},G.Predictor13=function($,Z,de){var Pe=Z[de-1];return(er(($=Er($,Z[de+0]))>>24&255,Pe>>24&255)<<24|er($>>16&255,Pe>>16&255)<<16|er($>>8&255,Pe>>8&255)<<8|er(255&$,255&Pe))>>>0};var il=G.PredictorAdd0;G.PredictorAdd1=Ar,_r("Predictor2","PredictorAdd2"),_r("Predictor3","PredictorAdd3"),_r("Predictor4","PredictorAdd4"),_r("Predictor5","PredictorAdd5"),_r("Predictor6","PredictorAdd6"),_r("Predictor7","PredictorAdd7"),_r("Predictor8","PredictorAdd8"),_r("Predictor9","PredictorAdd9"),_r("Predictor10","PredictorAdd10"),_r("Predictor11","PredictorAdd11"),_r("Predictor12","PredictorAdd12"),_r("Predictor13","PredictorAdd13");var zs=G.PredictorAdd2;be("ColorIndexInverseTransform","MapARGB","32b",function($){return $>>8&255},function($){return $}),be("VP8LColorIndexInverseTransformAlpha","MapAlpha","8b",function($){return $},function($){return $>>8&255});var jl,Cu=G.ColorIndexInverseTransform,js=G.MapARGB,ou=G.VP8LColorIndexInverseTransformAlpha,Ul=G.MapAlpha,$t=G.VP8LPredictorsAdd=[];$t.length=16,(G.VP8LPredictors=[]).length=16,(G.VP8LPredictorsAdd_C=[]).length=16,(G.VP8LPredictors_C=[]).length=16;var tr,sn,Cn,bi,An,A,y,_,I,U,re,ye,Re,Ke,yt,Zt,ur,Vr,gn,Rn,Vn,In,Dn,Qi,ia,Ta,Ga,Bo,xs=a(511),Vl=a(2041),Gu=a(225),Us=a(767),Zo=0,uc=Vl,Sl=Gu,Zn=Us,zo=xs,Oc=0,uh=1,$l=2,cc=3,ip=4,ap=5,ey=6,fd=7,_f=8,ch=9,Bh=10,dg=[2,3,7],ty=[3,3,11],bf=[280,256,256,256,40],dd=[0,1,1,1,0],pd=[17,18,0,1,2,3,4,5,16,6,7,8,9,10,11,12,13,14,15],op=[24,7,23,25,40,6,39,41,22,26,38,42,56,5,55,57,21,27,54,58,37,43,72,4,71,73,20,28,53,59,70,74,36,44,88,69,75,52,60,3,87,89,19,29,86,90,35,45,68,76,85,91,51,61,104,2,103,105,18,30,102,106,34,46,84,92,67,77,101,107,50,62,120,1,119,121,83,93,17,31,100,108,66,78,118,122,33,47,117,123,49,63,99,109,82,94,0,116,124,65,79,16,32,98,110,48,115,125,81,95,64,114,126,97,111,80,113,127,96,112],pg=[2954,2956,2958,2962,2970,2986,3018,3082,3212,3468,3980,5004],zh=8,gd=[4,5,6,7,8,9,10,10,11,12,13,14,15,16,17,17,18,19,20,20,21,21,22,22,23,23,24,25,25,26,27,28,29,30,31,32,33,34,35,36,37,37,38,39,40,41,42,43,44,45,46,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,76,77,78,79,80,81,82,83,84,85,86,87,88,89,91,93,95,96,98,100,101,102,104,106,108,110,112,114,116,118,122,124,126,128,130,132,134,136,138,140,143,145,148,151,154,157],xf=[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,60,62,64,66,68,70,72,74,76,78,80,82,84,86,88,90,92,94,96,98,100,102,104,106,108,110,112,114,116,119,122,125,128,131,134,137,140,143,146,149,152,155,158,161,164,167,170,173,177,181,185,189,193,197,201,205,209,213,217,221,225,229,234,239,245,249,254,259,264,269,274,279,284],Xu=null,gg=[[173,148,140,0],[176,155,140,135,0],[180,157,141,134,130,0],[254,254,243,230,196,177,153,140,133,130,129,0]],ry=[0,1,4,8,5,2,3,6,9,12,13,10,7,11,14,15],mg=[-0,1,-1,2,-2,3,4,6,-3,5,-4,-5,-6,7,-7,8,-8,-9],sp=[[[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]],[[253,136,254,255,228,219,128,128,128,128,128],[189,129,242,255,227,213,255,219,128,128,128],[106,126,227,252,214,209,255,255,128,128,128]],[[1,98,248,255,236,226,255,255,128,128,128],[181,133,238,254,221,234,255,154,128,128,128],[78,134,202,247,198,180,255,219,128,128,128]],[[1,185,249,255,243,255,128,128,128,128,128],[184,150,247,255,236,224,128,128,128,128,128],[77,110,216,255,236,230,128,128,128,128,128]],[[1,101,251,255,241,255,128,128,128,128,128],[170,139,241,252,236,209,255,255,128,128,128],[37,116,196,243,228,255,255,255,128,128,128]],[[1,204,254,255,245,255,128,128,128,128,128],[207,160,250,255,238,128,128,128,128,128,128],[102,103,231,255,211,171,128,128,128,128,128]],[[1,152,252,255,240,255,128,128,128,128,128],[177,135,243,255,234,225,128,128,128,128,128],[80,129,211,255,194,224,128,128,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[246,1,255,128,128,128,128,128,128,128,128],[255,128,128,128,128,128,128,128,128,128,128]]],[[[198,35,237,223,193,187,162,160,145,155,62],[131,45,198,221,172,176,220,157,252,221,1],[68,47,146,208,149,167,221,162,255,223,128]],[[1,149,241,255,221,224,255,255,128,128,128],[184,141,234,253,222,220,255,199,128,128,128],[81,99,181,242,176,190,249,202,255,255,128]],[[1,129,232,253,214,197,242,196,255,255,128],[99,121,210,250,201,198,255,202,128,128,128],[23,91,163,242,170,187,247,210,255,255,128]],[[1,200,246,255,234,255,128,128,128,128,128],[109,178,241,255,231,245,255,255,128,128,128],[44,130,201,253,205,192,255,255,128,128,128]],[[1,132,239,251,219,209,255,165,128,128,128],[94,136,225,251,218,190,255,255,128,128,128],[22,100,174,245,186,161,255,199,128,128,128]],[[1,182,249,255,232,235,128,128,128,128,128],[124,143,241,255,227,234,128,128,128,128,128],[35,77,181,251,193,211,255,205,128,128,128]],[[1,157,247,255,236,231,255,255,128,128,128],[121,141,235,255,225,227,255,255,128,128,128],[45,99,188,251,195,217,255,224,128,128,128]],[[1,1,251,255,213,255,128,128,128,128,128],[203,1,248,255,255,128,128,128,128,128,128],[137,1,177,255,224,255,128,128,128,128,128]]],[[[253,9,248,251,207,208,255,192,128,128,128],[175,13,224,243,193,185,249,198,255,255,128],[73,17,171,221,161,179,236,167,255,234,128]],[[1,95,247,253,212,183,255,255,128,128,128],[239,90,244,250,211,209,255,255,128,128,128],[155,77,195,248,188,195,255,255,128,128,128]],[[1,24,239,251,218,219,255,205,128,128,128],[201,51,219,255,196,186,128,128,128,128,128],[69,46,190,239,201,218,255,228,128,128,128]],[[1,191,251,255,255,128,128,128,128,128,128],[223,165,249,255,213,255,128,128,128,128,128],[141,124,248,255,255,128,128,128,128,128,128]],[[1,16,248,255,255,128,128,128,128,128,128],[190,36,230,255,236,255,128,128,128,128,128],[149,1,255,128,128,128,128,128,128,128,128]],[[1,226,255,128,128,128,128,128,128,128,128],[247,192,255,128,128,128,128,128,128,128,128],[240,128,255,128,128,128,128,128,128,128,128]],[[1,134,252,255,255,128,128,128,128,128,128],[213,62,250,255,255,128,128,128,128,128,128],[55,93,255,128,128,128,128,128,128,128,128]],[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]]],[[[202,24,213,235,186,191,220,160,240,175,255],[126,38,182,232,169,184,228,174,255,187,128],[61,46,138,219,151,178,240,170,255,216,128]],[[1,112,230,250,199,191,247,159,255,255,128],[166,109,228,252,211,215,255,174,128,128,128],[39,77,162,232,172,180,245,178,255,255,128]],[[1,52,220,246,198,199,249,220,255,255,128],[124,74,191,243,183,193,250,221,255,255,128],[24,71,130,219,154,170,243,182,255,255,128]],[[1,182,225,249,219,240,255,224,128,128,128],[149,150,226,252,216,205,255,171,128,128,128],[28,108,170,242,183,194,254,223,255,255,128]],[[1,81,230,252,204,203,255,192,128,128,128],[123,102,209,247,188,196,255,233,128,128,128],[20,95,153,243,164,173,255,203,128,128,128]],[[1,222,248,255,216,213,128,128,128,128,128],[168,175,246,252,235,205,255,255,128,128,128],[47,116,215,255,211,212,255,255,128,128,128]],[[1,121,236,253,212,214,255,255,128,128,128],[141,84,213,252,201,202,255,219,128,128,128],[42,80,160,240,162,185,255,205,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[244,1,255,128,128,128,128,128,128,128,128],[238,1,255,128,128,128,128,128,128,128,128]]]],yg=[[[231,120,48,89,115,113,120,152,112],[152,179,64,126,170,118,46,70,95],[175,69,143,80,85,82,72,155,103],[56,58,10,171,218,189,17,13,152],[114,26,17,163,44,195,21,10,173],[121,24,80,195,26,62,44,64,85],[144,71,10,38,171,213,144,34,26],[170,46,55,19,136,160,33,206,71],[63,20,8,114,114,208,12,9,226],[81,40,11,96,182,84,29,16,36]],[[134,183,89,137,98,101,106,165,148],[72,187,100,130,157,111,32,75,80],[66,102,167,99,74,62,40,234,128],[41,53,9,178,241,141,26,8,107],[74,43,26,146,73,166,49,23,157],[65,38,105,160,51,52,31,115,128],[104,79,12,27,217,255,87,17,7],[87,68,71,44,114,51,15,186,23],[47,41,14,110,182,183,21,17,194],[66,45,25,102,197,189,23,18,22]],[[88,88,147,150,42,46,45,196,205],[43,97,183,117,85,38,35,179,61],[39,53,200,87,26,21,43,232,171],[56,34,51,104,114,102,29,93,77],[39,28,85,171,58,165,90,98,64],[34,22,116,206,23,34,43,166,73],[107,54,32,26,51,1,81,43,31],[68,25,106,22,64,171,36,225,114],[34,19,21,102,132,188,16,76,124],[62,18,78,95,85,57,50,48,51]],[[193,101,35,159,215,111,89,46,111],[60,148,31,172,219,228,21,18,111],[112,113,77,85,179,255,38,120,114],[40,42,1,196,245,209,10,25,109],[88,43,29,140,166,213,37,43,154],[61,63,30,155,67,45,68,1,209],[100,80,8,43,154,1,51,26,71],[142,78,78,16,255,128,34,197,171],[41,40,5,102,211,183,4,1,221],[51,50,17,168,209,192,23,25,82]],[[138,31,36,171,27,166,38,44,229],[67,87,58,169,82,115,26,59,179],[63,59,90,180,59,166,93,73,154],[40,40,21,116,143,209,34,39,175],[47,15,16,183,34,223,49,45,183],[46,17,33,183,6,98,15,32,183],[57,46,22,24,128,1,54,17,37],[65,32,73,115,28,128,23,128,205],[40,3,9,115,51,192,18,6,223],[87,37,9,115,59,77,64,21,47]],[[104,55,44,218,9,54,53,130,226],[64,90,70,205,40,41,23,26,57],[54,57,112,184,5,41,38,166,213],[30,34,26,133,152,116,10,32,134],[39,19,53,221,26,114,32,73,255],[31,9,65,234,2,15,1,118,73],[75,32,12,51,192,255,160,43,51],[88,31,35,67,102,85,55,186,85],[56,21,23,111,59,205,45,37,192],[55,38,70,124,73,102,1,34,98]],[[125,98,42,88,104,85,117,175,82],[95,84,53,89,128,100,113,101,45],[75,79,123,47,51,128,81,171,1],[57,17,5,71,102,57,53,41,49],[38,33,13,121,57,73,26,1,85],[41,10,67,138,77,110,90,47,114],[115,21,2,10,102,255,166,23,6],[101,29,16,10,85,128,101,196,26],[57,18,10,102,102,213,34,20,43],[117,20,15,36,163,128,68,1,26]],[[102,61,71,37,34,53,31,243,192],[69,60,71,38,73,119,28,222,37],[68,45,128,34,1,47,11,245,171],[62,17,19,70,146,85,55,62,70],[37,43,37,154,100,163,85,160,1],[63,9,92,136,28,64,32,201,85],[75,15,9,9,64,255,184,119,16],[86,6,28,5,64,255,25,248,1],[56,8,17,132,137,255,55,116,128],[58,15,20,82,135,57,26,121,40]],[[164,50,31,137,154,133,25,35,218],[51,103,44,131,131,123,31,6,158],[86,40,64,135,148,224,45,183,128],[22,26,17,131,240,154,14,1,209],[45,16,21,91,64,222,7,1,197],[56,21,39,155,60,138,23,102,213],[83,12,13,54,192,255,68,47,28],[85,26,85,85,128,128,32,146,171],[18,11,7,63,144,171,4,4,246],[35,27,10,146,174,171,12,26,128]],[[190,80,35,99,180,80,126,54,45],[85,126,47,87,176,51,41,20,32],[101,75,128,139,118,146,116,128,85],[56,41,15,176,236,85,37,9,62],[71,30,17,119,118,255,17,18,138],[101,38,60,138,55,70,43,26,142],[146,36,19,30,171,255,97,27,20],[138,45,61,62,219,1,81,188,64],[32,41,20,117,151,142,20,21,163],[112,19,12,61,195,128,48,4,24]]],Y0=[[[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[176,246,255,255,255,255,255,255,255,255,255],[223,241,252,255,255,255,255,255,255,255,255],[249,253,253,255,255,255,255,255,255,255,255]],[[255,244,252,255,255,255,255,255,255,255,255],[234,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255]],[[255,246,254,255,255,255,255,255,255,255,255],[239,253,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[251,255,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[251,254,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,254,253,255,254,255,255,255,255,255,255],[250,255,254,255,254,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[217,255,255,255,255,255,255,255,255,255,255],[225,252,241,253,255,255,254,255,255,255,255],[234,250,241,250,253,255,253,254,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[223,254,254,255,255,255,255,255,255,255,255],[238,253,254,254,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[249,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,255,255,255,255,255,255,255,255,255],[247,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[252,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[186,251,250,255,255,255,255,255,255,255,255],[234,251,244,254,255,255,255,255,255,255,255],[251,251,243,253,254,255,254,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[236,253,254,255,255,255,255,255,255,255,255],[251,253,253,254,254,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[254,254,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[254,254,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[248,255,255,255,255,255,255,255,255,255,255],[250,254,252,254,255,255,255,255,255,255,255],[248,254,249,253,255,255,255,255,255,255,255]],[[255,253,253,255,255,255,255,255,255,255,255],[246,253,253,255,255,255,255,255,255,255,255],[252,254,251,254,254,255,255,255,255,255,255]],[[255,254,252,255,255,255,255,255,255,255,255],[248,254,253,255,255,255,255,255,255,255,255],[253,255,254,254,255,255,255,255,255,255,255]],[[255,251,254,255,255,255,255,255,255,255,255],[245,251,254,255,255,255,255,255,255,255,255],[253,253,254,255,255,255,255,255,255,255,255]],[[255,251,253,255,255,255,255,255,255,255,255],[252,253,254,255,255,255,255,255,255,255,255],[255,254,255,255,255,255,255,255,255,255,255]],[[255,252,255,255,255,255,255,255,255,255,255],[249,255,254,255,255,255,255,255,255,255,255],[255,255,254,255,255,255,255,255,255,255,255]],[[255,255,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]]],vg=[0,1,2,3,6,4,5,6,6,6,6,6,6,6,6,7,0],va=[],Ko=[],Jo=[],lp=1,wf=2,Lc=[],ws=[];aa("UpsampleRgbLinePair",Ba,3),aa("UpsampleBgrLinePair",Yo,3),aa("UpsampleRgbaLinePair",au,4),aa("UpsampleBgraLinePair",cs,4),aa("UpsampleArgbLinePair",lh,4),aa("UpsampleRgba4444LinePair",Ea,2),aa("UpsampleRgb565LinePair",Eu,2);var up=G.UpsampleRgbLinePair,Nc=G.UpsampleBgrLinePair,cp=G.UpsampleRgbaLinePair,_g=G.UpsampleBgraLinePair,bg=G.UpsampleArgbLinePair,xg=G.UpsampleRgba4444LinePair,ny=G.UpsampleRgb565LinePair,md=16,ql=1<<md-1,hc=-227,al=482,Sf=6,hp=0,iy=a(256),ay=a(256),Ef=a(256),wg=a(256),Tf=a(al-hc),oy=a(al-hc);Fs("YuvToRgbRow",Ba,3),Fs("YuvToBgrRow",Yo,3),Fs("YuvToRgbaRow",au,4),Fs("YuvToBgraRow",cs,4),Fs("YuvToArgbRow",lh,4),Fs("YuvToRgba4444Row",Ea,2),Fs("YuvToRgb565Row",Eu,2);var El=[0,4,8,12,128,132,136,140,256,260,264,268,384,388,392,396],Hl=[0,2,8],Cf=[8,7,6,4,4,2,2,2,1,1,1,1],Yu=1;this.WebPDecodeRGBA=function($,Z,de,Pe,He){var Je=uh,tt=new wn,We=new bt;tt.ba=We,We.S=Je,We.width=[We.width],We.height=[We.height];var ft=We.width,Et=We.height,Vt=new Tr;if(Vt==null||$==null)var vr=2;else e(Vt!=null),vr=Fl($,Z,de,Vt.width,Vt.height,Vt.Pd,Vt.Qd,Vt.format,null);if(vr!=0?ft=0:(ft!=null&&(ft[0]=Vt.width[0]),Et!=null&&(Et[0]=Vt.height[0]),ft=1),ft){We.width=We.width[0],We.height=We.height[0],Pe!=null&&(Pe[0]=We.width),He!=null&&(He[0]=We.height);e:{if(Pe=new ls,(He=new ni).data=$,He.w=Z,He.ha=de,He.kd=1,Z=[0],e(He!=null),(($=Fl(He.data,He.w,He.ha,null,null,null,Z,null,He))==0||$==7)&&Z[0]&&($=4),(Z=$)==0){if(e(tt!=null),Pe.data=He.data,Pe.w=He.w+He.offset,Pe.ha=He.ha-He.offset,Pe.put=un,Pe.ac=ti,Pe.bc=ri,Pe.ma=tt,He.xa){if(($=Wi())==null){tt=1;break e}if((function(St,Qt){var Ut=[0],Or=[0],xr=[0];t:for(;;){if(St==null)return 0;if(Qt==null)return St.a=2,0;if(St.l=Qt,St.a=0,we(St.m,Qt.data,Qt.w,Qt.ha),!Ae(St.m,Ut,Or,xr)){St.a=3;break t}if(St.xb=wf,Qt.width=Ut[0],Qt.height=Or[0],!Fn(Ut[0],Or[0],1,St,null))break t;return 1}return e(St.a!=0),0})($,Pe)){if(Pe=(Z=Bs(Pe.width,Pe.height,tt.Oa,tt.ba))==0){t:{Pe=$;r:for(;;){if(Pe==null){Pe=0;break t}if(e(Pe.s.yc!=null),e(Pe.s.Ya!=null),e(0<Pe.s.Wb),e((de=Pe.l)!=null),e((He=de.ma)!=null),Pe.xb!=0){if(Pe.ca=He.ba,Pe.tb=He.tb,e(Pe.ca!=null),!Ao(He.Oa,de,cc)){Pe.a=2;break r}if(!Ia(Pe,de.width)||de.da)break r;if((de.da||Jt(Pe.ca.S))&&Dl(),11>Pe.ca.S||(alert("todo:WebPInitConvertARGBToYUV"),Pe.ca.f.kb.F!=null&&Dl()),Pe.Pb&&0<Pe.s.ua&&Pe.s.vb.X==null&&!je(Pe.s.vb,Pe.s.Wa.Xa)){Pe.a=1;break r}Pe.xb=0}if(!Mi(Pe,Pe.V,Pe.Ba,Pe.c,Pe.i,de.o,Oi))break r;He.Dc=Pe.Ma,Pe=1;break t}e(Pe.a!=0),Pe=0}Pe=!Pe}Pe&&(Z=$.a)}else Z=$.a}else{if(($=new kc)==null){tt=1;break e}if($.Fa=He.na,$.P=He.P,$.qc=He.Sa,Rc($,Pe)){if((Z=Bs(Pe.width,Pe.height,tt.Oa,tt.ba))==0){if($.Aa=0,de=tt.Oa,e((He=$)!=null),de!=null){if(0<(ft=0>(ft=de.Md)?0:100<ft?255:255*ft/100)){for(Et=Vt=0;4>Et;++Et)12>(vr=He.pb[Et]).lc&&(vr.ia=ft*Cf[0>vr.lc?0:vr.lc]>>3),Vt|=vr.ia;Vt&&(alert("todo:VP8InitRandom"),He.ia=1)}He.Ga=de.Id,100<He.Ga?He.Ga=100:0>He.Ga&&(He.Ga=0)}(function(St,Qt){if(St==null)return 0;if(Qt==null)return Sa(St,2,"NULL VP8Io parameter in VP8Decode().");if(!St.cb&&!Rc(St,Qt))return 0;if(e(St.cb),Qt.ac==null||Qt.ac(Qt)){Qt.ob&&(St.L=0);var Ut=Hl[St.L];if(St.L==2?(St.yb=0,St.zb=0):(St.yb=Qt.v-Ut>>4,St.zb=Qt.j-Ut>>4,0>St.yb&&(St.yb=0),0>St.zb&&(St.zb=0)),St.Va=Qt.o+15+Ut>>4,St.Hb=Qt.va+15+Ut>>4,St.Hb>St.za&&(St.Hb=St.za),St.Va>St.Ub&&(St.Va=St.Ub),0<St.L){var Or=St.ed;for(Ut=0;4>Ut;++Ut){var xr;if(St.Qa.Cb){var Nr=St.Qa.Lb[Ut];St.Qa.Fb||(Nr+=Or.Tb)}else Nr=Or.Tb;for(xr=0;1>=xr;++xr){var jr=St.gd[Ut][xr],rn=Nr;if(Or.Pc&&(rn+=Or.vd[0],xr&&(rn+=Or.od[0])),0<(rn=0>rn?0:63<rn?63:rn)){var Kr=rn;0<Or.wb&&(Kr=4<Or.wb?Kr>>2:Kr>>1)>9-Or.wb&&(Kr=9-Or.wb),1>Kr&&(Kr=1),jr.dd=Kr,jr.tc=2*rn+Kr,jr.ld=40<=rn?2:15<=rn?1:0}else jr.tc=0;jr.La=xr}}}Ut=0}else Sa(St,6,"Frame setup failed"),Ut=St.a;if(Ut=Ut==0){if(Ut){St.$c=0,0<St.Aa||(St.Ic=Yu);t:{Ut=St.Ic,Or=4*(Kr=St.za);var Kn=32*Kr,zn=Kr+1,Li=0<St.L?Kr*(0<St.Aa?2:1):0,Gn=(St.Aa==2?2:1)*Kr;if((jr=Or+832+(xr=3*(16*Ut+Hl[St.L])/2*Kn)+(Nr=St.Fa!=null&&0<St.Fa.length?St.Kc.c*St.Kc.i:0))!=jr)Ut=0;else{if(jr>St.Vb){if(St.Vb=0,St.Ec=a(jr),St.Fc=0,St.Ec==null){Ut=Sa(St,1,"no memory during frame initialization.");break t}St.Vb=jr}jr=St.Ec,rn=St.Fc,St.Ac=jr,St.Bc=rn,rn+=Or,St.Gd=s(Kn,Wo),St.Hd=0,St.rb=s(zn+1,bu),St.sb=1,St.wa=Li?s(Li,Hn):null,St.Y=0,St.D.Nb=0,St.D.wa=St.wa,St.D.Y=St.Y,0<St.Aa&&(St.D.Y+=Kr),e(!0),St.oc=jr,St.pc=rn,rn+=832,St.ya=s(Gn,Pa),St.aa=0,St.D.ya=St.ya,St.D.aa=St.aa,St.Aa==2&&(St.D.aa+=Kr),St.R=16*Kr,St.B=8*Kr,Kr=(Kn=Hl[St.L])*St.R,Kn=Kn/2*St.B,St.sa=jr,St.ta=rn+Kr,St.qa=St.sa,St.ra=St.ta+16*Ut*St.R+Kn,St.Ha=St.qa,St.Ia=St.ra+8*Ut*St.B+Kn,St.$c=0,rn+=xr,St.mb=Nr?jr:null,St.nb=Nr?rn:null,e(rn+Nr<=St.Fc+St.Vb),Qs(St),i(St.Ac,St.Bc,0,Or),Ut=1}}if(Ut){if(Qt.ka=0,Qt.y=St.sa,Qt.O=St.ta,Qt.f=St.qa,Qt.N=St.ra,Qt.ea=St.Ha,Qt.Vd=St.Ia,Qt.fa=St.R,Qt.Rc=St.B,Qt.F=null,Qt.J=0,!Zo){for(Ut=-255;255>=Ut;++Ut)xs[255+Ut]=0>Ut?-Ut:Ut;for(Ut=-1020;1020>=Ut;++Ut)Vl[1020+Ut]=-128>Ut?-128:127<Ut?127:Ut;for(Ut=-112;112>=Ut;++Ut)Gu[112+Ut]=-16>Ut?-16:15<Ut?15:Ut;for(Ut=-255;510>=Ut;++Ut)Us[255+Ut]=0>Ut?0:255<Ut?255:Ut;Zo=1}y=Tt,_=wu,U=J,re=pe,ye=Xe,I=xu,Re=le,Ke=Ve,yt=nr,Zt=Lr,ur=dt,Vr=Dt,gn=Zr,Rn=kn,Vn=rl,In=bl,Dn=lo,Qi=uo,Ko[0]=Wn,Ko[1]=kt,Ko[2]=Mr,Ko[3]=cn,Ko[4]=Ma,Ko[5]=Ra,Ko[6]=Ci,Ko[7]=gi,Ko[8]=us,Ko[9]=jn,va[0]=Qr,va[1]=$r,va[2]=Yr,va[3]=Hr,va[4]=Qn,va[5]=Ei,va[6]=En,Jo[0]=Yn,Jo[1]=Gt,Jo[2]=Un,Jo[3]=Nn,Jo[4]=To,Jo[5]=Do,Jo[6]=Xo,Ut=1}else Ut=0}Ut&&(Ut=(function(ea,Qo){for(ea.M=0;ea.M<ea.Va;++ea.M){var yi,mn=ea.Jc[ea.M&ea.Xb],_n=ea.m,So=ea;for(yi=0;yi<So.za;++yi){var ki=_n,ta=So,za=ta.Ac,Ss=ta.Bc+4*yi,fo=ta.zc,to=ta.ya[ta.aa+yi];if(ta.Qa.Bb?to.$b=Ye(ki,ta.Pa.jb[0])?2+Ye(ki,ta.Pa.jb[2]):Ye(ki,ta.Pa.jb[1]):to.$b=0,ta.kc&&(to.Ad=Ye(ki,ta.Bd)),to.Za=!Ye(ki,145)+0,to.Za){var xn=to.Ob,On=0;for(ta=0;4>ta;++ta){var Io,zi=fo[0+ta];for(Io=0;4>Io;++Io){zi=yg[za[Ss+Io]][zi];for(var la=mg[Ye(ki,zi[0])];0<la;)la=mg[2*la+Ye(ki,zi[la])];zi=-la,za[Ss+Io]=zi}n(xn,On,za,Ss,4),On+=4,fo[0+ta]=zi}}else zi=Ye(ki,156)?Ye(ki,128)?1:3:Ye(ki,163)?2:0,to.Ob[0]=zi,i(za,Ss,zi,4),i(fo,0,zi,4);to.Dd=Ye(ki,142)?Ye(ki,114)?Ye(ki,183)?1:3:2:0}if(So.m.Ka)return Sa(ea,7,"Premature end-of-partition0 encountered.");for(;ea.ja<ea.za;++ea.ja){if(So=mn,ki=(_n=ea).rb[_n.sb-1],za=_n.rb[_n.sb+_n.ja],yi=_n.ya[_n.aa+_n.ja],Ss=_n.kc?yi.Ad:0)ki.la=za.la=0,yi.Za||(ki.Na=za.Na=0),yi.Hc=0,yi.Gc=0,yi.ia=0;else{var ra,_a;if(ki=za,za=So,Ss=_n.Pa.Xc,fo=_n.ya[_n.aa+_n.ja],to=_n.pb[fo.$b],ta=fo.ad,xn=0,On=_n.rb[_n.sb-1],zi=Io=0,i(ta,xn,0,384),fo.Za)var Oa=0,Zu=Ss[3];else{la=a(16);var ro=ki.Na+On.Na;if(ro=Xu(za,Ss[1],ro,to.Eb,0,la,0),ki.Na=On.Na=(0<ro)+0,1<ro)y(la,0,ta,xn);else{var Ni=la[0]+3>>3;for(la=0;256>la;la+=16)ta[xn+la]=Ni}Oa=1,Zu=Ss[0]}var wi=15&ki.la,Po=15&On.la;for(la=0;4>la;++la){var Es=1&Po;for(Ni=_a=0;4>Ni;++Ni)wi=wi>>1|(Es=(ro=Xu(za,Zu,ro=Es+(1&wi),to.Sc,Oa,ta,xn))>Oa)<<7,_a=_a<<2|(3<ro?3:1<ro?2:ta[xn+0]!=0),xn+=16;wi>>=4,Po=Po>>1|Es<<7,Io=(Io<<8|_a)>>>0}for(Zu=wi,Oa=Po>>4,ra=0;4>ra;ra+=2){for(_a=0,wi=ki.la>>4+ra,Po=On.la>>4+ra,la=0;2>la;++la){for(Es=1&Po,Ni=0;2>Ni;++Ni)ro=Es+(1&wi),wi=wi>>1|(Es=0<(ro=Xu(za,Ss[2],ro,to.Qc,0,ta,xn)))<<3,_a=_a<<2|(3<ro?3:1<ro?2:ta[xn+0]!=0),xn+=16;wi>>=2,Po=Po>>1|Es<<5}zi|=_a<<4*ra,Zu|=wi<<4<<ra,Oa|=(240&Po)<<ra}ki.la=Zu,On.la=Oa,fo.Hc=Io,fo.Gc=zi,fo.ia=43690&zi?0:to.ia,Ss=!(Io|zi)}if(0<_n.L&&(_n.wa[_n.Y+_n.ja]=_n.gd[yi.$b][yi.Za],_n.wa[_n.Y+_n.ja].La|=!Ss),So.Ka)return Sa(ea,7,"Premature end-of-file encountered.")}if(Qs(ea),_n=Qo,So=1,yi=(mn=ea).D,ki=0<mn.L&&mn.M>=mn.zb&&mn.M<=mn.Va,mn.Aa==0)t:{if(yi.M=mn.M,yi.uc=ki,wl(mn,yi),So=1,yi=(_a=mn.D).Nb,ki=(zi=Hl[mn.L])*mn.R,za=zi/2*mn.B,la=16*yi*mn.R,Ni=8*yi*mn.B,Ss=mn.sa,fo=mn.ta-ki+la,to=mn.qa,ta=mn.ra-za+Ni,xn=mn.Ha,On=mn.Ia-za+Ni,Po=(wi=_a.M)==0,Io=wi>=mn.Va-1,mn.Aa==2&&wl(mn,_a),_a.uc)for(Es=(ro=mn).D.M,e(ro.D.uc),_a=ro.yb;_a<ro.Hb;++_a){Oa=_a,Zu=Es;var es=(Tl=(ds=ro).D).Nb;ra=ds.R;var Tl=Tl.wa[Tl.Y+Oa],Ts=ds.sa,ts=ds.ta+16*es*ra+16*Oa,Vs=Tl.dd,Ca=Tl.tc;if(Ca!=0)if(e(3<=Ca),ds.L==1)0<Oa&&In(Ts,ts,ra,Ca+4),Tl.La&&Qi(Ts,ts,ra,Ca),0<Zu&&Vn(Ts,ts,ra,Ca+4),Tl.La&&Dn(Ts,ts,ra,Ca);else{var fs=ds.B,su=ds.qa,Dc=ds.ra+8*es*fs+8*Oa,Au=ds.Ha,ds=ds.Ia+8*es*fs+8*Oa;es=Tl.ld,0<Oa&&(Ke(Ts,ts,ra,Ca+4,Vs,es),Zt(su,Dc,Au,ds,fs,Ca+4,Vs,es)),Tl.La&&(Vr(Ts,ts,ra,Ca,Vs,es),Rn(su,Dc,Au,ds,fs,Ca,Vs,es)),0<Zu&&(Re(Ts,ts,ra,Ca+4,Vs,es),yt(su,Dc,Au,ds,fs,Ca+4,Vs,es)),Tl.La&&(ur(Ts,ts,ra,Ca,Vs,es),gn(su,Dc,Au,ds,fs,Ca,Vs,es))}}if(mn.ia&&alert("todo:DitherRow"),_n.put!=null){if(_a=16*wi,wi=16*(wi+1),Po?(_n.y=mn.sa,_n.O=mn.ta+la,_n.f=mn.qa,_n.N=mn.ra+Ni,_n.ea=mn.Ha,_n.W=mn.Ia+Ni):(_a-=zi,_n.y=Ss,_n.O=fo,_n.f=to,_n.N=ta,_n.ea=xn,_n.W=On),Io||(wi-=zi),wi>_n.o&&(wi=_n.o),_n.F=null,_n.J=null,mn.Fa!=null&&0<mn.Fa.length&&_a<wi&&(_n.J=Qa(mn,_n,_a,wi-_a),_n.F=mn.mb,_n.F==null&&_n.F.length==0)){So=Sa(mn,3,"Could not decode alpha data.");break t}_a<_n.j&&(zi=_n.j-_a,_a=_n.j,e(!(1&zi)),_n.O+=mn.R*zi,_n.N+=mn.B*(zi>>1),_n.W+=mn.B*(zi>>1),_n.F!=null&&(_n.J+=_n.width*zi)),_a<wi&&(_n.O+=_n.v,_n.N+=_n.v>>1,_n.W+=_n.v>>1,_n.F!=null&&(_n.J+=_n.v),_n.ka=_a-_n.j,_n.U=_n.va-_n.v,_n.T=wi-_a,So=_n.put(_n))}yi+1!=mn.Ic||Io||(n(mn.sa,mn.ta-ki,Ss,fo+16*mn.R,ki),n(mn.qa,mn.ra-za,to,ta+8*mn.B,za),n(mn.Ha,mn.Ia-za,xn,On+8*mn.B,za))}if(!So)return Sa(ea,6,"Output aborted.")}return 1})(St,Qt)),Qt.bc!=null&&Qt.bc(Qt),Ut&=1}return Ut?(St.cb=0,Ut):0})($,Pe)||(Z=$.a)}}else Z=$.a}Z==0&&tt.Oa!=null&&tt.Oa.fd&&(Z=ho(tt.ba))}tt=Z}Je=tt!=0?null:11>Je?We.f.RGBA.eb:We.f.kb.y}else Je=null;return Je};var jh=[3,4,3,4,4,2,2,4,4,4,2,1,1]};function h(G,ie){for(var Q="",H=0;H<4;H++)Q+=String.fromCharCode(G[ie++]);return Q}function f(G,ie){return G[ie+0]|G[ie+1]<<8}function g(G,ie){return(G[ie+0]|G[ie+1]<<8|G[ie+2]<<16)>>>0}function b(G,ie){return(G[ie+0]|G[ie+1]<<8|G[ie+2]<<16|G[ie+3]<<24)>>>0}new u;var v=[0],S=[0],E=[],P=new u,k=t,L=(function(G,ie){var Q={},H=0,ne=!1,oe=0,ce=0;if(Q.frames=[],!(function(he,Ee){for(var xe=0;xe<4;xe++)if(he[Ee+xe]!="RIFF".charCodeAt(xe))return!0;return!1})(G,ie)){for(b(G,ie+=4),ie+=8;ie<G.length;){var fe=h(G,ie),Me=b(G,ie+=4);ie+=4;var me=Me+(1&Me);switch(fe){case"VP8 ":case"VP8L":Q.frames[H]===void 0&&(Q.frames[H]={}),(ke=Q.frames[H]).src_off=ne?ce:ie-8,ke.src_size=oe+Me+8,H++,ne&&(ne=!1,oe=0,ce=0);break;case"VP8X":(ke=Q.header={}).feature_flags=G[ie];var we=ie+4;ke.canvas_width=1+g(G,we),we+=3,ke.canvas_height=1+g(G,we),we+=3;break;case"ALPH":ne=!0,oe=me+8,ce=ie-8;break;case"ANIM":(ke=Q.header).bgcolor=b(G,ie),we=ie+4,ke.loop_count=f(G,we),we+=2;break;case"ANMF":var Te,ke;(ke=Q.frames[H]={}).offset_x=2*g(G,ie),ie+=3,ke.offset_y=2*g(G,ie),ie+=3,ke.width=1+g(G,ie),ie+=3,ke.height=1+g(G,ie),ie+=3,ke.duration=g(G,ie),ie+=3,Te=G[ie++],ke.dispose=1&Te,ke.blend=Te>>1&1}fe!="ANMF"&&(ie+=me)}return Q}})(k,0);L.response=k,L.rgbaoutput=!0,L.dataurl=!1;var O=L.header?L.header:null,M=L.frames?L.frames:null;if(O){O.loop_counter=O.loop_count,v=[O.canvas_height],S=[O.canvas_width];for(var z=0;z<M.length&&M[z].blend!=0;z++);}var B=M[0],q=P.WebPDecodeRGBA(k,B.src_off,B.src_size,S,v);B.rgba=q,B.imgwidth=S[0],B.imgheight=v[0];for(var W=0;W<S[0]*v[0]*4;W++)E[W]=q[W];return this.width=S,this.height=v,this.data=E,this}(function(t){var e,r,n,i,a,s,o,u,h,f=function(he){return he=he||{},this.isStrokeTransparent=he.isStrokeTransparent||!1,this.strokeOpacity=he.strokeOpacity||1,this.strokeStyle=he.strokeStyle||"#000000",this.fillStyle=he.fillStyle||"#000000",this.isFillTransparent=he.isFillTransparent||!1,this.fillOpacity=he.fillOpacity||1,this.font=he.font||"10px sans-serif",this.textBaseline=he.textBaseline||"alphabetic",this.textAlign=he.textAlign||"left",this.lineWidth=he.lineWidth||1,this.lineJoin=he.lineJoin||"miter",this.lineCap=he.lineCap||"butt",this.path=he.path||[],this.transform=he.transform!==void 0?he.transform.clone():new u,this.globalCompositeOperation=he.globalCompositeOperation||"normal",this.globalAlpha=he.globalAlpha||1,this.clip_path=he.clip_path||[],this.currentPoint=he.currentPoint||new s,this.miterLimit=he.miterLimit||10,this.lastPoint=he.lastPoint||new s,this.lineDashOffset=he.lineDashOffset||0,this.lineDash=he.lineDash||[],this.margin=he.margin||[0,0,0,0],this.prevPageLastElemOffset=he.prevPageLastElemOffset||0,this.ignoreClearRect=typeof he.ignoreClearRect!="boolean"||he.ignoreClearRect,this};t.events.push(["initialized",function(){this.context2d=new g(this),e=this.internal.f2,r=this.internal.getCoordinateString,n=this.internal.getVerticalCoordinateString,i=this.internal.getHorizontalCoordinate,a=this.internal.getVerticalCoordinate,s=this.internal.Point,o=this.internal.Rectangle,u=this.internal.Matrix,h=new f}]);var g=function(he){Object.defineProperty(this,"canvas",{get:function(){return{parentNode:!1,style:!1}}});var Ee=he;Object.defineProperty(this,"pdf",{get:function(){return Ee}});var xe=!1;Object.defineProperty(this,"pageWrapXEnabled",{get:function(){return xe},set:function(at){xe=!!at}});var Ne=!1;Object.defineProperty(this,"pageWrapYEnabled",{get:function(){return Ne},set:function(at){Ne=!!at}});var Oe=0;Object.defineProperty(this,"posX",{get:function(){return Oe},set:function(at){isNaN(at)||(Oe=at)}});var $e=0;Object.defineProperty(this,"posY",{get:function(){return $e},set:function(at){isNaN(at)||($e=at)}}),Object.defineProperty(this,"margin",{get:function(){return h.margin},set:function(at){var je;typeof at=="number"?je=[at,at,at,at]:((je=new Array(4))[0]=at[0],je[1]=at.length>=2?at[1]:je[0],je[2]=at.length>=3?at[2]:je[0],je[3]=at.length>=4?at[3]:je[1]),h.margin=je}});var De=!1;Object.defineProperty(this,"autoPaging",{get:function(){return De},set:function(at){De=at}});var it=0;Object.defineProperty(this,"lastBreak",{get:function(){return it},set:function(at){it=at}});var Ye=[];Object.defineProperty(this,"pageBreaks",{get:function(){return Ye},set:function(at){Ye=at}}),Object.defineProperty(this,"ctx",{get:function(){return h},set:function(at){at instanceof f&&(h=at)}}),Object.defineProperty(this,"path",{get:function(){return h.path},set:function(at){h.path=at}});var rt=[];Object.defineProperty(this,"ctxStack",{get:function(){return rt},set:function(at){rt=at}}),Object.defineProperty(this,"fillStyle",{get:function(){return this.ctx.fillStyle},set:function(at){var je;je=b(at),this.ctx.fillStyle=je.style,this.ctx.isFillTransparent=je.a===0,this.ctx.fillOpacity=je.a,this.pdf.setFillColor(je.r,je.g,je.b,{a:je.a}),this.pdf.setTextColor(je.r,je.g,je.b,{a:je.a})}}),Object.defineProperty(this,"strokeStyle",{get:function(){return this.ctx.strokeStyle},set:function(at){var je=b(at);this.ctx.strokeStyle=je.style,this.ctx.isStrokeTransparent=je.a===0,this.ctx.strokeOpacity=je.a,je.a===0?this.pdf.setDrawColor(255,255,255):(je.a,this.pdf.setDrawColor(je.r,je.g,je.b))}}),Object.defineProperty(this,"lineCap",{get:function(){return this.ctx.lineCap},set:function(at){["butt","round","square"].indexOf(at)!==-1&&(this.ctx.lineCap=at,this.pdf.setLineCap(at))}}),Object.defineProperty(this,"lineWidth",{get:function(){return this.ctx.lineWidth},set:function(at){isNaN(at)||(this.ctx.lineWidth=at,this.pdf.setLineWidth(at))}}),Object.defineProperty(this,"lineJoin",{get:function(){return this.ctx.lineJoin},set:function(at){["bevel","round","miter"].indexOf(at)!==-1&&(this.ctx.lineJoin=at,this.pdf.setLineJoin(at))}}),Object.defineProperty(this,"miterLimit",{get:function(){return this.ctx.miterLimit},set:function(at){isNaN(at)||(this.ctx.miterLimit=at,this.pdf.setMiterLimit(at))}}),Object.defineProperty(this,"textBaseline",{get:function(){return this.ctx.textBaseline},set:function(at){this.ctx.textBaseline=at}}),Object.defineProperty(this,"textAlign",{get:function(){return this.ctx.textAlign},set:function(at){["right","end","center","left","start"].indexOf(at)!==-1&&(this.ctx.textAlign=at)}});var Ie=null,Mt=null;Object.defineProperty(this,"fontFaces",{get:function(){return Mt},set:function(at){Ie=null,Mt=at}}),Object.defineProperty(this,"font",{get:function(){return this.ctx.font},set:function(at){var je;if(this.ctx.font=at,(je=/^\s*(?=(?:(?:[-a-z]+\s*){0,2}(italic|oblique))?)(?=(?:(?:[-a-z]+\s*){0,2}(small-caps))?)(?=(?:(?:[-a-z]+\s*){0,2}(bold(?:er)?|lighter|[1-9]00))?)(?:(?:normal|\1|\2|\3)\s*){0,3}((?:xx?-)?(?:small|large)|medium|smaller|larger|[.\d]+(?:\%|in|[cem]m|ex|p[ctx]))(?:\s*\/\s*(normal|[.\d]+(?:\%|in|[cem]m|ex|p[ctx])))?\s*([-_,\"\'\sa-z]+?)\s*$/i.exec(at))!==null){var Xt=je[1];je[2];var Yt=je[3],pr=je[4];je[5];var vt=je[6],yr=/^([.\d]+)((?:%|in|[cem]m|ex|p[ctx]))$/i.exec(pr)[2];pr=Math.floor(yr==="px"?parseFloat(pr)*this.pdf.internal.scaleFactor:yr==="em"?parseFloat(pr)*this.pdf.getFontSize():parseFloat(pr)*this.pdf.internal.scaleFactor),this.pdf.setFontSize(pr);var _r=(function(_e){var be,qe,Qe=[],ot=_e.trim();if(ot==="")return L3;if(ot in bB)return[bB[ot]];for(;ot!=="";){switch(qe=null,be=(ot=wB(ot)).charAt(0)){case'"':case"'":qe=ive(ot.substring(1),be);break;default:qe=ave(ot)}if(qe===null||(Qe.push(qe[0]),(ot=wB(qe[1]))!==""&&ot.charAt(0)!==","))return L3;ot=ot.replace(/^,/,"")}return Qe})(vt);if(this.fontFaces){var cr=(function(_e,be){if(Ie===null){var qe=(function(Qe){var ot=[];return Object.keys(Qe).forEach(function(et){Qe[et].forEach(function(Lt){var _t=null;switch(Lt){case"bold":_t={family:et,weight:"bold"};break;case"italic":_t={family:et,style:"italic"};break;case"bolditalic":_t={family:et,weight:"bold",style:"italic"};break;case"":case"normal":_t={family:et}}_t!==null&&(_t.ref={name:et,style:Lt},ot.push(_t))})}),ot})(_e.getFontList());Ie=(function(Qe){for(var ot={},et=0;et<Qe.length;++et){var Lt=O3(Qe[et]),_t=Lt.family,jt=Lt.stretch,Jt=Lt.style,Kt=Lt.weight;ot[_t]=ot[_t]||{},ot[_t][jt]=ot[_t][jt]||{},ot[_t][jt][Jt]=ot[_t][jt][Jt]||{},ot[_t][jt][Jt][Kt]=Lt}return ot})(qe.concat(be))}return Ie})(this.pdf,this.fontFaces),Er=_r.map(function(_e){return{family:_e,stretch:"normal",weight:Yt,style:Xt}}),wr=(function(_e,be,qe){for(var Qe=(qe=qe||{}).defaultFontFamily||"times",ot=Object.assign({},nve,qe.genericFontFamilies||{}),et=null,Lt=null,_t=0;_t<be.length;++_t)if(ot[(et=O3(be[_t])).family]&&(et.family=ot[et.family]),_e.hasOwnProperty(et.family)){Lt=_e[et.family];break}if(!(Lt=Lt||_e[Qe]))throw new Error("Could not find a font-family for the rule '"+xB(et)+"' and default family '"+Qe+"'.");if(Lt=(function(jt,Jt){if(Jt[jt])return Jt[jt];var Kt=GP[jt],Rr=Kt<=GP.normal?-1:1,bt=_B(Jt,SX,Kt,Rr);if(!bt)throw new Error("Could not find a matching font-stretch value for "+jt);return bt})(et.stretch,Lt),Lt=(function(jt,Jt){if(Jt[jt])return Jt[jt];for(var Kt=wX[jt],Rr=0;Rr<Kt.length;++Rr)if(Jt[Kt[Rr]])return Jt[Kt[Rr]];throw new Error("Could not find a matching font-style for "+jt)})(et.style,Lt),!(Lt=(function(jt,Jt){if(Jt[jt])return Jt[jt];if(jt===400&&Jt[500])return Jt[500];if(jt===500&&Jt[400])return Jt[400];var Kt=rve[jt],Rr=_B(Jt,EX,Kt,jt<400?-1:1);if(!Rr)throw new Error("Could not find a matching font-weight for value "+jt);return Rr})(et.weight,Lt)))throw new Error("Failed to resolve a font for the rule '"+xB(et)+"'.");return Lt})(cr,Er);this.pdf.setFont(wr.ref.name,wr.ref.style)}else{var er="";(Yt==="bold"||parseInt(Yt,10)>=700||Xt==="bold")&&(er="bold"),Xt==="italic"&&(er+="italic"),er.length===0&&(er="normal");for(var lr="",Ar={arial:"Helvetica",Arial:"Helvetica",verdana:"Helvetica",Verdana:"Helvetica",helvetica:"Helvetica",Helvetica:"Helvetica","sans-serif":"Helvetica",fixed:"Courier",monospace:"Courier",terminal:"Courier",cursive:"Times",fantasy:"Times",serif:"Times"},ir=0;ir<_r.length;ir++){if(this.pdf.internal.getFont(_r[ir],er,{noFallback:!0,disableWarning:!0})!==void 0){lr=_r[ir];break}if(er==="bolditalic"&&this.pdf.internal.getFont(_r[ir],"bold",{noFallback:!0,disableWarning:!0})!==void 0)lr=_r[ir],er="bold";else if(this.pdf.internal.getFont(_r[ir],"normal",{noFallback:!0,disableWarning:!0})!==void 0){lr=_r[ir],er="normal";break}}if(lr===""){for(var nt=0;nt<_r.length;nt++)if(Ar[_r[nt]]){lr=Ar[_r[nt]];break}}lr=lr===""?"Times":lr,this.pdf.setFont(lr,er)}}}}),Object.defineProperty(this,"globalCompositeOperation",{get:function(){return this.ctx.globalCompositeOperation},set:function(at){this.ctx.globalCompositeOperation=at}}),Object.defineProperty(this,"globalAlpha",{get:function(){return this.ctx.globalAlpha},set:function(at){this.ctx.globalAlpha=at}}),Object.defineProperty(this,"lineDashOffset",{get:function(){return this.ctx.lineDashOffset},set:function(at){this.ctx.lineDashOffset=at,ke.call(this)}}),Object.defineProperty(this,"lineDash",{get:function(){return this.ctx.lineDash},set:function(at){this.ctx.lineDash=at,ke.call(this)}}),Object.defineProperty(this,"ignoreClearRect",{get:function(){return this.ctx.ignoreClearRect},set:function(at){this.ctx.ignoreClearRect=!!at}})};g.prototype.setLineDash=function(he){this.lineDash=he},g.prototype.getLineDash=function(){return this.lineDash.length%2?this.lineDash.concat(this.lineDash):this.lineDash.slice()},g.prototype.fill=function(){M.call(this,"fill",!1)},g.prototype.stroke=function(){M.call(this,"stroke",!1)},g.prototype.beginPath=function(){this.path=[{type:"begin"}]},g.prototype.moveTo=function(he,Ee){if(isNaN(he)||isNaN(Ee))throw Eo.error("jsPDF.context2d.moveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.moveTo");var xe=this.ctx.transform.applyToPoint(new s(he,Ee));this.path.push({type:"mt",x:xe.x,y:xe.y}),this.ctx.lastPoint=new s(he,Ee)},g.prototype.closePath=function(){var he=new s(0,0),Ee=0;for(Ee=this.path.length-1;Ee!==-1;Ee--)if(this.path[Ee].type==="begin"&&ao(this.path[Ee+1])==="object"&&typeof this.path[Ee+1].x=="number"){he=new s(this.path[Ee+1].x,this.path[Ee+1].y);break}this.path.push({type:"close"}),this.ctx.lastPoint=new s(he.x,he.y)},g.prototype.lineTo=function(he,Ee){if(isNaN(he)||isNaN(Ee))throw Eo.error("jsPDF.context2d.lineTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.lineTo");var xe=this.ctx.transform.applyToPoint(new s(he,Ee));this.path.push({type:"lt",x:xe.x,y:xe.y}),this.ctx.lastPoint=new s(xe.x,xe.y)},g.prototype.clip=function(){this.ctx.clip_path=JSON.parse(JSON.stringify(this.path)),M.call(this,null,!0)},g.prototype.quadraticCurveTo=function(he,Ee,xe,Ne){if(isNaN(xe)||isNaN(Ne)||isNaN(he)||isNaN(Ee))throw Eo.error("jsPDF.context2d.quadraticCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.quadraticCurveTo");var Oe=this.ctx.transform.applyToPoint(new s(xe,Ne)),$e=this.ctx.transform.applyToPoint(new s(he,Ee));this.path.push({type:"qct",x1:$e.x,y1:$e.y,x:Oe.x,y:Oe.y}),this.ctx.lastPoint=new s(Oe.x,Oe.y)},g.prototype.bezierCurveTo=function(he,Ee,xe,Ne,Oe,$e){if(isNaN(Oe)||isNaN($e)||isNaN(he)||isNaN(Ee)||isNaN(xe)||isNaN(Ne))throw Eo.error("jsPDF.context2d.bezierCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.bezierCurveTo");var De=this.ctx.transform.applyToPoint(new s(Oe,$e)),it=this.ctx.transform.applyToPoint(new s(he,Ee)),Ye=this.ctx.transform.applyToPoint(new s(xe,Ne));this.path.push({type:"bct",x1:it.x,y1:it.y,x2:Ye.x,y2:Ye.y,x:De.x,y:De.y}),this.ctx.lastPoint=new s(De.x,De.y)},g.prototype.arc=function(he,Ee,xe,Ne,Oe,$e){if(isNaN(he)||isNaN(Ee)||isNaN(xe)||isNaN(Ne)||isNaN(Oe))throw Eo.error("jsPDF.context2d.arc: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.arc");if($e=!!$e,!this.ctx.transform.isIdentity){var De=this.ctx.transform.applyToPoint(new s(he,Ee));he=De.x,Ee=De.y;var it=this.ctx.transform.applyToPoint(new s(0,xe)),Ye=this.ctx.transform.applyToPoint(new s(0,0));xe=Math.sqrt(Math.pow(it.x-Ye.x,2)+Math.pow(it.y-Ye.y,2))}Math.abs(Oe-Ne)>=2*Math.PI&&(Ne=0,Oe=2*Math.PI),this.path.push({type:"arc",x:he,y:Ee,radius:xe,startAngle:Ne,endAngle:Oe,counterclockwise:$e})},g.prototype.arcTo=function(he,Ee,xe,Ne,Oe){throw new Error("arcTo not implemented.")},g.prototype.rect=function(he,Ee,xe,Ne){if(isNaN(he)||isNaN(Ee)||isNaN(xe)||isNaN(Ne))throw Eo.error("jsPDF.context2d.rect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rect");this.moveTo(he,Ee),this.lineTo(he+xe,Ee),this.lineTo(he+xe,Ee+Ne),this.lineTo(he,Ee+Ne),this.lineTo(he,Ee),this.lineTo(he+xe,Ee),this.lineTo(he,Ee)},g.prototype.fillRect=function(he,Ee,xe,Ne){if(isNaN(he)||isNaN(Ee)||isNaN(xe)||isNaN(Ne))throw Eo.error("jsPDF.context2d.fillRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillRect");if(!v.call(this)){var Oe={};this.lineCap!=="butt"&&(Oe.lineCap=this.lineCap,this.lineCap="butt"),this.lineJoin!=="miter"&&(Oe.lineJoin=this.lineJoin,this.lineJoin="miter"),this.beginPath(),this.rect(he,Ee,xe,Ne),this.fill(),Oe.hasOwnProperty("lineCap")&&(this.lineCap=Oe.lineCap),Oe.hasOwnProperty("lineJoin")&&(this.lineJoin=Oe.lineJoin)}},g.prototype.strokeRect=function(he,Ee,xe,Ne){if(isNaN(he)||isNaN(Ee)||isNaN(xe)||isNaN(Ne))throw Eo.error("jsPDF.context2d.strokeRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeRect");S.call(this)||(this.beginPath(),this.rect(he,Ee,xe,Ne),this.stroke())},g.prototype.clearRect=function(he,Ee,xe,Ne){if(isNaN(he)||isNaN(Ee)||isNaN(xe)||isNaN(Ne))throw Eo.error("jsPDF.context2d.clearRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.clearRect");this.ignoreClearRect||(this.fillStyle="#ffffff",this.fillRect(he,Ee,xe,Ne))},g.prototype.save=function(he){he=typeof he!="boolean"||he;for(var Ee=this.pdf.internal.getCurrentPageInfo().pageNumber,xe=0;xe<this.pdf.internal.getNumberOfPages();xe++)this.pdf.setPage(xe+1),this.pdf.internal.out("q");if(this.pdf.setPage(Ee),he){this.ctx.fontSize=this.pdf.internal.getFontSize();var Ne=new f(this.ctx);this.ctxStack.push(this.ctx),this.ctx=Ne}},g.prototype.restore=function(he){he=typeof he!="boolean"||he;for(var Ee=this.pdf.internal.getCurrentPageInfo().pageNumber,xe=0;xe<this.pdf.internal.getNumberOfPages();xe++)this.pdf.setPage(xe+1),this.pdf.internal.out("Q");this.pdf.setPage(Ee),he&&this.ctxStack.length!==0&&(this.ctx=this.ctxStack.pop(),this.fillStyle=this.ctx.fillStyle,this.strokeStyle=this.ctx.strokeStyle,this.font=this.ctx.font,this.lineCap=this.ctx.lineCap,this.lineWidth=this.ctx.lineWidth,this.lineJoin=this.ctx.lineJoin,this.lineDash=this.ctx.lineDash,this.lineDashOffset=this.ctx.lineDashOffset)},g.prototype.toDataURL=function(){throw new Error("toDataUrl not implemented.")};var b=function(he){var Ee,xe,Ne,Oe;if(he.isCanvasGradient===!0&&(he=he.getColor()),!he)return{r:0,g:0,b:0,a:0,style:he};if(/transparent|rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*0+\s*\)/.test(he))Ee=0,xe=0,Ne=0,Oe=0;else{var $e=/rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/.exec(he);if($e!==null)Ee=parseInt($e[1]),xe=parseInt($e[2]),Ne=parseInt($e[3]),Oe=1;else if(($e=/rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*([\d.]+)\s*\)/.exec(he))!==null)Ee=parseInt($e[1]),xe=parseInt($e[2]),Ne=parseInt($e[3]),Oe=parseFloat($e[4]);else{if(Oe=1,typeof he=="string"&&he.charAt(0)!=="#"){var De=new gX(he);he=De.ok?De.toHex():"#000000"}he.length===4?(Ee=he.substring(1,2),Ee+=Ee,xe=he.substring(2,3),xe+=xe,Ne=he.substring(3,4),Ne+=Ne):(Ee=he.substring(1,3),xe=he.substring(3,5),Ne=he.substring(5,7)),Ee=parseInt(Ee,16),xe=parseInt(xe,16),Ne=parseInt(Ne,16)}}return{r:Ee,g:xe,b:Ne,a:Oe,style:he}},v=function(){return this.ctx.isFillTransparent||this.globalAlpha==0},S=function(){return!!(this.ctx.isStrokeTransparent||this.globalAlpha==0)};g.prototype.fillText=function(he,Ee,xe,Ne){if(isNaN(Ee)||isNaN(xe)||typeof he!="string")throw Eo.error("jsPDF.context2d.fillText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillText");if(Ne=isNaN(Ne)?void 0:Ne,!v.call(this)){var Oe=me(this.ctx.transform.rotation),$e=this.ctx.transform.scaleX;H.call(this,{text:he,x:Ee,y:xe,scale:$e,angle:Oe,align:this.textAlign,maxWidth:Ne})}},g.prototype.strokeText=function(he,Ee,xe,Ne){if(isNaN(Ee)||isNaN(xe)||typeof he!="string")throw Eo.error("jsPDF.context2d.strokeText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeText");if(!S.call(this)){Ne=isNaN(Ne)?void 0:Ne;var Oe=me(this.ctx.transform.rotation),$e=this.ctx.transform.scaleX;H.call(this,{text:he,x:Ee,y:xe,scale:$e,renderingMode:"stroke",angle:Oe,align:this.textAlign,maxWidth:Ne})}},g.prototype.measureText=function(he){if(typeof he!="string")throw Eo.error("jsPDF.context2d.measureText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.measureText");var Ee=this.pdf,xe=this.pdf.internal.scaleFactor,Ne=Ee.internal.getFontSize(),Oe=Ee.getStringUnitWidth(he)*Ne/Ee.internal.scaleFactor;return new function($e){var De=($e=$e||{}).width||0;return Object.defineProperty(this,"width",{get:function(){return De}}),this}({width:Oe*=Math.round(96*xe/72*1e4)/1e4})},g.prototype.scale=function(he,Ee){if(isNaN(he)||isNaN(Ee))throw Eo.error("jsPDF.context2d.scale: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.scale");var xe=new u(he,0,0,Ee,0,0);this.ctx.transform=this.ctx.transform.multiply(xe)},g.prototype.rotate=function(he){if(isNaN(he))throw Eo.error("jsPDF.context2d.rotate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rotate");var Ee=new u(Math.cos(he),Math.sin(he),-Math.sin(he),Math.cos(he),0,0);this.ctx.transform=this.ctx.transform.multiply(Ee)},g.prototype.translate=function(he,Ee){if(isNaN(he)||isNaN(Ee))throw Eo.error("jsPDF.context2d.translate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.translate");var xe=new u(1,0,0,1,he,Ee);this.ctx.transform=this.ctx.transform.multiply(xe)},g.prototype.transform=function(he,Ee,xe,Ne,Oe,$e){if(isNaN(he)||isNaN(Ee)||isNaN(xe)||isNaN(Ne)||isNaN(Oe)||isNaN($e))throw Eo.error("jsPDF.context2d.transform: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.transform");var De=new u(he,Ee,xe,Ne,Oe,$e);this.ctx.transform=this.ctx.transform.multiply(De)},g.prototype.setTransform=function(he,Ee,xe,Ne,Oe,$e){he=isNaN(he)?1:he,Ee=isNaN(Ee)?0:Ee,xe=isNaN(xe)?0:xe,Ne=isNaN(Ne)?1:Ne,Oe=isNaN(Oe)?0:Oe,$e=isNaN($e)?0:$e,this.ctx.transform=new u(he,Ee,xe,Ne,Oe,$e)};var E=function(){return this.margin[0]>0||this.margin[1]>0||this.margin[2]>0||this.margin[3]>0};g.prototype.drawImage=function(he,Ee,xe,Ne,Oe,$e,De,it,Ye){var rt=this.pdf.getImageProperties(he),Ie=1,Mt=1,at=1,je=1;Ne!==void 0&&it!==void 0&&(at=it/Ne,je=Ye/Oe,Ie=rt.width/Ne*it/Ne,Mt=rt.height/Oe*Ye/Oe),$e===void 0&&($e=Ee,De=xe,Ee=0,xe=0),Ne!==void 0&&it===void 0&&(it=Ne,Ye=Oe),Ne===void 0&&it===void 0&&(it=rt.width,Ye=rt.height);for(var Xt,Yt=this.ctx.transform.decompose(),pr=me(Yt.rotate.shx),vt=new u,yr=(vt=(vt=(vt=vt.multiply(Yt.translate)).multiply(Yt.skew)).multiply(Yt.scale)).applyToRectangle(new o($e-Ee*at,De-xe*je,Ne*Ie,Oe*Mt)),_r=P.call(this,yr),cr=[],Er=0;Er<_r.length;Er+=1)cr.indexOf(_r[Er])===-1&&cr.push(_r[Er]);if(O(cr),this.autoPaging)for(var wr=cr[0],er=cr[cr.length-1],lr=wr;lr<er+1;lr++){this.pdf.setPage(lr);var Ar=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],ir=lr===1?this.posY+this.margin[0]:this.margin[0],nt=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],_e=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],be=lr===1?0:nt+(lr-2)*_e;if(this.ctx.clip_path.length!==0){var qe=this.path;Xt=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=L(Xt,this.posX+this.margin[3],-be+ir+this.ctx.prevPageLastElemOffset),z.call(this,"fill",!0),this.path=qe}var Qe=JSON.parse(JSON.stringify(yr));Qe=L([Qe],this.posX+this.margin[3],-be+ir+this.ctx.prevPageLastElemOffset)[0];var ot=(lr>wr||lr<er)&&E.call(this);ot&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Ar,_e,null).clip().discardPath()),this.pdf.addImage(he,"JPEG",Qe.x,Qe.y,Qe.w,Qe.h,null,null,pr),ot&&this.pdf.restoreGraphicsState()}else this.pdf.addImage(he,"JPEG",yr.x,yr.y,yr.w,yr.h,null,null,pr)};var P=function(he,Ee,xe){var Ne=[];Ee=Ee||this.pdf.internal.pageSize.width,xe=xe||this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2];var Oe=this.posY+this.ctx.prevPageLastElemOffset;switch(he.type){default:case"mt":case"lt":Ne.push(Math.floor((he.y+Oe)/xe)+1);break;case"arc":Ne.push(Math.floor((he.y+Oe-he.radius)/xe)+1),Ne.push(Math.floor((he.y+Oe+he.radius)/xe)+1);break;case"qct":var $e=we(this.ctx.lastPoint.x,this.ctx.lastPoint.y,he.x1,he.y1,he.x,he.y);Ne.push(Math.floor(($e.y+Oe)/xe)+1),Ne.push(Math.floor(($e.y+$e.h+Oe)/xe)+1);break;case"bct":var De=Te(this.ctx.lastPoint.x,this.ctx.lastPoint.y,he.x1,he.y1,he.x2,he.y2,he.x,he.y);Ne.push(Math.floor((De.y+Oe)/xe)+1),Ne.push(Math.floor((De.y+De.h+Oe)/xe)+1);break;case"rect":Ne.push(Math.floor((he.y+Oe)/xe)+1),Ne.push(Math.floor((he.y+he.h+Oe)/xe)+1)}for(var it=0;it<Ne.length;it+=1)for(;this.pdf.internal.getNumberOfPages()<Ne[it];)k.call(this);return Ne},k=function(){var he=this.fillStyle,Ee=this.strokeStyle,xe=this.font,Ne=this.lineCap,Oe=this.lineWidth,$e=this.lineJoin;this.pdf.addPage(),this.fillStyle=he,this.strokeStyle=Ee,this.font=xe,this.lineCap=Ne,this.lineWidth=Oe,this.lineJoin=$e},L=function(he,Ee,xe){for(var Ne=0;Ne<he.length;Ne++)switch(he[Ne].type){case"bct":he[Ne].x2+=Ee,he[Ne].y2+=xe;case"qct":he[Ne].x1+=Ee,he[Ne].y1+=xe;default:he[Ne].x+=Ee,he[Ne].y+=xe}return he},O=function(he){return he.sort(function(Ee,xe){return Ee-xe})},M=function(he,Ee){for(var xe,Ne,Oe=this.fillStyle,$e=this.strokeStyle,De=this.lineCap,it=this.lineWidth,Ye=Math.abs(it*this.ctx.transform.scaleX),rt=this.lineJoin,Ie=JSON.parse(JSON.stringify(this.path)),Mt=JSON.parse(JSON.stringify(this.path)),at=[],je=0;je<Mt.length;je++)if(Mt[je].x!==void 0)for(var Xt=P.call(this,Mt[je]),Yt=0;Yt<Xt.length;Yt+=1)at.indexOf(Xt[Yt])===-1&&at.push(Xt[Yt]);for(var pr=0;pr<at.length;pr++)for(;this.pdf.internal.getNumberOfPages()<at[pr];)k.call(this);if(O(at),this.autoPaging)for(var vt=at[0],yr=at[at.length-1],_r=vt;_r<yr+1;_r++){this.pdf.setPage(_r),this.fillStyle=Oe,this.strokeStyle=$e,this.lineCap=De,this.lineWidth=Ye,this.lineJoin=rt;var cr=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],Er=_r===1?this.posY+this.margin[0]:this.margin[0],wr=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],er=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],lr=_r===1?0:wr+(_r-2)*er;if(this.ctx.clip_path.length!==0){var Ar=this.path;xe=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=L(xe,this.posX+this.margin[3],-lr+Er+this.ctx.prevPageLastElemOffset),z.call(this,he,!0),this.path=Ar}if(Ne=JSON.parse(JSON.stringify(Ie)),this.path=L(Ne,this.posX+this.margin[3],-lr+Er+this.ctx.prevPageLastElemOffset),Ee===!1||_r===0){var ir=(_r>vt||_r<yr)&&E.call(this);ir&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],cr,er,null).clip().discardPath()),z.call(this,he,Ee),ir&&this.pdf.restoreGraphicsState()}this.lineWidth=it}else this.lineWidth=Ye,z.call(this,he,Ee),this.lineWidth=it;this.path=Ie},z=function(he,Ee){if((he!=="stroke"||Ee||!S.call(this))&&(he==="stroke"||Ee||!v.call(this))){for(var xe,Ne,Oe=[],$e=this.path,De=0;De<$e.length;De++){var it=$e[De];switch(it.type){case"begin":Oe.push({begin:!0});break;case"close":Oe.push({close:!0});break;case"mt":Oe.push({start:it,deltas:[],abs:[]});break;case"lt":var Ye=Oe.length;if($e[De-1]&&!isNaN($e[De-1].x)&&(xe=[it.x-$e[De-1].x,it.y-$e[De-1].y],Ye>0)){for(;Ye>=0;Ye--)if(Oe[Ye-1].close!==!0&&Oe[Ye-1].begin!==!0){Oe[Ye-1].deltas.push(xe),Oe[Ye-1].abs.push(it);break}}break;case"bct":xe=[it.x1-$e[De-1].x,it.y1-$e[De-1].y,it.x2-$e[De-1].x,it.y2-$e[De-1].y,it.x-$e[De-1].x,it.y-$e[De-1].y],Oe[Oe.length-1].deltas.push(xe);break;case"qct":var rt=$e[De-1].x+2/3*(it.x1-$e[De-1].x),Ie=$e[De-1].y+2/3*(it.y1-$e[De-1].y),Mt=it.x+2/3*(it.x1-it.x),at=it.y+2/3*(it.y1-it.y),je=it.x,Xt=it.y;xe=[rt-$e[De-1].x,Ie-$e[De-1].y,Mt-$e[De-1].x,at-$e[De-1].y,je-$e[De-1].x,Xt-$e[De-1].y],Oe[Oe.length-1].deltas.push(xe);break;case"arc":Oe.push({deltas:[],abs:[],arc:!0}),Array.isArray(Oe[Oe.length-1].abs)&&Oe[Oe.length-1].abs.push(it)}}Ne=Ee?null:he==="stroke"?"stroke":"fill";for(var Yt=!1,pr=0;pr<Oe.length;pr++)if(Oe[pr].arc)for(var vt=Oe[pr].abs,yr=0;yr<vt.length;yr++){var _r=vt[yr];_r.type==="arc"?W.call(this,_r.x,_r.y,_r.radius,_r.startAngle,_r.endAngle,_r.counterclockwise,void 0,Ee,!Yt):ne.call(this,_r.x,_r.y),Yt=!0}else if(Oe[pr].close===!0)this.pdf.internal.out("h"),Yt=!1;else if(Oe[pr].begin!==!0){var cr=Oe[pr].start.x,Er=Oe[pr].start.y;oe.call(this,Oe[pr].deltas,cr,Er),Yt=!0}Ne&&G.call(this,Ne),Ee&&ie.call(this)}},B=function(he){var Ee=this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor,xe=Ee*(this.pdf.internal.getLineHeightFactor()-1);switch(this.ctx.textBaseline){case"bottom":return he-xe;case"top":return he+Ee-xe;case"hanging":return he+Ee-2*xe;case"middle":return he+Ee/2-xe;default:return he}},q=function(he){return he+this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor*(this.pdf.internal.getLineHeightFactor()-1)};g.prototype.createLinearGradient=function(){var he=function(){};return he.colorStops=[],he.addColorStop=function(Ee,xe){this.colorStops.push([Ee,xe])},he.getColor=function(){return this.colorStops.length===0?"#000000":this.colorStops[0][1]},he.isCanvasGradient=!0,he},g.prototype.createPattern=function(){return this.createLinearGradient()},g.prototype.createRadialGradient=function(){return this.createLinearGradient()};var W=function(he,Ee,xe,Ne,Oe,$e,De,it,Ye){for(var rt=fe.call(this,xe,Ne,Oe,$e),Ie=0;Ie<rt.length;Ie++){var Mt=rt[Ie];Ie===0&&(Ye?Q.call(this,Mt.x1+he,Mt.y1+Ee):ne.call(this,Mt.x1+he,Mt.y1+Ee)),ce.call(this,he,Ee,Mt.x2,Mt.y2,Mt.x3,Mt.y3,Mt.x4,Mt.y4)}it?ie.call(this):G.call(this,De)},G=function(he){switch(he){case"stroke":this.pdf.internal.out("S");break;case"fill":this.pdf.internal.out("f")}},ie=function(){this.pdf.clip(),this.pdf.discardPath()},Q=function(he,Ee){this.pdf.internal.out(r(he)+" "+n(Ee)+" m")},H=function(he){var Ee;switch(he.align){case"right":case"end":Ee="right";break;case"center":Ee="center";break;default:Ee="left"}var xe=this.pdf.getTextDimensions(he.text),Ne=B.call(this,he.y),Oe=q.call(this,Ne)-xe.h,$e=this.ctx.transform.applyToPoint(new s(he.x,Ne)),De=this.ctx.transform.decompose(),it=new u;it=(it=(it=it.multiply(De.translate)).multiply(De.skew)).multiply(De.scale);for(var Ye,rt,Ie,Mt=this.ctx.transform.applyToRectangle(new o(he.x,Ne,xe.w,xe.h)),at=it.applyToRectangle(new o(he.x,Oe,xe.w,xe.h)),je=P.call(this,at),Xt=[],Yt=0;Yt<je.length;Yt+=1)Xt.indexOf(je[Yt])===-1&&Xt.push(je[Yt]);if(O(Xt),this.autoPaging)for(var pr=Xt[0],vt=Xt[Xt.length-1],yr=pr;yr<vt+1;yr++){this.pdf.setPage(yr);var _r=yr===1?this.posY+this.margin[0]:this.margin[0],cr=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],Er=this.pdf.internal.pageSize.height-this.margin[2],wr=Er-this.margin[0],er=this.pdf.internal.pageSize.width-this.margin[1],lr=er-this.margin[3],Ar=yr===1?0:cr+(yr-2)*wr;if(this.ctx.clip_path.length!==0){var ir=this.path;Ye=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=L(Ye,this.posX+this.margin[3],-1*Ar+_r),z.call(this,"fill",!0),this.path=ir}var nt=L([JSON.parse(JSON.stringify(at))],this.posX+this.margin[3],-Ar+_r+this.ctx.prevPageLastElemOffset)[0];he.scale>=.01&&(rt=this.pdf.internal.getFontSize(),this.pdf.setFontSize(rt*he.scale),Ie=this.lineWidth,this.lineWidth=Ie*he.scale);var _e=this.autoPaging!=="text";if(_e||nt.y+nt.h<=Er){if(_e||nt.y>=_r&&nt.x<=er){var be=_e?he.text:this.pdf.splitTextToSize(he.text,he.maxWidth||er-nt.x)[0],qe=L([JSON.parse(JSON.stringify(Mt))],this.posX+this.margin[3],-Ar+_r+this.ctx.prevPageLastElemOffset)[0],Qe=_e&&(yr>pr||yr<vt)&&E.call(this);Qe&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],lr,wr,null).clip().discardPath()),this.pdf.text(be,qe.x,qe.y,{angle:he.angle,align:Ee,renderingMode:he.renderingMode}),Qe&&this.pdf.restoreGraphicsState()}}else nt.y<Er&&(this.ctx.prevPageLastElemOffset+=Er-nt.y);he.scale>=.01&&(this.pdf.setFontSize(rt),this.lineWidth=Ie)}else he.scale>=.01&&(rt=this.pdf.internal.getFontSize(),this.pdf.setFontSize(rt*he.scale),Ie=this.lineWidth,this.lineWidth=Ie*he.scale),this.pdf.text(he.text,$e.x+this.posX,$e.y+this.posY,{angle:he.angle,align:Ee,renderingMode:he.renderingMode,maxWidth:he.maxWidth}),he.scale>=.01&&(this.pdf.setFontSize(rt),this.lineWidth=Ie)},ne=function(he,Ee,xe,Ne){xe=xe||0,Ne=Ne||0,this.pdf.internal.out(r(he+xe)+" "+n(Ee+Ne)+" l")},oe=function(he,Ee,xe){return this.pdf.lines(he,Ee,xe,null,null)},ce=function(he,Ee,xe,Ne,Oe,$e,De,it){this.pdf.internal.out([e(i(xe+he)),e(a(Ne+Ee)),e(i(Oe+he)),e(a($e+Ee)),e(i(De+he)),e(a(it+Ee)),"c"].join(" "))},fe=function(he,Ee,xe,Ne){for(var Oe=2*Math.PI,$e=Math.PI/2;Ee>xe;)Ee-=Oe;var De=Math.abs(xe-Ee);De<Oe&&Ne&&(De=Oe-De);for(var it=[],Ye=Ne?-1:1,rt=Ee;De>1e-5;){var Ie=rt+Ye*Math.min(De,$e);it.push(Me.call(this,he,rt,Ie)),De-=Math.abs(Ie-rt),rt=Ie}return it},Me=function(he,Ee,xe){var Ne=(xe-Ee)/2,Oe=he*Math.cos(Ne),$e=he*Math.sin(Ne),De=Oe,it=-$e,Ye=De*De+it*it,rt=Ye+De*Oe+it*$e,Ie=4/3*(Math.sqrt(2*Ye*rt)-rt)/(De*$e-it*Oe),Mt=De-Ie*it,at=it+Ie*De,je=Mt,Xt=-at,Yt=Ne+Ee,pr=Math.cos(Yt),vt=Math.sin(Yt);return{x1:he*Math.cos(Ee),y1:he*Math.sin(Ee),x2:Mt*pr-at*vt,y2:Mt*vt+at*pr,x3:je*pr-Xt*vt,y3:je*vt+Xt*pr,x4:he*Math.cos(xe),y4:he*Math.sin(xe)}},me=function(he){return 180*he/Math.PI},we=function(he,Ee,xe,Ne,Oe,$e){var De=he+.5*(xe-he),it=Ee+.5*(Ne-Ee),Ye=Oe+.5*(xe-Oe),rt=$e+.5*(Ne-$e),Ie=Math.min(he,Oe,De,Ye),Mt=Math.max(he,Oe,De,Ye),at=Math.min(Ee,$e,it,rt),je=Math.max(Ee,$e,it,rt);return new o(Ie,at,Mt-Ie,je-at)},Te=function(he,Ee,xe,Ne,Oe,$e,De,it){var Ye,rt,Ie,Mt,at,je,Xt,Yt,pr,vt,yr,_r,cr,Er,wr=xe-he,er=Ne-Ee,lr=Oe-xe,Ar=$e-Ne,ir=De-Oe,nt=it-$e;for(rt=0;rt<41;rt++)pr=(Xt=(Ie=he+(Ye=rt/40)*wr)+Ye*((at=xe+Ye*lr)-Ie))+Ye*(at+Ye*(Oe+Ye*ir-at)-Xt),vt=(Yt=(Mt=Ee+Ye*er)+Ye*((je=Ne+Ye*Ar)-Mt))+Ye*(je+Ye*($e+Ye*nt-je)-Yt),rt==0?(yr=pr,_r=vt,cr=pr,Er=vt):(yr=Math.min(yr,pr),_r=Math.min(_r,vt),cr=Math.max(cr,pr),Er=Math.max(Er,vt));return new o(Math.round(yr),Math.round(_r),Math.round(cr-yr),Math.round(Er-_r))},ke=function(){if(this.prevLineDash||this.ctx.lineDash.length||this.ctx.lineDashOffset){var he,Ee,xe=(he=this.ctx.lineDash,Ee=this.ctx.lineDashOffset,JSON.stringify({lineDash:he,lineDashOffset:Ee}));this.prevLineDash!==xe&&(this.pdf.setLineDash(this.ctx.lineDash,this.ctx.lineDashOffset),this.prevLineDash=xe)}}})(li.API),(function(t){var e=function(s){var o,u,h,f,g,b,v,S,E,P;for(u=[],h=0,f=(s+=o="\0\0\0\0".slice(s.length%4||4)).length;f>h;h+=4)(g=(s.charCodeAt(h)<<24)+(s.charCodeAt(h+1)<<16)+(s.charCodeAt(h+2)<<8)+s.charCodeAt(h+3))!==0?(b=(g=((g=((g=((g=(g-(P=g%85))/85)-(E=g%85))/85)-(S=g%85))/85)-(v=g%85))/85)%85,u.push(b+33,v+33,S+33,E+33,P+33)):u.push(122);return(function(k,L){for(var O=L;O>0;O--)k.pop()})(u,o.length),String.fromCharCode.apply(String,u)+"~>"},r=function(s){var o,u,h,f,g,b=String,v="length",S=255,E="charCodeAt",P="slice",k="replace";for(s[P](-2),s=s[P](0,-2)[k](/\s/g,"")[k]("z","!!!!!"),h=[],f=0,g=(s+=o="uuuuu"[P](s[v]%5||5))[v];g>f;f+=5)u=52200625*(s[E](f)-33)+614125*(s[E](f+1)-33)+7225*(s[E](f+2)-33)+85*(s[E](f+3)-33)+(s[E](f+4)-33),h.push(S&u>>24,S&u>>16,S&u>>8,S&u);return(function(L,O){for(var M=O;M>0;M--)L.pop()})(h,o[v]),b.fromCharCode.apply(b,h)},n=function(s){return s.split("").map(function(o){return("0"+o.charCodeAt().toString(16)).slice(-2)}).join("")+">"},i=function(s){var o=new RegExp(/^([0-9A-Fa-f]{2})+$/);if((s=s.replace(/\s/g,"")).indexOf(">")!==-1&&(s=s.substr(0,s.indexOf(">"))),s.length%2&&(s+="0"),o.test(s)===!1)return"";for(var u="",h=0;h<s.length;h+=2)u+=String.fromCharCode("0x"+(s[h]+s[h+1]));return u},a=function(s){for(var o=new Uint8Array(s.length),u=s.length;u--;)o[u]=s.charCodeAt(u);return(o=jP(o)).reduce(function(h,f){return h+String.fromCharCode(f)},"")};t.processDataByFilters=function(s,o){var u=0,h=s||"",f=[];for(typeof(o=o||[])=="string"&&(o=[o]),u=0;u<o.length;u+=1)switch(o[u]){case"ASCII85Decode":case"/ASCII85Decode":h=r(h),f.push("/ASCII85Encode");break;case"ASCII85Encode":case"/ASCII85Encode":h=e(h),f.push("/ASCII85Decode");break;case"ASCIIHexDecode":case"/ASCIIHexDecode":h=i(h),f.push("/ASCIIHexEncode");break;case"ASCIIHexEncode":case"/ASCIIHexEncode":h=n(h),f.push("/ASCIIHexDecode");break;case"FlateEncode":case"/FlateEncode":h=a(h),f.push("/FlateDecode");break;default:throw new Error('The filter: "'+o[u]+'" is not implemented')}return{data:h,reverseChain:f.reverse().join(" ")}}})(li.API),(function(t){t.loadFile=function(e,r,n){return(function(i,a,s){a=a!==!1,s=typeof s=="function"?s:function(){};var o=void 0;try{o=(function(u,h,f){var g=new XMLHttpRequest,b=0,v=function(S){var E=S.length,P=[],k=String.fromCharCode;for(b=0;b<E;b+=1)P.push(k(255&S.charCodeAt(b)));return P.join("")};if(g.open("GET",u,!h),g.overrideMimeType("text/plain; charset=x-user-defined"),h===!1&&(g.onload=function(){g.status===200?f(v(this.responseText)):f(void 0)}),g.send(null),h&&g.status===200)return v(g.responseText)})(i,a,s)}catch{}return o})(e,r,n)},t.loadImageFile=t.loadFile})(li.API),(function(t){function e(){return(Ri.html2canvas?Promise.resolve(Ri.html2canvas):XC(()=>import("./html2canvas.esm-B0tyYwQk.js"),[],import.meta.url)).catch(function(o){return Promise.reject(new Error("Could not load html2canvas: "+o))}).then(function(o){return o.default?o.default:o})}function r(){return(Ri.DOMPurify?Promise.resolve(Ri.DOMPurify):XC(()=>import("./purify.es-CQJ0hv7W.js"),[],import.meta.url)).catch(function(o){return Promise.reject(new Error("Could not load dompurify: "+o))}).then(function(o){return o.default?o.default:o})}var n=function(o){var u=ao(o);return u==="undefined"?"undefined":u==="string"||o instanceof String?"string":u==="number"||o instanceof Number?"number":u==="function"||o instanceof Function?"function":o&&o.constructor===Array?"array":o&&o.nodeType===1?"element":u==="object"?"object":"unknown"},i=function(o,u){var h=document.createElement(o);for(var f in u.className&&(h.className=u.className),u.innerHTML&&u.dompurify&&(h.innerHTML=u.dompurify.sanitize(u.innerHTML)),u.style)h.style[f]=u.style[f];return h},a=function o(u,h){for(var f=u.nodeType===3?document.createTextNode(u.nodeValue):u.cloneNode(!1),g=u.firstChild;g;g=g.nextSibling)h!==!0&&g.nodeType===1&&g.nodeName==="SCRIPT"||f.appendChild(o(g,h));return u.nodeType===1&&(u.nodeName==="CANVAS"?(f.width=u.width,f.height=u.height,f.getContext("2d").drawImage(u,0,0)):u.nodeName!=="TEXTAREA"&&u.nodeName!=="SELECT"||(f.value=u.value),f.addEventListener("load",function(){f.scrollTop=u.scrollTop,f.scrollLeft=u.scrollLeft},!0)),f},s=function o(u){var h=Object.assign(o.convert(Promise.resolve()),JSON.parse(JSON.stringify(o.template))),f=o.convert(Promise.resolve(),h);return(f=f.setProgress(1,o,1,[o])).set(u)};(s.prototype=Object.create(Promise.prototype)).constructor=s,s.convert=function(o,u){return o.__proto__=u||s.prototype,o},s.template={prop:{src:null,container:null,overlay:null,canvas:null,img:null,pdf:null,pageSize:null,callback:function(){}},progress:{val:0,state:null,n:0,stack:[]},opt:{filename:"file.pdf",margin:[0,0,0,0],enableLinks:!0,x:0,y:0,html2canvas:{},jsPDF:{},backgroundColor:"transparent"}},s.prototype.from=function(o,u){return this.then(function(){switch(u=u||(function(h){switch(n(h)){case"string":return"string";case"element":return h.nodeName.toLowerCase()==="canvas"?"canvas":"element";default:return"unknown"}})(o),u){case"string":return this.then(r).then(function(h){return this.set({src:i("div",{innerHTML:o,dompurify:h})})});case"element":return this.set({src:o});case"canvas":return this.set({canvas:o});case"img":return this.set({img:o});default:return this.error("Unknown source type.")}})},s.prototype.to=function(o){switch(o){case"container":return this.toContainer();case"canvas":return this.toCanvas();case"img":return this.toImg();case"pdf":return this.toPdf();default:return this.error("Invalid target.")}},s.prototype.toContainer=function(){return this.thenList([function(){return this.prop.src||this.error("Cannot duplicate - no source HTML.")},function(){return this.prop.pageSize||this.setPageSize()}]).then(function(){var o={position:"relative",display:"inline-block",width:(typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?Math.max(this.prop.src.clientWidth,this.prop.src.scrollWidth,this.prop.src.offsetWidth):this.opt.windowWidth)+"px",left:0,right:0,top:0,margin:"auto",backgroundColor:this.opt.backgroundColor},u=a(this.prop.src,this.opt.html2canvas.javascriptEnabled);u.tagName==="BODY"&&(o.height=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight)+"px"),this.prop.overlay=i("div",{className:"html2pdf__overlay",style:{position:"fixed",overflow:"hidden",zIndex:1e3,left:"-100000px",right:0,bottom:0,top:0}}),this.prop.container=i("div",{className:"html2pdf__container",style:o}),this.prop.container.appendChild(u),this.prop.container.firstChild.appendChild(i("div",{style:{clear:"both",border:"0 none transparent",margin:0,padding:0,height:0}})),this.prop.container.style.float="none",this.prop.overlay.appendChild(this.prop.container),document.body.appendChild(this.prop.overlay),this.prop.container.firstChild.style.position="relative",this.prop.container.height=Math.max(this.prop.container.firstChild.clientHeight,this.prop.container.firstChild.scrollHeight,this.prop.container.firstChild.offsetHeight)+"px"})},s.prototype.toCanvas=function(){var o=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(o).then(e).then(function(u){var h=Object.assign({},this.opt.html2canvas);return delete h.onrendered,u(this.prop.container,h)}).then(function(u){(this.opt.html2canvas.onrendered||function(){})(u),this.prop.canvas=u,document.body.removeChild(this.prop.overlay)})},s.prototype.toContext2d=function(){var o=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(o).then(e).then(function(u){var h=this.opt.jsPDF,f=this.opt.fontFaces,g=typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?1:this.opt.width/this.opt.windowWidth,b=Object.assign({async:!0,allowTaint:!0,scale:g,scrollX:this.opt.scrollX||0,scrollY:this.opt.scrollY||0,backgroundColor:"#ffffff",imageTimeout:15e3,logging:!0,proxy:null,removeContainer:!0,foreignObjectRendering:!1,useCORS:!1},this.opt.html2canvas);if(delete b.onrendered,h.context2d.autoPaging=this.opt.autoPaging===void 0||this.opt.autoPaging,h.context2d.posX=this.opt.x,h.context2d.posY=this.opt.y,h.context2d.margin=this.opt.margin,h.context2d.fontFaces=f,f)for(var v=0;v<f.length;++v){var S=f[v],E=S.src.find(function(P){return P.format==="truetype"});E&&h.addFont(E.url,S.ref.name,S.ref.style)}return b.windowHeight=b.windowHeight||0,b.windowHeight=b.windowHeight==0?Math.max(this.prop.container.clientHeight,this.prop.container.scrollHeight,this.prop.container.offsetHeight):b.windowHeight,h.context2d.save(!0),u(this.prop.container,b)}).then(function(u){this.opt.jsPDF.context2d.restore(!0),(this.opt.html2canvas.onrendered||function(){})(u),this.prop.canvas=u,document.body.removeChild(this.prop.overlay)})},s.prototype.toImg=function(){return this.thenList([function(){return this.prop.canvas||this.toCanvas()}]).then(function(){var o=this.prop.canvas.toDataURL("image/"+this.opt.image.type,this.opt.image.quality);this.prop.img=document.createElement("img"),this.prop.img.src=o})},s.prototype.toPdf=function(){return this.thenList([function(){return this.toContext2d()}]).then(function(){this.prop.pdf=this.prop.pdf||this.opt.jsPDF})},s.prototype.output=function(o,u,h){return(h=h||"pdf").toLowerCase()==="img"||h.toLowerCase()==="image"?this.outputImg(o,u):this.outputPdf(o,u)},s.prototype.outputPdf=function(o,u){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){return this.prop.pdf.output(o,u)})},s.prototype.outputImg=function(o){return this.thenList([function(){return this.prop.img||this.toImg()}]).then(function(){switch(o){case void 0:case"img":return this.prop.img;case"datauristring":case"dataurlstring":return this.prop.img.src;case"datauri":case"dataurl":return document.location.href=this.prop.img.src;default:throw'Image output type "'+o+'" is not supported.'}})},s.prototype.save=function(o){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).set(o?{filename:o}:null).then(function(){this.prop.pdf.save(this.opt.filename)})},s.prototype.doCallback=function(){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){this.prop.callback(this.prop.pdf)})},s.prototype.set=function(o){if(n(o)!=="object")return this;var u=Object.keys(o||{}).map(function(h){if(h in s.template.prop)return function(){this.prop[h]=o[h]};switch(h){case"margin":return this.setMargin.bind(this,o.margin);case"jsPDF":return function(){return this.opt.jsPDF=o.jsPDF,this.setPageSize()};case"pageSize":return this.setPageSize.bind(this,o.pageSize);default:return function(){this.opt[h]=o[h]}}},this);return this.then(function(){return this.thenList(u)})},s.prototype.get=function(o,u){return this.then(function(){var h=o in s.template.prop?this.prop[o]:this.opt[o];return u?u(h):h})},s.prototype.setMargin=function(o){return this.then(function(){switch(n(o)){case"number":o=[o,o,o,o];case"array":if(o.length===2&&(o=[o[0],o[1],o[0],o[1]]),o.length===4)break;default:return this.error("Invalid margin array.")}this.opt.margin=o}).then(this.setPageSize)},s.prototype.setPageSize=function(o){function u(h,f){return Math.floor(h*f/72*96)}return this.then(function(){(o=o||li.getPageSize(this.opt.jsPDF)).hasOwnProperty("inner")||(o.inner={width:o.width-this.opt.margin[1]-this.opt.margin[3],height:o.height-this.opt.margin[0]-this.opt.margin[2]},o.inner.px={width:u(o.inner.width,o.k),height:u(o.inner.height,o.k)},o.inner.ratio=o.inner.height/o.inner.width),this.prop.pageSize=o})},s.prototype.setProgress=function(o,u,h,f){return o!=null&&(this.progress.val=o),u!=null&&(this.progress.state=u),h!=null&&(this.progress.n=h),f!=null&&(this.progress.stack=f),this.progress.ratio=this.progress.val/this.progress.state,this},s.prototype.updateProgress=function(o,u,h,f){return this.setProgress(o?this.progress.val+o:null,u||null,h?this.progress.n+h:null,f?this.progress.stack.concat(f):null)},s.prototype.then=function(o,u){var h=this;return this.thenCore(o,u,function(f,g){return h.updateProgress(null,null,1,[f]),Promise.prototype.then.call(this,function(b){return h.updateProgress(null,f),b}).then(f,g).then(function(b){return h.updateProgress(1),b})})},s.prototype.thenCore=function(o,u,h){h=h||Promise.prototype.then;var f=this;o&&(o=o.bind(f)),u&&(u=u.bind(f));var g=Promise.toString().indexOf("[native code]")!==-1&&Promise.name==="Promise"?f:s.convert(Object.assign({},f),Promise.prototype),b=h.call(g,o,u);return s.convert(b,f.__proto__)},s.prototype.thenExternal=function(o,u){return Promise.prototype.then.call(this,o,u)},s.prototype.thenList=function(o){var u=this;return o.forEach(function(h){u=u.thenCore(h)}),u},s.prototype.catch=function(o){o&&(o=o.bind(this));var u=Promise.prototype.catch.call(this,o);return s.convert(u,this)},s.prototype.catchExternal=function(o){return Promise.prototype.catch.call(this,o)},s.prototype.error=function(o){return this.then(function(){throw new Error(o)})},s.prototype.using=s.prototype.set,s.prototype.saveAs=s.prototype.save,s.prototype.export=s.prototype.output,s.prototype.run=s.prototype.then,li.getPageSize=function(o,u,h){if(ao(o)==="object"){var f=o;o=f.orientation,u=f.unit||u,h=f.format||h}u=u||"mm",h=h||"a4",o=(""+(o||"P")).toLowerCase();var g,b=(""+h).toLowerCase(),v={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};switch(u){case"pt":g=1;break;case"mm":g=72/25.4;break;case"cm":g=72/2.54;break;case"in":g=72;break;case"px":g=.75;break;case"pc":case"em":g=12;break;case"ex":g=6;break;default:throw"Invalid unit: "+u}var S,E=0,P=0;if(v.hasOwnProperty(b))E=v[b][1]/g,P=v[b][0]/g;else try{E=h[1],P=h[0]}catch{throw new Error("Invalid format: "+h)}if(o==="p"||o==="portrait")o="p",P>E&&(S=P,P=E,E=S);else{if(o!=="l"&&o!=="landscape")throw"Invalid orientation: "+o;o="l",E>P&&(S=P,P=E,E=S)}return{width:P,height:E,unit:u,k:g,orientation:o}},t.html=function(o,u){(u=u||{}).callback=u.callback||function(){},u.html2canvas=u.html2canvas||{},u.html2canvas.canvas=u.html2canvas.canvas||this.canvas,u.jsPDF=u.jsPDF||this,u.fontFaces=u.fontFaces?u.fontFaces.map(O3):null;var h=new s(u);return u.worker?h:h.from(o).doCallback()}})(li.API),li.API.addJS=function(t){return EB=t,this.internal.events.subscribe("postPutResources",function(){s2=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/Names [(EmbeddedJS) "+(s2+1)+" 0 R]"),this.internal.out(">>"),this.internal.out("endobj"),SB=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /JavaScript"),this.internal.out("/JS ("+EB+")"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){s2!==void 0&&SB!==void 0&&this.internal.out("/Names <</JavaScript "+s2+" 0 R>>")}),this},(function(t){var e;t.events.push(["postPutResources",function(){var r=this,n=/^(\d+) 0 obj$/;if(this.outline.root.children.length>0)for(var i=r.outline.render().split(/\r\n/),a=0;a<i.length;a++){var s=i[a],o=n.exec(s);if(o!=null){var u=o[1];r.internal.newObjectDeferredBegin(u,!1)}r.internal.write(s)}if(this.outline.createNamedDestinations){var h=this.internal.pages.length,f=[];for(a=0;a<h;a++){var g=r.internal.newObject();f.push(g);var b=r.internal.getPageInfo(a+1);r.internal.write("<< /D["+b.objId+" 0 R /XYZ null null null]>> endobj")}var v=r.internal.newObject();for(r.internal.write("<< /Names [ "),a=0;a<f.length;a++)r.internal.write("(page_"+(a+1)+")"+f[a]+" 0 R");r.internal.write(" ] >>","endobj"),e=r.internal.newObject(),r.internal.write("<< /Dests "+v+" 0 R"),r.internal.write(">>","endobj")}}]),t.events.push(["putCatalog",function(){var r=this;r.outline.root.children.length>0&&(r.internal.write("/Outlines",this.outline.makeRef(this.outline.root)),this.outline.createNamedDestinations&&r.internal.write("/Names "+e+" 0 R"))}]),t.events.push(["initialized",function(){var r=this;r.outline={createNamedDestinations:!1,root:{children:[]}},r.outline.add=function(n,i,a){var s={title:i,options:a,children:[]};return n==null&&(n=this.root),n.children.push(s),s},r.outline.render=function(){return this.ctx={},this.ctx.val="",this.ctx.pdf=r,this.genIds_r(this.root),this.renderRoot(this.root),this.renderItems(this.root),this.ctx.val},r.outline.genIds_r=function(n){n.id=r.internal.newObjectDeferred();for(var i=0;i<n.children.length;i++)this.genIds_r(n.children[i])},r.outline.renderRoot=function(n){this.objStart(n),this.line("/Type /Outlines"),n.children.length>0&&(this.line("/First "+this.makeRef(n.children[0])),this.line("/Last "+this.makeRef(n.children[n.children.length-1]))),this.line("/Count "+this.count_r({count:0},n)),this.objEnd()},r.outline.renderItems=function(n){for(var i=this.ctx.pdf.internal.getVerticalCoordinateString,a=0;a<n.children.length;a++){var s=n.children[a];this.objStart(s),this.line("/Title "+this.makeString(s.title)),this.line("/Parent "+this.makeRef(n)),a>0&&this.line("/Prev "+this.makeRef(n.children[a-1])),a<n.children.length-1&&this.line("/Next "+this.makeRef(n.children[a+1])),s.children.length>0&&(this.line("/First "+this.makeRef(s.children[0])),this.line("/Last "+this.makeRef(s.children[s.children.length-1])));var o=this.count=this.count_r({count:0},s);if(o>0&&this.line("/Count "+o),s.options&&s.options.pageNumber){var u=r.internal.getPageInfo(s.options.pageNumber);this.line("/Dest ["+u.objId+" 0 R /XYZ 0 "+i(0)+" 0]")}this.objEnd()}for(var h=0;h<n.children.length;h++)this.renderItems(n.children[h])},r.outline.line=function(n){this.ctx.val+=n+`\r
`},r.outline.makeRef=function(n){return n.id+" 0 R"},r.outline.makeString=function(n){return"("+r.internal.pdfEscape(n)+")"},r.outline.objStart=function(n){this.ctx.val+=`\r
`+n.id+` 0 obj\r
<<\r
`},r.outline.objEnd=function(){this.ctx.val+=`>> \r
endobj\r
`},r.outline.count_r=function(n,i){for(var a=0;a<i.children.length;a++)n.count++,this.count_r(n,i.children[a]);return n.count}}])})(li.API),(function(t){var e=[192,193,194,195,196,197,198,199];t.processJPEG=function(r,n,i,a,s,o){var u,h=this.decode.DCT_DECODE,f=null;if(typeof r=="string"||this.__addimage__.isArrayBuffer(r)||this.__addimage__.isArrayBufferView(r)){switch(r=s||r,r=this.__addimage__.isArrayBuffer(r)?new Uint8Array(r):r,u=(function(g){for(var b,v=256*g.charCodeAt(4)+g.charCodeAt(5),S=g.length,E={width:0,height:0,numcomponents:1},P=4;P<S;P+=2){if(P+=v,e.indexOf(g.charCodeAt(P+1))!==-1){b=256*g.charCodeAt(P+5)+g.charCodeAt(P+6),E={width:256*g.charCodeAt(P+7)+g.charCodeAt(P+8),height:b,numcomponents:g.charCodeAt(P+9)};break}v=256*g.charCodeAt(P+2)+g.charCodeAt(P+3)}return E})(r=this.__addimage__.isArrayBufferView(r)?this.__addimage__.arrayBufferToBinaryString(r):r),u.numcomponents){case 1:o=this.color_spaces.DEVICE_GRAY;break;case 4:o=this.color_spaces.DEVICE_CMYK;break;case 3:o=this.color_spaces.DEVICE_RGB}f={data:r,width:u.width,height:u.height,colorSpace:o,bitsPerComponent:8,filter:h,index:n,alias:i}}return f}})(li.API),li.API.processPNG=function(t,e,r,n){if(this.__addimage__.isArrayBuffer(t)&&(t=new Uint8Array(t)),this.__addimage__.isArrayBufferView(t)){var i,a=Vye(t,{checkCrc:!0}),s=a.width,o=a.height,u=a.channels,h=a.palette,f=a.depth;i=h&&u===1?(function(q){for(var W=q.width,G=q.height,ie=q.data,Q=q.palette,H=q.depth,ne=!1,oe=[],ce=[],fe=void 0,Me=!1,me=0,we=0;we<Q.length;we++){var Te=I8(Q[we],4),ke=Te[0],he=Te[1],Ee=Te[2],xe=Te[3];oe.push(ke,he,Ee),xe!=null&&(xe===0?(me++,ce.length<1&&ce.push(we)):xe<255&&(Me=!0))}if(Me||me>1){ne=!0,ce=void 0;var Ne=W*G;fe=new Uint8Array(Ne);for(var Oe=new DataView(ie.buffer),$e=0;$e<Ne;$e++){var De=N3(Oe,$e,H),it=I8(Q[De],4)[3];fe[$e]=it}}return{colorSpace:"Indexed",colorsPerPixel:1,colorBytes:ie,alphaBytes:fe,needSMask:ne,palette:oe,mask:ce}})(a):u===2||u===4?(function(q){for(var W=q.data,G=q.width,ie=q.height,Q=q.channels,H=q.depth,ne=Q===2?"DeviceGray":"DeviceRGB",oe=Q-1,ce=G*ie,fe=oe,Me=ce*fe,me=1*ce,we=Math.ceil(Me*H/8),Te=Math.ceil(me*H/8),ke=new Uint8Array(we),he=new Uint8Array(Te),Ee=new DataView(W.buffer),xe=new DataView(ke.buffer),Ne=new DataView(he.buffer),Oe=!1,$e=0;$e<ce;$e++){for(var De=$e*Q,it=0;it<fe;it++)OB(xe,N3(Ee,De+it,H),$e*fe+it,H);var Ye=N3(Ee,De+fe,H);Ye<(1<<H)-1&&(Oe=!0),OB(Ne,Ye,1*$e,H)}return{colorSpace:ne,colorsPerPixel:oe,colorBytes:ke,alphaBytes:he,needSMask:Oe}})(a):(function(q){var W=q.data,G=q.channels===1?"DeviceGray":"DeviceRGB";return{colorSpace:G,colorsPerPixel:G==="DeviceGray"?1:3,colorBytes:W instanceof Uint8Array?W:new Uint8Array(W.buffer),needSMask:!1}})(a);var g,b,v,S=i,E=S.colorSpace,P=S.colorsPerPixel,k=S.colorBytes,L=S.alphaBytes,O=S.needSMask,M=S.palette,z=S.mask,B=null;return n!==li.API.image_compression.NONE&&typeof jP=="function"?(B=(function(q){var W;switch(q){case li.API.image_compression.FAST:W=11;break;case li.API.image_compression.MEDIUM:W=13;break;case li.API.image_compression.SLOW:W=14;break;default:W=12}return W})(n),g=this.decode.FLATE_DECODE,b="/Predictor ".concat(B," "),t=IB(k,s*P,P,n),O&&(v=IB(L,s,1,n))):(g=void 0,b="",t=k,O&&(v=L)),b+="/Colors ".concat(P," /BitsPerComponent ").concat(f," /Columns ").concat(s),(this.__addimage__.isArrayBuffer(t)||this.__addimage__.isArrayBufferView(t))&&(t=this.__addimage__.arrayBufferToBinaryString(t)),(v&&this.__addimage__.isArrayBuffer(v)||this.__addimage__.isArrayBufferView(v))&&(v=this.__addimage__.arrayBufferToBinaryString(v)),{alias:r,data:t,index:e,filter:g,decodeParameters:b,transparency:z,palette:M,sMask:v,predictor:B,width:s,height:o,bitsPerComponent:f,colorSpace:E}}},(function(t){t.processGIF89A=function(e,r,n,i){var a=new uve(e),s=a.width,o=a.height,u=[];a.decodeAndBlitFrameRGBA(0,u);var h={data:u,width:s,height:o},f=new D3(100).encode(h,100);return t.processJPEG.call(this,f,r,n,i)},t.processGIF87A=t.processGIF89A})(li.API),Gh.prototype.parseHeader=function(){if(this.fileSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.reserved=this.datav.getUint32(this.pos,!0),this.pos+=4,this.offset=this.datav.getUint32(this.pos,!0),this.pos+=4,this.headerSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.width=this.datav.getUint32(this.pos,!0),this.pos+=4,this.height=this.datav.getInt32(this.pos,!0),this.pos+=4,this.planes=this.datav.getUint16(this.pos,!0),this.pos+=2,this.bitPP=this.datav.getUint16(this.pos,!0),this.pos+=2,this.compress=this.datav.getUint32(this.pos,!0),this.pos+=4,this.rawSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.hr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.vr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.colors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.importantColors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.bitPP===16&&this.is_with_alpha&&(this.bitPP=15),this.bitPP<15){var t=this.colors===0?1<<this.bitPP:this.colors;this.palette=new Array(t);for(var e=0;e<t;e++){var r=this.datav.getUint8(this.pos++,!0),n=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0);this.palette[e]={red:i,green:n,blue:r,quad:a}}}this.height<0&&(this.height*=-1,this.bottom_up=!1)},Gh.prototype.parseBGR=function(){this.pos=this.offset;try{var t="bit"+this.bitPP,e=this.width*this.height*4;this.data=new Uint8Array(e),this[t]()}catch(r){Eo.log("bit decode error:"+r)}},Gh.prototype.bit1=function(){var t,e=Math.ceil(this.width/8),r=e%4;for(t=this.height-1;t>=0;t--){for(var n=this.bottom_up?t:this.height-1-t,i=0;i<e;i++)for(var a=this.datav.getUint8(this.pos++,!0),s=n*this.width*4+8*i*4,o=0;o<8&&8*i+o<this.width;o++){var u=this.palette[a>>7-o&1];this.data[s+4*o]=u.blue,this.data[s+4*o+1]=u.green,this.data[s+4*o+2]=u.red,this.data[s+4*o+3]=255}r!==0&&(this.pos+=4-r)}},Gh.prototype.bit4=function(){for(var t=Math.ceil(this.width/2),e=t%4,r=this.height-1;r>=0;r--){for(var n=this.bottom_up?r:this.height-1-r,i=0;i<t;i++){var a=this.datav.getUint8(this.pos++,!0),s=n*this.width*4+2*i*4,o=a>>4,u=15&a,h=this.palette[o];if(this.data[s]=h.blue,this.data[s+1]=h.green,this.data[s+2]=h.red,this.data[s+3]=255,2*i+1>=this.width)break;h=this.palette[u],this.data[s+4]=h.blue,this.data[s+4+1]=h.green,this.data[s+4+2]=h.red,this.data[s+4+3]=255}e!==0&&(this.pos+=4-e)}},Gh.prototype.bit8=function(){for(var t=this.width%4,e=this.height-1;e>=0;e--){for(var r=this.bottom_up?e:this.height-1-e,n=0;n<this.width;n++){var i=this.datav.getUint8(this.pos++,!0),a=r*this.width*4+4*n;if(i<this.palette.length){var s=this.palette[i];this.data[a]=s.red,this.data[a+1]=s.green,this.data[a+2]=s.blue,this.data[a+3]=255}else this.data[a]=255,this.data[a+1]=255,this.data[a+2]=255,this.data[a+3]=255}t!==0&&(this.pos+=4-t)}},Gh.prototype.bit15=function(){for(var t=this.width%3,e=parseInt("11111",2),r=this.height-1;r>=0;r--){for(var n=this.bottom_up?r:this.height-1-r,i=0;i<this.width;i++){var a=this.datav.getUint16(this.pos,!0);this.pos+=2;var s=(a&e)/e*255|0,o=(a>>5&e)/e*255|0,u=(a>>10&e)/e*255|0,h=a>>15?255:0,f=n*this.width*4+4*i;this.data[f]=u,this.data[f+1]=o,this.data[f+2]=s,this.data[f+3]=h}this.pos+=t}},Gh.prototype.bit16=function(){for(var t=this.width%3,e=parseInt("11111",2),r=parseInt("111111",2),n=this.height-1;n>=0;n--){for(var i=this.bottom_up?n:this.height-1-n,a=0;a<this.width;a++){var s=this.datav.getUint16(this.pos,!0);this.pos+=2;var o=(s&e)/e*255|0,u=(s>>5&r)/r*255|0,h=(s>>11)/e*255|0,f=i*this.width*4+4*a;this.data[f]=h,this.data[f+1]=u,this.data[f+2]=o,this.data[f+3]=255}this.pos+=t}},Gh.prototype.bit24=function(){for(var t=this.height-1;t>=0;t--){for(var e=this.bottom_up?t:this.height-1-t,r=0;r<this.width;r++){var n=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),s=e*this.width*4+4*r;this.data[s]=a,this.data[s+1]=i,this.data[s+2]=n,this.data[s+3]=255}this.pos+=this.width%4}},Gh.prototype.bit32=function(){for(var t=this.height-1;t>=0;t--)for(var e=this.bottom_up?t:this.height-1-t,r=0;r<this.width;r++){var n=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),o=e*this.width*4+4*r;this.data[o]=a,this.data[o+1]=i,this.data[o+2]=n,this.data[o+3]=s}},Gh.prototype.getData=function(){return this.data},(function(t){t.processBMP=function(e,r,n,i){var a=new Gh(e,!1),s=a.width,o=a.height,u={data:a.getData(),width:s,height:o},h=new D3(100).encode(u,100);return t.processJPEG.call(this,h,r,n,i)}})(li.API),NB.prototype.getData=function(){return this.data},(function(t){t.processWEBP=function(e,r,n,i){var a=new NB(e),s=a.width,o=a.height,u={data:a.getData(),width:s,height:o},h=new D3(100).encode(u,100);return t.processJPEG.call(this,h,r,n,i)}})(li.API),li.API.processRGBA=function(t,e,r){for(var n=t.data,i=n.length,a=new Uint8Array(i/4*3),s=new Uint8Array(i/4),o=0,u=0,h=0;h<i;h+=4){var f=n[h],g=n[h+1],b=n[h+2],v=n[h+3];a[o++]=f,a[o++]=g,a[o++]=b,s[u++]=v}var S=this.__addimage__.arrayBufferToBinaryString(a);return{alpha:this.__addimage__.arrayBufferToBinaryString(s),data:S,index:e,alias:r,colorSpace:"DeviceRGB",bitsPerComponent:8,width:t.width,height:t.height}},li.API.setLanguage=function(t){return this.internal.languageSettings===void 0&&(this.internal.languageSettings={},this.internal.languageSettings.isSubscribed=!1),{af:"Afrikaans",sq:"Albanian",ar:"Arabic (Standard)","ar-DZ":"Arabic (Algeria)","ar-BH":"Arabic (Bahrain)","ar-EG":"Arabic (Egypt)","ar-IQ":"Arabic (Iraq)","ar-JO":"Arabic (Jordan)","ar-KW":"Arabic (Kuwait)","ar-LB":"Arabic (Lebanon)","ar-LY":"Arabic (Libya)","ar-MA":"Arabic (Morocco)","ar-OM":"Arabic (Oman)","ar-QA":"Arabic (Qatar)","ar-SA":"Arabic (Saudi Arabia)","ar-SY":"Arabic (Syria)","ar-TN":"Arabic (Tunisia)","ar-AE":"Arabic (U.A.E.)","ar-YE":"Arabic (Yemen)",an:"Aragonese",hy:"Armenian",as:"Assamese",ast:"Asturian",az:"Azerbaijani",eu:"Basque",be:"Belarusian",bn:"Bengali",bs:"Bosnian",br:"Breton",bg:"Bulgarian",my:"Burmese",ca:"Catalan",ch:"Chamorro",ce:"Chechen",zh:"Chinese","zh-HK":"Chinese (Hong Kong)","zh-CN":"Chinese (PRC)","zh-SG":"Chinese (Singapore)","zh-TW":"Chinese (Taiwan)",cv:"Chuvash",co:"Corsican",cr:"Cree",hr:"Croatian",cs:"Czech",da:"Danish",nl:"Dutch (Standard)","nl-BE":"Dutch (Belgian)",en:"English","en-AU":"English (Australia)","en-BZ":"English (Belize)","en-CA":"English (Canada)","en-IE":"English (Ireland)","en-JM":"English (Jamaica)","en-NZ":"English (New Zealand)","en-PH":"English (Philippines)","en-ZA":"English (South Africa)","en-TT":"English (Trinidad & Tobago)","en-GB":"English (United Kingdom)","en-US":"English (United States)","en-ZW":"English (Zimbabwe)",eo:"Esperanto",et:"Estonian",fo:"Faeroese",fj:"Fijian",fi:"Finnish",fr:"French (Standard)","fr-BE":"French (Belgium)","fr-CA":"French (Canada)","fr-FR":"French (France)","fr-LU":"French (Luxembourg)","fr-MC":"French (Monaco)","fr-CH":"French (Switzerland)",fy:"Frisian",fur:"Friulian",gd:"Gaelic (Scots)","gd-IE":"Gaelic (Irish)",gl:"Galacian",ka:"Georgian",de:"German (Standard)","de-AT":"German (Austria)","de-DE":"German (Germany)","de-LI":"German (Liechtenstein)","de-LU":"German (Luxembourg)","de-CH":"German (Switzerland)",el:"Greek",gu:"Gujurati",ht:"Haitian",he:"Hebrew",hi:"Hindi",hu:"Hungarian",is:"Icelandic",id:"Indonesian",iu:"Inuktitut",ga:"Irish",it:"Italian (Standard)","it-CH":"Italian (Switzerland)",ja:"Japanese",kn:"Kannada",ks:"Kashmiri",kk:"Kazakh",km:"Khmer",ky:"Kirghiz",tlh:"Klingon",ko:"Korean","ko-KP":"Korean (North Korea)","ko-KR":"Korean (South Korea)",la:"Latin",lv:"Latvian",lt:"Lithuanian",lb:"Luxembourgish",mk:"North Macedonia",ms:"Malay",ml:"Malayalam",mt:"Maltese",mi:"Maori",mr:"Marathi",mo:"Moldavian",nv:"Navajo",ng:"Ndonga",ne:"Nepali",no:"Norwegian",nb:"Norwegian (Bokmal)",nn:"Norwegian (Nynorsk)",oc:"Occitan",or:"Oriya",om:"Oromo",fa:"Persian","fa-IR":"Persian/Iran",pl:"Polish",pt:"Portuguese","pt-BR":"Portuguese (Brazil)",pa:"Punjabi","pa-IN":"Punjabi (India)","pa-PK":"Punjabi (Pakistan)",qu:"Quechua",rm:"Rhaeto-Romanic",ro:"Romanian","ro-MO":"Romanian (Moldavia)",ru:"Russian","ru-MO":"Russian (Moldavia)",sz:"Sami (Lappish)",sg:"Sango",sa:"Sanskrit",sc:"Sardinian",sd:"Sindhi",si:"Singhalese",sr:"Serbian",sk:"Slovak",sl:"Slovenian",so:"Somani",sb:"Sorbian",es:"Spanish","es-AR":"Spanish (Argentina)","es-BO":"Spanish (Bolivia)","es-CL":"Spanish (Chile)","es-CO":"Spanish (Colombia)","es-CR":"Spanish (Costa Rica)","es-DO":"Spanish (Dominican Republic)","es-EC":"Spanish (Ecuador)","es-SV":"Spanish (El Salvador)","es-GT":"Spanish (Guatemala)","es-HN":"Spanish (Honduras)","es-MX":"Spanish (Mexico)","es-NI":"Spanish (Nicaragua)","es-PA":"Spanish (Panama)","es-PY":"Spanish (Paraguay)","es-PE":"Spanish (Peru)","es-PR":"Spanish (Puerto Rico)","es-ES":"Spanish (Spain)","es-UY":"Spanish (Uruguay)","es-VE":"Spanish (Venezuela)",sx:"Sutu",sw:"Swahili",sv:"Swedish","sv-FI":"Swedish (Finland)","sv-SV":"Swedish (Sweden)",ta:"Tamil",tt:"Tatar",te:"Teluga",th:"Thai",tig:"Tigre",ts:"Tsonga",tn:"Tswana",tr:"Turkish",tk:"Turkmen",uk:"Ukrainian",hsb:"Upper Sorbian",ur:"Urdu",ve:"Venda",vi:"Vietnamese",vo:"Volapuk",wa:"Walloon",cy:"Welsh",xh:"Xhosa",ji:"Yiddish",zu:"Zulu"}[t]!==void 0&&(this.internal.languageSettings.languageCode=t,this.internal.languageSettings.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){this.internal.write("/Lang ("+this.internal.languageSettings.languageCode+")")}),this.internal.languageSettings.isSubscribed=!0)),this},Oy=li.API,l2=Oy.getCharWidthsArray=function(t,e){var r,n,i=(e=e||{}).font||this.internal.getFont(),a=e.fontSize||this.internal.getFontSize(),s=e.charSpace||this.internal.getCharSpace(),o=e.widths?e.widths:i.metadata.Unicode.widths,u=o.fof?o.fof:1,h=e.kerning?e.kerning:i.metadata.Unicode.kerning,f=h.fof?h.fof:1,g=e.doKerning!==!1,b=0,v=t.length,S=0,E=o[0]||u,P=[];for(r=0;r<v;r++)n=t.charCodeAt(r),typeof i.metadata.widthOfString=="function"?P.push((i.metadata.widthOfGlyph(i.metadata.characterToGlyph(n))+s*(1e3/a)||0)/1e3):(b=g&&ao(h[n])==="object"&&!isNaN(parseInt(h[n][S],10))?h[n][S]/f:0,P.push((o[n]||E)/u+b)),S=n;return P},TB=Oy.getStringUnitWidth=function(t,e){var r=(e=e||{}).fontSize||this.internal.getFontSize(),n=e.font||this.internal.getFont(),i=e.charSpace||this.internal.getCharSpace();return Oy.processArabic&&(t=Oy.processArabic(t)),typeof n.metadata.widthOfString=="function"?n.metadata.widthOfString(t,r,i)/r:l2.apply(this,arguments).reduce(function(a,s){return a+s},0)},CB=function(t,e,r,n){for(var i=[],a=0,s=t.length,o=0;a!==s&&o+e[a]<r;)o+=e[a],a++;i.push(t.slice(0,a));var u=a;for(o=0;a!==s;)o+e[a]>n&&(i.push(t.slice(u,a)),o=0,u=a),o+=e[a],a++;return u!==a&&i.push(t.slice(u,a)),i},AB=function(t,e,r){r||(r={});var n,i,a,s,o,u,h,f=[],g=[f],b=r.textIndent||0,v=0,S=0,E=t.split(" "),P=l2.apply(this,[" ",r])[0];if(u=r.lineIndent===-1?E[0].length+2:r.lineIndent||0){var k=Array(u).join(" "),L=[];E.map(function(M){(M=M.split(/\s*\n/)).length>1?L=L.concat(M.map(function(z,B){return(B&&z.length?`
`:"")+z})):L.push(M[0])}),E=L,u=TB.apply(this,[k,r])}for(a=0,s=E.length;a<s;a++){var O=0;if(n=E[a],u&&n[0]==`
`&&(n=n.substr(1),O=1),b+v+(S=(i=l2.apply(this,[n,r])).reduce(function(M,z){return M+z},0))>e||O){if(S>e){for(o=CB.apply(this,[n,i,e-(b+v),e]),f.push(o.shift()),f=[o.pop()];o.length;)g.push([o.shift()]);S=i.slice(n.length-(f[0]?f[0].length:0)).reduce(function(M,z){return M+z},0)}else f=[n];g.push(f),b=S+u,v=P}else f.push(n),b+=v+S,v=P}return h=u?function(M,z){return(z?k:"")+M.join(" ")}:function(M){return M.join(" ")},g.map(h)},Oy.splitTextToSize=function(t,e,r){var n,i=(r=r||{}).fontSize||this.internal.getFontSize(),a=(function(f){if(f.widths&&f.kerning)return{widths:f.widths,kerning:f.kerning};var g=this.internal.getFont(f.fontName,f.fontStyle),b="Unicode";return g.metadata[b]?{widths:g.metadata[b].widths||{0:1},kerning:g.metadata[b].kerning||{}}:{font:g.metadata,fontSize:this.internal.getFontSize(),charSpace:this.internal.getCharSpace()}}).call(this,r);n=Array.isArray(t)?t:String(t).split(/\r?\n/);var s=1*this.internal.scaleFactor*e/i;a.textIndent=r.textIndent?1*r.textIndent*this.internal.scaleFactor/i:0,a.lineIndent=r.lineIndent;var o,u,h=[];for(o=0,u=n.length;o<u;o++)h=h.concat(AB.apply(this,[n[o],s,a]));return h},(function(t){t.__fontmetrics__=t.__fontmetrics__||{};for(var e="0123456789abcdef",r="klmnopqrstuvwxyz",n={},i={},a=0;a<16;a++)n[r[a]]=e[a],i[e[a]]=r[a];var s=function(b){return"0x"+parseInt(b,10).toString(16)},o=t.__fontmetrics__.compress=function(b){var v,S,E,P,k=["{"];for(var L in b){if(v=b[L],isNaN(parseInt(L,10))?S="'"+L+"'":(L=parseInt(L,10),S=(S=s(L).slice(2)).slice(0,-1)+i[S.slice(-1)]),typeof v=="number")v<0?(E=s(v).slice(3),P="-"):(E=s(v).slice(2),P=""),E=P+E.slice(0,-1)+i[E.slice(-1)];else{if(ao(v)!=="object")throw new Error("Don't know what to do with value type "+ao(v)+".");E=o(v)}k.push(S+E)}return k.push("}"),k.join("")},u=t.__fontmetrics__.uncompress=function(b){if(typeof b!="string")throw new Error("Invalid argument passed to uncompress.");for(var v,S,E,P,k={},L=1,O=k,M=[],z="",B="",q=b.length-1,W=1;W<q;W+=1)(P=b[W])=="'"?v?(E=v.join(""),v=void 0):v=[]:v?v.push(P):P=="{"?(M.push([O,E]),O={},E=void 0):P=="}"?((S=M.pop())[0][S[1]]=O,E=void 0,O=S[0]):P=="-"?L=-1:E===void 0?n.hasOwnProperty(P)?(z+=n[P],E=parseInt(z,16)*L,L=1,z=""):z+=P:n.hasOwnProperty(P)?(B+=n[P],O[E]=parseInt(B,16)*L,L=1,E=void 0,B=""):B+=P;return k},h={codePages:["WinAnsiEncoding"],WinAnsiEncoding:u("{19m8n201n9q201o9r201s9l201t9m201u8m201w9n201x9o201y8o202k8q202l8r202m9p202q8p20aw8k203k8t203t8v203u9v2cq8s212m9t15m8w15n9w2dw9s16k8u16l9u17s9z17x8y17y9y}")},f={Unicode:{Courier:h,"Courier-Bold":h,"Courier-BoldOblique":h,"Courier-Oblique":h,Helvetica:h,"Helvetica-Bold":h,"Helvetica-BoldOblique":h,"Helvetica-Oblique":h,"Times-Roman":h,"Times-Bold":h,"Times-BoldItalic":h,"Times-Italic":h}},g={Unicode:{"Courier-Oblique":u("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-BoldItalic":u("{'widths'{k3o2q4ycx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2r202m2n2n3m2o3m2p5n202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5n4l4m4m4m4n4m4o4s4p4m4q4m4r4s4s4y4t2r4u3m4v4m4w3x4x5t4y4s4z4s5k3x5l4s5m4m5n3r5o3x5p4s5q4m5r5t5s4m5t3x5u3x5v2l5w1w5x2l5y3t5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q2l6r3m6s3r6t1w6u1w6v3m6w1w6x4y6y3r6z3m7k3m7l3m7m2r7n2r7o1w7p3r7q2w7r4m7s3m7t2w7u2r7v2n7w1q7x2n7y3t202l3mcl4mal2ram3man3mao3map3mar3mas2lat4uau1uav3maw3way4uaz2lbk2sbl3t'fof'6obo2lbp3tbq3mbr1tbs2lbu1ybv3mbz3mck4m202k3mcm4mcn4mco4mcp4mcq5ycr4mcs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz2w203k6o212m6o2dw2l2cq2l3t3m3u2l17s3x19m3m}'kerning'{cl{4qu5kt5qt5rs17ss5ts}201s{201ss}201t{cks4lscmscnscoscpscls2wu2yu201ts}201x{2wu2yu}2k{201ts}2w{4qx5kx5ou5qx5rs17su5tu}2x{17su5tu5ou}2y{4qx5kx5ou5qx5rs17ss5ts}'fof'-6ofn{17sw5tw5ou5qw5rs}7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qs}3v{17su5tu5os5qs}7p{17su5tu}ck{4qu5kt5qt5rs17ss5ts}4l{4qu5kt5qt5rs17ss5ts}cm{4qu5kt5qt5rs17ss5ts}cn{4qu5kt5qt5rs17ss5ts}co{4qu5kt5qt5rs17ss5ts}cp{4qu5kt5qt5rs17ss5ts}6l{4qu5ou5qw5rt17su5tu}5q{ckuclucmucnucoucpu4lu}5r{ckuclucmucnucoucpu4lu}7q{cksclscmscnscoscps4ls}6p{4qu5ou5qw5rt17sw5tw}ek{4qu5ou5qw5rt17su5tu}el{4qu5ou5qw5rt17su5tu}em{4qu5ou5qw5rt17su5tu}en{4qu5ou5qw5rt17su5tu}eo{4qu5ou5qw5rt17su5tu}ep{4qu5ou5qw5rt17su5tu}es{17ss5ts5qs4qu}et{4qu5ou5qw5rt17sw5tw}eu{4qu5ou5qw5rt17ss5ts}ev{17ss5ts5qs4qu}6z{17sw5tw5ou5qw5rs}fm{17sw5tw5ou5qw5rs}7n{201ts}fo{17sw5tw5ou5qw5rs}fp{17sw5tw5ou5qw5rs}fq{17sw5tw5ou5qw5rs}7r{cksclscmscnscoscps4ls}fs{17sw5tw5ou5qw5rs}ft{17su5tu}fu{17su5tu}fv{17su5tu}fw{17su5tu}fz{cksclscmscnscoscps4ls}}}"),"Helvetica-Bold":u("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),Courier:u("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-BoldOblique":u("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Bold":u("{'widths'{k3q2q5ncx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2l202m2n2n3m2o3m2p6o202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5x4l4s4m4m4n4s4o4s4p4m4q3x4r4y4s4y4t2r4u3m4v4y4w4m4x5y4y4s4z4y5k3x5l4y5m4s5n3r5o4m5p4s5q4s5r6o5s4s5t4s5u4m5v2l5w1w5x2l5y3u5z3m6k2l6l3m6m3r6n2w6o3r6p2w6q2l6r3m6s3r6t1w6u2l6v3r6w1w6x5n6y3r6z3m7k3r7l3r7m2w7n2r7o2l7p3r7q3m7r4s7s3m7t3m7u2w7v2r7w1q7x2r7y3o202l3mcl4sal2lam3man3mao3map3mar3mas2lat4uau1yav3maw3tay4uaz2lbk2sbl3t'fof'6obo2lbp3rbr1tbs2lbu2lbv3mbz3mck4s202k3mcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3rek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3m3u2l17s4s19m3m}'kerning'{cl{4qt5ks5ot5qy5rw17sv5tv}201t{cks4lscmscnscoscpscls4wv}2k{201ts}2w{4qu5ku7mu5os5qx5ru17su5tu}2x{17su5tu5ou5qs}2y{4qv5kv7mu5ot5qz5ru17su5tu}'fof'-6o7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qu}3v{17su5tu5os5qu}fu{17su5tu5ou5qu}7p{17su5tu5ou5qu}ck{4qt5ks5ot5qy5rw17sv5tv}4l{4qt5ks5ot5qy5rw17sv5tv}cm{4qt5ks5ot5qy5rw17sv5tv}cn{4qt5ks5ot5qy5rw17sv5tv}co{4qt5ks5ot5qy5rw17sv5tv}cp{4qt5ks5ot5qy5rw17sv5tv}6l{17st5tt5ou5qu}17s{ckuclucmucnucoucpu4lu4wu}5o{ckuclucmucnucoucpu4lu4wu}5q{ckzclzcmzcnzcozcpz4lz4wu}5r{ckxclxcmxcnxcoxcpx4lx4wu}5t{ckuclucmucnucoucpu4lu4wu}7q{ckuclucmucnucoucpu4lu}6p{17sw5tw5ou5qu}ek{17st5tt5qu}el{17st5tt5ou5qu}em{17st5tt5qu}en{17st5tt5qu}eo{17st5tt5qu}ep{17st5tt5ou5qu}es{17ss5ts5qu}et{17sw5tw5ou5qu}eu{17sw5tw5ou5qu}ev{17ss5ts5qu}6z{17sw5tw5ou5qu5rs}fm{17sw5tw5ou5qu5rs}fn{17sw5tw5ou5qu5rs}fo{17sw5tw5ou5qu5rs}fp{17sw5tw5ou5qu5rs}fq{17sw5tw5ou5qu5rs}7r{cktcltcmtcntcotcpt4lt5os}fs{17sw5tw5ou5qu5rs}ft{17su5tu5ou5qu}7m{5os}fv{17su5tu5ou5qu}fw{17su5tu5ou5qu}fz{cksclscmscnscoscps4ls}}}"),Symbol:u("{'widths'{k3uaw4r19m3m2k1t2l2l202m2y2n3m2p5n202q6o3k3m2s2l2t2l2v3r2w1t3m3m2y1t2z1wbk2sbl3r'fof'6o3n3m3o3m3p3m3q3m3r3m3s3m3t3m3u1w3v1w3w3r3x3r3y3r3z2wbp3t3l3m5v2l5x2l5z3m2q4yfr3r7v3k7w1o7x3k}'kerning'{'fof'-6o}}"),Helvetica:u("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}"),"Helvetica-BoldOblique":u("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),ZapfDingbats:u("{'widths'{k4u2k1w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-Bold":u("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Italic":u("{'widths'{k3n2q4ycx2l201n3m201o5t201s2l201t2l201u2l201w3r201x3r201y3r2k1t2l2l202m2n2n3m2o3m2p5n202q5t2r1p2s2l2t2l2u3m2v4n2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w4n3x4n3y4n3z3m4k5w4l3x4m3x4n4m4o4s4p3x4q3x4r4s4s4s4t2l4u2w4v4m4w3r4x5n4y4m4z4s5k3x5l4s5m3x5n3m5o3r5p4s5q3x5r5n5s3x5t3r5u3r5v2r5w1w5x2r5y2u5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q1w6r3m6s3m6t1w6u1w6v2w6w1w6x4s6y3m6z3m7k3m7l3m7m2r7n2r7o1w7p3m7q2w7r4m7s2w7t2w7u2r7v2s7w1v7x2s7y3q202l3mcl3xal2ram3man3mao3map3mar3mas2lat4wau1vav3maw4nay4waz2lbk2sbl4n'fof'6obo2lbp3mbq3obr1tbs2lbu1zbv3mbz3mck3x202k3mcm3xcn3xco3xcp3xcq5tcr4mcs3xct3xcu3xcv3xcw2l2m2ucy2lcz2ldl4mdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr4nfs3mft3mfu3mfv3mfw3mfz2w203k6o212m6m2dw2l2cq2l3t3m3u2l17s3r19m3m}'kerning'{cl{5kt4qw}201s{201sw}201t{201tw2wy2yy6q-t}201x{2wy2yy}2k{201tw}2w{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}2x{17ss5ts5os}2y{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}'fof'-6o6t{17ss5ts5qs}7t{5os}3v{5qs}7p{17su5tu5qs}ck{5kt4qw}4l{5kt4qw}cm{5kt4qw}cn{5kt4qw}co{5kt4qw}cp{5kt4qw}6l{4qs5ks5ou5qw5ru17su5tu}17s{2ks}5q{ckvclvcmvcnvcovcpv4lv}5r{ckuclucmucnucoucpu4lu}5t{2ks}6p{4qs5ks5ou5qw5ru17su5tu}ek{4qs5ks5ou5qw5ru17su5tu}el{4qs5ks5ou5qw5ru17su5tu}em{4qs5ks5ou5qw5ru17su5tu}en{4qs5ks5ou5qw5ru17su5tu}eo{4qs5ks5ou5qw5ru17su5tu}ep{4qs5ks5ou5qw5ru17su5tu}es{5ks5qs4qs}et{4qs5ks5ou5qw5ru17su5tu}eu{4qs5ks5qw5ru17su5tu}ev{5ks5qs4qs}ex{17ss5ts5qs}6z{4qv5ks5ou5qw5ru17su5tu}fm{4qv5ks5ou5qw5ru17su5tu}fn{4qv5ks5ou5qw5ru17su5tu}fo{4qv5ks5ou5qw5ru17su5tu}fp{4qv5ks5ou5qw5ru17su5tu}fq{4qv5ks5ou5qw5ru17su5tu}7r{5os}fs{4qv5ks5ou5qw5ru17su5tu}ft{17su5tu5qs}fu{17su5tu5qs}fv{17su5tu5qs}fw{17su5tu5qs}}}"),"Times-Roman":u("{'widths'{k3n2q4ycx2l201n3m201o6o201s2l201t2l201u2l201w2w201x2w201y2w2k1t2l2l202m2n2n3m2o3m2p5n202q6o2r1m2s2l2t2l2u3m2v3s2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v1w3w3s3x3s3y3s3z2w4k5w4l4s4m4m4n4m4o4s4p3x4q3r4r4s4s4s4t2l4u2r4v4s4w3x4x5t4y4s4z4s5k3r5l4s5m4m5n3r5o3x5p4s5q4s5r5y5s4s5t4s5u3x5v2l5w1w5x2l5y2z5z3m6k2l6l2w6m3m6n2w6o3m6p2w6q2l6r3m6s3m6t1w6u1w6v3m6w1w6x4y6y3m6z3m7k3m7l3m7m2l7n2r7o1w7p3m7q3m7r4s7s3m7t3m7u2w7v3k7w1o7x3k7y3q202l3mcl4sal2lam3man3mao3map3mar3mas2lat4wau1vav3maw3say4waz2lbk2sbl3s'fof'6obo2lbp3mbq2xbr1tbs2lbu1zbv3mbz2wck4s202k3mcm4scn4sco4scp4scq5tcr4mcs3xct3xcu3xcv3xcw2l2m2tcy2lcz2ldl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek2wel2wem2wen2weo2wep2weq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr3sfs3mft3mfu3mfv3mfw3mfz3m203k6o212m6m2dw2l2cq2l3t3m3u1w17s4s19m3m}'kerning'{cl{4qs5ku17sw5ou5qy5rw201ss5tw201ws}201s{201ss}201t{ckw4lwcmwcnwcowcpwclw4wu201ts}2k{201ts}2w{4qs5kw5os5qx5ru17sx5tx}2x{17sw5tw5ou5qu}2y{4qs5kw5os5qx5ru17sx5tx}'fof'-6o7t{ckuclucmucnucoucpu4lu5os5rs}3u{17su5tu5qs}3v{17su5tu5qs}7p{17sw5tw5qs}ck{4qs5ku17sw5ou5qy5rw201ss5tw201ws}4l{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cm{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cn{4qs5ku17sw5ou5qy5rw201ss5tw201ws}co{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cp{4qs5ku17sw5ou5qy5rw201ss5tw201ws}6l{17su5tu5os5qw5rs}17s{2ktclvcmvcnvcovcpv4lv4wuckv}5o{ckwclwcmwcnwcowcpw4lw4wu}5q{ckyclycmycnycoycpy4ly4wu5ms}5r{cktcltcmtcntcotcpt4lt4ws}5t{2ktclvcmvcnvcovcpv4lv4wuckv}7q{cksclscmscnscoscps4ls}6p{17su5tu5qw5rs}ek{5qs5rs}el{17su5tu5os5qw5rs}em{17su5tu5os5qs5rs}en{17su5qs5rs}eo{5qs5rs}ep{17su5tu5os5qw5rs}es{5qs}et{17su5tu5qw5rs}eu{17su5tu5qs5rs}ev{5qs}6z{17sv5tv5os5qx5rs}fm{5os5qt5rs}fn{17sv5tv5os5qx5rs}fo{17sv5tv5os5qx5rs}fp{5os5qt5rs}fq{5os5qt5rs}7r{ckuclucmucnucoucpu4lu5os}fs{17sv5tv5os5qx5rs}ft{17ss5ts5qs}fu{17sw5tw5qs}fv{17sw5tw5qs}fw{17ss5ts5qs}fz{ckuclucmucnucoucpu4lu5os5rs}}}"),"Helvetica-Oblique":u("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}")}};t.events.push(["addFont",function(b){var v=b.font,S=g.Unicode[v.postScriptName];S&&(v.metadata.Unicode={},v.metadata.Unicode.widths=S.widths,v.metadata.Unicode.kerning=S.kerning);var E=f.Unicode[v.postScriptName];E&&(v.metadata.Unicode.encoding=E,v.encoding=E.codePages[0])}])})(li.API),(function(t){var e=function(r){for(var n=r.length,i=new Uint8Array(n),a=0;a<n;a++)i[a]=r.charCodeAt(a);return i};t.API.events.push(["addFont",function(r){var n=void 0,i=r.font,a=r.instance;if(!i.isStandardFont){if(a===void 0)throw new Error("Font does not exist in vFS, import fonts or remove declaration doc.addFont('"+i.postScriptName+"').");if(typeof(n=a.existsFileInVFS(i.postScriptName)===!1?a.loadFile(i.postScriptName):a.getFileFromVFS(i.postScriptName))!="string")throw new Error("Font is not stored as string-data in vFS, import fonts or remove declaration doc.addFont('"+i.postScriptName+"').");(function(s,o){o=/^\x00\x01\x00\x00/.test(o)?e(o):e(fw(o)),s.metadata=t.API.TTFFont.open(o),s.metadata.Unicode=s.metadata.Unicode||{encoding:{},kerning:{},widths:[]},s.metadata.glyIdsUsed=[0]})(i,n)}}])})(li),li.API.addSvgAsImage=function(t,e,r,n,i,a,s,o){if(isNaN(e)||isNaN(r))throw Eo.error("jsPDF.addSvgAsImage: Invalid coordinates",arguments),new Error("Invalid coordinates passed to jsPDF.addSvgAsImage");if(isNaN(n)||isNaN(i))throw Eo.error("jsPDF.addSvgAsImage: Invalid measurements",arguments),new Error("Invalid measurements (width and/or height) passed to jsPDF.addSvgAsImage");var u=document.createElement("canvas");u.width=n,u.height=i;var h=u.getContext("2d");h.fillStyle="#fff",h.fillRect(0,0,u.width,u.height);var f={ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0},g=this;return(Ri.canvg?Promise.resolve(Ri.canvg):XC(()=>import("./index.es-B-rftL1C.js"),__vite__mapDeps([0,1,2,3,4,5]),import.meta.url)).catch(function(b){return Promise.reject(new Error("Could not load canvg: "+b))}).then(function(b){return b.default?b.default:b}).then(function(b){return b.fromString(h,t,f)},function(){return Promise.reject(new Error("Could not load canvg."))}).then(function(b){return b.render(f)}).then(function(){g.addImage(u.toDataURL("image/jpeg",1),e,r,n,i,s,o)})},li.API.putTotalPages=function(t){var e,r=0;parseInt(this.internal.getFont().id.substr(1),10)<15?(e=new RegExp(t,"g"),r=this.internal.getNumberOfPages()):(e=new RegExp(this.pdfEscape16(t,this.internal.getFont()),"g"),r=this.pdfEscape16(this.internal.getNumberOfPages()+"",this.internal.getFont()));for(var n=1;n<=this.internal.getNumberOfPages();n++)for(var i=0;i<this.internal.pages[n].length;i++)this.internal.pages[n][i]=this.internal.pages[n][i].replace(e,r);return this},li.API.viewerPreferences=function(t,e){var r;t=t||{},e=e||!1;var n,i,a,s={HideToolbar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideMenubar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideWindowUI:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},FitWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},CenterWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},DisplayDocTitle:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.4},NonFullScreenPageMode:{defaultValue:"UseNone",value:"UseNone",type:"name",explicitSet:!1,valueSet:["UseNone","UseOutlines","UseThumbs","UseOC"],pdfVersion:1.3},Direction:{defaultValue:"L2R",value:"L2R",type:"name",explicitSet:!1,valueSet:["L2R","R2L"],pdfVersion:1.3},ViewArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},ViewClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintScaling:{defaultValue:"AppDefault",value:"AppDefault",type:"name",explicitSet:!1,valueSet:["AppDefault","None"],pdfVersion:1.6},Duplex:{defaultValue:"",value:"none",type:"name",explicitSet:!1,valueSet:["Simplex","DuplexFlipShortEdge","DuplexFlipLongEdge","none"],pdfVersion:1.7},PickTrayByPDFSize:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.7},PrintPageRange:{defaultValue:"",value:"",type:"array",explicitSet:!1,valueSet:null,pdfVersion:1.7},NumCopies:{defaultValue:1,value:1,type:"integer",explicitSet:!1,valueSet:null,pdfVersion:1.7}},o=Object.keys(s),u=[],h=0,f=0,g=0;function b(S,E){var P,k=!1;for(P=0;P<S.length;P+=1)S[P]===E&&(k=!0);return k}if(this.internal.viewerpreferences===void 0&&(this.internal.viewerpreferences={},this.internal.viewerpreferences.configuration=JSON.parse(JSON.stringify(s)),this.internal.viewerpreferences.isSubscribed=!1),r=this.internal.viewerpreferences.configuration,t==="reset"||e===!0){var v=o.length;for(g=0;g<v;g+=1)r[o[g]].value=r[o[g]].defaultValue,r[o[g]].explicitSet=!1}if(ao(t)==="object"){for(i in t)if(a=t[i],b(o,i)&&a!==void 0){if(r[i].type==="boolean"&&typeof a=="boolean")r[i].value=a;else if(r[i].type==="name"&&b(r[i].valueSet,a))r[i].value=a;else if(r[i].type==="integer"&&Number.isInteger(a))r[i].value=a;else if(r[i].type==="array"){for(h=0;h<a.length;h+=1)if(n=!0,a[h].length===1&&typeof a[h][0]=="number")u.push(String(a[h]-1));else if(a[h].length>1){for(f=0;f<a[h].length;f+=1)typeof a[h][f]!="number"&&(n=!1);n===!0&&u.push([a[h][0]-1,a[h][1]-1].join(" "))}r[i].value="["+u.join(" ")+"]"}else r[i].value=r[i].defaultValue;r[i].explicitSet=!0}}return this.internal.viewerpreferences.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){var S,E=[];for(S in r)r[S].explicitSet===!0&&(r[S].type==="name"?E.push("/"+S+" /"+r[S].value):E.push("/"+S+" "+r[S].value));E.length!==0&&this.internal.write(`/ViewerPreferences
<<
`+E.join(`
`)+`
>>`)}),this.internal.viewerpreferences.isSubscribed=!0),this.internal.viewerpreferences.configuration=r,this},(function(t){var e=function(){var n='<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"><rdf:Description rdf:about="" xmlns:jspdf="'+this.internal.__metadata__.namespaceuri+'"><jspdf:metadata>',i=unescape(encodeURIComponent('<x:xmpmeta xmlns:x="adobe:ns:meta/">')),a=unescape(encodeURIComponent(n)),s=unescape(encodeURIComponent(this.internal.__metadata__.metadata)),o=unescape(encodeURIComponent("</jspdf:metadata></rdf:Description></rdf:RDF>")),u=unescape(encodeURIComponent("</x:xmpmeta>")),h=a.length+s.length+o.length+i.length+u.length;this.internal.__metadata__.metadata_object_number=this.internal.newObject(),this.internal.write("<< /Type /Metadata /Subtype /XML /Length "+h+" >>"),this.internal.write("stream"),this.internal.write(i+a+s+o+u),this.internal.write("endstream"),this.internal.write("endobj")},r=function(){this.internal.__metadata__.metadata_object_number&&this.internal.write("/Metadata "+this.internal.__metadata__.metadata_object_number+" 0 R")};t.addMetadata=function(n,i){return this.internal.__metadata__===void 0&&(this.internal.__metadata__={metadata:n,namespaceuri:i||"http://jspdf.default.namespaceuri/"},this.internal.events.subscribe("putCatalog",r),this.internal.events.subscribe("postPutResources",e)),this}})(li.API),(function(t){var e=t.API,r=e.pdfEscape16=function(a,s){for(var o,u=s.metadata.Unicode.widths,h=["","0","00","000","0000"],f=[""],g=0,b=a.length;g<b;++g){if(o=s.metadata.characterToGlyph(a.charCodeAt(g)),s.metadata.glyIdsUsed.push(o),s.metadata.toUnicode[o]=a.charCodeAt(g),u.indexOf(o)==-1&&(u.push(o),u.push([parseInt(s.metadata.widthOfGlyph(o),10)])),o=="0")return f.join("");o=o.toString(16),f.push(h[4-o.length],o)}return f.join("")},n=function(a){var s,o,u,h,f,g,b;for(f=`/CIDInit /ProcSet findresource begin
12 dict begin
begincmap
/CIDSystemInfo <<
  /Registry (Adobe)
  /Ordering (UCS)
  /Supplement 0
>> def
/CMapName /Adobe-Identity-UCS def
/CMapType 2 def
1 begincodespacerange
<0000><ffff>
endcodespacerange`,u=[],g=0,b=(o=Object.keys(a).sort(function(v,S){return v-S})).length;g<b;g++)s=o[g],u.length>=100&&(f+=`
`+u.length+` beginbfchar
`+u.join(`
`)+`
endbfchar`,u=[]),a[s]!==void 0&&a[s]!==null&&typeof a[s].toString=="function"&&(h=("0000"+a[s].toString(16)).slice(-4),s=("0000"+(+s).toString(16)).slice(-4),u.push("<"+s+"><"+h+">"));return u.length&&(f+=`
`+u.length+` beginbfchar
`+u.join(`
`)+`
endbfchar
`),f+`endcmap
CMapName currentdict /CMap defineresource pop
end
end`};e.events.push(["putFont",function(a){(function(s){var o=s.font,u=s.out,h=s.newObject,f=s.putStream;if(o.metadata instanceof t.API.TTFFont&&o.encoding==="Identity-H"){for(var g=o.metadata.Unicode.widths,b=o.metadata.subset.encode(o.metadata.glyIdsUsed,1),v="",S=0;S<b.length;S++)v+=String.fromCharCode(b[S]);var E=h();f({data:v,addLength1:!0,objectId:E}),u("endobj");var P=h();f({data:n(o.metadata.toUnicode),addLength1:!0,objectId:P}),u("endobj");var k=h();u("<<"),u("/Type /FontDescriptor"),u("/FontName /"+ev(o.fontName)),u("/FontFile2 "+E+" 0 R"),u("/FontBBox "+t.API.PDFObject.convert(o.metadata.bbox)),u("/Flags "+o.metadata.flags),u("/StemV "+o.metadata.stemV),u("/ItalicAngle "+o.metadata.italicAngle),u("/Ascent "+o.metadata.ascender),u("/Descent "+o.metadata.decender),u("/CapHeight "+o.metadata.capHeight),u(">>"),u("endobj");var L=h();u("<<"),u("/Type /Font"),u("/BaseFont /"+ev(o.fontName)),u("/FontDescriptor "+k+" 0 R"),u("/W "+t.API.PDFObject.convert(g)),u("/CIDToGIDMap /Identity"),u("/DW 1000"),u("/Subtype /CIDFontType2"),u("/CIDSystemInfo"),u("<<"),u("/Supplement 0"),u("/Registry (Adobe)"),u("/Ordering ("+o.encoding+")"),u(">>"),u(">>"),u("endobj"),o.objectNumber=h(),u("<<"),u("/Type /Font"),u("/Subtype /Type0"),u("/ToUnicode "+P+" 0 R"),u("/BaseFont /"+ev(o.fontName)),u("/Encoding /"+o.encoding),u("/DescendantFonts ["+L+" 0 R]"),u(">>"),u("endobj"),o.isAlreadyPutted=!0}})(a)}]),e.events.push(["putFont",function(a){(function(s){var o=s.font,u=s.out,h=s.newObject,f=s.putStream;if(o.metadata instanceof t.API.TTFFont&&o.encoding==="WinAnsiEncoding"){for(var g=o.metadata.rawData,b="",v=0;v<g.length;v++)b+=String.fromCharCode(g[v]);var S=h();f({data:b,addLength1:!0,objectId:S}),u("endobj");var E=h();f({data:n(o.metadata.toUnicode),addLength1:!0,objectId:E}),u("endobj");var P=h();u("<<"),u("/Descent "+o.metadata.decender),u("/CapHeight "+o.metadata.capHeight),u("/StemV "+o.metadata.stemV),u("/Type /FontDescriptor"),u("/FontFile2 "+S+" 0 R"),u("/Flags 96"),u("/FontBBox "+t.API.PDFObject.convert(o.metadata.bbox)),u("/FontName /"+ev(o.fontName)),u("/ItalicAngle "+o.metadata.italicAngle),u("/Ascent "+o.metadata.ascender),u(">>"),u("endobj"),o.objectNumber=h();for(var k=0;k<o.metadata.hmtx.widths.length;k++)o.metadata.hmtx.widths[k]=parseInt(o.metadata.hmtx.widths[k]*(1e3/o.metadata.head.unitsPerEm));u("<</Subtype/TrueType/Type/Font/ToUnicode "+E+" 0 R/BaseFont/"+ev(o.fontName)+"/FontDescriptor "+P+" 0 R/Encoding/"+o.encoding+" /FirstChar 29 /LastChar 255 /Widths "+t.API.PDFObject.convert(o.metadata.hmtx.widths)+">>"),u("endobj"),o.isAlreadyPutted=!0}})(a)}]);var i=function(a){var s,o=a.text||"",u=a.x,h=a.y,f=a.options||{},g=a.mutex||{},b=g.pdfEscape,v=g.activeFontKey,S=g.fonts,E=v,P="",k=0,L="",O=S[E].encoding;if(S[E].encoding!=="Identity-H")return{text:o,x:u,y:h,options:f,mutex:g};for(L=o,E=v,Array.isArray(o)&&(L=o[0]),k=0;k<L.length;k+=1)S[E].metadata.hasOwnProperty("cmap")&&(s=S[E].metadata.cmap.unicode.codeMap[L[k].charCodeAt(0)]),s||L[k].charCodeAt(0)<256&&S[E].metadata.hasOwnProperty("Unicode")?P+=L[k]:P+="";var M="";return parseInt(E.slice(1))<14||O==="WinAnsiEncoding"?M=b(P,E).split("").map(function(z){return z.charCodeAt(0).toString(16)}).join(""):O==="Identity-H"&&(M=r(P,S[E])),g.isHex=!0,{text:M,x:u,y:h,options:f,mutex:g}};e.events.push(["postProcessText",function(a){var s=a.text||"",o=[],u={text:s,x:a.x,y:a.y,options:a.options,mutex:a.mutex};if(Array.isArray(s)){var h=0;for(h=0;h<s.length;h+=1)Array.isArray(s[h])&&s[h].length===3?o.push([i(Object.assign({},u,{text:s[h][0]})).text,s[h][1],s[h][2]]):o.push(i(Object.assign({},u,{text:s[h]})).text);a.text=o}else a.text=i(Object.assign({},u,{text:s})).text}])})(li),(function(t){var e=function(){return this.internal.vFS===void 0&&(this.internal.vFS={}),!0};t.existsFileInVFS=function(r){return e.call(this),this.internal.vFS[r]!==void 0},t.addFileToVFS=function(r,n){return e.call(this),this.internal.vFS[r]=n,this},t.getFileFromVFS=function(r){return e.call(this),this.internal.vFS[r]!==void 0?this.internal.vFS[r]:null}})(li.API),(function(t){t.__bidiEngine__=t.prototype.__bidiEngine__=function(n){var i,a,s,o,u,h,f,g=e,b=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],v=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],S={L:0,R:1,EN:2,AN:3,N:4,B:5,S:6},E={0:0,5:1,6:2,7:3,32:4,251:5,254:6,255:7},P=["(",")","(","<",">","<","[","]","[","{","}","{","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],k=new RegExp(/^([1-4|9]|1[0-9]|2[0-9]|3[0168]|4[04589]|5[012]|7[78]|159|16[0-9]|17[0-2]|21[569]|22[03489]|250)$/),L=!1,O=0;this.__bidiEngine__={};var M=function(Q){var H=Q.charCodeAt(),ne=H>>8,oe=E[ne];return oe!==void 0?g[256*oe+(255&H)]:ne===252||ne===253?"AL":k.test(ne)?"L":ne===8?"R":"N"},z=function(Q){for(var H,ne=0;ne<Q.length;ne++){if((H=M(Q.charAt(ne)))==="L")return!1;if(H==="R")return!0}return!1},B=function(Q,H,ne,oe){var ce,fe,Me,me,we=H[oe];switch(we){case"L":case"R":case"LRE":case"RLE":case"LRO":case"RLO":case"PDF":L=!1;break;case"N":case"AN":break;case"EN":L&&(we="AN");break;case"AL":L=!0,we="R";break;case"WS":case"BN":we="N";break;case"CS":oe<1||oe+1>=H.length||(ce=ne[oe-1])!=="EN"&&ce!=="AN"||(fe=H[oe+1])!=="EN"&&fe!=="AN"?we="N":L&&(fe="AN"),we=fe===ce?fe:"N";break;case"ES":we=(ce=oe>0?ne[oe-1]:"B")==="EN"&&oe+1<H.length&&H[oe+1]==="EN"?"EN":"N";break;case"ET":if(oe>0&&ne[oe-1]==="EN"){we="EN";break}if(L){we="N";break}for(Me=oe+1,me=H.length;Me<me&&H[Me]==="ET";)Me++;we=Me<me&&H[Me]==="EN"?"EN":"N";break;case"NSM":if(s&&!o){for(me=H.length,Me=oe+1;Me<me&&H[Me]==="NSM";)Me++;if(Me<me){var Te=Q[oe],ke=Te>=1425&&Te<=2303||Te===64286;if(ce=H[Me],ke&&(ce==="R"||ce==="AL")){we="R";break}}}we=oe<1||(ce=H[oe-1])==="B"?"N":ne[oe-1];break;case"B":L=!1,i=!0,we=O;break;case"S":a=!0,we="N"}return we},q=function(Q,H,ne){var oe=Q.split("");return ne&&W(oe,ne,{hiLevel:O}),oe.reverse(),H&&H.reverse(),oe.join("")},W=function(Q,H,ne){var oe,ce,fe,Me,me,we=-1,Te=Q.length,ke=0,he=[],Ee=O?v:b,xe=[];for(L=!1,i=!1,a=!1,ce=0;ce<Te;ce++)xe[ce]=M(Q[ce]);for(fe=0;fe<Te;fe++){if(me=ke,he[fe]=B(Q,xe,he,fe),oe=240&(ke=Ee[me][S[he[fe]]]),ke&=15,H[fe]=Me=Ee[ke][5],oe>0)if(oe===16){for(ce=we;ce<fe;ce++)H[ce]=1;we=-1}else we=-1;if(Ee[ke][6])we===-1&&(we=fe);else if(we>-1){for(ce=we;ce<fe;ce++)H[ce]=Me;we=-1}xe[fe]==="B"&&(H[fe]=0),ne.hiLevel|=Me}a&&(function(Ne,Oe,$e){for(var De=0;De<$e;De++)if(Ne[De]==="S"){Oe[De]=O;for(var it=De-1;it>=0&&Ne[it]==="WS";it--)Oe[it]=O}})(xe,H,Te)},G=function(Q,H,ne,oe,ce){if(!(ce.hiLevel<Q)){if(Q===1&&O===1&&!i)return H.reverse(),void(ne&&ne.reverse());for(var fe,Me,me,we,Te=H.length,ke=0;ke<Te;){if(oe[ke]>=Q){for(me=ke+1;me<Te&&oe[me]>=Q;)me++;for(we=ke,Me=me-1;we<Me;we++,Me--)fe=H[we],H[we]=H[Me],H[Me]=fe,ne&&(fe=ne[we],ne[we]=ne[Me],ne[Me]=fe);ke=me}ke++}}},ie=function(Q,H,ne){var oe=Q.split(""),ce={hiLevel:O};return ne||(ne=[]),W(oe,ne,ce),(function(fe,Me,me){if(me.hiLevel!==0&&f)for(var we,Te=0;Te<fe.length;Te++)Me[Te]===1&&(we=P.indexOf(fe[Te]))>=0&&(fe[Te]=P[we+1])})(oe,ne,ce),G(2,oe,H,ne,ce),G(1,oe,H,ne,ce),oe.join("")};return this.__bidiEngine__.doBidiReorder=function(Q,H,ne){if((function(ce,fe){if(fe)for(var Me=0;Me<ce.length;Me++)fe[Me]=Me;o===void 0&&(o=z(ce)),h===void 0&&(h=z(ce))})(Q,H),s||!u||h)if(s&&u&&o^h)O=o?1:0,Q=q(Q,H,ne);else if(!s&&u&&h)O=o?1:0,Q=ie(Q,H,ne),Q=q(Q,H);else if(!s||o||u||h){if(s&&!u&&o^h)Q=q(Q,H),o?(O=0,Q=ie(Q,H,ne)):(O=1,Q=ie(Q,H,ne),Q=q(Q,H));else if(s&&o&&!u&&h)O=1,Q=ie(Q,H,ne),Q=q(Q,H);else if(!s&&!u&&o^h){var oe=f;o?(O=1,Q=ie(Q,H,ne),O=0,f=!1,Q=ie(Q,H,ne),f=oe):(O=0,Q=ie(Q,H,ne),Q=q(Q,H),O=1,f=!1,Q=ie(Q,H,ne),f=oe,Q=q(Q,H))}}else O=0,Q=ie(Q,H,ne);else O=o?1:0,Q=ie(Q,H,ne);return Q},this.__bidiEngine__.setOptions=function(Q){Q&&(s=Q.isInputVisual,u=Q.isOutputVisual,o=Q.isInputRtl,h=Q.isOutputRtl,f=Q.isSymmetricSwapping)},this.__bidiEngine__.setOptions(n),this.__bidiEngine__};var e=["BN","BN","BN","BN","BN","BN","BN","BN","BN","S","B","S","WS","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","B","B","B","S","WS","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","BN","BN","BN","BN","BN","BN","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","CS","N","ET","ET","ET","ET","N","N","N","N","L","N","N","BN","N","N","ET","ET","EN","EN","N","L","N","N","N","EN","L","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","N","N","N","N","N","ET","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","NSM","R","NSM","NSM","R","NSM","NSM","R","NSM","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","N","N","N","N","N","R","R","R","R","R","N","N","N","N","N","N","N","N","N","N","N","AN","AN","AN","AN","AN","AN","N","N","AL","ET","ET","AL","CS","AL","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","AN","AN","AN","AN","AN","AN","AN","AN","AN","ET","AN","AN","AL","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","N","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","NSM","NSM","N","NSM","NSM","NSM","NSM","AL","AL","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","R","N","N","N","N","R","N","N","N","N","N","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","BN","BN","BN","L","R","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","B","LRE","RLE","PDF","LRO","RLO","CS","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","BN","BN","BN","BN","BN","N","LRI","RLI","FSI","PDI","BN","BN","BN","BN","BN","BN","EN","L","N","N","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","L","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","N","N","N","N","N","R","NSM","R","R","R","R","R","R","R","R","R","R","ES","R","R","R","R","R","R","R","R","R","R","R","R","R","N","R","R","R","R","R","N","R","N","R","R","N","R","R","N","R","R","R","R","R","R","R","R","R","R","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","CS","N","N","CS","N","N","N","N","N","N","N","N","N","ET","N","N","ES","ES","N","N","N","N","N","ET","ET","N","N","N","N","N","AL","AL","AL","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","BN","N","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","N","N","N","ET","ET","N","N","N","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N"],r=new t.__bidiEngine__({isInputVisual:!0});t.API.events.push(["postProcessText",function(n){var i=n.text;n.x,n.y;var a=n.options||{};n.mutex,a.lang;var s=[];if(a.isInputVisual=typeof a.isInputVisual!="boolean"||a.isInputVisual,r.setOptions(a),Object.prototype.toString.call(i)==="[object Array]"){var o=0;for(s=[],o=0;o<i.length;o+=1)Object.prototype.toString.call(i[o])==="[object Array]"?s.push([r.doBidiReorder(i[o][0]),i[o][1],i[o][2]]):s.push([r.doBidiReorder(i[o])]);n.text=s}else n.text=r.doBidiReorder(i);r.setOptions({isInputVisual:!0})}])})(li),li.API.TTFFont=(function(){function t(e){var r;if(this.rawData=e,r=this.contents=new Kp(e),this.contents.pos=4,r.readString(4)==="ttcf")throw new Error("TTCF not supported.");r.pos=0,this.parse(),this.subset=new Eve(this),this.registerTTF()}return t.open=function(e){return new t(e)},t.prototype.parse=function(){return this.directory=new cve(this.contents),this.head=new fve(this),this.name=new yve(this),this.cmap=new CX(this),this.toUnicode={},this.hhea=new dve(this),this.maxp=new vve(this),this.hmtx=new _ve(this),this.post=new gve(this),this.os2=new pve(this),this.loca=new Sve(this),this.glyf=new bve(this),this.ascender=this.os2.exists&&this.os2.ascender||this.hhea.ascender,this.decender=this.os2.exists&&this.os2.decender||this.hhea.decender,this.lineGap=this.os2.exists&&this.os2.lineGap||this.hhea.lineGap,this.bbox=[this.head.xMin,this.head.yMin,this.head.xMax,this.head.yMax]},t.prototype.registerTTF=function(){var e,r,n,i,a;if(this.scaleFactor=1e3/this.head.unitsPerEm,this.bbox=(function(){var s,o,u,h;for(h=[],s=0,o=(u=this.bbox).length;s<o;s++)e=u[s],h.push(Math.round(e*this.scaleFactor));return h}).call(this),this.stemV=0,this.post.exists?(n=255&(i=this.post.italic_angle),32768&(r=i>>16)&&(r=-(1+(65535^r))),this.italicAngle=+(r+"."+n)):this.italicAngle=0,this.ascender=Math.round(this.ascender*this.scaleFactor),this.decender=Math.round(this.decender*this.scaleFactor),this.lineGap=Math.round(this.lineGap*this.scaleFactor),this.capHeight=this.os2.exists&&this.os2.capHeight||this.ascender,this.xHeight=this.os2.exists&&this.os2.xHeight||0,this.familyClass=(this.os2.exists&&this.os2.familyClass||0)>>8,this.isSerif=(a=this.familyClass)===1||a===2||a===3||a===4||a===5||a===7,this.isScript=this.familyClass===10,this.flags=0,this.post.isFixedPitch&&(this.flags|=1),this.isSerif&&(this.flags|=2),this.isScript&&(this.flags|=8),this.italicAngle!==0&&(this.flags|=64),this.flags|=32,!this.cmap.unicode)throw new Error("No unicode cmap for font")},t.prototype.characterToGlyph=function(e){var r;return((r=this.cmap.unicode)!=null?r.codeMap[e]:void 0)||0},t.prototype.widthOfGlyph=function(e){var r;return r=1e3/this.head.unitsPerEm,this.hmtx.forGlyph(e).advance*r},t.prototype.widthOfString=function(e,r,n){var i,a,s,o;for(s=0,a=0,o=(e=""+e).length;0<=o?a<o:a>o;a=0<=o?++a:--a)i=e.charCodeAt(a),s+=this.widthOfGlyph(this.characterToGlyph(i))+n*(1e3/r)||0;return s*(r/1e3)},t.prototype.lineHeight=function(e,r){var n;return r==null&&(r=!1),n=r?this.lineGap:0,(this.ascender+n-this.decender)/1e3*e},t})();var pf,Kp=(function(){function t(e){this.data=e??[],this.pos=0,this.length=this.data.length}return t.prototype.readByte=function(){return this.data[this.pos++]},t.prototype.writeByte=function(e){return this.data[this.pos++]=e},t.prototype.readUInt32=function(){return 16777216*this.readByte()+(this.readByte()<<16)+(this.readByte()<<8)+this.readByte()},t.prototype.writeUInt32=function(e){return this.writeByte(e>>>24&255),this.writeByte(e>>16&255),this.writeByte(e>>8&255),this.writeByte(255&e)},t.prototype.readInt32=function(){var e;return(e=this.readUInt32())>=2147483648?e-4294967296:e},t.prototype.writeInt32=function(e){return e<0&&(e+=4294967296),this.writeUInt32(e)},t.prototype.readUInt16=function(){return this.readByte()<<8|this.readByte()},t.prototype.writeUInt16=function(e){return this.writeByte(e>>8&255),this.writeByte(255&e)},t.prototype.readInt16=function(){var e;return(e=this.readUInt16())>=32768?e-65536:e},t.prototype.writeInt16=function(e){return e<0&&(e+=65536),this.writeUInt16(e)},t.prototype.readString=function(e){var r,n;for(n=[],r=0;0<=e?r<e:r>e;r=0<=e?++r:--r)n[r]=String.fromCharCode(this.readByte());return n.join("")},t.prototype.writeString=function(e){var r,n,i;for(i=[],r=0,n=e.length;0<=n?r<n:r>n;r=0<=n?++r:--r)i.push(this.writeByte(e.charCodeAt(r)));return i},t.prototype.readShort=function(){return this.readInt16()},t.prototype.writeShort=function(e){return this.writeInt16(e)},t.prototype.readLongLong=function(){var e,r,n,i,a,s,o,u;return e=this.readByte(),r=this.readByte(),n=this.readByte(),i=this.readByte(),a=this.readByte(),s=this.readByte(),o=this.readByte(),u=this.readByte(),128&e?-1*(72057594037927940*(255^e)+281474976710656*(255^r)+1099511627776*(255^n)+4294967296*(255^i)+16777216*(255^a)+65536*(255^s)+256*(255^o)+(255^u)+1):72057594037927940*e+281474976710656*r+1099511627776*n+4294967296*i+16777216*a+65536*s+256*o+u},t.prototype.writeLongLong=function(e){var r,n;return r=Math.floor(e/4294967296),n=4294967295&e,this.writeByte(r>>24&255),this.writeByte(r>>16&255),this.writeByte(r>>8&255),this.writeByte(255&r),this.writeByte(n>>24&255),this.writeByte(n>>16&255),this.writeByte(n>>8&255),this.writeByte(255&n)},t.prototype.readInt=function(){return this.readInt32()},t.prototype.writeInt=function(e){return this.writeInt32(e)},t.prototype.read=function(e){var r,n;for(r=[],n=0;0<=e?n<e:n>e;n=0<=e?++n:--n)r.push(this.readByte());return r},t.prototype.write=function(e){var r,n,i,a;for(a=[],n=0,i=e.length;n<i;n++)r=e[n],a.push(this.writeByte(r));return a},t})(),cve=(function(){var t;function e(r){var n,i,a;for(this.scalarType=r.readInt(),this.tableCount=r.readShort(),this.searchRange=r.readShort(),this.entrySelector=r.readShort(),this.rangeShift=r.readShort(),this.tables={},i=0,a=this.tableCount;0<=a?i<a:i>a;i=0<=a?++i:--i)n={tag:r.readString(4),checksum:r.readInt(),offset:r.readInt(),length:r.readInt()},this.tables[n.tag]=n}return e.prototype.encode=function(r){var n,i,a,s,o,u,h,f,g,b,v,S,E;for(E in v=Object.keys(r).length,u=Math.log(2),g=16*Math.floor(Math.log(v)/u),s=Math.floor(g/u),f=16*v-g,(i=new Kp).writeInt(this.scalarType),i.writeShort(v),i.writeShort(g),i.writeShort(s),i.writeShort(f),a=16*v,h=i.pos+a,o=null,S=[],r)for(b=r[E],i.writeString(E),i.writeInt(t(b)),i.writeInt(h),i.writeInt(b.length),S=S.concat(b),E==="head"&&(o=h),h+=b.length;h%4;)S.push(0),h++;return i.write(S),n=2981146554-t(i.data),i.pos=o+8,i.writeUInt32(n),i.data},t=function(r){var n,i,a,s;for(r=AX.call(r);r.length%4;)r.push(0);for(a=new Kp(r),i=0,n=0,s=r.length;n<s;n=n+=4)i+=a.readUInt32();return 4294967295&i},e})(),hve={}.hasOwnProperty,ld=function(t,e){for(var r in e)hve.call(e,r)&&(t[r]=e[r]);function n(){this.constructor=t}return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};pf=(function(){function t(e){var r;this.file=e,r=this.file.directory.tables[this.tag],this.exists=!!r,r&&(this.offset=r.offset,this.length=r.length,this.parse(this.file.contents))}return t.prototype.parse=function(){},t.prototype.encode=function(){},t.prototype.raw=function(){return this.exists?(this.file.contents.pos=this.offset,this.file.contents.read(this.length)):null},t})();var fve=(function(){function t(){return t.__super__.constructor.apply(this,arguments)}return ld(t,pf),t.prototype.tag="head",t.prototype.parse=function(e){return e.pos=this.offset,this.version=e.readInt(),this.revision=e.readInt(),this.checkSumAdjustment=e.readInt(),this.magicNumber=e.readInt(),this.flags=e.readShort(),this.unitsPerEm=e.readShort(),this.created=e.readLongLong(),this.modified=e.readLongLong(),this.xMin=e.readShort(),this.yMin=e.readShort(),this.xMax=e.readShort(),this.yMax=e.readShort(),this.macStyle=e.readShort(),this.lowestRecPPEM=e.readShort(),this.fontDirectionHint=e.readShort(),this.indexToLocFormat=e.readShort(),this.glyphDataFormat=e.readShort()},t.prototype.encode=function(e){var r;return(r=new Kp).writeInt(this.version),r.writeInt(this.revision),r.writeInt(this.checkSumAdjustment),r.writeInt(this.magicNumber),r.writeShort(this.flags),r.writeShort(this.unitsPerEm),r.writeLongLong(this.created),r.writeLongLong(this.modified),r.writeShort(this.xMin),r.writeShort(this.yMin),r.writeShort(this.xMax),r.writeShort(this.yMax),r.writeShort(this.macStyle),r.writeShort(this.lowestRecPPEM),r.writeShort(this.fontDirectionHint),r.writeShort(e),r.writeShort(this.glyphDataFormat),r.data},t})(),DB=(function(){function t(e,r){var n,i,a,s,o,u,h,f,g,b,v,S,E,P,k,L,O;switch(this.platformID=e.readUInt16(),this.encodingID=e.readShort(),this.offset=r+e.readInt(),g=e.pos,e.pos=this.offset,this.format=e.readUInt16(),this.length=e.readUInt16(),this.language=e.readUInt16(),this.isUnicode=this.platformID===3&&this.encodingID===1&&this.format===4||this.platformID===0&&this.format===4,this.codeMap={},this.format){case 0:for(u=0;u<256;++u)this.codeMap[u]=e.readByte();break;case 4:for(v=e.readUInt16(),b=v/2,e.pos+=6,a=(function(){var M,z;for(z=[],u=M=0;0<=b?M<b:M>b;u=0<=b?++M:--M)z.push(e.readUInt16());return z})(),e.pos+=2,E=(function(){var M,z;for(z=[],u=M=0;0<=b?M<b:M>b;u=0<=b?++M:--M)z.push(e.readUInt16());return z})(),h=(function(){var M,z;for(z=[],u=M=0;0<=b?M<b:M>b;u=0<=b?++M:--M)z.push(e.readUInt16());return z})(),f=(function(){var M,z;for(z=[],u=M=0;0<=b?M<b:M>b;u=0<=b?++M:--M)z.push(e.readUInt16());return z})(),i=(this.length-e.pos+this.offset)/2,o=(function(){var M,z;for(z=[],u=M=0;0<=i?M<i:M>i;u=0<=i?++M:--M)z.push(e.readUInt16());return z})(),u=k=0,O=a.length;k<O;u=++k)for(P=a[u],n=L=S=E[u];S<=P?L<=P:L>=P;n=S<=P?++L:--L)f[u]===0?s=n+h[u]:(s=o[f[u]/2+(n-S)-(b-u)]||0)!==0&&(s+=h[u]),this.codeMap[n]=65535&s}e.pos=g}return t.encode=function(e,r){var n,i,a,s,o,u,h,f,g,b,v,S,E,P,k,L,O,M,z,B,q,W,G,ie,Q,H,ne,oe,ce,fe,Me,me,we,Te,ke,he,Ee,xe,Ne,Oe,$e,De,it,Ye,rt,Ie;switch(oe=new Kp,s=Object.keys(e).sort(function(Mt,at){return Mt-at}),r){case"macroman":for(E=0,P=(function(){var Mt=[];for(S=0;S<256;++S)Mt.push(0);return Mt})(),L={0:0},a={},ce=0,we=s.length;ce<we;ce++)L[it=e[i=s[ce]]]==null&&(L[it]=++E),a[i]={old:e[i],new:L[e[i]]},P[i]=L[e[i]];return oe.writeUInt16(1),oe.writeUInt16(0),oe.writeUInt32(12),oe.writeUInt16(0),oe.writeUInt16(262),oe.writeUInt16(0),oe.write(P),{charMap:a,subtable:oe.data,maxGlyphID:E+1};case"unicode":for(H=[],g=[],O=0,L={},n={},k=h=null,fe=0,Te=s.length;fe<Te;fe++)L[z=e[i=s[fe]]]==null&&(L[z]=++O),n[i]={old:z,new:L[z]},o=L[z]-i,k!=null&&o===h||(k&&g.push(k),H.push(i),h=o),k=i;for(k&&g.push(k),g.push(65535),H.push(65535),ie=2*(G=H.length),W=2*Math.pow(Math.log(G)/Math.LN2,2),b=Math.log(W/2)/Math.LN2,q=2*G-W,u=[],B=[],v=[],S=Me=0,ke=H.length;Me<ke;S=++Me){if(Q=H[S],f=g[S],Q===65535){u.push(0),B.push(0);break}if(Q-(ne=n[Q].new)>=32768)for(u.push(0),B.push(2*(v.length+G-S)),i=me=Q;Q<=f?me<=f:me>=f;i=Q<=f?++me:--me)v.push(n[i].new);else u.push(ne-Q),B.push(0)}for(oe.writeUInt16(3),oe.writeUInt16(1),oe.writeUInt32(12),oe.writeUInt16(4),oe.writeUInt16(16+8*G+2*v.length),oe.writeUInt16(0),oe.writeUInt16(ie),oe.writeUInt16(W),oe.writeUInt16(b),oe.writeUInt16(q),$e=0,he=g.length;$e<he;$e++)i=g[$e],oe.writeUInt16(i);for(oe.writeUInt16(0),De=0,Ee=H.length;De<Ee;De++)i=H[De],oe.writeUInt16(i);for(Ye=0,xe=u.length;Ye<xe;Ye++)o=u[Ye],oe.writeUInt16(o);for(rt=0,Ne=B.length;rt<Ne;rt++)M=B[rt],oe.writeUInt16(M);for(Ie=0,Oe=v.length;Ie<Oe;Ie++)E=v[Ie],oe.writeUInt16(E);return{charMap:n,subtable:oe.data,maxGlyphID:O+1}}},t})(),CX=(function(){function t(){return t.__super__.constructor.apply(this,arguments)}return ld(t,pf),t.prototype.tag="cmap",t.prototype.parse=function(e){var r,n,i;for(e.pos=this.offset,this.version=e.readUInt16(),i=e.readUInt16(),this.tables=[],this.unicode=null,n=0;0<=i?n<i:n>i;n=0<=i?++n:--n)r=new DB(e,this.offset),this.tables.push(r),r.isUnicode&&this.unicode==null&&(this.unicode=r);return!0},t.encode=function(e,r){var n,i;return r==null&&(r="macroman"),n=DB.encode(e,r),(i=new Kp).writeUInt16(0),i.writeUInt16(1),n.table=i.data.concat(n.subtable),n},t})(),dve=(function(){function t(){return t.__super__.constructor.apply(this,arguments)}return ld(t,pf),t.prototype.tag="hhea",t.prototype.parse=function(e){return e.pos=this.offset,this.version=e.readInt(),this.ascender=e.readShort(),this.decender=e.readShort(),this.lineGap=e.readShort(),this.advanceWidthMax=e.readShort(),this.minLeftSideBearing=e.readShort(),this.minRightSideBearing=e.readShort(),this.xMaxExtent=e.readShort(),this.caretSlopeRise=e.readShort(),this.caretSlopeRun=e.readShort(),this.caretOffset=e.readShort(),e.pos+=8,this.metricDataFormat=e.readShort(),this.numberOfMetrics=e.readUInt16()},t})(),pve=(function(){function t(){return t.__super__.constructor.apply(this,arguments)}return ld(t,pf),t.prototype.tag="OS/2",t.prototype.parse=function(e){if(e.pos=this.offset,this.version=e.readUInt16(),this.averageCharWidth=e.readShort(),this.weightClass=e.readUInt16(),this.widthClass=e.readUInt16(),this.type=e.readShort(),this.ySubscriptXSize=e.readShort(),this.ySubscriptYSize=e.readShort(),this.ySubscriptXOffset=e.readShort(),this.ySubscriptYOffset=e.readShort(),this.ySuperscriptXSize=e.readShort(),this.ySuperscriptYSize=e.readShort(),this.ySuperscriptXOffset=e.readShort(),this.ySuperscriptYOffset=e.readShort(),this.yStrikeoutSize=e.readShort(),this.yStrikeoutPosition=e.readShort(),this.familyClass=e.readShort(),this.panose=(function(){var r,n;for(n=[],r=0;r<10;++r)n.push(e.readByte());return n})(),this.charRange=(function(){var r,n;for(n=[],r=0;r<4;++r)n.push(e.readInt());return n})(),this.vendorID=e.readString(4),this.selection=e.readShort(),this.firstCharIndex=e.readShort(),this.lastCharIndex=e.readShort(),this.version>0&&(this.ascent=e.readShort(),this.descent=e.readShort(),this.lineGap=e.readShort(),this.winAscent=e.readShort(),this.winDescent=e.readShort(),this.codePageRange=(function(){var r,n;for(n=[],r=0;r<2;r=++r)n.push(e.readInt());return n})(),this.version>1))return this.xHeight=e.readShort(),this.capHeight=e.readShort(),this.defaultChar=e.readShort(),this.breakChar=e.readShort(),this.maxContext=e.readShort()},t})(),gve=(function(){function t(){return t.__super__.constructor.apply(this,arguments)}return ld(t,pf),t.prototype.tag="post",t.prototype.parse=function(e){var r,n,i;switch(e.pos=this.offset,this.format=e.readInt(),this.italicAngle=e.readInt(),this.underlinePosition=e.readShort(),this.underlineThickness=e.readShort(),this.isFixedPitch=e.readInt(),this.minMemType42=e.readInt(),this.maxMemType42=e.readInt(),this.minMemType1=e.readInt(),this.maxMemType1=e.readInt(),this.format){case 65536:case 196608:break;case 131072:var a;for(n=e.readUInt16(),this.glyphNameIndex=[],a=0;0<=n?a<n:a>n;a=0<=n?++a:--a)this.glyphNameIndex.push(e.readUInt16());for(this.names=[],i=[];e.pos<this.offset+this.length;)r=e.readByte(),i.push(this.names.push(e.readString(r)));return i;case 151552:return n=e.readUInt16(),this.offsets=e.read(n);case 262144:return this.map=(function(){var s,o,u;for(u=[],a=s=0,o=this.file.maxp.numGlyphs;0<=o?s<o:s>o;a=0<=o?++s:--s)u.push(e.readUInt32());return u}).call(this)}},t})(),mve=function(t,e){this.raw=t,this.length=t.length,this.platformID=e.platformID,this.encodingID=e.encodingID,this.languageID=e.languageID},yve=(function(){function t(){return t.__super__.constructor.apply(this,arguments)}return ld(t,pf),t.prototype.tag="name",t.prototype.parse=function(e){var r,n,i,a,s,o,u,h,f,g,b;for(e.pos=this.offset,e.readShort(),r=e.readShort(),o=e.readShort(),n=[],a=0;0<=r?a<r:a>r;a=0<=r?++a:--a)n.push({platformID:e.readShort(),encodingID:e.readShort(),languageID:e.readShort(),nameID:e.readShort(),length:e.readShort(),offset:this.offset+o+e.readShort()});for(u={},a=f=0,g=n.length;f<g;a=++f)i=n[a],e.pos=i.offset,h=e.readString(i.length),s=new mve(h,i),u[b=i.nameID]==null&&(u[b]=[]),u[i.nameID].push(s);this.strings=u,this.copyright=u[0],this.fontFamily=u[1],this.fontSubfamily=u[2],this.uniqueSubfamily=u[3],this.fontName=u[4],this.version=u[5];try{this.postscriptName=u[6][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}catch{this.postscriptName=u[4][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}return this.trademark=u[7],this.manufacturer=u[8],this.designer=u[9],this.description=u[10],this.vendorUrl=u[11],this.designerUrl=u[12],this.license=u[13],this.licenseUrl=u[14],this.preferredFamily=u[15],this.preferredSubfamily=u[17],this.compatibleFull=u[18],this.sampleText=u[19]},t})(),vve=(function(){function t(){return t.__super__.constructor.apply(this,arguments)}return ld(t,pf),t.prototype.tag="maxp",t.prototype.parse=function(e){return e.pos=this.offset,this.version=e.readInt(),this.numGlyphs=e.readUInt16(),this.maxPoints=e.readUInt16(),this.maxContours=e.readUInt16(),this.maxCompositePoints=e.readUInt16(),this.maxComponentContours=e.readUInt16(),this.maxZones=e.readUInt16(),this.maxTwilightPoints=e.readUInt16(),this.maxStorage=e.readUInt16(),this.maxFunctionDefs=e.readUInt16(),this.maxInstructionDefs=e.readUInt16(),this.maxStackElements=e.readUInt16(),this.maxSizeOfInstructions=e.readUInt16(),this.maxComponentElements=e.readUInt16(),this.maxComponentDepth=e.readUInt16()},t})(),_ve=(function(){function t(){return t.__super__.constructor.apply(this,arguments)}return ld(t,pf),t.prototype.tag="hmtx",t.prototype.parse=function(e){var r,n,i,a,s,o,u;for(e.pos=this.offset,this.metrics=[],r=0,o=this.file.hhea.numberOfMetrics;0<=o?r<o:r>o;r=0<=o?++r:--r)this.metrics.push({advance:e.readUInt16(),lsb:e.readInt16()});for(i=this.file.maxp.numGlyphs-this.file.hhea.numberOfMetrics,this.leftSideBearings=(function(){var h,f;for(f=[],r=h=0;0<=i?h<i:h>i;r=0<=i?++h:--h)f.push(e.readInt16());return f})(),this.widths=(function(){var h,f,g,b;for(b=[],h=0,f=(g=this.metrics).length;h<f;h++)a=g[h],b.push(a.advance);return b}).call(this),n=this.widths[this.widths.length-1],u=[],r=s=0;0<=i?s<i:s>i;r=0<=i?++s:--s)u.push(this.widths.push(n));return u},t.prototype.forGlyph=function(e){return e in this.metrics?this.metrics[e]:{advance:this.metrics[this.metrics.length-1].advance,lsb:this.leftSideBearings[e-this.metrics.length]}},t})(),AX=[].slice,bve=(function(){function t(){return t.__super__.constructor.apply(this,arguments)}return ld(t,pf),t.prototype.tag="glyf",t.prototype.parse=function(){return this.cache={}},t.prototype.glyphFor=function(e){var r,n,i,a,s,o,u,h,f,g;return e in this.cache?this.cache[e]:(a=this.file.loca,r=this.file.contents,n=a.indexOf(e),(i=a.lengthOf(e))===0?this.cache[e]=null:(r.pos=this.offset+n,s=(o=new Kp(r.read(i))).readShort(),h=o.readShort(),g=o.readShort(),u=o.readShort(),f=o.readShort(),this.cache[e]=s===-1?new wve(o,h,g,u,f):new xve(o,s,h,g,u,f),this.cache[e]))},t.prototype.encode=function(e,r,n){var i,a,s,o,u;for(s=[],a=[],o=0,u=r.length;o<u;o++)i=e[r[o]],a.push(s.length),i&&(s=s.concat(i.encode(n)));return a.push(s.length),{table:s,offsets:a}},t})(),xve=(function(){function t(e,r,n,i,a,s){this.raw=e,this.numberOfContours=r,this.xMin=n,this.yMin=i,this.xMax=a,this.yMax=s,this.compound=!1}return t.prototype.encode=function(){return this.raw.data},t})(),wve=(function(){function t(e,r,n,i,a){var s,o;for(this.raw=e,this.xMin=r,this.yMin=n,this.xMax=i,this.yMax=a,this.compound=!0,this.glyphIDs=[],this.glyphOffsets=[],s=this.raw;o=s.readShort(),this.glyphOffsets.push(s.pos),this.glyphIDs.push(s.readUInt16()),32&o;)s.pos+=1&o?4:2,128&o?s.pos+=8:64&o?s.pos+=4:8&o&&(s.pos+=2)}return t.prototype.encode=function(){var e,r,n;for(r=new Kp(AX.call(this.raw.data)),e=0,n=this.glyphIDs.length;e<n;++e)r.pos=this.glyphOffsets[e];return r.data},t})(),Sve=(function(){function t(){return t.__super__.constructor.apply(this,arguments)}return ld(t,pf),t.prototype.tag="loca",t.prototype.parse=function(e){var r,n;return e.pos=this.offset,r=this.file.head.indexToLocFormat,this.offsets=r===0?(function(){var i,a;for(a=[],n=0,i=this.length;n<i;n+=2)a.push(2*e.readUInt16());return a}).call(this):(function(){var i,a;for(a=[],n=0,i=this.length;n<i;n+=4)a.push(e.readUInt32());return a}).call(this)},t.prototype.indexOf=function(e){return this.offsets[e]},t.prototype.lengthOf=function(e){return this.offsets[e+1]-this.offsets[e]},t.prototype.encode=function(e,r){for(var n=new Uint32Array(this.offsets.length),i=0,a=0,s=0;s<n.length;++s)if(n[s]=i,a<r.length&&r[a]==s){++a,n[s]=i;var o=this.offsets[s],u=this.offsets[s+1]-o;u>0&&(i+=u)}for(var h=new Array(4*n.length),f=0;f<n.length;++f)h[4*f+3]=255&n[f],h[4*f+2]=(65280&n[f])>>8,h[4*f+1]=(16711680&n[f])>>16,h[4*f]=(4278190080&n[f])>>24;return h},t})(),Eve=(function(){function t(e){this.font=e,this.subset={},this.unicodes={},this.next=33}return t.prototype.generateCmap=function(){var e,r,n,i,a;for(r in i=this.font.cmap.tables[0].codeMap,e={},a=this.subset)n=a[r],e[r]=i[n];return e},t.prototype.glyphsFor=function(e){var r,n,i,a,s,o,u;for(i={},s=0,o=e.length;s<o;s++)i[a=e[s]]=this.font.glyf.glyphFor(a);for(a in r=[],i)(n=i[a])!=null&&n.compound&&r.push.apply(r,n.glyphIDs);if(r.length>0)for(a in u=this.glyphsFor(r))n=u[a],i[a]=n;return i},t.prototype.encode=function(e,r){var n,i,a,s,o,u,h,f,g,b,v,S,E,P,k;for(i in n=CX.encode(this.generateCmap(),"unicode"),s=this.glyphsFor(e),v={0:0},k=n.charMap)v[(u=k[i]).old]=u.new;for(S in b=n.maxGlyphID,s)S in v||(v[S]=b++);return f=(function(L){var O,M;for(O in M={},L)M[L[O]]=O;return M})(v),g=Object.keys(f).sort(function(L,O){return L-O}),E=(function(){var L,O,M;for(M=[],L=0,O=g.length;L<O;L++)o=g[L],M.push(f[o]);return M})(),a=this.font.glyf.encode(s,E,v),h=this.font.loca.encode(a.offsets,E),P={cmap:this.font.cmap.raw(),glyf:a.table,loca:h,hmtx:this.font.hmtx.raw(),hhea:this.font.hhea.raw(),maxp:this.font.maxp.raw(),post:this.font.post.raw(),name:this.font.name.raw(),head:this.font.head.encode(r)},this.font.os2.exists&&(P["OS/2"]=this.font.os2.raw()),this.font.directory.encode(P)},t})();li.API.PDFObject=(function(){var t;function e(){}return t=function(r,n){return(Array(n+1).join("0")+r).slice(-n)},e.convert=function(r){var n,i,a,s;if(Array.isArray(r))return"["+(function(){var o,u,h;for(h=[],o=0,u=r.length;o<u;o++)n=r[o],h.push(e.convert(n));return h})().join(" ")+"]";if(typeof r=="string")return"/"+r;if(r?.isString)return"("+r+")";if(r instanceof Date)return"(D:"+t(r.getUTCFullYear(),4)+t(r.getUTCMonth(),2)+t(r.getUTCDate(),2)+t(r.getUTCHours(),2)+t(r.getUTCMinutes(),2)+t(r.getUTCSeconds(),2)+"Z)";if({}.toString.call(r)==="[object Object]"){for(i in a=["<<"],r)s=r[i],a.push("/"+i+" "+e.convert(s));return a.push(">>"),a.join(`
`)}return""+r},e})();const Tve=t=>{const e=t.width,r=t.height,n=document.createElement("div");n.className="hidden-map",n.style.width="0px",n.style.height="0px",n.style.overflow="hidden",document.body.appendChild(n);const i=document.createElement("div");i.style.width=e+"px",i.style.height=r+"px",n.appendChild(i);const a=t.map.map.getStyle();for(const u in a.sources){const h=a.sources[u];Object.keys(h).forEach(f=>{h[f]||delete h[f]})}const s=new kE.Map({container:i,center:t.map.map.getCenter(),zoom:t.map.map.getZoom(),bearing:0,pitch:0,interactive:!1,preserveDrawingBuffer:!0,fadeDuration:0,attributionControl:!1,style:a}),o=s._cameraForBoxAndBearing([t.bboxUnrotated[0],t.bboxUnrotated[1]],[t.bboxUnrotated[2],t.bboxUnrotated[3]],t.bearing+t.map.map.getBearing());return s._fitInternal(o),new Promise(u=>{console.log("before idle"),s.once("idle",function(){const h={...t,renderMap:s,hiddenContainer:n,createPdf:f=>Cve({...t,renderMap:s,hiddenContainer:n,...f}),createPng:f=>Ive({...t,renderMap:s,hiddenContainer:n,...f})};u(h)})})};function Cve(t){const e=new li({orientation:t?.orientation==="portrait"?"p":"l",unit:"mm",compress:!0,format:t.format});return Object.defineProperty(window,"devicePixelRatio",{get:function(){return 300/96}}),new Promise(r=>{e.addImage(t.renderMap.getCanvas().toDataURL("image/png"),"png",0,0,e.internal.pageSize.getWidth(),e.internal.pageSize.getHeight(),void 0,"FAST"),t.renderMap.remove(),t.hiddenContainer.parentNode?.removeChild(t.hiddenContainer);const n={...t,pdf:e,downloadPdf:i=>Ave({...n,...i}),formData:new FormData};r(n)})}function Ave(t){return t.pdf.save("Map.pdf"),new Promise(function(e){e({...t})})}function Ive(t){return new Promise(e=>{const r=t.renderMap.getCanvas().toDataURL("image/png"),n={...t,png:r,downloadPng:i=>Pve({...n,...i})};e(n)})}function Pve(t){const e=document.createElement("a");return e.download=t?.name?t.name+".png":"map.png",e.href=t.png,document.body.appendChild(e),e.click(),document.body.removeChild(e),new Promise(function(r){r({...t})})}function IX(t){const e=ha({mapId:t.mapId});return{createExport:ee.useMemo(()=>{if(e.map)return n=>Tve({map:e.map,...n})},[e.map])}}const FB=t=>{const e=ha({mapId:t.mapId}),r=IX({mapId:t.mapId}),[n,i]=ht.useState(!1);return K.jsx(K.Fragment,{children:K.jsx(Ji,{color:"primary",variant:"contained",onClick:()=>{if(e.map&&r?.createExport){i(!0);const a=e.map.getBounds(),s=[a.getWest(),a.getSouth(),a.getEast(),a.getNorth()];r.createExport({width:595*1.4,height:842*1.4,bbox:s,bboxUnrotated:s,bearing:e.map.getBearing(),format:"a4",orientation:"portrait",...t.exportOptions}).then(o=>o.createPdf()).then(o=>(i(!1),o.downloadPdf())).catch(o=>{console.log(o),i(!1)})}},children:n?K.jsx(ZE,{size:24,sx:{color:"#fff"}}):K.jsx(Dge,{})})})};try{FB.displayName="MlCreatePdfButton",FB.__docgenInfo={description:"Renders a button that will create a PDF version of the current map view (dimensions adjusted to fit Din A4 Paper).",displayName:"MlCreatePdfButton",props:{mapId:{defaultValue:null,description:"ID of the target MapLibre instance in mapContext",name:"mapId",required:!1,type:{name:"string | undefined"}},exportOptions:{defaultValue:null,description:"Option overrides for the createExport function",name:"exportOptions",required:!1,type:{name:"createExportOptions | undefined"}}}}}catch{}const Sv={A4:{"300dpi":{width:2480,height:3508},"150dpi":{width:1240,height:1754},"72dpi":{width:595,height:842}},A3:{"300dpi":{width:3505,height:4961},"150dpi":{width:1754,height:2480},"72dpi":{width:842,height:1191}},A2:{"300dpi":{width:4961,height:7016},"150dpi":{width:2480,height:3508},"72dpi":{width:1191,height:1684}},A1:{"300dpi":{width:7016,height:9933},"150dpi":{width:3508,height:4967},"72dpi":{width:1684,height:2384}},A0:{"300dpi":{width:9933,height:14043},"150dpi":{width:4967,height:7022},"72dpi":{width:2384,height:3370}}},PX=ht.createContext({}),kve=Sv.A4["72dpi"],XP=({children:t})=>{const[e,r]=ee.useState("A4"),[n,i]=ee.useState("72dpi"),[a,s]=ee.useState({center:void 0,scale:void 0,rotate:0,width:210,height:297,orientation:"portrait",fixedScale:0}),o=ee.useRef(null),u=ee.useMemo(()=>typeof Sv[e][n]<"u"?a.orientation==="portrait"?Sv[e][n]:{width:Sv[e][n].height,height:Sv[e][n].width}:kve,[e,n,a.orientation]),h={options:a,setOptions:s,format:e,setFormat:r,quality:n,setQuality:i,geojsonRef:o,template:u};return K.jsx(PX.Provider,{value:h,children:t})};try{XP.displayName="PdfContextProvider",XP.__docgenInfo={description:"",displayName:"PdfContextProvider",props:{}}}catch{}function hO(t,e){for(var r=t.length,n=0;n<r;++n)if(e(t[n],n))return!0;return!1}function kX(t,e){for(var r=t.length,n=0;n<r;++n)if(e(t[n],n))return t[n];return null}function MX(t){var e=t;if(typeof e>"u"){if(typeof navigator>"u"||!navigator)return"";e=navigator.userAgent||""}return e.toLowerCase()}function fO(t,e){try{return new RegExp(t,"g").exec(e)}catch{return null}}function Mve(){if(typeof navigator>"u"||!navigator||!navigator.userAgentData)return!1;var t=navigator.userAgentData,e=t.brands||t.uaList;return!!(e&&e.length)}function Rve(t,e){var r=fO("("+t+")((?:\\/|\\s|:)([0-9|\\.|_]+))",e);return r?r[3]:""}function YP(t){return t.replace(/_/g,".")}function Z_(t,e){var r=null,n="-1";return hO(t,function(i){var a=fO("("+i.test+")((?:\\/|\\s|:)([0-9|\\.|_]+))?",e);return!a||i.brand?!1:(r=i,n=a[3]||"-1",i.versionAlias?n=i.versionAlias:i.versionTest&&(n=Rve(i.versionTest.toLowerCase(),e)||n),n=YP(n),!0)}),{preset:r,version:n}}function u2(t,e){var r={brand:"",version:"-1"};return hO(t,function(n){var i=RX(e,n);return i?(r.brand=n.id,r.version=n.versionAlias||i.version,r.version!=="-1"):!1}),r}function RX(t,e){return kX(t,function(r){var n=r.brand;return fO(""+e.test,n.toLowerCase())})}var OX=[{test:"phantomjs",id:"phantomjs"},{test:"whale",id:"whale"},{test:"edgios|edge|edg",id:"edge"},{test:"msie|trident|windows phone",id:"ie",versionTest:"iemobile|msie|rv"},{test:"miuibrowser",id:"miui browser"},{test:"samsungbrowser",id:"samsung internet"},{test:"samsung",id:"samsung internet",versionTest:"version"},{test:"chrome|crios",id:"chrome"},{test:"firefox|fxios",id:"firefox"},{test:"android",id:"android browser",versionTest:"version"},{test:"safari|iphone|ipad|ipod",id:"safari",versionTest:"version"}],LX=[{test:"(?=.*applewebkit/(53[0-7]|5[0-2]|[0-4]))(?=.*\\schrome)",id:"chrome",versionTest:"chrome"},{test:"chromium",id:"chrome"},{test:"whale",id:"chrome",versionAlias:"-1",brand:!0}],ZP=[{test:"applewebkit",id:"webkit",versionTest:"applewebkit|safari"}],NX=[{test:"(?=(iphone|ipad))(?!(.*version))",id:"webview"},{test:"(?=(android|iphone|ipad))(?=.*(naver|daum|; wv))",id:"webview"},{test:"webview",id:"webview"}],DX=[{test:"windows phone",id:"windows phone"},{test:"windows 2000",id:"window",versionAlias:"5.0"},{test:"windows nt",id:"window"},{test:"win32|windows",id:"window"},{test:"iphone|ipad|ipod",id:"ios",versionTest:"iphone os|cpu os"},{test:"macos|macintel|mac os x",id:"mac"},{test:"android|linux armv81",id:"android"},{test:"tizen",id:"tizen"},{test:"webos|web0s",id:"webos"}];function FX(t){return!!Z_(NX,t).preset}function Ove(t){var e=MX(t),r=!!/mobi/g.exec(e),n={name:"unknown",version:"-1",majorVersion:-1,webview:FX(e),chromium:!1,chromiumVersion:"-1",webkit:!1,webkitVersion:"-1"},i={name:"unknown",version:"-1",majorVersion:-1},a=Z_(OX,e),s=a.preset,o=a.version,u=Z_(DX,e),h=u.preset,f=u.version,g=Z_(LX,e);if(n.chromium=!!g.preset,n.chromiumVersion=g.version,!n.chromium){var b=Z_(ZP,e);n.webkit=!!b.preset,n.webkitVersion=b.version}return h&&(i.name=h.id,i.version=f,i.majorVersion=parseInt(f,10)),s&&(n.name=s.id,n.version=o,n.webview&&i.name==="ios"&&n.name!=="safari"&&(n.webview=!1)),n.majorVersion=parseInt(n.version,10),{browser:n,os:i,isMobile:r,isHints:!1}}function Lve(t){var e=navigator.userAgentData,r=(e.uaList||e.brands).slice(),n=e.mobile||!1,i=r[0],a=(e.platform||navigator.platform).toLowerCase(),s={name:i.brand,version:i.version,majorVersion:-1,webkit:!1,webkitVersion:"-1",chromium:!1,chromiumVersion:"-1",webview:!!u2(NX,r).brand||FX(MX())},o={name:"unknown",version:"-1",majorVersion:-1};s.webkit=!s.chromium&&hO(ZP,function(b){return RX(r,b)});var u=u2(LX,r);if(s.chromium=!!u.brand,s.chromiumVersion=u.version||"-1",!s.chromium){var h=u2(ZP,r);s.webkit=!!h.brand,s.webkitVersion=h.version||"-1"}var f=kX(DX,function(b){return new RegExp(""+b.test,"g").exec(a)});o.name=f?f.id:"";{var g=u2(OX,r);s.name=g.brand||s.name,s.version=g.brand&&t?t.uaFullVersion:g.version}return s.webkit&&(o.name=n?"ios":"mac"),o.name==="ios"&&s.webview&&(s.version="-1"),o.version=YP(o.version),s.version=YP(s.version),o.majorVersion=parseInt(o.version,10),s.majorVersion=parseInt(s.version,10),{browser:s,os:o,isMobile:n,isHints:!0}}function Nve(t){return Mve()?Lve():Ove(t)}function Dve(t){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];return e.map(function(n){return n.split(" ").map(function(i){return i?""+t+i:""}).join(" ")}).join(" ")}function Fve(t,e){return e.replace(/([^}{]*){/gm,function(r,n){return n.replace(/\.([^{,\s\d.]+)/g,"."+t+"$1")+"{"})}function om(t,e){return function(r){r&&(t[e]=r)}}function BX(t,e,r){return function(n){n&&(t[e][r]=n)}}function Bve(t,e){return e===void 0&&(e={}),function(r,n){t.forEach(function(i){var a=e[i]||i;a in r||(r[a]=function(){for(var s,o=[],u=0;u<arguments.length;u++)o[u]=arguments[u];var h=(s=this[n])[i].apply(s,o);return h===this[n]?this:h})})}}var zve="function",jve="object",Uve="string",Vve="number",dO="undefined",zX=typeof window!==dO,$ve=typeof document!==dO&&document,qve=[{open:"(",close:")"},{open:'"',close:'"'},{open:"'",close:"'"},{open:'\\"',close:'\\"'},{open:"\\'",close:"\\'"}],gl=1e-7,c2={cm:function(t){return t*96/2.54},mm:function(t){return t*96/254},in:function(t){return t*96},pt:function(t){return t*96/72},pc:function(t){return t*96/6},"%":function(t,e){return t*e/100},vw:function(t,e){return e===void 0&&(e=window.innerWidth),t/100*e},vh:function(t,e){return e===void 0&&(e=window.innerHeight),t/100*e},vmax:function(t,e){return e===void 0&&(e=Math.max(window.innerWidth,window.innerHeight)),t/100*e},vmin:function(t,e){return e===void 0&&(e=Math.min(window.innerWidth,window.innerHeight)),t/100*e}};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */function Hve(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;for(var n=Array(t),i=0,e=0;e<r;e++)for(var a=arguments[e],s=0,o=a.length;s<o;s++,i++)n[i]=a[s];return n}function tS(t,e,r,n){return(t*n+e*r)/(r+n)}function pO(t){return typeof t===dO}function sf(t){return t&&typeof t===jve}function eu(t){return Array.isArray(t)}function ep(t){return typeof t===Uve}function rb(t){return typeof t===Vve}function gO(t){return typeof t===zve}function Wve(t,e){var r=t===""||t==" ",n=e===""||e==" ";return n&&r||t===e}function jX(t,e,r,n,i){var a=mO(t,e,r);return a?r:Gve(t,e,r+1,n,i)}function mO(t,e,r){if(!t.ignore)return null;var n=e.slice(Math.max(r-3,0),r+3).join("");return new RegExp(t.ignore).exec(n)}function Gve(t,e,r,n,i){for(var a=function(h){var f=e[h].trim();if(f===t.close&&!mO(t,e,h))return{value:h};var g=h,b=rh(i,function(v){var S=v.open;return S===f});if(b&&(g=jX(b,e,h,n,i)),g===-1)return s=h,"break";h=g,s=h},s,o=r;o<n;++o){var u=a(o);if(o=s,typeof u=="object")return u.value;if(u==="break")break}return-1}function yO(t,e){var r=ep(e)?{separator:e}:e,n=r.separator,i=n===void 0?",":n,a=r.isSeparateFirst,s=r.isSeparateOnlyOpenClose,o=r.isSeparateOpenClose,u=o===void 0?s:o,h=r.openCloseCharacters,f=h===void 0?qve:h,g=f.map(function(q){var W=q.open,G=q.close;return W===G?W:W+"|"+G}).join("|"),b="(\\s*"+i+"\\s*|"+g+"|\\s+)",v=new RegExp(b,"g"),S=t.split(v).filter(function(q){return q&&q!=="undefined"}),E=S.length,P=[],k=[];function L(){return k.length?(P.push(k.join("")),k=[],!0):!1}for(var O=function(q){var W=S[q].trim(),G=q,ie=rh(f,function(ne){var oe=ne.open;return oe===W}),Q=rh(f,function(ne){var oe=ne.close;return oe===W});if(ie){if(G=jX(ie,S,q,E,f),G!==-1&&u)return L()&&a||(P.push(S.slice(q,G+1).join("")),q=G,a)?(M=q,"break"):(M=q,"continue")}else if(Q&&!mO(Q,S,q)){var H=Hve(f);return H.splice(f.indexOf(Q),1),{value:yO(t,{separator:i,isSeparateFirst:a,isSeparateOnlyOpenClose:s,isSeparateOpenClose:u,openCloseCharacters:H})}}else if(Wve(W,i)&&!s)return L(),a?(M=q,"break"):(M=q,"continue");G===-1&&(G=E-1),k.push(S.slice(q,G+1).join("")),q=G,M=q},M,z=0;z<E;++z){var B=O(z);if(z=M,typeof B=="object")return B.value;if(B==="break")break}return k.length&&P.push(k.join("")),P}function Jp(t){return yO(t,"")}function Kg(t){return yO(t,",")}function UX(t){var e=/([^(]*)\(([\s\S]*)\)([\s\S]*)/g.exec(t);return!e||e.length<4?{}:{prefix:e[1],value:e[2],suffix:e[3]}}function Yb(t){var e=/^([^\d|e|\-|\+]*)((?:\d|\.|-|e-|e\+)+)(\S*)$/g.exec(t);if(!e)return{prefix:"",unit:"",value:NaN};var r=e[1],n=e[2],i=e[3];return{prefix:r,unit:i,value:parseFloat(n)}}function Xve(t,e){return t.replace(/([a-z])([A-Z])/g,function(r,n,i){return""+n+e+i.toLowerCase()})}function nb(){return Date.now?Date.now():new Date().getTime()}function Gd(t,e,r){r===void 0&&(r=-1);for(var n=t.length,i=0;i<n;++i)if(e(t[i],i,t))return i;return r}function rh(t,e,r){var n=Gd(t,e);return n>-1?t[n]:r}var VX=(function(){var t=nb(),e=zX&&(window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.msRequestAnimationFrame);return e?e.bind(window):function(r){var n=nb(),i=setTimeout(function(){r(n-t)},1e3/60);return i}})(),Yve=(function(){var t=zX&&(window.cancelAnimationFrame||window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||window.msCancelAnimationFrame);return t?t.bind(window):function(e){clearTimeout(e)}})();function O0(t){return Object.keys(t)}function vo(t,e){var r=Yb(t),n=r.value,i=r.unit;if(sf(e)){var a=e[i];if(a){if(gO(a))return a(n);if(c2[i])return c2[i](n,a)}}else if(i==="%")return n*e/100;return c2[i]?c2[i](n):n}function KP(t,e,r){return Math.max(e,Math.min(t,r))}function BB(t,e,r,n){return n===void 0&&(n=t[0]/t[1]),[[Fi(e[0],gl),Fi(e[0]/n,gl)],[Fi(e[1]*n,gl),Fi(e[1],gl)]].filter(function(i){return i.every(function(a,s){var o=e[s],u=Fi(o,gl);return r?a<=o||a<=u:a>=o||a>=u})})[0]||t}function $X(t,e,r,n){if(!n)return t.map(function(v,S){return KP(v,e[S],r[S])});var i=t[0],a=t[1],s=n===!0?i/a:n,o=BB(t,e,!1,s),u=o[0],h=o[1],f=BB(t,r,!0,s),g=f[0],b=f[1];return i<u||a<h?(i=u,a=h):(i>g||a>b)&&(i=g,a=b),[i,a]}function Zve(t){for(var e=t.length,r=0,n=e-1;n>=0;--n)r+=t[n];return r}function JP(t){for(var e=t.length,r=0,n=e-1;n>=0;--n)r+=t[n];return e?r/e:0}function Ks(t,e){var r=e[0]-t[0],n=e[1]-t[1],i=Math.atan2(n,r);return i>=0?i:i+Math.PI*2}function Kve(t){return[0,1].map(function(e){return JP(t.map(function(r){return r[e]}))})}function zB(t){var e=Kve(t),r=Ks(e,t[0]),n=Ks(e,t[1]);return r<n&&n-r<Math.PI||r>n&&n-r<-Math.PI?1:-1}function zd(t,e){return Math.sqrt(Math.pow((e?e[0]:0)-t[0],2)+Math.pow((e?e[1]:0)-t[1],2))}function Fi(t,e){if(!e)return t;var r=1/e;return Math.round(t/e)/r}function jB(t,e){return t.forEach(function(r,n){t[n]=Fi(t[n],e)}),t}function Jve(t){for(var e=[],r=0;r<t;++r)e.push(r);return e}function Qve(t){return t.reduce(function(e,r){return e.concat(r)},[])}function Ol(t,e){return t.classList?t.classList.contains(e):!!t.className.match(new RegExp("(\\s|^)"+e+"(\\s|$)"))}function qX(t,e){t.classList?t.classList.add(e):t.className+=" "+e}function HX(t,e){if(t.classList)t.classList.remove(e);else{var r=new RegExp("(\\s|^)"+e+"(\\s|$)");t.className=t.className.replace(r," ")}}function Lu(t,e,r,n){t.addEventListener(e,r,n)}function hu(t,e,r,n){t.removeEventListener(e,r,n)}function vO(t){return t?.ownerDocument||$ve}function _O(t){return vO(t).documentElement}function cg(t){return vO(t).body}function Hp(t){var e;return((e=t?.ownerDocument)===null||e===void 0?void 0:e.defaultView)||window}function WX(t){return t&&"postMessage"in t&&"blur"in t&&"self"in t}function bO(t){return sf(t)&&t.nodeName&&t.nodeType&&"ownerDocument"in t}function e0e(t,e,r,n,i,a){for(var s=0;s<i;++s){var o=r+s*i,u=n+s*i;t[o]+=t[u]*a,e[o]+=e[u]*a}}function t0e(t,e,r,n,i){for(var a=0;a<i;++a){var s=r+a*i,o=n+a*i,u=t[s],h=e[s];t[s]=t[o],t[o]=u,e[s]=e[o],e[o]=h}}function r0e(t,e,r,n,i){for(var a=0;a<n;++a){var s=r+a*n;t[s]/=i,e[s]/=i}}function GX(t,e,r){for(var n=t.slice(),i=0;i<r;++i)n[i*r+e-1]=0,n[(e-1)*r+i]=0;return n[(e-1)*(r+1)]=1,n}function rd(t,e){e===void 0&&(e=Math.sqrt(t.length));for(var r=t.slice(),n=$o(e),i=0;i<e;++i){var a=e*i+i;if(!Fi(r[a],gl)){for(var s=i+1;s<e;++s)if(r[e*i+s]){t0e(r,n,i,s,e);break}}if(!Fi(r[a],gl))return[];r0e(r,n,i,e,r[a]);for(var s=0;s<e;++s){var o=s,u=s+i*e,h=r[u];!Fi(h,gl)||i===s||e0e(r,n,o,i,e,-h)}}return n}function n0e(t,e){e===void 0&&(e=Math.sqrt(t.length));for(var r=[],n=0;n<e;++n)for(var i=0;i<e;++i)r[i*e+n]=t[e*n+i];return r}function XX(t,e){e===void 0&&(e=Math.sqrt(t.length));for(var r=[],n=t[e*e-1],i=0;i<e-1;++i)r[i]=t[e*(e-1)+i]/n;return r[e-1]=0,r}function i0e(t,e){for(var r=$o(e),n=0;n<e-1;++n)r[e*(e-1)+n]=t[n]||0;return r}function vm(t,e){for(var r=t.slice(),n=t.length;n<e-1;++n)r[n]=0;return r[e-1]=1,r}function lf(t,e,r){if(e===void 0&&(e=Math.sqrt(t.length)),e===r)return t;for(var n=$o(r),i=Math.min(e,r),a=0;a<i-1;++a){for(var s=0;s<i-1;++s)n[a*r+s]=t[a*e+s];n[(a+1)*r-1]=t[(a+1)*e-1],n[(r-1)*r+a]=t[(e-1)*e+a]}return n[r*r-1]=t[e*e-1],n}function rS(t){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];var n=$o(t);return e.forEach(function(i){n=_o(n,i,t)}),n}function _o(t,e,r){r===void 0&&(r=Math.sqrt(t.length));var n=[],i=t.length/r,a=e.length/i;if(i){if(!a)return t}else return e;for(var s=0;s<r;++s)for(var o=0;o<a;++o){n[o*r+s]=0;for(var u=0;u<i;++u)n[o*r+s]+=t[u*r+s]*e[o*i+u]}return n}function Aa(t,e){for(var r=Math.min(t.length,e.length),n=t.slice(),i=0;i<r;++i)n[i]=n[i]+e[i];return n}function vi(t,e){for(var r=Math.min(t.length,e.length),n=t.slice(),i=0;i<r;++i)n[i]=n[i]-e[i];return n}function a0e(t,e){return e===void 0&&(e=t.length===6),e?[t[0],t[1],0,t[2],t[3],0,t[4],t[5],1]:t}function YX(t,e){return e===void 0&&(e=t.length===9),e?[t[0],t[1],t[3],t[4],t[6],t[7]]:t}function qu(t,e,r){r===void 0&&(r=e.length);var n=_o(t,e,r),i=n[r-1];return n.map(function(a){return a/i})}function o0e(t,e){return _o(t,[1,0,0,0,0,Math.cos(e),Math.sin(e),0,0,-Math.sin(e),Math.cos(e),0,0,0,0,1],4)}function s0e(t,e){return _o(t,[Math.cos(e),0,-Math.sin(e),0,0,1,0,0,Math.sin(e),0,Math.cos(e),0,0,0,0,1],4)}function l0e(t,e){return _o(t,Kb(e,4))}function h2(t,e){var r=e[0],n=r===void 0?1:r,i=e[1],a=i===void 0?1:i,s=e[2],o=s===void 0?1:s;return _o(t,[n,0,0,0,0,a,0,0,0,0,o,0,0,0,0,1],4)}function Zb(t,e){return qu(Kb(e,3),vm(t,3))}function F3(t,e){var r=e[0],n=r===void 0?0:r,i=e[1],a=i===void 0?0:i,s=e[2],o=s===void 0?0:s;return _o(t,[1,0,0,0,0,1,0,0,0,0,1,0,n,a,o,1],4)}function UB(t,e){return _o(t,e,4)}function Kb(t,e){var r=Math.cos(t),n=Math.sin(t),i=$o(e);return i[0]=r,i[1]=n,i[e]=-n,i[e+1]=r,i}function $o(t){for(var e=t*t,r=[],n=0;n<e;++n)r[n]=n%(t+1)?0:1;return r}function xO(t,e){for(var r=$o(e),n=Math.min(t.length,e-1),i=0;i<n;++i)r[(e+1)*i]=t[i];return r}function _m(t,e){for(var r=$o(e),n=Math.min(t.length,e-1),i=0;i<n;++i)r[e*(e-1)+i]=t[i];return r}function wO(t,e,r,n,i,a,s,o){var u=t[0],h=t[1],f=e[0],g=e[1],b=r[0],v=r[1],S=n[0],E=n[1],P=i[0],k=i[1],L=a[0],O=a[1],M=s[0],z=s[1],B=o[0],q=o[1],W=[u,0,f,0,b,0,S,0,h,0,g,0,v,0,E,0,1,0,1,0,1,0,1,0,0,u,0,f,0,b,0,S,0,h,0,g,0,v,0,E,0,1,0,1,0,1,0,1,-P*u,-k*u,-L*f,-O*f,-M*b,-z*b,-B*S,-q*S,-P*h,-k*h,-L*g,-O*g,-M*v,-z*v,-B*E,-q*E],G=rd(W,8);if(!G.length)return[];var ie=_o(G,[P,k,L,O,M,z,B,q],8);return ie[8]=1,lf(n0e(ie),3,4)}var C1=function(){return C1=Object.assign||function(e){for(var r,n=1,i=arguments.length;n<i;n++){r=arguments[n];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},C1.apply(this,arguments)};function u0e(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function ib(t,e){return e===void 0&&(e=0),tv(a0(t,e))}function c0e(t,e){var r=qu(t,[e[0],e[1]||0,e[2]||0,1],4),n=r[3]||1;return[r[0]/n,r[1]/n,r[2]/n]}function tv(t){var e=u0e();return t.forEach(function(r){var n=r.matrixFunction,i=r.functionValue;n&&(e=n(e,i))}),e}function a0(t,e){e===void 0&&(e=0);var r=eu(t)?t:Jp(t);return r.map(function(n){var i=UX(n),a=i.prefix,s=i.value,o=null,u=a,h="";if(a==="translate"||a==="translateX"||a==="translate3d"){var f=sf(e)?C1(C1({},e),{"o%":e["%"]}):{"%":e,"o%":e},g=Kg(s).map(function(ne,oe){return oe===0&&"x%"in f?f["%"]=e["x%"]:oe===1&&"y%"in f?f["%"]=e["y%"]:f["%"]=e["o%"],vo(ne,f)}),b=g[0],v=g[1],S=v===void 0?0:v,E=g[2],P=E===void 0?0:E;o=F3,h=[b,S,P]}else if(a==="translateY"){var k=sf(e)?C1({"%":e["y%"]},e):{"%":e},S=vo(s,k);o=F3,h=[0,S,0]}else if(a==="translateZ"){var P=parseFloat(s);o=F3,h=[0,0,P]}else if(a==="scale"||a==="scale3d"){var L=Kg(s).map(function(ne){return parseFloat(ne)}),O=L[0],M=L[1],z=M===void 0?O:M,B=L[2],q=B===void 0?1:B;o=h2,h=[O,z,q]}else if(a==="scaleX"){var O=parseFloat(s);o=h2,h=[O,1,1]}else if(a==="scaleY"){var z=parseFloat(s);o=h2,h=[1,z,1]}else if(a==="scaleZ"){var q=parseFloat(s);o=h2,h=[1,1,q]}else if(a==="rotate"||a==="rotateZ"||a==="rotateX"||a==="rotateY"){var W=Yb(s),G=W.unit,ie=W.value,Q=G==="rad"?ie:ie*Math.PI/180;a==="rotate"||a==="rotateZ"?(u="rotateZ",o=l0e):a==="rotateX"?o=o0e:a==="rotateY"&&(o=s0e),h=Q}else if(a==="matrix3d")o=UB,h=Kg(s).map(function(ne){return parseFloat(ne)});else if(a==="matrix"){var H=Kg(s).map(function(ne){return parseFloat(ne)});o=UB,h=[H[0],H[1],0,0,H[2],H[3],0,0,0,0,1,0,H[4],H[5],0,1]}else u="";return{name:a,functionName:u,value:s,matrixFunction:o,functionValue:h}})}var h0e=(function(){function t(){this.keys=[],this.values=[]}var e=t.prototype;return e.get=function(r){return this.values[this.keys.indexOf(r)]},e.set=function(r,n){var i=this.keys,a=this.values,s=i.indexOf(r),o=s===-1?i.length:s;i[o]=r,a[o]=n},t})(),f0e=(function(){function t(){this.object={}}var e=t.prototype;return e.get=function(r){return this.object[r]},e.set=function(r,n){this.object[r]=n},t})(),d0e=typeof Map=="function",p0e=(function(){function t(){}var e=t.prototype;return e.connect=function(r,n){this.prev=r,this.next=n,r&&(r.next=this),n&&(n.prev=this)},e.disconnect=function(){var r=this.prev,n=this.next;r&&(r.next=n),n&&(n.prev=r)},e.getIndex=function(){for(var r=this,n=-1;r;)r=r.prev,++n;return n},t})();function g0e(t,e){var r=[],n=[];return t.forEach(function(i){var a=i[0],s=i[1],o=new p0e;r[a]=o,n[s]=o}),r.forEach(function(i,a){i.connect(r[a-1])}),t.filter(function(i,a){return!e[a]}).map(function(i,a){var s=i[0],o=i[1];if(s===o)return[0,0];var u=r[s],h=n[o-1],f=u.getIndex();u.disconnect(),h?u.connect(h,h.next):u.connect(void 0,r[0]);var g=u.getIndex();return[f,g]})}var m0e=(function(){function t(r,n,i,a,s,o,u,h){this.prevList=r,this.list=n,this.added=i,this.removed=a,this.changed=s,this.maintained=o,this.changedBeforeAdded=u,this.fixed=h}var e=t.prototype;return Object.defineProperty(e,"ordered",{get:function(){return this.cacheOrdered||this.caculateOrdered(),this.cacheOrdered},enumerable:!0,configurable:!0}),Object.defineProperty(e,"pureChanged",{get:function(){return this.cachePureChanged||this.caculateOrdered(),this.cachePureChanged},enumerable:!0,configurable:!0}),e.caculateOrdered=function(){var r=g0e(this.changedBeforeAdded,this.fixed),n=this.changed,i=[];this.cacheOrdered=r.filter(function(a,s){var o=a[0],u=a[1],h=n[s],f=h[0],g=h[1];if(o!==u)return i.push([f,g]),!0}),this.cachePureChanged=i},t})();function SO(t,e,r){var n=d0e?Map:r?f0e:h0e,i=r||function(L){return L},a=[],s=[],o=[],u=t.map(i),h=e.map(i),f=new n,g=new n,b=[],v=[],S={},E=[],P=0,k=0;return u.forEach(function(L,O){f.set(L,O)}),h.forEach(function(L,O){g.set(L,O)}),u.forEach(function(L,O){var M=g.get(L);typeof M>"u"?(++k,s.push(O)):S[M]=k}),h.forEach(function(L,O){var M=f.get(L);typeof M>"u"?(a.push(O),++P):(o.push([M,O]),k=S[O]||0,b.push([M-k,O-P]),v.push(O===M),M!==O&&E.push([M,O]))}),s.reverse(),new m0e(t,e,a,s,E,o,b,v)}var y0e=(function(){function t(r,n){r===void 0&&(r=[]),this.findKeyCallback=n,this.list=[].slice.call(r)}var e=t.prototype;return e.update=function(r){var n=[].slice.call(r),i=SO(this.list,n,this.findKeyCallback);return this.list=n,i},t})();/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */var QP=function(t,e){return QP=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var i in n)n.hasOwnProperty(i)&&(r[i]=n[i])},QP(t,e)};function v0e(t,e){QP(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}var ZX=typeof Map=="function"?void 0:(function(){var t=0;return function(e){return e.__DIFF_KEY__||(e.__DIFF_KEY__=++t)}})(),KX=(function(t){v0e(e,t);function e(r){return r===void 0&&(r=[]),t.call(this,r,ZX)||this}return e})(y0e);function _0e(t,e){return SO(t,e,ZX)}/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var ek=function(){return ek=Object.assign||function(e){for(var r,n=1,i=arguments.length;n<i;n++){r=arguments[n];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},ek.apply(this,arguments)};function b0e(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;for(var n=Array(t),i=0,e=0;e<r;e++)for(var a=arguments[e],s=0,o=a.length;s<o;s++,i++)n[i]=a[s];return n}var EO=(function(){function t(){this._events={}}var e=t.prototype;return e.on=function(r,n){if(sf(r))for(var i in r)this.on(i,r[i]);else this._addEvent(r,n,{});return this},e.off=function(r,n){if(!r)this._events={};else if(sf(r))for(var i in r)this.off(i);else if(!n)this._events[r]=[];else{var a=this._events[r];if(a){var s=Gd(a,function(o){return o.listener===n});s>-1&&a.splice(s,1)}}return this},e.once=function(r,n){var i=this;return n&&this._addEvent(r,n,{once:!0}),new Promise(function(a){i._addEvent(r,a,{once:!0})})},e.emit=function(r,n){var i=this;n===void 0&&(n={});var a=this._events[r];if(!r||!a)return!0;var s=!1;return n.eventType=r,n.stop=function(){s=!0},n.currentTarget=this,b0e(a).forEach(function(o){o.listener(n),o.once&&i.off(r,o.listener)}),!s},e.trigger=function(r,n){return n===void 0&&(n={}),this.emit(r,n)},e._addEvent=function(r,n,i){var a=this._events;a[r]=a[r]||[];var s=a[r];s.push(ek({listener:n},i))},t})();/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var tk=function(t,e){return tk=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var i in n)n.hasOwnProperty(i)&&(r[i]=n[i])},tk(t,e)};function x0e(t,e){tk(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}var Ev=function(){return Ev=Object.assign||function(e){for(var r,n=1,i=arguments.length;n<i;n++){r=arguments[n];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},Ev.apply(this,arguments)};function w0e(t){var e=t.container;return e===document.body?[e.scrollLeft||document.documentElement.scrollLeft,e.scrollTop||document.documentElement.scrollTop]:[e.scrollLeft,e.scrollTop]}function VB(t,e){return t.addEventListener("scroll",e),function(){t.removeEventListener("scroll",e)}}function f2(t){if(t){if(ep(t))return document.querySelector(t)}else return null;if(gO(t))return t();if(t instanceof Element)return t;if("current"in t)return t.current;if("value"in t)return t.value}var S0e=(function(t){x0e(e,t);function e(){var n=t!==null&&t.apply(this,arguments)||this;return n._startRect=null,n._startPos=[],n._prevTime=0,n._timer=0,n._prevScrollPos=[0,0],n._isWait=!1,n._flag=!1,n._currentOptions=null,n._lock=!1,n._unregister=null,n._onScroll=function(){var i=n._currentOptions;n._lock||!i||n.emit("scrollDrag",{next:function(a){n.checkScroll({container:i.container,inputEvent:a})}})},n}var r=e.prototype;return r.dragStart=function(n,i){var a=f2(i.container);if(!a){this._flag=!1;return}var s=0,o=0,u=0,h=0;if(a===document.body)u=window.innerWidth,h=window.innerHeight;else{var f=a.getBoundingClientRect();s=f.top,o=f.left,u=f.width,h=f.height}this._flag=!0,this._startPos=[n.clientX,n.clientY],this._startRect={top:s,left:o,width:u,height:h},this._prevScrollPos=this._getScrollPosition([0,0],i),this._currentOptions=i,this._registerScrollEvent(i)},r.drag=function(n,i){if(clearTimeout(this._timer),!!this._flag){var a=n.clientX,s=n.clientY,o=i.threshold,u=o===void 0?0:o,h=this,f=h._startRect,g=h._startPos;this._currentOptions=i;var b=[0,0];return f.top>s-u?(g[1]>f.top||s<g[1])&&(b[1]=-1):f.top+f.height<s+u&&(g[1]<f.top+f.height||s>g[1])&&(b[1]=1),f.left>a-u?(g[0]>f.left||a<g[0])&&(b[0]=-1):f.left+f.width<a+u&&(g[0]<f.left+f.width||a>g[0])&&(b[0]=1),!b[0]&&!b[1]?!1:this._continueDrag(Ev(Ev({},i),{direction:b,inputEvent:n,isDrag:!0}))}},r.checkScroll=function(n){var i=this;if(this._isWait)return!1;var a=n.prevScrollPos,s=a===void 0?this._prevScrollPos:a,o=n.direction,u=n.throttleTime,h=u===void 0?0:u,f=n.inputEvent,g=n.isDrag,b=this._getScrollPosition(o||[0,0],n),v=b[0]-s[0],S=b[1]-s[1],E=o||[v?Math.abs(v)/v:0,S?Math.abs(S)/S:0];return this._prevScrollPos=b,this._lock=!1,!v&&!S?!1:(this.emit("move",{offsetX:E[0]?v:0,offsetY:E[1]?S:0,inputEvent:f}),h&&g&&(clearTimeout(this._timer),this._timer=window.setTimeout(function(){i._continueDrag(n)},h)),!0)},r.dragEnd=function(){this._flag=!1,this._lock=!1,clearTimeout(this._timer),this._unregisterScrollEvent()},r._getScrollPosition=function(n,i){var a=i.container,s=i.getScrollPosition,o=s===void 0?w0e:s;return o({container:f2(a),direction:n})},r._continueDrag=function(n){var i=this,a,s=n.container,o=n.direction,u=n.throttleTime,h=n.useScroll,f=n.isDrag,g=n.inputEvent;if(!(!this._flag||f&&this._isWait)){var b=nb(),v=Math.max(u+this._prevTime-b,0);if(v>0)return clearTimeout(this._timer),this._timer=window.setTimeout(function(){i._continueDrag(n)},v),!1;this._prevTime=b;var S=this._getScrollPosition(o,n);this._prevScrollPos=S,f&&(this._isWait=!0),h||(this._lock=!0);var E={container:f2(s),direction:o,inputEvent:g};return(a=n.requestScroll)===null||a===void 0||a.call(n,E),this.emit("scroll",E),this._isWait=!1,h||this.checkScroll(Ev(Ev({},n),{prevScrollPos:S,direction:o,inputEvent:g}))}},r._registerScrollEvent=function(n){this._unregisterScrollEvent();var i=n.checkScrollEvent;if(i){var a=i===!0?VB:i,s=f2(n.container);i===!0&&(s===document.body||s===document.documentElement)?this._unregister=VB(window,this._onScroll):this._unregister=a(s,this._onScroll)}},r._unregisterScrollEvent=function(){var n;(n=this._unregister)===null||n===void 0||n.call(this),this._unregister=null},e})(EO);/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */function E0e(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;for(var n=Array(t),i=0,e=0;e<r;e++)for(var a=arguments[e],s=0,o=a.length;s<o;s++,i++)n[i]=a[s];return n}function mc(t){return Fi(t,gl)}function T0e(t,e){return t.every(function(r,n){return mc(r-e[n])===0})}function C0e(t,e){return!mc(t[0]-e[0])&&!mc(t[1]-e[1])}function JX(t){return t.length<3?0:Math.abs(Zve(t.map(function(e,r){var n=t[r+1]||t[0];return e[0]*n[1]-n[0]*e[1]})))/2}function $B(t,e){var r=e.width,n=e.height,i=e.left,a=e.top,s=bm(t),o=s.minX,u=s.minY,h=s.maxX,f=s.maxY,g=r/(h-o),b=n/(f-u);return t.map(function(v){return[i+(v[0]-o)*g,a+(v[1]-u)*b]})}function bm(t){var e=t.map(function(n){return n[0]}),r=t.map(function(n){return n[1]});return{minX:Math.min.apply(Math,e),minY:Math.min.apply(Math,r),maxX:Math.max.apply(Math,e),maxY:Math.max.apply(Math,r)}}function rk(t,e,r){var n=t[0],i=t[1],a=bm(e),s=a.minX,o=a.maxX,u=[[s,i],[o,i]],h=nS(u[0],u[1]),f=nk(e),g=[];if(f.forEach(function(S){var E=nS(S[0],S[1]),P=S[0];if(T0e(h,E))g.push({pos:t,line:S,type:"line"});else{var k=QX(TO(h,E),[u,S]);k.forEach(function(L){S.some(function(O){return C0e(O,L)})?g.push({pos:L,line:S,type:"point"}):mc(P[1]-i)!==0&&g.push({pos:L,line:S,type:"intersection"})})}}),rh(g,function(S){return S[0]===n}))return!0;var b=0,v={};return g.forEach(function(S){var E=S.pos,P=S.type,k=S.line;if(!(E[0]>n))if(P==="intersection")++b;else{if(P==="line")return;if(P==="point"){var L=rh(k,function(z){return z[1]!==i}),O=v[E[0]],M=L[1]>i?1:-1;O?O!==M&&++b:v[E[0]]=M}}}),b%2===1}function nS(t,e){var r=t[0],n=t[1],i=e[0],a=e[1],s=i-r,o=a-n;Math.abs(s)<gl&&(s=0),Math.abs(o)<gl&&(o=0);var u=0,h=0,f=0;return s?o?(u=-o/s,h=1,f=-u*r-n):(h=1,f=-n):o&&(u=-1,f=r),[u,h,f]}function TO(t,e){var r=t[0],n=t[1],i=t[2],a=e[0],s=e[1],o=e[2],u=r===0&&a===0,h=n===0&&s===0,f=[];if(u&&h)return[];if(u){var g=-i/n,b=-o/s;return g!==b?[]:[[-1/0,g],[1/0,g]]}else if(h){var v=-i/r,S=-o/a;return v!==S?[]:[[v,-1/0],[v,1/0]]}else if(r===0){var E=-i/n,P=-(s*E+o)/a;f=[[P,E]]}else if(a===0){var E=-o/s,P=-(n*E+i)/r;f=[[P,E]]}else if(n===0){var P=-i/r,E=-(a*P+o)/s;f=[[P,E]]}else if(s===0){var P=-o/a,E=-(r*P+i)/n;f=[[P,E]]}else{var P=(n*o-s*i)/(s*r-n*a),E=-(r*P+i)/n;f=[[P,E]]}return f.map(function(k){return[k[0],k[1]]})}function QX(t,e){var r=e.map(function(g){return[0,1].map(function(b){return[Math.min(g[0][b],g[1][b]),Math.max(g[0][b],g[1][b])]})}),n=[];if(t.length===2){var i=t[0],a=i[0],s=i[1];if(mc(a-t[1][0])){if(!mc(s-t[1][1])){var h=Math.max.apply(Math,r.map(function(g){return g[0][0]})),f=Math.min.apply(Math,r.map(function(g){return g[0][1]}));if(mc(h-f)>0)return[];n=[[h,s],[f,s]]}}else{var o=Math.max.apply(Math,r.map(function(g){return g[1][0]})),u=Math.min.apply(Math,r.map(function(g){return g[1][1]}));if(mc(o-u)>0)return[];n=[[a,o],[a,u]]}}return n.length||(n=t.filter(function(g){var b=g[0],v=g[1];return r.every(function(S){return 0<=mc(b-S[0][0])&&0<=mc(S[0][1]-b)&&0<=mc(v-S[1][0])&&0<=mc(S[1][1]-v)})})),n.map(function(g){return[mc(g[0]),mc(g[1])]})}function nk(t){return E0e(t.slice(1),[t[0]]).map(function(e,r){return[t[r],e]})}function A0e(t,e){var r=t.slice(),n=e.slice();zB(r)===-1&&r.reverse(),zB(n)===-1&&n.reverse();var i=nk(r),a=nk(n),s=i.map(function(f){return nS(f[0],f[1])}),o=a.map(function(f){return nS(f[0],f[1])}),u=[];s.forEach(function(f,g){var b=i[g],v=[];o.forEach(function(S,E){var P=TO(f,S),k=QX(P,[b,a[E]]);v.push.apply(v,k.map(function(L){return{index1:g,index2:E,pos:L,type:"intersection"}}))}),v.sort(function(S,E){return zd(b[0],S.pos)-zd(b[0],E.pos)}),u.push.apply(u,v),rk(b[1],n)&&u.push({index1:g,index2:-1,pos:b[1],type:"inside"})}),a.forEach(function(f,g){if(rk(f[1],r)){var b=!1,v=Gd(u,function(S){var E=S.index2;return E===g?(b=!0,!1):!!b});v===-1&&(b=!1,v=Gd(u,function(S){var E=S.index1,P=S.index2;return E===-1&&P+1===g?(b=!0,!1):!!b})),v===-1?u.push({index1:-1,index2:g,pos:f[1],type:"inside"}):u.splice(v,0,{index1:-1,index2:g,pos:f[1],type:"inside"})}});var h={};return u.filter(function(f){var g=f.pos,b=g[0]+"x"+g[1];return h[b]?!1:(h[b]=!0,!0)})}function I0e(t,e){var r=A0e(t,e);return r.map(function(n){var i=n.pos;return i})}function P0e(t,e){var r=I0e(t,e);return JX(r)}/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var ik=function(t,e){return ik=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var i in n)n.hasOwnProperty(i)&&(r[i]=n[i])},ik(t,e)};function k0e(t,e){ik(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}var fl=function(){return fl=Object.assign||function(e){for(var r,n=1,i=arguments.length;n<i;n++){r=arguments[n];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},fl.apply(this,arguments)};function M0e(t,e){var r=e[0]-t[0],n=e[1]-t[1],i=Math.atan2(n,r);return i>=0?i:i+Math.PI*2}function B3(t){return M0e([t[0].clientX,t[0].clientY],[t[1].clientX,t[1].clientY])/Math.PI*180}function R0e(t){return t.touches&&t.touches.length>=2}function d2(t){return t?t.touches?L0e(t.touches):[eY(t)]:[]}function O0e(t){return t&&(t.type.indexOf("mouse")>-1||"button"in t)}function qB(t,e,r){var n=r.length,i=A1(t,n),a=i.clientX,s=i.clientY,o=i.originalClientX,u=i.originalClientY,h=A1(e,n),f=h.clientX,g=h.clientY,b=A1(r,n),v=b.clientX,S=b.clientY,E=a-f,P=s-g,k=a-v,L=s-S;return{clientX:o,clientY:u,deltaX:E,deltaY:P,distX:k,distY:L}}function z3(t){return Math.sqrt(Math.pow(t[0].clientX-t[1].clientX,2)+Math.pow(t[0].clientY-t[1].clientY,2))}function L0e(t){for(var e=Math.min(t.length,2),r=[],n=0;n<e;++n)r.push(eY(t[n]));return r}function eY(t){return{clientX:t.clientX,clientY:t.clientY}}function A1(t,e){e===void 0&&(e=t.length);for(var r={clientX:0,clientY:0,originalClientX:0,originalClientY:0},n=Math.min(t.length,e),i=0;i<n;++i){var a=t[i];r.originalClientX+="originalClientX"in a?a.originalClientX:a.clientX,r.originalClientY+="originalClientY"in a?a.originalClientY:a.clientY,r.clientX+=a.clientX,r.clientY+=a.clientY}return e?{clientX:r.clientX/e,clientY:r.clientY/e,originalClientX:r.originalClientX/e,originalClientY:r.originalClientY/e}:r}var j3=(function(){function t(e){this.prevClients=[],this.startClients=[],this.movement=0,this.length=0,this.startClients=e,this.prevClients=e,this.length=e.length}return t.prototype.getAngle=function(e){return e===void 0&&(e=this.prevClients),B3(e)},t.prototype.getRotation=function(e){return e===void 0&&(e=this.prevClients),B3(e)-B3(this.startClients)},t.prototype.getPosition=function(e,r){e===void 0&&(e=this.prevClients);var n=qB(e||this.prevClients,this.prevClients,this.startClients),i=n.deltaX,a=n.deltaY;return this.movement+=Math.sqrt(i*i+a*a),this.prevClients=e,n},t.prototype.getPositions=function(e){e===void 0&&(e=this.prevClients);for(var r=this.prevClients,n=this.startClients,i=Math.min(this.length,r.length),a=[],s=0;s<i;++s)a[s]=qB([e[s]],[r[s]],[n[s]]);return a},t.prototype.getMovement=function(e){var r=this.movement;if(!e)return r;var n=A1(e,this.length),i=A1(this.prevClients,this.length),a=n.clientX-i.clientX,s=n.clientY-i.clientY;return Math.sqrt(a*a+s*s)+r},t.prototype.getDistance=function(e){return e===void 0&&(e=this.prevClients),z3(e)},t.prototype.getScale=function(e){return e===void 0&&(e=this.prevClients),z3(e)/z3(this.startClients)},t.prototype.move=function(e,r){this.startClients.forEach(function(n){n.clientX-=e,n.clientY-=r}),this.prevClients.forEach(function(n){n.clientX-=e,n.clientY-=r})},t})(),HB=["textarea","input"],N0e=(function(t){k0e(e,t);function e(r,n){n===void 0&&(n={});var i=t.call(this)||this;i.options={},i.flag=!1,i.pinchFlag=!1,i.data={},i.isDrag=!1,i.isPinch=!1,i.clientStores=[],i.targets=[],i.prevTime=0,i.doubleFlag=!1,i._useMouse=!1,i._useTouch=!1,i._useDrag=!1,i._dragFlag=!1,i._isTrusted=!1,i._isMouseEvent=!1,i._isSecondaryButton=!1,i._preventMouseEvent=!1,i._prevInputEvent=null,i._isDragAPI=!1,i._isIdle=!0,i._preventMouseEventId=0,i._window=window,i.onDragStart=function(b,v){if(v===void 0&&(v=!0),!(!i.flag&&b.cancelable===!1)){var S=b.type.indexOf("drag")>=-1;if(!(i.flag&&S)){i._isDragAPI=!0;var E=i.options,P=E.container,k=E.pinchOutside,L=E.preventWheelClick,O=E.preventRightClick,M=E.preventDefault,z=E.checkInput,B=E.dragFocusedInput,q=E.preventClickEventOnDragStart,W=E.preventClickEventOnDrag,G=E.preventClickEventByCondition,ie=i._useTouch,Q=!i.flag;if(i._isSecondaryButton=b.which===3||b.button===2,L&&(b.which===2||b.button===1)||O&&(b.which===3||b.button===2))return i.stop(),!1;if(Q){var H=i._window.document.activeElement,ne=b.target;if(ne){var oe=ne.tagName.toLowerCase(),ce=HB.indexOf(oe)>-1,fe=ne.isContentEditable;if(ce||fe){if(z||!B&&H===ne)return!1;if(H&&(H===ne||fe&&H.isContentEditable&&H.contains(ne)))if(B)ne.blur();else return!1}else if((M||b.type==="touchstart")&&H){var Me=H.tagName.toLowerCase();(H.isContentEditable||HB.indexOf(Me)>-1)&&H.blur()}(q||W||G)&&Lu(i._window,"click",i._onClick,!0)}i.clientStores=[new j3(d2(b))],i._isIdle=!1,i.flag=!0,i.isDrag=!1,i._isTrusted=v,i._dragFlag=!0,i._prevInputEvent=b,i.data={},i.doubleFlag=nb()-i.prevTime<200,i._isMouseEvent=O0e(b),!i._isMouseEvent&&i._preventMouseEvent&&i._allowMouseEvent();var me=i._preventMouseEvent||i.emit("dragStart",fl(fl({data:i.data,datas:i.data,inputEvent:b,isMouseEvent:i._isMouseEvent,isSecondaryButton:i._isSecondaryButton,isTrusted:v,isDouble:i.doubleFlag},i.getCurrentStore().getPosition()),{preventDefault:function(){b.preventDefault()},preventDrag:function(){i._dragFlag=!1}}));me===!1&&i.stop(),i._isMouseEvent&&i.flag&&M&&b.preventDefault()}if(!i.flag)return!1;var we=0;if(Q?(i._attchDragEvent(),ie&&k&&(we=setTimeout(function(){Lu(P,"touchstart",i.onDragStart,{passive:!1})}))):ie&&k&&hu(P,"touchstart",i.onDragStart),i.flag&&R0e(b)){if(clearTimeout(we),Q&&b.touches.length!==b.changedTouches.length)return;i.pinchFlag||i.onPinchStart(b)}}}},i.onDrag=function(b,v){if(i.flag){var S=i.options.preventDefault;!i._isMouseEvent&&S&&b.preventDefault(),i._prevInputEvent=b;var E=d2(b),P=i.moveClients(E,b,!1);if(i._dragFlag){if(i.pinchFlag||P.deltaX||P.deltaY){var k=i._preventMouseEvent||i.emit("drag",fl(fl({},P),{isScroll:!!v,inputEvent:b}));if(k===!1){i.stop();return}}i.pinchFlag&&i.onPinch(b,E)}i.getCurrentStore().getPosition(E,!0)}},i.onDragEnd=function(b){if(i.flag){var v=i.options,S=v.pinchOutside,E=v.container,P=v.preventClickEventOnDrag,k=v.preventClickEventOnDragStart,L=v.preventClickEventByCondition,O=i.isDrag;(P||k||L)&&requestAnimationFrame(function(){i._allowClickEvent()}),!L&&!k&&P&&!O&&i._allowClickEvent(),i._useTouch&&S&&hu(E,"touchstart",i.onDragStart),i.pinchFlag&&i.onPinchEnd(b);var M=b?.touches?d2(b):[],z=M.length;z===0||!i.options.keepDragging?i.flag=!1:i._addStore(new j3(M));var B=i._getPosition(),q=nb(),W=!O&&i.doubleFlag;i._prevInputEvent=null,i.prevTime=O||W?0:q,i.flag||(i._dettachDragEvent(),i._preventMouseEvent||i.emit("dragEnd",fl({data:i.data,datas:i.data,isDouble:W,isDrag:O,isClick:!O,isMouseEvent:i._isMouseEvent,isSecondaryButton:i._isSecondaryButton,inputEvent:b,isTrusted:i._isTrusted},B)),i.clientStores=[],i._isMouseEvent||(i._preventMouseEvent=!0,clearTimeout(i._preventMouseEventId),i._preventMouseEventId=setTimeout(function(){i._preventMouseEvent=!1},200)),i._isIdle=!0)}},i.onBlur=function(){i.onDragEnd()},i._allowClickEvent=function(){hu(i._window,"click",i._onClick,!0)},i._onClick=function(b){i._allowClickEvent(),i._allowMouseEvent();var v=i.options.preventClickEventByCondition;v?.(b)||(b.stopPropagation(),b.preventDefault())},i._onContextMenu=function(b){var v=i.options;v.preventRightClick?i.onDragEnd(b):b.preventDefault()},i._passCallback=function(){};var a=[].concat(r),s=a[0];i._window=WX(s)?s:Hp(s),i.options=fl({checkInput:!1,container:s&&!("document"in s)?Hp(s):s,preventRightClick:!0,preventWheelClick:!0,preventClickEventOnDragStart:!1,preventClickEventOnDrag:!1,preventClickEventByCondition:null,preventDefault:!0,checkWindowBlur:!1,keepDragging:!1,pinchThreshold:0,events:["touch","mouse"]},n);var o=i.options,u=o.container,h=o.events,f=o.checkWindowBlur;if(i._useDrag=h.indexOf("drag")>-1,i._useTouch=h.indexOf("touch")>-1,i._useMouse=h.indexOf("mouse")>-1,i.targets=a,i._useDrag&&a.forEach(function(b){Lu(b,"dragstart",i.onDragStart)}),i._useMouse&&(a.forEach(function(b){Lu(b,"mousedown",i.onDragStart),Lu(b,"mousemove",i._passCallback)}),Lu(u,"contextmenu",i._onContextMenu)),f&&Lu(Hp(),"blur",i.onBlur),i._useTouch){var g={passive:!1};a.forEach(function(b){Lu(b,"touchstart",i.onDragStart,g),Lu(b,"touchmove",i._passCallback,g)})}return i}return e.prototype.stop=function(){this.isDrag=!1,this.data={},this.clientStores=[],this.pinchFlag=!1,this.doubleFlag=!1,this.prevTime=0,this.flag=!1,this._isIdle=!0,this._allowClickEvent(),this._dettachDragEvent(),this._isDragAPI=!1},e.prototype.getMovement=function(r){return this.getCurrentStore().getMovement(r)+this.clientStores.slice(1).reduce(function(n,i){return n+i.movement},0)},e.prototype.isDragging=function(){return this.isDrag},e.prototype.isIdle=function(){return this._isIdle},e.prototype.isFlag=function(){return this.flag},e.prototype.isPinchFlag=function(){return this.pinchFlag},e.prototype.isDoubleFlag=function(){return this.doubleFlag},e.prototype.isPinching=function(){return this.isPinch},e.prototype.scrollBy=function(r,n,i,a){a===void 0&&(a=!0),this.flag&&(this.clientStores[0].move(r,n),a&&this.onDrag(i,!0))},e.prototype.move=function(r,n){var i=r[0],a=r[1],s=this.getCurrentStore(),o=s.prevClients;return this.moveClients(o.map(function(u){var h=u.clientX,f=u.clientY;return{clientX:h+i,clientY:f+a,originalClientX:h,originalClientY:f}}),n,!0)},e.prototype.triggerDragStart=function(r){this.onDragStart(r,!1)},e.prototype.setEventData=function(r){var n=this.data;for(var i in r)n[i]=r[i];return this},e.prototype.setEventDatas=function(r){return this.setEventData(r)},e.prototype.getCurrentEvent=function(r){return r===void 0&&(r=this._prevInputEvent),fl(fl({data:this.data,datas:this.data},this._getPosition()),{movement:this.getMovement(),isDrag:this.isDrag,isPinch:this.isPinch,isScroll:!1,inputEvent:r})},e.prototype.getEventData=function(){return this.data},e.prototype.getEventDatas=function(){return this.data},e.prototype.unset=function(){var r=this,n=this.targets,i=this.options.container;this.off(),hu(this._window,"blur",this.onBlur),this._useDrag&&n.forEach(function(a){hu(a,"dragstart",r.onDragStart)}),this._useMouse&&(n.forEach(function(a){hu(a,"mousedown",r.onDragStart)}),hu(i,"contextmenu",this._onContextMenu)),this._useTouch&&(n.forEach(function(a){hu(a,"touchstart",r.onDragStart)}),hu(i,"touchstart",this.onDragStart)),this._prevInputEvent=null,this._allowClickEvent(),this._dettachDragEvent()},e.prototype.onPinchStart=function(r){var n=this,i=this.options.pinchThreshold;if(!(this.isDrag&&this.getMovement()>i)){var a=new j3(d2(r));this.pinchFlag=!0,this._addStore(a);var s=this.emit("pinchStart",fl(fl({data:this.data,datas:this.data,angle:a.getAngle(),touches:this.getCurrentStore().getPositions()},a.getPosition()),{inputEvent:r,isTrusted:this._isTrusted,preventDefault:function(){r.preventDefault()},preventDrag:function(){n._dragFlag=!1}}));s===!1&&(this.pinchFlag=!1)}},e.prototype.onPinch=function(r,n){if(!(!this.flag||!this.pinchFlag||n.length<2)){var i=this.getCurrentStore();this.isPinch=!0,this.emit("pinch",fl(fl({data:this.data,datas:this.data,movement:this.getMovement(n),angle:i.getAngle(n),rotation:i.getRotation(n),touches:i.getPositions(n),scale:i.getScale(n),distance:i.getDistance(n)},i.getPosition(n)),{inputEvent:r,isTrusted:this._isTrusted}))}},e.prototype.onPinchEnd=function(r){if(this.pinchFlag){var n=this.isPinch;this.isPinch=!1,this.pinchFlag=!1;var i=this.getCurrentStore();this.emit("pinchEnd",fl(fl({data:this.data,datas:this.data,isPinch:n,touches:i.getPositions()},i.getPosition()),{inputEvent:r}))}},e.prototype.getCurrentStore=function(){return this.clientStores[0]},e.prototype.moveClients=function(r,n,i){var a=this._getPosition(r,i),s=this.isDrag;(a.deltaX||a.deltaY)&&(this.isDrag=!0);var o=!1;return!s&&this.isDrag&&(o=!0),fl(fl({data:this.data,datas:this.data},a),{movement:this.getMovement(r),isDrag:this.isDrag,isPinch:this.isPinch,isScroll:!1,isMouseEvent:this._isMouseEvent,isSecondaryButton:this._isSecondaryButton,inputEvent:n,isTrusted:this._isTrusted,isFirstDrag:o})},e.prototype._addStore=function(r){this.clientStores.splice(0,0,r)},e.prototype._getPosition=function(r,n){var i=this.getCurrentStore(),a=i.getPosition(r,n),s=this.clientStores.slice(1).reduce(function(h,f){var g=f.getPosition();return h.distX+=g.distX,h.distY+=g.distY,h},a),o=s.distX,u=s.distY;return fl(fl({},a),{distX:o,distY:u})},e.prototype._attchDragEvent=function(){var r=this._window,n=this.options.container,i={passive:!1};this._isDragAPI&&(Lu(n,"dragover",this.onDrag,i),Lu(r,"dragend",this.onDragEnd)),this._useMouse&&(Lu(n,"mousemove",this.onDrag),Lu(r,"mouseup",this.onDragEnd)),this._useTouch&&(Lu(n,"touchmove",this.onDrag,i),Lu(r,"touchend",this.onDragEnd,i),Lu(r,"touchcancel",this.onDragEnd,i))},e.prototype._dettachDragEvent=function(){var r=this._window,n=this.options.container;this._isDragAPI&&(hu(n,"dragover",this.onDrag),hu(r,"dragend",this.onDragEnd)),this._useMouse&&(hu(n,"mousemove",this.onDrag),hu(r,"mouseup",this.onDragEnd)),this._useTouch&&(hu(n,"touchstart",this.onDragStart),hu(n,"touchmove",this.onDrag),hu(r,"touchend",this.onDragEnd),hu(r,"touchcancel",this.onDragEnd))},e.prototype._allowMouseEvent=function(){this._preventMouseEvent=!1,clearTimeout(this._preventMouseEventId)},e})(EO);function D0e(t){for(var e=5381,r=t.length;r;)e=e*33^t.charCodeAt(--r);return e>>>0}var F0e=D0e;function B0e(t){return F0e(t).toString(36)}function z0e(t){if(t&&t.getRootNode){var e=t.getRootNode();if(e.nodeType===11)return e}}function j0e(t,e,r){return r.original?e:e.replace(/([^};{\s}][^};{]*|^\s*){/mg,function(n,i){var a=i.trim();return(a?Kg(a):[""]).map(function(s){var o=s.trim();return o.indexOf("@")===0?o:o.indexOf(":global")>-1?o.replace(/\:global/g,""):o.indexOf(":host")>-1?"".concat(o.replace(/\:host/g,".".concat(t))):o?".".concat(t," ").concat(o):".".concat(t)}).join(", ")+" {"})}function U0e(t,e,r,n,i){var a=vO(n),s=a.createElement("style");return s.setAttribute("type","text/css"),s.setAttribute("data-styled-id",t),s.setAttribute("data-styled-count","1"),r.nonce&&s.setAttribute("nonce",r.nonce),s.innerHTML=j0e(t,e,r),(i||a.head||a.body).appendChild(s),s}function V0e(t){var e="rCS"+B0e(t);return{className:e,inject:function(r,n){n===void 0&&(n={});var i=z0e(r),a=(i||r.ownerDocument||document).querySelector('style[data-styled-id="'.concat(e,'"]'));if(!a)a=U0e(e,t,n,r,i);else{var s=parseFloat(a.getAttribute("data-styled-count"))||0;a.setAttribute("data-styled-count","".concat(s+1))}return{destroy:function(){var o,u=parseFloat(a.getAttribute("data-styled-count"))||0;u<=1?(a.remove?a.remove():(o=a.parentNode)===null||o===void 0||o.removeChild(a),a=null):a.setAttribute("data-styled-count","".concat(u-1))}}}}}var ak=function(){return ak=Object.assign||function(e){for(var r,n=1,i=arguments.length;n<i;n++){r=arguments[n];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},ak.apply(this,arguments)};function $0e(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(t);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(r[n[i]]=t[n[i]]);return r}function tY(t,e){var r=V0e(e),n=r.className;return ee.forwardRef(function(i,a){var s=i.className,o=s===void 0?"":s;i.cspNonce;var u=$0e(i,["className","cspNonce"]),h=ee.useRef();return ee.useImperativeHandle(a,function(){return h.current},[]),ee.useEffect(function(){var f=r.inject(h.current,{nonce:i.cspNonce});return function(){f.destroy()}},[]),ee.createElement(t,ak({ref:h,"data-styled-id":n,className:"".concat(o," ").concat(n)},u))})}var ok=function(t,e){return ok=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(r[i]=n[i])},ok(t,e)};function Jb(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");ok(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}var zt=function(){return zt=Object.assign||function(e){for(var r,n=1,i=arguments.length;n<i;n++){r=arguments[n];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},zt.apply(this,arguments)};function q0e(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(t);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(r[n[i]]=t[n[i]]);return r}function H0e(t,e,r,n){var i=arguments.length,a=i<3?e:n,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(t,e,r,n);else for(var o=t.length-1;o>=0;o--)(s=t[o])&&(a=(i<3?s(a):i>3?s(e,r,a):s(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a}function W0e(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Ht(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var n=r.call(t),i,a=[],s;try{for(;(e===void 0||e-- >0)&&!(i=n.next()).done;)a.push(i.value)}catch(o){s={error:o}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(s)throw s.error}}return a}function vn(t,e,r){if(arguments.length===2)for(var n=0,i=e.length,a;n<i;n++)(a||!(n in e))&&(a||(a=Array.prototype.slice.call(e,0,n)),a[n]=e[n]);return t.concat(a||Array.prototype.slice.call(e))}function Qb(t,e){return zt({events:[],props:[],name:t},e)}var G0e=["n","w","s","e"],CO=["n","w","s","e","nw","ne","sw","se"];function X0e(t,e){return'data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="'.concat(32*t,'px" height="').concat(32*t,'px" viewBox="0 0 32 32" ><path d="M 16,5 L 12,10 L 14.5,10 L 14.5,22 L 12,22 L 16,27 L 20,22 L 17.5,22 L 17.5,10 L 20, 10 L 16,5 Z" stroke-linejoin="round" stroke-width="1.2" fill="black" stroke="white" style="transform:rotate(').concat(e,'deg);transform-origin: 16px 16px"></path></svg>')}function Y0e(t){var e=X0e(1,t),r=Math.round(t/45)*45%180,n="ns-resize";return r===135?n="nwse-resize":r===45?n="nesw-resize":r===90&&(n="ew-resize"),"cursor:".concat(n,";cursor: url('").concat(e,"') 16 16, ").concat(n,";")}var L0=Nve(),rY=L0.browser.webkit,nY=rY&&(function(){var t=typeof window>"u"?{userAgent:""}:window.navigator,e=/applewebkit\/([^\s]+)/g.exec(t.userAgent.toLowerCase());return e?parseFloat(e[1])<605:!1})(),iY=L0.browser.name,aY=parseInt(L0.browser.version,10),Z0e=iY==="chrome",K0e=L0.browser.chromium,J0e=parseInt(L0.browser.chromiumVersion,10)||0,Q0e=Z0e&&aY>=109||K0e&&J0e>=109,e_e=iY==="firefox",t_e=parseInt(L0.browser.webkitVersion,10)>=612||aY>=15,AO="moveable-",r_e=CO.map(function(t){var e="",r="",n="center",i="center",a="calc(var(--moveable-control-padding, 20) * -1px)";return t.indexOf("n")>-1&&(e="top: ".concat(a,";"),i="bottom"),t.indexOf("s")>-1&&(e="top: 0px;",i="top"),t.indexOf("w")>-1&&(r="left: ".concat(a,";"),n="right"),t.indexOf("e")>-1&&(r="left: 0px;",n="left"),'.around-control[data-direction*="'.concat(t,`"] {
        `).concat(r).concat(e,`
        transform-origin: `).concat(n," ").concat(i,`;
    }`)}).join(`
`),n_e=`
{
position: absolute;
width: 1px;
height: 1px;
left: 0;
top: 0;
z-index: 3000;
--moveable-color: #4af;
--zoom: 1;
--zoompx: 1px;
--moveable-line-padding: 0;
--moveable-control-padding: 0;
will-change: transform;
outline: 1px solid transparent;
}
.control-box {
z-index: 0;
}
.line, .control {
position: absolute;
left: 0;
top: 0;
will-change: transform;
}
.control {
width: 14px;
height: 14px;
border-radius: 50%;
border: 2px solid #fff;
box-sizing: border-box;
background: #4af;
background: var(--moveable-color);
margin-top: -7px;
margin-left: -7px;
border: 2px solid #fff;
z-index: 10;
}
.around-control {
position: absolute;
will-change: transform;
width: calc(var(--moveable-control-padding, 20) * 1px);
height: calc(var(--moveable-control-padding, 20) * 1px);
left: calc(var(--moveable-control-padding, 20) * -0.5px);
top: calc(var(--moveable-control-padding, 20) * -0.5px);
box-sizing: border-box;
background: transparent;
z-index: 8;
cursor: alias;
transform-origin: center center;
}
`.concat(r_e,`
.padding {
position: absolute;
top: 0px;
left: 0px;
width: 100px;
height: 100px;
transform-origin: 0 0;
}
.line {
width: 1px;
height: 1px;
background: #4af;
background: var(--moveable-color);
transform-origin: 0px 50%;
}
.line.edge {
z-index: 1;
background: transparent;
}
.line.dashed {
box-sizing: border-box;
background: transparent;
}
.line.dashed.horizontal {
border-top: 1px dashed #4af;
border-top-color: #4af;
border-top-color: var(--moveable-color);
}
.line.dashed.vertical {
border-left: 1px dashed #4af;
border-left-color: #4af;
border-left-color: var(--moveable-color);
}
.line.vertical {
transform: translateX(-50%);
}
.line.horizontal {
transform: translateY(-50%);
}
.line.vertical.bold {
width: 2px;
}
.line.horizontal.bold {
height: 2px;
}

.control.origin {
border-color: #f55;
background: #fff;
width: 12px;
height: 12px;
margin-top: -6px;
margin-left: -6px;
pointer-events: none;
}
`).concat([0,15,30,45,60,75,90,105,120,135,150,165].map(function(t){return`
.direction[data-rotation="`.concat(t,'"], :global .view-control-rotation').concat(t,` {
`).concat(Y0e(t),`
}
`)}).join(`
`),`

.line.direction:before {
content: "";
position: absolute;
width: 100%;
height: calc(var(--moveable-line-padding, 0) * 1px);
bottom: 0;
left: 0;
}
.group {
z-index: -1;
}
.area {
position: absolute;
}
.area-pieces {
position: absolute;
top: 0;
left: 0;
display: none;
}
.area.avoid, .area.pass {
pointer-events: none;
}
.area.avoid+.area-pieces {
display: block;
}
.area-piece {
position: absolute;
}

`).concat(nY?`:global svg *:before {
content:"";
transform-origin: inherit;
}`:"",`
`),i_e=[[0,1,2],[1,0,3],[2,0,3],[3,1,2]],sk=1e-4,lc=1e-7,p2=1e-9,lk=Math.pow(10,10),WB=-lk,a_e={n:[0,-1],e:[1,0],s:[0,1],w:[-1,0],nw:[-1,-1],ne:[1,-1],sw:[-1,1],se:[1,1]},IO={n:[0,1],e:[1,3],s:[3,2],w:[2,0],nw:[0],ne:[1],sw:[2],se:[3]},oY={n:0,s:180,w:270,e:90,nw:315,ne:45,sw:225,se:135},o_e=["isMoveableElement","updateRect","updateTarget","destroy","dragStart","isInside","hitTest","setState","getRect","request","isDragging","getManager","forceUpdate","waitToChangeTarget","updateSelectors","getTargets","stopDrag","getControlBoxElement","getMoveables","getDragElement"];function ex(t,e,r,n,i,a){var s,o;a===void 0&&(a="draggable");var u=(o=(s=e.gestos[a])===null||s===void 0?void 0:s.move(r,t.inputEvent))!==null&&o!==void 0?o:{},h=u.originalDatas||u.datas,f=h[a]||(h[a]={});return zt(zt({},u),{isPinch:!!n,parentEvent:!0,datas:f,originalDatas:t.originalDatas})}var o0=(function(){function t(e){var r;e===void 0&&(e="draggable"),this.ableName=e,this.prevX=0,this.prevY=0,this.startX=0,this.startY=0,this.isDrag=!1,this.isFlag=!1,this.datas={draggable:{}},this.datas=(r={},r[e]={},r)}return t.prototype.dragStart=function(e,r){this.isDrag=!1,this.isFlag=!1;var n=r.originalDatas;return this.datas=n,n[this.ableName]||(n[this.ableName]={}),zt(zt({},this.move(e,r.inputEvent)),{type:"dragstart"})},t.prototype.drag=function(e,r){return this.move([e[0]-this.prevX,e[1]-this.prevY],r)},t.prototype.move=function(e,r){var n,i,a=!1;if(!this.isFlag)this.prevX=e[0],this.prevY=e[1],this.startX=e[0],this.startY=e[1],n=e[0],i=e[1],this.isFlag=!0;else{var s=this.isDrag;n=this.prevX+e[0],i=this.prevY+e[1],(e[0]||e[1])&&(this.isDrag=!0),!s&&this.isDrag&&(a=!0)}return this.prevX=n,this.prevY=i,{type:"drag",clientX:n,clientY:i,inputEvent:r,isFirstDrag:a,isDrag:this.isDrag,distX:n-this.startX,distY:i-this.startY,deltaX:e[0],deltaY:e[1],datas:this.datas[this.ableName],originalDatas:this.datas,parentEvent:!0,parentGesto:this}},t})();function Hv(t,e,r,n){var i=t.length===16,a=i?4:3,s=Vm(t,r,n,a),o=Ht(s,4),u=Ht(o[0],2),h=u[0],f=u[1],g=Ht(o[1],2),b=g[0],v=g[1],S=Ht(o[2],2),E=S[0],P=S[1],k=Ht(o[3],2),L=k[0],O=k[1],M=Ht(gs(t,e,a),2),z=M[0],B=M[1],q=Math.min(h,b,E,L),W=Math.min(f,v,P,O),G=Math.max(h,b,E,L),ie=Math.max(f,v,P,O);h=h-q||0,b=b-q||0,E=E-q||0,L=L-q||0,f=f-W||0,v=v-W||0,P=P-W||0,O=O-W||0,z=z-q||0,B=B-W||0;var Q=t[0],H=t[a+1],ne=ac(Q*H);return{left:q,top:W,right:G,bottom:ie,origin:[z,B],pos1:[h,f],pos2:[b,v],pos3:[E,P],pos4:[L,O],direction:ne}}function sY(t,e){var r=e.clientX,n=e.clientY,i=e.datas,a=t.state,s=a.moveableClientRect,o=a.rootMatrix,u=a.is3d,h=a.pos1,f=s.left,g=s.top,b=u?4:3,v=Ht(vi(u0(o,[r-f,n-g],b),h),2),S=v[0],E=v[1],P=Ht(ud({datas:i,distX:S,distY:E}),2),k=P[0],L=P[1];return[k,L]}function Um(t,e){var r=e.datas,n=t.state,i=n.allMatrix,a=n.beforeMatrix,s=n.is3d,o=n.left,u=n.top,h=n.origin,f=n.offsetMatrix,g=n.targetMatrix,b=n.transformOrigin,v=s?4:3;r.is3d=s,r.matrix=i,r.targetMatrix=g,r.beforeMatrix=a,r.offsetMatrix=f,r.transformOrigin=b,r.inverseMatrix=rd(i,v),r.inverseBeforeMatrix=rd(a,v),r.absoluteOrigin=vm(Aa([o,u],h),v),r.startDragBeforeDist=qu(r.inverseBeforeMatrix,r.absoluteOrigin,v),r.startDragDist=qu(r.inverseMatrix,r.absoluteOrigin,v)}function s_e(t){return Hv(t.datas.beforeTransform,[50,50],100,100).direction}function oT(t,e,r){var n=e.datas,i=e.originalDatas.beforeRenderable,a=n.transformIndex,s=i.nextTransforms,o=s.length,u=i.nextTransformAppendedIndexes,h=-1;a===-1?(r==="translate"?h=0:r==="rotate"&&(h=Gd(s,function(v){return v.match(/scale\(/g)})),h===-1&&(h=s.length),n.transformIndex=h):rh(u,function(v){return v.index===a&&v.functionName===r})?h=a:h=a+u.filter(function(v){return v.index<a}).length;var f=O1e(s,t.state,h),g=f.targetFunction,b=r==="rotate"?"rotateZ":r;n.beforeFunctionTexts=f.beforeFunctionTexts,n.afterFunctionTexts=f.afterFunctionTexts,n.beforeTransform=f.beforeFunctionMatrix,n.beforeTransform2=f.beforeFunctionMatrix2,n.targetTansform=f.targetFunctionMatrix,n.afterTransform=f.afterFunctionMatrix,n.afterTransform2=f.afterFunctionMatrix2,n.targetAllTransform=f.allFunctionMatrix,g.functionName===b?(n.afterFunctionTexts.splice(0,1),n.isAppendTransform=!1):o>h&&(n.isAppendTransform=!0,i.nextTransformAppendedIndexes=vn(vn([],Ht(u),!1),[{functionName:r,index:h,isAppend:!0}],!1))}function sT(t,e,r){return"".concat(t.beforeFunctionTexts.join(" ")," ").concat(t.isAppendTransform?r:e," ").concat(t.afterFunctionTexts.join(" "))}function l_e(t){var e=t.datas,r=t.distX,n=t.distY,i=Ht(uY({datas:e,distX:r,distY:n}),2),a=i[0],s=i[1],o=lY(e,i0e([a,s],4));return qu(o,vm([0,0,0],4),4)}function lY(t,e,r){var n=t.beforeTransform,i=t.afterTransform,a=t.beforeTransform2,s=t.afterTransform2,o=t.targetAllTransform,u=r?_o(o,e,4):_o(e,o,4),h=_o(rd(r?a:n,4),u,4),f=_o(h,rd(r?s:i,4),4);return f}function uY(t){var e=t.datas,r=t.distX,n=t.distY,i=e.inverseBeforeMatrix,a=e.is3d,s=e.startDragBeforeDist,o=e.absoluteOrigin,u=a?4:3;return vi(qu(i,Aa(o,[r,n]),u),s)}function ud(t,e){var r=t.datas,n=t.distX,i=t.distY,a=r.inverseBeforeMatrix,s=r.inverseMatrix,o=r.is3d,u=r.startDragBeforeDist,h=r.startDragDist,f=r.absoluteOrigin,g=o?4:3;return vi(qu(e?a:s,Aa(f,[n,i]),g),e?u:h)}function u_e(t,e){var r=t.datas,n=t.distX,i=t.distY;r.beforeMatrix;var a=r.matrix,s=r.is3d;r.startDragBeforeDist;var o=r.startDragDist,u=r.absoluteOrigin,h=s?4:3;return vi(qu(a,Aa(o,[n,i]),h),u)}function c_e(t,e,r,n,i,a){return n===void 0&&(n=e),i===void 0&&(i=r),a===void 0&&(a=[0,0]),t?t.map(function(s,o){var u=Yb(s),h=u.value,f=u.unit,g=o?i:n,b=o?r:e;if(s==="%"||isNaN(h)){var v=g?a[o]/g:0;return b*v}else if(f!=="%")return h;return b*h/100}):a}function cY(t){var e=[];return t[1]>=0&&(t[0]>=0&&e.push(3),t[0]<=0&&e.push(2)),t[1]<=0&&(t[0]>=0&&e.push(1),t[0]<=0&&e.push(0)),e}function h_e(t,e){return cY(e).map(function(r){return t[r]})}function U3(t,e){var r=(e+1)/2;return[tS(t[0][0],t[1][0],r,1-r),tS(t[0][1],t[1][1],r,1-r)]}function Ll(t,e){var r=U3([t[0],t[1]],e[0]),n=U3([t[2],t[3]],e[0]);return U3([r,n],e[1])}function f_e(t,e,r,n,i,a){var s=Vm(e,r,n,i),o=Ll(s,a),u=t[0]-o[0],h=t[1]-o[1];return[u,h]}function tx(t,e,r,n){return _o(t,P1(e,n,r),n)}function d_e(t,e,r,n){var i=t.transformOrigin,a=t.offsetMatrix,s=t.is3d,o=s?4:3,u;if(ep(r)){var h=e.beforeTransform,f=e.afterTransform;n?u=lf(ib(r),4,o):u=lf(_o(_o(h,ib([r]),4),f,4),4,o)}else u=r;return tx(a,u,i,o)}function p_e(t,e){var r=t.transformOrigin,n=t.offsetMatrix,i=t.is3d,a=t.targetMatrix,s=t.targetAllTransform,o=i?4:3;return tx(n,_o(s||a,xO(e,o),o),r,o)}function lT(t,e){var r=N0(e);return{setTransform:function(n,i){i===void 0&&(i=-1),r.startTransforms=eu(n)?n:Jp(n),uk(t,e,i)},setTransformIndex:function(n){uk(t,e,n)}}}function uT(t,e,r){var n=N0(e),i=n.startTransforms;uk(t,e,Gd(i,function(a){return a.indexOf("".concat(r,"("))===0}))}function uk(t,e,r){var n=N0(e),i=e.datas;if(i.transformIndex=r,r!==-1){var a=n.startTransforms[r];if(a){var s=t.state,o=a0([a],{"x%":function(u){return u/100*s.offsetWidth},"y%":function(u){return u/100*s.offsetHeight}});i.startValue=o[0].functionValue}}}function PO(t,e){var r=N0(t);r.nextTransforms=Jp(e)}function N0(t){return t.originalDatas.beforeRenderable}function iS(t){var e=t.originalDatas.beforeRenderable;return e.nextTransforms}function g2(t){return(iS(t)||[]).join(" ")}function m2(t){return N0(t).nextStyle}function hY(t,e,r,n,i){PO(i,e);var a=ic.drag(t,ex(i,t.state,r,n)),s=a?a.transform:e;return zt(zt({transform:e,drag:a},oc({transform:s},i)),{afterTransform:s})}function kO(t,e,r,n,i,a){var s=d_e(t.state,i,e,a),o=y_e(t,r,n,s);return o}function fY(t,e,r,n,i,a,s){var o=kO(t,e,r,i,a,s),u=t.state,h=u.left,f=u.top,g=t.props.groupable,b=g?h:0,v=g?f:0,S=vi(n,o);return vi(S,[b,v])}function g_e(t,e,r,n,i,a,s){var o=fY(t,e,r,n,i,a,s);return o}function m_e(t,e,r){return[e?-1+t[0]/(e/2):0,r?-1+t[1]/(r/2):0]}function y_e(t,e,r,n){n===void 0&&(n=t.state.allMatrix);var i=t.state,a=i.width,s=i.height,o=i.is3d,u=o?4:3,h=[a/2*(1+e[0])+r[0],s/2*(1+e[1])+r[1]];return gs(n,h,u)}function v_e(t,e,r){var n=r.fixedDirection,i=r.fixedPosition,a=r.fixedOffset;return fY(t,"rotate(".concat(e,"deg)"),n,i,a,r)}function __e(t,e,r,n,i,a){var s=t.props.groupable,o=t.state,u=o.transformOrigin,h=o.offsetMatrix,f=o.is3d,g=o.width,b=o.height,v=o.left,S=o.top,E=a.fixedDirection,P=a.nextTargetMatrix||o.targetMatrix,k=f?4:3,L=c_e(i,e,r,g,b,u),O=s?v:0,M=s?S:0,z=tx(h,P,L,k),B=f_e(n,z,e,r,k,E);return vi(B,[O,M])}function b_e(t,e){return Ll(Mh(t.state),e)}function x_e(t,e){var r=t.targetGesto,n=t.controlGesto,i;return r?.isFlag()&&(i=r.getEventData()[e]),!i&&n?.isFlag()&&(i=n.getEventData()[e]),i||{}}function w_e(t){if(t&&t.getRootNode){var e=t.getRootNode();if(e.nodeType===11)return e}}function S_e(t){var e=t("scale"),r=t("rotate"),n=t("translate"),i=[];return n&&n!=="0px"&&n!=="none"&&i.push("translate(".concat(n.split(/\s+/).join(","),")")),r&&r!=="1"&&r!=="none"&&i.push("rotate(".concat(r,")")),e&&e!=="1"&&e!=="none"&&i.push("scale(".concat(e.split(/\s+/).join(","),")")),i}function dY(t,e,r){for(var n=t,i=[],a=_O(t)||cg(t),s=!r&&t===e||t===a,o=s,u=!1,h=3,f,g,b,v=!1,S=ob(e,e,!0).offsetParent,E=1;n&&!o;){o=s;var P=Ec(n),k=P("position"),L=FY(n),O=k==="fixed",M=S_e(P),z=a0e(b1e(L)),B=void 0,q=!1,W=!1,G=0,ie=0,Q=0,H=0,ne={hasTransform:!1,fixedContainer:null};O&&(v=!0,ne=T1e(n),S=ne.fixedContainer);var oe=z.length;!u&&(oe===16||M.length)&&(u=!0,h=4,gk(i),b&&(b=lf(b,3,4))),u&&oe===9&&(z=lf(z,3,4));var ce=E1e(n,t),fe=ce.tagName,Me=ce.hasOffset,me=ce.isSVG,we=ce.origin,Te=ce.targetOrigin,ke=ce.offset,he=Ht(ke,2),Ee=he[0],xe=he[1];fe==="svg"&&!n.ownerSVGElement&&b&&(i.push({type:"target",target:n,matrix:C1e(n,h)}),i.push({type:"offset",target:n,matrix:$o(h)}));var Ne=parseFloat(P("zoom"))||1;if(O)B=ne.fixedContainer,q=!0;else{var Oe=ob(n,e,!1,!0,P),$e=Oe.offsetZoom;if(B=Oe.offsetParent,q=Oe.isEnd,W=Oe.isStatic,E*=$e,(Oe.isCustomElement||$e!==1)&&W)Ee-=B.offsetLeft,xe-=B.offsetTop;else if(e_e||Q0e){var De=Oe.parentSlotElement;if(De){for(var it=B,Ye=0,rt=0;it&&w_e(it);)Ye+=it.offsetLeft,rt+=it.offsetTop,it=it.offsetParent;Ee-=Ye,xe-=rt}}}if(rY&&!t_e&&Me&&!me&&W&&(k==="relative"||k==="static")&&(Ee-=B.offsetLeft,xe-=B.offsetTop,s=s||q),O)Me&&ne.hasTransform&&(Q=B.clientLeft,H=B.clientTop);else if(Me&&S!==B&&(G=B.clientLeft,ie=B.clientTop),Me&&B===a){var Ie=BY(n,!1);Ee+=Ie[0],xe+=Ie[1]}if(i.push({type:"target",target:n,matrix:P1(z,h,we)}),M.length&&(i.push({type:"offset",target:n,matrix:$o(h)}),i.push({type:"target",target:n,matrix:P1(ib(M),h,we)})),Me){var Mt=n===t,at=Mt?0:n.scrollLeft,je=Mt?0:n.scrollTop;i.push({type:"offset",target:n,matrix:_m([Ee-at+G-Q,xe-je+ie-H],h)})}else i.push({type:"offset",target:n,origin:we});if(Ne!==1&&i.push({type:"zoom",target:n,matrix:P1(xO([Ne,Ne],h),h,[0,0])}),b||(b=z),f||(f=we),g||(g=Te),o||O)break;n=B,s=q,(!r||n===a)&&(o=s)}return b||(b=$o(h)),f||(f=[0,0]),g||(g=[0,0]),{zoom:E,offsetContainer:S,matrixes:i,targetMatrix:b,transformOrigin:f,targetOrigin:g,is3d:u,hasFixed:v}}var qg=null,Hg=null,Tv=null;function s0(t){t?(window.Map&&(qg=new Map,Hg=new Map),Tv=[]):(qg=null,Tv=null,Hg=null)}function E_e(t){var e=Hg?.get(t);if(e)return e;var r=k1(t,!0);return Hg&&Hg.set(t,r),r}function T_e(t,e){if(Tv){var r=rh(Tv,function(i){return i[0][0]==t&&i[0][1]==e});if(r)return r[1]}var n=dY(t,e,!0);return Tv&&Tv.push([[t,e],n]),n}function Ec(t){var e=qg?.get(t);if(!e){var r=Hp(t).getComputedStyle(t);if(!qg)return function(a){return r[a]};e={style:r,cached:{}},qg.set(t,e)}var n=e.cached,i=e.style;return function(a){return a in n||(n[a]=i[a]),n[a]}}function af(t,e,r){var n=r.originalDatas;n.groupable=n.groupable||{};var i=n.groupable;i.childDatas=i.childDatas||[];var a=i.childDatas;return t.moveables.map(function(s,o){return a[o]=a[o]||{},a[o][e]=a[o][e]||{},zt(zt({},r),{isRequestChild:!0,datas:a[o][e],originalDatas:a[o]})})}function V3(t,e,r,n,i,a,s){var o=!!r.match(/Start$/g),u=!!r.match(/End$/g),h=i.isPinch,f=i.datas,g=af(t,e.name,i),b=t.moveables,v=[],S=g.map(function(E,P){var k=b[P],L=k.state,O=L.gestos,M=E;if(o)M=new o0(s).dragStart(n,E),v.push(M);else{if(O[s]||(O[s]=f.childGestos[P]),!O[s])return;M=ex(E,L,n,h,a,s),v.push(M)}var z=e[r](k,zt(zt({},M),{parentFlag:!0}));return u&&(O[s]=null),z});return o&&(f.childGestos=b.map(function(E){return E.state.gestos[s]})),{eventParams:S,childEvents:v}}function jd(t,e,r,n,i,a){i===void 0&&(i=function(f,g){return g});var s=!!r.match(/End$/g),o=af(t,e.name,n),u=t.moveables,h=o.map(function(f,g){var b=u[g],v=f;v=i(b,f);var S=e[r](b,zt(zt({},v),{parentFlag:!0}));return s&&(b.state.gestos={}),S});return h}function aS(t,e,r,n){var i=r.fixedDirection,a=r.fixedPosition,s=n.datas.startPositions||Mh(e.state),o=Ll(s,i),u=Ht(qu(Kb(-t.rotation/180*Math.PI,3),[o[0]-a[0],o[1]-a[1],1],3),2),h=u[0],f=u[1];return n.datas.originalX=h,n.datas.originalY=f,n}function pY(t,e,r,n){var i=t.getState(),a=i.renderPoses,s=i.rotation,o=i.direction,u=xm(t.props,e).zoom,h=I1(s/Math.PI*180),f={},g=t.renderState;g.renderDirectionMap||(g.renderDirectionMap={});var b=g.renderDirectionMap;r.forEach(function(S){var E=S.dir;f[E]=!0});var v=ac(o);return r.map(function(S){var E=S.data,P=S.classNames,k=S.dir,L=IO[k];if(!L||!f[k])return null;b[k]=!0;var O=(Fi(h,15)+v*oY[k]+720)%180,M={};return O0(E).forEach(function(z){M["data-".concat(z)]=E[z]}),n.createElement("div",zt({className:mi.apply(void 0,vn(["control","direction",k,e],Ht(P),!1)),"data-rotation":O,"data-direction":k},M,{key:"direction-".concat(k),style:uS.apply(void 0,vn([s,u],Ht(L.map(function(z){return a[z]})),!1))}))})}function gY(t,e,r,n){var i=xm(t.props,r),a=i.renderDirections,s=a===void 0?e:a,o=i.displayAroundControls;if(!s)return[];var u=s===!0?CO:s;return vn(vn([],Ht(o?_Y(t,n,r,u):[]),!1),Ht(pY(t,r,u.map(function(h){return{data:{},classNames:[],dir:h}}),n)),!1)}function ab(t,e,r,n,i,a){for(var s=[],o=6;o<arguments.length;o++)s[o-6]=arguments[o];var u=Ks(r,n),h=e?Fi(u/Math.PI*180,15)%180:-1;return t.createElement("div",{key:"line-".concat(a),className:mi.apply(void 0,vn(["line","direction",e?"edge":"",e],Ht(s),!1)),"data-rotation":h,"data-line-key":a,"data-direction":e,style:J_(r,n,i,u)})}function mY(t,e,r,n,i){var a=r===!0?G0e:r;return a.map(function(s,o){var u=Ht(IO[s],2),h=u[0],f=u[1];if(f!=null)return ab(t,s,n[h],n[f],i,"".concat(e,"Edge").concat(o),e)}).filter(Boolean)}function yY(t){return function(e,r){var n=xm(e.props,t).edge;return n&&(n===!0||n.length)?vn(vn([],Ht(mY(r,t,n,e.getState().renderPoses,e.props.zoom)),!1),Ht(C_e(e,t,r)),!1):vY(e,t,r)}}function vY(t,e,r){return gY(t,CO,e,r)}function C_e(t,e,r){return gY(t,["nw","ne","sw","se"],e,r)}function _Y(t,e,r,n){var i=t.renderState;i.renderDirectionMap||(i.renderDirectionMap={});var a=t.getState(),s=a.renderPoses,o=a.rotation,u=a.direction,h=i.renderDirectionMap,f=t.props.zoom,g=ac(u),b=o/Math.PI*180;return(n||O0(h)).map(function(v){var S=IO[v];if(!S)return null;var E=(Fi(b,15)+g*oY[v]+720)%180,P=["around-control"];return r&&P.push("direction",r),e.createElement("div",{className:mi.apply(void 0,vn([],Ht(P),!1)),"data-rotation":E,"data-direction":v,key:"direction-around-".concat(v),style:uS.apply(void 0,vn([o,f],Ht(S.map(function(k){return s[k]})),!1))})})}function MO(t,e,r){var n=t||{},i=n.position,a=i===void 0?"client":i,s=n.left,o=s===void 0?-1/0:s,u=n.top,h=u===void 0?-1/0:u,f=n.right,g=f===void 0?1/0:f,b=n.bottom,v=b===void 0?1/0:b,S={position:a,left:o,top:h,right:g,bottom:v};return{vertical:GB(S,e,!0),horizontal:GB(S,r,!1)}}function cT(t,e){var r=t.state,n=r.containerClientRect,i=n.clientHeight,a=n.clientWidth,s=n.clientLeft,o=n.clientTop,u=r.snapOffset,h=u.left,f=u.top,g=u.right,b=u.bottom,v=e||t.props.bounds||{},S=v.position||"client",E=S==="css",P=v.left,k=P===void 0?-1/0:P,L=v.top,O=L===void 0?-1/0:L,M=v.right,z=M===void 0?E?-1/0:1/0:M,B=v.bottom,q=B===void 0?E?-1/0:1/0:B;return E&&(z=a+g-h-z,q=i+b-f-q),{left:k+h-s,right:z+h-s,top:O+f-o,bottom:q+f-o}}function A_e(t,e,r){var n=cT(t),i=n.left,a=n.top,s=n.right,o=n.bottom,u=Ht(r,2),h=u[0],f=u[1],g=Ht(vi(r,e),2),b=g[0],v=g[1];en(b)<lc&&(b=0),en(v)<lc&&(v=0);var S=v>0,E=b>0,P={isBound:!1,offset:0,pos:0},k={isBound:!1,offset:0,pos:0};if(b===0&&v===0)return{vertical:P,horizontal:k};if(b===0)S?o<f&&(k.pos=o,k.offset=f-o):a>f&&(k.pos=a,k.offset=f-a);else if(v===0)E?s<h&&(P.pos=s,P.offset=h-s):i>h&&(P.pos=i,P.offset=h-i);else{var L=v/b,O=r[1]-L*h,M=0,z=0,B=!1;E&&s<=h?(M=L*s+O,z=s,B=!0):!E&&h<=i&&(M=L*i+O,z=i,B=!0),B&&(M<a||M>o)&&(B=!1),B||(S&&o<=f?(M=o,z=(M-O)/L,B=!0):!S&&f<=a&&(M=a,z=(M-O)/L,B=!0)),B&&(P.isBound=!0,P.pos=z,P.offset=h-z,k.isBound=!0,k.pos=M,k.offset=f-M)}return{vertical:P,horizontal:k}}function GB(t,e,r){var n=t[r?"left":"top"],i=t[r?"right":"bottom"],a=Math.min.apply(Math,vn([],Ht(e),!1)),s=Math.max.apply(Math,vn([],Ht(e),!1)),o=[];return n+1>a&&o.push({direction:"start",isBound:!0,offset:a-n,pos:n}),i-1<s&&o.push({direction:"end",isBound:!0,offset:s-i,pos:i}),o.length||o.push({isBound:!1,offset:0,pos:0}),o.sort(function(u,h){return en(h.offset)-en(u.offset)})}function XB(t,e,r){var n=r?t.map(function(i){return Zb(i,r)}):t;return n.some(function(i){return i[0]<e.left&&en(i[0]-e.left)>.1||i[0]>e.right&&en(i[0]-e.right)>.1||i[1]<e.top&&en(i[1]-e.top)>.1||i[1]>e.bottom&&en(i[1]-e.bottom)>.1})}function I_e(t,e,r){var n=kh(t),i=Math.sqrt(n*n-e*e)||0;return[i,-i].sort(function(a,s){return en(a-t[r?0:1])-en(s-t[r?0:1])}).map(function(a){return Ks([0,0],r?[a,e]:[e,a])})}function P_e(t,e,r,n,i){if(!t.props.bounds)return[];var a=i*Math.PI/180,s=cT(t),o=s.left,u=s.top,h=s.right,f=s.bottom,g=o-n[0],b=h-n[0],v=u-n[1],S=f-n[1],E={left:g,top:v,right:b,bottom:S};if(!XB(r,E,0))return[];var P=[];return[[g,0],[b,0],[v,1],[S,1]].forEach(function(k){var L=Ht(k,2),O=L[0],M=L[1];r.forEach(function(z){var B=Ks([0,0],z);P.push.apply(P,vn([],Ht(I_e(z,O,M).map(function(q){return a+q-B}).filter(function(q){return!XB(e,E,q)}).map(function(q){return Fi(q*180/Math.PI,lc)})),!1))})}),P}var k_e=["left","right","center"],M_e=["top","bottom","middle"],YB={left:"start",right:"end",center:"center",top:"start",bottom:"end",middle:"center"},Qp={start:"left",end:"right",center:"center"},eg={start:"top",end:"bottom",center:"middle"};function Cv(){return{left:!1,top:!1,right:!1,bottom:!1}}function D0(t,e){var r=t.props,n=r.snappable,i=r.bounds,a=r.innerBounds,s=r.verticalGuidelines,o=r.horizontalGuidelines,u=r.snapGridWidth,h=r.snapGridHeight,f=t.state,g=f.guidelines,b=f.enableSnap;return!n||!b||e&&n!==!0&&n.indexOf(e)<0?!1:!!(u||h||i||a||g&&g.length||s&&s.length||o&&o.length)}function RO(t){return t===!1?{}:t===!0||!t?{left:!0,right:!0,top:!0,bottom:!0}:t}function R_e(t,e){var r=RO(t),n={};for(var i in r)i in e&&r[i]&&(n[i]=e[i]);return n}function OO(t,e){var r=R_e(t,e),n=M_e.filter(function(a){return a in r}),i=k_e.filter(function(a){return a in r});return{horizontalNames:n,verticalNames:i,horizontal:n.map(function(a){return r[a]}),vertical:i.map(function(a){return r[a]})}}function O_e(t,e,r){var n=gs(t,[e.clientLeft,e.clientTop],r);return[e.left+n[0],e.top+n[1]]}function L_e(t){var e=Ht(t,2),r=e[0],n=e[1],i=n[0]-r[0],a=n[1]-r[1];Math.abs(i)<gl&&(i=0),Math.abs(a)<gl&&(a=0);var s=0,o=0,u=0;return i?a?(s=-a/i,o=1,u=s*r[0]-r[1]):(o=1,u=-r[1]):(s=-1,u=r[0]),[s,o,u].map(function(h){return Fi(h,gl)})}var bY="snapRotationThreshold",xY="snapRotationDegrees",wY="snapHorizontalThreshold",SY="snapVerticalThreshold";function hT(t,e,r,n,i,a,s){var o;n===void 0&&(n=[]),i===void 0&&(i=[]);var u=t.props,h=((o=t.state.snapThresholdInfo)===null||o===void 0?void 0:o.multiples)||[1,1],f=cz(s,u[wY],5),g=cz(a,u[SY],5);return EY(t.state.guidelines,e,r,n,i,f,g,h)}function EY(t,e,r,n,i,a,s,o){return{vertical:KB(t,"vertical",e,s*o[0],n),horizontal:KB(t,"horizontal",r,a*o[1],i)}}function N_e(t,e,r){var n=Ht(r,2),i=n[0],a=n[1],s=Ht(e,2),o=s[0],u=s[1],h=Ht(vi(r,e),2),f=h[0],g=h[1],b=g>0,v=f>0;f=cS(f),g=cS(g);var S={isSnap:!1,offset:0,pos:0},E={isSnap:!1,offset:0,pos:0};if(f===0&&g===0)return{vertical:S,horizontal:E};var P=hT(t,f?[i]:[],g?[a]:[],[],[],void 0,void 0),k=P.vertical,L=P.horizontal;k.posInfos.filter(function(fe){var Me=fe.pos;return v?Me>=o:Me<=o}),L.posInfos.filter(function(fe){var Me=fe.pos;return b?Me>=u:Me<=u}),k.isSnap=k.posInfos.length>0,L.isSnap=L.posInfos.length>0;var O=ck(k),M=O.isSnap,z=O.guideline,B=ck(L),q=B.isSnap,W=B.guideline,G=q?W.pos[1]:0,ie=M?z.pos[0]:0;if(f===0)q&&(E.isSnap=!0,E.pos=W.pos[1],E.offset=a-E.pos);else if(g===0)M&&(S.isSnap=!0,S.pos=ie,S.offset=i-ie);else{var Q=g/f,H=r[1]-Q*i,ne=0,oe=0,ce=!1;M?(oe=ie,ne=Q*oe+H,ce=!0):q&&(ne=G,oe=(ne-H)/Q,ce=!0),ce&&(S.isSnap=!0,S.pos=oe,S.offset=i-oe,E.isSnap=!0,E.pos=ne,E.offset=a-ne)}return{vertical:S,horizontal:E}}function Fp(t){var e="";return t===-1||t==="top"||t==="left"?e="start":t===0||t==="center"||t==="middle"?e="center":(t===1||t==="right"||t==="bottom")&&(e="end"),e}function ZB(t,e,r,n){var i=OO(t.props.snapDirections,e),a=hT(t,i.vertical,i.horizontal,i.verticalNames.map(function(u){return Fp(u)}),i.horizontalNames.map(function(u){return Fp(u)}),r,n),s=Fp(i.horizontalNames[a.horizontal.index]),o=Fp(i.verticalNames[a.vertical.index]);return{vertical:zt(zt({},a.vertical),{direction:o}),horizontal:zt(zt({},a.horizontal),{direction:s})}}function ck(t){var e=t.isSnap;if(!e)return{isSnap:!1,offset:0,dist:-1,pos:0,guideline:null};var r=t.posInfos[0],n=r.guidelineInfos[0],i=n.offset,a=n.dist,s=n.guideline;return{isSnap:e,offset:i,dist:a,pos:r.pos,guideline:s}}function KB(t,e,r,n,i){var a,s;if(i===void 0&&(i=[]),!t||!t.length)return{isSnap:!1,index:-1,direction:"",posInfos:[]};var o=e==="vertical",u=o?0:1,h=r.map(function(g,b){var v=i[b]||"",S=t.map(function(E){var P=E.pos,k=g-P[u];return{offset:k,dist:en(k),guideline:E,direction:v}}).filter(function(E){var P=E.guideline,k=E.dist,L=P.type;return!(L!==e||k>n)}).sort(function(E,P){return E.dist-P.dist});return{pos:g,index:b,guidelineInfos:S,direction:v}}).filter(function(g){return g.guidelineInfos.length>0}).sort(function(g,b){return g.guidelineInfos[0].dist-b.guidelineInfos[0].dist}),f=h.length>0;return{isSnap:f,index:f?h[0].index:-1,direction:(s=(a=h[0])===null||a===void 0?void 0:a.direction)!==null&&s!==void 0?s:"",posInfos:h}}function D_e(t,e,r,n,i){var a=[];r[0]&&r[1]?a=[r,[-r[0],r[1]],[r[0],-r[1]]]:!r[0]&&!r[1]?[[-1,-1],[1,-1],[1,1],[-1,1]].forEach(function(b,v,S){var E=S[v+1]||S[0];a.push(b),a.push([(b[0]+E[0])/2,(b[1]+E[1])/2])}):t.props.keepRatio?a.push([-1,-1],[-1,1],[1,-1],[1,1],r):(a.push.apply(a,vn([],Ht(h_e([[-1,-1],[1,-1],[-1,-1],[1,1]],r)),!1)),a.length>1&&a.push([(a[0][0]+a[1][0])/2,(a[0][1]+a[1][1])/2]));var s=a.map(function(b){return Ll(e,b)}),o=s.map(function(b){return b[0]}),u=s.map(function(b){return b[1]}),h=hT(t,o,u,a.map(function(b){return Fp(b[0])}),a.map(function(b){return Fp(b[1])}),n,i),f=Fp(a.map(function(b){return b[0]})[h.vertical.index]),g=Fp(a.map(function(b){return b[1]})[h.horizontal.index]);return{vertical:zt(zt({},h.vertical),{direction:f}),horizontal:zt(zt({},h.horizontal),{direction:g})}}function TY(t,e){var r=en(t.offset),n=en(e.offset);return t.isBound&&e.isBound?n-r:t.isBound?-1:e.isBound?1:t.isSnap&&e.isSnap?n-r:t.isSnap?-1:e.isSnap||r<lc?1:n<lc?-1:r-n}function oS(t,e){return t.slice().sort(function(r,n){var i=r.sign[e],a=n.sign[e],s=r.offset[e],o=n.offset[e];if(i){if(!a)return-1}else return 1;return TY({isBound:r.isBound,isSnap:r.isSnap,offset:s},{isBound:n.isBound,isSnap:n.isSnap,offset:o})})[0]}function F_e(t,e,r){var n=[];if(r)en(e[0])!==1||en(e[1])!==1?n.push([e,[-1,-1]],[e,[-1,1]],[e,[1,-1]],[e,[1,1]]):n.push([e,[t[0],-t[1]]],[e,[-t[0],t[1]]]),n.push([e,t]);else if(t[0]&&t[1]||!t[0]&&!t[1]){var i=t[0]?t:[1,1];[1,-1].forEach(function(s){[1,-1].forEach(function(o){var u=[s*i[0],o*i[1]];e[0]===u[0]&&e[1]===u[1]||n.push([e,u])})})}else if(t[0]){var a=en(e[0])===1?[1]:[1,-1];a.forEach(function(s){n.push([[e[0],-1],[s*t[0],-1]],[[e[0],0],[s*t[0],0]],[[e[0],1],[s*t[0],1]])})}else if(t[1]){var a=en(e[1])===1?[1]:[1,-1];a.forEach(function(o){n.push([[-1,e[1]],[-1,o*t[1]]],[[0,e[1]],[0,o*t[1]]],[[1,e[1]],[1,o*t[1]]])})}return n}function CY(t,e){var r=JP([e[0][0],e[1][0]]),n=JP([e[0][1],e[1][1]]);return{vertical:r<=t[0],horizontal:n<=t[1]}}function LO(t,e){var r=Ht(e,2),n=r[0],i=r[1],a=i[0]-n[0],s=i[1]-n[1];en(a)<lc&&(a=0),en(s)<lc&&(s=0);var o,u;if(!a)o=n[0],u=t[0];else if(!s)o=n[1],u=t[1];else{var h=s/a;o=h*(t[0]-n[0])+n[1],u=t[1]}return o-u}function AY(t,e,r,n){return n===void 0&&(n=lc),t.every(function(i){var a=LO(i,e),s=a<=0;return s===r||en(a)<=n})}function JB(t,e,r,n,i){return i===void 0&&(i=0),n&&e-i<=t||!n&&t<=r+i?{isBound:!0,offset:n?e-t:r-t}:{isBound:!1,offset:0}}function B_e(t,e){var r=e.line,n=e.centerSign,i=e.verticalSign,a=e.horizontalSign,s=e.lineConstants,o=t.props.innerBounds;if(!o)return{isAllBound:!1,isBound:!1,isVerticalBound:!1,isHorizontalBound:!1,offset:[0,0]};var u=o.left,h=o.top,f=o.width,g=o.height,b=[[u,h],[u,h+g]],v=[[u,h],[u+f,h]],S=[[u+f,h],[u+f,h+g]],E=[[u,h+g],[u+f,h+g]];if(AY([[u,h],[u+f,h],[u,h+g],[u+f,h+g]],r,n))return{isAllBound:!1,isBound:!1,isVerticalBound:!1,isHorizontalBound:!1,offset:[0,0]};var P=Bp(r,s,v,i),k=Bp(r,s,E,i),L=Bp(r,s,b,a),O=Bp(r,s,S,a),M=P.isBound&&k.isBound,z=P.isBound||k.isBound,B=L.isBound&&O.isBound,q=L.isBound||O.isBound,W=l0(P.offset,k.offset),G=l0(L.offset,O.offset),ie=[0,0],Q=!1,H=!1;return en(G)<en(W)?(ie=[W,0],Q=z,H=M):(ie=[0,G],Q=q,H=B),{isAllBound:H,isVerticalBound:z,isHorizontalBound:q,isBound:Q,offset:ie}}function Bp(t,e,r,n,i,a){var s=Ht(e,2),o=s[0],u=s[1],h=t[0],f=r[0],g=r[1],b=cS(g[1]-f[1]),v=cS(g[0]-f[0]),S=u,E=o,P=-o/u;if(v){if(!b){if(a&&!S)return{isBound:!1,offset:0};if(E){var M=(f[1]-h[1])/P+h[0];return JB(M,f[0],g[0],n,i)}else{var L=f[1]-h[1],O=en(L)<=(i||0);return{isBound:O,offset:O?L:0}}}}else{if(a&&!E)return{isBound:!1,offset:0};if(S){var k=P*(f[0]-h[0])+h[1];return JB(k,f[1],g[1],n,i)}else{var L=f[0]-h[0],O=en(L)<=(i||0);return{isBound:O,offset:O?L:0}}}return{isBound:!1,offset:0}}function IY(t,e,r){return e.map(function(n){var i=B_e(t,n),a=i.isBound,s=i.offset,o=i.isVerticalBound,u=i.isHorizontalBound,h=n.multiple,f=ud({datas:r,distX:s[0],distY:s[1]}).map(function(g,b){return g*(h[b]?2/h[b]:0)});return{sign:h,isBound:a,isVerticalBound:o,isHorizontalBound:u,isSnap:!1,offset:f}})}function z_e(t,e,r){var n,i=NO(t,e,[0,0],!1).map(function(b){return zt(zt({},b),{multiple:b.multiple.map(function(v){return en(v)*2})})}),a=IY(t,i,r),s=oS(a,0),o=oS(a,1),u=0,h=0,f=s.isVerticalBound||o.isVerticalBound,g=s.isHorizontalBound||o.isHorizontalBound;return(f||g)&&(n=Ht(u_e({datas:r,distX:-s.offset[0],distY:-o.offset[1]}),2),u=n[0],h=n[1]),{vertical:{isBound:f,offset:u},horizontal:{isBound:g,offset:h}}}function j_e(t,e){var r=[],n=t[0],i=t[1];return n&&i?r.push([[0,i*2],t,[-n,i]],[[n*2,0],t,[n,-i]]):n?(r.push([[n*2,0],[n,1],[n,-1]]),e&&r.push([[0,-1],[n,-1],[-n,-1]],[[0,1],[n,1],[-n,1]])):i?(r.push([[0,i*2],[1,i],[-1,i]]),e&&r.push([[-1,0],[-1,i],[-1,-i]],[[1,0],[1,i],[1,-i]])):r.push([[-1,0],[-1,-1],[-1,1]],[[1,0],[1,-1],[1,1]],[[0,-1],[-1,-1],[1,-1]],[[0,1],[-1,1],[1,1]]),r}function NO(t,e,r,n){var i=t.state,a=i.allMatrix,s=i.is3d,o=Vm(a,100,100,s?4:3),u=Ll(o,[0,0]);return j_e(r,n).map(function(h){var f=Ht(h,3),g=f[0],b=f[1],v=f[2],S=[Ll(o,b),Ll(o,v)],E=L_e(S),P=CY(u,S),k=P.vertical,L=P.horizontal,O=LO(u,S)<=0;return{multiple:g,centerSign:O,verticalSign:k,horizontalSign:L,lineConstants:E,line:[Ll(e,b),Ll(e,v)]}})}function QB(t,e,r,n){var i=n?t.map(function(a){return Zb(a,n)}):t;return[[i[0],i[1]],[i[1],i[3]],[i[3],i[2]],[i[2],i[0]]].some(function(a){var s=LO(r,a)<=0;return!AY(e,a,s)})}function U_e(t){var e=Ht(t,2),r=e[0],n=e[1],i=n[0]-r[0],a=n[1]-r[1];if(!i)return en(r[0]);if(!a)return en(r[1]);var s=a/i;return en((-s*r[0]+r[1])/Math.sqrt(Math.pow(s,2)+1))}function V_e(t){var e=Ht(t,2),r=e[0],n=e[1],i=n[0]-r[0],a=n[1]-r[1];if(!i)return[r[0],0];if(!a)return[0,r[1]];var s=a/i,o=-s*r[0]+r[1];return[-o/(s+1/s),o/(s*s+1)]}function $_e(t,e,r,n,i){var a=t.props.innerBounds,s=i*Math.PI/180;if(!a)return[];var o=a.left,u=a.top,h=a.width,f=a.height,g=o-n[0],b=o+h-n[0],v=u-n[1],S=u+f-n[1],E=[[g,v],[b,v],[g,S],[b,S]],P=Ll(r,[0,0]);if(!QB(r,E,P,0))return[];var k=[],L=E.map(function(O){return[kh(O),Ks([0,0],O)]});return[[r[0],r[1]],[r[1],r[3]],[r[3],r[2]],[r[2],r[0]]].forEach(function(O){var M=Ks([0,0],V_e(O)),z=U_e(O);k.push.apply(k,vn([],Ht(L.filter(function(B){var q=Ht(B,1),W=q[0];return W&&z<=W}).map(function(B){var q=Ht(B,2),W=q[0],G=q[1],ie=Math.acos(W?z/W:0),Q=G+ie,H=G-ie;return[s+Q-M,s+H-M]}).reduce(function(B,q){return B.push.apply(B,vn([],Ht(q),!1)),B},[]).filter(function(B){return!QB(e,E,P,B)}).map(function(B){return Fi(B*180/Math.PI,lc)})),!1))}),k}function q_e(t){var e=t.props.innerBounds,r=Cv();if(!e)return{boundMap:r,vertical:[],horizontal:[]};var n=t.getRect(),i=n.pos1,a=n.pos2,s=n.pos3,o=n.pos4,u=[i,a,s,o],h=Ll(u,[0,0]),f=e.left,g=e.top,b=e.width,v=e.height,S=[[f,g],[f,g+v]],E=[[f,g],[f+b,g]],P=[[f+b,g],[f+b,g+v]],k=[[f,g+v],[f+b,g+v]],L=NO(t,u,[0,0],!1),O=[],M=[];return L.forEach(function(z){var B=z.line,q=z.lineConstants,W=CY(h,B),G=W.horizontal,ie=W.vertical,Q=Bp(B,q,E,ie,1,!0),H=Bp(B,q,k,ie,1,!0),ne=Bp(B,q,S,G,1,!0),oe=Bp(B,q,P,G,1,!0);Q.isBound&&!r.top&&(O.push(g),r.top=!0),H.isBound&&!r.bottom&&(O.push(g+v),r.bottom=!0),ne.isBound&&!r.left&&(M.push(f),r.left=!0),oe.isBound&&!r.right&&(M.push(f+b),r.right=!0)}),{boundMap:r,horizontal:O,vertical:M}}function H_e(t,e,r,n){var i=e[0]-t[0],a=e[1]-t[1];if(en(i)<gl&&(i=0),en(a)<gl&&(a=0),!i)return n?[0,0]:[0,r];if(!a)return n?[r,0]:[0,0];var s=a/i,o=t[1]-s*t[0];if(n){var u=s*(e[0]+r)+o;return[r,u-e[1]]}else{var h=(e[1]+r-o)/s;return[h-e[0],r]}}function hk(t,e,r,n,i){var a=H_e(t,e,r,n);if(!a)return{isOutside:!1,offset:[0,0]};var s=zd(t,e),o=zd(a,t),u=zd(a,e),h=o>s||u>s,f=Ht(ud({datas:i,distX:a[0],distY:a[1]}),2),g=f[0],b=f[1];return{offset:[g,b],isOutside:h}}function sS(t,e){return t.isBound?t.offset:e.isSnap?ck(e).offset:0}function W_e(t,e,r,n,i){var a=Ht(e,2),s=a[0],o=a[1],u=Ht(r,2),h=u[0],f=u[1],g=Ht(n,2),b=g[0],v=g[1],S=Ht(i,2),E=S[0],P=S[1],k=-E,L=-P;if(t&&s&&o){k=0,L=0;var O=[];if(h&&f?O.push([0,P],[E,0]):h?O.push([E,0]):f?O.push([0,P]):b&&v?O.push([0,P],[E,0]):b?O.push([E,0]):v&&O.push([0,P]),O.length){O.sort(function(q,W){return kh(vi([s,o],q))-kh(vi([s,o],W))});var M=O[0];if(M[0]&&en(s)>gl)k=-M[0],L=o*en(s+k)/en(s)-o;else if(M[1]&&en(o)>gl){var z=o;L=-M[1],k=s*en(o+L)/en(z)-s}if(t&&f&&h)if(en(k)>gl&&en(k)<en(E)){var B=en(E)/en(k);k*=B,L*=B}else if(en(L)>gl&&en(L)<en(P)){var B=en(P)/en(L);k*=B,L*=B}else k=l0(-E,k),L=l0(-P,L)}}else k=s||h?-E:0,L=o||f?-P:0;return[k,L]}function G_e(t,e,r,n,i,a){if(!D0(t,"draggable"))return[{isSnap:!1,isBound:!1,offset:0},{isSnap:!1,isBound:!1,offset:0}];var s=BO(a.absolutePoses,[e,r]),o=xh(s),u=o.left,h=o.right,f=o.top,g=o.bottom,b={horizontal:s.map(function(oe){return oe[1]}),vertical:s.map(function(oe){return oe[0]})},v=RO(t.props.snapDirections),S=OO(v,{left:u,right:h,top:f,bottom:g,center:(u+h)/2,middle:(f+g)/2}),E=fT(t,i,S,b),P=E.vertical,k=E.horizontal,L=z_e(t,s,a),O=L.vertical,M=L.horizontal,z=P.isSnap,B=k.isSnap,q=P.isBound||O.isBound,W=k.isBound||M.isBound,G=l0(P.offset,O.offset),ie=l0(k.offset,M.offset),Q=Ht(W_e(n,[e,r],[q,W],[z,B],[G,ie]),2),H=Q[0],ne=Q[1];return[{isBound:q,isSnap:z,offset:H},{isBound:W,isSnap:B,offset:ne}]}function fT(t,e,r,n){n===void 0&&(n=r);var i=MO(cT(t),n.vertical,n.horizontal),a=i.horizontal,s=i.vertical,o=e?{horizontal:{isSnap:!1,index:-1},vertical:{isSnap:!1,index:-1}}:hT(t,r.vertical,r.horizontal,void 0,void 0,void 0,void 0),u=o.horizontal,h=o.vertical,f=sS(a[0],u),g=sS(s[0],h),b=en(f),v=en(g);return{horizontal:{isBound:a[0].isBound,isSnap:u.isSnap,snapIndex:u.index,offset:f,dist:b,bounds:a,snap:u},vertical:{isBound:s[0].isBound,isSnap:h.isSnap,snapIndex:h.index,offset:g,dist:v,bounds:s,snap:h}}}function ez(t,e,r,n,i,a,s){s===void 0&&(s=[1,1]);var o=MO(e,r,n),u=o.horizontal,h=o.vertical,f=EY(t,r,n,[],[],i,a,s),g=f.horizontal,b=f.vertical,v=sS(u[0],g),S=sS(h[0],b),E=en(v),P=en(S);return{horizontal:{isBound:u[0].isBound,isSnap:g.isSnap,snapIndex:g.index,offset:v,dist:E,bounds:u,snap:g},vertical:{isBound:h[0].isBound,isSnap:b.isSnap,snapIndex:b.index,offset:S,dist:P,bounds:h,snap:b}}}function X_e(t,e,r,n){var i=Ks(t,e)/Math.PI*180,a=r.vertical,s=a.isBound,o=a.isSnap,u=a.dist,h=r.horizontal,f=h.isBound,g=h.isSnap,b=h.dist,v=i%180,S=v<3||v>177,E=v>87&&v<93;return b<u&&(s||o&&!E&&(!n||!S))?"vertical":f||g&&!S&&(!n||!E)?"horizontal":""}function Y_e(t,e,r,n,i,a){return r.map(function(s){var o=Ht(s,2),u=o[0],h=o[1],f=Ll(e,u),g=Ll(e,h),b=n?Z_e(t,f,g,i):fT(t,i,{vertical:[g[0]],horizontal:[g[1]]}),v=b.horizontal,S=v.offset,E=v.isBound,P=v.isSnap,k=b.vertical,L=k.offset,O=k.isBound,M=k.isSnap,z=vi(h,u);if(!L&&!S)return{isBound:O||E,isSnap:M||P,sign:z,offset:[0,0]};var B=X_e(f,g,b,n);if(!B)return{sign:z,isBound:!1,isSnap:!1,offset:[0,0]};var q=B==="vertical",W=[0,0];return!n&&en(h[0])===1&&en(h[1])===1&&u[0]!==h[0]&&u[1]!==h[1]?W=ud({datas:a,distX:-L,distY:-S}):W=hk(f,g,-(q?L:S),q,a).offset,W=W.map(function(G,ie){return G*(z[ie]?2/z[ie]:0)}),{sign:z,isBound:q?O:E,isSnap:q?M:P,offset:W}})}function tz(t,e){return t.isBound?t.offset:e.isSnap?e.offset:0}function Z_e(t,e,r,n){var i=A_e(t,e,r),a=i.horizontal,s=i.vertical,o=n?{horizontal:{isSnap:!1},vertical:{isSnap:!1}}:N_e(t,e,r),u=o.horizontal,h=o.vertical,f=tz(a,u),g=tz(s,h),b=en(f),v=en(g);return{horizontal:{isBound:a.isBound,isSnap:u.isSnap,offset:f,dist:b},vertical:{isBound:s.isBound,isSnap:h.isSnap,offset:g,dist:v}}}function K_e(t,e,r,n,i){var a=[-r[0],-r[1]],s=t.state,o=s.width,u=s.height,h=t.props.bounds,f=1/0,g=1/0;if(h){var b=[[r[0],-r[1]],[-r[0],r[1]]],v=h.left,S=v===void 0?-1/0:v,E=h.top,P=E===void 0?-1/0:E,k=h.right,L=k===void 0?1/0:k,O=h.bottom,M=O===void 0?1/0:O;b.forEach(function(z){var B=z[0]!==a[0],q=z[1]!==a[1],W=Ll(e,z),G=Ks(n,W)*360/Math.PI;if(q){var ie=W.slice();(en(G-360)<2||en(G-180)<2)&&(ie[1]=n[1]);var Q=hk(n,ie,(n[1]<W[1]?M:P)-W[1],!1,i),H=Ht(Q.offset,2),ne=H[1],oe=Q.isOutside;isNaN(ne)||(g=u+(oe?1:-1)*en(ne))}if(B){var ie=W.slice();(en(G-90)<2||en(G-270)<2)&&(ie[0]=n[0]);var ce=hk(n,ie,(n[0]<W[0]?L:S)-W[0],!0,i),fe=Ht(ce.offset,1),Me=fe[0],me=ce.isOutside;isNaN(Me)||(f=o+(me?1:-1)*en(Me))}})}return{maxWidth:f,maxHeight:g}}var ic={name:"draggable",props:["draggable","throttleDrag","throttleDragRotate","hideThrottleDragRotateLine","startDragRotate","edgeDraggable"],events:["dragStart","drag","dragEnd","dragGroupStart","dragGroup","dragGroupEnd"],requestStyle:function(){return["left","top","right","bottom"]},requestChildStyle:function(){return["left","top","right","bottom"]},render:function(t,e){var r=t.props,n=r.hideThrottleDragRotateLine,i=r.throttleDragRotate,a=r.zoom,s=t.getState(),o=s.dragInfo,u=s.beforeOrigin;if(n||!i||!o)return[];var h=o.dist;if(!h[0]&&!h[1])return[];var f=kh(h),g=Ks(h,[0,0]);return[e.createElement("div",{className:mi("line","horizontal","dragline","dashed"),key:"dragRotateGuideline",style:{width:"".concat(f,"px"),transform:"translate(".concat(u[0],"px, ").concat(u[1],"px) rotate(").concat(g,"rad) scaleY(").concat(a,")")}})]},dragStart:function(t,e){var r=e.datas,n=e.parentEvent,i=e.parentGesto,a=t.state,s=a.gestos,o=a.style;if(s.draggable)return!1;s.draggable=i||t.targetGesto,r.datas={},r.left=parseFloat(o.left||"")||0,r.top=parseFloat(o.top||"")||0,r.bottom=parseFloat(o.bottom||"")||0,r.right=parseFloat(o.right||"")||0,r.startValue=[0,0],Um(t,e),uT(t,e,"translate"),m1e(t,r),r.prevDist=[0,0],r.prevBeforeDist=[0,0],r.isDrag=!1,r.deltaOffset=[0,0];var u=qi(t,e,zt({set:function(f){r.startValue=f}},lT(t,e))),h=n||$n(t,"onDragStart",u);return h!==!1?(r.isDrag=!0,t.state.dragInfo={startRect:t.getRect(),dist:[0,0]}):(s.draggable=null,r.isPinch=!1),r.isDrag?u:!1},drag:function(t,e){if(e){oT(t,e,"translate");var r=e.datas,n=e.parentEvent,i=e.parentFlag,a=e.isPinch,s=e.deltaOffset,o=e.useSnap,u=e.isRequest,h=e.isGroup,f=e.parentThrottleDrag,g=e.distX,b=e.distY,v=r.isDrag,S=r.prevDist,E=r.prevBeforeDist,P=r.startValue;if(v){s&&(g+=s[0],b+=s[1]);var k=t.props,L=k.parentMoveable,O=h?0:k.throttleDrag||f||0,M=n?0:k.throttleDragRotate||0,z=0,B=!1,q=!1,W=!1,G=!1;if(!n&&M>0&&(g||b)){var ie=k.startDragRotate||0,Q=Fi(ie+Ks([0,0],[g,b])*180/Math.PI,M)-ie,H=b*Math.abs(Math.cos((Q-90)/180*Math.PI)),ne=g*Math.abs(Math.cos(Q/180*Math.PI)),oe=kh([ne,H]);z=Q*Math.PI/180,g=oe*Math.cos(z),b=oe*Math.sin(z)}if(!a&&!n&&!i){var ce=Ht(G_e(t,g,b,M,!o&&u||s,r),2),fe=ce[0],Me=ce[1];B=fe.isSnap,q=fe.isBound,W=Me.isSnap,G=Me.isBound;var me=fe.offset,we=Me.offset;g+=me,b+=we}var Te=Aa(uY({datas:r,distX:g,distY:b}),P),ke=Aa(l_e({datas:r,distX:g,distY:b}),P);jB(ke,lc),jB(Te,lc),M||(!B&&!q&&(ke[0]=Fi(ke[0],O),Te[0]=Fi(Te[0],O)),!W&&!G&&(ke[1]=Fi(ke[1],O),Te[1]=Fi(Te[1],O)));var he=vi(Te,P),Ee=vi(ke,P),xe=vi(Ee,S),Ne=vi(he,E);r.prevDist=Ee,r.prevBeforeDist=he,r.passDelta=xe,r.passDist=Ee;var Oe=r.left+he[0],$e=r.top+he[1],De=r.right-he[0],it=r.bottom-he[1],Ye=sT(r,"translate(".concat(ke[0],"px, ").concat(ke[1],"px)"),"translate(".concat(Ee[0],"px, ").concat(Ee[1],"px)"));if(PO(e,Ye),t.state.dragInfo.dist=n?[0,0]:Ee,!(!n&&!L&&xe.every(function(je){return!je})&&Ne.some(function(je){return!je}))){var rt=t.state,Ie=rt.width,Mt=rt.height,at=qi(t,e,zt({transform:Ye,dist:Ee,delta:xe,translate:ke,beforeDist:he,beforeDelta:Ne,beforeTranslate:Te,left:Oe,top:$e,right:De,bottom:it,width:Ie,height:Mt,isPinch:a},oc({transform:Ye},e)));return!n&&$n(t,"onDrag",at),at}}}},dragAfter:function(t,e){var r=e.datas,n=r.deltaOffset;return n[0]||n[1]?(r.deltaOffset=[0,0],this.drag(t,zt(zt({},e),{deltaOffset:n}))):!1},dragEnd:function(t,e){var r=e.parentEvent,n=e.datas;if(t.state.dragInfo=null,!!n.isDrag){n.isDrag=!1;var i=nh(t,e,{});return!r&&$n(t,"onDragEnd",i),i}},dragGroupStart:function(t,e){var r,n,i=e.datas,a=e.clientX,s=e.clientY,o=this.dragStart(t,e);if(!o)return!1;var u=V3(t,this,"dragStart",[a||0,s||0],e,!1,"draggable"),h=u.childEvents,f=u.eventParams,g=zt(zt({},o),{targets:t.props.targets,events:f}),b=$n(t,"onDragGroupStart",g);i.isDrag=b!==!1;var v=(n=(r=h[0])===null||r===void 0?void 0:r.datas.startValue)!==null&&n!==void 0?n:[0,0];return i.throttleOffset=[v[0]%1,v[1]%1],i.isDrag?o:!1},dragGroup:function(t,e){var r=e.datas;if(r.isDrag){var n=this.drag(t,zt(zt({},e),{parentThrottleDrag:t.props.throttleDrag})),i=e.datas.passDelta,a=V3(t,this,"drag",i,e,!1,"draggable").eventParams;if(n){var s=zt({targets:t.props.targets,events:a},n);return $n(t,"onDragGroup",s),s}}},dragGroupEnd:function(t,e){var r=e.isDrag,n=e.datas;if(n.isDrag){this.dragEnd(t,e);var i=V3(t,this,"dragEnd",[0,0],e,!1,"draggable").eventParams;return $n(t,"onDragGroupEnd",nh(t,e,{targets:t.props.targets,events:i})),r}},request:function(t){var e={},r=t.getRect(),n=0,i=0,a=!1;return{isControl:!1,requestStart:function(s){return a=s.useSnap,{datas:e,useSnap:a}},request:function(s){return"x"in s?n=s.x-r.left:"deltaX"in s&&(n+=s.deltaX),"y"in s?i=s.y-r.top:"deltaY"in s&&(i+=s.deltaY),{datas:e,distX:n,distY:i,useSnap:a}},requestEnd:function(){return{datas:e,isDrag:!0,useSnap:a}}}},unset:function(t){t.state.gestos.draggable=null,t.state.dragInfo=null}};function PY(t,e){var r=Ll(t,e),n=[0,0];return{fixedPosition:r,fixedDirection:e,fixedOffset:n}}function J_e(t,e){var r=t.allMatrix,n=t.is3d,i=t.width,a=t.height,s=n?4:3,o=[i/2*(1+e[0]),a/2*(1+e[1])],u=gs(r,o,s),h=[0,0];return{fixedPosition:u,fixedDirection:e,fixedOffset:h}}function kY(t,e){var r=t.allMatrix,n=t.is3d,i=t.width,a=t.height,s=n?4:3,o=m_e(e,i,a),u=gs(r,e,s),h=[i?0:e[0],a?0:e[1]];return{fixedPosition:u,fixedDirection:o,fixedOffset:h}}var rz=UO("resizable"),fk={name:"resizable",ableGroup:"size",canPinch:!0,props:["resizable","throttleResize","renderDirections","displayAroundControls","keepRatio","resizeFormat","keepRatioFinally","edge","checkResizableError"],events:["resizeStart","beforeResize","resize","resizeEnd","resizeGroupStart","beforeResizeGroup","resizeGroup","resizeGroupEnd"],render:yY("resizable"),dragControlCondition:rz,viewClassName:jO("resizable"),dragControlStart:function(t,e){var r,n=e.inputEvent,i=e.isPinch,a=e.isGroup,s=e.parentDirection,o=e.parentGesto,u=e.datas,h=e.parentFixedDirection,f=e.parentEvent,g=$Y(s,i,n,u),b=t.state,v=b.target,S=b.width,E=b.height,P=b.gestos;if(!g||!v||P.resizable)return!1;P.resizable=o||t.controlGesto,!i&&Um(t,e),u.datas={},u.direction=g,u.startOffsetWidth=S,u.startOffsetHeight=E,u.prevWidth=0,u.prevHeight=0,u.minSize=[0,0],u.startWidth=b.inlineCSSWidth||b.cssWidth,u.startHeight=b.inlineCSSHeight||b.cssHeight,u.maxSize=[1/0,1/0],a||(u.minSize=[b.minOffsetWidth,b.minOffsetHeight],u.maxSize=[b.maxOffsetWidth,b.maxOffsetHeight]);var k=t.props.transformOrigin||"% %";u.transformOrigin=ep(k)?k.split(" "):k,u.startOffsetMatrix=b.offsetMatrix,u.startTransformOrigin=b.transformOrigin,u.isWidth=(r=e?.parentIsWidth)!==null&&r!==void 0?r:!g[0]&&!g[1]||g[0]||!g[1];function L(G){u.ratio=G&&isFinite(G)?G:0}u.startPositions=Mh(t.state);function O(G){var ie=PY(u.startPositions,G);u.fixedDirection=ie.fixedDirection,u.fixedPosition=ie.fixedPosition,u.fixedOffset=ie.fixedOffset}function M(G){var ie=kY(t.state,G);u.fixedDirection=ie.fixedDirection,u.fixedPosition=ie.fixedPosition,u.fixedOffset=ie.fixedOffset}function z(G){u.minSize=[vo("".concat(G[0]),0)||0,vo("".concat(G[1]),0)||0]}function B(G){var ie=[G[0]||1/0,G[1]||1/0];(!rb(ie[0])||isFinite(ie[0]))&&(ie[0]=vo("".concat(ie[0]),0)||1/0),(!rb(ie[1])||isFinite(ie[1]))&&(ie[1]=vo("".concat(ie[1]),0)||1/0),u.maxSize=ie}L(S/E),O(h||[-g[0],-g[1]]),u.setFixedDirection=O,u.setFixedPosition=M,u.setMin=z,u.setMax=B;var q=qi(t,e,{direction:g,startRatio:u.ratio,set:function(G){var ie=Ht(G,2),Q=ie[0],H=ie[1];u.startWidth=Q,u.startHeight=H},setMin:z,setMax:B,setRatio:L,setFixedDirection:O,setFixedPosition:M,setOrigin:function(G){u.transformOrigin=G},dragStart:ic.dragStart(t,new o0().dragStart([0,0],e))}),W=f||$n(t,"onResizeStart",q);return u.startFixedDirection=u.fixedDirection,u.startFixedPosition=u.fixedPosition,W!==!1&&(u.isResize=!0,t.state.snapRenderInfo={request:e.isRequest,direction:g}),u.isResize?q:!1},dragControl:function(t,e){var r,n=e.datas,i=e.parentFlag,a=e.isPinch,s=e.parentKeepRatio,o=e.dragClient,u=e.parentDist,h=e.useSnap,f=e.isRequest,g=e.isGroup,b=e.parentEvent,v=e.resolveMatrix,S=n.isResize,E=n.transformOrigin,P=n.startWidth,k=n.startHeight,L=n.prevWidth,O=n.prevHeight,M=n.minSize,z=n.maxSize,B=n.ratio,q=n.startOffsetWidth,W=n.startOffsetHeight,G=n.isWidth;if(!S)return;if(v){var ie=t.state.is3d,Q=n.startOffsetMatrix,H=n.startTransformOrigin,ne=ie?4:3,oe=ib(iS(e)),ce=Math.sqrt(oe.length);ne!==ce&&(oe=lf(oe,ce,ne));var fe=tx(Q,oe,H,ne),Me=Vm(fe,q,W,ne);n.startPositions=Me,n.nextTargetMatrix=oe,n.nextAllMatrix=fe}var me=xm(t.props,"resizable"),we=me.resizeFormat,Te=me.throttleResize,ke=Te===void 0?i?0:1:Te,he=me.parentMoveable,Ee=me.keepRatioFinally,xe=n.direction,Ne=xe,Oe=0,$e=0;!xe[0]&&!xe[1]&&(Ne=[1,1]);var De=B&&(s??me.keepRatio)||!1;function it(){var wr=n.fixedDirection,er=YY(Ne,De,n,e);Oe=er.distWidth,$e=er.distHeight;var lr=Ne[0]-wr[0]||De?Math.max(q+Oe,lc):q,Ar=Ne[1]-wr[1]||De?Math.max(W+$e,lc):W;return De&&q&&W&&(G?Ar=lr/B:lr=Ar*B),[lr,Ar]}var Ye=Ht(it(),2),rt=Ye[0],Ie=Ye[1];b||(n.setFixedDirection(n.fixedDirection),$n(t,"onBeforeResize",qi(t,e,{startFixedDirection:n.startFixedDirection,startFixedPosition:n.startFixedPosition,setFixedDirection:function(wr){var er;return n.setFixedDirection(wr),er=Ht(it(),2),rt=er[0],Ie=er[1],[rt,Ie]},setFixedPosition:function(wr){var er;return n.setFixedPosition(wr),er=Ht(it(),2),rt=er[0],Ie=er[1],[rt,Ie]},boundingWidth:rt,boundingHeight:Ie,setSize:function(wr){var er;er=Ht(wr,2),rt=er[0],Ie=er[1]}},!0)));var Mt=o;o||(!i&&a?Mt=b_e(t,[0,0]):Mt=n.fixedPosition);var at=[0,0];a||(at=p1e(t,rt,Ie,xe,Mt,!h&&f,n)),u&&(!u[0]&&(at[0]=0),!u[1]&&(at[1]=0));function je(){var wr;we&&(wr=Ht(we([rt,Ie]),2),rt=wr[0],Ie=wr[1]),rt=Fi(rt,ke),Ie=Fi(Ie,ke)}if(De){Ne[0]&&Ne[1]&&at[0]&&at[1]&&(en(at[0])>en(at[1])?at[1]=0:at[0]=0);var Xt=!at[0]&&!at[1];Xt&&je(),Ne[0]&&!Ne[1]||at[0]&&!at[1]||Xt&&G?(rt+=at[0],Ie=rt/B):(!Ne[0]&&Ne[1]||!at[0]&&at[1]||Xt&&!G)&&(Ie+=at[1],rt=Ie*B)}else rt+=at[0],Ie+=at[1],rt=Math.max(0,rt),Ie=Math.max(0,Ie);r=Ht($X([rt,Ie],M,z,De?B:!1),2),rt=r[0],Ie=r[1],je(),De&&(g||Ee)&&(G?Ie=rt/B:rt=Ie*B),Oe=rt-q,$e=Ie-W;var Yt=[Oe-L,$e-O];n.prevWidth=Oe,n.prevHeight=$e;var pr=__e(t,rt,Ie,Mt,E,n);if(!(!he&&Yt.every(function(wr){return!wr})&&pr.every(function(wr){return!wr}))){var vt=ic.drag(t,ex(e,t.state,pr,!!a,!1,"draggable")),yr=vt.transform,_r=P+Oe,cr=k+$e,Er=qi(t,e,zt({width:_r,height:cr,offsetWidth:Math.round(rt),offsetHeight:Math.round(Ie),startRatio:B,boundingWidth:rt,boundingHeight:Ie,direction:xe,dist:[Oe,$e],delta:Yt,isPinch:!!a,drag:vt},HY({style:{width:"".concat(_r,"px"),height:"".concat(cr,"px")},transform:yr},vt,e)));return!b&&$n(t,"onResize",Er),Er}},dragControlAfter:function(t,e){var r=e.datas,n=r.isResize,i=r.startOffsetWidth,a=r.startOffsetHeight,s=r.prevWidth,o=r.prevHeight;if(!(!n||t.props.checkResizableError===!1)){var u=t.state,h=u.width,f=u.height,g=h-(i+s),b=f-(a+o),v=en(g)>3,S=en(b)>3;if(v&&(r.startWidth+=g,r.startOffsetWidth+=g,r.prevWidth+=g),S&&(r.startHeight+=b,r.startOffsetHeight+=b,r.prevHeight+=b),v||S)return this.dragControl(t,e)}},dragControlEnd:function(t,e){var r=e.datas,n=e.parentEvent;if(r.isResize){r.isResize=!1;var i=nh(t,e,{});return!n&&$n(t,"onResizeEnd",i),i}},dragGroupControlCondition:rz,dragGroupControlStart:function(t,e){var r=e.datas,n=this.dragControlStart(t,zt(zt({},e),{isGroup:!0}));if(!n)return!1;var i=af(t,"resizable",e),a=r.startOffsetWidth,s=r.startOffsetHeight;function o(){var v=r.minSize;i.forEach(function(S){var E=S.datas,P=E.minSize,k=E.startOffsetWidth,L=E.startOffsetHeight,O=a*(k?P[0]/k:0),M=s*(L?P[1]/L:0);v[0]=Math.max(v[0],O),v[1]=Math.max(v[1],M)})}function u(){var v=r.maxSize;i.forEach(function(S){var E=S.datas,P=E.maxSize,k=E.startOffsetWidth,L=E.startOffsetHeight,O=a*(k?P[0]/k:0),M=s*(L?P[1]/L:0);v[0]=Math.min(v[0],O),v[1]=Math.min(v[1],M)})}var h=jd(t,this,"dragControlStart",e,function(v,S){return aS(t,v,r,S)});o(),u();var f=function(v){n.setFixedDirection(v),h.forEach(function(S,E){S.setFixedDirection(v),aS(t,S.moveable,r,i[E])})};r.setFixedDirection=f;var g=zt(zt({},n),{targets:t.props.targets,events:h.map(function(v){return zt(zt({},v),{setMin:function(S){v.setMin(S),o()},setMax:function(S){v.setMax(S),u()}})}),setFixedDirection:f,setMin:function(v){n.setMin(v),o()},setMax:function(v){n.setMax(v),u()}}),b=$n(t,"onResizeGroupStart",g);return r.isResize=b!==!1,r.isResize?n:!1},dragGroupControl:function(t,e){var r=e.datas;if(r.isResize){var n=xm(t.props,"resizable");pT(t,"onBeforeResize",function(v){$n(t,"onBeforeResizeGroup",qi(t,e,zt(zt({},v),{targets:n.targets}),!0))});var i=this.dragControl(t,zt(zt({},e),{isGroup:!0}));if(i){var a=i.boundingWidth,s=i.boundingHeight,o=i.dist,u=n.keepRatio,h=[a/(a-o[0]),s/(s-o[1])],f=r.fixedPosition,g=jd(t,this,"dragControl",e,function(v,S){var E=Ht(qu(Kb(t.rotation/180*Math.PI,3),[S.datas.originalX*h[0],S.datas.originalY*h[1],1],3),2),P=E[0],k=E[1];return zt(zt({},S),{parentDist:null,parentScale:h,dragClient:Aa(f,[P,k]),parentKeepRatio:u})}),b=zt({targets:n.targets,events:g},i);return $n(t,"onResizeGroup",b),b}}},dragGroupControlEnd:function(t,e){var r=e.isDrag,n=e.datas;if(n.isResize){this.dragControlEnd(t,e);var i=jd(t,this,"dragControlEnd",e),a=nh(t,e,{targets:t.props.targets,events:i});return $n(t,"onResizeGroupEnd",a),r}},request:function(t){var e={},r=0,n=0,i=!1,a=t.getRect();return{isControl:!0,requestStart:function(s){var o;return i=s.useSnap,{datas:e,parentDirection:s.direction||[1,1],parentIsWidth:(o=s?.horizontal)!==null&&o!==void 0?o:!0,useSnap:i}},request:function(s){return"offsetWidth"in s?r=s.offsetWidth-a.offsetWidth:"deltaWidth"in s&&(r+=s.deltaWidth),"offsetHeight"in s?n=s.offsetHeight-a.offsetHeight:"deltaHeight"in s&&(n+=s.deltaHeight),{datas:e,parentDist:[r,n],parentKeepRatio:s.keepRatio,useSnap:i}},requestEnd:function(){return{datas:e,isDrag:!0,useSnap:i}}}},unset:function(t){t.state.gestos.resizable=null}};function $3(t,e,r,n,i){var a=t.props.groupable,s=t.state,o=s.is3d?4:3,u=e.origin,h=gs(t.state.rootMatrix,vi([u[0],u[1]],a?[0,0]:[s.left,s.top]),o),f=Aa([i.left,i.top],h);e.startAbsoluteOrigin=f,e.prevDeg=Ks(f,[r,n])/Math.PI*180,e.defaultDeg=e.prevDeg,e.prevSnapDeg=0,e.loop=0,e.startDist=zd(f,[r,n])}function yw(t,e,r){var n=r.defaultDeg,i=r.prevDeg,a=i%360,s=Math.floor(i/360);a<0&&(a+=360),a>t&&a>270&&t<90?++s:a<t&&a<90&&t>270&&--s;var o=e*(s*360+t-n);return r.prevDeg=n+o,o}function q3(t,e,r,n){return yw(Ks(n.startAbsoluteOrigin,[t,e])/Math.PI*180,r,n)}function H3(t,e,r,n,i,a){var s=t.props.throttleRotate,o=s===void 0?0:s,u=r.prevSnapDeg,h=0,f=!1;if(a){var g=d1e(t,e,n,i+n);f=g.isSnap,h=i+g.dist}f||(h=Fi(i+n,o));var b=h-i;return r.prevSnapDeg=b,[b-u,b,h]}function MY(t,e,r){var n=Ht(e,4),i=n[0],a=n[1],s=n[2],o=n[3];if(t==="none")return[];if(eu(t))return t.map(function(P){return MY(P,[i,a,s,o],r)[0]});var u=Ht((t||"top").split("-"),2),h=u[0],f=u[1],g=[i,a];h==="left"?g=[s,i]:h==="right"?g=[a,o]:h==="bottom"&&(g=[o,s]);var b=[(g[0][0]+g[1][0])/2,(g[0][1]+g[1][1])/2],v=UY(g,r);if(f){var S=f==="top"||f==="left",E=h==="bottom"||h==="left";b=g[S&&!E||!S&&E?0:1]}return[[b,v]]}function dk(t,e){if(e.isRequest)return e.requestAble==="rotatable";var r=e.inputEvent.target;if(Ol(r,mi("rotation-control"))||t.props.rotateAroundControls&&Ol(r,mi("around-control"))||Ol(r,mi("control"))&&Ol(r,mi("rotatable")))return!0;var n=t.props.rotationTarget;return n?VO(n,!0).some(function(i){return i?r===i||r.contains(i):!1}):!1}var Q_e=`.rotation {
position: absolute;
height: 40px;
width: 1px;
transform-origin: 50% 100%;
height: calc(40px * var(--zoom));
top: auto;
left: 0;
bottom: 100%;
will-change: transform;
}
.rotation .rotation-line {
display: block;
width: 100%;
height: 100%;
transform-origin: 50% 50%;
}
.rotation .rotation-control {
border-color: #4af;
border-color: var(--moveable-color);
background:#fff;
cursor: alias;
}
:global .view-rotation-dragging, .rotatable.direction.control {
cursor: alias;
}
.rotatable.direction.control.move {
cursor: move;
}
`,e1e={name:"rotatable",canPinch:!0,props:["rotatable","rotationPosition","throttleRotate","renderDirections","rotationTarget","rotateAroundControls","edge","resolveAblesWithRotatable","displayAroundControls"],events:["rotateStart","beforeRotate","rotate","rotateEnd","rotateGroupStart","beforeRotateGroup","rotateGroup","rotateGroupEnd"],css:[Q_e],viewClassName:function(t){return t.isDragging("rotatable")?mi("view-rotation-dragging"):""},render:function(t,e){var r=xm(t.props,"rotatable"),n=r.rotatable,i=r.rotationPosition,a=r.zoom,s=r.renderDirections,o=r.rotateAroundControls,u=r.resolveAblesWithRotatable,h=t.getState(),f=h.renderPoses,g=h.direction;if(!n)return null;var b=MY(i,f,g),v=[];if(b.forEach(function(k,L){var O=Ht(k,2),M=O[0],z=O[1];v.push(e.createElement("div",{key:"rotation".concat(L),className:mi("rotation"),style:{transform:"translate(-50%) translate(".concat(M[0],"px, ").concat(M[1],"px) rotate(").concat(z,"rad)")}},e.createElement("div",{className:mi("line rotation-line"),style:{transform:"scaleX(".concat(a,")")}}),e.createElement("div",{className:mi("control rotation-control"),style:{transform:"translate(0.5px) scale(".concat(a,")")}})))}),s){var S=O0(u||{}),E={};S.forEach(function(k){u[k].forEach(function(L){E[L]=k})});var P=[];eu(s)&&(P=s.map(function(k){var L=E[k];return{data:L?{resolve:L}:{},classNames:L?["move"]:[],dir:k}})),v.push.apply(v,vn([],Ht(pY(t,"rotatable",P,e)),!1))}return o&&v.push.apply(v,vn([],Ht(_Y(t,e)),!1)),v},dragControlCondition:dk,dragControlStart:function(t,e){var r,n,i=e.datas,a=e.clientX,s=e.clientY,o=e.parentRotate,u=e.parentFlag,h=e.isPinch,f=e.isRequest,g=t.state,b=g.target,v=g.left,S=g.top,E=g.direction,P=g.beforeDirection,k=g.targetTransform,L=g.moveableClientRect,O=g.offsetMatrix,M=g.targetMatrix,z=g.allMatrix,B=g.width,q=g.height;if(!f&&!b)return!1;var W=t.getRect();i.rect=W,i.transform=k,i.left=v,i.top=S;var G=function(Ne){var Oe=kY(t.state,Ne);i.fixedDirection=Oe.fixedDirection,i.fixedOffset=Oe.fixedOffset,i.fixedPosition=Oe.fixedPosition,ke&&ke.setFixedPosition(Ne)},ie=function(Ne){var Oe=J_e(t.state,Ne);i.fixedDirection=Oe.fixedDirection,i.fixedOffset=Oe.fixedOffset,i.fixedPosition=Oe.fixedPosition,ke&&ke.setFixedDirection(Ne)},Q=a,H=s;if(f||h||u){var ne=o||0;i.beforeInfo={origin:W.beforeOrigin,prevDeg:ne,defaultDeg:ne,prevSnapDeg:0,startDist:0},i.afterInfo=zt(zt({},i.beforeInfo),{origin:W.origin}),i.absoluteInfo=zt(zt({},i.beforeInfo),{origin:W.origin,startValue:ne})}else{var oe=(n=e.inputEvent)===null||n===void 0?void 0:n.target;if(oe){var ce=oe.getAttribute("data-direction")||"",fe=a_e[ce];if(fe){i.isControl=!0,i.isAroundControl=Ol(oe,mi("around-control")),i.controlDirection=fe;var Me=oe.getAttribute("data-resolve");Me&&(i.resolveAble=Me);var me=P1e(g.rootMatrix,g.renderPoses,L);r=Ht(Ll(me,fe),2),Q=r[0],H=r[1]}}i.beforeInfo={origin:W.beforeOrigin},i.afterInfo={origin:W.origin},i.absoluteInfo={origin:W.origin,startValue:W.rotation};var we=G;G=function(Ne){var Oe=g.is3d?4:3,$e=Ht(Aa(XX(M,Oe),Ne),2),De=$e[0],it=$e[1],Ye=qu(O,vm([De,it],Oe)),rt=qu(z,vm([Ne[0],Ne[1]],Oe));we(Ne);var Ie=g.posDelta;i.beforeInfo.origin=vi(Ye,Ie),i.afterInfo.origin=vi(rt,Ie),i.absoluteInfo.origin=vi(rt,Ie),$3(t,i.beforeInfo,Q,H,L),$3(t,i.afterInfo,Q,H,L),$3(t,i.absoluteInfo,Q,H,L)},ie=function(Ne){var Oe=Ll([[0,0],[B,0],[0,q],[B,q]],Ne);G(Oe)}}i.startClientX=Q,i.startClientY=H,i.direction=E,i.beforeDirection=P,i.startValue=0,i.datas={},uT(t,e,"rotate");var Te=!1,ke=!1;if(i.isControl&&i.resolveAble){var he=i.resolveAble;he==="resizable"&&(ke=fk.dragControlStart(t,zt(zt({},new o0("resizable").dragStart([0,0],e)),{parentPosition:i.controlPosition,parentFixedPosition:i.fixedPosition})))}ke||(Te=ic.dragStart(t,new o0().dragStart([0,0],e))),G(k1e(t));var Ee=qi(t,e,zt(zt({set:function(Ne){i.startValue=Ne*Math.PI/180},setFixedDirection:ie,setFixedPosition:G},lT(t,e)),{dragStart:Te,resizeStart:ke})),xe=$n(t,"onRotateStart",Ee);return i.isRotate=xe!==!1,g.snapRenderInfo={request:e.isRequest},i.isRotate?Ee:!1},dragControl:function(t,e){var r,n,i,a=e.datas,s=e.clientDistX,o=e.clientDistY,u=e.parentRotate,h=e.parentFlag,f=e.isPinch,g=e.groupDelta,b=e.resolveMatrix,v=a.beforeDirection,S=a.beforeInfo,E=a.afterInfo,P=a.absoluteInfo,k=a.isRotate,L=a.startValue,O=a.rect,M=a.startClientX,z=a.startClientY;if(k){oT(t,e,"rotate");var B=s_e(e),q=v*B,W=t.props.parentMoveable,G=0,ie,Q,H=0,ne,oe,ce=0,fe,Me,me=180/Math.PI*L,we=P.startValue,Te=!1,ke=M+s,he=z+o;if(!h&&"parentDist"in e){var Ee=e.parentDist;ie=Ee,ne=Ee,fe=Ee}else f||h?(ie=yw(u,v,S),ne=yw(u,q,E),fe=yw(u,q,P)):(ie=q3(ke,he,v,S),ne=q3(ke,he,q,E),fe=q3(ke,he,q,P),Te=!0);if(Q=me+ie,oe=me+ne,Me=we+fe,$n(t,"onBeforeRotate",qi(t,e,{beforeRotation:Q,rotation:oe,absoluteRotation:Me,setRotation:function(Mt){ne=Mt-me,ie=ne,fe=ne}},!0)),r=Ht(H3(t,O,S,ie,me,Te),3),G=r[0],ie=r[1],Q=r[2],n=Ht(H3(t,O,E,ne,me,Te),3),H=n[0],ne=n[1],oe=n[2],i=Ht(H3(t,O,P,fe,we,Te),3),ce=i[0],fe=i[1],Me=i[2],!(!ce&&!H&&!G&&!W&&!b)){var xe=sT(a,"rotate(".concat(oe,"deg)"),"rotate(".concat(ne,"deg)"));b&&(a.fixedPosition=kO(t,a.targetAllTransform,a.fixedDirection,a.fixedOffset,a));var Ne=v_e(t,ne,a),Oe=vi(Aa(g||[0,0],Ne),a.prevInverseDist||[0,0]);a.prevInverseDist=Ne,a.requestValue=null;var $e=hY(t,xe,Oe,f,e),De=$e,it=zd([ke,he],P.startAbsoluteOrigin)-P.startDist,Ye=void 0;if(a.resolveAble==="resizable"){var rt=fk.dragControl(t,zt(zt({},ex(e,t.state,[e.deltaX,e.deltaY],!!f,!1,"resizable")),{resolveMatrix:!0,parentDistance:it}));rt&&(Ye=rt,De=HY(De,rt,e))}var Ie=qi(t,e,zt(zt({delta:H,dist:ne,rotate:oe,rotation:oe,beforeDist:ie,beforeDelta:G,beforeRotate:Q,beforeRotation:Q,absoluteDist:fe,absoluteDelta:ce,absoluteRotate:Me,absoluteRotation:Me,isPinch:!!f,resize:Ye},$e),De));return $n(t,"onRotate",Ie),Ie}}},dragControlEnd:function(t,e){var r=e.datas;if(r.isRotate){r.isRotate=!1;var n=nh(t,e,{});return $n(t,"onRotateEnd",n),n}},dragGroupControlCondition:dk,dragGroupControlStart:function(t,e){var r=e.datas,n=t.state,i=n.left,a=n.top,s=n.beforeOrigin,o=this.dragControlStart(t,e);if(!o)return!1;o.set(r.beforeDirection*t.rotation);var u=jd(t,this,"dragControlStart",e,function(g,b){var v=g.state,S=v.left,E=v.top,P=v.beforeOrigin,k=Aa(vi([S,E],[i,a]),vi(P,s));return b.datas.startGroupClient=k,b.datas.groupClient=k,zt(zt({},b),{parentRotate:0})}),h=zt(zt({},o),{targets:t.props.targets,events:u}),f=$n(t,"onRotateGroupStart",h);return r.isRotate=f!==!1,r.isRotate?o:!1},dragGroupControl:function(t,e){var r=e.datas;if(r.isRotate){pT(t,"onBeforeRotate",function(h){$n(t,"onBeforeRotateGroup",qi(t,e,zt(zt({},h),{targets:t.props.targets}),!0))});var n=this.dragControl(t,e);if(n){var i=r.beforeDirection,a=n.beforeDist,s=a/180*Math.PI,o=jd(t,this,"dragControl",e,function(h,f){var g=f.datas.startGroupClient,b=Ht(f.datas.groupClient,2),v=b[0],S=b[1],E=Ht(Zb(g,s*i),2),P=E[0],k=E[1],L=[P-v,k-S];return f.datas.groupClient=[P,k],zt(zt({},f),{parentRotate:a,groupDelta:L})});t.rotation=i*n.beforeRotation;var u=zt({targets:t.props.targets,events:o,set:function(h){t.rotation=h},setGroupRotation:function(h){t.rotation=h}},n);return $n(t,"onRotateGroup",u),u}}},dragGroupControlEnd:function(t,e){var r=e.isDrag,n=e.datas;if(n.isRotate){this.dragControlEnd(t,e);var i=jd(t,this,"dragControlEnd",e),a=nh(t,e,{targets:t.props.targets,events:i});return $n(t,"onRotateGroupEnd",a),r}},request:function(t){var e={},r=0,n=t.getRotation();return{isControl:!0,requestStart:function(){return{datas:e}},request:function(i){return"deltaRotate"in i?r+=i.deltaRotate:"rotate"in i&&(r=i.rotate-n),{datas:e,parentDist:r}},requestEnd:function(){return{datas:e,isDrag:!0}}}}};function t1e(t,e){var r,n=t.direction,i=t.classNames,a=t.size,s=t.pos,o=t.zoom,u=t.key,h=n==="horizontal",f=h?"Y":"X";return e.createElement("div",{key:u,className:i.join(" "),style:(r={},r[h?"width":"height"]="".concat(a),r.transform="translate(".concat(s[0],", ").concat(s[1],") translate").concat(f,"(-50%) scale").concat(f,"(").concat(o,")"),r)})}function DO(t,e){return t1e(zt(zt({},t),{classNames:vn([mi("line","guideline",t.direction)],Ht(t.classNames),!1).filter(function(r){return r}),size:t.size||"".concat(t.sizeValue,"px"),pos:t.pos||t.posValue.map(function(r){return"".concat(Fi(r,.1),"px")})}),e)}function nz(t,e,r,n,i,a,s,o){var u=t.props.zoom;return r.map(function(h,f){var g=h.type,b=h.pos,v=[0,0];return v[s]=n,v[s?0:1]=-i+b,DO({key:"".concat(e,"TargetGuideline").concat(f),classNames:[mi("target","bold",g)],posValue:v,sizeValue:a,zoom:u,direction:e},o)})}function iz(t,e,r,n,i,a){var s=t.props,o=s.zoom,u=s.isDisplayInnerSnapDigit,h=e==="horizontal"?Qp:eg,f=i[h.start],g=i[h.end];return r.filter(function(b){var v=b.hide,S=b.elementRect;if(v)return!1;if(u&&S){var E=S.rect;if(E[h.start]<=f&&g<=E[h.end])return!1}return!0}).map(function(b,v){var S=b.pos,E=b.size,P=b.element,k=b.className,L=[-n[0]+S[0],-n[1]+S[1]];return DO({key:"".concat(e,"-default-guideline-").concat(v),classNames:P?[mi("bold"),k]:[mi("normal"),k],direction:e,posValue:L,sizeValue:E,zoom:o},a)})}function K_(t,e,r,n,i,a,s,o){var u,h=t.props,f=h.snapDigit,g=f===void 0?0:f,b=h.isDisplaySnapDigit,v=b===void 0?!0:b,S=h.snapDistFormat,E=S===void 0?function(z,B){return z}:S,P=h.zoom,k=e==="horizontal"?"X":"Y",L=e==="vertical"?"height":"width",O=Math.abs(i),M=v?parseFloat(O.toFixed(g)):0;return o.createElement("div",{key:"".concat(e,"-").concat(r,"-guideline-").concat(n),className:mi("guideline-group",e),style:(u={left:"".concat(a[0],"px"),top:"".concat(a[1],"px")},u[L]="".concat(O,"px"),u)},DO({direction:e,classNames:[mi(r),s],size:"100%",posValue:[0,0],sizeValue:O,zoom:P},o),o.createElement("div",{className:mi("size-value","gap"),style:{transform:"translate".concat(k,"(-50%) scale(").concat(P,")")}},M>0?E(M,e):""))}function r1e(t,e,r,n){var i=t==="vertical"?0:1,a=t==="vertical"?1:0,s=i?Qp:eg,o=r[s.start],u=r[s.end];return WY(e,function(h){return h.pos[i]}).map(function(h){var f=[],g=[],b=[];return h.forEach(function(v){var S,E,P=v.element,k=v.elementRect.rect;if(k[s.end]<o)f.push(v);else if(u<k[s.start])g.push(v);else if(k[s.start]<=o&&u<=k[s.end]&&n){var L=v.pos,O={element:P,rect:zt(zt({},k),(S={},S[s.end]=k[s.start],S))},M={element:P,rect:zt(zt({},k),(E={},E[s.start]=k[s.end],E))},z=[0,0],B=[0,0];z[i]=L[i],z[a]=L[a],B[i]=L[i],B[a]=L[a]+v.size,f.push({type:t,pos:z,size:0,elementRect:O,direction:"",elementDirection:"end"}),g.push({type:t,pos:B,size:0,elementRect:M,direction:"",elementDirection:"start"})}}),f.sort(function(v,S){return S.pos[a]-v.pos[a]}),g.sort(function(v,S){return v.pos[a]-S.pos[a]}),{total:h,start:f,end:g,inner:b}})}function n1e(t,e,r,n,i){var a=t.props.isDisplayInnerSnapDigit,s=[];return["vertical","horizontal"].forEach(function(o){var u=e.filter(function(P){return P.type===o}),h=o==="vertical"?1:0,f=h?0:1,g=r1e(o,u,n,a),b=h?eg:Qp,v=h?Qp:eg,S=n[b.start],E=n[b.end];g.forEach(function(P){var k=P.total,L=P.start,O=P.end,M=P.inner,z=r[f]+k[0].pos[f]-n[v.start],B=n;L.forEach(function(q){var W=q.elementRect.rect,G=B[b.start]-W[b.end];if(G>0){var ie=[0,0];ie[h]=r[h]+B[b.start]-S-G,ie[f]=z,s.push(K_(t,o,"dashed",s.length,G,ie,q.className,i))}B=W}),B=n,O.forEach(function(q){var W=q.elementRect.rect,G=W[b.start]-B[b.end];if(G>0){var ie=[0,0];ie[h]=r[h]+B[b.end]-S,ie[f]=z,s.push(K_(t,o,"dashed",s.length,G,ie,q.className,i))}B=W}),M.forEach(function(q){var W=q.elementRect.rect,G=S-W[b.start],ie=W[b.end]-E,Q=[0,0],H=[0,0];Q[h]=r[h]-G,Q[f]=z,H[h]=r[h]+E-S,H[f]=z,s.push(K_(t,o,"dashed",s.length,G,Q,q.className,i)),s.push(K_(t,o,"dashed",s.length,ie,H,q.className,i))})})}),s}function i1e(t,e,r,n,i){var a=[];return["horizontal","vertical"].forEach(function(s){var o=e.filter(function(P){return P.type===s}).slice(0,1),u=s==="vertical"?0:1,h=u?0:1,f=u?eg:Qp,g=u?Qp:eg,b=n[f.start],v=n[f.end],S=n[g.start],E=n[g.end];o.forEach(function(P){var k=P.gap,L=P.gapRects,O=Math.max.apply(Math,vn([S],Ht(L.map(function(B){var q=B.rect;return q[g.start]})),!1)),M=Math.min.apply(Math,vn([E],Ht(L.map(function(B){var q=B.rect;return q[g.end]})),!1)),z=(O+M)/2;O===M||z===(S+E)/2||L.forEach(function(B){var q=B.rect,W=B.className,G=[r[0],r[1]];if(q[f.end]<b)G[u]+=q[f.end]-b;else if(v<q[f.start])G[u]+=q[f.start]-b-k;else return;G[h]+=z-S,a.push(K_(t,u?"vertical":"horizontal","gap",a.length,k,G,W,i))})})}),a}function pk(t){var e,r,n=t.state,i=n.containerClientRect,a=n.hasFixed,s=i.overflow,o=i.scrollHeight,u=i.scrollWidth,h=i.clientHeight,f=i.clientWidth,g=i.clientLeft,b=i.clientTop,v=t.props,S=v.snapGap,E=S===void 0?!0:S,P=v.verticalGuidelines,k=v.horizontalGuidelines,L=v.snapThreshold,O=L===void 0?5:L,M=v.maxSnapElementGuidelineDistance,z=M===void 0?1/0:M,B=v.isDisplayGridGuidelines,q=xh(Mh(t.state)),W=q.top,G=q.left,ie=q.bottom,Q=q.right,H={top:W,left:G,bottom:ie,right:Q,center:(G+Q)/2,middle:(W+ie)/2},ne=l1e(t),oe=vn([],Ht(ne),!1),ce=((r=(e=n.snapThresholdInfo)===null||e===void 0?void 0:e.multiples)!==null&&r!==void 0?r:[1,1]).map(function(we){return we*O});E&&oe.push.apply(oe,vn([],Ht(a1e(t,H,ce)),!1));var fe=zt({},n.snapOffset||{left:0,top:0,bottom:0,right:0});if(oe.push.apply(oe,vn([],Ht(s1e(t,s?u:f,s?o:h,g,b,fe,B)),!1)),a){var Me=i.left,me=i.top;fe.left+=Me,fe.top+=me,fe.right+=Me,fe.bottom+=me}return oe.push.apply(oe,vn([],Ht(OY(k||!1,P||!1,s?u:f,s?o:h,g,b,fe)),!1)),oe=oe.filter(function(we){var Te=we.element,ke=we.elementRect,he=we.type;if(!Te||!ke)return!0;var Ee=ke.rect;return RY(H,Ee,he,z)}),oe}function a1e(t,e,r){var n=t.props,i=n.maxSnapElementGuidelineDistance,a=i===void 0?1/0:i,s=n.maxSnapElementGapDistance,o=s===void 0?1/0:s,u=t.state.elementRects,h=[];return[["vertical",Qp,eg],["horizontal",eg,Qp]].forEach(function(f){var g=Ht(f,3),b=g[0],v=g[1],S=g[2],E=e[v.start],P=e[v.end],k=e[v.center],L=e[S.start],O=e[S.end],M={left:r[0],top:r[1]};function z(W){var G=W.rect,ie=M[v.start];return G[v.end]<E+ie?E-G[v.end]:P-ie<G[v.start]?G[v.start]-P:-1}var B=u.filter(function(W){var G=W.rect;return G[S.start]>O||G[S.end]<L?!1:z(W)>0}).sort(function(W,G){return z(W)-z(G)}),q=[];B.forEach(function(W){B.forEach(function(G){if(W!==G){var ie=W.rect,Q=G.rect,H=ie[S.start],ne=ie[S.end],oe=Q[S.start],ce=Q[S.end];H>ce||oe>ne||q.push([W,G])}})}),q.forEach(function(W){var G=Ht(W,2),ie=G[0],Q=G[1],H=ie.rect,ne=Q.rect,oe=H[v.start],ce=H[v.end],fe=ne[v.start],Me=ne[v.end],me=M[v.start],we=0,Te=0,ke=!1,he=!1,Ee=!1;if(ce<=E&&P<=fe){if(he=!0,we=(fe-ce-(P-E))/2,Te=ce+we+(P-E)/2,en(Te-k)>me)return}else if(ce<fe&&Me<E+me){if(ke=!0,we=fe-ce,Te=Me+we,en(Te-E)>me)return}else if(ce<fe&&P-me<oe){if(Ee=!0,we=fe-ce,Te=oe-we,en(Te-P)>me)return}else return;we&&RY(e,ne,b,a)&&(we>o||h.push({type:b,pos:b==="vertical"?[Te,0]:[0,Te],element:Q.element,size:0,className:Q.className,isStart:ke,isCenter:he,isEnd:Ee,gap:we,hide:!0,gapRects:[ie,Q],direction:"",elementDirection:""}))})}),h}function o1e(t,e,r,n){var i,a,s=t.props,o=t.state,u=s.snapGridAll,h=s.snapGridWidth,f=h===void 0?0:h,g=s.snapGridHeight,b=g===void 0?0:g,v=o.snapRenderInfo,S=v&&(((i=v.direction)===null||i===void 0?void 0:i[0])||((a=v.direction)===null||a===void 0?void 0:a[1])),E=t.moveables;if(u&&E&&S&&(f||b)){if(o.snapThresholdInfo)return;o.snapThresholdInfo={multiples:[1,1],offset:[0,0]};var P=t.getRect(),k=P.children,L=v.direction;if(k){var O=L.map(function(z,B){var q=B===0?{snapSize:f,posName:"left",sizeName:"width",clientOffset:n.left-e}:{snapSize:b,posName:"top",sizeName:"height",clientOffset:n.top-r},W=q.snapSize,G=q.posName,ie=q.sizeName,Q=q.clientOffset;if(!W)return{dir:z,multiple:1,snapSize:W,snapOffset:0};var H=P[ie],ne=P[G],oe=Qve(k.map(function(ke){return[ke[G]-ne,ke[ie],H-ke[ie]-ke[G]+ne]})).filter(function(ke){return ke}).sort(function(ke,he){return ke-he}),ce=oe[0],fe=oe.map(function(ke){return Fi(ke/ce,.1)*W}),Me=1,me=Fi(H/ce,.1);for(Me=1;Me<=10&&!fe.every(function(ke){return ke*Me%1===0});++Me);var we=(-z+1)/2,Te=tS(ne-Q,ne-Q+H,we,1-we);return{multiple:me*Me,dir:z,snapSize:W,snapOffset:Math.round(Te/W)}}),M=O.map(function(z){return z.multiple||1});o.snapThresholdInfo.multiples=M,o.snapThresholdInfo.offset=O.map(function(z){return z.snapOffset}),O.forEach(function(z,B){z.snapSize})}}else o.snapThresholdInfo=null}function s1e(t,e,r,n,i,a,s){n===void 0&&(n=0),i===void 0&&(i=0);var o=t.props,u=t.state,h=o.snapGridWidth,f=h===void 0?0:h,g=o.snapGridHeight,b=g===void 0?0:g,v=[],S=a.left,E=a.top,P=[0,0];o1e(t,n,i,a);var k=u.snapThresholdInfo,L=f,O=b;if(k&&(f*=k.multiples[0]||1,b*=k.multiples[1]||1,P=k.offset),b){for(var M=function(B){v.push({type:"horizontal",pos:[S,Fi(P[1]*O+B-i+E,.1)],className:mi("grid-guideline"),size:e,hide:!s,direction:"",grid:!0})},z=0;z<=r*2;z+=b)M(z);for(var z=-b;z>=-r;z-=b)M(z)}if(f){for(var M=function(q){v.push({type:"vertical",pos:[Fi(P[0]*L+q-n+S,.1),E],className:mi("grid-guideline"),size:r,hide:!s,direction:"",grid:!0})},z=0;z<=e*2;z+=f)M(z);for(var z=-f;z>=-e;z-=f)M(z)}return v}function RY(t,e,r,n){return r==="horizontal"?en(t.right-e.left)<=n||en(t.left-e.right)<=n||t.left<=e.right&&e.left<=t.right:r==="vertical"?en(t.bottom-e.top)<=n||en(t.top-e.bottom)<=n||t.top<=e.bottom&&e.top<=t.bottom:!0}function l1e(t){var e=t.state,r=t.props.elementGuidelines,n=r===void 0?[]:r;if(!n.length)return e.elementRects=[],[];var i=(e.elementRects||[]).filter(function(b){return!b.refresh}),a=n.map(function(b){return sf(b)&&"element"in b?zt(zt({},b),{element:Jf(b.element,!0)}):{element:Jf(b,!0)}}).filter(function(b){return b.element}),s=_0e(i.map(function(b){return b.element}),a.map(function(b){return b.element})),o=s.maintained,u=s.added,h=[];o.forEach(function(b){var v=Ht(b,2),S=v[0],E=v[1];h[E]=i[S]}),u1e(t,u.map(function(b){return a[b]})).map(function(b,v){h[u[v]]=b}),e.elementRects=h;var f=RO(t.props.elementSnapDirections),g=[];return h.forEach(function(b){var v=b.element,S=b.top,E=S===void 0?f.top:S,P=b.left,k=P===void 0?f.left:P,L=b.right,O=L===void 0?f.right:L,M=b.bottom,z=M===void 0?f.bottom:M,B=b.center,q=B===void 0?f.center:B,W=b.middle,G=W===void 0?f.middle:W,ie=b.className,Q=b.rect,H=OO({top:E,right:O,left:k,bottom:z,center:q,middle:G},Q),ne=H.horizontal,oe=H.vertical,ce=H.horizontalNames,fe=H.verticalNames,Me=Q.top,me=Q.left,we=Q.right-me,Te=Q.bottom-Me,ke=[we,Te];oe.forEach(function(he,Ee){g.push({type:"vertical",element:v,pos:[Fi(he,.1),Me],size:Te,sizes:ke,className:ie,elementRect:b,elementDirection:YB[fe[Ee]]||fe[Ee],direction:""})}),ne.forEach(function(he,Ee){g.push({type:"horizontal",element:v,pos:[me,Fi(he,.1)],size:we,sizes:ke,className:ie,elementRect:b,elementDirection:YB[ce[Ee]]||ce[Ee],direction:""})})}),g}function az(t,e){return t?t.map(function(r){var n=sf(r)?r:{pos:r},i=n.pos;return rb(i)?n:zt(zt({},n),{pos:vo(i,e)})}):[]}function OY(t,e,r,n,i,a,s){i===void 0&&(i=0),a===void 0&&(a=0),s===void 0&&(s={left:0,top:0,right:0,bottom:0});var o=[],u=s.left,h=s.top,f=s.bottom,g=s.right,b=r+g-u,v=n+f-h;return az(t,v).forEach(function(S){o.push({type:"horizontal",pos:[u,Fi(S.pos-a+h,.1)],size:b,className:S.className,direction:""})}),az(e,b).forEach(function(S){o.push({type:"vertical",pos:[Fi(S.pos-i+u,.1),h],size:v,className:S.className,direction:""})}),o}function u1e(t,e){if(!e.length)return[];var r=t.props.groupable,n=t.state,i=n.containerClientRect,a=n.rootMatrix,s=n.is3d,o=n.offsetDelta,u=s?4:3,h=Ht(O_e(a,i,u),2),f=h[0],g=h[1],b=r?0:o[0],v=r?0:o[1];return e.map(function(S){var E=S.element.getBoundingClientRect(),P=E.left-f-b,k=E.top-g-v,L=k+E.height,O=P+E.width,M=Ht(u0(a,[P,k],u),2),z=M[0],B=M[1],q=Ht(u0(a,[O,L],u),2),W=q[0],G=q[1];return zt(zt({},S),{rect:{left:z,right:W,top:B,bottom:G,center:(z+W)/2,middle:(B+G)/2}})})}function y2(t){var e=t.state,r=e.container,n=t.props.snapContainer||r;if(e.snapContainer===n&&e.guidelines&&e.guidelines.length)return!1;var i=e.containerClientRect,a={left:0,top:0,bottom:0,right:0};if(r!==n){var s=Jf(n,!0);if(s){var o=k1(s),u=hz(e,[o.left-i.left,o.top-i.top]),h=hz(e,[o.right-i.right,o.bottom-i.bottom]);a.left=Fi(u[0],1e-5),a.top=Fi(u[1],1e-5),a.right=Fi(h[0],1e-5),a.bottom=Fi(h[1],1e-5)}}return e.snapContainer=n,e.snapOffset=a,e.guidelines=pk(t),e.enableSnap=!0,!0}function LY(t,e,r,n,i,a){var s=Vm(t,e,r,a?4:3),o=Ll(s,n);return BO(s,vi(i,o))}function oz(t){return t?t/en(t):0}function c1e(t,e,r,n,i,a){var s=a.fixedDirection,o=F_e(r,s,n),u=NO(t,e,r,n),h=vn(vn([],Ht(Y_e(t,e,o,n,i,a)),!1),Ht(IY(t,u,a)),!1),f=oS(h,0),g=oS(h,1);return{width:{isBound:f.isBound,offset:f.offset[0]},height:{isBound:g.isBound,offset:g.offset[1]}}}function h1e(t,e,r,n,i,a,s,o,u){var h=Ll(e,s),f=fT(t,o,{vertical:[h[0]],horizontal:[h[1]]}),g=f.horizontal.offset,b=f.vertical.offset;if(Fi(b,sk)||Fi(g,sk)){var v=Ht(ud({datas:u,distX:-b,distY:-g}),2),S=v[0],E=v[1],P=Math.min(i||1/0,r+s[0]*S),k=Math.min(a||1/0,n+s[1]*E);return[P-r,k-n]}return[0,0]}function NY(t,e,r,n,i,a,s,o){for(var u=Mh(t.state),h=t.props.keepRatio,f=0,g=0,b=0;b<2;++b){var v=e(f,g),S=c1e(t,v,i,h,s,o),E=S.width,P=S.height,k=E.isBound,L=P.isBound,O=E.offset,M=P.offset;if(b===1&&(k||(O=0),L||(M=0)),b===0&&s&&!k&&!L)return[0,0];if(h){var z=en(O)*(r?1/r:1),B=en(M)*(n?1/n:1),q=k&&L?z<B:L||!k&&z<B;q?O=r*M/n:M=n*O/r}f+=O,g+=M}if(!h&&i[0]&&i[1]){var W=K_e(t,u,i,a,o),G=W.maxWidth,ie=W.maxHeight,Q=Ht(h1e(t,e(f,g).map(function(oe){return oe.map(function(ce){return Fi(ce,sk)})}),r+f,n+g,G,ie,i,s,o),2),O=Q[0],M=Q[1];f+=O,g+=M}return[f,g]}function I1(t){return t<0&&(t=t%360+360),t%=360,t}function f1e(t,e){e=I1(e);var r=Math.floor(t/360),n=r*360+360-e,i=r*360+e;return en(t-n)<en(t-i)?n:i}function W3(t,e){t=I1(t),e=I1(e);var r=I1(t-e);return Math.min(r,360-r)}function d1e(t,e,r,n){var i,a=t.props,s=(i=a[bY])!==null&&i!==void 0?i:5,o=a[xY];if(D0(t,"rotatable")){var u=e.pos1,h=e.pos2,f=e.pos3,g=e.pos4,b=e.origin,v=r*Math.PI/180,S=[u,h,f,g].map(function(M){return vi(M,b)}),E=S.map(function(M){return Zb(M,v)}),P=vn(vn([],Ht(P_e(t,S,E,b,r)),!1),Ht($_e(t,S,E,b,r)),!1);P.sort(function(M,z){return en(M-r)-en(z-r)});var k=P.length>0;if(k)return{isSnap:k,dist:k?P[0]:r}}if(o?.length&&s){var L=o.slice().sort(function(M,z){return W3(M,n)-W3(z,n)}),O=L[0];if(W3(O,n)<=s)return{isSnap:!0,dist:r+f1e(n,O)-n}}return{isSnap:!1,dist:r}}function p1e(t,e,r,n,i,a,s){if(!D0(t,"resizable"))return[0,0];var o=s.fixedDirection,u=s.nextAllMatrix,h=t.state,f=h.allMatrix,g=h.is3d;return NY(t,function(b,v){return LY(u||f,e+b,r+v,o,i,g)},e,r,n,i,a,s)}function g1e(t,e,r,n,i){if(!D0(t,"scalable"))return[0,0];var a=i.startOffsetWidth,s=i.startOffsetHeight,o=i.fixedPosition,u=i.fixedDirection,h=i.is3d,f=NY(t,function(g,b){return LY(p_e(i,Aa(e,[g/a,b/s])),a,s,u,o,h)},a,s,r,o,n,i);return[f[0]/a,f[1]/s]}function m1e(t,e){e.absolutePoses=Mh(t.state)}function sz(t){var e=[];return t.forEach(function(r){r.guidelineInfos.forEach(function(n){var i=n.guideline;rh(e,function(a){return a.guideline===i})||(i.direction="",e.push({guideline:i,posInfo:r}))})}),e.map(function(r){var n=r.guideline,i=r.posInfo;return zt(zt({},n),{direction:i.direction})})}function lz(t,e,r,n,i,a){var s=MO(cT(t,a),e,r),o=s.vertical,u=s.horizontal,h=Cv();o.forEach(function(S){S.isBound&&(S.direction==="start"&&(h.left=!0),S.direction==="end"&&(h.right=!0),n.push({type:"bounds",pos:S.pos}))}),u.forEach(function(S){S.isBound&&(S.direction==="start"&&(h.top=!0),S.direction==="end"&&(h.bottom=!0),i.push({type:"bounds",pos:S.pos}))});var f=q_e(t),g=f.boundMap,b=f.vertical,v=f.horizontal;return b.forEach(function(S){Gd(n,function(E){var P=E.type,k=E.pos;return P==="bounds"&&k===S})>=0||n.push({type:"bounds",pos:S})}),v.forEach(function(S){Gd(i,function(E){var P=E.type,k=E.pos;return P==="bounds"&&k===S})>=0||i.push({type:"bounds",pos:S})}),{boundMap:h,innerBoundMap:g}}var y1e=UO("",["resizable","scalable"]),v1e={name:"snappable",dragRelation:"strong",props:["snappable","snapContainer","snapDirections","elementSnapDirections","snapGap","snapGridWidth","snapGridHeight","isDisplaySnapDigit","isDisplayInnerSnapDigit","isDisplayGridGuidelines","snapDigit","snapThreshold","snapRenderThreshold","snapGridAll",bY,xY,wY,SY,"horizontalGuidelines","verticalGuidelines","elementGuidelines","bounds","innerBounds","snapDistFormat","maxSnapElementGuidelineDistance","maxSnapElementGapDistance"],events:["snap","bound"],css:[`:host {
--bounds-color: #d66;
}
.guideline {
pointer-events: none;
z-index: 2;
}
.guideline.bounds {
background: #d66;
background: var(--bounds-color);
}
.guideline-group {
position: absolute;
top: 0;
left: 0;
}
.guideline-group .size-value {
position: absolute;
color: #f55;
font-size: 12px;
font-size: calc(12px * var(--zoom));
font-weight: bold;
}
.guideline-group.horizontal .size-value {
transform-origin: 50% 100%;
transform: translateX(-50%);
left: 50%;
bottom: 5px;
bottom: calc(2px + 3px * var(--zoom));
}
.guideline-group.vertical .size-value {
transform-origin: 0% 50%;
top: 50%;
transform: translateY(-50%);
left: 5px;
left: calc(2px + 3px * var(--zoom));
}
.guideline.gap {
background: #f55;
}
.size-value.gap {
color: #f55;
}
`],render:function(t,e){var r=t.state,n=r.top,i=r.left,a=r.pos1,s=r.pos2,o=r.pos3,u=r.pos4,h=r.snapRenderInfo,f=t.props.snapRenderThreshold,g=f===void 0?1:f;if(!h||!h.render||!D0(t,""))return Iv(t,"boundMap",Cv(),function(xe){return JSON.stringify(xe)}),Iv(t,"innerBoundMap",Cv(),function(xe){return JSON.stringify(xe)}),[];r.guidelines=pk(t);var b=Math.min(a[0],s[0],o[0],u[0]),v=Math.min(a[1],s[1],o[1],u[1]),S=h.externalPoses||[],E=Mh(t.state),P=[],k=[],L=[],O=[],M=[],z=xh(E),B=z.width,q=z.height,W=z.top,G=z.left,ie=z.bottom,Q=z.right,H={left:G,right:Q,top:W,bottom:ie,center:(G+Q)/2,middle:(W+ie)/2},ne=S.length>0,oe=ne?xh(S):{};if(!h.request){if(h.direction&&M.push(D_e(t,E,h.direction,g,g)),h.snap){var ce=xh(E);h.center&&(ce.middle=(ce.top+ce.bottom)/2,ce.center=(ce.left+ce.right)/2),M.push(ZB(t,ce,g,g))}ne&&(h.center&&(oe.middle=(oe.top+oe.bottom)/2,oe.center=(oe.left+oe.right)/2),M.push(ZB(t,oe,g,g))),M.forEach(function(xe){var Ne=xe.vertical.posInfos,Oe=xe.horizontal.posInfos;P.push.apply(P,vn([],Ht(Ne.filter(function($e){var De=$e.guidelineInfos;return De.some(function(it){var Ye=it.guideline;return!Ye.hide})}).map(function($e){return{type:"snap",pos:$e.pos}})),!1)),k.push.apply(k,vn([],Ht(Oe.filter(function($e){var De=$e.guidelineInfos;return De.some(function(it){var Ye=it.guideline;return!Ye.hide})}).map(function($e){return{type:"snap",pos:$e.pos}})),!1)),L.push.apply(L,vn([],Ht(sz(Ne)),!1)),O.push.apply(O,vn([],Ht(sz(Oe)),!1))})}var fe=lz(t,[G,Q],[W,ie],P,k),Me=fe.boundMap,me=fe.innerBoundMap;ne&&lz(t,[oe.left,oe.right],[oe.top,oe.bottom],P,k,h.externalBounds);var we=vn(vn([],Ht(L),!1),Ht(O),!1),Te=we.filter(function(xe){return xe.element&&!xe.gapRects}),ke=we.filter(function(xe){return xe.gapRects}).sort(function(xe,Ne){return xe.gap-Ne.gap});$n(t,"onSnap",{guidelines:we.filter(function(xe){var Ne=xe.element;return!Ne}),elements:Te,gaps:ke},!0);var he=Iv(t,"boundMap",Me,function(xe){return JSON.stringify(xe)},Cv()),Ee=Iv(t,"innerBoundMap",me,function(xe){return JSON.stringify(xe)},Cv());return(Me===he||me===Ee)&&$n(t,"onBound",{bounds:Me,innerBounds:me},!0),vn(vn(vn(vn(vn(vn([],Ht(n1e(t,Te,[b,v],H,e)),!1),Ht(i1e(t,ke,[b,v],H,e)),!1),Ht(iz(t,"horizontal",O,[i,n],H,e)),!1),Ht(iz(t,"vertical",L,[i,n],H,e)),!1),Ht(nz(t,"horizontal",k,b,n,B,0,e)),!1),Ht(nz(t,"vertical",P,v,i,q,1,e)),!1)},dragStart:function(t,e){t.state.snapRenderInfo={request:e.isRequest,snap:!0,center:!0},y2(t)},drag:function(t){var e=t.state;y2(t)||(e.guidelines=pk(t)),e.snapRenderInfo&&(e.snapRenderInfo.render=!0)},pinchStart:function(t){this.unset(t)},dragEnd:function(t){this.unset(t)},dragControlCondition:function(t,e){if(y1e(t,e)||dk(t,e))return!0;if(!e.isRequest&&e.inputEvent)return Ol(e.inputEvent.target,mi("snap-control"))},dragControlStart:function(t){t.state.snapRenderInfo=null,y2(t)},dragControl:function(t){this.drag(t)},dragControlEnd:function(t){this.unset(t)},dragGroupStart:function(t,e){this.dragStart(t,e)},dragGroup:function(t){this.drag(t)},dragGroupEnd:function(t){this.unset(t)},dragGroupControlStart:function(t){t.state.snapRenderInfo=null,y2(t)},dragGroupControl:function(t){this.drag(t)},dragGroupControlEnd:function(t){this.unset(t)},unset:function(t){var e=t.state;e.enableSnap=!1,e.guidelines=[],e.snapRenderInfo=null,e.elementRects=[]}};function _1e(t,e){return[t[0]*e[0],t[1]*e[1]]}function mi(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return Dve.apply(void 0,vn([AO],Ht(t),!1))}function DY(t){t()}function b1e(t){return!t||t==="none"?[1,0,0,1,0,0]:sf(t)?t:ib(t)}function P1(t,e,r){return rS(e,_m(r,e),t,_m(r.map(function(n){return-n}),e))}function x1e(t,e,r){if(e==="%"){var n=FO(t.ownerSVGElement);return n[r?"width":"height"]/100}return 1}function w1e(t){var e=S1e(zO(t,":before"));return e.map(function(r,n){var i=Yb(r),a=i.value,s=i.unit;return a*x1e(t,s,n===0)})}function lS(t){return t?t.split(" "):["0","0"]}function S1e(t){return lS(t.transformOrigin)}function FY(t){var e=Ec(t),r=e("transform");if(r&&r!=="none")return r;if("transform"in t){var n=t.transform,i=n.baseVal;if(!i)return"";var a=i.length;if(!a)return"";for(var s=[],o=function(h){var f=i[h].matrix;s.push("matrix(".concat(["a","b","c","d","e","f"].map(function(g){return f[g]}).join(", "),")"))},u=0;u<a;++u)o(u);return s.join(" ")}return""}function ob(t,e,r,n,i){var a,s,o=_O(t)||cg(t),u=!1,h,f;if(!t||r)h=t;else{var g=(a=t?.assignedSlot)===null||a===void 0?void 0:a.parentElement,b=t.parentElement;g?(u=!0,f=b,h=g):h=b}for(var v=!1,S=t===e||h===e,E="relative",P=1,k=parseFloat(i?.("zoom"))||1,L=i?.("position");h&&h!==o;){e===h&&(S=!0);var O=Ec(h),M=h.tagName.toLowerCase(),z=FY(h),B=O("willChange"),q=parseFloat(O("zoom"))||1;if(E=O("position"),n&&q!==1){P=q;break}if(!r&&n&&k!==1&&L&&L!=="absolute"||M==="svg"||M==="foreignobject"||E!=="static"||z&&z!=="none"||B==="transform")break;var W=(s=t?.assignedSlot)===null||s===void 0?void 0:s.parentNode,G=h.parentNode;W&&(u=!0,f=G);var ie=G;if(ie&&ie.nodeType===11){h=ie.host,v=!0,E=Ec(h)("position");break}h=ie,E="relative"}return{offsetZoom:P,hasSlot:u,parentSlotElement:f,isCustomElement:v,isStatic:E==="static",isEnd:S||!h||h===o,offsetParent:h||o}}function E1e(t,e){var r,n=t.tagName.toLowerCase(),i=t.offsetLeft,a=t.offsetTop,s=Ec(t),o=pO(i),u=!o,h,f;return!u&&(n!=="svg"||t.ownerSVGElement)?(h=nY?w1e(t):lS(s("transformOrigin")).map(function(g){return parseFloat(g)}),f=h.slice(),u=!0,n==="svg"?(i=0,a=0):(r=Ht(A1e(t,h,t===e&&e.tagName.toLowerCase()==="g"),4),i=r[0],a=r[1],h[0]=r[2],h[1]=r[3])):(h=lS(s("transformOrigin")).map(function(g){return parseFloat(g)}),f=h.slice()),{tagName:n,isSVG:o,hasOffset:u,offset:[i||0,a||0],origin:h,targetOrigin:f}}function BY(t,e){var r=Ec(t),n=Ec(cg(t)),i=n("position");if(!e&&(!i||i==="static"))return[0,0];var a=parseInt(n("marginLeft"),10),s=parseInt(n("marginTop"),10);return r("position")==="absolute"&&((r("top")!=="auto"||r("bottom")!=="auto")&&(s=0),(r("left")!=="auto"||r("right")!=="auto")&&(a=0)),[a,s]}function gk(t){t.forEach(function(e){var r=e.matrix;r&&(e.matrix=lf(r,3,4))})}function T1e(t){for(var e=t.parentElement,r=!1,n=cg(t);e;){var i=zO(e).transform;if(i&&i!=="none"){r=!0;break}if(e===n)break;e=e.parentElement}return{fixedContainer:e||n,hasTransform:r}}function dT(t,e){return e===void 0&&(e=t.length>9),"".concat(e?"matrix3d":"matrix","(").concat(YX(t,!e).join(","),")")}function FO(t){var e=t.clientWidth,r=t.clientHeight;if(!t)return{x:0,y:0,width:0,height:0,clientWidth:e,clientHeight:r};var n=t.viewBox,i=n&&n.baseVal||{x:0,y:0,width:0,height:0};return{x:i.x,y:i.y,width:i.width||e,height:i.height||r,clientWidth:e,clientHeight:r}}function C1e(t,e){var r,n=FO(t),i=n.width,a=n.height,s=n.clientWidth,o=n.clientHeight,u=s/i,h=o/a,f=t.preserveAspectRatio.baseVal,g=f.align,b=f.meetOrSlice,v=[0,0],S=[u,h],E=[0,0];if(g!==1){var P=(g-2)%3,k=Math.floor((g-2)/3);v[0]=i*P/2,v[1]=a*k/2;var L=b===2?Math.max(h,u):Math.min(u,h);S[0]=L,S[1]=L,E[0]=(s-i)/2*P,E[1]=(o-a)/2*k}var O=xO(S,e);return r=Ht(E,2),O[e*(e-1)]=r[0],O[e*(e-1)+1]=r[1],P1(O,e,v)}function A1e(t,e,r){var n=t.tagName.toLowerCase();if(!t.getBBox||!r&&n==="g")return[0,0,0,0];var i=Ec(t),a=i("transform-box")==="fill-box",s=t.getBBox(),o=FO(t.ownerSVGElement),u=s.x,h=s.y;n==="foreignobject"&&!u&&!h&&(u=parseFloat(t.getAttribute("x"))||0,h=parseFloat(t.getAttribute("y"))||0);var f=u-o.x,g=h-o.y,b=a?e[0]:e[0]-f,v=a?e[1]:e[1]-g;return[f,g,b,v]}function gs(t,e,r){return qu(t,vm(e,r),r)}function Vm(t,e,r,n){return[[0,0],[e,0],[0,r],[e,r]].map(function(i){return gs(t,i,n)})}function xh(t){var e=t.map(function(h){return h[0]}),r=t.map(function(h){return h[1]}),n=Math.min.apply(Math,vn([],Ht(e),!1)),i=Math.min.apply(Math,vn([],Ht(r),!1)),a=Math.max.apply(Math,vn([],Ht(e),!1)),s=Math.max.apply(Math,vn([],Ht(r),!1)),o=a-n,u=s-i;return{left:n,top:i,right:a,bottom:s,width:o,height:u}}function uz(t,e,r,n){var i=Vm(t,e,r,n);return xh(i)}function I1e(t,e,r,n,i){var a,s=t.target,o=t.origin,u=e.matrix,h=jY(s),f=h.offsetWidth,g=h.offsetHeight,b=r.getBoundingClientRect(),v=[0,0];r===cg(r)&&(v=BY(s,!0));for(var S=s.getBoundingClientRect(),E=S.left-b.left+r.scrollLeft-(r.clientLeft||0)+v[0],P=S.top-b.top+r.scrollTop-(r.clientTop||0)+v[1],k=S.width,L=S.height,O=rS(n,i,u),M=uz(O,f,g,n),z=M.left,B=M.top,q=M.width,W=M.height,G=gs(O,o,n),ie=vi(G,[z,B]),Q=[E+ie[0]*k/q,P+ie[1]*L/W],H=[0,0],ne=0;++ne<10;){var oe=rd(i,n);a=Ht(vi(gs(oe,Q,n),gs(oe,G,n)),2),H[0]=a[0],H[1]=a[1];var ce=rS(n,i,_m(H,n),u),fe=uz(ce,f,g,n),Me=fe.left,me=fe.top,we=Me-E,Te=me-P;if(en(we)<2&&en(Te)<2)break;Q[0]-=we,Q[1]-=Te}return H.map(function(ke){return Math.round(ke)})}function P1e(t,e,r){var n=t.length===16,i=n?4:3,a=e.map(function(u){return gs(t,u,i)}),s=r.left,o=r.top;return a.map(function(u){return[u[0]+s,u[1]+o]})}function kh(t){return Math.sqrt(t[0]*t[0]+t[1]*t[1])}function zY(t,e){return kh([e[0]-t[0],e[1]-t[1]])}function J_(t,e,r,n){r===void 0&&(r=1),n===void 0&&(n=Ks(t,e));var i=zY(t,e);return{transform:"translateY(-50%) translate(".concat(t[0],"px, ").concat(t[1],"px) rotate(").concat(n,"rad) scaleY(").concat(r,")"),width:"".concat(i,"px")}}function uS(t,e){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];var i=r.length,a=r.reduce(function(o,u){return o+u[0]},0)/i,s=r.reduce(function(o,u){return o+u[1]},0)/i;return{transform:"translateZ(0px) translate(".concat(a,"px, ").concat(s,"px) rotate(").concat(t,"rad) scale(").concat(e,")")}}function xm(t,e){var r=t[e];return sf(r)?zt(zt({},t),r):t}function jY(t){var e=t&&!pO(t.offsetWidth),r=0,n=0,i=0,a=0,s=0,o=0,u=0,h=0,f=0,g=0,b=0,v=0,S=1/0,E=1/0,P=1/0,k=1/0,L=0,O=0,M=!1;if(t)if(!e&&t.ownerSVGElement){var z=t.getBBox();M=!0,r=z.width,n=z.height,s=r,o=n,u=r,h=n,i=r,a=n}else{var B=Ec(t),q=t.style,W=B("boxSizing")==="border-box",G=parseFloat(B("borderLeftWidth"))||0,ie=parseFloat(B("borderRightWidth"))||0,Q=parseFloat(B("borderTopWidth"))||0,H=parseFloat(B("borderBottomWidth"))||0,ne=parseFloat(B("paddingLeft"))||0,oe=parseFloat(B("paddingRight"))||0,ce=parseFloat(B("paddingTop"))||0,fe=parseFloat(B("paddingBottom"))||0,Me=ne+oe,me=ce+fe,we=G+ie,Te=Q+H,ke=Me+we,he=me+Te,Ee=B("position"),xe=0,Ne=0;if("clientLeft"in t){var Oe=null;if(Ee==="absolute"){var $e=ob(t,cg(t));Oe=$e.offsetParent}else Oe=t.parentElement;if(Oe){var De=Ec(Oe);xe=parseFloat(De("width")),Ne=parseFloat(De("height"))}}f=Math.max(Me,vo(B("minWidth"),xe)||0),g=Math.max(me,vo(B("minHeight"),Ne)||0),S=vo(B("maxWidth"),xe),E=vo(B("maxHeight"),Ne),isNaN(S)&&(S=1/0),isNaN(E)&&(E=1/0),L=vo(q.width,0)||0,O=vo(q.height,0)||0,s=parseFloat(B("width"))||0,o=parseFloat(B("height"))||0,u=en(s-L)<1?KP(f,L||s,S):s,h=en(o-O)<1?KP(g,O||o,E):o,r=u,n=h,i=u,a=h,W?(P=S,k=E,b=f,v=g,u=r-ke,h=n-he):(P=S+ke,k=E+he,b=f+ke,v=g+he,r=u+ke,n=h+he),i=u+Me,a=h+me}return{svg:M,offsetWidth:r,offsetHeight:n,clientWidth:i,clientHeight:a,contentWidth:u,contentHeight:h,inlineCSSWidth:L,inlineCSSHeight:O,cssWidth:s,cssHeight:o,minWidth:f,minHeight:g,maxWidth:S,maxHeight:E,minOffsetWidth:b,minOffsetHeight:v,maxOffsetWidth:P,maxOffsetHeight:k}}function UY(t,e){return Ks(e>0?t[0]:t[1],e>0?t[1]:t[0])}function v2(){return{left:0,top:0,width:0,height:0,right:0,bottom:0,clientLeft:0,clientTop:0,clientWidth:0,clientHeight:0,scrollWidth:0,scrollHeight:0}}function VY(t,e){var r=t===cg(t)||t===_O(t),n={clientLeft:t.clientLeft,clientTop:t.clientTop,clientWidth:t.clientWidth,clientHeight:t.clientHeight,scrollWidth:t.scrollWidth,scrollHeight:t.scrollHeight,overflow:!1};return r&&(n.clientHeight=Math.max(e.height,n.clientHeight),n.scrollHeight=Math.max(e.height,n.scrollHeight)),n.overflow=Ec(t)("overflow")!=="visible",zt(zt({},e),n)}function G3(t,e,r,n){var i=t.left,a=t.right,s=t.top,o=t.bottom,u=e.top,h=e.left,f={left:h+i,top:u+s,right:h+a,bottom:u+o,width:a-i,height:o-s};return r&&n?VY(r,f):f}function k1(t,e){var r=0,n=0,i=0,a=0;if(t){var s=t.getBoundingClientRect();r=s.left,n=s.top,i=s.width,a=s.height}var o={left:r,top:n,width:i,height:a,right:r+i,bottom:n+a};return t&&e?VY(t,o):o}function k1e(t){var e=t.props,r=e.groupable,n=e.svgOrigin,i=t.getState(),a=i.offsetWidth,s=i.offsetHeight,o=i.svg,u=i.transformOrigin;return!r&&o&&n?$O(n,a,s):u}function $Y(t,e,r,n){var i;if(t)i=t;else if(e)i=[0,0];else{var a=r.target;i=qY(a,n)}return i}function qY(t,e){if(t){var r=t.getAttribute("data-rotation")||"",n=t.getAttribute("data-direction");if(e.deg=r,!!n){var i=[0,0];return n.indexOf("w")>-1&&(i[0]=-1),n.indexOf("e")>-1&&(i[0]=1),n.indexOf("n")>-1&&(i[1]=-1),n.indexOf("s")>-1&&(i[1]=1),i}}}function BO(t,e){return[Aa(e,t[0]),Aa(e,t[1]),Aa(e,t[2]),Aa(e,t[3])]}function Mh(t){var e=t.left,r=t.top,n=t.pos1,i=t.pos2,a=t.pos3,s=t.pos4;return BO([n,i,a,s],[e,r])}function mk(t,e){t[e?"controlAbles":"targetAbles"].forEach(function(r){r.unset&&r.unset(t)})}function Av(t,e){var r=e?"controlGesto":"targetGesto",n=t[r];n?.isIdle()===!1&&mk(t,e),n?.unset(),t[r]=null}function oc(t,e){if(e){var r=N0(e);r.nextStyle=zt(zt({},r.nextStyle),t)}return{style:t,cssText:O0(t).map(function(n){return"".concat(Xve(n,"-"),": ").concat(t[n],";")}).join("")}}function HY(t,e,r){var n=e.afterTransform||e.transform;return zt(zt({},oc(zt(zt(zt({},t.style),e.style),{transform:n}),r)),{afterTransform:n,transform:t.transform})}function qi(t,e,r,n){var i=e.datas;i.datas||(i.datas={});var a=zt(zt({},r),{target:t.state.target,clientX:e.clientX,clientY:e.clientY,inputEvent:e.inputEvent,currentTarget:t,moveable:t,datas:i.datas,isRequest:e.isRequest,isRequestChild:e.isRequestChild,isFirstDrag:!!e.isFirstDrag,isTrusted:e.isTrusted!==!1,stopAble:function(){i.isEventStart=!1},stopDrag:function(){var s;(s=e.stop)===null||s===void 0||s.call(e)}});return i.isStartEvent?n||(i.lastEvent=a):i.isStartEvent=!0,a}function nh(t,e,r){var n=e.datas,i="isDrag"in r?r.isDrag:e.isDrag;return n.datas||(n.datas={}),zt(zt({isDrag:i},r),{moveable:t,target:t.state.target,clientX:e.clientX,clientY:e.clientY,inputEvent:e.inputEvent,currentTarget:t,lastEvent:n.lastEvent,isDouble:e.isDouble,datas:n.datas,isFirstDrag:!!e.isFirstDrag})}function pT(t,e,r){t._emitter.on(e,r)}function $n(t,e,r,n,i){return t.triggerEvent(e,r,n,i)}function zO(t,e){return Hp(t).getComputedStyle(t,e)}function _2(t,e,r){var n={},i={};return t.filter(function(a){var s=a.name;if(n[s]||!e.some(function(o){return a[o]}))return!1;if(!r&&a.ableGroup){if(i[a.ableGroup])return!1;i[a.ableGroup]=!0}return n[s]=!0,!0})}function yk(t,e){return t===e||t==null&&e==null}function cz(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var r=t.length-1,n=0;n<r;++n){var i=t[n];if(!pO(i))return i}return t[r]}function WY(t,e){var r=[],n=[];return t.forEach(function(i,a){var s=e(i,a,t),o=n.indexOf(s),u=r[o]||[];o===-1&&(n.push(s),r.push(u)),u.push(i)}),r}function M1e(t,e){var r=[],n={};return t.forEach(function(i,a){var s=e(i,a,t),o=n[s];o||(o=[],n[s]=o,r.push(o)),o.push(i)}),r}function GY(t){return t.reduce(function(e,r){return e.concat(r)},[])}function l0(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return t.sort(function(r,n){return en(n)-en(r)}),t[0]}function u0(t,e,r){return qu(rd(t,r),vm(e,r),r)}function R1e(t,e){var r,n=t.is3d,i=t.rootMatrix,a=n?4:3;return r=Ht(u0(i,[e.distX,e.distY],a),2),e.distX=r[0],e.distY=r[1],e}function hh(t,e,r,n){if(!r[0]&&!r[1])return e;var i=gs(t,[oz(r[0]||1),0],n),a=gs(t,[0,oz(r[1]||1)],n),s=gs(t,[r[0]/kh(i),r[1]/kh(a)],n);return Aa(e,s)}function Kh(t,e,r){return r?"".concat(t/e*100,"%"):"".concat(t,"px")}function cS(t){return en(t)<=lc?0:t}function jO(t){return function(e){if(!e.isDragging(t))return"";var r=x_e(e,t),n=r.deg;return n?mi("view-control-rotation".concat(n)):""}}function UO(t,e){return e===void 0&&(e=[t]),function(r,n){if(n.isRequest)return e.some(function(a){return n.requestAble===a})?n.parentDirection:!1;var i=n.inputEvent.target;return Ol(i,mi("direction"))&&(!t||Ol(i,mi(t)))}}function O1e(t,e,r){var n,i=a0(t,{"x%":function(z){return z/100*e.offsetWidth},"y%":function(z){return z/100*e.offsetHeight}}),a=t.slice(0,r<0?void 0:r),s=t.slice(0,r<0?void 0:r+1),o=t[r]||"",u=r<0?[]:t.slice(r),h=r<0?[]:t.slice(r+1),f=i.slice(0,r<0?void 0:r),g=i.slice(0,r<0?void 0:r+1),b=(n=i[r])!==null&&n!==void 0?n:a0([""])[0],v=r<0?[]:i.slice(r),S=r<0?[]:i.slice(r+1),E=b?[b]:[],P=tv(f),k=tv(g),L=tv(v),O=tv(S),M=_o(P,L,4);return{transforms:t,beforeFunctionMatrix:P,beforeFunctionMatrix2:k,targetFunctionMatrix:tv(E),afterFunctionMatrix:L,afterFunctionMatrix2:O,allFunctionMatrix:M,beforeFunctions:f,beforeFunctions2:g,targetFunction:E[0],afterFunctions:v,afterFunctions2:S,beforeFunctionTexts:a,beforeFunctionTexts2:s,targetFunctionText:o,afterFunctionTexts:u,afterFunctionTexts2:h}}function L1e(t){return!t||!sf(t)||bO(t)?!1:eu(t)||"length"in t}function Jf(t,e){return t?bO(t)?t:ep(t)?e?document.querySelector(t):t:gO(t)?t():WX(t)?t:"current"in t?t.current:t:null}function VO(t,e){if(!t)return[];var r=L1e(t)?[].slice.call(t):[t];return r.reduce(function(n,i){return ep(i)&&e?vn(vn([],Ht(n),!1),Ht([].slice.call(document.querySelectorAll(i))),!1):(eu(i)?n.push(VO(i,e)):n.push(Jf(i,e)),n)},[])}function N1e(t,e,r){var n=Ks(t,e)/Math.PI*180;return n=r>=0?n:180-n,n=n>=0?n:360+n,n}function hz(t,e){var r=t.rootMatrix,n=t.is3d,i=n?4:3,a=rd(r,i);return n||(a=lf(a,3,4)),a[12]=0,a[13]=0,a[14]=0,c0e(a,e)}function XY(t,e,r,n,i){var a=Ht(t,2),s=a[0],o=a[1],u=0,h=0;if(i&&s&&o){var f=Ks([0,0],e),g=Ks([0,0],n),b=kh(e),v=Math.cos(f-g)*b;if(!n[0])h=v,u=h*r;else if(!n[1])u=v,h=u/r;else{var S=n[0]*s,E=n[1]*o,P=Math.atan2(S+e[0],E+e[1]),k=Math.atan2(S,E);P<0&&(P+=Math.PI*2),k<0&&(k+=Math.PI*2);var L=0;en(P-k)<Math.PI/2||en(P-k)>Math.PI/2*3||(k+=Math.PI),L=P-k,L>Math.PI*2?L-=Math.PI*2:L>Math.PI?L=2*Math.PI-L:L<-Math.PI&&(L=-2*Math.PI-L);var O=kh([S+e[0],E+e[1]])*Math.cos(L);u=O*Math.sin(k)-S,h=O*Math.cos(k)-E,n[0]<0&&(u*=-1),n[1]<0&&(h*=-1)}}else u=n[0]*e[0],h=n[1]*e[1];return[u,h]}function YY(t,e,r,n){var i,a=r.ratio,s=r.startOffsetWidth,o=r.startOffsetHeight,u=0,h=0,f=n.distX,g=n.distY,b=n.pinchScale,v=n.parentDistance,S=n.parentDist,E=n.parentScale,P=r.fixedDirection,k=[0,1].map(function(q){return en(t[q]-P[q])}),L=[0,1].map(function(q){var W=k[q];return W!==0&&(W=2/W),W});if(S)u=S[0],h=S[1],e&&(u?h||(h=u/a):u=h*a);else if(rb(b))u=(b-1)*s,h=(b-1)*o;else if(E)u=(E[0]-1)*s,h=(E[1]-1)*o;else if(v){var O=s*k[0],M=o*k[1],z=kh([O,M]);u=v/z*O*L[0],h=v/z*M*L[1]}else{var B=ud({datas:r,distX:f,distY:g});B=L.map(function(q,W){return B[W]*q}),i=Ht(XY([s,o],B,a,t,e),2),u=i[0],h=i[1]}return{distWidth:u,distHeight:h}}function vk(t,e){if(e){if(t==="left")return{x:"0%",y:"50%"};if(t==="top")return{x:"50%",y:"50%"};if(t==="center")return{x:"50%",y:"50%"};if(t==="right")return{x:"100%",y:"50%"};if(t==="bottom")return{x:"50%",y:"100%"};var r=Ht(t.split(" "),2),n=r[0],i=r[1],a=vk(n||""),s=vk(i||""),o=zt(zt({},a),s),u={x:"50%",y:"50%"};return o.x&&(u.x=o.x),o.y&&(u.y=o.y),o.value&&(o.x&&!o.y&&(u.y=o.value),!o.x&&o.y&&(u.x=o.value)),u}return t==="left"?{x:"0%"}:t==="right"?{x:"100%"}:t==="top"?{y:"0%"}:t==="bottom"?{y:"100%"}:t?t==="center"?{value:"50%"}:{value:t}:{}}function $O(t,e,r){var n=vk(t,!0),i=n.x,a=n.y;return[vo(i,e)||0,vo(a,r)||0]}function D1e(t,e,r){var n=t.map(function(a){return vi(a,e)}),i=n.map(function(a){return Zb(a,r)});return{prev:n,next:i,result:i.map(function(a){return Aa(a,e)})}}function ZY(t,e){return t.length===e.length&&t.every(function(r,n){var i=e[n],a=eu(r),s=eu(i);return a&&s?ZY(r,i):!a&&!s?r===i:!1})}function Iv(t,e,r,n,i){var a=t._store,s=a[e];if(!(e in a))if(i!=null)a[e]=i,s=i;else return a[e]=r,r;return s===r||n(s)===n(r)?s:(a[e]=r,r)}function ac(t){return t>=0?1:-1}function en(t){return Math.abs(t)}function X3(t,e){return Jve(t).map(function(r){return e(r)})}function KY(t){return rb(t)?{top:t,left:t,right:t,bottom:t}:{left:t.left||0,top:t.top||0,right:t.right||0,bottom:t.bottom||0}}var F1e=Qb("pinchable",{props:["pinchable"],events:["pinchStart","pinch","pinchEnd","pinchGroupStart","pinchGroup","pinchGroupEnd"],dragStart:function(){return!0},pinchStart:function(t,e){var r=e.datas,n=e.targets,i=e.angle,a=e.originalDatas,s=t.props,o=s.pinchable,u=s.ables;if(!o)return!1;var h="onPinch".concat(n?"Group":"","Start"),f="drag".concat(n?"Group":"","ControlStart"),g=(o===!0?t.controlAbles:u.filter(function(E){return o.indexOf(E.name)>-1})).filter(function(E){return E.canPinch&&E[f]}),b=qi(t,e,{});n&&(b.targets=n);var v=$n(t,h,b);r.isPinch=v!==!1,r.ables=g;var S=r.isPinch;return S?(g.forEach(function(E){if(a[E.name]=a[E.name]||{},!!E[f]){var P=zt(zt({},e),{datas:a[E.name],parentRotate:i,isPinch:!0});E[f](t,P)}}),t.state.snapRenderInfo={request:e.isRequest,direction:[0,0]},S):!1},pinch:function(t,e){var r=e.datas,n=e.scale,i=e.distance,a=e.originalDatas,s=e.inputEvent,o=e.targets,u=e.angle;if(r.isPinch){var h=i*(1-1/n),f=qi(t,e,{});o&&(f.targets=o);var g="onPinch".concat(o?"Group":"");$n(t,g,f);var b=r.ables,v="drag".concat(o?"Group":"","Control");return b.forEach(function(S){S[v]&&S[v](t,zt(zt({},e),{datas:a[S.name],inputEvent:s,resolveMatrix:!0,pinchScale:n,parentDistance:h,parentRotate:u,isPinch:!0}))}),f}},pinchEnd:function(t,e){var r=e.datas,n=e.isPinch,i=e.inputEvent,a=e.targets,s=e.originalDatas;if(r.isPinch){var o="onPinch".concat(a?"Group":"","End"),u=nh(t,e,{isDrag:n});a&&(u.targets=a),$n(t,o,u);var h=r.ables,f="drag".concat(a?"Group":"","ControlEnd");return h.forEach(function(g){g[f]&&g[f](t,zt(zt({},e),{isDrag:n,datas:s[g.name],inputEvent:i,isPinch:!0}))}),n}},pinchGroupStart:function(t,e){return this.pinchStart(t,zt(zt({},e),{targets:t.props.targets}))},pinchGroup:function(t,e){return this.pinch(t,zt(zt({},e),{targets:t.props.targets}))},pinchGroupEnd:function(t,e){return this.pinchEnd(t,zt(zt({},e),{targets:t.props.targets}))}}),fz=UO("scalable"),B1e={name:"scalable",ableGroup:"size",canPinch:!0,props:["scalable","throttleScale","renderDirections","keepRatio","edge","displayAroundControls"],events:["scaleStart","beforeScale","scale","scaleEnd","scaleGroupStart","beforeScaleGroup","scaleGroup","scaleGroupEnd"],render:yY("scalable"),dragControlCondition:fz,viewClassName:jO("scalable"),dragControlStart:function(t,e){var r=e.datas,n=e.isPinch,i=e.inputEvent,a=e.parentDirection,s=$Y(a,n,i,r),o=t.state,u=o.width,h=o.height,f=o.targetTransform,g=o.target,b=o.pos1,v=o.pos2,S=o.pos4;if(!s||!g)return!1;n||Um(t,e),r.datas={},r.transform=f,r.prevDist=[1,1],r.direction=s,r.startOffsetWidth=u,r.startOffsetHeight=h,r.startValue=[1,1];var E=!s[0]&&!s[1]||s[0]||!s[1];uT(t,e,"scale"),r.isWidth=E;function P(B){r.ratio=B&&isFinite(B)?B:0}r.startPositions=Mh(t.state);function k(B){var q=PY(r.startPositions,B);r.fixedDirection=q.fixedDirection,r.fixedPosition=q.fixedPosition,r.fixedOffset=q.fixedOffset}r.setFixedDirection=k,P(zd(b,v)/zd(v,S)),k([-s[0],-s[1]]);var L=function(B){r.minScaleSize=B},O=function(B){r.maxScaleSize=B};L([-1/0,-1/0]),O([1/0,1/0]);var M=qi(t,e,zt(zt({direction:s,set:function(B){r.startValue=B},setRatio:P,setFixedDirection:k,setMinScaleSize:L,setMaxScaleSize:O},lT(t,e)),{dragStart:ic.dragStart(t,new o0().dragStart([0,0],e))})),z=$n(t,"onScaleStart",M);return r.startFixedDirection=r.fixedDirection,z!==!1&&(r.isScale=!0,t.state.snapRenderInfo={request:e.isRequest,direction:s}),r.isScale?M:!1},dragControl:function(t,e){oT(t,e,"scale");var r=e.datas,n=e.parentKeepRatio,i=e.parentFlag,a=e.isPinch,s=e.dragClient,o=e.isRequest,u=e.useSnap,h=e.resolveMatrix,f=r.prevDist,g=r.direction,b=r.startOffsetWidth,v=r.startOffsetHeight,S=r.isScale,E=r.startValue,P=r.isWidth,k=r.ratio;if(!S)return!1;var L=t.props,O=L.throttleScale,M=L.parentMoveable,z=g;!g[0]&&!g[1]&&(z=[1,1]);var B=k&&(n??L.keepRatio)||!1,q=t.state,W=[E[0],E[1]];function G(){var rt=YY(z,B,r,e),Ie=rt.distWidth,Mt=rt.distHeight,at=b?(b+Ie)/b:1,je=v?(v+Mt)/v:1;E[0]||(W[0]=Ie/b),E[1]||(W[1]=Mt/v);var Xt=(z[0]||B?at:1)*W[0],Yt=(z[1]||B?je:1)*W[1];return Xt===0&&(Xt=ac(f[0])*p2),Yt===0&&(Yt=ac(f[1])*p2),[Xt,Yt]}var ie=G();if(!a&&t.props.groupable){var Q=q.snapRenderInfo||{},H=Q.direction;eu(H)&&(H[0]||H[1])&&(q.snapRenderInfo={direction:g,request:e.isRequest})}$n(t,"onBeforeScale",qi(t,e,{scale:ie,setFixedDirection:function(rt){return r.setFixedDirection(rt),ie=G(),ie},startFixedDirection:r.startFixedDirection,setScale:function(rt){ie=rt}},!0));var ne=[ie[0]/W[0],ie[1]/W[1]],oe=s,ce=[0,0],fe=ac(ne[0]*ne[1]),Me=!s&&!i&&a;if(Me||h?oe=kO(t,r.targetAllTransform,[0,0],[0,0],r):s||(oe=r.fixedPosition),a||(ce=g1e(t,ne,g,!u&&o,r)),B){z[0]&&z[1]&&ce[0]&&ce[1]&&(Math.abs(ce[0]*b)>Math.abs(ce[1]*v)?ce[1]=0:ce[0]=0);var me=!ce[0]&&!ce[1];if(me&&(P?ne[0]=Fi(ne[0]*W[0],O)/W[0]:ne[1]=Fi(ne[1]*W[1],O)/W[1]),z[0]&&!z[1]||ce[0]&&!ce[1]||me&&P){ne[0]+=ce[0];var we=b*ne[0]*W[0]/k;ne[1]=ac(fe*ne[0])*en(we/v/W[1])}else if(!z[0]&&z[1]||!ce[0]&&ce[1]||me&&!P){ne[1]+=ce[1];var Te=v*ne[1]*W[1]*k;ne[0]=ac(fe*ne[1])*en(Te/b/W[0])}}else ne[0]+=ce[0],ne[1]+=ce[1],ce[0]||(ne[0]=Fi(ne[0]*W[0],O)/W[0]),ce[1]||(ne[1]=Fi(ne[1]*W[1],O)/W[1]);ne[0]===0&&(ne[0]=ac(f[0])*p2),ne[1]===0&&(ne[1]=ac(f[1])*p2),ie=_1e(ne,[W[0],W[1]]);var ke=[b,v],he=[b*ie[0],v*ie[1]];he=$X(he,r.minScaleSize,r.maxScaleSize,B?k:!1),ie=X3(2,function(rt){return ke[rt]?he[rt]/ke[rt]:he[rt]}),ne=X3(2,function(rt){return ie[rt]/W[rt]});var Ee=X3(2,function(rt){return f[rt]?ne[rt]/f[rt]:ne[rt]}),xe="scale(".concat(ne.join(", "),")"),Ne="scale(".concat(ie.join(", "),")"),Oe=sT(r,Ne,xe),$e=!E[0]||!E[1],De=g_e(t,$e?Ne:xe,r.fixedDirection,oe,r.fixedOffset,r,$e),it=Me?De:vi(De,r.prevInverseDist||[0,0]);if(r.prevDist=ne,r.prevInverseDist=De,ie[0]===f[0]&&ie[1]===f[1]&&it.every(function(rt){return!rt})&&!M&&!Me)return!1;var Ye=qi(t,e,zt({offsetWidth:b,offsetHeight:v,direction:g,scale:ie,dist:ne,delta:Ee,isPinch:!!a},hY(t,Oe,it,a,e)));return $n(t,"onScale",Ye),Ye},dragControlEnd:function(t,e){var r=e.datas;if(!r.isScale)return!1;r.isScale=!1;var n=nh(t,e,{});return $n(t,"onScaleEnd",n),n},dragGroupControlCondition:fz,dragGroupControlStart:function(t,e){var r=e.datas,n=this.dragControlStart(t,e);if(!n)return!1;var i=af(t,"resizable",e);r.moveableScale=t.scale;var a=jd(t,this,"dragControlStart",e,function(h,f){return aS(t,h,r,f)}),s=function(h){n.setFixedDirection(h),a.forEach(function(f,g){f.setFixedDirection(h),aS(t,f.moveable,r,i[g])})};r.setFixedDirection=s;var o=zt(zt({},n),{targets:t.props.targets,events:a,setFixedDirection:s}),u=$n(t,"onScaleGroupStart",o);return r.isScale=u!==!1,r.isScale?o:!1},dragGroupControl:function(t,e){var r=e.datas;if(r.isScale){pT(t,"onBeforeScale",function(f){$n(t,"onBeforeScaleGroup",qi(t,e,zt(zt({},f),{targets:t.props.targets}),!0))});var n=this.dragControl(t,e);if(n){var i=n.dist,a=r.moveableScale;t.scale=[i[0]*a[0],i[1]*a[1]];var s=t.props.keepRatio,o=r.fixedPosition,u=jd(t,this,"dragControl",e,function(f,g){var b=Ht(qu(Kb(t.rotation/180*Math.PI,3),[g.datas.originalX*i[0],g.datas.originalY*i[1],1],3),2),v=b[0],S=b[1];return zt(zt({},g),{parentDist:null,parentScale:i,parentKeepRatio:s,dragClient:Aa(o,[v,S])})}),h=zt({targets:t.props.targets,events:u},n);return $n(t,"onScaleGroup",h),h}}},dragGroupControlEnd:function(t,e){var r=e.isDrag,n=e.datas;if(n.isScale){this.dragControlEnd(t,e);var i=jd(t,this,"dragControlEnd",e),a=nh(t,e,{targets:t.props.targets,events:i});return $n(t,"onScaleGroupEnd",a),r}},request:function(){var t={},e=0,r=0,n=!1;return{isControl:!0,requestStart:function(i){return n=i.useSnap,{datas:t,parentDirection:i.direction||[1,1],useSnap:n}},request:function(i){return e+=i.deltaWidth,r+=i.deltaHeight,{datas:t,parentDist:[e,r],parentKeepRatio:i.keepRatio,useSnap:n}},requestEnd:function(){return{datas:t,isDrag:!0,useSnap:n}}}}};function wp(t,e){return t.map(function(r,n){return tS(r,e[n],1,2)})}function dz(t,e,r){var n=Ks(t,e),i=Ks(t,r),a=i-n;return a>=0?a:a+2*Math.PI}function z1e(t,e){var r=dz(t[0],t[1],t[2]),n=dz(e[0],e[1],e[2]),i=Math.PI;return!(r>=i&&n<=i||r<=i&&n>=i)}var j1e={name:"warpable",ableGroup:"size",props:["warpable","renderDirections","edge","displayAroundControls"],events:["warpStart","warp","warpEnd"],viewClassName:jO("warpable"),render:function(t,e){var r=t.props,n=r.resizable,i=r.scalable,a=r.warpable,s=r.zoom;if(n||i||!a)return[];var o=t.state,u=o.pos1,h=o.pos2,f=o.pos3,g=o.pos4,b=wp(u,h),v=wp(h,u),S=wp(u,f),E=wp(f,u),P=wp(f,g),k=wp(g,f),L=wp(h,g),O=wp(g,h);return vn([e.createElement("div",{className:mi("line"),key:"middeLine1",style:J_(b,P,s)}),e.createElement("div",{className:mi("line"),key:"middeLine2",style:J_(v,k,s)}),e.createElement("div",{className:mi("line"),key:"middeLine3",style:J_(S,L,s)}),e.createElement("div",{className:mi("line"),key:"middeLine4",style:J_(E,O,s)})],Ht(vY(t,"warpable",e)),!1)},dragControlCondition:function(t,e){if(e.isRequest)return!1;var r=e.inputEvent.target;return Ol(r,mi("direction"))&&Ol(r,mi("warpable"))},dragControlStart:function(t,e){var r=e.datas,n=e.inputEvent,i=t.props.target,a=n.target,s=qY(a,r);if(!s||!i)return!1;var o=t.state,u=o.transformOrigin,h=o.is3d,f=o.targetTransform,g=o.targetMatrix,b=o.width,v=o.height,S=o.left,E=o.top;r.datas={},r.targetTransform=f,r.warpTargetMatrix=h?g:lf(g,3,4),r.targetInverseMatrix=GX(rd(r.warpTargetMatrix,4),3,4),r.direction=s,r.left=S,r.top=E,r.poses=[[0,0],[b,0],[0,v],[b,v]].map(function(L){return vi(L,u)}),r.nextPoses=r.poses.map(function(L){var O=Ht(L,2),M=O[0],z=O[1];return qu(r.warpTargetMatrix,[M,z,0,1],4)}),r.startValue=$o(4),r.prevMatrix=$o(4),r.absolutePoses=Mh(o),r.posIndexes=cY(s),Um(t,e),uT(t,e,"matrix3d"),o.snapRenderInfo={request:e.isRequest,direction:s};var P=qi(t,e,zt({set:function(L){r.startValue=L}},lT(t,e))),k=$n(t,"onWarpStart",P);return k!==!1&&(r.isWarp=!0),r.isWarp},dragControl:function(t,e){var r=e.datas,n=e.isRequest,i=e.distX,a=e.distY,s=r.targetInverseMatrix,o=r.prevMatrix,u=r.isWarp,h=r.startValue,f=r.poses,g=r.posIndexes,b=r.absolutePoses;if(!u)return!1;if(oT(t,e,"matrix3d"),D0(t,"warpable")){var v=g.map(function(G){return b[G]});v.length>1&&v.push([(v[0][0]+v[1][0])/2,(v[0][1]+v[1][1])/2]);var S=fT(t,n,{horizontal:v.map(function(G){return G[1]+a}),vertical:v.map(function(G){return G[0]+i})}),E=S.horizontal,P=S.vertical;a-=E.offset,i-=P.offset}var k=ud({datas:r,distX:i,distY:a},!0),L=r.nextPoses.slice();if(g.forEach(function(G){L[G]=Aa(L[G],k)}),!i_e.every(function(G){return z1e(G.map(function(ie){return f[ie]}),G.map(function(ie){return L[ie]}))}))return!1;var O=wO(f[0],f[2],f[1],f[3],L[0],L[2],L[1],L[3]);if(!O.length)return!1;var M=_o(s,O,4),z=lY(r,M,!0),B=_o(rd(o,4),z,4);r.prevMatrix=z;var q=_o(h,z,4),W=sT(r,"matrix3d(".concat(q.join(", "),")"),"matrix3d(".concat(z.join(", "),")"));return PO(e,W),$n(t,"onWarp",qi(t,e,zt({delta:B,matrix:q,dist:z,multiply:_o,transform:W},oc({transform:W},e)))),!0},dragControlEnd:function(t,e){var r=e.datas,n=e.isDrag;return r.isWarp?(r.isWarp=!1,$n(t,"onWarpEnd",nh(t,e,{})),n):!1}},U1e=mi("area-pieces"),b2=mi("area-piece"),JY=mi("avoid"),V1e=mi("view-dragging");function Y3(t){var e=t.areaElement;if(e){var r=t.state,n=r.width,i=r.height;HX(e,JY),e.style.cssText+="left: 0px; top: 0px; width: ".concat(n,"px; height: ").concat(i,"px")}}function pz(t){return t.createElement("div",{key:"area_pieces",className:U1e},t.createElement("div",{className:b2}),t.createElement("div",{className:b2}),t.createElement("div",{className:b2}),t.createElement("div",{className:b2}))}var QY={name:"dragArea",props:["dragArea","passDragArea"],events:["click","clickGroup"],render:function(t,e){var r=t.props,n=r.target,i=r.dragArea,a=r.groupable,s=r.passDragArea,o=t.getState(),u=o.width,h=o.height,f=o.renderPoses,g=s?mi("area","pass"):mi("area");if(a)return[e.createElement("div",{key:"area",ref:om(t,"areaElement"),className:g}),pz(e)];if(!n||!i)return[];var b=wO([0,0],[u,0],[0,h],[u,h],f[0],f[1],f[2],f[3]),v=b.length?dT(b,!0):"none";return[e.createElement("div",{key:"area",ref:om(t,"areaElement"),className:g,style:{top:"0px",left:"0px",width:"".concat(u,"px"),height:"".concat(h,"px"),transformOrigin:"0 0",transform:v}}),pz(e)]},dragStart:function(t,e){var r=e.datas,n=e.clientX,i=e.clientY,a=e.inputEvent;if(!a)return!1;r.isDragArea=!1;var s=t.areaElement,o=t.state,u=o.moveableClientRect,h=o.renderPoses,f=o.rootMatrix,g=o.is3d,b=u.left,v=u.top,S=xh(h),E=S.left,P=S.top,k=S.width,L=S.height,O=g?4:3,M=Ht(u0(f,[n-b,i-v],O),2),z=M[0],B=M[1];z-=E,B-=P;var q=[{left:E,top:P,width:k,height:B-10},{left:E,top:P,width:z-10,height:L},{left:E,top:P+B+10,width:k,height:L-B-10},{left:E+z+10,top:P,width:k-z-10,height:L}],W=[].slice.call(s.nextElementSibling.children);q.forEach(function(G,ie){W[ie].style.cssText="left: ".concat(G.left,"px;top: ").concat(G.top,"px; width: ").concat(G.width,"px; height: ").concat(G.height,"px;")}),qX(s,JY),o.disableNativeEvent=!0},drag:function(t,e){var r=e.datas,n=e.inputEvent;if(this.enableNativeEvent(t),!n)return!1;r.isDragArea||(r.isDragArea=!0,Y3(t))},dragEnd:function(t,e){this.enableNativeEvent(t);var r=e.inputEvent,n=e.datas;if(!r)return!1;n.isDragArea||Y3(t)},dragGroupStart:function(t,e){return this.dragStart(t,e)},dragGroup:function(t,e){return this.drag(t,e)},dragGroupEnd:function(t,e){return this.dragEnd(t,e)},unset:function(t){Y3(t),t.state.disableNativeEvent=!1},enableNativeEvent:function(t){var e=t.state;e.disableNativeEvent&&VX(function(){e.disableNativeEvent=!1})}},$1e=Qb("origin",{props:["origin","svgOrigin"],render:function(t,e){var r=t.props,n=r.zoom,i=r.svgOrigin,a=r.groupable,s=t.getState(),o=s.beforeOrigin,u=s.rotation,h=s.svg,f=s.allMatrix,g=s.is3d,b=s.left,v=s.top,S=s.offsetWidth,E=s.offsetHeight,P;if(!a&&h&&i){var k=Ht($O(i,S,E),2),L=k[0],O=k[1],M=g?4:3,z=gs(f,[L,O],M);P=uS(u,n,vi(z,[b,v]))}else P=uS(u,n,o);return[e.createElement("div",{className:mi("control","origin"),style:P,key:"beforeOrigin"})]}});function q1e(t){var e=t.scrollContainer;return[e.scrollLeft,e.scrollTop]}var H1e={name:"scrollable",canPinch:!0,props:["scrollable","scrollContainer","scrollThreshold","scrollThrottleTime","getScrollPosition","scrollOptions"],events:["scroll","scrollGroup"],dragRelation:"strong",dragStart:function(t,e){var r=t.props,n=r.scrollContainer,i=n===void 0?t.getContainer():n,a=r.scrollOptions,s=new S0e,o=Jf(i,!0);e.datas.dragScroll=s,t.state.dragScroll=s;var u=e.isControl?"controlGesto":"targetGesto",h=e.targets;s.on("scroll",function(f){var g=f.container,b=f.direction,v=qi(t,e,{scrollContainer:g,direction:b}),S=h?"onScrollGroup":"onScroll";h&&(v.targets=h),$n(t,S,v)}).on("move",function(f){var g=f.offsetX,b=f.offsetY,v=f.inputEvent;t[u].scrollBy(g,b,v.inputEvent,!1)}).on("scrollDrag",function(f){var g=f.next;g(t[u].getCurrentEvent())}),s.dragStart(e,zt({container:o},a))},checkScroll:function(t,e){var r=e.datas.dragScroll;if(r){var n=t.props,i=n.scrollContainer,a=i===void 0?t.getContainer():i,s=n.scrollThreshold,o=s===void 0?0:s,u=n.scrollThrottleTime,h=u===void 0?0:u,f=n.getScrollPosition,g=f===void 0?q1e:f,b=n.scrollOptions;return r.drag(e,zt({container:a,threshold:o,throttleTime:h,getScrollPosition:function(v){return g({scrollContainer:v.container,direction:v.direction})}},b)),!0}},drag:function(t,e){return this.checkScroll(t,e)},dragEnd:function(t,e){e.datas.dragScroll.dragEnd(),e.datas.dragScroll=null},dragControlStart:function(t,e){return this.dragStart(t,zt(zt({},e),{isControl:!0}))},dragControl:function(t,e){return this.drag(t,e)},dragControlEnd:function(t,e){return this.dragEnd(t,e)},dragGroupStart:function(t,e){return this.dragStart(t,zt(zt({},e),{targets:t.props.targets}))},dragGroup:function(t,e){return this.drag(t,zt(zt({},e),{targets:t.props.targets}))},dragGroupEnd:function(t,e){return this.dragEnd(t,zt(zt({},e),{targets:t.props.targets}))},dragGroupControlStart:function(t,e){return this.dragStart(t,zt(zt({},e),{targets:t.props.targets,isControl:!0}))},dragGroupControl:function(t,e){return this.drag(t,zt(zt({},e),{targets:t.props.targets}))},dragGroupControEnd:function(t,e){return this.dragEnd(t,zt(zt({},e),{targets:t.props.targets}))},unset:function(t){var e,r=t.state;(e=r.dragScroll)===null||e===void 0||e.dragEnd(),r.dragScroll=null}},eZ={name:"",props:["target","dragTargetSelf","dragTarget","dragContainer","container","warpSelf","rootContainer","useResizeObserver","useMutationObserver","zoom","dragFocusedInput","transformOrigin","ables","className","pinchThreshold","pinchOutside","triggerAblesSimultaneously","checkInput","cspNonce","translateZ","hideDefaultLines","props","flushSync","stopPropagation","preventClickEventOnDrag","preventClickDefault","viewContainer","persistData","useAccuratePosition","firstRenderState","linePadding","controlPadding","preventDefault","preventRightClick","preventWheelClick","requestStyles"],events:["changeTargets"]},W1e=Qb("padding",{props:["padding"],render:function(t,e){var r=t.props;if(r.dragArea)return[];var n=KY(r.padding||{}),i=n.left,a=n.top,s=n.right,o=n.bottom,u=t.getState(),h=u.renderPoses,f=u.pos1,g=u.pos2,b=u.pos3,v=u.pos4,S=[f,g,b,v],E=[];return i>0&&E.push([0,2]),a>0&&E.push([0,1]),s>0&&E.push([1,3]),o>0&&E.push([2,3]),E.map(function(P,k){var L=Ht(P,2),O=L[0],M=L[1],z=S[O],B=S[M],q=h[O],W=h[M],G=wO([0,0],[100,0],[0,100],[100,100],z,B,q,W);if(G.length)return e.createElement("div",{key:"padding".concat(k),className:mi("padding"),style:{transform:dT(G,!0)}})})}}),gz=["nw","ne","se","sw"];function x2(t,e){var r=t[0]+t[1],n=r>e?e/r:1;return t[0]*=n,t[1]=e-t[1]*n,t}var G1e=[1,2,5,6],X1e=[0,3,4,7],Wg=[1,-1,-1,1],Gg=[1,1,-1,-1];function qO(t,e,r,n,i,a,s,o){i===void 0&&(i=0),a===void 0&&(a=0),s===void 0&&(s=r),o===void 0&&(o=n);var u=[],h=!1,f=t.filter(function(b){return!b.virtual}),g=f.map(function(b){var v=b.horizontal,S=b.vertical,E=b.pos;if(S&&!h&&(h=!0,u.push("/")),h){var P=Math.max(0,S===1?E[1]-a:o-E[1]);return u.push(Kh(P,n,e)),P}else{var P=Math.max(0,v===1?E[0]-i:s-E[0]);return u.push(Kh(P,r,e)),P}});return{radiusPoses:f,styles:u,raws:g}}function tZ(t){for(var e=[0,0],r=[0,0],n=t.length,i=0;i<n;++i){var a=t[i];a.sub&&(a.horizontal&&(e[1]===0&&(e[0]=i),e[1]=i-e[0]+1,r[0]=i+1),a.vertical&&(r[1]===0&&(r[0]=i),r[1]=i-r[0]+1))}return{horizontalRange:e,verticalRange:r}}function rZ(t,e,r,n,i,a,s){var o,u,h,f;a===void 0&&(a=[0,0]),s===void 0&&(s=!1);var g=t.indexOf("/"),b=(g>-1?t.slice(0,g):t).length,v=t.slice(0,b),S=t.slice(b+1),E=v.length,P=S.length,k=P>0,L=Ht(v,4),O=L[0],M=O===void 0?"0px":O,z=L[1],B=z===void 0?M:z,q=L[2],W=q===void 0?M:q,G=L[3],ie=G===void 0?B:G,Q=Ht(S,4),H=Q[0],ne=H===void 0?M:H,oe=Q[1],ce=oe===void 0?k?ne:B:oe,fe=Q[2],Me=fe===void 0?k?ne:W:fe,me=Q[3],we=me===void 0?k?ce:ie:me,Te=[M,B,W,ie].map(function(Oe){return vo(Oe,e)}),ke=[ne,ce,Me,we].map(function(Oe){return vo(Oe,r)}),he=Te.slice(),Ee=ke.slice();o=Ht(x2([he[0],he[1]],e),2),he[0]=o[0],he[1]=o[1],u=Ht(x2([he[3],he[2]],e),2),he[3]=u[0],he[2]=u[1],h=Ht(x2([Ee[0],Ee[3]],r),2),Ee[0]=h[0],Ee[3]=h[1],f=Ht(x2([Ee[1],Ee[2]],r),2),Ee[1]=f[0],Ee[2]=f[1];var xe=s?he:he.slice(0,Math.max(a[0],E)),Ne=s?Ee:Ee.slice(0,Math.max(a[1],P));return vn(vn([],Ht(xe.map(function(Oe,$e){var De=gz[$e];return{virtual:$e>=E,horizontal:Wg[$e],vertical:0,pos:[n+Oe,i+(Gg[$e]===-1?r:0)],sub:!0,raw:Te[$e],direction:De}})),!1),Ht(Ne.map(function(Oe,$e){var De=gz[$e];return{virtual:$e>=P,horizontal:0,vertical:Gg[$e],pos:[n+(Wg[$e]===-1?e:0),i+Oe],sub:!0,raw:ke[$e],direction:De}})),!1)}function Y1e(t,e,r,n,i){i===void 0&&(i=e.length);var a=tZ(t.slice(n)),s=a.horizontalRange,o=a.verticalRange,u=r-n,h=0;if(u===0)h=i;else if(u>0&&u<s[1])h=s[1]-u;else if(u>=o[0])h=o[0]+o[1]-u;else return;t.splice(r,h),e.splice(r,h)}function Z1e(t,e,r,n,i,a,s,o,u,h,f){h===void 0&&(h=0),f===void 0&&(f=0);var g=tZ(t.slice(r)),b=g.horizontalRange,v=g.verticalRange;if(n>-1)for(var S=Wg[n]===1?a-h:o-a,E=b[1];E<=n;++E){var P=Gg[E]===1?f:u,k=0;if(n===E?k=a:E===0?k=h+S:Wg[E]===-1&&(k=o-(e[r][0]-h)),t.splice(r+E,0,{horizontal:Wg[E],vertical:0,pos:[k,P]}),e.splice(r+E,0,[k,P]),E===0)break}else if(i>-1){var L=Gg[i]===1?s-f:u-s;if(b[1]===0&&v[1]===0){var O=[h+L,f];t.push({horizontal:Wg[0],vertical:0,pos:O}),e.push(O)}for(var M=v[0],E=v[1];E<=i;++E){var k=Wg[E]===1?h:o,P=0;if(i===E?P=s:E===0?P=f+L:Gg[E]===1?P=e[r+M][1]:Gg[E]===-1&&(P=u-(e[r+M][1]-f)),t.push({horizontal:0,vertical:Gg[E],pos:[k,P]}),e.push([k,P]),E===0)break}}}function K1e(t,e){e===void 0&&(e=t.map(function(i){return i.raw}));var r=t.map(function(i,a){return i.horizontal?e[a]:null}).filter(function(i){return i!=null}),n=t.map(function(i,a){return i.vertical?e[a]:null}).filter(function(i){return i!=null});return{horizontals:r,verticals:n}}var J1e=[[0,-1,"n"],[1,0,"e"]],Q1e=[[-1,-1,"nw"],[0,-1,"n"],[1,-1,"ne"],[1,0,"e"],[1,1,"se"],[0,1,"s"],[-1,1,"sw"],[-1,0,"w"]];function HO(t,e,r){var n=t.props.clipRelative,i=t.state,a=i.width,s=i.height,o=e,u=o.type,h=o.poses,f=u==="rect",g=u==="circle";if(u==="polygon")return r.map(function(B){return"".concat(Kh(B[0],a,n)," ").concat(Kh(B[1],s,n))});if(f||u==="inset"){var b=r[1][1],v=r[3][0],S=r[7][0],E=r[5][1];if(f)return[b,v,E,S].map(function(B){return"".concat(B,"px")});var P=[b,a-v,s-E,S].map(function(B,q){return Kh(B,q%2?a:s,n)});if(r.length>8){var k=Ht(vi(r[4],r[0]),2),L=k[0],O=k[1];P.push.apply(P,vn(["round"],Ht(qO(h.slice(8).map(function(B,q){return zt(zt({},B),{pos:r[q]})}),n,L,O,S,b,v,E).styles),!1))}return P}else if(g||u==="ellipse"){var M=r[0],z=Kh(en(r[1][1]-M[1]),g?Math.sqrt((a*a+s*s)/2):s,n),P=g?[z]:[Kh(en(r[2][0]-M[0]),a,n),z];return P.push("at",Kh(M[0],a,n),Kh(M[1],s,n)),P}}function hS(t,e,r,n){var i=[n,(n+e)/2,e],a=[t,(t+r)/2,r];return Q1e.map(function(s){var o=Ht(s,3),u=o[0],h=o[1],f=o[2],g=i[u+1],b=a[h+1];return{vertical:en(h),horizontal:en(u),direction:f,pos:[g,b]}})}function nZ(t){var e=[1/0,-1/0],r=[1/0,-1/0];return t.forEach(function(n){var i=n.pos;e[0]=Math.min(e[0],i[0]),e[1]=Math.max(e[1],i[0]),r[0]=Math.min(r[0],i[1]),r[1]=Math.max(r[1],i[1])}),[en(e[1]-e[0]),en(r[1]-r[0])]}function mz(t,e,r,n,i){var a,s,o,u,h,f,g,b,v;if(t){var S=i;if(!S){var E=Ec(t),P=E("clipPath");S=P!=="none"?P:E("clip")}if(!((!S||S==="none"||S==="auto")&&(S=n,!S))){var k=UX(S),L=k.prefix,O=L===void 0?S:L,M=k.value,z=M===void 0?"":M,B=O==="circle",q=" ";if(O==="polygon"){var W=Kg(z||"0% 0%, 100% 0%, 100% 100%, 0% 100%");q=",";var G=W.map(function(_r){var cr=Ht(_r.split(" "),2),Er=cr[0],wr=cr[1];return{vertical:1,horizontal:1,pos:[vo(Er,e),vo(wr,r)]}}),ie=bm(G.map(function(_r){return _r.pos}));return{type:O,clipText:S,poses:G,splitter:q,left:ie.minX,right:ie.maxX,top:ie.minY,bottom:ie.maxY}}else if(B||O==="ellipse"){var Q="",H="",ne=0,oe=0,W=Jp(z);if(B){var ce="";a=Ht(W,4),s=a[0],ce=s===void 0?"50%":s,o=a[2],Q=o===void 0?"50%":o,u=a[3],H=u===void 0?"50%":u,ne=vo(ce,Math.sqrt((e*e+r*r)/2)),oe=ne}else{var fe="",Me="";h=Ht(W,5),f=h[0],fe=f===void 0?"50%":f,g=h[1],Me=g===void 0?"50%":g,b=h[3],Q=b===void 0?"50%":b,v=h[4],H=v===void 0?"50%":v,ne=vo(fe,e),oe=vo(Me,r)}var me=[vo(Q,e),vo(H,r)],G=vn([{vertical:1,horizontal:1,pos:me,direction:"nesw"}],Ht(J1e.slice(0,B?1:2).map(function(Er){return{vertical:en(Er[1]),horizontal:Er[0],direction:Er[2],sub:!0,pos:[me[0]+Er[0]*ne,me[1]+Er[1]*oe]}})),!1);return{type:O,clipText:S,radiusX:ne,radiusY:oe,left:me[0]-ne,top:me[1]-oe,right:me[0]+ne,bottom:me[1]+oe,poses:G,splitter:q}}else if(O==="inset"){var W=Jp(z||"0 0 0 0"),we=W.indexOf("round"),Te=(we>-1?W.slice(0,we):W).length,ke=W.slice(Te+1),he=Ht(W.slice(0,Te),4),Ee=he[0],xe=he[1],Ne=xe===void 0?Ee:xe,Oe=he[2],$e=Oe===void 0?Ee:Oe,De=he[3],it=De===void 0?Ne:De,Ye=Ht([Ee,$e].map(function(Er){return vo(Er,r)}),2),rt=Ye[0],Ie=Ye[1],Mt=Ht([it,Ne].map(function(Er){return vo(Er,e)}),2),at=Mt[0],je=Mt[1],Xt=e-je,Yt=r-Ie,pr=rZ(ke,Xt-at,Yt-rt,at,rt),G=vn(vn([],Ht(hS(rt,Xt,Yt,at)),!1),Ht(pr),!1);return{type:"inset",clipText:S,poses:G,top:rt,left:at,right:Xt,bottom:Yt,radius:ke,splitter:q}}else if(O==="rect"){var W=Kg(z||"0px, ".concat(e,"px, ").concat(r,"px, 0px"));q=",";var vt=Ht(W.map(function(lr){var Ar=Yb(lr).value;return Ar}),4),yr=vt[0],je=vt[1],Ie=vt[2],at=vt[3],G=hS(yr,je,Ie,at);return{type:"rect",clipText:S,poses:G,top:yr,right:je,bottom:Ie,left:at,values:W,splitter:q}}}}}function ebe(t,e,r,n,i){var a=t[e],s=a.direction,o=a.sub,u=t.map(function(){return[0,0]}),h=s?s.split(""):[];if(n&&e<8){var f=h.filter(function(ne){return ne==="w"||ne==="e"}),g=h.filter(function(ne){return ne==="n"||ne==="s"}),b=f[0],v=g[0];u[e]=r;var S=Ht(nZ(t),2),E=S[0],P=S[1],k=E&&P?E/P:0;if(k&&i){var L=(e+4)%8,O=t[L].pos,M=[0,0];s.indexOf("w")>-1?M[0]=-1:s.indexOf("e")>-1&&(M[0]=1),s.indexOf("n")>-1?M[1]=-1:s.indexOf("s")>-1&&(M[1]=1);var z=XY([E,P],r,k,M,!0),B=E+z[0],q=P+z[1],W=O[1],G=O[1],ie=O[0],Q=O[0];M[0]===-1?ie=Q-B:M[0]===1?Q=ie+B:(ie=ie-B/2,Q=Q+B/2),M[1]===-1?W=G-q:(M[1]===1||(W=G-q/2),G=W+q);var H=hS(W,Q,G,ie);t.forEach(function(ne,oe){u[oe][0]=H[oe].pos[0]-ne.pos[0],u[oe][1]=H[oe].pos[1]-ne.pos[1]})}else t.forEach(function(ne,oe){var ce=ne.direction;ce&&(ce.indexOf(b)>-1&&(u[oe][0]=r[0]),ce.indexOf(v)>-1&&(u[oe][1]=r[1]))}),b&&(u[1][0]=r[0]/2,u[5][0]=r[0]/2),v&&(u[3][1]=r[1]/2,u[7][1]=r[1]/2)}else s&&!o?h.forEach(function(ne){var oe=ne==="n"||ne==="s";t.forEach(function(ce,fe){var Me=ce.direction,me=ce.horizontal,we=ce.vertical;!Me||Me.indexOf(ne)===-1||(u[fe]=[oe||!me?0:r[0],!oe||!we?0:r[1]])})}):u[e]=r;return u}function tbe(t,e){var r=Ht(sY(t,e),2),n=r[0],i=r[1],a=e.datas,s=a.clipPath,o=a.clipIndex,u=s,h=u.type,f=u.poses,g=u.splitter,b=f.map(function(L){return L.pos});if(h==="polygon")b.splice(o,0,[n,i]);else if(h==="inset"){var v=G1e.indexOf(o),S=X1e.indexOf(o),E=f.length;if(Z1e(f,b,8,v,S,n,i,b[4][0],b[4][1],b[0][0],b[0][1]),E===f.length)return}else return;var P=HO(t,s,b),k="".concat(h,"(").concat(P.join(g),")");$n(t,"onClip",qi(t,e,zt({clipEventType:"added",clipType:h,poses:b,clipStyles:P,clipStyle:k,distX:0,distY:0},oc({clipPath:k},e))))}function rbe(t,e){var r=e.datas,n=r.clipPath,i=r.clipIndex,a=n,s=a.type,o=a.poses,u=a.splitter,h=o.map(function(v){return v.pos}),f=h.length;if(s==="polygon")o.splice(i,1),h.splice(i,1);else if(s==="inset"){if(i<8||(Y1e(o,h,i,8,f),f===o.length))return}else return;var g=HO(t,n,h),b="".concat(s,"(").concat(g.join(u),")");$n(t,"onClip",qi(t,e,zt({clipEventType:"removed",clipType:s,poses:h,clipStyles:g,clipStyle:b,distX:0,distY:0},oc({clipPath:b},e))))}var nbe={name:"clippable",props:["clippable","defaultClipPath","customClipPath","keepRatio","clipRelative","clipArea","dragWithClip","clipTargetBounds","clipVerticalGuidelines","clipHorizontalGuidelines","clipSnapThreshold"],events:["clipStart","clip","clipEnd"],css:[`.control.clip-control {
background: #6d6;
cursor: pointer;
}
.control.clip-control.clip-radius {
background: #d66;
}
.line.clip-line {
background: #6e6;
cursor: move;
z-index: 1;
}
.clip-area {
position: absolute;
top: 0;
left: 0;
}
.clip-ellipse {
position: absolute;
cursor: move;
border: 1px solid #6d6;
border: var(--zoompx) solid #6d6;
border-radius: 50%;
transform-origin: 0px 0px;
}`,`:host {
--bounds-color: #d66;
}`,`.guideline {
pointer-events: none;
z-index: 2;
}`,`.line.guideline.bounds {
background: #d66;
background: var(--bounds-color);
}`],render:function(t,e){var r=t.props,n=r.customClipPath,i=r.defaultClipPath,a=r.clipArea,s=r.zoom,o=r.groupable,u=t.getState(),h=u.target,f=u.width,g=u.height,b=u.allMatrix,v=u.is3d,S=u.left,E=u.top,P=u.pos1,k=u.pos2,L=u.pos3,O=u.pos4,M=u.clipPathState,z=u.snapBoundInfos,B=u.rotation;if(!h||o)return[];var q=mz(h,f,g,i||"inset",M||n);if(!q)return[];var W=v?4:3,G=q.type,ie=q.poses,Q=ie.map(function(je){var Xt=gs(b,je.pos,W);return[Xt[0]-S,Xt[1]-E]}),H=[],ne=[],oe=G==="rect",ce=G==="inset",fe=G==="polygon";if(oe||ce||fe){var Me=ce?Q.slice(0,8):Q;ne=Me.map(function(je,Xt){var Yt=Xt===0?Me[Me.length-1]:Me[Xt-1],pr=Ks(Yt,je),vt=zY(Yt,je);return e.createElement("div",{key:"clipLine".concat(Xt),className:mi("line","clip-line","snap-control"),"data-clip-index":Xt,style:{width:"".concat(vt,"px"),transform:"translate(".concat(Yt[0],"px, ").concat(Yt[1],"px) rotate(").concat(pr,"rad) scaleY(").concat(s,")")}})})}if(H=Q.map(function(je,Xt){return e.createElement("div",{key:"clipControl".concat(Xt),className:mi("control","clip-control","snap-control"),"data-clip-index":Xt,style:{transform:"translate(".concat(je[0],"px, ").concat(je[1],"px) rotate(").concat(B,"rad) scale(").concat(s,")")}})}),ce&&H.push.apply(H,vn([],Ht(Q.slice(8).map(function(je,Xt){return e.createElement("div",{key:"clipRadiusControl".concat(Xt),className:mi("control","clip-control","clip-radius","snap-control"),"data-clip-index":8+Xt,style:{transform:"translate(".concat(je[0],"px, ").concat(je[1],"px) rotate(").concat(B,"rad) scale(").concat(s,")")}})})),!1)),G==="circle"||G==="ellipse"){var me=q.left,we=q.top,Te=q.radiusX,ke=q.radiusY,he=Ht(vi(gs(b,[me,we],W),gs(b,[0,0],W)),2),Ee=he[0],xe=he[1],Ne="none";if(!a){for(var Oe=Math.max(10,Te/5,ke/5),$e=[],De=0;De<=Oe;++De){var it=Math.PI*2/Oe*De;$e.push([Te+(Te-s)*Math.cos(it),ke+(ke-s)*Math.sin(it)])}$e.push([Te,-2]),$e.push([-2,-2]),$e.push([-2,ke*2+2]),$e.push([Te*2+2,ke*2+2]),$e.push([Te*2+2,-2]),$e.push([Te,-2]),Ne="polygon(".concat($e.map(function(je){return"".concat(je[0],"px ").concat(je[1],"px")}).join(", "),")")}H.push(e.createElement("div",{key:"clipEllipse",className:mi("clip-ellipse","snap-control"),style:{width:"".concat(Te*2,"px"),height:"".concat(ke*2,"px"),clipPath:Ne,transform:"translate(".concat(-S+Ee,"px, ").concat(-E+xe,"px) ").concat(dT(b))}}))}if(a){var Ye=xh(vn([P,k,L,O],Ht(Q),!1)),rt=Ye.width,Ie=Ye.height,Mt=Ye.left,at=Ye.top;if(fe||oe||ce){var $e=ce?Q.slice(0,8):Q;H.push(e.createElement("div",{key:"clipArea",className:mi("clip-area","snap-control"),style:{width:"".concat(rt,"px"),height:"".concat(Ie,"px"),transform:"translate(".concat(Mt,"px, ").concat(at,"px)"),clipPath:"polygon(".concat($e.map(function(Xt){return"".concat(Xt[0]-Mt,"px ").concat(Xt[1]-at,"px")}).join(", "),")")}}))}}return z&&["vertical","horizontal"].forEach(function(je){var Xt=z[je],Yt=je==="horizontal";Xt.isSnap&&ne.push.apply(ne,vn([],Ht(Xt.snap.posInfos.map(function(pr,vt){var yr=pr.pos,_r=vi(gs(b,Yt?[0,yr]:[yr,0],W),[S,E]),cr=vi(gs(b,Yt?[f,yr]:[yr,g],W),[S,E]);return ab(e,"",_r,cr,s,"clip".concat(je,"snap").concat(vt),"guideline")})),!1)),Xt.isBound&&ne.push.apply(ne,vn([],Ht(Xt.bounds.map(function(pr,vt){var yr=pr.pos,_r=vi(gs(b,Yt?[0,yr]:[yr,0],W),[S,E]),cr=vi(gs(b,Yt?[f,yr]:[yr,g],W),[S,E]);return ab(e,"",_r,cr,s,"clip".concat(je,"bounds").concat(vt),"guideline","bounds","bold")})),!1))}),vn(vn([],Ht(H),!1),Ht(ne),!1)},dragControlCondition:function(t,e){return e.inputEvent&&(e.inputEvent.target.getAttribute("class")||"").indexOf("clip")>-1},dragStart:function(t,e){var r=t.props,n=r.dragWithClip,i=n===void 0?!0:n;return i?!1:this.dragControlStart(t,e)},drag:function(t,e){return this.dragControl(t,zt(zt({},e),{isDragTarget:!0}))},dragEnd:function(t,e){return this.dragControlEnd(t,e)},dragControlStart:function(t,e){var r=t.state,n=t.props,i=n.defaultClipPath,a=n.customClipPath,s=r.target,o=r.width,u=r.height,h=e.inputEvent?e.inputEvent.target:null,f=h&&h.getAttribute("class")||"",g=e.datas,b=mz(s,o,u,i||"inset",a);if(!b)return!1;var v=b.clipText,S=b.type,E=b.poses,P=$n(t,"onClipStart",qi(t,e,{clipType:S,clipStyle:v,poses:E.map(function(k){return k.pos})}));return P===!1?(g.isClipStart=!1,!1):(g.isControl=f&&f.indexOf("clip-control")>-1,g.isLine=f.indexOf("clip-line")>-1,g.isArea=f.indexOf("clip-area")>-1||f.indexOf("clip-ellipse")>-1,g.clipIndex=h?parseInt(h.getAttribute("data-clip-index"),10):-1,g.clipPath=b,g.isClipStart=!0,r.clipPathState=v,Um(t,e),!0)},dragControl:function(t,e){var r,n,i,a=e.datas,s=e.originalDatas,o=e.isDragTarget;if(!a.isClipStart)return!1;var u=a,h=u.isControl,f=u.isLine,g=u.isArea,b=u.clipIndex,v=u.clipPath;if(!v)return!1;var S=xm(t.props,"clippable"),E=S.keepRatio,P=0,k=0,L=s.draggable,O=ud(e);o&&L?(r=Ht(L.prevBeforeDist,2),P=r[0],k=r[1]):(n=Ht(O,2),P=n[0],k=n[1]);var M=[P,k],z=t.state,B=z.width,q=z.height,W=!g&&!h&&!f,G=v.type,ie=v.poses,Q=v.splitter,H=ie.map(function(Kt){return Kt.pos});W&&(P=-P,k=-k);var ne=!h||ie[b].direction==="nesw",oe=G==="inset"||G==="rect",ce=ie.map(function(){return[0,0]});if(h&&!ne){var fe=ie[b],Me=fe.horizontal,me=fe.vertical,we=[P*en(Me),k*en(me)];ce=ebe(ie,b,we,oe,E)}else ne&&(ce=H.map(function(){return[P,k]}));var Te=H.map(function(Kt,Rr){return Aa(Kt,ce[Rr])}),ke=vn([],Ht(Te),!1);z.snapBoundInfos=null;var he=v.type==="circle",Ee=v.type==="ellipse";if(he||Ee){var xe=xh(Te),Ne=en(xe.bottom-xe.top),Oe=en(Ee?xe.right-xe.left:Ne),$e=Te[0][1]+Ne,De=Te[0][0]-Oe,it=Te[0][0]+Oe;he&&(ke.push([it,xe.bottom]),ce.push([1,0])),ke.push([xe.left,$e]),ce.push([0,1]),ke.push([De,xe.bottom]),ce.push([1,0])}var Ye=OY((S.clipHorizontalGuidelines||[]).map(function(Kt){return vo("".concat(Kt),q)}),(S.clipVerticalGuidelines||[]).map(function(Kt){return vo("".concat(Kt),B)}),B,q),rt=[],Ie=[];if(he||Ee)rt=[ke[4][0],ke[2][0]],Ie=[ke[1][1],ke[3][1]];else if(oe){var Mt=[ke[0],ke[2],ke[4],ke[6]],at=[ce[0],ce[2],ce[4],ce[6]];rt=Mt.filter(function(Kt,Rr){return at[Rr][0]}).map(function(Kt){return Kt[0]}),Ie=Mt.filter(function(Kt,Rr){return at[Rr][1]}).map(function(Kt){return Kt[1]})}else rt=ke.filter(function(Kt,Rr){return ce[Rr][0]}).map(function(Kt){return Kt[0]}),Ie=ke.filter(function(Kt,Rr){return ce[Rr][1]}).map(function(Kt){return Kt[1]});var je=[0,0],Xt=ez(Ye,S.clipTargetBounds&&{left:0,top:0,right:B,bottom:q},rt,Ie,5,5),Yt=Xt.horizontal,pr=Xt.vertical,vt=Yt.offset,yr=pr.offset;if(Yt.isBound&&(je[1]+=vt),pr.isBound&&(je[0]+=yr),(Ee||he)&&ce[0][0]===0&&ce[0][1]===0){var xe=xh(Te),_r=xe.bottom-xe.top,cr=Ee?xe.right-xe.left:_r,Er=pr.isBound?en(yr):pr.snapIndex===0?-yr:yr,wr=Yt.isBound?en(vt):Yt.snapIndex===0?-vt:vt;cr-=Er,_r-=wr,he&&(_r=TY(pr,Yt)>0?_r:cr,cr=_r);var er=ke[0];ke[1][1]=er[1]-_r,ke[2][0]=er[0]+cr,ke[3][1]=er[1]+_r,ke[4][0]=er[0]-cr}else if(oe&&E&&h){var lr=Ht(nZ(ie),2),Ar=lr[0],ir=lr[1],nt=Ar&&ir?Ar/ir:0,_e=ie[b],be=_e.direction||"",qe=ke[1][1],$e=ke[5][1],De=ke[7][0],it=ke[3][0];en(vt)<=en(yr)?vt=ac(vt)*en(yr)/nt:yr=ac(yr)*en(vt)*nt,be.indexOf("w")>-1?De-=yr:be.indexOf("e")>-1?it-=yr:(De+=yr/2,it-=yr/2),be.indexOf("n")>-1?qe-=vt:be.indexOf("s")>-1?$e-=vt:(qe+=vt/2,$e-=vt/2);var Qe=hS(qe,it,$e,De);ke.forEach(function(Tr,Ur){var Gr;Gr=Ht(Qe[Ur].pos,2),Tr[0]=Gr[0],Tr[1]=Gr[1]})}else ke.forEach(function(Kt,Rr){var bt=ce[Rr];bt[0]&&(Kt[0]-=yr),bt[1]&&(Kt[1]-=vt)});var ot=HO(t,v,Te),et="".concat(G,"(").concat(ot.join(Q),")");if(z.clipPathState=et,he||Ee)rt=[ke[4][0],ke[2][0]],Ie=[ke[1][1],ke[3][1]];else if(oe){var Mt=[ke[0],ke[2],ke[4],ke[6]];rt=Mt.map(function(Rr){return Rr[0]}),Ie=Mt.map(function(Rr){return Rr[1]})}else rt=ke.map(function(Kt){return Kt[0]}),Ie=ke.map(function(Kt){return Kt[1]});if(z.snapBoundInfos=ez(Ye,S.clipTargetBounds&&{left:0,top:0,right:B,bottom:q},rt,Ie,1,1),L){var Lt=z.is3d,_t=z.allMatrix,jt=Lt?4:3,Jt=je;o&&(Jt=[M[0]+je[0]-O[0],M[1]+je[1]-O[1]]),L.deltaOffset=_o(_t,[Jt[0],Jt[1],0,0],jt)}return $n(t,"onClip",qi(t,e,zt({clipEventType:"changed",clipType:G,poses:Te,clipStyle:et,clipStyles:ot,distX:P,distY:k},oc((i={},i[G==="rect"?"clip":"clipPath"]=et,i),e)))),!0},dragControlEnd:function(t,e){this.unset(t);var r=e.isDrag,n=e.datas,i=e.isDouble,a=n.isLine,s=n.isClipStart,o=n.isControl;return s?($n(t,"onClipEnd",nh(t,e,{})),i&&(o?rbe(t,e):a&&tbe(t,e)),i||r):!1},unset:function(t){t.state.clipPathState="",t.state.snapBoundInfos=null}},ibe={name:"originDraggable",props:["originDraggable","originRelative"],events:["dragOriginStart","dragOrigin","dragOriginEnd"],css:[`:host[data-able-origindraggable] .control.origin {
pointer-events: auto;
}`],dragControlCondition:function(t,e){return e.isRequest?e.requestAble==="originDraggable":Ol(e.inputEvent.target,mi("origin"))},dragControlStart:function(t,e){var r=e.datas;Um(t,e);var n=qi(t,e,{dragStart:ic.dragStart(t,new o0().dragStart([0,0],e))}),i=$n(t,"onDragOriginStart",n);return r.startOrigin=t.state.transformOrigin,r.startTargetOrigin=t.state.targetOrigin,r.prevOrigin=[0,0],r.isDragOrigin=!0,i===!1?(r.isDragOrigin=!1,!1):n},dragControl:function(t,e){var r=e.datas,n=e.isPinch,i=e.isRequest;if(!r.isDragOrigin)return!1;var a=Ht(ud(e),2),s=a[0],o=a[1],u=t.state,h=u.width,f=u.height,g=u.offsetMatrix,b=u.targetMatrix,v=u.is3d,S=t.props.originRelative,E=S===void 0?!0:S,P=v?4:3,k=[s,o];if(i){var L=e.distOrigin;(L[0]||L[1])&&(k=L)}var O=Aa(r.startOrigin,k),M=Aa(r.startTargetOrigin,k),z=vi(k,r.prevOrigin),B=tx(g,b,O,P),q=t.getRect(),W=xh(Vm(B,h,f,P)),G=[q.left-W.left,q.top-W.top];r.prevOrigin=k;var ie=[Kh(M[0],h,E),Kh(M[1],f,E)].join(" "),Q=ic.drag(t,ex(e,t.state,G,!!n)),H=qi(t,e,zt(zt({width:h,height:f,origin:O,dist:k,delta:z,transformOrigin:ie,drag:Q},oc({transformOrigin:ie,transform:Q.transform},e)),{afterTransform:Q.transform}));return $n(t,"onDragOrigin",H),H},dragControlEnd:function(t,e){var r=e.datas;return r.isDragOrigin?($n(t,"onDragOriginEnd",nh(t,e,{})),!0):!1},dragGroupControlCondition:function(t,e){return this.dragControlCondition(t,e)},dragGroupControlStart:function(t,e){var r=this.dragControlStart(t,e);return!!r},dragGroupControl:function(t,e){var r=this.dragControl(t,e);return r?(t.transformOrigin=r.transformOrigin,!0):!1},request:function(t){var e={},r=t.getRect(),n=0,i=0,a=r.transformOrigin,s=[0,0];return{isControl:!0,requestStart:function(){return{datas:e}},request:function(o){return"deltaOrigin"in o?(s[0]+=o.deltaOrigin[0],s[1]+=o.deltaOrigin[1]):"origin"in o?(s[0]=o.origin[0]-a[0],s[1]=o.origin[1]-a[1]):("x"in o?n=o.x-r.left:"deltaX"in o&&(n+=o.deltaX),"y"in o?i=o.y-r.top:"deltaY"in o&&(i+=o.deltaY)),{datas:e,distX:n,distY:i,distOrigin:s}},requestEnd:function(){return{datas:e,isDrag:!0}}}}};function abe(t,e,r,n){var i=t.filter(function(u){var h=u.virtual,f=u.horizontal;return f&&!h}).length,a=t.filter(function(u){var h=u.virtual,f=u.vertical;return f&&!h}).length,s=-1;if(e===0&&(i===0?s=0:i===1&&(s=1)),e===2&&(i<=2?s=2:i<=3&&(s=3)),e===3&&(a===0?s=4:a<4&&(s=7)),e===1&&(a<=1?s=5:a<=2&&(s=6)),!(s===-1||!t[s].virtual)){var o=t[s];obe(t,s),s<4?o.pos[0]=r:o.pos[1]=n}}function obe(t,e){e<4?t.slice(0,e+1).forEach(function(r){r.virtual=!1}):(t[0].virtual&&(t[0].virtual=!1),t.slice(4,e+1).forEach(function(r){r.virtual=!1}))}function sbe(t,e){e<4?t.slice(e,4).forEach(function(r){r.virtual=!0}):t.slice(e).forEach(function(r){r.virtual=!0})}function yz(t,e,r,n,i){n===void 0&&(n=[0,0]);var a=[];return!t||t==="0px"?a=[]:a=Jp(t),rZ(a,e,r,0,0,n,i)}function vz(t,e,r,n,i){var a=t.state,s=a.width,o=a.height,u=qO(i,t.props.roundRelative,s,o),h=u.raws,f=u.styles,g=u.radiusPoses,b=K1e(g,h),v=b.horizontals,S=b.verticals,E=f.join(" ");a.borderRadiusState=E;var P=qi(t,e,zt({horizontals:v,verticals:S,borderRadius:E,width:s,height:o,delta:n,dist:r},oc({borderRadius:E},e)));return $n(t,"onRound",P),P}function _z(t){var e,r,n=t.getState().style,i=n.borderRadius||"";if(!i&&t.props.groupable){var a=t.moveables[0],s=t.getTargets()[0];s&&(a?.props.target===s?(i=(r=(e=t.moveables[0])===null||e===void 0?void 0:e.state.style.borderRadius)!==null&&r!==void 0?r:"",n.borderRadius=i):(i=zO(s).borderRadius,n.borderRadius=i))}return i}var lbe={name:"roundable",props:["roundable","roundRelative","minRoundControls","maxRoundControls","roundClickable","roundPadding","isDisplayShadowRoundControls"],events:["roundStart","round","roundEnd","roundGroupStart","roundGroup","roundGroupEnd"],css:[`.control.border-radius {
background: #d66;
cursor: pointer;
z-index: 3;
}`,`.control.border-radius.vertical {
background: #d6d;
z-index: 2;
}`,`.control.border-radius.virtual {
opacity: 0.5;
z-index: 1;
}`,`:host.round-line-clickable .line.direction {
cursor: pointer;
}`],className:function(t){var e=t.props.roundClickable;return e===!0||e==="line"?mi("round-line-clickable"):""},requestStyle:function(){return["borderRadius"]},requestChildStyle:function(){return["borderRadius"]},render:function(t,e){var r=t.getState(),n=r.target,i=r.width,a=r.height,s=r.allMatrix,o=r.is3d,u=r.left,h=r.top,f=r.borderRadiusState,g=t.props,b=g.minRoundControls,v=b===void 0?[0,0]:b,S=g.maxRoundControls,E=S===void 0?[4,4]:S,P=g.zoom,k=g.roundPadding,L=k===void 0?0:k,O=g.isDisplayShadowRoundControls,M=g.groupable;if(!n)return null;var z=f||_z(t),B=o?4:3,q=yz(z,i,a,v,!0);if(!q)return null;var W=0,G=0,ie=M?[0,0]:[u,h];return q.map(function(Q,H){var ne=Q.horizontal,oe=Q.vertical,ce=Q.direction||"",fe=vn([],Ht(Q.pos),!1);G+=Math.abs(ne),W+=Math.abs(oe),ne&&ce.indexOf("n")>-1&&(fe[1]-=L),oe&&ce.indexOf("w")>-1&&(fe[0]-=L),ne&&ce.indexOf("s")>-1&&(fe[1]+=L),oe&&ce.indexOf("e")>-1&&(fe[0]+=L);var Me=vi(gs(s,fe,B),ie),me=O&&O!=="horizontal",we=Q.vertical?W<=E[1]&&(me||!Q.virtual):G<=E[0]&&(O||!Q.virtual);return e.createElement("div",{key:"borderRadiusControl".concat(H),className:mi("control","border-radius",Q.vertical?"vertical":"",Q.virtual?"virtual":""),"data-radius-index":H,style:{display:we?"block":"none",transform:"translate(".concat(Me[0],"px, ").concat(Me[1],"px) scale(").concat(P,")")}})})},dragControlCondition:function(t,e){if(!e.inputEvent||e.isRequest)return!1;var r=e.inputEvent.target.getAttribute("class")||"";return r.indexOf("border-radius")>-1||r.indexOf("moveable-line")>-1&&r.indexOf("moveable-direction")>-1},dragGroupControlCondition:function(t,e){return this.dragControlCondition(t,e)},dragControlStart:function(t,e){var r=e.inputEvent,n=e.datas,i=r.target,a=i.getAttribute("class")||"",s=a.indexOf("border-radius")>-1,o=a.indexOf("moveable-line")>-1&&a.indexOf("moveable-direction")>-1,u=s?parseInt(i.getAttribute("data-radius-index"),10):-1,h=-1;if(o){var f=i.getAttribute("data-line-key")||"";f&&(h=parseInt(f.replace(/render-line-/g,""),10),isNaN(h)&&(h=-1))}if(!s&&!o)return!1;var g=qi(t,e,{}),b=$n(t,"onRoundStart",g);if(b===!1)return!1;n.lineIndex=h,n.controlIndex=u,n.isControl=s,n.isLine=o,Um(t,e);var v=t.props,S=v.roundRelative,E=v.minRoundControls,P=E===void 0?[0,0]:E,k=t.state,L=k.width,O=k.height;n.isRound=!0,n.prevDist=[0,0];var M=_z(t),z=yz(M||"",L,O,P,!0)||[];return n.controlPoses=z,k.borderRadiusState=qO(z,S,L,O).styles.join(" "),g},dragControl:function(t,e){var r=e.datas,n=r.controlPoses;if(!r.isRound||!r.isControl||!n.length)return!1;var i=r.controlIndex,a=Ht(ud(e),2),s=a[0],o=a[1],u=[s,o],h=vi(u,r.prevDist),f=t.props.maxRoundControls,g=f===void 0?[4,4]:f,b=t.state,v=b.width,S=b.height,E=n[i],P=E.vertical,k=E.horizontal,L=n.map(function(M){var z=M.horizontal,B=M.vertical,q=[z*k*u[0],B*P*u[1]];if(z){if(g[0]===1)return q;if(g[0]<4&&z!==k)return q}else{if(g[1]===0)return q[1]=B*k*u[0]/v*S,q;if(P){if(g[1]===1)return q;if(g[1]<4&&B!==P)return q}}return[0,0]});L[i]=u;var O=n.map(function(M,z){return zt(zt({},M),{pos:Aa(M.pos,L[z])})});return i<4?O.slice(0,i+1).forEach(function(M){M.virtual=!1}):O.slice(4,i+1).forEach(function(M){M.virtual=!1}),r.prevDist=[s,o],vz(t,e,u,h,O)},dragControlEnd:function(t,e){var r=t.state;r.borderRadiusState="";var n=e.datas,i=e.isDouble;if(!n.isRound)return!1;var a=n.isControl,s=n.controlIndex,o=n.isLine,u=n.lineIndex,h=n.controlPoses,f=h.filter(function(k){var L=k.virtual;return L}).length,g=t.props.roundClickable,b=g===void 0?!0:g;if(i&&b){if(a&&(b===!0||b==="control"))sbe(h,s);else if(o&&(b===!0||b==="line")){var v=Ht(sY(t,e),2),S=v[0],E=v[1];abe(h,u,S,E)}f!==h.filter(function(k){var L=k.virtual;return L}).length&&vz(t,e,[0,0],[0,0],h)}var P=nh(t,e,{});return $n(t,"onRoundEnd",P),r.borderRadiusState="",P},dragGroupControlStart:function(t,e){var r=this.dragControlStart(t,e);if(!r)return!1;var n=t.moveables,i=t.props.targets,a=af(t,"roundable",e),s=zt({targets:t.props.targets,events:a.map(function(o,u){return zt(zt({},o),{target:i[u],moveable:n[u],currentTarget:n[u]})})},r);return $n(t,"onRoundGroupStart",s),r},dragGroupControl:function(t,e){var r=this.dragControl(t,e);if(!r)return!1;var n=t.moveables,i=t.props.targets,a=af(t,"roundable",e),s=zt({targets:t.props.targets,events:a.map(function(o,u){return zt(zt(zt({},o),{target:i[u],moveable:n[u],currentTarget:n[u]}),oc({borderRadius:r.borderRadius},o))})},r);return $n(t,"onRoundGroup",s),s},dragGroupControlEnd:function(t,e){var r=t.moveables,n=t.props.targets,i=af(t,"roundable",e);pT(t,"onRound",function(o){var u=zt({targets:t.props.targets,events:i.map(function(h,f){return zt(zt(zt({},h),{target:n[f],moveable:r[f],currentTarget:r[f]}),oc({borderRadius:o.borderRadius},h))})},o);$n(t,"onRoundGroup",u)});var a=this.dragControlEnd(t,e);if(!a)return!1;var s=zt({targets:t.props.targets,events:i.map(function(o,u){var h;return zt(zt({},o),{target:n[u],moveable:r[u],currentTarget:r[u],lastEvent:(h=o.datas)===null||h===void 0?void 0:h.lastEvent})})},a);return $n(t,"onRoundGroupEnd",s),s},unset:function(t){t.state.borderRadiusState=""}};function ube(t,e){var r=e?4:3,n=$o(r),i="matrix".concat(e?"3d":"","(").concat(n.join(","),")");return t===i||t==="matrix(1,0,0,1,0,0)"}var iZ={isPinch:!0,name:"beforeRenderable",props:[],events:["beforeRenderStart","beforeRender","beforeRenderEnd","beforeRenderGroupStart","beforeRenderGroup","beforeRenderGroupEnd"],dragRelation:"weak",setTransform:function(t,e){var r=t.state,n=r.is3d,i=r.targetMatrix,a=r.inlineTransform,s=n?"matrix3d(".concat(i.join(","),")"):"matrix(".concat(YX(i,!0),")"),o=!a||a==="none"?s:a;e.datas.startTransforms=ube(o,n)?[]:Jp(o)},resetStyle:function(t){var e=t.datas;e.nextStyle={},e.nextTransforms=t.datas.startTransforms,e.nextTransformAppendedIndexes=[]},fillDragStartParams:function(t,e){return qi(t,e,{setTransform:function(r){e.datas.startTransforms=eu(r)?r:Jp(r)},isPinch:!!e.isPinch})},fillDragParams:function(t,e){return qi(t,e,{isPinch:!!e.isPinch})},dragStart:function(t,e){this.setTransform(t,e),this.resetStyle(e),$n(t,"onBeforeRenderStart",this.fillDragStartParams(t,e))},drag:function(t,e){e.datas.startTransforms||this.setTransform(t,e),this.resetStyle(e),$n(t,"onBeforeRender",qi(t,e,{isPinch:!!e.isPinch}))},dragEnd:function(t,e){e.datas.startTransforms||(this.setTransform(t,e),this.resetStyle(e)),$n(t,"onBeforeRenderEnd",qi(t,e,{isPinch:!!e.isPinch,isDrag:e.isDrag}))},dragGroupStart:function(t,e){var r=this;this.dragStart(t,e);var n=af(t,"beforeRenderable",e),i=t.moveables,a=n.map(function(s,o){var u=i[o];return r.setTransform(u,s),r.resetStyle(s),r.fillDragStartParams(u,s)});$n(t,"onBeforeRenderGroupStart",qi(t,e,{isPinch:!!e.isPinch,targets:t.props.targets,setTransform:function(){},events:a}))},dragGroup:function(t,e){var r=this;this.drag(t,e);var n=af(t,"beforeRenderable",e),i=t.moveables,a=n.map(function(s,o){var u=i[o];return r.resetStyle(s),r.fillDragParams(u,s)});$n(t,"onBeforeRenderGroup",qi(t,e,{isPinch:!!e.isPinch,targets:t.props.targets,events:a}))},dragGroupEnd:function(t,e){this.dragEnd(t,e),$n(t,"onBeforeRenderGroupEnd",qi(t,e,{isPinch:!!e.isPinch,isDrag:e.isDrag,targets:t.props.targets}))},dragControlStart:function(t,e){return this.dragStart(t,e)},dragControl:function(t,e){return this.drag(t,e)},dragControlEnd:function(t,e){return this.dragEnd(t,e)},dragGroupControlStart:function(t,e){return this.dragGroupStart(t,e)},dragGroupControl:function(t,e){return this.dragGroup(t,e)},dragGroupControlEnd:function(t,e){return this.dragGroupEnd(t,e)}},aZ={name:"renderable",props:[],events:["renderStart","render","renderEnd","renderGroupStart","renderGroup","renderGroupEnd"],dragRelation:"weak",dragStart:function(t,e){$n(t,"onRenderStart",qi(t,e,{isPinch:!!e.isPinch}))},drag:function(t,e){$n(t,"onRender",this.fillDragParams(t,e))},dragAfter:function(t,e){return this.drag(t,e)},dragEnd:function(t,e){$n(t,"onRenderEnd",this.fillDragEndParams(t,e))},dragGroupStart:function(t,e){$n(t,"onRenderGroupStart",qi(t,e,{isPinch:!!e.isPinch,targets:t.props.targets}))},dragGroup:function(t,e){var r=this,n=af(t,"beforeRenderable",e),i=t.moveables,a=n.map(function(s,o){var u=i[o];return r.fillDragParams(u,s)});$n(t,"onRenderGroup",qi(t,e,zt(zt({isPinch:!!e.isPinch,targets:t.props.targets,transform:g2(e),transformObject:{}},oc(m2(e))),{events:a})))},dragGroupEnd:function(t,e){var r=this,n=af(t,"beforeRenderable",e),i=t.moveables,a=n.map(function(s,o){var u=i[o];return r.fillDragEndParams(u,s)});$n(t,"onRenderGroupEnd",qi(t,e,zt({isPinch:!!e.isPinch,isDrag:e.isDrag,targets:t.props.targets,events:a,transformObject:{},transform:g2(e)},oc(m2(e)))))},dragControlStart:function(t,e){return this.dragStart(t,e)},dragControl:function(t,e){return this.drag(t,e)},dragControlAfter:function(t,e){return this.dragAfter(t,e)},dragControlEnd:function(t,e){return this.dragEnd(t,e)},dragGroupControlStart:function(t,e){return this.dragGroupStart(t,e)},dragGroupControl:function(t,e){return this.dragGroup(t,e)},dragGroupControlEnd:function(t,e){return this.dragGroupEnd(t,e)},fillDragParams:function(t,e){var r={};return a0(iS(e)||[]).forEach(function(n){r[n.name]=n.functionValue}),qi(t,e,zt({isPinch:!!e.isPinch,transformObject:r,transform:g2(e)},oc(m2(e))))},fillDragEndParams:function(t,e){var r={};return a0(iS(e)||[]).forEach(function(n){r[n.name]=n.functionValue}),qi(t,e,zt({isPinch:!!e.isPinch,isDrag:e.isDrag,transformObject:r,transform:g2(e)},oc(m2(e))))}};function M1(t,e,r,n,i,a,s){a.clientDistX=a.distX,a.clientDistY=a.distY;var o=i==="Start",u=i==="End",h=i==="After",f=t.state.target,g=a.isRequest,b=n.indexOf("Control")>-1;if(!f||o&&b&&!g&&t.areaElement===a.inputEvent.target)return!1;var v=vn([],Ht(e),!1);if(g){var S=a.requestAble;v.some(function(H){return H.name===S})||v.push.apply(v,vn([],Ht(t.props.ables.filter(function(H){return H.name===S})),!1))}if(!v.length||v.every(function(H){return H.dragRelation}))return!1;var E=a.inputEvent,P;u&&E&&(P=document.elementFromPoint(a.clientX,a.clientY)||E.target);var k=!1,L=function(){var H;k=!0,(H=a.stop)===null||H===void 0||H.call(a)},O=o&&(!t.targetGesto||!t.controlGesto||!t.targetGesto.isFlag()||!t.controlGesto.isFlag());O&&t.updateRect(i,!0,!1);var M=a.datas,z=b?"controlGesto":"targetGesto",B=t[z],q=function(H,ne,oe){if(!(ne in H)||B!==t[z])return!1;var ce=H.name,fe=M[ce]||(M[ce]={});if(o&&(fe.isEventStart=!oe||!H[oe]||H[oe](t,a)),!fe.isEventStart)return!1;var Me=H[ne](t,zt(zt({},a),{stop:L,datas:fe,originalDatas:M,inputTarget:P}));return t._emitter.off(),o&&Me===!1&&(fe.isEventStart=!1),Me};O&&v.forEach(function(H){H.unset&&H.unset(t)}),q(iZ,"drag".concat(n).concat(i));var W=0,G=0;r.forEach(function(H){if(k)return!1;var ne="".concat(H).concat(n).concat(i),oe="".concat(H).concat(n,"Condition");i===""&&!g&&R1e(t.state,a);var ce=v.filter(function(me){return me[ne]});ce=ce.filter(function(me,we){return me.name&&ce.indexOf(me)===we});var fe=ce.filter(function(me){return q(me,ne,oe)}),Me=fe.length;k&&++W,Me&&++G,!k&&o&&ce.length&&!Me&&(W+=ce.filter(function(me){var we=me.name,Te=M[we];return Te.isEventStart?me.dragRelation!=="strong":!1}).length?1:0)}),(!h||G)&&q(aZ,"drag".concat(n).concat(i));var ie=B!==t[z]||W===r.length;if((u||k||ie)&&(t.state.gestos={},t.moveables&&t.moveables.forEach(function(H){H.state.gestos={}}),v.forEach(function(H){H.unset&&H.unset(t)})),o&&!ie&&!g&&G&&t.props.preventDefault&&a?.preventDefault(),t.isUnmounted||ie)return!1;if(!o&&G&&!s||u){var Q=t.props.flushSync||DY;Q(function(){t.updateRect(u?i:"",!0,!1),t.forceUpdate()})}return!o&&!u&&!h&&G&&!s&&M1(t,e,r,n,i+"After",a),!0}function WO(t,e){return function(r,n){var i;n===void 0&&(n=r.inputEvent.target);var a=n,s=t.areaElement,o=t._dragTarget;return!o||!e&&(!((i=t.controlGesto)===null||i===void 0)&&i.isFlag())?!1:a===o||o.contains(a)||a===s||!t.isMoveableElement(a)&&!t.controlBox.contains(a)||Ol(a,"moveable-area")||Ol(a,"moveable-padding")||Ol(a,"moveable-edgeDraggable")}}function oZ(t,e,r){var n=t.controlBox,i=[],a=t.props,s=a.dragArea,o=t.state.target,u=a.dragTarget;i.push(n),(!s||u)&&i.push(e),!s&&u&&o&&e!==o&&a.dragTargetSelf&&i.push(o);var h=WO(t);return lZ(t,i,"targetAbles",r,{dragStart:h,pinchStart:h})}function sZ(t,e){var r=t.controlBox,n=[];n.push(r);var i=WO(t,!0),a=function(s,o){if(o===void 0&&(o=s.inputEvent.target),o===r)return!0;var u=i(s,o);return!u};return lZ(t,n,"controlAbles",e,{dragStart:a,pinchStart:a})}function lZ(t,e,r,n,i){i===void 0&&(i={});var a=r==="targetAbles",s=t.props,o=s.pinchOutside,u=s.pinchThreshold,h=s.preventClickEventOnDrag,f=s.preventClickDefault,g=s.checkInput,b=s.dragFocusedInput,v=s.preventDefault,S=v===void 0?!0:v,E=s.preventRightClick,P=E===void 0?!0:E,k=s.preventWheelClick,L=k===void 0?!0:k,O=s.dragContainer,M=Jf(O,!0),z={preventDefault:S,preventRightClick:P,preventWheelClick:L,container:M||Hp(t.getControlBoxElement()),pinchThreshold:u,pinchOutside:o,preventClickEventOnDrag:a?h:!1,preventClickEventOnDragStart:a?f:!1,preventClickEventByCondition:a?null:function(W){return t.controlBox.contains(W.target)},checkInput:a?g:!1,dragFocusedInput:b},B=new N0e(e,z),q=n==="Control";return["drag","pinch"].forEach(function(W){["Start","","End"].forEach(function(G){B.on("".concat(W).concat(G),function(ie){var Q,H=ie.eventType,ne=W==="drag"&&ie.isPinch;if(i[H]&&!i[H](ie)){ie.stop();return}if(!ne){var oe=W==="drag"?[W]:["drag",W],ce=vn([],Ht(t[r]),!1),fe=M1(t,ce,oe,n,G,ie);fe?(t.props.stopPropagation||G==="Start"&&q)&&((Q=ie?.inputEvent)===null||Q===void 0||Q.stopPropagation()):ie.stop()}})})}),B}var cbe=(function(){function t(e,r,n){var i=this;this.target=e,this.moveable=r,this.eventName=n,this.ables=[],this._onEvent=function(a){var s=i.eventName,o=i.moveable;o.state.disableNativeEvent||i.ables.forEach(function(u){u[s](o,{inputEvent:a})})},e.addEventListener(n.toLowerCase(),this._onEvent)}return t.prototype.setAbles=function(e){this.ables=e},t.prototype.destroy=function(){this.target.removeEventListener(this.eventName.toLowerCase(),this._onEvent),this.target=null,this.moveable=null},t})();function hbe(t,e,r,n){var i;r===void 0&&(r=e);var a=dY(t,e),s=a.matrixes,o=a.is3d,u=a.targetMatrix,h=a.transformOrigin,f=a.targetOrigin,g=a.offsetContainer,b=a.hasFixed,v=a.zoom,S=T_e(g,r),E=S.matrixes,P=S.is3d,k=S.offsetContainer,L=S.zoom,O=n,M=4,z=t.tagName.toLowerCase()!=="svg"&&"ownerSVGElement"in t,B=u,q=$o(M),W=$o(M),G=$o(M),ie=$o(M),Q=s.length,H=E.map(function(we){return zt(zt({},we),{matrix:we.matrix?vn([],Ht(we.matrix),!1):void 0})}).reverse();s.reverse(),!o&&O&&(B=lf(B,3,4),gk(s)),!P&&O&&gk(H),H.forEach(function(we){W=_o(W,we.matrix,M)});var ne=r||cg(t),oe=((i=H[0])===null||i===void 0?void 0:i.target)||ob(ne,ne,!0).offsetParent,ce=H.slice(1).reduce(function(we,Te){return _o(we,Te.matrix,M)},$o(M));s.forEach(function(we,Te){if(Q-2===Te&&(G=q.slice()),Q-1===Te&&(ie=q.slice()),!we.matrix){var ke=s[Te+1],he=I1e(we,ke,oe,M,_o(ce,q,M));we.matrix=_m(he,M)}q=_o(q,we.matrix,M)});var fe=!z&&o;B||(B=$o(fe?4:3));var Me=dT(z&&B.length===16?lf(B,4,3):B,fe),me=W;return W=GX(W,M,M),{hasZoom:v!==1||L!==1,hasFixed:b,matrixes:s,rootMatrix:W,originalRootMatrix:me,beforeMatrix:G,offsetMatrix:ie,allMatrix:q,targetMatrix:B,targetTransform:Me,inlineTransform:t.style.transform,transformOrigin:h,targetOrigin:f,is3d:O,offsetContainer:g,offsetRootContainer:k}}function fbe(t,e,r,n){r===void 0&&(r=e);var i=0,a=0,s=0,o={},u=jY(t);if(t&&(i=u.offsetWidth,a=u.offsetHeight),t){var h=hbe(t,e,r,n),f=Hv(h.allMatrix,h.transformOrigin,i,a);o=zt(zt({},h),f);var g=Hv(h.allMatrix,[50,50],100,100);s=UY([g.pos1,g.pos2],g.direction)}var b=4;return zt(zt(zt({hasZoom:!1,width:i,height:a,rotation:s},u),{originalRootMatrix:$o(b),rootMatrix:$o(b),beforeMatrix:$o(b),offsetMatrix:$o(b),allMatrix:$o(b),targetMatrix:$o(b),targetTransform:"",inlineTransform:"",transformOrigin:[0,0],targetOrigin:[0,0],is3d:!0,left:0,top:0,right:0,bottom:0,origin:[0,0],pos1:[0,0],pos2:[0,0],pos3:[0,0],pos4:[0,0],direction:1,hasFixed:!1,offsetContainer:null,offsetRootContainer:null,matrixes:[]}),o)}function _k(t,e,r,n,i,a){a===void 0&&(a=[]);var s=1,o=[0,0],u=v2(),h=v2(),f=v2(),g=v2(),b=[0,0],v={},S=fbe(e,r,i,!0);if(e){var E=Ec(e);a.forEach(function(H){v[H]=E(H)});var P=S.is3d?4:3,k=Hv(S.offsetMatrix,Aa(S.transformOrigin,XX(S.targetMatrix,P)),S.width,S.height);s=k.direction,o=Aa(k.origin,[k.left-S.left,k.top-S.top]),g=k1(S.offsetRootContainer);var L=ob(n,n,!0).offsetParent||S.offsetRootContainer;if(S.hasZoom){var O=Hv(_o(S.originalRootMatrix,S.allMatrix),S.transformOrigin,S.width,S.height),M=Hv(S.originalRootMatrix,lS(Ec(L)("transformOrigin")).map(function(H){return parseFloat(H)}),L.offsetWidth,L.offsetHeight);if(u=G3(O,g),f=G3(M,g,L,!0),t){var z=O.left,B=O.top;h=G3({left:z,top:B,bottom:B,right:B},g)}}else{u=k1(e),f=E_e(L),t&&(h=k1(t));var q=f.left,W=f.top,G=f.clientLeft,ie=f.clientTop,Q=[u.left-q,u.top-W];b=vi(u0(S.rootMatrix,Q,4),[G+S.left,ie+S.top])}}return zt({targetClientRect:u,containerClientRect:f,moveableClientRect:h,rootContainerClientRect:g,beforeDirection:s,beforeOrigin:o,originalBeforeOrigin:o,target:e,style:v,offsetDelta:b},S)}function bz(t){var e=t.pos1,r=t.pos2,n=t.pos3,i=t.pos4;if(!e||!r||!n||!i)return null;var a=bm([e,r,n,i]),s=[a.minX,a.minY],o=vi(t.origin,s);return e=vi(e,s),r=vi(r,s),n=vi(n,s),i=vi(i,s),zt(zt({},t),{left:t.left,top:t.top,posDelta:s,pos1:e,pos2:r,pos3:n,pos4:i,origin:o,beforeOrigin:o,isPersisted:!0})}var c0=(function(t){Jb(e,t);function e(){var r=t!==null&&t.apply(this,arguments)||this;return r.state=zt({container:null,gestos:{},renderLines:[[[0,0],[0,0]],[[0,0],[0,0]],[[0,0],[0,0]],[[0,0],[0,0]]],renderPoses:[[0,0],[0,0],[0,0],[0,0]],disableNativeEvent:!1,posDelta:[0,0]},_k(null)),r.renderState={},r.enabledAbles=[],r.targetAbles=[],r.controlAbles=[],r.rotation=0,r.scale=[1,1],r.isMoveableMounted=!1,r.isUnmounted=!1,r.events={mouseEnter:null,mouseLeave:null},r._emitter=new EO,r._prevOriginalDragTarget=null,r._originalDragTarget=null,r._prevDragTarget=null,r._dragTarget=null,r._prevPropTarget=null,r._propTarget=null,r._prevDragArea=!1,r._isPropTargetChanged=!1,r._hasFirstTarget=!1,r._reiszeObserver=null,r._observerId=0,r._mutationObserver=null,r._rootContainer=null,r._viewContainer=null,r._viewClassNames=[],r._store={},r.checkUpdateRect=function(){if(!r.isDragging()){var n=r.props.parentMoveable;if(n){n.checkUpdateRect();return}Yve(r._observerId),r._observerId=VX(function(){r.isDragging()||r.updateRect()})}},r._onPreventClick=function(n){n.stopPropagation(),n.preventDefault()},r}return e.prototype.render=function(){var r=this.props,n=this.getState(),i=r.parentPosition,a=r.className,s=r.target,o=r.zoom,u=r.cspNonce,h=r.translateZ,f=r.cssStyled,g=r.groupable,b=r.linePadding,v=r.controlPadding;this._checkUpdateRootContainer(),this.checkUpdate(),this.updateRenderPoses();var S=Ht(i||[0,0],2),E=S[0],P=S[1],k=n.left,L=n.top,O=n.target,M=n.direction,z=n.hasFixed,B=n.offsetDelta,q=r.targets,W=this.isDragging(),G={};this.getEnabledAbles().forEach(function(ce){G["data-able-".concat(ce.name.toLowerCase())]=!0});var ie=this._getAbleClassName(),Q=q&&q.length&&(O||g)||s||!this._hasFirstTarget&&this.state.isPersisted,H=this.controlBox||this.props.firstRenderState||this.props.persistData,ne=[k-E,L-P];!g&&r.useAccuratePosition&&(ne[0]+=B[0],ne[1]+=B[1]);var oe={position:z?"fixed":"absolute",display:Q?"block":"none",visibility:H?"visible":"hidden",transform:"translate3d(".concat(ne[0],"px, ").concat(ne[1],"px, ").concat(h,")"),"--zoom":o,"--zoompx":"".concat(o,"px")};return b&&(oe["--moveable-line-padding"]=b),v&&(oe["--moveable-control-padding"]=v),ee.createElement(f,zt({cspNonce:u,ref:om(this,"controlBox"),className:"".concat(mi("control-box",M===-1?"reverse":"",W?"dragging":"")," ").concat(ie," ").concat(a)},G,{onClick:this._onPreventClick,style:oe}),this.renderAbles(),this._renderLines())},e.prototype.componentDidMount=function(){this.isMoveableMounted=!0,this.isUnmounted=!1;var r=this.props,n=r.parentMoveable,i=r.container;this._checkUpdateRootContainer(),this._checkUpdateViewContainer(),this._updateTargets(),this._updateNativeEvents(),this._updateEvents(),this.updateCheckInput(),this._updateObserver(this.props),!i&&!n&&!this.state.isPersisted&&(this.updateRect("",!1,!1),this.forceUpdate())},e.prototype.componentDidUpdate=function(r){this._checkUpdateRootContainer(),this._checkUpdateViewContainer(),this._updateNativeEvents(),this._updateTargets(),this._updateEvents(),this.updateCheckInput(),this._updateObserver(r)},e.prototype.componentWillUnmount=function(){var r,n;this.isMoveableMounted=!1,this.isUnmounted=!0,this._emitter.off(),(r=this._reiszeObserver)===null||r===void 0||r.disconnect(),(n=this._mutationObserver)===null||n===void 0||n.disconnect();var i=this._viewContainer;i&&this._changeAbleViewClassNames([]),Av(this,!1),Av(this,!0);var a=this.events;for(var s in a){var o=a[s];o&&o.destroy()}},e.prototype.getTargets=function(){var r=this.props.target;return r?[r]:[]},e.prototype.getAble=function(r){var n=this.props.ables||[];return rh(n,function(i){return i.name===r})},e.prototype.getContainer=function(){var r=this.props,n=r.parentMoveable,i=r.wrapperMoveable,a=r.container;return a||i&&i.getContainer()||n&&n.getContainer()||this.controlBox.parentElement},e.prototype.getControlBoxElement=function(){return this.controlBox},e.prototype.getDragElement=function(){return this._dragTarget},e.prototype.isMoveableElement=function(r){var n;return r&&(((n=r.getAttribute)===null||n===void 0?void 0:n.call(r,"class"))||"").indexOf(AO)>-1},e.prototype.dragStart=function(r,n){n===void 0&&(n=r.target);var i=this.targetGesto,a=this.controlGesto;return i&&WO(this)({inputEvent:r},n)?i.isFlag()||i.triggerDragStart(r):a&&this.isMoveableElement(n)&&(a.isFlag()||a.triggerDragStart(r)),this},e.prototype.hitTest=function(r){var n=this.state,i=n.target,a=n.pos1,s=n.pos2,o=n.pos3,u=n.pos4,h=n.targetClientRect;if(!i)return 0;var f;if(bO(r)){var g=r.getBoundingClientRect();f={left:g.left,top:g.top,width:g.width,height:g.height}}else f=zt({width:0,height:0},r);var b=f.left,v=f.top,S=f.width,E=f.height,P=$B([a,s,u,o],h),k=P0e(P,[[b,v],[b+S,v],[b+S,v+E],[b,v+E]]),L=JX(P);return!k||!L?0:Math.min(100,k/L*100)},e.prototype.isInside=function(r,n){var i=this.state,a=i.target,s=i.pos1,o=i.pos2,u=i.pos3,h=i.pos4,f=i.targetClientRect;return a?rk([r,n],$B([s,o,h,u],f)):!1},e.prototype.updateRect=function(r,n,i){i===void 0&&(i=!0);var a=this.props,s=!a.parentPosition&&!a.wrapperMoveable;s&&s0(!0);var o=a.parentMoveable,u=this.state,h=u.target||a.target,f=this.getContainer(),g=o?o._rootContainer:this._rootContainer,b=_k(this.controlBox,h,f,f,g||f,this._getRequestStyles());if(!h&&this._hasFirstTarget&&a.persistData){var v=bz(a.persistData);for(var S in v)b[S]=v[S]}s&&s0(),this.updateState(b,o?!1:i)},e.prototype.isDragging=function(r){var n,i,a=this.targetGesto,s=this.controlGesto;if(a?.isFlag()){if(!r)return!0;var o=a.getEventData();return!!(!((n=o[r])===null||n===void 0)&&n.isEventStart)}if(s?.isFlag()){if(!r)return!0;var o=s.getEventData();return!!(!((i=o[r])===null||i===void 0)&&i.isEventStart)}return!1},e.prototype.updateTarget=function(r){this.updateRect(r,!0)},e.prototype.getRect=function(){var r=this.state,n=Mh(this.state),i=Ht(n,4),a=i[0],s=i[1],o=i[2],u=i[3],h=xh(n),f=r.width,g=r.height,b=h.width,v=h.height,S=h.left,E=h.top,P=[r.left,r.top],k=Aa(P,r.origin),L=Aa(P,r.beforeOrigin),O=r.transformOrigin;return{width:b,height:v,left:S,top:E,pos1:a,pos2:s,pos3:o,pos4:u,offsetWidth:f,offsetHeight:g,beforeOrigin:L,origin:k,transformOrigin:O,rotation:this.getRotation()}},e.prototype.getManager=function(){return this},e.prototype.stopDrag=function(r){if(!r||r==="target"){var n=this.targetGesto;n?.isIdle()===!1&&mk(this,!1),n?.stop()}if(!r||r==="control"){var n=this.controlGesto;n?.isIdle()===!1&&mk(this,!0),n?.stop()}},e.prototype.getRotation=function(){var r=this.state,n=r.pos1,i=r.pos2,a=r.direction;return N1e(n,i,a)},e.prototype.request=function(r,n,i){n===void 0&&(n={});var a=this,s=a.props,o=s.parentMoveable||s.wrapperMoveable||a,u=o.props.ables,h=s.groupable,f=rh(u,function(k){return k.name===r});if(this.isDragging()||!f||!f.request)return{request:function(){return this},requestEnd:function(){return this}};var g=f.request(a),b=i||n.isInstant,v=g.isControl?"controlAbles":"targetAbles",S="".concat(h?"Group":"").concat(g.isControl?"Control":""),E=vn([],Ht(o[v]),!1),P={request:function(k){return M1(a,E,["drag"],S,"",zt(zt({},g.request(k)),{requestAble:r,isRequest:!0}),b),P},requestEnd:function(){return M1(a,E,["drag"],S,"End",zt(zt({},g.requestEnd()),{requestAble:r,isRequest:!0}),b),P}};return M1(a,E,["drag"],S,"Start",zt(zt({},g.requestStart(n)),{requestAble:r,isRequest:!0}),b),b?P.request(n).requestEnd():P},e.prototype.getMoveables=function(){return[this]},e.prototype.destroy=function(){this.componentWillUnmount()},e.prototype.updateRenderPoses=function(){var r=this.getState(),n=this.props,i=n.padding,a=r.originalBeforeOrigin,s=r.transformOrigin,o=r.allMatrix,u=r.is3d,h=r.pos1,f=r.pos2,g=r.pos3,b=r.pos4,v=r.left,S=r.top,E=r.isPersisted,P=n.zoom||1;if(!i&&P<=1){r.renderPoses=[h,f,g,b],r.renderLines=[[h,f],[f,b],[b,g],[g,h]];return}var k=KY(i||{}),L=k.left,O=k.top,M=k.bottom,z=k.right,B=u?4:3,q=[];E?q=s:this.controlBox&&n.groupable?q=a:q=Aa(a,[v,S]);var W=rS(B,_m(q.map(function(oe){return-oe}),B),o,_m(s,B)),G=hh(W,h,[-L,-O],B),ie=hh(W,f,[z,-O],B),Q=hh(W,g,[-L,M],B),H=hh(W,b,[z,M],B);r.renderPoses=[G,ie,Q,H],r.renderLines=[[G,ie],[ie,H],[H,Q],[Q,G]];{var ne=P/2;r.renderLines=[[hh(W,h,[-L-ne,-O],B),hh(W,f,[z+ne,-O],B)],[hh(W,f,[z,-O-ne],B),hh(W,b,[z,M+ne],B)],[hh(W,b,[z+ne,M],B),hh(W,g,[-L-ne,M],B)],[hh(W,g,[-L,M+ne],B),hh(W,h,[-L,-O-ne],B)]]}},e.prototype.checkUpdate=function(){this._isPropTargetChanged=!1;var r=this.props,n=r.target,i=r.container,a=r.parentMoveable,s=this.state,o=s.target,u=s.container;if(!(!o&&!n)){this.updateAbles();var h=!yk(o,n),f=h||!yk(u,i);if(f){var g=i||this.controlBox;g&&this.unsetAbles(),this.updateState({target:n,container:i}),!a&&g&&this.updateRect("End",!1,!1),this._isPropTargetChanged=h}}},e.prototype.waitToChangeTarget=function(){return new Promise(function(){})},e.prototype.triggerEvent=function(r,n){var i=this.props;if(this._emitter.trigger(r,n),i.parentMoveable&&n.isRequest&&!n.isRequestChild)return i.parentMoveable.triggerEvent(r,n,!0);var a=i[r];return a&&a(n)},e.prototype.useCSS=function(r,n){var i=this.props.customStyledMap,a=r+n;return i[a]||(i[a]=tY(r,n)),i[a]},e.prototype.getState=function(){var r,n=this.props;(n.target||!((r=n.targets)===null||r===void 0)&&r.length)&&(this._hasFirstTarget=!0);var i=this.controlBox,a=n.persistData,s=n.firstRenderState;if(s&&!i)return s;if(!this._hasFirstTarget&&a){var o=bz(a);if(o)return this.updateState(o,!1),this.state}return this.state.isPersisted=!1,this.state},e.prototype.updateSelectors=function(){},e.prototype.unsetAbles=function(){var r=this;this.targetAbles.forEach(function(n){n.unset&&n.unset(r)})},e.prototype.updateAbles=function(r,n){r===void 0&&(r=this.props.ables),n===void 0&&(n="");var i=this.props,a=i.triggerAblesSimultaneously,s=this.getEnabledAbles(r),o="drag".concat(n,"Start"),u="pinch".concat(n,"Start"),h="drag".concat(n,"ControlStart"),f=_2(s,[o,u],a),g=_2(s,[h],a);this.enabledAbles=s,this.targetAbles=f,this.controlAbles=g},e.prototype.updateState=function(r,n){if(n){if(this.isUnmounted)return;this.setState(r)}else{var i=this.state;for(var a in r)i[a]=r[a]}},e.prototype.getEnabledAbles=function(r){r===void 0&&(r=this.props.ables);var n=this.props;return r.filter(function(i){return i&&(i.always&&n[i.name]!==!1||n[i.name])})},e.prototype.renderAbles=function(){var r=this,n=this.props,i=n.triggerAblesSimultaneously,a={createElement:ee.createElement};return this.renderState={},M1e(GY(_2(this.getEnabledAbles(),["render"],i).map(function(s){var o=s.render;return o(r,a)||[]})).filter(function(s){return s}),function(s){var o=s.key;return o}).map(function(s){return s[0]})},e.prototype.updateCheckInput=function(){this.targetGesto&&(this.targetGesto.options.checkInput=this.props.checkInput)},e.prototype._getRequestStyles=function(){var r=this.getEnabledAbles().reduce(function(n,i){var a,s,o=(s=(a=i.requestStyle)===null||a===void 0?void 0:a.call(i))!==null&&s!==void 0?s:[];return vn(vn([],Ht(n),!1),Ht(o),!1)},vn([],Ht(this.props.requestStyles||[]),!1));return r},e.prototype._updateObserver=function(r){this._updateResizeObserver(r),this._updateMutationObserver(r)},e.prototype._updateEvents=function(){var r=this.targetAbles.length,n=this.controlAbles.length,i=this._dragTarget,a=!r&&this.targetGesto||this._isTargetChanged(!0);a&&(Av(this,!1),this.updateState({gestos:{}})),n||Av(this,!0),i&&r&&!this.targetGesto&&(this.targetGesto=oZ(this,i,"")),!this.controlGesto&&n&&(this.controlGesto=sZ(this,"Control"))},e.prototype._updateTargets=function(){var r=this.props;this._prevPropTarget=this._propTarget,this._prevDragTarget=this._dragTarget,this._prevOriginalDragTarget=this._originalDragTarget,this._prevDragArea=r.dragArea,this._propTarget=r.target,this._originalDragTarget=r.dragTarget||r.target,this._dragTarget=Jf(this._originalDragTarget,!0)},e.prototype._renderLines=function(){var r=this.props,n=r,i=n.zoom,a=n.hideDefaultLines,s=n.hideChildMoveableDefaultLines,o=n.parentMoveable;if(a||o&&s)return[];var u=this.getState(),h={createElement:ee.createElement};return u.renderLines.map(function(f,g){return ab(h,"",f[0],f[1],i,"render-line-".concat(g))})},e.prototype._isTargetChanged=function(r){var n=this.props,i=n.dragTarget||n.target,a=this._prevOriginalDragTarget,s=this._prevDragArea,o=n.dragArea,u=!o&&a!==i,h=(r||o)&&s!==o;return u||h||this._prevPropTarget!=this._propTarget},e.prototype._updateNativeEvents=function(){var r=this,n=this.props,i=n.dragArea?this.areaElement:this.state.target,a=this.events,s=O0(a);if(this._isTargetChanged())for(var o in a){var u=a[o];u&&u.destroy(),a[o]=null}if(i){var h=this.enabledAbles;s.forEach(function(f){var g=_2(h,[f]),b=g.length>0,v=a[f];if(!b){v&&(v.destroy(),a[f]=null);return}v||(v=new cbe(i,r,f),a[f]=v),v.setAbles(g)})}},e.prototype._checkUpdateRootContainer=function(){var r=this.props.rootContainer;!this._rootContainer&&r&&(this._rootContainer=Jf(r,!0))},e.prototype._checkUpdateViewContainer=function(){var r=this.props.viewContainer;!this._viewContainer&&r&&(this._viewContainer=Jf(r,!0));var n=this._viewContainer;n&&this._changeAbleViewClassNames(vn(vn([],Ht(this._getAbleViewClassNames()),!1),[this.isDragging()?V1e:""],!1))},e.prototype._changeAbleViewClassNames=function(r){var n=this._viewContainer,i=WY(r.filter(Boolean),function(h){return h}).map(function(h){var f=Ht(h,1),g=f[0];return g}),a=this._viewClassNames,s=SO(a,i),o=s.removed,u=s.added;o.forEach(function(h){HX(n,a[h])}),u.forEach(function(h){qX(n,i[h])}),this._viewClassNames=i},e.prototype._getAbleViewClassNames=function(){var r=this;return(this.getEnabledAbles().map(function(n){var i;return((i=n.viewClassName)===null||i===void 0?void 0:i.call(n,r))||""}).join(" ")+" ".concat(this._getAbleClassName("-view"))).split(/\s+/g)},e.prototype._getAbleClassName=function(r){var n=this;r===void 0&&(r="");var i=this.getEnabledAbles(),a=this.targetGesto,s=this.controlGesto,o=a?.isFlag()?a.getEventData():{},u=s?.isFlag()?s.getEventData():{};return i.map(function(h){var f,g,b,v=h.name,S=((f=h.className)===null||f===void 0?void 0:f.call(h,n))||"";return(!((g=o[v])===null||g===void 0)&&g.isEventStart||!((b=u[v])===null||b===void 0)&&b.isEventStart)&&(S+=" ".concat(mi("".concat(v).concat(r,"-dragging")))),S.trim()}).filter(Boolean).join(" ")},e.prototype._updateResizeObserver=function(r){var n,i=this.props,a=i.target,s=Hp(this.getControlBoxElement());if(!s.ResizeObserver||!a||!i.useResizeObserver){(n=this._reiszeObserver)===null||n===void 0||n.disconnect();return}if(!(r.target===a&&this._reiszeObserver)){var o=new s.ResizeObserver(this.checkUpdateRect);o.observe(a,{box:"border-box"}),this._reiszeObserver=o}},e.prototype._updateMutationObserver=function(r){var n=this,i,a=this.props,s=a.target,o=Hp(this.getControlBoxElement());if(!o.MutationObserver||!s||!a.useMutationObserver){(i=this._mutationObserver)===null||i===void 0||i.disconnect();return}if(!(r.target===s&&this._mutationObserver)){var u=new o.MutationObserver(function(h){var f,g;try{for(var b=W0e(h),v=b.next();!v.done;v=b.next()){var S=v.value;S.type==="attributes"&&S.attributeName==="style"&&n.checkUpdateRect()}}catch(E){f={error:E}}finally{try{v&&!v.done&&(g=b.return)&&g.call(b)}finally{if(f)throw f.error}}});u.observe(s,{attributes:!0}),this._mutationObserver=u}},e.defaultProps={dragTargetSelf:!1,target:null,dragTarget:null,container:null,rootContainer:null,origin:!0,parentMoveable:null,wrapperMoveable:null,isWrapperMounted:!1,parentPosition:null,warpSelf:!1,svgOrigin:"",dragContainer:null,useResizeObserver:!1,useMutationObserver:!1,preventDefault:!0,preventRightClick:!0,preventWheelClick:!0,linePadding:0,controlPadding:0,ables:[],pinchThreshold:20,dragArea:!1,passDragArea:!1,transformOrigin:"",className:"",zoom:1,triggerAblesSimultaneously:!1,padding:{},pinchOutside:!0,checkInput:!1,dragFocusedInput:!1,groupable:!1,hideDefaultLines:!1,cspNonce:"",translateZ:0,cssStyled:null,customStyledMap:{},props:{},stopPropagation:!1,preventClickDefault:!1,preventClickEventOnDrag:!0,flushSync:DY,firstRenderState:null,persistData:null,viewContainer:null,requestStyles:[],useAccuratePosition:!1},e})(ee.PureComponent),GO={name:"groupable",props:["defaultGroupRotate","useDefaultGroupRotate","defaultGroupOrigin","groupable","groupableProps","targetGroups","hideChildMoveableDefaultLines"],events:[],render:function(t,e){var r,n=t.props,i=n.targets||[],a=t.getState(),s=a.left,o=a.top,u=a.isPersisted,h=n.zoom||1,f=t.renderGroupRects,g=((r=n.persistData)===null||r===void 0?void 0:r.children)||[];u?i=g.map(function(){return null}):g=[];var b=Iv(t,"parentPosition",[s,o],function(S){return S.join(",")}),v=Iv(t,"requestStyles",t.getRequestChildStyles(),function(S){return S.join(",")});return t.moveables=t.moveables.slice(0,i.length),vn(vn([],Ht(i.map(function(S,E){return e.createElement(c0,{key:"moveable"+E,ref:BX(t,"moveables",E),target:S,origin:!1,requestStyles:v,cssStyled:n.cssStyled,customStyledMap:n.customStyledMap,useResizeObserver:n.useResizeObserver,useMutationObserver:n.useMutationObserver,hideChildMoveableDefaultLines:n.hideChildMoveableDefaultLines,parentMoveable:t,parentPosition:[s,o],persistData:g[E],zoom:h})})),!1),Ht(GY(f.map(function(S,E){var P=S.pos1,k=S.pos2,L=S.pos3,O=S.pos4,M=[P,k,L,O];return[[0,1],[1,3],[3,2],[2,0]].map(function(z,B){var q=Ht(z,2),W=q[0],G=q[1];return ab(e,"",vi(M[W],b),vi(M[G],b),h,"group-rect-".concat(E,"-").concat(B))})}))),!1)}},dbe=Qb("clickable",{props:["clickable"],events:["click","clickGroup"],always:!0,dragRelation:"weak",dragStart:function(){},dragControlStart:function(){},dragGroupStart:function(t,e){e.datas.inputTarget=e.inputEvent&&e.inputEvent.target},dragEnd:function(t,e){var r=t.props.target,n=e.inputEvent,i=e.inputTarget,a=t.isMoveableElement(i),s=!a&&t.controlBox.contains(i);if(!(!n||!i||e.isDrag||t.isMoveableElement(i)||s)){var o=r.contains(i);$n(t,"onClick",qi(t,e,{isDouble:e.isDouble,inputTarget:i,isTarget:r===i,moveableTarget:t.props.target,containsTarget:o}))}},dragGroupEnd:function(t,e){var r=e.inputEvent,n=e.inputTarget;if(!(!r||!n||e.isDrag||t.isMoveableElement(n)||e.datas.inputTarget===n)){var i=t.props.targets,a=i.indexOf(n),s=a>-1,o=!1;a===-1&&(a=Gd(i,function(u){return u.contains(n)}),o=a>-1),$n(t,"onClickGroup",qi(t,e,{isDouble:e.isDouble,targets:i,inputTarget:n,targetIndex:a,isTarget:s,containsTarget:o,moveableTarget:i[a]}))}},dragControlEnd:function(t,e){this.dragEnd(t,e)},dragGroupControlEnd:function(t,e){this.dragEnd(t,e)}});function Ly(t){var e=t.originalDatas.draggable;return e||(t.originalDatas.draggable={},e=t.originalDatas.draggable),zt(zt({},t),{datas:e})}var pbe=Qb("edgeDraggable",{css:[`.edge.edgeDraggable.line {
cursor: move;
}`],render:function(t,e){var r=t.props,n=r.edgeDraggable;return n?mY(e,"edgeDraggable",n,t.getState().renderPoses,r.zoom):[]},dragCondition:function(t,e){var r,n=t.props,i=(r=e.inputEvent)===null||r===void 0?void 0:r.target;return!n.edgeDraggable||!i?!1:!n.draggable&&Ol(i,mi("direction"))&&Ol(i,mi("edge"))&&Ol(i,mi("edgeDraggable"))},dragStart:function(t,e){return ic.dragStart(t,Ly(e))},drag:function(t,e){return ic.drag(t,Ly(e))},dragEnd:function(t,e){return ic.dragEnd(t,Ly(e))},dragGroupCondition:function(t,e){var r,n=t.props,i=(r=e.inputEvent)===null||r===void 0?void 0:r.target;return!n.edgeDraggable||!i?!1:!n.draggable&&Ol(i,mi("direction"))&&Ol(i,mi("line"))},dragGroupStart:function(t,e){return ic.dragGroupStart(t,Ly(e))},dragGroup:function(t,e){return ic.dragGroup(t,Ly(e))},dragGroupEnd:function(t,e){return ic.dragGroupEnd(t,Ly(e))},unset:function(t){return ic.unset(t)}}),uZ={name:"individualGroupable",props:["individualGroupable","individualGroupableProps"],events:[]},gbe=[iZ,eZ,v1e,F1e,ic,pbe,fk,B1e,j1e,e1e,H1e,W1e,$1e,ibe,nbe,lbe,GO,uZ,dbe,QY,aZ];function xz(t,e){var r=Ht(t,3),n=r[0],i=r[1],a=r[2];return(n*e[0]+i*e[1]+a)/Math.sqrt(n*n+i*i)}function w2(t,e){var r=Ht(t,2),n=r[0],i=r[1];return-n*e[0]-i*e[1]}function wz(t,e){return Math.max.apply(Math,vn([],Ht(t.map(function(r){var n=Ht(r,4),i=n[0],a=n[1],s=n[2],o=n[3];return Math.max(i[e],a[e],s[e],o[e])})),!1))}function Sz(t,e){return Math.min.apply(Math,vn([],Ht(t.map(function(r){var n=Ht(r,4),i=n[0],a=n[1],s=n[2],o=n[3];return Math.min(i[e],a[e],s[e],o[e])})),!1))}function mbe(t,e){var r,n,i,a=[0,0],s=[0,0],o=[0,0],u=[0,0],h=0,f=0;if(!t.length)return{pos1:a,pos2:s,pos3:o,pos4:u,minX:0,minY:0,maxX:0,maxY:0,width:h,height:f,rotation:e};var g=Fi(e,lc);if(g%90){var b=g/180*Math.PI,v=Math.tan(b),S=-1/v,E=[lk,WB],P=[[0,0],[0,0]],k=[lk,WB],L=[[0,0],[0,0]];t.forEach(function(Ee){Ee.forEach(function(xe){var Ne=xz([-v,1,0],xe),Oe=xz([-S,1,0],xe);E[0]>Ne&&(P[0]=xe,E[0]=Ne),E[1]<Ne&&(P[1]=xe,E[1]=Ne),k[0]>Oe&&(L[0]=xe,k[0]=Oe),k[1]<Oe&&(L[1]=xe,k[1]=Oe)})});var O=Ht(P,2),M=O[0],z=O[1],B=Ht(L,2),q=B[0],W=B[1],G=[-v,1,w2([-v,1],M)],ie=[-v,1,w2([-v,1],z)],Q=[-S,1,w2([-S,1],q)],H=[-S,1,w2([-S,1],W)];r=Ht([[G,Q],[G,H],[ie,Q],[ie,H]].map(function(Ee){var xe=Ht(Ee,2),Ne=xe[0],Oe=xe[1];return TO(Ne,Oe)[0]}),4),a=r[0],s=r[1],o=r[2],u=r[3],h=k[1]-k[0],f=E[1]-E[0]}else{var ne=Sz(t,0),oe=Sz(t,1),ce=wz(t,0),fe=wz(t,1);if(a=[ne,oe],s=[ce,oe],o=[ne,fe],u=[ce,fe],h=ce-ne,f=fe-oe,g%180){var Me=[o,a,u,s];n=Ht(Me,4),a=n[0],s=n[1],o=n[2],u=n[3],h=fe-oe,f=ce-ne}}if(g%360>180){var Me=[u,o,s,a];i=Ht(Me,4),a=i[0],s=i[1],o=i[2],u=i[3]}var me=bm([a,s,o,u]),we=me.minX,Te=me.minY,ke=me.maxX,he=me.maxY;return{pos1:a,pos2:s,pos3:o,pos4:u,width:h,height:f,minX:we,minY:Te,maxX:ke,maxY:he,rotation:e}}function cZ(t,e){var r=e.map(function(n){if(eu(n)){var i=cZ(t,n),a=i.length;return a>1?i:a===1?i[0]:null}else{var s=rh(t,function(o){var u=o.manager;return u.props.target===n});return s?(s.finded=!0,s.manager):null}}).filter(Boolean);return r.length===1&&eu(r[0])?r[0]:r}var ybe=(function(t){Jb(e,t);function e(){var r=t!==null&&t.apply(this,arguments)||this;return r.differ=new KX,r.moveables=[],r.transformOrigin="50% 50%",r.renderGroupRects=[],r._targetGroups=[],r._hasFirstTargets=!1,r}return e.prototype.componentDidMount=function(){t.prototype.componentDidMount.call(this)},e.prototype.checkUpdate=function(){this._isPropTargetChanged=!1,this.updateAbles()},e.prototype.getTargets=function(){return this.props.targets},e.prototype.updateRect=function(r,n,i){var a;i===void 0&&(i=!0);var s=this.state;if(!this.controlBox||s.isPersisted)return;s0(!0),this.moveables.forEach(function(De){De.updateRect(r,!1,!1)});var o=this.props,u=this.moveables,h=s.target||o.target,f=u.map(function(De){return{finded:!1,manager:De}}),g=this.props.targetGroups||[],b=cZ(f,g),v=o.useDefaultGroupRotate;b.push.apply(b,vn([],Ht(f.filter(function(De){var it=De.finded;return!it}).map(function(De){var it=De.manager;return it})),!1));var S=[],E=!n||r!==""&&o.updateGroup,P=o.defaultGroupRotate||0;if(!this._hasFirstTargets){var k=(a=o.persistData)===null||a===void 0?void 0:a.rotation;k!=null&&(P=k)}function L(De,it,Ye){var rt=De.map(function(pr){if(eu(pr)){var vt=L(pr,it),yr=[vt.pos1,vt.pos2,vt.pos3,vt.pos4];return S.push(vt),{poses:yr,rotation:vt.rotation}}else return{poses:Mh(pr.state),rotation:pr.getRotation()}}),Ie=rt.map(function(pr){var vt=pr.rotation;return vt}),Mt=0,at=Ie[0],je=Ie.every(function(pr){return Math.abs(at-pr)<.1});E?Mt=!v&&je?at:P:Mt=!v&&!Ye&&je?at:it;var Xt=rt.map(function(pr){var vt=pr.poses;return vt}),Yt=mbe(Xt,Mt);return Yt}var O=L(b,this.rotation,!0);E&&(this.rotation=O.rotation,this.transformOrigin=o.defaultGroupOrigin||"50% 50%",this.scale=[1,1]),this._targetGroups=g,this.renderGroupRects=S;var M=this.transformOrigin,z=this.rotation,B=this.scale,q=O.width,W=O.height,G=O.minX,ie=O.minY,Q=D1e([[0,0],[q,0],[0,W],[q,W]],$O(M,q,W),this.rotation/180*Math.PI),H=bm(Q.result),ne=H.minX,oe=H.minY,ce=" rotate(".concat(z,"deg)")+" scale(".concat(ac(B[0]),", ").concat(ac(B[1]),")"),fe="translate(".concat(-ne,"px, ").concat(-oe,"px)").concat(ce);this.controlBox.style.transform="translate3d(".concat(G,"px, ").concat(ie,"px, ").concat(this.props.translateZ||0,")"),h.style.cssText+="left:0px;top:0px;"+"transform-origin:".concat(M,";")+"width:".concat(q,"px;height:").concat(W,"px;")+"transform: ".concat(fe),s.width=q,s.height=W;var Me=this.getContainer(),me=_k(this.controlBox,h,this.controlBox,this.getContainer(),this._rootContainer||Me,[]),we=[me.left,me.top],Te=Ht(Mh(me),4),ke=Te[0],he=Te[1],Ee=Te[2],xe=Te[3],Ne=bm([ke,he,Ee,xe]),Oe=[Ne.minX,Ne.minY],$e=ac(B[0]*B[1]);me.pos1=vi(ke,Oe),me.pos2=vi(he,Oe),me.pos3=vi(Ee,Oe),me.pos4=vi(xe,Oe),me.left=G-me.left+Oe[0],me.top=ie-me.top+Oe[1],me.origin=vi(Aa(we,me.origin),Oe),me.beforeOrigin=vi(Aa(we,me.beforeOrigin),Oe),me.originalBeforeOrigin=Aa(we,me.originalBeforeOrigin),me.transformOrigin=vi(Aa(we,me.transformOrigin),Oe),h.style.transform="translate(".concat(-ne-Oe[0],"px, ").concat(-oe-Oe[1],"px)")+ce,s0(),this.updateState(zt(zt({},me),{posDelta:Oe,direction:$e,beforeDirection:$e}),i)},e.prototype.getRect=function(){return zt(zt({},t.prototype.getRect.call(this)),{children:this.moveables.map(function(r){return r.getRect()})})},e.prototype.triggerEvent=function(r,n,i){if(i||r.indexOf("Group")>-1)return t.prototype.triggerEvent.call(this,r,n);this._emitter.trigger(r,n)},e.prototype.getRequestChildStyles=function(){var r=this.getEnabledAbles().reduce(function(n,i){var a,s,o=(s=(a=i.requestChildStyle)===null||a===void 0?void 0:a.call(i))!==null&&s!==void 0?s:[];return vn(vn([],Ht(n),!1),Ht(o),!1)},[]);return r},e.prototype.getMoveables=function(){return vn([],Ht(this.moveables),!1)},e.prototype.updateAbles=function(){t.prototype.updateAbles.call(this,vn(vn([],Ht(this.props.ables),!1),[GO],!1),"Group")},e.prototype._updateTargets=function(){t.prototype._updateTargets.call(this),this._originalDragTarget=this.props.dragTarget||this.areaElement,this._dragTarget=Jf(this._originalDragTarget,!0)},e.prototype._updateEvents=function(){var r=this.state,n=this.props,i=this._prevDragTarget,a=n.dragTarget||this.areaElement,s=n.targets,o=this.differ.update(s),u=o.added,h=o.changed,f=o.removed,g=u.length||f.length;(g||this._prevOriginalDragTarget!==this._originalDragTarget)&&(Av(this,!1),Av(this,!0),this.updateState({gestos:{}})),i!==a&&(r.target=null),r.target||(r.target=this.areaElement,this.controlBox.style.display="block"),r.target&&(this.targetGesto||(this.targetGesto=oZ(this,this._dragTarget,"Group")),this.controlGesto||(this.controlGesto=sZ(this,"GroupControl")));var b=!yk(r.container,n.container);b&&(r.container=n.container),(b||g||this.transformOrigin!==(n.defaultGroupOrigin||"50% 50%")||h.length||s.length&&!ZY(this._targetGroups,n.targetGroups||[]))&&(this.updateRect(),this._hasFirstTargets=!0),this._isPropTargetChanged=!!g},e.prototype._updateObserver=function(){},e.defaultProps=zt(zt({},c0.defaultProps),{transformOrigin:["50%","50%"],groupable:!0,dragArea:!0,keepRatio:!0,targets:[],defaultGroupRotate:0,defaultGroupOrigin:"50% 50%"}),e})(c0),vbe=(function(t){Jb(e,t);function e(){var r=t!==null&&t.apply(this,arguments)||this;return r.moveables=[],r}return e.prototype.render=function(){var r=this,n,i=this.props,a=i.cspNonce,s=i.cssStyled,o=i.persistData,u=i.targets||[],h=u.length,f=this.isUnmounted||!h,g=(n=o?.children)!==null&&n!==void 0?n:[];return f&&!h&&g.length?u=g.map(function(){return null}):f||(g=[]),ee.createElement(s,{cspNonce:a,ref:om(this,"controlBox"),className:mi("control-box")},u.map(function(b,v){var S,E,P=(E=(S=i.individualGroupableProps)===null||S===void 0?void 0:S.call(i,b,v))!==null&&E!==void 0?E:{};return ee.createElement(c0,zt({key:"moveable"+v,ref:BX(r,"moveables",v)},i,P,{target:b,wrapperMoveable:r,isWrapperMounted:r.isMoveableMounted,persistData:g[v]}))}))},e.prototype.componentDidMount=function(){},e.prototype.componentDidUpdate=function(){},e.prototype.getTargets=function(){return this.props.targets},e.prototype.updateRect=function(r,n,i){i===void 0&&(i=!0),s0(!0),this.moveables.forEach(function(a){a.updateRect(r,n,i)}),s0()},e.prototype.getRect=function(){return zt(zt({},t.prototype.getRect.call(this)),{children:this.moveables.map(function(r){return r.getRect()})})},e.prototype.request=function(r,n,i){n===void 0&&(n={});var a=this.moveables.map(function(u){return u.request(r,zt(zt({},n),{isInstant:!1}),!1)}),s=i||n.isInstant,o={request:function(u){return a.forEach(function(h){return h.request(u)}),this},requestEnd:function(){return a.forEach(function(u){return u.requestEnd()}),this}};return s?o.request(n).requestEnd():o},e.prototype.dragStart=function(r,n){n===void 0&&(n=r.target);var i=n,a=rh(this.moveables,function(s){var o=s.getTargets()[0],u=s.getControlBoxElement(),h=s.getDragElement();return!o||!h?!1:h===i||h.contains(i)||h!==o&&o===i||o.contains(i)||u===i||u.contains(i)});return a&&a.dragStart(r,n),this},e.prototype.hitTest=function(){return 0},e.prototype.isInside=function(){return!1},e.prototype.isDragging=function(){return!1},e.prototype.getDragElement=function(){return null},e.prototype.getMoveables=function(){return vn([],Ht(this.moveables),!1)},e.prototype.updateRenderPoses=function(){},e.prototype.checkUpdate=function(){},e.prototype.triggerEvent=function(){},e.prototype.updateAbles=function(){},e.prototype._updateEvents=function(){},e.prototype._updateObserver=function(){},e})(c0);function hZ(t,e){var r=[];return t.forEach(function(n){if(n){if(ep(n)){e[n]&&r.push.apply(r,vn([],Ht(e[n]),!1));return}eu(n)?r.push.apply(r,vn([],Ht(hZ(n,e)),!1)):r.push(n)}}),r}function fZ(t,e){var r=[];return t.forEach(function(n){if(n){if(ep(n)){e[n]&&r.push.apply(r,vn([],Ht(e[n]),!1));return}eu(n)?r.push(fZ(n,e)):r.push(n)}}),r}function dZ(t,e){return t.length!==e.length||t.some(function(r,n){var i=e[n];return!r&&!i?!1:r!=i?eu(r)&&eu(i)?dZ(r,i):!0:!1})}var _be=(function(t){Jb(e,t);function e(){var r=t!==null&&t.apply(this,arguments)||this;return r.refTargets=[],r.selectorMap={},r._differ=new KX,r._elementTargets=[],r._tmpRefTargets=[],r._tmpSelectorMap={},r._onChangeTargets=null,r}return e.makeStyled=function(){var r={},n=this.getTotalAbles();n.forEach(function(a){var s=a.css;s&&s.forEach(function(o){r[o]=!0})});var i=O0(r).join(`
`);this.defaultStyled=tY("div",Fve(AO,n_e+i))},e.getTotalAbles=function(){return vn([eZ,GO,uZ,QY],Ht(this.defaultAbles),!1)},e.prototype.render=function(){var r,n=this.constructor;n.defaultStyled||n.makeStyled();var i=this.props,a=i.ables,s=i.props,o=q0e(i,["ables","props"]),u=Ht(this._updateRefs(!0),2),h=u[0],f=u[1],g=hZ(h,f),b=g.length>1,v=n.getTotalAbles(),S=vn(vn([],Ht(v),!1),Ht(a||[]),!1),E=zt(zt(zt({},o),s||{}),{ables:S,cssStyled:n.defaultStyled,customStyledMap:n.customStyledMap});this._elementTargets=g;var P=null,k=this.moveable,L=o.persistData;if(L?.children&&(b=!0),o.individualGroupable)return ee.createElement(vbe,zt({key:"individual-group",ref:om(this,"moveable")},E,{target:null,targets:g}));if(b){var O=fZ(h,f);if(k&&!k.props.groupable&&!k.props.individualGroupable){var M=k.props.target;M&&g.indexOf(M)>-1&&(P=zt({},k.state))}return ee.createElement(ybe,zt({key:"group",ref:om(this,"moveable")},E,(r=o.groupableProps)!==null&&r!==void 0?r:{},{target:null,targets:g,targetGroups:O,firstRenderState:P}))}else{var z=g[0];if(k&&(k.props.groupable||k.props.individualGroupable)){var B=k.moveables||[],q=rh(B,function(W){return W.props.target===z});q&&(P=zt({},q.state))}return ee.createElement(c0,zt({key:"single",ref:om(this,"moveable")},E,{target:z,firstRenderState:P}))}},e.prototype.componentDidMount=function(){this._checkChangeTargets()},e.prototype.componentDidUpdate=function(){this._checkChangeTargets()},e.prototype.componentWillUnmount=function(){this.selectorMap={},this.refTargets=[]},e.prototype.getTargets=function(){var r,n;return(n=(r=this.moveable)===null||r===void 0?void 0:r.getTargets())!==null&&n!==void 0?n:[]},e.prototype.updateSelectors=function(){this.selectorMap={},this._updateRefs(),this.forceUpdate()},e.prototype.waitToChangeTarget=function(){var r=this,n;return this._onChangeTargets=function(){r._onChangeTargets=null,n()},new Promise(function(i){n=i})},e.prototype.waitToChangeTargets=function(){return this.waitToChangeTarget()},e.prototype.getManager=function(){return this.moveable},e.prototype.getMoveables=function(){return this.moveable.getMoveables()},e.prototype.getDragElement=function(){return this.moveable.getDragElement()},e.prototype._updateRefs=function(r){var n=this.refTargets,i=VO(this.props.target||this.props.targets),a=typeof document<"u",s=dZ(n,i),o=this.selectorMap,u={};return this.refTargets.forEach(function h(f){if(ep(f)){var g=o[f];g?u[f]=o[f]:a&&(s=!0,u[f]=[].slice.call(document.querySelectorAll(f)))}else eu(f)&&f.forEach(h)}),this._tmpRefTargets=i,this._tmpSelectorMap=u,[i,u,!r&&s]},e.prototype._checkChangeTargets=function(){var r,n,i;this.refTargets=this._tmpRefTargets,this.selectorMap=this._tmpSelectorMap;var a=this._differ.update(this._elementTargets),s=a.added,o=a.removed,u=s.length||o.length;u&&((n=(r=this.props).onChangeTargets)===null||n===void 0||n.call(r,{moveable:this.moveable,targets:this._elementTargets}),(i=this._onChangeTargets)===null||i===void 0||i.call(this));var h=Ht(this._updateRefs(),3),f=h[0],g=h[1],b=h[2];this.refTargets=f,this.selectorMap=g,b&&this.forceUpdate()},e.defaultAbles=[],e.customStyledMap={},e.defaultStyled=null,H0e([Bve(o_e)],e.prototype,"moveable",void 0),e})(ee.PureComponent),bbe=(function(t){Jb(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.defaultAbles=gbe,e})(_be),zu=63710088e-1,pZ={centimeters:zu*100,centimetres:zu*100,degrees:360/(2*Math.PI),feet:zu*3.28084,inches:zu*39.37,kilometers:zu/1e3,kilometres:zu/1e3,meters:zu,metres:zu,miles:zu/1609.344,millimeters:zu*1e3,millimetres:zu*1e3,nauticalmiles:zu/1852,radians:1,yards:zu*1.0936};function wm(t,e,r={}){const n={type:"Feature"};return(r.id===0||r.id)&&(n.id=r.id),r.bbox&&(n.bbox=r.bbox),n.properties=e||{},n.geometry=t,n}function Rh(t,e,r={}){if(!t)throw new Error("coordinates is required");if(!Array.isArray(t))throw new Error("coordinates must be an Array");if(t.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!Ez(t[0])||!Ez(t[1]))throw new Error("coordinates must contain numbers");return wm({type:"Point",coordinates:t},e,r)}function gT(t,e,r={}){for(const i of t){if(i.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");if(i[i.length-1].length!==i[0].length)throw new Error("First and last Position are not equivalent.");for(let a=0;a<i[i.length-1].length;a++)if(i[i.length-1][a]!==i[0][a])throw new Error("First and last Position are not equivalent.")}return wm({type:"Polygon",coordinates:t},e,r)}function gu(t,e,r={}){if(t.length<2)throw new Error("coordinates must be an array of two or more positions");return wm({type:"LineString",coordinates:t},e,r)}function Xd(t,e={}){const r={type:"FeatureCollection"};return e.id&&(r.id=e.id),e.bbox&&(r.bbox=e.bbox),r.features=t,r}function xbe(t,e,r={}){return wm({type:"MultiLineString",coordinates:t},e,r)}function gZ(t,e="kilometers"){const r=pZ[e];if(!r)throw new Error(e+" units is invalid");return t*r}function XO(t,e="kilometers"){const r=pZ[e];if(!r)throw new Error(e+" units is invalid");return t/r}function wbe(t,e){return fS(XO(t,e))}function fS(t){return t%(2*Math.PI)*180/Math.PI}function ef(t){return t%360*Math.PI/180}function Ez(t){return!isNaN(t)&&t!==null&&!Array.isArray(t)}function YO(t){return t!==null&&typeof t=="object"&&!Array.isArray(t)}function tg(t){if(!t)throw new Error("coord is required");if(!Array.isArray(t)){if(t.type==="Feature"&&t.geometry!==null&&t.geometry.type==="Point")return[...t.geometry.coordinates];if(t.type==="Point")return[...t.coordinates]}if(Array.isArray(t)&&t.length>=2&&!Array.isArray(t[0])&&!Array.isArray(t[1]))return[...t];throw new Error("coord must be GeoJSON Point or an Array of numbers")}function mZ(t){if(Array.isArray(t))return t;if(t.type==="Feature"){if(t.geometry!==null)return t.geometry.coordinates}else if(t.coordinates)return t.coordinates;throw new Error("coords must be GeoJSON Feature, Geometry Object or an Array")}function sb(t){return t.type==="Feature"?t.geometry:t}function yZ(t,e){return t.type==="FeatureCollection"?"FeatureCollection":t.type==="GeometryCollection"?"GeometryCollection":t.type==="Feature"&&t.geometry!==null?t.geometry.type:t.type}function lb(t,e,r={}){if(r.final===!0)return Sbe(t,e);const n=tg(t),i=tg(e),a=ef(n[0]),s=ef(i[0]),o=ef(n[1]),u=ef(i[1]),h=Math.sin(s-a)*Math.cos(u),f=Math.cos(o)*Math.sin(u)-Math.sin(o)*Math.cos(u)*Math.cos(s-a);return fS(Math.atan2(h,f))}function Sbe(t,e){let r=lb(e,t);return r=(r+180)%360,r}function h0(t,e,r,n={}){const i=tg(t),a=ef(i[0]),s=ef(i[1]),o=ef(r),u=XO(e,n.units),h=Math.asin(Math.sin(s)*Math.cos(u)+Math.cos(s)*Math.sin(u)*Math.cos(o)),f=a+Math.atan2(Math.sin(o)*Math.sin(u)*Math.cos(s),Math.cos(u)-Math.sin(s)*Math.sin(h)),g=fS(f),b=fS(h);return Rh([g,b],n.properties)}function mT(t,e,r={}){var n=tg(t),i=tg(e),a=ef(i[1]-n[1]),s=ef(i[0]-n[0]),o=ef(n[1]),u=ef(i[1]),h=Math.pow(Math.sin(a/2),2)+Math.pow(Math.sin(s/2),2)*Math.cos(o)*Math.cos(u);return gZ(2*Math.atan2(Math.sqrt(h),Math.sqrt(1-h)),r.units)}function Ebe(t,e,r={}){const i=sb(t).coordinates;let a=0;for(let s=0;s<i.length&&!(e>=a&&s===i.length-1);s++)if(a>=e){const o=e-a;if(o){const u=lb(i[s],i[s-1])-180;return h0(i[s],o,u,r)}else return Rh(i[s])}else a+=mT(i[s],i[s+1],r);return Rh(i[i.length-1])}function F0(t,e,r){if(t!==null)for(var n,i,a,s,o,u,h,f=0,g=0,b,v=t.type,S=v==="FeatureCollection",E=v==="Feature",P=S?t.features.length:1,k=0;k<P;k++){h=S?t.features[k].geometry:E?t.geometry:t,b=h?h.type==="GeometryCollection":!1,o=b?h.geometries.length:1;for(var L=0;L<o;L++){var O=0,M=0;if(s=b?h.geometries[L]:h,s!==null){u=s.coordinates;var z=s.type;switch(f=r&&(z==="Polygon"||z==="MultiPolygon")?1:0,z){case null:break;case"Point":if(e(u,g,k,O,M)===!1)return!1;g++,O++;break;case"LineString":case"MultiPoint":for(n=0;n<u.length;n++){if(e(u[n],g,k,O,M)===!1)return!1;g++,z==="MultiPoint"&&O++}z==="LineString"&&O++;break;case"Polygon":case"MultiLineString":for(n=0;n<u.length;n++){for(i=0;i<u[n].length-f;i++){if(e(u[n][i],g,k,O,M)===!1)return!1;g++}z==="MultiLineString"&&O++,z==="Polygon"&&M++}z==="Polygon"&&O++;break;case"MultiPolygon":for(n=0;n<u.length;n++){for(M=0,i=0;i<u[n].length;i++){for(a=0;a<u[n][i].length-f;a++){if(e(u[n][i][a],g,k,O,M)===!1)return!1;g++}M++}O++}break;case"GeometryCollection":for(n=0;n<s.geometries.length;n++)if(F0(s.geometries[n],e,r)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function Tz(t,e){if(t.type==="Feature")e(t,0);else if(t.type==="FeatureCollection")for(var r=0;r<t.features.length&&e(t.features[r],r)!==!1;r++);}function yT(t,e){var r,n,i,a,s,o,u,h,f,g,b=0,v=t.type==="FeatureCollection",S=t.type==="Feature",E=v?t.features.length:1;for(r=0;r<E;r++){for(o=v?t.features[r].geometry:S?t.geometry:t,h=v?t.features[r].properties:S?t.properties:{},f=v?t.features[r].bbox:S?t.bbox:void 0,g=v?t.features[r].id:S?t.id:void 0,u=o?o.type==="GeometryCollection":!1,s=u?o.geometries.length:1,i=0;i<s;i++){if(a=u?o.geometries[i]:o,a===null){if(e(null,b,h,f,g)===!1)return!1;continue}switch(a.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":{if(e(a,b,h,f,g)===!1)return!1;break}case"GeometryCollection":{for(n=0;n<a.geometries.length;n++)if(e(a.geometries[n],b,h,f,g)===!1)return!1;break}default:throw new Error("Unknown Geometry Type")}}b++}}function Tbe(t,e,r){var n=r;return yT(t,function(i,a,s,o,u){n=e(n,i,a,s,o,u)}),n}function ZO(t,e){yT(t,function(r,n,i,a,s){var o=r===null?null:r.type;switch(o){case null:case"Point":case"LineString":case"Polygon":return e(wm(r,i,{bbox:a,id:s}),n,0)===!1?!1:void 0}var u;switch(o){case"MultiPoint":u="Point";break;case"MultiLineString":u="LineString";break;case"MultiPolygon":u="Polygon";break}for(var h=0;h<r.coordinates.length;h++){var f=r.coordinates[h],g={type:u,coordinates:f};if(e(wm(g,i),n,h)===!1)return!1}})}function Cbe(t,e){ZO(t,function(r,n,i){var a=0;if(r.geometry){var s=r.geometry.type;if(!(s==="Point"||s==="MultiPoint")){var o,u=0,h=0,f=0;if(F0(r,function(g,b,v,S,E){if(o===void 0||n>u||S>h||E>f){o=g,u=n,h=S,f=E,a=0;return}var P=gu([o,g],r.properties);if(e(P,n,i,E,a)===!1)return!1;a++,o=g})===!1)return!1}}})}function Abe(t,e,r){var n=r,i=!1;return Cbe(t,function(a,s,o,u,h){i===!1&&r===void 0?n=a:n=e(n,a,s,o,u,h),i=!0}),n}function Ibe(t){return Tbe(t,(e,r)=>e+Pbe(r),0)}function Pbe(t){let e=0,r;switch(t.type){case"Polygon":return Cz(t.coordinates);case"MultiPolygon":for(r=0;r<t.coordinates.length;r++)e+=Cz(t.coordinates[r]);return e;case"Point":case"MultiPoint":case"LineString":case"MultiLineString":return 0}return 0}function Cz(t){let e=0;if(t&&t.length>0){e+=Math.abs(Az(t[0]));for(let r=1;r<t.length;r++)e-=Math.abs(Az(t[r]))}return e}var kbe=zu*zu/2,Z3=Math.PI/180;function Az(t){const e=t.length-1;if(e<=2)return 0;let r=0,n=0;for(;n<e;){const i=t[n],a=t[n+1===e?0:n+1],s=t[n+2>=e?(n+2)%e:n+2],o=i[0]*Z3,u=a[1]*Z3,h=s[0]*Z3;r+=(h-o)*Math.sin(u),n++}return r*kbe}function ih(t,e={}){if(t.bbox!=null&&e.recompute!==!0)return t.bbox;const r=[1/0,1/0,-1/0,-1/0];return F0(t,n=>{r[0]>n[0]&&(r[0]=n[0]),r[1]>n[1]&&(r[1]=n[1]),r[2]<n[0]&&(r[2]=n[0]),r[3]<n[1]&&(r[3]=n[1])}),r}function Iz(t,e={}){const r=Number(t[0]),n=Number(t[1]),i=Number(t[2]),a=Number(t[3]);if(t.length===6)throw new Error("@turf/bbox-polygon does not support BBox with 6 positions");const s=[r,n];return gT([[s,[i,n],[i,a],[r,a],s]],e.properties,{bbox:t,id:e.id})}const Ud=11102230246251565e-32,Nu=134217729,Mbe=(3+8*Ud)*Ud;function K3(t,e,r,n,i){let a,s,o,u,h=e[0],f=n[0],g=0,b=0;f>h==f>-h?(a=h,h=e[++g]):(a=f,f=n[++b]);let v=0;if(g<t&&b<r)for(f>h==f>-h?(s=h+a,o=a-(s-h),h=e[++g]):(s=f+a,o=a-(s-f),f=n[++b]),a=s,o!==0&&(i[v++]=o);g<t&&b<r;)f>h==f>-h?(s=a+h,u=s-a,o=a-(s-u)+(h-u),h=e[++g]):(s=a+f,u=s-a,o=a-(s-u)+(f-u),f=n[++b]),a=s,o!==0&&(i[v++]=o);for(;g<t;)s=a+h,u=s-a,o=a-(s-u)+(h-u),h=e[++g],a=s,o!==0&&(i[v++]=o);for(;b<r;)s=a+f,u=s-a,o=a-(s-u)+(f-u),f=n[++b],a=s,o!==0&&(i[v++]=o);return(a!==0||v===0)&&(i[v++]=a),v}function Rbe(t,e){let r=e[0];for(let n=1;n<t;n++)r+=e[n];return r}function rx(t){return new Float64Array(t)}const Obe=(3+16*Ud)*Ud,Lbe=(2+12*Ud)*Ud,Nbe=(9+64*Ud)*Ud*Ud,Ny=rx(4),Pz=rx(8),kz=rx(12),Mz=rx(16),tc=rx(4);function Dbe(t,e,r,n,i,a,s){let o,u,h,f,g,b,v,S,E,P,k,L,O,M,z,B,q,W;const G=t-i,ie=r-i,Q=e-a,H=n-a;M=G*H,b=Nu*G,v=b-(b-G),S=G-v,b=Nu*H,E=b-(b-H),P=H-E,z=S*P-(M-v*E-S*E-v*P),B=Q*ie,b=Nu*Q,v=b-(b-Q),S=Q-v,b=Nu*ie,E=b-(b-ie),P=ie-E,q=S*P-(B-v*E-S*E-v*P),k=z-q,g=z-k,Ny[0]=z-(k+g)+(g-q),L=M+k,g=L-M,O=M-(L-g)+(k-g),k=O-B,g=O-k,Ny[1]=O-(k+g)+(g-B),W=L+k,g=W-L,Ny[2]=L-(W-g)+(k-g),Ny[3]=W;let ne=Rbe(4,Ny),oe=Lbe*s;if(ne>=oe||-ne>=oe||(g=t-G,o=t-(G+g)+(g-i),g=r-ie,h=r-(ie+g)+(g-i),g=e-Q,u=e-(Q+g)+(g-a),g=n-H,f=n-(H+g)+(g-a),o===0&&u===0&&h===0&&f===0)||(oe=Nbe*s+Mbe*Math.abs(ne),ne+=G*f+H*o-(Q*h+ie*u),ne>=oe||-ne>=oe))return ne;M=o*H,b=Nu*o,v=b-(b-o),S=o-v,b=Nu*H,E=b-(b-H),P=H-E,z=S*P-(M-v*E-S*E-v*P),B=u*ie,b=Nu*u,v=b-(b-u),S=u-v,b=Nu*ie,E=b-(b-ie),P=ie-E,q=S*P-(B-v*E-S*E-v*P),k=z-q,g=z-k,tc[0]=z-(k+g)+(g-q),L=M+k,g=L-M,O=M-(L-g)+(k-g),k=O-B,g=O-k,tc[1]=O-(k+g)+(g-B),W=L+k,g=W-L,tc[2]=L-(W-g)+(k-g),tc[3]=W;const ce=K3(4,Ny,4,tc,Pz);M=G*f,b=Nu*G,v=b-(b-G),S=G-v,b=Nu*f,E=b-(b-f),P=f-E,z=S*P-(M-v*E-S*E-v*P),B=Q*h,b=Nu*Q,v=b-(b-Q),S=Q-v,b=Nu*h,E=b-(b-h),P=h-E,q=S*P-(B-v*E-S*E-v*P),k=z-q,g=z-k,tc[0]=z-(k+g)+(g-q),L=M+k,g=L-M,O=M-(L-g)+(k-g),k=O-B,g=O-k,tc[1]=O-(k+g)+(g-B),W=L+k,g=W-L,tc[2]=L-(W-g)+(k-g),tc[3]=W;const fe=K3(ce,Pz,4,tc,kz);M=o*f,b=Nu*o,v=b-(b-o),S=o-v,b=Nu*f,E=b-(b-f),P=f-E,z=S*P-(M-v*E-S*E-v*P),B=u*h,b=Nu*u,v=b-(b-u),S=u-v,b=Nu*h,E=b-(b-h),P=h-E,q=S*P-(B-v*E-S*E-v*P),k=z-q,g=z-k,tc[0]=z-(k+g)+(g-q),L=M+k,g=L-M,O=M-(L-g)+(k-g),k=O-B,g=O-k,tc[1]=O-(k+g)+(g-B),W=L+k,g=W-L,tc[2]=L-(W-g)+(k-g),tc[3]=W;const Me=K3(fe,kz,4,tc,Mz);return Mz[Me-1]}function Fbe(t,e,r,n,i,a){const s=(e-a)*(r-i),o=(t-i)*(n-a),u=s-o,h=Math.abs(s+o);return Math.abs(u)>=Obe*h?u:-Dbe(t,e,r,n,i,a,h)}function Bbe(t,e){var r,n,i=0,a,s,o,u,h,f,g,b=t[0],v=t[1],S=e.length;for(r=0;r<S;r++){n=0;var E=e[r],P=E.length-1;if(f=E[0],f[0]!==E[P][0]&&f[1]!==E[P][1])throw new Error("First and last coordinates in a ring must be the same");for(s=f[0]-b,o=f[1]-v,n;n<P;n++){if(g=E[n+1],u=g[0]-b,h=g[1]-v,o===0&&h===0){if(u<=0&&s>=0||s<=0&&u>=0)return 0}else if(h>=0&&o<=0||h<=0&&o>=0){if(a=Fbe(s,u,o,h,0,0),a===0)return 0;(a>0&&h>0&&o<=0||a<0&&h<=0&&o>0)&&i++}f=g,o=h,s=u}}return i%2!==0}function vT(t,e,r={}){if(!t)throw new Error("point is required");if(!e)throw new Error("polygon is required");const n=tg(t),i=sb(e),a=i.type,s=e.bbox;let o=i.coordinates;if(s&&zbe(n,s)===!1)return!1;a==="Polygon"&&(o=[o]);let u=!1;for(var h=0;h<o.length;++h){const f=Bbe(n,o[h]);if(f===0)return!r.ignoreBoundary;f&&(u=!0)}return u}function zbe(t,e){return e[0]<=t[0]&&e[1]<=t[1]&&e[2]>=t[0]&&e[3]>=t[1]}function ub(t,e,r={}){const n=tg(t),i=mZ(e);for(let a=0;a<i.length-1;a++){let s=!1;if(r.ignoreEndVertices&&(a===0&&(s="start"),a===i.length-2&&(s="end"),a===0&&a+1===i.length-1&&(s="both")),jbe(i[a],i[a+1],n,s,typeof r.epsilon>"u"?null:r.epsilon))return!0}return!1}function jbe(t,e,r,n,i){const a=r[0],s=r[1],o=t[0],u=t[1],h=e[0],f=e[1],g=r[0]-o,b=r[1]-u,v=h-o,S=f-u,E=g*S-b*v;if(i!==null){if(Math.abs(E)>i)return!1}else if(E!==0)return!1;if(Math.abs(v)===Math.abs(S)&&Math.abs(v)===0)return n?!1:r[0]===t[0]&&r[1]===t[1];if(n){if(n==="start")return Math.abs(v)>=Math.abs(S)?v>0?o<a&&a<=h:h<=a&&a<o:S>0?u<s&&s<=f:f<=s&&s<u;if(n==="end")return Math.abs(v)>=Math.abs(S)?v>0?o<=a&&a<h:h<a&&a<=o:S>0?u<=s&&s<f:f<s&&s<=u;if(n==="both")return Math.abs(v)>=Math.abs(S)?v>0?o<a&&a<h:h<a&&a<o:S>0?u<s&&s<f:f<s&&s<u}else return Math.abs(v)>=Math.abs(S)?v>0?o<=a&&a<=h:h<=a&&a<=o:S>0?u<=s&&s<=f:f<=s&&s<=u;return!1}function Ube(t,e){const r=sb(t),n=sb(e),i=r.type,a=n.type,s=r.coordinates,o=n.coordinates;switch(i){case"Point":switch(a){case"Point":return KO(s,o);default:throw new Error("feature2 "+a+" geometry not supported")}case"MultiPoint":switch(a){case"Point":return $be(r,n);case"MultiPoint":return qbe(r,n);default:throw new Error("feature2 "+a+" geometry not supported")}case"LineString":switch(a){case"Point":return ub(n,r,{ignoreEndVertices:!0});case"LineString":return Gbe(r,n);case"MultiPoint":return Hbe(r,n);default:throw new Error("feature2 "+a+" geometry not supported")}case"Polygon":switch(a){case"Point":return vT(n,r,{ignoreBoundary:!0});case"LineString":return Xbe(r,n);case"Polygon":return vZ(r,n);case"MultiPoint":return Wbe(r,n);default:throw new Error("feature2 "+a+" geometry not supported")}case"MultiPolygon":switch(a){case"Polygon":return Vbe(r,n);default:throw new Error("feature2 "+a+" geometry not supported")}default:throw new Error("feature1 "+i+" geometry not supported")}}function Vbe(t,e){return t.coordinates.some(r=>vZ({type:"Polygon",coordinates:r},e))}function $be(t,e){let r,n=!1;for(r=0;r<t.coordinates.length;r++)if(KO(t.coordinates[r],e.coordinates)){n=!0;break}return n}function qbe(t,e){for(const r of e.coordinates){let n=!1;for(const i of t.coordinates)if(KO(r,i)){n=!0;break}if(!n)return!1}return!0}function Hbe(t,e){let r=!1;for(const n of e.coordinates)if(ub(n,t,{ignoreEndVertices:!0})&&(r=!0),!ub(n,t))return!1;return!!r}function Wbe(t,e){for(const r of e.coordinates)if(!vT(r,t,{ignoreBoundary:!0}))return!1;return!0}function Gbe(t,e){let r=!1;for(const n of e.coordinates)if(ub({type:"Point",coordinates:n},t,{ignoreEndVertices:!0})&&(r=!0),!ub({type:"Point",coordinates:n},t,{ignoreEndVertices:!1}))return!1;return r}function Xbe(t,e){let r=!1,n=0;const i=ih(t),a=ih(e);if(!_Z(i,a))return!1;for(n;n<e.coordinates.length-1;n++){const s=Ybe(e.coordinates[n],e.coordinates[n+1]);if(vT({type:"Point",coordinates:s},t,{ignoreBoundary:!0})){r=!0;break}}return r}function vZ(t,e){if(t.type==="Feature"&&t.geometry===null||e.type==="Feature"&&e.geometry===null)return!1;const r=ih(t),n=ih(e);if(!_Z(r,n))return!1;const i=sb(e).coordinates;for(const a of i)for(const s of a)if(!vT(s,t))return!1;return!0}function _Z(t,e){return!(t[0]>e[0]||t[2]<e[2]||t[1]>e[1]||t[3]<e[3])}function KO(t,e){return t[0]===e[0]&&t[1]===e[1]}function Ybe(t,e){return[(t[0]+e[0])/2,(t[1]+e[1])/2]}function Zbe(t,e={}){const r=ih(t),n=(r[0]+r[2])/2,i=(r[1]+r[3])/2;return Rh([n,i],e.properties,e)}var vw={exports:{}},Kbe=vw.exports,Rz;function Jbe(){return Rz||(Rz=1,(function(t,e){(function(r,n){t.exports=n()})(Kbe,(function(){function r(A,y){(y==null||y>A.length)&&(y=A.length);for(var _=0,I=Array(y);_<y;_++)I[_]=A[_];return I}function n(A,y,_){return y=f(y),(function(I,U){if(U&&(typeof U=="object"||typeof U=="function"))return U;if(U!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return(function(re){if(re===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return re})(I)})(A,b()?Reflect.construct(y,_||[],f(A).constructor):y.apply(A,_))}function i(A,y){if(!(A instanceof y))throw new TypeError("Cannot call a class as a function")}function a(A,y,_){if(b())return Reflect.construct.apply(null,arguments);var I=[null];I.push.apply(I,y);var U=new(A.bind.apply(A,I));return _&&v(U,_.prototype),U}function s(A,y){for(var _=0;_<y.length;_++){var I=y[_];I.enumerable=I.enumerable||!1,I.configurable=!0,"value"in I&&(I.writable=!0),Object.defineProperty(A,P(I.key),I)}}function o(A,y,_){return y&&s(A.prototype,y),_&&s(A,_),Object.defineProperty(A,"prototype",{writable:!1}),A}function u(A,y){var _=typeof Symbol<"u"&&A[Symbol.iterator]||A["@@iterator"];if(!_){if(Array.isArray(A)||(_=k(A))||y){_&&(A=_);var I=0,U=function(){};return{s:U,n:function(){return I>=A.length?{done:!0}:{done:!1,value:A[I++]}},e:function(Ke){throw Ke},f:U}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var re,ye=!0,Re=!1;return{s:function(){_=_.call(A)},n:function(){var Ke=_.next();return ye=Ke.done,Ke},e:function(Ke){Re=!0,re=Ke},f:function(){try{ye||_.return==null||_.return()}finally{if(Re)throw re}}}}function h(){return h=typeof Reflect<"u"&&Reflect.get?Reflect.get.bind():function(A,y,_){var I=(function(re,ye){for(;!{}.hasOwnProperty.call(re,ye)&&(re=f(re))!==null;);return re})(A,y);if(I){var U=Object.getOwnPropertyDescriptor(I,y);return U.get?U.get.call(arguments.length<3?A:_):U.value}},h.apply(null,arguments)}function f(A){return f=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(y){return y.__proto__||Object.getPrototypeOf(y)},f(A)}function g(A,y){if(typeof y!="function"&&y!==null)throw new TypeError("Super expression must either be null or a function");A.prototype=Object.create(y&&y.prototype,{constructor:{value:A,writable:!0,configurable:!0}}),Object.defineProperty(A,"prototype",{writable:!1}),y&&v(A,y)}function b(){try{var A=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch{}return(b=function(){return!!A})()}function v(A,y){return v=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(_,I){return _.__proto__=I,_},v(A,y)}function S(A,y,_,I){var U=h(f(1&I?A.prototype:A),y,_);return 2&I&&typeof U=="function"?function(re){return U.apply(_,re)}:U}function E(A){return(function(y){if(Array.isArray(y))return r(y)})(A)||(function(y){if(typeof Symbol<"u"&&y[Symbol.iterator]!=null||y["@@iterator"]!=null)return Array.from(y)})(A)||k(A)||(function(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)})()}function P(A){var y=(function(_,I){if(typeof _!="object"||!_)return _;var U=_[Symbol.toPrimitive];if(U!==void 0){var re=U.call(_,I);if(typeof re!="object")return re;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(_)})(A,"string");return typeof y=="symbol"?y:y+""}function k(A,y){if(A){if(typeof A=="string")return r(A,y);var _={}.toString.call(A).slice(8,-1);return _==="Object"&&A.constructor&&(_=A.constructor.name),_==="Map"||_==="Set"?Array.from(A):_==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(_)?r(A,y):void 0}}function L(A){var y=typeof Map=="function"?new Map:void 0;return L=function(_){if(_===null||!(function(U){try{return Function.toString.call(U).indexOf("[native code]")!==-1}catch{return typeof U=="function"}})(_))return _;if(typeof _!="function")throw new TypeError("Super expression must either be null or a function");if(y!==void 0){if(y.has(_))return y.get(_);y.set(_,I)}function I(){return a(_,arguments,f(this).constructor)}return I.prototype=Object.create(_.prototype,{constructor:{value:I,enumerable:!1,writable:!0,configurable:!0}}),v(I,_)},L(A)}var O=(function(){function A(){i(this,A),A.constructor_.apply(this,arguments)}return o(A,[{key:"getEndCapStyle",value:function(){return this._endCapStyle}},{key:"isSingleSided",value:function(){return this._isSingleSided}},{key:"setQuadrantSegments",value:function(y){this._quadrantSegments=y,this._quadrantSegments===0&&(this._joinStyle=A.JOIN_BEVEL),this._quadrantSegments<0&&(this._joinStyle=A.JOIN_MITRE,this._mitreLimit=Math.abs(this._quadrantSegments)),y<=0&&(this._quadrantSegments=1),this._joinStyle!==A.JOIN_ROUND&&(this._quadrantSegments=A.DEFAULT_QUADRANT_SEGMENTS)}},{key:"getJoinStyle",value:function(){return this._joinStyle}},{key:"setJoinStyle",value:function(y){this._joinStyle=y}},{key:"setSimplifyFactor",value:function(y){this._simplifyFactor=y<0?0:y}},{key:"getSimplifyFactor",value:function(){return this._simplifyFactor}},{key:"getQuadrantSegments",value:function(){return this._quadrantSegments}},{key:"setEndCapStyle",value:function(y){this._endCapStyle=y}},{key:"getMitreLimit",value:function(){return this._mitreLimit}},{key:"setMitreLimit",value:function(y){this._mitreLimit=y}},{key:"setSingleSided",value:function(y){this._isSingleSided=y}}],[{key:"constructor_",value:function(){if(this._quadrantSegments=A.DEFAULT_QUADRANT_SEGMENTS,this._endCapStyle=A.CAP_ROUND,this._joinStyle=A.JOIN_ROUND,this._mitreLimit=A.DEFAULT_MITRE_LIMIT,this._isSingleSided=!1,this._simplifyFactor=A.DEFAULT_SIMPLIFY_FACTOR,arguments.length!==0){if(arguments.length===1){var y=arguments[0];this.setQuadrantSegments(y)}else if(arguments.length===2){var _=arguments[0],I=arguments[1];this.setQuadrantSegments(_),this.setEndCapStyle(I)}else if(arguments.length===4){var U=arguments[0],re=arguments[1],ye=arguments[2],Re=arguments[3];this.setQuadrantSegments(U),this.setEndCapStyle(re),this.setJoinStyle(ye),this.setMitreLimit(Re)}}}},{key:"bufferDistanceError",value:function(y){var _=Math.PI/2/y;return 1-Math.cos(_/2)}}])})();O.CAP_ROUND=1,O.CAP_FLAT=2,O.CAP_SQUARE=3,O.JOIN_ROUND=1,O.JOIN_MITRE=2,O.JOIN_BEVEL=3,O.DEFAULT_QUADRANT_SEGMENTS=8,O.DEFAULT_MITRE_LIMIT=5,O.DEFAULT_SIMPLIFY_FACTOR=.01;var M=(function(A){function y(_){var I;return i(this,y),(I=n(this,y,[_])).name=Object.keys({Exception:y})[0],I}return g(y,A),o(y,[{key:"toString",value:function(){return this.message}}])})(L(Error)),z=(function(A){function y(_){var I;return i(this,y),(I=n(this,y,[_])).name=Object.keys({IllegalArgumentException:y})[0],I}return g(y,A),o(y)})(M),B=(function(){return o((function A(){i(this,A)}),[{key:"filter",value:function(A){}}])})();function q(){}function W(){}function G(){}var ie,Q,H,ne,oe,ce,fe,Me,me=(function(){return o((function A(){i(this,A)}),null,[{key:"equalsWithTolerance",value:function(A,y,_){return Math.abs(A-y)<=_}}])})(),we=(function(){return o((function A(y,_){i(this,A),this.low=_||0,this.high=y||0}),null,[{key:"toBinaryString",value:function(A){var y,_="";for(y=2147483648;y>0;y>>>=1)_+=(A.high&y)===y?"1":"0";for(y=2147483648;y>0;y>>>=1)_+=(A.low&y)===y?"1":"0";return _}}])})();function Te(){}function ke(){}Te.NaN=NaN,Te.isNaN=function(A){return Number.isNaN(A)},Te.isInfinite=function(A){return!Number.isFinite(A)},Te.MAX_VALUE=Number.MAX_VALUE,Te.POSITIVE_INFINITY=Number.POSITIVE_INFINITY,Te.NEGATIVE_INFINITY=Number.NEGATIVE_INFINITY,typeof Float64Array=="function"&&typeof Int32Array=="function"?(ce=2146435072,fe=new Float64Array(1),Me=new Int32Array(fe.buffer),Te.doubleToLongBits=function(A){fe[0]=A;var y=0|Me[0],_=0|Me[1];return(_&ce)===ce&&1048575&_&&y!==0&&(y=0,_=2146959360),new we(_,y)},Te.longBitsToDouble=function(A){return Me[0]=A.low,Me[1]=A.high,fe[0]}):(ie=1023,Q=Math.log2,H=Math.floor,ne=Math.pow,oe=(function(){for(var A=53;A>0;A--){var y=ne(2,A)-1;if(H(Q(y))+1===A)return y}return 0})(),Te.doubleToLongBits=function(A){var y,_,I,U,re,ye,Re,Ke,yt;if(A<0||1/A===Number.NEGATIVE_INFINITY?(ye=1<<31,A=-A):ye=0,A===0)return new we(Ke=ye,yt=0);if(A===1/0)return new we(Ke=2146435072|ye,yt=0);if(A!=A)return new we(Ke=2146959360,yt=0);if(U=0,yt=0,(y=H(A))>1)if(y<=oe)(U=H(Q(y)))<=20?(yt=0,Ke=y<<20-U&1048575):(yt=y%(_=ne(2,I=U-20))<<32-I,Ke=y/_&1048575);else for(I=y,yt=0;(I=H(_=I/2))!==0;)U++,yt>>>=1,yt|=(1&Ke)<<31,Ke>>>=1,_!==I&&(Ke|=524288);if(Re=U+ie,re=y===0,y=A-y,U<52&&y!==0)for(I=0;;){if((_=2*y)>=1?(y=_-1,re?(Re--,re=!1):(I<<=1,I|=1,U++)):(y=_,re?--Re==0&&(U++,re=!1):(I<<=1,U++)),U===20)Ke|=I,I=0;else if(U===52){yt|=I;break}if(_===1){U<20?Ke|=I<<20-U:U<52&&(yt|=I<<52-U);break}}return Ke|=Re<<20,new we(Ke|=ye,yt)},Te.longBitsToDouble=function(A){var y,_,I,U,re=A.high,ye=A.low,Re=re&1<<31?-1:1;for(I=((2146435072&re)>>20)-ie,U=0,_=1<<19,y=1;y<=20;y++)re&_&&(U+=ne(2,-y)),_>>>=1;for(_=1<<31,y=21;y<=52;y++)ye&_&&(U+=ne(2,-y)),_>>>=1;if(I===-1023){if(U===0)return 0*Re;I=-1022}else{if(I===1024)return U===0?Re/0:NaN;U+=1}return Re*U*ne(2,I)});var he=(function(A){function y(_){var I;return i(this,y),(I=n(this,y,[_])).name=Object.keys({RuntimeException:y})[0],I}return g(y,A),o(y)})(M),Ee=(function(A){function y(){var _;return i(this,y),_=n(this,y),y.constructor_.apply(_,arguments),_}return g(y,A),o(y,null,[{key:"constructor_",value:function(){if(arguments.length===0)he.constructor_.call(this);else if(arguments.length===1){var _=arguments[0];he.constructor_.call(this,_)}}}])})(he),xe=(function(){function A(){i(this,A)}return o(A,null,[{key:"shouldNeverReachHere",value:function(){if(arguments.length===0)A.shouldNeverReachHere(null);else if(arguments.length===1){var y=arguments[0];throw new Ee("Should never reach here"+(y!==null?": "+y:""))}}},{key:"isTrue",value:function(){if(arguments.length===1){var y=arguments[0];A.isTrue(y,null)}else if(arguments.length===2){var _=arguments[1];if(!arguments[0])throw _===null?new Ee:new Ee(_)}}},{key:"equals",value:function(){if(arguments.length===2){var y=arguments[0],_=arguments[1];A.equals(y,_,null)}else if(arguments.length===3){var I=arguments[0],U=arguments[1],re=arguments[2];if(!U.equals(I))throw new Ee("Expected "+I+" but encountered "+U+(re!==null?": "+re:""))}}}])})(),Ne=new ArrayBuffer(8),Oe=new Float64Array(Ne),$e=new Int32Array(Ne),De=(function(){function A(){i(this,A),A.constructor_.apply(this,arguments)}return o(A,[{key:"getM",value:function(){return Te.NaN}},{key:"setOrdinate",value:function(y,_){switch(y){case A.X:this.x=_;break;case A.Y:this.y=_;break;case A.Z:this.setZ(_);break;default:throw new z("Invalid ordinate index: "+y)}}},{key:"equals2D",value:function(){if(arguments.length===1){var y=arguments[0];return this.x===y.x&&this.y===y.y}if(arguments.length===2){var _=arguments[0],I=arguments[1];return!!me.equalsWithTolerance(this.x,_.x,I)&&!!me.equalsWithTolerance(this.y,_.y,I)}}},{key:"setM",value:function(y){throw new z("Invalid ordinate index: "+A.M)}},{key:"getZ",value:function(){return this.z}},{key:"getOrdinate",value:function(y){switch(y){case A.X:return this.x;case A.Y:return this.y;case A.Z:return this.getZ()}throw new z("Invalid ordinate index: "+y)}},{key:"equals3D",value:function(y){return this.x===y.x&&this.y===y.y&&(this.getZ()===y.getZ()||Te.isNaN(this.getZ())&&Te.isNaN(y.getZ()))}},{key:"equals",value:function(y){return y instanceof A&&this.equals2D(y)}},{key:"equalInZ",value:function(y,_){return me.equalsWithTolerance(this.getZ(),y.getZ(),_)}},{key:"setX",value:function(y){this.x=y}},{key:"compareTo",value:function(y){var _=y;return this.x<_.x?-1:this.x>_.x?1:this.y<_.y?-1:this.y>_.y?1:0}},{key:"getX",value:function(){return this.x}},{key:"setZ",value:function(y){this.z=y}},{key:"clone",value:function(){try{return null}catch(y){if(y instanceof CloneNotSupportedException)return xe.shouldNeverReachHere("this shouldn't happen because this class is Cloneable"),null;throw y}}},{key:"copy",value:function(){return new A(this)}},{key:"toString",value:function(){return"("+this.x+", "+this.y+", "+this.getZ()+")"}},{key:"distance3D",value:function(y){var _=this.x-y.x,I=this.y-y.y,U=this.getZ()-y.getZ();return Math.sqrt(_*_+I*I+U*U)}},{key:"getY",value:function(){return this.y}},{key:"setY",value:function(y){this.y=y}},{key:"distance",value:function(y){var _=this.x-y.x,I=this.y-y.y;return Math.sqrt(_*_+I*I)}},{key:"hashCode",value:function(){var y=17;return y=37*(y=37*y+A.hashCode(this.x))+A.hashCode(this.y)}},{key:"setCoordinate",value:function(y){this.x=y.x,this.y=y.y,this.z=y.getZ()}},{key:"interfaces_",get:function(){return[q,W,G]}}],[{key:"constructor_",value:function(){if(this.x=null,this.y=null,this.z=null,arguments.length===0)A.constructor_.call(this,0,0);else if(arguments.length===1){var y=arguments[0];A.constructor_.call(this,y.x,y.y,y.getZ())}else if(arguments.length===2){var _=arguments[0],I=arguments[1];A.constructor_.call(this,_,I,A.NULL_ORDINATE)}else if(arguments.length===3){var U=arguments[0],re=arguments[1],ye=arguments[2];this.x=U,this.y=re,this.z=ye}}},{key:"hashCode",value:function(y){return Oe[0]=y,$e[0]^$e[1]}}])})(),it=(function(){function A(){i(this,A),A.constructor_.apply(this,arguments)}return o(A,[{key:"compare",value:function(y,_){var I=A.compare(y.x,_.x);if(I!==0)return I;var U=A.compare(y.y,_.y);return U!==0?U:this._dimensionsToTest<=2?0:A.compare(y.getZ(),_.getZ())}},{key:"interfaces_",get:function(){return[ke]}}],[{key:"constructor_",value:function(){if(this._dimensionsToTest=2,arguments.length===0)A.constructor_.call(this,2);else if(arguments.length===1){var y=arguments[0];if(y!==2&&y!==3)throw new z("only 2 or 3 dimensions may be specified");this._dimensionsToTest=y}}},{key:"compare",value:function(y,_){return y<_?-1:y>_?1:Te.isNaN(y)?Te.isNaN(_)?0:-1:Te.isNaN(_)?1:0}}])})();De.DimensionalComparator=it,De.NULL_ORDINATE=Te.NaN,De.X=0,De.Y=1,De.Z=2,De.M=3;var Ye=(function(){function A(){i(this,A),A.constructor_.apply(this,arguments)}return o(A,[{key:"getArea",value:function(){return this.getWidth()*this.getHeight()}},{key:"equals",value:function(y){if(!(y instanceof A))return!1;var _=y;return this.isNull()?_.isNull():this._maxx===_.getMaxX()&&this._maxy===_.getMaxY()&&this._minx===_.getMinX()&&this._miny===_.getMinY()}},{key:"intersection",value:function(y){if(this.isNull()||y.isNull()||!this.intersects(y))return new A;var _=this._minx>y._minx?this._minx:y._minx,I=this._miny>y._miny?this._miny:y._miny;return new A(_,this._maxx<y._maxx?this._maxx:y._maxx,I,this._maxy<y._maxy?this._maxy:y._maxy)}},{key:"isNull",value:function(){return this._maxx<this._minx}},{key:"getMaxX",value:function(){return this._maxx}},{key:"covers",value:function(){if(arguments.length===1){if(arguments[0]instanceof De){var y=arguments[0];return this.covers(y.x,y.y)}if(arguments[0]instanceof A){var _=arguments[0];return!this.isNull()&&!_.isNull()&&_.getMinX()>=this._minx&&_.getMaxX()<=this._maxx&&_.getMinY()>=this._miny&&_.getMaxY()<=this._maxy}}else if(arguments.length===2){var I=arguments[0],U=arguments[1];return!this.isNull()&&I>=this._minx&&I<=this._maxx&&U>=this._miny&&U<=this._maxy}}},{key:"intersects",value:function(){if(arguments.length===1){if(arguments[0]instanceof A){var y=arguments[0];return!this.isNull()&&!y.isNull()&&!(y._minx>this._maxx||y._maxx<this._minx||y._miny>this._maxy||y._maxy<this._miny)}if(arguments[0]instanceof De){var _=arguments[0];return this.intersects(_.x,_.y)}}else if(arguments.length===2){if(arguments[0]instanceof De&&arguments[1]instanceof De){var I=arguments[0],U=arguments[1];return!this.isNull()&&!((I.x<U.x?I.x:U.x)>this._maxx)&&!((I.x>U.x?I.x:U.x)<this._minx)&&!((I.y<U.y?I.y:U.y)>this._maxy)&&!((I.y>U.y?I.y:U.y)<this._miny)}if(typeof arguments[0]=="number"&&typeof arguments[1]=="number"){var re=arguments[0],ye=arguments[1];return!this.isNull()&&!(re>this._maxx||re<this._minx||ye>this._maxy||ye<this._miny)}}}},{key:"getMinY",value:function(){return this._miny}},{key:"getDiameter",value:function(){if(this.isNull())return 0;var y=this.getWidth(),_=this.getHeight();return Math.sqrt(y*y+_*_)}},{key:"getMinX",value:function(){return this._minx}},{key:"expandToInclude",value:function(){if(arguments.length===1){if(arguments[0]instanceof De){var y=arguments[0];this.expandToInclude(y.x,y.y)}else if(arguments[0]instanceof A){var _=arguments[0];if(_.isNull())return null;this.isNull()?(this._minx=_.getMinX(),this._maxx=_.getMaxX(),this._miny=_.getMinY(),this._maxy=_.getMaxY()):(_._minx<this._minx&&(this._minx=_._minx),_._maxx>this._maxx&&(this._maxx=_._maxx),_._miny<this._miny&&(this._miny=_._miny),_._maxy>this._maxy&&(this._maxy=_._maxy))}}else if(arguments.length===2){var I=arguments[0],U=arguments[1];this.isNull()?(this._minx=I,this._maxx=I,this._miny=U,this._maxy=U):(I<this._minx&&(this._minx=I),I>this._maxx&&(this._maxx=I),U<this._miny&&(this._miny=U),U>this._maxy&&(this._maxy=U))}}},{key:"minExtent",value:function(){if(this.isNull())return 0;var y=this.getWidth(),_=this.getHeight();return y<_?y:_}},{key:"getWidth",value:function(){return this.isNull()?0:this._maxx-this._minx}},{key:"compareTo",value:function(y){var _=y;return this.isNull()?_.isNull()?0:-1:_.isNull()?1:this._minx<_._minx?-1:this._minx>_._minx?1:this._miny<_._miny?-1:this._miny>_._miny?1:this._maxx<_._maxx?-1:this._maxx>_._maxx?1:this._maxy<_._maxy?-1:this._maxy>_._maxy?1:0}},{key:"translate",value:function(y,_){if(this.isNull())return null;this.init(this.getMinX()+y,this.getMaxX()+y,this.getMinY()+_,this.getMaxY()+_)}},{key:"copy",value:function(){return new A(this)}},{key:"toString",value:function(){return"Env["+this._minx+" : "+this._maxx+", "+this._miny+" : "+this._maxy+"]"}},{key:"setToNull",value:function(){this._minx=0,this._maxx=-1,this._miny=0,this._maxy=-1}},{key:"disjoint",value:function(y){return!(!this.isNull()&&!y.isNull())||y._minx>this._maxx||y._maxx<this._minx||y._miny>this._maxy||y._maxy<this._miny}},{key:"getHeight",value:function(){return this.isNull()?0:this._maxy-this._miny}},{key:"maxExtent",value:function(){if(this.isNull())return 0;var y=this.getWidth(),_=this.getHeight();return y>_?y:_}},{key:"expandBy",value:function(){if(arguments.length===1){var y=arguments[0];this.expandBy(y,y)}else if(arguments.length===2){var _=arguments[0],I=arguments[1];if(this.isNull())return null;this._minx-=_,this._maxx+=_,this._miny-=I,this._maxy+=I,(this._minx>this._maxx||this._miny>this._maxy)&&this.setToNull()}}},{key:"contains",value:function(){if(arguments.length===1){if(arguments[0]instanceof A){var y=arguments[0];return this.covers(y)}if(arguments[0]instanceof De){var _=arguments[0];return this.covers(_)}}else if(arguments.length===2){var I=arguments[0],U=arguments[1];return this.covers(I,U)}}},{key:"centre",value:function(){return this.isNull()?null:new De((this.getMinX()+this.getMaxX())/2,(this.getMinY()+this.getMaxY())/2)}},{key:"init",value:function(){if(arguments.length===0)this.setToNull();else if(arguments.length===1){if(arguments[0]instanceof De){var y=arguments[0];this.init(y.x,y.x,y.y,y.y)}else if(arguments[0]instanceof A){var _=arguments[0];this._minx=_._minx,this._maxx=_._maxx,this._miny=_._miny,this._maxy=_._maxy}}else if(arguments.length===2){var I=arguments[0],U=arguments[1];this.init(I.x,U.x,I.y,U.y)}else if(arguments.length===4){var re=arguments[0],ye=arguments[1],Re=arguments[2],Ke=arguments[3];re<ye?(this._minx=re,this._maxx=ye):(this._minx=ye,this._maxx=re),Re<Ke?(this._miny=Re,this._maxy=Ke):(this._miny=Ke,this._maxy=Re)}}},{key:"getMaxY",value:function(){return this._maxy}},{key:"distance",value:function(y){if(this.intersects(y))return 0;var _=0;this._maxx<y._minx?_=y._minx-this._maxx:this._minx>y._maxx&&(_=this._minx-y._maxx);var I=0;return this._maxy<y._miny?I=y._miny-this._maxy:this._miny>y._maxy&&(I=this._miny-y._maxy),_===0?I:I===0?_:Math.sqrt(_*_+I*I)}},{key:"hashCode",value:function(){var y=17;return y=37*(y=37*(y=37*(y=37*y+De.hashCode(this._minx))+De.hashCode(this._maxx))+De.hashCode(this._miny))+De.hashCode(this._maxy)}},{key:"interfaces_",get:function(){return[q,G]}}],[{key:"constructor_",value:function(){if(this._minx=null,this._maxx=null,this._miny=null,this._maxy=null,arguments.length===0)this.init();else if(arguments.length===1){if(arguments[0]instanceof De){var y=arguments[0];this.init(y.x,y.x,y.y,y.y)}else if(arguments[0]instanceof A){var _=arguments[0];this.init(_)}}else if(arguments.length===2){var I=arguments[0],U=arguments[1];this.init(I.x,U.x,I.y,U.y)}else if(arguments.length===4){var re=arguments[0],ye=arguments[1],Re=arguments[2],Ke=arguments[3];this.init(re,ye,Re,Ke)}}},{key:"intersects",value:function(){if(arguments.length===3){var y=arguments[0],_=arguments[1],I=arguments[2];return I.x>=(y.x<_.x?y.x:_.x)&&I.x<=(y.x>_.x?y.x:_.x)&&I.y>=(y.y<_.y?y.y:_.y)&&I.y<=(y.y>_.y?y.y:_.y)}if(arguments.length===4){var U=arguments[0],re=arguments[1],ye=arguments[2],Re=arguments[3],Ke=Math.min(ye.x,Re.x),yt=Math.max(ye.x,Re.x),Zt=Math.min(U.x,re.x),ur=Math.max(U.x,re.x);return!(Zt>yt)&&!(ur<Ke)&&(Ke=Math.min(ye.y,Re.y),yt=Math.max(ye.y,Re.y),Zt=Math.min(U.y,re.y),ur=Math.max(U.y,re.y),!(Zt>yt)&&!(ur<Ke))}}}])})(),rt=(function(){function A(){i(this,A),A.constructor_.apply(this,arguments)}return o(A,[{key:"isGeometryCollection",value:function(){return this.getTypeCode()===A.TYPECODE_GEOMETRYCOLLECTION}},{key:"getFactory",value:function(){return this._factory}},{key:"getGeometryN",value:function(y){return this}},{key:"getArea",value:function(){return 0}},{key:"isRectangle",value:function(){return!1}},{key:"equalsExact",value:function(y){return this===y||this.equalsExact(y,0)}},{key:"geometryChanged",value:function(){this.apply(A.geometryChangedFilter)}},{key:"geometryChangedAction",value:function(){this._envelope=null}},{key:"equalsNorm",value:function(y){return y!==null&&this.norm().equalsExact(y.norm())}},{key:"getLength",value:function(){return 0}},{key:"getNumGeometries",value:function(){return 1}},{key:"compareTo",value:function(){var y;if(arguments.length===1){var _=arguments[0];return y=_,this.getTypeCode()!==y.getTypeCode()?this.getTypeCode()-y.getTypeCode():this.isEmpty()&&y.isEmpty()?0:this.isEmpty()?-1:y.isEmpty()?1:this.compareToSameClass(_)}if(arguments.length===2){var I=arguments[0],U=arguments[1];return y=I,this.getTypeCode()!==y.getTypeCode()?this.getTypeCode()-y.getTypeCode():this.isEmpty()&&y.isEmpty()?0:this.isEmpty()?-1:y.isEmpty()?1:this.compareToSameClass(I,U)}}},{key:"getUserData",value:function(){return this._userData}},{key:"getSRID",value:function(){return this._SRID}},{key:"getEnvelope",value:function(){return this.getFactory().toGeometry(this.getEnvelopeInternal())}},{key:"checkNotGeometryCollection",value:function(y){if(y.getTypeCode()===A.TYPECODE_GEOMETRYCOLLECTION)throw new z("This method does not support GeometryCollection arguments")}},{key:"equal",value:function(y,_,I){return I===0?y.equals(_):y.distance(_)<=I}},{key:"norm",value:function(){var y=this.copy();return y.normalize(),y}},{key:"reverse",value:function(){var y=this.reverseInternal();return this.envelope!=null&&(y.envelope=this.envelope.copy()),y.setSRID(this.getSRID()),y}},{key:"copy",value:function(){var y=this.copyInternal();return y.envelope=this._envelope==null?null:this._envelope.copy(),y._SRID=this._SRID,y._userData=this._userData,y}},{key:"getPrecisionModel",value:function(){return this._factory.getPrecisionModel()}},{key:"getEnvelopeInternal",value:function(){return this._envelope===null&&(this._envelope=this.computeEnvelopeInternal()),new Ye(this._envelope)}},{key:"setSRID",value:function(y){this._SRID=y}},{key:"setUserData",value:function(y){this._userData=y}},{key:"compare",value:function(y,_){for(var I=y.iterator(),U=_.iterator();I.hasNext()&&U.hasNext();){var re=I.next(),ye=U.next(),Re=re.compareTo(ye);if(Re!==0)return Re}return I.hasNext()?1:U.hasNext()?-1:0}},{key:"hashCode",value:function(){return this.getEnvelopeInternal().hashCode()}},{key:"isEquivalentClass",value:function(y){return this.getClass()===y.getClass()}},{key:"isGeometryCollectionOrDerived",value:function(){return this.getTypeCode()===A.TYPECODE_GEOMETRYCOLLECTION||this.getTypeCode()===A.TYPECODE_MULTIPOINT||this.getTypeCode()===A.TYPECODE_MULTILINESTRING||this.getTypeCode()===A.TYPECODE_MULTIPOLYGON}},{key:"interfaces_",get:function(){return[W,q,G]}},{key:"getClass",value:function(){return A}}],[{key:"hasNonEmptyElements",value:function(y){for(var _=0;_<y.length;_++)if(!y[_].isEmpty())return!0;return!1}},{key:"hasNullElements",value:function(y){for(var _=0;_<y.length;_++)if(y[_]===null)return!0;return!1}}])})();rt.constructor_=function(A){A&&(this._envelope=null,this._userData=null,this._factory=A,this._SRID=A.getSRID())},rt.TYPECODE_POINT=0,rt.TYPECODE_MULTIPOINT=1,rt.TYPECODE_LINESTRING=2,rt.TYPECODE_LINEARRING=3,rt.TYPECODE_MULTILINESTRING=4,rt.TYPECODE_POLYGON=5,rt.TYPECODE_MULTIPOLYGON=6,rt.TYPECODE_GEOMETRYCOLLECTION=7,rt.TYPENAME_POINT="Point",rt.TYPENAME_MULTIPOINT="MultiPoint",rt.TYPENAME_LINESTRING="LineString",rt.TYPENAME_LINEARRING="LinearRing",rt.TYPENAME_MULTILINESTRING="MultiLineString",rt.TYPENAME_POLYGON="Polygon",rt.TYPENAME_MULTIPOLYGON="MultiPolygon",rt.TYPENAME_GEOMETRYCOLLECTION="GeometryCollection",rt.geometryChangedFilter={get interfaces_(){return[B]},filter:function(A){A.geometryChangedAction()}};var Ie=(function(){function A(){i(this,A)}return o(A,null,[{key:"toLocationSymbol",value:function(y){switch(y){case A.EXTERIOR:return"e";case A.BOUNDARY:return"b";case A.INTERIOR:return"i";case A.NONE:return"-"}throw new z("Unknown location value: "+y)}}])})();Ie.INTERIOR=0,Ie.BOUNDARY=1,Ie.EXTERIOR=2,Ie.NONE=-1;var Mt=(function(){return o((function A(){i(this,A)}),[{key:"add",value:function(){}},{key:"addAll",value:function(){}},{key:"isEmpty",value:function(){}},{key:"iterator",value:function(){}},{key:"size",value:function(){}},{key:"toArray",value:function(){}},{key:"remove",value:function(){}}])})(),at=(function(A){function y(_){var I;return i(this,y),(I=n(this,y,[_])).name=Object.keys({NoSuchElementException:y})[0],I}return g(y,A),o(y)})(M),je=(function(A){function y(_){var I;return i(this,y),(I=n(this,y,[_])).name=Object.keys({UnsupportedOperationException:y})[0],I}return g(y,A),o(y)})(M),Xt=(function(A){function y(){return i(this,y),n(this,y,arguments)}return g(y,A),o(y,[{key:"contains",value:function(){}}])})(Mt),Yt=(function(A){function y(_){var I;return i(this,y),(I=n(this,y)).map=new Map,_ instanceof Mt&&I.addAll(_),I}return g(y,A),o(y,[{key:"contains",value:function(_){var I=_.hashCode?_.hashCode():_;return!!this.map.has(I)}},{key:"add",value:function(_){var I=_.hashCode?_.hashCode():_;return!this.map.has(I)&&!!this.map.set(I,_)}},{key:"addAll",value:function(_){var I,U=u(_);try{for(U.s();!(I=U.n()).done;){var re=I.value;this.add(re)}}catch(ye){U.e(ye)}finally{U.f()}return!0}},{key:"remove",value:function(){throw new je}},{key:"size",value:function(){return this.map.size}},{key:"isEmpty",value:function(){return this.map.size===0}},{key:"toArray",value:function(){return Array.from(this.map.values())}},{key:"iterator",value:function(){return new pr(this.map)}},{key:Symbol.iterator,value:function(){return this.map}}])})(Xt),pr=(function(){return o((function A(y){i(this,A),this.iterator=y.values();var _=this.iterator.next(),I=_.done,U=_.value;this.done=I,this.value=U}),[{key:"next",value:function(){if(this.done)throw new at;var A=this.value,y=this.iterator.next(),_=y.done,I=y.value;return this.done=_,this.value=I,A}},{key:"hasNext",value:function(){return!this.done}},{key:"remove",value:function(){throw new je}}])})(),vt=(function(){function A(){i(this,A)}return o(A,null,[{key:"opposite",value:function(y){return y===A.LEFT?A.RIGHT:y===A.RIGHT?A.LEFT:y}}])})();vt.ON=0,vt.LEFT=1,vt.RIGHT=2;var yr=(function(A){function y(_){var I;return i(this,y),(I=n(this,y,[_])).name=Object.keys({EmptyStackException:y})[0],I}return g(y,A),o(y)})(M),_r=(function(A){function y(_){var I;return i(this,y),(I=n(this,y,[_])).name=Object.keys({IndexOutOfBoundsException:y})[0],I}return g(y,A),o(y)})(M),cr=(function(A){function y(){return i(this,y),n(this,y,arguments)}return g(y,A),o(y,[{key:"get",value:function(){}},{key:"set",value:function(){}},{key:"isEmpty",value:function(){}}])})(Mt),Er=(function(A){function y(){var _;return i(this,y),(_=n(this,y)).array=[],_}return g(y,A),o(y,[{key:"add",value:function(_){return this.array.push(_),!0}},{key:"get",value:function(_){if(_<0||_>=this.size())throw new _r;return this.array[_]}},{key:"push",value:function(_){return this.array.push(_),_}},{key:"pop",value:function(){if(this.array.length===0)throw new yr;return this.array.pop()}},{key:"peek",value:function(){if(this.array.length===0)throw new yr;return this.array[this.array.length-1]}},{key:"empty",value:function(){return this.array.length===0}},{key:"isEmpty",value:function(){return this.empty()}},{key:"search",value:function(_){return this.array.indexOf(_)}},{key:"size",value:function(){return this.array.length}},{key:"toArray",value:function(){return this.array.slice()}}])})(cr);function wr(A,y){return A.interfaces_&&A.interfaces_.indexOf(y)>-1}var er=(function(){return o((function A(y){i(this,A),this.str=y}),[{key:"append",value:function(A){this.str+=A}},{key:"setCharAt",value:function(A,y){this.str=this.str.substr(0,A)+y+this.str.substr(A+1)}},{key:"toString",value:function(){return this.str}}])})(),lr=(function(){function A(y){i(this,A),this.value=y}return o(A,[{key:"intValue",value:function(){return this.value}},{key:"compareTo",value:function(y){return this.value<y?-1:this.value>y?1:0}}],[{key:"compare",value:function(y,_){return y<_?-1:y>_?1:0}},{key:"isNan",value:function(y){return Number.isNaN(y)}},{key:"valueOf",value:function(y){return new A(y)}}])})(),Ar=(function(){return o((function A(){i(this,A)}),null,[{key:"isWhitespace",value:function(A){return A<=32&&A>=0||A===127}},{key:"toUpperCase",value:function(A){return A.toUpperCase()}}])})(),ir=(function(){function A(){i(this,A),A.constructor_.apply(this,arguments)}return o(A,[{key:"le",value:function(y){return this._hi<y._hi||this._hi===y._hi&&this._lo<=y._lo}},{key:"extractSignificantDigits",value:function(y,_){var I=this.abs(),U=A.magnitude(I._hi),re=A.TEN.pow(U);(I=I.divide(re)).gt(A.TEN)?(I=I.divide(A.TEN),U+=1):I.lt(A.ONE)&&(I=I.multiply(A.TEN),U-=1);for(var ye=U+1,Re=new er,Ke=A.MAX_PRINT_DIGITS-1,yt=0;yt<=Ke;yt++){y&&yt===ye&&Re.append(".");var Zt=Math.trunc(I._hi);if(Zt<0)break;var ur=!1,Vr=0;Zt>9?(ur=!0,Vr="9"):Vr="0"+Zt,Re.append(Vr),I=I.subtract(A.valueOf(Zt)).multiply(A.TEN),ur&&I.selfAdd(A.TEN);var gn=!0,Rn=A.magnitude(I._hi);if(Rn<0&&Math.abs(Rn)>=Ke-yt&&(gn=!1),!gn)break}return _[0]=U,Re.toString()}},{key:"sqr",value:function(){return this.multiply(this)}},{key:"doubleValue",value:function(){return this._hi+this._lo}},{key:"subtract",value:function(){if(arguments[0]instanceof A){var y=arguments[0];return this.add(y.negate())}if(typeof arguments[0]=="number"){var _=arguments[0];return this.add(-_)}}},{key:"equals",value:function(){if(arguments.length===1&&arguments[0]instanceof A){var y=arguments[0];return this._hi===y._hi&&this._lo===y._lo}}},{key:"isZero",value:function(){return this._hi===0&&this._lo===0}},{key:"selfSubtract",value:function(){if(arguments[0]instanceof A){var y=arguments[0];return this.isNaN()?this:this.selfAdd(-y._hi,-y._lo)}if(typeof arguments[0]=="number"){var _=arguments[0];return this.isNaN()?this:this.selfAdd(-_,0)}}},{key:"getSpecialNumberString",value:function(){return this.isZero()?"0.0":this.isNaN()?"NaN ":null}},{key:"min",value:function(y){return this.le(y)?this:y}},{key:"selfDivide",value:function(){if(arguments.length===1){if(arguments[0]instanceof A){var y=arguments[0];return this.selfDivide(y._hi,y._lo)}if(typeof arguments[0]=="number"){var _=arguments[0];return this.selfDivide(_,0)}}else if(arguments.length===2){var I,U,re,ye,Re=arguments[0],Ke=arguments[1],yt=null,Zt=null,ur=null,Vr=null;return re=this._hi/Re,Vr=(yt=(ur=A.SPLIT*re)-(yt=ur-re))*(Zt=(Vr=A.SPLIT*Re)-(Zt=Vr-Re))-(ye=re*Re)+yt*(U=Re-Zt)+(I=re-yt)*Zt+I*U,Vr=re+(ur=(this._hi-ye-Vr+this._lo-re*Ke)/Re),this._hi=Vr,this._lo=re-Vr+ur,this}}},{key:"dump",value:function(){return"DD<"+this._hi+", "+this._lo+">"}},{key:"divide",value:function(){if(arguments[0]instanceof A){var y,_,I,U,re=arguments[0],ye=null,Re=null,Ke=null,yt=null;return y=(I=this._hi/re._hi)-(ye=(Ke=A.SPLIT*I)-(ye=Ke-I)),yt=ye*(Re=(yt=A.SPLIT*re._hi)-(Re=yt-re._hi))-(U=I*re._hi)+ye*(_=re._hi-Re)+y*Re+y*_,new A(yt=I+(Ke=(this._hi-U-yt+this._lo-I*re._lo)/re._hi),I-yt+Ke)}if(typeof arguments[0]=="number"){var Zt=arguments[0];return Te.isNaN(Zt)?A.createNaN():A.copy(this).selfDivide(Zt,0)}}},{key:"ge",value:function(y){return this._hi>y._hi||this._hi===y._hi&&this._lo>=y._lo}},{key:"pow",value:function(y){if(y===0)return A.valueOf(1);var _=new A(this),I=A.valueOf(1),U=Math.abs(y);if(U>1)for(;U>0;)U%2==1&&I.selfMultiply(_),(U/=2)>0&&(_=_.sqr());else I=_;return y<0?I.reciprocal():I}},{key:"ceil",value:function(){if(this.isNaN())return A.NaN;var y=Math.ceil(this._hi),_=0;return y===this._hi&&(_=Math.ceil(this._lo)),new A(y,_)}},{key:"compareTo",value:function(y){var _=y;return this._hi<_._hi?-1:this._hi>_._hi?1:this._lo<_._lo?-1:this._lo>_._lo?1:0}},{key:"rint",value:function(){return this.isNaN()?this:this.add(.5).floor()}},{key:"setValue",value:function(){if(arguments[0]instanceof A){var y=arguments[0];return this.init(y),this}if(typeof arguments[0]=="number"){var _=arguments[0];return this.init(_),this}}},{key:"max",value:function(y){return this.ge(y)?this:y}},{key:"sqrt",value:function(){if(this.isZero())return A.valueOf(0);if(this.isNegative())return A.NaN;var y=1/Math.sqrt(this._hi),_=this._hi*y,I=A.valueOf(_),U=this.subtract(I.sqr())._hi*(.5*y);return I.add(U)}},{key:"selfAdd",value:function(){if(arguments.length===1){if(arguments[0]instanceof A){var y=arguments[0];return this.selfAdd(y._hi,y._lo)}if(typeof arguments[0]=="number"){var _,I,U,re,ye,Re=arguments[0],Ke=null;return Ke=(U=this._hi+Re)-(re=U-this._hi),I=(ye=(Ke=Re-re+(this._hi-Ke))+this._lo)+(U-(_=U+ye)),this._hi=_+I,this._lo=I+(_-this._hi),this}}else if(arguments.length===2){var yt,Zt,ur,Vr,gn=arguments[0],Rn=arguments[1],Vn=null,In=null,Dn=null;ur=this._hi+gn,Zt=this._lo+Rn,In=ur-(Dn=ur-this._hi),Vn=Zt-(Vr=Zt-this._lo);var Qi=(yt=ur+(Dn=(In=gn-Dn+(this._hi-In))+Zt))+(Dn=(Vn=Rn-Vr+(this._lo-Vn))+(Dn+(ur-yt))),ia=Dn+(yt-Qi);return this._hi=Qi,this._lo=ia,this}}},{key:"selfMultiply",value:function(){if(arguments.length===1){if(arguments[0]instanceof A){var y=arguments[0];return this.selfMultiply(y._hi,y._lo)}if(typeof arguments[0]=="number"){var _=arguments[0];return this.selfMultiply(_,0)}}else if(arguments.length===2){var I,U,re=arguments[0],ye=arguments[1],Re=null,Ke=null,yt=null,Zt=null;Re=(yt=A.SPLIT*this._hi)-this._hi,Zt=A.SPLIT*re,Re=yt-Re,I=this._hi-Re,Ke=Zt-re;var ur=(yt=this._hi*re)+(Zt=Re*(Ke=Zt-Ke)-yt+Re*(U=re-Ke)+I*Ke+I*U+(this._hi*ye+this._lo*re)),Vr=Zt+(Re=yt-ur);return this._hi=ur,this._lo=Vr,this}}},{key:"selfSqr",value:function(){return this.selfMultiply(this)}},{key:"floor",value:function(){if(this.isNaN())return A.NaN;var y=Math.floor(this._hi),_=0;return y===this._hi&&(_=Math.floor(this._lo)),new A(y,_)}},{key:"negate",value:function(){return this.isNaN()?this:new A(-this._hi,-this._lo)}},{key:"clone",value:function(){try{return null}catch(y){if(y instanceof CloneNotSupportedException)return null;throw y}}},{key:"multiply",value:function(){if(arguments[0]instanceof A){var y=arguments[0];return y.isNaN()?A.createNaN():A.copy(this).selfMultiply(y)}if(typeof arguments[0]=="number"){var _=arguments[0];return Te.isNaN(_)?A.createNaN():A.copy(this).selfMultiply(_,0)}}},{key:"isNaN",value:function(){return Te.isNaN(this._hi)}},{key:"intValue",value:function(){return Math.trunc(this._hi)}},{key:"toString",value:function(){var y=A.magnitude(this._hi);return y>=-3&&y<=20?this.toStandardNotation():this.toSciNotation()}},{key:"toStandardNotation",value:function(){var y=this.getSpecialNumberString();if(y!==null)return y;var _=new Array(1).fill(null),I=this.extractSignificantDigits(!0,_),U=_[0]+1,re=I;if(I.charAt(0)===".")re="0"+I;else if(U<0)re="0."+A.stringOfChar("0",-U)+I;else if(I.indexOf(".")===-1){var ye=U-I.length;re=I+A.stringOfChar("0",ye)+".0"}return this.isNegative()?"-"+re:re}},{key:"reciprocal",value:function(){var y,_,I,U,re=null,ye=null,Re=null,Ke=null;y=(I=1/this._hi)-(re=(Re=A.SPLIT*I)-(re=Re-I)),ye=(Ke=A.SPLIT*this._hi)-this._hi;var yt=I+(Re=(1-(U=I*this._hi)-(Ke=re*(ye=Ke-ye)-U+re*(_=this._hi-ye)+y*ye+y*_)-I*this._lo)/this._hi);return new A(yt,I-yt+Re)}},{key:"toSciNotation",value:function(){if(this.isZero())return A.SCI_NOT_ZERO;var y=this.getSpecialNumberString();if(y!==null)return y;var _=new Array(1).fill(null),I=this.extractSignificantDigits(!1,_),U=A.SCI_NOT_EXPONENT_CHAR+_[0];if(I.charAt(0)==="0")throw new IllegalStateException("Found leading zero: "+I);var re="";I.length>1&&(re=I.substring(1));var ye=I.charAt(0)+"."+re;return this.isNegative()?"-"+ye+U:ye+U}},{key:"abs",value:function(){return this.isNaN()?A.NaN:this.isNegative()?this.negate():new A(this)}},{key:"isPositive",value:function(){return this._hi>0||this._hi===0&&this._lo>0}},{key:"lt",value:function(y){return this._hi<y._hi||this._hi===y._hi&&this._lo<y._lo}},{key:"add",value:function(){if(arguments[0]instanceof A){var y=arguments[0];return A.copy(this).selfAdd(y)}if(typeof arguments[0]=="number"){var _=arguments[0];return A.copy(this).selfAdd(_)}}},{key:"init",value:function(){if(arguments.length===1){if(typeof arguments[0]=="number"){var y=arguments[0];this._hi=y,this._lo=0}else if(arguments[0]instanceof A){var _=arguments[0];this._hi=_._hi,this._lo=_._lo}}else if(arguments.length===2){var I=arguments[0],U=arguments[1];this._hi=I,this._lo=U}}},{key:"gt",value:function(y){return this._hi>y._hi||this._hi===y._hi&&this._lo>y._lo}},{key:"isNegative",value:function(){return this._hi<0||this._hi===0&&this._lo<0}},{key:"trunc",value:function(){return this.isNaN()?A.NaN:this.isPositive()?this.floor():this.ceil()}},{key:"signum",value:function(){return this._hi>0?1:this._hi<0?-1:this._lo>0?1:this._lo<0?-1:0}},{key:"interfaces_",get:function(){return[G,q,W]}}],[{key:"constructor_",value:function(){if(this._hi=0,this._lo=0,arguments.length===0)this.init(0);else if(arguments.length===1){if(typeof arguments[0]=="number"){var y=arguments[0];this.init(y)}else if(arguments[0]instanceof A){var _=arguments[0];this.init(_)}else if(typeof arguments[0]=="string"){var I=arguments[0];A.constructor_.call(this,A.parse(I))}}else if(arguments.length===2){var U=arguments[0],re=arguments[1];this.init(U,re)}}},{key:"determinant",value:function(){if(typeof arguments[3]=="number"&&typeof arguments[2]=="number"&&typeof arguments[0]=="number"&&typeof arguments[1]=="number"){var y=arguments[0],_=arguments[1],I=arguments[2],U=arguments[3];return A.determinant(A.valueOf(y),A.valueOf(_),A.valueOf(I),A.valueOf(U))}if(arguments[3]instanceof A&&arguments[2]instanceof A&&arguments[0]instanceof A&&arguments[1]instanceof A){var re=arguments[1],ye=arguments[2],Re=arguments[3];return arguments[0].multiply(Re).selfSubtract(re.multiply(ye))}}},{key:"sqr",value:function(y){return A.valueOf(y).selfMultiply(y)}},{key:"valueOf",value:function(){if(typeof arguments[0]=="string"){var y=arguments[0];return A.parse(y)}if(typeof arguments[0]=="number")return new A(arguments[0])}},{key:"sqrt",value:function(y){return A.valueOf(y).sqrt()}},{key:"parse",value:function(y){for(var _=0,I=y.length;Ar.isWhitespace(y.charAt(_));)_++;var U=!1;if(_<I){var re=y.charAt(_);re!=="-"&&re!=="+"||(_++,re==="-"&&(U=!0))}for(var ye=new A,Re=0,Ke=0,yt=0,Zt=!1;!(_>=I);){var ur=y.charAt(_);if(_++,Ar.isDigit(ur)){var Vr=ur-"0";ye.selfMultiply(A.TEN),ye.selfAdd(Vr),Re++}else{if(ur!=="."){if(ur==="e"||ur==="E"){var gn=y.substring(_);try{yt=lr.parseInt(gn)}catch(Qi){throw Qi instanceof NumberFormatException?new NumberFormatException("Invalid exponent "+gn+" in string "+y):Qi}break}throw new NumberFormatException("Unexpected character '"+ur+"' at position "+_+" in string "+y)}Ke=Re,Zt=!0}}var Rn=ye;Zt||(Ke=Re);var Vn=Re-Ke-yt;if(Vn===0)Rn=ye;else if(Vn>0){var In=A.TEN.pow(Vn);Rn=ye.divide(In)}else if(Vn<0){var Dn=A.TEN.pow(-Vn);Rn=ye.multiply(Dn)}return U?Rn.negate():Rn}},{key:"createNaN",value:function(){return new A(Te.NaN,Te.NaN)}},{key:"copy",value:function(y){return new A(y)}},{key:"magnitude",value:function(y){var _=Math.abs(y),I=Math.log(_)/Math.log(10),U=Math.trunc(Math.floor(I));return 10*Math.pow(10,U)<=_&&(U+=1),U}},{key:"stringOfChar",value:function(y,_){for(var I=new er,U=0;U<_;U++)I.append(y);return I.toString()}}])})();ir.PI=new ir(3.141592653589793,12246467991473532e-32),ir.TWO_PI=new ir(6.283185307179586,24492935982947064e-32),ir.PI_2=new ir(1.5707963267948966,6123233995736766e-32),ir.E=new ir(2.718281828459045,14456468917292502e-32),ir.NaN=new ir(Te.NaN,Te.NaN),ir.EPS=123259516440783e-46,ir.SPLIT=134217729,ir.MAX_PRINT_DIGITS=32,ir.TEN=ir.valueOf(10),ir.ONE=ir.valueOf(1),ir.SCI_NOT_EXPONENT_CHAR="E",ir.SCI_NOT_ZERO="0.0E0";var nt=(function(){function A(){i(this,A)}return o(A,null,[{key:"orientationIndex",value:function(y,_,I){var U=A.orientationIndexFilter(y,_,I);if(U<=1)return U;var re=ir.valueOf(_.x).selfAdd(-y.x),ye=ir.valueOf(_.y).selfAdd(-y.y),Re=ir.valueOf(I.x).selfAdd(-_.x),Ke=ir.valueOf(I.y).selfAdd(-_.y);return re.selfMultiply(Ke).selfSubtract(ye.selfMultiply(Re)).signum()}},{key:"signOfDet2x2",value:function(){if(arguments[3]instanceof ir&&arguments[2]instanceof ir&&arguments[0]instanceof ir&&arguments[1]instanceof ir){var y=arguments[1],_=arguments[2],I=arguments[3];return arguments[0].multiply(I).selfSubtract(y.multiply(_)).signum()}if(typeof arguments[3]=="number"&&typeof arguments[2]=="number"&&typeof arguments[0]=="number"&&typeof arguments[1]=="number"){var U=arguments[0],re=arguments[1],ye=arguments[2],Re=arguments[3],Ke=ir.valueOf(U),yt=ir.valueOf(re),Zt=ir.valueOf(ye),ur=ir.valueOf(Re);return Ke.multiply(ur).selfSubtract(yt.multiply(Zt)).signum()}}},{key:"intersection",value:function(y,_,I,U){var re=new ir(y.y).selfSubtract(_.y),ye=new ir(_.x).selfSubtract(y.x),Re=new ir(y.x).selfMultiply(_.y).selfSubtract(new ir(_.x).selfMultiply(y.y)),Ke=new ir(I.y).selfSubtract(U.y),yt=new ir(U.x).selfSubtract(I.x),Zt=new ir(I.x).selfMultiply(U.y).selfSubtract(new ir(U.x).selfMultiply(I.y)),ur=ye.multiply(Zt).selfSubtract(yt.multiply(Re)),Vr=Ke.multiply(Re).selfSubtract(re.multiply(Zt)),gn=re.multiply(yt).selfSubtract(Ke.multiply(ye)),Rn=ur.selfDivide(gn).doubleValue(),Vn=Vr.selfDivide(gn).doubleValue();return Te.isNaN(Rn)||Te.isInfinite(Rn)||Te.isNaN(Vn)||Te.isInfinite(Vn)?null:new De(Rn,Vn)}},{key:"orientationIndexFilter",value:function(y,_,I){var U=null,re=(y.x-I.x)*(_.y-I.y),ye=(y.y-I.y)*(_.x-I.x),Re=re-ye;if(re>0){if(ye<=0)return A.signum(Re);U=re+ye}else{if(!(re<0)||ye>=0)return A.signum(Re);U=-re-ye}var Ke=A.DP_SAFE_EPSILON*U;return Re>=Ke||-Re>=Ke?A.signum(Re):2}},{key:"signum",value:function(y){return y>0?1:y<0?-1:0}}])})();nt.DP_SAFE_EPSILON=1e-15;var _e=(function(){return o((function A(){i(this,A)}),[{key:"getM",value:function(A){if(this.hasM()){var y=this.getDimension()-this.getMeasures();return this.getOrdinate(A,y)}return Te.NaN}},{key:"setOrdinate",value:function(A,y,_){}},{key:"getZ",value:function(A){return this.hasZ()?this.getOrdinate(A,2):Te.NaN}},{key:"size",value:function(){}},{key:"getOrdinate",value:function(A,y){}},{key:"getCoordinate",value:function(){}},{key:"getCoordinateCopy",value:function(A){}},{key:"createCoordinate",value:function(){}},{key:"getDimension",value:function(){}},{key:"hasM",value:function(){return this.getMeasures()>0}},{key:"getX",value:function(A){}},{key:"hasZ",value:function(){return this.getDimension()-this.getMeasures()>2}},{key:"getMeasures",value:function(){return 0}},{key:"expandEnvelope",value:function(A){}},{key:"copy",value:function(){}},{key:"getY",value:function(A){}},{key:"toCoordinateArray",value:function(){}},{key:"interfaces_",get:function(){return[W]}}])})();_e.X=0,_e.Y=1,_e.Z=2,_e.M=3;var be=(function(){function A(){i(this,A)}return o(A,null,[{key:"index",value:function(y,_,I){return nt.orientationIndex(y,_,I)}},{key:"isCCW",value:function(){if(arguments[0]instanceof Array){var y=arguments[0],_=y.length-1;if(_<3)throw new z("Ring has fewer than 4 points, so orientation cannot be determined");for(var I=y[0],U=0,re=1;re<=_;re++){var ye=y[re];ye.y>I.y&&(I=ye,U=re)}var Re=U;do(Re-=1)<0&&(Re=_);while(y[Re].equals2D(I)&&Re!==U);var Ke=U;do Ke=(Ke+1)%_;while(y[Ke].equals2D(I)&&Ke!==U);var yt=y[Re],Zt=y[Ke];if(yt.equals2D(I)||Zt.equals2D(I)||yt.equals2D(Zt))return!1;var ur=A.index(yt,I,Zt);return ur===0?yt.x>Zt.x:ur>0}if(wr(arguments[0],_e)){var Vr=arguments[0],gn=Vr.size()-1;if(gn<3)throw new z("Ring has fewer than 4 points, so orientation cannot be determined");for(var Rn=Vr.getCoordinate(0),Vn=0,In=1;In<=gn;In++){var Dn=Vr.getCoordinate(In);Dn.y>Rn.y&&(Rn=Dn,Vn=In)}var Qi=null,ia=Vn;do(ia-=1)<0&&(ia=gn),Qi=Vr.getCoordinate(ia);while(Qi.equals2D(Rn)&&ia!==Vn);var Ta=null,Ga=Vn;do Ga=(Ga+1)%gn,Ta=Vr.getCoordinate(Ga);while(Ta.equals2D(Rn)&&Ga!==Vn);if(Qi.equals2D(Rn)||Ta.equals2D(Rn)||Qi.equals2D(Ta))return!1;var Bo=A.index(Qi,Rn,Ta);return Bo===0?Qi.x>Ta.x:Bo>0}}}])})();be.CLOCKWISE=-1,be.RIGHT=be.CLOCKWISE,be.COUNTERCLOCKWISE=1,be.LEFT=be.COUNTERCLOCKWISE,be.COLLINEAR=0,be.STRAIGHT=be.COLLINEAR;var qe=(function(){return o((function A(){i(this,A),A.constructor_.apply(this,arguments)}),[{key:"getCoordinate",value:function(){return this._minCoord}},{key:"getRightmostSide",value:function(A,y){var _=this.getRightmostSideOfSegment(A,y);return _<0&&(_=this.getRightmostSideOfSegment(A,y-1)),_<0&&(this._minCoord=null,this.checkForRightmostCoordinate(A)),_}},{key:"findRightmostEdgeAtVertex",value:function(){var A=this._minDe.getEdge().getCoordinates();xe.isTrue(this._minIndex>0&&this._minIndex<A.length,"rightmost point expected to be interior vertex of edge");var y=A[this._minIndex-1],_=A[this._minIndex+1],I=be.index(this._minCoord,_,y),U=!1;(y.y<this._minCoord.y&&_.y<this._minCoord.y&&I===be.COUNTERCLOCKWISE||y.y>this._minCoord.y&&_.y>this._minCoord.y&&I===be.CLOCKWISE)&&(U=!0),U&&(this._minIndex=this._minIndex-1)}},{key:"getRightmostSideOfSegment",value:function(A,y){var _=A.getEdge().getCoordinates();if(y<0||y+1>=_.length||_[y].y===_[y+1].y)return-1;var I=vt.LEFT;return _[y].y<_[y+1].y&&(I=vt.RIGHT),I}},{key:"getEdge",value:function(){return this._orientedDe}},{key:"checkForRightmostCoordinate",value:function(A){for(var y=A.getEdge().getCoordinates(),_=0;_<y.length-1;_++)(this._minCoord===null||y[_].x>this._minCoord.x)&&(this._minDe=A,this._minIndex=_,this._minCoord=y[_])}},{key:"findRightmostEdgeAtNode",value:function(){var A=this._minDe.getNode().getEdges();this._minDe=A.getRightmostEdge(),this._minDe.isForward()||(this._minDe=this._minDe.getSym(),this._minIndex=this._minDe.getEdge().getCoordinates().length-1)}},{key:"findEdge",value:function(A){for(var y=A.iterator();y.hasNext();){var _=y.next();_.isForward()&&this.checkForRightmostCoordinate(_)}xe.isTrue(this._minIndex!==0||this._minCoord.equals(this._minDe.getCoordinate()),"inconsistency in rightmost processing"),this._minIndex===0?this.findRightmostEdgeAtNode():this.findRightmostEdgeAtVertex(),this._orientedDe=this._minDe,this.getRightmostSide(this._minDe,this._minIndex)===vt.LEFT&&(this._orientedDe=this._minDe.getSym())}}],[{key:"constructor_",value:function(){this._minIndex=-1,this._minCoord=null,this._minDe=null,this._orientedDe=null}}])})(),Qe=(function(A){function y(_,I){var U;return i(this,y),(U=n(this,y,[I?_+" [ "+I+" ]":_])).pt=I?new De(I):void 0,U.name=Object.keys({TopologyException:y})[0],U}return g(y,A),o(y,[{key:"getCoordinate",value:function(){return this.pt}}])})(he),ot=(function(){return o((function A(){i(this,A),this.array=[]}),[{key:"addLast",value:function(A){this.array.push(A)}},{key:"removeFirst",value:function(){return this.array.shift()}},{key:"isEmpty",value:function(){return this.array.length===0}}])})(),et=(function(A){function y(_){var I;return i(this,y),(I=n(this,y)).array=[],_ instanceof Mt&&I.addAll(_),I}return g(y,A),o(y,[{key:"interfaces_",get:function(){return[cr,Mt]}},{key:"ensureCapacity",value:function(){}},{key:"add",value:function(_){return arguments.length===1?this.array.push(_):this.array.splice(arguments[0],0,arguments[1]),!0}},{key:"clear",value:function(){this.array=[]}},{key:"addAll",value:function(_){var I,U=u(_);try{for(U.s();!(I=U.n()).done;){var re=I.value;this.array.push(re)}}catch(ye){U.e(ye)}finally{U.f()}}},{key:"set",value:function(_,I){var U=this.array[_];return this.array[_]=I,U}},{key:"iterator",value:function(){return new Lt(this)}},{key:"get",value:function(_){if(_<0||_>=this.size())throw new _r;return this.array[_]}},{key:"isEmpty",value:function(){return this.array.length===0}},{key:"sort",value:function(_){_?this.array.sort((function(I,U){return _.compare(I,U)})):this.array.sort()}},{key:"size",value:function(){return this.array.length}},{key:"toArray",value:function(){return this.array.slice()}},{key:"remove",value:function(_){for(var I=0,U=this.array.length;I<U;I++)if(this.array[I]===_)return!!this.array.splice(I,1);return!1}},{key:Symbol.iterator,value:function(){return this.array.values()}}])})(cr),Lt=(function(){return o((function A(y){i(this,A),this.arrayList=y,this.position=0}),[{key:"next",value:function(){if(this.position===this.arrayList.size())throw new at;return this.arrayList.get(this.position++)}},{key:"hasNext",value:function(){return this.position<this.arrayList.size()}},{key:"set",value:function(A){return this.arrayList.set(this.position-1,A)}},{key:"remove",value:function(){this.arrayList.remove(this.arrayList.get(this.position))}}])})(),_t=(function(){return o((function A(){i(this,A),A.constructor_.apply(this,arguments)}),[{key:"clearVisitedEdges",value:function(){for(var A=this._dirEdgeList.iterator();A.hasNext();)A.next().setVisited(!1)}},{key:"getRightmostCoordinate",value:function(){return this._rightMostCoord}},{key:"computeNodeDepth",value:function(A){for(var y=null,_=A.getEdges().iterator();_.hasNext();){var I=_.next();if(I.isVisited()||I.getSym().isVisited()){y=I;break}}if(y===null)throw new Qe("unable to find edge to compute depths at "+A.getCoordinate());A.getEdges().computeDepths(y);for(var U=A.getEdges().iterator();U.hasNext();){var re=U.next();re.setVisited(!0),this.copySymDepths(re)}}},{key:"computeDepth",value:function(A){this.clearVisitedEdges();var y=this._finder.getEdge();y.getNode(),y.getLabel(),y.setEdgeDepths(vt.RIGHT,A),this.copySymDepths(y),this.computeDepths(y)}},{key:"create",value:function(A){this.addReachable(A),this._finder.findEdge(this._dirEdgeList),this._rightMostCoord=this._finder.getCoordinate()}},{key:"findResultEdges",value:function(){for(var A=this._dirEdgeList.iterator();A.hasNext();){var y=A.next();y.getDepth(vt.RIGHT)>=1&&y.getDepth(vt.LEFT)<=0&&!y.isInteriorAreaEdge()&&y.setInResult(!0)}}},{key:"computeDepths",value:function(A){var y=new Yt,_=new ot,I=A.getNode();for(_.addLast(I),y.add(I),A.setVisited(!0);!_.isEmpty();){var U=_.removeFirst();y.add(U),this.computeNodeDepth(U);for(var re=U.getEdges().iterator();re.hasNext();){var ye=re.next().getSym();if(!ye.isVisited()){var Re=ye.getNode();y.contains(Re)||(_.addLast(Re),y.add(Re))}}}}},{key:"compareTo",value:function(A){var y=A;return this._rightMostCoord.x<y._rightMostCoord.x?-1:this._rightMostCoord.x>y._rightMostCoord.x?1:0}},{key:"getEnvelope",value:function(){if(this._env===null){for(var A=new Ye,y=this._dirEdgeList.iterator();y.hasNext();)for(var _=y.next().getEdge().getCoordinates(),I=0;I<_.length-1;I++)A.expandToInclude(_[I]);this._env=A}return this._env}},{key:"addReachable",value:function(A){var y=new Er;for(y.add(A);!y.empty();){var _=y.pop();this.add(_,y)}}},{key:"copySymDepths",value:function(A){var y=A.getSym();y.setDepth(vt.LEFT,A.getDepth(vt.RIGHT)),y.setDepth(vt.RIGHT,A.getDepth(vt.LEFT))}},{key:"add",value:function(A,y){A.setVisited(!0),this._nodes.add(A);for(var _=A.getEdges().iterator();_.hasNext();){var I=_.next();this._dirEdgeList.add(I);var U=I.getSym().getNode();U.isVisited()||y.push(U)}}},{key:"getNodes",value:function(){return this._nodes}},{key:"getDirectedEdges",value:function(){return this._dirEdgeList}},{key:"interfaces_",get:function(){return[q]}}],[{key:"constructor_",value:function(){this._finder=null,this._dirEdgeList=new et,this._nodes=new et,this._rightMostCoord=null,this._env=null,this._finder=new qe}}])})(),jt=(function(){return o((function A(){i(this,A)}),null,[{key:"intersection",value:function(A,y,_,I){var U=A.x<y.x?A.x:y.x,re=A.y<y.y?A.y:y.y,ye=A.x>y.x?A.x:y.x,Re=A.y>y.y?A.y:y.y,Ke=_.x<I.x?_.x:I.x,yt=_.y<I.y?_.y:I.y,Zt=_.x>I.x?_.x:I.x,ur=_.y>I.y?_.y:I.y,Vr=((U>Ke?U:Ke)+(ye<Zt?ye:Zt))/2,gn=((re>yt?re:yt)+(Re<ur?Re:ur))/2,Rn=A.x-Vr,Vn=A.y-gn,In=y.x-Vr,Dn=y.y-gn,Qi=_.x-Vr,ia=_.y-gn,Ta=I.x-Vr,Ga=I.y-gn,Bo=Vn-Dn,xs=In-Rn,Vl=Rn*Dn-In*Vn,Gu=ia-Ga,Us=Ta-Qi,Zo=Qi*Ga-Ta*ia,uc=Bo*Us-Gu*xs,Sl=(xs*Zo-Us*Vl)/uc,Zn=(Gu*Vl-Bo*Zo)/uc;return Te.isNaN(Sl)||Te.isInfinite(Sl)||Te.isNaN(Zn)||Te.isInfinite(Zn)?null:new De(Sl+Vr,Zn+gn)}}])})(),Jt=(function(){return o((function A(){i(this,A)}),null,[{key:"arraycopy",value:function(A,y,_,I,U){for(var re=0,ye=y;ye<y+U;ye++)_[I+re]=A[ye],re++}},{key:"getProperty",value:function(A){return{"line.separator":`
`}[A]}}])})(),Kt=(function(){function A(){i(this,A)}return o(A,null,[{key:"log10",value:function(y){var _=Math.log(y);return Te.isInfinite(_)||Te.isNaN(_)?_:_/A.LOG_10}},{key:"min",value:function(y,_,I,U){var re=y;return _<re&&(re=_),I<re&&(re=I),U<re&&(re=U),re}},{key:"clamp",value:function(){if(typeof arguments[2]=="number"&&typeof arguments[0]=="number"&&typeof arguments[1]=="number"){var y=arguments[0],_=arguments[1],I=arguments[2];return y<_?_:y>I?I:y}if(Number.isInteger(arguments[2])&&Number.isInteger(arguments[0])&&Number.isInteger(arguments[1])){var U=arguments[0],re=arguments[1],ye=arguments[2];return U<re?re:U>ye?ye:U}}},{key:"wrap",value:function(y,_){return y<0?_- -y%_:y%_}},{key:"max",value:function(){if(arguments.length===3){var y=arguments[1],_=arguments[2],I=arguments[0];return y>I&&(I=y),_>I&&(I=_),I}if(arguments.length===4){var U=arguments[1],re=arguments[2],ye=arguments[3],Re=arguments[0];return U>Re&&(Re=U),re>Re&&(Re=re),ye>Re&&(Re=ye),Re}}},{key:"average",value:function(y,_){return(y+_)/2}}])})();Kt.LOG_10=Math.log(10);var Rr=(function(){function A(){i(this,A)}return o(A,null,[{key:"segmentToSegment",value:function(y,_,I,U){if(y.equals(_))return A.pointToSegment(y,I,U);if(I.equals(U))return A.pointToSegment(U,y,_);var re=!1;if(Ye.intersects(y,_,I,U)){var ye=(_.x-y.x)*(U.y-I.y)-(_.y-y.y)*(U.x-I.x);if(ye===0)re=!0;else{var Re=(y.y-I.y)*(U.x-I.x)-(y.x-I.x)*(U.y-I.y),Ke=((y.y-I.y)*(_.x-y.x)-(y.x-I.x)*(_.y-y.y))/ye,yt=Re/ye;(yt<0||yt>1||Ke<0||Ke>1)&&(re=!0)}}else re=!0;return re?Kt.min(A.pointToSegment(y,I,U),A.pointToSegment(_,I,U),A.pointToSegment(I,y,_),A.pointToSegment(U,y,_)):0}},{key:"pointToSegment",value:function(y,_,I){if(_.x===I.x&&_.y===I.y)return y.distance(_);var U=(I.x-_.x)*(I.x-_.x)+(I.y-_.y)*(I.y-_.y),re=((y.x-_.x)*(I.x-_.x)+(y.y-_.y)*(I.y-_.y))/U;if(re<=0)return y.distance(_);if(re>=1)return y.distance(I);var ye=((_.y-y.y)*(I.x-_.x)-(_.x-y.x)*(I.y-_.y))/U;return Math.abs(ye)*Math.sqrt(U)}},{key:"pointToLinePerpendicular",value:function(y,_,I){var U=(I.x-_.x)*(I.x-_.x)+(I.y-_.y)*(I.y-_.y),re=((_.y-y.y)*(I.x-_.x)-(_.x-y.x)*(I.y-_.y))/U;return Math.abs(re)*Math.sqrt(U)}},{key:"pointToSegmentString",value:function(y,_){if(_.length===0)throw new z("Line array must contain at least one vertex");for(var I=y.distance(_[0]),U=0;U<_.length-1;U++){var re=A.pointToSegment(y,_[U],_[U+1]);re<I&&(I=re)}return I}}])})(),bt=(function(){return o((function A(){i(this,A)}),[{key:"create",value:function(){if(arguments.length===1)arguments[0]instanceof Array||wr(arguments[0],_e);else if(arguments.length!==2){if(arguments.length===3){var A=arguments[0],y=arguments[1];return this.create(A,y)}}}}])})(),Tr=(function(){return o((function A(){i(this,A)}),[{key:"filter",value:function(A){}}])})(),Ur=(function(){return o((function A(){i(this,A)}),null,[{key:"ofLine",value:function(A){var y=A.size();if(y<=1)return 0;var _=0,I=new De;A.getCoordinate(0,I);for(var U=I.x,re=I.y,ye=1;ye<y;ye++){A.getCoordinate(ye,I);var Re=I.x,Ke=I.y,yt=Re-U,Zt=Ke-re;_+=Math.sqrt(yt*yt+Zt*Zt),U=Re,re=Ke}return _}}])})(),Gr=o((function A(){i(this,A)})),Jr=(function(){function A(){i(this,A)}return o(A,null,[{key:"copyCoord",value:function(y,_,I,U){for(var re=Math.min(y.getDimension(),I.getDimension()),ye=0;ye<re;ye++)I.setOrdinate(U,ye,y.getOrdinate(_,ye))}},{key:"isRing",value:function(y){var _=y.size();return _===0||!(_<=3)&&y.getOrdinate(0,_e.X)===y.getOrdinate(_-1,_e.X)&&y.getOrdinate(0,_e.Y)===y.getOrdinate(_-1,_e.Y)}},{key:"scroll",value:function(){if(arguments.length===2){if(wr(arguments[0],_e)&&Number.isInteger(arguments[1])){var y=arguments[0],_=arguments[1];A.scroll(y,_,A.isRing(y))}else if(wr(arguments[0],_e)&&arguments[1]instanceof De){var I=arguments[0],U=arguments[1],re=A.indexOf(U,I);if(re<=0)return null;A.scroll(I,re)}}else if(arguments.length===3){var ye=arguments[0],Re=arguments[1],Ke=arguments[2];if(Re<=0)return null;for(var yt=ye.copy(),Zt=Ke?ye.size()-1:ye.size(),ur=0;ur<Zt;ur++)for(var Vr=0;Vr<ye.getDimension();Vr++)ye.setOrdinate(ur,Vr,yt.getOrdinate((Re+ur)%Zt,Vr));if(Ke)for(var gn=0;gn<ye.getDimension();gn++)ye.setOrdinate(Zt,gn,ye.getOrdinate(0,gn))}}},{key:"isEqual",value:function(y,_){var I=y.size();if(I!==_.size())return!1;for(var U=Math.min(y.getDimension(),_.getDimension()),re=0;re<I;re++)for(var ye=0;ye<U;ye++){var Re=y.getOrdinate(re,ye),Ke=_.getOrdinate(re,ye);if(y.getOrdinate(re,ye)!==_.getOrdinate(re,ye)&&(!Te.isNaN(Re)||!Te.isNaN(Ke)))return!1}return!0}},{key:"minCoordinateIndex",value:function(){if(arguments.length===1){var y=arguments[0];return A.minCoordinateIndex(y,0,y.size()-1)}if(arguments.length===3){for(var _=arguments[0],I=arguments[2],U=-1,re=null,ye=arguments[1];ye<=I;ye++){var Re=_.getCoordinate(ye);(re===null||re.compareTo(Re)>0)&&(re=Re,U=ye)}return U}}},{key:"extend",value:function(y,_,I){var U=y.create(I,_.getDimension()),re=_.size();if(A.copy(_,0,U,0,re),re>0)for(var ye=re;ye<I;ye++)A.copy(_,re-1,U,ye,1);return U}},{key:"reverse",value:function(y){for(var _=y.size()-1,I=Math.trunc(_/2),U=0;U<=I;U++)A.swap(y,U,_-U)}},{key:"swap",value:function(y,_,I){if(_===I)return null;for(var U=0;U<y.getDimension();U++){var re=y.getOrdinate(_,U);y.setOrdinate(_,U,y.getOrdinate(I,U)),y.setOrdinate(I,U,re)}}},{key:"copy",value:function(y,_,I,U,re){for(var ye=0;ye<re;ye++)A.copyCoord(y,_+ye,I,U+ye)}},{key:"ensureValidRing",value:function(y,_){var I=_.size();return I===0?_:I<=3?A.createClosedRing(y,_,4):_.getOrdinate(0,_e.X)===_.getOrdinate(I-1,_e.X)&&_.getOrdinate(0,_e.Y)===_.getOrdinate(I-1,_e.Y)?_:A.createClosedRing(y,_,I+1)}},{key:"indexOf",value:function(y,_){for(var I=0;I<_.size();I++)if(y.x===_.getOrdinate(I,_e.X)&&y.y===_.getOrdinate(I,_e.Y))return I;return-1}},{key:"createClosedRing",value:function(y,_,I){var U=y.create(I,_.getDimension()),re=_.size();A.copy(_,0,U,0,re);for(var ye=re;ye<I;ye++)A.copy(_,0,U,ye,1);return U}},{key:"minCoordinate",value:function(y){for(var _=null,I=0;I<y.size();I++){var U=y.getCoordinate(I);(_===null||_.compareTo(U)>0)&&(_=U)}return _}}])})(),ar=(function(){function A(){i(this,A)}return o(A,null,[{key:"toDimensionSymbol",value:function(y){switch(y){case A.FALSE:return A.SYM_FALSE;case A.TRUE:return A.SYM_TRUE;case A.DONTCARE:return A.SYM_DONTCARE;case A.P:return A.SYM_P;case A.L:return A.SYM_L;case A.A:return A.SYM_A}throw new z("Unknown dimension value: "+y)}},{key:"toDimensionValue",value:function(y){switch(Ar.toUpperCase(y)){case A.SYM_FALSE:return A.FALSE;case A.SYM_TRUE:return A.TRUE;case A.SYM_DONTCARE:return A.DONTCARE;case A.SYM_P:return A.P;case A.SYM_L:return A.L;case A.SYM_A:return A.A}throw new z("Unknown dimension symbol: "+y)}}])})();ar.P=0,ar.L=1,ar.A=2,ar.FALSE=-1,ar.TRUE=-2,ar.DONTCARE=-3,ar.SYM_FALSE="F",ar.SYM_TRUE="T",ar.SYM_DONTCARE="*",ar.SYM_P="0",ar.SYM_L="1",ar.SYM_A="2";var ti=(function(){return o((function A(){i(this,A)}),[{key:"filter",value:function(A){}}])})(),un=(function(){return o((function A(){i(this,A)}),[{key:"filter",value:function(A,y){}},{key:"isDone",value:function(){}},{key:"isGeometryChanged",value:function(){}}])})(),ri=(function(A){function y(){var _;return i(this,y),_=n(this,y),y.constructor_.apply(_,arguments),_}return g(y,A),o(y,[{key:"computeEnvelopeInternal",value:function(){return this.isEmpty()?new Ye:this._points.expandEnvelope(new Ye)}},{key:"isRing",value:function(){return this.isClosed()&&this.isSimple()}},{key:"getCoordinates",value:function(){return this._points.toCoordinateArray()}},{key:"copyInternal",value:function(){return new y(this._points.copy(),this._factory)}},{key:"equalsExact",value:function(){if(arguments.length===2&&typeof arguments[1]=="number"&&arguments[0]instanceof rt){var _=arguments[0],I=arguments[1];if(!this.isEquivalentClass(_))return!1;var U=_;if(this._points.size()!==U._points.size())return!1;for(var re=0;re<this._points.size();re++)if(!this.equal(this._points.getCoordinate(re),U._points.getCoordinate(re),I))return!1;return!0}return S(y,"equalsExact",this,1).apply(this,arguments)}},{key:"normalize",value:function(){for(var _=0;_<Math.trunc(this._points.size()/2);_++){var I=this._points.size()-1-_;if(!this._points.getCoordinate(_).equals(this._points.getCoordinate(I))){if(this._points.getCoordinate(_).compareTo(this._points.getCoordinate(I))>0){var U=this._points.copy();Jr.reverse(U),this._points=U}return null}}}},{key:"getCoordinate",value:function(){return this.isEmpty()?null:this._points.getCoordinate(0)}},{key:"getBoundaryDimension",value:function(){return this.isClosed()?ar.FALSE:0}},{key:"isClosed",value:function(){return!this.isEmpty()&&this.getCoordinateN(0).equals2D(this.getCoordinateN(this.getNumPoints()-1))}},{key:"reverseInternal",value:function(){var _=this._points.copy();return Jr.reverse(_),this.getFactory().createLineString(_)}},{key:"getEndPoint",value:function(){return this.isEmpty()?null:this.getPointN(this.getNumPoints()-1)}},{key:"getTypeCode",value:function(){return rt.TYPECODE_LINESTRING}},{key:"getDimension",value:function(){return 1}},{key:"getLength",value:function(){return Ur.ofLine(this._points)}},{key:"getNumPoints",value:function(){return this._points.size()}},{key:"compareToSameClass",value:function(){if(arguments.length===1){for(var _=arguments[0],I=0,U=0;I<this._points.size()&&U<_._points.size();){var re=this._points.getCoordinate(I).compareTo(_._points.getCoordinate(U));if(re!==0)return re;I++,U++}return I<this._points.size()?1:U<_._points.size()?-1:0}if(arguments.length===2){var ye=arguments[0];return arguments[1].compare(this._points,ye._points)}}},{key:"apply",value:function(){if(wr(arguments[0],Tr))for(var _=arguments[0],I=0;I<this._points.size();I++)_.filter(this._points.getCoordinate(I));else if(wr(arguments[0],un)){var U=arguments[0];if(this._points.size()===0)return null;for(var re=0;re<this._points.size()&&(U.filter(this._points,re),!U.isDone());re++);U.isGeometryChanged()&&this.geometryChanged()}else wr(arguments[0],ti)?arguments[0].filter(this):wr(arguments[0],B)&&arguments[0].filter(this)}},{key:"getBoundary",value:function(){throw new je}},{key:"isEquivalentClass",value:function(_){return _ instanceof y}},{key:"getCoordinateN",value:function(_){return this._points.getCoordinate(_)}},{key:"getGeometryType",value:function(){return rt.TYPENAME_LINESTRING}},{key:"getCoordinateSequence",value:function(){return this._points}},{key:"isEmpty",value:function(){return this._points.size()===0}},{key:"init",value:function(_){if(_===null&&(_=this.getFactory().getCoordinateSequenceFactory().create([])),_.size()===1)throw new z("Invalid number of points in LineString (found "+_.size()+" - must be 0 or >= 2)");this._points=_}},{key:"isCoordinate",value:function(_){for(var I=0;I<this._points.size();I++)if(this._points.getCoordinate(I).equals(_))return!0;return!1}},{key:"getStartPoint",value:function(){return this.isEmpty()?null:this.getPointN(0)}},{key:"getPointN",value:function(_){return this.getFactory().createPoint(this._points.getCoordinate(_))}},{key:"interfaces_",get:function(){return[Gr]}}],[{key:"constructor_",value:function(){if(this._points=null,arguments.length!==0){if(arguments.length===2){var _=arguments[0],I=arguments[1];rt.constructor_.call(this,I),this.init(_)}}}}])})(rt),Ae=o((function A(){i(this,A)})),Be=(function(A){function y(){var _;return i(this,y),_=n(this,y),y.constructor_.apply(_,arguments),_}return g(y,A),o(y,[{key:"computeEnvelopeInternal",value:function(){if(this.isEmpty())return new Ye;var _=new Ye;return _.expandToInclude(this._coordinates.getX(0),this._coordinates.getY(0)),_}},{key:"getCoordinates",value:function(){return this.isEmpty()?[]:[this.getCoordinate()]}},{key:"copyInternal",value:function(){return new y(this._coordinates.copy(),this._factory)}},{key:"equalsExact",value:function(){if(arguments.length===2&&typeof arguments[1]=="number"&&arguments[0]instanceof rt){var _=arguments[0],I=arguments[1];return!!this.isEquivalentClass(_)&&(!(!this.isEmpty()||!_.isEmpty())||this.isEmpty()===_.isEmpty()&&this.equal(_.getCoordinate(),this.getCoordinate(),I))}return S(y,"equalsExact",this,1).apply(this,arguments)}},{key:"normalize",value:function(){}},{key:"getCoordinate",value:function(){return this._coordinates.size()!==0?this._coordinates.getCoordinate(0):null}},{key:"getBoundaryDimension",value:function(){return ar.FALSE}},{key:"reverseInternal",value:function(){return this.getFactory().createPoint(this._coordinates.copy())}},{key:"getTypeCode",value:function(){return rt.TYPECODE_POINT}},{key:"getDimension",value:function(){return 0}},{key:"getNumPoints",value:function(){return this.isEmpty()?0:1}},{key:"getX",value:function(){if(this.getCoordinate()===null)throw new IllegalStateException("getX called on empty Point");return this.getCoordinate().x}},{key:"compareToSameClass",value:function(){if(arguments.length===1){var _=arguments[0];return this.getCoordinate().compareTo(_.getCoordinate())}if(arguments.length===2){var I=arguments[0];return arguments[1].compare(this._coordinates,I._coordinates)}}},{key:"apply",value:function(){if(wr(arguments[0],Tr)){var _=arguments[0];if(this.isEmpty())return null;_.filter(this.getCoordinate())}else if(wr(arguments[0],un)){var I=arguments[0];if(this.isEmpty())return null;I.filter(this._coordinates,0),I.isGeometryChanged()&&this.geometryChanged()}else wr(arguments[0],ti)?arguments[0].filter(this):wr(arguments[0],B)&&arguments[0].filter(this)}},{key:"getBoundary",value:function(){return this.getFactory().createGeometryCollection()}},{key:"getGeometryType",value:function(){return rt.TYPENAME_POINT}},{key:"getCoordinateSequence",value:function(){return this._coordinates}},{key:"getY",value:function(){if(this.getCoordinate()===null)throw new IllegalStateException("getY called on empty Point");return this.getCoordinate().y}},{key:"isEmpty",value:function(){return this._coordinates.size()===0}},{key:"init",value:function(_){_===null&&(_=this.getFactory().getCoordinateSequenceFactory().create([])),xe.isTrue(_.size()<=1),this._coordinates=_}},{key:"isSimple",value:function(){return!0}},{key:"interfaces_",get:function(){return[Ae]}}],[{key:"constructor_",value:function(){this._coordinates=null;var _=arguments[0],I=arguments[1];rt.constructor_.call(this,I),this.init(_)}}])})(rt),mt=(function(){function A(){i(this,A)}return o(A,null,[{key:"ofRing",value:function(){if(arguments[0]instanceof Array){var y=arguments[0];return Math.abs(A.ofRingSigned(y))}if(wr(arguments[0],_e)){var _=arguments[0];return Math.abs(A.ofRingSigned(_))}}},{key:"ofRingSigned",value:function(){if(arguments[0]instanceof Array){var y=arguments[0];if(y.length<3)return 0;for(var _=0,I=y[0].x,U=1;U<y.length-1;U++){var re=y[U].x-I,ye=y[U+1].y;_+=re*(y[U-1].y-ye)}return _/2}if(wr(arguments[0],_e)){var Re=arguments[0],Ke=Re.size();if(Ke<3)return 0;var yt=new De,Zt=new De,ur=new De;Re.getCoordinate(0,Zt),Re.getCoordinate(1,ur);var Vr=Zt.x;ur.x-=Vr;for(var gn=0,Rn=1;Rn<Ke-1;Rn++)yt.y=Zt.y,Zt.x=ur.x,Zt.y=ur.y,Re.getCoordinate(Rn+1,ur),ur.x-=Vr,gn+=Zt.x*(yt.y-ur.y);return gn/2}}}])})(),pt=(function(){return o((function A(){i(this,A)}),null,[{key:"sort",value:function(){var A=arguments,y=arguments[0];if(arguments.length===1)y.sort((function(Vr,gn){return Vr.compareTo(gn)}));else if(arguments.length===2)y.sort((function(Vr,gn){return A[1].compare(Vr,gn)}));else if(arguments.length===3){var _=y.slice(arguments[1],arguments[2]);_.sort();var I=y.slice(0,arguments[1]).concat(_,y.slice(arguments[2],y.length));y.splice(0,y.length);var U,re=u(I);try{for(re.s();!(U=re.n()).done;){var ye=U.value;y.push(ye)}}catch(Vr){re.e(Vr)}finally{re.f()}}else if(arguments.length===4){var Re=y.slice(arguments[1],arguments[2]);Re.sort((function(Vr,gn){return A[3].compare(Vr,gn)}));var Ke=y.slice(0,arguments[1]).concat(Re,y.slice(arguments[2],y.length));y.splice(0,y.length);var yt,Zt=u(Ke);try{for(Zt.s();!(yt=Zt.n()).done;){var ur=yt.value;y.push(ur)}}catch(Vr){Zt.e(Vr)}finally{Zt.f()}}}},{key:"asList",value:function(A){var y,_=new et,I=u(A);try{for(I.s();!(y=I.n()).done;){var U=y.value;_.add(U)}}catch(re){I.e(re)}finally{I.f()}return _}},{key:"copyOf",value:function(A,y){return A.slice(0,y)}}])})(),Ir=o((function A(){i(this,A)})),Fr=(function(A){function y(){var _;return i(this,y),_=n(this,y),y.constructor_.apply(_,arguments),_}return g(y,A),o(y,[{key:"computeEnvelopeInternal",value:function(){return this._shell.getEnvelopeInternal()}},{key:"getCoordinates",value:function(){if(this.isEmpty())return[];for(var _=new Array(this.getNumPoints()).fill(null),I=-1,U=this._shell.getCoordinates(),re=0;re<U.length;re++)_[++I]=U[re];for(var ye=0;ye<this._holes.length;ye++)for(var Re=this._holes[ye].getCoordinates(),Ke=0;Ke<Re.length;Ke++)_[++I]=Re[Ke];return _}},{key:"getArea",value:function(){var _=0;_+=mt.ofRing(this._shell.getCoordinateSequence());for(var I=0;I<this._holes.length;I++)_-=mt.ofRing(this._holes[I].getCoordinateSequence());return _}},{key:"copyInternal",value:function(){for(var _=this._shell.copy(),I=new Array(this._holes.length).fill(null),U=0;U<this._holes.length;U++)I[U]=this._holes[U].copy();return new y(_,I,this._factory)}},{key:"isRectangle",value:function(){if(this.getNumInteriorRing()!==0||this._shell===null||this._shell.getNumPoints()!==5)return!1;for(var _=this._shell.getCoordinateSequence(),I=this.getEnvelopeInternal(),U=0;U<5;U++){var re=_.getX(U);if(re!==I.getMinX()&&re!==I.getMaxX())return!1;var ye=_.getY(U);if(ye!==I.getMinY()&&ye!==I.getMaxY())return!1}for(var Re=_.getX(0),Ke=_.getY(0),yt=1;yt<=4;yt++){var Zt=_.getX(yt),ur=_.getY(yt);if(Zt!==Re==(ur!==Ke))return!1;Re=Zt,Ke=ur}return!0}},{key:"equalsExact",value:function(){if(arguments.length===2&&typeof arguments[1]=="number"&&arguments[0]instanceof rt){var _=arguments[0],I=arguments[1];if(!this.isEquivalentClass(_))return!1;var U=_,re=this._shell,ye=U._shell;if(!re.equalsExact(ye,I)||this._holes.length!==U._holes.length)return!1;for(var Re=0;Re<this._holes.length;Re++)if(!this._holes[Re].equalsExact(U._holes[Re],I))return!1;return!0}return S(y,"equalsExact",this,1).apply(this,arguments)}},{key:"normalize",value:function(){if(arguments.length===0){this._shell=this.normalized(this._shell,!0);for(var _=0;_<this._holes.length;_++)this._holes[_]=this.normalized(this._holes[_],!1);pt.sort(this._holes)}else if(arguments.length===2){var I=arguments[0],U=arguments[1];if(I.isEmpty())return null;var re=I.getCoordinateSequence(),ye=Jr.minCoordinateIndex(re,0,re.size()-2);Jr.scroll(re,ye,!0),be.isCCW(re)===U&&Jr.reverse(re)}}},{key:"getCoordinate",value:function(){return this._shell.getCoordinate()}},{key:"getNumInteriorRing",value:function(){return this._holes.length}},{key:"getBoundaryDimension",value:function(){return 1}},{key:"reverseInternal",value:function(){for(var _=this.getExteriorRing().reverse(),I=new Array(this.getNumInteriorRing()).fill(null),U=0;U<I.length;U++)I[U]=this.getInteriorRingN(U).reverse();return this.getFactory().createPolygon(_,I)}},{key:"getTypeCode",value:function(){return rt.TYPECODE_POLYGON}},{key:"getDimension",value:function(){return 2}},{key:"getLength",value:function(){var _=0;_+=this._shell.getLength();for(var I=0;I<this._holes.length;I++)_+=this._holes[I].getLength();return _}},{key:"getNumPoints",value:function(){for(var _=this._shell.getNumPoints(),I=0;I<this._holes.length;I++)_+=this._holes[I].getNumPoints();return _}},{key:"convexHull",value:function(){return this.getExteriorRing().convexHull()}},{key:"normalized",value:function(_,I){var U=_.copy();return this.normalize(U,I),U}},{key:"compareToSameClass",value:function(){if(arguments.length===1){var _=arguments[0],I=this._shell,U=_._shell;return I.compareToSameClass(U)}if(arguments.length===2){var re=arguments[1],ye=arguments[0],Re=this._shell,Ke=ye._shell,yt=Re.compareToSameClass(Ke,re);if(yt!==0)return yt;for(var Zt=this.getNumInteriorRing(),ur=ye.getNumInteriorRing(),Vr=0;Vr<Zt&&Vr<ur;){var gn=this.getInteriorRingN(Vr),Rn=ye.getInteriorRingN(Vr),Vn=gn.compareToSameClass(Rn,re);if(Vn!==0)return Vn;Vr++}return Vr<Zt?1:Vr<ur?-1:0}}},{key:"apply",value:function(){if(wr(arguments[0],Tr)){var _=arguments[0];this._shell.apply(_);for(var I=0;I<this._holes.length;I++)this._holes[I].apply(_)}else if(wr(arguments[0],un)){var U=arguments[0];if(this._shell.apply(U),!U.isDone())for(var re=0;re<this._holes.length&&(this._holes[re].apply(U),!U.isDone());re++);U.isGeometryChanged()&&this.geometryChanged()}else if(wr(arguments[0],ti))arguments[0].filter(this);else if(wr(arguments[0],B)){var ye=arguments[0];ye.filter(this),this._shell.apply(ye);for(var Re=0;Re<this._holes.length;Re++)this._holes[Re].apply(ye)}}},{key:"getBoundary",value:function(){if(this.isEmpty())return this.getFactory().createMultiLineString();var _=new Array(this._holes.length+1).fill(null);_[0]=this._shell;for(var I=0;I<this._holes.length;I++)_[I+1]=this._holes[I];return _.length<=1?this.getFactory().createLinearRing(_[0].getCoordinateSequence()):this.getFactory().createMultiLineString(_)}},{key:"getGeometryType",value:function(){return rt.TYPENAME_POLYGON}},{key:"getExteriorRing",value:function(){return this._shell}},{key:"isEmpty",value:function(){return this._shell.isEmpty()}},{key:"getInteriorRingN",value:function(_){return this._holes[_]}},{key:"interfaces_",get:function(){return[Ir]}}],[{key:"constructor_",value:function(){this._shell=null,this._holes=null;var _=arguments[0],I=arguments[1],U=arguments[2];if(rt.constructor_.call(this,U),_===null&&(_=this.getFactory().createLinearRing()),I===null&&(I=[]),rt.hasNullElements(I))throw new z("holes must not contain null elements");if(_.isEmpty()&&rt.hasNonEmptyElements(I))throw new z("shell is empty but holes are not");this._shell=_,this._holes=I}}])})(rt),qn=(function(A){function y(){return i(this,y),n(this,y,arguments)}return g(y,A),o(y)})(Xt),Oi=(function(A){function y(_){var I;return i(this,y),(I=n(this,y)).array=[],_ instanceof Mt&&I.addAll(_),I}return g(y,A),o(y,[{key:"contains",value:function(_){var I,U=u(this.array);try{for(U.s();!(I=U.n()).done;)if(I.value.compareTo(_)===0)return!0}catch(re){U.e(re)}finally{U.f()}return!1}},{key:"add",value:function(_){if(this.contains(_))return!1;for(var I=0,U=this.array.length;I<U;I++)if(this.array[I].compareTo(_)===1)return!!this.array.splice(I,0,_);return this.array.push(_),!0}},{key:"addAll",value:function(_){var I,U=u(_);try{for(U.s();!(I=U.n()).done;){var re=I.value;this.add(re)}}catch(ye){U.e(ye)}finally{U.f()}return!0}},{key:"remove",value:function(){throw new je}},{key:"size",value:function(){return this.array.length}},{key:"isEmpty",value:function(){return this.array.length===0}},{key:"toArray",value:function(){return this.array.slice()}},{key:"iterator",value:function(){return new zr(this.array)}}])})(qn),zr=(function(){return o((function A(y){i(this,A),this.array=y,this.position=0}),[{key:"next",value:function(){if(this.position===this.array.length)throw new at;return this.array[this.position++]}},{key:"hasNext",value:function(){return this.position<this.array.length}},{key:"remove",value:function(){throw new je}}])})(),bn=(function(A){function y(){var _;return i(this,y),_=n(this,y),y.constructor_.apply(_,arguments),_}return g(y,A),o(y,[{key:"computeEnvelopeInternal",value:function(){for(var _=new Ye,I=0;I<this._geometries.length;I++)_.expandToInclude(this._geometries[I].getEnvelopeInternal());return _}},{key:"getGeometryN",value:function(_){return this._geometries[_]}},{key:"getCoordinates",value:function(){for(var _=new Array(this.getNumPoints()).fill(null),I=-1,U=0;U<this._geometries.length;U++)for(var re=this._geometries[U].getCoordinates(),ye=0;ye<re.length;ye++)_[++I]=re[ye];return _}},{key:"getArea",value:function(){for(var _=0,I=0;I<this._geometries.length;I++)_+=this._geometries[I].getArea();return _}},{key:"copyInternal",value:function(){for(var _=new Array(this._geometries.length).fill(null),I=0;I<_.length;I++)_[I]=this._geometries[I].copy();return new y(_,this._factory)}},{key:"equalsExact",value:function(){if(arguments.length===2&&typeof arguments[1]=="number"&&arguments[0]instanceof rt){var _=arguments[0],I=arguments[1];if(!this.isEquivalentClass(_))return!1;var U=_;if(this._geometries.length!==U._geometries.length)return!1;for(var re=0;re<this._geometries.length;re++)if(!this._geometries[re].equalsExact(U._geometries[re],I))return!1;return!0}return S(y,"equalsExact",this,1).apply(this,arguments)}},{key:"normalize",value:function(){for(var _=0;_<this._geometries.length;_++)this._geometries[_].normalize();pt.sort(this._geometries)}},{key:"getCoordinate",value:function(){return this.isEmpty()?null:this._geometries[0].getCoordinate()}},{key:"getBoundaryDimension",value:function(){for(var _=ar.FALSE,I=0;I<this._geometries.length;I++)_=Math.max(_,this._geometries[I].getBoundaryDimension());return _}},{key:"reverseInternal",value:function(){for(var _=this._geometries.length,I=new et(_),U=0;U<_;U++)I.add(this._geometries[U].reverse());return this.getFactory().buildGeometry(I)}},{key:"getTypeCode",value:function(){return rt.TYPECODE_GEOMETRYCOLLECTION}},{key:"getDimension",value:function(){for(var _=ar.FALSE,I=0;I<this._geometries.length;I++)_=Math.max(_,this._geometries[I].getDimension());return _}},{key:"getLength",value:function(){for(var _=0,I=0;I<this._geometries.length;I++)_+=this._geometries[I].getLength();return _}},{key:"getNumPoints",value:function(){for(var _=0,I=0;I<this._geometries.length;I++)_+=this._geometries[I].getNumPoints();return _}},{key:"getNumGeometries",value:function(){return this._geometries.length}},{key:"compareToSameClass",value:function(){if(arguments.length===1){var _=arguments[0],I=new Oi(pt.asList(this._geometries)),U=new Oi(pt.asList(_._geometries));return this.compare(I,U)}if(arguments.length===2){for(var re=arguments[1],ye=arguments[0],Re=this.getNumGeometries(),Ke=ye.getNumGeometries(),yt=0;yt<Re&&yt<Ke;){var Zt=this.getGeometryN(yt),ur=ye.getGeometryN(yt),Vr=Zt.compareToSameClass(ur,re);if(Vr!==0)return Vr;yt++}return yt<Re?1:yt<Ke?-1:0}}},{key:"apply",value:function(){if(wr(arguments[0],Tr))for(var _=arguments[0],I=0;I<this._geometries.length;I++)this._geometries[I].apply(_);else if(wr(arguments[0],un)){var U=arguments[0];if(this._geometries.length===0)return null;for(var re=0;re<this._geometries.length&&(this._geometries[re].apply(U),!U.isDone());re++);U.isGeometryChanged()&&this.geometryChanged()}else if(wr(arguments[0],ti)){var ye=arguments[0];ye.filter(this);for(var Re=0;Re<this._geometries.length;Re++)this._geometries[Re].apply(ye)}else if(wr(arguments[0],B)){var Ke=arguments[0];Ke.filter(this);for(var yt=0;yt<this._geometries.length;yt++)this._geometries[yt].apply(Ke)}}},{key:"getBoundary",value:function(){return rt.checkNotGeometryCollection(this),xe.shouldNeverReachHere(),null}},{key:"getGeometryType",value:function(){return rt.TYPENAME_GEOMETRYCOLLECTION}},{key:"isEmpty",value:function(){for(var _=0;_<this._geometries.length;_++)if(!this._geometries[_].isEmpty())return!1;return!0}}],[{key:"constructor_",value:function(){if(this._geometries=null,arguments.length!==0){if(arguments.length===2){var _=arguments[0],I=arguments[1];if(rt.constructor_.call(this,I),_===null&&(_=[]),rt.hasNullElements(_))throw new z("geometries must not contain null elements");this._geometries=_}}}}])})(rt),Tn=(function(A){function y(){var _;return i(this,y),_=n(this,y),y.constructor_.apply(_,arguments),_}return g(y,A),o(y,[{key:"copyInternal",value:function(){for(var _=new Array(this._geometries.length).fill(null),I=0;I<_.length;I++)_[I]=this._geometries[I].copy();return new y(_,this._factory)}},{key:"isValid",value:function(){return!0}},{key:"equalsExact",value:function(){if(arguments.length===2&&typeof arguments[1]=="number"&&arguments[0]instanceof rt){var _=arguments[0],I=arguments[1];return!!this.isEquivalentClass(_)&&S(y,"equalsExact",this,1).call(this,_,I)}return S(y,"equalsExact",this,1).apply(this,arguments)}},{key:"getCoordinate",value:function(){if(arguments.length===1&&Number.isInteger(arguments[0])){var _=arguments[0];return this._geometries[_].getCoordinate()}return S(y,"getCoordinate",this,1).apply(this,arguments)}},{key:"getBoundaryDimension",value:function(){return ar.FALSE}},{key:"getTypeCode",value:function(){return rt.TYPECODE_MULTIPOINT}},{key:"getDimension",value:function(){return 0}},{key:"getBoundary",value:function(){return this.getFactory().createGeometryCollection()}},{key:"getGeometryType",value:function(){return rt.TYPENAME_MULTIPOINT}},{key:"interfaces_",get:function(){return[Ae]}}],[{key:"constructor_",value:function(){var _=arguments[0],I=arguments[1];bn.constructor_.call(this,_,I)}}])})(bn),Mi=(function(A){function y(){var _;return i(this,y),_=n(this,y),y.constructor_.apply(_,arguments),_}return g(y,A),o(y,[{key:"copyInternal",value:function(){return new y(this._points.copy(),this._factory)}},{key:"getBoundaryDimension",value:function(){return ar.FALSE}},{key:"isClosed",value:function(){return!!this.isEmpty()||S(y,"isClosed",this,1).call(this)}},{key:"reverseInternal",value:function(){var _=this._points.copy();return Jr.reverse(_),this.getFactory().createLinearRing(_)}},{key:"getTypeCode",value:function(){return rt.TYPECODE_LINEARRING}},{key:"validateConstruction",value:function(){if(!this.isEmpty()&&!S(y,"isClosed",this,1).call(this))throw new z("Points of LinearRing do not form a closed linestring");if(this.getCoordinateSequence().size()>=1&&this.getCoordinateSequence().size()<y.MINIMUM_VALID_SIZE)throw new z("Invalid number of points in LinearRing (found "+this.getCoordinateSequence().size()+" - must be 0 or >= 4)")}},{key:"getGeometryType",value:function(){return rt.TYPENAME_LINEARRING}}],[{key:"constructor_",value:function(){var _=arguments[0],I=arguments[1];ri.constructor_.call(this,_,I),this.validateConstruction()}}])})(ri);Mi.MINIMUM_VALID_SIZE=4;var pi=(function(A){function y(){var _;return i(this,y),_=n(this,y),y.constructor_.apply(_,arguments),_}return g(y,A),o(y,[{key:"setOrdinate",value:function(_,I){switch(_){case y.X:this.x=I;break;case y.Y:this.y=I;break;default:throw new z("Invalid ordinate index: "+_)}}},{key:"getZ",value:function(){return De.NULL_ORDINATE}},{key:"getOrdinate",value:function(_){switch(_){case y.X:return this.x;case y.Y:return this.y}throw new z("Invalid ordinate index: "+_)}},{key:"setZ",value:function(_){throw new z("CoordinateXY dimension 2 does not support z-ordinate")}},{key:"copy",value:function(){return new y(this)}},{key:"toString",value:function(){return"("+this.x+", "+this.y+")"}},{key:"setCoordinate",value:function(_){this.x=_.x,this.y=_.y,this.z=_.getZ()}}],[{key:"constructor_",value:function(){if(arguments.length===0)De.constructor_.call(this);else if(arguments.length===1){if(arguments[0]instanceof y){var _=arguments[0];De.constructor_.call(this,_.x,_.y)}else if(arguments[0]instanceof De){var I=arguments[0];De.constructor_.call(this,I.x,I.y)}}else if(arguments.length===2){var U=arguments[0],re=arguments[1];De.constructor_.call(this,U,re,De.NULL_ORDINATE)}}}])})(De);pi.X=0,pi.Y=1,pi.Z=-1,pi.M=-1;var Wi=(function(A){function y(){var _;return i(this,y),_=n(this,y),y.constructor_.apply(_,arguments),_}return g(y,A),o(y,[{key:"getM",value:function(){return this._m}},{key:"setOrdinate",value:function(_,I){switch(_){case y.X:this.x=I;break;case y.Y:this.y=I;break;case y.M:this._m=I;break;default:throw new z("Invalid ordinate index: "+_)}}},{key:"setM",value:function(_){this._m=_}},{key:"getZ",value:function(){return De.NULL_ORDINATE}},{key:"getOrdinate",value:function(_){switch(_){case y.X:return this.x;case y.Y:return this.y;case y.M:return this._m}throw new z("Invalid ordinate index: "+_)}},{key:"setZ",value:function(_){throw new z("CoordinateXY dimension 2 does not support z-ordinate")}},{key:"copy",value:function(){return new y(this)}},{key:"toString",value:function(){return"("+this.x+", "+this.y+" m="+this.getM()+")"}},{key:"setCoordinate",value:function(_){this.x=_.x,this.y=_.y,this.z=_.getZ(),this._m=_.getM()}}],[{key:"constructor_",value:function(){if(this._m=null,arguments.length===0)De.constructor_.call(this),this._m=0;else if(arguments.length===1){if(arguments[0]instanceof y){var _=arguments[0];De.constructor_.call(this,_.x,_.y),this._m=_._m}else if(arguments[0]instanceof De){var I=arguments[0];De.constructor_.call(this,I.x,I.y),this._m=this.getM()}}else if(arguments.length===3){var U=arguments[0],re=arguments[1],ye=arguments[2];De.constructor_.call(this,U,re,De.NULL_ORDINATE),this._m=ye}}}])})(De);Wi.X=0,Wi.Y=1,Wi.Z=-1,Wi.M=2;var Fn=(function(A){function y(){var _;return i(this,y),_=n(this,y),y.constructor_.apply(_,arguments),_}return g(y,A),o(y,[{key:"getM",value:function(){return this._m}},{key:"setOrdinate",value:function(_,I){switch(_){case De.X:this.x=I;break;case De.Y:this.y=I;break;case De.Z:this.z=I;break;case De.M:this._m=I;break;default:throw new z("Invalid ordinate index: "+_)}}},{key:"setM",value:function(_){this._m=_}},{key:"getOrdinate",value:function(_){switch(_){case De.X:return this.x;case De.Y:return this.y;case De.Z:return this.getZ();case De.M:return this.getM()}throw new z("Invalid ordinate index: "+_)}},{key:"copy",value:function(){return new y(this)}},{key:"toString",value:function(){return"("+this.x+", "+this.y+", "+this.getZ()+" m="+this.getM()+")"}},{key:"setCoordinate",value:function(_){this.x=_.x,this.y=_.y,this.z=_.getZ(),this._m=_.getM()}}],[{key:"constructor_",value:function(){if(this._m=null,arguments.length===0)De.constructor_.call(this),this._m=0;else if(arguments.length===1){if(arguments[0]instanceof y){var _=arguments[0];De.constructor_.call(this,_),this._m=_._m}else if(arguments[0]instanceof De){var I=arguments[0];De.constructor_.call(this,I),this._m=this.getM()}}else if(arguments.length===4){var U=arguments[0],re=arguments[1],ye=arguments[2],Re=arguments[3];De.constructor_.call(this,U,re,ye),this._m=Re}}}])})(De),Ia=(function(){function A(){i(this,A)}return o(A,null,[{key:"measures",value:function(y){return y instanceof pi?0:y instanceof Wi||y instanceof Fn?1:0}},{key:"dimension",value:function(y){return y instanceof pi?2:y instanceof Wi?3:y instanceof Fn?4:3}},{key:"create",value:function(){if(arguments.length===1){var y=arguments[0];return A.create(y,0)}if(arguments.length===2){var _=arguments[0],I=arguments[1];return _===2?new pi:_===3&&I===0?new De:_===3&&I===1?new Wi:_===4&&I===1?new Fn:new De}}}])})(),ma=(function(A){function y(){var _;return i(this,y),_=n(this,y),y.constructor_.apply(_,arguments),_}return g(y,A),o(y,[{key:"getCoordinate",value:function(_){return this.get(_)}},{key:"addAll",value:function(){if(arguments.length===2&&typeof arguments[1]=="boolean"&&wr(arguments[0],Mt)){for(var _=arguments[1],I=!1,U=arguments[0].iterator();U.hasNext();)this.add(U.next(),_),I=!0;return I}return S(y,"addAll",this,1).apply(this,arguments)}},{key:"clone",value:function(){for(var _=S(y,"clone",this,1).call(this),I=0;I<this.size();I++)_.add(I,this.get(I).clone());return _}},{key:"toCoordinateArray",value:function(){if(arguments.length===0)return this.toArray(y.coordArrayType);if(arguments.length===1){if(arguments[0])return this.toArray(y.coordArrayType);for(var _=this.size(),I=new Array(_).fill(null),U=0;U<_;U++)I[U]=this.get(_-U-1);return I}}},{key:"add",value:function(){if(arguments.length===1){var _=arguments[0];return S(y,"add",this,1).call(this,_)}if(arguments.length===2){if(arguments[0]instanceof Array&&typeof arguments[1]=="boolean"){var I=arguments[0],U=arguments[1];return this.add(I,U,!0),!0}if(arguments[0]instanceof De&&typeof arguments[1]=="boolean"){var re=arguments[0];if(!arguments[1]&&this.size()>=1&&this.get(this.size()-1).equals2D(re))return null;S(y,"add",this,1).call(this,re)}else if(arguments[0]instanceof Object&&typeof arguments[1]=="boolean"){var ye=arguments[0],Re=arguments[1];return this.add(ye,Re),!0}}else if(arguments.length===3){if(typeof arguments[2]=="boolean"&&arguments[0]instanceof Array&&typeof arguments[1]=="boolean"){var Ke=arguments[0],yt=arguments[1];if(arguments[2])for(var Zt=0;Zt<Ke.length;Zt++)this.add(Ke[Zt],yt);else for(var ur=Ke.length-1;ur>=0;ur--)this.add(Ke[ur],yt);return!0}if(typeof arguments[2]=="boolean"&&Number.isInteger(arguments[0])&&arguments[1]instanceof De){var Vr=arguments[0],gn=arguments[1];if(!arguments[2]){var Rn=this.size();if(Rn>0&&(Vr>0&&this.get(Vr-1).equals2D(gn)||Vr<Rn&&this.get(Vr).equals2D(gn)))return null}S(y,"add",this,1).call(this,Vr,gn)}}else if(arguments.length===4){var Vn=arguments[0],In=arguments[1],Dn=arguments[2],Qi=arguments[3],ia=1;Dn>Qi&&(ia=-1);for(var Ta=Dn;Ta!==Qi;Ta+=ia)this.add(Vn[Ta],In);return!0}}},{key:"closeRing",value:function(){if(this.size()>0){var _=this.get(0).copy();this.add(_,!1)}}}],[{key:"constructor_",value:function(){if(arguments.length!==0){if(arguments.length===1){var _=arguments[0];this.ensureCapacity(_.length),this.add(_,!0)}else if(arguments.length===2){var I=arguments[0],U=arguments[1];this.ensureCapacity(I.length),this.add(I,U)}}}}])})(et);ma.coordArrayType=new Array(0).fill(null);var Gi=(function(){function A(){i(this,A)}return o(A,null,[{key:"isRing",value:function(y){return!(y.length<4)&&!!y[0].equals2D(y[y.length-1])}},{key:"ptNotInList",value:function(y,_){for(var I=0;I<y.length;I++){var U=y[I];if(A.indexOf(U,_)<0)return U}return null}},{key:"scroll",value:function(y,_){var I=A.indexOf(_,y);if(I<0)return null;var U=new Array(y.length).fill(null);Jt.arraycopy(y,I,U,0,y.length-I),Jt.arraycopy(y,0,U,y.length-I,I),Jt.arraycopy(U,0,y,0,y.length)}},{key:"equals",value:function(){if(arguments.length===2){var y=arguments[0],_=arguments[1];if(y===_)return!0;if(y===null||_===null||y.length!==_.length)return!1;for(var I=0;I<y.length;I++)if(!y[I].equals(_[I]))return!1;return!0}if(arguments.length===3){var U=arguments[0],re=arguments[1],ye=arguments[2];if(U===re)return!0;if(U===null||re===null||U.length!==re.length)return!1;for(var Re=0;Re<U.length;Re++)if(ye.compare(U[Re],re[Re])!==0)return!1;return!0}}},{key:"intersection",value:function(y,_){for(var I=new ma,U=0;U<y.length;U++)_.intersects(y[U])&&I.add(y[U],!0);return I.toCoordinateArray()}},{key:"measures",value:function(y){if(y===null||y.length===0)return 0;var _,I=0,U=u(y);try{for(U.s();!(_=U.n()).done;){var re=_.value;I=Math.max(I,Ia.measures(re))}}catch(ye){U.e(ye)}finally{U.f()}return I}},{key:"hasRepeatedPoints",value:function(y){for(var _=1;_<y.length;_++)if(y[_-1].equals(y[_]))return!0;return!1}},{key:"removeRepeatedPoints",value:function(y){return A.hasRepeatedPoints(y)?new ma(y,!1).toCoordinateArray():y}},{key:"reverse",value:function(y){for(var _=y.length-1,I=Math.trunc(_/2),U=0;U<=I;U++){var re=y[U];y[U]=y[_-U],y[_-U]=re}}},{key:"removeNull",value:function(y){for(var _=0,I=0;I<y.length;I++)y[I]!==null&&_++;var U=new Array(_).fill(null);if(_===0)return U;for(var re=0,ye=0;ye<y.length;ye++)y[ye]!==null&&(U[re++]=y[ye]);return U}},{key:"copyDeep",value:function(){if(arguments.length===1){for(var y=arguments[0],_=new Array(y.length).fill(null),I=0;I<y.length;I++)_[I]=y[I].copy();return _}if(arguments.length===5)for(var U=arguments[0],re=arguments[1],ye=arguments[2],Re=arguments[3],Ke=arguments[4],yt=0;yt<Ke;yt++)ye[Re+yt]=U[re+yt].copy()}},{key:"isEqualReversed",value:function(y,_){for(var I=0;I<y.length;I++){var U=y[I],re=_[y.length-I-1];if(U.compareTo(re)!==0)return!1}return!0}},{key:"envelope",value:function(y){for(var _=new Ye,I=0;I<y.length;I++)_.expandToInclude(y[I]);return _}},{key:"toCoordinateArray",value:function(y){return y.toArray(A.coordArrayType)}},{key:"dimension",value:function(y){if(y===null||y.length===0)return 3;var _,I=0,U=u(y);try{for(U.s();!(_=U.n()).done;){var re=_.value;I=Math.max(I,Ia.dimension(re))}}catch(ye){U.e(ye)}finally{U.f()}return I}},{key:"atLeastNCoordinatesOrNothing",value:function(y,_){return _.length>=y?_:[]}},{key:"indexOf",value:function(y,_){for(var I=0;I<_.length;I++)if(y.equals(_[I]))return I;return-1}},{key:"increasingDirection",value:function(y){for(var _=0;_<Math.trunc(y.length/2);_++){var I=y.length-1-_,U=y[_].compareTo(y[I]);if(U!==0)return U}return 1}},{key:"compare",value:function(y,_){for(var I=0;I<y.length&&I<_.length;){var U=y[I].compareTo(_[I]);if(U!==0)return U;I++}return I<_.length?-1:I<y.length?1:0}},{key:"minCoordinate",value:function(y){for(var _=null,I=0;I<y.length;I++)(_===null||_.compareTo(y[I])>0)&&(_=y[I]);return _}},{key:"extract",value:function(y,_,I){_=Kt.clamp(_,0,y.length);var U=(I=Kt.clamp(I,-1,y.length))-_+1;I<0&&(U=0),_>=y.length&&(U=0),I<_&&(U=0);var re=new Array(U).fill(null);if(U===0)return re;for(var ye=0,Re=_;Re<=I;Re++)re[ye++]=y[Re];return re}}])})(),Ka=(function(){return o((function A(){i(this,A)}),[{key:"compare",value:function(A,y){var _=A,I=y;return Gi.compare(_,I)}},{key:"interfaces_",get:function(){return[ke]}}])})(),xa=(function(){return o((function A(){i(this,A)}),[{key:"compare",value:function(A,y){var _=A,I=y;if(_.length<I.length)return-1;if(_.length>I.length)return 1;if(_.length===0)return 0;var U=Gi.compare(_,I);return Gi.isEqualReversed(_,I)?0:U}},{key:"OLDcompare",value:function(A,y){var _=A,I=y;if(_.length<I.length)return-1;if(_.length>I.length)return 1;if(_.length===0)return 0;for(var U=Gi.increasingDirection(_),re=Gi.increasingDirection(I),ye=U>0?0:_.length-1,Re=re>0?0:_.length-1,Ke=0;Ke<_.length;Ke++){var yt=_[ye].compareTo(I[Re]);if(yt!==0)return yt;ye+=U,Re+=re}return 0}},{key:"interfaces_",get:function(){return[ke]}}])})();Gi.ForwardComparator=Ka,Gi.BidirectionalComparator=xa,Gi.coordArrayType=new Array(0).fill(null);var Ui=(function(){return o((function A(y){i(this,A),this.str=y}),[{key:"append",value:function(A){this.str+=A}},{key:"setCharAt",value:function(A,y){this.str=this.str.substr(0,A)+y+this.str.substr(A+1)}},{key:"toString",value:function(){return this.str}}])})(),oo=(function(){function A(){i(this,A),A.constructor_.apply(this,arguments)}return o(A,[{key:"getM",value:function(y){return this.hasM()?this._coordinates[y].getM():Te.NaN}},{key:"setOrdinate",value:function(y,_,I){switch(_){case _e.X:this._coordinates[y].x=I;break;case _e.Y:this._coordinates[y].y=I;break;default:this._coordinates[y].setOrdinate(_,I)}}},{key:"getZ",value:function(y){return this.hasZ()?this._coordinates[y].getZ():Te.NaN}},{key:"size",value:function(){return this._coordinates.length}},{key:"getOrdinate",value:function(y,_){switch(_){case _e.X:return this._coordinates[y].x;case _e.Y:return this._coordinates[y].y;default:return this._coordinates[y].getOrdinate(_)}}},{key:"getCoordinate",value:function(){if(arguments.length===1){var y=arguments[0];return this._coordinates[y]}if(arguments.length===2){var _=arguments[0];arguments[1].setCoordinate(this._coordinates[_])}}},{key:"getCoordinateCopy",value:function(y){var _=this.createCoordinate();return _.setCoordinate(this._coordinates[y]),_}},{key:"createCoordinate",value:function(){return Ia.create(this.getDimension(),this.getMeasures())}},{key:"getDimension",value:function(){return this._dimension}},{key:"getX",value:function(y){return this._coordinates[y].x}},{key:"getMeasures",value:function(){return this._measures}},{key:"expandEnvelope",value:function(y){for(var _=0;_<this._coordinates.length;_++)y.expandToInclude(this._coordinates[_]);return y}},{key:"copy",value:function(){for(var y=new Array(this.size()).fill(null),_=0;_<this._coordinates.length;_++){var I=this.createCoordinate();I.setCoordinate(this._coordinates[_]),y[_]=I}return new A(y,this._dimension,this._measures)}},{key:"toString",value:function(){if(this._coordinates.length>0){var y=new Ui(17*this._coordinates.length);y.append("("),y.append(this._coordinates[0]);for(var _=1;_<this._coordinates.length;_++)y.append(", "),y.append(this._coordinates[_]);return y.append(")"),y.toString()}return"()"}},{key:"getY",value:function(y){return this._coordinates[y].y}},{key:"toCoordinateArray",value:function(){return this._coordinates}},{key:"interfaces_",get:function(){return[_e,G]}}],[{key:"constructor_",value:function(){if(this._dimension=3,this._measures=0,this._coordinates=null,arguments.length===1){if(arguments[0]instanceof Array){var y=arguments[0];A.constructor_.call(this,y,Gi.dimension(y),Gi.measures(y))}else if(Number.isInteger(arguments[0])){var _=arguments[0];this._coordinates=new Array(_).fill(null);for(var I=0;I<_;I++)this._coordinates[I]=new De}else if(wr(arguments[0],_e)){var U=arguments[0];if(U===null)return this._coordinates=new Array(0).fill(null),null;this._dimension=U.getDimension(),this._measures=U.getMeasures(),this._coordinates=new Array(U.size()).fill(null);for(var re=0;re<this._coordinates.length;re++)this._coordinates[re]=U.getCoordinateCopy(re)}}else if(arguments.length===2){if(arguments[0]instanceof Array&&Number.isInteger(arguments[1])){var ye=arguments[0],Re=arguments[1];A.constructor_.call(this,ye,Re,Gi.measures(ye))}else if(Number.isInteger(arguments[0])&&Number.isInteger(arguments[1])){var Ke=arguments[0],yt=arguments[1];this._coordinates=new Array(Ke).fill(null),this._dimension=yt;for(var Zt=0;Zt<Ke;Zt++)this._coordinates[Zt]=Ia.create(yt)}}else if(arguments.length===3){if(Number.isInteger(arguments[2])&&arguments[0]instanceof Array&&Number.isInteger(arguments[1])){var ur=arguments[0],Vr=arguments[1],gn=arguments[2];this._dimension=Vr,this._measures=gn,this._coordinates=ur===null?new Array(0).fill(null):ur}else if(Number.isInteger(arguments[2])&&Number.isInteger(arguments[0])&&Number.isInteger(arguments[1])){var Rn=arguments[0],Vn=arguments[1],In=arguments[2];this._coordinates=new Array(Rn).fill(null),this._dimension=Vn,this._measures=In;for(var Dn=0;Dn<Rn;Dn++)this._coordinates[Dn]=this.createCoordinate()}}}}])})(),Ja=(function(){function A(){i(this,A)}return o(A,[{key:"readResolve",value:function(){return A.instance()}},{key:"create",value:function(){if(arguments.length===1){if(arguments[0]instanceof Array)return new oo(arguments[0]);if(wr(arguments[0],_e))return new oo(arguments[0])}else{if(arguments.length===2){var y=arguments[1];return y>3&&(y=3),y<2&&(y=2),new oo(arguments[0],y)}if(arguments.length===3){var _=arguments[2],I=arguments[1]-_;return _>1&&(_=1),I>3&&(I=3),I<2&&(I=2),new oo(arguments[0],I+_,_)}}}},{key:"interfaces_",get:function(){return[bt,G]}}],[{key:"instance",value:function(){return A.instanceObject}}])})();Ja.instanceObject=new Ja;var Hn=(function(A){function y(){var _;return i(this,y),_=n(this,y),y.constructor_.apply(_,arguments),_}return g(y,A),o(y,[{key:"copyInternal",value:function(){for(var _=new Array(this._geometries.length).fill(null),I=0;I<_.length;I++)_[I]=this._geometries[I].copy();return new y(_,this._factory)}},{key:"equalsExact",value:function(){if(arguments.length===2&&typeof arguments[1]=="number"&&arguments[0]instanceof rt){var _=arguments[0],I=arguments[1];return!!this.isEquivalentClass(_)&&S(y,"equalsExact",this,1).call(this,_,I)}return S(y,"equalsExact",this,1).apply(this,arguments)}},{key:"getBoundaryDimension",value:function(){return 1}},{key:"getTypeCode",value:function(){return rt.TYPECODE_MULTIPOLYGON}},{key:"getDimension",value:function(){return 2}},{key:"getBoundary",value:function(){if(this.isEmpty())return this.getFactory().createMultiLineString();for(var _=new et,I=0;I<this._geometries.length;I++)for(var U=this._geometries[I].getBoundary(),re=0;re<U.getNumGeometries();re++)_.add(U.getGeometryN(re));var ye=new Array(_.size()).fill(null);return this.getFactory().createMultiLineString(_.toArray(ye))}},{key:"getGeometryType",value:function(){return rt.TYPENAME_MULTIPOLYGON}},{key:"interfaces_",get:function(){return[Ir]}}],[{key:"constructor_",value:function(){var _=arguments[0],I=arguments[1];bn.constructor_.call(this,_,I)}}])})(bn),bu=(function(){return o((function A(){i(this,A)}),[{key:"get",value:function(){}},{key:"put",value:function(){}},{key:"size",value:function(){}},{key:"values",value:function(){}},{key:"entrySet",value:function(){}}])})(),ru=(function(A){function y(){var _;return i(this,y),(_=n(this,y)).map=new Map,_}return g(y,A),o(y,[{key:"get",value:function(_){return this.map.get(_)||null}},{key:"put",value:function(_,I){return this.map.set(_,I),I}},{key:"values",value:function(){for(var _=new et,I=this.map.values(),U=I.next();!U.done;)_.add(U.value),U=I.next();return _}},{key:"entrySet",value:function(){var _=new Yt;return this.map.entries().forEach((function(I){return _.add(I)})),_}},{key:"size",value:function(){return this.map.size()}}])})(bu),Pa=(function(){function A(){i(this,A),A.constructor_.apply(this,arguments)}return o(A,[{key:"equals",value:function(y){if(!(y instanceof A))return!1;var _=y;return this._modelType===_._modelType&&this._scale===_._scale}},{key:"compareTo",value:function(y){var _=y,I=this.getMaximumSignificantDigits(),U=_.getMaximumSignificantDigits();return lr.compare(I,U)}},{key:"getScale",value:function(){return this._scale}},{key:"isFloating",value:function(){return this._modelType===A.FLOATING||this._modelType===A.FLOATING_SINGLE}},{key:"getType",value:function(){return this._modelType}},{key:"toString",value:function(){var y="UNKNOWN";return this._modelType===A.FLOATING?y="Floating":this._modelType===A.FLOATING_SINGLE?y="Floating-Single":this._modelType===A.FIXED&&(y="Fixed (Scale="+this.getScale()+")"),y}},{key:"makePrecise",value:function(){if(typeof arguments[0]=="number"){var y=arguments[0];return Te.isNaN(y)||this._modelType===A.FLOATING_SINGLE?y:this._modelType===A.FIXED?Math.round(y*this._scale)/this._scale:y}if(arguments[0]instanceof De){var _=arguments[0];if(this._modelType===A.FLOATING)return null;_.x=this.makePrecise(_.x),_.y=this.makePrecise(_.y)}}},{key:"getMaximumSignificantDigits",value:function(){var y=16;return this._modelType===A.FLOATING?y=16:this._modelType===A.FLOATING_SINGLE?y=6:this._modelType===A.FIXED&&(y=1+Math.trunc(Math.ceil(Math.log(this.getScale())/Math.log(10)))),y}},{key:"setScale",value:function(y){this._scale=Math.abs(y)}},{key:"interfaces_",get:function(){return[G,q]}}],[{key:"constructor_",value:function(){if(this._modelType=null,this._scale=null,arguments.length===0)this._modelType=A.FLOATING;else if(arguments.length===1){if(arguments[0]instanceof wa){var y=arguments[0];this._modelType=y,y===A.FIXED&&this.setScale(1)}else if(typeof arguments[0]=="number"){var _=arguments[0];this._modelType=A.FIXED,this.setScale(_)}else if(arguments[0]instanceof A){var I=arguments[0];this._modelType=I._modelType,this._scale=I._scale}}}},{key:"mostPrecise",value:function(y,_){return y.compareTo(_)>=0?y:_}}])})(),wa=(function(){function A(){i(this,A),A.constructor_.apply(this,arguments)}return o(A,[{key:"readResolve",value:function(){return A.nameToTypeMap.get(this._name)}},{key:"toString",value:function(){return this._name}},{key:"interfaces_",get:function(){return[G]}}],[{key:"constructor_",value:function(){this._name=null;var y=arguments[0];this._name=y,A.nameToTypeMap.put(y,this)}}])})();wa.nameToTypeMap=new ru,Pa.Type=wa,Pa.FIXED=new wa("FIXED"),Pa.FLOATING=new wa("FLOATING"),Pa.FLOATING_SINGLE=new wa("FLOATING SINGLE"),Pa.maximumPreciseValue=9007199254740992;var Wo=(function(A){function y(){var _;return i(this,y),_=n(this,y),y.constructor_.apply(_,arguments),_}return g(y,A),o(y,[{key:"copyInternal",value:function(){for(var _=new Array(this._geometries.length).fill(null),I=0;I<_.length;I++)_[I]=this._geometries[I].copy();return new y(_,this._factory)}},{key:"equalsExact",value:function(){if(arguments.length===2&&typeof arguments[1]=="number"&&arguments[0]instanceof rt){var _=arguments[0],I=arguments[1];return!!this.isEquivalentClass(_)&&S(y,"equalsExact",this,1).call(this,_,I)}return S(y,"equalsExact",this,1).apply(this,arguments)}},{key:"getBoundaryDimension",value:function(){return this.isClosed()?ar.FALSE:0}},{key:"isClosed",value:function(){if(this.isEmpty())return!1;for(var _=0;_<this._geometries.length;_++)if(!this._geometries[_].isClosed())return!1;return!0}},{key:"getTypeCode",value:function(){return rt.TYPECODE_MULTILINESTRING}},{key:"getDimension",value:function(){return 1}},{key:"getBoundary",value:function(){throw new je}},{key:"getGeometryType",value:function(){return rt.TYPENAME_MULTILINESTRING}},{key:"interfaces_",get:function(){return[Gr]}}],[{key:"constructor_",value:function(){var _=arguments[0],I=arguments[1];bn.constructor_.call(this,_,I)}}])})(bn),No=(function(){function A(){i(this,A),A.constructor_.apply(this,arguments)}return o(A,[{key:"createEmpty",value:function(y){switch(y){case-1:return this.createGeometryCollection();case 0:return this.createPoint();case 1:return this.createLineString();case 2:return this.createPolygon();default:throw new z("Invalid dimension: "+y)}}},{key:"toGeometry",value:function(y){return y.isNull()?this.createPoint():y.getMinX()===y.getMaxX()&&y.getMinY()===y.getMaxY()?this.createPoint(new De(y.getMinX(),y.getMinY())):y.getMinX()===y.getMaxX()||y.getMinY()===y.getMaxY()?this.createLineString([new De(y.getMinX(),y.getMinY()),new De(y.getMaxX(),y.getMaxY())]):this.createPolygon(this.createLinearRing([new De(y.getMinX(),y.getMinY()),new De(y.getMinX(),y.getMaxY()),new De(y.getMaxX(),y.getMaxY()),new De(y.getMaxX(),y.getMinY()),new De(y.getMinX(),y.getMinY())]),null)}},{key:"createLineString",value:function(){if(arguments.length===0)return this.createLineString(this.getCoordinateSequenceFactory().create([]));if(arguments.length===1){if(arguments[0]instanceof Array){var y=arguments[0];return this.createLineString(y!==null?this.getCoordinateSequenceFactory().create(y):null)}if(wr(arguments[0],_e))return new ri(arguments[0],this)}}},{key:"createMultiLineString",value:function(){return arguments.length===0?new Wo(null,this):arguments.length===1?new Wo(arguments[0],this):void 0}},{key:"buildGeometry",value:function(y){for(var _=null,I=!1,U=!1,re=y.iterator();re.hasNext();){var ye=re.next(),Re=ye.getTypeCode();_===null&&(_=Re),Re!==_&&(I=!0),ye instanceof bn&&(U=!0)}if(_===null)return this.createGeometryCollection();if(I||U)return this.createGeometryCollection(A.toGeometryArray(y));var Ke=y.iterator().next();if(y.size()>1){if(Ke instanceof Fr)return this.createMultiPolygon(A.toPolygonArray(y));if(Ke instanceof ri)return this.createMultiLineString(A.toLineStringArray(y));if(Ke instanceof Be)return this.createMultiPoint(A.toPointArray(y));xe.shouldNeverReachHere("Unhandled geometry type: "+Ke.getGeometryType())}return Ke}},{key:"createMultiPointFromCoords",value:function(y){return this.createMultiPoint(y!==null?this.getCoordinateSequenceFactory().create(y):null)}},{key:"createPoint",value:function(){if(arguments.length===0)return this.createPoint(this.getCoordinateSequenceFactory().create([]));if(arguments.length===1){if(arguments[0]instanceof De){var y=arguments[0];return this.createPoint(y!==null?this.getCoordinateSequenceFactory().create([y]):null)}if(wr(arguments[0],_e))return new Be(arguments[0],this)}}},{key:"getCoordinateSequenceFactory",value:function(){return this._coordinateSequenceFactory}},{key:"createPolygon",value:function(){if(arguments.length===0)return this.createPolygon(null,null);if(arguments.length===1){if(wr(arguments[0],_e)){var y=arguments[0];return this.createPolygon(this.createLinearRing(y))}if(arguments[0]instanceof Array){var _=arguments[0];return this.createPolygon(this.createLinearRing(_))}if(arguments[0]instanceof Mi){var I=arguments[0];return this.createPolygon(I,null)}}else if(arguments.length===2)return new Fr(arguments[0],arguments[1],this)}},{key:"getSRID",value:function(){return this._SRID}},{key:"createGeometryCollection",value:function(){return arguments.length===0?new bn(null,this):arguments.length===1?new bn(arguments[0],this):void 0}},{key:"getPrecisionModel",value:function(){return this._precisionModel}},{key:"createLinearRing",value:function(){if(arguments.length===0)return this.createLinearRing(this.getCoordinateSequenceFactory().create([]));if(arguments.length===1){if(arguments[0]instanceof Array){var y=arguments[0];return this.createLinearRing(y!==null?this.getCoordinateSequenceFactory().create(y):null)}if(wr(arguments[0],_e))return new Mi(arguments[0],this)}}},{key:"createMultiPolygon",value:function(){return arguments.length===0?new Hn(null,this):arguments.length===1?new Hn(arguments[0],this):void 0}},{key:"createMultiPoint",value:function(){if(arguments.length===0)return new Tn(null,this);if(arguments.length===1){if(arguments[0]instanceof Array)return new Tn(arguments[0],this);if(wr(arguments[0],_e)){var y=arguments[0];if(y===null)return this.createMultiPoint(new Array(0).fill(null));for(var _=new Array(y.size()).fill(null),I=0;I<y.size();I++){var U=this.getCoordinateSequenceFactory().create(1,y.getDimension(),y.getMeasures());Jr.copy(y,I,U,0,1),_[I]=this.createPoint(U)}return this.createMultiPoint(_)}}}},{key:"interfaces_",get:function(){return[G]}}],[{key:"constructor_",value:function(){if(this._precisionModel=null,this._coordinateSequenceFactory=null,this._SRID=null,arguments.length===0)A.constructor_.call(this,new Pa,0);else if(arguments.length===1){if(wr(arguments[0],bt)){var y=arguments[0];A.constructor_.call(this,new Pa,0,y)}else if(arguments[0]instanceof Pa){var _=arguments[0];A.constructor_.call(this,_,0,A.getDefaultCoordinateSequenceFactory())}}else if(arguments.length===2){var I=arguments[0],U=arguments[1];A.constructor_.call(this,I,U,A.getDefaultCoordinateSequenceFactory())}else if(arguments.length===3){var re=arguments[0],ye=arguments[1],Re=arguments[2];this._precisionModel=re,this._coordinateSequenceFactory=Re,this._SRID=ye}}},{key:"toMultiPolygonArray",value:function(y){var _=new Array(y.size()).fill(null);return y.toArray(_)}},{key:"toGeometryArray",value:function(y){if(y===null)return null;var _=new Array(y.size()).fill(null);return y.toArray(_)}},{key:"getDefaultCoordinateSequenceFactory",value:function(){return Ja.instance()}},{key:"toMultiLineStringArray",value:function(y){var _=new Array(y.size()).fill(null);return y.toArray(_)}},{key:"toLineStringArray",value:function(y){var _=new Array(y.size()).fill(null);return y.toArray(_)}},{key:"toMultiPointArray",value:function(y){var _=new Array(y.size()).fill(null);return y.toArray(_)}},{key:"toLinearRingArray",value:function(y){var _=new Array(y.size()).fill(null);return y.toArray(_)}},{key:"toPointArray",value:function(y){var _=new Array(y.size()).fill(null);return y.toArray(_)}},{key:"toPolygonArray",value:function(y){var _=new Array(y.size()).fill(null);return y.toArray(_)}},{key:"createPointFromInternalCoord",value:function(y,_){return _.getPrecisionModel().makePrecise(y),_.getFactory().createPoint(y)}}])})(),ls="XY",kc="XYZ",Sa="XYM",Mc="XYZM",Rc={POINT:"Point",LINE_STRING:"LineString",LINEAR_RING:"LinearRing",POLYGON:"Polygon",MULTI_POINT:"MultiPoint",MULTI_LINE_STRING:"MultiLineString",MULTI_POLYGON:"MultiPolygon",GEOMETRY_COLLECTION:"GeometryCollection",CIRCLE:"Circle"},vl="EMPTY",Qs=1,Ha=2,so=3,ka=4,el=5,xu=6;for(var wu in Rc)Rc[wu].toUpperCase();var J=(function(){return o((function A(y){i(this,A),this.wkt=y,this.index_=-1}),[{key:"isAlpha_",value:function(A){return A>="a"&&A<="z"||A>="A"&&A<="Z"}},{key:"isNumeric_",value:function(A,y){return A>="0"&&A<="9"||A=="."&&!(y!==void 0&&y)}},{key:"isWhiteSpace_",value:function(A){return A==" "||A=="	"||A=="\r"||A==`
`}},{key:"nextChar_",value:function(){return this.wkt.charAt(++this.index_)}},{key:"nextToken",value:function(){var A,y=this.nextChar_(),_=this.index_,I=y;if(y=="(")A=Ha;else if(y==",")A=el;else if(y==")")A=so;else if(this.isNumeric_(y)||y=="-")A=ka,I=this.readNumber_();else if(this.isAlpha_(y))A=Qs,I=this.readText_();else{if(this.isWhiteSpace_(y))return this.nextToken();if(y!=="")throw new Error("Unexpected character: "+y);A=xu}return{position:_,value:I,type:A}}},{key:"readNumber_",value:function(){var A,y=this.index_,_=!1,I=!1;do A=="."?_=!0:A!="e"&&A!="E"||(I=!0),A=this.nextChar_();while(this.isNumeric_(A,_)||!I&&(A=="e"||A=="E")||I&&(A=="-"||A=="+"));return parseFloat(this.wkt.substring(y,this.index_--))}},{key:"readText_",value:function(){var A,y=this.index_;do A=this.nextChar_();while(this.isAlpha_(A));return this.wkt.substring(y,this.index_--).toUpperCase()}}])})(),pe=(function(){return o((function A(y,_){i(this,A),this.lexer_=y,this.token_,this.layout_=ls,this.factory=_}),[{key:"consume_",value:function(){this.token_=this.lexer_.nextToken()}},{key:"isTokenType",value:function(A){return this.token_.type==A}},{key:"match",value:function(A){var y=this.isTokenType(A);return y&&this.consume_(),y}},{key:"parse",value:function(){return this.consume_(),this.parseGeometry_()}},{key:"parseGeometryLayout_",value:function(){var A=ls,y=this.token_;if(this.isTokenType(Qs)){var _=y.value;_==="Z"?A=kc:_==="M"?A=Sa:_==="ZM"&&(A=Mc),A!==ls&&this.consume_()}return A}},{key:"parseGeometryCollectionText_",value:function(){if(this.match(Ha)){var A=[];do A.push(this.parseGeometry_());while(this.match(el));if(this.match(so))return A}else if(this.isEmptyGeometry_())return[];throw new Error(this.formatErrorMessage_())}},{key:"parsePointText_",value:function(){if(this.match(Ha)){var A=this.parsePoint_();if(this.match(so))return A}else if(this.isEmptyGeometry_())return null;throw new Error(this.formatErrorMessage_())}},{key:"parseLineStringText_",value:function(){if(this.match(Ha)){var A=this.parsePointList_();if(this.match(so))return A}else if(this.isEmptyGeometry_())return[];throw new Error(this.formatErrorMessage_())}},{key:"parsePolygonText_",value:function(){if(this.match(Ha)){var A=this.parseLineStringTextList_();if(this.match(so))return A}else if(this.isEmptyGeometry_())return[];throw new Error(this.formatErrorMessage_())}},{key:"parseMultiPointText_",value:function(){var A;if(this.match(Ha)){if(A=this.token_.type==Ha?this.parsePointTextList_():this.parsePointList_(),this.match(so))return A}else if(this.isEmptyGeometry_())return[];throw new Error(this.formatErrorMessage_())}},{key:"parseMultiLineStringText_",value:function(){if(this.match(Ha)){var A=this.parseLineStringTextList_();if(this.match(so))return A}else if(this.isEmptyGeometry_())return[];throw new Error(this.formatErrorMessage_())}},{key:"parseMultiPolygonText_",value:function(){if(this.match(Ha)){var A=this.parsePolygonTextList_();if(this.match(so))return A}else if(this.isEmptyGeometry_())return[];throw new Error(this.formatErrorMessage_())}},{key:"parsePoint_",value:function(){for(var A=[],y=this.layout_.length,_=0;_<y;++_){var I=this.token_;if(!this.match(ka))break;A.push(I.value)}if(A.length==y)return A;throw new Error(this.formatErrorMessage_())}},{key:"parsePointList_",value:function(){for(var A=[this.parsePoint_()];this.match(el);)A.push(this.parsePoint_());return A}},{key:"parsePointTextList_",value:function(){for(var A=[this.parsePointText_()];this.match(el);)A.push(this.parsePointText_());return A}},{key:"parseLineStringTextList_",value:function(){for(var A=[this.parseLineStringText_()];this.match(el);)A.push(this.parseLineStringText_());return A}},{key:"parsePolygonTextList_",value:function(){for(var A=[this.parsePolygonText_()];this.match(el);)A.push(this.parsePolygonText_());return A}},{key:"isEmptyGeometry_",value:function(){var A=this.isTokenType(Qs)&&this.token_.value==vl;return A&&this.consume_(),A}},{key:"formatErrorMessage_",value:function(){return"Unexpected `"+this.token_.value+"` at position "+this.token_.position+" in `"+this.lexer_.wkt+"`"}},{key:"parseGeometry_",value:function(){var A=this.factory,y=function(Vn){return a(De,E(Vn))},_=function(Vn){var In=Vn.map((function(Dn){return A.createLinearRing(Dn.map(y))}));return In.length>1?A.createPolygon(In[0],In.slice(1)):A.createPolygon(In[0])},I=this.token_;if(this.match(Qs)){var U=I.value;if(this.layout_=this.parseGeometryLayout_(),U=="GEOMETRYCOLLECTION"){var re=this.parseGeometryCollectionText_();return A.createGeometryCollection(re)}switch(U){case"POINT":var ye=this.parsePointText_();return ye?A.createPoint(a(De,E(ye))):A.createPoint();case"LINESTRING":var Re=this.parseLineStringText_().map(y);return A.createLineString(Re);case"LINEARRING":var Ke=this.parseLineStringText_().map(y);return A.createLinearRing(Ke);case"POLYGON":var yt=this.parsePolygonText_();return yt&&yt.length!==0?_(yt):A.createPolygon();case"MULTIPOINT":var Zt=this.parseMultiPointText_();if(!Zt||Zt.length===0)return A.createMultiPoint();var ur=Zt.map(y).map((function(Vn){return A.createPoint(Vn)}));return A.createMultiPoint(ur);case"MULTILINESTRING":var Vr=this.parseMultiLineStringText_().map((function(Vn){return A.createLineString(Vn.map(y))}));return A.createMultiLineString(Vr);case"MULTIPOLYGON":var gn=this.parseMultiPolygonText_();if(!gn||gn.length===0)return A.createMultiPolygon();var Rn=gn.map(_);return A.createMultiPolygon(Rn);default:throw new Error("Invalid geometry type: "+U)}}throw new Error(this.formatErrorMessage_())}}])})();function Xe(A){if(A.isEmpty())return"";var y=A.getCoordinate(),_=[y.x,y.y];return y.z===void 0||Number.isNaN(y.z)||_.push(y.z),y.m===void 0||Number.isNaN(y.m)||_.push(y.m),_.join(" ")}function Tt(A){for(var y=A.getCoordinates().map((function(re){var ye=[re.x,re.y];return re.z===void 0||Number.isNaN(re.z)||ye.push(re.z),re.m===void 0||Number.isNaN(re.m)||ye.push(re.m),ye})),_=[],I=0,U=y.length;I<U;++I)_.push(y[I].join(" "));return _.join(", ")}function Nt(A){var y=[];y.push("("+Tt(A.getExteriorRing())+")");for(var _=0,I=A.getNumInteriorRing();_<I;++_)y.push("("+Tt(A.getInteriorRingN(_))+")");return y.join(", ")}var kt={Point:Xe,LineString:Tt,LinearRing:Tt,Polygon:Nt,MultiPoint:function(A){for(var y=[],_=0,I=A.getNumGeometries();_<I;++_)y.push("("+Xe(A.getGeometryN(_))+")");return y.join(", ")},MultiLineString:function(A){for(var y=[],_=0,I=A.getNumGeometries();_<I;++_)y.push("("+Tt(A.getGeometryN(_))+")");return y.join(", ")},MultiPolygon:function(A){for(var y=[],_=0,I=A.getNumGeometries();_<I;++_)y.push("("+Nt(A.getGeometryN(_))+")");return y.join(", ")},GeometryCollection:function(A){for(var y=[],_=0,I=A.getNumGeometries();_<I;++_)y.push(Gt(A.getGeometryN(_)));return y.join(", ")}};function Gt(A){var y=A.getGeometryType(),_=kt[y];y=y.toUpperCase();var I=(function(U){var re="";if(U.isEmpty())return re;var ye=U.getCoordinate();return ye.z===void 0||Number.isNaN(ye.z)||(re+="Z"),ye.m===void 0||Number.isNaN(ye.m)||(re+="M"),re})(A);return I.length>0&&(y+=" "+I),A.isEmpty()?y+" "+vl:y+" ("+_(A)+")"}var $r=(function(){return o((function A(y){i(this,A),this.geometryFactory=y||new No,this.precisionModel=this.geometryFactory.getPrecisionModel()}),[{key:"read",value:function(A){var y=new J(A);return new pe(y,this.geometryFactory).parse()}},{key:"write",value:function(A){return Gt(A)}}])})(),Yr=(function(){return o((function A(y){i(this,A),this.parser=new $r(y)}),[{key:"write",value:function(A){return this.parser.write(A)}}],[{key:"toLineString",value:function(A,y){if(arguments.length!==2)throw new Error("Not implemented");return"LINESTRING ( "+A.x+" "+A.y+", "+y.x+" "+y.y+" )"}}])})(),Hr=(function(){function A(){i(this,A),A.constructor_.apply(this,arguments)}return o(A,[{key:"getIndexAlongSegment",value:function(y,_){return this.computeIntLineIndex(),this._intLineIndex[y][_]}},{key:"getTopologySummary",value:function(){var y=new Ui;return this.isEndPoint()&&y.append(" endpoint"),this._isProper&&y.append(" proper"),this.isCollinear()&&y.append(" collinear"),y.toString()}},{key:"computeIntersection",value:function(y,_,I,U){this._inputLines[0][0]=y,this._inputLines[0][1]=_,this._inputLines[1][0]=I,this._inputLines[1][1]=U,this._result=this.computeIntersect(y,_,I,U)}},{key:"getIntersectionNum",value:function(){return this._result}},{key:"computeIntLineIndex",value:function(){if(arguments.length===0)this._intLineIndex===null&&(this._intLineIndex=Array(2).fill().map((function(){return Array(2)})),this.computeIntLineIndex(0),this.computeIntLineIndex(1));else if(arguments.length===1){var y=arguments[0];this.getEdgeDistance(y,0)>this.getEdgeDistance(y,1)?(this._intLineIndex[y][0]=0,this._intLineIndex[y][1]=1):(this._intLineIndex[y][0]=1,this._intLineIndex[y][1]=0)}}},{key:"isProper",value:function(){return this.hasIntersection()&&this._isProper}},{key:"setPrecisionModel",value:function(y){this._precisionModel=y}},{key:"isInteriorIntersection",value:function(){if(arguments.length===0)return!!this.isInteriorIntersection(0)||!!this.isInteriorIntersection(1);if(arguments.length===1){for(var y=arguments[0],_=0;_<this._result;_++)if(!this._intPt[_].equals2D(this._inputLines[y][0])&&!this._intPt[_].equals2D(this._inputLines[y][1]))return!0;return!1}}},{key:"getIntersection",value:function(y){return this._intPt[y]}},{key:"isEndPoint",value:function(){return this.hasIntersection()&&!this._isProper}},{key:"hasIntersection",value:function(){return this._result!==A.NO_INTERSECTION}},{key:"getEdgeDistance",value:function(y,_){return A.computeEdgeDistance(this._intPt[_],this._inputLines[y][0],this._inputLines[y][1])}},{key:"isCollinear",value:function(){return this._result===A.COLLINEAR_INTERSECTION}},{key:"toString",value:function(){return Yr.toLineString(this._inputLines[0][0],this._inputLines[0][1])+" - "+Yr.toLineString(this._inputLines[1][0],this._inputLines[1][1])+this.getTopologySummary()}},{key:"getEndpoint",value:function(y,_){return this._inputLines[y][_]}},{key:"isIntersection",value:function(y){for(var _=0;_<this._result;_++)if(this._intPt[_].equals2D(y))return!0;return!1}},{key:"getIntersectionAlongSegment",value:function(y,_){return this.computeIntLineIndex(),this._intPt[this._intLineIndex[y][_]]}}],[{key:"constructor_",value:function(){this._result=null,this._inputLines=Array(2).fill().map((function(){return Array(2)})),this._intPt=new Array(2).fill(null),this._intLineIndex=null,this._isProper=null,this._pa=null,this._pb=null,this._precisionModel=null,this._intPt[0]=new De,this._intPt[1]=new De,this._pa=this._intPt[0],this._pb=this._intPt[1],this._result=0}},{key:"computeEdgeDistance",value:function(y,_,I){var U=Math.abs(I.x-_.x),re=Math.abs(I.y-_.y),ye=-1;if(y.equals(_))ye=0;else if(y.equals(I))ye=U>re?U:re;else{var Re=Math.abs(y.x-_.x),Ke=Math.abs(y.y-_.y);(ye=U>re?Re:Ke)!==0||y.equals(_)||(ye=Math.max(Re,Ke))}return xe.isTrue(!(ye===0&&!y.equals(_)),"Bad distance calculation"),ye}},{key:"nonRobustComputeEdgeDistance",value:function(y,_,I){var U=y.x-_.x,re=y.y-_.y,ye=Math.sqrt(U*U+re*re);return xe.isTrue(!(ye===0&&!y.equals(_)),"Invalid distance calculation"),ye}}])})();Hr.DONT_INTERSECT=0,Hr.DO_INTERSECT=1,Hr.COLLINEAR=2,Hr.NO_INTERSECTION=0,Hr.POINT_INTERSECTION=1,Hr.COLLINEAR_INTERSECTION=2;var kr=(function(A){function y(){return i(this,y),n(this,y)}return g(y,A),o(y,[{key:"isInSegmentEnvelopes",value:function(_){var I=new Ye(this._inputLines[0][0],this._inputLines[0][1]),U=new Ye(this._inputLines[1][0],this._inputLines[1][1]);return I.contains(_)&&U.contains(_)}},{key:"computeIntersection",value:function(){if(arguments.length!==3)return S(y,"computeIntersection",this,1).apply(this,arguments);var _=arguments[0],I=arguments[1],U=arguments[2];if(this._isProper=!1,Ye.intersects(I,U,_)&&be.index(I,U,_)===0&&be.index(U,I,_)===0)return this._isProper=!0,(_.equals(I)||_.equals(U))&&(this._isProper=!1),this._result=Hr.POINT_INTERSECTION,null;this._result=Hr.NO_INTERSECTION}},{key:"intersection",value:function(_,I,U,re){var ye=this.intersectionSafe(_,I,U,re);return this.isInSegmentEnvelopes(ye)||(ye=new De(y.nearestEndpoint(_,I,U,re))),this._precisionModel!==null&&this._precisionModel.makePrecise(ye),ye}},{key:"checkDD",value:function(_,I,U,re,ye){var Re=nt.intersection(_,I,U,re),Ke=this.isInSegmentEnvelopes(Re);Jt.out.println("DD in env = "+Ke+"  --------------------- "+Re),ye.distance(Re)>1e-4&&Jt.out.println("Distance = "+ye.distance(Re))}},{key:"intersectionSafe",value:function(_,I,U,re){var ye=jt.intersection(_,I,U,re);return ye===null&&(ye=y.nearestEndpoint(_,I,U,re)),ye}},{key:"computeCollinearIntersection",value:function(_,I,U,re){var ye=Ye.intersects(_,I,U),Re=Ye.intersects(_,I,re),Ke=Ye.intersects(U,re,_),yt=Ye.intersects(U,re,I);return ye&&Re?(this._intPt[0]=U,this._intPt[1]=re,Hr.COLLINEAR_INTERSECTION):Ke&&yt?(this._intPt[0]=_,this._intPt[1]=I,Hr.COLLINEAR_INTERSECTION):ye&&Ke?(this._intPt[0]=U,this._intPt[1]=_,!U.equals(_)||Re||yt?Hr.COLLINEAR_INTERSECTION:Hr.POINT_INTERSECTION):ye&&yt?(this._intPt[0]=U,this._intPt[1]=I,!U.equals(I)||Re||Ke?Hr.COLLINEAR_INTERSECTION:Hr.POINT_INTERSECTION):Re&&Ke?(this._intPt[0]=re,this._intPt[1]=_,!re.equals(_)||ye||yt?Hr.COLLINEAR_INTERSECTION:Hr.POINT_INTERSECTION):Re&&yt?(this._intPt[0]=re,this._intPt[1]=I,!re.equals(I)||ye||Ke?Hr.COLLINEAR_INTERSECTION:Hr.POINT_INTERSECTION):Hr.NO_INTERSECTION}},{key:"computeIntersect",value:function(_,I,U,re){if(this._isProper=!1,!Ye.intersects(_,I,U,re))return Hr.NO_INTERSECTION;var ye=be.index(_,I,U),Re=be.index(_,I,re);if(ye>0&&Re>0||ye<0&&Re<0)return Hr.NO_INTERSECTION;var Ke=be.index(U,re,_),yt=be.index(U,re,I);return Ke>0&&yt>0||Ke<0&&yt<0?Hr.NO_INTERSECTION:ye===0&&Re===0&&Ke===0&&yt===0?this.computeCollinearIntersection(_,I,U,re):(ye===0||Re===0||Ke===0||yt===0?(this._isProper=!1,_.equals2D(U)||_.equals2D(re)?this._intPt[0]=_:I.equals2D(U)||I.equals2D(re)?this._intPt[0]=I:ye===0?this._intPt[0]=new De(U):Re===0?this._intPt[0]=new De(re):Ke===0?this._intPt[0]=new De(_):yt===0&&(this._intPt[0]=new De(I))):(this._isProper=!0,this._intPt[0]=this.intersection(_,I,U,re)),Hr.POINT_INTERSECTION)}}],[{key:"nearestEndpoint",value:function(_,I,U,re){var ye=_,Re=Rr.pointToSegment(_,U,re),Ke=Rr.pointToSegment(I,U,re);return Ke<Re&&(Re=Ke,ye=I),(Ke=Rr.pointToSegment(U,_,I))<Re&&(Re=Ke,ye=U),(Ke=Rr.pointToSegment(re,_,I))<Re&&(Re=Ke,ye=re),ye}}])})(Hr),Qr=(function(){function A(){i(this,A),A.constructor_.apply(this,arguments)}return o(A,[{key:"countSegment",value:function(y,_){if(y.x<this._p.x&&_.x<this._p.x)return null;if(this._p.x===_.x&&this._p.y===_.y)return this._isPointOnSegment=!0,null;if(y.y===this._p.y&&_.y===this._p.y){var I=y.x,U=_.x;return I>U&&(I=_.x,U=y.x),this._p.x>=I&&this._p.x<=U&&(this._isPointOnSegment=!0),null}if(y.y>this._p.y&&_.y<=this._p.y||_.y>this._p.y&&y.y<=this._p.y){var re=be.index(y,_,this._p);if(re===be.COLLINEAR)return this._isPointOnSegment=!0,null;_.y<y.y&&(re=-re),re===be.LEFT&&this._crossingCount++}}},{key:"isPointInPolygon",value:function(){return this.getLocation()!==Ie.EXTERIOR}},{key:"getLocation",value:function(){return this._isPointOnSegment?Ie.BOUNDARY:this._crossingCount%2==1?Ie.INTERIOR:Ie.EXTERIOR}},{key:"isOnSegment",value:function(){return this._isPointOnSegment}}],[{key:"constructor_",value:function(){this._p=null,this._crossingCount=0,this._isPointOnSegment=!1;var y=arguments[0];this._p=y}},{key:"locatePointInRing",value:function(){if(arguments[0]instanceof De&&wr(arguments[1],_e)){for(var y=arguments[1],_=new A(arguments[0]),I=new De,U=new De,re=1;re<y.size();re++)if(y.getCoordinate(re,I),y.getCoordinate(re-1,U),_.countSegment(I,U),_.isOnSegment())return _.getLocation();return _.getLocation()}if(arguments[0]instanceof De&&arguments[1]instanceof Array){for(var ye=arguments[1],Re=new A(arguments[0]),Ke=1;Ke<ye.length;Ke++){var yt=ye[Ke],Zt=ye[Ke-1];if(Re.countSegment(yt,Zt),Re.isOnSegment())return Re.getLocation()}return Re.getLocation()}}}])})(),Qn=(function(){function A(){i(this,A)}return o(A,null,[{key:"isOnLine",value:function(){if(arguments[0]instanceof De&&wr(arguments[1],_e)){for(var y=arguments[0],_=arguments[1],I=new kr,U=new De,re=new De,ye=_.size(),Re=1;Re<ye;Re++)if(_.getCoordinate(Re-1,U),_.getCoordinate(Re,re),I.computeIntersection(y,U,re),I.hasIntersection())return!0;return!1}if(arguments[0]instanceof De&&arguments[1]instanceof Array){for(var Ke=arguments[0],yt=arguments[1],Zt=new kr,ur=1;ur<yt.length;ur++){var Vr=yt[ur-1],gn=yt[ur];if(Zt.computeIntersection(Ke,Vr,gn),Zt.hasIntersection())return!0}return!1}}},{key:"locateInRing",value:function(y,_){return Qr.locatePointInRing(y,_)}},{key:"isInRing",value:function(y,_){return A.locateInRing(y,_)!==Ie.EXTERIOR}}])})(),Ei=(function(){function A(){i(this,A),A.constructor_.apply(this,arguments)}return o(A,[{key:"setAllLocations",value:function(y){for(var _=0;_<this.location.length;_++)this.location[_]=y}},{key:"isNull",value:function(){for(var y=0;y<this.location.length;y++)if(this.location[y]!==Ie.NONE)return!1;return!0}},{key:"setAllLocationsIfNull",value:function(y){for(var _=0;_<this.location.length;_++)this.location[_]===Ie.NONE&&(this.location[_]=y)}},{key:"isLine",value:function(){return this.location.length===1}},{key:"merge",value:function(y){if(y.location.length>this.location.length){var _=new Array(3).fill(null);_[vt.ON]=this.location[vt.ON],_[vt.LEFT]=Ie.NONE,_[vt.RIGHT]=Ie.NONE,this.location=_}for(var I=0;I<this.location.length;I++)this.location[I]===Ie.NONE&&I<y.location.length&&(this.location[I]=y.location[I])}},{key:"getLocations",value:function(){return this.location}},{key:"flip",value:function(){if(this.location.length<=1)return null;var y=this.location[vt.LEFT];this.location[vt.LEFT]=this.location[vt.RIGHT],this.location[vt.RIGHT]=y}},{key:"toString",value:function(){var y=new er;return this.location.length>1&&y.append(Ie.toLocationSymbol(this.location[vt.LEFT])),y.append(Ie.toLocationSymbol(this.location[vt.ON])),this.location.length>1&&y.append(Ie.toLocationSymbol(this.location[vt.RIGHT])),y.toString()}},{key:"setLocations",value:function(y,_,I){this.location[vt.ON]=y,this.location[vt.LEFT]=_,this.location[vt.RIGHT]=I}},{key:"get",value:function(y){return y<this.location.length?this.location[y]:Ie.NONE}},{key:"isArea",value:function(){return this.location.length>1}},{key:"isAnyNull",value:function(){for(var y=0;y<this.location.length;y++)if(this.location[y]===Ie.NONE)return!0;return!1}},{key:"setLocation",value:function(){if(arguments.length===1){var y=arguments[0];this.setLocation(vt.ON,y)}else if(arguments.length===2){var _=arguments[0],I=arguments[1];this.location[_]=I}}},{key:"init",value:function(y){this.location=new Array(y).fill(null),this.setAllLocations(Ie.NONE)}},{key:"isEqualOnSide",value:function(y,_){return this.location[_]===y.location[_]}},{key:"allPositionsEqual",value:function(y){for(var _=0;_<this.location.length;_++)if(this.location[_]!==y)return!1;return!0}}],[{key:"constructor_",value:function(){if(this.location=null,arguments.length===1){if(arguments[0]instanceof Array){var y=arguments[0];this.init(y.length)}else if(Number.isInteger(arguments[0])){var _=arguments[0];this.init(1),this.location[vt.ON]=_}else if(arguments[0]instanceof A){var I=arguments[0];if(this.init(I.location.length),I!==null)for(var U=0;U<this.location.length;U++)this.location[U]=I.location[U]}}else if(arguments.length===3){var re=arguments[0],ye=arguments[1],Re=arguments[2];this.init(3),this.location[vt.ON]=re,this.location[vt.LEFT]=ye,this.location[vt.RIGHT]=Re}}}])})(),En=(function(){function A(){i(this,A),A.constructor_.apply(this,arguments)}return o(A,[{key:"getGeometryCount",value:function(){var y=0;return this.elt[0].isNull()||y++,this.elt[1].isNull()||y++,y}},{key:"setAllLocations",value:function(y,_){this.elt[y].setAllLocations(_)}},{key:"isNull",value:function(y){return this.elt[y].isNull()}},{key:"setAllLocationsIfNull",value:function(){if(arguments.length===1){var y=arguments[0];this.setAllLocationsIfNull(0,y),this.setAllLocationsIfNull(1,y)}else if(arguments.length===2){var _=arguments[0],I=arguments[1];this.elt[_].setAllLocationsIfNull(I)}}},{key:"isLine",value:function(y){return this.elt[y].isLine()}},{key:"merge",value:function(y){for(var _=0;_<2;_++)this.elt[_]===null&&y.elt[_]!==null?this.elt[_]=new Ei(y.elt[_]):this.elt[_].merge(y.elt[_])}},{key:"flip",value:function(){this.elt[0].flip(),this.elt[1].flip()}},{key:"getLocation",value:function(){if(arguments.length===1){var y=arguments[0];return this.elt[y].get(vt.ON)}if(arguments.length===2){var _=arguments[0],I=arguments[1];return this.elt[_].get(I)}}},{key:"toString",value:function(){var y=new er;return this.elt[0]!==null&&(y.append("A:"),y.append(this.elt[0].toString())),this.elt[1]!==null&&(y.append(" B:"),y.append(this.elt[1].toString())),y.toString()}},{key:"isArea",value:function(){if(arguments.length===0)return this.elt[0].isArea()||this.elt[1].isArea();if(arguments.length===1){var y=arguments[0];return this.elt[y].isArea()}}},{key:"isAnyNull",value:function(y){return this.elt[y].isAnyNull()}},{key:"setLocation",value:function(){if(arguments.length===2){var y=arguments[0],_=arguments[1];this.elt[y].setLocation(vt.ON,_)}else if(arguments.length===3){var I=arguments[0],U=arguments[1],re=arguments[2];this.elt[I].setLocation(U,re)}}},{key:"isEqualOnSide",value:function(y,_){return this.elt[0].isEqualOnSide(y.elt[0],_)&&this.elt[1].isEqualOnSide(y.elt[1],_)}},{key:"allPositionsEqual",value:function(y,_){return this.elt[y].allPositionsEqual(_)}},{key:"toLine",value:function(y){this.elt[y].isArea()&&(this.elt[y]=new Ei(this.elt[y].location[0]))}}],[{key:"constructor_",value:function(){if(this.elt=new Array(2).fill(null),arguments.length===1){if(Number.isInteger(arguments[0])){var y=arguments[0];this.elt[0]=new Ei(y),this.elt[1]=new Ei(y)}else if(arguments[0]instanceof A){var _=arguments[0];this.elt[0]=new Ei(_.elt[0]),this.elt[1]=new Ei(_.elt[1])}}else if(arguments.length===2){var I=arguments[0],U=arguments[1];this.elt[0]=new Ei(Ie.NONE),this.elt[1]=new Ei(Ie.NONE),this.elt[I].setLocation(U)}else if(arguments.length===3){var re=arguments[0],ye=arguments[1],Re=arguments[2];this.elt[0]=new Ei(re,ye,Re),this.elt[1]=new Ei(re,ye,Re)}else if(arguments.length===4){var Ke=arguments[0],yt=arguments[1],Zt=arguments[2],ur=arguments[3];this.elt[0]=new Ei(Ie.NONE,Ie.NONE,Ie.NONE),this.elt[1]=new Ei(Ie.NONE,Ie.NONE,Ie.NONE),this.elt[Ke].setLocations(yt,Zt,ur)}}},{key:"toLineLabel",value:function(y){for(var _=new A(Ie.NONE),I=0;I<2;I++)_.setLocation(I,y.getLocation(I));return _}}])})(),pn=(function(){return o((function A(){i(this,A),A.constructor_.apply(this,arguments)}),[{key:"computeRing",value:function(){if(this._ring!==null)return null;for(var A=new Array(this._pts.size()).fill(null),y=0;y<this._pts.size();y++)A[y]=this._pts.get(y);this._ring=this._geometryFactory.createLinearRing(A),this._isHole=be.isCCW(this._ring.getCoordinates())}},{key:"isIsolated",value:function(){return this._label.getGeometryCount()===1}},{key:"computePoints",value:function(A){this._startDe=A;var y=A,_=!0;do{if(y===null)throw new Qe("Found null DirectedEdge");if(y.getEdgeRing()===this)throw new Qe("Directed Edge visited twice during ring-building at "+y.getCoordinate());this._edges.add(y);var I=y.getLabel();xe.isTrue(I.isArea()),this.mergeLabel(I),this.addPoints(y.getEdge(),y.isForward(),_),_=!1,this.setEdgeRing(y,this),y=this.getNext(y)}while(y!==this._startDe)}},{key:"getLinearRing",value:function(){return this._ring}},{key:"getCoordinate",value:function(A){return this._pts.get(A)}},{key:"computeMaxNodeDegree",value:function(){this._maxNodeDegree=0;var A=this._startDe;do{var y=A.getNode().getEdges().getOutgoingDegree(this);y>this._maxNodeDegree&&(this._maxNodeDegree=y),A=this.getNext(A)}while(A!==this._startDe);this._maxNodeDegree*=2}},{key:"addPoints",value:function(A,y,_){var I=A.getCoordinates();if(y){var U=1;_&&(U=0);for(var re=U;re<I.length;re++)this._pts.add(I[re])}else{var ye=I.length-2;_&&(ye=I.length-1);for(var Re=ye;Re>=0;Re--)this._pts.add(I[Re])}}},{key:"isHole",value:function(){return this._isHole}},{key:"setInResult",value:function(){var A=this._startDe;do A.getEdge().setInResult(!0),A=A.getNext();while(A!==this._startDe)}},{key:"containsPoint",value:function(A){var y=this.getLinearRing();if(!y.getEnvelopeInternal().contains(A)||!Qn.isInRing(A,y.getCoordinates()))return!1;for(var _=this._holes.iterator();_.hasNext();)if(_.next().containsPoint(A))return!1;return!0}},{key:"addHole",value:function(A){this._holes.add(A)}},{key:"isShell",value:function(){return this._shell===null}},{key:"getLabel",value:function(){return this._label}},{key:"getEdges",value:function(){return this._edges}},{key:"getMaxNodeDegree",value:function(){return this._maxNodeDegree<0&&this.computeMaxNodeDegree(),this._maxNodeDegree}},{key:"getShell",value:function(){return this._shell}},{key:"mergeLabel",value:function(){if(arguments.length===1){var A=arguments[0];this.mergeLabel(A,0),this.mergeLabel(A,1)}else if(arguments.length===2){var y=arguments[1],_=arguments[0].getLocation(y,vt.RIGHT);if(_===Ie.NONE)return null;if(this._label.getLocation(y)===Ie.NONE)return this._label.setLocation(y,_),null}}},{key:"setShell",value:function(A){this._shell=A,A!==null&&A.addHole(this)}},{key:"toPolygon",value:function(A){for(var y=new Array(this._holes.size()).fill(null),_=0;_<this._holes.size();_++)y[_]=this._holes.get(_).getLinearRing();return A.createPolygon(this.getLinearRing(),y)}}],[{key:"constructor_",value:function(){if(this._startDe=null,this._maxNodeDegree=-1,this._edges=new et,this._pts=new et,this._label=new En(Ie.NONE),this._ring=null,this._isHole=null,this._shell=null,this._holes=new et,this._geometryFactory=null,arguments.length!==0){if(arguments.length===2){var A=arguments[0],y=arguments[1];this._geometryFactory=y,this.computePoints(A),this.computeRing()}}}}])})(),Mr=(function(A){function y(){var _;return i(this,y),_=n(this,y),y.constructor_.apply(_,arguments),_}return g(y,A),o(y,[{key:"setEdgeRing",value:function(_,I){_.setMinEdgeRing(I)}},{key:"getNext",value:function(_){return _.getNextMin()}}],[{key:"constructor_",value:function(){var _=arguments[0],I=arguments[1];pn.constructor_.call(this,_,I)}}])})(pn),cn=(function(A){function y(){var _;return i(this,y),_=n(this,y),y.constructor_.apply(_,arguments),_}return g(y,A),o(y,[{key:"buildMinimalRings",value:function(){var _=new et,I=this._startDe;do{if(I.getMinEdgeRing()===null){var U=new Mr(I,this._geometryFactory);_.add(U)}I=I.getNext()}while(I!==this._startDe);return _}},{key:"setEdgeRing",value:function(_,I){_.setEdgeRing(I)}},{key:"linkDirectedEdgesForMinimalEdgeRings",value:function(){var _=this._startDe;do _.getNode().getEdges().linkMinimalDirectedEdges(this),_=_.getNext();while(_!==this._startDe)}},{key:"getNext",value:function(_){return _.getNext()}}],[{key:"constructor_",value:function(){var _=arguments[0],I=arguments[1];pn.constructor_.call(this,_,I)}}])})(pn),Wn=(function(){return o((function A(){i(this,A),A.constructor_.apply(this,arguments)}),[{key:"setVisited",value:function(A){this._isVisited=A}},{key:"setInResult",value:function(A){this._isInResult=A}},{key:"isCovered",value:function(){return this._isCovered}},{key:"isCoveredSet",value:function(){return this._isCoveredSet}},{key:"setLabel",value:function(A){this._label=A}},{key:"getLabel",value:function(){return this._label}},{key:"setCovered",value:function(A){this._isCovered=A,this._isCoveredSet=!0}},{key:"updateIM",value:function(A){xe.isTrue(this._label.getGeometryCount()>=2,"found partial label"),this.computeIM(A)}},{key:"isInResult",value:function(){return this._isInResult}},{key:"isVisited",value:function(){return this._isVisited}}],[{key:"constructor_",value:function(){if(this._label=null,this._isInResult=!1,this._isCovered=!1,this._isCoveredSet=!1,this._isVisited=!1,arguments.length!==0){if(arguments.length===1){var A=arguments[0];this._label=A}}}}])})(),Ma=(function(A){function y(){var _;return i(this,y),_=n(this,y),y.constructor_.apply(_,arguments),_}return g(y,A),o(y,[{key:"isIncidentEdgeInResult",value:function(){for(var _=this.getEdges().getEdges().iterator();_.hasNext();)if(_.next().getEdge().isInResult())return!0;return!1}},{key:"isIsolated",value:function(){return this._label.getGeometryCount()===1}},{key:"getCoordinate",value:function(){return this._coord}},{key:"print",value:function(_){_.println("node "+this._coord+" lbl: "+this._label)}},{key:"computeIM",value:function(_){}},{key:"computeMergedLocation",value:function(_,I){var U=Ie.NONE;if(U=this._label.getLocation(I),!_.isNull(I)){var re=_.getLocation(I);U!==Ie.BOUNDARY&&(U=re)}return U}},{key:"setLabel",value:function(){if(arguments.length!==2||!Number.isInteger(arguments[1])||!Number.isInteger(arguments[0]))return S(y,"setLabel",this,1).apply(this,arguments);var _=arguments[0],I=arguments[1];this._label===null?this._label=new En(_,I):this._label.setLocation(_,I)}},{key:"getEdges",value:function(){return this._edges}},{key:"mergeLabel",value:function(){if(arguments[0]instanceof y){var _=arguments[0];this.mergeLabel(_._label)}else if(arguments[0]instanceof En)for(var I=arguments[0],U=0;U<2;U++){var re=this.computeMergedLocation(I,U);this._label.getLocation(U)===Ie.NONE&&this._label.setLocation(U,re)}}},{key:"add",value:function(_){this._edges.insert(_),_.setNode(this)}},{key:"setLabelBoundary",value:function(_){if(this._label===null)return null;var I=Ie.NONE;this._label!==null&&(I=this._label.getLocation(_));var U=null;switch(I){case Ie.BOUNDARY:U=Ie.INTERIOR;break;case Ie.INTERIOR:default:U=Ie.BOUNDARY}this._label.setLocation(_,U)}}],[{key:"constructor_",value:function(){this._coord=null,this._edges=null;var _=arguments[0],I=arguments[1];this._coord=_,this._edges=I,this._label=new En(0,Ie.NONE)}}])})(Wn),Ci=(function(A){function y(){return i(this,y),n(this,y,arguments)}return g(y,A),o(y)})(bu);function Ra(A){return A==null?0:A.color}function gi(A){return A==null?null:A.parent}function jn(A,y){A!==null&&(A.color=y)}function us(A){return A==null?null:A.left}function Un(A){return A==null?null:A.right}var Nn=(function(A){function y(){var _;return i(this,y),(_=n(this,y)).root_=null,_.size_=0,_}return g(y,A),o(y,[{key:"get",value:function(_){for(var I=this.root_;I!==null;){var U=_.compareTo(I.key);if(U<0)I=I.left;else{if(!(U>0))return I.value;I=I.right}}return null}},{key:"put",value:function(_,I){if(this.root_===null)return this.root_={key:_,value:I,left:null,right:null,parent:null,color:0,getValue:function(){return this.value},getKey:function(){return this.key}},this.size_=1,null;var U,re,ye=this.root_;do if(U=ye,(re=_.compareTo(ye.key))<0)ye=ye.left;else{if(!(re>0)){var Re=ye.value;return ye.value=I,Re}ye=ye.right}while(ye!==null);var Ke={key:_,left:null,right:null,value:I,parent:U,color:0,getValue:function(){return this.value},getKey:function(){return this.key}};return re<0?U.left=Ke:U.right=Ke,this.fixAfterInsertion(Ke),this.size_++,null}},{key:"fixAfterInsertion",value:function(_){var I;for(_.color=1;_!=null&&_!==this.root_&&_.parent.color===1;)gi(_)===us(gi(gi(_)))?Ra(I=Un(gi(gi(_))))===1?(jn(gi(_),0),jn(I,0),jn(gi(gi(_)),1),_=gi(gi(_))):(_===Un(gi(_))&&(_=gi(_),this.rotateLeft(_)),jn(gi(_),0),jn(gi(gi(_)),1),this.rotateRight(gi(gi(_)))):Ra(I=us(gi(gi(_))))===1?(jn(gi(_),0),jn(I,0),jn(gi(gi(_)),1),_=gi(gi(_))):(_===us(gi(_))&&(_=gi(_),this.rotateRight(_)),jn(gi(_),0),jn(gi(gi(_)),1),this.rotateLeft(gi(gi(_))));this.root_.color=0}},{key:"values",value:function(){var _=new et,I=this.getFirstEntry();if(I!==null)for(_.add(I.value);(I=y.successor(I))!==null;)_.add(I.value);return _}},{key:"entrySet",value:function(){var _=new Yt,I=this.getFirstEntry();if(I!==null)for(_.add(I);(I=y.successor(I))!==null;)_.add(I);return _}},{key:"rotateLeft",value:function(_){if(_!=null){var I=_.right;_.right=I.left,I.left!=null&&(I.left.parent=_),I.parent=_.parent,_.parent==null?this.root_=I:_.parent.left===_?_.parent.left=I:_.parent.right=I,I.left=_,_.parent=I}}},{key:"rotateRight",value:function(_){if(_!=null){var I=_.left;_.left=I.right,I.right!=null&&(I.right.parent=_),I.parent=_.parent,_.parent==null?this.root_=I:_.parent.right===_?_.parent.right=I:_.parent.left=I,I.right=_,_.parent=I}}},{key:"getFirstEntry",value:function(){var _=this.root_;if(_!=null)for(;_.left!=null;)_=_.left;return _}},{key:"size",value:function(){return this.size_}},{key:"containsKey",value:function(_){for(var I=this.root_;I!==null;){var U=_.compareTo(I.key);if(U<0)I=I.left;else{if(!(U>0))return!0;I=I.right}}return!1}}],[{key:"successor",value:function(_){var I;if(_===null)return null;if(_.right!==null){for(I=_.right;I.left!==null;)I=I.left;return I}I=_.parent;for(var U=_;I!==null&&U===I.right;)U=I,I=I.parent;return I}}])})(Ci),Go=(function(){return o((function A(){i(this,A),A.constructor_.apply(this,arguments)}),[{key:"find",value:function(A){return this.nodeMap.get(A)}},{key:"addNode",value:function(){if(arguments[0]instanceof De){var A=arguments[0],y=this.nodeMap.get(A);return y===null&&(y=this.nodeFact.createNode(A),this.nodeMap.put(A,y)),y}if(arguments[0]instanceof Ma){var _=arguments[0],I=this.nodeMap.get(_.getCoordinate());return I===null?(this.nodeMap.put(_.getCoordinate(),_),_):(I.mergeLabel(_),I)}}},{key:"print",value:function(A){for(var y=this.iterator();y.hasNext();)y.next().print(A)}},{key:"iterator",value:function(){return this.nodeMap.values().iterator()}},{key:"values",value:function(){return this.nodeMap.values()}},{key:"getBoundaryNodes",value:function(A){for(var y=new et,_=this.iterator();_.hasNext();){var I=_.next();I.getLabel().getLocation(A)===Ie.BOUNDARY&&y.add(I)}return y}},{key:"add",value:function(A){var y=A.getCoordinate();this.addNode(y).add(A)}}],[{key:"constructor_",value:function(){this.nodeMap=new Nn,this.nodeFact=null;var A=arguments[0];this.nodeFact=A}}])})(),Yn=(function(){function A(){i(this,A)}return o(A,null,[{key:"isNorthern",value:function(y){return y===A.NE||y===A.NW}},{key:"isOpposite",value:function(y,_){return y!==_&&(y-_+4)%4===2}},{key:"commonHalfPlane",value:function(y,_){if(y===_)return y;if((y-_+4)%4===2)return-1;var I=y<_?y:_;return I===0&&(y>_?y:_)===3?3:I}},{key:"isInHalfPlane",value:function(y,_){return _===A.SE?y===A.SE||y===A.SW:y===_||y===_+1}},{key:"quadrant",value:function(){if(typeof arguments[0]=="number"&&typeof arguments[1]=="number"){var y=arguments[0],_=arguments[1];if(y===0&&_===0)throw new z("Cannot compute the quadrant for point ( "+y+", "+_+" )");return y>=0?_>=0?A.NE:A.SE:_>=0?A.NW:A.SW}if(arguments[0]instanceof De&&arguments[1]instanceof De){var I=arguments[0],U=arguments[1];if(U.x===I.x&&U.y===I.y)throw new z("Cannot compute the quadrant for two identical points "+I);return U.x>=I.x?U.y>=I.y?A.NE:A.SE:U.y>=I.y?A.NW:A.SW}}}])})();Yn.NE=0,Yn.NW=1,Yn.SW=2,Yn.SE=3;var Do=(function(){function A(){i(this,A),A.constructor_.apply(this,arguments)}return o(A,[{key:"compareDirection",value:function(y){return this._dx===y._dx&&this._dy===y._dy?0:this._quadrant>y._quadrant?1:this._quadrant<y._quadrant?-1:be.index(y._p0,y._p1,this._p1)}},{key:"getDy",value:function(){return this._dy}},{key:"getCoordinate",value:function(){return this._p0}},{key:"setNode",value:function(y){this._node=y}},{key:"print",value:function(y){var _=Math.atan2(this._dy,this._dx),I=this.getClass().getName(),U=I.lastIndexOf("."),re=I.substring(U+1);y.print("  "+re+": "+this._p0+" - "+this._p1+" "+this._quadrant+":"+_+"   "+this._label)}},{key:"compareTo",value:function(y){var _=y;return this.compareDirection(_)}},{key:"getDirectedCoordinate",value:function(){return this._p1}},{key:"getDx",value:function(){return this._dx}},{key:"getLabel",value:function(){return this._label}},{key:"getEdge",value:function(){return this._edge}},{key:"getQuadrant",value:function(){return this._quadrant}},{key:"getNode",value:function(){return this._node}},{key:"toString",value:function(){var y=Math.atan2(this._dy,this._dx),_=this.getClass().getName(),I=_.lastIndexOf(".");return"  "+_.substring(I+1)+": "+this._p0+" - "+this._p1+" "+this._quadrant+":"+y+"   "+this._label}},{key:"computeLabel",value:function(y){}},{key:"init",value:function(y,_){this._p0=y,this._p1=_,this._dx=_.x-y.x,this._dy=_.y-y.y,this._quadrant=Yn.quadrant(this._dx,this._dy),xe.isTrue(!(this._dx===0&&this._dy===0),"EdgeEnd with identical endpoints found")}},{key:"interfaces_",get:function(){return[q]}}],[{key:"constructor_",value:function(){if(this._edge=null,this._label=null,this._node=null,this._p0=null,this._p1=null,this._dx=null,this._dy=null,this._quadrant=null,arguments.length===1){var y=arguments[0];this._edge=y}else if(arguments.length===3){var _=arguments[0],I=arguments[1],U=arguments[2];A.constructor_.call(this,_,I,U,null)}else if(arguments.length===4){var re=arguments[0],ye=arguments[1],Re=arguments[2],Ke=arguments[3];A.constructor_.call(this,re),this.init(ye,Re),this._label=Ke}}}])})(),To=(function(A){function y(){var _;return i(this,y),_=n(this,y),y.constructor_.apply(_,arguments),_}return g(y,A),o(y,[{key:"getNextMin",value:function(){return this._nextMin}},{key:"getDepth",value:function(_){return this._depth[_]}},{key:"setVisited",value:function(_){this._isVisited=_}},{key:"computeDirectedLabel",value:function(){this._label=new En(this._edge.getLabel()),this._isForward||this._label.flip()}},{key:"getNext",value:function(){return this._next}},{key:"setDepth",value:function(_,I){if(this._depth[_]!==-999&&this._depth[_]!==I)throw new Qe("assigned depths do not match",this.getCoordinate());this._depth[_]=I}},{key:"isInteriorAreaEdge",value:function(){for(var _=!0,I=0;I<2;I++)this._label.isArea(I)&&this._label.getLocation(I,vt.LEFT)===Ie.INTERIOR&&this._label.getLocation(I,vt.RIGHT)===Ie.INTERIOR||(_=!1);return _}},{key:"setNextMin",value:function(_){this._nextMin=_}},{key:"print",value:function(_){S(y,"print",this,1).call(this,_),_.print(" "+this._depth[vt.LEFT]+"/"+this._depth[vt.RIGHT]),_.print(" ("+this.getDepthDelta()+")"),this._isInResult&&_.print(" inResult")}},{key:"setMinEdgeRing",value:function(_){this._minEdgeRing=_}},{key:"isLineEdge",value:function(){var _=this._label.isLine(0)||this._label.isLine(1),I=!this._label.isArea(0)||this._label.allPositionsEqual(0,Ie.EXTERIOR),U=!this._label.isArea(1)||this._label.allPositionsEqual(1,Ie.EXTERIOR);return _&&I&&U}},{key:"setEdgeRing",value:function(_){this._edgeRing=_}},{key:"getMinEdgeRing",value:function(){return this._minEdgeRing}},{key:"getDepthDelta",value:function(){var _=this._edge.getDepthDelta();return this._isForward||(_=-_),_}},{key:"setInResult",value:function(_){this._isInResult=_}},{key:"getSym",value:function(){return this._sym}},{key:"isForward",value:function(){return this._isForward}},{key:"getEdge",value:function(){return this._edge}},{key:"printEdge",value:function(_){this.print(_),_.print(" "),this._isForward?this._edge.print(_):this._edge.printReverse(_)}},{key:"setSym",value:function(_){this._sym=_}},{key:"setVisitedEdge",value:function(_){this.setVisited(_),this._sym.setVisited(_)}},{key:"setEdgeDepths",value:function(_,I){var U=this.getEdge().getDepthDelta();this._isForward||(U=-U);var re=1;_===vt.LEFT&&(re=-1);var ye=vt.opposite(_),Re=I+U*re;this.setDepth(_,I),this.setDepth(ye,Re)}},{key:"getEdgeRing",value:function(){return this._edgeRing}},{key:"isInResult",value:function(){return this._isInResult}},{key:"setNext",value:function(_){this._next=_}},{key:"isVisited",value:function(){return this._isVisited}}],[{key:"constructor_",value:function(){this._isForward=null,this._isInResult=!1,this._isVisited=!1,this._sym=null,this._next=null,this._nextMin=null,this._edgeRing=null,this._minEdgeRing=null,this._depth=[0,-999,-999];var _=arguments[0],I=arguments[1];if(Do.constructor_.call(this,_),this._isForward=I,I)this.init(_.getCoordinate(0),_.getCoordinate(1));else{var U=_.getNumPoints()-1;this.init(_.getCoordinate(U),_.getCoordinate(U-1))}this.computeDirectedLabel()}},{key:"depthFactor",value:function(_,I){return _===Ie.EXTERIOR&&I===Ie.INTERIOR?1:_===Ie.INTERIOR&&I===Ie.EXTERIOR?-1:0}}])})(Do),Xo=(function(){return o((function A(){i(this,A)}),[{key:"createNode",value:function(A){return new Ma(A,null)}}])})(),tl=(function(){return o((function A(){i(this,A),A.constructor_.apply(this,arguments)}),[{key:"printEdges",value:function(A){A.println("Edges:");for(var y=0;y<this._edges.size();y++){A.println("edge "+y+":");var _=this._edges.get(y);_.print(A),_.eiList.print(A)}}},{key:"find",value:function(A){return this._nodes.find(A)}},{key:"addNode",value:function(){if(arguments[0]instanceof Ma){var A=arguments[0];return this._nodes.addNode(A)}if(arguments[0]instanceof De){var y=arguments[0];return this._nodes.addNode(y)}}},{key:"getNodeIterator",value:function(){return this._nodes.iterator()}},{key:"linkResultDirectedEdges",value:function(){for(var A=this._nodes.iterator();A.hasNext();)A.next().getEdges().linkResultDirectedEdges()}},{key:"debugPrintln",value:function(A){Jt.out.println(A)}},{key:"isBoundaryNode",value:function(A,y){var _=this._nodes.find(y);if(_===null)return!1;var I=_.getLabel();return I!==null&&I.getLocation(A)===Ie.BOUNDARY}},{key:"linkAllDirectedEdges",value:function(){for(var A=this._nodes.iterator();A.hasNext();)A.next().getEdges().linkAllDirectedEdges()}},{key:"matchInSameDirection",value:function(A,y,_,I){return!!A.equals(_)&&be.index(A,y,I)===be.COLLINEAR&&Yn.quadrant(A,y)===Yn.quadrant(_,I)}},{key:"getEdgeEnds",value:function(){return this._edgeEndList}},{key:"debugPrint",value:function(A){Jt.out.print(A)}},{key:"getEdgeIterator",value:function(){return this._edges.iterator()}},{key:"findEdgeInSameDirection",value:function(A,y){for(var _=0;_<this._edges.size();_++){var I=this._edges.get(_),U=I.getCoordinates();if(this.matchInSameDirection(A,y,U[0],U[1])||this.matchInSameDirection(A,y,U[U.length-1],U[U.length-2]))return I}return null}},{key:"insertEdge",value:function(A){this._edges.add(A)}},{key:"findEdgeEnd",value:function(A){for(var y=this.getEdgeEnds().iterator();y.hasNext();){var _=y.next();if(_.getEdge()===A)return _}return null}},{key:"addEdges",value:function(A){for(var y=A.iterator();y.hasNext();){var _=y.next();this._edges.add(_);var I=new To(_,!0),U=new To(_,!1);I.setSym(U),U.setSym(I),this.add(I),this.add(U)}}},{key:"add",value:function(A){this._nodes.add(A),this._edgeEndList.add(A)}},{key:"getNodes",value:function(){return this._nodes.values()}},{key:"findEdge",value:function(A,y){for(var _=0;_<this._edges.size();_++){var I=this._edges.get(_),U=I.getCoordinates();if(A.equals(U[0])&&y.equals(U[1]))return I}return null}}],[{key:"constructor_",value:function(){if(this._edges=new et,this._nodes=null,this._edgeEndList=new et,arguments.length===0)this._nodes=new Go(new Xo);else if(arguments.length===1){var A=arguments[0];this._nodes=new Go(A)}}},{key:"linkResultDirectedEdges",value:function(A){for(var y=A.iterator();y.hasNext();)y.next().getEdges().linkResultDirectedEdges()}}])})(),nu=(function(){function A(){i(this,A),A.constructor_.apply(this,arguments)}return o(A,[{key:"sortShellsAndHoles",value:function(y,_,I){for(var U=y.iterator();U.hasNext();){var re=U.next();re.isHole()?I.add(re):_.add(re)}}},{key:"computePolygons",value:function(y){for(var _=new et,I=y.iterator();I.hasNext();){var U=I.next().toPolygon(this._geometryFactory);_.add(U)}return _}},{key:"placeFreeHoles",value:function(y,_){for(var I=_.iterator();I.hasNext();){var U=I.next();if(U.getShell()===null){var re=A.findEdgeRingContaining(U,y);if(re===null)throw new Qe("unable to assign hole to a shell",U.getCoordinate(0));U.setShell(re)}}}},{key:"buildMinimalEdgeRings",value:function(y,_,I){for(var U=new et,re=y.iterator();re.hasNext();){var ye=re.next();if(ye.getMaxNodeDegree()>2){ye.linkDirectedEdgesForMinimalEdgeRings();var Re=ye.buildMinimalRings(),Ke=this.findShell(Re);Ke!==null?(this.placePolygonHoles(Ke,Re),_.add(Ke)):I.addAll(Re)}else U.add(ye)}return U}},{key:"buildMaximalEdgeRings",value:function(y){for(var _=new et,I=y.iterator();I.hasNext();){var U=I.next();if(U.isInResult()&&U.getLabel().isArea()&&U.getEdgeRing()===null){var re=new cn(U,this._geometryFactory);_.add(re),re.setInResult()}}return _}},{key:"placePolygonHoles",value:function(y,_){for(var I=_.iterator();I.hasNext();){var U=I.next();U.isHole()&&U.setShell(y)}}},{key:"getPolygons",value:function(){return this.computePolygons(this._shellList)}},{key:"findShell",value:function(y){for(var _=0,I=null,U=y.iterator();U.hasNext();){var re=U.next();re.isHole()||(I=re,_++)}return xe.isTrue(_<=1,"found two shells in MinimalEdgeRing list"),I}},{key:"add",value:function(){if(arguments.length===1){var y=arguments[0];this.add(y.getEdgeEnds(),y.getNodes())}else if(arguments.length===2){var _=arguments[0],I=arguments[1];tl.linkResultDirectedEdges(I);var U=this.buildMaximalEdgeRings(_),re=new et,ye=this.buildMinimalEdgeRings(U,this._shellList,re);this.sortShellsAndHoles(ye,this._shellList,re),this.placeFreeHoles(this._shellList,re)}}}],[{key:"constructor_",value:function(){this._geometryFactory=null,this._shellList=new et;var y=arguments[0];this._geometryFactory=y}},{key:"findEdgeRingContaining",value:function(y,_){for(var I=y.getLinearRing(),U=I.getEnvelopeInternal(),re=I.getCoordinateN(0),ye=null,Re=null,Ke=_.iterator();Ke.hasNext();){var yt=Ke.next(),Zt=yt.getLinearRing(),ur=Zt.getEnvelopeInternal();if(!ur.equals(U)&&ur.contains(U)){re=Gi.ptNotInList(I.getCoordinates(),Zt.getCoordinates());var Vr=!1;Qn.isInRing(re,Zt.getCoordinates())&&(Vr=!0),Vr&&(ye===null||Re.contains(ur))&&(Re=(ye=yt).getLinearRing().getEnvelopeInternal())}}return ye}}])})(),_l=(function(){return o((function A(){i(this,A)}),[{key:"getBounds",value:function(){}}])})(),Co=(function(){return o((function A(){i(this,A),A.constructor_.apply(this,arguments)}),[{key:"getItem",value:function(){return this._item}},{key:"getBounds",value:function(){return this._bounds}},{key:"interfaces_",get:function(){return[_l,G]}}],[{key:"constructor_",value:function(){this._bounds=null,this._item=null;var A=arguments[0],y=arguments[1];this._bounds=A,this._item=y}}])})(),rl=(function(){return o((function A(){i(this,A),A.constructor_.apply(this,arguments)}),[{key:"poll",value:function(){if(this.isEmpty())return null;var A=this._items.get(1);return this._items.set(1,this._items.get(this._size)),this._size-=1,this.reorder(1),A}},{key:"size",value:function(){return this._size}},{key:"reorder",value:function(A){for(var y=null,_=this._items.get(A);2*A<=this._size&&((y=2*A)!==this._size&&this._items.get(y+1).compareTo(this._items.get(y))<0&&y++,this._items.get(y).compareTo(_)<0);A=y)this._items.set(A,this._items.get(y));this._items.set(A,_)}},{key:"clear",value:function(){this._size=0,this._items.clear()}},{key:"peek",value:function(){return this.isEmpty()?null:this._items.get(1)}},{key:"isEmpty",value:function(){return this._size===0}},{key:"add",value:function(A){this._items.add(null),this._size+=1;var y=this._size;for(this._items.set(0,A);A.compareTo(this._items.get(Math.trunc(y/2)))<0;y/=2)this._items.set(y,this._items.get(Math.trunc(y/2)));this._items.set(y,A)}}],[{key:"constructor_",value:function(){this._size=null,this._items=null,this._size=0,this._items=new et,this._items.add(null)}}])})(),bl=(function(){return o((function A(){i(this,A)}),[{key:"insert",value:function(A,y){}},{key:"remove",value:function(A,y){}},{key:"query",value:function(){}}])})(),lo=(function(){return o((function A(){i(this,A),A.constructor_.apply(this,arguments)}),[{key:"getLevel",value:function(){return this._level}},{key:"size",value:function(){return this._childBoundables.size()}},{key:"getChildBoundables",value:function(){return this._childBoundables}},{key:"addChildBoundable",value:function(A){xe.isTrue(this._bounds===null),this._childBoundables.add(A)}},{key:"isEmpty",value:function(){return this._childBoundables.isEmpty()}},{key:"getBounds",value:function(){return this._bounds===null&&(this._bounds=this.computeBounds()),this._bounds}},{key:"interfaces_",get:function(){return[_l,G]}}],[{key:"constructor_",value:function(){if(this._childBoundables=new et,this._bounds=null,this._level=null,arguments.length!==0){if(arguments.length===1){var A=arguments[0];this._level=A}}}}])})(),uo={reverseOrder:function(){return{compare:function(A,y){return y.compareTo(A)}}},min:function(A){return uo.sort(A),A.get(0)},sort:function(A,y){var _=A.toArray();y?pt.sort(_,y):pt.sort(_);for(var I=A.iterator(),U=0,re=_.length;U<re;U++)I.next(),I.set(_[U])},singletonList:function(A){var y=new et;return y.add(A),y}},na=(function(){function A(){i(this,A)}return o(A,null,[{key:"maxDistance",value:function(y,_,I,U,re,ye,Re,Ke){var yt=A.distance(y,_,re,ye);return yt=Math.max(yt,A.distance(y,_,Re,Ke)),yt=Math.max(yt,A.distance(I,U,re,ye)),yt=Math.max(yt,A.distance(I,U,Re,Ke))}},{key:"distance",value:function(y,_,I,U){var re=I-y,ye=U-_;return Math.sqrt(re*re+ye*ye)}},{key:"maximumDistance",value:function(y,_){var I=Math.min(y.getMinX(),_.getMinX()),U=Math.min(y.getMinY(),_.getMinY()),re=Math.max(y.getMaxX(),_.getMaxX()),ye=Math.max(y.getMaxY(),_.getMaxY());return A.distance(I,U,re,ye)}},{key:"minMaxDistance",value:function(y,_){var I=y.getMinX(),U=y.getMinY(),re=y.getMaxX(),ye=y.getMaxY(),Re=_.getMinX(),Ke=_.getMinY(),yt=_.getMaxX(),Zt=_.getMaxY(),ur=A.maxDistance(I,U,I,ye,Re,Ke,Re,Zt);return ur=Math.min(ur,A.maxDistance(I,U,I,ye,Re,Ke,yt,Ke)),ur=Math.min(ur,A.maxDistance(I,U,I,ye,yt,Zt,Re,Zt)),ur=Math.min(ur,A.maxDistance(I,U,I,ye,yt,Zt,yt,Ke)),ur=Math.min(ur,A.maxDistance(I,U,re,U,Re,Ke,Re,Zt)),ur=Math.min(ur,A.maxDistance(I,U,re,U,Re,Ke,yt,Ke)),ur=Math.min(ur,A.maxDistance(I,U,re,U,yt,Zt,Re,Zt)),ur=Math.min(ur,A.maxDistance(I,U,re,U,yt,Zt,yt,Ke)),ur=Math.min(ur,A.maxDistance(re,ye,I,ye,Re,Ke,Re,Zt)),ur=Math.min(ur,A.maxDistance(re,ye,I,ye,Re,Ke,yt,Ke)),ur=Math.min(ur,A.maxDistance(re,ye,I,ye,yt,Zt,Re,Zt)),ur=Math.min(ur,A.maxDistance(re,ye,I,ye,yt,Zt,yt,Ke)),ur=Math.min(ur,A.maxDistance(re,ye,re,U,Re,Ke,Re,Zt)),ur=Math.min(ur,A.maxDistance(re,ye,re,U,Re,Ke,yt,Ke)),ur=Math.min(ur,A.maxDistance(re,ye,re,U,yt,Zt,Re,Zt)),ur=Math.min(ur,A.maxDistance(re,ye,re,U,yt,Zt,yt,Ke))}}])})(),Da=(function(){function A(){i(this,A),A.constructor_.apply(this,arguments)}return o(A,[{key:"maximumDistance",value:function(){return na.maximumDistance(this._boundable1.getBounds(),this._boundable2.getBounds())}},{key:"expandToQueue",value:function(y,_){var I=A.isComposite(this._boundable1),U=A.isComposite(this._boundable2);if(I&&U)return A.area(this._boundable1)>A.area(this._boundable2)?(this.expand(this._boundable1,this._boundable2,!1,y,_),null):(this.expand(this._boundable2,this._boundable1,!0,y,_),null);if(I)return this.expand(this._boundable1,this._boundable2,!1,y,_),null;if(U)return this.expand(this._boundable2,this._boundable1,!0,y,_),null;throw new z("neither boundable is composite")}},{key:"isLeaves",value:function(){return!(A.isComposite(this._boundable1)||A.isComposite(this._boundable2))}},{key:"compareTo",value:function(y){var _=y;return this._distance<_._distance?-1:this._distance>_._distance?1:0}},{key:"expand",value:function(y,_,I,U,re){for(var ye=y.getChildBoundables().iterator();ye.hasNext();){var Re=ye.next(),Ke=null;(Ke=I?new A(_,Re,this._itemDistance):new A(Re,_,this._itemDistance)).getDistance()<re&&U.add(Ke)}}},{key:"getBoundable",value:function(y){return y===0?this._boundable1:this._boundable2}},{key:"getDistance",value:function(){return this._distance}},{key:"distance",value:function(){return this.isLeaves()?this._itemDistance.distance(this._boundable1,this._boundable2):this._boundable1.getBounds().distance(this._boundable2.getBounds())}},{key:"interfaces_",get:function(){return[q]}}],[{key:"constructor_",value:function(){this._boundable1=null,this._boundable2=null,this._distance=null,this._itemDistance=null;var y=arguments[0],_=arguments[1],I=arguments[2];this._boundable1=y,this._boundable2=_,this._itemDistance=I,this._distance=this.distance()}},{key:"area",value:function(y){return y.getBounds().getArea()}},{key:"isComposite",value:function(y){return y instanceof lo}}])})(),le=(function(){return o((function A(){i(this,A)}),[{key:"visitItem",value:function(A){}}])})(),Ve=(function(){function A(){i(this,A),A.constructor_.apply(this,arguments)}return o(A,[{key:"queryInternal",value:function(){if(wr(arguments[2],le)&&arguments[0]instanceof Object&&arguments[1]instanceof lo)for(var y=arguments[0],_=arguments[2],I=arguments[1].getChildBoundables(),U=0;U<I.size();U++){var re=I.get(U);this.getIntersectsOp().intersects(re.getBounds(),y)&&(re instanceof lo?this.queryInternal(y,re,_):re instanceof Co?_.visitItem(re.getItem()):xe.shouldNeverReachHere())}else if(wr(arguments[2],cr)&&arguments[0]instanceof Object&&arguments[1]instanceof lo)for(var ye=arguments[0],Re=arguments[2],Ke=arguments[1].getChildBoundables(),yt=0;yt<Ke.size();yt++){var Zt=Ke.get(yt);this.getIntersectsOp().intersects(Zt.getBounds(),ye)&&(Zt instanceof lo?this.queryInternal(ye,Zt,Re):Zt instanceof Co?Re.add(Zt.getItem()):xe.shouldNeverReachHere())}}},{key:"getNodeCapacity",value:function(){return this._nodeCapacity}},{key:"lastNode",value:function(y){return y.get(y.size()-1)}},{key:"size",value:function(){if(arguments.length===0)return this.isEmpty()?0:(this.build(),this.size(this._root));if(arguments.length===1){for(var y=0,_=arguments[0].getChildBoundables().iterator();_.hasNext();){var I=_.next();I instanceof lo?y+=this.size(I):I instanceof Co&&(y+=1)}return y}}},{key:"removeItem",value:function(y,_){for(var I=null,U=y.getChildBoundables().iterator();U.hasNext();){var re=U.next();re instanceof Co&&re.getItem()===_&&(I=re)}return I!==null&&(y.getChildBoundables().remove(I),!0)}},{key:"itemsTree",value:function(){if(arguments.length===0){this.build();var y=this.itemsTree(this._root);return y===null?new et:y}if(arguments.length===1){for(var _=arguments[0],I=new et,U=_.getChildBoundables().iterator();U.hasNext();){var re=U.next();if(re instanceof lo){var ye=this.itemsTree(re);ye!==null&&I.add(ye)}else re instanceof Co?I.add(re.getItem()):xe.shouldNeverReachHere()}return I.size()<=0?null:I}}},{key:"insert",value:function(y,_){xe.isTrue(!this._built,"Cannot insert items into an STR packed R-tree after it has been built."),this._itemBoundables.add(new Co(y,_))}},{key:"boundablesAtLevel",value:function(){if(arguments.length===1){var y=arguments[0],_=new et;return this.boundablesAtLevel(y,this._root,_),_}if(arguments.length===3){var I=arguments[0],U=arguments[1],re=arguments[2];if(xe.isTrue(I>-2),U.getLevel()===I)return re.add(U),null;for(var ye=U.getChildBoundables().iterator();ye.hasNext();){var Re=ye.next();Re instanceof lo?this.boundablesAtLevel(I,Re,re):(xe.isTrue(Re instanceof Co),I===-1&&re.add(Re))}return null}}},{key:"query",value:function(){if(arguments.length===1){var y=arguments[0];this.build();var _=new et;return this.isEmpty()||this.getIntersectsOp().intersects(this._root.getBounds(),y)&&this.queryInternal(y,this._root,_),_}if(arguments.length===2){var I=arguments[0],U=arguments[1];if(this.build(),this.isEmpty())return null;this.getIntersectsOp().intersects(this._root.getBounds(),I)&&this.queryInternal(I,this._root,U)}}},{key:"build",value:function(){if(this._built)return null;this._root=this._itemBoundables.isEmpty()?this.createNode(0):this.createHigherLevels(this._itemBoundables,-1),this._itemBoundables=null,this._built=!0}},{key:"getRoot",value:function(){return this.build(),this._root}},{key:"remove",value:function(){if(arguments.length===2){var y=arguments[0],_=arguments[1];return this.build(),!!this.getIntersectsOp().intersects(this._root.getBounds(),y)&&this.remove(y,this._root,_)}if(arguments.length===3){var I=arguments[0],U=arguments[1],re=arguments[2],ye=this.removeItem(U,re);if(ye)return!0;for(var Re=null,Ke=U.getChildBoundables().iterator();Ke.hasNext();){var yt=Ke.next();if(this.getIntersectsOp().intersects(yt.getBounds(),I)&&yt instanceof lo&&(ye=this.remove(I,yt,re))){Re=yt;break}}return Re!==null&&Re.getChildBoundables().isEmpty()&&U.getChildBoundables().remove(Re),ye}}},{key:"createHigherLevels",value:function(y,_){xe.isTrue(!y.isEmpty());var I=this.createParentBoundables(y,_+1);return I.size()===1?I.get(0):this.createHigherLevels(I,_+1)}},{key:"depth",value:function(){if(arguments.length===0)return this.isEmpty()?0:(this.build(),this.depth(this._root));if(arguments.length===1){for(var y=0,_=arguments[0].getChildBoundables().iterator();_.hasNext();){var I=_.next();if(I instanceof lo){var U=this.depth(I);U>y&&(y=U)}}return y+1}}},{key:"createParentBoundables",value:function(y,_){xe.isTrue(!y.isEmpty());var I=new et;I.add(this.createNode(_));var U=new et(y);uo.sort(U,this.getComparator());for(var re=U.iterator();re.hasNext();){var ye=re.next();this.lastNode(I).getChildBoundables().size()===this.getNodeCapacity()&&I.add(this.createNode(_)),this.lastNode(I).addChildBoundable(ye)}return I}},{key:"isEmpty",value:function(){return this._built?this._root.isEmpty():this._itemBoundables.isEmpty()}},{key:"interfaces_",get:function(){return[G]}}],[{key:"constructor_",value:function(){if(this._root=null,this._built=!1,this._itemBoundables=new et,this._nodeCapacity=null,arguments.length===0)A.constructor_.call(this,A.DEFAULT_NODE_CAPACITY);else if(arguments.length===1){var y=arguments[0];xe.isTrue(y>1,"Node capacity must be greater than 1"),this._nodeCapacity=y}}},{key:"compareDoubles",value:function(y,_){return y>_?1:y<_?-1:0}}])})();Ve.IntersectsOp=function(){},Ve.DEFAULT_NODE_CAPACITY=10;var dt=(function(){return o((function A(){i(this,A)}),[{key:"distance",value:function(A,y){}}])})(),Dt=(function(A){function y(){var _;return i(this,y),_=n(this,y),y.constructor_.apply(_,arguments),_}return g(y,A),o(y,[{key:"createParentBoundablesFromVerticalSlices",value:function(_,I){xe.isTrue(_.length>0);for(var U=new et,re=0;re<_.length;re++)U.addAll(this.createParentBoundablesFromVerticalSlice(_[re],I));return U}},{key:"nearestNeighbourK",value:function(){if(arguments.length===2){var _=arguments[0],I=arguments[1];return this.nearestNeighbourK(_,Te.POSITIVE_INFINITY,I)}if(arguments.length===3){var U=arguments[0],re=arguments[2],ye=arguments[1],Re=new rl;Re.add(U);for(var Ke=new rl;!Re.isEmpty()&&ye>=0;){var yt=Re.poll(),Zt=yt.getDistance();if(Zt>=ye)break;yt.isLeaves()?Ke.size()<re?Ke.add(yt):(Ke.peek().getDistance()>Zt&&(Ke.poll(),Ke.add(yt)),ye=Ke.peek().getDistance()):yt.expandToQueue(Re,ye)}return y.getItems(Ke)}}},{key:"createNode",value:function(_){return new nr(_)}},{key:"size",value:function(){return arguments.length===0?S(y,"size",this,1).call(this):S(y,"size",this,1).apply(this,arguments)}},{key:"insert",value:function(){if(!(arguments.length===2&&arguments[1]instanceof Object&&arguments[0]instanceof Ye))return S(y,"insert",this,1).apply(this,arguments);var _=arguments[0],I=arguments[1];if(_.isNull())return null;S(y,"insert",this,1).call(this,_,I)}},{key:"getIntersectsOp",value:function(){return y.intersectsOp}},{key:"verticalSlices",value:function(_,I){for(var U=Math.trunc(Math.ceil(_.size()/I)),re=new Array(I).fill(null),ye=_.iterator(),Re=0;Re<I;Re++){re[Re]=new et;for(var Ke=0;ye.hasNext()&&Ke<U;){var yt=ye.next();re[Re].add(yt),Ke++}}return re}},{key:"query",value:function(){if(arguments.length===1){var _=arguments[0];return S(y,"query",this,1).call(this,_)}if(arguments.length===2){var I=arguments[0],U=arguments[1];S(y,"query",this,1).call(this,I,U)}}},{key:"getComparator",value:function(){return y.yComparator}},{key:"createParentBoundablesFromVerticalSlice",value:function(_,I){return S(y,"createParentBoundables",this,1).call(this,_,I)}},{key:"remove",value:function(){if(arguments.length===2&&arguments[1]instanceof Object&&arguments[0]instanceof Ye){var _=arguments[0],I=arguments[1];return S(y,"remove",this,1).call(this,_,I)}return S(y,"remove",this,1).apply(this,arguments)}},{key:"depth",value:function(){return arguments.length===0?S(y,"depth",this,1).call(this):S(y,"depth",this,1).apply(this,arguments)}},{key:"createParentBoundables",value:function(_,I){xe.isTrue(!_.isEmpty());var U=Math.trunc(Math.ceil(_.size()/this.getNodeCapacity())),re=new et(_);uo.sort(re,y.xComparator);var ye=this.verticalSlices(re,Math.trunc(Math.ceil(Math.sqrt(U))));return this.createParentBoundablesFromVerticalSlices(ye,I)}},{key:"nearestNeighbour",value:function(){if(arguments.length===1){if(wr(arguments[0],dt)){var _=arguments[0];if(this.isEmpty())return null;var I=new Da(this.getRoot(),this.getRoot(),_);return this.nearestNeighbour(I)}if(arguments[0]instanceof Da){var U=arguments[0],re=Te.POSITIVE_INFINITY,ye=null,Re=new rl;for(Re.add(U);!Re.isEmpty()&&re>0;){var Ke=Re.poll(),yt=Ke.getDistance();if(yt>=re)break;Ke.isLeaves()?(re=yt,ye=Ke):Ke.expandToQueue(Re,re)}return ye===null?null:[ye.getBoundable(0).getItem(),ye.getBoundable(1).getItem()]}}else{if(arguments.length===2){var Zt=arguments[0],ur=arguments[1];if(this.isEmpty()||Zt.isEmpty())return null;var Vr=new Da(this.getRoot(),Zt.getRoot(),ur);return this.nearestNeighbour(Vr)}if(arguments.length===3){var gn=arguments[2],Rn=new Co(arguments[0],arguments[1]),Vn=new Da(this.getRoot(),Rn,gn);return this.nearestNeighbour(Vn)[0]}if(arguments.length===4){var In=arguments[2],Dn=arguments[3],Qi=new Co(arguments[0],arguments[1]),ia=new Da(this.getRoot(),Qi,In);return this.nearestNeighbourK(ia,Dn)}}}},{key:"isWithinDistance",value:function(){if(arguments.length===2){var _=arguments[0],I=arguments[1],U=Te.POSITIVE_INFINITY,re=new rl;for(re.add(_);!re.isEmpty();){var ye=re.poll(),Re=ye.getDistance();if(Re>I)return!1;if(ye.maximumDistance()<=I)return!0;if(ye.isLeaves()){if((U=Re)<=I)return!0}else ye.expandToQueue(re,U)}return!1}if(arguments.length===3){var Ke=arguments[0],yt=arguments[1],Zt=arguments[2],ur=new Da(this.getRoot(),Ke.getRoot(),yt);return this.isWithinDistance(ur,Zt)}}},{key:"interfaces_",get:function(){return[bl,G]}}],[{key:"constructor_",value:function(){if(arguments.length===0)y.constructor_.call(this,y.DEFAULT_NODE_CAPACITY);else if(arguments.length===1){var _=arguments[0];Ve.constructor_.call(this,_)}}},{key:"centreX",value:function(_){return y.avg(_.getMinX(),_.getMaxX())}},{key:"avg",value:function(_,I){return(_+I)/2}},{key:"getItems",value:function(_){for(var I=new Array(_.size()).fill(null),U=0;!_.isEmpty();){var re=_.poll();I[U]=re.getBoundable(0).getItem(),U++}return I}},{key:"centreY",value:function(_){return y.avg(_.getMinY(),_.getMaxY())}}])})(Ve),nr=(function(A){function y(){var _;return i(this,y),_=n(this,y),y.constructor_.apply(_,arguments),_}return g(y,A),o(y,[{key:"computeBounds",value:function(){for(var _=null,I=this.getChildBoundables().iterator();I.hasNext();){var U=I.next();_===null?_=new Ye(U.getBounds()):_.expandToInclude(U.getBounds())}return _}}],[{key:"constructor_",value:function(){var _=arguments[0];lo.constructor_.call(this,_)}}])})(lo);Dt.STRtreeNode=nr,Dt.xComparator=new((function(){return o((function A(){i(this,A)}),[{key:"interfaces_",get:function(){return[ke]}},{key:"compare",value:function(A,y){return Ve.compareDoubles(Dt.centreX(A.getBounds()),Dt.centreX(y.getBounds()))}}])})()),Dt.yComparator=new((function(){return o((function A(){i(this,A)}),[{key:"interfaces_",get:function(){return[ke]}},{key:"compare",value:function(A,y){return Ve.compareDoubles(Dt.centreY(A.getBounds()),Dt.centreY(y.getBounds()))}}])})()),Dt.intersectsOp=new((function(){return o((function A(){i(this,A)}),[{key:"interfaces_",get:function(){return[IntersectsOp]}},{key:"intersects",value:function(A,y){return A.intersects(y)}}])})()),Dt.DEFAULT_NODE_CAPACITY=10;var Lr=(function(){function A(){i(this,A)}return o(A,null,[{key:"relativeSign",value:function(y,_){return y<_?-1:y>_?1:0}},{key:"compare",value:function(y,_,I){if(_.equals2D(I))return 0;var U=A.relativeSign(_.x,I.x),re=A.relativeSign(_.y,I.y);switch(y){case 0:return A.compareValue(U,re);case 1:return A.compareValue(re,U);case 2:return A.compareValue(re,-U);case 3:return A.compareValue(-U,re);case 4:return A.compareValue(-U,-re);case 5:return A.compareValue(-re,-U);case 6:return A.compareValue(-re,U);case 7:return A.compareValue(U,-re)}return xe.shouldNeverReachHere("invalid octant value"),0}},{key:"compareValue",value:function(y,_){return y<0?-1:y>0?1:_<0?-1:_>0?1:0}}])})(),Zr=(function(){return o((function A(){i(this,A),A.constructor_.apply(this,arguments)}),[{key:"getCoordinate",value:function(){return this.coord}},{key:"print",value:function(A){A.print(this.coord),A.print(" seg # = "+this.segmentIndex)}},{key:"compareTo",value:function(A){var y=A;return this.segmentIndex<y.segmentIndex?-1:this.segmentIndex>y.segmentIndex?1:this.coord.equals2D(y.coord)?0:this._isInterior?y._isInterior?Lr.compare(this._segmentOctant,this.coord,y.coord):1:-1}},{key:"isEndPoint",value:function(A){return this.segmentIndex===0&&!this._isInterior||this.segmentIndex===A}},{key:"toString",value:function(){return this.segmentIndex+":"+this.coord.toString()}},{key:"isInterior",value:function(){return this._isInterior}},{key:"interfaces_",get:function(){return[q]}}],[{key:"constructor_",value:function(){this._segString=null,this.coord=null,this.segmentIndex=null,this._segmentOctant=null,this._isInterior=null;var A=arguments[0],y=arguments[1],_=arguments[2],I=arguments[3];this._segString=A,this.coord=new De(y),this.segmentIndex=_,this._segmentOctant=I,this._isInterior=!y.equals2D(A.getCoordinate(_))}}])})(),kn=(function(){return o((function A(){i(this,A)}),[{key:"hasNext",value:function(){}},{key:"next",value:function(){}},{key:"remove",value:function(){}}])})(),wn=(function(){return o((function A(){i(this,A),A.constructor_.apply(this,arguments)}),[{key:"getSplitCoordinates",value:function(){var A=new ma;this.addEndpoints();for(var y=this.iterator(),_=y.next();y.hasNext();){var I=y.next();this.addEdgeCoordinates(_,I,A),_=I}return A.toCoordinateArray()}},{key:"addCollapsedNodes",value:function(){var A=new et;this.findCollapsesFromInsertedNodes(A),this.findCollapsesFromExistingVertices(A);for(var y=A.iterator();y.hasNext();){var _=y.next().intValue();this.add(this._edge.getCoordinate(_),_)}}},{key:"createSplitEdgePts",value:function(A,y){var _=y.segmentIndex-A.segmentIndex+2;if(_===2)return[new De(A.coord),new De(y.coord)];var I=this._edge.getCoordinate(y.segmentIndex),U=y.isInterior()||!y.coord.equals2D(I);U||_--;var re=new Array(_).fill(null),ye=0;re[ye++]=new De(A.coord);for(var Re=A.segmentIndex+1;Re<=y.segmentIndex;Re++)re[ye++]=this._edge.getCoordinate(Re);return U&&(re[ye]=new De(y.coord)),re}},{key:"print",value:function(A){A.println("Intersections:");for(var y=this.iterator();y.hasNext();)y.next().print(A)}},{key:"findCollapsesFromExistingVertices",value:function(A){for(var y=0;y<this._edge.size()-2;y++){var _=this._edge.getCoordinate(y);this._edge.getCoordinate(y+1);var I=this._edge.getCoordinate(y+2);_.equals2D(I)&&A.add(lr.valueOf(y+1))}}},{key:"addEdgeCoordinates",value:function(A,y,_){var I=this.createSplitEdgePts(A,y);_.add(I,!1)}},{key:"iterator",value:function(){return this._nodeMap.values().iterator()}},{key:"addSplitEdges",value:function(A){this.addEndpoints(),this.addCollapsedNodes();for(var y=this.iterator(),_=y.next();y.hasNext();){var I=y.next(),U=this.createSplitEdge(_,I);A.add(U),_=I}}},{key:"findCollapseIndex",value:function(A,y,_){if(!A.coord.equals2D(y.coord))return!1;var I=y.segmentIndex-A.segmentIndex;return y.isInterior()||I--,I===1&&(_[0]=A.segmentIndex+1,!0)}},{key:"findCollapsesFromInsertedNodes",value:function(A){for(var y=new Array(1).fill(null),_=this.iterator(),I=_.next();_.hasNext();){var U=_.next();this.findCollapseIndex(I,U,y)&&A.add(lr.valueOf(y[0])),I=U}}},{key:"getEdge",value:function(){return this._edge}},{key:"addEndpoints",value:function(){var A=this._edge.size()-1;this.add(this._edge.getCoordinate(0),0),this.add(this._edge.getCoordinate(A),A)}},{key:"createSplitEdge",value:function(A,y){var _=this.createSplitEdgePts(A,y);return new $i(_,this._edge.getData())}},{key:"add",value:function(A,y){var _=new Zr(this._edge,A,y,this._edge.getSegmentOctant(y)),I=this._nodeMap.get(_);return I!==null?(xe.isTrue(I.coord.equals2D(A),"Found equal nodes with different coordinates"),I):(this._nodeMap.put(_,_),_)}},{key:"checkSplitEdgesCorrectness",value:function(A){var y=this._edge.getCoordinates(),_=A.get(0).getCoordinate(0);if(!_.equals2D(y[0]))throw new he("bad split edge start point at "+_);var I=A.get(A.size()-1).getCoordinates(),U=I[I.length-1];if(!U.equals2D(y[y.length-1]))throw new he("bad split edge end point at "+U)}}],[{key:"constructor_",value:function(){this._nodeMap=new Nn,this._edge=null;var A=arguments[0];this._edge=A}}])})(),ni=(function(){function A(){i(this,A)}return o(A,null,[{key:"octant",value:function(){if(typeof arguments[0]=="number"&&typeof arguments[1]=="number"){var y=arguments[0],_=arguments[1];if(y===0&&_===0)throw new z("Cannot compute the octant for point ( "+y+", "+_+" )");var I=Math.abs(y),U=Math.abs(_);return y>=0?_>=0?I>=U?0:1:I>=U?7:6:_>=0?I>=U?3:2:I>=U?4:5}if(arguments[0]instanceof De&&arguments[1]instanceof De){var re=arguments[0],ye=arguments[1],Re=ye.x-re.x,Ke=ye.y-re.y;if(Re===0&&Ke===0)throw new z("Cannot compute the octant for two identical points "+re);return A.octant(Re,Ke)}}}])})(),oi=(function(){return o((function A(){i(this,A)}),[{key:"getCoordinates",value:function(){}},{key:"size",value:function(){}},{key:"getCoordinate",value:function(A){}},{key:"isClosed",value:function(){}},{key:"setData",value:function(A){}},{key:"getData",value:function(){}}])})(),Ii=(function(){return o((function A(){i(this,A)}),[{key:"addIntersection",value:function(A,y){}},{key:"interfaces_",get:function(){return[oi]}}])})(),$i=(function(){function A(){i(this,A),A.constructor_.apply(this,arguments)}return o(A,[{key:"getCoordinates",value:function(){return this._pts}},{key:"size",value:function(){return this._pts.length}},{key:"getCoordinate",value:function(y){return this._pts[y]}},{key:"isClosed",value:function(){return this._pts[0].equals(this._pts[this._pts.length-1])}},{key:"getSegmentOctant",value:function(y){return y===this._pts.length-1?-1:this.safeOctant(this.getCoordinate(y),this.getCoordinate(y+1))}},{key:"setData",value:function(y){this._data=y}},{key:"safeOctant",value:function(y,_){return y.equals2D(_)?0:ni.octant(y,_)}},{key:"getData",value:function(){return this._data}},{key:"addIntersection",value:function(){if(arguments.length===2){var y=arguments[0],_=arguments[1];this.addIntersectionNode(y,_)}else if(arguments.length===4){var I=arguments[1],U=arguments[3],re=new De(arguments[0].getIntersection(U));this.addIntersection(re,I)}}},{key:"toString",value:function(){return Yr.toLineString(new oo(this._pts))}},{key:"getNodeList",value:function(){return this._nodeList}},{key:"addIntersectionNode",value:function(y,_){var I=_,U=I+1;if(U<this._pts.length){var re=this._pts[U];y.equals2D(re)&&(I=U)}return this._nodeList.add(y,I)}},{key:"addIntersections",value:function(y,_,I){for(var U=0;U<y.getIntersectionNum();U++)this.addIntersection(y,_,I,U)}},{key:"interfaces_",get:function(){return[Ii]}}],[{key:"constructor_",value:function(){this._nodeList=new wn(this),this._pts=null,this._data=null;var y=arguments[0],_=arguments[1];this._pts=y,this._data=_}},{key:"getNodedSubstrings",value:function(){if(arguments.length===1){var y=arguments[0],_=new et;return A.getNodedSubstrings(y,_),_}if(arguments.length===2)for(var I=arguments[1],U=arguments[0].iterator();U.hasNext();)U.next().getNodeList().addSplitEdges(I)}}])})(),Bi=(function(){function A(){i(this,A),A.constructor_.apply(this,arguments)}return o(A,[{key:"minX",value:function(){return Math.min(this.p0.x,this.p1.x)}},{key:"orientationIndex",value:function(){if(arguments[0]instanceof A){var y=arguments[0],_=be.index(this.p0,this.p1,y.p0),I=be.index(this.p0,this.p1,y.p1);return _>=0&&I>=0||_<=0&&I<=0?Math.max(_,I):0}if(arguments[0]instanceof De){var U=arguments[0];return be.index(this.p0,this.p1,U)}}},{key:"toGeometry",value:function(y){return y.createLineString([this.p0,this.p1])}},{key:"isVertical",value:function(){return this.p0.x===this.p1.x}},{key:"equals",value:function(y){if(!(y instanceof A))return!1;var _=y;return this.p0.equals(_.p0)&&this.p1.equals(_.p1)}},{key:"intersection",value:function(y){var _=new kr;return _.computeIntersection(this.p0,this.p1,y.p0,y.p1),_.hasIntersection()?_.getIntersection(0):null}},{key:"project",value:function(){if(arguments[0]instanceof De){var y=arguments[0];if(y.equals(this.p0)||y.equals(this.p1))return new De(y);var _=this.projectionFactor(y),I=new De;return I.x=this.p0.x+_*(this.p1.x-this.p0.x),I.y=this.p0.y+_*(this.p1.y-this.p0.y),I}if(arguments[0]instanceof A){var U=arguments[0],re=this.projectionFactor(U.p0),ye=this.projectionFactor(U.p1);if(re>=1&&ye>=1||re<=0&&ye<=0)return null;var Re=this.project(U.p0);re<0&&(Re=this.p0),re>1&&(Re=this.p1);var Ke=this.project(U.p1);return ye<0&&(Ke=this.p0),ye>1&&(Ke=this.p1),new A(Re,Ke)}}},{key:"normalize",value:function(){this.p1.compareTo(this.p0)<0&&this.reverse()}},{key:"angle",value:function(){return Math.atan2(this.p1.y-this.p0.y,this.p1.x-this.p0.x)}},{key:"getCoordinate",value:function(y){return y===0?this.p0:this.p1}},{key:"distancePerpendicular",value:function(y){return Rr.pointToLinePerpendicular(y,this.p0,this.p1)}},{key:"minY",value:function(){return Math.min(this.p0.y,this.p1.y)}},{key:"midPoint",value:function(){return A.midPoint(this.p0,this.p1)}},{key:"projectionFactor",value:function(y){if(y.equals(this.p0))return 0;if(y.equals(this.p1))return 1;var _=this.p1.x-this.p0.x,I=this.p1.y-this.p0.y,U=_*_+I*I;return U<=0?Te.NaN:((y.x-this.p0.x)*_+(y.y-this.p0.y)*I)/U}},{key:"closestPoints",value:function(y){var _=this.intersection(y);if(_!==null)return[_,_];var I=new Array(2).fill(null),U=Te.MAX_VALUE,re=null,ye=this.closestPoint(y.p0);U=ye.distance(y.p0),I[0]=ye,I[1]=y.p0;var Re=this.closestPoint(y.p1);(re=Re.distance(y.p1))<U&&(U=re,I[0]=Re,I[1]=y.p1);var Ke=y.closestPoint(this.p0);(re=Ke.distance(this.p0))<U&&(U=re,I[0]=this.p0,I[1]=Ke);var yt=y.closestPoint(this.p1);return(re=yt.distance(this.p1))<U&&(U=re,I[0]=this.p1,I[1]=yt),I}},{key:"closestPoint",value:function(y){var _=this.projectionFactor(y);return _>0&&_<1?this.project(y):this.p0.distance(y)<this.p1.distance(y)?this.p0:this.p1}},{key:"maxX",value:function(){return Math.max(this.p0.x,this.p1.x)}},{key:"getLength",value:function(){return this.p0.distance(this.p1)}},{key:"compareTo",value:function(y){var _=y,I=this.p0.compareTo(_.p0);return I!==0?I:this.p1.compareTo(_.p1)}},{key:"reverse",value:function(){var y=this.p0;this.p0=this.p1,this.p1=y}},{key:"equalsTopo",value:function(y){return this.p0.equals(y.p0)&&this.p1.equals(y.p1)||this.p0.equals(y.p1)&&this.p1.equals(y.p0)}},{key:"lineIntersection",value:function(y){return jt.intersection(this.p0,this.p1,y.p0,y.p1)}},{key:"maxY",value:function(){return Math.max(this.p0.y,this.p1.y)}},{key:"pointAlongOffset",value:function(y,_){var I=this.p0.x+y*(this.p1.x-this.p0.x),U=this.p0.y+y*(this.p1.y-this.p0.y),re=this.p1.x-this.p0.x,ye=this.p1.y-this.p0.y,Re=Math.sqrt(re*re+ye*ye),Ke=0,yt=0;if(_!==0){if(Re<=0)throw new IllegalStateException("Cannot compute offset from zero-length line segment");Ke=_*re/Re,yt=_*ye/Re}return new De(I-yt,U+Ke)}},{key:"setCoordinates",value:function(){if(arguments.length===1){var y=arguments[0];this.setCoordinates(y.p0,y.p1)}else if(arguments.length===2){var _=arguments[0],I=arguments[1];this.p0.x=_.x,this.p0.y=_.y,this.p1.x=I.x,this.p1.y=I.y}}},{key:"segmentFraction",value:function(y){var _=this.projectionFactor(y);return _<0?_=0:(_>1||Te.isNaN(_))&&(_=1),_}},{key:"toString",value:function(){return"LINESTRING( "+this.p0.x+" "+this.p0.y+", "+this.p1.x+" "+this.p1.y+")"}},{key:"isHorizontal",value:function(){return this.p0.y===this.p1.y}},{key:"reflect",value:function(y){var _=this.p1.getY()-this.p0.getY(),I=this.p0.getX()-this.p1.getX(),U=this.p0.getY()*(this.p1.getX()-this.p0.getX())-this.p0.getX()*(this.p1.getY()-this.p0.getY()),re=_*_+I*I,ye=_*_-I*I,Re=y.getX(),Ke=y.getY();return new De((-ye*Re-2*_*I*Ke-2*_*U)/re,(ye*Ke-2*_*I*Re-2*I*U)/re)}},{key:"distance",value:function(){if(arguments[0]instanceof A){var y=arguments[0];return Rr.segmentToSegment(this.p0,this.p1,y.p0,y.p1)}if(arguments[0]instanceof De){var _=arguments[0];return Rr.pointToSegment(_,this.p0,this.p1)}}},{key:"pointAlong",value:function(y){var _=new De;return _.x=this.p0.x+y*(this.p1.x-this.p0.x),_.y=this.p0.y+y*(this.p1.y-this.p0.y),_}},{key:"hashCode",value:function(){var y=Te.doubleToLongBits(this.p0.x);y^=31*Te.doubleToLongBits(this.p0.y);var _=Math.trunc(y)^Math.trunc(y>>32),I=Te.doubleToLongBits(this.p1.x);return I^=31*Te.doubleToLongBits(this.p1.y),_^(Math.trunc(I)^Math.trunc(I>>32))}},{key:"interfaces_",get:function(){return[q,G]}}],[{key:"constructor_",value:function(){if(this.p0=null,this.p1=null,arguments.length===0)A.constructor_.call(this,new De,new De);else if(arguments.length===1){var y=arguments[0];A.constructor_.call(this,y.p0,y.p1)}else if(arguments.length===2){var _=arguments[0],I=arguments[1];this.p0=_,this.p1=I}else if(arguments.length===4){var U=arguments[0],re=arguments[1],ye=arguments[2],Re=arguments[3];A.constructor_.call(this,new De(U,re),new De(ye,Re))}}},{key:"midPoint",value:function(y,_){return new De((y.x+_.x)/2,(y.y+_.y)/2)}}])})(),Ti=(function(){return o((function A(){i(this,A),A.constructor_.apply(this,arguments)}),[{key:"overlap",value:function(){if(arguments.length!==2){if(arguments.length===4){var A=arguments[1],y=arguments[2],_=arguments[3];arguments[0].getLineSegment(A,this._overlapSeg1),y.getLineSegment(_,this._overlapSeg2),this.overlap(this._overlapSeg1,this._overlapSeg2)}}}}],[{key:"constructor_",value:function(){this._overlapSeg1=new Bi,this._overlapSeg2=new Bi}}])})(),Fa=(function(){return o((function A(){i(this,A),A.constructor_.apply(this,arguments)}),[{key:"getLineSegment",value:function(A,y){y.p0=this._pts[A],y.p1=this._pts[A+1]}},{key:"computeSelect",value:function(A,y,_,I){var U=this._pts[y],re=this._pts[_];if(_-y==1)return I.select(this,y),null;if(!A.intersects(U,re))return null;var ye=Math.trunc((y+_)/2);y<ye&&this.computeSelect(A,y,ye,I),ye<_&&this.computeSelect(A,ye,_,I)}},{key:"getCoordinates",value:function(){for(var A=new Array(this._end-this._start+1).fill(null),y=0,_=this._start;_<=this._end;_++)A[y++]=this._pts[_];return A}},{key:"computeOverlaps",value:function(){if(arguments.length===2){var A=arguments[0],y=arguments[1];this.computeOverlaps(this._start,this._end,A,A._start,A._end,y)}else if(arguments.length===6){var _=arguments[0],I=arguments[1],U=arguments[2],re=arguments[3],ye=arguments[4],Re=arguments[5];if(I-_==1&&ye-re==1)return Re.overlap(this,_,U,re),null;if(!this.overlaps(_,I,U,re,ye))return null;var Ke=Math.trunc((_+I)/2),yt=Math.trunc((re+ye)/2);_<Ke&&(re<yt&&this.computeOverlaps(_,Ke,U,re,yt,Re),yt<ye&&this.computeOverlaps(_,Ke,U,yt,ye,Re)),Ke<I&&(re<yt&&this.computeOverlaps(Ke,I,U,re,yt,Re),yt<ye&&this.computeOverlaps(Ke,I,U,yt,ye,Re))}}},{key:"setId",value:function(A){this._id=A}},{key:"select",value:function(A,y){this.computeSelect(A,this._start,this._end,y)}},{key:"getEnvelope",value:function(){if(this._env===null){var A=this._pts[this._start],y=this._pts[this._end];this._env=new Ye(A,y)}return this._env}},{key:"overlaps",value:function(A,y,_,I,U){return Ye.intersects(this._pts[A],this._pts[y],_._pts[I],_._pts[U])}},{key:"getEndIndex",value:function(){return this._end}},{key:"getStartIndex",value:function(){return this._start}},{key:"getContext",value:function(){return this._context}},{key:"getId",value:function(){return this._id}}],[{key:"constructor_",value:function(){this._pts=null,this._start=null,this._end=null,this._env=null,this._context=null,this._id=null;var A=arguments[0],y=arguments[1],_=arguments[2],I=arguments[3];this._pts=A,this._start=y,this._end=_,this._context=I}}])})(),fa=(function(){function A(){i(this,A)}return o(A,null,[{key:"findChainEnd",value:function(y,_){for(var I=_;I<y.length-1&&y[I].equals2D(y[I+1]);)I++;if(I>=y.length-1)return y.length-1;for(var U=Yn.quadrant(y[I],y[I+1]),re=_+1;re<y.length&&!(!y[re-1].equals2D(y[re])&&Yn.quadrant(y[re-1],y[re])!==U);)re++;return re-1}},{key:"getChains",value:function(){if(arguments.length===1){var y=arguments[0];return A.getChains(y,null)}if(arguments.length===2){var _=arguments[0],I=arguments[1],U=new et,re=0;do{var ye=A.findChainEnd(_,re),Re=new Fa(_,re,ye,I);U.add(Re),re=ye}while(re<_.length-1);return U}}}])})(),Qa=(function(){return o((function A(){i(this,A)}),[{key:"computeNodes",value:function(A){}},{key:"getNodedSubstrings",value:function(){}}])})(),bs=(function(){return o((function A(){i(this,A),A.constructor_.apply(this,arguments)}),[{key:"setSegmentIntersector",value:function(A){this._segInt=A}},{key:"interfaces_",get:function(){return[Qa]}}],[{key:"constructor_",value:function(){if(this._segInt=null,arguments.length!==0){if(arguments.length===1){var A=arguments[0];this.setSegmentIntersector(A)}}}}])})(),nl=(function(A){function y(){var _;return i(this,y),_=n(this,y),y.constructor_.apply(_,arguments),_}return g(y,A),o(y,[{key:"getMonotoneChains",value:function(){return this._monoChains}},{key:"getNodedSubstrings",value:function(){return $i.getNodedSubstrings(this._nodedSegStrings)}},{key:"getIndex",value:function(){return this._index}},{key:"add",value:function(_){for(var I=fa.getChains(_.getCoordinates(),_).iterator();I.hasNext();){var U=I.next();U.setId(this._idCounter++),this._index.insert(U.getEnvelope(),U),this._monoChains.add(U)}}},{key:"computeNodes",value:function(_){this._nodedSegStrings=_;for(var I=_.iterator();I.hasNext();)this.add(I.next());this.intersectChains()}},{key:"intersectChains",value:function(){for(var _=new Su(this._segInt),I=this._monoChains.iterator();I.hasNext();)for(var U=I.next(),re=this._index.query(U.getEnvelope()).iterator();re.hasNext();){var ye=re.next();if(ye.getId()>U.getId()&&(U.computeOverlaps(ye,_),this._nOverlaps++),this._segInt.isDone())return null}}}],[{key:"constructor_",value:function(){if(this._monoChains=new et,this._index=new Dt,this._idCounter=0,this._nodedSegStrings=null,this._nOverlaps=0,arguments.length!==0){if(arguments.length===1){var _=arguments[0];bs.constructor_.call(this,_)}}}}])})(bs),Su=(function(A){function y(){var _;return i(this,y),_=n(this,y),y.constructor_.apply(_,arguments),_}return g(y,A),o(y,[{key:"overlap",value:function(){if(arguments.length!==4)return S(y,"overlap",this,1).apply(this,arguments);var _=arguments[1],I=arguments[2],U=arguments[3],re=arguments[0].getContext(),ye=I.getContext();this._si.processIntersections(re,_,ye,U)}}],[{key:"constructor_",value:function(){this._si=null;var _=arguments[0];this._si=_}}])})(Ti);nl.SegmentOverlapAction=Su;var Fo=(function(){function A(){i(this,A),A.constructor_.apply(this,arguments)}return o(A,[{key:"isDeletable",value:function(y,_,I,U){var re=this._inputLine[y],ye=this._inputLine[_],Re=this._inputLine[I];return!!this.isConcave(re,ye,Re)&&!!this.isShallow(re,ye,Re,U)&&this.isShallowSampled(re,ye,y,I,U)}},{key:"deleteShallowConcavities",value:function(){for(var y=1,_=this.findNextNonDeletedIndex(y),I=this.findNextNonDeletedIndex(_),U=!1;I<this._inputLine.length;){var re=!1;this.isDeletable(y,_,I,this._distanceTol)&&(this._isDeleted[_]=A.DELETE,re=!0,U=!0),y=re?I:_,_=this.findNextNonDeletedIndex(y),I=this.findNextNonDeletedIndex(_)}return U}},{key:"isShallowConcavity",value:function(y,_,I,U){return be.index(y,_,I)===this._angleOrientation&&Rr.pointToSegment(_,y,I)<U}},{key:"isShallowSampled",value:function(y,_,I,U,re){var ye=Math.trunc((U-I)/A.NUM_PTS_TO_CHECK);ye<=0&&(ye=1);for(var Re=I;Re<U;Re+=ye)if(!this.isShallow(y,_,this._inputLine[Re],re))return!1;return!0}},{key:"isConcave",value:function(y,_,I){var U=be.index(y,_,I)===this._angleOrientation;return U}},{key:"simplify",value:function(y){this._distanceTol=Math.abs(y),y<0&&(this._angleOrientation=be.CLOCKWISE),this._isDeleted=new Array(this._inputLine.length).fill(null);var _=!1;do _=this.deleteShallowConcavities();while(_);return this.collapseLine()}},{key:"findNextNonDeletedIndex",value:function(y){for(var _=y+1;_<this._inputLine.length&&this._isDeleted[_]===A.DELETE;)_++;return _}},{key:"isShallow",value:function(y,_,I,U){return Rr.pointToSegment(_,y,I)<U}},{key:"collapseLine",value:function(){for(var y=new ma,_=0;_<this._inputLine.length;_++)this._isDeleted[_]!==A.DELETE&&y.add(this._inputLine[_]);return y.toCoordinateArray()}}],[{key:"constructor_",value:function(){this._inputLine=null,this._distanceTol=null,this._isDeleted=null,this._angleOrientation=be.COUNTERCLOCKWISE;var y=arguments[0];this._inputLine=y}},{key:"simplify",value:function(y,_){return new A(y).simplify(_)}}])})();Fo.INIT=0,Fo.DELETE=1,Fo.KEEP=1,Fo.NUM_PTS_TO_CHECK=10;var Dl=(function(){function A(){i(this,A),A.constructor_.apply(this,arguments)}return o(A,[{key:"getCoordinates",value:function(){return this._ptList.toArray(A.COORDINATE_ARRAY_TYPE)}},{key:"setPrecisionModel",value:function(y){this._precisionModel=y}},{key:"addPt",value:function(y){var _=new De(y);if(this._precisionModel.makePrecise(_),this.isRedundant(_))return null;this._ptList.add(_)}},{key:"reverse",value:function(){}},{key:"addPts",value:function(y,_){if(_)for(var I=0;I<y.length;I++)this.addPt(y[I]);else for(var U=y.length-1;U>=0;U--)this.addPt(y[U])}},{key:"isRedundant",value:function(y){if(this._ptList.size()<1)return!1;var _=this._ptList.get(this._ptList.size()-1);return y.distance(_)<this._minimimVertexDistance}},{key:"toString",value:function(){return new No().createLineString(this.getCoordinates()).toString()}},{key:"closeRing",value:function(){if(this._ptList.size()<1)return null;var y=new De(this._ptList.get(0)),_=this._ptList.get(this._ptList.size()-1);if(y.equals(_))return null;this._ptList.add(y)}},{key:"setMinimumVertexDistance",value:function(y){this._minimimVertexDistance=y}}],[{key:"constructor_",value:function(){this._ptList=null,this._precisionModel=null,this._minimimVertexDistance=0,this._ptList=new et}}])})();Dl.COORDINATE_ARRAY_TYPE=new Array(0).fill(null);var aa=(function(){function A(){i(this,A)}return o(A,null,[{key:"toDegrees",value:function(y){return 180*y/Math.PI}},{key:"normalize",value:function(y){for(;y>Math.PI;)y-=A.PI_TIMES_2;for(;y<=-Math.PI;)y+=A.PI_TIMES_2;return y}},{key:"angle",value:function(){if(arguments.length===1){var y=arguments[0];return Math.atan2(y.y,y.x)}if(arguments.length===2){var _=arguments[0],I=arguments[1],U=I.x-_.x,re=I.y-_.y;return Math.atan2(re,U)}}},{key:"isAcute",value:function(y,_,I){var U=y.x-_.x,re=y.y-_.y;return U*(I.x-_.x)+re*(I.y-_.y)>0}},{key:"isObtuse",value:function(y,_,I){var U=y.x-_.x,re=y.y-_.y;return U*(I.x-_.x)+re*(I.y-_.y)<0}},{key:"interiorAngle",value:function(y,_,I){var U=A.angle(_,y),re=A.angle(_,I);return Math.abs(re-U)}},{key:"normalizePositive",value:function(y){if(y<0){for(;y<0;)y+=A.PI_TIMES_2;y>=A.PI_TIMES_2&&(y=0)}else{for(;y>=A.PI_TIMES_2;)y-=A.PI_TIMES_2;y<0&&(y=0)}return y}},{key:"angleBetween",value:function(y,_,I){var U=A.angle(_,y),re=A.angle(_,I);return A.diff(U,re)}},{key:"diff",value:function(y,_){var I=null;return(I=y<_?_-y:y-_)>Math.PI&&(I=2*Math.PI-I),I}},{key:"toRadians",value:function(y){return y*Math.PI/180}},{key:"getTurn",value:function(y,_){var I=Math.sin(_-y);return I>0?A.COUNTERCLOCKWISE:I<0?A.CLOCKWISE:A.NONE}},{key:"angleBetweenOriented",value:function(y,_,I){var U=A.angle(_,y),re=A.angle(_,I)-U;return re<=-Math.PI?re+A.PI_TIMES_2:re>Math.PI?re-A.PI_TIMES_2:re}}])})();aa.PI_TIMES_2=2*Math.PI,aa.PI_OVER_2=Math.PI/2,aa.PI_OVER_4=Math.PI/4,aa.COUNTERCLOCKWISE=be.COUNTERCLOCKWISE,aa.CLOCKWISE=be.CLOCKWISE,aa.NONE=be.COLLINEAR;var xl=(function(){function A(){i(this,A),A.constructor_.apply(this,arguments)}return o(A,[{key:"addNextSegment",value:function(y,_){if(this._s0=this._s1,this._s1=this._s2,this._s2=y,this._seg0.setCoordinates(this._s0,this._s1),this.computeOffsetSegment(this._seg0,this._side,this._distance,this._offset0),this._seg1.setCoordinates(this._s1,this._s2),this.computeOffsetSegment(this._seg1,this._side,this._distance,this._offset1),this._s1.equals(this._s2))return null;var I=be.index(this._s0,this._s1,this._s2),U=I===be.CLOCKWISE&&this._side===vt.LEFT||I===be.COUNTERCLOCKWISE&&this._side===vt.RIGHT;I===0?this.addCollinear(_):U?this.addOutsideTurn(I,_):this.addInsideTurn(I,_)}},{key:"addLineEndCap",value:function(y,_){var I=new Bi(y,_),U=new Bi;this.computeOffsetSegment(I,vt.LEFT,this._distance,U);var re=new Bi;this.computeOffsetSegment(I,vt.RIGHT,this._distance,re);var ye=_.x-y.x,Re=_.y-y.y,Ke=Math.atan2(Re,ye);switch(this._bufParams.getEndCapStyle()){case O.CAP_ROUND:this._segList.addPt(U.p1),this.addDirectedFillet(_,Ke+Math.PI/2,Ke-Math.PI/2,be.CLOCKWISE,this._distance),this._segList.addPt(re.p1);break;case O.CAP_FLAT:this._segList.addPt(U.p1),this._segList.addPt(re.p1);break;case O.CAP_SQUARE:var yt=new De;yt.x=Math.abs(this._distance)*Math.cos(Ke),yt.y=Math.abs(this._distance)*Math.sin(Ke);var Zt=new De(U.p1.x+yt.x,U.p1.y+yt.y),ur=new De(re.p1.x+yt.x,re.p1.y+yt.y);this._segList.addPt(Zt),this._segList.addPt(ur)}}},{key:"getCoordinates",value:function(){return this._segList.getCoordinates()}},{key:"addMitreJoin",value:function(y,_,I,U){var re=jt.intersection(_.p0,_.p1,I.p0,I.p1);if(re!==null&&(U<=0?1:re.distance(y)/Math.abs(U))<=this._bufParams.getMitreLimit())return this._segList.addPt(re),null;this.addLimitedMitreJoin(_,I,U,this._bufParams.getMitreLimit())}},{key:"addOutsideTurn",value:function(y,_){if(this._offset0.p1.distance(this._offset1.p0)<this._distance*A.OFFSET_SEGMENT_SEPARATION_FACTOR)return this._segList.addPt(this._offset0.p1),null;this._bufParams.getJoinStyle()===O.JOIN_MITRE?this.addMitreJoin(this._s1,this._offset0,this._offset1,this._distance):this._bufParams.getJoinStyle()===O.JOIN_BEVEL?this.addBevelJoin(this._offset0,this._offset1):(_&&this._segList.addPt(this._offset0.p1),this.addCornerFillet(this._s1,this._offset0.p1,this._offset1.p0,y,this._distance),this._segList.addPt(this._offset1.p0))}},{key:"createSquare",value:function(y){this._segList.addPt(new De(y.x+this._distance,y.y+this._distance)),this._segList.addPt(new De(y.x+this._distance,y.y-this._distance)),this._segList.addPt(new De(y.x-this._distance,y.y-this._distance)),this._segList.addPt(new De(y.x-this._distance,y.y+this._distance)),this._segList.closeRing()}},{key:"addSegments",value:function(y,_){this._segList.addPts(y,_)}},{key:"addFirstSegment",value:function(){this._segList.addPt(this._offset1.p0)}},{key:"addCornerFillet",value:function(y,_,I,U,re){var ye=_.x-y.x,Re=_.y-y.y,Ke=Math.atan2(Re,ye),yt=I.x-y.x,Zt=I.y-y.y,ur=Math.atan2(Zt,yt);U===be.CLOCKWISE?Ke<=ur&&(Ke+=2*Math.PI):Ke>=ur&&(Ke-=2*Math.PI),this._segList.addPt(_),this.addDirectedFillet(y,Ke,ur,U,re),this._segList.addPt(I)}},{key:"addLastSegment",value:function(){this._segList.addPt(this._offset1.p1)}},{key:"initSideSegments",value:function(y,_,I){this._s1=y,this._s2=_,this._side=I,this._seg1.setCoordinates(y,_),this.computeOffsetSegment(this._seg1,I,this._distance,this._offset1)}},{key:"addLimitedMitreJoin",value:function(y,_,I,U){var re=this._seg0.p1,ye=aa.angle(re,this._seg0.p0),Re=aa.angleBetweenOriented(this._seg0.p0,re,this._seg1.p1)/2,Ke=aa.normalize(ye+Re),yt=aa.normalize(Ke+Math.PI),Zt=U*I,ur=I-Zt*Math.abs(Math.sin(Re)),Vr=re.x+Zt*Math.cos(yt),gn=re.y+Zt*Math.sin(yt),Rn=new De(Vr,gn),Vn=new Bi(re,Rn),In=Vn.pointAlongOffset(1,ur),Dn=Vn.pointAlongOffset(1,-ur);this._side===vt.LEFT?(this._segList.addPt(In),this._segList.addPt(Dn)):(this._segList.addPt(Dn),this._segList.addPt(In))}},{key:"addDirectedFillet",value:function(y,_,I,U,re){var ye=U===be.CLOCKWISE?-1:1,Re=Math.abs(_-I),Ke=Math.trunc(Re/this._filletAngleQuantum+.5);if(Ke<1)return null;for(var yt=Re/Ke,Zt=new De,ur=0;ur<Ke;ur++){var Vr=_+ye*ur*yt;Zt.x=y.x+re*Math.cos(Vr),Zt.y=y.y+re*Math.sin(Vr),this._segList.addPt(Zt)}}},{key:"computeOffsetSegment",value:function(y,_,I,U){var re=_===vt.LEFT?1:-1,ye=y.p1.x-y.p0.x,Re=y.p1.y-y.p0.y,Ke=Math.sqrt(ye*ye+Re*Re),yt=re*I*ye/Ke,Zt=re*I*Re/Ke;U.p0.x=y.p0.x-Zt,U.p0.y=y.p0.y+yt,U.p1.x=y.p1.x-Zt,U.p1.y=y.p1.y+yt}},{key:"addInsideTurn",value:function(y,_){if(this._li.computeIntersection(this._offset0.p0,this._offset0.p1,this._offset1.p0,this._offset1.p1),this._li.hasIntersection())this._segList.addPt(this._li.getIntersection(0));else if(this._hasNarrowConcaveAngle=!0,this._offset0.p1.distance(this._offset1.p0)<this._distance*A.INSIDE_TURN_VERTEX_SNAP_DISTANCE_FACTOR)this._segList.addPt(this._offset0.p1);else{if(this._segList.addPt(this._offset0.p1),this._closingSegLengthFactor>0){var I=new De((this._closingSegLengthFactor*this._offset0.p1.x+this._s1.x)/(this._closingSegLengthFactor+1),(this._closingSegLengthFactor*this._offset0.p1.y+this._s1.y)/(this._closingSegLengthFactor+1));this._segList.addPt(I);var U=new De((this._closingSegLengthFactor*this._offset1.p0.x+this._s1.x)/(this._closingSegLengthFactor+1),(this._closingSegLengthFactor*this._offset1.p0.y+this._s1.y)/(this._closingSegLengthFactor+1));this._segList.addPt(U)}else this._segList.addPt(this._s1);this._segList.addPt(this._offset1.p0)}}},{key:"createCircle",value:function(y){var _=new De(y.x+this._distance,y.y);this._segList.addPt(_),this.addDirectedFillet(y,0,2*Math.PI,-1,this._distance),this._segList.closeRing()}},{key:"addBevelJoin",value:function(y,_){this._segList.addPt(y.p1),this._segList.addPt(_.p0)}},{key:"init",value:function(y){this._distance=y,this._maxCurveSegmentError=y*(1-Math.cos(this._filletAngleQuantum/2)),this._segList=new Dl,this._segList.setPrecisionModel(this._precisionModel),this._segList.setMinimumVertexDistance(y*A.CURVE_VERTEX_SNAP_DISTANCE_FACTOR)}},{key:"addCollinear",value:function(y){this._li.computeIntersection(this._s0,this._s1,this._s1,this._s2),this._li.getIntersectionNum()>=2&&(this._bufParams.getJoinStyle()===O.JOIN_BEVEL||this._bufParams.getJoinStyle()===O.JOIN_MITRE?(y&&this._segList.addPt(this._offset0.p1),this._segList.addPt(this._offset1.p0)):this.addCornerFillet(this._s1,this._offset0.p1,this._offset1.p0,be.CLOCKWISE,this._distance))}},{key:"closeRing",value:function(){this._segList.closeRing()}},{key:"hasNarrowConcaveAngle",value:function(){return this._hasNarrowConcaveAngle}}],[{key:"constructor_",value:function(){this._maxCurveSegmentError=0,this._filletAngleQuantum=null,this._closingSegLengthFactor=1,this._segList=null,this._distance=0,this._precisionModel=null,this._bufParams=null,this._li=null,this._s0=null,this._s1=null,this._s2=null,this._seg0=new Bi,this._seg1=new Bi,this._offset0=new Bi,this._offset1=new Bi,this._side=0,this._hasNarrowConcaveAngle=!1;var y=arguments[0],_=arguments[1],I=arguments[2];this._precisionModel=y,this._bufParams=_,this._li=new kr,this._filletAngleQuantum=Math.PI/2/_.getQuadrantSegments(),_.getQuadrantSegments()>=8&&_.getJoinStyle()===O.JOIN_ROUND&&(this._closingSegLengthFactor=A.MAX_CLOSING_SEG_LEN_FACTOR),this.init(I)}}])})();xl.OFFSET_SEGMENT_SEPARATION_FACTOR=.001,xl.INSIDE_TURN_VERTEX_SNAP_DISTANCE_FACTOR=.001,xl.CURVE_VERTEX_SNAP_DISTANCE_FACTOR=1e-6,xl.MAX_CLOSING_SEG_LEN_FACTOR=80;var iu=(function(){function A(){i(this,A),A.constructor_.apply(this,arguments)}return o(A,[{key:"getOffsetCurve",value:function(y,_){if(this._distance=_,_===0)return null;var I=_<0,U=Math.abs(_),re=this.getSegGen(U);y.length<=1?this.computePointCurve(y[0],re):this.computeOffsetCurve(y,I,re);var ye=re.getCoordinates();return I&&Gi.reverse(ye),ye}},{key:"computeSingleSidedBufferCurve",value:function(y,_,I){var U=this.simplifyTolerance(this._distance);if(_){I.addSegments(y,!0);var re=Fo.simplify(y,-U),ye=re.length-1;I.initSideSegments(re[ye],re[ye-1],vt.LEFT),I.addFirstSegment();for(var Re=ye-2;Re>=0;Re--)I.addNextSegment(re[Re],!0)}else{I.addSegments(y,!1);var Ke=Fo.simplify(y,U),yt=Ke.length-1;I.initSideSegments(Ke[0],Ke[1],vt.LEFT),I.addFirstSegment();for(var Zt=2;Zt<=yt;Zt++)I.addNextSegment(Ke[Zt],!0)}I.addLastSegment(),I.closeRing()}},{key:"computeRingBufferCurve",value:function(y,_,I){var U=this.simplifyTolerance(this._distance);_===vt.RIGHT&&(U=-U);var re=Fo.simplify(y,U),ye=re.length-1;I.initSideSegments(re[ye-1],re[0],_);for(var Re=1;Re<=ye;Re++){var Ke=Re!==1;I.addNextSegment(re[Re],Ke)}I.closeRing()}},{key:"computeLineBufferCurve",value:function(y,_){var I=this.simplifyTolerance(this._distance),U=Fo.simplify(y,I),re=U.length-1;_.initSideSegments(U[0],U[1],vt.LEFT);for(var ye=2;ye<=re;ye++)_.addNextSegment(U[ye],!0);_.addLastSegment(),_.addLineEndCap(U[re-1],U[re]);var Re=Fo.simplify(y,-I),Ke=Re.length-1;_.initSideSegments(Re[Ke],Re[Ke-1],vt.LEFT);for(var yt=Ke-2;yt>=0;yt--)_.addNextSegment(Re[yt],!0);_.addLastSegment(),_.addLineEndCap(Re[1],Re[0]),_.closeRing()}},{key:"computePointCurve",value:function(y,_){switch(this._bufParams.getEndCapStyle()){case O.CAP_ROUND:_.createCircle(y);break;case O.CAP_SQUARE:_.createSquare(y)}}},{key:"getLineCurve",value:function(y,_){if(this._distance=_,this.isLineOffsetEmpty(_))return null;var I=Math.abs(_),U=this.getSegGen(I);if(y.length<=1)this.computePointCurve(y[0],U);else if(this._bufParams.isSingleSided()){var re=_<0;this.computeSingleSidedBufferCurve(y,re,U)}else this.computeLineBufferCurve(y,U);return U.getCoordinates()}},{key:"getBufferParameters",value:function(){return this._bufParams}},{key:"simplifyTolerance",value:function(y){return y*this._bufParams.getSimplifyFactor()}},{key:"getRingCurve",value:function(y,_,I){if(this._distance=I,y.length<=2)return this.getLineCurve(y,I);if(I===0)return A.copyCoordinates(y);var U=this.getSegGen(I);return this.computeRingBufferCurve(y,_,U),U.getCoordinates()}},{key:"computeOffsetCurve",value:function(y,_,I){var U=this.simplifyTolerance(this._distance);if(_){var re=Fo.simplify(y,-U),ye=re.length-1;I.initSideSegments(re[ye],re[ye-1],vt.LEFT),I.addFirstSegment();for(var Re=ye-2;Re>=0;Re--)I.addNextSegment(re[Re],!0)}else{var Ke=Fo.simplify(y,U),yt=Ke.length-1;I.initSideSegments(Ke[0],Ke[1],vt.LEFT),I.addFirstSegment();for(var Zt=2;Zt<=yt;Zt++)I.addNextSegment(Ke[Zt],!0)}I.addLastSegment()}},{key:"isLineOffsetEmpty",value:function(y){return y===0||y<0&&!this._bufParams.isSingleSided()}},{key:"getSegGen",value:function(y){return new xl(this._precisionModel,this._bufParams,y)}}],[{key:"constructor_",value:function(){this._distance=0,this._precisionModel=null,this._bufParams=null;var y=arguments[0],_=arguments[1];this._precisionModel=y,this._bufParams=_}},{key:"copyCoordinates",value:function(y){for(var _=new Array(y.length).fill(null),I=0;I<_.length;I++)_[I]=new De(y[I]);return _}}])})(),co=(function(){return o((function A(){i(this,A),A.constructor_.apply(this,arguments)}),[{key:"findStabbedSegments",value:function(){if(arguments.length===1){for(var A=arguments[0],y=new et,_=this._subgraphs.iterator();_.hasNext();){var I=_.next(),U=I.getEnvelope();A.y<U.getMinY()||A.y>U.getMaxY()||this.findStabbedSegments(A,I.getDirectedEdges(),y)}return y}if(arguments.length===3){if(wr(arguments[2],cr)&&arguments[0]instanceof De&&arguments[1]instanceof To){for(var re=arguments[0],ye=arguments[1],Re=arguments[2],Ke=ye.getEdge().getCoordinates(),yt=0;yt<Ke.length-1;yt++)if(this._seg.p0=Ke[yt],this._seg.p1=Ke[yt+1],this._seg.p0.y>this._seg.p1.y&&this._seg.reverse(),!(Math.max(this._seg.p0.x,this._seg.p1.x)<re.x||this._seg.isHorizontal()||re.y<this._seg.p0.y||re.y>this._seg.p1.y||be.index(this._seg.p0,this._seg.p1,re)===be.RIGHT)){var Zt=ye.getDepth(vt.LEFT);this._seg.p0.equals(Ke[yt])||(Zt=ye.getDepth(vt.RIGHT));var ur=new eo(this._seg,Zt);Re.add(ur)}}else if(wr(arguments[2],cr)&&arguments[0]instanceof De&&wr(arguments[1],cr))for(var Vr=arguments[0],gn=arguments[2],Rn=arguments[1].iterator();Rn.hasNext();){var Vn=Rn.next();Vn.isForward()&&this.findStabbedSegments(Vr,Vn,gn)}}}},{key:"getDepth",value:function(A){var y=this.findStabbedSegments(A);return y.size()===0?0:uo.min(y)._leftDepth}}],[{key:"constructor_",value:function(){this._subgraphs=null,this._seg=new Bi;var A=arguments[0];this._subgraphs=A}}])})(),eo=(function(){return o((function A(){i(this,A),A.constructor_.apply(this,arguments)}),[{key:"compareTo",value:function(A){var y=A;if(this._upwardSeg.minX()>=y._upwardSeg.maxX())return 1;if(this._upwardSeg.maxX()<=y._upwardSeg.minX())return-1;var _=this._upwardSeg.orientationIndex(y._upwardSeg);return _!==0||(_=-1*y._upwardSeg.orientationIndex(this._upwardSeg))!==0?_:this._upwardSeg.compareTo(y._upwardSeg)}},{key:"compareX",value:function(A,y){var _=A.p0.compareTo(y.p0);return _!==0?_:A.p1.compareTo(y.p1)}},{key:"toString",value:function(){return this._upwardSeg.toString()}},{key:"interfaces_",get:function(){return[q]}}],[{key:"constructor_",value:function(){this._upwardSeg=null,this._leftDepth=null;var A=arguments[0],y=arguments[1];this._upwardSeg=new Bi(A),this._leftDepth=y}}])})();co.DepthSegment=eo;var xo=(function(A){function y(){var _;return i(this,y),_=n(this,y),y.constructor_.apply(_,arguments),_}return g(y,A),o(y,null,[{key:"constructor_",value:function(){M.constructor_.call(this,"Projective point not representable on the Cartesian plane.")}}])})(M),Ba=(function(){function A(){i(this,A),A.constructor_.apply(this,arguments)}return o(A,[{key:"getY",value:function(){var y=this.y/this.w;if(Te.isNaN(y)||Te.isInfinite(y))throw new xo;return y}},{key:"getX",value:function(){var y=this.x/this.w;if(Te.isNaN(y)||Te.isInfinite(y))throw new xo;return y}},{key:"getCoordinate",value:function(){var y=new De;return y.x=this.getX(),y.y=this.getY(),y}}],[{key:"constructor_",value:function(){if(this.x=null,this.y=null,this.w=null,arguments.length===0)this.x=0,this.y=0,this.w=1;else if(arguments.length===1){var y=arguments[0];this.x=y.x,this.y=y.y,this.w=1}else if(arguments.length===2){if(typeof arguments[0]=="number"&&typeof arguments[1]=="number"){var _=arguments[0],I=arguments[1];this.x=_,this.y=I,this.w=1}else if(arguments[0]instanceof A&&arguments[1]instanceof A){var U=arguments[0],re=arguments[1];this.x=U.y*re.w-re.y*U.w,this.y=re.x*U.w-U.x*re.w,this.w=U.x*re.y-re.x*U.y}else if(arguments[0]instanceof De&&arguments[1]instanceof De){var ye=arguments[0],Re=arguments[1];this.x=ye.y-Re.y,this.y=Re.x-ye.x,this.w=ye.x*Re.y-Re.x*ye.y}}else if(arguments.length===3){var Ke=arguments[0],yt=arguments[1],Zt=arguments[2];this.x=Ke,this.y=yt,this.w=Zt}else if(arguments.length===4){var ur=arguments[0],Vr=arguments[1],gn=arguments[2],Rn=arguments[3],Vn=ur.y-Vr.y,In=Vr.x-ur.x,Dn=ur.x*Vr.y-Vr.x*ur.y,Qi=gn.y-Rn.y,ia=Rn.x-gn.x,Ta=gn.x*Rn.y-Rn.x*gn.y;this.x=In*Ta-ia*Dn,this.y=Qi*Dn-Vn*Ta,this.w=Vn*ia-Qi*In}}}])})(),Yo=(function(){function A(){i(this,A),A.constructor_.apply(this,arguments)}return o(A,[{key:"area",value:function(){return A.area(this.p0,this.p1,this.p2)}},{key:"signedArea",value:function(){return A.signedArea(this.p0,this.p1,this.p2)}},{key:"interpolateZ",value:function(y){if(y===null)throw new z("Supplied point is null.");return A.interpolateZ(y,this.p0,this.p1,this.p2)}},{key:"longestSideLength",value:function(){return A.longestSideLength(this.p0,this.p1,this.p2)}},{key:"isAcute",value:function(){return A.isAcute(this.p0,this.p1,this.p2)}},{key:"circumcentre",value:function(){return A.circumcentre(this.p0,this.p1,this.p2)}},{key:"area3D",value:function(){return A.area3D(this.p0,this.p1,this.p2)}},{key:"centroid",value:function(){return A.centroid(this.p0,this.p1,this.p2)}},{key:"inCentre",value:function(){return A.inCentre(this.p0,this.p1,this.p2)}}],[{key:"constructor_",value:function(){this.p0=null,this.p1=null,this.p2=null;var y=arguments[0],_=arguments[1],I=arguments[2];this.p0=y,this.p1=_,this.p2=I}},{key:"area",value:function(y,_,I){return Math.abs(((I.x-y.x)*(_.y-y.y)-(_.x-y.x)*(I.y-y.y))/2)}},{key:"signedArea",value:function(y,_,I){return((I.x-y.x)*(_.y-y.y)-(_.x-y.x)*(I.y-y.y))/2}},{key:"det",value:function(y,_,I,U){return y*U-_*I}},{key:"interpolateZ",value:function(y,_,I,U){var re=_.x,ye=_.y,Re=I.x-re,Ke=U.x-re,yt=I.y-ye,Zt=U.y-ye,ur=Re*Zt-Ke*yt,Vr=y.x-re,gn=y.y-ye,Rn=(Zt*Vr-Ke*gn)/ur,Vn=(-yt*Vr+Re*gn)/ur;return _.getZ()+Rn*(I.getZ()-_.getZ())+Vn*(U.getZ()-_.getZ())}},{key:"longestSideLength",value:function(y,_,I){var U=y.distance(_),re=_.distance(I),ye=I.distance(y),Re=U;return re>Re&&(Re=re),ye>Re&&(Re=ye),Re}},{key:"circumcentreDD",value:function(y,_,I){var U=ir.valueOf(y.x).subtract(I.x),re=ir.valueOf(y.y).subtract(I.y),ye=ir.valueOf(_.x).subtract(I.x),Re=ir.valueOf(_.y).subtract(I.y),Ke=ir.determinant(U,re,ye,Re).multiply(2),yt=U.sqr().add(re.sqr()),Zt=ye.sqr().add(Re.sqr()),ur=ir.determinant(re,yt,Re,Zt),Vr=ir.determinant(U,yt,ye,Zt),gn=ir.valueOf(I.x).subtract(ur.divide(Ke)).doubleValue(),Rn=ir.valueOf(I.y).add(Vr.divide(Ke)).doubleValue();return new De(gn,Rn)}},{key:"isAcute",value:function(y,_,I){return!!aa.isAcute(y,_,I)&&!!aa.isAcute(_,I,y)&&!!aa.isAcute(I,y,_)}},{key:"circumcentre",value:function(y,_,I){var U=I.x,re=I.y,ye=y.x-U,Re=y.y-re,Ke=_.x-U,yt=_.y-re,Zt=2*A.det(ye,Re,Ke,yt),ur=A.det(Re,ye*ye+Re*Re,yt,Ke*Ke+yt*yt),Vr=A.det(ye,ye*ye+Re*Re,Ke,Ke*Ke+yt*yt);return new De(U-ur/Zt,re+Vr/Zt)}},{key:"perpendicularBisector",value:function(y,_){var I=_.x-y.x,U=_.y-y.y,re=new Ba(y.x+I/2,y.y+U/2,1),ye=new Ba(y.x-U+I/2,y.y+I+U/2,1);return new Ba(re,ye)}},{key:"angleBisector",value:function(y,_,I){var U=_.distance(y),re=U/(U+_.distance(I)),ye=I.x-y.x,Re=I.y-y.y;return new De(y.x+re*ye,y.y+re*Re)}},{key:"area3D",value:function(y,_,I){var U=_.x-y.x,re=_.y-y.y,ye=_.getZ()-y.getZ(),Re=I.x-y.x,Ke=I.y-y.y,yt=I.getZ()-y.getZ(),Zt=re*yt-ye*Ke,ur=ye*Re-U*yt,Vr=U*Ke-re*Re,gn=Zt*Zt+ur*ur+Vr*Vr,Rn=Math.sqrt(gn)/2;return Rn}},{key:"centroid",value:function(y,_,I){var U=(y.x+_.x+I.x)/3,re=(y.y+_.y+I.y)/3;return new De(U,re)}},{key:"inCentre",value:function(y,_,I){var U=_.distance(I),re=y.distance(I),ye=y.distance(_),Re=U+re+ye,Ke=(U*y.x+re*_.x+ye*I.x)/Re,yt=(U*y.y+re*_.y+ye*I.y)/Re;return new De(Ke,yt)}}])})(),Eu=(function(){return o((function A(){i(this,A),A.constructor_.apply(this,arguments)}),[{key:"addRingSide",value:function(A,y,_,I,U){if(y===0&&A.length<Mi.MINIMUM_VALID_SIZE)return null;var re=I,ye=U;A.length>=Mi.MINIMUM_VALID_SIZE&&be.isCCW(A)&&(re=U,ye=I,_=vt.opposite(_));var Re=this._curveBuilder.getRingCurve(A,_,y);this.addCurve(Re,re,ye)}},{key:"addRingBothSides",value:function(A,y){this.addRingSide(A,y,vt.LEFT,Ie.EXTERIOR,Ie.INTERIOR),this.addRingSide(A,y,vt.RIGHT,Ie.INTERIOR,Ie.EXTERIOR)}},{key:"addPoint",value:function(A){if(this._distance<=0)return null;var y=A.getCoordinates(),_=this._curveBuilder.getLineCurve(y,this._distance);this.addCurve(_,Ie.EXTERIOR,Ie.INTERIOR)}},{key:"addPolygon",value:function(A){var y=this._distance,_=vt.LEFT;this._distance<0&&(y=-this._distance,_=vt.RIGHT);var I=A.getExteriorRing(),U=Gi.removeRepeatedPoints(I.getCoordinates());if(this._distance<0&&this.isErodedCompletely(I,this._distance)||this._distance<=0&&U.length<3)return null;this.addRingSide(U,y,_,Ie.EXTERIOR,Ie.INTERIOR);for(var re=0;re<A.getNumInteriorRing();re++){var ye=A.getInteriorRingN(re),Re=Gi.removeRepeatedPoints(ye.getCoordinates());this._distance>0&&this.isErodedCompletely(ye,-this._distance)||this.addRingSide(Re,y,vt.opposite(_),Ie.INTERIOR,Ie.EXTERIOR)}}},{key:"isTriangleErodedCompletely",value:function(A,y){var _=new Yo(A[0],A[1],A[2]),I=_.inCentre();return Rr.pointToSegment(I,_.p0,_.p1)<Math.abs(y)}},{key:"addLineString",value:function(A){if(this._curveBuilder.isLineOffsetEmpty(this._distance))return null;var y=Gi.removeRepeatedPoints(A.getCoordinates());if(Gi.isRing(y)&&!this._curveBuilder.getBufferParameters().isSingleSided())this.addRingBothSides(y,this._distance);else{var _=this._curveBuilder.getLineCurve(y,this._distance);this.addCurve(_,Ie.EXTERIOR,Ie.INTERIOR)}}},{key:"addCurve",value:function(A,y,_){if(A===null||A.length<2)return null;var I=new $i(A,new En(0,Ie.BOUNDARY,y,_));this._curveList.add(I)}},{key:"getCurves",value:function(){return this.add(this._inputGeom),this._curveList}},{key:"add",value:function(A){if(A.isEmpty())return null;if(A instanceof Fr)this.addPolygon(A);else if(A instanceof ri)this.addLineString(A);else if(A instanceof Be)this.addPoint(A);else if(A instanceof Tn)this.addCollection(A);else if(A instanceof Wo)this.addCollection(A);else if(A instanceof Hn)this.addCollection(A);else{if(!(A instanceof bn))throw new je(A.getGeometryType());this.addCollection(A)}}},{key:"isErodedCompletely",value:function(A,y){var _=A.getCoordinates();if(_.length<4)return y<0;if(_.length===4)return this.isTriangleErodedCompletely(_,y);var I=A.getEnvelopeInternal(),U=Math.min(I.getHeight(),I.getWidth());return y<0&&2*Math.abs(y)>U}},{key:"addCollection",value:function(A){for(var y=0;y<A.getNumGeometries();y++){var _=A.getGeometryN(y);this.add(_)}}}],[{key:"constructor_",value:function(){this._inputGeom=null,this._distance=null,this._curveBuilder=null,this._curveList=new et;var A=arguments[0],y=arguments[1],_=arguments[2];this._inputGeom=A,this._distance=y,this._curveBuilder=_}}])})(),Ea=(function(){return o((function A(){i(this,A)}),[{key:"locate",value:function(A){}}])})(),lh=(function(){function A(){i(this,A),A.constructor_.apply(this,arguments)}return o(A,[{key:"next",value:function(){if(this._atStart)return this._atStart=!1,A.isAtomic(this._parent)&&this._index++,this._parent;if(this._subcollectionIterator!==null){if(this._subcollectionIterator.hasNext())return this._subcollectionIterator.next();this._subcollectionIterator=null}if(this._index>=this._max)throw new at;var y=this._parent.getGeometryN(this._index++);return y instanceof bn?(this._subcollectionIterator=new A(y),this._subcollectionIterator.next()):y}},{key:"remove",value:function(){throw new je(this.getClass().getName())}},{key:"hasNext",value:function(){if(this._atStart)return!0;if(this._subcollectionIterator!==null){if(this._subcollectionIterator.hasNext())return!0;this._subcollectionIterator=null}return!(this._index>=this._max)}},{key:"interfaces_",get:function(){return[kn]}}],[{key:"constructor_",value:function(){this._parent=null,this._atStart=null,this._max=null,this._index=null,this._subcollectionIterator=null;var y=arguments[0];this._parent=y,this._atStart=!0,this._index=0,this._max=y.getNumGeometries()}},{key:"isAtomic",value:function(y){return!(y instanceof bn)}}])})(),cs=(function(){function A(){i(this,A),A.constructor_.apply(this,arguments)}return o(A,[{key:"locate",value:function(y){return A.locate(y,this._geom)}},{key:"interfaces_",get:function(){return[Ea]}}],[{key:"constructor_",value:function(){this._geom=null;var y=arguments[0];this._geom=y}},{key:"locatePointInPolygon",value:function(y,_){if(_.isEmpty())return Ie.EXTERIOR;var I=_.getExteriorRing(),U=A.locatePointInRing(y,I);if(U!==Ie.INTERIOR)return U;for(var re=0;re<_.getNumInteriorRing();re++){var ye=_.getInteriorRingN(re),Re=A.locatePointInRing(y,ye);if(Re===Ie.BOUNDARY)return Ie.BOUNDARY;if(Re===Ie.INTERIOR)return Ie.EXTERIOR}return Ie.INTERIOR}},{key:"locatePointInRing",value:function(y,_){return _.getEnvelopeInternal().intersects(y)?Qn.locateInRing(y,_.getCoordinates()):Ie.EXTERIOR}},{key:"containsPointInPolygon",value:function(y,_){return Ie.EXTERIOR!==A.locatePointInPolygon(y,_)}},{key:"locateInGeometry",value:function(y,_){if(_ instanceof Fr)return A.locatePointInPolygon(y,_);if(_ instanceof bn)for(var I=new lh(_);I.hasNext();){var U=I.next();if(U!==_){var re=A.locateInGeometry(y,U);if(re!==Ie.EXTERIOR)return re}}return Ie.EXTERIOR}},{key:"isContained",value:function(y,_){return Ie.EXTERIOR!==A.locate(y,_)}},{key:"locate",value:function(y,_){return _.isEmpty()?Ie.EXTERIOR:_.getEnvelopeInternal().intersects(y)?A.locateInGeometry(y,_):Ie.EXTERIOR}}])})(),au=(function(){return o((function A(){i(this,A),A.constructor_.apply(this,arguments)}),[{key:"getNextCW",value:function(A){this.getEdges();var y=this._edgeList.indexOf(A),_=y-1;return y===0&&(_=this._edgeList.size()-1),this._edgeList.get(_)}},{key:"propagateSideLabels",value:function(A){for(var y=Ie.NONE,_=this.iterator();_.hasNext();){var I=_.next().getLabel();I.isArea(A)&&I.getLocation(A,vt.LEFT)!==Ie.NONE&&(y=I.getLocation(A,vt.LEFT))}if(y===Ie.NONE)return null;for(var U=y,re=this.iterator();re.hasNext();){var ye=re.next(),Re=ye.getLabel();if(Re.getLocation(A,vt.ON)===Ie.NONE&&Re.setLocation(A,vt.ON,U),Re.isArea(A)){var Ke=Re.getLocation(A,vt.LEFT),yt=Re.getLocation(A,vt.RIGHT);if(yt!==Ie.NONE){if(yt!==U)throw new Qe("side location conflict",ye.getCoordinate());Ke===Ie.NONE&&xe.shouldNeverReachHere("found single null side (at "+ye.getCoordinate()+")"),U=Ke}else xe.isTrue(Re.getLocation(A,vt.LEFT)===Ie.NONE,"found single null side"),Re.setLocation(A,vt.RIGHT,U),Re.setLocation(A,vt.LEFT,U)}}}},{key:"getCoordinate",value:function(){var A=this.iterator();return A.hasNext()?A.next().getCoordinate():null}},{key:"print",value:function(A){Jt.out.println("EdgeEndStar:   "+this.getCoordinate());for(var y=this.iterator();y.hasNext();)y.next().print(A)}},{key:"isAreaLabelsConsistent",value:function(A){return this.computeEdgeEndLabels(A.getBoundaryNodeRule()),this.checkAreaLabelsConsistent(0)}},{key:"checkAreaLabelsConsistent",value:function(A){var y=this.getEdges();if(y.size()<=0)return!0;var _=y.size()-1,I=y.get(_).getLabel().getLocation(A,vt.LEFT);xe.isTrue(I!==Ie.NONE,"Found unlabelled area edge");for(var U=I,re=this.iterator();re.hasNext();){var ye=re.next().getLabel();xe.isTrue(ye.isArea(A),"Found non-area edge");var Re=ye.getLocation(A,vt.LEFT),Ke=ye.getLocation(A,vt.RIGHT);if(Re===Ke||Ke!==U)return!1;U=Re}return!0}},{key:"findIndex",value:function(A){this.iterator();for(var y=0;y<this._edgeList.size();y++)if(this._edgeList.get(y)===A)return y;return-1}},{key:"iterator",value:function(){return this.getEdges().iterator()}},{key:"getEdges",value:function(){return this._edgeList===null&&(this._edgeList=new et(this._edgeMap.values())),this._edgeList}},{key:"getLocation",value:function(A,y,_){return this._ptInAreaLocation[A]===Ie.NONE&&(this._ptInAreaLocation[A]=cs.locate(y,_[A].getGeometry())),this._ptInAreaLocation[A]}},{key:"toString",value:function(){var A=new er;A.append("EdgeEndStar:   "+this.getCoordinate()),A.append(`
`);for(var y=this.iterator();y.hasNext();){var _=y.next();A.append(_),A.append(`
`)}return A.toString()}},{key:"computeEdgeEndLabels",value:function(A){for(var y=this.iterator();y.hasNext();)y.next().computeLabel(A)}},{key:"computeLabelling",value:function(A){this.computeEdgeEndLabels(A[0].getBoundaryNodeRule()),this.propagateSideLabels(0),this.propagateSideLabels(1);for(var y=[!1,!1],_=this.iterator();_.hasNext();)for(var I=_.next().getLabel(),U=0;U<2;U++)I.isLine(U)&&I.getLocation(U)===Ie.BOUNDARY&&(y[U]=!0);for(var re=this.iterator();re.hasNext();)for(var ye=re.next(),Re=ye.getLabel(),Ke=0;Ke<2;Ke++)if(Re.isAnyNull(Ke)){var yt=Ie.NONE;if(y[Ke])yt=Ie.EXTERIOR;else{var Zt=ye.getCoordinate();yt=this.getLocation(Ke,Zt,A)}Re.setAllLocationsIfNull(Ke,yt)}}},{key:"getDegree",value:function(){return this._edgeMap.size()}},{key:"insertEdgeEnd",value:function(A,y){this._edgeMap.put(A,y),this._edgeList=null}}],[{key:"constructor_",value:function(){this._edgeMap=new Nn,this._edgeList=null,this._ptInAreaLocation=[Ie.NONE,Ie.NONE]}}])})(),Wa=(function(A){function y(){var _;return i(this,y),_=n(this,y),y.constructor_.apply(_,arguments),_}return g(y,A),o(y,[{key:"linkResultDirectedEdges",value:function(){this.getResultAreaEdges();for(var _=null,I=null,U=this._SCANNING_FOR_INCOMING,re=0;re<this._resultAreaEdgeList.size();re++){var ye=this._resultAreaEdgeList.get(re),Re=ye.getSym();if(ye.getLabel().isArea())switch(_===null&&ye.isInResult()&&(_=ye),U){case this._SCANNING_FOR_INCOMING:if(!Re.isInResult())continue;I=Re,U=this._LINKING_TO_OUTGOING;break;case this._LINKING_TO_OUTGOING:if(!ye.isInResult())continue;I.setNext(ye),U=this._SCANNING_FOR_INCOMING}}if(U===this._LINKING_TO_OUTGOING){if(_===null)throw new Qe("no outgoing dirEdge found",this.getCoordinate());xe.isTrue(_.isInResult(),"unable to link last incoming dirEdge"),I.setNext(_)}}},{key:"insert",value:function(_){var I=_;this.insertEdgeEnd(I,I)}},{key:"getRightmostEdge",value:function(){var _=this.getEdges(),I=_.size();if(I<1)return null;var U=_.get(0);if(I===1)return U;var re=_.get(I-1),ye=U.getQuadrant(),Re=re.getQuadrant();return Yn.isNorthern(ye)&&Yn.isNorthern(Re)?U:Yn.isNorthern(ye)||Yn.isNorthern(Re)?U.getDy()!==0?U:re.getDy()!==0?re:(xe.shouldNeverReachHere("found two horizontal edges incident on node"),null):re}},{key:"print",value:function(_){Jt.out.println("DirectedEdgeStar: "+this.getCoordinate());for(var I=this.iterator();I.hasNext();){var U=I.next();_.print("out "),U.print(_),_.println(),_.print("in "),U.getSym().print(_),_.println()}}},{key:"getResultAreaEdges",value:function(){if(this._resultAreaEdgeList!==null)return this._resultAreaEdgeList;this._resultAreaEdgeList=new et;for(var _=this.iterator();_.hasNext();){var I=_.next();(I.isInResult()||I.getSym().isInResult())&&this._resultAreaEdgeList.add(I)}return this._resultAreaEdgeList}},{key:"updateLabelling",value:function(_){for(var I=this.iterator();I.hasNext();){var U=I.next().getLabel();U.setAllLocationsIfNull(0,_.getLocation(0)),U.setAllLocationsIfNull(1,_.getLocation(1))}}},{key:"linkAllDirectedEdges",value:function(){this.getEdges();for(var _=null,I=null,U=this._edgeList.size()-1;U>=0;U--){var re=this._edgeList.get(U),ye=re.getSym();I===null&&(I=ye),_!==null&&ye.setNext(_),_=re}I.setNext(_)}},{key:"computeDepths",value:function(){if(arguments.length===1){var _=arguments[0],I=this.findIndex(_),U=_.getDepth(vt.LEFT),re=_.getDepth(vt.RIGHT),ye=this.computeDepths(I+1,this._edgeList.size(),U);if(this.computeDepths(0,I,ye)!==re)throw new Qe("depth mismatch at "+_.getCoordinate())}else if(arguments.length===3){for(var Re=arguments[1],Ke=arguments[2],yt=arguments[0];yt<Re;yt++){var Zt=this._edgeList.get(yt);Zt.setEdgeDepths(vt.RIGHT,Ke),Ke=Zt.getDepth(vt.LEFT)}return Ke}}},{key:"mergeSymLabels",value:function(){for(var _=this.iterator();_.hasNext();){var I=_.next();I.getLabel().merge(I.getSym().getLabel())}}},{key:"linkMinimalDirectedEdges",value:function(_){for(var I=null,U=null,re=this._SCANNING_FOR_INCOMING,ye=this._resultAreaEdgeList.size()-1;ye>=0;ye--){var Re=this._resultAreaEdgeList.get(ye),Ke=Re.getSym();switch(I===null&&Re.getEdgeRing()===_&&(I=Re),re){case this._SCANNING_FOR_INCOMING:if(Ke.getEdgeRing()!==_)continue;U=Ke,re=this._LINKING_TO_OUTGOING;break;case this._LINKING_TO_OUTGOING:if(Re.getEdgeRing()!==_)continue;U.setNextMin(Re),re=this._SCANNING_FOR_INCOMING}}re===this._LINKING_TO_OUTGOING&&(xe.isTrue(I!==null,"found null for first outgoing dirEdge"),xe.isTrue(I.getEdgeRing()===_,"unable to link last incoming dirEdge"),U.setNextMin(I))}},{key:"getOutgoingDegree",value:function(){if(arguments.length===0){for(var _=0,I=this.iterator();I.hasNext();)I.next().isInResult()&&_++;return _}if(arguments.length===1){for(var U=arguments[0],re=0,ye=this.iterator();ye.hasNext();)ye.next().getEdgeRing()===U&&re++;return re}}},{key:"getLabel",value:function(){return this._label}},{key:"findCoveredLineEdges",value:function(){for(var _=Ie.NONE,I=this.iterator();I.hasNext();){var U=I.next(),re=U.getSym();if(!U.isLineEdge()){if(U.isInResult()){_=Ie.INTERIOR;break}if(re.isInResult()){_=Ie.EXTERIOR;break}}}if(_===Ie.NONE)return null;for(var ye=_,Re=this.iterator();Re.hasNext();){var Ke=Re.next(),yt=Ke.getSym();Ke.isLineEdge()?Ke.getEdge().setCovered(ye===Ie.INTERIOR):(Ke.isInResult()&&(ye=Ie.EXTERIOR),yt.isInResult()&&(ye=Ie.INTERIOR))}}},{key:"computeLabelling",value:function(_){S(y,"computeLabelling",this,1).call(this,_),this._label=new En(Ie.NONE);for(var I=this.iterator();I.hasNext();)for(var U=I.next().getEdge().getLabel(),re=0;re<2;re++){var ye=U.getLocation(re);ye!==Ie.INTERIOR&&ye!==Ie.BOUNDARY||this._label.setLocation(re,Ie.INTERIOR)}}}],[{key:"constructor_",value:function(){this._resultAreaEdgeList=null,this._label=null,this._SCANNING_FOR_INCOMING=1,this._LINKING_TO_OUTGOING=2}}])})(au),Fs=(function(A){function y(){return i(this,y),n(this,y)}return g(y,A),o(y,[{key:"createNode",value:function(_){return new Ma(_,new Wa)}}])})(Xo),Hu=(function(){function A(){i(this,A),A.constructor_.apply(this,arguments)}return o(A,[{key:"compareTo",value:function(y){var _=y;return A.compareOriented(this._pts,this._orientation,_._pts,_._orientation)}},{key:"interfaces_",get:function(){return[q]}}],[{key:"constructor_",value:function(){this._pts=null,this._orientation=null;var y=arguments[0];this._pts=y,this._orientation=A.orientation(y)}},{key:"orientation",value:function(y){return Gi.increasingDirection(y)===1}},{key:"compareOriented",value:function(y,_,I,U){for(var re=_?1:-1,ye=U?1:-1,Re=_?y.length:-1,Ke=U?I.length:-1,yt=_?0:y.length-1,Zt=U?0:I.length-1;;){var ur=y[yt].compareTo(I[Zt]);if(ur!==0)return ur;var Vr=(yt+=re)===Re,gn=(Zt+=ye)===Ke;if(Vr&&!gn)return-1;if(!Vr&&gn)return 1;if(Vr&&gn)return 0}}}])})(),Wu=(function(){return o((function A(){i(this,A),A.constructor_.apply(this,arguments)}),[{key:"print",value:function(A){A.print("MULTILINESTRING ( ");for(var y=0;y<this._edges.size();y++){var _=this._edges.get(y);y>0&&A.print(","),A.print("(");for(var I=_.getCoordinates(),U=0;U<I.length;U++)U>0&&A.print(","),A.print(I[U].x+" "+I[U].y);A.println(")")}A.print(")  ")}},{key:"addAll",value:function(A){for(var y=A.iterator();y.hasNext();)this.add(y.next())}},{key:"findEdgeIndex",value:function(A){for(var y=0;y<this._edges.size();y++)if(this._edges.get(y).equals(A))return y;return-1}},{key:"iterator",value:function(){return this._edges.iterator()}},{key:"getEdges",value:function(){return this._edges}},{key:"get",value:function(A){return this._edges.get(A)}},{key:"findEqualEdge",value:function(A){var y=new Hu(A.getCoordinates());return this._ocaMap.get(y)}},{key:"add",value:function(A){this._edges.add(A);var y=new Hu(A.getCoordinates());this._ocaMap.put(y,A)}}],[{key:"constructor_",value:function(){this._edges=new et,this._ocaMap=new Nn}}])})(),wl=(function(){return o((function A(){i(this,A)}),[{key:"processIntersections",value:function(A,y,_,I){}},{key:"isDone",value:function(){}}])})(),Fl=(function(){function A(){i(this,A),A.constructor_.apply(this,arguments)}return o(A,[{key:"isTrivialIntersection",value:function(y,_,I,U){if(y===I&&this._li.getIntersectionNum()===1){if(A.isAdjacentSegments(_,U))return!0;if(y.isClosed()){var re=y.size()-1;if(_===0&&U===re||U===0&&_===re)return!0}}return!1}},{key:"getProperIntersectionPoint",value:function(){return this._properIntersectionPoint}},{key:"hasProperInteriorIntersection",value:function(){return this._hasProperInterior}},{key:"getLineIntersector",value:function(){return this._li}},{key:"hasProperIntersection",value:function(){return this._hasProper}},{key:"processIntersections",value:function(y,_,I,U){if(y===I&&_===U)return null;this.numTests++;var re=y.getCoordinates()[_],ye=y.getCoordinates()[_+1],Re=I.getCoordinates()[U],Ke=I.getCoordinates()[U+1];this._li.computeIntersection(re,ye,Re,Ke),this._li.hasIntersection()&&(this.numIntersections++,this._li.isInteriorIntersection()&&(this.numInteriorIntersections++,this._hasInterior=!0),this.isTrivialIntersection(y,_,I,U)||(this._hasIntersection=!0,y.addIntersections(this._li,_,0),I.addIntersections(this._li,U,1),this._li.isProper()&&(this.numProperIntersections++,this._hasProper=!0,this._hasProperInterior=!0)))}},{key:"hasIntersection",value:function(){return this._hasIntersection}},{key:"isDone",value:function(){return!1}},{key:"hasInteriorIntersection",value:function(){return this._hasInterior}},{key:"interfaces_",get:function(){return[wl]}}],[{key:"constructor_",value:function(){this._hasIntersection=!1,this._hasProper=!1,this._hasProperInterior=!1,this._hasInterior=!1,this._properIntersectionPoint=null,this._li=null,this._isSelfIntersection=null,this.numIntersections=0,this.numInteriorIntersections=0,this.numProperIntersections=0,this.numTests=0;var y=arguments[0];this._li=y}},{key:"isAdjacentSegments",value:function(y,_){return Math.abs(y-_)===1}}])})(),Ao=(function(){return o((function A(){i(this,A),A.constructor_.apply(this,arguments)}),[{key:"getSegmentIndex",value:function(){return this.segmentIndex}},{key:"getCoordinate",value:function(){return this.coord}},{key:"print",value:function(A){A.print(this.coord),A.print(" seg # = "+this.segmentIndex),A.println(" dist = "+this.dist)}},{key:"compareTo",value:function(A){var y=A;return this.compare(y.segmentIndex,y.dist)}},{key:"isEndPoint",value:function(A){return this.segmentIndex===0&&this.dist===0||this.segmentIndex===A}},{key:"toString",value:function(){return this.coord+" seg # = "+this.segmentIndex+" dist = "+this.dist}},{key:"getDistance",value:function(){return this.dist}},{key:"compare",value:function(A,y){return this.segmentIndex<A?-1:this.segmentIndex>A?1:this.dist<y?-1:this.dist>y?1:0}},{key:"interfaces_",get:function(){return[q]}}],[{key:"constructor_",value:function(){this.coord=null,this.segmentIndex=null,this.dist=null;var A=arguments[0],y=arguments[1],_=arguments[2];this.coord=new De(A),this.segmentIndex=y,this.dist=_}}])})(),ho=(function(){return o((function A(){i(this,A),A.constructor_.apply(this,arguments)}),[{key:"print",value:function(A){A.println("Intersections:");for(var y=this.iterator();y.hasNext();)y.next().print(A)}},{key:"iterator",value:function(){return this._nodeMap.values().iterator()}},{key:"addSplitEdges",value:function(A){this.addEndpoints();for(var y=this.iterator(),_=y.next();y.hasNext();){var I=y.next(),U=this.createSplitEdge(_,I);A.add(U),_=I}}},{key:"addEndpoints",value:function(){var A=this.edge.pts.length-1;this.add(this.edge.pts[0],0,0),this.add(this.edge.pts[A],A,0)}},{key:"createSplitEdge",value:function(A,y){var _=y.segmentIndex-A.segmentIndex+2,I=this.edge.pts[y.segmentIndex],U=y.dist>0||!y.coord.equals2D(I);U||_--;var re=new Array(_).fill(null),ye=0;re[ye++]=new De(A.coord);for(var Re=A.segmentIndex+1;Re<=y.segmentIndex;Re++)re[ye++]=this.edge.pts[Re];return U&&(re[ye]=y.coord),new ya(re,new En(this.edge._label))}},{key:"add",value:function(A,y,_){var I=new Ao(A,y,_),U=this._nodeMap.get(I);return U!==null?U:(this._nodeMap.put(I,I),I)}},{key:"isIntersection",value:function(A){for(var y=this.iterator();y.hasNext();)if(y.next().coord.equals(A))return!0;return!1}}],[{key:"constructor_",value:function(){this._nodeMap=new Nn,this.edge=null;var A=arguments[0];this.edge=A}}])})(),Bs=(function(){function A(){i(this,A),A.constructor_.apply(this,arguments)}return o(A,[{key:"isIntersects",value:function(){return!this.isDisjoint()}},{key:"isCovers",value:function(){return(A.isTrue(this._matrix[Ie.INTERIOR][Ie.INTERIOR])||A.isTrue(this._matrix[Ie.INTERIOR][Ie.BOUNDARY])||A.isTrue(this._matrix[Ie.BOUNDARY][Ie.INTERIOR])||A.isTrue(this._matrix[Ie.BOUNDARY][Ie.BOUNDARY]))&&this._matrix[Ie.EXTERIOR][Ie.INTERIOR]===ar.FALSE&&this._matrix[Ie.EXTERIOR][Ie.BOUNDARY]===ar.FALSE}},{key:"isCoveredBy",value:function(){return(A.isTrue(this._matrix[Ie.INTERIOR][Ie.INTERIOR])||A.isTrue(this._matrix[Ie.INTERIOR][Ie.BOUNDARY])||A.isTrue(this._matrix[Ie.BOUNDARY][Ie.INTERIOR])||A.isTrue(this._matrix[Ie.BOUNDARY][Ie.BOUNDARY]))&&this._matrix[Ie.INTERIOR][Ie.EXTERIOR]===ar.FALSE&&this._matrix[Ie.BOUNDARY][Ie.EXTERIOR]===ar.FALSE}},{key:"set",value:function(){if(arguments.length===1)for(var y=arguments[0],_=0;_<y.length;_++){var I=Math.trunc(_/3),U=_%3;this._matrix[I][U]=ar.toDimensionValue(y.charAt(_))}else if(arguments.length===3){var re=arguments[0],ye=arguments[1],Re=arguments[2];this._matrix[re][ye]=Re}}},{key:"isContains",value:function(){return A.isTrue(this._matrix[Ie.INTERIOR][Ie.INTERIOR])&&this._matrix[Ie.EXTERIOR][Ie.INTERIOR]===ar.FALSE&&this._matrix[Ie.EXTERIOR][Ie.BOUNDARY]===ar.FALSE}},{key:"setAtLeast",value:function(){if(arguments.length===1)for(var y=arguments[0],_=0;_<y.length;_++){var I=Math.trunc(_/3),U=_%3;this.setAtLeast(I,U,ar.toDimensionValue(y.charAt(_)))}else if(arguments.length===3){var re=arguments[0],ye=arguments[1],Re=arguments[2];this._matrix[re][ye]<Re&&(this._matrix[re][ye]=Re)}}},{key:"setAtLeastIfValid",value:function(y,_,I){y>=0&&_>=0&&this.setAtLeast(y,_,I)}},{key:"isWithin",value:function(){return A.isTrue(this._matrix[Ie.INTERIOR][Ie.INTERIOR])&&this._matrix[Ie.INTERIOR][Ie.EXTERIOR]===ar.FALSE&&this._matrix[Ie.BOUNDARY][Ie.EXTERIOR]===ar.FALSE}},{key:"isTouches",value:function(y,_){return y>_?this.isTouches(_,y):(y===ar.A&&_===ar.A||y===ar.L&&_===ar.L||y===ar.L&&_===ar.A||y===ar.P&&_===ar.A||y===ar.P&&_===ar.L)&&this._matrix[Ie.INTERIOR][Ie.INTERIOR]===ar.FALSE&&(A.isTrue(this._matrix[Ie.INTERIOR][Ie.BOUNDARY])||A.isTrue(this._matrix[Ie.BOUNDARY][Ie.INTERIOR])||A.isTrue(this._matrix[Ie.BOUNDARY][Ie.BOUNDARY]))}},{key:"isOverlaps",value:function(y,_){return y===ar.P&&_===ar.P||y===ar.A&&_===ar.A?A.isTrue(this._matrix[Ie.INTERIOR][Ie.INTERIOR])&&A.isTrue(this._matrix[Ie.INTERIOR][Ie.EXTERIOR])&&A.isTrue(this._matrix[Ie.EXTERIOR][Ie.INTERIOR]):y===ar.L&&_===ar.L&&this._matrix[Ie.INTERIOR][Ie.INTERIOR]===1&&A.isTrue(this._matrix[Ie.INTERIOR][Ie.EXTERIOR])&&A.isTrue(this._matrix[Ie.EXTERIOR][Ie.INTERIOR])}},{key:"isEquals",value:function(y,_){return y===_&&A.isTrue(this._matrix[Ie.INTERIOR][Ie.INTERIOR])&&this._matrix[Ie.INTERIOR][Ie.EXTERIOR]===ar.FALSE&&this._matrix[Ie.BOUNDARY][Ie.EXTERIOR]===ar.FALSE&&this._matrix[Ie.EXTERIOR][Ie.INTERIOR]===ar.FALSE&&this._matrix[Ie.EXTERIOR][Ie.BOUNDARY]===ar.FALSE}},{key:"toString",value:function(){for(var y=new Ui("123456789"),_=0;_<3;_++)for(var I=0;I<3;I++)y.setCharAt(3*_+I,ar.toDimensionSymbol(this._matrix[_][I]));return y.toString()}},{key:"setAll",value:function(y){for(var _=0;_<3;_++)for(var I=0;I<3;I++)this._matrix[_][I]=y}},{key:"get",value:function(y,_){return this._matrix[y][_]}},{key:"transpose",value:function(){var y=this._matrix[1][0];return this._matrix[1][0]=this._matrix[0][1],this._matrix[0][1]=y,y=this._matrix[2][0],this._matrix[2][0]=this._matrix[0][2],this._matrix[0][2]=y,y=this._matrix[2][1],this._matrix[2][1]=this._matrix[1][2],this._matrix[1][2]=y,this}},{key:"matches",value:function(y){if(y.length!==9)throw new z("Should be length 9: "+y);for(var _=0;_<3;_++)for(var I=0;I<3;I++)if(!A.matches(this._matrix[_][I],y.charAt(3*_+I)))return!1;return!0}},{key:"add",value:function(y){for(var _=0;_<3;_++)for(var I=0;I<3;I++)this.setAtLeast(_,I,y.get(_,I))}},{key:"isDisjoint",value:function(){return this._matrix[Ie.INTERIOR][Ie.INTERIOR]===ar.FALSE&&this._matrix[Ie.INTERIOR][Ie.BOUNDARY]===ar.FALSE&&this._matrix[Ie.BOUNDARY][Ie.INTERIOR]===ar.FALSE&&this._matrix[Ie.BOUNDARY][Ie.BOUNDARY]===ar.FALSE}},{key:"isCrosses",value:function(y,_){return y===ar.P&&_===ar.L||y===ar.P&&_===ar.A||y===ar.L&&_===ar.A?A.isTrue(this._matrix[Ie.INTERIOR][Ie.INTERIOR])&&A.isTrue(this._matrix[Ie.INTERIOR][Ie.EXTERIOR]):y===ar.L&&_===ar.P||y===ar.A&&_===ar.P||y===ar.A&&_===ar.L?A.isTrue(this._matrix[Ie.INTERIOR][Ie.INTERIOR])&&A.isTrue(this._matrix[Ie.EXTERIOR][Ie.INTERIOR]):y===ar.L&&_===ar.L&&this._matrix[Ie.INTERIOR][Ie.INTERIOR]===0}},{key:"interfaces_",get:function(){return[W]}}],[{key:"constructor_",value:function(){if(this._matrix=null,arguments.length===0)this._matrix=Array(3).fill().map((function(){return Array(3)})),this.setAll(ar.FALSE);else if(arguments.length===1){if(typeof arguments[0]=="string"){var y=arguments[0];A.constructor_.call(this),this.set(y)}else if(arguments[0]instanceof A){var _=arguments[0];A.constructor_.call(this),this._matrix[Ie.INTERIOR][Ie.INTERIOR]=_._matrix[Ie.INTERIOR][Ie.INTERIOR],this._matrix[Ie.INTERIOR][Ie.BOUNDARY]=_._matrix[Ie.INTERIOR][Ie.BOUNDARY],this._matrix[Ie.INTERIOR][Ie.EXTERIOR]=_._matrix[Ie.INTERIOR][Ie.EXTERIOR],this._matrix[Ie.BOUNDARY][Ie.INTERIOR]=_._matrix[Ie.BOUNDARY][Ie.INTERIOR],this._matrix[Ie.BOUNDARY][Ie.BOUNDARY]=_._matrix[Ie.BOUNDARY][Ie.BOUNDARY],this._matrix[Ie.BOUNDARY][Ie.EXTERIOR]=_._matrix[Ie.BOUNDARY][Ie.EXTERIOR],this._matrix[Ie.EXTERIOR][Ie.INTERIOR]=_._matrix[Ie.EXTERIOR][Ie.INTERIOR],this._matrix[Ie.EXTERIOR][Ie.BOUNDARY]=_._matrix[Ie.EXTERIOR][Ie.BOUNDARY],this._matrix[Ie.EXTERIOR][Ie.EXTERIOR]=_._matrix[Ie.EXTERIOR][Ie.EXTERIOR]}}}},{key:"matches",value:function(){if(Number.isInteger(arguments[0])&&typeof arguments[1]=="string"){var y=arguments[0],_=arguments[1];return _===ar.SYM_DONTCARE||_===ar.SYM_TRUE&&(y>=0||y===ar.TRUE)||_===ar.SYM_FALSE&&y===ar.FALSE||_===ar.SYM_P&&y===ar.P||_===ar.SYM_L&&y===ar.L||_===ar.SYM_A&&y===ar.A}if(typeof arguments[0]=="string"&&typeof arguments[1]=="string"){var I=arguments[1];return new A(arguments[0]).matches(I)}}},{key:"isTrue",value:function(y){return y>=0||y===ar.TRUE}}])})(),wo=(function(){function A(){i(this,A),A.constructor_.apply(this,arguments)}return o(A,[{key:"size",value:function(){return this._size}},{key:"addAll",value:function(y){return y===null||y.length===0?null:(this.ensureCapacity(this._size+y.length),Jt.arraycopy(y,0,this._data,this._size,y.length),void(this._size+=y.length))}},{key:"ensureCapacity",value:function(y){if(y<=this._data.length)return null;var _=Math.max(y,2*this._data.length);this._data=pt.copyOf(this._data,_)}},{key:"toArray",value:function(){var y=new Array(this._size).fill(null);return Jt.arraycopy(this._data,0,y,0,this._size),y}},{key:"add",value:function(y){this.ensureCapacity(this._size+1),this._data[this._size]=y,++this._size}}],[{key:"constructor_",value:function(){if(this._data=null,this._size=0,arguments.length===0)A.constructor_.call(this,10);else if(arguments.length===1){var y=arguments[0];this._data=new Array(y).fill(null)}}}])})(),Bl=(function(){function A(){i(this,A)}return o(A,[{key:"getChainStartIndices",value:function(y){var _=0,I=new wo(Math.trunc(y.length/2));I.add(_);do{var U=this.findChainEnd(y,_);I.add(U),_=U}while(_<y.length-1);return I.toArray()}},{key:"findChainEnd",value:function(y,_){for(var I=Yn.quadrant(y[_],y[_+1]),U=_+1;U<y.length&&Yn.quadrant(y[U-1],y[U])===I;)U++;return U-1}},{key:"OLDgetChainStartIndices",value:function(y){var _=0,I=new et;I.add(_);do{var U=this.findChainEnd(y,_);I.add(U),_=U}while(_<y.length-1);return A.toIntArray(I)}}],[{key:"toIntArray",value:function(y){for(var _=new Array(y.size()).fill(null),I=0;I<_.length;I++)_[I]=y.get(I).intValue();return _}}])})(),hs=(function(){return o((function A(){i(this,A),A.constructor_.apply(this,arguments)}),[{key:"getCoordinates",value:function(){return this.pts}},{key:"getMaxX",value:function(A){var y=this.pts[this.startIndex[A]].x,_=this.pts[this.startIndex[A+1]].x;return y>_?y:_}},{key:"getMinX",value:function(A){var y=this.pts[this.startIndex[A]].x,_=this.pts[this.startIndex[A+1]].x;return y<_?y:_}},{key:"computeIntersectsForChain",value:function(){if(arguments.length===4){var A=arguments[0],y=arguments[1],_=arguments[2],I=arguments[3];this.computeIntersectsForChain(this.startIndex[A],this.startIndex[A+1],y,y.startIndex[_],y.startIndex[_+1],I)}else if(arguments.length===6){var U=arguments[0],re=arguments[1],ye=arguments[2],Re=arguments[3],Ke=arguments[4],yt=arguments[5];if(re-U==1&&Ke-Re==1)return yt.addIntersections(this.e,U,ye.e,Re),null;if(!this.overlaps(U,re,ye,Re,Ke))return null;var Zt=Math.trunc((U+re)/2),ur=Math.trunc((Re+Ke)/2);U<Zt&&(Re<ur&&this.computeIntersectsForChain(U,Zt,ye,Re,ur,yt),ur<Ke&&this.computeIntersectsForChain(U,Zt,ye,ur,Ke,yt)),Zt<re&&(Re<ur&&this.computeIntersectsForChain(Zt,re,ye,Re,ur,yt),ur<Ke&&this.computeIntersectsForChain(Zt,re,ye,ur,Ke,yt))}}},{key:"overlaps",value:function(A,y,_,I,U){return Ye.intersects(this.pts[A],this.pts[y],_.pts[I],_.pts[U])}},{key:"getStartIndexes",value:function(){return this.startIndex}},{key:"computeIntersects",value:function(A,y){for(var _=0;_<this.startIndex.length-1;_++)for(var I=0;I<A.startIndex.length-1;I++)this.computeIntersectsForChain(_,A,I,y)}}],[{key:"constructor_",value:function(){this.e=null,this.pts=null,this.startIndex=null;var A=arguments[0];this.e=A,this.pts=A.getCoordinates();var y=new Bl;this.startIndex=y.getChainStartIndices(this.pts)}}])})(),zl=(function(){function A(){i(this,A),A.constructor_.apply(this,arguments)}return o(A,[{key:"getDepth",value:function(y,_){return this._depth[y][_]}},{key:"setDepth",value:function(y,_,I){this._depth[y][_]=I}},{key:"isNull",value:function(){if(arguments.length===0){for(var y=0;y<2;y++)for(var _=0;_<3;_++)if(this._depth[y][_]!==A.NULL_VALUE)return!1;return!0}if(arguments.length===1){var I=arguments[0];return this._depth[I][1]===A.NULL_VALUE}if(arguments.length===2){var U=arguments[0],re=arguments[1];return this._depth[U][re]===A.NULL_VALUE}}},{key:"normalize",value:function(){for(var y=0;y<2;y++)if(!this.isNull(y)){var _=this._depth[y][1];this._depth[y][2]<_&&(_=this._depth[y][2]),_<0&&(_=0);for(var I=1;I<3;I++){var U=0;this._depth[y][I]>_&&(U=1),this._depth[y][I]=U}}}},{key:"getDelta",value:function(y){return this._depth[y][vt.RIGHT]-this._depth[y][vt.LEFT]}},{key:"getLocation",value:function(y,_){return this._depth[y][_]<=0?Ie.EXTERIOR:Ie.INTERIOR}},{key:"toString",value:function(){return"A: "+this._depth[0][1]+","+this._depth[0][2]+" B: "+this._depth[1][1]+","+this._depth[1][2]}},{key:"add",value:function(){if(arguments.length===1)for(var y=arguments[0],_=0;_<2;_++)for(var I=1;I<3;I++){var U=y.getLocation(_,I);U!==Ie.EXTERIOR&&U!==Ie.INTERIOR||(this.isNull(_,I)?this._depth[_][I]=A.depthAtLocation(U):this._depth[_][I]+=A.depthAtLocation(U))}else if(arguments.length===3){var re=arguments[0],ye=arguments[1];arguments[2]===Ie.INTERIOR&&this._depth[re][ye]++}}}],[{key:"constructor_",value:function(){this._depth=Array(2).fill().map((function(){return Array(3)}));for(var y=0;y<2;y++)for(var _=0;_<3;_++)this._depth[y][_]=A.NULL_VALUE}},{key:"depthAtLocation",value:function(y){return y===Ie.EXTERIOR?0:y===Ie.INTERIOR?1:A.NULL_VALUE}}])})();zl.NULL_VALUE=-1;var ya=(function(A){function y(){var _;return i(this,y),_=n(this,y),y.constructor_.apply(_,arguments),_}return g(y,A),o(y,[{key:"getDepth",value:function(){return this._depth}},{key:"getCollapsedEdge",value:function(){var _=new Array(2).fill(null);return _[0]=this.pts[0],_[1]=this.pts[1],new y(_,En.toLineLabel(this._label))}},{key:"isIsolated",value:function(){return this._isIsolated}},{key:"getCoordinates",value:function(){return this.pts}},{key:"setIsolated",value:function(_){this._isIsolated=_}},{key:"setName",value:function(_){this._name=_}},{key:"equals",value:function(_){if(!(_ instanceof y))return!1;var I=_;if(this.pts.length!==I.pts.length)return!1;for(var U=!0,re=!0,ye=this.pts.length,Re=0;Re<this.pts.length;Re++)if(this.pts[Re].equals2D(I.pts[Re])||(U=!1),this.pts[Re].equals2D(I.pts[--ye])||(re=!1),!U&&!re)return!1;return!0}},{key:"getCoordinate",value:function(){if(arguments.length===0)return this.pts.length>0?this.pts[0]:null;if(arguments.length===1){var _=arguments[0];return this.pts[_]}}},{key:"print",value:function(_){_.print("edge "+this._name+": "),_.print("LINESTRING (");for(var I=0;I<this.pts.length;I++)I>0&&_.print(","),_.print(this.pts[I].x+" "+this.pts[I].y);_.print(")  "+this._label+" "+this._depthDelta)}},{key:"computeIM",value:function(_){y.updateIM(this._label,_)}},{key:"isCollapsed",value:function(){return!!this._label.isArea()&&this.pts.length===3&&!!this.pts[0].equals(this.pts[2])}},{key:"isClosed",value:function(){return this.pts[0].equals(this.pts[this.pts.length-1])}},{key:"getMaximumSegmentIndex",value:function(){return this.pts.length-1}},{key:"getDepthDelta",value:function(){return this._depthDelta}},{key:"getNumPoints",value:function(){return this.pts.length}},{key:"printReverse",value:function(_){_.print("edge "+this._name+": ");for(var I=this.pts.length-1;I>=0;I--)_.print(this.pts[I]+" ");_.println("")}},{key:"getMonotoneChainEdge",value:function(){return this._mce===null&&(this._mce=new hs(this)),this._mce}},{key:"getEnvelope",value:function(){if(this._env===null){this._env=new Ye;for(var _=0;_<this.pts.length;_++)this._env.expandToInclude(this.pts[_])}return this._env}},{key:"addIntersection",value:function(_,I,U,re){var ye=new De(_.getIntersection(re)),Re=I,Ke=_.getEdgeDistance(U,re),yt=Re+1;if(yt<this.pts.length){var Zt=this.pts[yt];ye.equals2D(Zt)&&(Re=yt,Ke=0)}this.eiList.add(ye,Re,Ke)}},{key:"toString",value:function(){var _=new Ui;_.append("edge "+this._name+": "),_.append("LINESTRING (");for(var I=0;I<this.pts.length;I++)I>0&&_.append(","),_.append(this.pts[I].x+" "+this.pts[I].y);return _.append(")  "+this._label+" "+this._depthDelta),_.toString()}},{key:"isPointwiseEqual",value:function(_){if(this.pts.length!==_.pts.length)return!1;for(var I=0;I<this.pts.length;I++)if(!this.pts[I].equals2D(_.pts[I]))return!1;return!0}},{key:"setDepthDelta",value:function(_){this._depthDelta=_}},{key:"getEdgeIntersectionList",value:function(){return this.eiList}},{key:"addIntersections",value:function(_,I,U){for(var re=0;re<_.getIntersectionNum();re++)this.addIntersection(_,I,U,re)}}],[{key:"constructor_",value:function(){if(this.pts=null,this._env=null,this.eiList=new ho(this),this._name=null,this._mce=null,this._isIsolated=!0,this._depth=new zl,this._depthDelta=0,arguments.length===1){var _=arguments[0];y.constructor_.call(this,_,null)}else if(arguments.length===2){var I=arguments[0],U=arguments[1];this.pts=I,this._label=U}}},{key:"updateIM",value:function(){if(!(arguments.length===2&&arguments[1]instanceof Bs&&arguments[0]instanceof En))return S(y,"updateIM",this).apply(this,arguments);var _=arguments[0],I=arguments[1];I.setAtLeastIfValid(_.getLocation(0,vt.ON),_.getLocation(1,vt.ON),1),_.isArea()&&(I.setAtLeastIfValid(_.getLocation(0,vt.LEFT),_.getLocation(1,vt.LEFT),2),I.setAtLeastIfValid(_.getLocation(0,vt.RIGHT),_.getLocation(1,vt.RIGHT),2))}}])})(Wn),Tu=(function(){function A(){i(this,A),A.constructor_.apply(this,arguments)}return o(A,[{key:"setWorkingPrecisionModel",value:function(y){this._workingPrecisionModel=y}},{key:"insertUniqueEdge",value:function(y){var _=this._edgeList.findEqualEdge(y);if(_!==null){var I=_.getLabel(),U=y.getLabel();_.isPointwiseEqual(y)||(U=new En(y.getLabel())).flip(),I.merge(U);var re=A.depthDelta(U),ye=_.getDepthDelta()+re;_.setDepthDelta(ye)}else this._edgeList.add(y),y.setDepthDelta(A.depthDelta(y.getLabel()))}},{key:"buildSubgraphs",value:function(y,_){for(var I=new et,U=y.iterator();U.hasNext();){var re=U.next(),ye=re.getRightmostCoordinate(),Re=new co(I).getDepth(ye);re.computeDepth(Re),re.findResultEdges(),I.add(re),_.add(re.getDirectedEdges(),re.getNodes())}}},{key:"createSubgraphs",value:function(y){for(var _=new et,I=y.getNodes().iterator();I.hasNext();){var U=I.next();if(!U.isVisited()){var re=new _t;re.create(U),_.add(re)}}return uo.sort(_,uo.reverseOrder()),_}},{key:"createEmptyResultGeometry",value:function(){return this._geomFact.createPolygon()}},{key:"getNoder",value:function(y){if(this._workingNoder!==null)return this._workingNoder;var _=new nl,I=new kr;return I.setPrecisionModel(y),_.setSegmentIntersector(new Fl(I)),_}},{key:"buffer",value:function(y,_){var I=this._workingPrecisionModel;I===null&&(I=y.getPrecisionModel()),this._geomFact=y.getFactory();var U=new iu(I,this._bufParams),re=new Eu(y,_,U).getCurves();if(re.size()<=0)return this.createEmptyResultGeometry();this.computeNodedEdges(re,I),this._graph=new tl(new Fs),this._graph.addEdges(this._edgeList.getEdges());var ye=this.createSubgraphs(this._graph),Re=new nu(this._geomFact);this.buildSubgraphs(ye,Re);var Ke=Re.getPolygons();return Ke.size()<=0?this.createEmptyResultGeometry():this._geomFact.buildGeometry(Ke)}},{key:"computeNodedEdges",value:function(y,_){var I=this.getNoder(_);I.computeNodes(y);for(var U=I.getNodedSubstrings().iterator();U.hasNext();){var re=U.next(),ye=re.getCoordinates();if(ye.length!==2||!ye[0].equals2D(ye[1])){var Re=re.getData(),Ke=new ya(re.getCoordinates(),new En(Re));this.insertUniqueEdge(Ke)}}}},{key:"setNoder",value:function(y){this._workingNoder=y}}],[{key:"constructor_",value:function(){this._bufParams=null,this._workingPrecisionModel=null,this._workingNoder=null,this._geomFact=null,this._graph=null,this._edgeList=new Wu;var y=arguments[0];this._bufParams=y}},{key:"depthDelta",value:function(y){var _=y.getLocation(0,vt.LEFT),I=y.getLocation(0,vt.RIGHT);return _===Ie.INTERIOR&&I===Ie.EXTERIOR?1:_===Ie.EXTERIOR&&I===Ie.INTERIOR?-1:0}},{key:"convertSegStrings",value:function(y){for(var _=new No,I=new et;y.hasNext();){var U=y.next(),re=_.createLineString(U.getCoordinates());I.add(re)}return _.buildGeometry(I)}}])})(),il=(function(){function A(){i(this,A),A.constructor_.apply(this,arguments)}return o(A,[{key:"rescale",value:function(){if(wr(arguments[0],Mt))for(var y=arguments[0].iterator();y.hasNext();){var _=y.next();this.rescale(_.getCoordinates())}else if(arguments[0]instanceof Array){for(var I=arguments[0],U=0;U<I.length;U++)I[U].x=I[U].x/this._scaleFactor+this._offsetX,I[U].y=I[U].y/this._scaleFactor+this._offsetY;I.length===2&&I[0].equals2D(I[1])&&Jt.out.println(I)}}},{key:"scale",value:function(){if(wr(arguments[0],Mt)){for(var y=arguments[0],_=new et(y.size()),I=y.iterator();I.hasNext();){var U=I.next();_.add(new $i(this.scale(U.getCoordinates()),U.getData()))}return _}if(arguments[0]instanceof Array){for(var re=arguments[0],ye=new Array(re.length).fill(null),Re=0;Re<re.length;Re++)ye[Re]=new De(Math.round((re[Re].x-this._offsetX)*this._scaleFactor),Math.round((re[Re].y-this._offsetY)*this._scaleFactor),re[Re].getZ());return Gi.removeRepeatedPoints(ye)}}},{key:"isIntegerPrecision",value:function(){return this._scaleFactor===1}},{key:"getNodedSubstrings",value:function(){var y=this._noder.getNodedSubstrings();return this._isScaled&&this.rescale(y),y}},{key:"computeNodes",value:function(y){var _=y;this._isScaled&&(_=this.scale(y)),this._noder.computeNodes(_)}},{key:"interfaces_",get:function(){return[Qa]}}],[{key:"constructor_",value:function(){if(this._noder=null,this._scaleFactor=null,this._offsetX=null,this._offsetY=null,this._isScaled=!1,arguments.length===2){var y=arguments[0],_=arguments[1];A.constructor_.call(this,y,_,0,0)}else if(arguments.length===4){var I=arguments[0],U=arguments[1];this._noder=I,this._scaleFactor=U,this._isScaled=!this.isIntegerPrecision()}}}])})(),zs=(function(){function A(){i(this,A),A.constructor_.apply(this,arguments)}return o(A,[{key:"checkEndPtVertexIntersections",value:function(){if(arguments.length===0)for(var y=this._segStrings.iterator();y.hasNext();){var _=y.next().getCoordinates();this.checkEndPtVertexIntersections(_[0],this._segStrings),this.checkEndPtVertexIntersections(_[_.length-1],this._segStrings)}else if(arguments.length===2){for(var I=arguments[0],U=arguments[1].iterator();U.hasNext();)for(var re=U.next().getCoordinates(),ye=1;ye<re.length-1;ye++)if(re[ye].equals(I))throw new he("found endpt/interior pt intersection at index "+ye+" :pt "+I)}}},{key:"checkInteriorIntersections",value:function(){if(arguments.length===0)for(var y=this._segStrings.iterator();y.hasNext();)for(var _=y.next(),I=this._segStrings.iterator();I.hasNext();){var U=I.next();this.checkInteriorIntersections(_,U)}else if(arguments.length===2)for(var re=arguments[0],ye=arguments[1],Re=re.getCoordinates(),Ke=ye.getCoordinates(),yt=0;yt<Re.length-1;yt++)for(var Zt=0;Zt<Ke.length-1;Zt++)this.checkInteriorIntersections(re,yt,ye,Zt);else if(arguments.length===4){var ur=arguments[0],Vr=arguments[1],gn=arguments[2],Rn=arguments[3];if(ur===gn&&Vr===Rn)return null;var Vn=ur.getCoordinates()[Vr],In=ur.getCoordinates()[Vr+1],Dn=gn.getCoordinates()[Rn],Qi=gn.getCoordinates()[Rn+1];if(this._li.computeIntersection(Vn,In,Dn,Qi),this._li.hasIntersection()&&(this._li.isProper()||this.hasInteriorIntersection(this._li,Vn,In)||this.hasInteriorIntersection(this._li,Dn,Qi)))throw new he("found non-noded intersection at "+Vn+"-"+In+" and "+Dn+"-"+Qi)}}},{key:"checkValid",value:function(){this.checkEndPtVertexIntersections(),this.checkInteriorIntersections(),this.checkCollapses()}},{key:"checkCollapses",value:function(){if(arguments.length===0)for(var y=this._segStrings.iterator();y.hasNext();){var _=y.next();this.checkCollapses(_)}else if(arguments.length===1)for(var I=arguments[0].getCoordinates(),U=0;U<I.length-2;U++)this.checkCollapse(I[U],I[U+1],I[U+2])}},{key:"hasInteriorIntersection",value:function(y,_,I){for(var U=0;U<y.getIntersectionNum();U++){var re=y.getIntersection(U);if(!re.equals(_)&&!re.equals(I))return!0}return!1}},{key:"checkCollapse",value:function(y,_,I){if(y.equals(I))throw new he("found non-noded collapse at "+A.fact.createLineString([y,_,I]))}}],[{key:"constructor_",value:function(){this._li=new kr,this._segStrings=null;var y=arguments[0];this._segStrings=y}}])})();zs.fact=new No;var jl=(function(){function A(){i(this,A),A.constructor_.apply(this,arguments)}return o(A,[{key:"intersectsScaled",value:function(y,_){var I=Math.min(y.x,_.x),U=Math.max(y.x,_.x),re=Math.min(y.y,_.y),ye=Math.max(y.y,_.y),Re=this._maxx<I||this._minx>U||this._maxy<re||this._miny>ye;if(Re)return!1;var Ke=this.intersectsToleranceSquare(y,_);return xe.isTrue(!(Re&&Ke),"Found bad envelope test"),Ke}},{key:"initCorners",value:function(y){var _=.5;this._minx=y.x-_,this._maxx=y.x+_,this._miny=y.y-_,this._maxy=y.y+_,this._corner[0]=new De(this._maxx,this._maxy),this._corner[1]=new De(this._minx,this._maxy),this._corner[2]=new De(this._minx,this._miny),this._corner[3]=new De(this._maxx,this._miny)}},{key:"intersects",value:function(y,_){return this._scaleFactor===1?this.intersectsScaled(y,_):(this.copyScaled(y,this._p0Scaled),this.copyScaled(_,this._p1Scaled),this.intersectsScaled(this._p0Scaled,this._p1Scaled))}},{key:"scale",value:function(y){return Math.round(y*this._scaleFactor)}},{key:"getCoordinate",value:function(){return this._originalPt}},{key:"copyScaled",value:function(y,_){_.x=this.scale(y.x),_.y=this.scale(y.y)}},{key:"getSafeEnvelope",value:function(){if(this._safeEnv===null){var y=A.SAFE_ENV_EXPANSION_FACTOR/this._scaleFactor;this._safeEnv=new Ye(this._originalPt.x-y,this._originalPt.x+y,this._originalPt.y-y,this._originalPt.y+y)}return this._safeEnv}},{key:"intersectsPixelClosure",value:function(y,_){return this._li.computeIntersection(y,_,this._corner[0],this._corner[1]),!!this._li.hasIntersection()||(this._li.computeIntersection(y,_,this._corner[1],this._corner[2]),!!this._li.hasIntersection()||(this._li.computeIntersection(y,_,this._corner[2],this._corner[3]),!!this._li.hasIntersection()||(this._li.computeIntersection(y,_,this._corner[3],this._corner[0]),!!this._li.hasIntersection())))}},{key:"intersectsToleranceSquare",value:function(y,_){var I=!1,U=!1;return this._li.computeIntersection(y,_,this._corner[0],this._corner[1]),!!this._li.isProper()||(this._li.computeIntersection(y,_,this._corner[1],this._corner[2]),!!this._li.isProper()||(this._li.hasIntersection()&&(I=!0),this._li.computeIntersection(y,_,this._corner[2],this._corner[3]),!!this._li.isProper()||(this._li.hasIntersection()&&(U=!0),this._li.computeIntersection(y,_,this._corner[3],this._corner[0]),!!this._li.isProper()||!(!I||!U)||!!y.equals(this._pt)||!!_.equals(this._pt))))}},{key:"addSnappedNode",value:function(y,_){var I=y.getCoordinate(_),U=y.getCoordinate(_+1);return!!this.intersects(I,U)&&(y.addIntersection(this.getCoordinate(),_),!0)}}],[{key:"constructor_",value:function(){this._li=null,this._pt=null,this._originalPt=null,this._ptScaled=null,this._p0Scaled=null,this._p1Scaled=null,this._scaleFactor=null,this._minx=null,this._maxx=null,this._miny=null,this._maxy=null,this._corner=new Array(4).fill(null),this._safeEnv=null;var y=arguments[0],_=arguments[1],I=arguments[2];if(this._originalPt=y,this._pt=y,this._scaleFactor=_,this._li=I,_<=0)throw new z("Scale factor must be non-zero");_!==1&&(this._pt=new De(this.scale(y.x),this.scale(y.y)),this._p0Scaled=new De,this._p1Scaled=new De),this.initCorners(this._pt)}}])})();jl.SAFE_ENV_EXPANSION_FACTOR=.75;var Cu=(function(){return o((function A(){i(this,A),A.constructor_.apply(this,arguments)}),[{key:"select",value:function(){if(arguments.length!==1){if(arguments.length===2){var A=arguments[1];arguments[0].getLineSegment(A,this.selectedSegment),this.select(this.selectedSegment)}}}}],[{key:"constructor_",value:function(){this.selectedSegment=new Bi}}])})(),js=(function(){return o((function A(){i(this,A),A.constructor_.apply(this,arguments)}),[{key:"snap",value:function(){if(arguments.length===1){var A=arguments[0];return this.snap(A,null,-1)}if(arguments.length===3){var y=arguments[0],_=arguments[1],I=arguments[2],U=y.getSafeEnvelope(),re=new ou(y,_,I);return this._index.query(U,new((function(){return o((function ye(){i(this,ye)}),[{key:"interfaces_",get:function(){return[le]}},{key:"visitItem",value:function(ye){ye.select(U,re)}}])})())),re.isNodeAdded()}}}],[{key:"constructor_",value:function(){this._index=null;var A=arguments[0];this._index=A}}])})(),ou=(function(A){function y(){var _;return i(this,y),_=n(this,y),y.constructor_.apply(_,arguments),_}return g(y,A),o(y,[{key:"isNodeAdded",value:function(){return this._isNodeAdded}},{key:"select",value:function(){if(!(arguments.length===2&&Number.isInteger(arguments[1])&&arguments[0]instanceof Fa))return S(y,"select",this,1).apply(this,arguments);var _=arguments[1],I=arguments[0].getContext();if(this._parentEdge===I&&(_===this._hotPixelVertexIndex||_+1===this._hotPixelVertexIndex))return null;this._isNodeAdded|=this._hotPixel.addSnappedNode(I,_)}}],[{key:"constructor_",value:function(){this._hotPixel=null,this._parentEdge=null,this._hotPixelVertexIndex=null,this._isNodeAdded=!1;var _=arguments[0],I=arguments[1],U=arguments[2];this._hotPixel=_,this._parentEdge=I,this._hotPixelVertexIndex=U}}])})(Cu);js.HotPixelSnapAction=ou;var Ul=(function(){return o((function A(){i(this,A),A.constructor_.apply(this,arguments)}),[{key:"processIntersections",value:function(A,y,_,I){if(A===_&&y===I)return null;var U=A.getCoordinates()[y],re=A.getCoordinates()[y+1],ye=_.getCoordinates()[I],Re=_.getCoordinates()[I+1];if(this._li.computeIntersection(U,re,ye,Re),this._li.hasIntersection()&&this._li.isInteriorIntersection()){for(var Ke=0;Ke<this._li.getIntersectionNum();Ke++)this._interiorIntersections.add(this._li.getIntersection(Ke));A.addIntersections(this._li,y,0),_.addIntersections(this._li,I,1)}}},{key:"isDone",value:function(){return!1}},{key:"getInteriorIntersections",value:function(){return this._interiorIntersections}},{key:"interfaces_",get:function(){return[wl]}}],[{key:"constructor_",value:function(){this._li=null,this._interiorIntersections=null;var A=arguments[0];this._li=A,this._interiorIntersections=new et}}])})(),$t=(function(){return o((function A(){i(this,A),A.constructor_.apply(this,arguments)}),[{key:"checkCorrectness",value:function(A){var y=$i.getNodedSubstrings(A),_=new zs(y);try{_.checkValid()}catch(I){if(!(I instanceof M))throw I;I.printStackTrace()}}},{key:"getNodedSubstrings",value:function(){return $i.getNodedSubstrings(this._nodedSegStrings)}},{key:"snapRound",value:function(A,y){var _=this.findInteriorIntersections(A,y);this.computeIntersectionSnaps(_),this.computeVertexSnaps(A)}},{key:"findInteriorIntersections",value:function(A,y){var _=new Ul(y);return this._noder.setSegmentIntersector(_),this._noder.computeNodes(A),_.getInteriorIntersections()}},{key:"computeVertexSnaps",value:function(){if(wr(arguments[0],Mt))for(var A=arguments[0].iterator();A.hasNext();){var y=A.next();this.computeVertexSnaps(y)}else if(arguments[0]instanceof $i)for(var _=arguments[0],I=_.getCoordinates(),U=0;U<I.length;U++){var re=new jl(I[U],this._scaleFactor,this._li);this._pointSnapper.snap(re,_,U)&&_.addIntersection(I[U],U)}}},{key:"computeNodes",value:function(A){this._nodedSegStrings=A,this._noder=new nl,this._pointSnapper=new js(this._noder.getIndex()),this.snapRound(A,this._li)}},{key:"computeIntersectionSnaps",value:function(A){for(var y=A.iterator();y.hasNext();){var _=y.next(),I=new jl(_,this._scaleFactor,this._li);this._pointSnapper.snap(I)}}},{key:"interfaces_",get:function(){return[Qa]}}],[{key:"constructor_",value:function(){this._pm=null,this._li=null,this._scaleFactor=null,this._noder=null,this._pointSnapper=null,this._nodedSegStrings=null;var A=arguments[0];this._pm=A,this._li=new kr,this._li.setPrecisionModel(A),this._scaleFactor=A.getScale()}}])})(),tr=(function(){function A(){i(this,A),A.constructor_.apply(this,arguments)}return o(A,[{key:"bufferFixedPrecision",value:function(y){var _=new il(new $t(new Pa(1)),y.getScale()),I=new Tu(this._bufParams);I.setWorkingPrecisionModel(y),I.setNoder(_),this._resultGeometry=I.buffer(this._argGeom,this._distance)}},{key:"bufferReducedPrecision",value:function(){if(arguments.length===0){for(var y=A.MAX_PRECISION_DIGITS;y>=0;y--){try{this.bufferReducedPrecision(y)}catch(re){if(!(re instanceof Qe))throw re;this._saveException=re}if(this._resultGeometry!==null)return null}throw this._saveException}if(arguments.length===1){var _=arguments[0],I=A.precisionScaleFactor(this._argGeom,this._distance,_),U=new Pa(I);this.bufferFixedPrecision(U)}}},{key:"computeGeometry",value:function(){if(this.bufferOriginalPrecision(),this._resultGeometry!==null)return null;var y=this._argGeom.getFactory().getPrecisionModel();y.getType()===Pa.FIXED?this.bufferFixedPrecision(y):this.bufferReducedPrecision()}},{key:"setQuadrantSegments",value:function(y){this._bufParams.setQuadrantSegments(y)}},{key:"bufferOriginalPrecision",value:function(){try{var y=new Tu(this._bufParams);this._resultGeometry=y.buffer(this._argGeom,this._distance)}catch(_){if(!(_ instanceof he))throw _;this._saveException=_}}},{key:"getResultGeometry",value:function(y){return this._distance=y,this.computeGeometry(),this._resultGeometry}},{key:"setEndCapStyle",value:function(y){this._bufParams.setEndCapStyle(y)}}],[{key:"constructor_",value:function(){if(this._argGeom=null,this._distance=null,this._bufParams=new O,this._resultGeometry=null,this._saveException=null,arguments.length===1){var y=arguments[0];this._argGeom=y}else if(arguments.length===2){var _=arguments[0],I=arguments[1];this._argGeom=_,this._bufParams=I}}},{key:"bufferOp",value:function(){if(arguments.length===2){var y=arguments[1];return new A(arguments[0]).getResultGeometry(y)}if(arguments.length===3){if(Number.isInteger(arguments[2])&&arguments[0]instanceof rt&&typeof arguments[1]=="number"){var _=arguments[1],I=arguments[2],U=new A(arguments[0]);return U.setQuadrantSegments(I),U.getResultGeometry(_)}if(arguments[2]instanceof O&&arguments[0]instanceof rt&&typeof arguments[1]=="number"){var re=arguments[1];return new A(arguments[0],arguments[2]).getResultGeometry(re)}}else if(arguments.length===4){var ye=arguments[1],Re=arguments[2],Ke=arguments[3],yt=new A(arguments[0]);return yt.setQuadrantSegments(Re),yt.setEndCapStyle(Ke),yt.getResultGeometry(ye)}}},{key:"precisionScaleFactor",value:function(y,_,I){var U=y.getEnvelopeInternal(),re=Kt.max(Math.abs(U.getMaxX()),Math.abs(U.getMaxY()),Math.abs(U.getMinX()),Math.abs(U.getMinY()))+2*(_>0?_:0),ye=I-Math.trunc(Math.log(re)/Math.log(10)+1);return Math.pow(10,ye)}}])})();tr.CAP_ROUND=O.CAP_ROUND,tr.CAP_BUTT=O.CAP_FLAT,tr.CAP_FLAT=O.CAP_FLAT,tr.CAP_SQUARE=O.CAP_SQUARE,tr.MAX_PRECISION_DIGITS=12;var sn=["Point","MultiPoint","LineString","MultiLineString","Polygon","MultiPolygon"],Cn=(function(){return o((function A(y){i(this,A),this.geometryFactory=y||new No}),[{key:"read",value:function(A){var y,_=(y=typeof A=="string"?JSON.parse(A):A).type;if(!bi[_])throw new Error("Unknown GeoJSON type: "+y.type);return sn.indexOf(_)!==-1?bi[_].call(this,y.coordinates):_==="GeometryCollection"?bi[_].call(this,y.geometries):bi[_].call(this,y)}},{key:"write",value:function(A){var y=A.getGeometryType();if(!An[y])throw new Error("Geometry is not supported");return An[y].call(this,A)}}])})(),bi={Feature:function(A){var y={};for(var _ in A)y[_]=A[_];if(A.geometry){var I=A.geometry.type;if(!bi[I])throw new Error("Unknown GeoJSON type: "+A.type);y.geometry=this.read(A.geometry)}return A.bbox&&(y.bbox=bi.bbox.call(this,A.bbox)),y},FeatureCollection:function(A){var y={};if(A.features){y.features=[];for(var _=0;_<A.features.length;++_)y.features.push(this.read(A.features[_]))}return A.bbox&&(y.bbox=this.parse.bbox.call(this,A.bbox)),y},coordinates:function(A){for(var y=[],_=0;_<A.length;++_){var I=A[_];y.push(a(De,E(I)))}return y},bbox:function(A){return this.geometryFactory.createLinearRing([new De(A[0],A[1]),new De(A[2],A[1]),new De(A[2],A[3]),new De(A[0],A[3]),new De(A[0],A[1])])},Point:function(A){var y=a(De,E(A));return this.geometryFactory.createPoint(y)},MultiPoint:function(A){for(var y=[],_=0;_<A.length;++_)y.push(bi.Point.call(this,A[_]));return this.geometryFactory.createMultiPoint(y)},LineString:function(A){var y=bi.coordinates.call(this,A);return this.geometryFactory.createLineString(y)},MultiLineString:function(A){for(var y=[],_=0;_<A.length;++_)y.push(bi.LineString.call(this,A[_]));return this.geometryFactory.createMultiLineString(y)},Polygon:function(A){for(var y=bi.coordinates.call(this,A[0]),_=this.geometryFactory.createLinearRing(y),I=[],U=1;U<A.length;++U){var re=A[U],ye=bi.coordinates.call(this,re),Re=this.geometryFactory.createLinearRing(ye);I.push(Re)}return this.geometryFactory.createPolygon(_,I)},MultiPolygon:function(A){for(var y=[],_=0;_<A.length;++_){var I=A[_];y.push(bi.Polygon.call(this,I))}return this.geometryFactory.createMultiPolygon(y)},GeometryCollection:function(A){for(var y=[],_=0;_<A.length;++_){var I=A[_];y.push(this.read(I))}return this.geometryFactory.createGeometryCollection(y)}},An={coordinate:function(A){var y=[A.x,A.y];return A.z&&y.push(A.z),A.m&&y.push(A.m),y},Point:function(A){return{type:"Point",coordinates:An.coordinate.call(this,A.getCoordinate())}},MultiPoint:function(A){for(var y=[],_=0;_<A._geometries.length;++_){var I=A._geometries[_],U=An.Point.call(this,I);y.push(U.coordinates)}return{type:"MultiPoint",coordinates:y}},LineString:function(A){for(var y=[],_=A.getCoordinates(),I=0;I<_.length;++I){var U=_[I];y.push(An.coordinate.call(this,U))}return{type:"LineString",coordinates:y}},MultiLineString:function(A){for(var y=[],_=0;_<A._geometries.length;++_){var I=A._geometries[_],U=An.LineString.call(this,I);y.push(U.coordinates)}return{type:"MultiLineString",coordinates:y}},Polygon:function(A){var y=[],_=An.LineString.call(this,A._shell);y.push(_.coordinates);for(var I=0;I<A._holes.length;++I){var U=A._holes[I],re=An.LineString.call(this,U);y.push(re.coordinates)}return{type:"Polygon",coordinates:y}},MultiPolygon:function(A){for(var y=[],_=0;_<A._geometries.length;++_){var I=A._geometries[_],U=An.Polygon.call(this,I);y.push(U.coordinates)}return{type:"MultiPolygon",coordinates:y}},GeometryCollection:function(A){for(var y=[],_=0;_<A._geometries.length;++_){var I=A._geometries[_],U=I.getGeometryType();y.push(An[U].call(this,I))}return{type:"GeometryCollection",geometries:y}}};return{BufferOp:tr,GeoJSONReader:(function(){return o((function A(y){i(this,A),this.parser=new Cn(y||new No)}),[{key:"read",value:function(A){return this.parser.read(A)}}])})(),GeoJSONWriter:(function(){return o((function A(){i(this,A),this.parser=new Cn(this.geometryFactory)}),[{key:"write",value:function(A){return this.parser.write(A)}}])})()}}))})(vw)),vw.exports}var Qbe=Jbe();const exe=od(Qbe);function hg(){return new dS}function dS(){this.reset()}dS.prototype={constructor:dS,reset:function(){this.s=this.t=0},add:function(t){Oz(S2,t,this.t),Oz(this,S2.s,this.s),this.s?this.t+=S2.t:this.s=S2.t},valueOf:function(){return this.s}};var S2=new dS;function Oz(t,e,r){var n=t.s=e+r,i=n-e,a=n-i;t.t=e-a+(r-i)}var Ro=1e-6,La=Math.PI,Wf=La/2,Lz=La/4,nd=La*2,Sp=180/La,dh=La/180,Jl=Math.abs,txe=Math.atan,f0=Math.atan2,ms=Math.cos,ys=Math.sin,B0=Math.sqrt;function bZ(t){return t>1?0:t<-1?La:Math.acos(t)}function Sm(t){return t>1?Wf:t<-1?-Wf:Math.asin(t)}function Q_(){}function pS(t,e){t&&Dz.hasOwnProperty(t.type)&&Dz[t.type](t,e)}var Nz={Feature:function(t,e){pS(t.geometry,e)},FeatureCollection:function(t,e){for(var r=t.features,n=-1,i=r.length;++n<i;)pS(r[n].geometry,e)}},Dz={Sphere:function(t,e){e.sphere()},Point:function(t,e){t=t.coordinates,e.point(t[0],t[1],t[2])},MultiPoint:function(t,e){for(var r=t.coordinates,n=-1,i=r.length;++n<i;)t=r[n],e.point(t[0],t[1],t[2])},LineString:function(t,e){bk(t.coordinates,e,0)},MultiLineString:function(t,e){for(var r=t.coordinates,n=-1,i=r.length;++n<i;)bk(r[n],e,0)},Polygon:function(t,e){Fz(t.coordinates,e)},MultiPolygon:function(t,e){for(var r=t.coordinates,n=-1,i=r.length;++n<i;)Fz(r[n],e)},GeometryCollection:function(t,e){for(var r=t.geometries,n=-1,i=r.length;++n<i;)pS(r[n],e)}};function bk(t,e,r){var n=-1,i=t.length-r,a;for(e.lineStart();++n<i;)a=t[n],e.point(a[0],a[1],a[2]);e.lineEnd()}function Fz(t,e){var r=-1,n=t.length;for(e.polygonStart();++r<n;)bk(t[r],e,1);e.polygonEnd()}function rxe(t,e){t&&Nz.hasOwnProperty(t.type)?Nz[t.type](t,e):pS(t,e)}hg();hg();function xk(t){return[f0(t[1],t[0]),Sm(t[2])]}function d0(t){var e=t[0],r=t[1],n=ms(r);return[n*ms(e),n*ys(e),ys(r)]}function E2(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function gS(t,e){return[t[1]*e[2]-t[2]*e[1],t[2]*e[0]-t[0]*e[2],t[0]*e[1]-t[1]*e[0]]}function J3(t,e){t[0]+=e[0],t[1]+=e[1],t[2]+=e[2]}function T2(t,e){return[t[0]*e,t[1]*e,t[2]*e]}function wk(t){var e=B0(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]);t[0]/=e,t[1]/=e,t[2]/=e}hg();function xZ(t,e){function r(n,i){return n=t(n,i),e(n[0],n[1])}return t.invert&&e.invert&&(r.invert=function(n,i){return n=e.invert(n,i),n&&t.invert(n[0],n[1])}),r}function Sk(t,e){return[t>La?t-nd:t<-La?t+nd:t,e]}Sk.invert=Sk;function nxe(t,e,r){return(t%=nd)?e||r?xZ(zz(t),jz(e,r)):zz(t):e||r?jz(e,r):Sk}function Bz(t){return function(e,r){return e+=t,[e>La?e-nd:e<-La?e+nd:e,r]}}function zz(t){var e=Bz(t);return e.invert=Bz(-t),e}function jz(t,e){var r=ms(t),n=ys(t),i=ms(e),a=ys(e);function s(o,u){var h=ms(u),f=ms(o)*h,g=ys(o)*h,b=ys(u),v=b*r+f*n;return[f0(g*i-v*a,f*r-b*n),Sm(v*i+g*a)]}return s.invert=function(o,u){var h=ms(u),f=ms(o)*h,g=ys(o)*h,b=ys(u),v=b*i-g*a;return[f0(g*i+b*a,f*r+v*n),Sm(v*r-f*n)]},s}function ixe(t,e,r,n,i,a){if(r){var s=ms(e),o=ys(e),u=n*r;i==null?(i=e+n*nd,a=e-u/2):(i=Uz(s,i),a=Uz(s,a),(n>0?i<a:i>a)&&(i+=n*nd));for(var h,f=i;n>0?f>a:f<a;f-=u)h=xk([s,-o*ms(f),-o*ys(f)]),t.point(h[0],h[1])}}function Uz(t,e){e=d0(e),e[0]-=t,wk(e);var r=bZ(-e[1]);return((-e[2]<0?-r:r)+nd-Ro)%nd}function wZ(){var t=[],e;return{point:function(r,n){e.push([r,n])},lineStart:function(){t.push(e=[])},lineEnd:Q_,rejoin:function(){t.length>1&&t.push(t.pop().concat(t.shift()))},result:function(){var r=t;return t=[],e=null,r}}}function axe(t,e,r,n,i,a){var s=t[0],o=t[1],u=e[0],h=e[1],f=0,g=1,b=u-s,v=h-o,S;if(S=r-s,!(!b&&S>0)){if(S/=b,b<0){if(S<f)return;S<g&&(g=S)}else if(b>0){if(S>g)return;S>f&&(f=S)}if(S=i-s,!(!b&&S<0)){if(S/=b,b<0){if(S>g)return;S>f&&(f=S)}else if(b>0){if(S<f)return;S<g&&(g=S)}if(S=n-o,!(!v&&S>0)){if(S/=v,v<0){if(S<f)return;S<g&&(g=S)}else if(v>0){if(S>g)return;S>f&&(f=S)}if(S=a-o,!(!v&&S<0)){if(S/=v,v<0){if(S>g)return;S>f&&(f=S)}else if(v>0){if(S<f)return;S<g&&(g=S)}return f>0&&(t[0]=s+f*b,t[1]=o+f*v),g<1&&(e[0]=s+g*b,e[1]=o+g*v),!0}}}}}function _w(t,e){return Jl(t[0]-e[0])<Ro&&Jl(t[1]-e[1])<Ro}function C2(t,e,r,n){this.x=t,this.z=e,this.o=r,this.e=n,this.v=!1,this.n=this.p=null}function SZ(t,e,r,n,i){var a=[],s=[],o,u;if(t.forEach(function(S){if(!((E=S.length-1)<=0)){var E,P=S[0],k=S[E],L;if(_w(P,k)){for(i.lineStart(),o=0;o<E;++o)i.point((P=S[o])[0],P[1]);i.lineEnd();return}a.push(L=new C2(P,S,null,!0)),s.push(L.o=new C2(P,null,L,!1)),a.push(L=new C2(k,S,null,!1)),s.push(L.o=new C2(k,null,L,!0))}}),!!a.length){for(s.sort(e),Vz(a),Vz(s),o=0,u=s.length;o<u;++o)s[o].e=r=!r;for(var h=a[0],f,g;;){for(var b=h,v=!0;b.v;)if((b=b.n)===h)return;f=b.z,i.lineStart();do{if(b.v=b.o.v=!0,b.e){if(v)for(o=0,u=f.length;o<u;++o)i.point((g=f[o])[0],g[1]);else n(b.x,b.n.x,1,i);b=b.n}else{if(v)for(f=b.p.z,o=f.length-1;o>=0;--o)i.point((g=f[o])[0],g[1]);else n(b.x,b.p.x,-1,i);b=b.p}b=b.o,f=b.z,v=!v}while(!b.v);i.lineEnd()}}}function Vz(t){if(e=t.length){for(var e,r=0,n=t[0],i;++r<e;)n.n=i=t[r],i.p=n,n=i;n.n=i=t[0],i.p=n}}function EZ(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function oxe(t){return t.length===1&&(t=sxe(t)),{left:function(e,r,n,i){for(n==null&&(n=0),i==null&&(i=e.length);n<i;){var a=n+i>>>1;t(e[a],r)<0?n=a+1:i=a}return n},right:function(e,r,n,i){for(n==null&&(n=0),i==null&&(i=e.length);n<i;){var a=n+i>>>1;t(e[a],r)>0?i=a:n=a+1}return n}}}function sxe(t){return function(e,r){return EZ(t(e),r)}}oxe(EZ);function TZ(t){for(var e=t.length,r,n=-1,i=0,a,s;++n<e;)i+=t[n].length;for(a=new Array(i);--e>=0;)for(s=t[e],r=s.length;--r>=0;)a[--i]=s[r];return a}var e1=1e9,A2=-e1;function lxe(t,e,r,n){function i(h,f){return t<=h&&h<=r&&e<=f&&f<=n}function a(h,f,g,b){var v=0,S=0;if(h==null||(v=s(h,g))!==(S=s(f,g))||u(h,f)<0^g>0)do b.point(v===0||v===3?t:r,v>1?n:e);while((v=(v+g+4)%4)!==S);else b.point(f[0],f[1])}function s(h,f){return Jl(h[0]-t)<Ro?f>0?0:3:Jl(h[0]-r)<Ro?f>0?2:1:Jl(h[1]-e)<Ro?f>0?1:0:f>0?3:2}function o(h,f){return u(h.x,f.x)}function u(h,f){var g=s(h,1),b=s(f,1);return g!==b?g-b:g===0?f[1]-h[1]:g===1?h[0]-f[0]:g===2?h[1]-f[1]:f[0]-h[0]}return function(h){var f=h,g=wZ(),b,v,S,E,P,k,L,O,M,z,B,q={point:W,lineStart:H,lineEnd:ne,polygonStart:ie,polygonEnd:Q};function W(ce,fe){i(ce,fe)&&f.point(ce,fe)}function G(){for(var ce=0,fe=0,Me=v.length;fe<Me;++fe)for(var me=v[fe],we=1,Te=me.length,ke=me[0],he,Ee,xe=ke[0],Ne=ke[1];we<Te;++we)he=xe,Ee=Ne,ke=me[we],xe=ke[0],Ne=ke[1],Ee<=n?Ne>n&&(xe-he)*(n-Ee)>(Ne-Ee)*(t-he)&&++ce:Ne<=n&&(xe-he)*(n-Ee)<(Ne-Ee)*(t-he)&&--ce;return ce}function ie(){f=g,b=[],v=[],B=!0}function Q(){var ce=G(),fe=B&&ce,Me=(b=TZ(b)).length;(fe||Me)&&(h.polygonStart(),fe&&(h.lineStart(),a(null,null,1,h),h.lineEnd()),Me&&SZ(b,o,ce,a,h),h.polygonEnd()),f=h,b=v=S=null}function H(){q.point=oe,v&&v.push(S=[]),z=!0,M=!1,L=O=NaN}function ne(){b&&(oe(E,P),k&&M&&g.rejoin(),b.push(g.result())),q.point=W,M&&f.lineEnd()}function oe(ce,fe){var Me=i(ce,fe);if(v&&S.push([ce,fe]),z)E=ce,P=fe,k=Me,z=!1,Me&&(f.lineStart(),f.point(ce,fe));else if(Me&&M)f.point(ce,fe);else{var me=[L=Math.max(A2,Math.min(e1,L)),O=Math.max(A2,Math.min(e1,O))],we=[ce=Math.max(A2,Math.min(e1,ce)),fe=Math.max(A2,Math.min(e1,fe))];axe(me,we,t,e,r,n)?(M||(f.lineStart(),f.point(me[0],me[1])),f.point(we[0],we[1]),Me||f.lineEnd(),B=!1):Me&&(f.lineStart(),f.point(ce,fe),B=!1)}L=ce,O=fe,M=Me}return q}}var Q3=hg();function uxe(t,e){var r=e[0],n=e[1],i=[ys(r),-ms(r),0],a=0,s=0;Q3.reset();for(var o=0,u=t.length;o<u;++o)if(f=(h=t[o]).length)for(var h,f,g=h[f-1],b=g[0],v=g[1]/2+Lz,S=ys(v),E=ms(v),P=0;P<f;++P,b=L,S=M,E=z,g=k){var k=h[P],L=k[0],O=k[1]/2+Lz,M=ys(O),z=ms(O),B=L-b,q=B>=0?1:-1,W=q*B,G=W>La,ie=S*M;if(Q3.add(f0(ie*q*ys(W),E*z+ie*ms(W))),a+=G?B+q*nd:B,G^b>=r^L>=r){var Q=gS(d0(g),d0(k));wk(Q);var H=gS(i,Q);wk(H);var ne=(G^B>=0?-1:1)*Sm(H[2]);(n>ne||n===ne&&(Q[0]||Q[1]))&&(s+=G^B>=0?1:-1)}}return(a<-Ro||a<Ro&&Q3<-Ro)^s&1}hg();function $z(t){return t}hg();hg();var p0=1/0,mS=p0,cb=-p0,yS=cb,qz={point:cxe,lineStart:Q_,lineEnd:Q_,polygonStart:Q_,polygonEnd:Q_,result:function(){var t=[[p0,mS],[cb,yS]];return cb=yS=-(mS=p0=1/0),t}};function cxe(t,e){t<p0&&(p0=t),t>cb&&(cb=t),e<mS&&(mS=e),e>yS&&(yS=e)}hg();function CZ(t,e,r,n){return function(i,a){var s=e(a),o=i.invert(n[0],n[1]),u=wZ(),h=e(u),f=!1,g,b,v,S={point:E,lineStart:k,lineEnd:L,polygonStart:function(){S.point=O,S.lineStart=M,S.lineEnd=z,b=[],g=[]},polygonEnd:function(){S.point=E,S.lineStart=k,S.lineEnd=L,b=TZ(b);var B=uxe(g,o);b.length?(f||(a.polygonStart(),f=!0),SZ(b,fxe,B,r,a)):B&&(f||(a.polygonStart(),f=!0),a.lineStart(),r(null,null,1,a),a.lineEnd()),f&&(a.polygonEnd(),f=!1),b=g=null},sphere:function(){a.polygonStart(),a.lineStart(),r(null,null,1,a),a.lineEnd(),a.polygonEnd()}};function E(B,q){var W=i(B,q);t(B=W[0],q=W[1])&&a.point(B,q)}function P(B,q){var W=i(B,q);s.point(W[0],W[1])}function k(){S.point=P,s.lineStart()}function L(){S.point=E,s.lineEnd()}function O(B,q){v.push([B,q]);var W=i(B,q);h.point(W[0],W[1])}function M(){h.lineStart(),v=[]}function z(){O(v[0][0],v[0][1]),h.lineEnd();var B=h.clean(),q=u.result(),W,G=q.length,ie,Q,H;if(v.pop(),g.push(v),v=null,!!G){if(B&1){if(Q=q[0],(ie=Q.length-1)>0){for(f||(a.polygonStart(),f=!0),a.lineStart(),W=0;W<ie;++W)a.point((H=Q[W])[0],H[1]);a.lineEnd()}return}G>1&&B&2&&q.push(q.pop().concat(q.shift())),b.push(q.filter(hxe))}}return S}}function hxe(t){return t.length>1}function fxe(t,e){return((t=t.x)[0]<0?t[1]-Wf-Ro:Wf-t[1])-((e=e.x)[0]<0?e[1]-Wf-Ro:Wf-e[1])}const Hz=CZ(function(){return!0},dxe,gxe,[-La,-Wf]);function dxe(t){var e=NaN,r=NaN,n=NaN,i;return{lineStart:function(){t.lineStart(),i=1},point:function(a,s){var o=a>0?La:-La,u=Jl(a-e);Jl(u-La)<Ro?(t.point(e,r=(r+s)/2>0?Wf:-Wf),t.point(n,r),t.lineEnd(),t.lineStart(),t.point(o,r),t.point(a,r),i=0):n!==o&&u>=La&&(Jl(e-n)<Ro&&(e-=n*Ro),Jl(a-o)<Ro&&(a-=o*Ro),r=pxe(e,r,a,s),t.point(n,r),t.lineEnd(),t.lineStart(),t.point(o,r),i=0),t.point(e=a,r=s),n=o},lineEnd:function(){t.lineEnd(),e=r=NaN},clean:function(){return 2-i}}}function pxe(t,e,r,n){var i,a,s=ys(t-r);return Jl(s)>Ro?txe((ys(e)*(a=ms(n))*ys(r)-ys(n)*(i=ms(e))*ys(t))/(i*a*s)):(e+n)/2}function gxe(t,e,r,n){var i;if(t==null)i=r*Wf,n.point(-La,i),n.point(0,i),n.point(La,i),n.point(La,0),n.point(La,-i),n.point(0,-i),n.point(-La,-i),n.point(-La,0),n.point(-La,i);else if(Jl(t[0]-e[0])>Ro){var a=t[0]<e[0]?La:-La;i=r*a/2,n.point(-a,i),n.point(0,i),n.point(a,i)}else n.point(e[0],e[1])}function mxe(t,e){var r=ms(t),n=r>0,i=Jl(r)>Ro;function a(f,g,b,v){ixe(v,t,e,b,f,g)}function s(f,g){return ms(f)*ms(g)>r}function o(f){var g,b,v,S,E;return{lineStart:function(){S=v=!1,E=1},point:function(P,k){var L=[P,k],O,M=s(P,k),z=n?M?0:h(P,k):M?h(P+(P<0?La:-La),k):0;if(!g&&(S=v=M)&&f.lineStart(),M!==v&&(O=u(g,L),(!O||_w(g,O)||_w(L,O))&&(L[0]+=Ro,L[1]+=Ro,M=s(L[0],L[1]))),M!==v)E=0,M?(f.lineStart(),O=u(L,g),f.point(O[0],O[1])):(O=u(g,L),f.point(O[0],O[1]),f.lineEnd()),g=O;else if(i&&g&&n^M){var B;!(z&b)&&(B=u(L,g,!0))&&(E=0,n?(f.lineStart(),f.point(B[0][0],B[0][1]),f.point(B[1][0],B[1][1]),f.lineEnd()):(f.point(B[1][0],B[1][1]),f.lineEnd(),f.lineStart(),f.point(B[0][0],B[0][1])))}M&&(!g||!_w(g,L))&&f.point(L[0],L[1]),g=L,v=M,b=z},lineEnd:function(){v&&f.lineEnd(),g=null},clean:function(){return E|(S&&v)<<1}}}function u(f,g,b){var v=d0(f),S=d0(g),E=[1,0,0],P=gS(v,S),k=E2(P,P),L=P[0],O=k-L*L;if(!O)return!b&&f;var M=r*k/O,z=-r*L/O,B=gS(E,P),q=T2(E,M),W=T2(P,z);J3(q,W);var G=B,ie=E2(q,G),Q=E2(G,G),H=ie*ie-Q*(E2(q,q)-1);if(!(H<0)){var ne=B0(H),oe=T2(G,(-ie-ne)/Q);if(J3(oe,q),oe=xk(oe),!b)return oe;var ce=f[0],fe=g[0],Me=f[1],me=g[1],we;fe<ce&&(we=ce,ce=fe,fe=we);var Te=fe-ce,ke=Jl(Te-La)<Ro,he=ke||Te<Ro;if(!ke&&me<Me&&(we=Me,Me=me,me=we),he?ke?Me+me>0^oe[1]<(Jl(oe[0]-ce)<Ro?Me:me):Me<=oe[1]&&oe[1]<=me:Te>La^(ce<=oe[0]&&oe[0]<=fe)){var Ee=T2(G,(-ie+ne)/Q);return J3(Ee,q),[oe,xk(Ee)]}}}function h(f,g){var b=n?t:La-t,v=0;return f<-b?v|=1:f>b&&(v|=2),g<-b?v|=4:g>b&&(v|=8),v}return CZ(s,o,a,n?[0,-t]:[-La,t-La])}function AZ(t){return function(e){var r=new Ek;for(var n in t)r[n]=t[n];return r.stream=e,r}}function Ek(){}Ek.prototype={constructor:Ek,point:function(t,e){this.stream.point(t,e)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};function IZ(t,e,r){var n=e[1][0]-e[0][0],i=e[1][1]-e[0][1],a=t.clipExtent&&t.clipExtent();t.scale(150).translate([0,0]),a!=null&&t.clipExtent(null),rxe(r,t.stream(qz));var s=qz.result(),o=Math.min(n/(s[1][0]-s[0][0]),i/(s[1][1]-s[0][1])),u=+e[0][0]+(n-o*(s[1][0]+s[0][0]))/2,h=+e[0][1]+(i-o*(s[1][1]+s[0][1]))/2;return a!=null&&t.clipExtent(a),t.scale(o*150).translate([u,h])}function yxe(t,e,r){return IZ(t,[[0,0],e],r)}var Wz=16,vxe=ms(30*dh);function Gz(t,e){return+e?bxe(t,e):_xe(t)}function _xe(t){return AZ({point:function(e,r){e=t(e,r),this.stream.point(e[0],e[1])}})}function bxe(t,e){function r(n,i,a,s,o,u,h,f,g,b,v,S,E,P){var k=h-n,L=f-i,O=k*k+L*L;if(O>4*e&&E--){var M=s+b,z=o+v,B=u+S,q=B0(M*M+z*z+B*B),W=Sm(B/=q),G=Jl(Jl(B)-1)<Ro||Jl(a-g)<Ro?(a+g)/2:f0(z,M),ie=t(G,W),Q=ie[0],H=ie[1],ne=Q-n,oe=H-i,ce=L*ne-k*oe;(ce*ce/O>e||Jl((k*ne+L*oe)/O-.5)>.3||s*b+o*v+u*S<vxe)&&(r(n,i,a,s,o,u,Q,H,G,M/=q,z/=q,B,E,P),P.point(Q,H),r(Q,H,G,M,z,B,h,f,g,b,v,S,E,P))}}return function(n){var i,a,s,o,u,h,f,g,b,v,S,E,P={point:k,lineStart:L,lineEnd:M,polygonStart:function(){n.polygonStart(),P.lineStart=z},polygonEnd:function(){n.polygonEnd(),P.lineStart=L}};function k(W,G){W=t(W,G),n.point(W[0],W[1])}function L(){g=NaN,P.point=O,n.lineStart()}function O(W,G){var ie=d0([W,G]),Q=t(W,G);r(g,b,f,v,S,E,g=Q[0],b=Q[1],f=W,v=ie[0],S=ie[1],E=ie[2],Wz,n),n.point(g,b)}function M(){P.point=k,n.lineEnd()}function z(){L(),P.point=B,P.lineEnd=q}function B(W,G){O(i=W,G),a=g,s=b,o=v,u=S,h=E,P.point=O}function q(){r(g,b,f,v,S,E,a,s,i,o,u,h,Wz,n),P.lineEnd=M,M()}return P}}var xxe=AZ({point:function(t,e){this.stream.point(t*dh,e*dh)}});function wxe(t){return Sxe(function(){return t})()}function Sxe(t){var e,r=150,n=480,i=250,a,s,o=0,u=0,h=0,f=0,g=0,b,v,S=null,E=Hz,P=null,k,L,O,M=$z,z=.5,B=Gz(Q,z),q,W;function G(oe){return oe=v(oe[0]*dh,oe[1]*dh),[oe[0]*r+a,s-oe[1]*r]}function ie(oe){return oe=v.invert((oe[0]-a)/r,(s-oe[1])/r),oe&&[oe[0]*Sp,oe[1]*Sp]}function Q(oe,ce){return oe=e(oe,ce),[oe[0]*r+a,s-oe[1]*r]}G.stream=function(oe){return q&&W===oe?q:q=xxe(E(b,B(M(W=oe))))},G.clipAngle=function(oe){return arguments.length?(E=+oe?mxe(S=oe*dh,6*dh):(S=null,Hz),ne()):S*Sp},G.clipExtent=function(oe){return arguments.length?(M=oe==null?(P=k=L=O=null,$z):lxe(P=+oe[0][0],k=+oe[0][1],L=+oe[1][0],O=+oe[1][1]),ne()):P==null?null:[[P,k],[L,O]]},G.scale=function(oe){return arguments.length?(r=+oe,H()):r},G.translate=function(oe){return arguments.length?(n=+oe[0],i=+oe[1],H()):[n,i]},G.center=function(oe){return arguments.length?(o=oe[0]%360*dh,u=oe[1]%360*dh,H()):[o*Sp,u*Sp]},G.rotate=function(oe){return arguments.length?(h=oe[0]%360*dh,f=oe[1]%360*dh,g=oe.length>2?oe[2]%360*dh:0,H()):[h*Sp,f*Sp,g*Sp]},G.precision=function(oe){return arguments.length?(B=Gz(Q,z=oe*oe),ne()):B0(z)},G.fitExtent=function(oe,ce){return IZ(G,oe,ce)},G.fitSize=function(oe,ce){return yxe(G,oe,ce)};function H(){v=xZ(b=nxe(h,f,g),e);var oe=e(o,u);return a=n-oe[0]*r,s=i+oe[1]*r,ne()}function ne(){return q=W=null,G}return function(){return e=t.apply(this,arguments),G.invert=e.invert&&ie,H()}}function PZ(t){return function(e,r){var n=ms(e),i=ms(r),a=t(n*i);return[a*i*ys(e),a*ys(r)]}}function kZ(t){return function(e,r){var n=B0(e*e+r*r),i=t(n),a=ys(i),s=ms(i);return[f0(e*a,n*s),Sm(n&&r*a/n)]}}var Exe=PZ(function(t){return B0(2/(1+t))});Exe.invert=kZ(function(t){return 2*Sm(t/2)});var MZ=PZ(function(t){return(t=bZ(t))&&t/ys(t)});MZ.invert=kZ(function(t){return t});function Txe(){return wxe(MZ).scale(79.4188).clipAngle(180-.001)}function Xz(t,e){return[t,e]}Xz.invert=Xz;var{BufferOp:Cxe,GeoJSONReader:Axe,GeoJSONWriter:Ixe}=exe;function Pxe(t,e,r){r=r||{};var n=r.units||"kilometers",i=r.steps||8;if(!t)throw new Error("geojson is required");if(typeof r!="object")throw new Error("options must be an object");if(typeof i!="number")throw new Error("steps must be an number");if(e===void 0)throw new Error("radius is required");if(i<=0)throw new Error("steps must be greater than 0");var a=[];switch(t.type){case"GeometryCollection":return yT(t,function(s){var o=bw(s,e,n,i);o&&a.push(o)}),Xd(a);case"FeatureCollection":return Tz(t,function(s){var o=bw(s,e,n,i);o&&Tz(o,function(u){u&&a.push(u)})}),Xd(a)}return bw(t,e,n,i)}function bw(t,e,r,n){var i=t.properties||{},a=t.type==="Feature"?t.geometry:t;if(a.type==="GeometryCollection"){var s=[];return yT(t,function(E){var P=bw(E,e,r,n);P&&s.push(P)}),Xd(s)}var o=kxe(a),u={type:a.type,coordinates:OZ(a.coordinates,o)},h=new Axe,f=h.read(u),g=gZ(XO(e,r),"meters"),b=Cxe.bufferOp(f,g,n),v=new Ixe;if(b=v.write(b),!RZ(b.coordinates)){var S={type:b.type,coordinates:LZ(b.coordinates,o)};return wm(S,i)}}function RZ(t){return Array.isArray(t[0])?RZ(t[0]):isNaN(t[0])}function OZ(t,e){return typeof t[0]!="object"?e(t):t.map(function(r){return OZ(r,e)})}function LZ(t,e){return typeof t[0]!="object"?e.invert(t):t.map(function(r){return LZ(r,e)})}function kxe(t){var e=Zbe(t).geometry.coordinates,r=[-e[0],-e[1]];return Txe().rotate(r).scale(zu)}function Yz(t,e={}){let r=0,n=0,i=0;return F0(t,function(a){r+=a[0],n+=a[1],i++},!0),Rh([r/i,n/i],e.properties)}var I2={exports:{}},xw={exports:{}},Mxe=xw.exports,Zz;function Rxe(){return Zz||(Zz=1,(function(t,e){(function(r,n){t.exports=n()})(Mxe,function(){function r(L,O,M,z,B){(function q(W,G,ie,Q,H){for(;Q>ie;){if(Q-ie>600){var ne=Q-ie+1,oe=G-ie+1,ce=Math.log(ne),fe=.5*Math.exp(2*ce/3),Me=.5*Math.sqrt(ce*fe*(ne-fe)/ne)*(oe-ne/2<0?-1:1),me=Math.max(ie,Math.floor(G-oe*fe/ne+Me)),we=Math.min(Q,Math.floor(G+(ne-oe)*fe/ne+Me));q(W,G,me,we,H)}var Te=W[G],ke=ie,he=Q;for(n(W,ie,G),H(W[Q],Te)>0&&n(W,ie,Q);ke<he;){for(n(W,ke,he),ke++,he--;H(W[ke],Te)<0;)ke++;for(;H(W[he],Te)>0;)he--}H(W[ie],Te)===0?n(W,ie,he):n(W,++he,Q),he<=G&&(ie=he+1),G<=he&&(Q=he-1)}})(L,O,M||0,z||L.length-1,B||i)}function n(L,O,M){var z=L[O];L[O]=L[M],L[M]=z}function i(L,O){return L<O?-1:L>O?1:0}var a=function(L){L===void 0&&(L=9),this._maxEntries=Math.max(4,L),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),this.clear()};function s(L,O,M){if(!M)return O.indexOf(L);for(var z=0;z<O.length;z++)if(M(L,O[z]))return z;return-1}function o(L,O){u(L,0,L.children.length,O,L)}function u(L,O,M,z,B){B||(B=P(null)),B.minX=1/0,B.minY=1/0,B.maxX=-1/0,B.maxY=-1/0;for(var q=O;q<M;q++){var W=L.children[q];h(B,L.leaf?z(W):W)}return B}function h(L,O){return L.minX=Math.min(L.minX,O.minX),L.minY=Math.min(L.minY,O.minY),L.maxX=Math.max(L.maxX,O.maxX),L.maxY=Math.max(L.maxY,O.maxY),L}function f(L,O){return L.minX-O.minX}function g(L,O){return L.minY-O.minY}function b(L){return(L.maxX-L.minX)*(L.maxY-L.minY)}function v(L){return L.maxX-L.minX+(L.maxY-L.minY)}function S(L,O){return L.minX<=O.minX&&L.minY<=O.minY&&O.maxX<=L.maxX&&O.maxY<=L.maxY}function E(L,O){return O.minX<=L.maxX&&O.minY<=L.maxY&&O.maxX>=L.minX&&O.maxY>=L.minY}function P(L){return{children:L,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function k(L,O,M,z,B){for(var q=[O,M];q.length;)if(!((M=q.pop())-(O=q.pop())<=z)){var W=O+Math.ceil((M-O)/z/2)*z;r(L,W,O,M,B),q.push(O,W,W,M)}}return a.prototype.all=function(){return this._all(this.data,[])},a.prototype.search=function(L){var O=this.data,M=[];if(!E(L,O))return M;for(var z=this.toBBox,B=[];O;){for(var q=0;q<O.children.length;q++){var W=O.children[q],G=O.leaf?z(W):W;E(L,G)&&(O.leaf?M.push(W):S(L,G)?this._all(W,M):B.push(W))}O=B.pop()}return M},a.prototype.collides=function(L){var O=this.data;if(!E(L,O))return!1;for(var M=[];O;){for(var z=0;z<O.children.length;z++){var B=O.children[z],q=O.leaf?this.toBBox(B):B;if(E(L,q)){if(O.leaf||S(L,q))return!0;M.push(B)}}O=M.pop()}return!1},a.prototype.load=function(L){if(!L||!L.length)return this;if(L.length<this._minEntries){for(var O=0;O<L.length;O++)this.insert(L[O]);return this}var M=this._build(L.slice(),0,L.length-1,0);if(this.data.children.length)if(this.data.height===M.height)this._splitRoot(this.data,M);else{if(this.data.height<M.height){var z=this.data;this.data=M,M=z}this._insert(M,this.data.height-M.height-1,!0)}else this.data=M;return this},a.prototype.insert=function(L){return L&&this._insert(L,this.data.height-1),this},a.prototype.clear=function(){return this.data=P([]),this},a.prototype.remove=function(L,O){if(!L)return this;for(var M,z,B,q=this.data,W=this.toBBox(L),G=[],ie=[];q||G.length;){if(q||(q=G.pop(),z=G[G.length-1],M=ie.pop(),B=!0),q.leaf){var Q=s(L,q.children,O);if(Q!==-1)return q.children.splice(Q,1),G.push(q),this._condense(G),this}B||q.leaf||!S(q,W)?z?(M++,q=z.children[M],B=!1):q=null:(G.push(q),ie.push(M),M=0,z=q,q=q.children[0])}return this},a.prototype.toBBox=function(L){return L},a.prototype.compareMinX=function(L,O){return L.minX-O.minX},a.prototype.compareMinY=function(L,O){return L.minY-O.minY},a.prototype.toJSON=function(){return this.data},a.prototype.fromJSON=function(L){return this.data=L,this},a.prototype._all=function(L,O){for(var M=[];L;)L.leaf?O.push.apply(O,L.children):M.push.apply(M,L.children),L=M.pop();return O},a.prototype._build=function(L,O,M,z){var B,q=M-O+1,W=this._maxEntries;if(q<=W)return o(B=P(L.slice(O,M+1)),this.toBBox),B;z||(z=Math.ceil(Math.log(q)/Math.log(W)),W=Math.ceil(q/Math.pow(W,z-1))),(B=P([])).leaf=!1,B.height=z;var G=Math.ceil(q/W),ie=G*Math.ceil(Math.sqrt(W));k(L,O,M,ie,this.compareMinX);for(var Q=O;Q<=M;Q+=ie){var H=Math.min(Q+ie-1,M);k(L,Q,H,G,this.compareMinY);for(var ne=Q;ne<=H;ne+=G){var oe=Math.min(ne+G-1,H);B.children.push(this._build(L,ne,oe,z-1))}}return o(B,this.toBBox),B},a.prototype._chooseSubtree=function(L,O,M,z){for(;z.push(O),!O.leaf&&z.length-1!==M;){for(var B=1/0,q=1/0,W=void 0,G=0;G<O.children.length;G++){var ie=O.children[G],Q=b(ie),H=(ne=L,oe=ie,(Math.max(oe.maxX,ne.maxX)-Math.min(oe.minX,ne.minX))*(Math.max(oe.maxY,ne.maxY)-Math.min(oe.minY,ne.minY))-Q);H<q?(q=H,B=Q<B?Q:B,W=ie):H===q&&Q<B&&(B=Q,W=ie)}O=W||O.children[0]}var ne,oe;return O},a.prototype._insert=function(L,O,M){var z=M?L:this.toBBox(L),B=[],q=this._chooseSubtree(z,this.data,O,B);for(q.children.push(L),h(q,z);O>=0&&B[O].children.length>this._maxEntries;)this._split(B,O),O--;this._adjustParentBBoxes(z,B,O)},a.prototype._split=function(L,O){var M=L[O],z=M.children.length,B=this._minEntries;this._chooseSplitAxis(M,B,z);var q=this._chooseSplitIndex(M,B,z),W=P(M.children.splice(q,M.children.length-q));W.height=M.height,W.leaf=M.leaf,o(M,this.toBBox),o(W,this.toBBox),O?L[O-1].children.push(W):this._splitRoot(M,W)},a.prototype._splitRoot=function(L,O){this.data=P([L,O]),this.data.height=L.height+1,this.data.leaf=!1,o(this.data,this.toBBox)},a.prototype._chooseSplitIndex=function(L,O,M){for(var z,B,q,W,G,ie,Q,H=1/0,ne=1/0,oe=O;oe<=M-O;oe++){var ce=u(L,0,oe,this.toBBox),fe=u(L,oe,M,this.toBBox),Me=(B=ce,q=fe,W=void 0,G=void 0,ie=void 0,Q=void 0,W=Math.max(B.minX,q.minX),G=Math.max(B.minY,q.minY),ie=Math.min(B.maxX,q.maxX),Q=Math.min(B.maxY,q.maxY),Math.max(0,ie-W)*Math.max(0,Q-G)),me=b(ce)+b(fe);Me<H?(H=Me,z=oe,ne=me<ne?me:ne):Me===H&&me<ne&&(ne=me,z=oe)}return z||M-O},a.prototype._chooseSplitAxis=function(L,O,M){var z=L.leaf?this.compareMinX:f,B=L.leaf?this.compareMinY:g;this._allDistMargin(L,O,M,z)<this._allDistMargin(L,O,M,B)&&L.children.sort(z)},a.prototype._allDistMargin=function(L,O,M,z){L.children.sort(z);for(var B=this.toBBox,q=u(L,0,O,B),W=u(L,M-O,M,B),G=v(q)+v(W),ie=O;ie<M-O;ie++){var Q=L.children[ie];h(q,L.leaf?B(Q):Q),G+=v(q)}for(var H=M-O-1;H>=O;H--){var ne=L.children[H];h(W,L.leaf?B(ne):ne),G+=v(W)}return G},a.prototype._adjustParentBBoxes=function(L,O,M){for(var z=M;z>=0;z--)h(O[z],L)},a.prototype._condense=function(L){for(var O=L.length-1,M=void 0;O>=0;O--)L[O].children.length===0?O>0?(M=L[O-1].children).splice(M.indexOf(L[O]),1):this.clear():o(L[O],this.toBBox)},a})})(xw)),xw.exports}class Oxe{constructor(e=[],r=Lxe){if(this.data=e,this.length=this.data.length,this.compare=r,this.length>0)for(let n=(this.length>>1)-1;n>=0;n--)this._down(n)}push(e){this.data.push(e),this.length++,this._up(this.length-1)}pop(){if(this.length===0)return;const e=this.data[0],r=this.data.pop();return this.length--,this.length>0&&(this.data[0]=r,this._down(0)),e}peek(){return this.data[0]}_up(e){const{data:r,compare:n}=this,i=r[e];for(;e>0;){const a=e-1>>1,s=r[a];if(n(i,s)>=0)break;r[e]=s,e=a}r[e]=i}_down(e){const{data:r,compare:n}=this,i=this.length>>1,a=r[e];for(;e<i;){let s=(e<<1)+1,o=r[s];const u=s+1;if(u<this.length&&n(r[u],o)<0&&(s=u,o=r[u]),n(o,a)>=0)break;r[e]=o,e=s}r[e]=a}}function Lxe(t,e){return t<e?-1:t>e?1:0}const Nxe=Object.freeze(Object.defineProperty({__proto__:null,default:Oxe},Symbol.toStringTag,{value:"Module"})),Dxe=eW(Nxe);var E_={exports:{}},eA,Kz;function Fxe(){return Kz||(Kz=1,eA=function(e,r,n,i){var a=e[0],s=e[1],o=!1;n===void 0&&(n=0),i===void 0&&(i=r.length);for(var u=(i-n)/2,h=0,f=u-1;h<u;f=h++){var g=r[n+h*2+0],b=r[n+h*2+1],v=r[n+f*2+0],S=r[n+f*2+1],E=b>s!=S>s&&a<(v-g)*(s-b)/(S-b)+g;E&&(o=!o)}return o}),eA}var tA,Jz;function Bxe(){return Jz||(Jz=1,tA=function(e,r,n,i){var a=e[0],s=e[1],o=!1;n===void 0&&(n=0),i===void 0&&(i=r.length);for(var u=i-n,h=0,f=u-1;h<u;f=h++){var g=r[h+n][0],b=r[h+n][1],v=r[f+n][0],S=r[f+n][1],E=b>s!=S>s&&a<(v-g)*(s-b)/(S-b)+g;E&&(o=!o)}return o}),tA}var Qz;function zxe(){if(Qz)return E_.exports;Qz=1;var t=Fxe(),e=Bxe();return E_.exports=function(n,i,a,s){return i.length>0&&Array.isArray(i[0])?e(n,i,a,s):t(n,i,a,s)},E_.exports.nested=e,E_.exports.flat=t,E_.exports}var t1={exports:{}},jxe=t1.exports,e9;function Uxe(){return e9||(e9=1,(function(t,e){(function(r,n){n(e)})(jxe,function(r){const i=33306690738754706e-32;function a(E,P,k,L,O){let M,z,B,q,W=P[0],G=L[0],ie=0,Q=0;G>W==G>-W?(M=W,W=P[++ie]):(M=G,G=L[++Q]);let H=0;if(ie<E&&Q<k)for(G>W==G>-W?(B=M-((z=W+M)-W),W=P[++ie]):(B=M-((z=G+M)-G),G=L[++Q]),M=z,B!==0&&(O[H++]=B);ie<E&&Q<k;)G>W==G>-W?(B=M-((z=M+W)-(q=z-M))+(W-q),W=P[++ie]):(B=M-((z=M+G)-(q=z-M))+(G-q),G=L[++Q]),M=z,B!==0&&(O[H++]=B);for(;ie<E;)B=M-((z=M+W)-(q=z-M))+(W-q),W=P[++ie],M=z,B!==0&&(O[H++]=B);for(;Q<k;)B=M-((z=M+G)-(q=z-M))+(G-q),G=L[++Q],M=z,B!==0&&(O[H++]=B);return M===0&&H!==0||(O[H++]=M),H}function s(E){return new Float64Array(E)}const o=33306690738754716e-32,u=22204460492503146e-32,h=11093356479670487e-47,f=s(4),g=s(8),b=s(12),v=s(16),S=s(4);r.orient2d=function(E,P,k,L,O,M){const z=(P-M)*(k-O),B=(E-O)*(L-M),q=z-B;if(z===0||B===0||z>0!=B>0)return q;const W=Math.abs(z+B);return Math.abs(q)>=o*W?q:-(function(G,ie,Q,H,ne,oe,ce){let fe,Me,me,we,Te,ke,he,Ee,xe,Ne,Oe,$e,De,it,Ye,rt,Ie,Mt;const at=G-ne,je=Q-ne,Xt=ie-oe,Yt=H-oe;Te=(Ye=(Ee=at-(he=(ke=134217729*at)-(ke-at)))*(Ne=Yt-(xe=(ke=134217729*Yt)-(ke-Yt)))-((it=at*Yt)-he*xe-Ee*xe-he*Ne))-(Oe=Ye-(Ie=(Ee=Xt-(he=(ke=134217729*Xt)-(ke-Xt)))*(Ne=je-(xe=(ke=134217729*je)-(ke-je)))-((rt=Xt*je)-he*xe-Ee*xe-he*Ne))),f[0]=Ye-(Oe+Te)+(Te-Ie),Te=(De=it-(($e=it+Oe)-(Te=$e-it))+(Oe-Te))-(Oe=De-rt),f[1]=De-(Oe+Te)+(Te-rt),Te=(Mt=$e+Oe)-$e,f[2]=$e-(Mt-Te)+(Oe-Te),f[3]=Mt;let pr=(function(Er,wr){let er=wr[0];for(let lr=1;lr<Er;lr++)er+=wr[lr];return er})(4,f),vt=u*ce;if(pr>=vt||-pr>=vt||(fe=G-(at+(Te=G-at))+(Te-ne),me=Q-(je+(Te=Q-je))+(Te-ne),Me=ie-(Xt+(Te=ie-Xt))+(Te-oe),we=H-(Yt+(Te=H-Yt))+(Te-oe),fe===0&&Me===0&&me===0&&we===0)||(vt=h*ce+i*Math.abs(pr),(pr+=at*we+Yt*fe-(Xt*me+je*Me))>=vt||-pr>=vt))return pr;Te=(Ye=(Ee=fe-(he=(ke=134217729*fe)-(ke-fe)))*(Ne=Yt-(xe=(ke=134217729*Yt)-(ke-Yt)))-((it=fe*Yt)-he*xe-Ee*xe-he*Ne))-(Oe=Ye-(Ie=(Ee=Me-(he=(ke=134217729*Me)-(ke-Me)))*(Ne=je-(xe=(ke=134217729*je)-(ke-je)))-((rt=Me*je)-he*xe-Ee*xe-he*Ne))),S[0]=Ye-(Oe+Te)+(Te-Ie),Te=(De=it-(($e=it+Oe)-(Te=$e-it))+(Oe-Te))-(Oe=De-rt),S[1]=De-(Oe+Te)+(Te-rt),Te=(Mt=$e+Oe)-$e,S[2]=$e-(Mt-Te)+(Oe-Te),S[3]=Mt;const yr=a(4,f,4,S,g);Te=(Ye=(Ee=at-(he=(ke=134217729*at)-(ke-at)))*(Ne=we-(xe=(ke=134217729*we)-(ke-we)))-((it=at*we)-he*xe-Ee*xe-he*Ne))-(Oe=Ye-(Ie=(Ee=Xt-(he=(ke=134217729*Xt)-(ke-Xt)))*(Ne=me-(xe=(ke=134217729*me)-(ke-me)))-((rt=Xt*me)-he*xe-Ee*xe-he*Ne))),S[0]=Ye-(Oe+Te)+(Te-Ie),Te=(De=it-(($e=it+Oe)-(Te=$e-it))+(Oe-Te))-(Oe=De-rt),S[1]=De-(Oe+Te)+(Te-rt),Te=(Mt=$e+Oe)-$e,S[2]=$e-(Mt-Te)+(Oe-Te),S[3]=Mt;const _r=a(yr,g,4,S,b);Te=(Ye=(Ee=fe-(he=(ke=134217729*fe)-(ke-fe)))*(Ne=we-(xe=(ke=134217729*we)-(ke-we)))-((it=fe*we)-he*xe-Ee*xe-he*Ne))-(Oe=Ye-(Ie=(Ee=Me-(he=(ke=134217729*Me)-(ke-Me)))*(Ne=me-(xe=(ke=134217729*me)-(ke-me)))-((rt=Me*me)-he*xe-Ee*xe-he*Ne))),S[0]=Ye-(Oe+Te)+(Te-Ie),Te=(De=it-(($e=it+Oe)-(Te=$e-it))+(Oe-Te))-(Oe=De-rt),S[1]=De-(Oe+Te)+(Te-rt),Te=(Mt=$e+Oe)-$e,S[2]=$e-(Mt-Te)+(Oe-Te),S[3]=Mt;const cr=a(_r,b,4,S,v);return v[cr-1]})(E,P,k,L,O,M,W)},r.orient2dfast=function(E,P,k,L,O,M){return(P-M)*(k-O)-(E-O)*(L-M)},Object.defineProperty(r,"__esModule",{value:!0})})})(t1,t1.exports)),t1.exports}var t9;function Vxe(){if(t9)return I2.exports;t9=1;var t=Rxe(),e=Dxe,r=zxe(),n=Uxe().orient2d;e.default&&(e=e.default),I2.exports=i,I2.exports.default=i;function i(M,z,B){z=Math.max(0,z===void 0?2:z),B=B||0;var q=v(M),W=new t(16);W.toBBox=function(he){return{minX:he[0],minY:he[1],maxX:he[0],maxY:he[1]}},W.compareMinX=function(he,Ee){return he[0]-Ee[0]},W.compareMinY=function(he,Ee){return he[1]-Ee[1]},W.load(M);for(var G=[],ie=0,Q;ie<q.length;ie++){var H=q[ie];W.remove(H),Q=S(H,Q),G.push(Q)}var ne=new t(16);for(ie=0;ie<G.length;ie++)ne.insert(b(G[ie]));for(var oe=z*z,ce=B*B;G.length;){var fe=G.shift(),Me=fe.p,me=fe.next.p,we=E(Me,me);if(!(we<ce)){var Te=we/oe;H=a(W,fe.prev.p,Me,me,fe.next.next.p,Te,ne),H&&Math.min(E(H,Me),E(H,me))<=Te&&(G.push(fe),G.push(S(H,fe)),W.remove(H),ne.remove(fe),ne.insert(b(fe)),ne.insert(b(fe.next)))}}fe=Q;var ke=[];do ke.push(fe.p),fe=fe.next;while(fe!==Q);return ke.push(fe.p),ke}function a(M,z,B,q,W,G,ie){for(var Q=new e([],s),H=M.data;H;){for(var ne=0;ne<H.children.length;ne++){var oe=H.children[ne],ce=H.leaf?P(oe,B,q):o(B,q,oe);ce>G||Q.push({node:oe,dist:ce})}for(;Q.length&&!Q.peek().node.children;){var fe=Q.pop(),Me=fe.node,me=P(Me,z,B),we=P(Me,q,W);if(fe.dist<me&&fe.dist<we&&h(B,Me,ie)&&h(q,Me,ie))return Me}H=Q.pop(),H&&(H=H.node)}return null}function s(M,z){return M.dist-z.dist}function o(M,z,B){if(u(M,B)||u(z,B))return 0;var q=k(M[0],M[1],z[0],z[1],B.minX,B.minY,B.maxX,B.minY);if(q===0)return 0;var W=k(M[0],M[1],z[0],z[1],B.minX,B.minY,B.minX,B.maxY);if(W===0)return 0;var G=k(M[0],M[1],z[0],z[1],B.maxX,B.minY,B.maxX,B.maxY);if(G===0)return 0;var ie=k(M[0],M[1],z[0],z[1],B.minX,B.maxY,B.maxX,B.maxY);return ie===0?0:Math.min(q,W,G,ie)}function u(M,z){return M[0]>=z.minX&&M[0]<=z.maxX&&M[1]>=z.minY&&M[1]<=z.maxY}function h(M,z,B){for(var q=Math.min(M[0],z[0]),W=Math.min(M[1],z[1]),G=Math.max(M[0],z[0]),ie=Math.max(M[1],z[1]),Q=B.search({minX:q,minY:W,maxX:G,maxY:ie}),H=0;H<Q.length;H++)if(g(Q[H].p,Q[H].next.p,M,z))return!1;return!0}function f(M,z,B){return n(M[0],M[1],z[0],z[1],B[0],B[1])}function g(M,z,B,q){return M!==q&&z!==B&&f(M,z,B)>0!=f(M,z,q)>0&&f(B,q,M)>0!=f(B,q,z)>0}function b(M){var z=M.p,B=M.next.p;return M.minX=Math.min(z[0],B[0]),M.minY=Math.min(z[1],B[1]),M.maxX=Math.max(z[0],B[0]),M.maxY=Math.max(z[1],B[1]),M}function v(M){for(var z=M[0],B=M[0],q=M[0],W=M[0],G=0;G<M.length;G++){var ie=M[G];ie[0]<z[0]&&(z=ie),ie[0]>q[0]&&(q=ie),ie[1]<B[1]&&(B=ie),ie[1]>W[1]&&(W=ie)}var Q=[z,B,q,W],H=Q.slice();for(G=0;G<M.length;G++)r(M[G],Q)||H.push(M[G]);return O(H)}function S(M,z){var B={p:M,prev:null,next:null,minX:0,minY:0,maxX:0,maxY:0};return z?(B.next=z.next,B.prev=z,z.next.prev=B,z.next=B):(B.prev=B,B.next=B),B}function E(M,z){var B=M[0]-z[0],q=M[1]-z[1];return B*B+q*q}function P(M,z,B){var q=z[0],W=z[1],G=B[0]-q,ie=B[1]-W;if(G!==0||ie!==0){var Q=((M[0]-q)*G+(M[1]-W)*ie)/(G*G+ie*ie);Q>1?(q=B[0],W=B[1]):Q>0&&(q+=G*Q,W+=ie*Q)}return G=M[0]-q,ie=M[1]-W,G*G+ie*ie}function k(M,z,B,q,W,G,ie,Q){var H=B-M,ne=q-z,oe=ie-W,ce=Q-G,fe=M-W,Me=z-G,me=H*H+ne*ne,we=H*oe+ne*ce,Te=oe*oe+ce*ce,ke=H*fe+ne*Me,he=oe*fe+ce*Me,Ee=me*Te-we*we,xe,Ne,Oe,$e,De=Ee,it=Ee;Ee===0?(Ne=0,De=1,$e=he,it=Te):(Ne=we*he-Te*ke,$e=me*he-we*ke,Ne<0?(Ne=0,$e=he,it=Te):Ne>De&&(Ne=De,$e=he+we,it=Te)),$e<0?($e=0,-ke<0?Ne=0:-ke>me?Ne=De:(Ne=-ke,De=me)):$e>it&&($e=it,-ke+we<0?Ne=0:-ke+we>me?Ne=De:(Ne=-ke+we,De=me)),xe=Ne===0?0:Ne/De,Oe=$e===0?0:$e/it;var Ye=(1-xe)*M+xe*B,rt=(1-xe)*z+xe*q,Ie=(1-Oe)*W+Oe*ie,Mt=(1-Oe)*G+Oe*Q,at=Ie-Ye,je=Mt-rt;return at*at+je*je}function L(M,z){return M[0]===z[0]?M[1]-z[1]:M[0]-z[0]}function O(M){M.sort(L);for(var z=[],B=0;B<M.length;B++){for(;z.length>=2&&f(z[z.length-2],z[z.length-1],M[B])<=0;)z.pop();z.push(M[B])}for(var q=[],W=M.length-1;W>=0;W--){for(;q.length>=2&&f(q[q.length-2],q[q.length-1],M[W])<=0;)q.pop();q.push(M[W])}return q.pop(),z.pop(),z.concat(q)}return I2.exports}var $xe=Vxe();const qxe=od($xe);function Hxe(t,e={}){e.concavity=e.concavity||1/0;const r=[];if(F0(t,i=>{r.push([i[0],i[1]])}),!r.length)return null;const n=qxe(r,e.concavity);return n.length>3?gT([n]):null}function JO(t,e={}){switch(yZ(t)){case"Point":return Rh(tg(t),e.properties);case"Polygon":var r=[];F0(t,function(M){r.push(M)});var n=Yz(t,{properties:e.properties}),i=n.geometry.coordinates,a=0,s=0,o=0,u,h,f,g,b,v,S,E,P=r.map(function(M){return[M[0]-i[0],M[1]-i[1]]});for(u=0;u<r.length-1;u++)h=P[u],g=h[0],v=h[1],f=P[u+1],b=f[0],S=f[1],E=g*S-b*v,o+=E,a+=(g+b)*E,s+=(v+S)*E;if(o===0)return n;var k=o*.5,L=1/(6*k);return Rh([i[0]+L*a,i[1]+L*s],e.properties);default:var O=Hxe(t);return O?JO(O,{properties:e.properties}):Yz(t,{properties:e.properties})}}function NZ(t,e,r={}){const n=r.steps||64,i=r.properties?r.properties:!Array.isArray(t)&&t.type==="Feature"&&t.properties?t.properties:{},a=[];for(let s=0;s<n;s++)a.push(h0(t,e,s*-360/n,r).geometry.coordinates);return a.push(a[0]),gT([a],i)}function Wxe(t){return t}function Gxe(t){if(t==null)return Wxe;var e,r,n=t.scale[0],i=t.scale[1],a=t.translate[0],s=t.translate[1];return function(o,u){u||(e=r=0);var h=2,f=o.length,g=new Array(f);for(g[0]=(e+=o[0])*n+a,g[1]=(r+=o[1])*i+s;h<f;)g[h]=o[h],++h;return g}}function Xxe(t,e){for(var r,n=t.length,i=n-e;i<--n;)r=t[i],t[i++]=t[n],t[n]=r}function Yxe(t,e){return typeof e=="string"&&(e=t.objects[e]),e.type==="GeometryCollection"?{type:"FeatureCollection",features:e.geometries.map(function(r){return r9(t,r)})}:r9(t,e)}function r9(t,e){var r=e.id,n=e.bbox,i=e.properties==null?{}:e.properties,a=Zxe(t,e);return r==null&&n==null?{type:"Feature",properties:i,geometry:a}:n==null?{type:"Feature",id:r,properties:i,geometry:a}:{type:"Feature",id:r,bbox:n,properties:i,geometry:a}}function Zxe(t,e){var r=Gxe(t.transform),n=t.arcs;function i(f,g){g.length&&g.pop();for(var b=n[f<0?~f:f],v=0,S=b.length;v<S;++v)g.push(r(b[v],v));f<0&&Xxe(g,S)}function a(f){return r(f)}function s(f){for(var g=[],b=0,v=f.length;b<v;++b)i(f[b],g);return g.length<2&&g.push(g[0]),g}function o(f){for(var g=s(f);g.length<4;)g.push(g[0]);return g}function u(f){return f.map(o)}function h(f){var g=f.type,b;switch(g){case"GeometryCollection":return{type:g,geometries:f.geometries.map(h)};case"Point":b=a(f.coordinates);break;case"MultiPoint":b=f.coordinates.map(a);break;case"LineString":b=s(f.arcs);break;case"MultiLineString":b=f.arcs.map(s);break;case"Polygon":b=u(f.arcs);break;case"MultiPolygon":b=f.arcs.map(u);break;default:return null}return{type:g,coordinates:b}}return h(e)}function hb(t,e={}){return Abe(t,(r,n)=>{const i=n.geometry.coordinates;return r+mT(i[0],i[1],e)},0)}function Kxe(t,e,r,n,i={}){const a=i.steps||64,s=n9(r),o=n9(n),u=!Array.isArray(t)&&t.type==="Feature"?t.properties:{};if(s===o)return gu(NZ(t,e,i).geometry.coordinates[0],u);const h=s,f=s<o?o:o+360;let g=h;const b=[];let v=0;const S=(f-h)/a;for(;g<=f;)b.push(h0(t,e,g,i).geometry.coordinates),v++,g=h+v*S;return gu(b,u)}function n9(t){let e=t%360;return e<0&&(e+=360),e}function Jxe(t,e,r,n){if(n=n||{},!YO(n))throw new Error("options is invalid");var i,a=[];if(t.type==="Feature")i=t.geometry.coordinates;else if(t.type==="LineString")i=t.coordinates;else throw new Error("input must be a LineString Feature or Geometry");for(var s=i.length,o=0,u,h,f,g=0;g<i.length&&!(e>=o&&g===i.length-1);g++){if(o>e&&a.length===0){if(u=e-o,!u)return a.push(i[g]),gu(a);h=lb(i[g],i[g-1])-180,f=h0(i[g],u,h,n),a.push(f.geometry.coordinates)}if(o>=r)return u=r-o,u?(h=lb(i[g],i[g-1])-180,f=h0(i[g],u,h,n),a.push(f.geometry.coordinates),gu(a)):(a.push(i[g]),gu(a));if(o>=e&&a.push(i[g]),g===i.length-1)return gu(a);o+=mT(i[g],i[g+1],n)}if(o<e&&i.length===s)throw new Error("Start position is beyond line");var b=i[i.length-1];return gu([b,b])}function Qxe(t,e,r){if(r=r||{},!YO(r))throw new Error("options is invalid");var n=r.units,i=r.reverse;if(!t)throw new Error("geojson is required");if(e<=0)throw new Error("segmentLength must be greater than 0");var a=[];return ZO(t,function(s){i&&(s.geometry.coordinates=s.geometry.coordinates.reverse()),e2e(s,e,n,function(o){a.push(o)})}),Xd(a)}function e2e(t,e,r,n){var i=hb(t,{units:r});if(i<=e)return n(t);var a=i/e;Number.isInteger(a)||(a=Math.floor(a)+1);for(var s=0;s<a;s++){var o=Jxe(t,e*s,e*(s+1),{units:r});n(o,s)}}function vS(t){var e=t[0],r=t[1];return[r[0]-e[0],r[1]-e[1]]}function Tk(t,e){return t[0]*e[1]-e[0]*t[1]}function t2e(t,e){return[t[0]+e[0],t[1]+e[1]]}function r2e(t,e){return[t[0]-e[0],t[1]-e[1]]}function n2e(t,e){return[t*e[0],t*e[1]]}function i2e(t,e){var r=t[0],n=vS(t),i=e[0],a=vS(e),s=Tk(n,a),o=r2e(i,r),u=Tk(o,a),h=u/s,f=t2e(r,n2e(h,n));return f}function a2e(t,e){var r=vS(t),n=vS(e);return Tk(r,n)===0}function o2e(t,e){return a2e(t,e)?!1:i2e(t,e)}function s2e(t,e,r){if(r=r||{},!YO(r))throw new Error("options is invalid");var n=r.units;if(!t)throw new Error("geojson is required");if(e==null||isNaN(e))throw new Error("distance is required");var i=yZ(t),a=t.properties;switch(i){case"LineString":return i9(t,e,n);case"MultiLineString":var s=[];return ZO(t,function(o){s.push(i9(o,e,n).geometry.coordinates)}),xbe(s,a);default:throw new Error("geometry "+i+" is not supported")}}function i9(t,e,r){var n=[],i=wbe(e,r),a=mZ(t),s=[];return a.forEach(function(o,u){if(u!==a.length-1){var h=l2e(o,a[u+1],i);if(n.push(h),u>0){var f=n[u-1],g=o2e(h,f);g!==!1&&(f[1]=g,h[0]=g),s.push(f[0]),u===a.length-2&&(s.push(h[0]),s.push(h[1]))}a.length===2&&(s.push(h[0]),s.push(h[1]))}}),gu(s,t.properties)}function l2e(t,e,r){var n=Math.sqrt((t[0]-e[0])*(t[0]-e[0])+(t[1]-e[1])*(t[1]-e[1])),i=t[0]+r*(e[1]-t[1])/n,a=e[0]+r*(e[1]-t[1])/n,s=t[1]+r*(t[0]-e[0])/n,o=e[1]+r*(t[0]-e[0])/n;return[[i,s],[a,o]]}function u2e(t){const r=window.getComputedStyle(t,null).getPropertyValue("transform");let n=0;if(r!=="none"){const i=r.split("(")[1].split(")")[0].split(","),a=parseFloat(i[0]),s=parseFloat(i[1]);n=Math.round(Math.atan2(s,a)*(180/Math.PI))}return n<0?n+360:n}function P2(t,e,r){const n=getComputedStyle(t),i=[e[0]-r[0],e[1]-r[1]],a=new DOMMatrixReadOnly(n.transform);return[i[0]*a.a+i[1]*a.c+a.e+r[0],i[0]*a.b+i[1]*a.d+a.f+r[1]]}const a9=10;function k2(t,e){const r=e.unproject(t),n=e.unproject([t[0]+a9,t[1]]),i=r.distanceTo(n);return a9/i}function Ck(t){const e=XE({mapId:t.mapId,watch:{layers:!1,viewport:!0}}),r=ee.useRef(null),n=ee.useRef(null),i=ee.useRef(null),a=ee.useRef(document.querySelector(".mapContainer")),s=ha({mapId:t.mapId});ee.useEffect(()=>{if(!e?.viewport?.zoom||!s.map)return;const h=Math.round(s.map.map._container.clientWidth/2),f=Math.round(s.map.map._container.clientHeight/2);if(!t.options.scale){const g=1/k2([h,f],s.map.map);t.setOptions(b=>({...b,scale:[g,g]}))}if(!t.options.center){const g=s.map.map.unproject([h,f]);t.setOptions(b=>({...b,center:[g.lng,g.lat]}))}},[s.map,e.viewport?.zoom]),ee.useEffect(()=>{if(!s.map)return;s.map.map.setPitch(0);const h=s.map.map.getMaxPitch();return s.map.map.setMaxPitch(0),()=>{s.map?.map.setMaxPitch(h)}},[s.map]);const o=ee.useMemo(()=>t.options.orientation==="portrait"?[t.options.width/2,t.options.height/2]:[t.options.height/2,t.options.width/2],[t.options.orientation,t.options.width,t.options.height]),u=ee.useMemo(()=>{if(!s.map||!t.options.scale)return"none";const h=s.map.map.project(t.options.center),f=h.x,g=h.y,b=t.options.scale[0]*k2([f,g],s.map.map),v=e?.viewport?.bearing?e.viewport?.bearing:0,S=`translate(${Math.floor(h.x-o[0])}px,${Math.floor(h.y-o[1])}px) rotate(${t.options.rotate-v}deg) scale(${b},${b})`;return r.current&&(r.current.style.transform=S),S},[s.map,e.viewport,t.options.scale,t.options.rotate,t.options.center,o]);return ee.useEffect(()=>{i.current?.updateTarget()},[u]),ee.useEffect(()=>{if(!s.map||!t.options.center||!t.options.fixedScale||typeof t.options.fixedScale<"u"&&n.current===t.options.fixedScale)return;n.current=t.options.fixedScale;const h=Rh(t.options.center),f=t.options.fixedScale*(t.options.width/1e3),v=h0(h,f,90,{units:"meters"}),S=s.map.map.project(h.geometry.coordinates),E=s.map.map.project(v.geometry.coordinates),P=Math.round(E.x-S.x)/t.options.width*(1/k2([S.x,S.y],s.map.map));t.setOptions(k=>({...k,scale:[P,P]}))},[s.map,t.options.width,t.options.center,t.options.fixedScale]),ee.useEffect(()=>{if(r.current&&s.map){let h=t.options.width,f=t.options.height;t.options.orientation==="portrait"?(r.current.style.width=t.options.width+"px",r.current.style.height=t.options.height+"px"):(r.current.style.width=t.options.height+"px",r.current.style.height=t.options.width+"px",h=t.options.height,f=t.options.width),i.current?.updateTarget();const g=s.map.map.unproject(P2(r.current,[0,0],o)),b=s.map.map.unproject(P2(r.current,[h,0],o)),v=s.map.map.unproject(P2(r.current,[0,f],o)),S=s.map.map.unproject(P2(r.current,[h,f],o)),E={type:"Feature",bbox:[g.lng,g.lat,S.lng,S.lat],geometry:{type:"Polygon",coordinates:[[[g.lng,g.lat],[b.lng,b.lat],[S.lng,S.lat],[v.lng,v.lat],[g.lng,g.lat]]]},properties:{bearing:u2e(r.current)}};t.geojsonRef.current=E}},[s,u,t.options.orientation,t.geojsonRef,e,r.current,o]),a.current?q_.createPortal(K.jsxs(K.Fragment,{children:[K.jsx("div",{className:"target",ref:r,style:{transform:u,transformOrigin:"center center"}}),K.jsx(bbe,{ref:i,target:r,container:null,origin:!0,keepRatio:!0,draggable:!0,onDrag:h=>{if(s.map){let f=h.transform.split("translate(");f=f[1].split("px)")[0].split("px, ");const g=s.map?.map.unproject([parseInt(f[0])+o[0],parseInt(f[1])+o[1]]);t.setOptions(b=>({...b,center:[g.lng,g.lat]}))}},scalable:!t.options.fixedScale,onScale:h=>{if(s.map){let f=h.drag.transform.split("scale(");f=f[1].split(")")[0].split(", ");const g=s.map.map.project(t.options.center),b=g.x,v=g.y,S=parseFloat(f[0])*(1/k2([b,v],s.map.map));t.setOptions(E=>({...E,scale:[S,S]}))}},rotatable:!0,onRotate:h=>{if(s.map&&e.viewport){const g=h.drag.transform.split("rotate(")[1].split("deg)")[0],b=e?.viewport?.bearing?e.viewport.bearing:0;t.setOptions(v=>({...v,rotate:parseFloat(g)+b}))}}})]}),a.current):K.jsx(K.Fragment,{})}try{Ck.displayName="PdfPreview",Ck.__docgenInfo={description:"PdfPreview component renders a transformable (drag, scale, rotate) preview of the desired export or print content",displayName:"PdfPreview",props:{mapId:{defaultValue:null,description:"Id of the target MapLibre instance in mapContext",name:"mapId",required:!1,type:{name:"string | undefined"}},geojsonRef:{defaultValue:null,description:"Polygon GeoJson Feature representing the printing area",name:"geojsonRef",required:!0,type:{name:"MutableRefObject<Feature<Geometry, GeoJsonProperties> | undefined>"}},options:{defaultValue:null,description:"a state variable containing the PDF previews current state",name:"options",required:!0,type:{name:"PdfPreviewOptions"}},setOptions:{defaultValue:null,description:"setter function to update the current PDF preview state",name:"setOptions",required:!0,type:{name:"(arg1: (val: PdfPreviewOptions) => PdfPreviewOptions) => void"}}}}}catch{}const c2e=[{value:0,label:"free scale"},{value:250,label:"1/250"},{value:500,label:"1/500"},{value:750,label:"1/750"},{value:1e3,label:"1/1000"},{value:1500,label:"1/1500"},{value:2e3,label:"1/2000"},{value:1e4,label:"1/10000"},{value:1e5,label:"1/100000"}],h2e=[{value:"72dpi",label:"Draft (72dpi)"},{value:"150dpi",label:"Medium (150dpi)"},{value:"300dpi",label:"High (300dpi)"}];function Ak(t){const[e,r]=ee.useState(!1),n=ee.useContext(PX),i=ha({mapId:t.mapId}),a=IX({mapId:t.mapId}),s=ee.useCallback(()=>{if(i.map&&a.createExport&&n.template&&n.format&&n.options?.orientation&&n.geojsonRef?.current?.bbox&&n.geojsonRef?.current){r(!0);const h=ih(n.geojsonRef.current);a.createExport({width:n.template.width,height:n.template.height,bbox:h,bboxUnrotated:n.geojsonRef.current.bbox,bearing:n.geojsonRef.current?.properties?.bearing||0,format:n.format.toLowerCase(),orientation:n.options.orientation}).then(f=>f.createPdf()).then(f=>(typeof t.onCreatePdf=="function"&&(f.formData=new FormData(document.getElementById("createPdfFormID")),t.onCreatePdf(f)),r(!1),f.downloadPdf())).catch(f=>{console.log(f),r(!1)})}},[i.map,n]),o=Gb("(max-width: 950px)"),u=ee.useMemo(()=>({margin:o?"1px 0 8px 0 ":"5px 0 15px 0 ",...t?.formControlStyles?{...t.formControlStyles}:{}}),[o,t.formControlStyles]);return K.jsx(K.Fragment,{children:K.jsxs("form",{id:"createPdfFormID",children:[K.jsxs(Zc,{fullWidth:!0,sx:u,children:[K.jsx(Ji,{variant:"contained",className:"createPdfButton",onClick:s,disabled:e,sx:{marginBottom:"16px"},children:"create PDF"}),e&&K.jsx(ZE,{size:24,sx:{color:"primary.main",position:"absolute",top:"25%",left:"50%",marginTop:"-12px",marginLeft:"-12px"}})]}),K.jsxs(Zc,{fullWidth:!0,sx:u,children:[K.jsx($p,{sx:{marginTop:"3px"},id:"format-select-label",children:"Format"}),K.jsx(qp,{labelId:"format-select-label",id:"format-select",label:"Format",value:n.format,onChange:h=>{n.setFormat?.(h.target.value)},children:Object.keys(Sv).map(h=>K.jsx(im,{value:h,children:h},h))})]}),K.jsxs(Zc,{fullWidth:!0,sx:u,children:[K.jsx(EG,{id:"orientation-radio-buttons-group-label",children:"Orientation"}),K.jsxs(Tpe,{row:!0,"aria-labelledby":"orientation-radio-buttons-group-label",name:"orientation-radio-buttons-group",value:n.options?.orientation,onChange:h=>{n.setOptions&&n.setOptions(f=>({...f,orientation:h.target.value}))},children:[K.jsx(LP,{value:"portrait",control:K.jsx(d8,{}),label:"Portrait"}),K.jsx(LP,{value:"landscape",control:K.jsx(d8,{}),label:"Landscape"})]})]}),K.jsxs(Zc,{fullWidth:!0,sx:u,children:[K.jsx($p,{id:"quality-select-label",children:"Quality"}),K.jsx(qp,{labelId:"quality-select-label",id:"quality-select",label:"Quality",value:n.quality,onChange:h=>{n.setQuality?.(h.target.value)},children:h2e.map(h=>K.jsx(im,{value:h.value,children:h.label},h.value))})]}),K.jsxs(Zc,{fullWidth:!0,sx:u,children:[K.jsx($p,{id:"scale-select-label",children:"Scale"}),K.jsx(qp,{labelId:"scale-select-label",id:"scale-select",label:"Scale",value:n?.options?.fixedScale,onChange:h=>{n.setOptions?.(f=>({...f,fixedScale:h.target.value}))},children:c2e.map((h,f)=>K.jsx(im,{value:h.value,children:h.label},f))})]}),t?.additionalFields,n.options&&n.setOptions&&K.jsx(Ck,{options:n.options,setOptions:n.setOptions,geojsonRef:n.geojsonRef})]})})}try{Ak.displayName="PdfForm",Ak.__docgenInfo={description:"",displayName:"PdfForm",props:{mapId:{defaultValue:null,description:"Id of the target MapLibre instance in mapContext",name:"mapId",required:!1,type:{name:"string | undefined"}},onCreatePdf:{defaultValue:null,description:`Function that will be called before the PDF is created.
Allowing to access and manipulate the jspdf instance before the PDF is created.`,name:"onCreatePdf",required:!1,type:{name:"((options: createPdfResolverParams) => createPdfResolverParams) | undefined"}},formControlStyles:{defaultValue:null,description:"sx props that will be applied to the form control components",name:"formControlStyles",required:!1,type:{name:"SxProps | undefined"}},additionalFields:{defaultValue:null,description:`Define additional form fields that will be added to the bottom of the create-PDF form.
Values of form elements added this way are accessible inside the function passed to the onCreatePdf property using options.formData.get('{form_el_name}').
Make sure all form elements added this way have a name property defined to be able to access the value when rendering the PDF.`,name:"additionalFields",required:!1,type:{name:"ReactNode"}}}}}catch{}const o9=t=>K.jsx(K.Fragment,{children:K.jsx(XP,{children:K.jsx(Ak,{...t})})});try{o9.displayName="MlCreatePdfForm",o9.__docgenInfo={description:"Create PDF Form Component",displayName:"MlCreatePdfForm",props:{mapId:{defaultValue:null,description:"Id of the target MapLibre instance in mapContext",name:"mapId",required:!1,type:{name:"string | undefined"}},onCreatePdf:{defaultValue:null,description:`Function that will be called before the PDF is created.
Allowing to access and manipulate the jspdf instance before the PDF is created.`,name:"onCreatePdf",required:!1,type:{name:"((options: createPdfResolverParams) => createPdfResolverParams) | undefined"}},formControlStyles:{defaultValue:null,description:"sx props that will be applied to the form control components",name:"formControlStyles",required:!1,type:{name:"SxProps | undefined"}},additionalFields:{defaultValue:null,description:`Define additional form fields that will be added to the bottom of the create-PDF form.
Values of form elements added this way are accessible inside the function passed to the onCreatePdf property using options.formData.get('{form_el_name}').
Make sure all form elements added this way have a name property defined to be able to access the value when rendering the PDF.`,name:"additionalFields",required:!1,type:{name:"ReactNode"}}}}}catch{}var ww={exports:{}},f2e=ww.exports,s9;function d2e(){return s9||(s9=1,(function(t,e){(function(r,n){t.exports=n()})(f2e,(function(){var r=function(J,pe){var Xe={drag:[],click:[],mousemove:[],mousedown:[],mouseup:[],mouseout:[],keydown:[],keyup:[],touchstart:[],touchmove:[],touchend:[],tap:[]},Tt={on:function(kt,Gt,$r){if(Xe[kt]===void 0)throw new Error("Invalid event type: "+kt);Xe[kt].push({selector:Gt,fn:$r})},render:function(kt){pe.store.featureChanged(kt)}},Nt=function(kt,Gt){for(var $r=Xe[kt],Yr=$r.length;Yr--;){var Hr=$r[Yr];if(Hr.selector(Gt)){Hr.fn.call(Tt,Gt)||pe.store.render(),pe.ui.updateMapClasses();break}}};return J.start.call(Tt),{render:J.render,stop:function(){J.stop&&J.stop()},trash:function(){J.trash&&(J.trash(),pe.store.render())},combineFeatures:function(){J.combineFeatures&&J.combineFeatures()},uncombineFeatures:function(){J.uncombineFeatures&&J.uncombineFeatures()},drag:function(kt){Nt("drag",kt)},click:function(kt){Nt("click",kt)},mousemove:function(kt){Nt("mousemove",kt)},mousedown:function(kt){Nt("mousedown",kt)},mouseup:function(kt){Nt("mouseup",kt)},mouseout:function(kt){Nt("mouseout",kt)},keydown:function(kt){Nt("keydown",kt)},keyup:function(kt){Nt("keyup",kt)},touchstart:function(kt){Nt("touchstart",kt)},touchmove:function(kt){Nt("touchmove",kt)},touchend:function(kt){Nt("touchend",kt)},tap:function(kt){Nt("tap",kt)}}};function n(J){return J&&J.__esModule&&Object.prototype.hasOwnProperty.call(J,"default")?J.default:J}function i(J){if(J.__esModule)return J;var pe=J.default;if(typeof pe=="function"){var Xe=function Tt(){if(this instanceof Tt){var Nt=[null];Nt.push.apply(Nt,arguments);var kt=Function.bind.apply(pe,Nt);return new kt}return pe.apply(this,arguments)};Xe.prototype=pe.prototype}else Xe={};return Object.defineProperty(Xe,"__esModule",{value:!0}),Object.keys(J).forEach((function(Tt){var Nt=Object.getOwnPropertyDescriptor(J,Tt);Object.defineProperty(Xe,Tt,Nt.get?Nt:{enumerable:!0,get:function(){return J[Tt]}})})),Xe}var a={},s={RADIUS:6378137},o=s;function u(J){var pe=0;if(J&&J.length>0){pe+=Math.abs(h(J[0]));for(var Xe=1;Xe<J.length;Xe++)pe-=Math.abs(h(J[Xe]))}return pe}function h(J){var pe,Xe,Tt,Nt,kt,Gt,$r=0,Yr=J.length;if(Yr>2){for(Gt=0;Gt<Yr;Gt++)Gt===Yr-2?(Tt=Yr-2,Nt=Yr-1,kt=0):Gt===Yr-1?(Tt=Yr-1,Nt=0,kt=1):(Tt=Gt,Nt=Gt+1,kt=Gt+2),pe=J[Tt],Xe=J[Nt],$r+=(f(J[kt][0])-f(pe[0]))*Math.sin(f(Xe[1]));$r=$r*o.RADIUS*o.RADIUS/2}return $r}function f(J){return J*Math.PI/180}a.geometry=function J(pe){var Xe,Tt=0;switch(pe.type){case"Polygon":return u(pe.coordinates);case"MultiPolygon":for(Xe=0;Xe<pe.coordinates.length;Xe++)Tt+=u(pe.coordinates[Xe]);return Tt;case"Point":case"MultiPoint":case"LineString":case"MultiLineString":return 0;case"GeometryCollection":for(Xe=0;Xe<pe.geometries.length;Xe++)Tt+=J(pe.geometries[Xe]);return Tt}},a.ring=h;var g={CONTROL_BASE:"mapboxgl-ctrl",CONTROL_PREFIX:"mapboxgl-ctrl-",CONTROL_BUTTON:"mapbox-gl-draw_ctrl-draw-btn",CONTROL_BUTTON_LINE:"mapbox-gl-draw_line",CONTROL_BUTTON_POLYGON:"mapbox-gl-draw_polygon",CONTROL_BUTTON_POINT:"mapbox-gl-draw_point",CONTROL_BUTTON_TRASH:"mapbox-gl-draw_trash",CONTROL_BUTTON_COMBINE_FEATURES:"mapbox-gl-draw_combine",CONTROL_BUTTON_UNCOMBINE_FEATURES:"mapbox-gl-draw_uncombine",CONTROL_GROUP:"mapboxgl-ctrl-group",ATTRIBUTION:"mapboxgl-ctrl-attrib",ACTIVE_BUTTON:"active",BOX_SELECT:"mapbox-gl-draw_boxselect"},b={HOT:"mapbox-gl-draw-hot",COLD:"mapbox-gl-draw-cold"},v={ADD:"add",MOVE:"move",DRAG:"drag",POINTER:"pointer",NONE:"none"},S={POLYGON:"polygon",LINE:"line_string",POINT:"point"},E={FEATURE:"Feature",POLYGON:"Polygon",LINE_STRING:"LineString",POINT:"Point",FEATURE_COLLECTION:"FeatureCollection",MULTI_PREFIX:"Multi",MULTI_POINT:"MultiPoint",MULTI_LINE_STRING:"MultiLineString",MULTI_POLYGON:"MultiPolygon"},P={DRAW_LINE_STRING:"draw_line_string",DRAW_POLYGON:"draw_polygon",DRAW_POINT:"draw_point",SIMPLE_SELECT:"simple_select",DIRECT_SELECT:"direct_select",STATIC:"static"},k={CREATE:"draw.create",DELETE:"draw.delete",UPDATE:"draw.update",SELECTION_CHANGE:"draw.selectionchange",MODE_CHANGE:"draw.modechange",ACTIONABLE:"draw.actionable",RENDER:"draw.render",COMBINE_FEATURES:"draw.combine",UNCOMBINE_FEATURES:"draw.uncombine"},L={MOVE:"move",CHANGE_COORDINATES:"change_coordinates"},O={FEATURE:"feature",MIDPOINT:"midpoint",VERTEX:"vertex"},M={ACTIVE:"true",INACTIVE:"false"},z=["scrollZoom","boxZoom","dragRotate","dragPan","keyboard","doubleClickZoom","touchZoomRotate"],B=-85,q=Object.freeze({__proto__:null,classes:g,sources:b,cursors:v,types:S,geojsonTypes:E,modes:P,events:k,updateActions:L,meta:O,activeStates:M,interactions:z,LAT_MIN:-90,LAT_RENDERED_MIN:B,LAT_MAX:90,LAT_RENDERED_MAX:85,LNG_MIN:-270,LNG_MAX:270}),W={Point:0,LineString:1,MultiLineString:1,Polygon:2};function G(J,pe){var Xe=W[J.geometry.type]-W[pe.geometry.type];return Xe===0&&J.geometry.type===E.POLYGON?J.area-pe.area:Xe}function ie(J){return J.map((function(pe){return pe.geometry.type===E.POLYGON&&(pe.area=a.geometry({type:E.FEATURE,property:{},geometry:pe.geometry})),pe})).sort(G).map((function(pe){return delete pe.area,pe}))}function Q(J,pe){return pe===void 0&&(pe=0),[[J.point.x-pe,J.point.y-pe],[J.point.x+pe,J.point.y+pe]]}function H(J){if(this._items={},this._nums={},this._length=J?J.length:0,J)for(var pe=0,Xe=J.length;pe<Xe;pe++)this.add(J[pe]),J[pe]!==void 0&&(typeof J[pe]=="string"?this._items[J[pe]]=pe:this._nums[J[pe]]=pe)}H.prototype.add=function(J){return this.has(J)||(this._length++,typeof J=="string"?this._items[J]=this._length:this._nums[J]=this._length),this},H.prototype.delete=function(J){return this.has(J)===!1||(this._length--,delete this._items[J],delete this._nums[J]),this},H.prototype.has=function(J){return(typeof J=="string"||typeof J=="number")&&(this._items[J]!==void 0||this._nums[J]!==void 0)},H.prototype.values=function(){var J=this,pe=[];return Object.keys(this._items).forEach((function(Xe){pe.push({k:Xe,v:J._items[Xe]})})),Object.keys(this._nums).forEach((function(Xe){pe.push({k:JSON.parse(Xe),v:J._nums[Xe]})})),pe.sort((function(Xe,Tt){return Xe.v-Tt.v})).map((function(Xe){return Xe.k}))},H.prototype.clear=function(){return this._length=0,this._items={},this._nums={},this};var ne=[O.FEATURE,O.MIDPOINT,O.VERTEX],oe={click:function(J,pe,Xe){return ce(J,pe,Xe,Xe.options.clickBuffer)},touch:function(J,pe,Xe){return ce(J,pe,Xe,Xe.options.touchBuffer)}};function ce(J,pe,Xe,Tt){if(Xe.map===null)return[];var Nt=J?Q(J,Tt):pe,kt={};Xe.options.styles&&(kt.layers=Xe.options.styles.map((function(Hr){return Hr.id})).filter((function(Hr){return Xe.map.getLayer(Hr)!=null})));var Gt=Xe.map.queryRenderedFeatures(Nt,kt).filter((function(Hr){return ne.indexOf(Hr.properties.meta)!==-1})),$r=new H,Yr=[];return Gt.forEach((function(Hr){var kr=Hr.properties.id;$r.has(kr)||($r.add(kr),Yr.push(Hr))})),ie(Yr)}function fe(J,pe){var Xe=oe.click(J,null,pe),Tt={mouse:v.NONE};return Xe[0]&&(Tt.mouse=Xe[0].properties.active===M.ACTIVE?v.MOVE:v.POINTER,Tt.feature=Xe[0].properties.meta),pe.events.currentModeName().indexOf("draw")!==-1&&(Tt.mouse=v.ADD),pe.ui.queueMapClasses(Tt),pe.ui.updateMapClasses(),Xe[0]}function Me(J,pe){var Xe=J.x-pe.x,Tt=J.y-pe.y;return Math.sqrt(Xe*Xe+Tt*Tt)}function me(J,pe,Xe){Xe===void 0&&(Xe={});var Tt=Xe.fineTolerance!=null?Xe.fineTolerance:4,Nt=Xe.grossTolerance!=null?Xe.grossTolerance:12,kt=Xe.interval!=null?Xe.interval:500;J.point=J.point||pe.point,J.time=J.time||pe.time;var Gt=Me(J.point,pe.point);return Gt<Tt||Gt<Nt&&pe.time-J.time<kt}function we(J,pe,Xe){Xe===void 0&&(Xe={});var Tt=Xe.tolerance!=null?Xe.tolerance:25,Nt=Xe.interval!=null?Xe.interval:250;return J.point=J.point||pe.point,J.time=J.time||pe.time,Me(J.point,pe.point)<Tt&&pe.time-J.time<Nt}var Te={exports:{}},ke=Te.exports=function(J,pe){if(pe||(pe=16),J===void 0&&(J=128),J<=0)return"0";for(var Xe=Math.log(Math.pow(2,J))/Math.log(pe),Tt=2;Xe===1/0;Tt*=2)Xe=Math.log(Math.pow(2,J/Tt))/Math.log(pe)*Tt;var Nt=Xe-Math.floor(Xe),kt="";for(Tt=0;Tt<Math.floor(Xe);Tt++)kt=Math.floor(Math.random()*pe).toString(pe)+kt;if(Nt){var Gt=Math.pow(pe,Nt);kt=Math.floor(Math.random()*Gt).toString(pe)+kt}var $r=parseInt(kt,pe);return $r!==1/0&&$r>=Math.pow(2,J)?ke(J,pe):kt};ke.rack=function(J,pe,Xe){var Tt=function(kt){var Gt=0;do{if(Gt++>10){if(!Xe)throw new Error("too many ID collisions, use more bits");J+=Xe}var $r=ke(J,pe)}while(Object.hasOwnProperty.call(Nt,$r));return Nt[$r]=kt,$r},Nt=Tt.hats={};return Tt.get=function(kt){return Tt.hats[kt]},Tt.set=function(kt,Gt){return Tt.hats[kt]=Gt,Tt},Tt.bits=J||128,Tt.base=pe||16,Tt};var he=n(Te.exports),Ee=function(J,pe){this.ctx=J,this.properties=pe.properties||{},this.coordinates=pe.geometry.coordinates,this.id=pe.id||he(),this.type=pe.geometry.type};Ee.prototype.changed=function(){this.ctx.store.featureChanged(this.id)},Ee.prototype.incomingCoords=function(J){this.setCoordinates(J)},Ee.prototype.setCoordinates=function(J){this.coordinates=J,this.changed()},Ee.prototype.getCoordinates=function(){return JSON.parse(JSON.stringify(this.coordinates))},Ee.prototype.setProperty=function(J,pe){this.properties[J]=pe},Ee.prototype.toGeoJSON=function(){return JSON.parse(JSON.stringify({id:this.id,type:E.FEATURE,properties:this.properties,geometry:{coordinates:this.getCoordinates(),type:this.type}}))},Ee.prototype.internal=function(J){var pe={id:this.id,meta:O.FEATURE,"meta:type":this.type,active:M.INACTIVE,mode:J};if(this.ctx.options.userProperties)for(var Xe in this.properties)pe["user_"+Xe]=this.properties[Xe];return{type:E.FEATURE,properties:pe,geometry:{coordinates:this.getCoordinates(),type:this.type}}};var xe=function(J,pe){Ee.call(this,J,pe)};(xe.prototype=Object.create(Ee.prototype)).isValid=function(){return typeof this.coordinates[0]=="number"&&typeof this.coordinates[1]=="number"},xe.prototype.updateCoordinate=function(J,pe,Xe){this.coordinates=arguments.length===3?[pe,Xe]:[J,pe],this.changed()},xe.prototype.getCoordinate=function(){return this.getCoordinates()};var Ne=function(J,pe){Ee.call(this,J,pe)};(Ne.prototype=Object.create(Ee.prototype)).isValid=function(){return this.coordinates.length>1},Ne.prototype.addCoordinate=function(J,pe,Xe){this.changed();var Tt=parseInt(J,10);this.coordinates.splice(Tt,0,[pe,Xe])},Ne.prototype.getCoordinate=function(J){var pe=parseInt(J,10);return JSON.parse(JSON.stringify(this.coordinates[pe]))},Ne.prototype.removeCoordinate=function(J){this.changed(),this.coordinates.splice(parseInt(J,10),1)},Ne.prototype.updateCoordinate=function(J,pe,Xe){var Tt=parseInt(J,10);this.coordinates[Tt]=[pe,Xe],this.changed()};var Oe=function(J,pe){Ee.call(this,J,pe),this.coordinates=this.coordinates.map((function(Xe){return Xe.slice(0,-1)}))};(Oe.prototype=Object.create(Ee.prototype)).isValid=function(){return this.coordinates.length!==0&&this.coordinates.every((function(J){return J.length>2}))},Oe.prototype.incomingCoords=function(J){this.coordinates=J.map((function(pe){return pe.slice(0,-1)})),this.changed()},Oe.prototype.setCoordinates=function(J){this.coordinates=J,this.changed()},Oe.prototype.addCoordinate=function(J,pe,Xe){this.changed();var Tt=J.split(".").map((function(Nt){return parseInt(Nt,10)}));this.coordinates[Tt[0]].splice(Tt[1],0,[pe,Xe])},Oe.prototype.removeCoordinate=function(J){this.changed();var pe=J.split(".").map((function(Tt){return parseInt(Tt,10)})),Xe=this.coordinates[pe[0]];Xe&&(Xe.splice(pe[1],1),Xe.length<3&&this.coordinates.splice(pe[0],1))},Oe.prototype.getCoordinate=function(J){var pe=J.split(".").map((function(Tt){return parseInt(Tt,10)})),Xe=this.coordinates[pe[0]];return JSON.parse(JSON.stringify(Xe[pe[1]]))},Oe.prototype.getCoordinates=function(){return this.coordinates.map((function(J){return J.concat([J[0]])}))},Oe.prototype.updateCoordinate=function(J,pe,Xe){this.changed();var Tt=J.split("."),Nt=parseInt(Tt[0],10),kt=parseInt(Tt[1],10);this.coordinates[Nt]===void 0&&(this.coordinates[Nt]=[]),this.coordinates[Nt][kt]=[pe,Xe]};var $e={MultiPoint:xe,MultiLineString:Ne,MultiPolygon:Oe},De=function(J,pe,Xe,Tt,Nt){var kt=Xe.split("."),Gt=parseInt(kt[0],10),$r=kt[1]?kt.slice(1).join("."):null;return J[Gt][pe]($r,Tt,Nt)},it=function(J,pe){if(Ee.call(this,J,pe),delete this.coordinates,this.model=$e[pe.geometry.type],this.model===void 0)throw new TypeError(pe.geometry.type+" is not a valid type");this.features=this._coordinatesToFeatures(pe.geometry.coordinates)};function Ye(J){this.map=J.map,this.drawConfig=JSON.parse(JSON.stringify(J.options||{})),this._ctx=J}(it.prototype=Object.create(Ee.prototype))._coordinatesToFeatures=function(J){var pe=this,Xe=this.model.bind(this);return J.map((function(Tt){return new Xe(pe.ctx,{id:he(),type:E.FEATURE,properties:{},geometry:{coordinates:Tt,type:pe.type.replace("Multi","")}})}))},it.prototype.isValid=function(){return this.features.every((function(J){return J.isValid()}))},it.prototype.setCoordinates=function(J){this.features=this._coordinatesToFeatures(J),this.changed()},it.prototype.getCoordinate=function(J){return De(this.features,"getCoordinate",J)},it.prototype.getCoordinates=function(){return JSON.parse(JSON.stringify(this.features.map((function(J){return J.type===E.POLYGON?J.getCoordinates():J.coordinates}))))},it.prototype.updateCoordinate=function(J,pe,Xe){De(this.features,"updateCoordinate",J,pe,Xe),this.changed()},it.prototype.addCoordinate=function(J,pe,Xe){De(this.features,"addCoordinate",J,pe,Xe),this.changed()},it.prototype.removeCoordinate=function(J){De(this.features,"removeCoordinate",J),this.changed()},it.prototype.getFeatures=function(){return this.features},Ye.prototype.setSelected=function(J){return this._ctx.store.setSelected(J)},Ye.prototype.setSelectedCoordinates=function(J){var pe=this;this._ctx.store.setSelectedCoordinates(J),J.reduce((function(Xe,Tt){return Xe[Tt.feature_id]===void 0&&(Xe[Tt.feature_id]=!0,pe._ctx.store.get(Tt.feature_id).changed()),Xe}),{})},Ye.prototype.getSelected=function(){return this._ctx.store.getSelected()},Ye.prototype.getSelectedIds=function(){return this._ctx.store.getSelectedIds()},Ye.prototype.isSelected=function(J){return this._ctx.store.isSelected(J)},Ye.prototype.getFeature=function(J){return this._ctx.store.get(J)},Ye.prototype.select=function(J){return this._ctx.store.select(J)},Ye.prototype.deselect=function(J){return this._ctx.store.deselect(J)},Ye.prototype.deleteFeature=function(J,pe){return pe===void 0&&(pe={}),this._ctx.store.delete(J,pe)},Ye.prototype.addFeature=function(J){return this._ctx.store.add(J)},Ye.prototype.clearSelectedFeatures=function(){return this._ctx.store.clearSelected()},Ye.prototype.clearSelectedCoordinates=function(){return this._ctx.store.clearSelectedCoordinates()},Ye.prototype.setActionableState=function(J){J===void 0&&(J={});var pe={trash:J.trash||!1,combineFeatures:J.combineFeatures||!1,uncombineFeatures:J.uncombineFeatures||!1};return this._ctx.events.actionable(pe)},Ye.prototype.changeMode=function(J,pe,Xe){return pe===void 0&&(pe={}),Xe===void 0&&(Xe={}),this._ctx.events.changeMode(J,pe,Xe)},Ye.prototype.updateUIClasses=function(J){return this._ctx.ui.queueMapClasses(J)},Ye.prototype.activateUIButton=function(J){return this._ctx.ui.setActiveButton(J)},Ye.prototype.featuresAt=function(J,pe,Xe){if(Xe===void 0&&(Xe="click"),Xe!=="click"&&Xe!=="touch")throw new Error("invalid buffer type");return oe[Xe](J,pe,this._ctx)},Ye.prototype.newFeature=function(J){var pe=J.geometry.type;return pe===E.POINT?new xe(this._ctx,J):pe===E.LINE_STRING?new Ne(this._ctx,J):pe===E.POLYGON?new Oe(this._ctx,J):new it(this._ctx,J)},Ye.prototype.isInstanceOf=function(J,pe){if(J===E.POINT)return pe instanceof xe;if(J===E.LINE_STRING)return pe instanceof Ne;if(J===E.POLYGON)return pe instanceof Oe;if(J==="MultiFeature")return pe instanceof it;throw new Error("Unknown feature class: "+J)},Ye.prototype.doRender=function(J){return this._ctx.store.featureChanged(J)},Ye.prototype.onSetup=function(){},Ye.prototype.onDrag=function(){},Ye.prototype.onClick=function(){},Ye.prototype.onMouseMove=function(){},Ye.prototype.onMouseDown=function(){},Ye.prototype.onMouseUp=function(){},Ye.prototype.onMouseOut=function(){},Ye.prototype.onKeyUp=function(){},Ye.prototype.onKeyDown=function(){},Ye.prototype.onTouchStart=function(){},Ye.prototype.onTouchMove=function(){},Ye.prototype.onTouchEnd=function(){},Ye.prototype.onTap=function(){},Ye.prototype.onStop=function(){},Ye.prototype.onTrash=function(){},Ye.prototype.onCombineFeature=function(){},Ye.prototype.onUncombineFeature=function(){},Ye.prototype.toDisplayFeatures=function(){throw new Error("You must overwrite toDisplayFeatures")};var rt={drag:"onDrag",click:"onClick",mousemove:"onMouseMove",mousedown:"onMouseDown",mouseup:"onMouseUp",mouseout:"onMouseOut",keyup:"onKeyUp",keydown:"onKeyDown",touchstart:"onTouchStart",touchmove:"onTouchMove",touchend:"onTouchEnd",tap:"onTap"},Ie=Object.keys(rt);function Mt(J){var pe=Object.keys(J);return function(Xe,Tt){Tt===void 0&&(Tt={});var Nt={},kt=pe.reduce((function(Gt,$r){return Gt[$r]=J[$r],Gt}),new Ye(Xe));return{start:function(){var Gt=this;Nt=kt.onSetup(Tt),Ie.forEach((function($r){var Yr,Hr=rt[$r],kr=function(){return!1};J[Hr]&&(kr=function(){return!0}),Gt.on($r,kr,(Yr=Hr,function(Qr){return kt[Yr](Nt,Qr)}))}))},stop:function(){kt.onStop(Nt)},trash:function(){kt.onTrash(Nt)},combineFeatures:function(){kt.onCombineFeatures(Nt)},uncombineFeatures:function(){kt.onUncombineFeatures(Nt)},render:function(Gt,$r){kt.toDisplayFeatures(Nt,Gt,$r)}}}}function at(J){return[].concat(J).filter((function(pe){return pe!==void 0}))}function je(){var J=this;if(!(J.ctx.map&&J.ctx.map.getSource(b.HOT)!==void 0))return Yr();var pe=J.ctx.events.currentModeName();J.ctx.ui.queueMapClasses({mode:pe});var Xe=[],Tt=[];J.isDirty?Tt=J.getAllIds():(Xe=J.getChangedIds().filter((function(Hr){return J.get(Hr)!==void 0})),Tt=J.sources.hot.filter((function(Hr){return Hr.properties.id&&Xe.indexOf(Hr.properties.id)===-1&&J.get(Hr.properties.id)!==void 0})).map((function(Hr){return Hr.properties.id}))),J.sources.hot=[];var Nt=J.sources.cold.length;J.sources.cold=J.isDirty?[]:J.sources.cold.filter((function(Hr){var kr=Hr.properties.id||Hr.properties.parent;return Xe.indexOf(kr)===-1}));var kt=Nt!==J.sources.cold.length||Tt.length>0;function Gt(Hr,kr){var Qr=J.get(Hr).internal(pe);J.ctx.events.currentModeRender(Qr,(function(Qn){J.sources[kr].push(Qn)}))}if(Xe.forEach((function(Hr){return Gt(Hr,"hot")})),Tt.forEach((function(Hr){return Gt(Hr,"cold")})),kt&&J.ctx.map.getSource(b.COLD).setData({type:E.FEATURE_COLLECTION,features:J.sources.cold}),J.ctx.map.getSource(b.HOT).setData({type:E.FEATURE_COLLECTION,features:J.sources.hot}),J._emitSelectionChange&&(J.ctx.map.fire(k.SELECTION_CHANGE,{features:J.getSelected().map((function(Hr){return Hr.toGeoJSON()})),points:J.getSelectedCoordinates().map((function(Hr){return{type:E.FEATURE,properties:{},geometry:{type:E.POINT,coordinates:Hr.coordinates}}}))}),J._emitSelectionChange=!1),J._deletedFeaturesToEmit.length){var $r=J._deletedFeaturesToEmit.map((function(Hr){return Hr.toGeoJSON()}));J._deletedFeaturesToEmit=[],J.ctx.map.fire(k.DELETE,{features:$r})}function Yr(){J.isDirty=!1,J.clearChangedIds()}Yr(),J.ctx.map.fire(k.RENDER,{})}function Xt(J){var pe,Xe=this;this._features={},this._featureIds=new H,this._selectedFeatureIds=new H,this._selectedCoordinates=[],this._changedFeatureIds=new H,this._deletedFeaturesToEmit=[],this._emitSelectionChange=!1,this._mapInitialConfig={},this.ctx=J,this.sources={hot:[],cold:[]},this.render=function(){pe||(pe=requestAnimationFrame((function(){pe=null,je.call(Xe)})))},this.isDirty=!1}function Yt(J,pe){var Xe=J._selectedCoordinates.filter((function(Tt){return J._selectedFeatureIds.has(Tt.feature_id)}));J._selectedCoordinates.length===Xe.length||pe.silent||(J._emitSelectionChange=!0),J._selectedCoordinates=Xe}Xt.prototype.createRenderBatch=function(){var J=this,pe=this.render,Xe=0;return this.render=function(){Xe++},function(){J.render=pe,Xe>0&&J.render()}},Xt.prototype.setDirty=function(){return this.isDirty=!0,this},Xt.prototype.featureChanged=function(J){return this._changedFeatureIds.add(J),this},Xt.prototype.getChangedIds=function(){return this._changedFeatureIds.values()},Xt.prototype.clearChangedIds=function(){return this._changedFeatureIds.clear(),this},Xt.prototype.getAllIds=function(){return this._featureIds.values()},Xt.prototype.add=function(J){return this.featureChanged(J.id),this._features[J.id]=J,this._featureIds.add(J.id),this},Xt.prototype.delete=function(J,pe){var Xe=this;return pe===void 0&&(pe={}),at(J).forEach((function(Tt){Xe._featureIds.has(Tt)&&(Xe._featureIds.delete(Tt),Xe._selectedFeatureIds.delete(Tt),pe.silent||Xe._deletedFeaturesToEmit.indexOf(Xe._features[Tt])===-1&&Xe._deletedFeaturesToEmit.push(Xe._features[Tt]),delete Xe._features[Tt],Xe.isDirty=!0)})),Yt(this,pe),this},Xt.prototype.get=function(J){return this._features[J]},Xt.prototype.getAll=function(){var J=this;return Object.keys(this._features).map((function(pe){return J._features[pe]}))},Xt.prototype.select=function(J,pe){var Xe=this;return pe===void 0&&(pe={}),at(J).forEach((function(Tt){Xe._selectedFeatureIds.has(Tt)||(Xe._selectedFeatureIds.add(Tt),Xe._changedFeatureIds.add(Tt),pe.silent||(Xe._emitSelectionChange=!0))})),this},Xt.prototype.deselect=function(J,pe){var Xe=this;return pe===void 0&&(pe={}),at(J).forEach((function(Tt){Xe._selectedFeatureIds.has(Tt)&&(Xe._selectedFeatureIds.delete(Tt),Xe._changedFeatureIds.add(Tt),pe.silent||(Xe._emitSelectionChange=!0))})),Yt(this,pe),this},Xt.prototype.clearSelected=function(J){return J===void 0&&(J={}),this.deselect(this._selectedFeatureIds.values(),{silent:J.silent}),this},Xt.prototype.setSelected=function(J,pe){var Xe=this;return pe===void 0&&(pe={}),J=at(J),this.deselect(this._selectedFeatureIds.values().filter((function(Tt){return J.indexOf(Tt)===-1})),{silent:pe.silent}),this.select(J.filter((function(Tt){return!Xe._selectedFeatureIds.has(Tt)})),{silent:pe.silent}),this},Xt.prototype.setSelectedCoordinates=function(J){return this._selectedCoordinates=J,this._emitSelectionChange=!0,this},Xt.prototype.clearSelectedCoordinates=function(){return this._selectedCoordinates=[],this._emitSelectionChange=!0,this},Xt.prototype.getSelectedIds=function(){return this._selectedFeatureIds.values()},Xt.prototype.getSelected=function(){var J=this;return this._selectedFeatureIds.values().map((function(pe){return J.get(pe)}))},Xt.prototype.getSelectedCoordinates=function(){var J=this;return this._selectedCoordinates.map((function(pe){return{coordinates:J.get(pe.feature_id).getCoordinate(pe.coord_path)}}))},Xt.prototype.isSelected=function(J){return this._selectedFeatureIds.has(J)},Xt.prototype.setFeatureProperty=function(J,pe,Xe){this.get(J).setProperty(pe,Xe),this.featureChanged(J)},Xt.prototype.storeMapConfig=function(){var J=this;z.forEach((function(pe){J.ctx.map[pe]&&(J._mapInitialConfig[pe]=J.ctx.map[pe].isEnabled())}))},Xt.prototype.restoreMapConfig=function(){var J=this;Object.keys(this._mapInitialConfig).forEach((function(pe){J._mapInitialConfig[pe]?J.ctx.map[pe].enable():J.ctx.map[pe].disable()}))},Xt.prototype.getInitialConfigValue=function(J){return this._mapInitialConfig[J]===void 0||this._mapInitialConfig[J]};var pr=function(){for(var J=arguments,pe={},Xe=0;Xe<arguments.length;Xe++){var Tt=J[Xe];for(var Nt in Tt)vt.call(Tt,Nt)&&(pe[Nt]=Tt[Nt])}return pe},vt=Object.prototype.hasOwnProperty,yr=n(pr),_r=["mode","feature","mouse"];function cr(J){var pe=null,Xe=null,Tt={onRemove:function(){return J.map.off("load",Tt.connect),clearInterval(Xe),Tt.removeLayers(),J.store.restoreMapConfig(),J.ui.removeButtons(),J.events.removeEventListeners(),J.ui.clearMapClasses(),J.boxZoomInitial&&J.map.boxZoom.enable(),J.map=null,J.container=null,J.store=null,pe&&pe.parentNode&&pe.parentNode.removeChild(pe),pe=null,this},connect:function(){J.map.off("load",Tt.connect),clearInterval(Xe),Tt.addLayers(),J.store.storeMapConfig(),J.events.addEventListeners()},onAdd:function(Nt){var kt=Nt.fire;return Nt.fire=function(Gt,$r){var Yr=arguments;return kt.length===1&&arguments.length!==1&&(Yr=[yr({},{type:Gt},$r)]),kt.apply(Nt,Yr)},J.map=Nt,J.events=(function(Gt){var $r=Object.keys(Gt.options.modes).reduce((function(Mr,cn){return Mr[cn]=Mt(Gt.options.modes[cn]),Mr}),{}),Yr={},Hr={},kr={},Qr=null,Qn=null;kr.drag=function(Mr,cn){cn({point:Mr.point,time:new Date().getTime()})?(Gt.ui.queueMapClasses({mouse:v.DRAG}),Qn.drag(Mr)):Mr.originalEvent.stopPropagation()},kr.mousedrag=function(Mr){kr.drag(Mr,(function(cn){return!me(Yr,cn)}))},kr.touchdrag=function(Mr){kr.drag(Mr,(function(cn){return!we(Hr,cn)}))},kr.mousemove=function(Mr){if((Mr.originalEvent.buttons!==void 0?Mr.originalEvent.buttons:Mr.originalEvent.which)===1)return kr.mousedrag(Mr);var cn=fe(Mr,Gt);Mr.featureTarget=cn,Qn.mousemove(Mr)},kr.mousedown=function(Mr){Yr={time:new Date().getTime(),point:Mr.point};var cn=fe(Mr,Gt);Mr.featureTarget=cn,Qn.mousedown(Mr)},kr.mouseup=function(Mr){var cn=fe(Mr,Gt);Mr.featureTarget=cn,me(Yr,{point:Mr.point,time:new Date().getTime()})?Qn.click(Mr):Qn.mouseup(Mr)},kr.mouseout=function(Mr){Qn.mouseout(Mr)},kr.touchstart=function(Mr){if(Gt.options.touchEnabled){Hr={time:new Date().getTime(),point:Mr.point};var cn=oe.touch(Mr,null,Gt)[0];Mr.featureTarget=cn,Qn.touchstart(Mr)}},kr.touchmove=function(Mr){if(Gt.options.touchEnabled)return Qn.touchmove(Mr),kr.touchdrag(Mr)},kr.touchend=function(Mr){if(Mr.originalEvent.preventDefault(),Gt.options.touchEnabled){var cn=oe.touch(Mr,null,Gt)[0];Mr.featureTarget=cn,we(Hr,{time:new Date().getTime(),point:Mr.point})?Qn.tap(Mr):Qn.touchend(Mr)}};var Ei=function(Mr){return!(Mr===8||Mr===46||Mr>=48&&Mr<=57)};function En(Mr,cn,Wn){Wn===void 0&&(Wn={}),Qn.stop();var Ma=$r[Mr];if(Ma===void 0)throw new Error(Mr+" is not valid");Qr=Mr;var Ci=Ma(Gt,cn);Qn=r(Ci,Gt),Wn.silent||Gt.map.fire(k.MODE_CHANGE,{mode:Mr}),Gt.store.setDirty(),Gt.store.render()}kr.keydown=function(Mr){(Mr.srcElement||Mr.target).classList.contains("mapboxgl-canvas")&&(Mr.keyCode!==8&&Mr.keyCode!==46||!Gt.options.controls.trash?Ei(Mr.keyCode)?Qn.keydown(Mr):Mr.keyCode===49&&Gt.options.controls.point?En(P.DRAW_POINT):Mr.keyCode===50&&Gt.options.controls.line_string?En(P.DRAW_LINE_STRING):Mr.keyCode===51&&Gt.options.controls.polygon&&En(P.DRAW_POLYGON):(Mr.preventDefault(),Qn.trash()))},kr.keyup=function(Mr){Ei(Mr.keyCode)&&Qn.keyup(Mr)},kr.zoomend=function(){Gt.store.changeZoom()},kr.data=function(Mr){if(Mr.dataType==="style"){var cn=Gt.setup,Wn=Gt.map,Ma=Gt.options,Ci=Gt.store;Ma.styles.some((function(Ra){return Wn.getLayer(Ra.id)}))||(cn.addLayers(),Ci.setDirty(),Ci.render())}};var pn={trash:!1,combineFeatures:!1,uncombineFeatures:!1};return{start:function(){Qr=Gt.options.defaultMode,Qn=r($r[Qr](Gt),Gt)},changeMode:En,actionable:function(Mr){var cn=!1;Object.keys(Mr).forEach((function(Wn){if(pn[Wn]===void 0)throw new Error("Invalid action type");pn[Wn]!==Mr[Wn]&&(cn=!0),pn[Wn]=Mr[Wn]})),cn&&Gt.map.fire(k.ACTIONABLE,{actions:pn})},currentModeName:function(){return Qr},currentModeRender:function(Mr,cn){return Qn.render(Mr,cn)},fire:function(Mr,cn){kr[Mr]&&kr[Mr](cn)},addEventListeners:function(){Gt.map.on("mousemove",kr.mousemove),Gt.map.on("mousedown",kr.mousedown),Gt.map.on("mouseup",kr.mouseup),Gt.map.on("data",kr.data),Gt.map.on("touchmove",kr.touchmove),Gt.map.on("touchstart",kr.touchstart),Gt.map.on("touchend",kr.touchend),Gt.container.addEventListener("mouseout",kr.mouseout),Gt.options.keybindings&&(Gt.container.addEventListener("keydown",kr.keydown),Gt.container.addEventListener("keyup",kr.keyup))},removeEventListeners:function(){Gt.map.off("mousemove",kr.mousemove),Gt.map.off("mousedown",kr.mousedown),Gt.map.off("mouseup",kr.mouseup),Gt.map.off("data",kr.data),Gt.map.off("touchmove",kr.touchmove),Gt.map.off("touchstart",kr.touchstart),Gt.map.off("touchend",kr.touchend),Gt.container.removeEventListener("mouseout",kr.mouseout),Gt.options.keybindings&&(Gt.container.removeEventListener("keydown",kr.keydown),Gt.container.removeEventListener("keyup",kr.keyup))},trash:function(Mr){Qn.trash(Mr)},combineFeatures:function(){Qn.combineFeatures()},uncombineFeatures:function(){Qn.uncombineFeatures()},getMode:function(){return Qr}}})(J),J.ui=(function(Gt){var $r={},Yr=null,Hr={mode:null,feature:null,mouse:null},kr={mode:null,feature:null,mouse:null};function Qr(Mr){kr=yr(kr,Mr)}function Qn(){var Mr,cn;if(Gt.container){var Wn=[],Ma=[];_r.forEach((function(Ci){kr[Ci]!==Hr[Ci]&&(Wn.push(Ci+"-"+Hr[Ci]),kr[Ci]!==null&&Ma.push(Ci+"-"+kr[Ci]))})),Wn.length>0&&(Mr=Gt.container.classList).remove.apply(Mr,Wn),Ma.length>0&&(cn=Gt.container.classList).add.apply(cn,Ma),Hr=yr(Hr,kr)}}function Ei(Mr,cn){cn===void 0&&(cn={});var Wn=document.createElement("button");return Wn.className=g.CONTROL_BUTTON+" "+cn.className,Wn.setAttribute("title",cn.title),cn.container.appendChild(Wn),Wn.addEventListener("click",(function(Ma){if(Ma.preventDefault(),Ma.stopPropagation(),Ma.target===Yr)return En(),void cn.onDeactivate();pn(Mr),cn.onActivate()}),!0),Wn}function En(){Yr&&(Yr.classList.remove(g.ACTIVE_BUTTON),Yr=null)}function pn(Mr){En();var cn=$r[Mr];cn&&cn&&Mr!=="trash"&&(cn.classList.add(g.ACTIVE_BUTTON),Yr=cn)}return{setActiveButton:pn,queueMapClasses:Qr,updateMapClasses:Qn,clearMapClasses:function(){Qr({mode:null,feature:null,mouse:null}),Qn()},addButtons:function(){var Mr=Gt.options.controls,cn=document.createElement("div");return cn.className=g.CONTROL_GROUP+" "+g.CONTROL_BASE,Mr&&(Mr[S.LINE]&&($r[S.LINE]=Ei(S.LINE,{container:cn,className:g.CONTROL_BUTTON_LINE,title:"LineString tool "+(Gt.options.keybindings?"(l)":""),onActivate:function(){return Gt.events.changeMode(P.DRAW_LINE_STRING)},onDeactivate:function(){return Gt.events.trash()}})),Mr[S.POLYGON]&&($r[S.POLYGON]=Ei(S.POLYGON,{container:cn,className:g.CONTROL_BUTTON_POLYGON,title:"Polygon tool "+(Gt.options.keybindings?"(p)":""),onActivate:function(){return Gt.events.changeMode(P.DRAW_POLYGON)},onDeactivate:function(){return Gt.events.trash()}})),Mr[S.POINT]&&($r[S.POINT]=Ei(S.POINT,{container:cn,className:g.CONTROL_BUTTON_POINT,title:"Marker tool "+(Gt.options.keybindings?"(m)":""),onActivate:function(){return Gt.events.changeMode(P.DRAW_POINT)},onDeactivate:function(){return Gt.events.trash()}})),Mr.trash&&($r.trash=Ei("trash",{container:cn,className:g.CONTROL_BUTTON_TRASH,title:"Delete",onActivate:function(){Gt.events.trash()}})),Mr.combine_features&&($r.combine_features=Ei("combineFeatures",{container:cn,className:g.CONTROL_BUTTON_COMBINE_FEATURES,title:"Combine",onActivate:function(){Gt.events.combineFeatures()}})),Mr.uncombine_features&&($r.uncombine_features=Ei("uncombineFeatures",{container:cn,className:g.CONTROL_BUTTON_UNCOMBINE_FEATURES,title:"Uncombine",onActivate:function(){Gt.events.uncombineFeatures()}}))),cn},removeButtons:function(){Object.keys($r).forEach((function(Mr){var cn=$r[Mr];cn.parentNode&&cn.parentNode.removeChild(cn),delete $r[Mr]}))}}})(J),J.container=Nt.getContainer(),J.store=new Xt(J),pe=J.ui.addButtons(),J.options.boxSelect&&(J.boxZoomInitial=Nt.boxZoom.isEnabled(),Nt.boxZoom.disable(),Nt.dragPan.disable(),Nt.dragPan.enable()),Nt.loaded()?Tt.connect():(Nt.on("load",Tt.connect),Xe=setInterval((function(){Nt.loaded()&&Tt.connect()}),16)),J.events.start(),pe},addLayers:function(){J.map.addSource(b.COLD,{data:{type:E.FEATURE_COLLECTION,features:[]},type:"geojson"}),J.map.addSource(b.HOT,{data:{type:E.FEATURE_COLLECTION,features:[]},type:"geojson"}),J.options.styles.forEach((function(Nt){J.map.addLayer(Nt)})),J.store.setDirty(!0),J.store.render()},removeLayers:function(){J.options.styles.forEach((function(Nt){J.map.getLayer(Nt.id)&&J.map.removeLayer(Nt.id)})),J.map.getSource(b.COLD)&&J.map.removeSource(b.COLD),J.map.getSource(b.HOT)&&J.map.removeSource(b.HOT)}};return J.setup=Tt,Tt}var Er=[{id:"gl-draw-polygon-fill-inactive",type:"fill",filter:["all",["==","active","false"],["==","$type","Polygon"],["!=","mode","static"]],paint:{"fill-color":"#3bb2d0","fill-outline-color":"#3bb2d0","fill-opacity":.1}},{id:"gl-draw-polygon-fill-active",type:"fill",filter:["all",["==","active","true"],["==","$type","Polygon"]],paint:{"fill-color":"#fbb03b","fill-outline-color":"#fbb03b","fill-opacity":.1}},{id:"gl-draw-polygon-midpoint",type:"circle",filter:["all",["==","$type","Point"],["==","meta","midpoint"]],paint:{"circle-radius":3,"circle-color":"#fbb03b"}},{id:"gl-draw-polygon-stroke-inactive",type:"line",filter:["all",["==","active","false"],["==","$type","Polygon"],["!=","mode","static"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#3bb2d0","line-width":2}},{id:"gl-draw-polygon-stroke-active",type:"line",filter:["all",["==","active","true"],["==","$type","Polygon"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#fbb03b","line-dasharray":[.2,2],"line-width":2}},{id:"gl-draw-line-inactive",type:"line",filter:["all",["==","active","false"],["==","$type","LineString"],["!=","mode","static"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#3bb2d0","line-width":2}},{id:"gl-draw-line-active",type:"line",filter:["all",["==","$type","LineString"],["==","active","true"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#fbb03b","line-dasharray":[.2,2],"line-width":2}},{id:"gl-draw-polygon-and-line-vertex-stroke-inactive",type:"circle",filter:["all",["==","meta","vertex"],["==","$type","Point"],["!=","mode","static"]],paint:{"circle-radius":5,"circle-color":"#fff"}},{id:"gl-draw-polygon-and-line-vertex-inactive",type:"circle",filter:["all",["==","meta","vertex"],["==","$type","Point"],["!=","mode","static"]],paint:{"circle-radius":3,"circle-color":"#fbb03b"}},{id:"gl-draw-point-point-stroke-inactive",type:"circle",filter:["all",["==","active","false"],["==","$type","Point"],["==","meta","feature"],["!=","mode","static"]],paint:{"circle-radius":5,"circle-opacity":1,"circle-color":"#fff"}},{id:"gl-draw-point-inactive",type:"circle",filter:["all",["==","active","false"],["==","$type","Point"],["==","meta","feature"],["!=","mode","static"]],paint:{"circle-radius":3,"circle-color":"#3bb2d0"}},{id:"gl-draw-point-stroke-active",type:"circle",filter:["all",["==","$type","Point"],["==","active","true"],["!=","meta","midpoint"]],paint:{"circle-radius":7,"circle-color":"#fff"}},{id:"gl-draw-point-active",type:"circle",filter:["all",["==","$type","Point"],["!=","meta","midpoint"],["==","active","true"]],paint:{"circle-radius":5,"circle-color":"#fbb03b"}},{id:"gl-draw-polygon-fill-static",type:"fill",filter:["all",["==","mode","static"],["==","$type","Polygon"]],paint:{"fill-color":"#404040","fill-outline-color":"#404040","fill-opacity":.1}},{id:"gl-draw-polygon-stroke-static",type:"line",filter:["all",["==","mode","static"],["==","$type","Polygon"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#404040","line-width":2}},{id:"gl-draw-line-static",type:"line",filter:["all",["==","mode","static"],["==","$type","LineString"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#404040","line-width":2}},{id:"gl-draw-point-static",type:"circle",filter:["all",["==","mode","static"],["==","$type","Point"]],paint:{"circle-radius":5,"circle-color":"#404040"}}];function wr(J){return function(pe){var Xe=pe.featureTarget;return!!Xe&&!!Xe.properties&&Xe.properties.meta===J}}function er(J){return!!J.originalEvent&&!!J.originalEvent.shiftKey&&J.originalEvent.button===0}function lr(J){return!!J.featureTarget&&!!J.featureTarget.properties&&J.featureTarget.properties.active===M.ACTIVE&&J.featureTarget.properties.meta===O.FEATURE}function Ar(J){return!!J.featureTarget&&!!J.featureTarget.properties&&J.featureTarget.properties.active===M.INACTIVE&&J.featureTarget.properties.meta===O.FEATURE}function ir(J){return J.featureTarget===void 0}function nt(J){return!!J.featureTarget&&!!J.featureTarget.properties&&J.featureTarget.properties.meta===O.FEATURE}function _e(J){var pe=J.featureTarget;return!!pe&&!!pe.properties&&pe.properties.meta===O.VERTEX}function be(J){return!!J.originalEvent&&J.originalEvent.shiftKey===!0}function qe(J){return J.keyCode===27}function Qe(J){return J.keyCode===13}var ot=Object.freeze({__proto__:null,isOfMetaType:wr,isShiftMousedown:er,isActiveFeature:lr,isInactiveFeature:Ar,noTarget:ir,isFeature:nt,isVertex:_e,isShiftDown:be,isEscapeKey:qe,isEnterKey:Qe,isTrue:function(){return!0}}),et=Lt;function Lt(J,pe){this.x=J,this.y=pe}Lt.prototype={clone:function(){return new Lt(this.x,this.y)},add:function(J){return this.clone()._add(J)},sub:function(J){return this.clone()._sub(J)},multByPoint:function(J){return this.clone()._multByPoint(J)},divByPoint:function(J){return this.clone()._divByPoint(J)},mult:function(J){return this.clone()._mult(J)},div:function(J){return this.clone()._div(J)},rotate:function(J){return this.clone()._rotate(J)},rotateAround:function(J,pe){return this.clone()._rotateAround(J,pe)},matMult:function(J){return this.clone()._matMult(J)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(J){return this.x===J.x&&this.y===J.y},dist:function(J){return Math.sqrt(this.distSqr(J))},distSqr:function(J){var pe=J.x-this.x,Xe=J.y-this.y;return pe*pe+Xe*Xe},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(J){return Math.atan2(this.y-J.y,this.x-J.x)},angleWith:function(J){return this.angleWithSep(J.x,J.y)},angleWithSep:function(J,pe){return Math.atan2(this.x*pe-this.y*J,this.x*J+this.y*pe)},_matMult:function(J){var pe=J[0]*this.x+J[1]*this.y,Xe=J[2]*this.x+J[3]*this.y;return this.x=pe,this.y=Xe,this},_add:function(J){return this.x+=J.x,this.y+=J.y,this},_sub:function(J){return this.x-=J.x,this.y-=J.y,this},_mult:function(J){return this.x*=J,this.y*=J,this},_div:function(J){return this.x/=J,this.y/=J,this},_multByPoint:function(J){return this.x*=J.x,this.y*=J.y,this},_divByPoint:function(J){return this.x/=J.x,this.y/=J.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var J=this.y;return this.y=this.x,this.x=-J,this},_rotate:function(J){var pe=Math.cos(J),Xe=Math.sin(J),Tt=pe*this.x-Xe*this.y,Nt=Xe*this.x+pe*this.y;return this.x=Tt,this.y=Nt,this},_rotateAround:function(J,pe){var Xe=Math.cos(J),Tt=Math.sin(J),Nt=pe.x+Xe*(this.x-pe.x)-Tt*(this.y-pe.y),kt=pe.y+Tt*(this.x-pe.x)+Xe*(this.y-pe.y);return this.x=Nt,this.y=kt,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},Lt.convert=function(J){return J instanceof Lt?J:Array.isArray(J)?new Lt(J[0],J[1]):J};var _t=n(et);function jt(J,pe){var Xe=pe.getBoundingClientRect();return new _t(J.clientX-Xe.left-(pe.clientLeft||0),J.clientY-Xe.top-(pe.clientTop||0))}function Jt(J,pe,Xe,Tt){return{type:E.FEATURE,properties:{meta:O.VERTEX,parent:J,coord_path:Xe,active:Tt?M.ACTIVE:M.INACTIVE},geometry:{type:E.POINT,coordinates:pe}}}function Kt(J,pe,Xe){var Tt=pe.geometry.coordinates,Nt=Xe.geometry.coordinates;if(Tt[1]>85||Tt[1]<B||Nt[1]>85||Nt[1]<B)return null;var kt={lng:(Tt[0]+Nt[0])/2,lat:(Tt[1]+Nt[1])/2};return{type:E.FEATURE,properties:{meta:O.MIDPOINT,parent:J,lng:kt.lng,lat:kt.lat,coord_path:Xe.properties.coord_path},geometry:{type:E.POINT,coordinates:[kt.lng,kt.lat]}}}function Rr(J,pe,Xe){pe===void 0&&(pe={}),Xe===void 0&&(Xe=null);var Tt,Nt=J.geometry,kt=Nt.type,Gt=Nt.coordinates,$r=J.properties&&J.properties.id,Yr=[];function Hr(Qr,Qn){var Ei="",En=null;Qr.forEach((function(pn,Mr){var cn=Qn!=null?Qn+"."+Mr:String(Mr),Wn=Jt($r,pn,cn,kr(cn));if(pe.midpoints&&En){var Ma=Kt($r,En,Wn);Ma&&Yr.push(Ma)}En=Wn;var Ci=JSON.stringify(pn);Ei!==Ci&&Yr.push(Wn),Mr===0&&(Ei=Ci)}))}function kr(Qr){return!!pe.selectedPaths&&pe.selectedPaths.indexOf(Qr)!==-1}return kt===E.POINT?Yr.push(Jt($r,Gt,Xe,kr(Xe))):kt===E.POLYGON?Gt.forEach((function(Qr,Qn){Hr(Qr,Xe!==null?Xe+"."+Qn:String(Qn))})):kt===E.LINE_STRING?Hr(Gt,Xe):kt.indexOf(E.MULTI_PREFIX)===0&&(Tt=kt.replace(E.MULTI_PREFIX,""),Gt.forEach((function(Qr,Qn){var Ei={type:E.FEATURE,properties:J.properties,geometry:{type:Tt,coordinates:Qr}};Yr=Yr.concat(Rr(Ei,pe,Qn))}))),Yr}var bt={enable:function(J){setTimeout((function(){J.map&&J.map.doubleClickZoom&&J._ctx&&J._ctx.store&&J._ctx.store.getInitialConfigValue&&J._ctx.store.getInitialConfigValue("doubleClickZoom")&&J.map.doubleClickZoom.enable()}),0)},disable:function(J){setTimeout((function(){J.map&&J.map.doubleClickZoom&&J.map.doubleClickZoom.disable()}),0)}},Tr={exports:{}},Ur=function(J){if(!J||!J.type)return null;var pe=Gr[J.type];if(!pe)return null;if(pe==="geometry")return{type:"FeatureCollection",features:[{type:"Feature",properties:{},geometry:J}]};if(pe==="feature")return{type:"FeatureCollection",features:[J]};if(pe==="featurecollection")return J},Gr={Point:"geometry",MultiPoint:"geometry",LineString:"geometry",MultiLineString:"geometry",Polygon:"geometry",MultiPolygon:"geometry",GeometryCollection:"geometry",Feature:"feature",FeatureCollection:"featurecollection"},Jr=n(Ur),ar=Object.freeze({__proto__:null,default:function J(pe){switch(pe&&pe.type||null){case"FeatureCollection":return pe.features=pe.features.reduce((function(Xe,Tt){return Xe.concat(J(Tt))}),[]),pe;case"Feature":return pe.geometry?J(pe.geometry).map((function(Xe){var Tt={type:"Feature",properties:JSON.parse(JSON.stringify(pe.properties)),geometry:Xe};return pe.id!==void 0&&(Tt.id=pe.id),Tt})):[pe];case"MultiPoint":return pe.coordinates.map((function(Xe){return{type:"Point",coordinates:Xe}}));case"MultiPolygon":return pe.coordinates.map((function(Xe){return{type:"Polygon",coordinates:Xe}}));case"MultiLineString":return pe.coordinates.map((function(Xe){return{type:"LineString",coordinates:Xe}}));case"GeometryCollection":return pe.geometries.map(J).reduce((function(Xe,Tt){return Xe.concat(Tt)}),[]);case"Point":case"Polygon":case"LineString":return[pe]}}}),ti=Ur,un=i(ar),ri=function(J){return(function pe(Xe){return Array.isArray(Xe)&&Xe.length&&typeof Xe[0]=="number"?[Xe]:Xe.reduce((function(Tt,Nt){return Array.isArray(Nt)&&Array.isArray(Nt[0])?Tt.concat(pe(Nt)):(Tt.push(Nt),Tt)}),[])})(J)};un instanceof Function||(un=un.default);var Ae={exports:{}},Be=Ae.exports=function(J){return new mt(J)};function mt(J){this.value=J}function pt(J,pe,Xe){var Tt=[],Nt=[],kt=!0;return(function Gt($r){var Yr=Xe?Ir($r):$r,Hr={},kr=!0,Qr={node:Yr,node_:$r,path:[].concat(Tt),parent:Nt[Nt.length-1],parents:Nt,key:Tt.slice(-1)[0],isRoot:Tt.length===0,level:Tt.length,circular:null,update:function(En,pn){Qr.isRoot||(Qr.parent.node[Qr.key]=En),Qr.node=En,pn&&(kr=!1)},delete:function(En){delete Qr.parent.node[Qr.key],En&&(kr=!1)},remove:function(En){Oi(Qr.parent.node)?Qr.parent.node.splice(Qr.key,1):delete Qr.parent.node[Qr.key],En&&(kr=!1)},keys:null,before:function(En){Hr.before=En},after:function(En){Hr.after=En},pre:function(En){Hr.pre=En},post:function(En){Hr.post=En},stop:function(){kt=!1},block:function(){kr=!1}};if(!kt)return Qr;function Qn(){if(typeof Qr.node=="object"&&Qr.node!==null){Qr.keys&&Qr.node_===Qr.node||(Qr.keys=Fr(Qr.node)),Qr.isLeaf=Qr.keys.length==0;for(var En=0;En<Nt.length;En++)if(Nt[En].node_===$r){Qr.circular=Nt[En];break}}else Qr.isLeaf=!0,Qr.keys=null;Qr.notLeaf=!Qr.isLeaf,Qr.notRoot=!Qr.isRoot}Qn();var Ei=pe.call(Qr,Qr.node);return Ei!==void 0&&Qr.update&&Qr.update(Ei),Hr.before&&Hr.before.call(Qr,Qr.node),kr&&(typeof Qr.node!="object"||Qr.node===null||Qr.circular||(Nt.push(Qr),Qn(),zr(Qr.keys,(function(En,pn){Tt.push(En),Hr.pre&&Hr.pre.call(Qr,Qr.node[En],En);var Mr=Gt(Qr.node[En]);Xe&&bn.call(Qr.node,En)&&(Qr.node[En]=Mr.node),Mr.isLast=pn==Qr.keys.length-1,Mr.isFirst=pn==0,Hr.post&&Hr.post.call(Qr,Mr),Tt.pop()})),Nt.pop()),Hr.after&&Hr.after.call(Qr,Qr.node)),Qr})(J).node}function Ir(J){if(typeof J=="object"&&J!==null){var pe;if(Oi(J))pe=[];else if(qn(J)==="[object Date]")pe=new Date(J.getTime?J.getTime():J);else if((function(Nt){return qn(Nt)==="[object RegExp]"})(J))pe=new RegExp(J);else if((function(Nt){return qn(Nt)==="[object Error]"})(J))pe={message:J.message};else if((function(Nt){return qn(Nt)==="[object Boolean]"})(J))pe=new Boolean(J);else if((function(Nt){return qn(Nt)==="[object Number]"})(J))pe=new Number(J);else if((function(Nt){return qn(Nt)==="[object String]"})(J))pe=new String(J);else if(Object.create&&Object.getPrototypeOf)pe=Object.create(Object.getPrototypeOf(J));else if(J.constructor===Object)pe={};else{var Xe=J.constructor&&J.constructor.prototype||J.__proto__||{},Tt=function(){};Tt.prototype=Xe,pe=new Tt}return zr(Fr(J),(function(Nt){pe[Nt]=J[Nt]})),pe}return J}mt.prototype.get=function(J){for(var pe=this.value,Xe=0;Xe<J.length;Xe++){var Tt=J[Xe];if(!pe||!bn.call(pe,Tt)){pe=void 0;break}pe=pe[Tt]}return pe},mt.prototype.has=function(J){for(var pe=this.value,Xe=0;Xe<J.length;Xe++){var Tt=J[Xe];if(!pe||!bn.call(pe,Tt))return!1;pe=pe[Tt]}return!0},mt.prototype.set=function(J,pe){for(var Xe=this.value,Tt=0;Tt<J.length-1;Tt++){var Nt=J[Tt];bn.call(Xe,Nt)||(Xe[Nt]={}),Xe=Xe[Nt]}return Xe[J[Tt]]=pe,pe},mt.prototype.map=function(J){return pt(this.value,J,!0)},mt.prototype.forEach=function(J){return this.value=pt(this.value,J,!1),this.value},mt.prototype.reduce=function(J,pe){var Xe=arguments.length===1,Tt=Xe?this.value:pe;return this.forEach((function(Nt){this.isRoot&&Xe||(Tt=J.call(this,Tt,Nt))})),Tt},mt.prototype.paths=function(){var J=[];return this.forEach((function(pe){J.push(this.path)})),J},mt.prototype.nodes=function(){var J=[];return this.forEach((function(pe){J.push(this.node)})),J},mt.prototype.clone=function(){var J=[],pe=[];return(function Xe(Tt){for(var Nt=0;Nt<J.length;Nt++)if(J[Nt]===Tt)return pe[Nt];if(typeof Tt=="object"&&Tt!==null){var kt=Ir(Tt);return J.push(Tt),pe.push(kt),zr(Fr(Tt),(function(Gt){kt[Gt]=Xe(Tt[Gt])})),J.pop(),pe.pop(),kt}return Tt})(this.value)};var Fr=Object.keys||function(J){var pe=[];for(var Xe in J)pe.push(Xe);return pe};function qn(J){return Object.prototype.toString.call(J)}var Oi=Array.isArray||function(J){return Object.prototype.toString.call(J)==="[object Array]"},zr=function(J,pe){if(J.forEach)return J.forEach(pe);for(var Xe=0;Xe<J.length;Xe++)pe(J[Xe],Xe,J)};zr(Fr(mt.prototype),(function(J){Be[J]=function(pe){var Xe=[].slice.call(arguments,1),Tt=new mt(pe);return Tt[J].apply(Tt,Xe)}}));var bn=Object.hasOwnProperty||function(J,pe){return pe in J},Tn=Ae.exports,Mi=pi;function pi(J){if(!(this instanceof pi))return new pi(J);this._bbox=J||[1/0,1/0,-1/0,-1/0],this._valid=!!J}pi.prototype.include=function(J){return this._valid=!0,this._bbox[0]=Math.min(this._bbox[0],J[0]),this._bbox[1]=Math.min(this._bbox[1],J[1]),this._bbox[2]=Math.max(this._bbox[2],J[0]),this._bbox[3]=Math.max(this._bbox[3],J[1]),this},pi.prototype.equals=function(J){var pe;return pe=J instanceof pi?J.bbox():J,this._bbox[0]==pe[0]&&this._bbox[1]==pe[1]&&this._bbox[2]==pe[2]&&this._bbox[3]==pe[3]},pi.prototype.center=function(J){return this._valid?[(this._bbox[0]+this._bbox[2])/2,(this._bbox[1]+this._bbox[3])/2]:null},pi.prototype.union=function(J){var pe;return this._valid=!0,pe=J instanceof pi?J.bbox():J,this._bbox[0]=Math.min(this._bbox[0],pe[0]),this._bbox[1]=Math.min(this._bbox[1],pe[1]),this._bbox[2]=Math.max(this._bbox[2],pe[2]),this._bbox[3]=Math.max(this._bbox[3],pe[3]),this},pi.prototype.bbox=function(){return this._valid?this._bbox:null},pi.prototype.contains=function(J){if(!J)return this._fastContains();if(!this._valid)return null;var pe=J[0],Xe=J[1];return this._bbox[0]<=pe&&this._bbox[1]<=Xe&&this._bbox[2]>=pe&&this._bbox[3]>=Xe},pi.prototype.intersect=function(J){return this._valid?(pe=J instanceof pi?J.bbox():J,!(this._bbox[0]>pe[2]||this._bbox[2]<pe[0]||this._bbox[3]<pe[1]||this._bbox[1]>pe[3])):null;var pe},pi.prototype._fastContains=function(){if(!this._valid)return new Function("return null;");var J="return "+this._bbox[0]+"<= ll[0] &&"+this._bbox[1]+"<= ll[1] &&"+this._bbox[2]+">= ll[0] &&"+this._bbox[3]+">= ll[1]";return new Function("ll",J)},pi.prototype.polygon=function(){return this._valid?{type:"Polygon",coordinates:[[[this._bbox[0],this._bbox[1]],[this._bbox[2],this._bbox[1]],[this._bbox[2],this._bbox[3]],[this._bbox[0],this._bbox[3]],[this._bbox[0],this._bbox[1]]]]}:null};var Wi=function(J){if(!J)return[];var pe=un(ti(J)),Xe=[];return pe.features.forEach((function(Tt){Tt.geometry&&(Xe=Xe.concat(ri(Tt.geometry.coordinates)))})),Xe},Fn=Tn,Ia=Mi,ma={features:["FeatureCollection"],coordinates:["Point","MultiPoint","LineString","MultiLineString","Polygon","MultiPolygon"],geometry:["Feature"],geometries:["GeometryCollection"]},Gi=Object.keys(ma);function Ka(J){for(var pe=Ia(),Xe=Wi(J),Tt=0;Tt<Xe.length;Tt++)pe.include(Xe[Tt]);return pe}Tr.exports=function(J){return Ka(J).bbox()},Tr.exports.polygon=function(J){return Ka(J).polygon()},Tr.exports.bboxify=function(J){return Fn(J).map((function(pe){pe&&Gi.some((function(Xe){return!!pe[Xe]&&ma[Xe].indexOf(pe.type)!==-1}))&&(pe.bbox=Ka(pe).bbox(),this.update(pe))}))};var xa=n(Tr.exports),Ui=-90;function oo(J,pe){var Xe=Ui,Tt=90,Nt=Ui,kt=90,Gt=270,$r=-270;J.forEach((function(Hr){var kr=xa(Hr),Qr=kr[1],Qn=kr[3],Ei=kr[0],En=kr[2];Qr>Xe&&(Xe=Qr),Qn<Tt&&(Tt=Qn),Qn>Nt&&(Nt=Qn),Qr<kt&&(kt=Qr),Ei<Gt&&(Gt=Ei),En>$r&&($r=En)}));var Yr=pe;return Xe+Yr.lat>85&&(Yr.lat=85-Xe),Nt+Yr.lat>90&&(Yr.lat=90-Nt),Tt+Yr.lat<-85&&(Yr.lat=-85-Tt),kt+Yr.lat<Ui&&(Yr.lat=Ui-kt),Gt+Yr.lng<=-270&&(Yr.lng+=360*Math.ceil(Math.abs(Yr.lng)/360)),$r+Yr.lng>=270&&(Yr.lng-=360*Math.ceil(Math.abs(Yr.lng)/360)),Yr}function Ja(J,pe){var Xe=oo(J.map((function(Tt){return Tt.toGeoJSON()})),pe);J.forEach((function(Tt){var Nt,kt=Tt.getCoordinates(),Gt=function(Yr){var Hr={lng:Yr[0]+Xe.lng,lat:Yr[1]+Xe.lat};return[Hr.lng,Hr.lat]},$r=function(Yr){return Yr.map((function(Hr){return Gt(Hr)}))};Tt.type===E.POINT?Nt=Gt(kt):Tt.type===E.LINE_STRING||Tt.type===E.MULTI_POINT?Nt=kt.map(Gt):Tt.type===E.POLYGON||Tt.type===E.MULTI_LINE_STRING?Nt=kt.map($r):Tt.type===E.MULTI_POLYGON&&(Nt=kt.map((function(Yr){return Yr.map((function(Hr){return $r(Hr)}))}))),Tt.incomingCoords(Nt)}))}var Hn={onSetup:function(J){var pe=this,Xe={dragMoveLocation:null,boxSelectStartLocation:null,boxSelectElement:void 0,boxSelecting:!1,canBoxSelect:!1,dragMoving:!1,canDragMove:!1,initiallySelectedFeatureIds:J.featureIds||[]};return this.setSelected(Xe.initiallySelectedFeatureIds.filter((function(Tt){return pe.getFeature(Tt)!==void 0}))),this.fireActionable(),this.setActionableState({combineFeatures:!0,uncombineFeatures:!0,trash:!0}),Xe},fireUpdate:function(){this.map.fire(k.UPDATE,{action:L.MOVE,features:this.getSelected().map((function(J){return J.toGeoJSON()}))})},fireActionable:function(){var J=this,pe=this.getSelected(),Xe=pe.filter((function($r){return J.isInstanceOf("MultiFeature",$r)})),Tt=!1;if(pe.length>1){Tt=!0;var Nt=pe[0].type.replace("Multi","");pe.forEach((function($r){$r.type.replace("Multi","")!==Nt&&(Tt=!1)}))}var kt=Xe.length>0,Gt=pe.length>0;this.setActionableState({combineFeatures:Tt,uncombineFeatures:kt,trash:Gt})},getUniqueIds:function(J){return J.length?J.map((function(pe){return pe.properties.id})).filter((function(pe){return pe!==void 0})).reduce((function(pe,Xe){return pe.add(Xe),pe}),new H).values():[]},stopExtendedInteractions:function(J){J.boxSelectElement&&(J.boxSelectElement.parentNode&&J.boxSelectElement.parentNode.removeChild(J.boxSelectElement),J.boxSelectElement=null),this.map.dragPan.enable(),J.boxSelecting=!1,J.canBoxSelect=!1,J.dragMoving=!1,J.canDragMove=!1},onStop:function(){bt.enable(this)},onMouseMove:function(J,pe){return nt(pe)&&J.dragMoving&&this.fireUpdate(),this.stopExtendedInteractions(J),!0},onMouseOut:function(J){return!J.dragMoving||this.fireUpdate()}};Hn.onTap=Hn.onClick=function(J,pe){return ir(pe)?this.clickAnywhere(J,pe):wr(O.VERTEX)(pe)?this.clickOnVertex(J,pe):nt(pe)?this.clickOnFeature(J,pe):void 0},Hn.clickAnywhere=function(J){var pe=this,Xe=this.getSelectedIds();Xe.length&&(this.clearSelectedFeatures(),Xe.forEach((function(Tt){return pe.doRender(Tt)}))),bt.enable(this),this.stopExtendedInteractions(J)},Hn.clickOnVertex=function(J,pe){this.changeMode(P.DIRECT_SELECT,{featureId:pe.featureTarget.properties.parent,coordPath:pe.featureTarget.properties.coord_path,startPos:pe.lngLat}),this.updateUIClasses({mouse:v.MOVE})},Hn.startOnActiveFeature=function(J,pe){this.stopExtendedInteractions(J),this.map.dragPan.disable(),this.doRender(pe.featureTarget.properties.id),J.canDragMove=!0,J.dragMoveLocation=pe.lngLat},Hn.clickOnFeature=function(J,pe){var Xe=this;bt.disable(this),this.stopExtendedInteractions(J);var Tt=be(pe),Nt=this.getSelectedIds(),kt=pe.featureTarget.properties.id,Gt=this.isSelected(kt);if(!Tt&&Gt&&this.getFeature(kt).type!==E.POINT)return this.changeMode(P.DIRECT_SELECT,{featureId:kt});Gt&&Tt?(this.deselect(kt),this.updateUIClasses({mouse:v.POINTER}),Nt.length===1&&bt.enable(this)):!Gt&&Tt?(this.select(kt),this.updateUIClasses({mouse:v.MOVE})):Gt||Tt||(Nt.forEach((function($r){return Xe.doRender($r)})),this.setSelected(kt),this.updateUIClasses({mouse:v.MOVE})),this.doRender(kt)},Hn.onMouseDown=function(J,pe){return lr(pe)?this.startOnActiveFeature(J,pe):this.drawConfig.boxSelect&&er(pe)?this.startBoxSelect(J,pe):void 0},Hn.startBoxSelect=function(J,pe){this.stopExtendedInteractions(J),this.map.dragPan.disable(),J.boxSelectStartLocation=jt(pe.originalEvent,this.map.getContainer()),J.canBoxSelect=!0},Hn.onTouchStart=function(J,pe){if(lr(pe))return this.startOnActiveFeature(J,pe)},Hn.onDrag=function(J,pe){return J.canDragMove?this.dragMove(J,pe):this.drawConfig.boxSelect&&J.canBoxSelect?this.whileBoxSelect(J,pe):void 0},Hn.whileBoxSelect=function(J,pe){J.boxSelecting=!0,this.updateUIClasses({mouse:v.ADD}),J.boxSelectElement||(J.boxSelectElement=document.createElement("div"),J.boxSelectElement.classList.add(g.BOX_SELECT),this.map.getContainer().appendChild(J.boxSelectElement));var Xe=jt(pe.originalEvent,this.map.getContainer()),Tt=Math.min(J.boxSelectStartLocation.x,Xe.x),Nt=Math.max(J.boxSelectStartLocation.x,Xe.x),kt=Math.min(J.boxSelectStartLocation.y,Xe.y),Gt=Math.max(J.boxSelectStartLocation.y,Xe.y),$r="translate("+Tt+"px, "+kt+"px)";J.boxSelectElement.style.transform=$r,J.boxSelectElement.style.WebkitTransform=$r,J.boxSelectElement.style.width=Nt-Tt+"px",J.boxSelectElement.style.height=Gt-kt+"px"},Hn.dragMove=function(J,pe){J.dragMoving=!0,pe.originalEvent.stopPropagation();var Xe={lng:pe.lngLat.lng-J.dragMoveLocation.lng,lat:pe.lngLat.lat-J.dragMoveLocation.lat};Ja(this.getSelected(),Xe),J.dragMoveLocation=pe.lngLat},Hn.onTouchEnd=Hn.onMouseUp=function(J,pe){var Xe=this;if(J.dragMoving)this.fireUpdate();else if(J.boxSelecting){var Tt=[J.boxSelectStartLocation,jt(pe.originalEvent,this.map.getContainer())],Nt=this.featuresAt(null,Tt,"click"),kt=this.getUniqueIds(Nt).filter((function(Gt){return!Xe.isSelected(Gt)}));kt.length&&(this.select(kt),kt.forEach((function(Gt){return Xe.doRender(Gt)})),this.updateUIClasses({mouse:v.MOVE}))}this.stopExtendedInteractions(J)},Hn.toDisplayFeatures=function(J,pe,Xe){pe.properties.active=this.isSelected(pe.properties.id)?M.ACTIVE:M.INACTIVE,Xe(pe),this.fireActionable(),pe.properties.active===M.ACTIVE&&pe.geometry.type!==E.POINT&&Rr(pe).forEach(Xe)},Hn.onTrash=function(){this.deleteFeature(this.getSelectedIds()),this.fireActionable()},Hn.onCombineFeatures=function(){var J=this.getSelected();if(!(J.length===0||J.length<2)){for(var pe=[],Xe=[],Tt=J[0].type.replace("Multi",""),Nt=0;Nt<J.length;Nt++){var kt=J[Nt];if(kt.type.replace("Multi","")!==Tt)return;kt.type.includes("Multi")?kt.getCoordinates().forEach((function($r){pe.push($r)})):pe.push(kt.getCoordinates()),Xe.push(kt.toGeoJSON())}if(Xe.length>1){var Gt=this.newFeature({type:E.FEATURE,properties:Xe[0].properties,geometry:{type:"Multi"+Tt,coordinates:pe}});this.addFeature(Gt),this.deleteFeature(this.getSelectedIds(),{silent:!0}),this.setSelected([Gt.id]),this.map.fire(k.COMBINE_FEATURES,{createdFeatures:[Gt.toGeoJSON()],deletedFeatures:Xe})}this.fireActionable()}},Hn.onUncombineFeatures=function(){var J=this,pe=this.getSelected();if(pe.length!==0){for(var Xe=[],Tt=[],Nt=function(Gt){var $r=pe[Gt];J.isInstanceOf("MultiFeature",$r)&&($r.getFeatures().forEach((function(Yr){J.addFeature(Yr),Yr.properties=$r.properties,Xe.push(Yr.toGeoJSON()),J.select([Yr.id])})),J.deleteFeature($r.id,{silent:!0}),Tt.push($r.toGeoJSON()))},kt=0;kt<pe.length;kt++)Nt(kt);Xe.length>1&&this.map.fire(k.UNCOMBINE_FEATURES,{createdFeatures:Xe,deletedFeatures:Tt}),this.fireActionable()}};var bu=wr(O.VERTEX),ru=wr(O.MIDPOINT),Pa={fireUpdate:function(){this.map.fire(k.UPDATE,{action:L.CHANGE_COORDINATES,features:this.getSelected().map((function(J){return J.toGeoJSON()}))})},fireActionable:function(J){this.setActionableState({combineFeatures:!1,uncombineFeatures:!1,trash:J.selectedCoordPaths.length>0})},startDragging:function(J,pe){this.map.dragPan.disable(),J.canDragMove=!0,J.dragMoveLocation=pe.lngLat},stopDragging:function(J){this.map.dragPan.enable(),J.dragMoving=!1,J.canDragMove=!1,J.dragMoveLocation=null},onVertex:function(J,pe){this.startDragging(J,pe);var Xe=pe.featureTarget.properties,Tt=J.selectedCoordPaths.indexOf(Xe.coord_path);be(pe)||Tt!==-1?be(pe)&&Tt===-1&&J.selectedCoordPaths.push(Xe.coord_path):J.selectedCoordPaths=[Xe.coord_path];var Nt=this.pathsToCoordinates(J.featureId,J.selectedCoordPaths);this.setSelectedCoordinates(Nt)},onMidpoint:function(J,pe){this.startDragging(J,pe);var Xe=pe.featureTarget.properties;J.feature.addCoordinate(Xe.coord_path,Xe.lng,Xe.lat),this.fireUpdate(),J.selectedCoordPaths=[Xe.coord_path]},pathsToCoordinates:function(J,pe){return pe.map((function(Xe){return{feature_id:J,coord_path:Xe}}))},onFeature:function(J,pe){J.selectedCoordPaths.length===0?this.startDragging(J,pe):this.stopDragging(J)},dragFeature:function(J,pe,Xe){Ja(this.getSelected(),Xe),J.dragMoveLocation=pe.lngLat},dragVertex:function(J,pe,Xe){for(var Tt=J.selectedCoordPaths.map((function($r){return J.feature.getCoordinate($r)})),Nt=oo(Tt.map((function($r){return{type:E.FEATURE,properties:{},geometry:{type:E.POINT,coordinates:$r}}})),Xe),kt=0;kt<Tt.length;kt++){var Gt=Tt[kt];J.feature.updateCoordinate(J.selectedCoordPaths[kt],Gt[0]+Nt.lng,Gt[1]+Nt.lat)}},clickNoTarget:function(){this.changeMode(P.SIMPLE_SELECT)},clickInactive:function(){this.changeMode(P.SIMPLE_SELECT)},clickActiveFeature:function(J){J.selectedCoordPaths=[],this.clearSelectedCoordinates(),J.feature.changed()},onSetup:function(J){var pe=J.featureId,Xe=this.getFeature(pe);if(!Xe)throw new Error("You must provide a featureId to enter direct_select mode");if(Xe.type===E.POINT)throw new TypeError("direct_select mode doesn't handle point features");var Tt={featureId:pe,feature:Xe,dragMoveLocation:J.startPos||null,dragMoving:!1,canDragMove:!1,selectedCoordPaths:J.coordPath?[J.coordPath]:[]};return this.setSelectedCoordinates(this.pathsToCoordinates(pe,Tt.selectedCoordPaths)),this.setSelected(pe),bt.disable(this),this.setActionableState({trash:!0}),Tt},onStop:function(){bt.enable(this),this.clearSelectedCoordinates()},toDisplayFeatures:function(J,pe,Xe){J.featureId===pe.properties.id?(pe.properties.active=M.ACTIVE,Xe(pe),Rr(pe,{map:this.map,midpoints:!0,selectedPaths:J.selectedCoordPaths}).forEach(Xe)):(pe.properties.active=M.INACTIVE,Xe(pe)),this.fireActionable(J)},onTrash:function(J){J.selectedCoordPaths.sort((function(pe,Xe){return Xe.localeCompare(pe,"en",{numeric:!0})})).forEach((function(pe){return J.feature.removeCoordinate(pe)})),this.fireUpdate(),J.selectedCoordPaths=[],this.clearSelectedCoordinates(),this.fireActionable(J),J.feature.isValid()===!1&&(this.deleteFeature([J.featureId]),this.changeMode(P.SIMPLE_SELECT,{}))},onMouseMove:function(J,pe){var Xe=lr(pe),Tt=bu(pe),Nt=ru(pe),kt=J.selectedCoordPaths.length===0;return Xe&&kt||Tt&&!kt?this.updateUIClasses({mouse:v.MOVE}):this.updateUIClasses({mouse:v.NONE}),(Tt||Xe||Nt)&&J.dragMoving&&this.fireUpdate(),this.stopDragging(J),!0},onMouseOut:function(J){return J.dragMoving&&this.fireUpdate(),!0}};Pa.onTouchStart=Pa.onMouseDown=function(J,pe){return bu(pe)?this.onVertex(J,pe):lr(pe)?this.onFeature(J,pe):ru(pe)?this.onMidpoint(J,pe):void 0},Pa.onDrag=function(J,pe){if(J.canDragMove===!0){J.dragMoving=!0,pe.originalEvent.stopPropagation();var Xe={lng:pe.lngLat.lng-J.dragMoveLocation.lng,lat:pe.lngLat.lat-J.dragMoveLocation.lat};J.selectedCoordPaths.length>0?this.dragVertex(J,pe,Xe):this.dragFeature(J,pe,Xe),J.dragMoveLocation=pe.lngLat}},Pa.onClick=function(J,pe){return ir(pe)?this.clickNoTarget(J,pe):lr(pe)?this.clickActiveFeature(J,pe):Ar(pe)?this.clickInactive(J,pe):void this.stopDragging(J)},Pa.onTap=function(J,pe){return ir(pe)?this.clickNoTarget(J,pe):lr(pe)?this.clickActiveFeature(J,pe):Ar(pe)?this.clickInactive(J,pe):void 0},Pa.onTouchEnd=Pa.onMouseUp=function(J){J.dragMoving&&this.fireUpdate(),this.stopDragging(J)};var wa={};function Wo(J,pe){return!!J.lngLat&&J.lngLat.lng===pe[0]&&J.lngLat.lat===pe[1]}wa.onSetup=function(){var J=this.newFeature({type:E.FEATURE,properties:{},geometry:{type:E.POINT,coordinates:[]}});return this.addFeature(J),this.clearSelectedFeatures(),this.updateUIClasses({mouse:v.ADD}),this.activateUIButton(S.POINT),this.setActionableState({trash:!0}),{point:J}},wa.stopDrawingAndRemove=function(J){this.deleteFeature([J.point.id],{silent:!0}),this.changeMode(P.SIMPLE_SELECT)},wa.onTap=wa.onClick=function(J,pe){this.updateUIClasses({mouse:v.MOVE}),J.point.updateCoordinate("",pe.lngLat.lng,pe.lngLat.lat),this.map.fire(k.CREATE,{features:[J.point.toGeoJSON()]}),this.changeMode(P.SIMPLE_SELECT,{featureIds:[J.point.id]})},wa.onStop=function(J){this.activateUIButton(),J.point.getCoordinate().length||this.deleteFeature([J.point.id],{silent:!0})},wa.toDisplayFeatures=function(J,pe,Xe){var Tt=pe.properties.id===J.point.id;if(pe.properties.active=Tt?M.ACTIVE:M.INACTIVE,!Tt)return Xe(pe)},wa.onTrash=wa.stopDrawingAndRemove,wa.onKeyUp=function(J,pe){if(qe(pe)||Qe(pe))return this.stopDrawingAndRemove(J,pe)};var No={onSetup:function(){var J=this.newFeature({type:E.FEATURE,properties:{},geometry:{type:E.POLYGON,coordinates:[[]]}});return this.addFeature(J),this.clearSelectedFeatures(),bt.disable(this),this.updateUIClasses({mouse:v.ADD}),this.activateUIButton(S.POLYGON),this.setActionableState({trash:!0}),{polygon:J,currentVertexPosition:0}},clickAnywhere:function(J,pe){if(J.currentVertexPosition>0&&Wo(pe,J.polygon.coordinates[0][J.currentVertexPosition-1]))return this.changeMode(P.SIMPLE_SELECT,{featureIds:[J.polygon.id]});this.updateUIClasses({mouse:v.ADD}),J.polygon.updateCoordinate("0."+J.currentVertexPosition,pe.lngLat.lng,pe.lngLat.lat),J.currentVertexPosition++,J.polygon.updateCoordinate("0."+J.currentVertexPosition,pe.lngLat.lng,pe.lngLat.lat)},clickOnVertex:function(J){return this.changeMode(P.SIMPLE_SELECT,{featureIds:[J.polygon.id]})},onMouseMove:function(J,pe){J.polygon.updateCoordinate("0."+J.currentVertexPosition,pe.lngLat.lng,pe.lngLat.lat),_e(pe)&&this.updateUIClasses({mouse:v.POINTER})}};No.onTap=No.onClick=function(J,pe){return _e(pe)?this.clickOnVertex(J,pe):this.clickAnywhere(J,pe)},No.onKeyUp=function(J,pe){qe(pe)?(this.deleteFeature([J.polygon.id],{silent:!0}),this.changeMode(P.SIMPLE_SELECT)):Qe(pe)&&this.changeMode(P.SIMPLE_SELECT,{featureIds:[J.polygon.id]})},No.onStop=function(J){this.updateUIClasses({mouse:v.NONE}),bt.enable(this),this.activateUIButton(),this.getFeature(J.polygon.id)!==void 0&&(J.polygon.removeCoordinate("0."+J.currentVertexPosition),J.polygon.isValid()?this.map.fire(k.CREATE,{features:[J.polygon.toGeoJSON()]}):(this.deleteFeature([J.polygon.id],{silent:!0}),this.changeMode(P.SIMPLE_SELECT,{},{silent:!0})))},No.toDisplayFeatures=function(J,pe,Xe){var Tt=pe.properties.id===J.polygon.id;if(pe.properties.active=Tt?M.ACTIVE:M.INACTIVE,!Tt)return Xe(pe);if(pe.geometry.coordinates.length!==0){var Nt=pe.geometry.coordinates[0].length;if(!(Nt<3)){if(pe.properties.meta=O.FEATURE,Xe(Jt(J.polygon.id,pe.geometry.coordinates[0][0],"0.0",!1)),Nt>3){var kt=pe.geometry.coordinates[0].length-3;Xe(Jt(J.polygon.id,pe.geometry.coordinates[0][kt],"0."+kt,!1))}if(Nt<=4){var Gt=[[pe.geometry.coordinates[0][0][0],pe.geometry.coordinates[0][0][1]],[pe.geometry.coordinates[0][1][0],pe.geometry.coordinates[0][1][1]]];if(Xe({type:E.FEATURE,properties:pe.properties,geometry:{coordinates:Gt,type:E.LINE_STRING}}),Nt===3)return}return Xe(pe)}}},No.onTrash=function(J){this.deleteFeature([J.polygon.id],{silent:!0}),this.changeMode(P.SIMPLE_SELECT)};var ls={onSetup:function(J){var pe,Xe,Tt=(J=J||{}).featureId,Nt="forward";if(Tt){if(!(pe=this.getFeature(Tt)))throw new Error("Could not find a feature with the provided featureId");var kt=J.from;if(kt&&kt.type==="Feature"&&kt.geometry&&kt.geometry.type==="Point"&&(kt=kt.geometry),kt&&kt.type==="Point"&&kt.coordinates&&kt.coordinates.length===2&&(kt=kt.coordinates),!kt||!Array.isArray(kt))throw new Error("Please use the `from` property to indicate which point to continue the line from");var Gt=pe.coordinates.length-1;if(pe.coordinates[Gt][0]===kt[0]&&pe.coordinates[Gt][1]===kt[1])Xe=Gt+1,pe.addCoordinate.apply(pe,[Xe].concat(pe.coordinates[Gt]));else{if(pe.coordinates[0][0]!==kt[0]||pe.coordinates[0][1]!==kt[1])throw new Error("`from` should match the point at either the start or the end of the provided LineString");Nt="backwards",Xe=0,pe.addCoordinate.apply(pe,[Xe].concat(pe.coordinates[0]))}}else pe=this.newFeature({type:E.FEATURE,properties:{},geometry:{type:E.LINE_STRING,coordinates:[]}}),Xe=0,this.addFeature(pe);return this.clearSelectedFeatures(),bt.disable(this),this.updateUIClasses({mouse:v.ADD}),this.activateUIButton(S.LINE),this.setActionableState({trash:!0}),{line:pe,currentVertexPosition:Xe,direction:Nt}},clickAnywhere:function(J,pe){if(J.currentVertexPosition>0&&Wo(pe,J.line.coordinates[J.currentVertexPosition-1])||J.direction==="backwards"&&Wo(pe,J.line.coordinates[J.currentVertexPosition+1]))return this.changeMode(P.SIMPLE_SELECT,{featureIds:[J.line.id]});this.updateUIClasses({mouse:v.ADD}),J.line.updateCoordinate(J.currentVertexPosition,pe.lngLat.lng,pe.lngLat.lat),J.direction==="forward"?(J.currentVertexPosition++,J.line.updateCoordinate(J.currentVertexPosition,pe.lngLat.lng,pe.lngLat.lat)):J.line.addCoordinate(0,pe.lngLat.lng,pe.lngLat.lat)},clickOnVertex:function(J){return this.changeMode(P.SIMPLE_SELECT,{featureIds:[J.line.id]})},onMouseMove:function(J,pe){J.line.updateCoordinate(J.currentVertexPosition,pe.lngLat.lng,pe.lngLat.lat),_e(pe)&&this.updateUIClasses({mouse:v.POINTER})}};ls.onTap=ls.onClick=function(J,pe){if(_e(pe))return this.clickOnVertex(J,pe);this.clickAnywhere(J,pe)},ls.onKeyUp=function(J,pe){Qe(pe)?this.changeMode(P.SIMPLE_SELECT,{featureIds:[J.line.id]}):qe(pe)&&(this.deleteFeature([J.line.id],{silent:!0}),this.changeMode(P.SIMPLE_SELECT))},ls.onStop=function(J){bt.enable(this),this.activateUIButton(),this.getFeature(J.line.id)!==void 0&&(J.line.removeCoordinate(""+J.currentVertexPosition),J.line.isValid()?this.map.fire(k.CREATE,{features:[J.line.toGeoJSON()]}):(this.deleteFeature([J.line.id],{silent:!0}),this.changeMode(P.SIMPLE_SELECT,{},{silent:!0})))},ls.onTrash=function(J){this.deleteFeature([J.line.id],{silent:!0}),this.changeMode(P.SIMPLE_SELECT)},ls.toDisplayFeatures=function(J,pe,Xe){var Tt=pe.properties.id===J.line.id;if(pe.properties.active=Tt?M.ACTIVE:M.INACTIVE,!Tt)return Xe(pe);pe.geometry.coordinates.length<2||(pe.properties.meta=O.FEATURE,Xe(Jt(J.line.id,pe.geometry.coordinates[J.direction==="forward"?pe.geometry.coordinates.length-2:1],""+(J.direction==="forward"?pe.geometry.coordinates.length-2:1),!1)),Xe(pe))};var kc={simple_select:Hn,direct_select:Pa,draw_point:wa,draw_polygon:No,draw_line_string:ls},Sa={defaultMode:P.SIMPLE_SELECT,keybindings:!0,touchEnabled:!0,clickBuffer:2,touchBuffer:25,boxSelect:!0,displayControlsDefault:!0,styles:Er,modes:kc,controls:{},userProperties:!1},Mc={point:!0,line_string:!0,polygon:!0,trash:!0,combine_features:!0,uncombine_features:!0},Rc={point:!1,line_string:!1,polygon:!1,trash:!1,combine_features:!1,uncombine_features:!1};function vl(J,pe){return J.map((function(Xe){return Xe.source?Xe:yr(Xe,{id:Xe.id+"."+pe,source:pe==="hot"?b.HOT:b.COLD})}))}var Qs={exports:{}};(function(J,pe){var Xe="__lodash_hash_undefined__",Tt=9007199254740991,Nt="[object Arguments]",kt="[object Array]",Gt="[object Boolean]",$r="[object Date]",Yr="[object Error]",Hr="[object Function]",kr="[object Map]",Qr="[object Number]",Qn="[object Object]",Ei="[object Promise]",En="[object RegExp]",pn="[object Set]",Mr="[object String]",cn="[object Symbol]",Wn="[object WeakMap]",Ma="[object ArrayBuffer]",Ci="[object DataView]",Ra=/^\[object .+?Constructor\]$/,gi=/^(?:0|[1-9]\d*)$/,jn={};jn["[object Float32Array]"]=jn["[object Float64Array]"]=jn["[object Int8Array]"]=jn["[object Int16Array]"]=jn["[object Int32Array]"]=jn["[object Uint8Array]"]=jn["[object Uint8ClampedArray]"]=jn["[object Uint16Array]"]=jn["[object Uint32Array]"]=!0,jn[Nt]=jn[kt]=jn[Ma]=jn[Gt]=jn[Ci]=jn[$r]=jn[Yr]=jn[Hr]=jn[kr]=jn[Qr]=jn[Qn]=jn[En]=jn[pn]=jn[Mr]=jn[Wn]=!1;var us=typeof Op=="object"&&Op&&Op.Object===Object&&Op,Un=typeof self=="object"&&self&&self.Object===Object&&self,Nn=us||Un||Function("return this")(),Go=pe&&!pe.nodeType&&pe,Yn=Go&&J&&!J.nodeType&&J,Do=Yn&&Yn.exports===Go,To=Do&&us.process,Xo=(function(){try{return To&&To.binding&&To.binding("util")}catch{}})(),tl=Xo&&Xo.isTypedArray;function nu($t,tr){for(var sn=-1,Cn=$t==null?0:$t.length;++sn<Cn;)if(tr($t[sn],sn,$t))return!0;return!1}function _l($t){var tr=-1,sn=Array($t.size);return $t.forEach((function(Cn,bi){sn[++tr]=[bi,Cn]})),sn}function Co($t){var tr=-1,sn=Array($t.size);return $t.forEach((function(Cn){sn[++tr]=Cn})),sn}var rl,bl,lo,uo=Array.prototype,na=Function.prototype,Da=Object.prototype,le=Nn["__core-js_shared__"],Ve=na.toString,dt=Da.hasOwnProperty,Dt=(rl=/[^.]+$/.exec(le&&le.keys&&le.keys.IE_PROTO||""))?"Symbol(src)_1."+rl:"",nr=Da.toString,Lr=RegExp("^"+Ve.call(dt).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Zr=Do?Nn.Buffer:void 0,kn=Nn.Symbol,wn=Nn.Uint8Array,ni=Da.propertyIsEnumerable,oi=uo.splice,Ii=kn?kn.toStringTag:void 0,$i=Object.getOwnPropertySymbols,Bi=Zr?Zr.isBuffer:void 0,Ti=(bl=Object.keys,lo=Object,function($t){return bl(lo($t))}),Fa=ho(Nn,"DataView"),fa=ho(Nn,"Map"),Qa=ho(Nn,"Promise"),bs=ho(Nn,"Set"),nl=ho(Nn,"WeakMap"),Su=ho(Object,"create"),Fo=hs(Fa),Dl=hs(fa),aa=hs(Qa),xl=hs(bs),iu=hs(nl),co=kn?kn.prototype:void 0,eo=co?co.valueOf:void 0;function xo($t){var tr=-1,sn=$t==null?0:$t.length;for(this.clear();++tr<sn;){var Cn=$t[tr];this.set(Cn[0],Cn[1])}}function Ba($t){var tr=-1,sn=$t==null?0:$t.length;for(this.clear();++tr<sn;){var Cn=$t[tr];this.set(Cn[0],Cn[1])}}function Yo($t){var tr=-1,sn=$t==null?0:$t.length;for(this.clear();++tr<sn;){var Cn=$t[tr];this.set(Cn[0],Cn[1])}}function Eu($t){var tr=-1,sn=$t==null?0:$t.length;for(this.__data__=new Yo;++tr<sn;)this.add($t[tr])}function Ea($t){var tr=this.__data__=new Ba($t);this.size=tr.size}function lh($t,tr){var sn=Tu($t),Cn=!sn&&ya($t),bi=!sn&&!Cn&&il($t),An=!sn&&!Cn&&!bi&&ou($t),A=sn||Cn||bi||An,y=A?(function(U,re){for(var ye=-1,Re=Array(U);++ye<U;)Re[ye]=re(ye);return Re})($t.length,String):[],_=y.length;for(var I in $t)!dt.call($t,I)||A&&(I=="length"||bi&&(I=="offset"||I=="parent")||An&&(I=="buffer"||I=="byteLength"||I=="byteOffset")||Bl(I,_))||y.push(I);return y}function cs($t,tr){for(var sn=$t.length;sn--;)if(zl($t[sn][0],tr))return sn;return-1}function au($t){return $t==null?$t===void 0?"[object Undefined]":"[object Null]":Ii&&Ii in Object($t)?(function(tr){var sn=dt.call(tr,Ii),Cn=tr[Ii];try{tr[Ii]=void 0;var bi=!0}catch{}var An=nr.call(tr);return bi&&(sn?tr[Ii]=Cn:delete tr[Ii]),An})($t):(function(tr){return nr.call(tr)})($t)}function Wa($t){return js($t)&&au($t)==Nt}function Fs($t,tr,sn,Cn,bi){return $t===tr||($t==null||tr==null||!js($t)&&!js(tr)?$t!=$t&&tr!=tr:(function(An,A,y,_,I,U){var re=Tu(An),ye=Tu(A),Re=re?kt:wo(An),Ke=ye?kt:wo(A),yt=(Re=Re==Nt?Qn:Re)==Qn,Zt=(Ke=Ke==Nt?Qn:Ke)==Qn,ur=Re==Ke;if(ur&&il(An)){if(!il(A))return!1;re=!0,yt=!1}if(ur&&!yt)return U||(U=new Ea),re||ou(An)?wl(An,A,y,_,I,U):(function(In,Dn,Qi,ia,Ta,Ga,Bo){switch(Qi){case Ci:if(In.byteLength!=Dn.byteLength||In.byteOffset!=Dn.byteOffset)return!1;In=In.buffer,Dn=Dn.buffer;case Ma:return!(In.byteLength!=Dn.byteLength||!Ga(new wn(In),new wn(Dn)));case Gt:case $r:case Qr:return zl(+In,+Dn);case Yr:return In.name==Dn.name&&In.message==Dn.message;case En:case Mr:return In==Dn+"";case kr:var xs=_l;case pn:var Vl=1&ia;if(xs||(xs=Co),In.size!=Dn.size&&!Vl)return!1;var Gu=Bo.get(In);if(Gu)return Gu==Dn;ia|=2,Bo.set(In,Dn);var Us=wl(xs(In),xs(Dn),ia,Ta,Ga,Bo);return Bo.delete(In),Us;case cn:if(eo)return eo.call(In)==eo.call(Dn)}return!1})(An,A,Re,y,_,I,U);if(!(1&y)){var Vr=yt&&dt.call(An,"__wrapped__"),gn=Zt&&dt.call(A,"__wrapped__");if(Vr||gn){var Rn=Vr?An.value():An,Vn=gn?A.value():A;return U||(U=new Ea),I(Rn,Vn,y,_,U)}}return ur?(U||(U=new Ea),(function(In,Dn,Qi,ia,Ta,Ga){var Bo=1&Qi,xs=Fl(In),Vl=xs.length,Gu=Fl(Dn).length;if(Vl!=Gu&&!Bo)return!1;for(var Us=Vl;Us--;){var Zo=xs[Us];if(!(Bo?Zo in Dn:dt.call(Dn,Zo)))return!1}var uc=Ga.get(In);if(uc&&Ga.get(Dn))return uc==Dn;var Sl=!0;Ga.set(In,Dn),Ga.set(Dn,In);for(var Zn=Bo;++Us<Vl;){var zo=In[Zo=xs[Us]],Oc=Dn[Zo];if(ia)var uh=Bo?ia(Oc,zo,Zo,Dn,In,Ga):ia(zo,Oc,Zo,In,Dn,Ga);if(!(uh===void 0?zo===Oc||Ta(zo,Oc,Qi,ia,Ga):uh)){Sl=!1;break}Zn||(Zn=Zo=="constructor")}if(Sl&&!Zn){var $l=In.constructor,cc=Dn.constructor;$l==cc||!("constructor"in In)||!("constructor"in Dn)||typeof $l=="function"&&$l instanceof $l&&typeof cc=="function"&&cc instanceof cc||(Sl=!1)}return Ga.delete(In),Ga.delete(Dn),Sl})(An,A,y,_,I,U)):!1})($t,tr,sn,Cn,Fs,bi))}function Hu($t){return!(!Cu($t)||(function(tr){return!!Dt&&Dt in tr})($t))&&(zs($t)?Lr:Ra).test(hs($t))}function Wu($t){if(sn=(tr=$t)&&tr.constructor,Cn=typeof sn=="function"&&sn.prototype||Da,tr!==Cn)return Ti($t);var tr,sn,Cn,bi=[];for(var An in Object($t))dt.call($t,An)&&An!="constructor"&&bi.push(An);return bi}function wl($t,tr,sn,Cn,bi,An){var A=1&sn,y=$t.length,_=tr.length;if(y!=_&&!(A&&_>y))return!1;var I=An.get($t);if(I&&An.get(tr))return I==tr;var U=-1,re=!0,ye=2&sn?new Eu:void 0;for(An.set($t,tr),An.set(tr,$t);++U<y;){var Re=$t[U],Ke=tr[U];if(Cn)var yt=A?Cn(Ke,Re,U,tr,$t,An):Cn(Re,Ke,U,$t,tr,An);if(yt!==void 0){if(yt)continue;re=!1;break}if(ye){if(!nu(tr,(function(Zt,ur){if(Vr=ur,!ye.has(Vr)&&(Re===Zt||bi(Re,Zt,sn,Cn,An)))return ye.push(ur);var Vr}))){re=!1;break}}else if(Re!==Ke&&!bi(Re,Ke,sn,Cn,An)){re=!1;break}}return An.delete($t),An.delete(tr),re}function Fl($t){return(function(tr,sn,Cn){var bi=sn(tr);return Tu(tr)?bi:(function(An,A){for(var y=-1,_=A.length,I=An.length;++y<_;)An[I+y]=A[y];return An})(bi,Cn(tr))})($t,Ul,Bs)}function Ao($t,tr){var sn,Cn,bi=$t.__data__;return((Cn=typeof(sn=tr))=="string"||Cn=="number"||Cn=="symbol"||Cn=="boolean"?sn!=="__proto__":sn===null)?bi[typeof tr=="string"?"string":"hash"]:bi.map}function ho($t,tr){var sn=(function(Cn,bi){return Cn?.[bi]})($t,tr);return Hu(sn)?sn:void 0}xo.prototype.clear=function(){this.__data__=Su?Su(null):{},this.size=0},xo.prototype.delete=function($t){var tr=this.has($t)&&delete this.__data__[$t];return this.size-=tr?1:0,tr},xo.prototype.get=function($t){var tr=this.__data__;if(Su){var sn=tr[$t];return sn===Xe?void 0:sn}return dt.call(tr,$t)?tr[$t]:void 0},xo.prototype.has=function($t){var tr=this.__data__;return Su?tr[$t]!==void 0:dt.call(tr,$t)},xo.prototype.set=function($t,tr){var sn=this.__data__;return this.size+=this.has($t)?0:1,sn[$t]=Su&&tr===void 0?Xe:tr,this},Ba.prototype.clear=function(){this.__data__=[],this.size=0},Ba.prototype.delete=function($t){var tr=this.__data__,sn=cs(tr,$t);return!(sn<0)&&(sn==tr.length-1?tr.pop():oi.call(tr,sn,1),--this.size,!0)},Ba.prototype.get=function($t){var tr=this.__data__,sn=cs(tr,$t);return sn<0?void 0:tr[sn][1]},Ba.prototype.has=function($t){return cs(this.__data__,$t)>-1},Ba.prototype.set=function($t,tr){var sn=this.__data__,Cn=cs(sn,$t);return Cn<0?(++this.size,sn.push([$t,tr])):sn[Cn][1]=tr,this},Yo.prototype.clear=function(){this.size=0,this.__data__={hash:new xo,map:new(fa||Ba),string:new xo}},Yo.prototype.delete=function($t){var tr=Ao(this,$t).delete($t);return this.size-=tr?1:0,tr},Yo.prototype.get=function($t){return Ao(this,$t).get($t)},Yo.prototype.has=function($t){return Ao(this,$t).has($t)},Yo.prototype.set=function($t,tr){var sn=Ao(this,$t),Cn=sn.size;return sn.set($t,tr),this.size+=sn.size==Cn?0:1,this},Eu.prototype.add=Eu.prototype.push=function($t){return this.__data__.set($t,Xe),this},Eu.prototype.has=function($t){return this.__data__.has($t)},Ea.prototype.clear=function(){this.__data__=new Ba,this.size=0},Ea.prototype.delete=function($t){var tr=this.__data__,sn=tr.delete($t);return this.size=tr.size,sn},Ea.prototype.get=function($t){return this.__data__.get($t)},Ea.prototype.has=function($t){return this.__data__.has($t)},Ea.prototype.set=function($t,tr){var sn=this.__data__;if(sn instanceof Ba){var Cn=sn.__data__;if(!fa||Cn.length<199)return Cn.push([$t,tr]),this.size=++sn.size,this;sn=this.__data__=new Yo(Cn)}return sn.set($t,tr),this.size=sn.size,this};var Bs=$i?function($t){return $t==null?[]:($t=Object($t),(function(tr,sn){for(var Cn=-1,bi=tr==null?0:tr.length,An=0,A=[];++Cn<bi;){var y=tr[Cn];sn(y,Cn,tr)&&(A[An++]=y)}return A})($i($t),(function(tr){return ni.call($t,tr)})))}:function(){return[]},wo=au;function Bl($t,tr){return!!(tr=tr??Tt)&&(typeof $t=="number"||gi.test($t))&&$t>-1&&$t%1==0&&$t<tr}function hs($t){if($t!=null){try{return Ve.call($t)}catch{}try{return $t+""}catch{}}return""}function zl($t,tr){return $t===tr||$t!=$t&&tr!=tr}(Fa&&wo(new Fa(new ArrayBuffer(1)))!=Ci||fa&&wo(new fa)!=kr||Qa&&wo(Qa.resolve())!=Ei||bs&&wo(new bs)!=pn||nl&&wo(new nl)!=Wn)&&(wo=function($t){var tr=au($t),sn=tr==Qn?$t.constructor:void 0,Cn=sn?hs(sn):"";if(Cn)switch(Cn){case Fo:return Ci;case Dl:return kr;case aa:return Ei;case xl:return pn;case iu:return Wn}return tr});var ya=Wa((function(){return arguments})())?Wa:function($t){return js($t)&&dt.call($t,"callee")&&!ni.call($t,"callee")},Tu=Array.isArray,il=Bi||function(){return!1};function zs($t){if(!Cu($t))return!1;var tr=au($t);return tr==Hr||tr=="[object GeneratorFunction]"||tr=="[object AsyncFunction]"||tr=="[object Proxy]"}function jl($t){return typeof $t=="number"&&$t>-1&&$t%1==0&&$t<=Tt}function Cu($t){var tr=typeof $t;return $t!=null&&(tr=="object"||tr=="function")}function js($t){return $t!=null&&typeof $t=="object"}var ou=tl?(function($t){return function(tr){return $t(tr)}})(tl):function($t){return js($t)&&jl($t.length)&&!!jn[au($t)]};function Ul($t){return(tr=$t)!=null&&jl(tr.length)&&!zs(tr)?lh($t):Wu($t);var tr}J.exports=function($t,tr){return Fs($t,tr)}})(Qs,Qs.exports);var Ha=n(Qs.exports);function so(J,pe){return J.length===pe.length&&JSON.stringify(J.map((function(Xe){return Xe})).sort())===JSON.stringify(pe.map((function(Xe){return Xe})).sort())}var ka={Polygon:Oe,LineString:Ne,Point:xe,MultiPolygon:it,MultiLineString:it,MultiPoint:it},el=Object.freeze({__proto__:null,CommonSelectors:ot,constrainFeatureMovement:oo,createMidPoint:Kt,createSupplementaryPoints:Rr,createVertex:Jt,doubleClickZoom:bt,euclideanDistance:Me,featuresAt:oe,getFeatureAtAndSetCursors:fe,isClick:me,isEventAtCoordinates:Wo,isTap:we,mapEventToBoundingBox:Q,ModeHandler:r,moveFeatures:Ja,sortFeatures:ie,stringSetsAreEqual:so,StringSet:H,theme:Er,toDenseArray:at}),xu=function(J,pe){var Xe={options:J=(function(Nt){Nt===void 0&&(Nt={});var kt=yr(Nt);return Nt.controls||(kt.controls={}),Nt.displayControlsDefault===!1?kt.controls=yr(Rc,Nt.controls):kt.controls=yr(Mc,Nt.controls),(kt=yr(Sa,kt)).styles=vl(kt.styles,"cold").concat(vl(kt.styles,"hot")),kt})(J)};pe=(function(Nt,kt){return kt.modes=P,kt.getFeatureIdsAt=function(Gt){return oe.click({point:Gt},null,Nt).map((function($r){return $r.properties.id}))},kt.getSelectedIds=function(){return Nt.store.getSelectedIds()},kt.getSelected=function(){return{type:E.FEATURE_COLLECTION,features:Nt.store.getSelectedIds().map((function(Gt){return Nt.store.get(Gt)})).map((function(Gt){return Gt.toGeoJSON()}))}},kt.getSelectedPoints=function(){return{type:E.FEATURE_COLLECTION,features:Nt.store.getSelectedCoordinates().map((function(Gt){return{type:E.FEATURE,properties:{},geometry:{type:E.POINT,coordinates:Gt.coordinates}}}))}},kt.set=function(Gt){if(Gt.type===void 0||Gt.type!==E.FEATURE_COLLECTION||!Array.isArray(Gt.features))throw new Error("Invalid FeatureCollection");var $r=Nt.store.createRenderBatch(),Yr=Nt.store.getAllIds().slice(),Hr=kt.add(Gt),kr=new H(Hr);return(Yr=Yr.filter((function(Qr){return!kr.has(Qr)}))).length&&kt.delete(Yr),$r(),Hr},kt.add=function(Gt){var $r=JSON.parse(JSON.stringify(Jr(Gt))).features.map((function(Yr){if(Yr.id=Yr.id||he(),Yr.geometry===null)throw new Error("Invalid geometry: null");if(Nt.store.get(Yr.id)===void 0||Nt.store.get(Yr.id).type!==Yr.geometry.type){var Hr=ka[Yr.geometry.type];if(Hr===void 0)throw new Error("Invalid geometry type: "+Yr.geometry.type+".");var kr=new Hr(Nt,Yr);Nt.store.add(kr)}else{var Qr=Nt.store.get(Yr.id);Qr.properties=Yr.properties,Ha(Qr.properties,Yr.properties)||Nt.store.featureChanged(Qr.id),Ha(Qr.getCoordinates(),Yr.geometry.coordinates)||Qr.incomingCoords(Yr.geometry.coordinates)}return Yr.id}));return Nt.store.render(),$r},kt.get=function(Gt){var $r=Nt.store.get(Gt);if($r)return $r.toGeoJSON()},kt.getAll=function(){return{type:E.FEATURE_COLLECTION,features:Nt.store.getAll().map((function(Gt){return Gt.toGeoJSON()}))}},kt.delete=function(Gt){return Nt.store.delete(Gt,{silent:!0}),kt.getMode()!==P.DIRECT_SELECT||Nt.store.getSelectedIds().length?Nt.store.render():Nt.events.changeMode(P.SIMPLE_SELECT,void 0,{silent:!0}),kt},kt.deleteAll=function(){return Nt.store.delete(Nt.store.getAllIds(),{silent:!0}),kt.getMode()===P.DIRECT_SELECT?Nt.events.changeMode(P.SIMPLE_SELECT,void 0,{silent:!0}):Nt.store.render(),kt},kt.changeMode=function(Gt,$r){return $r===void 0&&($r={}),Gt===P.SIMPLE_SELECT&&kt.getMode()===P.SIMPLE_SELECT?(so($r.featureIds||[],Nt.store.getSelectedIds())||(Nt.store.setSelected($r.featureIds,{silent:!0}),Nt.store.render()),kt):(Gt===P.DIRECT_SELECT&&kt.getMode()===P.DIRECT_SELECT&&$r.featureId===Nt.store.getSelectedIds()[0]||Nt.events.changeMode(Gt,$r,{silent:!0}),kt)},kt.getMode=function(){return Nt.events.getMode()},kt.trash=function(){return Nt.events.trash({silent:!0}),kt},kt.combineFeatures=function(){return Nt.events.combineFeatures({silent:!0}),kt},kt.uncombineFeatures=function(){return Nt.events.uncombineFeatures({silent:!0}),kt},kt.setFeatureProperty=function(Gt,$r,Yr){return Nt.store.setFeatureProperty(Gt,$r,Yr),kt},kt})(Xe,pe),Xe.api=pe;var Tt=cr(Xe);return pe.onAdd=Tt.onAdd,pe.onRemove=Tt.onRemove,pe.types=S,pe.options=J,pe};function wu(J){xu(J,this)}return wu.modes=kc,wu.constants=q,wu.lib=el,wu}))})(ww)),ww.exports}var p2e=d2e();const l9=od(p2e);function g2e(){const t=Gb(r=>r.breakpoints.down("md"));return[{id:"gl-draw-polygon-fill-inactive",type:"fill",filter:["all",["==","active","false"],["==","$type","Polygon"],["!=","mode","static"]],paint:{"fill-color":"#009EE0","fill-outline-color":"#009EE0","fill-opacity":.3}},{id:"gl-draw-polygon-fill-active",type:"fill",filter:["all",["==","active","true"],["==","$type","Polygon"]],paint:{"fill-color":"#009EE0","fill-outline-color":"#009EE0","fill-opacity":.2}},{id:"gl-draw-polygon-stroke-inactive",type:"line",filter:["all",["==","active","false"],["==","$type","Polygon"],["!=","mode","static"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#009EE0","line-width":3}},{id:"gl-draw-polygon-stroke-active",type:"line",filter:["all",["==","active","true"],["==","$type","Polygon"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#009EE0","line-dasharray":[.2,2],"line-width":2}},{id:"gl-draw-line-inactive",type:"line",filter:["all",["==","active","false"],["==","$type","LineString"],["!=","mode","static"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#009EE0","line-width":4}},{id:"gl-draw-line-active",type:"line",filter:["all",["==","$type","LineString"],["==","active","true"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#009EE0","line-dasharray":[.2,2],"line-width":2}},{id:"gl-draw-polygon-midpoint",type:"circle",filter:["all",["==","$type","Point"],["==","meta","midpoint"]],paint:{"circle-radius":t?5:4,"circle-color":"#ffffff","circle-stroke-color":"#009EE0","circle-stroke-width":1}},{id:"gl-draw-polygon-and-line-vertex-stroke-inactive",type:"circle",filter:["all",["==","meta","vertex"],["==","$type","Point"],["!=","mode","static"]],paint:{"circle-radius":t?8:6,"circle-color":"#fff"}},{id:"gl-draw-polygon-and-line-vertex-inactive",type:"circle",filter:["all",["==","meta","vertex"],["==","$type","Point"],["!=","mode","static"]],paint:{"circle-radius":t?7:5,"circle-color":"#ffffff","circle-stroke-color":"#009EE0","circle-stroke-width":1}},{id:"gl-draw-point-point-stroke-inactive",type:"circle",filter:["all",["==","active","false"],["==","$type","Point"],["==","meta","feature"],["!=","mode","static"]],paint:{"circle-radius":t?10:9,"circle-opacity":1,"circle-color":"#009EE0"}},{id:"gl-draw-point-inactive",type:"circle",filter:["all",["==","active","false"],["==","$type","Point"],["==","meta","feature"],["!=","mode","static"]],paint:{"circle-radius":t?7.5:6.5,"circle-color":"#009EE0"}},{id:"gl-draw-point-stroke-active",type:"circle",filter:["all",["==","$type","Point"],["==","active","true"],["!=","meta","midpoint"]],paint:{"circle-radius":t?11:10,"circle-color":"#fff"}},{id:"gl-draw-point-active",type:"circle",filter:["all",["==","$type","Point"],["!=","meta","midpoint"],["==","active","true"]],paint:{"circle-radius":t?8.5:7.5,"circle-color":"#009EE0"}},{id:"gl-draw-polygon-fill-static",type:"fill",filter:["all",["==","mode","static"],["==","$type","Polygon"]],paint:{"fill-color":"#404040","fill-outline-color":"#404040","fill-opacity":.1}},{id:"gl-draw-polygon-stroke-static",type:"line",filter:["all",["==","mode","static"],["==","$type","Polygon"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#404040","line-width":2}},{id:"gl-draw-line-static",type:"line",filter:["all",["==","mode","static"],["==","$type","LineString"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#404040","line-width":2}},{id:"gl-draw-point-static",type:"circle",filter:["all",["==","mode","static"],["==","$type","Point"]],paint:{"circle-radius":t?8.5:6.5,"circle-color":"#404040"}}]}const Ik=t=>{const e=ee.useRef(null),r=ha({mapId:t.mapId,waitForLayer:t.insertBeforeLayer}),n=ee.useRef(!1),[i,a]=ee.useState(!1),[s,o]=ee.useState(),u=g2e(),h=ee.useCallback(f=>{console.log("MlFeatureEditor mode change to "+f.mode),typeof t.onFinish=="function"&&f.mode==="simple_select"&&t.onFinish()},[t.onFinish]);return ee.useEffect(()=>{r.map&&!n.current&&(n.current=!0,r.map.map.style&&r.map.map.getSource("mapbox-gl-draw-cold")&&e.current&&e.current?.remove(),e.current=new l9({displayControlsDefault:!1,defaultMode:t.mode||"simple_select",modes:Object.assign({},l9.modes),userProperties:!0,styles:u}),r.map.addControl(e.current,"top-left",r.componentId),r.map.on("draw.modechange",h,r.componentId),a(!0))},[r.map,t,n,h]),ee.useEffect(()=>{if(!r.map||!i||!e.current)return;const f=g=>{const b=g?.features||[];o(b),t.onChange&&t.onChange(b)};return r.map.on("draw.create",f,r.componentId),r.map.on("draw.update",f,r.componentId),r.map.on("draw.delete",f,r.componentId),()=>{r.map&&(r.map.map.off("draw.create",f),r.map.map.off("draw.update",f),r.map.map.off("draw.delete",f))}},[i,r.map,t.onChange]),ee.useEffect(()=>{e.current&&t.geojson?.geometry&&e.current.set({type:"FeatureCollection",features:[t.geojson]})},[t.geojson,i]),ee.useEffect(()=>{t.mode&&e.current&&e.current?.getMode?.()!==t.mode&&(e.current?.changeMode?.(t.mode),t.mode!=="simple_select"&&t.mode!=="direct_select"&&e.current.set({type:"FeatureCollection",features:[]}))},[t.mode,r.map]),{feature:s,drawToolsReady:i,draw:e.current}};try{Ik.displayName="useFeatureEditor",Ik.__docgenInfo={description:"GeoJson Feature editor that allows to create or manipulate GeoJson data",displayName:"useFeatureEditor",props:{mapId:{defaultValue:null,description:"Id of the target MapLibre instance in mapContext",name:"mapId",required:!1,type:{name:"string | undefined"}},insertBeforeLayer:{defaultValue:null,description:`Id of an existing layer in the mapLibre instance to help specify the layer order
This layer will be visually beneath the layer with the "insertBeforeLayer" id.`,name:"insertBeforeLayer",required:!1,type:{name:"string | undefined"}},geojson:{defaultValue:null,description:"Input GeoJson data at initialization",name:"geojson",required:!1,type:{name:"Feature<Geometry, GeoJsonProperties> | undefined"}},onChange:{defaultValue:null,description:`Callback function that is called each time the GeoJson data has changed within MlFeatureEditor.
First parameter is the new GeoJson feature.`,name:"onChange",required:!1,type:{name:"((para: Feature<Geometry, GeoJsonProperties>[]) => void) | undefined"}},onFinish:{defaultValue:null,description:`Callback function that is called each time the GeoJson data within has been finished within MlFeatureEditor.
First parameter is the new GeoJson feature.`,name:"onFinish",required:!1,type:{name:"(() => void) | undefined"}},mode:{defaultValue:null,description:`Feature editor modes:
- draw_line_string
- draw_polygon
- draw_point
- simple_select
- direct_select`,name:"mode",required:!1,type:{name:"enum",value:[{value:"undefined"},{value:'"draw_line_string"'},{value:'"draw_polygon"'},{value:'"draw_point"'},{value:'"simple_select"'},{value:'"direct_select"'}]}}}}}catch{}const _S=t=>(Ik({mode:t.mode,geojson:t.geojson,onChange:t.onChange,onFinish:t.onFinish,mapId:t.mapId}),K.jsx(K.Fragment,{}));try{_S.displayName="MlFeatureEditor",_S.__docgenInfo={description:"",displayName:"MlFeatureEditor",props:{mapId:{defaultValue:null,description:"Id of the target MapLibre instance in mapContext",name:"mapId",required:!1,type:{name:"string | undefined"}},insertBeforeLayer:{defaultValue:null,description:`Id of an existing layer in the mapLibre instance to help specify the layer order
This layer will be visually beneath the layer with the "insertBeforeLayer" id.`,name:"insertBeforeLayer",required:!1,type:{name:"string | undefined"}},geojson:{defaultValue:null,description:"Input GeoJson data at initialization",name:"geojson",required:!1,type:{name:"Feature<Geometry, GeoJsonProperties> | undefined"}},onChange:{defaultValue:null,description:`Callback function that is called each time the GeoJson data has changed within MlFeatureEditor.
First parameter is the new GeoJson feature.`,name:"onChange",required:!1,type:{name:"((para: Feature<Geometry, GeoJsonProperties>[]) => void) | undefined"}},onFinish:{defaultValue:null,description:`Callback function that is called each time the GeoJson data within has been finished within MlFeatureEditor.
First parameter is the new GeoJson feature.`,name:"onFinish",required:!1,type:{name:"(() => void) | undefined"}},mode:{defaultValue:null,description:`Feature editor modes:
- draw_line_string
- draw_polygon
- draw_point
- simple_select
- direct_select`,name:"mode",required:!1,type:{name:"enum",value:[{value:"undefined"},{value:'"draw_line_string"'},{value:'"draw_polygon"'},{value:'"draw_point"'},{value:'"simple_select"'},{value:'"direct_select"'}]}}}}}catch{}const u9=["fill","line","symbol","circle","heatmap","fill-extrusion","raster","hillshade","background"];function m2e(t){return typeof t.options.source=="string"?{source:t.options.source}:t.geojson&&(!t.options?.source||typeof t?.options?.source!="string"&&t.options?.source?.attribution&&!t.options?.source?.type)?{source:{type:"geojson",data:t.geojson||"",attribution:typeof t?.options?.source!="string"&&t.options.source?.attribution?t.options.source?.attribution:""}}:{}}function y2e(t,e){if(t?.insertBeforeLayer)return t.insertBeforeLayer;if(t?.insertBeforeFirstSymbolLayer)return e?.map?.firstSymbolLayer}function Yd(t){const e=ha({mapId:t.mapId,waitForLayer:t.insertBeforeLayer}),r=ee.useRef(""),n=ee.useRef(""),i=ee.useRef(""),[a,s]=ee.useState(),o=ee.useRef(t.layerId||(t.idPrefix?t.idPrefix:"Layer-")+e.componentId),u=ee.useCallback(()=>{if(!e.map||e?.map.cancelled||(e.map.map.getLayer(o.current)&&e.cleanup(),typeof t?.options?.source!="string"&&e.map.map.getSource(o.current)&&e.map.map.removeSource(o.current),typeof t.options.source=="string"&&(t.options.source===""||!e.map.map.getSource(t.options.source)))||typeof t?.options?.source!="string"&&!t.geojson&&!t?.options?.source?.data&&t?.options?.type!=="background"||typeof t.options.type>"u")return;try{e.map.addLayer({...t.options,...m2e(t),id:o.current},y2e(t,e),e.componentId)}catch(g){console.error("Failed to add layer:",g)}s(()=>e.map?.map.getLayer(o.current));const h=()=>{e.map?.map.getLayer(o.current)||u()};e.map.on("styledata",h,e.componentId);const f=(g,b,{source_id:v})=>{e.map&&typeof t?.options?.source=="string"&&t.options.source===v&&u()};e.map.wrapper.on("addsource",f,e.componentId),n.current=JSON.stringify(t.options?.paint),i.current=JSON.stringify(t.options?.layout),r.current=t.options.type},[t,e]);return ee.useEffect(()=>{e.map&&(!t.geojson&&!t.options.source&&t?.options?.type!=="background"||e.map?.cancelled===!1&&e?.map?.map?.getLayer?.(o.current)&&(u9.indexOf(t.options.type)===-1||u9.indexOf(t.options.type)!==-1&&t.options.type===r.current)||u())},[e.map,e.mapIsReady,t,u]),ee.useEffect(()=>{e.map?.cancelled===!0||!e.map?.map?.getSource?.(o.current)||e.map.map.getSource(o.current)?.setData?.(t.geojson)},[t.geojson,e.map,t.options.type]),ee.useEffect(()=>{if(e.map?.cancelled===!0||!e.map||!e.map?.map?.getLayer?.(o.current)||t.options.type!==r.current)return;let h;const f=JSON.stringify(t.options.layout);if(t.options.layout&&f!==i.current){const b=JSON.parse(i.current);for(h in t.options.layout)t.options.layout?.[h]&&t.options.layout[h]!==b[h]&&e.map.map.setLayoutProperty(o.current,h,t.options.layout[h]);i.current=f}const g=JSON.stringify(t.options.paint);if(g!==n.current){const b=JSON.parse(n.current);for(h in t.options.paint)t.options.paint?.[h]&&t.options.paint[h]!==b[h]&&e.map.map.setPaintProperty(o.current,h,t.options.paint[h]);n.current=g}},[t.options,e.map]),ee.useEffect(()=>{!t.insertBeforeLayer||!e.map||!e.map.getLayer(t.insertBeforeLayer)||!e.map.getLayer(o.current)||e.map.moveLayer(o.current,t.insertBeforeLayer)},[e.map,t.insertBeforeLayer]),ee.useEffect(()=>()=>{e.cleanup()},[]),ee.useEffect(()=>{if(typeof t?.options?.source!="string"||!e.map)return;const h=()=>{typeof t?.options?.source=="string"&&e?.map?.getSource?.(t.options.source)&&!e.map.getLayer(o.current)&&u()};e.map.on("sourcedataloading",h);const f=(g,b,{source_id:v})=>{e.map&&typeof t?.options?.source=="string"&&t.options.source===v&&u()};return e.map.wrapper.on("addsource",f),()=>{e?.map&&(e.map.off("sourcedataloading",h),e.map.wrapper.off("addsource",f))}},[e.map,t.options?.source]),ee.useEffect(()=>{if(!t.onClick||!e?.map||!e?.map?.getLayer?.(o.current))return;const h=t.onClick;return e.map?.on("click",o.current,h),()=>{h&&e?.map&&e.map?.off("click",o.current,h)}},[e.map,t.onClick]),ee.useEffect(()=>{if(!t.onHover||!e?.map||!e?.map?.getLayer?.(o.current))return;const h=t.onHover;return e.map?.on("mousemove",o.current,h),()=>{h&&e?.map&&e.map?.off("mousemove",o.current,h)}},[e.map,t.onHover]),ee.useEffect(()=>{if(!t.onLeave||!e?.map||!e?.map?.getLayer?.(o.current))return;const h=t.onLeave;return e.map?.on("mouseleave",o.current,h),()=>{h&&e?.map&&e.map?.off("mouseleave",o.current,h)}},[e.map,t.onLeave]),{map:e.map,layer:a,layerId:o.current,componentId:e.componentId,mapHook:e}}Yd.defaultProps={};const Pk=t=>(Yd({mapId:t.mapId,layerId:t.layerId||"MlFillExtrusionLayer-"+_c(),options:{id:"",type:"fill-extrusion",source:t.sourceId||"openmaptiles","source-layer":t.sourceLayer||"building",minzoom:t.minZoom||6,paint:{...t.paint}},insertBeforeFirstSymbolLayer:!0}),K.jsx(K.Fragment,{}));Pk.defaultProps={mapId:void 0,paint:{"fill-extrusion-color":"hsl(196, 61%, 83%)","fill-extrusion-height":{property:"render_height",type:"identity"},"fill-extrusion-base":{property:"render_min_height",type:"identity"},"fill-extrusion-opacity":1}};try{Pk.displayName="MlFillExtrusionLayer",Pk.__docgenInfo={description:"Adds a fill extrusion layer to the MapLibre instance reference by props.mapId",displayName:"MlFillExtrusionLayer",props:{mapId:{defaultValue:{value:"undefined"},description:"Id of the target MapLibre instance in mapContext",name:"mapId",required:!1,type:{name:"string | undefined"}},insertBeforeLayer:{defaultValue:null,description:`The layerId of an existing layer this layer should be rendered visually beneath
https://maplibre.org/maplibre-gl-js-docs/api/map/#map#addlayer - see "beforeId" property`,name:"insertBeforeLayer",required:!1,type:{name:"string | undefined"}},layerId:{defaultValue:null,description:"Id of the layer that will be added by this component",name:"layerId",required:!1,type:{name:"string | undefined"}},paint:{defaultValue:{value:`{
		'fill-extrusion-color': 'hsl(196, 61%, 83%)',
		'fill-extrusion-height': {
			property: 'render_height',
			type: 'identity',
		},
		'fill-extrusion-base': {
			property: 'render_min_height',
			type: 'identity',
		},
		'fill-extrusion-opacity': 1,
	}`},description:`Paint properties of the config object that is passed to the MapLibreGl.addLayer call. All
available properties are documented in the MapLibreGl documentation
https://maplibre.org/maplibre-gl-js-docs/style-spec/layers/#fill-extrusion`,name:"paint",required:!1,type:{name:"object | undefined"}},sourceId:{defaultValue:null,description:`Source id of a vector tile source containing the geometries to use for this fill-extrusion
layer.
https://maplibre.org/maplibre-gl-js-docs/style-spec/layers/#source-layer`,name:"sourceId",required:!1,type:{name:"string | undefined"}},sourceLayer:{defaultValue:null,description:`Layer id from a vector tile source containing the geometries to use for this fill-extrusion
layer.
https://maplibre.org/maplibre-gl-js-docs/style-spec/layers/#source-layer`,name:"sourceLayer",required:!1,type:{name:"string | undefined"}},minZoom:{defaultValue:null,description:`This layer will be hidden for zoom levels lower than defined on this property
https://maplibre.org/maplibre-gl-js-docs/style-spec/layers/#minzoom`,name:"minZoom",required:!1,type:{name:"number | undefined"}}}}}catch{}const DZ=(t,e)=>{switch(t){case"fill":return e?.fill?e.fill:{"fill-color":"#009EE0","fill-outline-color":"#009EE0"};case"line":return e?.line?(console.log(e.line),e.line):{"line-color":"#009EE0","line-width":4,"line-blur":0};case"circle":return e?.circle?e.circle:{"circle-color":"#009EE0","circle-stroke-color":"#fff","circle-stroke-width":2,"circle-radius":5};default:return{}}},c9={Position:"circle",Point:"circle",MultiPoint:"circle",LineString:"line",MultiLineString:"line",Polygon:"fill",MultiPolygon:"fill",GeometryCollection:"circle"},bS=t=>t?.type==="Feature"?c9?.[t?.geometry?.type]?c9[t.geometry.type]:"circle":t?.type==="FeatureCollection"?t.features.length?bS(t.features[0]):"circle":"fill";function QO(t){const e=ha({mapId:t.mapId}),[r,n]=ee.useState(),i=ee.useRef(t.sourceId||(t.idPrefix?t.idPrefix:"Source-")+e.componentId),a=ee.useCallback(()=>{if(e.map&&e.map?.style?._layers){for(const[o,u]of Object.entries(e.map.style._layers))u.source===i.current&&e.map.removeLayer(o);e.map.getSource(i.current)&&e.map.removeSource(i.current)}},[e.map]),s=ee.useCallback(()=>{e.map&&(t.source.type==="geojson"&&!t.source.data||(e.map.map.getSource(i.current)&&a(),e.map?.addSource(i.current,{...t.source}),n(e.map.map.getSource(i.current))))},[t,e,a]);return ee.useEffect(()=>{e.map?.map?.getSource(i.current)&&e.map.map.getSource(i.current)?.setData?.(t.source.data)},[t.source?.data]),ee.useEffect(()=>{e?.map?.map?.getSource?.(t.sourceId)&&t.sourceId===i.current||(i.current=t.sourceId,s())},[e.map,t,s]),ee.useEffect(()=>{if(!e.map)return;const o=()=>{e?.map?.getSource?.(t.sourceId)||s()};return e.map.on("styledata",o),()=>{e?.map&&e.map.off("styledata",o)}},[e.map,s]),ee.useEffect(()=>()=>{a()},[a]),{map:e.map,source:r,componentId:e.componentId,mapHook:e}}const wc=t=>{const e=t.type||bS(t.geojson),r=ee.useRef(t.layerId||"MlGeoJsonLayer-"+_c()),n=`label-${r.current}`;return ee.useEffect(()=>{t.layerId?r.current=t.layerId:r.current="MlGeoJsonLayer-"+_c()},[t.layerId]),QO({mapId:t.mapId,sourceId:"source-"+r.current,source:{type:"geojson",data:t.geojson,...typeof t?.options?.source<"u"&&typeof t?.options?.source!="string"?t.options.source:{}}}),Yd({mapId:t.mapId,layerId:r.current,options:{...typeof t?.options?.source<"u"&&typeof t?.options?.source=="string"?{source:t.options.source}:{source:"source-"+r.current},paint:{...t.paint||DZ(e,t.defaultPaintOverrides),...t?.options?.paint},layout:{...t?.layout||{},...t?.options?.layout},type:e},insertBeforeLayer:t.insertBeforeLayer,onHover:t.onHover,onClick:t.onClick,onLeave:t.onLeave}),Yd({mapId:t.mapId,options:{...typeof t?.options?.source<"u"&&typeof t?.options?.source=="string"?{source:t.options.source}:{source:"source-"+r.current},id:n,type:"symbol",maxzoom:24,minzoom:1,...t?.labelOptions?t.labelOptions:{},...t?.options?.filter?{filter:t.options.filter}:{},layout:{"text-font":["Open Sans Regular"],"text-field":`{${t.labelProp}}`,"text-size":12,"text-anchor":"top",...t?.labelOptions?.layout?t.labelOptions.layout:{},visibility:t?.layout?.visibility??t?.options?.layout?.visibility??"visible"},paint:{"text-halo-width":1,"text-halo-color":"#fefefe","text-color":"#121212",...t?.labelOptions?.paint?t.labelOptions.paint:{}}}}),K.jsx(K.Fragment,{})};try{wc.displayName="MlGeoJsonLayer",wc.__docgenInfo={description:"Adds source and layer to display GeoJSON data on the map.",displayName:"MlGeoJsonLayer",props:{mapId:{defaultValue:null,description:"Id of the target MapLibre instance in mapContext",name:"mapId",required:!1,type:{name:"string | undefined"}},insertBeforeLayer:{defaultValue:null,description:`Id of an existing layer in the mapLibre instance to help specify the layer order
This layer will be visually beneath the layer with the "insertBeforeLayer" id.
This layer will not be added to the maplibre-gl instance until a layer with an
id that matches the value of insertBeforeLayer is created.`,name:"insertBeforeLayer",required:!1,type:{name:"string | undefined"}},layerId:{defaultValue:null,description:"Id of the new layer and source that are added to the MapLibre instance",name:"layerId",required:!1,type:{name:"string | undefined"}},geojson:{defaultValue:null,description:"GeoJSON data that is supposed to be rendered by this component.",name:"geojson",required:!1,type:{name:"Feature<Geometry, GeoJsonProperties> | FeatureCollection<Geometry, GeoJsonProperties> | undefined"}},type:{defaultValue:null,description:`Type of the layer that will be added to the MapLibre instance.
All types from LayerSpecification union type are supported except the type from
RasterLayerSpecification`,name:"type",required:!1,type:{name:"enum",value:[{value:"undefined"},{value:'"symbol"'},{value:'"fill"'},{value:'"background"'},{value:'"circle"'},{value:'"line"'},{value:'"heatmap"'},{value:'"fill-extrusion"'},{value:'"hillshade"'},{value:'"color-relief"'}]}},paint:{defaultValue:null,description:`@deprecated The property should not be used. Please use the options.paint property instead. This will be removed in the next major release.
Paint property object, that is passed to the addLayer call.
Possible props depend on the layer type.
See https://maplibre.org/maplibre-gl-js-docs/style-spec/layers/
Some examples are:
https://maplibre.org/maplibre-gl-js-docs/style-spec/layers/#line
https://maplibre.org/maplibre-gl-js-docs/style-spec/layers/#circle
https://maplibre.org/maplibre-gl-js-docs/style-spec/layers/#fill
All paint types from LayerSpecification union type are supported except the paint type from
RasterLayerSpecification`,name:"paint",required:!1,type:{name:'{ "circle-radius"?: DataDrivenPropertyValueSpecification<number> | undefined; "circle-color"?: DataDrivenPropertyValueSpecification<string> | undefined; ... 8 more ...; "circle-stroke-opacity"?: DataDrivenPropertyValueSpecification<...> | undefined; } | ... 8 more ... | undefined'}},layout:{defaultValue:null,description:`@deprecated The property should not be used. Please use the options.layout property instead. This will be removed in the next major release.
Layout property object, that is passed to the addLayer call.
Possible props depend on the layer type.
See https://maplibre.org/maplibre-gl-js-docs/style-spec/layers/
Some examples are:
https://maplibre.org/maplibre-gl-js-docs/style-spec/layers/#line
https://maplibre.org/maplibre-gl-js-docs/style-spec/layers/#circle
https://maplibre.org/maplibre-gl-js-docs/style-spec/layers/#fill
All layout types from LayerSpecification union type are supported except the layout type from
RasterLayerSpecification`,name:"layout",required:!1,type:{name:'{ "circle-sort-key"?: DataDrivenPropertyValueSpecification<number> | undefined; visibility?: "none" | "visible" | undefined; } | { "fill-sort-key"?: DataDrivenPropertyValueSpecification<...> | undefined; visibility?: "none" | ... 1 more ... | undefined; } | ... 8 more ... | undefined'}},options:{defaultValue:null,description:"Javascript object that is spread into the addLayer commands first parameter.",name:"options",required:!1,type:{name:"Partial<LayerSpecification & { source?: string | GeoJSONSourceSpecification | undefined; id?: string | undefined; filter?: FilterSpecification | undefined; }> | undefined"}},defaultPaintOverrides:{defaultValue:null,description:'Javascript object with optional properties "fill", "line", "circle" to override implicit layer type default paint properties.',name:"defaultPaintOverrides",required:!1,type:{name:'{ circle?: { "circle-radius"?: DataDrivenPropertyValueSpecification<number> | undefined; "circle-color"?: DataDrivenPropertyValueSpecification<string> | undefined; ... 8 more ...; "circle-stroke-opacity"?: DataDrivenPropertyValueSpecification<...> | undefined; } | undefined; fill?: { ...; } | undefined; line?: { ......'}},labelProp:{defaultValue:null,description:"Property name in the GeoJSON object to be used as a label.",name:"labelProp",required:!1,type:{name:"string | undefined"}},labelOptions:{defaultValue:null,description:"Label configuration options.",name:"labelOptions",required:!1,type:{name:"Partial<LayerSpecification & { source?: string | GeoJSONSourceSpecification | undefined; id?: string | undefined; filter?: FilterSpecification | undefined; }> | undefined"}},onHover:{defaultValue:null,description:"Hover event handler that is executed whenever a geometry rendered by this component is hovered.",name:"onHover",required:!1,type:{name:"((ev: MapEventType) => void | Map$1) | undefined"}},onClick:{defaultValue:null,description:"Click event handler that is executed whenever a geometry rendered by this component is clicked.",name:"onClick",required:!1,type:{name:"((ev: MapEventType) => void | Map$1) | undefined"}},onLeave:{defaultValue:null,description:`Leave event handler that is executed whenever a geometry rendered by this component is
left/unhovered.`,name:"onLeave",required:!1,type:{name:"((ev: MapEventType) => void | Map$1) | undefined"}}}}}catch{}const eL=Hi(K.jsx("path",{d:"M12 8c-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4-1.79-4-4-4m8.94 3c-.46-4.17-3.77-7.48-7.94-7.94V1h-2v2.06C6.83 3.52 3.52 6.83 3.06 11H1v2h2.06c.46 4.17 3.77 7.48 7.94 7.94V23h2v-2.06c4.17-.46 7.48-3.77 7.94-7.94H23v-2zM12 19c-3.87 0-7-3.13-7-7s3.13-7 7-7 7 3.13 7 7-3.13 7-7 7"})),kk=t=>{const e=ha({mapId:t.mapId,waitForLayer:t.insertBeforeLayer}),[r,n]=ee.useState(!1),[i,a]=ee.useState(),[s,o]=ee.useState(!1),[u,h]=ee.useState(),[f,g]=ee.useState(0),b=ee.useRef(!1),v=ee.useCallback(k=>{if(!e.map||((!t.centerUserPosition&&!b.current||t.centerUserPosition)&&(t.useFlyTo?e.map.map.flyTo({center:[k.coords.longitude,k.coords.latitude],zoom:18,speed:1,curve:1}):e.map.map.setCenter([k.coords.longitude,k.coords.latitude]),b.current=!0),t.showUserLocation!==void 0&&!t.showUserLocation))return;const L=Rh([k.coords.longitude,k.coords.latitude]);a(L),h(NZ(L,k.coords.accuracy/1e3))},[e.map,t]),S=()=>{console.log("Access of user location denied"),o(!0)},E=ee.useMemo(()=>{if(!i)return;const k=.02,L=f-15,O=f+15,B=Kxe(i,k,L,O,{steps:65});return B.geometry.coordinates.push(i.geometry.coordinates),B.geometry.coordinates.slice(0,0),B},[f,i]),P=k=>{k?.alpha&&g(-k.alpha)};return ee.useEffect(()=>{if(r){const k=P;return window.addEventListener("deviceorientation",k),()=>{window.removeEventListener("deviceorientation",k)}}else b.current=!1},[r]),ee.useEffect(()=>{if(e.map&&r){const k=navigator.geolocation.watchPosition(v,S);return()=>{navigator.geolocation.clearWatch(k)}}},[e.map,r,v]),ee.useEffect(()=>{if(u?.type){const k=e.map?.getBounds(),L=[k?._ne.lng,k?._ne.lat,k?._sw.lng,k?._sw.lat],O=ih(u);Ube(Iz(L),Iz(O))||e.map?.fitBounds(O,{padding:{top:25,bottom:25}})}},[u]),K.jsxs(K.Fragment,{children:[r&&i&&K.jsx(wc,{geojson:u,type:"fill",paint:{"fill-color":"#cbd300","fill-opacity":.3,...t.accuracyPaint},insertBeforeLayer:t.insertBeforeLayer}),r&&E&&K.jsx(wc,{geojson:E,type:"fill",paint:{"fill-color":"#0000ff","fill-antialias":!1,"fill-opacity":.3,...t.orientationConePaint},insertBeforeLayer:t.insertBeforeLayer}),r&&i&&K.jsx(wc,{geojson:i,type:"circle",paint:{"circle-color":"#009ee0","circle-radius":5,"circle-stroke-color":"#fafaff","circle-stroke-width":1,...t.circlePaint},insertBeforeLayer:t.insertBeforeLayer}),K.jsx(Ji,{variant:"navtools","data-testid":"mlFollowGpsBtn",sx:{zIndex:1002,color:r?k=>k.palette.GPS.GPSActiveColor:k=>k.palette.GPS.GPSInactiveColor,backgroundColor:r?k=>k.palette.GPS.GPSActiveBackgroundColor:k=>k.palette.navigation.navColor},disabled:s,onClick:()=>{n(!r)},children:K.jsx(eL,{sx:{fontSize:{xs:"1.4em",md:"1em"}}})})]})};try{kk.displayName="MlFollowGps",kk.__docgenInfo={description:`Adds a button that makes the map follow the users GPS position using
navigator.geolocation.watchPosition if activated`,displayName:"MlFollowGps",props:{mapId:{defaultValue:null,description:"Id of the target MapLibre instance in mapContext",name:"mapId",required:!1,type:{name:"string | undefined"}},insertBeforeLayer:{defaultValue:null,description:`The layerId of an existing layer this layer should be rendered visually beneath
https://maplibre.org/maplibre-gl-js-docs/api/map/#map#addlayer - see "beforeId" property`,name:"insertBeforeLayer",required:!1,type:{name:"string | undefined"}},showUserLocation:{defaultValue:null,description:"By default a dot will be shown on the map at the user's location. Set to false to disable.",name:"showUserLocation",required:!1,type:{name:"boolean | undefined"}},showOrientation:{defaultValue:null,description:`By default a cone will be shown on the map at the user's location to indicate the device's orientation.
Set to false to disable.`,name:"showOrientation",required:!1,type:{name:"boolean | undefined"}},showAccuracyCircle:{defaultValue:null,description:`By default, if showUserLocation is true, a transparent circle will be drawn around the user location
indicating the accuracy (95% confidence level) of the user's location. Set to false to disable.`,name:"showAccuracyCircle",required:!1,type:{name:"boolean | undefined"}},useFlyTo:{defaultValue:null,description:`Use the MapLibre.flyTo function to center the map to the current users position if true.
Otherwise the MapLibre.setCenter function is used.`,name:"useFlyTo",required:!1,type:{name:"boolean | undefined"}},centerUserPosition:{defaultValue:null,description:`Center map to current position once updated location data is recieved.
"false" will center the map once on component activation and then display the updated user location on the map.`,name:"centerUserPosition",required:!1,type:{name:"boolean | undefined"}},orientationConePaint:{defaultValue:null,description:`Orientation cone paint property object, that is passed to the MlGeoJsonLayer responsible for drawing the orientation cone polygon.
Use any available paint prop from layer type "fill".
https://maplibre.org/maplibre-gl-js-docs/style-spec/layers/#fill`,name:"orientationConePaint",required:!1,type:{name:'{ "fill-antialias"?: PropertyValueSpecification<boolean> | undefined; "fill-opacity"?: DataDrivenPropertyValueSpecification<number> | undefined; ... 4 more ...; "fill-pattern"?: DataDrivenPropertyValueSpecification<...> | undefined; } | undefined'}},circlePaint:{defaultValue:null,description:`Position circle paint property object, that is passed to the MlGeoJsonLayer responsible for drawing the position circle.
Use any available paint prop from layer type "circle".
https://maplibre.org/maplibre-gl-js-docs/style-spec/layers/#circle`,name:"circlePaint",required:!1,type:{name:'{ "circle-radius"?: DataDrivenPropertyValueSpecification<number> | undefined; "circle-color"?: DataDrivenPropertyValueSpecification<string> | undefined; ... 8 more ...; "circle-stroke-opacity"?: DataDrivenPropertyValueSpecification<...> | undefined; } | undefined'}},onColor:{defaultValue:null,description:"Active button font color",name:"onColor",required:!1,type:{name:"string | undefined"}},offColor:{defaultValue:null,description:"Inactive button font color",name:"offColor",required:!1,type:{name:"string | undefined"}},accuracyPaint:{defaultValue:null,description:`Accuracy paint property object, that is passed to the MlGeoJsonLayer responsible for drawing the accuracy polygon.
Use any available paint prop from layer type "fill".
https://maplibre.org/maplibre-gl-js-docs/style-spec/layers/#fill`,name:"accuracyPaint",required:!1,type:{name:'{ "fill-antialias"?: PropertyValueSpecification<boolean> | undefined; "fill-opacity"?: DataDrivenPropertyValueSpecification<number> | undefined; ... 4 more ...; "fill-pattern"?: DataDrivenPropertyValueSpecification<...> | undefined; } | undefined'}}}}}catch{}const h9=t=>{const e=ha({mapId:t.mapId,waitForLayer:t.insertBeforeLayer}),[r,n]=ee.useState(),i=ee.useRef(t.imageId||"img_"+_c()),a=ee.useRef(t.layerId||"MlImageMarkerLayer-"+e.componentId);Yd({geojson:t.options?.source?.data,layerId:a.current,options:{type:"symbol",layout:{...t.options?.layout,"icon-image":r||i.current},paint:{...t.options?.paint}}});const s=(o,u)=>{o.map&&u.imgSrc&&!o.map.map.hasImage(i.current)&&o.map.map.loadImage(u.imgSrc).then(function(h){if(!h?.data){console.log("image "+u.imgSrc+"could not be loaded");return}!o.map||o.map.map.hasImage(i.current)||(o.map.addImage(i.current,h.data,o.componentId),n(i.current))})};return ee.useEffect(()=>{e.map&&t.imgSrc&&s(e,t)},[t,e]),K.jsx(K.Fragment,{})};try{h9.displayName="MlImageMarkerLayer",h9.__docgenInfo={description:"",displayName:"MlImageMarkerLayer",props:{mapId:{defaultValue:null,description:"Id of the target MapLibre instance in mapContext",name:"mapId",required:!1,type:{name:"string | undefined"}},insertBeforeLayer:{defaultValue:null,description:`The layerId of an existing layer this layer should be rendered visually beneath
https://maplibre.org/maplibre-gl-js-docs/api/map/#map#addlayer - see "beforeId" property`,name:"insertBeforeLayer",required:!1,type:{name:"string | undefined"}},layerId:{defaultValue:null,description:"Id of the layer that will be added by this component to the maplibre-gl instance",name:"layerId",required:!1,type:{name:"string | undefined"}},imageId:{defaultValue:null,description:"Id of the image that will be added by this component to the maplibre-gl instance",name:"imageId",required:!1,type:{name:"string | undefined"}},imgSrc:{defaultValue:null,description:"Path or URL to a supported raster image",name:"imgSrc",required:!1,type:{name:"string | undefined"}},options:{defaultValue:null,description:"Javascript object that is passed the addLayer command as first parameter.",name:"options",required:!1,type:{name:"{ source?: { type?: string | undefined; data: Feature<Geometry, GeoJsonProperties> | FeatureCollection<Geometry, GeoJsonProperties> | undefined; } | undefined; layout?: { ...; } | undefined; paint?: { ...; } | undefined; } | undefined"}}}}}catch{}function v2e(t){switch(t){case"meters":return 1;case"millimeters":return 1e3;case"centimeters":return 100;case"kilometers":return .001;case"miles":return 1/1609.344;case"nauticalmiles":return 1/1852;case"inches":return 39.3701;case"yards":return 1.09361;case"feet":return 3.28084;default:return 1}}function f9(t){switch(t){case"miles":return"mi";case"acres":return"ac";case"kilometers":return"km";case"meters":return"m";case"millimeters":return"mm";case"centimeters":return"cm";case"nauticalmiles":return"nm";case"inches":return"in";case"yards":return"yd";case"feet":return"ft";case"hectares":return"ha";default:return"m"}}const Mk=t=>{const[e,r]=ee.useState({value:0,label:""}),[n,i]=ee.useState([]);return ee.useEffect(()=>{if(n[0]){let a=0;if(t.measureType==="polygon"){if(a=Ibe(n[0]),t.unit){const s=t.unit;s==="acres"?a=a/4046.8564224:s==="hectares"?a=a/1e4:a=a*v2e(t.unit)**2}}else a=hb(n[0],{units:t.unit});typeof t.onChange=="function"&&t.onChange({value:a,unit:t.unit,geojson:n[0]}),a>=.1&&r({value:a,label:f9(t.unit)})}},[t.unit,n]),K.jsxs(K.Fragment,{children:[K.jsx(_S,{onChange:a=>{a&&i(a)},mode:t.measureType==="polygon"?"draw_polygon":"draw_line_string",onFinish:t.onFinish}),e.value.toLocaleString("de-DE",{minimumFractionDigits:2,maximumFractionDigits:2})," ",f9(t.unit),e.label&&t.measureType==="polygon"&&!["hectares","acres"].includes(t.unit||"")?" ":""]})};try{Mk.displayName="MlMeasureTool",Mk.__docgenInfo={description:"",displayName:"MlMeasureTool",props:{measureType:{defaultValue:null,description:'String that specify if the Tool measures an area ("polygon") or length ("line")',name:"measureType",required:!1,type:{name:"enum",value:[{value:"undefined"},{value:'"line"'},{value:'"polygon"'}]}},unit:{defaultValue:null,description:"String that dictates which unit of measurement is used",name:"unit",required:!1,type:{name:"enum",value:[{value:"undefined"},{value:'"meters"'},{value:'"metres"'},{value:'"millimeters"'},{value:'"millimetres"'},{value:'"centimeters"'},{value:'"centimetres"'},{value:'"kilometers"'},{value:'"kilometres"'},{value:'"miles"'},{value:'"nauticalmiles"'},{value:'"inches"'},{value:'"yards"'},{value:'"feet"'},{value:'"radians"'},{value:'"degrees"'}]}},onChange:{defaultValue:null,description:`Callback function that is called each time measurment geometry within has changed within MlMeasureTool.
First parameter is the new GeoJson feature.`,name:"onChange",required:!1,type:{name:"((options: MlMeasureToolOnChangeOptions) => void) | undefined"}},onFinish:{defaultValue:null,description:"Callback function that is called by the end of drawing geometries.",name:"onFinish",required:!1,type:{name:"(() => void) | undefined"}}}}}catch{}const FZ=Hi(K.jsx("path",{d:"M15 16v1.26l-6-3v-3.17L11.7 8H16V2h-6v4.9L7.3 10H3v6h5l7 3.5V22h6v-6z"})),BZ=Hi(K.jsx("path",{d:"m2 9 4 12h12l4-12-10-7z"})),_2e=Pr(ff)({marginTop:"15px"});function Rk(t){return K.jsx(_2e,{children:t?.children})}try{Rk.displayName="LayerList",Rk.__docgenInfo={description:"",displayName:"LayerList",props:{mapId:{defaultValue:null,description:"",name:"mapId",required:!1,type:{name:"string | undefined"}}}}}catch{}const nx=Hi(K.jsx("path",{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6zM19 4h-3.5l-1-1h-5l-1 1H5v2h14z"})),tL=Hi(K.jsx("path",{d:"M3 17v2h6v-2zM3 5v2h10V5zm10 16v-2h8v-2h-8v-2h-2v6zM7 9v2H3v2h4v2h2V9zm14 4v-2H11v2zm-6-4h2V7h4V5h-4V3h-2z"})),zZ=Hi(K.jsx("path",{d:"m12 8-6 6 1.41 1.41L12 10.83l4.59 4.58L18 14z"})),xS=Hi(K.jsx("path",{d:"M16.59 8.59 12 13.17 7.41 8.59 6 10l6 6 6-6z"})),b2e=Fm(Ih)({paddingRight:0,paddingLeft:0,paddingTop:0,paddingBottom:"4px"}),x2e=Fm(Q1)({minWidth:"30px"}),w2e=Fm(eh)({marginRight:"0px",padding:"0px"}),S2e=Fm(i0)({padding:0,marginRight:"5px"}),E2e=Fm(Yy)(({open:t})=>({display:t?"block":"none"})),T2e=Fm(ff)({marginLeft:"50px"});function Ok({visible:t=!0,name:e,children:r,setVisible:n}){const[i,a]=ee.useState(!1),[s,o]=ee.useState(!0),u=ee.useMemo(()=>t?s:!1,[t,s]),h=ee.useMemo(()=>r?Array.isArray(r)?r.map(f=>ht.cloneElement(f,{visible:u})):ht.cloneElement(r,{visible:u}):K.jsx(K.Fragment,{}),[u]);return K.jsxs(K.Fragment,{children:[K.jsxs(b2e,{children:[K.jsxs(x2e,{children:[K.jsx(w2e,{edge:"end","aria-label":"open",onClick:()=>a(!i),children:i?K.jsx(xS,{}):K.jsx(zZ,{})}),K.jsx(S2e,{disabled:n?!1:!t,checked:n?t:s,onClick:()=>{n?n(f=>!f):o(f=>!f)}})]}),K.jsx(yh,{primary:e,variant:"layerlist"})]}),K.jsx(E2e,{open:i,children:K.jsx(T2e,{disablePadding:!0,children:h})})]})}try{Ok.displayName="LayerListFolder",Ok.__docgenInfo={description:"",displayName:"LayerListFolder",props:{visible:{defaultValue:{value:"true"},description:"",name:"visible",required:!1,type:{name:"boolean"}},name:{defaultValue:null,description:"",name:"name",required:!1,type:{name:"ReactNode"}},setVisible:{defaultValue:null,description:"",name:"setVisible",required:!1,type:{name:"((visible: boolean | ((val: unknown) => boolean)) => void) | undefined"}}}}}catch{}var dc={},Dy={},rA,d9;function jZ(){if(d9)return rA;d9=1;var t=typeof Op=="object"&&Op&&Op.Object===Object&&Op;return rA=t,rA}var nA,p9;function cd(){if(p9)return nA;p9=1;var t=jZ(),e=typeof self=="object"&&self&&self.Object===Object&&self,r=t||e||Function("return this")();return nA=r,nA}var iA,g9;function ix(){if(g9)return iA;g9=1;var t=cd(),e=t.Symbol;return iA=e,iA}var aA,m9;function C2e(){if(m9)return aA;m9=1;var t=ix(),e=Object.prototype,r=e.hasOwnProperty,n=e.toString,i=t?t.toStringTag:void 0;function a(s){var o=r.call(s,i),u=s[i];try{s[i]=void 0;var h=!0}catch{}var f=n.call(s);return h&&(o?s[i]=u:delete s[i]),f}return aA=a,aA}var oA,y9;function A2e(){if(y9)return oA;y9=1;var t=Object.prototype,e=t.toString;function r(n){return e.call(n)}return oA=r,oA}var sA,v9;function $m(){if(v9)return sA;v9=1;var t=ix(),e=C2e(),r=A2e(),n="[object Null]",i="[object Undefined]",a=t?t.toStringTag:void 0;function s(o){return o==null?o===void 0?i:n:a&&a in Object(o)?e(o):r(o)}return sA=s,sA}var lA,_9;function gf(){if(_9)return lA;_9=1;var t=Array.isArray;return lA=t,lA}var uA,b9;function tp(){if(b9)return uA;b9=1;function t(e){return e!=null&&typeof e=="object"}return uA=t,uA}var cA,x9;function I2e(){if(x9)return cA;x9=1;var t=$m(),e=gf(),r=tp(),n="[object String]";function i(a){return typeof a=="string"||!e(a)&&r(a)&&t(a)==n}return cA=i,cA}var hA,w9;function P2e(){if(w9)return hA;w9=1;function t(e){return function(r,n,i){for(var a=-1,s=Object(r),o=i(r),u=o.length;u--;){var h=o[e?u:++a];if(n(s[h],h,s)===!1)break}return r}}return hA=t,hA}var fA,S9;function k2e(){if(S9)return fA;S9=1;var t=P2e(),e=t();return fA=e,fA}var dA,E9;function M2e(){if(E9)return dA;E9=1;function t(e,r){for(var n=-1,i=Array(e);++n<e;)i[n]=r(n);return i}return dA=t,dA}var pA,T9;function R2e(){if(T9)return pA;T9=1;var t=$m(),e=tp(),r="[object Arguments]";function n(i){return e(i)&&t(i)==r}return pA=n,pA}var gA,C9;function UZ(){if(C9)return gA;C9=1;var t=R2e(),e=tp(),r=Object.prototype,n=r.hasOwnProperty,i=r.propertyIsEnumerable,a=t((function(){return arguments})())?t:function(s){return e(s)&&n.call(s,"callee")&&!i.call(s,"callee")};return gA=a,gA}var r1={exports:{}},mA,A9;function O2e(){if(A9)return mA;A9=1;function t(){return!1}return mA=t,mA}r1.exports;var I9;function rL(){return I9||(I9=1,(function(t,e){var r=cd(),n=O2e(),i=e&&!e.nodeType&&e,a=i&&!0&&t&&!t.nodeType&&t,s=a&&a.exports===i,o=s?r.Buffer:void 0,u=o?o.isBuffer:void 0,h=u||n;t.exports=h})(r1,r1.exports)),r1.exports}var yA,P9;function VZ(){if(P9)return yA;P9=1;var t=9007199254740991,e=/^(?:0|[1-9]\d*)$/;function r(n,i){var a=typeof n;return i=i??t,!!i&&(a=="number"||a!="symbol"&&e.test(n))&&n>-1&&n%1==0&&n<i}return yA=r,yA}var vA,k9;function nL(){if(k9)return vA;k9=1;var t=9007199254740991;function e(r){return typeof r=="number"&&r>-1&&r%1==0&&r<=t}return vA=e,vA}var _A,M9;function L2e(){if(M9)return _A;M9=1;var t=$m(),e=nL(),r=tp(),n="[object Arguments]",i="[object Array]",a="[object Boolean]",s="[object Date]",o="[object Error]",u="[object Function]",h="[object Map]",f="[object Number]",g="[object Object]",b="[object RegExp]",v="[object Set]",S="[object String]",E="[object WeakMap]",P="[object ArrayBuffer]",k="[object DataView]",L="[object Float32Array]",O="[object Float64Array]",M="[object Int8Array]",z="[object Int16Array]",B="[object Int32Array]",q="[object Uint8Array]",W="[object Uint8ClampedArray]",G="[object Uint16Array]",ie="[object Uint32Array]",Q={};Q[L]=Q[O]=Q[M]=Q[z]=Q[B]=Q[q]=Q[W]=Q[G]=Q[ie]=!0,Q[n]=Q[i]=Q[P]=Q[a]=Q[k]=Q[s]=Q[o]=Q[u]=Q[h]=Q[f]=Q[g]=Q[b]=Q[v]=Q[S]=Q[E]=!1;function H(ne){return r(ne)&&e(ne.length)&&!!Q[t(ne)]}return _A=H,_A}var bA,R9;function iL(){if(R9)return bA;R9=1;function t(e){return function(r){return e(r)}}return bA=t,bA}var n1={exports:{}};n1.exports;var O9;function aL(){return O9||(O9=1,(function(t,e){var r=jZ(),n=e&&!e.nodeType&&e,i=n&&!0&&t&&!t.nodeType&&t,a=i&&i.exports===n,s=a&&r.process,o=(function(){try{var u=i&&i.require&&i.require("util").types;return u||s&&s.binding&&s.binding("util")}catch{}})();t.exports=o})(n1,n1.exports)),n1.exports}var xA,L9;function $Z(){if(L9)return xA;L9=1;var t=L2e(),e=iL(),r=aL(),n=r&&r.isTypedArray,i=n?e(n):t;return xA=i,xA}var wA,N9;function qZ(){if(N9)return wA;N9=1;var t=M2e(),e=UZ(),r=gf(),n=rL(),i=VZ(),a=$Z(),s=Object.prototype,o=s.hasOwnProperty;function u(h,f){var g=r(h),b=!g&&e(h),v=!g&&!b&&n(h),S=!g&&!b&&!v&&a(h),E=g||b||v||S,P=E?t(h.length,String):[],k=P.length;for(var L in h)(f||o.call(h,L))&&!(E&&(L=="length"||v&&(L=="offset"||L=="parent")||S&&(L=="buffer"||L=="byteLength"||L=="byteOffset")||i(L,k)))&&P.push(L);return P}return wA=u,wA}var SA,D9;function oL(){if(D9)return SA;D9=1;var t=Object.prototype;function e(r){var n=r&&r.constructor,i=typeof n=="function"&&n.prototype||t;return r===i}return SA=e,SA}var EA,F9;function HZ(){if(F9)return EA;F9=1;function t(e,r){return function(n){return e(r(n))}}return EA=t,EA}var TA,B9;function N2e(){if(B9)return TA;B9=1;var t=HZ(),e=t(Object.keys,Object);return TA=e,TA}var CA,z9;function D2e(){if(z9)return CA;z9=1;var t=oL(),e=N2e(),r=Object.prototype,n=r.hasOwnProperty;function i(a){if(!t(a))return e(a);var s=[];for(var o in Object(a))n.call(a,o)&&o!="constructor"&&s.push(o);return s}return CA=i,CA}var AA,j9;function z0(){if(j9)return AA;j9=1;function t(e){var r=typeof e;return e!=null&&(r=="object"||r=="function")}return AA=t,AA}var IA,U9;function WZ(){if(U9)return IA;U9=1;var t=$m(),e=z0(),r="[object AsyncFunction]",n="[object Function]",i="[object GeneratorFunction]",a="[object Proxy]";function s(o){if(!e(o))return!1;var u=t(o);return u==n||u==i||u==r||u==a}return IA=s,IA}var PA,V9;function _T(){if(V9)return PA;V9=1;var t=WZ(),e=nL();function r(n){return n!=null&&e(n.length)&&!t(n)}return PA=r,PA}var kA,$9;function ax(){if($9)return kA;$9=1;var t=qZ(),e=D2e(),r=_T();function n(i){return r(i)?t(i):e(i)}return kA=n,kA}var MA,q9;function GZ(){if(q9)return MA;q9=1;var t=k2e(),e=ax();function r(n,i){return n&&t(n,i,e)}return MA=r,MA}var RA,H9;function XZ(){if(H9)return RA;H9=1;function t(e){return e}return RA=t,RA}var OA,W9;function F2e(){if(W9)return OA;W9=1;var t=XZ();function e(r){return typeof r=="function"?r:t}return OA=e,OA}var LA,G9;function sL(){if(G9)return LA;G9=1;var t=GZ(),e=F2e();function r(n,i){return n&&t(n,e(i))}return LA=r,LA}var NA,X9;function lL(){if(X9)return NA;X9=1;var t=HZ(),e=t(Object.getPrototypeOf,Object);return NA=e,NA}var DA,Y9;function B2e(){if(Y9)return DA;Y9=1;var t=$m(),e=lL(),r=tp(),n="[object Object]",i=Function.prototype,a=Object.prototype,s=i.toString,o=a.hasOwnProperty,u=s.call(Object);function h(f){if(!r(f)||t(f)!=n)return!1;var g=e(f);if(g===null)return!0;var b=o.call(g,"constructor")&&g.constructor;return typeof b=="function"&&b instanceof b&&s.call(b)==u}return DA=h,DA}var FA,Z9;function YZ(){if(Z9)return FA;Z9=1;function t(e,r){for(var n=-1,i=e==null?0:e.length,a=Array(i);++n<i;)a[n]=r(e[n],n,e);return a}return FA=t,FA}var BA,K9;function z2e(){if(K9)return BA;K9=1;function t(){this.__data__=[],this.size=0}return BA=t,BA}var zA,J9;function uL(){if(J9)return zA;J9=1;function t(e,r){return e===r||e!==e&&r!==r}return zA=t,zA}var jA,Q9;function bT(){if(Q9)return jA;Q9=1;var t=uL();function e(r,n){for(var i=r.length;i--;)if(t(r[i][0],n))return i;return-1}return jA=e,jA}var UA,ej;function j2e(){if(ej)return UA;ej=1;var t=bT(),e=Array.prototype,r=e.splice;function n(i){var a=this.__data__,s=t(a,i);if(s<0)return!1;var o=a.length-1;return s==o?a.pop():r.call(a,s,1),--this.size,!0}return UA=n,UA}var VA,tj;function U2e(){if(tj)return VA;tj=1;var t=bT();function e(r){var n=this.__data__,i=t(n,r);return i<0?void 0:n[i][1]}return VA=e,VA}var $A,rj;function V2e(){if(rj)return $A;rj=1;var t=bT();function e(r){return t(this.__data__,r)>-1}return $A=e,$A}var qA,nj;function $2e(){if(nj)return qA;nj=1;var t=bT();function e(r,n){var i=this.__data__,a=t(i,r);return a<0?(++this.size,i.push([r,n])):i[a][1]=n,this}return qA=e,qA}var HA,ij;function xT(){if(ij)return HA;ij=1;var t=z2e(),e=j2e(),r=U2e(),n=V2e(),i=$2e();function a(s){var o=-1,u=s==null?0:s.length;for(this.clear();++o<u;){var h=s[o];this.set(h[0],h[1])}}return a.prototype.clear=t,a.prototype.delete=e,a.prototype.get=r,a.prototype.has=n,a.prototype.set=i,HA=a,HA}var WA,aj;function q2e(){if(aj)return WA;aj=1;var t=xT();function e(){this.__data__=new t,this.size=0}return WA=e,WA}var GA,oj;function H2e(){if(oj)return GA;oj=1;function t(e){var r=this.__data__,n=r.delete(e);return this.size=r.size,n}return GA=t,GA}var XA,sj;function W2e(){if(sj)return XA;sj=1;function t(e){return this.__data__.get(e)}return XA=t,XA}var YA,lj;function G2e(){if(lj)return YA;lj=1;function t(e){return this.__data__.has(e)}return YA=t,YA}var ZA,uj;function X2e(){if(uj)return ZA;uj=1;var t=cd(),e=t["__core-js_shared__"];return ZA=e,ZA}var KA,cj;function Y2e(){if(cj)return KA;cj=1;var t=X2e(),e=(function(){var n=/[^.]+$/.exec(t&&t.keys&&t.keys.IE_PROTO||"");return n?"Symbol(src)_1."+n:""})();function r(n){return!!e&&e in n}return KA=r,KA}var JA,hj;function ZZ(){if(hj)return JA;hj=1;var t=Function.prototype,e=t.toString;function r(n){if(n!=null){try{return e.call(n)}catch{}try{return n+""}catch{}}return""}return JA=r,JA}var QA,fj;function Z2e(){if(fj)return QA;fj=1;var t=WZ(),e=Y2e(),r=z0(),n=ZZ(),i=/[\\^$.*+?()[\]{}|]/g,a=/^\[object .+?Constructor\]$/,s=Function.prototype,o=Object.prototype,u=s.toString,h=o.hasOwnProperty,f=RegExp("^"+u.call(h).replace(i,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function g(b){if(!r(b)||e(b))return!1;var v=t(b)?f:a;return v.test(n(b))}return QA=g,QA}var e5,dj;function K2e(){if(dj)return e5;dj=1;function t(e,r){return e?.[r]}return e5=t,e5}var t5,pj;function qm(){if(pj)return t5;pj=1;var t=Z2e(),e=K2e();function r(n,i){var a=e(n,i);return t(a)?a:void 0}return t5=r,t5}var r5,gj;function cL(){if(gj)return r5;gj=1;var t=qm(),e=cd(),r=t(e,"Map");return r5=r,r5}var n5,mj;function wT(){if(mj)return n5;mj=1;var t=qm(),e=t(Object,"create");return n5=e,n5}var i5,yj;function J2e(){if(yj)return i5;yj=1;var t=wT();function e(){this.__data__=t?t(null):{},this.size=0}return i5=e,i5}var a5,vj;function Q2e(){if(vj)return a5;vj=1;function t(e){var r=this.has(e)&&delete this.__data__[e];return this.size-=r?1:0,r}return a5=t,a5}var o5,_j;function ewe(){if(_j)return o5;_j=1;var t=wT(),e="__lodash_hash_undefined__",r=Object.prototype,n=r.hasOwnProperty;function i(a){var s=this.__data__;if(t){var o=s[a];return o===e?void 0:o}return n.call(s,a)?s[a]:void 0}return o5=i,o5}var s5,bj;function twe(){if(bj)return s5;bj=1;var t=wT(),e=Object.prototype,r=e.hasOwnProperty;function n(i){var a=this.__data__;return t?a[i]!==void 0:r.call(a,i)}return s5=n,s5}var l5,xj;function rwe(){if(xj)return l5;xj=1;var t=wT(),e="__lodash_hash_undefined__";function r(n,i){var a=this.__data__;return this.size+=this.has(n)?0:1,a[n]=t&&i===void 0?e:i,this}return l5=r,l5}var u5,wj;function nwe(){if(wj)return u5;wj=1;var t=J2e(),e=Q2e(),r=ewe(),n=twe(),i=rwe();function a(s){var o=-1,u=s==null?0:s.length;for(this.clear();++o<u;){var h=s[o];this.set(h[0],h[1])}}return a.prototype.clear=t,a.prototype.delete=e,a.prototype.get=r,a.prototype.has=n,a.prototype.set=i,u5=a,u5}var c5,Sj;function iwe(){if(Sj)return c5;Sj=1;var t=nwe(),e=xT(),r=cL();function n(){this.size=0,this.__data__={hash:new t,map:new(r||e),string:new t}}return c5=n,c5}var h5,Ej;function awe(){if(Ej)return h5;Ej=1;function t(e){var r=typeof e;return r=="string"||r=="number"||r=="symbol"||r=="boolean"?e!=="__proto__":e===null}return h5=t,h5}var f5,Tj;function ST(){if(Tj)return f5;Tj=1;var t=awe();function e(r,n){var i=r.__data__;return t(n)?i[typeof n=="string"?"string":"hash"]:i.map}return f5=e,f5}var d5,Cj;function owe(){if(Cj)return d5;Cj=1;var t=ST();function e(r){var n=t(this,r).delete(r);return this.size-=n?1:0,n}return d5=e,d5}var p5,Aj;function swe(){if(Aj)return p5;Aj=1;var t=ST();function e(r){return t(this,r).get(r)}return p5=e,p5}var g5,Ij;function lwe(){if(Ij)return g5;Ij=1;var t=ST();function e(r){return t(this,r).has(r)}return g5=e,g5}var m5,Pj;function uwe(){if(Pj)return m5;Pj=1;var t=ST();function e(r,n){var i=t(this,r),a=i.size;return i.set(r,n),this.size+=i.size==a?0:1,this}return m5=e,m5}var y5,kj;function hL(){if(kj)return y5;kj=1;var t=iwe(),e=owe(),r=swe(),n=lwe(),i=uwe();function a(s){var o=-1,u=s==null?0:s.length;for(this.clear();++o<u;){var h=s[o];this.set(h[0],h[1])}}return a.prototype.clear=t,a.prototype.delete=e,a.prototype.get=r,a.prototype.has=n,a.prototype.set=i,y5=a,y5}var v5,Mj;function cwe(){if(Mj)return v5;Mj=1;var t=xT(),e=cL(),r=hL(),n=200;function i(a,s){var o=this.__data__;if(o instanceof t){var u=o.__data__;if(!e||u.length<n-1)return u.push([a,s]),this.size=++o.size,this;o=this.__data__=new r(u)}return o.set(a,s),this.size=o.size,this}return v5=i,v5}var _5,Rj;function fL(){if(Rj)return _5;Rj=1;var t=xT(),e=q2e(),r=H2e(),n=W2e(),i=G2e(),a=cwe();function s(o){var u=this.__data__=new t(o);this.size=u.size}return s.prototype.clear=e,s.prototype.delete=r,s.prototype.get=n,s.prototype.has=i,s.prototype.set=a,_5=s,_5}var b5,Oj;function hwe(){if(Oj)return b5;Oj=1;var t="__lodash_hash_undefined__";function e(r){return this.__data__.set(r,t),this}return b5=e,b5}var x5,Lj;function fwe(){if(Lj)return x5;Lj=1;function t(e){return this.__data__.has(e)}return x5=t,x5}var w5,Nj;function dwe(){if(Nj)return w5;Nj=1;var t=hL(),e=hwe(),r=fwe();function n(i){var a=-1,s=i==null?0:i.length;for(this.__data__=new t;++a<s;)this.add(i[a])}return n.prototype.add=n.prototype.push=e,n.prototype.has=r,w5=n,w5}var S5,Dj;function pwe(){if(Dj)return S5;Dj=1;function t(e,r){for(var n=-1,i=e==null?0:e.length;++n<i;)if(r(e[n],n,e))return!0;return!1}return S5=t,S5}var E5,Fj;function gwe(){if(Fj)return E5;Fj=1;function t(e,r){return e.has(r)}return E5=t,E5}var T5,Bj;function KZ(){if(Bj)return T5;Bj=1;var t=dwe(),e=pwe(),r=gwe(),n=1,i=2;function a(s,o,u,h,f,g){var b=u&n,v=s.length,S=o.length;if(v!=S&&!(b&&S>v))return!1;var E=g.get(s),P=g.get(o);if(E&&P)return E==o&&P==s;var k=-1,L=!0,O=u&i?new t:void 0;for(g.set(s,o),g.set(o,s);++k<v;){var M=s[k],z=o[k];if(h)var B=b?h(z,M,k,o,s,g):h(M,z,k,s,o,g);if(B!==void 0){if(B)continue;L=!1;break}if(O){if(!e(o,function(q,W){if(!r(O,W)&&(M===q||f(M,q,u,h,g)))return O.push(W)})){L=!1;break}}else if(!(M===z||f(M,z,u,h,g))){L=!1;break}}return g.delete(s),g.delete(o),L}return T5=a,T5}var C5,zj;function JZ(){if(zj)return C5;zj=1;var t=cd(),e=t.Uint8Array;return C5=e,C5}var A5,jj;function mwe(){if(jj)return A5;jj=1;function t(e){var r=-1,n=Array(e.size);return e.forEach(function(i,a){n[++r]=[a,i]}),n}return A5=t,A5}var I5,Uj;function ywe(){if(Uj)return I5;Uj=1;function t(e){var r=-1,n=Array(e.size);return e.forEach(function(i){n[++r]=i}),n}return I5=t,I5}var P5,Vj;function vwe(){if(Vj)return P5;Vj=1;var t=ix(),e=JZ(),r=uL(),n=KZ(),i=mwe(),a=ywe(),s=1,o=2,u="[object Boolean]",h="[object Date]",f="[object Error]",g="[object Map]",b="[object Number]",v="[object RegExp]",S="[object Set]",E="[object String]",P="[object Symbol]",k="[object ArrayBuffer]",L="[object DataView]",O=t?t.prototype:void 0,M=O?O.valueOf:void 0;function z(B,q,W,G,ie,Q,H){switch(W){case L:if(B.byteLength!=q.byteLength||B.byteOffset!=q.byteOffset)return!1;B=B.buffer,q=q.buffer;case k:return!(B.byteLength!=q.byteLength||!Q(new e(B),new e(q)));case u:case h:case b:return r(+B,+q);case f:return B.name==q.name&&B.message==q.message;case v:case E:return B==q+"";case g:var ne=i;case S:var oe=G&s;if(ne||(ne=a),B.size!=q.size&&!oe)return!1;var ce=H.get(B);if(ce)return ce==q;G|=o,H.set(B,q);var fe=n(ne(B),ne(q),G,ie,Q,H);return H.delete(B),fe;case P:if(M)return M.call(B)==M.call(q)}return!1}return P5=z,P5}var k5,$j;function QZ(){if($j)return k5;$j=1;function t(e,r){for(var n=-1,i=r.length,a=e.length;++n<i;)e[a+n]=r[n];return e}return k5=t,k5}var M5,qj;function eK(){if(qj)return M5;qj=1;var t=QZ(),e=gf();function r(n,i,a){var s=i(n);return e(n)?s:t(s,a(n))}return M5=r,M5}var R5,Hj;function _we(){if(Hj)return R5;Hj=1;function t(e,r){for(var n=-1,i=e==null?0:e.length,a=0,s=[];++n<i;){var o=e[n];r(o,n,e)&&(s[a++]=o)}return s}return R5=t,R5}var O5,Wj;function tK(){if(Wj)return O5;Wj=1;function t(){return[]}return O5=t,O5}var L5,Gj;function dL(){if(Gj)return L5;Gj=1;var t=_we(),e=tK(),r=Object.prototype,n=r.propertyIsEnumerable,i=Object.getOwnPropertySymbols,a=i?function(s){return s==null?[]:(s=Object(s),t(i(s),function(o){return n.call(s,o)}))}:e;return L5=a,L5}var N5,Xj;function rK(){if(Xj)return N5;Xj=1;var t=eK(),e=dL(),r=ax();function n(i){return t(i,r,e)}return N5=n,N5}var D5,Yj;function bwe(){if(Yj)return D5;Yj=1;var t=rK(),e=1,r=Object.prototype,n=r.hasOwnProperty;function i(a,s,o,u,h,f){var g=o&e,b=t(a),v=b.length,S=t(s),E=S.length;if(v!=E&&!g)return!1;for(var P=v;P--;){var k=b[P];if(!(g?k in s:n.call(s,k)))return!1}var L=f.get(a),O=f.get(s);if(L&&O)return L==s&&O==a;var M=!0;f.set(a,s),f.set(s,a);for(var z=g;++P<v;){k=b[P];var B=a[k],q=s[k];if(u)var W=g?u(q,B,k,s,a,f):u(B,q,k,a,s,f);if(!(W===void 0?B===q||h(B,q,o,u,f):W)){M=!1;break}z||(z=k=="constructor")}if(M&&!z){var G=a.constructor,ie=s.constructor;G!=ie&&"constructor"in a&&"constructor"in s&&!(typeof G=="function"&&G instanceof G&&typeof ie=="function"&&ie instanceof ie)&&(M=!1)}return f.delete(a),f.delete(s),M}return D5=i,D5}var F5,Zj;function xwe(){if(Zj)return F5;Zj=1;var t=qm(),e=cd(),r=t(e,"DataView");return F5=r,F5}var B5,Kj;function wwe(){if(Kj)return B5;Kj=1;var t=qm(),e=cd(),r=t(e,"Promise");return B5=r,B5}var z5,Jj;function Swe(){if(Jj)return z5;Jj=1;var t=qm(),e=cd(),r=t(e,"Set");return z5=r,z5}var j5,Qj;function Ewe(){if(Qj)return j5;Qj=1;var t=qm(),e=cd(),r=t(e,"WeakMap");return j5=r,j5}var U5,e7;function ET(){if(e7)return U5;e7=1;var t=xwe(),e=cL(),r=wwe(),n=Swe(),i=Ewe(),a=$m(),s=ZZ(),o="[object Map]",u="[object Object]",h="[object Promise]",f="[object Set]",g="[object WeakMap]",b="[object DataView]",v=s(t),S=s(e),E=s(r),P=s(n),k=s(i),L=a;return(t&&L(new t(new ArrayBuffer(1)))!=b||e&&L(new e)!=o||r&&L(r.resolve())!=h||n&&L(new n)!=f||i&&L(new i)!=g)&&(L=function(O){var M=a(O),z=M==u?O.constructor:void 0,B=z?s(z):"";if(B)switch(B){case v:return b;case S:return o;case E:return h;case P:return f;case k:return g}return M}),U5=L,U5}var V5,t7;function Twe(){if(t7)return V5;t7=1;var t=fL(),e=KZ(),r=vwe(),n=bwe(),i=ET(),a=gf(),s=rL(),o=$Z(),u=1,h="[object Arguments]",f="[object Array]",g="[object Object]",b=Object.prototype,v=b.hasOwnProperty;function S(E,P,k,L,O,M){var z=a(E),B=a(P),q=z?f:i(E),W=B?f:i(P);q=q==h?g:q,W=W==h?g:W;var G=q==g,ie=W==g,Q=q==W;if(Q&&s(E)){if(!s(P))return!1;z=!0,G=!1}if(Q&&!G)return M||(M=new t),z||o(E)?e(E,P,k,L,O,M):r(E,P,q,k,L,O,M);if(!(k&u)){var H=G&&v.call(E,"__wrapped__"),ne=ie&&v.call(P,"__wrapped__");if(H||ne){var oe=H?E.value():E,ce=ne?P.value():P;return M||(M=new t),O(oe,ce,k,L,M)}}return Q?(M||(M=new t),n(E,P,k,L,O,M)):!1}return V5=S,V5}var $5,r7;function nK(){if(r7)return $5;r7=1;var t=Twe(),e=tp();function r(n,i,a,s,o){return n===i?!0:n==null||i==null||!e(n)&&!e(i)?n!==n&&i!==i:t(n,i,a,s,r,o)}return $5=r,$5}var q5,n7;function Cwe(){if(n7)return q5;n7=1;var t=fL(),e=nK(),r=1,n=2;function i(a,s,o,u){var h=o.length,f=h,g=!u;if(a==null)return!f;for(a=Object(a);h--;){var b=o[h];if(g&&b[2]?b[1]!==a[b[0]]:!(b[0]in a))return!1}for(;++h<f;){b=o[h];var v=b[0],S=a[v],E=b[1];if(g&&b[2]){if(S===void 0&&!(v in a))return!1}else{var P=new t;if(u)var k=u(S,E,v,a,s,P);if(!(k===void 0?e(E,S,r|n,u,P):k))return!1}}return!0}return q5=i,q5}var H5,i7;function iK(){if(i7)return H5;i7=1;var t=z0();function e(r){return r===r&&!t(r)}return H5=e,H5}var W5,a7;function Awe(){if(a7)return W5;a7=1;var t=iK(),e=ax();function r(n){for(var i=e(n),a=i.length;a--;){var s=i[a],o=n[s];i[a]=[s,o,t(o)]}return i}return W5=r,W5}var G5,o7;function aK(){if(o7)return G5;o7=1;function t(e,r){return function(n){return n==null?!1:n[e]===r&&(r!==void 0||e in Object(n))}}return G5=t,G5}var X5,s7;function Iwe(){if(s7)return X5;s7=1;var t=Cwe(),e=Awe(),r=aK();function n(i){var a=e(i);return a.length==1&&a[0][2]?r(a[0][0],a[0][1]):function(s){return s===i||t(s,i,a)}}return X5=n,X5}var Y5,l7;function pL(){if(l7)return Y5;l7=1;var t=$m(),e=tp(),r="[object Symbol]";function n(i){return typeof i=="symbol"||e(i)&&t(i)==r}return Y5=n,Y5}var Z5,u7;function gL(){if(u7)return Z5;u7=1;var t=gf(),e=pL(),r=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,n=/^\w*$/;function i(a,s){if(t(a))return!1;var o=typeof a;return o=="number"||o=="symbol"||o=="boolean"||a==null||e(a)?!0:n.test(a)||!r.test(a)||s!=null&&a in Object(s)}return Z5=i,Z5}var K5,c7;function Pwe(){if(c7)return K5;c7=1;var t=hL(),e="Expected a function";function r(n,i){if(typeof n!="function"||i!=null&&typeof i!="function")throw new TypeError(e);var a=function(){var s=arguments,o=i?i.apply(this,s):s[0],u=a.cache;if(u.has(o))return u.get(o);var h=n.apply(this,s);return a.cache=u.set(o,h)||u,h};return a.cache=new(r.Cache||t),a}return r.Cache=t,K5=r,K5}var J5,h7;function kwe(){if(h7)return J5;h7=1;var t=Pwe(),e=500;function r(n){var i=t(n,function(s){return a.size===e&&a.clear(),s}),a=i.cache;return i}return J5=r,J5}var Q5,f7;function Mwe(){if(f7)return Q5;f7=1;var t=kwe(),e=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,r=/\\(\\)?/g,n=t(function(i){var a=[];return i.charCodeAt(0)===46&&a.push(""),i.replace(e,function(s,o,u,h){a.push(u?h.replace(r,"$1"):o||s)}),a});return Q5=n,Q5}var e4,d7;function Rwe(){if(d7)return e4;d7=1;var t=ix(),e=YZ(),r=gf(),n=pL(),i=t?t.prototype:void 0,a=i?i.toString:void 0;function s(o){if(typeof o=="string")return o;if(r(o))return e(o,s)+"";if(n(o))return a?a.call(o):"";var u=o+"";return u=="0"&&1/o==-1/0?"-0":u}return e4=s,e4}var t4,p7;function Owe(){if(p7)return t4;p7=1;var t=Rwe();function e(r){return r==null?"":t(r)}return t4=e,t4}var r4,g7;function oK(){if(g7)return r4;g7=1;var t=gf(),e=gL(),r=Mwe(),n=Owe();function i(a,s){return t(a)?a:e(a,s)?[a]:r(n(a))}return r4=i,r4}var n4,m7;function TT(){if(m7)return n4;m7=1;var t=pL();function e(r){if(typeof r=="string"||t(r))return r;var n=r+"";return n=="0"&&1/r==-1/0?"-0":n}return n4=e,n4}var i4,y7;function sK(){if(y7)return i4;y7=1;var t=oK(),e=TT();function r(n,i){i=t(i,n);for(var a=0,s=i.length;n!=null&&a<s;)n=n[e(i[a++])];return a&&a==s?n:void 0}return i4=r,i4}var a4,v7;function Lwe(){if(v7)return a4;v7=1;var t=sK();function e(r,n,i){var a=r==null?void 0:t(r,n);return a===void 0?i:a}return a4=e,a4}var o4,_7;function Nwe(){if(_7)return o4;_7=1;function t(e,r){return e!=null&&r in Object(e)}return o4=t,o4}var s4,b7;function Dwe(){if(b7)return s4;b7=1;var t=oK(),e=UZ(),r=gf(),n=VZ(),i=nL(),a=TT();function s(o,u,h){u=t(u,o);for(var f=-1,g=u.length,b=!1;++f<g;){var v=a(u[f]);if(!(b=o!=null&&h(o,v)))break;o=o[v]}return b||++f!=g?b:(g=o==null?0:o.length,!!g&&i(g)&&n(v,g)&&(r(o)||e(o)))}return s4=s,s4}var l4,x7;function Fwe(){if(x7)return l4;x7=1;var t=Nwe(),e=Dwe();function r(n,i){return n!=null&&e(n,i,t)}return l4=r,l4}var u4,w7;function Bwe(){if(w7)return u4;w7=1;var t=nK(),e=Lwe(),r=Fwe(),n=gL(),i=iK(),a=aK(),s=TT(),o=1,u=2;function h(f,g){return n(f)&&i(g)?a(s(f),g):function(b){var v=e(b,f);return v===void 0&&v===g?r(b,f):t(g,v,o|u)}}return u4=h,u4}var c4,S7;function zwe(){if(S7)return c4;S7=1;function t(e){return function(r){return r?.[e]}}return c4=t,c4}var h4,E7;function jwe(){if(E7)return h4;E7=1;var t=sK();function e(r){return function(n){return t(n,r)}}return h4=e,h4}var f4,T7;function Uwe(){if(T7)return f4;T7=1;var t=zwe(),e=jwe(),r=gL(),n=TT();function i(a){return r(a)?t(n(a)):e(a)}return f4=i,f4}var d4,C7;function Vwe(){if(C7)return d4;C7=1;var t=Iwe(),e=Bwe(),r=XZ(),n=gf(),i=Uwe();function a(s){return typeof s=="function"?s:s==null?r:typeof s=="object"?n(s)?e(s[0],s[1]):t(s):i(s)}return d4=a,d4}var p4,A7;function $we(){if(A7)return p4;A7=1;var t=_T();function e(r,n){return function(i,a){if(i==null)return i;if(!t(i))return r(i,a);for(var s=i.length,o=n?s:-1,u=Object(i);(n?o--:++o<s)&&a(u[o],o,u)!==!1;);return i}}return p4=e,p4}var g4,I7;function qwe(){if(I7)return g4;I7=1;var t=GZ(),e=$we(),r=e(t);return g4=r,g4}var m4,P7;function Hwe(){if(P7)return m4;P7=1;var t=qwe(),e=_T();function r(n,i){var a=-1,s=e(n)?Array(n.length):[];return t(n,function(o,u,h){s[++a]=i(o,u,h)}),s}return m4=r,m4}var y4,k7;function Wwe(){if(k7)return y4;k7=1;var t=YZ(),e=Vwe(),r=Hwe(),n=gf();function i(a,s){var o=n(a)?t:r;return o(a,e(s,3))}return y4=i,y4}var M7;function Gwe(){if(M7)return Dy;M7=1,Object.defineProperty(Dy,"__esModule",{value:!0}),Dy.flattenNames=void 0;var t=I2e(),e=u(t),r=sL(),n=u(r),i=B2e(),a=u(i),s=Wwe(),o=u(s);function u(f){return f&&f.__esModule?f:{default:f}}var h=Dy.flattenNames=function f(){var g=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],b=[];return(0,o.default)(g,function(v){Array.isArray(v)?f(v).map(function(S){return b.push(S)}):(0,a.default)(v)?(0,n.default)(v,function(S,E){S===!0&&b.push(E),b.push(E+"-"+S)}):(0,e.default)(v)&&b.push(v)}),b};return Dy.default=h,Dy}var Fy={},v4,R7;function Xwe(){if(R7)return v4;R7=1;function t(e,r){for(var n=-1,i=e==null?0:e.length;++n<i&&r(e[n],n,e)!==!1;);return e}return v4=t,v4}var _4,O7;function Ywe(){if(O7)return _4;O7=1;var t=qm(),e=(function(){try{var r=t(Object,"defineProperty");return r({},"",{}),r}catch{}})();return _4=e,_4}var b4,L7;function lK(){if(L7)return b4;L7=1;var t=Ywe();function e(r,n,i){n=="__proto__"&&t?t(r,n,{configurable:!0,enumerable:!0,value:i,writable:!0}):r[n]=i}return b4=e,b4}var x4,N7;function uK(){if(N7)return x4;N7=1;var t=lK(),e=uL(),r=Object.prototype,n=r.hasOwnProperty;function i(a,s,o){var u=a[s];(!(n.call(a,s)&&e(u,o))||o===void 0&&!(s in a))&&t(a,s,o)}return x4=i,x4}var w4,D7;function CT(){if(D7)return w4;D7=1;var t=uK(),e=lK();function r(n,i,a,s){var o=!a;a||(a={});for(var u=-1,h=i.length;++u<h;){var f=i[u],g=s?s(a[f],n[f],f,a,n):void 0;g===void 0&&(g=n[f]),o?e(a,f,g):t(a,f,g)}return a}return w4=r,w4}var S4,F7;function Zwe(){if(F7)return S4;F7=1;var t=CT(),e=ax();function r(n,i){return n&&t(i,e(i),n)}return S4=r,S4}var E4,B7;function Kwe(){if(B7)return E4;B7=1;function t(e){var r=[];if(e!=null)for(var n in Object(e))r.push(n);return r}return E4=t,E4}var T4,z7;function Jwe(){if(z7)return T4;z7=1;var t=z0(),e=oL(),r=Kwe(),n=Object.prototype,i=n.hasOwnProperty;function a(s){if(!t(s))return r(s);var o=e(s),u=[];for(var h in s)h=="constructor"&&(o||!i.call(s,h))||u.push(h);return u}return T4=a,T4}var C4,j7;function mL(){if(j7)return C4;j7=1;var t=qZ(),e=Jwe(),r=_T();function n(i){return r(i)?t(i,!0):e(i)}return C4=n,C4}var A4,U7;function Qwe(){if(U7)return A4;U7=1;var t=CT(),e=mL();function r(n,i){return n&&t(i,e(i),n)}return A4=r,A4}var i1={exports:{}};i1.exports;var V7;function eSe(){return V7||(V7=1,(function(t,e){var r=cd(),n=e&&!e.nodeType&&e,i=n&&!0&&t&&!t.nodeType&&t,a=i&&i.exports===n,s=a?r.Buffer:void 0,o=s?s.allocUnsafe:void 0;function u(h,f){if(f)return h.slice();var g=h.length,b=o?o(g):new h.constructor(g);return h.copy(b),b}t.exports=u})(i1,i1.exports)),i1.exports}var I4,$7;function tSe(){if($7)return I4;$7=1;function t(e,r){var n=-1,i=e.length;for(r||(r=Array(i));++n<i;)r[n]=e[n];return r}return I4=t,I4}var P4,q7;function rSe(){if(q7)return P4;q7=1;var t=CT(),e=dL();function r(n,i){return t(n,e(n),i)}return P4=r,P4}var k4,H7;function cK(){if(H7)return k4;H7=1;var t=QZ(),e=lL(),r=dL(),n=tK(),i=Object.getOwnPropertySymbols,a=i?function(s){for(var o=[];s;)t(o,r(s)),s=e(s);return o}:n;return k4=a,k4}var M4,W7;function nSe(){if(W7)return M4;W7=1;var t=CT(),e=cK();function r(n,i){return t(n,e(n),i)}return M4=r,M4}var R4,G7;function iSe(){if(G7)return R4;G7=1;var t=eK(),e=cK(),r=mL();function n(i){return t(i,r,e)}return R4=n,R4}var O4,X7;function aSe(){if(X7)return O4;X7=1;var t=Object.prototype,e=t.hasOwnProperty;function r(n){var i=n.length,a=new n.constructor(i);return i&&typeof n[0]=="string"&&e.call(n,"index")&&(a.index=n.index,a.input=n.input),a}return O4=r,O4}var L4,Y7;function yL(){if(Y7)return L4;Y7=1;var t=JZ();function e(r){var n=new r.constructor(r.byteLength);return new t(n).set(new t(r)),n}return L4=e,L4}var N4,Z7;function oSe(){if(Z7)return N4;Z7=1;var t=yL();function e(r,n){var i=n?t(r.buffer):r.buffer;return new r.constructor(i,r.byteOffset,r.byteLength)}return N4=e,N4}var D4,K7;function sSe(){if(K7)return D4;K7=1;var t=/\w*$/;function e(r){var n=new r.constructor(r.source,t.exec(r));return n.lastIndex=r.lastIndex,n}return D4=e,D4}var F4,J7;function lSe(){if(J7)return F4;J7=1;var t=ix(),e=t?t.prototype:void 0,r=e?e.valueOf:void 0;function n(i){return r?Object(r.call(i)):{}}return F4=n,F4}var B4,Q7;function uSe(){if(Q7)return B4;Q7=1;var t=yL();function e(r,n){var i=n?t(r.buffer):r.buffer;return new r.constructor(i,r.byteOffset,r.length)}return B4=e,B4}var z4,eU;function cSe(){if(eU)return z4;eU=1;var t=yL(),e=oSe(),r=sSe(),n=lSe(),i=uSe(),a="[object Boolean]",s="[object Date]",o="[object Map]",u="[object Number]",h="[object RegExp]",f="[object Set]",g="[object String]",b="[object Symbol]",v="[object ArrayBuffer]",S="[object DataView]",E="[object Float32Array]",P="[object Float64Array]",k="[object Int8Array]",L="[object Int16Array]",O="[object Int32Array]",M="[object Uint8Array]",z="[object Uint8ClampedArray]",B="[object Uint16Array]",q="[object Uint32Array]";function W(G,ie,Q){var H=G.constructor;switch(ie){case v:return t(G);case a:case s:return new H(+G);case S:return e(G,Q);case E:case P:case k:case L:case O:case M:case z:case B:case q:return i(G,Q);case o:return new H;case u:case g:return new H(G);case h:return r(G);case f:return new H;case b:return n(G)}}return z4=W,z4}var j4,tU;function hSe(){if(tU)return j4;tU=1;var t=z0(),e=Object.create,r=(function(){function n(){}return function(i){if(!t(i))return{};if(e)return e(i);n.prototype=i;var a=new n;return n.prototype=void 0,a}})();return j4=r,j4}var U4,rU;function fSe(){if(rU)return U4;rU=1;var t=hSe(),e=lL(),r=oL();function n(i){return typeof i.constructor=="function"&&!r(i)?t(e(i)):{}}return U4=n,U4}var V4,nU;function dSe(){if(nU)return V4;nU=1;var t=ET(),e=tp(),r="[object Map]";function n(i){return e(i)&&t(i)==r}return V4=n,V4}var $4,iU;function pSe(){if(iU)return $4;iU=1;var t=dSe(),e=iL(),r=aL(),n=r&&r.isMap,i=n?e(n):t;return $4=i,$4}var q4,aU;function gSe(){if(aU)return q4;aU=1;var t=ET(),e=tp(),r="[object Set]";function n(i){return e(i)&&t(i)==r}return q4=n,q4}var H4,oU;function mSe(){if(oU)return H4;oU=1;var t=gSe(),e=iL(),r=aL(),n=r&&r.isSet,i=n?e(n):t;return H4=i,H4}var W4,sU;function ySe(){if(sU)return W4;sU=1;var t=fL(),e=Xwe(),r=uK(),n=Zwe(),i=Qwe(),a=eSe(),s=tSe(),o=rSe(),u=nSe(),h=rK(),f=iSe(),g=ET(),b=aSe(),v=cSe(),S=fSe(),E=gf(),P=rL(),k=pSe(),L=z0(),O=mSe(),M=ax(),z=mL(),B=1,q=2,W=4,G="[object Arguments]",ie="[object Array]",Q="[object Boolean]",H="[object Date]",ne="[object Error]",oe="[object Function]",ce="[object GeneratorFunction]",fe="[object Map]",Me="[object Number]",me="[object Object]",we="[object RegExp]",Te="[object Set]",ke="[object String]",he="[object Symbol]",Ee="[object WeakMap]",xe="[object ArrayBuffer]",Ne="[object DataView]",Oe="[object Float32Array]",$e="[object Float64Array]",De="[object Int8Array]",it="[object Int16Array]",Ye="[object Int32Array]",rt="[object Uint8Array]",Ie="[object Uint8ClampedArray]",Mt="[object Uint16Array]",at="[object Uint32Array]",je={};je[G]=je[ie]=je[xe]=je[Ne]=je[Q]=je[H]=je[Oe]=je[$e]=je[De]=je[it]=je[Ye]=je[fe]=je[Me]=je[me]=je[we]=je[Te]=je[ke]=je[he]=je[rt]=je[Ie]=je[Mt]=je[at]=!0,je[ne]=je[oe]=je[Ee]=!1;function Xt(Yt,pr,vt,yr,_r,cr){var Er,wr=pr&B,er=pr&q,lr=pr&W;if(vt&&(Er=_r?vt(Yt,yr,_r,cr):vt(Yt)),Er!==void 0)return Er;if(!L(Yt))return Yt;var Ar=E(Yt);if(Ar){if(Er=b(Yt),!wr)return s(Yt,Er)}else{var ir=g(Yt),nt=ir==oe||ir==ce;if(P(Yt))return a(Yt,wr);if(ir==me||ir==G||nt&&!_r){if(Er=er||nt?{}:S(Yt),!wr)return er?u(Yt,i(Er,Yt)):o(Yt,n(Er,Yt))}else{if(!je[ir])return _r?Yt:{};Er=v(Yt,ir,wr)}}cr||(cr=new t);var _e=cr.get(Yt);if(_e)return _e;cr.set(Yt,Er),O(Yt)?Yt.forEach(function(Qe){Er.add(Xt(Qe,pr,vt,Qe,Yt,cr))}):k(Yt)&&Yt.forEach(function(Qe,ot){Er.set(ot,Xt(Qe,pr,vt,ot,Yt,cr))});var be=lr?er?f:h:er?z:M,qe=Ar?void 0:be(Yt);return e(qe||Yt,function(Qe,ot){qe&&(ot=Qe,Qe=Yt[ot]),r(Er,ot,Xt(Qe,pr,vt,ot,Yt,cr))}),Er}return W4=Xt,W4}var G4,lU;function vSe(){if(lU)return G4;lU=1;var t=ySe(),e=1,r=4;function n(i){return t(i,e|r)}return G4=n,G4}var uU;function _Se(){if(uU)return Fy;uU=1,Object.defineProperty(Fy,"__esModule",{value:!0}),Fy.mergeClasses=void 0;var t=sL(),e=a(t),r=vSe(),n=a(r),i=Object.assign||function(o){for(var u=1;u<arguments.length;u++){var h=arguments[u];for(var f in h)Object.prototype.hasOwnProperty.call(h,f)&&(o[f]=h[f])}return o};function a(o){return o&&o.__esModule?o:{default:o}}var s=Fy.mergeClasses=function(u){var h=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],f=u.default&&(0,n.default)(u.default)||{};return h.map(function(g){var b=u[g];return b&&(0,e.default)(b,function(v,S){f[S]||(f[S]={}),f[S]=i({},f[S],b[S])}),g}),f};return Fy.default=s,Fy}var By={},cU;function bSe(){if(cU)return By;cU=1,Object.defineProperty(By,"__esModule",{value:!0}),By.autoprefix=void 0;var t=sL(),e=n(t),r=Object.assign||function(s){for(var o=1;o<arguments.length;o++){var u=arguments[o];for(var h in u)Object.prototype.hasOwnProperty.call(u,h)&&(s[h]=u[h])}return s};function n(s){return s&&s.__esModule?s:{default:s}}var i={borderRadius:function(o){return{msBorderRadius:o,MozBorderRadius:o,OBorderRadius:o,WebkitBorderRadius:o,borderRadius:o}},boxShadow:function(o){return{msBoxShadow:o,MozBoxShadow:o,OBoxShadow:o,WebkitBoxShadow:o,boxShadow:o}},userSelect:function(o){return{WebkitTouchCallout:o,KhtmlUserSelect:o,MozUserSelect:o,msUserSelect:o,WebkitUserSelect:o,userSelect:o}},flex:function(o){return{WebkitBoxFlex:o,MozBoxFlex:o,WebkitFlex:o,msFlex:o,flex:o}},flexBasis:function(o){return{WebkitFlexBasis:o,flexBasis:o}},justifyContent:function(o){return{WebkitJustifyContent:o,justifyContent:o}},transition:function(o){return{msTransition:o,MozTransition:o,OTransition:o,WebkitTransition:o,transition:o}},transform:function(o){return{msTransform:o,MozTransform:o,OTransform:o,WebkitTransform:o,transform:o}},absolute:function(o){var u=o&&o.split(" ");return{position:"absolute",top:u&&u[0],right:u&&u[1],bottom:u&&u[2],left:u&&u[3]}},extend:function(o,u){var h=u[o];return h||{extend:o}}},a=By.autoprefix=function(o){var u={};return(0,e.default)(o,function(h,f){var g={};(0,e.default)(h,function(b,v){var S=i[v];S?g=r({},g,S(b)):g[v]=b}),u[f]=g}),u};return By.default=a,By}var zy={},hU;function xSe(){if(hU)return zy;hU=1,Object.defineProperty(zy,"__esModule",{value:!0}),zy.hover=void 0;var t=Object.assign||function(u){for(var h=1;h<arguments.length;h++){var f=arguments[h];for(var g in f)Object.prototype.hasOwnProperty.call(f,g)&&(u[g]=f[g])}return u},e=Lb(),r=n(e);function n(u){return u&&u.__esModule?u:{default:u}}function i(u,h){if(!(u instanceof h))throw new TypeError("Cannot call a class as a function")}function a(u,h){if(!u)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return h&&(typeof h=="object"||typeof h=="function")?h:u}function s(u,h){if(typeof h!="function"&&h!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof h);u.prototype=Object.create(h&&h.prototype,{constructor:{value:u,enumerable:!1,writable:!0,configurable:!0}}),h&&(Object.setPrototypeOf?Object.setPrototypeOf(u,h):u.__proto__=h)}var o=zy.hover=function(h){var f=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"span";return(function(g){s(b,g);function b(){var v,S,E,P;i(this,b);for(var k=arguments.length,L=Array(k),O=0;O<k;O++)L[O]=arguments[O];return P=(S=(E=a(this,(v=b.__proto__||Object.getPrototypeOf(b)).call.apply(v,[this].concat(L))),E),E.state={hover:!1},E.handleMouseOver=function(){return E.setState({hover:!0})},E.handleMouseOut=function(){return E.setState({hover:!1})},E.render=function(){return r.default.createElement(f,{onMouseOver:E.handleMouseOver,onMouseOut:E.handleMouseOut},r.default.createElement(h,t({},E.props,E.state)))},S),a(E,P)}return b})(r.default.Component)};return zy.default=o,zy}var jy={},fU;function wSe(){if(fU)return jy;fU=1,Object.defineProperty(jy,"__esModule",{value:!0}),jy.active=void 0;var t=Object.assign||function(u){for(var h=1;h<arguments.length;h++){var f=arguments[h];for(var g in f)Object.prototype.hasOwnProperty.call(f,g)&&(u[g]=f[g])}return u},e=Lb(),r=n(e);function n(u){return u&&u.__esModule?u:{default:u}}function i(u,h){if(!(u instanceof h))throw new TypeError("Cannot call a class as a function")}function a(u,h){if(!u)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return h&&(typeof h=="object"||typeof h=="function")?h:u}function s(u,h){if(typeof h!="function"&&h!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof h);u.prototype=Object.create(h&&h.prototype,{constructor:{value:u,enumerable:!1,writable:!0,configurable:!0}}),h&&(Object.setPrototypeOf?Object.setPrototypeOf(u,h):u.__proto__=h)}var o=jy.active=function(h){var f=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"span";return(function(g){s(b,g);function b(){var v,S,E,P;i(this,b);for(var k=arguments.length,L=Array(k),O=0;O<k;O++)L[O]=arguments[O];return P=(S=(E=a(this,(v=b.__proto__||Object.getPrototypeOf(b)).call.apply(v,[this].concat(L))),E),E.state={active:!1},E.handleMouseDown=function(){return E.setState({active:!0})},E.handleMouseUp=function(){return E.setState({active:!1})},E.render=function(){return r.default.createElement(f,{onMouseDown:E.handleMouseDown,onMouseUp:E.handleMouseUp},r.default.createElement(h,t({},E.props,E.state)))},S),a(E,P)}return b})(r.default.Component)};return jy.default=o,jy}var M2={},dU;function SSe(){if(dU)return M2;dU=1,Object.defineProperty(M2,"__esModule",{value:!0});var t=function(r,n){var i={},a=function(o){var u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;i[o]=u};return r===0&&a("first-child"),r===n-1&&a("last-child"),(r===0||r%2===0)&&a("even"),Math.abs(r%2)===1&&a("odd"),a("nth-child",r),i};return M2.default=t,M2}var pU;function ESe(){if(pU)return dc;pU=1,Object.defineProperty(dc,"__esModule",{value:!0}),dc.ReactCSS=dc.loop=dc.handleActive=dc.handleHover=dc.hover=void 0;var t=Gwe(),e=b(t),r=_Se(),n=b(r),i=bSe(),a=b(i),s=xSe(),o=b(s),u=wSe(),h=b(u),f=SSe(),g=b(f);function b(S){return S&&S.__esModule?S:{default:S}}dc.hover=o.default,dc.handleHover=o.default,dc.handleActive=h.default,dc.loop=g.default;var v=dc.ReactCSS=function(E){for(var P=arguments.length,k=Array(P>1?P-1:0),L=1;L<P;L++)k[L-1]=arguments[L];var O=(0,e.default)(k),M=(0,n.default)(E,O);return(0,a.default)(M)};return dc.default=v,dc}var vL=ESe();const Di=od(vL);var TSe=function(e,r,n,i,a){var s=a.clientWidth,o=a.clientHeight,u=typeof e.pageX=="number"?e.pageX:e.touches[0].pageX,h=typeof e.pageY=="number"?e.pageY:e.touches[0].pageY,f=u-(a.getBoundingClientRect().left+window.pageXOffset),g=h-(a.getBoundingClientRect().top+window.pageYOffset);if(n==="vertical"){var b=void 0;if(g<0?b=0:g>o?b=1:b=Math.round(g*100/o)/100,r.a!==b)return{h:r.h,s:r.s,l:r.l,a:b,source:"rgb"}}else{var v=void 0;if(f<0?v=0:f>s?v=1:v=Math.round(f*100/s)/100,i!==v)return{h:r.h,s:r.s,l:r.l,a:v,source:"rgb"}}return null},X4={},CSe=function(e,r,n,i){if(typeof document>"u"&&!i)return null;var a=i?new i:document.createElement("canvas");a.width=n*2,a.height=n*2;var s=a.getContext("2d");return s?(s.fillStyle=e,s.fillRect(0,0,a.width,a.height),s.fillStyle=r,s.fillRect(0,0,n,n),s.translate(n,n),s.fillRect(0,0,n,n),a.toDataURL()):null},ASe=function(e,r,n,i){var a=e+"-"+r+"-"+n+(i?"-server":"");if(X4[a])return X4[a];var s=CSe(e,r,n,i);return X4[a]=s,s},gU=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},j0=function(e){var r=e.white,n=e.grey,i=e.size,a=e.renderers,s=e.borderRadius,o=e.boxShadow,u=e.children,h=Di({default:{grid:{borderRadius:s,boxShadow:o,absolute:"0px 0px 0px 0px",background:"url("+ASe(r,n,i,a.canvas)+") center left"}}});return ee.isValidElement(u)?ht.cloneElement(u,gU({},u.props,{style:gU({},u.props.style,h.grid)})):ht.createElement("div",{style:h.grid})};j0.defaultProps={size:8,white:"transparent",grey:"rgba(0,0,0,.08)",renderers:{}};var ISe=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},PSe=(function(){function t(e,r){for(var n=0;n<r.length;n++){var i=r[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}})();function kSe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function mU(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e&&(typeof e=="object"||typeof e=="function")?e:t}function MSe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var _L=(function(t){MSe(e,t);function e(){var r,n,i,a;kSe(this,e);for(var s=arguments.length,o=Array(s),u=0;u<s;u++)o[u]=arguments[u];return a=(n=(i=mU(this,(r=e.__proto__||Object.getPrototypeOf(e)).call.apply(r,[this].concat(o))),i),i.handleChange=function(h){var f=TSe(h,i.props.hsl,i.props.direction,i.props.a,i.container);f&&typeof i.props.onChange=="function"&&i.props.onChange(f,h)},i.handleMouseDown=function(h){i.handleChange(h),window.addEventListener("mousemove",i.handleChange),window.addEventListener("mouseup",i.handleMouseUp)},i.handleMouseUp=function(){i.unbindEventListeners()},i.unbindEventListeners=function(){window.removeEventListener("mousemove",i.handleChange),window.removeEventListener("mouseup",i.handleMouseUp)},n),mU(i,a)}return PSe(e,[{key:"componentWillUnmount",value:function(){this.unbindEventListeners()}},{key:"render",value:function(){var n=this,i=this.props.rgb,a=Di({default:{alpha:{absolute:"0px 0px 0px 0px",borderRadius:this.props.radius},checkboard:{absolute:"0px 0px 0px 0px",overflow:"hidden",borderRadius:this.props.radius},gradient:{absolute:"0px 0px 0px 0px",background:"linear-gradient(to right, rgba("+i.r+","+i.g+","+i.b+`, 0) 0%,
           rgba(`+i.r+","+i.g+","+i.b+", 1) 100%)",boxShadow:this.props.shadow,borderRadius:this.props.radius},container:{position:"relative",height:"100%",margin:"0 3px"},pointer:{position:"absolute",left:i.a*100+"%"},slider:{width:"4px",borderRadius:"1px",height:"8px",boxShadow:"0 0 2px rgba(0, 0, 0, .6)",background:"#fff",marginTop:"1px",transform:"translateX(-2px)"}},vertical:{gradient:{background:"linear-gradient(to bottom, rgba("+i.r+","+i.g+","+i.b+`, 0) 0%,
           rgba(`+i.r+","+i.g+","+i.b+", 1) 100%)"},pointer:{left:0,top:i.a*100+"%"}},overwrite:ISe({},this.props.style)},{vertical:this.props.direction==="vertical",overwrite:!0});return ht.createElement("div",{style:a.alpha},ht.createElement("div",{style:a.checkboard},ht.createElement(j0,{renderers:this.props.renderers})),ht.createElement("div",{style:a.gradient}),ht.createElement("div",{style:a.container,ref:function(o){return n.container=o},onMouseDown:this.handleMouseDown,onTouchMove:this.handleChange,onTouchStart:this.handleChange},ht.createElement("div",{style:a.pointer},this.props.pointer?ht.createElement(this.props.pointer,this.props):ht.createElement("div",{style:a.slider}))))}}]),e})(ee.PureComponent||ee.Component),RSe=(function(){function t(e,r){for(var n=0;n<r.length;n++){var i=r[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}})();function OSe(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function LSe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function NSe(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e&&(typeof e=="object"||typeof e=="function")?e:t}function DSe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var FSe=1,hK=38,BSe=40,zSe=[hK,BSe],jSe=function(e){return zSe.indexOf(e)>-1},USe=function(e){return Number(String(e).replace(/%/g,""))},VSe=1,ga=(function(t){DSe(e,t);function e(r){LSe(this,e);var n=NSe(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return n.handleBlur=function(){n.state.blurValue&&n.setState({value:n.state.blurValue,blurValue:null})},n.handleChange=function(i){n.setUpdatedValue(i.target.value,i)},n.handleKeyDown=function(i){var a=USe(i.target.value);if(!isNaN(a)&&jSe(i.keyCode)){var s=n.getArrowOffset(),o=i.keyCode===hK?a+s:a-s;n.setUpdatedValue(o,i)}},n.handleDrag=function(i){if(n.props.dragLabel){var a=Math.round(n.props.value+i.movementX);a>=0&&a<=n.props.dragMax&&n.props.onChange&&n.props.onChange(n.getValueObjectWithLabel(a),i)}},n.handleMouseDown=function(i){n.props.dragLabel&&(i.preventDefault(),n.handleDrag(i),window.addEventListener("mousemove",n.handleDrag),window.addEventListener("mouseup",n.handleMouseUp))},n.handleMouseUp=function(){n.unbindEventListeners()},n.unbindEventListeners=function(){window.removeEventListener("mousemove",n.handleDrag),window.removeEventListener("mouseup",n.handleMouseUp)},n.state={value:String(r.value).toUpperCase(),blurValue:String(r.value).toUpperCase()},n.inputId="rc-editable-input-"+VSe++,n}return RSe(e,[{key:"componentDidUpdate",value:function(n,i){this.props.value!==this.state.value&&(n.value!==this.props.value||i.value!==this.state.value)&&(this.input===document.activeElement?this.setState({blurValue:String(this.props.value).toUpperCase()}):this.setState({value:String(this.props.value).toUpperCase(),blurValue:!this.state.blurValue&&String(this.props.value).toUpperCase()}))}},{key:"componentWillUnmount",value:function(){this.unbindEventListeners()}},{key:"getValueObjectWithLabel",value:function(n){return OSe({},this.props.label,n)}},{key:"getArrowOffset",value:function(){return this.props.arrowOffset||FSe}},{key:"setUpdatedValue",value:function(n,i){var a=this.props.label?this.getValueObjectWithLabel(n):n;this.props.onChange&&this.props.onChange(a,i),this.setState({value:n})}},{key:"render",value:function(){var n=this,i=Di({default:{wrap:{position:"relative"}},"user-override":{wrap:this.props.style&&this.props.style.wrap?this.props.style.wrap:{},input:this.props.style&&this.props.style.input?this.props.style.input:{},label:this.props.style&&this.props.style.label?this.props.style.label:{}},"dragLabel-true":{label:{cursor:"ew-resize"}}},{"user-override":!0},this.props);return ht.createElement("div",{style:i.wrap},ht.createElement("input",{id:this.inputId,style:i.input,ref:function(s){return n.input=s},value:this.state.value,onKeyDown:this.handleKeyDown,onChange:this.handleChange,onBlur:this.handleBlur,placeholder:this.props.placeholder,spellCheck:"false"}),this.props.label&&!this.props.hideLabel?ht.createElement("label",{htmlFor:this.inputId,style:i.label,onMouseDown:this.handleMouseDown},this.props.label):null)}}]),e})(ee.PureComponent||ee.Component),$Se=function(e,r,n,i){var a=i.clientWidth,s=i.clientHeight,o=typeof e.pageX=="number"?e.pageX:e.touches[0].pageX,u=typeof e.pageY=="number"?e.pageY:e.touches[0].pageY,h=o-(i.getBoundingClientRect().left+window.pageXOffset),f=u-(i.getBoundingClientRect().top+window.pageYOffset);if(r==="vertical"){var g=void 0;if(f<0)g=359;else if(f>s)g=0;else{var b=-(f*100/s)+100;g=360*b/100}if(n.h!==g)return{h:g,s:n.s,l:n.l,a:n.a,source:"hsl"}}else{var v=void 0;if(h<0)v=0;else if(h>a)v=359;else{var S=h*100/a;v=360*S/100}if(n.h!==v)return{h:v,s:n.s,l:n.l,a:n.a,source:"hsl"}}return null},qSe=(function(){function t(e,r){for(var n=0;n<r.length;n++){var i=r[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}})();function HSe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function yU(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e&&(typeof e=="object"||typeof e=="function")?e:t}function WSe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var U0=(function(t){WSe(e,t);function e(){var r,n,i,a;HSe(this,e);for(var s=arguments.length,o=Array(s),u=0;u<s;u++)o[u]=arguments[u];return a=(n=(i=yU(this,(r=e.__proto__||Object.getPrototypeOf(e)).call.apply(r,[this].concat(o))),i),i.handleChange=function(h){var f=$Se(h,i.props.direction,i.props.hsl,i.container);f&&typeof i.props.onChange=="function"&&i.props.onChange(f,h)},i.handleMouseDown=function(h){i.handleChange(h),window.addEventListener("mousemove",i.handleChange),window.addEventListener("mouseup",i.handleMouseUp)},i.handleMouseUp=function(){i.unbindEventListeners()},n),yU(i,a)}return qSe(e,[{key:"componentWillUnmount",value:function(){this.unbindEventListeners()}},{key:"unbindEventListeners",value:function(){window.removeEventListener("mousemove",this.handleChange),window.removeEventListener("mouseup",this.handleMouseUp)}},{key:"render",value:function(){var n=this,i=this.props.direction,a=i===void 0?"horizontal":i,s=Di({default:{hue:{absolute:"0px 0px 0px 0px",borderRadius:this.props.radius,boxShadow:this.props.shadow},container:{padding:"0 2px",position:"relative",height:"100%",borderRadius:this.props.radius},pointer:{position:"absolute",left:this.props.hsl.h*100/360+"%"},slider:{marginTop:"1px",width:"4px",borderRadius:"1px",height:"8px",boxShadow:"0 0 2px rgba(0, 0, 0, .6)",background:"#fff",transform:"translateX(-2px)"}},vertical:{pointer:{left:"0px",top:-(this.props.hsl.h*100/360)+100+"%"}}},{vertical:a==="vertical"});return ht.createElement("div",{style:s.hue},ht.createElement("div",{className:"hue-"+a,style:s.container,ref:function(u){return n.container=u},onMouseDown:this.handleMouseDown,onTouchMove:this.handleChange,onTouchStart:this.handleChange},ht.createElement("style",null,`
            .hue-horizontal {
              background: linear-gradient(to right, #f00 0%, #ff0 17%, #0f0
                33%, #0ff 50%, #00f 67%, #f0f 83%, #f00 100%);
              background: -webkit-linear-gradient(to right, #f00 0%, #ff0
                17%, #0f0 33%, #0ff 50%, #00f 67%, #f0f 83%, #f00 100%);
            }

            .hue-vertical {
              background: linear-gradient(to top, #f00 0%, #ff0 17%, #0f0 33%,
                #0ff 50%, #00f 67%, #f0f 83%, #f00 100%);
              background: -webkit-linear-gradient(to top, #f00 0%, #ff0 17%,
                #0f0 33%, #0ff 50%, #00f 67%, #f0f 83%, #f00 100%);
            }
          `),ht.createElement("div",{style:s.pointer},this.props.pointer?ht.createElement(this.props.pointer,this.props):ht.createElement("div",{style:s.slider}))))}}]),e})(ee.PureComponent||ee.Component);function GSe(){this.__data__=[],this.size=0}function ox(t,e){return t===e||t!==t&&e!==e}function AT(t,e){for(var r=t.length;r--;)if(ox(t[r][0],e))return r;return-1}var XSe=Array.prototype,YSe=XSe.splice;function ZSe(t){var e=this.__data__,r=AT(e,t);if(r<0)return!1;var n=e.length-1;return r==n?e.pop():YSe.call(e,r,1),--this.size,!0}function KSe(t){var e=this.__data__,r=AT(e,t);return r<0?void 0:e[r][1]}function JSe(t){return AT(this.__data__,t)>-1}function QSe(t,e){var r=this.__data__,n=AT(r,t);return n<0?(++this.size,r.push([t,e])):r[n][1]=e,this}function rp(t){var e=-1,r=t==null?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}rp.prototype.clear=GSe;rp.prototype.delete=ZSe;rp.prototype.get=KSe;rp.prototype.has=JSe;rp.prototype.set=QSe;function eEe(){this.__data__=new rp,this.size=0}function tEe(t){var e=this.__data__,r=e.delete(t);return this.size=e.size,r}function rEe(t){return this.__data__.get(t)}function nEe(t){return this.__data__.has(t)}var fK=typeof global=="object"&&global&&global.Object===Object&&global,iEe=typeof self=="object"&&self&&self.Object===Object&&self,mf=fK||iEe||Function("return this")(),rg=mf.Symbol,dK=Object.prototype,aEe=dK.hasOwnProperty,oEe=dK.toString,T_=rg?rg.toStringTag:void 0;function sEe(t){var e=aEe.call(t,T_),r=t[T_];try{t[T_]=void 0;var n=!0}catch{}var i=oEe.call(t);return n&&(e?t[T_]=r:delete t[T_]),i}var lEe=Object.prototype,uEe=lEe.toString;function cEe(t){return uEe.call(t)}var hEe="[object Null]",fEe="[object Undefined]",vU=rg?rg.toStringTag:void 0;function Hm(t){return t==null?t===void 0?fEe:hEe:vU&&vU in Object(t)?sEe(t):cEe(t)}function Oh(t){var e=typeof t;return t!=null&&(e=="object"||e=="function")}var dEe="[object AsyncFunction]",pEe="[object Function]",gEe="[object GeneratorFunction]",mEe="[object Proxy]";function bL(t){if(!Oh(t))return!1;var e=Hm(t);return e==pEe||e==gEe||e==dEe||e==mEe}var Y4=mf["__core-js_shared__"],_U=(function(){var t=/[^.]+$/.exec(Y4&&Y4.keys&&Y4.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""})();function yEe(t){return!!_U&&_U in t}var vEe=Function.prototype,_Ee=vEe.toString;function Wm(t){if(t!=null){try{return _Ee.call(t)}catch{}try{return t+""}catch{}}return""}var bEe=/[\\^$.*+?()[\]{}|]/g,xEe=/^\[object .+?Constructor\]$/,wEe=Function.prototype,SEe=Object.prototype,EEe=wEe.toString,TEe=SEe.hasOwnProperty,CEe=RegExp("^"+EEe.call(TEe).replace(bEe,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function AEe(t){if(!Oh(t)||yEe(t))return!1;var e=bL(t)?CEe:xEe;return e.test(Wm(t))}function IEe(t,e){return t?.[e]}function Gm(t,e){var r=IEe(t,e);return AEe(r)?r:void 0}var fb=Gm(mf,"Map"),db=Gm(Object,"create");function PEe(){this.__data__=db?db(null):{},this.size=0}function kEe(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e}var MEe="__lodash_hash_undefined__",REe=Object.prototype,OEe=REe.hasOwnProperty;function LEe(t){var e=this.__data__;if(db){var r=e[t];return r===MEe?void 0:r}return OEe.call(e,t)?e[t]:void 0}var NEe=Object.prototype,DEe=NEe.hasOwnProperty;function FEe(t){var e=this.__data__;return db?e[t]!==void 0:DEe.call(e,t)}var BEe="__lodash_hash_undefined__";function zEe(t,e){var r=this.__data__;return this.size+=this.has(t)?0:1,r[t]=db&&e===void 0?BEe:e,this}function Em(t){var e=-1,r=t==null?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}Em.prototype.clear=PEe;Em.prototype.delete=kEe;Em.prototype.get=LEe;Em.prototype.has=FEe;Em.prototype.set=zEe;function jEe(){this.size=0,this.__data__={hash:new Em,map:new(fb||rp),string:new Em}}function UEe(t){var e=typeof t;return e=="string"||e=="number"||e=="symbol"||e=="boolean"?t!=="__proto__":t===null}function IT(t,e){var r=t.__data__;return UEe(e)?r[typeof e=="string"?"string":"hash"]:r.map}function VEe(t){var e=IT(this,t).delete(t);return this.size-=e?1:0,e}function $Ee(t){return IT(this,t).get(t)}function qEe(t){return IT(this,t).has(t)}function HEe(t,e){var r=IT(this,t),n=r.size;return r.set(t,e),this.size+=r.size==n?0:1,this}function np(t){var e=-1,r=t==null?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}np.prototype.clear=jEe;np.prototype.delete=VEe;np.prototype.get=$Ee;np.prototype.has=qEe;np.prototype.set=HEe;var WEe=200;function GEe(t,e){var r=this.__data__;if(r instanceof rp){var n=r.__data__;if(!fb||n.length<WEe-1)return n.push([t,e]),this.size=++r.size,this;r=this.__data__=new np(n)}return r.set(t,e),this.size=r.size,this}function Qf(t){var e=this.__data__=new rp(t);this.size=e.size}Qf.prototype.clear=eEe;Qf.prototype.delete=tEe;Qf.prototype.get=rEe;Qf.prototype.has=nEe;Qf.prototype.set=GEe;var wS=(function(){try{var t=Gm(Object,"defineProperty");return t({},"",{}),t}catch{}})();function xL(t,e,r){e=="__proto__"&&wS?wS(t,e,{configurable:!0,enumerable:!0,value:r,writable:!0}):t[e]=r}function Lk(t,e,r){(r!==void 0&&!ox(t[e],r)||r===void 0&&!(e in t))&&xL(t,e,r)}function XEe(t){return function(e,r,n){for(var i=-1,a=Object(e),s=n(e),o=s.length;o--;){var u=s[++i];if(r(a[u],u,a)===!1)break}return e}}var pK=XEe(),gK=typeof exports=="object"&&exports&&!exports.nodeType&&exports,bU=gK&&typeof module=="object"&&module&&!module.nodeType&&module,YEe=bU&&bU.exports===gK,xU=YEe?mf.Buffer:void 0;xU&&xU.allocUnsafe;function ZEe(t,e){return t.slice()}var SS=mf.Uint8Array;function KEe(t){var e=new t.constructor(t.byteLength);return new SS(e).set(new SS(t)),e}function JEe(t,e){var r=KEe(t.buffer);return new t.constructor(r,t.byteOffset,t.length)}function QEe(t,e){var r=-1,n=t.length;for(e||(e=Array(n));++r<n;)e[r]=t[r];return e}var wU=Object.create,eTe=(function(){function t(){}return function(e){if(!Oh(e))return{};if(wU)return wU(e);t.prototype=e;var r=new t;return t.prototype=void 0,r}})();function mK(t,e){return function(r){return t(e(r))}}var yK=mK(Object.getPrototypeOf,Object),tTe=Object.prototype;function wL(t){var e=t&&t.constructor,r=typeof e=="function"&&e.prototype||tTe;return t===r}function rTe(t){return typeof t.constructor=="function"&&!wL(t)?eTe(yK(t)):{}}function ng(t){return t!=null&&typeof t=="object"}var nTe="[object Arguments]";function SU(t){return ng(t)&&Hm(t)==nTe}var vK=Object.prototype,iTe=vK.hasOwnProperty,aTe=vK.propertyIsEnumerable,ES=SU((function(){return arguments})())?SU:function(t){return ng(t)&&iTe.call(t,"callee")&&!aTe.call(t,"callee")},ah=Array.isArray,oTe=9007199254740991;function SL(t){return typeof t=="number"&&t>-1&&t%1==0&&t<=oTe}function V0(t){return t!=null&&SL(t.length)&&!bL(t)}function sTe(t){return ng(t)&&V0(t)}function lTe(){return!1}var _K=typeof exports=="object"&&exports&&!exports.nodeType&&exports,EU=_K&&typeof module=="object"&&module&&!module.nodeType&&module,uTe=EU&&EU.exports===_K,TU=uTe?mf.Buffer:void 0,cTe=TU?TU.isBuffer:void 0,TS=cTe||lTe,hTe="[object Object]",fTe=Function.prototype,dTe=Object.prototype,bK=fTe.toString,pTe=dTe.hasOwnProperty,gTe=bK.call(Object);function mTe(t){if(!ng(t)||Hm(t)!=hTe)return!1;var e=yK(t);if(e===null)return!0;var r=pTe.call(e,"constructor")&&e.constructor;return typeof r=="function"&&r instanceof r&&bK.call(r)==gTe}var yTe="[object Arguments]",vTe="[object Array]",_Te="[object Boolean]",bTe="[object Date]",xTe="[object Error]",wTe="[object Function]",STe="[object Map]",ETe="[object Number]",TTe="[object Object]",CTe="[object RegExp]",ATe="[object Set]",ITe="[object String]",PTe="[object WeakMap]",kTe="[object ArrayBuffer]",MTe="[object DataView]",RTe="[object Float32Array]",OTe="[object Float64Array]",LTe="[object Int8Array]",NTe="[object Int16Array]",DTe="[object Int32Array]",FTe="[object Uint8Array]",BTe="[object Uint8ClampedArray]",zTe="[object Uint16Array]",jTe="[object Uint32Array]",Uo={};Uo[RTe]=Uo[OTe]=Uo[LTe]=Uo[NTe]=Uo[DTe]=Uo[FTe]=Uo[BTe]=Uo[zTe]=Uo[jTe]=!0;Uo[yTe]=Uo[vTe]=Uo[kTe]=Uo[_Te]=Uo[MTe]=Uo[bTe]=Uo[xTe]=Uo[wTe]=Uo[STe]=Uo[ETe]=Uo[TTe]=Uo[CTe]=Uo[ATe]=Uo[ITe]=Uo[PTe]=!1;function UTe(t){return ng(t)&&SL(t.length)&&!!Uo[Hm(t)]}function VTe(t){return function(e){return t(e)}}var xK=typeof exports=="object"&&exports&&!exports.nodeType&&exports,R1=xK&&typeof module=="object"&&module&&!module.nodeType&&module,$Te=R1&&R1.exports===xK,Z4=$Te&&fK.process,CU=(function(){try{var t=R1&&R1.require&&R1.require("util").types;return t||Z4&&Z4.binding&&Z4.binding("util")}catch{}})(),AU=CU&&CU.isTypedArray,EL=AU?VTe(AU):UTe;function Nk(t,e){if(!(e==="constructor"&&typeof t[e]=="function")&&e!="__proto__")return t[e]}var qTe=Object.prototype,HTe=qTe.hasOwnProperty;function WTe(t,e,r){var n=t[e];(!(HTe.call(t,e)&&ox(n,r))||r===void 0&&!(e in t))&&xL(t,e,r)}function GTe(t,e,r,n){var i=!r;r||(r={});for(var a=-1,s=e.length;++a<s;){var o=e[a],u=void 0;u===void 0&&(u=t[o]),i?xL(r,o,u):WTe(r,o,u)}return r}function XTe(t,e){for(var r=-1,n=Array(t);++r<t;)n[r]=e(r);return n}var YTe=9007199254740991,ZTe=/^(?:0|[1-9]\d*)$/;function TL(t,e){var r=typeof t;return e=e??YTe,!!e&&(r=="number"||r!="symbol"&&ZTe.test(t))&&t>-1&&t%1==0&&t<e}var KTe=Object.prototype,JTe=KTe.hasOwnProperty;function wK(t,e){var r=ah(t),n=!r&&ES(t),i=!r&&!n&&TS(t),a=!r&&!n&&!i&&EL(t),s=r||n||i||a,o=s?XTe(t.length,String):[],u=o.length;for(var h in t)(e||JTe.call(t,h))&&!(s&&(h=="length"||i&&(h=="offset"||h=="parent")||a&&(h=="buffer"||h=="byteLength"||h=="byteOffset")||TL(h,u)))&&o.push(h);return o}function QTe(t){var e=[];if(t!=null)for(var r in Object(t))e.push(r);return e}var eCe=Object.prototype,tCe=eCe.hasOwnProperty;function rCe(t){if(!Oh(t))return QTe(t);var e=wL(t),r=[];for(var n in t)n=="constructor"&&(e||!tCe.call(t,n))||r.push(n);return r}function SK(t){return V0(t)?wK(t,!0):rCe(t)}function nCe(t){return GTe(t,SK(t))}function iCe(t,e,r,n,i,a,s){var o=Nk(t,r),u=Nk(e,r),h=s.get(u);if(h){Lk(t,r,h);return}var f=a?a(o,u,r+"",t,e,s):void 0,g=f===void 0;if(g){var b=ah(u),v=!b&&TS(u),S=!b&&!v&&EL(u);f=u,b||v||S?ah(o)?f=o:sTe(o)?f=QEe(o):v?(g=!1,f=ZEe(u)):S?(g=!1,f=JEe(u)):f=[]:mTe(u)||ES(u)?(f=o,ES(o)?f=nCe(o):(!Oh(o)||bL(o))&&(f=rTe(u))):g=!1}g&&(s.set(u,f),i(f,u,n,a,s),s.delete(u)),Lk(t,r,f)}function EK(t,e,r,n,i){t!==e&&pK(e,function(a,s){if(i||(i=new Qf),Oh(a))iCe(t,e,s,r,EK,n,i);else{var o=n?n(Nk(t,s),a,s+"",t,e,i):void 0;o===void 0&&(o=a),Lk(t,s,o)}},SK)}function PT(t){return t}function aCe(t,e,r){switch(r.length){case 0:return t.call(e);case 1:return t.call(e,r[0]);case 2:return t.call(e,r[0],r[1]);case 3:return t.call(e,r[0],r[1],r[2])}return t.apply(e,r)}var IU=Math.max;function oCe(t,e,r){return e=IU(e===void 0?t.length-1:e,0),function(){for(var n=arguments,i=-1,a=IU(n.length-e,0),s=Array(a);++i<a;)s[i]=n[e+i];i=-1;for(var o=Array(e+1);++i<e;)o[i]=n[i];return o[e]=r(s),aCe(t,this,o)}}function sCe(t){return function(){return t}}var lCe=wS?function(t,e){return wS(t,"toString",{configurable:!0,enumerable:!1,value:sCe(e),writable:!0})}:PT,uCe=800,cCe=16,hCe=Date.now;function fCe(t){var e=0,r=0;return function(){var n=hCe(),i=cCe-(n-r);if(r=n,i>0){if(++e>=uCe)return arguments[0]}else e=0;return t.apply(void 0,arguments)}}var dCe=fCe(lCe);function pCe(t,e){return dCe(oCe(t,e,PT),t+"")}function gCe(t,e,r){if(!Oh(r))return!1;var n=typeof e;return(n=="number"?V0(r)&&TL(e,r.length):n=="string"&&e in r)?ox(r[e],t):!1}function mCe(t){return pCe(function(e,r){var n=-1,i=r.length,a=i>1?r[i-1]:void 0,s=i>2?r[2]:void 0;for(a=t.length>3&&typeof a=="function"?(i--,a):void 0,s&&gCe(r[0],r[1],s)&&(a=i<3?void 0:a,i=1),e=Object(e);++n<i;){var o=r[n];o&&t(e,o,n,a)}return e})}var Ac=mCe(function(t,e,r){EK(t,e,r)}),sx=function(e){var r=e.zDepth,n=e.radius,i=e.background,a=e.children,s=e.styles,o=s===void 0?{}:s,u=Di(Ac({default:{wrap:{position:"relative",display:"inline-block"},content:{position:"relative"},bg:{absolute:"0px 0px 0px 0px",boxShadow:"0 "+r+"px "+r*4+"px rgba(0,0,0,.24)",borderRadius:n,background:i}},"zDepth-0":{bg:{boxShadow:"none"}},"zDepth-1":{bg:{boxShadow:"0 2px 10px rgba(0,0,0,.12), 0 2px 5px rgba(0,0,0,.16)"}},"zDepth-2":{bg:{boxShadow:"0 6px 20px rgba(0,0,0,.19), 0 8px 17px rgba(0,0,0,.2)"}},"zDepth-3":{bg:{boxShadow:"0 17px 50px rgba(0,0,0,.19), 0 12px 15px rgba(0,0,0,.24)"}},"zDepth-4":{bg:{boxShadow:"0 25px 55px rgba(0,0,0,.21), 0 16px 28px rgba(0,0,0,.22)"}},"zDepth-5":{bg:{boxShadow:"0 40px 77px rgba(0,0,0,.22), 0 27px 24px rgba(0,0,0,.2)"}},square:{bg:{borderRadius:"0"}},circle:{bg:{borderRadius:"50%"}}},o),{"zDepth-1":r===1});return ht.createElement("div",{style:u.wrap},ht.createElement("div",{style:u.bg}),ht.createElement("div",{style:u.content},a))};sx.propTypes={background:Pn.string,zDepth:Pn.oneOf([0,1,2,3,4,5]),radius:Pn.number,styles:Pn.object};sx.defaultProps={background:"#fff",zDepth:1,radius:2,styles:{}};var K4=function(){return mf.Date.now()},yCe=/\s/;function vCe(t){for(var e=t.length;e--&&yCe.test(t.charAt(e)););return e}var _Ce=/^\s+/;function bCe(t){return t&&t.slice(0,vCe(t)+1).replace(_Ce,"")}var xCe="[object Symbol]";function kT(t){return typeof t=="symbol"||ng(t)&&Hm(t)==xCe}var PU=NaN,wCe=/^[-+]0x[0-9a-f]+$/i,SCe=/^0b[01]+$/i,ECe=/^0o[0-7]+$/i,TCe=parseInt;function kU(t){if(typeof t=="number")return t;if(kT(t))return PU;if(Oh(t)){var e=typeof t.valueOf=="function"?t.valueOf():t;t=Oh(e)?e+"":e}if(typeof t!="string")return t===0?t:+t;t=bCe(t);var r=SCe.test(t);return r||ECe.test(t)?TCe(t.slice(2),r?2:8):wCe.test(t)?PU:+t}var CCe="Expected a function",ACe=Math.max,ICe=Math.min;function TK(t,e,r){var n,i,a,s,o,u,h=0,f=!1,g=!1,b=!0;if(typeof t!="function")throw new TypeError(CCe);e=kU(e)||0,Oh(r)&&(f=!!r.leading,g="maxWait"in r,a=g?ACe(kU(r.maxWait)||0,e):a,b="trailing"in r?!!r.trailing:b);function v(B){var q=n,W=i;return n=i=void 0,h=B,s=t.apply(W,q),s}function S(B){return h=B,o=setTimeout(k,e),f?v(B):s}function E(B){var q=B-u,W=B-h,G=e-q;return g?ICe(G,a-W):G}function P(B){var q=B-u,W=B-h;return u===void 0||q>=e||q<0||g&&W>=a}function k(){var B=K4();if(P(B))return L(B);o=setTimeout(k,E(B))}function L(B){return o=void 0,b&&n?v(B):(n=i=void 0,s)}function O(){o!==void 0&&clearTimeout(o),h=0,n=u=i=o=void 0}function M(){return o===void 0?s:L(K4())}function z(){var B=K4(),q=P(B);if(n=arguments,i=this,u=B,q){if(o===void 0)return S(u);if(g)return clearTimeout(o),o=setTimeout(k,e),v(u)}return o===void 0&&(o=setTimeout(k,e)),s}return z.cancel=O,z.flush=M,z}var PCe="Expected a function";function kCe(t,e,r){var n=!0,i=!0;if(typeof t!="function")throw new TypeError(PCe);return Oh(r)&&(n="leading"in r?!!r.leading:n,i="trailing"in r?!!r.trailing:i),TK(t,e,{leading:n,maxWait:e,trailing:i})}var MCe=function(e,r,n){var i=n.getBoundingClientRect(),a=i.width,s=i.height,o=typeof e.pageX=="number"?e.pageX:e.touches[0].pageX,u=typeof e.pageY=="number"?e.pageY:e.touches[0].pageY,h=o-(n.getBoundingClientRect().left+window.pageXOffset),f=u-(n.getBoundingClientRect().top+window.pageYOffset);h<0?h=0:h>a&&(h=a),f<0?f=0:f>s&&(f=s);var g=h/a,b=1-f/s;return{h:r.h,s:g,v:b,a:r.a,source:"hsv"}},RCe=(function(){function t(e,r){for(var n=0;n<r.length;n++){var i=r[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}})();function OCe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function LCe(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e&&(typeof e=="object"||typeof e=="function")?e:t}function NCe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var MT=(function(t){NCe(e,t);function e(r){OCe(this,e);var n=LCe(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,r));return n.handleChange=function(i){typeof n.props.onChange=="function"&&n.throttle(n.props.onChange,MCe(i,n.props.hsl,n.container),i)},n.handleMouseDown=function(i){n.handleChange(i);var a=n.getContainerRenderWindow();a.addEventListener("mousemove",n.handleChange),a.addEventListener("mouseup",n.handleMouseUp)},n.handleMouseUp=function(){n.unbindEventListeners()},n.throttle=kCe(function(i,a,s){i(a,s)},50),n}return RCe(e,[{key:"componentWillUnmount",value:function(){this.throttle.cancel(),this.unbindEventListeners()}},{key:"getContainerRenderWindow",value:function(){for(var n=this.container,i=window;!i.document.contains(n)&&i.parent!==i;)i=i.parent;return i}},{key:"unbindEventListeners",value:function(){var n=this.getContainerRenderWindow();n.removeEventListener("mousemove",this.handleChange),n.removeEventListener("mouseup",this.handleMouseUp)}},{key:"render",value:function(){var n=this,i=this.props.style||{},a=i.color,s=i.white,o=i.black,u=i.pointer,h=i.circle,f=Di({default:{color:{absolute:"0px 0px 0px 0px",background:"hsl("+this.props.hsl.h+",100%, 50%)",borderRadius:this.props.radius},white:{absolute:"0px 0px 0px 0px",borderRadius:this.props.radius},black:{absolute:"0px 0px 0px 0px",boxShadow:this.props.shadow,borderRadius:this.props.radius},pointer:{position:"absolute",top:-(this.props.hsv.v*100)+100+"%",left:this.props.hsv.s*100+"%",cursor:"default"},circle:{width:"4px",height:"4px",boxShadow:`0 0 0 1.5px #fff, inset 0 0 1px 1px rgba(0,0,0,.3),
            0 0 1px 2px rgba(0,0,0,.4)`,borderRadius:"50%",cursor:"hand",transform:"translate(-2px, -2px)"}},custom:{color:a,white:s,black:o,pointer:u,circle:h}},{custom:!!this.props.style});return ht.createElement("div",{style:f.color,ref:function(b){return n.container=b},onMouseDown:this.handleMouseDown,onTouchMove:this.handleChange,onTouchStart:this.handleChange},ht.createElement("style",null,`
          .saturation-white {
            background: -webkit-linear-gradient(to right, #fff, rgba(255,255,255,0));
            background: linear-gradient(to right, #fff, rgba(255,255,255,0));
          }
          .saturation-black {
            background: -webkit-linear-gradient(to top, #000, rgba(0,0,0,0));
            background: linear-gradient(to top, #000, rgba(0,0,0,0));
          }
        `),ht.createElement("div",{style:f.white,className:"saturation-white"},ht.createElement("div",{style:f.black,className:"saturation-black"}),ht.createElement("div",{style:f.pointer},this.props.pointer?ht.createElement(this.props.pointer,this.props):ht.createElement("div",{style:f.circle}))))}}]),e})(ee.PureComponent||ee.Component);function DCe(t,e){for(var r=-1,n=t==null?0:t.length;++r<n&&e(t[r],r,t)!==!1;);return t}var FCe=mK(Object.keys,Object),BCe=Object.prototype,zCe=BCe.hasOwnProperty;function jCe(t){if(!wL(t))return FCe(t);var e=[];for(var r in Object(t))zCe.call(t,r)&&r!="constructor"&&e.push(r);return e}function CL(t){return V0(t)?wK(t):jCe(t)}function UCe(t,e){return t&&pK(t,e,CL)}function VCe(t,e){return function(r,n){if(r==null)return r;if(!V0(r))return t(r,n);for(var i=r.length,a=-1,s=Object(r);++a<i&&n(s[a],a,s)!==!1;);return r}}var CK=VCe(UCe);function $Ce(t){return typeof t=="function"?t:PT}function qCe(t,e){var r=ah(t)?DCe:CK;return r(t,$Ce(e))}function CS(t){"@babel/helpers - typeof";return CS=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},CS(t)}var HCe=/^\s+/,WCe=/\s+$/;function ai(t,e){if(t=t||"",e=e||{},t instanceof ai)return t;if(!(this instanceof ai))return new ai(t,e);var r=GCe(t);this._originalInput=t,this._r=r.r,this._g=r.g,this._b=r.b,this._a=r.a,this._roundA=Math.round(100*this._a)/100,this._format=e.format||r.format,this._gradientType=e.gradientType,this._r<1&&(this._r=Math.round(this._r)),this._g<1&&(this._g=Math.round(this._g)),this._b<1&&(this._b=Math.round(this._b)),this._ok=r.ok}ai.prototype={isDark:function(){return this.getBrightness()<128},isLight:function(){return!this.isDark()},isValid:function(){return this._ok},getOriginalInput:function(){return this._originalInput},getFormat:function(){return this._format},getAlpha:function(){return this._a},getBrightness:function(){var e=this.toRgb();return(e.r*299+e.g*587+e.b*114)/1e3},getLuminance:function(){var e=this.toRgb(),r,n,i,a,s,o;return r=e.r/255,n=e.g/255,i=e.b/255,r<=.03928?a=r/12.92:a=Math.pow((r+.055)/1.055,2.4),n<=.03928?s=n/12.92:s=Math.pow((n+.055)/1.055,2.4),i<=.03928?o=i/12.92:o=Math.pow((i+.055)/1.055,2.4),.2126*a+.7152*s+.0722*o},setAlpha:function(e){return this._a=AK(e),this._roundA=Math.round(100*this._a)/100,this},toHsv:function(){var e=RU(this._r,this._g,this._b);return{h:e.h*360,s:e.s,v:e.v,a:this._a}},toHsvString:function(){var e=RU(this._r,this._g,this._b),r=Math.round(e.h*360),n=Math.round(e.s*100),i=Math.round(e.v*100);return this._a==1?"hsv("+r+", "+n+"%, "+i+"%)":"hsva("+r+", "+n+"%, "+i+"%, "+this._roundA+")"},toHsl:function(){var e=MU(this._r,this._g,this._b);return{h:e.h*360,s:e.s,l:e.l,a:this._a}},toHslString:function(){var e=MU(this._r,this._g,this._b),r=Math.round(e.h*360),n=Math.round(e.s*100),i=Math.round(e.l*100);return this._a==1?"hsl("+r+", "+n+"%, "+i+"%)":"hsla("+r+", "+n+"%, "+i+"%, "+this._roundA+")"},toHex:function(e){return OU(this._r,this._g,this._b,e)},toHexString:function(e){return"#"+this.toHex(e)},toHex8:function(e){return KCe(this._r,this._g,this._b,this._a,e)},toHex8String:function(e){return"#"+this.toHex8(e)},toRgb:function(){return{r:Math.round(this._r),g:Math.round(this._g),b:Math.round(this._b),a:this._a}},toRgbString:function(){return this._a==1?"rgb("+Math.round(this._r)+", "+Math.round(this._g)+", "+Math.round(this._b)+")":"rgba("+Math.round(this._r)+", "+Math.round(this._g)+", "+Math.round(this._b)+", "+this._roundA+")"},toPercentageRgb:function(){return{r:Math.round(as(this._r,255)*100)+"%",g:Math.round(as(this._g,255)*100)+"%",b:Math.round(as(this._b,255)*100)+"%",a:this._a}},toPercentageRgbString:function(){return this._a==1?"rgb("+Math.round(as(this._r,255)*100)+"%, "+Math.round(as(this._g,255)*100)+"%, "+Math.round(as(this._b,255)*100)+"%)":"rgba("+Math.round(as(this._r,255)*100)+"%, "+Math.round(as(this._g,255)*100)+"%, "+Math.round(as(this._b,255)*100)+"%, "+this._roundA+")"},toName:function(){return this._a===0?"transparent":this._a<1?!1:u3e[OU(this._r,this._g,this._b,!0)]||!1},toFilter:function(e){var r="#"+LU(this._r,this._g,this._b,this._a),n=r,i=this._gradientType?"GradientType = 1, ":"";if(e){var a=ai(e);n="#"+LU(a._r,a._g,a._b,a._a)}return"progid:DXImageTransform.Microsoft.gradient("+i+"startColorstr="+r+",endColorstr="+n+")"},toString:function(e){var r=!!e;e=e||this._format;var n=!1,i=this._a<1&&this._a>=0,a=!r&&i&&(e==="hex"||e==="hex6"||e==="hex3"||e==="hex4"||e==="hex8"||e==="name");return a?e==="name"&&this._a===0?this.toName():this.toRgbString():(e==="rgb"&&(n=this.toRgbString()),e==="prgb"&&(n=this.toPercentageRgbString()),(e==="hex"||e==="hex6")&&(n=this.toHexString()),e==="hex3"&&(n=this.toHexString(!0)),e==="hex4"&&(n=this.toHex8String(!0)),e==="hex8"&&(n=this.toHex8String()),e==="name"&&(n=this.toName()),e==="hsl"&&(n=this.toHslString()),e==="hsv"&&(n=this.toHsvString()),n||this.toHexString())},clone:function(){return ai(this.toString())},_applyModification:function(e,r){var n=e.apply(null,[this].concat([].slice.call(r)));return this._r=n._r,this._g=n._g,this._b=n._b,this.setAlpha(n._a),this},lighten:function(){return this._applyModification(t3e,arguments)},brighten:function(){return this._applyModification(r3e,arguments)},darken:function(){return this._applyModification(n3e,arguments)},desaturate:function(){return this._applyModification(JCe,arguments)},saturate:function(){return this._applyModification(QCe,arguments)},greyscale:function(){return this._applyModification(e3e,arguments)},spin:function(){return this._applyModification(i3e,arguments)},_applyCombination:function(e,r){return e.apply(null,[this].concat([].slice.call(r)))},analogous:function(){return this._applyCombination(s3e,arguments)},complement:function(){return this._applyCombination(a3e,arguments)},monochromatic:function(){return this._applyCombination(l3e,arguments)},splitcomplement:function(){return this._applyCombination(o3e,arguments)},triad:function(){return this._applyCombination(NU,[3])},tetrad:function(){return this._applyCombination(NU,[4])}};ai.fromRatio=function(t,e){if(CS(t)=="object"){var r={};for(var n in t)t.hasOwnProperty(n)&&(n==="a"?r[n]=t[n]:r[n]=a1(t[n]));t=r}return ai(t,e)};function GCe(t){var e={r:0,g:0,b:0},r=1,n=null,i=null,a=null,s=!1,o=!1;return typeof t=="string"&&(t=d3e(t)),CS(t)=="object"&&(Cd(t.r)&&Cd(t.g)&&Cd(t.b)?(e=XCe(t.r,t.g,t.b),s=!0,o=String(t.r).substr(-1)==="%"?"prgb":"rgb"):Cd(t.h)&&Cd(t.s)&&Cd(t.v)?(n=a1(t.s),i=a1(t.v),e=ZCe(t.h,n,i),s=!0,o="hsv"):Cd(t.h)&&Cd(t.s)&&Cd(t.l)&&(n=a1(t.s),a=a1(t.l),e=YCe(t.h,n,a),s=!0,o="hsl"),t.hasOwnProperty("a")&&(r=t.a)),r=AK(r),{ok:s,format:t.format||o,r:Math.min(255,Math.max(e.r,0)),g:Math.min(255,Math.max(e.g,0)),b:Math.min(255,Math.max(e.b,0)),a:r}}function XCe(t,e,r){return{r:as(t,255)*255,g:as(e,255)*255,b:as(r,255)*255}}function MU(t,e,r){t=as(t,255),e=as(e,255),r=as(r,255);var n=Math.max(t,e,r),i=Math.min(t,e,r),a,s,o=(n+i)/2;if(n==i)a=s=0;else{var u=n-i;switch(s=o>.5?u/(2-n-i):u/(n+i),n){case t:a=(e-r)/u+(e<r?6:0);break;case e:a=(r-t)/u+2;break;case r:a=(t-e)/u+4;break}a/=6}return{h:a,s,l:o}}function YCe(t,e,r){var n,i,a;t=as(t,360),e=as(e,100),r=as(r,100);function s(h,f,g){return g<0&&(g+=1),g>1&&(g-=1),g<1/6?h+(f-h)*6*g:g<1/2?f:g<2/3?h+(f-h)*(2/3-g)*6:h}if(e===0)n=i=a=r;else{var o=r<.5?r*(1+e):r+e-r*e,u=2*r-o;n=s(u,o,t+1/3),i=s(u,o,t),a=s(u,o,t-1/3)}return{r:n*255,g:i*255,b:a*255}}function RU(t,e,r){t=as(t,255),e=as(e,255),r=as(r,255);var n=Math.max(t,e,r),i=Math.min(t,e,r),a,s,o=n,u=n-i;if(s=n===0?0:u/n,n==i)a=0;else{switch(n){case t:a=(e-r)/u+(e<r?6:0);break;case e:a=(r-t)/u+2;break;case r:a=(t-e)/u+4;break}a/=6}return{h:a,s,v:o}}function ZCe(t,e,r){t=as(t,360)*6,e=as(e,100),r=as(r,100);var n=Math.floor(t),i=t-n,a=r*(1-e),s=r*(1-i*e),o=r*(1-(1-i)*e),u=n%6,h=[r,s,a,a,o,r][u],f=[o,r,r,s,a,a][u],g=[a,a,o,r,r,s][u];return{r:h*255,g:f*255,b:g*255}}function OU(t,e,r,n){var i=[tf(Math.round(t).toString(16)),tf(Math.round(e).toString(16)),tf(Math.round(r).toString(16))];return n&&i[0].charAt(0)==i[0].charAt(1)&&i[1].charAt(0)==i[1].charAt(1)&&i[2].charAt(0)==i[2].charAt(1)?i[0].charAt(0)+i[1].charAt(0)+i[2].charAt(0):i.join("")}function KCe(t,e,r,n,i){var a=[tf(Math.round(t).toString(16)),tf(Math.round(e).toString(16)),tf(Math.round(r).toString(16)),tf(IK(n))];return i&&a[0].charAt(0)==a[0].charAt(1)&&a[1].charAt(0)==a[1].charAt(1)&&a[2].charAt(0)==a[2].charAt(1)&&a[3].charAt(0)==a[3].charAt(1)?a[0].charAt(0)+a[1].charAt(0)+a[2].charAt(0)+a[3].charAt(0):a.join("")}function LU(t,e,r,n){var i=[tf(IK(n)),tf(Math.round(t).toString(16)),tf(Math.round(e).toString(16)),tf(Math.round(r).toString(16))];return i.join("")}ai.equals=function(t,e){return!t||!e?!1:ai(t).toRgbString()==ai(e).toRgbString()};ai.random=function(){return ai.fromRatio({r:Math.random(),g:Math.random(),b:Math.random()})};function JCe(t,e){e=e===0?0:e||10;var r=ai(t).toHsl();return r.s-=e/100,r.s=RT(r.s),ai(r)}function QCe(t,e){e=e===0?0:e||10;var r=ai(t).toHsl();return r.s+=e/100,r.s=RT(r.s),ai(r)}function e3e(t){return ai(t).desaturate(100)}function t3e(t,e){e=e===0?0:e||10;var r=ai(t).toHsl();return r.l+=e/100,r.l=RT(r.l),ai(r)}function r3e(t,e){e=e===0?0:e||10;var r=ai(t).toRgb();return r.r=Math.max(0,Math.min(255,r.r-Math.round(255*-(e/100)))),r.g=Math.max(0,Math.min(255,r.g-Math.round(255*-(e/100)))),r.b=Math.max(0,Math.min(255,r.b-Math.round(255*-(e/100)))),ai(r)}function n3e(t,e){e=e===0?0:e||10;var r=ai(t).toHsl();return r.l-=e/100,r.l=RT(r.l),ai(r)}function i3e(t,e){var r=ai(t).toHsl(),n=(r.h+e)%360;return r.h=n<0?360+n:n,ai(r)}function a3e(t){var e=ai(t).toHsl();return e.h=(e.h+180)%360,ai(e)}function NU(t,e){if(isNaN(e)||e<=0)throw new Error("Argument to polyad must be a positive number");for(var r=ai(t).toHsl(),n=[ai(t)],i=360/e,a=1;a<e;a++)n.push(ai({h:(r.h+a*i)%360,s:r.s,l:r.l}));return n}function o3e(t){var e=ai(t).toHsl(),r=e.h;return[ai(t),ai({h:(r+72)%360,s:e.s,l:e.l}),ai({h:(r+216)%360,s:e.s,l:e.l})]}function s3e(t,e,r){e=e||6,r=r||30;var n=ai(t).toHsl(),i=360/r,a=[ai(t)];for(n.h=(n.h-(i*e>>1)+720)%360;--e;)n.h=(n.h+i)%360,a.push(ai(n));return a}function l3e(t,e){e=e||6;for(var r=ai(t).toHsv(),n=r.h,i=r.s,a=r.v,s=[],o=1/e;e--;)s.push(ai({h:n,s:i,v:a})),a=(a+o)%1;return s}ai.mix=function(t,e,r){r=r===0?0:r||50;var n=ai(t).toRgb(),i=ai(e).toRgb(),a=r/100,s={r:(i.r-n.r)*a+n.r,g:(i.g-n.g)*a+n.g,b:(i.b-n.b)*a+n.b,a:(i.a-n.a)*a+n.a};return ai(s)};ai.readability=function(t,e){var r=ai(t),n=ai(e);return(Math.max(r.getLuminance(),n.getLuminance())+.05)/(Math.min(r.getLuminance(),n.getLuminance())+.05)};ai.isReadable=function(t,e,r){var n=ai.readability(t,e),i,a;switch(a=!1,i=p3e(r),i.level+i.size){case"AAsmall":case"AAAlarge":a=n>=4.5;break;case"AAlarge":a=n>=3;break;case"AAAsmall":a=n>=7;break}return a};ai.mostReadable=function(t,e,r){var n=null,i=0,a,s,o,u;r=r||{},s=r.includeFallbackColors,o=r.level,u=r.size;for(var h=0;h<e.length;h++)a=ai.readability(t,e[h]),a>i&&(i=a,n=ai(e[h]));return ai.isReadable(t,n,{level:o,size:u})||!s?n:(r.includeFallbackColors=!1,ai.mostReadable(t,["#fff","#000"],r))};var Dk=ai.names={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"0ff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"00f",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",burntsienna:"ea7e5d",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"0ff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"f0f",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"663399",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"},u3e=ai.hexNames=c3e(Dk);function c3e(t){var e={};for(var r in t)t.hasOwnProperty(r)&&(e[t[r]]=r);return e}function AK(t){return t=parseFloat(t),(isNaN(t)||t<0||t>1)&&(t=1),t}function as(t,e){h3e(t)&&(t="100%");var r=f3e(t);return t=Math.min(e,Math.max(0,parseFloat(t))),r&&(t=parseInt(t*e,10)/100),Math.abs(t-e)<1e-6?1:t%e/parseFloat(e)}function RT(t){return Math.min(1,Math.max(0,t))}function Wc(t){return parseInt(t,16)}function h3e(t){return typeof t=="string"&&t.indexOf(".")!=-1&&parseFloat(t)===1}function f3e(t){return typeof t=="string"&&t.indexOf("%")!=-1}function tf(t){return t.length==1?"0"+t:""+t}function a1(t){return t<=1&&(t=t*100+"%"),t}function IK(t){return Math.round(parseFloat(t)*255).toString(16)}function DU(t){return Wc(t)/255}var Yh=(function(){var t="[-\\+]?\\d+%?",e="[-\\+]?\\d*\\.\\d+%?",r="(?:"+e+")|(?:"+t+")",n="[\\s|\\(]+("+r+")[,|\\s]+("+r+")[,|\\s]+("+r+")\\s*\\)?",i="[\\s|\\(]+("+r+")[,|\\s]+("+r+")[,|\\s]+("+r+")[,|\\s]+("+r+")\\s*\\)?";return{CSS_UNIT:new RegExp(r),rgb:new RegExp("rgb"+n),rgba:new RegExp("rgba"+i),hsl:new RegExp("hsl"+n),hsla:new RegExp("hsla"+i),hsv:new RegExp("hsv"+n),hsva:new RegExp("hsva"+i),hex3:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex4:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex8:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/}})();function Cd(t){return!!Yh.CSS_UNIT.exec(t)}function d3e(t){t=t.replace(HCe,"").replace(WCe,"").toLowerCase();var e=!1;if(Dk[t])t=Dk[t],e=!0;else if(t=="transparent")return{r:0,g:0,b:0,a:0,format:"name"};var r;return(r=Yh.rgb.exec(t))?{r:r[1],g:r[2],b:r[3]}:(r=Yh.rgba.exec(t))?{r:r[1],g:r[2],b:r[3],a:r[4]}:(r=Yh.hsl.exec(t))?{h:r[1],s:r[2],l:r[3]}:(r=Yh.hsla.exec(t))?{h:r[1],s:r[2],l:r[3],a:r[4]}:(r=Yh.hsv.exec(t))?{h:r[1],s:r[2],v:r[3]}:(r=Yh.hsva.exec(t))?{h:r[1],s:r[2],v:r[3],a:r[4]}:(r=Yh.hex8.exec(t))?{r:Wc(r[1]),g:Wc(r[2]),b:Wc(r[3]),a:DU(r[4]),format:e?"name":"hex8"}:(r=Yh.hex6.exec(t))?{r:Wc(r[1]),g:Wc(r[2]),b:Wc(r[3]),format:e?"name":"hex"}:(r=Yh.hex4.exec(t))?{r:Wc(r[1]+""+r[1]),g:Wc(r[2]+""+r[2]),b:Wc(r[3]+""+r[3]),a:DU(r[4]+""+r[4]),format:e?"name":"hex8"}:(r=Yh.hex3.exec(t))?{r:Wc(r[1]+""+r[1]),g:Wc(r[2]+""+r[2]),b:Wc(r[3]+""+r[3]),format:e?"name":"hex"}:!1}function p3e(t){var e,r;return t=t||{level:"AA",size:"small"},e=(t.level||"AA").toUpperCase(),r=(t.size||"small").toLowerCase(),e!=="AA"&&e!=="AAA"&&(e="AA"),r!=="small"&&r!=="large"&&(r="small"),{level:e,size:r}}var FU=function(e){var r=["r","g","b","a","h","s","l","v"],n=0,i=0;return qCe(r,function(a){if(e[a]&&(n+=1,isNaN(e[a])||(i+=1),a==="s"||a==="l")){var s=/^\d+%$/;s.test(e[a])&&(i+=1)}}),n===i?e:!1},o1=function(e,r){var n=e.hex?ai(e.hex):ai(e),i=n.toHsl(),a=n.toHsv(),s=n.toRgb(),o=n.toHex();i.s===0&&(i.h=r||0,a.h=r||0);var u=o==="000000"&&s.a===0;return{hsl:i,hex:u?"transparent":"#"+o,rgb:s,hsv:a,oldHue:e.h||r||i.h,source:e.source}},fg=function(e){if(e==="transparent")return!0;var r=String(e).charAt(0)==="#"?1:0;return e.length!==4+r&&e.length<7+r&&ai(e).isValid()},AL=function(e){if(!e)return"#fff";var r=o1(e);if(r.hex==="transparent")return"rgba(0,0,0,0.4)";var n=(r.rgb.r*299+r.rgb.g*587+r.rgb.b*114)/1e3;return n>=128?"#000":"#fff"},J4=function(e,r){var n=e.replace("","");return ai(r+" ("+n+")")._ok},C_=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},g3e=(function(){function t(e,r){for(var n=0;n<r.length;n++){var i=r[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}})();function m3e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function y3e(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e&&(typeof e=="object"||typeof e=="function")?e:t}function v3e(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var Ic=function(e){var r=(function(n){v3e(i,n);function i(a){m3e(this,i);var s=y3e(this,(i.__proto__||Object.getPrototypeOf(i)).call(this));return s.handleChange=function(o,u){var h=FU(o);if(h){var f=o1(o,o.h||s.state.oldHue);s.setState(f),s.props.onChangeComplete&&s.debounce(s.props.onChangeComplete,f,u),s.props.onChange&&s.props.onChange(f,u)}},s.handleSwatchHover=function(o,u){var h=FU(o);if(h){var f=o1(o,o.h||s.state.oldHue);s.props.onSwatchHover&&s.props.onSwatchHover(f,u)}},s.state=C_({},o1(a.color,0)),s.debounce=TK(function(o,u,h){o(u,h)},100),s}return g3e(i,[{key:"render",value:function(){var s={};return this.props.onSwatchHover&&(s.onSwatchHover=this.handleSwatchHover),ht.createElement(e,C_({},this.props,this.state,{onChange:this.handleChange},s))}}],[{key:"getDerivedStateFromProps",value:function(s,o){return C_({},o1(s.color,o.oldHue))}}]),i})(ee.PureComponent||ee.Component);return r.propTypes=C_({},e.propTypes),r.defaultProps=C_({},e.defaultProps,{color:{h:250,s:.5,l:.2,a:1}}),r},_3e=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},b3e=(function(){function t(e,r){for(var n=0;n<r.length;n++){var i=r[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}})();function x3e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function BU(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e&&(typeof e=="object"||typeof e=="function")?e:t}function w3e(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var S3e=function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"span";return(function(n){w3e(i,n);function i(){var a,s,o,u;x3e(this,i);for(var h=arguments.length,f=Array(h),g=0;g<h;g++)f[g]=arguments[g];return u=(s=(o=BU(this,(a=i.__proto__||Object.getPrototypeOf(i)).call.apply(a,[this].concat(f))),o),o.state={focus:!1},o.handleFocus=function(){return o.setState({focus:!0})},o.handleBlur=function(){return o.setState({focus:!1})},s),BU(o,u)}return b3e(i,[{key:"render",value:function(){return ht.createElement(r,{onFocus:this.handleFocus,onBlur:this.handleBlur},ht.createElement(e,_3e({},this.props,this.state)))}}]),i})(ht.Component)},zU=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},E3e=13,T3e=function(e){var r=e.color,n=e.style,i=e.onClick,a=i===void 0?function(){}:i,s=e.onHover,o=e.title,u=o===void 0?r:o,h=e.children,f=e.focus,g=e.focusStyle,b=g===void 0?{}:g,v=r==="transparent",S=Di({default:{swatch:zU({background:r,height:"100%",width:"100%",cursor:"pointer",position:"relative",outline:"none"},n,f?b:{})}}),E=function(M){return a(r,M)},P=function(M){return M.keyCode===E3e&&a(r,M)},k=function(M){return s(r,M)},L={};return s&&(L.onMouseOver=k),ht.createElement("div",zU({style:S.swatch,onClick:E,title:u,tabIndex:0,onKeyDown:P},L),h,v&&ht.createElement(j0,{borderRadius:S.swatch.borderRadius,boxShadow:"inset 0 0 0 1px rgba(0,0,0,0.1)"}))};const Xm=S3e(T3e);var C3e=function(e){var r=e.direction,n=Di({default:{picker:{width:"18px",height:"18px",borderRadius:"50%",transform:"translate(-9px, -1px)",backgroundColor:"rgb(248, 248, 248)",boxShadow:"0 1px 4px 0 rgba(0, 0, 0, 0.37)"}},vertical:{picker:{transform:"translate(-3px, -9px)"}}},{vertical:r==="vertical"});return ht.createElement("div",{style:n.picker})},A3e=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},PK=function(e){var r=e.rgb,n=e.hsl,i=e.width,a=e.height,s=e.onChange,o=e.direction,u=e.style,h=e.renderers,f=e.pointer,g=e.className,b=g===void 0?"":g,v=Di({default:{picker:{position:"relative",width:i,height:a},alpha:{radius:"2px",style:u}}});return ht.createElement("div",{style:v.picker,className:"alpha-picker "+b},ht.createElement(_L,A3e({},v.alpha,{rgb:r,hsl:n,pointer:f,renderers:h,onChange:s,direction:o})))};PK.defaultProps={width:"316px",height:"16px",direction:"horizontal",pointer:C3e};Ic(PK);function kK(t,e){for(var r=-1,n=t==null?0:t.length,i=Array(n);++r<n;)i[r]=e(t[r],r,t);return i}var I3e="__lodash_hash_undefined__";function P3e(t){return this.__data__.set(t,I3e),this}function k3e(t){return this.__data__.has(t)}function AS(t){var e=-1,r=t==null?0:t.length;for(this.__data__=new np;++e<r;)this.add(t[e])}AS.prototype.add=AS.prototype.push=P3e;AS.prototype.has=k3e;function M3e(t,e){for(var r=-1,n=t==null?0:t.length;++r<n;)if(e(t[r],r,t))return!0;return!1}function R3e(t,e){return t.has(e)}var O3e=1,L3e=2;function MK(t,e,r,n,i,a){var s=r&O3e,o=t.length,u=e.length;if(o!=u&&!(s&&u>o))return!1;var h=a.get(t),f=a.get(e);if(h&&f)return h==e&&f==t;var g=-1,b=!0,v=r&L3e?new AS:void 0;for(a.set(t,e),a.set(e,t);++g<o;){var S=t[g],E=e[g];if(n)var P=s?n(E,S,g,e,t,a):n(S,E,g,t,e,a);if(P!==void 0){if(P)continue;b=!1;break}if(v){if(!M3e(e,function(k,L){if(!R3e(v,L)&&(S===k||i(S,k,r,n,a)))return v.push(L)})){b=!1;break}}else if(!(S===E||i(S,E,r,n,a))){b=!1;break}}return a.delete(t),a.delete(e),b}function N3e(t){var e=-1,r=Array(t.size);return t.forEach(function(n,i){r[++e]=[i,n]}),r}function D3e(t){var e=-1,r=Array(t.size);return t.forEach(function(n){r[++e]=n}),r}var F3e=1,B3e=2,z3e="[object Boolean]",j3e="[object Date]",U3e="[object Error]",V3e="[object Map]",$3e="[object Number]",q3e="[object RegExp]",H3e="[object Set]",W3e="[object String]",G3e="[object Symbol]",X3e="[object ArrayBuffer]",Y3e="[object DataView]",jU=rg?rg.prototype:void 0,Q4=jU?jU.valueOf:void 0;function Z3e(t,e,r,n,i,a,s){switch(r){case Y3e:if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case X3e:return!(t.byteLength!=e.byteLength||!a(new SS(t),new SS(e)));case z3e:case j3e:case $3e:return ox(+t,+e);case U3e:return t.name==e.name&&t.message==e.message;case q3e:case W3e:return t==e+"";case V3e:var o=N3e;case H3e:var u=n&F3e;if(o||(o=D3e),t.size!=e.size&&!u)return!1;var h=s.get(t);if(h)return h==e;n|=B3e,s.set(t,e);var f=MK(o(t),o(e),n,i,a,s);return s.delete(t),f;case G3e:if(Q4)return Q4.call(t)==Q4.call(e)}return!1}function K3e(t,e){for(var r=-1,n=e.length,i=t.length;++r<n;)t[i+r]=e[r];return t}function J3e(t,e,r){var n=e(t);return ah(t)?n:K3e(n,r(t))}function Q3e(t,e){for(var r=-1,n=t==null?0:t.length,i=0,a=[];++r<n;){var s=t[r];e(s,r,t)&&(a[i++]=s)}return a}function eAe(){return[]}var tAe=Object.prototype,rAe=tAe.propertyIsEnumerable,UU=Object.getOwnPropertySymbols,nAe=UU?function(t){return t==null?[]:(t=Object(t),Q3e(UU(t),function(e){return rAe.call(t,e)}))}:eAe;function VU(t){return J3e(t,CL,nAe)}var iAe=1,aAe=Object.prototype,oAe=aAe.hasOwnProperty;function sAe(t,e,r,n,i,a){var s=r&iAe,o=VU(t),u=o.length,h=VU(e),f=h.length;if(u!=f&&!s)return!1;for(var g=u;g--;){var b=o[g];if(!(s?b in e:oAe.call(e,b)))return!1}var v=a.get(t),S=a.get(e);if(v&&S)return v==e&&S==t;var E=!0;a.set(t,e),a.set(e,t);for(var P=s;++g<u;){b=o[g];var k=t[b],L=e[b];if(n)var O=s?n(L,k,b,e,t,a):n(k,L,b,t,e,a);if(!(O===void 0?k===L||i(k,L,r,n,a):O)){E=!1;break}P||(P=b=="constructor")}if(E&&!P){var M=t.constructor,z=e.constructor;M!=z&&"constructor"in t&&"constructor"in e&&!(typeof M=="function"&&M instanceof M&&typeof z=="function"&&z instanceof z)&&(E=!1)}return a.delete(t),a.delete(e),E}var Fk=Gm(mf,"DataView"),Bk=Gm(mf,"Promise"),zk=Gm(mf,"Set"),jk=Gm(mf,"WeakMap"),$U="[object Map]",lAe="[object Object]",qU="[object Promise]",HU="[object Set]",WU="[object WeakMap]",GU="[object DataView]",uAe=Wm(Fk),cAe=Wm(fb),hAe=Wm(Bk),fAe=Wm(zk),dAe=Wm(jk),Ip=Hm;(Fk&&Ip(new Fk(new ArrayBuffer(1)))!=GU||fb&&Ip(new fb)!=$U||Bk&&Ip(Bk.resolve())!=qU||zk&&Ip(new zk)!=HU||jk&&Ip(new jk)!=WU)&&(Ip=function(t){var e=Hm(t),r=e==lAe?t.constructor:void 0,n=r?Wm(r):"";if(n)switch(n){case uAe:return GU;case cAe:return $U;case hAe:return qU;case fAe:return HU;case dAe:return WU}return e});var pAe=1,XU="[object Arguments]",YU="[object Array]",R2="[object Object]",gAe=Object.prototype,ZU=gAe.hasOwnProperty;function mAe(t,e,r,n,i,a){var s=ah(t),o=ah(e),u=s?YU:Ip(t),h=o?YU:Ip(e);u=u==XU?R2:u,h=h==XU?R2:h;var f=u==R2,g=h==R2,b=u==h;if(b&&TS(t)){if(!TS(e))return!1;s=!0,f=!1}if(b&&!f)return a||(a=new Qf),s||EL(t)?MK(t,e,r,n,i,a):Z3e(t,e,u,r,n,i,a);if(!(r&pAe)){var v=f&&ZU.call(t,"__wrapped__"),S=g&&ZU.call(e,"__wrapped__");if(v||S){var E=v?t.value():t,P=S?e.value():e;return a||(a=new Qf),i(E,P,r,n,a)}}return b?(a||(a=new Qf),sAe(t,e,r,n,i,a)):!1}function IL(t,e,r,n,i){return t===e?!0:t==null||e==null||!ng(t)&&!ng(e)?t!==t&&e!==e:mAe(t,e,r,n,IL,i)}var yAe=1,vAe=2;function _Ae(t,e,r,n){var i=r.length,a=i;if(t==null)return!a;for(t=Object(t);i--;){var s=r[i];if(s[2]?s[1]!==t[s[0]]:!(s[0]in t))return!1}for(;++i<a;){s=r[i];var o=s[0],u=t[o],h=s[1];if(s[2]){if(u===void 0&&!(o in t))return!1}else{var f=new Qf,g;if(!(g===void 0?IL(h,u,yAe|vAe,n,f):g))return!1}}return!0}function RK(t){return t===t&&!Oh(t)}function bAe(t){for(var e=CL(t),r=e.length;r--;){var n=e[r],i=t[n];e[r]=[n,i,RK(i)]}return e}function OK(t,e){return function(r){return r==null?!1:r[t]===e&&(e!==void 0||t in Object(r))}}function xAe(t){var e=bAe(t);return e.length==1&&e[0][2]?OK(e[0][0],e[0][1]):function(r){return r===t||_Ae(r,t,e)}}var wAe=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,SAe=/^\w*$/;function PL(t,e){if(ah(t))return!1;var r=typeof t;return r=="number"||r=="symbol"||r=="boolean"||t==null||kT(t)?!0:SAe.test(t)||!wAe.test(t)||e!=null&&t in Object(e)}var EAe="Expected a function";function kL(t,e){if(typeof t!="function"||e!=null&&typeof e!="function")throw new TypeError(EAe);var r=function(){var n=arguments,i=e?e.apply(this,n):n[0],a=r.cache;if(a.has(i))return a.get(i);var s=t.apply(this,n);return r.cache=a.set(i,s)||a,s};return r.cache=new(kL.Cache||np),r}kL.Cache=np;var TAe=500;function CAe(t){var e=kL(t,function(n){return r.size===TAe&&r.clear(),n}),r=e.cache;return e}var AAe=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,IAe=/\\(\\)?/g,PAe=CAe(function(t){var e=[];return t.charCodeAt(0)===46&&e.push(""),t.replace(AAe,function(r,n,i,a){e.push(i?a.replace(IAe,"$1"):n||r)}),e}),KU=rg?rg.prototype:void 0,JU=KU?KU.toString:void 0;function LK(t){if(typeof t=="string")return t;if(ah(t))return kK(t,LK)+"";if(kT(t))return JU?JU.call(t):"";var e=t+"";return e=="0"&&1/t==-1/0?"-0":e}function kAe(t){return t==null?"":LK(t)}function NK(t,e){return ah(t)?t:PL(t,e)?[t]:PAe(kAe(t))}function OT(t){if(typeof t=="string"||kT(t))return t;var e=t+"";return e=="0"&&1/t==-1/0?"-0":e}function DK(t,e){e=NK(e,t);for(var r=0,n=e.length;t!=null&&r<n;)t=t[OT(e[r++])];return r&&r==n?t:void 0}function MAe(t,e,r){var n=t==null?void 0:DK(t,e);return n===void 0?r:n}function RAe(t,e){return t!=null&&e in Object(t)}function OAe(t,e,r){e=NK(e,t);for(var n=-1,i=e.length,a=!1;++n<i;){var s=OT(e[n]);if(!(a=t!=null&&r(t,s)))break;t=t[s]}return a||++n!=i?a:(i=t==null?0:t.length,!!i&&SL(i)&&TL(s,i)&&(ah(t)||ES(t)))}function LAe(t,e){return t!=null&&OAe(t,e,RAe)}var NAe=1,DAe=2;function FAe(t,e){return PL(t)&&RK(e)?OK(OT(t),e):function(r){var n=MAe(r,t);return n===void 0&&n===e?LAe(r,t):IL(e,n,NAe|DAe)}}function BAe(t){return function(e){return e?.[t]}}function zAe(t){return function(e){return DK(e,t)}}function jAe(t){return PL(t)?BAe(OT(t)):zAe(t)}function UAe(t){return typeof t=="function"?t:t==null?PT:typeof t=="object"?ah(t)?FAe(t[0],t[1]):xAe(t):jAe(t)}function VAe(t,e){var r=-1,n=V0(t)?Array(t.length):[];return CK(t,function(i,a,s){n[++r]=e(i,a,s)}),n}function Ym(t,e){var r=ah(t)?kK:VAe;return r(t,UAe(e))}var $Ae=function(e){var r=e.colors,n=e.onClick,i=e.onSwatchHover,a=Di({default:{swatches:{marginRight:"-10px"},swatch:{width:"22px",height:"22px",float:"left",marginRight:"10px",marginBottom:"10px",borderRadius:"4px"},clear:{clear:"both"}}});return ht.createElement("div",{style:a.swatches},Ym(r,function(s){return ht.createElement(Xm,{key:s,color:s,style:a.swatch,onClick:n,onHover:i,focusStyle:{boxShadow:"0 0 4px "+s}})}),ht.createElement("div",{style:a.clear}))},ML=function(e){var r=e.onChange,n=e.onSwatchHover,i=e.hex,a=e.colors,s=e.width,o=e.triangle,u=e.styles,h=u===void 0?{}:u,f=e.className,g=f===void 0?"":f,b=i==="transparent",v=function(P,k){fg(P)&&r({hex:P,source:"hex"},k)},S=Di(Ac({default:{card:{width:s,background:"#fff",boxShadow:"0 1px rgba(0,0,0,.1)",borderRadius:"6px",position:"relative"},head:{height:"110px",background:i,borderRadius:"6px 6px 0 0",display:"flex",alignItems:"center",justifyContent:"center",position:"relative"},body:{padding:"10px"},label:{fontSize:"18px",color:AL(i),position:"relative"},triangle:{width:"0px",height:"0px",borderStyle:"solid",borderWidth:"0 10px 10px 10px",borderColor:"transparent transparent "+i+" transparent",position:"absolute",top:"-10px",left:"50%",marginLeft:"-10px"},input:{width:"100%",fontSize:"12px",color:"#666",border:"0px",outline:"none",height:"22px",boxShadow:"inset 0 0 0 1px #ddd",borderRadius:"4px",padding:"0 7px",boxSizing:"border-box"}},"hide-triangle":{triangle:{display:"none"}}},h),{"hide-triangle":o==="hide"});return ht.createElement("div",{style:S.card,className:"block-picker "+g},ht.createElement("div",{style:S.triangle}),ht.createElement("div",{style:S.head},b&&ht.createElement(j0,{borderRadius:"6px 6px 0 0"}),ht.createElement("div",{style:S.label},i)),ht.createElement("div",{style:S.body},ht.createElement($Ae,{colors:a,onClick:v,onSwatchHover:n}),ht.createElement(ga,{style:{input:S.input},value:i,onChange:v})))};ML.propTypes={width:Pn.oneOfType([Pn.string,Pn.number]),colors:Pn.arrayOf(Pn.string),triangle:Pn.oneOf(["top","hide"]),styles:Pn.object};ML.defaultProps={width:170,colors:["#D9E3F0","#F47373","#697689","#37D67A","#2CCCE4","#555555","#dce775","#ff8a65","#ba68c8"],triangle:"top",styles:{}};Ic(ML);var rv={100:"#ffcdd2",300:"#e57373",500:"#f44336",700:"#d32f2f",900:"#b71c1c"},nv={100:"#f8bbd0",300:"#f06292",500:"#e91e63",700:"#c2185b",900:"#880e4f"},iv={100:"#e1bee7",300:"#ba68c8",500:"#9c27b0",700:"#7b1fa2",900:"#4a148c"},av={100:"#d1c4e9",300:"#9575cd",500:"#673ab7",700:"#512da8",900:"#311b92"},ov={100:"#c5cae9",300:"#7986cb",500:"#3f51b5",700:"#303f9f",900:"#1a237e"},sv={100:"#bbdefb",300:"#64b5f6",500:"#2196f3",700:"#1976d2",900:"#0d47a1"},lv={100:"#b3e5fc",300:"#4fc3f7",500:"#03a9f4",700:"#0288d1",900:"#01579b"},uv={100:"#b2ebf2",300:"#4dd0e1",500:"#00bcd4",700:"#0097a7",900:"#006064"},cv={100:"#b2dfdb",300:"#4db6ac",500:"#009688",700:"#00796b",900:"#004d40"},s1={100:"#c8e6c9",300:"#81c784",500:"#4caf50",700:"#388e3c"},hv={100:"#dcedc8",300:"#aed581",500:"#8bc34a",700:"#689f38",900:"#33691e"},fv={100:"#f0f4c3",300:"#dce775",500:"#cddc39",700:"#afb42b",900:"#827717"},dv={100:"#fff9c4",300:"#fff176",500:"#ffeb3b",700:"#fbc02d",900:"#f57f17"},pv={100:"#ffecb3",300:"#ffd54f",500:"#ffc107",700:"#ffa000",900:"#ff6f00"},gv={100:"#ffe0b2",300:"#ffb74d",500:"#ff9800",700:"#f57c00",900:"#e65100"},mv={100:"#ffccbc",300:"#ff8a65",500:"#ff5722",700:"#e64a19",900:"#bf360c"},yv={100:"#d7ccc8",300:"#a1887f",500:"#795548",700:"#5d4037",900:"#3e2723"},vv={100:"#cfd8dc",300:"#90a4ae",500:"#607d8b",700:"#455a64",900:"#263238"},FK=function(e){var r=e.color,n=e.onClick,i=e.onSwatchHover,a=e.hover,s=e.active,o=e.circleSize,u=e.circleSpacing,h=Di({default:{swatch:{width:o,height:o,marginRight:u,marginBottom:u,transform:"scale(1)",transition:"100ms transform ease"},Swatch:{borderRadius:"50%",background:"transparent",boxShadow:"inset 0 0 0 "+(o/2+1)+"px "+r,transition:"100ms box-shadow ease"}},hover:{swatch:{transform:"scale(1.2)"}},active:{Swatch:{boxShadow:"inset 0 0 0 3px "+r}}},{hover:a,active:s});return ht.createElement("div",{style:h.swatch},ht.createElement(Xm,{style:h.Swatch,color:r,onClick:n,onHover:i,focusStyle:{boxShadow:h.Swatch.boxShadow+", 0 0 5px "+r}}))};FK.defaultProps={circleSize:28,circleSpacing:14};const qAe=vL.handleHover(FK);var RL=function(e){var r=e.width,n=e.onChange,i=e.onSwatchHover,a=e.colors,s=e.hex,o=e.circleSize,u=e.styles,h=u===void 0?{}:u,f=e.circleSpacing,g=e.className,b=g===void 0?"":g,v=Di(Ac({default:{card:{width:r,display:"flex",flexWrap:"wrap",marginRight:-f,marginBottom:-f}}},h)),S=function(P,k){return n({hex:P,source:"hex"},k)};return ht.createElement("div",{style:v.card,className:"circle-picker "+b},Ym(a,function(E){return ht.createElement(qAe,{key:E,color:E,onClick:S,onSwatchHover:i,active:s===E.toLowerCase(),circleSize:o,circleSpacing:f})}))};RL.propTypes={width:Pn.oneOfType([Pn.string,Pn.number]),circleSize:Pn.number,circleSpacing:Pn.number,styles:Pn.object};RL.defaultProps={width:252,circleSize:28,circleSpacing:14,colors:[rv[500],nv[500],iv[500],av[500],ov[500],sv[500],lv[500],uv[500],cv[500],s1[500],hv[500],fv[500],dv[500],pv[500],gv[500],mv[500],yv[500],vv[500]],styles:{}};Ic(RL);function QU(t){return t===void 0}var O2={},eV;function HAe(){if(eV)return O2;eV=1,Object.defineProperty(O2,"__esModule",{value:!0});var t=Object.assign||function(s){for(var o=1;o<arguments.length;o++){var u=arguments[o];for(var h in u)Object.prototype.hasOwnProperty.call(u,h)&&(s[h]=u[h])}return s},e=Lb(),r=n(e);function n(s){return s&&s.__esModule?s:{default:s}}function i(s,o){var u={};for(var h in s)o.indexOf(h)>=0||Object.prototype.hasOwnProperty.call(s,h)&&(u[h]=s[h]);return u}var a=24;return O2.default=function(s){var o=s.fill,u=o===void 0?"currentColor":o,h=s.width,f=h===void 0?a:h,g=s.height,b=g===void 0?a:g,v=s.style,S=v===void 0?{}:v,E=i(s,["fill","width","height","style"]);return r.default.createElement("svg",t({viewBox:"0 0 "+a+" "+a,style:t({fill:u,width:f,height:b},S)},E),r.default.createElement("path",{d:"M12,18.17L8.83,15L7.42,16.41L12,21L16.59,16.41L15.17,15M12,5.83L15.17,9L16.58,7.59L12,3L7.41,7.59L8.83,9L12,5.83Z"}))},O2}var WAe=HAe();const GAe=od(WAe);var XAe=(function(){function t(e,r){for(var n=0;n<r.length;n++){var i=r[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}})();function YAe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function ZAe(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e&&(typeof e=="object"||typeof e=="function")?e:t}function KAe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var BK=(function(t){KAe(e,t);function e(r){YAe(this,e);var n=ZAe(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return n.toggleViews=function(){n.state.view==="hex"?n.setState({view:"rgb"}):n.state.view==="rgb"?n.setState({view:"hsl"}):n.state.view==="hsl"&&(n.props.hsl.a===1?n.setState({view:"hex"}):n.setState({view:"rgb"}))},n.handleChange=function(i,a){i.hex?fg(i.hex)&&n.props.onChange({hex:i.hex,source:"hex"},a):i.r||i.g||i.b?n.props.onChange({r:i.r||n.props.rgb.r,g:i.g||n.props.rgb.g,b:i.b||n.props.rgb.b,source:"rgb"},a):i.a?(i.a<0?i.a=0:i.a>1&&(i.a=1),n.props.onChange({h:n.props.hsl.h,s:n.props.hsl.s,l:n.props.hsl.l,a:Math.round(i.a*100)/100,source:"rgb"},a)):(i.h||i.s||i.l)&&(typeof i.s=="string"&&i.s.includes("%")&&(i.s=i.s.replace("%","")),typeof i.l=="string"&&i.l.includes("%")&&(i.l=i.l.replace("%","")),i.s==1?i.s=.01:i.l==1&&(i.l=.01),n.props.onChange({h:i.h||n.props.hsl.h,s:Number(QU(i.s)?n.props.hsl.s:i.s),l:Number(QU(i.l)?n.props.hsl.l:i.l),source:"hsl"},a))},n.showHighlight=function(i){i.currentTarget.style.background="#eee"},n.hideHighlight=function(i){i.currentTarget.style.background="transparent"},r.hsl.a!==1&&r.view==="hex"?n.state={view:"rgb"}:n.state={view:r.view},n}return XAe(e,[{key:"render",value:function(){var n=this,i=Di({default:{wrap:{paddingTop:"16px",display:"flex"},fields:{flex:"1",display:"flex",marginLeft:"-6px"},field:{paddingLeft:"6px",width:"100%"},alpha:{paddingLeft:"6px",width:"100%"},toggle:{width:"32px",textAlign:"right",position:"relative"},icon:{marginRight:"-4px",marginTop:"12px",cursor:"pointer",position:"relative"},iconHighlight:{position:"absolute",width:"24px",height:"28px",background:"#eee",borderRadius:"4px",top:"10px",left:"12px",display:"none"},input:{fontSize:"11px",color:"#333",width:"100%",borderRadius:"2px",border:"none",boxShadow:"inset 0 0 0 1px #dadada",height:"21px",textAlign:"center"},label:{textTransform:"uppercase",fontSize:"11px",lineHeight:"11px",color:"#969696",textAlign:"center",display:"block",marginTop:"12px"},svg:{fill:"#333",width:"24px",height:"24px",border:"1px transparent solid",borderRadius:"5px"}},disableAlpha:{alpha:{display:"none"}}},this.props,this.state),a=void 0;return this.state.view==="hex"?a=ht.createElement("div",{style:i.fields,className:"flexbox-fix"},ht.createElement("div",{style:i.field},ht.createElement(ga,{style:{input:i.input,label:i.label},label:"hex",value:this.props.hex,onChange:this.handleChange}))):this.state.view==="rgb"?a=ht.createElement("div",{style:i.fields,className:"flexbox-fix"},ht.createElement("div",{style:i.field},ht.createElement(ga,{style:{input:i.input,label:i.label},label:"r",value:this.props.rgb.r,onChange:this.handleChange})),ht.createElement("div",{style:i.field},ht.createElement(ga,{style:{input:i.input,label:i.label},label:"g",value:this.props.rgb.g,onChange:this.handleChange})),ht.createElement("div",{style:i.field},ht.createElement(ga,{style:{input:i.input,label:i.label},label:"b",value:this.props.rgb.b,onChange:this.handleChange})),ht.createElement("div",{style:i.alpha},ht.createElement(ga,{style:{input:i.input,label:i.label},label:"a",value:this.props.rgb.a,arrowOffset:.01,onChange:this.handleChange}))):this.state.view==="hsl"&&(a=ht.createElement("div",{style:i.fields,className:"flexbox-fix"},ht.createElement("div",{style:i.field},ht.createElement(ga,{style:{input:i.input,label:i.label},label:"h",value:Math.round(this.props.hsl.h),onChange:this.handleChange})),ht.createElement("div",{style:i.field},ht.createElement(ga,{style:{input:i.input,label:i.label},label:"s",value:Math.round(this.props.hsl.s*100)+"%",onChange:this.handleChange})),ht.createElement("div",{style:i.field},ht.createElement(ga,{style:{input:i.input,label:i.label},label:"l",value:Math.round(this.props.hsl.l*100)+"%",onChange:this.handleChange})),ht.createElement("div",{style:i.alpha},ht.createElement(ga,{style:{input:i.input,label:i.label},label:"a",value:this.props.hsl.a,arrowOffset:.01,onChange:this.handleChange})))),ht.createElement("div",{style:i.wrap,className:"flexbox-fix"},a,ht.createElement("div",{style:i.toggle},ht.createElement("div",{style:i.icon,onClick:this.toggleViews,ref:function(o){return n.icon=o}},ht.createElement(GAe,{style:i.svg,onMouseOver:this.showHighlight,onMouseEnter:this.showHighlight,onMouseOut:this.hideHighlight}))))}}],[{key:"getDerivedStateFromProps",value:function(n,i){return n.hsl.a!==1&&i.view==="hex"?{view:"rgb"}:null}}]),e})(ht.Component);BK.defaultProps={view:"hex"};var tV=function(){var e=Di({default:{picker:{width:"12px",height:"12px",borderRadius:"6px",transform:"translate(-6px, -1px)",backgroundColor:"rgb(248, 248, 248)",boxShadow:"0 1px 4px 0 rgba(0, 0, 0, 0.37)"}}});return ht.createElement("div",{style:e.picker})},JAe=function(){var e=Di({default:{picker:{width:"12px",height:"12px",borderRadius:"6px",boxShadow:"inset 0 0 0 1px #fff",transform:"translate(-6px, -6px)"}}});return ht.createElement("div",{style:e.picker})},OL=function(e){var r=e.width,n=e.onChange,i=e.disableAlpha,a=e.rgb,s=e.hsl,o=e.hsv,u=e.hex,h=e.renderers,f=e.styles,g=f===void 0?{}:f,b=e.className,v=b===void 0?"":b,S=e.defaultView,E=Di(Ac({default:{picker:{width:r,background:"#fff",borderRadius:"2px",boxShadow:"0 0 2px rgba(0,0,0,.3), 0 4px 8px rgba(0,0,0,.3)",boxSizing:"initial",fontFamily:"Menlo"},saturation:{width:"100%",paddingBottom:"55%",position:"relative",borderRadius:"2px 2px 0 0",overflow:"hidden"},Saturation:{radius:"2px 2px 0 0"},body:{padding:"16px 16px 12px"},controls:{display:"flex"},color:{width:"32px"},swatch:{marginTop:"6px",width:"16px",height:"16px",borderRadius:"8px",position:"relative",overflow:"hidden"},active:{absolute:"0px 0px 0px 0px",borderRadius:"8px",boxShadow:"inset 0 0 0 1px rgba(0,0,0,.1)",background:"rgba("+a.r+", "+a.g+", "+a.b+", "+a.a+")",zIndex:"2"},toggles:{flex:"1"},hue:{height:"10px",position:"relative",marginBottom:"8px"},Hue:{radius:"2px"},alpha:{height:"10px",position:"relative"},Alpha:{radius:"2px"}},disableAlpha:{color:{width:"22px"},alpha:{display:"none"},hue:{marginBottom:"0px"},swatch:{width:"10px",height:"10px",marginTop:"0px"}}},g),{disableAlpha:i});return ht.createElement("div",{style:E.picker,className:"chrome-picker "+v},ht.createElement("div",{style:E.saturation},ht.createElement(MT,{style:E.Saturation,hsl:s,hsv:o,pointer:JAe,onChange:n})),ht.createElement("div",{style:E.body},ht.createElement("div",{style:E.controls,className:"flexbox-fix"},ht.createElement("div",{style:E.color},ht.createElement("div",{style:E.swatch},ht.createElement("div",{style:E.active}),ht.createElement(j0,{renderers:h}))),ht.createElement("div",{style:E.toggles},ht.createElement("div",{style:E.hue},ht.createElement(U0,{style:E.Hue,hsl:s,pointer:tV,onChange:n})),ht.createElement("div",{style:E.alpha},ht.createElement(_L,{style:E.Alpha,rgb:a,hsl:s,pointer:tV,renderers:h,onChange:n})))),ht.createElement(BK,{rgb:a,hsl:s,hex:u,view:S,onChange:n,disableAlpha:i})))};OL.propTypes={width:Pn.oneOfType([Pn.string,Pn.number]),disableAlpha:Pn.bool,styles:Pn.object,defaultView:Pn.oneOf(["hex","rgb","hsl"])};OL.defaultProps={width:225,disableAlpha:!1,styles:{}};const QAe=Ic(OL);var e5e=function(e){var r=e.color,n=e.onClick,i=n===void 0?function(){}:n,a=e.onSwatchHover,s=e.active,o=Di({default:{color:{background:r,width:"15px",height:"15px",float:"left",marginRight:"5px",marginBottom:"5px",position:"relative",cursor:"pointer"},dot:{absolute:"5px 5px 5px 5px",background:AL(r),borderRadius:"50%",opacity:"0"}},active:{dot:{opacity:"1"}},"color-#FFFFFF":{color:{boxShadow:"inset 0 0 0 1px #ddd"},dot:{background:"#000"}},transparent:{dot:{background:"#000"}}},{active:s,"color-#FFFFFF":r==="#FFFFFF",transparent:r==="transparent"});return ht.createElement(Xm,{style:o.color,color:r,onClick:i,onHover:a,focusStyle:{boxShadow:"0 0 4px "+r}},ht.createElement("div",{style:o.dot}))},t5e=function(e){var r=e.hex,n=e.rgb,i=e.onChange,a=Di({default:{fields:{display:"flex",paddingBottom:"6px",paddingRight:"5px",position:"relative"},active:{position:"absolute",top:"6px",left:"5px",height:"9px",width:"9px",background:r},HEXwrap:{flex:"6",position:"relative"},HEXinput:{width:"80%",padding:"0px",paddingLeft:"20%",border:"none",outline:"none",background:"none",fontSize:"12px",color:"#333",height:"16px"},HEXlabel:{display:"none"},RGBwrap:{flex:"3",position:"relative"},RGBinput:{width:"70%",padding:"0px",paddingLeft:"30%",border:"none",outline:"none",background:"none",fontSize:"12px",color:"#333",height:"16px"},RGBlabel:{position:"absolute",top:"3px",left:"0px",lineHeight:"16px",textTransform:"uppercase",fontSize:"12px",color:"#999"}}}),s=function(u,h){u.r||u.g||u.b?i({r:u.r||n.r,g:u.g||n.g,b:u.b||n.b,source:"rgb"},h):i({hex:u.hex,source:"hex"},h)};return ht.createElement("div",{style:a.fields,className:"flexbox-fix"},ht.createElement("div",{style:a.active}),ht.createElement(ga,{style:{wrap:a.HEXwrap,input:a.HEXinput,label:a.HEXlabel},label:"hex",value:r,onChange:s}),ht.createElement(ga,{style:{wrap:a.RGBwrap,input:a.RGBinput,label:a.RGBlabel},label:"r",value:n.r,onChange:s}),ht.createElement(ga,{style:{wrap:a.RGBwrap,input:a.RGBinput,label:a.RGBlabel},label:"g",value:n.g,onChange:s}),ht.createElement(ga,{style:{wrap:a.RGBwrap,input:a.RGBinput,label:a.RGBlabel},label:"b",value:n.b,onChange:s}))},LL=function(e){var r=e.onChange,n=e.onSwatchHover,i=e.colors,a=e.hex,s=e.rgb,o=e.styles,u=o===void 0?{}:o,h=e.className,f=h===void 0?"":h,g=Di(Ac({default:{Compact:{background:"#f6f6f6",radius:"4px"},compact:{paddingTop:"5px",paddingLeft:"5px",boxSizing:"initial",width:"240px"},clear:{clear:"both"}}},u)),b=function(S,E){S.hex?fg(S.hex)&&r({hex:S.hex,source:"hex"},E):r(S,E)};return ht.createElement(sx,{style:g.Compact,styles:u},ht.createElement("div",{style:g.compact,className:"compact-picker "+f},ht.createElement("div",null,Ym(i,function(v){return ht.createElement(e5e,{key:v,color:v,active:v.toLowerCase()===a,onClick:b,onSwatchHover:n})}),ht.createElement("div",{style:g.clear})),ht.createElement(t5e,{hex:a,rgb:s,onChange:b})))};LL.propTypes={colors:Pn.arrayOf(Pn.string),styles:Pn.object};LL.defaultProps={colors:["#4D4D4D","#999999","#FFFFFF","#F44E3B","#FE9200","#FCDC00","#DBDF00","#A4DD00","#68CCCA","#73D8FF","#AEA1FF","#FDA1FF","#333333","#808080","#cccccc","#D33115","#E27300","#FCC400","#B0BC00","#68BC00","#16A5A5","#009CE0","#7B64FF","#FA28FF","#000000","#666666","#B3B3B3","#9F0500","#C45100","#FB9E00","#808900","#194D33","#0C797D","#0062B1","#653294","#AB149E"],styles:{}};Ic(LL);var r5e=function(e){var r=e.hover,n=e.color,i=e.onClick,a=e.onSwatchHover,s={position:"relative",zIndex:"2",outline:"2px solid #fff",boxShadow:"0 0 5px 2px rgba(0,0,0,0.25)"},o=Di({default:{swatch:{width:"25px",height:"25px",fontSize:"0"}},hover:{swatch:s}},{hover:r});return ht.createElement("div",{style:o.swatch},ht.createElement(Xm,{color:n,onClick:i,onHover:a,focusStyle:s}))};const n5e=vL.handleHover(r5e);var NL=function(e){var r=e.width,n=e.colors,i=e.onChange,a=e.onSwatchHover,s=e.triangle,o=e.styles,u=o===void 0?{}:o,h=e.className,f=h===void 0?"":h,g=Di(Ac({default:{card:{width:r,background:"#fff",border:"1px solid rgba(0,0,0,0.2)",boxShadow:"0 3px 12px rgba(0,0,0,0.15)",borderRadius:"4px",position:"relative",padding:"5px",display:"flex",flexWrap:"wrap"},triangle:{position:"absolute",border:"7px solid transparent",borderBottomColor:"#fff"},triangleShadow:{position:"absolute",border:"8px solid transparent",borderBottomColor:"rgba(0,0,0,0.15)"}},"hide-triangle":{triangle:{display:"none"},triangleShadow:{display:"none"}},"top-left-triangle":{triangle:{top:"-14px",left:"10px"},triangleShadow:{top:"-16px",left:"9px"}},"top-right-triangle":{triangle:{top:"-14px",right:"10px"},triangleShadow:{top:"-16px",right:"9px"}},"bottom-left-triangle":{triangle:{top:"35px",left:"10px",transform:"rotate(180deg)"},triangleShadow:{top:"37px",left:"9px",transform:"rotate(180deg)"}},"bottom-right-triangle":{triangle:{top:"35px",right:"10px",transform:"rotate(180deg)"},triangleShadow:{top:"37px",right:"9px",transform:"rotate(180deg)"}}},u),{"hide-triangle":s==="hide","top-left-triangle":s==="top-left","top-right-triangle":s==="top-right","bottom-left-triangle":s==="bottom-left","bottom-right-triangle":s==="bottom-right"}),b=function(S,E){return i({hex:S,source:"hex"},E)};return ht.createElement("div",{style:g.card,className:"github-picker "+f},ht.createElement("div",{style:g.triangleShadow}),ht.createElement("div",{style:g.triangle}),Ym(n,function(v){return ht.createElement(n5e,{color:v,key:v,onClick:b,onSwatchHover:a})}))};NL.propTypes={width:Pn.oneOfType([Pn.string,Pn.number]),colors:Pn.arrayOf(Pn.string),triangle:Pn.oneOf(["hide","top-left","top-right","bottom-left","bottom-right"]),styles:Pn.object};NL.defaultProps={width:200,colors:["#B80000","#DB3E00","#FCCB00","#008B02","#006B76","#1273DE","#004DCF","#5300EB","#EB9694","#FAD0C3","#FEF3BD","#C1E1C5","#BEDADC","#C4DEF6","#BED3F3","#D4C4FB"],triangle:"top-left",styles:{}};Ic(NL);var i5e=function(e){var r=e.direction,n=Di({default:{picker:{width:"18px",height:"18px",borderRadius:"50%",transform:"translate(-9px, -1px)",backgroundColor:"rgb(248, 248, 248)",boxShadow:"0 1px 4px 0 rgba(0, 0, 0, 0.37)"}},vertical:{picker:{transform:"translate(-3px, -9px)"}}},{vertical:r==="vertical"});return ht.createElement("div",{style:n.picker})},a5e=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},DL=function(e){var r=e.width,n=e.height,i=e.onChange,a=e.hsl,s=e.direction,o=e.pointer,u=e.styles,h=u===void 0?{}:u,f=e.className,g=f===void 0?"":f,b=Di(Ac({default:{picker:{position:"relative",width:r,height:n},hue:{radius:"2px"}}},h)),v=function(E){return i({a:1,h:E.h,l:.5,s:1})};return ht.createElement("div",{style:b.picker,className:"hue-picker "+g},ht.createElement(U0,a5e({},b.hue,{hsl:a,pointer:o,onChange:v,direction:s})))};DL.propTypes={styles:Pn.object};DL.defaultProps={width:"316px",height:"16px",direction:"horizontal",pointer:i5e,styles:{}};Ic(DL);var o5e=function(e){var r=e.onChange,n=e.hex,i=e.rgb,a=e.styles,s=a===void 0?{}:a,o=e.className,u=o===void 0?"":o,h=Di(Ac({default:{material:{width:"98px",height:"98px",padding:"16px",fontFamily:"Roboto"},HEXwrap:{position:"relative"},HEXinput:{width:"100%",marginTop:"12px",fontSize:"15px",color:"#333",padding:"0px",border:"0px",borderBottom:"2px solid "+n,outline:"none",height:"30px"},HEXlabel:{position:"absolute",top:"0px",left:"0px",fontSize:"11px",color:"#999999",textTransform:"capitalize"},Hex:{style:{}},RGBwrap:{position:"relative"},RGBinput:{width:"100%",marginTop:"12px",fontSize:"15px",color:"#333",padding:"0px",border:"0px",borderBottom:"1px solid #eee",outline:"none",height:"30px"},RGBlabel:{position:"absolute",top:"0px",left:"0px",fontSize:"11px",color:"#999999",textTransform:"capitalize"},split:{display:"flex",marginRight:"-10px",paddingTop:"11px"},third:{flex:"1",paddingRight:"10px"}}},s)),f=function(b,v){b.hex?fg(b.hex)&&r({hex:b.hex,source:"hex"},v):(b.r||b.g||b.b)&&r({r:b.r||i.r,g:b.g||i.g,b:b.b||i.b,source:"rgb"},v)};return ht.createElement(sx,{styles:s},ht.createElement("div",{style:h.material,className:"material-picker "+u},ht.createElement(ga,{style:{wrap:h.HEXwrap,input:h.HEXinput,label:h.HEXlabel},label:"hex",value:n,onChange:f}),ht.createElement("div",{style:h.split,className:"flexbox-fix"},ht.createElement("div",{style:h.third},ht.createElement(ga,{style:{wrap:h.RGBwrap,input:h.RGBinput,label:h.RGBlabel},label:"r",value:i.r,onChange:f})),ht.createElement("div",{style:h.third},ht.createElement(ga,{style:{wrap:h.RGBwrap,input:h.RGBinput,label:h.RGBlabel},label:"g",value:i.g,onChange:f})),ht.createElement("div",{style:h.third},ht.createElement(ga,{style:{wrap:h.RGBwrap,input:h.RGBinput,label:h.RGBlabel},label:"b",value:i.b,onChange:f})))))};Ic(o5e);var s5e=function(e){var r=e.onChange,n=e.rgb,i=e.hsv,a=e.hex,s=Di({default:{fields:{paddingTop:"5px",paddingBottom:"9px",width:"80px",position:"relative"},divider:{height:"5px"},RGBwrap:{position:"relative"},RGBinput:{marginLeft:"40%",width:"40%",height:"18px",border:"1px solid #888888",boxShadow:"inset 0 1px 1px rgba(0,0,0,.1), 0 1px 0 0 #ECECEC",marginBottom:"5px",fontSize:"13px",paddingLeft:"3px",marginRight:"10px"},RGBlabel:{left:"0px",top:"0px",width:"34px",textTransform:"uppercase",fontSize:"13px",height:"18px",lineHeight:"22px",position:"absolute"},HEXwrap:{position:"relative"},HEXinput:{marginLeft:"20%",width:"80%",height:"18px",border:"1px solid #888888",boxShadow:"inset 0 1px 1px rgba(0,0,0,.1), 0 1px 0 0 #ECECEC",marginBottom:"6px",fontSize:"13px",paddingLeft:"3px"},HEXlabel:{position:"absolute",top:"0px",left:"0px",width:"14px",textTransform:"uppercase",fontSize:"13px",height:"18px",lineHeight:"22px"},fieldSymbols:{position:"absolute",top:"5px",right:"-7px",fontSize:"13px"},symbol:{height:"20px",lineHeight:"22px",paddingBottom:"7px"}}}),o=function(h,f){h["#"]?fg(h["#"])&&r({hex:h["#"],source:"hex"},f):h.r||h.g||h.b?r({r:h.r||n.r,g:h.g||n.g,b:h.b||n.b,source:"rgb"},f):(h.h||h.s||h.v)&&r({h:h.h||i.h,s:h.s||i.s,v:h.v||i.v,source:"hsv"},f)};return ht.createElement("div",{style:s.fields},ht.createElement(ga,{style:{wrap:s.RGBwrap,input:s.RGBinput,label:s.RGBlabel},label:"h",value:Math.round(i.h),onChange:o}),ht.createElement(ga,{style:{wrap:s.RGBwrap,input:s.RGBinput,label:s.RGBlabel},label:"s",value:Math.round(i.s*100),onChange:o}),ht.createElement(ga,{style:{wrap:s.RGBwrap,input:s.RGBinput,label:s.RGBlabel},label:"v",value:Math.round(i.v*100),onChange:o}),ht.createElement("div",{style:s.divider}),ht.createElement(ga,{style:{wrap:s.RGBwrap,input:s.RGBinput,label:s.RGBlabel},label:"r",value:n.r,onChange:o}),ht.createElement(ga,{style:{wrap:s.RGBwrap,input:s.RGBinput,label:s.RGBlabel},label:"g",value:n.g,onChange:o}),ht.createElement(ga,{style:{wrap:s.RGBwrap,input:s.RGBinput,label:s.RGBlabel},label:"b",value:n.b,onChange:o}),ht.createElement("div",{style:s.divider}),ht.createElement(ga,{style:{wrap:s.HEXwrap,input:s.HEXinput,label:s.HEXlabel},label:"#",value:a.replace("#",""),onChange:o}),ht.createElement("div",{style:s.fieldSymbols},ht.createElement("div",{style:s.symbol},""),ht.createElement("div",{style:s.symbol},"%"),ht.createElement("div",{style:s.symbol},"%")))},l5e=function(e){var r=e.hsl,n=Di({default:{picker:{width:"12px",height:"12px",borderRadius:"6px",boxShadow:"inset 0 0 0 1px #fff",transform:"translate(-6px, -6px)"}},"black-outline":{picker:{boxShadow:"inset 0 0 0 1px #000"}}},{"black-outline":r.l>.5});return ht.createElement("div",{style:n.picker})},u5e=function(){var e=Di({default:{triangle:{width:0,height:0,borderStyle:"solid",borderWidth:"4px 0 4px 6px",borderColor:"transparent transparent transparent #fff",position:"absolute",top:"1px",left:"1px"},triangleBorder:{width:0,height:0,borderStyle:"solid",borderWidth:"5px 0 5px 8px",borderColor:"transparent transparent transparent #555"},left:{Extend:"triangleBorder",transform:"translate(-13px, -4px)"},leftInside:{Extend:"triangle",transform:"translate(-8px, -5px)"},right:{Extend:"triangleBorder",transform:"translate(20px, -14px) rotate(180deg)"},rightInside:{Extend:"triangle",transform:"translate(-8px, -5px)"}}});return ht.createElement("div",{style:e.pointer},ht.createElement("div",{style:e.left},ht.createElement("div",{style:e.leftInside})),ht.createElement("div",{style:e.right},ht.createElement("div",{style:e.rightInside})))},rV=function(e){var r=e.onClick,n=e.label,i=e.children,a=e.active,s=Di({default:{button:{backgroundImage:"linear-gradient(-180deg, #FFFFFF 0%, #E6E6E6 100%)",border:"1px solid #878787",borderRadius:"2px",height:"20px",boxShadow:"0 1px 0 0 #EAEAEA",fontSize:"14px",color:"#000",lineHeight:"20px",textAlign:"center",marginBottom:"10px",cursor:"pointer"}},active:{button:{boxShadow:"0 0 0 1px #878787"}}},{active:a});return ht.createElement("div",{style:s.button,onClick:r},n||i)},c5e=function(e){var r=e.rgb,n=e.currentColor,i=Di({default:{swatches:{border:"1px solid #B3B3B3",borderBottom:"1px solid #F0F0F0",marginBottom:"2px",marginTop:"1px"},new:{height:"34px",background:"rgb("+r.r+","+r.g+", "+r.b+")",boxShadow:"inset 1px 0 0 #000, inset -1px 0 0 #000, inset 0 1px 0 #000"},current:{height:"34px",background:n,boxShadow:"inset 1px 0 0 #000, inset -1px 0 0 #000, inset 0 -1px 0 #000"},label:{fontSize:"14px",color:"#000",textAlign:"center"}}});return ht.createElement("div",null,ht.createElement("div",{style:i.label},"new"),ht.createElement("div",{style:i.swatches},ht.createElement("div",{style:i.new}),ht.createElement("div",{style:i.current})),ht.createElement("div",{style:i.label},"current"))},h5e=(function(){function t(e,r){for(var n=0;n<r.length;n++){var i=r[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}})();function f5e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function d5e(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e&&(typeof e=="object"||typeof e=="function")?e:t}function p5e(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var FL=(function(t){p5e(e,t);function e(r){f5e(this,e);var n=d5e(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return n.state={currentColor:r.hex},n}return h5e(e,[{key:"render",value:function(){var n=this.props,i=n.styles,a=i===void 0?{}:i,s=n.className,o=s===void 0?"":s,u=Di(Ac({default:{picker:{background:"#DCDCDC",borderRadius:"4px",boxShadow:"0 0 0 1px rgba(0,0,0,.25), 0 8px 16px rgba(0,0,0,.15)",boxSizing:"initial",width:"513px"},head:{backgroundImage:"linear-gradient(-180deg, #F0F0F0 0%, #D4D4D4 100%)",borderBottom:"1px solid #B1B1B1",boxShadow:"inset 0 1px 0 0 rgba(255,255,255,.2), inset 0 -1px 0 0 rgba(0,0,0,.02)",height:"23px",lineHeight:"24px",borderRadius:"4px 4px 0 0",fontSize:"13px",color:"#4D4D4D",textAlign:"center"},body:{padding:"15px 15px 0",display:"flex"},saturation:{width:"256px",height:"256px",position:"relative",border:"2px solid #B3B3B3",borderBottom:"2px solid #F0F0F0",overflow:"hidden"},hue:{position:"relative",height:"256px",width:"19px",marginLeft:"10px",border:"2px solid #B3B3B3",borderBottom:"2px solid #F0F0F0"},controls:{width:"180px",marginLeft:"10px"},top:{display:"flex"},previews:{width:"60px"},actions:{flex:"1",marginLeft:"20px"}}},a));return ht.createElement("div",{style:u.picker,className:"photoshop-picker "+o},ht.createElement("div",{style:u.head},this.props.header),ht.createElement("div",{style:u.body,className:"flexbox-fix"},ht.createElement("div",{style:u.saturation},ht.createElement(MT,{hsl:this.props.hsl,hsv:this.props.hsv,pointer:l5e,onChange:this.props.onChange})),ht.createElement("div",{style:u.hue},ht.createElement(U0,{direction:"vertical",hsl:this.props.hsl,pointer:u5e,onChange:this.props.onChange})),ht.createElement("div",{style:u.controls},ht.createElement("div",{style:u.top,className:"flexbox-fix"},ht.createElement("div",{style:u.previews},ht.createElement(c5e,{rgb:this.props.rgb,currentColor:this.state.currentColor})),ht.createElement("div",{style:u.actions},ht.createElement(rV,{label:"OK",onClick:this.props.onAccept,active:!0}),ht.createElement(rV,{label:"Cancel",onClick:this.props.onCancel}),ht.createElement(s5e,{onChange:this.props.onChange,rgb:this.props.rgb,hsv:this.props.hsv,hex:this.props.hex}))))))}}]),e})(ht.Component);FL.propTypes={header:Pn.string,styles:Pn.object};FL.defaultProps={header:"Color Picker",styles:{}};Ic(FL);var g5e=function(e){var r=e.onChange,n=e.rgb,i=e.hsl,a=e.hex,s=e.disableAlpha,o=Di({default:{fields:{display:"flex",paddingTop:"4px"},single:{flex:"1",paddingLeft:"6px"},alpha:{flex:"1",paddingLeft:"6px"},double:{flex:"2"},input:{width:"80%",padding:"4px 10% 3px",border:"none",boxShadow:"inset 0 0 0 1px #ccc",fontSize:"11px"},label:{display:"block",textAlign:"center",fontSize:"11px",color:"#222",paddingTop:"3px",paddingBottom:"4px",textTransform:"capitalize"}},disableAlpha:{alpha:{display:"none"}}},{disableAlpha:s}),u=function(f,g){f.hex?fg(f.hex)&&r({hex:f.hex,source:"hex"},g):f.r||f.g||f.b?r({r:f.r||n.r,g:f.g||n.g,b:f.b||n.b,a:n.a,source:"rgb"},g):f.a&&(f.a<0?f.a=0:f.a>100&&(f.a=100),f.a/=100,r({h:i.h,s:i.s,l:i.l,a:f.a,source:"rgb"},g))};return ht.createElement("div",{style:o.fields,className:"flexbox-fix"},ht.createElement("div",{style:o.double},ht.createElement(ga,{style:{input:o.input,label:o.label},label:"hex",value:a.replace("#",""),onChange:u})),ht.createElement("div",{style:o.single},ht.createElement(ga,{style:{input:o.input,label:o.label},label:"r",value:n.r,onChange:u,dragLabel:"true",dragMax:"255"})),ht.createElement("div",{style:o.single},ht.createElement(ga,{style:{input:o.input,label:o.label},label:"g",value:n.g,onChange:u,dragLabel:"true",dragMax:"255"})),ht.createElement("div",{style:o.single},ht.createElement(ga,{style:{input:o.input,label:o.label},label:"b",value:n.b,onChange:u,dragLabel:"true",dragMax:"255"})),ht.createElement("div",{style:o.alpha},ht.createElement(ga,{style:{input:o.input,label:o.label},label:"a",value:Math.round(n.a*100),onChange:u,dragLabel:"true",dragMax:"100"})))},m5e=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},zK=function(e){var r=e.colors,n=e.onClick,i=n===void 0?function(){}:n,a=e.onSwatchHover,s=Di({default:{colors:{margin:"0 -10px",padding:"10px 0 0 10px",borderTop:"1px solid #eee",display:"flex",flexWrap:"wrap",position:"relative"},swatchWrap:{width:"16px",height:"16px",margin:"0 10px 10px 0"},swatch:{borderRadius:"3px",boxShadow:"inset 0 0 0 1px rgba(0,0,0,.15)"}},"no-presets":{colors:{display:"none"}}},{"no-presets":!r||!r.length}),o=function(h,f){i({hex:h,source:"hex"},f)};return ht.createElement("div",{style:s.colors,className:"flexbox-fix"},r.map(function(u){var h=typeof u=="string"?{color:u}:u,f=""+h.color+(h.title||"");return ht.createElement("div",{key:f,style:s.swatchWrap},ht.createElement(Xm,m5e({},h,{style:s.swatch,onClick:o,onHover:a,focusStyle:{boxShadow:"inset 0 0 0 1px rgba(0,0,0,.15), 0 0 4px "+h.color}})))}))};zK.propTypes={colors:Pn.arrayOf(Pn.oneOfType([Pn.string,Pn.shape({color:Pn.string,title:Pn.string})])).isRequired};var y5e=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},BL=function(e){var r=e.width,n=e.rgb,i=e.hex,a=e.hsv,s=e.hsl,o=e.onChange,u=e.onSwatchHover,h=e.disableAlpha,f=e.presetColors,g=e.renderers,b=e.styles,v=b===void 0?{}:b,S=e.className,E=S===void 0?"":S,P=Di(Ac({default:y5e({picker:{width:r,padding:"10px 10px 0",boxSizing:"initial",background:"#fff",borderRadius:"4px",boxShadow:"0 0 0 1px rgba(0,0,0,.15), 0 8px 16px rgba(0,0,0,.15)"},saturation:{width:"100%",paddingBottom:"75%",position:"relative",overflow:"hidden"},Saturation:{radius:"3px",shadow:"inset 0 0 0 1px rgba(0,0,0,.15), inset 0 0 4px rgba(0,0,0,.25)"},controls:{display:"flex"},sliders:{padding:"4px 0",flex:"1"},color:{width:"24px",height:"24px",position:"relative",marginTop:"4px",marginLeft:"4px",borderRadius:"3px"},activeColor:{absolute:"0px 0px 0px 0px",borderRadius:"2px",background:"rgba("+n.r+","+n.g+","+n.b+","+n.a+")",boxShadow:"inset 0 0 0 1px rgba(0,0,0,.15), inset 0 0 4px rgba(0,0,0,.25)"},hue:{position:"relative",height:"10px",overflow:"hidden"},Hue:{radius:"2px",shadow:"inset 0 0 0 1px rgba(0,0,0,.15), inset 0 0 4px rgba(0,0,0,.25)"},alpha:{position:"relative",height:"10px",marginTop:"4px",overflow:"hidden"},Alpha:{radius:"2px",shadow:"inset 0 0 0 1px rgba(0,0,0,.15), inset 0 0 4px rgba(0,0,0,.25)"}},v),disableAlpha:{color:{height:"10px"},hue:{height:"10px"},alpha:{display:"none"}}},v),{disableAlpha:h});return ht.createElement("div",{style:P.picker,className:"sketch-picker "+E},ht.createElement("div",{style:P.saturation},ht.createElement(MT,{style:P.Saturation,hsl:s,hsv:a,onChange:o})),ht.createElement("div",{style:P.controls,className:"flexbox-fix"},ht.createElement("div",{style:P.sliders},ht.createElement("div",{style:P.hue},ht.createElement(U0,{style:P.Hue,hsl:s,onChange:o})),ht.createElement("div",{style:P.alpha},ht.createElement(_L,{style:P.Alpha,rgb:n,hsl:s,renderers:g,onChange:o}))),ht.createElement("div",{style:P.color},ht.createElement(j0,null),ht.createElement("div",{style:P.activeColor}))),ht.createElement(g5e,{rgb:n,hsl:s,hex:i,onChange:o,disableAlpha:h}),ht.createElement(zK,{colors:f,onClick:o,onSwatchHover:u}))};BL.propTypes={disableAlpha:Pn.bool,width:Pn.oneOfType([Pn.string,Pn.number]),styles:Pn.object};BL.defaultProps={disableAlpha:!1,width:200,styles:{},presetColors:["#D0021B","#F5A623","#F8E71C","#8B572A","#7ED321","#417505","#BD10E0","#9013FE","#4A90E2","#50E3C2","#B8E986","#000000","#4A4A4A","#9B9B9B","#FFFFFF"]};Ic(BL);var A_=function(e){var r=e.hsl,n=e.offset,i=e.onClick,a=i===void 0?function(){}:i,s=e.active,o=e.first,u=e.last,h=Di({default:{swatch:{height:"12px",background:"hsl("+r.h+", 50%, "+n*100+"%)",cursor:"pointer"}},first:{swatch:{borderRadius:"2px 0 0 2px"}},last:{swatch:{borderRadius:"0 2px 2px 0"}},active:{swatch:{transform:"scaleY(1.8)",borderRadius:"3.6px/2px"}}},{active:s,first:o,last:u}),f=function(b){return a({h:r.h,s:.5,l:n,source:"hsl"},b)};return ht.createElement("div",{style:h.swatch,onClick:f})},v5e=function(e){var r=e.onClick,n=e.hsl,i=Di({default:{swatches:{marginTop:"20px"},swatch:{boxSizing:"border-box",width:"20%",paddingRight:"1px",float:"left"},clear:{clear:"both"}}}),a=.1;return ht.createElement("div",{style:i.swatches},ht.createElement("div",{style:i.swatch},ht.createElement(A_,{hsl:n,offset:".80",active:Math.abs(n.l-.8)<a&&Math.abs(n.s-.5)<a,onClick:r,first:!0})),ht.createElement("div",{style:i.swatch},ht.createElement(A_,{hsl:n,offset:".65",active:Math.abs(n.l-.65)<a&&Math.abs(n.s-.5)<a,onClick:r})),ht.createElement("div",{style:i.swatch},ht.createElement(A_,{hsl:n,offset:".50",active:Math.abs(n.l-.5)<a&&Math.abs(n.s-.5)<a,onClick:r})),ht.createElement("div",{style:i.swatch},ht.createElement(A_,{hsl:n,offset:".35",active:Math.abs(n.l-.35)<a&&Math.abs(n.s-.5)<a,onClick:r})),ht.createElement("div",{style:i.swatch},ht.createElement(A_,{hsl:n,offset:".20",active:Math.abs(n.l-.2)<a&&Math.abs(n.s-.5)<a,onClick:r,last:!0})),ht.createElement("div",{style:i.clear}))},_5e=function(){var e=Di({default:{picker:{width:"14px",height:"14px",borderRadius:"6px",transform:"translate(-7px, -1px)",backgroundColor:"rgb(248, 248, 248)",boxShadow:"0 1px 4px 0 rgba(0, 0, 0, 0.37)"}}});return ht.createElement("div",{style:e.picker})},zL=function(e){var r=e.hsl,n=e.onChange,i=e.pointer,a=e.styles,s=a===void 0?{}:a,o=e.className,u=o===void 0?"":o,h=Di(Ac({default:{hue:{height:"12px",position:"relative"},Hue:{radius:"2px"}}},s));return ht.createElement("div",{style:h.wrap||{},className:"slider-picker "+u},ht.createElement("div",{style:h.hue},ht.createElement(U0,{style:h.Hue,hsl:r,pointer:i,onChange:n})),ht.createElement("div",{style:h.swatches},ht.createElement(v5e,{hsl:r,onClick:n})))};zL.propTypes={styles:Pn.object};zL.defaultProps={pointer:_5e,styles:{}};Ic(zL);var L2={},nV;function b5e(){if(nV)return L2;nV=1,Object.defineProperty(L2,"__esModule",{value:!0});var t=Object.assign||function(s){for(var o=1;o<arguments.length;o++){var u=arguments[o];for(var h in u)Object.prototype.hasOwnProperty.call(u,h)&&(s[h]=u[h])}return s},e=Lb(),r=n(e);function n(s){return s&&s.__esModule?s:{default:s}}function i(s,o){var u={};for(var h in s)o.indexOf(h)>=0||Object.prototype.hasOwnProperty.call(s,h)&&(u[h]=s[h]);return u}var a=24;return L2.default=function(s){var o=s.fill,u=o===void 0?"currentColor":o,h=s.width,f=h===void 0?a:h,g=s.height,b=g===void 0?a:g,v=s.style,S=v===void 0?{}:v,E=i(s,["fill","width","height","style"]);return r.default.createElement("svg",t({viewBox:"0 0 "+a+" "+a,style:t({fill:u,width:f,height:b},S)},E),r.default.createElement("path",{d:"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"}))},L2}var x5e=b5e();const w5e=od(x5e);var S5e=function(e){var r=e.color,n=e.onClick,i=n===void 0?function(){}:n,a=e.onSwatchHover,s=e.first,o=e.last,u=e.active,h=Di({default:{color:{width:"40px",height:"24px",cursor:"pointer",background:r,marginBottom:"1px"},check:{color:AL(r),marginLeft:"8px",display:"none"}},first:{color:{overflow:"hidden",borderRadius:"2px 2px 0 0"}},last:{color:{overflow:"hidden",borderRadius:"0 0 2px 2px"}},active:{check:{display:"block"}},"color-#FFFFFF":{color:{boxShadow:"inset 0 0 0 1px #ddd"},check:{color:"#333"}},transparent:{check:{color:"#333"}}},{first:s,last:o,active:u,"color-#FFFFFF":r==="#FFFFFF",transparent:r==="transparent"});return ht.createElement(Xm,{color:r,style:h.color,onClick:i,onHover:a,focusStyle:{boxShadow:"0 0 4px "+r}},ht.createElement("div",{style:h.check},ht.createElement(w5e,null)))},E5e=function(e){var r=e.onClick,n=e.onSwatchHover,i=e.group,a=e.active,s=Di({default:{group:{paddingBottom:"10px",width:"40px",float:"left",marginRight:"10px"}}});return ht.createElement("div",{style:s.group},Ym(i,function(o,u){return ht.createElement(S5e,{key:o,color:o,active:o.toLowerCase()===a,first:u===0,last:u===i.length-1,onClick:r,onSwatchHover:n})}))},jL=function(e){var r=e.width,n=e.height,i=e.onChange,a=e.onSwatchHover,s=e.colors,o=e.hex,u=e.styles,h=u===void 0?{}:u,f=e.className,g=f===void 0?"":f,b=Di(Ac({default:{picker:{width:r,height:n},overflow:{height:n,overflowY:"scroll"},body:{padding:"16px 0 6px 16px"},clear:{clear:"both"}}},h)),v=function(E,P){return i({hex:E,source:"hex"},P)};return ht.createElement("div",{style:b.picker,className:"swatches-picker "+g},ht.createElement(sx,null,ht.createElement("div",{style:b.overflow},ht.createElement("div",{style:b.body},Ym(s,function(S){return ht.createElement(E5e,{key:S.toString(),group:S,active:o,onClick:v,onSwatchHover:a})}),ht.createElement("div",{style:b.clear})))))};jL.propTypes={width:Pn.oneOfType([Pn.string,Pn.number]),height:Pn.oneOfType([Pn.string,Pn.number]),colors:Pn.arrayOf(Pn.arrayOf(Pn.string)),styles:Pn.object};jL.defaultProps={width:320,height:240,colors:[[rv[900],rv[700],rv[500],rv[300],rv[100]],[nv[900],nv[700],nv[500],nv[300],nv[100]],[iv[900],iv[700],iv[500],iv[300],iv[100]],[av[900],av[700],av[500],av[300],av[100]],[ov[900],ov[700],ov[500],ov[300],ov[100]],[sv[900],sv[700],sv[500],sv[300],sv[100]],[lv[900],lv[700],lv[500],lv[300],lv[100]],[uv[900],uv[700],uv[500],uv[300],uv[100]],[cv[900],cv[700],cv[500],cv[300],cv[100]],["#194D33",s1[700],s1[500],s1[300],s1[100]],[hv[900],hv[700],hv[500],hv[300],hv[100]],[fv[900],fv[700],fv[500],fv[300],fv[100]],[dv[900],dv[700],dv[500],dv[300],dv[100]],[pv[900],pv[700],pv[500],pv[300],pv[100]],[gv[900],gv[700],gv[500],gv[300],gv[100]],[mv[900],mv[700],mv[500],mv[300],mv[100]],[yv[900],yv[700],yv[500],yv[300],yv[100]],[vv[900],vv[700],vv[500],vv[300],vv[100]],["#000000","#525252","#969696","#D9D9D9","#FFFFFF"]],styles:{}};Ic(jL);var UL=function(e){var r=e.onChange,n=e.onSwatchHover,i=e.hex,a=e.colors,s=e.width,o=e.triangle,u=e.styles,h=u===void 0?{}:u,f=e.className,g=f===void 0?"":f,b=Di(Ac({default:{card:{width:s,background:"#fff",border:"0 solid rgba(0,0,0,0.25)",boxShadow:"0 1px 4px rgba(0,0,0,0.25)",borderRadius:"4px",position:"relative"},body:{padding:"15px 9px 9px 15px"},label:{fontSize:"18px",color:"#fff"},triangle:{width:"0px",height:"0px",borderStyle:"solid",borderWidth:"0 9px 10px 9px",borderColor:"transparent transparent #fff transparent",position:"absolute"},triangleShadow:{width:"0px",height:"0px",borderStyle:"solid",borderWidth:"0 9px 10px 9px",borderColor:"transparent transparent rgba(0,0,0,.1) transparent",position:"absolute"},hash:{background:"#F0F0F0",height:"30px",width:"30px",borderRadius:"4px 0 0 4px",float:"left",color:"#98A1A4",display:"flex",alignItems:"center",justifyContent:"center"},input:{width:"100px",fontSize:"14px",color:"#666",border:"0px",outline:"none",height:"28px",boxShadow:"inset 0 0 0 1px #F0F0F0",boxSizing:"content-box",borderRadius:"0 4px 4px 0",float:"left",paddingLeft:"8px"},swatch:{width:"30px",height:"30px",float:"left",borderRadius:"4px",margin:"0 6px 6px 0"},clear:{clear:"both"}},"hide-triangle":{triangle:{display:"none"},triangleShadow:{display:"none"}},"top-left-triangle":{triangle:{top:"-10px",left:"12px"},triangleShadow:{top:"-11px",left:"12px"}},"top-right-triangle":{triangle:{top:"-10px",right:"12px"},triangleShadow:{top:"-11px",right:"12px"}}},h),{"hide-triangle":o==="hide","top-left-triangle":o==="top-left","top-right-triangle":o==="top-right"}),v=function(E,P){fg(E)&&r({hex:E,source:"hex"},P)};return ht.createElement("div",{style:b.card,className:"twitter-picker "+g},ht.createElement("div",{style:b.triangleShadow}),ht.createElement("div",{style:b.triangle}),ht.createElement("div",{style:b.body},Ym(a,function(S,E){return ht.createElement(Xm,{key:E,color:S,hex:S,style:b.swatch,onClick:v,onHover:n,focusStyle:{boxShadow:"0 0 4px "+S}})}),ht.createElement("div",{style:b.hash},"#"),ht.createElement(ga,{label:null,style:{input:b.input},value:i.replace("#",""),onChange:v}),ht.createElement("div",{style:b.clear})))};UL.propTypes={width:Pn.oneOfType([Pn.string,Pn.number]),triangle:Pn.oneOf(["hide","top-left","top-right"]),colors:Pn.arrayOf(Pn.string),styles:Pn.object};UL.defaultProps={width:276,colors:["#FF6900","#FCB900","#7BDCB5","#00D084","#8ED1FC","#0693E3","#ABB8C3","#EB144C","#F78DA7","#9900EF"],triangle:"top-left",styles:{}};Ic(UL);var VL=function(e){var r=Di({default:{picker:{width:"20px",height:"20px",borderRadius:"22px",border:"2px #fff solid",transform:"translate(-12px, -13px)",background:"hsl("+Math.round(e.hsl.h)+", "+Math.round(e.hsl.s*100)+"%, "+Math.round(e.hsl.l*100)+"%)"}}});return ht.createElement("div",{style:r.picker})};VL.propTypes={hsl:Pn.shape({h:Pn.number,s:Pn.number,l:Pn.number,a:Pn.number})};VL.defaultProps={hsl:{a:1,h:249.94,l:.2,s:.5}};var $L=function(e){var r=Di({default:{picker:{width:"20px",height:"20px",borderRadius:"22px",transform:"translate(-10px, -7px)",background:"hsl("+Math.round(e.hsl.h)+", 100%, 50%)",border:"2px white solid"}}});return ht.createElement("div",{style:r.picker})};$L.propTypes={hsl:Pn.shape({h:Pn.number,s:Pn.number,l:Pn.number,a:Pn.number})};$L.defaultProps={hsl:{a:1,h:249.94,l:.2,s:.5}};var T5e=function(e){var r=e.onChange,n=e.rgb,i=e.hsl,a=e.hex,s=e.hsv,o=function(v,S){if(v.hex)fg(v.hex)&&r({hex:v.hex,source:"hex"},S);else if(v.rgb){var E=v.rgb.split(",");J4(v.rgb,"rgb")&&r({r:E[0],g:E[1],b:E[2],a:1,source:"rgb"},S)}else if(v.hsv){var P=v.hsv.split(",");J4(v.hsv,"hsv")&&(P[2]=P[2].replace("%",""),P[1]=P[1].replace("%",""),P[0]=P[0].replace("",""),P[1]==1?P[1]=.01:P[2]==1&&(P[2]=.01),r({h:Number(P[0]),s:Number(P[1]),v:Number(P[2]),source:"hsv"},S))}else if(v.hsl){var k=v.hsl.split(",");J4(v.hsl,"hsl")&&(k[2]=k[2].replace("%",""),k[1]=k[1].replace("%",""),k[0]=k[0].replace("",""),g[1]==1?g[1]=.01:g[2]==1&&(g[2]=.01),r({h:Number(k[0]),s:Number(k[1]),v:Number(k[2]),source:"hsl"},S))}},u=Di({default:{wrap:{display:"flex",height:"100px",marginTop:"4px"},fields:{width:"100%"},column:{paddingTop:"10px",display:"flex",justifyContent:"space-between"},double:{padding:"0px 4.4px",boxSizing:"border-box"},input:{width:"100%",height:"38px",boxSizing:"border-box",padding:"4px 10% 3px",textAlign:"center",border:"1px solid #dadce0",fontSize:"11px",textTransform:"lowercase",borderRadius:"5px",outline:"none",fontFamily:"Roboto,Arial,sans-serif"},input2:{height:"38px",width:"100%",border:"1px solid #dadce0",boxSizing:"border-box",fontSize:"11px",textTransform:"lowercase",borderRadius:"5px",outline:"none",paddingLeft:"10px",fontFamily:"Roboto,Arial,sans-serif"},label:{textAlign:"center",fontSize:"12px",background:"#fff",position:"absolute",textTransform:"uppercase",color:"#3c4043",width:"35px",top:"-6px",left:"0",right:"0",marginLeft:"auto",marginRight:"auto",fontFamily:"Roboto,Arial,sans-serif"},label2:{left:"10px",textAlign:"center",fontSize:"12px",background:"#fff",position:"absolute",textTransform:"uppercase",color:"#3c4043",width:"32px",top:"-6px",fontFamily:"Roboto,Arial,sans-serif"},single:{flexGrow:"1",margin:"0px 4.4px"}}}),h=n.r+", "+n.g+", "+n.b,f=Math.round(i.h)+", "+Math.round(i.s*100)+"%, "+Math.round(i.l*100)+"%",g=Math.round(s.h)+", "+Math.round(s.s*100)+"%, "+Math.round(s.v*100)+"%";return ht.createElement("div",{style:u.wrap,className:"flexbox-fix"},ht.createElement("div",{style:u.fields},ht.createElement("div",{style:u.double},ht.createElement(ga,{style:{input:u.input,label:u.label},label:"hex",value:a,onChange:o})),ht.createElement("div",{style:u.column},ht.createElement("div",{style:u.single},ht.createElement(ga,{style:{input:u.input2,label:u.label2},label:"rgb",value:h,onChange:o})),ht.createElement("div",{style:u.single},ht.createElement(ga,{style:{input:u.input2,label:u.label2},label:"hsv",value:g,onChange:o})),ht.createElement("div",{style:u.single},ht.createElement(ga,{style:{input:u.input2,label:u.label2},label:"hsl",value:f,onChange:o})))))},qL=function(e){var r=e.width,n=e.onChange,i=e.rgb,a=e.hsl,s=e.hsv,o=e.hex,u=e.header,h=e.styles,f=h===void 0?{}:h,g=e.className,b=g===void 0?"":g,v=Di(Ac({default:{picker:{width:r,background:"#fff",border:"1px solid #dfe1e5",boxSizing:"initial",display:"flex",flexWrap:"wrap",borderRadius:"8px 8px 0px 0px"},head:{height:"57px",width:"100%",paddingTop:"16px",paddingBottom:"16px",paddingLeft:"16px",fontSize:"20px",boxSizing:"border-box",fontFamily:"Roboto-Regular,HelveticaNeue,Arial,sans-serif"},saturation:{width:"70%",padding:"0px",position:"relative",overflow:"hidden"},swatch:{width:"30%",height:"228px",padding:"0px",background:"rgba("+i.r+", "+i.g+", "+i.b+", 1)",position:"relative",overflow:"hidden"},body:{margin:"auto",width:"95%"},controls:{display:"flex",boxSizing:"border-box",height:"52px",paddingTop:"22px"},color:{width:"32px"},hue:{height:"8px",position:"relative",margin:"0px 16px 0px 16px",width:"100%"},Hue:{radius:"2px"}}},f));return ht.createElement("div",{style:v.picker,className:"google-picker "+b},ht.createElement("div",{style:v.head},u),ht.createElement("div",{style:v.swatch}),ht.createElement("div",{style:v.saturation},ht.createElement(MT,{hsl:a,hsv:s,pointer:VL,onChange:n})),ht.createElement("div",{style:v.body},ht.createElement("div",{style:v.controls,className:"flexbox-fix"},ht.createElement("div",{style:v.hue},ht.createElement(U0,{style:v.Hue,hsl:a,radius:"4px",pointer:$L,onChange:n}))),ht.createElement(T5e,{rgb:i,hsl:a,hex:o,hsv:s,onChange:n})))};qL.propTypes={width:Pn.oneOfType([Pn.string,Pn.number]),styles:Pn.object,header:Pn.string};qL.defaultProps={width:652,styles:{},header:"Color picker"};Ic(qL);const l1={rgba:t=>`rgba(${t.rgb.r}, ${t.rgb.g}, ${t.rgb.b}, ${t.rgb.a})`,rgb:t=>`rgb(${t.rgb.r}, ${t.rgb.g}, ${t.rgb.b})`,hex:t=>t.hex,rgba_rgb:t=>t.rgb.a===1?l1.rgb(t):l1.rgba(t),rgba_hex:t=>t.rgb.a===1?l1.hex(t):l1.rgba(t)},pb=({convert:t,...e})=>{const[r,n]=ee.useState(!1),i=e?.value||"";return K.jsxs(K.Fragment,{children:[K.jsx(Dd,{container:!0,sx:{flexWrap:"nowrap"},children:K.jsx(Dd,{size:12,children:K.jsxs(Ji,{variant:"outlined",onClick:()=>n(!0),sx:{minWidth:"100%",padding:"5px",marginBottom:"10px",justifyContent:"flex-start",borderColor:a=>a.palette.text.primary,color:a=>a.palette.text.primary},children:[K.jsx("div",{style:{width:"25px",height:"25px",marginRight:"10px",backgroundColor:i}}),i]})})}),r&&K.jsx("div",{style:{position:"relative",marginTop:0},children:K.jsxs("div",{style:{position:"absolute",zIndex:1e3},children:[K.jsx("div",{style:{position:"fixed",top:"0px",right:"0px",bottom:"0px",left:"0px"},onClick:()=>{n(!1)}}),K.jsx(QAe,{color:i,onChange:a=>{const s=l1[t](a);e?.onChange?.(s)}})]})})]})};pb.defaultProps={convert:"rgba_hex",label:"Color",name:"color"};try{pb.displayName="ColorPicker",pb.__docgenInfo={description:"",displayName:"ColorPicker",props:{onChange:{defaultValue:null,description:"",name:"onChange",required:!1,type:{name:"((value: string) => void) | undefined"}},convert:{defaultValue:{value:"rgba_hex"},description:"",name:"convert",required:!1,type:{name:"enum",value:[{value:'"rgb"'},{value:'"rgba"'},{value:'"rgba_hex"'},{value:'"hex"'},{value:'"rgba_rgb"'}]}},value:{defaultValue:null,description:"",name:"value",required:!1,type:{name:"string | undefined"}}}}}catch{}function Uk({propKey:t,value:e,setPaintProps:r}){return K.jsx(pb,{value:e,label:"Color",onChange:n=>{r(i=>({...i,[t]:n}))}})}try{Uk.displayName="PaintPropsColorPicker",Uk.__docgenInfo={description:"",displayName:"PaintPropsColorPicker",props:{key:{defaultValue:null,description:"",name:"key",required:!0,type:{name:"string"}},value:{defaultValue:null,description:"",name:"value",required:!0,type:{name:"string"}},propKey:{defaultValue:null,description:"",name:"propKey",required:!0,type:{name:"string"}},setPaintProps:{defaultValue:null,description:"",name:"setPaintProps",required:!0,type:{name:"(paintProps: paintPropsType | ((current: paintPropsType) => paintPropsType)) => void"}}}}}catch{}const C5e=Pr(Th)({marginLeft:"-100px",marginRight:"-21px",paddingLeft:"53px",borderRadius:"0px",boxShadow:"none",backgroundColor:"rgb(0, 0, 0, 0)"}),A5e=Pr(Vo)({marginLeft:"61px"}),jK={"circle-color":"colorpicker","circle-radius":"slider","circle-stroke-color":"colorpicker","circle-stroke-width":"slider","fill-color":"colorpicker","fill-outline-color":"colorpicker","line-color":"colorpicker","line-width":"slider","line-blur":"slider"},I5e=Object.keys(jK),P5e={"circle-stroke-width":{step:1,min:1,max:20},"circle-radius":{step:1,min:1,max:100},"line-blur":{step:1,min:1,max:100},"line-width":{step:1,min:1,max:100}};function IS({paintProps:t={},setPaintProps:e}){const r=ee.useRef(Math.round(Math.random()*1e10)),n=ee.useCallback(i=>{if(I5e.indexOf(i)!==-1&&(typeof t[i]=="number"||typeof t[i]=="string")){const a=K.jsx(vs,{id:i+"_label",gutterBottom:!0,children:i});switch(jK[i]){case"slider":return K.jsxs(ht.Fragment,{children:[a,K.jsx(aO,{...P5e[i],value:t[i],valueLabelDisplay:"auto",onChange:(s,o)=>{o&&e(u=>({...u,[i]:o}))}})]},i);case"numberfield":return K.jsxs(ht.Fragment,{children:[a,K.jsx(nT,{inputProps:{inputMode:"decimal",pattern:"[0-9]*"},value:t[i],onChange:s=>{s?.target?.value&&e(o=>({...o,[i]:parseInt(s.target.value)}))}})]},i);case"colorpicker":return K.jsxs(ht.Fragment,{children:[a,K.jsx(Vo,{sx:{"& > div":{width:"initial !important"}},children:K.jsx(Uk,{value:t[i],propKey:i,setPaintProps:e},i)})]},i)}}return null},[t]);return K.jsx(K.Fragment,{children:K.jsx(C5e,{children:K.jsx(Ih,{children:K.jsx(A5e,{children:Object.keys(t).map(i=>n(i))})},r+"_paintPropForm")})})}try{IS.displayName="LayerPropertyForm",IS.__docgenInfo={description:"",displayName:"LayerPropertyForm",props:{paintProps:{defaultValue:{value:"{}"},description:"",name:"paintProps",required:!1,type:{name:"paintPropsType"}},setPaintProps:{defaultValue:null,description:"",name:"setPaintProps",required:!0,type:{name:"(paintProps: paintPropsType | ((current: paintPropsType) => paintPropsType)) => void"}},layerType:{defaultValue:null,description:"",name:"layerType",required:!0,type:{name:"string"}}}}}catch{}const PS=Pr(Ih)(t=>({paddingRight:t?"56px":0,paddingLeft:0,paddingTop:0,paddingBottom:"4px"})),k5e=Pr(eh)({padding:"4px",marginTop:"-3px"}),Rd=Pr(Q1)({minWidth:"30px"}),Od=Pr(i0)({padding:0});function kS({configurable:t,vtProps:e,setVtProps:r,id:n,...i}){const[a,s]=ee.useState(!1),[o,u]=ee.useState(!0),[h,f]=ee.useState(e.layers[n].paint);return ee.useEffect(()=>{if(!r||typeof e.layers[n]?.layout?.visibility>"u"&&o||!o&&e.layers[n]?.layout?.visibility==="none"||o&&e.layers[n]?.layout?.visibility==="visible")return;const g=[...e.layers];g[n].layout?g[n].layout.visibility=o?"visible":"none":g[n].layout={visibility:o?"visible":"none"},r({...e,layers:g})},[o,n,r,e]),ee.useEffect(()=>{u(!!i.visibleMaster)},[i.visibleMaster]),ee.useEffect(()=>{if(r&&JSON.stringify(h)!==JSON.stringify(e.layers[n].paint)){const g={...h},b=[...e.layers];b[n].paint=g,r({...e,layers:b})}},[h,n,r,e]),K.jsxs(K.Fragment,{children:[K.jsxs(PS,{secondaryAction:t?K.jsx(k5e,{edge:"end","aria-label":"comments",onClick:()=>{s(g=>!g)},children:K.jsx(tL,{})}):void 0,children:[K.jsx(Rd,{children:K.jsx(Od,{checked:o,onClick:()=>{u(g=>!g)}})}),K.jsx(yh,{primary:e.layers[n].id,variant:"layerlist"})]},n),t&&a&&K.jsx(IS,{paintProps:h,setPaintProps:f,layerType:e.layers[n].type})]})}kS.defaultProps={configurable:!0};try{PS.displayName="ListItemStyled",PS.__docgenInfo={description:"",displayName:"ListItemStyled",props:{}}}catch{}try{Rd.displayName="CheckboxListItemIcon",Rd.__docgenInfo={description:"",displayName:"CheckboxListItemIcon",props:{ref:{defaultValue:null,description:"",name:"ref",required:!1,type:{name:"Ref<unknown> | undefined"}}}}}catch{}try{Od.displayName="CheckboxStyled",Od.__docgenInfo={description:"",displayName:"CheckboxStyled",props:{component:{defaultValue:null,description:"",name:"component",required:!1,type:{name:"ElementType<any, keyof IntrinsicElements> | undefined"}},slots:{defaultValue:{value:"{}"},description:"The components used for each slot inside.",name:"slots",required:!1,type:{name:"Partial<CheckboxSlots> | undefined"}},slotProps:{defaultValue:{value:"{}"},description:"The props used for each slot inside.",name:"slotProps",required:!1,type:{name:"{ root?: SlotProps<ElementType<SwitchBaseProps, keyof IntrinsicElements>, CheckboxRootSlotPropsOverrides, CheckboxOwnerState> | undefined; input?: SlotProps<...> | undefined; } | undefined"}}}}}catch{}try{kS.displayName="LayerListItemVectorLayer",kS.__docgenInfo={description:"",displayName:"LayerListItemVectorLayer",props:{id:{defaultValue:null,description:"",name:"id",required:!0,type:{name:"string"}},configurable:{defaultValue:{value:"true"},description:"",name:"configurable",required:!1,type:{name:"boolean | undefined"}},vtProps:{defaultValue:null,description:"",name:"vtProps",required:!0,type:{name:"MlVectorTileLayerProps"}},setVtProps:{defaultValue:null,description:"",name:"setVtProps",required:!0,type:{name:"((state: unknown) => void) | undefined"}},visibleMaster:{defaultValue:null,description:"",name:"visibleMaster",required:!1,type:{name:"boolean | undefined"}}}}}catch{}function g0(t){return K.jsx(K.Fragment,{children:K.jsxs(JR,{open:t.open,onClose:t.onCancel,"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",children:[K.jsx(Bm,{id:"alert-dialog-title",children:t.title}),K.jsx(QR,{children:K.jsx(Sfe,{id:"alert-dialog-description",children:t.text})}),K.jsxs(Wb,{children:[K.jsx(Ji,{onClick:t.onCancel,children:"Cancel"}),K.jsx(Ji,{onClick:t.onConfirm,autoFocus:!0,children:"Confirm"})]})]})})}g0.defaultProps={title:"Confirm",text:"Are you sure?"};try{g0.displayName="ConfirmDialog",g0.__docgenInfo={description:"",displayName:"ConfirmDialog",props:{open:{defaultValue:null,description:"",name:"open",required:!0,type:{name:"boolean"}},title:{defaultValue:{value:"Confirm"},description:"",name:"title",required:!1,type:{name:"string"}},text:{defaultValue:{value:"Are you sure?"},description:"",name:"text",required:!1,type:{name:"string"}},onConfirm:{defaultValue:null,description:"",name:"onConfirm",required:!0,type:{name:"() => void"}},onCancel:{defaultValue:null,description:"",name:"onCancel",required:!0,type:{name:"() => void"}}}}}catch{}function M5e(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];return ee.useMemo(()=>n=>{e.forEach(i=>i(n))},e)}const LT=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function $0(t){const e=Object.prototype.toString.call(t);return e==="[object Window]"||e==="[object global]"}function HL(t){return"nodeType"in t}function Pc(t){var e,r;return t?$0(t)?t:HL(t)&&(e=(r=t.ownerDocument)==null?void 0:r.defaultView)!=null?e:window:window}function WL(t){const{Document:e}=Pc(t);return t instanceof e}function lx(t){return $0(t)?!1:t instanceof Pc(t).HTMLElement}function UK(t){return t instanceof Pc(t).SVGElement}function q0(t){return t?$0(t)?t.document:HL(t)?WL(t)?t:lx(t)||UK(t)?t.ownerDocument:document:document:document}const id=LT?ee.useLayoutEffect:ee.useEffect;function GL(t){const e=ee.useRef(t);return id(()=>{e.current=t}),ee.useCallback(function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return e.current==null?void 0:e.current(...n)},[])}function R5e(){const t=ee.useRef(null),e=ee.useCallback((n,i)=>{t.current=setInterval(n,i)},[]),r=ee.useCallback(()=>{t.current!==null&&(clearInterval(t.current),t.current=null)},[]);return[e,r]}function gb(t,e){e===void 0&&(e=[t]);const r=ee.useRef(t);return id(()=>{r.current!==t&&(r.current=t)},e),r}function ux(t,e){const r=ee.useRef();return ee.useMemo(()=>{const n=t(r.current);return r.current=n,n},[...e])}function MS(t){const e=GL(t),r=ee.useRef(null),n=ee.useCallback(i=>{i!==r.current&&e?.(i,r.current),r.current=i},[]);return[r,n]}function Vk(t){const e=ee.useRef();return ee.useEffect(()=>{e.current=t},[t]),e.current}let eI={};function cx(t,e){return ee.useMemo(()=>{if(e)return e;const r=eI[t]==null?0:eI[t]+1;return eI[t]=r,t+"-"+r},[t,e])}function VK(t){return function(e){for(var r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];return n.reduce((a,s)=>{const o=Object.entries(s);for(const[u,h]of o){const f=a[u];f!=null&&(a[u]=f+t*h)}return a},{...e})}}const Wv=VK(1),RS=VK(-1);function O5e(t){return"clientX"in t&&"clientY"in t}function XL(t){if(!t)return!1;const{KeyboardEvent:e}=Pc(t.target);return e&&t instanceof e}function L5e(t){if(!t)return!1;const{TouchEvent:e}=Pc(t.target);return e&&t instanceof e}function $k(t){if(L5e(t)){if(t.touches&&t.touches.length){const{clientX:e,clientY:r}=t.touches[0];return{x:e,y:r}}else if(t.changedTouches&&t.changedTouches.length){const{clientX:e,clientY:r}=t.changedTouches[0];return{x:e,y:r}}}return O5e(t)?{x:t.clientX,y:t.clientY}:null}const mb=Object.freeze({Translate:{toString(t){if(!t)return;const{x:e,y:r}=t;return"translate3d("+(e?Math.round(e):0)+"px, "+(r?Math.round(r):0)+"px, 0)"}},Scale:{toString(t){if(!t)return;const{scaleX:e,scaleY:r}=t;return"scaleX("+e+") scaleY("+r+")"}},Transform:{toString(t){if(t)return[mb.Translate.toString(t),mb.Scale.toString(t)].join(" ")}},Transition:{toString(t){let{property:e,duration:r,easing:n}=t;return e+" "+r+"ms "+n}}}),iV="a,frame,iframe,input:not([type=hidden]):not(:disabled),select:not(:disabled),textarea:not(:disabled),button:not(:disabled),*[tabindex]";function N5e(t){return t.matches(iV)?t:t.querySelector(iV)}const D5e={display:"none"};function F5e(t){let{id:e,value:r}=t;return ht.createElement("div",{id:e,style:D5e},r)}function B5e(t){let{id:e,announcement:r,ariaLiveType:n="assertive"}=t;const i={position:"fixed",top:0,left:0,width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0 0 0 0)",clipPath:"inset(100%)",whiteSpace:"nowrap"};return ht.createElement("div",{id:e,style:i,role:"status","aria-live":n,"aria-atomic":!0},r)}function z5e(){const[t,e]=ee.useState("");return{announce:ee.useCallback(n=>{n!=null&&e(n)},[]),announcement:t}}const $K=ee.createContext(null);function j5e(t){const e=ee.useContext($K);ee.useEffect(()=>{if(!e)throw new Error("useDndMonitor must be used within a children of <DndContext>");return e(t)},[t,e])}function U5e(){const[t]=ee.useState(()=>new Set),e=ee.useCallback(n=>(t.add(n),()=>t.delete(n)),[t]);return[ee.useCallback(n=>{let{type:i,event:a}=n;t.forEach(s=>{var o;return(o=s[i])==null?void 0:o.call(s,a)})},[t]),e]}const V5e={draggable:`
    To pick up a draggable item, press the space bar.
    While dragging, use the arrow keys to move the item.
    Press space again to drop the item in its new position, or press escape to cancel.
  `},$5e={onDragStart(t){let{active:e}=t;return"Picked up draggable item "+e.id+"."},onDragOver(t){let{active:e,over:r}=t;return r?"Draggable item "+e.id+" was moved over droppable area "+r.id+".":"Draggable item "+e.id+" is no longer over a droppable area."},onDragEnd(t){let{active:e,over:r}=t;return r?"Draggable item "+e.id+" was dropped over droppable area "+r.id:"Draggable item "+e.id+" was dropped."},onDragCancel(t){let{active:e}=t;return"Dragging was cancelled. Draggable item "+e.id+" was dropped."}};function q5e(t){let{announcements:e=$5e,container:r,hiddenTextDescribedById:n,screenReaderInstructions:i=V5e}=t;const{announce:a,announcement:s}=z5e(),o=cx("DndLiveRegion"),[u,h]=ee.useState(!1);if(ee.useEffect(()=>{h(!0)},[]),j5e(ee.useMemo(()=>({onDragStart(g){let{active:b}=g;a(e.onDragStart({active:b}))},onDragMove(g){let{active:b,over:v}=g;e.onDragMove&&a(e.onDragMove({active:b,over:v}))},onDragOver(g){let{active:b,over:v}=g;a(e.onDragOver({active:b,over:v}))},onDragEnd(g){let{active:b,over:v}=g;a(e.onDragEnd({active:b,over:v}))},onDragCancel(g){let{active:b,over:v}=g;a(e.onDragCancel({active:b,over:v}))}}),[a,e])),!u)return null;const f=ht.createElement(ht.Fragment,null,ht.createElement(F5e,{id:n,value:i.draggable}),ht.createElement(B5e,{id:o,announcement:s}));return r?Nd.createPortal(f,r):f}var Ml;(function(t){t.DragStart="dragStart",t.DragMove="dragMove",t.DragEnd="dragEnd",t.DragCancel="dragCancel",t.DragOver="dragOver",t.RegisterDroppable="registerDroppable",t.SetDroppableDisabled="setDroppableDisabled",t.UnregisterDroppable="unregisterDroppable"})(Ml||(Ml={}));function OS(){}function aV(t,e){return ee.useMemo(()=>({sensor:t,options:e??{}}),[t,e])}function H5e(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];return ee.useMemo(()=>[...e].filter(n=>n!=null),[...e])}const uf=Object.freeze({x:0,y:0});function W5e(t,e){return Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))}function G5e(t,e){let{data:{value:r}}=t,{data:{value:n}}=e;return r-n}function X5e(t,e){let{data:{value:r}}=t,{data:{value:n}}=e;return n-r}function Y5e(t,e){if(!t||t.length===0)return null;const[r]=t;return r[e]}function oV(t,e,r){return e===void 0&&(e=t.left),r===void 0&&(r=t.top),{x:e+t.width*.5,y:r+t.height*.5}}const Z5e=t=>{let{collisionRect:e,droppableRects:r,droppableContainers:n}=t;const i=oV(e,e.left,e.top),a=[];for(const s of n){const{id:o}=s,u=r.get(o);if(u){const h=W5e(oV(u),i);a.push({id:o,data:{droppableContainer:s,value:h}})}}return a.sort(G5e)};function K5e(t,e){const r=Math.max(e.top,t.top),n=Math.max(e.left,t.left),i=Math.min(e.left+e.width,t.left+t.width),a=Math.min(e.top+e.height,t.top+t.height),s=i-n,o=a-r;if(n<i&&r<a){const u=e.width*e.height,h=t.width*t.height,f=s*o,g=f/(u+h-f);return Number(g.toFixed(4))}return 0}const J5e=t=>{let{collisionRect:e,droppableRects:r,droppableContainers:n}=t;const i=[];for(const a of n){const{id:s}=a,o=r.get(s);if(o){const u=K5e(o,e);u>0&&i.push({id:s,data:{droppableContainer:a,value:u}})}}return i.sort(X5e)};function Q5e(t,e,r){return{...t,scaleX:e&&r?e.width/r.width:1,scaleY:e&&r?e.height/r.height:1}}function qK(t,e){return t&&e?{x:t.left-e.left,y:t.top-e.top}:uf}function e4e(t){return function(r){for(var n=arguments.length,i=new Array(n>1?n-1:0),a=1;a<n;a++)i[a-1]=arguments[a];return i.reduce((s,o)=>({...s,top:s.top+t*o.y,bottom:s.bottom+t*o.y,left:s.left+t*o.x,right:s.right+t*o.x}),{...r})}}const t4e=e4e(1);function r4e(t){if(t.startsWith("matrix3d(")){const e=t.slice(9,-1).split(/, /);return{x:+e[12],y:+e[13],scaleX:+e[0],scaleY:+e[5]}}else if(t.startsWith("matrix(")){const e=t.slice(7,-1).split(/, /);return{x:+e[4],y:+e[5],scaleX:+e[0],scaleY:+e[3]}}return null}function n4e(t,e,r){const n=r4e(e);if(!n)return t;const{scaleX:i,scaleY:a,x:s,y:o}=n,u=t.left-s-(1-i)*parseFloat(r),h=t.top-o-(1-a)*parseFloat(r.slice(r.indexOf(" ")+1)),f=i?t.width/i:t.width,g=a?t.height/a:t.height;return{width:f,height:g,top:h,right:u+f,bottom:h+g,left:u}}const i4e={ignoreTransform:!1};function H0(t,e){e===void 0&&(e=i4e);let r=t.getBoundingClientRect();if(e.ignoreTransform){const{transform:h,transformOrigin:f}=Pc(t).getComputedStyle(t);h&&(r=n4e(r,h,f))}const{top:n,left:i,width:a,height:s,bottom:o,right:u}=r;return{top:n,left:i,width:a,height:s,bottom:o,right:u}}function sV(t){return H0(t,{ignoreTransform:!0})}function a4e(t){const e=t.innerWidth,r=t.innerHeight;return{top:0,left:0,right:e,bottom:r,width:e,height:r}}function o4e(t,e){return e===void 0&&(e=Pc(t).getComputedStyle(t)),e.position==="fixed"}function s4e(t,e){e===void 0&&(e=Pc(t).getComputedStyle(t));const r=/(auto|scroll|overlay)/;return["overflow","overflowX","overflowY"].some(i=>{const a=e[i];return typeof a=="string"?r.test(a):!1})}function YL(t,e){const r=[];function n(i){if(e!=null&&r.length>=e||!i)return r;if(WL(i)&&i.scrollingElement!=null&&!r.includes(i.scrollingElement))return r.push(i.scrollingElement),r;if(!lx(i)||UK(i)||r.includes(i))return r;const a=Pc(t).getComputedStyle(i);return i!==t&&s4e(i,a)&&r.push(i),o4e(i,a)?r:n(i.parentNode)}return t?n(t):r}function HK(t){const[e]=YL(t,1);return e??null}function tI(t){return!LT||!t?null:$0(t)?t:HL(t)?WL(t)||t===q0(t).scrollingElement?window:lx(t)?t:null:null}function WK(t){return $0(t)?t.scrollX:t.scrollLeft}function GK(t){return $0(t)?t.scrollY:t.scrollTop}function qk(t){return{x:WK(t),y:GK(t)}}var Kl;(function(t){t[t.Forward=1]="Forward",t[t.Backward=-1]="Backward"})(Kl||(Kl={}));function XK(t){return!LT||!t?!1:t===document.scrollingElement}function YK(t){const e={x:0,y:0},r=XK(t)?{height:window.innerHeight,width:window.innerWidth}:{height:t.clientHeight,width:t.clientWidth},n={x:t.scrollWidth-r.width,y:t.scrollHeight-r.height},i=t.scrollTop<=e.y,a=t.scrollLeft<=e.x,s=t.scrollTop>=n.y,o=t.scrollLeft>=n.x;return{isTop:i,isLeft:a,isBottom:s,isRight:o,maxScroll:n,minScroll:e}}const l4e={x:.2,y:.2};function u4e(t,e,r,n,i){let{top:a,left:s,right:o,bottom:u}=r;n===void 0&&(n=10),i===void 0&&(i=l4e);const{isTop:h,isBottom:f,isLeft:g,isRight:b}=YK(t),v={x:0,y:0},S={x:0,y:0},E={height:e.height*i.y,width:e.width*i.x};return!h&&a<=e.top+E.height?(v.y=Kl.Backward,S.y=n*Math.abs((e.top+E.height-a)/E.height)):!f&&u>=e.bottom-E.height&&(v.y=Kl.Forward,S.y=n*Math.abs((e.bottom-E.height-u)/E.height)),!b&&o>=e.right-E.width?(v.x=Kl.Forward,S.x=n*Math.abs((e.right-E.width-o)/E.width)):!g&&s<=e.left+E.width&&(v.x=Kl.Backward,S.x=n*Math.abs((e.left+E.width-s)/E.width)),{direction:v,speed:S}}function c4e(t){if(t===document.scrollingElement){const{innerWidth:a,innerHeight:s}=window;return{top:0,left:0,right:a,bottom:s,width:a,height:s}}const{top:e,left:r,right:n,bottom:i}=t.getBoundingClientRect();return{top:e,left:r,right:n,bottom:i,width:t.clientWidth,height:t.clientHeight}}function ZK(t){return t.reduce((e,r)=>Wv(e,qk(r)),uf)}function h4e(t){return t.reduce((e,r)=>e+WK(r),0)}function f4e(t){return t.reduce((e,r)=>e+GK(r),0)}function d4e(t,e){if(e===void 0&&(e=H0),!t)return;const{top:r,left:n,bottom:i,right:a}=e(t);HK(t)&&(i<=0||a<=0||r>=window.innerHeight||n>=window.innerWidth)&&t.scrollIntoView({block:"center",inline:"center"})}const p4e=[["x",["left","right"],h4e],["y",["top","bottom"],f4e]];class ZL{constructor(e,r){this.rect=void 0,this.width=void 0,this.height=void 0,this.top=void 0,this.bottom=void 0,this.right=void 0,this.left=void 0;const n=YL(r),i=ZK(n);this.rect={...e},this.width=e.width,this.height=e.height;for(const[a,s,o]of p4e)for(const u of s)Object.defineProperty(this,u,{get:()=>{const h=o(n),f=i[a]-h;return this.rect[u]+f},enumerable:!0});Object.defineProperty(this,"rect",{enumerable:!1})}}class O1{constructor(e){this.target=void 0,this.listeners=[],this.removeAll=()=>{this.listeners.forEach(r=>{var n;return(n=this.target)==null?void 0:n.removeEventListener(...r)})},this.target=e}add(e,r,n){var i;(i=this.target)==null||i.addEventListener(e,r,n),this.listeners.push([e,r,n])}}function g4e(t){const{EventTarget:e}=Pc(t);return t instanceof e?t:q0(t)}function rI(t,e){const r=Math.abs(t.x),n=Math.abs(t.y);return typeof e=="number"?Math.sqrt(r**2+n**2)>e:"x"in e&&"y"in e?r>e.x&&n>e.y:"x"in e?r>e.x:"y"in e?n>e.y:!1}var gh;(function(t){t.Click="click",t.DragStart="dragstart",t.Keydown="keydown",t.ContextMenu="contextmenu",t.Resize="resize",t.SelectionChange="selectionchange",t.VisibilityChange="visibilitychange"})(gh||(gh={}));function lV(t){t.preventDefault()}function m4e(t){t.stopPropagation()}var $a;(function(t){t.Space="Space",t.Down="ArrowDown",t.Right="ArrowRight",t.Left="ArrowLeft",t.Up="ArrowUp",t.Esc="Escape",t.Enter="Enter",t.Tab="Tab"})($a||($a={}));const KK={start:[$a.Space,$a.Enter],cancel:[$a.Esc],end:[$a.Space,$a.Enter,$a.Tab]},y4e=(t,e)=>{let{currentCoordinates:r}=e;switch(t.code){case $a.Right:return{...r,x:r.x+25};case $a.Left:return{...r,x:r.x-25};case $a.Down:return{...r,y:r.y+25};case $a.Up:return{...r,y:r.y-25}}};class JK{constructor(e){this.props=void 0,this.autoScrollEnabled=!1,this.referenceCoordinates=void 0,this.listeners=void 0,this.windowListeners=void 0,this.props=e;const{event:{target:r}}=e;this.props=e,this.listeners=new O1(q0(r)),this.windowListeners=new O1(Pc(r)),this.handleKeyDown=this.handleKeyDown.bind(this),this.handleCancel=this.handleCancel.bind(this),this.attach()}attach(){this.handleStart(),this.windowListeners.add(gh.Resize,this.handleCancel),this.windowListeners.add(gh.VisibilityChange,this.handleCancel),setTimeout(()=>this.listeners.add(gh.Keydown,this.handleKeyDown))}handleStart(){const{activeNode:e,onStart:r}=this.props,n=e.node.current;n&&d4e(n),r(uf)}handleKeyDown(e){if(XL(e)){const{active:r,context:n,options:i}=this.props,{keyboardCodes:a=KK,coordinateGetter:s=y4e,scrollBehavior:o="smooth"}=i,{code:u}=e;if(a.end.includes(u)){this.handleEnd(e);return}if(a.cancel.includes(u)){this.handleCancel(e);return}const{collisionRect:h}=n.current,f=h?{x:h.left,y:h.top}:uf;this.referenceCoordinates||(this.referenceCoordinates=f);const g=s(e,{active:r,context:n.current,currentCoordinates:f});if(g){const b=RS(g,f),v={x:0,y:0},{scrollableAncestors:S}=n.current;for(const E of S){const P=e.code,{isTop:k,isRight:L,isLeft:O,isBottom:M,maxScroll:z,minScroll:B}=YK(E),q=c4e(E),W={x:Math.min(P===$a.Right?q.right-q.width/2:q.right,Math.max(P===$a.Right?q.left:q.left+q.width/2,g.x)),y:Math.min(P===$a.Down?q.bottom-q.height/2:q.bottom,Math.max(P===$a.Down?q.top:q.top+q.height/2,g.y))},G=P===$a.Right&&!L||P===$a.Left&&!O,ie=P===$a.Down&&!M||P===$a.Up&&!k;if(G&&W.x!==g.x){const Q=E.scrollLeft+b.x,H=P===$a.Right&&Q<=z.x||P===$a.Left&&Q>=B.x;if(H&&!b.y){E.scrollTo({left:Q,behavior:o});return}H?v.x=E.scrollLeft-Q:v.x=P===$a.Right?E.scrollLeft-z.x:E.scrollLeft-B.x,v.x&&E.scrollBy({left:-v.x,behavior:o});break}else if(ie&&W.y!==g.y){const Q=E.scrollTop+b.y,H=P===$a.Down&&Q<=z.y||P===$a.Up&&Q>=B.y;if(H&&!b.x){E.scrollTo({top:Q,behavior:o});return}H?v.y=E.scrollTop-Q:v.y=P===$a.Down?E.scrollTop-z.y:E.scrollTop-B.y,v.y&&E.scrollBy({top:-v.y,behavior:o});break}}this.handleMove(e,Wv(RS(g,this.referenceCoordinates),v))}}}handleMove(e,r){const{onMove:n}=this.props;e.preventDefault(),n(r)}handleEnd(e){const{onEnd:r}=this.props;e.preventDefault(),this.detach(),r()}handleCancel(e){const{onCancel:r}=this.props;e.preventDefault(),this.detach(),r()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll()}}JK.activators=[{eventName:"onKeyDown",handler:(t,e,r)=>{let{keyboardCodes:n=KK,onActivation:i}=e,{active:a}=r;const{code:s}=t.nativeEvent;if(n.start.includes(s)){const o=a.activatorNode.current;return o&&t.target!==o?!1:(t.preventDefault(),i?.({event:t.nativeEvent}),!0)}return!1}}];function uV(t){return!!(t&&"distance"in t)}function cV(t){return!!(t&&"delay"in t)}class KL{constructor(e,r,n){var i;n===void 0&&(n=g4e(e.event.target)),this.props=void 0,this.events=void 0,this.autoScrollEnabled=!0,this.document=void 0,this.activated=!1,this.initialCoordinates=void 0,this.timeoutId=null,this.listeners=void 0,this.documentListeners=void 0,this.windowListeners=void 0,this.props=e,this.events=r;const{event:a}=e,{target:s}=a;this.props=e,this.events=r,this.document=q0(s),this.documentListeners=new O1(this.document),this.listeners=new O1(n),this.windowListeners=new O1(Pc(s)),this.initialCoordinates=(i=$k(a))!=null?i:uf,this.handleStart=this.handleStart.bind(this),this.handleMove=this.handleMove.bind(this),this.handleEnd=this.handleEnd.bind(this),this.handleCancel=this.handleCancel.bind(this),this.handleKeydown=this.handleKeydown.bind(this),this.removeTextSelection=this.removeTextSelection.bind(this),this.attach()}attach(){const{events:e,props:{options:{activationConstraint:r,bypassActivationConstraint:n}}}=this;if(this.listeners.add(e.move.name,this.handleMove,{passive:!1}),this.listeners.add(e.end.name,this.handleEnd),e.cancel&&this.listeners.add(e.cancel.name,this.handleCancel),this.windowListeners.add(gh.Resize,this.handleCancel),this.windowListeners.add(gh.DragStart,lV),this.windowListeners.add(gh.VisibilityChange,this.handleCancel),this.windowListeners.add(gh.ContextMenu,lV),this.documentListeners.add(gh.Keydown,this.handleKeydown),r){if(n!=null&&n({event:this.props.event,activeNode:this.props.activeNode,options:this.props.options}))return this.handleStart();if(cV(r)){this.timeoutId=setTimeout(this.handleStart,r.delay),this.handlePending(r);return}if(uV(r)){this.handlePending(r);return}}this.handleStart()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll(),setTimeout(this.documentListeners.removeAll,50),this.timeoutId!==null&&(clearTimeout(this.timeoutId),this.timeoutId=null)}handlePending(e,r){const{active:n,onPending:i}=this.props;i(n,e,this.initialCoordinates,r)}handleStart(){const{initialCoordinates:e}=this,{onStart:r}=this.props;e&&(this.activated=!0,this.documentListeners.add(gh.Click,m4e,{capture:!0}),this.removeTextSelection(),this.documentListeners.add(gh.SelectionChange,this.removeTextSelection),r(e))}handleMove(e){var r;const{activated:n,initialCoordinates:i,props:a}=this,{onMove:s,options:{activationConstraint:o}}=a;if(!i)return;const u=(r=$k(e))!=null?r:uf,h=RS(i,u);if(!n&&o){if(uV(o)){if(o.tolerance!=null&&rI(h,o.tolerance))return this.handleCancel();if(rI(h,o.distance))return this.handleStart()}if(cV(o)&&rI(h,o.tolerance))return this.handleCancel();this.handlePending(o,h);return}e.cancelable&&e.preventDefault(),s(u)}handleEnd(){const{onAbort:e,onEnd:r}=this.props;this.detach(),this.activated||e(this.props.active),r()}handleCancel(){const{onAbort:e,onCancel:r}=this.props;this.detach(),this.activated||e(this.props.active),r()}handleKeydown(e){e.code===$a.Esc&&this.handleCancel()}removeTextSelection(){var e;(e=this.document.getSelection())==null||e.removeAllRanges()}}const v4e={cancel:{name:"pointercancel"},move:{name:"pointermove"},end:{name:"pointerup"}};class JL extends KL{constructor(e){const{event:r}=e,n=q0(r.target);super(e,v4e,n)}}JL.activators=[{eventName:"onPointerDown",handler:(t,e)=>{let{nativeEvent:r}=t,{onActivation:n}=e;return!r.isPrimary||r.button!==0?!1:(n?.({event:r}),!0)}}];const _4e={move:{name:"mousemove"},end:{name:"mouseup"}};var Hk;(function(t){t[t.RightClick=2]="RightClick"})(Hk||(Hk={}));class QK extends KL{constructor(e){super(e,_4e,q0(e.event.target))}}QK.activators=[{eventName:"onMouseDown",handler:(t,e)=>{let{nativeEvent:r}=t,{onActivation:n}=e;return r.button===Hk.RightClick?!1:(n?.({event:r}),!0)}}];const nI={cancel:{name:"touchcancel"},move:{name:"touchmove"},end:{name:"touchend"}};class b4e extends KL{constructor(e){super(e,nI)}static setup(){return window.addEventListener(nI.move.name,e,{capture:!1,passive:!1}),function(){window.removeEventListener(nI.move.name,e)};function e(){}}}b4e.activators=[{eventName:"onTouchStart",handler:(t,e)=>{let{nativeEvent:r}=t,{onActivation:n}=e;const{touches:i}=r;return i.length>1?!1:(n?.({event:r}),!0)}}];var L1;(function(t){t[t.Pointer=0]="Pointer",t[t.DraggableRect=1]="DraggableRect"})(L1||(L1={}));var LS;(function(t){t[t.TreeOrder=0]="TreeOrder",t[t.ReversedTreeOrder=1]="ReversedTreeOrder"})(LS||(LS={}));function x4e(t){let{acceleration:e,activator:r=L1.Pointer,canScroll:n,draggingRect:i,enabled:a,interval:s=5,order:o=LS.TreeOrder,pointerCoordinates:u,scrollableAncestors:h,scrollableAncestorRects:f,delta:g,threshold:b}=t;const v=S4e({delta:g,disabled:!a}),[S,E]=R5e(),P=ee.useRef({x:0,y:0}),k=ee.useRef({x:0,y:0}),L=ee.useMemo(()=>{switch(r){case L1.Pointer:return u?{top:u.y,bottom:u.y,left:u.x,right:u.x}:null;case L1.DraggableRect:return i}},[r,i,u]),O=ee.useRef(null),M=ee.useCallback(()=>{const B=O.current;if(!B)return;const q=P.current.x*k.current.x,W=P.current.y*k.current.y;B.scrollBy(q,W)},[]),z=ee.useMemo(()=>o===LS.TreeOrder?[...h].reverse():h,[o,h]);ee.useEffect(()=>{if(!a||!h.length||!L){E();return}for(const B of z){if(n?.(B)===!1)continue;const q=h.indexOf(B),W=f[q];if(!W)continue;const{direction:G,speed:ie}=u4e(B,W,L,e,b);for(const Q of["x","y"])v[Q][G[Q]]||(ie[Q]=0,G[Q]=0);if(ie.x>0||ie.y>0){E(),O.current=B,S(M,s),P.current=ie,k.current=G;return}}P.current={x:0,y:0},k.current={x:0,y:0},E()},[e,M,n,E,a,s,JSON.stringify(L),JSON.stringify(v),S,h,z,f,JSON.stringify(b)])}const w4e={x:{[Kl.Backward]:!1,[Kl.Forward]:!1},y:{[Kl.Backward]:!1,[Kl.Forward]:!1}};function S4e(t){let{delta:e,disabled:r}=t;const n=Vk(e);return ux(i=>{if(r||!n||!i)return w4e;const a={x:Math.sign(e.x-n.x),y:Math.sign(e.y-n.y)};return{x:{[Kl.Backward]:i.x[Kl.Backward]||a.x===-1,[Kl.Forward]:i.x[Kl.Forward]||a.x===1},y:{[Kl.Backward]:i.y[Kl.Backward]||a.y===-1,[Kl.Forward]:i.y[Kl.Forward]||a.y===1}}},[r,e,n])}function E4e(t,e){const r=e!=null?t.get(e):void 0,n=r?r.node.current:null;return ux(i=>{var a;return e==null?null:(a=n??i)!=null?a:null},[n,e])}function T4e(t,e){return ee.useMemo(()=>t.reduce((r,n)=>{const{sensor:i}=n,a=i.activators.map(s=>({eventName:s.eventName,handler:e(s.handler,n)}));return[...r,...a]},[]),[t,e])}var yb;(function(t){t[t.Always=0]="Always",t[t.BeforeDragging=1]="BeforeDragging",t[t.WhileDragging=2]="WhileDragging"})(yb||(yb={}));var Wk;(function(t){t.Optimized="optimized"})(Wk||(Wk={}));const hV=new Map;function C4e(t,e){let{dragging:r,dependencies:n,config:i}=e;const[a,s]=ee.useState(null),{frequency:o,measure:u,strategy:h}=i,f=ee.useRef(t),g=P(),b=gb(g),v=ee.useCallback(function(k){k===void 0&&(k=[]),!b.current&&s(L=>L===null?k:L.concat(k.filter(O=>!L.includes(O))))},[b]),S=ee.useRef(null),E=ux(k=>{if(g&&!r)return hV;if(!k||k===hV||f.current!==t||a!=null){const L=new Map;for(let O of t){if(!O)continue;if(a&&a.length>0&&!a.includes(O.id)&&O.rect.current){L.set(O.id,O.rect.current);continue}const M=O.node.current,z=M?new ZL(u(M),M):null;O.rect.current=z,z&&L.set(O.id,z)}return L}return k},[t,a,r,g,u]);return ee.useEffect(()=>{f.current=t},[t]),ee.useEffect(()=>{g||v()},[r,g]),ee.useEffect(()=>{a&&a.length>0&&s(null)},[JSON.stringify(a)]),ee.useEffect(()=>{g||typeof o!="number"||S.current!==null||(S.current=setTimeout(()=>{v(),S.current=null},o))},[o,g,v,...n]),{droppableRects:E,measureDroppableContainers:v,measuringScheduled:a!=null};function P(){switch(h){case yb.Always:return!1;case yb.BeforeDragging:return r;default:return!r}}}function eJ(t,e){return ux(r=>t?r||(typeof e=="function"?e(t):t):null,[e,t])}function A4e(t,e){return eJ(t,e)}function I4e(t){let{callback:e,disabled:r}=t;const n=GL(e),i=ee.useMemo(()=>{if(r||typeof window>"u"||typeof window.MutationObserver>"u")return;const{MutationObserver:a}=window;return new a(n)},[n,r]);return ee.useEffect(()=>()=>i?.disconnect(),[i]),i}function NT(t){let{callback:e,disabled:r}=t;const n=GL(e),i=ee.useMemo(()=>{if(r||typeof window>"u"||typeof window.ResizeObserver>"u")return;const{ResizeObserver:a}=window;return new a(n)},[r]);return ee.useEffect(()=>()=>i?.disconnect(),[i]),i}function P4e(t){return new ZL(H0(t),t)}function fV(t,e,r){e===void 0&&(e=P4e);const[n,i]=ee.useState(null);function a(){i(u=>{if(!t)return null;if(t.isConnected===!1){var h;return(h=u??r)!=null?h:null}const f=e(t);return JSON.stringify(u)===JSON.stringify(f)?u:f})}const s=I4e({callback(u){if(t)for(const h of u){const{type:f,target:g}=h;if(f==="childList"&&g instanceof HTMLElement&&g.contains(t)){a();break}}}}),o=NT({callback:a});return id(()=>{a(),t?(o?.observe(t),s?.observe(document.body,{childList:!0,subtree:!0})):(o?.disconnect(),s?.disconnect())},[t]),n}function k4e(t){const e=eJ(t);return qK(t,e)}const dV=[];function M4e(t){const e=ee.useRef(t),r=ux(n=>t?n&&n!==dV&&t&&e.current&&t.parentNode===e.current.parentNode?n:YL(t):dV,[t]);return ee.useEffect(()=>{e.current=t},[t]),r}function R4e(t){const[e,r]=ee.useState(null),n=ee.useRef(t),i=ee.useCallback(a=>{const s=tI(a.target);s&&r(o=>o?(o.set(s,qk(s)),new Map(o)):null)},[]);return ee.useEffect(()=>{const a=n.current;if(t!==a){s(a);const o=t.map(u=>{const h=tI(u);return h?(h.addEventListener("scroll",i,{passive:!0}),[h,qk(h)]):null}).filter(u=>u!=null);r(o.length?new Map(o):null),n.current=t}return()=>{s(t),s(a)};function s(o){o.forEach(u=>{const h=tI(u);h?.removeEventListener("scroll",i)})}},[i,t]),ee.useMemo(()=>t.length?e?Array.from(e.values()).reduce((a,s)=>Wv(a,s),uf):ZK(t):uf,[t,e])}function pV(t,e){e===void 0&&(e=[]);const r=ee.useRef(null);return ee.useEffect(()=>{r.current=null},e),ee.useEffect(()=>{const n=t!==uf;n&&!r.current&&(r.current=t),!n&&r.current&&(r.current=null)},[t]),r.current?RS(t,r.current):uf}function O4e(t){ee.useEffect(()=>{if(!LT)return;const e=t.map(r=>{let{sensor:n}=r;return n.setup==null?void 0:n.setup()});return()=>{for(const r of e)r?.()}},t.map(e=>{let{sensor:r}=e;return r}))}function L4e(t,e){return ee.useMemo(()=>t.reduce((r,n)=>{let{eventName:i,handler:a}=n;return r[i]=s=>{a(s,e)},r},{}),[t,e])}function tJ(t){return ee.useMemo(()=>t?a4e(t):null,[t])}const gV=[];function N4e(t,e){e===void 0&&(e=H0);const[r]=t,n=tJ(r?Pc(r):null),[i,a]=ee.useState(gV);function s(){a(()=>t.length?t.map(u=>XK(u)?n:new ZL(e(u),u)):gV)}const o=NT({callback:s});return id(()=>{o?.disconnect(),s(),t.forEach(u=>o?.observe(u))},[t]),i}function D4e(t){if(!t)return null;if(t.children.length>1)return t;const e=t.children[0];return lx(e)?e:t}function F4e(t){let{measure:e}=t;const[r,n]=ee.useState(null),i=ee.useCallback(h=>{for(const{target:f}of h)if(lx(f)){n(g=>{const b=e(f);return g?{...g,width:b.width,height:b.height}:b});break}},[e]),a=NT({callback:i}),s=ee.useCallback(h=>{const f=D4e(h);a?.disconnect(),f&&a?.observe(f),n(f?e(f):null)},[e,a]),[o,u]=MS(s);return ee.useMemo(()=>({nodeRef:o,rect:r,setRef:u}),[r,o,u])}const B4e=[{sensor:JL,options:{}},{sensor:JK,options:{}}],z4e={current:{}},Sw={draggable:{measure:sV},droppable:{measure:sV,strategy:yb.WhileDragging,frequency:Wk.Optimized},dragOverlay:{measure:H0}};class N1 extends Map{get(e){var r;return e!=null&&(r=super.get(e))!=null?r:void 0}toArray(){return Array.from(this.values())}getEnabled(){return this.toArray().filter(e=>{let{disabled:r}=e;return!r})}getNodeFor(e){var r,n;return(r=(n=this.get(e))==null?void 0:n.node.current)!=null?r:void 0}}const j4e={activatorEvent:null,active:null,activeNode:null,activeNodeRect:null,collisions:null,containerNodeRect:null,draggableNodes:new Map,droppableRects:new Map,droppableContainers:new N1,over:null,dragOverlay:{nodeRef:{current:null},rect:null,setRef:OS},scrollableAncestors:[],scrollableAncestorRects:[],measuringConfiguration:Sw,measureDroppableContainers:OS,windowRect:null,measuringScheduled:!1},U4e={activatorEvent:null,activators:[],active:null,activeNodeRect:null,ariaDescribedById:{draggable:""},dispatch:OS,draggableNodes:new Map,over:null,measureDroppableContainers:OS},DT=ee.createContext(U4e),rJ=ee.createContext(j4e);function V4e(){return{draggable:{active:null,initialCoordinates:{x:0,y:0},nodes:new Map,translate:{x:0,y:0}},droppable:{containers:new N1}}}function $4e(t,e){switch(e.type){case Ml.DragStart:return{...t,draggable:{...t.draggable,initialCoordinates:e.initialCoordinates,active:e.active}};case Ml.DragMove:return t.draggable.active==null?t:{...t,draggable:{...t.draggable,translate:{x:e.coordinates.x-t.draggable.initialCoordinates.x,y:e.coordinates.y-t.draggable.initialCoordinates.y}}};case Ml.DragEnd:case Ml.DragCancel:return{...t,draggable:{...t.draggable,active:null,initialCoordinates:{x:0,y:0},translate:{x:0,y:0}}};case Ml.RegisterDroppable:{const{element:r}=e,{id:n}=r,i=new N1(t.droppable.containers);return i.set(n,r),{...t,droppable:{...t.droppable,containers:i}}}case Ml.SetDroppableDisabled:{const{id:r,key:n,disabled:i}=e,a=t.droppable.containers.get(r);if(!a||n!==a.key)return t;const s=new N1(t.droppable.containers);return s.set(r,{...a,disabled:i}),{...t,droppable:{...t.droppable,containers:s}}}case Ml.UnregisterDroppable:{const{id:r,key:n}=e,i=t.droppable.containers.get(r);if(!i||n!==i.key)return t;const a=new N1(t.droppable.containers);return a.delete(r),{...t,droppable:{...t.droppable,containers:a}}}default:return t}}function q4e(t){let{disabled:e}=t;const{active:r,activatorEvent:n,draggableNodes:i}=ee.useContext(DT),a=Vk(n),s=Vk(r?.id);return ee.useEffect(()=>{if(!e&&!n&&a&&s!=null){if(!XL(a)||document.activeElement===a.target)return;const o=i.get(s);if(!o)return;const{activatorNode:u,node:h}=o;if(!u.current&&!h.current)return;requestAnimationFrame(()=>{for(const f of[u.current,h.current]){if(!f)continue;const g=N5e(f);if(g){g.focus();break}}})}},[n,e,i,s,a]),null}function H4e(t,e){let{transform:r,...n}=e;return t!=null&&t.length?t.reduce((i,a)=>a({transform:i,...n}),r):r}function W4e(t){return ee.useMemo(()=>({draggable:{...Sw.draggable,...t?.draggable},droppable:{...Sw.droppable,...t?.droppable},dragOverlay:{...Sw.dragOverlay,...t?.dragOverlay}}),[t?.draggable,t?.droppable,t?.dragOverlay])}function G4e(t){let{activeNode:e,measure:r,initialRect:n,config:i=!0}=t;const a=ee.useRef(!1),{x:s,y:o}=typeof i=="boolean"?{x:i,y:i}:i;id(()=>{if(!s&&!o||!e){a.current=!1;return}if(a.current||!n)return;const h=e?.node.current;if(!h||h.isConnected===!1)return;const f=r(h),g=qK(f,n);if(s||(g.x=0),o||(g.y=0),a.current=!0,Math.abs(g.x)>0||Math.abs(g.y)>0){const b=HK(h);b&&b.scrollBy({top:g.y,left:g.x})}},[e,s,o,n,r])}const nJ=ee.createContext({...uf,scaleX:1,scaleY:1});var Pp;(function(t){t[t.Uninitialized=0]="Uninitialized",t[t.Initializing=1]="Initializing",t[t.Initialized=2]="Initialized"})(Pp||(Pp={}));const X4e=ee.memo(function(e){var r,n,i,a;let{id:s,accessibility:o,autoScroll:u=!0,children:h,sensors:f=B4e,collisionDetection:g=J5e,measuring:b,modifiers:v,...S}=e;const E=ee.useReducer($4e,void 0,V4e),[P,k]=E,[L,O]=U5e(),[M,z]=ee.useState(Pp.Uninitialized),B=M===Pp.Initialized,{draggable:{active:q,nodes:W,translate:G},droppable:{containers:ie}}=P,Q=q!=null?W.get(q):null,H=ee.useRef({initial:null,translated:null}),ne=ee.useMemo(()=>{var bt;return q!=null?{id:q,data:(bt=Q?.data)!=null?bt:z4e,rect:H}:null},[q,Q]),oe=ee.useRef(null),[ce,fe]=ee.useState(null),[Me,me]=ee.useState(null),we=gb(S,Object.values(S)),Te=cx("DndDescribedBy",s),ke=ee.useMemo(()=>ie.getEnabled(),[ie]),he=W4e(b),{droppableRects:Ee,measureDroppableContainers:xe,measuringScheduled:Ne}=C4e(ke,{dragging:B,dependencies:[G.x,G.y],config:he.droppable}),Oe=E4e(W,q),$e=ee.useMemo(()=>Me?$k(Me):null,[Me]),De=Rr(),it=A4e(Oe,he.draggable.measure);G4e({activeNode:q!=null?W.get(q):null,config:De.layoutShiftCompensation,initialRect:it,measure:he.draggable.measure});const Ye=fV(Oe,he.draggable.measure,it),rt=fV(Oe?Oe.parentElement:null),Ie=ee.useRef({activatorEvent:null,active:null,activeNode:Oe,collisionRect:null,collisions:null,droppableRects:Ee,draggableNodes:W,draggingNode:null,draggingNodeRect:null,droppableContainers:ie,over:null,scrollableAncestors:[],scrollAdjustedTranslate:null}),Mt=ie.getNodeFor((r=Ie.current.over)==null?void 0:r.id),at=F4e({measure:he.dragOverlay.measure}),je=(n=at.nodeRef.current)!=null?n:Oe,Xt=B?(i=at.rect)!=null?i:Ye:null,Yt=!!(at.nodeRef.current&&at.rect),pr=k4e(Yt?null:Ye),vt=tJ(je?Pc(je):null),yr=M4e(B?Mt??Oe:null),_r=N4e(yr),cr=H4e(v,{transform:{x:G.x-pr.x,y:G.y-pr.y,scaleX:1,scaleY:1},activatorEvent:Me,active:ne,activeNodeRect:Ye,containerNodeRect:rt,draggingNodeRect:Xt,over:Ie.current.over,overlayNodeRect:at.rect,scrollableAncestors:yr,scrollableAncestorRects:_r,windowRect:vt}),Er=$e?Wv($e,G):null,wr=R4e(yr),er=pV(wr),lr=pV(wr,[Ye]),Ar=Wv(cr,er),ir=Xt?t4e(Xt,cr):null,nt=ne&&ir?g({active:ne,collisionRect:ir,droppableRects:Ee,droppableContainers:ke,pointerCoordinates:Er}):null,_e=Y5e(nt,"id"),[be,qe]=ee.useState(null),Qe=Yt?cr:Wv(cr,lr),ot=Q5e(Qe,(a=be?.rect)!=null?a:null,Ye),et=ee.useRef(null),Lt=ee.useCallback((bt,Tr)=>{let{sensor:Ur,options:Gr}=Tr;if(oe.current==null)return;const Jr=W.get(oe.current);if(!Jr)return;const ar=bt.nativeEvent,ti=new Ur({active:oe.current,activeNode:Jr,event:ar,options:Gr,context:Ie,onAbort(ri){if(!W.get(ri))return;const{onDragAbort:Be}=we.current,mt={id:ri};Be?.(mt),L({type:"onDragAbort",event:mt})},onPending(ri,Ae,Be,mt){if(!W.get(ri))return;const{onDragPending:Ir}=we.current,Fr={id:ri,constraint:Ae,initialCoordinates:Be,offset:mt};Ir?.(Fr),L({type:"onDragPending",event:Fr})},onStart(ri){const Ae=oe.current;if(Ae==null)return;const Be=W.get(Ae);if(!Be)return;const{onDragStart:mt}=we.current,pt={activatorEvent:ar,active:{id:Ae,data:Be.data,rect:H}};Nd.unstable_batchedUpdates(()=>{mt?.(pt),z(Pp.Initializing),k({type:Ml.DragStart,initialCoordinates:ri,active:Ae}),L({type:"onDragStart",event:pt}),fe(et.current),me(ar)})},onMove(ri){k({type:Ml.DragMove,coordinates:ri})},onEnd:un(Ml.DragEnd),onCancel:un(Ml.DragCancel)});et.current=ti;function un(ri){return async function(){const{active:Be,collisions:mt,over:pt,scrollAdjustedTranslate:Ir}=Ie.current;let Fr=null;if(Be&&Ir){const{cancelDrop:qn}=we.current;Fr={activatorEvent:ar,active:Be,collisions:mt,delta:Ir,over:pt},ri===Ml.DragEnd&&typeof qn=="function"&&await Promise.resolve(qn(Fr))&&(ri=Ml.DragCancel)}oe.current=null,Nd.unstable_batchedUpdates(()=>{k({type:ri}),z(Pp.Uninitialized),qe(null),fe(null),me(null),et.current=null;const qn=ri===Ml.DragEnd?"onDragEnd":"onDragCancel";if(Fr){const Oi=we.current[qn];Oi?.(Fr),L({type:qn,event:Fr})}})}}},[W]),_t=ee.useCallback((bt,Tr)=>(Ur,Gr)=>{const Jr=Ur.nativeEvent,ar=W.get(Gr);if(oe.current!==null||!ar||Jr.dndKit||Jr.defaultPrevented)return;const ti={active:ar};bt(Ur,Tr.options,ti)===!0&&(Jr.dndKit={capturedBy:Tr.sensor},oe.current=Gr,Lt(Ur,Tr))},[W,Lt]),jt=T4e(f,_t);O4e(f),id(()=>{Ye&&M===Pp.Initializing&&z(Pp.Initialized)},[Ye,M]),ee.useEffect(()=>{const{onDragMove:bt}=we.current,{active:Tr,activatorEvent:Ur,collisions:Gr,over:Jr}=Ie.current;if(!Tr||!Ur)return;const ar={active:Tr,activatorEvent:Ur,collisions:Gr,delta:{x:Ar.x,y:Ar.y},over:Jr};Nd.unstable_batchedUpdates(()=>{bt?.(ar),L({type:"onDragMove",event:ar})})},[Ar.x,Ar.y]),ee.useEffect(()=>{const{active:bt,activatorEvent:Tr,collisions:Ur,droppableContainers:Gr,scrollAdjustedTranslate:Jr}=Ie.current;if(!bt||oe.current==null||!Tr||!Jr)return;const{onDragOver:ar}=we.current,ti=Gr.get(_e),un=ti&&ti.rect.current?{id:ti.id,rect:ti.rect.current,data:ti.data,disabled:ti.disabled}:null,ri={active:bt,activatorEvent:Tr,collisions:Ur,delta:{x:Jr.x,y:Jr.y},over:un};Nd.unstable_batchedUpdates(()=>{qe(un),ar?.(ri),L({type:"onDragOver",event:ri})})},[_e]),id(()=>{Ie.current={activatorEvent:Me,active:ne,activeNode:Oe,collisionRect:ir,collisions:nt,droppableRects:Ee,draggableNodes:W,draggingNode:je,draggingNodeRect:Xt,droppableContainers:ie,over:be,scrollableAncestors:yr,scrollAdjustedTranslate:Ar},H.current={initial:Xt,translated:ir}},[ne,Oe,nt,ir,W,je,Xt,Ee,ie,be,yr,Ar]),x4e({...De,delta:G,draggingRect:ir,pointerCoordinates:Er,scrollableAncestors:yr,scrollableAncestorRects:_r});const Jt=ee.useMemo(()=>({active:ne,activeNode:Oe,activeNodeRect:Ye,activatorEvent:Me,collisions:nt,containerNodeRect:rt,dragOverlay:at,draggableNodes:W,droppableContainers:ie,droppableRects:Ee,over:be,measureDroppableContainers:xe,scrollableAncestors:yr,scrollableAncestorRects:_r,measuringConfiguration:he,measuringScheduled:Ne,windowRect:vt}),[ne,Oe,Ye,Me,nt,rt,at,W,ie,Ee,be,xe,yr,_r,he,Ne,vt]),Kt=ee.useMemo(()=>({activatorEvent:Me,activators:jt,active:ne,activeNodeRect:Ye,ariaDescribedById:{draggable:Te},dispatch:k,draggableNodes:W,over:be,measureDroppableContainers:xe}),[Me,jt,ne,Ye,k,Te,W,be,xe]);return ht.createElement($K.Provider,{value:O},ht.createElement(DT.Provider,{value:Kt},ht.createElement(rJ.Provider,{value:Jt},ht.createElement(nJ.Provider,{value:ot},h)),ht.createElement(q4e,{disabled:o?.restoreFocus===!1})),ht.createElement(q5e,{...o,hiddenTextDescribedById:Te}));function Rr(){const bt=ce?.autoScrollEnabled===!1,Tr=typeof u=="object"?u.enabled===!1:u===!1,Ur=B&&!bt&&!Tr;return typeof u=="object"?{...u,enabled:Ur}:{enabled:Ur}}}),Y4e=ee.createContext(null),mV="button",Z4e="Draggable";function K4e(t){let{id:e,data:r,disabled:n=!1,attributes:i}=t;const a=cx(Z4e),{activators:s,activatorEvent:o,active:u,activeNodeRect:h,ariaDescribedById:f,draggableNodes:g,over:b}=ee.useContext(DT),{role:v=mV,roleDescription:S="draggable",tabIndex:E=0}=i??{},P=u?.id===e,k=ee.useContext(P?nJ:Y4e),[L,O]=MS(),[M,z]=MS(),B=L4e(s,e),q=gb(r);id(()=>(g.set(e,{id:e,key:a,node:L,activatorNode:M,data:q}),()=>{const G=g.get(e);G&&G.key===a&&g.delete(e)}),[g,e]);const W=ee.useMemo(()=>({role:v,tabIndex:E,"aria-disabled":n,"aria-pressed":P&&v===mV?!0:void 0,"aria-roledescription":S,"aria-describedby":f.draggable}),[n,v,E,P,S,f.draggable]);return{active:u,activatorEvent:o,activeNodeRect:h,attributes:W,isDragging:P,listeners:n?void 0:B,node:L,over:b,setNodeRef:O,setActivatorNodeRef:z,transform:k}}function J4e(){return ee.useContext(rJ)}const Q4e="Droppable",eIe={timeout:25};function tIe(t){let{data:e,disabled:r=!1,id:n,resizeObserverConfig:i}=t;const a=cx(Q4e),{active:s,dispatch:o,over:u,measureDroppableContainers:h}=ee.useContext(DT),f=ee.useRef({disabled:r}),g=ee.useRef(!1),b=ee.useRef(null),v=ee.useRef(null),{disabled:S,updateMeasurementsFor:E,timeout:P}={...eIe,...i},k=gb(E??n),L=ee.useCallback(()=>{if(!g.current){g.current=!0;return}v.current!=null&&clearTimeout(v.current),v.current=setTimeout(()=>{h(Array.isArray(k.current)?k.current:[k.current]),v.current=null},P)},[P]),O=NT({callback:L,disabled:S||!s}),M=ee.useCallback((W,G)=>{O&&(G&&(O.unobserve(G),g.current=!1),W&&O.observe(W))},[O]),[z,B]=MS(M),q=gb(e);return ee.useEffect(()=>{!O||!z.current||(O.disconnect(),g.current=!1,O.observe(z.current))},[z,O]),ee.useEffect(()=>(o({type:Ml.RegisterDroppable,element:{id:n,key:a,disabled:r,node:z,rect:b,data:q}}),()=>o({type:Ml.UnregisterDroppable,key:a,id:n})),[n]),ee.useEffect(()=>{r!==f.current.disabled&&(o({type:Ml.SetDroppableDisabled,id:n,key:a,disabled:r}),f.current.disabled=r)},[n,a,r,o]),{active:s,rect:b,isOver:u?.id===n,node:z,over:u,setNodeRef:B}}function iJ(t,e,r){const n=t.slice();return n.splice(r<0?n.length+r:r,0,n.splice(e,1)[0]),n}function rIe(t,e){return t.reduce((r,n,i)=>{const a=e.get(n);return a&&(r[i]=a),r},Array(t.length))}function N2(t){return t!==null&&t>=0}function nIe(t,e){if(t===e)return!0;if(t.length!==e.length)return!1;for(let r=0;r<t.length;r++)if(t[r]!==e[r])return!1;return!0}function iIe(t){return typeof t=="boolean"?{draggable:t,droppable:t}:t}const aJ=t=>{let{rects:e,activeIndex:r,overIndex:n,index:i}=t;const a=iJ(e,n,r),s=e[i],o=a[i];return!o||!s?null:{x:o.left-s.left,y:o.top-s.top,scaleX:o.width/s.width,scaleY:o.height/s.height}},D2={scaleX:1,scaleY:1},aIe=t=>{var e;let{activeIndex:r,activeNodeRect:n,index:i,rects:a,overIndex:s}=t;const o=(e=a[r])!=null?e:n;if(!o)return null;if(i===r){const h=a[s];return h?{x:0,y:r<s?h.top+h.height-(o.top+o.height):h.top-o.top,...D2}:null}const u=oIe(a,i,r);return i>r&&i<=s?{x:0,y:-o.height-u,...D2}:i<r&&i>=s?{x:0,y:o.height+u,...D2}:{x:0,y:0,...D2}};function oIe(t,e,r){const n=t[e],i=t[e-1],a=t[e+1];return n?r<e?i?n.top-(i.top+i.height):a?a.top-(n.top+n.height):0:a?a.top-(n.top+n.height):i?n.top-(i.top+i.height):0:0}const oJ="Sortable",sJ=ht.createContext({activeIndex:-1,containerId:oJ,disableTransforms:!1,items:[],overIndex:-1,useDragOverlay:!1,sortedRects:[],strategy:aJ,disabled:{draggable:!1,droppable:!1}});function sIe(t){let{children:e,id:r,items:n,strategy:i=aJ,disabled:a=!1}=t;const{active:s,dragOverlay:o,droppableRects:u,over:h,measureDroppableContainers:f}=J4e(),g=cx(oJ,r),b=o.rect!==null,v=ee.useMemo(()=>n.map(B=>typeof B=="object"&&"id"in B?B.id:B),[n]),S=s!=null,E=s?v.indexOf(s.id):-1,P=h?v.indexOf(h.id):-1,k=ee.useRef(v),L=!nIe(v,k.current),O=P!==-1&&E===-1||L,M=iIe(a);id(()=>{L&&S&&f(v)},[L,v,S,f]),ee.useEffect(()=>{k.current=v},[v]);const z=ee.useMemo(()=>({activeIndex:E,containerId:g,disabled:M,disableTransforms:O,items:v,overIndex:P,useDragOverlay:b,sortedRects:rIe(v,u),strategy:i}),[E,g,M.draggable,M.droppable,O,v,P,u,b,i]);return ht.createElement(sJ.Provider,{value:z},e)}const lIe=t=>{let{id:e,items:r,activeIndex:n,overIndex:i}=t;return iJ(r,n,i).indexOf(e)},uIe=t=>{let{containerId:e,isSorting:r,wasDragging:n,index:i,items:a,newIndex:s,previousItems:o,previousContainerId:u,transition:h}=t;return!h||!n||o!==a&&i===s?!1:r?!0:s!==i&&e===u},cIe={duration:200,easing:"ease"},lJ="transform",hIe=mb.Transition.toString({property:lJ,duration:0,easing:"linear"}),fIe={roleDescription:"sortable"};function dIe(t){let{disabled:e,index:r,node:n,rect:i}=t;const[a,s]=ee.useState(null),o=ee.useRef(r);return id(()=>{if(!e&&r!==o.current&&n.current){const u=i.current;if(u){const h=H0(n.current,{ignoreTransform:!0}),f={x:u.left-h.left,y:u.top-h.top,scaleX:u.width/h.width,scaleY:u.height/h.height};(f.x||f.y)&&s(f)}}r!==o.current&&(o.current=r)},[e,r,n,i]),ee.useEffect(()=>{a&&s(null)},[a]),a}function pIe(t){let{animateLayoutChanges:e=uIe,attributes:r,disabled:n,data:i,getNewIndex:a=lIe,id:s,strategy:o,resizeObserverConfig:u,transition:h=cIe}=t;const{items:f,containerId:g,activeIndex:b,disabled:v,disableTransforms:S,sortedRects:E,overIndex:P,useDragOverlay:k,strategy:L}=ee.useContext(sJ),O=gIe(n,v),M=f.indexOf(s),z=ee.useMemo(()=>({sortable:{containerId:g,index:M,items:f},...i}),[g,i,M,f]),B=ee.useMemo(()=>f.slice(f.indexOf(s)),[f,s]),{rect:q,node:W,isOver:G,setNodeRef:ie}=tIe({id:s,data:z,disabled:O.droppable,resizeObserverConfig:{updateMeasurementsFor:B,...u}}),{active:Q,activatorEvent:H,activeNodeRect:ne,attributes:oe,setNodeRef:ce,listeners:fe,isDragging:Me,over:me,setActivatorNodeRef:we,transform:Te}=K4e({id:s,data:z,attributes:{...fIe,...r},disabled:O.draggable}),ke=M5e(ie,ce),he=!!Q,Ee=he&&!S&&N2(b)&&N2(P),xe=!k&&Me,Ne=xe&&Ee?Te:null,$e=Ee?Ne??(o??L)({rects:E,activeNodeRect:ne,activeIndex:b,overIndex:P,index:M}):null,De=N2(b)&&N2(P)?a({id:s,items:f,activeIndex:b,overIndex:P}):M,it=Q?.id,Ye=ee.useRef({activeId:it,items:f,newIndex:De,containerId:g}),rt=f!==Ye.current.items,Ie=e({active:Q,containerId:g,isDragging:Me,isSorting:he,id:s,index:M,items:f,newIndex:Ye.current.newIndex,previousItems:Ye.current.items,previousContainerId:Ye.current.containerId,transition:h,wasDragging:Ye.current.activeId!=null}),Mt=dIe({disabled:!Ie,index:M,node:W,rect:q});return ee.useEffect(()=>{he&&Ye.current.newIndex!==De&&(Ye.current.newIndex=De),g!==Ye.current.containerId&&(Ye.current.containerId=g),f!==Ye.current.items&&(Ye.current.items=f)},[he,De,g,f]),ee.useEffect(()=>{if(it===Ye.current.activeId)return;if(it!=null&&Ye.current.activeId==null){Ye.current.activeId=it;return}const je=setTimeout(()=>{Ye.current.activeId=it},50);return()=>clearTimeout(je)},[it]),{active:Q,activeIndex:b,attributes:oe,data:z,rect:q,index:M,newIndex:De,items:f,isOver:G,isSorting:he,isDragging:Me,listeners:fe,node:W,overIndex:P,over:me,setNodeRef:ke,setActivatorNodeRef:we,setDroppableNodeRef:ie,setDraggableNodeRef:ce,transform:Mt??$e,transition:at()};function at(){if(Mt||rt&&Ye.current.newIndex===M)return hIe;if(!(xe&&!XL(H)||!h)&&(he||Ie))return mb.Transition.toString({...h,property:lJ})}}function gIe(t,e){var r,n;return typeof t=="boolean"?{draggable:t,droppable:!1}:{draggable:(r=t?.draggable)!=null?r:e.draggable,droppable:(n=t?.droppable)!=null?n:e.droppable}}$a.Down,$a.Right,$a.Up,$a.Left;function NS({children:t,layerId:e}){const{attributes:r,listeners:n,setNodeRef:i,transform:a}=pIe({id:e}),s={transform:mb.Transform.toString(a)};return K.jsx("li",{ref:i,style:s,...r,...n,children:t})}try{NS.displayName="SortableContainer",NS.__docgenInfo={description:"",displayName:"SortableContainer",props:{layerId:{defaultValue:null,description:"",name:"layerId",required:!0,type:{name:"string"}}}}}catch{}const mIe=Pr(eh)({padding:"4px",marginTop:"-3px"}),yIe=Pr(eh)({marginLeft:"20px"});function Fd({layerComponent:t,visible:e,type:r,name:n,description:i,configurable:a,setLayerState:s,...o}){const[u,h]=ee.useState(!0),[f,g]=ee.useState(!1),[b,v]=ee.useState(!1),S=ee.useRef(!1),E=ee.useRef(e),[P,k]=ee.useState(t?.props?.paint||t?.props?.options?.paint||DZ(t?.props?.type||bS(t.props.geojson))),L=ee.useMemo(()=>e?u:!1,[e,u]);ee.useEffect(()=>{if(!s||!t?.props?.layers||L===E.current)return;E.current=L;const B={...t?.props};switch(t.type.name){case"MlWmsLayer":break;case"MlVectorTileLayer":t?.props?.layers&&!S.current&&(B.layers=t?.props?.layers.map(q=>(q.layout?q.layout.visibility=L?"visible":"none":q.layout={visibility:L?"visible":"none"},q)),console.log("setLayerState",B.layers),s(B));break}},[L,s,t]),ee.useEffect(()=>{!s||S.current||!P||t?.props?.layers||JSON.stringify(P)!==JSON.stringify(t.props?.paint)&&s({...t.props,paint:P})},[P,s,t.props?.paint]);const O=ee.useMemo(()=>{if(t&&r==="layer")switch(t.type.displayName){case"MlWmsLayer":return ht.cloneElement(t,{...t?.props,visible:L});case"MlVectorTileLayer":return ht.cloneElement(t,{...t?.props});default:case"MlGeoJsonLayer":return ht.cloneElement(t,{layout:{visibility:L?"visible":"none"},options:{...t?.props?.options,...s?{}:{paint:P}}})}return K.jsx(K.Fragment,{})},[r,t,P,L,t?.props?.layers,s]),M=ee.useMemo(()=>{if(t&&r==="layer"){if(t.props.type)return t.props.type;if(t.props.geojson)return bS(t.props.geojson)}},[t]),z=K.jsxs(PS,{sx:{...o.listItemSx},secondaryAction:a&&Object.keys(P)?.length>0?K.jsxs(K.Fragment,{children:[o?.buttons,K.jsx(mIe,{edge:"end","aria-label":"settings",onClick:()=>{g(B=>!B)},children:K.jsx(tL,{})})]}):void 0,children:[K.jsx(Rd,{children:K.jsx(Od,{disabled:!e,checked:u,onClick:()=>{h(B=>!B)}})}),K.jsx(yh,{variant:"layerlist",primary:n,secondary:i,primaryTypographyProps:{overflow:"hidden"}})]});return K.jsxs(K.Fragment,{children:[o.sortable&&o.layerId&&!t?.props?.layers&&K.jsx(NS,{layerId:o.layerId,children:z}),!o.sortable&&!t?.props?.layers&&z,O,!t?.props?.layers&&Object.keys(P).length>0&&a&&f&&K.jsxs(K.Fragment,{children:[o.showDeleteButton&&K.jsxs(K.Fragment,{children:[K.jsx(yIe,{edge:"end","aria-label":"delete",onClick:()=>{typeof s=="function"&&v(!0)},children:K.jsx(nx,{})}),b&&K.jsx(g0,{open:b,onConfirm:()=>{typeof s=="function"&&(S.current=!0,s(!1),v(!1))},onCancel:()=>{v(!1)},title:"Delete layer",text:"Are you sure you want to delete this layer?"})]}),K.jsx(IS,{paintProps:P,setPaintProps:k,layerType:M})]}),t?.props?.layers&&K.jsx(Ok,{visible:u,setVisible:h,name:n,children:t?.props?.layers?.map?.((B,q)=>K.jsx(kS,{vtProps:t?.props,setVtProps:s,id:""+q,visibleMaster:L},""+q))})]})}Fd.defaultProps={type:"layer",visible:!0,showDeleteButton:!1,buttons:K.jsx(K.Fragment,{})};try{Fd.displayName="LayerListItem",Fd.__docgenInfo={description:"",displayName:"LayerListItem",props:{layerComponent:{defaultValue:null,description:"",name:"layerComponent",required:!0,type:{name:"Element"}},visible:{defaultValue:{value:"true"},description:"",name:"visible",required:!1,type:{name:"boolean"}},configurable:{defaultValue:null,description:"",name:"configurable",required:!0,type:{name:"boolean"}},type:{defaultValue:{value:"layer"},description:"",name:"type",required:!1,type:{name:"enum",value:[{value:"undefined"},{value:'"background"'},{value:'"layer"'},{value:'"background-labels"'},{value:'"wms-layer"'},{value:'"vector-tile-layer"'}]}},name:{defaultValue:null,description:"",name:"name",required:!0,type:{name:"ReactNode"}},description:{defaultValue:null,description:"",name:"description",required:!1,type:{name:"string | undefined"}},setLayerState:{defaultValue:null,description:"",name:"setLayerState",required:!1,type:{name:"Dispatch<any> | undefined"}},showDeleteButton:{defaultValue:{value:"false"},description:"",name:"showDeleteButton",required:!1,type:{name:"boolean | undefined"}},listItemSx:{defaultValue:null,description:"",name:"listItemSx",required:!1,type:{name:"SxProps | undefined"}},buttons:{defaultValue:{value:"<></>"},description:"",name:"buttons",required:!1,type:{name:"Element | undefined"}},layerId:{defaultValue:null,description:"",name:"layerId",required:!1,type:{name:"string | undefined"}},sortable:{defaultValue:null,description:"",name:"sortable",required:!1,type:{name:"boolean | undefined"}}}}}catch{}const vIe=Hi(K.jsx("path",{d:"M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"})),_Ie=Pr("div")(()=>({display:"flex",alignItems:"center"})),bIe=56,xIe=Pr(Vo)(({theme:t})=>({width:30,height:6,backgroundColor:t.palette.text.primary,borderRadius:3,position:"absolute",top:8,left:"calc(50% - 15px)"}));function Gk({drawerPaperProps:t,drawerHeaderProps:e,setOpen:r,...n}){const i=Gb(u=>u.breakpoints.down("sm")),[a,s]=ee.useState(!1),o=n.drawerBleeding?n.drawerBleeding:bIe;return K.jsxs(K.Fragment,{children:[i?K.jsxs(Vo,{sx:{display:{xs:"flex",sm:"none"}},children:[K.jsx(gW,{styles:{".MuiDrawer-root > .MuiPaper-root":{height:`calc(50% - ${o}px)`,overflow:"visible"}}}),K.jsxs(Cge,{anchor:"bottom",open:typeof n.open>"u"?a:n.open,onClose:r?()=>{r?.(!1)}:()=>{s(!1)},onOpen:r?()=>{r?.(!0)}:()=>{s(!0)},swipeAreaWidth:o,disableSwipeToOpen:!1,hideBackdrop:!0,ModalProps:{keepMounted:!0,sx:{top:"calc(90%)"}},children:[K.jsxs(Th,{sx:{position:"absolute",top:-o,borderTopLeftRadius:8,borderTopRightRadius:8,visibility:"visible",right:0,left:0},children:[K.jsx(xIe,{}),K.jsx(vs,{variant:"h6",sx:{p:"13px"},children:n.name})]}),K.jsx(Th,{sx:{px:"15px",pb:"15px",height:"100%",overflow:"auto",paddingTop:"20px"},children:n.children})]})]}):K.jsx(Vo,{sx:{display:{xs:"none",sm:"flex"},mr:1},children:K.jsxs(eO,{transitionDuration:0,variant:"persistent",anchor:"left",open:typeof n.open>"u"?a:n.open,PaperProps:{...t,sx:{maxWidth:{lg:"30%",md:"40%",sm:"50%",xs:"78%"},padding:{sm:"84px 20px 20px 20px",xs:"74px 10px 10px 10px"},width:{xs:"80%",sm:"60%",md:"350px",lg:"350px"},boxSizing:"border-box",...t?.sx}},sx:{flexGrow:1,zIndex:105,position:"absolute",bottom:0,display:"flex",flexDirection:"column",maxWidth:{lg:"30%",md:"40%",sm:"50%",xs:"78%"},...a?{}:{left:i?"-90vw":"-20vw"}},...n,children:[K.jsxs(_Ie,{...e,children:[K.jsx(vs,{variant:"h6",children:n.name}),K.jsx(eh,{onClick:r?()=>{r?.(!1)}:()=>{s(!1)},sx:{position:"absolute",right:"20px"},children:K.jsx(vIe,{})})]}),K.jsx(Vo,{children:n.children})]})}),";"]})}try{Gk.displayName="Sidebar",Gk.__docgenInfo={description:"",displayName:"Sidebar",props:{drawerPaperProps:{defaultValue:null,description:"",name:"drawerPaperProps",required:!1,type:{name:"PaperProps | undefined"}},drawerHeaderProps:{defaultValue:null,description:"",name:"drawerHeaderProps",required:!1,type:{name:"Headers | undefined"}},children:{defaultValue:null,description:"The content of the component.",name:"children",required:!1,type:{name:"ReactNode"}},open:{defaultValue:{value:"false"},description:"If `true`, the component is shown.",name:"open",required:!1,type:{name:"boolean | undefined"}},setOpen:{defaultValue:null,description:"",name:"setOpen",required:!1,type:{name:"((val: boolean) => void) | undefined"}},name:{defaultValue:null,description:"",name:"name",required:!1,type:{name:"string | undefined"}},drawerBleeding:{defaultValue:null,description:"",name:"drawerBleeding",required:!1,type:{name:"number | undefined"}},component:{defaultValue:null,description:"",name:"component",required:!1,type:{name:"ElementType<any, keyof IntrinsicElements> | undefined"}},slots:{defaultValue:{value:"{}"},description:"The components used for each slot inside.",name:"slots",required:!1,type:{name:"Partial<DrawerSlots> | undefined"}},slotProps:{defaultValue:{value:"{}"},description:"The props used for each slot inside.",name:"slotProps",required:!1,type:{name:"{ root?: SlotProps<ElementType<ModalProps, keyof IntrinsicElements>, DrawerRootSlotPropsOverrides, DrawerOwnerState> | undefined; backdrop?: SlotProps<...> | undefined; docked?: SlotProps<...> | undefined; paper?: SlotProps<...> | undefined; transition?: SlotProps<...> | undefined; } | undefined"}}}}}catch{}const yV=t=>{const[e,r]=ee.useState(!0),[n,i]=ee.useState(t.measureType),[a,s]=ee.useState(),o=ha({mapId:t.mapId,waitForLayer:t.insertBeforeLayer}),[u,h]=ee.useState(),[f,g]=ee.useState("kilometers"),[b,v]=ee.useState([]),[S,E]=ee.useState(!1),P=()=>{f==="kilometers"&&g("miles"),f==="miles"&&g("kilometers")},k=O=>{v(M=>{const z=[...M];return z.splice(O,1),s(void 0),z})},L=O=>{h({measure:O.value,unit:O.unit,geojson:O.geojson})};return ee.useEffect(()=>{S&&(E(!1),u&&v(O=>{const M=[...O];return M.push(u),M}))},[S]),ee.useEffect(()=>{h(void 0)},[f]),K.jsx(K.Fragment,{children:K.jsxs(Gk,{open:e,setOpen:r,name:"Multi Measure Tool",children:[K.jsxs(Vo,{sx:{flexGrow:1},children:[K.jsx("br",{}),K.jsxs(Dd,{container:!0,spacing:4,justifyContent:"flex-start",children:[K.jsx(Dd,{size:3,children:K.jsx(Np,{title:"Measure Area",children:K.jsx(Ji,{variant:"outlined",sx:{backgroundColor:n==="polygon"?O=>O.palette.GPS.GPSActiveColor:O=>O.palette.GPS.GPSActiveBackgroundColor,color:n==="polygon"?O=>O.palette.GPS.GPSActiveBackgroundColor:O=>O.palette.GPS.GPSActiveColor},onClick:()=>{i("polygon"),h(void 0),E(!0)},children:K.jsx(BZ,{})})})}),K.jsx(Dd,{size:3,children:K.jsx(Np,{title:"Measure Distance",children:K.jsx(Ji,{variant:"outlined",sx:{backgroundColor:n==="line"?O=>O.palette.GPS.GPSActiveColor:O=>O.palette.GPS.GPSActiveBackgroundColor,color:n==="line"?O=>O.palette.GPS.GPSActiveBackgroundColor:O=>O.palette.GPS.GPSActiveColor},onClick:()=>{i("line"),h(void 0),E(!0)},children:K.jsx(FZ,{})})})})]})]}),K.jsx("br",{}),K.jsx(Dd,{size:4,children:K.jsxs(Zc,{children:[K.jsx($p,{id:"unit-select-label",children:"Unit"}),K.jsxs(qp,{labelId:"unit-select-label",id:"unit-select",value:f,label:"Unit",onChange:O=>{g(O.target.value),h(void 0),E(!0)},children:[K.jsx(im,{value:"kilometers",children:"Kilometers"}),K.jsx(im,{value:"miles",children:"Miles"})]})]})}),K.jsx("br",{}),!S&&K.jsx(Mk,{measureType:n,unit:f,onChange:L,...P,onFinish:()=>{E(!0)}}),K.jsxs(Rk,{children:[b?.map((O,M)=>K.jsx(K.Fragment,{children:K.jsxs(Vo,{sx:{display:"flex",flexDirection:"column"},children:[K.jsx("br",{}),K.jsx(Vo,{flexDirection:"row",sx:{"&:hover":{backgroundColor:"rgb(177, 177, 177, 0.2)"},marginTop:"25px"},onMouseOver:()=>{s(O.geojson)},onMouseLeave:()=>{s(void 0)},children:K.jsxs(ee.Fragment,{children:[K.jsx(Fd,{layerComponent:K.jsx(wc,{mapId:t.mapId,geojson:O.geojson}),visible:!0,configurable:!0,type:"layer",name:O.geojson.geometry?.type==="LineString"?O.measure.toFixed(3).toString()+" "+O.unit:O.measure.toFixed(3).toString()+" "+O.unit+""},O.measure),K.jsx(Np,{title:"Delete",children:K.jsxs(Ji,{onClick:()=>k(M),children:[" ",K.jsx(nx,{})," "]})}),K.jsx(Np,{title:"Center Location",children:K.jsx(Ji,{onClick:()=>{o?.map?.map.setCenter(O.geojson.geometry.type==="Point"?O.geojson.geometry.coordinates:JO(O.geojson).geometry.coordinates)},children:K.jsx(eL,{})})})]},O.measure+"-"+M)})]},O.measure)})),a&&K.jsx(wc,{mapId:t.mapId,geojson:{type:"FeatureCollection",features:[a]},layerId:"highlightBorder",defaultPaintOverrides:{circle:{"circle-color":"#dd9900","circle-opacity":.4,"circle-radius":10},line:{"line-color":"#dd9900","line-opacity":.4,"line-width":10},fill:{"fill-color":"#dd9900","fill-opacity":.4}}})]})]})})};try{yV.displayName="MlMultiMeasureTool",yV.__docgenInfo={description:"",displayName:"MlMultiMeasureTool",props:{mapId:{defaultValue:null,description:"Id of the target MapLibre instance in mapContext",name:"mapId",required:!1,type:{name:"string | undefined"}},insertBeforeLayer:{defaultValue:null,description:`Id of an existing layer in the mapLibre instance to help specify the layer order
This layer will be visually beneath the layer with the "insertBeforeLayer" id.`,name:"insertBeforeLayer",required:!1,type:{name:"string | undefined"}},buttonStyleOverride:{defaultValue:null,description:`Style attribute for the button-style
https://mui.com/system/getting-started/the-sx-prop/`,name:"buttonStyleOverride",required:!1,type:{name:"SxProps | undefined"}},measureType:{defaultValue:null,description:'String that specify if the Tool measures an area ("polygon") or length ("line")',name:"measureType",required:!1,type:{name:"enum",value:[{value:"undefined"},{value:'"line"'},{value:'"polygon"'}]}},multiType:{defaultValue:null,description:"Boolean which decides if the user can switch between measure modes",name:"multiType",required:!1,type:{name:"boolean | undefined"}},unit:{defaultValue:null,description:"String that dictates which unit of measurement is used",name:"unit",required:!1,type:{name:"enum",value:[{value:"undefined"},{value:'"meters"'},{value:'"metres"'},{value:'"millimeters"'},{value:'"millimetres"'},{value:'"centimeters"'},{value:'"centimetres"'},{value:'"kilometers"'},{value:'"kilometres"'},{value:'"miles"'},{value:'"nauticalmiles"'},{value:'"inches"'},{value:'"yards"'},{value:'"feet"'},{value:'"radians"'},{value:'"degrees"'}]}},onChange:{defaultValue:null,description:`Callback function that is called each time measurment geometry within has changed within MlMeasureTool.
First parameter is the new GeoJson feature.`,name:"onChange",required:!1,type:{name:"((options: { value: number; unit?: string | undefined; geojson: Feature<Geometry, GeoJsonProperties>; geometries?: [] | undefined; }) => void) | undefined"}},onFinish:{defaultValue:null,description:"Callback function that is called by the end of drawing geometries.",name:"onFinish",required:!1,type:{name:"(() => void) | undefined"}}}}}catch{}const wIe=Hi(K.jsx("path",{d:"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6z"})),SIe=Hi(K.jsx("path",{d:"M19 13H5v-2h14z"})),Xk=({className:t="",title:e,onClick:r,style:n})=>K.jsxs("svg",{width:"52",height:"53",viewBox:"0 0 52 53",fill:"none",className:t,onClick:r,role:e?"img":"presentation","aria-hidden":!e,style:n,children:[e&&K.jsx("title",{children:e}),K.jsx("circle",{cx:"26.0001",cy:"26.1843",r:"24",fill:"white",stroke:"#009EE0",strokeWidth:"2"}),K.jsx("path",{d:"M26.4915 7.59161C26.3524 8.07338 25.6698 8.07338 25.5307 7.59161L24.2998 3.3276C24.2075 3.0079 24.4474 2.68893 24.7802 2.68893H27.242C27.5748 2.68893 27.8147 3.0079 27.7224 3.3276L26.4915 7.59161Z",fill:"#009EE0"}),K.jsx("path",{d:"M25.5085 44.7598C25.6476 44.278 26.3302 44.278 26.4693 44.7598L27.7002 49.0238C27.7925 49.3435 27.5526 49.6625 27.2198 49.6625H24.758C24.4252 49.6625 24.1853 49.3435 24.2776 49.0238L25.5085 44.7598Z",fill:"#009EE0"}),K.jsx("path",{d:"M44.6641 26.4915C44.1823 26.3524 44.1823 25.6698 44.6641 25.5307L48.9281 24.2998C49.2478 24.2075 49.5668 24.4474 49.5668 24.7802V27.242C49.5668 27.5747 49.2478 27.8147 48.9281 27.7224L44.6641 26.4915Z",fill:"#009EE0"}),K.jsx("path",{d:"M7.3959 25.6085C7.87766 25.7476 7.87766 26.4302 7.3959 26.5693L3.13189 27.8002C2.81218 27.8925 2.49321 27.6526 2.49321 27.3198L2.49321 24.858C2.49321 24.5253 2.81218 24.2853 3.13189 24.3776L7.3959 25.6085Z",fill:"#009EE0"})]});try{Xk.displayName="CompassBackground",Xk.__docgenInfo={description:"",displayName:"CompassBackground",props:{className:{defaultValue:{value:""},description:"",name:"className",required:!1,type:{name:"string | undefined"}},title:{defaultValue:null,description:"",name:"title",required:!1,type:{name:"string | undefined"}},onClick:{defaultValue:null,description:"",name:"onClick",required:!1,type:{name:"(() => void) | undefined"}},style:{defaultValue:null,description:"",name:"style",required:!1,type:{name:"CSSProperties | undefined"}}}}}catch{}const Yk=({className:t="",title:e,onClick:r,style:n})=>K.jsxs("svg",{width:"10",height:"40",viewBox:"0 0 10 40",fill:"none",className:t,onClick:r,role:e?"img":"presentation","aria-hidden":!e,style:n,children:[e&&K.jsx("title",{children:e}),K.jsxs("g",{transform:"translate(0.67544,-1.25e-5)",children:[K.jsx("path",{d:"m 3.34715,4.52028 c 0.22737,-1.05154 1.72745,-1.05154 1.95482,0 L 8.64912,20 H 0 Z",fill:"#cf003d"}),K.jsx("path",{d:"m 3.34715,35.4797 c 0.22737,1.0516 1.72745,1.0516 1.95482,0 L 8.64912,20 H 0 Z",fill:"#d3dcf0"})]})]});try{Yk.displayName="CompassNeedle",Yk.__docgenInfo={description:"",displayName:"CompassNeedle",props:{className:{defaultValue:{value:""},description:"",name:"className",required:!1,type:{name:"string | undefined"}},title:{defaultValue:null,description:"",name:"title",required:!1,type:{name:"string | undefined"}},onClick:{defaultValue:null,description:"",name:"onClick",required:!1,type:{name:"(() => void) | undefined"}},style:{defaultValue:null,description:"",name:"style",required:!1,type:{name:"CSSProperties | undefined"}}}}}catch{}const EIe=Pr(Vo)(({theme:t})=>({zIndex:1e3,cursor:"pointer",transform:"scale(1)",[t.breakpoints.down("md")]:{transform:"scale(1.6)"}})),TIe=Pr(Vo)(({theme:t})=>({position:"absolute",right:"-10px",top:"-52px",width:"52px",height:"52px",display:"flex",flexDirection:"row",justifyContent:"center",alignItems:"center",[t.breakpoints.down("md")]:{right:"0px",top:"-52px"},circle:{fill:t.palette.compass.compColor,stroke:t.palette.compass.compStroke},path:{fill:t.palette.compass.compStroke},"&:hover circle":{fill:t.palette.compass.compHover}})),CIe=Pr(Vo)(({theme:t})=>({display:"flex",flexDirection:"row","path:nth-of-type(2)":{fill:t.palette.compass.compSouth},"path:nth-of-type(1)":{fill:t.palette.compass.compNorth}})),Zk=t=>{const e=ha({mapId:t.mapId,waitForLayer:t.insertBeforeLayer}),[r,n]=ee.useState(0),i=()=>{e.map?.map?.getBearing&&n(Math.round(e.map.map.getBearing()))};ee.useEffect(()=>{if(e.map)return e.map.on("rotate",i,e.componentId),i(),()=>{e.map?.map.off("rotate",i)}},[e.map,t.mapId]);const a=()=>{r==0?e.map?.map.setBearing(-90):r==-90?e.map?.map.setBearing(180):r==180?e.map?.map.setBearing(90):e.map?.map.setBearing(0)};return K.jsx(K.Fragment,{children:K.jsx(EIe,{sx:{...t.style},children:K.jsxs(TIe,{onClick:a,sx:{...t.backgroundStyle},children:[K.jsx(Xk,{style:{position:"absolute",top:0,left:0}}),K.jsx(CIe,{onClick:a,sx:{...t.needleStyle},children:K.jsx(Yk,{style:{transform:"rotate("+(r>0?"-"+r:-1*r)+"deg)"}})})]})})})};try{Zk.displayName="MlNavigationCompass",Zk.__docgenInfo={description:`Navigation component that displays a compass component which indicates the current orientation of the map it is registered for and offers controls to turn the bearing 90 left/right or reset north to point up.

All style props are applied using`,displayName:"MlNavigationCompass",props:{mapId:{defaultValue:null,description:"Id of the target MapLibre instance in mapHook",name:"mapId",required:!1,type:{name:"string | undefined"}},insertBeforeLayer:{defaultValue:null,description:`The layerId of an existing layer this layer should be rendered visually beneath
https://maplibre.org/maplibre-gl-js-docs/api/map/#map#addlayer - see "beforeId" property`,name:"insertBeforeLayer",required:!1,type:{name:"string | undefined"}},style:{defaultValue:null,description:"Style object to adjust css definitions of the component.",name:"style",required:!1,type:{name:"CSSProperties | undefined"}},backgroundStyle:{defaultValue:null,description:"Style object to adjust css definitions of the background.",name:"backgroundStyle",required:!1,type:{name:"CSSProperties | undefined"}},needleStyle:{defaultValue:null,description:"Style object to adjust css definitions of the compass needle.",name:"needleStyle",required:!1,type:{name:"CSSProperties | undefined"}}}}}catch{}const AIe=Hi(K.jsx("path",{d:"m20.5 3-.16.03L15 5.1 9 3 3.36 4.9c-.21.07-.36.25-.36.48V20.5c0 .28.22.5.5.5l.16-.03L9 18.9l6 2.1 5.64-1.9c.21-.07.36-.25.36-.48V3.5c0-.28-.22-.5-.5-.5M15 19l-6-2.11V5l6 2.11z"})),IIe=Hi(K.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m-1 17.93c-3.95-.49-7-3.85-7-7.93 0-.62.08-1.21.21-1.79L9 15v1c0 1.1.9 2 2 2zm6.9-2.54c-.26-.81-1-1.39-1.9-1.39h-1v-3c0-.55-.45-1-1-1H8v-2h2c.55 0 1-.45 1-1V7h2c1.1 0 2-.9 2-2v-.41c2.93 1.19 5 4.06 5 7.41 0 2.08-.8 3.97-2.1 5.39"})),PIe=Pr(Ji)(({theme:t})=>({zIndex:1e3,color:t.palette.navigation.buttonColor,transform:"scale(1)"})),Kk=t=>{const e=ha({mapId:t.mapId,waitForLayer:t.insertBeforeLayer}),[r,n]=ee.useState(t.mode||"mercator");ee.useEffect(()=>{e.map?.map.getProjection?.()?.type!==r&&e.map?.setProjection({type:r})},[e.map]);const i=()=>{if(!e.map)return;const a=r==="globe"?"mercator":"globe";e.map.setProjection({type:a}),n(a)};return K.jsx(K.Fragment,{children:K.jsx(PIe,{variant:"navtools",onClick:i,style:t.style,children:r==="globe"?K.jsx(IIe,{"data-testid":"PublicIcon",sx:{fontSize:{xs:"1.4em",md:"1em"}}}):K.jsx(AIe,{"data-testid":"MapIcon",sx:{fontSize:{xs:"1.4em",md:"1em"}}})})})};try{Kk.displayName="MlGlobeButton",Kk.__docgenInfo={description:"",displayName:"MlGlobeButton",props:{mapId:{defaultValue:null,description:"Id of the target MapLibre instance in mapContext",name:"mapId",required:!1,type:{name:"string | undefined"}},insertBeforeLayer:{defaultValue:null,description:`Id of an existing layer in the mapLibre instance to help specify the layer order
This layer will be visually beneath the layer with the "insertBeforeLayer" id.`,name:"insertBeforeLayer",required:!1,type:{name:"string | undefined"}},style:{defaultValue:null,description:"Style object to adjust css definitions of the component.",name:"style",required:!1,type:{name:"CSSProperties | undefined"}},mode:{defaultValue:null,description:"Initial projection mode of the map.",name:"mode",required:!1,type:{name:"enum",value:[{value:"undefined"},{value:'"globe"'},{value:'"mercator"'}]}}}}}catch{}const Jk=t=>{const e=ha({mapId:t.mapId,waitForLayer:t.insertBeforeLayer}),[r,n]=ee.useState(0),i=Gb(h=>h.breakpoints.down("md")),a=Tc();ee.useEffect(()=>{e.map&&(e.map.on("pitchend",()=>{e.map&&n(e.map.getPitch())},e.componentId),n(e.map.getPitch()))},[e.map,t.mapId]);const s=ee.useCallback(()=>{e.map&&e.map.easeTo({zoom:e.map.getZoom()+.5})},[e.map]),o=ee.useCallback(()=>{e.map&&e.map.easeTo({zoom:e.map.getZoom()-.5})},[e.map]),u=ee.useCallback(()=>{if(!e.map)return;n(e.map.getPitch());const h=e.map.getPitch()!==0?0:60;e.map.easeTo({pitch:h})},[e.map]);return K.jsxs(Vo,{sx:{zIndex:501,position:"absolute",display:"flex",flexDirection:"column",right:i?"15px":"25px",bottom:i?"20px":"40px",...i?{margin:"80px 10px 50px 10px"}:{marginTop:"50px"},...t.sx},children:[K.jsx(Zk,{}),t.show3DButton&&K.jsx(Ji,{variant:"navtools",onClick:u,sx:{color:h=>h.palette.navigation.buttonColor},children:r<29?"2D":"3D"}),t.showGlobeButton&&K.jsx(Kk,{}),t.showFollowGpsButton&&K.jsx(kk,{}),t.showCenterLocationButton&&K.jsx(DP,{}),K.jsx(RP,{orientation:"vertical",sx:{border:"none",Button:{minWidth:"20px !important",color:a.palette.navigation.buttonColor},"Button:hover":{border:"none"}},children:t.showZoomButtons&&K.jsxs(K.Fragment,{children:[K.jsx(Ji,{variant:"navtools",onClick:s,sx:{borderBottomLeftRadius:0,borderBottomRightRadius:0,position:"relative"},children:K.jsx(wIe,{sx:{fontSize:{xs:"1.4em",md:"1em"}}})}),K.jsx(Th,{sx:{backgroundColor:"#fff"},children:K.jsx(OP,{sx:{marginLeft:"6px",marginRight:"6px"}})}),K.jsx(Ji,{variant:"navtools",onClick:o,sx:{margin:0,borderTopLeftRadius:0,borderTopRightRadius:0},children:K.jsx(SIe,{sx:{fontSize:{xs:"1.4em",md:"1em"}}})})]})}),t.children&&ht.cloneElement(t.children,{})]})};try{Jk.displayName="MlNavigationTools",Jk.__docgenInfo={description:"",displayName:"MlNavigationTools",props:{mapId:{defaultValue:null,description:"Id of the target MapLibre instance in mapContext",name:"mapId",required:!1,type:{name:"string | undefined"}},insertBeforeLayer:{defaultValue:null,description:`The layerId of an existing layer this layer should be rendered visually beneath
https://maplibre.org/maplibre-gl-js-docs/api/map/#map#addlayer - see "beforeId" property`,name:"insertBeforeLayer",required:!1,type:{name:"string | undefined"}},show3DButton:{defaultValue:null,description:"Show 3D button",name:"show3DButton",required:!1,type:{name:"boolean | undefined"}},showGlobeButton:{defaultValue:null,description:"Show global button",name:"showGlobeButton",required:!1,type:{name:"boolean | undefined"}},showZoomButtons:{defaultValue:null,description:"Show zoom button",name:"showZoomButtons",required:!1,type:{name:"boolean | undefined"}},showFollowGpsButton:{defaultValue:null,description:"Show follow GPS button",name:"showFollowGpsButton",required:!1,type:{name:"boolean | undefined"}},showCenterLocationButton:{defaultValue:null,description:"Show center on current position button",name:"showCenterLocationButton",required:!1,type:{name:"boolean | undefined"}},children:{defaultValue:null,description:"Additional JSX Elements to be rendered below MlNavigationTools buttons",name:"children",required:!1,type:{name:"Element | undefined"}},sx:{defaultValue:null,description:"Style attribute for NavigationTools container",name:"sx",required:!1,type:{name:"SxProps | undefined"}},mediaIsMobile:{defaultValue:null,description:"Style attribute for NavigationTools container",name:"mediaIsMobile",required:!1,type:{name:"boolean | undefined"}}}}}catch{}const DS=t=>(Yd({idPrefix:"MlLayer-",layerId:t.layerId,mapId:t.mapId,geojson:t.geojson||void 0,options:{type:"background",paint:{...t?.options?.type&&t.options.type!=="background"?{}:{"background-color":"rgba(0,0,0,0)"}},...t.options},insertBeforeLayer:t.insertBeforeLayer}),K.jsx(K.Fragment,{}));try{DS.displayName="MlLayer",DS.__docgenInfo={description:"Basic layer component that create a layer in a MapLibre-gl instance and keeps it updated according to it attribute configuration.",displayName:"MlLayer",props:{mapId:{defaultValue:null,description:"Id of the target MapLibre instance in mapContext",name:"mapId",required:!1,type:{name:"string | undefined"}},insertBeforeLayer:{defaultValue:null,description:`The layerId of an existing layer this layer should be rendered visually beneath
https://maplibre.org/maplibre-gl-js-docs/api/map/#map#addlayer - see "beforeId" property`,name:"insertBeforeLayer",required:!1,type:{name:"string | undefined"}},layerId:{defaultValue:null,description:"Id of the layer that will be added by this component to the maplibre-gl instance",name:"layerId",required:!1,type:{name:"string | undefined"}},options:{defaultValue:null,description:"Javascript object that is passed the addLayer command as first parameter.",name:"options",required:!1,type:{name:"Partial<LayerSpecification & { source?: string | GeoJSONSourceSpecification | undefined; id?: string | undefined; filter?: FilterSpecification | undefined; }> | undefined"}},geojson:{defaultValue:null,description:"GeoJSON data that is supposed to be rendered by this component.",name:"geojson",required:!1,type:{name:"Feature<Geometry, GeoJsonProperties> | FeatureCollection<Geometry, GeoJsonProperties> | undefined"}}}}}catch{}const vV=t=>{const e=ee.useRef(0),r=ha({mapId:t.mapId,waitForLayer:t.insertBeforeLayer}),[n,i]=ee.useState(0),[a,s]=ee.useState(""),o=ee.useCallback(()=>{if(!r.map||r.map?.map.getZoom()===e.current)return;e.current=r.map?.map.getZoom();const g=t.maxWidth||100,b=r.map.map._container.clientHeight/2,v=r.map.map.unproject([0,b]),S=r.map.map.unproject([g,b]),E=v.distanceTo(S);if(t.unit==="imperial"){const P=3.2808*E;if(P>5280){const k=P/5280;u(g,k,r.map.map._getUIString("ScaleControl.Miles"))}else u(g,P,r.map.map._getUIString("ScaleControl.Feet"))}else if(t.unit==="nautical"){const P=E/1852;u(g,P,r.map.map._getUIString("ScaleControl.NauticalMiles"))}else E>=1e3?u(g,E/1e3,r.map.map._getUIString("ScaleControl.Kilometers")):u(g,E,r.map.map._getUIString("ScaleControl.Meters"))},[r.map,t.unit,t.maxWidth]);ee.useEffect(()=>{if(!r.map)return;const g=o;return r.map.on("move",g,r.componentId),o(),()=>{r.map?.map.off("move",g)}},[r.map,o]);const u=(g,b,v)=>{const S=f(b),E=S/b;i(g*E),s(S+"&nbsp;"+v)},h=g=>{const b=Math.pow(10,Math.ceil(-Math.log(g)/Math.LN10));return Math.round(g*b)/b},f=g=>{const b=Math.pow(10,`${Math.floor(g)}`.length-1);let v=g/b;return v=v>=10?10:v>=5?5:v>=3?3:v>=2?2:v>=1?1:h(v),b*v};return K.jsx(K.Fragment,{children:K.jsx("div",{style:{backgroundColor:"hsla(0,0%,100%,.75)",fontSize:"10px",border:"2px solid #333",borderTop:"#333",padding:"0 5px",color:"#333",boxSizing:"border-box",width:n+"px",fontFamily:"sans-serif"},dangerouslySetInnerHTML:{__html:a}})})};try{vV.displayName="MlScaleReference",vV.__docgenInfo={description:"",displayName:"MlScaleReference",props:{mapId:{defaultValue:null,description:"",name:"mapId",required:!1,type:{name:"string | undefined"}},insertBeforeLayer:{defaultValue:null,description:"",name:"insertBeforeLayer",required:!1,type:{name:"string | undefined"}},maxWidth:{defaultValue:null,description:"",name:"maxWidth",required:!1,type:{name:"number | undefined"}},unit:{defaultValue:null,description:"",name:"unit",required:!1,type:{name:"string | undefined"}}}}}catch{}var iI,_V;function kIe(){if(_V)return iI;_V=1;function t(r,n){var i=r.getCenter(),a=r.getZoom(),s=r.getBearing(),o=r.getPitch();n.forEach(function(u){u.jumpTo({center:i,zoom:a,bearing:s,pitch:o})})}function e(){var r,n=arguments.length;if(n===1)r=arguments[0];else{r=[];for(var i=0;i<n;i++)r.push(arguments[i])}var a=[];r.forEach(function(h,f){a[f]=u.bind(null,h,r.filter(function(g,b){return b!==f}))});function s(){r.forEach(function(h,f){h.on("move",a[f])})}function o(){r.forEach(function(h,f){h.off("move",a[f])})}function u(h,f){o(),t(h,f),s()}return s(),function(){o(),a=[],r=[]}}return iI=e,iI}var MIe=kIe();const uJ=od(MIe),bV=t=>{const e=ee.useContext(og),r=ee.useRef(!1),n=ee.useRef(()=>{}),[i,a]=ee.useState(50),s=ee.useRef(50),[o,u]=ee.useState(50),h=ee.useRef(50),f=ee.useMemo(()=>t.magnifierRadius||200,[t.magnifierRadius]),g=ee.useCallback(()=>!(!t.map1Id||!t.map2Id||!e.getMap(t.map1Id)||!e.getMap(t.map2Id)),[t,e]),b=ee.useRef(()=>{g()&&S({clientX:s.current,clientY:h.current})});ee.useEffect(()=>{window.addEventListener("resize",b.current);const O=b.current;return()=>{window.removeEventListener("resize",O),n.current()}},[]);const v=ee.useCallback(O=>{if(!g())return;const M=e.maps[t.map1Id].getCanvas().getBoundingClientRect();let z=typeof O.touches<"u"&&typeof O.touches[0]<"u"?O.touches[0].clientX:0,B=typeof O.touches<"u"&&typeof O.touches[0]<"u"?O.touches[0].clientY:0;z-=M.x,B-=M.y;const q=parseFloat((z/M.width*100).toFixed(2)),W=parseFloat((B/M.height*100).toFixed(2));(s.current!==q||h.current!==W)&&(a(q),s.current=q,u(W),h.current=W,e.maps[t.map2Id].getContainer().style.clipPath=`circle(${f}px at `+s.current*M.width/100+"px "+h.current*M.height/100+"px)")},[e,g,t,f]),S=ee.useCallback(O=>{if(!g())return;const M=e.maps[t.map1Id].getCanvas().getBoundingClientRect();let z=O.clientX,B=O.clientY;z-=M.x,B-=M.y;const q=parseFloat((z/M.width*100).toFixed(2)),W=parseFloat((B/M.height*100).toFixed(2));(s.current!==q||h.current!==W)&&(a(q),s.current=q,u(W),h.current=W,e.maps[t.map2Id].getContainer().style.clipPath=`circle(${f}px at `+s.current*M.width/100+"px "+h.current*M.height/100+"px)")},[e,g,t,f]);ee.useEffect(()=>{!g()||r.current||(r.current=!0,n.current=uJ(e.getMap(t.map1Id).map,e.getMap(t.map2Id).map),S({clientX:s.current,clientY:h.current}),S({clientX:e.maps[t.map1Id].getCanvas().clientWidth/2,clientY:e.maps[t.map1Id].getCanvas().clientHeight/2}))},[e.mapIds,e,g,t,S]);const E=O=>{O.nativeEvent instanceof TouchEvent?(document.addEventListener("touchmove",v),document.addEventListener("touchend",P)):(document.addEventListener("mousemove",S),document.addEventListener("mouseup",k))},P=()=>{document.removeEventListener("touchmove",v),document.removeEventListener("touchend",P)},k=()=>{document.removeEventListener("mousemove",S),document.removeEventListener("mouseup",k)},L=O=>{const M=new WheelEvent(O.type,O);e.map?.map.getCanvas().dispatchEvent(M)};return K.jsx("div",{style:{position:"absolute",left:i+"%",top:o+"%",borderRadius:"50%",width:f*2-2+"px",height:f*2-2+"px",background:"rgba(0,0,0,0)",border:"2px solid #fafafa",boxShadow:"1px 2px 2px rgba(19, 19, 19, .5), inset 1px 1px 1px rgba(19, 19, 19, .2)",cursor:"pointer",zIndex:"110",marginLeft:f*-1-1+"px",marginTop:f*-1-1+"px",textAlign:"center",lineHeight:"91px",fontSize:"2em",color:"#fafafa",userSelect:"none",...t.magnifierStyle},onTouchStart:E,onMouseDown:E,onWheel:L})};try{bV.displayName="MlLayerMagnify",bV.__docgenInfo={description:`
Hides the MapLibreMap referenced by props.map2Id except for the "magnifier"-circle that reveals
the map and can be dragged around on top of the MapLibreMap referenced by props.map1Id`,displayName:"MlLayerMagnify",props:{map1Id:{defaultValue:null,description:"Id of the first MapLibre instance",name:"map1Id",required:!0,type:{name:"string"}},map2Id:{defaultValue:null,description:"Id of the second MapLibre instance",name:"map2Id",required:!0,type:{name:"string"}},magnifierRadius:{defaultValue:null,description:'Size of the "magnifier"-circle',name:"magnifierRadius",required:!1,type:{name:"number | undefined"}},magnifierStyle:{defaultValue:null,description:"object (React.CSSProperties) that is added to the magnifier default style",name:"magnifierStyle",required:!0,type:{name:"CSSProperties | undefined"}}}}}catch{}const Qk=({className:t="",title:e,onClick:r,style:n,color:i})=>K.jsxs("svg",{viewBox:"0 0 47 30",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:t,onClick:r,role:e?"img":"presentation","aria-hidden":!e,style:n,color:i,children:[K.jsx("path",{d:"M29.5 21.25L35.75 15L29.5 8.75V21.25Z",fill:"#009EE0"}),K.jsx("path",{d:"M17.5 8.75L11.25 15L17.5 21.25V8.75Z",fill:"#009EE0"})]});try{Qk.displayName="SwipeIcon",Qk.__docgenInfo={description:"",displayName:"SwipeIcon",props:{className:{defaultValue:{value:""},description:"",name:"className",required:!1,type:{name:"string | undefined"}},title:{defaultValue:null,description:"",name:"title",required:!1,type:{name:"string | undefined"}},onClick:{defaultValue:null,description:"",name:"onClick",required:!1,type:{name:"(() => void) | undefined"}},style:{defaultValue:null,description:"",name:"style",required:!1,type:{name:"CSSProperties | undefined"}},color:{defaultValue:null,description:"",name:"color",required:!1,type:{name:"string | undefined"}}}}}catch{}const xV=t=>{const e=ee.useContext(og),r=ee.useRef(!1),[n,i]=ee.useState(50),a=ee.useRef(0),s=ee.useRef(()=>{}),o=ee.useCallback(()=>!(!t.map1Id||!t.map2Id||!e.getMap(t.map1Id)||!e.getMap(t.map2Id)),[e,t.map1Id,t.map2Id]),u=()=>{s.current()},h=ee.useCallback(E=>{if(!o())return;const P=e.maps[t.map1Id].getCanvas().getBoundingClientRect();let k=typeof E.touches<"u"&&typeof E.touches[0]<"u"?E.touches[0].clientX:0;k-=P.x;const L=parseFloat((k/P.width*100).toFixed(2));if(a.current!==L){i(L),a.current=L;const O="rect(0, "+a.current*P.width/100+"px, 999em, 0)";e.maps[t.map2Id].getContainer().style.clip=O}},[e,o,t.map1Id,t.map2Id]),f=ee.useCallback(E=>{if(!o())return;const P=e.maps[t.map1Id].getCanvas().getBoundingClientRect();let k=E.clientX;k-=P.x;const L=parseFloat((k/P.width*100).toFixed(2));if(a.current!==L){i(L),a.current=L;const O="rect(0, "+a.current*P.width/100+"px, 999em, 0)";e.maps[t.map2Id].getContainer().style.clip=O}},[e,o,t.map1Id,t.map2Id]);ee.useEffect(()=>u,[]),ee.useEffect(()=>{!o()||r.current||(r.current=!0,s.current=uJ(e.getMap(t.map1Id).map,e.getMap(t.map2Id).map),f({clientX:e.maps[t.map1Id].getCanvas().clientWidth/2}))},[e.mapIds,e,t,f,o]);const g=E=>{window?.TouchEvent&&E.nativeEvent instanceof window.TouchEvent?(document.addEventListener("touchmove",h),document.addEventListener("touchend",b)):(document.addEventListener("mousemove",f),document.addEventListener("mouseup",v))},b=()=>{document.removeEventListener("touchmove",h),document.removeEventListener("touchend",b)},v=()=>{document.removeEventListener("mousemove",f),document.removeEventListener("mouseup",v)};function S(){const E=parseFloat(e.maps[t.map2Id].getContainer().style.clip.split(",")[1].replace("px","")),P=e.maps[t.map1Id].getCanvas().getBoundingClientRect().width;if(E<P){const k=parseFloat((E/P*100).toFixed(2));i(k)}else{const k="rect(0, "+P/2+"px, 999em, 0)";e.maps[t.map2Id].getContainer().style.clip=k,i(50)}}return ee.useEffect(()=>(window.addEventListener("resize",S),()=>{window.removeEventListener("resize",S)}),[e]),K.jsx("div",{style:{position:"absolute",left:n+"%",top:"50%",borderRadius:"50%",width:"65px",height:"65px",background:"rgba(234, 235, 241, 0.75)",border:"2px solid rgba(0, 158, 224, 0.75)",cursor:"pointer",zIndex:"110",marginLeft:"-35px",marginTop:"-50px",textAlign:"center",lineHeight:"91px",fontSize:"2em",color:"#fafafa",userSelect:"none",...t.buttonStyle},onTouchStart:g,onMouseDown:g,children:K.jsx(Qk,{color:"#0066ff",style:{width:"65px",height:"65px",justifyContent:"center",zIndex:1100}})})};try{xV.displayName="MlLayerSwipe",xV.__docgenInfo={description:"creates a split view of 2 synchronised maplibre instances",displayName:"MlLayerSwipe",props:{map1Id:{defaultValue:null,description:"Id of the first MapLibre instance.",name:"map1Id",required:!0,type:{name:"string"}},map2Id:{defaultValue:null,description:"Id of the second MapLibre instance.",name:"map2Id",required:!0,type:{name:"string"}},buttonStyle:{defaultValue:null,description:"object (React.CSSProperties) that is added to the button default style",name:"buttonStyle",required:!0,type:{name:"CSSProperties | undefined"}}}}}catch{}const cJ=function(t,e,r,n,i,a,s,o,u){if(typeof n.current[a.current]<"u"){const h=a.current+1===n.current.length?t.geojson:gu([...i.current,...n.current[a.current].geometry.coordinates]);u(h),typeof t.onTransitionFrame=="function"&&t.onTransitionFrame(h),a.current++,r.current&&a.current<n.current.length?o.current=setTimeout(()=>cJ(...arguments),s):(typeof t.onTransitionEnd=="function"&&t.onTransitionEnd(t.geojson),r.current=!1)}},RIe=(t,e,r,n,i,a,s,o,u,h)=>{const f=[],g=[];let b=[],v=[];e.current=[];const S=i.current||{geometry:{type:"LineString",coordinates:[]},properties:{},type:"Feature"},E=t.geojson;let P=E,k=S,L=!1;if(typeof P.geometry>"u"&&typeof k.geometry<"u"&&k.geometry.coordinates.length>1)P=gu(k.geometry.coordinates.slice(0,2));else if(typeof k.geometry>"u"&&typeof P.geometry<"u"&&P.geometry.coordinates.length>1)k=gu(P.geometry.coordinates.slice(0,2));else if(typeof k.geometry>"u"&&typeof P.geometry>"u")return;if(P.geometry.coordinates.length<k.geometry.coordinates.length&&(P=S,k=E,L=!0),P&&k)for(let oe=0,ce=P.geometry.coordinates.length;oe<ce;oe++)typeof k.geometry.coordinates[oe]<"u"&&P.geometry.coordinates[oe][0]===k.geometry.coordinates[oe][0]&&P.geometry.coordinates[oe][1]===k.geometry.coordinates[oe][1]?e.current.push(P.geometry.coordinates[oe]):(typeof P.geometry.coordinates[oe]<"u"&&g.push(P.geometry.coordinates[oe]),typeof k.geometry.coordinates[oe]<"u"&&f.push(k.geometry.coordinates[oe]));if(L?(b=f,v=g):(b=g,v=f),b.length<2&&v<2)return;const O=t.transitionTime/a,M=v.length>1?Math.round(hb(gu(v))):0,z=b.length>1?Math.round(hb(gu(b))):0,B=z+M,q=M/B,W=Math.round(O*q),G=Math.round(M/W*100)/100,ie=z/B,Q=Math.round(O*ie),H=Math.round(z/Q*100)/100;let ne;ne=[...wV(v,G,W)],ne.reverse(),ne=[...ne,...wV(b,H,Q)],ne.push(E),r.current=ne,s.current=1,n.current=!0,u.current=setTimeout(()=>cJ(t,o,n,r,e,s,a,u,h),a)},wV=(t,e,r)=>{const n=[];if(t.length>1){const i=Qxe(gu(t),e);let a=i.features[0];for(let s=0;s<r&&(n.push(a),typeof i.features[s]<"u");s++)a=gu([...a.geometry.coordinates,...i.features[s].geometry.coordinates])}return n},OIe=50,SV=t=>{const{geojson:e,...r}=t,n=ha({mapId:t.mapId,waitForLayer:t.insertBeforeLayer}),i=ee.useRef(!1),a=ee.useRef(null),s=ee.useRef(!1),o=ee.useRef(void 0),u=ee.useRef(!1),h=ee.useRef([]),f=ee.useRef([]),[g,b]=ee.useState(Xd([]));ee.useEffect(()=>()=>{o.current&&clearTimeout(o.current)},[]);const v=ee.useCallback(()=>{RIe(t,f,h,s,a,OIe,u,n.map,o,b)},[t,n.map]);ee.useEffect(()=>{!n.map||!i.current||(typeof t.transitionTime<"u"&&t.type==="line"&&a.current&&(s.current=!1,u.current=!1,h.current=[],f.current=[],v()),t.geojson&&(a.current=t.geojson))},[n.map,v,t]);const S=ee.useCallback(()=>{t.type==="line"&&typeof t.transitionTime<"u"&&t.transitionTime&&typeof t.geojson<"u"&&JSON.stringify(a.current)!==JSON.stringify(t.geojson)&&(v(),a.current=t.geojson)},[t,v]);return ee.useEffect(()=>{!n.mapIsReady||!t.geojson||(i.current=!0,S())},[n.mapIsReady,S,t]),K.jsx(K.Fragment,{children:K.jsx(wc,{...r,geojson:g})})};try{SV.displayName="MlTransitionGeoJsonLayer",SV.__docgenInfo={description:'Adds source and layer of types "line", "fill" or "circle" to display GeoJSON data on the map.',displayName:"MlTransitionGeoJsonLayer",props:{mapId:{defaultValue:null,description:"Id of the target MapLibre instance in mapContext",name:"mapId",required:!1,type:{name:"string | undefined"}},insertBeforeLayer:{defaultValue:null,description:`Id of an existing layer in the mapLibre instance to help specify the layer order
This layer will be visually beneath the layer with the "insertBeforeLayer" id.
This layer will not be added to the maplibre-gl instance until a layer with an
id that matches the value of insertBeforeLayer is created.`,name:"insertBeforeLayer",required:!1,type:{name:"string | undefined"}},layerId:{defaultValue:null,description:"Id of the new layer and source that are added to the MapLibre instance",name:"layerId",required:!1,type:{name:"string | undefined"}},geojson:{defaultValue:null,description:"GeoJSON data that is supposed to be rendered by this component.",name:"geojson",required:!1,type:{name:"Feature<Geometry, GeoJsonProperties> | FeatureCollection<Geometry, GeoJsonProperties> | undefined"}},type:{defaultValue:null,description:`Type of the layer that will be added to the MapLibre instance.
All types from LayerSpecification union type are supported except the type from
RasterLayerSpecification`,name:"type",required:!1,type:{name:"enum",value:[{value:"undefined"},{value:'"symbol"'},{value:'"fill"'},{value:'"background"'},{value:'"circle"'},{value:'"line"'},{value:'"heatmap"'},{value:'"fill-extrusion"'},{value:'"hillshade"'},{value:'"color-relief"'}]}},paint:{defaultValue:null,description:`@deprecated The property should not be used. Please use the options.paint property instead. This will be removed in the next major release.
Paint property object, that is passed to the addLayer call.
Possible props depend on the layer type.
See https://maplibre.org/maplibre-gl-js-docs/style-spec/layers/
Some examples are:
https://maplibre.org/maplibre-gl-js-docs/style-spec/layers/#line
https://maplibre.org/maplibre-gl-js-docs/style-spec/layers/#circle
https://maplibre.org/maplibre-gl-js-docs/style-spec/layers/#fill
All paint types from LayerSpecification union type are supported except the paint type from
RasterLayerSpecification`,name:"paint",required:!1,type:{name:'{ "circle-radius"?: DataDrivenPropertyValueSpecification<number> | undefined; "circle-color"?: DataDrivenPropertyValueSpecification<string> | undefined; ... 8 more ...; "circle-stroke-opacity"?: DataDrivenPropertyValueSpecification<...> | undefined; } | ... 8 more ... | undefined'}},layout:{defaultValue:null,description:`@deprecated The property should not be used. Please use the options.layout property instead. This will be removed in the next major release.
Layout property object, that is passed to the addLayer call.
Possible props depend on the layer type.
See https://maplibre.org/maplibre-gl-js-docs/style-spec/layers/
Some examples are:
https://maplibre.org/maplibre-gl-js-docs/style-spec/layers/#line
https://maplibre.org/maplibre-gl-js-docs/style-spec/layers/#circle
https://maplibre.org/maplibre-gl-js-docs/style-spec/layers/#fill
All layout types from LayerSpecification union type are supported except the layout type from
RasterLayerSpecification`,name:"layout",required:!1,type:{name:'{ "circle-sort-key"?: DataDrivenPropertyValueSpecification<number> | undefined; visibility?: "none" | "visible" | undefined; } | { "fill-sort-key"?: DataDrivenPropertyValueSpecification<...> | undefined; visibility?: "none" | ... 1 more ... | undefined; } | ... 8 more ... | undefined'}},options:{defaultValue:null,description:"Javascript object that is spread into the addLayer commands first parameter.",name:"options",required:!1,type:{name:"Partial<LayerSpecification & { source?: string | GeoJSONSourceSpecification | undefined; id?: string | undefined; filter?: FilterSpecification | undefined; }> | undefined"}},defaultPaintOverrides:{defaultValue:null,description:'Javascript object with optional properties "fill", "line", "circle" to override implicit layer type default paint properties.',name:"defaultPaintOverrides",required:!1,type:{name:'{ circle?: { "circle-radius"?: DataDrivenPropertyValueSpecification<number> | undefined; "circle-color"?: DataDrivenPropertyValueSpecification<string> | undefined; ... 8 more ...; "circle-stroke-opacity"?: DataDrivenPropertyValueSpecification<...> | undefined; } | undefined; fill?: { ...; } | undefined; line?: { ......'}},labelProp:{defaultValue:null,description:"Property name in the GeoJSON object to be used as a label.",name:"labelProp",required:!1,type:{name:"string | undefined"}},labelOptions:{defaultValue:null,description:"Label configuration options.",name:"labelOptions",required:!1,type:{name:"Partial<LayerSpecification & { source?: string | GeoJSONSourceSpecification | undefined; id?: string | undefined; filter?: FilterSpecification | undefined; }> | undefined"}},onHover:{defaultValue:null,description:"Hover event handler that is executed whenever a geometry rendered by this component is hovered.",name:"onHover",required:!1,type:{name:"((ev: MapEventType) => void | Map$1) | undefined"}},onClick:{defaultValue:null,description:"Click event handler that is executed whenever a geometry rendered by this component is clicked.",name:"onClick",required:!1,type:{name:"((ev: MapEventType) => void | Map$1) | undefined"}},onLeave:{defaultValue:null,description:`Leave event handler that is executed whenever a geometry rendered by this component is
left/unhovered.`,name:"onLeave",required:!1,type:{name:"((ev: MapEventType) => void | Map$1) | undefined"}},transitionTime:{defaultValue:null,description:"",name:"transitionTime",required:!1,type:{name:"number | undefined"}}}}}catch{}const LIe=(t="top")=>{switch(t){case"bottom":return"translate(-50%, 0%)";case"left":return"translate(-100%, -50%)";case"right":return"translate(0%, -50%)";case"top-left":return"translate(-100%, -100%)";case"top-right":return"translate(0%, -100%)";case"bottom-left":return"translate(-100%, 0%)";case"bottom-right":return"translate(0%, 0%)";default:case"top":return"translate(-50%, -100%)"}};function NIe(t,e,r){const n=parseInt(String(r?.width||14),10),i=parseInt(String(r?.height||14),10),a={};switch(t){case"bottom":a.marginTop=`${e}px`;break;case"left":a.marginLeft=`-${e}px`;break;case"right":a.marginLeft=`${n+e}px`;break;case"top-left":a.marginTop=`-${i+e}px`,a.marginLeft=`-${e}px`;break;case"top-right":a.marginTop=`-${i+e}px`,a.marginLeft=`${n+e}px`;break;case"bottom-left":a.marginTop=`${e}px`,a.marginLeft=`-${e}px`;break;case"bottom-right":a.marginTop=`${e}px`,a.marginLeft=`${n+e}px`;break;case"top":default:a.marginTop=`-${i+e}px`;break}return a}const eM=({passEventsThrough:t=!0,contentOffset:e=5,...r})=>{const n=ha({mapId:r.mapId,waitForLayer:r.insertBeforeLayer}),[i,a]=ee.useState(null),s=ee.useRef(null),o=ee.useRef(null);ee.useEffect(()=>{if(!n.map)return;s.current=document.createElement("div");const f={...{width:"12px",height:"12px",background:"linear-gradient(135deg, rgb(186, 208, 218) 0%, rgb(96, 209, 253) 100%)",border:"1px solid rgba(255, 255, 255, 0.7)",boxShadow:"0 2px 6px rgba(90, 0, 0, 0.2), 0 0 0 2px rgba(240, 147, 251, 0.2)",borderRadius:"50%"},...r.markerStyle},g=new lP.Marker({element:s.current,anchor:"center"}).setLngLat([r.lng,r.lat]).addTo(n.map.map);a(g);const b=document.createElement("div");return Object.entries(f).forEach(([v,S])=>{b.style.setProperty(v.replace(/([A-Z])/g,"-$1").toLowerCase(),String(S))}),s.current.appendChild(b),()=>{b.remove(),g.remove(),s.current?.remove()}},[n.map,r.lng,r.lat,r.markerStyle,r.anchor]),ee.useEffect(()=>{i&&i.setLngLat([r.lng,r.lat])},[i,r.lng,r.lat]);function u(){const h=o.current?.contentWindow?.document;if(h&&o.current?.parentElement){const f=h.documentElement.scrollHeight;o.current.parentElement.style.height=`${f}px`}}return s.current&&Nd.createPortal(K.jsx(Vo,{sx:{position:"absolute",display:"flex",width:"300px",maxHeight:"500px",opacity:t?1:.7,zIndex:-1,transform:LIe(r.anchor),...NIe(r.anchor,e,r.markerStyle),pointerEvents:t?"none":"auto","&:hover":{opacity:1},...r.containerStyle},children:K.jsx("iframe",{ref:o,onLoad:u,style:{width:"100%",borderStyle:"none",...r.iframeStyle},srcDoc:`<div>
	<style>
		body {
			${Object.entries(r.iframeBodyStyle||{}).map(([h,f])=>`${h.replace(/([A-Z])/g,"-$1").toLowerCase()}: ${f};`).join(" ")}
		}
	</style>
	${r.content||""}
</div>`,sandbox:"allow-same-origin allow-popups-to-escape-sandbox allow-scripts",title:n.componentId})}),s.current)};try{eM.displayName="MlMarker",eM.__docgenInfo={description:"",displayName:"MlMarker",props:{mapId:{defaultValue:null,description:"ID of the map to add the marker to",name:"mapId",required:!1,type:{name:"string | undefined"}},insertBeforeLayer:{defaultValue:null,description:"Layer ID before which to insert the marker",name:"insertBeforeLayer",required:!1,type:{name:"string | undefined"}},lng:{defaultValue:null,description:"Longitude of the marker position",name:"lng",required:!0,type:{name:"number"}},lat:{defaultValue:null,description:"Latitude of the marker position",name:"lat",required:!0,type:{name:"number"}},content:{defaultValue:null,description:"HTML content for the marker popup",name:"content",required:!1,type:{name:"string | undefined"}},markerStyle:{defaultValue:null,description:"CSS properties to apply to the marker dot",name:"markerStyle",required:!1,type:{name:"CSSProperties | undefined"}},containerStyle:{defaultValue:null,description:"CSS properties to apply to the content container",name:"containerStyle",required:!1,type:{name:"CSSProperties | undefined"}},iframeStyle:{defaultValue:null,description:"CSS properties to apply to the iframe element",name:"iframeStyle",required:!1,type:{name:"CSSProperties | undefined"}},iframeBodyStyle:{defaultValue:null,description:"CSS properties to apply to the body of the iframe",name:"iframeBodyStyle",required:!1,type:{name:"CSSProperties | undefined"}},contentOffset:{defaultValue:{value:"5"},description:"Offset in pixels between the marker and its content",name:"contentOffset",required:!1,type:{name:"number | undefined"}},passEventsThrough:{defaultValue:{value:"true"},description:"Whether mouse events pass through the marker content",name:"passEventsThrough",required:!1,type:{name:"boolean | undefined"}},anchor:{defaultValue:null,description:"Anchor position of the marker relative to its coordinates",name:"anchor",required:!1,type:{name:"enum",value:[{value:"undefined"},{value:'"bottom"'},{value:'"left"'},{value:'"right"'},{value:'"top"'},{value:'"top-left"'},{value:'"top-right"'},{value:'"bottom-left"'},{value:'"bottom-right"'}]}}}}}catch{}var pa={},Xl={},EV;function W0(){if(EV)return Xl;EV=1;function t(k,L,O){if(O===void 0&&(O=Array.prototype),k&&typeof O.find=="function")return O.find.call(k,L);for(var M=0;M<k.length;M++)if(r(k,M)){var z=k[M];if(L.call(void 0,z,M,k))return z}}function e(k,L){return L===void 0&&(L=Object),L&&typeof L.getOwnPropertyDescriptors=="function"&&(k=L.create(null,L.getOwnPropertyDescriptors(k))),L&&typeof L.freeze=="function"?L.freeze(k):k}function r(k,L){return Object.prototype.hasOwnProperty.call(k,L)}function n(k,L){if(k===null||typeof k!="object")throw new TypeError("target is not an object");for(var O in L)r(L,O)&&(k[O]=L[O]);return k}var i=e({allowfullscreen:!0,async:!0,autofocus:!0,autoplay:!0,checked:!0,controls:!0,default:!0,defer:!0,disabled:!0,formnovalidate:!0,hidden:!0,ismap:!0,itemscope:!0,loop:!0,multiple:!0,muted:!0,nomodule:!0,novalidate:!0,open:!0,playsinline:!0,readonly:!0,required:!0,reversed:!0,selected:!0});function a(k){return r(i,k.toLowerCase())}var s=e({area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function o(k){return r(s,k.toLowerCase())}var u=e({script:!1,style:!1,textarea:!0,title:!0});function h(k){var L=k.toLowerCase();return r(u,L)&&!u[L]}function f(k){var L=k.toLowerCase();return r(u,L)&&u[L]}function g(k){return k===v.HTML}function b(k){return g(k)||k===v.XML_XHTML_APPLICATION}var v=e({HTML:"text/html",XML_APPLICATION:"application/xml",XML_TEXT:"text/xml",XML_XHTML_APPLICATION:"application/xhtml+xml",XML_SVG_IMAGE:"image/svg+xml"}),S=Object.keys(v).map(function(k){return v[k]});function E(k){return S.indexOf(k)>-1}var P=e({HTML:"http://www.w3.org/1999/xhtml",SVG:"http://www.w3.org/2000/svg",XML:"http://www.w3.org/XML/1998/namespace",XMLNS:"http://www.w3.org/2000/xmlns/"});return Xl.assign=n,Xl.find=t,Xl.freeze=e,Xl.HTML_BOOLEAN_ATTRIBUTES=i,Xl.HTML_RAW_TEXT_ELEMENTS=u,Xl.HTML_VOID_ELEMENTS=s,Xl.hasDefaultHTMLNamespace=b,Xl.hasOwn=r,Xl.isHTMLBooleanAttribute=a,Xl.isHTMLRawTextElement=h,Xl.isHTMLEscapableRawTextElement=f,Xl.isHTMLMimeType=g,Xl.isHTMLVoidElement=o,Xl.isValidMimeType=E,Xl.MIME_TYPE=v,Xl.NAMESPACE=P,Xl}var Uy={},TV;function FT(){if(TV)return Uy;TV=1;var t=W0();function e(b,v){b.prototype=Object.create(Error.prototype,{constructor:{value:b},name:{value:b.name,enumerable:!0,writable:v}})}var r=t.freeze({Error:"Error",IndexSizeError:"IndexSizeError",DomstringSizeError:"DomstringSizeError",HierarchyRequestError:"HierarchyRequestError",WrongDocumentError:"WrongDocumentError",InvalidCharacterError:"InvalidCharacterError",NoDataAllowedError:"NoDataAllowedError",NoModificationAllowedError:"NoModificationAllowedError",NotFoundError:"NotFoundError",NotSupportedError:"NotSupportedError",InUseAttributeError:"InUseAttributeError",InvalidStateError:"InvalidStateError",SyntaxError:"SyntaxError",InvalidModificationError:"InvalidModificationError",NamespaceError:"NamespaceError",InvalidAccessError:"InvalidAccessError",ValidationError:"ValidationError",TypeMismatchError:"TypeMismatchError",SecurityError:"SecurityError",NetworkError:"NetworkError",AbortError:"AbortError",URLMismatchError:"URLMismatchError",QuotaExceededError:"QuotaExceededError",TimeoutError:"TimeoutError",InvalidNodeTypeError:"InvalidNodeTypeError",DataCloneError:"DataCloneError",EncodingError:"EncodingError",NotReadableError:"NotReadableError",UnknownError:"UnknownError",ConstraintError:"ConstraintError",DataError:"DataError",TransactionInactiveError:"TransactionInactiveError",ReadOnlyError:"ReadOnlyError",VersionError:"VersionError",OperationError:"OperationError",NotAllowedError:"NotAllowedError",OptOutError:"OptOutError"}),n=Object.keys(r);function i(b){return typeof b=="number"&&b>=1&&b<=25}function a(b){return typeof b=="string"&&b.substring(b.length-r.Error.length)===r.Error}function s(b,v){i(b)?(this.name=n[b],this.message=v||""):(this.message=b,this.name=a(v)?v:r.Error),Error.captureStackTrace&&Error.captureStackTrace(this,s)}e(s,!0),Object.defineProperties(s.prototype,{code:{enumerable:!0,get:function(){var b=n.indexOf(this.name);return i(b)?b:0}}});for(var o={INDEX_SIZE_ERR:1,DOMSTRING_SIZE_ERR:2,HIERARCHY_REQUEST_ERR:3,WRONG_DOCUMENT_ERR:4,INVALID_CHARACTER_ERR:5,NO_DATA_ALLOWED_ERR:6,NO_MODIFICATION_ALLOWED_ERR:7,NOT_FOUND_ERR:8,NOT_SUPPORTED_ERR:9,INUSE_ATTRIBUTE_ERR:10,INVALID_STATE_ERR:11,SYNTAX_ERR:12,INVALID_MODIFICATION_ERR:13,NAMESPACE_ERR:14,INVALID_ACCESS_ERR:15,VALIDATION_ERR:16,TYPE_MISMATCH_ERR:17,SECURITY_ERR:18,NETWORK_ERR:19,ABORT_ERR:20,URL_MISMATCH_ERR:21,QUOTA_EXCEEDED_ERR:22,TIMEOUT_ERR:23,INVALID_NODE_TYPE_ERR:24,DATA_CLONE_ERR:25},u=Object.entries(o),h=0;h<u.length;h++){var f=u[h][0];s[f]=u[h][1]}function g(b,v){this.message=b,this.locator=v,Error.captureStackTrace&&Error.captureStackTrace(this,g)}return e(g),Uy.DOMException=s,Uy.DOMExceptionName=r,Uy.ExceptionCode=o,Uy.ParseError=g,Uy}var ks={},Zi={},CV;function hJ(){if(CV)return Zi;CV=1;function t(Ur){try{typeof Ur!="function"&&(Ur=RegExp);var Gr=new Ur("","u").exec("");return!!Gr&&Gr[0].length===2}catch{}return!1}var e=t();function r(Ur){if(Ur.source[0]!=="[")throw new Error(Ur+" can not be used with chars");return Ur.source.slice(1,Ur.source.lastIndexOf("]"))}function n(Ur,Gr){if(Ur.source[0]!=="[")throw new Error("/"+Ur.source+"/ can not be used with chars_without");if(!Gr||typeof Gr!="string")throw new Error(JSON.stringify(Gr)+" is not a valid search");if(Ur.source.indexOf(Gr)===-1)throw new Error('"'+Gr+'" is not is /'+Ur.source+"/");if(Gr==="-"&&Ur.source.indexOf(Gr)!==1)throw new Error('"'+Gr+'" is not at the first postion of /'+Ur.source+"/");return new RegExp(Ur.source.replace(Gr,""),e?"u":"")}function i(Ur){var Gr=this;return new RegExp(Array.prototype.slice.call(arguments).map(function(Jr){var ar=typeof Jr=="string";if(ar&&Gr===void 0&&Jr==="|")throw new Error("use regg instead of reg to wrap expressions with `|`!");return ar?Jr:Jr.source}).join(""),e?"mu":"m")}function a(Ur){if(arguments.length===0)throw new Error("no parameters provided");return i.apply(a,["(?:"].concat(Array.prototype.slice.call(arguments),[")"]))}var s="",o=/[-\x09\x0A\x0D\x20-\x2C\x2E-\uD7FF\uE000-\uFFFD]/;e&&(o=i("[",r(o),"\\u{10000}-\\u{10FFFF}","]"));var u=/[\x20\x09\x0D\x0A]/,h=r(u),f=i(u,"+"),g=i(u,"*"),b=/[:_a-zA-Z\xC0-\xD6\xD8-\xF6\xF8-\u02FF\u0370-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/;e&&(b=i("[",r(b),"\\u{10000}-\\u{10FFFF}","]"));var v=r(b),S=i("[",v,r(/[-.0-9\xB7]/),r(/[\u0300-\u036F\u203F-\u2040]/),"]"),E=i(b,S,"*"),P=i(S,"+"),k=i("&",E,";"),L=a(/&#[0-9]+;|&#x[0-9a-fA-F]+;/),O=a(k,"|",L),M=i("%",E,";"),z=a(i('"',a(/[^%&"]/,"|",M,"|",O),"*",'"'),"|",i("'",a(/[^%&']/,"|",M,"|",O),"*","'")),B=a('"',a(/[^<&"]/,"|",O),"*",'"',"|","'",a(/[^<&']/,"|",O),"*","'"),q=n(b,":"),W=n(S,":"),G=i(q,W,"*"),ie=i(G,a(":",G),"?"),Q=i("^",ie,"$"),H=i("(",ie,")"),ne=a(/"[^"]*"|'[^']*'/),oe=i(/^<\?/,"(",E,")",a(f,"(",o,"*?)"),"?",/\?>/),ce=/[\x20\x0D\x0Aa-zA-Z0-9-'()+,./:=?;!*#@$_%]/,fe=a('"',ce,'*"',"|","'",n(ce,"'"),"*'"),Me="<!--",me="-->",we=i(Me,a(n(o,"-"),"|",i("-",n(o,"-"))),"*",me),Te="#PCDATA",ke=a(i(/\(/,g,Te,a(g,/\|/,g,ie),"*",g,/\)\*/),"|",i(/\(/,g,Te,g,/\)/)),he=/[?*+]?/,Ee=i(/\([^>]+\)/,he),xe=a("EMPTY","|","ANY","|",ke,"|",Ee),Ne="<!ELEMENT",Oe=i(Ne,f,a(ie,"|",M),f,a(xe,"|",M),g,">"),$e=i("NOTATION",f,/\(/,g,E,a(g,/\|/,g,E),"*",g,/\)/),De=i(/\(/,g,P,a(g,/\|/,g,P),"*",g,/\)/),it=a($e,"|",De),Ye=a(/CDATA|ID|IDREF|IDREFS|ENTITY|ENTITIES|NMTOKEN|NMTOKENS/,"|",it),rt=a(/#REQUIRED|#IMPLIED/,"|",a(a("#FIXED",f),"?",B)),Ie=a(f,E,f,Ye,f,rt),Mt="<!ATTLIST",at=i(Mt,f,E,Ie,"*",g,">"),je="about:legacy-compat",Xt=a('"'+je+'"',"|","'"+je+"'"),Yt="SYSTEM",pr="PUBLIC",vt=a(a(Yt,f,ne),"|",a(pr,f,fe,f,ne)),yr=i("^",a(a(Yt,f,"(?<SystemLiteralOnly>",ne,")"),"|",a(pr,f,"(?<PubidLiteral>",fe,")",f,"(?<SystemLiteral>",ne,")"))),_r=a(f,"NDATA",f,E),cr=a(z,"|",a(vt,_r,"?")),Er="<!ENTITY",wr=i(Er,f,E,f,cr,g,">"),er=a(z,"|",vt),lr=i(Er,f,"%",f,E,f,er,g,">"),Ar=a(wr,"|",lr),ir=i(pr,f,fe),nt=i("<!NOTATION",f,E,f,a(vt,"|",ir),g,">"),_e=i(g,"=",g),be=/1[.]\d+/,qe=i(f,"version",_e,a("'",be,"'","|",'"',be,'"')),Qe=/[A-Za-z][-A-Za-z0-9._]*/,ot=a(f,"encoding",_e,a('"',Qe,'"',"|","'",Qe,"'")),et=a(f,"standalone",_e,a("'",a("yes","|","no"),"'","|",'"',a("yes","|","no"),'"')),Lt=i(/^<\?xml/,qe,ot,"?",et,"?",g,/\?>/),_t="<!DOCTYPE",jt="<![CDATA[",Jt="]]>",Kt=/<!\[CDATA\[/,Rr=/\]\]>/,bt=i(o,"*?",Rr),Tr=i(Kt,bt);return Zi.chars=r,Zi.chars_without=n,Zi.detectUnicodeSupport=t,Zi.reg=i,Zi.regg=a,Zi.ABOUT_LEGACY_COMPAT=je,Zi.ABOUT_LEGACY_COMPAT_SystemLiteral=Xt,Zi.AttlistDecl=at,Zi.CDATA_START=jt,Zi.CDATA_END=Jt,Zi.CDSect=Tr,Zi.Char=o,Zi.Comment=we,Zi.COMMENT_START=Me,Zi.COMMENT_END=me,Zi.DOCTYPE_DECL_START=_t,Zi.elementdecl=Oe,Zi.EntityDecl=Ar,Zi.EntityValue=z,Zi.ExternalID=vt,Zi.ExternalID_match=yr,Zi.Name=E,Zi.NotationDecl=nt,Zi.Reference=O,Zi.PEReference=M,Zi.PI=oe,Zi.PUBLIC=pr,Zi.PubidLiteral=fe,Zi.QName=ie,Zi.QName_exact=Q,Zi.QName_group=H,Zi.S=f,Zi.SChar_s=h,Zi.S_OPT=g,Zi.SYSTEM=Yt,Zi.SystemLiteral=ne,Zi.UNICODE_REPLACEMENT_CHARACTER=s,Zi.UNICODE_SUPPORT=e,Zi.XMLDecl=Lt,Zi}var AV;function fJ(){if(AV)return ks;AV=1;var t=W0(),e=t.find,r=t.hasDefaultHTMLNamespace,n=t.hasOwn,i=t.isHTMLMimeType,a=t.isHTMLRawTextElement,s=t.isHTMLVoidElement,o=t.MIME_TYPE,u=t.NAMESPACE,h=Symbol(),f=FT(),g=f.DOMException,b=f.DOMExceptionName,v=hJ();function S(Ae){if(Ae!==h)throw new TypeError("Illegal constructor")}function E(Ae){return Ae!==""}function P(Ae){return Ae?Ae.split(/[\t\n\f\r ]+/).filter(E):[]}function k(Ae,Be){return n(Ae,Be)||(Ae[Be]=!0),Ae}function L(Ae){if(!Ae)return[];var Be=P(Ae);return Object.keys(Be.reduce(k,{}))}function O(Ae){return function(Be){return Ae&&Ae.indexOf(Be)!==-1}}function M(Ae){if(!v.QName_exact.test(Ae))throw new g(g.INVALID_CHARACTER_ERR,'invalid character in qualified name "'+Ae+'"')}function z(Ae,Be){M(Be),Ae=Ae||null;var mt=null,pt=Be;if(Be.indexOf(":")>=0){var Ir=Be.split(":");mt=Ir[0],pt=Ir[1]}if(mt!==null&&Ae===null)throw new g(g.NAMESPACE_ERR,"prefix is non-null and namespace is null");if(mt==="xml"&&Ae!==t.NAMESPACE.XML)throw new g(g.NAMESPACE_ERR,'prefix is "xml" and namespace is not the XML namespace');if((mt==="xmlns"||Be==="xmlns")&&Ae!==t.NAMESPACE.XMLNS)throw new g(g.NAMESPACE_ERR,'either qualifiedName or prefix is "xmlns" and namespace is not the XMLNS namespace');if(Ae===t.NAMESPACE.XMLNS&&mt!=="xmlns"&&Be!=="xmlns")throw new g(g.NAMESPACE_ERR,'namespace is the XMLNS namespace and neither qualifiedName nor prefix is "xmlns"');return[Ae,mt,pt]}function B(Ae,Be){for(var mt in Ae)n(Ae,mt)&&(Be[mt]=Ae[mt])}function q(Ae,Be){var mt=Ae.prototype;if(!(mt instanceof Be)){let pt=function(){};pt.prototype=Be.prototype,pt=new pt,B(mt,pt),Ae.prototype=mt=pt}mt.constructor!=Ae&&(typeof Ae!="function"&&console.error("unknown Class:"+Ae),mt.constructor=Ae)}var W={},G=W.ELEMENT_NODE=1,ie=W.ATTRIBUTE_NODE=2,Q=W.TEXT_NODE=3,H=W.CDATA_SECTION_NODE=4,ne=W.ENTITY_REFERENCE_NODE=5,oe=W.ENTITY_NODE=6,ce=W.PROCESSING_INSTRUCTION_NODE=7,fe=W.COMMENT_NODE=8,Me=W.DOCUMENT_NODE=9,me=W.DOCUMENT_TYPE_NODE=10,we=W.DOCUMENT_FRAGMENT_NODE=11,Te=W.NOTATION_NODE=12,ke=t.freeze({DOCUMENT_POSITION_DISCONNECTED:1,DOCUMENT_POSITION_PRECEDING:2,DOCUMENT_POSITION_FOLLOWING:4,DOCUMENT_POSITION_CONTAINS:8,DOCUMENT_POSITION_CONTAINED_BY:16,DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC:32});function he(Ae,Be){if(Be.length<Ae.length)return he(Be,Ae);var mt=null;for(var pt in Ae){if(Ae[pt]!==Be[pt])return mt;mt=Ae[pt]}return mt}function Ee(Ae){return Ae.guid||(Ae.guid=Math.random()),Ae.guid}function xe(){}xe.prototype={length:0,item:function(Ae){return Ae>=0&&Ae<this.length?this[Ae]:null},toString:function(Ae){for(var Be=[],mt=0;mt<this.length;mt++)ar(this[mt],Be,Ae);return Be.join("")},filter:function(Ae){return Array.prototype.filter.call(this,Ae)},indexOf:function(Ae){return Array.prototype.indexOf.call(this,Ae)}},xe.prototype[Symbol.iterator]=function(){var Ae=this,Be=0;return{next:function(){return Be<Ae.length?{value:Ae[Be++],done:!1}:{done:!0}},return:function(){return{done:!0}}}};function Ne(Ae,Be){this._node=Ae,this._refresh=Be,Oe(this)}function Oe(Ae){var Be=Ae._node._inc||Ae._node.ownerDocument._inc;if(Ae._inc!==Be){var mt=Ae._refresh(Ae._node);if(ri(Ae,"length",mt.length),!Ae.$$length||mt.length<Ae.$$length)for(var pt=mt.length;pt in Ae;pt++)n(Ae,pt)&&delete Ae[pt];B(mt,Ae),Ae._inc=Be}}Ne.prototype.item=function(Ae){return Oe(this),this[Ae]||null},q(Ne,xe);function $e(){}function De(Ae,Be){for(var mt=0;mt<Ae.length;){if(Ae[mt]===Be)return mt;mt++}}function it(Ae,Be,mt,pt){if(pt?Be[De(Be,pt)]=mt:(Be[Be.length]=mt,Be.length++),Ae){mt.ownerElement=Ae;var Ir=Ae.ownerDocument;Ir&&(pt&&Yt(Ir,Ae,pt),Xt(Ir,Ae,mt))}}function Ye(Ae,Be,mt){var pt=De(Be,mt);if(pt>=0){for(var Ir=Be.length-1;pt<=Ir;)Be[pt]=Be[++pt];if(Be.length=Ir,Ae){var Fr=Ae.ownerDocument;Fr&&Yt(Fr,Ae,mt),mt.ownerElement=null}}}$e.prototype={length:0,item:xe.prototype.item,getNamedItem:function(Ae){this._ownerElement&&this._ownerElement._isInHTMLDocumentAndNamespace()&&(Ae=Ae.toLowerCase());for(var Be=0;Be<this.length;){var mt=this[Be];if(mt.nodeName===Ae)return mt;Be++}return null},setNamedItem:function(Ae){var Be=Ae.ownerElement;if(Be&&Be!==this._ownerElement)throw new g(g.INUSE_ATTRIBUTE_ERR);var mt=this.getNamedItemNS(Ae.namespaceURI,Ae.localName);return mt===Ae?Ae:(it(this._ownerElement,this,Ae,mt),mt)},setNamedItemNS:function(Ae){return this.setNamedItem(Ae)},removeNamedItem:function(Ae){var Be=this.getNamedItem(Ae);if(!Be)throw new g(g.NOT_FOUND_ERR,Ae);return Ye(this._ownerElement,this,Be),Be},removeNamedItemNS:function(Ae,Be){var mt=this.getNamedItemNS(Ae,Be);if(!mt)throw new g(g.NOT_FOUND_ERR,Ae?Ae+" : "+Be:Be);return Ye(this._ownerElement,this,mt),mt},getNamedItemNS:function(Ae,Be){Ae||(Ae=null);for(var mt=0;mt<this.length;){var pt=this[mt];if(pt.localName===Be&&pt.namespaceURI===Ae)return pt;mt++}return null}},$e.prototype[Symbol.iterator]=function(){var Ae=this,Be=0;return{next:function(){return Be<Ae.length?{value:Ae[Be++],done:!1}:{done:!0}},return:function(){return{done:!0}}}};function rt(){}rt.prototype={hasFeature:function(Ae,Be){return!0},createDocument:function(Ae,Be,mt){var pt=o.XML_APPLICATION;Ae===u.HTML?pt=o.XML_XHTML_APPLICATION:Ae===u.SVG&&(pt=o.XML_SVG_IMAGE);var Ir=new je(h,{contentType:pt});if(Ir.implementation=this,Ir.childNodes=new xe,Ir.doctype=mt||null,mt&&Ir.appendChild(mt),Be){var Fr=Ir.createElementNS(Ae,Be);Ir.appendChild(Fr)}return Ir},createDocumentType:function(Ae,Be,mt,pt){M(Ae);var Ir=new _t(h);return Ir.name=Ae,Ir.nodeName=Ae,Ir.publicId=Be||"",Ir.systemId=mt||"",Ir.internalSubset=pt||"",Ir.childNodes=new xe,Ir},createHTMLDocument:function(Ae){var Be=new je(h,{contentType:o.HTML});if(Be.implementation=this,Be.childNodes=new xe,Ae!==!1){Be.doctype=this.createDocumentType("html"),Be.doctype.ownerDocument=Be,Be.appendChild(Be.doctype);var mt=Be.createElement("html");Be.appendChild(mt);var pt=Be.createElement("head");if(mt.appendChild(pt),typeof Ae=="string"){var Ir=Be.createElement("title");Ir.appendChild(Be.createTextNode(Ae)),pt.appendChild(Ir)}mt.appendChild(Be.createElement("body"))}return Be}};function Ie(Ae){S(Ae)}Ie.prototype={firstChild:null,lastChild:null,previousSibling:null,nextSibling:null,parentNode:null,get parentElement(){return this.parentNode&&this.parentNode.nodeType===this.ELEMENT_NODE?this.parentNode:null},childNodes:null,ownerDocument:null,nodeValue:null,namespaceURI:null,prefix:null,localName:null,baseURI:"about:blank",get isConnected(){var Ae=this.getRootNode();return Ae&&Ae.nodeType===Ae.DOCUMENT_NODE},contains:function(Ae){if(!Ae)return!1;var Be=Ae;do{if(this===Be)return!0;Be=Ae.parentNode}while(Be);return!1},getRootNode:function(Ae){var Be=this;do{if(!Be.parentNode)return Be;Be=Be.parentNode}while(Be)},isEqualNode:function(Ae){if(!Ae||this.nodeType!==Ae.nodeType)return!1;switch(this.nodeType){case this.DOCUMENT_TYPE_NODE:if(this.name!==Ae.name||this.publicId!==Ae.publicId||this.systemId!==Ae.systemId)return!1;break;case this.ELEMENT_NODE:if(this.namespaceURI!==Ae.namespaceURI||this.prefix!==Ae.prefix||this.localName!==Ae.localName||this.attributes.length!==Ae.attributes.length)return!1;for(var Be=0;Be<this.attributes.length;Be++){var mt=this.attributes.item(Be);if(!mt.isEqualNode(Ae.getAttributeNodeNS(mt.namespaceURI,mt.localName)))return!1}break;case this.ATTRIBUTE_NODE:if(this.namespaceURI!==Ae.namespaceURI||this.localName!==Ae.localName||this.value!==Ae.value)return!1;break;case this.PROCESSING_INSTRUCTION_NODE:if(this.target!==Ae.target||this.data!==Ae.data)return!1;break;case this.TEXT_NODE:case this.COMMENT_NODE:if(this.data!==Ae.data)return!1;break}if(this.childNodes.length!==Ae.childNodes.length)return!1;for(var Be=0;Be<this.childNodes.length;Be++)if(!this.childNodes[Be].isEqualNode(Ae.childNodes[Be]))return!1;return!0},isSameNode:function(Ae){return this===Ae},insertBefore:function(Ae,Be){return _e(this,Ae,Be)},replaceChild:function(Ae,Be){_e(this,Ae,Be,nt),Be&&this.removeChild(Be)},removeChild:function(Ae){return vt(this,Ae)},appendChild:function(Ae){return this.insertBefore(Ae,null)},hasChildNodes:function(){return this.firstChild!=null},cloneNode:function(Ae){return un(this.ownerDocument||this,this,Ae)},normalize:function(){for(var Ae=this.firstChild;Ae;){var Be=Ae.nextSibling;Be&&Be.nodeType==Q&&Ae.nodeType==Q?(this.removeChild(Be),Ae.appendData(Be.data)):(Ae.normalize(),Ae=Be)}},isSupported:function(Ae,Be){return this.ownerDocument.implementation.hasFeature(Ae,Be)},lookupPrefix:function(Ae){for(var Be=this;Be;){var mt=Be._nsMap;if(mt){for(var pt in mt)if(n(mt,pt)&&mt[pt]===Ae)return pt}Be=Be.nodeType==ie?Be.ownerDocument:Be.parentNode}return null},lookupNamespaceURI:function(Ae){for(var Be=this;Be;){var mt=Be._nsMap;if(mt&&n(mt,Ae))return mt[Ae];Be=Be.nodeType==ie?Be.ownerDocument:Be.parentNode}return null},isDefaultNamespace:function(Ae){var Be=this.lookupPrefix(Ae);return Be==null},compareDocumentPosition:function(Ae){if(this===Ae)return 0;var Be=Ae,mt=this,pt=null,Ir=null;if(Be instanceof qe&&(pt=Be,Be=pt.ownerElement),mt instanceof qe&&(Ir=mt,mt=Ir.ownerElement,pt&&Be&&mt===Be))for(var Fr=0,qn;qn=mt.attributes[Fr];Fr++){if(qn===pt)return ke.DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC+ke.DOCUMENT_POSITION_PRECEDING;if(qn===Ir)return ke.DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC+ke.DOCUMENT_POSITION_FOLLOWING}if(!Be||!mt||mt.ownerDocument!==Be.ownerDocument)return ke.DOCUMENT_POSITION_DISCONNECTED+ke.DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC+(Ee(mt.ownerDocument)>Ee(Be.ownerDocument)?ke.DOCUMENT_POSITION_FOLLOWING:ke.DOCUMENT_POSITION_PRECEDING);if(Ir&&Be===mt)return ke.DOCUMENT_POSITION_CONTAINS+ke.DOCUMENT_POSITION_PRECEDING;if(pt&&Be===mt)return ke.DOCUMENT_POSITION_CONTAINED_BY+ke.DOCUMENT_POSITION_FOLLOWING;for(var Oi=[],zr=Be.parentNode;zr;){if(!Ir&&zr===mt)return ke.DOCUMENT_POSITION_CONTAINED_BY+ke.DOCUMENT_POSITION_FOLLOWING;Oi.push(zr),zr=zr.parentNode}Oi.reverse();for(var bn=[],Tn=mt.parentNode;Tn;){if(!pt&&Tn===Be)return ke.DOCUMENT_POSITION_CONTAINS+ke.DOCUMENT_POSITION_PRECEDING;bn.push(Tn),Tn=Tn.parentNode}bn.reverse();var Mi=he(Oi,bn);for(var pi in Mi.childNodes){var Wi=Mi.childNodes[pi];if(Wi===mt)return ke.DOCUMENT_POSITION_FOLLOWING;if(Wi===Be)return ke.DOCUMENT_POSITION_PRECEDING;if(bn.indexOf(Wi)>=0)return ke.DOCUMENT_POSITION_FOLLOWING;if(Oi.indexOf(Wi)>=0)return ke.DOCUMENT_POSITION_PRECEDING}return 0}};function Mt(Ae){return Ae=="<"&&"&lt;"||Ae==">"&&"&gt;"||Ae=="&"&&"&amp;"||Ae=='"'&&"&quot;"||"&#"+Ae.charCodeAt()+";"}B(W,Ie),B(W,Ie.prototype),B(ke,Ie),B(ke,Ie.prototype);function at(Ae,Be){if(Be(Ae))return!0;if(Ae=Ae.firstChild)do if(at(Ae,Be))return!0;while(Ae=Ae.nextSibling)}function je(Ae,Be){S(Ae);var mt=Be||{};this.ownerDocument=this,this.contentType=mt.contentType||o.XML_APPLICATION,this.type=i(this.contentType)?"html":"xml"}function Xt(Ae,Be,mt){Ae&&Ae._inc++;var pt=mt.namespaceURI;pt===u.XMLNS&&(Be._nsMap[mt.prefix?mt.localName:""]=mt.value)}function Yt(Ae,Be,mt,pt){Ae&&Ae._inc++;var Ir=mt.namespaceURI;Ir===u.XMLNS&&delete Be._nsMap[mt.prefix?mt.localName:""]}function pr(Ae,Be,mt){if(Ae&&Ae._inc){Ae._inc++;var pt=Be.childNodes;if(mt&&!mt.nextSibling)pt[pt.length++]=mt;else{for(var Ir=Be.firstChild,Fr=0;Ir;)pt[Fr++]=Ir,Ir=Ir.nextSibling;pt.length=Fr,delete pt[pt.length]}}}function vt(Ae,Be){if(Ae!==Be.parentNode)throw new g(g.NOT_FOUND_ERR,"child's parent is not parent");var mt=Be.previousSibling,pt=Be.nextSibling;return mt?mt.nextSibling=pt:Ae.firstChild=pt,pt?pt.previousSibling=mt:Ae.lastChild=mt,pr(Ae.ownerDocument,Ae),Be.parentNode=null,Be.previousSibling=null,Be.nextSibling=null,Be}function yr(Ae){return Ae&&(Ae.nodeType===Ie.DOCUMENT_NODE||Ae.nodeType===Ie.DOCUMENT_FRAGMENT_NODE||Ae.nodeType===Ie.ELEMENT_NODE)}function _r(Ae){return Ae&&(Ae.nodeType===Ie.CDATA_SECTION_NODE||Ae.nodeType===Ie.COMMENT_NODE||Ae.nodeType===Ie.DOCUMENT_FRAGMENT_NODE||Ae.nodeType===Ie.DOCUMENT_TYPE_NODE||Ae.nodeType===Ie.ELEMENT_NODE||Ae.nodeType===Ie.PROCESSING_INSTRUCTION_NODE||Ae.nodeType===Ie.TEXT_NODE)}function cr(Ae){return Ae&&Ae.nodeType===Ie.DOCUMENT_TYPE_NODE}function Er(Ae){return Ae&&Ae.nodeType===Ie.ELEMENT_NODE}function wr(Ae){return Ae&&Ae.nodeType===Ie.TEXT_NODE}function er(Ae,Be){var mt=Ae.childNodes||[];if(e(mt,Er)||cr(Be))return!1;var pt=e(mt,cr);return!(Be&&pt&&mt.indexOf(pt)>mt.indexOf(Be))}function lr(Ae,Be){var mt=Ae.childNodes||[];function pt(Fr){return Er(Fr)&&Fr!==Be}if(e(mt,pt))return!1;var Ir=e(mt,cr);return!(Be&&Ir&&mt.indexOf(Ir)>mt.indexOf(Be))}function Ar(Ae,Be,mt){if(!yr(Ae))throw new g(g.HIERARCHY_REQUEST_ERR,"Unexpected parent node type "+Ae.nodeType);if(mt&&mt.parentNode!==Ae)throw new g(g.NOT_FOUND_ERR,"child not in parent");if(!_r(Be)||cr(Be)&&Ae.nodeType!==Ie.DOCUMENT_NODE)throw new g(g.HIERARCHY_REQUEST_ERR,"Unexpected node type "+Be.nodeType+" for parent node type "+Ae.nodeType)}function ir(Ae,Be,mt){var pt=Ae.childNodes||[],Ir=Be.childNodes||[];if(Be.nodeType===Ie.DOCUMENT_FRAGMENT_NODE){var Fr=Ir.filter(Er);if(Fr.length>1||e(Ir,wr))throw new g(g.HIERARCHY_REQUEST_ERR,"More than one element or text in fragment");if(Fr.length===1&&!er(Ae,mt))throw new g(g.HIERARCHY_REQUEST_ERR,"Element in fragment can not be inserted before doctype")}if(Er(Be)&&!er(Ae,mt))throw new g(g.HIERARCHY_REQUEST_ERR,"Only one element can be added and only after doctype");if(cr(Be)){if(e(pt,cr))throw new g(g.HIERARCHY_REQUEST_ERR,"Only one doctype is allowed");var qn=e(pt,Er);if(mt&&pt.indexOf(qn)<pt.indexOf(mt))throw new g(g.HIERARCHY_REQUEST_ERR,"Doctype can only be inserted before an element");if(!mt&&qn)throw new g(g.HIERARCHY_REQUEST_ERR,"Doctype can not be appended since element is present")}}function nt(Ae,Be,mt){var pt=Ae.childNodes||[],Ir=Be.childNodes||[];if(Be.nodeType===Ie.DOCUMENT_FRAGMENT_NODE){var Fr=Ir.filter(Er);if(Fr.length>1||e(Ir,wr))throw new g(g.HIERARCHY_REQUEST_ERR,"More than one element or text in fragment");if(Fr.length===1&&!lr(Ae,mt))throw new g(g.HIERARCHY_REQUEST_ERR,"Element in fragment can not be inserted before doctype")}if(Er(Be)&&!lr(Ae,mt))throw new g(g.HIERARCHY_REQUEST_ERR,"Only one element can be added and only after doctype");if(cr(Be)){if(e(pt,function(zr){return cr(zr)&&zr!==mt}))throw new g(g.HIERARCHY_REQUEST_ERR,"Only one doctype is allowed");var qn=e(pt,Er);if(mt&&pt.indexOf(qn)<pt.indexOf(mt))throw new g(g.HIERARCHY_REQUEST_ERR,"Doctype can only be inserted before an element")}}function _e(Ae,Be,mt,pt){Ar(Ae,Be,mt),Ae.nodeType===Ie.DOCUMENT_NODE&&(pt||ir)(Ae,Be,mt);var Ir=Be.parentNode;if(Ir&&Ir.removeChild(Be),Be.nodeType===we){var Fr=Be.firstChild;if(Fr==null)return Be;var qn=Be.lastChild}else Fr=qn=Be;var Oi=mt?mt.previousSibling:Ae.lastChild;Fr.previousSibling=Oi,qn.nextSibling=mt,Oi?Oi.nextSibling=Fr:Ae.firstChild=Fr,mt==null?Ae.lastChild=qn:mt.previousSibling=qn;do Fr.parentNode=Ae;while(Fr!==qn&&(Fr=Fr.nextSibling));return pr(Ae.ownerDocument||Ae,Ae,Be),Be.nodeType==we&&(Be.firstChild=Be.lastChild=null),Be}je.prototype={implementation:null,nodeName:"#document",nodeType:Me,doctype:null,documentElement:null,_inc:1,insertBefore:function(Ae,Be){if(Ae.nodeType===we){for(var mt=Ae.firstChild;mt;){var pt=mt.nextSibling;this.insertBefore(mt,Be),mt=pt}return Ae}return _e(this,Ae,Be),Ae.ownerDocument=this,this.documentElement===null&&Ae.nodeType===G&&(this.documentElement=Ae),Ae},removeChild:function(Ae){var Be=vt(this,Ae);return Be===this.documentElement&&(this.documentElement=null),Be},replaceChild:function(Ae,Be){_e(this,Ae,Be,nt),Ae.ownerDocument=this,Be&&this.removeChild(Be),Er(Ae)&&(this.documentElement=Ae)},importNode:function(Ae,Be){return ti(this,Ae,Be)},getElementById:function(Ae){var Be=null;return at(this.documentElement,function(mt){if(mt.nodeType==G&&mt.getAttribute("id")==Ae)return Be=mt,!0}),Be},createElement:function(Ae){var Be=new be(h);Be.ownerDocument=this,this.type==="html"&&(Ae=Ae.toLowerCase()),r(this.contentType)&&(Be.namespaceURI=u.HTML),Be.nodeName=Ae,Be.tagName=Ae,Be.localName=Ae,Be.childNodes=new xe;var mt=Be.attributes=new $e;return mt._ownerElement=Be,Be},createDocumentFragment:function(){var Ae=new Rr(h);return Ae.ownerDocument=this,Ae.childNodes=new xe,Ae},createTextNode:function(Ae){var Be=new ot(h);return Be.ownerDocument=this,Be.childNodes=new xe,Be.appendData(Ae),Be},createComment:function(Ae){var Be=new et(h);return Be.ownerDocument=this,Be.childNodes=new xe,Be.appendData(Ae),Be},createCDATASection:function(Ae){var Be=new Lt(h);return Be.ownerDocument=this,Be.childNodes=new xe,Be.appendData(Ae),Be},createProcessingInstruction:function(Ae,Be){var mt=new bt(h);return mt.ownerDocument=this,mt.childNodes=new xe,mt.nodeName=mt.target=Ae,mt.nodeValue=mt.data=Be,mt},createAttribute:function(Ae){if(!v.QName_exact.test(Ae))throw new g(g.INVALID_CHARACTER_ERR,'invalid character in name "'+Ae+'"');return this.type==="html"&&(Ae=Ae.toLowerCase()),this._createAttribute(Ae)},_createAttribute:function(Ae){var Be=new qe(h);return Be.ownerDocument=this,Be.childNodes=new xe,Be.name=Ae,Be.nodeName=Ae,Be.localName=Ae,Be.specified=!0,Be},createEntityReference:function(Ae){if(!v.Name.test(Ae))throw new g(g.INVALID_CHARACTER_ERR,'not a valid xml name "'+Ae+'"');if(this.type==="html")throw new g("document is an html document",b.NotSupportedError);var Be=new Kt(h);return Be.ownerDocument=this,Be.childNodes=new xe,Be.nodeName=Ae,Be},createElementNS:function(Ae,Be){var mt=z(Ae,Be),pt=new be(h),Ir=pt.attributes=new $e;return pt.childNodes=new xe,pt.ownerDocument=this,pt.nodeName=Be,pt.tagName=Be,pt.namespaceURI=mt[0],pt.prefix=mt[1],pt.localName=mt[2],Ir._ownerElement=pt,pt},createAttributeNS:function(Ae,Be){var mt=z(Ae,Be),pt=new qe(h);return pt.ownerDocument=this,pt.childNodes=new xe,pt.nodeName=Be,pt.name=Be,pt.specified=!0,pt.namespaceURI=mt[0],pt.prefix=mt[1],pt.localName=mt[2],pt}},q(je,Ie);function be(Ae){S(Ae),this._nsMap=Object.create(null)}be.prototype={nodeType:G,attributes:null,getQualifiedName:function(){return this.prefix?this.prefix+":"+this.localName:this.localName},_isInHTMLDocumentAndNamespace:function(){return this.ownerDocument.type==="html"&&this.namespaceURI===u.HTML},hasAttributes:function(){return!!(this.attributes&&this.attributes.length)},hasAttribute:function(Ae){return!!this.getAttributeNode(Ae)},getAttribute:function(Ae){var Be=this.getAttributeNode(Ae);return Be?Be.value:null},getAttributeNode:function(Ae){return this._isInHTMLDocumentAndNamespace()&&(Ae=Ae.toLowerCase()),this.attributes.getNamedItem(Ae)},setAttribute:function(Ae,Be){this._isInHTMLDocumentAndNamespace()&&(Ae=Ae.toLowerCase());var mt=this.getAttributeNode(Ae);mt?mt.value=mt.nodeValue=""+Be:(mt=this.ownerDocument._createAttribute(Ae),mt.value=mt.nodeValue=""+Be,this.setAttributeNode(mt))},removeAttribute:function(Ae){var Be=this.getAttributeNode(Ae);Be&&this.removeAttributeNode(Be)},setAttributeNode:function(Ae){return this.attributes.setNamedItem(Ae)},setAttributeNodeNS:function(Ae){return this.attributes.setNamedItemNS(Ae)},removeAttributeNode:function(Ae){return this.attributes.removeNamedItem(Ae.nodeName)},removeAttributeNS:function(Ae,Be){var mt=this.getAttributeNodeNS(Ae,Be);mt&&this.removeAttributeNode(mt)},hasAttributeNS:function(Ae,Be){return this.getAttributeNodeNS(Ae,Be)!=null},getAttributeNS:function(Ae,Be){var mt=this.getAttributeNodeNS(Ae,Be);return mt?mt.value:null},setAttributeNS:function(Ae,Be,mt){var pt=z(Ae,Be),Ir=pt[2],Fr=this.getAttributeNodeNS(Ae,Ir);Fr?Fr.value=Fr.nodeValue=""+mt:(Fr=this.ownerDocument.createAttributeNS(Ae,Be),Fr.value=Fr.nodeValue=""+mt,this.setAttributeNode(Fr))},getAttributeNodeNS:function(Ae,Be){return this.attributes.getNamedItemNS(Ae,Be)},getElementsByClassName:function(Ae){var Be=L(Ae);return new Ne(this,function(mt){var pt=[];return Be.length>0&&at(mt,function(Ir){if(Ir!==mt&&Ir.nodeType===G){var Fr=Ir.getAttribute("class");if(Fr){var qn=Ae===Fr;if(!qn){var Oi=L(Fr);qn=Be.every(O(Oi))}qn&&pt.push(Ir)}}}),pt})},getElementsByTagName:function(Ae){var Be=(this.nodeType===Me?this:this.ownerDocument).type==="html",mt=Ae.toLowerCase();return new Ne(this,function(pt){var Ir=[];return at(pt,function(Fr){if(!(Fr===pt||Fr.nodeType!==G))if(Ae==="*")Ir.push(Fr);else{var qn=Fr.getQualifiedName(),Oi=Be&&Fr.namespaceURI===u.HTML?mt:Ae;qn===Oi&&Ir.push(Fr)}}),Ir})},getElementsByTagNameNS:function(Ae,Be){return new Ne(this,function(mt){var pt=[];return at(mt,function(Ir){Ir!==mt&&Ir.nodeType===G&&(Ae==="*"||Ir.namespaceURI===Ae)&&(Be==="*"||Ir.localName==Be)&&pt.push(Ir)}),pt})}},je.prototype.getElementsByClassName=be.prototype.getElementsByClassName,je.prototype.getElementsByTagName=be.prototype.getElementsByTagName,je.prototype.getElementsByTagNameNS=be.prototype.getElementsByTagNameNS,q(be,Ie);function qe(Ae){S(Ae),this.namespaceURI=null,this.prefix=null,this.ownerElement=null}qe.prototype.nodeType=ie,q(qe,Ie);function Qe(Ae){S(Ae)}Qe.prototype={data:"",substringData:function(Ae,Be){return this.data.substring(Ae,Ae+Be)},appendData:function(Ae){Ae=this.data+Ae,this.nodeValue=this.data=Ae,this.length=Ae.length},insertData:function(Ae,Be){this.replaceData(Ae,0,Be)},deleteData:function(Ae,Be){this.replaceData(Ae,Be,"")},replaceData:function(Ae,Be,mt){var pt=this.data.substring(0,Ae),Ir=this.data.substring(Ae+Be);mt=pt+mt+Ir,this.nodeValue=this.data=mt,this.length=mt.length}},q(Qe,Ie);function ot(Ae){S(Ae)}ot.prototype={nodeName:"#text",nodeType:Q,splitText:function(Ae){var Be=this.data,mt=Be.substring(Ae);Be=Be.substring(0,Ae),this.data=this.nodeValue=Be,this.length=Be.length;var pt=this.ownerDocument.createTextNode(mt);return this.parentNode&&this.parentNode.insertBefore(pt,this.nextSibling),pt}},q(ot,Qe);function et(Ae){S(Ae)}et.prototype={nodeName:"#comment",nodeType:fe},q(et,Qe);function Lt(Ae){S(Ae)}Lt.prototype={nodeName:"#cdata-section",nodeType:H},q(Lt,ot);function _t(Ae){S(Ae)}_t.prototype.nodeType=me,q(_t,Ie);function jt(Ae){S(Ae)}jt.prototype.nodeType=Te,q(jt,Ie);function Jt(Ae){S(Ae)}Jt.prototype.nodeType=oe,q(Jt,Ie);function Kt(Ae){S(Ae)}Kt.prototype.nodeType=ne,q(Kt,Ie);function Rr(Ae){S(Ae)}Rr.prototype.nodeName="#document-fragment",Rr.prototype.nodeType=we,q(Rr,Ie);function bt(Ae){S(Ae)}bt.prototype.nodeType=ce,q(bt,Qe);function Tr(){}Tr.prototype.serializeToString=function(Ae,Be){return Ur.call(Ae,Be)},Ie.prototype.toString=Ur;function Ur(Ae){var Be=[],mt=this.nodeType===Me&&this.documentElement||this,pt=mt.prefix,Ir=mt.namespaceURI;if(Ir&&pt==null){var pt=mt.lookupPrefix(Ir);if(pt==null)var Fr=[{namespace:Ir,prefix:null}]}return ar(this,Be,Ae,Fr),Be.join("")}function Gr(Ae,Be,mt){var pt=Ae.prefix||"",Ir=Ae.namespaceURI;if(!Ir||pt==="xml"&&Ir===u.XML||Ir===u.XMLNS)return!1;for(var Fr=mt.length;Fr--;){var qn=mt[Fr];if(qn.prefix===pt)return qn.namespace!==Ir}return!0}function Jr(Ae,Be,mt){Ae.push(" ",Be,'="',mt.replace(/[<>&"\t\n\r]/g,Mt),'"')}function ar(Ae,Be,mt,pt){pt||(pt=[]);var Ir=Ae.nodeType===Me?Ae:Ae.ownerDocument,Fr=Ir.type==="html";if(mt)if(Ae=mt(Ae),Ae){if(typeof Ae=="string"){Be.push(Ae);return}}else return;switch(Ae.nodeType){case G:var qn=Ae.attributes,Oi=qn.length,xa=Ae.firstChild,zr=Ae.tagName,bn=zr;if(!Fr&&!Ae.prefix&&Ae.namespaceURI){for(var Tn,Mi=0;Mi<qn.length;Mi++)if(qn.item(Mi).name==="xmlns"){Tn=qn.item(Mi).value;break}if(!Tn)for(var pi=pt.length-1;pi>=0;pi--){var Wi=pt[pi];if(Wi.prefix===""&&Wi.namespace===Ae.namespaceURI){Tn=Wi.namespace;break}}if(Tn!==Ae.namespaceURI)for(var pi=pt.length-1;pi>=0;pi--){var Wi=pt[pi];if(Wi.namespace===Ae.namespaceURI){Wi.prefix&&(bn=Wi.prefix+":"+zr);break}}}Be.push("<",bn);for(var Fn=0;Fn<Oi;Fn++){var Ia=qn.item(Fn);Ia.prefix=="xmlns"?pt.push({prefix:Ia.localName,namespace:Ia.value}):Ia.nodeName=="xmlns"&&pt.push({prefix:"",namespace:Ia.value})}for(var Fn=0;Fn<Oi;Fn++){var Ia=qn.item(Fn);if(Gr(Ia,Fr,pt)){var ma=Ia.prefix||"",Gi=Ia.namespaceURI;Jr(Be,ma?"xmlns:"+ma:"xmlns",Gi),pt.push({prefix:ma,namespace:Gi})}ar(Ia,Be,mt,pt)}if(zr===bn&&Gr(Ae,Fr,pt)){var ma=Ae.prefix||"",Gi=Ae.namespaceURI;Jr(Be,ma?"xmlns:"+ma:"xmlns",Gi),pt.push({prefix:ma,namespace:Gi})}var Ka=!xa;if(Ka&&(Fr||Ae.namespaceURI===u.HTML)&&(Ka=s(zr)),Ka)Be.push("/>");else{if(Be.push(">"),Fr&&a(zr))for(;xa;)xa.data?Be.push(xa.data):ar(xa,Be,mt,pt.slice()),xa=xa.nextSibling;else for(;xa;)ar(xa,Be,mt,pt.slice()),xa=xa.nextSibling;Be.push("</",bn,">")}return;case Me:case we:for(var xa=Ae.firstChild;xa;)ar(xa,Be,mt,pt.slice()),xa=xa.nextSibling;return;case ie:return Jr(Be,Ae.name,Ae.value);case Q:return Be.push(Ae.data.replace(/[<&>]/g,Mt));case H:return Be.push(v.CDATA_START,Ae.data,v.CDATA_END);case fe:return Be.push(v.COMMENT_START,Ae.data,v.COMMENT_END);case me:var Ui=Ae.publicId,oo=Ae.systemId;Be.push(v.DOCTYPE_DECL_START," ",Ae.name),Ui?(Be.push(" ",v.PUBLIC," ",Ui),oo&&oo!=="."&&Be.push(" ",oo)):oo&&oo!=="."&&Be.push(" ",v.SYSTEM," ",oo),Ae.internalSubset&&Be.push(" [",Ae.internalSubset,"]"),Be.push(">");return;case ce:return Be.push("<?",Ae.target," ",Ae.data,"?>");case ne:return Be.push("&",Ae.nodeName,";");default:Be.push("??",Ae.nodeName)}}function ti(Ae,Be,mt){var pt;switch(Be.nodeType){case G:pt=Be.cloneNode(!1),pt.ownerDocument=Ae;case we:break;case ie:mt=!0;break}if(pt||(pt=Be.cloneNode(!1)),pt.ownerDocument=Ae,pt.parentNode=null,mt)for(var Ir=Be.firstChild;Ir;)pt.appendChild(ti(Ae,Ir,mt)),Ir=Ir.nextSibling;return pt}function un(Ae,Be,mt){var pt=new Be.constructor(h);for(var Ir in Be)if(n(Be,Ir)){var Fr=Be[Ir];typeof Fr!="object"&&Fr!=pt[Ir]&&(pt[Ir]=Fr)}switch(Be.childNodes&&(pt.childNodes=new xe),pt.ownerDocument=Ae,pt.nodeType){case G:var qn=Be.attributes,Oi=pt.attributes=new $e,zr=qn.length;Oi._ownerElement=pt;for(var bn=0;bn<zr;bn++)pt.setAttributeNode(un(Ae,qn.item(bn),!0));break;case ie:mt=!0}if(mt)for(var Tn=Be.firstChild;Tn;)pt.appendChild(un(Ae,Tn,mt)),Tn=Tn.nextSibling;return pt}function ri(Ae,Be,mt){Ae[Be]=mt}try{if(Object.defineProperty){let Ae=function(Be){switch(Be.nodeType){case G:case we:var mt=[];for(Be=Be.firstChild;Be;)Be.nodeType!==7&&Be.nodeType!==8&&mt.push(Ae(Be)),Be=Be.nextSibling;return mt.join("");default:return Be.nodeValue}};Object.defineProperty(Ne.prototype,"length",{get:function(){return Oe(this),this.$$length}}),Object.defineProperty(Ie.prototype,"textContent",{get:function(){return Ae(this)},set:function(Be){switch(this.nodeType){case G:case we:for(;this.firstChild;)this.removeChild(this.firstChild);(Be||String(Be))&&this.appendChild(this.ownerDocument.createTextNode(Be));break;default:this.data=Be,this.value=Be,this.nodeValue=Be}}}),ri=function(Be,mt,pt){Be["$$"+mt]=pt}}}catch{}return ks._updateLiveList=Oe,ks.Attr=qe,ks.CDATASection=Lt,ks.CharacterData=Qe,ks.Comment=et,ks.Document=je,ks.DocumentFragment=Rr,ks.DocumentType=_t,ks.DOMImplementation=rt,ks.Element=be,ks.Entity=Jt,ks.EntityReference=Kt,ks.LiveNodeList=Ne,ks.NamedNodeMap=$e,ks.Node=Ie,ks.NodeList=xe,ks.Notation=jt,ks.Text=ot,ks.ProcessingInstruction=bt,ks.XMLSerializer=Tr,ks}var Og={},aI={},IV;function DIe(){return IV||(IV=1,(function(t){var e=W0().freeze;t.XML_ENTITIES=e({amp:"&",apos:"'",gt:">",lt:"<",quot:'"'}),t.HTML_ENTITIES=e({Aacute:"",aacute:"",Abreve:"",abreve:"",ac:"",acd:"",acE:"",Acirc:"",acirc:"",acute:"",Acy:"",acy:"",AElig:"",aelig:"",af:"",Afr:"",afr:"",Agrave:"",agrave:"",alefsym:"",aleph:"",Alpha:"",alpha:"",Amacr:"",amacr:"",amalg:"",AMP:"&",amp:"&",And:"",and:"",andand:"",andd:"",andslope:"",andv:"",ang:"",ange:"",angle:"",angmsd:"",angmsdaa:"",angmsdab:"",angmsdac:"",angmsdad:"",angmsdae:"",angmsdaf:"",angmsdag:"",angmsdah:"",angrt:"",angrtvb:"",angrtvbd:"",angsph:"",angst:"",angzarr:"",Aogon:"",aogon:"",Aopf:"",aopf:"",ap:"",apacir:"",apE:"",ape:"",apid:"",apos:"'",ApplyFunction:"",approx:"",approxeq:"",Aring:"",aring:"",Ascr:"",ascr:"",Assign:"",ast:"*",asymp:"",asympeq:"",Atilde:"",atilde:"",Auml:"",auml:"",awconint:"",awint:"",backcong:"",backepsilon:"",backprime:"",backsim:"",backsimeq:"",Backslash:"",Barv:"",barvee:"",Barwed:"",barwed:"",barwedge:"",bbrk:"",bbrktbrk:"",bcong:"",Bcy:"",bcy:"",bdquo:"",becaus:"",Because:"",because:"",bemptyv:"",bepsi:"",bernou:"",Bernoullis:"",Beta:"",beta:"",beth:"",between:"",Bfr:"",bfr:"",bigcap:"",bigcirc:"",bigcup:"",bigodot:"",bigoplus:"",bigotimes:"",bigsqcup:"",bigstar:"",bigtriangledown:"",bigtriangleup:"",biguplus:"",bigvee:"",bigwedge:"",bkarow:"",blacklozenge:"",blacksquare:"",blacktriangle:"",blacktriangledown:"",blacktriangleleft:"",blacktriangleright:"",blank:"",blk12:"",blk14:"",blk34:"",block:"",bne:"=",bnequiv:"",bNot:"",bnot:"",Bopf:"",bopf:"",bot:"",bottom:"",bowtie:"",boxbox:"",boxDL:"",boxDl:"",boxdL:"",boxdl:"",boxDR:"",boxDr:"",boxdR:"",boxdr:"",boxH:"",boxh:"",boxHD:"",boxHd:"",boxhD:"",boxhd:"",boxHU:"",boxHu:"",boxhU:"",boxhu:"",boxminus:"",boxplus:"",boxtimes:"",boxUL:"",boxUl:"",boxuL:"",boxul:"",boxUR:"",boxUr:"",boxuR:"",boxur:"",boxV:"",boxv:"",boxVH:"",boxVh:"",boxvH:"",boxvh:"",boxVL:"",boxVl:"",boxvL:"",boxvl:"",boxVR:"",boxVr:"",boxvR:"",boxvr:"",bprime:"",Breve:"",breve:"",brvbar:"",Bscr:"",bscr:"",bsemi:"",bsim:"",bsime:"",bsol:"\\",bsolb:"",bsolhsub:"",bull:"",bullet:"",bump:"",bumpE:"",bumpe:"",Bumpeq:"",bumpeq:"",Cacute:"",cacute:"",Cap:"",cap:"",capand:"",capbrcup:"",capcap:"",capcup:"",capdot:"",CapitalDifferentialD:"",caps:"",caret:"",caron:"",Cayleys:"",ccaps:"",Ccaron:"",ccaron:"",Ccedil:"",ccedil:"",Ccirc:"",ccirc:"",Cconint:"",ccups:"",ccupssm:"",Cdot:"",cdot:"",cedil:"",Cedilla:"",cemptyv:"",cent:"",CenterDot:"",centerdot:"",Cfr:"",cfr:"",CHcy:"",chcy:"",check:"",checkmark:"",Chi:"",chi:"",cir:"",circ:"",circeq:"",circlearrowleft:"",circlearrowright:"",circledast:"",circledcirc:"",circleddash:"",CircleDot:"",circledR:"",circledS:"",CircleMinus:"",CirclePlus:"",CircleTimes:"",cirE:"",cire:"",cirfnint:"",cirmid:"",cirscir:"",ClockwiseContourIntegral:"",CloseCurlyDoubleQuote:"",CloseCurlyQuote:"",clubs:"",clubsuit:"",Colon:"",colon:":",Colone:"",colone:"",coloneq:"",comma:",",commat:"@",comp:"",compfn:"",complement:"",complexes:"",cong:"",congdot:"",Congruent:"",Conint:"",conint:"",ContourIntegral:"",Copf:"",copf:"",coprod:"",Coproduct:"",COPY:"",copy:"",copysr:"",CounterClockwiseContourIntegral:"",crarr:"",Cross:"",cross:"",Cscr:"",cscr:"",csub:"",csube:"",csup:"",csupe:"",ctdot:"",cudarrl:"",cudarrr:"",cuepr:"",cuesc:"",cularr:"",cularrp:"",Cup:"",cup:"",cupbrcap:"",CupCap:"",cupcap:"",cupcup:"",cupdot:"",cupor:"",cups:"",curarr:"",curarrm:"",curlyeqprec:"",curlyeqsucc:"",curlyvee:"",curlywedge:"",curren:"",curvearrowleft:"",curvearrowright:"",cuvee:"",cuwed:"",cwconint:"",cwint:"",cylcty:"",Dagger:"",dagger:"",daleth:"",Darr:"",dArr:"",darr:"",dash:"",Dashv:"",dashv:"",dbkarow:"",dblac:"",Dcaron:"",dcaron:"",Dcy:"",dcy:"",DD:"",dd:"",ddagger:"",ddarr:"",DDotrahd:"",ddotseq:"",deg:"",Del:"",Delta:"",delta:"",demptyv:"",dfisht:"",Dfr:"",dfr:"",dHar:"",dharl:"",dharr:"",DiacriticalAcute:"",DiacriticalDot:"",DiacriticalDoubleAcute:"",DiacriticalGrave:"`",DiacriticalTilde:"",diam:"",Diamond:"",diamond:"",diamondsuit:"",diams:"",die:"",DifferentialD:"",digamma:"",disin:"",div:"",divide:"",divideontimes:"",divonx:"",DJcy:"",djcy:"",dlcorn:"",dlcrop:"",dollar:"$",Dopf:"",dopf:"",Dot:"",dot:"",DotDot:"",doteq:"",doteqdot:"",DotEqual:"",dotminus:"",dotplus:"",dotsquare:"",doublebarwedge:"",DoubleContourIntegral:"",DoubleDot:"",DoubleDownArrow:"",DoubleLeftArrow:"",DoubleLeftRightArrow:"",DoubleLeftTee:"",DoubleLongLeftArrow:"",DoubleLongLeftRightArrow:"",DoubleLongRightArrow:"",DoubleRightArrow:"",DoubleRightTee:"",DoubleUpArrow:"",DoubleUpDownArrow:"",DoubleVerticalBar:"",DownArrow:"",Downarrow:"",downarrow:"",DownArrowBar:"",DownArrowUpArrow:"",DownBreve:"",downdownarrows:"",downharpoonleft:"",downharpoonright:"",DownLeftRightVector:"",DownLeftTeeVector:"",DownLeftVector:"",DownLeftVectorBar:"",DownRightTeeVector:"",DownRightVector:"",DownRightVectorBar:"",DownTee:"",DownTeeArrow:"",drbkarow:"",drcorn:"",drcrop:"",Dscr:"",dscr:"",DScy:"",dscy:"",dsol:"",Dstrok:"",dstrok:"",dtdot:"",dtri:"",dtrif:"",duarr:"",duhar:"",dwangle:"",DZcy:"",dzcy:"",dzigrarr:"",Eacute:"",eacute:"",easter:"",Ecaron:"",ecaron:"",ecir:"",Ecirc:"",ecirc:"",ecolon:"",Ecy:"",ecy:"",eDDot:"",Edot:"",eDot:"",edot:"",ee:"",efDot:"",Efr:"",efr:"",eg:"",Egrave:"",egrave:"",egs:"",egsdot:"",el:"",Element:"",elinters:"",ell:"",els:"",elsdot:"",Emacr:"",emacr:"",empty:"",emptyset:"",EmptySmallSquare:"",emptyv:"",EmptyVerySmallSquare:"",emsp:"",emsp13:"",emsp14:"",ENG:"",eng:"",ensp:"",Eogon:"",eogon:"",Eopf:"",eopf:"",epar:"",eparsl:"",eplus:"",epsi:"",Epsilon:"",epsilon:"",epsiv:"",eqcirc:"",eqcolon:"",eqsim:"",eqslantgtr:"",eqslantless:"",Equal:"",equals:"=",EqualTilde:"",equest:"",Equilibrium:"",equiv:"",equivDD:"",eqvparsl:"",erarr:"",erDot:"",Escr:"",escr:"",esdot:"",Esim:"",esim:"",Eta:"",eta:"",ETH:"",eth:"",Euml:"",euml:"",euro:"",excl:"!",exist:"",Exists:"",expectation:"",ExponentialE:"",exponentiale:"",fallingdotseq:"",Fcy:"",fcy:"",female:"",ffilig:"",fflig:"",ffllig:"",Ffr:"",ffr:"",filig:"",FilledSmallSquare:"",FilledVerySmallSquare:"",fjlig:"fj",flat:"",fllig:"",fltns:"",fnof:"",Fopf:"",fopf:"",ForAll:"",forall:"",fork:"",forkv:"",Fouriertrf:"",fpartint:"",frac12:"",frac13:"",frac14:"",frac15:"",frac16:"",frac18:"",frac23:"",frac25:"",frac34:"",frac35:"",frac38:"",frac45:"",frac56:"",frac58:"",frac78:"",frasl:"",frown:"",Fscr:"",fscr:"",gacute:"",Gamma:"",gamma:"",Gammad:"",gammad:"",gap:"",Gbreve:"",gbreve:"",Gcedil:"",Gcirc:"",gcirc:"",Gcy:"",gcy:"",Gdot:"",gdot:"",gE:"",ge:"",gEl:"",gel:"",geq:"",geqq:"",geqslant:"",ges:"",gescc:"",gesdot:"",gesdoto:"",gesdotol:"",gesl:"",gesles:"",Gfr:"",gfr:"",Gg:"",gg:"",ggg:"",gimel:"",GJcy:"",gjcy:"",gl:"",gla:"",glE:"",glj:"",gnap:"",gnapprox:"",gnE:"",gne:"",gneq:"",gneqq:"",gnsim:"",Gopf:"",gopf:"",grave:"`",GreaterEqual:"",GreaterEqualLess:"",GreaterFullEqual:"",GreaterGreater:"",GreaterLess:"",GreaterSlantEqual:"",GreaterTilde:"",Gscr:"",gscr:"",gsim:"",gsime:"",gsiml:"",Gt:"",GT:">",gt:">",gtcc:"",gtcir:"",gtdot:"",gtlPar:"",gtquest:"",gtrapprox:"",gtrarr:"",gtrdot:"",gtreqless:"",gtreqqless:"",gtrless:"",gtrsim:"",gvertneqq:"",gvnE:"",Hacek:"",hairsp:"",half:"",hamilt:"",HARDcy:"",hardcy:"",hArr:"",harr:"",harrcir:"",harrw:"",Hat:"^",hbar:"",Hcirc:"",hcirc:"",hearts:"",heartsuit:"",hellip:"",hercon:"",Hfr:"",hfr:"",HilbertSpace:"",hksearow:"",hkswarow:"",hoarr:"",homtht:"",hookleftarrow:"",hookrightarrow:"",Hopf:"",hopf:"",horbar:"",HorizontalLine:"",Hscr:"",hscr:"",hslash:"",Hstrok:"",hstrok:"",HumpDownHump:"",HumpEqual:"",hybull:"",hyphen:"",Iacute:"",iacute:"",ic:"",Icirc:"",icirc:"",Icy:"",icy:"",Idot:"",IEcy:"",iecy:"",iexcl:"",iff:"",Ifr:"",ifr:"",Igrave:"",igrave:"",ii:"",iiiint:"",iiint:"",iinfin:"",iiota:"",IJlig:"",ijlig:"",Im:"",Imacr:"",imacr:"",image:"",ImaginaryI:"",imagline:"",imagpart:"",imath:"",imof:"",imped:"",Implies:"",in:"",incare:"",infin:"",infintie:"",inodot:"",Int:"",int:"",intcal:"",integers:"",Integral:"",intercal:"",Intersection:"",intlarhk:"",intprod:"",InvisibleComma:"",InvisibleTimes:"",IOcy:"",iocy:"",Iogon:"",iogon:"",Iopf:"",iopf:"",Iota:"",iota:"",iprod:"",iquest:"",Iscr:"",iscr:"",isin:"",isindot:"",isinE:"",isins:"",isinsv:"",isinv:"",it:"",Itilde:"",itilde:"",Iukcy:"",iukcy:"",Iuml:"",iuml:"",Jcirc:"",jcirc:"",Jcy:"",jcy:"",Jfr:"",jfr:"",jmath:"",Jopf:"",jopf:"",Jscr:"",jscr:"",Jsercy:"",jsercy:"",Jukcy:"",jukcy:"",Kappa:"",kappa:"",kappav:"",Kcedil:"",kcedil:"",Kcy:"",kcy:"",Kfr:"",kfr:"",kgreen:"",KHcy:"",khcy:"",KJcy:"",kjcy:"",Kopf:"",kopf:"",Kscr:"",kscr:"",lAarr:"",Lacute:"",lacute:"",laemptyv:"",lagran:"",Lambda:"",lambda:"",Lang:"",lang:"",langd:"",langle:"",lap:"",Laplacetrf:"",laquo:"",Larr:"",lArr:"",larr:"",larrb:"",larrbfs:"",larrfs:"",larrhk:"",larrlp:"",larrpl:"",larrsim:"",larrtl:"",lat:"",lAtail:"",latail:"",late:"",lates:"",lBarr:"",lbarr:"",lbbrk:"",lbrace:"{",lbrack:"[",lbrke:"",lbrksld:"",lbrkslu:"",Lcaron:"",lcaron:"",Lcedil:"",lcedil:"",lceil:"",lcub:"{",Lcy:"",lcy:"",ldca:"",ldquo:"",ldquor:"",ldrdhar:"",ldrushar:"",ldsh:"",lE:"",le:"",LeftAngleBracket:"",LeftArrow:"",Leftarrow:"",leftarrow:"",LeftArrowBar:"",LeftArrowRightArrow:"",leftarrowtail:"",LeftCeiling:"",LeftDoubleBracket:"",LeftDownTeeVector:"",LeftDownVector:"",LeftDownVectorBar:"",LeftFloor:"",leftharpoondown:"",leftharpoonup:"",leftleftarrows:"",LeftRightArrow:"",Leftrightarrow:"",leftrightarrow:"",leftrightarrows:"",leftrightharpoons:"",leftrightsquigarrow:"",LeftRightVector:"",LeftTee:"",LeftTeeArrow:"",LeftTeeVector:"",leftthreetimes:"",LeftTriangle:"",LeftTriangleBar:"",LeftTriangleEqual:"",LeftUpDownVector:"",LeftUpTeeVector:"",LeftUpVector:"",LeftUpVectorBar:"",LeftVector:"",LeftVectorBar:"",lEg:"",leg:"",leq:"",leqq:"",leqslant:"",les:"",lescc:"",lesdot:"",lesdoto:"",lesdotor:"",lesg:"",lesges:"",lessapprox:"",lessdot:"",lesseqgtr:"",lesseqqgtr:"",LessEqualGreater:"",LessFullEqual:"",LessGreater:"",lessgtr:"",LessLess:"",lesssim:"",LessSlantEqual:"",LessTilde:"",lfisht:"",lfloor:"",Lfr:"",lfr:"",lg:"",lgE:"",lHar:"",lhard:"",lharu:"",lharul:"",lhblk:"",LJcy:"",ljcy:"",Ll:"",ll:"",llarr:"",llcorner:"",Lleftarrow:"",llhard:"",lltri:"",Lmidot:"",lmidot:"",lmoust:"",lmoustache:"",lnap:"",lnapprox:"",lnE:"",lne:"",lneq:"",lneqq:"",lnsim:"",loang:"",loarr:"",lobrk:"",LongLeftArrow:"",Longleftarrow:"",longleftarrow:"",LongLeftRightArrow:"",Longleftrightarrow:"",longleftrightarrow:"",longmapsto:"",LongRightArrow:"",Longrightarrow:"",longrightarrow:"",looparrowleft:"",looparrowright:"",lopar:"",Lopf:"",lopf:"",loplus:"",lotimes:"",lowast:"",lowbar:"_",LowerLeftArrow:"",LowerRightArrow:"",loz:"",lozenge:"",lozf:"",lpar:"(",lparlt:"",lrarr:"",lrcorner:"",lrhar:"",lrhard:"",lrm:"",lrtri:"",lsaquo:"",Lscr:"",lscr:"",Lsh:"",lsh:"",lsim:"",lsime:"",lsimg:"",lsqb:"[",lsquo:"",lsquor:"",Lstrok:"",lstrok:"",Lt:"",LT:"<",lt:"<",ltcc:"",ltcir:"",ltdot:"",lthree:"",ltimes:"",ltlarr:"",ltquest:"",ltri:"",ltrie:"",ltrif:"",ltrPar:"",lurdshar:"",luruhar:"",lvertneqq:"",lvnE:"",macr:"",male:"",malt:"",maltese:"",Map:"",map:"",mapsto:"",mapstodown:"",mapstoleft:"",mapstoup:"",marker:"",mcomma:"",Mcy:"",mcy:"",mdash:"",mDDot:"",measuredangle:"",MediumSpace:"",Mellintrf:"",Mfr:"",mfr:"",mho:"",micro:"",mid:"",midast:"*",midcir:"",middot:"",minus:"",minusb:"",minusd:"",minusdu:"",MinusPlus:"",mlcp:"",mldr:"",mnplus:"",models:"",Mopf:"",mopf:"",mp:"",Mscr:"",mscr:"",mstpos:"",Mu:"",mu:"",multimap:"",mumap:"",nabla:"",Nacute:"",nacute:"",nang:"",nap:"",napE:"",napid:"",napos:"",napprox:"",natur:"",natural:"",naturals:"",nbsp:"",nbump:"",nbumpe:"",ncap:"",Ncaron:"",ncaron:"",Ncedil:"",ncedil:"",ncong:"",ncongdot:"",ncup:"",Ncy:"",ncy:"",ndash:"",ne:"",nearhk:"",neArr:"",nearr:"",nearrow:"",nedot:"",NegativeMediumSpace:"",NegativeThickSpace:"",NegativeThinSpace:"",NegativeVeryThinSpace:"",nequiv:"",nesear:"",nesim:"",NestedGreaterGreater:"",NestedLessLess:"",NewLine:`
`,nexist:"",nexists:"",Nfr:"",nfr:"",ngE:"",nge:"",ngeq:"",ngeqq:"",ngeqslant:"",nges:"",nGg:"",ngsim:"",nGt:"",ngt:"",ngtr:"",nGtv:"",nhArr:"",nharr:"",nhpar:"",ni:"",nis:"",nisd:"",niv:"",NJcy:"",njcy:"",nlArr:"",nlarr:"",nldr:"",nlE:"",nle:"",nLeftarrow:"",nleftarrow:"",nLeftrightarrow:"",nleftrightarrow:"",nleq:"",nleqq:"",nleqslant:"",nles:"",nless:"",nLl:"",nlsim:"",nLt:"",nlt:"",nltri:"",nltrie:"",nLtv:"",nmid:"",NoBreak:"",NonBreakingSpace:"",Nopf:"",nopf:"",Not:"",not:"",NotCongruent:"",NotCupCap:"",NotDoubleVerticalBar:"",NotElement:"",NotEqual:"",NotEqualTilde:"",NotExists:"",NotGreater:"",NotGreaterEqual:"",NotGreaterFullEqual:"",NotGreaterGreater:"",NotGreaterLess:"",NotGreaterSlantEqual:"",NotGreaterTilde:"",NotHumpDownHump:"",NotHumpEqual:"",notin:"",notindot:"",notinE:"",notinva:"",notinvb:"",notinvc:"",NotLeftTriangle:"",NotLeftTriangleBar:"",NotLeftTriangleEqual:"",NotLess:"",NotLessEqual:"",NotLessGreater:"",NotLessLess:"",NotLessSlantEqual:"",NotLessTilde:"",NotNestedGreaterGreater:"",NotNestedLessLess:"",notni:"",notniva:"",notnivb:"",notnivc:"",NotPrecedes:"",NotPrecedesEqual:"",NotPrecedesSlantEqual:"",NotReverseElement:"",NotRightTriangle:"",NotRightTriangleBar:"",NotRightTriangleEqual:"",NotSquareSubset:"",NotSquareSubsetEqual:"",NotSquareSuperset:"",NotSquareSupersetEqual:"",NotSubset:"",NotSubsetEqual:"",NotSucceeds:"",NotSucceedsEqual:"",NotSucceedsSlantEqual:"",NotSucceedsTilde:"",NotSuperset:"",NotSupersetEqual:"",NotTilde:"",NotTildeEqual:"",NotTildeFullEqual:"",NotTildeTilde:"",NotVerticalBar:"",npar:"",nparallel:"",nparsl:"",npart:"",npolint:"",npr:"",nprcue:"",npre:"",nprec:"",npreceq:"",nrArr:"",nrarr:"",nrarrc:"",nrarrw:"",nRightarrow:"",nrightarrow:"",nrtri:"",nrtrie:"",nsc:"",nsccue:"",nsce:"",Nscr:"",nscr:"",nshortmid:"",nshortparallel:"",nsim:"",nsime:"",nsimeq:"",nsmid:"",nspar:"",nsqsube:"",nsqsupe:"",nsub:"",nsubE:"",nsube:"",nsubset:"",nsubseteq:"",nsubseteqq:"",nsucc:"",nsucceq:"",nsup:"",nsupE:"",nsupe:"",nsupset:"",nsupseteq:"",nsupseteqq:"",ntgl:"",Ntilde:"",ntilde:"",ntlg:"",ntriangleleft:"",ntrianglelefteq:"",ntriangleright:"",ntrianglerighteq:"",Nu:"",nu:"",num:"#",numero:"",numsp:"",nvap:"",nVDash:"",nVdash:"",nvDash:"",nvdash:"",nvge:"",nvgt:">",nvHarr:"",nvinfin:"",nvlArr:"",nvle:"",nvlt:"<",nvltrie:"",nvrArr:"",nvrtrie:"",nvsim:"",nwarhk:"",nwArr:"",nwarr:"",nwarrow:"",nwnear:"",Oacute:"",oacute:"",oast:"",ocir:"",Ocirc:"",ocirc:"",Ocy:"",ocy:"",odash:"",Odblac:"",odblac:"",odiv:"",odot:"",odsold:"",OElig:"",oelig:"",ofcir:"",Ofr:"",ofr:"",ogon:"",Ograve:"",ograve:"",ogt:"",ohbar:"",ohm:"",oint:"",olarr:"",olcir:"",olcross:"",oline:"",olt:"",Omacr:"",omacr:"",Omega:"",omega:"",Omicron:"",omicron:"",omid:"",ominus:"",Oopf:"",oopf:"",opar:"",OpenCurlyDoubleQuote:"",OpenCurlyQuote:"",operp:"",oplus:"",Or:"",or:"",orarr:"",ord:"",order:"",orderof:"",ordf:"",ordm:"",origof:"",oror:"",orslope:"",orv:"",oS:"",Oscr:"",oscr:"",Oslash:"",oslash:"",osol:"",Otilde:"",otilde:"",Otimes:"",otimes:"",otimesas:"",Ouml:"",ouml:"",ovbar:"",OverBar:"",OverBrace:"",OverBracket:"",OverParenthesis:"",par:"",para:"",parallel:"",parsim:"",parsl:"",part:"",PartialD:"",Pcy:"",pcy:"",percnt:"%",period:".",permil:"",perp:"",pertenk:"",Pfr:"",pfr:"",Phi:"",phi:"",phiv:"",phmmat:"",phone:"",Pi:"",pi:"",pitchfork:"",piv:"",planck:"",planckh:"",plankv:"",plus:"+",plusacir:"",plusb:"",pluscir:"",plusdo:"",plusdu:"",pluse:"",PlusMinus:"",plusmn:"",plussim:"",plustwo:"",pm:"",Poincareplane:"",pointint:"",Popf:"",popf:"",pound:"",Pr:"",pr:"",prap:"",prcue:"",prE:"",pre:"",prec:"",precapprox:"",preccurlyeq:"",Precedes:"",PrecedesEqual:"",PrecedesSlantEqual:"",PrecedesTilde:"",preceq:"",precnapprox:"",precneqq:"",precnsim:"",precsim:"",Prime:"",prime:"",primes:"",prnap:"",prnE:"",prnsim:"",prod:"",Product:"",profalar:"",profline:"",profsurf:"",prop:"",Proportion:"",Proportional:"",propto:"",prsim:"",prurel:"",Pscr:"",pscr:"",Psi:"",psi:"",puncsp:"",Qfr:"",qfr:"",qint:"",Qopf:"",qopf:"",qprime:"",Qscr:"",qscr:"",quaternions:"",quatint:"",quest:"?",questeq:"",QUOT:'"',quot:'"',rAarr:"",race:"",Racute:"",racute:"",radic:"",raemptyv:"",Rang:"",rang:"",rangd:"",range:"",rangle:"",raquo:"",Rarr:"",rArr:"",rarr:"",rarrap:"",rarrb:"",rarrbfs:"",rarrc:"",rarrfs:"",rarrhk:"",rarrlp:"",rarrpl:"",rarrsim:"",Rarrtl:"",rarrtl:"",rarrw:"",rAtail:"",ratail:"",ratio:"",rationals:"",RBarr:"",rBarr:"",rbarr:"",rbbrk:"",rbrace:"}",rbrack:"]",rbrke:"",rbrksld:"",rbrkslu:"",Rcaron:"",rcaron:"",Rcedil:"",rcedil:"",rceil:"",rcub:"}",Rcy:"",rcy:"",rdca:"",rdldhar:"",rdquo:"",rdquor:"",rdsh:"",Re:"",real:"",realine:"",realpart:"",reals:"",rect:"",REG:"",reg:"",ReverseElement:"",ReverseEquilibrium:"",ReverseUpEquilibrium:"",rfisht:"",rfloor:"",Rfr:"",rfr:"",rHar:"",rhard:"",rharu:"",rharul:"",Rho:"",rho:"",rhov:"",RightAngleBracket:"",RightArrow:"",Rightarrow:"",rightarrow:"",RightArrowBar:"",RightArrowLeftArrow:"",rightarrowtail:"",RightCeiling:"",RightDoubleBracket:"",RightDownTeeVector:"",RightDownVector:"",RightDownVectorBar:"",RightFloor:"",rightharpoondown:"",rightharpoonup:"",rightleftarrows:"",rightleftharpoons:"",rightrightarrows:"",rightsquigarrow:"",RightTee:"",RightTeeArrow:"",RightTeeVector:"",rightthreetimes:"",RightTriangle:"",RightTriangleBar:"",RightTriangleEqual:"",RightUpDownVector:"",RightUpTeeVector:"",RightUpVector:"",RightUpVectorBar:"",RightVector:"",RightVectorBar:"",ring:"",risingdotseq:"",rlarr:"",rlhar:"",rlm:"",rmoust:"",rmoustache:"",rnmid:"",roang:"",roarr:"",robrk:"",ropar:"",Ropf:"",ropf:"",roplus:"",rotimes:"",RoundImplies:"",rpar:")",rpargt:"",rppolint:"",rrarr:"",Rrightarrow:"",rsaquo:"",Rscr:"",rscr:"",Rsh:"",rsh:"",rsqb:"]",rsquo:"",rsquor:"",rthree:"",rtimes:"",rtri:"",rtrie:"",rtrif:"",rtriltri:"",RuleDelayed:"",ruluhar:"",rx:"",Sacute:"",sacute:"",sbquo:"",Sc:"",sc:"",scap:"",Scaron:"",scaron:"",sccue:"",scE:"",sce:"",Scedil:"",scedil:"",Scirc:"",scirc:"",scnap:"",scnE:"",scnsim:"",scpolint:"",scsim:"",Scy:"",scy:"",sdot:"",sdotb:"",sdote:"",searhk:"",seArr:"",searr:"",searrow:"",sect:"",semi:";",seswar:"",setminus:"",setmn:"",sext:"",Sfr:"",sfr:"",sfrown:"",sharp:"",SHCHcy:"",shchcy:"",SHcy:"",shcy:"",ShortDownArrow:"",ShortLeftArrow:"",shortmid:"",shortparallel:"",ShortRightArrow:"",ShortUpArrow:"",shy:"",Sigma:"",sigma:"",sigmaf:"",sigmav:"",sim:"",simdot:"",sime:"",simeq:"",simg:"",simgE:"",siml:"",simlE:"",simne:"",simplus:"",simrarr:"",slarr:"",SmallCircle:"",smallsetminus:"",smashp:"",smeparsl:"",smid:"",smile:"",smt:"",smte:"",smtes:"",SOFTcy:"",softcy:"",sol:"/",solb:"",solbar:"",Sopf:"",sopf:"",spades:"",spadesuit:"",spar:"",sqcap:"",sqcaps:"",sqcup:"",sqcups:"",Sqrt:"",sqsub:"",sqsube:"",sqsubset:"",sqsubseteq:"",sqsup:"",sqsupe:"",sqsupset:"",sqsupseteq:"",squ:"",Square:"",square:"",SquareIntersection:"",SquareSubset:"",SquareSubsetEqual:"",SquareSuperset:"",SquareSupersetEqual:"",SquareUnion:"",squarf:"",squf:"",srarr:"",Sscr:"",sscr:"",ssetmn:"",ssmile:"",sstarf:"",Star:"",star:"",starf:"",straightepsilon:"",straightphi:"",strns:"",Sub:"",sub:"",subdot:"",subE:"",sube:"",subedot:"",submult:"",subnE:"",subne:"",subplus:"",subrarr:"",Subset:"",subset:"",subseteq:"",subseteqq:"",SubsetEqual:"",subsetneq:"",subsetneqq:"",subsim:"",subsub:"",subsup:"",succ:"",succapprox:"",succcurlyeq:"",Succeeds:"",SucceedsEqual:"",SucceedsSlantEqual:"",SucceedsTilde:"",succeq:"",succnapprox:"",succneqq:"",succnsim:"",succsim:"",SuchThat:"",Sum:"",sum:"",sung:"",Sup:"",sup:"",sup1:"",sup2:"",sup3:"",supdot:"",supdsub:"",supE:"",supe:"",supedot:"",Superset:"",SupersetEqual:"",suphsol:"",suphsub:"",suplarr:"",supmult:"",supnE:"",supne:"",supplus:"",Supset:"",supset:"",supseteq:"",supseteqq:"",supsetneq:"",supsetneqq:"",supsim:"",supsub:"",supsup:"",swarhk:"",swArr:"",swarr:"",swarrow:"",swnwar:"",szlig:"",Tab:"	",target:"",Tau:"",tau:"",tbrk:"",Tcaron:"",tcaron:"",Tcedil:"",tcedil:"",Tcy:"",tcy:"",tdot:"",telrec:"",Tfr:"",tfr:"",there4:"",Therefore:"",therefore:"",Theta:"",theta:"",thetasym:"",thetav:"",thickapprox:"",thicksim:"",ThickSpace:"",thinsp:"",ThinSpace:"",thkap:"",thksim:"",THORN:"",thorn:"",Tilde:"",tilde:"",TildeEqual:"",TildeFullEqual:"",TildeTilde:"",times:"",timesb:"",timesbar:"",timesd:"",tint:"",toea:"",top:"",topbot:"",topcir:"",Topf:"",topf:"",topfork:"",tosa:"",tprime:"",TRADE:"",trade:"",triangle:"",triangledown:"",triangleleft:"",trianglelefteq:"",triangleq:"",triangleright:"",trianglerighteq:"",tridot:"",trie:"",triminus:"",TripleDot:"",triplus:"",trisb:"",tritime:"",trpezium:"",Tscr:"",tscr:"",TScy:"",tscy:"",TSHcy:"",tshcy:"",Tstrok:"",tstrok:"",twixt:"",twoheadleftarrow:"",twoheadrightarrow:"",Uacute:"",uacute:"",Uarr:"",uArr:"",uarr:"",Uarrocir:"",Ubrcy:"",ubrcy:"",Ubreve:"",ubreve:"",Ucirc:"",ucirc:"",Ucy:"",ucy:"",udarr:"",Udblac:"",udblac:"",udhar:"",ufisht:"",Ufr:"",ufr:"",Ugrave:"",ugrave:"",uHar:"",uharl:"",uharr:"",uhblk:"",ulcorn:"",ulcorner:"",ulcrop:"",ultri:"",Umacr:"",umacr:"",uml:"",UnderBar:"_",UnderBrace:"",UnderBracket:"",UnderParenthesis:"",Union:"",UnionPlus:"",Uogon:"",uogon:"",Uopf:"",uopf:"",UpArrow:"",Uparrow:"",uparrow:"",UpArrowBar:"",UpArrowDownArrow:"",UpDownArrow:"",Updownarrow:"",updownarrow:"",UpEquilibrium:"",upharpoonleft:"",upharpoonright:"",uplus:"",UpperLeftArrow:"",UpperRightArrow:"",Upsi:"",upsi:"",upsih:"",Upsilon:"",upsilon:"",UpTee:"",UpTeeArrow:"",upuparrows:"",urcorn:"",urcorner:"",urcrop:"",Uring:"",uring:"",urtri:"",Uscr:"",uscr:"",utdot:"",Utilde:"",utilde:"",utri:"",utrif:"",uuarr:"",Uuml:"",uuml:"",uwangle:"",vangrt:"",varepsilon:"",varkappa:"",varnothing:"",varphi:"",varpi:"",varpropto:"",vArr:"",varr:"",varrho:"",varsigma:"",varsubsetneq:"",varsubsetneqq:"",varsupsetneq:"",varsupsetneqq:"",vartheta:"",vartriangleleft:"",vartriangleright:"",Vbar:"",vBar:"",vBarv:"",Vcy:"",vcy:"",VDash:"",Vdash:"",vDash:"",vdash:"",Vdashl:"",Vee:"",vee:"",veebar:"",veeeq:"",vellip:"",Verbar:"",verbar:"|",Vert:"",vert:"|",VerticalBar:"",VerticalLine:"|",VerticalSeparator:"",VerticalTilde:"",VeryThinSpace:"",Vfr:"",vfr:"",vltri:"",vnsub:"",vnsup:"",Vopf:"",vopf:"",vprop:"",vrtri:"",Vscr:"",vscr:"",vsubnE:"",vsubne:"",vsupnE:"",vsupne:"",Vvdash:"",vzigzag:"",Wcirc:"",wcirc:"",wedbar:"",Wedge:"",wedge:"",wedgeq:"",weierp:"",Wfr:"",wfr:"",Wopf:"",wopf:"",wp:"",wr:"",wreath:"",Wscr:"",wscr:"",xcap:"",xcirc:"",xcup:"",xdtri:"",Xfr:"",xfr:"",xhArr:"",xharr:"",Xi:"",xi:"",xlArr:"",xlarr:"",xmap:"",xnis:"",xodot:"",Xopf:"",xopf:"",xoplus:"",xotime:"",xrArr:"",xrarr:"",Xscr:"",xscr:"",xsqcup:"",xuplus:"",xutri:"",xvee:"",xwedge:"",Yacute:"",yacute:"",YAcy:"",yacy:"",Ycirc:"",ycirc:"",Ycy:"",ycy:"",yen:"",Yfr:"",yfr:"",YIcy:"",yicy:"",Yopf:"",yopf:"",Yscr:"",yscr:"",YUcy:"",yucy:"",Yuml:"",yuml:"",Zacute:"",zacute:"",Zcaron:"",zcaron:"",Zcy:"",zcy:"",Zdot:"",zdot:"",zeetrf:"",ZeroWidthSpace:"",Zeta:"",zeta:"",Zfr:"",zfr:"",ZHcy:"",zhcy:"",zigrarr:"",Zopf:"",zopf:"",Zscr:"",zscr:"",zwj:"",zwnj:""}),t.entityMap=t.HTML_ENTITIES})(aI)),aI}var I_={},PV;function FIe(){if(PV)return I_;PV=1;var t=W0(),e=hJ(),r=FT(),n=t.isHTMLEscapableRawTextElement,i=t.isHTMLMimeType,a=t.isHTMLRawTextElement,s=t.hasOwn,o=t.NAMESPACE,u=r.ParseError,h=r.DOMException,f=0,g=1,b=2,v=3,S=4,E=5,P=6,k=7;function L(){}L.prototype={parse:function(ce,fe,Me){var me=this.domBuilder;me.startDocument(),G(fe,fe=Object.create(null)),M(ce,fe,Me,me,this.errorHandler),me.endDocument()}};var O=/&#?\w+;?/g;function M(ce,fe,Me,me,we){var Te=i(me.mimeType);ce.indexOf(e.UNICODE_REPLACEMENT_CHARACTER)>=0&&we.warning("Unicode replacement character detected, source encoding issues?");function ke(_e){if(_e>65535){_e-=65536;var be=55296+(_e>>10),qe=56320+(_e&1023);return String.fromCharCode(be,qe)}else return String.fromCharCode(_e)}function he(_e){var be=_e[_e.length-1]===";"?_e:_e+";";if(!Te&&be!==_e)return we.error("EntityRef: expecting ;"),_e;var qe=e.Reference.exec(be);if(!qe||qe[0].length!==be.length)return we.error("entity not matching Reference production: "+_e),_e;var Qe=be.slice(1,-1);return s(Me,Qe)?Me[Qe]:Qe.charAt(0)==="#"?ke(parseInt(Qe.substring(1).replace("x","0x"))):(we.error("entity not found:"+_e),_e)}function Ee(_e){if(_e>rt){var be=ce.substring(rt,_e).replace(O,he);$e&&De(rt),me.characters(be,0,_e-rt),rt=_e}}var xe=0,Ne=0,Oe=/\r\n?|\n|$/g,$e=me.locator;function De(_e,be){for(;_e>=Ne&&(be=Oe.exec(ce));)xe=Ne,Ne=be.index+be[0].length,$e.lineNumber++;$e.columnNumber=_e-xe+1}for(var it=[{currentNSMap:fe}],Ye=[],rt=0;;){try{var Ie=ce.indexOf("<",rt);if(Ie<0){if(!Te&&Ye.length>0)return we.fatalError("unclosed xml tag(s): "+Ye.join(", "));if(!ce.substring(rt).match(/^\s*$/)){var Mt=me.doc,at=Mt.createTextNode(ce.substring(rt));if(Mt.documentElement)return we.error("Extra content at the end of the document");Mt.appendChild(at),me.currentElement=at}return}if(Ie>rt){var je=ce.substring(rt,Ie);!Te&&Ye.length===0&&(je=je.replace(new RegExp(e.S_OPT.source,"g"),""),je&&we.error("Unexpected content outside root element: '"+je+"'")),Ee(Ie)}switch(ce.charAt(Ie+1)){case"/":var er=ce.indexOf(">",Ie+2),Xt=ce.substring(Ie+2,er>0?er:void 0);if(!Xt)return we.fatalError("end tag name missing");var Yt=er>0&&e.reg("^",e.QName_group,e.S_OPT,"$").exec(Xt);if(!Yt)return we.fatalError('end tag name contains invalid characters: "'+Xt+'"');if(!me.currentElement&&!me.doc.documentElement)return;var pr=Ye[Ye.length-1]||me.currentElement.tagName||me.doc.documentElement.tagName||"";if(pr!==Yt[1]){var vt=Yt[1].toLowerCase();if(!Te||pr.toLowerCase()!==vt)return we.fatalError('Opening and ending tag mismatch: "'+pr+'" != "'+Xt+'"')}var yr=it.pop();Ye.pop();var _r=yr.localNSMap;if(me.endElement(yr.uri,yr.localName,pr),_r)for(var cr in _r)s(_r,cr)&&me.endPrefixMapping(cr);er++;break;case"?":$e&&De(Ie),er=ne(ce,Ie,me,we);break;case"!":$e&&De(Ie),er=H(ce,Ie,me,we,Te);break;default:$e&&De(Ie);var Er=new oe,wr=it[it.length-1].currentNSMap,er=B(ce,Ie,Er,wr,he,we,Te),lr=Er.length;if(Er.closed||(Te&&t.isHTMLVoidElement(Er.tagName)?Er.closed=!0:Ye.push(Er.tagName)),$e&&lr){for(var Ar=z($e,{}),ir=0;ir<lr;ir++){var nt=Er[ir];De(nt.offset),nt.locator=z($e,{})}me.locator=Ar,q(Er,me,wr)&&it.push(Er),me.locator=$e}else q(Er,me,wr)&&it.push(Er);Te&&!Er.closed?er=W(ce,er,Er.tagName,he,me):er++}}catch(_e){if(_e instanceof u)throw _e;if(_e instanceof h)throw new u(_e.name+": "+_e.message,me.locator,_e);we.error("element parse error: "+_e),er=-1}er>rt?rt=er:Ee(Math.max(Ie,rt)+1)}}function z(ce,fe){return fe.lineNumber=ce.lineNumber,fe.columnNumber=ce.columnNumber,fe}function B(ce,fe,Me,me,we,Te,ke){function he(De,it,Ye){if(s(Me.attributeNames,De))return Te.fatalError("Attribute "+De+" redefined");if(!ke&&it.indexOf("<")>=0)return Te.fatalError("Unescaped '<' not allowed in attributes values");Me.addValue(De,it.replace(/[\t\n\r]/g," ").replace(O,we),Ye)}for(var Ee,xe,Ne=++fe,Oe=f;;){var $e=ce.charAt(Ne);switch($e){case"=":if(Oe===g)Ee=ce.slice(fe,Ne),Oe=v;else if(Oe===b)Oe=v;else throw new Error("attribute equal must after attrName");break;case"'":case'"':if(Oe===v||Oe===g)if(Oe===g&&(Te.warning('attribute value must after "="'),Ee=ce.slice(fe,Ne)),fe=Ne+1,Ne=ce.indexOf($e,fe),Ne>0)xe=ce.slice(fe,Ne),he(Ee,xe,fe-1),Oe=E;else throw new Error("attribute value no end '"+$e+"' match");else if(Oe==S)xe=ce.slice(fe,Ne),he(Ee,xe,fe),Te.warning('attribute "'+Ee+'" missed start quot('+$e+")!!"),fe=Ne+1,Oe=E;else throw new Error('attribute value must after "="');break;case"/":switch(Oe){case f:Me.setTagName(ce.slice(fe,Ne));case E:case P:case k:Oe=k,Me.closed=!0;case S:case g:break;case b:Me.closed=!0;break;default:throw new Error("attribute invalid close char('/')")}break;case"":return Te.error("unexpected end of input"),Oe==f&&Me.setTagName(ce.slice(fe,Ne)),Ne;case">":switch(Oe){case f:Me.setTagName(ce.slice(fe,Ne));case E:case P:case k:break;case S:case g:xe=ce.slice(fe,Ne),xe.slice(-1)==="/"&&(Me.closed=!0,xe=xe.slice(0,-1));case b:Oe===b&&(xe=Ee),Oe==S?(Te.warning('attribute "'+xe+'" missed quot(")!'),he(Ee,xe,fe)):(ke||Te.warning('attribute "'+xe+'" missed value!! "'+xe+'" instead!!'),he(xe,xe,fe));break;case v:if(!ke)return Te.fatalError(`AttValue: ' or " expected`)}return Ne;case"":$e=" ";default:if($e<=" ")switch(Oe){case f:Me.setTagName(ce.slice(fe,Ne)),Oe=P;break;case g:Ee=ce.slice(fe,Ne),Oe=b;break;case S:var xe=ce.slice(fe,Ne);Te.warning('attribute "'+xe+'" missed quot(")!!'),he(Ee,xe,fe);case E:Oe=P;break}else switch(Oe){case b:ke||Te.warning('attribute "'+Ee+'" missed value!! "'+Ee+'" instead2!!'),he(Ee,Ee,fe),fe=Ne,Oe=g;break;case E:Te.warning('attribute space is required"'+Ee+'"!!');case P:Oe=g,fe=Ne;break;case v:Oe=S,fe=Ne;break;case k:throw new Error("elements closed character '/' and '>' must be connected to")}}Ne++}}function q(ce,fe,Me){for(var me=ce.tagName,we=null,Oe=ce.length;Oe--;){var Te=ce[Oe],ke=Te.qName,he=Te.value,$e=ke.indexOf(":");if($e>0)var Ee=Te.prefix=ke.slice(0,$e),xe=ke.slice($e+1),Ne=Ee==="xmlns"&&xe;else xe=ke,Ee=null,Ne=ke==="xmlns"&&"";Te.localName=xe,Ne!==!1&&(we==null&&(we=Object.create(null),G(Me,Me=Object.create(null))),Me[Ne]=we[Ne]=he,Te.uri=o.XMLNS,fe.startPrefixMapping(Ne,he))}for(var Oe=ce.length;Oe--;)Te=ce[Oe],Te.prefix&&(Te.prefix==="xml"&&(Te.uri=o.XML),Te.prefix!=="xmlns"&&(Te.uri=Me[Te.prefix]));var $e=me.indexOf(":");$e>0?(Ee=ce.prefix=me.slice(0,$e),xe=ce.localName=me.slice($e+1)):(Ee=null,xe=ce.localName=me);var De=ce.uri=Me[Ee||""];if(fe.startElement(De,xe,me,ce),ce.closed){if(fe.endElement(De,xe,me),we)for(Ee in we)s(we,Ee)&&fe.endPrefixMapping(Ee)}else return ce.currentNSMap=Me,ce.localNSMap=we,!0}function W(ce,fe,Me,me,we){var Te=n(Me);if(Te||a(Me)){var ke=ce.indexOf("</"+Me+">",fe),he=ce.substring(fe+1,ke);return Te&&(he=he.replace(O,me)),we.characters(he,0,he.length),ke}return fe+1}function G(ce,fe){for(var Me in ce)s(ce,Me)&&(fe[Me]=ce[Me])}function ie(ce,fe){var Me=fe;function me(Ne){return Ne=Ne||0,ce.charAt(Me+Ne)}function we(Ne){Ne=Ne||1,Me+=Ne}function Te(){for(var Ne=0;Me<ce.length;){var Oe=me();if(Oe!==" "&&Oe!==`
`&&Oe!=="	"&&Oe!=="\r")return Ne;Ne++,we()}return-1}function ke(){return ce.substring(Me)}function he(Ne){return ce.substring(Me,Me+Ne.length)===Ne}function Ee(Ne){return ce.substring(Me,Me+Ne.length).toUpperCase()===Ne.toUpperCase()}function xe(Ne){var Oe=e.reg("^",Ne),$e=Oe.exec(ke());return $e?(we($e[0].length),$e[0]):null}return{char:me,getIndex:function(){return Me},getMatch:xe,getSource:function(){return ce},skip:we,skipBlanks:Te,substringFromIndex:ke,substringStartsWith:he,substringStartsWithCaseInsensitive:Ee}}function Q(ce,fe){function Me(he,Ee){var xe=e.PI.exec(he.substringFromIndex());return xe?xe[1].toLowerCase()==="xml"?Ee.fatalError("xml declaration is only allowed at the start of the document, but found at position "+he.getIndex()):(he.skip(xe[0].length),xe[0]):Ee.fatalError("processing instruction is not well-formed at position "+he.getIndex())}var me=ce.getSource();if(ce.char()==="["){ce.skip(1);for(var we=ce.getIndex();ce.getIndex()<me.length;){if(ce.skipBlanks(),ce.char()==="]"){var Te=me.substring(we,ce.getIndex());return ce.skip(1),Te}var ke=null;if(ce.char()==="<"&&ce.char(1)==="!")switch(ce.char(2)){case"E":ce.char(3)==="L"?ke=ce.getMatch(e.elementdecl):ce.char(3)==="N"&&(ke=ce.getMatch(e.EntityDecl));break;case"A":ke=ce.getMatch(e.AttlistDecl);break;case"N":ke=ce.getMatch(e.NotationDecl);break;case"-":ke=ce.getMatch(e.Comment);break}else if(ce.char()==="<"&&ce.char(1)==="?")ke=Me(ce,fe);else if(ce.char()==="%")ke=ce.getMatch(e.PEReference);else return fe.fatalError("Error detected in Markup declaration");if(!ke)return fe.fatalError("Error in internal subset at position "+ce.getIndex())}return fe.fatalError("doctype internal subset is not well-formed, missing ]")}}function H(ce,fe,Me,me,we){var Te=ie(ce,fe);switch(we?Te.char(2).toUpperCase():Te.char(2)){case"-":var ke=Te.getMatch(e.Comment);return ke?(Me.comment(ke,e.COMMENT_START.length,ke.length-e.COMMENT_START.length-e.COMMENT_END.length),Te.getIndex()):me.fatalError("comment is not well-formed at position "+Te.getIndex());case"[":var he=Te.getMatch(e.CDSect);return he?!we&&!Me.currentElement?me.fatalError("CDATA outside of element"):(Me.startCDATA(),Me.characters(he,e.CDATA_START.length,he.length-e.CDATA_START.length-e.CDATA_END.length),Me.endCDATA(),Te.getIndex()):me.fatalError("Invalid CDATA starting at position "+fe);case"D":{if(Me.doc&&Me.doc.documentElement)return me.fatalError("Doctype not allowed inside or after documentElement at position "+Te.getIndex());if(we?!Te.substringStartsWithCaseInsensitive(e.DOCTYPE_DECL_START):!Te.substringStartsWith(e.DOCTYPE_DECL_START))return me.fatalError("Expected "+e.DOCTYPE_DECL_START+" at position "+Te.getIndex());if(Te.skip(e.DOCTYPE_DECL_START.length),Te.skipBlanks()<1)return me.fatalError("Expected whitespace after "+e.DOCTYPE_DECL_START+" at position "+Te.getIndex());var Ee={name:void 0,publicId:void 0,systemId:void 0,internalSubset:void 0};if(Ee.name=Te.getMatch(e.Name),!Ee.name)return me.fatalError("doctype name missing or contains unexpected characters at position "+Te.getIndex());if(we&&Ee.name.toLowerCase()!=="html"&&me.warning("Unexpected DOCTYPE in HTML document at position "+Te.getIndex()),Te.skipBlanks(),Te.substringStartsWith(e.PUBLIC)||Te.substringStartsWith(e.SYSTEM)){var xe=e.ExternalID_match.exec(Te.substringFromIndex());if(!xe)return me.fatalError("doctype external id is not well-formed at position "+Te.getIndex());xe.groups.SystemLiteralOnly!==void 0?Ee.systemId=xe.groups.SystemLiteralOnly:(Ee.systemId=xe.groups.SystemLiteral,Ee.publicId=xe.groups.PubidLiteral),Te.skip(xe[0].length)}else if(we&&Te.substringStartsWithCaseInsensitive(e.SYSTEM)){if(Te.skip(e.SYSTEM.length),Te.skipBlanks()<1)return me.fatalError("Expected whitespace after "+e.SYSTEM+" at position "+Te.getIndex());if(Ee.systemId=Te.getMatch(e.ABOUT_LEGACY_COMPAT_SystemLiteral),!Ee.systemId)return me.fatalError("Expected "+e.ABOUT_LEGACY_COMPAT+" in single or double quotes after "+e.SYSTEM+" at position "+Te.getIndex())}return we&&Ee.systemId&&!e.ABOUT_LEGACY_COMPAT_SystemLiteral.test(Ee.systemId)&&me.warning("Unexpected doctype.systemId in HTML document at position "+Te.getIndex()),we||(Te.skipBlanks(),Ee.internalSubset=Q(Te,me)),Te.skipBlanks(),Te.char()!==">"?me.fatalError("doctype not terminated with > at position "+Te.getIndex()):(Te.skip(1),Me.startDTD(Ee.name,Ee.publicId,Ee.systemId,Ee.internalSubset),Me.endDTD(),Te.getIndex())}default:return me.fatalError('Not well-formed XML starting with "<!" at position '+fe)}}function ne(ce,fe,Me,me){var we=ce.substring(fe).match(e.PI);if(!we)return me.fatalError("Invalid processing instruction starting at position "+fe);if(we[1].toLowerCase()==="xml"){if(fe>0)return me.fatalError("processing instruction at position "+fe+" is an xml declaration which is only at the start of the document");if(!e.XMLDecl.test(ce.substring(fe)))return me.fatalError("xml declaration is not well-formed")}return Me.processingInstruction(we[1],we[2]),fe+we[0].length}function oe(){this.attributeNames=Object.create(null)}return oe.prototype={setTagName:function(ce){if(!e.QName_exact.test(ce))throw new Error("invalid tagName:"+ce);this.tagName=ce},addValue:function(ce,fe,Me){if(!e.QName_exact.test(ce))throw new Error("invalid attribute:"+ce);this.attributeNames[ce]=this.length,this[this.length++]={qName:ce,value:fe,offset:Me}},length:0,getLocalName:function(ce){return this[ce].localName},getLocator:function(ce){return this[ce].locator},getQName:function(ce){return this[ce].qName},getURI:function(ce){return this[ce].uri},getValue:function(ce){return this[ce].value}},I_.XMLReader=L,I_.parseUtils=ie,I_.parseDoctypeCommentOrCData=H,I_}var kV;function BIe(){if(kV)return Og;kV=1;var t=W0(),e=fJ(),r=FT(),n=DIe(),i=FIe(),a=e.DOMImplementation,s=t.hasDefaultHTMLNamespace,o=t.isHTMLMimeType,u=t.isValidMimeType,h=t.MIME_TYPE,f=t.NAMESPACE,g=r.ParseError,b=i.XMLReader;function v(B){return B.replace(/\r[\n\u0085]/g,`
`).replace(/[\r\u0085\u2028\u2029]/g,`
`)}function S(B){if(B=B||{},B.locator===void 0&&(B.locator=!0),this.assign=B.assign||t.assign,this.domHandler=B.domHandler||E,this.onError=B.onError||B.errorHandler,B.errorHandler&&typeof B.errorHandler!="function")throw new TypeError("errorHandler object is no longer supported, switch to onError!");B.errorHandler&&B.errorHandler("warning","The `errorHandler` option has been deprecated, use `onError` instead!",this),this.normalizeLineEndings=B.normalizeLineEndings||v,this.locator=!!B.locator,this.xmlns=this.assign(Object.create(null),B.xmlns)}S.prototype.parseFromString=function(B,q){if(!u(q))throw new TypeError('DOMParser.parseFromString: the provided mimeType "'+q+'" is not valid.');var W=this.assign(Object.create(null),this.xmlns),G=n.XML_ENTITIES,ie=W[""]||null;s(q)?(G=n.HTML_ENTITIES,ie=f.HTML):q===h.XML_SVG_IMAGE&&(ie=f.SVG),W[""]=ie,W.xml=W.xml||f.XML;var Q=new this.domHandler({mimeType:q,defaultNamespace:ie,onError:this.onError}),H=this.locator?{}:void 0;this.locator&&Q.setDocumentLocator(H);var ne=new b;ne.errorHandler=Q,ne.domBuilder=Q;var oe=!t.isHTMLMimeType(q);return oe&&typeof B!="string"&&ne.errorHandler.fatalError("source is not a string"),ne.parse(this.normalizeLineEndings(String(B)),W,G),Q.doc.documentElement||ne.errorHandler.fatalError("missing root element"),Q.doc};function E(B){var q=B||{};this.mimeType=q.mimeType||h.XML_APPLICATION,this.defaultNamespace=q.defaultNamespace||null,this.cdata=!1,this.currentElement=void 0,this.doc=void 0,this.locator=void 0,this.onError=q.onError}function P(B,q){q.lineNumber=B.lineNumber,q.columnNumber=B.columnNumber}E.prototype={startDocument:function(){var B=new a;this.doc=o(this.mimeType)?B.createHTMLDocument(!1):B.createDocument(this.defaultNamespace,"")},startElement:function(B,q,W,G){var ie=this.doc,Q=ie.createElementNS(B,W||q),H=G.length;O(this,Q),this.currentElement=Q,this.locator&&P(this.locator,Q);for(var ne=0;ne<H;ne++){var B=G.getURI(ne),oe=G.getValue(ne),W=G.getQName(ne),ce=ie.createAttributeNS(B,W);this.locator&&P(G.getLocator(ne),ce),ce.value=ce.nodeValue=oe,Q.setAttributeNode(ce)}},endElement:function(B,q,W){this.currentElement=this.currentElement.parentNode},startPrefixMapping:function(B,q){},endPrefixMapping:function(B){},processingInstruction:function(B,q){var W=this.doc.createProcessingInstruction(B,q);this.locator&&P(this.locator,W),O(this,W)},ignorableWhitespace:function(B,q,W){},characters:function(B,q,W){if(B=L.apply(this,arguments),B){if(this.cdata)var G=this.doc.createCDATASection(B);else var G=this.doc.createTextNode(B);this.currentElement?this.currentElement.appendChild(G):/^\s*$/.test(B)&&this.doc.appendChild(G),this.locator&&P(this.locator,G)}},skippedEntity:function(B){},endDocument:function(){this.doc.normalize()},setDocumentLocator:function(B){B&&(B.lineNumber=0),this.locator=B},comment:function(B,q,W){B=L.apply(this,arguments);var G=this.doc.createComment(B);this.locator&&P(this.locator,G),O(this,G)},startCDATA:function(){this.cdata=!0},endCDATA:function(){this.cdata=!1},startDTD:function(B,q,W,G){var ie=this.doc.implementation;if(ie&&ie.createDocumentType){var Q=ie.createDocumentType(B,q,W,G);this.locator&&P(this.locator,Q),O(this,Q),this.doc.doctype=Q}},reportError:function(B,q){if(typeof this.onError=="function")try{this.onError(B,q,this)}catch(W){throw new g("Reporting "+B+' "'+q+'" caused '+W,this.locator)}else console.error("[xmldom "+B+"]	"+q,k(this.locator))},warning:function(B){this.reportError("warning",B)},error:function(B){this.reportError("error",B)},fatalError:function(B){throw this.reportError("fatalError",B),new g(B,this.locator)}};function k(B){if(B)return`
@#[line:`+B.lineNumber+",col:"+B.columnNumber+"]"}function L(B,q,W){return typeof B=="string"?B.substr(q,W):B.length>=q+W||q?new java.lang.String(B,q,W)+"":B}"endDTD,startEntity,endEntity,attributeDecl,elementDecl,externalEntityDecl,internalEntityDecl,resolveEntity,getExternalSubset,notationDecl,unparsedEntityDecl".replace(/\w+/g,function(B){E.prototype[B]=function(){return null}});function O(B,q){B.currentElement?B.currentElement.appendChild(q):B.doc.appendChild(q)}function M(B){if(B==="error")throw"onErrorStopParsing"}function z(){throw"onWarningStopParsing"}return Og.__DOMHandler=E,Og.DOMParser=S,Og.normalizeLineEndings=v,Og.onErrorStopParsing=M,Og.onWarningStopParsing=z,Og}var MV;function zIe(){if(MV)return pa;MV=1;var t=W0();pa.assign=t.assign,pa.hasDefaultHTMLNamespace=t.hasDefaultHTMLNamespace,pa.isHTMLMimeType=t.isHTMLMimeType,pa.isValidMimeType=t.isValidMimeType,pa.MIME_TYPE=t.MIME_TYPE,pa.NAMESPACE=t.NAMESPACE;var e=FT();pa.DOMException=e.DOMException,pa.DOMExceptionName=e.DOMExceptionName,pa.ExceptionCode=e.ExceptionCode,pa.ParseError=e.ParseError;var r=fJ();pa.Attr=r.Attr,pa.CDATASection=r.CDATASection,pa.CharacterData=r.CharacterData,pa.Comment=r.Comment,pa.Document=r.Document,pa.DocumentFragment=r.DocumentFragment,pa.DocumentType=r.DocumentType,pa.DOMImplementation=r.DOMImplementation,pa.Element=r.Element,pa.Entity=r.Entity,pa.EntityReference=r.EntityReference,pa.LiveNodeList=r.LiveNodeList,pa.NamedNodeMap=r.NamedNodeMap,pa.Node=r.Node,pa.NodeList=r.NodeList,pa.Notation=r.Notation,pa.ProcessingInstruction=r.ProcessingInstruction,pa.Text=r.Text,pa.XMLSerializer=r.XMLSerializer;var n=BIe();return pa.DOMParser=n.DOMParser,pa.normalizeLineEndings=n.normalizeLineEndings,pa.onErrorStopParsing=n.onErrorStopParsing,pa.onWarningStopParsing=n.onWarningStopParsing,pa}var jIe=zIe();const dJ=(function(){const t=/\s*/g,e=/^\s*|\s*$/g,r=/\s+/;function n(M){if(!M||!M.length)return 0;for(var z=0,B=0;z<M.length;z++)B=(B<<5)-B+M.charCodeAt(z)|0;return B}function i(M,z){return M.getElementsByTagName(z)}function a(M,z){return M.getAttribute(z)}function s(M,z){return parseFloat(a(M,z))}function o(M,z){const B=i(M,z);return B.length?B[0]:null}function u(M){return M.normalize&&M.normalize(),M}function h(M){for(var z=0,B=[];z<M.length;z++)B[z]=parseFloat(M[z]);return B}function f(M){return M&&u(M),M&&M.textContent||""}function g(M,z){let B={},q,W;for(W=0;W<z.length;W++)q=o(M,z[W]),q&&(B[z[W]]=f(q));return B}function b(M,z){for(const B in z)M[B]=z[B]}function v(M){return h(M.replace(t,"").split(","))}function S(M){const z=M.replace(e,"").split(r),B=[];for(let q=0;q<z.length;q++)B.push(v(z[q]));return B}function E(M){let z=[s(M,"lon"),s(M,"lat")],B=o(M,"ele"),q=o(M,"gpxtpx:hr")||o(M,"hr"),W=o(M,"time"),G;return B&&(G=parseFloat(f(B)),isNaN(G)||z.push(G)),{coordinates:z,time:W?f(W):null,heartRate:q?parseFloat(f(q)):null}}function P(){return{type:"FeatureCollection",features:[]}}let k;if(typeof XMLSerializer<"u")k=new XMLSerializer;else{const M=typeof process=="object"&&!process.browser,z=typeof Titanium=="object";if(typeof exports=="object"&&(M||z))k=jIe.XMLSerializer;else throw new Error("Unable to initialize serializer")}function L(M){return M.xml!==void 0?M.xml:k.serializeToString(M)}return{kml:function(M){const z=P(),B={},q={},W={},G=["Polygon","LineString","Point","Track","gx:Track"],ie=i(M,"Placemark"),Q=i(M,"Style"),H=i(M,"StyleMap");for(let me=0;me<Q.length;me++){const we=n(L(Q[me])).toString(16);B["#"+a(Q[me],"id")]=we,q[we]=Q[me]}for(let me=0;me<H.length;me++){B["#"+a(H[me],"id")]=n(L(H[me])).toString(16);const we=i(H[me],"Pair"),Te={};for(let ke=0;ke<we.length;ke++)Te[f(o(we[ke],"key"))]=f(o(we[ke],"styleUrl"));W["#"+a(H[me],"id")]=Te}for(let me=0;me<ie.length;me++)z.features=z.features.concat(Me(ie[me]));function ne(me){let we,Te;return me=me||"",me.substr(0,1)==="#"&&(me=me.substr(1)),(me.length===6||me.length===3)&&(we=me),me.length===8&&(Te=parseInt(me.substr(0,2),16)/255,we="#"+me.substr(6,2)+me.substr(4,2)+me.substr(2,2)),[we,isNaN(Te)?void 0:Te]}function oe(me){return h(me.split(" "))}function ce(me){let we=i(me,"coord"),Te=[],ke=[];we.length===0&&(we=i(me,"gx:coord"));for(let Ee=0;Ee<we.length;Ee++)Te.push(oe(f(we[Ee])));const he=i(me,"when");for(let Ee=0;Ee<he.length;Ee++)ke.push(f(he[Ee]));return{coords:Te,times:ke}}function fe(me){let we,Te,ke,he,Ee,xe=[],Ne=[];if(o(me,"MultiGeometry"))return fe(o(me,"MultiGeometry"));if(o(me,"MultiTrack"))return fe(o(me,"MultiTrack"));if(o(me,"gx:MultiTrack"))return fe(o(me,"gx:MultiTrack"));for(ke=0;ke<G.length;ke++)if(Te=i(me,G[ke]),Te){for(he=0;he<Te.length;he++)if(we=Te[he],G[ke]==="Point")xe.push({type:"Point",coordinates:v(f(o(we,"coordinates")))});else if(G[ke]==="LineString")xe.push({type:"LineString",coordinates:S(f(o(we,"coordinates")))});else if(G[ke]==="Polygon"){const Oe=i(we,"LinearRing"),$e=[];for(Ee=0;Ee<Oe.length;Ee++)$e.push(S(f(o(Oe[Ee],"coordinates"))));xe.push({type:"Polygon",coordinates:$e})}else if(G[ke]==="Track"||G[ke]==="gx:Track"){const Oe=ce(we);xe.push({type:"LineString",coordinates:Oe.coords}),Oe.times.length&&Ne.push(Oe.times)}}return{geoms:xe,coordTimes:Ne}}function Me(me){let we=fe(me),Te,ke={},he=f(o(me,"name")),Ee=f(o(me,"address")),xe=f(o(me,"styleUrl")),Ne=f(o(me,"description")),Oe=o(me,"TimeSpan"),$e=o(me,"TimeStamp"),De=o(me,"ExtendedData"),it=o(me,"LineStyle"),Ye=o(me,"PolyStyle"),rt=o(me,"visibility");if(!we.geoms.length)return[];if(he&&(ke.name=he),Ee&&(ke.address=Ee),xe){xe[0]!=="#"&&(xe="#"+xe),ke.styleUrl=xe,B[xe]&&(ke.styleHash=B[xe]),W[xe]&&(ke.styleMapHash=W[xe],ke.styleHash=B[W[xe].normal]);const Mt=q[ke.styleHash];if(Mt){it||(it=o(Mt,"LineStyle")),Ye||(Ye=o(Mt,"PolyStyle"));const at=o(Mt,"IconStyle");if(at){const je=o(at,"Icon");if(je){const Xt=f(o(je,"href"));Xt&&(ke.icon=Xt)}}}}if(Ne&&(ke.description=Ne),Oe){const Mt=f(o(Oe,"begin")),at=f(o(Oe,"end"));ke.timespan={begin:Mt,end:at}}if($e&&(ke.timestamp=f(o($e,"when"))),it){const Mt=ne(f(o(it,"color"))),at=Mt[0],je=Mt[1],Xt=parseFloat(f(o(it,"width")));at&&(ke.stroke=at),isNaN(je)||(ke["stroke-opacity"]=je),isNaN(Xt)||(ke["stroke-width"]=Xt)}if(Ye){const Mt=ne(f(o(Ye,"color"))),at=Mt[0],je=Mt[1],Xt=f(o(Ye,"fill")),Yt=f(o(Ye,"outline"));at&&(ke.fill=at),isNaN(je)||(ke["fill-opacity"]=je),Xt&&(ke["fill-opacity"]=Xt==="1"?ke["fill-opacity"]||1:0),Yt&&(ke["stroke-opacity"]=Yt==="1"?ke["stroke-opacity"]||1:0)}if(De){const Mt=i(De,"Data"),at=i(De,"SimpleData");for(Te=0;Te<Mt.length;Te++)ke[Mt[Te].getAttribute("name")]=f(o(Mt[Te],"value"));for(Te=0;Te<at.length;Te++)ke[at[Te].getAttribute("name")]=f(at[Te])}rt&&(ke.visibility=f(rt)),we.coordTimes.length&&(ke.coordTimes=we.coordTimes.length===1?we.coordTimes[0]:we.coordTimes);const Ie={type:"Feature",geometry:we.geoms.length===1?we.geoms[0]:{type:"GeometryCollection",geometries:we.geoms},properties:ke};return a(me,"id")&&(Ie.id=a(me,"id")),[Ie]}return z},gpx:function(M){let z,B=i(M,"trk"),q=i(M,"rte"),W=i(M,"wpt"),G=P(),ie;for(z=0;z<B.length;z++)ie=ne(B[z]),ie&&G.features.push(ie);for(z=0;z<q.length;z++)ie=oe(q[z]),ie&&G.features.push(ie);for(z=0;z<W.length;z++)G.features.push(ce(W[z]));function Q(me,we){for(let Te=0;Te<we;Te++)me.push(null);return me}function H(me,we){const Te=i(me,we),ke=[],he=[],Ee=[],xe=Te.length;if(xe<2)return{};for(let Ne=0;Ne<xe;Ne++){const Oe=E(Te[Ne]);ke.push(Oe.coordinates),Oe.time&&he.push(Oe.time),(Oe.heartRate||Ee.length)&&(Ee.length||Q(Ee,Ne),Ee.push(Oe.heartRate||null))}return{line:ke,times:he,heartRates:Ee}}function ne(me){let we=i(me,"trkseg"),Te=[],ke=[],he=[],Ee;for(let Ne=0;Ne<we.length;Ne++)if(Ee=H(we[Ne],"trkpt"),Ee&&(Ee.line&&Te.push(Ee.line),Ee.times&&Ee.times.length&&ke.push(Ee.times),he.length||Ee.heartRates&&Ee.heartRates.length)){if(!he.length)for(let Oe=0;Oe<Ne;Oe++)he.push(Q([],Te[Oe].length));Ee.heartRates&&Ee.heartRates.length?he.push(Ee.heartRates):he.push(Q([],Ee.line.length||0))}if(Te.length===0)return;const xe=Me(me);return b(xe,fe(o(me,"extensions"))),ke.length&&(xe.coordTimes=Te.length===1?ke[0]:ke),he.length&&(xe.heartRates=Te.length===1?he[0]:he),{type:"Feature",properties:xe,geometry:{type:Te.length===1?"LineString":"MultiLineString",coordinates:Te.length===1?Te[0]:Te}}}function oe(me){const we=H(me,"rtept");if(!we.line)return;const Te=Me(me);return b(Te,fe(o(me,"extensions"))),{type:"Feature",properties:Te,geometry:{type:"LineString",coordinates:we.line}}}function ce(me){const we=Me(me);return b(we,g(me,["sym"])),{type:"Feature",properties:we,geometry:{type:"Point",coordinates:E(me).coordinates}}}function fe(me){const we={};if(me){const Te=o(me,"line");if(Te){const ke=f(o(Te,"color")),he=parseFloat(f(o(Te,"opacity"))),Ee=parseFloat(f(o(Te,"width")));ke&&(we.stroke=ke),isNaN(he)||(we["stroke-opacity"]=he),isNaN(Ee)||(we["stroke-width"]=Ee*96/25.4)}}return we}function Me(me){const we=g(me,["name","cmt","desc","type","time","keywords"]),Te=i(me,"link");Te.length&&(we.links=[]);for(let ke=0,he;ke<Te.length;ke++)he={href:a(Te[ke],"href")},b(he,g(Te[ke],["text","type"])),we.links.push(he);return we}return G}}})(),FS=t=>{const[e,r]=ee.useState(),[n,i]=ee.useState([]),a=s=>{try{i([]);const u=new DOMParser().parseFromString(s,"application/xml");u.querySelector("metadata")?.childNodes.forEach(g=>{let b=g.textContent;const v=g.nodeName;if(g.nodeName==="link"&&(b=g.getAttribute("href")??""),b?.trim().length){const S={title:v,value:b,id:new Date().getTime()};i(E=>[...E,S])}});const f=dJ.gpx(u);r(f)}catch(o){console.log(o)}};return ee.useEffect(()=>{t.data&&a(t.data)},[t.data]),{geojson:e,metadata:n}};FS.defaultProps={data:void 0};try{FS.displayName="useGpx",FS.__docgenInfo={description:"useGpx hook converts GPX data to GeoJSON",displayName:"useGpx",props:{data:{defaultValue:{value:"undefined"},description:"a string containing GPX data that is supposed to be parsed and converted to GeoJSON by this hook",name:"data",required:!1,type:{name:"string | undefined"}}}}}catch{}const BS=t=>{const e=ha({mapId:t.mapId,waitForLayer:t.layerId}),r=ee.useRef(new kE.Popup({closeButton:!1,closeOnClick:!0}));return ee.useEffect(()=>{!e.map||!t.layerId||e.map.on("mouseenter",t.layerId,n=>{if(!e.map)return;const i=n?.features?.[0].geometry.coordinates.slice();let a="";if(n?.features?.[0]&&typeof t.getPopupContent=="function"&&(a=t.getPopupContent(n.features[0])),i?.[0]){for(;Math.abs(n.lngLat.lng-i[0])>180;)i[0]+=n.lngLat.lng>i[0]?360:-360;r.current.setLngLat(i).setHTML(a).addTo(e.map.map)}},e.componentId)},[e.map]),K.jsx(K.Fragment,{})};BS.defaultProps={mapId:void 0};try{BS.displayName="LayerHoverPopup",BS.__docgenInfo={description:"useLayerHoverPopup hook registers a mouseenter event to display feature properties in a MapLibre popup if a feature on the configured layer is hovered",displayName:"LayerHoverPopup",props:{mapId:{defaultValue:{value:"undefined"},description:"Id of the target MapLibre instance in mapContext",name:"mapId",required:!1,type:{name:"string | undefined"}},layerId:{defaultValue:null,description:"Id of an existing layer in the mapLibre instance this event will be registered to",name:"layerId",required:!1,type:{name:"string | undefined"}},getPopupContent:{defaultValue:null,description:"",name:"getPopupContent",required:!0,type:{name:"(feature: Feature<Geometry, GeoJsonProperties>) => string"}}}}}catch{}const RV=t=>{const e=FS({data:t.gpxData}),r=ha({mapId:t.mapId,waitForLayer:t.insertBeforeLayer}),n=ee.useRef("gpx-viewer-source-"+_c()),i=ee.useRef("importer-layer-lines-"+_c()),a=ee.useRef("importer-layer-points-"+_c());return BS({layerId:a.current,getPopupContent:s=>s?.properties?.name}),QO({mapId:t.mapId,sourceId:n.current,source:{type:"geojson",data:e.geojson||Xd([])}}),Yd({layerId:i.current,options:{type:"line",paint:{"line-width":4,"line-color":"rgba(212, 55, 23,0.5)"},source:n.current},insertBeforeLayer:t.insertBeforeLayer}),Yd({layerId:a.current,options:{type:"circle",paint:{"circle-color":"rgba(72, 77, 99,0.5)","circle-radius":7},filter:["==","$type","Point"],source:n.current},insertBeforeLayer:t.insertBeforeLayer}),ee.useEffect(()=>{if(!r.map||!e.geojson)return;typeof t.onParseGpxData=="function"&&t.onParseGpxData(e);const s=ih(e.geojson);r.map.map.fitBounds(s)},[e]),K.jsx(K.Fragment,{})};try{RV.displayName="MlGpxViewer",RV.__docgenInfo={description:"MlGpxViewer visualizes a given GPX Track on the map",displayName:"MlGpxViewer",props:{mapId:{defaultValue:null,description:"Id of the target MapLibre instance in mapHook",name:"mapId",required:!1,type:{name:"string | undefined"}},insertBeforeLayer:{defaultValue:null,description:`The layerId of an existing layer this layer should be rendered visually beneath
https://maplibre.org/maplibre-gl-js-docs/api/map/#map#addlayer - see "beforeId" property`,name:"insertBeforeLayer",required:!1,type:{name:"string | undefined"}},idPrefix:{defaultValue:null,description:"Prefix of the component id this component uses when adding elements to the MapLibreGl-instance",name:"idPrefix",required:!1,type:{name:"string | undefined"}},gpxData:{defaultValue:null,description:"",name:"gpxData",required:!0,type:{name:"string | undefined"}},onParseGpxData:{defaultValue:null,description:"",name:"onParseGpxData",required:!0,type:{name:"(arg0: { geojson: FeatureCollection<Geometry, GeoJsonProperties> | undefined; metadata: MetadataType[]; }) => void"}}}}}catch{}const UIe=ht.createContext({}),VIe=UIe.Provider,OV=({children:t})=>{const[e,r]=ee.useState({type:"FeatureCollection",features:[]}),i={data:e,setData:r,getEmptyFeatureCollection:()=>({type:"FeatureCollection",features:[]})};return K.jsx(VIe,{value:i,children:t})};try{OV.displayName="GeoJsonProvider",OV.__docgenInfo={description:"",displayName:"GeoJsonProvider",props:{}}}catch{}const tM=()=>{const t=Object.fromEntries(new URLSearchParams(window.location.search));return t.layers=JSON.parse(t?.layers?t.layers:"[]"),t},oI=tM(),LV=t=>{const e=ee.useContext(og),r=ee.useRef(!1),n=ee.useRef(null),[i,a]=ee.useState(void 0),s=ee.useRef({}),o=ee.useRef((t.idPrefix?t.idPrefix:"MlShareMapState-")+_c()),u=XE({watch:{viewport:!1,layers:!0,sources:!1},filter:{includeBaseLayers:!1}}),h=ee.useRef(!1),f=ee.useRef(null),g=ee.useRef({viewport:{center:!1,bearing:!1,pitch:!1,zoom:!1},layers:{...s}}),b=ee.useRef({}),v=ee.useCallback(()=>{if(!t.active)return;const P=[];for(const O in u.layers)P.push({id:u.layers[O]?.id,type:u.layers[O]?.type,visible:u.layers[O]?.visible});S();const k=new URLSearchParams({...tM(),...b.current,layers:JSON.stringify(P)});JSON.parse(Object.fromEntries(k).layers).forEach(O=>{s.current[O.id]=!1});const L=new URLSearchParams(window.location.search);k.toString()!==L.toString()&&window.history.pushState({...b.current},document.title,"?"+k.toString())},[u.layers,t.active]);ee.useEffect(()=>{const P=o.current;return b.current=tM(),()=>{n.current&&(n.current.cleanup(P),n.current=null),r.current=!1}},[]),ee.useEffect(()=>{n.current&&v()},[v]),ee.useEffect(()=>{if(!n.current)return;const P=v;return n.current.on("moveend",P,o.current),()=>{n.current?.map.off("moveend",P)}},[v,i]),ee.useEffect(()=>{!e?.mapExists?.(t.mapId)||r.current||(r.current=!0,n.current=e.getMap(t.mapId),a(n.current),b.current.lat&&b.current.lng&&E())},[e.mapIds,e,t.mapId,t.active]),ee.useEffect(()=>{if(u?.layers?.length){typeof f.current>"u"&&(f.current=null,oI?.layers?.forEach(P=>{f.current?.[P.id]&&(f.current[P.id]=!1)}));for(const P in f.current){let k=!0;if(f.current[P]===!1&&(k=!1),k)return}oI.layers&&oI.layers.forEach(P=>{n.current?.map.getLayer(P.id)&&f.current?.[P.id]===!1&&(f.current[P.id]=!0,n.current.map?.getLayer(P.id)?.setLayoutProperty("visibility",P.visible?"visible":"none"))})}},[u.layers,t.mapId,t.active]),ee.useEffect(()=>{i&&u.layers&&(t.active||i.cleanup(o.current))},[t.active,i,u.layers]);const S=()=>{b.current.lat=n.current?.map.getCenter().lat,b.current.lng=n.current?.map.getCenter().lng,b.current.zoom=n.current?.map.getZoom(),b.current.bearing=n.current?.map.getBearing(),b.current.pitch=n.current?.map.getPitch()},E=()=>{g.current.viewport.center||(g.current.viewport.center=!0,b.current.lng&&b.current.lat&&n.current?.map.setCenter([b.current.lng,b.current.lat]),b.current.zoom&&n.current?.map.setZoom(b.current.zoom),b.current.bearing&&n.current?.map.setBearing(b.current.bearing),b.current.pitch&&n.current?.map.setPitch(b.current.pitch)),h.current=!0};return window.onpopstate=P=>{P.state&&P.state.lng&&P.state.lat&&P.state.zoom&&n.current?.map.easeTo({zoom:P.state.zoom,center:[P.state.lng,P.state.lat]})},K.jsx(K.Fragment,{})};try{LV.displayName="MlShareMapState",LV.__docgenInfo={description:"",displayName:"MlShareMapState",props:{mapId:{defaultValue:null,description:"",name:"mapId",required:!1,type:{name:"string | undefined"}},idPrefix:{defaultValue:null,description:"",name:"idPrefix",required:!1,type:{name:"string | undefined"}},active:{defaultValue:null,description:"",name:"active",required:!1,type:{name:"boolean | undefined"}}}}}catch{}function $Ie(t,e){const r=(s,o,u,h,f)=>{const g=gu([[s,o],[h,f]]),b=s2e(g,5,{units:"meters"}),v=b.geometry.coordinates[0][0],S=b.geometry.coordinates[0][1],E=b.geometry.coordinates[1][0],P=b.geometry.coordinates[1][1];return gT([[[s,o],[h,f],[E,P],[v,S],[s,o]]],{height:u*e})},n=(s,o,u)=>s*(1-u)+o*u,i=[];return t.line.geometry.coordinates.forEach((s,o)=>{if(t.line.geometry.coordinates[o+1]&&Array.isArray(s)){let h=~~(mT([s[0],s[1]],[t.line.geometry.coordinates[o+1][0],t.line.geometry.coordinates[o+1][1]],{units:"kilometers"})*1e3/10);h=h<1?1:h;for(let f=0;f<h;f++){const g=n(t.line.geometry.coordinates[o][0],t.line.geometry.coordinates[o+1][0],f/h),b=n(t.line.geometry.coordinates[o][1],t.line.geometry.coordinates[o+1][1],f/h),v=n(t.line.geometry.coordinates[o][2]-t.min,t.line.geometry.coordinates[o+1][2]-t.min,f/h),S=n(t.line.geometry.coordinates[o][0],t.line.geometry.coordinates[o+1][0],(f+1)/h),E=n(t.line.geometry.coordinates[o][1],t.line.geometry.coordinates[o+1][1],(f+1)/h),P=r(g,b,v,S,E);i.push(P)}}}),Xd(i)}const NV=["interpolate",["linear"],["get","height"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"yellow"],DV=t=>{const e=ee.useRef("elevationprofile-"+_c()),r=ee.useRef("elevationprofile-layer-"+_c()),n=t.elevationFactor||1,i=ee.useMemo(()=>{if(!t?.geojson?.features)return;const o=t.geojson.features?.find(g=>g.geometry.type==="LineString");if(!o||!o.geometry)return;const u=o.geometry.coordinates.map(g=>g[2]),h=Math.min(...u);let f=Math.max(...u)-h;return f=f===0?1:f,{max:f,min:h,line:o}},[t.geojson]),a=ee.useMemo(()=>i?["interpolate",["linear"],["get","height"],0,"rgb(0,255,55)",i.max*n,"rgb(255,0,0)"]:NV,[i,t.elevationFactor]),s=ee.useMemo(()=>!t.geojson?.features||!i?void 0:$Ie(i,n),[i,n]);return QO({mapId:t.mapId,sourceId:e.current,source:{type:"geojson",data:s||Xd([])}}),Yd({layerId:r.current,options:{source:e.current,type:"fill-extrusion",paint:{"fill-extrusion-height":["get","height"],"fill-extrusion-opacity":.9,"fill-extrusion-color":a||NV}},insertBeforeLayer:t.insertBeforeLayer}),K.jsx(K.Fragment,{})};try{DV.displayName="MlSpatialElevationProfile",DV.__docgenInfo={description:"",displayName:"MlSpatialElevationProfile",props:{mapId:{defaultValue:null,description:"Id of the target MapLibre instance in mapContext",name:"mapId",required:!1,type:{name:"string | undefined"}},geojson:{defaultValue:null,description:"GeoJSON data that is supposed to be rendered by this component.",name:"geojson",required:!0,type:{name:"FeatureCollection<Geometry, GeoJsonProperties> | geojson | undefined"}},idPrefix:{defaultValue:null,description:"Prefix of the component id this component uses when adding elements to the MapLibreGl-instance",name:"idPrefix",required:!1,type:{name:"string | undefined"}},elevationFactor:{defaultValue:null,description:"Number describes the factor of the height of the elevation",name:"elevationFactor",required:!1,type:{name:"number | undefined"}},insertBeforeLayer:{defaultValue:null,description:`The layerId of an existing layer this layer should be rendered visually beneath
https://maplibre.org/maplibre-gl-js-docs/api/map/#map#addlayer - see "beforeId" property`,name:"insertBeforeLayer",required:!1,type:{name:"string | undefined"}}}}}catch{}const Gv=t=>{const e=ha({mapId:t.mapId,waitForLayer:t.insertBeforeLayer}),r=ee.useRef(t.layerId||"MlVectorTileLayer-"+e.componentId),n=ee.useRef({}),i=ee.useRef({}),a=ee.useRef(!1),s=ee.useCallback(()=>{e.map&&(a.current=!0,e.map.map.getSource(r.current)&&e.cleanup(),e.map.map.getSource(r.current)||e.map.addSource(r.current,{type:"vector",tiles:[t.url||""],attribution:"",minzoom:0,maxzoom:14,...t.sourceOptions},e.componentId),t.layers.forEach(u=>{e.map&&(e.map.addLayer({source:r.current,minzoom:0,maxzoom:22,layout:{},paint:{"line-opacity":.5,"line-color":"rgb(80, 80, 80)","line-width":2},...u},t.insertBeforeLayer,e.componentId),n.current[u.id]=JSON.stringify(u.paint),i.current[u.id]=JSON.stringify(u.layout),e.map.on("styledata",()=>{a.current&&!e.map?.map.getSource(r.current)&&(console.log("Recreate Layer "+r.current),s())},e.componentId))}))},[e.map,t]),o=ee.useCallback(()=>{a.current&&t.layers.forEach(u=>{if(e.map&&e.map.map.getLayer(u.id)){const h=JSON.stringify(u.paint);if(h!==n.current[u.id])for(const g in u.paint)e.map.setPaintProperty(u.id,g,u.paint[g]);n.current[u.id]=h;const f=JSON.stringify(u.layout);if(f!==i.current[u.id])for(const g in u.layout)e.map.setLayoutProperty(u.id,g,u.layout[g]);i.current[u.id]=f}})},[e.map,t.layers]);return ee.useEffect(()=>{a.current||s()},[s]),ee.useEffect(()=>{!e.map||!a.current||s()},[t.layers.length,e.map]),ee.useEffect(()=>{!e.map||!a.current||o()},[t.layers,e.map]),K.jsx(K.Fragment,{})};try{Gv.displayName="MlVectorTileLayer",Gv.__docgenInfo={description:`Adds a vector-tile source and 0...n vector-tile-layers to the MapLibre instance referenced by
props.mapId`,displayName:"MlVectorTileLayer",props:{mapId:{defaultValue:null,description:"",name:"mapId",required:!1,type:{name:"string | undefined"}},insertBeforeLayer:{defaultValue:null,description:"",name:"insertBeforeLayer",required:!1,type:{name:"string | undefined"}},layerId:{defaultValue:null,description:"",name:"layerId",required:!1,type:{name:"string | undefined"}},sourceOptions:{defaultValue:null,description:"",name:"sourceOptions",required:!1,type:{name:"VectorSourceSpecification | undefined"}},url:{defaultValue:null,description:"",name:"url",required:!1,type:{name:"string | undefined"}},layers:{defaultValue:null,description:"",name:"layers",required:!0,type:{name:"ExtendedLayerSpecification[]"}}}}}catch{}const FV=t=>{const[e,r]=ee.useState(),n=ha({mapId:t.mapId}),i=ee.useRef(t.mlGeoJsonLayerProps?.layerId||"MlOgcApiFeature-"+n.componentId),a=()=>{const s=new URL(t.ogcApiUrl);if(t.ogcApiFeatureParams&&Object.entries(t.ogcApiFeatureParams).forEach(([o,u])=>{u!=null&&s.searchParams.append(o,u.toString())}),t.reloadFeaturesOnMapMove){const o=n?.map?.getBounds().getSouthWest(),u=n?.map?.getBounds().getNorthEast(),h=`${o?.lng},${o?.lat},${u?.lng},${u?.lat}`;s.searchParams.append("bbox",h)}return s.toString()};return ee.useEffect(()=>{if(!n.map)return;const s=()=>{const o=a();fetch(o).then(u=>{if(!u.ok)throw new Error("Error fetching OGC features");return u.json()}).then(u=>{r(u)}).catch(u=>{console.log(u),r(void 0)})};return s(),t.reloadFeaturesOnMapMove&&n.map.on("moveend",s),()=>{n?.map?.off&&n.map.off("moveend",s)}},[n.map,t.ogcApiFeatureParams,t.ogcApiUrl]),ee.useEffect(()=>{!n.map||!n.map.map.style.getLayer(i.current)||(t.visible?n.map.map.setLayoutProperty(i.current,"visibility","visible"):n.map.map.setLayoutProperty(i.current,"visibility","none"))},[t.visible,n.map]),K.jsx(K.Fragment,{children:e&&K.jsx(wc,{geojson:e,layerId:i.current,...t.mlGeoJsonLayerProps})})};try{FV.displayName="MlOgcApiFeatures",FV.__docgenInfo={description:"",displayName:"MlOgcApiFeatures",props:{visible:{defaultValue:null,description:"",name:"visible",required:!1,type:{name:"boolean | undefined"}},mapId:{defaultValue:null,description:"Id of the target MapLibre instance in mapContext",name:"mapId",required:!1,type:{name:"string | undefined"}},ogcApiUrl:{defaultValue:null,description:"The url of OGC API",name:"ogcApiUrl",required:!0,type:{name:"URL"}},ogcApiFeatureParams:{defaultValue:null,description:"The additional query parameters of OGC API",name:"ogcApiFeatureParams",required:!1,type:{name:"OgcApiFeaturesParamsTypes | undefined"}},reloadFeaturesOnMapMove:{defaultValue:null,description:"Fetches the features everytime (based on the current bbox) when the map gets moved",name:"reloadFeaturesOnMapMove",required:!1,type:{name:"boolean | undefined"}},mlGeoJsonLayerProps:{defaultValue:null,description:"Geojson Layer props. But omit 'geojson' because it gets set from the OGC API Feature call",name:"mlGeoJsonLayerProps",required:!1,type:{name:'Omit<MlGeoJsonLayerProps, "geojson"> | undefined'}}}}}catch{}const BV=t=>{const e=ee.useContext(og),r=ee.useRef(!1),n=ee.useRef(void 0),i=ee.useRef("MlWmsFeatureInfoPopup-"+_c());return ee.useEffect(()=>{const a=i.current;return()=>{n.current&&(n.current.cleanup(a),n.current=void 0),r.current=!1}},[]),ee.useEffect(()=>{!e.mapExists(t.mapId)||r.current||(r.current=!0,n.current=e.getMap(t.mapId),n.current.setCenter([7.132122000552613,50.716405378037706]))},[e.mapIds,e,t.mapId]),K.jsx(K.Fragment,{})};try{BV.displayName="MlWmsFeatureInfoPopup",BV.__docgenInfo={description:"TODO: Add short & useful description",displayName:"MlWmsFeatureInfoPopup",props:{mapId:{defaultValue:null,description:"Id of the target MapLibre instance in mapContext",name:"mapId",required:!1,type:{name:"string | undefined"}}}}}catch{}const qIe={urlParameters:{bbox:"{bbox-epsg-3857}",format:"image/png",service:"WMS",version:"1.1.1",request:"GetMap",srs:"EPSG:3857",width:"256",height:"256",styles:""}},zS=t=>{const e=ha({mapId:t.mapId,waitForLayer:t.insertBeforeLayer}),r=ee.useRef(!1),n=ee.useRef(t.layerId||"MlWmsLayer-"+e.componentId),i=ee.useMemo(()=>{let s,o=t.url;t.url.indexOf("?")!==-1&&(s=t.url.split("?"),o=s[0]);const u=new URLSearchParams(s?.[1]),h={...qIe.urlParameters,...Object.fromEntries(u),...t.urlParameters},f=new URLSearchParams(h),g=decodeURIComponent(f.toString())+"".replace(/%2F/g,"/").replace(/%3A/g,":");return o+"?"+g},[t.urlParameters,t.url]),a=ee.useCallback(()=>{e.map&&(r.current=!0,e.map.map.getLayer(n.current)&&e.cleanup(),e.map.addSource(n.current,{type:"raster",tiles:[i],tileSize:256,attribution:t.attribution??"",...t.sourceOptions},e.componentId),e.map.addLayer({id:n.current,type:"raster",source:n.current,...t.layerOptions},t.insertBeforeLayer,e.componentId),e.map.on("styledata",()=>{r.current&&!e.map?.map.getLayer(n.current)&&(console.log("Recreate Layer "+n.current),a())},e.componentId),t.visible===!1&&e.map.map.setLayoutProperty(n.current,"visibility","none"))},[e.map,t,i]);return ee.useEffect(()=>{r.current||a()},[a]),ee.useEffect(()=>{if(!e.map||!e.map?.map?.style?.sourceCaches?.[n.current]||!r.current)return;const s=e.map.map.getSource(n.current);s.tiles=[i],e.map.map.style.sourceCaches[n.current].clearTiles(),e.map.map.style.sourceCaches[n.current].update(e.map.map.transform),e.map.map.triggerRepaint()},[e.map,i]),ee.useEffect(()=>{!e.map||!r.current||(t.visible===void 0||t.visible?e.map.map.setLayoutProperty(n.current,"visibility","visible"):e.map.map.setLayoutProperty(n.current,"visibility","none"))},[t.visible,e.map]),K.jsx(K.Fragment,{})};try{zS.displayName="MlWmsLayer",zS.__docgenInfo={description:"Adds a WMS raster source & layer to the maplibre-gl instance",displayName:"MlWmsLayer",props:{urlParameters:{defaultValue:null,description:"",name:"urlParameters",required:!1,type:{name:"{ [key: string]: string; } | undefined"}},url:{defaultValue:null,description:"",name:"url",required:!0,type:{name:"string"}},visible:{defaultValue:null,description:"",name:"visible",required:!1,type:{name:"boolean | undefined"}},attribution:{defaultValue:null,description:"",name:"attribution",required:!1,type:{name:"string | undefined"}},mapId:{defaultValue:null,description:"",name:"mapId",required:!1,type:{name:"string | undefined"}},sourceOptions:{defaultValue:null,description:"",name:"sourceOptions",required:!1,type:{name:"RasterSourceSpecification | undefined"}},layerOptions:{defaultValue:null,description:"",name:"layerOptions",required:!1,type:{name:"RasterLayerSpecification | undefined"}},insertBeforeLayer:{defaultValue:null,description:"",name:"insertBeforeLayer",required:!1,type:{name:"string | undefined"}},layerId:{defaultValue:null,description:"",name:"layerId",required:!1,type:{name:"string | undefined"}}}}}catch{}/**
 * wms-capabilities @0.6.0
 * @description WMS service Capabilities > JSON, based on openlayers 
 * @license BSD-2-Clause
 * @preserve
 */var sa=t=>t!==void 0,pJ=(t,e,r)=>e in t?t[e]:t[e]=r;const vb={ELEMENT:1,TEXT:3,CDATA_SECTION:4};class HIe{constructor(e){this._parser=new e}toDocument(e){return this._parser.parseFromString(e,"application/xml")}getAllTextContent(e,r){return BT(e,r).join("")}}function BT(t,e){return gJ(t,e,[]).join("")}function gJ(t,e,r){if(t.nodeType===vb.CDATA_SECTION||t.nodeType===vb.TEXT)e?r.push(String(t.nodeValue).replace(/(\r\n|\r|\n)/g,"")):r.push(t.nodeValue);else{var n;for(n=t.firstChild;n;n=n.nextSibling)gJ(n,e,r)}return r}function WIe(t,e,r,n){for(var i=GIe(e);i;i=XIe(i)){var a=i.namespaceURI||null,s=t[a];if(sa(s)){var o=s[i.localName];sa(o)&&o.call(n,i,r)}}}function GIe(t){let e=t.firstElementChild||t.firstChild;for(;e&&e.nodeType!==vb.ELEMENT;)e=e.nextSibling;return e}function XIe(t){let e=t.nextElementSibling||t.nextSibling;for(;e&&e.nodeType!==vb.ELEMENT;)e=e.nextSibling;return e}function vu(t,e,r){return YIe(t,e,r)}function YIe(t,e,r){var n=sa(r)?r:{},i,a;for(i=0,a=t.length;i<a;++i)n[t[i]]=e;return n}function mJ(t,e){return(function(r,n){var i=t.call(sa(e)?e:this,r,n);if(sa(i)){var a=n[n.length-1];a.push(i)}})}function tu(t,e,r,n,i){return n.push(t),WIe(e,r,n,i),n.pop()}function ii(t,e,r){return(function(n,i){let a=t.call(sa(r)?r:this,n,i);if(sa(a)){var s=i[i.length-1],o=sa(e)?e:n.localName;s[o]=a}})}function pc(t,e,r){return(function(n,i){var a=t.call(sa(r)?r:this,n,i);if(sa(a)){var s=i[i.length-1],o=sa(e)?e:n.localName,u=pJ(s,o,[]);u.push(a)}})}const ZIe=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g;function KIe(t){return t.replace(ZIe,"")}function sm(t){const e=/^\s*(true|1)|(false|0)\s*$/.exec(t);if(e)return sa(e[1])||!1}function Pv(t){return Bd(BT(t,!1))}function Bd(t){const e=/^\s*([+\-]?\d*\.?\d+(?:e[+\-]?\d+)?)\s*$/i.exec(t);if(e)return parseFloat(e[1])}function sI(t){return jS(BT(t,!1))}function jS(t){const e=/^\s*(\d+)\s*$/.exec(t);if(e)return parseInt(e[1],10)}function Na(t){return KIe(BT(t,!1))}const JIe="http://www.w3.org/1999/xlink";function QL(t){return t.getAttributeNS(JIe,"href")}function QIe(t,e){return tu({},CPe,t,e)}function yJ(t){return[Bd(t.getAttribute("minx")),Bd(t.getAttribute("miny")),Bd(t.getAttribute("maxx")),Bd(t.getAttribute("maxy"))]}function ePe(t,e){const r=yJ(t),n=[Bd(t.getAttribute("resx")),Bd(t.getAttribute("resy"))];return{crs:t.getAttribute("CRS")||t.getAttribute("SRS"),extent:r,res:n}}function tPe(t,e){const r=yJ(t);if(!(!sa(r[0])||!sa(r[1])||!sa(r[2])||!sa(r[3])))return r}function rPe(t,e){const r=parseFloat(t.getAttribute("min")),n=parseFloat(t.getAttribute("max"));return{min:r,max:n}}function nPe(t,e){const r=tu({},APe,t,e);if(!sa(r))return;const n=r.westBoundLongitude,i=r.southBoundLatitude,a=r.eastBoundLongitude,s=r.northBoundLatitude;if(!(!sa(n)||!sa(i)||!sa(a)||!sa(s)))return[n,i,a,s]}function iPe(t,e){return tu({},bPe,t,e)}function aPe(t,e){return tu({},xPe,t,e)}function oPe(t,e){return tu({},wPe,t,e)}function sPe(t,e){return tu({},SPe,t,e)}function lPe(t,e){return tu({},EPe,t,e)}function uPe(t,e){return tu([],TPe,t,e)}function cPe(t,e){const r=sm(t.getAttribute("queryable"));return tu({queryable:sa(r)?r:!1},bJ,t,e)}function hPe(t,e){var r=e[e.length-1];const n=tu({},bJ,t,e);if(!sa(n))return;let i=sm(t.getAttribute("queryable"));sa(i)||(i=r.queryable),n.queryable=sa(i)?i:!1;let a=jS(t.getAttribute("cascaded"));sa(a)||(a=r.cascaded),n.cascaded=a;let s=sm(t.getAttribute("opaque"));sa(s)||(s=r.opaque),n.opaque=sa(s)?s:!1;let o=sm(t.getAttribute("noSubsets"));sa(o)||(o=r.noSubsets),n.noSubsets=sa(o)?o:!1;let u=Bd(t.getAttribute("fixedWidth"));sa(u)||(u=r.fixedWidth),n.fixedWidth=u;let h=Bd(t.getAttribute("fixedHeight"));sa(h)||(h=r.fixedHeight),n.fixedHeight=h;const f=["Style","CRS","AuthorityURL"];for(let b=0,v=f.length;b<v;b++){const S=f[b],E=r[S];if(sa(E)){let P=pJ(n,S,[]);P=P.concat(E),n[S]=P}}const g=["EX_GeographicBoundingBox","BoundingBox","Dimension","Attribution","MinScaleDenominator","MaxScaleDenominator"];for(let b=0,v=g.length;b<v;b++){const S=g[b],E=n[S];if(!sa(E)){const P=r[S];n[S]=P}}return n}function fPe(t,e){return{name:t.getAttribute("name"),units:t.getAttribute("units"),unitSymbol:t.getAttribute("unitSymbol"),default:t.getAttribute("default"),multipleValues:sm(t.getAttribute("multipleValues")),nearestValue:sm(t.getAttribute("nearestValue")),current:sm(t.getAttribute("current")),values:Na(t)}}function Zd(t,e){return tu({},OPe,t,e)}function dPe(t,e){return tu({},IPe,t,e)}function pPe(t,e){return tu({},kPe,t,e)}function gPe(t,e){return tu({},MPe,t,e)}function lI(t,e){return tu({},PPe,t,e)}function vJ(t,e){var r=Zd(t,e);if(sa(r)){const n=[jS(t.getAttribute("width")),jS(t.getAttribute("height"))];return r.size=n,r}}function mPe(t,e){var r=Zd(t,e);if(sa(r))return r.name=t.getAttribute("name"),r}function yPe(t,e){var r=Zd(t,e);if(sa(r))return r.type=t.getAttribute("type"),r}function vPe(t,e){return tu({},RPe,t,e)}function _J(t,e){return tu([],LPe,t,e)}const _u=[null,"http://www.opengis.net/wms"],_Pe=vu(_u,{Service:ii(aPe),Capability:ii(iPe)}),bPe=vu(_u,{Request:ii(dPe),Exception:ii(uPe),Layer:ii(cPe)}),xPe=vu(_u,{Name:ii(Na),Title:ii(Na),Abstract:ii(Na),KeywordList:ii(_J),OnlineResource:ii(QL),ContactInformation:ii(oPe),Fees:ii(Na),AccessConstraints:ii(Na),LayerLimit:ii(sI),MaxWidth:ii(sI),MaxHeight:ii(sI)}),wPe=vu(_u,{ContactPersonPrimary:ii(sPe),ContactPosition:ii(Na),ContactAddress:ii(lPe),ContactVoiceTelephone:ii(Na),ContactFacsimileTelephone:ii(Na),ContactElectronicMailAddress:ii(Na)}),SPe=vu(_u,{ContactPerson:ii(Na),ContactOrganization:ii(Na)}),EPe=vu(_u,{AddressType:ii(Na),Address:ii(Na),City:ii(Na),StateOrProvince:ii(Na),PostCode:ii(Na),Country:ii(Na)}),TPe=vu(_u,{Format:mJ(Na)}),bJ=vu(_u,{Name:ii(Na),Title:ii(Na),Abstract:ii(Na),KeywordList:ii(_J),CRS:pc(Na),SRS:pc(Na),EX_GeographicBoundingBox:ii(nPe),LatLonBoundingBox:ii(tPe),BoundingBox:pc(ePe),Dimension:pc(fPe),Attribution:ii(QIe),AuthorityURL:pc(mPe),Identifier:pc(Na),MetadataURL:pc(yPe),DataURL:pc(Zd),FeatureListURL:pc(Zd),Style:pc(vPe),MinScaleDenominator:ii(Pv),MaxScaleDenominator:ii(Pv),ScaleHint:ii(rPe),Layer:pc(hPe)}),CPe=vu(_u,{Title:ii(Na),OnlineResource:ii(QL),LogoURL:ii(vJ)}),APe=vu(_u,{westBoundLongitude:ii(Pv),eastBoundLongitude:ii(Pv),southBoundLatitude:ii(Pv),northBoundLatitude:ii(Pv)}),IPe=vu(_u,{GetCapabilities:ii(lI),GetMap:ii(lI),GetFeatureInfo:ii(lI)}),PPe=vu(_u,{Format:pc(Na),DCPType:pc(pPe)}),kPe=vu(_u,{HTTP:ii(gPe)}),MPe=vu(_u,{Get:ii(Zd),Post:ii(Zd)}),RPe=vu(_u,{Name:ii(Na),Title:ii(Na),Abstract:ii(Na),LegendURL:pc(vJ),StyleSheetURL:ii(Zd),StyleURL:ii(Zd)}),OPe=vu(_u,{Format:ii(Na),OnlineResource:ii(QL)}),LPe=vu(_u,{Keyword:mJ(Na)});class NPe{constructor(e,r){!r&&typeof window<"u"&&(r=window.DOMParser),this.version=void 0,this._parser=new HIe(r),this._data=e}data(e){return this._data=e,this}toJSON(e){return e=e||this._data,this.parse(e)}parse(e){return this.readFromDocument(this._parser.toDocument(e))}readFromDocument(e){for(let r=e.firstChild;r;r=r.nextSibling)if(r.nodeType==vb.ELEMENT)return this.readFromNode(r);return null}readFromNode(e){return this.version=e.getAttribute("version"),tu({version:this.version},_Pe,e,[])||null}}function xJ(t){const[e,r]=ee.useState(),[n,i]=ee.useState(t.url),[a,s]=ee.useState(""),[o,u]=ee.useState(),[h,f]=ee.useState(),g=()=>{r(void 0),u(void 0),s("")};return ee.useEffect(()=>{if(g(),f(void 0),!n)return;let b,v=n;n.indexOf("?")!==-1&&(b=n.split("?"),v=b[0]);const S=new URLSearchParams(b?.[1]),E={...Object.fromEntries(S),...t.urlParameters},P=new URLSearchParams(E),k=decodeURIComponent(P.toString())+"".replace(/%2F/g,"/").replace(/%3A/g,":");fetch(v+"?"+k).then(L=>{if(L.ok)return L.text();throw Error(L.statusText+" ("+L.status+" - "+L.type+")")}).then(L=>{u(new NPe(L,window.DOMParser).toJSON())}).catch(L=>{g(),console.log(L),f(L.message)})},[n,t.urlParameters]),ee.useEffect(()=>{o?.Service&&(s(o.Capability?.Request?.GetMap?.DCPType?.[0]?.HTTP?.Get?.OnlineResource),r(o.Capability?.Request?.GetFeatureInfo?.DCPType?.[0]?.HTTP?.Get?.OnlineResource))},[o]),{capabilities:o,getFeatureInfoUrl:e,wmsUrl:a,error:h,setUrl:i}}xJ.defaultProps={url:"",urlParameters:{SERVICE:"WMS",VERSION:"1.3.0",REQUEST:"GetCapabilities"}};const zV=Hi(K.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m1 15h-2v-6h2zm0-8h-2V7h2z"})),jV=2*Math.PI*6378137/2,UV=function(t,e={enable:!0,decimal:1}){const r=t.lng,n=t.lat;let i=r*jV/180,a=Math.log(Math.tan((90+n)*Math.PI/360))/(Math.PI/180);return a=a*jV/180,e.enable&&(i=Number(i.toFixed(e.decimal)),a=Number(a.toFixed(e.decimal))),[i,a]},DPe={mapId:void 0,url:"",urlParameters:{SERVICE:"WMS",VERSION:"1.3.0",REQUEST:"GetCapabilities"},wmsUrlParameters:{TRANSPARENT:"TRUE"},featureInfoEnabled:!0,zoomToExtent:!1,showDeleteButton:!1},rM=t=>{t={...DPe,...t};const{capabilities:e,error:r,setUrl:n,getFeatureInfoUrl:i,wmsUrl:a}=xJ({urlParameters:t.urlParameters}),[s,o]=ee.useState(t?.config?.open||!1),[u,h]=ee.useState(t?.config?.visible||!0),[f,g]=ee.useState(!1),b=ha({mapId:t?.mapId}),[v,S]=ee.useState(t?.config?.layers||[]),[E,P]=ee.useState(!1),[k,L]=ee.useState(),[O,M]=ee.useState(void 0);ee.useEffect(()=>{t.config||n(t.url)},[t.url]);const z=ee.useMemo(()=>t?.config?.wmsUrl||a,[t?.config?.wmsUrl,a]),B=ee.useMemo(()=>t?.config?.getFeatureInfoUrl||i,[t?.config?.getFeatureInfoUrl,i]),q=ee.useMemo(()=>e,[e]),W=ee.useMemo(()=>t?.name||t?.config?.name||q?.Service?.Title,[t?.name,t?.config?.name,q?.Service?.Title]),G=ee.useMemo(()=>t?.setLayers&&t?.config?.layers||v,[t?.config?.layers,v]),ie=ee.useMemo(()=>t?.setLayers||S,[t?.setLayers,S]);ee.useEffect(()=>{t?.onConfigChange?.({layers:G,getFeatureInfoUrl:B,wmsUrl:z,visible:u,open:s,name:W})},[G,q,B,z,u,s,W]);const Q=ee.useMemo(()=>G.filter(fe=>fe.visible&&fe?.Attribution?.Title).map(fe=>fe?.Attribution?.Title).filter((fe,Me,me)=>me.indexOf(fe)===Me).join(" "),[G]),H=function(){L(void 0),M(void 0)},ne=ee.useCallback(fe=>{if(!b.map)return;H();const Me=b.map.unproject([fe.point.x,fe.point.y]),me=Rh([Me.lng,Me.lat]),we=Pxe(me,50,{units:"meters"}),Te=we&&ih(we),ke=Te&&UV({lng:Te[0],lat:Te[1]}),he=Te&&UV({lng:Te[2],lat:Te[3]}),xe={REQUEST:"GetFeatureInfo",BBOX:(ke&&he&&[ke[0],ke[1],he[0],he[1]])?.join(","),SERVICE:"WMS",INFO_FORMAT:q?.Capability?.Request?.GetFeatureInfo.Format.indexOf("text/html")!==-1?"text/html":"text/plain",FEATURE_COUNT:"10",LAYERS:G.map(Ye=>Ye.visible&&Ye.queryable?Ye.Name:void 0).filter(Ye=>Ye),QUERY_LAYERS:G.map(Ye=>Ye.visible&&Ye.queryable?Ye.Name:void 0).filter(Ye=>Ye),WIDTH:100,HEIGHT:100,srs:"EPSG:3857",CRS:"EPSG:3857",version:"1.3.0",X:50,Y:50,I:50,J:50,buffer:"50"};let Ne=B,Oe;Ne?.indexOf?.("?")!==-1&&(Oe=t?.url?.split("?")||t?.config?.wmsUrl?.split("?"),Ne=Oe?.[0]);const $e=new URLSearchParams(Oe?.[1]),De={...Object.fromEntries($e),...xe},it=new URLSearchParams(De);fetch(t.url+"?"+it.toString()).then(Ye=>{if(!Ye.ok)throw new Error("FeatureInfo could not be fetched");return Ye.text()}).then(Ye=>{L(fe.lngLat),M(Ye)}).catch(Ye=>console.log(Ye))},[q,B,t,b,G]),oe=ee.useMemo(()=>(typeof t?.featureInfoActive<"u"&&t.featureInfoActive||E)&&G?.some(fe=>fe.visible&&fe.queryable)&&!!b.map,[t?.featureInfoActive,E,G,b.map]);ee.useEffect(()=>{if(!oe){H();return}const fe=ne;return b.map.map.on("click",fe),()=>{b.map?.map.off?.("click",fe)}},[oe,ne,b.map]),ee.useEffect(()=>{if(!q?.Service)return;let fe=[];if(q?.Capability?.Layer?.CRS?.indexOf?.("EPSG:3857")===-1&&q?.Capability?.Layer?.CRS?.indexOf?.("CRS:84")===-1)console.log("MlWmsLoader ("+q.Service.Title+"): No WGS 84/Pseudo-Mercator support");else{console.log("MlWmsLoader ("+q.Service.Title+"): WGS 84/Pseudo-Mercator supported");let Me=q?.Capability?.Layer?.Layer.filter(me=>!me.Layer?.length).map((me,we)=>(we===0&&(fe=me.EX_GeographicBoundingBox||me?.LatLonBoundingBox||[]),{visible:q?.Capability?.Layer?.Layer?.length>2?we>1:!0,Attribution:{Title:""},...(({CRS:Te,...ke})=>ke)(me)}));q?.Capability?.Layer?.Layer.forEach(me=>{const we=me?.Layer?.filter(Te=>Te.CRS?.length).map((Te,ke)=>(ke===0&&(fe=Te.EX_GeographicBoundingBox||Te?.LatLonBoundingBox||[]),{visible:!1,Attribution:{Title:""},...(({CRS:he,...Ee})=>Ee)(Te)}));we&&(Me=[...Me,...we])}),ie(Me),t.zoomToExtent&&b?.map&&fe.length>3&&b?.map.fitBounds([[fe[0],fe[1]],[fe[2],fe[3]]])}},[q,b.map]);const ce=K.jsxs(Ih,{secondaryAction:K.jsxs(K.Fragment,{children:[t.buttons,t.featureInfoEnabled&&K.jsx(eh,{sx:{padding:"4px",marginTop:"-3px",marginRight:"4px",background:fe=>G?.some(Me=>Me.visible&&Me.queryable)?oe?fe.palette.info.light:fe.palette.grey[300]:"initial"},"aria-label":"featureinfo",onClick:()=>{typeof t?.setFeatureInfoActive=="function"?t.setFeatureInfoActive(fe=>!fe):P(fe=>!fe)},disabled:!G?.some(fe=>fe.visible&&fe.queryable),children:K.jsx(zV,{})}),K.jsx(eh,{edge:t.showDeleteButton?!1:"end",sx:{padding:"4px",marginTop:"-3px",...t.showDeleteButton?{marginRight:"4px"}:{}},"aria-label":"open",onClick:()=>o(fe=>!fe),children:s?K.jsx(zZ,{}):K.jsx(xS,{})}),t.showDeleteButton&&K.jsxs(K.Fragment,{children:[K.jsx(eh,{"aria-label":"delete",edge:"end",onClick:()=>{typeof t.onConfigChange=="function"&&g(!0)},sx:{padding:"4px",marginTop:"-3px"},children:K.jsx(nx,{})}),f&&K.jsx(g0,{open:f,onConfirm:()=>{typeof t.onConfigChange=="function"&&t.onConfigChange(!1)},onCancel:()=>{g(!1)},title:"Delete layer",text:"Are you sure you want to delete this layer?"})]})]}),sx:{paddingRight:0,paddingLeft:0,paddingTop:0,paddingBottom:"4px"},children:[K.jsx(Q1,{sx:{minWidth:"30px"},children:K.jsx(i0,{sx:{padding:0},checked:u,onClick:()=>{h(fe=>!fe)}})}),K.jsx(yh,{primary:W,variant:"layerlist"})]});return K.jsxs(K.Fragment,{children:[r&&K.jsx(pge,{children:K.jsx(Vo,{children:r})}),z&&K.jsxs(K.Fragment,{children:[t.layerId&&t.sortable&&K.jsx(NS,{layerId:t.layerId,children:ce}),t.layerId&&!t.sortable&&ce,K.jsxs(Vo,{sx:{display:s?"block":"none"},children:[K.jsx(ff,{dense:!0,component:"div",disablePadding:!0,sx:{paddingLeft:"18px"},children:z&&G?.map?.((fe,Me)=>fe?.Name?K.jsxs(Ih,{secondaryAction:K.jsx(K.Fragment,{children:fe?.queryable&&K.jsx(zV,{})}),children:[K.jsx(Q1,{sx:{minWidth:"30px"},children:K.jsx(i0,{checked:fe.visible,sx:{padding:0},onClick:()=>{const me=[...G];me[Me].visible=!me[Me].visible,ie([...me])}})}),K.jsx(yh,{primary:fe?.Title,variant:"layerlist"})]},fe.Name+Me):K.jsx(K.Fragment,{}))}),z&&G?.length&&K.jsx(zS,{url:z,attribution:Q,visible:u,urlParameters:{...t.wmsUrlParameters,layers:G?.filter?.(fe=>fe.visible).map(fe=>fe.Name).reverse().join(",")},insertBeforeLayer:t?.insertBeforeLayer},b.componentId)]}),t.featureInfoEnabled&&k&&K.jsx(eM,{...k,content:O})]})]})};try{rM.displayName="MlWmsLoader",rM.__docgenInfo={description:`Loads a WMS getCapabilities xml document and adds a MlWmsLayer component for each layer that is
offered by the WMS.`,displayName:"MlWmsLoader",props:{url:{defaultValue:null,description:"WMS URL",name:"url",required:!1,type:{name:"string | undefined"}},mapId:{defaultValue:null,description:"Id of the target MapLibre instance in mapContext",name:"mapId",required:!1,type:{name:"string | undefined"}},layerId:{defaultValue:null,description:"",name:"layerId",required:!1,type:{name:"string | undefined"}},insertBeforeLayer:{defaultValue:null,description:"",name:"insertBeforeLayer",required:!1,type:{name:"string | undefined"}},urlParameters:{defaultValue:null,description:"URL parameters that will be used in the getCapabilities request",name:"urlParameters",required:!1,type:{name:"{ [key: string]: string; } | undefined"}},wmsUrlParameters:{defaultValue:null,description:"URL parameters that will be added when requesting WMS capabilities",name:"wmsUrlParameters",required:!1,type:{name:"{ [key: string]: string; } | undefined"}},zoomToExtent:{defaultValue:null,description:"If true, zooms to the extent of the WMS layer after loading the getCapabilities response",name:"zoomToExtent",required:!1,type:{name:"boolean | undefined"}},name:{defaultValue:null,description:"The name of the ListItem element representing the WmsLoader",name:"name",required:!1,type:{name:"string | undefined"}},featureInfoEnabled:{defaultValue:null,description:"If true, enables the feature info functionality",name:"featureInfoEnabled",required:!1,type:{name:"boolean | undefined"}},featureInfoActive:{defaultValue:null,description:"If true, the feature info functionality is active",name:"featureInfoActive",required:!1,type:{name:"boolean | undefined"}},setFeatureInfoActive:{defaultValue:null,description:"A function to set the feature info active state",name:"setFeatureInfoActive",required:!1,type:{name:"((val: boolean | ((current: boolean) => boolean)) => void) | undefined"}},config:{defaultValue:null,description:"The WMS configuration object",name:"config",required:!1,type:{name:"WmsConfig | undefined"}},onConfigChange:{defaultValue:null,description:"A function to handle changes to the WMS configuration",name:"onConfigChange",required:!1,type:{name:"((config: false | WmsConfig) => void) | undefined"}},setLayers:{defaultValue:null,description:"A function to update a LayerType config array that is passed to this component at props.config.layers",name:"setLayers",required:!1,type:{name:"((layers: LayerType[]) => void) | undefined"}},showDeleteButton:{defaultValue:null,description:"If true, shows the delete button for the WMSLoader",name:"showDeleteButton",required:!1,type:{name:"boolean | undefined"}},buttons:{defaultValue:null,description:"Custom buttons to display for the WMSLoader",name:"buttons",required:!1,type:{name:"Element | undefined"}},sortable:{defaultValue:null,description:"",name:"sortable",required:!1,type:{name:"boolean | undefined"}}}}}catch{}function nM(t){const e={"circle-color":"rgba(0,0,0,0)"},r={"fill-color":"rgba(0,0,0,0)","fill-outline-color":"rgba(0,0,0,0)"},n={"line-color":"rgba(0,0,0,0)"},i=["interpolate",["linear"],["get",t.timeField],t.currentVal-t.fadeIn*t.step,0,t.currentVal,1,t.currentVal+t.fadeOut*t.step,0],a=["interpolate",["linear"],["get",t.timeField],t.currentVal,1,t.currentVal+t.fadeOut*t.step,0],s={"fill-color":t.featuresColor,"fill-opacity":i,"fill-outline-color":["interpolate",["linear"],["get",t.timeField],t.currentVal-t.fadeIn*t.step,"rgba(255, 0, 0, 0)",t.currentVal,"rgb(0,0,0)",t.currentVal+t.fadeIn*t.step,"rgba(255, 0, 0, 0)"]},o={"circle-color":t.featuresColor,"circle-radius":["interpolate",["linear"],["get",t.timeField],t.currentVal-t.fadeIn*t.step,1,t.currentVal,20,t.currentVal+t.fadeOut*t.step,1],"circle-opacity":i},u={"line-color":t.featuresColor,"line-width":3,"line-opacity":i},h={"circle-color":t.featuresColor,"circle-radius":["interpolate",["linear"],["get",t.timeField],t.currentVal,20,t.currentVal+t.fadeOut*t.step,1],"circle-opacity":a},f={"fill-color":t.featuresColor,"fill-opacity":a,"fill-outline-color":["interpolate",["linear"],["get",t.timeField],t.currentVal,"rgb(0,0,0)",t.currentVal+t.fadeIn*t.step,"rgba(255, 0, 0, 0)"]},g={"line-color":t.featuresColor,"line-width":3,"line-opacity":a};if(t.userPaint!==void 0)return t.userPaint;switch(t.type){case"circle":return t.currentVal===t.minVal&&!t.isPlaying?e:t.accumulate?h:o;case"fill":return t.currentVal===t.minVal&&!t.isPlaying?r:t.accumulate?f:s;case"line":return t.currentVal===t.minVal&&!t.isPlaying?n:t.accumulate?g:u;case void 0:return t.currentVal===t.minVal&&!t.isPlaying?e:t.accumulate?h:o}}try{nM.displayName="paintPicker",nM.__docgenInfo={description:"",displayName:"paintPicker",props:{type:{defaultValue:null,description:"",name:"type",required:!0,type:{name:"enum",value:[{value:"undefined"},{value:'"fill"'},{value:'"circle"'},{value:'"line"'}]}},timeField:{defaultValue:null,description:"",name:"timeField",required:!0,type:{name:"string"}},currentVal:{defaultValue:null,description:"",name:"currentVal",required:!0,type:{name:"number"}},minVal:{defaultValue:null,description:"",name:"minVal",required:!0,type:{name:"number"}},isPlaying:{defaultValue:null,description:"",name:"isPlaying",required:!0,type:{name:"boolean"}},fadeIn:{defaultValue:null,description:"",name:"fadeIn",required:!0,type:{name:"number"}},fadeOut:{defaultValue:null,description:"",name:"fadeOut",required:!0,type:{name:"number"}},step:{defaultValue:null,description:"",name:"step",required:!0,type:{name:"number"}},featuresColor:{defaultValue:null,description:"",name:"featuresColor",required:!0,type:{name:"string"}},accumulate:{defaultValue:null,description:"",name:"accumulate",required:!0,type:{name:"boolean"}},userPaint:{defaultValue:null,description:"",name:"userPaint",required:!0,type:{name:'{ "circle-radius"?: DataDrivenPropertyValueSpecification<number> | undefined; "circle-color"?: DataDrivenPropertyValueSpecification<string> | undefined; ... 8 more ...; "circle-stroke-opacity"?: DataDrivenPropertyValueSpecification<...> | undefined; } | { ...; } | { ...; } | undefined'}}}}}catch{}function iM(t){const e=t.currentVal-t.fadeIn*t.step,r=t.currentVal+t.fadeIn*t.step,n={"text-color":"rgba(0,0,0,0)"},i={"text-color":t.labelColor,"text-opacity":["interpolate",["linear"],["get",t.timeField],e,0,t.currentVal,1,r,0]},a={"text-color":t.labelColor,"text-opacity":["interpolate",["linear"],["get",t.timeField],t.currentVal,1,r,0]},s=()=>t.currentVal===t.minVal&&!t.isPlaying?n:t.accumulate?a:i,o={"text-field":["get",t.labelField],"text-font":["Metropolis Regular"]};return K.jsx(DS,{options:{type:"symbol",layout:t.labelLayout||o,paint:t.labelPaint||s()},geojson:t.data,layerId:"timeControllerLabels"})}try{iM.displayName="MlTemporalControllerLabels",iM.__docgenInfo={description:"",displayName:"MlTemporalControllerLabels",props:{data:{defaultValue:null,description:"",name:"data",required:!0,type:{name:"FeatureCollection<Geometry, GeoJsonProperties>"}},currentVal:{defaultValue:null,description:"",name:"currentVal",required:!0,type:{name:"number"}},fadeIn:{defaultValue:null,description:"",name:"fadeIn",required:!0,type:{name:"number"}},fadeOut:{defaultValue:null,description:"",name:"fadeOut",required:!0,type:{name:"number"}},step:{defaultValue:null,description:"",name:"step",required:!0,type:{name:"number"}},labelField:{defaultValue:null,description:"",name:"labelField",required:!0,type:{name:"string"}},labelColor:{defaultValue:null,description:"",name:"labelColor",required:!0,type:{name:"string"}},timeField:{defaultValue:null,description:"",name:"timeField",required:!0,type:{name:"string"}},minVal:{defaultValue:null,description:"",name:"minVal",required:!0,type:{name:"number"}},accumulate:{defaultValue:null,description:"",name:"accumulate",required:!0,type:{name:"boolean"}},isPlaying:{defaultValue:null,description:"",name:"isPlaying",required:!0,type:{name:"boolean"}},labelLayout:{defaultValue:null,description:"",name:"labelLayout",required:!1,type:{name:"any"}},labelPaint:{defaultValue:null,description:"",name:"labelPaint",required:!1,type:{name:"SymbolLayerSpecification | undefined"}}}}}catch{}const FPe=Hi(K.jsx("path",{d:"M8 5v14l11-7z"})),BPe=Hi(K.jsx("path",{d:"M6 19h4V5H6zm8-14v14h4V5z"})),zPe=Hi(K.jsx("path",{d:"M6 6h12v12H6z"})),jPe=Hi(K.jsx("path",{d:"m4 18 8.5-6L4 6zm9-12v12l8.5-6z"})),UPe=Hi(K.jsx("path",{d:"M11 18V6l-8.5 6zm.5-6 8.5 6V6z"})),VPe={marginLeft:"15%",marginBottom:"3%",width:"70%",height:"90px",alignItems:"center"},$Pe={top:"10%",height:"100px",alignItems:"center"};function aM(t){const[e,r]=ee.useState(t.currentVal),[n,i]=ee.useState(t.isPlaying),a=t.maxVal-t.minVal,s=ee.useRef(null),o=Gb(S=>S.breakpoints.down("md"));ee.useEffect(()=>()=>{s.current&&clearInterval(s.current)},[]),ee.useEffect(()=>{t.returnCurrent(e),t.returnPlaying(n)},[e,n]);const u=ht.useCallback(()=>{let S=e-t.minVal;s.current&&clearInterval(s.current),s.current=setInterval(function(){S>=a?(s.current&&clearInterval(s.current),i(!1)):r(E=>E+t.step),S=S+t.step},t.interval)},[t.step,t.maxVal,e]),h=()=>{n?(i(!1),n&&s.current&&clearInterval(s.current)):(i(!0),u())},f=()=>{s.current&&clearInterval(s.current),r(t.minVal),i(!1)},g=()=>{n?(s.current&&clearInterval(s.current),r(e-a/10),u()):r(e-a/10)},b=()=>{n?(s.current&&clearInterval(s.current),r(e+a/10),u()):r(e+a/10)},v=(S,E)=>{n?S&&(s.current&&clearInterval(s.current),r(E),u()):r(E)};return K.jsx(K.Fragment,{children:K.jsxs(eO,{anchor:"bottom",open:t.open||!0,variant:"persistent",sx:{flexShrink:0,"& .MuiDrawer-paper":o?$Pe:VPe},children:[K.jsxs(Dd,{container:!0,alignItems:"center",justifyContent:"space-between",children:[K.jsxs(Dd,{item:!0,xs:12,sm:10,textAlign:"center",children:[K.jsx(Ji,{onClick:g,children:K.jsx(UPe,{})}),K.jsx(Ji,{onClick:f,children:K.jsx(zPe,{})}),K.jsx(Ji,{onClick:h,children:n?K.jsx(BPe,{}):K.jsx(FPe,{})}),K.jsx(Ji,{onClick:b,children:K.jsx(jPe,{})})]}),t.display&&!o&&K.jsx(Dd,{item:!0,xs:12,sm:5,textAlign:"right",children:K.jsx(vs,{variant:"h5",sx:{paddingRight:"25px"},children:Math.floor(e)})})]}),K.jsx(aO,{sx:{position:"flex",width:"95%",paddingTop:"10px",alignSelf:"center"},"aria-label":"Custom marks",defaultValue:t.minVal,value:e,step:t.step,onChange:v,min:t.minVal,max:t.maxVal}),o&&t.display&&K.jsx(vs,{variant:"body1",textAlign:"right",children:Math.floor(e)})]})})}try{aM.displayName="TemporalControllerPlayer",aM.__docgenInfo={description:"",displayName:"TemporalControllerPlayer",props:{currentVal:{defaultValue:null,description:"",name:"currentVal",required:!0,type:{name:"number"}},isPlaying:{defaultValue:null,description:"",name:"isPlaying",required:!0,type:{name:"boolean"}},step:{defaultValue:null,description:"",name:"step",required:!0,type:{name:"number"}},interval:{defaultValue:null,description:"",name:"interval",required:!0,type:{name:"number"}},minVal:{defaultValue:null,description:"",name:"minVal",required:!0,type:{name:"number"}},maxVal:{defaultValue:null,description:"",name:"maxVal",required:!0,type:{name:"number"}},returnCurrent:{defaultValue:null,description:"",name:"returnCurrent",required:!0,type:{name:"Dispatch<SetStateAction<number>>"}},returnPlaying:{defaultValue:null,description:"",name:"returnPlaying",required:!0,type:{name:"Dispatch<SetStateAction<boolean>>"}},fadeIn:{defaultValue:null,description:"",name:"fadeIn",required:!0,type:{name:"number"}},open:{defaultValue:null,description:"",name:"open",required:!0,type:{name:"boolean"}},fadeOut:{defaultValue:null,description:"",name:"fadeOut",required:!0,type:{name:"number"}},featuresColor:{defaultValue:null,description:"",name:"featuresColor",required:!0,type:{name:"string"}},labels:{defaultValue:null,description:"",name:"labels",required:!0,type:{name:"boolean"}},labelColor:{defaultValue:null,description:"",name:"labelColor",required:!0,type:{name:"string"}},labelFadeIn:{defaultValue:null,description:"",name:"labelFadeIn",required:!0,type:{name:"number"}},labelFadeOut:{defaultValue:null,description:"",name:"labelFadeOut",required:!0,type:{name:"number"}},accumulate:{defaultValue:null,description:"",name:"accumulate",required:!0,type:{name:"boolean"}},display:{defaultValue:null,description:"",name:"display",required:!0,type:{name:"boolean"}}}}}catch{}function qPe(t,e){if(t?.features){const r=[...t.features?t.features:[]];return r.sort((n,i)=>n.properties?.[e]<i.properties?.[e]?1:-1),r[r.length-1]?.properties?.[e]||0}return 0}function HPe(t,e){if(t?.features){const r=[...t?.features?t.features:[]];return r.sort((n,i)=>n.properties?.[e]<i.properties?.[e]?-1:1),r[r.length-1]?.properties?.[e]||0}return 0}function oM(t){const e=ha({mapId:t.mapId}),r=ee.useMemo(()=>t.minVal?t.minVal:qPe(t.geojson,t.timeField),[t.minVal,t.geojson,t.timeField]),n=ee.useMemo(()=>t.maxVal?t.maxVal:HPe(t.geojson,t.timeField),[t.maxVal,t.geojson,t.timeField]);return{filteredData:ee.useMemo(()=>{if(t.geojson!==void 0&&e.map&&r&&n)return Xd(t.geojson.features.filter(a=>a.properties?.[t.timeField]>=r&&a.properties?.[t.timeField]<=n))},[t.geojson,e.map,t.timeField]),minVal:r,maxVal:n}}try{oM.displayName="useFilterData",oM.__docgenInfo={description:"",displayName:"useFilterData",props:{geojson:{defaultValue:null,description:"",name:"geojson",required:!0,type:{name:"FeatureCollection<Geometry, GeoJsonProperties>"}},timeField:{defaultValue:null,description:"",name:"timeField",required:!0,type:{name:"string"}},initialVal:{defaultValue:null,description:"",name:"initialVal",required:!1,type:{name:"number | undefined"}},minVal:{defaultValue:null,description:"",name:"minVal",required:!1,type:{name:"number | undefined"}},maxVal:{defaultValue:null,description:"",name:"maxVal",required:!1,type:{name:"number | undefined"}},mapId:{defaultValue:null,description:"",name:"mapId",required:!0,type:{name:"string | undefined"}}}}}catch{}const VV=({mapId:t=void 0,insertBeforeLayer:e,geojson:r,ownLayer:n=!0,attribution:i="",type:a="circle",timeField:s,minVal:o,maxVal:u,initialVal:h,accumulate:f=!1,fitBounds:g=!0,paint:b,featuresColor:v,step:S=1,interval:E=200,fadeIn:P=5,fadeOut:k=5,label:L=!0,labelColor:O,labelField:M=[],labelFadeIn:z=5,labelFadeOut:B=5,displayCurrentValue:q=!1,onClick:W,onHover:G,onLeave:ie,onStateChange:Q})=>{const H=ha({mapId:t,waitForLayer:e}),{filteredData:ne,minVal:oe,maxVal:ce}=oM({geojson:r,timeField:s,minVal:o,maxVal:u,mapId:t}),fe=Tc(),[Me,me]=ee.useState(h||oe),we=v||fe.palette.primary.main,Te=O||fe.palette.text.primary,[ke,he]=ee.useState(!1),Ee=nM({type:a,timeField:s,currentVal:Me,minVal:oe,isPlaying:ke,fadeIn:P,fadeOut:k,step:S,featuresColor:we,accumulate:f,userPaint:b});return ee.useEffect(()=>{!h&&oe?me(oe):h&&me(h)},[]),ee.useEffect(()=>{typeof Q=="function"&&Q({current:Me,paint:Ee})},[Q]),ee.useEffect(()=>{if(g&&typeof ne<"u"){const xe=ih(ne);H.map?.map.fitBounds(xe)}},[ne]),ee.useEffect(()=>{if(!H.map)return;let xe,Ne,Oe;return W&&(xe=W,H.map?.on("click","timeController",xe)),G&&(Ne=G,H.map?.on("mouseenter","timeController",Ne)),ie&&(Oe=ie,H.map?.on("mouseleave","timeController",Oe)),()=>{xe&&H.map?.off("click","timeController",xe),Ne&&H.map?.off("mouseenter","timeController",Ne),Oe&&H.map?.off("mouseleave","timeController",Oe)}},[H.map,W,G,ie]),K.jsxs(K.Fragment,{children:[ne&&n&&K.jsx(wc,{type:a,mapId:t,options:{source:{type:"geojson",attribution:i,data:ne},paint:{...b||Ee},layout:{visibility:"visible"}}}),ne&&L&&K.jsx(iM,{data:ne,currentVal:Me,fadeIn:z,fadeOut:B,step:S,labelField:M,labelColor:Te,timeField:s,minVal:oe,accumulate:f,isPlaying:ke}),K.jsx(aM,{currentVal:Me,isPlaying:ke,step:S,interval:E,minVal:oe,maxVal:ce,returnCurrent:me,returnPlaying:he,open:!1,fadeIn:P,fadeOut:k,featuresColor:we,labels:L,labelColor:Te,labelFadeIn:z,labelFadeOut:B,accumulate:f,display:q})]})};try{VV.displayName="MlTemporalController",VV.__docgenInfo={description:"",displayName:"MlTemporalController",props:{mapId:{defaultValue:{value:"undefined"},description:"Id of the target MapLibre instance in mapContext",name:"mapId",required:!1,type:{name:"string | undefined"}},insertBeforeLayer:{defaultValue:null,description:`Id of an existing layer in the mapLibre instance to help specify the layer order.
This layer will be visually beneath the layer with the "insertBeforeLayer" id.`,name:"insertBeforeLayer",required:!1,type:{name:"string | undefined"}},geojson:{defaultValue:null,description:"GeoJSON data that is supposed to be rendered by this component.",name:"geojson",required:!0,type:{name:"FeatureCollection<Geometry, GeoJsonProperties>"}},ownLayer:{defaultValue:{value:"true"},description:"If true,the component creates and loads a MlGeoJsonLayer to show the data.",name:"ownLayer",required:!1,type:{name:"boolean | undefined"}},attribution:{defaultValue:{value:""},description:"MapLibre attribution shown in the bottom right of the map, if this layer is visible",name:"attribution",required:!1,type:{name:"string | undefined"}},type:{defaultValue:{value:"circle"},description:`Type of the layer that will be added to the MapLibre instance.
Possible values: "line", "circle", "fill"`,name:"type",required:!1,type:{name:"enum",value:[{value:"undefined"},{value:'"fill"'},{value:'"circle"'},{value:'"line"'}]}},timeField:{defaultValue:null,description:"Property field where the time informations is available.",name:"timeField",required:!0,type:{name:"string"}},minVal:{defaultValue:null,description:`Lowest time value to be shown in the time line.
By default, it is set to the lowest value in the time field.`,name:"minVal",required:!1,type:{name:"number | undefined"}},label:{defaultValue:{value:"true"},description:'When true, a label layer will be added by the component. In that case, the "labelField" propertie is mandatory.',name:"label",required:!1,type:{name:"boolean | undefined"}},labelField:{defaultValue:{value:"[]"},description:"Property field where the label information is available.",name:"labelField",required:!1,type:{name:"string | undefined"}},maxVal:{defaultValue:null,description:`Highest time value to be shown in the time line.
By default, it is set to the highest value in the time field.`,name:"maxVal",required:!1,type:{name:"number | undefined"}},initialVal:{defaultValue:null,description:`the value at which the component is to be loaded.
If not specified, the component starts at the minimum value.`,name:"initialVal",required:!1,type:{name:"number | undefined"}},accumulate:{defaultValue:{value:"false"},description:`When true, the features will be accumulated in the map.
This option ist by default false.`,name:"accumulate",required:!1,type:{name:"boolean | undefined"}},fitBounds:{defaultValue:{value:"true"},description:`When true, the component will fit the map bounds to the shown features.
This option ist by default true.`,name:"fitBounds",required:!1,type:{name:"boolean | undefined"}},showControls:{defaultValue:null,description:"Boolean value that disables and enables the controls drawer.",name:"showControls",required:!1,type:{name:"boolean | undefined"}},paint:{defaultValue:null,description:`Paint property object for the features layer.
Possible props depend on the layer type.
https://maplibre.org/maplibre-gl-js-docs/style-spec/layers/#line
https://maplibre.org/maplibre-gl-js-docs/style-spec/layers/#circle
https://maplibre.org/maplibre-gl-js-docs/style-spec/layers/#fill`,name:"paint",required:!1,type:{name:'{ "circle-radius"?: DataDrivenPropertyValueSpecification<number> | undefined; "circle-color"?: DataDrivenPropertyValueSpecification<string> | undefined; ... 8 more ...; "circle-stroke-opacity"?: DataDrivenPropertyValueSpecification<...> | undefined; } | { ...; } | { ...; } | undefined'}},featuresColor:{defaultValue:null,description:"Sets the color of the features rendered by this component.",name:"featuresColor",required:!1,type:{name:"string | undefined"}},step:{defaultValue:{value:"1"},description:`How many units the timeline runs through at each step.
By default it is set to 1.`,name:"step",required:!1,type:{name:"number | undefined"}},interval:{defaultValue:{value:"200"},description:`The time between each addition to the counter, expressed in milliseconds.
By default, 200 ms.`,name:"interval",required:!1,type:{name:"number | undefined"}},fadeIn:{defaultValue:{value:"5"},description:`A numeric value that sets how many steps before the feature starts to appear.
By default it is set to 5 steps.`,name:"fadeIn",required:!1,type:{name:"number | undefined"}},fadeOut:{defaultValue:{value:"5"},description:`A numeric value that sets how many steps the feature fades out after it proper time value.
By default it is set to 5 steps.`,name:"fadeOut",required:!1,type:{name:"number | undefined"}},labelColor:{defaultValue:null,description:"Sets the color of the features rendered by this component.",name:"labelColor",required:!1,type:{name:"string | undefined"}},labelLayout:{defaultValue:null,description:`Layout property object, that is passed to the labels layer.
https://maplibre.org/maplibre-gl-js-docs/style-spec/layers/#symbol`,name:"labelLayout",required:!1,type:{name:"any"}},labelPaint:{defaultValue:null,description:`Paint property object for the features layer.
https://maplibre.org/maplibre-gl-js-docs/style-spec/layers/#symbol`,name:"labelPaint",required:!1,type:{name:"any"}},labelFadeIn:{defaultValue:{value:"5"},description:`A numeric value that sets how many steps before the labels start to appear.
By default it is set to 5 steps.`,name:"labelFadeIn",required:!1,type:{name:"number | undefined"}},labelFadeOut:{defaultValue:{value:"5"},description:`A numeric value that sets how many steps the labels fade out after their proper time value.
By default it is set to 5 steps.`,name:"labelFadeOut",required:!1,type:{name:"number | undefined"}},displayCurrentValue:{defaultValue:{value:"false"},description:"If true, the current time value will be displayed in the controlls panel.",name:"displayCurrentValue",required:!1,type:{name:"boolean | undefined"}},onClick:{defaultValue:null,description:"Click event handler that is executed whenever a geometry rendered by this component is clicked.",name:"onClick",required:!1,type:{name:"((ev: MapEventType) => void | Map$1) | undefined"}},onHover:{defaultValue:null,description:"Click event handler that is executed whenever a geometry rendered by this component is hovered.",name:"onHover",required:!1,type:{name:"((ev: MapEventType) => void | Map$1) | undefined"}},onLeave:{defaultValue:null,description:`Leave event handler that is executed whenever a geometry rendered by this component is
left/unhovered.`,name:"onLeave",required:!1,type:{name:"((ev: MapEventType) => void | Map$1) | undefined"}},onStateChange:{defaultValue:null,description:"Callback function defined by the user to recive the current time value and paint property in the parent component.",name:"onStateChange",required:!1,type:{name:"Dispatch<SetStateAction<TemporalControllerValues | undefined>> | undefined"}}}}}catch{}const US=t=>{const e=t?.layerIds.toReversed();return K.jsx(K.Fragment,{children:e&&e.map((r,n)=>{const i=n>0?e[n-1]:t.insertBeforeLayer;return K.jsx(DS,{layerId:r,insertBeforeLayer:i},r)})})};try{US.displayName="MlOrderLayers",US.__docgenInfo={description:"Creates an invisible layer for each entry in props.layerIds with the id `order-{entry}` and a reliable order",displayName:"MlOrderLayers",props:{mapId:{defaultValue:null,description:"Id of the target MapLibre instance in mapContext",name:"mapId",required:!1,type:{name:"string | undefined"}},layerIds:{defaultValue:null,description:"",name:"layerIds",required:!0,type:{name:"string[]"}},insertBeforeLayer:{defaultValue:null,description:"",name:"insertBeforeLayer",required:!1,type:{name:"string | undefined"}}}}}catch{}const $V=t=>{const e=ha({mapId:"map_1"});return ee.useEffect(()=>{if(e.map)return e.map.map.getSource("terrain")||e.map.map.addSource("terrain",{type:"raster-dem",encoding:"mapbox",maxzoom:12,minzoom:4,...t.sourceOptions}),e.map.map.setTerrain({source:"terrain",exaggeration:1,...t.terrainOptions}),e.map.addLayer({id:"hills",type:"hillshade",source:"terrain",layout:{visibility:"visible"},paint:{"hillshade-shadow-color":"rgba(71,59,36,0.4)"}}),()=>{e.map?.map.setTerrain(null),e.map?.map.getSource("terrain")&&(e.map.map.removeLayer("hills"),e.map.map.removeSource("terrain"))}},[e.map,t.sourceOptions,t.terrainOptions]),K.jsx(K.Fragment,{})};try{$V.displayName="MlTerrainLayer",$V.__docgenInfo={description:"Create Terrain Layer Component",displayName:"MlTerrainLayer",props:{mapId:{defaultValue:null,description:"Id of the target MapLibre instance in mapContext",name:"mapId",required:!1,type:{name:"string | undefined"}},sourceOptions:{defaultValue:null,description:"Source of tiles with possibles options",name:"sourceOptions",required:!1,type:{name:"object | undefined"}},terrainOptions:{defaultValue:null,description:"Options for new exaggeration value",name:"terrainOptions",required:!1,type:{name:"TerrainSpecification | undefined"}}}}}catch{}const WPe=Hi(K.jsx("path",{d:"M3 17.25V21h3.75L17.81 9.94l-3.75-3.75zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34a.996.996 0 0 0-1.41 0l-1.83 1.83 3.75 3.75z"})),GPe=Hi([K.jsx("circle",{cx:"7",cy:"14",r:"3"},"0"),K.jsx("circle",{cx:"11",cy:"6",r:"3"},"1"),K.jsx("circle",{cx:"16.6",cy:"17.6",r:"3"},"2")]),XPe=[{name:"Point",mode:"draw_point",icon:K.jsx(GPe,{})},{name:"LineString",mode:"draw_line_string",icon:K.jsx(FZ,{})},{name:"Polygon",mode:"draw_polygon",icon:K.jsx(BZ,{})}],qV=t=>{const e=ha({mapId:t.mapId,waitForLayer:t.insertBeforeLayer}),[r,n]=ee.useState(),[i,a]=ee.useState({activeGeometryIndex:void 0,selectedGeoJson:void 0,geometries:[],drawMode:void 0});console.log(i),ee.useEffect(()=>{typeof t.onChange=="function"&&t.onChange(i)},[i,t.onChange]);const s={...t.buttonStyleOverride},o=g=>{let b;a(v=>(b=v.drawMode,{...v,drawMode:void 0,activeGeometryIndex:void 0,selectedGeoJson:void 0})),requestAnimationFrame(()=>{a(v=>(b==="draw_polygon"||b==="draw_line_string")&&g==="draw_point"?{...v,drawMode:void 0}:{...v,drawMode:g})})},u=g=>{a(b=>{const v=[...b.geometries];return v.splice(v.indexOf(g),1),{...b,drawMode:void 0,geometries:v,activeGeometryIndex:b.activeGeometryIndex?b.activeGeometryIndex-1:void 0}})},h=g=>{t.onShowInstructionChange?.(g.target.checked)},f=()=>K.jsx(K.Fragment,{children:XPe.map(g=>{const b=S=>i.drawMode===g.mode?S.palette.primary.main:S.palette.navigation.navColor,v=S=>i.drawMode!==g.mode?S.palette.primary.main:S.palette.navigation.navColor;return K.jsx(K.Fragment,{children:K.jsx(Np,{title:g.name,children:K.jsx(Ji,{sx:{color:v,backgroundColor:b,"&:hover":{backgroundColor:b},...s},onClick:()=>o(g.mode),children:g.icon},g.name)})})})});return K.jsxs(K.Fragment,{children:[K.jsx(Yy,{sx:{zIndex:104},children:K.jsx(RP,{children:K.jsx(f,{})})}),K.jsx(Yy,{sx:{marginTop:"10px"},children:K.jsx(SG,{children:K.jsx(LP,{control:K.jsx(i0,{size:"small",checked:t.showInstruction,onChange:h}),label:"Show instructions"})})}),i.drawMode&&K.jsx(_S,{mode:i.drawMode,geojson:i.selectedGeoJson,onChange:g=>{console.log("Features: ",g),g?.[0]&&a(b=>{const v=[...i.geometries];if(typeof b.activeGeometryIndex>"u"){const E=g[0];E&&E.properties?E.properties.id=E.id:console.error("tempFeature or tempFeature.properties is null or undefined"),b.activeGeometryIndex=v.length,v.push(E)}else v[b.activeGeometryIndex]=g[0];return(()=>{if(b.selectedGeoJson&&typeof b.activeGeometryIndex<"u"&&b.geometries[b.activeGeometryIndex]&&b.geometries[b.activeGeometryIndex].geometry.type==="Point"){const E=b.selectedGeoJson?.geometry?.coordinates,P=b.geometries[b.activeGeometryIndex]?.geometry?.coordinates;return JSON.stringify(E)!==JSON.stringify(P)}return!1})()&&(b.drawMode=void 0),{...b,geometries:v}})},onFinish:()=>{a(g=>({...g,drawMode:void 0,activeGeometryIndex:void 0,selectedGeoJson:void 0}))}}),K.jsxs(ff,{sx:{zIndex:105,marginBottom:"-10px"},children:[i.geometries.map((g,b)=>K.jsxs(Yy,{sx:{display:"flex",flexDirection:"column"},children:[K.jsx("br",{}),K.jsxs(Yy,{flexDirection:"row",sx:{"&:hover":{backgroundColor:"rgb(177, 177, 177, 0.2)"},marginTop:"25px"},onMouseOver:()=>{n(g)},onMouseLeave:()=>{n(void 0)},children:[!g.properties?.customName&&K.jsx("input",{type:"text",value:g.properties?.name||"",placeholder:"Assign name",onChange:v=>{const S=v.target.value;a(E=>{const P=[...E.geometries];return P[b].properties||(P[b].properties={}),P[b].properties.name=S,{...E,geometries:P}})},style:{padding:"5px",border:"1px solid #ccc",borderRadius:"4px",outline:"none"},onFocus:v=>v.target.style.borderColor="#009ee0",onBlur:v=>{v.target.style.borderColor="#ccc",a(S=>{const E=[...S.geometries];return E[b].properties||(E[b].properties={}),E[b].properties.customName=!0,{...S,geometries:E}})}}),K.jsx(Fd,{listItemSx:s,configurable:!0,visible:!0,layerComponent:K.jsx(wc,{mapId:t.mapId,geojson:g,layerId:String(g.id),defaultPaintOverrides:{fill:{"fill-opacity":.5}}}),type:"layer",name:K.jsx(vs,{onClick:()=>{a(v=>{const S=[...v.geometries];return S[b].properties||(S[b].properties={}),S[b].properties.customName=!1,{...v,geometries:S}})},sx:{cursor:"pointer",overflow:"hidden",whiteSpace:"nowrap"},children:g.properties?.name||String(g.id)}),description:g.geometry.type}),K.jsx(Yy,{sx:{padding:"3px 30px"},children:K.jsxs(RP,{size:"small",children:[K.jsx(Np,{title:"Center",children:K.jsx(Ji,{sx:{color:v=>v.palette.primary.main,backgroundColor:v=>v.palette.navigation.navColor,...s},onClick:()=>{e?.map?.map.setCenter(g.geometry.type==="Point"?g.geometry.coordinates:JO(g).geometry.coordinates)},children:K.jsx(eL,{})})}),K.jsx(Np,{title:"Edit",children:K.jsx(Ji,{sx:{color:v=>i.drawMode==="simple_select"&&i.selectedGeoJson?.id===g.id?v.palette.navigation.navColor:v.palette.primary.main,backgroundColor:v=>i.drawMode==="simple_select"&&i.selectedGeoJson?.id===g.id?v.palette.primary.main:v.palette.navigation.navColor,...s},onClick:()=>{a(v=>{const S=v.drawMode==="simple_select"&&v.selectedGeoJson?.id===g.id?void 0:"simple_select";return{...v,selectedGeoJson:g,activeGeometryIndex:v.geometries.indexOf(g),drawMode:S}})},children:K.jsx(WPe,{})})}),K.jsx(Np,{title:"Delete",children:K.jsx(Ji,{sx:{color:v=>v.palette.primary.main,backgroundColor:v=>v.palette.navigation.navColor,...s},onClick:()=>{u(g),n(void 0)},children:K.jsx(nx,{})})})]})})]})]},g.id)),r&&K.jsx(wc,{mapId:t.mapId,geojson:{type:"FeatureCollection",features:[r]},layerId:"highlightBorder",defaultPaintOverrides:{circle:{"circle-color":"#000000","circle-opacity":.2,"circle-radius":10},line:{"line-color":"#000000","line-opacity":.2,"line-width":10},fill:{"fill-color":"#000000","fill-opacity":.2}}})]})]})};try{qV.displayName="MlSketchTool",qV.__docgenInfo={description:"Component template",displayName:"MlSketchTool",props:{mapId:{defaultValue:null,description:"Id of the target MapLibre instance in mapContext",name:"mapId",required:!1,type:{name:"string | undefined"}},insertBeforeLayer:{defaultValue:null,description:`Id of an existing layer in the mapLibre instance to help specify the layer order
This layer will be visually beneath the layer with the "insertBeforeLayer" id.`,name:"insertBeforeLayer",required:!1,type:{name:"string | undefined"}},buttonStyleOverride:{defaultValue:null,description:`Style attribute for the button-style
https://mui.com/system/getting-started/the-sx-prop/`,name:"buttonStyleOverride",required:!1,type:{name:"SxProps | undefined"}},onChange:{defaultValue:null,description:"Callback function that is called each time GeoJson data has changed within MlSketchTool.\nFirst parameter contains all geometries in the `geometries` prop.",name:"onChange",required:!1,type:{name:"((para: SketchStateType) => void) | undefined"}},showInstruction:{defaultValue:null,description:"Determines whether the instruction text should be shown.",name:"showInstruction",required:!1,type:{name:"boolean | undefined"}},onShowInstructionChange:{defaultValue:null,description:'Callback function triggered when the "Show instructions" checkbox is toggled.',name:"onShowInstructionChange",required:!1,type:{name:"((value: boolean) => void) | undefined"}}}}}catch{}const sM=t=>{const e=ee.useRef(!1),r=ee.useRef(t.pause),n=ee.useRef(t.zoom),i=ee.useRef(t.pitch),a=ee.useRef(1),s=ee.useRef(t.speed),o=ee.useRef(null),u=t.kmPerStep||.01,h=hb(t.route),f=t.stepDuration||70,g=ha({mapId:t.mapId,waitForLayer:t.insertBeforeLayer});ee.useEffect(()=>{r.current=t.pause,r.current||E()},[t.pause]),ee.useEffect(()=>{g.map&&(n.current=t.zoom,typeof n.current<"u"&&g.map.map.getZoom()!==n.current&&g.map.map.setZoom(n.current))},[g.map,t.zoom]),ee.useEffect(()=>{g.map&&(i.current=t.pitch,typeof i.current<"u"&&i.current!==g.map.map.getPitch()&&g.map.map.setPitch(i.current))},[g.map,t.pitch]),ee.useEffect(()=>{s.current=t.speed},[t.speed]);const b=ee.useCallback(()=>{g.map&&(g.map.map.scrollZoom.disable(),g.map.map.boxZoom.disable(),g.map.map.dragRotate.disable(),g.map.map.dragPan.disable(),g.map.map.keyboard.disable(),g.map.map.doubleClickZoom.disable(),g.map.map.touchZoomRotate.disable())},[g.map]),v=ee.useCallback(()=>{g.map&&(g.map.map.scrollZoom.enable(),g.map.map.boxZoom.enable(),g.map.map.dragRotate.enable(),g.map.map.dragPan.enable(),g.map.map.keyboard.enable(),g.map.map.doubleClickZoom.enable(),g.map.map.touchZoomRotate.enable())},[g.map]);function S(){if(!g.map||!t.route)return;const k=ih(t.route);let L;k&&k.length>3&&(L=[[k[0],k[1]],[k[2],k[3]]],g.map.map.fitBounds(L,{padding:100}))}function E(){if(g.map)if(r.current)v();else{b(),typeof n.current<"u"&&g.map.map.getZoom()!==n.current&&g.map.map.setZoom(n.current);const k=Ebe(t.route,a.current*u).geometry.coordinates;a.current*u<h?(g.map.map.easeTo({center:k,bearing:lb(Rh([g.map.map.getCenter().lng,g.map.map.getCenter().lat]),Rh(k)),duration:f,essential:!0}),typeof s.current<"u"?a.current=a.current+s.current:a.current++,console.log("PAN MOVE"),setTimeout(()=>{E()},100)):(g.map.map.setPitch(0),S(),v(),console.log("ENABLE CONTROLS"),a.current=1)}}function P(){g.map&&(S(),v(),a.current=1)}return ee.useEffect(()=>{!g.map||e.current||(e.current=!0,S())},[g.map]),ee.useEffect(()=>()=>{o.current&&clearTimeout(o.current)},[]),{play:E,reset:P}};sM.defaultProps={mapId:void 0,zoom:18};try{sM.displayName="useCameraFollowPath",sM.__docgenInfo={description:"Component template",displayName:"useCameraFollowPath",props:{mapId:{defaultValue:{value:"undefined"},description:"Id of the target MapLibre instance in mapContext",name:"mapId",required:!1,type:{name:"string | undefined"}},insertBeforeLayer:{defaultValue:null,description:`Id of an existing layer in the mapLibre instance to help specify the layer order
This layer will be visually beneath the layer with the "insertBeforeLayer" id.`,name:"insertBeforeLayer",required:!1,type:{name:"string | undefined"}},pause:{defaultValue:null,description:"",name:"pause",required:!1,type:{name:"boolean | undefined"}},zoom:{defaultValue:{value:"18"},description:"",name:"zoom",required:!1,type:{name:"number | undefined"}},pitch:{defaultValue:null,description:"",name:"pitch",required:!1,type:{name:"number | undefined"}},speed:{defaultValue:null,description:"",name:"speed",required:!1,type:{name:"number | undefined"}},kmPerStep:{defaultValue:null,description:"",name:"kmPerStep",required:!1,type:{name:"number | undefined"}},route:{defaultValue:null,description:"",name:"route",required:!1,type:{name:"any"}},stepDuration:{defaultValue:null,description:"",name:"stepDuration",required:!1,type:{name:"number | undefined"}},timeoutId:{defaultValue:null,description:"",name:"timeoutId",required:!1,type:{name:"number | undefined"}}}}}catch{}const YPe=()=>ee.useContext(FR),VS=t=>(ee.useEffect(()=>{if(!(!t.protocol||typeof t.handler!="function"))return lP.addProtocol(t.protocol,t.handler),()=>{lP.removeProtocol(t.protocol)}},[t]),{});VS.defaultProps={mapId:void 0};try{VS.displayName="useAddProtocol",VS.__docgenInfo={description:"Enables the use of custom protocols (basically custom tile load functions) in the maplibre-gl-js library.",displayName:"useAddProtocol",props:{protocol:{defaultValue:null,description:"the protocol string, for example `mbtiles`\nIn this example the handler function is called for all tile requests that start with the string `mbtiles://`",name:"protocol",required:!0,type:{name:"string"}},handler:{defaultValue:null,description:"Custom load tile function that will be called when using a source that starts with a custom url schema.",name:"handler",required:!0,type:{name:"AddProtocolAction"}}}}}catch{}function wJ(t){return new Function("d","return {"+t.map(function(e,r){return JSON.stringify(e)+": d["+r+"]"}).join(",")+"}")}function ZPe(t,e){var r=wJ(t);return function(n,i){return e(r(n),i,t)}}function KPe(t){var e=Object.create(null),r=[];return t.forEach(function(n){for(var i in n)i in e||r.push(e[i]=i)}),r}function eN(t){var e=new RegExp('["'+t+`
]`),r=t.charCodeAt(0);function n(h,f){var g,b,v=i(h,function(S,E){if(g)return g(S,E-1);b=S,g=f?ZPe(S,f):wJ(S)});return v.columns=b,v}function i(h,f){var g={},b={},v=[],S=h.length,E=0,P=0,k,L;function O(){if(E>=S)return b;if(L)return L=!1,g;var z=E,B;if(h.charCodeAt(z)===34){for(var q=z;q++<S;)if(h.charCodeAt(q)===34){if(h.charCodeAt(q+1)!==34)break;++q}return E=q+2,B=h.charCodeAt(q+1),B===13?(L=!0,h.charCodeAt(q+2)===10&&++E):B===10&&(L=!0),h.slice(z+1,q).replace(/""/g,'"')}for(;E<S;){var W=1;if(B=h.charCodeAt(E++),B===10)L=!0;else if(B===13)L=!0,h.charCodeAt(E)===10&&(++E,++W);else if(B!==r)continue;return h.slice(z,E-W)}return h.slice(z)}for(;(k=O())!==b;){for(var M=[];k!==g&&k!==b;)M.push(k),k=O();f&&(M=f(M,P++))==null||v.push(M)}return v}function a(h,f){return f==null&&(f=KPe(h)),[f.map(u).join(t)].concat(h.map(function(g){return f.map(function(b){return u(g[b])}).join(t)})).join(`
`)}function s(h){return h.map(o).join(`
`)}function o(h){return h.map(u).join(t)}function u(h){return h==null?"":e.test(h+="")?'"'+h.replace(/\"/g,'""')+'"':h}return{parse:n,parseRows:i,format:a,formatRows:s}}var zT=eN(","),JPe=zT.parse,QPe=zT.parseRows,eke=zT.format,tke=zT.formatRows,jT=eN("	"),rke=jT.parse,nke=jT.parseRows,ike=jT.format,ake=jT.formatRows;const oke=Object.freeze(Object.defineProperty({__proto__:null,csvFormat:eke,csvFormatRows:tke,csvParse:JPe,csvParseRows:QPe,dsvFormat:eN,tsvFormat:ike,tsvFormatRows:ake,tsvParse:rke,tsvParseRows:nke},Symbol.toStringTag,{value:"Module"})),ske=eW(oke);var Lg={exports:{}},HV;function lke(){if(HV)return Lg.exports;HV=1,Lg.exports=t,Lg.exports.pair=a,Lg.exports.format=r,Lg.exports.formatPair=e,Lg.exports.coordToDMS=n;function t(o,u){var h=i(o,u);return h===null?null:h.val}function e(o){return r(o.lat,"lat")+" "+r(o.lon,"lon")}function r(o,u){var h=n(o,u);return h.whole+" "+(h.minutes?h.minutes+"' ":"")+(h.seconds?h.seconds+'" ':"")+h.dir}function n(o,u){var h={lat:["N","S"],lon:["E","W"]}[u]||"",f=h[o>=0?0:1],g=Math.abs(o),b=Math.floor(g),v=g-b,S=v*60,E=Math.floor(S),P=Math.floor((S-E)*60);return{whole:b,minutes:E,seconds:P,dir:f}}function i(o,u){if(u||(u="NSEW"),typeof o!="string")return null;o=o.toUpperCase();var h=/^[\s\,]*([NSEW])?\s*([\-|\|\]?[0-9.]+)[]?\s*(?:([0-9.]+)[']\s*)?(?:([0-9.]+)(?:''|"||)\s*)?([NSEW])?/,f=o.match(h);if(!f)return null;var g=f[0],b;if(f[1]&&f[5]?(b=f[1],g=g.slice(0,-1)):b=f[1]||f[5],b&&u.indexOf(b)===-1)return null;var v=f[2]?parseFloat(f[2]):0,S=f[3]?parseFloat(f[3])/60:0,E=f[4]?parseFloat(f[4])/3600:0,P=v<0?-1:1;return(b==="S"||b==="W")&&(P*=-1),{val:(Math.abs(v)+S+E)*P,dim:b,matched:g,remain:o.slice(g.length)}}function a(o,u){o=o.trim();var h=i(o,u);if(!h)return null;o=h.remain.trim();var f=i(o,u);return!f||f.remain?null:h.dim?s(h.val,f.val,h.dim):[h.val,f.val]}function s(o,u,h){if(h==="N"||h==="S")return[o,u];if(h==="W"||h==="E")return[u,o]}return Lg.exports}var uI,WV;function uke(){if(WV)return uI;WV=1;var t=ske,e=lke(),r=/(Lat)(itude)?/gi,n=/(L)(on|ng)(gitude)?/i;function i(P,k){var L,O,M;for(var z in P)O=z.match(k),O&&(!L||O[0].length/z.length>M)&&(M=O[0].length/z.length,L=z);return L}function a(P){return i(P,r)}function s(P){return i(P,n)}function o(P){return!!P.match(r)}function u(P){return!!P.match(n)}function h(P){return typeof P=="object"?Object.keys(P).length:0}function f(P){var k=[",",";","	","|"],L=[];return k.forEach(function(O){var M=t.dsvFormat(O).parse(P);if(M.length>=1){for(var z=h(M[0]),B=0;B<M.length;B++)if(h(M[B])!==z)return;L.push({delimiter:O,arity:Object.keys(M[0]).length})}}),L.length?L.sort(function(O,M){return M.arity-O.arity})[0].delimiter:null}function g(P){return delete P.columns,P}function b(P){var k=f(P);return k?g(t.dsvFormat(k).parse(P)):null}function v(P,k,L){L||(L=k,k={}),k.delimiter=k.delimiter||",";var O=k.latfield||"",M=k.lonfield||"",z=k.crs||"",B=[],q={type:"FeatureCollection",features:B};if(z!==""&&(q.crs={type:"name",properties:{name:z}}),k.delimiter==="auto"&&typeof P=="string"&&(k.delimiter=f(P),!k.delimiter)){L({type:"Error",message:"Could not autodetect delimiter"});return}var W=k.numericFields?k.numericFields.split(","):null,G=typeof P=="string"?t.dsvFormat(k.delimiter).parse(P,function(me){if(W)for(var we in me)W.includes(we)&&(me[we]=+me[we]);return me}):P;if(!G.length){L(null,q);return}var ie=[],Q;O||(O=a(G[0])),M||(M=s(G[0]));var H=!O||!M;if(H){for(Q=0;Q<G.length;Q++)B.push({type:"Feature",properties:G[Q],geometry:null});L(ie.length?ie:null,q);return}for(Q=0;Q<G.length;Q++)if(G[Q][M]!==void 0&&G[Q][O]!==void 0){var ne=G[Q][M],oe=G[Q][O],ce,fe,Me;Me=e(ne,"EW"),Me&&(ne=Me),Me=e(oe,"NS"),Me&&(oe=Me),ce=parseFloat(ne),fe=parseFloat(oe),isNaN(ce)||isNaN(fe)?ie.push({message:"A row contained an invalid value for latitude or longitude",row:G[Q],index:Q}):(k.includeLatLon||(delete G[Q][M],delete G[Q][O]),B.push({type:"Feature",properties:G[Q],geometry:{type:"Point",coordinates:[parseFloat(ce),parseFloat(fe)]}}))}L(ie.length?ie:null,q)}function S(P){for(var k=P.features,L={type:"Feature",geometry:{type:"LineString",coordinates:[]}},O=0;O<k.length;O++)L.geometry.coordinates.push(k[O].geometry.coordinates);return L.properties=k.reduce(function(M,z){for(var B in z.properties)M[B]||(M[B]=[]),M[B].push(z.properties[B]);return M},{}),{type:"FeatureCollection",features:[L]}}function E(P){for(var k=P.features,L={type:"Feature",geometry:{type:"Polygon",coordinates:[[]]}},O=0;O<k.length;O++)L.geometry.coordinates[0].push(k[O].geometry.coordinates);return L.properties=k.reduce(function(M,z){for(var B in z.properties)M[B]||(M[B]=[]),M[B].push(z.properties[B]);return M},{}),{type:"FeatureCollection",features:[L]}}return uI={isLon:u,isLat:o,guessLatHeader:a,guessLonHeader:s,csv:t.csvParse,tsv:t.tsvParse,dsv:t,auto:b,csv2geojson:v,toLine:S,toPolygon:E},uI}var cke=uke();function UT(t){const e=t.split("?"),r=e[0].split("://"),n=r[0],s=(r.length>2?r[1]+"://"+r[2]:r[1]).split("/").join("/"),o=decodeURI(e[1]),u=Object.fromEntries(new URLSearchParams(o));return{protocolId:n,filename:s,options:u}}async function VT(t){try{return await(await fetch(t)).text()}catch(e){return console.error("File could not be loaded: ",e),e}}async function hke(t,e){return await new Promise((n,i)=>{const a=e||{};t.substring(t.length-3)==="tsv"&&(e.delimiter="	"),VT(t).then(o=>{cke.csv2geojson(o,a,(u,h)=>{u?i(u):n(h)})})})}const fke=async t=>{const e=UT(t.url),r=await hke(e.filename,e.options);if(r!==void 0)return{data:r};throw new Error("CSV not found "+e.filename)};var rc={},GV;function hx(){if(GV)return rc;GV=1,Object.defineProperty(rc,"__esModule",{value:!0}),rc.purgeProps=t,rc.first=e,rc.last=r,rc.coordsToKey=n,rc.addToMap=i,rc.removeFromMap=a,rc.getFirstFromMap=s,rc.isRing=o,rc.ringDirection=u,rc.pointInsidePolygon=h,rc.strArrayArrayToFloat=f,rc.strArrayToFloat=g;function t(b,v){if(b){const S=Object.assign({},b);if(v)for(const E of v)delete S[E];return S}return{}}function e(b){return b[0]}function r(b){return b[b.length-1]}function n(b){return b.join(",")}function i(b,v,S){const E=b[v];E?E.push(S):b[v]=[S]}function a(b,v,S){const E=b[v];let P=-1;E&&(P=E.indexOf(S)),P>=0&&E.splice(P,1)}function s(b,v){const S=b[v];return S&&S.length>0?S[0]:null}function o(b){return b.length>3&&n(e(b))===n(r(b))}function u(b,v,S){v=v||0,S=S||1;const E=b.reduce((G,ie,Q)=>b[G][v||0]>ie[v||0]?G:Q,0),P=E<=0?b.length-2:E-1,k=E>=b.length-1?1:E+1,L=b[P][v],O=b[E][v],M=b[k][v],z=b[P][S],B=b[E][S],q=b[k][S];return(O-L)*(q-z)-(M-L)*(B-z)<0?"clockwise":"counterclockwise"}function h(b,v,S,E){S=S||0,E=E||1;let P=!1;for(let k=0,L=v.length-1;k<v.length;L=k++)(v[k][S]<=b[S]&&b[S]<v[L][S]||v[L][S]<=b[S]&&b[S]<v[k][S])&&b[E]<(v[L][E]-v[k][E])*(b[S]-v[k][S])/(v[L][S]-v[k][S])+v[k][E]&&(P=!P);return P}function f(b){return b.map(g)}function g(b){return b.map(parseFloat)}return rc}var P_={},XV;function dke(){if(XV)return P_;XV=1,Object.defineProperty(P_,"__esModule",{value:!0}),P_.XmlParser=void 0;function t(i){return i.match(/^(.+?)\[(.+?)\]>$/g)!==null}function e(i){const a=/^(.+?)\[(.+?)\]>$/g.exec(i);return a?{evt:a[1]+">",exp:a[2]}:{evt:i}}function r(i){const a="return "+i.replace(/(\$.+?)(?=[=!.])/g,"node.$&")+";";return new Function("node",a)}class n{constructor(a){this.queryParent=!1,this.progressive=!1,this.parentMap=new WeakMap,a&&(this.queryParent=!!a.queryParent,this.progressive=a.progressive,this.queryParent&&(this.parentMap=new WeakMap)),this.evtListeners={}}parse(a,s,o){o=o?o+".":"";const u=/<([^ >\/]+)(.*?)>/mg,h=[];let f=u.exec(a);for(;f;){const g=f[1],b={$tag:g},v=o+g,S=f[2].trim();let E=!1;(S.endsWith("/")||g.startsWith("?")||g.startsWith("!"))&&(E=!0);const P=/([^ ]+?)="(.+?)"/g,k=/([^ ]+?)='(.+?)'/g;let L=P.exec(S),O=!1;for(;L;)O=!0,b[L[1]]=L[2],L=P.exec(S);if(!O)for(L=k.exec(S);L;)O=!0,b[L[1]]=L[2],L=k.exec(S);if(!O&&S!==""&&(b.text=S),this.progressive&&this.emit(`<${v}>`,b,s),!E){const M=new RegExp(`([^]+?)</${g}>`,"g");M.lastIndex=u.lastIndex;const z=M.exec(a);if(z&&z[1]){u.lastIndex=M.lastIndex;const B=this.parse(z[1],b,v);B.length>0?b.$innerNodes=B:b.$innerText=z[1]}}this.queryParent&&s&&this.parentMap.set(b,s),this.progressive&&this.emit(`</${v}>`,b,s),h.push(b),f=u.exec(a)}return h}getParent(a){return this.queryParent?this.parentMap.get(a):null}addListener(a,s){if(t(a)){const o=e(a);o.exp&&(s.condition=r(o.exp)),a=o.evt}this.$addListener(a,s)}removeListener(a,s){t(a)&&(a=e(a).evt),this.$removeListener(a,s)}on(a,s){this.addListener(a,s)}off(a,s){this.removeListener(a,s)}$addListener(a,s){const o=this.evtListeners[a];o?o.push(s):this.evtListeners[a]=[s]}$removeListener(a,s){const o=this.evtListeners[a];let u=-1;o&&(u=o.indexOf(s)),u>=0&&o.splice(u,1)}emit(a,...s){const o=this.evtListeners[a];if(o)for(const u of o)u.condition?u.condition.apply(null,s)===!0&&u.apply(null,s):u.apply(null,s)}}return P_.XmlParser=n,P_}var k_={},M_={},YV;function tN(){if(YV)return M_;YV=1,Object.defineProperty(M_,"__esModule",{value:!0}),M_.OsmObject=void 0;class t{constructor(r,n,i){this.type=r,this.id=n,this.refElems=i,this.tags={},this.props={id:this.getCompositeId()},this.refCount=0,this.hasTag=!1,i&&i.add(this.getCompositeId(),this)}addTags(r){this.tags=Object.assign(this.tags,r),this.hasTag=!0}addTag(r,n){this.tags[r]=n,this.hasTag=!0}addProp(r,n){this.props[r]=n}addProps(r){this.props=Object.assign(this.props,r)}getCompositeId(){return`${this.type}/${this.id}`}getProps(){return Object.assign(this.props,this.tags)}}return M_.OsmObject=t,M_}var ZV;function SJ(){if(ZV)return k_;ZV=1,Object.defineProperty(k_,"__esModule",{value:!0}),k_.Node=void 0;const t=tN(),e=hx();class r extends t.OsmObject{constructor(i,a){super("node",i,a)}setLatLng(i){this.latLng=i}toFeatureArray(){return this.latLng?[{type:"Feature",id:this.getCompositeId(),properties:this.getProps(),geometry:{type:"Point",coordinates:(0,e.strArrayToFloat)([this.latLng.lon,this.latLng.lat])}}]:[]}getLatLng(){return this.latLng}}return k_.Node=r,k_}var Ng={},R_={},KV;function EJ(){if(KV)return R_;KV=1,Object.defineProperty(R_,"__esModule",{value:!0}),R_.LateBinder=void 0;class t{constructor(r,n,i,a){this.container=r,this.valueFunc=n,this.ctx=i,this.args=a}bind(){const r=this.valueFunc.apply(this.ctx,this.args),n=this.container.indexOf(this);if(n<0)return;const i=[n,1];r&&i.push(r),Array.prototype.splice.apply(this.container,i)}}return R_.LateBinder=t,R_}const pke={},gke={whitelist:["services","rest_area","escape","elevator"]},mke={blacklist:["coastline","cliff","ridge","arete","tree_row"]},yke={},vke={whitelist:["riverbank","dock","boatyard","dam"]},_ke={},bke={},xke={whitelist:["city_wall","ditch","hedge","retaining_wall","wall","spikes"]},wke={whitelist:["station","turntable","roundhouse","platform"]},Ske={},Eke={},Tke={blacklist:["cutline","embankment","pipeline"]},Cke={whitelist:["plant","substation","generator","transformer"]},Ake={},Ike={},Pke={blacklist:["taxiway"]},kke={},Mke={},Rke={},Oke={},Lke={},Nke={},Dke={},Fke={},Bke={},zke={building:pke,highway:gke,natural:mke,landuse:yke,waterway:vke,amenity:_ke,leisure:bke,barrier:xke,railway:wke,area:Ske,boundary:Eke,man_made:Tke,power:Cke,place:Ake,shop:Ike,aeroway:Pke,tourism:kke,historic:Mke,public_transport:Rke,office:Oke,"building:part":{},military:Lke,ruins:Nke,"area:highway":{},craft:Dke,golf:Fke,indoor:Bke};var JV;function TJ(){if(JV)return Ng;JV=1;var t=Ng&&Ng.__importDefault||function(s){return s&&s.__esModule?s:{default:s}};Object.defineProperty(Ng,"__esModule",{value:!0}),Ng.Way=void 0;const e=tN(),r=EJ(),n=hx(),i=t(zke);class a extends e.OsmObject{constructor(o,u){super("way",o,u),this.latLngArray=[],this.isPolygon=!1}addLatLng(o){this.latLngArray.push(o)}setLatLngArray(o){this.latLngArray=o}addNodeRef(o){const u=new r.LateBinder(this.latLngArray,h=>{const f=this.refElems.get(`node/${h}`);if(f)return f.refCount++,f.getLatLng()},this,[o]);this.latLngArray.push(u),this.refElems.addBinder(u)}addTags(o){super.addTags(o);for(const[u,h]of Object.entries(o))this.analyzeTag(u,h)}addTag(o,u){super.addTag(o,u),this.analyzeTag(o,u)}toCoordsArray(){return this.latLngArray.map(o=>[o.lon,o.lat])}toFeatureArray(){let o=this.toCoordsArray();if(o.length>1){const u=(0,n.strArrayArrayToFloat)(o),h={type:"Feature",id:this.getCompositeId(),properties:this.getProps(),geometry:{type:"LineString",coordinates:u}};return this.isPolygon&&(0,n.isRing)(u)?((0,n.ringDirection)(u)!=="counterclockwise"&&u.reverse(),h.geometry={type:"Polygon",coordinates:[u]},[h]):[h]}return[]}analyzeTag(o,u){const h=i.default[o];h&&(this.isPolygon=!0,h.whitelist?this.isPolygon=h.whitelist.indexOf(u)>=0:h.blacklist&&(this.isPolygon=!(h.blacklist.indexOf(u)>=0)))}}return Ng.Way=a,Ng}var O_={},L_={},QV;function jke(){if(QV)return L_;QV=1,Object.defineProperty(L_,"__esModule",{value:!0}),L_.WayCollection=void 0;const t=hx();class e extends Array{constructor(){super(),this.firstMap={},this.lastMap={}}addWay(n){const i=n.toCoordsArray();i.length>0&&(this.push(i),(0,t.addToMap)(this.firstMap,(0,t.coordsToKey)((0,t.first)(i)),i),(0,t.addToMap)(this.lastMap,(0,t.coordsToKey)((0,t.last)(i)),i))}mergeWays(){const n=[];let i=this.shift();for(;i;){(0,t.removeFromMap)(this.firstMap,(0,t.coordsToKey)((0,t.first)(i)),i),(0,t.removeFromMap)(this.lastMap,(0,t.coordsToKey)((0,t.last)(i)),i);let a=i,s;do{let o=this.getNextWay(a);s=o.next;let u=o.mergeType;if(s)switch(this.splice(this.indexOf(s),1),(0,t.removeFromMap)(this.firstMap,(0,t.coordsToKey)((0,t.first)(s)),s),(0,t.removeFromMap)(this.lastMap,(0,t.coordsToKey)((0,t.last)(s)),s),u){case 0:a=a.concat(s.slice(1));break;case 1:s.reverse(),a=a.concat(s.slice(1));break;case 2:a.reverse(),a=a.concat(s.slice(1));break;case 3:a=s.concat(a.slice(1));break}}while(s);n.push((0,t.strArrayArrayToFloat)(a)),i=this.shift()}return n}getNextWay(n){const i=(0,t.coordsToKey)((0,t.last)(n)),a=(0,t.coordsToKey)((0,t.first)(n));let s=this.length>0?this[0]:null;if(s){const o=(0,t.coordsToKey)((0,t.first)(s)),u=(0,t.coordsToKey)((0,t.last)(s));if(i===o)return{next:s,mergeType:0};if(i===u)return{next:s,mergeType:1};if(a===o)return{next:s,mergeType:2};if(a===u)return{next:s,mergeType:3}}return s=(0,t.getFirstFromMap)(this.firstMap,i),s?{next:s,mergeType:0}:(s=(0,t.getFirstFromMap)(this.lastMap,i),{next:s,mergeType:1})}toRings(n){const i=this.mergeWays(),a=[];let s=i.shift();for(;s;)(0,t.isRing)(s)&&((0,t.ringDirection)(s)!==n&&s.reverse(),a.push(s)),s=i.shift();return a}}return L_.WayCollection=e,L_}var e$;function Uke(){if(e$)return O_;e$=1,Object.defineProperty(O_,"__esModule",{value:!0}),O_.Relation=void 0;const t=tN(),e=TJ(),r=SJ(),n=jke(),i=EJ(),a=hx();class s extends t.OsmObject{constructor(u,h){super("relation",u,h),this.relations=[],this.nodes=[],this.bounds=void 0,this.ways=[],this.roles=[]}setBounds(u){this.bounds=u}addMember(u){switch(u.type){case"relation":let h=new i.LateBinder(this.relations,g=>{const b=this.refElems.get(`relation/${g}`);if(b)return b.refCount++,b},this,[u.ref]);this.relations.push(h),this.refElems.addBinder(h);break;case"way":if(u.role||(u.role=""),u.geometry){const g=new e.Way(u.ref,this.refElems);g.setLatLngArray(u.geometry),g.refCount++,this.ways.push(g),this.roles.push(u.role)}else if(u.nodes){const g=new e.Way(u.ref,this.refElems);for(const b of u.nodes)g.addNodeRef(b);g.refCount++,this.ways.push(g),this.roles.push(u.role)}else{let g=new i.LateBinder(this.ways,b=>{const v=this.refElems.get(`way/${b}`);if(v)return v.refCount++,v},this,[u.ref]);this.ways.push(g),this.roles.push(u.role),this.refElems.addBinder(g)}break;case"node":let f=null;if(u.lat&&u.lon){f=new r.Node(u.ref,this.refElems),f.setLatLng({lon:u.lon,lat:u.lat}),u.tags&&f.addTags(u.tags);for(const[g,b]of Object.entries(u))["id","type","lat","lon"].indexOf(g)<0&&f.addProp(g,b);f.refCount++,this.nodes.push(f)}else{let g=new i.LateBinder(this.nodes,b=>{const v=this.refElems.get(`node/${b}`);if(v)return v.refCount++,v},this,[u.ref]);this.nodes.push(g),this.refElems.addBinder(g)}break}}constructStringGeometry(u){const h=u?u.mergeWays():[];return h.length===0?null:{type:"MultiLineString",coordinates:h}}constructPolygonGeometry(u,h){const f=u?u.toRings("counterclockwise"):[],g=h?h.toRings("clockwise"):[];if(f.length>0){const b=[];let v;for(v of f)b.push([v]);for(v=g.shift();v;){for(const S in f)if((0,a.pointInsidePolygon)((0,a.first)(v),f[S])){b[S].push(v);break}v=g.shift()}return b.length===1?{type:"Polygon",coordinates:b[0]}:{type:"MultiPolygon",coordinates:b}}return null}toFeatureArray(){const u=[],h=[];let f=[];for(const b of this.relations)if(b)for(let v=0;v<b.ways.length;v++){const S=b.ways[v];this.ways.push(S),this.roles.push(b.roles[v])}let g={type:"Feature",id:this.getCompositeId(),bbox:this.bounds,properties:this.getProps(),geometry:null};if(this.bounds||delete g.bbox,this.roles.some(b=>b==="outer")){const b=new n.WayCollection,v=new n.WayCollection;for(let P=0;P<this.ways.length;P++){const k=this.ways[P],L=this.roles[P];L==="outer"?b.addWay(k):L==="inner"&&v.addWay(k)}let S=Object.assign({},g),E=this.constructPolygonGeometry(b,v);E&&(S.geometry=E,u.push(S))}else{const b=new n.WayCollection;for(let S of this.ways)b.addWay(S);let v=this.constructStringGeometry(b);if(v){let S=Object.assign({},g);S.geometry=v,h.push(S)}}for(let b of this.nodes)f=f.concat(b.toFeatureArray());return[...u,...h,...f]}}return O_.Relation=s,O_}var N_={},t$;function Vke(){if(t$)return N_;t$=1,Object.defineProperty(N_,"__esModule",{value:!0}),N_.RefElements=void 0;class t extends Map{constructor(){super(),this.binders=[]}add(r,n){this.set(r,n)}addBinder(r){this.binders.push(r)}bindAll(){this.binders.forEach(r=>r.bind())}}return N_.RefElements=t,N_}var cI,r$;function $ke(){if(r$)return cI;r$=1;const t=hx(),e=dke(),r=SJ(),n=TJ(),i=Uke(),a=Vke();function s(g){if(!g)return{completeFeature:!1,renderTagged:!1,excludeWay:!0};let b=g.excludeWay===void 0||g.excludeWay,v=!!g.completeFeature,S=!!g.renderTagged;return{completeFeature:v,renderTagged:S,excludeWay:b}}function o(g){return g.elements?"json":g.indexOf("<osm")>=0?"xml":g.trim().startsWith("{")?"json-raw":"invalid"}function u(g,b){for(const v of g.elements)switch(v.type){case"node":const S=new r.Node(v.id,b);v.tags&&S.addTags(v.tags),S.addProps((0,t.purgeProps)(v,["id","type","tags","lat","lon"])),S.setLatLng(v);break;case"way":const E=new n.Way(v.id,b);if(v.tags&&E.addTags(v.tags),E.addProps((0,t.purgeProps)(v,["id","type","tags","nodes","geometry"])),v.geometry)E.setLatLngArray(v.geometry);else if(v.nodes)for(const k of v.nodes)E.addNodeRef(k);break;case"relation":const P=new i.Relation(v.id,b);if(v.bounds&&P.setBounds([parseFloat(v.bounds.minlon),parseFloat(v.bounds.minlat),parseFloat(v.bounds.maxlon),parseFloat(v.bounds.maxlat)]),v.tags&&P.addTags(v.tags),P.addProps((0,t.purgeProps)(v,["id","type","tags","bounds","members"])),v.members)for(const k of v.members)P.addMember(k)}}function h(g,b){const v=new e.XmlParser({progressive:!0});v.on("</osm.node>",S=>{const E=new r.Node(S.id,b);for(const[P,k]of Object.entries(S))!P.startsWith("$")&&["id","lon","lat"].indexOf(P)<0&&E.addProp(P,k);if(E.setLatLng(S),S.$innerNodes)for(const P of S.$innerNodes)P.$tag==="tag"&&E.addTag(P.k,P.v)}),v.on("</osm.way>",S=>{const E=new n.Way(S.id,b);for(const[P,k]of Object.entries(S))!P.startsWith("$")&&["id"].indexOf(P)<0&&E.addProp(P,k);if(S.$innerNodes)for(const P of S.$innerNodes)P.$tag==="nd"?P.lon&&P.lat?E.addLatLng(P):P.ref&&E.addNodeRef(P.ref):P.$tag==="tag"&&E.addTag(P.k,P.v)}),v.on("<osm.relation>",S=>new i.Relation(S.id,b)),v.on("</osm.relation.member>",(S,E)=>{const P=b.get(`relation/${E?.id}`),k={type:S.type,role:S.role?S.role:"",ref:S.ref};if(S.lat&&S.lon){k.lat=S.lat,k.lon=S.lon,k.tags={};for(const[L,O]of Object.entries(S))!L.startsWith("$")&&["type","lat","lon"].indexOf(L)<0&&(k[L]=O)}if(S.$innerNodes){const L=[],O=[];for(const M of S.$innerNodes)M.lat&&M.lon?L.push(M):M.ref&&O.push(M.ref);L.length>0?k.geometry=L:O.length>0&&(k.nodes=O)}P.addMember(k)}),v.on("</osm.relation.bounds>",(S,E)=>{b.get(`relation/${E?.id}`).setBounds([parseFloat(S.minlon),parseFloat(S.minlat),parseFloat(S.maxlon),parseFloat(S.maxlat)])}),v.on("</osm.relation.tag>",(S,E)=>{b.get(`relation/${E?.id}`).addTag(S.k,S.v)}),v.parse(g)}function f(g,b){let{completeFeature:v,renderTagged:S,excludeWay:E}=s(b),P=o(g);const k=new a.RefElements;let L=[];P==="json-raw"&&(g=JSON.parse(g),g.elements?P="json":P="invalid"),P==="json"?u(g,k):P==="xml"&&h(g,k),k.bindAll();for(const O of k.values()){if(O.refCount>0&&(!O.hasTag||!S||O instanceof n.Way&&E))continue;const M=O.toFeatureArray();if(O instanceof i.Relation&&!v&&M.length>0)return M[0].geometry;L=L.concat(M)}return{type:"FeatureCollection",features:L}}return cI=f,cI}var qke=$ke();const Hke=od(qke);async function Wke(t){const e=t.options||{};return await new Promise((n,i)=>{VT(t.filename).then(a=>{const s=Hke(a,e);s?n(s):i("Conversion failed")})})}const Gke=async t=>{const e=UT(t.url),r=await Wke(e);if(r!==void 0)return{data:r};throw new Error("OSM File not found "+e.filename)};function Xke(t){const e=[];return t.features.forEach(r=>{r.features?r.features.forEach(n=>{e.push({type:n.type,geometry:n.geometry,properties:n.properties})}):e.push({type:r.type,geometry:r.geometry,properties:r.properties})}),e}async function Yke(t){return await new Promise(r=>{let n={type:"Topology",objects:{key:""},arcs:[]};VT(t.filename).then(i=>{try{n=JSON.parse(i)}catch(s){throw console.error("Error converting topojson",s),"Invalid TopoJson"}let a={type:"FeatureCollection",features:[]};if(n.type==="Topology"&&n.objects!==void 0){const s=n.objects;Object.keys(n.objects).map(o=>{s?.[o].type==="GeometryCollection"?s?.[o].geometries?.forEach(u=>u.properties={fromObject:o,...u.properties}):s?.[o]&&s?.[o]?.type!=="GeometryCollection"&&(s[o].properties={fromObject:o,...s?.[o].properties})}),a={type:"FeatureCollection",features:Object.keys(n.objects).map(o=>Yxe(n,o))},a.features=Xke(a)}r(a)})})}const Zke=async t=>{const e=UT(t.url),r=await Yke(e);if(r!==void 0)return{data:r};throw new Error("Topojson not found "+e.filename)};function Zs(t,e){return Array.from(t.getElementsByTagName(e))}function $S(t){return t[0]==="#"?t:`#${t}`}function Kke(t,e,r){return Array.from(t.getElementsByTagNameNS(r,e))}function _s(t){return t?.normalize(),t?.textContent||""}function Ho(t,e,r){const n=t.getElementsByTagName(e),i=n.length?n[0]:null;return i&&r&&r(i),i}function oh(t,e,r){const n={};if(!t)return n;const i=t.getElementsByTagName(e),a=i.length?i[0]:null;return a&&r?r(a,n):n}function Tm(t,e,r){const n=_s(Ho(t,e));return n&&r?r(n)||{}:{}}function n$(t,e,r){const n=Number.parseFloat(_s(Ho(t,e)));if(!Number.isNaN(n))return n&&r?r(n)||{}:{}}function mu(t,e,r){const n=Number.parseFloat(_s(Ho(t,e)));if(!Number.isNaN(n))return r&&r(n),n}function Cm(t,e){const r={};for(const n of e)Tm(t,n,i=>{r[n]=i});return r}function fx(t){return t?.nodeType===1}function CJ(t){let e=[];if(t===null)return e;for(const r of Array.from(t.childNodes)){if(!fx(r))continue;const n=Jke(r.nodeName);if(n==="gpxtpx:TrackPointExtension")e=e.concat(CJ(r));else{const i=_s(r);e.push([n,Qke(i)])}}return e}function Jke(t){return["heart","gpxtpx:hr","hr"].includes(t)?"heart":t}function Qke(t){const e=Number.parseFloat(t);return Number.isNaN(e)?t:e}function AJ(t){const e=[Number.parseFloat(t.getAttribute("lon")||""),Number.parseFloat(t.getAttribute("lat")||"")];if(Number.isNaN(e[0])||Number.isNaN(e[1]))return null;mu(t,"ele",n=>{e.push(n)});const r=Ho(t,"time");return{coordinates:e,time:r?_s(r):null,extendedValues:CJ(Ho(t,"extensions"))}}function IJ(t){return oh(t,"line",e=>Object.assign({},Tm(e,"color",n=>({stroke:`#${n}`})),n$(e,"opacity",n=>({"stroke-opacity":n})),n$(e,"width",n=>({"stroke-width":n*96/25.4}))))}function rN(t,e){const r=Cm(e,["name","cmt","desc","type","time","keywords"]);for(const[i,a]of t)for(const s of Array.from(e.getElementsByTagNameNS(a,"*")))r[s.tagName.replace(":","_")]=_s(s)?.trim();const n=Zs(e,"link");return n.length&&(r.links=n.map(i=>Object.assign({href:i.getAttribute("href")},Cm(i,["text","type"])))),r}function PJ(t,e){const r=Zs(t,e),n=[],i=[],a={};for(let s=0;s<r.length;s++){const o=AJ(r[s]);if(o){n.push(o.coordinates),o.time&&i.push(o.time);for(const[u,h]of o.extendedValues){const f=u==="heart"?u:`${u.replace("gpxtpx:","")}s`;a[f]||(a[f]=Array(r.length).fill(null)),a[f][s]=h}}}if(!(n.length<2))return{line:n,times:i,extendedValues:a}}function eMe(t,e){const r=PJ(e,"rtept");if(r)return{type:"Feature",properties:Object.assign({_gpxType:"rte"},rN(t,e),IJ(Ho(e,"extensions"))),geometry:{type:"LineString",coordinates:r.line}}}function tMe(t,e){const r=Zs(e,"trkseg"),n=[],i=[],a=[];for(const u of r){const h=PJ(u,"trkpt");h&&(a.push(h),h.times?.length&&i.push(h.times))}if(a.length===0)return null;const s=a.length>1,o=Object.assign({_gpxType:"trk"},rN(t,e),IJ(Ho(e,"extensions")),i.length?{coordinateProperties:{times:s?i:i[0]}}:{});for(let u=0;u<a.length;u++){const h=a[u];n.push(h.line),o.coordinateProperties||(o.coordinateProperties={});const f=o.coordinateProperties;for(const[g,b]of Object.entries(h.extendedValues))s?(f[g]||(f[g]=a.map(v=>new Array(v.line.length).fill(null))),f[g][u]=b):f[g]=b}return{type:"Feature",properties:o,geometry:s?{type:"MultiLineString",coordinates:n}:{type:"LineString",coordinates:n[0]}}}function rMe(t,e){const r=Object.assign(rN(t,e),Cm(e,["sym"])),n=AJ(e);return n?{type:"Feature",properties:r,geometry:{type:"Point",coordinates:n.coordinates}}:null}function*kJ(t){const e=t,r="gpxx",n="http://www.garmin.com/xmlschemas/GpxExtensions/v3",i=[[r,n]],a=e.getElementsByTagName("gpx")[0]?.attributes;if(a)for(const s of Array.from(a))s.name?.startsWith("xmlns:")&&s.value!==n&&i.push([s.name,s.value]);for(const s of Zs(e,"trk")){const o=tMe(i,s);o&&(yield o)}for(const s of Zs(e,"rte")){const o=eMe(i,s);o&&(yield o)}for(const s of Zs(e,"wpt")){const o=rMe(i,s);o&&(yield o)}}function nMe(t){return{type:"FeatureCollection",features:Array.from(kJ(t))}}const iMe="http://www.garmin.com/xmlschemas/ActivityExtension/v2",aMe=[["heartRate","heartRates"],["Cadence","cadences"],["Speed","speeds"],["Watts","watts"]],oMe=[["TotalTimeSeconds","totalTimeSeconds"],["DistanceMeters","distanceMeters"],["MaximumSpeed","maxSpeed"],["AverageHeartRateBpm","avgHeartRate"],["MaximumHeartRateBpm","maxHeartRate"],["AvgSpeed","avgSpeed"],["AvgWatts","avgWatts"],["MaxWatts","maxWatts"]];function MJ(t,e){const r=[];for(const[n,i]of e){let a=Ho(t,n);if(!a){const o=t.getElementsByTagNameNS(iMe,n);o.length&&(a=o[0])}const s=Number.parseFloat(_s(a));Number.isNaN(s)||r.push([i,s])}return r}function sMe(t){const e=[mu(t,"LongitudeDegrees"),mu(t,"LatitudeDegrees")];if(e[0]===void 0||Number.isNaN(e[0])||e[1]===void 0||Number.isNaN(e[1]))return null;const r=Ho(t,"HeartRateBpm"),n=_s(Ho(t,"Time"));return Ho(t,"AltitudeMeters",i=>{const a=Number.parseFloat(_s(i));Number.isNaN(a)||e.push(a)}),{coordinates:e,time:n||null,heartRate:r?Number.parseFloat(_s(r)):null,extensions:MJ(t,aMe)}}function lMe(t){const e=Zs(t,"Trackpoint"),r=[],n=[],i=[];if(e.length<2)return null;const a={},s={extendedProperties:a};for(let o=0;o<e.length;o++){const u=sMe(e[o]);if(u===null)continue;r.push(u.coordinates);const{time:h,heartRate:f,extensions:g}=u;h&&n.push(h),f&&i.push(f);for(const[b,v]of g)a[b]||(a[b]=Array(e.length).fill(null)),a[b][o]=v}return r.length<2?null:Object.assign(s,{line:r,times:n,heartRates:i})}function i$(t){const e=Zs(t,"Track"),r=[],n=[],i=[],a=[];let s;const o=Object.assign(Object.fromEntries(MJ(t,oMe)),oh(t,"Name",u=>({name:_s(u)})));for(const u of e)s=lMe(u),s&&(r.push(s.line),s.times.length&&n.push(s.times),s.heartRates.length&&i.push(s.heartRates),a.push(s.extendedProperties));for(let u=0;u<a.length;u++){const h=a[u];for(const f in h)e.length===1?s&&(o[f]=s.extendedProperties[f]):(o[f]||(o[f]=r.map(g=>Array(g.length).fill(null))),o[f][u]=h[f])}return r.length===0?null:((n.length||i.length)&&(o.coordinateProperties=Object.assign(n.length?{times:r.length===1?n[0]:n}:{},i.length?{heart:r.length===1?i[0]:i}:{})),{type:"Feature",properties:o,geometry:r.length===1?{type:"LineString",coordinates:r[0]}:{type:"MultiLineString",coordinates:r}})}function*RJ(t){for(const e of Zs(t,"Lap")){const r=i$(e);r&&(yield r)}for(const e of Zs(t,"Courses")){const r=i$(e);r&&(yield r)}}function uMe(t){return{type:"FeatureCollection",features:Array.from(RJ(t))}}function OJ(t,e){const r={},n=e==="stroke"||e==="fill"?e:`${e}-color`;return t[0]==="#"&&(t=t.substring(1)),t.length===6||t.length===3?r[n]=`#${t}`:t.length===8&&(r[`${e}-opacity`]=Number.parseInt(t.substring(0,2),16)/255,r[n]=`#${t.substring(6,8)}${t.substring(4,6)}${t.substring(2,4)}`),r}function qS(t,e,r){const n={};return mu(t,e,i=>{n[r]=i}),n}function nN(t,e){return oh(t,"color",r=>OJ(_s(r),e))}function iN(t){return oh(t,"Icon",(e,r)=>(Tm(e,"href",n=>{r.icon=n}),r))}function cMe(t){return oh(t,"IconStyle",e=>Object.assign(nN(e,"icon"),qS(e,"scale","icon-scale"),qS(e,"heading","icon-heading"),oh(e,"hotSpot",r=>{const n=Number.parseFloat(r.getAttribute("x")||""),i=Number.parseFloat(r.getAttribute("y")||""),a=r.getAttribute("xunits")||"",s=r.getAttribute("yunits")||"";return!Number.isNaN(n)&&!Number.isNaN(i)?{"icon-offset":[n,i],"icon-offset-units":[a,s]}:{}}),iN(e)))}function hMe(t){return oh(t,"LabelStyle",e=>Object.assign(nN(e,"label"),qS(e,"scale","label-scale")))}function fMe(t){return oh(t,"LineStyle",e=>Object.assign(nN(e,"stroke"),qS(e,"width","stroke-width")))}function dMe(t){return oh(t,"PolyStyle",(e,r)=>Object.assign(r,oh(e,"color",n=>OJ(_s(n),"fill")),Tm(e,"fill",n=>{if(n==="0")return{"fill-opacity":0}}),Tm(e,"outline",n=>{if(n==="0")return{"stroke-opacity":0}})))}function $T(t){return Object.assign({},dMe(t),fMe(t),hMe(t),cMe(t))}const pMe=/\s*/g,gMe=/^\s*|\s*$/g,mMe=/\s+/;function LJ(t){return t.replace(pMe,"").split(",").map(Number.parseFloat).filter(e=>!Number.isNaN(e)).slice(0,3)}function lM(t){return t.replace(gMe,"").split(mMe).map(LJ).filter(e=>e.length>=2)}function yMe(t){let e=Zs(t,"coord");e.length===0&&(e=Kke(t,"coord","*"));const r=e.map(n=>_s(n).split(" ").map(Number.parseFloat));return r.length===0?null:{geometry:r.length>2?{type:"LineString",coordinates:r}:{type:"Point",coordinates:r[0]},times:Zs(t,"when").map(n=>_s(n))}}function NJ(t){if(t.length===0)return t;const e=t[0],r=t[t.length-1];let n=!0;for(let i=0;i<Math.max(e.length,r.length);i++)if(e[i]!==r[i]){n=!1;break}return n?t:t.concat([t[0]])}function Ew(t){return _s(Ho(t,"coordinates"))}function DJ(t){let e=[],r=[];for(let n=0;n<t.childNodes.length;n++){const i=t.childNodes.item(n);if(fx(i))switch(i.tagName){case"MultiGeometry":case"MultiTrack":case"gx:MultiTrack":{const a=DJ(i);e=e.concat(a.geometries),r=r.concat(a.coordTimes);break}case"Point":{const a=LJ(Ew(i));a.length>=2&&e.push({type:"Point",coordinates:a});break}case"LinearRing":case"LineString":{const a=lM(Ew(i));a.length>=2&&e.push({type:"LineString",coordinates:a});break}case"Polygon":{const a=[];for(const s of Zs(i,"LinearRing")){const o=NJ(lM(Ew(s)));o.length>=4&&a.push(o)}a.length&&e.push({type:"Polygon",coordinates:a});break}case"Track":case"gx:Track":{const a=yMe(i);if(!a)break;const{times:s,geometry:o}=a;e.push(o),s.length&&r.push(s);break}}}return{geometries:e,coordTimes:r}}const Vy=t=>Number(t),uM={string:t=>t,int:Vy,uint:Vy,short:Vy,ushort:Vy,float:Vy,double:Vy,bool:t=>!!t};function aN(t,e){return oh(t,"ExtendedData",(r,n)=>{for(const i of Zs(r,"Data"))n[i.getAttribute("name")||""]=_s(Ho(i,"value"));for(const i of Zs(r,"SimpleData")){const a=i.getAttribute("name")||"",s=e[a]||uM.string;n[a]=s(_s(i))}return n})}function oN(t){const e=Ho(t,"description");for(const r of Array.from(e?.childNodes||[]))if(r.nodeType===4)return{description:{"@type":"html",value:_s(r)}};return{}}function sN(t){return oh(t,"TimeSpan",e=>({timespan:{begin:_s(Ho(e,"begin")),end:_s(Ho(e,"end"))}}))}function lN(t){return oh(t,"TimeStamp",e=>({timestamp:_s(Ho(e,"when"))}))}function uN(t,e){return Tm(t,"styleUrl",r=>(r=$S(r),e[r]?Object.assign({styleUrl:r},e[r]):{styleUrl:r}))}var fh;(function(t){t.ABSOLUTE="absolute",t.RELATIVE_TO_GROUND="relativeToGround",t.CLAMP_TO_GROUND="clampToGround",t.CLAMP_TO_SEAFLOOR="clampToSeaFloor",t.RELATIVE_TO_SEAFLOOR="relativeToSeaFloor"})(fh||(fh={}));function vMe(t){switch(t?.textContent){case fh.ABSOLUTE:return fh.ABSOLUTE;case fh.CLAMP_TO_GROUND:return fh.CLAMP_TO_GROUND;case fh.CLAMP_TO_SEAFLOOR:return fh.CLAMP_TO_SEAFLOOR;case fh.RELATIVE_TO_GROUND:return fh.RELATIVE_TO_GROUND;case fh.RELATIVE_TO_SEAFLOOR:return fh.RELATIVE_TO_SEAFLOOR}return null}function _Me(t){return Ho(t,"gx:LatLonQuad")?{geometry:{type:"Polygon",coordinates:[NJ(lM(Ew(t)))]}}:wMe(t)}const bMe=Math.PI/180;function xMe(t,e,r){const n=[(t[0]+t[2])/2,(t[1]+t[3])/2];return[e[0].map(i=>{const a=i[1]-n[1],s=i[0]-n[0],o=Math.sqrt(a**2+s**2),u=Math.atan2(a,s)+r*bMe;return[n[0]+Math.cos(u)*o,n[1]+Math.sin(u)*o]})]}function wMe(t){const e=Ho(t,"LatLonBox");if(e){const r=mu(e,"north"),n=mu(e,"west"),i=mu(e,"east"),a=mu(e,"south"),s=mu(e,"rotation");if(typeof r=="number"&&typeof a=="number"&&typeof n=="number"&&typeof i=="number"){const o=[n,a,i,r];let u=[[[n,r],[i,r],[i,a],[n,a],[n,r]]];return typeof s=="number"&&(u=xMe(o,u,s)),{bbox:o,geometry:{type:"Polygon",coordinates:u}}}}return null}function FJ(t,e,r,n){const i=_Me(t),a=i?.geometry||null;if(!a&&n.skipNullGeometry)return null;const s={type:"Feature",geometry:a,properties:Object.assign({"@geometry-type":"groundoverlay"},Cm(t,["name","address","visibility","open","phoneNumber","description"]),oN(t),uN(t,e),$T(t),iN(t),aN(t,r),sN(t),lN(t))};i?.bbox&&(s.bbox=i.bbox),s.properties?.visibility!==void 0&&(s.properties.visibility=s.properties.visibility!=="0");const o=t.getAttribute("id");return o!==null&&o!==""&&(s.id=o),s}function SMe(t){const e=Ho(t,"Region");return e?{coordinateBox:TMe(e),lod:EMe(t)}:null}function EMe(t){const e=Ho(t,"Lod");return e?[mu(e,"minLodPixels")??-1,mu(e,"maxLodPixels")??-1,mu(e,"minFadeExtent")??null,mu(e,"maxFadeExtent")??null]:null}function TMe(t){const e=Ho(t,"LatLonAltBox");if(e){const r=mu(e,"north"),n=mu(e,"west"),i=mu(e,"east"),a=mu(e,"south");if(vMe(Ho(e,"altitudeMode")||Ho(e,"gx:altitudeMode"))&&console.debug("Encountered an unsupported feature of KML for togeojson: please contact developers for support of altitude mode."),typeof r=="number"&&typeof a=="number"&&typeof n=="number"&&typeof i=="number")return{bbox:[n,a,i,r],geometry:{type:"Polygon",coordinates:[[[n,r],[i,r],[i,a],[n,a],[n,r]]]}}}return null}function CMe(t){const e=Ho(t,"Link");return e?Cm(e,["href","refreshMode","refreshInterval","viewRefreshMode","viewRefreshTime","viewBoundScale","viewFormat","httpQuery"]):{}}function BJ(t,e,r,n){const i=SMe(t),a=i?.coordinateBox?.geometry||null;if(!a&&n.skipNullGeometry)return null;const s={type:"Feature",geometry:a,properties:Object.assign({"@geometry-type":"networklink"},Cm(t,["name","address","visibility","open","phoneNumber","styleUrl","refreshVisibility","flyToView","description"]),oN(t),uN(t,e),$T(t),iN(t),aN(t,r),sN(t),lN(t),CMe(t),i?.lod?{lod:i.lod}:{})};i?.coordinateBox?.bbox&&(s.bbox=i.coordinateBox.bbox),s.properties?.visibility!==void 0&&(s.properties.visibility=s.properties.visibility!=="0");const o=t.getAttribute("id");return o!==null&&o!==""&&(s.id=o),s}function AMe(t){return t.length===0?null:t.length===1?t[0]:{type:"GeometryCollection",geometries:t}}function zJ(t,e,r,n){const{coordTimes:i,geometries:a}=DJ(t),s=AMe(a);if(!s&&n.skipNullGeometry)return null;const o={type:"Feature",geometry:s,properties:Object.assign(Cm(t,["name","address","visibility","open","phoneNumber","description"]),oN(t),uN(t,e),$T(t),aN(t,r),sN(t),lN(t),i.length?{coordinateProperties:{times:i.length===1?i[0]:i}}:{})};o.properties?.visibility!==void 0&&(o.properties.visibility=o.properties.visibility!=="0");const u=t.getAttribute("id");return u!==null&&u!==""&&(o.id=u),o}function IMe(t){let e=t.getAttribute("id");const r=t.parentNode;return!e&&fx(r)&&r.localName==="CascadingStyle"&&(e=r.getAttribute("kml:id")||r.getAttribute("id")),$S(e||"")}function jJ(t){const e={};for(const r of Zs(t,"Style"))e[IMe(r)]=$T(r);for(const r of Zs(t,"StyleMap")){const n=$S(r.getAttribute("id")||"");Tm(r,"styleUrl",i=>{i=$S(i),e[i]&&(e[n]=e[i])})}return e}function UJ(t){const e={};for(const r of Zs(t,"SimpleField"))e[r.getAttribute("name")||""]=uM[r.getAttribute("type")||""]||uM.string;return e}const PMe=["name","visibility","open","address","description","phoneNumber","visibility"];function kMe(t){const e={};for(const r of Array.from(t.childNodes))fx(r)&&PMe.includes(r.tagName)&&(e[r.tagName]=_s(r));return{type:"folder",meta:e,children:[]}}function MMe(t,e={skipNullGeometry:!1}){const r=t,n=jJ(r),i=UJ(r),a={type:"root",children:[]};function s(o,u,h){if(fx(o))switch(o.tagName){case"GroundOverlay":{const f=FJ(o,n,i,h);f&&u.children.push(f);break}case"Placemark":{const f=zJ(o,n,i,h);f&&u.children.push(f);break}case"Folder":{const f=kMe(o);u.children.push(f),u=f;break}case"NetworkLink":{const f=BJ(o,n,i,h);f&&u.children.push(f);break}}if(o.childNodes)for(let f=0;f<o.childNodes.length;f++)s(o.childNodes[f],u,h)}return s(r,a,e),a}function*VJ(t,e={skipNullGeometry:!1}){const r=t,n=jJ(r),i=UJ(r);for(const a of Zs(r,"Placemark")){const s=zJ(a,n,i,e);s&&(yield s)}for(const a of Zs(r,"GroundOverlay")){const s=FJ(a,n,i,e);s&&(yield s)}for(const a of Zs(r,"NetworkLink")){const s=BJ(a,n,i,e);s&&(yield s)}}function RMe(t,e={skipNullGeometry:!1}){return{type:"FeatureCollection",features:Array.from(VJ(t,e))}}const OMe=Object.freeze(Object.defineProperty({__proto__:null,gpx:nMe,gpxGen:kJ,kml:RMe,kmlGen:VJ,kmlWithFolders:MMe,tcx:uMe,tcxGen:RJ},Symbol.toStringTag,{value:"Module"}));async function LMe(t){return await new Promise((r,n)=>{VT(t.filename).then(i=>{const a=()=>t.protocolId==="tcx"?OMe[t.protocolId](new DOMParser().parseFromString(i,"text/xml")):dJ[t.protocolId](new DOMParser().parseFromString(i,"text/xml"));a()?r(a()):n("Conversion failed")})})}const hI=async t=>{const e=UT(t.url),r=await LMe(e);if(r!==void 0)return{data:r};throw new Error("XML not found "+e.filename)},cM=t=>{const e=ha({mapId:void 0}),r=ee.useRef(!1);ee.useEffect(()=>{if(!(!e.map||r.current))return e.map?.loadImage(t.imagePath).then(function(n){if(!n?.data){console.log("image "+t.imagePath+"could not be loaded");return}e.map?.addImage(t.imageId,n.data)}),()=>{e.map?.removeImage(t.imageId)}},[e.map,t])};cM.defaultProps={mapId:void 0};try{cM.displayName="useAddImage",cM.__docgenInfo={description:"",displayName:"useAddImage",props:{imageId:{defaultValue:null,description:"",name:"imageId",required:!0,type:{name:"string"}},imagePath:{defaultValue:null,description:"",name:"imagePath",required:!0,type:{name:"string"}}}}}catch{}const NMe=ht.createContext({}),hM=NMe.Provider;try{hM.displayName="SimpleDataContextProvider",hM.__docgenInfo={description:"",displayName:"SimpleDataContextProvider",props:{}}}catch{}var DMe={value:()=>{}};function $J(){for(var t=0,e=arguments.length,r={},n;t<e;++t){if(!(n=arguments[t]+"")||n in r||/[\s.]/.test(n))throw new Error("illegal type: "+n);r[n]=[]}return new Tw(r)}function Tw(t){this._=t}function FMe(t,e){return t.trim().split(/^|\s+/).map(function(r){var n="",i=r.indexOf(".");if(i>=0&&(n=r.slice(i+1),r=r.slice(0,i)),r&&!e.hasOwnProperty(r))throw new Error("unknown type: "+r);return{type:r,name:n}})}Tw.prototype=$J.prototype={constructor:Tw,on:function(t,e){var r=this._,n=FMe(t+"",r),i,a=-1,s=n.length;if(arguments.length<2){for(;++a<s;)if((i=(t=n[a]).type)&&(i=BMe(r[i],t.name)))return i;return}if(e!=null&&typeof e!="function")throw new Error("invalid callback: "+e);for(;++a<s;)if(i=(t=n[a]).type)r[i]=a$(r[i],t.name,e);else if(e==null)for(i in r)r[i]=a$(r[i],t.name,null);return this},copy:function(){var t={},e=this._;for(var r in e)t[r]=e[r].slice();return new Tw(t)},call:function(t,e){if((i=arguments.length-2)>0)for(var r=new Array(i),n=0,i,a;n<i;++n)r[n]=arguments[n+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(a=this._[t],n=0,i=a.length;n<i;++n)a[n].value.apply(e,r)},apply:function(t,e,r){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var n=this._[t],i=0,a=n.length;i<a;++i)n[i].value.apply(e,r)}};function BMe(t,e){for(var r=0,n=t.length,i;r<n;++r)if((i=t[r]).name===e)return i.value}function a$(t,e,r){for(var n=0,i=t.length;n<i;++n)if(t[n].name===e){t[n]=DMe,t=t.slice(0,n).concat(t.slice(n+1));break}return r!=null&&t.push({name:e,value:r}),t}var fM="http://www.w3.org/1999/xhtml";const o$={svg:"http://www.w3.org/2000/svg",xhtml:fM,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function qT(t){var e=t+="",r=e.indexOf(":");return r>=0&&(e=t.slice(0,r))!=="xmlns"&&(t=t.slice(r+1)),o$.hasOwnProperty(e)?{space:o$[e],local:t}:t}function zMe(t){return function(){var e=this.ownerDocument,r=this.namespaceURI;return r===fM&&e.documentElement.namespaceURI===fM?e.createElement(t):e.createElementNS(r,t)}}function jMe(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}function qJ(t){var e=qT(t);return(e.local?jMe:zMe)(e)}function UMe(){}function cN(t){return t==null?UMe:function(){return this.querySelector(t)}}function VMe(t){typeof t!="function"&&(t=cN(t));for(var e=this._groups,r=e.length,n=new Array(r),i=0;i<r;++i)for(var a=e[i],s=a.length,o=n[i]=new Array(s),u,h,f=0;f<s;++f)(u=a[f])&&(h=t.call(u,u.__data__,f,a))&&("__data__"in u&&(h.__data__=u.__data__),o[f]=h);return new cf(n,this._parents)}function $Me(t){return t==null?[]:Array.isArray(t)?t:Array.from(t)}function qMe(){return[]}function HJ(t){return t==null?qMe:function(){return this.querySelectorAll(t)}}function HMe(t){return function(){return $Me(t.apply(this,arguments))}}function WMe(t){typeof t=="function"?t=HMe(t):t=HJ(t);for(var e=this._groups,r=e.length,n=[],i=[],a=0;a<r;++a)for(var s=e[a],o=s.length,u,h=0;h<o;++h)(u=s[h])&&(n.push(t.call(u,u.__data__,h,s)),i.push(u));return new cf(n,i)}function WJ(t){return function(){return this.matches(t)}}function GJ(t){return function(e){return e.matches(t)}}var GMe=Array.prototype.find;function XMe(t){return function(){return GMe.call(this.children,t)}}function YMe(){return this.firstElementChild}function ZMe(t){return this.select(t==null?YMe:XMe(typeof t=="function"?t:GJ(t)))}var KMe=Array.prototype.filter;function JMe(){return Array.from(this.children)}function QMe(t){return function(){return KMe.call(this.children,t)}}function eRe(t){return this.selectAll(t==null?JMe:QMe(typeof t=="function"?t:GJ(t)))}function tRe(t){typeof t!="function"&&(t=WJ(t));for(var e=this._groups,r=e.length,n=new Array(r),i=0;i<r;++i)for(var a=e[i],s=a.length,o=n[i]=[],u,h=0;h<s;++h)(u=a[h])&&t.call(u,u.__data__,h,a)&&o.push(u);return new cf(n,this._parents)}function XJ(t){return new Array(t.length)}function rRe(){return new cf(this._enter||this._groups.map(XJ),this._parents)}function HS(t,e){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=e}HS.prototype={constructor:HS,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,e){return this._parent.insertBefore(t,e)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}};function nRe(t){return function(){return t}}function iRe(t,e,r,n,i,a){for(var s=0,o,u=e.length,h=a.length;s<h;++s)(o=e[s])?(o.__data__=a[s],n[s]=o):r[s]=new HS(t,a[s]);for(;s<u;++s)(o=e[s])&&(i[s]=o)}function aRe(t,e,r,n,i,a,s){var o,u,h=new Map,f=e.length,g=a.length,b=new Array(f),v;for(o=0;o<f;++o)(u=e[o])&&(b[o]=v=s.call(u,u.__data__,o,e)+"",h.has(v)?i[o]=u:h.set(v,u));for(o=0;o<g;++o)v=s.call(t,a[o],o,a)+"",(u=h.get(v))?(n[o]=u,u.__data__=a[o],h.delete(v)):r[o]=new HS(t,a[o]);for(o=0;o<f;++o)(u=e[o])&&h.get(b[o])===u&&(i[o]=u)}function oRe(t){return t.__data__}function sRe(t,e){if(!arguments.length)return Array.from(this,oRe);var r=e?aRe:iRe,n=this._parents,i=this._groups;typeof t!="function"&&(t=nRe(t));for(var a=i.length,s=new Array(a),o=new Array(a),u=new Array(a),h=0;h<a;++h){var f=n[h],g=i[h],b=g.length,v=lRe(t.call(f,f&&f.__data__,h,n)),S=v.length,E=o[h]=new Array(S),P=s[h]=new Array(S),k=u[h]=new Array(b);r(f,g,E,P,k,v,e);for(var L=0,O=0,M,z;L<S;++L)if(M=E[L]){for(L>=O&&(O=L+1);!(z=P[O])&&++O<S;);M._next=z||null}}return s=new cf(s,n),s._enter=o,s._exit=u,s}function lRe(t){return typeof t=="object"&&"length"in t?t:Array.from(t)}function uRe(){return new cf(this._exit||this._groups.map(XJ),this._parents)}function cRe(t,e,r){var n=this.enter(),i=this,a=this.exit();return typeof t=="function"?(n=t(n),n&&(n=n.selection())):n=n.append(t+""),e!=null&&(i=e(i),i&&(i=i.selection())),r==null?a.remove():r(a),n&&i?n.merge(i).order():i}function hRe(t){for(var e=t.selection?t.selection():t,r=this._groups,n=e._groups,i=r.length,a=n.length,s=Math.min(i,a),o=new Array(i),u=0;u<s;++u)for(var h=r[u],f=n[u],g=h.length,b=o[u]=new Array(g),v,S=0;S<g;++S)(v=h[S]||f[S])&&(b[S]=v);for(;u<i;++u)o[u]=r[u];return new cf(o,this._parents)}function fRe(){for(var t=this._groups,e=-1,r=t.length;++e<r;)for(var n=t[e],i=n.length-1,a=n[i],s;--i>=0;)(s=n[i])&&(a&&s.compareDocumentPosition(a)^4&&a.parentNode.insertBefore(s,a),a=s);return this}function dRe(t){t||(t=pRe);function e(g,b){return g&&b?t(g.__data__,b.__data__):!g-!b}for(var r=this._groups,n=r.length,i=new Array(n),a=0;a<n;++a){for(var s=r[a],o=s.length,u=i[a]=new Array(o),h,f=0;f<o;++f)(h=s[f])&&(u[f]=h);u.sort(e)}return new cf(i,this._parents).order()}function pRe(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function gRe(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this}function mRe(){return Array.from(this)}function yRe(){for(var t=this._groups,e=0,r=t.length;e<r;++e)for(var n=t[e],i=0,a=n.length;i<a;++i){var s=n[i];if(s)return s}return null}function vRe(){let t=0;for(const e of this)++t;return t}function _Re(){return!this.node()}function bRe(t){for(var e=this._groups,r=0,n=e.length;r<n;++r)for(var i=e[r],a=0,s=i.length,o;a<s;++a)(o=i[a])&&t.call(o,o.__data__,a,i);return this}function xRe(t){return function(){this.removeAttribute(t)}}function wRe(t){return function(){this.removeAttributeNS(t.space,t.local)}}function SRe(t,e){return function(){this.setAttribute(t,e)}}function ERe(t,e){return function(){this.setAttributeNS(t.space,t.local,e)}}function TRe(t,e){return function(){var r=e.apply(this,arguments);r==null?this.removeAttribute(t):this.setAttribute(t,r)}}function CRe(t,e){return function(){var r=e.apply(this,arguments);r==null?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,r)}}function ARe(t,e){var r=qT(t);if(arguments.length<2){var n=this.node();return r.local?n.getAttributeNS(r.space,r.local):n.getAttribute(r)}return this.each((e==null?r.local?wRe:xRe:typeof e=="function"?r.local?CRe:TRe:r.local?ERe:SRe)(r,e))}function YJ(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView}function IRe(t){return function(){this.style.removeProperty(t)}}function PRe(t,e,r){return function(){this.style.setProperty(t,e,r)}}function kRe(t,e,r){return function(){var n=e.apply(this,arguments);n==null?this.style.removeProperty(t):this.style.setProperty(t,n,r)}}function MRe(t,e,r){return arguments.length>1?this.each((e==null?IRe:typeof e=="function"?kRe:PRe)(t,e,r??"")):m0(this.node(),t)}function m0(t,e){return t.style.getPropertyValue(e)||YJ(t).getComputedStyle(t,null).getPropertyValue(e)}function RRe(t){return function(){delete this[t]}}function ORe(t,e){return function(){this[t]=e}}function LRe(t,e){return function(){var r=e.apply(this,arguments);r==null?delete this[t]:this[t]=r}}function NRe(t,e){return arguments.length>1?this.each((e==null?RRe:typeof e=="function"?LRe:ORe)(t,e)):this.node()[t]}function ZJ(t){return t.trim().split(/^|\s+/)}function hN(t){return t.classList||new KJ(t)}function KJ(t){this._node=t,this._names=ZJ(t.getAttribute("class")||"")}KJ.prototype={add:function(t){var e=this._names.indexOf(t);e<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var e=this._names.indexOf(t);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};function JJ(t,e){for(var r=hN(t),n=-1,i=e.length;++n<i;)r.add(e[n])}function QJ(t,e){for(var r=hN(t),n=-1,i=e.length;++n<i;)r.remove(e[n])}function DRe(t){return function(){JJ(this,t)}}function FRe(t){return function(){QJ(this,t)}}function BRe(t,e){return function(){(e.apply(this,arguments)?JJ:QJ)(this,t)}}function zRe(t,e){var r=ZJ(t+"");if(arguments.length<2){for(var n=hN(this.node()),i=-1,a=r.length;++i<a;)if(!n.contains(r[i]))return!1;return!0}return this.each((typeof e=="function"?BRe:e?DRe:FRe)(r,e))}function jRe(){this.textContent=""}function URe(t){return function(){this.textContent=t}}function VRe(t){return function(){var e=t.apply(this,arguments);this.textContent=e??""}}function $Re(t){return arguments.length?this.each(t==null?jRe:(typeof t=="function"?VRe:URe)(t)):this.node().textContent}function qRe(){this.innerHTML=""}function HRe(t){return function(){this.innerHTML=t}}function WRe(t){return function(){var e=t.apply(this,arguments);this.innerHTML=e??""}}function GRe(t){return arguments.length?this.each(t==null?qRe:(typeof t=="function"?WRe:HRe)(t)):this.node().innerHTML}function XRe(){this.nextSibling&&this.parentNode.appendChild(this)}function YRe(){return this.each(XRe)}function ZRe(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function KRe(){return this.each(ZRe)}function JRe(t){var e=typeof t=="function"?t:qJ(t);return this.select(function(){return this.appendChild(e.apply(this,arguments))})}function QRe(){return null}function eOe(t,e){var r=typeof t=="function"?t:qJ(t),n=e==null?QRe:typeof e=="function"?e:cN(e);return this.select(function(){return this.insertBefore(r.apply(this,arguments),n.apply(this,arguments)||null)})}function tOe(){var t=this.parentNode;t&&t.removeChild(this)}function rOe(){return this.each(tOe)}function nOe(){var t=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function iOe(){var t=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function aOe(t){return this.select(t?iOe:nOe)}function oOe(t){return arguments.length?this.property("__data__",t):this.node().__data__}function sOe(t){return function(e){t.call(this,e,this.__data__)}}function lOe(t){return t.trim().split(/^|\s+/).map(function(e){var r="",n=e.indexOf(".");return n>=0&&(r=e.slice(n+1),e=e.slice(0,n)),{type:e,name:r}})}function uOe(t){return function(){var e=this.__on;if(e){for(var r=0,n=-1,i=e.length,a;r<i;++r)a=e[r],(!t.type||a.type===t.type)&&a.name===t.name?this.removeEventListener(a.type,a.listener,a.options):e[++n]=a;++n?e.length=n:delete this.__on}}}function cOe(t,e,r){return function(){var n=this.__on,i,a=sOe(e);if(n){for(var s=0,o=n.length;s<o;++s)if((i=n[s]).type===t.type&&i.name===t.name){this.removeEventListener(i.type,i.listener,i.options),this.addEventListener(i.type,i.listener=a,i.options=r),i.value=e;return}}this.addEventListener(t.type,a,r),i={type:t.type,name:t.name,value:e,listener:a,options:r},n?n.push(i):this.__on=[i]}}function hOe(t,e,r){var n=lOe(t+""),i,a=n.length,s;if(arguments.length<2){var o=this.node().__on;if(o){for(var u=0,h=o.length,f;u<h;++u)for(i=0,f=o[u];i<a;++i)if((s=n[i]).type===f.type&&s.name===f.name)return f.value}return}for(o=e?cOe:uOe,i=0;i<a;++i)this.each(o(n[i],e,r));return this}function eQ(t,e,r){var n=YJ(t),i=n.CustomEvent;typeof i=="function"?i=new i(e,r):(i=n.document.createEvent("Event"),r?(i.initEvent(e,r.bubbles,r.cancelable),i.detail=r.detail):i.initEvent(e,!1,!1)),t.dispatchEvent(i)}function fOe(t,e){return function(){return eQ(this,t,e)}}function dOe(t,e){return function(){return eQ(this,t,e.apply(this,arguments))}}function pOe(t,e){return this.each((typeof e=="function"?dOe:fOe)(t,e))}function*gOe(){for(var t=this._groups,e=0,r=t.length;e<r;++e)for(var n=t[e],i=0,a=n.length,s;i<a;++i)(s=n[i])&&(yield s)}var mOe=[null];function cf(t,e){this._groups=t,this._parents=e}function dx(){return new cf([[document.documentElement]],mOe)}function yOe(){return this}cf.prototype=dx.prototype={constructor:cf,select:VMe,selectAll:WMe,selectChild:ZMe,selectChildren:eRe,filter:tRe,data:sRe,enter:rRe,exit:uRe,join:cRe,merge:hRe,selection:yOe,order:fRe,sort:dRe,call:gRe,nodes:mRe,node:yRe,size:vRe,empty:_Re,each:bRe,attr:ARe,style:MRe,property:NRe,classed:zRe,text:$Re,html:GRe,raise:YRe,lower:KRe,append:JRe,insert:eOe,remove:rOe,clone:aOe,datum:oOe,on:hOe,dispatch:pOe,[Symbol.iterator]:gOe};function fN(t,e,r){t.prototype=e.prototype=r,r.constructor=t}function tQ(t,e){var r=Object.create(t.prototype);for(var n in e)r[n]=e[n];return r}function px(){}var _b=.7,WS=1/_b,Xv="\\s*([+-]?\\d+)\\s*",bb="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",ed="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",vOe=/^#([0-9a-f]{3,8})$/,_Oe=new RegExp(`^rgb\\(${Xv},${Xv},${Xv}\\)$`),bOe=new RegExp(`^rgb\\(${ed},${ed},${ed}\\)$`),xOe=new RegExp(`^rgba\\(${Xv},${Xv},${Xv},${bb}\\)$`),wOe=new RegExp(`^rgba\\(${ed},${ed},${ed},${bb}\\)$`),SOe=new RegExp(`^hsl\\(${bb},${ed},${ed}\\)$`),EOe=new RegExp(`^hsla\\(${bb},${ed},${ed},${bb}\\)$`),s$={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};fN(px,xb,{copy(t){return Object.assign(new this.constructor,this,t)},displayable(){return this.rgb().displayable()},hex:l$,formatHex:l$,formatHex8:TOe,formatHsl:COe,formatRgb:u$,toString:u$});function l$(){return this.rgb().formatHex()}function TOe(){return this.rgb().formatHex8()}function COe(){return rQ(this).formatHsl()}function u$(){return this.rgb().formatRgb()}function xb(t){var e,r;return t=(t+"").trim().toLowerCase(),(e=vOe.exec(t))?(r=e[1].length,e=parseInt(e[1],16),r===6?c$(e):r===3?new yc(e>>8&15|e>>4&240,e>>4&15|e&240,(e&15)<<4|e&15,1):r===8?F2(e>>24&255,e>>16&255,e>>8&255,(e&255)/255):r===4?F2(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|e&240,((e&15)<<4|e&15)/255):null):(e=_Oe.exec(t))?new yc(e[1],e[2],e[3],1):(e=bOe.exec(t))?new yc(e[1]*255/100,e[2]*255/100,e[3]*255/100,1):(e=xOe.exec(t))?F2(e[1],e[2],e[3],e[4]):(e=wOe.exec(t))?F2(e[1]*255/100,e[2]*255/100,e[3]*255/100,e[4]):(e=SOe.exec(t))?d$(e[1],e[2]/100,e[3]/100,1):(e=EOe.exec(t))?d$(e[1],e[2]/100,e[3]/100,e[4]):s$.hasOwnProperty(t)?c$(s$[t]):t==="transparent"?new yc(NaN,NaN,NaN,0):null}function c$(t){return new yc(t>>16&255,t>>8&255,t&255,1)}function F2(t,e,r,n){return n<=0&&(t=e=r=NaN),new yc(t,e,r,n)}function AOe(t){return t instanceof px||(t=xb(t)),t?(t=t.rgb(),new yc(t.r,t.g,t.b,t.opacity)):new yc}function dM(t,e,r,n){return arguments.length===1?AOe(t):new yc(t,e,r,n??1)}function yc(t,e,r,n){this.r=+t,this.g=+e,this.b=+r,this.opacity=+n}fN(yc,dM,tQ(px,{brighter(t){return t=t==null?WS:Math.pow(WS,t),new yc(this.r*t,this.g*t,this.b*t,this.opacity)},darker(t){return t=t==null?_b:Math.pow(_b,t),new yc(this.r*t,this.g*t,this.b*t,this.opacity)},rgb(){return this},clamp(){return new yc(lm(this.r),lm(this.g),lm(this.b),GS(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:h$,formatHex:h$,formatHex8:IOe,formatRgb:f$,toString:f$}));function h$(){return`#${Jg(this.r)}${Jg(this.g)}${Jg(this.b)}`}function IOe(){return`#${Jg(this.r)}${Jg(this.g)}${Jg(this.b)}${Jg((isNaN(this.opacity)?1:this.opacity)*255)}`}function f$(){const t=GS(this.opacity);return`${t===1?"rgb(":"rgba("}${lm(this.r)}, ${lm(this.g)}, ${lm(this.b)}${t===1?")":`, ${t})`}`}function GS(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function lm(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function Jg(t){return t=lm(t),(t<16?"0":"")+t.toString(16)}function d$(t,e,r,n){return n<=0?t=e=r=NaN:r<=0||r>=1?t=e=NaN:e<=0&&(t=NaN),new Jh(t,e,r,n)}function rQ(t){if(t instanceof Jh)return new Jh(t.h,t.s,t.l,t.opacity);if(t instanceof px||(t=xb(t)),!t)return new Jh;if(t instanceof Jh)return t;t=t.rgb();var e=t.r/255,r=t.g/255,n=t.b/255,i=Math.min(e,r,n),a=Math.max(e,r,n),s=NaN,o=a-i,u=(a+i)/2;return o?(e===a?s=(r-n)/o+(r<n)*6:r===a?s=(n-e)/o+2:s=(e-r)/o+4,o/=u<.5?a+i:2-a-i,s*=60):o=u>0&&u<1?0:s,new Jh(s,o,u,t.opacity)}function POe(t,e,r,n){return arguments.length===1?rQ(t):new Jh(t,e,r,n??1)}function Jh(t,e,r,n){this.h=+t,this.s=+e,this.l=+r,this.opacity=+n}fN(Jh,POe,tQ(px,{brighter(t){return t=t==null?WS:Math.pow(WS,t),new Jh(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=t==null?_b:Math.pow(_b,t),new Jh(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=this.h%360+(this.h<0)*360,e=isNaN(t)||isNaN(this.s)?0:this.s,r=this.l,n=r+(r<.5?r:1-r)*e,i=2*r-n;return new yc(fI(t>=240?t-240:t+120,i,n),fI(t,i,n),fI(t<120?t+240:t-120,i,n),this.opacity)},clamp(){return new Jh(p$(this.h),B2(this.s),B2(this.l),GS(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const t=GS(this.opacity);return`${t===1?"hsl(":"hsla("}${p$(this.h)}, ${B2(this.s)*100}%, ${B2(this.l)*100}%${t===1?")":`, ${t})`}`}}));function p$(t){return t=(t||0)%360,t<0?t+360:t}function B2(t){return Math.max(0,Math.min(1,t||0))}function fI(t,e,r){return(t<60?e+(r-e)*t/60:t<180?r:t<240?e+(r-e)*(240-t)/60:e)*255}const nQ=t=>()=>t;function kOe(t,e){return function(r){return t+r*e}}function MOe(t,e,r){return t=Math.pow(t,r),e=Math.pow(e,r)-t,r=1/r,function(n){return Math.pow(t+n*e,r)}}function ROe(t){return(t=+t)==1?iQ:function(e,r){return r-e?MOe(e,r,t):nQ(isNaN(e)?r:e)}}function iQ(t,e){var r=e-t;return r?kOe(t,r):nQ(isNaN(t)?e:t)}const g$=(function t(e){var r=ROe(e);function n(i,a){var s=r((i=dM(i)).r,(a=dM(a)).r),o=r(i.g,a.g),u=r(i.b,a.b),h=iQ(i.opacity,a.opacity);return function(f){return i.r=s(f),i.g=o(f),i.b=u(f),i.opacity=h(f),i+""}}return n.gamma=t,n})(1);function kp(t,e){return t=+t,e=+e,function(r){return t*(1-r)+e*r}}var pM=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,dI=new RegExp(pM.source,"g");function OOe(t){return function(){return t}}function LOe(t){return function(e){return t(e)+""}}function NOe(t,e){var r=pM.lastIndex=dI.lastIndex=0,n,i,a,s=-1,o=[],u=[];for(t=t+"",e=e+"";(n=pM.exec(t))&&(i=dI.exec(e));)(a=i.index)>r&&(a=e.slice(r,a),o[s]?o[s]+=a:o[++s]=a),(n=n[0])===(i=i[0])?o[s]?o[s]+=i:o[++s]=i:(o[++s]=null,u.push({i:s,x:kp(n,i)})),r=dI.lastIndex;return r<e.length&&(a=e.slice(r),o[s]?o[s]+=a:o[++s]=a),o.length<2?u[0]?LOe(u[0].x):OOe(e):(e=u.length,function(h){for(var f=0,g;f<e;++f)o[(g=u[f]).i]=g.x(h);return o.join("")})}var m$=180/Math.PI,gM={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function aQ(t,e,r,n,i,a){var s,o,u;return(s=Math.sqrt(t*t+e*e))&&(t/=s,e/=s),(u=t*r+e*n)&&(r-=t*u,n-=e*u),(o=Math.sqrt(r*r+n*n))&&(r/=o,n/=o,u/=o),t*n<e*r&&(t=-t,e=-e,u=-u,s=-s),{translateX:i,translateY:a,rotate:Math.atan2(e,t)*m$,skewX:Math.atan(u)*m$,scaleX:s,scaleY:o}}var z2;function DOe(t){const e=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(t+"");return e.isIdentity?gM:aQ(e.a,e.b,e.c,e.d,e.e,e.f)}function FOe(t){return t==null||(z2||(z2=document.createElementNS("http://www.w3.org/2000/svg","g")),z2.setAttribute("transform",t),!(t=z2.transform.baseVal.consolidate()))?gM:(t=t.matrix,aQ(t.a,t.b,t.c,t.d,t.e,t.f))}function oQ(t,e,r,n){function i(h){return h.length?h.pop()+" ":""}function a(h,f,g,b,v,S){if(h!==g||f!==b){var E=v.push("translate(",null,e,null,r);S.push({i:E-4,x:kp(h,g)},{i:E-2,x:kp(f,b)})}else(g||b)&&v.push("translate("+g+e+b+r)}function s(h,f,g,b){h!==f?(h-f>180?f+=360:f-h>180&&(h+=360),b.push({i:g.push(i(g)+"rotate(",null,n)-2,x:kp(h,f)})):f&&g.push(i(g)+"rotate("+f+n)}function o(h,f,g,b){h!==f?b.push({i:g.push(i(g)+"skewX(",null,n)-2,x:kp(h,f)}):f&&g.push(i(g)+"skewX("+f+n)}function u(h,f,g,b,v,S){if(h!==g||f!==b){var E=v.push(i(v)+"scale(",null,",",null,")");S.push({i:E-4,x:kp(h,g)},{i:E-2,x:kp(f,b)})}else(g!==1||b!==1)&&v.push(i(v)+"scale("+g+","+b+")")}return function(h,f){var g=[],b=[];return h=t(h),f=t(f),a(h.translateX,h.translateY,f.translateX,f.translateY,g,b),s(h.rotate,f.rotate,g,b),o(h.skewX,f.skewX,g,b),u(h.scaleX,h.scaleY,f.scaleX,f.scaleY,g,b),h=f=null,function(v){for(var S=-1,E=b.length,P;++S<E;)g[(P=b[S]).i]=P.x(v);return g.join("")}}}var BOe=oQ(DOe,"px, ","px)","deg)"),zOe=oQ(FOe,", ",")",")"),y0=0,u1=0,D_=0,sQ=1e3,XS,c1,YS=0,Am=0,HT=0,wb=typeof performance=="object"&&performance.now?performance:Date,lQ=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function dN(){return Am||(lQ(jOe),Am=wb.now()+HT)}function jOe(){Am=0}function ZS(){this._call=this._time=this._next=null}ZS.prototype=uQ.prototype={constructor:ZS,restart:function(t,e,r){if(typeof t!="function")throw new TypeError("callback is not a function");r=(r==null?dN():+r)+(e==null?0:+e),!this._next&&c1!==this&&(c1?c1._next=this:XS=this,c1=this),this._call=t,this._time=r,mM()},stop:function(){this._call&&(this._call=null,this._time=1/0,mM())}};function uQ(t,e,r){var n=new ZS;return n.restart(t,e,r),n}function UOe(){dN(),++y0;for(var t=XS,e;t;)(e=Am-t._time)>=0&&t._call.call(void 0,e),t=t._next;--y0}function y$(){Am=(YS=wb.now())+HT,y0=u1=0;try{UOe()}finally{y0=0,$Oe(),Am=0}}function VOe(){var t=wb.now(),e=t-YS;e>sQ&&(HT-=e,YS=t)}function $Oe(){for(var t,e=XS,r,n=1/0;e;)e._call?(n>e._time&&(n=e._time),t=e,e=e._next):(r=e._next,e._next=null,e=t?t._next=r:XS=r);c1=t,mM(n)}function mM(t){if(!y0){u1&&(u1=clearTimeout(u1));var e=t-Am;e>24?(t<1/0&&(u1=setTimeout(y$,t-wb.now()-HT)),D_&&(D_=clearInterval(D_))):(D_||(YS=wb.now(),D_=setInterval(VOe,sQ)),y0=1,lQ(y$))}}function v$(t,e,r){var n=new ZS;return e=e==null?0:+e,n.restart(i=>{n.stop(),t(i+e)},e,r),n}var qOe=$J("start","end","cancel","interrupt"),HOe=[],cQ=0,_$=1,yM=2,Cw=3,b$=4,vM=5,Aw=6;function WT(t,e,r,n,i,a){var s=t.__transition;if(!s)t.__transition={};else if(r in s)return;WOe(t,r,{name:e,index:n,group:i,on:qOe,tween:HOe,time:a.time,delay:a.delay,duration:a.duration,ease:a.ease,timer:null,state:cQ})}function pN(t,e){var r=yf(t,e);if(r.state>cQ)throw new Error("too late; already scheduled");return r}function hd(t,e){var r=yf(t,e);if(r.state>Cw)throw new Error("too late; already running");return r}function yf(t,e){var r=t.__transition;if(!r||!(r=r[e]))throw new Error("transition not found");return r}function WOe(t,e,r){var n=t.__transition,i;n[e]=r,r.timer=uQ(a,0,r.time);function a(h){r.state=_$,r.timer.restart(s,r.delay,r.time),r.delay<=h&&s(h-r.delay)}function s(h){var f,g,b,v;if(r.state!==_$)return u();for(f in n)if(v=n[f],v.name===r.name){if(v.state===Cw)return v$(s);v.state===b$?(v.state=Aw,v.timer.stop(),v.on.call("interrupt",t,t.__data__,v.index,v.group),delete n[f]):+f<e&&(v.state=Aw,v.timer.stop(),v.on.call("cancel",t,t.__data__,v.index,v.group),delete n[f])}if(v$(function(){r.state===Cw&&(r.state=b$,r.timer.restart(o,r.delay,r.time),o(h))}),r.state=yM,r.on.call("start",t,t.__data__,r.index,r.group),r.state===yM){for(r.state=Cw,i=new Array(b=r.tween.length),f=0,g=-1;f<b;++f)(v=r.tween[f].value.call(t,t.__data__,r.index,r.group))&&(i[++g]=v);i.length=g+1}}function o(h){for(var f=h<r.duration?r.ease.call(null,h/r.duration):(r.timer.restart(u),r.state=vM,1),g=-1,b=i.length;++g<b;)i[g].call(t,f);r.state===vM&&(r.on.call("end",t,t.__data__,r.index,r.group),u())}function u(){r.state=Aw,r.timer.stop(),delete n[e];for(var h in n)return;delete t.__transition}}function GOe(t,e){var r=t.__transition,n,i,a=!0,s;if(r){e=e==null?null:e+"";for(s in r){if((n=r[s]).name!==e){a=!1;continue}i=n.state>yM&&n.state<vM,n.state=Aw,n.timer.stop(),n.on.call(i?"interrupt":"cancel",t,t.__data__,n.index,n.group),delete r[s]}a&&delete t.__transition}}function XOe(t){return this.each(function(){GOe(this,t)})}function YOe(t,e){var r,n;return function(){var i=hd(this,t),a=i.tween;if(a!==r){n=r=a;for(var s=0,o=n.length;s<o;++s)if(n[s].name===e){n=n.slice(),n.splice(s,1);break}}i.tween=n}}function ZOe(t,e,r){var n,i;if(typeof r!="function")throw new Error;return function(){var a=hd(this,t),s=a.tween;if(s!==n){i=(n=s).slice();for(var o={name:e,value:r},u=0,h=i.length;u<h;++u)if(i[u].name===e){i[u]=o;break}u===h&&i.push(o)}a.tween=i}}function KOe(t,e){var r=this._id;if(t+="",arguments.length<2){for(var n=yf(this.node(),r).tween,i=0,a=n.length,s;i<a;++i)if((s=n[i]).name===t)return s.value;return null}return this.each((e==null?YOe:ZOe)(r,t,e))}function gN(t,e,r){var n=t._id;return t.each(function(){var i=hd(this,n);(i.value||(i.value={}))[e]=r.apply(this,arguments)}),function(i){return yf(i,n).value[e]}}function hQ(t,e){var r;return(typeof e=="number"?kp:e instanceof xb?g$:(r=xb(e))?(e=r,g$):NOe)(t,e)}function JOe(t){return function(){this.removeAttribute(t)}}function QOe(t){return function(){this.removeAttributeNS(t.space,t.local)}}function eLe(t,e,r){var n,i=r+"",a;return function(){var s=this.getAttribute(t);return s===i?null:s===n?a:a=e(n=s,r)}}function tLe(t,e,r){var n,i=r+"",a;return function(){var s=this.getAttributeNS(t.space,t.local);return s===i?null:s===n?a:a=e(n=s,r)}}function rLe(t,e,r){var n,i,a;return function(){var s,o=r(this),u;return o==null?void this.removeAttribute(t):(s=this.getAttribute(t),u=o+"",s===u?null:s===n&&u===i?a:(i=u,a=e(n=s,o)))}}function nLe(t,e,r){var n,i,a;return function(){var s,o=r(this),u;return o==null?void this.removeAttributeNS(t.space,t.local):(s=this.getAttributeNS(t.space,t.local),u=o+"",s===u?null:s===n&&u===i?a:(i=u,a=e(n=s,o)))}}function iLe(t,e){var r=qT(t),n=r==="transform"?zOe:hQ;return this.attrTween(t,typeof e=="function"?(r.local?nLe:rLe)(r,n,gN(this,"attr."+t,e)):e==null?(r.local?QOe:JOe)(r):(r.local?tLe:eLe)(r,n,e))}function aLe(t,e){return function(r){this.setAttribute(t,e.call(this,r))}}function oLe(t,e){return function(r){this.setAttributeNS(t.space,t.local,e.call(this,r))}}function sLe(t,e){var r,n;function i(){var a=e.apply(this,arguments);return a!==n&&(r=(n=a)&&oLe(t,a)),r}return i._value=e,i}function lLe(t,e){var r,n;function i(){var a=e.apply(this,arguments);return a!==n&&(r=(n=a)&&aLe(t,a)),r}return i._value=e,i}function uLe(t,e){var r="attr."+t;if(arguments.length<2)return(r=this.tween(r))&&r._value;if(e==null)return this.tween(r,null);if(typeof e!="function")throw new Error;var n=qT(t);return this.tween(r,(n.local?sLe:lLe)(n,e))}function cLe(t,e){return function(){pN(this,t).delay=+e.apply(this,arguments)}}function hLe(t,e){return e=+e,function(){pN(this,t).delay=e}}function fLe(t){var e=this._id;return arguments.length?this.each((typeof t=="function"?cLe:hLe)(e,t)):yf(this.node(),e).delay}function dLe(t,e){return function(){hd(this,t).duration=+e.apply(this,arguments)}}function pLe(t,e){return e=+e,function(){hd(this,t).duration=e}}function gLe(t){var e=this._id;return arguments.length?this.each((typeof t=="function"?dLe:pLe)(e,t)):yf(this.node(),e).duration}function mLe(t,e){if(typeof e!="function")throw new Error;return function(){hd(this,t).ease=e}}function yLe(t){var e=this._id;return arguments.length?this.each(mLe(e,t)):yf(this.node(),e).ease}function vLe(t,e){return function(){var r=e.apply(this,arguments);if(typeof r!="function")throw new Error;hd(this,t).ease=r}}function _Le(t){if(typeof t!="function")throw new Error;return this.each(vLe(this._id,t))}function bLe(t){typeof t!="function"&&(t=WJ(t));for(var e=this._groups,r=e.length,n=new Array(r),i=0;i<r;++i)for(var a=e[i],s=a.length,o=n[i]=[],u,h=0;h<s;++h)(u=a[h])&&t.call(u,u.__data__,h,a)&&o.push(u);return new Kd(n,this._parents,this._name,this._id)}function xLe(t){if(t._id!==this._id)throw new Error;for(var e=this._groups,r=t._groups,n=e.length,i=r.length,a=Math.min(n,i),s=new Array(n),o=0;o<a;++o)for(var u=e[o],h=r[o],f=u.length,g=s[o]=new Array(f),b,v=0;v<f;++v)(b=u[v]||h[v])&&(g[v]=b);for(;o<n;++o)s[o]=e[o];return new Kd(s,this._parents,this._name,this._id)}function wLe(t){return(t+"").trim().split(/^|\s+/).every(function(e){var r=e.indexOf(".");return r>=0&&(e=e.slice(0,r)),!e||e==="start"})}function SLe(t,e,r){var n,i,a=wLe(e)?pN:hd;return function(){var s=a(this,t),o=s.on;o!==n&&(i=(n=o).copy()).on(e,r),s.on=i}}function ELe(t,e){var r=this._id;return arguments.length<2?yf(this.node(),r).on.on(t):this.each(SLe(r,t,e))}function TLe(t){return function(){var e=this.parentNode;for(var r in this.__transition)if(+r!==t)return;e&&e.removeChild(this)}}function CLe(){return this.on("end.remove",TLe(this._id))}function ALe(t){var e=this._name,r=this._id;typeof t!="function"&&(t=cN(t));for(var n=this._groups,i=n.length,a=new Array(i),s=0;s<i;++s)for(var o=n[s],u=o.length,h=a[s]=new Array(u),f,g,b=0;b<u;++b)(f=o[b])&&(g=t.call(f,f.__data__,b,o))&&("__data__"in f&&(g.__data__=f.__data__),h[b]=g,WT(h[b],e,r,b,h,yf(f,r)));return new Kd(a,this._parents,e,r)}function ILe(t){var e=this._name,r=this._id;typeof t!="function"&&(t=HJ(t));for(var n=this._groups,i=n.length,a=[],s=[],o=0;o<i;++o)for(var u=n[o],h=u.length,f,g=0;g<h;++g)if(f=u[g]){for(var b=t.call(f,f.__data__,g,u),v,S=yf(f,r),E=0,P=b.length;E<P;++E)(v=b[E])&&WT(v,e,r,E,b,S);a.push(b),s.push(f)}return new Kd(a,s,e,r)}var PLe=dx.prototype.constructor;function kLe(){return new PLe(this._groups,this._parents)}function MLe(t,e){var r,n,i;return function(){var a=m0(this,t),s=(this.style.removeProperty(t),m0(this,t));return a===s?null:a===r&&s===n?i:i=e(r=a,n=s)}}function fQ(t){return function(){this.style.removeProperty(t)}}function RLe(t,e,r){var n,i=r+"",a;return function(){var s=m0(this,t);return s===i?null:s===n?a:a=e(n=s,r)}}function OLe(t,e,r){var n,i,a;return function(){var s=m0(this,t),o=r(this),u=o+"";return o==null&&(u=o=(this.style.removeProperty(t),m0(this,t))),s===u?null:s===n&&u===i?a:(i=u,a=e(n=s,o))}}function LLe(t,e){var r,n,i,a="style."+e,s="end."+a,o;return function(){var u=hd(this,t),h=u.on,f=u.value[a]==null?o||(o=fQ(e)):void 0;(h!==r||i!==f)&&(n=(r=h).copy()).on(s,i=f),u.on=n}}function NLe(t,e,r){var n=(t+="")=="transform"?BOe:hQ;return e==null?this.styleTween(t,MLe(t,n)).on("end.style."+t,fQ(t)):typeof e=="function"?this.styleTween(t,OLe(t,n,gN(this,"style."+t,e))).each(LLe(this._id,t)):this.styleTween(t,RLe(t,n,e),r).on("end.style."+t,null)}function DLe(t,e,r){return function(n){this.style.setProperty(t,e.call(this,n),r)}}function FLe(t,e,r){var n,i;function a(){var s=e.apply(this,arguments);return s!==i&&(n=(i=s)&&DLe(t,s,r)),n}return a._value=e,a}function BLe(t,e,r){var n="style."+(t+="");if(arguments.length<2)return(n=this.tween(n))&&n._value;if(e==null)return this.tween(n,null);if(typeof e!="function")throw new Error;return this.tween(n,FLe(t,e,r??""))}function zLe(t){return function(){this.textContent=t}}function jLe(t){return function(){var e=t(this);this.textContent=e??""}}function ULe(t){return this.tween("text",typeof t=="function"?jLe(gN(this,"text",t)):zLe(t==null?"":t+""))}function VLe(t){return function(e){this.textContent=t.call(this,e)}}function $Le(t){var e,r;function n(){var i=t.apply(this,arguments);return i!==r&&(e=(r=i)&&VLe(i)),e}return n._value=t,n}function qLe(t){var e="text";if(arguments.length<1)return(e=this.tween(e))&&e._value;if(t==null)return this.tween(e,null);if(typeof t!="function")throw new Error;return this.tween(e,$Le(t))}function HLe(){for(var t=this._name,e=this._id,r=dQ(),n=this._groups,i=n.length,a=0;a<i;++a)for(var s=n[a],o=s.length,u,h=0;h<o;++h)if(u=s[h]){var f=yf(u,e);WT(u,t,r,h,s,{time:f.time+f.delay+f.duration,delay:0,duration:f.duration,ease:f.ease})}return new Kd(n,this._parents,t,r)}function WLe(){var t,e,r=this,n=r._id,i=r.size();return new Promise(function(a,s){var o={value:s},u={value:function(){--i===0&&a()}};r.each(function(){var h=hd(this,n),f=h.on;f!==t&&(e=(t=f).copy(),e._.cancel.push(o),e._.interrupt.push(o),e._.end.push(u)),h.on=e}),i===0&&a()})}var GLe=0;function Kd(t,e,r,n){this._groups=t,this._parents=e,this._name=r,this._id=n}function dQ(){return++GLe}var Ad=dx.prototype;Kd.prototype={constructor:Kd,select:ALe,selectAll:ILe,selectChild:Ad.selectChild,selectChildren:Ad.selectChildren,filter:bLe,merge:xLe,selection:kLe,transition:HLe,call:Ad.call,nodes:Ad.nodes,node:Ad.node,size:Ad.size,empty:Ad.empty,each:Ad.each,on:ELe,attr:iLe,attrTween:uLe,style:NLe,styleTween:BLe,text:ULe,textTween:qLe,remove:CLe,tween:KOe,delay:fLe,duration:gLe,ease:yLe,easeVarying:_Le,end:WLe,[Symbol.iterator]:Ad[Symbol.iterator]};function XLe(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}var YLe={time:null,delay:0,duration:250,ease:XLe};function ZLe(t,e){for(var r;!(r=t.__transition)||!(r=r[e]);)if(!(t=t.parentNode))throw new Error(`transition ${e} not found`);return r}function KLe(t){var e,r;t instanceof Kd?(e=t._id,t=t._name):(e=dQ(),(r=YLe).time=dN(),t=t==null?null:t+"");for(var n=this._groups,i=n.length,a=0;a<i;++a)for(var s=n[a],o=s.length,u,h=0;h<o;++h)(u=s[h])&&WT(u,t,e,h,s,r||ZLe(u,e));return new Kd(n,this._parents,t,e)}dx.prototype.interrupt=XOe;dx.prototype.transition=KLe;var x$={},pI={},gI=34,F_=10,mI=13;function pQ(t){return new Function("d","return {"+t.map(function(e,r){return JSON.stringify(e)+": d["+r+'] || ""'}).join(",")+"}")}function JLe(t,e){var r=pQ(t);return function(n,i){return e(r(n),i,t)}}function w$(t){var e=Object.create(null),r=[];return t.forEach(function(n){for(var i in n)i in e||r.push(e[i]=i)}),r}function gc(t,e){var r=t+"",n=r.length;return n<e?new Array(e-n+1).join(0)+r:r}function QLe(t){return t<0?"-"+gc(-t,6):t>9999?"+"+gc(t,6):gc(t,4)}function eNe(t){var e=t.getUTCHours(),r=t.getUTCMinutes(),n=t.getUTCSeconds(),i=t.getUTCMilliseconds();return isNaN(t)?"Invalid Date":QLe(t.getUTCFullYear())+"-"+gc(t.getUTCMonth()+1,2)+"-"+gc(t.getUTCDate(),2)+(i?"T"+gc(e,2)+":"+gc(r,2)+":"+gc(n,2)+"."+gc(i,3)+"Z":n?"T"+gc(e,2)+":"+gc(r,2)+":"+gc(n,2)+"Z":r||e?"T"+gc(e,2)+":"+gc(r,2)+"Z":"")}function tNe(t){var e=new RegExp('["'+t+`
\r]`),r=t.charCodeAt(0);function n(g,b){var v,S,E=i(g,function(P,k){if(v)return v(P,k-1);S=P,v=b?JLe(P,b):pQ(P)});return E.columns=S||[],E}function i(g,b){var v=[],S=g.length,E=0,P=0,k,L=S<=0,O=!1;g.charCodeAt(S-1)===F_&&--S,g.charCodeAt(S-1)===mI&&--S;function M(){if(L)return pI;if(O)return O=!1,x$;var B,q=E,W;if(g.charCodeAt(q)===gI){for(;E++<S&&g.charCodeAt(E)!==gI||g.charCodeAt(++E)===gI;);return(B=E)>=S?L=!0:(W=g.charCodeAt(E++))===F_?O=!0:W===mI&&(O=!0,g.charCodeAt(E)===F_&&++E),g.slice(q+1,B-1).replace(/""/g,'"')}for(;E<S;){if((W=g.charCodeAt(B=E++))===F_)O=!0;else if(W===mI)O=!0,g.charCodeAt(E)===F_&&++E;else if(W!==r)continue;return g.slice(q,B)}return L=!0,g.slice(q,S)}for(;(k=M())!==pI;){for(var z=[];k!==x$&&k!==pI;)z.push(k),k=M();b&&(z=b(z,P++))==null||v.push(z)}return v}function a(g,b){return g.map(function(v){return b.map(function(S){return f(v[S])}).join(t)})}function s(g,b){return b==null&&(b=w$(g)),[b.map(f).join(t)].concat(a(g,b)).join(`
`)}function o(g,b){return b==null&&(b=w$(g)),a(g,b).join(`
`)}function u(g){return g.map(h).join(`
`)}function h(g){return g.map(f).join(t)}function f(g){return g==null?"":g instanceof Date?eNe(g):e.test(g+="")?'"'+g.replace(/"/g,'""')+'"':g}return{parse:n,parseRows:i,format:s,formatBody:o,formatRows:u,formatRow:h,formatValue:f}}var rNe=tNe(","),nNe=rNe.parse;function iNe(t){if(!t.ok)throw new Error(t.status+" "+t.statusText);return t.text()}function gQ(t,e){return fetch(t,e).then(iNe)}function aNe(t){return function(e,r,n){return arguments.length===2&&typeof r=="function"&&(n=r,r=void 0),gQ(e,r).then(function(i){return t(i,n)})}}var oNe=aNe(nNe);function sNe(t){if(!t.ok)throw new Error(t.status+" "+t.statusText);if(!(t.status===204||t.status===205))return t.json()}function lNe(t,e){return fetch(t,e).then(sNe)}function uNe(t){return(e,r)=>gQ(e,r).then(n=>new DOMParser().parseFromString(n,t))}const cNe=uNe("application/xml");function h1(t,e,r){this.k=t,this.x=e,this.y=r}h1.prototype={constructor:h1,scale:function(t){return t===1?this:new h1(this.k*t,this.x,this.y)},translate:function(t,e){return t===0&e===0?this:new h1(this.k,this.x+this.k*t,this.y+this.k*e)},apply:function(t){return[t[0]*this.k+this.x,t[1]*this.k+this.y]},applyX:function(t){return t*this.k+this.x},applyY:function(t){return t*this.k+this.y},invert:function(t){return[(t[0]-this.x)/this.k,(t[1]-this.y)/this.k]},invertX:function(t){return(t-this.x)/this.k},invertY:function(t){return(t-this.y)/this.k},rescaleX:function(t){return t.copy().domain(t.range().map(this.invertX,this).map(t.invert,t))},rescaleY:function(t){return t.copy().domain(t.range().map(this.invertY,this).map(t.invert,t))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};h1.prototype;const S$=t=>{const[e,r]=ee.useState();ee.useEffect(()=>{if(!t.url)return;let i=null;t.format==="json"?i=lNe(t.url):t.format==="csv"?i=oNe(t.url):t.format==="xml"&&(i=cNe(t.url)),i&&i.then(a=>{if(t.format==="xml"){if(t.nodeType){const s=[];a.querySelectorAll(t.nodeType).forEach(o=>{typeof t.formatData=="function"&&s.push(t.formatData(o))}),r(s)}}else{let s=a;t.data_property&&(s=a[t.data_property]),typeof t.formatData=="function"?r(s.map(t.formatData)):r(s)}typeof t.onData=="function"&&t.onData()})},[t.url,t]);const n={data:e,setData:r};return K.jsx(hM,{value:n,children:t.children})};try{S$.displayName="SimpleDataProvider",S$.__docgenInfo={description:"",displayName:"SimpleDataProvider",props:{url:{defaultValue:null,description:"",name:"url",required:!0,type:{name:"string"}},format:{defaultValue:null,description:"",name:"format",required:!0,type:{name:"enum",value:[{value:'"json"'},{value:'"csv"'},{value:'"xml"'}]}},nodeType:{defaultValue:null,description:"",name:"nodeType",required:!0,type:{name:"string"}},data_property:{defaultValue:null,description:"",name:"data_property",required:!0,type:{name:"string"}},formatData:{defaultValue:null,description:"",name:"formatData",required:!1,type:{name:"((data: any) => any) | undefined"}},onData:{defaultValue:null,description:"",name:"onData",required:!0,type:{name:"() => void"}}}}}catch{}const Iw=Hi(K.jsx("path",{d:"M12 4c4.41 0 8 3.59 8 8s-3.59 8-8 8-8-3.59-8-8 3.59-8 8-8m0-2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m1 10V8h-2v4H8l4 4 4-4z"})),Pw=Hi(K.jsx("path",{d:"M12 20c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8m0 2c5.52 0 10-4.48 10-10S17.52 2 12 2 2 6.48 2 12s4.48 10 10 10m-1-10v4h2v-4h3l-4-4-4 4z"})),yI=Hi(K.jsx("path",{d:"M5 15H3v4c0 1.1.9 2 2 2h4v-2H5zM5 5h4V3H5c-1.1 0-2 .9-2 2v4h2zm14-2h-4v2h4v4h2V5c0-1.1-.9-2-2-2m0 16h-4v2h4c1.1 0 2-.9 2-2v-4h-2zM12 8c-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4-1.79-4-4-4m0 6c-1.1 0-2-.9-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2"})),hNe=t=>{let{transform:e}=t;return{...e,x:0}},Id=Pr(eh)({padding:"4px",marginTop:"-3px",background:"none","&:hover":{background:"none"}});function _M(t){const e=YPe(),r=ha({mapId:void 0});function n(g){const b=g.id&&r.map?.getLayer(g.id)?.source?r.map?.getLayer(g.id)?.source:void 0;let v=null;switch(g.type){case"geojson":if(g.config?.geojson)r.map?.fitBounds(ih(g.config?.geojson),t.fitBoundsOptions);else{if(!b)return;const S={type:"FeatureCollection",features:r.map?.querySourceFeatures(b)};S.features.length===0&&(r.map?.zoomTo(1),S.features=r.map?.querySourceFeatures(b)),v=ih(S)}break;case"vt":console.log("vt");break;case"wms":v=g?.config?.config?.layers?.[0]?.EX_GeographicBoundingBox;break;default:return}v&&r.map?.fitBounds(v,t.fitBoundsOptions)}const i=ee.useMemo(()=>["order-background",...[...e.layers].map((b,v)=>"content_order_"+v),"order-labels"],[e.layers]),a=ee.useMemo(()=>t.layers?t.layers:e?.layers?e.layers:[],[t.layers,e.layers]),s=ee.useMemo(()=>t.setLayers?t.setLayers:e.setLayers,[t.setLayers,e.setLayers]),o=aV(JL,{activationConstraint:{distance:5}}),u=aV(QK,{activationConstraint:{distance:5}}),h=H5e(u,o);function f(g){const b=g.active.id,v=g.over?.data?.current?.sortable.index;e.moveLayer(String(b),()=>v)}return K.jsxs(K.Fragment,{children:[K.jsx(US,{layerIds:i,insertBeforeLayer:"_background"}),e?.symbolLayers?.length>0&&K.jsx(Fd,{layerComponent:K.jsx(Gv,{...e.vtLayerConfig,layers:e.symbolLayers,mapId:t?.mapId,insertBeforeLayer:"order-labels"}),setLayerState:g=>e.setSymbolLayers(g?.layers),visible:!0,configurable:!0,type:"layer",name:"Labels"},"background_labels"),K.jsx(X4e,{collisionDetection:Z5e,sensors:h,onDragEnd:g=>f(g),modifiers:[hNe],children:K.jsxs(sIe,{items:a,strategy:aIe,children:[[...a].map((g,b)=>{if(!g?.id)return null;switch(g.type){case"geojson":return K.jsx(Fd,{layerId:g.id,sortable:t.sortable,name:g?.name||g?.config?.type+" layer"||"unnamed layer",layerComponent:K.jsx(wc,{...g.config,mapId:t?.mapId,layerId:g.id,insertBeforeLayer:"content_order_"+(a.length-1-b)}),buttons:K.jsxs(K.Fragment,{children:[K.jsx(Id,{disabled:b===a.length-1,onClick:()=>{e.moveDown(g.id||"")},children:K.jsx(Iw,{})}),K.jsx(Id,{disabled:b===0,onClick:()=>{e.moveUp(g.id||"")},children:K.jsx(Pw,{})}),K.jsx(Id,{onClick:()=>n(g),children:K.jsx(yI,{})})]}),setLayerState:v=>s?.(S=>{const E=[...S];return v===!1?E.splice(b,1):E[b].config=v,E}),configurable:!0,showDeleteButton:!0},g.id);case"wms":return K.jsx(K.Fragment,{children:ee.createElement(rM,{...g.config,key:g.id,layerId:g.id,sortable:t.sortable,mapId:t?.mapId,insertBeforeLayer:"content_order_"+(a.length-1-b),onConfigChange:v=>{s?.(S=>{const E=[...S];return v===!1?E.splice(b,1):E[b].config.config=v,E})},featureInfoActive:g?.config?.featureInfoActive||!1,setFeatureInfoActive:v=>{s?.(S=>{const E=[...S];return typeof v=="function"&&(E[b].config.featureInfoActive=v(E[b].config?.featureInfoActive||!1)),E})},showDeleteButton:!0,buttons:K.jsxs(K.Fragment,{children:[K.jsx(Id,{disabled:b===a.length-1,onClick:()=>{e.moveDown(g.id||"")},children:K.jsx(Iw,{})}),K.jsx(Id,{disabled:b===0,onClick:()=>{e.moveUp(g.id||"")},children:K.jsx(Pw,{})}),K.jsx(Id,{onClick:()=>n(g),children:K.jsx(yI,{})})]})})});case"vt":return K.jsx(ht.Fragment,{children:K.jsx(Fd,{name:g?.name||g?.type+" layer"||"unnamed layer",layerComponent:K.jsx(Gv,{layers:g?.config?.layers||[],mapId:g?.config.mapId,sourceOptions:g?.config?.sourceOptions,layerId:g.id,url:g?.config?.url},g.id),buttons:K.jsxs(K.Fragment,{children:[K.jsx(Id,{disabled:b===a.length-1,onClick:()=>{e.moveDown(g.id||"")},children:K.jsx(Iw,{})},g.id+"_button1"),K.jsx(Id,{disabled:b===0,onClick:()=>{e.moveUp(g.id||"")},children:K.jsx(Pw,{})},g.id+"_button2"),K.jsx(Id,{onClick:()=>n(g),children:K.jsx(yI,{})})]}),setLayerState:v=>s?.(S=>{const E=[...S];return v===!1?E.splice(b,1):E[b].config=v,E}),configurable:!0,showDeleteButton:!0},g.id)},g?.id+"_listItem");default:return null}}),e?.backgroundLayers?.length>0&&K.jsx(Fd,{layerComponent:K.jsx(Gv,{...e.vtLayerConfig,layers:e.backgroundLayers,mapId:t?.mapId,insertBeforeLayer:"order-background"}),setLayerState:g=>{e.setBackgroundLayers(g?.layers)},visible:!0,configurable:!0,type:"layer",name:"Background"},"background_geometry")]})})]})}_M.defaultProps={mapId:void 0};try{_M.displayName="LayerListItemFactory",_M.__docgenInfo={description:"",displayName:"LayerListItemFactory",props:{mapId:{defaultValue:{value:"undefined"},description:"",name:"mapId",required:!1,type:{name:"string | undefined"}},layers:{defaultValue:null,description:"",name:"layers",required:!0,type:{name:"LayerConfig[]"}},setLayers:{defaultValue:null,description:"",name:"setLayers",required:!1,type:{name:"((layers: LayerConfig[] | ((state: LayerConfig[]) => LayerConfig[])) => void) | undefined"}},insertBeforeLayer:{defaultValue:null,description:"",name:"insertBeforeLayer",required:!1,type:{name:"string | undefined"}},sortable:{defaultValue:null,description:"",name:"sortable",required:!1,type:{name:"boolean | undefined"}},fitBoundsOptions:{defaultValue:null,description:"",name:"fitBoundsOptions",required:!1,type:{name:"FitBoundsOptions | undefined"}}}}}catch{}const fNe=Hi(K.jsx("path",{d:"M14 10H3v2h11zm0-4H3v2h11zm4 8v-4h-2v4h-4v2h4v4h2v-4h4v-2zM3 16h7v-2H3z"})),dNe=["fill","line","circle"];function bM(t){const[e,r]=ht.useState({type:"circle"}),n=ee.useMemo(()=>!(!e?.type||!e?.geojson),[e]);return K.jsxs(K.Fragment,{children:[K.jsx(Bm,{children:"GeoJSON layer"}),K.jsxs(Zc,{fullWidth:!0,children:[K.jsx($p,{id:"type-label",children:"Type"}),K.jsx(qp,{labelId:"type-label",value:e.type,label:"Type",onChange:i=>r(a=>({...a,type:i.target.value})),children:dNe.map(i=>K.jsx(im,{value:i,children:i},i))})]}),K.jsx(Zc,{fullWidth:!0,children:K.jsxs(Ji,{variant:"contained",component:"label",sx:{marginTop:"10px"},children:["Upload File",K.jsx("input",{type:"file",hidden:!0,onChange:i=>{i.target.files?.[0].text().then(a=>r(s=>({...s,geojson:JSON.parse(a)})))}})]})}),K.jsxs(Wb,{children:[K.jsx(Ji,{onClick:t.onCancel,children:"Cancel"}),K.jsx(Ji,{disabled:!n,onClick:()=>t.onSubmit(e),children:"Add"})]})]})}try{bM.displayName="GeoJsonLayerForm",bM.__docgenInfo={description:"",displayName:"GeoJsonLayerForm",props:{config:{defaultValue:null,description:"",name:"config",required:!1,type:{name:"MlGeoJsonLayerProps | undefined"}},onSubmit:{defaultValue:null,description:"",name:"onSubmit",required:!0,type:{name:"(config: MlGeoJsonLayerProps) => void"}},onCancel:{defaultValue:null,description:"",name:"onCancel",required:!0,type:{name:"() => void"}}}}}catch{}const pNe=Hi([K.jsx("path",{d:"M8 8H6v7c0 1.1.9 2 2 2h9v-2H8z"},"0"),K.jsx("path",{d:"M20 3h-8c-1.1 0-2 .9-2 2v6c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2m0 8h-8V7h8zM4 12H2v7c0 1.1.9 2 2 2h9v-2H4z"},"1")]),KS=t=>K.jsxs(K.Fragment,{children:[K.jsx(Bm,{children:t.layerTypes.length>1?"Select a layer type":"Load new layer"}),K.jsx(ff,{children:t.layerTypes.map((e,r)=>K.jsx(Ih,{disableGutters:!0,children:K.jsxs(TG,{autoFocus:!0,onClick:()=>{t.onSelect(e)},children:[K.jsx(AG,{children:K.jsx(dG,{children:K.jsx(pNe,{})})}),K.jsx(yh,{primary:e})]})},r))})]});KS.defaultProps={};try{KS.displayName="LayerTypeForm",KS.__docgenInfo={description:"",displayName:"LayerTypeForm",props:{onSelect:{defaultValue:null,description:"",name:"onSelect",required:!0,type:{name:"(type: string) => void"}},layerTypes:{defaultValue:null,description:"",name:"layerTypes",required:!0,type:{name:"string[]"}}}}}catch{}function xM(t){const[e,r]=ht.useState({url:""}),n=ee.useMemo(()=>!!e?.url,[e]);return K.jsxs(K.Fragment,{children:[K.jsx(Bm,{children:"WMS layer"}),K.jsx(QR,{children:K.jsxs(Zc,{fullWidth:!0,sx:{marginTop:"10px"},children:[K.jsx($p,{htmlFor:"wms-url-input",children:"WMS URL"}),K.jsx(rT,{id:"wms-url-input",label:"WMS URL",value:e.url,onChange:i=>r({...e,url:i.target.value})})]})}),K.jsxs(Wb,{children:[K.jsx(Ji,{onClick:t.onCancel,children:"Cancel"}),K.jsx(Ji,{disabled:!n,onClick:()=>t.onSubmit(e),children:"Add"})]})]})}try{xM.displayName="WmsLayerForm",xM.__docgenInfo={description:"",displayName:"WmsLayerForm",props:{onSubmit:{defaultValue:null,description:"",name:"onSubmit",required:!0,type:{name:"(config: wmsConfig) => void"}},onCancel:{defaultValue:null,description:"",name:"onCancel",required:!0,type:{name:"() => void"}}}}}catch{}const mQ=Hi(K.jsx("path",{d:"M19 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2m-2 10h-4v4h-2v-4H7v-2h4V7h2v4h4z"})),yQ=Hi(K.jsx("path",{d:"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2m-2 10H7v-2h10z"})),gNe=["latfield","lonfield","delimiter"];function wM(t){const[e,r]=ee.useState(!1);return K.jsxs(K.Fragment,{children:[K.jsx(vs,{children:" Options "}),K.jsx(Ji,{onClick:()=>r(!e),children:e?K.jsx(yQ,{}):K.jsx(mQ,{})}),K.jsx(ff,{children:e&&gNe?.map(n=>K.jsxs(K.Fragment,{children:[K.jsx(Ih,{children:K.jsxs(vs,{children:[" ",n," "]})}),K.jsx(Ih,{children:K.jsx(nT,{size:"small",onChange:i=>{const a={};a[n]=i.target.value,t.setter(a)}})})]}))})]})}try{wM.displayName="CSVOptionsFormular",wM.__docgenInfo={description:"",displayName:"CSVOptionsFormular",props:{setter:{defaultValue:null,description:"",name:"setter",required:!0,type:{name:"any"}}}}}catch{}const mNe=["completeFeature","allFeatures","renderTagged","excludeWay","suppressWay"];function SM(t){const[e,r]=ee.useState(!1);return K.jsxs(K.Fragment,{children:[K.jsx(vs,{children:" Options "}),K.jsx(Ji,{onClick:()=>r(!e),children:e?K.jsx(yQ,{}):K.jsx(mQ,{})}),K.jsx(ff,{children:e&&mNe?.map(n=>K.jsx(K.Fragment,{children:K.jsxs(Ih,{children:[K.jsxs(vs,{children:[" ",n," "]}),K.jsx(i0,{onChange:i=>{const a={};a[n]=i.target.value==="on",t.setter(a)}})]})}))})]})}try{SM.displayName="OsmOptionsFomular",SM.__docgenInfo={description:"",displayName:"OsmOptionsFomular",props:{setter:{defaultValue:null,description:"",name:"setter",required:!0,type:{name:"any"}}}}}catch{}const yNe={csv:fke,topojson:Zke,osm:Gke,gpx:hI,kml:hI,tcx:hI},vNe=["fill","line","circle"];function EM(t){const[e,r]=ee.useState({type:"circle"}),[n,i]=ee.useState(),[a,s]=ee.useState(),[o,u]=ee.useState({}),h=ha({mapId:t.mapId}),f="?"+new URLSearchParams(o).toString();VS({protocol:t.originType,handler:yNe[t.originType]});const g=ee.useMemo(()=>e?.type?!!(a&&n):!1,[e,a,n]);ee.useEffect(()=>(typeof n<"u"&&typeof a<"u"&&(h.map?.getSource(n)||h.map?.addSource(n,{type:"geojson",data:o?t.originType+"://"+a+f:t.originType+"://"+a}),e.options={source:n}),()=>{}),[n,h.map,a]),ee.useEffect(()=>{a&&n&&h.map?.getLayer(n)&&URL.revokeObjectURL(a)},[n,a,h.map]);function b(v){const S={...o,...v};return u(S)}return K.jsxs(K.Fragment,{children:[K.jsxs(Bm,{children:["Layer from ",t.originType]}),K.jsxs(Zc,{fullWidth:!0,children:[K.jsx($p,{id:"type-label",children:"Type"}),K.jsx(qp,{labelId:"type-label",value:e.type,label:"Type",onChange:v=>r(S=>({...S,type:v.target.value})),children:vNe.map(v=>K.jsx(im,{value:v,children:v},v))})]}),K.jsxs(Zc,{fullWidth:!0,children:[K.jsxs(Ji,{variant:"contained",component:"label",sx:{marginTop:"10px"},children:["Select origin file",K.jsx("input",{type:"file",hidden:!0,accept:t.originType,onChange:v=>{if(i(v.target.files?.[0].name),v.target.files?.[0]){const S=URL.createObjectURL(v.target.files?.[0]);s(S)}}})]}),t.originType==="csv"&&K.jsx(wM,{setter:b}),t.originType==="osm"&&K.jsx(SM,{setter:b})]}),K.jsxs(Wb,{children:[K.jsx(Ji,{onClick:t.onCancel,children:"Cancel"}),K.jsx(Ji,{disabled:!g,onClick:()=>t.onSubmit(e),children:"Add"})]})]})}try{EM.displayName="ProtocolHandlerLayerForm",EM.__docgenInfo={description:"",displayName:"ProtocolHandlerLayerForm",props:{originType:{defaultValue:null,description:"",name:"originType",required:!0,type:{name:"string"}},config:{defaultValue:null,description:"",name:"config",required:!1,type:{name:"MlGeoJsonLayerProps | undefined"}},mapId:{defaultValue:null,description:"",name:"mapId",required:!1,type:{name:"string | undefined"}},onSubmit:{defaultValue:null,description:"",name:"onSubmit",required:!0,type:{name:"(config: MlGeoJsonLayerProps) => void"}},onCancel:{defaultValue:null,description:"",name:"onCancel",required:!0,type:{name:"() => void"}}}}}catch{}const _Ne=["id","type","metadata","source","source-layer","layout","paint","options"];function TM(t){const[e,r]=ee.useState([]),n={},i=["paint","layout","options","metadata"];ee.useEffect(()=>{t.setter(e)},[e]);const a=()=>K.jsx(K.Fragment,{children:_Ne.map(o=>K.jsx(ht.Fragment,{children:K.jsx(nT,{label:o,onChange:u=>n[o]=u.target.value})},o+"_fragment"))});function s(){i.map(o=>{if(typeof n[o]<"u")try{n[o]=JSON.parse(n[o])}catch{alert("Invalid JSON format, try again")}}),r(o=>o.length>0?[n,...o]:[n])}return K.jsxs(K.Fragment,{children:[K.jsx(Zc,{fullWidth:!0,children:K.jsx(a,{})}),K.jsx(Ji,{onClick:s,children:" Add"})]})}try{TM.displayName="MbtilesLayerPropFormular",TM.__docgenInfo={description:"",displayName:"MbtilesLayerPropFormular",props:{setter:{defaultValue:null,description:"",name:"setter",required:!0,type:{name:"Dispatch<SetStateAction<LayerSpecification[]>>"}}}}}catch{}const bNe=Hi(K.jsx("path",{d:"M7.41 8.59 12 13.17l4.59-4.58L18 10l-6 6-6-6z"})),xNe=Hi(K.jsx("path",{d:"M7.41 15.41 12 10.83l4.59 4.58L18 14l-6-6-6 6z"}));function CM(t){const[e,r]=ht.useState(t.config),[n,i]=ee.useState(),[a,s]=ee.useState(),[o,u]=ee.useState([]),h=ha({mapId:t.mapId}),[f,g]=ee.useState(!1);console.log(o);const b=()=>K.jsx(K.Fragment,{children:o.map((S,E)=>K.jsxs(vs,{variant:"body2",children:[E+1,": ",JSON.stringify(S)]},E))}),v=ee.useMemo(()=>!!n,[n]);return ee.useEffect(()=>{typeof n<"u"&&typeof a<"u"&&r({url:"mbtiles://"+a+"/{z}/{x}/{y}",layers:o,layerId:n,sourceOptions:{type:"vector",minzoom:0,maxzoom:1}})},[n,h.map,a,o]),K.jsxs(K.Fragment,{children:[K.jsx(Bm,{children:" Layer from mbtiles file"}),K.jsxs(QR,{children:[K.jsxs(Ji,{variant:"contained",component:"label",sx:{marginTop:"10px"},children:["Select origin file",K.jsx("input",{type:"file",hidden:!0,accept:t.originType,onChange:S=>{if(i(S.target.files?.[0].name),S.target.files?.[0]){const E=URL.createObjectURL(S.target.files?.[0]);s(E)}}})]}),K.jsxs(Vle,{expanded:f,children:[K.jsxs(lue,{"aria-controls":"panel1d-content",id:"panel1d-header",children:[K.jsx(vs,{children:"MB-Tile Layer properties"}),K.jsx(Ji,{onClick:()=>g(!f),children:f?K.jsx(xNe,{}):K.jsx(bNe,{})})]}),K.jsx(vs,{variant:"body1",children:" Layers"}),o.length>0?K.jsx(b,{}):K.jsx(vs,{variant:"body2",children:" 0 "}),K.jsx(TM,{setter:u})]})]}),K.jsxs(Wb,{children:[K.jsx(Ji,{onClick:t.onCancel,children:"Cancel"}),K.jsx(Ji,{disabled:!v,onClick:()=>t.onSubmit(e),children:"Add"})]})]})}try{CM.displayName="MbtilesLayerForm",CM.__docgenInfo={description:"",displayName:"MbtilesLayerForm",props:{originType:{defaultValue:null,description:"",name:"originType",required:!0,type:{name:"string"}},config:{defaultValue:null,description:"",name:"config",required:!0,type:{name:"MlVectorTileLayerProps"}},mapId:{defaultValue:null,description:"",name:"mapId",required:!1,type:{name:"string | undefined"}},onSubmit:{defaultValue:null,description:"",name:"onSubmit",required:!0,type:{name:"(config: MlVectorTileLayerProps) => void"}},onCancel:{defaultValue:null,description:"",name:"onCancel",required:!0,type:{name:"() => void"}}}}}catch{}const JS=t=>{const[e,r]=ee.useState(t?.config),[n,i]=ee.useState(),a=t.layerTypes,s=a.filter(g=>g!=="wms"&&g!=="geojson"&&g!=="mbtiles"),o=["wms","geojson","vt","csv","mbtiles","topojson","osm","gpx","kml","tcx"],u=g=>{i(g),s.includes(g)?r({type:"geojson",config:{}}):r(g==="mbtiles"?{type:"vt",config:{layers:[]}}:{type:g,config:{}})},h=()=>{t.setOpen(!1),r(void 0)},f=()=>K.jsx(K.Fragment,{children:s.map((g,b)=>K.jsx(K.Fragment,{children:e?.type==="geojson"&&n===g&&K.jsx(EM,{originType:g,onSubmit:v=>{t?.onComplete?.({...e,config:v,type:"geojson"}),h()},onCancel:h},b)}))});return K.jsxs(JR,{open:t.open,onClose:h,children:[!e?.type&&K.jsx(KS,{onSelect:g=>{o.includes(g)&&u(g)},layerTypes:a}),e?.type==="geojson"&&n==="geojson"&&K.jsx(bM,{onSubmit:g=>{t?.onComplete?.({...e,config:g}),h()},onCancel:h}),e?.type==="wms"&&K.jsx(xM,{onSubmit:g=>{t?.onComplete?.({...e,config:g}),h()},onCancel:h}),e?.type==="vt"&&n!==void 0&&K.jsx(CM,{config:e,originType:n,onSubmit:g=>{e&&(t?.onComplete?.({...e,config:g}),h())},onCancel:h}),K.jsx(f,{},"protocol")]})};JS.defaultProps={};try{JS.displayName="AddLayerPopup",JS.__docgenInfo={description:"",displayName:"AddLayerPopup",props:{open:{defaultValue:null,description:"",name:"open",required:!0,type:{name:"boolean"}},config:{defaultValue:null,description:"",name:"config",required:!1,type:{name:"LayerConfig | undefined"}},layerTypes:{defaultValue:null,description:"",name:"layerTypes",required:!0,type:{name:"string[]"}},setOpen:{defaultValue:null,description:"",name:"setOpen",required:!0,type:{name:"(open: boolean) => void"}},onChange:{defaultValue:null,description:"",name:"onChange",required:!1,type:{name:"((config: LayerConfig) => void) | undefined"}},onComplete:{defaultValue:null,description:"",name:"onComplete",required:!1,type:{name:"((config: LayerConfig) => void) | undefined"}}}}}catch{}const AM=t=>{const[e,r]=ht.useState(!1),n=t.layerTypes||["geojson","wms","csv","topojson","osm","gpx","kml","tcx"];return K.jsxs(K.Fragment,{children:[K.jsx(Ji,{variant:"contained",sx:{marginTop:"10px",...t.sx},onClick:()=>r(!0),children:K.jsx(fNe,{})}),K.jsx(JS,{open:e,setOpen:r,onComplete:t?.onComplete,layerTypes:n})]})};AM.defaultProps={};try{AM.displayName="AddLayerButton",AM.__docgenInfo={description:"",displayName:"AddLayerButton",props:{sx:{defaultValue:null,description:"",name:"sx",required:!1,type:{name:"SxProps | undefined"}},layerTypes:{defaultValue:null,description:`An string array, to filter the supported file types that would be shown to the user
Default is: ['geojson', 'wms', 'csv', 'topojson', 'osm', 'gpx', 'kml', 'tcx']`,name:"layerTypes",required:!1,type:{name:"string[] | undefined"}},onComplete:{defaultValue:null,description:"",name:"onComplete",required:!1,type:{name:"((config: LayerConfig) => void) | undefined"}}}}}catch{}const wNe=Hi(K.jsx("path",{d:"M3 18h18v-2H3zm0-5h18v-2H3zm0-7v2h18V6z"})),mN="https://mapcomponents.github.io/react-map-components-maplibre/react-maplibre/",SNe=mN+"assets/WG-MapComponents-Logo_rgb.svg",ENe=mN+"assets/WG-MapComponents-Logo_rgb-weisse-schrift.svg",TNe=mN+"assets/mapcomponents_logo.png";function E$(t){const e=Tc(),[r,n]=ee.useState(null),i=s=>{n(s.currentTarget)},a=()=>{n(null)};return K.jsx(kue,{sx:{minHeight:"62px",position:"absolute",zIndex:1300,top:0},children:K.jsxs(kge,{disableGutters:!0,children:[t.logo||K.jsxs(K.Fragment,{children:[K.jsx(Vo,{sx:{marginLeft:"25px",display:{xs:"none",md:"flex"},flexGrow:{md:"30"}},children:K.jsx("img",{src:e.palette.mode==="dark"?ENe:SNe,style:{width:"100%",maxWidth:"250px"}})}),K.jsx(Vo,{sx:{marginLeft:"25px",display:{xs:"flex",sm:"flex",md:"none"},flexGrow:{xs:"500"},mr:{sm:"0px"}},children:K.jsx("img",{src:TNe,width:"50px",height:"50px"})})]}),K.jsx(Vo,{sx:{flexGrow:1,display:{xs:"flex"}},children:t.unmovableButtons}),t.buttons?K.jsxs(Vo,{sx:{flexGrow:22,display:{xs:"flex",sm:"none"}},children:[K.jsx(eh,{onClick:i,children:K.jsx(wNe,{})}),K.jsx(kG,{id:"menu-appbar",anchorEl:r,anchorOrigin:{vertical:"bottom",horizontal:"left"},keepMounted:!0,transformOrigin:{vertical:"top",horizontal:"left"},open:!!r,onClose:a,PaperProps:{elevation:24,sx:{overflow:"visible",mt:"15px"}},sx:{display:{xs:"block",sm:"none"}},children:K.jsx(Vo,{sx:{paddingLeft:"10px",paddingRight:"10px"},onClick:a,children:t.buttons})})]}):"",K.jsx(Vo,{sx:{marginRight:"25px",display:{xs:"none",sm:"flex"}},children:t.buttons})]})})}try{E$.displayName="TopToolbar",E$.__docgenInfo={description:"",displayName:"TopToolbar",props:{unmovableButtons:{defaultValue:null,description:"",name:"unmovableButtons",required:!1,type:{name:"ReactNode"}},buttons:{defaultValue:null,description:"",name:"buttons",required:!1,type:{name:"ReactNode"}},logo:{defaultValue:null,description:"",name:"logo",required:!1,type:{name:"ReactNode"}}}}}catch{}const CNe=Hi(K.jsx("path",{d:"M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12zm-1 4 6 6v10c0 1.1-.9 2-2 2H7.99C6.89 23 6 22.1 6 21l.01-14c0-1.1.89-2 1.99-2zm-1 7h5.5L14 6.5z"}));function T$(t){const e=ee.useRef(null),r=()=>{if(!e.current)return!1;const i=e.current?.files?.[0];if(!i)return!1;const a=new FileReader;a.onload=s=>{s&&typeof t.setData=="function"&&t.setData(s.currentTarget?.result)},a.readAsText(i)},n=()=>{e.current&&e.current.click()};return K.jsxs(K.Fragment,{children:[t.buttonComponent?ht.cloneElement(t.buttonComponent,{onClick:n}):K.jsx(Ji,{onClick:n,children:K.jsx(CNe,{})}),K.jsx("input",{ref:e,onChange:r,type:"file",accept:t.accept,id:"input",multiple:!0,style:{display:"none"}})]})}try{T$.displayName="UploadButton",T$.__docgenInfo={description:"",displayName:"UploadButton",props:{setData:{defaultValue:null,description:"",name:"setData",required:!0,type:{name:"(data: string) => void"}},buttonComponent:{defaultValue:null,description:"",name:"buttonComponent",required:!0,type:{name:"any"}},accept:{defaultValue:null,description:"",name:"accept",required:!1,type:{name:"string | undefined"}}}}}catch{}const QS=t=>{const e=()=>{t.setOpen(!1)};return K.jsxs(JR,{open:t.open,onClose:e,PaperProps:{sx:{padding:"20px"}},children:[K.jsx(Bm,{children:"Select a style"}),K.jsx(ff,{children:t?.styles?.map(r=>K.jsx(Ih,{disableGutters:!0,children:K.jsxs(TG,{autoFocus:!0,onClick:()=>{t?.onSelect?.(r)},children:[K.jsx(AG,{children:K.jsx(dG,{sx:{width:"50px",height:"50px"},alt:r.name,src:r?.name&&t?.styleThumbnailPaths?.[r.name]})}),K.jsx(yh,{primary:r.name})]})},r.name))})]})};QS.defaultProps={styleThumbnailPaths:{}};try{QS.displayName="SelectStylePopup",QS.__docgenInfo={description:"",displayName:"SelectStylePopup",props:{open:{defaultValue:null,description:"",name:"open",required:!0,type:{name:"boolean"}},setOpen:{defaultValue:null,description:"",name:"setOpen",required:!0,type:{name:"(open: boolean) => void"}},styles:{defaultValue:null,description:"",name:"styles",required:!1,type:{name:"StyleSpecification[] | undefined"}},onSelect:{defaultValue:null,description:"",name:"onSelect",required:!1,type:{name:"((style: StyleSpecification) => void) | undefined"}},styleThumbnailPaths:{defaultValue:{value:"{}"},description:"",name:"styleThumbnailPaths",required:!1,type:{name:"{ [key: string]: string; } | undefined"}}}}}catch{}const ANe=Hi(K.jsx("path",{d:"M4 4h7V2H4c-1.1 0-2 .9-2 2v7h2zm6 9-4 5h12l-3-4-2.03 2.71zm7-4.5c0-.83-.67-1.5-1.5-1.5S14 7.67 14 8.5s.67 1.5 1.5 1.5S17 9.33 17 8.5M20 2h-7v2h7v7h2V4c0-1.1-.9-2-2-2m0 18h-7v2h7c1.1 0 2-.9 2-2v-7h-2zM4 13H2v7c0 1.1.9 2 2 2h7v-2H4z"})),INe={version:8,name:"Monokai",center:[8.542,47.372],zoom:11.6,bearing:0,pitch:0,sources:{openmaptiles:{type:"vector",url:$u.source_openmaptiles_url}},sprite:$u.sprite,glyphs:$u.glyphs,layers:[{id:"background",type:"background",paint:{"background-color":"#282822"}},{id:"landcover-glacier",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landcover",filter:["==","subclass","glacier"],layout:{visibility:"visible"},paint:{"fill-color":"#AE81FF","fill-opacity":{base:1,stops:[[0,.9],[10,.3]]}}},{id:"landuse-residential",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landuse",filter:["==","class","residential"],paint:{"fill-color":"#75715E"}},{id:"landuse-commercial",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landuse",filter:["all",["==","$type","Polygon"],["==","class","commercial"]],paint:{"fill-color":"#837f6e"}},{id:"landuse-industrial",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landuse",filter:["all",["==","$type","Polygon"],["==","class","industrial"]],paint:{"fill-color":"#918d7e"}},{id:"park",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"park",filter:["==","$type","Polygon"],paint:{"fill-color":"#A6C22E","fill-opacity":{base:1.8,stops:[[9,.5],[12,.2]]}}},{id:"park-outline",type:"line",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"park",filter:["==","$type","Polygon"],layout:{},paint:{"line-color":"rgba(166,194,46,0.6)","line-dasharray":[3,3]}},{id:"landuse-cemetery",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landuse",filter:["==","class","cemetery"],paint:{"fill-color":"#e0ebad"}},{id:"landuse-hospital",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landuse",filter:["==","class","hospital"],paint:{"fill-color":"#FD971F"}},{id:"landuse-school",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landuse",filter:["==","class","school"],paint:{"fill-color":"rgba(253,151,31,0.8)"}},{id:"landuse-railway",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landuse",filter:["==","class","railway"],paint:{"fill-color":"rgba(18,5,68,0.4)"}},{id:"landcover-wood",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landcover",filter:["==","class","wood"],paint:{"fill-color":"#A6E22E","fill-opacity":.1,"fill-outline-color":"hsla(0, 0%, 0%, 0.03)","fill-antialias":{base:1,stops:[[0,!1],[9,!0]]}}},{id:"landcover-grass",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landcover",filter:["==","class","grass"],paint:{"fill-color":"#A6C22E","fill-opacity":1}},{id:"landcover-grass-park",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"park",filter:["==","class","public_park"],paint:{"fill-color":"#A6C22E","fill-opacity":.8}},{id:"waterway-other",type:"line",metadata:{"mapbox:group":"1444849382550.77"},source:"openmaptiles","source-layer":"waterway",filter:["!in","class","canal","river","stream"],layout:{"line-cap":"round"},paint:{"line-color":"#66D9EF","line-width":{base:1.3,stops:[[13,.5],[20,2]]}}},{id:"waterway-stream-canal",type:"line",metadata:{"mapbox:group":"1444849382550.77"},source:"openmaptiles","source-layer":"waterway",filter:["in","class","canal","stream"],layout:{"line-cap":"round"},paint:{"line-color":"#66D9EF","line-width":{base:1.3,stops:[[13,.5],[20,6]]}}},{id:"waterway-river",type:"line",metadata:{"mapbox:group":"1444849382550.77"},source:"openmaptiles","source-layer":"waterway",filter:["==","class","river"],layout:{"line-cap":"round"},paint:{"line-color":"#66D9EF","line-width":{base:1.2,stops:[[10,.8],[20,6]]}}},{id:"water-offset",type:"fill",metadata:{"mapbox:group":"1444849382550.77"},source:"openmaptiles","source-layer":"water",maxzoom:8,filter:["==","$type","Polygon"],layout:{visibility:"visible"},paint:{"fill-opacity":1,"fill-color":"#66D9EF","fill-translate":{base:1,stops:[[6,[2,0]],[8,[0,0]]]}}},{id:"water",type:"fill",metadata:{"mapbox:group":"1444849382550.77"},source:"openmaptiles","source-layer":"water",layout:{visibility:"visible"},paint:{"fill-color":"#21c8e8"}},{id:"water-pattern",type:"fill",metadata:{"mapbox:group":"1444849382550.77"},source:"openmaptiles","source-layer":"water",layout:{visibility:"visible"},paint:{"fill-translate":[0,2.5],"fill-pattern":"wave"}},{id:"landcover-ice-shelf",type:"fill",metadata:{"mapbox:group":"1444849382550.77"},source:"openmaptiles","source-layer":"landcover",filter:["==","subclass","ice_shelf"],layout:{visibility:"visible"},paint:{"fill-color":"#AE81FF","fill-opacity":{base:1,stops:[[0,.9],[10,.3]]}}},{id:"building",type:"fill",metadata:{"mapbox:group":"1444849364238.8171"},source:"openmaptiles","source-layer":"building",paint:{"fill-color":"#E6DB74","fill-antialias":!0}},{id:"building-top",type:"fill",metadata:{"mapbox:group":"1444849364238.8171"},source:"openmaptiles","source-layer":"building",layout:{visibility:"visible"},paint:{"fill-translate":{base:1,stops:[[14,[0,0]],[16,[-2,-2]]]},"fill-outline-color":"#dfdbd7","fill-color":"#eee69f","fill-opacity":{base:1,stops:[[13,0],[16,1]]}}},{id:"tunnel-service-track-casing",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["in","class","service","track"]],layout:{"line-join":"round"},paint:{"line-color":"#F92672","line-dasharray":[.5,.25],"line-width":{base:1.2,stops:[[15,1],[16,4],[20,11]]}}},{id:"tunnel-minor-casing",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["==","class","minor"]],layout:{"line-join":"round"},paint:{"line-color":"#F92672","line-opacity":{stops:[[12,0],[12.5,1]]},"line-width":{base:1.2,stops:[[12,.5],[13,1],[14,4],[20,15]]}}},{id:"tunnel-secondary-tertiary-casing",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["in","class","secondary","tertiary"]],layout:{"line-join":"round"},paint:{"line-color":"#F92672","line-opacity":1,"line-width":{base:1.2,stops:[[8,1.5],[20,17]]}}},{id:"tunnel-trunk-primary-casing",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["in","class","primary","trunk"]],layout:{"line-join":"round"},paint:{"line-color":"#F92672","line-width":{base:1.2,stops:[[5,.4],[6,.6],[7,1.5],[20,22]]}}},{id:"tunnel-motorway-casing",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["==","class","motorway"]],layout:{"line-join":"round",visibility:"visible"},paint:{"line-color":"#F92672","line-dasharray":[.5,.25],"line-width":{base:1.2,stops:[[5,.4],[6,.6],[7,1.5],[20,22]]}}},{id:"tunnel-path",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["==","brunnel","tunnel"],["==","class","path"]]],paint:{"line-color":"#fa5892","line-dasharray":[1.5,.75],"line-width":{base:1.2,stops:[[15,1.2],[20,4]]}}},{id:"tunnel-service-track",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["in","class","service","track"]],layout:{"line-join":"round"},paint:{"line-color":"#fa5892","line-width":{base:1.2,stops:[[15.5,0],[16,2],[20,7.5]]}}},{id:"tunnel-minor",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["==","class","minor_road"]],layout:{"line-join":"round"},paint:{"line-color":"#fa5892","line-opacity":1,"line-width":{base:1.2,stops:[[13.5,0],[14,2.5],[20,11.5]]}}},{id:"tunnel-secondary-tertiary",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["in","class","secondary","tertiary"]],layout:{"line-join":"round"},paint:{"line-color":"#fb70a2","line-width":{base:1.2,stops:[[6.5,0],[7,.5],[20,10]]}}},{id:"tunnel-trunk-primary",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["in","class","primary","trunk"]],layout:{"line-join":"round"},paint:{"line-color":"#F92672","line-width":{base:1.2,stops:[[6.5,0],[7,.5],[20,18]]}}},{id:"tunnel-motorway",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["==","class","motorway"]],layout:{"line-join":"round",visibility:"visible"},paint:{"line-color":"rgba(249,38,114,0.8)","line-width":{base:1.2,stops:[[6.5,0],[7,.5],[20,18]]}}},{id:"tunnel-railway",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["==","class","rail"]],paint:{"line-color":"#b40544","line-width":{base:1.4,stops:[[14,.4],[15,.75],[20,2]]},"line-dasharray":[2,2]}},{id:"aeroway-taxiway-casing",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"aeroway",minzoom:12,filter:["all",["in","class","taxiway"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#b40544","line-width":{base:1.5,stops:[[11,2],[17,12]]},"line-opacity":1}},{id:"aeroway-runway-casing",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"aeroway",minzoom:12,filter:["all",["in","class","runway"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#b40544","line-width":{base:1.5,stops:[[11,5],[17,55]]},"line-opacity":1}},{id:"aeroway-area",type:"fill",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"aeroway",minzoom:4,filter:["all",["==","$type","Polygon"],["in","class","runway","taxiway"]],layout:{visibility:"visible"},paint:{"fill-opacity":{base:1,stops:[[13,0],[14,1]]},"fill-color":"rgba(249,38,114,0.5)"}},{id:"aeroway-taxiway",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"aeroway",minzoom:4,filter:["all",["in","class","taxiway"],["==","$type","LineString"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#fb70a2","line-width":{base:1.5,stops:[[11,1],[17,10]]},"line-opacity":{base:1,stops:[[11,0],[12,1]]}}},{id:"aeroway-runway",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"aeroway",minzoom:4,filter:["all",["in","class","runway"],["==","$type","LineString"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#fb70a2","line-width":{base:1.5,stops:[[11,4],[17,50]]},"line-opacity":{base:1,stops:[[11,0],[12,1]]}}},{id:"highway-area",type:"fill",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["==","$type","Polygon"],layout:{visibility:"visible"},paint:{"fill-color":"#e60657","fill-outline-color":"#cfcdca","fill-opacity":.9,"fill-antialias":!1}},{id:"highway-motorway-link-casing",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",minzoom:12,filter:["all",["!in","brunnel","bridge","tunnel"],["==","class","motorway_link"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#F92672","line-opacity":1,"line-width":{base:1.2,stops:[[12,1],[13,3],[14,4],[20,15]]}}},{id:"highway-link-casing",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",minzoom:13,filter:["all",["!in","brunnel","bridge","tunnel"],["in","class","primary_link","secondary_link","tertiary_link","trunk_link"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#F92672","line-opacity":1,"line-width":{base:1.2,stops:[[12,1],[13,3],[14,4],[20,15]]}}},{id:"highway-minor-casing",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["!=","brunnel","tunnel"],["in","class","minor","service","track"]]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"rgba(249,38,114,0.8)","line-opacity":{stops:[[12,0],[12.5,1]]},"line-width":{base:1.2,stops:[[12,.5],[13,1],[14,4],[20,15]]}}},{id:"highway-secondary-tertiary-casing",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["!in","brunnel","bridge","tunnel"],["in","class","secondary","tertiary"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#F92672","line-opacity":1,"line-width":{base:1.2,stops:[[8,1.5],[20,17]]}}},{id:"highway-primary-casing",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",minzoom:5,filter:["all",["!in","brunnel","bridge","tunnel"],["in","class","primary"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#F92672","line-opacity":{stops:[[7,0],[8,1]]},"line-width":{base:1.2,stops:[[7,0],[8,.6],[9,1.5],[20,22]]}}},{id:"highway-trunk-casing",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",minzoom:5,filter:["all",["!in","brunnel","bridge","tunnel"],["in","class","trunk"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#F92672","line-opacity":{stops:[[5,0],[6,1]]},"line-width":{base:1.2,stops:[[5,0],[6,.6],[7,1.5],[20,22]]}}},{id:"highway-motorway-casing",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",minzoom:4,filter:["all",["!in","brunnel","bridge","tunnel"],["==","class","motorway"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#F92672","line-width":{base:1.2,stops:[[4,0],[5,.4],[6,.6],[7,1.5],[20,22]]},"line-opacity":{stops:[[4,0],[5,1]]}}},{id:"highway-path",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["!in","brunnel","bridge","tunnel"],["==","class","path"]]],paint:{"line-color":"#F8F8F2","line-dasharray":[1.5,.75],"line-width":{base:1.2,stops:[[15,1.2],[20,4]]}}},{id:"highway-motorway-link",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",minzoom:12,filter:["all",["!in","brunnel","bridge","tunnel"],["==","class","motorway_link"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#f92672","line-width":{base:1.2,stops:[[12.5,0],[13,1.5],[14,2.5],[20,11.5]]}}},{id:"highway-link",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",minzoom:13,filter:["all",["!in","brunnel","bridge","tunnel"],["in","class","primary_link","secondary_link","tertiary_link","trunk_link"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#F92672","line-width":{base:1.2,stops:[[12.5,0],[13,1.5],[14,2.5],[20,11.5]]}}},{id:"highway-minor",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["!=","brunnel","tunnel"],["in","class","minor","service","track"]]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#fc89b2","line-opacity":1,"line-width":{base:1.2,stops:[[13.5,0],[14,2.5],[20,11.5]]}}},{id:"highway-secondary-tertiary",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["!in","brunnel","bridge","tunnel"],["in","class","secondary","tertiary"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#F92672","line-width":{base:1.2,stops:[[6.5,0],[8,.5],[20,13]]}}},{id:"highway-primary",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["!in","brunnel","bridge","tunnel"],["in","class","primary"]]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#F92672","line-width":{base:1.2,stops:[[8.5,0],[9,.5],[20,18]]}}},{id:"highway-trunk",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["!in","brunnel","bridge","tunnel"],["in","class","trunk"]]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#F92672","line-width":{base:1.2,stops:[[6.5,0],[7,.5],[20,18]]}}},{id:"highway-motorway",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",minzoom:5,filter:["all",["==","$type","LineString"],["all",["!in","brunnel","bridge","tunnel"],["==","class","motorway"]]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#f92672","line-width":{base:1.2,stops:[[6.5,0],[7,.5],[20,18]]}}},{id:"railway-service",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["==","class","rail"],["has","service"]]],paint:{"line-color":"rgba(18,5,68,0.7)","line-width":{base:1.4,stops:[[14,.4],[20,1]]}}},{id:"railway-service-hatching",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["==","class","rail"],["has","service"]]],layout:{visibility:"visible"},paint:{"line-color":"rgba(18,5,68,0.7)","line-dasharray":[.2,8],"line-width":{base:1.4,stops:[[14.5,0],[15,2],[20,6]]}}},{id:"railway",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["!has","service"],["!in","brunnel","bridge","tunnel"],["==","class","rail"]]],paint:{"line-color":"#b40544","line-width":{base:1.4,stops:[[14,.4],[15,.75],[20,2]]}}},{id:"railway-hatching",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["!has","service"],["!in","brunnel","bridge","tunnel"],["==","class","rail"]]],paint:{"line-color":"#b40544","line-dasharray":[.2,8],"line-width":{base:1.4,stops:[[14.5,0],[15,3],[20,8]]}}},{id:"bridge-motorway-link-casing",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["==","class","motorway_link"]],layout:{"line-join":"round"},paint:{"line-color":"#F92672","line-opacity":1,"line-width":{base:1.2,stops:[[12,1],[13,3],[14,4],[20,15]]}}},{id:"bridge-link-casing",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["in","class","primary_link","secondary_link","tertiary_link","trunk_link"]],layout:{"line-join":"round"},paint:{"line-color":"#F92672","line-opacity":1,"line-width":{base:1.2,stops:[[12,1],[13,3],[14,4],[20,15]]}}},{id:"bridge-secondary-tertiary-casing",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["in","class","secondary","tertiary"]],layout:{"line-join":"round"},paint:{"line-color":"#F92672","line-opacity":1,"line-width":{base:1.2,stops:[[8,1.5],[20,28]]}}},{id:"bridge-trunk-primary-casing",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["in","class","primary","trunk"]],layout:{"line-join":"round"},paint:{"line-color":"#F92672","line-width":{base:1.2,stops:[[5,.4],[6,.6],[7,1.5],[20,26]]}}},{id:"bridge-motorway-casing",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["==","class","motorway"]],layout:{"line-join":"round"},paint:{"line-color":"#F92672","line-width":{base:1.2,stops:[[5,.4],[6,.6],[7,1.5],[20,22]]}}},{id:"bridge-path-casing",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["==","brunnel","bridge"],["==","class","path"]]],paint:{"line-color":"#fa5892","line-width":{base:1.2,stops:[[15,1.2],[20,18]]}}},{id:"bridge-path",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["==","brunnel","bridge"],["==","class","path"]]],paint:{"line-color":"#F8F8F2","line-width":{base:1.2,stops:[[15,1.2],[20,4]]},"line-dasharray":[1.5,.75]}},{id:"bridge-motorway-link",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["==","class","motorway_link"]],layout:{"line-join":"round"},paint:{"line-color":"#f92672","line-width":{base:1.2,stops:[[12.5,0],[13,1.5],[14,2.5],[20,11.5]]}}},{id:"bridge-link",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["in","class","primary_link","secondary_link","tertiary_link","trunk_link"]],layout:{"line-join":"round"},paint:{"line-color":"#F92672","line-width":{base:1.2,stops:[[12.5,0],[13,1.5],[14,2.5],[20,11.5]]}}},{id:"bridge-secondary-tertiary",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["in","class","secondary","tertiary"]],layout:{"line-join":"round"},paint:{"line-color":"#F92672","line-width":{base:1.2,stops:[[6.5,0],[7,.5],[20,20]]}}},{id:"bridge-trunk-primary",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["in","class","primary","trunk"]],layout:{"line-join":"round"},paint:{"line-color":"#F92672","line-width":{base:1.2,stops:[[6.5,0],[7,.5],[20,18]]}}},{id:"bridge-motorway",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["==","class","motorway"]],layout:{"line-join":"round"},paint:{"line-color":"#f92672","line-width":{base:1.2,stops:[[6.5,0],[7,.5],[20,18]]}}},{id:"bridge-railway",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["==","class","rail"]],paint:{"line-color":"#b40544","line-width":{base:1.4,stops:[[14,.4],[15,.75],[20,2]]}}},{id:"bridge-railway-hatching",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["==","class","rail"]],paint:{"line-color":"#b40544","line-dasharray":[.2,8],"line-width":{base:1.4,stops:[[14.5,0],[15,3],[20,8]]}}},{id:"boundary-land-level-4",type:"line",source:"openmaptiles","source-layer":"boundary",filter:["all",["in","admin_level",4,6,8],["!=","maritime",1]],layout:{"line-join":"round"},paint:{"line-color":"#E69F66","line-dasharray":[3,1,1,1],"line-width":{base:1.4,stops:[[4,.4],[5,1],[12,3]]}}},{id:"boundary-land-level-2",type:"line",source:"openmaptiles","source-layer":"boundary",filter:["all",["==","admin_level",2],["!=","maritime",1]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#E69F66","line-width":{base:1,stops:[[0,.6],[4,1.4],[5,2],[12,8]]}}},{id:"boundary-water",type:"line",source:"openmaptiles","source-layer":"boundary",filter:["all",["in","admin_level",2,4],["==","maritime",1]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#66D9EF","line-width":{base:1,stops:[[0,.6],[4,1.4],[5,2],[12,8]]},"line-opacity":{stops:[[6,.6],[10,1]]}}},{id:"waterway-name",type:"symbol",source:"openmaptiles","source-layer":"waterway",minzoom:13,filter:["all",["==","$type","LineString"],["has","name"],["!has","name:de"]],layout:{"text-font":["Open Sans Italic"],"text-size":14,"text-field":"{name:latin} {name:nonlatin}","text-max-width":5,"text-rotation-alignment":"map","symbol-placement":"line","text-letter-spacing":.2,"symbol-spacing":350},paint:{"text-color":"#fefefe","text-halo-width":1.5,"text-halo-color":"#74aee9"}},{id:"waterway-name-en",type:"symbol",source:"openmaptiles","source-layer":"waterway",minzoom:13,filter:["all",["==","$type","LineString"],["has","name"],["has","name:de"]],layout:{"text-font":["Open Sans Italic"],"text-size":14,"text-field":"{name:de} {name:nonlatin}","text-max-width":5,"text-rotation-alignment":"map","symbol-placement":"line","text-letter-spacing":.2,"symbol-spacing":350},paint:{"text-color":"#fefefe","text-halo-width":1.5,"text-halo-color":"#74aee9"}},{id:"water-name-lakeline",type:"symbol",source:"openmaptiles","source-layer":"water_name",filter:["all",["==","$type","LineString"],["!has","name:de"]],layout:{"text-font":["Open Sans Italic"],"text-size":14,"text-field":"{name:latin} {name:nonlatin}","text-max-width":5,"text-rotation-alignment":"map","symbol-placement":"line","symbol-spacing":350,"text-letter-spacing":.2},paint:{"text-color":"#fefefe","text-halo-width":1.5,"text-halo-color":"#74aee9"}},{id:"water-name-lakeline-en",type:"symbol",source:"openmaptiles","source-layer":"water_name",filter:["all",["==","$type","LineString"],["has","name:de"]],layout:{"text-font":["Open Sans Italic"],"text-size":14,"text-field":"{name:de} {name:nonlatin}","text-max-width":5,"text-rotation-alignment":"map","symbol-placement":"line","symbol-spacing":350,"text-letter-spacing":.2},paint:{"text-color":"#fefefe","text-halo-width":1.5,"text-halo-color":"#74aee9"}},{id:"water-name-ocean",type:"symbol",source:"openmaptiles","source-layer":"water_name",filter:["all",["==","$type","Point"],["==","class","ocean"],["!has","name:de"]],layout:{"text-font":["Open Sans Italic"],"text-size":14,"text-field":`{name:latin}
{name:nonlatin}`,"text-max-width":5,"text-rotation-alignment":"map","symbol-placement":"point","symbol-spacing":350,"text-letter-spacing":.2},paint:{"text-color":"#fefefe","text-halo-width":1.5,"text-halo-color":"#74aee9"}},{id:"water-name-ocean-en",type:"symbol",source:"openmaptiles","source-layer":"water_name",filter:["all",["==","$type","Point"],["==","class","ocean"],["has","name:de"]],layout:{"text-font":["Open Sans Italic"],"text-size":14,"text-field":`{name:de}
{name:nonlatin}`,"text-max-width":5,"text-rotation-alignment":"map","symbol-placement":"point","symbol-spacing":350,"text-letter-spacing":.2},paint:{"text-color":"#fefefe","text-halo-width":1.5,"text-halo-color":"#74aee9"}},{id:"water-name-other",type:"symbol",source:"openmaptiles","source-layer":"water_name",filter:["all",["==","$type","Point"],["!in","class","ocean"],["!has","name:de"]],layout:{"text-font":["Open Sans Italic"],"text-size":{stops:[[0,10],[6,14]]},"text-field":`{name:latin}
{name:nonlatin}`,"text-max-width":5,"text-rotation-alignment":"map","symbol-placement":"point","symbol-spacing":350,"text-letter-spacing":.2,visibility:"visible"},paint:{"text-color":"#fefefe","text-halo-width":1.5,"text-halo-color":"#74aee9"}},{id:"water-name-other-en",type:"symbol",source:"openmaptiles","source-layer":"water_name",filter:["all",["==","$type","Point"],["!in","class","ocean"],["has","name:de"]],layout:{"text-font":["Open Sans Italic"],"text-size":{stops:[[0,10],[6,14]]},"text-field":`{name:de}
{name:nonlatin}`,"text-max-width":5,"text-rotation-alignment":"map","symbol-placement":"point","symbol-spacing":350,"text-letter-spacing":.2,visibility:"visible"},paint:{"text-color":"#fefefe","text-halo-width":1.5,"text-halo-color":"#74aee9"}},{id:"poi-level-3",type:"symbol",source:"openmaptiles","source-layer":"poi",minzoom:16,filter:["all",["==","$type","Point"],[">=","rank",25],["!has","name:de"]],layout:{"text-padding":2,"text-font":["Open Sans Semibold"],"text-anchor":"top","icon-image":"{class}_11","text-field":`{name:latin}
{name:nonlatin}`,"text-offset":[0,.6],"text-size":12,"text-max-width":9},paint:{"text-halo-blur":.5,"text-color":"#fdfdfd","text-halo-width":1,"text-halo-color":"#633"}},{id:"poi-level-3-en",type:"symbol",source:"openmaptiles","source-layer":"poi",minzoom:16,filter:["all",["==","$type","Point"],[">=","rank",25],["has","name:de"]],layout:{"text-padding":2,"text-font":["Open Sans Semibold"],"text-anchor":"top","icon-image":"{class}_11","text-field":`{name:de}
{name:nonlatin}`,"text-offset":[0,.6],"text-size":12,"text-max-width":9},paint:{"text-halo-blur":.5,"text-color":"#fdfdfd","text-halo-width":1,"text-halo-color":"#633"}},{id:"poi-level-2",type:"symbol",source:"openmaptiles","source-layer":"poi",minzoom:15,filter:["all",["==","$type","Point"],["all",["<=","rank",24],[">=","rank",15]],["!has","name:de"]],layout:{"text-padding":2,"text-font":["Open Sans Semibold"],"text-anchor":"top","icon-image":"{class}_11","text-field":`{name:latin}
{name:nonlatin}`,"text-offset":[0,.6],"text-size":12,"text-max-width":9},paint:{"text-halo-blur":.5,"text-color":"#fdfdfd","text-halo-width":1,"text-halo-color":"#633"}},{id:"poi-level-2-en",type:"symbol",source:"openmaptiles","source-layer":"poi",minzoom:15,filter:["all",["==","$type","Point"],["all",["<=","rank",24],[">=","rank",15]],["has","name:de"]],layout:{"text-padding":2,"text-font":["Open Sans Semibold"],"text-anchor":"top","icon-image":"{class}_11","text-field":`{name:de}
{name:nonlatin}`,"text-offset":[0,.6],"text-size":12,"text-max-width":9},paint:{"text-halo-blur":.5,"text-color":"#fdfdfd","text-halo-width":1,"text-halo-color":"#633"}},{id:"poi-level-1",type:"symbol",source:"openmaptiles","source-layer":"poi",minzoom:14,filter:["all",["==","$type","Point"],["all",["<=","rank",14],["has","name"]],["!has","name:de"]],layout:{"text-padding":2,"text-font":["Open Sans Semibold"],"text-anchor":"top","icon-image":"{class}_11","text-field":`{name:latin}
{name:nonlatin}`,"text-offset":[0,.6],"text-size":12,"text-max-width":9},paint:{"text-halo-blur":.5,"text-color":"#fdfdfd","text-halo-width":1,"text-halo-color":"#633"}},{id:"poi-level-1-en",type:"symbol",source:"openmaptiles","source-layer":"poi",minzoom:14,filter:["all",["==","$type","Point"],["all",["<=","rank",14],["has","name"]],["has","name:de"]],layout:{"text-padding":2,"text-font":["Open Sans Semibold"],"text-anchor":"top","icon-image":"{class}_11","text-field":`{name:de}
{name:nonlatin}`,"text-offset":[0,.6],"text-size":12,"text-max-width":9},paint:{"text-halo-blur":.5,"text-color":"#fdfdfd","text-halo-width":1,"text-halo-color":"#633"}},{id:"highway-name-path",type:"symbol",source:"openmaptiles","source-layer":"transportation_name",minzoom:15.5,filter:["all",["==","class","path"],["!has","name:de"]],layout:{"text-size":{base:1,stops:[[13,12],[14,13]]},"text-font":["Open Sans Regular"],"text-field":"{name:latin} {name:nonlatin}","symbol-placement":"line","text-rotation-alignment":"map"},paint:{"text-halo-color":"#f8f4f0","text-color":"hsl(30, 23%, 62%)","text-halo-width":.5}},{id:"highway-name-path-en",type:"symbol",source:"openmaptiles","source-layer":"transportation_name",minzoom:15.5,filter:["all",["==","class","path"],["has","name:de"]],layout:{"text-size":{base:1,stops:[[13,12],[14,13]]},"text-font":["Open Sans Regular"],"text-field":"{name:de} {name:nonlatin}","symbol-placement":"line","text-rotation-alignment":"map"},paint:{"text-halo-color":"#f8f4f0","text-color":"hsl(30, 23%, 62%)","text-halo-width":.5}},{id:"highway-name-minor",type:"symbol",source:"openmaptiles","source-layer":"transportation_name",minzoom:15,filter:["all",["==","$type","LineString"],["in","class","minor","service","track"],["!has","name:de"]],layout:{"text-size":{base:1,stops:[[13,12],[14,13]]},"text-font":["Open Sans Regular"],"text-field":"{name:latin} {name:nonlatin}","symbol-placement":"line","text-rotation-alignment":"map"},paint:{"text-halo-blur":.5,"text-color":"#765","text-halo-width":1}},{id:"highway-name-minor-en",type:"symbol",source:"openmaptiles","source-layer":"transportation_name",minzoom:15,filter:["all",["==","$type","LineString"],["in","class","minor","service","track"],["has","name:de"]],layout:{"text-size":{base:1,stops:[[13,12],[14,13]]},"text-font":["Open Sans Regular"],"text-field":"{name:de} {name:nonlatin}","symbol-placement":"line","text-rotation-alignment":"map"},paint:{"text-halo-blur":.5,"text-color":"#765","text-halo-width":1}},{id:"highway-name-major",type:"symbol",source:"openmaptiles","source-layer":"transportation_name",minzoom:12.2,filter:["all",["in","class","primary","secondary","tertiary","trunk"],["!has","name:de"]],layout:{"text-size":{base:1,stops:[[13,12],[14,13]]},"text-font":["Open Sans Regular"],"text-field":"{name:latin} {name:nonlatin}","symbol-placement":"line","text-rotation-alignment":"map"},paint:{"text-halo-blur":.5,"text-color":"#765","text-halo-width":1}},{id:"highway-name-major-en",type:"symbol",source:"openmaptiles","source-layer":"transportation_name",minzoom:12.2,filter:["all",["in","class","primary","secondary","tertiary","trunk"],["has","name:de"]],layout:{"text-size":{base:1,stops:[[13,12],[14,13]]},"text-font":["Open Sans Regular"],"text-field":"{name:de} {name:nonlatin}","symbol-placement":"line","text-rotation-alignment":"map"},paint:{"text-halo-blur":.5,"text-color":"#765","text-halo-width":1}},{id:"highway-shield",type:"symbol",source:"openmaptiles","source-layer":"transportation_name",minzoom:8,filter:["all",["<=","ref_length",6],["==","$type","LineString"],["!in","network","us-interstate","us-highway","us-state"]],layout:{"text-size":10,"icon-image":"road_{ref_length}","icon-rotation-alignment":"viewport","symbol-spacing":200,"text-font":["Open Sans Semibold"],"symbol-placement":{base:1,stops:[[10,"point"],[11,"line"]]},"text-rotation-alignment":"viewport","icon-size":1,"text-field":"{ref}"},paint:{}},{id:"highway-shield-us-interstate",type:"symbol",source:"openmaptiles","source-layer":"transportation_name",minzoom:7,filter:["all",["<=","ref_length",6],["==","$type","LineString"],["in","network","us-interstate"]],layout:{"text-size":10,"icon-image":"{network}_{ref_length}","icon-rotation-alignment":"viewport","symbol-spacing":200,"text-font":["Open Sans Semibold"],"symbol-placement":{base:1,stops:[[7,"point"],[7,"line"],[8,"line"]]},"text-rotation-alignment":"viewport","icon-size":1,"text-field":"{ref}"},paint:{"text-color":"rgba(0, 0, 0, 1)"}},{id:"highway-shield-us-other",type:"symbol",source:"openmaptiles","source-layer":"transportation_name",minzoom:9,filter:["all",["<=","ref_length",6],["==","$type","LineString"],["in","network","us-highway","us-state"]],layout:{"text-size":10,"icon-image":"{network}_{ref_length}","icon-rotation-alignment":"viewport","symbol-spacing":200,"text-font":["Open Sans Semibold"],"symbol-placement":{base:1,stops:[[10,"point"],[11,"line"]]},"text-rotation-alignment":"viewport","icon-size":1,"text-field":"{ref}"},paint:{"text-color":"rgba(0, 0, 0, 1)"}},{id:"place-other",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["!in","class","city","town","village"],["!has","name:de"]],layout:{"text-letter-spacing":.1,"text-size":{base:1.2,stops:[[12,10],[15,14]]},"text-font":["Open Sans Bold"],"text-field":`{name:latin}
{name:nonlatin}`,"text-transform":"uppercase","text-max-width":9},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-other-en",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["!in","class","city","town","village"],["has","name:de"]],layout:{"text-letter-spacing":.1,"text-size":{base:1.2,stops:[[12,10],[15,14]]},"text-font":["Open Sans Bold"],"text-field":`{name:de}
{name:nonlatin}`,"text-transform":"uppercase","text-max-width":9},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-village",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","village"],["!has","name:de"]],layout:{"text-font":["Open Sans Regular"],"text-size":{base:1.2,stops:[[10,12],[15,22]]},"text-field":`{name:latin}
{name:nonlatin}`,"text-max-width":8},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-village-en",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","village"],["has","name:de"]],layout:{"text-font":["Open Sans Regular"],"text-size":{base:1.2,stops:[[10,12],[15,22]]},"text-field":`{name:de}
{name:nonlatin}`,"text-max-width":8},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-town",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","town"],["!has","name:de"]],layout:{"text-font":["Open Sans Regular"],"text-size":{base:1.2,stops:[[10,14],[15,24]]},"text-field":`{name:latin}
{name:nonlatin}`,"text-max-width":8},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-town-en",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","town"],["has","name:de"]],layout:{"text-font":["Open Sans Regular"],"text-size":{base:1.2,stops:[[10,14],[15,24]]},"text-field":`{name:de}
{name:nonlatin}`,"text-max-width":8},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-city",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["!=","capital",2],["==","class","city"],["!has","name:de"]],layout:{"text-font":["Open Sans Semibold"],"text-size":{base:1.2,stops:[[7,14],[11,24]]},"text-field":`{name:latin}
{name:nonlatin}`,"text-max-width":8},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-city-en",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["!=","capital",2],["==","class","city"],["has","name:de"]],layout:{"text-font":["Open Sans Semibold"],"text-size":{base:1.2,stops:[[7,14],[11,24]]},"text-field":`{name:de}
{name:nonlatin}`,"text-max-width":8},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-city-capital",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","capital",2],["==","class","city"],["!has","name:de"]],layout:{"text-font":["Open Sans Semibold"],"text-size":{base:1.2,stops:[[7,14],[11,24]]},"text-field":`{name:latin}
{name:nonlatin}`,"text-max-width":8,"icon-image":"star_11","text-offset":[.4,0],"icon-size":.8,"text-anchor":"left"},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-city-capital-en",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","capital",2],["==","class","city"],["has","name:de"]],layout:{"text-font":["Open Sans Semibold"],"text-size":{base:1.2,stops:[[7,14],[11,24]]},"text-field":`{name:de}
{name:nonlatin}`,"text-max-width":8,"icon-image":"star_11","text-offset":[.4,0],"icon-size":.8,"text-anchor":"left"},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-country-3",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","country"],[">=","rank",3],["!has","name:de"]],layout:{"text-font":["Open Sans Bold"],"text-field":`{name:latin}
{name:nonlatin}`,"text-size":{stops:[[3,11],[7,17]]},"text-transform":"uppercase","text-max-width":6.25},paint:{"text-halo-blur":1,"text-color":"#fdfdfd","text-halo-width":2,"text-halo-color":"#433"}},{id:"place-country-3-en",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","country"],[">=","rank",3],["has","name:de"]],layout:{"text-font":["Open Sans Bold"],"text-field":`{name:de}
{name:nonlatin}`,"text-size":{stops:[[3,11],[7,17]]},"text-transform":"uppercase","text-max-width":6.25},paint:{"text-halo-blur":1,"text-color":"#fdfdfd","text-halo-width":2,"text-halo-color":"#433"}},{id:"place-country-2",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","country"],["==","rank",2],["!has","name:de"]],layout:{"text-font":["Open Sans Bold"],"text-field":`{name:latin}
{name:nonlatin}`,"text-size":{stops:[[2,11],[5,17]]},"text-transform":"uppercase","text-max-width":6.25},paint:{"text-halo-blur":1,"text-color":"#fdfdfd","text-halo-width":2,"text-halo-color":"#433"}},{id:"place-country-2-en",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","country"],["==","rank",2],["has","name:de"]],layout:{"text-font":["Open Sans Bold"],"text-field":`{name:de}
{name:nonlatin}`,"text-size":{stops:[[2,11],[5,17]]},"text-transform":"uppercase","text-max-width":6.25},paint:{"text-halo-blur":1,"text-color":"#fdfdfd","text-halo-width":2,"text-halo-color":"#433"}},{id:"place-country-1",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","country"],["==","rank",1],["!has","name:de"]],layout:{"text-font":["Open Sans Bold"],"text-field":`{name:latin}
{name:nonlatin}`,"text-size":{stops:[[1,11],[4,17]]},"text-transform":"uppercase","text-max-width":6.25},paint:{"text-halo-blur":1,"text-color":"#fdfdfd","text-halo-width":2,"text-halo-color":"#433"}},{id:"place-country-1-en",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","country"],["==","rank",1],["has","name:de"]],layout:{"text-font":["Open Sans Bold"],"text-field":`{name:de}
{name:nonlatin}`,"text-size":{stops:[[1,11],[4,17]]},"text-transform":"uppercase","text-max-width":6.25},paint:{"text-halo-blur":1,"text-color":"#fdfdfd","text-halo-width":2,"text-halo-color":"#433"}},{id:"place-continent",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",maxzoom:1,filter:["all",["==","class","continent"],["!has","name:de"]],layout:{"text-font":["Open Sans Bold"],"text-field":`{name:latin}
{name:nonlatin}`,"text-size":14,"text-max-width":6.25,"text-transform":"uppercase"},paint:{"text-halo-blur":1,"text-color":"#fdfdfd","text-halo-width":2,"text-halo-color":"#433"}},{id:"place-continent-en",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",maxzoom:1,filter:["all",["==","class","continent"],["has","name:de"]],layout:{"text-font":["Open Sans Bold"],"text-field":`{name:de}
{name:nonlatin}`,"text-size":14,"text-max-width":6.25,"text-transform":"uppercase"},paint:{"text-halo-blur":1,"text-color":"#fdfdfd","text-halo-width":2,"text-halo-color":"#433"}}]},PNe={version:8,name:"Solarized",center:[8.542,47.372],zoom:11.6,bearing:0,pitch:0,sources:{openmaptiles:{type:"vector",url:$u.source_openmaptiles_url}},sprite:$u.sprite,glyphs:$u.glyphs,layers:[{id:"background",type:"background",paint:{"background-color":"#073642"}},{id:"landcover-glacier",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landcover",filter:["==","subclass","glacier"],layout:{visibility:"visible"},paint:{"fill-color":"#2aa198","fill-opacity":{base:1,stops:[[0,.9],[10,.3]]}}},{id:"landuse-residential",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landuse",filter:["==","class","residential"],paint:{"fill-color":"#657b83"}},{id:"landuse-commercial",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landuse",filter:["all",["==","$type","Polygon"],["==","class","commercial"]],paint:{"fill-color":"#74888f"}},{id:"landuse-industrial",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landuse",filter:["all",["==","$type","Polygon"],["==","class","industrial"]],paint:{"fill-color":"#84959c"}},{id:"park",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"park",filter:["==","$type","Polygon"],paint:{"fill-color":"#859900","fill-opacity":{base:1.8,stops:[[9,.5],[12,.2]]}}},{id:"park-outline",type:"line",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"park",filter:["==","$type","Polygon"],layout:{},paint:{"line-color":"rgba(133,153,0,0.6)","line-dasharray":[3,3]}},{id:"landuse-cemetery",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landuse",filter:["==","class","cemetery"],paint:{"fill-color":"#f2ff99"}},{id:"landuse-hospital",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landuse",filter:["==","class","hospital"],paint:{"fill-color":"#d30102"}},{id:"landuse-school",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landuse",filter:["==","class","school"],paint:{"fill-color":"rgba(211,1,2,0.8)"}},{id:"landuse-railway",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landuse",filter:["==","class","railway"],paint:{"fill-color":"rgba(58,63,144,0.4)"}},{id:"landcover-wood",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landcover",filter:["==","class","wood"],paint:{"fill-color":"#2aa198","fill-opacity":.1,"fill-outline-color":"hsla(0, 0%, 0%, 0.03)","fill-antialias":{base:1,stops:[[0,!1],[9,!0]]}}},{id:"landcover-grass",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landcover",filter:["==","class","grass"],paint:{"fill-color":"#859900","fill-opacity":1}},{id:"landcover-grass-park",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"park",filter:["==","class","public_park"],paint:{"fill-color":"#859900","fill-opacity":.8}},{id:"waterway-other",type:"line",metadata:{"mapbox:group":"1444849382550.77"},source:"openmaptiles","source-layer":"waterway",filter:["!in","class","canal","river","stream"],layout:{"line-cap":"round"},paint:{"line-color":"#268bd2","line-width":{base:1.3,stops:[[13,.5],[20,2]]}}},{id:"waterway-stream-canal",type:"line",metadata:{"mapbox:group":"1444849382550.77"},source:"openmaptiles","source-layer":"waterway",filter:["in","class","canal","stream"],layout:{"line-cap":"round"},paint:{"line-color":"#268bd2","line-width":{base:1.3,stops:[[13,.5],[20,6]]}}},{id:"waterway-river",type:"line",metadata:{"mapbox:group":"1444849382550.77"},source:"openmaptiles","source-layer":"waterway",filter:["==","class","river"],layout:{"line-cap":"round"},paint:{"line-color":"#268bd2","line-width":{base:1.2,stops:[[10,.8],[20,6]]}}},{id:"water-offset",type:"fill",metadata:{"mapbox:group":"1444849382550.77"},source:"openmaptiles","source-layer":"water",maxzoom:8,filter:["==","$type","Polygon"],layout:{visibility:"visible"},paint:{"fill-opacity":1,"fill-color":"#268bd2","fill-translate":{base:1,stops:[[6,[2,0]],[8,[0,0]]]}}},{id:"water",type:"fill",metadata:{"mapbox:group":"1444849382550.77"},source:"openmaptiles","source-layer":"water",layout:{visibility:"visible"},paint:{"fill-color":"#1a6091"}},{id:"water-pattern",type:"fill",metadata:{"mapbox:group":"1444849382550.77"},source:"openmaptiles","source-layer":"water",layout:{visibility:"visible"},paint:{"fill-translate":[0,2.5],"fill-pattern":"wave"}},{id:"landcover-ice-shelf",type:"fill",metadata:{"mapbox:group":"1444849382550.77"},source:"openmaptiles","source-layer":"landcover",filter:["==","subclass","ice_shelf"],layout:{visibility:"visible"},paint:{"fill-color":"#2aa198","fill-opacity":{base:1,stops:[[0,.9],[10,.3]]}}},{id:"building",type:"fill",metadata:{"mapbox:group":"1444849364238.8171"},source:"openmaptiles","source-layer":"building",paint:{"fill-color":"#eee8d5","fill-antialias":!0}},{id:"building-top",type:"fill",metadata:{"mapbox:group":"1444849364238.8171"},source:"openmaptiles","source-layer":"building",layout:{visibility:"visible"},paint:{"fill-translate":{base:1,stops:[[14,[0,0]],[16,[-2,-2]]]},"fill-outline-color":"#dfdbd7","fill-color":"#fdfcf9","fill-opacity":{base:1,stops:[[13,0],[16,1]]}}},{id:"tunnel-service-track-casing",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["in","class","service","track"]],layout:{"line-join":"round"},paint:{"line-color":"#6c71c4","line-dasharray":[.5,.25],"line-width":{base:1.2,stops:[[15,1],[16,4],[20,11]]}}},{id:"tunnel-minor-casing",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["==","class","minor"]],layout:{"line-join":"round"},paint:{"line-color":"#6c71c4","line-opacity":{stops:[[12,0],[12.5,1]]},"line-width":{base:1.2,stops:[[12,.5],[13,1],[14,4],[20,15]]}}},{id:"tunnel-secondary-tertiary-casing",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["in","class","secondary","tertiary"]],layout:{"line-join":"round"},paint:{"line-color":"#d33682","line-opacity":1,"line-width":{base:1.2,stops:[[8,1.5],[20,17]]}}},{id:"tunnel-trunk-primary-casing",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["in","class","primary","trunk"]],layout:{"line-join":"round"},paint:{"line-color":"#d33682","line-width":{base:1.2,stops:[[5,.4],[6,.6],[7,1.5],[20,22]]}}},{id:"tunnel-motorway-casing",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["==","class","motorway"]],layout:{"line-join":"round",visibility:"visible"},paint:{"line-color":"#d33682","line-dasharray":[.5,.25],"line-width":{base:1.2,stops:[[5,.4],[6,.6],[7,1.5],[20,22]]}}},{id:"tunnel-path",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["==","brunnel","tunnel"],["==","class","path"]]],paint:{"line-color":"#9094d3","line-dasharray":[1.5,.75],"line-width":{base:1.2,stops:[[15,1.2],[20,4]]}}},{id:"tunnel-service-track",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["in","class","service","track"]],layout:{"line-join":"round"},paint:{"line-color":"#9094d3","line-width":{base:1.2,stops:[[15.5,0],[16,2],[20,7.5]]}}},{id:"tunnel-minor",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["==","class","minor_road"]],layout:{"line-join":"round"},paint:{"line-color":"#9094d3","line-opacity":1,"line-width":{base:1.2,stops:[[13.5,0],[14,2.5],[20,11.5]]}}},{id:"tunnel-secondary-tertiary",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["in","class","secondary","tertiary"]],layout:{"line-join":"round"},paint:{"line-color":"#a3a6da","line-width":{base:1.2,stops:[[6.5,0],[7,.5],[20,10]]}}},{id:"tunnel-trunk-primary",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["in","class","primary","trunk"]],layout:{"line-join":"round"},paint:{"line-color":"#6c71c4","line-width":{base:1.2,stops:[[6.5,0],[7,.5],[20,18]]}}},{id:"tunnel-motorway",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["==","class","motorway"]],layout:{"line-join":"round",visibility:"visible"},paint:{"line-color":"rgba(108,113,196,0.8)","line-width":{base:1.2,stops:[[6.5,0],[7,.5],[20,18]]}}},{id:"tunnel-railway",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["==","class","rail"]],paint:{"line-color":"#3a3f90","line-width":{base:1.4,stops:[[14,.4],[15,.75],[20,2]]},"line-dasharray":[2,2]}},{id:"aeroway-taxiway-casing",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"aeroway",minzoom:12,filter:["all",["in","class","taxiway"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#3a3f90","line-width":{base:1.5,stops:[[11,2],[17,12]]},"line-opacity":1}},{id:"aeroway-runway-casing",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"aeroway",minzoom:12,filter:["all",["in","class","runway"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#3a3f90","line-width":{base:1.5,stops:[[11,5],[17,55]]},"line-opacity":1}},{id:"aeroway-area",type:"fill",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"aeroway",minzoom:4,filter:["all",["==","$type","Polygon"],["in","class","runway","taxiway"]],layout:{visibility:"visible"},paint:{"fill-opacity":{base:1,stops:[[13,0],[14,1]]},"fill-color":"rgba(108,113,196,0.5)"}},{id:"aeroway-taxiway",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"aeroway",minzoom:4,filter:["all",["in","class","taxiway"],["==","$type","LineString"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#a3a6da","line-width":{base:1.5,stops:[[11,1],[17,10]]},"line-opacity":{base:1,stops:[[11,0],[12,1]]}}},{id:"aeroway-runway",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"aeroway",minzoom:4,filter:["all",["in","class","runway"],["==","$type","LineString"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#a3a6da","line-width":{base:1.5,stops:[[11,4],[17,50]]},"line-opacity":{base:1,stops:[[11,0],[12,1]]}}},{id:"highway-area",type:"fill",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["==","$type","Polygon"],layout:{visibility:"visible"},paint:{"fill-color":"#484fb5","fill-outline-color":"#cfcdca","fill-opacity":.9,"fill-antialias":!1}},{id:"highway-motorway-link-casing",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",minzoom:12,filter:["all",["!in","brunnel","bridge","tunnel"],["==","class","motorway_link"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#d33682","line-opacity":1,"line-width":{base:1.2,stops:[[12,1],[13,3],[14,4],[20,15]]}}},{id:"highway-link-casing",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",minzoom:13,filter:["all",["!in","brunnel","bridge","tunnel"],["in","class","primary_link","secondary_link","tertiary_link","trunk_link"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#d33682","line-opacity":1,"line-width":{base:1.2,stops:[[12,1],[13,3],[14,4],[20,15]]}}},{id:"highway-minor-casing",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["!=","brunnel","tunnel"],["in","class","minor","service","track"]]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"rgba(108,113,196,0.8)","line-opacity":{stops:[[12,0],[12.5,1]]},"line-width":{base:1.2,stops:[[12,.5],[13,1],[14,4],[20,15]]}}},{id:"highway-secondary-tertiary-casing",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["!in","brunnel","bridge","tunnel"],["in","class","secondary","tertiary"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#d33682","line-opacity":1,"line-width":{base:1.2,stops:[[8,1.5],[20,17]]}}},{id:"highway-primary-casing",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",minzoom:5,filter:["all",["!in","brunnel","bridge","tunnel"],["in","class","primary"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#d33682","line-opacity":{stops:[[7,0],[8,1]]},"line-width":{base:1.2,stops:[[7,0],[8,.6],[9,1.5],[20,22]]}}},{id:"highway-trunk-casing",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",minzoom:5,filter:["all",["!in","brunnel","bridge","tunnel"],["in","class","trunk"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#d33682","line-opacity":{stops:[[5,0],[6,1]]},"line-width":{base:1.2,stops:[[5,0],[6,.6],[7,1.5],[20,22]]}}},{id:"highway-motorway-casing",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",minzoom:4,filter:["all",["!in","brunnel","bridge","tunnel"],["==","class","motorway"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#d33682","line-width":{base:1.2,stops:[[4,0],[5,.4],[6,.6],[7,1.5],[20,22]]},"line-opacity":{stops:[[4,0],[5,1]]}}},{id:"highway-path",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["!in","brunnel","bridge","tunnel"],["==","class","path"]]],paint:{"line-color":"#cb4b16","line-dasharray":[1.5,.75],"line-width":{base:1.2,stops:[[15,1.2],[20,4]]}}},{id:"highway-motorway-link",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",minzoom:12,filter:["all",["!in","brunnel","bridge","tunnel"],["==","class","motorway_link"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#6c71c4","line-width":{base:1.2,stops:[[12.5,0],[13,1.5],[14,2.5],[20,11.5]]}}},{id:"highway-link",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",minzoom:13,filter:["all",["!in","brunnel","bridge","tunnel"],["in","class","primary_link","secondary_link","tertiary_link","trunk_link"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#6c71c4","line-width":{base:1.2,stops:[[12.5,0],[13,1.5],[14,2.5],[20,11.5]]}}},{id:"highway-minor",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["!=","brunnel","tunnel"],["in","class","minor","service","track"]]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#e58ab6","line-opacity":1,"line-width":{base:1.2,stops:[[13.5,0],[14,2.5],[20,11.5]]}}},{id:"highway-secondary-tertiary",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["!in","brunnel","bridge","tunnel"],["in","class","secondary","tertiary"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#6c71c4","line-width":{base:1.2,stops:[[6.5,0],[8,.5],[20,13]]}}},{id:"highway-primary",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["!in","brunnel","bridge","tunnel"],["in","class","primary"]]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#6c71c4","line-width":{base:1.2,stops:[[8.5,0],[9,.5],[20,18]]}}},{id:"highway-trunk",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["!in","brunnel","bridge","tunnel"],["in","class","trunk"]]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#6c71c4","line-width":{base:1.2,stops:[[6.5,0],[7,.5],[20,18]]}}},{id:"highway-motorway",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",minzoom:5,filter:["all",["==","$type","LineString"],["all",["!in","brunnel","bridge","tunnel"],["==","class","motorway"]]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#6c71c4","line-width":{base:1.2,stops:[[6.5,0],[7,.5],[20,18]]}}},{id:"railway-service",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["==","class","rail"],["has","service"]]],paint:{"line-color":"rgba(58,63,144,0.7)","line-width":{base:1.4,stops:[[14,.4],[20,1]]}}},{id:"railway-service-hatching",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["==","class","rail"],["has","service"]]],layout:{visibility:"visible"},paint:{"line-color":"rgba(58,63,144,0.7)","line-dasharray":[.2,8],"line-width":{base:1.4,stops:[[14.5,0],[15,2],[20,6]]}}},{id:"railway",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["!has","service"],["!in","brunnel","bridge","tunnel"],["==","class","rail"]]],paint:{"line-color":"#3a3f90","line-width":{base:1.4,stops:[[14,.4],[15,.75],[20,2]]}}},{id:"railway-hatching",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["!has","service"],["!in","brunnel","bridge","tunnel"],["==","class","rail"]]],paint:{"line-color":"#3a3f90","line-dasharray":[.2,8],"line-width":{base:1.4,stops:[[14.5,0],[15,3],[20,8]]}}},{id:"bridge-motorway-link-casing",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["==","class","motorway_link"]],layout:{"line-join":"round"},paint:{"line-color":"#d33682","line-opacity":1,"line-width":{base:1.2,stops:[[12,1],[13,3],[14,4],[20,15]]}}},{id:"bridge-link-casing",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["in","class","primary_link","secondary_link","tertiary_link","trunk_link"]],layout:{"line-join":"round"},paint:{"line-color":"#d33682","line-opacity":1,"line-width":{base:1.2,stops:[[12,1],[13,3],[14,4],[20,15]]}}},{id:"bridge-secondary-tertiary-casing",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["in","class","secondary","tertiary"]],layout:{"line-join":"round"},paint:{"line-color":"#d33682","line-opacity":1,"line-width":{base:1.2,stops:[[8,1.5],[20,28]]}}},{id:"bridge-trunk-primary-casing",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["in","class","primary","trunk"]],layout:{"line-join":"round"},paint:{"line-color":"#d33682","line-width":{base:1.2,stops:[[5,.4],[6,.6],[7,1.5],[20,26]]}}},{id:"bridge-motorway-casing",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["==","class","motorway"]],layout:{"line-join":"round"},paint:{"line-color":"#d33682","line-width":{base:1.2,stops:[[5,.4],[6,.6],[7,1.5],[20,22]]}}},{id:"bridge-path-casing",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["==","brunnel","bridge"],["==","class","path"]]],paint:{"line-color":"#9094d3","line-width":{base:1.2,stops:[[15,1.2],[20,18]]}}},{id:"bridge-path",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["==","brunnel","bridge"],["==","class","path"]]],paint:{"line-color":"#cb4b16","line-width":{base:1.2,stops:[[15,1.2],[20,4]]},"line-dasharray":[1.5,.75]}},{id:"bridge-motorway-link",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["==","class","motorway_link"]],layout:{"line-join":"round"},paint:{"line-color":"#6c71c4","line-width":{base:1.2,stops:[[12.5,0],[13,1.5],[14,2.5],[20,11.5]]}}},{id:"bridge-link",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["in","class","primary_link","secondary_link","tertiary_link","trunk_link"]],layout:{"line-join":"round"},paint:{"line-color":"#6c71c4","line-width":{base:1.2,stops:[[12.5,0],[13,1.5],[14,2.5],[20,11.5]]}}},{id:"bridge-secondary-tertiary",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["in","class","secondary","tertiary"]],layout:{"line-join":"round"},paint:{"line-color":"#6c71c4","line-width":{base:1.2,stops:[[6.5,0],[7,.5],[20,20]]}}},{id:"bridge-trunk-primary",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["in","class","primary","trunk"]],layout:{"line-join":"round"},paint:{"line-color":"#6c71c4","line-width":{base:1.2,stops:[[6.5,0],[7,.5],[20,18]]}}},{id:"bridge-motorway",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["==","class","motorway"]],layout:{"line-join":"round"},paint:{"line-color":"#6c71c4","line-width":{base:1.2,stops:[[6.5,0],[7,.5],[20,18]]}}},{id:"bridge-railway",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["==","class","rail"]],paint:{"line-color":"#3a3f90","line-width":{base:1.4,stops:[[14,.4],[15,.75],[20,2]]}}},{id:"bridge-railway-hatching",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["==","class","rail"]],paint:{"line-color":"#3a3f90","line-dasharray":[.2,8],"line-width":{base:1.4,stops:[[14.5,0],[15,3],[20,8]]}}},{id:"boundary-land-level-4",type:"line",source:"openmaptiles","source-layer":"boundary",filter:["all",["in","admin_level",4,6,8],["!=","maritime",1]],layout:{"line-join":"round"},paint:{"line-color":"#268bd2","line-dasharray":[3,1,1,1],"line-width":{base:1.4,stops:[[4,.4],[5,1],[12,3]]}}},{id:"boundary-land-level-2",type:"line",source:"openmaptiles","source-layer":"boundary",filter:["all",["==","admin_level",2],["!=","maritime",1]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#268bd2","line-width":{base:1,stops:[[0,.6],[4,1.4],[5,2],[12,8]]}}},{id:"boundary-water",type:"line",source:"openmaptiles","source-layer":"boundary",filter:["all",["in","admin_level",2,4],["==","maritime",1]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#268bd2","line-width":{base:1,stops:[[0,.6],[4,1.4],[5,2],[12,8]]},"line-opacity":{stops:[[6,.6],[10,1]]}}},{id:"waterway-name",type:"symbol",source:"openmaptiles","source-layer":"waterway",minzoom:13,filter:["all",["==","$type","LineString"],["has","name"],["!has","name:de"]],layout:{"text-font":["Open Sans Italic"],"text-size":14,"text-field":"{name:latin} {name:nonlatin}","text-max-width":5,"text-rotation-alignment":"map","symbol-placement":"line","text-letter-spacing":.2,"symbol-spacing":350},paint:{"text-color":"#fefefe","text-halo-width":1.5,"text-halo-color":"#74aee9"}},{id:"waterway-name-en",type:"symbol",source:"openmaptiles","source-layer":"waterway",minzoom:13,filter:["all",["==","$type","LineString"],["has","name"],["has","name:de"]],layout:{"text-font":["Open Sans Italic"],"text-size":14,"text-field":"{name:de} {name:nonlatin}","text-max-width":5,"text-rotation-alignment":"map","symbol-placement":"line","text-letter-spacing":.2,"symbol-spacing":350},paint:{"text-color":"#fefefe","text-halo-width":1.5,"text-halo-color":"#74aee9"}},{id:"water-name-lakeline",type:"symbol",source:"openmaptiles","source-layer":"water_name",filter:["all",["==","$type","LineString"],["!has","name:de"]],layout:{"text-font":["Open Sans Italic"],"text-size":14,"text-field":"{name:latin} {name:nonlatin}","text-max-width":5,"text-rotation-alignment":"map","symbol-placement":"line","symbol-spacing":350,"text-letter-spacing":.2},paint:{"text-color":"#fefefe","text-halo-width":1.5,"text-halo-color":"#74aee9"}},{id:"water-name-lakeline-en",type:"symbol",source:"openmaptiles","source-layer":"water_name",filter:["all",["==","$type","LineString"],["has","name:de"]],layout:{"text-font":["Open Sans Italic"],"text-size":14,"text-field":"{name:de} {name:nonlatin}","text-max-width":5,"text-rotation-alignment":"map","symbol-placement":"line","symbol-spacing":350,"text-letter-spacing":.2},paint:{"text-color":"#fefefe","text-halo-width":1.5,"text-halo-color":"#74aee9"}},{id:"water-name-ocean",type:"symbol",source:"openmaptiles","source-layer":"water_name",filter:["all",["==","$type","Point"],["==","class","ocean"],["!has","name:de"]],layout:{"text-font":["Open Sans Italic"],"text-size":14,"text-field":`{name:latin}
{name:nonlatin}`,"text-max-width":5,"text-rotation-alignment":"map","symbol-placement":"point","symbol-spacing":350,"text-letter-spacing":.2},paint:{"text-color":"#fefefe","text-halo-width":1.5,"text-halo-color":"#74aee9"}},{id:"water-name-ocean-en",type:"symbol",source:"openmaptiles","source-layer":"water_name",filter:["all",["==","$type","Point"],["==","class","ocean"],["has","name:de"]],layout:{"text-font":["Open Sans Italic"],"text-size":14,"text-field":`{name:de}
{name:nonlatin}`,"text-max-width":5,"text-rotation-alignment":"map","symbol-placement":"point","symbol-spacing":350,"text-letter-spacing":.2},paint:{"text-color":"#fefefe","text-halo-width":1.5,"text-halo-color":"#74aee9"}},{id:"water-name-other",type:"symbol",source:"openmaptiles","source-layer":"water_name",filter:["all",["==","$type","Point"],["!in","class","ocean"],["!has","name:de"]],layout:{"text-font":["Open Sans Italic"],"text-size":{stops:[[0,10],[6,14]]},"text-field":`{name:latin}
{name:nonlatin}`,"text-max-width":5,"text-rotation-alignment":"map","symbol-placement":"point","symbol-spacing":350,"text-letter-spacing":.2,visibility:"visible"},paint:{"text-color":"#fefefe","text-halo-width":1.5,"text-halo-color":"#74aee9"}},{id:"water-name-other-en",type:"symbol",source:"openmaptiles","source-layer":"water_name",filter:["all",["==","$type","Point"],["!in","class","ocean"],["has","name:de"]],layout:{"text-font":["Open Sans Italic"],"text-size":{stops:[[0,10],[6,14]]},"text-field":`{name:de}
{name:nonlatin}`,"text-max-width":5,"text-rotation-alignment":"map","symbol-placement":"point","symbol-spacing":350,"text-letter-spacing":.2,visibility:"visible"},paint:{"text-color":"#fefefe","text-halo-width":1.5,"text-halo-color":"#74aee9"}},{id:"poi-level-3",type:"symbol",source:"openmaptiles","source-layer":"poi",minzoom:16,filter:["all",["==","$type","Point"],[">=","rank",25],["!has","name:de"]],layout:{"text-padding":2,"text-font":["Open Sans Semibold"],"text-anchor":"top","icon-image":"{class}_11","text-field":`{name:latin}
{name:nonlatin}`,"text-offset":[0,.6],"text-size":12,"text-max-width":9},paint:{"text-halo-blur":.5,"text-color":"#fdfdfd","text-halo-width":1,"text-halo-color":"#633"}},{id:"poi-level-3-en",type:"symbol",source:"openmaptiles","source-layer":"poi",minzoom:16,filter:["all",["==","$type","Point"],[">=","rank",25],["has","name:de"]],layout:{"text-padding":2,"text-font":["Open Sans Semibold"],"text-anchor":"top","icon-image":"{class}_11","text-field":`{name:de}
{name:nonlatin}`,"text-offset":[0,.6],"text-size":12,"text-max-width":9},paint:{"text-halo-blur":.5,"text-color":"#fdfdfd","text-halo-width":1,"text-halo-color":"#633"}},{id:"poi-level-2",type:"symbol",source:"openmaptiles","source-layer":"poi",minzoom:15,filter:["all",["==","$type","Point"],["all",["<=","rank",24],[">=","rank",15]],["!has","name:de"]],layout:{"text-padding":2,"text-font":["Open Sans Semibold"],"text-anchor":"top","icon-image":"{class}_11","text-field":`{name:latin}
{name:nonlatin}`,"text-offset":[0,.6],"text-size":12,"text-max-width":9},paint:{"text-halo-blur":.5,"text-color":"#fdfdfd","text-halo-width":1,"text-halo-color":"#633"}},{id:"poi-level-2-en",type:"symbol",source:"openmaptiles","source-layer":"poi",minzoom:15,filter:["all",["==","$type","Point"],["all",["<=","rank",24],[">=","rank",15]],["has","name:de"]],layout:{"text-padding":2,"text-font":["Open Sans Semibold"],"text-anchor":"top","icon-image":"{class}_11","text-field":`{name:de}
{name:nonlatin}`,"text-offset":[0,.6],"text-size":12,"text-max-width":9},paint:{"text-halo-blur":.5,"text-color":"#fdfdfd","text-halo-width":1,"text-halo-color":"#633"}},{id:"poi-level-1",type:"symbol",source:"openmaptiles","source-layer":"poi",minzoom:14,filter:["all",["==","$type","Point"],["all",["<=","rank",14],["has","name"]],["!has","name:de"]],layout:{"text-padding":2,"text-font":["Open Sans Semibold"],"text-anchor":"top","icon-image":"{class}_11","text-field":`{name:latin}
{name:nonlatin}`,"text-offset":[0,.6],"text-size":12,"text-max-width":9},paint:{"text-halo-blur":.5,"text-color":"#fdfdfd","text-halo-width":1,"text-halo-color":"#633"}},{id:"poi-level-1-en",type:"symbol",source:"openmaptiles","source-layer":"poi",minzoom:14,filter:["all",["==","$type","Point"],["all",["<=","rank",14],["has","name"]],["has","name:de"]],layout:{"text-padding":2,"text-font":["Open Sans Semibold"],"text-anchor":"top","icon-image":"{class}_11","text-field":`{name:de}
{name:nonlatin}`,"text-offset":[0,.6],"text-size":12,"text-max-width":9},paint:{"text-halo-blur":.5,"text-color":"#fdfdfd","text-halo-width":1,"text-halo-color":"#633"}},{id:"highway-name-path",type:"symbol",source:"openmaptiles","source-layer":"transportation_name",minzoom:15.5,filter:["all",["==","class","path"],["!has","name:de"]],layout:{"text-size":{base:1,stops:[[13,12],[14,13]]},"text-font":["Open Sans Regular"],"text-field":"{name:latin} {name:nonlatin}","symbol-placement":"line","text-rotation-alignment":"map"},paint:{"text-halo-color":"#f8f4f0","text-color":"hsl(30, 23%, 62%)","text-halo-width":.5}},{id:"highway-name-path-en",type:"symbol",source:"openmaptiles","source-layer":"transportation_name",minzoom:15.5,filter:["all",["==","class","path"],["has","name:de"]],layout:{"text-size":{base:1,stops:[[13,12],[14,13]]},"text-font":["Open Sans Regular"],"text-field":"{name:de} {name:nonlatin}","symbol-placement":"line","text-rotation-alignment":"map"},paint:{"text-halo-color":"#f8f4f0","text-color":"hsl(30, 23%, 62%)","text-halo-width":.5}},{id:"highway-name-minor",type:"symbol",source:"openmaptiles","source-layer":"transportation_name",minzoom:15,filter:["all",["==","$type","LineString"],["in","class","minor","service","track"],["!has","name:de"]],layout:{"text-size":{base:1,stops:[[13,12],[14,13]]},"text-font":["Open Sans Regular"],"text-field":"{name:latin} {name:nonlatin}","symbol-placement":"line","text-rotation-alignment":"map"},paint:{"text-halo-blur":.5,"text-color":"#765","text-halo-width":1}},{id:"highway-name-minor-en",type:"symbol",source:"openmaptiles","source-layer":"transportation_name",minzoom:15,filter:["all",["==","$type","LineString"],["in","class","minor","service","track"],["has","name:de"]],layout:{"text-size":{base:1,stops:[[13,12],[14,13]]},"text-font":["Open Sans Regular"],"text-field":"{name:de} {name:nonlatin}","symbol-placement":"line","text-rotation-alignment":"map"},paint:{"text-halo-blur":.5,"text-color":"#765","text-halo-width":1}},{id:"highway-name-major",type:"symbol",source:"openmaptiles","source-layer":"transportation_name",minzoom:12.2,filter:["all",["in","class","primary","secondary","tertiary","trunk"],["!has","name:de"]],layout:{"text-size":{base:1,stops:[[13,12],[14,13]]},"text-font":["Open Sans Regular"],"text-field":"{name:latin} {name:nonlatin}","symbol-placement":"line","text-rotation-alignment":"map"},paint:{"text-halo-blur":.5,"text-color":"#765","text-halo-width":1}},{id:"highway-name-major-en",type:"symbol",source:"openmaptiles","source-layer":"transportation_name",minzoom:12.2,filter:["all",["in","class","primary","secondary","tertiary","trunk"],["has","name:de"]],layout:{"text-size":{base:1,stops:[[13,12],[14,13]]},"text-font":["Open Sans Regular"],"text-field":"{name:de} {name:nonlatin}","symbol-placement":"line","text-rotation-alignment":"map"},paint:{"text-halo-blur":.5,"text-color":"#765","text-halo-width":1}},{id:"highway-shield",type:"symbol",source:"openmaptiles","source-layer":"transportation_name",minzoom:8,filter:["all",["<=","ref_length",6],["==","$type","LineString"],["!in","network","us-interstate","us-highway","us-state"]],layout:{"text-size":10,"icon-image":"road_{ref_length}","icon-rotation-alignment":"viewport","symbol-spacing":200,"text-font":["Open Sans Semibold"],"symbol-placement":{base:1,stops:[[10,"point"],[11,"line"]]},"text-rotation-alignment":"viewport","icon-size":1,"text-field":"{ref}"},paint:{}},{id:"highway-shield-us-interstate",type:"symbol",source:"openmaptiles","source-layer":"transportation_name",minzoom:7,filter:["all",["<=","ref_length",6],["==","$type","LineString"],["in","network","us-interstate"]],layout:{"text-size":10,"icon-image":"{network}_{ref_length}","icon-rotation-alignment":"viewport","symbol-spacing":200,"text-font":["Open Sans Semibold"],"symbol-placement":{base:1,stops:[[7,"point"],[7,"line"],[8,"line"]]},"text-rotation-alignment":"viewport","icon-size":1,"text-field":"{ref}"},paint:{"text-color":"rgba(0, 0, 0, 1)"}},{id:"highway-shield-us-other",type:"symbol",source:"openmaptiles","source-layer":"transportation_name",minzoom:9,filter:["all",["<=","ref_length",6],["==","$type","LineString"],["in","network","us-highway","us-state"]],layout:{"text-size":10,"icon-image":"{network}_{ref_length}","icon-rotation-alignment":"viewport","symbol-spacing":200,"text-font":["Open Sans Semibold"],"symbol-placement":{base:1,stops:[[10,"point"],[11,"line"]]},"text-rotation-alignment":"viewport","icon-size":1,"text-field":"{ref}"},paint:{"text-color":"rgba(0, 0, 0, 1)"}},{id:"place-other",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["!in","class","city","town","village"],["!has","name:de"]],layout:{"text-letter-spacing":.1,"text-size":{base:1.2,stops:[[12,10],[15,14]]},"text-font":["Open Sans Bold"],"text-field":`{name:latin}
{name:nonlatin}`,"text-transform":"uppercase","text-max-width":9},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-other-en",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["!in","class","city","town","village"],["has","name:de"]],layout:{"text-letter-spacing":.1,"text-size":{base:1.2,stops:[[12,10],[15,14]]},"text-font":["Open Sans Bold"],"text-field":`{name:de}
{name:nonlatin}`,"text-transform":"uppercase","text-max-width":9},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-village",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","village"],["!has","name:de"]],layout:{"text-font":["Open Sans Regular"],"text-size":{base:1.2,stops:[[10,12],[15,22]]},"text-field":`{name:latin}
{name:nonlatin}`,"text-max-width":8},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-village-en",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","village"],["has","name:de"]],layout:{"text-font":["Open Sans Regular"],"text-size":{base:1.2,stops:[[10,12],[15,22]]},"text-field":`{name:de}
{name:nonlatin}`,"text-max-width":8},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-town",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","town"],["!has","name:de"]],layout:{"text-font":["Open Sans Regular"],"text-size":{base:1.2,stops:[[10,14],[15,24]]},"text-field":`{name:latin}
{name:nonlatin}`,"text-max-width":8},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-town-en",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","town"],["has","name:de"]],layout:{"text-font":["Open Sans Regular"],"text-size":{base:1.2,stops:[[10,14],[15,24]]},"text-field":`{name:de}
{name:nonlatin}`,"text-max-width":8},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-city",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["!=","capital",2],["==","class","city"],["!has","name:de"]],layout:{"text-font":["Open Sans Semibold"],"text-size":{base:1.2,stops:[[7,14],[11,24]]},"text-field":`{name:latin}
{name:nonlatin}`,"text-max-width":8},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-city-en",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["!=","capital",2],["==","class","city"],["has","name:de"]],layout:{"text-font":["Open Sans Semibold"],"text-size":{base:1.2,stops:[[7,14],[11,24]]},"text-field":`{name:de}
{name:nonlatin}`,"text-max-width":8},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-city-capital",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","capital",2],["==","class","city"],["!has","name:de"]],layout:{"text-font":["Open Sans Semibold"],"text-size":{base:1.2,stops:[[7,14],[11,24]]},"text-field":`{name:latin}
{name:nonlatin}`,"text-max-width":8,"icon-image":"star_11","text-offset":[.4,0],"icon-size":.8,"text-anchor":"left"},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-city-capital-en",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","capital",2],["==","class","city"],["has","name:de"]],layout:{"text-font":["Open Sans Semibold"],"text-size":{base:1.2,stops:[[7,14],[11,24]]},"text-field":`{name:de}
{name:nonlatin}`,"text-max-width":8,"icon-image":"star_11","text-offset":[.4,0],"icon-size":.8,"text-anchor":"left"},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-country-3",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","country"],[">=","rank",3],["!has","name:de"]],layout:{"text-font":["Open Sans Bold"],"text-field":`{name:latin}
{name:nonlatin}`,"text-size":{stops:[[3,11],[7,17]]},"text-transform":"uppercase","text-max-width":6.25},paint:{"text-halo-blur":1,"text-color":"#fdfdfd","text-halo-width":2,"text-halo-color":"#433"}},{id:"place-country-3-en",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","country"],[">=","rank",3],["has","name:de"]],layout:{"text-font":["Open Sans Bold"],"text-field":`{name:de}
{name:nonlatin}`,"text-size":{stops:[[3,11],[7,17]]},"text-transform":"uppercase","text-max-width":6.25},paint:{"text-halo-blur":1,"text-color":"#fdfdfd","text-halo-width":2,"text-halo-color":"#433"}},{id:"place-country-2",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","country"],["==","rank",2],["!has","name:de"]],layout:{"text-font":["Open Sans Bold"],"text-field":`{name:latin}
{name:nonlatin}`,"text-size":{stops:[[2,11],[5,17]]},"text-transform":"uppercase","text-max-width":6.25},paint:{"text-halo-blur":1,"text-color":"#fdfdfd","text-halo-width":2,"text-halo-color":"#433"}},{id:"place-country-2-en",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","country"],["==","rank",2],["has","name:de"]],layout:{"text-font":["Open Sans Bold"],"text-field":`{name:de}
{name:nonlatin}`,"text-size":{stops:[[2,11],[5,17]]},"text-transform":"uppercase","text-max-width":6.25},paint:{"text-halo-blur":1,"text-color":"#fdfdfd","text-halo-width":2,"text-halo-color":"#433"}},{id:"place-country-1",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","country"],["==","rank",1],["!has","name:de"]],layout:{"text-font":["Open Sans Bold"],"text-field":`{name:latin}
{name:nonlatin}`,"text-size":{stops:[[1,11],[4,17]]},"text-transform":"uppercase","text-max-width":6.25},paint:{"text-halo-blur":1,"text-color":"#fdfdfd","text-halo-width":2,"text-halo-color":"#433"}},{id:"place-country-1-en",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","country"],["==","rank",1],["has","name:de"]],layout:{"text-font":["Open Sans Bold"],"text-field":`{name:de}
{name:nonlatin}`,"text-size":{stops:[[1,11],[4,17]]},"text-transform":"uppercase","text-max-width":6.25},paint:{"text-halo-blur":1,"text-color":"#fdfdfd","text-halo-width":2,"text-halo-color":"#433"}},{id:"place-continent",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",maxzoom:1,filter:["all",["==","class","continent"],["!has","name:de"]],layout:{"text-font":["Open Sans Bold"],"text-field":`{name:latin}
{name:nonlatin}`,"text-size":14,"text-max-width":6.25,"text-transform":"uppercase"},paint:{"text-halo-blur":1,"text-color":"#fdfdfd","text-halo-width":2,"text-halo-color":"#433"}},{id:"place-continent-en",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",maxzoom:1,filter:["all",["==","class","continent"],["has","name:de"]],layout:{"text-font":["Open Sans Bold"],"text-field":`{name:de}
{name:nonlatin}`,"text-size":14,"text-max-width":6.25,"text-transform":"uppercase"},paint:{"text-halo-blur":1,"text-color":"#fdfdfd","text-halo-width":2,"text-halo-color":"#433"}}]},kNe={version:8,name:"Oceanic Next",center:[8.542,47.372],zoom:11.6,bearing:0,pitch:0,sources:{openmaptiles:{type:"vector",url:$u.source_openmaptiles_url}},sprite:$u.sprite,glyphs:$u.glyphs,layers:[{id:"background",type:"background",paint:{"background-color":"#282822"}},{id:"landcover-glacier",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landcover",filter:["==","subclass","glacier"],layout:{visibility:"visible"},paint:{"fill-color":"#81a1c1","fill-opacity":{base:1,stops:[[0,.9],[10,.3]]}}},{id:"landuse-residential",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landuse",filter:["==","class","residential"],paint:{"fill-color":"#a3be8c"}},{id:"landuse-commercial",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landuse",filter:["all",["==","$type","Polygon"],["==","class","commercial"]],paint:{"fill-color":"#acc598"}},{id:"landuse-industrial",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landuse",filter:["all",["==","$type","Polygon"],["==","class","industrial"]],paint:{"fill-color":"#b5cba3"}},{id:"park",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"park",filter:["==","$type","Polygon"],paint:{"fill-color":"#a3be8c","fill-opacity":{base:1.8,stops:[[9,.5],[12,.2]]}}},{id:"park-outline",type:"line",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"park",filter:["==","$type","Polygon"],layout:{},paint:{"line-color":"rgba(163,19,14,0.6)","line-dasharray":[3,3]}},{id:"landuse-cemetery",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landuse",filter:["==","class","cemetery"],paint:{"fill-color":"#cbdabe"}},{id:"landuse-hospital",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landuse",filter:["==","class","hospital"],paint:{"fill-color":"#b48ead"}},{id:"landuse-school",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landuse",filter:["==","class","school"],paint:{"fill-color":"rgba(18,142,173,0.8)"}},{id:"landuse-railway",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landuse",filter:["==","class","railway"],paint:{"fill-color":"rgba(118,51,8,0.4)"}},{id:"landcover-wood",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landcover",filter:["==","class","wood"],paint:{"fill-color":"#81a1c1","fill-opacity":.1,"fill-outline-color":"hsla(0, 0%, 0%, 0.03)","fill-antialias":{base:1,stops:[[0,!1],[9,!0]]}}},{id:"landcover-grass",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landcover",filter:["==","class","grass"],paint:{"fill-color":"#a3be8c","fill-opacity":1}},{id:"landcover-grass-park",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"park",filter:["==","class","public_park"],paint:{"fill-color":"#a3be8c","fill-opacity":.8}},{id:"waterway-other",type:"line",metadata:{"mapbox:group":"1444849382550.77"},source:"openmaptiles","source-layer":"waterway",filter:["!in","class","canal","river","stream"],layout:{"line-cap":"round"},paint:{"line-color":"#8fbcbb","line-width":{base:1.3,stops:[[13,.5],[20,2]]}}},{id:"waterway-stream-canal",type:"line",metadata:{"mapbox:group":"1444849382550.77"},source:"openmaptiles","source-layer":"waterway",filter:["in","class","canal","stream"],layout:{"line-cap":"round"},paint:{"line-color":"#8fbcbb","line-width":{base:1.3,stops:[[13,.5],[20,6]]}}},{id:"waterway-river",type:"line",metadata:{"mapbox:group":"1444849382550.77"},source:"openmaptiles","source-layer":"waterway",filter:["==","class","river"],layout:{"line-cap":"round"},paint:{"line-color":"#8fbcbb","line-width":{base:1.2,stops:[[10,.8],[20,6]]}}},{id:"water-offset",type:"fill",metadata:{"mapbox:group":"1444849382550.77"},source:"openmaptiles","source-layer":"water",maxzoom:8,filter:["==","$type","Polygon"],layout:{visibility:"visible"},paint:{"fill-opacity":1,"fill-color":"#8fbcbb","fill-translate":{base:1,stops:[[6,[2,0]],[8,[0,0]]]}}},{id:"water",type:"fill",metadata:{"mapbox:group":"1444849382550.77"},source:"openmaptiles","source-layer":"water",layout:{visibility:"visible"},paint:{"fill-color":"#5f9f9e"}},{id:"water-pattern",type:"fill",metadata:{"mapbox:group":"1444849382550.77"},source:"openmaptiles","source-layer":"water",layout:{visibility:"visible"},paint:{"fill-translate":[0,2.5],"fill-pattern":"wave"}},{id:"landcover-ice-shelf",type:"fill",metadata:{"mapbox:group":"1444849382550.77"},source:"openmaptiles","source-layer":"landcover",filter:["==","subclass","ice_shelf"],layout:{visibility:"visible"},paint:{"fill-color":"#81a1c1","fill-opacity":{base:1,stops:[[0,.9],[10,.3]]}}},{id:"building",type:"fill",metadata:{"mapbox:group":"1444849364238.8171"},source:"openmaptiles","source-layer":"building",paint:{"fill-color":"#65737e","fill-antialias":!0}},{id:"building-top",type:"fill",metadata:{"mapbox:group":"1444849364238.8171"},source:"openmaptiles","source-layer":"building",layout:{visibility:"visible"},paint:{"fill-translate":{base:1,stops:[[14,[0,0]],[16,[-2,-2]]]},"fill-outline-color":"#dfdbd7","fill-color":"#7e8d98","fill-opacity":{base:1,stops:[[13,0],[16,1]]}}},{id:"tunnel-service-track-casing",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["in","class","service","track"]],layout:{"line-join":"round"},paint:{"line-color":"#d65d0e","line-dasharray":[.5,.25],"line-width":{base:1.2,stops:[[15,1],[16,4],[20,11]]}}},{id:"tunnel-minor-casing",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["==","class","minor"]],layout:{"line-join":"round"},paint:{"line-color":"#d65d0e","line-opacity":{stops:[[12,0],[12.5,1]]},"line-width":{base:1.2,stops:[[12,.5],[13,1],[14,4],[20,15]]}}},{id:"tunnel-secondary-tertiary-casing",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["in","class","secondary","tertiary"]],layout:{"line-join":"round"},paint:{"line-color":"#d65d0e","line-opacity":1,"line-width":{base:1.2,stops:[[8,1.5],[20,17]]}}},{id:"tunnel-trunk-primary-casing",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["in","class","primary","trunk"]],layout:{"line-join":"round"},paint:{"line-color":"#d65d0e","line-width":{base:1.2,stops:[[5,.4],[6,.6],[7,1.5],[20,22]]}}},{id:"tunnel-motorway-casing",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["==","class","motorway"]],layout:{"line-join":"round",visibility:"visible"},paint:{"line-color":"#d65d0e","line-dasharray":[.5,.25],"line-width":{base:1.2,stops:[[5,.4],[6,.6],[7,1.5],[20,22]]}}},{id:"tunnel-path",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["==","brunnel","tunnel"],["==","class","path"]]],paint:{"line-color":"#f17626","line-dasharray":[1.5,.75],"line-width":{base:1.2,stops:[[15,1.2],[20,4]]}}},{id:"tunnel-service-track",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["in","class","service","track"]],layout:{"line-join":"round"},paint:{"line-color":"#f17626","line-width":{base:1.2,stops:[[15.5,0],[16,2],[20,7.5]]}}},{id:"tunnel-minor",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["==","class","minor_road"]],layout:{"line-join":"round"},paint:{"line-color":"#f17626","line-opacity":1,"line-width":{base:1.2,stops:[[13.5,0],[14,2.5],[20,11.5]]}}},{id:"tunnel-secondary-tertiary",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["in","class","secondary","tertiary"]],layout:{"line-join":"round"},paint:{"line-color":"#f2853e","line-width":{base:1.2,stops:[[6.5,0],[7,.5],[20,10]]}}},{id:"tunnel-trunk-primary",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["in","class","primary","trunk"]],layout:{"line-join":"round"},paint:{"line-color":"#d65d0e","line-width":{base:1.2,stops:[[6.5,0],[7,.5],[20,18]]}}},{id:"tunnel-motorway",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["==","class","motorway"]],layout:{"line-join":"round",visibility:"visible"},paint:{"line-color":"rgba(235,219,178,0.8)","line-width":{base:1.2,stops:[[6.5,0],[7,.5],[20,18]]}}},{id:"tunnel-railway",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["==","class","rail"]],paint:{"line-color":"#763308","line-width":{base:1.4,stops:[[14,.4],[15,.75],[20,2]]},"line-dasharray":[2,2]}},{id:"aeroway-taxiway-casing",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"aeroway",minzoom:12,filter:["all",["in","class","taxiway"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#763308","line-width":{base:1.5,stops:[[11,2],[17,12]]},"line-opacity":1}},{id:"aeroway-runway-casing",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"aeroway",minzoom:12,filter:["all",["in","class","runway"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#763308","line-width":{base:1.5,stops:[[11,5],[17,55]]},"line-opacity":1}},{id:"aeroway-area",type:"fill",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"aeroway",minzoom:4,filter:["all",["==","$type","Polygon"],["in","class","runway","taxiway"]],layout:{visibility:"visible"},paint:{"fill-opacity":{base:1,stops:[[13,0],[14,1]]},"fill-color":"rgba(214,93,14,0.5)"}},{id:"aeroway-taxiway",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"aeroway",minzoom:4,filter:["all",["in","class","taxiway"],["==","$type","LineString"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#f2853e","line-width":{base:1.5,stops:[[11,1],[17,10]]},"line-opacity":{base:1,stops:[[11,0],[12,1]]}}},{id:"aeroway-runway",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"aeroway",minzoom:4,filter:["all",["in","class","runway"],["==","$type","LineString"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#f2853e","line-width":{base:1.5,stops:[[11,4],[17,50]]},"line-opacity":{base:1,stops:[[11,0],[12,1]]}}},{id:"highway-area",type:"fill",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["==","$type","Polygon"],layout:{visibility:"visible"},paint:{"fill-color":"#a6480b","fill-outline-color":"#cfcdca","fill-opacity":.9,"fill-antialias":!1}},{id:"highway-motorway-link-casing",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",minzoom:12,filter:["all",["!in","brunnel","bridge","tunnel"],["==","class","motorway_link"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#d65d0e","line-opacity":1,"line-width":{base:1.2,stops:[[12,1],[13,3],[14,4],[20,15]]}}},{id:"highway-link-casing",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",minzoom:13,filter:["all",["!in","brunnel","bridge","tunnel"],["in","class","primary_link","secondary_link","tertiary_link","trunk_link"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#d65d0e","line-opacity":1,"line-width":{base:1.2,stops:[[12,1],[13,3],[14,4],[20,15]]}}},{id:"highway-minor-casing",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["!=","brunnel","tunnel"],["in","class","minor","service","track"]]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"rgba(214,93,14,0.8)","line-opacity":{stops:[[12,0],[12.5,1]]},"line-width":{base:1.2,stops:[[12,.5],[13,1],[14,4],[20,15]]}}},{id:"highway-secondary-tertiary-casing",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["!in","brunnel","bridge","tunnel"],["in","class","secondary","tertiary"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#d65d0e","line-opacity":1,"line-width":{base:1.2,stops:[[8,1.5],[20,17]]}}},{id:"highway-primary-casing",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",minzoom:5,filter:["all",["!in","brunnel","bridge","tunnel"],["in","class","primary"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#d65d0e","line-opacity":{stops:[[7,0],[8,1]]},"line-width":{base:1.2,stops:[[7,0],[8,.6],[9,1.5],[20,22]]}}},{id:"highway-trunk-casing",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",minzoom:5,filter:["all",["!in","brunnel","bridge","tunnel"],["in","class","trunk"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#d65d0e","line-opacity":{stops:[[5,0],[6,1]]},"line-width":{base:1.2,stops:[[5,0],[6,.6],[7,1.5],[20,22]]}}},{id:"highway-motorway-casing",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",minzoom:4,filter:["all",["!in","brunnel","bridge","tunnel"],["==","class","motorway"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#d65d0e","line-width":{base:1.2,stops:[[4,0],[5,.4],[6,.6],[7,1.5],[20,22]]},"line-opacity":{stops:[[4,0],[5,1]]}}},{id:"highway-path",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["!in","brunnel","bridge","tunnel"],["==","class","path"]]],paint:{"line-color":"#b48ead","line-dasharray":[1.5,.75],"line-width":{base:1.2,stops:[[15,1.2],[20,4]]}}},{id:"highway-motorway-link",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",minzoom:12,filter:["all",["!in","brunnel","bridge","tunnel"],["==","class","motorway_link"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#ebdbb2","line-width":{base:1.2,stops:[[12.5,0],[13,1.5],[14,2.5],[20,11.5]]}}},{id:"highway-link",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",minzoom:13,filter:["all",["!in","brunnel","bridge","tunnel"],["in","class","primary_link","secondary_link","tertiary_link","trunk_link"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#ebdbb2","line-width":{base:1.2,stops:[[12.5,0],[13,1.5],[14,2.5],[20,11.5]]}}},{id:"highway-minor",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["!=","brunnel","tunnel"],["in","class","minor","service","track"]]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#f49456","line-opacity":1,"line-width":{base:1.2,stops:[[13.5,0],[14,2.5],[20,11.5]]}}},{id:"highway-secondary-tertiary",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["!in","brunnel","bridge","tunnel"],["in","class","secondary","tertiary"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#ebdbb2","line-width":{base:1.2,stops:[[6.5,0],[8,.5],[20,13]]}}},{id:"highway-primary",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["!in","brunnel","bridge","tunnel"],["in","class","primary"]]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#ebdbb2","line-width":{base:1.2,stops:[[8.5,0],[9,.5],[20,18]]}}},{id:"highway-trunk",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["!in","brunnel","bridge","tunnel"],["in","class","trunk"]]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#ebdbb2","line-width":{base:1.2,stops:[[6.5,0],[7,.5],[20,18]]}}},{id:"highway-motorway",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",minzoom:5,filter:["all",["==","$type","LineString"],["all",["!in","brunnel","bridge","tunnel"],["==","class","motorway"]]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#ebdbb2","line-width":{base:1.2,stops:[[6.5,0],[7,.5],[20,18]]}}},{id:"railway-service",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["==","class","rail"],["has","service"]]],paint:{"line-color":"rgba(118,51,8,0.7)","line-width":{base:1.4,stops:[[14,.4],[20,1]]}}},{id:"railway-service-hatching",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["==","class","rail"],["has","service"]]],layout:{visibility:"visible"},paint:{"line-color":"rgba(118,51,8,0.7)","line-dasharray":[.2,8],"line-width":{base:1.4,stops:[[14.5,0],[15,2],[20,6]]}}},{id:"railway",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["!has","service"],["!in","brunnel","bridge","tunnel"],["==","class","rail"]]],paint:{"line-color":"#763308","line-width":{base:1.4,stops:[[14,.4],[15,.75],[20,2]]}}},{id:"railway-hatching",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["!has","service"],["!in","brunnel","bridge","tunnel"],["==","class","rail"]]],paint:{"line-color":"#763308","line-dasharray":[.2,8],"line-width":{base:1.4,stops:[[14.5,0],[15,3],[20,8]]}}},{id:"bridge-motorway-link-casing",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["==","class","motorway_link"]],layout:{"line-join":"round"},paint:{"line-color":"#d65d0e","line-opacity":1,"line-width":{base:1.2,stops:[[12,1],[13,3],[14,4],[20,15]]}}},{id:"bridge-link-casing",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["in","class","primary_link","secondary_link","tertiary_link","trunk_link"]],layout:{"line-join":"round"},paint:{"line-color":"#d65d0e","line-opacity":1,"line-width":{base:1.2,stops:[[12,1],[13,3],[14,4],[20,15]]}}},{id:"bridge-secondary-tertiary-casing",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["in","class","secondary","tertiary"]],layout:{"line-join":"round"},paint:{"line-color":"#d65d0e","line-opacity":1,"line-width":{base:1.2,stops:[[8,1.5],[20,28]]}}},{id:"bridge-trunk-primary-casing",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["in","class","primary","trunk"]],layout:{"line-join":"round"},paint:{"line-color":"#d65d0e","line-width":{base:1.2,stops:[[5,.4],[6,.6],[7,1.5],[20,26]]}}},{id:"bridge-motorway-casing",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["==","class","motorway"]],layout:{"line-join":"round"},paint:{"line-color":"#d65d0e","line-width":{base:1.2,stops:[[5,.4],[6,.6],[7,1.5],[20,22]]}}},{id:"bridge-path-casing",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["==","brunnel","bridge"],["==","class","path"]]],paint:{"line-color":"#f17626","line-width":{base:1.2,stops:[[15,1.2],[20,18]]}}},{id:"bridge-path",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["==","brunnel","bridge"],["==","class","path"]]],paint:{"line-color":"#b48ead","line-width":{base:1.2,stops:[[15,1.2],[20,4]]},"line-dasharray":[1.5,.75]}},{id:"bridge-motorway-link",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["==","class","motorway_link"]],layout:{"line-join":"round"},paint:{"line-color":"#ebdbb2","line-width":{base:1.2,stops:[[12.5,0],[13,1.5],[14,2.5],[20,11.5]]}}},{id:"bridge-link",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["in","class","primary_link","secondary_link","tertiary_link","trunk_link"]],layout:{"line-join":"round"},paint:{"line-color":"#ebdbb2","line-width":{base:1.2,stops:[[12.5,0],[13,1.5],[14,2.5],[20,11.5]]}}},{id:"bridge-secondary-tertiary",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["in","class","secondary","tertiary"]],layout:{"line-join":"round"},paint:{"line-color":"#ebdbb2","line-width":{base:1.2,stops:[[6.5,0],[7,.5],[20,20]]}}},{id:"bridge-trunk-primary",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["in","class","primary","trunk"]],layout:{"line-join":"round"},paint:{"line-color":"#ebdbb2","line-width":{base:1.2,stops:[[6.5,0],[7,.5],[20,18]]}}},{id:"bridge-motorway",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["==","class","motorway"]],layout:{"line-join":"round"},paint:{"line-color":"#ebdbb2","line-width":{base:1.2,stops:[[6.5,0],[7,.5],[20,18]]}}},{id:"bridge-railway",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["==","class","rail"]],paint:{"line-color":"#763308","line-width":{base:1.4,stops:[[14,.4],[15,.75],[20,2]]}}},{id:"bridge-railway-hatching",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["==","class","rail"]],paint:{"line-color":"#763308","line-dasharray":[.2,8],"line-width":{base:1.4,stops:[[14.5,0],[15,3],[20,8]]}}},{id:"boundary-land-level-4",type:"line",source:"openmaptiles","source-layer":"boundary",filter:["all",["in","admin_level",4,6,8],["!=","maritime",1]],layout:{"line-join":"round"},paint:{"line-color":"#8fbcbb","line-dasharray":[3,1,1,1],"line-width":{base:1.4,stops:[[4,.4],[5,1],[12,3]]}}},{id:"boundary-land-level-2",type:"line",source:"openmaptiles","source-layer":"boundary",filter:["all",["==","admin_level",2],["!=","maritime",1]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#8fbcbb","line-width":{base:1,stops:[[0,.6],[4,1.4],[5,2],[12,8]]}}},{id:"boundary-water",type:"line",source:"openmaptiles","source-layer":"boundary",filter:["all",["in","admin_level",2,4],["==","maritime",1]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#8fbcbb","line-width":{base:1,stops:[[0,.6],[4,1.4],[5,2],[12,8]]},"line-opacity":{stops:[[6,.6],[10,1]]}}},{id:"waterway-name",type:"symbol",source:"openmaptiles","source-layer":"waterway",minzoom:13,filter:["all",["==","$type","LineString"],["has","name"],["!has","name:de"]],layout:{"text-font":["Open Sans Italic"],"text-size":14,"text-field":"{name:latin} {name:nonlatin}","text-max-width":5,"text-rotation-alignment":"map","symbol-placement":"line","text-letter-spacing":.2,"symbol-spacing":350},paint:{"text-color":"#fefefe","text-halo-width":1.5,"text-halo-color":"#74aee9"}},{id:"waterway-name-en",type:"symbol",source:"openmaptiles","source-layer":"waterway",minzoom:13,filter:["all",["==","$type","LineString"],["has","name"],["has","name:de"]],layout:{"text-font":["Open Sans Italic"],"text-size":14,"text-field":"{name:de} {name:nonlatin}","text-max-width":5,"text-rotation-alignment":"map","symbol-placement":"line","text-letter-spacing":.2,"symbol-spacing":350},paint:{"text-color":"#fefefe","text-halo-width":1.5,"text-halo-color":"#74aee9"}},{id:"water-name-lakeline",type:"symbol",source:"openmaptiles","source-layer":"water_name",filter:["all",["==","$type","LineString"],["!has","name:de"]],layout:{"text-font":["Open Sans Italic"],"text-size":14,"text-field":"{name:latin} {name:nonlatin}","text-max-width":5,"text-rotation-alignment":"map","symbol-placement":"line","symbol-spacing":350,"text-letter-spacing":.2},paint:{"text-color":"#fefefe","text-halo-width":1.5,"text-halo-color":"#74aee9"}},{id:"water-name-lakeline-en",type:"symbol",source:"openmaptiles","source-layer":"water_name",filter:["all",["==","$type","LineString"],["has","name:de"]],layout:{"text-font":["Open Sans Italic"],"text-size":14,"text-field":"{name:de} {name:nonlatin}","text-max-width":5,"text-rotation-alignment":"map","symbol-placement":"line","symbol-spacing":350,"text-letter-spacing":.2},paint:{"text-color":"#fefefe","text-halo-width":1.5,"text-halo-color":"#74aee9"}},{id:"water-name-ocean",type:"symbol",source:"openmaptiles","source-layer":"water_name",filter:["all",["==","$type","Point"],["==","class","ocean"],["!has","name:de"]],layout:{"text-font":["Open Sans Italic"],"text-size":14,"text-field":`{name:latin}
{name:nonlatin}`,"text-max-width":5,"text-rotation-alignment":"map","symbol-placement":"point","symbol-spacing":350,"text-letter-spacing":.2},paint:{"text-color":"#fefefe","text-halo-width":1.5,"text-halo-color":"#74aee9"}},{id:"water-name-ocean-en",type:"symbol",source:"openmaptiles","source-layer":"water_name",filter:["all",["==","$type","Point"],["==","class","ocean"],["has","name:de"]],layout:{"text-font":["Open Sans Italic"],"text-size":14,"text-field":`{name:de}
{name:nonlatin}`,"text-max-width":5,"text-rotation-alignment":"map","symbol-placement":"point","symbol-spacing":350,"text-letter-spacing":.2},paint:{"text-color":"#fefefe","text-halo-width":1.5,"text-halo-color":"#74aee9"}},{id:"water-name-other",type:"symbol",source:"openmaptiles","source-layer":"water_name",filter:["all",["==","$type","Point"],["!in","class","ocean"],["!has","name:de"]],layout:{"text-font":["Open Sans Italic"],"text-size":{stops:[[0,10],[6,14]]},"text-field":`{name:latin}
{name:nonlatin}`,"text-max-width":5,"text-rotation-alignment":"map","symbol-placement":"point","symbol-spacing":350,"text-letter-spacing":.2,visibility:"visible"},paint:{"text-color":"#fefefe","text-halo-width":1.5,"text-halo-color":"#74aee9"}},{id:"water-name-other-en",type:"symbol",source:"openmaptiles","source-layer":"water_name",filter:["all",["==","$type","Point"],["!in","class","ocean"],["has","name:de"]],layout:{"text-font":["Open Sans Italic"],"text-size":{stops:[[0,10],[6,14]]},"text-field":`{name:de}
{name:nonlatin}`,"text-max-width":5,"text-rotation-alignment":"map","symbol-placement":"point","symbol-spacing":350,"text-letter-spacing":.2,visibility:"visible"},paint:{"text-color":"#fefefe","text-halo-width":1.5,"text-halo-color":"#74aee9"}},{id:"poi-level-3",type:"symbol",source:"openmaptiles","source-layer":"poi",minzoom:16,filter:["all",["==","$type","Point"],[">=","rank",25],["!has","name:de"]],layout:{"text-padding":2,"text-font":["Open Sans Semibold"],"text-anchor":"top","icon-image":"{class}_11","text-field":`{name:latin}
{name:nonlatin}`,"text-offset":[0,.6],"text-size":12,"text-max-width":9},paint:{"text-halo-blur":.5,"text-color":"#fdfdfd","text-halo-width":1,"text-halo-color":"#633"}},{id:"poi-level-3-en",type:"symbol",source:"openmaptiles","source-layer":"poi",minzoom:16,filter:["all",["==","$type","Point"],[">=","rank",25],["has","name:de"]],layout:{"text-padding":2,"text-font":["Open Sans Semibold"],"text-anchor":"top","icon-image":"{class}_11","text-field":`{name:de}
{name:nonlatin}`,"text-offset":[0,.6],"text-size":12,"text-max-width":9},paint:{"text-halo-blur":.5,"text-color":"#fdfdfd","text-halo-width":1,"text-halo-color":"#633"}},{id:"poi-level-2",type:"symbol",source:"openmaptiles","source-layer":"poi",minzoom:15,filter:["all",["==","$type","Point"],["all",["<=","rank",24],[">=","rank",15]],["!has","name:de"]],layout:{"text-padding":2,"text-font":["Open Sans Semibold"],"text-anchor":"top","icon-image":"{class}_11","text-field":`{name:latin}
{name:nonlatin}`,"text-offset":[0,.6],"text-size":12,"text-max-width":9},paint:{"text-halo-blur":.5,"text-color":"#fdfdfd","text-halo-width":1,"text-halo-color":"#633"}},{id:"poi-level-2-en",type:"symbol",source:"openmaptiles","source-layer":"poi",minzoom:15,filter:["all",["==","$type","Point"],["all",["<=","rank",24],[">=","rank",15]],["has","name:de"]],layout:{"text-padding":2,"text-font":["Open Sans Semibold"],"text-anchor":"top","icon-image":"{class}_11","text-field":`{name:de}
{name:nonlatin}`,"text-offset":[0,.6],"text-size":12,"text-max-width":9},paint:{"text-halo-blur":.5,"text-color":"#fdfdfd","text-halo-width":1,"text-halo-color":"#633"}},{id:"poi-level-1",type:"symbol",source:"openmaptiles","source-layer":"poi",minzoom:14,filter:["all",["==","$type","Point"],["all",["<=","rank",14],["has","name"]],["!has","name:de"]],layout:{"text-padding":2,"text-font":["Open Sans Semibold"],"text-anchor":"top","icon-image":"{class}_11","text-field":`{name:latin}
{name:nonlatin}`,"text-offset":[0,.6],"text-size":12,"text-max-width":9},paint:{"text-halo-blur":.5,"text-color":"#fdfdfd","text-halo-width":1,"text-halo-color":"#633"}},{id:"poi-level-1-en",type:"symbol",source:"openmaptiles","source-layer":"poi",minzoom:14,filter:["all",["==","$type","Point"],["all",["<=","rank",14],["has","name"]],["has","name:de"]],layout:{"text-padding":2,"text-font":["Open Sans Semibold"],"text-anchor":"top","icon-image":"{class}_11","text-field":`{name:de}
{name:nonlatin}`,"text-offset":[0,.6],"text-size":12,"text-max-width":9},paint:{"text-halo-blur":.5,"text-color":"#fdfdfd","text-halo-width":1,"text-halo-color":"#633"}},{id:"highway-name-path",type:"symbol",source:"openmaptiles","source-layer":"transportation_name",minzoom:15.5,filter:["all",["==","class","path"],["!has","name:de"]],layout:{"text-size":{base:1,stops:[[13,12],[14,13]]},"text-font":["Open Sans Regular"],"text-field":"{name:latin} {name:nonlatin}","symbol-placement":"line","text-rotation-alignment":"map"},paint:{"text-halo-color":"#f8f4f0","text-color":"hsl(30, 23%, 62%)","text-halo-width":.5}},{id:"highway-name-path-en",type:"symbol",source:"openmaptiles","source-layer":"transportation_name",minzoom:15.5,filter:["all",["==","class","path"],["has","name:de"]],layout:{"text-size":{base:1,stops:[[13,12],[14,13]]},"text-font":["Open Sans Regular"],"text-field":"{name:de} {name:nonlatin}","symbol-placement":"line","text-rotation-alignment":"map"},paint:{"text-halo-color":"#f8f4f0","text-color":"hsl(30, 23%, 62%)","text-halo-width":.5}},{id:"highway-name-minor",type:"symbol",source:"openmaptiles","source-layer":"transportation_name",minzoom:15,filter:["all",["==","$type","LineString"],["in","class","minor","service","track"],["!has","name:de"]],layout:{"text-size":{base:1,stops:[[13,12],[14,13]]},"text-font":["Open Sans Regular"],"text-field":"{name:latin} {name:nonlatin}","symbol-placement":"line","text-rotation-alignment":"map"},paint:{"text-halo-blur":.5,"text-color":"#765","text-halo-width":1}},{id:"highway-name-minor-en",type:"symbol",source:"openmaptiles","source-layer":"transportation_name",minzoom:15,filter:["all",["==","$type","LineString"],["in","class","minor","service","track"],["has","name:de"]],layout:{"text-size":{base:1,stops:[[13,12],[14,13]]},"text-font":["Open Sans Regular"],"text-field":"{name:de} {name:nonlatin}","symbol-placement":"line","text-rotation-alignment":"map"},paint:{"text-halo-blur":.5,"text-color":"#765","text-halo-width":1}},{id:"highway-name-major",type:"symbol",source:"openmaptiles","source-layer":"transportation_name",minzoom:12.2,filter:["all",["in","class","primary","secondary","tertiary","trunk"],["!has","name:de"]],layout:{"text-size":{base:1,stops:[[13,12],[14,13]]},"text-font":["Open Sans Regular"],"text-field":"{name:latin} {name:nonlatin}","symbol-placement":"line","text-rotation-alignment":"map"},paint:{"text-halo-blur":.5,"text-color":"#765","text-halo-width":1}},{id:"highway-name-major-en",type:"symbol",source:"openmaptiles","source-layer":"transportation_name",minzoom:12.2,filter:["all",["in","class","primary","secondary","tertiary","trunk"],["has","name:de"]],layout:{"text-size":{base:1,stops:[[13,12],[14,13]]},"text-font":["Open Sans Regular"],"text-field":"{name:de} {name:nonlatin}","symbol-placement":"line","text-rotation-alignment":"map"},paint:{"text-halo-blur":.5,"text-color":"#765","text-halo-width":1}},{id:"highway-shield",type:"symbol",source:"openmaptiles","source-layer":"transportation_name",minzoom:8,filter:["all",["<=","ref_length",6],["==","$type","LineString"],["!in","network","us-interstate","us-highway","us-state"]],layout:{"text-size":10,"icon-image":"road_{ref_length}","icon-rotation-alignment":"viewport","symbol-spacing":200,"text-font":["Open Sans Semibold"],"symbol-placement":{base:1,stops:[[10,"point"],[11,"line"]]},"text-rotation-alignment":"viewport","icon-size":1,"text-field":"{ref}"},paint:{}},{id:"highway-shield-us-interstate",type:"symbol",source:"openmaptiles","source-layer":"transportation_name",minzoom:7,filter:["all",["<=","ref_length",6],["==","$type","LineString"],["in","network","us-interstate"]],layout:{"text-size":10,"icon-image":"{network}_{ref_length}","icon-rotation-alignment":"viewport","symbol-spacing":200,"text-font":["Open Sans Semibold"],"symbol-placement":{base:1,stops:[[7,"point"],[7,"line"],[8,"line"]]},"text-rotation-alignment":"viewport","icon-size":1,"text-field":"{ref}"},paint:{"text-color":"rgba(0, 0, 0, 1)"}},{id:"highway-shield-us-other",type:"symbol",source:"openmaptiles","source-layer":"transportation_name",minzoom:9,filter:["all",["<=","ref_length",6],["==","$type","LineString"],["in","network","us-highway","us-state"]],layout:{"text-size":10,"icon-image":"{network}_{ref_length}","icon-rotation-alignment":"viewport","symbol-spacing":200,"text-font":["Open Sans Semibold"],"symbol-placement":{base:1,stops:[[10,"point"],[11,"line"]]},"text-rotation-alignment":"viewport","icon-size":1,"text-field":"{ref}"},paint:{"text-color":"rgba(0, 0, 0, 1)"}},{id:"place-other",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["!in","class","city","town","village"],["!has","name:de"]],layout:{"text-letter-spacing":.1,"text-size":{base:1.2,stops:[[12,10],[15,14]]},"text-font":["Open Sans Bold"],"text-field":`{name:latin}
{name:nonlatin}`,"text-transform":"uppercase","text-max-width":9},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-other-en",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["!in","class","city","town","village"],["has","name:de"]],layout:{"text-letter-spacing":.1,"text-size":{base:1.2,stops:[[12,10],[15,14]]},"text-font":["Open Sans Bold"],"text-field":`{name:de}
{name:nonlatin}`,"text-transform":"uppercase","text-max-width":9},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-village",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","village"],["!has","name:de"]],layout:{"text-font":["Open Sans Regular"],"text-size":{base:1.2,stops:[[10,12],[15,22]]},"text-field":`{name:latin}
{name:nonlatin}`,"text-max-width":8},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-village-en",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","village"],["has","name:de"]],layout:{"text-font":["Open Sans Regular"],"text-size":{base:1.2,stops:[[10,12],[15,22]]},"text-field":`{name:de}
{name:nonlatin}`,"text-max-width":8},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-town",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","town"],["!has","name:de"]],layout:{"text-font":["Open Sans Regular"],"text-size":{base:1.2,stops:[[10,14],[15,24]]},"text-field":`{name:latin}
{name:nonlatin}`,"text-max-width":8},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-town-en",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","town"],["has","name:de"]],layout:{"text-font":["Open Sans Regular"],"text-size":{base:1.2,stops:[[10,14],[15,24]]},"text-field":`{name:de}
{name:nonlatin}`,"text-max-width":8},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-city",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["!=","capital",2],["==","class","city"],["!has","name:de"]],layout:{"text-font":["Open Sans Semibold"],"text-size":{base:1.2,stops:[[7,14],[11,24]]},"text-field":`{name:latin}
{name:nonlatin}`,"text-max-width":8},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-city-en",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["!=","capital",2],["==","class","city"],["has","name:de"]],layout:{"text-font":["Open Sans Semibold"],"text-size":{base:1.2,stops:[[7,14],[11,24]]},"text-field":`{name:de}
{name:nonlatin}`,"text-max-width":8},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-city-capital",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","capital",2],["==","class","city"],["!has","name:de"]],layout:{"text-font":["Open Sans Semibold"],"text-size":{base:1.2,stops:[[7,14],[11,24]]},"text-field":`{name:latin}
{name:nonlatin}`,"text-max-width":8,"icon-image":"star_11","text-offset":[.4,0],"icon-size":.8,"text-anchor":"left"},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-city-capital-en",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","capital",2],["==","class","city"],["has","name:de"]],layout:{"text-font":["Open Sans Semibold"],"text-size":{base:1.2,stops:[[7,14],[11,24]]},"text-field":`{name:de}
{name:nonlatin}`,"text-max-width":8,"icon-image":"star_11","text-offset":[.4,0],"icon-size":.8,"text-anchor":"left"},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-country-3",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","country"],[">=","rank",3],["!has","name:de"]],layout:{"text-font":["Open Sans Bold"],"text-field":`{name:latin}
{name:nonlatin}`,"text-size":{stops:[[3,11],[7,17]]},"text-transform":"uppercase","text-max-width":6.25},paint:{"text-halo-blur":1,"text-color":"#fdfdfd","text-halo-width":2,"text-halo-color":"#433"}},{id:"place-country-3-en",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","country"],[">=","rank",3],["has","name:de"]],layout:{"text-font":["Open Sans Bold"],"text-field":`{name:de}
{name:nonlatin}`,"text-size":{stops:[[3,11],[7,17]]},"text-transform":"uppercase","text-max-width":6.25},paint:{"text-halo-blur":1,"text-color":"#fdfdfd","text-halo-width":2,"text-halo-color":"#433"}},{id:"place-country-2",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","country"],["==","rank",2],["!has","name:de"]],layout:{"text-font":["Open Sans Bold"],"text-field":`{name:latin}
{name:nonlatin}`,"text-size":{stops:[[2,11],[5,17]]},"text-transform":"uppercase","text-max-width":6.25},paint:{"text-halo-blur":1,"text-color":"#fdfdfd","text-halo-width":2,"text-halo-color":"#433"}},{id:"place-country-2-en",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","country"],["==","rank",2],["has","name:de"]],layout:{"text-font":["Open Sans Bold"],"text-field":`{name:de}
{name:nonlatin}`,"text-size":{stops:[[2,11],[5,17]]},"text-transform":"uppercase","text-max-width":6.25},paint:{"text-halo-blur":1,"text-color":"#fdfdfd","text-halo-width":2,"text-halo-color":"#433"}},{id:"place-country-1",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","country"],["==","rank",1],["!has","name:de"]],layout:{"text-font":["Open Sans Bold"],"text-field":`{name:latin}
{name:nonlatin}`,"text-size":{stops:[[1,11],[4,17]]},"text-transform":"uppercase","text-max-width":6.25},paint:{"text-halo-blur":1,"text-color":"#fdfdfd","text-halo-width":2,"text-halo-color":"#433"}},{id:"place-country-1-en",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","country"],["==","rank",1],["has","name:de"]],layout:{"text-font":["Open Sans Bold"],"text-field":`{name:de}
{name:nonlatin}`,"text-size":{stops:[[1,11],[4,17]]},"text-transform":"uppercase","text-max-width":6.25},paint:{"text-halo-blur":1,"text-color":"#fdfdfd","text-halo-width":2,"text-halo-color":"#433"}},{id:"place-continent",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",maxzoom:1,filter:["all",["==","class","continent"],["!has","name:de"]],layout:{"text-font":["Open Sans Bold"],"text-field":`{name:latin}
{name:nonlatin}`,"text-size":14,"text-max-width":6.25,"text-transform":"uppercase"},paint:{"text-halo-blur":1,"text-color":"#fdfdfd","text-halo-width":2,"text-halo-color":"#433"}},{id:"place-continent-en",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",maxzoom:1,filter:["all",["==","class","continent"],["has","name:de"]],layout:{"text-font":["Open Sans Bold"],"text-field":`{name:de}
{name:nonlatin}`,"text-size":14,"text-max-width":6.25,"text-transform":"uppercase"},paint:{"text-halo-blur":1,"text-color":"#fdfdfd","text-halo-width":2,"text-halo-color":"#433"}}]},MNe={version:8,name:"Medieval Kingdom",center:[8.542,47.372],zoom:11.6,bearing:0,pitch:0,sources:{openmaptiles:{type:"vector",url:$u.source_openmaptiles_url}},sprite:$u.sprite,glyphs:$u.glyphs,layers:[{id:"background",type:"background",paint:{"background-color":"#ffd1a8"}},{id:"landcover-glacier",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landcover",filter:["==","subclass","glacier"],layout:{visibility:"visible"},paint:{"fill-color":"#228B22","fill-opacity":{base:1,stops:[[0,.9],[10,.3]]}}},{id:"landuse-residential",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landuse",filter:["==","class","residential"],paint:{"fill-color":"#bfa677"}},{id:"landuse-commercial",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landuse",filter:["all",["==","$type","Polygon"],["==","class","commercial"]],paint:{"fill-color":"#c5af85"}},{id:"landuse-industrial",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landuse",filter:["all",["==","$type","Polygon"],["==","class","industrial"]],paint:{"fill-color":"#ccb892"}},{id:"park",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"park",filter:["==","$type","Polygon"],paint:{"fill-color":"#556B2F","fill-opacity":{base:1.8,stops:[[9,.5],[12,.2]]}}},{id:"park-outline",type:"line",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"park",filter:["==","$type","Polygon"],layout:{},paint:{"line-color":"rgba(85,107,47,0.6)","line-dasharray":[3,3]}},{id:"landuse-cemetery",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landuse",filter:["==","class","cemetery"],paint:{"fill-color":"#d1e0b8"}},{id:"landuse-hospital",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landuse",filter:["==","class","hospital"],paint:{"fill-color":"#FFC0CB"}},{id:"landuse-school",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landuse",filter:["==","class","school"],paint:{"fill-color":"rgba(255,192,203,0.8)"}},{id:"landuse-railway",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landuse",filter:["==","class","railway"],paint:{"fill-color":"rgba(149,46,46,0.4)"}},{id:"landcover-wood",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landcover",filter:["==","class","wood"],paint:{"fill-color":"#228B22","fill-opacity":.1,"fill-outline-color":"hsla(0, 0%, 0%, 0.03)","fill-antialias":{base:1,stops:[[0,!1],[9,!0]]}}},{id:"landcover-grass",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landcover",filter:["==","class","grass"],paint:{"fill-color":"#556B2F","fill-opacity":1}},{id:"landcover-grass-park",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"park",filter:["==","class","public_park"],paint:{"fill-color":"#556B2F","fill-opacity":.8}},{id:"waterway-other",type:"line",metadata:{"mapbox:group":"1444849382550.77"},source:"openmaptiles","source-layer":"waterway",filter:["!in","class","canal","river","stream"],layout:{"line-cap":"round"},paint:{"line-color":"#1E90FF","line-width":{base:1.3,stops:[[13,.5],[20,2]]}}},{id:"waterway-stream-canal",type:"line",metadata:{"mapbox:group":"1444849382550.77"},source:"openmaptiles","source-layer":"waterway",filter:["in","class","canal","stream"],layout:{"line-cap":"round"},paint:{"line-color":"#1E90FF","line-width":{base:1.3,stops:[[13,.5],[20,6]]}}},{id:"waterway-river",type:"line",metadata:{"mapbox:group":"1444849382550.77"},source:"openmaptiles","source-layer":"waterway",filter:["==","class","river"],layout:{"line-cap":"round"},paint:{"line-color":"#1E90FF","line-width":{base:1.2,stops:[[10,.8],[20,6]]}}},{id:"water-offset",type:"fill",metadata:{"mapbox:group":"1444849382550.77"},source:"openmaptiles","source-layer":"water",maxzoom:8,filter:["==","$type","Polygon"],layout:{visibility:"visible"},paint:{"fill-opacity":1,"fill-color":"#1E90FF","fill-translate":{base:1,stops:[[6,[2,0]],[8,[0,0]]]}}},{id:"water",type:"fill",metadata:{"mapbox:group":"1444849382550.77"},source:"openmaptiles","source-layer":"water",layout:{visibility:"visible"},paint:{"fill-color":"#006ad1"}},{id:"water-pattern",type:"fill",metadata:{"mapbox:group":"1444849382550.77"},source:"openmaptiles","source-layer":"water",layout:{visibility:"visible"},paint:{"fill-translate":[0,2.5],"fill-pattern":"wave"}},{id:"landcover-ice-shelf",type:"fill",metadata:{"mapbox:group":"1444849382550.77"},source:"openmaptiles","source-layer":"landcover",filter:["==","subclass","ice_shelf"],layout:{visibility:"visible"},paint:{"fill-color":"#228B22","fill-opacity":{base:1,stops:[[0,.9],[10,.3]]}}},{id:"building",type:"fill",metadata:{"mapbox:group":"1444849364238.8171"},source:"openmaptiles","source-layer":"building",paint:{"fill-color":"#f9e9cb","fill-antialias":!0}},{id:"building-top",type:"fill",metadata:{"mapbox:group":"1444849364238.8171"},source:"openmaptiles","source-layer":"building",layout:{visibility:"visible"},paint:{"fill-translate":{base:1,stops:[[14,[0,0]],[16,[-2,-2]]]},"fill-outline-color":"#dfdbd7","fill-color":"#fefcf9","fill-opacity":{base:1,stops:[[13,0],[16,1]]}}},{id:"tunnel-service-track-casing",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["in","class","service","track"]],layout:{"line-join":"round"},paint:{"line-color":"#CD5C5C","line-dasharray":[.5,.25],"line-width":{base:1.2,stops:[[15,1],[16,4],[20,11]]}}},{id:"tunnel-minor-casing",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["==","class","minor"]],layout:{"line-join":"round"},paint:{"line-color":"#CD5C5C","line-opacity":{stops:[[12,0],[12.5,1]]},"line-width":{base:1.2,stops:[[12,.5],[13,1],[14,4],[20,15]]}}},{id:"tunnel-secondary-tertiary-casing",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["in","class","secondary","tertiary"]],layout:{"line-join":"round"},paint:{"line-color":"#CD5C5C","line-opacity":1,"line-width":{base:1.2,stops:[[8,1.5],[20,17]]}}},{id:"tunnel-trunk-primary-casing",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["in","class","primary","trunk"]],layout:{"line-join":"round"},paint:{"line-color":"#CD5C5C","line-width":{base:1.2,stops:[[5,.4],[6,.6],[7,1.5],[20,22]]}}},{id:"tunnel-motorway-casing",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["==","class","motorway"]],layout:{"line-join":"round",visibility:"visible"},paint:{"line-color":"#CD5C5C","line-dasharray":[.5,.25],"line-width":{base:1.2,stops:[[5,.4],[6,.6],[7,1.5],[20,22]]}}},{id:"tunnel-path",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["==","brunnel","tunnel"],["==","class","path"]]],paint:{"line-color":"#d98383","line-dasharray":[1.5,.75],"line-width":{base:1.2,stops:[[15,1.2],[20,4]]}}},{id:"tunnel-service-track",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["in","class","service","track"]],layout:{"line-join":"round"},paint:{"line-color":"#d98383","line-width":{base:1.2,stops:[[15.5,0],[16,2],[20,7.5]]}}},{id:"tunnel-minor",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["==","class","minor_road"]],layout:{"line-join":"round"},paint:{"line-color":"#d98383","line-opacity":1,"line-width":{base:1.2,stops:[[13.5,0],[14,2.5],[20,11.5]]}}},{id:"tunnel-secondary-tertiary",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["in","class","secondary","tertiary"]],layout:{"line-join":"round"},paint:{"line-color":"#df9797","line-width":{base:1.2,stops:[[6.5,0],[7,.5],[20,10]]}}},{id:"tunnel-trunk-primary",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["in","class","primary","trunk"]],layout:{"line-join":"round"},paint:{"line-color":"#CD5C5C","line-width":{base:1.2,stops:[[6.5,0],[7,.5],[20,18]]}}},{id:"tunnel-motorway",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["==","class","motorway"]],layout:{"line-join":"round",visibility:"visible"},paint:{"line-color":"rgba(139,94,6,0.8)","line-width":{base:1.2,stops:[[6.5,0],[7,.5],[20,18]]}}},{id:"tunnel-railway",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["==","class","rail"]],paint:{"line-color":"#952e2e","line-width":{base:1.4,stops:[[14,.4],[15,.75],[20,2]]},"line-dasharray":[2,2]}},{id:"aeroway-taxiway-casing",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"aeroway",minzoom:12,filter:["all",["in","class","taxiway"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#952e2e","line-width":{base:1.5,stops:[[11,2],[17,12]]},"line-opacity":1}},{id:"aeroway-runway-casing",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"aeroway",minzoom:12,filter:["all",["in","class","runway"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#952e2e","line-width":{base:1.5,stops:[[11,5],[17,55]]},"line-opacity":1}},{id:"aeroway-area",type:"fill",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"aeroway",minzoom:4,filter:["all",["==","$type","Polygon"],["in","class","runway","taxiway"]],layout:{visibility:"visible"},paint:{"fill-opacity":{base:1,stops:[[13,0],[14,1]]},"fill-color":"rgba(205,92,92,0.5)"}},{id:"aeroway-taxiway",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"aeroway",minzoom:4,filter:["all",["in","class","taxiway"],["==","$type","LineString"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#df9797","line-width":{base:1.5,stops:[[11,1],[17,10]]},"line-opacity":{base:1,stops:[[11,0],[12,1]]}}},{id:"aeroway-runway",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"aeroway",minzoom:4,filter:["all",["in","class","runway"],["==","$type","LineString"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#df9797","line-width":{base:1.5,stops:[[11,4],[17,50]]},"line-opacity":{base:1,stops:[[11,0],[12,1]]}}},{id:"highway-area",type:"fill",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["==","$type","Polygon"],layout:{visibility:"visible"},paint:{"fill-color":"#bc3a3a","fill-outline-color":"#cfcdca","fill-opacity":.9,"fill-antialias":!1}},{id:"highway-motorway-link-casing",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",minzoom:12,filter:["all",["!in","brunnel","bridge","tunnel"],["==","class","motorway_link"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#CD5C5C","line-opacity":1,"line-width":{base:1.2,stops:[[12,1],[13,3],[14,4],[20,15]]}}},{id:"highway-link-casing",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",minzoom:13,filter:["all",["!in","brunnel","bridge","tunnel"],["in","class","primary_link","secondary_link","tertiary_link","trunk_link"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#CD5C5C","line-opacity":1,"line-width":{base:1.2,stops:[[12,1],[13,3],[14,4],[20,15]]}}},{id:"highway-minor-casing",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["!=","brunnel","tunnel"],["in","class","minor","service","track"]]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"rgba(205,92,92,0.8)","line-opacity":{stops:[[12,0],[12.5,1]]},"line-width":{base:1.2,stops:[[12,.5],[13,1],[14,4],[20,15]]}}},{id:"highway-secondary-tertiary-casing",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["!in","brunnel","bridge","tunnel"],["in","class","secondary","tertiary"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#CD5C5C","line-opacity":1,"line-width":{base:1.2,stops:[[8,1.5],[20,17]]}}},{id:"highway-primary-casing",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",minzoom:5,filter:["all",["!in","brunnel","bridge","tunnel"],["in","class","primary"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#CD5C5C","line-opacity":{stops:[[7,0],[8,1]]},"line-width":{base:1.2,stops:[[7,0],[8,.6],[9,1.5],[20,22]]}}},{id:"highway-trunk-casing",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",minzoom:5,filter:["all",["!in","brunnel","bridge","tunnel"],["in","class","trunk"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#CD5C5C","line-opacity":{stops:[[5,0],[6,1]]},"line-width":{base:1.2,stops:[[5,0],[6,.6],[7,1.5],[20,22]]}}},{id:"highway-motorway-casing",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",minzoom:4,filter:["all",["!in","brunnel","bridge","tunnel"],["==","class","motorway"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#CD5C5C","line-width":{base:1.2,stops:[[4,0],[5,.4],[6,.6],[7,1.5],[20,22]]},"line-opacity":{stops:[[4,0],[5,1]]}}},{id:"highway-path",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["!in","brunnel","bridge","tunnel"],["==","class","path"]]],paint:{"line-color":"#FFC0CB","line-dasharray":[1.5,.75],"line-width":{base:1.2,stops:[[15,1.2],[20,4]]}}},{id:"highway-motorway-link",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",minzoom:12,filter:["all",["!in","brunnel","bridge","tunnel"],["==","class","motorway_link"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#8b5e3c","line-width":{base:1.2,stops:[[12.5,0],[13,1.5],[14,2.5],[20,11.5]]}}},{id:"highway-link",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",minzoom:13,filter:["all",["!in","brunnel","bridge","tunnel"],["in","class","primary_link","secondary_link","tertiary_link","trunk_link"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#8B5E3C","line-width":{base:1.2,stops:[[12.5,0],[13,1.5],[14,2.5],[20,11.5]]}}},{id:"highway-minor",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["!=","brunnel","tunnel"],["in","class","minor","service","track"]]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#e5aaaa","line-opacity":1,"line-width":{base:1.2,stops:[[13.5,0],[14,2.5],[20,11.5]]}}},{id:"highway-secondary-tertiary",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["!in","brunnel","bridge","tunnel"],["in","class","secondary","tertiary"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#8B5E3C","line-width":{base:1.2,stops:[[6.5,0],[8,.5],[20,13]]}}},{id:"highway-primary",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["!in","brunnel","bridge","tunnel"],["in","class","primary"]]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#8B5E3C","line-width":{base:1.2,stops:[[8.5,0],[9,.5],[20,18]]}}},{id:"highway-trunk",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["!in","brunnel","bridge","tunnel"],["in","class","trunk"]]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#8B5E3C","line-width":{base:1.2,stops:[[6.5,0],[7,.5],[20,18]]}}},{id:"highway-motorway",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",minzoom:5,filter:["all",["==","$type","LineString"],["all",["!in","brunnel","bridge","tunnel"],["==","class","motorway"]]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#8b5e3c","line-width":{base:1.2,stops:[[6.5,0],[7,.5],[20,18]]}}},{id:"railway-service",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["==","class","rail"],["has","service"]]],paint:{"line-color":"rgba(149,46,46,0.7)","line-width":{base:1.4,stops:[[14,.4],[20,1]]}}},{id:"railway-service-hatching",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["==","class","rail"],["has","service"]]],layout:{visibility:"visible"},paint:{"line-color":"rgba(149,46,46,0.7)","line-dasharray":[.2,8],"line-width":{base:1.4,stops:[[14.5,0],[15,2],[20,6]]}}},{id:"railway",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["!has","service"],["!in","brunnel","bridge","tunnel"],["==","class","rail"]]],paint:{"line-color":"#952e2e","line-width":{base:1.4,stops:[[14,.4],[15,.75],[20,2]]}}},{id:"railway-hatching",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["!has","service"],["!in","brunnel","bridge","tunnel"],["==","class","rail"]]],paint:{"line-color":"#952e2e","line-dasharray":[.2,8],"line-width":{base:1.4,stops:[[14.5,0],[15,3],[20,8]]}}},{id:"bridge-motorway-link-casing",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["==","class","motorway_link"]],layout:{"line-join":"round"},paint:{"line-color":"#CD5C5C","line-opacity":1,"line-width":{base:1.2,stops:[[12,1],[13,3],[14,4],[20,15]]}}},{id:"bridge-link-casing",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["in","class","primary_link","secondary_link","tertiary_link","trunk_link"]],layout:{"line-join":"round"},paint:{"line-color":"#CD5C5C","line-opacity":1,"line-width":{base:1.2,stops:[[12,1],[13,3],[14,4],[20,15]]}}},{id:"bridge-secondary-tertiary-casing",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["in","class","secondary","tertiary"]],layout:{"line-join":"round"},paint:{"line-color":"#CD5C5C","line-opacity":1,"line-width":{base:1.2,stops:[[8,1.5],[20,28]]}}},{id:"bridge-trunk-primary-casing",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["in","class","primary","trunk"]],layout:{"line-join":"round"},paint:{"line-color":"#CD5C5C","line-width":{base:1.2,stops:[[5,.4],[6,.6],[7,1.5],[20,26]]}}},{id:"bridge-motorway-casing",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["==","class","motorway"]],layout:{"line-join":"round"},paint:{"line-color":"#CD5C5C","line-width":{base:1.2,stops:[[5,.4],[6,.6],[7,1.5],[20,22]]}}},{id:"bridge-path-casing",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["==","brunnel","bridge"],["==","class","path"]]],paint:{"line-color":"#d98383","line-width":{base:1.2,stops:[[15,1.2],[20,18]]}}},{id:"bridge-path",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["==","brunnel","bridge"],["==","class","path"]]],paint:{"line-color":"#FFC0CB","line-width":{base:1.2,stops:[[15,1.2],[20,4]]},"line-dasharray":[1.5,.75]}},{id:"bridge-motorway-link",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["==","class","motorway_link"]],layout:{"line-join":"round"},paint:{"line-color":"#8b5e3c","line-width":{base:1.2,stops:[[12.5,0],[13,1.5],[14,2.5],[20,11.5]]}}},{id:"bridge-link",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["in","class","primary_link","secondary_link","tertiary_link","trunk_link"]],layout:{"line-join":"round"},paint:{"line-color":"#8B5E3C","line-width":{base:1.2,stops:[[12.5,0],[13,1.5],[14,2.5],[20,11.5]]}}},{id:"bridge-secondary-tertiary",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["in","class","secondary","tertiary"]],layout:{"line-join":"round"},paint:{"line-color":"#8B5E3C","line-width":{base:1.2,stops:[[6.5,0],[7,.5],[20,20]]}}},{id:"bridge-trunk-primary",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["in","class","primary","trunk"]],layout:{"line-join":"round"},paint:{"line-color":"#8B5E3C","line-width":{base:1.2,stops:[[6.5,0],[7,.5],[20,18]]}}},{id:"bridge-motorway",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["==","class","motorway"]],layout:{"line-join":"round"},paint:{"line-color":"#8b5e3c","line-width":{base:1.2,stops:[[6.5,0],[7,.5],[20,18]]}}},{id:"bridge-railway",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["==","class","rail"]],paint:{"line-color":"#952e2e","line-width":{base:1.4,stops:[[14,.4],[15,.75],[20,2]]}}},{id:"bridge-railway-hatching",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["==","class","rail"]],paint:{"line-color":"#952e2e","line-dasharray":[.2,8],"line-width":{base:1.4,stops:[[14.5,0],[15,3],[20,8]]}}},{id:"boundary-land-level-4",type:"line",source:"openmaptiles","source-layer":"boundary",filter:["all",["in","admin_level",4,6,8],["!=","maritime",1]],layout:{"line-join":"round"},paint:{"line-color":"#A0522D","line-dasharray":[3,1,1,1],"line-width":{base:1.4,stops:[[4,.4],[5,1],[12,3]]}}},{id:"boundary-land-level-2",type:"line",source:"openmaptiles","source-layer":"boundary",filter:["all",["==","admin_level",2],["!=","maritime",1]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#A0522D","line-width":{base:1,stops:[[0,.6],[4,1.4],[5,2],[12,8]]}}},{id:"boundary-water",type:"line",source:"openmaptiles","source-layer":"boundary",filter:["all",["in","admin_level",2,4],["==","maritime",1]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#1E90FF","line-width":{base:1,stops:[[0,.6],[4,1.4],[5,2],[12,8]]},"line-opacity":{stops:[[6,.6],[10,1]]}}},{id:"waterway-name",type:"symbol",source:"openmaptiles","source-layer":"waterway",minzoom:13,filter:["all",["==","$type","LineString"],["has","name"],["!has","name:de"]],layout:{"text-font":["Open Sans Italic"],"text-size":14,"text-field":"{name:latin} {name:nonlatin}","text-max-width":5,"text-rotation-alignment":"map","symbol-placement":"line","text-letter-spacing":.2,"symbol-spacing":350},paint:{"text-color":"#fefefe","text-halo-width":1.5,"text-halo-color":"#74aee9"}},{id:"waterway-name-en",type:"symbol",source:"openmaptiles","source-layer":"waterway",minzoom:13,filter:["all",["==","$type","LineString"],["has","name"],["has","name:de"]],layout:{"text-font":["Open Sans Italic"],"text-size":14,"text-field":"{name:de} {name:nonlatin}","text-max-width":5,"text-rotation-alignment":"map","symbol-placement":"line","text-letter-spacing":.2,"symbol-spacing":350},paint:{"text-color":"#fefefe","text-halo-width":1.5,"text-halo-color":"#74aee9"}},{id:"water-name-lakeline",type:"symbol",source:"openmaptiles","source-layer":"water_name",filter:["all",["==","$type","LineString"],["!has","name:de"]],layout:{"text-font":["Open Sans Italic"],"text-size":14,"text-field":"{name:latin} {name:nonlatin}","text-max-width":5,"text-rotation-alignment":"map","symbol-placement":"line","symbol-spacing":350,"text-letter-spacing":.2},paint:{"text-color":"#fefefe","text-halo-width":1.5,"text-halo-color":"#74aee9"}},{id:"water-name-lakeline-en",type:"symbol",source:"openmaptiles","source-layer":"water_name",filter:["all",["==","$type","LineString"],["has","name:de"]],layout:{"text-font":["Open Sans Italic"],"text-size":14,"text-field":"{name:de} {name:nonlatin}","text-max-width":5,"text-rotation-alignment":"map","symbol-placement":"line","symbol-spacing":350,"text-letter-spacing":.2},paint:{"text-color":"#fefefe","text-halo-width":1.5,"text-halo-color":"#74aee9"}},{id:"water-name-ocean",type:"symbol",source:"openmaptiles","source-layer":"water_name",filter:["all",["==","$type","Point"],["==","class","ocean"],["!has","name:de"]],layout:{"text-font":["Open Sans Italic"],"text-size":14,"text-field":`{name:latin}
{name:nonlatin}`,"text-max-width":5,"text-rotation-alignment":"map","symbol-placement":"point","symbol-spacing":350,"text-letter-spacing":.2},paint:{"text-color":"#fefefe","text-halo-width":1.5,"text-halo-color":"#74aee9"}},{id:"water-name-ocean-en",type:"symbol",source:"openmaptiles","source-layer":"water_name",filter:["all",["==","$type","Point"],["==","class","ocean"],["has","name:de"]],layout:{"text-font":["Open Sans Italic"],"text-size":14,"text-field":`{name:de}
{name:nonlatin}`,"text-max-width":5,"text-rotation-alignment":"map","symbol-placement":"point","symbol-spacing":350,"text-letter-spacing":.2},paint:{"text-color":"#fefefe","text-halo-width":1.5,"text-halo-color":"#74aee9"}},{id:"water-name-other",type:"symbol",source:"openmaptiles","source-layer":"water_name",filter:["all",["==","$type","Point"],["!in","class","ocean"],["!has","name:de"]],layout:{"text-font":["Open Sans Italic"],"text-size":{stops:[[0,10],[6,14]]},"text-field":`{name:latin}
{name:nonlatin}`,"text-max-width":5,"text-rotation-alignment":"map","symbol-placement":"point","symbol-spacing":350,"text-letter-spacing":.2,visibility:"visible"},paint:{"text-color":"#fefefe","text-halo-width":1.5,"text-halo-color":"#74aee9"}},{id:"water-name-other-en",type:"symbol",source:"openmaptiles","source-layer":"water_name",filter:["all",["==","$type","Point"],["!in","class","ocean"],["has","name:de"]],layout:{"text-font":["Open Sans Italic"],"text-size":{stops:[[0,10],[6,14]]},"text-field":`{name:de}
{name:nonlatin}`,"text-max-width":5,"text-rotation-alignment":"map","symbol-placement":"point","symbol-spacing":350,"text-letter-spacing":.2,visibility:"visible"},paint:{"text-color":"#fefefe","text-halo-width":1.5,"text-halo-color":"#74aee9"}},{id:"poi-level-3",type:"symbol",source:"openmaptiles","source-layer":"poi",minzoom:16,filter:["all",["==","$type","Point"],[">=","rank",25],["!has","name:de"]],layout:{"text-padding":2,"text-font":["Open Sans Semibold"],"text-anchor":"top","icon-image":"{class}_11","text-field":`{name:latin}
{name:nonlatin}`,"text-offset":[0,.6],"text-size":12,"text-max-width":9},paint:{"text-halo-blur":.5,"text-color":"#fdfdfd","text-halo-width":1,"text-halo-color":"#633"}},{id:"poi-level-3-en",type:"symbol",source:"openmaptiles","source-layer":"poi",minzoom:16,filter:["all",["==","$type","Point"],[">=","rank",25],["has","name:de"]],layout:{"text-padding":2,"text-font":["Open Sans Semibold"],"text-anchor":"top","icon-image":"{class}_11","text-field":`{name:de}
{name:nonlatin}`,"text-offset":[0,.6],"text-size":12,"text-max-width":9},paint:{"text-halo-blur":.5,"text-color":"#fdfdfd","text-halo-width":1,"text-halo-color":"#633"}},{id:"poi-level-2",type:"symbol",source:"openmaptiles","source-layer":"poi",minzoom:15,filter:["all",["==","$type","Point"],["all",["<=","rank",24],[">=","rank",15]],["!has","name:de"]],layout:{"text-padding":2,"text-font":["Open Sans Semibold"],"text-anchor":"top","icon-image":"{class}_11","text-field":`{name:latin}
{name:nonlatin}`,"text-offset":[0,.6],"text-size":12,"text-max-width":9},paint:{"text-halo-blur":.5,"text-color":"#fdfdfd","text-halo-width":1,"text-halo-color":"#633"}},{id:"poi-level-2-en",type:"symbol",source:"openmaptiles","source-layer":"poi",minzoom:15,filter:["all",["==","$type","Point"],["all",["<=","rank",24],[">=","rank",15]],["has","name:de"]],layout:{"text-padding":2,"text-font":["Open Sans Semibold"],"text-anchor":"top","icon-image":"{class}_11","text-field":`{name:de}
{name:nonlatin}`,"text-offset":[0,.6],"text-size":12,"text-max-width":9},paint:{"text-halo-blur":.5,"text-color":"#fdfdfd","text-halo-width":1,"text-halo-color":"#633"}},{id:"poi-level-1",type:"symbol",source:"openmaptiles","source-layer":"poi",minzoom:14,filter:["all",["==","$type","Point"],["all",["<=","rank",14],["has","name"]],["!has","name:de"]],layout:{"text-padding":2,"text-font":["Open Sans Semibold"],"text-anchor":"top","icon-image":"{class}_11","text-field":`{name:latin}
{name:nonlatin}`,"text-offset":[0,.6],"text-size":12,"text-max-width":9},paint:{"text-halo-blur":.5,"text-color":"#fdfdfd","text-halo-width":1,"text-halo-color":"#633"}},{id:"poi-level-1-en",type:"symbol",source:"openmaptiles","source-layer":"poi",minzoom:14,filter:["all",["==","$type","Point"],["all",["<=","rank",14],["has","name"]],["has","name:de"]],layout:{"text-padding":2,"text-font":["Open Sans Semibold"],"text-anchor":"top","icon-image":"{class}_11","text-field":`{name:de}
{name:nonlatin}`,"text-offset":[0,.6],"text-size":12,"text-max-width":9},paint:{"text-halo-blur":.5,"text-color":"#fdfdfd","text-halo-width":1,"text-halo-color":"#633"}},{id:"highway-name-path",type:"symbol",source:"openmaptiles","source-layer":"transportation_name",minzoom:15.5,filter:["all",["==","class","path"],["!has","name:de"]],layout:{"text-size":{base:1,stops:[[13,12],[14,13]]},"text-font":["Open Sans Regular"],"text-field":"{name:latin} {name:nonlatin}","symbol-placement":"line","text-rotation-alignment":"map"},paint:{"text-halo-color":"#f8f4f0","text-color":"hsl(30, 23%, 62%)","text-halo-width":.5}},{id:"highway-name-path-en",type:"symbol",source:"openmaptiles","source-layer":"transportation_name",minzoom:15.5,filter:["all",["==","class","path"],["has","name:de"]],layout:{"text-size":{base:1,stops:[[13,12],[14,13]]},"text-font":["Open Sans Regular"],"text-field":"{name:de} {name:nonlatin}","symbol-placement":"line","text-rotation-alignment":"map"},paint:{"text-halo-color":"#f8f4f0","text-color":"hsl(30, 23%, 62%)","text-halo-width":.5}},{id:"highway-name-minor",type:"symbol",source:"openmaptiles","source-layer":"transportation_name",minzoom:15,filter:["all",["==","$type","LineString"],["in","class","minor","service","track"],["!has","name:de"]],layout:{"text-size":{base:1,stops:[[13,12],[14,13]]},"text-font":["Open Sans Regular"],"text-field":"{name:latin} {name:nonlatin}","symbol-placement":"line","text-rotation-alignment":"map"},paint:{"text-halo-blur":.5,"text-color":"#765","text-halo-width":1}},{id:"highway-name-minor-en",type:"symbol",source:"openmaptiles","source-layer":"transportation_name",minzoom:15,filter:["all",["==","$type","LineString"],["in","class","minor","service","track"],["has","name:de"]],layout:{"text-size":{base:1,stops:[[13,12],[14,13]]},"text-font":["Open Sans Regular"],"text-field":"{name:de} {name:nonlatin}","symbol-placement":"line","text-rotation-alignment":"map"},paint:{"text-halo-blur":.5,"text-color":"#765","text-halo-width":1}},{id:"highway-name-major",type:"symbol",source:"openmaptiles","source-layer":"transportation_name",minzoom:12.2,filter:["all",["in","class","primary","secondary","tertiary","trunk"],["!has","name:de"]],layout:{"text-size":{base:1,stops:[[13,12],[14,13]]},"text-font":["Open Sans Regular"],"text-field":"{name:latin} {name:nonlatin}","symbol-placement":"line","text-rotation-alignment":"map"},paint:{"text-halo-blur":.5,"text-color":"#765","text-halo-width":1}},{id:"highway-name-major-en",type:"symbol",source:"openmaptiles","source-layer":"transportation_name",minzoom:12.2,filter:["all",["in","class","primary","secondary","tertiary","trunk"],["has","name:de"]],layout:{"text-size":{base:1,stops:[[13,12],[14,13]]},"text-font":["Open Sans Regular"],"text-field":"{name:de} {name:nonlatin}","symbol-placement":"line","text-rotation-alignment":"map"},paint:{"text-halo-blur":.5,"text-color":"#765","text-halo-width":1}},{id:"highway-shield",type:"symbol",source:"openmaptiles","source-layer":"transportation_name",minzoom:8,filter:["all",["<=","ref_length",6],["==","$type","LineString"],["!in","network","us-interstate","us-highway","us-state"]],layout:{"text-size":10,"icon-image":"road_{ref_length}","icon-rotation-alignment":"viewport","symbol-spacing":200,"text-font":["Open Sans Semibold"],"symbol-placement":{base:1,stops:[[10,"point"],[11,"line"]]},"text-rotation-alignment":"viewport","icon-size":1,"text-field":"{ref}"},paint:{}},{id:"highway-shield-us-interstate",type:"symbol",source:"openmaptiles","source-layer":"transportation_name",minzoom:7,filter:["all",["<=","ref_length",6],["==","$type","LineString"],["in","network","us-interstate"]],layout:{"text-size":10,"icon-image":"{network}_{ref_length}","icon-rotation-alignment":"viewport","symbol-spacing":200,"text-font":["Open Sans Semibold"],"symbol-placement":{base:1,stops:[[7,"point"],[7,"line"],[8,"line"]]},"text-rotation-alignment":"viewport","icon-size":1,"text-field":"{ref}"},paint:{"text-color":"rgba(0, 0, 0, 1)"}},{id:"highway-shield-us-other",type:"symbol",source:"openmaptiles","source-layer":"transportation_name",minzoom:9,filter:["all",["<=","ref_length",6],["==","$type","LineString"],["in","network","us-highway","us-state"]],layout:{"text-size":10,"icon-image":"{network}_{ref_length}","icon-rotation-alignment":"viewport","symbol-spacing":200,"text-font":["Open Sans Semibold"],"symbol-placement":{base:1,stops:[[10,"point"],[11,"line"]]},"text-rotation-alignment":"viewport","icon-size":1,"text-field":"{ref}"},paint:{"text-color":"rgba(0, 0, 0, 1)"}},{id:"place-other",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["!in","class","city","town","village"],["!has","name:de"]],layout:{"text-letter-spacing":.1,"text-size":{base:1.2,stops:[[12,10],[15,14]]},"text-font":["Open Sans Bold"],"text-field":`{name:latin}
{name:nonlatin}`,"text-transform":"uppercase","text-max-width":9},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-other-en",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["!in","class","city","town","village"],["has","name:de"]],layout:{"text-letter-spacing":.1,"text-size":{base:1.2,stops:[[12,10],[15,14]]},"text-font":["Open Sans Bold"],"text-field":`{name:de}
{name:nonlatin}`,"text-transform":"uppercase","text-max-width":9},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-village",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","village"],["!has","name:de"]],layout:{"text-font":["Open Sans Regular"],"text-size":{base:1.2,stops:[[10,12],[15,22]]},"text-field":`{name:latin}
{name:nonlatin}`,"text-max-width":8},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-village-en",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","village"],["has","name:de"]],layout:{"text-font":["Open Sans Regular"],"text-size":{base:1.2,stops:[[10,12],[15,22]]},"text-field":`{name:de}
{name:nonlatin}`,"text-max-width":8},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-town",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","town"],["!has","name:de"]],layout:{"text-font":["Open Sans Regular"],"text-size":{base:1.2,stops:[[10,14],[15,24]]},"text-field":`{name:latin}
{name:nonlatin}`,"text-max-width":8},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-town-en",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","town"],["has","name:de"]],layout:{"text-font":["Open Sans Regular"],"text-size":{base:1.2,stops:[[10,14],[15,24]]},"text-field":`{name:de}
{name:nonlatin}`,"text-max-width":8},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-city",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["!=","capital",2],["==","class","city"],["!has","name:de"]],layout:{"text-font":["Open Sans Semibold"],"text-size":{base:1.2,stops:[[7,14],[11,24]]},"text-field":`{name:latin}
{name:nonlatin}`,"text-max-width":8},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-city-en",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["!=","capital",2],["==","class","city"],["has","name:de"]],layout:{"text-font":["Open Sans Semibold"],"text-size":{base:1.2,stops:[[7,14],[11,24]]},"text-field":`{name:de}
{name:nonlatin}`,"text-max-width":8},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-city-capital",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","capital",2],["==","class","city"],["!has","name:de"]],layout:{"text-font":["Open Sans Semibold"],"text-size":{base:1.2,stops:[[7,14],[11,24]]},"text-field":`{name:latin}
{name:nonlatin}`,"text-max-width":8,"icon-image":"star_11","text-offset":[.4,0],"icon-size":.8,"text-anchor":"left"},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-city-capital-en",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","capital",2],["==","class","city"],["has","name:de"]],layout:{"text-font":["Open Sans Semibold"],"text-size":{base:1.2,stops:[[7,14],[11,24]]},"text-field":`{name:de}
{name:nonlatin}`,"text-max-width":8,"icon-image":"star_11","text-offset":[.4,0],"icon-size":.8,"text-anchor":"left"},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-country-3",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","country"],[">=","rank",3],["!has","name:de"]],layout:{"text-font":["Open Sans Bold"],"text-field":`{name:latin}
{name:nonlatin}`,"text-size":{stops:[[3,11],[7,17]]},"text-transform":"uppercase","text-max-width":6.25},paint:{"text-halo-blur":1,"text-color":"#fdfdfd","text-halo-width":2,"text-halo-color":"#433"}},{id:"place-country-3-en",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","country"],[">=","rank",3],["has","name:de"]],layout:{"text-font":["Open Sans Bold"],"text-field":`{name:de}
{name:nonlatin}`,"text-size":{stops:[[3,11],[7,17]]},"text-transform":"uppercase","text-max-width":6.25},paint:{"text-halo-blur":1,"text-color":"#fdfdfd","text-halo-width":2,"text-halo-color":"#433"}},{id:"place-country-2",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","country"],["==","rank",2],["!has","name:de"]],layout:{"text-font":["Open Sans Bold"],"text-field":`{name:latin}
{name:nonlatin}`,"text-size":{stops:[[2,11],[5,17]]},"text-transform":"uppercase","text-max-width":6.25},paint:{"text-halo-blur":1,"text-color":"#fdfdfd","text-halo-width":2,"text-halo-color":"#433"}},{id:"place-country-2-en",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","country"],["==","rank",2],["has","name:de"]],layout:{"text-font":["Open Sans Bold"],"text-field":`{name:de}
{name:nonlatin}`,"text-size":{stops:[[2,11],[5,17]]},"text-transform":"uppercase","text-max-width":6.25},paint:{"text-halo-blur":1,"text-color":"#fdfdfd","text-halo-width":2,"text-halo-color":"#433"}},{id:"place-country-1",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","country"],["==","rank",1],["!has","name:de"]],layout:{"text-font":["Open Sans Bold"],"text-field":`{name:latin}
{name:nonlatin}`,"text-size":{stops:[[1,11],[4,17]]},"text-transform":"uppercase","text-max-width":6.25},paint:{"text-halo-blur":1,"text-color":"#fdfdfd","text-halo-width":2,"text-halo-color":"#433"}},{id:"place-country-1-en",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","country"],["==","rank",1],["has","name:de"]],layout:{"text-font":["Open Sans Bold"],"text-field":`{name:de}
{name:nonlatin}`,"text-size":{stops:[[1,11],[4,17]]},"text-transform":"uppercase","text-max-width":6.25},paint:{"text-halo-blur":1,"text-color":"#fdfdfd","text-halo-width":2,"text-halo-color":"#433"}},{id:"place-continent",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",maxzoom:1,filter:["all",["==","class","continent"],["!has","name:de"]],layout:{"text-font":["Open Sans Bold"],"text-field":`{name:latin}
{name:nonlatin}`,"text-size":14,"text-max-width":6.25,"text-transform":"uppercase"},paint:{"text-halo-blur":1,"text-color":"#fdfdfd","text-halo-width":2,"text-halo-color":"#433"}},{id:"place-continent-en",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",maxzoom:1,filter:["all",["==","class","continent"],["has","name:de"]],layout:{"text-font":["Open Sans Bold"],"text-field":`{name:de}
{name:nonlatin}`,"text-size":14,"text-max-width":6.25,"text-transform":"uppercase"},paint:{"text-halo-blur":1,"text-color":"#fdfdfd","text-halo-width":2,"text-halo-color":"#433"}}]},RNe={version:8,name:"Gruvbox",center:[8.542,47.372],zoom:11.6,bearing:0,pitch:0,sources:{openmaptiles:{type:"vector",url:$u.source_openmaptiles_url}},sprite:$u.sprite,glyphs:$u.glyphs,layers:[{id:"background",type:"background",paint:{"background-color":"#282822"}},{id:"landcover-glacier",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landcover",filter:["==","subclass","glacier"],layout:{visibility:"visible"},paint:{"fill-color":"#83a598","fill-opacity":{base:1,stops:[[0,.9],[10,.3]]}}},{id:"landuse-residential",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landuse",filter:["==","class","residential"],paint:{"fill-color":"#b8bb26"}},{id:"landuse-commercial",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landuse",filter:["all",["==","$type","Polygon"],["==","class","commercial"]],paint:{"fill-color":"#bfc23c"}},{id:"landuse-industrial",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landuse",filter:["all",["==","$type","Polygon"],["==","class","industrial"]],paint:{"fill-color":"#c6c951"}},{id:"park",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"park",filter:["==","$type","Polygon"],paint:{"fill-color":"#b8bb26","fill-opacity":{base:1.8,stops:[[9,.5],[12,.2]]}}},{id:"park-outline",type:"line",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"park",filter:["==","$type","Polygon"],layout:{},paint:{"line-color":"rgba(184,187,38,0.6)","line-dasharray":[3,3]}},{id:"landuse-cemetery",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landuse",filter:["==","class","cemetery"],paint:{"fill-color":"#eceeaa"}},{id:"landuse-hospital",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landuse",filter:["==","class","hospital"],paint:{"fill-color":"#fe8019"}},{id:"landuse-school",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landuse",filter:["==","class","school"],paint:{"fill-color":"rgba(254,128,25,0.8)"}},{id:"landuse-railway",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landuse",filter:["==","class","railway"],paint:{"fill-color":"rgba(118,51,8,0.4)"}},{id:"landcover-wood",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landcover",filter:["==","class","wood"],paint:{"fill-color":"#83a598","fill-opacity":.1,"fill-outline-color":"hsla(0, 0%, 0%, 0.03)","fill-antialias":{base:1,stops:[[0,!1],[9,!0]]}}},{id:"landcover-grass",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landcover",filter:["==","class","grass"],paint:{"fill-color":"#b8bb26","fill-opacity":1}},{id:"landcover-grass-park",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"park",filter:["==","class","public_park"],paint:{"fill-color":"#b8bb26","fill-opacity":.8}},{id:"waterway-other",type:"line",metadata:{"mapbox:group":"1444849382550.77"},source:"openmaptiles","source-layer":"waterway",filter:["!in","class","canal","river","stream"],layout:{"line-cap":"round"},paint:{"line-color":"#83a598","line-width":{base:1.3,stops:[[13,.5],[20,2]]}}},{id:"waterway-stream-canal",type:"line",metadata:{"mapbox:group":"1444849382550.77"},source:"openmaptiles","source-layer":"waterway",filter:["in","class","canal","stream"],layout:{"line-cap":"round"},paint:{"line-color":"#83a598","line-width":{base:1.3,stops:[[13,.5],[20,6]]}}},{id:"waterway-river",type:"line",metadata:{"mapbox:group":"1444849382550.77"},source:"openmaptiles","source-layer":"waterway",filter:["==","class","river"],layout:{"line-cap":"round"},paint:{"line-color":"#83a598","line-width":{base:1.2,stops:[[10,.8],[20,6]]}}},{id:"water-offset",type:"fill",metadata:{"mapbox:group":"1444849382550.77"},source:"openmaptiles","source-layer":"water",maxzoom:8,filter:["==","$type","Polygon"],layout:{visibility:"visible"},paint:{"fill-opacity":1,"fill-color":"#83a598","fill-translate":{base:1,stops:[[6,[2,0]],[8,[0,0]]]}}},{id:"water",type:"fill",metadata:{"mapbox:group":"1444849382550.77"},source:"openmaptiles","source-layer":"water",layout:{visibility:"visible"},paint:{"fill-color":"#5c7f72"}},{id:"water-pattern",type:"fill",metadata:{"mapbox:group":"1444849382550.77"},source:"openmaptiles","source-layer":"water",layout:{visibility:"visible"},paint:{"fill-translate":[0,2.5],"fill-pattern":"wave"}},{id:"landcover-ice-shelf",type:"fill",metadata:{"mapbox:group":"1444849382550.77"},source:"openmaptiles","source-layer":"landcover",filter:["==","subclass","ice_shelf"],layout:{visibility:"visible"},paint:{"fill-color":"#83a598","fill-opacity":{base:1,stops:[[0,.9],[10,.3]]}}},{id:"building",type:"fill",metadata:{"mapbox:group":"1444849364238.8171"},source:"openmaptiles","source-layer":"building",paint:{"fill-color":"#928374","fill-antialias":!0}},{id:"building-top",type:"fill",metadata:{"mapbox:group":"1444849364238.8171"},source:"openmaptiles","source-layer":"building",layout:{visibility:"visible"},paint:{"fill-translate":{base:1,stops:[[14,[0,0]],[16,[-2,-2]]]},"fill-outline-color":"#dfdbd7","fill-color":"#a89c91","fill-opacity":{base:1,stops:[[13,0],[16,1]]}}},{id:"tunnel-service-track-casing",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["in","class","service","track"]],layout:{"line-join":"round"},paint:{"line-color":"#d65d0e","line-dasharray":[.5,.25],"line-width":{base:1.2,stops:[[15,1],[16,4],[20,11]]}}},{id:"tunnel-minor-casing",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["==","class","minor"]],layout:{"line-join":"round"},paint:{"line-color":"#d65d0e","line-opacity":{stops:[[12,0],[12.5,1]]},"line-width":{base:1.2,stops:[[12,.5],[13,1],[14,4],[20,15]]}}},{id:"tunnel-secondary-tertiary-casing",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["in","class","secondary","tertiary"]],layout:{"line-join":"round"},paint:{"line-color":"#d65d0e","line-opacity":1,"line-width":{base:1.2,stops:[[8,1.5],[20,17]]}}},{id:"tunnel-trunk-primary-casing",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["in","class","primary","trunk"]],layout:{"line-join":"round"},paint:{"line-color":"#d65d0e","line-width":{base:1.2,stops:[[5,.4],[6,.6],[7,1.5],[20,22]]}}},{id:"tunnel-motorway-casing",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["==","class","motorway"]],layout:{"line-join":"round",visibility:"visible"},paint:{"line-color":"#d65d0e","line-dasharray":[.5,.25],"line-width":{base:1.2,stops:[[5,.4],[6,.6],[7,1.5],[20,22]]}}},{id:"tunnel-path",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["==","brunnel","tunnel"],["==","class","path"]]],paint:{"line-color":"#f17626","line-dasharray":[1.5,.75],"line-width":{base:1.2,stops:[[15,1.2],[20,4]]}}},{id:"tunnel-service-track",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["in","class","service","track"]],layout:{"line-join":"round"},paint:{"line-color":"#f17626","line-width":{base:1.2,stops:[[15.5,0],[16,2],[20,7.5]]}}},{id:"tunnel-minor",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["==","class","minor_road"]],layout:{"line-join":"round"},paint:{"line-color":"#f17626","line-opacity":1,"line-width":{base:1.2,stops:[[13.5,0],[14,2.5],[20,11.5]]}}},{id:"tunnel-secondary-tertiary",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["in","class","secondary","tertiary"]],layout:{"line-join":"round"},paint:{"line-color":"#f2853e","line-width":{base:1.2,stops:[[6.5,0],[7,.5],[20,10]]}}},{id:"tunnel-trunk-primary",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["in","class","primary","trunk"]],layout:{"line-join":"round"},paint:{"line-color":"#d65d0e","line-width":{base:1.2,stops:[[6.5,0],[7,.5],[20,18]]}}},{id:"tunnel-motorway",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["==","class","motorway"]],layout:{"line-join":"round",visibility:"visible"},paint:{"line-color":"rgba(235,219,178,0.8)","line-width":{base:1.2,stops:[[6.5,0],[7,.5],[20,18]]}}},{id:"tunnel-railway",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["==","class","rail"]],paint:{"line-color":"#763308","line-width":{base:1.4,stops:[[14,.4],[15,.75],[20,2]]},"line-dasharray":[2,2]}},{id:"aeroway-taxiway-casing",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"aeroway",minzoom:12,filter:["all",["in","class","taxiway"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#763308","line-width":{base:1.5,stops:[[11,2],[17,12]]},"line-opacity":1}},{id:"aeroway-runway-casing",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"aeroway",minzoom:12,filter:["all",["in","class","runway"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#763308","line-width":{base:1.5,stops:[[11,5],[17,55]]},"line-opacity":1}},{id:"aeroway-area",type:"fill",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"aeroway",minzoom:4,filter:["all",["==","$type","Polygon"],["in","class","runway","taxiway"]],layout:{visibility:"visible"},paint:{"fill-opacity":{base:1,stops:[[13,0],[14,1]]},"fill-color":"rgba(214,93,14,0.5)"}},{id:"aeroway-taxiway",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"aeroway",minzoom:4,filter:["all",["in","class","taxiway"],["==","$type","LineString"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#f2853e","line-width":{base:1.5,stops:[[11,1],[17,10]]},"line-opacity":{base:1,stops:[[11,0],[12,1]]}}},{id:"aeroway-runway",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"aeroway",minzoom:4,filter:["all",["in","class","runway"],["==","$type","LineString"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#f2853e","line-width":{base:1.5,stops:[[11,4],[17,50]]},"line-opacity":{base:1,stops:[[11,0],[12,1]]}}},{id:"highway-area",type:"fill",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["==","$type","Polygon"],layout:{visibility:"visible"},paint:{"fill-color":"#a6480b","fill-outline-color":"#cfcdca","fill-opacity":.9,"fill-antialias":!1}},{id:"highway-motorway-link-casing",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",minzoom:12,filter:["all",["!in","brunnel","bridge","tunnel"],["==","class","motorway_link"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#d65d0e","line-opacity":1,"line-width":{base:1.2,stops:[[12,1],[13,3],[14,4],[20,15]]}}},{id:"highway-link-casing",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",minzoom:13,filter:["all",["!in","brunnel","bridge","tunnel"],["in","class","primary_link","secondary_link","tertiary_link","trunk_link"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#d65d0e","line-opacity":1,"line-width":{base:1.2,stops:[[12,1],[13,3],[14,4],[20,15]]}}},{id:"highway-minor-casing",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["!=","brunnel","tunnel"],["in","class","minor","service","track"]]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"rgba(214,93,14,0.8)","line-opacity":{stops:[[12,0],[12.5,1]]},"line-width":{base:1.2,stops:[[12,.5],[13,1],[14,4],[20,15]]}}},{id:"highway-secondary-tertiary-casing",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["!in","brunnel","bridge","tunnel"],["in","class","secondary","tertiary"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#d65d0e","line-opacity":1,"line-width":{base:1.2,stops:[[8,1.5],[20,17]]}}},{id:"highway-primary-casing",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",minzoom:5,filter:["all",["!in","brunnel","bridge","tunnel"],["in","class","primary"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#d65d0e","line-opacity":{stops:[[7,0],[8,1]]},"line-width":{base:1.2,stops:[[7,0],[8,.6],[9,1.5],[20,22]]}}},{id:"highway-trunk-casing",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",minzoom:5,filter:["all",["!in","brunnel","bridge","tunnel"],["in","class","trunk"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#d65d0e","line-opacity":{stops:[[5,0],[6,1]]},"line-width":{base:1.2,stops:[[5,0],[6,.6],[7,1.5],[20,22]]}}},{id:"highway-motorway-casing",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",minzoom:4,filter:["all",["!in","brunnel","bridge","tunnel"],["==","class","motorway"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#d65d0e","line-width":{base:1.2,stops:[[4,0],[5,.4],[6,.6],[7,1.5],[20,22]]},"line-opacity":{stops:[[4,0],[5,1]]}}},{id:"highway-path",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["!in","brunnel","bridge","tunnel"],["==","class","path"]]],paint:{"line-color":"#fe8019","line-dasharray":[1.5,.75],"line-width":{base:1.2,stops:[[15,1.2],[20,4]]}}},{id:"highway-motorway-link",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",minzoom:12,filter:["all",["!in","brunnel","bridge","tunnel"],["==","class","motorway_link"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#ebdbb2","line-width":{base:1.2,stops:[[12.5,0],[13,1.5],[14,2.5],[20,11.5]]}}},{id:"highway-link",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",minzoom:13,filter:["all",["!in","brunnel","bridge","tunnel"],["in","class","primary_link","secondary_link","tertiary_link","trunk_link"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#ebdbb2","line-width":{base:1.2,stops:[[12.5,0],[13,1.5],[14,2.5],[20,11.5]]}}},{id:"highway-minor",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["!=","brunnel","tunnel"],["in","class","minor","service","track"]]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#f49456","line-opacity":1,"line-width":{base:1.2,stops:[[13.5,0],[14,2.5],[20,11.5]]}}},{id:"highway-secondary-tertiary",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["!in","brunnel","bridge","tunnel"],["in","class","secondary","tertiary"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#ebdbb2","line-width":{base:1.2,stops:[[6.5,0],[8,.5],[20,13]]}}},{id:"highway-primary",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["!in","brunnel","bridge","tunnel"],["in","class","primary"]]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#ebdbb2","line-width":{base:1.2,stops:[[8.5,0],[9,.5],[20,18]]}}},{id:"highway-trunk",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["!in","brunnel","bridge","tunnel"],["in","class","trunk"]]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#ebdbb2","line-width":{base:1.2,stops:[[6.5,0],[7,.5],[20,18]]}}},{id:"highway-motorway",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",minzoom:5,filter:["all",["==","$type","LineString"],["all",["!in","brunnel","bridge","tunnel"],["==","class","motorway"]]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#ebdbb2","line-width":{base:1.2,stops:[[6.5,0],[7,.5],[20,18]]}}},{id:"railway-service",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["==","class","rail"],["has","service"]]],paint:{"line-color":"rgba(118,51,8,0.7)","line-width":{base:1.4,stops:[[14,.4],[20,1]]}}},{id:"railway-service-hatching",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["==","class","rail"],["has","service"]]],layout:{visibility:"visible"},paint:{"line-color":"rgba(118,51,8,0.7)","line-dasharray":[.2,8],"line-width":{base:1.4,stops:[[14.5,0],[15,2],[20,6]]}}},{id:"railway",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["!has","service"],["!in","brunnel","bridge","tunnel"],["==","class","rail"]]],paint:{"line-color":"#763308","line-width":{base:1.4,stops:[[14,.4],[15,.75],[20,2]]}}},{id:"railway-hatching",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["!has","service"],["!in","brunnel","bridge","tunnel"],["==","class","rail"]]],paint:{"line-color":"#763308","line-dasharray":[.2,8],"line-width":{base:1.4,stops:[[14.5,0],[15,3],[20,8]]}}},{id:"bridge-motorway-link-casing",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["==","class","motorway_link"]],layout:{"line-join":"round"},paint:{"line-color":"#d65d0e","line-opacity":1,"line-width":{base:1.2,stops:[[12,1],[13,3],[14,4],[20,15]]}}},{id:"bridge-link-casing",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["in","class","primary_link","secondary_link","tertiary_link","trunk_link"]],layout:{"line-join":"round"},paint:{"line-color":"#d65d0e","line-opacity":1,"line-width":{base:1.2,stops:[[12,1],[13,3],[14,4],[20,15]]}}},{id:"bridge-secondary-tertiary-casing",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["in","class","secondary","tertiary"]],layout:{"line-join":"round"},paint:{"line-color":"#d65d0e","line-opacity":1,"line-width":{base:1.2,stops:[[8,1.5],[20,28]]}}},{id:"bridge-trunk-primary-casing",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["in","class","primary","trunk"]],layout:{"line-join":"round"},paint:{"line-color":"#d65d0e","line-width":{base:1.2,stops:[[5,.4],[6,.6],[7,1.5],[20,26]]}}},{id:"bridge-motorway-casing",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["==","class","motorway"]],layout:{"line-join":"round"},paint:{"line-color":"#d65d0e","line-width":{base:1.2,stops:[[5,.4],[6,.6],[7,1.5],[20,22]]}}},{id:"bridge-path-casing",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["==","brunnel","bridge"],["==","class","path"]]],paint:{"line-color":"#f17626","line-width":{base:1.2,stops:[[15,1.2],[20,18]]}}},{id:"bridge-path",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["==","brunnel","bridge"],["==","class","path"]]],paint:{"line-color":"#fe8019","line-width":{base:1.2,stops:[[15,1.2],[20,4]]},"line-dasharray":[1.5,.75]}},{id:"bridge-motorway-link",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["==","class","motorway_link"]],layout:{"line-join":"round"},paint:{"line-color":"#ebdbb2","line-width":{base:1.2,stops:[[12.5,0],[13,1.5],[14,2.5],[20,11.5]]}}},{id:"bridge-link",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["in","class","primary_link","secondary_link","tertiary_link","trunk_link"]],layout:{"line-join":"round"},paint:{"line-color":"#ebdbb2","line-width":{base:1.2,stops:[[12.5,0],[13,1.5],[14,2.5],[20,11.5]]}}},{id:"bridge-secondary-tertiary",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["in","class","secondary","tertiary"]],layout:{"line-join":"round"},paint:{"line-color":"#ebdbb2","line-width":{base:1.2,stops:[[6.5,0],[7,.5],[20,20]]}}},{id:"bridge-trunk-primary",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["in","class","primary","trunk"]],layout:{"line-join":"round"},paint:{"line-color":"#ebdbb2","line-width":{base:1.2,stops:[[6.5,0],[7,.5],[20,18]]}}},{id:"bridge-motorway",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["==","class","motorway"]],layout:{"line-join":"round"},paint:{"line-color":"#ebdbb2","line-width":{base:1.2,stops:[[6.5,0],[7,.5],[20,18]]}}},{id:"bridge-railway",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["==","class","rail"]],paint:{"line-color":"#763308","line-width":{base:1.4,stops:[[14,.4],[15,.75],[20,2]]}}},{id:"bridge-railway-hatching",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["==","class","rail"]],paint:{"line-color":"#763308","line-dasharray":[.2,8],"line-width":{base:1.4,stops:[[14.5,0],[15,3],[20,8]]}}},{id:"boundary-land-level-4",type:"line",source:"openmaptiles","source-layer":"boundary",filter:["all",["in","admin_level",4,6,8],["!=","maritime",1]],layout:{"line-join":"round"},paint:{"line-color":"#fb4934","line-dasharray":[3,1,1,1],"line-width":{base:1.4,stops:[[4,.4],[5,1],[12,3]]}}},{id:"boundary-land-level-2",type:"line",source:"openmaptiles","source-layer":"boundary",filter:["all",["==","admin_level",2],["!=","maritime",1]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#fb4934","line-width":{base:1,stops:[[0,.6],[4,1.4],[5,2],[12,8]]}}},{id:"boundary-water",type:"line",source:"openmaptiles","source-layer":"boundary",filter:["all",["in","admin_level",2,4],["==","maritime",1]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#83a598","line-width":{base:1,stops:[[0,.6],[4,1.4],[5,2],[12,8]]},"line-opacity":{stops:[[6,.6],[10,1]]}}},{id:"waterway-name",type:"symbol",source:"openmaptiles","source-layer":"waterway",minzoom:13,filter:["all",["==","$type","LineString"],["has","name"],["!has","name:de"]],layout:{"text-font":["Open Sans Italic"],"text-size":14,"text-field":"{name:latin} {name:nonlatin}","text-max-width":5,"text-rotation-alignment":"map","symbol-placement":"line","text-letter-spacing":.2,"symbol-spacing":350},paint:{"text-color":"#fefefe","text-halo-width":1.5,"text-halo-color":"#74aee9"}},{id:"waterway-name-en",type:"symbol",source:"openmaptiles","source-layer":"waterway",minzoom:13,filter:["all",["==","$type","LineString"],["has","name"],["has","name:de"]],layout:{"text-font":["Open Sans Italic"],"text-size":14,"text-field":"{name:de} {name:nonlatin}","text-max-width":5,"text-rotation-alignment":"map","symbol-placement":"line","text-letter-spacing":.2,"symbol-spacing":350},paint:{"text-color":"#fefefe","text-halo-width":1.5,"text-halo-color":"#74aee9"}},{id:"water-name-lakeline",type:"symbol",source:"openmaptiles","source-layer":"water_name",filter:["all",["==","$type","LineString"],["!has","name:de"]],layout:{"text-font":["Open Sans Italic"],"text-size":14,"text-field":"{name:latin} {name:nonlatin}","text-max-width":5,"text-rotation-alignment":"map","symbol-placement":"line","symbol-spacing":350,"text-letter-spacing":.2},paint:{"text-color":"#fefefe","text-halo-width":1.5,"text-halo-color":"#74aee9"}},{id:"water-name-lakeline-en",type:"symbol",source:"openmaptiles","source-layer":"water_name",filter:["all",["==","$type","LineString"],["has","name:de"]],layout:{"text-font":["Open Sans Italic"],"text-size":14,"text-field":"{name:de} {name:nonlatin}","text-max-width":5,"text-rotation-alignment":"map","symbol-placement":"line","symbol-spacing":350,"text-letter-spacing":.2},paint:{"text-color":"#fefefe","text-halo-width":1.5,"text-halo-color":"#74aee9"}},{id:"water-name-ocean",type:"symbol",source:"openmaptiles","source-layer":"water_name",filter:["all",["==","$type","Point"],["==","class","ocean"],["!has","name:de"]],layout:{"text-font":["Open Sans Italic"],"text-size":14,"text-field":`{name:latin}
{name:nonlatin}`,"text-max-width":5,"text-rotation-alignment":"map","symbol-placement":"point","symbol-spacing":350,"text-letter-spacing":.2},paint:{"text-color":"#fefefe","text-halo-width":1.5,"text-halo-color":"#74aee9"}},{id:"water-name-ocean-en",type:"symbol",source:"openmaptiles","source-layer":"water_name",filter:["all",["==","$type","Point"],["==","class","ocean"],["has","name:de"]],layout:{"text-font":["Open Sans Italic"],"text-size":14,"text-field":`{name:de}
{name:nonlatin}`,"text-max-width":5,"text-rotation-alignment":"map","symbol-placement":"point","symbol-spacing":350,"text-letter-spacing":.2},paint:{"text-color":"#fefefe","text-halo-width":1.5,"text-halo-color":"#74aee9"}},{id:"water-name-other",type:"symbol",source:"openmaptiles","source-layer":"water_name",filter:["all",["==","$type","Point"],["!in","class","ocean"],["!has","name:de"]],layout:{"text-font":["Open Sans Italic"],"text-size":{stops:[[0,10],[6,14]]},"text-field":`{name:latin}
{name:nonlatin}`,"text-max-width":5,"text-rotation-alignment":"map","symbol-placement":"point","symbol-spacing":350,"text-letter-spacing":.2,visibility:"visible"},paint:{"text-color":"#fefefe","text-halo-width":1.5,"text-halo-color":"#74aee9"}},{id:"water-name-other-en",type:"symbol",source:"openmaptiles","source-layer":"water_name",filter:["all",["==","$type","Point"],["!in","class","ocean"],["has","name:de"]],layout:{"text-font":["Open Sans Italic"],"text-size":{stops:[[0,10],[6,14]]},"text-field":`{name:de}
{name:nonlatin}`,"text-max-width":5,"text-rotation-alignment":"map","symbol-placement":"point","symbol-spacing":350,"text-letter-spacing":.2,visibility:"visible"},paint:{"text-color":"#fefefe","text-halo-width":1.5,"text-halo-color":"#74aee9"}},{id:"poi-level-3",type:"symbol",source:"openmaptiles","source-layer":"poi",minzoom:16,filter:["all",["==","$type","Point"],[">=","rank",25],["!has","name:de"]],layout:{"text-padding":2,"text-font":["Open Sans Semibold"],"text-anchor":"top","icon-image":"{class}_11","text-field":`{name:latin}
{name:nonlatin}`,"text-offset":[0,.6],"text-size":12,"text-max-width":9},paint:{"text-halo-blur":.5,"text-color":"#fdfdfd","text-halo-width":1,"text-halo-color":"#633"}},{id:"poi-level-3-en",type:"symbol",source:"openmaptiles","source-layer":"poi",minzoom:16,filter:["all",["==","$type","Point"],[">=","rank",25],["has","name:de"]],layout:{"text-padding":2,"text-font":["Open Sans Semibold"],"text-anchor":"top","icon-image":"{class}_11","text-field":`{name:de}
{name:nonlatin}`,"text-offset":[0,.6],"text-size":12,"text-max-width":9},paint:{"text-halo-blur":.5,"text-color":"#fdfdfd","text-halo-width":1,"text-halo-color":"#633"}},{id:"poi-level-2",type:"symbol",source:"openmaptiles","source-layer":"poi",minzoom:15,filter:["all",["==","$type","Point"],["all",["<=","rank",24],[">=","rank",15]],["!has","name:de"]],layout:{"text-padding":2,"text-font":["Open Sans Semibold"],"text-anchor":"top","icon-image":"{class}_11","text-field":`{name:latin}
{name:nonlatin}`,"text-offset":[0,.6],"text-size":12,"text-max-width":9},paint:{"text-halo-blur":.5,"text-color":"#fdfdfd","text-halo-width":1,"text-halo-color":"#633"}},{id:"poi-level-2-en",type:"symbol",source:"openmaptiles","source-layer":"poi",minzoom:15,filter:["all",["==","$type","Point"],["all",["<=","rank",24],[">=","rank",15]],["has","name:de"]],layout:{"text-padding":2,"text-font":["Open Sans Semibold"],"text-anchor":"top","icon-image":"{class}_11","text-field":`{name:de}
{name:nonlatin}`,"text-offset":[0,.6],"text-size":12,"text-max-width":9},paint:{"text-halo-blur":.5,"text-color":"#fdfdfd","text-halo-width":1,"text-halo-color":"#633"}},{id:"poi-level-1",type:"symbol",source:"openmaptiles","source-layer":"poi",minzoom:14,filter:["all",["==","$type","Point"],["all",["<=","rank",14],["has","name"]],["!has","name:de"]],layout:{"text-padding":2,"text-font":["Open Sans Semibold"],"text-anchor":"top","icon-image":"{class}_11","text-field":`{name:latin}
{name:nonlatin}`,"text-offset":[0,.6],"text-size":12,"text-max-width":9},paint:{"text-halo-blur":.5,"text-color":"#fdfdfd","text-halo-width":1,"text-halo-color":"#633"}},{id:"poi-level-1-en",type:"symbol",source:"openmaptiles","source-layer":"poi",minzoom:14,filter:["all",["==","$type","Point"],["all",["<=","rank",14],["has","name"]],["has","name:de"]],layout:{"text-padding":2,"text-font":["Open Sans Semibold"],"text-anchor":"top","icon-image":"{class}_11","text-field":`{name:de}
{name:nonlatin}`,"text-offset":[0,.6],"text-size":12,"text-max-width":9},paint:{"text-halo-blur":.5,"text-color":"#fdfdfd","text-halo-width":1,"text-halo-color":"#633"}},{id:"highway-name-path",type:"symbol",source:"openmaptiles","source-layer":"transportation_name",minzoom:15.5,filter:["all",["==","class","path"],["!has","name:de"]],layout:{"text-size":{base:1,stops:[[13,12],[14,13]]},"text-font":["Open Sans Regular"],"text-field":"{name:latin} {name:nonlatin}","symbol-placement":"line","text-rotation-alignment":"map"},paint:{"text-halo-color":"#f8f4f0","text-color":"hsl(30, 23%, 62%)","text-halo-width":.5}},{id:"highway-name-path-en",type:"symbol",source:"openmaptiles","source-layer":"transportation_name",minzoom:15.5,filter:["all",["==","class","path"],["has","name:de"]],layout:{"text-size":{base:1,stops:[[13,12],[14,13]]},"text-font":["Open Sans Regular"],"text-field":"{name:de} {name:nonlatin}","symbol-placement":"line","text-rotation-alignment":"map"},paint:{"text-halo-color":"#f8f4f0","text-color":"hsl(30, 23%, 62%)","text-halo-width":.5}},{id:"highway-name-minor",type:"symbol",source:"openmaptiles","source-layer":"transportation_name",minzoom:15,filter:["all",["==","$type","LineString"],["in","class","minor","service","track"],["!has","name:de"]],layout:{"text-size":{base:1,stops:[[13,12],[14,13]]},"text-font":["Open Sans Regular"],"text-field":"{name:latin} {name:nonlatin}","symbol-placement":"line","text-rotation-alignment":"map"},paint:{"text-halo-blur":.5,"text-color":"#765","text-halo-width":1}},{id:"highway-name-minor-en",type:"symbol",source:"openmaptiles","source-layer":"transportation_name",minzoom:15,filter:["all",["==","$type","LineString"],["in","class","minor","service","track"],["has","name:de"]],layout:{"text-size":{base:1,stops:[[13,12],[14,13]]},"text-font":["Open Sans Regular"],"text-field":"{name:de} {name:nonlatin}","symbol-placement":"line","text-rotation-alignment":"map"},paint:{"text-halo-blur":.5,"text-color":"#765","text-halo-width":1}},{id:"highway-name-major",type:"symbol",source:"openmaptiles","source-layer":"transportation_name",minzoom:12.2,filter:["all",["in","class","primary","secondary","tertiary","trunk"],["!has","name:de"]],layout:{"text-size":{base:1,stops:[[13,12],[14,13]]},"text-font":["Open Sans Regular"],"text-field":"{name:latin} {name:nonlatin}","symbol-placement":"line","text-rotation-alignment":"map"},paint:{"text-halo-blur":.5,"text-color":"#765","text-halo-width":1}},{id:"highway-name-major-en",type:"symbol",source:"openmaptiles","source-layer":"transportation_name",minzoom:12.2,filter:["all",["in","class","primary","secondary","tertiary","trunk"],["has","name:de"]],layout:{"text-size":{base:1,stops:[[13,12],[14,13]]},"text-font":["Open Sans Regular"],"text-field":"{name:de} {name:nonlatin}","symbol-placement":"line","text-rotation-alignment":"map"},paint:{"text-halo-blur":.5,"text-color":"#765","text-halo-width":1}},{id:"highway-shield",type:"symbol",source:"openmaptiles","source-layer":"transportation_name",minzoom:8,filter:["all",["<=","ref_length",6],["==","$type","LineString"],["!in","network","us-interstate","us-highway","us-state"]],layout:{"text-size":10,"icon-image":"road_{ref_length}","icon-rotation-alignment":"viewport","symbol-spacing":200,"text-font":["Open Sans Semibold"],"symbol-placement":{base:1,stops:[[10,"point"],[11,"line"]]},"text-rotation-alignment":"viewport","icon-size":1,"text-field":"{ref}"},paint:{}},{id:"highway-shield-us-interstate",type:"symbol",source:"openmaptiles","source-layer":"transportation_name",minzoom:7,filter:["all",["<=","ref_length",6],["==","$type","LineString"],["in","network","us-interstate"]],layout:{"text-size":10,"icon-image":"{network}_{ref_length}","icon-rotation-alignment":"viewport","symbol-spacing":200,"text-font":["Open Sans Semibold"],"symbol-placement":{base:1,stops:[[7,"point"],[7,"line"],[8,"line"]]},"text-rotation-alignment":"viewport","icon-size":1,"text-field":"{ref}"},paint:{"text-color":"rgba(0, 0, 0, 1)"}},{id:"highway-shield-us-other",type:"symbol",source:"openmaptiles","source-layer":"transportation_name",minzoom:9,filter:["all",["<=","ref_length",6],["==","$type","LineString"],["in","network","us-highway","us-state"]],layout:{"text-size":10,"icon-image":"{network}_{ref_length}","icon-rotation-alignment":"viewport","symbol-spacing":200,"text-font":["Open Sans Semibold"],"symbol-placement":{base:1,stops:[[10,"point"],[11,"line"]]},"text-rotation-alignment":"viewport","icon-size":1,"text-field":"{ref}"},paint:{"text-color":"rgba(0, 0, 0, 1)"}},{id:"place-other",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["!in","class","city","town","village"],["!has","name:de"]],layout:{"text-letter-spacing":.1,"text-size":{base:1.2,stops:[[12,10],[15,14]]},"text-font":["Open Sans Bold"],"text-field":`{name:latin}
{name:nonlatin}`,"text-transform":"uppercase","text-max-width":9},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-other-en",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["!in","class","city","town","village"],["has","name:de"]],layout:{"text-letter-spacing":.1,"text-size":{base:1.2,stops:[[12,10],[15,14]]},"text-font":["Open Sans Bold"],"text-field":`{name:de}
{name:nonlatin}`,"text-transform":"uppercase","text-max-width":9},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-village",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","village"],["!has","name:de"]],layout:{"text-font":["Open Sans Regular"],"text-size":{base:1.2,stops:[[10,12],[15,22]]},"text-field":`{name:latin}
{name:nonlatin}`,"text-max-width":8},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-village-en",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","village"],["has","name:de"]],layout:{"text-font":["Open Sans Regular"],"text-size":{base:1.2,stops:[[10,12],[15,22]]},"text-field":`{name:de}
{name:nonlatin}`,"text-max-width":8},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-town",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","town"],["!has","name:de"]],layout:{"text-font":["Open Sans Regular"],"text-size":{base:1.2,stops:[[10,14],[15,24]]},"text-field":`{name:latin}
{name:nonlatin}`,"text-max-width":8},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-town-en",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","town"],["has","name:de"]],layout:{"text-font":["Open Sans Regular"],"text-size":{base:1.2,stops:[[10,14],[15,24]]},"text-field":`{name:de}
{name:nonlatin}`,"text-max-width":8},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-city",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["!=","capital",2],["==","class","city"],["!has","name:de"]],layout:{"text-font":["Open Sans Semibold"],"text-size":{base:1.2,stops:[[7,14],[11,24]]},"text-field":`{name:latin}
{name:nonlatin}`,"text-max-width":8},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-city-en",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["!=","capital",2],["==","class","city"],["has","name:de"]],layout:{"text-font":["Open Sans Semibold"],"text-size":{base:1.2,stops:[[7,14],[11,24]]},"text-field":`{name:de}
{name:nonlatin}`,"text-max-width":8},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-city-capital",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","capital",2],["==","class","city"],["!has","name:de"]],layout:{"text-font":["Open Sans Semibold"],"text-size":{base:1.2,stops:[[7,14],[11,24]]},"text-field":`{name:latin}
{name:nonlatin}`,"text-max-width":8,"icon-image":"star_11","text-offset":[.4,0],"icon-size":.8,"text-anchor":"left"},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-city-capital-en",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","capital",2],["==","class","city"],["has","name:de"]],layout:{"text-font":["Open Sans Semibold"],"text-size":{base:1.2,stops:[[7,14],[11,24]]},"text-field":`{name:de}
{name:nonlatin}`,"text-max-width":8,"icon-image":"star_11","text-offset":[.4,0],"icon-size":.8,"text-anchor":"left"},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-country-3",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","country"],[">=","rank",3],["!has","name:de"]],layout:{"text-font":["Open Sans Bold"],"text-field":`{name:latin}
{name:nonlatin}`,"text-size":{stops:[[3,11],[7,17]]},"text-transform":"uppercase","text-max-width":6.25},paint:{"text-halo-blur":1,"text-color":"#fdfdfd","text-halo-width":2,"text-halo-color":"#433"}},{id:"place-country-3-en",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","country"],[">=","rank",3],["has","name:de"]],layout:{"text-font":["Open Sans Bold"],"text-field":`{name:de}
{name:nonlatin}`,"text-size":{stops:[[3,11],[7,17]]},"text-transform":"uppercase","text-max-width":6.25},paint:{"text-halo-blur":1,"text-color":"#fdfdfd","text-halo-width":2,"text-halo-color":"#433"}},{id:"place-country-2",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","country"],["==","rank",2],["!has","name:de"]],layout:{"text-font":["Open Sans Bold"],"text-field":`{name:latin}
{name:nonlatin}`,"text-size":{stops:[[2,11],[5,17]]},"text-transform":"uppercase","text-max-width":6.25},paint:{"text-halo-blur":1,"text-color":"#fdfdfd","text-halo-width":2,"text-halo-color":"#433"}},{id:"place-country-2-en",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","country"],["==","rank",2],["has","name:de"]],layout:{"text-font":["Open Sans Bold"],"text-field":`{name:de}
{name:nonlatin}`,"text-size":{stops:[[2,11],[5,17]]},"text-transform":"uppercase","text-max-width":6.25},paint:{"text-halo-blur":1,"text-color":"#fdfdfd","text-halo-width":2,"text-halo-color":"#433"}},{id:"place-country-1",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","country"],["==","rank",1],["!has","name:de"]],layout:{"text-font":["Open Sans Bold"],"text-field":`{name:latin}
{name:nonlatin}`,"text-size":{stops:[[1,11],[4,17]]},"text-transform":"uppercase","text-max-width":6.25},paint:{"text-halo-blur":1,"text-color":"#fdfdfd","text-halo-width":2,"text-halo-color":"#433"}},{id:"place-country-1-en",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","country"],["==","rank",1],["has","name:de"]],layout:{"text-font":["Open Sans Bold"],"text-field":`{name:de}
{name:nonlatin}`,"text-size":{stops:[[1,11],[4,17]]},"text-transform":"uppercase","text-max-width":6.25},paint:{"text-halo-blur":1,"text-color":"#fdfdfd","text-halo-width":2,"text-halo-color":"#433"}},{id:"place-continent",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",maxzoom:1,filter:["all",["==","class","continent"],["!has","name:de"]],layout:{"text-font":["Open Sans Bold"],"text-field":`{name:latin}
{name:nonlatin}`,"text-size":14,"text-max-width":6.25,"text-transform":"uppercase"},paint:{"text-halo-blur":1,"text-color":"#fdfdfd","text-halo-width":2,"text-halo-color":"#433"}},{id:"place-continent-en",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",maxzoom:1,filter:["all",["==","class","continent"],["has","name:de"]],layout:{"text-font":["Open Sans Bold"],"text-field":`{name:de}
{name:nonlatin}`,"text-size":14,"text-max-width":6.25,"text-transform":"uppercase"},paint:{"text-halo-blur":1,"text-color":"#fdfdfd","text-halo-width":2,"text-halo-color":"#433"}}]},B_="https://mapcomponents.github.io/react-map-components-maplibre/assets/style_thumbnails/",C$=({sx:t,styles:e=[],defaultStyles:r=!0,styleThumbnailPaths:n})=>{const i=ht.useContext(FR),[a,s]=ht.useState(!1);return K.jsxs(K.Fragment,{children:[K.jsx(Ji,{variant:"contained",sx:{marginTop:"10px",...t},onClick:()=>s(!0),children:K.jsx(ANe,{})}),K.jsx(QS,{styles:[...r?[INe,PNe,kNe,MNe,RNe]:[],...e||[]],styleThumbnailPaths:{...n,...r?{Monokai:B_+"monokai.png",Gruvbox:B_+"gruvbox.png","Oceanic Next":B_+"oceanic_next.png",Solarized:B_+"solarized.png","Medieval Kingdom":B_+"medieval_kingdom.png"}:{}},open:a,setOpen:s,onSelect:o=>{i.setBackgroundLayers([]),setTimeout(()=>{i.updateStyle(o)},100),s(!1)}})]})};try{C$.displayName="SelectStyleButton",C$.__docgenInfo={description:"",displayName:"SelectStyleButton",props:{sx:{defaultValue:null,description:"",name:"sx",required:!1,type:{name:"SxProps | undefined"}},onComplete:{defaultValue:null,description:"",name:"onComplete",required:!1,type:{name:"((config: StyleSpecification[]) => void) | undefined"}},styles:{defaultValue:{value:"[]"},description:"",name:"styles",required:!1,type:{name:"StyleSpecification[] | undefined"}},defaultStyles:{defaultValue:{value:"true"},description:"",name:"defaultStyles",required:!1,type:{name:"boolean | undefined"}},styleThumbnailPaths:{defaultValue:null,description:"",name:"styleThumbnailPaths",required:!1,type:{name:"{ [key: string]: string; } | undefined"}}}}}catch{}var vI={exports:{}},_I={};/**
 * @license React
 * use-sync-external-store-with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var A$;function ONe(){if(A$)return _I;A$=1;var t=Lb();function e(u,h){return u===h&&(u!==0||1/u===1/h)||u!==u&&h!==h}var r=typeof Object.is=="function"?Object.is:e,n=t.useSyncExternalStore,i=t.useRef,a=t.useEffect,s=t.useMemo,o=t.useDebugValue;return _I.useSyncExternalStoreWithSelector=function(u,h,f,g,b){var v=i(null);if(v.current===null){var S={hasValue:!1,value:null};v.current=S}else S=v.current;v=s(function(){function P(z){if(!k){if(k=!0,L=z,z=g(z),b!==void 0&&S.hasValue){var B=S.value;if(b(B,z))return O=B}return O=z}if(B=O,r(L,z))return B;var q=g(z);return b!==void 0&&b(B,q)?(L=z,B):(L=z,O=q)}var k=!1,L,O,M=f===void 0?null:f;return[function(){return P(h())},M===null?void 0:function(){return P(M())}]},[h,f,g,b]);var E=n(u,v[0],v[1]);return a(function(){S.hasValue=!0,S.value=E},[E]),o(E),E},_I}var I$;function LNe(){return I$||(I$=1,vI.exports=ONe()),vI.exports}var NNe=LNe(),DNe=Symbol.for("react-redux-context"),FNe=typeof globalThis<"u"?globalThis:{};function BNe(){if(!ee.createContext)return{};const t=FNe[DNe]??=new Map;let e=t.get(ee.createContext);return e||(e=ee.createContext(null),t.set(ee.createContext,e)),e}var Im=BNe();function yN(t=Im){return function(){return ee.useContext(t)}}var vQ=yN();function _Q(t=Im){const e=t===Im?vQ:yN(t),r=()=>{const{store:n}=e();return n};return Object.assign(r,{withTypes:()=>r}),r}var zNe=_Q();function jNe(t=Im){const e=t===Im?zNe:_Q(t),r=()=>e().dispatch;return Object.assign(r,{withTypes:()=>r}),r}var bQ=jNe(),UNe=(t,e)=>t===e;function VNe(t=Im){const e=t===Im?vQ:yN(t),r=(n,i={})=>{const{equalityFn:a=UNe}=typeof i=="function"?{equalityFn:i}:i,s=e(),{store:o,subscription:u,getServerState:h}=s;ee.useRef(!0);const f=ee.useCallback({[n.name](b){return n(b)}}[n.name],[n]),g=NNe.useSyncExternalStoreWithSelector(u.addNestedSub,o.getState,h||o.getState,f,a);return ee.useDebugValue(g),g};return Object.assign(r,{withTypes:()=>r}),r}var um=VNe();function du(t){return`Minified Redux error #${t}; visit https://redux.js.org/Errors?code=${t} for the full message or use the non-minified dev environment for full errors. `}var $Ne=typeof Symbol=="function"&&Symbol.observable||"@@observable",P$=$Ne,bI=()=>Math.random().toString(36).substring(7).split("").join("."),qNe={INIT:`@@redux/INIT${bI()}`,REPLACE:`@@redux/REPLACE${bI()}`,PROBE_UNKNOWN_ACTION:()=>`@@redux/PROBE_UNKNOWN_ACTION${bI()}`},eE=qNe;function vN(t){if(typeof t!="object"||t===null)return!1;let e=t;for(;Object.getPrototypeOf(e)!==null;)e=Object.getPrototypeOf(e);return Object.getPrototypeOf(t)===e||Object.getPrototypeOf(t)===null}function xQ(t,e,r){if(typeof t!="function")throw new Error(du(2));if(typeof e=="function"&&typeof r=="function"||typeof r=="function"&&typeof arguments[3]=="function")throw new Error(du(0));if(typeof e=="function"&&typeof r>"u"&&(r=e,e=void 0),typeof r<"u"){if(typeof r!="function")throw new Error(du(1));return r(xQ)(t,e)}let n=t,i=e,a=new Map,s=a,o=0,u=!1;function h(){s===a&&(s=new Map,a.forEach((P,k)=>{s.set(k,P)}))}function f(){if(u)throw new Error(du(3));return i}function g(P){if(typeof P!="function")throw new Error(du(4));if(u)throw new Error(du(5));let k=!0;h();const L=o++;return s.set(L,P),function(){if(k){if(u)throw new Error(du(6));k=!1,h(),s.delete(L),a=null}}}function b(P){if(!vN(P))throw new Error(du(7));if(typeof P.type>"u")throw new Error(du(8));if(typeof P.type!="string")throw new Error(du(17));if(u)throw new Error(du(9));try{u=!0,i=n(i,P)}finally{u=!1}return(a=s).forEach(L=>{L()}),P}function v(P){if(typeof P!="function")throw new Error(du(10));n=P,b({type:eE.REPLACE})}function S(){const P=g;return{subscribe(k){if(typeof k!="object"||k===null)throw new Error(du(11));function L(){const M=k;M.next&&M.next(f())}return L(),{unsubscribe:P(L)}},[P$](){return this}}}return b({type:eE.INIT}),{dispatch:b,subscribe:g,getState:f,replaceReducer:v,[P$]:S}}function HNe(t){Object.keys(t).forEach(e=>{const r=t[e];if(typeof r(void 0,{type:eE.INIT})>"u")throw new Error(du(12));if(typeof r(void 0,{type:eE.PROBE_UNKNOWN_ACTION()})>"u")throw new Error(du(13))})}function WNe(t){const e=Object.keys(t),r={};for(let a=0;a<e.length;a++){const s=e[a];typeof t[s]=="function"&&(r[s]=t[s])}const n=Object.keys(r);let i;try{HNe(r)}catch(a){i=a}return function(s={},o){if(i)throw i;let u=!1;const h={};for(let f=0;f<n.length;f++){const g=n[f],b=r[g],v=s[g],S=b(v,o);if(typeof S>"u")throw o&&o.type,new Error(du(14));h[g]=S,u=u||S!==v}return u=u||n.length!==Object.keys(s).length,u?h:s}}function tE(...t){return t.length===0?e=>e:t.length===1?t[0]:t.reduce((e,r)=>(...n)=>e(r(...n)))}function GNe(...t){return e=>(r,n)=>{const i=e(r,n);let a=()=>{throw new Error(du(15))};const s={getState:i.getState,dispatch:(u,...h)=>a(u,...h)},o=t.map(u=>u(s));return a=tE(...o)(i.dispatch),{...i,dispatch:a}}}function XNe(t){return vN(t)&&"type"in t&&typeof t.type=="string"}var wQ=Symbol.for("immer-nothing"),k$=Symbol.for("immer-draftable"),sh=Symbol.for("immer-state");function Qh(t,...e){throw new Error(`[Immer] minified error nr: ${t}. Full error at: https://bit.ly/3cXEKWf`)}var v0=Object.getPrototypeOf;function Pm(t){return!!t&&!!t[sh]}function Jd(t){return t?SQ(t)||Array.isArray(t)||!!t[k$]||!!t.constructor?.[k$]||gx(t)||XT(t):!1}var YNe=Object.prototype.constructor.toString();function SQ(t){if(!t||typeof t!="object")return!1;const e=v0(t);if(e===null)return!0;const r=Object.hasOwnProperty.call(e,"constructor")&&e.constructor;return r===Object?!0:typeof r=="function"&&Function.toString.call(r)===YNe}function rE(t,e){GT(t)===0?Reflect.ownKeys(t).forEach(r=>{e(r,t[r],t)}):t.forEach((r,n)=>e(n,r,t))}function GT(t){const e=t[sh];return e?e.type_:Array.isArray(t)?1:gx(t)?2:XT(t)?3:0}function IM(t,e){return GT(t)===2?t.has(e):Object.prototype.hasOwnProperty.call(t,e)}function EQ(t,e,r){const n=GT(t);n===2?t.set(e,r):n===3?t.add(r):t[e]=r}function ZNe(t,e){return t===e?t!==0||1/t===1/e:t!==t&&e!==e}function gx(t){return t instanceof Map}function XT(t){return t instanceof Set}function Ug(t){return t.copy_||t.base_}function PM(t,e){if(gx(t))return new Map(t);if(XT(t))return new Set(t);if(Array.isArray(t))return Array.prototype.slice.call(t);const r=SQ(t);if(e===!0||e==="class_only"&&!r){const n=Object.getOwnPropertyDescriptors(t);delete n[sh];let i=Reflect.ownKeys(n);for(let a=0;a<i.length;a++){const s=i[a],o=n[s];o.writable===!1&&(o.writable=!0,o.configurable=!0),(o.get||o.set)&&(n[s]={configurable:!0,writable:!0,enumerable:o.enumerable,value:t[s]})}return Object.create(v0(t),n)}else{const n=v0(t);if(n!==null&&r)return{...t};const i=Object.create(n);return Object.assign(i,t)}}function _N(t,e=!1){return YT(t)||Pm(t)||!Jd(t)||(GT(t)>1&&Object.defineProperties(t,{set:{value:j2},add:{value:j2},clear:{value:j2},delete:{value:j2}}),Object.freeze(t),e&&Object.values(t).forEach(r=>_N(r,!0))),t}function j2(){Qh(2)}function YT(t){return Object.isFrozen(t)}var KNe={};function km(t){const e=KNe[t];return e||Qh(0,t),e}var Sb;function TQ(){return Sb}function JNe(t,e){return{drafts_:[],parent_:t,immer_:e,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function M$(t,e){e&&(km("Patches"),t.patches_=[],t.inversePatches_=[],t.patchListener_=e)}function kM(t){MM(t),t.drafts_.forEach(QNe),t.drafts_=null}function MM(t){t===Sb&&(Sb=t.parent_)}function R$(t){return Sb=JNe(Sb,t)}function QNe(t){const e=t[sh];e.type_===0||e.type_===1?e.revoke_():e.revoked_=!0}function O$(t,e){e.unfinalizedDrafts_=e.drafts_.length;const r=e.drafts_[0];return t!==void 0&&t!==r?(r[sh].modified_&&(kM(e),Qh(4)),Jd(t)&&(t=nE(e,t),e.parent_||iE(e,t)),e.patches_&&km("Patches").generateReplacementPatches_(r[sh].base_,t,e.patches_,e.inversePatches_)):t=nE(e,r,[]),kM(e),e.patches_&&e.patchListener_(e.patches_,e.inversePatches_),t!==wQ?t:void 0}function nE(t,e,r){if(YT(e))return e;const n=e[sh];if(!n)return rE(e,(i,a)=>L$(t,n,e,i,a,r)),e;if(n.scope_!==t)return e;if(!n.modified_)return iE(t,n.base_,!0),n.base_;if(!n.finalized_){n.finalized_=!0,n.scope_.unfinalizedDrafts_--;const i=n.copy_;let a=i,s=!1;n.type_===3&&(a=new Set(i),i.clear(),s=!0),rE(a,(o,u)=>L$(t,n,i,o,u,r,s)),iE(t,i,!1),r&&t.patches_&&km("Patches").generatePatches_(n,r,t.patches_,t.inversePatches_)}return n.copy_}function L$(t,e,r,n,i,a,s){if(Pm(i)){const o=a&&e&&e.type_!==3&&!IM(e.assigned_,n)?a.concat(n):void 0,u=nE(t,i,o);if(EQ(r,n,u),Pm(u))t.canAutoFreeze_=!1;else return}else s&&r.add(i);if(Jd(i)&&!YT(i)){if(!t.immer_.autoFreeze_&&t.unfinalizedDrafts_<1)return;nE(t,i),(!e||!e.scope_.parent_)&&typeof n!="symbol"&&(gx(r)?r.has(n):Object.prototype.propertyIsEnumerable.call(r,n))&&iE(t,i)}}function iE(t,e,r=!1){!t.parent_&&t.immer_.autoFreeze_&&t.canAutoFreeze_&&_N(e,r)}function eDe(t,e){const r=Array.isArray(t),n={type_:r?1:0,scope_:e?e.scope_:TQ(),modified_:!1,finalized_:!1,assigned_:{},parent_:e,base_:t,draft_:null,copy_:null,revoke_:null,isManual_:!1};let i=n,a=bN;r&&(i=[n],a=Eb);const{revoke:s,proxy:o}=Proxy.revocable(i,a);return n.draft_=o,n.revoke_=s,o}var bN={get(t,e){if(e===sh)return t;const r=Ug(t);if(!IM(r,e))return tDe(t,r,e);const n=r[e];return t.finalized_||!Jd(n)?n:n===xI(t.base_,e)?(wI(t),t.copy_[e]=OM(n,t)):n},has(t,e){return e in Ug(t)},ownKeys(t){return Reflect.ownKeys(Ug(t))},set(t,e,r){const n=CQ(Ug(t),e);if(n?.set)return n.set.call(t.draft_,r),!0;if(!t.modified_){const i=xI(Ug(t),e),a=i?.[sh];if(a&&a.base_===r)return t.copy_[e]=r,t.assigned_[e]=!1,!0;if(ZNe(r,i)&&(r!==void 0||IM(t.base_,e)))return!0;wI(t),RM(t)}return t.copy_[e]===r&&(r!==void 0||e in t.copy_)||Number.isNaN(r)&&Number.isNaN(t.copy_[e])||(t.copy_[e]=r,t.assigned_[e]=!0),!0},deleteProperty(t,e){return xI(t.base_,e)!==void 0||e in t.base_?(t.assigned_[e]=!1,wI(t),RM(t)):delete t.assigned_[e],t.copy_&&delete t.copy_[e],!0},getOwnPropertyDescriptor(t,e){const r=Ug(t),n=Reflect.getOwnPropertyDescriptor(r,e);return n&&{writable:!0,configurable:t.type_!==1||e!=="length",enumerable:n.enumerable,value:r[e]}},defineProperty(){Qh(11)},getPrototypeOf(t){return v0(t.base_)},setPrototypeOf(){Qh(12)}},Eb={};rE(bN,(t,e)=>{Eb[t]=function(){return arguments[0]=arguments[0][0],e.apply(this,arguments)}});Eb.deleteProperty=function(t,e){return Eb.set.call(this,t,e,void 0)};Eb.set=function(t,e,r){return bN.set.call(this,t[0],e,r,t[0])};function xI(t,e){const r=t[sh];return(r?Ug(r):t)[e]}function tDe(t,e,r){const n=CQ(e,r);return n?"value"in n?n.value:n.get?.call(t.draft_):void 0}function CQ(t,e){if(!(e in t))return;let r=v0(t);for(;r;){const n=Object.getOwnPropertyDescriptor(r,e);if(n)return n;r=v0(r)}}function RM(t){t.modified_||(t.modified_=!0,t.parent_&&RM(t.parent_))}function wI(t){t.copy_||(t.copy_=PM(t.base_,t.scope_.immer_.useStrictShallowCopy_))}var rDe=class{constructor(t){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.produce=(e,r,n)=>{if(typeof e=="function"&&typeof r!="function"){const a=r;r=e;const s=this;return function(u=a,...h){return s.produce(u,f=>r.call(this,f,...h))}}typeof r!="function"&&Qh(6),n!==void 0&&typeof n!="function"&&Qh(7);let i;if(Jd(e)){const a=R$(this),s=OM(e,void 0);let o=!0;try{i=r(s),o=!1}finally{o?kM(a):MM(a)}return M$(a,n),O$(i,a)}else if(!e||typeof e!="object"){if(i=r(e),i===void 0&&(i=e),i===wQ&&(i=void 0),this.autoFreeze_&&_N(i,!0),n){const a=[],s=[];km("Patches").generateReplacementPatches_(e,i,a,s),n(a,s)}return i}else Qh(1,e)},this.produceWithPatches=(e,r)=>{if(typeof e=="function")return(s,...o)=>this.produceWithPatches(s,u=>e(u,...o));let n,i;return[this.produce(e,r,(s,o)=>{n=s,i=o}),n,i]},typeof t?.autoFreeze=="boolean"&&this.setAutoFreeze(t.autoFreeze),typeof t?.useStrictShallowCopy=="boolean"&&this.setUseStrictShallowCopy(t.useStrictShallowCopy)}createDraft(t){Jd(t)||Qh(8),Pm(t)&&(t=nDe(t));const e=R$(this),r=OM(t,void 0);return r[sh].isManual_=!0,MM(e),r}finishDraft(t,e){const r=t&&t[sh];(!r||!r.isManual_)&&Qh(9);const{scope_:n}=r;return M$(n,e),O$(void 0,n)}setAutoFreeze(t){this.autoFreeze_=t}setUseStrictShallowCopy(t){this.useStrictShallowCopy_=t}applyPatches(t,e){let r;for(r=e.length-1;r>=0;r--){const i=e[r];if(i.path.length===0&&i.op==="replace"){t=i.value;break}}r>-1&&(e=e.slice(r+1));const n=km("Patches").applyPatches_;return Pm(t)?n(t,e):this.produce(t,i=>n(i,e))}};function OM(t,e){const r=gx(t)?km("MapSet").proxyMap_(t,e):XT(t)?km("MapSet").proxySet_(t,e):eDe(t,e);return(e?e.scope_:TQ()).drafts_.push(r),r}function nDe(t){return Pm(t)||Qh(10,t),AQ(t)}function AQ(t){if(!Jd(t)||YT(t))return t;const e=t[sh];let r;if(e){if(!e.modified_)return e.base_;e.finalized_=!0,r=PM(t,e.scope_.immer_.useStrictShallowCopy_)}else r=PM(t,!0);return rE(r,(n,i)=>{EQ(r,n,AQ(i))}),e&&(e.finalized_=!1),r}var iDe=new rDe,IQ=iDe.produce;function PQ(t){return({dispatch:r,getState:n})=>i=>a=>typeof a=="function"?a(r,n,t):i(a)}var aDe=PQ(),oDe=PQ,sDe=typeof window<"u"&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__:function(){if(arguments.length!==0)return typeof arguments[0]=="object"?tE:tE.apply(null,arguments)};function N$(t,e){function r(...n){if(e){let i=e(...n);if(!i)throw new Error(Vd(0));return{type:t,payload:i.payload,..."meta"in i&&{meta:i.meta},..."error"in i&&{error:i.error}}}return{type:t,payload:n[0]}}return r.toString=()=>`${t}`,r.type=t,r.match=n=>XNe(n)&&n.type===t,r}var kQ=class f1 extends Array{constructor(...e){super(...e),Object.setPrototypeOf(this,f1.prototype)}static get[Symbol.species](){return f1}concat(...e){return super.concat.apply(this,e)}prepend(...e){return e.length===1&&Array.isArray(e[0])?new f1(...e[0].concat(this)):new f1(...e.concat(this))}};function D$(t){return Jd(t)?IQ(t,()=>{}):t}function U2(t,e,r){return t.has(e)?t.get(e):t.set(e,r(e)).get(e)}function lDe(t){return typeof t=="boolean"}var uDe=()=>function(e){const{thunk:r=!0,immutableCheck:n=!0,serializableCheck:i=!0,actionCreatorCheck:a=!0}=e??{};let s=new kQ;return r&&(lDe(r)?s.push(aDe):s.push(oDe(r.extraArgument))),s},cDe="RTK_autoBatch",F$=t=>e=>{setTimeout(e,t)},hDe=(t={type:"raf"})=>e=>(...r)=>{const n=e(...r);let i=!0,a=!1,s=!1;const o=new Set,u=t.type==="tick"?queueMicrotask:t.type==="raf"?typeof window<"u"&&window.requestAnimationFrame?window.requestAnimationFrame:F$(10):t.type==="callback"?t.queueNotification:F$(t.timeout),h=()=>{s=!1,a&&(a=!1,o.forEach(f=>f()))};return Object.assign({},n,{subscribe(f){const g=()=>i&&f(),b=n.subscribe(g);return o.add(f),()=>{b(),o.delete(f)}},dispatch(f){try{return i=!f?.meta?.[cDe],a=!i,a&&(s||(s=!0,u(h))),n.dispatch(f)}finally{i=!0}}})},fDe=t=>function(r){const{autoBatch:n=!0}=r??{};let i=new kQ(t);return n&&i.push(hDe(typeof n=="object"?n:void 0)),i};function dDe(t){const e=uDe(),{reducer:r=void 0,middleware:n,devTools:i=!0,preloadedState:a=void 0,enhancers:s=void 0}=t||{};let o;if(typeof r=="function")o=r;else if(vN(r))o=WNe(r);else throw new Error(Vd(1));let u;typeof n=="function"?u=n(e):u=e();let h=tE;i&&(h=sDe({trace:!1,...typeof i=="object"&&i}));const f=GNe(...u),g=fDe(f);let b=typeof s=="function"?s(g):g();const v=h(...b);return xQ(o,a,v)}function MQ(t){const e={},r=[];let n;const i={addCase(a,s){const o=typeof a=="string"?a:a.type;if(!o)throw new Error(Vd(28));if(o in e)throw new Error(Vd(29));return e[o]=s,i},addAsyncThunk(a,s){return s.pending&&(e[a.pending.type]=s.pending),s.rejected&&(e[a.rejected.type]=s.rejected),s.fulfilled&&(e[a.fulfilled.type]=s.fulfilled),s.settled&&r.push({matcher:a.settled,reducer:s.settled}),i},addMatcher(a,s){return r.push({matcher:a,reducer:s}),i},addDefaultCase(a){return n=a,i}};return t(i),[e,r,n]}function pDe(t){return typeof t=="function"}function gDe(t,e){let[r,n,i]=MQ(e),a;if(pDe(t))a=()=>D$(t());else{const o=D$(t);a=()=>o}function s(o=a(),u){let h=[r[u.type],...n.filter(({matcher:f})=>f(u)).map(({reducer:f})=>f)];return h.filter(f=>!!f).length===0&&(h=[i]),h.reduce((f,g)=>{if(g)if(Pm(f)){const v=g(f,u);return v===void 0?f:v}else{if(Jd(f))return IQ(f,b=>g(b,u));{const b=g(f,u);if(b===void 0){if(f===null)return f;throw Error("A case reducer on a non-draftable value must not return undefined")}return b}}return f},o)}return s.getInitialState=a,s}var mDe=Symbol.for("rtk-slice-createasyncthunk");function yDe(t,e){return`${t}/${e}`}function vDe({creators:t}={}){const e=t?.asyncThunk?.[mDe];return function(n){const{name:i,reducerPath:a=i}=n;if(!i)throw new Error(Vd(11));const s=(typeof n.reducers=="function"?n.reducers(xDe()):n.reducers)||{},o=Object.keys(s),u={sliceCaseReducersByName:{},sliceCaseReducersByType:{},actionCreators:{},sliceMatchers:[]},h={addCase(O,M){const z=typeof O=="string"?O:O.type;if(!z)throw new Error(Vd(12));if(z in u.sliceCaseReducersByType)throw new Error(Vd(13));return u.sliceCaseReducersByType[z]=M,h},addMatcher(O,M){return u.sliceMatchers.push({matcher:O,reducer:M}),h},exposeAction(O,M){return u.actionCreators[O]=M,h},exposeCaseReducer(O,M){return u.sliceCaseReducersByName[O]=M,h}};o.forEach(O=>{const M=s[O],z={reducerName:O,type:yDe(i,O),createNotation:typeof n.reducers=="function"};SDe(M)?TDe(z,M,h,e):wDe(z,M,h)});function f(){const[O={},M=[],z=void 0]=typeof n.extraReducers=="function"?MQ(n.extraReducers):[n.extraReducers],B={...O,...u.sliceCaseReducersByType};return gDe(n.initialState,q=>{for(let W in B)q.addCase(W,B[W]);for(let W of u.sliceMatchers)q.addMatcher(W.matcher,W.reducer);for(let W of M)q.addMatcher(W.matcher,W.reducer);z&&q.addDefaultCase(z)})}const g=O=>O,b=new Map,v=new WeakMap;let S;function E(O,M){return S||(S=f()),S(O,M)}function P(){return S||(S=f()),S.getInitialState()}function k(O,M=!1){function z(q){let W=q[O];return typeof W>"u"&&M&&(W=U2(v,z,P)),W}function B(q=g){const W=U2(b,M,()=>new WeakMap);return U2(W,q,()=>{const G={};for(const[ie,Q]of Object.entries(n.selectors??{}))G[ie]=_De(Q,q,()=>U2(v,q,P),M);return G})}return{reducerPath:O,getSelectors:B,get selectors(){return B(z)},selectSlice:z}}const L={name:i,reducer:E,actions:u.actionCreators,caseReducers:u.sliceCaseReducersByName,getInitialState:P,...k(a),injectInto(O,{reducerPath:M,...z}={}){const B=M??a;return O.inject({reducerPath:B,reducer:E},z),{...L,...k(B,!0)}}};return L}}function _De(t,e,r,n){function i(a,...s){let o=e(a);return typeof o>"u"&&n&&(o=r()),t(o,...s)}return i.unwrapped=t,i}var bDe=vDe();function xDe(){function t(e,r){return{_reducerDefinitionType:"asyncThunk",payloadCreator:e,...r}}return t.withTypes=()=>t,{reducer(e){return Object.assign({[e.name](...r){return e(...r)}}[e.name],{_reducerDefinitionType:"reducer"})},preparedReducer(e,r){return{_reducerDefinitionType:"reducerWithPrepare",prepare:e,reducer:r}},asyncThunk:t}}function wDe({type:t,reducerName:e,createNotation:r},n,i){let a,s;if("reducer"in n){if(r&&!EDe(n))throw new Error(Vd(17));a=n.reducer,s=n.prepare}else a=n;i.addCase(t,a).exposeCaseReducer(e,a).exposeAction(e,s?N$(t,s):N$(t))}function SDe(t){return t._reducerDefinitionType==="asyncThunk"}function EDe(t){return t._reducerDefinitionType==="reducerWithPrepare"}function TDe({type:t,reducerName:e},r,n,i){if(!i)throw new Error(Vd(18));const{payloadCreator:a,fulfilled:s,pending:o,rejected:u,settled:h,options:f}=r,g=i(t,a,f);n.exposeAction(e,g),s&&n.addCase(g.fulfilled,s),o&&n.addCase(g.pending,o),u&&n.addCase(g.rejected,u),h&&n.addMatcher(g.settled,h),n.exposeCaseReducer(e,{fulfilled:s||V2,pending:o||V2,rejected:u||V2,settled:h||V2})}function V2(){}function Vd(t){return`Minified Redux Toolkit error #${t}; visit https://redux-toolkit.js.org/Errors?code=${t} for the full message or use the non-minified dev environment for full errors. `}function RQ(t,e,r){e.forEach(n=>{t(n,r),n.layers&&n.layers.length>0&&RQ(t,n.layers,n)})}const CDe={mapConfigs:{}},OQ=bDe({name:"mapConfig",initialState:CDe,reducers:{setMapConfig:(t,e)=>{const r=e.payload.mapConfig,n=e.payload.key;t.mapConfigs[n]=r},removeMapConfig:(t,e)=>{delete t.mapConfigs[e.payload.key]},setLayerInMapConfig:(t,e)=>{const{mapConfigKey:r,layer:n}=e.payload,i=t.mapConfigs[r];if(i){for(let a=0;a<i.layers.length;a++)if(i.layers[a].uuid===n.uuid){i.layers[a]=n;break}}},removeLayerFromMapConfig:(t,e)=>{const{mapConfigKey:r,layerUuid:n}=e.payload,i=t.mapConfigs[r];if(i){const a=i.layers.findIndex(s=>s.uuid===n);a!==-1&&(delete i.layers[a],RQ(function(s,o){o&&o.layers&&(o.layers=o.layers.filter(u=>u.uuid!==n))},i.layerOrder))}},updateLayerOrder:(t,e)=>{const{mapConfigKey:r,newOrder:n}=e.payload,i=t.mapConfigs[r];i&&(i.layerOrder=n)},setMasterVisible(t,e){const{mapConfigKey:r,layerId:n,masterVisible:i}=e.payload,a=t.mapConfigs[r];if(a){const s=a.layers.findIndex(o=>o.uuid===n);if(s!==-1){const o=a.layers[s];if(o){const u=[...a.layers];o.type==="folder"&&a.layerOrder.forEach(h=>{h.uuid===n&&h.layers?.forEach(f=>{const g=a.layers.findIndex(v=>v.uuid===f.uuid),b=u[g];u[g]={...b,masterVisible:i},b?.type==="vt"&&b?.config?.layers&&(b.config.layers=b.config.layers.map(v=>({...v,masterVisible:i})))})}),o.type==="vt"&&o?.config?.layers&&(o.config.layers=o.config.layers.map(h=>({...h,masterVisible:i}))),t.mapConfigs[r].layers=u}}}}}}),LQ=(t,e)=>{const r=t.mapConfigs;for(const n in r){const i=r[n],a=i.layers.findIndex(o=>o.uuid===e),s=i.layers[a];if(s)return s}return null},ADe=(t,e)=>{const r=t.mapConfig.mapConfigs[e];if(!r)return[];const n=r.layerOrder,i=[];function a(s){s.forEach(o=>{i.push(o.uuid),o.layers&&o.layers.length>0&&a(o.layers)})}return a(n),i};dDe({reducer:{mapConfig:OQ.reducer}});const{setMapConfig:TWe,removeMapConfig:CWe,setLayerInMapConfig:NQ,removeLayerFromMapConfig:AWe,updateLayerOrder:IDe,setMasterVisible:PDe}=OQ.actions,B$=Hi(K.jsx("path",{d:"M8.59 16.59 13.17 12 8.59 7.41 10 6l6 6-6 6z"}));function LM(t){return K.jsx(pb,{value:t.value,label:"Color",onChange:e=>{typeof t.onChange=="function"&&t.onChange(e)}})}try{LM.displayName="PaintPropsColorPicker",LM.__docgenInfo={description:"",displayName:"PaintPropsColorPicker",props:{value:{defaultValue:null,description:"",name:"value",required:!0,type:{name:"string"}},onChange:{defaultValue:null,description:"",name:"onChange",required:!0,type:{name:"(value: string) => void"}}}}}catch{}const kDe=Pr(Th)({marginLeft:"-100px",marginRight:"-21px",paddingLeft:"53px",borderRadius:"0px",boxShadow:"none",backgroundColor:"rgb(0, 0, 0, 0)"}),MDe=Pr(Vo)({marginLeft:"61px"}),DQ={"circle-color":"colorpicker","circle-radius":"slider","circle-stroke-color":"colorpicker","circle-stroke-width":"slider","fill-color":"colorpicker","fill-outline-color":"colorpicker","line-color":"colorpicker","line-width":"slider","line-blur":"slider"},RDe=Object.keys(DQ),ODe={"circle-stroke-width":{step:1,min:1,max:20},"circle-radius":{step:1,min:1,max:100},"line-blur":{step:1,min:1,max:100},"line-width":{step:1,min:1,max:100}};function NM(t){const e=ee.useRef(Math.round(Math.random()*1e10)),r=LQ(um(o=>o.mapConfig),t.layerUuid),n=bQ(),i=ee.useMemo(()=>r?.config?.options?.paint?r?.config?.options?.paint:{},[r?.config?.options?.paint]),a=(o,u)=>{const h={...r,config:{...r?.config,options:{...r?.config?.options,paint:{...r?.config?.options?.paint,[o]:u}}}};n(NQ({mapConfigKey:t.mapConfigKey,layer:h}))},s=ee.useCallback(o=>{if(i?.[o]&&RDe.indexOf(o)!==-1&&(typeof i[o]=="number"||typeof i[o]=="string")){const u=K.jsx(vs,{id:o+"_label",gutterBottom:!0,children:o});switch(DQ[o]){case"slider":return K.jsxs(ht.Fragment,{children:[u,K.jsx(aO,{...ODe[o],value:i[o],valueLabelDisplay:"auto",onChange:(h,f)=>{f&&typeof f=="number"&&a(o,f)}})]},o);case"numberfield":return K.jsxs(ht.Fragment,{children:[u,K.jsx(nT,{inputProps:{inputMode:"decimal",pattern:"[0-9]*"},value:i[o],onChange:h=>{h?.target?.value&&a(o,parseInt(h.target.value))}})]},o);case"colorpicker":return K.jsxs(ht.Fragment,{children:[u,K.jsx(Vo,{sx:{"& > div":{width:"initial !important"}},children:K.jsx(LM,{value:i[o],onChange:h=>{a(o,h)}},o)})]},o)}}return null},[i]);return K.jsx(K.Fragment,{children:K.jsx(kDe,{children:K.jsx(Ih,{children:K.jsx(MDe,{children:i&&Object.keys(i).map(o=>s(o))})},e.current+"_paintPropForm")})})}try{NM.displayName="LayerPropertyForm",NM.__docgenInfo={description:"",displayName:"LayerPropertyForm",props:{layerUuid:{defaultValue:null,description:"",name:"layerUuid",required:!0,type:{name:"string"}},mapConfigKey:{defaultValue:null,description:"",name:"mapConfigKey",required:!0,type:{name:"string"}}}}}catch{}const LDe=Pr(eh)({padding:"4px",marginTop:"-3px"}),NDe=Pr(eh)({marginLeft:"20px"}),z_=Pr(Ih)({paddingRight:0,paddingLeft:0,paddingTop:0,paddingBottom:"4px"}),SI=Pr(Q1)({minWidth:"30px"}),$2=Pr(eh)({marginRight:"0px",padding:"0px"}),z$=Pr(Vo)(({open:t})=>({display:t?"block":"none"})),j$=Pr(ff)({marginLeft:"50px"});function aE(t){const[e,r]=ee.useState(!1),[n,i]=ee.useState(!1),a=LQ(um(P=>P.mapConfig),t.layerOrderConfig.uuid),[s,o]=ee.useState(!1),u=bQ(),h=um(P=>P.mapConfig.mapConfigs[t.mapConfigKey]);function f(P,k){const L=JSON.parse(JSON.stringify(h.layerOrder)),O=M=>{let z=!1;return M.forEach((B,q)=>{if(!z)if(B.uuid===P){const W=k(q);if(W<0||W>=M.length)throw new Error("New position is out of bounds");const[G]=M.splice(q,1);M.splice(W,0,G),z=!0}else B.layers&&O(B.layers)&&(z=!0)}),z};O(L),u(IDe({mapConfigKey:t.mapConfigKey,newOrder:L}))}const g=P=>{f(P,k=>k+1)},b=P=>{f(P,k=>k-1)};function v(P,k=""){const L=!P;a&&(S(a,L,k),(a.type==="folder"||a.type==="vt"&&k==="")&&u(PDe({mapConfigKey:t.mapConfigKey,layerId:a.uuid,masterVisible:L})))}function S(P,k,L){let O={...P};if(P?.type==="folder")O={...P,visible:!P.visible};else switch(P?.type){case"geojson":{O={...P,config:{...P.config,options:{...P?.config?.options,layout:{...P?.config?.options?.layout,visibility:k?"visible":"none"}}}};break}case"vt":{let M=!1;const z=P.config.layers.map(B=>B.id===L?(M=!0,{...B,layout:{...B.layout,visibility:k?"visible":"none"}}):B);M?O={...P,config:{...P.config,layers:z}}:O={...P,visible:k,config:{...P.config,layers:z}};break}case"wms":{O={...P,visible:k,config:{...P.config,visible:k}};break}}return u(NQ({mapConfigKey:t.mapConfigKey,layer:O})),O}function E(P){let k=!0;if(P?.type==="geojson")return k=P?.config?.options?.layout?.visibility!=="none",K.jsxs(K.Fragment,{children:[K.jsxs(z_,{sx:{...t.listItemSx},secondaryAction:K.jsxs(K.Fragment,{children:[t?.buttons,K.jsx($2,{disabled:!1,onClick:()=>{g(P.uuid)},children:K.jsx(Iw,{})}),K.jsx($2,{disabled:!1,onClick:()=>{b(P.uuid)},children:K.jsx(Pw,{})}),P.configurable&&K.jsx(K.Fragment,{children:K.jsx(LDe,{edge:"end","aria-label":"settings",onClick:()=>{r(L=>!L)},children:K.jsx(tL,{})})})]}),children:[K.jsx(Rd,{children:K.jsx(Od,{checked:k,disabled:P.masterVisible===!1,onClick:()=>v(k)})}),K.jsx(yh,{variant:"layerlist",primary:P.name||"",secondary:t.description,primaryTypographyProps:{overflow:"hidden"}}),t.buttons]},P.uuid),P.configurable&&e&&K.jsxs(K.Fragment,{children:[t.showDeleteButton&&K.jsxs(K.Fragment,{children:[K.jsx(NDe,{edge:"end","aria-label":"delete",onClick:()=>{},children:K.jsx(nx,{})}),n&&K.jsx(g0,{open:n,onConfirm:()=>{i(!1)},onCancel:()=>{i(!1)},title:"Delete layer",text:"Are you sure you want to delete this layer?"})]}),K.jsx(NM,{layerUuid:P.uuid,mapConfigKey:t.mapConfigKey})]})]});if(P?.type==="vt")return K.jsxs(K.Fragment,{children:[K.jsxs(z_,{sx:{...t.listItemSx},secondaryAction:void 0,children:[K.jsxs(SI,{children:[K.jsx($2,{edge:"end","aria-label":"open",onClick:()=>o(!s),children:s?K.jsx(xS,{}):K.jsx(B$,{})}),K.jsx(Rd,{children:K.jsx(Od,{checked:P.visible,disabled:P.masterVisible===!1,onClick:()=>v(P.visible??!1)})})]}),K.jsx(yh,{primary:P.name,secondary:t.description,primaryTypographyProps:{overflow:"hidden"}})]},P.uuid),K.jsx(z$,{open:s,children:K.jsx(j$,{disablePadding:!0,children:P.config?.layers?.map(L=>K.jsxs(z_,{sx:{...t.listItemSx},secondaryAction:void 0,children:[" ",K.jsx(SI,{children:K.jsx(Rd,{children:K.jsx(Od,{checked:(L?.layout?.visibility??"visible")==="visible",disabled:L?.masterVisible===!1,onClick:()=>v(L?.layout?.visibility==="visible",L.id)})})}),K.jsx(yh,{variant:"layerlist",primary:L["source-layer"],primaryTypographyProps:{overflow:"hidden"}},L.id)]},L.id))})},P.uuid+"_list")]});if(P?.type==="wms"){const L=P.config?.visible??!0;return K.jsx(K.Fragment,{children:K.jsxs(z_,{sx:{...t.listItemSx},secondaryAction:void 0,children:[K.jsx(Rd,{children:K.jsx(Od,{checked:L,disabled:P.masterVisible===!1,onClick:()=>v(L)})}),K.jsx(yh,{primary:P.name,secondary:t.description,primaryTypographyProps:{overflow:"hidden"}})]},P.uuid)})}return P.type==="folder"?K.jsxs(K.Fragment,{children:[K.jsxs(z_,{sx:{...t.listItemSx},children:[K.jsxs(SI,{children:[K.jsx($2,{edge:"end","aria-label":"open",onClick:()=>o(!s),children:s?K.jsx(xS,{}):K.jsx(B$,{})}),K.jsx(Rd,{children:K.jsx(Od,{checked:P.visible,disabled:P.masterVisible,onClick:()=>v(P.visible?P.visible:!1)})})]}),K.jsx(yh,{primary:P.name,secondary:t.description,primaryTypographyProps:{overflow:"hidden"}})]},P.uuid),K.jsx(z$,{open:s,children:K.jsx(j$,{disablePadding:!0,children:t?.layerOrderConfig?.layers?.map(L=>K.jsx(aE,{layerOrderConfig:L,mapConfigKey:t.mapConfigKey},L.uuid))})},P.uuid+"_list")]}):K.jsx(K.Fragment,{})}return K.jsx(K.Fragment,{children:a&&E(a)})}try{aE.displayName="LayerTreeListItem",aE.__docgenInfo={description:"",displayName:"LayerTreeListItem",props:{visible:{defaultValue:null,description:"",name:"visible",required:!1,type:{name:"boolean | undefined"}},type:{defaultValue:null,description:"",name:"type",required:!1,type:{name:"enum",value:[{value:"undefined"},{value:'"background"'},{value:'"layer"'},{value:'"background-labels"'},{value:'"wms-layer"'},{value:'"vector-tile-layer"'}]}},name:{defaultValue:null,description:"",name:"name",required:!1,type:{name:"string | undefined"}},description:{defaultValue:null,description:"",name:"description",required:!1,type:{name:"string | undefined"}},setLayerState:{defaultValue:null,description:"",name:"setLayerState",required:!1,type:{name:"((state: unknown) => void) | undefined"}},showDeleteButton:{defaultValue:null,description:"",name:"showDeleteButton",required:!1,type:{name:"boolean | undefined"}},listItemSx:{defaultValue:null,description:"",name:"listItemSx",required:!1,type:{name:"SxProps | undefined"}},buttons:{defaultValue:null,description:"",name:"buttons",required:!1,type:{name:"Element | undefined"}},sortable:{defaultValue:null,description:"",name:"sortable",required:!1,type:{name:"boolean | undefined"}},mapConfigKey:{defaultValue:null,description:"",name:"mapConfigKey",required:!0,type:{name:"string"}},layerOrderConfig:{defaultValue:null,description:"",name:"layerOrderConfig",required:!0,type:{name:"LayerOrderItem"}}}}}catch{}const DDe=Pr(ff)({marginTop:"15px"});function U$(t){const e=um(r=>r.mapConfig.mapConfigs?.[t.mapConfigKey]?.layerOrder);return K.jsx(DDe,{children:e?.map?.(r=>K.jsx(aE,{layerOrderConfig:r,mapConfigKey:t.mapConfigKey},r.uuid))})}try{U$.displayName="LayerTree",U$.__docgenInfo={description:"",displayName:"LayerTree",props:{mapConfigKey:{defaultValue:null,description:"",name:"mapConfigKey",required:!0,type:{name:"string"}}}}}catch{}function V$(t){const e=um(u=>u.mapConfig.mapConfigs?.[t.mapConfigKey]?.layers),r=um(u=>u.mapConfig.mapConfigs?.[t.mapConfigKey]?.layerOrder),n=ha({mapId:t?.mapId}),i=um(u=>ADe(u,t.mapConfigKey)),a=ee.useRef([]);ee.useEffect(()=>{if(!n.map||!r)return;const u=(f,g,b)=>{for(let v=0;v<f.length;v++){const S=f[v],E=g?g[v]:null;if(S.uuid!==E?.uuid&&b.getLayer(S.uuid)){const P=v>0?f[v-1].uuid:void 0;b.moveLayer(S.uuid,P)}if(S.layers&&S.layers.length>0){const P=E?.layers||[];u(S.layers,P,b)}}},h=a.current;u(r,h,n.map),a.current=r},[r,n.map]);const s=ee.useMemo(()=>["order-background",...i.map(h=>"layer_id_"+h),"order-labels"],[i]);function o(u){const h=e.findIndex(g=>g.uuid===u.uuid),f=e[h];switch(f?.type){case"geojson":return K.jsx(wc,{layerId:f.uuid,insertBeforeLayer:"layer_id_"+f.uuid,...f.config,options:{...f.config.options,layout:{...f?.config?.options?.layout,visibility:f.masterVisible===!1?"none":f?.config?.options?.layout?.visibility?f?.config?.options?.layout?.visibility:"visible"}}},f.uuid);case"vt":{const g=f.config.layers.map(b=>{const v={...b};return v.layout&&(v.layout={...v.layout,visibility:v.masterVisible===!1?"none":v.layout.visibility??"visible"}),v});return K.jsx(Gv,{layerId:f.uuid,insertBeforeLayer:"layer_id_"+f.uuid,url:f.config.url,layers:g},f.uuid)}case"wms":{const g=f.masterVisible===!1?!1:f.config?.visible;return K.jsx(zS,{layerId:f.uuid,insertBeforeLayer:"layer_id_"+f.uuid,url:f.config?.url||"",urlParameters:f.config?.urlParameters,visible:g},f.uuid)}case"folder":return u?.layers?u.layers.map(g=>o(g)):K.jsx(K.Fragment,{});default:return null}}return K.jsxs(K.Fragment,{children:[K.jsx(US,{layerIds:s}),r?.map?.(u=>o(u))]})}try{V$.displayName="LayerOnMap",V$.__docgenInfo={description:"",displayName:"LayerOnMap",props:{mapConfigKey:{defaultValue:null,description:"",name:"mapConfigKey",required:!0,type:{name:"string"}},mapId:{defaultValue:null,description:"",name:"mapId",required:!1,type:{name:"string | undefined"}}}}}catch{}const FDe=[(t,e)=>{const r=ee.useMemo(()=>WW(e?.globals?.theme),[e?.globals?.theme]);return K.jsx("div",{className:"fullscreen_map",children:K.jsx(_P,{children:K.jsxs(HW,{theme:r,children:[K.jsx(t,{}),K.jsx(XW,{options:{zoom:14.5,style:"https://wms.wheregroup.com/tileserver/style/osm-bright.json",center:[7.0851268,50.73884]},mapId:"map_1"}),K.jsx(Jk,{sx:{bottom:"25px",right:"5px"},showZoomButtons:!1,mapId:"map_1"})]})})})}];function oE(t,e){if(!t)throw new Error(e||"loader assertion failed.")}const xN=!!(typeof process!="object"||String(process)!=="[object process]"||process.browser),$$=typeof process<"u"&&process.version&&/v([0-9]*)/.exec(process.version);$$&&parseFloat($$[1]);const q$=globalThis,H$=globalThis.process||{},BDe=globalThis.navigator||{};function FQ(t){if(typeof window<"u"&&window.process?.type==="renderer"||typeof process<"u"&&process.versions?.electron)return!0;const r=typeof navigator<"u"&&navigator.userAgent;return!!(r&&r.indexOf("Electron")>=0)}function Zm(){return!(typeof process=="object"&&String(process)==="[object process]"&&!process?.browser)||FQ()}function zDe(t){return Zm()?FQ()?"Electron":(BDe.userAgent||"").indexOf("Edge")>-1?"Edge":globalThis.chrome?"Chrome":globalThis.safari?"Safari":globalThis.mozInnerScreenX?"Firefox":"Unknown":"Node"}const BQ="4.1.0";function jDe(t){try{const e=window[t],r="__storage_test__";return e.setItem(r,r),e.removeItem(r),e}catch{return null}}class UDe{constructor(e,r,n="sessionStorage"){this.storage=jDe(n),this.id=e,this.config=r,this._loadConfiguration()}getConfiguration(){return this.config}setConfiguration(e){if(Object.assign(this.config,e),this.storage){const r=JSON.stringify(this.config);this.storage.setItem(this.id,r)}}_loadConfiguration(){let e={};if(this.storage){const r=this.storage.getItem(this.id);e=r?JSON.parse(r):{}}return Object.assign(this.config,e),this}}function VDe(t){let e;return t<10?e=`${t.toFixed(2)}ms`:t<100?e=`${t.toFixed(1)}ms`:t<1e3?e=`${t.toFixed(0)}ms`:e=`${(t/1e3).toFixed(2)}s`,e}function $De(t,e=8){const r=Math.max(e-t.length,0);return`${" ".repeat(r)}${t}`}var sE;(function(t){t[t.BLACK=30]="BLACK",t[t.RED=31]="RED",t[t.GREEN=32]="GREEN",t[t.YELLOW=33]="YELLOW",t[t.BLUE=34]="BLUE",t[t.MAGENTA=35]="MAGENTA",t[t.CYAN=36]="CYAN",t[t.WHITE=37]="WHITE",t[t.BRIGHT_BLACK=90]="BRIGHT_BLACK",t[t.BRIGHT_RED=91]="BRIGHT_RED",t[t.BRIGHT_GREEN=92]="BRIGHT_GREEN",t[t.BRIGHT_YELLOW=93]="BRIGHT_YELLOW",t[t.BRIGHT_BLUE=94]="BRIGHT_BLUE",t[t.BRIGHT_MAGENTA=95]="BRIGHT_MAGENTA",t[t.BRIGHT_CYAN=96]="BRIGHT_CYAN",t[t.BRIGHT_WHITE=97]="BRIGHT_WHITE"})(sE||(sE={}));const qDe=10;function W$(t){return typeof t!="string"?t:(t=t.toUpperCase(),sE[t]||sE.WHITE)}function HDe(t,e,r){return!Zm&&typeof t=="string"&&(e&&(t=`\x1B[${W$(e)}m${t}\x1B[39m`),r&&(t=`\x1B[${W$(r)+qDe}m${t}\x1B[49m`)),t}function WDe(t,e=["constructor"]){const r=Object.getPrototypeOf(t),n=Object.getOwnPropertyNames(r),i=t;for(const a of n){const s=i[a];typeof s=="function"&&(e.find(o=>a===o)||(i[a]=s.bind(t)))}}function wN(t,e){if(!t)throw new Error("Assertion failed")}function $y(){let t;if(Zm()&&q$.performance)t=q$?.performance?.now?.();else if("hrtime"in H$){const e=H$?.hrtime?.();t=e[0]*1e3+e[1]/1e6}else t=Date.now();return t}const qy={debug:Zm()&&console.debug||console.log,log:console.log,info:console.info,warn:console.warn,error:console.error},GDe={enabled:!0,level:0};function Hy(){}const G$={},X$={once:!0};class mx{constructor({id:e}={id:""}){this.VERSION=BQ,this._startTs=$y(),this._deltaTs=$y(),this.userData={},this.LOG_THROTTLE_TIMEOUT=0,this.id=e,this.userData={},this._storage=new UDe(`__probe-${this.id}__`,GDe),this.timeStamp(`${this.id} started`),WDe(this),Object.seal(this)}set level(e){this.setLevel(e)}get level(){return this.getLevel()}isEnabled(){return this._storage.config.enabled}getLevel(){return this._storage.config.level}getTotal(){return Number(($y()-this._startTs).toPrecision(10))}getDelta(){return Number(($y()-this._deltaTs).toPrecision(10))}set priority(e){this.level=e}get priority(){return this.level}getPriority(){return this.level}enable(e=!0){return this._storage.setConfiguration({enabled:e}),this}setLevel(e){return this._storage.setConfiguration({level:e}),this}get(e){return this._storage.config[e]}set(e,r){this._storage.setConfiguration({[e]:r})}settings(){console.table?console.table(this._storage.config):console.log(this._storage.config)}assert(e,r){if(!e)throw new Error(r||"Assertion failed")}warn(e){return this._getLogFunction(0,e,qy.warn,arguments,X$)}error(e){return this._getLogFunction(0,e,qy.error,arguments)}deprecated(e,r){return this.warn(`\`${e}\` is deprecated and will be removed in a later version. Use \`${r}\` instead`)}removed(e,r){return this.error(`\`${e}\` has been removed. Use \`${r}\` instead`)}probe(e,r){return this._getLogFunction(e,r,qy.log,arguments,{time:!0,once:!0})}log(e,r){return this._getLogFunction(e,r,qy.debug,arguments)}info(e,r){return this._getLogFunction(e,r,console.info,arguments)}once(e,r){return this._getLogFunction(e,r,qy.debug||qy.info,arguments,X$)}table(e,r,n){return r?this._getLogFunction(e,r,console.table||Hy,n&&[n],{tag:YDe(r)}):Hy}time(e,r){return this._getLogFunction(e,r,console.time?console.time:console.info)}timeEnd(e,r){return this._getLogFunction(e,r,console.timeEnd?console.timeEnd:console.info)}timeStamp(e,r){return this._getLogFunction(e,r,console.timeStamp||Hy)}group(e,r,n={collapsed:!1}){const i=Y$({logLevel:e,message:r,opts:n}),{collapsed:a}=n;return i.method=(a?console.groupCollapsed:console.group)||console.info,this._getLogFunction(i)}groupCollapsed(e,r,n={}){return this.group(e,r,Object.assign({},n,{collapsed:!0}))}groupEnd(e){return this._getLogFunction(e,"",console.groupEnd||Hy)}withGroup(e,r,n){this.group(e,r)();try{n()}finally{this.groupEnd(e)()}}trace(){console.trace&&console.trace()}_shouldLog(e){return this.isEnabled()&&this.getLevel()>=zQ(e)}_getLogFunction(e,r,n,i,a){if(this._shouldLog(e)){a=Y$({logLevel:e,message:r,args:i,opts:a}),n=n||a.method,wN(n),a.total=this.getTotal(),a.delta=this.getDelta(),this._deltaTs=$y();const s=a.tag||a.message;if(a.once&&s)if(!G$[s])G$[s]=$y();else return Hy;return r=XDe(this.id,a.message,a),n.bind(console,r,...a.args)}return Hy}}mx.VERSION=BQ;function zQ(t){if(!t)return 0;let e;switch(typeof t){case"number":e=t;break;case"object":e=t.logLevel||t.priority||0;break;default:return 0}return wN(Number.isFinite(e)&&e>=0),e}function Y$(t){const{logLevel:e,message:r}=t;t.logLevel=zQ(e);const n=t.args?Array.from(t.args):[];for(;n.length&&n.shift()!==r;);switch(typeof e){case"string":case"function":r!==void 0&&n.unshift(r),t.message=e;break;case"object":Object.assign(t,e);break}typeof t.message=="function"&&(t.message=t.message());const i=typeof t.message;return wN(i==="string"||i==="object"),Object.assign(t,{args:n},t.opts)}function XDe(t,e,r){if(typeof e=="string"){const n=r.time?$De(VDe(r.total)):"";e=r.time?`${t}: ${n}  ${e}`:`${t}: ${e}`,e=HDe(e,r.color,r.background)}return e}function YDe(t){for(const e in t)for(const r in t[e])return r||"untitled";return"empty"}const EI="4.3.3",ZDe=EI[0]>="0"&&EI[0]<="9"?`v${EI}`:"";function KDe(){const t=new mx({id:"loaders.gl"});return globalThis.loaders=globalThis.loaders||{},globalThis.loaders.log=t,globalThis.loaders.version=ZDe,globalThis.probe=globalThis.probe||{},globalThis.probe.loaders=t,t}const JDe=KDe();function QDe(t,e){return jQ(t||{},e)}function jQ(t,e,r=0){if(r>3)return e;const n={...t};for(const[i,a]of Object.entries(e))a&&typeof a=="object"&&!Array.isArray(a)?n[i]=jQ(n[i]||{},e[i],r+1):n[i]=e[i];return n}const e6e="latest";function t6e(){return globalThis._loadersgl_?.version||(globalThis._loadersgl_=globalThis._loadersgl_||{},globalThis._loadersgl_.version="4.3.3"),globalThis._loadersgl_.version}const r6e=t6e();function ig(t,e){if(!t)throw new Error(e||"loaders.gl assertion failed.")}const cm=typeof process!="object"||String(process)!=="[object process]"||process.browser,n6e=typeof window<"u"&&typeof window.orientation<"u",Z$=typeof process<"u"&&process.version&&/v([0-9]*)/.exec(process.version);Z$&&parseFloat(Z$[1]);class i6e{name;workerThread;isRunning=!0;result;_resolve=()=>{};_reject=()=>{};constructor(e,r){this.name=e,this.workerThread=r,this.result=new Promise((n,i)=>{this._resolve=n,this._reject=i})}postMessage(e,r){this.workerThread.postMessage({source:"loaders.gl",type:e,payload:r})}done(e){ig(this.isRunning),this.isRunning=!1,this._resolve(e)}error(e){ig(this.isRunning),this.isRunning=!1,this._reject(e)}}class TI{terminate(){}}const CI=new Map;function a6e(t){ig(t.source&&!t.url||!t.source&&t.url);let e=CI.get(t.source||t.url);return e||(t.url&&(e=o6e(t.url),CI.set(t.url,e)),t.source&&(e=UQ(t.source),CI.set(t.source,e))),ig(e),e}function o6e(t){if(!t.startsWith("http"))return t;const e=s6e(t);return UQ(e)}function UQ(t){const e=new Blob([t],{type:"application/javascript"});return URL.createObjectURL(e)}function s6e(t){return`try {
  importScripts('${t}');
} catch (error) {
  console.error(error);
  throw error;
}`}function VQ(t,e=!0,r){const n=r||new Set;if(t){if(K$(t))n.add(t);else if(K$(t.buffer))n.add(t.buffer);else if(!ArrayBuffer.isView(t)){if(e&&typeof t=="object")for(const i in t)VQ(t[i],e,n)}}return r===void 0?Array.from(n):[]}function K$(t){return t?t instanceof ArrayBuffer||typeof MessagePort<"u"&&t instanceof MessagePort||typeof ImageBitmap<"u"&&t instanceof ImageBitmap||typeof OffscreenCanvas<"u"&&t instanceof OffscreenCanvas:!1}const AI=()=>{};class DM{name;source;url;terminated=!1;worker;onMessage;onError;_loadableURL="";static isSupported(){return typeof Worker<"u"&&cm||typeof TI<"u"&&!cm}constructor(e){const{name:r,source:n,url:i}=e;ig(n||i),this.name=r,this.source=n,this.url=i,this.onMessage=AI,this.onError=a=>console.log(a),this.worker=cm?this._createBrowserWorker():this._createNodeWorker()}destroy(){this.onMessage=AI,this.onError=AI,this.worker.terminate(),this.terminated=!0}get isRunning(){return!!this.onMessage}postMessage(e,r){r=r||VQ(e),this.worker.postMessage(e,r)}_getErrorFromErrorEvent(e){let r="Failed to load ";return r+=`worker ${this.name} from ${this.url}. `,e.message&&(r+=`${e.message} in `),e.lineno&&(r+=`:${e.lineno}:${e.colno}`),new Error(r)}_createBrowserWorker(){this._loadableURL=a6e({source:this.source,url:this.url});const e=new Worker(this._loadableURL,{name:this.name});return e.onmessage=r=>{r.data?this.onMessage(r.data):this.onError(new Error("No data received"))},e.onerror=r=>{this.onError(this._getErrorFromErrorEvent(r)),this.terminated=!0},e.onmessageerror=r=>console.error(r),e}_createNodeWorker(){let e;if(this.url){const n=this.url.includes(":/")||this.url.startsWith("/")?this.url:`./${this.url}`;e=new TI(n,{eval:!1})}else if(this.source)e=new TI(this.source,{eval:!0});else throw new Error("no worker");return e.on("message",r=>{this.onMessage(r)}),e.on("error",r=>{this.onError(r)}),e.on("exit",r=>{}),e}}class l6e{name="unnamed";source;url;maxConcurrency=1;maxMobileConcurrency=1;onDebug=()=>{};reuseWorkers=!0;props={};jobQueue=[];idleQueue=[];count=0;isDestroyed=!1;static isSupported(){return DM.isSupported()}constructor(e){this.source=e.source,this.url=e.url,this.setProps(e)}destroy(){this.idleQueue.forEach(e=>e.destroy()),this.isDestroyed=!0}setProps(e){this.props={...this.props,...e},e.name!==void 0&&(this.name=e.name),e.maxConcurrency!==void 0&&(this.maxConcurrency=e.maxConcurrency),e.maxMobileConcurrency!==void 0&&(this.maxMobileConcurrency=e.maxMobileConcurrency),e.reuseWorkers!==void 0&&(this.reuseWorkers=e.reuseWorkers),e.onDebug!==void 0&&(this.onDebug=e.onDebug)}async startJob(e,r=(i,a,s)=>i.done(s),n=(i,a)=>i.error(a)){const i=new Promise(a=>(this.jobQueue.push({name:e,onMessage:r,onError:n,onStart:a}),this));return this._startQueuedJob(),await i}async _startQueuedJob(){if(!this.jobQueue.length)return;const e=this._getAvailableWorker();if(!e)return;const r=this.jobQueue.shift();if(r){this.onDebug({message:"Starting job",name:r.name,workerThread:e,backlog:this.jobQueue.length});const n=new i6e(r.name,e);e.onMessage=i=>r.onMessage(n,i.type,i.payload),e.onError=i=>r.onError(n,i),r.onStart(n);try{await n.result}catch(i){console.error(`Worker exception: ${i}`)}finally{this.returnWorkerToQueue(e)}}}returnWorkerToQueue(e){!cm||this.isDestroyed||!this.reuseWorkers||this.count>this._getMaxConcurrency()?(e.destroy(),this.count--):this.idleQueue.push(e),this.isDestroyed||this._startQueuedJob()}_getAvailableWorker(){if(this.idleQueue.length>0)return this.idleQueue.shift()||null;if(this.count<this._getMaxConcurrency()){this.count++;const e=`${this.name.toLowerCase()} (#${this.count} of ${this.maxConcurrency})`;return new DM({name:e,source:this.source,url:this.url})}return null}_getMaxConcurrency(){return n6e?this.maxMobileConcurrency:this.maxConcurrency}}const u6e={maxConcurrency:3,maxMobileConcurrency:1,reuseWorkers:!0,onDebug:()=>{}};class Rp{props;workerPools=new Map;static _workerFarm;static isSupported(){return DM.isSupported()}static getWorkerFarm(e={}){return Rp._workerFarm=Rp._workerFarm||new Rp({}),Rp._workerFarm.setProps(e),Rp._workerFarm}constructor(e){this.props={...u6e},this.setProps(e),this.workerPools=new Map}destroy(){for(const e of this.workerPools.values())e.destroy();this.workerPools=new Map}setProps(e){this.props={...this.props,...e};for(const r of this.workerPools.values())r.setProps(this._getWorkerPoolProps())}getWorkerPool(e){const{name:r,source:n,url:i}=e;let a=this.workerPools.get(r);return a||(a=new l6e({name:r,source:n,url:i}),a.setProps(this._getWorkerPoolProps()),this.workerPools.set(r,a)),a}_getWorkerPoolProps(){return{maxConcurrency:this.props.maxConcurrency,maxMobileConcurrency:this.props.maxMobileConcurrency,reuseWorkers:this.props.reuseWorkers,onDebug:this.props.onDebug}}}function c6e(t,e={}){const r=e[t.id]||{},n=cm?`${t.id}-worker.js`:`${t.id}-worker-node.js`;let i=r.workerUrl;if(!i&&t.id==="compression"&&(i=e.workerUrl),e._workerType==="test"&&(cm?i=`modules/${t.module}/dist/${n}`:i=`modules/${t.module}/src/workers/${t.id}-worker-node.ts`),!i){let a=t.version;a==="latest"&&(a=e6e);const s=a?`@${a}`:"";i=`https://unpkg.com/@loaders.gl/${t.module}${s}/dist/${n}`}return ig(i),i}function h6e(t,e=r6e){ig(t,"no worker provided");const r=t.version;return!(!e||!r)}function f6e(t,e){return!Rp.isSupported()||!cm&&!e?._nodeWorkers?!1:t.worker&&e?.worker}async function d6e(t,e,r,n,i){const a=t.id,s=c6e(t,r),u=Rp.getWorkerFarm(r).getWorkerPool({name:a,url:s});r=JSON.parse(JSON.stringify(r)),n=JSON.parse(JSON.stringify(n||{}));const h=await u.startJob("process-on-worker",p6e.bind(null,i));return h.postMessage("process",{input:e,options:r,context:n}),await(await h.result).result}async function p6e(t,e,r,n){switch(r){case"done":e.done(n);break;case"error":e.error(new Error(n.error));break;case"process":const{id:i,input:a,options:s}=n;try{const o=await t(a,s);e.postMessage("done",{id:i,result:o})}catch(o){const u=o instanceof Error?o.message:"unknown error";e.postMessage("error",{id:i,error:u})}break;default:console.warn(`parse-with-worker unknown message ${r}`)}}function g6e(t,e,r){if(r=r||t.byteLength,t.byteLength<r||e.byteLength<r)return!1;const n=new Uint8Array(t),i=new Uint8Array(e);for(let a=0;a<n.length;++a)if(n[a]!==i[a])return!1;return!0}function m6e(...t){return y6e(t)}function y6e(t){const e=t.map(a=>a instanceof ArrayBuffer?new Uint8Array(a):a),r=e.reduce((a,s)=>a+s.byteLength,0),n=new Uint8Array(r);let i=0;for(const a of e)n.set(a,i),i+=a.byteLength;return n.buffer}async function v6e(t){const e=[];for await(const r of t)e.push(r);return m6e(...e)}function J$(){let t;if(typeof window<"u"&&window.performance)t=window.performance.now();else if(typeof process<"u"&&process.hrtime){const e=process.hrtime();t=e[0]*1e3+e[1]/1e6}else t=Date.now();return t}class Q${constructor(e,r){this.sampleSize=1,this.time=0,this.count=0,this.samples=0,this.lastTiming=0,this.lastSampleTime=0,this.lastSampleCount=0,this._count=0,this._time=0,this._samples=0,this._startTime=0,this._timerPending=!1,this.name=e,this.type=r,this.reset()}reset(){return this.time=0,this.count=0,this.samples=0,this.lastTiming=0,this.lastSampleTime=0,this.lastSampleCount=0,this._count=0,this._time=0,this._samples=0,this._startTime=0,this._timerPending=!1,this}setSampleSize(e){return this.sampleSize=e,this}incrementCount(){return this.addCount(1),this}decrementCount(){return this.subtractCount(1),this}addCount(e){return this._count+=e,this._samples++,this._checkSampling(),this}subtractCount(e){return this._count-=e,this._samples++,this._checkSampling(),this}addTime(e){return this._time+=e,this.lastTiming=e,this._samples++,this._checkSampling(),this}timeStart(){return this._startTime=J$(),this._timerPending=!0,this}timeEnd(){return this._timerPending?(this.addTime(J$()-this._startTime),this._timerPending=!1,this._checkSampling(),this):this}getSampleAverageCount(){return this.sampleSize>0?this.lastSampleCount/this.sampleSize:0}getSampleAverageTime(){return this.sampleSize>0?this.lastSampleTime/this.sampleSize:0}getSampleHz(){return this.lastSampleTime>0?this.sampleSize/(this.lastSampleTime/1e3):0}getAverageCount(){return this.samples>0?this.count/this.samples:0}getAverageTime(){return this.samples>0?this.time/this.samples:0}getHz(){return this.time>0?this.samples/(this.time/1e3):0}_checkSampling(){this._samples===this.sampleSize&&(this.lastSampleTime=this._time,this.lastSampleCount=this._count,this.count+=this._count,this.time+=this._time,this.samples+=this._samples,this._time=0,this._count=0,this._samples=0)}}class ZT{constructor(e){this.stats={},this.id=e.id,this.stats={},this._initializeStats(e.stats),Object.seal(this)}get(e,r="count"){return this._getOrCreate({name:e,type:r})}get size(){return Object.keys(this.stats).length}reset(){for(const e of Object.values(this.stats))e.reset();return this}forEach(e){for(const r of Object.values(this.stats))e(r)}getTable(){const e={};return this.forEach(r=>{e[r.name]={time:r.time||0,count:r.count||0,average:r.getAverageTime()||0,hz:r.getHz()||0}}),e}_initializeStats(e=[]){e.forEach(r=>this._getOrCreate(r))}_getOrCreate(e){const{name:r,type:n}=e;let i=this.stats[r];return i||(e instanceof Q$?i=e:i=new Q$(r,n),this.stats[r]=i),i}}let _6e="";const eq={};function b6e(t){for(const e in eq)if(t.startsWith(e)){const r=eq[e];t=t.replace(e,r)}return!t.startsWith("http://")&&!t.startsWith("https://")&&(t=`${_6e}${t}`),t}function x6e(t){return t&&typeof t=="object"&&t.isBuffer}function $Q(t){if(x6e(t))return t;if(t instanceof ArrayBuffer)return t;if(ArrayBuffer.isView(t))return t.byteOffset===0&&t.byteLength===t.buffer.byteLength?t.buffer:t.buffer.slice(t.byteOffset,t.byteOffset+t.byteLength);if(typeof t=="string"){const e=t;return new TextEncoder().encode(e).buffer}if(t&&typeof t=="object"&&t._toArrayBuffer)return t._toArrayBuffer();throw new Error("toArrayBuffer")}function qQ(t){const e=t?t.lastIndexOf("/"):-1;return e>=0?t.substr(e+1):""}function w6e(t){const e=t?t.lastIndexOf("/"):-1;return e>=0?t.substr(0,e):""}const S6e=t=>typeof t=="boolean",D1=t=>typeof t=="function",yx=t=>t!==null&&typeof t=="object",tq=t=>yx(t)&&t.constructor==={}.constructor,E6e=t=>!!t&&typeof t[Symbol.iterator]=="function",T6e=t=>t&&typeof t[Symbol.asyncIterator]=="function",Km=t=>typeof Response<"u"&&t instanceof Response||t&&t.arrayBuffer&&t.text&&t.json,Jm=t=>typeof Blob<"u"&&t instanceof Blob,C6e=t=>t&&typeof t=="object"&&t.isBuffer,A6e=t=>typeof ReadableStream<"u"&&t instanceof ReadableStream||yx(t)&&D1(t.tee)&&D1(t.cancel)&&D1(t.getReader),I6e=t=>yx(t)&&D1(t.read)&&D1(t.pipe)&&S6e(t.readable),HQ=t=>A6e(t)||I6e(t);class P6e extends Error{constructor(e,r){super(e),this.reason=r.reason,this.url=r.url,this.response=r.response}reason;url;response}const k6e=/^data:([-\w.]+\/[-\w.+]+)(;|,)/,M6e=/^([-\w.]+\/[-\w.+]+)/;function rq(t,e){return t.toLowerCase()===e.toLowerCase()}function R6e(t){const e=M6e.exec(t);return e?e[1]:t}function nq(t){const e=k6e.exec(t);return e?e[1]:""}const WQ=/\?.*/;function O6e(t){const e=t.match(WQ);return e&&e[0]}function SN(t){return t.replace(WQ,"")}function L6e(t){if(t.length<50)return t;const e=t.slice(t.length-15);return`${t.substr(0,32)}...${e}`}function KT(t){return Km(t)?t.url:Jm(t)?t.name||"":typeof t=="string"?t:""}function EN(t){if(Km(t)){const e=t,r=e.headers.get("content-type")||"",n=SN(e.url);return R6e(r)||nq(n)}return Jm(t)?t.type||"":typeof t=="string"?nq(t):""}function N6e(t){return Km(t)?t.headers["content-length"]||-1:Jm(t)?t.size:typeof t=="string"?t.length:t instanceof ArrayBuffer||ArrayBuffer.isView(t)?t.byteLength:-1}async function GQ(t){if(Km(t))return t;const e={},r=N6e(t);r>=0&&(e["content-length"]=String(r));const n=KT(t),i=EN(t);i&&(e["content-type"]=i);const a=await B6e(t);a&&(e["x-first-bytes"]=a),typeof t=="string"&&(t=new TextEncoder().encode(t));const s=new Response(t,{headers:e});return Object.defineProperty(s,"url",{value:n}),s}async function D6e(t){if(!t.ok)throw await F6e(t)}async function F6e(t){const e=L6e(t.url);let r=`Failed to fetch resource (${t.status}) ${t.statusText}: ${e}`;r=r.length>100?`${r.slice(0,100)}...`:r;const n={reason:t.statusText,url:t.url,response:t};try{const i=t.headers.get("Content-Type");n.reason=!t.bodyUsed&&i?.includes("application/json")?await t.json():await t.text()}catch{}return new P6e(r,n)}async function B6e(t){if(typeof t=="string")return`data:,${t.slice(0,5)}`;if(t instanceof Blob){const r=t.slice(0,5);return await new Promise(n=>{const i=new FileReader;i.onload=a=>n(a?.target?.result),i.readAsDataURL(r)})}if(t instanceof ArrayBuffer){const r=t.slice(0,5);return`data:base64,${z6e(r)}`}return null}function z6e(t){let e="";const r=new Uint8Array(t);for(let n=0;n<r.byteLength;n++)e+=String.fromCharCode(r[n]);return btoa(e)}function j6e(t){return!U6e(t)&&!V6e(t)}function U6e(t){return t.startsWith("http:")||t.startsWith("https:")}function V6e(t){return t.startsWith("data:")}async function iq(t,e){if(typeof t=="string"){const r=b6e(t);return j6e(r)&&globalThis.loaders?.fetchNode?globalThis.loaders?.fetchNode(r,e):await fetch(r,e)}return await GQ(t)}const aq=new mx({id:"loaders.gl"});class $6e{log(){return()=>{}}info(){return()=>{}}warn(){return()=>{}}error(){return()=>{}}}class q6e{console;constructor(){this.console=console}log(...e){return this.console.log.bind(this.console,...e)}info(...e){return this.console.info.bind(this.console,...e)}warn(...e){return this.console.warn.bind(this.console,...e)}error(...e){return this.console.error.bind(this.console,...e)}}const XQ={fetch:null,mimeType:void 0,nothrow:!1,log:new q6e,useLocalLibraries:!1,CDN:"https://unpkg.com/@loaders.gl",worker:!0,maxConcurrency:3,maxMobileConcurrency:1,reuseWorkers:xN,_nodeWorkers:!1,_workerType:"",limit:0,_limitMB:0,batchSize:"auto",batchDebounceMs:0,metadata:!1,transforms:[]},H6e={throws:"nothrow",dataType:"(no longer used)",uri:"baseUri",method:"fetch.method",headers:"fetch.headers",body:"fetch.body",mode:"fetch.mode",credentials:"fetch.credentials",cache:"fetch.cache",redirect:"fetch.redirect",referrer:"fetch.referrer",referrerPolicy:"fetch.referrerPolicy",integrity:"fetch.integrity",keepalive:"fetch.keepalive",signal:"fetch.signal"};function YQ(){globalThis.loaders=globalThis.loaders||{};const{loaders:t}=globalThis;return t._state||(t._state={}),t._state}function ZQ(){const t=YQ();return t.globalOptions=t.globalOptions||{...XQ},t.globalOptions}function W6e(t,e,r,n){return r=r||[],r=Array.isArray(r)?r:[r],G6e(t,r),Y6e(e,t,n)}function G6e(t,e){oq(t,null,XQ,H6e,e);for(const r of e){const n=t&&t[r.id]||{},i=r.options&&r.options[r.id]||{},a=r.deprecatedOptions&&r.deprecatedOptions[r.id]||{};oq(n,r.id,i,a,e)}}function oq(t,e,r,n,i){const a=e||"Top level",s=e?`${e}.`:"";for(const o in t){const u=!e&&yx(t[o]),h=o==="baseUri"&&!e,f=o==="workerUrl"&&e;if(!(o in r)&&!h&&!f){if(o in n)aq.warn(`${a} loader option '${s}${o}' no longer supported, use '${n[o]}'`)();else if(!u){const g=X6e(o,i);aq.warn(`${a} loader option '${s}${o}' not recognized. ${g}`)()}}}}function X6e(t,e){const r=t.toLowerCase();let n="";for(const i of e)for(const a in i.options){if(t===a)return`Did you mean '${i.id}.${a}'?`;const s=a.toLowerCase();(r.startsWith(s)||s.startsWith(r))&&(n=n||`Did you mean '${i.id}.${a}'?`)}return n}function Y6e(t,e,r){const i={...t.options||{}};return Z6e(i,r),i.log===null&&(i.log=new $6e),sq(i,ZQ()),sq(i,e),i}function sq(t,e){for(const r in e)if(r in e){const n=e[r];tq(n)&&tq(t[r])?t[r]={...t[r],...e[r]}:t[r]=e[r]}}function Z6e(t,e){e&&!("baseUri"in t)&&(t.baseUri=e)}function TN(t){return t?(Array.isArray(t)&&(t=t[0]),Array.isArray(t?.extensions)):!1}function CN(t){oE(t,"null loader"),oE(TN(t),"invalid loader");let e;return Array.isArray(t)&&(e=t[1],t=t[0],t={...t,options:{...t.options,...e}}),(t?.parseTextSync||t?.parseText)&&(t.text=!0),t.text||(t.binary=!0),t}const KQ=()=>{const t=YQ();return t.loaderRegistry=t.loaderRegistry||[],t.loaderRegistry};function K6e(t){const e=KQ();t=Array.isArray(t)?t:[t];for(const r of t){const n=CN(r);e.find(i=>n===i)||e.unshift(n)}}function J6e(){return KQ()}const Q6e=/\.([^.]+)$/;async function eFe(t,e=[],r,n){if(!JQ(t))return null;let i=lq(t,e,{...r,nothrow:!0},n);if(i)return i;if(Jm(t)&&(t=await t.slice(0,10).arrayBuffer(),i=lq(t,e,r,n)),!i&&!r?.nothrow)throw new Error(QQ(t));return i}function lq(t,e=[],r,n){if(!JQ(t))return null;if(e&&!Array.isArray(e))return CN(e);let i=[];e&&(i=i.concat(e)),r?.ignoreRegisteredLoaders||i.push(...J6e()),rFe(i);const a=tFe(t,i,r,n);if(!a&&!r?.nothrow)throw new Error(QQ(t));return a}function tFe(t,e,r,n){const i=KT(t),a=EN(t),s=SN(i)||n?.url;let o=null,u="";return r?.mimeType&&(o=II(e,r?.mimeType),u=`match forced by supplied MIME type ${r?.mimeType}`),o=o||nFe(e,s),u=u||(o?`matched url ${s}`:""),o=o||II(e,a),u=u||(o?`matched MIME type ${a}`:""),o=o||aFe(e,t),u=u||(o?`matched initial data ${eee(t)}`:""),r?.fallbackMimeType&&(o=o||II(e,r?.fallbackMimeType),u=u||(o?`matched fallback MIME type ${a}`:"")),u&&JDe.log(1,`selectLoader selected ${o?.name}: ${u}.`),o}function JQ(t){return!(t instanceof Response&&t.status===204)}function QQ(t){const e=KT(t),r=EN(t);let n="No valid loader found (";n+=e?`${qQ(e)}, `:"no url provided, ",n+=`MIME type: ${r?`"${r}"`:"not provided"}, `;const i=t?eee(t):"";return n+=i?` first bytes: "${i}"`:"first bytes: not available",n+=")",n}function rFe(t){for(const e of t)CN(e)}function nFe(t,e){const r=e&&Q6e.exec(e),n=r&&r[1];return n?iFe(t,n):null}function iFe(t,e){e=e.toLowerCase();for(const r of t)for(const n of r.extensions)if(n.toLowerCase()===e)return r;return null}function II(t,e){for(const r of t)if(r.mimeTypes?.some(n=>rq(e,n))||rq(e,`application/x.${r.id}`))return r;return null}function aFe(t,e){if(!e)return null;for(const r of t)if(typeof e=="string"){if(oFe(e,r))return r}else if(ArrayBuffer.isView(e)){if(uq(e.buffer,e.byteOffset,r))return r}else if(e instanceof ArrayBuffer&&uq(e,0,r))return r;return null}function oFe(t,e){return e.testText?e.testText(t):(Array.isArray(e.tests)?e.tests:[e.tests]).some(n=>t.startsWith(n))}function uq(t,e,r){return(Array.isArray(r.tests)?r.tests:[r.tests]).some(i=>sFe(t,e,r,i))}function sFe(t,e,r,n){if(n instanceof ArrayBuffer)return g6e(n,t,n.byteLength);switch(typeof n){case"function":return n(t);case"string":const i=FM(t,e,n.length);return n===i;default:return!1}}function eee(t,e=5){return typeof t=="string"?t.slice(0,e):ArrayBuffer.isView(t)?FM(t.buffer,t.byteOffset,e):t instanceof ArrayBuffer?FM(t,0,e):""}function FM(t,e,r){if(t.byteLength<e+r)return"";const n=new DataView(t);let i="";for(let a=0;a<r;a++)i+=String.fromCharCode(n.getUint8(e+a));return i}const lFe=256*1024;function*uFe(t,e){const r=e?.chunkSize||lFe;let n=0;const i=new TextEncoder;for(;n<t.length;){const a=Math.min(t.length-n,r),s=t.slice(n,n+a);n+=a,yield i.encode(s)}}const cFe=256*1024;function*hFe(t,e={}){const{chunkSize:r=cFe}=e;let n=0;for(;n<t.byteLength;){const i=Math.min(t.byteLength-n,r),a=new ArrayBuffer(i),s=new Uint8Array(t,n,i);new Uint8Array(a).set(s),n+=i,yield a}}const fFe=1024*1024;async function*dFe(t,e){const r=e?.chunkSize||fFe;let n=0;for(;n<t.size;){const i=n+r,a=await t.slice(n,i).arrayBuffer();n=i,yield a}}function cq(t,e){return xN?pFe(t,e):gFe(t)}async function*pFe(t,e){const r=t.getReader();let n;try{for(;;){const i=n||r.read();e?._streamReadAhead&&(n=r.read());const{done:a,value:s}=await i;if(a)return;yield $Q(s)}}catch{r.releaseLock()}}async function*gFe(t,e){for await(const r of t)yield $Q(r)}function mFe(t,e){if(typeof t=="string")return uFe(t,e);if(t instanceof ArrayBuffer)return hFe(t,e);if(Jm(t))return dFe(t,e);if(HQ(t))return cq(t,e);if(Km(t))return cq(t.body,e);throw new Error("makeIterator")}const tee="Cannot convert supplied data type";function yFe(t,e,r){if(e.text&&typeof t=="string")return t;if(C6e(t)&&(t=t.buffer),t instanceof ArrayBuffer){const n=t;return e.text&&!e.binary?new TextDecoder("utf8").decode(n):n}if(ArrayBuffer.isView(t)){if(e.text&&!e.binary)return new TextDecoder("utf8").decode(t);let n=t.buffer;const i=t.byteLength||t.length;return(t.byteOffset!==0||i!==n.byteLength)&&(n=n.slice(t.byteOffset,t.byteOffset+i)),n}throw new Error(tee)}async function vFe(t,e,r){const n=t instanceof ArrayBuffer||ArrayBuffer.isView(t);if(typeof t=="string"||n)return yFe(t,e);if(Jm(t)&&(t=await GQ(t)),Km(t)){const i=t;return await D6e(i),e.binary?await i.arrayBuffer():await i.text()}if(HQ(t)&&(t=mFe(t,r)),E6e(t)||T6e(t))return v6e(t);throw new Error(tee)}function ree(t,e){const r=ZQ(),n=t||r;return typeof n.fetch=="function"?n.fetch:yx(n.fetch)?i=>iq(i,n.fetch):e?.fetch?e?.fetch:iq}function _Fe(t,e,r){if(r)return r;const n={fetch:ree(e,t),...t};if(n.url){const i=SN(n.url);n.baseUrl=i,n.queryString=O6e(n.url),n.filename=qQ(i),n.baseUrl=w6e(i)}return Array.isArray(n.loaders)||(n.loaders=null),n}function bFe(t,e){if(t&&!Array.isArray(t))return t;let r;if(t&&(r=Array.isArray(t)?t:[t]),e&&e.loaders){const n=Array.isArray(e.loaders)?e.loaders:[e.loaders];r=r?[...r,...n]:n}return r&&r.length?r:void 0}async function lE(t,e,r,n){e&&!Array.isArray(e)&&!TN(e)&&(n=void 0,r=e,e=void 0),t=await t,r=r||{};const i=KT(t),s=bFe(e,n),o=await eFe(t,s,r);return o?(r=W6e(r,o,s,i),n=_Fe({url:i,_parse:lE,loaders:s},r,n||null),await xFe(o,t,r,n)):null}async function xFe(t,e,r,n){if(h6e(t),r=QDe(t.options,r),Km(e)){const a=e,{ok:s,redirected:o,status:u,statusText:h,type:f,url:g}=a,b=Object.fromEntries(a.headers.entries());n.response={headers:b,ok:s,redirected:o,status:u,statusText:h,type:f,url:g}}e=await vFe(e,t,r);const i=t;if(i.parseTextSync&&typeof e=="string")return i.parseTextSync(e,r,n);if(f6e(t,r))return await d6e(t,e,r,n,lE);if(i.parseText&&typeof e=="string")return await i.parseText(e,r,n);if(i.parse)return await i.parse(e,r,n);throw ig(!i.parseSync),new Error(`${t.id} loader - no parser found and worker is disabled`)}async function BM(t,e,r,n){let i,a;!Array.isArray(e)&&!TN(e)?(i=[],a=e):(i=e,a=r);const s=ree(a);let o=t;return typeof t=="string"&&(o=await s(t)),Jm(t)&&(o=await s(t)),Array.isArray(i)?await lE(o,i,a):await lE(o,i,a)}const wFe="4.3.3",SFe=globalThis.loaders?.parseImageNode,zM=typeof Image<"u",jM=typeof ImageBitmap<"u",EFe=!!SFe,UM=xN?!0:EFe;function TFe(t){switch(t){case"auto":return jM||zM||UM;case"imagebitmap":return jM;case"image":return zM;case"data":return UM;default:throw new Error(`@loaders.gl/images: image ${t} not supported in this environment`)}}function CFe(){if(jM)return"imagebitmap";if(zM)return"image";if(UM)return"data";throw new Error("Install '@loaders.gl/polyfills' to parse images under Node.js")}function AFe(t){const e=PFe(t);if(!e)throw new Error("Not an image");return e}function IFe(t){switch(AFe(t)){case"data":return t;case"image":case"imagebitmap":const e=document.createElement("canvas"),r=e.getContext("2d");if(!r)throw new Error("getImageData");return e.width=t.width,e.height=t.height,r.drawImage(t,0,0),r.getImageData(0,0,t.width,t.height);default:throw new Error("getImageData")}}function PFe(t){return typeof ImageBitmap<"u"&&t instanceof ImageBitmap?"imagebitmap":typeof Image<"u"&&t instanceof Image?"image":t&&typeof t=="object"&&t.data&&t.width&&t.height?"data":null}const kFe=/^data:image\/svg\+xml/,MFe=/\.svg((\?|#).*)?$/;function AN(t){return t&&(kFe.test(t)||MFe.test(t))}function RFe(t,e){if(AN(e)){let n=new TextDecoder().decode(t);try{typeof unescape=="function"&&typeof encodeURIComponent=="function"&&(n=unescape(encodeURIComponent(n)))}catch(a){throw new Error(a.message)}return`data:image/svg+xml;base64,${btoa(n)}`}return nee(t,e)}function nee(t,e){if(AN(e))throw new Error("SVG cannot be parsed directly to imagebitmap");return new Blob([new Uint8Array(t)])}async function iee(t,e,r){const n=RFe(t,r),i=self.URL||self.webkitURL,a=typeof n!="string"&&i.createObjectURL(n);try{return await OFe(a||n,e)}finally{a&&i.revokeObjectURL(a)}}async function OFe(t,e){const r=new Image;return r.src=t,e.image&&e.image.decode&&r.decode?(await r.decode(),r):await new Promise((n,i)=>{try{r.onload=()=>n(r),r.onerror=a=>{const s=a instanceof Error?a.message:"error";i(new Error(s))}}catch(a){i(a)}})}const LFe={};let hq=!0;async function NFe(t,e,r){let n;AN(r)?n=await iee(t,e,r):n=nee(t,r);const i=e&&e.imagebitmap;return await DFe(n,i)}async function DFe(t,e=null){if((FFe(e)||!hq)&&(e=null),e)try{return await createImageBitmap(t,e)}catch(r){console.warn(r),hq=!1}return await createImageBitmap(t)}function FFe(t){for(const e in t||LFe)return!1;return!0}function BFe(t){return!VFe(t,"ftyp",4)||(t[8]&96)===0?null:zFe(t)}function zFe(t){switch(jFe(t,8,12).replace("\0"," ").trim()){case"avif":case"avis":return{extension:"avif",mimeType:"image/avif"};default:return null}}function jFe(t,e,r){return String.fromCharCode(...t.slice(e,r))}function UFe(t){return[...t].map(e=>e.charCodeAt(0))}function VFe(t,e,r=0){const n=UFe(e);for(let i=0;i<n.length;++i)if(n[i]!==t[i+r])return!1;return!0}const qf=!1,F1=!0;function aee(t){const e=vx(t);return qFe(e)||GFe(e)||HFe(e)||WFe(e)||$Fe(e)}function $Fe(t){const e=new Uint8Array(t instanceof DataView?t.buffer:t),r=BFe(e);return r?{mimeType:r.mimeType,width:0,height:0}:null}function qFe(t){const e=vx(t);return e.byteLength>=24&&e.getUint32(0,qf)===2303741511?{mimeType:"image/png",width:e.getUint32(16,qf),height:e.getUint32(20,qf)}:null}function HFe(t){const e=vx(t);return e.byteLength>=10&&e.getUint32(0,qf)===1195984440?{mimeType:"image/gif",width:e.getUint16(6,F1),height:e.getUint16(8,F1)}:null}function WFe(t){const e=vx(t);return e.byteLength>=14&&e.getUint16(0,qf)===16973&&e.getUint32(2,F1)===e.byteLength?{mimeType:"image/bmp",width:e.getUint32(18,F1),height:e.getUint32(22,F1)}:null}function GFe(t){const e=vx(t);if(!(e.byteLength>=3&&e.getUint16(0,qf)===65496&&e.getUint8(2)===255))return null;const{tableMarkers:n,sofMarkers:i}=XFe();let a=2;for(;a+9<e.byteLength;){const s=e.getUint16(a,qf);if(i.has(s))return{mimeType:"image/jpeg",height:e.getUint16(a+5,qf),width:e.getUint16(a+7,qf)};if(!n.has(s))return null;a+=2,a+=e.getUint16(a,qf)}return null}function XFe(){const t=new Set([65499,65476,65484,65501,65534]);for(let r=65504;r<65520;++r)t.add(r);return{tableMarkers:t,sofMarkers:new Set([65472,65473,65474,65475,65477,65478,65479,65481,65482,65483,65485,65486,65487,65502])}}function vx(t){if(t instanceof DataView)return t;if(ArrayBuffer.isView(t))return new DataView(t.buffer);if(t instanceof ArrayBuffer)return new DataView(t);throw new Error("toDataView")}async function YFe(t,e){const{mimeType:r}=aee(t)||{},n=globalThis.loaders?.parseImageNode;return oE(n),await n(t,r)}async function ZFe(t,e,r){e=e||{};const i=(e.image||{}).type||"auto",{url:a}=r||{},s=KFe(i);let o;switch(s){case"imagebitmap":o=await NFe(t,e,a);break;case"image":o=await iee(t,e,a);break;case"data":o=await YFe(t);break;default:oE(!1)}return i==="data"&&(o=IFe(o)),o}function KFe(t){switch(t){case"auto":case"data":return CFe();default:return TFe(t),t}}const JFe=["png","jpg","jpeg","gif","webp","bmp","ico","svg","avif"],QFe=["image/png","image/jpeg","image/gif","image/webp","image/avif","image/bmp","image/vnd.microsoft.icon","image/svg+xml"],e8e={image:{type:"auto",decode:!0}},t8e={dataType:null,batchType:null,id:"image",module:"images",name:"Images",version:wFe,mimeTypes:QFe,extensions:JFe,parse:ZFe,tests:[t=>!!aee(new DataView(t))],options:e8e},Za=new mx({id:"deck"});let VM={};function r8e(t){VM=t}function Uu(t,e,r,n){Za.level>0&&VM[t]&&VM[t].call(null,e,r,n)}function n8e(t){const e=t[0],r=t[t.length-1];return e==="{"&&r==="}"||e==="["&&r==="]"}const i8e={dataType:null,batchType:null,id:"JSON",name:"JSON",module:"",version:"",options:{},extensions:["json","geojson"],mimeTypes:["application/json","application/geo+json"],testText:n8e,parseTextSync:JSON.parse};function a8e(){const t="9.1.14",e=globalThis.deck&&globalThis.deck.VERSION;if(e&&e!==t)throw new Error(`deck.gl - multiple versions detected: ${e} vs ${t}`);return e||(Za.log(1,`deck.gl ${t}`)(),globalThis.deck={...globalThis.deck,VERSION:t,version:t,log:Za,_registerLoggers:r8e},K6e([i8e,[t8e,{imagebitmap:{premultiplyAlpha:"none"}}]])),t}const o8e=a8e();function IN(t,e){if(!t)throw new Error(e||"shadertools: assertion failed.")}const PI={number:{type:"number",validate(t,e){return Number.isFinite(t)&&typeof e=="object"&&(e.max===void 0||t<=e.max)&&(e.min===void 0||t>=e.min)}},array:{type:"array",validate(t,e){return Array.isArray(t)||ArrayBuffer.isView(t)}}};function s8e(t){const e={};for(const[r,n]of Object.entries(t))e[r]=l8e(n);return e}function l8e(t){let e=fq(t);if(e!=="object")return{value:t,...PI[e],type:e};if(typeof t=="object")return t?t.type!==void 0?{...t,...PI[t.type],type:t.type}:t.value===void 0?{type:"object",value:t}:(e=fq(t.value),{...t,...PI[e],type:e}):{type:"object",value:null};throw new Error("props")}function fq(t){return Array.isArray(t)||ArrayBuffer.isView(t)?"array":typeof t}const u8e=`#ifdef MODULE_LOGDEPTH
  logdepth_adjustPosition(gl_Position);
#endif
`,c8e=`#ifdef MODULE_MATERIAL
  fragColor = material_filterColor(fragColor);
#endif

#ifdef MODULE_LIGHTING
  fragColor = lighting_filterColor(fragColor);
#endif

#ifdef MODULE_FOG
  fragColor = fog_filterColor(fragColor);
#endif

#ifdef MODULE_PICKING
  fragColor = picking_filterHighlightColor(fragColor);
  fragColor = picking_filterPickingColor(fragColor);
#endif

#ifdef MODULE_LOGDEPTH
  logdepth_setFragDepth();
#endif
`,h8e={vertex:u8e,fragment:c8e},dq=/void\s+main\s*\([^)]*\)\s*\{\n?/,pq=/}\n?[^{}]*$/,kI=[],kw="__LUMA_INJECT_DECLARATIONS__";function f8e(t){const e={vertex:{},fragment:{}};for(const r in t){let n=t[r];const i=d8e(r);typeof n=="string"&&(n={order:0,injection:n}),e[i][r]=n}return e}function d8e(t){const e=t.slice(0,2);switch(e){case"vs":return"vertex";case"fs":return"fragment";default:throw new Error(e)}}function uE(t,e,r,n=!1){const i=e==="vertex";for(const a in r){const s=r[a];s.sort((u,h)=>u.order-h.order),kI.length=s.length;for(let u=0,h=s.length;u<h;++u)kI[u]=s[u].injection;const o=`${kI.join(`
`)}
`;switch(a){case"vs:#decl":i&&(t=t.replace(kw,o));break;case"vs:#main-start":i&&(t=t.replace(dq,u=>u+o));break;case"vs:#main-end":i&&(t=t.replace(pq,u=>o+u));break;case"fs:#decl":i||(t=t.replace(kw,o));break;case"fs:#main-start":i||(t=t.replace(dq,u=>u+o));break;case"fs:#main-end":i||(t=t.replace(pq,u=>o+u));break;default:t=t.replace(a,u=>u+o)}}return t=t.replace(kw,""),n&&(t=t.replace(/\}\s*$/,a=>a+h8e[e])),t}function cE(t){t.map(e=>p8e(e))}function p8e(t){if(t.instance)return;cE(t.dependencies||[]);const{propTypes:e={},deprecations:r=[],inject:n={}}=t,i={normalizedInjections:f8e(n),parsedDeprecations:g8e(r)};e&&(i.propValidators=s8e(e)),t.instance=i;let a={};e&&(a=Object.entries(e).reduce((s,[o,u])=>{const h=u?.value;return h&&(s[o]=h),s},{})),t.defaultUniforms={...t.defaultUniforms,...a}}function oee(t,e,r){t.deprecations?.forEach(n=>{n.regex?.test(e)&&(n.deprecated?r.deprecated(n.old,n.new)():r.removed(n.old,n.new)())})}function g8e(t){return t.forEach(e=>{switch(e.type){case"function":e.regex=new RegExp(`\\b${e.old}\\(`);break;default:e.regex=new RegExp(`${e.type} ${e.old};`)}}),t}function PN(t){cE(t);const e={},r={};see({modules:t,level:0,moduleMap:e,moduleDepth:r});const n=Object.keys(r).sort((i,a)=>r[a]-r[i]).map(i=>e[i]);return cE(n),n}function see(t){const{modules:e,level:r,moduleMap:n,moduleDepth:i}=t;if(r>=5)throw new Error("Possible loop in shader dependency graph");for(const a of e)n[a.name]=a,(i[a.name]===void 0||i[a.name]<r)&&(i[a.name]=r);for(const a of e)a.dependencies&&see({modules:a.dependencies,level:r+1,moduleMap:n,moduleDepth:i})}function m8e(t){switch(t?.gpu.toLowerCase()){case"apple":return`#define APPLE_GPU
// Apple optimizes away the calculation necessary for emulated fp64
#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1
#define LUMA_FP32_TAN_PRECISION_WORKAROUND 1
// Intel GPU doesn't have full 32 bits precision in same cases, causes overflow
#define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1
`;case"nvidia":return`#define NVIDIA_GPU
// Nvidia optimizes away the calculation necessary for emulated fp64
#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1
`;case"intel":return`#define INTEL_GPU
// Intel optimizes away the calculation necessary for emulated fp64
#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1
// Intel's built-in 'tan' function doesn't have acceptable precision
#define LUMA_FP32_TAN_PRECISION_WORKAROUND 1
// Intel GPU doesn't have full 32 bits precision in same cases, causes overflow
#define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1
`;case"amd":return`#define AMD_GPU
`;default:return`#define DEFAULT_GPU
// Prevent driver from optimizing away the calculation necessary for emulated fp64
#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1
// Headless Chrome's software shader 'tan' function doesn't have acceptable precision
#define LUMA_FP32_TAN_PRECISION_WORKAROUND 1
// If the GPU doesn't have full 32 bits precision, will causes overflow
#define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1
`}}function y8e(t,e){if(Number(t.match(/^#version[ \t]+(\d+)/m)?.[1]||100)!==300)throw new Error("luma.gl v9 only supports GLSL 3.00 shader sources");switch(e){case"vertex":return t=gq(t,v8e),t;case"fragment":return t=gq(t,_8e),t;default:throw new Error(e)}}const lee=[[/^(#version[ \t]+(100|300[ \t]+es))?[ \t]*\n/,`#version 300 es
`],[/\btexture(2D|2DProj|Cube)Lod(EXT)?\(/g,"textureLod("],[/\btexture(2D|2DProj|Cube)(EXT)?\(/g,"texture("]],v8e=[...lee,[$M("attribute"),"in $1"],[$M("varying"),"out $1"]],_8e=[...lee,[$M("varying"),"in $1"]];function gq(t,e){for(const[r,n]of e)t=t.replace(r,n);return t}function $M(t){return new RegExp(`\\b${t}[ \\t]+(\\w+[ \\t]+\\w+(\\[\\w+\\])?;)`,"g")}function uee(t,e){let r="";for(const n in t){const i=t[n];if(r+=`void ${i.signature} {
`,i.header&&(r+=`  ${i.header}`),e[n]){const a=e[n];a.sort((s,o)=>s.order-o.order);for(const s of a)r+=`  ${s.injection}
`}i.footer&&(r+=`  ${i.footer}`),r+=`}
`}return r}function cee(t){const e={vertex:{},fragment:{}};for(const r of t){let n,i;typeof r!="string"?(n=r,i=n.hook):(n={},i=r),i=i.trim();const[a,s]=i.split(":"),o=i.replace(/\(.+/,""),u=Object.assign(n,{signature:s});switch(a){case"vs":e.vertex[o]=u;break;case"fs":e.fragment[o]=u;break;default:throw new Error(a)}}return e}function b8e(t,e){return{name:x8e(t,e),language:"glsl",version:w8e(t)}}function x8e(t,e="unnamed"){const n=/#define[^\S\r\n]*SHADER_NAME[^\S\r\n]*([A-Za-z0-9_-]+)\s*/.exec(t);return n?n[1]:e}function w8e(t){let e=100;const r=t.match(/[^\s]+/g);if(r&&r.length>=2&&r[0]==="#version"){const n=parseInt(r[1],10);Number.isFinite(n)&&(e=n)}if(e!==100&&e!==300)throw new Error(`Invalid GLSL version ${e}`);return e}const hee=`

${kw}
`,S8e=`precision highp float;
`;function E8e(t){const e=PN(t.modules||[]);return{source:C8e(t.platformInfo,{...t,source:t.source,stage:"vertex",modules:e}),getUniforms:fee(e)}}function T8e(t){const{vs:e,fs:r}=t,n=PN(t.modules||[]);return{vs:mq(t.platformInfo,{...t,source:e,stage:"vertex",modules:n}),fs:mq(t.platformInfo,{...t,source:r,stage:"fragment",modules:n}),getUniforms:fee(n)}}function C8e(t,e){const{source:r,stage:n,modules:i,hookFunctions:a=[],inject:s={},log:o}=e;IN(typeof r=="string","shader source must be a string");const u=r;let h="";const f=cee(a),g={},b={},v={};for(const E in s){const P=typeof s[E]=="string"?{injection:s[E],order:0}:s[E],k=/^(v|f)s:(#)?([\w-]+)$/.exec(E);if(k){const L=k[2],O=k[3];L?O==="decl"?b[E]=[P]:v[E]=[P]:g[E]=[P]}else v[E]=[P]}const S=i;for(const E of S){o&&oee(E,u,o);const P=dee(E,"wgsl");h+=P;const k=E.injections?.[n]||{};for(const L in k){const O=/^(v|f)s:#([\w-]+)$/.exec(L);if(O){const z=O[2]==="decl"?b:v;z[L]=z[L]||[],z[L].push(k[L])}else g[L]=g[L]||[],g[L].push(k[L])}}return h+=hee,h=uE(h,n,b),h+=uee(f[n],g),h+=u,h=uE(h,n,v),h}function mq(t,e){const{id:r,source:n,stage:i,language:a="glsl",modules:s,defines:o={},hookFunctions:u=[],inject:h={},prologue:f=!0,log:g}=e;IN(typeof n=="string","shader source must be a string");const b=a==="glsl"?b8e(n).version:-1,v=t.shaderLanguageVersion,S=b===100?"#version 100":"#version 300 es",P=n.split(`
`).slice(1).join(`
`),k={};s.forEach(q=>{Object.assign(k,q.defines)}),Object.assign(k,o);let L="";switch(a){case"wgsl":break;case"glsl":L=f?`${S}

// ----- PROLOGUE -------------------------
${A8e({id:r,source:n,stage:i})}
${`#define SHADER_TYPE_${i.toUpperCase()}`}

${m8e(t)}
${i==="fragment"?S8e:""}

// ----- APPLICATION DEFINES -------------------------

${I8e(k)}

`:`${S}
`;break}const O=cee(u),M={},z={},B={};for(const q in h){const W=typeof h[q]=="string"?{injection:h[q],order:0}:h[q],G=/^(v|f)s:(#)?([\w-]+)$/.exec(q);if(G){const ie=G[2],Q=G[3];ie?Q==="decl"?z[q]=[W]:B[q]=[W]:M[q]=[W]}else B[q]=[W]}for(const q of s){g&&oee(q,P,g);const W=dee(q,i);L+=W;const G=q.instance?.normalizedInjections[i]||{};for(const ie in G){const Q=/^(v|f)s:#([\w-]+)$/.exec(ie);if(Q){const ne=Q[2]==="decl"?z:B;ne[ie]=ne[ie]||[],ne[ie].push(G[ie])}else M[ie]=M[ie]||[],M[ie].push(G[ie])}}return L+="// ----- MAIN SHADER SOURCE -------------------------",L+=hee,L=uE(L,i,z),L+=uee(O[i],M),L+=P,L=uE(L,i,B),a==="glsl"&&b!==v&&(L=y8e(L,i)),L.trim()}function fee(t){return function(r){const n={};for(const i of t){const a=i.getUniforms?.(r,n);Object.assign(n,a)}return n}}function A8e(t){const{id:e,source:r,stage:n}=t;return e&&r.indexOf("SHADER_NAME")===-1?`
#define SHADER_NAME ${e}_${n}`:""}function I8e(t={}){let e="";for(const r in t){const n=t[r];(n||Number.isFinite(n))&&(e+=`#define ${r.toUpperCase()} ${t[r]}
`)}return e}function dee(t,e){let r;switch(e){case"vertex":r=t.vs||"";break;case"fragment":r=t.fs||"";break;case"wgsl":r=t.source||"";break;default:IN(!1)}if(!t.name)throw new Error("Shader module must have a name");const n=t.name.toUpperCase().replace(/[^0-9a-z]/gi,"_");let i=`// ----- MODULE ${t.name} ---------------

`;return e!=="wgsl"&&(i+=`#define MODULE_${n}
`),i+=`${r}
`,i}const P8e=/^\s*\#\s*ifdef\s*([a-zA-Z_]+)\s*$/,k8e=/^\s*\#\s*endif\s*$/;function M8e(t,e){const r=t.split(`
`),n=[];let i=!0,a=null;for(const s of r){const o=s.match(P8e),u=s.match(k8e);o?(a=o[1],i=!!e?.defines?.[a]):u?i=!0:i&&n.push(s)}return n.join(`
`)}class Qg{static defaultShaderAssembler;_hookFunctions=[];_defaultModules=[];static getDefaultShaderAssembler(){return Qg.defaultShaderAssembler=Qg.defaultShaderAssembler||new Qg,Qg.defaultShaderAssembler}addDefaultModule(e){this._defaultModules.find(r=>r.name===(typeof e=="string"?e:e.name))||this._defaultModules.push(e)}removeDefaultModule(e){const r=typeof e=="string"?e:e.name;this._defaultModules=this._defaultModules.filter(n=>n.name!==r)}addShaderHook(e,r){r&&(e=Object.assign(r,{hook:e})),this._hookFunctions.push(e)}assembleWGSLShader(e){const r=this._getModuleList(e.modules),n=this._hookFunctions,{source:i,getUniforms:a}=E8e({...e,source:e.source,modules:r,hookFunctions:n});return{source:e.platformInfo.shaderLanguage==="wgsl"?M8e(i):i,getUniforms:a,modules:r}}assembleGLSLShaderPair(e){const r=this._getModuleList(e.modules),n=this._hookFunctions;return{...T8e({...e,vs:e.vs,fs:e.fs,modules:r,hookFunctions:n}),modules:r}}_getModuleList(e=[]){const r=new Array(this._defaultModules.length+e.length),n={};let i=0;for(let a=0,s=this._defaultModules.length;a<s;++a){const o=this._defaultModules[a],u=o.name;r[i++]=o,n[u]=!0}for(let a=0,s=e.length;a<s;++a){const o=e[a],u=o.name;n[u]||(r[i++]=o,n[u]=!0)}return r.length=i,cE(r),r}}const R8e=`out vec4 transform_output;
void main() {
  transform_output = vec4(0);
}`,O8e=`#version 300 es
${R8e}`;function L8e(t){const{input:e,inputChannels:r,output:n}={};if(!e)return O8e;if(!r)throw new Error("inputChannels");const i=N8e(r),a=D8e(e,r);return`#version 300 es
in ${i} ${e};
out vec4 ${n};
void main() {
  ${n} = ${a};
}`}function N8e(t){switch(t){case 1:return"float";case 2:return"vec2";case 3:return"vec3";case 4:return"vec4";default:throw new Error(`invalid channels: ${t}`)}}function D8e(t,e){switch(e){case 1:return`vec4(${t}, 0.0, 0.0, 1.0)`;case 2:return`vec4(${t}, 0.0, 1.0)`;case 3:return`vec4(${t}, 1.0)`;case 4:return t;default:throw new Error(`invalid channels: ${e}`)}}class F8e{stats=new Map;getStats(e){return this.get(e)}get(e){return this.stats.has(e)||this.stats.set(e,new ZT({id:e})),this.stats.get(e)}}const pee=new F8e,dn=new mx({id:"luma.gl"}),MI={};function JT(t="id"){MI[t]=MI[t]||1;const e=MI[t]++;return`${t}-${e}`}let bo=class{static defaultProps={id:"undefined",handle:void 0,userData:void 0};toString(){return`${this[Symbol.toStringTag]||this.constructor.name}:"${this.id}"`}id;props;userData={};_device;destroyed=!1;allocatedBytes=0;_attachedResources=new Set;constructor(e,r,n){if(!e)throw new Error("no device");this._device=e,this.props=B8e(r,n);const i=this.props.id!=="undefined"?this.props.id:JT(this[Symbol.toStringTag]);this.props.id=i,this.id=i,this.userData=this.props.userData||{},this.addStats()}destroy(){this.destroyResource()}delete(){return this.destroy(),this}getProps(){return this.props}attachResource(e){this._attachedResources.add(e)}detachResource(e){this._attachedResources.delete(e)}destroyAttachedResource(e){this._attachedResources.delete(e)&&e.destroy()}destroyAttachedResources(){for(const e of Object.values(this._attachedResources))e.destroy();this._attachedResources=new Set}destroyResource(){this.destroyAttachedResources(),this.removeStats(),this.destroyed=!0}removeStats(){const e=this._device.statsManager.getStats("Resource Counts"),r=this[Symbol.toStringTag];e.get(`${r}s Active`).decrementCount()}trackAllocatedMemory(e,r=this[Symbol.toStringTag]){const n=this._device.statsManager.getStats("Resource Counts");n.get("GPU Memory").addCount(e),n.get(`${r} Memory`).addCount(e),this.allocatedBytes=e}trackDeallocatedMemory(e=this[Symbol.toStringTag]){const r=this._device.statsManager.getStats("Resource Counts");r.get("GPU Memory").subtractCount(this.allocatedBytes),r.get(`${e} Memory`).subtractCount(this.allocatedBytes),this.allocatedBytes=0}addStats(){const e=this._device.statsManager.getStats("Resource Counts"),r=this[Symbol.toStringTag];e.get("Resources Created").incrementCount(),e.get(`${r}s Created`).incrementCount(),e.get(`${r}s Active`).incrementCount()}};function B8e(t,e){const r={...e};for(const n in t)t[n]!==void 0&&(r[n]=t[n]);return r}class Oo extends bo{static defaultProps={...bo.defaultProps,usage:0,byteLength:0,byteOffset:0,data:null,indexType:"uint16",mappedAtCreation:!1};static MAP_READ=1;static MAP_WRITE=2;static COPY_SRC=4;static COPY_DST=8;static INDEX=16;static VERTEX=32;static UNIFORM=64;static STORAGE=128;static INDIRECT=256;static QUERY_RESOLVE=512;get[Symbol.toStringTag](){return"Buffer"}usage;indexType;updateTimestamp;constructor(e,r){const n={...r};(r.usage||0)&Oo.INDEX&&!r.indexType&&(r.data instanceof Uint32Array?n.indexType="uint32":r.data instanceof Uint16Array&&(n.indexType="uint16")),delete n.data,super(e,n,Oo.defaultProps),this.usage=n.usage||0,this.indexType=n.indexType,this.updateTimestamp=e.incrementTimestamp()}clone(e){return this.device.createBuffer({...this.props,...e})}readSyncWebGL(e,r){throw new Error("not implemented")}static DEBUG_DATA_MAX_LENGTH=32;debugData=new ArrayBuffer(0);_setDebugData(e,r,n){const i=ArrayBuffer.isView(e)?e.buffer:e,a=Math.min(e?e.byteLength:n,Oo.DEBUG_DATA_MAX_LENGTH);i===null?this.debugData=new ArrayBuffer(a):r===0&&n===i.byteLength?this.debugData=i.slice(0,a):this.debugData=i.slice(r,r+a)}}function gee(t){const e=yq[t],r=z8e(e),n=t.includes("norm"),i=!n&&!t.startsWith("float"),a=t.startsWith("s");return{dataType:yq[t],byteLength:r,integer:i,signed:a,normalized:n}}function z8e(t){return j8e[t]}const yq={uint8:"uint8",sint8:"sint8",unorm8:"uint8",snorm8:"sint8",uint16:"uint16",sint16:"sint16",unorm16:"uint16",snorm16:"sint16",float16:"float16",float32:"float32",uint32:"uint32",sint32:"sint32"},j8e={uint8:1,sint8:1,uint16:2,sint16:2,float16:2,float32:4,uint32:4,sint32:4},Du="texture-compression-bc",mo="texture-compression-astc",Df="texture-compression-etc2",U8e="texture-compression-etc1-webgl",q2="texture-compression-pvrtc-webgl",RI="texture-compression-atc-webgl",H2="float32-renderable-webgl",OI="float16-renderable-webgl",V8e="rgb9e5ufloat-renderable-webgl",LI="snorm8-renderable-webgl",j_="norm16-renderable-webgl",NI="snorm16-renderable-webgl",W2="float32-filterable",vq="float16-filterable-webgl";function mee(t){const e=$8e[t];if(!e)throw new Error(`Unsupported texture format ${t}`);return e}const $8e={r8unorm:{},r8snorm:{render:LI},r8uint:{},r8sint:{},rg8unorm:{},rg8snorm:{render:LI},rg8uint:{},rg8sint:{},r16uint:{},r16sint:{},r16float:{render:OI,filter:"float16-filterable-webgl"},"r16unorm-webgl":{f:j_},"r16snorm-webgl":{f:NI},"rgba4unorm-webgl":{channels:"rgba",bitsPerChannel:[4,4,4,4],packed:!0},"rgb565unorm-webgl":{channels:"rgb",bitsPerChannel:[5,6,5,0],packed:!0},"rgb5a1unorm-webgl":{channels:"rgba",bitsPerChannel:[5,5,5,1],packed:!0},"rgb8unorm-webgl":{},"rgb8snorm-webgl":{},rgba8unorm:{},"rgba8unorm-srgb":{},rgba8snorm:{render:LI},rgba8uint:{},rgba8sint:{},bgra8unorm:{},"bgra8unorm-srgb":{},rg16uint:{},rg16sint:{},rg16float:{render:OI,filter:vq},"rg16unorm-webgl":{render:j_},"rg16snorm-webgl":{render:NI},r32uint:{},r32sint:{},r32float:{render:H2,filter:W2},rgb9e5ufloat:{channels:"rgb",packed:!0,render:V8e},rg11b10ufloat:{channels:"rgb",bitsPerChannel:[11,11,10,0],packed:!0,p:1,render:H2},rgb10a2unorm:{channels:"rgba",bitsPerChannel:[10,10,10,2],packed:!0,p:1},"rgb10a2uint-webgl":{channels:"rgba",bitsPerChannel:[10,10,10,2],packed:!0,p:1,wgpu:!1},"rgb16unorm-webgl":{f:j_},"rgb16snorm-webgl":{f:j_},rg32uint:{},rg32sint:{},rg32float:{render:!1,filter:W2},rgba16uint:{},rgba16sint:{},rgba16float:{render:OI,filter:vq},"rgba16unorm-webgl":{render:j_},"rgba16snorm-webgl":{render:NI},"rgb32float-webgl":{render:H2,filter:W2},rgba32uint:{},rgba32sint:{},rgba32float:{render:H2,filter:W2},stencil8:{attachment:"stencil",bitsPerChannel:[8,0,0,0],dataType:"uint8"},depth16unorm:{attachment:"depth",bitsPerChannel:[16,0,0,0],dataType:"uint16"},depth24plus:{attachment:"depth",bitsPerChannel:[24,0,0,0],dataType:"uint32"},depth32float:{attachment:"depth",bitsPerChannel:[32,0,0,0],dataType:"float32"},"depth24plus-stencil8":{attachment:"depth-stencil",bitsPerChannel:[24,8,0,0],packed:!0},"depth32float-stencil8":{attachment:"depth-stencil",bitsPerChannel:[32,8,0,0],packed:!0},"bc1-rgb-unorm-webgl":{f:Du},"bc1-rgb-unorm-srgb-webgl":{f:Du},"bc1-rgba-unorm":{f:Du},"bc1-rgba-unorm-srgb":{f:Du},"bc2-rgba-unorm":{f:Du},"bc2-rgba-unorm-srgb":{f:Du},"bc3-rgba-unorm":{f:Du},"bc3-rgba-unorm-srgb":{f:Du},"bc4-r-unorm":{f:Du},"bc4-r-snorm":{f:Du},"bc5-rg-unorm":{f:Du},"bc5-rg-snorm":{f:Du},"bc6h-rgb-ufloat":{f:Du},"bc6h-rgb-float":{f:Du},"bc7-rgba-unorm":{f:Du},"bc7-rgba-unorm-srgb":{f:Du},"etc2-rgb8unorm":{f:Df},"etc2-rgb8unorm-srgb":{f:Df},"etc2-rgb8a1unorm":{f:Df},"etc2-rgb8a1unorm-srgb":{f:Df},"etc2-rgba8unorm":{f:Df},"etc2-rgba8unorm-srgb":{f:Df},"eac-r11unorm":{f:Df},"eac-r11snorm":{f:Df},"eac-rg11unorm":{f:Df},"eac-rg11snorm":{f:Df},"astc-4x4-unorm":{f:mo},"astc-4x4-unorm-srgb":{f:mo},"astc-5x4-unorm":{f:mo},"astc-5x4-unorm-srgb":{f:mo},"astc-5x5-unorm":{f:mo},"astc-5x5-unorm-srgb":{f:mo},"astc-6x5-unorm":{f:mo},"astc-6x5-unorm-srgb":{f:mo},"astc-6x6-unorm":{f:mo},"astc-6x6-unorm-srgb":{f:mo},"astc-8x5-unorm":{f:mo},"astc-8x5-unorm-srgb":{f:mo},"astc-8x6-unorm":{f:mo},"astc-8x6-unorm-srgb":{f:mo},"astc-8x8-unorm":{f:mo},"astc-8x8-unorm-srgb":{f:mo},"astc-10x5-unorm":{f:mo},"astc-10x5-unorm-srgb":{f:mo},"astc-10x6-unorm":{f:mo},"astc-10x6-unorm-srgb":{f:mo},"astc-10x8-unorm":{f:mo},"astc-10x8-unorm-srgb":{f:mo},"astc-10x10-unorm":{f:mo},"astc-10x10-unorm-srgb":{f:mo},"astc-12x10-unorm":{f:mo},"astc-12x10-unorm-srgb":{f:mo},"astc-12x12-unorm":{f:mo},"astc-12x12-unorm-srgb":{f:mo},"pvrtc-rgb4unorm-webgl":{f:q2},"pvrtc-rgba4unorm-webgl":{f:q2},"pvrtc-rbg2unorm-webgl":{f:q2},"pvrtc-rgba2unorm-webgl":{f:q2},"etc1-rbg-unorm-webgl":{f:U8e},"atc-rgb-unorm-webgl":{f:RI},"atc-rgba-unorm-webgl":{f:RI},"atc-rgbai-unorm-webgl":{f:RI}},q8e=["bc1","bc2","bc3","bc4","bc5","bc6","bc7","etc1","etc2","eac","atc","astc","pvrtc"],H8e=/^(r|rg|rgb|rgba|bgra)([0-9]*)([a-z]*)(-srgb)?(-webgl)?$/;function yee(t){return q8e.some(e=>t.startsWith(e))}function kN(t){let e=W8e(t);if(yee(t)){e.channels="rgb",e.components=3,e.bytesPerPixel=1,e.srgb=!1,e.compressed=!0;const n=G8e(t);n&&(e.blockWidth=n.blockWidth,e.blockHeight=n.blockHeight)}const r=H8e.exec(t);if(r){const[,n,i,a,s,o]=r,u=`${a}${i}`,h=gee(u),f=h.byteLength*8,g=n.length,b=[f,g>=2?f:0,g>=3?f:0,g>=4?f:0];e={format:t,attachment:e.attachment,dataType:h.dataType,components:g,channels:n,integer:h.integer,signed:h.signed,normalized:h.normalized,bitsPerChannel:b,bytesPerPixel:h.byteLength*n.length,packed:e.packed,srgb:e.srgb},o==="-webgl"&&(e.webgl=!0),s==="-srgb"&&(e.srgb=!0)}return t.endsWith("-webgl")&&(e.webgl=!0),t.endsWith("-srgb")&&(e.srgb=!0),e}function W8e(t){const e=mee(t),r=e.bytesPerPixel||1,n=e.bitsPerChannel||[8,8,8,8];return delete e.bitsPerChannel,delete e.bytesPerPixel,delete e.f,delete e.render,delete e.filter,delete e.blend,delete e.store,{...e,format:t,attachment:e.attachment||"color",channels:e.channels||"r",components:e.components||e.channels?.length||1,bytesPerPixel:r,bitsPerChannel:n,dataType:e.dataType||"uint8",srgb:e.srgb??!1,packed:e.packed??!1,webgl:e.webgl??!1,integer:e.integer??!1,signed:e.signed??!1,normalized:e.normalized??!1,compressed:e.compressed??!1}}function G8e(t){const r=/.*-(\d+)x(\d+)-.*/.exec(t);if(r){const[,n,i]=r;return{blockWidth:Number(n),blockHeight:Number(i)}}return null}function X8e(t){const e=mee(t),r={format:t,create:e.f??!0,render:e.render??!0,filter:e.filter??!0,blend:e.blend??!0,store:e.store??!0},n=kN(t),i=t.startsWith("depth")||t.startsWith("stencil"),a=n?.signed,s=n?.integer,o=n?.webgl;return r.render&&=!a,r.filter&&=!i&&!a&&!s&&!o,r}class Y8e{}class Z8e{features;disabledFeatures;constructor(e=[],r){this.features=new Set(e),this.disabledFeatures=r||{}}*[Symbol.iterator](){yield*this.features}has(e){return!this.disabledFeatures?.[e]&&this.features.has(e)}}class Wp{static defaultProps={id:null,powerPreference:"high-performance",failIfMajorPerformanceCaveat:!1,createCanvasContext:void 0,onError:e=>dn.error(e.message)(),_reuseDevices:!1,_requestMaxLimits:!0,_factoryDestroyPolicy:"unused",_initializeFeatures:!0,_disabledFeatures:{"compilation-status-async-webgl":!0},_resourceDefaults:{},webgl:{},debug:dn.get("debug")||void 0,debugShaders:dn.get("debug-shaders")||void 0,debugFramebuffers:!!dn.get("debug-framebuffers"),debugWebGL:!!dn.get("debug-webgl"),debugSpectorJS:void 0,debugSpectorJSUrl:void 0,_handle:void 0};get[Symbol.toStringTag](){return"Device"}constructor(e){this.props={...Wp.defaultProps,...e},this.id=this.props.id||JT(this[Symbol.toStringTag].toLowerCase())}id;props;userData={};statsManager=pee;timestamp=0;_reused=!1;_lumaData={};getTextureFormatCapabilities(e){const r=X8e(e),n=s=>(typeof s=="string"?this.features.has(s):s)??!0,i=n(r.create),a={format:e,create:i,render:i&&n(r.render),filter:i&&n(r.filter),blend:i&&n(r.blend),store:i&&n(r.store)};return this._getDeviceSpecificTextureFormatCapabilities(a)}isTextureFormatSupported(e,r){return this.getTextureFormatCapabilities(e).create}isTextureFormatFilterable(e){return this.getTextureFormatCapabilities(e).filter}isTextureFormatRenderable(e){return this.getTextureFormatCapabilities(e).render}isTextureFormatCompressed(e){return yee(e)}loseDevice(){return!1}reportError(e){this.props.onError(e)}getDefaultCanvasContext(){if(!this.canvasContext)throw new Error("Device has no default CanvasContext. See props.createCanvasContext");return this.canvasContext}createCommandEncoder(e={}){throw new Error("not implemented")}incrementTimestamp(){return this.timestamp++}onError(e){this.props.onError(e)}getCanvasContext(){return this.getDefaultCanvasContext()}readPixelsToArrayWebGL(e,r){throw new Error("not implemented")}readPixelsToBufferWebGL(e,r){throw new Error("not implemented")}setParametersWebGL(e){throw new Error("not implemented")}getParametersWebGL(e){throw new Error("not implemented")}withParametersWebGL(e,r){throw new Error("not implemented")}clearWebGL(e){throw new Error("not implemented")}resetWebGL(){throw new Error("not implemented")}static _getCanvasContextProps(e){return e.createCanvasContext===!0?{}:e.createCanvasContext}_normalizeBufferProps(e){(e instanceof ArrayBuffer||ArrayBuffer.isView(e))&&(e={data:e});const r={...e};return(e.usage||0)&Oo.INDEX&&!e.indexType&&(e.data instanceof Uint32Array?r.indexType="uint32":e.data instanceof Uint16Array?r.indexType="uint16":dn.warn("indices buffer content must be of integer type")()),r}}const K8e=Zm()&&typeof document<"u",J8e=()=>K8e&&document.readyState==="complete",Q8e="set luma.log.level=1 (or higher) to trace rendering",_q="No matching device found. Ensure `@luma.gl/webgl` and/or `@luma.gl/webgpu` modules are imported.";class kv{static defaultProps={...Wp.defaultProps,type:"best-available",adapters:void 0,waitForPageLoad:!0};static pageLoaded=eBe().then(()=>{dn.probe(2,"DOM is loaded")()});stats=pee;log=dn;VERSION="9.1.9";spector;preregisteredAdapters=new Map;constructor(){if(globalThis.luma){if(globalThis.luma.VERSION!==this.VERSION)throw dn.error(`Found luma.gl ${globalThis.luma.VERSION} while initialzing ${this.VERSION}`)(),dn.error("'yarn why @luma.gl/core' can help identify the source of the conflict")(),new Error("luma.gl - multiple versions detected: see console log");dn.error("This version of luma.gl has already been initialized")()}dn.log(1,`${this.VERSION} - ${Q8e}`)(),globalThis.luma=this}registerAdapters(e){for(const r of e)this.preregisteredAdapters.set(r.type,r)}getSupportedAdapters(e=[]){const r=this.getAdapterMap(e);return Array.from(r).map(([,n])=>n).filter(n=>n.isSupported?.()).map(n=>n.type)}getBestAvailableAdapter(e=[]){const r=this.getAdapterMap(e);return r.get("webgpu")?.isSupported?.()?"webgpu":r.get("webgl")?.isSupported?.()?"webgl":null}setDefaultDeviceProps(e){Object.assign(kv.defaultProps,e)}async createDevice(e={}){e={...kv.defaultProps,...e},e.waitForPageLoad&&await kv.pageLoaded;const r=this.getAdapterMap(e.adapters);let n=e.type||"";n==="best-available"&&(n=this.getBestAvailableAdapter(e.adapters)||n);const s=await(this.getAdapterMap(e.adapters)||r).get(n)?.create?.(e);if(s)return s;throw new Error(_q)}async attachDevice(e){const r=this.getAdapterMap(e.adapters);let n="";e.handle instanceof WebGL2RenderingContext&&(n="webgl"),e.createCanvasContext&&await kv.pageLoaded,e.handle===null&&(n="unknown");const a=await r.get(n)?.attach?.(null);if(a)return a;throw new Error(_q)}enforceWebGL2(e=!0,r=[]){const i=this.getAdapterMap(r).get("webgl");i||dn.warn("enforceWebGL2: webgl adapter not found")(),i?.enforceWebGL2?.(e)}getAdapterMap(e=[]){const r=new Map(this.preregisteredAdapters);for(const n of e)r.set(n.type,n);return r}registerDevices(e){dn.warn("luma.registerDevices() is deprecated, use luma.registerAdapters() instead");for(const r of e){const n=r.adapter;n&&this.preregisteredAdapters.set(n.type,n)}}}const qM=new kv;function eBe(){return J8e()||typeof window>"u"?Promise.resolve():new Promise(t=>{window.addEventListener("load",()=>t())})}class tBe{}class MN{static defaultProps={canvas:null,width:800,height:600,useDevicePixels:!0,autoResize:!0,container:null,visible:!0,alphaMode:"opaque",colorSpace:"srgb"};id;props;canvas;htmlCanvas;offscreenCanvas;type;width=1;height=1;resizeObserver;_canvasSizeInfo={clientWidth:0,clientHeight:0,devicePixelRatio:1};toString(){return`${this[Symbol.toStringTag]}(${this.id})`}constructor(e){if(this.props={...MN.defaultProps,...e},e=this.props,!Zm()){this.id="node-canvas-context",this.type="node",this.width=this.props.width,this.height=this.props.height,this.canvas=null;return}if(e.canvas)typeof e.canvas=="string"?this.canvas=nBe(e.canvas):this.canvas=e.canvas;else{const r=iBe(e),n=rBe(e?.container||null);n.insertBefore(r,n.firstChild),this.canvas=r,e?.visible||(this.canvas.style.visibility="hidden")}this.canvas instanceof HTMLCanvasElement?(this.id=this.canvas.id,this.type="html-canvas",this.htmlCanvas=this.canvas):(this.id="offscreen-canvas",this.type="offscreen-canvas",this.offscreenCanvas=this.canvas),this.canvas instanceof HTMLCanvasElement&&e.autoResize&&(this.resizeObserver=new ResizeObserver(r=>{for(const n of r)n.target===this.canvas&&this.update()}),this.resizeObserver.observe(this.canvas))}getDevicePixelRatio(e){return typeof OffscreenCanvas<"u"&&this.canvas instanceof OffscreenCanvas||(e=e===void 0?this.props.useDevicePixels:e,!e||e<=0)?1:e===!0?typeof window<"u"&&window.devicePixelRatio||1:e}getPixelSize(){switch(this.type){case"node":return[this.width,this.height];case"offscreen-canvas":return[this.canvas.width,this.canvas.height];case"html-canvas":const e=this.getDevicePixelRatio(),r=this.canvas;return r.parentElement?[r.clientWidth*e,r.clientHeight*e]:[this.canvas.width,this.canvas.height];default:throw new Error(this.type)}}getAspect(){const[e,r]=this.getPixelSize();return e/r}cssToDeviceRatio(){try{const[e]=this.getDrawingBufferSize(),r=this._canvasSizeInfo.clientWidth||this.htmlCanvas?.clientWidth;return r?e/r:1}catch{return 1}}cssToDevicePixels(e,r=!0){const n=this.cssToDeviceRatio(),[i,a]=this.getDrawingBufferSize();return aBe(e,n,i,a,r)}setDevicePixelRatio(e,r={}){if(!this.htmlCanvas)return;let n="width"in r?r.width:this.htmlCanvas.clientWidth,i="height"in r?r.height:this.htmlCanvas.clientHeight;(!n||!i)&&(dn.log(1,"Canvas clientWidth/clientHeight is 0")(),e=1,n=this.htmlCanvas.width||1,i=this.htmlCanvas.height||1);const a=this._canvasSizeInfo;if(a.clientWidth!==n||a.clientHeight!==i||a.devicePixelRatio!==e){let s=e;const o=Math.floor(n*s),u=Math.floor(i*s);if(this.htmlCanvas.width=o,this.htmlCanvas.height=u,this.device.gl){const[f,g]=this.getDrawingBufferSize();(f!==o||g!==u)&&(s=Math.min(f/n,g/i),this.htmlCanvas.width=Math.floor(n*s),this.htmlCanvas.height=Math.floor(i*s),dn.warn("Device pixel ratio clamped")()),this._canvasSizeInfo.clientWidth=n,this._canvasSizeInfo.clientHeight=i,this._canvasSizeInfo.devicePixelRatio=e}}}getDrawingBufferSize(){const e=this.device.gl;return e?[e.drawingBufferWidth,e.drawingBufferHeight]:this.getPixelSize()}_setAutoCreatedCanvasId(e){this.htmlCanvas?.id==="lumagl-auto-created-canvas"&&(this.htmlCanvas.id=e)}}function rBe(t){if(typeof t=="string"){const e=document.getElementById(t);if(!e)throw new Error(`${t} is not an HTML element`);return e}else if(t)return t;return document.body}function nBe(t){const e=document.getElementById(t);if(!(e instanceof HTMLCanvasElement))throw new Error("Object is not a canvas element");return e}function iBe(t){const{width:e,height:r}=t,n=document.createElement("canvas");return n.id=JT("lumagl-auto-created-canvas"),n.width=e||1,n.height=r||1,n.style.width=Number.isFinite(e)?`${e}px`:"100%",n.style.height=Number.isFinite(r)?`${r}px`:"100%",n}function aBe(t,e,r,n,i){const a=t,s=bq(a[0],e,r);let o=xq(a[1],e,n,i),u=bq(a[0]+1,e,r);const h=u===r-1?u:u-1;u=xq(a[1]+1,e,n,i);let f;return i?(u=u===0?u:u+1,f=o,o=u):f=u===n-1?u:u-1,{x:s,y:o,width:Math.max(h-s+1,1),height:Math.max(f-o+1,1)}}function bq(t,e,r){return Math.min(Math.round(t*e),r-1)}function xq(t,e,r,n){return n?Math.max(0,r-1-Math.round(t*e)):Math.min(Math.round(t*e),r-1)}class yo extends bo{static COPY_SRC=1;static COPY_DST=2;static TEXTURE=4;static STORAGE=8;static RENDER_ATTACHMENT=16;static CubeFaces=["+X","-X","+Y","-Y","+Z","-Z"];static defaultProps={...bo.defaultProps,data:null,dimension:"2d",format:"rgba8unorm",width:void 0,height:void 0,depth:1,mipmaps:!1,compressed:!1,usage:0,mipLevels:void 0,samples:void 0,sampler:{},view:void 0,flipY:void 0};get[Symbol.toStringTag](){return"Texture"}toString(){return`Texture(${this.id},${this.format},${this.width}x${this.height})`}dimension;format;width;height;depth;mipLevels;updateTimestamp;constructor(e,r){if(r=yo.normalizeProps(e,r),super(e,r,yo.defaultProps),this.dimension=this.props.dimension,this.format=this.props.format,this.width=this.props.width,this.height=this.props.height,this.depth=this.props.depth,this.props.width===void 0||this.props.height===void 0){const n=yo.getTextureDataSize(this.props.data);this.width=n?.width||1,this.height=n?.height||1}this.props.mipmaps&&this.props.mipLevels===void 0&&(this.props.mipLevels="pyramid"),this.mipLevels=this.props.mipLevels==="pyramid"?yo.getMipLevelCount(this.width,this.height):this.props.mipLevels||1,this.updateTimestamp=e.incrementTimestamp()}clone(e){return this.device.createTexture({...this.props,...e})}static isExternalImage(e){return typeof ImageData<"u"&&e instanceof ImageData||typeof ImageBitmap<"u"&&e instanceof ImageBitmap||typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLVideoElement<"u"&&e instanceof HTMLVideoElement||typeof VideoFrame<"u"&&e instanceof VideoFrame||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof OffscreenCanvas<"u"&&e instanceof OffscreenCanvas}static getExternalImageSize(e){if(typeof ImageData<"u"&&e instanceof ImageData||typeof ImageBitmap<"u"&&e instanceof ImageBitmap||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof OffscreenCanvas<"u"&&e instanceof OffscreenCanvas)return{width:e.width,height:e.height};if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement)return{width:e.naturalWidth,height:e.naturalHeight};if(typeof HTMLVideoElement<"u"&&e instanceof HTMLVideoElement)return{width:e.videoWidth,height:e.videoHeight};if(typeof VideoFrame<"u"&&e instanceof VideoFrame)return{width:e.displayWidth,height:e.displayHeight};throw new Error("Unknown image type")}static isTextureLevelData(e){const r=e?.data;return ArrayBuffer.isView(r)}static getTextureDataSize(e){if(!e||ArrayBuffer.isView(e))return null;if(Array.isArray(e))return yo.getTextureDataSize(e[0]);if(yo.isExternalImage(e))return yo.getExternalImageSize(e);if(e&&typeof e=="object"&&e.constructor===Object){const n=Object.values(e)[0];return{width:n.width,height:n.height}}throw new Error("texture size deduction failed")}static normalizeTextureData(e,r){let n;return ArrayBuffer.isView(e)?n=[{data:e,width:r.width,height:r.height}]:Array.isArray(e)?n=e:n=[e],n}static getMipLevelCount(e,r){return Math.floor(Math.log2(Math.max(e,r)))+1}static getCubeFaceDepth(e){switch(e){case"+X":return 0;case"-X":return 1;case"+Y":return 2;case"-Y":return 3;case"+Z":return 4;case"-Z":return 5;default:throw new Error(e)}}static defaultCopyExternalImageOptions={image:void 0,sourceX:0,sourceY:0,width:void 0,height:void 0,depth:1,mipLevel:0,x:0,y:0,z:0,aspect:"all",colorSpace:"srgb",premultipliedAlpha:!1,flipY:!1};static normalizeProps(e,r){const n={...r},i=e?.props?._resourceDefaults?.texture||{};Object.assign(n,i);const{width:a,height:s}=n;return typeof a=="number"&&(n.width=Math.max(1,Math.ceil(a))),typeof s=="number"&&(n.height=Math.max(1,Math.ceil(s))),n}}class QT extends bo{static defaultProps={...bo.defaultProps,format:void 0,dimension:void 0,aspect:"all",baseMipLevel:0,mipLevelCount:void 0,baseArrayLayer:0,arrayLayerCount:void 0};get[Symbol.toStringTag](){return"TextureView"}constructor(e,r){super(e,r,QT.defaultProps)}}function oBe(t,e,r){let n="";const i=e.split(/\r?\n/),a=t.slice().sort((s,o)=>s.lineNum-o.lineNum);switch(r?.showSourceCode||"no"){case"all":let s=0;for(let o=1;o<=i.length;o++)for(n+=vee(i[o-1],o,r);a.length>s&&a[s].lineNum===o;){const u=a[s++];n+=wq(u,i,u.lineNum,{...r,inlineSource:!1})}return n;case"issues":case"no":for(const o of t)n+=wq(o,i,o.lineNum,{inlineSource:r?.showSourceCode!=="no"});return n}}function wq(t,e,r,n){if(n?.inlineSource){const a=sBe(e,r),s=t.linePos>0?`${" ".repeat(t.linePos+5)}^^^
`:"";return`
${a}${s}${t.type.toUpperCase()}: ${t.message}

`}const i=t.type==="error"?"red":"#8B4000";return n?.html?`<div class='luma-compiler-log-error' style="color:${i};"><b> ${t.type.toUpperCase()}: ${t.message}</b></div>`:`${t.type.toUpperCase()}: ${t.message}`}function sBe(t,e,r){let n="";for(let i=e-2;i<=e;i++){const a=t[i-1];a!==void 0&&(n+=vee(a,e,r))}return n}function vee(t,e,r){const n=r?.html?uBe(t):t;return`${lBe(String(e),4)}: ${n}${r?.html?"<br/>":`
`}`}function lBe(t,e){let r="";for(let n=t.length;n<e;++n)r+=" ";return r+t}function uBe(t){return t.replaceAll("&","&amp;").replaceAll("<","&lt;").replaceAll(">","&gt;").replaceAll('"',"&quot;").replaceAll("'","&#039;")}class eC extends bo{static defaultProps={...bo.defaultProps,language:"auto",stage:void 0,source:"",sourceMap:null,entryPoint:"main",debugShaders:void 0};get[Symbol.toStringTag](){return"Shader"}stage;source;compilationStatus="pending";constructor(e,r){r={...r,debugShaders:r.debugShaders||e.props.debugShaders||"errors"},super(e,{id:cBe(r),...r},eC.defaultProps),this.stage=this.props.stage,this.source=this.props.source}getCompilationInfoSync(){return null}getTranslatedSource(){return null}async debugShader(){const e=this.props.debugShaders;switch(e){case"never":return;case"errors":if(this.compilationStatus==="success")return;break}const r=await this.getCompilationInfo();e==="warnings"&&r?.length===0||this._displayShaderLog(r)}_displayShaderLog(e){if(typeof document>"u"||!document?.createElement)return;const r=_ee(this.source),n=`${this.stage} ${r}`;let i=oBe(e,this.source,{showSourceCode:"all",html:!0});const a=this.getTranslatedSource();a&&(i+=`<br /><br /><h1>Translated Source</h1><br /><br /><code style="user-select:text;"><pre>${a}</pre></code>`);const s=document.createElement("Button");s.innerHTML=`
<h1>Shader Compilation Error in ${n}</h1><br /><br />
<code style="user-select:text;"><pre>
${i}
</pre></code>`,s.style.top="10px",s.style.left="10px",s.style.position="absolute",s.style.zIndex="9999",s.style.width="100%",s.style.textAlign="left",document.body.appendChild(s),document.getElementsByClassName("luma-compiler-log-error")[0]?.scrollIntoView(),s.onclick=()=>{const u=`data:text/plain,${encodeURIComponent(this.source)}`;navigator.clipboard.writeText(u)}}}function cBe(t){return _ee(t.source)||t.id||JT(`unnamed ${t.stage}-shader`)}function _ee(t,e="unnamed"){const n=/#define[\s*]SHADER_NAME[\s*]([A-Za-z0-9_-]+)[\s*]/.exec(t);return n?n[1]:e}class Tb extends bo{static defaultProps={...bo.defaultProps,type:"color-sampler",addressModeU:"clamp-to-edge",addressModeV:"clamp-to-edge",addressModeW:"clamp-to-edge",magFilter:"nearest",minFilter:"nearest",mipmapFilter:"none",lodMinClamp:0,lodMaxClamp:32,compare:"less-equal",maxAnisotropy:1};get[Symbol.toStringTag](){return"Sampler"}constructor(e,r){r=Tb.normalizeProps(e,r),super(e,r,Tb.defaultProps)}static normalizeProps(e,r){const n=e?.props?._resourceDefaults?.sampler||{};return{...r,...n}}}class tC extends bo{static defaultProps={...bo.defaultProps,width:1,height:1,colorAttachments:[],depthStencilAttachment:null};get[Symbol.toStringTag](){return"Framebuffer"}width;height;constructor(e,r={}){super(e,r,tC.defaultProps),this.width=this.props.width,this.height=this.props.height}clone(e){const r=this.colorAttachments.map(i=>i.texture.clone(e)),n=this.depthStencilAttachment&&this.depthStencilAttachment.texture.clone(e);return this.device.createFramebuffer({...this.props,colorAttachments:r,depthStencilAttachment:n})}resize(e){let r=!e;if(e){const[n,i]=Array.isArray(e)?e:[e.width,e.height];r=r||i!==this.height||n!==this.width,this.width=n,this.height=i}r&&(dn.log(2,`Resizing framebuffer ${this.id} to ${this.width}x${this.height}`)(),this.resizeAttachments(this.width,this.height))}autoCreateAttachmentTextures(){if(this.props.colorAttachments.length===0&&!this.props.depthStencilAttachment)throw new Error("Framebuffer has noattachments");this.colorAttachments=this.props.colorAttachments.map((r,n)=>{if(typeof r=="string"){const i=this.createColorTexture(r,n);return this.attachResource(i),i.view}return r instanceof yo?r.view:r});const e=this.props.depthStencilAttachment;if(e)if(typeof e=="string"){const r=this.createDepthStencilTexture(e);this.attachResource(r),this.depthStencilAttachment=r.view}else e instanceof yo?this.depthStencilAttachment=e.view:this.depthStencilAttachment=e}createColorTexture(e,r){return this.device.createTexture({id:`${this.id}-color-attachment-${r}`,usage:yo.RENDER_ATTACHMENT,format:e,width:this.width,height:this.height,sampler:{magFilter:"linear",minFilter:"linear"}})}createDepthStencilTexture(e){return this.device.createTexture({id:`${this.id}-depth-stencil-attachment`,usage:yo.RENDER_ATTACHMENT,format:e,width:this.width,height:this.height,mipmaps:!1})}resizeAttachments(e,r){for(let n=0;n<this.colorAttachments.length;++n)if(this.colorAttachments[n]){const i=this.colorAttachments[n].texture.clone({width:e,height:r});this.destroyAttachedResource(this.colorAttachments[n]),this.colorAttachments[n]=i.view,this.attachResource(i.view)}if(this.depthStencilAttachment){const n=this.depthStencilAttachment.texture.clone({width:e,height:r});this.destroyAttachedResource(this.depthStencilAttachment),this.depthStencilAttachment=n.view,this.attachResource(n)}this.updateAttachments()}}class _0 extends bo{static defaultProps={...bo.defaultProps,vs:null,vertexEntryPoint:"vertexMain",vsConstants:{},fs:null,fragmentEntryPoint:"fragmentMain",fsConstants:{},shaderLayout:null,bufferLayout:[],topology:"triangle-list",parameters:{},bindings:{},uniforms:{}};get[Symbol.toStringTag](){return"RenderPipeline"}shaderLayout;bufferLayout;linkStatus="pending";hash="";constructor(e,r){super(e,r,_0.defaultProps),this.shaderLayout=this.props.shaderLayout,this.bufferLayout=this.props.bufferLayout||[]}setUniformsWebGL(e){throw new Error("Use uniform blocks")}}class Xg extends bo{static defaultClearColor=[0,0,0,1];static defaultClearDepth=1;static defaultClearStencil=0;static defaultProps={...bo.defaultProps,framebuffer:null,parameters:void 0,clearColor:Xg.defaultClearColor,clearColors:void 0,clearDepth:Xg.defaultClearDepth,clearStencil:Xg.defaultClearStencil,depthReadOnly:!1,stencilReadOnly:!1,discard:!1,occlusionQuerySet:void 0,timestampQuerySet:void 0,beginTimestampIndex:void 0,endTimestampIndex:void 0};get[Symbol.toStringTag](){return"RenderPass"}constructor(e,r){r=Xg.normalizeProps(e,r),super(e,r,Xg.defaultProps)}static normalizeProps(e,r){return{...e.props._resourceDefaults?.renderPass,...r}}}class hE extends bo{static defaultProps={...bo.defaultProps,shader:void 0,entryPoint:void 0,constants:{},shaderLayout:void 0};get[Symbol.toStringTag](){return"ComputePipeline"}hash="";shaderLayout;constructor(e,r){super(e,r,hE.defaultProps),this.shaderLayout=r.shaderLayout}}class RN extends bo{static defaultProps={...bo.defaultProps,measureExecutionTime:void 0};get[Symbol.toStringTag](){return"CommandEncoder"}constructor(e,r){super(e,r,RN.defaultProps)}}class ON extends bo{static defaultProps={...bo.defaultProps};get[Symbol.toStringTag](){return"CommandBuffer"}constructor(e,r){super(e,r,ON.defaultProps)}}function hBe(t){const[e,r]=dBe[t],n=e==="i32"||e==="u32",i=e!=="u32",a=pBe[e]*r,s=fBe(e,r);return{dataType:e,components:r,defaultVertexFormat:s,byteLength:a,integer:n,signed:i}}function fBe(t,e){let r;switch(t){case"f32":r="float32";break;case"i32":r="sint32";break;case"u32":r="uint32";break;case"f16":return e<=2?"float16x2":"float16x4"}return e===1?r:`${r}x${e}`}const dBe={f32:["f32",1],"vec2<f32>":["f32",2],"vec3<f32>":["f32",3],"vec4<f32>":["f32",4],f16:["f16",1],"vec2<f16>":["f16",2],"vec3<f16>":["f16",3],"vec4<f16>":["f16",4],i32:["i32",1],"vec2<i32>":["i32",2],"vec3<i32>":["i32",3],"vec4<i32>":["i32",4],u32:["u32",1],"vec2<u32>":["u32",2],"vec3<u32>":["u32",3],"vec4<u32>":["u32",4]},pBe={f32:4,f16:2,i32:4,u32:4};function bee(t){let e;t.endsWith("-webgl")&&(t.replace("-webgl",""),e=!0);const[r,n]=t.split("x"),i=r,a=n?parseInt(n):1,s=gee(i),o={type:i,components:a,byteLength:s.byteLength*a,integer:s.integer,signed:s.signed,normalized:s.normalized};return e&&(o.webglOnly=!0),o}function xee(t,e){const r={};for(const n of t.attributes){const i=mBe(t,e,n.name);i&&(r[n.name]=i)}return r}function gBe(t,e,r=16){const n=xee(t,e),i=new Array(r).fill(null);for(const a of Object.values(n))i[a.location]=a;return i}function mBe(t,e,r){const n=yBe(t,r),i=vBe(e,r);if(!n)return null;const a=hBe(n.type),s=i?.vertexFormat||a.defaultVertexFormat,o=bee(s);return{attributeName:i?.attributeName||n.name,bufferName:i?.bufferName||n.name,location:n.location,shaderType:n.type,shaderDataType:a.dataType,shaderComponents:a.components,vertexFormat:s,bufferDataType:o.type,bufferComponents:o.components,normalized:o.normalized,integer:a.integer,stepMode:i?.stepMode||n.stepMode||"vertex",byteOffset:i?.byteOffset||0,byteStride:i?.byteStride||0}}function yBe(t,e){const r=t.attributes.find(n=>n.name===e);return r||dn.warn(`shader layout attribute "${e}" not present in shader`),r||null}function vBe(t,e){_Be(t);let r=bBe(t,e);return r||(r=xBe(t,e),r)?r:(dn.warn(`layout for attribute "${e}" not present in buffer layout`),null)}function _Be(t){for(const e of t)(e.attributes&&e.format||!e.attributes&&!e.format)&&dn.warn(`BufferLayout ${name} must have either 'attributes' or 'format' field`)}function bBe(t,e){for(const r of t)if(r.format&&r.name===e)return{attributeName:r.name,bufferName:e,stepMode:r.stepMode,vertexFormat:r.format,byteOffset:0,byteStride:r.byteStride||0};return null}function xBe(t,e){for(const r of t){let n=r.byteStride;if(typeof r.byteStride!="number")for(const a of r.attributes||[]){const s=bee(a.format);n+=s.byteLength}const i=r.attributes?.find(a=>a.attribute===e);if(i)return{attributeName:i.attribute,bufferName:r.name,stepMode:r.stepMode,vertexFormat:i.format,byteOffset:i.byteOffset,byteStride:n}}return null}class LN extends bo{static defaultProps={...bo.defaultProps,renderPipeline:null};get[Symbol.toStringTag](){return"VertexArray"}maxVertexAttributes;attributeInfos;indexBuffer=null;attributes;constructor(e,r){super(e,r,LN.defaultProps),this.maxVertexAttributes=e.limits.maxVertexAttributes,this.attributes=new Array(this.maxVertexAttributes).fill(null);const{shaderLayout:n,bufferLayout:i}=r.renderPipeline||{};if(!n||!i)throw new Error("VertexArray");this.attributeInfos=gBe(n,i,this.maxVertexAttributes)}setConstantWebGL(e,r){this.device.reportError(new Error("constant attributes not supported"))}}class NN extends bo{static defaultProps={...bo.defaultProps,layout:void 0,buffers:{}};get[Symbol.toStringTag](){return"TransformFeedback"}constructor(e,r){super(e,r,NN.defaultProps)}}class DN extends bo{static defaultProps={...bo.defaultProps,type:void 0,count:void 0};get[Symbol.toStringTag](){return"QuerySet"}constructor(e,r){super(e,r,DN.defaultProps)}}const wBe={f32:{type:"f32",components:1},i32:{type:"i32",components:1},u32:{type:"u32",components:1},"vec2<f32>":{type:"f32",components:2},"vec3<f32>":{type:"f32",components:3},"vec4<f32>":{type:"f32",components:4},"vec2<i32>":{type:"i32",components:2},"vec3<i32>":{type:"i32",components:3},"vec4<i32>":{type:"i32",components:4},"vec2<u32>":{type:"u32",components:2},"vec3<u32>":{type:"u32",components:3},"vec4<u32>":{type:"u32",components:4},"mat2x2<f32>":{type:"f32",components:4},"mat2x3<f32>":{type:"f32",components:6},"mat2x4<f32>":{type:"f32",components:8},"mat3x2<f32>":{type:"f32",components:6},"mat3x3<f32>":{type:"f32",components:9},"mat3x4<f32>":{type:"f32",components:12},"mat4x2<f32>":{type:"f32",components:8},"mat4x3<f32>":{type:"f32",components:12},"mat4x4<f32>":{type:"f32",components:16}};function SBe(t){return wBe[t]}function EBe(t,e){switch(e){case 1:return t;case 2:return t+t%2;default:return t+(4-t%4)%4}}let G2;function wee(t){return(!G2||G2.byteLength<t)&&(G2=new ArrayBuffer(t)),G2}function TBe(t,e){const r=wee(t.BYTES_PER_ELEMENT*e);return new t(r,0,e)}function CBe(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function fE(t){return Array.isArray(t)?t.length===0||typeof t[0]=="number":CBe(t)}const Sq=1024;class ABe{layout={};byteLength;constructor(e){let r=0;for(const[i,a]of Object.entries(e)){const s=SBe(a),{type:o,components:u}=s;r=EBe(r,u);const h=r;r+=u,this.layout[i]={type:o,size:u,offset:h}}r+=(4-r%4)%4;const n=r*4;this.byteLength=Math.max(n,Sq)}getData(e){const r=Math.max(this.byteLength,Sq),n=wee(r),i={i32:new Int32Array(n),u32:new Uint32Array(n),f32:new Float32Array(n),f16:new Uint16Array(n)};for(const[a,s]of Object.entries(e)){const o=this.layout[a];if(!o){dn.warn(`Supplied uniform value ${a} not present in uniform block layout`)();continue}const{type:u,size:h,offset:f}=o,g=i[u];if(h===1){if(typeof s!="number"&&typeof s!="boolean"){dn.warn(`Supplied value for single component uniform ${a} is not a number: ${s}`)();continue}g[f]=Number(s)}else{if(!fE(s)){dn.warn(`Supplied value for multi component / array uniform ${a} is not a numeric array: ${s}`)();continue}g.set(s,f)}}return new Uint8Array(n)}has(e){return!!this.layout[e]}get(e){return this.layout[e]}}function IBe(t,e,r=16){if(t!==e)return!1;const n=t,i=e;if(!fE(n))return!1;if(fE(i)&&n.length===i.length){for(let a=0;a<n.length;++a)if(i[a]!==n[a])return!1}return!0}function PBe(t){return fE(t)?t.slice():t}class kBe{name;uniforms={};modifiedUniforms={};modified=!0;bindingLayout={};needsRedraw="initialized";constructor(e){if(this.name=e?.name||"unnamed",e?.name&&e?.shaderLayout){const r=e?.shaderLayout.bindings?.find(i=>i.type==="uniform"&&i.name===e?.name);if(!r)throw new Error(e?.name);const n=r;for(const i of n.uniforms||[])this.bindingLayout[i.name]=i}}setUniforms(e){for(const[r,n]of Object.entries(e))this._setUniform(r,n),this.needsRedraw||this.setNeedsRedraw(`${this.name}.${r}=${n}`)}setNeedsRedraw(e){this.needsRedraw=this.needsRedraw||e}getAllUniforms(){return this.modifiedUniforms={},this.needsRedraw=!1,this.uniforms||{}}_setUniform(e,r){IBe(this.uniforms[e],r)||(this.uniforms[e]=PBe(r),this.modifiedUniforms[e]=!0,this.modified=!0)}}class MBe{uniformBlocks=new Map;uniformBufferLayouts=new Map;uniformBuffers=new Map;constructor(e){for(const[r,n]of Object.entries(e)){const i=r,a=new ABe(n.uniformTypes||{});this.uniformBufferLayouts.set(i,a);const s=new kBe({name:r});s.setUniforms(n.defaultUniforms||{}),this.uniformBlocks.set(i,s)}}destroy(){for(const e of this.uniformBuffers.values())e.destroy()}setUniforms(e){for(const[r,n]of Object.entries(e))this.uniformBlocks.get(r)?.setUniforms(n);this.updateUniformBuffers()}getUniformBufferByteLength(e){return this.uniformBufferLayouts.get(e)?.byteLength||0}getUniformBufferData(e){const r=this.uniformBlocks.get(e)?.getAllUniforms()||{};return this.uniformBufferLayouts.get(e)?.getData(r)}createUniformBuffer(e,r,n){n&&this.setUniforms(n);const i=this.getUniformBufferByteLength(r),a=e.createBuffer({usage:Oo.UNIFORM|Oo.COPY_DST,byteLength:i}),s=this.getUniformBufferData(r);return a.write(s),a}getManagedUniformBuffer(e,r){if(!this.uniformBuffers.get(r)){const n=this.getUniformBufferByteLength(r),i=e.createBuffer({usage:Oo.UNIFORM|Oo.COPY_DST,byteLength:n});this.uniformBuffers.set(r,i)}return this.uniformBuffers.get(r)}updateUniformBuffers(){let e=!1;for(const r of this.uniformBlocks.keys()){const n=this.updateUniformBuffer(r);e||=n}return e&&dn.log(3,`UniformStore.updateUniformBuffers(): ${e}`)(),e}updateUniformBuffer(e){const r=this.uniformBlocks.get(e);let n=this.uniformBuffers.get(e),i=!1;if(n&&r?.needsRedraw){i||=r.needsRedraw;const a=this.getUniformBufferData(e);n=this.uniformBuffers.get(e),n?.write(a);const s=this.uniformBlocks.get(e)?.getAllUniforms();dn.log(4,`Writing to uniform buffer ${String(e)}`,a,s)()}return i}}function See(t){const e=ArrayBuffer.isView(t)?t.constructor:t;switch(e){case Float32Array:return"float32";case Uint16Array:return"uint16";case Uint32Array:return"uint32";case Uint8Array:case Uint8ClampedArray:return"uint8";case Int8Array:return"sint8";case Int16Array:return"sint16";case Int32Array:return"sint32";default:throw new Error(e.constructor.name)}}function Eee(t){switch(t){case"float32":return Float32Array;case"uint32":return Uint32Array;case"sint32":return Int32Array;case"uint16":case"unorm16":return Uint16Array;case"sint16":case"snorm16":return Int16Array;case"uint8":case"unorm8":return Uint8Array;case"sint8":case"snorm8":return Int8Array;default:throw new Error(t)}}function RBe(t,e,r){if(!e||e>4)throw new Error(`size ${e}`);const n=e;let i=See(t);if(i==="uint8"&&r&&n===1)return"unorm8-webgl";if(i==="uint8"&&r&&n===3)return"unorm8x3-webgl";if(i==="uint8"||i==="sint8"){if(n===1||n===3)throw new Error(`size: ${e}`);return r&&(i=i.replace("int","norm")),`${i}x${n}`}if(i==="uint16"||i==="sint16"){if(n===1||n===3)throw new Error(`size: ${e}`);return r&&(i=i.replace("int","norm")),`${i}x${n}`}return n===1?i:`${i}x${n}`}class DI{bufferLayouts;constructor(e){this.bufferLayouts=e}getBufferLayout(e){return this.bufferLayouts.find(r=>r.name===e)||null}getAttributeNamesForBuffer(e){return e.attributes?e.attributes?.map(r=>r.attribute):[e.name]}mergeBufferLayouts(e,r){const n=[...e];for(const i of r){const a=n.findIndex(s=>s.name===i.name);a<0?n.push(i):n[a]=i}return n}getBufferIndex(e){const r=this.bufferLayouts.findIndex(n=>n.name===e);return r===-1&&dn.warn(`BufferLayout: Missing buffer for "${e}".`)(),r}}function OBe(t,e){const r=Object.fromEntries(t.attributes.map(i=>[i.name,i.location])),n=e.slice();return n.sort((i,a)=>{const s=i.attributes?i.attributes.map(f=>f.attribute):[i.name],o=a.attributes?a.attributes.map(f=>f.attribute):[a.name],u=Math.min(...s.map(f=>r[f])),h=Math.min(...o.map(f=>r[f]));return u-h}),n}class wh{constructor(e,r){this.name=e,this.attributes=r,this.size=0}get isArray(){return!1}get isStruct(){return!1}get isTemplate(){return!1}get isPointer(){return!1}getTypeName(){return this.name}}class Eq{constructor(e,r,n){this.name=e,this.type=r,this.attributes=n,this.offset=0,this.size=0}get isArray(){return this.type.isArray}get isStruct(){return this.type.isStruct}get isTemplate(){return this.type.isTemplate}get align(){return this.type.isStruct?this.type.align:0}get members(){return this.type.isStruct?this.type.members:null}get format(){return this.type.isArray||this.type.isTemplate?this.type.format:null}get count(){return this.type.isArray?this.type.count:0}get stride(){return this.type.isArray?this.type.stride:this.size}}class zp extends wh{constructor(e,r){super(e,r),this.members=[],this.align=0,this.startLine=-1,this.endLine=-1,this.inUse=!1}get isStruct(){return!0}}class Gp extends wh{constructor(e,r){super(e,r),this.count=0,this.stride=0}get isArray(){return!0}getTypeName(){return`array<${this.format.getTypeName()}, ${this.count}>`}}class HM extends wh{constructor(e,r,n){super(e,n),this.format=r}get isPointer(){return!0}getTypeName(){return`&${this.format.getTypeName()}`}}class Mm extends wh{constructor(e,r,n,i){super(e,n),this.format=r,this.access=i}get isTemplate(){return!0}getTypeName(){let e=this.name;if(this.format!==null){if(e==="vec2"||e==="vec3"||e==="vec4"||e==="mat2x2"||e==="mat2x3"||e==="mat2x4"||e==="mat3x2"||e==="mat3x3"||e==="mat3x4"||e==="mat4x2"||e==="mat4x3"||e==="mat4x4"){if(this.format.name==="f32")return e+="f",e;if(this.format.name==="i32")return e+="i",e;if(this.format.name==="u32")return e+="u",e;if(this.format.name==="bool")return e+="b",e;if(this.format.name==="f16")return e+="h",e}e+=`<${this.format.name}>`}else if(e==="vec2"||e==="vec3"||e==="vec4")return e;return e}}var Mp;(t=>{t[t.Uniform=0]="Uniform",t[t.Storage=1]="Storage",t[t.Texture=2]="Texture",t[t.Sampler=3]="Sampler",t[t.StorageTexture=4]="StorageTexture"})(Mp||(Mp={}));class X2{constructor(e,r,n,i,a,s,o){this.name=e,this.type=r,this.group=n,this.binding=i,this.attributes=a,this.resourceType=s,this.access=o}get isArray(){return this.type.isArray}get isStruct(){return this.type.isStruct}get isTemplate(){return this.type.isTemplate}get size(){return this.type.size}get align(){return this.type.isStruct?this.type.align:0}get members(){return this.type.isStruct?this.type.members:null}get format(){return this.type.isArray||this.type.isTemplate?this.type.format:null}get count(){return this.type.isArray?this.type.count:0}get stride(){return this.type.isArray?this.type.stride:this.size}}class LBe{constructor(e,r){this.name=e,this.type=r}}class NBe{constructor(e,r,n,i){this.name=e,this.type=r,this.locationType=n,this.location=i,this.interpolation=null}}class Tq{constructor(e,r,n,i){this.name=e,this.type=r,this.locationType=n,this.location=i}}class DBe{constructor(e,r,n,i){this.name=e,this.type=r,this.attributes=n,this.id=i}}class FBe{constructor(e,r,n){this.name=e,this.type=r,this.attributes=n}}class BBe{constructor(e,r=null,n){this.stage=null,this.inputs=[],this.outputs=[],this.arguments=[],this.returnType=null,this.resources=[],this.overrides=[],this.startLine=-1,this.endLine=-1,this.inUse=!1,this.calls=new Set,this.name=e,this.stage=r,this.attributes=n}}class zBe{constructor(){this.vertex=[],this.fragment=[],this.compute=[]}}function jBe(t){var e=(32768&t)>>15,r=(31744&t)>>10,n=1023&t;return r==0?(e?-1:1)*Math.pow(2,-14)*(n/Math.pow(2,10)):r==31?n?NaN:1/0*(e?-1:1):(e?-1:1)*Math.pow(2,r-15)*(1+n/Math.pow(2,10))}const Tee=new Float32Array(1),UBe=new Int32Array(Tee.buffer),Fu=new Uint16Array(1);function VBe(t){Tee[0]=t;const e=UBe[0],r=e>>31&1;let n=e>>23&255,i=8388607&e;if(n===255)return Fu[0]=r<<15|31744|(i!==0?512:0),Fu[0];if(n===0){if(i===0)return Fu[0]=r<<15,Fu[0];i|=8388608;let a=113;for(;!(8388608&i);)i<<=1,a--;return n=127-a,i&=8388607,n>0?(i=(i>>126-n)+(i>>127-n&1),Fu[0]=r<<15|n<<10|i>>13,Fu[0]):(Fu[0]=r<<15,Fu[0])}return n=n-127+15,n>=31?(Fu[0]=r<<15|31744,Fu[0]):n<=0?n<-10?(Fu[0]=r<<15,Fu[0]):(i=(8388608|i)>>1-n,Fu[0]=r<<15|i>>13,Fu[0]):(i>>=13,Fu[0]=r<<15|n<<10|i,Fu[0])}const FN=new Uint32Array(1),Cee=new Float32Array(FN.buffer,0,1);function Cq(t){const e=112+(t>>6&31)<<23|(63&t)<<17;return FN[0]=e,Cee[0]}function $Be(t,e,r,n,i,a,s,o,u){const h=n*(s>>=i)*(a>>=i)+r*s+e*o;switch(u){case"r8unorm":return[ja(t,h,"8unorm",1)[0]];case"r8snorm":return[ja(t,h,"8snorm",1)[0]];case"r8uint":return[ja(t,h,"8uint",1)[0]];case"r8sint":return[ja(t,h,"8sint",1)[0]];case"rg8unorm":{const f=ja(t,h,"8unorm",2);return[f[0],f[1]]}case"rg8snorm":{const f=ja(t,h,"8snorm",2);return[f[0],f[1]]}case"rg8uint":{const f=ja(t,h,"8uint",2);return[f[0],f[1]]}case"rg8sint":{const f=ja(t,h,"8sint",2);return[f[0],f[1]]}case"rgba8unorm-srgb":case"rgba8unorm":{const f=ja(t,h,"8unorm",4);return[f[0],f[1],f[2],f[3]]}case"rgba8snorm":{const f=ja(t,h,"8snorm",4);return[f[0],f[1],f[2],f[3]]}case"rgba8uint":{const f=ja(t,h,"8uint",4);return[f[0],f[1],f[2],f[3]]}case"rgba8sint":{const f=ja(t,h,"8sint",4);return[f[0],f[1],f[2],f[3]]}case"bgra8unorm-srgb":case"bgra8unorm":{const f=ja(t,h,"8unorm",4);return[f[2],f[1],f[0],f[3]]}case"r16uint":return[ja(t,h,"16uint",1)[0]];case"r16sint":return[ja(t,h,"16sint",1)[0]];case"r16float":return[ja(t,h,"16float",1)[0]];case"rg16uint":{const f=ja(t,h,"16uint",2);return[f[0],f[1]]}case"rg16sint":{const f=ja(t,h,"16sint",2);return[f[0],f[1]]}case"rg16float":{const f=ja(t,h,"16float",2);return[f[0],f[1]]}case"rgba16uint":{const f=ja(t,h,"16uint",4);return[f[0],f[1],f[2],f[3]]}case"rgba16sint":{const f=ja(t,h,"16sint",4);return[f[0],f[1],f[2],f[3]]}case"rgba16float":{const f=ja(t,h,"16float",4);return[f[0],f[1],f[2],f[3]]}case"r32uint":return[ja(t,h,"32uint",1)[0]];case"r32sint":return[ja(t,h,"32sint",1)[0]];case"depth16unorm":case"depth24plus":case"depth24plus-stencil8":case"depth32float":case"depth32float-stencil8":case"r32float":return[ja(t,h,"32float",1)[0]];case"rg32uint":{const f=ja(t,h,"32uint",2);return[f[0],f[1]]}case"rg32sint":{const f=ja(t,h,"32sint",2);return[f[0],f[1]]}case"rg32float":{const f=ja(t,h,"32float",2);return[f[0],f[1]]}case"rgba32uint":{const f=ja(t,h,"32uint",4);return[f[0],f[1],f[2],f[3]]}case"rgba32sint":{const f=ja(t,h,"32sint",4);return[f[0],f[1],f[2],f[3]]}case"rgba32float":{const f=ja(t,h,"32float",4);return[f[0],f[1],f[2],f[3]]}case"rg11b10ufloat":{const f=new Uint32Array(t.buffer,h,1)[0],g=(4192256&f)>>11,b=(4290772992&f)>>22;return[Cq(2047&f),Cq(g),(function(v){const S=112+(v>>5&31)<<23|(31&v)<<18;return FN[0]=S,Cee[0]})(b),1]}}return null}function ja(t,e,r,n){const i=[0,0,0,0];for(let a=0;a<n;++a)switch(r){case"8unorm":i[a]=t[e]/255,e++;break;case"8snorm":i[a]=t[e]/255*2-1,e++;break;case"8uint":i[a]=t[e],e++;break;case"8sint":i[a]=t[e]-127,e++;break;case"16uint":i[a]=t[e]|t[e+1]<<8,e+=2;break;case"16sint":i[a]=(t[e]|t[e+1]<<8)-32768,e+=2;break;case"16float":i[a]=jBe(t[e]|t[e+1]<<8),e+=2;break;case"32uint":case"32sint":i[a]=t[e]|t[e+1]<<8|t[e+2]<<16|t[e+3]<<24,e+=4;break;case"32float":i[a]=new Float32Array(t.buffer,e,1)[0],e+=4}return i}function Ya(t,e,r,n,i){for(let a=0;a<n;++a)switch(r){case"8unorm":t[e]=255*i[a],e++;break;case"8snorm":t[e]=.5*(i[a]+1)*255,e++;break;case"8uint":t[e]=i[a],e++;break;case"8sint":t[e]=i[a]+127,e++;break;case"16uint":new Uint16Array(t.buffer,e,1)[0]=i[a],e+=2;break;case"16sint":new Int16Array(t.buffer,e,1)[0]=i[a],e+=2;break;case"16float":{const s=VBe(i[a]);new Uint16Array(t.buffer,e,1)[0]=s,e+=2;break}case"32uint":new Uint32Array(t.buffer,e,1)[0]=i[a],e+=4;break;case"32sint":new Int32Array(t.buffer,e,1)[0]=i[a],e+=4;break;case"32float":new Float32Array(t.buffer,e,1)[0]=i[a],e+=4}return i}const FI={r8unorm:{bytesPerBlock:1,blockWidth:1,blockHeight:1,isCompressed:!1,channels:1},r8snorm:{bytesPerBlock:1,blockWidth:1,blockHeight:1,isCompressed:!1,channels:1},r8uint:{bytesPerBlock:1,blockWidth:1,blockHeight:1,isCompressed:!1,channels:1},r8sint:{bytesPerBlock:1,blockWidth:1,blockHeight:1,isCompressed:!1,channels:1},rg8unorm:{bytesPerBlock:2,blockWidth:1,blockHeight:1,isCompressed:!1,channels:2},rg8snorm:{bytesPerBlock:2,blockWidth:1,blockHeight:1,isCompressed:!1,channels:2},rg8uint:{bytesPerBlock:2,blockWidth:1,blockHeight:1,isCompressed:!1,channels:2},rg8sint:{bytesPerBlock:2,blockWidth:1,blockHeight:1,isCompressed:!1,channels:2},rgba8unorm:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},"rgba8unorm-srgb":{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},rgba8snorm:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},rgba8uint:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},rgba8sint:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},bgra8unorm:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},"bgra8unorm-srgb":{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},r16uint:{bytesPerBlock:2,blockWidth:1,blockHeight:1,isCompressed:!1,channels:1},r16sint:{bytesPerBlock:2,blockWidth:1,blockHeight:1,isCompressed:!1,channels:1},r16float:{bytesPerBlock:2,blockWidth:1,blockHeight:1,isCompressed:!1,channels:1},rg16uint:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:2},rg16sint:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:2},rg16float:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:2},rgba16uint:{bytesPerBlock:8,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},rgba16sint:{bytesPerBlock:8,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},rgba16float:{bytesPerBlock:8,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},r32uint:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:1},r32sint:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:1},r32float:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:1},rg32uint:{bytesPerBlock:8,blockWidth:1,blockHeight:1,isCompressed:!1,channels:2},rg32sint:{bytesPerBlock:8,blockWidth:1,blockHeight:1,isCompressed:!1,channels:2},rg32float:{bytesPerBlock:8,blockWidth:1,blockHeight:1,isCompressed:!1,channels:2},rgba32uint:{bytesPerBlock:16,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},rgba32sint:{bytesPerBlock:16,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},rgba32float:{bytesPerBlock:16,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},rgb10a2uint:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},rgb10a2unorm:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},rg11b10ufloat:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},stencil8:{bytesPerBlock:1,blockWidth:1,blockHeight:1,isCompressed:!1,isDepthStencil:!0,hasDepth:!1,hasStencil:!0,channels:1},depth16unorm:{bytesPerBlock:2,blockWidth:1,blockHeight:1,isCompressed:!1,isDepthStencil:!0,hasDepth:!0,hasStencil:!1,channels:1},depth24plus:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,isDepthStencil:!0,hasDepth:!0,hasStencil:!1,depthOnlyFormat:"depth32float",channels:1},"depth24plus-stencil8":{bytesPerBlock:8,blockWidth:1,blockHeight:1,isCompressed:!1,isDepthStencil:!0,hasDepth:!0,hasStencil:!0,depthOnlyFormat:"depth32float",channels:1},depth32float:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,isDepthStencil:!0,hasDepth:!0,hasStencil:!1,channels:1},"depth32float-stencil8":{bytesPerBlock:8,blockWidth:1,blockHeight:1,isCompressed:!1,isDepthStencil:!0,hasDepth:!0,hasStencil:!0,stencilOnlyFormat:"depth32float",channels:1},rgb9e5ufloat:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},"bc1-rgba-unorm":{bytesPerBlock:8,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"bc1-rgba-unorm-srgb":{bytesPerBlock:8,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"bc2-rgba-unorm":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"bc2-rgba-unorm-srgb":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"bc3-rgba-unorm":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"bc3-rgba-unorm-srgb":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"bc4-r-unorm":{bytesPerBlock:8,blockWidth:4,blockHeight:4,isCompressed:!0,channels:1},"bc4-r-snorm":{bytesPerBlock:8,blockWidth:4,blockHeight:4,isCompressed:!0,channels:1},"bc5-rg-unorm":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:2},"bc5-rg-snorm":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:2},"bc6h-rgb-ufloat":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"bc6h-rgb-float":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"bc7-rgba-unorm":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"bc7-rgba-unorm-srgb":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"etc2-rgb8unorm":{bytesPerBlock:8,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"etc2-rgb8unorm-srgb":{bytesPerBlock:8,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"etc2-rgb8a1unorm":{bytesPerBlock:8,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"etc2-rgb8a1unorm-srgb":{bytesPerBlock:8,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"etc2-rgba8unorm":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"etc2-rgba8unorm-srgb":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"eac-r11unorm":{bytesPerBlock:8,blockWidth:1,blockHeight:1,isCompressed:!0,channels:1},"eac-r11snorm":{bytesPerBlock:8,blockWidth:1,blockHeight:1,isCompressed:!0,channels:1},"eac-rg11unorm":{bytesPerBlock:16,blockWidth:1,blockHeight:1,isCompressed:!0,channels:2},"eac-rg11snorm":{bytesPerBlock:16,blockWidth:1,blockHeight:1,isCompressed:!0,channels:2},"astc-4x4-unorm":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"astc-4x4-unorm-srgb":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"astc-5x4-unorm":{bytesPerBlock:16,blockWidth:5,blockHeight:4,isCompressed:!0,channels:4},"astc-5x4-unorm-srgb":{bytesPerBlock:16,blockWidth:5,blockHeight:4,isCompressed:!0,channels:4},"astc-5x5-unorm":{bytesPerBlock:16,blockWidth:5,blockHeight:5,isCompressed:!0,channels:4},"astc-5x5-unorm-srgb":{bytesPerBlock:16,blockWidth:5,blockHeight:5,isCompressed:!0,channels:4},"astc-6x5-unorm":{bytesPerBlock:16,blockWidth:6,blockHeight:5,isCompressed:!0,channels:4},"astc-6x5-unorm-srgb":{bytesPerBlock:16,blockWidth:6,blockHeight:5,isCompressed:!0,channels:4},"astc-6x6-unorm":{bytesPerBlock:16,blockWidth:6,blockHeight:6,isCompressed:!0,channels:4},"astc-6x6-unorm-srgb":{bytesPerBlock:16,blockWidth:6,blockHeight:6,isCompressed:!0,channels:4},"astc-8x5-unorm":{bytesPerBlock:16,blockWidth:8,blockHeight:5,isCompressed:!0,channels:4},"astc-8x5-unorm-srgb":{bytesPerBlock:16,blockWidth:8,blockHeight:5,isCompressed:!0,channels:4},"astc-8x6-unorm":{bytesPerBlock:16,blockWidth:8,blockHeight:6,isCompressed:!0,channels:4},"astc-8x6-unorm-srgb":{bytesPerBlock:16,blockWidth:8,blockHeight:6,isCompressed:!0,channels:4},"astc-8x8-unorm":{bytesPerBlock:16,blockWidth:8,blockHeight:8,isCompressed:!0,channels:4},"astc-8x8-unorm-srgb":{bytesPerBlock:16,blockWidth:8,blockHeight:8,isCompressed:!0,channels:4},"astc-10x5-unorm":{bytesPerBlock:16,blockWidth:10,blockHeight:5,isCompressed:!0,channels:4},"astc-10x5-unorm-srgb":{bytesPerBlock:16,blockWidth:10,blockHeight:5,isCompressed:!0,channels:4},"astc-10x6-unorm":{bytesPerBlock:16,blockWidth:10,blockHeight:6,isCompressed:!0,channels:4},"astc-10x6-unorm-srgb":{bytesPerBlock:16,blockWidth:10,blockHeight:6,isCompressed:!0,channels:4},"astc-10x8-unorm":{bytesPerBlock:16,blockWidth:10,blockHeight:8,isCompressed:!0,channels:4},"astc-10x8-unorm-srgb":{bytesPerBlock:16,blockWidth:10,blockHeight:8,isCompressed:!0,channels:4},"astc-10x10-unorm":{bytesPerBlock:16,blockWidth:10,blockHeight:10,isCompressed:!0,channels:4},"astc-10x10-unorm-srgb":{bytesPerBlock:16,blockWidth:10,blockHeight:10,isCompressed:!0,channels:4},"astc-12x10-unorm":{bytesPerBlock:16,blockWidth:12,blockHeight:10,isCompressed:!0,channels:4},"astc-12x10-unorm-srgb":{bytesPerBlock:16,blockWidth:12,blockHeight:10,isCompressed:!0,channels:4},"astc-12x12-unorm":{bytesPerBlock:16,blockWidth:12,blockHeight:12,isCompressed:!0,channels:4},"astc-12x12-unorm-srgb":{bytesPerBlock:16,blockWidth:12,blockHeight:12,isCompressed:!0,channels:4}};class Fh{constructor(){this.id=Fh._id++,this.line=0}get isAstNode(){return!0}get astNodeType(){return""}search(e){e(this)}searchBlock(e,r){if(e){r(dE.instance);for(const n of e)n instanceof Array?this.searchBlock(n,r):n.search(r);r(pE.instance)}}constEvaluate(e,r){throw new Error("Cannot evaluate node")}constEvaluateString(e){return this.constEvaluate(e).toString()}}Fh._id=0;class dE extends Fh{}dE.instance=new dE;class pE extends Fh{}pE.instance=new pE;const Aee=new Set(["all","all","any","select","arrayLength","abs","acos","acosh","asin","asinh","atan","atanh","atan2","ceil","clamp","cos","cosh","countLeadingZeros","countOneBits","countTrailingZeros","cross","degrees","determinant","distance","dot","dot4U8Packed","dot4I8Packed","exp","exp2","extractBits","faceForward","firstLeadingBit","firstTrailingBit","floor","fma","fract","frexp","insertBits","inverseSqrt","ldexp","length","log","log2","max","min","mix","modf","normalize","pow","quantizeToF16","radians","reflect","refract","reverseBits","round","saturate","sign","sin","sinh","smoothStep","sqrt","step","tan","tanh","transpose","trunc","dpdx","dpdxCoarse","dpdxFine","dpdy","dpdyCoarse","dpdyFine","fwidth","fwidthCoarse","fwidthFine","textureDimensions","textureGather","textureGatherCompare","textureLoad","textureNumLayers","textureNumLevels","textureNumSamples","textureSample","textureSampleBias","textureSampleCompare","textureSampleCompareLevel","textureSampleGrad","textureSampleLevel","textureSampleBaseClampToEdge","textureStore","atomicLoad","atomicStore","atomicAdd","atomicSub","atomicMax","atomicMin","atomicAnd","atomicOr","atomicXor","atomicExchange","atomicCompareExchangeWeak","pack4x8snorm","pack4x8unorm","pack4xI8","pack4xU8","pack4x8Clamp","pack4xU8Clamp","pack2x16snorm","pack2x16unorm","pack2x16float","unpack4x8snorm","unpack4x8unorm","unpack4xI8","unpack4xU8","unpack2x16snorm","unpack2x16unorm","unpack2x16float","storageBarrier","textureBarrier","workgroupBarrier","workgroupUniformLoad","subgroupAdd","subgroupExclusiveAdd","subgroupInclusiveAdd","subgroupAll","subgroupAnd","subgroupAny","subgroupBallot","subgroupBroadcast","subgroupBroadcastFirst","subgroupElect","subgroupMax","subgroupMin","subgroupMul","subgroupExclusiveMul","subgroupInclusiveMul","subgroupOr","subgroupShuffle","subgroupShuffleDown","subgroupShuffleUp","subgroupShuffleXor","subgroupXor","quadBroadcast","quadSwapDiagonal","quadSwapX","quadSwapY"]);class ss extends Fh{constructor(){super()}}class Cb extends ss{constructor(e,r,n,i,a,s){super(),this.calls=new Set,this.name=e,this.args=r,this.returnType=n,this.body=i,this.startLine=a,this.endLine=s}get astNodeType(){return"function"}search(e){if(this.attributes)for(const r of this.attributes)e(r);e(this);for(const r of this.args)e(r);this.searchBlock(this.body,e)}}class qBe extends ss{constructor(e){super(),this.expression=e}get astNodeType(){return"staticAssert"}search(e){this.expression.search(e)}}class Iee extends ss{constructor(e,r){super(),this.condition=e,this.body=r}get astNodeType(){return"while"}search(e){this.condition.search(e),this.searchBlock(this.body,e)}}class WM extends ss{constructor(e,r){super(),this.body=e,this.loopId=r}get astNodeType(){return"continuing"}search(e){this.searchBlock(this.body,e)}}class Pee extends ss{constructor(e,r,n,i){super(),this.init=e,this.condition=r,this.increment=n,this.body=i}get astNodeType(){return"for"}search(e){var r,n,i;(r=this.init)===null||r===void 0||r.search(e),(n=this.condition)===null||n===void 0||n.search(e),(i=this.increment)===null||i===void 0||i.search(e),this.searchBlock(this.body,e)}}class Ld extends ss{constructor(e,r,n,i,a){super(),this.attributes=null,this.name=e,this.type=r,this.storage=n,this.access=i,this.value=a}get astNodeType(){return"var"}search(e){var r;e(this),(r=this.value)===null||r===void 0||r.search(e)}}class BN extends ss{constructor(e,r,n){super(),this.attributes=null,this.name=e,this.type=r,this.value=n}get astNodeType(){return"override"}search(e){var r;(r=this.value)===null||r===void 0||r.search(e)}}class B1 extends ss{constructor(e,r,n,i,a){super(),this.attributes=null,this.name=e,this.type=r,this.storage=n,this.access=i,this.value=a}get astNodeType(){return"let"}search(e){var r;e(this),(r=this.value)===null||r===void 0||r.search(e)}}class Mw extends ss{constructor(e,r,n,i,a){super(),this.attributes=null,this.name=e,this.type=r,this.storage=n,this.access=i,this.value=a}get astNodeType(){return"const"}constEvaluate(e,r){return this.value.constEvaluate(e,r)}search(e){var r;e(this),(r=this.value)===null||r===void 0||r.search(e)}}var Mv,d1,br,or;(t=>{t.increment="++",t.decrement="--"})(Mv||(Mv={})),(t=>{t.parse=function(e){const r=e;if(r=="parse")throw new Error("Invalid value for IncrementOperator");return t[r]}})(Mv||(Mv={}));class kee extends ss{constructor(e,r){super(),this.operator=e,this.variable=r}get astNodeType(){return"increment"}search(e){this.variable.search(e)}}(t=>{t.assign="=",t.addAssign="+=",t.subtractAssin="-=",t.multiplyAssign="*=",t.divideAssign="/=",t.moduloAssign="%=",t.andAssign="&=",t.orAssign="|=",t.xorAssign="^=",t.shiftLeftAssign="<<=",t.shiftRightAssign=">>="})(d1||(d1={})),(t=>{t.parse=function(e){const r=e;if(r=="parse")throw new Error("Invalid value for AssignOperator");return r}})(d1||(d1={}));class Mee extends ss{constructor(e,r,n){super(),this.operator=e,this.variable=r,this.value=n}get astNodeType(){return"assign"}search(e){this.variable.search(e),this.value.search(e)}}class zN extends ss{constructor(e,r){super(),this.name=e,this.args=r}get astNodeType(){return"call"}isBuiltin(){return Aee.has(this.name)}search(e){for(const r of this.args)r.search(e);e(this)}}class Ree extends ss{constructor(e,r){super(),this.body=e,this.continuing=r}get astNodeType(){return"loop"}search(e){var r;this.searchBlock(this.body,e),(r=this.continuing)===null||r===void 0||r.search(e)}}class Oee extends ss{constructor(e,r){super(),this.condition=e,this.cases=r}get astNodeType(){return"switch"}search(e){e(this);for(const r of this.cases)r.search(e)}}class Lee extends ss{constructor(e,r,n,i){super(),this.condition=e,this.body=r,this.elseif=n,this.else=i}get astNodeType(){return"if"}search(e){this.condition.search(e),this.searchBlock(this.body,e),this.searchBlock(this.elseif,e),this.searchBlock(this.else,e)}}class Nee extends ss{constructor(e){super(),this.value=e}get astNodeType(){return"return"}search(e){var r;(r=this.value)===null||r===void 0||r.search(e)}}class HBe extends ss{constructor(e){super(),this.name=e}get astNodeType(){return"enable"}}class WBe extends ss{constructor(e){super(),this.extensions=e}get astNodeType(){return"requires"}}class Dee extends ss{constructor(e,r){super(),this.severity=e,this.rule=r}get astNodeType(){return"diagnostic"}}class jN extends ss{constructor(e,r){super(),this.name=e,this.type=r}get astNodeType(){return"alias"}}class GBe extends ss{constructor(){super()}get astNodeType(){return"discard"}}class Fee extends ss{constructor(){super(),this.condition=null,this.loopId=-1}get astNodeType(){return"break"}}class Bee extends ss{constructor(){super(),this.loopId=-1}get astNodeType(){return"continue"}}class Xr extends ss{constructor(e){super(),this.attributes=null,this.name=e}get astNodeType(){return"type"}get isStruct(){return!1}get isArray(){return!1}static maxFormatType(e){let r=e[0];if(r.name==="f32")return r;for(let n=1;n<e.length;++n){const i=Xr._priority.get(r.name);Xr._priority.get(e[n].name)<i&&(r=e[n])}return r.name==="x32"?Xr.i32:r}getTypeName(){return this.name}}Xr.x32=new Xr("x32"),Xr.f32=new Xr("f32"),Xr.i32=new Xr("i32"),Xr.u32=new Xr("u32"),Xr.f16=new Xr("f16"),Xr.bool=new Xr("bool"),Xr.void=new Xr("void"),Xr._priority=new Map([["f32",0],["f16",1],["u32",2],["i32",3],["x32",3]]);class Aq extends Xr{constructor(e){super(e)}}class kd extends Xr{constructor(e,r,n,i){super(e),this.members=r,this.startLine=n,this.endLine=i}get astNodeType(){return"struct"}get isStruct(){return!0}getMemberIndex(e){for(let r=0;r<this.members.length;r++)if(this.members[r].name==e)return r;return-1}search(e){for(const r of this.members)e(r)}}class hr extends Xr{constructor(e,r,n){super(e),this.format=r,this.access=n}get astNodeType(){return"template"}getTypeName(){let e=this.name;if(this.format!==null){if(e==="vec2"||e==="vec3"||e==="vec4"||e==="mat2x2"||e==="mat2x3"||e==="mat2x4"||e==="mat3x2"||e==="mat3x3"||e==="mat3x4"||e==="mat4x2"||e==="mat4x3"||e==="mat4x4"){if(this.format.name==="f32")return e+="f",e;if(this.format.name==="i32")return e+="i",e;if(this.format.name==="u32")return e+="u",e;if(this.format.name==="bool")return e+="b",e;if(this.format.name==="f16")return e+="h",e}e+=`<${this.format.name}>`}else if(e==="vec2"||e==="vec3"||e==="vec4")return e;return e}}hr.vec2f=new hr("vec2",Xr.f32,null),hr.vec3f=new hr("vec3",Xr.f32,null),hr.vec4f=new hr("vec4",Xr.f32,null),hr.vec2i=new hr("vec2",Xr.i32,null),hr.vec3i=new hr("vec3",Xr.i32,null),hr.vec4i=new hr("vec4",Xr.i32,null),hr.vec2u=new hr("vec2",Xr.u32,null),hr.vec3u=new hr("vec3",Xr.u32,null),hr.vec4u=new hr("vec4",Xr.u32,null),hr.vec2h=new hr("vec2",Xr.f16,null),hr.vec3h=new hr("vec3",Xr.f16,null),hr.vec4h=new hr("vec4",Xr.f16,null),hr.vec2b=new hr("vec2",Xr.bool,null),hr.vec3b=new hr("vec3",Xr.bool,null),hr.vec4b=new hr("vec4",Xr.bool,null),hr.mat2x2f=new hr("mat2x2",Xr.f32,null),hr.mat2x3f=new hr("mat2x3",Xr.f32,null),hr.mat2x4f=new hr("mat2x4",Xr.f32,null),hr.mat3x2f=new hr("mat3x2",Xr.f32,null),hr.mat3x3f=new hr("mat3x3",Xr.f32,null),hr.mat3x4f=new hr("mat3x4",Xr.f32,null),hr.mat4x2f=new hr("mat4x2",Xr.f32,null),hr.mat4x3f=new hr("mat4x3",Xr.f32,null),hr.mat4x4f=new hr("mat4x4",Xr.f32,null),hr.mat2x2h=new hr("mat2x2",Xr.f16,null),hr.mat2x3h=new hr("mat2x3",Xr.f16,null),hr.mat2x4h=new hr("mat2x4",Xr.f16,null),hr.mat3x2h=new hr("mat3x2",Xr.f16,null),hr.mat3x3h=new hr("mat3x3",Xr.f16,null),hr.mat3x4h=new hr("mat3x4",Xr.f16,null),hr.mat4x2h=new hr("mat4x2",Xr.f16,null),hr.mat4x3h=new hr("mat4x3",Xr.f16,null),hr.mat4x4h=new hr("mat4x4",Xr.f16,null),hr.mat2x2i=new hr("mat2x2",Xr.i32,null),hr.mat2x3i=new hr("mat2x3",Xr.i32,null),hr.mat2x4i=new hr("mat2x4",Xr.i32,null),hr.mat3x2i=new hr("mat3x2",Xr.i32,null),hr.mat3x3i=new hr("mat3x3",Xr.i32,null),hr.mat3x4i=new hr("mat3x4",Xr.i32,null),hr.mat4x2i=new hr("mat4x2",Xr.i32,null),hr.mat4x3i=new hr("mat4x3",Xr.i32,null),hr.mat4x4i=new hr("mat4x4",Xr.i32,null),hr.mat2x2u=new hr("mat2x2",Xr.u32,null),hr.mat2x3u=new hr("mat2x3",Xr.u32,null),hr.mat2x4u=new hr("mat2x4",Xr.u32,null),hr.mat3x2u=new hr("mat3x2",Xr.u32,null),hr.mat3x3u=new hr("mat3x3",Xr.u32,null),hr.mat3x4u=new hr("mat3x4",Xr.u32,null),hr.mat4x2u=new hr("mat4x2",Xr.u32,null),hr.mat4x3u=new hr("mat4x3",Xr.u32,null),hr.mat4x4u=new hr("mat4x4",Xr.u32,null);class Rw extends Xr{constructor(e,r,n,i){super(e),this.storage=r,this.type=n,this.access=i}get astNodeType(){return"pointer"}}class z1 extends Xr{constructor(e,r,n,i){super(e),this.attributes=r,this.format=n,this.count=i}get astNodeType(){return"array"}get isArray(){return!0}}class p1 extends Xr{constructor(e,r,n){super(e),this.format=r,this.access=n}get astNodeType(){return"sampler"}}class vf extends Fh{constructor(){super(),this.postfix=null}}class Rm extends vf{constructor(e){super(),this.value=e}get astNodeType(){return"stringExpr"}toString(){return this.value}constEvaluateString(){return this.value}}class jf extends vf{constructor(e,r){super(),this.type=e,this.args=r}get astNodeType(){return"createExpr"}search(e){if(e(this),this.args)for(const r of this.args)r.search(e)}constEvaluate(e,r){return r&&(r[0]=this.type),e.evalExpression(this,e.context)}}class UN extends vf{constructor(e,r){super(),this.cachedReturnValue=null,this.name=e,this.args=r}get astNodeType(){return"callExpr"}setCachedReturnValue(e){this.cachedReturnValue=e}get isBuiltin(){return Aee.has(this.name)}constEvaluate(e,r){return e.evalExpression(this,e.context)}search(e){for(const r of this.args)r.search(e);e(this)}}class Xc extends vf{constructor(e){super(),this.name=e}get astNodeType(){return"varExpr"}search(e){e(this),this.postfix&&this.postfix.search(e)}constEvaluate(e,r){return e.evalExpression(this,e.context)}}class zee extends vf{constructor(e,r){super(),this.name=e,this.initializer=r}get astNodeType(){return"constExpr"}constEvaluate(e,r){if(this.initializer){const n=e.evalExpression(this.initializer,e.context);return n!==null&&this.postfix?n.getSubData(e,this.postfix,e.context):n}return null}search(e){this.initializer.search(e)}}class Pl extends vf{constructor(e,r){super(),this.value=e,this.type=r}get astNodeType(){return"literalExpr"}constEvaluate(e,r){return r!==void 0&&(r[0]=this.type),this.value}get isScalar(){return this.value instanceof rr}get isVector(){return this.value instanceof It||this.value instanceof Ai}get scalarValue(){return this.value instanceof rr?this.value.value:(console.error("Value is not scalar."),0)}get vectorValue(){return this.value instanceof It||this.value instanceof Ai?this.value.data:(console.error("Value is not a vector or matrix."),new Float32Array(0))}}class jee extends vf{constructor(e,r){super(),this.type=e,this.value=r}get astNodeType(){return"bitcastExpr"}search(e){this.value.search(e)}}class b0 extends vf{constructor(e){super(),this.index=e}search(e){this.index.search(e)}}class Uee extends vf{constructor(){super()}}class dl extends Uee{constructor(e,r){super(),this.operator=e,this.right=r}get astNodeType(){return"unaryOp"}constEvaluate(e,r){return e.evalExpression(this,e.context)}search(e){this.right.search(e)}}class Zh extends Uee{constructor(e,r,n){super(),this.operator=e,this.left=r,this.right=n}get astNodeType(){return"binaryOp"}_getPromotedType(e,r){return e.name===r.name?e:e.name==="f32"||r.name==="f32"?Xr.f32:e.name==="u32"||r.name==="u32"?Xr.u32:Xr.i32}constEvaluate(e,r){return e.evalExpression(this,e.context)}search(e){this.left.search(e),this.right.search(e)}}class Vee extends Fh{constructor(e){super(),this.body=e}search(e){e(this),this.searchBlock(this.body,e)}}class Ow extends vf{constructor(){super()}get astNodeType(){return"default"}}class $ee extends Vee{constructor(e,r){super(r),this.selectors=e}get astNodeType(){return"case"}search(e){this.searchBlock(this.body,e)}}class qee extends Vee{constructor(e){super(e)}get astNodeType(){return"default"}search(e){this.searchBlock(this.body,e)}}class Iq extends Fh{constructor(e,r,n){super(),this.name=e,this.type=r,this.attributes=n}get astNodeType(){return"argument"}}class XBe extends Fh{constructor(e,r){super(),this.condition=e,this.body=r}get astNodeType(){return"elseif"}search(e){this.condition.search(e),this.searchBlock(this.body,e)}}class Pq extends Fh{constructor(e,r,n){super(),this.name=e,this.type=r,this.attributes=n}get astNodeType(){return"member"}}class Hee extends Fh{constructor(e,r){super(),this.name=e,this.value=r}get astNodeType(){return"attribute"}}class Lh{constructor(e,r){this.parent=null,this.typeInfo=e,this.parent=r,this.id=Lh._id++}clone(){throw`Clone: Not implemented for ${this.constructor.name}`}setDataValue(e,r,n,i){console.error(`SetDataValue: Not implemented for ${this.constructor.name}`)}getSubData(e,r,n){return console.error(`GetDataValue: Not implemented for ${this.constructor.name}`),null}toString(){return`<${this.typeInfo.getTypeName()}>`}}Lh._id=0;class GM extends Lh{constructor(){super(new wh("void",null),null)}toString(){return"void"}}GM.void=new GM;class Wy extends Lh{constructor(e){super(new HM("pointer",e.typeInfo,null),null),this.reference=e}clone(){return this}setDataValue(e,r,n,i){this.reference.setDataValue(e,r,n,i)}getSubData(e,r,n){return r?this.reference.getSubData(e,r,n):this}toString(){return`&${this.reference.toString()}`}}class rr extends Lh{constructor(e,r,n=null){super(r,n),e instanceof Int32Array||e instanceof Uint32Array||e instanceof Float32Array?this.data=e:this.typeInfo.name==="x32"?e-Math.floor(e)!==0?this.data=new Float32Array([e]):this.data=e>=0?new Uint32Array([e]):new Int32Array([e]):this.typeInfo.name==="i32"||this.typeInfo.name==="bool"?this.data=new Int32Array([e]):this.typeInfo.name==="u32"?this.data=new Uint32Array([e]):this.typeInfo.name==="f32"||this.typeInfo.name==="f16"?this.data=new Float32Array([e]):console.error("ScalarData2: Invalid type",r)}clone(){if(this.data instanceof Float32Array)return new rr(new Float32Array(this.data),this.typeInfo,null);if(this.data instanceof Int32Array)return new rr(new Int32Array(this.data),this.typeInfo,null);if(this.data instanceof Uint32Array)return new rr(new Uint32Array(this.data),this.typeInfo,null);throw"ScalarData: Invalid data type"}get value(){return this.data[0]}set value(e){this.data[0]=e}setDataValue(e,r,n,i){if(n)return void console.error("SetDataValue: Scalar data does not support postfix",n);if(!(r instanceof rr))return void console.error("SetDataValue: Invalid value",r);let a=r.data[0];this.typeInfo.name==="i32"||this.typeInfo.name==="u32"?a=Math.floor(a):this.typeInfo.name==="bool"&&(a=a?1:0),this.data[0]=a}getSubData(e,r,n){return r?(console.error("getSubData: Scalar data does not support postfix",r),null):this}toString(){return`${this.value}`}}function YBe(t,e,r){const n=e.length;return n===2?r==="f32"?new It(new Float32Array(e),t.getTypeInfo("vec2f")):r==="i32"||r==="bool"?new It(new Int32Array(e),t.getTypeInfo("vec2i")):r==="u32"?new It(new Uint32Array(e),t.getTypeInfo("vec2u")):r==="f16"?new It(new Float32Array(e),t.getTypeInfo("vec2h")):(console.error(`getSubData: Unknown format ${r}`),null):n===3?r==="f32"?new It(new Float32Array(e),t.getTypeInfo("vec3f")):r==="i32"||r==="bool"?new It(new Int32Array(e),t.getTypeInfo("vec3i")):r==="u32"?new It(new Uint32Array(e),t.getTypeInfo("vec3u")):r==="f16"?new It(new Float32Array(e),t.getTypeInfo("vec3h")):(console.error(`getSubData: Unknown format ${r}`),null):n===4?r==="f32"?new It(new Float32Array(e),t.getTypeInfo("vec4f")):r==="i32"||r==="bool"?new It(new Int32Array(e),t.getTypeInfo("vec4i")):r==="u32"?new It(new Uint32Array(e),t.getTypeInfo("vec4u")):r==="f16"?new It(new Float32Array(e),t.getTypeInfo("vec4h")):(console.error(`getSubData: Unknown format ${r}`),null):(console.error(`getSubData: Invalid vector size ${e.length}`),null)}class It extends Lh{constructor(e,r,n=null){if(super(r,n),e instanceof Float32Array||e instanceof Uint32Array||e instanceof Int32Array)this.data=e;else{const i=this.typeInfo.name;i==="vec2f"||i==="vec3f"||i==="vec4f"?this.data=new Float32Array(e):i==="vec2i"||i==="vec3i"||i==="vec4i"?this.data=new Int32Array(e):i==="vec2u"||i==="vec3u"||i==="vec4u"?this.data=new Uint32Array(e):i==="vec2h"||i==="vec3h"||i==="vec4h"?this.data=new Float32Array(e):i==="vec2b"||i==="vec3b"||i==="vec4b"?this.data=new Int32Array(e):i==="vec2"||i==="vec3"||i==="vec4"?this.data=new Float32Array(e):console.error(`VectorData: Invalid type ${i}`)}}clone(){if(this.data instanceof Float32Array)return new It(new Float32Array(this.data),this.typeInfo,null);if(this.data instanceof Int32Array)return new It(new Int32Array(this.data),this.typeInfo,null);if(this.data instanceof Uint32Array)return new It(new Uint32Array(this.data),this.typeInfo,null);throw"VectorData: Invalid data type"}setDataValue(e,r,n,i){n instanceof Rm?console.error("TODO: Set vector postfix"):r instanceof It?this.data=r.data:console.error("SetDataValue: Invalid value",r)}getSubData(e,r,n){if(r===null)return this;let i=e.getTypeInfo("f32");if(this.typeInfo instanceof Mm)i=this.typeInfo.format||i;else{const s=this.typeInfo.name;s==="vec2f"||s==="vec3f"||s==="vec4f"?i=e.getTypeInfo("f32"):s==="vec2i"||s==="vec3i"||s==="vec4i"?i=e.getTypeInfo("i32"):s==="vec2b"||s==="vec3b"||s==="vec4b"?i=e.getTypeInfo("bool"):s==="vec2u"||s==="vec3u"||s==="vec4u"?i=e.getTypeInfo("u32"):s==="vec2h"||s==="vec3h"||s==="vec4h"?i=e.getTypeInfo("f16"):console.error(`GetSubData: Unknown type ${s}`)}let a=this;for(;r!==null&&a!==null;){if(r instanceof b0){const s=r.index;let o=-1;if(s instanceof Pl){if(!(s.value instanceof rr))return console.error(`GetSubData: Invalid array index ${s.value}`),null;o=s.value.value}else{const u=e.evalExpression(s,n);if(!(u instanceof rr))return console.error("GetSubData: Unknown index type",s),null;o=u.value}if(o<0||o>=a.data.length)return console.error("GetSubData: Index out of range",o),null;if(a.data instanceof Float32Array){const u=new Float32Array(a.data.buffer,a.data.byteOffset+4*o,1);return new rr(u,i)}if(a.data instanceof Int32Array){const u=new Int32Array(a.data.buffer,a.data.byteOffset+4*o,1);return new rr(u,i)}if(a.data instanceof Uint32Array){const u=new Uint32Array(a.data.buffer,a.data.byteOffset+4*o,1);return new rr(u,i)}throw"GetSubData: Invalid data type"}if(!(r instanceof Rm))return console.error("GetSubData: Unknown postfix",r),null;{const s=r.value.toLowerCase();if(s.length===1){let u=0;if(s==="x"||s==="r")u=0;else if(s==="y"||s==="g")u=1;else if(s==="z"||s==="b")u=2;else{if(s!=="w"&&s!=="a")return console.error(`GetSubData: Unknown member ${s}`),null;u=3}if(this.data instanceof Float32Array){let h=new Float32Array(this.data.buffer,this.data.byteOffset+4*u,1);return new rr(h,i,this)}if(this.data instanceof Int32Array){let h=new Int32Array(this.data.buffer,this.data.byteOffset+4*u,1);return new rr(h,i,this)}if(this.data instanceof Uint32Array){let h=new Uint32Array(this.data.buffer,this.data.byteOffset+4*u,1);return new rr(h,i,this)}}const o=[];for(const u of s)u==="x"||u==="r"?o.push(this.data[0]):u==="y"||u==="g"?o.push(this.data[1]):u==="z"||u==="b"?o.push(this.data[2]):u==="w"||u==="a"?o.push(this.data[3]):console.error(`GetDataValue: Unknown member ${u}`);a=YBe(e,o,i.name)}r=r.postfix}return a}toString(){let e=`${this.data[0]}`;for(let r=1;r<this.data.length;++r)e+=`, ${this.data[r]}`;return e}}class Ai extends Lh{constructor(e,r,n=null){super(r,n),e instanceof Float32Array?this.data=e:this.data=new Float32Array(e)}clone(){return new Ai(new Float32Array(this.data),this.typeInfo,null)}setDataValue(e,r,n,i){n instanceof Rm?console.error("TODO: Set matrix postfix"):r instanceof Ai?this.data=r.data:console.error("SetDataValue: Invalid value",r)}getSubData(e,r,n){if(r===null)return this;const i=this.typeInfo.name;if(e.getTypeInfo("f32"),this.typeInfo instanceof Mm)this.typeInfo.format;else if(i.endsWith("f"))e.getTypeInfo("f32");else if(i.endsWith("i"))e.getTypeInfo("i32");else if(i.endsWith("u"))e.getTypeInfo("u32");else{if(!i.endsWith("h"))return console.error(`GetDataValue: Unknown type ${i}`),null;e.getTypeInfo("f16")}if(r instanceof b0){const a=r.index;let s=-1;if(a instanceof Pl){if(!(a.value instanceof rr))return console.error(`GetDataValue: Invalid array index ${a.value}`),null;s=a.value.value}else{const h=e.evalExpression(a,n);if(!(h instanceof rr))return console.error("GetDataValue: Unknown index type",a),null;s=h.value}if(s<0||s>=this.data.length)return console.error("GetDataValue: Index out of range",s),null;const o=i.endsWith("h")?"h":"f";let u;if(i==="mat2x2"||i==="mat2x2f"||i==="mat2x2h"||i==="mat3x2"||i==="mat3x2f"||i==="mat3x2h"||i==="mat4x2"||i==="mat4x2f"||i==="mat4x2h")u=new It(new Float32Array(this.data.buffer,this.data.byteOffset+2*s*4,2),e.getTypeInfo(`vec2${o}`));else if(i==="mat2x3"||i==="mat2x3f"||i==="mat2x3h"||i==="mat3x3"||i==="mat3x3f"||i==="mat3x3h"||i==="mat4x3"||i==="mat4x3f"||i==="mat4x3h")u=new It(new Float32Array(this.data.buffer,this.data.byteOffset+3*s*4,3),e.getTypeInfo(`vec3${o}`));else{if(i!=="mat2x4"&&i!=="mat2x4f"&&i!=="mat2x4h"&&i!=="mat3x4"&&i!=="mat3x4f"&&i!=="mat3x4h"&&i!=="mat4x4"&&i!=="mat4x4f"&&i!=="mat4x4h")return console.error(`GetDataValue: Unknown type ${i}`),null;u=new It(new Float32Array(this.data.buffer,this.data.byteOffset+4*s*4,4),e.getTypeInfo(`vec4${o}`))}return r.postfix?u.getSubData(e,r.postfix,n):u}return console.error("GetDataValue: Invalid postfix",r),null}toString(){let e=`${this.data[0]}`;for(let r=1;r<this.data.length;++r)e+=`, ${this.data[r]}`;return e}}class Ds extends Lh{constructor(e,r,n=0,i=null){super(r,i),this.buffer=e instanceof ArrayBuffer?e:e.buffer,this.offset=n}clone(){const e=new Uint8Array(new Uint8Array(this.buffer,this.offset,this.typeInfo.size));return new Ds(e.buffer,this.typeInfo,0,null)}setDataValue(e,r,n,i){if(r===null)return void console.log("setDataValue: NULL data.");let a=this.offset,s=this.typeInfo;for(;n;){if(n instanceof b0)if(s instanceof Gp){const o=n.index;if(o instanceof Pl){if(!(o.value instanceof rr))return void console.error(`SetDataValue: Invalid index type ${o.value}`);a+=o.value.value*s.stride}else{const u=e.evalExpression(o,i);if(!(u instanceof rr))return void console.error("SetDataValue: Unknown index type",o);a+=u.value*s.stride}s=s.format}else console.error(`SetDataValue: Type ${s.getTypeName()} is not an array`);else{if(!(n instanceof Rm))return void console.error("SetDataValue: Unknown postfix type",n);{const o=n.value;if(s instanceof zp){let u=!1;for(const h of s.members)if(h.name===o){a+=h.offset,s=h.type,u=!0;break}if(!u)return void console.error(`SetDataValue: Member ${o} not found`)}else if(s instanceof wh){const u=s.getTypeName();let h=0;if(o==="x"||o==="r")h=0;else if(o==="y"||o==="g")h=1;else if(o==="z"||o==="b")h=2;else{if(o!=="w"&&o!=="a")return void console.error(`SetDataValue: Unknown member ${o}`);h=3}if(!(r instanceof rr))return void console.error("SetDataValue: Invalid value",r);const f=r.value;return u==="vec2f"?void(new Float32Array(this.buffer,a,2)[h]=f):u==="vec3f"?void(new Float32Array(this.buffer,a,3)[h]=f):u==="vec4f"?void(new Float32Array(this.buffer,a,4)[h]=f):u==="vec2i"?void(new Int32Array(this.buffer,a,2)[h]=f):u==="vec3i"?void(new Int32Array(this.buffer,a,3)[h]=f):u==="vec4i"?void(new Int32Array(this.buffer,a,4)[h]=f):u==="vec2u"?void(new Uint32Array(this.buffer,a,2)[h]=f):u==="vec3u"?void(new Uint32Array(this.buffer,a,3)[h]=f):u==="vec4u"?void(new Uint32Array(this.buffer,a,4)[h]=f):void console.error(`SetDataValue: Type ${u} is not a struct`)}}}n=n.postfix}this.setData(e,r,s,a,i)}setData(e,r,n,i,a){const s=n.getTypeName();if(s!=="f32"&&s!=="f16")if(s!=="i32"&&s!=="atomic<i32>"&&s!=="x32")if(s!=="u32"&&s!=="atomic<u32>")if(s!=="bool"){if(s==="vec2f"||s==="vec2h"){const o=new Float32Array(this.buffer,i,2);return void(r instanceof It?(o[0]=r.data[0],o[1]=r.data[1]):(o[0]=r[0],o[1]=r[1]))}if(s==="vec3f"||s==="vec3h"){const o=new Float32Array(this.buffer,i,3);return void(r instanceof It?(o[0]=r.data[0],o[1]=r.data[1],o[2]=r.data[2]):(o[0]=r[0],o[1]=r[1],o[2]=r[2]))}if(s==="vec4f"||s==="vec4h"){const o=new Float32Array(this.buffer,i,4);return void(r instanceof It?(o[0]=r.data[0],o[1]=r.data[1],o[2]=r.data[2],o[3]=r.data[3]):(o[0]=r[0],o[1]=r[1],o[2]=r[2],o[3]=r[3]))}if(s==="vec2i"){const o=new Int32Array(this.buffer,i,2);return void(r instanceof It?(o[0]=r.data[0],o[1]=r.data[1]):(o[0]=r[0],o[1]=r[1]))}if(s==="vec3i"){const o=new Int32Array(this.buffer,i,3);return void(r instanceof It?(o[0]=r.data[0],o[1]=r.data[1],o[2]=r.data[2]):(o[0]=r[0],o[1]=r[1],o[2]=r[2]))}if(s==="vec4i"){const o=new Int32Array(this.buffer,i,4);return void(r instanceof It?(o[0]=r.data[0],o[1]=r.data[1],o[2]=r.data[2],o[3]=r.data[3]):(o[0]=r[0],o[1]=r[1],o[2]=r[2],o[3]=r[3]))}if(s==="vec2u"){const o=new Uint32Array(this.buffer,i,2);return void(r instanceof It?(o[0]=r.data[0],o[1]=r.data[1]):(o[0]=r[0],o[1]=r[1]))}if(s==="vec3u"){const o=new Uint32Array(this.buffer,i,3);return void(r instanceof It?(o[0]=r.data[0],o[1]=r.data[1],o[2]=r.data[2]):(o[0]=r[0],o[1]=r[1],o[2]=r[2]))}if(s==="vec4u"){const o=new Uint32Array(this.buffer,i,4);return void(r instanceof It?(o[0]=r.data[0],o[1]=r.data[1],o[2]=r.data[2],o[3]=r.data[3]):(o[0]=r[0],o[1]=r[1],o[2]=r[2],o[3]=r[3]))}if(s==="vec2b"){const o=new Uint32Array(this.buffer,i,2);return void(r instanceof It?(o[0]=r.data[0],o[1]=r.data[1]):(o[0]=r[0],o[1]=r[1]))}if(s==="vec3b"){const o=new Uint32Array(this.buffer,i,3);return void(r instanceof It?(o[0]=r.data[0],o[1]=r.data[1],o[2]=r.data[2]):(o[0]=r[0],o[1]=r[1],o[2]=r[2]))}if(s==="vec4b"){const o=new Uint32Array(this.buffer,i,4);return void(r instanceof It?(o[0]=r.data[0],o[1]=r.data[1],o[2]=r.data[2],o[3]=r.data[3]):(o[0]=r[0],o[1]=r[1],o[2]=r[2],o[3]=r[3]))}if(s==="mat2x2f"||s==="mat2x2h"){const o=new Float32Array(this.buffer,i,4);return void(r instanceof Ai?(o[0]=r.data[0],o[1]=r.data[1],o[2]=r.data[2],o[3]=r.data[3]):(o[0]=r[0],o[1]=r[1],o[2]=r[2],o[3]=r[3]))}if(s==="mat2x3f"||s==="mat2x3h"){const o=new Float32Array(this.buffer,i,6);return void(r instanceof Ai?(o[0]=r.data[0],o[1]=r.data[1],o[2]=r.data[2],o[3]=r.data[3],o[4]=r.data[4],o[5]=r.data[5]):(o[0]=r[0],o[1]=r[1],o[2]=r[2],o[3]=r[3],o[4]=r[4],o[5]=r[5]))}if(s==="mat2x4f"||s==="mat2x4h"){const o=new Float32Array(this.buffer,i,8);return void(r instanceof Ai?(o[0]=r.data[0],o[1]=r.data[1],o[2]=r.data[2],o[3]=r.data[3],o[4]=r.data[4],o[5]=r.data[5],o[6]=r.data[6],o[7]=r.data[7]):(o[0]=r[0],o[1]=r[1],o[2]=r[2],o[3]=r[3],o[4]=r[4],o[5]=r[5],o[6]=r[6],o[7]=r[7]))}if(s==="mat3x2f"||s==="mat3x2h"){const o=new Float32Array(this.buffer,i,6);return void(r instanceof Ai?(o[0]=r.data[0],o[1]=r.data[1],o[2]=r.data[2],o[3]=r.data[3],o[4]=r.data[4],o[5]=r.data[5]):(o[0]=r[0],o[1]=r[1],o[2]=r[2],o[3]=r[3],o[4]=r[4],o[5]=r[5]))}if(s==="mat3x3f"||s==="mat3x3h"){const o=new Float32Array(this.buffer,i,9);return void(r instanceof Ai?(o[0]=r.data[0],o[1]=r.data[1],o[2]=r.data[2],o[3]=r.data[3],o[4]=r.data[4],o[5]=r.data[5],o[6]=r.data[6],o[7]=r.data[7],o[8]=r.data[8]):(o[0]=r[0],o[1]=r[1],o[2]=r[2],o[3]=r[3],o[4]=r[4],o[5]=r[5],o[6]=r[6],o[7]=r[7],o[8]=r[8]))}if(s==="mat3x4f"||s==="mat3x4h"){const o=new Float32Array(this.buffer,i,12);return void(r instanceof Ai?(o[0]=r.data[0],o[1]=r.data[1],o[2]=r.data[2],o[3]=r.data[3],o[4]=r.data[4],o[5]=r.data[5],o[6]=r.data[6],o[7]=r.data[7],o[8]=r.data[8],o[9]=r.data[9],o[10]=r.data[10],o[11]=r.data[11]):(o[0]=r[0],o[1]=r[1],o[2]=r[2],o[3]=r[3],o[4]=r[4],o[5]=r[5],o[6]=r[6],o[7]=r[7],o[8]=r[8],o[9]=r[9],o[10]=r[10],o[11]=r[11]))}if(s==="mat4x2f"||s==="mat4x2h"){const o=new Float32Array(this.buffer,i,8);return void(r instanceof Ai?(o[0]=r.data[0],o[1]=r.data[1],o[2]=r.data[2],o[3]=r.data[3],o[4]=r.data[4],o[5]=r.data[5],o[6]=r.data[6],o[7]=r.data[7]):(o[0]=r[0],o[1]=r[1],o[2]=r[2],o[3]=r[3],o[4]=r[4],o[5]=r[5],o[6]=r[6],o[7]=r[7]))}if(s==="mat4x3f"||s==="mat4x3h"){const o=new Float32Array(this.buffer,i,12);return void(r instanceof Ai?(o[0]=r.data[0],o[1]=r.data[1],o[2]=r.data[2],o[3]=r.data[3],o[4]=r.data[4],o[5]=r.data[5],o[6]=r.data[6],o[7]=r.data[7],o[8]=r.data[8],o[9]=r.data[9],o[10]=r.data[10],o[11]=r.data[11]):(o[0]=r[0],o[1]=r[1],o[2]=r[2],o[3]=r[3],o[4]=r[4],o[5]=r[5],o[6]=r[6],o[7]=r[7],o[8]=r[8],o[9]=r[9],o[10]=r[10],o[11]=r[11]))}if(s==="mat4x4f"||s==="mat4x4h"){const o=new Float32Array(this.buffer,i,16);return void(r instanceof Ai?(o[0]=r.data[0],o[1]=r.data[1],o[2]=r.data[2],o[3]=r.data[3],o[4]=r.data[4],o[5]=r.data[5],o[6]=r.data[6],o[7]=r.data[7],o[8]=r.data[8],o[9]=r.data[9],o[10]=r.data[10],o[11]=r.data[11],o[12]=r.data[12],o[13]=r.data[13],o[14]=r.data[14],o[15]=r.data[15]):(o[0]=r[0],o[1]=r[1],o[2]=r[2],o[3]=r[3],o[4]=r[4],o[5]=r[5],o[6]=r[6],o[7]=r[7],o[8]=r[8],o[9]=r[9],o[10]=r[10],o[11]=r[11],o[12]=r[12],o[13]=r[13],o[14]=r[14],o[15]=r[15]))}if(r instanceof Ds){if(n===r.typeInfo)return void new Uint8Array(this.buffer,i,r.buffer.byteLength).set(new Uint8Array(r.buffer));console.error("SetDataValue: Type mismatch",s,r.typeInfo.getTypeName())}else console.error(`SetData: Unknown type ${s}`)}else r instanceof rr&&(new Int32Array(this.buffer,i,1)[0]=r.value);else r instanceof rr&&(new Uint32Array(this.buffer,i,1)[0]=r.value);else r instanceof rr&&(new Int32Array(this.buffer,i,1)[0]=r.value);else r instanceof rr&&(new Float32Array(this.buffer,i,1)[0]=r.value)}getSubData(e,r,n){var i,a,s;if(r===null)return this;let o=this.offset,u=this.typeInfo;for(;r;){if(r instanceof b0){const f=r.index,g=f instanceof vf?e.evalExpression(f,n):f;let b=0;if(g instanceof rr?b=g.value:typeof g=="number"?b=g:console.error("GetDataValue: Invalid index type",f),u instanceof Gp)o+=b*u.stride,u=u.format;else{const v=u.getTypeName();v==="mat4x4"||v==="mat4x4f"||v==="mat4x4h"?(o+=16*b,u=e.getTypeInfo("vec4f")):console.error(`getDataValue: Type ${u.getTypeName()} is not an array`)}}else{if(!(r instanceof Rm))return console.error("GetDataValue: Unknown postfix type",r),null;{const f=r.value;if(u instanceof zp){let g=!1;for(const b of u.members)if(b.name===f){o+=b.offset,u=b.type,g=!0;break}if(!g)return console.error(`GetDataValue: Member ${f} not found`),null}else if(u instanceof wh){const g=u.getTypeName();if(g==="vec2f"||g==="vec3f"||g==="vec4f"||g==="vec2i"||g==="vec3i"||g==="vec4i"||g==="vec2u"||g==="vec3u"||g==="vec4u"||g==="vec2b"||g==="vec3b"||g==="vec4b"||g==="vec2h"||g==="vec3h"||g==="vec4h"||g==="vec2"||g==="vec3"||g==="vec4"){if(f.length>0&&f.length<5){let b="f";const v=[];for(let S=0;S<f.length;++S){const E=f[S].toLowerCase();let P=0;if(E==="x"||E==="r")P=0;else if(E==="y"||E==="g")P=1;else if(E==="z"||E==="b")P=2;else{if(E!=="w"&&E!=="a")return console.error(`Unknown member ${f}`),null;P=3}if(f.length===1){if(g.endsWith("f"))return this.buffer.byteLength<o+4*P+4?(console.log("Insufficient buffer data"),null):new rr(new Float32Array(this.buffer,o+4*P,1),e.getTypeInfo("f32"),this);if(g.endsWith("h"))return new rr(new Float32Array(this.buffer,o+4*P,1),e.getTypeInfo("f16"),this);if(g.endsWith("i"))return new rr(new Int32Array(this.buffer,o+4*P,1),e.getTypeInfo("i32"),this);if(g.endsWith("b"))return new rr(new Int32Array(this.buffer,o+4*P,1),e.getTypeInfo("bool"),this);if(g.endsWith("u"))return new rr(new Uint32Array(this.buffer,o+4*P,1),e.getTypeInfo("i32"),this)}if(g==="vec2f")v.push(new Float32Array(this.buffer,o,2)[P]);else if(g==="vec3f"){if(o+12>=this.buffer.byteLength)return console.log("Insufficient buffer data"),null;const k=new Float32Array(this.buffer,o,3);v.push(k[P])}else if(g==="vec4f")v.push(new Float32Array(this.buffer,o,4)[P]);else if(g==="vec2i")b="i",v.push(new Int32Array(this.buffer,o,2)[P]);else if(g==="vec3i")b="i",v.push(new Int32Array(this.buffer,o,3)[P]);else if(g==="vec4i")b="i",v.push(new Int32Array(this.buffer,o,4)[P]);else if(g==="vec2u"){b="u";const k=new Uint32Array(this.buffer,o,2);v.push(k[P])}else g==="vec3u"?(b="u",v.push(new Uint32Array(this.buffer,o,3)[P])):g==="vec4u"&&(b="u",v.push(new Uint32Array(this.buffer,o,4)[P]))}return v.length===2?u=e.getTypeInfo(`vec2${b}`):v.length===3?u=e.getTypeInfo(`vec3${b}`):v.length===4?u=e.getTypeInfo(`vec4${b}`):console.error(`GetDataValue: Invalid vector length ${v.length}`),new It(v,u,null)}return console.error(`GetDataValue: Unknown member ${f}`),null}return console.error(`GetDataValue: Type ${g} is not a struct`),null}}}r=r.postfix}const h=u.getTypeName();return h==="f32"?new rr(new Float32Array(this.buffer,o,1),u,this):h==="i32"?new rr(new Int32Array(this.buffer,o,1),u,this):h==="u32"?new rr(new Uint32Array(this.buffer,o,1),u,this):h==="vec2f"?new It(new Float32Array(this.buffer,o,2),u,this):h==="vec3f"?new It(new Float32Array(this.buffer,o,3),u,this):h==="vec4f"?new It(new Float32Array(this.buffer,o,4),u,this):h==="vec2i"?new It(new Int32Array(this.buffer,o,2),u,this):h==="vec3i"?new It(new Int32Array(this.buffer,o,3),u,this):h==="vec4i"?new It(new Int32Array(this.buffer,o,4),u,this):h==="vec2u"?new It(new Uint32Array(this.buffer,o,2),u,this):h==="vec3u"?new It(new Uint32Array(this.buffer,o,3),u,this):h==="vec4u"?new It(new Uint32Array(this.buffer,o,4),u,this):u instanceof Mm&&u.name==="atomic"?((i=u.format)===null||i===void 0?void 0:i.name)==="u32"?new rr(new Uint32Array(this.buffer,o,1)[0],u.format,this):((a=u.format)===null||a===void 0?void 0:a.name)==="i32"?new rr(new Int32Array(this.buffer,o,1)[0],u.format,this):(console.error(`GetDataValue: Invalid atomic format ${(s=u.format)===null||s===void 0?void 0:s.name}`),null):new Ds(this.buffer,u,o,this)}toString(){let e="";if(this.typeInfo instanceof Gp)if(this.typeInfo.format.name==="f32"){const r=new Float32Array(this.buffer,this.offset);e=`[${r[0]}`;for(let n=1;n<r.length;++n)e+=`, ${r[n]}`}else if(this.typeInfo.format.name==="i32"){const r=new Int32Array(this.buffer,this.offset);e=`[${r[0]}`;for(let n=1;n<r.length;++n)e+=`, ${r[n]}`}else if(this.typeInfo.format.name==="u32"){const r=new Uint32Array(this.buffer,this.offset);e=`[${r[0]}`;for(let n=1;n<r.length;++n)e+=`, ${r[n]}`}else if(this.typeInfo.format.name==="vec2f"){const r=new Float32Array(this.buffer,this.offset);e=`[${r[0]}, ${r[1]}]`;for(let n=1;n<r.length/2;++n)e+=`, [${r[2*n]}, ${r[2*n+1]}]`}else if(this.typeInfo.format.name==="vec3f"){const r=new Float32Array(this.buffer,this.offset);e=`[${r[0]}, ${r[1]}, ${r[2]}]`;for(let n=4;n<r.length;n+=4)e+=`, [${r[n]}, ${r[n+1]}, ${r[n+2]}]`}else if(this.typeInfo.format.name==="vec4f"){const r=new Float32Array(this.buffer,this.offset);e=`[${r[0]}, ${r[1]}, ${r[2]}, ${r[3]}]`;for(let n=4;n<r.length;n+=4)e+=`, [${r[n]}, ${r[n+1]}, ${r[n+2]}, ${r[n+3]}]`}else e="[...]";else this.typeInfo instanceof zp?e+="{...}":e="[...]";return e}}class Md extends Lh{constructor(e,r,n,i){super(r,null),this.data=e,this.descriptor=n,this.view=i}clone(){return new Md(this.data,this.typeInfo,this.descriptor,this.view)}get width(){var e,r;const n=this.descriptor.size;return n instanceof Array&&n.length>0?(e=n[0])!==null&&e!==void 0?e:0:n instanceof Object&&(r=n.width)!==null&&r!==void 0?r:0}get height(){var e,r;const n=this.descriptor.size;return n instanceof Array&&n.length>1?(e=n[1])!==null&&e!==void 0?e:0:n instanceof Object&&(r=n.height)!==null&&r!==void 0?r:0}get depthOrArrayLayers(){var e,r;const n=this.descriptor.size;return n instanceof Array&&n.length>2?(e=n[2])!==null&&e!==void 0?e:0:n instanceof Object&&(r=n.depthOrArrayLayers)!==null&&r!==void 0?r:0}get format(){var e;return this.descriptor&&(e=this.descriptor.format)!==null&&e!==void 0?e:"rgba8unorm"}get sampleCount(){var e;return this.descriptor&&(e=this.descriptor.sampleCount)!==null&&e!==void 0?e:1}get mipLevelCount(){var e;return this.descriptor&&(e=this.descriptor.mipLevelCount)!==null&&e!==void 0?e:1}get dimension(){var e;return this.descriptor&&(e=this.descriptor.dimension)!==null&&e!==void 0?e:"2d"}getMipLevelSize(e){if(e>=this.mipLevelCount)return[0,0,0];const r=[this.width,this.height,this.depthOrArrayLayers];for(let n=0;n<r.length;++n)r[n]=Math.max(1,r[n]>>e);return r}get texelByteSize(){const e=this.format,r=FI[e];return r?r.isDepthStencil?4:r.bytesPerBlock:0}get bytesPerRow(){return this.width*this.texelByteSize}get isDepthStencil(){const e=this.format,r=FI[e];return!!r&&r.isDepthStencil}getGpuSize(){const e=this.format,r=FI[e],n=this.width;if(!e||n<=0||!r)return-1;const i=this.height,a=this.depthOrArrayLayers,s=this.dimension;return n/r.blockWidth*(s==="1d"?1:i/r.blockHeight)*r.bytesPerBlock*a}getPixel(e,r,n=0,i=0){const a=this.texelByteSize,s=this.bytesPerRow,o=this.height,u=this.data[i];return $Be(new Uint8Array(u),e,r,n,i,o,s,a,this.format)}setPixel(e,r,n,i,a){const s=this.texelByteSize,o=this.bytesPerRow,u=this.height,h=this.data[i];(function(f,g,b,v,S,E,P,k,L,O){const M=v*(P>>=S)*(E>>=S)+b*P+g*k;switch(L){case"r8unorm":return void Ya(f,M,"8unorm",1,O);case"r8snorm":return void Ya(f,M,"8snorm",1,O);case"r8uint":return void Ya(f,M,"8uint",1,O);case"r8sint":return void Ya(f,M,"8sint",1,O);case"rg8unorm":return void Ya(f,M,"8unorm",2,O);case"rg8snorm":return void Ya(f,M,"8snorm",2,O);case"rg8uint":return void Ya(f,M,"8uint",2,O);case"rg8sint":return void Ya(f,M,"8sint",2,O);case"rgba8unorm-srgb":case"rgba8unorm":case"bgra8unorm-srgb":case"bgra8unorm":return void Ya(f,M,"8unorm",4,O);case"rgba8snorm":return void Ya(f,M,"8snorm",4,O);case"rgba8uint":return void Ya(f,M,"8uint",4,O);case"rgba8sint":return void Ya(f,M,"8sint",4,O);case"r16uint":return void Ya(f,M,"16uint",1,O);case"r16sint":return void Ya(f,M,"16sint",1,O);case"r16float":return void Ya(f,M,"16float",1,O);case"rg16uint":return void Ya(f,M,"16uint",2,O);case"rg16sint":return void Ya(f,M,"16sint",2,O);case"rg16float":return void Ya(f,M,"16float",2,O);case"rgba16uint":return void Ya(f,M,"16uint",4,O);case"rgba16sint":return void Ya(f,M,"16sint",4,O);case"rgba16float":return void Ya(f,M,"16float",4,O);case"r32uint":return void Ya(f,M,"32uint",1,O);case"r32sint":return void Ya(f,M,"32sint",1,O);case"depth16unorm":case"depth24plus":case"depth24plus-stencil8":case"depth32float":case"depth32float-stencil8":case"r32float":return void Ya(f,M,"32float",1,O);case"rg32uint":return void Ya(f,M,"32uint",2,O);case"rg32sint":return void Ya(f,M,"32sint",2,O);case"rg32float":return void Ya(f,M,"32float",2,O);case"rgba32uint":return void Ya(f,M,"32uint",4,O);case"rgba32sint":return void Ya(f,M,"32sint",4,O);case"rgba32float":return void Ya(f,M,"32float",4,O);case"rg11b10ufloat":console.error("TODO: rg11b10ufloat not supported for writing")}})(new Uint8Array(h),e,r,n,i,u,o,s,this.format,a)}}(t=>{t[t.token=0]="token",t[t.keyword=1]="keyword",t[t.reserved=2]="reserved"})(or||(or={}));class sr{constructor(e,r,n){this.name=e,this.type=r,this.rule=n}toString(){return this.name}}class gt{}br=gt,gt.none=new sr("",or.reserved,""),gt.eof=new sr("EOF",or.token,""),gt.reserved={asm:new sr("asm",or.reserved,"asm"),bf16:new sr("bf16",or.reserved,"bf16"),do:new sr("do",or.reserved,"do"),enum:new sr("enum",or.reserved,"enum"),f16:new sr("f16",or.reserved,"f16"),f64:new sr("f64",or.reserved,"f64"),handle:new sr("handle",or.reserved,"handle"),i8:new sr("i8",or.reserved,"i8"),i16:new sr("i16",or.reserved,"i16"),i64:new sr("i64",or.reserved,"i64"),mat:new sr("mat",or.reserved,"mat"),premerge:new sr("premerge",or.reserved,"premerge"),regardless:new sr("regardless",or.reserved,"regardless"),typedef:new sr("typedef",or.reserved,"typedef"),u8:new sr("u8",or.reserved,"u8"),u16:new sr("u16",or.reserved,"u16"),u64:new sr("u64",or.reserved,"u64"),unless:new sr("unless",or.reserved,"unless"),using:new sr("using",or.reserved,"using"),vec:new sr("vec",or.reserved,"vec"),void:new sr("void",or.reserved,"void")},gt.keywords={array:new sr("array",or.keyword,"array"),atomic:new sr("atomic",or.keyword,"atomic"),bool:new sr("bool",or.keyword,"bool"),f32:new sr("f32",or.keyword,"f32"),i32:new sr("i32",or.keyword,"i32"),mat2x2:new sr("mat2x2",or.keyword,"mat2x2"),mat2x3:new sr("mat2x3",or.keyword,"mat2x3"),mat2x4:new sr("mat2x4",or.keyword,"mat2x4"),mat3x2:new sr("mat3x2",or.keyword,"mat3x2"),mat3x3:new sr("mat3x3",or.keyword,"mat3x3"),mat3x4:new sr("mat3x4",or.keyword,"mat3x4"),mat4x2:new sr("mat4x2",or.keyword,"mat4x2"),mat4x3:new sr("mat4x3",or.keyword,"mat4x3"),mat4x4:new sr("mat4x4",or.keyword,"mat4x4"),ptr:new sr("ptr",or.keyword,"ptr"),sampler:new sr("sampler",or.keyword,"sampler"),sampler_comparison:new sr("sampler_comparison",or.keyword,"sampler_comparison"),struct:new sr("struct",or.keyword,"struct"),texture_1d:new sr("texture_1d",or.keyword,"texture_1d"),texture_2d:new sr("texture_2d",or.keyword,"texture_2d"),texture_2d_array:new sr("texture_2d_array",or.keyword,"texture_2d_array"),texture_3d:new sr("texture_3d",or.keyword,"texture_3d"),texture_cube:new sr("texture_cube",or.keyword,"texture_cube"),texture_cube_array:new sr("texture_cube_array",or.keyword,"texture_cube_array"),texture_multisampled_2d:new sr("texture_multisampled_2d",or.keyword,"texture_multisampled_2d"),texture_storage_1d:new sr("texture_storage_1d",or.keyword,"texture_storage_1d"),texture_storage_2d:new sr("texture_storage_2d",or.keyword,"texture_storage_2d"),texture_storage_2d_array:new sr("texture_storage_2d_array",or.keyword,"texture_storage_2d_array"),texture_storage_3d:new sr("texture_storage_3d",or.keyword,"texture_storage_3d"),texture_depth_2d:new sr("texture_depth_2d",or.keyword,"texture_depth_2d"),texture_depth_2d_array:new sr("texture_depth_2d_array",or.keyword,"texture_depth_2d_array"),texture_depth_cube:new sr("texture_depth_cube",or.keyword,"texture_depth_cube"),texture_depth_cube_array:new sr("texture_depth_cube_array",or.keyword,"texture_depth_cube_array"),texture_depth_multisampled_2d:new sr("texture_depth_multisampled_2d",or.keyword,"texture_depth_multisampled_2d"),texture_external:new sr("texture_external",or.keyword,"texture_external"),u32:new sr("u32",or.keyword,"u32"),vec2:new sr("vec2",or.keyword,"vec2"),vec3:new sr("vec3",or.keyword,"vec3"),vec4:new sr("vec4",or.keyword,"vec4"),bitcast:new sr("bitcast",or.keyword,"bitcast"),block:new sr("block",or.keyword,"block"),break:new sr("break",or.keyword,"break"),case:new sr("case",or.keyword,"case"),continue:new sr("continue",or.keyword,"continue"),continuing:new sr("continuing",or.keyword,"continuing"),default:new sr("default",or.keyword,"default"),diagnostic:new sr("diagnostic",or.keyword,"diagnostic"),discard:new sr("discard",or.keyword,"discard"),else:new sr("else",or.keyword,"else"),enable:new sr("enable",or.keyword,"enable"),fallthrough:new sr("fallthrough",or.keyword,"fallthrough"),false:new sr("false",or.keyword,"false"),fn:new sr("fn",or.keyword,"fn"),for:new sr("for",or.keyword,"for"),function:new sr("function",or.keyword,"function"),if:new sr("if",or.keyword,"if"),let:new sr("let",or.keyword,"let"),const:new sr("const",or.keyword,"const"),loop:new sr("loop",or.keyword,"loop"),while:new sr("while",or.keyword,"while"),private:new sr("private",or.keyword,"private"),read:new sr("read",or.keyword,"read"),read_write:new sr("read_write",or.keyword,"read_write"),return:new sr("return",or.keyword,"return"),requires:new sr("requires",or.keyword,"requires"),storage:new sr("storage",or.keyword,"storage"),switch:new sr("switch",or.keyword,"switch"),true:new sr("true",or.keyword,"true"),alias:new sr("alias",or.keyword,"alias"),type:new sr("type",or.keyword,"type"),uniform:new sr("uniform",or.keyword,"uniform"),var:new sr("var",or.keyword,"var"),override:new sr("override",or.keyword,"override"),workgroup:new sr("workgroup",or.keyword,"workgroup"),write:new sr("write",or.keyword,"write"),r8unorm:new sr("r8unorm",or.keyword,"r8unorm"),r8snorm:new sr("r8snorm",or.keyword,"r8snorm"),r8uint:new sr("r8uint",or.keyword,"r8uint"),r8sint:new sr("r8sint",or.keyword,"r8sint"),r16uint:new sr("r16uint",or.keyword,"r16uint"),r16sint:new sr("r16sint",or.keyword,"r16sint"),r16float:new sr("r16float",or.keyword,"r16float"),rg8unorm:new sr("rg8unorm",or.keyword,"rg8unorm"),rg8snorm:new sr("rg8snorm",or.keyword,"rg8snorm"),rg8uint:new sr("rg8uint",or.keyword,"rg8uint"),rg8sint:new sr("rg8sint",or.keyword,"rg8sint"),r32uint:new sr("r32uint",or.keyword,"r32uint"),r32sint:new sr("r32sint",or.keyword,"r32sint"),r32float:new sr("r32float",or.keyword,"r32float"),rg16uint:new sr("rg16uint",or.keyword,"rg16uint"),rg16sint:new sr("rg16sint",or.keyword,"rg16sint"),rg16float:new sr("rg16float",or.keyword,"rg16float"),rgba8unorm:new sr("rgba8unorm",or.keyword,"rgba8unorm"),rgba8unorm_srgb:new sr("rgba8unorm_srgb",or.keyword,"rgba8unorm_srgb"),rgba8snorm:new sr("rgba8snorm",or.keyword,"rgba8snorm"),rgba8uint:new sr("rgba8uint",or.keyword,"rgba8uint"),rgba8sint:new sr("rgba8sint",or.keyword,"rgba8sint"),bgra8unorm:new sr("bgra8unorm",or.keyword,"bgra8unorm"),bgra8unorm_srgb:new sr("bgra8unorm_srgb",or.keyword,"bgra8unorm_srgb"),rgb10a2unorm:new sr("rgb10a2unorm",or.keyword,"rgb10a2unorm"),rg11b10float:new sr("rg11b10float",or.keyword,"rg11b10float"),rg32uint:new sr("rg32uint",or.keyword,"rg32uint"),rg32sint:new sr("rg32sint",or.keyword,"rg32sint"),rg32float:new sr("rg32float",or.keyword,"rg32float"),rgba16uint:new sr("rgba16uint",or.keyword,"rgba16uint"),rgba16sint:new sr("rgba16sint",or.keyword,"rgba16sint"),rgba16float:new sr("rgba16float",or.keyword,"rgba16float"),rgba32uint:new sr("rgba32uint",or.keyword,"rgba32uint"),rgba32sint:new sr("rgba32sint",or.keyword,"rgba32sint"),rgba32float:new sr("rgba32float",or.keyword,"rgba32float"),static_assert:new sr("static_assert",or.keyword,"static_assert")},gt.tokens={decimal_float_literal:new sr("decimal_float_literal",or.token,/((-?[0-9]*\.[0-9]+|-?[0-9]+\.[0-9]*)((e|E)(\+|-)?[0-9]+)?[fh]?)|(-?[0-9]+(e|E)(\+|-)?[0-9]+[fh]?)|(-?[0-9]+[fh])/),hex_float_literal:new sr("hex_float_literal",or.token,/-?0x((([0-9a-fA-F]*\.[0-9a-fA-F]+|[0-9a-fA-F]+\.[0-9a-fA-F]*)((p|P)(\+|-)?[0-9]+[fh]?)?)|([0-9a-fA-F]+(p|P)(\+|-)?[0-9]+[fh]?))/),int_literal:new sr("int_literal",or.token,/-?0x[0-9a-fA-F]+|0i?|-?[1-9][0-9]*i?/),uint_literal:new sr("uint_literal",or.token,/0x[0-9a-fA-F]+u|0u|[1-9][0-9]*u/),name:new sr("name",or.token,/([_\p{XID_Start}][\p{XID_Continue}]+)|([\p{XID_Start}])/u),ident:new sr("ident",or.token,/[_a-zA-Z][0-9a-zA-Z_]*/),and:new sr("and",or.token,"&"),and_and:new sr("and_and",or.token,"&&"),arrow:new sr("arrow ",or.token,"->"),attr:new sr("attr",or.token,"@"),forward_slash:new sr("forward_slash",or.token,"/"),bang:new sr("bang",or.token,"!"),bracket_left:new sr("bracket_left",or.token,"["),bracket_right:new sr("bracket_right",or.token,"]"),brace_left:new sr("brace_left",or.token,"{"),brace_right:new sr("brace_right",or.token,"}"),colon:new sr("colon",or.token,":"),comma:new sr("comma",or.token,","),equal:new sr("equal",or.token,"="),equal_equal:new sr("equal_equal",or.token,"=="),not_equal:new sr("not_equal",or.token,"!="),greater_than:new sr("greater_than",or.token,">"),greater_than_equal:new sr("greater_than_equal",or.token,">="),shift_right:new sr("shift_right",or.token,">>"),less_than:new sr("less_than",or.token,"<"),less_than_equal:new sr("less_than_equal",or.token,"<="),shift_left:new sr("shift_left",or.token,"<<"),modulo:new sr("modulo",or.token,"%"),minus:new sr("minus",or.token,"-"),minus_minus:new sr("minus_minus",or.token,"--"),period:new sr("period",or.token,"."),plus:new sr("plus",or.token,"+"),plus_plus:new sr("plus_plus",or.token,"++"),or:new sr("or",or.token,"|"),or_or:new sr("or_or",or.token,"||"),paren_left:new sr("paren_left",or.token,"("),paren_right:new sr("paren_right",or.token,")"),semicolon:new sr("semicolon",or.token,";"),star:new sr("star",or.token,"*"),tilde:new sr("tilde",or.token,"~"),underscore:new sr("underscore",or.token,"_"),xor:new sr("xor",or.token,"^"),plus_equal:new sr("plus_equal",or.token,"+="),minus_equal:new sr("minus_equal",or.token,"-="),times_equal:new sr("times_equal",or.token,"*="),division_equal:new sr("division_equal",or.token,"/="),modulo_equal:new sr("modulo_equal",or.token,"%="),and_equal:new sr("and_equal",or.token,"&="),or_equal:new sr("or_equal",or.token,"|="),xor_equal:new sr("xor_equal",or.token,"^="),shift_right_equal:new sr("shift_right_equal",or.token,">>="),shift_left_equal:new sr("shift_left_equal",or.token,"<<=")},gt.simpleTokens={"@":br.tokens.attr,"{":br.tokens.brace_left,"}":br.tokens.brace_right,":":br.tokens.colon,",":br.tokens.comma,"(":br.tokens.paren_left,")":br.tokens.paren_right,";":br.tokens.semicolon},gt.literalTokens={"&":br.tokens.and,"&&":br.tokens.and_and,"->":br.tokens.arrow,"/":br.tokens.forward_slash,"!":br.tokens.bang,"[":br.tokens.bracket_left,"]":br.tokens.bracket_right,"=":br.tokens.equal,"==":br.tokens.equal_equal,"!=":br.tokens.not_equal,">":br.tokens.greater_than,">=":br.tokens.greater_than_equal,">>":br.tokens.shift_right,"<":br.tokens.less_than,"<=":br.tokens.less_than_equal,"<<":br.tokens.shift_left,"%":br.tokens.modulo,"-":br.tokens.minus,"--":br.tokens.minus_minus,".":br.tokens.period,"+":br.tokens.plus,"++":br.tokens.plus_plus,"|":br.tokens.or,"||":br.tokens.or_or,"*":br.tokens.star,"~":br.tokens.tilde,_:br.tokens.underscore,"^":br.tokens.xor,"+=":br.tokens.plus_equal,"-=":br.tokens.minus_equal,"*=":br.tokens.times_equal,"/=":br.tokens.division_equal,"%=":br.tokens.modulo_equal,"&=":br.tokens.and_equal,"|=":br.tokens.or_equal,"^=":br.tokens.xor_equal,">>=":br.tokens.shift_right_equal,"<<=":br.tokens.shift_left_equal},gt.regexTokens={decimal_float_literal:br.tokens.decimal_float_literal,hex_float_literal:br.tokens.hex_float_literal,int_literal:br.tokens.int_literal,uint_literal:br.tokens.uint_literal,ident:br.tokens.ident},gt.storage_class=[br.keywords.function,br.keywords.private,br.keywords.workgroup,br.keywords.uniform,br.keywords.storage],gt.access_mode=[br.keywords.read,br.keywords.write,br.keywords.read_write],gt.sampler_type=[br.keywords.sampler,br.keywords.sampler_comparison],gt.sampled_texture_type=[br.keywords.texture_1d,br.keywords.texture_2d,br.keywords.texture_2d_array,br.keywords.texture_3d,br.keywords.texture_cube,br.keywords.texture_cube_array],gt.multisampled_texture_type=[br.keywords.texture_multisampled_2d],gt.storage_texture_type=[br.keywords.texture_storage_1d,br.keywords.texture_storage_2d,br.keywords.texture_storage_2d_array,br.keywords.texture_storage_3d],gt.depth_texture_type=[br.keywords.texture_depth_2d,br.keywords.texture_depth_2d_array,br.keywords.texture_depth_cube,br.keywords.texture_depth_cube_array,br.keywords.texture_depth_multisampled_2d],gt.texture_external_type=[br.keywords.texture_external],gt.any_texture_type=[...br.sampled_texture_type,...br.multisampled_texture_type,...br.storage_texture_type,...br.depth_texture_type,...br.texture_external_type],gt.texel_format=[br.keywords.r8unorm,br.keywords.r8snorm,br.keywords.r8uint,br.keywords.r8sint,br.keywords.r16uint,br.keywords.r16sint,br.keywords.r16float,br.keywords.rg8unorm,br.keywords.rg8snorm,br.keywords.rg8uint,br.keywords.rg8sint,br.keywords.r32uint,br.keywords.r32sint,br.keywords.r32float,br.keywords.rg16uint,br.keywords.rg16sint,br.keywords.rg16float,br.keywords.rgba8unorm,br.keywords.rgba8unorm_srgb,br.keywords.rgba8snorm,br.keywords.rgba8uint,br.keywords.rgba8sint,br.keywords.bgra8unorm,br.keywords.bgra8unorm_srgb,br.keywords.rgb10a2unorm,br.keywords.rg11b10float,br.keywords.rg32uint,br.keywords.rg32sint,br.keywords.rg32float,br.keywords.rgba16uint,br.keywords.rgba16sint,br.keywords.rgba16float,br.keywords.rgba32uint,br.keywords.rgba32sint,br.keywords.rgba32float],gt.const_literal=[br.tokens.int_literal,br.tokens.uint_literal,br.tokens.decimal_float_literal,br.tokens.hex_float_literal,br.keywords.true,br.keywords.false],gt.literal_or_ident=[br.tokens.ident,br.tokens.int_literal,br.tokens.uint_literal,br.tokens.decimal_float_literal,br.tokens.hex_float_literal,br.tokens.name],gt.element_count_expression=[br.tokens.int_literal,br.tokens.uint_literal,br.tokens.ident],gt.template_types=[br.keywords.vec2,br.keywords.vec3,br.keywords.vec4,br.keywords.mat2x2,br.keywords.mat2x3,br.keywords.mat2x4,br.keywords.mat3x2,br.keywords.mat3x3,br.keywords.mat3x4,br.keywords.mat4x2,br.keywords.mat4x3,br.keywords.mat4x4,br.keywords.atomic,br.keywords.bitcast,...br.any_texture_type],gt.attribute_name=[br.tokens.ident,br.keywords.block,br.keywords.diagnostic],gt.assignment_operators=[br.tokens.equal,br.tokens.plus_equal,br.tokens.minus_equal,br.tokens.times_equal,br.tokens.division_equal,br.tokens.modulo_equal,br.tokens.and_equal,br.tokens.or_equal,br.tokens.xor_equal,br.tokens.shift_right_equal,br.tokens.shift_left_equal],gt.increment_operators=[br.tokens.plus_plus,br.tokens.minus_minus];class kq{constructor(e,r,n,i,a){this.type=e,this.lexeme=r,this.line=n,this.start=i,this.end=a}toString(){return this.lexeme}isTemplateType(){return gt.template_types.indexOf(this.type)!=-1}isArrayType(){return this.type==gt.keywords.array}isArrayOrTemplateType(){return this.isArrayType()||this.isTemplateType()}}class ZBe{constructor(e){this._tokens=[],this._start=0,this._current=0,this._line=1,this._source=e??""}scanTokens(){for(;!this._isAtEnd();)if(this._start=this._current,!this.scanToken())throw`Invalid syntax at line ${this._line}`;return this._tokens.push(new kq(gt.eof,"",this._line,this._current,this._current)),this._tokens}scanToken(){let e=this._advance();if(e==`
`)return this._line++,!0;if(this._isWhitespace(e))return!0;if(e=="/"){if(this._peekAhead()=="/"){for(;e!=`
`;){if(this._isAtEnd())return!0;e=this._advance()}return this._line++,!0}if(this._peekAhead()=="*"){this._advance();let s=1;for(;s>0;){if(this._isAtEnd())return!0;if(e=this._advance(),e==`
`)this._line++;else if(e=="*"){if(this._peekAhead()=="/"&&(this._advance(),s--,s==0))return!0}else e=="/"&&this._peekAhead()=="*"&&(this._advance(),s++)}return!0}}const r=gt.simpleTokens[e];if(r)return this._addToken(r),!0;let n=gt.none;const i=this._isAlpha(e),a=e==="_";if(this._isAlphaNumeric(e)){let s=this._peekAhead();for(;this._isAlphaNumeric(s);)e+=this._advance(),s=this._peekAhead()}if(i){const s=gt.keywords[e];if(s)return this._addToken(s),!0}if(i||a)return this._addToken(gt.tokens.ident),!0;for(;;){let s=this._findType(e);const o=this._peekAhead();if(e=="-"&&this._tokens.length>0){if(o=="=")return this._current++,e+=o,this._addToken(gt.tokens.minus_equal),!0;if(o=="-")return this._current++,e+=o,this._addToken(gt.tokens.minus_minus),!0;const u=this._tokens.length-1;if((gt.literal_or_ident.indexOf(this._tokens[u].type)!=-1||this._tokens[u].type==gt.tokens.paren_right)&&o!=">")return this._addToken(s),!0}if(e==">"&&(o==">"||o=="=")){let u=!1,h=this._tokens.length-1;for(let f=0;f<5&&h>=0&&gt.assignment_operators.indexOf(this._tokens[h].type)===-1;++f,--h)if(this._tokens[h].type===gt.tokens.less_than){h>0&&this._tokens[h-1].isArrayOrTemplateType()&&(u=!0);break}if(u)return this._addToken(s),!0}if(s===gt.none){let u=e,h=0;const f=2;for(let g=0;g<f;++g)if(u+=this._peekAhead(g),s=this._findType(u),s!==gt.none){h=g;break}if(s===gt.none)return n!==gt.none&&(this._current--,this._addToken(n),!0);e=u,this._current+=h+1}if(n=s,this._isAtEnd())break;e+=this._advance()}return n!==gt.none&&(this._addToken(n),!0)}_findType(e){for(const n in gt.regexTokens){const i=gt.regexTokens[n];if(this._match(e,i.rule))return i}return gt.literalTokens[e]||gt.none}_match(e,r){const n=r.exec(e);return n&&n.index==0&&n[0]==e}_isAtEnd(){return this._current>=this._source.length}_isAlpha(e){return!this._isNumeric(e)&&!this._isWhitespace(e)&&e!=="_"&&e!=="."&&e!=="("&&e!==")"&&e!=="["&&e!=="]"&&e!=="{"&&e!=="}"&&e!==","&&e!==";"&&e!==":"&&e!=="="&&e!=="!"&&e!=="<"&&e!==">"&&e!=="+"&&e!=="-"&&e!=="*"&&e!=="/"&&e!=="%"&&e!=="&"&&e!=="|"&&e!=="^"&&e!=="~"&&e!=="@"&&e!=="#"&&e!=="?"&&e!=="'"&&e!=="`"&&e!=='"'&&e!=="\\"&&e!==`
`&&e!=="\r"&&e!=="	"&&e!=="\0"}_isNumeric(e){return e>="0"&&e<="9"}_isAlphaNumeric(e){return this._isAlpha(e)||this._isNumeric(e)||e==="_"}_isWhitespace(e){return e==" "||e=="	"||e=="\r"}_advance(e=0){let r=this._source[this._current];return e=e||0,e++,this._current+=e,r}_peekAhead(e=0){return e=e||0,this._current+e>=this._source.length?"\0":this._source[this._current+e]}_addToken(e){const r=this._source.substring(this._start,this._current);this._tokens.push(new kq(e,r,this._line,this._start,this._current))}}function Mn(t){return Array.isArray(t)||t?.buffer instanceof ArrayBuffer}const gE=new Float32Array(1),KBe=new Uint32Array(gE.buffer),JBe=new Uint32Array(gE.buffer),mE=new Int32Array(1),QBe=new Float32Array(mE.buffer),eze=new Uint32Array(mE.buffer),yE=new Uint32Array(1),tze=new Float32Array(yE.buffer),rze=new Int32Array(yE.buffer);function Mq(t,e,r){if(e===r)return t;if(e==="f32"){if(r==="i32"||r==="x32")return gE[0]=t,KBe[0];if(r==="u32")return gE[0]=t,JBe[0]}else if(e==="i32"||e==="x32"){if(r==="f32")return mE[0]=t,QBe[0];if(r==="u32")return mE[0]=t,eze[0]}else if(e==="u32"){if(r==="f32")return yE[0]=t,tze[0];if(r==="i32"||r==="x32")return yE[0]=t,rze[0]}return console.error(`Unsupported cast from ${e} to ${r}`),t}class nze{constructor(e){this.resources=null,this.inUse=!1,this.info=null,this.node=e}}class Y2{constructor(e,r){this.align=e,this.size=r}}class Gf{constructor(){this.uniforms=[],this.storage=[],this.textures=[],this.samplers=[],this.aliases=[],this.overrides=[],this.structs=[],this.entry=new zBe,this.functions=[],this._types=new Map,this._functions=new Map}_isStorageTexture(e){return e.name=="texture_storage_1d"||e.name=="texture_storage_2d"||e.name=="texture_storage_2d_array"||e.name=="texture_storage_3d"}updateAST(e){for(const r of e)r instanceof Cb&&this._functions.set(r.name,new nze(r));for(const r of e)if(r instanceof kd){const n=this.getTypeInfo(r,null);n instanceof zp&&this.structs.push(n)}for(const r of e)if(r instanceof jN)this.aliases.push(this._getAliasInfo(r));else{if(r instanceof BN){const n=r,i=this._getAttributeNum(n.attributes,"id",0),a=n.type!=null?this.getTypeInfo(n.type,n.attributes):null;this.overrides.push(new DBe(n.name,a,n.attributes,i));continue}if(this._isUniformVar(r)){const n=r,i=this._getAttributeNum(n.attributes,"group",0),a=this._getAttributeNum(n.attributes,"binding",0),s=this.getTypeInfo(n.type,n.attributes),o=new X2(n.name,s,i,a,n.attributes,Mp.Uniform,n.access);o.access||(o.access="read"),this.uniforms.push(o);continue}if(this._isStorageVar(r)){const n=r,i=this._getAttributeNum(n.attributes,"group",0),a=this._getAttributeNum(n.attributes,"binding",0),s=this.getTypeInfo(n.type,n.attributes),o=this._isStorageTexture(s),u=new X2(n.name,s,i,a,n.attributes,o?Mp.StorageTexture:Mp.Storage,n.access);u.access||(u.access="read"),this.storage.push(u);continue}if(this._isTextureVar(r)){const n=r,i=this._getAttributeNum(n.attributes,"group",0),a=this._getAttributeNum(n.attributes,"binding",0),s=this.getTypeInfo(n.type,n.attributes),o=this._isStorageTexture(s),u=new X2(n.name,s,i,a,n.attributes,o?Mp.StorageTexture:Mp.Texture,n.access);u.access||(u.access="read"),o?this.storage.push(u):this.textures.push(u);continue}if(this._isSamplerVar(r)){const n=r,i=this._getAttributeNum(n.attributes,"group",0),a=this._getAttributeNum(n.attributes,"binding",0),s=this.getTypeInfo(n.type,n.attributes),o=new X2(n.name,s,i,a,n.attributes,Mp.Sampler,n.access);this.samplers.push(o);continue}}for(const r of e)if(r instanceof Cb){const n=this._getAttribute(r,"vertex"),i=this._getAttribute(r,"fragment"),a=this._getAttribute(r,"compute"),s=n||i||a,o=new BBe(r.name,s?.name,r.attributes);o.attributes=r.attributes,o.startLine=r.startLine,o.endLine=r.endLine,this.functions.push(o),this._functions.get(r.name).info=o,s&&(this._functions.get(r.name).inUse=!0,o.inUse=!0,o.resources=this._findResources(r,!!s),o.inputs=this._getInputs(r.args),o.outputs=this._getOutputs(r.returnType),this.entry[s.name].push(o)),o.arguments=r.args.map(u=>new FBe(u.name,this.getTypeInfo(u.type,u.attributes),u.attributes)),o.returnType=r.returnType?this.getTypeInfo(r.returnType,r.attributes):null;continue}for(const r of this._functions.values())r.info&&(r.info.inUse=r.inUse,this._addCalls(r.node,r.info.calls));for(const r of this._functions.values())r.node.search(n=>{var i,a,s;if(n instanceof Hee){if(n.value)if(Mn(n.value))for(const o of n.value)for(const u of this.overrides)o===u.name&&((i=r.info)===null||i===void 0||i.overrides.push(u));else for(const o of this.overrides)n.value===o.name&&((a=r.info)===null||a===void 0||a.overrides.push(o))}else if(n instanceof Xc)for(const o of this.overrides)n.name===o.name&&((s=r.info)===null||s===void 0||s.overrides.push(o))});for(const r of this.uniforms)this._markStructsInUse(r.type);for(const r of this.storage)this._markStructsInUse(r.type)}getFunctionInfo(e){for(const r of this.functions)if(r.name==e)return r;return null}getStructInfo(e){for(const r of this.structs)if(r.name==e)return r;return null}getOverrideInfo(e){for(const r of this.overrides)if(r.name==e)return r;return null}_markStructsInUse(e){if(e)if(e.isStruct){if(e.inUse=!0,e.members)for(const r of e.members)this._markStructsInUse(r.type)}else if(e.isArray)this._markStructsInUse(e.format);else if(e.isTemplate)e.format&&this._markStructsInUse(e.format);else{const r=this._getAlias(e.name);r&&this._markStructsInUse(r)}}_addCalls(e,r){var n;for(const i of e.calls){const a=(n=this._functions.get(i.name))===null||n===void 0?void 0:n.info;a&&r.add(a)}}findResource(e,r,n){if(n){for(const i of this.entry.compute)if(i.name===n){for(const a of i.resources)if(a.group==e&&a.binding==r)return a}for(const i of this.entry.vertex)if(i.name===n){for(const a of i.resources)if(a.group==e&&a.binding==r)return a}for(const i of this.entry.fragment)if(i.name===n){for(const a of i.resources)if(a.group==e&&a.binding==r)return a}}for(const i of this.uniforms)if(i.group==e&&i.binding==r)return i;for(const i of this.storage)if(i.group==e&&i.binding==r)return i;for(const i of this.textures)if(i.group==e&&i.binding==r)return i;for(const i of this.samplers)if(i.group==e&&i.binding==r)return i;return null}_findResource(e){for(const r of this.uniforms)if(r.name==e)return r;for(const r of this.storage)if(r.name==e)return r;for(const r of this.textures)if(r.name==e)return r;for(const r of this.samplers)if(r.name==e)return r;return null}_markStructsFromAST(e){const r=this.getTypeInfo(e,null);this._markStructsInUse(r)}_findResources(e,r){const n=[],i=this,a=[];return e.search(s=>{if(s instanceof dE)a.push({});else if(s instanceof pE)a.pop();else if(s instanceof Ld){const o=s;r&&o.type!==null&&this._markStructsFromAST(o.type),a.length>0&&(a[a.length-1][o.name]=o)}else if(s instanceof jf){const o=s;r&&o.type!==null&&this._markStructsFromAST(o.type)}else if(s instanceof B1){const o=s;r&&o.type!==null&&this._markStructsFromAST(o.type),a.length>0&&(a[a.length-1][o.name]=o)}else if(s instanceof Xc){const o=s;if(a.length>0&&a[a.length-1][o.name])return;const u=i._findResource(o.name);u&&n.push(u)}else if(s instanceof UN){const o=s,u=i._functions.get(o.name);u&&(r&&(u.inUse=!0),e.calls.add(u.node),u.resources===null&&(u.resources=i._findResources(u.node,r)),n.push(...u.resources))}else if(s instanceof zN){const o=s,u=i._functions.get(o.name);u&&(r&&(u.inUse=!0),e.calls.add(u.node),u.resources===null&&(u.resources=i._findResources(u.node,r)),n.push(...u.resources))}}),[...new Map(n.map(s=>[s.name,s])).values()]}getBindGroups(){const e=[];function r(n,i){n>=e.length&&(e.length=n+1),e[n]===void 0&&(e[n]=[]),i>=e[n].length&&(e[n].length=i+1)}for(const n of this.uniforms)r(n.group,n.binding),e[n.group][n.binding]=n;for(const n of this.storage)r(n.group,n.binding),e[n.group][n.binding]=n;for(const n of this.textures)r(n.group,n.binding),e[n.group][n.binding]=n;for(const n of this.samplers)r(n.group,n.binding),e[n.group][n.binding]=n;return e}_getOutputs(e,r=void 0){if(r===void 0&&(r=[]),e instanceof kd)this._getStructOutputs(e,r);else{const n=this._getOutputInfo(e);n!==null&&r.push(n)}return r}_getStructOutputs(e,r){for(const n of e.members)if(n.type instanceof kd)this._getStructOutputs(n.type,r);else{const i=this._getAttribute(n,"location")||this._getAttribute(n,"builtin");if(i!==null){const a=this.getTypeInfo(n.type,n.type.attributes),s=this._parseInt(i.value),o=new Tq(n.name,a,i.name,s);r.push(o)}}}_getOutputInfo(e){const r=this._getAttribute(e,"location")||this._getAttribute(e,"builtin");if(r!==null){const n=this.getTypeInfo(e,e.attributes),i=this._parseInt(r.value);return new Tq("",n,r.name,i)}return null}_getInputs(e,r=void 0){r===void 0&&(r=[]);for(const n of e)if(n.type instanceof kd)this._getStructInputs(n.type,r);else{const i=this._getInputInfo(n);i!==null&&r.push(i)}return r}_getStructInputs(e,r){for(const n of e.members)if(n.type instanceof kd)this._getStructInputs(n.type,r);else{const i=this._getInputInfo(n);i!==null&&r.push(i)}}_getInputInfo(e){const r=this._getAttribute(e,"location")||this._getAttribute(e,"builtin");if(r!==null){const n=this._getAttribute(e,"interpolation"),i=this.getTypeInfo(e.type,e.attributes),a=this._parseInt(r.value),s=new NBe(e.name,i,r.name,a);return n!==null&&(s.interpolation=this._parseString(n.value)),s}return null}_parseString(e){return e instanceof Array&&(e=e[0]),e}_parseInt(e){e instanceof Array&&(e=e[0]);const r=parseInt(e);return isNaN(r)?e:r}_getAlias(e){for(const r of this.aliases)if(r.name==e)return r.type;return null}_getAliasInfo(e){return new LBe(e.name,this.getTypeInfo(e.type,null))}getTypeInfoByName(e){for(const r of this.structs)if(r.name==e)return r;for(const r of this.aliases)if(r.name==e)return r.type;return null}getTypeInfo(e,r=null){if(this._types.has(e))return this._types.get(e);if(e instanceof Rw){const i=e.type?this.getTypeInfo(e.type,e.attributes):null,a=new HM(e.name,i,r);return this._types.set(e,a),this._updateTypeInfo(a),a}if(e instanceof z1){const i=e,a=i.format?this.getTypeInfo(i.format,i.attributes):null,s=new Gp(i.name,r);return s.format=a,s.count=i.count,this._types.set(e,s),this._updateTypeInfo(s),s}if(e instanceof kd){const i=e,a=new zp(i.name,r);a.startLine=i.startLine,a.endLine=i.endLine;for(const s of i.members){const o=this.getTypeInfo(s.type,s.attributes);a.members.push(new Eq(s.name,o,s.attributes))}return this._types.set(e,a),this._updateTypeInfo(a),a}if(e instanceof p1){const i=e,a=i.format instanceof Xr,s=i.format?a?this.getTypeInfo(i.format,null):new wh(i.format,null):null,o=new Mm(i.name,s,r,i.access);return this._types.set(e,o),this._updateTypeInfo(o),o}if(e instanceof hr){const i=e,a=i.format?this.getTypeInfo(i.format,null):null,s=new Mm(i.name,a,r,i.access);return this._types.set(e,s),this._updateTypeInfo(s),s}const n=new wh(e.name,r);return this._types.set(e,n),this._updateTypeInfo(n),n}_updateTypeInfo(e){var r,n,i;const a=this._getTypeSize(e);if(e.size=(r=a?.size)!==null&&r!==void 0?r:0,e instanceof Gp&&e.format){const s=this._getTypeSize(e.format);e.stride=Math.max((n=s?.size)!==null&&n!==void 0?n:0,(i=s?.align)!==null&&i!==void 0?i:0),this._updateTypeInfo(e.format)}e instanceof HM&&this._updateTypeInfo(e.format),e instanceof zp&&this._updateStructInfo(e)}_updateStructInfo(e){var r;let n=0,i=0,a=0,s=0;for(let o=0,u=e.members.length;o<u;++o){const h=e.members[o],f=this._getTypeSize(h);if(!f)continue;(r=this._getAlias(h.type.name))!==null&&r!==void 0||h.type;const g=f.align,b=f.size;n=this._roundUp(g,n+i),i=b,a=n,s=Math.max(s,g),h.offset=n,h.size=b,this._updateTypeInfo(h.type)}e.size=this._roundUp(s,a+i),e.align=s}_getTypeSize(e){var r,n;if(e==null)return null;const i=this._getAttributeNum(e.attributes,"size",0),a=this._getAttributeNum(e.attributes,"align",0);if(e instanceof Eq&&(e=e.type),e instanceof wh){const s=this._getAlias(e.name);s!==null&&(e=s)}{const s=Gf._typeInfo[e.name];if(s!==void 0){const o=((r=e.format)===null||r===void 0?void 0:r.name)==="f16"?2:1;return new Y2(Math.max(a,s.align/o),Math.max(i,s.size/o))}}{const s=Gf._typeInfo[e.name.substring(0,e.name.length-1)];if(s){const o=e.name[e.name.length-1]==="h"?2:1;return new Y2(Math.max(a,s.align/o),Math.max(i,s.size/o))}}if(e instanceof Gp){let s=e,o=8,u=8;const h=this._getTypeSize(s.format);return h!==null&&(u=h.size,o=h.align),u=s.count*this._getAttributeNum((n=e?.attributes)!==null&&n!==void 0?n:null,"stride",this._roundUp(o,u)),i&&(u=i),new Y2(Math.max(a,o),Math.max(i,u))}if(e instanceof zp){let s=0,o=0,u=0,h=0,f=0;for(const g of e.members){const b=this._getTypeSize(g.type);b!==null&&(s=Math.max(b.align,s),u=this._roundUp(b.align,u+h),h=b.size,f=u)}return o=this._roundUp(s,f+h),new Y2(Math.max(a,s),Math.max(i,o))}return null}_isUniformVar(e){return e instanceof Ld&&e.storage=="uniform"}_isStorageVar(e){return e instanceof Ld&&e.storage=="storage"}_isTextureVar(e){return e instanceof Ld&&e.type!==null&&Gf._textureTypes.indexOf(e.type.name)!=-1}_isSamplerVar(e){return e instanceof Ld&&e.type!==null&&Gf._samplerTypes.indexOf(e.type.name)!=-1}_getAttribute(e,r){const n=e;if(!n||!n.attributes)return null;const i=n.attributes;for(let a of i)if(a.name==r)return a;return null}_getAttributeNum(e,r,n){if(e===null)return n;for(let i of e)if(i.name==r){let a=i!==null&&i.value!==null?i.value:n;return a instanceof Array&&(a=a[0]),typeof a=="number"?a:typeof a=="string"?parseInt(a):n}return n}_roundUp(e,r){return Math.ceil(r/e)*e}}Gf._typeInfo={f16:{align:2,size:2},i32:{align:4,size:4},u32:{align:4,size:4},f32:{align:4,size:4},atomic:{align:4,size:4},vec2:{align:8,size:8},vec3:{align:16,size:12},vec4:{align:16,size:16},mat2x2:{align:8,size:16},mat3x2:{align:8,size:24},mat4x2:{align:8,size:32},mat2x3:{align:16,size:32},mat3x3:{align:16,size:48},mat4x3:{align:16,size:64},mat2x4:{align:16,size:32},mat3x4:{align:16,size:48},mat4x4:{align:16,size:64}},Gf._textureTypes=gt.any_texture_type.map(t=>t.name),Gf._samplerTypes=gt.sampler_type.map(t=>t.name);let VN=0;class $N{constructor(e,r,n){this.id=VN++,this.name=e,this.value=r,this.node=n}clone(){return new $N(this.name,this.value,this.node)}}class qN{constructor(e){this.id=VN++,this.name=e.name,this.node=e}clone(){return new qN(this.node)}}class HN{constructor(e){this.parent=null,this.variables=new Map,this.functions=new Map,this.currentFunctionName="",this.id=VN++,e&&(this.parent=e,this.currentFunctionName=e.currentFunctionName)}getVariable(e){var r;return this.variables.has(e)?(r=this.variables.get(e))!==null&&r!==void 0?r:null:this.parent?this.parent.getVariable(e):null}getFunction(e){var r;return this.functions.has(e)?(r=this.functions.get(e))!==null&&r!==void 0?r:null:this.parent?this.parent.getFunction(e):null}createVariable(e,r,n){this.variables.set(e,new $N(e,r,n??null))}setVariable(e,r,n){const i=this.getVariable(e);i!==null?i.value=r:this.createVariable(e,r,n)}getVariableValue(e){var r;const n=this.getVariable(e);return(r=n?.value)!==null&&r!==void 0?r:null}clone(){return new HN(this)}}class ize{evalExpression(e,r){return null}getTypeInfo(e){return null}getVariableName(e,r){return""}}class aze{constructor(e){this.exec=e}getTypeInfo(e){return this.exec.getTypeInfo(e)}All(e,r){const n=this.exec.evalExpression(e.args[0],r);let i=!0;if(n instanceof It)return n.data.forEach(a=>{a||(i=!1)}),new rr(i?1:0,this.getTypeInfo("bool"));throw new Error(`All() expects a vector argument. Line ${e.line}`)}Any(e,r){const n=this.exec.evalExpression(e.args[0],r);if(n instanceof It){const i=n.data.some(a=>a);return new rr(i?1:0,this.getTypeInfo("bool"))}throw new Error(`Any() expects a vector argument. Line ${e.line}`)}Select(e,r){const n=this.exec.evalExpression(e.args[2],r);if(!(n instanceof rr))throw new Error(`Select() expects a bool condition. Line ${e.line}`);return n.value?this.exec.evalExpression(e.args[1],r):this.exec.evalExpression(e.args[0],r)}ArrayLength(e,r){let n=e.args[0];n instanceof dl&&(n=n.right);const i=this.exec.evalExpression(n,r);if(i instanceof Ds&&i.typeInfo.size===0){const a=i.typeInfo,s=i.buffer.byteLength/a.stride;return new rr(s,this.getTypeInfo("u32"))}return new rr(i.typeInfo.size,this.getTypeInfo("u32"))}Abs(e,r){const n=this.exec.evalExpression(e.args[0],r);if(n instanceof It)return new It(n.data.map(a=>Math.abs(a)),n.typeInfo);const i=n;return new rr(Math.abs(i.value),i.typeInfo)}Acos(e,r){const n=this.exec.evalExpression(e.args[0],r);if(n instanceof It)return new It(n.data.map(a=>Math.acos(a)),n.typeInfo);const i=n;return new rr(Math.acos(i.value),n.typeInfo)}Acosh(e,r){const n=this.exec.evalExpression(e.args[0],r);if(n instanceof It)return new It(n.data.map(a=>Math.acosh(a)),n.typeInfo);const i=n;return new rr(Math.acosh(i.value),n.typeInfo)}Asin(e,r){const n=this.exec.evalExpression(e.args[0],r);if(n instanceof It)return new It(n.data.map(a=>Math.asin(a)),n.typeInfo);const i=n;return new rr(Math.asin(i.value),n.typeInfo)}Asinh(e,r){const n=this.exec.evalExpression(e.args[0],r);if(n instanceof It)return new It(n.data.map(a=>Math.asinh(a)),n.typeInfo);const i=n;return new rr(Math.asinh(i.value),n.typeInfo)}Atan(e,r){const n=this.exec.evalExpression(e.args[0],r);if(n instanceof It)return new It(n.data.map(a=>Math.atan(a)),n.typeInfo);const i=n;return new rr(Math.atan(i.value),n.typeInfo)}Atanh(e,r){const n=this.exec.evalExpression(e.args[0],r);if(n instanceof It)return new It(n.data.map(a=>Math.atanh(a)),n.typeInfo);const i=n;return new rr(Math.atanh(i.value),n.typeInfo)}Atan2(e,r){const n=this.exec.evalExpression(e.args[0],r),i=this.exec.evalExpression(e.args[1],r);if(n instanceof It&&i instanceof It)return new It(n.data.map((o,u)=>Math.atan2(o,i.data[u])),n.typeInfo);const a=n,s=i;return new rr(Math.atan2(a.value,s.value),n.typeInfo)}Ceil(e,r){const n=this.exec.evalExpression(e.args[0],r);if(n instanceof It)return new It(n.data.map(a=>Math.ceil(a)),n.typeInfo);const i=n;return new rr(Math.ceil(i.value),n.typeInfo)}_clamp(e,r,n){return Math.min(Math.max(e,r),n)}Clamp(e,r){const n=this.exec.evalExpression(e.args[0],r),i=this.exec.evalExpression(e.args[1],r),a=this.exec.evalExpression(e.args[2],r);if(n instanceof It&&i instanceof It&&a instanceof It)return new It(n.data.map((h,f)=>this._clamp(h,i.data[f],a.data[f])),n.typeInfo);const s=n,o=i,u=a;return new rr(this._clamp(s.value,o.value,u.value),n.typeInfo)}Cos(e,r){const n=this.exec.evalExpression(e.args[0],r);if(n instanceof It)return new It(n.data.map(a=>Math.cos(a)),n.typeInfo);const i=n;return new rr(Math.cos(i.value),n.typeInfo)}Cosh(e,r){const n=this.exec.evalExpression(e.args[0],r);if(n instanceof It)return new It(n.data.map(a=>Math.cosh(a)),n.typeInfo);const i=n;return new rr(Math.cos(i.value),n.typeInfo)}CountLeadingZeros(e,r){const n=this.exec.evalExpression(e.args[0],r);if(n instanceof It)return new It(n.data.map(a=>Math.clz32(a)),n.typeInfo);const i=n;return new rr(Math.clz32(i.value),n.typeInfo)}_countOneBits(e){let r=0;for(;e!==0;)1&e&&r++,e>>=1;return r}CountOneBits(e,r){const n=this.exec.evalExpression(e.args[0],r);if(n instanceof It)return new It(n.data.map(a=>this._countOneBits(a)),n.typeInfo);const i=n;return new rr(this._countOneBits(i.value),n.typeInfo)}_countTrailingZeros(e){if(e===0)return 32;let r=0;for(;!(1&e);)e>>=1,r++;return r}CountTrailingZeros(e,r){const n=this.exec.evalExpression(e.args[0],r);if(n instanceof It)return new It(n.data.map(a=>this._countTrailingZeros(a)),n.typeInfo);const i=n;return new rr(this._countTrailingZeros(i.value),n.typeInfo)}Cross(e,r){const n=this.exec.evalExpression(e.args[0],r),i=this.exec.evalExpression(e.args[1],r);if(n instanceof It&&i instanceof It){if(n.data.length!==3||i.data.length!==3)return console.error(`Cross() expects 3D vectors. Line ${e.line}`),null;const a=n.data,s=i.data;return new It([a[1]*s[2]-s[1]*a[2],a[2]*s[0]-s[2]*a[0],a[0]*s[1]-s[0]*a[1]],n.typeInfo)}return console.error(`Cross() expects vector arguments. Line ${e.line}`),null}Degrees(e,r){const n=this.exec.evalExpression(e.args[0],r),i=180/Math.PI;return n instanceof It?new It(n.data.map(a=>a*i),n.typeInfo):new rr(n.value*i,this.getTypeInfo("f32"))}Determinant(e,r){const n=this.exec.evalExpression(e.args[0],r);if(n instanceof Ai){const i=n.data,a=n.typeInfo.getTypeName(),s=a.endsWith("h")?this.getTypeInfo("f16"):this.getTypeInfo("f32");if(a==="mat2x2"||a==="mat2x2f"||a==="mat2x2h")return new rr(i[0]*i[3]-i[1]*i[2],s);if(a==="mat2x3"||a==="mat2x3f"||a==="mat2x3h")return new rr(i[0]*(i[4]*i[8]-i[5]*i[7])-i[1]*(i[3]*i[8]-i[5]*i[6])+i[2]*(i[3]*i[7]-i[4]*i[6]),s);if(a==="mat2x4"||a==="mat2x4f"||a==="mat2x4h")console.error(`TODO: Determinant for ${a}`);else if(a==="mat3x2"||a==="mat3x2f"||a==="mat3x2h")console.error(`TODO: Determinant for ${a}`);else{if(a==="mat3x3"||a==="mat3x3f"||a==="mat3x3h")return new rr(i[0]*(i[4]*i[8]-i[5]*i[7])-i[1]*(i[3]*i[8]-i[5]*i[6])+i[2]*(i[3]*i[7]-i[4]*i[6]),s);a==="mat3x4"||a==="mat3x4f"||a==="mat3x4h"||a==="mat4x2"||a==="mat4x2f"||a==="mat4x2h"||a==="mat4x3"||a==="mat4x3f"||a==="mat4x3h"?console.error(`TODO: Determinant for ${a}`):a!=="mat4x4"&&a!=="mat4x4f"&&a!=="mat4x4h"||console.error(`TODO: Determinant for ${a}`)}}return console.error(`Determinant expects a matrix argument. Line ${e.line}`),null}Distance(e,r){const n=this.exec.evalExpression(e.args[0],r),i=this.exec.evalExpression(e.args[1],r);if(n instanceof It&&i instanceof It){let o=0;for(let u=0;u<n.data.length;++u)o+=(n.data[u]-i.data[u])*(n.data[u]-i.data[u]);return new rr(Math.sqrt(o),this.getTypeInfo("f32"))}const a=n,s=i;return new rr(Math.abs(a.value-s.value),n.typeInfo)}_dot(e,r){let n=0;for(let i=0;i<e.length;++i)n+=r[i]*e[i];return n}Dot(e,r){const n=this.exec.evalExpression(e.args[0],r),i=this.exec.evalExpression(e.args[1],r);return n instanceof It&&i instanceof It?new rr(this._dot(n.data,i.data),this.getTypeInfo("f32")):(console.error(`Dot() expects vector arguments. Line ${e.line}`),null)}Dot4U8Packed(e,r){return console.error(`TODO: dot4U8Packed. Line ${e.line}`),null}Dot4I8Packed(e,r){return console.error(`TODO: dot4I8Packed. Line ${e.line}`),null}Exp(e,r){const n=this.exec.evalExpression(e.args[0],r);if(n instanceof It)return new It(n.data.map(a=>Math.exp(a)),n.typeInfo);const i=n;return new rr(Math.exp(i.value),n.typeInfo)}Exp2(e,r){const n=this.exec.evalExpression(e.args[0],r);if(n instanceof It)return new It(n.data.map(a=>Math.pow(2,a)),n.typeInfo);const i=n;return new rr(Math.pow(2,i.value),n.typeInfo)}ExtractBits(e,r){const n=this.exec.evalExpression(e.args[0],r),i=this.exec.evalExpression(e.args[1],r),a=this.exec.evalExpression(e.args[2],r);if(i.typeInfo.name!=="u32"&&i.typeInfo.name!=="x32")return console.error(`ExtractBits() expects an i32 offset argument. Line ${e.line}`),null;if(a.typeInfo.name!=="u32"&&a.typeInfo.name!=="x32")return console.error(`ExtractBits() expects an i32 count argument. Line ${e.line}`),null;const s=i.value,o=a.value;if(n instanceof It)return new It(n.data.map(h=>h>>s&(1<<o)-1),n.typeInfo);if(n.typeInfo.name!=="i32"&&n.typeInfo.name!=="x32")return console.error(`ExtractBits() expects an i32 argument. Line ${e.line}`),null;const u=n.value;return new rr(u>>s&(1<<o)-1,this.getTypeInfo("i32"))}FaceForward(e,r){const n=this.exec.evalExpression(e.args[0],r),i=this.exec.evalExpression(e.args[1],r),a=this.exec.evalExpression(e.args[2],r);if(n instanceof It&&i instanceof It&&a instanceof It){const s=this._dot(i.data,a.data);return new It(s<0?Array.from(n.data):n.data.map(o=>-o),n.typeInfo)}return console.error(`FaceForward() expects vector arguments. Line ${e.line}`),null}_firstLeadingBit(e){return e===0?-1:31-Math.clz32(e)}FirstLeadingBit(e,r){const n=this.exec.evalExpression(e.args[0],r);if(n instanceof It)return new It(n.data.map(a=>this._firstLeadingBit(a)),n.typeInfo);const i=n;return new rr(this._firstLeadingBit(i.value),n.typeInfo)}_firstTrailingBit(e){return e===0?-1:Math.log2(e&-e)}FirstTrailingBit(e,r){const n=this.exec.evalExpression(e.args[0],r);if(n instanceof It)return new It(n.data.map(a=>this._firstTrailingBit(a)),n.typeInfo);const i=n;return new rr(this._firstTrailingBit(i.value),n.typeInfo)}Floor(e,r){const n=this.exec.evalExpression(e.args[0],r);if(n instanceof It)return new It(n.data.map(a=>Math.floor(a)),n.typeInfo);const i=n;return new rr(Math.floor(i.value),n.typeInfo)}Fma(e,r){const n=this.exec.evalExpression(e.args[0],r),i=this.exec.evalExpression(e.args[1],r),a=this.exec.evalExpression(e.args[2],r);if(n instanceof It&&i instanceof It&&a instanceof It)return n.data.length!==i.data.length||n.data.length!==a.data.length?(console.error(`Fma() expects vectors of the same length. Line ${e.line}`),null):new It(n.data.map((h,f)=>h*i.data[f]+a.data[f]),n.typeInfo);const s=n,o=i,u=a;return new rr(s.value*o.value+u.value,s.typeInfo)}Fract(e,r){const n=this.exec.evalExpression(e.args[0],r);if(n instanceof It)return new It(n.data.map(a=>a-Math.floor(a)),n.typeInfo);const i=n;return new rr(i.value-Math.floor(i.value),n.typeInfo)}Frexp(e,r){return console.error(`TODO: frexp. Line ${e.line}`),null}InsertBits(e,r){const n=this.exec.evalExpression(e.args[0],r),i=this.exec.evalExpression(e.args[1],r),a=this.exec.evalExpression(e.args[2],r),s=this.exec.evalExpression(e.args[3],r);if(a.typeInfo.name!=="u32"&&a.typeInfo.name!=="x32")return console.error(`InsertBits() expects an i32 offset argument. Line ${e.line}`),null;const o=a.value,u=(1<<s.value)-1<<o,h=~u;if(n instanceof It&&i instanceof It)return new It(n.data.map((b,v)=>b&h|i.data[v]<<o&u),n.typeInfo);const f=n.value,g=i.value;return new rr(f&h|g<<o&u,n.typeInfo)}InverseSqrt(e,r){const n=this.exec.evalExpression(e.args[0],r);if(n instanceof It)return new It(n.data.map(a=>1/Math.sqrt(a)),n.typeInfo);const i=n;return new rr(1/Math.sqrt(i.value),n.typeInfo)}Ldexp(e,r){return console.error(`TODO: ldexp. Line ${e.line}`),null}Length(e,r){const n=this.exec.evalExpression(e.args[0],r);if(n instanceof It){let a=0;return n.data.forEach(s=>{a+=s*s}),new rr(Math.sqrt(a),this.getTypeInfo("f32"))}const i=n;return new rr(Math.abs(i.value),n.typeInfo)}Log(e,r){const n=this.exec.evalExpression(e.args[0],r);if(n instanceof It)return new It(n.data.map(a=>Math.log(a)),n.typeInfo);const i=n;return new rr(Math.log(i.value),n.typeInfo)}Log2(e,r){const n=this.exec.evalExpression(e.args[0],r);if(n instanceof It)return new It(n.data.map(a=>Math.log2(a)),n.typeInfo);const i=n;return new rr(Math.log2(i.value),n.typeInfo)}Max(e,r){const n=this.exec.evalExpression(e.args[0],r),i=this.exec.evalExpression(e.args[1],r);if(n instanceof It&&i instanceof It)return new It(n.data.map((o,u)=>Math.max(o,i.data[u])),n.typeInfo);const a=n,s=i;return new rr(Math.max(a.value,s.value),n.typeInfo)}Min(e,r){const n=this.exec.evalExpression(e.args[0],r),i=this.exec.evalExpression(e.args[1],r);if(n instanceof It&&i instanceof It)return new It(n.data.map((o,u)=>Math.min(o,i.data[u])),n.typeInfo);const a=n,s=i;return new rr(Math.min(a.value,s.value),n.typeInfo)}Mix(e,r){const n=this.exec.evalExpression(e.args[0],r),i=this.exec.evalExpression(e.args[1],r),a=this.exec.evalExpression(e.args[2],r);if(n instanceof It&&i instanceof It&&a instanceof It)return new It(n.data.map((u,h)=>n.data[h]*(1-a.data[h])+i.data[h]*a.data[h]),n.typeInfo);const s=i,o=a;return new rr(n.value*(1-o.value)+s.value*o.value,n.typeInfo)}Modf(e,r){const n=this.exec.evalExpression(e.args[0],r),i=this.exec.evalExpression(e.args[1],r);if(n instanceof It&&i instanceof It)return new It(n.data.map((s,o)=>s%i.data[o]),n.typeInfo);const a=i;return new rr(n.value%a.value,n.typeInfo)}Normalize(e,r){const n=this.exec.evalExpression(e.args[0],r);if(n instanceof It){const i=this.Length(e,r).value;return new It(n.data.map(a=>a/i),n.typeInfo)}return console.error(`Normalize() expects a vector argument. Line ${e.line}`),null}Pow(e,r){const n=this.exec.evalExpression(e.args[0],r),i=this.exec.evalExpression(e.args[1],r);if(n instanceof It&&i instanceof It)return new It(n.data.map((o,u)=>Math.pow(o,i.data[u])),n.typeInfo);const a=n,s=i;return new rr(Math.pow(a.value,s.value),n.typeInfo)}QuantizeToF16(e,r){const n=this.exec.evalExpression(e.args[0],r);return n instanceof It?new It(n.data.map(i=>i),n.typeInfo):new rr(n.value,n.typeInfo)}Radians(e,r){const n=this.exec.evalExpression(e.args[0],r);return n instanceof It?new It(n.data.map(i=>i*Math.PI/180),n.typeInfo):new rr(n.value*Math.PI/180,this.getTypeInfo("f32"))}Reflect(e,r){let n=this.exec.evalExpression(e.args[0],r),i=this.exec.evalExpression(e.args[1],r);if(n instanceof It&&i instanceof It){const a=this._dot(n.data,i.data);return new It(n.data.map((s,o)=>s-2*a*i.data[o]),n.typeInfo)}return console.error(`Reflect() expects vector arguments. Line ${e.line}`),null}Refract(e,r){let n=this.exec.evalExpression(e.args[0],r),i=this.exec.evalExpression(e.args[1],r),a=this.exec.evalExpression(e.args[2],r);if(n instanceof It&&i instanceof It&&a instanceof rr){const s=this._dot(i.data,n.data);return new It(n.data.map((o,u)=>{const h=1-a.value*a.value*(1-s*s);if(h<0)return 0;const f=Math.sqrt(h);return a.value*o-(a.value*s+f)*i.data[u]}),n.typeInfo)}return console.error(`Refract() expects vector arguments and a scalar argument. Line ${e.line}`),null}ReverseBits(e,r){return console.error(`TODO: reverseBits. Line ${e.line}`),null}Round(e,r){const n=this.exec.evalExpression(e.args[0],r);if(n instanceof It)return new It(n.data.map(a=>Math.round(a)),n.typeInfo);const i=n;return new rr(Math.round(i.value),n.typeInfo)}Saturate(e,r){const n=this.exec.evalExpression(e.args[0],r);if(n instanceof It)return new It(n.data.map(a=>Math.min(Math.max(a,0),1)),n.typeInfo);const i=n;return new rr(Math.min(Math.max(i.value,0),1),n.typeInfo)}Sign(e,r){const n=this.exec.evalExpression(e.args[0],r);if(n instanceof It)return new It(n.data.map(a=>Math.sign(a)),n.typeInfo);const i=n;return new rr(Math.sign(i.value),n.typeInfo)}Sin(e,r){const n=this.exec.evalExpression(e.args[0],r);if(n instanceof It)return new It(n.data.map(a=>Math.sin(a)),n.typeInfo);const i=n;return new rr(Math.sin(i.value),n.typeInfo)}Sinh(e,r){const n=this.exec.evalExpression(e.args[0],r);if(n instanceof It)return new It(n.data.map(a=>Math.sinh(a)),n.typeInfo);const i=n;return new rr(Math.sinh(i.value),n.typeInfo)}_smoothstep(e,r,n){const i=Math.min(Math.max((n-e)/(r-e),0),1);return i*i*(3-2*i)}SmoothStep(e,r){const n=this.exec.evalExpression(e.args[0],r),i=this.exec.evalExpression(e.args[1],r),a=this.exec.evalExpression(e.args[2],r);if(a instanceof It&&n instanceof It&&i instanceof It)return new It(a.data.map((h,f)=>this._smoothstep(n.data[f],i.data[f],h)),a.typeInfo);const s=n,o=i,u=a;return new rr(this._smoothstep(s.value,o.value,u.value),a.typeInfo)}Sqrt(e,r){const n=this.exec.evalExpression(e.args[0],r);if(n instanceof It)return new It(n.data.map(a=>Math.sqrt(a)),n.typeInfo);const i=n;return new rr(Math.sqrt(i.value),n.typeInfo)}Step(e,r){const n=this.exec.evalExpression(e.args[0],r),i=this.exec.evalExpression(e.args[1],r);if(i instanceof It&&n instanceof It)return new It(i.data.map((s,o)=>s<n.data[o]?0:1),i.typeInfo);const a=n;return new rr(i.value<a.value?0:1,a.typeInfo)}Tan(e,r){const n=this.exec.evalExpression(e.args[0],r);if(n instanceof It)return new It(n.data.map(a=>Math.tan(a)),n.typeInfo);const i=n;return new rr(Math.tan(i.value),n.typeInfo)}Tanh(e,r){const n=this.exec.evalExpression(e.args[0],r);if(n instanceof It)return new It(n.data.map(a=>Math.tanh(a)),n.typeInfo);const i=n;return new rr(Math.tanh(i.value),n.typeInfo)}_getTransposeType(e){const r=e.getTypeName();return r==="mat2x2f"||r==="mat2x2h"?e:r==="mat2x3f"?this.getTypeInfo("mat3x2f"):r==="mat2x3h"?this.getTypeInfo("mat3x2h"):r==="mat2x4f"?this.getTypeInfo("mat4x2f"):r==="mat2x4h"?this.getTypeInfo("mat4x2h"):r==="mat3x2f"?this.getTypeInfo("mat2x3f"):r==="mat3x2h"?this.getTypeInfo("mat2x3h"):r==="mat3x3f"||r==="mat3x3h"?e:r==="mat3x4f"?this.getTypeInfo("mat4x3f"):r==="mat3x4h"?this.getTypeInfo("mat4x3h"):r==="mat4x2f"?this.getTypeInfo("mat2x4f"):r==="mat4x2h"?this.getTypeInfo("mat2x4h"):r==="mat4x3f"?this.getTypeInfo("mat3x4f"):r==="mat4x3h"?this.getTypeInfo("mat3x4h"):(r==="mat4x4f"||r==="mat4x4h"||console.error(`Invalid matrix type ${r}`),e)}Transpose(e,r){const n=this.exec.evalExpression(e.args[0],r);if(!(n instanceof Ai))return console.error(`Transpose() expects a matrix argument. Line ${e.line}`),null;const i=this._getTransposeType(n.typeInfo);if(n.typeInfo.name==="mat2x2"||n.typeInfo.name==="mat2x2f"||n.typeInfo.name==="mat2x2h"){const a=n.data;return new Ai([a[0],a[2],a[1],a[3]],i)}if(n.typeInfo.name==="mat2x3"||n.typeInfo.name==="mat2x3f"||n.typeInfo.name==="mat2x3h"){const a=n.data;return new Ai([a[0],a[3],a[6],a[1],a[4],a[7]],i)}if(n.typeInfo.name==="mat2x4"||n.typeInfo.name==="mat2x4f"||n.typeInfo.name==="mat2x4h"){const a=n.data;return new Ai([a[0],a[4],a[8],a[12],a[1],a[5],a[9],a[13]],i)}if(n.typeInfo.name==="mat3x2"||n.typeInfo.name==="mat3x2f"||n.typeInfo.name==="mat3x2h"){const a=n.data;return new Ai([a[0],a[3],a[1],a[4],a[2],a[5]],i)}if(n.typeInfo.name==="mat3x3"||n.typeInfo.name==="mat3x3f"||n.typeInfo.name==="mat3x3h"){const a=n.data;return new Ai([a[0],a[3],a[6],a[1],a[4],a[7],a[2],a[5],a[8]],i)}if(n.typeInfo.name==="mat3x4"||n.typeInfo.name==="mat3x4f"||n.typeInfo.name==="mat3x4h"){const a=n.data;return new Ai([a[0],a[4],a[8],a[12],a[1],a[5],a[9],a[13],a[2],a[6],a[10],a[14]],i)}if(n.typeInfo.name==="mat4x2"||n.typeInfo.name==="mat4x2f"||n.typeInfo.name==="mat4x2h"){const a=n.data;return new Ai([a[0],a[4],a[1],a[5],a[2],a[6]],i)}if(n.typeInfo.name==="mat4x3"||n.typeInfo.name==="mat4x3f"||n.typeInfo.name==="mat4x3h"){const a=n.data;return new Ai([a[0],a[4],a[8],a[1],a[5],a[9],a[2],a[6],a[10]],i)}if(n.typeInfo.name==="mat4x4"||n.typeInfo.name==="mat4x4f"||n.typeInfo.name==="mat4x4h"){const a=n.data;return new Ai([a[0],a[4],a[8],a[12],a[1],a[5],a[9],a[13],a[2],a[6],a[10],a[14],a[3],a[7],a[11],a[15]],i)}return console.error(`Invalid matrix type ${n.typeInfo.name}`),null}Trunc(e,r){const n=this.exec.evalExpression(e.args[0],r);if(n instanceof It)return new It(n.data.map(a=>Math.trunc(a)),n.typeInfo);const i=n;return new rr(Math.trunc(i.value),n.typeInfo)}Dpdx(e,r){return console.error(`TODO: dpdx. Line ${e.line}`),null}DpdxCoarse(e,r){return console.error(`TODO: dpdxCoarse. Line ${e.line}`),null}DpdxFine(e,r){return console.error("TODO: dpdxFine"),null}Dpdy(e,r){return console.error("TODO: dpdy"),null}DpdyCoarse(e,r){return console.error("TODO: dpdyCoarse"),null}DpdyFine(e,r){return console.error("TODO: dpdyFine"),null}Fwidth(e,r){return console.error("TODO: fwidth"),null}FwidthCoarse(e,r){return console.error("TODO: fwidthCoarse"),null}FwidthFine(e,r){return console.error("TODO: fwidthFine"),null}TextureDimensions(e,r){const n=e.args[0],i=e.args.length>1?this.exec.evalExpression(e.args[1],r).value:0;if(n instanceof Xc){const a=n.name,s=r.getVariableValue(a);if(s instanceof Md){if(i<0||i>=s.mipLevelCount)return console.error(`Invalid mip level for textureDimensions. Line ${e.line}`),null;const o=s.getMipLevelSize(i),u=s.dimension;return u==="1d"?new rr(o[0],this.getTypeInfo("u32")):u==="3d"?new It(o,this.getTypeInfo("vec3u")):u==="2d"?new It(o.slice(0,2),this.getTypeInfo("vec2u")):(console.error(`Invalid texture dimension ${u} not found. Line ${e.line}`),null)}return console.error(`Texture ${a} not found. Line ${e.line}`),null}return console.error(`Invalid texture argument for textureDimensions. Line ${e.line}`),null}TextureGather(e,r){return console.error("TODO: textureGather"),null}TextureGatherCompare(e,r){return console.error("TODO: textureGatherCompare"),null}TextureLoad(e,r){const n=e.args[0],i=this.exec.evalExpression(e.args[1],r),a=e.args.length>2?this.exec.evalExpression(e.args[2],r).value:0;if(!(i instanceof It)||i.data.length!==2)return console.error(`Invalid UV argument for textureLoad. Line ${e.line}`),null;if(n instanceof Xc){const s=n.name,o=r.getVariableValue(s);if(o instanceof Md){const u=Math.floor(i.data[0]),h=Math.floor(i.data[1]);if(u<0||u>=o.width||h<0||h>=o.height)return console.error(`Texture ${s} out of bounds. Line ${e.line}`),null;const f=o.getPixel(u,h,0,a);return f===null?(console.error(`Invalid texture format for textureLoad. Line ${e.line}`),null):new It(f,this.getTypeInfo("vec4f"))}return console.error(`Texture ${s} not found. Line ${e.line}`),null}return console.error(`Invalid texture argument for textureLoad. Line ${e.line}`),null}TextureNumLayers(e,r){const n=e.args[0];if(n instanceof Xc){const i=n.name,a=r.getVariableValue(i);return a instanceof Md?new rr(a.depthOrArrayLayers,this.getTypeInfo("u32")):(console.error(`Texture ${i} not found. Line ${e.line}`),null)}return console.error(`Invalid texture argument for textureNumLayers. Line ${e.line}`),null}TextureNumLevels(e,r){const n=e.args[0];if(n instanceof Xc){const i=n.name,a=r.getVariableValue(i);return a instanceof Md?new rr(a.mipLevelCount,this.getTypeInfo("u32")):(console.error(`Texture ${i} not found. Line ${e.line}`),null)}return console.error(`Invalid texture argument for textureNumLevels. Line ${e.line}`),null}TextureNumSamples(e,r){const n=e.args[0];if(n instanceof Xc){const i=n.name,a=r.getVariableValue(i);return a instanceof Md?new rr(a.sampleCount,this.getTypeInfo("u32")):(console.error(`Texture ${i} not found. Line ${e.line}`),null)}return console.error(`Invalid texture argument for textureNumSamples. Line ${e.line}`),null}TextureSample(e,r){return console.error("TODO: textureSample"),null}TextureSampleBias(e,r){return console.error("TODO: textureSampleBias"),null}TextureSampleCompare(e,r){return console.error("TODO: textureSampleCompare"),null}TextureSampleCompareLevel(e,r){return console.error("TODO: textureSampleCompareLevel"),null}TextureSampleGrad(e,r){return console.error("TODO: textureSampleGrad"),null}TextureSampleLevel(e,r){return console.error("TODO: textureSampleLevel"),null}TextureSampleBaseClampToEdge(e,r){return console.error("TODO: textureSampleBaseClampToEdge"),null}TextureStore(e,r){const n=e.args[0],i=this.exec.evalExpression(e.args[1],r),a=e.args.length===4?this.exec.evalExpression(e.args[2],r).value:0,s=e.args.length===4?this.exec.evalExpression(e.args[3],r).data:this.exec.evalExpression(e.args[2],r).data;if(s.length!==4)return console.error(`Invalid value argument for textureStore. Line ${e.line}`),null;if(!(i instanceof It)||i.data.length!==2)return console.error(`Invalid UV argument for textureStore. Line ${e.line}`),null;if(n instanceof Xc){const o=n.name,u=r.getVariableValue(o);if(u instanceof Md){const h=u.getMipLevelSize(0),f=Math.floor(i.data[0]),g=Math.floor(i.data[1]);return f<0||f>=h[0]||g<0||g>=h[1]?(console.error(`Texture ${o} out of bounds. Line ${e.line}`),null):(u.setPixel(f,g,0,a,Array.from(s)),null)}return console.error(`Texture ${o} not found. Line ${e.line}`),null}return console.error(`Invalid texture argument for textureStore. Line ${e.line}`),null}AtomicLoad(e,r){let n=e.args[0];n instanceof dl&&(n=n.right);const i=this.exec.getVariableName(n,r);return r.getVariable(i).value.getSubData(this.exec,n.postfix,r)}AtomicStore(e,r){let n=e.args[0];n instanceof dl&&(n=n.right);const i=this.exec.getVariableName(n,r),a=r.getVariable(i);let s=e.args[1];const o=this.exec.evalExpression(s,r),u=a.value.getSubData(this.exec,n.postfix,r);return u instanceof rr&&o instanceof rr&&(u.value=o.value),a.value instanceof Ds&&a.value.setDataValue(this.exec,u,n.postfix,r),null}AtomicAdd(e,r){let n=e.args[0];n instanceof dl&&(n=n.right);const i=this.exec.getVariableName(n,r),a=r.getVariable(i);let s=e.args[1];const o=this.exec.evalExpression(s,r),u=a.value.getSubData(this.exec,n.postfix,r),h=new rr(u.value,u.typeInfo);return u instanceof rr&&o instanceof rr&&(u.value+=o.value),a.value instanceof Ds&&a.value.setDataValue(this.exec,u,n.postfix,r),h}AtomicSub(e,r){let n=e.args[0];n instanceof dl&&(n=n.right);const i=this.exec.getVariableName(n,r),a=r.getVariable(i);let s=e.args[1];const o=this.exec.evalExpression(s,r),u=a.value.getSubData(this.exec,n.postfix,r),h=new rr(u.value,u.typeInfo);return u instanceof rr&&o instanceof rr&&(u.value-=o.value),a.value instanceof Ds&&a.value.setDataValue(this.exec,u,n.postfix,r),h}AtomicMax(e,r){let n=e.args[0];n instanceof dl&&(n=n.right);const i=this.exec.getVariableName(n,r),a=r.getVariable(i);let s=e.args[1];const o=this.exec.evalExpression(s,r),u=a.value.getSubData(this.exec,n.postfix,r),h=new rr(u.value,u.typeInfo);return u instanceof rr&&o instanceof rr&&(u.value=Math.max(u.value,o.value)),a.value instanceof Ds&&a.value.setDataValue(this.exec,u,n.postfix,r),h}AtomicMin(e,r){let n=e.args[0];n instanceof dl&&(n=n.right);const i=this.exec.getVariableName(n,r),a=r.getVariable(i);let s=e.args[1];const o=this.exec.evalExpression(s,r),u=a.value.getSubData(this.exec,n.postfix,r),h=new rr(u.value,u.typeInfo);return u instanceof rr&&o instanceof rr&&(u.value=Math.min(u.value,o.value)),a.value instanceof Ds&&a.value.setDataValue(this.exec,u,n.postfix,r),h}AtomicAnd(e,r){let n=e.args[0];n instanceof dl&&(n=n.right);const i=this.exec.getVariableName(n,r),a=r.getVariable(i);let s=e.args[1];const o=this.exec.evalExpression(s,r),u=a.value.getSubData(this.exec,n.postfix,r),h=new rr(u.value,u.typeInfo);return u instanceof rr&&o instanceof rr&&(u.value=u.value&o.value),a.value instanceof Ds&&a.value.setDataValue(this.exec,u,n.postfix,r),h}AtomicOr(e,r){let n=e.args[0];n instanceof dl&&(n=n.right);const i=this.exec.getVariableName(n,r),a=r.getVariable(i);let s=e.args[1];const o=this.exec.evalExpression(s,r),u=a.value.getSubData(this.exec,n.postfix,r),h=new rr(u.value,u.typeInfo);return u instanceof rr&&o instanceof rr&&(u.value=u.value|o.value),a.value instanceof Ds&&a.value.setDataValue(this.exec,u,n.postfix,r),h}AtomicXor(e,r){let n=e.args[0];n instanceof dl&&(n=n.right);const i=this.exec.getVariableName(n,r),a=r.getVariable(i);let s=e.args[1];const o=this.exec.evalExpression(s,r),u=a.value.getSubData(this.exec,n.postfix,r),h=new rr(u.value,u.typeInfo);return u instanceof rr&&o instanceof rr&&(u.value=u.value^o.value),a.value instanceof Ds&&a.value.setDataValue(this.exec,u,n.postfix,r),h}AtomicExchange(e,r){let n=e.args[0];n instanceof dl&&(n=n.right);const i=this.exec.getVariableName(n,r),a=r.getVariable(i);let s=e.args[1];const o=this.exec.evalExpression(s,r),u=a.value.getSubData(this.exec,n.postfix,r),h=new rr(u.value,u.typeInfo);return u instanceof rr&&o instanceof rr&&(u.value=o.value),a.value instanceof Ds&&a.value.setDataValue(this.exec,u,n.postfix,r),h}AtomicCompareExchangeWeak(e,r){return console.error("TODO: atomicCompareExchangeWeak"),null}Pack4x8snorm(e,r){return console.error("TODO: pack4x8snorm"),null}Pack4x8unorm(e,r){return console.error("TODO: pack4x8unorm"),null}Pack4xI8(e,r){return console.error("TODO: pack4xI8"),null}Pack4xU8(e,r){return console.error("TODO: pack4xU8"),null}Pack4x8Clamp(e,r){return console.error("TODO: pack4x8Clamp"),null}Pack4xU8Clamp(e,r){return console.error("TODO: pack4xU8Clamp"),null}Pack2x16snorm(e,r){return console.error("TODO: pack2x16snorm"),null}Pack2x16unorm(e,r){return console.error("TODO: pack2x16unorm"),null}Pack2x16float(e,r){return console.error("TODO: pack2x16float"),null}Unpack4x8snorm(e,r){return console.error("TODO: unpack4x8snorm"),null}Unpack4x8unorm(e,r){return console.error("TODO: unpack4x8unorm"),null}Unpack4xI8(e,r){return console.error("TODO: unpack4xI8"),null}Unpack4xU8(e,r){return console.error("TODO: unpack4xU8"),null}Unpack2x16snorm(e,r){return console.error("TODO: unpack2x16snorm"),null}Unpack2x16unorm(e,r){return console.error("TODO: unpack2x16unorm"),null}Unpack2x16float(e,r){return console.error("TODO: unpack2x16float"),null}StorageBarrier(e,r){return null}TextureBarrier(e,r){return null}WorkgroupBarrier(e,r){return null}WorkgroupUniformLoad(e,r){return null}SubgroupAdd(e,r){return console.error("TODO: subgroupAdd"),null}SubgroupExclusiveAdd(e,r){return console.error("TODO: subgroupExclusiveAdd"),null}SubgroupInclusiveAdd(e,r){return console.error("TODO: subgroupInclusiveAdd"),null}SubgroupAll(e,r){return console.error("TODO: subgroupAll"),null}SubgroupAnd(e,r){return console.error("TODO: subgroupAnd"),null}SubgroupAny(e,r){return console.error("TODO: subgroupAny"),null}SubgroupBallot(e,r){return console.error("TODO: subgroupBallot"),null}SubgroupBroadcast(e,r){return console.error("TODO: subgroupBroadcast"),null}SubgroupBroadcastFirst(e,r){return console.error("TODO: subgroupBroadcastFirst"),null}SubgroupElect(e,r){return console.error("TODO: subgroupElect"),null}SubgroupMax(e,r){return console.error("TODO: subgroupMax"),null}SubgroupMin(e,r){return console.error("TODO: subgroupMin"),null}SubgroupMul(e,r){return console.error("TODO: subgroupMul"),null}SubgroupExclusiveMul(e,r){return console.error("TODO: subgroupExclusiveMul"),null}SubgroupInclusiveMul(e,r){return console.error("TODO: subgroupInclusiveMul"),null}SubgroupOr(e,r){return console.error("TODO: subgroupOr"),null}SubgroupShuffle(e,r){return console.error("TODO: subgroupShuffle"),null}SubgroupShuffleDown(e,r){return console.error("TODO: subgroupShuffleDown"),null}SubgroupShuffleUp(e,r){return console.error("TODO: subgroupShuffleUp"),null}SubgroupShuffleXor(e,r){return console.error("TODO: subgroupShuffleXor"),null}SubgroupXor(e,r){return console.error("TODO: subgroupXor"),null}QuadBroadcast(e,r){return console.error("TODO: quadBroadcast"),null}QuadSwapDiagonal(e,r){return console.error("TODO: quadSwapDiagonal"),null}QuadSwapX(e,r){return console.error("TODO: quadSwapX"),null}QuadSwapY(e,r){return console.error("TODO: quadSwapY"),null}}const BI={vec2:2,vec2f:2,vec2i:2,vec2u:2,vec2b:2,vec2h:2,vec3:3,vec3f:3,vec3i:3,vec3u:3,vec3b:3,vec3h:3,vec4:4,vec4f:4,vec4i:4,vec4u:4,vec4b:4,vec4h:4},nc={mat2x2:[2,2,4],mat2x2f:[2,2,4],mat2x2h:[2,2,4],mat2x3:[2,3,6],mat2x3f:[2,3,6],mat2x3h:[2,3,6],mat2x4:[2,4,8],mat2x4f:[2,4,8],mat2x4h:[2,4,8],mat3x2:[3,2,6],mat3x2f:[3,2,6],mat3x2h:[3,2,6],mat3x3:[3,3,9],mat3x3f:[3,3,9],mat3x3h:[3,3,9],mat3x4:[3,4,12],mat3x4f:[3,4,12],mat3x4h:[3,4,12],mat4x2:[4,2,8],mat4x2f:[4,2,8],mat4x2h:[4,2,8],mat4x3:[4,3,12],mat4x3f:[4,3,12],mat4x3h:[4,3,12],mat4x4:[4,4,16],mat4x4f:[4,4,16],mat4x4h:[4,4,16]};class ju extends ize{constructor(e,r){var n;super(),this.ast=e??[],this.reflection=new Gf,this.reflection.updateAST(this.ast),this.context=(n=r?.clone())!==null&&n!==void 0?n:new HN,this.builtins=new aze(this),this.typeInfo={bool:this.getTypeInfo(Xr.bool),i32:this.getTypeInfo(Xr.i32),u32:this.getTypeInfo(Xr.u32),f32:this.getTypeInfo(Xr.f32),f16:this.getTypeInfo(Xr.f16),vec2f:this.getTypeInfo(hr.vec2f),vec2u:this.getTypeInfo(hr.vec2u),vec2i:this.getTypeInfo(hr.vec2i),vec2h:this.getTypeInfo(hr.vec2h),vec3f:this.getTypeInfo(hr.vec3f),vec3u:this.getTypeInfo(hr.vec3u),vec3i:this.getTypeInfo(hr.vec3i),vec3h:this.getTypeInfo(hr.vec3h),vec4f:this.getTypeInfo(hr.vec4f),vec4u:this.getTypeInfo(hr.vec4u),vec4i:this.getTypeInfo(hr.vec4i),vec4h:this.getTypeInfo(hr.vec4h),mat2x2f:this.getTypeInfo(hr.mat2x2f),mat2x3f:this.getTypeInfo(hr.mat2x3f),mat2x4f:this.getTypeInfo(hr.mat2x4f),mat3x2f:this.getTypeInfo(hr.mat3x2f),mat3x3f:this.getTypeInfo(hr.mat3x3f),mat3x4f:this.getTypeInfo(hr.mat3x4f),mat4x2f:this.getTypeInfo(hr.mat4x2f),mat4x3f:this.getTypeInfo(hr.mat4x3f),mat4x4f:this.getTypeInfo(hr.mat4x4f)}}getVariableValue(e){var r,n;const i=(n=(r=this.context.getVariable(e))===null||r===void 0?void 0:r.value)!==null&&n!==void 0?n:null;if(i===null)return null;if(i instanceof rr)return i.value;if(i instanceof It||i instanceof Ai)return Array.from(i.data);if(i instanceof Ds&&i.typeInfo instanceof Gp){if(i.typeInfo.format.name==="u32")return Array.from(new Uint32Array(i.buffer,i.offset,i.typeInfo.count));if(i.typeInfo.format.name==="i32")return Array.from(new Int32Array(i.buffer,i.offset,i.typeInfo.count));if(i.typeInfo.format.name==="f32")return Array.from(new Float32Array(i.buffer,i.offset,i.typeInfo.count))}return console.error(`Unsupported return variable type ${i.typeInfo.name}`),null}execute(e){(e=e??{}).constants&&this._setOverrides(e.constants,this.context),this._execStatements(this.ast,this.context)}dispatchWorkgroups(e,r,n,i){const a=this.context.clone();(i=i??{}).constants&&this._setOverrides(i.constants,a),this._execStatements(this.ast,a);const s=a.getFunction(e);if(!s)return void console.error(`Function ${e} not found`);if(typeof r=="number")r=[r,1,1];else{if(r.length===0)return void console.error("Invalid dispatch count");r.length===1?r=[r[0],1,1]:r.length===2?r=[r[0],r[1],1]:r.length>3&&(r=[r[0],r[1],r[2]])}const o=r[0],u=r[1],h=r[2],f=this.getTypeInfo("vec3u");a.setVariable("@num_workgroups",new It(r,f));const g=this.reflection.getFunctionInfo(e);g===null&&console.error(`Function ${e} not found in reflection data`);for(const b in n)for(const v in n[b]){const S=n[b][v];a.variables.forEach(E=>{var P;const k=E.node;if(k?.attributes){let L=null,O=null;for(const M of k.attributes)M.name==="binding"?L=M.value:M.name==="group"&&(O=M.value);if(v==L&&b==O){let M=!1;for(const z of g.resources)if(z.name===E.name&&z.group===parseInt(b)&&z.binding===parseInt(v)){M=!0;break}if(M)if(S.texture!==void 0&&S.descriptor!==void 0){const z=new Md(S.texture,this.getTypeInfo(k.type),S.descriptor,(P=S.texture.view)!==null&&P!==void 0?P:null);E.value=z}else S.uniform!==void 0?E.value=new Ds(S.uniform,this.getTypeInfo(k.type)):E.value=new Ds(S,this.getTypeInfo(k.type))}}})}for(let b=0;b<h;++b)for(let v=0;v<u;++v)for(let S=0;S<o;++S)a.setVariable("@workgroup_id",new It([S,v,b],this.getTypeInfo("vec3u"))),this._dispatchWorkgroup(s,[S,v,b],a)}execStatement(e,r){if(e instanceof Nee)return this.evalExpression(e.value,r);if(e instanceof Fee){if(e.condition){const n=this.evalExpression(e.condition,r);if(!(n instanceof rr))throw new Error("Invalid break-if condition");if(!n.value)return null}return ju._breakObj}if(e instanceof Bee)return ju._continueObj;if(e instanceof B1)this._let(e,r);else if(e instanceof Ld)this._var(e,r);else if(e instanceof Mw)this._const(e,r);else if(e instanceof Cb)this._function(e,r);else{if(e instanceof Lee)return this._if(e,r);if(e instanceof Oee)return this._switch(e,r);if(e instanceof Pee)return this._for(e,r);if(e instanceof Iee)return this._while(e,r);if(e instanceof Ree)return this._loop(e,r);if(e instanceof WM){const n=r.clone();return n.currentFunctionName=r.currentFunctionName,this._execStatements(e.body,n)}if(e instanceof Mee)this._assign(e,r);else if(e instanceof kee)this._increment(e,r);else{if(e instanceof kd)return null;if(e instanceof BN){const n=e.name;r.getVariable(n)===null&&r.setVariable(n,new rr(0,this.getTypeInfo("u32")))}else if(e instanceof zN)this._call(e,r);else{if(e instanceof Dee||e instanceof jN)return null;console.error("Invalid statement type.",e,`Line ${e.line}`)}}}return null}evalExpression(e,r){return e instanceof Zh?this._evalBinaryOp(e,r):e instanceof Pl?this._evalLiteral(e,r):e instanceof Xc?this._evalVariable(e,r):e instanceof UN?this._evalCall(e,r):e instanceof jf?this._evalCreate(e,r):e instanceof zee?this._evalConst(e,r):e instanceof jee?this._evalBitcast(e,r):e instanceof dl?this._evalUnaryOp(e,r):(console.error("Invalid expression type",e,`Line ${e.line}`),null)}getTypeInfo(e){var r;if(e instanceof Xr){const i=this.reflection.getTypeInfo(e);if(i!==null)return i}let n=(r=this.typeInfo[e])!==null&&r!==void 0?r:null;return n!==null||(n=this.reflection.getTypeInfoByName(e)),n}_setOverrides(e,r){for(const n in e){const i=e[n],a=this.reflection.getOverrideInfo(n);a!==null?(a.type===null&&(a.type=this.getTypeInfo("u32")),a.type.name==="u32"||a.type.name==="i32"||a.type.name==="f32"||a.type.name==="f16"?r.setVariable(n,new rr(i,a.type)):a.type.name==="bool"?r.setVariable(n,new rr(i?1:0,a.type)):a.type.name==="vec2"||a.type.name==="vec3"||a.type.name==="vec4"||a.type.name==="vec2f"||a.type.name==="vec3f"||a.type.name==="vec4f"||a.type.name==="vec2i"||a.type.name==="vec3i"||a.type.name==="vec4i"||a.type.name==="vec2u"||a.type.name==="vec3u"||a.type.name==="vec4u"||a.type.name==="vec2h"||a.type.name==="vec3h"||a.type.name==="vec4h"?r.setVariable(n,new It(i,a.type)):console.error(`Invalid constant type for ${n}`)):console.error(`Override ${n} does not exist in the shader.`)}}_dispatchWorkgroup(e,r,n){const i=[1,1,1];for(const f of e.node.attributes)if(f.name==="workgroup_size"){if(f.value.length>0){const g=n.getVariableValue(f.value[0]);i[0]=g instanceof rr?g.value:parseInt(f.value[0])}if(f.value.length>1){const g=n.getVariableValue(f.value[1]);i[1]=g instanceof rr?g.value:parseInt(f.value[1])}if(f.value.length>2){const g=n.getVariableValue(f.value[2]);i[2]=g instanceof rr?g.value:parseInt(f.value[2])}}const a=this.getTypeInfo("vec3u"),s=this.getTypeInfo("u32");n.setVariable("@workgroup_size",new It(i,a));const o=i[0],u=i[1],h=i[2];for(let f=0,g=0;f<h;++f)for(let b=0;b<u;++b)for(let v=0;v<o;++v,++g){const S=[v,b,f],E=[v+r[0]*i[0],b+r[1]*i[1],f+r[2]*i[2]];n.setVariable("@local_invocation_id",new It(S,a)),n.setVariable("@global_invocation_id",new It(E,a)),n.setVariable("@local_invocation_index",new rr(g,s)),this._dispatchExec(e,n)}}_dispatchExec(e,r){for(const n of e.node.args)for(const i of n.attributes)if(i.name==="builtin"){const a=`@${i.value}`,s=r.getVariable(a);s!==void 0&&r.variables.set(n.name,s)}this._execStatements(e.node.body,r)}getVariableName(e,r){for(;e instanceof dl;)e=e.right;return e instanceof Xc?e.name:(console.error("Unknown variable type",e,"Line",e.line),null)}_execStatements(e,r){for(const n of e){if(n instanceof Array){const a=r.clone(),s=this._execStatements(n,a);if(s)return s;continue}const i=this.execStatement(n,r);if(i)return i}return null}_call(e,r){const n=r.clone();n.currentFunctionName=e.name;const i=r.getFunction(e.name);if(i){for(let a=0;a<i.node.args.length;++a){const s=i.node.args[a],o=this.evalExpression(e.args[a],n);n.setVariable(s.name,o,s)}this._execStatements(i.node.body,n)}else e.isBuiltin?this._callBuiltinFunction(e,n):this.getTypeInfo(e.name)&&this._evalCreate(e,r)}_increment(e,r){const n=this.getVariableName(e.variable,r),i=r.getVariable(n);i?e.operator==="++"?i.value instanceof rr?i.value.value++:console.error(`Variable ${n} is not a scalar. Line ${e.line}`):e.operator==="--"?i.value instanceof rr?i.value.value--:console.error(`Variable ${n} is not a scalar. Line ${e.line}`):console.error(`Unknown increment operator ${e.operator}. Line ${e.line}`):console.error(`Variable ${n} not found. Line ${e.line}`)}_getVariableData(e,r){if(e instanceof Xc){const n=this.getVariableName(e,r),i=r.getVariable(n);return i===null?(console.error(`Variable ${n} not found. Line ${e.line}`),null):i.value.getSubData(this,e.postfix,r)}if(e instanceof dl){if(e.operator==="*"){const n=this._getVariableData(e.right,r);return n instanceof Wy?n.reference.getSubData(this,e.postfix,r):(console.error(`Variable ${e.right} is not a pointer. Line ${e.line}`),null)}if(e.operator==="&"){const n=this._getVariableData(e.right,r);return new Wy(n)}}return null}_assign(e,r){let n=null,i="<var>",a=null;if(e.variable instanceof dl){const u=this._getVariableData(e.variable,r),h=this.evalExpression(e.value,r),f=e.operator;if(f==="="){if(u instanceof rr||u instanceof It||u instanceof Ai){if(h instanceof rr||h instanceof It||h instanceof Ai&&u.data.length===h.data.length)return void u.data.set(h.data);console.error(`Invalid assignment. Line ${e.line}`)}else if(u instanceof Ds&&h instanceof Ds&&u.buffer.byteLength-u.offset>=h.buffer.byteLength-h.offset)return void(u.buffer.byteLength%4==0?new Uint32Array(u.buffer,u.offset,u.typeInfo.size/4).set(new Uint32Array(h.buffer,h.offset,h.typeInfo.size/4)):new Uint8Array(u.buffer,u.offset,u.typeInfo.size).set(new Uint8Array(h.buffer,h.offset,h.typeInfo.size)));return console.error(`Invalid assignment. Line ${e.line}`),null}if(f==="+=")return u instanceof rr||u instanceof It||u instanceof Ai?h instanceof rr||h instanceof It||h instanceof Ai?void u.data.set(h.data.map((g,b)=>u.data[b]+g)):void console.error(`Invalid assignment . Line ${e.line}`):void console.error(`Invalid assignment. Line ${e.line}`);if(f==="-=")return(u instanceof rr||u instanceof It||u instanceof Ai)&&(h instanceof rr||h instanceof It||h instanceof Ai)?void u.data.set(h.data.map((g,b)=>u.data[b]-g)):void console.error(`Invalid assignment. Line ${e.line}`)}if(e.variable instanceof dl){if(e.variable.operator==="*"){i=this.getVariableName(e.variable.right,r);const u=r.getVariable(i);if(!(u&&u.value instanceof Wy))return void console.error(`Variable ${i} is not a pointer. Line ${e.line}`);n=u.value.reference;let h=e.variable.postfix;if(!h){let f=e.variable.right;for(;f instanceof dl;){if(f.postfix){h=f.postfix;break}f=f.right}}h&&(n=n.getSubData(this,h,r))}}else{a=e.variable.postfix,i=this.getVariableName(e.variable,r);const u=r.getVariable(i);if(u===null)return void console.error(`Variable ${i} not found. Line ${e.line}`);n=u.value}if(n instanceof Wy&&(n=n.reference),n===null)return void console.error(`Variable ${i} not found. Line ${e.line}`);const s=this.evalExpression(e.value,r),o=e.operator;if(o!=="="){const u=n.getSubData(this,a,r);if(u instanceof It&&s instanceof rr){const h=u.data,f=s.value;if(o==="+=")for(let g=0;g<h.length;++g)h[g]+=f;else if(o==="-=")for(let g=0;g<h.length;++g)h[g]-=f;else if(o==="*=")for(let g=0;g<h.length;++g)h[g]*=f;else if(o==="/=")for(let g=0;g<h.length;++g)h[g]/=f;else if(o==="%=")for(let g=0;g<h.length;++g)h[g]%=f;else if(o==="&=")for(let g=0;g<h.length;++g)h[g]&=f;else if(o==="|=")for(let g=0;g<h.length;++g)h[g]|=f;else if(o==="^=")for(let g=0;g<h.length;++g)h[g]^=f;else if(o==="<<=")for(let g=0;g<h.length;++g)h[g]<<=f;else if(o===">>=")for(let g=0;g<h.length;++g)h[g]>>=f;else console.error(`Invalid operator ${o}. Line ${e.line}`)}else if(u instanceof It&&s instanceof It){const h=u.data,f=s.data;if(h.length!==f.length)return void console.error(`Vector length mismatch. Line ${e.line}`);if(o==="+=")for(let g=0;g<h.length;++g)h[g]+=f[g];else if(o==="-=")for(let g=0;g<h.length;++g)h[g]-=f[g];else if(o==="*=")for(let g=0;g<h.length;++g)h[g]*=f[g];else if(o==="/=")for(let g=0;g<h.length;++g)h[g]/=f[g];else if(o==="%=")for(let g=0;g<h.length;++g)h[g]%=f[g];else if(o==="&=")for(let g=0;g<h.length;++g)h[g]&=f[g];else if(o==="|=")for(let g=0;g<h.length;++g)h[g]|=f[g];else if(o==="^=")for(let g=0;g<h.length;++g)h[g]^=f[g];else if(o==="<<=")for(let g=0;g<h.length;++g)h[g]<<=f[g];else if(o===">>=")for(let g=0;g<h.length;++g)h[g]>>=f[g];else console.error(`Invalid operator ${o}. Line ${e.line}`)}else{if(!(u instanceof rr&&s instanceof rr))return void console.error(`Invalid type for ${e.operator} operator. Line ${e.line}`);o==="+="?u.value+=s.value:o==="-="?u.value-=s.value:o==="*="?u.value*=s.value:o==="/="?u.value/=s.value:o==="%="?u.value%=s.value:o==="&="?u.value&=s.value:o==="|="?u.value|=s.value:o==="^="?u.value^=s.value:o==="<<="?u.value<<=s.value:o===">>="?u.value>>=s.value:console.error(`Invalid operator ${o}. Line ${e.line}`)}return void(n instanceof Ds&&n.setDataValue(this,u,a,r))}if(n instanceof Ds)n.setDataValue(this,s,a,r);else if(a){if(!(n instanceof It||n instanceof Ai))return void console.error(`Variable ${i} is not a vector or matrix. Line ${e.line}`);if(a instanceof b0){const u=this.evalExpression(a.index,r).value;if(n instanceof It){if(!(s instanceof rr))return void console.error(`Invalid assignment to ${i}. Line ${e.line}`);n.data[u]=s.value}else{if(!(n instanceof Ai))return void console.error(`Invalid assignment to ${i}. Line ${e.line}`);{const h=this.evalExpression(a.index,r).value;if(h<0)return void console.error(`Invalid assignment to ${i}. Line ${e.line}`);if(!(s instanceof It))return void console.error(`Invalid assignment to ${i}. Line ${e.line}`);{const f=n.typeInfo.getTypeName();if(f==="mat2x2"||f==="mat2x2f"||f==="mat2x2h"){if(!(h<2&&s.data.length===2))return void console.error(`Invalid assignment to ${i}. Line ${e.line}`);n.data[2*h]=s.data[0],n.data[2*h+1]=s.data[1]}else if(f==="mat2x3"||f==="mat2x3f"||f==="mat2x3h"){if(!(h<2&&s.data.length===3))return void console.error(`Invalid assignment to ${i}. Line ${e.line}`);n.data[3*h]=s.data[0],n.data[3*h+1]=s.data[1],n.data[3*h+2]=s.data[2]}else if(f==="mat2x4"||f==="mat2x4f"||f==="mat2x4h"){if(!(h<2&&s.data.length===4))return void console.error(`Invalid assignment to ${i}. Line ${e.line}`);n.data[4*h]=s.data[0],n.data[4*h+1]=s.data[1],n.data[4*h+2]=s.data[2],n.data[4*h+3]=s.data[3]}else if(f==="mat3x2"||f==="mat3x2f"||f==="mat3x2h"){if(!(h<3&&s.data.length===2))return void console.error(`Invalid assignment to ${i}. Line ${e.line}`);n.data[2*h]=s.data[0],n.data[2*h+1]=s.data[1]}else if(f==="mat3x3"||f==="mat3x3f"||f==="mat3x3h"){if(!(h<3&&s.data.length===3))return void console.error(`Invalid assignment to ${i}. Line ${e.line}`);n.data[3*h]=s.data[0],n.data[3*h+1]=s.data[1],n.data[3*h+2]=s.data[2]}else if(f==="mat3x4"||f==="mat3x4f"||f==="mat3x4h"){if(!(h<3&&s.data.length===4))return void console.error(`Invalid assignment to ${i}. Line ${e.line}`);n.data[4*h]=s.data[0],n.data[4*h+1]=s.data[1],n.data[4*h+2]=s.data[2],n.data[4*h+3]=s.data[3]}else if(f==="mat4x2"||f==="mat4x2f"||f==="mat4x2h"){if(!(h<4&&s.data.length===2))return void console.error(`Invalid assignment to ${i}. Line ${e.line}`);n.data[2*h]=s.data[0],n.data[2*h+1]=s.data[1]}else if(f==="mat4x3"||f==="mat4x3f"||f==="mat4x3h"){if(!(h<4&&s.data.length===3))return void console.error(`Invalid assignment to ${i}. Line ${e.line}`);n.data[3*h]=s.data[0],n.data[3*h+1]=s.data[1],n.data[3*h+2]=s.data[2]}else{if(f!=="mat4x4"&&f!=="mat4x4f"&&f!=="mat4x4h")return void console.error(`Invalid assignment to ${i}. Line ${e.line}`);if(!(h<4&&s.data.length===4))return void console.error(`Invalid assignment to ${i}. Line ${e.line}`);n.data[4*h]=s.data[0],n.data[4*h+1]=s.data[1],n.data[4*h+2]=s.data[2],n.data[4*h+3]=s.data[3]}}}}}else if(a instanceof Rm){const u=a.value;if(!(n instanceof It))return void console.error(`Invalid assignment to ${u}. Variable ${i} is not a vector. Line ${e.line}`);if(s instanceof rr){if(u.length>1)return void console.error(`Invalid assignment to ${u} for variable ${i}. Line ${e.line}`);if(u==="x")n.data[0]=s.value;else if(u==="y"){if(n.data.length<2)return void console.error(`Invalid assignment to ${u} for variable ${i}. Line ${e.line}`);n.data[1]=s.value}else if(u==="z"){if(n.data.length<3)return void console.error(`Invalid assignment to ${u} for variable ${i}. Line ${e.line}`);n.data[2]=s.value}else if(u==="w"){if(n.data.length<4)return void console.error(`Invalid assignment to ${u} for variable ${i}. Line ${e.line}`);n.data[3]=s.value}}else{if(!(s instanceof It))return void console.error(`Invalid assignment to ${i}. Line ${e.line}`);if(u.length!==s.data.length)return void console.error(`Invalid assignment to ${u} for variable ${i}. Line ${e.line}`);for(let h=0;h<u.length;++h){const f=u[h];if(f==="x"||f==="r")n.data[0]=s.data[h];else if(f==="y"||f==="g"){if(s.data.length<2)return void console.error(`Invalid assignment to ${f} for variable ${i}. Line ${e.line}`);n.data[1]=s.data[h]}else if(f==="z"||f==="b"){if(s.data.length<3)return void console.error(`Invalid assignment to ${f} for variable ${i}. Line ${e.line}`);n.data[2]=s.data[h]}else{if(f!=="w"&&f!=="a")return void console.error(`Invalid assignment to ${f} for variable ${i}. Line ${e.line}`);if(s.data.length<4)return void console.error(`Invalid assignment to ${f} for variable ${i}. Line ${e.line}`);n.data[3]=s.data[h]}}}}}else n instanceof rr&&s instanceof rr?n.value=s.value:n instanceof It&&s instanceof It||n instanceof Ai&&s instanceof Ai?n.data.set(s.data):console.error(`Invalid assignment to ${i}. Line ${e.line}`)}_function(e,r){const n=new qN(e);r.functions.set(e.name,n)}_const(e,r){let n=null;e.value!==null&&(n=this.evalExpression(e.value,r)),r.createVariable(e.name,n,e)}_let(e,r){let n=null;if(e.value!==null){if(n=this.evalExpression(e.value,r),n===null)return void console.error(`Invalid value for variable ${e.name}. Line ${e.line}`);e.value instanceof dl||(n=n.clone())}else{const i=e.type.name;if(i==="f32"||i==="i32"||i==="u32"||i==="bool"||i==="f16"||i==="vec2"||i==="vec3"||i==="vec4"||i==="vec2f"||i==="vec3f"||i==="vec4f"||i==="vec2i"||i==="vec3i"||i==="vec4i"||i==="vec2u"||i==="vec3u"||i==="vec4u"||i==="vec2h"||i==="vec3h"||i==="vec4h"||i==="vec2b"||i==="vec3b"||i==="vec4b"||i==="mat2x2"||i==="mat2x3"||i==="mat2x4"||i==="mat3x2"||i==="mat3x3"||i==="mat3x4"||i==="mat4x2"||i==="mat4x3"||i==="mat4x4"||i==="mat2x2f"||i==="mat2x3f"||i==="mat2x4f"||i==="mat3x2f"||i==="mat3x3f"||i==="mat3x4f"||i==="mat4x2f"||i==="mat4x3f"||i==="mat4x4f"||i==="mat2x2h"||i==="mat2x3h"||i==="mat2x4h"||i==="mat3x2h"||i==="mat3x3h"||i==="mat3x4h"||i==="mat4x2h"||i==="mat4x3h"||i==="mat4x4h"||i==="array"){const a=new jf(e.type,[]);n=this._evalCreate(a,r)}}r.createVariable(e.name,n,e)}_var(e,r){let n=null;if(e.value!==null){if(n=this.evalExpression(e.value,r),n===null)return void console.error(`Invalid value for variable ${e.name}. Line ${e.line}`);e.value instanceof dl||(n=n.clone())}else{if(e.type===null)return void console.error(`Variable ${e.name} has no type. Line ${e.line}`);const i=e.type.name;if(i==="f32"||i==="i32"||i==="u32"||i==="bool"||i==="f16"||i==="vec2"||i==="vec3"||i==="vec4"||i==="vec2f"||i==="vec3f"||i==="vec4f"||i==="vec2i"||i==="vec3i"||i==="vec4i"||i==="vec2u"||i==="vec3u"||i==="vec4u"||i==="vec2h"||i==="vec3h"||i==="vec4h"||i==="vec2b"||i==="vec3b"||i==="vec4b"||i==="mat2x2"||i==="mat2x3"||i==="mat2x4"||i==="mat3x2"||i==="mat3x3"||i==="mat3x4"||i==="mat4x2"||i==="mat4x3"||i==="mat4x4"||i==="mat2x2f"||i==="mat2x3f"||i==="mat2x4f"||i==="mat3x2f"||i==="mat3x3f"||i==="mat3x4f"||i==="mat4x2f"||i==="mat4x3f"||i==="mat4x4f"||i==="mat2x2h"||i==="mat2x3h"||i==="mat2x4h"||i==="mat3x2h"||i==="mat3x3h"||i==="mat3x4h"||i==="mat4x2h"||i==="mat4x3h"||i==="mat4x4h"||e.type instanceof z1||e.type instanceof kd||e.type instanceof hr){const a=new jf(e.type,[]);n=this._evalCreate(a,r)}}r.createVariable(e.name,n,e)}_switch(e,r){r=r.clone();const n=this.evalExpression(e.condition,r);if(!(n instanceof rr))return console.error(`Invalid if condition. Line ${e.line}`),null;let i=null;for(const a of e.cases)if(a instanceof $ee)for(const s of a.selectors){if(s instanceof Ow){i=a;continue}const o=this.evalExpression(s,r);if(!(o instanceof rr))return console.error(`Invalid case selector. Line ${e.line}`),null;if(o.value===n.value)return this._execStatements(a.body,r)}else a instanceof qee&&(i=a);return i?this._execStatements(i.body,r):null}_if(e,r){r=r.clone();const n=this.evalExpression(e.condition,r);if(!(n instanceof rr))return console.error(`Invalid if condition. Line ${e.line}`),null;if(n.value)return this._execStatements(e.body,r);for(const i of e.elseif){const a=this.evalExpression(i.condition,r);if(!(a instanceof rr))return console.error(`Invalid if condition. Line ${e.line}`),null;if(a.value)return this._execStatements(i.body,r)}return e.else?this._execStatements(e.else,r):null}_getScalarValue(e){return e instanceof rr?e.value:(console.error("Expected scalar value.",e),0)}_for(e,r){for(r=r.clone(),this.execStatement(e.init,r);this._getScalarValue(this.evalExpression(e.condition,r));){const n=this._execStatements(e.body,r);if(n===ju._breakObj)break;if(n!==null&&n!==ju._continueObj)return n;this.execStatement(e.increment,r)}return null}_loop(e,r){for(r=r.clone();;){const n=this._execStatements(e.body,r);if(n===ju._breakObj)break;if(n===ju._continueObj){if(e.continuing&&this._execStatements(e.continuing.body,r)===ju._breakObj)break}else if(n!==null)return n}return null}_while(e,r){for(r=r.clone();this._getScalarValue(this.evalExpression(e.condition,r));){const n=this._execStatements(e.body,r);if(n===ju._breakObj)break;if(n!==ju._continueObj&&n!==null)return n}return null}_evalBitcast(e,r){const n=this.evalExpression(e.value,r),i=e.type;if(n instanceof rr){const a=Mq(n.value,n.typeInfo.name,i.name);return new rr(a,this.getTypeInfo(i))}if(n instanceof It){const a=n.typeInfo.getTypeName();let s="";if(a.endsWith("f"))s="f32";else if(a.endsWith("i"))s="i32";else if(a.endsWith("u"))s="u32";else if(a.endsWith("b"))s="bool";else{if(!a.endsWith("h"))return console.error(`Unknown vector type ${a}. Line ${e.line}`),null;s="f16"}const o=i.getTypeName();let u="";if(o.endsWith("f"))u="f32";else if(o.endsWith("i"))u="i32";else if(o.endsWith("u"))u="u32";else if(o.endsWith("b"))u="bool";else{if(!o.endsWith("h"))return console.error(`Unknown vector type ${u}. Line ${e.line}`),null;u="f16"}const h=(function(f,g,b){if(g===b)return f;const v=new Array(f.length);for(let S=0;S<f.length;S++)v[S]=Mq(f[S],g,b);return v})(Array.from(n.data),s,u);return new It(h,this.getTypeInfo(i))}return console.error(`TODO: bitcast for ${n.typeInfo.name}. Line ${e.line}`),null}_evalConst(e,r){return r.getVariableValue(e.name).clone().getSubData(this,e.postfix,r)}_evalCreate(e,r){var n;if(e instanceof jf){if(e.type===null)return GM.void;switch(e.type.getTypeName()){case"bool":case"i32":case"u32":case"f32":case"f16":return this._callConstructorValue(e,r);case"vec2":case"vec3":case"vec4":case"vec2f":case"vec3f":case"vec4f":case"vec2h":case"vec3h":case"vec4h":case"vec2i":case"vec3i":case"vec4i":case"vec2u":case"vec3u":case"vec4u":case"vec2b":case"vec3b":case"vec4b":return this._callConstructorVec(e,r);case"mat2x2":case"mat2x2f":case"mat2x2h":case"mat2x3":case"mat2x3f":case"mat2x3h":case"mat2x4":case"mat2x4f":case"mat2x4h":case"mat3x2":case"mat3x2f":case"mat3x2h":case"mat3x3":case"mat3x3f":case"mat3x3h":case"mat3x4":case"mat3x4f":case"mat3x4h":case"mat4x2":case"mat4x2f":case"mat4x2h":case"mat4x3":case"mat4x3f":case"mat4x3h":case"mat4x4":case"mat4x4f":case"mat4x4h":return this._callConstructorMatrix(e,r)}}const i=e instanceof jf?e.type.name:e.name,a=e instanceof jf?this.getTypeInfo(e.type):this.getTypeInfo(e.name);if(a===null)return console.error(`Unknown type ${i}. Line ${e.line}`),null;if(a.size===0)return null;const s=new Ds(new ArrayBuffer(a.size),a,0);if(a instanceof zp){if(e.args)for(let o=0;o<e.args.length;++o){const u=a.members[o],h=e.args[o],f=this.evalExpression(h,r);s.setData(this,f,u.type,u.offset,r)}}else if(a instanceof Gp){let o=0;if(e.args)for(let u=0;u<e.args.length;++u){const h=e.args[u],f=this.evalExpression(h,r);a.format===null&&(((n=f.typeInfo)===null||n===void 0?void 0:n.name)==="x32"?a.format=this.getTypeInfo("i32"):a.format=f.typeInfo),s.setData(this,f,a.format,o,r),o+=a.stride}}else console.error(`Unknown type "${i}". Line ${e.line}`);return e instanceof jf?s.getSubData(this,e.postfix,r):s}_evalLiteral(e,r){const n=this.getTypeInfo(e.type),i=n.name;return i==="x32"||i==="u32"||i==="f32"||i==="f16"||i==="i32"||i==="bool"?new rr(e.scalarValue,n):i==="vec2"||i==="vec3"||i==="vec4"||i==="vec2f"||i==="vec3f"||i==="vec4f"||i==="vec2h"||i==="vec3h"||i==="vec4h"||i==="vec2i"||i==="vec3i"||i==="vec4i"||i==="vec2u"||i==="vec3u"||i==="vec4u"?this._callConstructorVec(e,r):i==="mat2x2"||i==="mat2x3"||i==="mat2x4"||i==="mat3x2"||i==="mat3x3"||i==="mat3x4"||i==="mat4x2"||i==="mat4x3"||i==="mat4x4"||i==="mat2x2f"||i==="mat2x3f"||i==="mat2x4f"||i==="mat3x2f"||i==="mat3x3f"||i==="mat3x4f"||i==="mat4x2f"||i==="mat4x3f"||i==="mat4x4f"||i==="mat2x2h"||i==="mat2x3h"||i==="mat2x4h"||i==="mat3x2h"||i==="mat3x3h"||i==="mat3x4h"||i==="mat4x2h"||i==="mat4x3h"||i==="mat4x4h"?this._callConstructorMatrix(e,r):e.value}_evalVariable(e,r){const n=r.getVariableValue(e.name);return n===null?n:n.getSubData(this,e.postfix,r)}_maxFormatTypeInfo(e){let r=e[0];if(r.name==="f32")return r;for(let n=1;n<e.length;++n){const i=ju._priority.get(r.name);ju._priority.get(e[n].name)<i&&(r=e[n])}return r.name==="x32"?this.getTypeInfo("i32"):r}_evalUnaryOp(e,r){const n=this.evalExpression(e.right,r);if(e.operator==="&")return new Wy(n);if(e.operator==="*")return n instanceof Wy?n.reference.getSubData(this,e.postfix,r):(console.error(`Invalid dereference. Line ${e.line}`),null);const i=n instanceof rr?n.value:n instanceof It?Array.from(n.data):null;switch(e.operator){case"+":{if(Mn(i)){const o=i.map((u,h)=>+u);return new It(o,n.typeInfo)}const a=i,s=this._maxFormatTypeInfo([n.typeInfo,n.typeInfo]);return new rr(+a,s)}case"-":{if(Mn(i)){const o=i.map((u,h)=>-u);return new It(o,n.typeInfo)}const a=i,s=this._maxFormatTypeInfo([n.typeInfo,n.typeInfo]);return new rr(-a,s)}case"!":{if(Mn(i)){const o=i.map((u,h)=>u?0:1);return new It(o,n.typeInfo)}const a=i,s=this._maxFormatTypeInfo([n.typeInfo,n.typeInfo]);return new rr(a?0:1,s)}case"~":{if(Mn(i)){const o=i.map((u,h)=>~u);return new It(o,n.typeInfo)}const a=i,s=this._maxFormatTypeInfo([n.typeInfo,n.typeInfo]);return new rr(~a,s)}}return console.error(`Invalid unary operator ${e.operator}. Line ${e.line}`),null}_evalBinaryOp(e,r){const n=this.evalExpression(e.left,r),i=this.evalExpression(e.right,r),a=n instanceof rr?n.value:n instanceof It||n instanceof Ai?Array.from(n.data):null,s=i instanceof rr?i.value:i instanceof It||i instanceof Ai?Array.from(i.data):null;switch(e.operator){case"+":{if(Mn(a)&&Mn(s)){const f=a,g=s;if(f.length!==g.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;const b=f.map((v,S)=>v+g[S]);return new It(b,n.typeInfo)}if(Mn(a)){const f=s,g=a.map((b,v)=>b+f);return new It(g,n.typeInfo)}if(Mn(s)){const f=a,g=s.map((b,v)=>f+b);return new It(g,i.typeInfo)}const o=a,u=s,h=this._maxFormatTypeInfo([n.typeInfo,i.typeInfo]);return new rr(o+u,h)}case"-":{if(Mn(a)&&Mn(s)){const f=a,g=s;if(f.length!==g.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;const b=f.map((v,S)=>v-g[S]);return new It(b,n.typeInfo)}if(Mn(a)){const f=s,g=a.map((b,v)=>b-f);return new It(g,n.typeInfo)}if(Mn(s)){const f=a,g=s.map((b,v)=>f-b);return new It(g,i.typeInfo)}const o=a,u=s,h=this._maxFormatTypeInfo([n.typeInfo,i.typeInfo]);return new rr(o-u,h)}case"*":{if(Mn(a)&&Mn(s)){const f=a,g=s;if(n instanceof Ai&&i instanceof Ai){const b=(function(P,k,L,O){if(nc[k.name]===void 0||nc[O.name]===void 0)return null;const M=nc[k.name][0],z=nc[k.name][1],B=nc[O.name][0];if(M!==nc[O.name][1])return null;const q=new Array(B*z);for(let W=0;W<z;W++)for(let G=0;G<B;G++){let ie=0;for(let Q=0;Q<M;Q++)ie+=P[Q*z+W]*L[G*M+Q];q[W*B+G]=ie}return q})(f,n.typeInfo,g,i.typeInfo);if(b===null)return console.error(`Matrix multiplication failed. Line ${e.line}.`),null;const v=nc[i.typeInfo.name][0],S=nc[n.typeInfo.name][1],E=this.getTypeInfo(`mat${v}x${S}f`);return new Ai(b,E)}if(n instanceof Ai&&i instanceof It){const b=(function(v,S,E,P){if(nc[S.name]===void 0||BI[P.name]===void 0)return null;const k=nc[S.name][0],L=nc[S.name][1];if(k!==E.length)return null;const O=new Array(L);for(let M=0;M<L;M++){let z=0;for(let B=0;B<k;B++)z+=v[B*L+M]*E[B];O[M]=z}return O})(f,n.typeInfo,g,i.typeInfo);return b===null?(console.error(`Matrix vector multiplication failed. Line ${e.line}.`),null):new It(b,i.typeInfo)}if(n instanceof It&&i instanceof Ai){const b=(function(v,S,E,P){if(BI[S.name]===void 0||nc[P.name]===void 0)return null;const k=nc[P.name][0],L=nc[P.name][1];if(L!==v.length)return null;const O=[];for(let M=0;M<k;M++){let z=0;for(let B=0;B<L;B++)z+=v[B]*E[B*k+M];O[M]=z}return O})(f,n.typeInfo,g,i.typeInfo);return b===null?(console.error(`Matrix vector multiplication failed. Line ${e.line}.`),null):new It(b,n.typeInfo)}{if(f.length!==g.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;const b=f.map((v,S)=>v*g[S]);return new It(b,n.typeInfo)}}if(Mn(a)){const f=s,g=a.map((b,v)=>b*f);return n instanceof Ai?new Ai(g,n.typeInfo):new It(g,n.typeInfo)}if(Mn(s)){const f=a,g=s.map((b,v)=>f*b);return i instanceof Ai?new Ai(g,i.typeInfo):new It(g,i.typeInfo)}const o=a,u=s,h=this._maxFormatTypeInfo([n.typeInfo,i.typeInfo]);return new rr(o*u,h)}case"%":{if(Mn(a)&&Mn(s)){const f=a,g=s;if(f.length!==g.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;const b=f.map((v,S)=>v%g[S]);return new It(b,n.typeInfo)}if(Mn(a)){const f=s,g=a.map((b,v)=>b%f);return new It(g,n.typeInfo)}if(Mn(s)){const f=a,g=s.map((b,v)=>f%b);return new It(g,i.typeInfo)}const o=a,u=s,h=this._maxFormatTypeInfo([n.typeInfo,i.typeInfo]);return new rr(o%u,h)}case"/":{if(Mn(a)&&Mn(s)){const f=a,g=s;if(f.length!==g.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;const b=f.map((v,S)=>v/g[S]);return new It(b,n.typeInfo)}if(Mn(a)){const f=s,g=a.map((b,v)=>b/f);return new It(g,n.typeInfo)}if(Mn(s)){const f=a,g=s.map((b,v)=>f/b);return new It(g,i.typeInfo)}const o=a,u=s,h=this._maxFormatTypeInfo([n.typeInfo,i.typeInfo]);return new rr(o/u,h)}case"&":{if(Mn(a)&&Mn(s)){const f=a,g=s;if(f.length!==g.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;const b=f.map((v,S)=>v&g[S]);return new It(b,n.typeInfo)}if(Mn(a)){const f=s,g=a.map((b,v)=>b&f);return new It(g,n.typeInfo)}if(Mn(s)){const f=a,g=s.map((b,v)=>f&b);return new It(g,i.typeInfo)}const o=a,u=s,h=this._maxFormatTypeInfo([n.typeInfo,i.typeInfo]);return new rr(o&u,h)}case"|":{if(Mn(a)&&Mn(s)){const f=a,g=s;if(f.length!==g.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;const b=f.map((v,S)=>v|g[S]);return new It(b,n.typeInfo)}if(Mn(a)){const f=s,g=a.map((b,v)=>b|f);return new It(g,n.typeInfo)}if(Mn(s)){const f=a,g=s.map((b,v)=>f|b);return new It(g,i.typeInfo)}const o=a,u=s,h=this._maxFormatTypeInfo([n.typeInfo,i.typeInfo]);return new rr(o|u,h)}case"^":{if(Mn(a)&&Mn(s)){const f=a,g=s;if(f.length!==g.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;const b=f.map((v,S)=>v^g[S]);return new It(b,n.typeInfo)}if(Mn(a)){const f=s,g=a.map((b,v)=>b^f);return new It(g,n.typeInfo)}if(Mn(s)){const f=a,g=s.map((b,v)=>f^b);return new It(g,i.typeInfo)}const o=a,u=s,h=this._maxFormatTypeInfo([n.typeInfo,i.typeInfo]);return new rr(o^u,h)}case"<<":{if(Mn(a)&&Mn(s)){const f=a,g=s;if(f.length!==g.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;const b=f.map((v,S)=>v<<g[S]);return new It(b,n.typeInfo)}if(Mn(a)){const f=s,g=a.map((b,v)=>b<<f);return new It(g,n.typeInfo)}if(Mn(s)){const f=a,g=s.map((b,v)=>f<<b);return new It(g,i.typeInfo)}const o=a,u=s,h=this._maxFormatTypeInfo([n.typeInfo,i.typeInfo]);return new rr(o<<u,h)}case">>":{if(Mn(a)&&Mn(s)){const f=a,g=s;if(f.length!==g.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;const b=f.map((v,S)=>v>>g[S]);return new It(b,n.typeInfo)}if(Mn(a)){const f=s,g=a.map((b,v)=>b>>f);return new It(g,n.typeInfo)}if(Mn(s)){const f=a,g=s.map((b,v)=>f>>b);return new It(g,i.typeInfo)}const o=a,u=s,h=this._maxFormatTypeInfo([n.typeInfo,i.typeInfo]);return new rr(o>>u,h)}case">":if(Mn(a)&&Mn(s)){const o=a,u=s;if(o.length!==u.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;const h=o.map((f,g)=>f>u[g]?1:0);return new It(h,n.typeInfo)}if(Mn(a)){const o=s,u=a.map((h,f)=>h>o?1:0);return new It(u,n.typeInfo)}if(Mn(s)){const o=a,u=s.map((h,f)=>o>h?1:0);return new It(u,i.typeInfo)}return new rr(a>s?1:0,this.getTypeInfo("bool"));case"<":if(Mn(a)&&Mn(s)){const o=a,u=s;if(o.length!==u.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;const h=o.map((f,g)=>f<u[g]?1:0);return new It(h,n.typeInfo)}if(Mn(a)){const o=s,u=a.map((h,f)=>h<o?1:0);return new It(u,n.typeInfo)}if(Mn(s)){const o=a,u=s.map((h,f)=>o<h?1:0);return new It(u,i.typeInfo)}return new rr(a<s?1:0,this.getTypeInfo("bool"));case"==":if(Mn(a)&&Mn(s)){const o=a,u=s;if(o.length!==u.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;const h=o.map((f,g)=>f===u[g]?1:0);return new It(h,n.typeInfo)}if(Mn(a)){const o=s,u=a.map((h,f)=>h==o?1:0);return new It(u,n.typeInfo)}if(Mn(s)){const o=a,u=s.map((h,f)=>o==h?1:0);return new It(u,i.typeInfo)}return new rr(a===s?1:0,this.getTypeInfo("bool"));case"!=":if(Mn(a)&&Mn(s)){const o=a,u=s;if(o.length!==u.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;const h=o.map((f,g)=>f!==u[g]?1:0);return new It(h,n.typeInfo)}if(Mn(a)){const o=s,u=a.map((h,f)=>h!==o?1:0);return new It(u,n.typeInfo)}if(Mn(s)){const o=a,u=s.map((h,f)=>o!==h?1:0);return new It(u,i.typeInfo)}return new rr(a!==s?1:0,this.getTypeInfo("bool"));case">=":if(Mn(a)&&Mn(s)){const o=a,u=s;if(o.length!==u.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;const h=o.map((f,g)=>f>=u[g]?1:0);return new It(h,n.typeInfo)}if(Mn(a)){const o=s,u=a.map((h,f)=>h>=o?1:0);return new It(u,n.typeInfo)}if(Mn(s)){const o=a,u=s.map((h,f)=>o>=h?1:0);return new It(u,i.typeInfo)}return new rr(a>=s?1:0,this.getTypeInfo("bool"));case"<=":if(Mn(a)&&Mn(s)){const o=a,u=s;if(o.length!==u.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;const h=o.map((f,g)=>f<=u[g]?1:0);return new It(h,n.typeInfo)}if(Mn(a)){const o=s,u=a.map((h,f)=>h<=o?1:0);return new It(u,n.typeInfo)}if(Mn(s)){const o=a,u=s.map((h,f)=>o<=h?1:0);return new It(u,i.typeInfo)}return new rr(a<=s?1:0,this.getTypeInfo("bool"));case"&&":if(Mn(a)&&Mn(s)){const o=a,u=s;if(o.length!==u.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;const h=o.map((f,g)=>f&&u[g]?1:0);return new It(h,n.typeInfo)}if(Mn(a)){const o=s,u=a.map((h,f)=>h&&o?1:0);return new It(u,n.typeInfo)}if(Mn(s)){const o=a,u=s.map((h,f)=>o&&h?1:0);return new It(u,i.typeInfo)}return new rr(a&&s?1:0,this.getTypeInfo("bool"));case"||":if(Mn(a)&&Mn(s)){const o=a,u=s;if(o.length!==u.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;const h=o.map((f,g)=>f||u[g]?1:0);return new It(h,n.typeInfo)}if(Mn(a)){const o=s,u=a.map((h,f)=>h||o?1:0);return new It(u,n.typeInfo)}if(Mn(s)){const o=a,u=s.map((h,f)=>o||h?1:0);return new It(u,i.typeInfo)}return new rr(a||s?1:0,this.getTypeInfo("bool"))}return console.error(`Unknown operator ${e.operator}. Line ${e.line}`),null}_evalCall(e,r){if(e.cachedReturnValue!==null)return e.cachedReturnValue;const n=r.clone();n.currentFunctionName=e.name;const i=r.getFunction(e.name);if(!i)return e.isBuiltin?this._callBuiltinFunction(e,n):this.getTypeInfo(e.name)?this._evalCreate(e,r):(console.error(`Unknown function "${e.name}". Line ${e.line}`),null);for(let a=0;a<i.node.args.length;++a){const s=i.node.args[a],o=this.evalExpression(e.args[a],n);n.createVariable(s.name,o,s)}return this._execStatements(i.node.body,n)}_callBuiltinFunction(e,r){switch(e.name){case"all":return this.builtins.All(e,r);case"any":return this.builtins.Any(e,r);case"select":return this.builtins.Select(e,r);case"arrayLength":return this.builtins.ArrayLength(e,r);case"abs":return this.builtins.Abs(e,r);case"acos":return this.builtins.Acos(e,r);case"acosh":return this.builtins.Acosh(e,r);case"asin":return this.builtins.Asin(e,r);case"asinh":return this.builtins.Asinh(e,r);case"atan":return this.builtins.Atan(e,r);case"atanh":return this.builtins.Atanh(e,r);case"atan2":return this.builtins.Atan2(e,r);case"ceil":return this.builtins.Ceil(e,r);case"clamp":return this.builtins.Clamp(e,r);case"cos":return this.builtins.Cos(e,r);case"cosh":return this.builtins.Cosh(e,r);case"countLeadingZeros":return this.builtins.CountLeadingZeros(e,r);case"countOneBits":return this.builtins.CountOneBits(e,r);case"countTrailingZeros":return this.builtins.CountTrailingZeros(e,r);case"cross":return this.builtins.Cross(e,r);case"degrees":return this.builtins.Degrees(e,r);case"determinant":return this.builtins.Determinant(e,r);case"distance":return this.builtins.Distance(e,r);case"dot":return this.builtins.Dot(e,r);case"dot4U8Packed":return this.builtins.Dot4U8Packed(e,r);case"dot4I8Packed":return this.builtins.Dot4I8Packed(e,r);case"exp":return this.builtins.Exp(e,r);case"exp2":return this.builtins.Exp2(e,r);case"extractBits":return this.builtins.ExtractBits(e,r);case"faceForward":return this.builtins.FaceForward(e,r);case"firstLeadingBit":return this.builtins.FirstLeadingBit(e,r);case"firstTrailingBit":return this.builtins.FirstTrailingBit(e,r);case"floor":return this.builtins.Floor(e,r);case"fma":return this.builtins.Fma(e,r);case"fract":return this.builtins.Fract(e,r);case"frexp":return this.builtins.Frexp(e,r);case"insertBits":return this.builtins.InsertBits(e,r);case"inverseSqrt":return this.builtins.InverseSqrt(e,r);case"ldexp":return this.builtins.Ldexp(e,r);case"length":return this.builtins.Length(e,r);case"log":return this.builtins.Log(e,r);case"log2":return this.builtins.Log2(e,r);case"max":return this.builtins.Max(e,r);case"min":return this.builtins.Min(e,r);case"mix":return this.builtins.Mix(e,r);case"modf":return this.builtins.Modf(e,r);case"normalize":return this.builtins.Normalize(e,r);case"pow":return this.builtins.Pow(e,r);case"quantizeToF16":return this.builtins.QuantizeToF16(e,r);case"radians":return this.builtins.Radians(e,r);case"reflect":return this.builtins.Reflect(e,r);case"refract":return this.builtins.Refract(e,r);case"reverseBits":return this.builtins.ReverseBits(e,r);case"round":return this.builtins.Round(e,r);case"saturate":return this.builtins.Saturate(e,r);case"sign":return this.builtins.Sign(e,r);case"sin":return this.builtins.Sin(e,r);case"sinh":return this.builtins.Sinh(e,r);case"smoothstep":return this.builtins.SmoothStep(e,r);case"sqrt":return this.builtins.Sqrt(e,r);case"step":return this.builtins.Step(e,r);case"tan":return this.builtins.Tan(e,r);case"tanh":return this.builtins.Tanh(e,r);case"transpose":return this.builtins.Transpose(e,r);case"trunc":return this.builtins.Trunc(e,r);case"dpdx":return this.builtins.Dpdx(e,r);case"dpdxCoarse":return this.builtins.DpdxCoarse(e,r);case"dpdxFine":return this.builtins.DpdxFine(e,r);case"dpdy":return this.builtins.Dpdy(e,r);case"dpdyCoarse":return this.builtins.DpdyCoarse(e,r);case"dpdyFine":return this.builtins.DpdyFine(e,r);case"fwidth":return this.builtins.Fwidth(e,r);case"fwidthCoarse":return this.builtins.FwidthCoarse(e,r);case"fwidthFine":return this.builtins.FwidthFine(e,r);case"textureDimensions":return this.builtins.TextureDimensions(e,r);case"textureGather":return this.builtins.TextureGather(e,r);case"textureGatherCompare":return this.builtins.TextureGatherCompare(e,r);case"textureLoad":return this.builtins.TextureLoad(e,r);case"textureNumLayers":return this.builtins.TextureNumLayers(e,r);case"textureNumLevels":return this.builtins.TextureNumLevels(e,r);case"textureNumSamples":return this.builtins.TextureNumSamples(e,r);case"textureSample":return this.builtins.TextureSample(e,r);case"textureSampleBias":return this.builtins.TextureSampleBias(e,r);case"textureSampleCompare":return this.builtins.TextureSampleCompare(e,r);case"textureSampleCompareLevel":return this.builtins.TextureSampleCompareLevel(e,r);case"textureSampleGrad":return this.builtins.TextureSampleGrad(e,r);case"textureSampleLevel":return this.builtins.TextureSampleLevel(e,r);case"textureSampleBaseClampToEdge":return this.builtins.TextureSampleBaseClampToEdge(e,r);case"textureStore":return this.builtins.TextureStore(e,r);case"atomicLoad":return this.builtins.AtomicLoad(e,r);case"atomicStore":return this.builtins.AtomicStore(e,r);case"atomicAdd":return this.builtins.AtomicAdd(e,r);case"atomicSub":return this.builtins.AtomicSub(e,r);case"atomicMax":return this.builtins.AtomicMax(e,r);case"atomicMin":return this.builtins.AtomicMin(e,r);case"atomicAnd":return this.builtins.AtomicAnd(e,r);case"atomicOr":return this.builtins.AtomicOr(e,r);case"atomicXor":return this.builtins.AtomicXor(e,r);case"atomicExchange":return this.builtins.AtomicExchange(e,r);case"atomicCompareExchangeWeak":return this.builtins.AtomicCompareExchangeWeak(e,r);case"pack4x8snorm":return this.builtins.Pack4x8snorm(e,r);case"pack4x8unorm":return this.builtins.Pack4x8unorm(e,r);case"pack4xI8":return this.builtins.Pack4xI8(e,r);case"pack4xU8":return this.builtins.Pack4xU8(e,r);case"pack4x8Clamp":return this.builtins.Pack4x8Clamp(e,r);case"pack4xU8Clamp":return this.builtins.Pack4xU8Clamp(e,r);case"pack2x16snorm":return this.builtins.Pack2x16snorm(e,r);case"pack2x16unorm":return this.builtins.Pack2x16unorm(e,r);case"pack2x16float":return this.builtins.Pack2x16float(e,r);case"unpack4x8snorm":return this.builtins.Unpack4x8snorm(e,r);case"unpack4x8unorm":return this.builtins.Unpack4x8unorm(e,r);case"unpack4xI8":return this.builtins.Unpack4xI8(e,r);case"unpack4xU8":return this.builtins.Unpack4xU8(e,r);case"unpack2x16snorm":return this.builtins.Unpack2x16snorm(e,r);case"unpack2x16unorm":return this.builtins.Unpack2x16unorm(e,r);case"unpack2x16float":return this.builtins.Unpack2x16float(e,r);case"storageBarrier":return this.builtins.StorageBarrier(e,r);case"textureBarrier":return this.builtins.TextureBarrier(e,r);case"workgroupBarrier":return this.builtins.WorkgroupBarrier(e,r);case"workgroupUniformLoad":return this.builtins.WorkgroupUniformLoad(e,r);case"subgroupAdd":return this.builtins.SubgroupAdd(e,r);case"subgroupExclusiveAdd":return this.builtins.SubgroupExclusiveAdd(e,r);case"subgroupInclusiveAdd":return this.builtins.SubgroupInclusiveAdd(e,r);case"subgroupAll":return this.builtins.SubgroupAll(e,r);case"subgroupAnd":return this.builtins.SubgroupAnd(e,r);case"subgroupAny":return this.builtins.SubgroupAny(e,r);case"subgroupBallot":return this.builtins.SubgroupBallot(e,r);case"subgroupBroadcast":return this.builtins.SubgroupBroadcast(e,r);case"subgroupBroadcastFirst":return this.builtins.SubgroupBroadcastFirst(e,r);case"subgroupElect":return this.builtins.SubgroupElect(e,r);case"subgroupMax":return this.builtins.SubgroupMax(e,r);case"subgroupMin":return this.builtins.SubgroupMin(e,r);case"subgroupMul":return this.builtins.SubgroupMul(e,r);case"subgroupExclusiveMul":return this.builtins.SubgroupExclusiveMul(e,r);case"subgroupInclusiveMul":return this.builtins.SubgroupInclusiveMul(e,r);case"subgroupOr":return this.builtins.SubgroupOr(e,r);case"subgroupShuffle":return this.builtins.SubgroupShuffle(e,r);case"subgroupShuffleDown":return this.builtins.SubgroupShuffleDown(e,r);case"subgroupShuffleUp":return this.builtins.SubgroupShuffleUp(e,r);case"subgroupShuffleXor":return this.builtins.SubgroupShuffleXor(e,r);case"subgroupXor":return this.builtins.SubgroupXor(e,r);case"quadBroadcast":return this.builtins.QuadBroadcast(e,r);case"quadSwapDiagonal":return this.builtins.QuadSwapDiagonal(e,r);case"quadSwapX":return this.builtins.QuadSwapX(e,r);case"quadSwapY":return this.builtins.QuadSwapY(e,r)}const n=r.getFunction(e.name);if(n){const i=r.clone();for(let a=0;a<n.node.args.length;++a){const s=n.node.args[a],o=this.evalExpression(e.args[a],i);i.setVariable(s.name,o,s)}return this._execStatements(n.node.body,i)}return null}_callConstructorValue(e,r){if(!e.args||e.args.length===0)return new rr(0,this.getTypeInfo(e.type));const n=this.evalExpression(e.args[0],r);return n.typeInfo=this.getTypeInfo(e.type),n.getSubData(this,e.postfix,r).clone()}_callConstructorVec(e,r){const n=this.getTypeInfo(e.type),i=e.type.getTypeName(),a=BI[i];if(a===void 0)return console.error(`Invalid vec constructor ${i}. Line ${e.line}`),null;const s=[];if(e instanceof Pl)if(e.isVector){const o=e.vectorValue;for(const u of o)s.push(u)}else s.push(e.scalarValue);else if(e.args)for(const o of e.args){const u=this.evalExpression(o,r);if(u instanceof It){const h=u.data;for(let f=0;f<h.length;++f){let g=h[f];s.push(g)}}else if(u instanceof rr){let h=u.value;s.push(h)}}if(e.type instanceof hr&&e.type.format===null&&(e.type.format=hr.f32),s.length===0){const o=new Array(a).fill(0);return new It(o,n).getSubData(this,e.postfix,r)}if(s.length===1)for(;s.length<a;)s.push(s[0]);return s.length<a?(console.error(`Invalid vec constructor. Line ${e.line}`),null):new It(s.length>a?s.slice(0,a):s,n).getSubData(this,e.postfix,r)}_callConstructorMatrix(e,r){const n=this.getTypeInfo(e.type),i=e.type.getTypeName(),a=nc[i];if(a===void 0)return console.error(`Invalid matrix constructor ${i}. Line ${e.line}`),null;const s=[];if(e instanceof Pl)if(e.isVector){const o=e.vectorValue;for(const u of o)s.push(u)}else s.push(e.scalarValue);else if(e.args)for(const o of e.args){const u=this.evalExpression(o,r);u instanceof It?s.push(...u.data):u instanceof rr?s.push(u.value):u instanceof Ai&&s.push(...u.data)}if(n instanceof Mm&&n.format===null&&(n.format=this.getTypeInfo("f32")),s.length===0){const o=new Array(a[2]).fill(0);return new Ai(o,n).getSubData(this,e.postfix,r)}return s.length!==a[2]?(console.error(`Invalid matrix constructor. Line ${e.line}`),null):new Ai(s,n).getSubData(this,e.postfix,r)}}ju._breakObj=new Lh(new wh("BREAK",null),null),ju._continueObj=new Lh(new wh("CONTINUE",null),null),ju._priority=new Map([["f32",0],["f16",1],["u32",2],["i32",3],["x32",3]]);class oze{constructor(){this.constants=new Map,this.aliases=new Map,this.structs=new Map}}class sze{constructor(){this._tokens=[],this._current=0,this._currentLine=1,this._deferArrayCountEval=[],this._currentLoop=[],this._context=new oze,this._exec=new ju,this._forwardTypeCount=0}parse(e){this._initialize(e),this._deferArrayCountEval.length=0;const r=[];for(;!this._isAtEnd();){const n=this._global_decl_or_directive();if(!n)break;r.push(n)}if(this._deferArrayCountEval.length>0){for(const n of this._deferArrayCountEval){const i=n.arrayType,a=n.countNode;if(a instanceof Xc){const s=a.name,o=this._context.constants.get(s);if(o)try{const u=o.constEvaluate(this._exec);i.count=u}catch{}}}this._deferArrayCountEval.length=0}if(this._forwardTypeCount>0)for(const n of r)n.search(i=>{i instanceof Pq||i instanceof Rw?i.type=this._forwardType(i.type):i instanceof z1?i.format=this._forwardType(i.format):i instanceof Ld||i instanceof B1||i instanceof Mw?i.type=this._forwardType(i.type):i instanceof Cb?i.returnType=this._forwardType(i.returnType):i instanceof Iq&&(i.type=this._forwardType(i.type))});return r}_forwardType(e){if(e instanceof Aq){const r=this._getType(e.name);if(r)return r}else e instanceof Rw?e.type=this._forwardType(e.type):e instanceof z1&&(e.format=this._forwardType(e.format));return e}_initialize(e){if(e)if(typeof e=="string"){const r=new ZBe(e);this._tokens=r.scanTokens()}else this._tokens=e;else this._tokens=[];this._current=0}_updateNode(e,r){return e.line=r??this._currentLine,e}_error(e,r){return{token:e,message:r,toString:()=>`${r}`}}_isAtEnd(){return this._current>=this._tokens.length||this._peek().type==gt.eof}_match(e){if(e instanceof sr)return!!this._check(e)&&(this._advance(),!0);for(let r=0,n=e.length;r<n;++r){const i=e[r];if(this._check(i))return this._advance(),!0}return!1}_consume(e,r){if(this._check(e))return this._advance();throw this._error(this._peek(),`${r}. Line:${this._currentLine}`)}_check(e){if(this._isAtEnd())return!1;const r=this._peek();if(e instanceof Array){const n=r.type;let i=!1;for(const a of e){if(n===a)return!0;a===gt.tokens.name&&(i=!0)}if(i){const a=gt.tokens.name.rule.exec(r.lexeme);if(a&&a.index==0&&a[0]==r.lexeme)return!0}return!1}if(r.type===e)return!0;if(e===gt.tokens.name){const n=gt.tokens.name.rule.exec(r.lexeme);return n&&n.index==0&&n[0]==r.lexeme}return!1}_advance(){var e,r;return this._currentLine=(r=(e=this._peek())===null||e===void 0?void 0:e.line)!==null&&r!==void 0?r:-1,this._isAtEnd()||this._current++,this._previous()}_peek(){return this._tokens[this._current]}_previous(){return this._tokens[this._current-1]}_global_decl_or_directive(){for(;this._match(gt.tokens.semicolon)&&!this._isAtEnd(););if(this._match(gt.keywords.alias)){const r=this._type_alias();return this._consume(gt.tokens.semicolon,"Expected ';'"),this._exec.reflection.updateAST([r]),r}if(this._match(gt.keywords.diagnostic)){const r=this._diagnostic();return this._consume(gt.tokens.semicolon,"Expected ';'"),this._exec.reflection.updateAST([r]),r}if(this._match(gt.keywords.requires)){const r=this._requires_directive();return this._consume(gt.tokens.semicolon,"Expected ';'"),this._exec.reflection.updateAST([r]),r}if(this._match(gt.keywords.enable)){const r=this._enable_directive();return this._consume(gt.tokens.semicolon,"Expected ';'"),this._exec.reflection.updateAST([r]),r}const e=this._attribute();if(this._check(gt.keywords.var)){const r=this._global_variable_decl();return r!=null&&(r.attributes=e),this._consume(gt.tokens.semicolon,"Expected ';'."),this._exec.reflection.updateAST([r]),r}if(this._check(gt.keywords.override)){const r=this._override_variable_decl();return r!=null&&(r.attributes=e),this._consume(gt.tokens.semicolon,"Expected ';'."),this._exec.reflection.updateAST([r]),r}if(this._check(gt.keywords.let)){const r=this._global_let_decl();return r!=null&&(r.attributes=e),this._consume(gt.tokens.semicolon,"Expected ';'."),this._exec.reflection.updateAST([r]),r}if(this._check(gt.keywords.const)){const r=this._global_const_decl();return r!=null&&(r.attributes=e),this._consume(gt.tokens.semicolon,"Expected ';'."),this._exec.reflection.updateAST([r]),r}if(this._check(gt.keywords.struct)){const r=this._struct_decl();return r!=null&&(r.attributes=e),this._exec.reflection.updateAST([r]),r}if(this._check(gt.keywords.fn)){const r=this._function_decl();return r!=null&&(r.attributes=e),this._exec.reflection.updateAST([r]),r}return null}_function_decl(){if(!this._match(gt.keywords.fn))return null;const e=this._currentLine,r=this._consume(gt.tokens.ident,"Expected function name.").toString();this._consume(gt.tokens.paren_left,"Expected '(' for function arguments.");const n=[];if(!this._check(gt.tokens.paren_right))do{if(this._check(gt.tokens.paren_right))break;const o=this._attribute(),u=this._consume(gt.tokens.name,"Expected argument name.").toString();this._consume(gt.tokens.colon,"Expected ':' for argument type.");const h=this._attribute(),f=this._type_decl();f!=null&&(f.attributes=h,n.push(this._updateNode(new Iq(u,f,o))))}while(this._match(gt.tokens.comma));this._consume(gt.tokens.paren_right,"Expected ')' after function arguments.");let i=null;if(this._match(gt.tokens.arrow)){const o=this._attribute();i=this._type_decl(),i!=null&&(i.attributes=o)}const a=this._compound_statement(),s=this._currentLine;return this._updateNode(new Cb(r,n,i,a,e,s),e)}_compound_statement(){const e=[];for(this._consume(gt.tokens.brace_left,"Expected '{' for block.");!this._check(gt.tokens.brace_right);){const r=this._statement();r!==null&&e.push(r)}return this._consume(gt.tokens.brace_right,"Expected '}' for block."),e}_statement(){for(;this._match(gt.tokens.semicolon)&&!this._isAtEnd(););if(this._check(gt.tokens.attr)&&this._attribute(),this._check(gt.keywords.if))return this._if_statement();if(this._check(gt.keywords.switch))return this._switch_statement();if(this._check(gt.keywords.loop))return this._loop_statement();if(this._check(gt.keywords.for))return this._for_statement();if(this._check(gt.keywords.while))return this._while_statement();if(this._check(gt.keywords.continuing))return this._continuing_statement();if(this._check(gt.keywords.static_assert))return this._static_assert_statement();if(this._check(gt.tokens.brace_left))return this._compound_statement();let e=null;if(this._check(gt.keywords.return))e=this._return_statement();else if(this._check([gt.keywords.var,gt.keywords.let,gt.keywords.const]))e=this._variable_statement();else if(this._match(gt.keywords.discard))e=this._updateNode(new GBe);else if(this._match(gt.keywords.break)){const r=this._updateNode(new Fee);if(this._currentLoop.length>0){const n=this._currentLoop[this._currentLoop.length-1];r.loopId=n.id}e=r,this._check(gt.keywords.if)&&(this._advance(),r.condition=this._optional_paren_expression())}else if(this._match(gt.keywords.continue)){const r=this._updateNode(new Bee);if(!(this._currentLoop.length>0))throw this._error(this._peek(),`Continue statement must be inside a loop. Line: ${r.line}`);{const n=this._currentLoop[this._currentLoop.length-1];r.loopId=n.id}e=r}else e=this._increment_decrement_statement()||this._func_call_statement()||this._assignment_statement();return e!=null&&this._consume(gt.tokens.semicolon,"Expected ';' after statement."),e}_static_assert_statement(){if(!this._match(gt.keywords.static_assert))return null;const e=this._currentLine,r=this._optional_paren_expression();return this._updateNode(new qBe(r),e)}_while_statement(){if(!this._match(gt.keywords.while))return null;const e=this._updateNode(new Iee(null,null));return this._currentLoop.push(e),e.condition=this._optional_paren_expression(),this._check(gt.tokens.attr)&&this._attribute(),e.body=this._compound_statement(),this._currentLoop.pop(),e}_continuing_statement(){const e=this._currentLoop.length>0?this._currentLoop[this._currentLoop.length-1].id:-1;if(!this._match(gt.keywords.continuing))return null;const r=this._currentLine,n=this._compound_statement();return this._updateNode(new WM(n,e),r)}_for_statement(){if(!this._match(gt.keywords.for))return null;this._consume(gt.tokens.paren_left,"Expected '('.");const e=this._updateNode(new Pee(null,null,null,null));return this._currentLoop.push(e),e.init=this._check(gt.tokens.semicolon)?null:this._for_init(),this._consume(gt.tokens.semicolon,"Expected ';'."),e.condition=this._check(gt.tokens.semicolon)?null:this._short_circuit_or_expression(),this._consume(gt.tokens.semicolon,"Expected ';'."),e.increment=this._check(gt.tokens.paren_right)?null:this._for_increment(),this._consume(gt.tokens.paren_right,"Expected ')'."),this._check(gt.tokens.attr)&&this._attribute(),e.body=this._compound_statement(),this._currentLoop.pop(),e}_for_init(){return this._variable_statement()||this._func_call_statement()||this._assignment_statement()}_for_increment(){return this._func_call_statement()||this._increment_decrement_statement()||this._assignment_statement()}_variable_statement(){if(this._check(gt.keywords.var)){const e=this._variable_decl();if(e===null)throw this._error(this._peek(),"Variable declaration expected.");let r=null;return this._match(gt.tokens.equal)&&(r=this._short_circuit_or_expression()),this._updateNode(new Ld(e.name,e.type,e.storage,e.access,r),e.line)}if(this._match(gt.keywords.let)){const e=this._currentLine,r=this._consume(gt.tokens.name,"Expected name for let.").toString();let n=null;if(this._match(gt.tokens.colon)){const a=this._attribute();n=this._type_decl(),n!=null&&(n.attributes=a)}this._consume(gt.tokens.equal,"Expected '=' for let.");const i=this._short_circuit_or_expression();return this._updateNode(new B1(r,n,null,null,i),e)}if(this._match(gt.keywords.const)){const e=this._currentLine,r=this._consume(gt.tokens.name,"Expected name for const.").toString();let n=null;if(this._match(gt.tokens.colon)){const a=this._attribute();n=this._type_decl(),n!=null&&(n.attributes=a)}this._consume(gt.tokens.equal,"Expected '=' for const.");const i=this._short_circuit_or_expression();return n===null&&i instanceof Pl&&(n=i.type),this._updateNode(new Mw(r,n,null,null,i),e)}return null}_increment_decrement_statement(){const e=this._current,r=this._unary_expression();if(r==null)return null;if(!this._check(gt.increment_operators))return this._current=e,null;const n=this._consume(gt.increment_operators,"Expected increment operator");return this._updateNode(new kee(n.type===gt.tokens.plus_plus?Mv.increment:Mv.decrement,r))}_assignment_statement(){let e=null;const r=this._currentLine;if(this._check(gt.tokens.brace_right))return null;let n=this._match(gt.tokens.underscore);if(n||(e=this._unary_expression()),!n&&e==null)return null;const i=this._consume(gt.assignment_operators,"Expected assignment operator."),a=this._short_circuit_or_expression();return this._updateNode(new Mee(d1.parse(i.lexeme),e,a),r)}_func_call_statement(){if(!this._check(gt.tokens.ident))return null;const e=this._currentLine,r=this._current,n=this._consume(gt.tokens.ident,"Expected function name."),i=this._argument_expression_list();return i===null?(this._current=r,null):this._updateNode(new zN(n.lexeme,i),e)}_loop_statement(){if(!this._match(gt.keywords.loop))return null;this._check(gt.tokens.attr)&&this._attribute(),this._consume(gt.tokens.brace_left,"Expected '{' for loop.");const e=this._updateNode(new Ree([],null));this._currentLoop.push(e);let r=this._statement();for(;r!==null;){if(Array.isArray(r))for(let n of r)e.body.push(n);else e.body.push(r);if(r instanceof WM){e.continuing=r;break}r=this._statement()}return this._currentLoop.pop(),this._consume(gt.tokens.brace_right,"Expected '}' for loop."),e}_switch_statement(){if(!this._match(gt.keywords.switch))return null;const e=this._updateNode(new Oee(null,[]));if(this._currentLoop.push(e),e.condition=this._optional_paren_expression(),this._check(gt.tokens.attr)&&this._attribute(),this._consume(gt.tokens.brace_left,"Expected '{' for switch."),e.cases=this._switch_body(),e.cases==null||e.cases.length==0)throw this._error(this._previous(),"Expected 'case' or 'default'.");return this._consume(gt.tokens.brace_right,"Expected '}' for switch."),this._currentLoop.pop(),e}_switch_body(){const e=[];let r=!1;for(;this._check([gt.keywords.default,gt.keywords.case]);){if(this._match(gt.keywords.case)){const n=this._case_selectors();for(const a of n)if(a instanceof Ow){if(r)throw this._error(this._previous(),"Multiple default cases in switch statement.");r=!0;break}this._match(gt.tokens.colon),this._check(gt.tokens.attr)&&this._attribute(),this._consume(gt.tokens.brace_left,"Exected '{' for switch case.");const i=this._case_body();this._consume(gt.tokens.brace_right,"Exected '}' for switch case."),e.push(this._updateNode(new $ee(n,i)))}if(this._match(gt.keywords.default)){if(r)throw this._error(this._previous(),"Multiple default cases in switch statement.");this._match(gt.tokens.colon),this._check(gt.tokens.attr)&&this._attribute(),this._consume(gt.tokens.brace_left,"Exected '{' for switch default.");const n=this._case_body();this._consume(gt.tokens.brace_right,"Exected '}' for switch default."),e.push(this._updateNode(new qee(n)))}}return e}_case_selectors(){const e=[];for(this._match(gt.keywords.default)?e.push(this._updateNode(new Ow)):e.push(this._shift_expression());this._match(gt.tokens.comma);)this._match(gt.keywords.default)?e.push(this._updateNode(new Ow)):e.push(this._shift_expression());return e}_case_body(){if(this._match(gt.keywords.fallthrough))return this._consume(gt.tokens.semicolon,"Expected ';'"),[];let e=this._statement();if(e==null)return[];e instanceof Array||(e=[e]);const r=this._case_body();return r.length==0?e:[...e,r[0]]}_if_statement(){if(!this._match(gt.keywords.if))return null;const e=this._currentLine,r=this._optional_paren_expression();this._check(gt.tokens.attr)&&this._attribute();const n=this._compound_statement();let i=[];this._match_elseif()&&(this._check(gt.tokens.attr)&&this._attribute(),i=this._elseif_statement(i));let a=null;return this._match(gt.keywords.else)&&(this._check(gt.tokens.attr)&&this._attribute(),a=this._compound_statement()),this._updateNode(new Lee(r,n,i,a),e)}_match_elseif(){return this._tokens[this._current].type===gt.keywords.else&&this._tokens[this._current+1].type===gt.keywords.if&&(this._advance(),this._advance(),!0)}_elseif_statement(e=[]){const r=this._optional_paren_expression(),n=this._compound_statement();return e.push(this._updateNode(new XBe(r,n))),this._match_elseif()&&(this._check(gt.tokens.attr)&&this._attribute(),this._elseif_statement(e)),e}_return_statement(){if(!this._match(gt.keywords.return))return null;const e=this._short_circuit_or_expression();return this._updateNode(new Nee(e))}_short_circuit_or_expression(){let e=this._short_circuit_and_expr();for(;this._match(gt.tokens.or_or);)e=this._updateNode(new Zh(this._previous().toString(),e,this._short_circuit_and_expr()));return e}_short_circuit_and_expr(){let e=this._inclusive_or_expression();for(;this._match(gt.tokens.and_and);)e=this._updateNode(new Zh(this._previous().toString(),e,this._inclusive_or_expression()));return e}_inclusive_or_expression(){let e=this._exclusive_or_expression();for(;this._match(gt.tokens.or);)e=this._updateNode(new Zh(this._previous().toString(),e,this._exclusive_or_expression()));return e}_exclusive_or_expression(){let e=this._and_expression();for(;this._match(gt.tokens.xor);)e=this._updateNode(new Zh(this._previous().toString(),e,this._and_expression()));return e}_and_expression(){let e=this._equality_expression();for(;this._match(gt.tokens.and);)e=this._updateNode(new Zh(this._previous().toString(),e,this._equality_expression()));return e}_equality_expression(){const e=this._relational_expression();return this._match([gt.tokens.equal_equal,gt.tokens.not_equal])?this._updateNode(new Zh(this._previous().toString(),e,this._relational_expression())):e}_relational_expression(){let e=this._shift_expression();for(;this._match([gt.tokens.less_than,gt.tokens.greater_than,gt.tokens.less_than_equal,gt.tokens.greater_than_equal]);)e=this._updateNode(new Zh(this._previous().toString(),e,this._shift_expression()));return e}_shift_expression(){let e=this._additive_expression();for(;this._match([gt.tokens.shift_left,gt.tokens.shift_right]);)e=this._updateNode(new Zh(this._previous().toString(),e,this._additive_expression()));return e}_additive_expression(){let e=this._multiplicative_expression();for(;this._match([gt.tokens.plus,gt.tokens.minus]);)e=this._updateNode(new Zh(this._previous().toString(),e,this._multiplicative_expression()));return e}_multiplicative_expression(){let e=this._unary_expression();for(;this._match([gt.tokens.star,gt.tokens.forward_slash,gt.tokens.modulo]);)e=this._updateNode(new Zh(this._previous().toString(),e,this._unary_expression()));return e}_unary_expression(){return this._match([gt.tokens.minus,gt.tokens.bang,gt.tokens.tilde,gt.tokens.star,gt.tokens.and])?this._updateNode(new dl(this._previous().toString(),this._unary_expression())):this._singular_expression()}_singular_expression(){const e=this._primary_expression(),r=this._postfix_expression();return r&&(e.postfix=r),e}_postfix_expression(){if(this._match(gt.tokens.bracket_left)){const e=this._short_circuit_or_expression();this._consume(gt.tokens.bracket_right,"Expected ']'.");const r=this._updateNode(new b0(e)),n=this._postfix_expression();return n&&(r.postfix=n),r}if(this._match(gt.tokens.period)){const e=this._consume(gt.tokens.name,"Expected member name."),r=this._postfix_expression(),n=this._updateNode(new Rm(e.lexeme));return r&&(n.postfix=r),n}return null}_getStruct(e){return this._context.aliases.has(e)?this._context.aliases.get(e).type:this._context.structs.has(e)?this._context.structs.get(e):null}_getType(e){const r=this._getStruct(e);if(r!==null)return r;switch(e){case"void":return Xr.void;case"bool":return Xr.bool;case"i32":return Xr.i32;case"u32":return Xr.u32;case"f32":return Xr.f32;case"f16":return Xr.f16;case"vec2f":return hr.vec2f;case"vec3f":return hr.vec3f;case"vec4f":return hr.vec4f;case"vec2i":return hr.vec2i;case"vec3i":return hr.vec3i;case"vec4i":return hr.vec4i;case"vec2u":return hr.vec2u;case"vec3u":return hr.vec3u;case"vec4u":return hr.vec4u;case"vec2h":return hr.vec2h;case"vec3h":return hr.vec3h;case"vec4h":return hr.vec4h;case"mat2x2f":return hr.mat2x2f;case"mat2x3f":return hr.mat2x3f;case"mat2x4f":return hr.mat2x4f;case"mat3x2f":return hr.mat3x2f;case"mat3x3f":return hr.mat3x3f;case"mat3x4f":return hr.mat3x4f;case"mat4x2f":return hr.mat4x2f;case"mat4x3f":return hr.mat4x3f;case"mat4x4f":return hr.mat4x4f;case"mat2x2h":return hr.mat2x2h;case"mat2x3h":return hr.mat2x3h;case"mat2x4h":return hr.mat2x4h;case"mat3x2h":return hr.mat3x2h;case"mat3x3h":return hr.mat3x3h;case"mat3x4h":return hr.mat3x4h;case"mat4x2h":return hr.mat4x2h;case"mat4x3h":return hr.mat4x3h;case"mat4x4h":return hr.mat4x4h;case"mat2x2i":return hr.mat2x2i;case"mat2x3i":return hr.mat2x3i;case"mat2x4i":return hr.mat2x4i;case"mat3x2i":return hr.mat3x2i;case"mat3x3i":return hr.mat3x3i;case"mat3x4i":return hr.mat3x4i;case"mat4x2i":return hr.mat4x2i;case"mat4x3i":return hr.mat4x3i;case"mat4x4i":return hr.mat4x4i;case"mat2x2u":return hr.mat2x2u;case"mat2x3u":return hr.mat2x3u;case"mat2x4u":return hr.mat2x4u;case"mat3x2u":return hr.mat3x2u;case"mat3x3u":return hr.mat3x3u;case"mat3x4u":return hr.mat3x4u;case"mat4x2u":return hr.mat4x2u;case"mat4x3u":return hr.mat4x3u;case"mat4x4u":return hr.mat4x4u}return null}_validateTypeRange(e,r){if(r.name==="i32"){if(e<-2147483648||e>2147483647)throw this._error(this._previous(),`Value out of range for i32: ${e}. Line: ${this._currentLine}.`)}else if(r.name==="u32"&&(e<0||e>4294967295))throw this._error(this._previous(),`Value out of range for u32: ${e}. Line: ${this._currentLine}.`)}_primary_expression(){if(this._match(gt.tokens.ident)){const n=this._previous().toString();if(this._check(gt.tokens.paren_left)){const i=this._argument_expression_list(),a=this._getType(n);return a!==null?this._updateNode(new jf(a,i)):this._updateNode(new UN(n,i))}if(this._context.constants.has(n)){const i=this._context.constants.get(n);return this._updateNode(new zee(n,i.value))}return this._updateNode(new Xc(n))}if(this._match(gt.tokens.int_literal)){const n=this._previous().toString();let i=n.endsWith("i")||n.endsWith("i")?Xr.i32:n.endsWith("u")||n.endsWith("U")?Xr.u32:Xr.x32;const a=parseInt(n);return this._validateTypeRange(a,i),this._updateNode(new Pl(new rr(a,this._exec.getTypeInfo(i)),i))}if(this._match(gt.tokens.uint_literal)){const n=parseInt(this._previous().toString());return this._validateTypeRange(n,Xr.u32),this._updateNode(new Pl(new rr(n,this._exec.getTypeInfo(Xr.u32)),Xr.u32))}if(this._match([gt.tokens.decimal_float_literal,gt.tokens.hex_float_literal])){let n=this._previous().toString(),i=n.endsWith("h");i&&(n=n.substring(0,n.length-1));const a=parseFloat(n);this._validateTypeRange(a,i?Xr.f16:Xr.f32);const s=i?Xr.f16:Xr.f32;return this._updateNode(new Pl(new rr(a,this._exec.getTypeInfo(s)),s))}if(this._match([gt.keywords.true,gt.keywords.false])){let n=this._previous().toString()===gt.keywords.true.rule;return this._updateNode(new Pl(new rr(n?1:0,this._exec.getTypeInfo(Xr.bool)),Xr.bool))}if(this._check(gt.tokens.paren_left))return this._paren_expression();if(this._match(gt.keywords.bitcast)){this._consume(gt.tokens.less_than,"Expected '<'.");const n=this._type_decl();this._consume(gt.tokens.greater_than,"Expected '>'.");const i=this._paren_expression();return this._updateNode(new jee(n,i))}const e=this._type_decl(),r=this._argument_expression_list();return this._updateNode(new jf(e,r))}_argument_expression_list(){if(!this._match(gt.tokens.paren_left))return null;const e=[];do{if(this._check(gt.tokens.paren_right))break;const r=this._short_circuit_or_expression();e.push(r)}while(this._match(gt.tokens.comma));return this._consume(gt.tokens.paren_right,"Expected ')' for agument list"),e}_optional_paren_expression(){this._match(gt.tokens.paren_left);const e=this._short_circuit_or_expression();return this._match(gt.tokens.paren_right),e}_paren_expression(){this._consume(gt.tokens.paren_left,"Expected '('.");const e=this._short_circuit_or_expression();return this._consume(gt.tokens.paren_right,"Expected ')'."),e}_struct_decl(){if(!this._match(gt.keywords.struct))return null;const e=this._currentLine,r=this._consume(gt.tokens.ident,"Expected name for struct.").toString();this._consume(gt.tokens.brace_left,"Expected '{' for struct body.");const n=[];for(;!this._check(gt.tokens.brace_right);){const s=this._attribute(),o=this._consume(gt.tokens.name,"Expected variable name.").toString();this._consume(gt.tokens.colon,"Expected ':' for struct member type.");const u=this._attribute(),h=this._type_decl();h!=null&&(h.attributes=u),this._check(gt.tokens.brace_right)?this._match(gt.tokens.comma):this._consume(gt.tokens.comma,"Expected ',' for struct member."),n.push(this._updateNode(new Pq(o,h,s)))}this._consume(gt.tokens.brace_right,"Expected '}' after struct body.");const i=this._currentLine,a=this._updateNode(new kd(r,n,e,i),e);return this._context.structs.set(r,a),a}_global_variable_decl(){const e=this._variable_decl();if(!e)return null;if(this._match(gt.tokens.equal)){const r=this._const_expression();e.value=r}if(e.type!==null&&e.value instanceof Pl){if(e.value.type.name!=="x32"&&e.type.getTypeName()!==e.value.type.getTypeName())throw this._error(this._peek(),`Invalid cast from ${e.value.type.name} to ${e.type.name}. Line:${this._currentLine}`);e.value.isScalar&&this._validateTypeRange(e.value.scalarValue,e.type),e.value.type=e.type}else e.type===null&&e.value instanceof Pl&&(e.type=e.value.type.name==="x32"?Xr.i32:e.value.type,e.value.isScalar&&this._validateTypeRange(e.value.scalarValue,e.type));return e}_override_variable_decl(){const e=this._override_decl();return e&&this._match(gt.tokens.equal)&&(e.value=this._const_expression()),e}_global_const_decl(){var e;if(!this._match(gt.keywords.const))return null;const r=this._consume(gt.tokens.name,"Expected variable name"),n=this._currentLine;let i=null;if(this._match(gt.tokens.colon)){const u=this._attribute();i=this._type_decl(),i!=null&&(i.attributes=u)}let a=null;this._consume(gt.tokens.equal,"const declarations require an assignment");const s=this._short_circuit_or_expression();try{let u=[Xr.f32],h=s.constEvaluate(this._exec,u);h instanceof rr&&this._validateTypeRange(h.value,u[0]),u[0]instanceof hr&&u[0].format===null&&h.typeInfo instanceof Mm&&h.typeInfo.format!==null&&(h.typeInfo.format.name==="f16"?u[0].format=Xr.f16:h.typeInfo.format.name==="f32"?u[0].format=Xr.f32:h.typeInfo.format.name==="i32"?u[0].format=Xr.i32:h.typeInfo.format.name==="u32"?u[0].format=Xr.u32:h.typeInfo.format.name==="bool"?u[0].format=Xr.bool:console.error(`TODO: impelement template format type ${h.typeInfo.format.name}`)),a=this._updateNode(new Pl(h,u[0])),this._exec.context.setVariable(r.toString(),h)}catch{a=s}if(i!==null&&a instanceof Pl){if(a.type.name!=="x32"&&i.getTypeName()!==a.type.getTypeName())throw this._error(this._peek(),`Invalid cast from ${a.type.name} to ${i.name}. Line:${this._currentLine}`);a.type=i,a.isScalar&&this._validateTypeRange(a.scalarValue,a.type)}else i===null&&a instanceof Pl&&(i=(e=a?.type)!==null&&e!==void 0?e:Xr.f32,i===Xr.x32&&(i=Xr.i32));const o=this._updateNode(new Mw(r.toString(),i,"","",a),n);return this._context.constants.set(o.name,o),o}_global_let_decl(){if(!this._match(gt.keywords.let))return null;const e=this._currentLine,r=this._consume(gt.tokens.name,"Expected variable name");let n=null;if(this._match(gt.tokens.colon)){const a=this._attribute();n=this._type_decl(),n!=null&&(n.attributes=a)}let i=null;if(this._match(gt.tokens.equal)&&(i=this._const_expression()),n!==null&&i instanceof Pl){if(i.type.name!=="x32"&&n.getTypeName()!==i.type.getTypeName())throw this._error(this._peek(),`Invalid cast from ${i.type.name} to ${n.name}. Line:${this._currentLine}`);i.type=n}else n===null&&i instanceof Pl&&(n=i.type.name==="x32"?Xr.i32:i.type);return i instanceof Pl&&i.isScalar&&this._validateTypeRange(i.scalarValue,n),this._updateNode(new B1(r.toString(),n,"","",i),e)}_const_expression(){return this._short_circuit_or_expression()}_variable_decl(){if(!this._match(gt.keywords.var))return null;const e=this._currentLine;let r="",n="";this._match(gt.tokens.less_than)&&(r=this._consume(gt.storage_class,"Expected storage_class.").toString(),this._match(gt.tokens.comma)&&(n=this._consume(gt.access_mode,"Expected access_mode.").toString()),this._consume(gt.tokens.greater_than,"Expected '>'."));const i=this._consume(gt.tokens.name,"Expected variable name");let a=null;if(this._match(gt.tokens.colon)){const s=this._attribute();a=this._type_decl(),a!=null&&(a.attributes=s)}return this._updateNode(new Ld(i.toString(),a,r,n,null),e)}_override_decl(){if(!this._match(gt.keywords.override))return null;const e=this._consume(gt.tokens.name,"Expected variable name");let r=null;if(this._match(gt.tokens.colon)){const n=this._attribute();r=this._type_decl(),r!=null&&(r.attributes=n)}return this._updateNode(new BN(e.toString(),r,null))}_diagnostic(){this._consume(gt.tokens.paren_left,"Expected '('");const e=this._consume(gt.tokens.ident,"Expected severity control name.");this._consume(gt.tokens.comma,"Expected ','");let r=this._consume(gt.tokens.ident,"Expected diagnostic rule name.").toString();return this._match(gt.tokens.period)&&(r+=`.${this._consume(gt.tokens.ident,"Expected diagnostic message.").toString()}`),this._consume(gt.tokens.paren_right,"Expected ')'"),this._updateNode(new Dee(e.toString(),r))}_enable_directive(){const e=this._consume(gt.tokens.ident,"identity expected.");return this._updateNode(new HBe(e.toString()))}_requires_directive(){const e=[this._consume(gt.tokens.ident,"identity expected.").toString()];for(;this._match(gt.tokens.comma);){const r=this._consume(gt.tokens.ident,"identity expected.");e.push(r.toString())}return this._updateNode(new WBe(e))}_type_alias(){const e=this._consume(gt.tokens.ident,"identity expected.");this._consume(gt.tokens.equal,"Expected '=' for type alias.");let r=this._type_decl();if(r===null)throw this._error(this._peek(),"Expected Type for Alias.");this._context.aliases.has(r.name)&&(r=this._context.aliases.get(r.name).type);const n=this._updateNode(new jN(e.toString(),r));return this._context.aliases.set(n.name,n),n}_type_decl(){if(this._check([gt.tokens.ident,...gt.texel_format,gt.keywords.bool,gt.keywords.f32,gt.keywords.i32,gt.keywords.u32])){const n=this._advance().toString();if(this._context.structs.has(n))return this._context.structs.get(n);if(this._context.aliases.has(n))return this._context.aliases.get(n).type;if(!this._getType(n)){const i=this._updateNode(new Aq(n));return this._forwardTypeCount++,i}return this._updateNode(new Xr(n))}let e=this._texture_sampler_types();if(e)return e;if(this._check(gt.template_types)){let n=this._advance().toString(),i=null,a=null;return this._match(gt.tokens.less_than)&&(i=this._type_decl(),a=null,this._match(gt.tokens.comma)&&(a=this._consume(gt.access_mode,"Expected access_mode for pointer").toString()),this._consume(gt.tokens.greater_than,"Expected '>' for type.")),this._updateNode(new hr(n,i,a))}if(this._match(gt.keywords.ptr)){let n=this._previous().toString();this._consume(gt.tokens.less_than,"Expected '<' for pointer.");const i=this._consume(gt.storage_class,"Expected storage_class for pointer");this._consume(gt.tokens.comma,"Expected ',' for pointer.");const a=this._type_decl();let s=null;return this._match(gt.tokens.comma)&&(s=this._consume(gt.access_mode,"Expected access_mode for pointer").toString()),this._consume(gt.tokens.greater_than,"Expected '>' for pointer."),this._updateNode(new Rw(n,i.toString(),a,s))}const r=this._attribute();if(this._match(gt.keywords.array)){let n=null,i=-1;const a=this._previous();let s=null;if(this._match(gt.tokens.less_than)){n=this._type_decl(),this._context.aliases.has(n.name)&&(n=this._context.aliases.get(n.name).type);let u="";if(this._match(gt.tokens.comma)){s=this._shift_expression();try{u=s.constEvaluate(this._exec).toString(),s=null}catch{u="1"}}this._consume(gt.tokens.greater_than,"Expected '>' for array."),i=u?parseInt(u):0}const o=this._updateNode(new z1(a.toString(),r,n,i));return s&&this._deferArrayCountEval.push({arrayType:o,countNode:s}),o}return null}_texture_sampler_types(){if(this._match(gt.sampler_type))return this._updateNode(new p1(this._previous().toString(),null,null));if(this._match(gt.depth_texture_type))return this._updateNode(new p1(this._previous().toString(),null,null));if(this._match(gt.sampled_texture_type)||this._match(gt.multisampled_texture_type)){const e=this._previous();this._consume(gt.tokens.less_than,"Expected '<' for sampler type.");const r=this._type_decl();return this._consume(gt.tokens.greater_than,"Expected '>' for sampler type."),this._updateNode(new p1(e.toString(),r,null))}if(this._match(gt.storage_texture_type)){const e=this._previous();this._consume(gt.tokens.less_than,"Expected '<' for sampler type.");const r=this._consume(gt.texel_format,"Invalid texel format.").toString();this._consume(gt.tokens.comma,"Expected ',' after texel format.");const n=this._consume(gt.access_mode,"Expected access mode for storage texture type.").toString();return this._consume(gt.tokens.greater_than,"Expected '>' for sampler type."),this._updateNode(new p1(e.toString(),r,n))}return null}_attribute(){let e=[];for(;this._match(gt.tokens.attr);){const r=this._consume(gt.attribute_name,"Expected attribute name"),n=this._updateNode(new Hee(r.toString(),null));if(this._match(gt.tokens.paren_left)){if(n.value=this._consume(gt.literal_or_ident,"Expected attribute value").toString(),this._check(gt.tokens.comma)){this._advance();do{const i=this._consume(gt.literal_or_ident,"Expected attribute value").toString();n.value instanceof Array||(n.value=[n.value]),n.value.push(i)}while(this._match(gt.tokens.comma))}this._consume(gt.tokens.paren_right,"Expected ')'")}e.push(n)}return e.length==0?null:e}}class lze extends Gf{constructor(e){super(),e&&this.update(e)}update(e){const r=new sze().parse(e);this.updateAST(r)}}function uze(t){const e={attributes:[],bindings:[]};let r;try{r=cze(t)}catch(a){return dn.error(a.message)(),e}for(const a of r.uniforms){const s=[];for(const o of a.type?.members||[])s.push({name:o.name,type:Rq(o.type)});e.bindings.push({type:"uniform",name:a.name,group:a.group,location:a.binding,members:s})}for(const a of r.textures)e.bindings.push({type:"texture",name:a.name,group:a.group,location:a.binding});for(const a of r.samplers)e.bindings.push({type:"sampler",name:a.name,group:a.group,location:a.binding});const n=r.entry.vertex[0],i=n?.inputs.length||0;for(let a=0;a<i;a++){const s=n.inputs[a];if(s.locationType==="location"){const o=Rq(s.type);e.attributes.push({name:s.name,location:Number(s.location),type:o})}}return e}function Rq(t){return t.format?`${t.name}<${t.format.name}>`:t.name}function cze(t){try{return new lze(t)}catch(e){if(e instanceof Error)throw e;let r="WGSL parse error";throw typeof e=="object"&&e?.message&&(r+=`: ${e.message} `),typeof e=="object"&&e?.token&&(r+=e.token.line||""),new Error(r,{cause:e})}}const hze={EPSILON:1e-12,debug:!1,precision:4,printTypes:!1,printDegrees:!1,printRowMajor:!0,_cartographicRadians:!1};globalThis.mathgl=globalThis.mathgl||{config:{...hze}};const Sh=globalThis.mathgl.config;function fze(t,{precision:e=Sh.precision}={}){return t=dze(t),`${parseFloat(t.toPrecision(e))}`}function x0(t){return Array.isArray(t)||ArrayBuffer.isView(t)&&!(t instanceof DataView)}function Xf(t,e,r){return gze(t,n=>Math.max(e,Math.min(r,n)))}function vE(t,e,r){return x0(t)?t.map((n,i)=>vE(n,e[i],r)):r*e+(1-r)*t}function Ab(t,e,r){const n=Sh.EPSILON;try{if(t===e)return!0;if(x0(t)&&x0(e)){if(t.length!==e.length)return!1;for(let i=0;i<t.length;++i)if(!Ab(t[i],e[i]))return!1;return!0}return t&&t.equals?t.equals(e):e&&e.equals?e.equals(t):typeof t=="number"&&typeof e=="number"?Math.abs(t-e)<=Sh.EPSILON*Math.max(1,Math.abs(t),Math.abs(e)):!1}finally{Sh.EPSILON=n}}function dze(t){return Math.round(t/Sh.EPSILON)*Sh.EPSILON}function pze(t){return t.clone?t.clone():new Array(t.length)}function gze(t,e,r){if(x0(t)){const n=t;r=r||pze(n);for(let i=0;i<r.length&&i<n.length;++i){const a=typeof t=="number"?t:t[i];r[i]=e(a,i,r)}return r}return e(t)}class Wee extends Array{clone(){return new this.constructor().copy(this)}fromArray(e,r=0){for(let n=0;n<this.ELEMENTS;++n)this[n]=e[n+r];return this.check()}toArray(e=[],r=0){for(let n=0;n<this.ELEMENTS;++n)e[r+n]=this[n];return e}toObject(e){return e}from(e){return Array.isArray(e)?this.copy(e):this.fromObject(e)}to(e){return e===this?this:x0(e)?this.toArray(e):this.toObject(e)}toTarget(e){return e?this.to(e):this}toFloat32Array(){return new Float32Array(this)}toString(){return this.formatString(Sh)}formatString(e){let r="";for(let n=0;n<this.ELEMENTS;++n)r+=(n>0?", ":"")+fze(this[n],e);return`${e.printTypes?this.constructor.name:""}[${r}]`}equals(e){if(!e||this.length!==e.length)return!1;for(let r=0;r<this.ELEMENTS;++r)if(!Ab(this[r],e[r]))return!1;return!0}exactEquals(e){if(!e||this.length!==e.length)return!1;for(let r=0;r<this.ELEMENTS;++r)if(this[r]!==e[r])return!1;return!0}negate(){for(let e=0;e<this.ELEMENTS;++e)this[e]=-this[e];return this.check()}lerp(e,r,n){if(n===void 0)return this.lerp(this,e,r);for(let i=0;i<this.ELEMENTS;++i){const a=e[i],s=typeof r=="number"?r:r[i];this[i]=a+n*(s-a)}return this.check()}min(e){for(let r=0;r<this.ELEMENTS;++r)this[r]=Math.min(e[r],this[r]);return this.check()}max(e){for(let r=0;r<this.ELEMENTS;++r)this[r]=Math.max(e[r],this[r]);return this.check()}clamp(e,r){for(let n=0;n<this.ELEMENTS;++n)this[n]=Math.min(Math.max(this[n],e[n]),r[n]);return this.check()}add(...e){for(const r of e)for(let n=0;n<this.ELEMENTS;++n)this[n]+=r[n];return this.check()}subtract(...e){for(const r of e)for(let n=0;n<this.ELEMENTS;++n)this[n]-=r[n];return this.check()}scale(e){if(typeof e=="number")for(let r=0;r<this.ELEMENTS;++r)this[r]*=e;else for(let r=0;r<this.ELEMENTS&&r<e.length;++r)this[r]*=e[r];return this.check()}multiplyByScalar(e){for(let r=0;r<this.ELEMENTS;++r)this[r]*=e;return this.check()}check(){if(Sh.debug&&!this.validate())throw new Error(`math.gl: ${this.constructor.name} some fields set to invalid numbers'`);return this}validate(){let e=this.length===this.ELEMENTS;for(let r=0;r<this.ELEMENTS;++r)e=e&&Number.isFinite(this[r]);return e}sub(e){return this.subtract(e)}setScalar(e){for(let r=0;r<this.ELEMENTS;++r)this[r]=e;return this.check()}addScalar(e){for(let r=0;r<this.ELEMENTS;++r)this[r]+=e;return this.check()}subScalar(e){return this.addScalar(-e)}multiplyScalar(e){for(let r=0;r<this.ELEMENTS;++r)this[r]*=e;return this.check()}divideScalar(e){return this.multiplyByScalar(1/e)}clampScalar(e,r){for(let n=0;n<this.ELEMENTS;++n)this[n]=Math.min(Math.max(this[n],e),r);return this.check()}get elements(){return this}}function mze(t,e){if(t.length!==e)return!1;for(let r=0;r<t.length;++r)if(!Number.isFinite(t[r]))return!1;return!0}function Gc(t){if(!Number.isFinite(t))throw new Error(`Invalid number ${JSON.stringify(t)}`);return t}function zI(t,e,r=""){if(Sh.debug&&!mze(t,e))throw new Error(`math.gl: ${r} some fields set to invalid numbers'`);return t}function Oq(t,e){if(!t)throw new Error(`math.gl assertion ${e}`)}class yze extends Wee{get x(){return this[0]}set x(e){this[0]=Gc(e)}get y(){return this[1]}set y(e){this[1]=Gc(e)}len(){return Math.sqrt(this.lengthSquared())}magnitude(){return this.len()}lengthSquared(){let e=0;for(let r=0;r<this.ELEMENTS;++r)e+=this[r]*this[r];return e}magnitudeSquared(){return this.lengthSquared()}distance(e){return Math.sqrt(this.distanceSquared(e))}distanceSquared(e){let r=0;for(let n=0;n<this.ELEMENTS;++n){const i=this[n]-e[n];r+=i*i}return Gc(r)}dot(e){let r=0;for(let n=0;n<this.ELEMENTS;++n)r+=this[n]*e[n];return Gc(r)}normalize(){const e=this.magnitude();if(e!==0)for(let r=0;r<this.ELEMENTS;++r)this[r]/=e;return this.check()}multiply(...e){for(const r of e)for(let n=0;n<this.ELEMENTS;++n)this[n]*=r[n];return this.check()}divide(...e){for(const r of e)for(let n=0;n<this.ELEMENTS;++n)this[n]/=r[n];return this.check()}lengthSq(){return this.lengthSquared()}distanceTo(e){return this.distance(e)}distanceToSquared(e){return this.distanceSquared(e)}getComponent(e){return Oq(e>=0&&e<this.ELEMENTS,"index is out of range"),Gc(this[e])}setComponent(e,r){return Oq(e>=0&&e<this.ELEMENTS,"index is out of range"),this[e]=r,this.check()}addVectors(e,r){return this.copy(e).add(r)}subVectors(e,r){return this.copy(e).subtract(r)}multiplyVectors(e,r){return this.copy(e).multiply(r)}addScaledVector(e,r){return this.add(new this.constructor(e).multiplyScalar(r))}}const Lw=1e-6;let w0=typeof Float32Array<"u"?Float32Array:Array;function vze(){const t=new w0(2);return w0!=Float32Array&&(t[0]=0,t[1]=0),t}function Lq(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t}function _ze(t,e){return t[0]=-e[0],t[1]=-e[1],t}function Gee(t,e,r,n){const i=e[0],a=e[1];return t[0]=i+n*(r[0]-i),t[1]=a+n*(r[1]-a),t}function bze(t,e,r){const n=e[0],i=e[1];return t[0]=r[0]*n+r[4]*i+r[12],t[1]=r[1]*n+r[5]*i+r[13],t}(function(){const t=vze();return function(e,r,n,i,a,s){let o,u;for(r||(r=2),n||(n=0),i?u=Math.min(i*r+n,e.length):u=e.length,o=n;o<u;o+=r)t[0]=e[o],t[1]=e[o+1],a(t,t,s),e[o]=t[0],e[o+1]=t[1];return e}})();function xze(t,e,r){const n=e[0],i=e[1],a=r[3]*n+r[7]*i||1;return t[0]=(r[0]*n+r[4]*i)/a,t[1]=(r[1]*n+r[5]*i)/a,t}function Xee(t,e,r){const n=e[0],i=e[1],a=e[2],s=r[3]*n+r[7]*i+r[11]*a||1;return t[0]=(r[0]*n+r[4]*i+r[8]*a)/s,t[1]=(r[1]*n+r[5]*i+r[9]*a)/s,t[2]=(r[2]*n+r[6]*i+r[10]*a)/s,t}function wze(t,e,r){const n=e[0],i=e[1];return t[0]=r[0]*n+r[2]*i,t[1]=r[1]*n+r[3]*i,t[2]=e[2],t}function Sze(){const t=new w0(3);return w0!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}function Eze(t){const e=t[0],r=t[1],n=t[2];return Math.sqrt(e*e+r*r+n*n)}function Tze(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t}function Cze(t){const e=t[0],r=t[1],n=t[2];return e*e+r*r+n*n}function Aze(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t}function Ize(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function Pze(t,e,r){const n=e[0],i=e[1],a=e[2],s=r[0],o=r[1],u=r[2];return t[0]=i*u-a*o,t[1]=a*s-n*u,t[2]=n*o-i*s,t}function kze(t,e,r,n){const i=e[0],a=e[1],s=e[2];return t[0]=i+n*(r[0]-i),t[1]=a+n*(r[1]-a),t[2]=s+n*(r[2]-s),t}function Yee(t,e,r){const n=e[0],i=e[1],a=e[2];let s=r[3]*n+r[7]*i+r[11]*a+r[15];return s=s||1,t[0]=(r[0]*n+r[4]*i+r[8]*a+r[12])/s,t[1]=(r[1]*n+r[5]*i+r[9]*a+r[13])/s,t[2]=(r[2]*n+r[6]*i+r[10]*a+r[14])/s,t}function Mze(t,e,r){const n=e[0],i=e[1],a=e[2];return t[0]=n*r[0]+i*r[3]+a*r[6],t[1]=n*r[1]+i*r[4]+a*r[7],t[2]=n*r[2]+i*r[5]+a*r[8],t}function Rze(t,e,r){const n=r[0],i=r[1],a=r[2],s=r[3],o=e[0],u=e[1],h=e[2];let f=i*h-a*u,g=a*o-n*h,b=n*u-i*o,v=i*b-a*g,S=a*f-n*b,E=n*g-i*f;const P=s*2;return f*=P,g*=P,b*=P,v*=2,S*=2,E*=2,t[0]=o+f+v,t[1]=u+g+S,t[2]=h+b+E,t}function Oze(t,e,r,n){const i=[],a=[];return i[0]=e[0]-r[0],i[1]=e[1]-r[1],i[2]=e[2]-r[2],a[0]=i[0],a[1]=i[1]*Math.cos(n)-i[2]*Math.sin(n),a[2]=i[1]*Math.sin(n)+i[2]*Math.cos(n),t[0]=a[0]+r[0],t[1]=a[1]+r[1],t[2]=a[2]+r[2],t}function Lze(t,e,r,n){const i=[],a=[];return i[0]=e[0]-r[0],i[1]=e[1]-r[1],i[2]=e[2]-r[2],a[0]=i[2]*Math.sin(n)+i[0]*Math.cos(n),a[1]=i[1],a[2]=i[2]*Math.cos(n)-i[0]*Math.sin(n),t[0]=a[0]+r[0],t[1]=a[1]+r[1],t[2]=a[2]+r[2],t}function Nze(t,e,r,n){const i=[],a=[];return i[0]=e[0]-r[0],i[1]=e[1]-r[1],i[2]=e[2]-r[2],a[0]=i[0]*Math.cos(n)-i[1]*Math.sin(n),a[1]=i[0]*Math.sin(n)+i[1]*Math.cos(n),a[2]=i[2],t[0]=a[0]+r[0],t[1]=a[1]+r[1],t[2]=a[2]+r[2],t}function Dze(t,e){const r=t[0],n=t[1],i=t[2],a=e[0],s=e[1],o=e[2],u=Math.sqrt((r*r+n*n+i*i)*(a*a+s*s+o*o)),h=u&&Ize(t,e)/u;return Math.acos(Math.min(Math.max(h,-1),1))}const Zee=Tze,Fze=Eze,jI=Cze;(function(){const t=Sze();return function(e,r,n,i,a,s){let o,u;for(r||(r=3),n||(n=0),i?u=Math.min(i*r+n,e.length):u=e.length,o=n;o<u;o+=r)t[0]=e[o],t[1]=e[o+1],t[2]=e[o+2],a(t,t,s),e[o]=t[0],e[o+1]=t[1],e[o+2]=t[2];return e}})();const UI=[0,0,0];let Z2;class ad extends yze{static get ZERO(){return Z2||(Z2=new ad(0,0,0),Object.freeze(Z2)),Z2}constructor(e=0,r=0,n=0){super(-0,-0,-0),arguments.length===1&&x0(e)?this.copy(e):(Sh.debug&&(Gc(e),Gc(r),Gc(n)),this[0]=e,this[1]=r,this[2]=n)}set(e,r,n){return this[0]=e,this[1]=r,this[2]=n,this.check()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this.check()}fromObject(e){return Sh.debug&&(Gc(e.x),Gc(e.y),Gc(e.z)),this[0]=e.x,this[1]=e.y,this[2]=e.z,this.check()}toObject(e){return e.x=this[0],e.y=this[1],e.z=this[2],e}get ELEMENTS(){return 3}get z(){return this[2]}set z(e){this[2]=Gc(e)}angle(e){return Dze(this,e)}cross(e){return Pze(this,this,e),this.check()}rotateX({radians:e,origin:r=UI}){return Oze(this,this,r,e),this.check()}rotateY({radians:e,origin:r=UI}){return Lze(this,this,r,e),this.check()}rotateZ({radians:e,origin:r=UI}){return Nze(this,this,r,e),this.check()}transform(e){return this.transformAsPoint(e)}transformAsPoint(e){return Yee(this,this,e),this.check()}transformAsVector(e){return Xee(this,this,e),this.check()}transformByMatrix3(e){return Mze(this,this,e),this.check()}transformByMatrix2(e){return wze(this,this,e),this.check()}transformByQuaternion(e){return Rze(this,this,e),this.check()}}class Bze extends Wee{toString(){let e="[";if(Sh.printRowMajor){e+="row-major:";for(let r=0;r<this.RANK;++r)for(let n=0;n<this.RANK;++n)e+=` ${this[n*this.RANK+r]}`}else{e+="column-major:";for(let r=0;r<this.ELEMENTS;++r)e+=` ${this[r]}`}return e+="]",e}getElementIndex(e,r){return r*this.RANK+e}getElement(e,r){return this[r*this.RANK+e]}setElement(e,r,n){return this[r*this.RANK+e]=Gc(n),this}getColumn(e,r=new Array(this.RANK).fill(-0)){const n=e*this.RANK;for(let i=0;i<this.RANK;++i)r[i]=this[n+i];return r}setColumn(e,r){const n=e*this.RANK;for(let i=0;i<this.RANK;++i)this[n+i]=r[i];return this}}function zze(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function jze(t,e){if(t===e){const r=e[1],n=e[2],i=e[3],a=e[6],s=e[7],o=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=r,t[6]=e[9],t[7]=e[13],t[8]=n,t[9]=a,t[11]=e[14],t[12]=i,t[13]=s,t[14]=o}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15];return t}function XM(t,e){const r=e[0],n=e[1],i=e[2],a=e[3],s=e[4],o=e[5],u=e[6],h=e[7],f=e[8],g=e[9],b=e[10],v=e[11],S=e[12],E=e[13],P=e[14],k=e[15],L=r*o-n*s,O=r*u-i*s,M=r*h-a*s,z=n*u-i*o,B=n*h-a*o,q=i*h-a*u,W=f*E-g*S,G=f*P-b*S,ie=f*k-v*S,Q=g*P-b*E,H=g*k-v*E,ne=b*k-v*P;let oe=L*ne-O*H+M*Q+z*ie-B*G+q*W;return oe?(oe=1/oe,t[0]=(o*ne-u*H+h*Q)*oe,t[1]=(i*H-n*ne-a*Q)*oe,t[2]=(E*q-P*B+k*z)*oe,t[3]=(b*B-g*q-v*z)*oe,t[4]=(u*ie-s*ne-h*G)*oe,t[5]=(r*ne-i*ie+a*G)*oe,t[6]=(P*M-S*q-k*O)*oe,t[7]=(f*q-b*M+v*O)*oe,t[8]=(s*H-o*ie+h*W)*oe,t[9]=(n*ie-r*H-a*W)*oe,t[10]=(S*B-E*M+k*L)*oe,t[11]=(g*M-f*B-v*L)*oe,t[12]=(o*G-s*Q-u*W)*oe,t[13]=(r*Q-n*G+i*W)*oe,t[14]=(E*O-S*z-P*L)*oe,t[15]=(f*z-g*O+b*L)*oe,t):null}function Uze(t){const e=t[0],r=t[1],n=t[2],i=t[3],a=t[4],s=t[5],o=t[6],u=t[7],h=t[8],f=t[9],g=t[10],b=t[11],v=t[12],S=t[13],E=t[14],P=t[15],k=e*s-r*a,L=e*o-n*a,O=r*o-n*s,M=h*S-f*v,z=h*E-g*v,B=f*E-g*S,q=e*B-r*z+n*M,W=a*B-s*z+o*M,G=h*O-f*L+g*k,ie=v*O-S*L+E*k;return u*q-i*W+P*G-b*ie}function hm(t,e,r){const n=e[0],i=e[1],a=e[2],s=e[3],o=e[4],u=e[5],h=e[6],f=e[7],g=e[8],b=e[9],v=e[10],S=e[11],E=e[12],P=e[13],k=e[14],L=e[15];let O=r[0],M=r[1],z=r[2],B=r[3];return t[0]=O*n+M*o+z*g+B*E,t[1]=O*i+M*u+z*b+B*P,t[2]=O*a+M*h+z*v+B*k,t[3]=O*s+M*f+z*S+B*L,O=r[4],M=r[5],z=r[6],B=r[7],t[4]=O*n+M*o+z*g+B*E,t[5]=O*i+M*u+z*b+B*P,t[6]=O*a+M*h+z*v+B*k,t[7]=O*s+M*f+z*S+B*L,O=r[8],M=r[9],z=r[10],B=r[11],t[8]=O*n+M*o+z*g+B*E,t[9]=O*i+M*u+z*b+B*P,t[10]=O*a+M*h+z*v+B*k,t[11]=O*s+M*f+z*S+B*L,O=r[12],M=r[13],z=r[14],B=r[15],t[12]=O*n+M*o+z*g+B*E,t[13]=O*i+M*u+z*b+B*P,t[14]=O*a+M*h+z*v+B*k,t[15]=O*s+M*f+z*S+B*L,t}function _E(t,e,r){const n=r[0],i=r[1],a=r[2];let s,o,u,h,f,g,b,v,S,E,P,k;return e===t?(t[12]=e[0]*n+e[4]*i+e[8]*a+e[12],t[13]=e[1]*n+e[5]*i+e[9]*a+e[13],t[14]=e[2]*n+e[6]*i+e[10]*a+e[14],t[15]=e[3]*n+e[7]*i+e[11]*a+e[15]):(s=e[0],o=e[1],u=e[2],h=e[3],f=e[4],g=e[5],b=e[6],v=e[7],S=e[8],E=e[9],P=e[10],k=e[11],t[0]=s,t[1]=o,t[2]=u,t[3]=h,t[4]=f,t[5]=g,t[6]=b,t[7]=v,t[8]=S,t[9]=E,t[10]=P,t[11]=k,t[12]=s*n+f*i+S*a+e[12],t[13]=o*n+g*i+E*a+e[13],t[14]=u*n+b*i+P*a+e[14],t[15]=h*n+v*i+k*a+e[15]),t}function WN(t,e,r){const n=r[0],i=r[1],a=r[2];return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*i,t[5]=e[5]*i,t[6]=e[6]*i,t[7]=e[7]*i,t[8]=e[8]*a,t[9]=e[9]*a,t[10]=e[10]*a,t[11]=e[11]*a,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function Vze(t,e,r,n){let i=n[0],a=n[1],s=n[2],o=Math.sqrt(i*i+a*a+s*s),u,h,f,g,b,v,S,E,P,k,L,O,M,z,B,q,W,G,ie,Q,H,ne,oe,ce;return o<Lw?null:(o=1/o,i*=o,a*=o,s*=o,h=Math.sin(r),u=Math.cos(r),f=1-u,g=e[0],b=e[1],v=e[2],S=e[3],E=e[4],P=e[5],k=e[6],L=e[7],O=e[8],M=e[9],z=e[10],B=e[11],q=i*i*f+u,W=a*i*f+s*h,G=s*i*f-a*h,ie=i*a*f-s*h,Q=a*a*f+u,H=s*a*f+i*h,ne=i*s*f+a*h,oe=a*s*f-i*h,ce=s*s*f+u,t[0]=g*q+E*W+O*G,t[1]=b*q+P*W+M*G,t[2]=v*q+k*W+z*G,t[3]=S*q+L*W+B*G,t[4]=g*ie+E*Q+O*H,t[5]=b*ie+P*Q+M*H,t[6]=v*ie+k*Q+z*H,t[7]=S*ie+L*Q+B*H,t[8]=g*ne+E*oe+O*ce,t[9]=b*ne+P*oe+M*ce,t[10]=v*ne+k*oe+z*ce,t[11]=S*ne+L*oe+B*ce,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t)}function Kee(t,e,r){const n=Math.sin(r),i=Math.cos(r),a=e[4],s=e[5],o=e[6],u=e[7],h=e[8],f=e[9],g=e[10],b=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=a*i+h*n,t[5]=s*i+f*n,t[6]=o*i+g*n,t[7]=u*i+b*n,t[8]=h*i-a*n,t[9]=f*i-s*n,t[10]=g*i-o*n,t[11]=b*i-u*n,t}function $ze(t,e,r){const n=Math.sin(r),i=Math.cos(r),a=e[0],s=e[1],o=e[2],u=e[3],h=e[8],f=e[9],g=e[10],b=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=a*i-h*n,t[1]=s*i-f*n,t[2]=o*i-g*n,t[3]=u*i-b*n,t[8]=a*n+h*i,t[9]=s*n+f*i,t[10]=o*n+g*i,t[11]=u*n+b*i,t}function Jee(t,e,r){const n=Math.sin(r),i=Math.cos(r),a=e[0],s=e[1],o=e[2],u=e[3],h=e[4],f=e[5],g=e[6],b=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=a*i+h*n,t[1]=s*i+f*n,t[2]=o*i+g*n,t[3]=u*i+b*n,t[4]=h*i-a*n,t[5]=f*i-s*n,t[6]=g*i-o*n,t[7]=b*i-u*n,t}function qze(t,e){const r=e[0],n=e[1],i=e[2],a=e[3],s=r+r,o=n+n,u=i+i,h=r*s,f=n*s,g=n*o,b=i*s,v=i*o,S=i*u,E=a*s,P=a*o,k=a*u;return t[0]=1-g-S,t[1]=f+k,t[2]=b-P,t[3]=0,t[4]=f-k,t[5]=1-h-S,t[6]=v+E,t[7]=0,t[8]=b+P,t[9]=v-E,t[10]=1-h-g,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function Hze(t,e,r,n,i,a,s){const o=1/(r-e),u=1/(i-n),h=1/(a-s);return t[0]=a*2*o,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=a*2*u,t[6]=0,t[7]=0,t[8]=(r+e)*o,t[9]=(i+n)*u,t[10]=(s+a)*h,t[11]=-1,t[12]=0,t[13]=0,t[14]=s*a*2*h,t[15]=0,t}function Wze(t,e,r,n,i){const a=1/Math.tan(e/2);if(t[0]=a/r,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=a,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,i!=null&&i!==1/0){const s=1/(n-i);t[10]=(i+n)*s,t[14]=2*i*n*s}else t[10]=-1,t[14]=-2*n;return t}const Gze=Wze;function Xze(t,e,r,n,i,a,s){const o=1/(e-r),u=1/(n-i),h=1/(a-s);return t[0]=-2*o,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*u,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*h,t[11]=0,t[12]=(e+r)*o,t[13]=(i+n)*u,t[14]=(s+a)*h,t[15]=1,t}const Yze=Xze;function Zze(t,e,r,n){let i,a,s,o,u,h,f,g,b,v;const S=e[0],E=e[1],P=e[2],k=n[0],L=n[1],O=n[2],M=r[0],z=r[1],B=r[2];return Math.abs(S-M)<Lw&&Math.abs(E-z)<Lw&&Math.abs(P-B)<Lw?zze(t):(g=S-M,b=E-z,v=P-B,i=1/Math.sqrt(g*g+b*b+v*v),g*=i,b*=i,v*=i,a=L*v-O*b,s=O*g-k*v,o=k*b-L*g,i=Math.sqrt(a*a+s*s+o*o),i?(i=1/i,a*=i,s*=i,o*=i):(a=0,s=0,o=0),u=b*o-v*s,h=v*a-g*o,f=g*s-b*a,i=Math.sqrt(u*u+h*h+f*f),i?(i=1/i,u*=i,h*=i,f*=i):(u=0,h=0,f=0),t[0]=a,t[1]=u,t[2]=g,t[3]=0,t[4]=s,t[5]=h,t[6]=b,t[7]=0,t[8]=o,t[9]=f,t[10]=v,t[11]=0,t[12]=-(a*S+s*E+o*P),t[13]=-(u*S+h*E+f*P),t[14]=-(g*S+b*E+v*P),t[15]=1,t)}function Kze(){const t=new w0(4);return w0!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[3]=0),t}function Qee(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t}function G0(t,e,r){const n=e[0],i=e[1],a=e[2],s=e[3];return t[0]=r[0]*n+r[4]*i+r[8]*a+r[12]*s,t[1]=r[1]*n+r[5]*i+r[9]*a+r[13]*s,t[2]=r[2]*n+r[6]*i+r[10]*a+r[14]*s,t[3]=r[3]*n+r[7]*i+r[11]*a+r[15]*s,t}(function(){const t=Kze();return function(e,r,n,i,a,s){let o,u;for(r||(r=4),n||(n=0),i?u=Math.min(i*r+n,e.length):u=e.length,o=n;o<u;o+=r)t[0]=e[o],t[1]=e[o+1],t[2]=e[o+2],t[3]=e[o+3],a(t,t,s),e[o]=t[0],e[o+1]=t[1],e[o+2]=t[2],e[o+3]=t[3];return e}})();var YM;(function(t){t[t.COL0ROW0=0]="COL0ROW0",t[t.COL0ROW1=1]="COL0ROW1",t[t.COL0ROW2=2]="COL0ROW2",t[t.COL0ROW3=3]="COL0ROW3",t[t.COL1ROW0=4]="COL1ROW0",t[t.COL1ROW1=5]="COL1ROW1",t[t.COL1ROW2=6]="COL1ROW2",t[t.COL1ROW3=7]="COL1ROW3",t[t.COL2ROW0=8]="COL2ROW0",t[t.COL2ROW1=9]="COL2ROW1",t[t.COL2ROW2=10]="COL2ROW2",t[t.COL2ROW3=11]="COL2ROW3",t[t.COL3ROW0=12]="COL3ROW0",t[t.COL3ROW1=13]="COL3ROW1",t[t.COL3ROW2=14]="COL3ROW2",t[t.COL3ROW3=15]="COL3ROW3"})(YM||(YM={}));const Jze=45*Math.PI/180,Qze=1,VI=.1,$I=500,e9e=Object.freeze([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]);class hf extends Bze{static get IDENTITY(){return r9e()}static get ZERO(){return t9e()}get ELEMENTS(){return 16}get RANK(){return 4}get INDICES(){return YM}constructor(e){super(-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0),arguments.length===1&&Array.isArray(e)?this.copy(e):this.identity()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this[3]=e[3],this[4]=e[4],this[5]=e[5],this[6]=e[6],this[7]=e[7],this[8]=e[8],this[9]=e[9],this[10]=e[10],this[11]=e[11],this[12]=e[12],this[13]=e[13],this[14]=e[14],this[15]=e[15],this.check()}set(e,r,n,i,a,s,o,u,h,f,g,b,v,S,E,P){return this[0]=e,this[1]=r,this[2]=n,this[3]=i,this[4]=a,this[5]=s,this[6]=o,this[7]=u,this[8]=h,this[9]=f,this[10]=g,this[11]=b,this[12]=v,this[13]=S,this[14]=E,this[15]=P,this.check()}setRowMajor(e,r,n,i,a,s,o,u,h,f,g,b,v,S,E,P){return this[0]=e,this[1]=a,this[2]=h,this[3]=v,this[4]=r,this[5]=s,this[6]=f,this[7]=S,this[8]=n,this[9]=o,this[10]=g,this[11]=E,this[12]=i,this[13]=u,this[14]=b,this[15]=P,this.check()}toRowMajor(e){return e[0]=this[0],e[1]=this[4],e[2]=this[8],e[3]=this[12],e[4]=this[1],e[5]=this[5],e[6]=this[9],e[7]=this[13],e[8]=this[2],e[9]=this[6],e[10]=this[10],e[11]=this[14],e[12]=this[3],e[13]=this[7],e[14]=this[11],e[15]=this[15],e}identity(){return this.copy(e9e)}fromObject(e){return this.check()}fromQuaternion(e){return qze(this,e),this.check()}frustum(e){const{left:r,right:n,bottom:i,top:a,near:s=VI,far:o=$I}=e;return o===1/0?n9e(this,r,n,i,a,s):Hze(this,r,n,i,a,s,o),this.check()}lookAt(e){const{eye:r,center:n=[0,0,0],up:i=[0,1,0]}=e;return Zze(this,r,n,i),this.check()}ortho(e){const{left:r,right:n,bottom:i,top:a,near:s=VI,far:o=$I}=e;return Yze(this,r,n,i,a,s,o),this.check()}orthographic(e){const{fovy:r=Jze,aspect:n=Qze,focalDistance:i=1,near:a=VI,far:s=$I}=e;Nq(r);const o=r/2,u=i*Math.tan(o),h=u*n;return this.ortho({left:-h,right:h,bottom:-u,top:u,near:a,far:s})}perspective(e){const{fovy:r=45*Math.PI/180,aspect:n=1,near:i=.1,far:a=500}=e;return Nq(r),Gze(this,r,n,i,a),this.check()}determinant(){return Uze(this)}getScale(e=[-0,-0,-0]){return e[0]=Math.sqrt(this[0]*this[0]+this[1]*this[1]+this[2]*this[2]),e[1]=Math.sqrt(this[4]*this[4]+this[5]*this[5]+this[6]*this[6]),e[2]=Math.sqrt(this[8]*this[8]+this[9]*this[9]+this[10]*this[10]),e}getTranslation(e=[-0,-0,-0]){return e[0]=this[12],e[1]=this[13],e[2]=this[14],e}getRotation(e,r){e=e||[-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0],r=r||[-0,-0,-0];const n=this.getScale(r),i=1/n[0],a=1/n[1],s=1/n[2];return e[0]=this[0]*i,e[1]=this[1]*a,e[2]=this[2]*s,e[3]=0,e[4]=this[4]*i,e[5]=this[5]*a,e[6]=this[6]*s,e[7]=0,e[8]=this[8]*i,e[9]=this[9]*a,e[10]=this[10]*s,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}getRotationMatrix3(e,r){e=e||[-0,-0,-0,-0,-0,-0,-0,-0,-0],r=r||[-0,-0,-0];const n=this.getScale(r),i=1/n[0],a=1/n[1],s=1/n[2];return e[0]=this[0]*i,e[1]=this[1]*a,e[2]=this[2]*s,e[3]=this[4]*i,e[4]=this[5]*a,e[5]=this[6]*s,e[6]=this[8]*i,e[7]=this[9]*a,e[8]=this[10]*s,e}transpose(){return jze(this,this),this.check()}invert(){return XM(this,this),this.check()}multiplyLeft(e){return hm(this,e,this),this.check()}multiplyRight(e){return hm(this,this,e),this.check()}rotateX(e){return Kee(this,this,e),this.check()}rotateY(e){return $ze(this,this,e),this.check()}rotateZ(e){return Jee(this,this,e),this.check()}rotateXYZ(e){return this.rotateX(e[0]).rotateY(e[1]).rotateZ(e[2])}rotateAxis(e,r){return Vze(this,this,e,r),this.check()}scale(e){return WN(this,this,Array.isArray(e)?e:[e,e,e]),this.check()}translate(e){return _E(this,this,e),this.check()}transform(e,r){return e.length===4?(r=G0(r||[-0,-0,-0,-0],e,this),zI(r,4),r):this.transformAsPoint(e,r)}transformAsPoint(e,r){const{length:n}=e;let i;switch(n){case 2:i=bze(r||[-0,-0],e,this);break;case 3:i=Yee(r||[-0,-0,-0],e,this);break;default:throw new Error("Illegal vector")}return zI(i,e.length),i}transformAsVector(e,r){let n;switch(e.length){case 2:n=xze(r||[-0,-0],e,this);break;case 3:n=Xee(r||[-0,-0,-0],e,this);break;default:throw new Error("Illegal vector")}return zI(n,e.length),n}transformPoint(e,r){return this.transformAsPoint(e,r)}transformVector(e,r){return this.transformAsPoint(e,r)}transformDirection(e,r){return this.transformAsVector(e,r)}makeRotationX(e){return this.identity().rotateX(e)}makeTranslation(e,r,n){return this.identity().translate([e,r,n])}}let K2,J2;function t9e(){return K2||(K2=new hf([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Object.freeze(K2)),K2}function r9e(){return J2||(J2=new hf,Object.freeze(J2)),J2}function Nq(t){if(t>Math.PI*2)throw Error("expected radians")}function n9e(t,e,r,n,i,a){const s=2*a/(r-e),o=2*a/(i-n),u=(r+e)/(r-e),h=(i+n)/(i-n),f=-1,g=-1,b=-2*a;return t[0]=s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=o,t[6]=0,t[7]=0,t[8]=u,t[9]=h,t[10]=f,t[11]=g,t[12]=0,t[13]=0,t[14]=b,t[15]=0,t}function ete(t,e=[],r=0){const n=Math.fround(t),i=t-n;return e[r]=n,e[r+1]=i,e}function i9e(t){return t-Math.fround(t)}function a9e(t){const e=new Float32Array(32);for(let r=0;r<4;++r)for(let n=0;n<4;++n){const i=r*4+n;ete(t[n*4+r],e,i*2)}return e}const o9e=`#ifdef LUMA_FP32_TAN_PRECISION_WORKAROUND

// All these functions are for substituting tan() function from Intel GPU only
const float TWO_PI = 6.2831854820251465;
const float PI_2 = 1.5707963705062866;
const float PI_16 = 0.1963495463132858;

const float SIN_TABLE_0 = 0.19509032368659973;
const float SIN_TABLE_1 = 0.3826834261417389;
const float SIN_TABLE_2 = 0.5555702447891235;
const float SIN_TABLE_3 = 0.7071067690849304;

const float COS_TABLE_0 = 0.9807852506637573;
const float COS_TABLE_1 = 0.9238795042037964;
const float COS_TABLE_2 = 0.8314695954322815;
const float COS_TABLE_3 = 0.7071067690849304;

const float INVERSE_FACTORIAL_3 = 1.666666716337204e-01; // 1/3!
const float INVERSE_FACTORIAL_5 = 8.333333767950535e-03; // 1/5!
const float INVERSE_FACTORIAL_7 = 1.9841270113829523e-04; // 1/7!
const float INVERSE_FACTORIAL_9 = 2.75573188446287533e-06; // 1/9!

float sin_taylor_fp32(float a) {
  float r, s, t, x;

  if (a == 0.0) {
    return 0.0;
  }

  x = -a * a;
  s = a;
  r = a;

  r = r * x;
  t = r * INVERSE_FACTORIAL_3;
  s = s + t;

  r = r * x;
  t = r * INVERSE_FACTORIAL_5;
  s = s + t;

  r = r * x;
  t = r * INVERSE_FACTORIAL_7;
  s = s + t;

  r = r * x;
  t = r * INVERSE_FACTORIAL_9;
  s = s + t;

  return s;
}

void sincos_taylor_fp32(float a, out float sin_t, out float cos_t) {
  if (a == 0.0) {
    sin_t = 0.0;
    cos_t = 1.0;
  }
  sin_t = sin_taylor_fp32(a);
  cos_t = sqrt(1.0 - sin_t * sin_t);
}

float tan_taylor_fp32(float a) {
    float sin_a;
    float cos_a;

    if (a == 0.0) {
        return 0.0;
    }

    // 2pi range reduction
    float z = floor(a / TWO_PI);
    float r = a - TWO_PI * z;

    float t;
    float q = floor(r / PI_2 + 0.5);
    int j = int(q);

    if (j < -2 || j > 2) {
        return 1.0 / 0.0;
    }

    t = r - PI_2 * q;

    q = floor(t / PI_16 + 0.5);
    int k = int(q);
    int abs_k = int(abs(float(k)));

    if (abs_k > 4) {
        return 1.0 / 0.0;
    } else {
        t = t - PI_16 * q;
    }

    float u = 0.0;
    float v = 0.0;

    float sin_t, cos_t;
    float s, c;
    sincos_taylor_fp32(t, sin_t, cos_t);

    if (k == 0) {
        s = sin_t;
        c = cos_t;
    } else {
        if (abs(float(abs_k) - 1.0) < 0.5) {
            u = COS_TABLE_0;
            v = SIN_TABLE_0;
        } else if (abs(float(abs_k) - 2.0) < 0.5) {
            u = COS_TABLE_1;
            v = SIN_TABLE_1;
        } else if (abs(float(abs_k) - 3.0) < 0.5) {
            u = COS_TABLE_2;
            v = SIN_TABLE_2;
        } else if (abs(float(abs_k) - 4.0) < 0.5) {
            u = COS_TABLE_3;
            v = SIN_TABLE_3;
        }
        if (k > 0) {
            s = u * sin_t + v * cos_t;
            c = u * cos_t - v * sin_t;
        } else {
            s = u * sin_t - v * cos_t;
            c = u * cos_t + v * sin_t;
        }
    }

    if (j == 0) {
        sin_a = s;
        cos_a = c;
    } else if (j == 1) {
        sin_a = c;
        cos_a = -s;
    } else if (j == -1) {
        sin_a = -c;
        cos_a = s;
    } else {
        sin_a = -s;
        cos_a = -c;
    }
    return sin_a / cos_a;
}
#endif

float tan_fp32(float a) {
#ifdef LUMA_FP32_TAN_PRECISION_WORKAROUND
  return tan_taylor_fp32(a);
#else
  return tan(a);
#endif
}
`,s9e={name:"fp32",vs:o9e},l9e=`
uniform fp64arithmeticUniforms {
  uniform float ONE;
} fp64;

/*
About LUMA_FP64_CODE_ELIMINATION_WORKAROUND

The purpose of this workaround is to prevent shader compilers from
optimizing away necessary arithmetic operations by swapping their sequences
or transform the equation to some 'equivalent' form.

The method is to multiply an artifical variable, ONE, which will be known to
the compiler to be 1 only at runtime. The whole expression is then represented
as a polynomial with respective to ONE. In the coefficients of all terms, only one a
and one b should appear

err = (a + b) * ONE^6 - a * ONE^5 - (a + b) * ONE^4 + a * ONE^3 - b - (a + b) * ONE^2 + a * ONE
*/

// Divide float number to high and low floats to extend fraction bits
vec2 split(float a) {
  const float SPLIT = 4097.0;
  float t = a * SPLIT;
#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)
  float a_hi = t * fp64.ONE - (t - a);
  float a_lo = a * fp64.ONE - a_hi;
#else
  float a_hi = t - (t - a);
  float a_lo = a - a_hi;
#endif
  return vec2(a_hi, a_lo);
}

// Divide float number again when high float uses too many fraction bits
vec2 split2(vec2 a) {
  vec2 b = split(a.x);
  b.y += a.y;
  return b;
}

// Special sum operation when a > b
vec2 quickTwoSum(float a, float b) {
#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)
  float sum = (a + b) * fp64.ONE;
  float err = b - (sum - a) * fp64.ONE;
#else
  float sum = a + b;
  float err = b - (sum - a);
#endif
  return vec2(sum, err);
}

// General sum operation
vec2 twoSum(float a, float b) {
  float s = (a + b);
#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)
  float v = (s * fp64.ONE - a) * fp64.ONE;
  float err = (a - (s - v) * fp64.ONE) * fp64.ONE * fp64.ONE * fp64.ONE + (b - v);
#else
  float v = s - a;
  float err = (a - (s - v)) + (b - v);
#endif
  return vec2(s, err);
}

vec2 twoSub(float a, float b) {
  float s = (a - b);
#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)
  float v = (s * fp64.ONE - a) * fp64.ONE;
  float err = (a - (s - v) * fp64.ONE) * fp64.ONE * fp64.ONE * fp64.ONE - (b + v);
#else
  float v = s - a;
  float err = (a - (s - v)) - (b + v);
#endif
  return vec2(s, err);
}

vec2 twoSqr(float a) {
  float prod = a * a;
  vec2 a_fp64 = split(a);
#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)
  float err = ((a_fp64.x * a_fp64.x - prod) * fp64.ONE + 2.0 * a_fp64.x *
    a_fp64.y * fp64.ONE * fp64.ONE) + a_fp64.y * a_fp64.y * fp64.ONE * fp64.ONE * fp64.ONE;
#else
  float err = ((a_fp64.x * a_fp64.x - prod) + 2.0 * a_fp64.x * a_fp64.y) + a_fp64.y * a_fp64.y;
#endif
  return vec2(prod, err);
}

vec2 twoProd(float a, float b) {
  float prod = a * b;
  vec2 a_fp64 = split(a);
  vec2 b_fp64 = split(b);
  float err = ((a_fp64.x * b_fp64.x - prod) + a_fp64.x * b_fp64.y +
    a_fp64.y * b_fp64.x) + a_fp64.y * b_fp64.y;
  return vec2(prod, err);
}

vec2 sum_fp64(vec2 a, vec2 b) {
  vec2 s, t;
  s = twoSum(a.x, b.x);
  t = twoSum(a.y, b.y);
  s.y += t.x;
  s = quickTwoSum(s.x, s.y);
  s.y += t.y;
  s = quickTwoSum(s.x, s.y);
  return s;
}

vec2 sub_fp64(vec2 a, vec2 b) {
  vec2 s, t;
  s = twoSub(a.x, b.x);
  t = twoSub(a.y, b.y);
  s.y += t.x;
  s = quickTwoSum(s.x, s.y);
  s.y += t.y;
  s = quickTwoSum(s.x, s.y);
  return s;
}

vec2 mul_fp64(vec2 a, vec2 b) {
  vec2 prod = twoProd(a.x, b.x);
  // y component is for the error
  prod.y += a.x * b.y;
#if defined(LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND)
  prod = split2(prod);
#endif
  prod = quickTwoSum(prod.x, prod.y);
  prod.y += a.y * b.x;
#if defined(LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND)
  prod = split2(prod);
#endif
  prod = quickTwoSum(prod.x, prod.y);
  return prod;
}

vec2 div_fp64(vec2 a, vec2 b) {
  float xn = 1.0 / b.x;
#if defined(LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND)
  vec2 yn = mul_fp64(a, vec2(xn, 0));
#else
  vec2 yn = a * xn;
#endif
  float diff = (sub_fp64(a, mul_fp64(b, yn))).x;
  vec2 prod = twoProd(xn, diff);
  return sum_fp64(yn, prod);
}

vec2 sqrt_fp64(vec2 a) {
  if (a.x == 0.0 && a.y == 0.0) return vec2(0.0, 0.0);
  if (a.x < 0.0) return vec2(0.0 / 0.0, 0.0 / 0.0);

  float x = 1.0 / sqrt(a.x);
  float yn = a.x * x;
#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)
  vec2 yn_sqr = twoSqr(yn) * fp64.ONE;
#else
  vec2 yn_sqr = twoSqr(yn);
#endif
  float diff = sub_fp64(a, yn_sqr).x;
  vec2 prod = twoProd(x * 0.5, diff);
#if defined(LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND)
  return sum_fp64(split(yn), prod);
#else
  return sum_fp64(vec2(yn, 0.0), prod);
#endif
}
`,u9e={ONE:1},c9e={name:"fp64arithmetic",vs:l9e,defaultUniforms:u9e,uniformTypes:{ONE:"f32"},fp64ify:ete,fp64LowPart:i9e,fp64ifyMatrix4:a9e},h9e=[0,1,1,1],f9e=`uniform pickingUniforms {
  float isActive;
  float isAttribute;
  float isHighlightActive;
  float useFloatColors;
  vec3 highlightedObjectColor;
  vec4 highlightColor;
} picking;

out vec4 picking_vRGBcolor_Avalid;

// Normalize unsigned byte color to 0-1 range
vec3 picking_normalizeColor(vec3 color) {
  return picking.useFloatColors > 0.5 ? color : color / 255.0;
}

// Normalize unsigned byte color to 0-1 range
vec4 picking_normalizeColor(vec4 color) {
  return picking.useFloatColors > 0.5 ? color : color / 255.0;
}

bool picking_isColorZero(vec3 color) {
  return dot(color, vec3(1.0)) < 0.00001;
}

bool picking_isColorValid(vec3 color) {
  return dot(color, vec3(1.0)) > 0.00001;
}

// Check if this vertex is highlighted 
bool isVertexHighlighted(vec3 vertexColor) {
  vec3 highlightedObjectColor = picking_normalizeColor(picking.highlightedObjectColor);
  return
    bool(picking.isHighlightActive) && picking_isColorZero(abs(vertexColor - highlightedObjectColor));
}

// Set the current picking color
void picking_setPickingColor(vec3 pickingColor) {
  pickingColor = picking_normalizeColor(pickingColor);

  if (bool(picking.isActive)) {
    // Use alpha as the validity flag. If pickingColor is [0, 0, 0] fragment is non-pickable
    picking_vRGBcolor_Avalid.a = float(picking_isColorValid(pickingColor));

    if (!bool(picking.isAttribute)) {
      // Stores the picking color so that the fragment shader can render it during picking
      picking_vRGBcolor_Avalid.rgb = pickingColor;
    }
  } else {
    // Do the comparison with selected item color in vertex shader as it should mean fewer compares
    picking_vRGBcolor_Avalid.a = float(isVertexHighlighted(pickingColor));
  }
}

void picking_setPickingAttribute(float value) {
  if (bool(picking.isAttribute)) {
    picking_vRGBcolor_Avalid.r = value;
  }
}

void picking_setPickingAttribute(vec2 value) {
  if (bool(picking.isAttribute)) {
    picking_vRGBcolor_Avalid.rg = value;
  }
}

void picking_setPickingAttribute(vec3 value) {
  if (bool(picking.isAttribute)) {
    picking_vRGBcolor_Avalid.rgb = value;
  }
}
`,d9e=`uniform pickingUniforms {
  float isActive;
  float isAttribute;
  float isHighlightActive;
  float useFloatColors;
  vec3 highlightedObjectColor;
  vec4 highlightColor;
} picking;

in vec4 picking_vRGBcolor_Avalid;

/*
 * Returns highlight color if this item is selected.
 */
vec4 picking_filterHighlightColor(vec4 color) {
  // If we are still picking, we don't highlight
  if (picking.isActive > 0.5) {
    return color;
  }

  bool selected = bool(picking_vRGBcolor_Avalid.a);

  if (selected) {
    // Blend in highlight color based on its alpha value
    float highLightAlpha = picking.highlightColor.a;
    float blendedAlpha = highLightAlpha + color.a * (1.0 - highLightAlpha);
    float highLightRatio = highLightAlpha / blendedAlpha;

    vec3 blendedRGB = mix(color.rgb, picking.highlightColor.rgb, highLightRatio);
    return vec4(blendedRGB, blendedAlpha);
  } else {
    return color;
  }
}

/*
 * Returns picking color if picking enabled else unmodified argument.
 */
vec4 picking_filterPickingColor(vec4 color) {
  if (bool(picking.isActive)) {
    if (picking_vRGBcolor_Avalid.a == 0.0) {
      discard;
    }
    return picking_vRGBcolor_Avalid;
  }
  return color;
}

/*
 * Returns picking color if picking is enabled if not
 * highlight color if this item is selected, otherwise unmodified argument.
 */
vec4 picking_filterColor(vec4 color) {
  vec4 highlightColor = picking_filterHighlightColor(color);
  return picking_filterPickingColor(highlightColor);
}
`,Dq={props:{},uniforms:{},name:"picking",uniformTypes:{isActive:"f32",isAttribute:"f32",isHighlightActive:"f32",useFloatColors:"f32",highlightedObjectColor:"vec3<f32>",highlightColor:"vec4<f32>"},defaultUniforms:{isActive:!1,isAttribute:!1,isHighlightActive:!1,useFloatColors:!0,highlightedObjectColor:[0,0,0],highlightColor:h9e},vs:f9e,fs:d9e,getUniforms:p9e};function p9e(t={},e){const r={};if(t.highlightedObjectColor!==void 0)if(t.highlightedObjectColor===null)r.isHighlightActive=!1;else{r.isHighlightActive=!0;const n=t.highlightedObjectColor.slice(0,3);r.highlightedObjectColor=n}if(t.highlightColor){const n=Array.from(t.highlightColor,i=>i/255);Number.isFinite(n[3])||(n[3]=1),r.highlightColor=n}return t.isActive!==void 0&&(r.isActive=!!t.isActive,r.isAttribute=!!t.isAttribute),t.useFloatColors!==void 0&&(r.useFloatColors=!!t.useFloatColors),r}const Fq=`precision highp int;

// #if (defined(SHADER_TYPE_FRAGMENT) && defined(LIGHTING_FRAGMENT)) || (defined(SHADER_TYPE_VERTEX) && defined(LIGHTING_VERTEX))
struct AmbientLight {
  vec3 color;
};

struct PointLight {
  vec3 color;
  vec3 position;
  vec3 attenuation; // 2nd order x:Constant-y:Linear-z:Exponential
};

struct DirectionalLight {
  vec3 color;
  vec3 direction;
};

uniform lightingUniforms {
  int enabled;
  int lightType;

  int directionalLightCount;
  int pointLightCount;

  vec3 ambientColor;

  vec3 lightColor0;
  vec3 lightPosition0;
  vec3 lightDirection0;
  vec3 lightAttenuation0;

  vec3 lightColor1;
  vec3 lightPosition1;
  vec3 lightDirection1;
  vec3 lightAttenuation1;

  vec3 lightColor2;
  vec3 lightPosition2;
  vec3 lightDirection2;
  vec3 lightAttenuation2;
} lighting;

PointLight lighting_getPointLight(int index) {
  switch (index) {
    case 0:
      return PointLight(lighting.lightColor0, lighting.lightPosition0, lighting.lightAttenuation0);
    case 1:
      return PointLight(lighting.lightColor1, lighting.lightPosition1, lighting.lightAttenuation1);
    case 2:
    default:  
      return PointLight(lighting.lightColor2, lighting.lightPosition2, lighting.lightAttenuation2);
  }
}

DirectionalLight lighting_getDirectionalLight(int index) {
  switch (index) {
    case 0:
      return DirectionalLight(lighting.lightColor0, lighting.lightDirection0);
    case 1:
      return DirectionalLight(lighting.lightColor1, lighting.lightDirection1);
    case 2:
    default:   
      return DirectionalLight(lighting.lightColor2, lighting.lightDirection2);
  }
} 

float getPointLightAttenuation(PointLight pointLight, float distance) {
  return pointLight.attenuation.x
       + pointLight.attenuation.y * distance
       + pointLight.attenuation.z * distance * distance;
}

// #endif
`,g9e=`// #if (defined(SHADER_TYPE_FRAGMENT) && defined(LIGHTING_FRAGMENT)) || (defined(SHADER_TYPE_VERTEX) && defined(LIGHTING_VERTEX))
struct AmbientLight {
  color: vec3<f32>,
};

struct PointLight {
  color: vec3<f32>,
  position: vec3<f32>,
  attenuation: vec3<f32>, // 2nd order x:Constant-y:Linear-z:Exponential
};

struct DirectionalLight {
  color: vec3<f32>,
  direction: vec3<f32>,
};

struct lightingUniforms {
  enabled: i32,
  pointLightCount: i32,
  directionalLightCount: i32,

  ambientColor: vec3<f32>,

  // TODO - support multiple lights by uncommenting arrays below
  lightType: i32,
  lightColor: vec3<f32>,
  lightDirection: vec3<f32>,
  lightPosition: vec3<f32>,
  lightAttenuation: vec3<f32>,

  // AmbientLight ambientLight;
  // PointLight pointLight[MAX_LIGHTS];
  // DirectionalLight directionalLight[MAX_LIGHTS];
};

// Binding 0:1 is reserved for lighting (Note: could go into separate bind group as it is stable across draw calls)
@binding(1) @group(0) var<uniform> lighting : lightingUniforms;

fn lighting_getPointLight(index: i32) -> PointLight {
  return PointLight(lighting.lightColor, lighting.lightPosition, lighting.lightAttenuation);
}

fn lighting_getDirectionalLight(index: i32) -> DirectionalLight {
  return DirectionalLight(lighting.lightColor, lighting.lightDirection);
} 

fn getPointLightAttenuation(pointLight: PointLight, distance: f32) -> f32 {
  return pointLight.attenuation.x
       + pointLight.attenuation.y * distance
       + pointLight.attenuation.z * distance * distance;
}
`,tte=3,m9e=255;var Ib;(function(t){t[t.POINT=0]="POINT",t[t.DIRECTIONAL=1]="DIRECTIONAL"})(Ib||(Ib={}));const j1={props:{},uniforms:{},name:"lighting",defines:{MAX_LIGHTS:tte},uniformTypes:{enabled:"i32",lightType:"i32",directionalLightCount:"i32",pointLightCount:"i32",ambientLightColor:"vec3<f32>",lightColor0:"vec3<f32>",lightPosition0:"vec3<f32>",lightDirection0:"vec3<f32>",lightAttenuation0:"vec3<f32>",lightColor1:"vec3<f32>",lightPosition1:"vec3<f32>",lightDirection1:"vec3<f32>",lightAttenuation1:"vec3<f32>",lightColor2:"vec3<f32>",lightPosition2:"vec3<f32>",lightDirection2:"vec3<f32>",lightAttenuation2:"vec3<f32>"},defaultUniforms:{enabled:1,lightType:Ib.POINT,directionalLightCount:0,pointLightCount:0,ambientLightColor:[.1,.1,.1],lightColor0:[1,1,1],lightPosition0:[1,1,2],lightDirection0:[1,1,1],lightAttenuation0:[1,0,0],lightColor1:[1,1,1],lightPosition1:[1,1,2],lightDirection1:[1,1,1],lightAttenuation1:[1,0,0],lightColor2:[1,1,1],lightPosition2:[1,1,2],lightDirection2:[1,1,1],lightAttenuation2:[1,0,0]},source:g9e,vs:Fq,fs:Fq,getUniforms:y9e};function y9e(t,e={}){if(t=t&&{...t},!t)return{...j1.defaultUniforms};t.lights&&(t={...t,..._9e(t.lights),lights:void 0});const{ambientLight:r,pointLights:n,directionalLights:i}=t||{};if(!(r||n&&n.length>0||i&&i.length>0))return{...j1.defaultUniforms,enabled:0};const s={...j1.defaultUniforms,...e,...v9e({ambientLight:r,pointLights:n,directionalLights:i})};return t.enabled!==void 0&&(s.enabled=t.enabled?1:0),s}function v9e({ambientLight:t,pointLights:e=[],directionalLights:r=[]}){const n={};n.ambientLightColor=qI(t);let i=0;for(const a of e){n.lightType=Ib.POINT;const s=i;n[`lightColor${s}`]=qI(a),n[`lightPosition${s}`]=a.position,n[`lightAttenuation${s}`]=a.attenuation||[1,0,0],i++}for(const a of r){n.lightType=Ib.DIRECTIONAL;const s=i;n[`lightColor${s}`]=qI(a),n[`lightDirection${s}`]=a.direction,i++}return i>tte&&dn.warn("MAX_LIGHTS exceeded")(),n.directionalLightCount=r.length,n.pointLightCount=e.length,n}function _9e(t){const e={pointLights:[],directionalLights:[]};for(const r of t||[])switch(r.type){case"ambient":e.ambientLight=r;break;case"directional":e.directionalLights?.push(r);break;case"point":e.pointLights?.push(r);break}return e}function qI(t={}){const{color:e=[0,0,0],intensity:r=1}=t;return e.map(n=>n*r/m9e)}const rte=`uniform phongMaterialUniforms {
  uniform float ambient;
  uniform float diffuse;
  uniform float shininess;
  uniform vec3  specularColor;
} material;
`,nte=`uniform phongMaterialUniforms {
  uniform float ambient;
  uniform float diffuse;
  uniform float shininess;
  uniform vec3  specularColor;
} material;

vec3 lighting_getLightColor(vec3 surfaceColor, vec3 light_direction, vec3 view_direction, vec3 normal_worldspace, vec3 color) {
  vec3 halfway_direction = normalize(light_direction + view_direction);
  float lambertian = dot(light_direction, normal_worldspace);
  float specular = 0.0;
  if (lambertian > 0.0) {
    float specular_angle = max(dot(normal_worldspace, halfway_direction), 0.0);
    specular = pow(specular_angle, material.shininess);
  }
  lambertian = max(lambertian, 0.0);
  return (lambertian * material.diffuse * surfaceColor + specular * material.specularColor) * color;
}

vec3 lighting_getLightColor(vec3 surfaceColor, vec3 cameraPosition, vec3 position_worldspace, vec3 normal_worldspace) {
  vec3 lightColor = surfaceColor;

  if (lighting.enabled == 0) {
    return lightColor;
  }

  vec3 view_direction = normalize(cameraPosition - position_worldspace);
  lightColor = material.ambient * surfaceColor * lighting.ambientColor;

  for (int i = 0; i < lighting.pointLightCount; i++) {
    PointLight pointLight = lighting_getPointLight(i);
    vec3 light_position_worldspace = pointLight.position;
    vec3 light_direction = normalize(light_position_worldspace - position_worldspace);
    float light_attenuation = getPointLightAttenuation(pointLight, distance(light_position_worldspace, position_worldspace));
    lightColor += lighting_getLightColor(surfaceColor, light_direction, view_direction, normal_worldspace, pointLight.color / light_attenuation);
  }

  int totalLights = min(MAX_LIGHTS, lighting.pointLightCount + lighting.directionalLightCount);
  for (int i = lighting.pointLightCount; i < totalLights; i++) {
    DirectionalLight directionalLight = lighting_getDirectionalLight(i);
    lightColor += lighting_getLightColor(surfaceColor, -directionalLight.direction, view_direction, normal_worldspace, directionalLight.color);
  }
  
  return lightColor;
}
`,ite=`struct phongMaterialUniforms {
  ambient: f32,
  diffuse: f32,
  shininess: f32,
  specularColor: vec3<f32>,
};

@binding(2) @group(0) var<uniform> phongMaterial : phongMaterialUniforms;

fn lighting_getLightColor(surfaceColor: vec3<f32>, light_direction: vec3<f32>, view_direction: vec3<f32>, normal_worldspace: vec3<f32>, color: vec3<f32>) -> vec3<f32> {
  let halfway_direction: vec3<f32> = normalize(light_direction + view_direction);
  var lambertian: f32 = dot(light_direction, normal_worldspace);
  var specular: f32 = 0.0;
  if (lambertian > 0.0) {
    let specular_angle = max(dot(normal_worldspace, halfway_direction), 0.0);
    specular = pow(specular_angle, phongMaterial.shininess);
  }
  lambertian = max(lambertian, 0.0);
  return (lambertian * phongMaterial.diffuse * surfaceColor + specular * phongMaterial.specularColor) * color;
}

fn lighting_getLightColor2(surfaceColor: vec3<f32>, cameraPosition: vec3<f32>, position_worldspace: vec3<f32>, normal_worldspace: vec3<f32>) -> vec3<f32> {
  var lightColor: vec3<f32> = surfaceColor;

  if (lighting.enabled == 0) {
    return lightColor;
  }

  let view_direction: vec3<f32> = normalize(cameraPosition - position_worldspace);
  lightColor = phongMaterial.ambient * surfaceColor * lighting.ambientColor;

  if (lighting.lightType == 0) {
    let pointLight: PointLight  = lighting_getPointLight(0);
    let light_position_worldspace: vec3<f32> = pointLight.position;
    let light_direction: vec3<f32> = normalize(light_position_worldspace - position_worldspace);
    lightColor += lighting_getLightColor(surfaceColor, light_direction, view_direction, normal_worldspace, pointLight.color);
  } else if (lighting.lightType == 1) {
    var directionalLight: DirectionalLight = lighting_getDirectionalLight(0);
    lightColor += lighting_getLightColor(surfaceColor, -directionalLight.direction, view_direction, normal_worldspace, directionalLight.color);
  }
  
  return lightColor;
  /*
  for (int i = 0; i < MAX_LIGHTS; i++) {
    if (i >= lighting.pointLightCount) {
      break;
    }
    PointLight pointLight = lighting.pointLight[i];
    vec3 light_position_worldspace = pointLight.position;
    vec3 light_direction = normalize(light_position_worldspace - position_worldspace);
    lightColor += lighting_getLightColor(surfaceColor, light_direction, view_direction, normal_worldspace, pointLight.color);
  }

  for (int i = 0; i < MAX_LIGHTS; i++) {
    if (i >= lighting.directionalLightCount) {
      break;
    }
    DirectionalLight directionalLight = lighting.directionalLight[i];
    lightColor += lighting_getLightColor(surfaceColor, -directionalLight.direction, view_direction, normal_worldspace, directionalLight.color);
  }
  */
}

fn lighting_getSpecularLightColor(cameraPosition: vec3<f32>, position_worldspace: vec3<f32>, normal_worldspace: vec3<f32>) -> vec3<f32>{
  var lightColor = vec3<f32>(0, 0, 0);
  let surfaceColor = vec3<f32>(0, 0, 0);

  if (lighting.enabled == 0) {
    let view_direction = normalize(cameraPosition - position_worldspace);

    switch (lighting.lightType) {
      case 0, default: {
        let pointLight: PointLight = lighting_getPointLight(0);
        let light_position_worldspace: vec3<f32> = pointLight.position;
        let light_direction: vec3<f32> = normalize(light_position_worldspace - position_worldspace);
        lightColor += lighting_getLightColor(surfaceColor, light_direction, view_direction, normal_worldspace, pointLight.color);
      }
      case 1: {
        let directionalLight: DirectionalLight = lighting_getDirectionalLight(0);
        lightColor += lighting_getLightColor(surfaceColor, -directionalLight.direction, view_direction, normal_worldspace, directionalLight.color);
      }
    }
  }
  return lightColor;
}
`,ate={props:{},name:"gouraudMaterial",vs:nte.replace("phongMaterial","gouraudMaterial"),fs:rte.replace("phongMaterial","gouraudMaterial"),source:ite.replaceAll("phongMaterial","gouraudMaterial"),defines:{LIGHTING_VERTEX:1},dependencies:[j1],uniformTypes:{ambient:"f32",diffuse:"f32",shininess:"f32",specularColor:"vec3<f32>"},defaultUniforms:{ambient:.35,diffuse:.6,shininess:32,specularColor:[.15,.15,.15]},getUniforms(t){const e={...t};return e.specularColor&&(e.specularColor=e.specularColor.map(r=>r/255)),{...ate.defaultUniforms,...e}}},ote={name:"phongMaterial",dependencies:[j1],source:ite,vs:rte,fs:nte,defines:{LIGHTING_FRAGMENT:1},uniformTypes:{ambient:"f32",diffuse:"f32",shininess:"f32",specularColor:"vec3<f32>"},defaultUniforms:{ambient:.35,diffuse:.6,shininess:32,specularColor:[.15,.15,.15]},getUniforms(t){const e={...t};return e.specularColor&&(e.specularColor=e.specularColor.map(r=>r/255)),{...ote.defaultUniforms,...e}}},Bq=`uniform layerUniforms {
  uniform float opacity;
} layer;
`,b9e={name:"layer",vs:Bq,fs:Bq,getUniforms:t=>({opacity:Math.pow(t.opacity,1/2.2)}),uniformTypes:{opacity:"f32"}},x9e=`const SMOOTH_EDGE_RADIUS: f32 = 0.5;

struct VertexGeometry {
  position: vec4<f32>,
  worldPosition: vec3<f32>,
  worldPositionAlt: vec3<f32>,
  normal: vec3<f32>,
  uv: vec2<f32>,
  pickingColor: vec3<f32>,
};

var<private> geometry_: VertexGeometry = VertexGeometry(
  vec4<f32>(0.0, 0.0, 1.0, 0.0),
  vec3<f32>(0.0, 0.0, 0.0),
  vec3<f32>(0.0, 0.0, 0.0),
  vec3<f32>(0.0, 0.0, 0.0),
  vec2<f32>(0.0, 0.0),
  vec3<f32>(0.0, 0.0, 0.0)
);

struct FragmentGeometry {
  uv: vec2<f32>,
};

var<private> fragmentGeometry: FragmentGeometry;

fn smoothedge(edge: f32, x: f32) -> f32 {
  return smoothstep(edge - SMOOTH_EDGE_RADIUS, edge + SMOOTH_EDGE_RADIUS, x);
}
`,ste="#define SMOOTH_EDGE_RADIUS 0.5",w9e=`${ste}

struct VertexGeometry {
  vec4 position;
  vec3 worldPosition;
  vec3 worldPositionAlt;
  vec3 normal;
  vec2 uv;
  vec3 pickingColor;
} geometry = VertexGeometry(
  vec4(0.0, 0.0, 1.0, 0.0),
  vec3(0.0),
  vec3(0.0),
  vec3(0.0),
  vec2(0.0),
  vec3(0.0)
);
`,S9e=`${ste}

struct FragmentGeometry {
  vec2 uv;
} geometry;

float smoothedge(float edge, float x) {
  return smoothstep(edge - SMOOTH_EDGE_RADIUS, edge + SMOOTH_EDGE_RADIUS, x);
}
`,lte={name:"geometry",source:x9e,vs:w9e,fs:S9e},E9e=25;var ml;(function(t){t[t.Start=1]="Start",t[t.Move=2]="Move",t[t.End=4]="End",t[t.Cancel=8]="Cancel"})(ml||(ml={}));var kl;(function(t){t[t.None=0]="None",t[t.Left=1]="Left",t[t.Right=2]="Right",t[t.Up=4]="Up",t[t.Down=8]="Down",t[t.Horizontal=3]="Horizontal",t[t.Vertical=12]="Vertical",t[t.All=15]="All"})(kl||(kl={}));var Vi;(function(t){t[t.Possible=1]="Possible",t[t.Began=2]="Began",t[t.Changed=4]="Changed",t[t.Ended=8]="Ended",t[t.Recognized=8]="Recognized",t[t.Cancelled=16]="Cancelled",t[t.Failed=32]="Failed"})(Vi||(Vi={}));const T9e="compute",C9e="auto",ZM="manipulation",Nw="none",KM="pan-x",JM="pan-y";function A9e(t){if(t.includes(Nw))return Nw;const e=t.includes(KM),r=t.includes(JM);return e&&r?Nw:e||r?e?KM:JM:t.includes(ZM)?ZM:C9e}class I9e{constructor(e,r){this.actions="",this.manager=e,this.set(r)}set(e){e===T9e&&(e=this.compute()),this.manager.element&&(this.manager.element.style.touchAction=e,this.actions=e)}update(){this.set(this.manager.options.touchAction)}compute(){let e=[];for(const r of this.manager.recognizers)r.options.enable&&(e=e.concat(r.getTouchAction()));return A9e(e.join(" "))}}function bE(t){return t.trim().split(/\s+/g)}function HI(t,e,r){if(t)for(const n of bE(e))t.addEventListener(n,r,!1)}function WI(t,e,r){if(t)for(const n of bE(e))t.removeEventListener(n,r,!1)}function zq(t){return(t.ownerDocument||t).defaultView}function P9e(t,e){let r=t;for(;r;){if(r===e)return!0;r=r.parentNode}return!1}function ute(t){const e=t.length;if(e===1)return{x:Math.round(t[0].clientX),y:Math.round(t[0].clientY)};let r=0,n=0,i=0;for(;i<e;)r+=t[i].clientX,n+=t[i].clientY,i++;return{x:Math.round(r/e),y:Math.round(n/e)}}function jq(t){const e=[];let r=0;for(;r<t.pointers.length;)e[r]={clientX:Math.round(t.pointers[r].clientX),clientY:Math.round(t.pointers[r].clientY)},r++;return{timeStamp:Date.now(),pointers:e,center:ute(e),deltaX:t.deltaX,deltaY:t.deltaY}}function cte(t,e){const r=e.x-t.x,n=e.y-t.y;return Math.sqrt(r*r+n*n)}function Uq(t,e){const r=e.clientX-t.clientX,n=e.clientY-t.clientY;return Math.sqrt(r*r+n*n)}function k9e(t,e){const r=e.x-t.x,n=e.y-t.y;return Math.atan2(n,r)*180/Math.PI}function Vq(t,e){const r=e.clientX-t.clientX,n=e.clientY-t.clientY;return Math.atan2(n,r)*180/Math.PI}function hte(t,e){return t===e?kl.None:Math.abs(t)>=Math.abs(e)?t<0?kl.Left:kl.Right:e<0?kl.Up:kl.Down}function M9e(t,e){const r=e.center;let n=t.offsetDelta,i=t.prevDelta;const a=t.prevInput;return(e.eventType===ml.Start||a?.eventType===ml.End)&&(i=t.prevDelta={x:a?.deltaX||0,y:a?.deltaY||0},n=t.offsetDelta={x:r.x,y:r.y}),{deltaX:i.x+(r.x-n.x),deltaY:i.y+(r.y-n.y)}}function fte(t,e,r){return{x:e/t||0,y:r/t||0}}function R9e(t,e){return Uq(e[0],e[1])/Uq(t[0],t[1])}function O9e(t,e){return Vq(e[1],e[0])-Vq(t[1],t[0])}function L9e(t,e){const r=t.lastInterval||e,n=e.timeStamp-r.timeStamp;let i,a,s,o;if(e.eventType!==ml.Cancel&&(n>E9e||r.velocity===void 0)){const u=e.deltaX-r.deltaX,h=e.deltaY-r.deltaY,f=fte(n,u,h);a=f.x,s=f.y,i=Math.abs(f.x)>Math.abs(f.y)?f.x:f.y,o=hte(u,h),t.lastInterval=e}else i=r.velocity,a=r.velocityX,s=r.velocityY,o=r.direction;e.velocity=i,e.velocityX=a,e.velocityY=s,e.direction=o}function N9e(t,e){const{session:r}=t,{pointers:n}=e,{length:i}=n;r.firstInput||(r.firstInput=jq(e)),i>1&&!r.firstMultiple?r.firstMultiple=jq(e):i===1&&(r.firstMultiple=!1);const{firstInput:a,firstMultiple:s}=r,o=s?s.center:a.center,u=e.center=ute(n);e.timeStamp=Date.now(),e.deltaTime=e.timeStamp-a.timeStamp,e.angle=k9e(o,u),e.distance=cte(o,u);const{deltaX:h,deltaY:f}=M9e(r,e);e.deltaX=h,e.deltaY=f,e.offsetDirection=hte(e.deltaX,e.deltaY);const g=fte(e.deltaTime,e.deltaX,e.deltaY);e.overallVelocityX=g.x,e.overallVelocityY=g.y,e.overallVelocity=Math.abs(g.x)>Math.abs(g.y)?g.x:g.y,e.scale=s?R9e(s.pointers,n):1,e.rotation=s?O9e(s.pointers,n):0,e.maxPointers=r.prevInput?e.pointers.length>r.prevInput.maxPointers?e.pointers.length:r.prevInput.maxPointers:e.pointers.length;let b=t.element;return P9e(e.srcEvent.target,b)&&(b=e.srcEvent.target),e.target=b,L9e(r,e),e}function D9e(t,e,r){const n=r.pointers.length,i=r.changedPointers.length,a=e&ml.Start&&n-i===0,s=e&(ml.End|ml.Cancel)&&n-i===0;r.isFirst=!!a,r.isFinal=!!s,a&&(t.session={}),r.eventType=e;const o=N9e(t,r);t.emit("hammer.input",o),t.recognize(o),t.session.prevInput=o}let F9e=class{constructor(e){this.evEl="",this.evWin="",this.evTarget="",this.domHandler=r=>{this.manager.options.enable&&this.handler(r)},this.manager=e,this.element=e.element,this.target=e.options.inputTarget||e.element}callback(e,r){D9e(this.manager,e,r)}init(){HI(this.element,this.evEl,this.domHandler),HI(this.target,this.evTarget,this.domHandler),HI(zq(this.element),this.evWin,this.domHandler)}destroy(){WI(this.element,this.evEl,this.domHandler),WI(this.target,this.evTarget,this.domHandler),WI(zq(this.element),this.evWin,this.domHandler)}};const B9e={pointerdown:ml.Start,pointermove:ml.Move,pointerup:ml.End,pointercancel:ml.Cancel,pointerout:ml.Cancel},z9e="pointerdown",j9e="pointermove pointerup pointercancel";class U9e extends F9e{constructor(e){super(e),this.evEl=z9e,this.evWin=j9e,this.store=this.manager.session.pointerEvents=[],this.init()}handler(e){const{store:r}=this;let n=!1;const i=B9e[e.type],a=e.pointerType,s=a==="touch";let o=r.findIndex(u=>u.pointerId===e.pointerId);i&ml.Start&&(e.buttons||s)?o<0&&(r.push(e),o=r.length-1):i&(ml.End|ml.Cancel)&&(n=!0),!(o<0)&&(r[o]=e,this.callback(i,{pointers:r,changedPointers:[e],eventType:i,pointerType:a,srcEvent:e}),n&&r.splice(o,1))}}const V9e=["","webkit","Moz","MS","ms","o"];function $9e(t,e){const r=e[0].toUpperCase()+e.slice(1);for(const n of V9e){const i=n?n+r:e;if(i in t)return i}}const q9e=1,$q=2,qq={touchAction:"compute",enable:!0,inputTarget:null,cssProps:{userSelect:"none",userDrag:"none",touchCallout:"none",tapHighlightColor:"rgba(0,0,0,0)"}};class H9e{constructor(e,r){this.options={...qq,...r,cssProps:{...qq.cssProps,...r.cssProps},inputTarget:r.inputTarget||e},this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=e,this.input=new U9e(this),this.touchAction=new I9e(this,this.options.touchAction),this.toggleCssProps(!0)}set(e){return Object.assign(this.options,e),e.touchAction&&this.touchAction.update(),e.inputTarget&&(this.input.destroy(),this.input.target=e.inputTarget,this.input.init()),this}stop(e){this.session.stopped=e?$q:q9e}recognize(e){const{session:r}=this;if(r.stopped)return;this.session.prevented&&e.srcEvent.preventDefault();let n;const{recognizers:i}=this;let{curRecognizer:a}=r;(!a||a&&a.state&Vi.Recognized)&&(a=r.curRecognizer=null);let s=0;for(;s<i.length;)n=i[s],r.stopped!==$q&&(!a||n===a||n.canRecognizeWith(a))?n.recognize(e):n.reset(),!a&&n.state&(Vi.Began|Vi.Changed|Vi.Ended)&&(a=r.curRecognizer=n),s++}get(e){const{recognizers:r}=this;for(let n=0;n<r.length;n++)if(r[n].options.event===e)return r[n];return null}add(e){if(Array.isArray(e)){for(const n of e)this.add(n);return this}const r=this.get(e.options.event);return r&&this.remove(r),this.recognizers.push(e),e.manager=this,this.touchAction.update(),e}remove(e){if(Array.isArray(e)){for(const n of e)this.remove(n);return this}const r=typeof e=="string"?this.get(e):e;if(r){const{recognizers:n}=this,i=n.indexOf(r);i!==-1&&(n.splice(i,1),this.touchAction.update())}return this}on(e,r){if(!e||!r)return;const{handlers:n}=this;for(const i of bE(e))n[i]=n[i]||[],n[i].push(r)}off(e,r){if(!e)return;const{handlers:n}=this;for(const i of bE(e))r?n[i]&&n[i].splice(n[i].indexOf(r),1):delete n[i]}emit(e,r){const n=this.handlers[e]&&this.handlers[e].slice();if(!n||!n.length)return;const i=r;i.type=e,i.preventDefault=function(){r.srcEvent.preventDefault()};let a=0;for(;a<n.length;)n[a](i),a++}destroy(){this.toggleCssProps(!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}toggleCssProps(e){const{element:r}=this;if(r){for(const[n,i]of Object.entries(this.options.cssProps)){const a=$9e(r.style,n);e?(this.oldCssProps[a]=r.style[a],r.style[a]=i):r.style[a]=this.oldCssProps[a]||""}e||(this.oldCssProps={})}}}let W9e=1;function G9e(){return W9e++}function Hq(t){return t&Vi.Cancelled?"cancel":t&Vi.Ended?"end":t&Vi.Changed?"move":t&Vi.Began?"start":""}class dte{constructor(e){this.options=e,this.id=G9e(),this.state=Vi.Possible,this.simultaneous={},this.requireFail=[]}set(e){return Object.assign(this.options,e),this.manager.touchAction.update(),this}recognizeWith(e){if(Array.isArray(e)){for(const i of e)this.recognizeWith(i);return this}let r;if(typeof e=="string"){if(r=this.manager.get(e),!r)throw new Error(`Cannot find recognizer ${e}`)}else r=e;const{simultaneous:n}=this;return n[r.id]||(n[r.id]=r,r.recognizeWith(this)),this}dropRecognizeWith(e){if(Array.isArray(e)){for(const n of e)this.dropRecognizeWith(n);return this}let r;return typeof e=="string"?r=this.manager.get(e):r=e,r&&delete this.simultaneous[r.id],this}requireFailure(e){if(Array.isArray(e)){for(const i of e)this.requireFailure(i);return this}let r;if(typeof e=="string"){if(r=this.manager.get(e),!r)throw new Error(`Cannot find recognizer ${e}`)}else r=e;const{requireFail:n}=this;return n.indexOf(r)===-1&&(n.push(r),r.requireFailure(this)),this}dropRequireFailure(e){if(Array.isArray(e)){for(const n of e)this.dropRequireFailure(n);return this}let r;if(typeof e=="string"?r=this.manager.get(e):r=e,r){const n=this.requireFail.indexOf(r);n>-1&&this.requireFail.splice(n,1)}return this}hasRequireFailures(){return!!this.requireFail.find(e=>e.options.enable)}canRecognizeWith(e){return!!this.simultaneous[e.id]}emit(e){if(!e)return;const{state:r}=this;r<Vi.Ended&&this.manager.emit(this.options.event+Hq(r),e),this.manager.emit(this.options.event,e),e.additionalEvent&&this.manager.emit(e.additionalEvent,e),r>=Vi.Ended&&this.manager.emit(this.options.event+Hq(r),e)}tryEmit(e){this.canEmit()?this.emit(e):this.state=Vi.Failed}canEmit(){let e=0;for(;e<this.requireFail.length;){if(!(this.requireFail[e].state&(Vi.Failed|Vi.Possible)))return!1;e++}return!0}recognize(e){const r={...e};if(!this.options.enable){this.reset(),this.state=Vi.Failed;return}this.state&(Vi.Recognized|Vi.Cancelled|Vi.Failed)&&(this.state=Vi.Possible),this.state=this.process(r),this.state&(Vi.Began|Vi.Changed|Vi.Ended|Vi.Cancelled)&&this.tryEmit(r)}getEventNames(){return[this.options.event]}reset(){}}class pte extends dte{attrTest(e){const r=this.options.pointers;return r===0||e.pointers.length===r}process(e){const{state:r}=this,{eventType:n}=e,i=r&(Vi.Began|Vi.Changed),a=this.attrTest(e);return i&&(n&ml.Cancel||!a)?r|Vi.Cancelled:i||a?n&ml.End?r|Vi.Ended:r&Vi.Began?r|Vi.Changed:Vi.Began:Vi.Failed}}class Wq extends dte{constructor(e={}){super({enable:!0,event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10,...e}),this.pTime=null,this.pCenter=null,this._timer=null,this._input=null,this.count=0}getTouchAction(){return[ZM]}process(e){const{options:r}=this,n=e.pointers.length===r.pointers,i=e.distance<r.threshold,a=e.deltaTime<r.time;if(this.reset(),e.eventType&ml.Start&&this.count===0)return this.failTimeout();if(i&&a&&n){if(e.eventType!==ml.End)return this.failTimeout();const s=this.pTime?e.timeStamp-this.pTime<r.interval:!0,o=!this.pCenter||cte(this.pCenter,e.center)<r.posThreshold;if(this.pTime=e.timeStamp,this.pCenter=e.center,!o||!s?this.count=1:this.count+=1,this._input=e,this.count%r.taps===0)return this.hasRequireFailures()?(this._timer=setTimeout(()=>{this.state=Vi.Recognized,this.tryEmit(this._input)},r.interval),Vi.Began):Vi.Recognized}return Vi.Failed}failTimeout(){return this._timer=setTimeout(()=>{this.state=Vi.Failed},this.options.interval),Vi.Failed}reset(){clearTimeout(this._timer)}emit(e){this.state===Vi.Recognized&&(e.tapCount=this.count,this.manager.emit(this.options.event,e))}}const X9e=["","start","move","end","cancel","up","down","left","right"];class Gq extends pte{constructor(e={}){super({enable:!0,pointers:1,event:"pan",threshold:10,direction:kl.All,...e}),this.pX=null,this.pY=null}getTouchAction(){const{options:{direction:e}}=this,r=[];return e&kl.Horizontal&&r.push(JM),e&kl.Vertical&&r.push(KM),r}getEventNames(){return X9e.map(e=>this.options.event+e)}directionTest(e){const{options:r}=this;let n=!0,{distance:i}=e,{direction:a}=e;const s=e.deltaX,o=e.deltaY;return a&r.direction||(r.direction&kl.Horizontal?(a=s===0?kl.None:s<0?kl.Left:kl.Right,n=s!==this.pX,i=Math.abs(e.deltaX)):(a=o===0?kl.None:o<0?kl.Up:kl.Down,n=o!==this.pY,i=Math.abs(e.deltaY))),e.direction=a,n&&i>r.threshold&&!!(a&r.direction)}attrTest(e){return super.attrTest(e)&&(!!(this.state&Vi.Began)||!(this.state&Vi.Began)&&this.directionTest(e))}emit(e){this.pX=e.deltaX,this.pY=e.deltaY;const r=kl[e.direction].toLowerCase();r&&(e.additionalEvent=this.options.event+r),super.emit(e)}}const Y9e=["","start","move","end","cancel","in","out"];class Z9e extends pte{constructor(e={}){super({enable:!0,event:"pinch",threshold:0,pointers:2,...e})}getTouchAction(){return[Nw]}getEventNames(){return Y9e.map(e=>this.options.event+e)}attrTest(e){return super.attrTest(e)&&(Math.abs(e.scale-1)>this.options.threshold||!!(this.state&Vi.Began))}emit(e){if(e.scale!==1){const r=e.scale<1?"in":"out";e.additionalEvent=this.options.event+r}super.emit(e)}}class rC{constructor(e,r,n){this.element=e,this.callback=r,this.options=n}}const K9e=typeof navigator<"u"&&navigator.userAgent?navigator.userAgent.toLowerCase():"",J9e=K9e.indexOf("firefox")!==-1,Xq=4.000244140625,Q9e=40,eje=.25;class tje extends rC{constructor(e,r,n){super(e,r,{enable:!0,...n}),this.handleEvent=i=>{if(!this.options.enable)return;let a=i.deltaY;globalThis.WheelEvent&&(J9e&&i.deltaMode===globalThis.WheelEvent.DOM_DELTA_PIXEL&&(a/=globalThis.devicePixelRatio),i.deltaMode===globalThis.WheelEvent.DOM_DELTA_LINE&&(a*=Q9e)),a!==0&&a%Xq===0&&(a=Math.floor(a/Xq)),i.shiftKey&&a&&(a=a*eje),this.callback({type:"wheel",center:{x:i.clientX,y:i.clientY},delta:-a,srcEvent:i,pointerType:"mouse",target:i.target})},e.addEventListener("wheel",this.handleEvent,{passive:!1})}destroy(){this.element.removeEventListener("wheel",this.handleEvent)}enableEventType(e,r){e==="wheel"&&(this.options.enable=r)}}const Yq=["mousedown","mousemove","mouseup","mouseover","mouseout","mouseleave"];class rje extends rC{constructor(e,r,n){super(e,r,{enable:!0,...n}),this.handleEvent=a=>{this.handleOverEvent(a),this.handleOutEvent(a),this.handleEnterEvent(a),this.handleLeaveEvent(a),this.handleMoveEvent(a)},this.pressed=!1;const{enable:i}=this.options;this.enableMoveEvent=i,this.enableLeaveEvent=i,this.enableEnterEvent=i,this.enableOutEvent=i,this.enableOverEvent=i,Yq.forEach(a=>e.addEventListener(a,this.handleEvent))}destroy(){Yq.forEach(e=>this.element.removeEventListener(e,this.handleEvent))}enableEventType(e,r){switch(e){case"pointermove":this.enableMoveEvent=r;break;case"pointerover":this.enableOverEvent=r;break;case"pointerout":this.enableOutEvent=r;break;case"pointerenter":this.enableEnterEvent=r;break;case"pointerleave":this.enableLeaveEvent=r;break}}handleOverEvent(e){this.enableOverEvent&&e.type==="mouseover"&&this._emit("pointerover",e)}handleOutEvent(e){this.enableOutEvent&&e.type==="mouseout"&&this._emit("pointerout",e)}handleEnterEvent(e){this.enableEnterEvent&&e.type==="mouseenter"&&this._emit("pointerenter",e)}handleLeaveEvent(e){this.enableLeaveEvent&&e.type==="mouseleave"&&this._emit("pointerleave",e)}handleMoveEvent(e){if(this.enableMoveEvent)switch(e.type){case"mousedown":e.button>=0&&(this.pressed=!0);break;case"mousemove":e.buttons===0&&(this.pressed=!1),this.pressed||this._emit("pointermove",e);break;case"mouseup":this.pressed=!1;break}}_emit(e,r){this.callback({type:e,center:{x:r.clientX,y:r.clientY},srcEvent:r,pointerType:"mouse",target:r.target})}}const Zq=["keydown","keyup"];class nje extends rC{constructor(e,r,n){super(e,r,{enable:!0,tabIndex:0,...n}),this.handleEvent=i=>{const a=i.target||i.srcElement;a.tagName==="INPUT"&&a.type==="text"||a.tagName==="TEXTAREA"||(this.enableDownEvent&&i.type==="keydown"&&this.callback({type:"keydown",srcEvent:i,key:i.key,target:i.target}),this.enableUpEvent&&i.type==="keyup"&&this.callback({type:"keyup",srcEvent:i,key:i.key,target:i.target}))},this.enableDownEvent=this.options.enable,this.enableUpEvent=this.options.enable,e.tabIndex=this.options.tabIndex,e.style.outline="none",Zq.forEach(i=>e.addEventListener(i,this.handleEvent))}destroy(){Zq.forEach(e=>this.element.removeEventListener(e,this.handleEvent))}enableEventType(e,r){e==="keydown"&&(this.enableDownEvent=r),e==="keyup"&&(this.enableUpEvent=r)}}class ije extends rC{constructor(e,r,n){super(e,r,n),this.handleEvent=i=>{this.options.enable&&this.callback({type:"contextmenu",center:{x:i.clientX,y:i.clientY},srcEvent:i,pointerType:"mouse",target:i.target})},e.addEventListener("contextmenu",this.handleEvent)}destroy(){this.element.removeEventListener("contextmenu",this.handleEvent)}enableEventType(e,r){e==="contextmenu"&&(this.options.enable=r)}}const Kq=1,QM=2,Jq=4,aje={pointerdown:Kq,pointermove:QM,pointerup:Jq,mousedown:Kq,mousemove:QM,mouseup:Jq},oje=0,sje=1,lje=2,uje=1,cje=2,hje=4;function fje(t){const e=aje[t.srcEvent.type];if(!e)return null;const{buttons:r,button:n}=t.srcEvent;let i=!1,a=!1,s=!1;return e===QM?(i=!!(r&uje),a=!!(r&hje),s=!!(r&cje)):(i=n===oje,a=n===sje,s=n===lje),{leftButton:i,middleButton:a,rightButton:s}}function dje(t,e){const r=t.center;if(!r)return null;const n=e.getBoundingClientRect(),i=n.width/e.offsetWidth||1,a=n.height/e.offsetHeight||1,s={x:(r.x-n.left-e.clientLeft)/i,y:(r.y-n.top-e.clientTop)/a};return{center:r,offsetCenter:s}}const pje={srcElement:"root",priority:0};class gje{constructor(e,r){this.handleEvent=n=>{if(this.isEmpty())return;const i=this._normalizeEvent(n);let a=n.srcEvent.target;for(;a&&a!==i.rootElement;){if(this._emit(i,a),i.handled)return;a=a.parentNode}this._emit(i,"root")},this.eventManager=e,this.recognizerName=r,this.handlers=[],this.handlersByElement=new Map,this._active=!1}isEmpty(){return!this._active}add(e,r,n,i=!1,a=!1){const{handlers:s,handlersByElement:o}=this,u={...pje,...n};let h=o.get(u.srcElement);h||(h=[],o.set(u.srcElement,h));const f={type:e,handler:r,srcElement:u.srcElement,priority:u.priority};i&&(f.once=!0),a&&(f.passive=!0),s.push(f),this._active=this._active||!f.passive;let g=h.length-1;for(;g>=0&&!(h[g].priority>=f.priority);)g--;h.splice(g+1,0,f)}remove(e,r){const{handlers:n,handlersByElement:i}=this;for(let a=n.length-1;a>=0;a--){const s=n[a];if(s.type===e&&s.handler===r){n.splice(a,1);const o=i.get(s.srcElement);o.splice(o.indexOf(s),1),o.length===0&&i.delete(s.srcElement)}}this._active=n.some(a=>!a.passive)}_emit(e,r){const n=this.handlersByElement.get(r);if(n){let i=!1;const a=()=>{e.handled=!0},s=()=>{e.handled=!0,i=!0},o=[];for(let u=0;u<n.length;u++){const{type:h,handler:f,once:g}=n[u];if(f({...e,type:h,stopPropagation:a,stopImmediatePropagation:s}),g&&o.push(n[u]),i)break}for(let u=0;u<o.length;u++){const{type:h,handler:f}=o[u];this.remove(h,f)}}}_normalizeEvent(e){const r=this.eventManager.getElement();return{...e,...fje(e),...dje(e,r),preventDefault:()=>{e.srcEvent.preventDefault()},stopImmediatePropagation:null,stopPropagation:null,handled:!1,rootElement:r}}}function mje(t){if("recognizer"in t)return t;let e;const r=Array.isArray(t)?[...t]:[t];if(typeof r[0]=="function"){const n=r.shift(),i=r.shift()||{};e=new n(i)}else e=r.shift();return{recognizer:e,recognizeWith:typeof r[0]=="string"?[r[0]]:r[0],requireFailure:typeof r[1]=="string"?[r[1]]:r[1]}}class yje{constructor(e=null,r={}){if(this._onBasicInput=n=>{this.manager.emit(n.srcEvent.type,n)},this._onOtherEvent=n=>{this.manager.emit(n.type,n)},this.options={recognizers:[],events:{},touchAction:"compute",tabIndex:0,cssProps:{},...r},this.events=new Map,this.element=e,!!e){this.manager=new H9e(e,this.options);for(const n of this.options.recognizers){const{recognizer:i,recognizeWith:a,requireFailure:s}=mje(n);this.manager.add(i),a&&i.recognizeWith(a),s&&i.requireFailure(s)}this.manager.on("hammer.input",this._onBasicInput),this.wheelInput=new tje(e,this._onOtherEvent,{enable:!1}),this.moveInput=new rje(e,this._onOtherEvent,{enable:!1}),this.keyInput=new nje(e,this._onOtherEvent,{enable:!1,tabIndex:r.tabIndex}),this.contextmenuInput=new ije(e,this._onOtherEvent,{enable:!1}),this.on(this.options.events)}}getElement(){return this.element}destroy(){this.element&&(this.wheelInput.destroy(),this.moveInput.destroy(),this.keyInput.destroy(),this.contextmenuInput.destroy(),this.manager.destroy())}on(e,r,n){this._addEventHandler(e,r,n,!1)}once(e,r,n){this._addEventHandler(e,r,n,!0)}watch(e,r,n){this._addEventHandler(e,r,n,!1,!0)}off(e,r){this._removeEventHandler(e,r)}_toggleRecognizer(e,r){const{manager:n}=this;if(!n)return;const i=n.get(e);i&&(i.set({enable:r}),n.touchAction.update()),this.wheelInput?.enableEventType(e,r),this.moveInput?.enableEventType(e,r),this.keyInput?.enableEventType(e,r),this.contextmenuInput?.enableEventType(e,r)}_addEventHandler(e,r,n,i,a){if(typeof e!="string"){n=r;for(const[h,f]of Object.entries(e))this._addEventHandler(h,f,n,i,a);return}const{manager:s,events:o}=this;if(!s)return;let u=o.get(e);if(!u){const h=this._getRecognizerName(e)||e;u=new gje(this,h),o.set(e,u),s&&s.on(e,u.handleEvent)}u.add(e,r,n,i,a),u.isEmpty()||this._toggleRecognizer(u.recognizerName,!0)}_removeEventHandler(e,r){if(typeof e!="string"){for(const[a,s]of Object.entries(e))this._removeEventHandler(a,s);return}const{events:n}=this,i=n.get(e);if(i&&(i.remove(e,r),i.isEmpty())){const{recognizerName:a}=i;let s=!1;for(const o of n.values())if(o.recognizerName===a&&!o.isEmpty()){s=!0;break}s||this._toggleRecognizer(a,!1)}}_getRecognizerName(e){return this.manager.recognizers.find(r=>r.getEventNames().includes(e))?.options.event}}const qa={DEFAULT:-1,LNGLAT:1,METER_OFFSETS:2,LNGLAT_OFFSETS:3,CARTESIAN:0};Object.defineProperty(qa,"IDENTITY",{get:()=>(Za.deprecated("COORDINATE_SYSTEM.IDENTITY","COORDINATE_SYSTEM.CARTESIAN")(),0)});const Jc={WEB_MERCATOR:1,GLOBE:2,WEB_MERCATOR_AUTO_OFFSET:4,IDENTITY:0},S0={common:0,meters:1,pixels:2},eR={click:"onClick",dblclick:"onClick",panstart:"onDragStart",panmove:"onDrag",panend:"onDragEnd"},Qq={multipan:[Gq,{threshold:10,direction:kl.Vertical,pointers:2}],pinch:[Z9e,{},null,["multipan"]],pan:[Gq,{threshold:1},["pinch"],["multipan"]],dblclick:[Wq,{event:"dblclick",taps:2}],click:[Wq,{event:"click"},null,["dblclick"]]};function vje(t,e){if(t===e)return!0;if(Array.isArray(t)){const r=t.length;if(!e||e.length!==r)return!1;for(let n=0;n<r;n++)if(t[n]!==e[n])return!1;return!0}return!1}function _x(t){let e={},r;return n=>{for(const i in n)if(!vje(n[i],e[i])){r=t(n),e=n;break}return r}}const eH=[0,0,0,0],_je=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0],gte=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],bje=[0,0,0],mte=[0,0,0],xje=_x(Eje);function yte(t,e,r=mte){r.length<3&&(r=[r[0],r[1],0]);let n=r,i,a=!0;switch(e===qa.LNGLAT_OFFSETS||e===qa.METER_OFFSETS?i=r:i=t.isGeospatial?[Math.fround(t.longitude),Math.fround(t.latitude),0]:null,t.projectionMode){case Jc.WEB_MERCATOR:(e===qa.LNGLAT||e===qa.CARTESIAN)&&(i=[0,0,0],a=!1);break;case Jc.WEB_MERCATOR_AUTO_OFFSET:e===qa.LNGLAT?n=i:e===qa.CARTESIAN&&(n=[Math.fround(t.center[0]),Math.fround(t.center[1]),0],i=t.unprojectPosition(n),n[0]-=r[0],n[1]-=r[1],n[2]-=r[2]);break;case Jc.IDENTITY:n=t.position.map(Math.fround),n[2]=n[2]||0;break;case Jc.GLOBE:a=!1,i=null;break;default:a=!1}return{geospatialOrigin:i,shaderCoordinateOrigin:n,offsetMode:a}}function wje(t,e,r){const{viewMatrixUncentered:n,projectionMatrix:i}=t;let{viewMatrix:a,viewProjectionMatrix:s}=t,o=eH,u=eH,h=t.cameraPosition;const{geospatialOrigin:f,shaderCoordinateOrigin:g,offsetMode:b}=yte(t,e,r);return b&&(u=t.projectPosition(f||g),h=[h[0]-u[0],h[1]-u[1],h[2]-u[2]],u[3]=1,o=G0([],u,s),a=n||a,s=hm([],i,a),s=hm([],s,_je)),{viewMatrix:a,viewProjectionMatrix:s,projectionCenter:o,originCommon:u,cameraPosCommon:h,shaderCoordinateOrigin:g,geospatialOrigin:f}}function Sje({viewport:t,devicePixelRatio:e=1,modelMatrix:r=null,coordinateSystem:n=qa.DEFAULT,coordinateOrigin:i=mte,autoWrapLongitude:a=!1}){n===qa.DEFAULT&&(n=t.isGeospatial?qa.LNGLAT:qa.CARTESIAN);const s=xje({viewport:t,devicePixelRatio:e,coordinateSystem:n,coordinateOrigin:i});return s.wrapLongitude=a,s.modelMatrix=r||gte,s}function Eje({viewport:t,devicePixelRatio:e,coordinateSystem:r,coordinateOrigin:n}){const{projectionCenter:i,viewProjectionMatrix:a,originCommon:s,cameraPosCommon:o,shaderCoordinateOrigin:u,geospatialOrigin:h}=wje(t,r,n),f=t.getDistanceScales(),g=[t.width*e,t.height*e],b=G0([],[0,0,-t.focalDistance,1],t.projectionMatrix)[3]||1,v={coordinateSystem:r,projectionMode:t.projectionMode,coordinateOrigin:u,commonOrigin:s.slice(0,3),center:i,pseudoMeters:!!t._pseudoMeters,viewportSize:g,devicePixelRatio:e,focalDistance:b,commonUnitsPerMeter:f.unitsPerMeter,commonUnitsPerWorldUnit:f.unitsPerMeter,commonUnitsPerWorldUnit2:bje,scale:t.scale,wrapLongitude:!1,viewProjectionMatrix:a,modelMatrix:gte,cameraPosition:o};if(h){const S=t.getDistanceScales(h);switch(r){case qa.METER_OFFSETS:v.commonUnitsPerWorldUnit=S.unitsPerMeter,v.commonUnitsPerWorldUnit2=S.unitsPerMeter2;break;case qa.LNGLAT:case qa.LNGLAT_OFFSETS:t._pseudoMeters||(v.commonUnitsPerMeter=S.unitsPerMeter),v.commonUnitsPerWorldUnit=S.unitsPerDegree,v.commonUnitsPerWorldUnit2=S.unitsPerDegree2;break;case qa.CARTESIAN:v.commonUnitsPerWorldUnit=[1,1,S.unitsPerMeter[2]],v.commonUnitsPerWorldUnit2=[0,0,S.unitsPerMeter2[2]];break}}return v}const Tje=Object.keys(qa).map(t=>`const COORDINATE_SYSTEM_${t}: i32 = ${qa[t]};`).join(""),Cje=Object.keys(Jc).map(t=>`const PROJECTION_MODE_${t}: i32 = ${Jc[t]};`).join(""),Aje=Object.keys(S0).map(t=>`const UNIT_${t.toUpperCase()}: i32 = ${S0[t]};`).join(""),Ije=`${Tje}
${Cje}
${Aje}

const TILE_SIZE: f32 = 512.0;
const PI: f32 = 3.1415926536;
const WORLD_SCALE: f32 = TILE_SIZE / (PI * 2.0);
const ZERO_64_LOW: vec3<f32> = vec3<f32>(0.0, 0.0, 0.0);
const EARTH_RADIUS: f32 = 6370972.0; // meters
const GLOBE_RADIUS: f32 = 256.0;

// -----------------------------------------------------------------------------
// Uniform block (converted from GLSL uniform block)
// -----------------------------------------------------------------------------
struct ProjectUniforms {
  wrapLongitude: i32,
  coordinateSystem: i32,
  commonUnitsPerMeter: vec3<f32>,
  projectionMode: i32,
  scale: f32,
  commonUnitsPerWorldUnit: vec3<f32>,
  commonUnitsPerWorldUnit2: vec3<f32>,
  center: vec4<f32>,
  modelMatrix: mat4x4<f32>,
  viewProjectionMatrix: mat4x4<f32>,
  viewportSize: vec2<f32>,
  devicePixelRatio: f32,
  focalDistance: f32,
  cameraPosition: vec3<f32>,
  coordinateOrigin: vec3<f32>,
  commonOrigin: vec3<f32>,
  pseudoMeters: i32,
};

@group(0) @binding(0)
var<uniform> project: ProjectUniforms;

// -----------------------------------------------------------------------------
// Geometry data
// (In your GLSL code, "geometry" was assumed to be available globally. In WGSL,
// you might supply this via vertex attributes or a uniform. Here we define a
// uniform struct for demonstration.)
// -----------------------------------------------------------------------------

// Structure to carry additional geometry data used by deck.gl filters.
struct Geometry {
  worldPosition: vec3<f32>,
  worldPositionAlt: vec3<f32>,
  position: vec4<f32>,
  uv: vec2<f32>,
  pickingColor: vec3<f32>,
};

// @group(0) @binding(1)
var<private> geometry: Geometry;
`,Pje=`${Ije}

// -----------------------------------------------------------------------------
// Functions
// -----------------------------------------------------------------------------

// Returns an adjustment factor for commonUnitsPerMeter
fn _project_size_at_latitude(lat: f32) -> f32 {
  let y = clamp(lat, -89.9, 89.9);
  return 1.0 / cos(radians(y));
}

// Overloaded version: scales a value in meters at a given latitude.
fn _project_size_at_latitude_m(meters: f32, lat: f32) -> f32 {
  return meters * project.commonUnitsPerMeter.z * _project_size_at_latitude(lat);
}

// Computes a non-linear scale factor based on geometry.
// (Note: This function relies on "geometry" being provided.)
fn project_size() -> f32 {
  if (project.projectionMode == PROJECTION_MODE_WEB_MERCATOR &&
      project.coordinateSystem == COORDINATE_SYSTEM_LNGLAT &&
      project.pseudoMeters == 0) {
    if (geometry.position.w == 0.0) {
      return _project_size_at_latitude(geometry.worldPosition.y);
    }
    let y: f32 = geometry.position.y / TILE_SIZE * 2.0 - 1.0;
    let y2 = y * y;
    let y4 = y2 * y2;
    let y6 = y4 * y2;
    return 1.0 + 4.9348 * y2 + 4.0587 * y4 + 1.5642 * y6;
  }
  return 1.0;
}

// Overloads to scale offsets (meters to world units)
fn project_size_float(meters: f32) -> f32 {
  return meters * project.commonUnitsPerMeter.z * project_size();
}

fn project_size_vec2(meters: vec2<f32>) -> vec2<f32> {
  return meters * project.commonUnitsPerMeter.xy * project_size();
}

fn project_size_vec3(meters: vec3<f32>) -> vec3<f32> {
  return meters * project.commonUnitsPerMeter * project_size();
}

fn project_size_vec4(meters: vec4<f32>) -> vec4<f32> {
  return vec4<f32>(meters.xyz * project.commonUnitsPerMeter, meters.w);
}

// Returns a rotation matrix aligning the zaxis with the given up vector.
fn project_get_orientation_matrix(up: vec3<f32>) -> mat3x3<f32> {
  let uz = normalize(up);
  let ux = select(
    vec3<f32>(1.0, 0.0, 0.0),
    normalize(vec3<f32>(uz.y, -uz.x, 0.0)),
    abs(uz.z) == 1.0
  );
  let uy = cross(uz, ux);
  return mat3x3<f32>(ux, uy, uz);
}

// Since WGSL does not support "out" parameters, we return a struct.
struct RotationResult {
  needsRotation: bool,
  transform: mat3x3<f32>,
};

fn project_needs_rotation(commonPosition: vec3<f32>) -> RotationResult {
  if (project.projectionMode == PROJECTION_MODE_GLOBE) {
    return RotationResult(true, project_get_orientation_matrix(commonPosition));
  } else {
    return RotationResult(false, mat3x3<f32>());  // identity alternative if needed
  };
}

// Projects a normal vector from the current coordinate system to world space.
fn project_normal(vector: vec3<f32>) -> vec3<f32> {
  let normal_modelspace = project.modelMatrix * vec4<f32>(vector, 0.0);
  var n = normalize(normal_modelspace.xyz * project.commonUnitsPerMeter);
  let rotResult = project_needs_rotation(geometry.position.xyz);
  if (rotResult.needsRotation) {
    n = rotResult.transform * n;
  }
  return n;
}

// Applies a scale offset based on y-offset (dy)
fn project_offset_(offset: vec4<f32>) -> vec4<f32> {
  let dy: f32 = offset.y;
  let commonUnitsPerWorldUnit = project.commonUnitsPerWorldUnit + project.commonUnitsPerWorldUnit2 * dy;
  return vec4<f32>(offset.xyz * commonUnitsPerWorldUnit, offset.w);
}

// Projects lng/lat coordinates to a unit tile [0,1]
fn project_mercator_(lnglat: vec2<f32>) -> vec2<f32> {
  var x = lnglat.x;
  if (project.wrapLongitude != 0) {
    x = ((x + 180.0) % 360.0) - 180.0;
  }
  let y = clamp(lnglat.y, -89.9, 89.9);
  return vec2<f32>(
    radians(x) + PI,
    PI + log(tan(PI * 0.25 + radians(y) * 0.5))
  ) * WORLD_SCALE;
}

// Projects lng/lat/z coordinates for a globe projection.
fn project_globe_(lnglatz: vec3<f32>) -> vec3<f32> {
  let lambda = radians(lnglatz.x);
  let phi = radians(lnglatz.y);
  let cosPhi = cos(phi);
  let D = (lnglatz.z / EARTH_RADIUS + 1.0) * GLOBE_RADIUS;
  return vec3<f32>(
    sin(lambda) * cosPhi,
    -cos(lambda) * cosPhi,
    sin(phi)
  ) * D;
}

// Projects positions (with an optional 64-bit low part) from the input
// coordinate system to the common space.
fn project_position_vec4_f64(position: vec4<f32>, position64Low: vec3<f32>) -> vec4<f32> {
  var position_world = project.modelMatrix * position;

  // Work around for a Mac+NVIDIA bug:
  if (project.projectionMode == PROJECTION_MODE_WEB_MERCATOR) {
    if (project.coordinateSystem == COORDINATE_SYSTEM_LNGLAT) {
      return vec4<f32>(
        project_mercator_(position_world.xy),
        _project_size_at_latitude_m(position_world.z, position_world.y),
        position_world.w
      );
    }
    if (project.coordinateSystem == COORDINATE_SYSTEM_CARTESIAN) {
      position_world = vec4f(position_world.xyz + project.coordinateOrigin, position_world.w);
    }
  }
  if (project.projectionMode == PROJECTION_MODE_GLOBE) {
    if (project.coordinateSystem == COORDINATE_SYSTEM_LNGLAT) {
      return vec4<f32>(
        project_globe_(position_world.xyz),
        position_world.w
      );
    }
  }
  if (project.projectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET) {
    if (project.coordinateSystem == COORDINATE_SYSTEM_LNGLAT) {
      if (abs(position_world.y - project.coordinateOrigin.y) > 0.25) {
        return vec4<f32>(
          project_mercator_(position_world.xy) - project.commonOrigin.xy,
          project_size_float(position_world.z),
          position_world.w
        );
      }
    }
  }
  if (project.projectionMode == PROJECTION_MODE_IDENTITY ||
      (project.projectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET &&
       (project.coordinateSystem == COORDINATE_SYSTEM_LNGLAT ||
        project.coordinateSystem == COORDINATE_SYSTEM_CARTESIAN))) {
    position_world = vec4f(position_world.xyz - project.coordinateOrigin, position_world.w);
  }

  return project_offset_(position_world) +
         project_offset_(project.modelMatrix * vec4<f32>(position64Low, 0.0));
}

// Overloaded versions for different input types.
fn project_position_vec4_f32(position: vec4<f32>) -> vec4<f32> {
  return project_position_vec4_f64(position, ZERO_64_LOW);
}

fn project_position_vec3_f64(position: vec3<f32>, position64Low: vec3<f32>) -> vec3<f32> {
  let projected_position = project_position_vec4_f64(vec4<f32>(position, 1.0), position64Low);
  return projected_position.xyz;
}

fn project_position_vec3_f32(position: vec3<f32>) -> vec3<f32> {
  let projected_position = project_position_vec4_f64(vec4<f32>(position, 1.0), ZERO_64_LOW);
  return projected_position.xyz;
}

fn project_position_vec2_f32(position: vec2<f32>) -> vec2<f32> {
  let projected_position = project_position_vec4_f64(vec4<f32>(position, 0.0, 1.0), ZERO_64_LOW);
  return projected_position.xy;
}

// Transforms a common space position to clip space.
fn project_common_position_to_clipspace_with_projection(position: vec4<f32>, viewProjectionMatrix: mat4x4<f32>, center: vec4<f32>) -> vec4<f32> {
  return viewProjectionMatrix * position + center;
}

// Uses the project viewProjectionMatrix and center.
fn project_common_position_to_clipspace(position: vec4<f32>) -> vec4<f32> {
  return project_common_position_to_clipspace_with_projection(position, project.viewProjectionMatrix, project.center);
}

// Returns a clip space offset corresponding to a given number of screen pixels.
fn project_pixel_size_to_clipspace(pixels: vec2<f32>) -> vec2<f32> {
  let offset = pixels / project.viewportSize * project.devicePixelRatio * 2.0;
  return offset * project.focalDistance;
}

fn project_meter_size_to_pixel(meters: f32) -> f32 {
  return project_size_float(meters) * project.scale;
}

fn project_unit_size_to_pixel(size: f32, unit: i32) -> f32 {
  if (unit == UNIT_METERS) {
    return project_meter_size_to_pixel(size);
  } else if (unit == UNIT_COMMON) {
    return size * project.scale;
  }
  // UNIT_PIXELS: no scaling applied.
  return size;
}

fn project_pixel_size_float(pixels: f32) -> f32 {
  return pixels / project.scale;
}

fn project_pixel_size_vec2(pixels: vec2<f32>) -> vec2<f32> {
  return pixels / project.scale;
}
`,kje=Object.keys(qa).map(t=>`const int COORDINATE_SYSTEM_${t} = ${qa[t]};`).join(""),Mje=Object.keys(Jc).map(t=>`const int PROJECTION_MODE_${t} = ${Jc[t]};`).join(""),Rje=Object.keys(S0).map(t=>`const int UNIT_${t.toUpperCase()} = ${S0[t]};`).join(""),Oje=`${kje}
${Mje}
${Rje}
uniform projectUniforms {
bool wrapLongitude;
int coordinateSystem;
vec3 commonUnitsPerMeter;
int projectionMode;
float scale;
vec3 commonUnitsPerWorldUnit;
vec3 commonUnitsPerWorldUnit2;
vec4 center;
mat4 modelMatrix;
mat4 viewProjectionMatrix;
vec2 viewportSize;
float devicePixelRatio;
float focalDistance;
vec3 cameraPosition;
vec3 coordinateOrigin;
vec3 commonOrigin;
bool pseudoMeters;
} project;
const float TILE_SIZE = 512.0;
const float PI = 3.1415926536;
const float WORLD_SCALE = TILE_SIZE / (PI * 2.0);
const vec3 ZERO_64_LOW = vec3(0.0);
const float EARTH_RADIUS = 6370972.0;
const float GLOBE_RADIUS = 256.0;
float project_size_at_latitude(float lat) {
float y = clamp(lat, -89.9, 89.9);
return 1.0 / cos(radians(y));
}
float project_size() {
if (project.projectionMode == PROJECTION_MODE_WEB_MERCATOR &&
project.coordinateSystem == COORDINATE_SYSTEM_LNGLAT &&
project.pseudoMeters == false) {
if (geometry.position.w == 0.0) {
return project_size_at_latitude(geometry.worldPosition.y);
}
float y = geometry.position.y / TILE_SIZE * 2.0 - 1.0;
float y2 = y * y;
float y4 = y2 * y2;
float y6 = y4 * y2;
return 1.0 + 4.9348 * y2 + 4.0587 * y4 + 1.5642 * y6;
}
return 1.0;
}
float project_size_at_latitude(float meters, float lat) {
return meters * project.commonUnitsPerMeter.z * project_size_at_latitude(lat);
}
float project_size(float meters) {
return meters * project.commonUnitsPerMeter.z * project_size();
}
vec2 project_size(vec2 meters) {
return meters * project.commonUnitsPerMeter.xy * project_size();
}
vec3 project_size(vec3 meters) {
return meters * project.commonUnitsPerMeter * project_size();
}
vec4 project_size(vec4 meters) {
return vec4(meters.xyz * project.commonUnitsPerMeter, meters.w);
}
mat3 project_get_orientation_matrix(vec3 up) {
vec3 uz = normalize(up);
vec3 ux = abs(uz.z) == 1.0 ? vec3(1.0, 0.0, 0.0) : normalize(vec3(uz.y, -uz.x, 0));
vec3 uy = cross(uz, ux);
return mat3(ux, uy, uz);
}
bool project_needs_rotation(vec3 commonPosition, out mat3 transform) {
if (project.projectionMode == PROJECTION_MODE_GLOBE) {
transform = project_get_orientation_matrix(commonPosition);
return true;
}
return false;
}
vec3 project_normal(vec3 vector) {
vec4 normal_modelspace = project.modelMatrix * vec4(vector, 0.0);
vec3 n = normalize(normal_modelspace.xyz * project.commonUnitsPerMeter);
mat3 rotation;
if (project_needs_rotation(geometry.position.xyz, rotation)) {
n = rotation * n;
}
return n;
}
vec4 project_offset_(vec4 offset) {
float dy = offset.y;
vec3 commonUnitsPerWorldUnit = project.commonUnitsPerWorldUnit + project.commonUnitsPerWorldUnit2 * dy;
return vec4(offset.xyz * commonUnitsPerWorldUnit, offset.w);
}
vec2 project_mercator_(vec2 lnglat) {
float x = lnglat.x;
if (project.wrapLongitude) {
x = mod(x + 180., 360.0) - 180.;
}
float y = clamp(lnglat.y, -89.9, 89.9);
return vec2(
radians(x) + PI,
PI + log(tan_fp32(PI * 0.25 + radians(y) * 0.5))
) * WORLD_SCALE;
}
vec3 project_globe_(vec3 lnglatz) {
float lambda = radians(lnglatz.x);
float phi = radians(lnglatz.y);
float cosPhi = cos(phi);
float D = (lnglatz.z / EARTH_RADIUS + 1.0) * GLOBE_RADIUS;
return vec3(
sin(lambda) * cosPhi,
-cos(lambda) * cosPhi,
sin(phi)
) * D;
}
vec4 project_position(vec4 position, vec3 position64Low) {
vec4 position_world = project.modelMatrix * position;
if (project.projectionMode == PROJECTION_MODE_WEB_MERCATOR) {
if (project.coordinateSystem == COORDINATE_SYSTEM_LNGLAT) {
return vec4(
project_mercator_(position_world.xy),
project_size_at_latitude(position_world.z, position_world.y),
position_world.w
);
}
if (project.coordinateSystem == COORDINATE_SYSTEM_CARTESIAN) {
position_world.xyz += project.coordinateOrigin;
}
}
if (project.projectionMode == PROJECTION_MODE_GLOBE) {
if (project.coordinateSystem == COORDINATE_SYSTEM_LNGLAT) {
return vec4(
project_globe_(position_world.xyz),
position_world.w
);
}
}
if (project.projectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET) {
if (project.coordinateSystem == COORDINATE_SYSTEM_LNGLAT) {
if (abs(position_world.y - project.coordinateOrigin.y) > 0.25) {
return vec4(
project_mercator_(position_world.xy) - project.commonOrigin.xy,
project_size(position_world.z),
position_world.w
);
}
}
}
if (project.projectionMode == PROJECTION_MODE_IDENTITY ||
(project.projectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET &&
(project.coordinateSystem == COORDINATE_SYSTEM_LNGLAT ||
project.coordinateSystem == COORDINATE_SYSTEM_CARTESIAN))) {
position_world.xyz -= project.coordinateOrigin;
}
return project_offset_(position_world) + project_offset_(project.modelMatrix * vec4(position64Low, 0.0));
}
vec4 project_position(vec4 position) {
return project_position(position, ZERO_64_LOW);
}
vec3 project_position(vec3 position, vec3 position64Low) {
vec4 projected_position = project_position(vec4(position, 1.0), position64Low);
return projected_position.xyz;
}
vec3 project_position(vec3 position) {
vec4 projected_position = project_position(vec4(position, 1.0), ZERO_64_LOW);
return projected_position.xyz;
}
vec2 project_position(vec2 position) {
vec4 projected_position = project_position(vec4(position, 0.0, 1.0), ZERO_64_LOW);
return projected_position.xy;
}
vec4 project_common_position_to_clipspace(vec4 position, mat4 viewProjectionMatrix, vec4 center) {
return viewProjectionMatrix * position + center;
}
vec4 project_common_position_to_clipspace(vec4 position) {
return project_common_position_to_clipspace(position, project.viewProjectionMatrix, project.center);
}
vec2 project_pixel_size_to_clipspace(vec2 pixels) {
vec2 offset = pixels / project.viewportSize * project.devicePixelRatio * 2.0;
return offset * project.focalDistance;
}
float project_size_to_pixel(float meters) {
return project_size(meters) * project.scale;
}
float project_size_to_pixel(float size, int unit) {
if (unit == UNIT_METERS) return project_size_to_pixel(size);
if (unit == UNIT_COMMON) return size * project.scale;
return size;
}
float project_pixel_size(float pixels) {
return pixels / project.scale;
}
vec2 project_pixel_size(vec2 pixels) {
return pixels / project.scale;
}
`,Lje={};function Nje(t=Lje){return"viewport"in t?Sje(t):{}}const GN={name:"project",dependencies:[s9e,lte],source:Pje,vs:Oje,getUniforms:Nje,uniformTypes:{wrapLongitude:"f32",coordinateSystem:"i32",commonUnitsPerMeter:"vec3<f32>",projectionMode:"i32",scale:"f32",commonUnitsPerWorldUnit:"vec3<f32>",commonUnitsPerWorldUnit2:"vec3<f32>",center:"vec4<f32>",modelMatrix:"mat4x4<f32>",viewProjectionMatrix:"mat4x4<f32>",viewportSize:"vec2<f32>",devicePixelRatio:"f32",focalDistance:"f32",cameraPosition:"vec3<f32>",coordinateOrigin:"vec3<f32>",commonOrigin:"vec3<f32>",pseudoMeters:"f32"}},Dje=`// Define a structure to hold both the clip-space position and the common position.
struct ProjectResult {
  clipPosition: vec4<f32>,
  commonPosition: vec4<f32>,
};

// This function mimics the GLSL version with the 'out' parameter by returning both values.
fn project_position_to_clipspace_and_commonspace(
    position: vec3<f32>,
    position64Low: vec3<f32>,
    offset: vec3<f32>
) -> ProjectResult {
  // Compute the projected position.
  let projectedPosition: vec3<f32> = project_position_vec3_f64(position, position64Low);

  // Start with the provided offset.
  var finalOffset: vec3<f32> = offset;

  // Get whether a rotation is needed and the rotation matrix.
  let rotationResult = project_needs_rotation(projectedPosition);

  // If rotation is needed, update the offset.
  if (rotationResult.needsRotation) {
    finalOffset = rotationResult.transform * offset;
  }

  // Compute the common position.
  let commonPosition: vec4<f32> = vec4<f32>(projectedPosition + finalOffset, 1.0);

  // Convert to clip-space.
  let clipPosition: vec4<f32> = project_common_position_to_clipspace(commonPosition);

  return ProjectResult(clipPosition, commonPosition);
}

// A convenience overload that returns only the clip-space position.
fn project_position_to_clipspace(
    position: vec3<f32>,
    position64Low: vec3<f32>,
    offset: vec3<f32>
) -> vec4<f32> {
  return project_position_to_clipspace_and_commonspace(position, position64Low, offset).clipPosition;
}
`,Fje=`vec4 project_position_to_clipspace(
  vec3 position, vec3 position64Low, vec3 offset, out vec4 commonPosition
) {
  vec3 projectedPosition = project_position(position, position64Low);
  mat3 rotation;
  if (project_needs_rotation(projectedPosition, rotation)) {
    // offset is specified as ENU
    // when in globe projection, rotate offset so that the ground alighs with the surface of the globe
    offset = rotation * offset;
  }
  commonPosition = vec4(projectedPosition + offset, 1.0);
  return project_common_position_to_clipspace(commonPosition);
}

vec4 project_position_to_clipspace(
  vec3 position, vec3 position64Low, vec3 offset
) {
  vec4 commonPosition;
  return project_position_to_clipspace(position, position64Low, offset, commonPosition);
}
`,vte={name:"project32",dependencies:[GN],source:Dje,vs:Fje};function Bje(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function Yv(t,e){const r=G0([],e,t);return Qee(r,r,1/r[3]),r}function tH(t,e){const r=t%e;return r<0?e+r:r}function tR(t,e,r){return t<e?e:t>r?r:t}function zje(t){return Math.log(t)*Math.LOG2E}const XN=Math.log2||zje;function Qd(t,e){if(!t)throw new Error(e||"@math.gl/web-mercator: assertion failed.")}const rf=Math.PI,_te=rf/4,Eh=rf/180,rR=180/rf,E0=512,xE=4003e4,jp=85.051129,jje=1.5;function Uje(t){return XN(t)}function Pb(t){const[e,r]=t;Qd(Number.isFinite(e)),Qd(Number.isFinite(r)&&r>=-90&&r<=90,"invalid latitude");const n=e*Eh,i=r*Eh,a=E0*(n+rf)/(2*rf),s=E0*(rf+Math.log(Math.tan(_te+i*.5)))/(2*rf);return[a,s]}function T0(t){const[e,r]=t,n=e/E0*(2*rf)-rf,i=2*(Math.atan(Math.exp(r/E0*(2*rf)-rf))-_te);return[n*rR,i*rR]}function Vje(t){const{latitude:e}=t;Qd(Number.isFinite(e));const r=Math.cos(e*Eh);return Uje(xE*r)-9}function Dw(t){const e=Math.cos(t*Eh);return E0/xE/e}function nR(t){const{latitude:e,longitude:r,highPrecision:n=!1}=t;Qd(Number.isFinite(e)&&Number.isFinite(r));const i=E0,a=Math.cos(e*Eh),s=i/360,o=s/a,u=i/xE/a,h={unitsPerMeter:[u,u,u],metersPerUnit:[1/u,1/u,1/u],unitsPerDegree:[s,o,u],degreesPerUnit:[1/s,1/o,1/u]};if(n){const f=Eh*Math.tan(e*Eh)/a,g=s*f/2,b=i/xE*f,v=b/o*u;h.unitsPerDegree2=[0,g,b],h.unitsPerMeter2=[v,0,v]}return h}function bte(t,e){const[r,n,i]=t,[a,s,o]=e,{unitsPerMeter:u,unitsPerMeter2:h}=nR({longitude:r,latitude:n,highPrecision:!0}),f=Pb(t);f[0]+=a*(u[0]+h[0]*s),f[1]+=s*(u[1]+h[1]*s);const g=T0(f),b=(i||0)+(o||0);return Number.isFinite(i)||Number.isFinite(o)?[g[0],g[1],b]:g}function $je(t){const{height:e,pitch:r,bearing:n,altitude:i,scale:a,center:s}=t,o=Bje();_E(o,o,[0,0,-i]),Kee(o,o,-r*Eh),Jee(o,o,n*Eh);const u=a/e;return WN(o,o,[u,u,u]),s&&_E(o,o,Aze([],s)),o}function qje(t){const{width:e,height:r,altitude:n,pitch:i=0,offset:a,center:s,scale:o,nearZMultiplier:u=1,farZMultiplier:h=1}=t;let{fovy:f=kb(jje)}=t;n!==void 0&&(f=kb(n));const g=f*Eh,b=i*Eh,v=YN(f);let S=v;s&&(S+=s[2]*o/Math.cos(b)/r);const E=g*(.5+(a?a[1]:0)/r),P=Math.sin(E)*S/Math.sin(tR(Math.PI/2-b-E,.01,Math.PI-.01)),k=Math.sin(b)*P+S,L=S*10,O=Math.min(k*h,L);return{fov:g,aspect:e/r,focalDistance:v,near:u,far:O}}function kb(t){return 2*Math.atan(.5/t)*rR}function YN(t){return .5/Math.tan(.5*t*Eh)}function xte(t,e){const[r,n,i=0]=t;return Qd(Number.isFinite(r)&&Number.isFinite(n)&&Number.isFinite(i)),Yv(e,[r,n,i,1])}function ZN(t,e,r=0){const[n,i,a]=t;if(Qd(Number.isFinite(n)&&Number.isFinite(i),"invalid pixel coordinate"),Number.isFinite(a))return Yv(e,[n,i,a,1]);const s=Yv(e,[n,i,0,1]),o=Yv(e,[n,i,1,1]),u=s[2],h=o[2],f=u===h?0:((r||0)-u)/(h-u);return Gee([],s,o,f)}function Hje(t){const{width:e,height:r,bounds:n,minExtent:i=0,maxZoom:a=24,offset:s=[0,0]}=t,[[o,u],[h,f]]=n,g=Wje(t.padding),b=Pb([o,tR(f,-jp,jp)]),v=Pb([h,tR(u,-jp,jp)]),S=[Math.max(Math.abs(v[0]-b[0]),i),Math.max(Math.abs(v[1]-b[1]),i)],E=[e-g.left-g.right-Math.abs(s[0])*2,r-g.top-g.bottom-Math.abs(s[1])*2];Qd(E[0]>0&&E[1]>0);const P=E[0]/S[0],k=E[1]/S[1],L=(g.right-g.left)/2/P,O=(g.top-g.bottom)/2/k,M=[(v[0]+b[0])/2+L,(v[1]+b[1])/2+O],z=T0(M),B=Math.min(a,XN(Math.abs(Math.min(P,k))));return Qd(Number.isFinite(B)),{longitude:z[0],latitude:z[1],zoom:B}}function Wje(t=0){return typeof t=="number"?{top:t,bottom:t,left:t,right:t}:(Qd(Number.isFinite(t.top)&&Number.isFinite(t.bottom)&&Number.isFinite(t.left)&&Number.isFinite(t.right)),t)}const rH=Math.PI/180;function Gje(t,e=0){const{width:r,height:n,unproject:i}=t,a={targetZ:e},s=i([0,n],a),o=i([r,n],a);let u,h;const f=t.fovy?.5*t.fovy*rH:Math.atan(.5/t.altitude),g=(90-t.pitch)*rH;return f>g-.01?(u=nH(t,0,e),h=nH(t,r,e)):(u=i([0,0],a),h=i([r,0],a)),[s,o,h,u]}function nH(t,e,r){const{pixelUnprojectionMatrix:n}=t,i=Yv(n,[e,0,1,1]),a=Yv(n,[e,t.height,1,1]),o=(r*t.distanceScales.unitsPerMeter[2]-i[2])/(a[2]-i[2]),u=Gee([],i,a,o),h=T0(u);return h.push(r),h}const iH=512;function Xje(t){const{width:e,height:r,pitch:n=0}=t;let{longitude:i,latitude:a,zoom:s,bearing:o=0}=t;(i<-180||i>180)&&(i=tH(i+180,360)-180),(o<-180||o>180)&&(o=tH(o+180,360)-180);const u=XN(r/iH);if(s<=u)s=u,a=0;else{const h=r/2/Math.pow(2,s),f=T0([0,h])[1];if(a<f)a=f;else{const g=T0([0,iH-h])[1];a>g&&(a=g)}}return{width:e,height:r,longitude:i,latitude:a,zoom:s,pitch:n,bearing:o}}const wte=`
uniform shadowUniforms {
  bool drawShadowMap;
  bool useShadowMap;
  vec4 color;
  highp int lightId;
  float lightCount;
  mat4 viewProjectionMatrix0;
  mat4 viewProjectionMatrix1;
  vec4 projectCenter0;
  vec4 projectCenter1;
} shadow;
`,Yje=`
const int max_lights = 2;

out vec3 shadow_vPosition[max_lights];

vec4 shadow_setVertexPosition(vec4 position_commonspace) {
  mat4 viewProjectionMatrices[max_lights];
  viewProjectionMatrices[0] = shadow.viewProjectionMatrix0;
  viewProjectionMatrices[1] = shadow.viewProjectionMatrix1;
  vec4 projectCenters[max_lights];
  projectCenters[0] = shadow.projectCenter0;
  projectCenters[1] = shadow.projectCenter1;

  if (shadow.drawShadowMap) {
    return project_common_position_to_clipspace(position_commonspace, viewProjectionMatrices[shadow.lightId], projectCenters[shadow.lightId]);
  }
  if (shadow.useShadowMap) {
    for (int i = 0; i < max_lights; i++) {
      if(i < int(shadow.lightCount)) {
        vec4 shadowMap_position = project_common_position_to_clipspace(position_commonspace, viewProjectionMatrices[i], projectCenters[i]);
        shadow_vPosition[i] = (shadowMap_position.xyz / shadowMap_position.w + 1.0) / 2.0;
      }
    }
  }
  return gl_Position;
}
`,Zje=`
${wte}
${Yje}
`,Kje=`
const int max_lights = 2;
uniform sampler2D shadow_uShadowMap0;
uniform sampler2D shadow_uShadowMap1;

in vec3 shadow_vPosition[max_lights];

const vec4 bitPackShift = vec4(1.0, 255.0, 65025.0, 16581375.0);
const vec4 bitUnpackShift = 1.0 / bitPackShift;
const vec4 bitMask = vec4(1.0 / 255.0, 1.0 / 255.0, 1.0 / 255.0,  0.0);

float shadow_getShadowWeight(vec3 position, sampler2D shadowMap) {
  vec4 rgbaDepth = texture(shadowMap, position.xy);

  float z = dot(rgbaDepth, bitUnpackShift);
  return smoothstep(0.001, 0.01, position.z - z);
}

vec4 shadow_filterShadowColor(vec4 color) {
  if (shadow.drawShadowMap) {
    vec4 rgbaDepth = fract(gl_FragCoord.z * bitPackShift);
    rgbaDepth -= rgbaDepth.gbaa * bitMask;
    return rgbaDepth;
  }
  if (shadow.useShadowMap) {
    float shadowAlpha = 0.0;
    shadowAlpha += shadow_getShadowWeight(shadow_vPosition[0], shadow_uShadowMap0);
    if(shadow.lightCount > 1.0) {
      shadowAlpha += shadow_getShadowWeight(shadow_vPosition[1], shadow_uShadowMap1);
    }
    shadowAlpha *= shadow.color.a / shadow.lightCount;
    float blendedAlpha = shadowAlpha + color.a * (1.0 - shadowAlpha);

    return vec4(
      mix(color.rgb, shadow.color.rgb, shadowAlpha / blendedAlpha),
      blendedAlpha
    );
  }
  return color;
}
`,Jje=`
${wte}
${Kje}
`,Qje=_x(i7e),e7e=_x(a7e),t7e=[0,0,0,1],r7e=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0];function n7e(t,e){const[r,n,i]=t,a=ZN([r,n,i],e);return Number.isFinite(i)?a:[a[0],a[1],0]}function i7e({viewport:t,center:e}){return new hf(t.viewProjectionMatrix).invert().transform(e)}function a7e({viewport:t,shadowMatrices:e}){const r=[],n=t.pixelUnprojectionMatrix,i=t.isGeospatial?void 0:1,a=[[0,0,i],[t.width,0,i],[0,t.height,i],[t.width,t.height,i],[0,0,-1],[t.width,0,-1],[0,t.height,-1],[t.width,t.height,-1]].map(s=>n7e(s,n));for(const s of e){const o=s.clone().translate(new ad(t.center).negate()),u=a.map(f=>o.transform(f)),h=new hf().ortho({left:Math.min(...u.map(f=>f[0])),right:Math.max(...u.map(f=>f[0])),bottom:Math.min(...u.map(f=>f[1])),top:Math.max(...u.map(f=>f[1])),near:Math.min(...u.map(f=>-f[2])),far:Math.max(...u.map(f=>-f[2]))});r.push(h.multiplyRight(s))}return r}function o7e(t){const{shadowEnabled:e=!0,project:r}=t;if(!e||!r||!t.shadowMatrices||!t.shadowMatrices.length)return{drawShadowMap:!1,useShadowMap:!1,shadow_uShadowMap0:t.dummyShadowMap,shadow_uShadowMap1:t.dummyShadowMap};const n=GN.getUniforms(r),i=Qje({viewport:r.viewport,center:n.center}),a=[],s=e7e({shadowMatrices:t.shadowMatrices,viewport:r.viewport}).slice();for(let u=0;u<t.shadowMatrices.length;u++){const h=s[u],f=h.clone().translate(new ad(r.viewport.center).negate());n.coordinateSystem===qa.LNGLAT&&n.projectionMode===Jc.WEB_MERCATOR?(s[u]=f,a[u]=i):(s[u]=h.clone().multiplyRight(r7e),a[u]=f.transform(i))}const o={drawShadowMap:!!t.drawToShadowMap,useShadowMap:t.shadowMaps?t.shadowMaps.length>0:!1,color:t.shadowColor||t7e,lightId:t.shadowLightId||0,lightCount:t.shadowMatrices.length,shadow_uShadowMap0:t.dummyShadowMap,shadow_uShadowMap1:t.dummyShadowMap};for(let u=0;u<s.length;u++)o[`viewProjectionMatrix${u}`]=s[u],o[`projectCenter${u}`]=a[u];for(let u=0;u<2;u++)o[`shadow_uShadowMap${u}`]=t.shadowMaps&&t.shadowMaps[u]||t.dummyShadowMap;return o}const aH={name:"shadow",dependencies:[GN],vs:Zje,fs:Jje,inject:{"vs:DECKGL_FILTER_GL_POSITION":`
    position = shadow_setVertexPosition(geometry.position);
    `,"fs:DECKGL_FILTER_COLOR":`
    color = shadow_filterShadowColor(color);
    `},getUniforms:o7e,uniformTypes:{drawShadowMap:"f32",useShadowMap:"f32",color:"vec4<f32>",lightId:"i32",lightCount:"f32",viewProjectionMatrix0:"mat4x4<f32>",viewProjectionMatrix1:"mat4x4<f32>",projectCenter0:"vec4<f32>",projectCenter1:"vec4<f32>"}},s7e={...Dq,defaultUniforms:{...Dq.defaultUniforms,useFloatColors:!1},inject:{"vs:DECKGL_FILTER_GL_POSITION":`
    // for picking depth values
    picking_setPickingAttribute(position.z / position.w);
  `,"vs:DECKGL_FILTER_COLOR":`
  picking_setPickingColor(geometry.pickingColor);
  `,"fs:DECKGL_FILTER_COLOR":{order:99,injection:`
  // use highlight color if this fragment belongs to the selected object.
  color = picking_filterHighlightColor(color);

  // use picking color if rendering to picking FBO.
  color = picking_filterPickingColor(color);
    `}}},l7e=[lte],u7e=["vs:DECKGL_FILTER_SIZE(inout vec3 size, VertexGeometry geometry)","vs:DECKGL_FILTER_GL_POSITION(inout vec4 position, VertexGeometry geometry)","vs:DECKGL_FILTER_COLOR(inout vec4 color, VertexGeometry geometry)","fs:DECKGL_FILTER_COLOR(inout vec4 color, FragmentGeometry geometry)"],c7e=[];function h7e(t){const e=Qg.getDefaultShaderAssembler();for(const n of l7e)e.addDefaultModule(n);const r=t==="glsl"?u7e:c7e;for(const n of r)e.addShaderHook(n);return e}const f7e=[255,255,255],d7e=1;let p7e=0;class g7e{constructor(e={}){this.type="ambient";const{color:r=f7e}=e,{intensity:n=d7e}=e;this.id=e.id||`ambient-${p7e++}`,this.color=r,this.intensity=n}}const m7e=[255,255,255],y7e=1,v7e=[0,0,-1];let _7e=0;class oH{constructor(e={}){this.type="directional";const{color:r=m7e}=e,{intensity:n=y7e}=e,{direction:i=v7e}=e,{_shadow:a=!1}=e;this.id=e.id||`directional-${_7e++}`,this.color=r,this.intensity=n,this.type="directional",this.direction=new ad(i).normalize().toArray(),this.shadow=a}getProjectedLight(e){return this}}class b7e{constructor(e,r={id:"pass"}){const{id:n}=r;this.id=n,this.device=e,this.props={...r}}setProps(e){Object.assign(this.props,e)}render(e){}cleanup(){}}class KN extends b7e{constructor(){super(...arguments),this._lastRenderIndex=-1}render(e){const[r,n]=this.device.canvasContext.getDrawingBufferSize(),i=e.clearCanvas??!0,a=e.clearColor??(i?[0,0,0,0]:!1),s=i?1:!1,o=i?0:!1,u=e.colorMask??15,h={viewport:[0,0,r,n]};e.colorMask&&(h.colorMask=u),e.scissorRect&&(h.scissorRect=e.scissorRect);const f=this.device.beginRenderPass({framebuffer:e.target,parameters:h,clearColor:a,clearDepth:s,clearStencil:o});try{return this._drawLayers(f,e)}finally{f.end(),this.device.submit()}}_drawLayers(e,r){const{target:n,shaderModuleProps:i,viewports:a,views:s,onViewportActive:o,clearStack:u=!0}=r;r.pass=r.pass||"unknown",u&&(this._lastRenderIndex=-1);const h=[];for(const f of a){const g=s&&s[f.id];o?.(f);const b=this._getDrawLayerParams(f,r),v=f.subViewports||[f];for(const S of v){const E=this._drawLayersInViewport(e,{target:n,shaderModuleProps:i,viewport:S,view:g,pass:r.pass,layers:r.layers},b);h.push(E)}}return h}_getDrawLayerParams(e,{layers:r,pass:n,isPicking:i=!1,layerFilter:a,cullRect:s,effects:o,shaderModuleProps:u},h=!1){const f=[],g=Ste(this._lastRenderIndex+1),b={layer:r[0],viewport:e,isPicking:i,renderPass:n,cullRect:s},v={};for(let S=0;S<r.length;S++){const E=r[S],P=this._shouldDrawLayer(E,b,a,v),k={shouldDrawLayer:P};P&&!h&&(k.shouldDrawLayer=!0,k.layerRenderIndex=g(E,P),k.shaderModuleProps=this._getShaderModuleProps(E,o,n,u),k.layerParameters={...E.context.deck?.props.parameters,...this.getLayerParameters(E,S,e)}),f[S]=k}return f}_drawLayersInViewport(e,{layers:r,shaderModuleProps:n,pass:i,target:a,viewport:s,view:o},u){const h=x7e(this.device,{shaderModuleProps:n,target:a,viewport:s});if(o&&o.props.clear){const g=o.props.clear===!0?{color:!0,depth:!0}:o.props.clear;this.device.beginRenderPass({framebuffer:a,parameters:{viewport:h,scissorRect:h},clearColor:g.color?[0,0,0,0]:!1,clearDepth:g.depth?1:!1}).end()}const f={totalCount:r.length,visibleCount:0,compositeCount:0,pickableCount:0};e.setParameters({viewport:h});for(let g=0;g<r.length;g++){const b=r[g],v=u[g],{shouldDrawLayer:S}=v;if(S&&b.props.pickable&&f.pickableCount++,b.isComposite&&f.compositeCount++,b.isDrawable&&v.shouldDrawLayer){const{layerRenderIndex:E,shaderModuleProps:P,layerParameters:k}=v;f.visibleCount++,this._lastRenderIndex=Math.max(this._lastRenderIndex,E),P.project&&(P.project.viewport=s),b.context.renderPass=e;try{b._drawLayer({renderPass:e,shaderModuleProps:P,uniforms:{layerIndex:E},parameters:k})}catch(L){b.raiseError(L,`drawing ${b} to ${i}`)}}}return f}shouldDrawLayer(e){return!0}getShaderModuleProps(e,r,n){return null}getLayerParameters(e,r,n){return e.props.parameters}_shouldDrawLayer(e,r,n,i){if(!(e.props.visible&&this.shouldDrawLayer(e)))return!1;r.layer=e;let s=e.parent;for(;s;){if(!s.props.visible||!s.filterSubLayer(r))return!1;r.layer=s,s=s.parent}if(n){const o=r.layer.id;if(o in i||(i[o]=n(r)),!i[o])return!1}return e.activateViewport(r.viewport),!0}_getShaderModuleProps(e,r,n,i){const a=this.device.canvasContext.cssToDeviceRatio(),s=e.internalState?.propsInTransition||e.props,o={layer:s,picking:{isActive:!1},project:{viewport:e.context.viewport,devicePixelRatio:a,modelMatrix:s.modelMatrix,coordinateSystem:s.coordinateSystem,coordinateOrigin:s.coordinateOrigin,autoWrapLongitude:e.wrapLongitude}};if(r)for(const u of r)sH(o,u.getShaderModuleProps?.(e,o));return sH(o,this.getShaderModuleProps(e,r,o),i)}}function Ste(t=0,e={}){const r={},n=(i,a)=>{const s=i.props._offset,o=i.id,u=i.parent&&i.parent.id;let h;if(u&&!(u in e)&&n(i.parent,!1),u in r){const f=r[u]=r[u]||Ste(e[u],e);h=f(i,a),r[o]=f}else Number.isFinite(s)?(h=s+(e[u]||0),r[o]=null):h=t;return a&&h>=t&&(t=h+1),e[o]=h,h};return n}function x7e(t,{shaderModuleProps:e,target:r,viewport:n}){const i=e?.project?.devicePixelRatio??t.canvasContext.cssToDeviceRatio(),[,a]=t.canvasContext.getDrawingBufferSize(),s=r?r.height:a,o=n;return[o.x*i,s-(o.y+o.height)*i,o.width*i,o.height*i]}function sH(t,...e){for(const r of e)if(r)for(const n in r)t[n]?Object.assign(t[n],r[n]):t[n]=r[n];return t}class w7e extends KN{constructor(e,r){super(e,r);const n=e.createTexture({format:"rgba8unorm",width:1,height:1,sampler:{minFilter:"linear",magFilter:"linear",addressModeU:"clamp-to-edge",addressModeV:"clamp-to-edge"},mipmaps:!0}),i=e.createTexture({format:"depth16unorm",width:1,height:1,mipmaps:!1});this.fbo=e.createFramebuffer({id:"shadowmap",width:1,height:1,colorAttachments:[n],depthStencilAttachment:i})}delete(){this.fbo&&(this.fbo.destroy(),this.fbo=null)}getShadowMap(){return this.fbo.colorAttachments[0].texture}render(e){const r=this.fbo,n=this.device.canvasContext.cssToDeviceRatio(),i=e.viewports[0],a=i.width*n,s=i.height*n,o=[1,1,1,1];(a!==r.width||s!==r.height)&&r.resize({width:a,height:s}),super.render({...e,clearColor:o,target:r,pass:"shadow"})}getLayerParameters(e,r,n){return{...e.props.parameters,blend:!1,depthWriteEnabled:!0,depthCompare:"less-equal"}}shouldDrawLayer(e){return e.props.shadowEnabled!==!1}getShaderModuleProps(e,r,n){return{shadow:{project:n.project,drawToShadowMap:!0}}}}const S7e={color:[255,255,255],intensity:1},lH=[{color:[255,255,255],intensity:1,direction:[-1,3,-1]},{color:[255,255,255],intensity:.9,direction:[1,-8,-2.5]}],E7e=[0,0,0,200/255];class Ete{constructor(e={}){this.id="lighting-effect",this.shadowColor=E7e,this.shadow=!1,this.directionalLights=[],this.pointLights=[],this.shadowPasses=[],this.dummyShadowMap=null,this.setProps(e)}setup(e){this.context=e;const{device:r,deck:n}=e;this.shadow&&!this.dummyShadowMap&&(this._createShadowPasses(r),n._addDefaultShaderModule(aH),this.dummyShadowMap=r.createTexture({width:1,height:1}))}setProps(e){this.ambientLight=void 0,this.directionalLights=[],this.pointLights=[];for(const r in e){const n=e[r];switch(n.type){case"ambient":this.ambientLight=n;break;case"directional":this.directionalLights.push(n);break;case"point":this.pointLights.push(n);break}}this._applyDefaultLights(),this.shadow=this.directionalLights.some(r=>r.shadow),this.context&&this.setup(this.context),this.props=e}preRender({layers:e,layerFilter:r,viewports:n,onViewportActive:i,views:a}){if(this.shadow){this.shadowMatrices=this._calculateMatrices();for(let s=0;s<this.shadowPasses.length;s++)this.shadowPasses[s].render({layers:e,layerFilter:r,viewports:n,onViewportActive:i,views:a,shaderModuleProps:{shadow:{shadowLightId:s,dummyShadowMap:this.dummyShadowMap,shadowMatrices:this.shadowMatrices}}})}}getShaderModuleProps(e,r){const n=this.shadow?{project:r.project,shadowMaps:this.shadowPasses.map(s=>s.getShadowMap()),dummyShadowMap:this.dummyShadowMap,shadowColor:this.shadowColor,shadowMatrices:this.shadowMatrices}:{},i={enabled:!0,ambientLight:this.ambientLight,directionalLights:this.directionalLights.map(s=>s.getProjectedLight({layer:e})),pointLights:this.pointLights.map(s=>s.getProjectedLight({layer:e}))},a=e.props.material;return{shadow:n,lighting:i,phongMaterial:a,gouraudMaterial:a}}cleanup(e){for(const r of this.shadowPasses)r.delete();this.shadowPasses.length=0,this.dummyShadowMap&&(this.dummyShadowMap.destroy(),this.dummyShadowMap=null,e.deck._removeDefaultShaderModule(aH))}_calculateMatrices(){const e=[];for(const r of this.directionalLights){const n=new hf().lookAt({eye:new ad(r.direction).negate()});e.push(n)}return e}_createShadowPasses(e){for(let r=0;r<this.directionalLights.length;r++){const n=new w7e(e);this.shadowPasses[r]=n}}_applyDefaultLights(){const{ambientLight:e,pointLights:r,directionalLights:n}=this;!e&&r.length===0&&n.length===0&&(this.ambientLight=new g7e(S7e),this.directionalLights.push(new oH(lH[0]),new oH(lH[1])))}}class T7e{constructor(e={}){this._pool=[],this.opts={overAlloc:2,poolSize:100},this.setOptions(e)}setOptions(e){Object.assign(this.opts,e)}allocate(e,r,{size:n=1,type:i,padding:a=0,copy:s=!1,initialize:o=!1,maxCount:u}){const h=i||e&&e.constructor||Float32Array,f=r*n+a;if(ArrayBuffer.isView(e)){if(f<=e.length)return e;if(f*e.BYTES_PER_ELEMENT<=e.buffer.byteLength)return new h(e.buffer,0,f)}let g=1/0;u&&(g=u*n+a);const b=this._allocate(h,f,o,g);return e&&s?b.set(e):o||b.fill(0,0,4),this._release(e),b}release(e){this._release(e)}_allocate(e,r,n,i){let a=Math.max(Math.ceil(r*this.opts.overAlloc),1);a>i&&(a=i);const s=this._pool,o=e.BYTES_PER_ELEMENT*a,u=s.findIndex(h=>h.byteLength>=o);if(u>=0){const h=new e(s.splice(u,1)[0],0,a);return n&&h.fill(0),h}return new e(a)}_release(e){if(!ArrayBuffer.isView(e))return;const r=this._pool,{buffer:n}=e,{byteLength:i}=n,a=r.findIndex(s=>s.byteLength>=i);a<0?r.push(n):(a>0||r.length<this.opts.poolSize)&&r.splice(a,0,n),r.length>this.opts.poolSize&&r.shift()}}const Mb=new T7e;function g1(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function C7e(t,e){const r=t%e;return r<0?e+r:r}function A7e(t){return[t[12],t[13],t[14]]}function I7e(t){return{left:Gy(t[3]+t[0],t[7]+t[4],t[11]+t[8],t[15]+t[12]),right:Gy(t[3]-t[0],t[7]-t[4],t[11]-t[8],t[15]-t[12]),bottom:Gy(t[3]+t[1],t[7]+t[5],t[11]+t[9],t[15]+t[13]),top:Gy(t[3]-t[1],t[7]-t[5],t[11]-t[9],t[15]-t[13]),near:Gy(t[3]+t[2],t[7]+t[6],t[11]+t[10],t[15]+t[14]),far:Gy(t[3]-t[2],t[7]-t[6],t[11]-t[10],t[15]-t[14])}}const uH=new ad;function Gy(t,e,r,n){uH.set(t,e,r);const i=uH.len();return{distance:n/i,normal:new ad(-t/i,-e/i,-r/i)}}function P7e(t){return t-Math.fround(t)}let U_;function GI(t,e){const{size:r=1,startIndex:n=0}=e,i=e.endIndex!==void 0?e.endIndex:t.length,a=(i-n)/r;U_=Mb.allocate(U_,a,{type:Float32Array,size:r*2});let s=n,o=0;for(;s<i;){for(let u=0;u<r;u++){const h=t[s++];U_[o+u]=h,U_[o+u+r]=P7e(h)}o+=r*2}return U_.subarray(0,a*r*2)}function k7e(t){let e=null,r=!1;for(const n of t)n&&(e?(r||(e=[[e[0][0],e[0][1]],[e[1][0],e[1][1]]],r=!0),e[0][0]=Math.min(e[0][0],n[0][0]),e[0][1]=Math.min(e[0][1],n[0][1]),e[1][0]=Math.max(e[1][0],n[1][0]),e[1][1]=Math.max(e[1][1],n[1][1])):e=n);return e}const M7e=Math.PI/180,R7e=g1(),cH=[0,0,0],O7e={unitsPerMeter:[1,1,1],metersPerUnit:[1,1,1]};function L7e({width:t,height:e,orthographic:r,fovyRadians:n,focalDistance:i,padding:a,near:s,far:o}){const u=t/e,h=r?new hf().orthographic({fovy:n,aspect:u,focalDistance:i,near:s,far:o}):new hf().perspective({fovy:n,aspect:u,near:s,far:o});if(a){const{left:f=0,right:g=0,top:b=0,bottom:v=0}=a,S=Xf((f+t-g)/2,0,t)-t/2,E=Xf((b+e-v)/2,0,e)-e/2;h[8]-=S*2/t,h[9]+=E*2/e}return h}class Qm{constructor(e={}){this._frustumPlanes={},this.id=e.id||this.constructor.displayName||"viewport",this.x=e.x||0,this.y=e.y||0,this.width=e.width||1,this.height=e.height||1,this.zoom=e.zoom||0,this.padding=e.padding,this.distanceScales=e.distanceScales||O7e,this.focalDistance=e.focalDistance||1,this.position=e.position||cH,this.modelMatrix=e.modelMatrix||null;const{longitude:r,latitude:n}=e;this.isGeospatial=Number.isFinite(n)&&Number.isFinite(r),this._initProps(e),this._initMatrices(e),this.equals=this.equals.bind(this),this.project=this.project.bind(this),this.unproject=this.unproject.bind(this),this.projectPosition=this.projectPosition.bind(this),this.unprojectPosition=this.unprojectPosition.bind(this),this.projectFlat=this.projectFlat.bind(this),this.unprojectFlat=this.unprojectFlat.bind(this)}get subViewports(){return null}get metersPerPixel(){return this.distanceScales.metersPerUnit[2]/this.scale}get projectionMode(){return this.isGeospatial?this.zoom<12?Jc.WEB_MERCATOR:Jc.WEB_MERCATOR_AUTO_OFFSET:Jc.IDENTITY}equals(e){return e instanceof Qm?this===e?!0:e.width===this.width&&e.height===this.height&&e.scale===this.scale&&Ab(e.projectionMatrix,this.projectionMatrix)&&Ab(e.viewMatrix,this.viewMatrix):!1}project(e,{topLeft:r=!0}={}){const n=this.projectPosition(e),i=xte(n,this.pixelProjectionMatrix),[a,s]=i,o=r?s:this.height-s;return e.length===2?[a,o]:[a,o,i[2]]}unproject(e,{topLeft:r=!0,targetZ:n}={}){const[i,a,s]=e,o=r?a:this.height-a,u=n&&n*this.distanceScales.unitsPerMeter[2],h=ZN([i,o,s],this.pixelUnprojectionMatrix,u),[f,g,b]=this.unprojectPosition(h);return Number.isFinite(s)?[f,g,b]:Number.isFinite(n)?[f,g,n]:[f,g]}projectPosition(e){const[r,n]=this.projectFlat(e),i=(e[2]||0)*this.distanceScales.unitsPerMeter[2];return[r,n,i]}unprojectPosition(e){const[r,n]=this.unprojectFlat(e),i=(e[2]||0)*this.distanceScales.metersPerUnit[2];return[r,n,i]}projectFlat(e){if(this.isGeospatial){const r=Pb(e);return r[1]=Xf(r[1],-318,830),r}return e}unprojectFlat(e){return this.isGeospatial?T0(e):e}getBounds(e={}){const r={targetZ:e.z||0},n=this.unproject([0,0],r),i=this.unproject([this.width,0],r),a=this.unproject([0,this.height],r),s=this.unproject([this.width,this.height],r);return[Math.min(n[0],i[0],a[0],s[0]),Math.min(n[1],i[1],a[1],s[1]),Math.max(n[0],i[0],a[0],s[0]),Math.max(n[1],i[1],a[1],s[1])]}getDistanceScales(e){return e&&this.isGeospatial?nR({longitude:e[0],latitude:e[1],highPrecision:!0}):this.distanceScales}containsPixel({x:e,y:r,width:n=1,height:i=1}){return e<this.x+this.width&&this.x<e+n&&r<this.y+this.height&&this.y<r+i}getFrustumPlanes(){return this._frustumPlanes.near?this._frustumPlanes:(Object.assign(this._frustumPlanes,I7e(this.viewProjectionMatrix)),this._frustumPlanes)}panByPosition(e,r){return null}_initProps(e){const r=e.longitude,n=e.latitude;this.isGeospatial&&(Number.isFinite(e.zoom)||(this.zoom=Vje({latitude:n})+Math.log2(this.focalDistance)),this.distanceScales=e.distanceScales||nR({latitude:n,longitude:r}));const i=Math.pow(2,this.zoom);this.scale=i;const{position:a,modelMatrix:s}=e;let o=cH;if(a&&(o=s?new hf(s).transformAsVector(a,[]):a),this.isGeospatial){const u=this.projectPosition([r,n,0]);this.center=new ad(o).scale(this.distanceScales.unitsPerMeter).add(u)}else this.center=this.projectPosition(o)}_initMatrices(e){const{viewMatrix:r=R7e,projectionMatrix:n=null,orthographic:i=!1,fovyRadians:a,fovy:s=75,near:o=.1,far:u=1e3,padding:h=null,focalDistance:f=1}=e;this.viewMatrixUncentered=r,this.viewMatrix=new hf().multiplyRight(r).translate(new ad(this.center).negate()),this.projectionMatrix=n||L7e({width:this.width,height:this.height,orthographic:i,fovyRadians:a||s*M7e,focalDistance:f,padding:h,near:o,far:u});const g=g1();hm(g,g,this.projectionMatrix),hm(g,g,this.viewMatrix),this.viewProjectionMatrix=g,this.viewMatrixInverse=XM([],this.viewMatrix)||this.viewMatrix,this.cameraPosition=A7e(this.viewMatrixInverse);const b=g1(),v=g1();WN(b,b,[this.width/2,-this.height/2,1]),_E(b,b,[1,-1,0]),hm(v,b,this.viewProjectionMatrix),this.pixelProjectionMatrix=v,this.pixelUnprojectionMatrix=XM(g1(),this.pixelProjectionMatrix),this.pixelUnprojectionMatrix||Za.warn("Pixel project matrix not invertible")()}}Qm.displayName="Viewport";class Om extends Qm{constructor(e={}){const{latitude:r=0,longitude:n=0,zoom:i=0,pitch:a=0,bearing:s=0,nearZMultiplier:o=.1,farZMultiplier:u=1.01,nearZ:h,farZ:f,orthographic:g=!1,projectionMatrix:b,repeat:v=!1,worldOffset:S=0,position:E,padding:P,legacyMeterSizes:k=!1}=e;let{width:L,height:O,altitude:M=1.5}=e;const z=Math.pow(2,i);L=L||1,O=O||1;let B,q=null;if(b)M=b[5]/2,B=kb(M);else{e.fovy?(B=e.fovy,M=YN(B)):B=kb(M);let G;if(P){const{top:ie=0,bottom:Q=0}=P;G=[0,Xf((ie+O-Q)/2,0,O)-O/2]}q=qje({width:L,height:O,scale:z,center:E&&[0,0,E[2]*Dw(r)],offset:G,pitch:a,fovy:B,nearZMultiplier:o,farZMultiplier:u}),Number.isFinite(h)&&(q.near=h),Number.isFinite(f)&&(q.far=f)}let W=$je({height:O,pitch:a,bearing:s,scale:z,altitude:M});S&&(W=new hf().translate([512*S,0,0]).multiplyLeft(W)),super({...e,width:L,height:O,viewMatrix:W,longitude:n,latitude:r,zoom:i,...q,fovy:B,focalDistance:M}),this.latitude=r,this.longitude=n,this.zoom=i,this.pitch=a,this.bearing=s,this.altitude=M,this.fovy=B,this.orthographic=g,this._subViewports=v?[]:null,this._pseudoMeters=k,Object.freeze(this)}get subViewports(){if(this._subViewports&&!this._subViewports.length){const e=this.getBounds(),r=Math.floor((e[0]+180)/360),n=Math.ceil((e[2]-180)/360);for(let i=r;i<=n;i++){const a=i?new Om({...this,worldOffset:i}):this;this._subViewports.push(a)}}return this._subViewports}projectPosition(e){if(this._pseudoMeters)return super.projectPosition(e);const[r,n]=this.projectFlat(e),i=(e[2]||0)*Dw(e[1]);return[r,n,i]}unprojectPosition(e){if(this._pseudoMeters)return super.unprojectPosition(e);const[r,n]=this.unprojectFlat(e),i=(e[2]||0)/Dw(n);return[r,n,i]}addMetersToLngLat(e,r){return bte(e,r)}panByPosition(e,r){const n=ZN(r,this.pixelUnprojectionMatrix),i=this.projectFlat(e),a=Lq([],i,_ze([],n)),s=Lq([],this.center,a),[o,u]=this.unprojectFlat(s);return{longitude:o,latitude:u}}getBounds(e={}){const r=Gje(this,e.z||0);return[Math.min(r[0][0],r[1][0],r[2][0],r[3][0]),Math.min(r[0][1],r[1][1],r[2][1],r[3][1]),Math.max(r[0][0],r[1][0],r[2][0],r[3][0]),Math.max(r[0][1],r[1][1],r[2][1],r[3][1])]}fitBounds(e,r={}){const{width:n,height:i}=this,{longitude:a,latitude:s,zoom:o}=Hje({width:n,height:i,bounds:e,...r});return new Om({width:n,height:i,longitude:a,latitude:s,zoom:o})}}Om.displayName="WebMercatorViewport";const hH=[0,0,0];function XI(t,e,r=!1){const n=e.projectPosition(t);if(r&&e instanceof Om){const[i,a,s=0]=t,o=e.getDistanceScales([i,a]);n[2]=s*o.unitsPerMeter[2]}return n}function N7e(t){const{viewport:e,modelMatrix:r,coordinateOrigin:n}=t;let{coordinateSystem:i,fromCoordinateSystem:a,fromCoordinateOrigin:s}=t;return i===qa.DEFAULT&&(i=e.isGeospatial?qa.LNGLAT:qa.CARTESIAN),a===void 0&&(a=i),s===void 0&&(s=n),{viewport:e,coordinateSystem:i,coordinateOrigin:n,modelMatrix:r,fromCoordinateSystem:a,fromCoordinateOrigin:s}}function Tte(t,{viewport:e,modelMatrix:r,coordinateSystem:n,coordinateOrigin:i,offsetMode:a}){let[s,o,u=0]=t;switch(r&&([s,o,u]=G0([],[s,o,u,1],r)),n){case qa.LNGLAT:return XI([s,o,u],e,a);case qa.LNGLAT_OFFSETS:return XI([s+i[0],o+i[1],u+(i[2]||0)],e,a);case qa.METER_OFFSETS:return XI(bte(i,[s,o,u]),e,a);case qa.CARTESIAN:default:return e.isGeospatial?[s+i[0],o+i[1],u+i[2]]:e.projectPosition([s,o,u])}}function D7e(t,e){const{viewport:r,coordinateSystem:n,coordinateOrigin:i,modelMatrix:a,fromCoordinateSystem:s,fromCoordinateOrigin:o}=N7e(e),{autoOffset:u=!0}=e,{geospatialOrigin:h=hH,shaderCoordinateOrigin:f=hH,offsetMode:g=!1}=u?yte(r,n,i):{},b=Tte(t,{viewport:r,modelMatrix:a,coordinateSystem:s,coordinateOrigin:o,offsetMode:g});if(g){const v=r.projectPosition(h||f);Zee(b,b,v)}return b}let F7e=1,B7e=1;class Cte{time=0;channels=new Map;animations=new Map;playing=!1;lastEngineTime=-1;constructor(){}addChannel(e){const{delay:r=0,duration:n=Number.POSITIVE_INFINITY,rate:i=1,repeat:a=1}=e,s=F7e++,o={time:0,delay:r,duration:n,rate:i,repeat:a};return this._setChannelTime(o,this.time),this.channels.set(s,o),s}removeChannel(e){this.channels.delete(e);for(const[r,n]of this.animations)n.channel===e&&this.detachAnimation(r)}isFinished(e){const r=this.channels.get(e);return r===void 0?!1:this.time>=r.delay+r.duration*r.repeat}getTime(e){if(e===void 0)return this.time;const r=this.channels.get(e);return r===void 0?-1:r.time}setTime(e){this.time=Math.max(0,e);const r=this.channels.values();for(const i of r)this._setChannelTime(i,this.time);const n=this.animations.values();for(const i of n){const{animation:a,channel:s}=i;a.setTime(this.getTime(s))}}play(){this.playing=!0}pause(){this.playing=!1,this.lastEngineTime=-1}reset(){this.setTime(0)}attachAnimation(e,r){const n=B7e++;return this.animations.set(n,{animation:e,channel:r}),e.setTime(this.getTime(r)),n}detachAnimation(e){this.animations.delete(e)}update(e){this.playing&&(this.lastEngineTime===-1&&(this.lastEngineTime=e),this.setTime(this.time+(e-this.lastEngineTime)),this.lastEngineTime=e)}_setChannelTime(e,r){const n=r-e.delay,i=e.duration*e.repeat;n>=i?e.time=e.duration*e.rate:(e.time=Math.max(0,n)%e.duration,e.time*=e.rate)}}function z7e(t){return typeof window<"u"&&window.requestAnimationFrame?window.requestAnimationFrame(t):setTimeout(t,1e3/60)}function j7e(t){return typeof window<"u"&&window.cancelAnimationFrame?window.cancelAnimationFrame(t):clearTimeout(t)}let U7e=0;const V7e={device:null,onAddHTML:()=>"",onInitialize:async()=>null,onRender:()=>{},onFinalize:()=>{},onError:t=>console.error(t),stats:qM.stats.get(`animation-loop-${U7e++}`),useDevicePixels:!0,autoResizeViewport:!1,autoResizeDrawingBuffer:!1};class $7e{device=null;canvas=null;props;animationProps=null;timeline=null;stats;cpuTime;gpuTime;frameRate;display;needsRedraw="initialized";_initialized=!1;_running=!1;_animationFrameId=null;_nextFramePromise=null;_resolveNextFrame=null;_cpuStartTime=0;_error=null;constructor(e){if(this.props={...V7e,...e},e=this.props,!e.device)throw new Error("No device provided");const{useDevicePixels:r=!0}=this.props;this.stats=e.stats||new ZT({id:"animation-loop-stats"}),this.cpuTime=this.stats.get("CPU Time"),this.gpuTime=this.stats.get("GPU Time"),this.frameRate=this.stats.get("Frame Rate"),this.setProps({autoResizeViewport:e.autoResizeViewport,autoResizeDrawingBuffer:e.autoResizeDrawingBuffer,useDevicePixels:r}),this.start=this.start.bind(this),this.stop=this.stop.bind(this),this._onMousemove=this._onMousemove.bind(this),this._onMouseleave=this._onMouseleave.bind(this)}destroy(){this.stop(),this._setDisplay(null)}delete(){this.destroy()}setError(e){if(this.props.onError(e),this._error=Error(),this.device?.canvasContext?.canvas instanceof HTMLCanvasElement){const n=document.createElement("h1");n.innerHTML=e.message,n.style.position="absolute",n.style.top="20%",n.style.left="10px",n.style.color="black",n.style.backgroundColor="red",document.body.appendChild(n)}}setNeedsRedraw(e){return this.needsRedraw=this.needsRedraw||e,this}setProps(e){return"autoResizeViewport"in e&&(this.props.autoResizeViewport=e.autoResizeViewport||!1),"autoResizeDrawingBuffer"in e&&(this.props.autoResizeDrawingBuffer=e.autoResizeDrawingBuffer||!1),"useDevicePixels"in e&&(this.props.useDevicePixels=e.useDevicePixels||!1),this}async start(){if(this._running)return this;this._running=!0;try{let e;return this._initialized||(this._initialized=!0,await this._initDevice(),this._initialize(),await this.props.onInitialize(this._getAnimationProps())),this._running?(e!==!1&&(this._cancelAnimationFrame(),this._requestAnimationFrame()),this):null}catch(e){const r=e instanceof Error?e:new Error("Unknown error");throw this.props.onError(r),r}}stop(){return this._running&&(this.animationProps&&!this._error&&this.props.onFinalize(this.animationProps),this._cancelAnimationFrame(),this._nextFramePromise=null,this._resolveNextFrame=null,this._running=!1),this}redraw(){return this.device?.isLost||this._error?this:(this._beginFrameTimers(),this._setupFrame(),this._updateAnimationProps(),this._renderFrame(this._getAnimationProps()),this._clearNeedsRedraw(),this._resolveNextFrame&&(this._resolveNextFrame(this),this._nextFramePromise=null,this._resolveNextFrame=null),this._endFrameTimers(),this)}attachTimeline(e){return this.timeline=e,this.timeline}detachTimeline(){this.timeline=null}waitForRender(){return this.setNeedsRedraw("waitForRender"),this._nextFramePromise||(this._nextFramePromise=new Promise(e=>{this._resolveNextFrame=e})),this._nextFramePromise}async toDataURL(){if(this.setNeedsRedraw("toDataURL"),await this.waitForRender(),this.canvas instanceof HTMLCanvasElement)return this.canvas.toDataURL();throw new Error("OffscreenCanvas")}_initialize(){this._startEventHandling(),this._initializeAnimationProps(),this._updateAnimationProps(),this._resizeCanvasDrawingBuffer(),this._resizeViewport()}_setDisplay(e){this.display&&(this.display.destroy(),this.display.animationLoop=null),e&&(e.animationLoop=this),this.display=e}_requestAnimationFrame(){this._running&&(this._animationFrameId=z7e(this._animationFrame.bind(this)))}_cancelAnimationFrame(){this._animationFrameId!==null&&(j7e(this._animationFrameId),this._animationFrameId=null)}_animationFrame(){this._running&&(this.redraw(),this._requestAnimationFrame())}_renderFrame(e){if(this.display){this.display._renderFrame(e);return}this.props.onRender(this._getAnimationProps()),this.device?.submit()}_clearNeedsRedraw(){this.needsRedraw=!1}_setupFrame(){this._resizeCanvasDrawingBuffer(),this._resizeViewport()}_initializeAnimationProps(){const e=this.device?.canvasContext?.canvas;if(!this.device||!e)throw new Error("loop");this.animationProps={animationLoop:this,device:this.device,canvas:e,timeline:this.timeline,useDevicePixels:this.props.useDevicePixels,needsRedraw:!1,width:1,height:1,aspect:1,time:0,startTime:Date.now(),engineTime:0,tick:0,tock:0,_mousePosition:null}}_getAnimationProps(){if(!this.animationProps)throw new Error("animationProps");return this.animationProps}_updateAnimationProps(){if(!this.animationProps)return;const{width:e,height:r,aspect:n}=this._getSizeAndAspect();(e!==this.animationProps.width||r!==this.animationProps.height)&&this.setNeedsRedraw("drawing buffer resized"),n!==this.animationProps.aspect&&this.setNeedsRedraw("drawing buffer aspect changed"),this.animationProps.width=e,this.animationProps.height=r,this.animationProps.aspect=n,this.animationProps.needsRedraw=this.needsRedraw,this.animationProps.engineTime=Date.now()-this.animationProps.startTime,this.timeline&&this.timeline.update(this.animationProps.engineTime),this.animationProps.tick=Math.floor(this.animationProps.time/1e3*60),this.animationProps.tock++,this.animationProps.time=this.timeline?this.timeline.getTime():this.animationProps.engineTime}async _initDevice(){if(this.device=await this.props.device,!this.device)throw new Error("No device provided");this.canvas=this.device.canvasContext?.canvas||null}_createInfoDiv(){if(this.canvas&&this.props.onAddHTML){const e=document.createElement("div");document.body.appendChild(e),e.style.position="relative";const r=document.createElement("div");r.style.position="absolute",r.style.left="10px",r.style.bottom="10px",r.style.width="300px",r.style.background="white",this.canvas instanceof HTMLCanvasElement&&e.appendChild(this.canvas),e.appendChild(r);const n=this.props.onAddHTML(r);n&&(r.innerHTML=n)}}_getSizeAndAspect(){if(!this.device)return{width:1,height:1,aspect:1};const[e,r]=this.device?.canvasContext?.getPixelSize()||[1,1];let n=1;const i=this.device?.canvasContext?.canvas;return i&&i.clientHeight?n=i.clientWidth/i.clientHeight:e>0&&r>0&&(n=e/r),{width:e,height:r,aspect:n}}_resizeViewport(){this.props.autoResizeViewport&&this.device.gl&&this.device.gl.viewport(0,0,this.device.gl.drawingBufferWidth,this.device.gl.drawingBufferHeight)}_resizeCanvasDrawingBuffer(){this.props.autoResizeDrawingBuffer&&this.device?.canvasContext?.resize({useDevicePixels:this.props.useDevicePixels})}_beginFrameTimers(){this.frameRate.timeEnd(),this.frameRate.timeStart(),this.cpuTime.timeStart()}_endFrameTimers(){this.cpuTime.timeEnd()}_startEventHandling(){this.canvas&&(this.canvas.addEventListener("mousemove",this._onMousemove.bind(this)),this.canvas.addEventListener("mouseleave",this._onMouseleave.bind(this)))}_onMousemove(e){e instanceof MouseEvent&&(this._getAnimationProps()._mousePosition=[e.offsetX,e.offsetY])}_onMouseleave(e){this._getAnimationProps()._mousePosition=null}}const YI={};function nC(t="id"){YI[t]=YI[t]||1;const e=YI[t]++;return`${t}-${e}`}class fH{id;userData={};topology;bufferLayout=[];vertexCount;indices;attributes;constructor(e){if(this.id=e.id||nC("geometry"),this.topology=e.topology,this.indices=e.indices||null,this.attributes=e.attributes,this.vertexCount=e.vertexCount,this.bufferLayout=e.bufferLayout||[],this.indices&&!(this.indices.usage&Oo.INDEX))throw new Error("Index buffer must have INDEX usage")}destroy(){this.indices?.destroy();for(const e of Object.values(this.attributes))e.destroy()}getVertexCount(){return this.vertexCount}getAttributes(){return this.attributes}getIndexes(){return this.indices||null}_calculateVertexCount(e){return e.byteLength/12}}function q7e(t,e){if(e instanceof fH)return e;const r=H7e(t,e),{attributes:n,bufferLayout:i}=W7e(t,e);return new fH({topology:e.topology||"triangle-list",bufferLayout:i,vertexCount:e.vertexCount,indices:r,attributes:n})}function H7e(t,e){if(!e.indices)return;const r=e.indices.value;return t.createBuffer({usage:Oo.INDEX,data:r})}function W7e(t,e){const r=[],n={};for(const[a,s]of Object.entries(e.attributes)){let o=a;switch(a){case"POSITION":o="positions";break;case"NORMAL":o="normals";break;case"TEXCOORD_0":o="texCoords";break;case"COLOR_0":o="colors";break}if(s){n[o]=t.createBuffer({data:s.value,id:`${a}-buffer`});const{value:u,size:h,normalized:f}=s;r.push({name:o,format:RBe(u,h,f)})}}const i=e._calculateVertexCount(e.attributes,e.indices);return{attributes:n,bufferLayout:r,vertexCount:i}}class JN{static defaultProps={..._0.defaultProps};static getDefaultPipelineFactory(e){return e._lumaData.defaultPipelineFactory=e._lumaData.defaultPipelineFactory||new JN(e),e._lumaData.defaultPipelineFactory}device;destroyPolicy;_hashCounter=0;_hashes={};_renderPipelineCache={};_computePipelineCache={};constructor(e){this.device=e,this.destroyPolicy=e.props._factoryDestroyPolicy}createRenderPipeline(e){const r={..._0.defaultProps,...e},n=this._hashRenderPipeline(r);if(!this._renderPipelineCache[n]){const i=this.device.createRenderPipeline({...r,id:r.id?`${r.id}-cached`:void 0});i.hash=n,this._renderPipelineCache[n]={pipeline:i,useCount:0}}return this._renderPipelineCache[n].useCount++,this._renderPipelineCache[n].pipeline}createComputePipeline(e){const r={...hE.defaultProps,...e},n=this._hashComputePipeline(r);if(!this._computePipelineCache[n]){const i=this.device.createComputePipeline({...r,id:r.id?`${r.id}-cached`:void 0});i.hash=n,this._computePipelineCache[n]={pipeline:i,useCount:0}}return this._computePipelineCache[n].useCount++,this._computePipelineCache[n].pipeline}release(e){const r=e.hash,n=e instanceof hE?this._computePipelineCache:this._renderPipelineCache;n[r].useCount--,n[r].useCount===0&&this.destroyPolicy==="unused"&&(n[r].pipeline.destroy(),delete n[r])}_hashComputePipeline(e){return`${this._getHash(e.shader.source)}`}_hashRenderPipeline(e){const r=e.vs?this._getHash(e.vs.source):0,n=e.fs?this._getHash(e.fs.source):0,i="-",a=this._getHash(JSON.stringify(e.bufferLayout));switch(this.device.type){case"webgl":return`${r}/${n}V${i}BL${a}`;default:const s=this._getHash(JSON.stringify(e.parameters));return`${r}/${n}V${i}T${e.topology}P${s}BL${a}`}}_getHash(e){return this._hashes[e]===void 0&&(this._hashes[e]=this._hashCounter++),this._hashes[e]}}class QN{static defaultProps={...eC.defaultProps};static getDefaultShaderFactory(e){return e._lumaData.defaultShaderFactory||=new QN(e),e._lumaData.defaultShaderFactory}device;destroyPolicy;_cache={};constructor(e){this.device=e,this.destroyPolicy=e.props._factoryDestroyPolicy}createShader(e){const r=this._hashShader(e);let n=this._cache[r];if(!n){const i=this.device.createShader({...e,id:e.id?`${e.id}-cached`:void 0});this._cache[r]=n={shader:i,useCount:0}}return n.useCount++,n.shader}release(e){const r=this._hashShader(e),n=this._cache[r];n&&(n.useCount--,n.useCount===0&&this.destroyPolicy==="unused"&&(delete this._cache[r],n.shader.destroy()))}_hashShader(e){return`${e.stage}:${e.source}`}}function G7e(t,e){const r={},n="Values";if(t.attributes.length===0&&!t.varyings?.length)return{"No attributes or varyings":{[n]:"N/A"}};for(const i of t.attributes)if(i){const a=`${i.location} ${i.name}: ${i.type}`;r[`in ${a}`]={[n]:i.stepMode||"vertex"}}for(const i of t.varyings||[]){const a=`${i.location} ${i.name}`;r[`out ${a}`]={[n]:JSON.stringify(i)}}return r}let Yl=null,ZI=null;function X7e(t,{id:e,minimap:r,opaque:n,top:i="0",left:a="0",rgbaScale:s=1}){Yl||(Yl=document.createElement("canvas"),Yl.id=e,Yl.title=e,Yl.style.zIndex="100",Yl.style.position="absolute",Yl.style.top=i,Yl.style.left=a,Yl.style.border="blue 5px solid",Yl.style.transform="scaleY(-1)",document.body.appendChild(Yl),ZI=Yl.getContext("2d")),(Yl.width!==t.width||Yl.height!==t.height)&&(Yl.width=t.width/2,Yl.height=t.height/2,Yl.style.width="400px",Yl.style.height="400px");const o=t.device.readPixelsToArrayWebGL(t),u=ZI?.createImageData(t.width,t.height);if(u){for(let f=0;f<o.length;f+=4)u.data[0+f+0]=o[f+0]*s,u.data[0+f+1]=o[f+1]*s,u.data[0+f+2]=o[f+2]*s,u.data[0+f+3]=n?255:o[f+3]*s;ZI?.putImageData(u,0,0)}}function iR(t,e,r){if(t===e)return!0;if(!r||!t||!e)return!1;if(Array.isArray(t)){if(!Array.isArray(e)||t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(!iR(t[n],e[n],r-1))return!1;return!0}if(Array.isArray(e))return!1;if(typeof t=="object"&&typeof e=="object"){const n=Object.keys(t),i=Object.keys(e);if(n.length!==i.length)return!1;for(const a of n)if(!e.hasOwnProperty(a)||!iR(t[a],e[a],r-1))return!1;return!0}return!1}function Y7e(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function Z7e(t){return Array.isArray(t)?t.length===0||typeof t[0]=="number":!1}function Ate(t){return Y7e(t)||Z7e(t)}function K7e(t){return Ate(t)||typeof t=="number"||typeof t=="boolean"}function Ite(t){const e={bindings:{},uniforms:{}};return Object.keys(t).forEach(r=>{const n=t[r];K7e(n)?e.uniforms[r]=n:e.bindings[r]=n}),e}class J7e{options={disableWarnings:!1};modules;moduleUniforms;moduleBindings;constructor(e,r){Object.assign(this.options,r);const n=PN(Object.values(e).filter(i=>i.dependencies));for(const i of n)e[i.name]=i;dn.log(1,"Creating ShaderInputs with modules",Object.keys(e))(),this.modules=e,this.moduleUniforms={},this.moduleBindings={};for(const[i,a]of Object.entries(e))this._addModule(a),a.name&&i!==a.name&&!this.options.disableWarnings&&dn.warn(`Module name: ${i} vs ${a.name}`)()}destroy(){}setProps(e){for(const r of Object.keys(e)){const n=r,i=e[n]||{},a=this.modules[n];if(!a){this.options.disableWarnings||dn.warn(`Module ${r} not found`)();continue}const s=this.moduleUniforms[n],o=this.moduleBindings[n],u=a.getUniforms?.(i,s)||i,{uniforms:h,bindings:f}=Ite(u);this.moduleUniforms[n]={...s,...h},this.moduleBindings[n]={...o,...f}}}getModules(){return Object.values(this.modules)}getUniformValues(){return this.moduleUniforms}getBindingValues(){const e={};for(const r of Object.values(this.moduleBindings))Object.assign(e,r);return e}getDebugTable(){const e={};for(const[r,n]of Object.entries(this.moduleUniforms))for(const[i,a]of Object.entries(n))e[`${r}.${i}`]={type:this.modules[r].uniformTypes?.[i],value:String(a)};return e}_addModule(e){const r=e.name;this.moduleUniforms[r]=e.defaultUniforms||{},this.moduleBindings[r]={}}}let Q7e="";async function eUe(t,e){const r=new Image;return r.crossOrigin="anonymous",r.src=t.startsWith("http")?t:Q7e+t,await r.decode(),e?await createImageBitmap(r,e):await createImageBitmap(r)}class KI{device;id;texture;sampler;view;ready;isReady=!1;destroyed=!1;resolveReady=()=>{};rejectReady=()=>{};get[Symbol.toStringTag](){return"AsyncTexture"}toString(){return`AsyncTexture:"${this.id}"(${this.isReady?"ready":"loading"})`}constructor(e,r){this.device=e,this.id=r.id||nC("async-texture"),typeof r?.data=="string"&&r.dimension==="2d"&&(r={...r,data:eUe(r.data)}),this.ready=new Promise((n,i)=>{this.resolveReady=()=>{this.isReady=!0,n()},this.rejectReady=i}),this.initAsync(r)}async initAsync(e){const r=e.data;let n;try{n=await Pte(r)}catch(a){this.rejectReady(a)}if(this.destroyed)return;const i={...e,data:n};this.texture=this.device.createTexture(i),this.sampler=this.texture.sampler,this.view=this.texture.view,this.isReady=!0,this.resolveReady()}destroy(){this.texture&&(this.texture.destroy(),this.texture=null),this.destroyed=!0}resize(e){if(!this.isReady)throw new Error("Cannot resize texture before it is ready");if(e.width===this.texture.width&&e.height===this.texture.height)return!1;if(this.texture){const r=this.texture;this.texture=r.clone(e),r.destroy()}return!0}}async function Pte(t){if(t=await t,Array.isArray(t))return await Promise.all(t.map(Pte));if(t&&typeof t=="object"&&t.constructor===Object){const e=t,r=await Promise.all(Object.values(e)),n=Object.keys(e),i={};for(let a=0;a<n.length;a++)i[n[a]]=r[a];return i}return t}const Dg=2,tUe=1e4;class Lm{static defaultProps={..._0.defaultProps,source:void 0,vs:null,fs:null,id:"unnamed",handle:void 0,userData:{},defines:{},modules:[],moduleSettings:void 0,geometry:null,indexBuffer:null,attributes:{},constantAttributes:{},varyings:[],isInstanced:void 0,instanceCount:0,vertexCount:0,shaderInputs:void 0,pipelineFactory:void 0,shaderFactory:void 0,transformFeedback:void 0,shaderAssembler:Qg.getDefaultShaderAssembler(),debugShaders:void 0,disableWarnings:void 0};device;id;source;vs;fs;pipelineFactory;shaderFactory;userData={};parameters;topology;bufferLayout;isInstanced=void 0;instanceCount=0;vertexCount;indexBuffer=null;bufferAttributes={};constantAttributes={};bindings={};uniforms={};vertexArray;transformFeedback=null;pipeline;shaderInputs;_uniformStore;_attributeInfos={};_gpuGeometry=null;_getModuleUniforms;props;_pipelineNeedsUpdate="newly created";_needsRedraw="initializing";_destroyed=!1;_lastDrawTimestamp=-1;get[Symbol.toStringTag](){return"Model"}toString(){return`Model(${this.id})`}constructor(e,r){this.props={...Lm.defaultProps,...r},r=this.props,this.id=r.id||nC("model"),this.device=e,Object.assign(this.userData,r.userData);const n=Object.fromEntries(this.props.modules?.map(u=>[u.name,u])||[]),i=r.shaderInputs||new J7e(n,{disableWarnings:this.props.disableWarnings});this.setShaderInputs(i);const a=nUe(e),s=(this.props.modules?.length>0?this.props.modules:this.shaderInputs?.getModules())||[];if(this.device.type==="webgpu"&&this.props.source){const{source:u,getUniforms:h}=this.props.shaderAssembler.assembleWGSLShader({platformInfo:a,...this.props,modules:s});this.source=u,this._getModuleUniforms=h,this.props.shaderLayout||=uze(this.source)}else{const{vs:u,fs:h,getUniforms:f}=this.props.shaderAssembler.assembleGLSLShaderPair({platformInfo:a,...this.props,modules:s});this.vs=u,this.fs=h,this._getModuleUniforms=f}this.vertexCount=this.props.vertexCount,this.instanceCount=this.props.instanceCount,this.topology=this.props.topology,this.bufferLayout=this.props.bufferLayout,this.parameters=this.props.parameters,r.geometry&&this.setGeometry(r.geometry),this.pipelineFactory=r.pipelineFactory||JN.getDefaultPipelineFactory(this.device),this.shaderFactory=r.shaderFactory||QN.getDefaultShaderFactory(this.device),this.pipeline=this._updatePipeline(),this.vertexArray=e.createVertexArray({renderPipeline:this.pipeline}),this._gpuGeometry&&this._setGeometryAttributes(this._gpuGeometry),"isInstanced"in r&&(this.isInstanced=r.isInstanced),r.instanceCount&&this.setInstanceCount(r.instanceCount),r.vertexCount&&this.setVertexCount(r.vertexCount),r.indexBuffer&&this.setIndexBuffer(r.indexBuffer),r.attributes&&this.setAttributes(r.attributes),r.constantAttributes&&this.setConstantAttributes(r.constantAttributes),r.bindings&&this.setBindings(r.bindings),r.uniforms&&this.setUniformsWebGL(r.uniforms),r.moduleSettings&&this.updateModuleSettingsWebGL(r.moduleSettings),r.transformFeedback&&(this.transformFeedback=r.transformFeedback),Object.seal(this)}destroy(){this._destroyed||(this.pipelineFactory.release(this.pipeline),this.shaderFactory.release(this.pipeline.vs),this.pipeline.fs&&this.shaderFactory.release(this.pipeline.fs),this._uniformStore.destroy(),this._gpuGeometry?.destroy(),this._destroyed=!0)}needsRedraw(){this._getBindingsUpdateTimestamp()>this._lastDrawTimestamp&&this.setNeedsRedraw("contents of bound textures or buffers updated");const e=this._needsRedraw;return this._needsRedraw=!1,e}setNeedsRedraw(e){this._needsRedraw||=e}predraw(){this.updateShaderInputs(),this.pipeline=this._updatePipeline()}draw(e){const r=this._areBindingsLoading();if(r)return dn.info(Dg,`>>> DRAWING ABORTED ${this.id}: ${r} not loaded`)(),!1;try{e.pushDebugGroup(`${this}.predraw(${e})`),this.predraw()}finally{e.popDebugGroup()}let n;try{e.pushDebugGroup(`${this}.draw(${e})`),this._logDrawCallStart(),this.pipeline=this._updatePipeline();const i=this._getBindings();this.pipeline.setBindings(i,{disableWarnings:this.props.disableWarnings}),aR(this.uniforms)||this.pipeline.setUniformsWebGL(this.uniforms);const{indexBuffer:a}=this.vertexArray,s=a?a.byteLength/(a.indexType==="uint32"?4:2):void 0;n=this.pipeline.draw({renderPass:e,vertexArray:this.vertexArray,isInstanced:this.isInstanced,vertexCount:this.vertexCount,instanceCount:this.instanceCount,indexCount:s,transformFeedback:this.transformFeedback||void 0,parameters:this.parameters,topology:this.topology})}finally{e.popDebugGroup(),this._logDrawCallEnd()}return this._logFramebuffer(e),n?(this._lastDrawTimestamp=this.device.timestamp,this._needsRedraw=!1):this._needsRedraw="waiting for resource initialization",n}setGeometry(e){this._gpuGeometry?.destroy();const r=e&&q7e(this.device,e);if(r){this.setTopology(r.topology||"triangle-list");const n=new DI(this.bufferLayout);this.bufferLayout=n.mergeBufferLayouts(r.bufferLayout,this.bufferLayout),this.vertexArray&&this._setGeometryAttributes(r)}this._gpuGeometry=r}setTopology(e){e!==this.topology&&(this.topology=e,this._setPipelineNeedsUpdate("topology"))}setBufferLayout(e){const r=new DI(this.bufferLayout);this.bufferLayout=this._gpuGeometry?r.mergeBufferLayouts(e,this._gpuGeometry.bufferLayout):e,this._setPipelineNeedsUpdate("bufferLayout"),this.pipeline=this._updatePipeline(),this.vertexArray=this.device.createVertexArray({renderPipeline:this.pipeline}),this._gpuGeometry&&this._setGeometryAttributes(this._gpuGeometry)}setParameters(e){iR(e,this.parameters,2)||(this.parameters=e,this._setPipelineNeedsUpdate("parameters"))}setInstanceCount(e){this.instanceCount=e,this.isInstanced===void 0&&e>0&&(this.isInstanced=!0),this.setNeedsRedraw("instanceCount")}setVertexCount(e){this.vertexCount=e,this.setNeedsRedraw("vertexCount")}setShaderInputs(e){this.shaderInputs=e,this._uniformStore=new MBe(this.shaderInputs.modules);for(const[r,n]of Object.entries(this.shaderInputs.modules))if(rUe(n)){const i=this._uniformStore.getManagedUniformBuffer(this.device,r);this.bindings[`${r}Uniforms`]=i}this.setNeedsRedraw("shaderInputs")}updateShaderInputs(){this._uniformStore.setUniforms(this.shaderInputs.getUniformValues()),this.setBindings(this.shaderInputs.getBindingValues()),this.setNeedsRedraw("shaderInputs")}setBindings(e){Object.assign(this.bindings,e),this.setNeedsRedraw("bindings")}setTransformFeedback(e){this.transformFeedback=e,this.setNeedsRedraw("transformFeedback")}setIndexBuffer(e){this.vertexArray.setIndexBuffer(e),this.setNeedsRedraw("indexBuffer")}setAttributes(e,r){const n=r?.disableWarnings??this.props.disableWarnings;e.indices&&dn.warn(`Model:${this.id} setAttributes() - indexBuffer should be set using setIndexBuffer()`)(),this.bufferLayout=OBe(this.pipeline.shaderLayout,this.bufferLayout);const i=new DI(this.bufferLayout);for(const[a,s]of Object.entries(e)){const o=i.getBufferLayout(a);if(!o){n||dn.warn(`Model(${this.id}): Missing layout for buffer "${a}".`)();continue}const u=i.getAttributeNamesForBuffer(o);let h=!1;for(const f of u){const g=this._attributeInfos[f];if(g){const b=this.device.type==="webgpu"?i.getBufferIndex(g.bufferName):g.location;this.vertexArray.setBuffer(b,s),h=!0}}!h&&!n&&dn.warn(`Model(${this.id}): Ignoring buffer "${s.id}" for unknown attribute "${a}"`)()}this.setNeedsRedraw("attributes")}setConstantAttributes(e,r){for(const[n,i]of Object.entries(e)){const a=this._attributeInfos[n];a?this.vertexArray.setConstantWebGL(a.location,i):(r?.disableWarnings??this.props.disableWarnings)||dn.warn(`Model "${this.id}: Ignoring constant supplied for unknown attribute "${n}"`)()}this.setNeedsRedraw("constants")}setUniforms(e){this.setUniformsWebGL(e)}setUniformsWebGL(e){aR(e)||(this.pipeline.setUniformsWebGL(e),Object.assign(this.uniforms,e)),this.setNeedsRedraw("uniforms")}updateModuleSettingsWebGL(e){const{bindings:r,uniforms:n}=Ite(this._getModuleUniforms(e));Object.assign(this.bindings,r),Object.assign(this.uniforms,n),this.setNeedsRedraw("moduleSettings")}_areBindingsLoading(){for(const e of Object.values(this.bindings))if(e instanceof KI&&!e.isReady)return e.id;return!1}_getBindings(){const e={};for(const[r,n]of Object.entries(this.bindings))n instanceof KI?n.isReady&&(e[r]=n.texture):e[r]=n;return e}_getBindingsUpdateTimestamp(){let e=0;for(const r of Object.values(this.bindings))r instanceof QT?e=Math.max(e,r.texture.updateTimestamp):r instanceof Oo||r instanceof yo?e=Math.max(e,r.updateTimestamp):r instanceof KI?e=r.texture?Math.max(e,r.texture.updateTimestamp):1/0:r instanceof Tb||(e=Math.max(e,r.buffer.updateTimestamp));return e}_setGeometryAttributes(e){const r={...e.attributes};for(const[n]of Object.entries(r))!this.pipeline.shaderLayout.attributes.find(i=>i.name===n)&&n!=="positions"&&delete r[n];this.vertexCount=e.vertexCount,this.setIndexBuffer(e.indices||null),this.setAttributes(e.attributes,{disableWarnings:!0}),this.setAttributes(r,{disableWarnings:this.props.disableWarnings}),this.setNeedsRedraw("geometry attributes")}_setPipelineNeedsUpdate(e){this._pipelineNeedsUpdate||=e,this.setNeedsRedraw(e)}_updatePipeline(){if(this._pipelineNeedsUpdate){let e=null,r=null;this.pipeline&&(dn.log(1,`Model ${this.id}: Recreating pipeline because "${this._pipelineNeedsUpdate}".`)(),e=this.pipeline.vs,r=this.pipeline.fs),this._pipelineNeedsUpdate=!1;const n=this.shaderFactory.createShader({id:`${this.id}-vertex`,stage:"vertex",source:this.source||this.vs,debugShaders:this.props.debugShaders});let i=null;this.source?i=n:this.fs&&(i=this.shaderFactory.createShader({id:`${this.id}-fragment`,stage:"fragment",source:this.source||this.fs,debugShaders:this.props.debugShaders})),this.pipeline=this.pipelineFactory.createRenderPipeline({...this.props,bufferLayout:this.bufferLayout,topology:this.topology,parameters:this.parameters,bindings:this._getBindings(),vs:n,fs:i}),this._attributeInfos=xee(this.pipeline.shaderLayout,this.bufferLayout),e&&this.shaderFactory.release(e),r&&this.shaderFactory.release(r)}return this.pipeline}_lastLogTime=0;_logOpen=!1;_logDrawCallStart(){const e=dn.level>3?0:tUe;dn.level<2||Date.now()-this._lastLogTime<e||(this._lastLogTime=Date.now(),this._logOpen=!0,dn.group(Dg,`>>> DRAWING MODEL ${this.id}`,{collapsed:dn.level<=2})())}_logDrawCallEnd(){if(this._logOpen){const e=G7e(this.pipeline.shaderLayout,this.id);dn.table(Dg,e)();const r=this.shaderInputs.getDebugTable();for(const[i,a]of Object.entries(this.uniforms))r[i]={value:a};dn.table(Dg,r)();const n=this._getAttributeDebugTable();dn.table(Dg,this._attributeInfos)(),dn.table(Dg,n)(),dn.groupEnd(Dg)(),this._logOpen=!1}}_drawCount=0;_logFramebuffer(e){const r=this.device.props.debugFramebuffers;if(this._drawCount++,!r)return;const n=e.props.framebuffer;n&&X7e(n,{id:n.id,minimap:!0})}_getAttributeDebugTable(){const e={};for(const[r,n]of Object.entries(this._attributeInfos)){const i=this.vertexArray.attributes[n.location];e[n.location]={name:r,type:n.shaderType,values:i?this._getBufferOrConstantValues(i,n.bufferDataType):"null"}}if(this.vertexArray.indexBuffer){const{indexBuffer:r}=this.vertexArray,n=r.indexType==="uint32"?new Uint32Array(r.debugData):new Uint16Array(r.debugData);e.indices={name:"indices",type:r.indexType,values:n.toString()}}return e}_getBufferOrConstantValues(e,r){const n=Eee(r);return(e instanceof Oo?new n(e.debugData):e).toString()}}function rUe(t){return!!(t.uniformTypes&&!aR(t.uniformTypes))}function nUe(t){return{type:t.type,shaderLanguage:t.info.shadingLanguage,shaderLanguageVersion:t.info.shadingLanguageVersion,gpu:t.info.gpu,features:t.features}}function aR(t){for(const e in t)return!1;return!0}class Nm{device;model;transformFeedback;static defaultProps={...Lm.defaultProps,outputs:void 0,feedbackBuffers:void 0};static isSupported(e){return e?.info?.type==="webgl"}constructor(e,r=Nm.defaultProps){if(!Nm.isSupported(e))throw new Error("BufferTransform not yet implemented on WebGPU");this.device=e,this.model=new Lm(this.device,{id:r.id||"buffer-transform-model",fs:r.fs||L8e(),topology:r.topology||"point-list",varyings:r.outputs||r.varyings,...r}),this.transformFeedback=this.device.createTransformFeedback({layout:this.model.pipeline.shaderLayout,buffers:r.feedbackBuffers}),this.model.setTransformFeedback(this.transformFeedback),Object.seal(this)}destroy(){this.model&&this.model.destroy()}delete(){this.destroy()}run(e){e?.inputBuffers&&this.model.setAttributes(e.inputBuffers),e?.outputBuffers&&this.transformFeedback.setBuffers(e.outputBuffers);const r=this.device.beginRenderPass(e);this.model.draw(r),r.end()}getBuffer(e){return this.transformFeedback.getBuffer(e)}readAsync(e){const r=this.getBuffer(e);if(!r)throw new Error("BufferTransform#getBuffer");if(r instanceof Oo)return r.readAsync();const{buffer:n,byteOffset:i=0,byteLength:a=n.byteLength}=r;return n.readAsync(i,a)}}class iUe{id;topology;vertexCount;indices;attributes;userData={};constructor(e){const{attributes:r={},indices:n=null,vertexCount:i=null}=e;this.id=e.id||nC("geometry"),this.topology=e.topology,n&&(this.indices=ArrayBuffer.isView(n)?{value:n,size:1}:n),this.attributes={};for(const[a,s]of Object.entries(r)){const o=ArrayBuffer.isView(s)?{value:s}:s;if(!ArrayBuffer.isView(o.value))throw new Error(`${this._print(a)}: must be typed array or object with value as typed array`);if((a==="POSITION"||a==="positions")&&!o.size&&(o.size=3),a==="indices"){if(this.indices)throw new Error("Multiple indices detected");this.indices=o}else this.attributes[a]=o}this.indices&&this.indices.isIndexed!==void 0&&(this.indices=Object.assign({},this.indices),delete this.indices.isIndexed),this.vertexCount=i||this._calculateVertexCount(this.attributes,this.indices)}getVertexCount(){return this.vertexCount}getAttributes(){return this.indices?{indices:this.indices,...this.attributes}:this.attributes}_print(e){return`Geometry ${this.id} attribute ${e}`}_setAttributes(e,r){return this}_calculateVertexCount(e,r){if(r)return r.value.length;let n=1/0;for(const i of Object.values(e)){const{value:a,size:s,constant:o}=i;!o&&a&&s!==void 0&&s>=1&&(n=Math.min(n,a.length/s))}return n}}const aUe={blendColorOperation:"add",blendColorSrcFactor:"one",blendColorDstFactor:"zero",blendAlphaOperation:"add",blendAlphaSrcFactor:"constant-alpha",blendAlphaDstFactor:"zero"};class kte extends KN{constructor(){super(...arguments),this._colorEncoderState=null}render(e){return"pickingFBO"in e?this._drawPickingBuffer(e):super.render(e)}_drawPickingBuffer({layers:e,layerFilter:r,views:n,viewports:i,onViewportActive:a,pickingFBO:s,deviceRect:{x:o,y:u,width:h,height:f},cullRect:g,effects:b,pass:v="picking",pickZ:S,shaderModuleProps:E}){this.pickZ=S;const P=this._resetColorEncoder(S),k=[o,u,h,f],L=super.render({target:s,layers:e,layerFilter:r,views:n,viewports:i,onViewportActive:a,cullRect:g,effects:b?.filter(M=>M.useInPicking),pass:v,isPicking:!0,shaderModuleProps:E,clearColor:[0,0,0,0],colorMask:15,scissorRect:k});return this._colorEncoderState=null,{decodePickingColor:P&&sUe.bind(null,P),stats:L}}shouldDrawLayer(e){const{pickable:r,operation:n}=e.props;return r&&n.includes("draw")||n.includes("terrain")||n.includes("mask")}getShaderModuleProps(e,r,n){return{picking:{isActive:1,isAttribute:this.pickZ},lighting:{enabled:!1}}}getLayerParameters(e,r,n){const i={...e.props.parameters},{pickable:a,operation:s}=e.props;return!this._colorEncoderState||s.includes("terrain")?i.blend=!1:a&&s.includes("draw")&&(Object.assign(i,aUe),i.blend=!0,i.blendColor=oUe(this._colorEncoderState,e,n)),i}_resetColorEncoder(e){return this._colorEncoderState=e?null:{byLayer:new Map,byAlpha:[]},this._colorEncoderState}}function oUe(t,e,r){const{byLayer:n,byAlpha:i}=t;let a,s=n.get(e);return s?(s.viewports.push(r),a=s.a):(a=n.size+1,a<=255?(s={a,layer:e,viewports:[r]},n.set(e,s),i[a]=s):(Za.warn("Too many pickable layers, only picking the first 255")(),a=0)),[0,0,0,a/255]}function sUe(t,e){const r=t.byAlpha[e[3]];return r&&{pickedLayer:r.layer,pickedViewports:r.viewports,pickedObjectIndex:r.layer.decodePickingColor(e)}}const _v={NO_STATE:"Awaiting state",MATCHED:"Matched. State transferred from previous layer",INITIALIZED:"Initialized",AWAITING_GC:"Discarded. Awaiting garbage collection",AWAITING_FINALIZATION:"No longer matched. Awaiting garbage collection",FINALIZED:"Finalized! Awaiting garbage collection"},wE=Symbol.for("component"),Xp=Symbol.for("propTypes"),JI=Symbol.for("deprecatedProps"),Zv=Symbol.for("asyncPropDefaults"),Dm=Symbol.for("asyncPropOriginal"),Up=Symbol.for("asyncPropResolved");function C0(t,e=()=>!0){return Array.isArray(t)?Mte(t,e,[]):e(t)?[t]:[]}function Mte(t,e,r){let n=-1;for(;++n<t.length;){const i=t[n];Array.isArray(i)?Mte(i,e,r):e(i)&&r.push(i)}return r}function lUe({target:t,source:e,start:r=0,count:n=1}){const i=e.length,a=n*i;let s=0;for(let o=r;s<i;s++)t[o++]=e[s];for(;s<a;)s<a-s?(t.copyWithin(r+s,r,r+s),s*=2):(t.copyWithin(r+s,r,r+a-s),s=a);return t}class uUe{constructor(e,r,n){this._loadCount=0,this._subscribers=new Set,this.id=e,this.context=n,this.setData(r)}subscribe(e){this._subscribers.add(e)}unsubscribe(e){this._subscribers.delete(e)}inUse(){return this._subscribers.size>0}delete(){}getData(){return this.isLoaded?this._error?Promise.reject(this._error):this._content:this._loader.then(()=>this.getData())}setData(e,r){if(e===this._data&&!r)return;this._data=e;const n=++this._loadCount;let i=e;typeof e=="string"&&(i=BM(e)),i instanceof Promise?(this.isLoaded=!1,this._loader=i.then(a=>{this._loadCount===n&&(this.isLoaded=!0,this._error=void 0,this._content=a)}).catch(a=>{this._loadCount===n&&(this.isLoaded=!0,this._error=a||!0)})):(this.isLoaded=!0,this._error=void 0,this._content=e);for(const a of this._subscribers)a.onChange(this.getData())}}class cUe{constructor(e){this.protocol=e.protocol||"resource://",this._context={device:e.device,gl:e.device?.gl,resourceManager:this},this._resources={},this._consumers={},this._pruneRequest=null}contains(e){return e.startsWith(this.protocol)?!0:e in this._resources}add({resourceId:e,data:r,forceUpdate:n=!1,persistent:i=!0}){let a=this._resources[e];a?a.setData(r,n):(a=new uUe(e,r,this._context),this._resources[e]=a),a.persistent=i}remove(e){const r=this._resources[e];r&&(r.delete(),delete this._resources[e])}unsubscribe({consumerId:e}){const r=this._consumers[e];if(r){for(const n in r){const i=r[n],a=this._resources[i.resourceId];a&&a.unsubscribe(i)}delete this._consumers[e],this.prune()}}subscribe({resourceId:e,onChange:r,consumerId:n,requestId:i="default"}){const{_resources:a,protocol:s}=this;e.startsWith(s)&&(e=e.replace(s,""),a[e]||this.add({resourceId:e,data:null,persistent:!1}));const o=a[e];if(this._track(n,i,o,r),o)return o.getData()}prune(){this._pruneRequest||(this._pruneRequest=setTimeout(()=>this._prune(),0))}finalize(){for(const e in this._resources)this._resources[e].delete()}_track(e,r,n,i){const a=this._consumers,s=a[e]=a[e]||{};let o=s[r];const u=o&&o.resourceId&&this._resources[o.resourceId];u&&(u.unsubscribe(o),this.prune()),n&&(o?(o.onChange=i,o.resourceId=n.id):o={onChange:i,resourceId:n.id},s[r]=o,n.subscribe(o))}_prune(){this._pruneRequest=null;for(const e of Object.keys(this._resources)){const r=this._resources[e];!r.persistent&&!r.inUse()&&(r.delete(),delete this._resources[e])}}}const hUe="layerManager.setLayers",fUe="layerManager.activateViewport";class dUe{constructor(e,r){this._lastRenderedLayers=[],this._needsRedraw=!1,this._needsUpdate=!1,this._nextLayers=null,this._debug=!1,this._defaultShaderModulesChanged=!1,this.activateViewport=o=>{Uu(fUe,this,o),o&&(this.context.viewport=o)};const{deck:n,stats:i,viewport:a,timeline:s}=r||{};this.layers=[],this.resourceManager=new cUe({device:e,protocol:"deck://"}),this.context={mousePosition:null,userData:{},layerManager:this,device:e,gl:e?.gl,deck:n,shaderAssembler:h7e(e?.info?.shadingLanguage||"glsl"),defaultShaderModules:[b9e],renderPass:void 0,stats:i||new ZT({id:"deck.gl"}),viewport:a||new Qm({id:"DEFAULT-INITIAL-VIEWPORT"}),timeline:s||new Cte,resourceManager:this.resourceManager,onError:void 0},Object.seal(this)}finalize(){this.resourceManager.finalize();for(const e of this.layers)this._finalizeLayer(e)}needsRedraw(e={clearRedrawFlags:!1}){let r=this._needsRedraw;e.clearRedrawFlags&&(this._needsRedraw=!1);for(const n of this.layers){const i=n.getNeedsRedraw(e);r=r||i}return r}needsUpdate(){return this._nextLayers&&this._nextLayers!==this._lastRenderedLayers?"layers changed":this._defaultShaderModulesChanged?"shader modules changed":this._needsUpdate}setNeedsRedraw(e){this._needsRedraw=this._needsRedraw||e}setNeedsUpdate(e){this._needsUpdate=this._needsUpdate||e}getLayers({layerIds:e}={}){return e?this.layers.filter(r=>e.find(n=>r.id.indexOf(n)===0)):this.layers}setProps(e){"debug"in e&&(this._debug=e.debug),"userData"in e&&(this.context.userData=e.userData),"layers"in e&&(this._nextLayers=e.layers),"onError"in e&&(this.context.onError=e.onError)}setLayers(e,r){Uu(hUe,this,r,e),this._lastRenderedLayers=e;const n=C0(e,Boolean);for(const i of n)i.context=this.context;this._updateLayers(this.layers,n)}updateLayers(){const e=this.needsUpdate();e&&(this.setNeedsRedraw(`updating layers: ${e}`),this.setLayers(this._nextLayers||this._lastRenderedLayers,e)),this._nextLayers=null}addDefaultShaderModule(e){const{defaultShaderModules:r}=this.context;r.find(n=>n.name===e.name)||(r.push(e),this._defaultShaderModulesChanged=!0)}removeDefaultShaderModule(e){const{defaultShaderModules:r}=this.context,n=r.findIndex(i=>i.name===e.name);n>=0&&(r.splice(n,1),this._defaultShaderModulesChanged=!0)}_handleError(e,r,n){n.raiseError(r,`${e} of ${n}`)}_updateLayers(e,r){const n={};for(const s of e)n[s.id]?Za.warn(`Multiple old layers with same id ${s.id}`)():n[s.id]=s;if(this._defaultShaderModulesChanged){for(const s of e)s.setNeedsUpdate(),s.setChangeFlags({extensionsChanged:!0});this._defaultShaderModulesChanged=!1}const i=[];this._updateSublayersRecursively(r,n,i),this._finalizeOldLayers(n);let a=!1;for(const s of i)if(s.hasUniformTransition()){a=`Uniform transition in ${s}`;break}this._needsUpdate=a,this.layers=i}_updateSublayersRecursively(e,r,n){for(const i of e){i.context=this.context;const a=r[i.id];a===null&&Za.warn(`Multiple new layers with same id ${i.id}`)(),r[i.id]=null;let s=null;try{this._debug&&a!==i&&i.validateProps(),a?(this._transferLayerState(a,i),this._updateLayer(i)):this._initializeLayer(i),n.push(i),s=i.isComposite?i.getSubLayers():null}catch(o){this._handleError("matching",o,i)}s&&this._updateSublayersRecursively(s,r,n)}}_finalizeOldLayers(e){for(const r in e){const n=e[r];n&&this._finalizeLayer(n)}}_initializeLayer(e){try{e._initialize(),e.lifecycle=_v.INITIALIZED}catch(r){this._handleError("initialization",r,e)}}_transferLayerState(e,r){r._transferState(e),r.lifecycle=_v.MATCHED,r!==e&&(e.lifecycle=_v.AWAITING_GC)}_updateLayer(e){try{e._update()}catch(r){this._handleError("update",r,e)}}_finalizeLayer(e){this._needsRedraw=this._needsRedraw||`finalized ${e}`,e.lifecycle=_v.AWAITING_FINALIZATION;try{e._finalize(),e.lifecycle=_v.FINALIZED}catch(r){this._handleError("finalization",r,e)}}}function vc(t,e,r){if(t===e)return!0;if(!r||!t||!e)return!1;if(Array.isArray(t)){if(!Array.isArray(e)||t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(!vc(t[n],e[n],r-1))return!1;return!0}if(Array.isArray(e))return!1;if(typeof t=="object"&&typeof e=="object"){const n=Object.keys(t),i=Object.keys(e);if(n.length!==i.length)return!1;for(const a of n)if(!e.hasOwnProperty(a)||!vc(t[a],e[a],r-1))return!1;return!0}return!1}class pUe{constructor(e){this.views=[],this.width=100,this.height=100,this.viewState={},this.controllers={},this.timeline=e.timeline,this._viewports=[],this._viewportMap={},this._isUpdating=!1,this._needsRedraw="First render",this._needsUpdate="Initialize",this._eventManager=e.eventManager,this._eventCallbacks={onViewStateChange:e.onViewStateChange,onInteractionStateChange:e.onInteractionStateChange},Object.seal(this),this.setProps(e)}finalize(){for(const e in this.controllers){const r=this.controllers[e];r&&r.finalize()}this.controllers={}}needsRedraw(e={clearRedrawFlags:!1}){const r=this._needsRedraw;return e.clearRedrawFlags&&(this._needsRedraw=!1),r}setNeedsUpdate(e){this._needsUpdate=this._needsUpdate||e,this._needsRedraw=this._needsRedraw||e}updateViewStates(){for(const e in this.controllers){const r=this.controllers[e];r&&r.updateTransition()}}getViewports(e){return e?this._viewports.filter(r=>r.containsPixel(e)):this._viewports}getViews(){const e={};return this.views.forEach(r=>{e[r.id]=r}),e}getView(e){return this.views.find(r=>r.id===e)}getViewState(e){const r=typeof e=="string"?this.getView(e):e,n=r&&this.viewState[r.getViewStateId()]||this.viewState;return r?r.filterViewState(n):n}getViewport(e){return this._viewportMap[e]}unproject(e,r){const n=this.getViewports(),i={x:e[0],y:e[1]};for(let a=n.length-1;a>=0;--a){const s=n[a];if(s.containsPixel(i)){const o=e.slice();return o[0]-=s.x,o[1]-=s.y,s.unproject(o,r)}}return null}setProps(e){e.views&&this._setViews(e.views),e.viewState&&this._setViewState(e.viewState),("width"in e||"height"in e)&&this._setSize(e.width,e.height),this._isUpdating||this._update()}_update(){this._isUpdating=!0,this._needsUpdate&&(this._needsUpdate=!1,this._rebuildViewports()),this._needsUpdate&&(this._needsUpdate=!1,this._rebuildViewports()),this._isUpdating=!1}_setSize(e,r){(e!==this.width||r!==this.height)&&(this.width=e,this.height=r,this.setNeedsUpdate("Size changed"))}_setViews(e){e=C0(e,Boolean),this._diffViews(e,this.views)&&this.setNeedsUpdate("views changed"),this.views=e}_setViewState(e){e?(!vc(e,this.viewState,3)&&this.setNeedsUpdate("viewState changed"),this.viewState=e):Za.warn("missing `viewState` or `initialViewState`")()}_createController(e,r){const n=r.type;return new n({timeline:this.timeline,eventManager:this._eventManager,onViewStateChange:this._eventCallbacks.onViewStateChange,onStateChange:this._eventCallbacks.onInteractionStateChange,makeViewport:a=>this.getView(e.id)?.makeViewport({viewState:a,width:this.width,height:this.height})})}_updateController(e,r,n,i){const a=e.controller;if(a&&n){const s={...r,...a,id:e.id,x:n.x,y:n.y,width:n.width,height:n.height};return(!i||i.constructor!==a.type)&&(i=this._createController(e,s)),i&&i.setProps(s),i}return null}_rebuildViewports(){const{views:e}=this,r=this.controllers;this._viewports=[],this.controllers={};let n=!1;for(let i=e.length;i--;){const a=e[i],s=this.getViewState(a),o=a.makeViewport({viewState:s,width:this.width,height:this.height});let u=r[a.id];const h=!!a.controller;h&&!u&&(n=!0),(n||!h)&&u&&(u.finalize(),u=null),this.controllers[a.id]=this._updateController(a,s,o,u),o&&this._viewports.unshift(o)}for(const i in r){const a=r[i];a&&!this.controllers[i]&&a.finalize()}this._buildViewportMap()}_buildViewportMap(){this._viewportMap={},this._viewports.forEach(e=>{e.id&&(this._viewportMap[e.id]=this._viewportMap[e.id]||e)})}_diffViews(e,r){return e.length!==r.length?!0:e.some((n,i)=>!e[i].equals(r[i]))}}const gUe=/([0-9]+\.?[0-9]*)(%|px)/;function Ep(t){switch(typeof t){case"number":return{position:t,relative:!1};case"string":const e=gUe.exec(t);if(e&&e.length>=3){const r=e[2]==="%",n=parseFloat(e[1]);return{position:r?n/100:n,relative:r}}default:throw new Error(`Could not parse position string ${t}`)}}function Tp(t,e){return t.relative?Math.round(t.position*e):t.position}class Rte{constructor(e){const{id:r,x:n=0,y:i=0,width:a="100%",height:s="100%",padding:o=null}=e;this.id=r||this.constructor.displayName||"view",this.props={...e,id:this.id},this._x=Ep(n),this._y=Ep(i),this._width=Ep(a),this._height=Ep(s),this._padding=o&&{left:Ep(o.left||0),right:Ep(o.right||0),top:Ep(o.top||0),bottom:Ep(o.bottom||0)},this.equals=this.equals.bind(this),Object.seal(this)}equals(e){return this===e?!0:this.constructor===e.constructor&&vc(this.props,e.props,2)}makeViewport({width:e,height:r,viewState:n}){n=this.filterViewState(n);const i=this.getDimensions({width:e,height:r});if(!i.height||!i.width)return null;const a=this.getViewportType(n);return new a({...n,...this.props,...i})}getViewStateId(){const{viewState:e}=this.props;return typeof e=="string"?e:e?.id||this.id}filterViewState(e){if(this.props.viewState&&typeof this.props.viewState=="object"){if(!this.props.viewState.id)return this.props.viewState;const r={...e};for(const n in this.props.viewState)n!=="id"&&(r[n]=this.props.viewState[n]);return r}return e}getDimensions({width:e,height:r}){const n={x:Tp(this._x,e),y:Tp(this._y,r),width:Tp(this._width,e),height:Tp(this._height,r)};return this._padding&&(n.padding={left:Tp(this._padding.left,e),top:Tp(this._padding.top,r),right:Tp(this._padding.right,e),bottom:Tp(this._padding.bottom,r)}),n}get controller(){const e=this.props.controller;return e?e===!0?{type:this.ControllerType}:typeof e=="function"?{type:e}:{type:this.ControllerType,...e}:null}}class iC{constructor(e){this._inProgress=!1,this._handle=null,this.time=0,this.settings={duration:0},this._timeline=e}get inProgress(){return this._inProgress}start(e){this.cancel(),this.settings=e,this._inProgress=!0,this.settings.onStart?.(this)}end(){this._inProgress&&(this._timeline.removeChannel(this._handle),this._handle=null,this._inProgress=!1,this.settings.onEnd?.(this))}cancel(){this._inProgress&&(this.settings.onInterrupt?.(this),this._timeline.removeChannel(this._handle),this._handle=null,this._inProgress=!1)}update(){if(!this._inProgress)return!1;if(this._handle===null){const{_timeline:e,settings:r}=this;this._handle=e.addChannel({delay:e.getTime(),duration:r.duration})}return this.time=this._timeline.getTime(this._handle),this._onUpdate(),this.settings.onUpdate?.(this),this._timeline.isFinished(this._handle)&&this.end(),!0}_onUpdate(){}}const dH=()=>{},oR={BREAK:1,SNAP_TO_END:2,IGNORE:3},mUe=t=>t,yUe=oR.BREAK;class vUe{constructor(e){this._onTransitionUpdate=r=>{const{time:n,settings:{interpolator:i,startProps:a,endProps:s,duration:o,easing:u}}=r,h=u(n/o),f=i.interpolateProps(a,s,h);this.propsInTransition=this.getControllerState({...this.props,...f}).getViewportProps(),this.onViewStateChange({viewState:this.propsInTransition,oldViewState:this.props})},this.getControllerState=e.getControllerState,this.propsInTransition=null,this.transition=new iC(e.timeline),this.onViewStateChange=e.onViewStateChange||dH,this.onStateChange=e.onStateChange||dH}finalize(){this.transition.cancel()}getViewportInTransition(){return this.propsInTransition}processViewStateChange(e){let r=!1;const n=this.props;if(this.props=e,!n||this._shouldIgnoreViewportChange(n,e))return!1;if(this._isTransitionEnabled(e)){let i=n;if(this.transition.inProgress){const{interruption:a,endProps:s}=this.transition.settings;i={...n,...a===oR.SNAP_TO_END?s:this.propsInTransition||n}}this._triggerTransition(i,e),r=!0}else this.transition.cancel();return r}updateTransition(){this.transition.update()}_isTransitionEnabled(e){const{transitionDuration:r,transitionInterpolator:n}=e;return(r>0||r==="auto")&&!!n}_isUpdateDueToCurrentTransition(e){return this.transition.inProgress&&this.propsInTransition?this.transition.settings.interpolator.arePropsEqual(e,this.propsInTransition):!1}_shouldIgnoreViewportChange(e,r){return this.transition.inProgress?this.transition.settings.interruption===oR.IGNORE||this._isUpdateDueToCurrentTransition(r):this._isTransitionEnabled(r)?r.transitionInterpolator.arePropsEqual(e,r):!0}_triggerTransition(e,r){const n=this.getControllerState(e),i=this.getControllerState(r).shortestPathFrom(n),a=r.transitionInterpolator,s=a.getDuration?a.getDuration(e,r):r.transitionDuration;if(s===0)return;const o=a.initializeProps(e,i);this.propsInTransition={};const u={duration:s,easing:r.transitionEasing||mUe,interpolator:a,interruption:r.transitionInterruption||yUe,startProps:o.start,endProps:o.end,onStart:r.onTransitionStart,onUpdate:this._onTransitionUpdate,onInterrupt:this._onTransitionEnd(r.onTransitionInterrupt),onEnd:this._onTransitionEnd(r.onTransitionEnd)};this.transition.start(u),this.onStateChange({inTransition:!0}),this.updateTransition()}_onTransitionEnd(e){return r=>{this.propsInTransition=null,this.onStateChange({inTransition:!1,isZooming:!1,isPanning:!1,isRotating:!1}),e?.(r)}}}function Rl(t,e){if(!t)throw new Error(e||"deck.gl: assertion failed.")}class _Ue{constructor(e){const{compare:r,extract:n,required:i}=e;this._propsToCompare=r,this._propsToExtract=n||r,this._requiredProps=i}arePropsEqual(e,r){for(const n of this._propsToCompare)if(!(n in e)||!(n in r)||!Ab(e[n],r[n]))return!1;return!0}initializeProps(e,r){const n={},i={};for(const a of this._propsToExtract)(a in e||a in r)&&(n[a]=e[a],i[a]=r[a]);return this._checkRequiredProps(n),this._checkRequiredProps(i),{start:n,end:i}}getDuration(e,r){return r.transitionDuration}_checkRequiredProps(e){this._requiredProps&&this._requiredProps.forEach(r=>{const n=e[r];Rl(Number.isFinite(n)||Array.isArray(n),`${r} is required for transition`)})}}const bUe=["longitude","latitude","zoom","bearing","pitch"],xUe=["longitude","latitude","zoom"];class eD extends _Ue{constructor(e={}){const r=Array.isArray(e)?e:e.transitionProps,n=Array.isArray(e)?{}:e;n.transitionProps=Array.isArray(r)?{compare:r,required:r}:r||{compare:bUe,required:xUe},super(n.transitionProps),this.opts=n}initializeProps(e,r){const n=super.initializeProps(e,r),{makeViewport:i,around:a}=this.opts;if(i&&a){const s=i(e),o=i(r),u=s.unproject(a);n.start.around=a,Object.assign(n.end,{around:o.project(u),aroundPosition:u,width:r.width,height:r.height})}return n}interpolateProps(e,r,n){const i={};for(const a of this._propsToExtract)i[a]=vE(e[a]||0,r[a]||0,n);if(r.aroundPosition&&this.opts.makeViewport){const a=this.opts.makeViewport({...r,...i});Object.assign(i,a.panByPosition(r.aroundPosition,vE(e.around,r.around,n)))}return i}}const Cp={transitionDuration:0},wUe=300,Q2=t=>1-(1-t)*(1-t),Xy={WHEEL:["wheel"],PAN:["panstart","panmove","panend"],PINCH:["pinchstart","pinchmove","pinchend"],MULTI_PAN:["multipanstart","multipanmove","multipanend"],DOUBLE_CLICK:["dblclick"],KEYBOARD:["keydown"]},Fg={};class Ote{constructor(e){this.state={},this._events={},this._interactionState={isDragging:!1},this._customEvents=[],this._eventStartBlocked=null,this._panMove=!1,this.invertPan=!1,this.dragMode="rotate",this.inertia=0,this.scrollZoom=!0,this.dragPan=!0,this.dragRotate=!0,this.doubleClickZoom=!0,this.touchZoom=!0,this.touchRotate=!1,this.keyboard=!0,this.transitionManager=new vUe({...e,getControllerState:r=>new this.ControllerState(r),onViewStateChange:this._onTransition.bind(this),onStateChange:this._setInteractionState.bind(this)}),this.handleEvent=this.handleEvent.bind(this),this.eventManager=e.eventManager,this.onViewStateChange=e.onViewStateChange||(()=>{}),this.onStateChange=e.onStateChange||(()=>{}),this.makeViewport=e.makeViewport}set events(e){this.toggleEvents(this._customEvents,!1),this.toggleEvents(e,!0),this._customEvents=e,this.props&&this.setProps(this.props)}finalize(){for(const e in this._events)this._events[e]&&this.eventManager?.off(e,this.handleEvent);this.transitionManager.finalize()}handleEvent(e){this._controllerState=void 0;const r=this._eventStartBlocked;switch(e.type){case"panstart":return r?!1:this._onPanStart(e);case"panmove":return this._onPan(e);case"panend":return this._onPanEnd(e);case"pinchstart":return r?!1:this._onPinchStart(e);case"pinchmove":return this._onPinch(e);case"pinchend":return this._onPinchEnd(e);case"multipanstart":return r?!1:this._onMultiPanStart(e);case"multipanmove":return this._onMultiPan(e);case"multipanend":return this._onMultiPanEnd(e);case"dblclick":return this._onDoubleClick(e);case"wheel":return this._onWheel(e);case"keydown":return this._onKeyDown(e);default:return!1}}get controllerState(){return this._controllerState=this._controllerState||new this.ControllerState({makeViewport:this.makeViewport,...this.props,...this.state}),this._controllerState}getCenter(e){const{x:r,y:n}=this.props,{offsetCenter:i}=e;return[i.x-r,i.y-n]}isPointInBounds(e,r){const{width:n,height:i}=this.props;if(r&&r.handled)return!1;const a=e[0]>=0&&e[0]<=n&&e[1]>=0&&e[1]<=i;return a&&r&&r.stopPropagation(),a}isFunctionKeyPressed(e){const{srcEvent:r}=e;return!!(r.metaKey||r.altKey||r.ctrlKey||r.shiftKey)}isDragging(){return this._interactionState.isDragging||!1}blockEvents(e){const r=setTimeout(()=>{this._eventStartBlocked===r&&(this._eventStartBlocked=null)},e);this._eventStartBlocked=r}setProps(e){e.dragMode&&(this.dragMode=e.dragMode),this.props=e,"transitionInterpolator"in e||(e.transitionInterpolator=this._getTransitionProps().transitionInterpolator),this.transitionManager.processViewStateChange(e);const{inertia:r}=e;this.inertia=Number.isFinite(r)?r:r===!0?wUe:0;const{scrollZoom:n=!0,dragPan:i=!0,dragRotate:a=!0,doubleClickZoom:s=!0,touchZoom:o=!0,touchRotate:u=!1,keyboard:h=!0}=e,f=!!this.onViewStateChange;this.toggleEvents(Xy.WHEEL,f&&n),this.toggleEvents(Xy.PAN,f),this.toggleEvents(Xy.PINCH,f&&(o||u)),this.toggleEvents(Xy.MULTI_PAN,f&&u),this.toggleEvents(Xy.DOUBLE_CLICK,f&&s),this.toggleEvents(Xy.KEYBOARD,f&&h),this.scrollZoom=n,this.dragPan=i,this.dragRotate=a,this.doubleClickZoom=s,this.touchZoom=o,this.touchRotate=u,this.keyboard=h}updateTransition(){this.transitionManager.updateTransition()}toggleEvents(e,r){this.eventManager&&e.forEach(n=>{this._events[n]!==r&&(this._events[n]=r,r?this.eventManager.on(n,this.handleEvent):this.eventManager.off(n,this.handleEvent))})}updateViewport(e,r=null,n={}){const i={...e.getViewportProps(),...r},a=this.controllerState!==e;if(this.state=e.getState(),this._setInteractionState(n),a){const s=this.controllerState&&this.controllerState.getViewportProps();this.onViewStateChange&&this.onViewStateChange({viewState:i,interactionState:this._interactionState,oldViewState:s,viewId:this.props.id})}}_onTransition(e){this.onViewStateChange({...e,interactionState:this._interactionState,viewId:this.props.id})}_setInteractionState(e){Object.assign(this._interactionState,e),this.onStateChange(this._interactionState)}_onPanStart(e){const r=this.getCenter(e);if(!this.isPointInBounds(r,e))return!1;let n=this.isFunctionKeyPressed(e)||e.rightButton||!1;(this.invertPan||this.dragMode==="pan")&&(n=!n);const i=this.controllerState[n?"panStart":"rotateStart"]({pos:r});return this._panMove=n,this.updateViewport(i,Cp,{isDragging:!0}),!0}_onPan(e){return this.isDragging()?this._panMove?this._onPanMove(e):this._onPanRotate(e):!1}_onPanEnd(e){return this.isDragging()?this._panMove?this._onPanMoveEnd(e):this._onPanRotateEnd(e):!1}_onPanMove(e){if(!this.dragPan)return!1;const r=this.getCenter(e),n=this.controllerState.pan({pos:r});return this.updateViewport(n,Cp,{isDragging:!0,isPanning:!0}),!0}_onPanMoveEnd(e){const{inertia:r}=this;if(this.dragPan&&r&&e.velocity){const n=this.getCenter(e),i=[n[0]+e.velocityX*r/2,n[1]+e.velocityY*r/2],a=this.controllerState.pan({pos:i}).panEnd();this.updateViewport(a,{...this._getTransitionProps(),transitionDuration:r,transitionEasing:Q2},{isDragging:!1,isPanning:!0})}else{const n=this.controllerState.panEnd();this.updateViewport(n,null,{isDragging:!1,isPanning:!1})}return!0}_onPanRotate(e){if(!this.dragRotate)return!1;const r=this.getCenter(e),n=this.controllerState.rotate({pos:r});return this.updateViewport(n,Cp,{isDragging:!0,isRotating:!0}),!0}_onPanRotateEnd(e){const{inertia:r}=this;if(this.dragRotate&&r&&e.velocity){const n=this.getCenter(e),i=[n[0]+e.velocityX*r/2,n[1]+e.velocityY*r/2],a=this.controllerState.rotate({pos:i}).rotateEnd();this.updateViewport(a,{...this._getTransitionProps(),transitionDuration:r,transitionEasing:Q2},{isDragging:!1,isRotating:!0})}else{const n=this.controllerState.rotateEnd();this.updateViewport(n,null,{isDragging:!1,isRotating:!1})}return!0}_onWheel(e){if(!this.scrollZoom)return!1;const r=this.getCenter(e);if(!this.isPointInBounds(r,e))return!1;e.srcEvent.preventDefault();const{speed:n=.01,smooth:i=!1}=this.scrollZoom===!0?{}:this.scrollZoom,{delta:a}=e;let s=2/(1+Math.exp(-Math.abs(a*n)));a<0&&s!==0&&(s=1/s);const o=this.controllerState.zoom({pos:r,scale:s});return this.updateViewport(o,{...this._getTransitionProps({around:r}),transitionDuration:i?250:1},{isZooming:!0,isPanning:!0}),!0}_onMultiPanStart(e){const r=this.getCenter(e);if(!this.isPointInBounds(r,e))return!1;const n=this.controllerState.rotateStart({pos:r});return this.updateViewport(n,Cp,{isDragging:!0}),!0}_onMultiPan(e){if(!this.touchRotate||!this.isDragging())return!1;const r=this.getCenter(e);r[0]-=e.deltaX;const n=this.controllerState.rotate({pos:r});return this.updateViewport(n,Cp,{isDragging:!0,isRotating:!0}),!0}_onMultiPanEnd(e){if(!this.isDragging())return!1;const{inertia:r}=this;if(this.touchRotate&&r&&e.velocityY){const n=this.getCenter(e),i=[n[0],n[1]+=e.velocityY*r/2],a=this.controllerState.rotate({pos:i});this.updateViewport(a,{...this._getTransitionProps(),transitionDuration:r,transitionEasing:Q2},{isDragging:!1,isRotating:!0}),this.blockEvents(r)}else{const n=this.controllerState.rotateEnd();this.updateViewport(n,null,{isDragging:!1,isRotating:!1})}return!0}_onPinchStart(e){const r=this.getCenter(e);if(!this.isPointInBounds(r,e))return!1;const n=this.controllerState.zoomStart({pos:r}).rotateStart({pos:r});return Fg._startPinchRotation=e.rotation,Fg._lastPinchEvent=e,this.updateViewport(n,Cp,{isDragging:!0}),!0}_onPinch(e){if(!this.touchZoom&&!this.touchRotate||!this.isDragging())return!1;let r=this.controllerState;if(this.touchZoom){const{scale:n}=e,i=this.getCenter(e);r=r.zoom({pos:i,scale:n})}if(this.touchRotate){const{rotation:n}=e;r=r.rotate({deltaAngleX:Fg._startPinchRotation-n})}return this.updateViewport(r,Cp,{isDragging:!0,isPanning:this.touchZoom,isZooming:this.touchZoom,isRotating:this.touchRotate}),Fg._lastPinchEvent=e,!0}_onPinchEnd(e){if(!this.isDragging())return!1;const{inertia:r}=this,{_lastPinchEvent:n}=Fg;if(this.touchZoom&&r&&n&&e.scale!==n.scale){const i=this.getCenter(e);let a=this.controllerState.rotateEnd();const s=Math.log2(e.scale),o=(s-Math.log2(n.scale))/(e.deltaTime-n.deltaTime),u=Math.pow(2,s+o*r/2);a=a.zoom({pos:i,scale:u}).zoomEnd(),this.updateViewport(a,{...this._getTransitionProps({around:i}),transitionDuration:r,transitionEasing:Q2},{isDragging:!1,isPanning:this.touchZoom,isZooming:this.touchZoom,isRotating:!1}),this.blockEvents(r)}else{const i=this.controllerState.zoomEnd().rotateEnd();this.updateViewport(i,null,{isDragging:!1,isPanning:!1,isZooming:!1,isRotating:!1})}return Fg._startPinchRotation=null,Fg._lastPinchEvent=null,!0}_onDoubleClick(e){if(!this.doubleClickZoom)return!1;const r=this.getCenter(e);if(!this.isPointInBounds(r,e))return!1;const n=this.isFunctionKeyPressed(e),i=this.controllerState.zoom({pos:r,scale:n?.5:2});return this.updateViewport(i,this._getTransitionProps({around:r}),{isZooming:!0,isPanning:!0}),this.blockEvents(100),!0}_onKeyDown(e){if(!this.keyboard)return!1;const r=this.isFunctionKeyPressed(e),{zoomSpeed:n,moveSpeed:i,rotateSpeedX:a,rotateSpeedY:s}=this.keyboard===!0?{}:this.keyboard,{controllerState:o}=this;let u;const h={};switch(e.srcEvent.code){case"Minus":u=r?o.zoomOut(n).zoomOut(n):o.zoomOut(n),h.isZooming=!0;break;case"Equal":u=r?o.zoomIn(n).zoomIn(n):o.zoomIn(n),h.isZooming=!0;break;case"ArrowLeft":r?(u=o.rotateLeft(a),h.isRotating=!0):(u=o.moveLeft(i),h.isPanning=!0);break;case"ArrowRight":r?(u=o.rotateRight(a),h.isRotating=!0):(u=o.moveRight(i),h.isPanning=!0);break;case"ArrowUp":r?(u=o.rotateUp(s),h.isRotating=!0):(u=o.moveUp(i),h.isPanning=!0);break;case"ArrowDown":r?(u=o.rotateDown(s),h.isRotating=!0):(u=o.moveDown(i),h.isPanning=!0);break;default:return!1}return this.updateViewport(u,this._getTransitionProps(),h),!0}_getTransitionProps(e){const{transition:r}=this;return!r||!r.transitionInterpolator?Cp:e?{...r,transitionInterpolator:new eD({...e,...r.transitionInterpolator.opts,makeViewport:this.controllerState.makeViewport})}:r}}class SUe{constructor(e,r){this._viewportProps=this.applyConstraints(e),this._state=r}getViewportProps(){return this._viewportProps}getState(){return this._state}}const pH=5,EUe=1.2;class Lte extends SUe{constructor(e){const{width:r,height:n,latitude:i,longitude:a,zoom:s,bearing:o=0,pitch:u=0,altitude:h=1.5,position:f=[0,0,0],maxZoom:g=20,minZoom:b=0,maxPitch:v=60,minPitch:S=0,startPanLngLat:E,startZoomLngLat:P,startRotatePos:k,startBearing:L,startPitch:O,startZoom:M,normalize:z=!0}=e;Rl(Number.isFinite(a)),Rl(Number.isFinite(i)),Rl(Number.isFinite(s)),super({width:r,height:n,latitude:i,longitude:a,zoom:s,bearing:o,pitch:u,altitude:h,maxZoom:g,minZoom:b,maxPitch:v,minPitch:S,normalize:z,position:f},{startPanLngLat:E,startZoomLngLat:P,startRotatePos:k,startBearing:L,startPitch:O,startZoom:M}),this.makeViewport=e.makeViewport}panStart({pos:e}){return this._getUpdatedState({startPanLngLat:this._unproject(e)})}pan({pos:e,startPos:r}){const n=this.getState().startPanLngLat||this._unproject(r);if(!n)return this;const a=this.makeViewport(this.getViewportProps()).panByPosition(n,e);return this._getUpdatedState(a)}panEnd(){return this._getUpdatedState({startPanLngLat:null})}rotateStart({pos:e}){return this._getUpdatedState({startRotatePos:e,startBearing:this.getViewportProps().bearing,startPitch:this.getViewportProps().pitch})}rotate({pos:e,deltaAngleX:r=0,deltaAngleY:n=0}){const{startRotatePos:i,startBearing:a,startPitch:s}=this.getState();if(!i||a===void 0||s===void 0)return this;let o;return e?o=this._getNewRotation(e,i,s,a):o={bearing:a+r,pitch:s+n},this._getUpdatedState(o)}rotateEnd(){return this._getUpdatedState({startBearing:null,startPitch:null})}zoomStart({pos:e}){return this._getUpdatedState({startZoomLngLat:this._unproject(e),startZoom:this.getViewportProps().zoom})}zoom({pos:e,startPos:r,scale:n}){let{startZoom:i,startZoomLngLat:a}=this.getState();if(a||(i=this.getViewportProps().zoom,a=this._unproject(r)||this._unproject(e)),!a)return this;const{maxZoom:s,minZoom:o}=this.getViewportProps();let u=i+Math.log2(n);u=Xf(u,o,s);const h=this.makeViewport({...this.getViewportProps(),zoom:u});return this._getUpdatedState({zoom:u,...h.panByPosition(a,e)})}zoomEnd(){return this._getUpdatedState({startZoomLngLat:null,startZoom:null})}zoomIn(e=2){return this._zoomFromCenter(e)}zoomOut(e=2){return this._zoomFromCenter(1/e)}moveLeft(e=100){return this._panFromCenter([e,0])}moveRight(e=100){return this._panFromCenter([-e,0])}moveUp(e=100){return this._panFromCenter([0,e])}moveDown(e=100){return this._panFromCenter([0,-e])}rotateLeft(e=15){return this._getUpdatedState({bearing:this.getViewportProps().bearing-e})}rotateRight(e=15){return this._getUpdatedState({bearing:this.getViewportProps().bearing+e})}rotateUp(e=10){return this._getUpdatedState({pitch:this.getViewportProps().pitch+e})}rotateDown(e=10){return this._getUpdatedState({pitch:this.getViewportProps().pitch-e})}shortestPathFrom(e){const r=e.getViewportProps(),n={...this.getViewportProps()},{bearing:i,longitude:a}=n;return Math.abs(i-r.bearing)>180&&(n.bearing=i<0?i+360:i-360),Math.abs(a-r.longitude)>180&&(n.longitude=a<0?a+360:a-360),n}applyConstraints(e){const{maxZoom:r,minZoom:n,zoom:i}=e;e.zoom=Xf(i,n,r);const{maxPitch:a,minPitch:s,pitch:o}=e;e.pitch=Xf(o,s,a);const{normalize:u=!0}=e;return u&&Object.assign(e,Xje(e)),e}_zoomFromCenter(e){const{width:r,height:n}=this.getViewportProps();return this.zoom({pos:[r/2,n/2],scale:e})}_panFromCenter(e){const{width:r,height:n}=this.getViewportProps();return this.pan({startPos:[r/2,n/2],pos:[r/2+e[0],n/2+e[1]]})}_getUpdatedState(e){return new this.constructor({makeViewport:this.makeViewport,...this.getViewportProps(),...this.getState(),...e})}_unproject(e){const r=this.makeViewport(this.getViewportProps());return e&&r.unproject(e)}_getNewRotation(e,r,n,i){const a=e[0]-r[0],s=e[1]-r[1],o=e[1],u=r[1],{width:h,height:f}=this.getViewportProps(),g=a/h;let b=0;s>0?Math.abs(f-u)>pH&&(b=s/(u-f)*EUe):s<0&&u>pH&&(b=1-o/u),b=Xf(b,-1,1);const{minPitch:v,maxPitch:S}=this.getViewportProps(),E=i+180*g;let P=n;return b>0?P=n+b*(S-n):b<0&&(P=n-b*(v-n)),{pitch:P,bearing:E}}}class TUe extends Ote{constructor(){super(...arguments),this.ControllerState=Lte,this.transition={transitionDuration:300,transitionInterpolator:new eD({transitionProps:{compare:["longitude","latitude","zoom","bearing","pitch","position"],required:["longitude","latitude","zoom"]}})},this.dragMode="pan"}setProps(e){e.position=e.position||[0,0,0];const r=this.props;super.setProps(e),(!r||r.height!==e.height)&&this.updateViewport(new this.ControllerState({makeViewport:this.makeViewport,...e,...this.state}))}}class tD extends Rte{constructor(e={}){super(e)}getViewportType(){return Om}get ControllerType(){return TUe}}tD.displayName="MapView";const CUe=new Ete;function AUe(t,e){const r=t.order??1/0,n=e.order??1/0;return r-n}class IUe{constructor(e){this._resolvedEffects=[],this._defaultEffects=[],this.effects=[],this._context=e,this._needsRedraw="Initial render",this._setEffects([])}addDefaultEffect(e){const r=this._defaultEffects;if(!r.find(n=>n.id===e.id)){const n=r.findIndex(i=>AUe(i,e)>0);n<0?r.push(e):r.splice(n,0,e),e.setup(this._context),this._setEffects(this.effects)}}setProps(e){"effects"in e&&(vc(e.effects,this.effects,1)||this._setEffects(e.effects))}needsRedraw(e={clearRedrawFlags:!1}){const r=this._needsRedraw;return e.clearRedrawFlags&&(this._needsRedraw=!1),r}getEffects(){return this._resolvedEffects}_setEffects(e){const r={};for(const i of this.effects)r[i.id]=i;const n=[];for(const i of e){const a=r[i.id];let s=i;a&&a!==i?a.setProps?(a.setProps(i.props),s=a):a.cleanup(this._context):a||i.setup(this._context),n.push(s),delete r[i.id]}for(const i in r)r[i].cleanup(this._context);this.effects=n,this._resolvedEffects=n.concat(this._defaultEffects),e.some(i=>i instanceof Ete)||this._resolvedEffects.push(CUe),this._needsRedraw="effects changed"}finalize(){for(const e of this._resolvedEffects)e.cleanup(this._context);this.effects.length=0,this._resolvedEffects.length=0,this._defaultEffects.length=0}}class PUe extends KN{shouldDrawLayer(e){const{operation:r}=e.props;return r.includes("draw")||r.includes("terrain")}}const kUe="deckRenderer.renderLayers";class MUe{constructor(e){this.device=e,this.layerFilter=null,this.drawPickingColors=!1,this.drawLayersPass=new PUe(e),this.pickLayersPass=new kte(e),this.renderCount=0,this._needsRedraw="Initial render",this.renderBuffers=[],this.lastPostProcessEffect=null}setProps(e){this.layerFilter!==e.layerFilter&&(this.layerFilter=e.layerFilter,this._needsRedraw="layerFilter changed"),this.drawPickingColors!==e.drawPickingColors&&(this.drawPickingColors=e.drawPickingColors,this._needsRedraw="drawPickingColors changed")}renderLayers(e){if(!e.viewports.length)return;const r=this.drawPickingColors?this.pickLayersPass:this.drawLayersPass,n={layerFilter:this.layerFilter,isPicking:this.drawPickingColors,...e};n.effects&&this._preRender(n.effects,n);const i=this.lastPostProcessEffect?this.renderBuffers[0]:n.target;this.lastPostProcessEffect&&(n.clearColor=[0,0,0,0],n.clearCanvas=!0);const a=r.render({...n,target:i});n.effects&&this._postRender(n.effects,n),this.renderCount++,Uu(kUe,this,a,e)}needsRedraw(e={clearRedrawFlags:!1}){const r=this._needsRedraw;return e.clearRedrawFlags&&(this._needsRedraw=!1),r}finalize(){const{renderBuffers:e}=this;for(const r of e)r.delete();e.length=0}_preRender(e,r){this.lastPostProcessEffect=null,r.preRenderStats=r.preRenderStats||{};for(const n of e)r.preRenderStats[n.id]=n.preRender(r),n.postRender&&(this.lastPostProcessEffect=n.id);this.lastPostProcessEffect&&this._resizeRenderBuffers()}_resizeRenderBuffers(){const{renderBuffers:e}=this,r=this.device.canvasContext.getDrawingBufferSize();e.length===0&&[0,1].map(n=>{const i=this.device.createTexture({sampler:{minFilter:"linear",magFilter:"linear"}});e.push(this.device.createFramebuffer({id:`deck-renderbuffer-${n}`,colorAttachments:[i]}))});for(const n of e)n.resize(r)}_postRender(e,r){const{renderBuffers:n}=this,i={...r,inputBuffer:n[0],swapBuffer:n[1]};for(const a of e)if(a.postRender){i.target=a.id===this.lastPostProcessEffect?r.target:void 0;const s=a.postRender(i);i.inputBuffer=s,i.swapBuffer=s===n[0]?n[1]:n[0]}}}const RUe={pickedColor:null,pickedObjectIndex:-1};function OUe({pickedColors:t,decodePickingColor:e,deviceX:r,deviceY:n,deviceRadius:i,deviceRect:a}){const{x:s,y:o,width:u,height:h}=a;let f=i*i,g=-1,b=0;for(let v=0;v<h;v++){const S=v+o-n,E=S*S;if(E>f)b+=4*u;else for(let P=0;P<u;P++){if(t[b+3]-1>=0){const L=P+s-r,O=L*L+E;O<=f&&(f=O,g=b)}b+=4}}if(g>=0){const v=t.slice(g,g+4),S=e(v);if(S){const E=Math.floor(g/4/u),P=g/4-E*u;return{...S,pickedColor:v,pickedX:s+P,pickedY:o+E}}Za.error("Picked non-existent layer. Is picking buffer corrupt?")()}return RUe}function LUe({pickedColors:t,decodePickingColor:e}){const r=new Map;if(t){for(let n=0;n<t.length;n+=4)if(t[n+3]-1>=0){const a=t.slice(n,n+4),s=a.join(",");if(!r.has(s)){const o=e(a);o?r.set(s,{...o,color:a}):Za.error("Picked non-existent layer. Is picking buffer corrupt?")()}}}return Array.from(r.values())}function Nte({pickInfo:t,viewports:e,pixelRatio:r,x:n,y:i,z:a}){let s=e[0];e.length>1&&(s=DUe(t?.pickedViewports||e,{x:n,y:i}));let o;if(s){const u=[n-s.x,i-s.y];a!==void 0&&(u[2]=a),o=s.unproject(u)}return{color:null,layer:null,viewport:s,index:-1,picked:!1,x:n,y:i,pixel:[n,i],coordinate:o,devicePixel:t&&"pickedX"in t?[t.pickedX,t.pickedY]:void 0,pixelRatio:r}}function NUe(t){const{pickInfo:e,lastPickedInfo:r,mode:n,layers:i}=t,{pickedColor:a,pickedLayer:s,pickedObjectIndex:o}=e,u=s?[s]:[];if(n==="hover"){const g=r.index,b=r.layerId,v=s?s.props.id:null;if(v!==b||o!==g){if(v!==b){const S=i.find(E=>E.props.id===b);S&&u.unshift(S)}r.layerId=v,r.index=o,r.info=null}}const h=Nte(t),f=new Map;return f.set(null,h),u.forEach(g=>{let b={...h};g===s&&(b.color=a,b.index=o,b.picked=!0),b=Dte({layer:g,info:b,mode:n});const v=b.layer;g===s&&n==="hover"&&(r.info=b),f.set(v.id,b),n==="hover"&&v.updateAutoHighlight(b)}),f}function Dte({layer:t,info:e,mode:r}){for(;t&&e;){const n=e.layer||null;e.sourceLayer=n,e.layer=t,e=t.getPickingInfo({info:e,mode:r,sourceLayer:n}),t=t.parent}return e}function DUe(t,e){for(let r=t.length-1;r>=0;r--){const n=t[r];if(n.containsPixel(e))return n}return t[0]}class FUe{constructor(e){this._pickable=!0,this.device=e,this.pickLayersPass=new kte(e),this.lastPickedInfo={index:-1,layerId:null,info:null}}setProps(e){"layerFilter"in e&&(this.layerFilter=e.layerFilter),"_pickable"in e&&(this._pickable=e._pickable)}finalize(){this.pickingFBO&&this.pickingFBO.destroy(),this.depthFBO&&this.depthFBO.destroy()}pickObject(e){return this._pickClosestObject(e)}pickObjects(e){return this._pickVisibleObjects(e)}getLastPickedObject({x:e,y:r,layers:n,viewports:i},a=this.lastPickedInfo.info){const s=a&&a.layer&&a.layer.id,o=a&&a.viewport&&a.viewport.id,u=s?n.find(b=>b.id===s):null,h=o&&i.find(b=>b.id===o)||i[0],f=h&&h.unproject([e-h.x,r-h.y]);return{...a,...{x:e,y:r,viewport:h,coordinate:f,layer:u}}}_resizeBuffer(){if(!this.pickingFBO&&(this.pickingFBO=this.device.createFramebuffer({colorAttachments:["rgba8unorm"],depthStencilAttachment:"depth16unorm"}),this.device.isTextureFormatRenderable("rgba32float"))){const r=this.device.createFramebuffer({colorAttachments:["rgba32float"],depthStencilAttachment:"depth16unorm"});this.depthFBO=r}const{canvas:e}=this.device.getDefaultCanvasContext();this.pickingFBO?.resize({width:e.width,height:e.height}),this.depthFBO?.resize({width:e.width,height:e.height})}_getPickable(e){if(this._pickable===!1)return null;const r=e.filter(n=>this.pickLayersPass.shouldDrawLayer(n)&&!n.isComposite);return r.length?r:null}_pickClosestObject({layers:e,views:r,viewports:n,x:i,y:a,radius:s=0,depth:o=1,mode:u="query",unproject3D:h,onViewportActive:f,effects:g}){const b=this.device.canvasContext.cssToDeviceRatio(),v=this._getPickable(e);if(!v||n.length===0)return{result:[],emptyInfo:Nte({viewports:n,x:i,y:a,pixelRatio:b})};this._resizeBuffer();const S=this.device.canvasContext.cssToDevicePixels([i,a],!0),E=[S.x+Math.floor(S.width/2),S.y+Math.floor(S.height/2)],P=Math.round(s*b),{width:k,height:L}=this.pickingFBO,O=this._getPickingRect({deviceX:E[0],deviceY:E[1],deviceRadius:P,deviceWidth:k,deviceHeight:L}),M={x:i-s,y:a-s,width:s*2+1,height:s*2+1};let z;const B=[],q=new Set;for(let W=0;W<o;W++){let G;if(O){const Q=this._drawAndSample({layers:v,views:r,viewports:n,onViewportActive:f,deviceRect:O,cullRect:M,effects:g,pass:`picking:${u}`});G=OUe({...Q,deviceX:E[0],deviceY:E[1],deviceRadius:P,deviceRect:O})}else G={pickedColor:null,pickedObjectIndex:-1};let ie;if(G.pickedLayer&&h&&this.depthFBO){const{pickedColors:Q}=this._drawAndSample({layers:[G.pickedLayer],views:r,viewports:n,onViewportActive:f,deviceRect:{x:G.pickedX,y:G.pickedY,width:1,height:1},cullRect:M,effects:g,pass:`picking:${u}:z`},!0);Q[3]&&(ie=Q[0])}G.pickedLayer&&W+1<o&&(q.add(G.pickedLayer),G.pickedLayer.disablePickingIndex(G.pickedObjectIndex)),z=NUe({pickInfo:G,lastPickedInfo:this.lastPickedInfo,mode:u,layers:v,viewports:n,x:i,y:a,z:ie,pixelRatio:b});for(const Q of z.values())Q.layer&&B.push(Q);if(!G.pickedColor)break}for(const W of q)W.restorePickingColors();return{result:B,emptyInfo:z.get(null)}}_pickVisibleObjects({layers:e,views:r,viewports:n,x:i,y:a,width:s=1,height:o=1,mode:u="query",maxObjects:h=null,onViewportActive:f,effects:g}){const b=this._getPickable(e);if(!b||n.length===0)return[];this._resizeBuffer();const v=this.device.canvasContext.cssToDeviceRatio(),S=this.device.canvasContext.cssToDevicePixels([i,a],!0),E=S.x,P=S.y+S.height,k=this.device.canvasContext.cssToDevicePixels([i+s,a+o],!0),L=k.x+k.width,O=k.y,M={x:E,y:O,width:L-E,height:P-O},z=this._drawAndSample({layers:b,views:r,viewports:n,onViewportActive:f,deviceRect:M,cullRect:{x:i,y:a,width:s,height:o},effects:g,pass:`picking:${u}`}),B=LUe(z),q=new Map,W=[],G=Number.isFinite(h);for(let ie=0;ie<B.length&&!(G&&W.length>=h);ie++){const Q=B[ie];let H={color:Q.pickedColor,layer:null,index:Q.pickedObjectIndex,picked:!0,x:i,y:a,pixelRatio:v};H=Dte({layer:Q.pickedLayer,info:H,mode:u});const ne=H.layer.id;q.has(ne)||q.set(ne,new Set);const oe=q.get(ne),ce=H.object??H.index;oe.has(ce)||(oe.add(ce),W.push(H))}return W}_drawAndSample({layers:e,views:r,viewports:n,onViewportActive:i,deviceRect:a,cullRect:s,effects:o,pass:u},h=!1){const f=h?this.depthFBO:this.pickingFBO,g={layers:e,layerFilter:this.layerFilter,views:r,viewports:n,onViewportActive:i,pickingFBO:f,deviceRect:a,cullRect:s,effects:o,pass:u,pickZ:h,preRenderStats:{},isPicking:!0};for(const L of o)L.useInPicking&&(g.preRenderStats[L.id]=L.preRender(g));const{decodePickingColor:b}=this.pickLayersPass.render(g),{x:v,y:S,width:E,height:P}=a,k=new(h?Float32Array:Uint8Array)(E*P*4);return this.device.readPixelsToArrayWebGL(f,{sourceX:v,sourceY:S,sourceWidth:E,sourceHeight:P,target:k}),{pickedColors:k,decodePickingColor:b}}_getPickingRect({deviceX:e,deviceY:r,deviceRadius:n,deviceWidth:i,deviceHeight:a}){const s=Math.max(0,e-n),o=Math.max(0,r-n),u=Math.min(i,e+n+1)-s,h=Math.min(a,r+n+1)-o;return u<=0||h<=0?null:{x:s,y:o,width:u,height:h}}}const BUe={"top-left":{top:0,left:0},"top-right":{top:0,right:0},"bottom-left":{bottom:0,left:0},"bottom-right":{bottom:0,right:0},fill:{top:0,left:0,bottom:0,right:0}},zUe="top-left",gH="__root";class jUe{constructor({deck:e,parentElement:r}){this.defaultWidgets=[],this.widgets=[],this.resolvedWidgets=[],this.containers={},this.lastViewports={},this.deck=e,this.parentElement=r}getWidgets(){return this.resolvedWidgets}setProps(e){e.widgets&&!vc(e.widgets,this.widgets,1)&&this._setWidgets(e.widgets)}finalize(){for(const e of this.getWidgets())this._remove(e);this.defaultWidgets.length=0,this.resolvedWidgets.length=0;for(const e in this.containers)this.containers[e].remove()}addDefault(e){this.defaultWidgets.find(r=>r.id===e.id)||(this._add(e),this.defaultWidgets.push(e),this._setWidgets(this.widgets))}_setWidgets(e){const r={};for(const n of this.resolvedWidgets)r[n.id]=n;this.resolvedWidgets.length=0;for(const n of this.defaultWidgets)r[n.id]=null,this.resolvedWidgets.push(n);for(let n of e){const i=r[n.id];i?i.viewId!==n.viewId||i.placement!==n.placement?(this._remove(i),this._add(n)):n!==i&&(i.setProps(n.props),n=i):this._add(n),r[n.id]=null,this.resolvedWidgets.push(n)}for(const n in r){const i=r[n];i&&this._remove(i)}this.widgets=e}_add(e){const{viewId:r=null,placement:n=zUe}=e,i=e.onAdd({deck:this.deck,viewId:r});i&&this._getContainer(r,n).append(i),e._element=i}_remove(e){e.onRemove?.(),e._element&&e._element.remove(),e._element=void 0}_getContainer(e,r){const n=e||gH;let i=this.containers[n];i||(i=document.createElement("div"),i.style.pointerEvents="none",i.style.position="absolute",i.style.overflow="hidden",this.parentElement?.append(i),this.containers[n]=i);let a=i.querySelector(`.${r}`);return a||(a=document.createElement("div"),a.className=r,a.style.position="absolute",a.style.zIndex="2",Object.assign(a.style,BUe[r]),i.append(a)),a}_updateContainers(){const e=this.deck.width,r=this.deck.height;for(const n in this.containers){const i=this.lastViewports[n]||null,a=n===gH||i,s=this.containers[n];a?(s.style.display="block",s.style.left=`${i?i.x:0}px`,s.style.top=`${i?i.y:0}px`,s.style.width=`${i?i.width:e}px`,s.style.height=`${i?i.height:r}px`):s.style.display="none"}}onRedraw({viewports:e,layers:r}){const n=e.reduce((i,a)=>(i[a.id]=a,i),{});for(const i of this.getWidgets()){const{viewId:a}=i;if(a){const s=n[a];s&&(i.onViewportChange&&i.onViewportChange(s),i.onRedraw?.({viewports:[s],layers:r}))}else{if(i.onViewportChange)for(const s of e)i.onViewportChange(s);i.onRedraw?.({viewports:e,layers:r})}}this.lastViewports=n,this._updateContainers()}onHover(e,r){for(const n of this.getWidgets()){const{viewId:i}=n;(!i||i===e.viewport?.id)&&n.onHover?.(e,r)}}onEvent(e,r){const n=eR[r.type];if(n)for(const i of this.getWidgets()){const{viewId:a}=i;(!a||a===e.viewport?.id)&&i[n]?.(e,r)}}}const UUe={zIndex:"1",position:"absolute",pointerEvents:"none",color:"#a0a7b4",backgroundColor:"#29323c",padding:"10px",top:"0",left:"0",display:"none"};class VUe{constructor(){this.id="default-tooltip",this.placement="fill",this.props={},this.isVisible=!1}onAdd({deck:e}){const r=document.createElement("div");return r.className="deck-tooltip",Object.assign(r.style,UUe),this.deck=e,this.element=r,r}onRemove(){this.deck=void 0,this.element=void 0}setProps(){}onViewportChange(e){this.isVisible&&e.id===this.lastViewport?.id&&e!==this.lastViewport&&this.setTooltip(null)}onHover(e){const{deck:r}=this,n=r&&r.props.getTooltip;if(!n)return;const i=n(e);this.lastViewport=e.viewport,this.setTooltip(i,e.x,e.y)}setTooltip(e,r,n){const i=this.element;if(i){if(typeof e=="string")i.innerText=e;else if(e)e.text&&(i.innerText=e.text),e.html&&(i.innerHTML=e.html),e.className&&(i.className=e.className);else{this.isVisible=!1,i.style.display="none";return}this.isVisible=!0,i.style.display="block",i.style.transform=`translate(${r}px, ${n}px)`,e&&typeof e=="object"&&"style"in e&&Object.assign(i.style,e.style)}}}var Rv;(function(t){t[t.DEPTH_BUFFER_BIT=256]="DEPTH_BUFFER_BIT",t[t.STENCIL_BUFFER_BIT=1024]="STENCIL_BUFFER_BIT",t[t.COLOR_BUFFER_BIT=16384]="COLOR_BUFFER_BIT",t[t.POINTS=0]="POINTS",t[t.LINES=1]="LINES",t[t.LINE_LOOP=2]="LINE_LOOP",t[t.LINE_STRIP=3]="LINE_STRIP",t[t.TRIANGLES=4]="TRIANGLES",t[t.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",t[t.TRIANGLE_FAN=6]="TRIANGLE_FAN",t[t.ZERO=0]="ZERO",t[t.ONE=1]="ONE",t[t.SRC_COLOR=768]="SRC_COLOR",t[t.ONE_MINUS_SRC_COLOR=769]="ONE_MINUS_SRC_COLOR",t[t.SRC_ALPHA=770]="SRC_ALPHA",t[t.ONE_MINUS_SRC_ALPHA=771]="ONE_MINUS_SRC_ALPHA",t[t.DST_ALPHA=772]="DST_ALPHA",t[t.ONE_MINUS_DST_ALPHA=773]="ONE_MINUS_DST_ALPHA",t[t.DST_COLOR=774]="DST_COLOR",t[t.ONE_MINUS_DST_COLOR=775]="ONE_MINUS_DST_COLOR",t[t.SRC_ALPHA_SATURATE=776]="SRC_ALPHA_SATURATE",t[t.CONSTANT_COLOR=32769]="CONSTANT_COLOR",t[t.ONE_MINUS_CONSTANT_COLOR=32770]="ONE_MINUS_CONSTANT_COLOR",t[t.CONSTANT_ALPHA=32771]="CONSTANT_ALPHA",t[t.ONE_MINUS_CONSTANT_ALPHA=32772]="ONE_MINUS_CONSTANT_ALPHA",t[t.FUNC_ADD=32774]="FUNC_ADD",t[t.FUNC_SUBTRACT=32778]="FUNC_SUBTRACT",t[t.FUNC_REVERSE_SUBTRACT=32779]="FUNC_REVERSE_SUBTRACT",t[t.BLEND_EQUATION=32777]="BLEND_EQUATION",t[t.BLEND_EQUATION_RGB=32777]="BLEND_EQUATION_RGB",t[t.BLEND_EQUATION_ALPHA=34877]="BLEND_EQUATION_ALPHA",t[t.BLEND_DST_RGB=32968]="BLEND_DST_RGB",t[t.BLEND_SRC_RGB=32969]="BLEND_SRC_RGB",t[t.BLEND_DST_ALPHA=32970]="BLEND_DST_ALPHA",t[t.BLEND_SRC_ALPHA=32971]="BLEND_SRC_ALPHA",t[t.BLEND_COLOR=32773]="BLEND_COLOR",t[t.ARRAY_BUFFER_BINDING=34964]="ARRAY_BUFFER_BINDING",t[t.ELEMENT_ARRAY_BUFFER_BINDING=34965]="ELEMENT_ARRAY_BUFFER_BINDING",t[t.LINE_WIDTH=2849]="LINE_WIDTH",t[t.ALIASED_POINT_SIZE_RANGE=33901]="ALIASED_POINT_SIZE_RANGE",t[t.ALIASED_LINE_WIDTH_RANGE=33902]="ALIASED_LINE_WIDTH_RANGE",t[t.CULL_FACE_MODE=2885]="CULL_FACE_MODE",t[t.FRONT_FACE=2886]="FRONT_FACE",t[t.DEPTH_RANGE=2928]="DEPTH_RANGE",t[t.DEPTH_WRITEMASK=2930]="DEPTH_WRITEMASK",t[t.DEPTH_CLEAR_VALUE=2931]="DEPTH_CLEAR_VALUE",t[t.DEPTH_FUNC=2932]="DEPTH_FUNC",t[t.STENCIL_CLEAR_VALUE=2961]="STENCIL_CLEAR_VALUE",t[t.STENCIL_FUNC=2962]="STENCIL_FUNC",t[t.STENCIL_FAIL=2964]="STENCIL_FAIL",t[t.STENCIL_PASS_DEPTH_FAIL=2965]="STENCIL_PASS_DEPTH_FAIL",t[t.STENCIL_PASS_DEPTH_PASS=2966]="STENCIL_PASS_DEPTH_PASS",t[t.STENCIL_REF=2967]="STENCIL_REF",t[t.STENCIL_VALUE_MASK=2963]="STENCIL_VALUE_MASK",t[t.STENCIL_WRITEMASK=2968]="STENCIL_WRITEMASK",t[t.STENCIL_BACK_FUNC=34816]="STENCIL_BACK_FUNC",t[t.STENCIL_BACK_FAIL=34817]="STENCIL_BACK_FAIL",t[t.STENCIL_BACK_PASS_DEPTH_FAIL=34818]="STENCIL_BACK_PASS_DEPTH_FAIL",t[t.STENCIL_BACK_PASS_DEPTH_PASS=34819]="STENCIL_BACK_PASS_DEPTH_PASS",t[t.STENCIL_BACK_REF=36003]="STENCIL_BACK_REF",t[t.STENCIL_BACK_VALUE_MASK=36004]="STENCIL_BACK_VALUE_MASK",t[t.STENCIL_BACK_WRITEMASK=36005]="STENCIL_BACK_WRITEMASK",t[t.VIEWPORT=2978]="VIEWPORT",t[t.SCISSOR_BOX=3088]="SCISSOR_BOX",t[t.COLOR_CLEAR_VALUE=3106]="COLOR_CLEAR_VALUE",t[t.COLOR_WRITEMASK=3107]="COLOR_WRITEMASK",t[t.UNPACK_ALIGNMENT=3317]="UNPACK_ALIGNMENT",t[t.PACK_ALIGNMENT=3333]="PACK_ALIGNMENT",t[t.MAX_TEXTURE_SIZE=3379]="MAX_TEXTURE_SIZE",t[t.MAX_VIEWPORT_DIMS=3386]="MAX_VIEWPORT_DIMS",t[t.SUBPIXEL_BITS=3408]="SUBPIXEL_BITS",t[t.RED_BITS=3410]="RED_BITS",t[t.GREEN_BITS=3411]="GREEN_BITS",t[t.BLUE_BITS=3412]="BLUE_BITS",t[t.ALPHA_BITS=3413]="ALPHA_BITS",t[t.DEPTH_BITS=3414]="DEPTH_BITS",t[t.STENCIL_BITS=3415]="STENCIL_BITS",t[t.POLYGON_OFFSET_UNITS=10752]="POLYGON_OFFSET_UNITS",t[t.POLYGON_OFFSET_FACTOR=32824]="POLYGON_OFFSET_FACTOR",t[t.TEXTURE_BINDING_2D=32873]="TEXTURE_BINDING_2D",t[t.SAMPLE_BUFFERS=32936]="SAMPLE_BUFFERS",t[t.SAMPLES=32937]="SAMPLES",t[t.SAMPLE_COVERAGE_VALUE=32938]="SAMPLE_COVERAGE_VALUE",t[t.SAMPLE_COVERAGE_INVERT=32939]="SAMPLE_COVERAGE_INVERT",t[t.COMPRESSED_TEXTURE_FORMATS=34467]="COMPRESSED_TEXTURE_FORMATS",t[t.VENDOR=7936]="VENDOR",t[t.RENDERER=7937]="RENDERER",t[t.VERSION=7938]="VERSION",t[t.IMPLEMENTATION_COLOR_READ_TYPE=35738]="IMPLEMENTATION_COLOR_READ_TYPE",t[t.IMPLEMENTATION_COLOR_READ_FORMAT=35739]="IMPLEMENTATION_COLOR_READ_FORMAT",t[t.BROWSER_DEFAULT_WEBGL=37444]="BROWSER_DEFAULT_WEBGL",t[t.STATIC_DRAW=35044]="STATIC_DRAW",t[t.STREAM_DRAW=35040]="STREAM_DRAW",t[t.DYNAMIC_DRAW=35048]="DYNAMIC_DRAW",t[t.ARRAY_BUFFER=34962]="ARRAY_BUFFER",t[t.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",t[t.BUFFER_SIZE=34660]="BUFFER_SIZE",t[t.BUFFER_USAGE=34661]="BUFFER_USAGE",t[t.CURRENT_VERTEX_ATTRIB=34342]="CURRENT_VERTEX_ATTRIB",t[t.VERTEX_ATTRIB_ARRAY_ENABLED=34338]="VERTEX_ATTRIB_ARRAY_ENABLED",t[t.VERTEX_ATTRIB_ARRAY_SIZE=34339]="VERTEX_ATTRIB_ARRAY_SIZE",t[t.VERTEX_ATTRIB_ARRAY_STRIDE=34340]="VERTEX_ATTRIB_ARRAY_STRIDE",t[t.VERTEX_ATTRIB_ARRAY_TYPE=34341]="VERTEX_ATTRIB_ARRAY_TYPE",t[t.VERTEX_ATTRIB_ARRAY_NORMALIZED=34922]="VERTEX_ATTRIB_ARRAY_NORMALIZED",t[t.VERTEX_ATTRIB_ARRAY_POINTER=34373]="VERTEX_ATTRIB_ARRAY_POINTER",t[t.VERTEX_ATTRIB_ARRAY_BUFFER_BINDING=34975]="VERTEX_ATTRIB_ARRAY_BUFFER_BINDING",t[t.CULL_FACE=2884]="CULL_FACE",t[t.FRONT=1028]="FRONT",t[t.BACK=1029]="BACK",t[t.FRONT_AND_BACK=1032]="FRONT_AND_BACK",t[t.BLEND=3042]="BLEND",t[t.DEPTH_TEST=2929]="DEPTH_TEST",t[t.DITHER=3024]="DITHER",t[t.POLYGON_OFFSET_FILL=32823]="POLYGON_OFFSET_FILL",t[t.SAMPLE_ALPHA_TO_COVERAGE=32926]="SAMPLE_ALPHA_TO_COVERAGE",t[t.SAMPLE_COVERAGE=32928]="SAMPLE_COVERAGE",t[t.SCISSOR_TEST=3089]="SCISSOR_TEST",t[t.STENCIL_TEST=2960]="STENCIL_TEST",t[t.NO_ERROR=0]="NO_ERROR",t[t.INVALID_ENUM=1280]="INVALID_ENUM",t[t.INVALID_VALUE=1281]="INVALID_VALUE",t[t.INVALID_OPERATION=1282]="INVALID_OPERATION",t[t.OUT_OF_MEMORY=1285]="OUT_OF_MEMORY",t[t.CONTEXT_LOST_WEBGL=37442]="CONTEXT_LOST_WEBGL",t[t.CW=2304]="CW",t[t.CCW=2305]="CCW",t[t.DONT_CARE=4352]="DONT_CARE",t[t.FASTEST=4353]="FASTEST",t[t.NICEST=4354]="NICEST",t[t.GENERATE_MIPMAP_HINT=33170]="GENERATE_MIPMAP_HINT",t[t.BYTE=5120]="BYTE",t[t.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",t[t.SHORT=5122]="SHORT",t[t.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",t[t.INT=5124]="INT",t[t.UNSIGNED_INT=5125]="UNSIGNED_INT",t[t.FLOAT=5126]="FLOAT",t[t.DOUBLE=5130]="DOUBLE",t[t.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",t[t.ALPHA=6406]="ALPHA",t[t.RGB=6407]="RGB",t[t.RGBA=6408]="RGBA",t[t.LUMINANCE=6409]="LUMINANCE",t[t.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",t[t.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",t[t.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",t[t.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",t[t.FRAGMENT_SHADER=35632]="FRAGMENT_SHADER",t[t.VERTEX_SHADER=35633]="VERTEX_SHADER",t[t.COMPILE_STATUS=35713]="COMPILE_STATUS",t[t.DELETE_STATUS=35712]="DELETE_STATUS",t[t.LINK_STATUS=35714]="LINK_STATUS",t[t.VALIDATE_STATUS=35715]="VALIDATE_STATUS",t[t.ATTACHED_SHADERS=35717]="ATTACHED_SHADERS",t[t.ACTIVE_ATTRIBUTES=35721]="ACTIVE_ATTRIBUTES",t[t.ACTIVE_UNIFORMS=35718]="ACTIVE_UNIFORMS",t[t.MAX_VERTEX_ATTRIBS=34921]="MAX_VERTEX_ATTRIBS",t[t.MAX_VERTEX_UNIFORM_VECTORS=36347]="MAX_VERTEX_UNIFORM_VECTORS",t[t.MAX_VARYING_VECTORS=36348]="MAX_VARYING_VECTORS",t[t.MAX_COMBINED_TEXTURE_IMAGE_UNITS=35661]="MAX_COMBINED_TEXTURE_IMAGE_UNITS",t[t.MAX_VERTEX_TEXTURE_IMAGE_UNITS=35660]="MAX_VERTEX_TEXTURE_IMAGE_UNITS",t[t.MAX_TEXTURE_IMAGE_UNITS=34930]="MAX_TEXTURE_IMAGE_UNITS",t[t.MAX_FRAGMENT_UNIFORM_VECTORS=36349]="MAX_FRAGMENT_UNIFORM_VECTORS",t[t.SHADER_TYPE=35663]="SHADER_TYPE",t[t.SHADING_LANGUAGE_VERSION=35724]="SHADING_LANGUAGE_VERSION",t[t.CURRENT_PROGRAM=35725]="CURRENT_PROGRAM",t[t.NEVER=512]="NEVER",t[t.LESS=513]="LESS",t[t.EQUAL=514]="EQUAL",t[t.LEQUAL=515]="LEQUAL",t[t.GREATER=516]="GREATER",t[t.NOTEQUAL=517]="NOTEQUAL",t[t.GEQUAL=518]="GEQUAL",t[t.ALWAYS=519]="ALWAYS",t[t.KEEP=7680]="KEEP",t[t.REPLACE=7681]="REPLACE",t[t.INCR=7682]="INCR",t[t.DECR=7683]="DECR",t[t.INVERT=5386]="INVERT",t[t.INCR_WRAP=34055]="INCR_WRAP",t[t.DECR_WRAP=34056]="DECR_WRAP",t[t.NEAREST=9728]="NEAREST",t[t.LINEAR=9729]="LINEAR",t[t.NEAREST_MIPMAP_NEAREST=9984]="NEAREST_MIPMAP_NEAREST",t[t.LINEAR_MIPMAP_NEAREST=9985]="LINEAR_MIPMAP_NEAREST",t[t.NEAREST_MIPMAP_LINEAR=9986]="NEAREST_MIPMAP_LINEAR",t[t.LINEAR_MIPMAP_LINEAR=9987]="LINEAR_MIPMAP_LINEAR",t[t.TEXTURE_MAG_FILTER=10240]="TEXTURE_MAG_FILTER",t[t.TEXTURE_MIN_FILTER=10241]="TEXTURE_MIN_FILTER",t[t.TEXTURE_WRAP_S=10242]="TEXTURE_WRAP_S",t[t.TEXTURE_WRAP_T=10243]="TEXTURE_WRAP_T",t[t.TEXTURE_2D=3553]="TEXTURE_2D",t[t.TEXTURE=5890]="TEXTURE",t[t.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",t[t.TEXTURE_BINDING_CUBE_MAP=34068]="TEXTURE_BINDING_CUBE_MAP",t[t.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",t[t.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",t[t.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",t[t.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",t[t.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",t[t.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z",t[t.MAX_CUBE_MAP_TEXTURE_SIZE=34076]="MAX_CUBE_MAP_TEXTURE_SIZE",t[t.TEXTURE0=33984]="TEXTURE0",t[t.ACTIVE_TEXTURE=34016]="ACTIVE_TEXTURE",t[t.REPEAT=10497]="REPEAT",t[t.CLAMP_TO_EDGE=33071]="CLAMP_TO_EDGE",t[t.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT",t[t.TEXTURE_WIDTH=4096]="TEXTURE_WIDTH",t[t.TEXTURE_HEIGHT=4097]="TEXTURE_HEIGHT",t[t.FLOAT_VEC2=35664]="FLOAT_VEC2",t[t.FLOAT_VEC3=35665]="FLOAT_VEC3",t[t.FLOAT_VEC4=35666]="FLOAT_VEC4",t[t.INT_VEC2=35667]="INT_VEC2",t[t.INT_VEC3=35668]="INT_VEC3",t[t.INT_VEC4=35669]="INT_VEC4",t[t.BOOL=35670]="BOOL",t[t.BOOL_VEC2=35671]="BOOL_VEC2",t[t.BOOL_VEC3=35672]="BOOL_VEC3",t[t.BOOL_VEC4=35673]="BOOL_VEC4",t[t.FLOAT_MAT2=35674]="FLOAT_MAT2",t[t.FLOAT_MAT3=35675]="FLOAT_MAT3",t[t.FLOAT_MAT4=35676]="FLOAT_MAT4",t[t.SAMPLER_2D=35678]="SAMPLER_2D",t[t.SAMPLER_CUBE=35680]="SAMPLER_CUBE",t[t.LOW_FLOAT=36336]="LOW_FLOAT",t[t.MEDIUM_FLOAT=36337]="MEDIUM_FLOAT",t[t.HIGH_FLOAT=36338]="HIGH_FLOAT",t[t.LOW_INT=36339]="LOW_INT",t[t.MEDIUM_INT=36340]="MEDIUM_INT",t[t.HIGH_INT=36341]="HIGH_INT",t[t.FRAMEBUFFER=36160]="FRAMEBUFFER",t[t.RENDERBUFFER=36161]="RENDERBUFFER",t[t.RGBA4=32854]="RGBA4",t[t.RGB5_A1=32855]="RGB5_A1",t[t.RGB565=36194]="RGB565",t[t.DEPTH_COMPONENT16=33189]="DEPTH_COMPONENT16",t[t.STENCIL_INDEX=6401]="STENCIL_INDEX",t[t.STENCIL_INDEX8=36168]="STENCIL_INDEX8",t[t.DEPTH_STENCIL=34041]="DEPTH_STENCIL",t[t.RENDERBUFFER_WIDTH=36162]="RENDERBUFFER_WIDTH",t[t.RENDERBUFFER_HEIGHT=36163]="RENDERBUFFER_HEIGHT",t[t.RENDERBUFFER_INTERNAL_FORMAT=36164]="RENDERBUFFER_INTERNAL_FORMAT",t[t.RENDERBUFFER_RED_SIZE=36176]="RENDERBUFFER_RED_SIZE",t[t.RENDERBUFFER_GREEN_SIZE=36177]="RENDERBUFFER_GREEN_SIZE",t[t.RENDERBUFFER_BLUE_SIZE=36178]="RENDERBUFFER_BLUE_SIZE",t[t.RENDERBUFFER_ALPHA_SIZE=36179]="RENDERBUFFER_ALPHA_SIZE",t[t.RENDERBUFFER_DEPTH_SIZE=36180]="RENDERBUFFER_DEPTH_SIZE",t[t.RENDERBUFFER_STENCIL_SIZE=36181]="RENDERBUFFER_STENCIL_SIZE",t[t.FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE=36048]="FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE",t[t.FRAMEBUFFER_ATTACHMENT_OBJECT_NAME=36049]="FRAMEBUFFER_ATTACHMENT_OBJECT_NAME",t[t.FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL=36050]="FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL",t[t.FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE=36051]="FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE",t[t.COLOR_ATTACHMENT0=36064]="COLOR_ATTACHMENT0",t[t.DEPTH_ATTACHMENT=36096]="DEPTH_ATTACHMENT",t[t.STENCIL_ATTACHMENT=36128]="STENCIL_ATTACHMENT",t[t.DEPTH_STENCIL_ATTACHMENT=33306]="DEPTH_STENCIL_ATTACHMENT",t[t.NONE=0]="NONE",t[t.FRAMEBUFFER_COMPLETE=36053]="FRAMEBUFFER_COMPLETE",t[t.FRAMEBUFFER_INCOMPLETE_ATTACHMENT=36054]="FRAMEBUFFER_INCOMPLETE_ATTACHMENT",t[t.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT=36055]="FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT",t[t.FRAMEBUFFER_INCOMPLETE_DIMENSIONS=36057]="FRAMEBUFFER_INCOMPLETE_DIMENSIONS",t[t.FRAMEBUFFER_UNSUPPORTED=36061]="FRAMEBUFFER_UNSUPPORTED",t[t.FRAMEBUFFER_BINDING=36006]="FRAMEBUFFER_BINDING",t[t.RENDERBUFFER_BINDING=36007]="RENDERBUFFER_BINDING",t[t.READ_FRAMEBUFFER=36008]="READ_FRAMEBUFFER",t[t.DRAW_FRAMEBUFFER=36009]="DRAW_FRAMEBUFFER",t[t.MAX_RENDERBUFFER_SIZE=34024]="MAX_RENDERBUFFER_SIZE",t[t.INVALID_FRAMEBUFFER_OPERATION=1286]="INVALID_FRAMEBUFFER_OPERATION",t[t.UNPACK_FLIP_Y_WEBGL=37440]="UNPACK_FLIP_Y_WEBGL",t[t.UNPACK_PREMULTIPLY_ALPHA_WEBGL=37441]="UNPACK_PREMULTIPLY_ALPHA_WEBGL",t[t.UNPACK_COLORSPACE_CONVERSION_WEBGL=37443]="UNPACK_COLORSPACE_CONVERSION_WEBGL",t[t.READ_BUFFER=3074]="READ_BUFFER",t[t.UNPACK_ROW_LENGTH=3314]="UNPACK_ROW_LENGTH",t[t.UNPACK_SKIP_ROWS=3315]="UNPACK_SKIP_ROWS",t[t.UNPACK_SKIP_PIXELS=3316]="UNPACK_SKIP_PIXELS",t[t.PACK_ROW_LENGTH=3330]="PACK_ROW_LENGTH",t[t.PACK_SKIP_ROWS=3331]="PACK_SKIP_ROWS",t[t.PACK_SKIP_PIXELS=3332]="PACK_SKIP_PIXELS",t[t.TEXTURE_BINDING_3D=32874]="TEXTURE_BINDING_3D",t[t.UNPACK_SKIP_IMAGES=32877]="UNPACK_SKIP_IMAGES",t[t.UNPACK_IMAGE_HEIGHT=32878]="UNPACK_IMAGE_HEIGHT",t[t.MAX_3D_TEXTURE_SIZE=32883]="MAX_3D_TEXTURE_SIZE",t[t.MAX_ELEMENTS_VERTICES=33e3]="MAX_ELEMENTS_VERTICES",t[t.MAX_ELEMENTS_INDICES=33001]="MAX_ELEMENTS_INDICES",t[t.MAX_TEXTURE_LOD_BIAS=34045]="MAX_TEXTURE_LOD_BIAS",t[t.MAX_FRAGMENT_UNIFORM_COMPONENTS=35657]="MAX_FRAGMENT_UNIFORM_COMPONENTS",t[t.MAX_VERTEX_UNIFORM_COMPONENTS=35658]="MAX_VERTEX_UNIFORM_COMPONENTS",t[t.MAX_ARRAY_TEXTURE_LAYERS=35071]="MAX_ARRAY_TEXTURE_LAYERS",t[t.MIN_PROGRAM_TEXEL_OFFSET=35076]="MIN_PROGRAM_TEXEL_OFFSET",t[t.MAX_PROGRAM_TEXEL_OFFSET=35077]="MAX_PROGRAM_TEXEL_OFFSET",t[t.MAX_VARYING_COMPONENTS=35659]="MAX_VARYING_COMPONENTS",t[t.FRAGMENT_SHADER_DERIVATIVE_HINT=35723]="FRAGMENT_SHADER_DERIVATIVE_HINT",t[t.RASTERIZER_DISCARD=35977]="RASTERIZER_DISCARD",t[t.VERTEX_ARRAY_BINDING=34229]="VERTEX_ARRAY_BINDING",t[t.MAX_VERTEX_OUTPUT_COMPONENTS=37154]="MAX_VERTEX_OUTPUT_COMPONENTS",t[t.MAX_FRAGMENT_INPUT_COMPONENTS=37157]="MAX_FRAGMENT_INPUT_COMPONENTS",t[t.MAX_SERVER_WAIT_TIMEOUT=37137]="MAX_SERVER_WAIT_TIMEOUT",t[t.MAX_ELEMENT_INDEX=36203]="MAX_ELEMENT_INDEX",t[t.RED=6403]="RED",t[t.RGB8=32849]="RGB8",t[t.RGBA8=32856]="RGBA8",t[t.RGB10_A2=32857]="RGB10_A2",t[t.TEXTURE_3D=32879]="TEXTURE_3D",t[t.TEXTURE_WRAP_R=32882]="TEXTURE_WRAP_R",t[t.TEXTURE_MIN_LOD=33082]="TEXTURE_MIN_LOD",t[t.TEXTURE_MAX_LOD=33083]="TEXTURE_MAX_LOD",t[t.TEXTURE_BASE_LEVEL=33084]="TEXTURE_BASE_LEVEL",t[t.TEXTURE_MAX_LEVEL=33085]="TEXTURE_MAX_LEVEL",t[t.TEXTURE_COMPARE_MODE=34892]="TEXTURE_COMPARE_MODE",t[t.TEXTURE_COMPARE_FUNC=34893]="TEXTURE_COMPARE_FUNC",t[t.SRGB=35904]="SRGB",t[t.SRGB8=35905]="SRGB8",t[t.SRGB8_ALPHA8=35907]="SRGB8_ALPHA8",t[t.COMPARE_REF_TO_TEXTURE=34894]="COMPARE_REF_TO_TEXTURE",t[t.RGBA32F=34836]="RGBA32F",t[t.RGB32F=34837]="RGB32F",t[t.RGBA16F=34842]="RGBA16F",t[t.RGB16F=34843]="RGB16F",t[t.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",t[t.TEXTURE_BINDING_2D_ARRAY=35869]="TEXTURE_BINDING_2D_ARRAY",t[t.R11F_G11F_B10F=35898]="R11F_G11F_B10F",t[t.RGB9_E5=35901]="RGB9_E5",t[t.RGBA32UI=36208]="RGBA32UI",t[t.RGB32UI=36209]="RGB32UI",t[t.RGBA16UI=36214]="RGBA16UI",t[t.RGB16UI=36215]="RGB16UI",t[t.RGBA8UI=36220]="RGBA8UI",t[t.RGB8UI=36221]="RGB8UI",t[t.RGBA32I=36226]="RGBA32I",t[t.RGB32I=36227]="RGB32I",t[t.RGBA16I=36232]="RGBA16I",t[t.RGB16I=36233]="RGB16I",t[t.RGBA8I=36238]="RGBA8I",t[t.RGB8I=36239]="RGB8I",t[t.RED_INTEGER=36244]="RED_INTEGER",t[t.RGB_INTEGER=36248]="RGB_INTEGER",t[t.RGBA_INTEGER=36249]="RGBA_INTEGER",t[t.R8=33321]="R8",t[t.RG8=33323]="RG8",t[t.R16F=33325]="R16F",t[t.R32F=33326]="R32F",t[t.RG16F=33327]="RG16F",t[t.RG32F=33328]="RG32F",t[t.R8I=33329]="R8I",t[t.R8UI=33330]="R8UI",t[t.R16I=33331]="R16I",t[t.R16UI=33332]="R16UI",t[t.R32I=33333]="R32I",t[t.R32UI=33334]="R32UI",t[t.RG8I=33335]="RG8I",t[t.RG8UI=33336]="RG8UI",t[t.RG16I=33337]="RG16I",t[t.RG16UI=33338]="RG16UI",t[t.RG32I=33339]="RG32I",t[t.RG32UI=33340]="RG32UI",t[t.R8_SNORM=36756]="R8_SNORM",t[t.RG8_SNORM=36757]="RG8_SNORM",t[t.RGB8_SNORM=36758]="RGB8_SNORM",t[t.RGBA8_SNORM=36759]="RGBA8_SNORM",t[t.RGB10_A2UI=36975]="RGB10_A2UI",t[t.TEXTURE_IMMUTABLE_FORMAT=37167]="TEXTURE_IMMUTABLE_FORMAT",t[t.TEXTURE_IMMUTABLE_LEVELS=33503]="TEXTURE_IMMUTABLE_LEVELS",t[t.UNSIGNED_INT_2_10_10_10_REV=33640]="UNSIGNED_INT_2_10_10_10_REV",t[t.UNSIGNED_INT_10F_11F_11F_REV=35899]="UNSIGNED_INT_10F_11F_11F_REV",t[t.UNSIGNED_INT_5_9_9_9_REV=35902]="UNSIGNED_INT_5_9_9_9_REV",t[t.FLOAT_32_UNSIGNED_INT_24_8_REV=36269]="FLOAT_32_UNSIGNED_INT_24_8_REV",t[t.UNSIGNED_INT_24_8=34042]="UNSIGNED_INT_24_8",t[t.HALF_FLOAT=5131]="HALF_FLOAT",t[t.RG=33319]="RG",t[t.RG_INTEGER=33320]="RG_INTEGER",t[t.INT_2_10_10_10_REV=36255]="INT_2_10_10_10_REV",t[t.CURRENT_QUERY=34917]="CURRENT_QUERY",t[t.QUERY_RESULT=34918]="QUERY_RESULT",t[t.QUERY_RESULT_AVAILABLE=34919]="QUERY_RESULT_AVAILABLE",t[t.ANY_SAMPLES_PASSED=35887]="ANY_SAMPLES_PASSED",t[t.ANY_SAMPLES_PASSED_CONSERVATIVE=36202]="ANY_SAMPLES_PASSED_CONSERVATIVE",t[t.MAX_DRAW_BUFFERS=34852]="MAX_DRAW_BUFFERS",t[t.DRAW_BUFFER0=34853]="DRAW_BUFFER0",t[t.DRAW_BUFFER1=34854]="DRAW_BUFFER1",t[t.DRAW_BUFFER2=34855]="DRAW_BUFFER2",t[t.DRAW_BUFFER3=34856]="DRAW_BUFFER3",t[t.DRAW_BUFFER4=34857]="DRAW_BUFFER4",t[t.DRAW_BUFFER5=34858]="DRAW_BUFFER5",t[t.DRAW_BUFFER6=34859]="DRAW_BUFFER6",t[t.DRAW_BUFFER7=34860]="DRAW_BUFFER7",t[t.DRAW_BUFFER8=34861]="DRAW_BUFFER8",t[t.DRAW_BUFFER9=34862]="DRAW_BUFFER9",t[t.DRAW_BUFFER10=34863]="DRAW_BUFFER10",t[t.DRAW_BUFFER11=34864]="DRAW_BUFFER11",t[t.DRAW_BUFFER12=34865]="DRAW_BUFFER12",t[t.DRAW_BUFFER13=34866]="DRAW_BUFFER13",t[t.DRAW_BUFFER14=34867]="DRAW_BUFFER14",t[t.DRAW_BUFFER15=34868]="DRAW_BUFFER15",t[t.MAX_COLOR_ATTACHMENTS=36063]="MAX_COLOR_ATTACHMENTS",t[t.COLOR_ATTACHMENT1=36065]="COLOR_ATTACHMENT1",t[t.COLOR_ATTACHMENT2=36066]="COLOR_ATTACHMENT2",t[t.COLOR_ATTACHMENT3=36067]="COLOR_ATTACHMENT3",t[t.COLOR_ATTACHMENT4=36068]="COLOR_ATTACHMENT4",t[t.COLOR_ATTACHMENT5=36069]="COLOR_ATTACHMENT5",t[t.COLOR_ATTACHMENT6=36070]="COLOR_ATTACHMENT6",t[t.COLOR_ATTACHMENT7=36071]="COLOR_ATTACHMENT7",t[t.COLOR_ATTACHMENT8=36072]="COLOR_ATTACHMENT8",t[t.COLOR_ATTACHMENT9=36073]="COLOR_ATTACHMENT9",t[t.COLOR_ATTACHMENT10=36074]="COLOR_ATTACHMENT10",t[t.COLOR_ATTACHMENT11=36075]="COLOR_ATTACHMENT11",t[t.COLOR_ATTACHMENT12=36076]="COLOR_ATTACHMENT12",t[t.COLOR_ATTACHMENT13=36077]="COLOR_ATTACHMENT13",t[t.COLOR_ATTACHMENT14=36078]="COLOR_ATTACHMENT14",t[t.COLOR_ATTACHMENT15=36079]="COLOR_ATTACHMENT15",t[t.SAMPLER_3D=35679]="SAMPLER_3D",t[t.SAMPLER_2D_SHADOW=35682]="SAMPLER_2D_SHADOW",t[t.SAMPLER_2D_ARRAY=36289]="SAMPLER_2D_ARRAY",t[t.SAMPLER_2D_ARRAY_SHADOW=36292]="SAMPLER_2D_ARRAY_SHADOW",t[t.SAMPLER_CUBE_SHADOW=36293]="SAMPLER_CUBE_SHADOW",t[t.INT_SAMPLER_2D=36298]="INT_SAMPLER_2D",t[t.INT_SAMPLER_3D=36299]="INT_SAMPLER_3D",t[t.INT_SAMPLER_CUBE=36300]="INT_SAMPLER_CUBE",t[t.INT_SAMPLER_2D_ARRAY=36303]="INT_SAMPLER_2D_ARRAY",t[t.UNSIGNED_INT_SAMPLER_2D=36306]="UNSIGNED_INT_SAMPLER_2D",t[t.UNSIGNED_INT_SAMPLER_3D=36307]="UNSIGNED_INT_SAMPLER_3D",t[t.UNSIGNED_INT_SAMPLER_CUBE=36308]="UNSIGNED_INT_SAMPLER_CUBE",t[t.UNSIGNED_INT_SAMPLER_2D_ARRAY=36311]="UNSIGNED_INT_SAMPLER_2D_ARRAY",t[t.MAX_SAMPLES=36183]="MAX_SAMPLES",t[t.SAMPLER_BINDING=35097]="SAMPLER_BINDING",t[t.PIXEL_PACK_BUFFER=35051]="PIXEL_PACK_BUFFER",t[t.PIXEL_UNPACK_BUFFER=35052]="PIXEL_UNPACK_BUFFER",t[t.PIXEL_PACK_BUFFER_BINDING=35053]="PIXEL_PACK_BUFFER_BINDING",t[t.PIXEL_UNPACK_BUFFER_BINDING=35055]="PIXEL_UNPACK_BUFFER_BINDING",t[t.COPY_READ_BUFFER=36662]="COPY_READ_BUFFER",t[t.COPY_WRITE_BUFFER=36663]="COPY_WRITE_BUFFER",t[t.COPY_READ_BUFFER_BINDING=36662]="COPY_READ_BUFFER_BINDING",t[t.COPY_WRITE_BUFFER_BINDING=36663]="COPY_WRITE_BUFFER_BINDING",t[t.FLOAT_MAT2x3=35685]="FLOAT_MAT2x3",t[t.FLOAT_MAT2x4=35686]="FLOAT_MAT2x4",t[t.FLOAT_MAT3x2=35687]="FLOAT_MAT3x2",t[t.FLOAT_MAT3x4=35688]="FLOAT_MAT3x4",t[t.FLOAT_MAT4x2=35689]="FLOAT_MAT4x2",t[t.FLOAT_MAT4x3=35690]="FLOAT_MAT4x3",t[t.UNSIGNED_INT_VEC2=36294]="UNSIGNED_INT_VEC2",t[t.UNSIGNED_INT_VEC3=36295]="UNSIGNED_INT_VEC3",t[t.UNSIGNED_INT_VEC4=36296]="UNSIGNED_INT_VEC4",t[t.UNSIGNED_NORMALIZED=35863]="UNSIGNED_NORMALIZED",t[t.SIGNED_NORMALIZED=36764]="SIGNED_NORMALIZED",t[t.VERTEX_ATTRIB_ARRAY_INTEGER=35069]="VERTEX_ATTRIB_ARRAY_INTEGER",t[t.VERTEX_ATTRIB_ARRAY_DIVISOR=35070]="VERTEX_ATTRIB_ARRAY_DIVISOR",t[t.TRANSFORM_FEEDBACK_BUFFER_MODE=35967]="TRANSFORM_FEEDBACK_BUFFER_MODE",t[t.MAX_TRANSFORM_FEEDBACK_SEPARATE_COMPONENTS=35968]="MAX_TRANSFORM_FEEDBACK_SEPARATE_COMPONENTS",t[t.TRANSFORM_FEEDBACK_VARYINGS=35971]="TRANSFORM_FEEDBACK_VARYINGS",t[t.TRANSFORM_FEEDBACK_BUFFER_START=35972]="TRANSFORM_FEEDBACK_BUFFER_START",t[t.TRANSFORM_FEEDBACK_BUFFER_SIZE=35973]="TRANSFORM_FEEDBACK_BUFFER_SIZE",t[t.TRANSFORM_FEEDBACK_PRIMITIVES_WRITTEN=35976]="TRANSFORM_FEEDBACK_PRIMITIVES_WRITTEN",t[t.MAX_TRANSFORM_FEEDBACK_INTERLEAVED_COMPONENTS=35978]="MAX_TRANSFORM_FEEDBACK_INTERLEAVED_COMPONENTS",t[t.MAX_TRANSFORM_FEEDBACK_SEPARATE_ATTRIBS=35979]="MAX_TRANSFORM_FEEDBACK_SEPARATE_ATTRIBS",t[t.INTERLEAVED_ATTRIBS=35980]="INTERLEAVED_ATTRIBS",t[t.SEPARATE_ATTRIBS=35981]="SEPARATE_ATTRIBS",t[t.TRANSFORM_FEEDBACK_BUFFER=35982]="TRANSFORM_FEEDBACK_BUFFER",t[t.TRANSFORM_FEEDBACK_BUFFER_BINDING=35983]="TRANSFORM_FEEDBACK_BUFFER_BINDING",t[t.TRANSFORM_FEEDBACK=36386]="TRANSFORM_FEEDBACK",t[t.TRANSFORM_FEEDBACK_PAUSED=36387]="TRANSFORM_FEEDBACK_PAUSED",t[t.TRANSFORM_FEEDBACK_ACTIVE=36388]="TRANSFORM_FEEDBACK_ACTIVE",t[t.TRANSFORM_FEEDBACK_BINDING=36389]="TRANSFORM_FEEDBACK_BINDING",t[t.FRAMEBUFFER_ATTACHMENT_COLOR_ENCODING=33296]="FRAMEBUFFER_ATTACHMENT_COLOR_ENCODING",t[t.FRAMEBUFFER_ATTACHMENT_COMPONENT_TYPE=33297]="FRAMEBUFFER_ATTACHMENT_COMPONENT_TYPE",t[t.FRAMEBUFFER_ATTACHMENT_RED_SIZE=33298]="FRAMEBUFFER_ATTACHMENT_RED_SIZE",t[t.FRAMEBUFFER_ATTACHMENT_GREEN_SIZE=33299]="FRAMEBUFFER_ATTACHMENT_GREEN_SIZE",t[t.FRAMEBUFFER_ATTACHMENT_BLUE_SIZE=33300]="FRAMEBUFFER_ATTACHMENT_BLUE_SIZE",t[t.FRAMEBUFFER_ATTACHMENT_ALPHA_SIZE=33301]="FRAMEBUFFER_ATTACHMENT_ALPHA_SIZE",t[t.FRAMEBUFFER_ATTACHMENT_DEPTH_SIZE=33302]="FRAMEBUFFER_ATTACHMENT_DEPTH_SIZE",t[t.FRAMEBUFFER_ATTACHMENT_STENCIL_SIZE=33303]="FRAMEBUFFER_ATTACHMENT_STENCIL_SIZE",t[t.FRAMEBUFFER_DEFAULT=33304]="FRAMEBUFFER_DEFAULT",t[t.DEPTH24_STENCIL8=35056]="DEPTH24_STENCIL8",t[t.DRAW_FRAMEBUFFER_BINDING=36006]="DRAW_FRAMEBUFFER_BINDING",t[t.READ_FRAMEBUFFER_BINDING=36010]="READ_FRAMEBUFFER_BINDING",t[t.RENDERBUFFER_SAMPLES=36011]="RENDERBUFFER_SAMPLES",t[t.FRAMEBUFFER_ATTACHMENT_TEXTURE_LAYER=36052]="FRAMEBUFFER_ATTACHMENT_TEXTURE_LAYER",t[t.FRAMEBUFFER_INCOMPLETE_MULTISAMPLE=36182]="FRAMEBUFFER_INCOMPLETE_MULTISAMPLE",t[t.UNIFORM_BUFFER=35345]="UNIFORM_BUFFER",t[t.UNIFORM_BUFFER_BINDING=35368]="UNIFORM_BUFFER_BINDING",t[t.UNIFORM_BUFFER_START=35369]="UNIFORM_BUFFER_START",t[t.UNIFORM_BUFFER_SIZE=35370]="UNIFORM_BUFFER_SIZE",t[t.MAX_VERTEX_UNIFORM_BLOCKS=35371]="MAX_VERTEX_UNIFORM_BLOCKS",t[t.MAX_FRAGMENT_UNIFORM_BLOCKS=35373]="MAX_FRAGMENT_UNIFORM_BLOCKS",t[t.MAX_COMBINED_UNIFORM_BLOCKS=35374]="MAX_COMBINED_UNIFORM_BLOCKS",t[t.MAX_UNIFORM_BUFFER_BINDINGS=35375]="MAX_UNIFORM_BUFFER_BINDINGS",t[t.MAX_UNIFORM_BLOCK_SIZE=35376]="MAX_UNIFORM_BLOCK_SIZE",t[t.MAX_COMBINED_VERTEX_UNIFORM_COMPONENTS=35377]="MAX_COMBINED_VERTEX_UNIFORM_COMPONENTS",t[t.MAX_COMBINED_FRAGMENT_UNIFORM_COMPONENTS=35379]="MAX_COMBINED_FRAGMENT_UNIFORM_COMPONENTS",t[t.UNIFORM_BUFFER_OFFSET_ALIGNMENT=35380]="UNIFORM_BUFFER_OFFSET_ALIGNMENT",t[t.ACTIVE_UNIFORM_BLOCKS=35382]="ACTIVE_UNIFORM_BLOCKS",t[t.UNIFORM_TYPE=35383]="UNIFORM_TYPE",t[t.UNIFORM_SIZE=35384]="UNIFORM_SIZE",t[t.UNIFORM_BLOCK_INDEX=35386]="UNIFORM_BLOCK_INDEX",t[t.UNIFORM_OFFSET=35387]="UNIFORM_OFFSET",t[t.UNIFORM_ARRAY_STRIDE=35388]="UNIFORM_ARRAY_STRIDE",t[t.UNIFORM_MATRIX_STRIDE=35389]="UNIFORM_MATRIX_STRIDE",t[t.UNIFORM_IS_ROW_MAJOR=35390]="UNIFORM_IS_ROW_MAJOR",t[t.UNIFORM_BLOCK_BINDING=35391]="UNIFORM_BLOCK_BINDING",t[t.UNIFORM_BLOCK_DATA_SIZE=35392]="UNIFORM_BLOCK_DATA_SIZE",t[t.UNIFORM_BLOCK_ACTIVE_UNIFORMS=35394]="UNIFORM_BLOCK_ACTIVE_UNIFORMS",t[t.UNIFORM_BLOCK_ACTIVE_UNIFORM_INDICES=35395]="UNIFORM_BLOCK_ACTIVE_UNIFORM_INDICES",t[t.UNIFORM_BLOCK_REFERENCED_BY_VERTEX_SHADER=35396]="UNIFORM_BLOCK_REFERENCED_BY_VERTEX_SHADER",t[t.UNIFORM_BLOCK_REFERENCED_BY_FRAGMENT_SHADER=35398]="UNIFORM_BLOCK_REFERENCED_BY_FRAGMENT_SHADER",t[t.OBJECT_TYPE=37138]="OBJECT_TYPE",t[t.SYNC_CONDITION=37139]="SYNC_CONDITION",t[t.SYNC_STATUS=37140]="SYNC_STATUS",t[t.SYNC_FLAGS=37141]="SYNC_FLAGS",t[t.SYNC_FENCE=37142]="SYNC_FENCE",t[t.SYNC_GPU_COMMANDS_COMPLETE=37143]="SYNC_GPU_COMMANDS_COMPLETE",t[t.UNSIGNALED=37144]="UNSIGNALED",t[t.SIGNALED=37145]="SIGNALED",t[t.ALREADY_SIGNALED=37146]="ALREADY_SIGNALED",t[t.TIMEOUT_EXPIRED=37147]="TIMEOUT_EXPIRED",t[t.CONDITION_SATISFIED=37148]="CONDITION_SATISFIED",t[t.WAIT_FAILED=37149]="WAIT_FAILED",t[t.SYNC_FLUSH_COMMANDS_BIT=1]="SYNC_FLUSH_COMMANDS_BIT",t[t.COLOR=6144]="COLOR",t[t.DEPTH=6145]="DEPTH",t[t.STENCIL=6146]="STENCIL",t[t.MIN=32775]="MIN",t[t.MAX=32776]="MAX",t[t.DEPTH_COMPONENT24=33190]="DEPTH_COMPONENT24",t[t.STREAM_READ=35041]="STREAM_READ",t[t.STREAM_COPY=35042]="STREAM_COPY",t[t.STATIC_READ=35045]="STATIC_READ",t[t.STATIC_COPY=35046]="STATIC_COPY",t[t.DYNAMIC_READ=35049]="DYNAMIC_READ",t[t.DYNAMIC_COPY=35050]="DYNAMIC_COPY",t[t.DEPTH_COMPONENT32F=36012]="DEPTH_COMPONENT32F",t[t.DEPTH32F_STENCIL8=36013]="DEPTH32F_STENCIL8",t[t.INVALID_INDEX=4294967295]="INVALID_INDEX",t[t.TIMEOUT_IGNORED=-1]="TIMEOUT_IGNORED",t[t.MAX_CLIENT_WAIT_TIMEOUT_WEBGL=37447]="MAX_CLIENT_WAIT_TIMEOUT_WEBGL",t[t.UNMASKED_VENDOR_WEBGL=37445]="UNMASKED_VENDOR_WEBGL",t[t.UNMASKED_RENDERER_WEBGL=37446]="UNMASKED_RENDERER_WEBGL",t[t.MAX_TEXTURE_MAX_ANISOTROPY_EXT=34047]="MAX_TEXTURE_MAX_ANISOTROPY_EXT",t[t.TEXTURE_MAX_ANISOTROPY_EXT=34046]="TEXTURE_MAX_ANISOTROPY_EXT",t[t.R16_EXT=33322]="R16_EXT",t[t.RG16_EXT=33324]="RG16_EXT",t[t.RGB16_EXT=32852]="RGB16_EXT",t[t.RGBA16_EXT=32859]="RGBA16_EXT",t[t.R16_SNORM_EXT=36760]="R16_SNORM_EXT",t[t.RG16_SNORM_EXT=36761]="RG16_SNORM_EXT",t[t.RGB16_SNORM_EXT=36762]="RGB16_SNORM_EXT",t[t.RGBA16_SNORM_EXT=36763]="RGBA16_SNORM_EXT",t[t.COMPRESSED_RGB_S3TC_DXT1_EXT=33776]="COMPRESSED_RGB_S3TC_DXT1_EXT",t[t.COMPRESSED_RGBA_S3TC_DXT1_EXT=33777]="COMPRESSED_RGBA_S3TC_DXT1_EXT",t[t.COMPRESSED_RGBA_S3TC_DXT3_EXT=33778]="COMPRESSED_RGBA_S3TC_DXT3_EXT",t[t.COMPRESSED_RGBA_S3TC_DXT5_EXT=33779]="COMPRESSED_RGBA_S3TC_DXT5_EXT",t[t.COMPRESSED_SRGB_S3TC_DXT1_EXT=35916]="COMPRESSED_SRGB_S3TC_DXT1_EXT",t[t.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT=35917]="COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT",t[t.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT=35918]="COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT",t[t.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT=35919]="COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT",t[t.COMPRESSED_RED_RGTC1_EXT=36283]="COMPRESSED_RED_RGTC1_EXT",t[t.COMPRESSED_SIGNED_RED_RGTC1_EXT=36284]="COMPRESSED_SIGNED_RED_RGTC1_EXT",t[t.COMPRESSED_RED_GREEN_RGTC2_EXT=36285]="COMPRESSED_RED_GREEN_RGTC2_EXT",t[t.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT=36286]="COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT",t[t.COMPRESSED_RGBA_BPTC_UNORM_EXT=36492]="COMPRESSED_RGBA_BPTC_UNORM_EXT",t[t.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT=36493]="COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT",t[t.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT=36494]="COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT",t[t.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT=36495]="COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT",t[t.COMPRESSED_R11_EAC=37488]="COMPRESSED_R11_EAC",t[t.COMPRESSED_SIGNED_R11_EAC=37489]="COMPRESSED_SIGNED_R11_EAC",t[t.COMPRESSED_RG11_EAC=37490]="COMPRESSED_RG11_EAC",t[t.COMPRESSED_SIGNED_RG11_EAC=37491]="COMPRESSED_SIGNED_RG11_EAC",t[t.COMPRESSED_RGB8_ETC2=37492]="COMPRESSED_RGB8_ETC2",t[t.COMPRESSED_RGBA8_ETC2_EAC=37493]="COMPRESSED_RGBA8_ETC2_EAC",t[t.COMPRESSED_SRGB8_ETC2=37494]="COMPRESSED_SRGB8_ETC2",t[t.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC=37495]="COMPRESSED_SRGB8_ALPHA8_ETC2_EAC",t[t.COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2=37496]="COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2",t[t.COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2=37497]="COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2",t[t.COMPRESSED_RGB_PVRTC_4BPPV1_IMG=35840]="COMPRESSED_RGB_PVRTC_4BPPV1_IMG",t[t.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG=35842]="COMPRESSED_RGBA_PVRTC_4BPPV1_IMG",t[t.COMPRESSED_RGB_PVRTC_2BPPV1_IMG=35841]="COMPRESSED_RGB_PVRTC_2BPPV1_IMG",t[t.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG=35843]="COMPRESSED_RGBA_PVRTC_2BPPV1_IMG",t[t.COMPRESSED_RGB_ETC1_WEBGL=36196]="COMPRESSED_RGB_ETC1_WEBGL",t[t.COMPRESSED_RGB_ATC_WEBGL=35986]="COMPRESSED_RGB_ATC_WEBGL",t[t.COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL=35986]="COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL",t[t.COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL=34798]="COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL",t[t.COMPRESSED_RGBA_ASTC_4x4_KHR=37808]="COMPRESSED_RGBA_ASTC_4x4_KHR",t[t.COMPRESSED_RGBA_ASTC_5x4_KHR=37809]="COMPRESSED_RGBA_ASTC_5x4_KHR",t[t.COMPRESSED_RGBA_ASTC_5x5_KHR=37810]="COMPRESSED_RGBA_ASTC_5x5_KHR",t[t.COMPRESSED_RGBA_ASTC_6x5_KHR=37811]="COMPRESSED_RGBA_ASTC_6x5_KHR",t[t.COMPRESSED_RGBA_ASTC_6x6_KHR=37812]="COMPRESSED_RGBA_ASTC_6x6_KHR",t[t.COMPRESSED_RGBA_ASTC_8x5_KHR=37813]="COMPRESSED_RGBA_ASTC_8x5_KHR",t[t.COMPRESSED_RGBA_ASTC_8x6_KHR=37814]="COMPRESSED_RGBA_ASTC_8x6_KHR",t[t.COMPRESSED_RGBA_ASTC_8x8_KHR=37815]="COMPRESSED_RGBA_ASTC_8x8_KHR",t[t.COMPRESSED_RGBA_ASTC_10x5_KHR=37816]="COMPRESSED_RGBA_ASTC_10x5_KHR",t[t.COMPRESSED_RGBA_ASTC_10x6_KHR=37817]="COMPRESSED_RGBA_ASTC_10x6_KHR",t[t.COMPRESSED_RGBA_ASTC_10x8_KHR=37818]="COMPRESSED_RGBA_ASTC_10x8_KHR",t[t.COMPRESSED_RGBA_ASTC_10x10_KHR=37819]="COMPRESSED_RGBA_ASTC_10x10_KHR",t[t.COMPRESSED_RGBA_ASTC_12x10_KHR=37820]="COMPRESSED_RGBA_ASTC_12x10_KHR",t[t.COMPRESSED_RGBA_ASTC_12x12_KHR=37821]="COMPRESSED_RGBA_ASTC_12x12_KHR",t[t.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR=37840]="COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR",t[t.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR=37841]="COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR",t[t.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR=37842]="COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR",t[t.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR=37843]="COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR",t[t.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR=37844]="COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR",t[t.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR=37845]="COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR",t[t.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR=37846]="COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR",t[t.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR=37847]="COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR",t[t.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR=37848]="COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR",t[t.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR=37849]="COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR",t[t.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR=37850]="COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR",t[t.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR=37851]="COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR",t[t.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR=37852]="COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR",t[t.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR=37853]="COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR",t[t.QUERY_COUNTER_BITS_EXT=34916]="QUERY_COUNTER_BITS_EXT",t[t.CURRENT_QUERY_EXT=34917]="CURRENT_QUERY_EXT",t[t.QUERY_RESULT_EXT=34918]="QUERY_RESULT_EXT",t[t.QUERY_RESULT_AVAILABLE_EXT=34919]="QUERY_RESULT_AVAILABLE_EXT",t[t.TIME_ELAPSED_EXT=35007]="TIME_ELAPSED_EXT",t[t.TIMESTAMP_EXT=36392]="TIMESTAMP_EXT",t[t.GPU_DISJOINT_EXT=36795]="GPU_DISJOINT_EXT",t[t.COMPLETION_STATUS_KHR=37297]="COMPLETION_STATUS_KHR",t[t.DEPTH_CLAMP_EXT=34383]="DEPTH_CLAMP_EXT",t[t.FIRST_VERTEX_CONVENTION_WEBGL=36429]="FIRST_VERTEX_CONVENTION_WEBGL",t[t.LAST_VERTEX_CONVENTION_WEBGL=36430]="LAST_VERTEX_CONVENTION_WEBGL",t[t.PROVOKING_VERTEX_WEBL=36431]="PROVOKING_VERTEX_WEBL",t[t.POLYGON_MODE_WEBGL=2880]="POLYGON_MODE_WEBGL",t[t.POLYGON_OFFSET_LINE_WEBGL=10754]="POLYGON_OFFSET_LINE_WEBGL",t[t.LINE_WEBGL=6913]="LINE_WEBGL",t[t.FILL_WEBGL=6914]="FILL_WEBGL",t[t.MAX_CLIP_DISTANCES_WEBGL=3378]="MAX_CLIP_DISTANCES_WEBGL",t[t.MAX_CULL_DISTANCES_WEBGL=33529]="MAX_CULL_DISTANCES_WEBGL",t[t.MAX_COMBINED_CLIP_AND_CULL_DISTANCES_WEBGL=33530]="MAX_COMBINED_CLIP_AND_CULL_DISTANCES_WEBGL",t[t.CLIP_DISTANCE0_WEBGL=12288]="CLIP_DISTANCE0_WEBGL",t[t.CLIP_DISTANCE1_WEBGL=12289]="CLIP_DISTANCE1_WEBGL",t[t.CLIP_DISTANCE2_WEBGL=12290]="CLIP_DISTANCE2_WEBGL",t[t.CLIP_DISTANCE3_WEBGL=12291]="CLIP_DISTANCE3_WEBGL",t[t.CLIP_DISTANCE4_WEBGL=12292]="CLIP_DISTANCE4_WEBGL",t[t.CLIP_DISTANCE5_WEBGL=12293]="CLIP_DISTANCE5_WEBGL",t[t.CLIP_DISTANCE6_WEBGL=12294]="CLIP_DISTANCE6_WEBGL",t[t.CLIP_DISTANCE7_WEBGL=12295]="CLIP_DISTANCE7_WEBGL",t[t.POLYGON_OFFSET_CLAMP_EXT=36379]="POLYGON_OFFSET_CLAMP_EXT",t[t.LOWER_LEFT_EXT=36001]="LOWER_LEFT_EXT",t[t.UPPER_LEFT_EXT=36002]="UPPER_LEFT_EXT",t[t.NEGATIVE_ONE_TO_ONE_EXT=37726]="NEGATIVE_ONE_TO_ONE_EXT",t[t.ZERO_TO_ONE_EXT=37727]="ZERO_TO_ONE_EXT",t[t.CLIP_ORIGIN_EXT=37724]="CLIP_ORIGIN_EXT",t[t.CLIP_DEPTH_MODE_EXT=37725]="CLIP_DEPTH_MODE_EXT",t[t.SRC1_COLOR_WEBGL=35065]="SRC1_COLOR_WEBGL",t[t.SRC1_ALPHA_WEBGL=34185]="SRC1_ALPHA_WEBGL",t[t.ONE_MINUS_SRC1_COLOR_WEBGL=35066]="ONE_MINUS_SRC1_COLOR_WEBGL",t[t.ONE_MINUS_SRC1_ALPHA_WEBGL=35067]="ONE_MINUS_SRC1_ALPHA_WEBGL",t[t.MAX_DUAL_SOURCE_DRAW_BUFFERS_WEBGL=35068]="MAX_DUAL_SOURCE_DRAW_BUFFERS_WEBGL",t[t.MIRROR_CLAMP_TO_EDGE_EXT=34627]="MIRROR_CLAMP_TO_EDGE_EXT"})(Rv||(Rv={}));const rD={3042:!1,32773:new Float32Array([0,0,0,0]),32777:32774,34877:32774,32969:1,32968:0,32971:1,32970:0,3106:new Float32Array([0,0,0,0]),3107:[!0,!0,!0,!0],2884:!1,2885:1029,2929:!1,2931:1,2932:513,2928:new Float32Array([0,1]),2930:!0,3024:!0,35725:null,36006:null,36007:null,34229:null,34964:null,2886:2305,33170:4352,2849:1,32823:!1,32824:0,10752:0,32926:!1,32928:!1,32938:1,32939:!1,3089:!1,3088:new Int32Array([0,0,1024,1024]),2960:!1,2961:0,2968:4294967295,36005:4294967295,2962:519,2967:0,2963:4294967295,34816:519,36003:0,36004:4294967295,2964:7680,2965:7680,2966:7680,34817:7680,34818:7680,34819:7680,2978:[0,0,1024,1024],36389:null,36662:null,36663:null,35053:null,35055:null,35723:4352,36010:null,35977:!1,3333:4,3317:4,37440:!1,37441:!1,37443:37444,3330:0,3332:0,3331:0,3314:0,32878:0,3316:0,3315:0,32877:0},hl=(t,e,r)=>e?t.enable(r):t.disable(r),mH=(t,e,r)=>t.hint(r,e),qc=(t,e,r)=>t.pixelStorei(r,e),yH=(t,e,r)=>{const n=r===36006?36009:36008;return t.bindFramebuffer(n,e)},V_=(t,e,r)=>{const i={34964:34962,36662:36662,36663:36663,35053:35051,35055:35052}[r];t.bindBuffer(i,e)};function QI(t){return Array.isArray(t)||ArrayBuffer.isView(t)&&!(t instanceof DataView)}const $Ue={3042:hl,32773:(t,e)=>t.blendColor(...e),32777:"blendEquation",34877:"blendEquation",32969:"blendFunc",32968:"blendFunc",32971:"blendFunc",32970:"blendFunc",3106:(t,e)=>t.clearColor(...e),3107:(t,e)=>t.colorMask(...e),2884:hl,2885:(t,e)=>t.cullFace(e),2929:hl,2931:(t,e)=>t.clearDepth(e),2932:(t,e)=>t.depthFunc(e),2928:(t,e)=>t.depthRange(...e),2930:(t,e)=>t.depthMask(e),3024:hl,35723:mH,35725:(t,e)=>t.useProgram(e),36007:(t,e)=>t.bindRenderbuffer(36161,e),36389:(t,e)=>t.bindTransformFeedback?.(36386,e),34229:(t,e)=>t.bindVertexArray(e),36006:yH,36010:yH,34964:V_,36662:V_,36663:V_,35053:V_,35055:V_,2886:(t,e)=>t.frontFace(e),33170:mH,2849:(t,e)=>t.lineWidth(e),32823:hl,32824:"polygonOffset",10752:"polygonOffset",35977:hl,32926:hl,32928:hl,32938:"sampleCoverage",32939:"sampleCoverage",3089:hl,3088:(t,e)=>t.scissor(...e),2960:hl,2961:(t,e)=>t.clearStencil(e),2968:(t,e)=>t.stencilMaskSeparate(1028,e),36005:(t,e)=>t.stencilMaskSeparate(1029,e),2962:"stencilFuncFront",2967:"stencilFuncFront",2963:"stencilFuncFront",34816:"stencilFuncBack",36003:"stencilFuncBack",36004:"stencilFuncBack",2964:"stencilOpFront",2965:"stencilOpFront",2966:"stencilOpFront",34817:"stencilOpBack",34818:"stencilOpBack",34819:"stencilOpBack",2978:(t,e)=>t.viewport(...e),34383:hl,10754:hl,12288:hl,12289:hl,12290:hl,12291:hl,12292:hl,12293:hl,12294:hl,12295:hl,3333:qc,3317:qc,37440:qc,37441:qc,37443:qc,3330:qc,3332:qc,3331:qc,3314:qc,32878:qc,3316:qc,3315:qc,32877:qc,framebuffer:(t,e)=>{const r=e&&"handle"in e?e.handle:e;return t.bindFramebuffer(36160,r)},blend:(t,e)=>e?t.enable(3042):t.disable(3042),blendColor:(t,e)=>t.blendColor(...e),blendEquation:(t,e)=>{const r=typeof e=="number"?[e,e]:e;t.blendEquationSeparate(...r)},blendFunc:(t,e)=>{const r=e?.length===2?[...e,...e]:e;t.blendFuncSeparate(...r)},clearColor:(t,e)=>t.clearColor(...e),clearDepth:(t,e)=>t.clearDepth(e),clearStencil:(t,e)=>t.clearStencil(e),colorMask:(t,e)=>t.colorMask(...e),cull:(t,e)=>e?t.enable(2884):t.disable(2884),cullFace:(t,e)=>t.cullFace(e),depthTest:(t,e)=>e?t.enable(2929):t.disable(2929),depthFunc:(t,e)=>t.depthFunc(e),depthMask:(t,e)=>t.depthMask(e),depthRange:(t,e)=>t.depthRange(...e),dither:(t,e)=>e?t.enable(3024):t.disable(3024),derivativeHint:(t,e)=>{t.hint(35723,e)},frontFace:(t,e)=>t.frontFace(e),mipmapHint:(t,e)=>t.hint(33170,e),lineWidth:(t,e)=>t.lineWidth(e),polygonOffsetFill:(t,e)=>e?t.enable(32823):t.disable(32823),polygonOffset:(t,e)=>t.polygonOffset(...e),sampleCoverage:(t,e)=>t.sampleCoverage(e[0],e[1]||!1),scissorTest:(t,e)=>e?t.enable(3089):t.disable(3089),scissor:(t,e)=>t.scissor(...e),stencilTest:(t,e)=>e?t.enable(2960):t.disable(2960),stencilMask:(t,e)=>{e=QI(e)?e:[e,e];const[r,n]=e;t.stencilMaskSeparate(1028,r),t.stencilMaskSeparate(1029,n)},stencilFunc:(t,e)=>{e=QI(e)&&e.length===3?[...e,...e]:e;const[r,n,i,a,s,o]=e;t.stencilFuncSeparate(1028,r,n,i),t.stencilFuncSeparate(1029,a,s,o)},stencilOp:(t,e)=>{e=QI(e)&&e.length===3?[...e,...e]:e;const[r,n,i,a,s,o]=e;t.stencilOpSeparate(1028,r,n,i),t.stencilOpSeparate(1029,a,s,o)},viewport:(t,e)=>t.viewport(...e)};function Ms(t,e,r){return e[t]!==void 0?e[t]:r[t]}const qUe={blendEquation:(t,e,r)=>t.blendEquationSeparate(Ms(32777,e,r),Ms(34877,e,r)),blendFunc:(t,e,r)=>t.blendFuncSeparate(Ms(32969,e,r),Ms(32968,e,r),Ms(32971,e,r),Ms(32970,e,r)),polygonOffset:(t,e,r)=>t.polygonOffset(Ms(32824,e,r),Ms(10752,e,r)),sampleCoverage:(t,e,r)=>t.sampleCoverage(Ms(32938,e,r),Ms(32939,e,r)),stencilFuncFront:(t,e,r)=>t.stencilFuncSeparate(1028,Ms(2962,e,r),Ms(2967,e,r),Ms(2963,e,r)),stencilFuncBack:(t,e,r)=>t.stencilFuncSeparate(1029,Ms(34816,e,r),Ms(36003,e,r),Ms(36004,e,r)),stencilOpFront:(t,e,r)=>t.stencilOpSeparate(1028,Ms(2964,e,r),Ms(2965,e,r),Ms(2966,e,r)),stencilOpBack:(t,e,r)=>t.stencilOpSeparate(1029,Ms(34817,e,r),Ms(34818,e,r),Ms(34819,e,r))},vH={enable:(t,e)=>t({[e]:!0}),disable:(t,e)=>t({[e]:!1}),pixelStorei:(t,e,r)=>t({[e]:r}),hint:(t,e,r)=>t({[e]:r}),useProgram:(t,e)=>t({35725:e}),bindRenderbuffer:(t,e,r)=>t({36007:r}),bindTransformFeedback:(t,e,r)=>t({36389:r}),bindVertexArray:(t,e)=>t({34229:e}),bindFramebuffer:(t,e,r)=>{switch(e){case 36160:return t({36006:r,36010:r});case 36009:return t({36006:r});case 36008:return t({36010:r});default:return null}},bindBuffer:(t,e,r)=>{const n={34962:[34964],36662:[36662],36663:[36663],35051:[35053],35052:[35055]}[e];return n?t({[n]:r}):{valueChanged:!0}},blendColor:(t,e,r,n,i)=>t({32773:new Float32Array([e,r,n,i])}),blendEquation:(t,e)=>t({32777:e,34877:e}),blendEquationSeparate:(t,e,r)=>t({32777:e,34877:r}),blendFunc:(t,e,r)=>t({32969:e,32968:r,32971:e,32970:r}),blendFuncSeparate:(t,e,r,n,i)=>t({32969:e,32968:r,32971:n,32970:i}),clearColor:(t,e,r,n,i)=>t({3106:new Float32Array([e,r,n,i])}),clearDepth:(t,e)=>t({2931:e}),clearStencil:(t,e)=>t({2961:e}),colorMask:(t,e,r,n,i)=>t({3107:[e,r,n,i]}),cullFace:(t,e)=>t({2885:e}),depthFunc:(t,e)=>t({2932:e}),depthRange:(t,e,r)=>t({2928:new Float32Array([e,r])}),depthMask:(t,e)=>t({2930:e}),frontFace:(t,e)=>t({2886:e}),lineWidth:(t,e)=>t({2849:e}),polygonOffset:(t,e,r)=>t({32824:e,10752:r}),sampleCoverage:(t,e,r)=>t({32938:e,32939:r}),scissor:(t,e,r,n,i)=>t({3088:new Int32Array([e,r,n,i])}),stencilMask:(t,e)=>t({2968:e,36005:e}),stencilMaskSeparate:(t,e,r)=>t({[e===1028?2968:36005]:r}),stencilFunc:(t,e,r,n)=>t({2962:e,2967:r,2963:n,34816:e,36003:r,36004:n}),stencilFuncSeparate:(t,e,r,n,i)=>t({[e===1028?2962:34816]:r,[e===1028?2967:36003]:n,[e===1028?2963:36004]:i}),stencilOp:(t,e,r,n)=>t({2964:e,2965:r,2966:n,34817:e,34818:r,34819:n}),stencilOpSeparate:(t,e,r,n,i)=>t({[e===1028?2964:34817]:r,[e===1028?2965:34818]:n,[e===1028?2966:34819]:i}),viewport:(t,e,r,n,i)=>t({2978:[e,r,n,i]})},Ff=(t,e)=>t.isEnabled(e),_H={3042:Ff,2884:Ff,2929:Ff,3024:Ff,32823:Ff,32926:Ff,32928:Ff,3089:Ff,2960:Ff,35977:Ff},HUe=new Set([34016,36388,36387,35983,35368,34965,35739,35738,3074,34853,34854,34855,34856,34857,34858,34859,34860,34861,34862,34863,34864,34865,34866,34867,34868,35097,32873,35869,32874,34068]);function X0(t,e){if(GUe(e))return;const r={};for(const i in e){const a=Number(i),s=$Ue[i];s&&(typeof s=="string"?r[s]=!0:s(t,e[i],a))}const n=t.state&&t.state.cache;if(n)for(const i in r){const a=qUe[i];a(t,e,n)}}function Fte(t,e=rD){if(typeof e=="number"){const i=e,a=_H[i];return a?a(t,i):t.getParameter(i)}const r=Array.isArray(e)?e:Object.keys(e),n={};for(const i of r){const a=_H[i];n[i]=a?a(t,Number(i)):t.getParameter(Number(i))}return n}function WUe(t){X0(t,rD)}function GUe(t){for(const e in t)return!1;return!0}function XUe(t,e){if(t===e)return!0;const r=Array.isArray(t)||ArrayBuffer.isView(t),n=Array.isArray(e)||ArrayBuffer.isView(e);if(r&&n&&t.length===e.length){for(let i=0;i<t.length;++i)if(t[i]!==e[i])return!1;return!0}return!1}class fm{static get(e){return e.state}gl;program=null;stateStack=[];enable=!0;cache=null;log;initialized=!1;constructor(e,r){this.gl=e,this.log=r?.log||(()=>{}),this._updateCache=this._updateCache.bind(this),Object.seal(this)}push(e={}){this.stateStack.push({})}pop(){const e=this.stateStack[this.stateStack.length-1];X0(this.gl,e),this.stateStack.pop()}trackState(e,r){if(this.cache=r.copyState?Fte(e):Object.assign({},rD),this.initialized)throw new Error("WebGLStateTracker");this.initialized=!0,this.gl.state=this,ZUe(e);for(const n in vH){const i=vH[n];YUe(e,n,i)}bH(e,"getParameter"),bH(e,"isEnabled")}_updateCache(e){let r=!1,n;const i=this.stateStack.length>0?this.stateStack[this.stateStack.length-1]:null;for(const a in e){const s=e[a],o=this.cache[a];XUe(s,o)||(r=!0,n=o,i&&!(a in i)&&(i[a]=o),this.cache[a]=s)}return{valueChanged:r,oldValue:n}}}function bH(t,e){const r=t[e].bind(t);t[e]=function(i){if(i===void 0||HUe.has(i))return r(i);const a=fm.get(t);return i in a.cache||(a.cache[i]=r(i)),a.enable?a.cache[i]:r(i)},Object.defineProperty(t[e],"name",{value:`${e}-from-cache`,configurable:!1})}function YUe(t,e,r){if(!t[e])return;const n=t[e].bind(t);t[e]=function(...a){const s=fm.get(t),{valueChanged:o,oldValue:u}=r(s._updateCache,...a);return o&&n(...a),u},Object.defineProperty(t[e],"name",{value:`${e}-to-cache`,configurable:!1})}function ZUe(t){const e=t.useProgram.bind(t);t.useProgram=function(n){const i=fm.get(t);i.program!==n&&(e(n),i.program=n)}}function KUe(t,e,r){let n="";const i={preserveDrawingBuffer:!0,...r};let a=null;if(a||=t.getContext("webgl2",i),i.failIfMajorPerformanceCaveat&&(n||="Only software GPU is available. Set `failIfMajorPerformanceCaveat: false` to allow."),!a&&!r.failIfMajorPerformanceCaveat&&(i.failIfMajorPerformanceCaveat=!1,a=t.getContext("webgl2",i),a.luma||={},a.luma.softwareRenderer=!0),a||(a=t.getContext("webgl",{}),a&&(a=null,n||="Your browser only supports WebGL1")),!a)throw n||="Your browser does not support WebGL",new Error(`Failed to create WebGL context: ${n}`);const{onContextLost:s,onContextRestored:o}=e;return t.addEventListener("webglcontextlost",u=>s(u),!1),t.addEventListener("webglcontextrestored",u=>o(u),!1),a.luma||={},a}function A0(t,e,r){return r[e]===void 0&&(r[e]=t.getExtension(e)||null),r[e]}function JUe(t,e){const r=t.getParameter(7936),n=t.getParameter(7937);A0(t,"WEBGL_debug_renderer_info",e);const i=e.WEBGL_debug_renderer_info,a=t.getParameter(i?i.UNMASKED_VENDOR_WEBGL:7936),s=t.getParameter(i?i.UNMASKED_RENDERER_WEBGL:7937),o=a||r,u=s||n,h=t.getParameter(7938),f=Bte(o,u),g=QUe(o,u),b=eVe(o,u);return{type:"webgl",gpu:f,gpuType:b,gpuBackend:g,vendor:o,renderer:u,version:h,shadingLanguage:"glsl",shadingLanguageVersion:300}}function Bte(t,e){return/NVIDIA/i.exec(t)||/NVIDIA/i.exec(e)?"nvidia":/INTEL/i.exec(t)||/INTEL/i.exec(e)?"intel":/Apple/i.exec(t)||/Apple/i.exec(e)?"apple":/AMD/i.exec(t)||/AMD/i.exec(e)||/ATI/i.exec(t)||/ATI/i.exec(e)?"amd":/SwiftShader/i.exec(t)||/SwiftShader/i.exec(e)?"software":"unknown"}function QUe(t,e){return/Metal/i.exec(t)||/Metal/i.exec(e)?"metal":/ANGLE/i.exec(t)||/ANGLE/i.exec(e)?"opengl":"unknown"}function eVe(t,e){if(/SwiftShader/i.exec(t)||/SwiftShader/i.exec(e))return"cpu";switch(Bte(t,e)){case"intel":return"integrated";case"software":return"cpu";case"unknown":return"unknown";default:return"discrete"}}function zte(t){switch(t){case"uint8":return 5121;case"sint8":return 5120;case"unorm8":return 5121;case"snorm8":return 5120;case"uint16":return 5123;case"sint16":return 5122;case"unorm16":return 5123;case"snorm16":return 5122;case"uint32":return 5125;case"sint32":return 5124;case"float16":return 5131;case"float32":return 5126}throw new Error(String(t))}const m1="WEBGL_compressed_texture_s3tc",y1="WEBGL_compressed_texture_s3tc_srgb",Ov="EXT_texture_compression_rgtc",Lv="EXT_texture_compression_bptc",tVe="WEBGL_compressed_texture_etc",rVe="WEBGL_compressed_texture_astc",nVe="WEBGL_compressed_texture_etc1",iVe="WEBGL_compressed_texture_pvrtc",aVe="WEBGL_compressed_texture_atc",xH="EXT_texture_norm16",wH="EXT_render_snorm",oVe="EXT_color_buffer_float",nD={"float32-renderable-webgl":["EXT_color_buffer_float"],"float16-renderable-webgl":["EXT_color_buffer_half_float"],"rgb9e5ufloat-renderable-webgl":["WEBGL_render_shared_exponent"],"snorm8-renderable-webgl":[wH],"norm16-renderable-webgl":[xH],"snorm16-renderable-webgl":[xH,wH],"float32-filterable":["OES_texture_float_linear"],"float16-filterable-webgl":["OES_texture_half_float_linear"],"texture-filterable-anisotropic-webgl":["EXT_texture_filter_anisotropic"],"texture-blend-float-webgl":["EXT_float_blend"],"texture-compression-bc":[m1,y1,Ov,Lv],"texture-compression-bc5-webgl":[Ov],"texture-compression-bc7-webgl":[Lv],"texture-compression-etc2":[tVe],"texture-compression-astc":[rVe],"texture-compression-etc1-webgl":[nVe],"texture-compression-pvrtc-webgl":[iVe],"texture-compression-atc-webgl":[aVe]};function sVe(t){return t in nD}function lVe(t,e,r){return(nD[e]||[]).every(i=>A0(t,i,r))}const iD={r8unorm:{gl:33321,rb:!0},r8snorm:{gl:36756},r8uint:{gl:33330,rb:!0},r8sint:{gl:33329,rb:!0},rg8unorm:{gl:33323,rb:!0},rg8snorm:{gl:36757},rg8uint:{gl:33336,rb:!0},rg8sint:{gl:33335,rb:!0},r16uint:{gl:33332,rb:!0},r16sint:{gl:33331,rb:!0},r16float:{gl:33325,rb:!0},"r16unorm-webgl":{gl:33322,rb:!0},"r16snorm-webgl":{gl:36760},"rgba4unorm-webgl":{gl:32854,rb:!0},"rgb565unorm-webgl":{gl:36194,rb:!0},"rgb5a1unorm-webgl":{gl:32855,rb:!0},"rgb8unorm-webgl":{gl:32849},"rgb8snorm-webgl":{gl:36758},rgba8unorm:{gl:32856},"rgba8unorm-srgb":{gl:35907},rgba8snorm:{gl:36759},rgba8uint:{gl:36220},rgba8sint:{gl:36238},bgra8unorm:{},"bgra8unorm-srgb":{},rg16uint:{gl:33338},rg16sint:{gl:33337},rg16float:{gl:33327,rb:!0},"rg16unorm-webgl":{gl:33324},"rg16snorm-webgl":{gl:36761},r32uint:{gl:33334,rb:!0},r32sint:{gl:33333,rb:!0},r32float:{gl:33326},rgb9e5ufloat:{gl:35901},rg11b10ufloat:{gl:35898,rb:!0},rgb10a2unorm:{gl:32857,rb:!0},"rgb10a2uint-webgl":{gl:36975,rb:!0},"rgb16unorm-webgl":{gl:32852},"rgb16snorm-webgl":{gl:36762},rg32uint:{gl:33340,rb:!0},rg32sint:{gl:33339,rb:!0},rg32float:{gl:33328,rb:!0},rgba16uint:{gl:36214,rb:!0},rgba16sint:{gl:36232,rb:!0},rgba16float:{gl:34842},"rgba16unorm-webgl":{gl:32859,rb:!0},"rgba16snorm-webgl":{gl:36763},"rgb32float-webgl":{gl:34837,x:oVe,dataFormat:6407,types:[5126]},rgba32uint:{gl:36208,rb:!0},rgba32sint:{gl:36226,rb:!0},rgba32float:{gl:34836,rb:!0},stencil8:{gl:36168,rb:!0},depth16unorm:{gl:33189,dataFormat:6402,types:[5123],rb:!0},depth24plus:{gl:33190,dataFormat:6402,types:[5125]},depth32float:{gl:36012,dataFormat:6402,types:[5126],rb:!0},"depth24plus-stencil8":{gl:35056,rb:!0,depthTexture:!0,dataFormat:34041,types:[34042]},"depth32float-stencil8":{gl:36013,dataFormat:34041,types:[36269],rb:!0},"bc1-rgb-unorm-webgl":{gl:33776,x:m1},"bc1-rgb-unorm-srgb-webgl":{gl:35916,x:y1},"bc1-rgba-unorm":{gl:33777,x:m1},"bc1-rgba-unorm-srgb":{gl:35916,x:y1},"bc2-rgba-unorm":{gl:33778,x:m1},"bc2-rgba-unorm-srgb":{gl:35918,x:y1},"bc3-rgba-unorm":{gl:33779,x:m1},"bc3-rgba-unorm-srgb":{gl:35919,x:y1},"bc4-r-unorm":{gl:36283,x:Ov},"bc4-r-snorm":{gl:36284,x:Ov},"bc5-rg-unorm":{gl:36285,x:Ov},"bc5-rg-snorm":{gl:36286,x:Ov},"bc6h-rgb-ufloat":{gl:36495,x:Lv},"bc6h-rgb-float":{gl:36494,x:Lv},"bc7-rgba-unorm":{gl:36492,x:Lv},"bc7-rgba-unorm-srgb":{gl:36493,x:Lv},"etc2-rgb8unorm":{gl:37492},"etc2-rgb8unorm-srgb":{gl:37494},"etc2-rgb8a1unorm":{gl:37496},"etc2-rgb8a1unorm-srgb":{gl:37497},"etc2-rgba8unorm":{gl:37493},"etc2-rgba8unorm-srgb":{gl:37495},"eac-r11unorm":{gl:37488},"eac-r11snorm":{gl:37489},"eac-rg11unorm":{gl:37490},"eac-rg11snorm":{gl:37491},"astc-4x4-unorm":{gl:37808},"astc-4x4-unorm-srgb":{gl:37840},"astc-5x4-unorm":{gl:37809},"astc-5x4-unorm-srgb":{gl:37841},"astc-5x5-unorm":{gl:37810},"astc-5x5-unorm-srgb":{gl:37842},"astc-6x5-unorm":{gl:37811},"astc-6x5-unorm-srgb":{gl:37843},"astc-6x6-unorm":{gl:37812},"astc-6x6-unorm-srgb":{gl:37844},"astc-8x5-unorm":{gl:37813},"astc-8x5-unorm-srgb":{gl:37845},"astc-8x6-unorm":{gl:37814},"astc-8x6-unorm-srgb":{gl:37846},"astc-8x8-unorm":{gl:37815},"astc-8x8-unorm-srgb":{gl:37847},"astc-10x5-unorm":{gl:37819},"astc-10x5-unorm-srgb":{gl:37851},"astc-10x6-unorm":{gl:37817},"astc-10x6-unorm-srgb":{gl:37849},"astc-10x8-unorm":{gl:37818},"astc-10x8-unorm-srgb":{gl:37850},"astc-10x10-unorm":{gl:37819},"astc-10x10-unorm-srgb":{gl:37851},"astc-12x10-unorm":{gl:37820},"astc-12x10-unorm-srgb":{gl:37852},"astc-12x12-unorm":{gl:37821},"astc-12x12-unorm-srgb":{gl:37853},"pvrtc-rgb4unorm-webgl":{gl:35840},"pvrtc-rgba4unorm-webgl":{gl:35842},"pvrtc-rbg2unorm-webgl":{gl:35841},"pvrtc-rgba2unorm-webgl":{gl:35843},"etc1-rbg-unorm-webgl":{gl:36196},"atc-rgb-unorm-webgl":{gl:35986},"atc-rgba-unorm-webgl":{gl:35986},"atc-rgbai-unorm-webgl":{gl:34798}};function uVe(t,e,r){let n=e.create;const i=iD[e.format];return i?.gl===void 0&&(n=!1),i?.x&&(n=n&&!!A0(t,i.x,r)),{format:e.format,create:n&&e.create,render:n&&e.render,filter:n&&e.filter,blend:n&&e.blend,store:n&&e.store}}function jte(t){const e=iD[t],r=fVe(t),n=kN(t);return{internalFormat:r,format:e?.dataFormat||hVe(n.channels,n.integer,n.normalized,r),type:n.dataType?zte(n.dataType):e?.types?.[0]||5121,compressed:n.compressed||!1}}function cVe(t){switch(kN(t).attachment){case"depth":return 36096;case"stencil":return 36128;case"depth-stencil":return 33306;default:throw new Error(`Not a depth stencil format: ${t}`)}}function hVe(t,e,r,n){if(n===6408||n===6407)return n;switch(t){case"r":return e&&!r?36244:6403;case"rg":return e&&!r?33320:33319;case"rgb":return e&&!r?36248:6407;case"rgba":return e&&!r?36249:6408;case"bgra":throw new Error("bgra pixels not supported by WebGL");default:return 6408}}function fVe(t){const r=iD[t]?.gl;if(r===void 0)throw new Error(`Unsupported texture format ${t}`);return r}const SH={"depth-clip-control":"EXT_depth_clamp","timer-query-webgl":"EXT_disjoint_timer_query_webgl2","compilation-status-async-webgl":"KHR_parallel_shader_compile","polygon-mode-webgl":"WEBGL_polygon_mode","provoking-vertex-webgl":"WEBGL_provoking_vertex","shader-clip-cull-distance-webgl":"WEBGL_clip_cull_distance","shader-noperspective-interpolation-webgl":"NV_shader_noperspective_interpolation","shader-conservative-depth-webgl":"EXT_conservative_depth"};class dVe extends Z8e{gl;extensions;testedFeatures=new Set;constructor(e,r,n){super([],n),this.gl=e,this.extensions=r,A0(e,"EXT_color_buffer_float",r)}*[Symbol.iterator](){const e=this.getFeatures();for(const r of e)this.has(r)&&(yield r);return[]}has(e){return this.disabledFeatures?.[e]?!1:(this.testedFeatures.has(e)||(this.testedFeatures.add(e),sVe(e)&&lVe(this.gl,e,this.extensions)&&this.features.add(e),this.getWebGLFeature(e)&&this.features.add(e)),this.features.has(e))}initializeFeatures(){const e=this.getFeatures().filter(r=>r!=="polygon-mode-webgl");for(const r of e)this.has(r)}getFeatures(){return[...Object.keys(SH),...Object.keys(nD)]}getWebGLFeature(e){const r=SH[e];return typeof r=="string"?!!A0(this.gl,r,this.extensions):!!r}}class pVe extends Y8e{get maxTextureDimension1D(){return 0}get maxTextureDimension2D(){return this.getParameter(3379)}get maxTextureDimension3D(){return this.getParameter(32883)}get maxTextureArrayLayers(){return this.getParameter(35071)}get maxBindGroups(){return 0}get maxDynamicUniformBuffersPerPipelineLayout(){return 0}get maxDynamicStorageBuffersPerPipelineLayout(){return 0}get maxSampledTexturesPerShaderStage(){return this.getParameter(35660)}get maxSamplersPerShaderStage(){return this.getParameter(35661)}get maxStorageBuffersPerShaderStage(){return 0}get maxStorageTexturesPerShaderStage(){return 0}get maxUniformBuffersPerShaderStage(){return this.getParameter(35375)}get maxUniformBufferBindingSize(){return this.getParameter(35376)}get maxStorageBufferBindingSize(){return 0}get minUniformBufferOffsetAlignment(){return this.getParameter(35380)}get minStorageBufferOffsetAlignment(){return 0}get maxVertexBuffers(){return 16}get maxVertexAttributes(){return this.getParameter(34921)}get maxVertexBufferArrayStride(){return 2048}get maxInterStageShaderComponents(){return this.getParameter(35659)}get maxComputeWorkgroupStorageSize(){return 0}get maxComputeInvocationsPerWorkgroup(){return 0}get maxComputeWorkgroupSizeX(){return 0}get maxComputeWorkgroupSizeY(){return 0}get maxComputeWorkgroupSizeZ(){return 0}get maxComputeWorkgroupsPerDimension(){return 0}gl;limits={};constructor(e){super(),this.gl=e}getParameter(e){return this.limits[e]===void 0&&(this.limits[e]=this.gl.getParameter(e)),this.limits[e]||0}}class U1 extends tC{device;gl;handle;colorAttachments=[];depthStencilAttachment=null;constructor(e,r){super(e,r);const n=r.handle===null;this.device=e,this.gl=e.gl,this.handle=this.props.handle||n?this.props.handle:this.gl.createFramebuffer(),n||(e.setSpectorMetadata(this.handle,{id:this.props.id,props:this.props}),this.autoCreateAttachmentTextures(),this.updateAttachments())}destroy(){super.destroy(),!this.destroyed&&this.handle!==null&&this.gl.deleteFramebuffer(this.handle)}updateAttachments(){const e=this.gl.bindFramebuffer(36160,this.handle);for(let r=0;r<this.colorAttachments.length;++r){const n=this.colorAttachments[r];if(n){const i=36064+r;this._attachTextureView(i,n)}}if(this.depthStencilAttachment){const r=cVe(this.depthStencilAttachment.props.format);this._attachTextureView(r,this.depthStencilAttachment)}if(this.device.props.debug){const r=this.gl.checkFramebufferStatus(36160);if(r!==36053)throw new Error(`Framebuffer ${mVe(r)}`)}this.gl.bindFramebuffer(36160,e)}_attachTextureView(e,r){const{gl:n}=this.device,{texture:i}=r,a=r.props.baseMipLevel,s=r.props.baseArrayLayer;switch(n.bindTexture(i.glTarget,i.handle),i.glTarget){case 35866:case 32879:n.framebufferTextureLayer(36160,e,i.handle,a,s);break;case 34067:const o=gVe(s);n.framebufferTexture2D(36160,e,o,i.handle,a);break;case 3553:n.framebufferTexture2D(36160,e,3553,i.handle,a);break;default:throw new Error("Illegal texture type")}n.bindTexture(i.glTarget,null)}}function gVe(t){return t<34069?t+34069:t}function mVe(t){switch(t){case 36053:return"success";case 36054:return"Mismatched attachments";case 36055:return"No attachments";case 36057:return"Height/width mismatch";case 36061:return"Unsupported or split attachments";case 36182:return"Samples mismatch";default:return`${t}`}}class yVe extends MN{device;format="rgba8unorm";depthStencilFormat="depth24plus";presentationSize;_framebuffer=null;get[Symbol.toStringTag](){return"WebGLCanvasContext"}constructor(e,r){super(r),this.device=e,this.presentationSize=[-1,-1],this._setAutoCreatedCanvasId(`${this.device.id}-canvas`),this.update()}getCurrentFramebuffer(){return this.update(),this._framebuffer=this._framebuffer||new U1(this.device,{handle:null}),this._framebuffer}update(){const e=this.getPixelSize();(e[0]!==this.presentationSize[0]||e[1]!==this.presentationSize[1])&&(this.presentationSize=e,this.resize())}resize(e){if(this.device.gl&&this.canvas){const r=this.getDevicePixelRatio(e?.useDevicePixels);this.setDevicePixelRatio(r,e);return}}commit(){}}async function Ute(t,e){const r=document.getElementsByTagName("head")[0];if(!r)throw new Error("loadScript");const n=document.createElement("script");return n.setAttribute("type","text/javascript"),n.setAttribute("src",t),new Promise((i,a)=>{n.onload=i,n.onerror=s=>a(new Error(`Unable to load script '${t}': ${s}`)),r.appendChild(n)})}const vVe=1;let Hc=null,EH=!1;const aD={debugSpectorJS:dn.get("debug-spectorjs"),debugSpectorJSUrl:"https://cdn.jsdelivr.net/npm/spectorjs@0.9.30/dist/spector.bundle.js",gl:void 0};async function _Ve(t){if(!globalThis.SPECTOR)try{await Ute(t.debugSpectorJSUrl||aD.debugSpectorJSUrl)}catch(e){dn.warn(String(e))}}function bVe(t){if(t={...aD,...t},!t.debugSpectorJS)return null;if(!Hc&&globalThis.SPECTOR&&!globalThis.luma?.spector){dn.probe(vVe,"SPECTOR found and initialized. Start with `luma.spector.displayUI()`")();const{Spector:e}=globalThis.SPECTOR;Hc=new e,globalThis.luma&&(globalThis.luma.spector=Hc)}if(!Hc)return null;if(EH||(EH=!0,Hc.spyCanvases(),Hc?.onCaptureStarted.add(e=>dn.info("Spector capture started:",e)()),Hc?.onCapture.add(e=>{dn.info("Spector capture complete:",e)(),Hc?.getResultUI(),Hc?.resultView.display(),Hc?.resultView.addCapture(e)})),t.gl){const e=t.gl,r=e.device;Hc?.startCapture(t.gl,500),e.device=r,new Promise(n=>setTimeout(n,2e3)).then(n=>{dn.info("Spector capture stopped after 2 seconds")(),Hc?.stopCapture()})}return Hc}const xVe="https://unpkg.com/webgl-debug@2.0.1/index.js";function Vte(t){return t.luma=t.luma||{},t.luma}async function wVe(){Zm()&&!globalThis.WebGLDebugUtils&&(globalThis.global=globalThis.global||globalThis,globalThis.global.module={},await Ute(xVe))}function SVe(t,e={}){return e.debugWebGL||e.traceWebGL?TVe(t,e):EVe(t)}function EVe(t){const e=Vte(t);return e.realContext?e.realContext:t}function TVe(t,e){if(!globalThis.WebGLDebugUtils)return dn.warn("webgl-debug not loaded")(),t;const r=Vte(t);if(r.debugContext)return r.debugContext;globalThis.WebGLDebugUtils.init({...Rv,...t});const n=globalThis.WebGLDebugUtils.makeDebugContext(t,CVe.bind(null,e),AVe.bind(null,e));for(const s in Rv)!(s in n)&&typeof Rv[s]=="number"&&(n[s]=Rv[s]);class i{}Object.setPrototypeOf(n,Object.getPrototypeOf(t)),Object.setPrototypeOf(i,n);const a=Object.create(i);return r.realContext=t,r.debugContext=a,a.debug=!0,a}function TH(t,e){e=Array.from(e).map(n=>n===void 0?"undefined":n);let r=globalThis.WebGLDebugUtils.glFunctionArgsToString(t,e);return r=`${r.slice(0,100)}${r.length>100?"...":""}`,`gl.${t}(${r})`}function CVe(t,e,r,n){n=Array.from(n).map(o=>o===void 0?"undefined":o);const i=globalThis.WebGLDebugUtils.glEnumToString(e),a=globalThis.WebGLDebugUtils.glFunctionArgsToString(r,n),s=`${i} in gl.${r}(${a})`;dn.error(s)();debugger}function AVe(t,e,r){let n="";dn.level>=1&&(n=TH(e,r),t.traceWebGL&&dn.log(1,n)());for(const i of r)if(i===void 0){n=n||TH(e,r);debugger}}const eP={};function IVe(t="id"){eP[t]=eP[t]||1;const e=eP[t]++;return`${t}-${e}`}class V1 extends Oo{device;gl;handle;glTarget;glUsage;glIndexType=5123;byteLength;bytesUsed;constructor(e,r={}){super(e,r),this.device=e,this.gl=this.device.gl;const n=typeof r=="object"?r.handle:void 0;this.handle=n||this.gl.createBuffer(),e.setSpectorMetadata(this.handle,{...this.props,data:typeof this.props.data}),this.glTarget=PVe(this.props.usage),this.glUsage=kVe(this.props.usage),this.glIndexType=this.props.indexType==="uint32"?5125:5123,r.data?this._initWithData(r.data,r.byteOffset,r.byteLength):this._initWithByteLength(r.byteLength||0)}_initWithData(e,r=0,n=e.byteLength+r){const i=this.glTarget;this.gl.bindBuffer(i,this.handle),this.gl.bufferData(i,n,this.glUsage),this.gl.bufferSubData(i,r,e),this.gl.bindBuffer(i,null),this.bytesUsed=n,this.byteLength=n,this._setDebugData(e,r,n),this.trackAllocatedMemory(n)}_initWithByteLength(e){let r=e;e===0&&(r=new Float32Array(0));const n=this.glTarget;return this.gl.bindBuffer(n,this.handle),this.gl.bufferData(n,r,this.glUsage),this.gl.bindBuffer(n,null),this.bytesUsed=e,this.byteLength=e,this._setDebugData(null,0,e),this.trackAllocatedMemory(e),this}destroy(){!this.destroyed&&this.handle&&(this.removeStats(),this.trackDeallocatedMemory(),this.gl.deleteBuffer(this.handle),this.destroyed=!0,this.handle=null)}write(e,r=0){this.gl.bindBuffer(36663,this.handle),this.gl.bufferSubData(36663,r,e),this.gl.bindBuffer(36663,null),this._setDebugData(e,r,e.byteLength)}async readAsync(e=0,r){return this.readSyncWebGL(e,r)}readSyncWebGL(e=0,r){r=r??this.byteLength-e;const n=new Uint8Array(r),i=0;return this.gl.bindBuffer(36662,this.handle),this.gl.getBufferSubData(36662,e,n,i,r),this.gl.bindBuffer(36662,null),this._setDebugData(n,e,r),n}}function PVe(t){return t&Oo.INDEX?34963:t&Oo.VERTEX?34962:t&Oo.UNIFORM?35345:34962}function kVe(t){return t&Oo.INDEX||t&Oo.VERTEX?35044:t&Oo.UNIFORM?35048:35044}function MVe(t){const e=t.split(/\r?\n/),r=[];for(const n of e){if(n.length<=1)continue;const i=n.split(":");if(i.length===2){const[g,b]=i;r.push({message:b.trim(),type:CH(g),lineNum:0,linePos:0});continue}const[a,s,o,...u]=i;let h=parseInt(o,10);isNaN(h)&&(h=0);let f=parseInt(s,10);isNaN(f)&&(f=0),r.push({message:u.join(":").trim(),type:CH(a),lineNum:h,linePos:f})}return r}function CH(t){const e=["warning","error","info"],r=t.toLowerCase();return e.includes(r)?r:"info"}class RVe extends eC{device;handle;constructor(e,r){switch(super(e,r),this.device=e,this.props.stage){case"vertex":this.handle=this.props.handle||this.device.gl.createShader(35633);break;case"fragment":this.handle=this.props.handle||this.device.gl.createShader(35632);break;default:throw new Error(this.props.stage)}this._compile(this.source)}destroy(){this.handle&&(this.removeStats(),this.device.gl.deleteShader(this.handle),this.destroyed=!0)}get asyncCompilationStatus(){return this._waitForCompilationComplete().then(()=>this.compilationStatus)}async getCompilationInfo(){return await this._waitForCompilationComplete(),this.getCompilationInfoSync()}getCompilationInfoSync(){const e=this.device.gl.getShaderInfoLog(this.handle);return e?MVe(e):[]}getTranslatedSource(){return this.device.getExtension("WEBGL_debug_shaders").WEBGL_debug_shaders?.getTranslatedShaderSource(this.handle)||null}async _compile(e){e=e.startsWith("#version ")?e:`#version 300 es
${e}`;const{gl:r}=this.device;if(r.shaderSource(this.handle,e),r.compileShader(this.handle),!this.device.props.debug){this.compilationStatus="pending";return}if(!this.device.features.has("compilation-status-async-webgl")){if(this._getCompilationStatus(),this.debugShader(),this.compilationStatus==="error")throw new Error(`GLSL compilation errors in ${this.props.stage} shader ${this.props.id}`);return}dn.once(1,"Shader compilation is asynchronous")(),await this._waitForCompilationComplete(),dn.info(2,`Shader ${this.id} - async compilation complete: ${this.compilationStatus}`)(),this._getCompilationStatus(),this.debugShader()}async _waitForCompilationComplete(){const e=async i=>await new Promise(a=>setTimeout(a,i));if(!this.device.features.has("compilation-status-async-webgl")){await e(10);return}const{gl:n}=this.device;for(;;){if(n.getShaderParameter(this.handle,37297))return;await e(10)}}_getCompilationStatus(){this.compilationStatus=this.device.gl.getShaderParameter(this.handle,35713)?"success":"error"}}function OVe(t,e,r,n){if(FVe(e))return n(t);const i=t;i.pushState();try{return LVe(t,e),X0(i.gl,r),n(t)}finally{i.popState()}}function LVe(t,e){const r=t,{gl:n}=r;if(e.cullMode)switch(e.cullMode){case"none":n.disable(2884);break;case"front":n.enable(2884),n.cullFace(1028);break;case"back":n.enable(2884),n.cullFace(1029);break}if(e.frontFace&&n.frontFace(dm("frontFace",e.frontFace,{ccw:2305,cw:2304})),e.unclippedDepth&&t.features.has("depth-clip-control")&&n.enable(34383),e.depthBias!==void 0&&(n.enable(32823),n.polygonOffset(e.depthBias,e.depthBiasSlopeScale||0)),e.provokingVertex&&t.features.has("provoking-vertex-webgl")){const a=r.getExtension("WEBGL_provoking_vertex").WEBGL_provoking_vertex,s=dm("provokingVertex",e.provokingVertex,{first:36429,last:36430});a?.provokingVertexWEBGL(s)}if((e.polygonMode||e.polygonOffsetLine)&&t.features.has("polygon-mode-webgl")){if(e.polygonMode){const a=r.getExtension("WEBGL_polygon_mode").WEBGL_polygon_mode,s=dm("polygonMode",e.polygonMode,{fill:6914,line:6913});a?.polygonModeWEBGL(1028,s),a?.polygonModeWEBGL(1029,s)}e.polygonOffsetLine&&n.enable(10754)}if(t.features.has("shader-clip-cull-distance-webgl")&&(e.clipDistance0&&n.enable(12288),e.clipDistance1&&n.enable(12289),e.clipDistance2&&n.enable(12290),e.clipDistance3&&n.enable(12291),e.clipDistance4&&n.enable(12292),e.clipDistance5&&n.enable(12293),e.clipDistance6&&n.enable(12294),e.clipDistance7&&n.enable(12295)),e.depthWriteEnabled!==void 0&&n.depthMask(DVe("depthWriteEnabled",e.depthWriteEnabled)),e.depthCompare&&(e.depthCompare!=="always"?n.enable(2929):n.disable(2929),n.depthFunc(sR("depthCompare",e.depthCompare))),e.stencilWriteMask){const i=e.stencilWriteMask;n.stencilMaskSeparate(1028,i),n.stencilMaskSeparate(1029,i)}if(e.stencilReadMask&&dn.warn("stencilReadMask not supported under WebGL"),e.stencilCompare){const i=e.stencilReadMask||4294967295,a=sR("depthCompare",e.stencilCompare);e.stencilCompare!=="always"?n.enable(2960):n.disable(2960),n.stencilFuncSeparate(1028,a,0,i),n.stencilFuncSeparate(1029,a,0,i)}if(e.stencilPassOperation&&e.stencilFailOperation&&e.stencilDepthFailOperation){const i=tP("stencilPassOperation",e.stencilPassOperation),a=tP("stencilFailOperation",e.stencilFailOperation),s=tP("stencilDepthFailOperation",e.stencilDepthFailOperation);n.stencilOpSeparate(1028,a,s,i),n.stencilOpSeparate(1029,a,s,i)}switch(e.blend){case!0:n.enable(3042);break;case!1:n.disable(3042);break}if(e.blendColorOperation||e.blendAlphaOperation){const i=AH("blendColorOperation",e.blendColorOperation||"add"),a=AH("blendAlphaOperation",e.blendAlphaOperation||"add");n.blendEquationSeparate(i,a);const s=ew("blendColorSrcFactor",e.blendColorSrcFactor||"one"),o=ew("blendColorDstFactor",e.blendColorDstFactor||"zero"),u=ew("blendAlphaSrcFactor",e.blendAlphaSrcFactor||"one"),h=ew("blendAlphaDstFactor",e.blendAlphaDstFactor||"zero");n.blendFuncSeparate(s,o,u,h)}}function sR(t,e){return dm(t,e,{never:512,less:513,equal:514,"less-equal":515,greater:516,"not-equal":517,"greater-equal":518,always:519})}function tP(t,e){return dm(t,e,{keep:7680,zero:0,replace:7681,invert:5386,"increment-clamp":7682,"decrement-clamp":7683,"increment-wrap":34055,"decrement-wrap":34056})}function AH(t,e){return dm(t,e,{add:32774,subtract:32778,"reverse-subtract":32779,min:32775,max:32776})}function ew(t,e){return dm(t,e,{one:1,zero:0,"src-color":768,"one-minus-src-color":769,"dst-color":774,"one-minus-dst-color":775,"src-alpha":770,"one-minus-src-alpha":771,"dst-alpha":772,"one-minus-dst-alpha":773,"src-alpha-saturated":776,"constant-color":32769,"one-minus-constant-color":32770,"constant-alpha":32771,"one-minus-constant-alpha":32772})}function NVe(t,e){return`Illegal parameter ${e} for ${t}`}function dm(t,e,r){if(!(e in r))throw new Error(NVe(t,e));return r[e]}function DVe(t,e){return e}function FVe(t){let e=!0;for(const r in t){e=!1;break}return e}function $te(t){const e={};return t.addressModeU&&(e[10242]=rP(t.addressModeU)),t.addressModeV&&(e[10243]=rP(t.addressModeV)),t.addressModeW&&(e[32882]=rP(t.addressModeW)),t.magFilter&&(e[10240]=lR(t.magFilter)),(t.minFilter||t.mipmapFilter)&&(e[10241]=BVe(t.minFilter||"linear",t.mipmapFilter)),t.lodMinClamp!==void 0&&(e[33082]=t.lodMinClamp),t.lodMaxClamp!==void 0&&(e[33083]=t.lodMaxClamp),t.type==="comparison-sampler"&&(e[34892]=34894),t.compare&&(e[34893]=sR("compare",t.compare)),t.maxAnisotropy&&(e[34046]=t.maxAnisotropy),e}function rP(t){switch(t){case"clamp-to-edge":return 33071;case"repeat":return 10497;case"mirror-repeat":return 33648}}function lR(t){switch(t){case"nearest":return 9728;case"linear":return 9729}}function BVe(t,e="none"){if(!e)return lR(t);switch(e){case"none":return lR(t);case"nearest":return t==="nearest"?9984:9986;case"linear":return t==="nearest"?9985:9987}}class uR extends Tb{device;handle;parameters;constructor(e,r){super(e,r),this.device=e,this.parameters=$te(r),this.handle=this.handle||this.device.gl.createSampler(),this._setSamplerParameters(this.parameters)}destroy(){this.handle&&(this.device.gl.deleteSampler(this.handle),this.handle=void 0)}toString(){return`Sampler(${this.id},${JSON.stringify(this.props)})`}_setSamplerParameters(e){for(const[r,n]of Object.entries(e)){const i=Number(r);switch(i){case 33082:case 33083:this.device.gl.samplerParameterf(this.handle,i,n);break;default:this.device.gl.samplerParameteri(this.handle,i,n);break}}}}class Nv extends QT{device;gl;handle;texture;constructor(e,r){super(e,{...yo.defaultProps,...r}),this.device=e,this.gl=this.device.gl,this.handle=null,this.texture=r.texture}}const zVe="Failed to deduce GL constant from typed array";function jVe(t){switch(ArrayBuffer.isView(t)?t.constructor:t){case Float32Array:return 5126;case Uint16Array:return 5123;case Uint32Array:return 5125;case Uint8Array:return 5121;case Uint8ClampedArray:return 5121;case Int8Array:return 5120;case Int16Array:return 5122;case Int32Array:return 5124;default:throw new Error(zVe)}}function UVe(t,e){const{clamped:r=!0}=e||{};switch(t){case 5126:return Float32Array;case 5123:case 33635:case 32819:case 32820:return Uint16Array;case 5125:return Uint32Array;case 5121:return r?Uint8ClampedArray:Uint8Array;case 5120:return Int8Array;case 5122:return Int16Array;case 5124:return Int32Array;default:throw new Error("Failed to deduce typed array type from GL constant")}}function qte(t){switch(t){case 6406:case 33326:case 6403:case 36244:return 1;case 33339:case 33340:case 33328:case 33320:case 33319:return 2;case 6407:case 36248:case 34837:return 3;case 6408:case 36249:case 34836:return 4;default:return 0}}function VVe(t){switch(t){case 5121:return 1;case 33635:case 32819:case 32820:return 2;case 5126:return 4;default:return 0}}function SE(t,e,r){if($Ve(e))return r(t);const{nocatch:n=!0}=e,i=fm.get(t);i.push(),X0(t,e);let a;if(n)a=r(t),i.pop();else try{a=r(t)}finally{i.pop()}return a}function $Ve(t){for(const e in t)return!1;return!0}function qVe(t,e,r){const{dimension:n,width:i,height:a,depth:s=0}=r,{glInternalFormat:o}=r,u=r.glTarget;switch(n){case"2d-array":case"3d":t.texStorage3D(u,e,o,i,a,s);break;default:t.texStorage2D(u,e,o,i,a)}}function IH(t,e,r,n){const{width:i,height:a}=n,{dimension:s,depth:o=0,mipLevel:u=0}=n,{x:h=0,y:f=0,z:g=0}=n,{glFormat:b,glType:v}=n,S=Hte(n.glTarget,s,o),E=n.flipY?{37440:!0}:{};SE(t,E,()=>{switch(s){case"2d-array":case"3d":t.bindTexture(S,e),t.texSubImage3D(S,u,h,f,g,i,a,o,b,v,r),t.bindTexture(S,null);break;case"2d":case"cube":t.bindTexture(S,e),t.texSubImage2D(S,u,h,f,i,a,b,v,r),t.bindTexture(S,null);break;default:throw new Error(s)}})}function PH(t,e,r){const{dimension:n,width:i,height:a,depth:s=0,mipLevel:o=0,byteOffset:u=0}=r,{x:h=0,y:f=0,z:g=0}=r,{glFormat:b,glType:v,compressed:S}=r,E=Hte(r.glTarget,n,s);switch(n){case"2d-array":case"3d":S?t.compressedTexSubImage3D(E,o,h,f,g,i,a,s,b,e,u):t.texSubImage3D(E,o,h,f,g,i,a,s,b,v,e,u);break;case"2d":case"cube":S?t.compressedTexSubImage2D(E,o,h,f,i,a,b,e,u):t.texSubImage2D(E,o,h,f,i,a,b,v,e,u);break;default:throw new Error(n)}}function HVe(t){switch(t){case"1d":break;case"2d":return 3553;case"3d":return 32879;case"cube":return 34067;case"2d-array":return 35866}throw new Error(t)}function Hte(t,e,r){return e==="cube"?34069+r:t}function WVe(t,e){const{sourceX:r=0,sourceY:n=0,sourceAttachment:i=0}=e||{};let{target:a=null,sourceWidth:s,sourceHeight:o,sourceDepth:u,sourceFormat:h,sourceType:f}=e||{};const{framebuffer:g,deleteFramebuffer:b}=Wte(t),{gl:v,handle:S}=g;s||=g.width,o||=g.height;const E=g.colorAttachments[i]?.texture;if(!E)throw new Error(`Invalid framebuffer attachment ${i}`);u=E?.depth||1,h||=E?.glFormat||6408,f||=E?.glType||5121,a=YVe(a,f,h,s,o),f=f||jVe(a);const P=v.bindFramebuffer(36160,S);return v.readBuffer(36064+i),v.readPixels(r,n,s,o,h,f,a),v.readBuffer(36064),v.bindFramebuffer(36160,P||null),b&&g.destroy(),a}function GVe(t,e){const{target:r,sourceX:n=0,sourceY:i=0,sourceFormat:a=6408,targetByteOffset:s=0}=e||{};let{sourceWidth:o,sourceHeight:u,sourceType:h}=e||{};const{framebuffer:f,deleteFramebuffer:g}=Wte(t);o=o||f.width,u=u||f.height;const b=f;h=h||5121;let v=r;if(!v){const E=qte(a),P=VVe(h),k=s+o*u*E*P;v=b.device.createBuffer({byteLength:k})}const S=t.device.createCommandEncoder();return S.copyTextureToBuffer({sourceTexture:t,width:o,height:u,origin:[n,i],destinationBuffer:v,byteOffset:s}),S.destroy(),g&&f.destroy(),v}function Wte(t){return t instanceof tC?{framebuffer:t,deleteFramebuffer:!1}:{framebuffer:XVe(t),deleteFramebuffer:!0}}function XVe(t,e){const{device:r,width:n,height:i,id:a}=t;return r.createFramebuffer({...e,id:`framebuffer-for-${a}`,width:n,height:i,colorAttachments:[t]})}function YVe(t,e,r,n,i,a){if(t)return t;e||=5121;const s=UVe(e,{clamped:!1}),o=qte(r);return new s(n*i*o)}class $1 extends yo{device;gl;handle;sampler=void 0;view=void 0;mipmaps;compressed;glTarget;glFormat;glType;glInternalFormat;textureUnit=0;constructor(e,r){super(e,r);const n={...this.props};n.data=r.data,this.device=e,this.gl=this.device.gl,this.glTarget=HVe(this.props.dimension);const i=jte(this.props.format);this.glInternalFormat=i.internalFormat,this.glFormat=i.format,this.glType=i.type,this.compressed=i.compressed,this.mipmaps=!!this.props.mipmaps,this._initialize(n),Object.seal(this)}_initialize(e){this.handle=this.props.handle||this.gl.createTexture(),this.device.setSpectorMetadata(this.handle,{...this.props,data:e.data});let{width:r,height:n}=e;if(!r||!n){const i=yo.getTextureDataSize(e.data);r=i?.width||1,n=i?.height||1}if(this.width=r,this.height=n,this.depth=e.depth,this.setSampler(e.sampler),this.view=new Nv(this.device,{...this.props,texture:this}),this.bind(),qVe(this.gl,this.mipLevels,this),e.data)switch(e.dimension){case"1d":this.setTexture1DData(e.data);break;case"2d":this.setTexture2DData(e.data);break;case"3d":this.setTexture3DData(e.data);break;case"cube":this.setTextureCubeData(e.data);break;case"2d-array":this.setTextureArrayData(e.data);break;case"cube-array":this.setTextureCubeArrayData(e.data);break;default:throw new Error(e.dimension)}this.mipmaps&&this.generateMipmap()}destroy(){this.handle&&(this.gl.deleteTexture(this.handle),this.removeStats(),this.trackDeallocatedMemory("Texture"),this.destroyed=!0)}createView(e){return new Nv(this.device,{...e,texture:this})}setSampler(e={}){let r;e instanceof uR?(this.sampler=e,r=e.props):(this.sampler=new uR(this.device,e),r=e);const n=$te(r);this._setSamplerParameters(n)}generateMipmap(e){if(!(!(this.device.isTextureFormatRenderable(this.props.format)&&this.device.isTextureFormatFilterable(this.props.format))&&(dn.warn(`${this} is not renderable or filterable, may not be able to generate mipmaps`)(),!e?.force)))try{this.gl.bindTexture(this.glTarget,this.handle),this.gl.generateMipmap(this.glTarget)}catch(n){dn.warn(`Error generating mipmap for ${this}: ${n.message}`)()}finally{this.gl.bindTexture(this.glTarget,null)}}copyExternalImage(e){const r=yo.getExternalImageSize(e.image),n={...yo.defaultCopyExternalImageOptions,...r,...e},{image:i,depth:a,mipLevel:s,x:o,y:u,z:h,flipY:f}=n;let{width:g,height:b}=n;const{dimension:v,glTarget:S,glFormat:E,glInternalFormat:P,glType:k}=this;if(g=Math.min(g,this.width-o),b=Math.min(b,this.height-u),e.sourceX||e.sourceY)throw new Error("WebGL does not support sourceX/sourceY)");return IH(this.device.gl,this.handle,i,{dimension:v,mipLevel:s,x:o,y:u,z:h,width:g,height:b,depth:a,glFormat:E,glType:k,glTarget:S,flipY:f}),{width:n.width,height:n.height}}setTexture1DData(e){throw new Error("setTexture1DData not supported in WebGL.")}setTexture2DData(e,r=0){this.bind();const n=yo.normalizeTextureData(e,this);n.length>1&&this.props.mipmaps!==!1&&dn.warn(`Texture ${this.id} mipmap and multiple LODs.`)();for(let i=0;i<n.length;i++){const a=n[i];this._setMipLevel(r,i,a)}this.unbind()}setTexture3DData(e){if(this.props.dimension!=="3d")throw new Error(this.id);ArrayBuffer.isView(e)&&(this.bind(),PH(this.device.gl,e,this),this.unbind())}setTextureCubeData(e,r=0){if(this.props.dimension!=="cube")throw new Error(this.id);for(const n of yo.CubeFaces)this.setTextureCubeFaceData(e[n],n)}setTextureArrayData(e){throw this.props.dimension!=="2d-array"?new Error(this.id):new Error("setTextureArrayData not implemented.")}setTextureCubeArrayData(e){throw new Error("setTextureCubeArrayData not supported in WebGL2.")}setTextureCubeFaceData(e,r,n=0){Array.isArray(e)&&e.length>1&&this.props.mipmaps!==!1&&dn.warn(`${this.id} has mipmap and multiple LODs.`)();const i=yo.CubeFaces.indexOf(r);this.setTexture2DData(e,i)}update(){throw new Error("Texture.update() not implemented. Use ExternalTexture")}setImageDataForFace(e){const{face:r,width:n,height:i,pixels:a,data:s,format:o=6408,type:u=5121}=e,{gl:h}=this,f=a||s;this.bind(),f instanceof Promise?f.then(g=>this.setImageDataForFace(Object.assign({},e,{face:r,data:g,pixels:g}))):this.width||this.height?h.texImage2D(r,0,o,n,i,0,o,u,f):h.texImage2D(r,0,o,o,u,f)}_getImageDataMap(e){for(let r=0;r<yo.CubeFaces.length;++r){const n=yo.CubeFaces[r];e[n]&&(e[34069+r]=e[n],delete e[n])}return e}_setSamplerParameters(e){dn.log(1,`${this.id} sampler parameters`,this.device.getGLKeys(e))(),this.gl.bindTexture(this.glTarget,this.handle);for(const[r,n]of Object.entries(e)){const i=Number(r),a=n;switch(i){case 33082:case 33083:this.gl.texParameterf(this.glTarget,i,a);break;case 10241:this.gl.texParameteri(this.glTarget,i,a);break;case 10242:case 10243:this.gl.texParameteri(this.glTarget,i,a);break;case 34046:this.device.features.has("texture-filterable-anisotropic-webgl")&&this.gl.texParameteri(this.glTarget,i,a);break;default:this.gl.texParameteri(this.glTarget,i,a);break}}this.gl.bindTexture(this.glTarget,null)}_setMipLevel(e,r,n,i=this.glTarget){if(yo.isExternalImage(n)){IH(this.device.gl,this.handle,n,{...this,depth:e,mipLevel:r,glTarget:i,flipY:this.props.flipY});return}if(yo.isTextureLevelData(n)){PH(this.device.gl,n.data,{...this,depth:e,mipLevel:r,glTarget:i});return}throw new Error("Texture: invalid image data")}getActiveUnit(){return this.gl.getParameter(34016)-33984}bind(e){const{gl:r}=this;return e!==void 0&&(this.textureUnit=e,r.activeTexture(33984+e)),r.bindTexture(this.glTarget,this.handle),e}unbind(e){const{gl:r}=this;return e!==void 0&&(this.textureUnit=e,r.activeTexture(33984+e)),r.bindTexture(this.glTarget,null),e}}const ZVe=[1,2,4,8];class KVe extends Xg{device;glParameters;constructor(e,r){super(e,r),this.device=e;let n;if(!r?.parameters?.viewport)if(r?.framebuffer){const{width:a,height:s}=r.framebuffer;n=[0,0,a,s]}else{const[a,s]=e.getCanvasContext().getDrawingBufferSize();n=[0,0,a,s]}if(this.device.pushState(),this.setParameters({viewport:n,...this.props.parameters}),this.props.framebuffer?.handle)if(this.props.framebuffer){const a=this.props.framebuffer.colorAttachments.map((s,o)=>36064+o);this.device.gl.drawBuffers(a)}else this.device.gl.drawBuffers([1029]);this.clear()}end(){this.device.popState()}pushDebugGroup(e){}popDebugGroup(){}insertDebugMarker(e){}setParameters(e={}){const r={...this.glParameters};r.framebuffer=this.props.framebuffer||null,this.props.depthReadOnly&&(r.depthMask=!this.props.depthReadOnly),r.stencilMask=this.props.stencilReadOnly?0:1,r[35977]=this.props.discard,e.viewport&&(e.viewport.length>=6?(r.viewport=e.viewport.slice(0,4),r.depthRange=[e.viewport[4],e.viewport[5]]):r.viewport=e.viewport),e.scissorRect&&(r.scissorTest=!0,r.scissor=e.scissorRect),e.blendConstant&&(r.blendColor=e.blendConstant),e.stencilReference&&(console.warn("RenderPassParameters.stencilReference not yet implemented in WebGL"),e[2967]=e.stencilReference),e.colorMask&&(r.colorMask=ZVe.map(n=>!!(n&e.colorMask))),this.glParameters=r,X0(this.device.gl,r)}beginOcclusionQuery(e){this.props.occlusionQuerySet?.beginOcclusionQuery()}endOcclusionQuery(){this.props.occlusionQuerySet?.endOcclusionQuery()}clear(){const e={...this.glParameters};let r=0;this.props.clearColors&&this.props.clearColors.forEach((n,i)=>{n&&this.clearColorBuffer(i,n)}),this.props.clearColor!==!1&&this.props.clearColors===void 0&&(r|=16384,e.clearColor=this.props.clearColor),this.props.clearDepth!==!1&&(r|=256,e.clearDepth=this.props.clearDepth),this.props.clearStencil!==!1&&(r|=1024,e.clearStencil=this.props.clearStencil),r!==0&&SE(this.device.gl,e,()=>{this.device.gl.clear(r)})}clearColorBuffer(e=0,r=[0,0,0,0]){SE(this.device.gl,{framebuffer:this.props.framebuffer},()=>{switch(r.constructor){case Int8Array:case Int16Array:case Int32Array:this.device.gl.clearBufferiv(6144,e,r);break;case Uint8Array:case Uint8ClampedArray:case Uint16Array:case Uint32Array:this.device.gl.clearBufferuiv(6144,e,r);break;case Float32Array:this.device.gl.clearBufferfv(6144,e,r);break;default:throw new Error("clearColorBuffer: color must be typed array")}})}}function JVe(t){return QVe.includes(t)}const QVe=[35678,35680,35679,35682,36289,36292,36293,36298,36299,36300,36303,36306,36307,36308,36311],Gte={5126:[5126,1,"float","f32","float32"],35664:[5126,2,"vec2","vec2<f32>","float32x2"],35665:[5126,3,"vec3","vec3<f32>","float32x3"],35666:[5126,4,"vec4","vec4<f32>","float32x4"],5124:[5124,1,"int","i32","sint32"],35667:[5124,2,"ivec2","vec2<i32>","sint32x2"],35668:[5124,3,"ivec3","vec3<i32>","sint32x3"],35669:[5124,4,"ivec4","vec4<i32>","sint32x4"],5125:[5125,1,"uint","u32","uint32"],36294:[5125,2,"uvec2","vec2<u32>","uint32x2"],36295:[5125,3,"uvec3","vec3<u32>","uint32x3"],36296:[5125,4,"uvec4","vec4<u32>","uint32x4"],35670:[5126,1,"bool","f32","float32"],35671:[5126,2,"bvec2","vec2<f32>","float32x2"],35672:[5126,3,"bvec3","vec3<f32>","float32x3"],35673:[5126,4,"bvec4","vec4<f32>","float32x4"],35674:[5126,8,"mat2","mat2x2<f32>"],35685:[5126,8,"mat2x3","mat2x3<f32>"],35686:[5126,8,"mat2x4","mat2x4<f32>"],35687:[5126,12,"mat3x2","mat3x2<f32>"],35675:[5126,12,"mat3","mat3x3<f32>"],35688:[5126,12,"mat3x4","mat3x4<f32>"],35689:[5126,16,"mat4x2","mat4x2<f32>"],35690:[5126,16,"mat4x3","mat4x3<f32>"],35676:[5126,16,"mat4","mat4x4<f32>"]};function Xte(t){const e=Gte[t];if(!e)throw new Error("uniform");const[r,n,,i]=e;return{format:i,components:n,glType:r}}function e$e(t){const e=Gte[t];if(!e)throw new Error("attribute");const[,r,,n,i]=e;return{attributeType:n,vertexFormat:i,components:r}}function t$e(t,e){const r={attributes:[],bindings:[]};r.attributes=r$e(t,e);const n=a$e(t,e);for(const o of n){const u=o.uniforms.map(h=>({name:h.name,format:h.format,byteOffset:h.byteOffset,byteStride:h.byteStride,arrayLength:h.arrayLength}));r.bindings.push({type:"uniform",name:o.name,group:0,location:o.location,visibility:(o.vertex?1:0)&(o.fragment?2:0),minBindingSize:o.byteLength,uniforms:u})}const i=i$e(t,e);let a=0;for(const o of i)if(JVe(o.type)){const{viewDimension:u,sampleType:h}=s$e(o.type);r.bindings.push({type:"texture",name:o.name,group:0,location:a,viewDimension:u,sampleType:h}),o.textureUnit=a,a+=1}i.length&&(r.uniforms=i);const s=n$e(t,e);return s?.length&&(r.varyings=s),r}function r$e(t,e){const r=[],n=t.getProgramParameter(e,35721);for(let i=0;i<n;i++){const a=t.getActiveAttrib(e,i);if(!a)throw new Error("activeInfo");const{name:s,type:o}=a,u=t.getAttribLocation(e,s);if(u>=0){const{attributeType:h}=e$e(o),f=/instance/i.test(s)?"instance":"vertex";r.push({name:s,location:u,stepMode:f,type:h})}}return r.sort((i,a)=>i.location-a.location),r}function n$e(t,e){const r=[],n=t.getProgramParameter(e,35971);for(let i=0;i<n;i++){const a=t.getTransformFeedbackVarying(e,i);if(!a)throw new Error("activeInfo");const{name:s,type:o,size:u}=a,{glType:h,components:f}=Xte(o),g={location:i,name:s,type:h,size:u*f};r.push(g)}return r.sort((i,a)=>i.location-a.location),r}function i$e(t,e){const r=[],n=t.getProgramParameter(e,35718);for(let i=0;i<n;i++){const a=t.getActiveUniform(e,i);if(!a)throw new Error("activeInfo");const{name:s,size:o,type:u}=a,{name:h,isArray:f}=l$e(s);let g=t.getUniformLocation(e,h);const b={location:g,name:h,size:o,type:u,isArray:f};if(r.push(b),b.size>1)for(let v=0;v<b.size;v++){const S=`${h}[${v}]`;g=t.getUniformLocation(e,S);const E={...b,name:S,location:g};r.push(E)}}return r}function a$e(t,e){const r=(a,s)=>t.getActiveUniformBlockParameter(e,a,s),n=[],i=t.getProgramParameter(e,35382);for(let a=0;a<i;a++){const s={name:t.getActiveUniformBlockName(e,a)||"",location:r(a,35391),byteLength:r(a,35392),vertex:r(a,35396),fragment:r(a,35398),uniformCount:r(a,35394),uniforms:[]},o=r(a,35395)||[],u=t.getActiveUniforms(e,o,35383),h=t.getActiveUniforms(e,o,35384),f=t.getActiveUniforms(e,o,35387),g=t.getActiveUniforms(e,o,35388);for(let b=0;b<s.uniformCount;++b){const v=t.getActiveUniform(e,o[b]);if(!v)throw new Error("activeInfo");s.uniforms.push({name:v.name,format:Xte(u[b]).format,type:u[b],arrayLength:h[b],byteOffset:f[b],byteStride:g[b]})}n.push(s)}return n.sort((a,s)=>a.location-s.location),n}const o$e={35678:["2d","float"],35680:["cube","float"],35679:["3d","float"],35682:["3d","depth"],36289:["2d-array","float"],36292:["2d-array","depth"],36293:["cube","float"],36298:["2d","sint"],36299:["3d","sint"],36300:["cube","sint"],36303:["2d-array","uint"],36306:["2d","uint"],36307:["3d","uint"],36308:["cube","uint"],36311:["2d-array","uint"]};function s$e(t){const e=o$e[t];if(!e)throw new Error("sampler");const[r,n]=e;return{viewDimension:r,sampleType:n}}function l$e(t){if(t[t.length-1]!=="]")return{name:t,length:1,isArray:!1};const r=/([^[]*)(\[[0-9]+\])?/.exec(t);if(!r||r.length<2)throw new Error(`Failed to parse GLSL uniform name ${t}`);return{name:r[1],length:r[2]?1:0,isArray:!!r[2]}}function u$e(t,e,r,n){const i=t;let a=n;a===!0&&(a=1),a===!1&&(a=0);const s=typeof a=="number"?[a]:a;switch(r){case 35678:case 35680:case 35679:case 35682:case 36289:case 36292:case 36293:case 36298:case 36299:case 36300:case 36303:case 36306:case 36307:case 36308:case 36311:if(typeof n!="number")throw new Error("samplers must be set to integers");return t.uniform1i(e,n);case 5126:return t.uniform1fv(e,s);case 35664:return t.uniform2fv(e,s);case 35665:return t.uniform3fv(e,s);case 35666:return t.uniform4fv(e,s);case 5124:return t.uniform1iv(e,s);case 35667:return t.uniform2iv(e,s);case 35668:return t.uniform3iv(e,s);case 35669:return t.uniform4iv(e,s);case 35670:return t.uniform1iv(e,s);case 35671:return t.uniform2iv(e,s);case 35672:return t.uniform3iv(e,s);case 35673:return t.uniform4iv(e,s);case 5125:return i.uniform1uiv(e,s,1);case 36294:return i.uniform2uiv(e,s,2);case 36295:return i.uniform3uiv(e,s,3);case 36296:return i.uniform4uiv(e,s,4);case 35674:return t.uniformMatrix2fv(e,!1,s);case 35675:return t.uniformMatrix3fv(e,!1,s);case 35676:return t.uniformMatrix4fv(e,!1,s);case 35685:return i.uniformMatrix2x3fv(e,!1,s);case 35686:return i.uniformMatrix2x4fv(e,!1,s);case 35687:return i.uniformMatrix3x2fv(e,!1,s);case 35688:return i.uniformMatrix3x4fv(e,!1,s);case 35689:return i.uniformMatrix4x2fv(e,!1,s);case 35690:return i.uniformMatrix4x3fv(e,!1,s)}throw new Error("Illegal uniform")}function c$e(t){return Ate(t)!==null||typeof t=="number"||typeof t=="boolean"}function h$e(t){const e={bindings:{},uniforms:{}};return Object.keys(t).forEach(r=>{const n=t[r];c$e(n)?e.uniforms[r]=n:e.bindings[r]=n}),e}function f$e(t){switch(t){case"point-list":return 0;case"line-list":return 1;case"line-strip":return 3;case"triangle-list":return 4;case"triangle-strip":return 5;default:throw new Error(t)}}function d$e(t){switch(t){case"point-list":return 0;case"line-list":return 1;case"line-strip":return 1;case"triangle-list":return 4;case"triangle-strip":return 4;default:throw new Error(t)}}const kH=4;class p$e extends _0{device;handle;vs;fs;introspectedLayout;uniforms={};bindings={};varyings=null;_uniformCount=0;_uniformSetters={};constructor(e,r){super(e,r),this.device=e,this.handle=this.props.handle||this.device.gl.createProgram(),this.device.setSpectorMetadata(this.handle,{id:this.props.id}),this.vs=r.vs,this.fs=r.fs;const{varyings:n,bufferMode:i=35981}=r;n&&n.length>0&&(this.varyings=n,this.device.gl.transformFeedbackVaryings(this.handle,n,i)),this._linkShaders(),dn.time(1,`RenderPipeline ${this.id} - shaderLayout introspection`)(),this.introspectedLayout=t$e(this.device.gl,this.handle),dn.timeEnd(1,`RenderPipeline ${this.id} - shaderLayout introspection`)(),this.shaderLayout=g$e(this.introspectedLayout,r.shaderLayout)}destroy(){this.handle&&(this.device.gl.deleteProgram(this.handle),this.destroyed=!0)}setBindings(e,r){for(const[n,i]of Object.entries(e)){const a=this.shaderLayout.bindings.find(s=>s.name===n)||this.shaderLayout.bindings.find(s=>s.name===`${n}Uniforms`);if(!a){const s=this.shaderLayout.bindings.map(o=>`"${o.name}"`).join(", ");r?.disableWarnings||dn.warn(`No binding "${n}" in render pipeline "${this.id}", expected one of ${s}`,i)();continue}switch(i||dn.warn(`Unsetting binding "${n}" in render pipeline "${this.id}"`)(),a.type){case"uniform":if(!(i instanceof V1)&&!(i.buffer instanceof V1))throw new Error("buffer value");break;case"texture":if(!(i instanceof Nv||i instanceof $1||i instanceof U1))throw new Error("texture value");break;case"sampler":dn.warn(`Ignoring sampler ${n}`)();break;default:throw new Error(a.type)}this.bindings[n]=i}}draw(e){const{renderPass:r,parameters:n=this.props.parameters,topology:i=this.props.topology,vertexArray:a,vertexCount:s,instanceCount:o,isInstanced:u=!1,firstVertex:h=0,transformFeedback:f}=e,g=f$e(i),b=!!a.indexBuffer,v=a.indexBuffer?.glIndexType;if(this.linkStatus!=="success")return dn.info(2,`RenderPipeline:${this.id}.draw() aborted - waiting for shader linking`)(),!1;if(!this._areTexturesRenderable())return dn.info(2,`RenderPipeline:${this.id}.draw() aborted - textures not yet loaded`)(),!1;this.device.gl.useProgram(this.handle),a.bindBeforeRender(r),f&&f.begin(this.props.topology),this._applyBindings(),this._applyUniforms();const S=r;return OVe(this.device,n,S.glParameters,()=>{b&&u?this.device.gl.drawElementsInstanced(g,s||0,v,h,o||0):b?this.device.gl.drawElements(g,s||0,v,h):u?this.device.gl.drawArraysInstanced(g,h,s||0,o||0):this.device.gl.drawArrays(g,h,s||0),f&&f.end()}),a.unbindAfterRender(r),!0}setUniformsWebGL(e){const{bindings:r}=h$e(e);Object.keys(r).forEach(n=>{dn.warn(`Unsupported value "${JSON.stringify(r[n])}" used in setUniforms() for key ${n}. Use setBindings() instead?`)()}),Object.assign(this.uniforms,e)}async _linkShaders(){const{gl:e}=this.device;if(e.attachShader(this.handle,this.vs.handle),e.attachShader(this.handle,this.fs.handle),dn.time(kH,`linkProgram for ${this.id}`)(),e.linkProgram(this.handle),dn.timeEnd(kH,`linkProgram for ${this.id}`)(),dn.level,!this.device.features.has("compilation-status-async-webgl")){const n=this._getLinkStatus();this._reportLinkStatus(n);return}dn.once(1,"RenderPipeline linking is asynchronous")(),await this._waitForLinkComplete(),dn.info(2,`RenderPipeline ${this.id} - async linking complete: ${this.linkStatus}`)();const r=this._getLinkStatus();this._reportLinkStatus(r)}async _reportLinkStatus(e){switch(e){case"success":return;default:switch(this.vs.compilationStatus){case"error":throw this.vs.debugShader(),new Error(`Error during compilation of shader ${this.vs.id}`);case"pending":this.vs.asyncCompilationStatus.then(()=>this.vs.debugShader());break}switch(this.fs?.compilationStatus){case"error":throw this.fs.debugShader(),new Error(`Error during compilation of shader ${this.fs.id}`);case"pending":this.fs.asyncCompilationStatus.then(()=>this.fs.debugShader());break}const r=this.device.gl.getProgramInfoLog(this.handle);throw new Error(`Error during ${e}: ${r}`)}}_getLinkStatus(){const{gl:e}=this.device;return e.getProgramParameter(this.handle,35714)?(e.validateProgram(this.handle),e.getProgramParameter(this.handle,35715)?(this.linkStatus="success","success"):(this.linkStatus="error","validation")):(this.linkStatus="error","linking")}async _waitForLinkComplete(){const e=async i=>await new Promise(a=>setTimeout(a,i));if(!this.device.features.has("compilation-status-async-webgl")){await e(10);return}const{gl:n}=this.device;for(;;){if(n.getProgramParameter(this.handle,37297))return;await e(10)}}_areTexturesRenderable(){let e=!0;for(const r of this.shaderLayout.bindings)!this.bindings[r.name]&&!this.bindings[r.name.replace(/Uniforms$/,"")]&&(dn.warn(`Binding ${r.name} not found in ${this.id}`)(),e=!1);return e}_applyBindings(){if(this.linkStatus!=="success")return;const{gl:e}=this.device;e.useProgram(this.handle);let r=0,n=0;for(const i of this.shaderLayout.bindings){const a=this.bindings[i.name]||this.bindings[i.name.replace(/Uniforms$/,"")];if(!a)throw new Error(`No value for binding ${i.name} in ${this.id}`);switch(i.type){case"uniform":const{name:s}=i,o=e.getUniformBlockIndex(this.handle,s);if(o===4294967295)throw new Error(`Invalid uniform block name ${s}`);e.uniformBlockBinding(this.handle,n,o),a instanceof V1?e.bindBufferBase(35345,n,a.handle):e.bindBufferRange(35345,n,a.buffer.handle,a.offset||0,a.size||a.buffer.byteLength-a.offset),n+=1;break;case"texture":if(!(a instanceof Nv||a instanceof $1||a instanceof U1))throw new Error("texture");let u;if(a instanceof Nv)u=a.texture;else if(a instanceof $1)u=a;else if(a instanceof U1&&a.colorAttachments[0]instanceof Nv)dn.warn("Passing framebuffer in texture binding may be deprecated. Use fbo.colorAttachments[0] instead")(),u=a.colorAttachments[0].texture;else throw new Error("No texture");e.activeTexture(33984+r),e.bindTexture(u.glTarget,u.handle),r+=1;break;case"sampler":break;case"storage":case"read-only-storage":throw new Error(`binding type '${i.type}' not supported in WebGL`)}}}_applyUniforms(){for(const e of this.shaderLayout.uniforms||[]){const{name:r,location:n,type:i,textureUnit:a}=e,s=this.uniforms[r]??a;s!==void 0&&u$e(this.device.gl,n,i,s)}}}function g$e(t,e){const r={...t,attributes:t.attributes.map(n=>({...n}))};for(const n of e?.attributes||[]){const i=r.attributes.find(a=>a.name===n.name);i?(i.type=n.type||i.type,i.stepMode=n.stepMode||i.stepMode):dn.warn(`shader layout attribute ${n.name} not present in shader`)}return r}class m$e extends ON{device;commands=[];constructor(e){super(e,{}),this.device=e}submitCommands(e=this.commands){for(const r of e)switch(r.name){case"copy-buffer-to-buffer":y$e(this.device,r.options);break;case"copy-buffer-to-texture":v$e(this.device,r.options);break;case"copy-texture-to-buffer":_$e(this.device,r.options);break;case"copy-texture-to-texture":b$e(this.device,r.options);break;default:throw new Error(r.name)}}}function y$e(t,e){const r=e.sourceBuffer,n=e.destinationBuffer;t.gl.bindBuffer(36662,r.handle),t.gl.bindBuffer(36663,n.handle),t.gl.copyBufferSubData(36662,36663,e.sourceOffset??0,e.destinationOffset??0,e.size),t.gl.bindBuffer(36662,null),t.gl.bindBuffer(36663,null)}function v$e(t,e){throw new Error("Not implemented")}function _$e(t,e){const{sourceTexture:r,mipLevel:n=0,aspect:i="all",width:a=e.sourceTexture.width,height:s=e.sourceTexture.height,depthOrArrayLayers:o=0,origin:u=[0,0],destinationBuffer:h,byteOffset:f=0,bytesPerRow:g,rowsPerImage:b}=e;if(i!=="all")throw new Error("aspect not supported in WebGL");if(n!==0||o!==0||g||b)throw new Error("not implemented");const{framebuffer:v,destroyFramebuffer:S}=Yte(r);let E;try{const P=h,k=a||v.width,L=s||v.height,O=jte(v.colorAttachments[0].texture.props.format),M=O.format,z=O.type;t.gl.bindBuffer(35051,P.handle),E=t.gl.bindFramebuffer(36160,v.handle),t.gl.readPixels(u[0],u[1],k,L,M,z,f)}finally{t.gl.bindBuffer(35051,null),E!==void 0&&t.gl.bindFramebuffer(36160,E),S&&v.destroy()}}function b$e(t,e){const{sourceTexture:r,destinationMipLevel:n=0,origin:i=[0,0],destinationOrigin:a=[0,0],destinationTexture:s}=e;let{width:o=e.destinationTexture.width,height:u=e.destinationTexture.height}=e;const{framebuffer:h,destroyFramebuffer:f}=Yte(r),[g,b]=i,[v,S,E]=a,P=t.gl.bindFramebuffer(36160,h.handle);let k=null,L;if(s instanceof $1)k=s,o=Number.isFinite(o)?o:k.width,u=Number.isFinite(u)?u:k.height,k.bind(0),L=k.glTarget;else throw new Error("invalid destination");switch(L){case 3553:case 34067:t.gl.copyTexSubImage2D(L,n,v,S,g,b,o,u);break;case 35866:case 32879:t.gl.copyTexSubImage3D(L,n,v,S,E,g,b,o,u);break}k&&k.unbind(),t.gl.bindFramebuffer(36160,P),f&&h.destroy()}function Yte(t){if(t instanceof yo){const{width:e,height:r,id:n}=t;return{framebuffer:t.device.createFramebuffer({id:`framebuffer-for-${n}`,width:e,height:r,colorAttachments:[t]}),destroyFramebuffer:!0}}return{framebuffer:t,destroyFramebuffer:!1}}class x$e extends RN{device;commandBuffer;constructor(e,r){super(e,r),this.device=e,this.commandBuffer=new m$e(e)}destroy(){}finish(){this.commandBuffer.submitCommands()}copyBufferToBuffer(e){this.commandBuffer.commands.push({name:"copy-buffer-to-buffer",options:e})}copyBufferToTexture(e){this.commandBuffer.commands.push({name:"copy-buffer-to-texture",options:e})}copyTextureToBuffer(e){this.commandBuffer.commands.push({name:"copy-texture-to-buffer",options:e})}copyTextureToTexture(e){this.commandBuffer.commands.push({name:"copy-texture-to-texture",options:e})}pushDebugGroup(e){}popDebugGroup(){}insertDebugMarker(e){}resolveQuerySet(e,r,n){}}function w$e(t){const{target:e,source:r,start:n=0,count:i=1}=t,a=r.length,s=i*a;let o=0;for(let u=n;o<a;o++)e[u++]=r[o];for(;o<s;)o<s-o?(e.copyWithin(n+o,n,n+o),o*=2):(e.copyWithin(n+o,n,n+s-o),o=s);return t.target}class oD extends LN{get[Symbol.toStringTag](){return"VertexArray"}device;handle;buffer=null;bufferValue=null;static isConstantAttributeZeroSupported(e){return zDe()==="Chrome"}constructor(e,r){super(e,r),this.device=e,this.handle=this.device.gl.createVertexArray()}destroy(){super.destroy(),this.buffer&&this.buffer?.destroy(),this.handle&&(this.device.gl.deleteVertexArray(this.handle),this.handle=void 0)}setIndexBuffer(e){const r=e;if(r&&r.glTarget!==34963)throw new Error("Use .setBuffer()");this.device.gl.bindVertexArray(this.handle),this.device.gl.bindBuffer(34963,r?r.handle:null),this.indexBuffer=r,this.device.gl.bindVertexArray(null)}setBuffer(e,r){const n=r;if(n.glTarget===34963)throw new Error("Use .setIndexBuffer()");const{size:i,type:a,stride:s,offset:o,normalized:u,integer:h,divisor:f}=this._getAccessor(e);this.device.gl.bindVertexArray(this.handle),this.device.gl.bindBuffer(34962,n.handle),h?this.device.gl.vertexAttribIPointer(e,i,a,s,o):this.device.gl.vertexAttribPointer(e,i,a,u,s,o),this.device.gl.bindBuffer(34962,null),this.device.gl.enableVertexAttribArray(e),this.device.gl.vertexAttribDivisor(e,f||0),this.attributes[e]=n,this.device.gl.bindVertexArray(null)}setConstantWebGL(e,r){this._enable(e,!1),this.attributes[e]=r}bindBeforeRender(){this.device.gl.bindVertexArray(this.handle),this._applyConstantAttributes()}unbindAfterRender(){this.device.gl.bindVertexArray(null)}_applyConstantAttributes(){for(let e=0;e<this.maxVertexAttributes;++e){const r=this.attributes[e];ArrayBuffer.isView(r)&&this.device.setConstantAttributeWebGL(e,r)}}_getAccessor(e){const r=this.attributeInfos[e];if(!r)throw new Error(`Unknown attribute location ${e}`);const n=zte(r.bufferDataType);return{size:r.bufferComponents,type:n,stride:r.byteStride,offset:r.byteOffset,normalized:r.normalized,integer:r.integer,divisor:r.stepMode==="instance"?1:0}}_enable(e,r=!0){const i=oD.isConstantAttributeZeroSupported(this.device)||e!==0;(r||i)&&(e=Number(e),this.device.gl.bindVertexArray(this.handle),r?this.device.gl.enableVertexAttribArray(e):this.device.gl.disableVertexAttribArray(e),this.device.gl.bindVertexArray(null))}getConstantBuffer(e,r){const n=S$e(r),i=n.byteLength*e,a=n.length*e;if(this.buffer&&i!==this.buffer.byteLength)throw new Error(`Buffer size is immutable, byte length ${i} !== ${this.buffer.byteLength}.`);let s=!this.buffer;if(this.buffer=this.buffer||this.device.createBuffer({byteLength:i}),s=s||!E$e(n,this.bufferValue),s){const o=TBe(r.constructor,a);w$e({target:o,source:n,start:0,count:a}),this.buffer.write(o),this.bufferValue=r}return this.buffer}}function S$e(t){return Array.isArray(t)?new Float32Array(t):t}function E$e(t,e){if(!t||!e||t.length!==e.length||t.constructor!==e.constructor)return!1;for(let r=0;r<t.length;++r)if(t[r]!==e[r])return!1;return!0}class T$e extends NN{device;gl;handle;layout;buffers={};unusedBuffers={};bindOnUse=!0;_bound=!1;constructor(e,r){super(e,r),this.device=e,this.gl=e.gl,this.handle=this.props.handle||this.gl.createTransformFeedback(),this.layout=this.props.layout,r.buffers&&this.setBuffers(r.buffers),Object.seal(this)}destroy(){this.gl.deleteTransformFeedback(this.handle),super.destroy()}begin(e="point-list"){this.gl.bindTransformFeedback(36386,this.handle),this.bindOnUse&&this._bindBuffers(),this.gl.beginTransformFeedback(d$e(e))}end(){this.gl.endTransformFeedback(),this.bindOnUse&&this._unbindBuffers(),this.gl.bindTransformFeedback(36386,null)}setBuffers(e){this.buffers={},this.unusedBuffers={},this.bind(()=>{for(const r in e)this.setBuffer(r,e[r])})}setBuffer(e,r){const n=this._getVaryingIndex(e),{buffer:i,byteLength:a,byteOffset:s}=this._getBufferRange(r);if(n<0){this.unusedBuffers[e]=i,dn.warn(`${this.id} unusedBuffers varying buffer ${e}`)();return}this.buffers[n]={buffer:i,byteLength:a,byteOffset:s},this.bindOnUse||this._bindBuffer(n,i,s,a)}getBuffer(e){if(MH(e))return this.buffers[e]||null;const r=this._getVaryingIndex(e);return r>=0?this.buffers[r]:null}bind(e=this.handle){if(typeof e!="function")return this.gl.bindTransformFeedback(36386,e),this;let r;return this._bound?r=e():(this.gl.bindTransformFeedback(36386,this.handle),this._bound=!0,r=e(),this._bound=!1,this.gl.bindTransformFeedback(36386,null)),r}unbind(){this.bind(null)}_getBufferRange(e){if(e instanceof V1)return{buffer:e,byteOffset:0,byteLength:e.byteLength};const{buffer:r,byteOffset:n=0,byteLength:i=e.buffer.byteLength}=e;return{buffer:r,byteOffset:n,byteLength:i}}_getVaryingIndex(e){if(MH(e))return Number(e);for(const r of this.layout.varyings)if(e===r.name)return r.location;return-1}_bindBuffers(){for(const e in this.buffers){const{buffer:r,byteLength:n,byteOffset:i}=this._getBufferRange(this.buffers[e]);this._bindBuffer(Number(e),r,i,n)}}_unbindBuffers(){for(const e in this.buffers)this.gl.bindBufferBase(35982,Number(e),null)}_bindBuffer(e,r,n=0,i){const a=r&&r.handle;!a||i===void 0?this.gl.bindBufferBase(35982,e,a):this.gl.bindBufferRange(35982,e,a,n,i)}}function MH(t){return typeof t=="number"?Number.isInteger(t):/^\d+$/.test(t)}class C$e extends DN{device;handle;target=null;_queryPending=!1;_pollingPromise=null;get[Symbol.toStringTag](){return"Query"}constructor(e,r){if(super(e,r),this.device=e,r.count>1)throw new Error("WebGL QuerySet can only have one value");this.handle=this.device.gl.createQuery(),Object.seal(this)}destroy(){this.device.gl.deleteQuery(this.handle)}beginTimestampQuery(){return this._begin(35007)}endTimestampQuery(){this._end()}beginOcclusionQuery(e){return this._begin(e?.conservative?36202:35887)}endOcclusionQuery(){this._end()}beginTransformFeedbackQuery(){return this._begin(35976)}endTransformFeedbackQuery(){this._end()}async resolveQuery(){return[await this.pollQuery()]}_begin(e){this._queryPending||(this.target=e,this.device.gl.beginQuery(this.target,this.handle))}_end(){this._queryPending||this.target&&(this.device.gl.endQuery(this.target),this.target=null,this._queryPending=!0)}isResultAvailable(){if(!this._queryPending)return!1;const e=this.device.gl.getQueryParameter(this.handle,34919);return e&&(this._queryPending=!1),e}isTimerDisjoint(){return this.device.gl.getParameter(36795)}getResult(){return this.device.gl.getQueryParameter(this.handle,34918)}getTimerMilliseconds(){return this.getResult()/1e6}pollQuery(e=Number.POSITIVE_INFINITY){if(this._pollingPromise)return this._pollingPromise;let r=0;return this._pollingPromise=new Promise((n,i)=>{const a=()=>{this.isResultAvailable()?(n(this.getResult()),this._pollingPromise=null):r++>e?(i("Timed out"),this._pollingPromise=null):requestAnimationFrame(a)};requestAnimationFrame(a)}),this._pollingPromise}}class Dv extends Wp{type="webgl";handle;features;limits;info;canvasContext;lost;_resolveContextLost;gl;debug=!1;_canvasSizeInfo={clientWidth:0,clientHeight:0,devicePixelRatio:1};_extensions={};_polyfilled=!1;spectorJS;constructor(e){super({...e,id:e.id||IVe("webgl-device")});const r=Wp._getCanvasContextProps(e);if(!r)throw new Error("WebGLDevice requires props.createCanvasContext to be set");let n=r.canvas?.gl?.device;if(n)throw new Error(`WebGL context already attached to device ${n.id}`);this.canvasContext=new yVe(this,r),this.lost=new Promise(f=>{this._resolveContextLost=f});const i={...e.webgl};r.alphaMode==="premultiplied"&&(i.premultipliedAlpha=!0),e.powerPreference!==void 0&&(i.powerPreference=e.powerPreference);const s=this.props._handle||KUe(this.canvasContext.canvas,{onContextLost:f=>this._resolveContextLost?.({reason:"destroyed",message:"Entered sleep mode, or too many apps or browser tabs are using the GPU."}),onContextRestored:f=>console.log("WebGL context restored")},i);if(!s)throw new Error("WebGL context creation failed");if(n=s.device,n){if(e._reuseDevices)return dn.log(1,`Not creating a new Device, instead returning a reference to Device ${n.id} already attached to WebGL context`,n)(),n._reused=!0,n;throw new Error(`WebGL context already attached to device ${n.id}`)}this.handle=s,this.gl=s,this.spectorJS=bVe({...this.props,gl:this.handle}),this.gl.device=this,this.gl._version=2,this.info=JUe(this.gl,this._extensions),this.limits=new pVe(this.gl),this.features=new dVe(this.gl,this._extensions,this.props._disabledFeatures),this.props._initializeFeatures&&this.features.initializeFeatures(),r.autoResize!==!1&&this.canvasContext.resize(),new fm(this.gl,{log:(...f)=>dn.log(1,...f)()}).trackState(this.gl,{copyState:!1});const u=e.debugWebGL||e.debug,h=e.debugWebGL;u&&(this.gl=SVe(this.gl,{debugWebGL:u,traceWebGL:h}),dn.warn("WebGL debug mode activated. Performance reduced.")(),e.debugWebGL&&(dn.level=Math.max(dn.level,1)))}destroy(){!this.props._reuseDevices&&!this._reused&&delete this.gl.device}get isLost(){return this.gl.isContextLost()}createCanvasContext(e){throw new Error("WebGL only supports a single canvas")}createBuffer(e){const r=this._normalizeBufferProps(e);return new V1(this,r)}createTexture(e){return new $1(this,e)}createExternalTexture(e){throw new Error("createExternalTexture() not implemented")}createSampler(e){return new uR(this,e)}createShader(e){return new RVe(this,e)}createFramebuffer(e){return new U1(this,e)}createVertexArray(e){return new oD(this,e)}createTransformFeedback(e){return new T$e(this,e)}createQuerySet(e){return new C$e(this,e)}createRenderPipeline(e){return new p$e(this,e)}beginRenderPass(e){return new KVe(this,e)}createComputePipeline(e){throw new Error("ComputePipeline not supported in WebGL")}beginComputePass(e){throw new Error("ComputePass not supported in WebGL")}renderPass=null;createCommandEncoder(e={}){return new x$e(this,e)}submit(){this.renderPass?.end(),this.renderPass=null}readPixelsToArrayWebGL(e,r){return WVe(e,r)}readPixelsToBufferWebGL(e,r){return GVe(e,r)}setParametersWebGL(e){X0(this.gl,e)}getParametersWebGL(e){return Fte(this.gl,e)}withParametersWebGL(e,r){return SE(this.gl,e,r)}resetWebGL(){dn.warn("WebGLDevice.resetWebGL is deprecated, use only for debugging")(),WUe(this.gl)}_getDeviceSpecificTextureFormatCapabilities(e){return uVe(this.gl,e,this._extensions)}loseDevice(){let e=!1;const n=this.getExtension("WEBGL_lose_context").WEBGL_lose_context;return n&&(e=!0,n.loseContext()),this._resolveContextLost?.({reason:"destroyed",message:"Application triggered context loss"}),e}pushState(){fm.get(this.gl).push()}popState(){fm.get(this.gl).pop()}setSpectorMetadata(e,r){e.__SPECTOR_Metadata=r}getGLKey(e,r){const n=Number(e);for(const i in this.gl)if(this.gl[i]===n)return`GL.${i}`;return r?.emptyIfUnknown?"":String(e)}getGLKeys(e){const r={emptyIfUnknown:!0};return Object.entries(e).reduce((n,[i,a])=>(n[`${i}:${this.getGLKey(i,r)}`]=`${a}:${this.getGLKey(a,r)}`,n),{})}_constants;setConstantAttributeWebGL(e,r){const n=this.limits.maxVertexAttributes;this._constants=this._constants||new Array(n).fill(null);const i=this._constants[e];switch(i&&k$e(i,r)&&dn.info(1,`setConstantAttributeWebGL(${e}) could have been skipped, value unchanged`)(),this._constants[e]=r,r.constructor){case Float32Array:A$e(this,e,r);break;case Int32Array:I$e(this,e,r);break;case Uint32Array:P$e(this,e,r);break;default:throw new Error("constant")}}getExtension(e){return A0(this.gl,e,this._extensions),this._extensions}}function A$e(t,e,r){switch(r.length){case 1:t.gl.vertexAttrib1fv(e,r);break;case 2:t.gl.vertexAttrib2fv(e,r);break;case 3:t.gl.vertexAttrib3fv(e,r);break;case 4:t.gl.vertexAttrib4fv(e,r);break}}function I$e(t,e,r){t.gl.vertexAttribI4iv(e,r)}function P$e(t,e,r){t.gl.vertexAttribI4uiv(e,r)}function k$e(t,e){if(!t||!e||t.length!==e.length||t.constructor!==e.constructor)return!1;for(let r=0;r<t.length;++r)if(t[r]!==e[r])return!1;return!0}const M$e={WEBGL_depth_texture:{UNSIGNED_INT_24_8_WEBGL:34042},OES_element_index_uint:{},OES_texture_float:{},OES_texture_half_float:{HALF_FLOAT_OES:5131},EXT_color_buffer_float:{},OES_standard_derivatives:{FRAGMENT_SHADER_DERIVATIVE_HINT_OES:35723},EXT_frag_depth:{},EXT_blend_minmax:{MIN_EXT:32775,MAX_EXT:32776},EXT_shader_texture_lod:{}},R$e=t=>({drawBuffersWEBGL(e){return t.drawBuffers(e)},COLOR_ATTACHMENT0_WEBGL:36064,COLOR_ATTACHMENT1_WEBGL:36065,COLOR_ATTACHMENT2_WEBGL:36066,COLOR_ATTACHMENT3_WEBGL:36067}),O$e=t=>({VERTEX_ARRAY_BINDING_OES:34229,createVertexArrayOES(){return t.createVertexArray()},deleteVertexArrayOES(e){return t.deleteVertexArray(e)},isVertexArrayOES(e){return t.isVertexArray(e)},bindVertexArrayOES(e){return t.bindVertexArray(e)}}),L$e=t=>({VERTEX_ATTRIB_ARRAY_DIVISOR_ANGLE:35070,drawArraysInstancedANGLE(...e){return t.drawArraysInstanced(...e)},drawElementsInstancedANGLE(...e){return t.drawElementsInstanced(...e)},vertexAttribDivisorANGLE(...e){return t.vertexAttribDivisor(...e)}});function N$e(t=!0){const e=HTMLCanvasElement.prototype;if(!t&&e.originalGetContext){e.getContext=e.originalGetContext,e.originalGetContext=void 0;return}e.originalGetContext=e.getContext,e.getContext=function(r,n){if(r==="webgl"||r==="experimental-webgl"){const i=this.originalGetContext("webgl2",n);return i instanceof HTMLElement&&D$e(i),i}return this.originalGetContext(r,n)}}function D$e(t){t.getExtension("EXT_color_buffer_float");const e={...M$e,WEBGL_disjoint_timer_query:t.getExtension("EXT_disjoint_timer_query_webgl2"),WEBGL_draw_buffers:R$e(t),OES_vertex_array_object:O$e(t),ANGLE_instanced_arrays:L$e(t)},r=t.getExtension;t.getExtension=function(i){const a=r.call(t,i);return a||(i in e?e[i]:null)};const n=t.getSupportedExtensions;t.getSupportedExtensions=function(){return(n.apply(t)||[])?.concat(Object.keys(e))}}const tw=1;class F$e extends tBe{type="webgl";constructor(){super(),Wp.defaultProps={...Wp.defaultProps,...aD},Dv.adapter=this}isSupported(){return typeof WebGL2RenderingContext<"u"}enforceWebGL2(e){N$e(e)}async attach(e){if(e instanceof Dv)return e;if(e?.device instanceof Wp)return e.device;if(!B$e(e))throw new Error("Invalid WebGL2RenderingContext");return new Dv({_handle:e,createCanvasContext:{canvas:e.canvas,autoResize:!1}})}async create(e={}){dn.groupCollapsed(tw,"WebGLDevice created")();const r=[];(e.debugWebGL||e.debug)&&r.push(wVe()),e.debugSpectorJS&&r.push(_Ve(e));const n=await Promise.allSettled(r);for(const s of n)s.status==="rejected"&&dn.error(`Failed to initialize debug libraries ${s.reason}`)();const i=new Dv(e),a=`${i._reused?"Reusing":"Created"} device with WebGL2 ${i.debug?"debug ":""}context: ${i.info.vendor}, ${i.info.renderer} for canvas: ${i.canvasContext.id}`;return dn.probe(tw,a)(),dn.table(tw,i.info)(),dn.groupEnd(tw)(),i}}function B$e(t){return typeof WebGL2RenderingContext<"u"&&t instanceof WebGL2RenderingContext?!0:!!(t&&Number.isFinite(t._version))}const RH=new F$e;function Ap(){}const z$e=({isDragging:t})=>t?"grabbing":"grab",Zte={id:"",width:"100%",height:"100%",style:null,viewState:null,initialViewState:null,pickingRadius:0,layerFilter:null,parameters:{},parent:null,device:null,deviceProps:{},gl:null,canvas:null,layers:[],effects:[],views:null,controller:null,useDevicePixels:!0,touchAction:"none",eventRecognizerOptions:{},_framebuffer:null,_animate:!1,_pickable:!0,_typedArrayManagerProps:{},_customRender:null,widgets:[],onDeviceInitialized:Ap,onWebGLInitialized:Ap,onResize:Ap,onViewStateChange:Ap,onInteractionStateChange:Ap,onBeforeRender:Ap,onAfterRender:Ap,onLoad:Ap,onError:t=>Za.error(t.message,t.cause)(),onHover:null,onClick:null,onDragStart:null,onDrag:null,onDragEnd:null,_onMetrics:null,getCursor:z$e,getTooltip:null,debug:!1,drawPickingColors:!1};class Rb{constructor(e){this.width=0,this.height=0,this.userData={},this.device=null,this.canvas=null,this.viewManager=null,this.layerManager=null,this.effectManager=null,this.deckRenderer=null,this.deckPicker=null,this.eventManager=null,this.widgetManager=null,this.tooltip=null,this.animationLoop=null,this.cursorState={isHovering:!1,isDragging:!1},this.stats=new ZT({id:"deck.gl"}),this.metrics={fps:0,setPropsTime:0,updateAttributesTime:0,framesRedrawn:0,pickTime:0,pickCount:0,gpuTime:0,gpuTimePerFrame:0,cpuTime:0,cpuTimePerFrame:0,bufferMemory:0,textureMemory:0,renderbufferMemory:0,gpuMemory:0},this._metricsCounter=0,this._needsRedraw="Initial render",this._pickRequest={mode:"hover",x:-1,y:-1,radius:0,event:null},this._lastPointerDownInfo=null,this._onPointerMove=n=>{const{_pickRequest:i}=this;if(n.type==="pointerleave")i.x=-1,i.y=-1,i.radius=0;else{if(n.leftButton||n.rightButton)return;{const a=n.offsetCenter;if(!a)return;i.x=a.x,i.y=a.y,i.radius=this.props.pickingRadius}}this.layerManager&&(this.layerManager.context.mousePosition={x:i.x,y:i.y}),i.event=n},this._onEvent=n=>{const i=eR[n.type],a=n.offsetCenter;if(!i||!a||!this.layerManager)return;const s=this.layerManager.getLayers(),o=this.deckPicker.getLastPickedObject({x:a.x,y:a.y,layers:s,viewports:this.getViewports(a)},this._lastPointerDownInfo),{layer:u}=o,h=u&&(u[i]||u.props[i]),f=this.props[i];let g=!1;h&&(g=h.call(u,o,n)),g||(f?.(o,n),this.widgetManager.onEvent(o,n))},this._onPointerDown=n=>{if(this.device?.type==="webgpu")return;const i=n.offsetCenter,a=this._pick("pickObject","pickObject Time",{x:i.x,y:i.y,radius:this.props.pickingRadius});this._lastPointerDownInfo=a.result[0]||a.emptyInfo},this.props={...Zte,...e},e=this.props,e.viewState&&e.initialViewState&&Za.warn("View state tracking is disabled. Use either `initialViewState` for auto update or `viewState` for manual update.")(),this.viewState=this.props.initialViewState,e.device&&(this.device=e.device);let r=this.device;!r&&e.gl&&(e.gl instanceof WebGLRenderingContext&&Za.error("WebGL1 context not supported.")(),r=RH.attach(e.gl)),r||(r=qM.createDevice({type:"best-available",_reuseDevices:!0,adapters:[RH],...e.deviceProps,createCanvasContext:{canvas:this._createCanvas(e),useDevicePixels:this.props.useDevicePixels,autoResize:!1}})),this.animationLoop=this._createAnimationLoop(r,e),this.setProps(e),e._typedArrayManagerProps&&Mb.setOptions(e._typedArrayManagerProps),this.animationLoop.start()}finalize(){this.animationLoop?.stop(),this.animationLoop?.destroy(),this.animationLoop=null,this._lastPointerDownInfo=null,this.layerManager?.finalize(),this.layerManager=null,this.viewManager?.finalize(),this.viewManager=null,this.effectManager?.finalize(),this.effectManager=null,this.deckRenderer?.finalize(),this.deckRenderer=null,this.deckPicker?.finalize(),this.deckPicker=null,this.eventManager?.destroy(),this.eventManager=null,this.widgetManager?.finalize(),this.widgetManager=null,!this.props.canvas&&!this.props.device&&!this.props.gl&&this.canvas&&(this.canvas.parentElement?.removeChild(this.canvas),this.canvas=null)}setProps(e){this.stats.get("setProps Time").timeStart(),"onLayerHover"in e&&Za.removed("onLayerHover","onHover")(),"onLayerClick"in e&&Za.removed("onLayerClick","onClick")(),e.initialViewState&&!vc(this.props.initialViewState,e.initialViewState,3)&&(this.viewState=e.initialViewState),Object.assign(this.props,e),this._setCanvasSize(this.props);const r=Object.create(this.props);Object.assign(r,{views:this._getViews(),width:this.width,height:this.height,viewState:this._getViewState()}),this.animationLoop?.setProps(r),this.layerManager&&(this.viewManager.setProps(r),this.layerManager.activateViewport(this.getViewports()[0]),this.layerManager.setProps(r),this.effectManager.setProps(r),this.deckRenderer.setProps(r),this.deckPicker.setProps(r),this.widgetManager.setProps(r)),this.stats.get("setProps Time").timeEnd()}needsRedraw(e={clearRedrawFlags:!1}){if(!this.layerManager)return!1;if(this.props._animate)return"Deck._animate";let r=this._needsRedraw;e.clearRedrawFlags&&(this._needsRedraw=!1);const n=this.viewManager.needsRedraw(e),i=this.layerManager.needsRedraw(e),a=this.effectManager.needsRedraw(e),s=this.deckRenderer.needsRedraw(e);return r=r||n||i||a||s,r}redraw(e){if(!this.layerManager)return;let r=this.needsRedraw({clearRedrawFlags:!0});r=e||r,r&&(this.stats.get("Redraw Count").incrementCount(),this.props._customRender?this.props._customRender(r):this._drawLayers(r))}get isInitialized(){return this.viewManager!==null}getViews(){return Rl(this.viewManager),this.viewManager.views}getViewports(e){return Rl(this.viewManager),this.viewManager.getViewports(e)}getCanvas(){return this.canvas}pickObject(e){const r=this._pick("pickObject","pickObject Time",e).result;return r.length?r[0]:null}pickMultipleObjects(e){return e.depth=e.depth||10,this._pick("pickObject","pickMultipleObjects Time",e).result}pickObjects(e){return this._pick("pickObjects","pickObjects Time",e)}_addResources(e,r=!1){for(const n in e)this.layerManager.resourceManager.add({resourceId:n,data:e[n],forceUpdate:r})}_removeResources(e){for(const r of e)this.layerManager.resourceManager.remove(r)}_addDefaultEffect(e){this.effectManager.addDefaultEffect(e)}_addDefaultShaderModule(e){this.layerManager.addDefaultShaderModule(e)}_removeDefaultShaderModule(e){this.layerManager?.removeDefaultShaderModule(e)}_pick(e,r,n){Rl(this.deckPicker);const{stats:i}=this;i.get("Pick Count").incrementCount(),i.get(r).timeStart();const a=this.deckPicker[e]({layers:this.layerManager.getLayers(n),views:this.viewManager.getViews(),viewports:this.getViewports(n),onViewportActive:this.layerManager.activateViewport,effects:this.effectManager.getEffects(),...n});return i.get(r).timeEnd(),a}_createCanvas(e){let r=e.canvas;return typeof r=="string"&&(r=document.getElementById(r),Rl(r)),r||(r=document.createElement("canvas"),r.id=e.id||"deckgl-overlay",(e.parent||document.body).appendChild(r)),Object.assign(r.style,e.style),r}_setCanvasSize(e){if(!this.canvas)return;const{width:r,height:n}=e;if(r||r===0){const i=Number.isFinite(r)?`${r}px`:r;this.canvas.style.width=i}if(n||n===0){const i=Number.isFinite(n)?`${n}px`:n;this.canvas.style.position=e.style?.position||"absolute",this.canvas.style.height=i}}_updateCanvasSize(){const{canvas:e}=this;if(!e)return;const r=e.clientWidth??e.width,n=e.clientHeight??e.height;(r!==this.width||n!==this.height)&&(this.width=r,this.height=n,this.viewManager?.setProps({width:r,height:n}),this.layerManager?.activateViewport(this.getViewports()[0]),this.props.onResize({width:r,height:n}))}_createAnimationLoop(e,r){const{gl:n,onError:i,useDevicePixels:a}=r;return new $7e({device:e,useDevicePixels:a,autoResizeDrawingBuffer:!n,autoResizeViewport:!1,onInitialize:s=>this._setDevice(s.device),onRender:this._onRenderFrame.bind(this),onError:i})}_getViewState(){return this.props.viewState||this.viewState}_getViews(){const{views:e}=this.props,r=Array.isArray(e)?e:e?[e]:[new tD({id:"default-view"})];return r.length&&this.props.controller&&(r[0].props.controller=this.props.controller),r}_onContextLost(){const{onError:e}=this.props;this.animationLoop&&e&&e(new Error("WebGL context is lost"))}_pickAndCallback(){if(this.device?.type==="webgpu")return;const{_pickRequest:e}=this;if(e.event){const{result:r,emptyInfo:n}=this._pick("pickObject","pickObject Time",e);this.cursorState.isHovering=r.length>0;let i=n,a=!1;for(const s of r)i=s,a=s.layer?.onHover(s,e.event)||a;a||(this.props.onHover?.(i,e.event),this.widgetManager.onHover(i,e.event)),e.event=null}}_updateCursor(){const e=this.props.parent||this.canvas;e&&(e.style.cursor=this.props.getCursor(this.cursorState))}_setDevice(e){if(this.device=e,!this.animationLoop)return;this.canvas||(this.canvas=this.device.canvasContext?.canvas),this.device.type==="webgl"&&this.device.setParametersWebGL({blend:!0,blendFunc:[770,771,1,771],polygonOffsetFill:!0,depthTest:!0,depthFunc:515}),this.props.onDeviceInitialized(this.device),this.device.type==="webgl"&&this.props.onWebGLInitialized(this.device.gl);const r=new Cte;r.play(),this.animationLoop.attachTimeline(r),this.eventManager=new yje(this.props.parent||this.canvas,{touchAction:this.props.touchAction,recognizers:Object.keys(Qq).map(i=>{const[a,s,o,u]=Qq[i],h=this.props.eventRecognizerOptions?.[i],f={...s,...h,event:i};return{recognizer:new a(f),recognizeWith:o,requestFailure:u}}),events:{pointerdown:this._onPointerDown,pointermove:this._onPointerMove,pointerleave:this._onPointerMove}});for(const i in eR)this.eventManager.on(i,this._onEvent);this.viewManager=new pUe({timeline:r,eventManager:this.eventManager,onViewStateChange:this._onViewStateChange.bind(this),onInteractionStateChange:this._onInteractionStateChange.bind(this),views:this._getViews(),viewState:this._getViewState(),width:this.width,height:this.height});const n=this.viewManager.getViewports()[0];this.layerManager=new dUe(this.device,{deck:this,stats:this.stats,viewport:n,timeline:r}),this.effectManager=new IUe({deck:this,device:this.device}),this.deckRenderer=new MUe(this.device),this.deckPicker=new FUe(this.device),this.widgetManager=new jUe({deck:this,parentElement:this.canvas?.parentElement}),this.widgetManager.addDefault(new VUe),this.setProps(this.props),this._updateCanvasSize(),this.props.onLoad()}_drawLayers(e,r){const{device:n,gl:i}=this.layerManager.context;this.props.onBeforeRender({device:n,gl:i});const a={target:this.props._framebuffer,layers:this.layerManager.getLayers(),viewports:this.viewManager.getViewports(),onViewportActive:this.layerManager.activateViewport,views:this.viewManager.getViews(),pass:"screen",effects:this.effectManager.getEffects(),...r};this.deckRenderer?.renderLayers(a),a.pass==="screen"&&this.widgetManager.onRedraw({viewports:a.viewports,layers:a.layers}),this.props.onAfterRender({device:n,gl:i})}_onRenderFrame(){this._getFrameStats(),this._metricsCounter++%60===0&&(this._getMetrics(),this.stats.reset(),Za.table(4,this.metrics)(),this.props._onMetrics&&this.props._onMetrics(this.metrics)),this._updateCanvasSize(),this._updateCursor(),this.layerManager.updateLayers(),this.device?.type!=="webgpu"&&this._pickAndCallback(),this.redraw(),this.viewManager&&this.viewManager.updateViewStates()}_onViewStateChange(e){const r=this.props.onViewStateChange(e)||e.viewState;this.viewState&&(this.viewState={...this.viewState,[e.viewId]:r},this.props.viewState||this.viewManager&&this.viewManager.setProps({viewState:this.viewState}))}_onInteractionStateChange(e){this.cursorState.isDragging=e.isDragging||!1,this.props.onInteractionStateChange(e)}_getFrameStats(){const{stats:e}=this;e.get("frameRate").timeEnd(),e.get("frameRate").timeStart();const r=this.animationLoop.stats;e.get("GPU Time").addTime(r.get("GPU Time").lastTiming),e.get("CPU Time").addTime(r.get("CPU Time").lastTiming)}_getMetrics(){const{metrics:e,stats:r}=this;e.fps=r.get("frameRate").getHz(),e.setPropsTime=r.get("setProps Time").time,e.updateAttributesTime=r.get("Update Attributes").time,e.framesRedrawn=r.get("Redraw Count").count,e.pickTime=r.get("pickObject Time").time+r.get("pickMultipleObjects Time").time+r.get("pickObjects Time").time,e.pickCount=r.get("Pick Count").count,e.gpuTime=r.get("GPU Time").time,e.cpuTime=r.get("CPU Time").time,e.gpuTimePerFrame=r.get("GPU Time").getAverageTime(),e.cpuTimePerFrame=r.get("CPU Time").getAverageTime();const n=qM.stats.get("Memory Usage");e.bufferMemory=n.get("Buffer Memory").count,e.textureMemory=n.get("Texture Memory").count,e.renderbufferMemory=n.get("Renderbuffer Memory").count,e.gpuMemory=n.get("GPU Memory").count}}Rb.defaultProps=Zte;Rb.VERSION=o8e;function j$e(t){switch(t){case"float64":return Float64Array;case"uint8":case"unorm8":return Uint8ClampedArray;default:return Eee(t)}}const U$e=See;function rw(t,e,r){const n=r==="webgpu"&&e.type==="uint8"?"unorm8":e.type;return{attribute:t,format:e.size>1?`${n}x${e.size}`:e.type,byteOffset:e.offset||0}}function em(t){return t.stride||t.size*t.bytesPerElement}function V$e(t,e){return t.type===e.type&&t.size===e.size&&em(t)===em(e)&&(t.offset||0)===(e.offset||0)}function cR(t,e){e.offset&&Za.removed("shaderAttribute.offset","vertexOffset, elementOffset")();const r=em(t),n=e.vertexOffset!==void 0?e.vertexOffset:t.vertexOffset||0,i=e.elementOffset||0,a=n*r+i*t.bytesPerElement+(t.offset||0);return{...e,offset:a,stride:r}}function $$e(t,e){const r=cR(t,e);return{high:r,low:{...r,offset:r.offset+t.size*4}}}class q$e{constructor(e,r,n){this._buffer=null,this.device=e,this.id=r.id||"",this.size=r.size||1;const i=r.logicalType||r.type,a=i==="float64";let{defaultValue:s}=r;s=Number.isFinite(s)?[s]:s||new Array(this.size).fill(0);let o;a?o="float32":!i&&r.isIndexed?o="uint32":o=i||"float32";let u=j$e(i||o);this.doublePrecision=a,a&&r.fp64===!1&&(u=Float32Array),this.value=null,this.settings={...r,defaultType:u,defaultValue:s,logicalType:i,type:o,normalized:o.includes("norm"),size:this.size,bytesPerElement:u.BYTES_PER_ELEMENT},this.state={...n,externalBuffer:null,bufferAccessor:this.settings,allocatedValue:null,numInstances:0,bounds:null,constant:!1}}get isConstant(){return this.state.constant}get buffer(){return this._buffer}get byteOffset(){const e=this.getAccessor();return e.vertexOffset?e.vertexOffset*em(e):0}get numInstances(){return this.state.numInstances}set numInstances(e){this.state.numInstances=e}delete(){this._buffer&&(this._buffer.delete(),this._buffer=null),Mb.release(this.state.allocatedValue)}getBuffer(){return this.state.constant?null:this.state.externalBuffer||this._buffer}getValue(e=this.id,r=null){const n={};if(this.state.constant){const i=this.value;if(r){const a=cR(this.getAccessor(),r),s=a.offset/i.BYTES_PER_ELEMENT,o=a.size||this.size;n[e]=i.subarray(s,s+o)}else n[e]=i}else n[e]=this.getBuffer();return this.doublePrecision&&(this.value instanceof Float64Array?n[`${e}64Low`]=n[e]:n[`${e}64Low`]=new Float32Array(this.size)),n}_getBufferLayout(e=this.id,r=null){const n=this.getAccessor(),i=[],a={name:this.id,byteStride:em(n),attributes:i};if(this.doublePrecision){const s=$$e(n,r||{});i.push(rw(e,{...n,...s.high},this.device.type),rw(`${e}64Low`,{...n,...s.low},this.device.type))}else if(r){const s=cR(n,r);i.push(rw(e,{...n,...s},this.device.type))}else i.push(rw(e,n,this.device.type));return a}setAccessor(e){this.state.bufferAccessor=e}getAccessor(){return this.state.bufferAccessor}getBounds(){if(this.state.bounds)return this.state.bounds;let e=null;if(this.state.constant&&this.value){const r=Array.from(this.value);e=[r,r]}else{const{value:r,numInstances:n,size:i}=this,a=n*i;if(r&&a&&r.length>=a){const s=new Array(i).fill(1/0),o=new Array(i).fill(-1/0);for(let u=0;u<a;)for(let h=0;h<i;h++){const f=r[u++];f<s[h]&&(s[h]=f),f>o[h]&&(o[h]=f)}e=[s,o]}}return this.state.bounds=e,e}setData(e){const{state:r}=this;let n;ArrayBuffer.isView(e)?n={value:e}:e instanceof Oo?n={buffer:e}:n=e;const i={...this.settings,...n};if(ArrayBuffer.isView(n.value)){if(!n.type)if(this.doublePrecision&&n.value instanceof Float64Array)i.type="float32";else{const s=U$e(n.value);i.type=i.normalized?s.replace("int","norm"):s}i.bytesPerElement=n.value.BYTES_PER_ELEMENT,i.stride=em(i)}if(r.bounds=null,n.constant){let a=n.value;if(a=this._normalizeValue(a,[],0),this.settings.normalized&&(a=this.normalizeConstant(a)),!(!r.constant||!this._areValuesEqual(a,this.value)))return!1;r.externalBuffer=null,r.constant=!0,this.value=ArrayBuffer.isView(a)?a:new Float32Array(a)}else if(n.buffer){const a=n.buffer;r.externalBuffer=a,r.constant=!1,this.value=n.value||null}else if(n.value){this._checkExternalBuffer(n);let a=n.value;r.externalBuffer=null,r.constant=!1,this.value=a;let{buffer:s}=this;const o=em(i),u=(i.vertexOffset||0)*o;if(this.doublePrecision&&a instanceof Float64Array&&(a=GI(a,i)),this.settings.isIndexed){const f=this.settings.defaultType;a.constructor!==f&&(a=new f(a))}const h=a.byteLength+u+o*2;(!s||s.byteLength<h)&&(s=this._createBuffer(h)),s.write(a,u)}return this.setAccessor(i),!0}updateSubBuffer(e={}){this.state.bounds=null;const r=this.value,{startOffset:n=0,endOffset:i}=e;this.buffer.write(this.doublePrecision&&r instanceof Float64Array?GI(r,{size:this.size,startIndex:n,endIndex:i}):r.subarray(n,i),n*r.BYTES_PER_ELEMENT+this.byteOffset)}allocate(e,r=!1){const{state:n}=this,i=n.allocatedValue,a=Mb.allocate(i,e+1,{size:this.size,type:this.settings.defaultType,copy:r});this.value=a;const{byteOffset:s}=this;let{buffer:o}=this;return(!o||o.byteLength<a.byteLength+s)&&(o=this._createBuffer(a.byteLength+s),r&&i&&o.write(i instanceof Float64Array?GI(i,this):i,s)),n.allocatedValue=a,n.constant=!1,n.externalBuffer=null,this.setAccessor(this.settings),!0}_checkExternalBuffer(e){const{value:r}=e;if(!ArrayBuffer.isView(r))throw new Error(`Attribute ${this.id} value is not TypedArray`);const n=this.settings.defaultType;let i=!1;if(this.doublePrecision&&(i=r.BYTES_PER_ELEMENT<4),i)throw new Error(`Attribute ${this.id} does not support ${r.constructor.name}`);!(r instanceof n)&&this.settings.normalized&&!("normalized"in e)&&Za.warn(`Attribute ${this.id} is normalized`)()}normalizeConstant(e){switch(this.settings.type){case"snorm8":return new Float32Array(e).map(r=>(r+128)/255*2-1);case"snorm16":return new Float32Array(e).map(r=>(r+32768)/65535*2-1);case"unorm8":return new Float32Array(e).map(r=>r/255);case"unorm16":return new Float32Array(e).map(r=>r/65535);default:return e}}_normalizeValue(e,r,n){const{defaultValue:i,size:a}=this.settings;if(Number.isFinite(e))return r[n]=e,r;if(!e){let s=a;for(;--s>=0;)r[n+s]=i[s];return r}switch(a){case 4:r[n+3]=Number.isFinite(e[3])?e[3]:i[3];case 3:r[n+2]=Number.isFinite(e[2])?e[2]:i[2];case 2:r[n+1]=Number.isFinite(e[1])?e[1]:i[1];case 1:r[n+0]=Number.isFinite(e[0])?e[0]:i[0];break;default:let s=a;for(;--s>=0;)r[n+s]=Number.isFinite(e[s])?e[s]:i[s]}return r}_areValuesEqual(e,r){if(!e||!r)return!1;const{size:n}=this;for(let i=0;i<n;i++)if(e[i]!==r[i])return!1;return!0}_createBuffer(e){this._buffer&&this._buffer.destroy();const{isIndexed:r,type:n}=this.settings;return this._buffer=this.device.createBuffer({...this._buffer?.props,id:this.id,usage:(r?Oo.INDEX:Oo.VERTEX)|Oo.COPY_DST,indexType:r?n:void 0,byteLength:e}),this._buffer}}const OH=[],LH=[];function Kte(t,e=0,r=1/0){let n=OH;const i={index:-1,data:t,target:[]};return t?typeof t[Symbol.iterator]=="function"?n=t:t.length>0&&(LH.length=t.length,n=LH):n=OH,(e>0||Number.isFinite(r))&&(n=(Array.isArray(n)?n:Array.from(n)).slice(e,r),i.index=e-1),{iterable:n,objectInfo:i}}function Jte(t){return t&&t[Symbol.asyncIterator]}function H$e(t,e){const{size:r,stride:n,offset:i,startIndices:a,nested:s}=e,o=t.BYTES_PER_ELEMENT,u=n?n/o:r,h=i?i/o:0,f=Math.floor((t.length-h)/u);return(g,{index:b,target:v})=>{if(!a){const k=b*u+h;for(let L=0;L<r;L++)v[L]=t[k+L];return v}const S=a[b],E=a[b+1]||f;let P;if(s){P=new Array(E-S);for(let k=S;k<E;k++){const L=k*u+h;v=new Array(r);for(let O=0;O<r;O++)v[O]=t[L+O];P[k-S]=v}}else if(u===r)P=t.subarray(S*r+h,E*r+h);else{P=new t.constructor((E-S)*r);let k=0;for(let L=S;L<E;L++){const O=L*u+h;for(let M=0;M<r;M++)P[k++]=t[O+M]}}return P}}const W$e=[],Fw=[[0,1/0]];function G$e(t,e){if(t===Fw||(e[0]<0&&(e[0]=0),e[0]>=e[1]))return t;const r=[],n=t.length;let i=0;for(let a=0;a<n;a++){const s=t[a];s[1]<e[0]?(r.push(s),i=a+1):s[0]>e[1]?r.push(s):e=[Math.min(s[0],e[0]),Math.max(s[1],e[1])]}return r.splice(i,0,e),r}const X$e={interpolation:{duration:0,easing:t=>t},spring:{stiffness:.05,damping:.5}};function Qte(t,e){if(!t)return null;Number.isFinite(t)&&(t={type:"interpolation",duration:t});const r=t.type||"interpolation";return{...X$e[r],...e,...t,type:r}}class ere extends q$e{constructor(e,r){super(e,r,{startIndices:null,lastExternalBuffer:null,binaryValue:null,binaryAccessor:null,needsUpdate:!0,needsRedraw:!1,layoutChanged:!1,updateRanges:Fw}),this.constant=!1,this.settings.update=r.update||(r.accessor?this._autoUpdater:void 0),Object.seal(this.settings),Object.seal(this.state),this._validateAttributeUpdaters()}get startIndices(){return this.state.startIndices}set startIndices(e){this.state.startIndices=e}needsUpdate(){return this.state.needsUpdate}needsRedraw({clearChangedFlags:e=!1}={}){const r=this.state.needsRedraw;return this.state.needsRedraw=r&&!e,r}layoutChanged(){return this.state.layoutChanged}setAccessor(e){var r;(r=this.state).layoutChanged||(r.layoutChanged=!V$e(e,this.getAccessor())),super.setAccessor(e)}getUpdateTriggers(){const{accessor:e}=this.settings;return[this.id].concat(typeof e!="function"&&e||[])}supportsTransition(){return!!this.settings.transition}getTransitionSetting(e){if(!e||!this.supportsTransition())return null;const{accessor:r}=this.settings,n=this.settings.transition,i=Array.isArray(r)?e[r.find(a=>e[a])]:e[r];return Qte(i,n)}setNeedsUpdate(e=this.id,r){if(this.state.needsUpdate=this.state.needsUpdate||e,this.setNeedsRedraw(e),r){const{startRow:n=0,endRow:i=1/0}=r;this.state.updateRanges=G$e(this.state.updateRanges,[n,i])}else this.state.updateRanges=Fw}clearNeedsUpdate(){this.state.needsUpdate=!1,this.state.updateRanges=W$e}setNeedsRedraw(e=this.id){this.state.needsRedraw=this.state.needsRedraw||e}allocate(e){const{state:r,settings:n}=this;return n.noAlloc?!1:n.update?(super.allocate(e,r.updateRanges!==Fw),!0):!1}updateBuffer({numInstances:e,data:r,props:n,context:i}){if(!this.needsUpdate())return!1;const{state:{updateRanges:a},settings:{update:s,noAlloc:o}}=this;let u=!0;if(s){for(const[h,f]of a)s.call(i,this,{data:r,startRow:h,endRow:f,props:n,numInstances:e});if(this.value)if(this.constant||!this.buffer||this.buffer.byteLength<this.value.byteLength+this.byteOffset)this.setData({value:this.value,constant:this.constant}),this.constant=!1;else for(const[h,f]of a){const g=Number.isFinite(h)?this.getVertexOffset(h):0,b=Number.isFinite(f)?this.getVertexOffset(f):o||!Number.isFinite(e)?this.value.length:e*this.size;super.updateSubBuffer({startOffset:g,endOffset:b})}this._checkAttributeArray()}else u=!1;return this.clearNeedsUpdate(),this.setNeedsRedraw(),u}setConstantValue(e){return this.device.type==="webgpu"||e===void 0||typeof e=="function"?!1:(this.setData({constant:!0,value:e})&&this.setNeedsRedraw(),this.clearNeedsUpdate(),!0)}setExternalBuffer(e){const{state:r}=this;return e?(this.clearNeedsUpdate(),r.lastExternalBuffer===e||(r.lastExternalBuffer=e,this.setNeedsRedraw(),this.setData(e)),!0):(r.lastExternalBuffer=null,!1)}setBinaryValue(e,r=null){const{state:n,settings:i}=this;if(!e)return n.binaryValue=null,n.binaryAccessor=null,!1;if(i.noAlloc)return!1;if(n.binaryValue===e)return this.clearNeedsUpdate(),!0;if(n.binaryValue=e,this.setNeedsRedraw(),i.transform||r!==this.startIndices){ArrayBuffer.isView(e)&&(e={value:e});const s=e;Rl(ArrayBuffer.isView(s.value),`invalid ${i.accessor}`);const o=!!s.size&&s.size!==this.size;return n.binaryAccessor=H$e(s.value,{size:s.size||this.size,stride:s.stride,offset:s.offset,startIndices:r,nested:o}),!1}return this.clearNeedsUpdate(),this.setData(e),!0}getVertexOffset(e){const{startIndices:r}=this;return(r?e<r.length?r[e]:this.numInstances:e)*this.size}getValue(){const e=this.settings.shaderAttributes,r=super.getValue();if(!e)return r;for(const n in e)Object.assign(r,super.getValue(n,e[n]));return r}getBufferLayout(e){this.state.layoutChanged=!1;const r=this.settings.shaderAttributes,n=super._getBufferLayout(),{stepMode:i}=this.settings;if(i==="dynamic"?n.stepMode=e?e.isInstanced?"instance":"vertex":"instance":n.stepMode=i??"vertex",!r)return n;for(const a in r){const s=super._getBufferLayout(a,r[a]);n.attributes.push(...s.attributes)}return n}_autoUpdater(e,{data:r,startRow:n,endRow:i,props:a,numInstances:s}){if(e.constant&&this.context.device.type!=="webgpu")return;const{settings:o,state:u,value:h,size:f,startIndices:g}=e,{accessor:b,transform:v}=o;let S=u.binaryAccessor||(typeof b=="function"?b:a[b]);typeof S!="function"&&(S=()=>S),Rl(typeof S=="function",`accessor "${b}" is not a function`);let E=e.getVertexOffset(n);const{iterable:P,objectInfo:k}=Kte(r,n,i);for(const L of P){k.index++;let O=S(L,k);if(v&&(O=v.call(this,O)),g){const M=(k.index<g.length-1?g[k.index+1]:s)-g[k.index];if(O&&Array.isArray(O[0])){let z=E;for(const B of O)e._normalizeValue(B,h,z),z+=f}else O&&O.length>f?h.set(O,E):(e._normalizeValue(O,k.target,0),lUe({target:h,source:k.target,start:E,count:M}));E+=M*f}else e._normalizeValue(O,h,E),E+=f}}_validateAttributeUpdaters(){const{settings:e}=this;if(!(e.noAlloc||typeof e.update=="function"))throw new Error(`Attribute ${this.id} missing update or accessor`)}_checkAttributeArray(){const{value:e}=this,r=Math.min(4,this.size);if(e&&e.length>=r){let n=!0;switch(r){case 4:n=n&&Number.isFinite(e[3]);case 3:n=n&&Number.isFinite(e[2]);case 2:n=n&&Number.isFinite(e[1]);case 1:n=n&&Number.isFinite(e[0]);break;default:n=!1}if(!n)throw new Error(`Illegal attribute generated for ${this.id}`)}}}function nP(t){const{source:e,target:r,start:n=0,size:i,getData:a}=t,s=t.end||r.length,o=e.length,u=s-n;if(o>u){r.set(e.subarray(0,u),n);return}if(r.set(e,n),!a)return;let h=o;for(;h<u;){const f=a(h,e);for(let g=0;g<i;g++)r[n+h]=f[g]||0,h++}}function Y$e({source:t,target:e,size:r,getData:n,sourceStartIndices:i,targetStartIndices:a}){if(!i||!a)return nP({source:t,target:e,size:r,getData:n}),e;let s=0,o=0;const u=n&&((f,g)=>n(f+o,g)),h=Math.min(i.length,a.length);for(let f=1;f<h;f++){const g=i[f]*r,b=a[f]*r;nP({source:t.subarray(s,g),target:e,start:o,end:b,size:r,getData:u}),s=g,o=b}return o<e.length&&nP({source:[],target:e,start:o,size:r,getData:u}),e}function Z$e(t){const{device:e,settings:r,value:n}=t,i=new ere(e,r);return i.setData({value:n instanceof Float64Array?new Float64Array(0):new Float32Array(0),normalized:r.normalized}),i}function tre(t){switch(t){case 1:return"float";case 2:return"vec2";case 3:return"vec3";case 4:return"vec4";default:throw new Error(`No defined attribute type for size "${t}"`)}}function rre(t){switch(t){case 1:return"float32";case 2:return"float32x2";case 3:return"float32x3";case 4:return"float32x4";default:throw new Error("invalid type size")}}function nre(t){t.push(t.shift())}function K$e(t,e){const{doublePrecision:r,settings:n,value:i,size:a}=t,s=r&&i instanceof Float64Array?2:1;let o=0;const{shaderAttributes:u}=t.settings;if(u)for(const h of Object.values(u))o=Math.max(o,h.vertexOffset??0);return(n.noAlloc?i.length:(e+o)*a)*s}function ire({device:t,source:e,target:r}){return(!r||r.byteLength<e.byteLength)&&(r?.destroy(),r=t.createBuffer({byteLength:e.byteLength,usage:e.usage})),r}function are({device:t,buffer:e,attribute:r,fromLength:n,toLength:i,fromStartIndices:a,getData:s=o=>o}){const o=r.doublePrecision&&r.value instanceof Float64Array?2:1,u=r.size*o,h=r.byteOffset,f=r.settings.bytesPerElement<4?h/r.settings.bytesPerElement*4:h,g=r.startIndices,b=a&&g,v=r.isConstant;if(!b&&e&&n>=i)return e;const S=r.value instanceof Float64Array?Float32Array:r.value.constructor,E=v?r.value:new S(r.getBuffer().readSyncWebGL(h,i*S.BYTES_PER_ELEMENT).buffer);if(r.settings.normalized&&!v){const O=s;s=(M,z)=>r.normalizeConstant(O(M,z))}const P=v?(O,M)=>s(E,M):(O,M)=>s(E.subarray(O+h,O+h+u),M),k=e?new Float32Array(e.readSyncWebGL(f,n*4).buffer):new Float32Array(0),L=new Float32Array(i);return Y$e({source:k,target:L,sourceStartIndices:a,targetStartIndices:g,size:u,getData:P}),(!e||e.byteLength<L.byteLength+f)&&(e?.destroy(),e=t.createBuffer({byteLength:L.byteLength+f,usage:35050})),e.write(L,f),e}class ore{constructor({device:e,attribute:r,timeline:n}){this.buffers=[],this.currentLength=0,this.device=e,this.transition=new iC(n),this.attribute=r,this.attributeInTransition=Z$e(r),this.currentStartIndices=r.startIndices}get inProgress(){return this.transition.inProgress}start(e,r,n=1/0){this.settings=e,this.currentStartIndices=this.attribute.startIndices,this.currentLength=K$e(this.attribute,r),this.transition.start({...e,duration:n})}update(){const e=this.transition.update();return e&&this.onUpdate(),e}setBuffer(e){this.attributeInTransition.setData({buffer:e,normalized:this.attribute.settings.normalized,value:this.attributeInTransition.value})}cancel(){this.transition.cancel()}delete(){this.cancel();for(const e of this.buffers)e.destroy();this.buffers.length=0}}class J$e extends ore{constructor({device:e,attribute:r,timeline:n}){super({device:e,attribute:r,timeline:n}),this.type="interpolation",this.transform=rqe(e,r)}start(e,r){const n=this.currentLength,i=this.currentStartIndices;if(super.start(e,r,e.duration),e.duration<=0){this.transition.cancel();return}const{buffers:a,attribute:s}=this;nre(a),a[0]=are({device:this.device,buffer:a[0],attribute:s,fromLength:n,toLength:this.currentLength,fromStartIndices:i,getData:e.enter}),a[1]=ire({device:this.device,source:a[0],target:a[1]}),this.setBuffer(a[1]);const{transform:o}=this,u=o.model;let h=Math.floor(this.currentLength/s.size);sre(s)&&(h/=2),u.setVertexCount(h),s.isConstant?(u.setAttributes({aFrom:a[0]}),u.setConstantAttributes({aTo:s.value})):u.setAttributes({aFrom:a[0],aTo:s.getBuffer()}),o.transformFeedback.setBuffers({vCurrent:a[1]})}onUpdate(){const{duration:e,easing:r}=this.settings,{time:n}=this.transition;let i=n/e;r&&(i=r(i));const{model:a}=this.transform,s={time:i};a.shaderInputs.setProps({interpolation:s}),this.transform.run({discard:!0})}delete(){super.delete(),this.transform.destroy()}}const Q$e=`uniform interpolationUniforms {
  float time;
} interpolation;
`,NH={name:"interpolation",vs:Q$e,uniformTypes:{time:"f32"}},eqe=`#version 300 es
#define SHADER_NAME interpolation-transition-vertex-shader

in ATTRIBUTE_TYPE aFrom;
in ATTRIBUTE_TYPE aTo;
out ATTRIBUTE_TYPE vCurrent;

void main(void) {
  vCurrent = mix(aFrom, aTo, interpolation.time);
  gl_Position = vec4(0.0);
}
`,tqe=`#version 300 es
#define SHADER_NAME interpolation-transition-vertex-shader

in ATTRIBUTE_TYPE aFrom;
in ATTRIBUTE_TYPE aFrom64Low;
in ATTRIBUTE_TYPE aTo;
in ATTRIBUTE_TYPE aTo64Low;
out ATTRIBUTE_TYPE vCurrent;
out ATTRIBUTE_TYPE vCurrent64Low;

vec2 mix_fp64(vec2 a, vec2 b, float x) {
  vec2 range = sub_fp64(b, a);
  return sum_fp64(a, mul_fp64(range, vec2(x, 0.0)));
}

void main(void) {
  for (int i=0; i<ATTRIBUTE_SIZE; i++) {
    vec2 value = mix_fp64(vec2(aFrom[i], aFrom64Low[i]), vec2(aTo[i], aTo64Low[i]), interpolation.time);
    vCurrent[i] = value.x;
    vCurrent64Low[i] = value.y;
  }
  gl_Position = vec4(0.0);
}
`;function sre(t){return t.doublePrecision&&t.value instanceof Float64Array}function rqe(t,e){const r=e.size,n=tre(r),i=rre(r),a=e.getBufferLayout();return sre(e)?new Nm(t,{vs:tqe,bufferLayout:[{name:"aFrom",byteStride:8*r,attributes:[{attribute:"aFrom",format:i,byteOffset:0},{attribute:"aFrom64Low",format:i,byteOffset:4*r}]},{name:"aTo",byteStride:8*r,attributes:[{attribute:"aTo",format:i,byteOffset:0},{attribute:"aTo64Low",format:i,byteOffset:4*r}]}],modules:[c9e,NH],defines:{ATTRIBUTE_TYPE:n,ATTRIBUTE_SIZE:r},moduleSettings:{},varyings:["vCurrent","vCurrent64Low"],bufferMode:35980,disableWarnings:!0}):new Nm(t,{vs:eqe,bufferLayout:[{name:"aFrom",format:i},{name:"aTo",format:a.attributes[0].format}],modules:[NH],defines:{ATTRIBUTE_TYPE:n},varyings:["vCurrent"],disableWarnings:!0})}class nqe extends ore{constructor({device:e,attribute:r,timeline:n}){super({device:e,attribute:r,timeline:n}),this.type="spring",this.texture=uqe(e),this.framebuffer=cqe(e,this.texture),this.transform=lqe(e,r)}start(e,r){const n=this.currentLength,i=this.currentStartIndices;super.start(e,r);const{buffers:a,attribute:s}=this;for(let u=0;u<2;u++)a[u]=are({device:this.device,buffer:a[u],attribute:s,fromLength:n,toLength:this.currentLength,fromStartIndices:i,getData:e.enter});a[2]=ire({device:this.device,source:a[0],target:a[2]}),this.setBuffer(a[1]);const{model:o}=this.transform;o.setVertexCount(Math.floor(this.currentLength/s.size)),s.isConstant?o.setConstantAttributes({aTo:s.value}):o.setAttributes({aTo:s.getBuffer()})}onUpdate(){const{buffers:e,transform:r,framebuffer:n,transition:i}=this,a=this.settings;r.model.setAttributes({aPrev:e[0],aCur:e[1]}),r.transformFeedback.setBuffers({vNext:e[2]});const s={stiffness:a.stiffness,damping:a.damping};r.model.shaderInputs.setProps({spring:s}),r.run({framebuffer:n,discard:!1,parameters:{viewport:[0,0,1,1]},clearColor:[0,0,0,0]}),nre(e),this.setBuffer(e[1]),this.device.readPixelsToArrayWebGL(n)[0]>0||i.end()}delete(){super.delete(),this.transform.destroy(),this.texture.destroy(),this.framebuffer.destroy()}}const iqe=`uniform springUniforms {
  float damping;
  float stiffness;
} spring;
`,aqe={name:"spring",vs:iqe,uniformTypes:{damping:"f32",stiffness:"f32"}},oqe=`#version 300 es
#define SHADER_NAME spring-transition-vertex-shader

#define EPSILON 0.00001

in ATTRIBUTE_TYPE aPrev;
in ATTRIBUTE_TYPE aCur;
in ATTRIBUTE_TYPE aTo;
out ATTRIBUTE_TYPE vNext;
out float vIsTransitioningFlag;

ATTRIBUTE_TYPE getNextValue(ATTRIBUTE_TYPE cur, ATTRIBUTE_TYPE prev, ATTRIBUTE_TYPE dest) {
  ATTRIBUTE_TYPE velocity = cur - prev;
  ATTRIBUTE_TYPE delta = dest - cur;
  ATTRIBUTE_TYPE force = delta * spring.stiffness;
  ATTRIBUTE_TYPE resistance = velocity * spring.damping;
  return force - resistance + velocity + cur;
}

void main(void) {
  bool isTransitioning = length(aCur - aPrev) > EPSILON || length(aTo - aCur) > EPSILON;
  vIsTransitioningFlag = isTransitioning ? 1.0 : 0.0;

  vNext = getNextValue(aCur, aPrev, aTo);
  gl_Position = vec4(0, 0, 0, 1);
  gl_PointSize = 100.0;
}
`,sqe=`#version 300 es
#define SHADER_NAME spring-transition-is-transitioning-fragment-shader

in float vIsTransitioningFlag;

out vec4 fragColor;

void main(void) {
  if (vIsTransitioningFlag == 0.0) {
    discard;
  }
  fragColor = vec4(1.0);
}`;function lqe(t,e){const r=tre(e.size),n=rre(e.size);return new Nm(t,{vs:oqe,fs:sqe,bufferLayout:[{name:"aPrev",format:n},{name:"aCur",format:n},{name:"aTo",format:e.getBufferLayout().attributes[0].format}],varyings:["vNext"],modules:[aqe],defines:{ATTRIBUTE_TYPE:r},parameters:{depthCompare:"always",blendColorOperation:"max",blendColorSrcFactor:"one",blendColorDstFactor:"one",blendAlphaOperation:"max",blendAlphaSrcFactor:"one",blendAlphaDstFactor:"one"}})}function uqe(t){return t.createTexture({data:new Uint8Array(4),format:"rgba8unorm",mipmaps:!1,width:1,height:1})}function cqe(t,e){return t.createFramebuffer({id:"spring-transition-is-transitioning-framebuffer",width:1,height:1,colorAttachments:[e]})}const hqe={interpolation:J$e,spring:nqe};class fqe{constructor(e,{id:r,timeline:n}){if(!e)throw new Error("AttributeTransitionManager is constructed without device");this.id=r,this.device=e,this.timeline=n,this.transitions={},this.needsRedraw=!1,this.numInstances=1}finalize(){for(const e in this.transitions)this._removeTransition(e)}update({attributes:e,transitions:r,numInstances:n}){this.numInstances=n||1;for(const i in e){const a=e[i],s=a.getTransitionSetting(r);s&&this._updateAttribute(i,a,s)}for(const i in this.transitions){const a=e[i];(!a||!a.getTransitionSetting(r))&&this._removeTransition(i)}}hasAttribute(e){const r=this.transitions[e];return r&&r.inProgress}getAttributes(){const e={};for(const r in this.transitions){const n=this.transitions[r];n.inProgress&&(e[r]=n.attributeInTransition)}return e}run(){if(this.numInstances===0)return!1;for(const r in this.transitions)this.transitions[r].update()&&(this.needsRedraw=!0);const e=this.needsRedraw;return this.needsRedraw=!1,e}_removeTransition(e){this.transitions[e].delete(),delete this.transitions[e]}_updateAttribute(e,r,n){const i=this.transitions[e];let a=!i||i.type!==n.type;if(a){i&&this._removeTransition(e);const s=hqe[n.type];s?this.transitions[e]=new s({attribute:r,timeline:this.timeline,device:this.device}):(Za.error(`unsupported transition type '${n.type}'`)(),a=!1)}(a||r.needsRedraw())&&(this.needsRedraw=!0,this.transitions[e].start(n,this.numInstances))}}const DH="attributeManager.invalidate",dqe="attributeManager.updateStart",pqe="attributeManager.updateEnd",gqe="attribute.updateStart",mqe="attribute.allocate",yqe="attribute.updateEnd";class lre{constructor(e,{id:r="attribute-manager",stats:n,timeline:i}={}){this.mergeBoundsMemoized=_x(k7e),this.id=r,this.device=e,this.attributes={},this.updateTriggers={},this.needsRedraw=!0,this.userData={},this.stats=n,this.attributeTransitionManager=new fqe(e,{id:`${r}-transitions`,timeline:i}),Object.seal(this)}finalize(){for(const e in this.attributes)this.attributes[e].delete();this.attributeTransitionManager.finalize()}getNeedsRedraw(e={clearRedrawFlags:!1}){const r=this.needsRedraw;return this.needsRedraw=this.needsRedraw&&!e.clearRedrawFlags,r&&this.id}setNeedsRedraw(){this.needsRedraw=!0}add(e){this._add(e)}addInstanced(e){this._add(e,{stepMode:"instance"})}remove(e){for(const r of e)this.attributes[r]!==void 0&&(this.attributes[r].delete(),delete this.attributes[r])}invalidate(e,r){const n=this._invalidateTrigger(e,r);Uu(DH,this,e,n)}invalidateAll(e){for(const r in this.attributes)this.attributes[r].setNeedsUpdate(r,e);Uu(DH,this,"all")}update({data:e,numInstances:r,startIndices:n=null,transitions:i,props:a={},buffers:s={},context:o={}}){let u=!1;Uu(dqe,this),this.stats&&this.stats.get("Update Attributes").timeStart();for(const h in this.attributes){const f=this.attributes[h],g=f.settings.accessor;f.startIndices=n,f.numInstances=r,a[h]&&Za.removed(`props.${h}`,`data.attributes.${h}`)(),f.setExternalBuffer(s[h])||f.setBinaryValue(typeof g=="string"?s[g]:void 0,e.startIndices)||typeof g=="string"&&!s[g]&&f.setConstantValue(a[g])||f.needsUpdate()&&(u=!0,this._updateAttribute({attribute:f,numInstances:r,data:e,props:a,context:o})),this.needsRedraw=this.needsRedraw||f.needsRedraw()}u&&Uu(pqe,this,r),this.stats&&this.stats.get("Update Attributes").timeEnd(),this.attributeTransitionManager.update({attributes:this.attributes,numInstances:r,transitions:i})}updateTransition(){const{attributeTransitionManager:e}=this,r=e.run();return this.needsRedraw=this.needsRedraw||r,r}getAttributes(){return{...this.attributes,...this.attributeTransitionManager.getAttributes()}}getBounds(e){const r=e.map(n=>this.attributes[n]?.getBounds());return this.mergeBoundsMemoized(r)}getChangedAttributes(e={clearChangedFlags:!1}){const{attributes:r,attributeTransitionManager:n}=this,i={...n.getAttributes()};for(const a in r){const s=r[a];s.needsRedraw(e)&&!n.hasAttribute(a)&&(i[a]=s)}return i}getBufferLayouts(e){return Object.values(this.getAttributes()).map(r=>r.getBufferLayout(e))}_add(e,r){for(const n in e){const i=e[n],a={...i,id:n,size:i.isIndexed&&1||i.size||1,...r};this.attributes[n]=new ere(this.device,a)}this._mapUpdateTriggersToAttributes()}_mapUpdateTriggersToAttributes(){const e={};for(const r in this.attributes)this.attributes[r].getUpdateTriggers().forEach(i=>{e[i]||(e[i]=[]),e[i].push(r)});this.updateTriggers=e}_invalidateTrigger(e,r){const{attributes:n,updateTriggers:i}=this,a=i[e];return a&&a.forEach(s=>{const o=n[s];o&&o.setNeedsUpdate(o.id,r)}),a}_updateAttribute(e){const{attribute:r,numInstances:n}=e;if(Uu(gqe,r),r.constant){r.setConstantValue(r.value);return}r.allocate(n)&&Uu(mqe,r,n),r.updateBuffer(e)&&(this.needsRedraw=!0,Uu(yqe,r,n))}}class vqe extends iC{get value(){return this._value}_onUpdate(){const{time:e,settings:{fromValue:r,toValue:n,duration:i,easing:a}}=this,s=a(e/i);this._value=vE(r,n,s)}}const FH=1e-5;function BH(t,e,r,n,i){const a=e-t,o=(r-e)*i,u=-a*n;return o+u+a+e}function _qe(t,e,r,n,i){if(Array.isArray(r)){const a=[];for(let s=0;s<r.length;s++)a[s]=BH(t[s],e[s],r[s],n,i);return a}return BH(t,e,r,n,i)}function zH(t,e){if(Array.isArray(t)){let r=0;for(let n=0;n<t.length;n++){const i=t[n]-e[n];r+=i*i}return Math.sqrt(r)}return Math.abs(t-e)}class bqe extends iC{get value(){return this._currValue}_onUpdate(){const{fromValue:e,toValue:r,damping:n,stiffness:i}=this.settings,{_prevValue:a=e,_currValue:s=e}=this;let o=_qe(a,s,r,n,i);const u=zH(o,r),h=zH(o,s);u<FH&&h<FH&&(o=r,this.end()),this._prevValue=s,this._currValue=o}}const xqe={interpolation:vqe,spring:bqe};class wqe{constructor(e){this.transitions=new Map,this.timeline=e}get active(){return this.transitions.size>0}add(e,r,n,i){const{transitions:a}=this;if(a.has(e)){const u=a.get(e),{value:h=u.settings.fromValue}=u;r=h,this.remove(e)}if(i=Qte(i),!i)return;const s=xqe[i.type];if(!s){Za.error(`unsupported transition type '${i.type}'`)();return}const o=new s(this.timeline);o.start({...i,fromValue:r,toValue:n}),a.set(e,o)}remove(e){const{transitions:r}=this;r.has(e)&&(r.get(e).cancel(),r.delete(e))}update(){const e={};for(const[r,n]of this.transitions)n.update(),e[r]=n.value,n.inProgress||this.remove(r);return e}clear(){for(const e of this.transitions.keys())this.remove(e)}}function Sqe(t){const e=t[Xp];for(const r in e){const n=e[r],{validate:i}=n;if(i&&!i(t[r],n))throw new Error(`Invalid prop ${r}: ${t[r]}`)}}function Eqe(t,e){const r=ure({newProps:t,oldProps:e,propTypes:t[Xp],ignoreProps:{data:null,updateTriggers:null,extensions:null,transitions:null}}),n=Cqe(t,e);let i=!1;return n||(i=Aqe(t,e)),{dataChanged:n,propsChanged:r,updateTriggersChanged:i,extensionsChanged:Iqe(t,e),transitionsChanged:Tqe(t,e)}}function Tqe(t,e){if(!t.transitions)return!1;const r={},n=t[Xp];let i=!1;for(const a in t.transitions){const s=n[a],o=s&&s.type;(o==="number"||o==="color"||o==="array")&&hR(t[a],e[a],s)&&(r[a]=!0,i=!0)}return i?r:!1}function ure({newProps:t,oldProps:e,ignoreProps:r={},propTypes:n={},triggerName:i="props"}){if(e===t)return!1;if(typeof t!="object"||t===null)return`${i} changed shallowly`;if(typeof e!="object"||e===null)return`${i} changed shallowly`;for(const a of Object.keys(t))if(!(a in r)){if(!(a in e))return`${i}.${a} added`;const s=hR(t[a],e[a],n[a]);if(s)return`${i}.${a} ${s}`}for(const a of Object.keys(e))if(!(a in r)){if(!(a in t))return`${i}.${a} dropped`;if(!Object.hasOwnProperty.call(t,a)){const s=hR(t[a],e[a],n[a]);if(s)return`${i}.${a} ${s}`}}return!1}function hR(t,e,r){let n=r&&r.equal;return n&&!n(t,e,r)||!n&&(n=t&&e&&t.equals,n&&!n.call(t,e))?"changed deeply":!n&&e!==t?"changed shallowly":null}function Cqe(t,e){if(e===null)return"oldProps is null, initial diff";let r=!1;const{dataComparator:n,_dataDiff:i}=t;return n?n(t.data,e.data)||(r="Data comparator detected a change"):t.data!==e.data&&(r="A new data container was supplied"),r&&i&&(r=i(t.data,e.data)||r),r}function Aqe(t,e){if(e===null)return{all:!0};if("all"in t.updateTriggers&&jH(t,e,"all"))return{all:!0};const r={};let n=!1;for(const i in t.updateTriggers)i!=="all"&&jH(t,e,i)&&(r[i]=!0,n=!0);return n?r:!1}function Iqe(t,e){if(e===null)return!0;const r=e.extensions,{extensions:n}=t;if(n===r)return!1;if(!r||!n||n.length!==r.length)return!0;for(let i=0;i<n.length;i++)if(!n[i].equals(r[i]))return!0;return!1}function jH(t,e,r){let n=t.updateTriggers[r];n=n??{};let i=e.updateTriggers[r];return i=i??{},ure({oldProps:i,newProps:n,triggerName:r})}const Pqe="count(): argument not an object",kqe="count(): argument not a container";function Mqe(t){if(!Oqe(t))throw new Error(Pqe);if(typeof t.count=="function")return t.count();if(Number.isFinite(t.size))return t.size;if(Number.isFinite(t.length))return t.length;if(Rqe(t))return Object.keys(t).length;throw new Error(kqe)}function Rqe(t){return t!==null&&typeof t=="object"&&t.constructor===Object}function Oqe(t){return t!==null&&typeof t=="object"}function UH(t,e){if(!e)return t;const r={...t,...e};if("defines"in e&&(r.defines={...t.defines,...e.defines}),"modules"in e&&(r.modules=(t.modules||[]).concat(e.modules),e.modules.some(n=>n.name==="project64"))){const n=r.modules.findIndex(i=>i.name==="project32");n>=0&&r.modules.splice(n,1)}if("inject"in e)if(!t.inject)r.inject=e.inject;else{const n={...t.inject};for(const i in e.inject)n[i]=(n[i]||"")+e.inject[i];r.inject=n}return r}const Lqe={minFilter:"linear",mipmapFilter:"linear",magFilter:"linear",addressModeU:"clamp-to-edge",addressModeV:"clamp-to-edge"},fR={};function Nqe(t,e,r,n){if(r instanceof yo)return r;r.constructor&&r.constructor.name!=="Object"&&(r={data:r});let i=null;r.compressed&&(i={minFilter:"linear",mipmapFilter:r.data.length>1?"nearest":"linear"});const a=e.createTexture({...r,sampler:{...Lqe,...i,...n},mipmaps:!0});return fR[a.id]=t,a}function Dqe(t,e){!e||!(e instanceof yo)||fR[e.id]===t&&(e.delete(),delete fR[e.id])}const Fqe={boolean:{validate(t,e){return!0},equal(t,e,r){return!!t==!!e}},number:{validate(t,e){return Number.isFinite(t)&&(!("max"in e)||t<=e.max)&&(!("min"in e)||t>=e.min)}},color:{validate(t,e){return e.optional&&!t||dR(t)&&(t.length===3||t.length===4)},equal(t,e,r){return vc(t,e,1)}},accessor:{validate(t,e){const r=EE(t);return r==="function"||r===EE(e.value)},equal(t,e,r){return typeof e=="function"?!0:vc(t,e,1)}},array:{validate(t,e){return e.optional&&!t||dR(t)},equal(t,e,r){const{compare:n}=r,i=Number.isInteger(n)?n:n?1:0;return n?vc(t,e,i):t===e}},object:{equal(t,e,r){if(r.ignore)return!0;const{compare:n}=r,i=Number.isInteger(n)?n:n?1:0;return n?vc(t,e,i):t===e}},function:{validate(t,e){return e.optional&&!t||typeof t=="function"},equal(t,e,r){return!r.compare&&r.ignore!==!1||t===e}},data:{transform:(t,e,r)=>{if(!t)return t;const{dataTransform:n}=r.props;return n?n(t):typeof t.shape=="string"&&t.shape.endsWith("-table")&&Array.isArray(t.data)?t.data:t}},image:{transform:(t,e,r)=>{const n=r.context;return!n||!n.device?null:Nqe(r.id,n.device,t,{...e.parameters,...r.props.textureParameters})},release:(t,e,r)=>{Dqe(r.id,t)}}};function Bqe(t){const e={},r={},n={};for(const[i,a]of Object.entries(t)){const s=a?.deprecatedFor;if(s)n[i]=Array.isArray(s)?s:[s];else{const o=zqe(i,a);e[i]=o,r[i]=o.value}}return{propTypes:e,defaultProps:r,deprecatedProps:n}}function zqe(t,e){switch(EE(e)){case"object":return $_(t,e);case"array":return $_(t,{type:"array",value:e,compare:!1});case"boolean":return $_(t,{type:"boolean",value:e});case"number":return $_(t,{type:"number",value:e});case"function":return $_(t,{type:"function",value:e,compare:!0});default:return{name:t,type:"unknown",value:e}}}function $_(t,e){return"type"in e?{name:t,...Fqe[e.type],...e}:"value"in e?{name:t,type:EE(e.value),...e}:{name:t,type:"object",value:e}}function dR(t){return Array.isArray(t)||ArrayBuffer.isView(t)}function EE(t){return dR(t)?"array":t===null?"null":typeof t}function jqe(t,e){let r;for(let a=e.length-1;a>=0;a--){const s=e[a];"extensions"in s&&(r=s.extensions)}const n=pR(t.constructor,r),i=Object.create(n);i[wE]=t,i[Dm]={},i[Up]={};for(let a=0;a<e.length;++a){const s=e[a];for(const o in s)i[o]=s[o]}return Object.freeze(i),i}const Uqe="_mergedDefaultProps";function pR(t,e){if(!(t instanceof aC.constructor))return{};let r=Uqe;if(e)for(const i of e){const a=i.constructor;a&&(r+=`:${a.extensionName||a.name}`)}const n=cre(t,r);return n||(t[r]=Vqe(t,e||[]))}function Vqe(t,e){if(!t.prototype)return null;const n=Object.getPrototypeOf(t),i=pR(n),a=cre(t,"defaultProps")||{},s=Bqe(a),o=Object.assign(Object.create(null),i,s.defaultProps),u=Object.assign(Object.create(null),i?.[Xp],s.propTypes),h=Object.assign(Object.create(null),i?.[JI],s.deprecatedProps);for(const f of e){const g=pR(f.constructor);g&&(Object.assign(o,g),Object.assign(u,g[Xp]),Object.assign(h,g[JI]))}return $qe(o,t),Hqe(o,u),qqe(o,h),o[Xp]=u,o[JI]=h,e.length===0&&!sD(t,"_propTypes")&&(t._propTypes=u),o}function $qe(t,e){const r=Gqe(e);Object.defineProperties(t,{id:{writable:!0,value:r}})}function qqe(t,e){for(const r in e)Object.defineProperty(t,r,{enumerable:!1,set(n){const i=`${this.id}: ${r}`;for(const a of e[r])sD(this,a)||(this[a]=n);Za.deprecated(i,e[r].join("/"))()}})}function Hqe(t,e){const r={},n={};for(const i in e){const a=e[i],{name:s,value:o}=a;a.async&&(r[s]=o,n[s]=Wqe(s))}t[Zv]=r,t[Dm]={},Object.defineProperties(t,n)}function Wqe(t){return{enumerable:!0,set(e){typeof e=="string"||e instanceof Promise||Jte(e)?this[Dm][t]=e:this[Up][t]=e},get(){if(this[Up]){if(t in this[Up])return this[Up][t]||this[Zv][t];if(t in this[Dm]){const e=this[wE]&&this[wE].internalState;if(e&&e.hasAsyncProp(t))return e.getAsyncProp(t)||this[Zv][t]}}return this[Zv][t]}}}function sD(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function cre(t,e){return sD(t,e)&&t[e]}function Gqe(t){const e=t.componentName;return e||Za.warn(`${t.name}.componentName not specified`)(),e||t.name}let Xqe=0;class aC{constructor(...e){this.props=jqe(this,e),this.id=this.props.id,this.count=Xqe++}clone(e){const{props:r}=this,n={};for(const i in r[Zv])i in r[Up]?n[i]=r[Up][i]:i in r[Dm]&&(n[i]=r[Dm][i]);return new this.constructor({...r,...n,...e})}}aC.componentName="Component";aC.defaultProps={};const Yqe=Object.freeze({});class Zqe{constructor(e){this.component=e,this.asyncProps={},this.onAsyncPropUpdated=()=>{},this.oldProps=null,this.oldAsyncProps=null}finalize(){for(const e in this.asyncProps){const r=this.asyncProps[e];r&&r.type&&r.type.release&&r.type.release(r.resolvedValue,r.type,this.component)}this.asyncProps={},this.component=null,this.resetOldProps()}getOldProps(){return this.oldAsyncProps||this.oldProps||Yqe}resetOldProps(){this.oldAsyncProps=null,this.oldProps=this.component?this.component.props:null}hasAsyncProp(e){return e in this.asyncProps}getAsyncProp(e){const r=this.asyncProps[e];return r&&r.resolvedValue}isAsyncPropLoading(e){if(e){const r=this.asyncProps[e];return!!(r&&r.pendingLoadCount>0&&r.pendingLoadCount!==r.resolvedLoadCount)}for(const r in this.asyncProps)if(this.isAsyncPropLoading(r))return!0;return!1}reloadAsyncProp(e,r){this._watchPromise(e,Promise.resolve(r))}setAsyncProps(e){this.component=e[wE]||this.component;const r=e[Up]||{},n=e[Dm]||e,i=e[Zv]||{};for(const a in r){const s=r[a];this._createAsyncPropData(a,i[a]),this._updateAsyncProp(a,s),r[a]=this.getAsyncProp(a)}for(const a in n){const s=n[a];this._createAsyncPropData(a,i[a]),this._updateAsyncProp(a,s)}}_fetch(e,r){return null}_onResolve(e,r){}_onError(e,r){}_updateAsyncProp(e,r){if(this._didAsyncInputValueChange(e,r)){if(typeof r=="string"&&(r=this._fetch(e,r)),r instanceof Promise){this._watchPromise(e,r);return}if(Jte(r)){this._resolveAsyncIterable(e,r);return}this._setPropValue(e,r)}}_freezeAsyncOldProps(){if(!this.oldAsyncProps&&this.oldProps){this.oldAsyncProps=Object.create(this.oldProps);for(const e in this.asyncProps)Object.defineProperty(this.oldAsyncProps,e,{enumerable:!0,value:this.oldProps[e]})}}_didAsyncInputValueChange(e,r){const n=this.asyncProps[e];return r===n.resolvedValue||r===n.lastValue?!1:(n.lastValue=r,!0)}_setPropValue(e,r){this._freezeAsyncOldProps();const n=this.asyncProps[e];n&&(r=this._postProcessValue(n,r),n.resolvedValue=r,n.pendingLoadCount++,n.resolvedLoadCount=n.pendingLoadCount)}_setAsyncPropValue(e,r,n){const i=this.asyncProps[e];i&&n>=i.resolvedLoadCount&&r!==void 0&&(this._freezeAsyncOldProps(),i.resolvedValue=r,i.resolvedLoadCount=n,this.onAsyncPropUpdated(e,r))}_watchPromise(e,r){const n=this.asyncProps[e];if(n){n.pendingLoadCount++;const i=n.pendingLoadCount;r.then(a=>{this.component&&(a=this._postProcessValue(n,a),this._setAsyncPropValue(e,a,i),this._onResolve(e,a))}).catch(a=>{this._onError(e,a)})}}async _resolveAsyncIterable(e,r){if(e!=="data"){this._setPropValue(e,r);return}const n=this.asyncProps[e];if(!n)return;n.pendingLoadCount++;const i=n.pendingLoadCount;let a=[],s=0;for await(const o of r){if(!this.component)return;const{dataTransform:u}=this.component.props;u?a=u(o,a):a=a.concat(o),Object.defineProperty(a,"__diff",{enumerable:!1,value:[{startRow:s,endRow:a.length}]}),s=a.length,this._setAsyncPropValue(e,a,i)}this._onResolve(e,a)}_postProcessValue(e,r){const n=e.type;return n&&this.component&&(n.release&&n.release(e.resolvedValue,n,this.component),n.transform)?n.transform(r,n,this.component):r}_createAsyncPropData(e,r){if(!this.asyncProps[e]){const i=this.component&&this.component.props[Xp];this.asyncProps[e]={type:i&&i[e],lastValue:null,resolvedValue:r,pendingLoadCount:0,resolvedLoadCount:0}}}}class Kqe extends Zqe{constructor({attributeManager:e,layer:r}){super(r),this.attributeManager=e,this.needsRedraw=!0,this.needsUpdate=!0,this.subLayers=null,this.usesPickingColorCache=!1}get layer(){return this.component}_fetch(e,r){const n=this.layer,i=n?.props.fetch;return i?i(r,{propName:e,layer:n}):super._fetch(e,r)}_onResolve(e,r){const n=this.layer;if(n){const i=n.props.onDataLoad;e==="data"&&i&&i(r,{propName:e,layer:n})}}_onError(e,r){const n=this.layer;n&&n.raiseError(r,`loading ${e} of ${this.layer}`)}}const Jqe="layer.changeFlag",Qqe="layer.initialize",eHe="layer.update",tHe="layer.finalize",rHe="layer.matched",VH=2**24-1,nHe=Object.freeze([]),iHe=_x(({oldViewport:t,viewport:e})=>t.equals(e));let Xh=new Uint8ClampedArray(0);const aHe={data:{type:"data",value:nHe,async:!0},dataComparator:{type:"function",value:null,optional:!0},_dataDiff:{type:"function",value:t=>t&&t.__diff,optional:!0},dataTransform:{type:"function",value:null,optional:!0},onDataLoad:{type:"function",value:null,optional:!0},onError:{type:"function",value:null,optional:!0},fetch:{type:"function",value:(t,{propName:e,layer:r,loaders:n,loadOptions:i,signal:a})=>{const{resourceManager:s}=r.context;i=i||r.getLoadOptions(),n=n||r.props.loaders,a&&(i={...i,fetch:{...i?.fetch,signal:a}});let o=s.contains(t);return!o&&!i&&(s.add({resourceId:t,data:BM(t,n),persistent:!1}),o=!0),o?s.subscribe({resourceId:t,onChange:u=>r.internalState?.reloadAsyncProp(e,u),consumerId:r.id,requestId:e}):BM(t,n,i)}},updateTriggers:{},visible:!0,pickable:!1,opacity:{type:"number",min:0,max:1,value:1},operation:"draw",onHover:{type:"function",value:null,optional:!0},onClick:{type:"function",value:null,optional:!0},onDragStart:{type:"function",value:null,optional:!0},onDrag:{type:"function",value:null,optional:!0},onDragEnd:{type:"function",value:null,optional:!0},coordinateSystem:qa.DEFAULT,coordinateOrigin:{type:"array",value:[0,0,0],compare:!0},modelMatrix:{type:"array",value:null,compare:!0,optional:!0},wrapLongitude:!1,positionFormat:"XYZ",colorFormat:"RGBA",parameters:{type:"object",value:{},optional:!0,compare:2},loadOptions:{type:"object",value:null,optional:!0,ignore:!0},transitions:null,extensions:[],loaders:{type:"array",value:[],optional:!0,ignore:!0},getPolygonOffset:{type:"function",value:({layerIndex:t})=>[0,-t*100]},highlightedObjectIndex:null,autoHighlight:!1,highlightColor:{type:"accessor",value:[0,0,128,128]}};class oC extends aC{constructor(){super(...arguments),this.internalState=null,this.lifecycle=_v.NO_STATE,this.parent=null}static get componentName(){return Object.prototype.hasOwnProperty.call(this,"layerName")?this.layerName:""}get root(){let e=this;for(;e.parent;)e=e.parent;return e}toString(){return`${this.constructor.layerName||this.constructor.name}({id: '${this.props.id}'})`}project(e){Rl(this.internalState);const r=this.internalState.viewport||this.context.viewport,n=Tte(e,{viewport:r,modelMatrix:this.props.modelMatrix,coordinateOrigin:this.props.coordinateOrigin,coordinateSystem:this.props.coordinateSystem}),[i,a,s]=xte(n,r.pixelProjectionMatrix);return e.length===2?[i,a]:[i,a,s]}unproject(e){return Rl(this.internalState),(this.internalState.viewport||this.context.viewport).unproject(e)}projectPosition(e,r){Rl(this.internalState);const n=this.internalState.viewport||this.context.viewport;return D7e(e,{viewport:n,modelMatrix:this.props.modelMatrix,coordinateOrigin:this.props.coordinateOrigin,coordinateSystem:this.props.coordinateSystem,...r})}get isComposite(){return!1}get isDrawable(){return!0}setState(e){this.setChangeFlags({stateChanged:!0}),Object.assign(this.state,e),this.setNeedsRedraw()}setNeedsRedraw(){this.internalState&&(this.internalState.needsRedraw=!0)}setNeedsUpdate(){this.internalState&&(this.context.layerManager.setNeedsUpdate(String(this)),this.internalState.needsUpdate=!0)}get isLoaded(){return this.internalState?!this.internalState.isAsyncPropLoading():!1}get wrapLongitude(){return this.props.wrapLongitude}isPickable(){return this.props.pickable&&this.props.visible}getModels(){const e=this.state;return e&&(e.models||e.model&&[e.model])||[]}setShaderModuleProps(...e){for(const r of this.getModels())r.shaderInputs.setProps(...e)}getAttributeManager(){return this.internalState&&this.internalState.attributeManager}getCurrentLayer(){return this.internalState&&this.internalState.layer}getLoadOptions(){return this.props.loadOptions}use64bitPositions(){const{coordinateSystem:e}=this.props;return e===qa.DEFAULT||e===qa.LNGLAT||e===qa.CARTESIAN}onHover(e,r){return this.props.onHover&&this.props.onHover(e,r)||!1}onClick(e,r){return this.props.onClick&&this.props.onClick(e,r)||!1}nullPickingColor(){return[0,0,0]}encodePickingColor(e,r=[]){return r[0]=e+1&255,r[1]=e+1>>8&255,r[2]=e+1>>8>>8&255,r}decodePickingColor(e){Rl(e instanceof Uint8Array);const[r,n,i]=e;return r+n*256+i*65536-1}getNumInstances(){return Number.isFinite(this.props.numInstances)?this.props.numInstances:this.state&&this.state.numInstances!==void 0?this.state.numInstances:Mqe(this.props.data)}getStartIndices(){return this.props.startIndices?this.props.startIndices:this.state&&this.state.startIndices?this.state.startIndices:null}getBounds(){return this.getAttributeManager()?.getBounds(["positions","instancePositions"])}getShaders(e){e=UH(e,{disableWarnings:!0,modules:this.context.defaultShaderModules});for(const r of this.props.extensions)e=UH(e,r.getShaders.call(this,r));return e}shouldUpdateState(e){return e.changeFlags.propsOrDataChanged}updateState(e){const r=this.getAttributeManager(),{dataChanged:n}=e.changeFlags;if(n&&r)if(Array.isArray(n))for(const i of n)r.invalidateAll(i);else r.invalidateAll();if(r){const{props:i}=e,a=this.internalState.hasPickingBuffer,s=Number.isInteger(i.highlightedObjectIndex)||i.pickable||i.extensions.some(o=>o.getNeedsPickingBuffer.call(this,o));if(a!==s){this.internalState.hasPickingBuffer=s;const{pickingColors:o,instancePickingColors:u}=r.attributes,h=o||u;h&&(s&&h.constant&&(h.constant=!1,r.invalidate(h.id)),!h.value&&!s&&(h.constant=!0,h.value=[0,0,0]))}}}finalizeState(e){for(const n of this.getModels())n.destroy();const r=this.getAttributeManager();r&&r.finalize(),this.context&&this.context.resourceManager.unsubscribe({consumerId:this.id}),this.internalState&&(this.internalState.uniformTransitions.clear(),this.internalState.finalize())}draw(e){for(const r of this.getModels())r.draw(e.renderPass)}getPickingInfo({info:e,mode:r,sourceLayer:n}){const{index:i}=e;return i>=0&&Array.isArray(this.props.data)&&(e.object=this.props.data[i]),e}raiseError(e,r){r&&(e=new Error(`${r}: ${e.message}`,{cause:e})),this.props.onError?.(e)||this.context?.onError?.(e,this)}getNeedsRedraw(e={clearRedrawFlags:!1}){return this._getNeedsRedraw(e)}needsUpdate(){return this.internalState?this.internalState.needsUpdate||this.hasUniformTransition()||this.shouldUpdateState(this._getUpdateParams()):!1}hasUniformTransition(){return this.internalState?.uniformTransitions.active||!1}activateViewport(e){if(!this.internalState)return;const r=this.internalState.viewport;this.internalState.viewport=e,(!r||!iHe({oldViewport:r,viewport:e}))&&(this.setChangeFlags({viewportChanged:!0}),this.isComposite?this.needsUpdate()&&this.setNeedsUpdate():this._update())}invalidateAttribute(e="all"){const r=this.getAttributeManager();r&&(e==="all"?r.invalidateAll():r.invalidate(e))}updateAttributes(e){let r=!1;for(const n in e)e[n].layoutChanged()&&(r=!0);for(const n of this.getModels())this._setModelAttributes(n,e,r)}_updateAttributes(){const e=this.getAttributeManager();if(!e)return;const r=this.props,n=this.getNumInstances(),i=this.getStartIndices();e.update({data:r.data,numInstances:n,startIndices:i,props:r,transitions:r.transitions,buffers:r.data.attributes,context:this});const a=e.getChangedAttributes({clearChangedFlags:!0});this.updateAttributes(a)}_updateAttributeTransition(){const e=this.getAttributeManager();e&&e.updateTransition()}_updateUniformTransition(){const{uniformTransitions:e}=this.internalState;if(e.active){const r=e.update(),n=Object.create(this.props);for(const i in r)Object.defineProperty(n,i,{value:r[i]});return n}return this.props}calculateInstancePickingColors(e,{numInstances:r}){if(e.constant)return;const n=Math.floor(Xh.length/4);if(this.internalState.usesPickingColorCache=!0,n<r){r>VH&&Za.warn("Layer has too many data objects. Picking might not be able to distinguish all objects.")(),Xh=Mb.allocate(Xh,r,{size:4,copy:!0,maxCount:Math.max(r,VH)});const i=Math.floor(Xh.length/4),a=[0,0,0];for(let s=n;s<i;s++)this.encodePickingColor(s,a),Xh[s*4+0]=a[0],Xh[s*4+1]=a[1],Xh[s*4+2]=a[2],Xh[s*4+3]=0}e.value=Xh.subarray(0,r*4)}_setModelAttributes(e,r,n=!1){if(!Object.keys(r).length)return;if(n){const o=this.getAttributeManager();e.setBufferLayout(o.getBufferLayouts(e)),r=o.getAttributes()}const i=e.userData?.excludeAttributes||{},a={},s={};for(const o in r){if(i[o])continue;const u=r[o].getValue();for(const h in u){const f=u[h];f instanceof Oo?r[o].settings.isIndexed?e.setIndexBuffer(f):a[h]=f:f&&(s[h]=f)}}e.setAttributes(a),e.setConstantAttributes(s)}disablePickingIndex(e){const r=this.props.data;if(!("attributes"in r)){this._disablePickingIndex(e);return}const{pickingColors:n,instancePickingColors:i}=this.getAttributeManager().attributes,a=n||i,s=a&&r.attributes&&r.attributes[a.id];if(s&&s.value){const o=s.value,u=this.encodePickingColor(e);for(let h=0;h<r.length;h++){const f=a.getVertexOffset(h);o[f]===u[0]&&o[f+1]===u[1]&&o[f+2]===u[2]&&this._disablePickingIndex(h)}}else this._disablePickingIndex(e)}_disablePickingIndex(e){const{pickingColors:r,instancePickingColors:n}=this.getAttributeManager().attributes,i=r||n;if(!i)return;const a=i.getVertexOffset(e),s=i.getVertexOffset(e+1);i.buffer.write(new Uint8Array(s-a),a)}restorePickingColors(){const{pickingColors:e,instancePickingColors:r}=this.getAttributeManager().attributes,n=e||r;n&&(this.internalState.usesPickingColorCache&&n.value.buffer!==Xh.buffer&&(n.value=Xh.subarray(0,n.value.length)),n.updateSubBuffer({startOffset:0}))}_initialize(){Rl(!this.internalState),Rl(Number.isFinite(this.props.coordinateSystem)),Uu(Qqe,this);const e=this._getAttributeManager();e&&e.addInstanced({instancePickingColors:{type:"uint8",size:4,noAlloc:!0,update:this.calculateInstancePickingColors}}),this.internalState=new Kqe({attributeManager:e,layer:this}),this._clearChangeFlags(),this.state={},Object.defineProperty(this.state,"attributeManager",{get:()=>(Za.deprecated("layer.state.attributeManager","layer.getAttributeManager()")(),e)}),this.internalState.uniformTransitions=new wqe(this.context.timeline),this.internalState.onAsyncPropUpdated=this._onAsyncPropUpdated.bind(this),this.internalState.setAsyncProps(this.props),this.initializeState(this.context);for(const r of this.props.extensions)r.initializeState.call(this,this.context,r);this.setChangeFlags({dataChanged:"init",propsChanged:"init",viewportChanged:!0,extensionsChanged:!0}),this._update()}_transferState(e){Uu(rHe,this,this===e);const{state:r,internalState:n}=e;this!==e&&(this.internalState=n,this.state=r,this.internalState.setAsyncProps(this.props),this._diffProps(this.props,this.internalState.getOldProps()))}_update(){const e=this.needsUpdate();if(Uu(eHe,this,e),!e)return;const r=this.props,n=this.context,i=this.internalState,a=n.viewport,s=this._updateUniformTransition();i.propsInTransition=s,n.viewport=i.viewport||a,this.props=s;try{const o=this._getUpdateParams(),u=this.getModels();if(n.device)this.updateState(o);else try{this.updateState(o)}catch{}for(const f of this.props.extensions)f.updateState.call(this,o,f);this.setNeedsRedraw(),this._updateAttributes();const h=this.getModels()[0]!==u[0];this._postUpdate(o,h)}finally{n.viewport=a,this.props=r,this._clearChangeFlags(),i.needsUpdate=!1,i.resetOldProps()}}_finalize(){Uu(tHe,this),this.finalizeState(this.context);for(const e of this.props.extensions)e.finalizeState.call(this,this.context,e)}_drawLayer({renderPass:e,shaderModuleProps:r=null,uniforms:n={},parameters:i={}}){this._updateAttributeTransition();const a=this.props,s=this.context;this.props=this.internalState.propsInTransition||a;try{r&&this.setShaderModuleProps(r);const{getPolygonOffset:o}=this.props,u=o&&o(n)||[0,0];s.device instanceof Dv&&s.device.setParametersWebGL({polygonOffset:u});for(const h of this.getModels())h.device.type==="webgpu"?h.setParameters({...h.parameters,...i}):h.setParameters(i);if(s.device instanceof Dv)s.device.withParametersWebGL(i,()=>{const h={renderPass:e,shaderModuleProps:r,uniforms:n,parameters:i,context:s};for(const f of this.props.extensions)f.draw.call(this,h,f);this.draw(h)});else{const h={renderPass:e,shaderModuleProps:r,uniforms:n,parameters:i,context:s};for(const f of this.props.extensions)f.draw.call(this,h,f);this.draw(h)}}finally{this.props=a}}getChangeFlags(){return this.internalState?.changeFlags}setChangeFlags(e){if(!this.internalState)return;const{changeFlags:r}=this.internalState;for(const i in e)if(e[i]){let a=!1;switch(i){case"dataChanged":const s=e[i],o=r[i];s&&Array.isArray(o)&&(r.dataChanged=Array.isArray(s)?o.concat(s):s,a=!0);default:r[i]||(r[i]=e[i],a=!0)}a&&Uu(Jqe,this,i,e)}const n=!!(r.dataChanged||r.updateTriggersChanged||r.propsChanged||r.extensionsChanged);r.propsOrDataChanged=n,r.somethingChanged=n||r.viewportChanged||r.stateChanged}_clearChangeFlags(){this.internalState.changeFlags={dataChanged:!1,propsChanged:!1,updateTriggersChanged:!1,viewportChanged:!1,stateChanged:!1,extensionsChanged:!1,propsOrDataChanged:!1,somethingChanged:!1}}_diffProps(e,r){const n=Eqe(e,r);if(n.updateTriggersChanged)for(const i in n.updateTriggersChanged)n.updateTriggersChanged[i]&&this.invalidateAttribute(i);if(n.transitionsChanged)for(const i in n.transitionsChanged)this.internalState.uniformTransitions.add(i,r[i],e[i],e.transitions?.[i]);return this.setChangeFlags(n)}validateProps(){Sqe(this.props)}updateAutoHighlight(e){this.props.autoHighlight&&!Number.isInteger(this.props.highlightedObjectIndex)&&this._updateAutoHighlight(e)}_updateAutoHighlight(e){const r={highlightedObjectColor:e.picked?e.color:null},{highlightColor:n}=this.props;e.picked&&typeof n=="function"&&(r.highlightColor=n(e)),this.setShaderModuleProps({picking:r}),this.setNeedsRedraw()}_getAttributeManager(){const e=this.context;return new lre(e.device,{id:this.props.id,stats:e.stats,timeline:e.timeline})}_postUpdate(e,r){const{props:n,oldProps:i}=e,a=this.state.model;a?.isInstanced&&a.setInstanceCount(this.getNumInstances());const{autoHighlight:s,highlightedObjectIndex:o,highlightColor:u}=n;if(r||i.autoHighlight!==s||i.highlightedObjectIndex!==o||i.highlightColor!==u){const h={};Array.isArray(u)&&(h.highlightColor=u),(r||i.autoHighlight!==s||o!==i.highlightedObjectIndex)&&(h.highlightedObjectColor=Number.isFinite(o)&&o>=0?this.encodePickingColor(o):null),this.setShaderModuleProps({picking:h})}}_getUpdateParams(){return{props:this.props,oldProps:this.internalState.getOldProps(),context:this.context,changeFlags:this.internalState.changeFlags}}_getNeedsRedraw(e){if(!this.internalState)return!1;let r=!1;r=r||this.internalState.needsRedraw&&this.id;const n=this.getAttributeManager(),i=n?n.getNeedsRedraw(e):!1;if(r=r||i,r)for(const a of this.props.extensions)a.onNeedsRedraw.call(this,a);return this.internalState.needsRedraw=this.internalState.needsRedraw&&!e.clearRedrawFlags,r}_onAsyncPropUpdated(){this._diffProps(this.props,this.internalState.getOldProps()),this.setNeedsUpdate()}}oC.defaultProps=aHe;oC.layerName="Layer";const oHe="compositeLayer.renderLayers";class hre extends oC{get isComposite(){return!0}get isDrawable(){return!1}get isLoaded(){return super.isLoaded&&this.getSubLayers().every(e=>e.isLoaded)}getSubLayers(){return this.internalState&&this.internalState.subLayers||[]}initializeState(e){}setState(e){super.setState(e),this.setNeedsUpdate()}getPickingInfo({info:e}){const{object:r}=e;return r&&r.__source&&r.__source.parent&&r.__source.parent.id===this.id&&(e.object=r.__source.object,e.index=r.__source.index),e}filterSubLayer(e){return!0}shouldRenderSubLayer(e,r){return r&&r.length}getSubLayerClass(e,r){const{_subLayerProps:n}=this.props;return n&&n[e]&&n[e].type||r}getSubLayerRow(e,r,n){return e.__source={parent:this,object:r,index:n},e}getSubLayerAccessor(e){if(typeof e=="function"){const r={index:-1,data:this.props.data,target:[]};return(n,i)=>n&&n.__source?(r.index=n.__source.index,e(n.__source.object,r)):e(n,i)}return e}getSubLayerProps(e={}){const{opacity:r,pickable:n,visible:i,parameters:a,getPolygonOffset:s,highlightedObjectIndex:o,autoHighlight:u,highlightColor:h,coordinateSystem:f,coordinateOrigin:g,wrapLongitude:b,positionFormat:v,modelMatrix:S,extensions:E,fetch:P,operation:k,_subLayerProps:L}=this.props,O={id:"",updateTriggers:{},opacity:r,pickable:n,visible:i,parameters:a,getPolygonOffset:s,highlightedObjectIndex:o,autoHighlight:u,highlightColor:h,coordinateSystem:f,coordinateOrigin:g,wrapLongitude:b,positionFormat:v,modelMatrix:S,extensions:E,fetch:P,operation:k},M=L&&e.id&&L[e.id],z=M&&M.updateTriggers,B=e.id||"sublayer";if(M){const q=this.props[Xp],W=e.type?e.type._propTypes:{};for(const G in M){const ie=W[G]||q[G];ie&&ie.type==="accessor"&&(M[G]=this.getSubLayerAccessor(M[G]))}}Object.assign(O,e,M),O.id=`${this.props.id}-${B}`,O.updateTriggers={all:this.props.updateTriggers?.all,...e.updateTriggers,...z};for(const q of E){const W=q.getSubLayerProps.call(this,q);W&&Object.assign(O,W,{updateTriggers:Object.assign(O.updateTriggers,W.updateTriggers)})}return O}_updateAutoHighlight(e){for(const r of this.getSubLayers())r.updateAutoHighlight(e)}_getAttributeManager(){return null}_postUpdate(e,r){let n=this.internalState.subLayers;const i=!n||this.needsUpdate();if(i){const a=this.renderLayers();n=C0(a,Boolean),this.internalState.subLayers=n}Uu(oHe,this,i,n);for(const a of n)a.parent=this}}hre.layerName="CompositeLayer";const nw=Math.PI/180,$H=180/Math.PI,Bw=6370972,Fv=256;function sHe(){const t=Fv/Bw,e=Math.PI/180*Fv;return{unitsPerMeter:[t,t,t],unitsPerMeter2:[0,0,0],metersPerUnit:[1/t,1/t,1/t],unitsPerDegree:[e,e,t],unitsPerDegree2:[0,0,0],degreesPerUnit:[1/e,1/e,1/t]}}class lHe extends Qm{constructor(e={}){const{longitude:r=0,zoom:n=0,nearZMultiplier:i=.5,farZMultiplier:a=1,resolution:s=10}=e;let{latitude:o=0,height:u,altitude:h=1.5,fovy:f}=e;o=Math.max(Math.min(o,jp),-jp),u=u||1,f?h=YN(f):f=kb(h);const g=1/Math.PI/Math.cos(o*Math.PI/180),b=Math.pow(2,n)*g,v=e.nearZ??i,S=e.farZ??(h+Fv*2*b/u)*a,E=new hf().lookAt({eye:[0,-h,0],up:[0,0,1]});E.rotateX(o*nw),E.rotateZ(-r*nw),E.scale(b/u),super({...e,height:u,viewMatrix:E,longitude:r,latitude:o,zoom:n,distanceScales:sHe(),fovy:f,focalDistance:h,near:v,far:S}),this.scale=b,this.latitude=o,this.longitude=r,this.resolution=s}get projectionMode(){return Jc.GLOBE}getDistanceScales(){return this.distanceScales}getBounds(e={}){const r={targetZ:e.z||0},n=this.unproject([0,this.height/2],r),i=this.unproject([this.width/2,0],r),a=this.unproject([this.width,this.height/2],r),s=this.unproject([this.width/2,this.height],r);return a[0]<this.longitude&&(a[0]+=360),n[0]>this.longitude&&(n[0]-=360),[Math.min(n[0],a[0],i[0],s[0]),Math.min(n[1],a[1],i[1],s[1]),Math.max(n[0],a[0],i[0],s[0]),Math.max(n[1],a[1],i[1],s[1])]}unproject(e,{topLeft:r=!0,targetZ:n}={}){const[i,a,s]=e,o=r?a:this.height-a,{pixelUnprojectionMatrix:u}=this;let h;if(Number.isFinite(s))h=iP(u,[i,o,s,1]);else{const v=iP(u,[i,o,-1,1]),S=iP(u,[i,o,1,1]),E=((n||0)/Bw+1)*Fv,P=jI(Zee([],v,S)),k=jI(v),L=jI(S),M=4*((4*k*L-(P-k-L)**2)/16)/P,z=Math.sqrt(k-M),B=Math.sqrt(Math.max(0,E*E-M)),q=(z-B)/Math.sqrt(P);h=kze([],v,S,q)}const[f,g,b]=this.unprojectPosition(h);return Number.isFinite(s)?[f,g,b]:Number.isFinite(n)?[f,g,n]:[f,g]}projectPosition(e){const[r,n,i=0]=e,a=r*nw,s=n*nw,o=Math.cos(s),u=(i/Bw+1)*Fv;return[Math.sin(a)*o*u,-Math.cos(a)*o*u,Math.sin(s)*u]}unprojectPosition(e){const[r,n,i]=e,a=Fze(e),s=Math.asin(i/a),u=Math.atan2(r,-n)*$H,h=s*$H,f=(a/Fv-1)*Bw;return[u,h,f]}projectFlat(e){return e}unprojectFlat(e){return e}panByPosition(e,r){const n=this.unproject(r);return{longitude:e[0]-n[0]+this.longitude,latitude:e[1]-n[1]+this.latitude}}}function iP(t,e){const r=G0([],e,t);return Qee(r,r,1/r[3]),r}class uHe extends Lte{applyConstraints(e){const{maxZoom:r,minZoom:n,zoom:i}=e;e.zoom=Xf(i,n,r);const{longitude:a,latitude:s}=e;return(a<-180||a>180)&&(e.longitude=C7e(a+180,360)-180),e.latitude=Xf(s,-jp,jp),e}}class cHe extends Ote{constructor(){super(...arguments),this.ControllerState=uHe,this.transition={transitionDuration:300,transitionInterpolator:new eD(["longitude","latitude","zoom"])},this.dragMode="pan"}setProps(e){super.setProps(e),this.dragRotate=!1,this.touchRotate=!1}}class fre extends Rte{constructor(e={}){super(e)}getViewportType(e){return e.zoom>12?Om:lHe}get ControllerType(){return cHe}}fre.displayName="GlobeView";const aP=512,hHe=Math.PI/180;function dre({map:t,gl:e,deck:r}){if(t.__deck)return t.__deck;const n=r?.props._customRender,i=r?.props.onLoad,a={...r?.props,_customRender:()=>{t.triggerRepaint(),n?.("")}};a.parameters={...gR(t,!0),...a.parameters},a.views||(a.views=TE(t));let s;return(!r||r.props.gl===e)&&(Object.assign(a,{gl:e,width:null,height:null,touchAction:"unset",viewState:Ob(t)}),r?.isInitialized?qH(r,t):a.onLoad=()=>{i?.(),qH(s,t)}),r?(s=r,r.setProps(a),r.userData.isExternal=!0):(s=new Rb(a),t.on("remove",()=>{pre(t)})),s.userData.mapboxLayers=new Set,t.__deck=s,t.on("render",()=>{s.isInitialized&&yHe(s,t)}),s}function qH(t,e){const r=()=>{t.isInitialized?vHe(t,e):e.off("move",r)};e.on("move",r)}function pre(t){t.__deck?.finalize(),t.__deck=null}function gR(t,e){const r=e?{depthWriteEnabled:!0,depthCompare:"less-equal",depthBias:0,blend:!0,blendColorSrcFactor:"src-alpha",blendColorDstFactor:"one-minus-src-alpha",blendAlphaSrcFactor:"one",blendAlphaDstFactor:"one-minus-src-alpha",blendColorOperation:"add",blendAlphaOperation:"add"}:{};return gre(t)==="globe"&&(r.cullMode="back"),r}function fHe(t,e){t.userData.mapboxLayers.add(e),lD(t)}function dHe(t,e){t.userData.mapboxLayers.delete(e),lD(t)}function pHe(t,e){lD(t)}function gHe(t,e,r,n){let{currentViewport:i}=t.userData,a=!1;i||(i=mre(t,e,n),t.userData.currentViewport=i,a=!0),t.isInitialized&&t._drawLayers("mapbox-repaint",{viewports:[i],layerFilter:s=>(!t.props.layerFilter||t.props.layerFilter(s))&&(r.id===s.layer.id||s.layer.props.operation.includes("terrain")),clearStack:a,clearCanvas:!1})}function gre(t){const e=t.getProjection?.(),r=e?.type||e?.name;if(r==="globe")return"globe";if(r&&r!=="mercator")throw new Error("Unsupported projection");return"mercator"}function TE(t){return gre(t)==="globe"?new fre({id:"mapbox"}):new tD({id:"mapbox"})}function Ob(t){const{lng:e,lat:r}=t.getCenter(),n={longitude:(e+540)%360-180,latitude:r,zoom:t.getZoom(),bearing:t.getBearing(),pitch:t.getPitch(),padding:t.getPadding(),repeat:t.getRenderWorldCopies()};return t.getTerrain?.()&&mHe(t,n),n}function mHe(t,e){if(t.getFreeCameraOptions){const{position:r}=t.getFreeCameraOptions();if(!r||r.z===void 0)return;const n=t.transform.height,{longitude:i,latitude:a,pitch:s}=e,o=r.x*aP,u=(1-r.y)*aP,h=r.z*aP,f=Pb([i,a]),g=o-f[0],b=u-f[1],v=Math.sqrt(g*g+b*b),S=s*hHe,E=1.5*n,P=S<.001?E*Math.cos(S)/h:E*Math.sin(S)/v;e.zoom=Math.log2(P);const k=E*Math.cos(S)/P,L=h-k;e.position=[0,0,L/Dw(a)]}else typeof t.transform.elevation=="number"&&(e.position=[0,0,t.transform.elevation])}function mre(t,e,r){const n=Ob(e),i=TE(e);r&&(i.props.nearZMultiplier=.2);const a=r?.nearZ??e.transform._nearZ,s=r?.farZ??e.transform._farZ;return Number.isFinite(a)&&(n.nearZ=a/e.transform.height,n.farZ=s/e.transform.height),i.makeViewport({width:t.width,height:t.height,viewState:n})}function yHe(t,e){const{mapboxLayers:r,isExternal:n}=t.userData;if(n){const i=Array.from(r,f=>f.id),s=C0(t.props.layers,Boolean).some(f=>f&&!i.includes(f.id));let o=t.getViewports();const u=o.findIndex(f=>f.id==="mapbox"),h=o.length>1||u<0;(s||h)&&(u>=0&&(o=o.slice(),o[u]=mre(t,e)),t._drawLayers("mapbox-repaint",{viewports:o,layerFilter:f=>(!t.props.layerFilter||t.props.layerFilter(f))&&(f.viewport.id!=="mapbox"||!i.includes(f.layer.id)),clearCanvas:!1}))}t.userData.currentViewport=null}function vHe(t,e){t.setProps({viewState:Ob(e)}),t.needsRedraw({clearRedrawFlags:!0})}function lD(t){if(t.userData.isExternal)return;const e=[];t.userData.mapboxLayers.forEach(r=>{const n=r.props.type,i=new n(r.props);e.push(i)}),t.setProps({layers:e})}class _He{constructor(e){if(!e.id)throw new Error("Layer must have an unique id");this.id=e.id,this.type="custom",this.renderingMode=e.renderingMode||"3d",this.slot=e.slot,this.map=null,this.deck=null,this.props=e}onAdd(e,r){this.map=e,this.deck=dre({map:e,gl:r,deck:this.props.deck}),fHe(this.deck,this)}onRemove(){this.deck&&dHe(this.deck,this)}setProps(e){Object.assign(this.props,e,{id:this.id}),this.deck&&pHe(this.deck)}render(e,r){gHe(this.deck,this.map,this,r)}}const oP="__UNDEFINED__";function iw(t,e,r,n){if(!t||!e||!t.style||!t.style._loaded)return;const i=C0(n,Boolean);if(r!==n){const o=C0(r,Boolean),u=new Set(o.map(h=>h.id));for(const h of i)u.delete(h.id);for(const h of u)t.getLayer(h)&&t.removeLayer(h)}for(const o of i){const u=t.getLayer(o.id);u?(u.implementation||u).setProps(o.props):t.addLayer(new _He({id:o.id,deck:e,slot:o.props.slot}),o.props.beforeId)}const a=t.style._order,s={};for(const o of i){let{beforeId:u}=o.props;(!u||!a.includes(u))&&(u=oP),s[u]=s[u]||[],s[u].push(o.id)}for(const o in s){const u=s[o];let h=o===oP?a.length:a.indexOf(o),f=o===oP?void 0:o;for(let g=u.length-1;g>=0;g--){const b=u[g],v=a.indexOf(b);v!==h-1&&(t.moveLayer(b,f),v>h&&h++),h--,f=b}}}class bHe{constructor(e){this._handleStyleChange=()=>{iw(this._map,this._deck,this._props.layers,this._props.layers)},this._updateContainerSize=()=>{if(this._map&&this._container){const{clientWidth:i,clientHeight:a}=this._map.getContainer();Object.assign(this._container.style,{width:`${i}px`,height:`${a}px`})}},this._updateViewState=()=>{const i=this._deck,a=this._map;i&&a&&(i.setProps({views:this._props.views||TE(a),viewState:Ob(a)}),i.isInitialized&&i.redraw())},this._handleMouseEvent=i=>{const a=this._deck;if(!a||!a.isInitialized)return;const s={type:i.type,offsetCenter:i.point,srcEvent:i},o=this._lastMouseDownPoint;switch(!i.point&&o&&(s.deltaX=i.originalEvent.clientX-o.clientX,s.deltaY=i.originalEvent.clientY-o.clientY,s.offsetCenter={x:o.x+s.deltaX,y:o.y+s.deltaY}),s.type){case"mousedown":a._onPointerDown(s),this._lastMouseDownPoint={...i.point,clientX:i.originalEvent.clientX,clientY:i.originalEvent.clientY};break;case"dragstart":s.type="panstart",a._onEvent(s);break;case"drag":s.type="panmove",a._onEvent(s);break;case"dragend":s.type="panend",a._onEvent(s);break;case"click":s.tapCount=1,a._onEvent(s);break;case"dblclick":s.type="click",s.tapCount=2,a._onEvent(s);break;case"mousemove":s.type="pointermove",a._onPointerMove(s);break;case"mouseout":s.type="pointerleave",a._onPointerMove(s);break;default:return}};const{interleaved:r=!1,...n}=e;this._interleaved=r,this._props=n}setProps(e){this._interleaved&&e.layers&&iw(this._map,this._deck,this._props.layers,e.layers),Object.assign(this._props,e),this._deck&&this._map&&this._deck.setProps({...this._props,parameters:{...gR(this._map,this._interleaved),...this._props.parameters}})}onAdd(e){return this._map=e,this._interleaved?this._onAddInterleaved(e):this._onAddOverlaid(e)}_onAddOverlaid(e){const r=document.createElement("div");return Object.assign(r.style,{position:"absolute",left:0,top:0,textAlign:"initial",pointerEvents:"none"}),this._container=r,this._deck=new Rb({...this._props,parent:r,parameters:{...gR(e,!1),...this._props.parameters},views:this._props.views||TE(e),viewState:Ob(e)}),e.on("resize",this._updateContainerSize),e.on("render",this._updateViewState),e.on("mousedown",this._handleMouseEvent),e.on("dragstart",this._handleMouseEvent),e.on("drag",this._handleMouseEvent),e.on("dragend",this._handleMouseEvent),e.on("mousemove",this._handleMouseEvent),e.on("mouseout",this._handleMouseEvent),e.on("click",this._handleMouseEvent),e.on("dblclick",this._handleMouseEvent),this._updateContainerSize(),r}_onAddInterleaved(e){const r=e.painter.context.gl;return r instanceof WebGLRenderingContext&&Za.warn("Incompatible basemap library. See: https://deck.gl/docs/api-reference/mapbox/overview#compatibility")(),this._deck=dre({map:e,gl:r,deck:new Rb({...this._props,gl:r})}),e.on("styledata",this._handleStyleChange),iw(e,this._deck,[],this._props.layers),document.createElement("div")}onRemove(){const e=this._map;e&&(this._interleaved?this._onRemoveInterleaved(e):this._onRemoveOverlaid(e)),this._deck=void 0,this._map=void 0,this._container=void 0}_onRemoveOverlaid(e){e.off("resize",this._updateContainerSize),e.off("render",this._updateViewState),e.off("mousedown",this._handleMouseEvent),e.off("dragstart",this._handleMouseEvent),e.off("drag",this._handleMouseEvent),e.off("dragend",this._handleMouseEvent),e.off("mousemove",this._handleMouseEvent),e.off("mouseout",this._handleMouseEvent),e.off("click",this._handleMouseEvent),e.off("dblclick",this._handleMouseEvent),this._deck?.finalize()}_onRemoveInterleaved(e){e.off("styledata",this._handleStyleChange),iw(e,this._deck,this._props.layers,[]),pre(e)}getDefaultPosition(){return"top-left"}pickObject(e){return Rl(this._deck),this._deck.pickObject(e)}pickMultipleObjects(e){return Rl(this._deck),this._deck.pickMultipleObjects(e)}pickObjects(e){return Rl(this._deck),this._deck.pickObjects(e)}finalize(){this._map&&this._map.removeControl(this)}getCanvas(){return this._map?this._interleaved?this._map.getCanvas():this._deck.getCanvas():null}}const xHe="deckgl-layer",yre=ht.createContext({}),mR=({mapId:t,children:e})=>{const r=ha({mapId:t}),n=ee.useRef(void 0),[i,a]=ee.useState([]);ee.useEffect(()=>{if(r.map)return n.current=new bHe({id:xHe}),r.map.addControl(n.current),()=>{n.current&&r.map?.removeControl(n.current),n.current=void 0}},[r.map]),ee.useEffect(()=>{n.current&&n.current.setProps({layers:[...i]})},[i]);const s={deckGlLayerArray:i,setDeckGlLayerArray:a};return K.jsx(yre.Provider,{value:s,children:e})};try{mR.displayName="DeckGlContextProvider",mR.__docgenInfo={description:"",displayName:"DeckGlContextProvider",props:{mapId:{defaultValue:null,description:"",name:"mapId",required:!0,type:{name:"string"}}}}}catch{}function wHe(){const t=ee.useContext(yre),e=t.deckGlLayerArray;function r(i){const a=[...e];a.push(i),t.setDeckGlLayerArray(a)}function n(i){const a=e.filter(s=>s!==i);t.setDeckGlLayerArray(a)}return{addLayer:r,removeLayer:n,layerArray:e}}function SHe({pointCount:t,getBinId:e}){const r=new Map;for(let n=0;n<t;n++){const i=e(n);if(i===null)continue;let a=r.get(String(i));a?a.points.push(n):(a={id:i,index:r.size,points:[n]},r.set(String(i),a))}return Array.from(r.values())}function EHe({bins:t,dimensions:e,target:r}){const n=t.length*e;(!r||r.length<n)&&(r=new Float32Array(n));for(let i=0;i<t.length;i++){const{id:a}=t[i];Array.isArray(a)?r.set(a,i*e):r[i]=a}return r}const THe=t=>t.length,vre=(t,e)=>{let r=0;for(const n of t)r+=e(n);return r},CHe=(t,e)=>t.length===0?NaN:vre(t,e)/t.length,AHe=(t,e)=>{let r=1/0;for(const n of t){const i=e(n);i<r&&(r=i)}return r},IHe=(t,e)=>{let r=-1/0;for(const n of t){const i=e(n);i>r&&(r=i)}return r},PHe={COUNT:THe,SUM:vre,MEAN:CHe,MIN:AHe,MAX:IHe};function kHe({bins:t,getValue:e,operation:r,target:n}){(!n||n.length<t.length)&&(n=new Float32Array(t.length));let i=1/0,a=-1/0;for(let s=0;s<t.length;s++){const{points:o}=t[s];n[s]=r(o,e),n[s]<i&&(i=n[s]),n[s]>a&&(a=n[s])}return{value:n,domain:[i,a]}}function HH(t,e,r){const n={};for(const a of t.sources||[]){const s=e[a];if(s)n[a]=MHe(s);else throw new Error(`Cannot find attribute ${a}`)}const i={};return a=>{for(const s in n)i[s]=n[s](a);return t.getValue(i,a,r)}}function MHe(t){const e=t.value,{offset:r=0,stride:n,size:i}=t.getAccessor(),a=e.BYTES_PER_ELEMENT,s=r/a,o=n?n/a:i;if(i===1)return t.isConstant?()=>e[0]:h=>{const f=s+o*h;return e[f]};let u;return t.isConstant?(u=Array.from(e),()=>u):(u=new Array(i),h=>{const f=s+o*h;for(let g=0;g<i;g++)u[g]=e[f+g];return u})}class RHe{constructor(e){this.bins=[],this.binIds=null,this.results=[],this.dimensions=e.dimensions,this.channelCount=e.getValue.length,this.props={...e,binOptions:{},pointCount:0,operations:[],customOperations:[],attributes:{}},this.needsUpdate=!0,this.setProps(e)}destroy(){}get binCount(){return this.bins.length}setProps(e){const r=this.props;if(e.binOptions&&(vc(e.binOptions,r.binOptions,2)||this.setNeedsUpdate()),e.operations)for(let n=0;n<this.channelCount;n++)e.operations[n]!==r.operations[n]&&this.setNeedsUpdate(n);if(e.customOperations)for(let n=0;n<this.channelCount;n++)!!e.customOperations[n]!=!!r.customOperations[n]&&this.setNeedsUpdate(n);e.pointCount!==void 0&&e.pointCount!==r.pointCount&&this.setNeedsUpdate(),e.attributes&&(e.attributes={...r.attributes,...e.attributes}),Object.assign(this.props,e)}setNeedsUpdate(e){e===void 0?this.needsUpdate=!0:this.needsUpdate!==!0&&(this.needsUpdate=this.needsUpdate||[],this.needsUpdate[e]=!0)}update(){if(this.needsUpdate===!0){this.bins=SHe({pointCount:this.props.pointCount,getBinId:HH(this.props.getBin,this.props.attributes,this.props.binOptions)});const e=EHe({bins:this.bins,dimensions:this.dimensions,target:this.binIds?.value});this.binIds={value:e,type:"float32",size:this.dimensions}}for(let e=0;e<this.channelCount;e++)if(this.needsUpdate===!0||this.needsUpdate[e]){const r=this.props.customOperations[e]||PHe[this.props.operations[e]],{value:n,domain:i}=kHe({bins:this.bins,getValue:HH(this.props.getValue[e],this.props.attributes,void 0),operation:r,target:this.results[e]?.value});this.results[e]={value:n,domain:i,type:"float32",size:1},this.props.onUpdate?.({channel:e})}this.needsUpdate=!1}preDraw(){}getBins(){return this.binIds}getResult(e){return this.results[e]}getResultDomain(e){return this.results[e]?.domain??[1/0,-1/0]}getBin(e){const r=this.bins[e];if(!r)return null;const n=new Array(this.channelCount);for(let i=0;i<n.length;i++){const a=this.results[i];n[i]=a?.value[e]}return{id:r.id,value:n,count:r.points.length,pointIndices:r.points}}}function _re(t,e,r){return t.createFramebuffer({width:e,height:r,colorAttachments:[t.createTexture({width:e,height:r,format:"rgba32float",mipmaps:!1,sampler:{minFilter:"nearest",magFilter:"nearest"}})]})}const OHe=`uniform binSorterUniforms {
  ivec4 binIdRange;
  ivec2 targetSize;
} binSorter;
`,LHe={name:"binSorter",vs:OHe,uniformTypes:{binIdRange:"vec4<i32>",targetSize:"vec2<i32>"}},bre=[1,2,4,8],WH=3e38,NHe={SUM:0,MEAN:0,MIN:0,MAX:0,COUNT:0},zw=1024;class DHe{constructor(e,r){this.binsFBO=null,this.device=e,this.model=BHe(e,r)}get texture(){return this.binsFBO?this.binsFBO.colorAttachments[0].texture:null}destroy(){this.model.destroy(),this.binsFBO?.colorAttachments[0].texture.destroy(),this.binsFBO?.destroy()}getBinValues(e){if(!this.binsFBO)return null;const r=e%zw,n=Math.floor(e/zw),i=this.device.readPixelsToArrayWebGL(this.binsFBO,{sourceX:r,sourceY:n,sourceWidth:1,sourceHeight:1}).buffer;return new Float32Array(i)}setDimensions(e,r){const n=zw,i=Math.ceil(e/n);this.binsFBO?this.binsFBO.height<i&&this.binsFBO.resize({width:n,height:i}):this.binsFBO=_re(this.device,n,i);const a={binIdRange:[r[0][0],r[0][1],r[1]?.[0]||0,r[1]?.[1]||0],targetSize:[this.binsFBO.width,this.binsFBO.height]};this.model.shaderInputs.setProps({binSorter:a})}setModelProps(e){const r=this.model;e.attributes&&r.setAttributes(e.attributes),e.constantAttributes&&r.setConstantAttributes(e.constantAttributes),e.vertexCount!==void 0&&r.setVertexCount(e.vertexCount),e.shaderModuleProps&&r.shaderInputs.setProps(e.shaderModuleProps)}update(e){if(!this.binsFBO)return;const r=FHe(e);this._updateBins("SUM",r.SUM+r.MEAN),this._updateBins("MIN",r.MIN),this._updateBins("MAX",r.MAX)}_updateBins(e,r){if(r===0)return;r|=bre[3];const n=this.model,i=this.binsFBO,a=e==="MAX"?-WH:e==="MIN"?WH:0,s=this.device.beginRenderPass({id:`gpu-aggregation-${e}`,framebuffer:i,parameters:{viewport:[0,0,i.width,i.height],colorMask:r},clearColor:[a,a,a,0],clearDepth:!1,clearStencil:!1});n.setParameters({blend:!0,blendColorSrcFactor:"one",blendColorDstFactor:"one",blendAlphaSrcFactor:"one",blendAlphaDstFactor:"one",blendColorOperation:e==="MAX"?"max":e==="MIN"?"min":"add",blendAlphaOperation:"add"}),n.draw(s),s.end()}}function FHe(t){const e={...NHe};for(let r=0;r<t.length;r++){const n=t[r];n&&(e[n]+=bre[r])}return e}function BHe(t,e){let r=e.vs;e.dimensions===2&&(r+=`
void getBin(out int binId) {
  ivec2 binId2;
  getBin(binId2);
  if (binId2.x < binSorter.binIdRange.x || binId2.x >= binSorter.binIdRange.y) {
    binId = -1;
  } else {
    binId = (binId2.y - binSorter.binIdRange.z) * (binSorter.binIdRange.y - binSorter.binIdRange.x) + binId2.x;
  }
}
`);const n=`#version 300 es
#define SHADER_NAME gpu-aggregation-sort-bins-vertex

${r}

out vec3 v_Value;

void main() {
  int binIndex;
  getBin(binIndex);
  binIndex = binIndex - binSorter.binIdRange.x;
  if (binIndex < 0) {
    gl_Position = vec4(0.);
    return;
  }
  int row = binIndex / binSorter.targetSize.x;
  int col = binIndex - row * binSorter.targetSize.x;
  vec2 position = (vec2(col, row) + 0.5) / vec2(binSorter.targetSize) * 2.0 - 1.0;
  gl_Position = vec4(position, 0.0, 1.0);
  gl_PointSize = 1.0;

#if NUM_CHANNELS == 3
  getValue(v_Value);
#elif NUM_CHANNELS == 2
  getValue(v_Value.xy);
#else
  getValue(v_Value.x);
#endif
}
`,i=`#version 300 es
#define SHADER_NAME gpu-aggregation-sort-bins-fragment

precision highp float;

in vec3 v_Value;
out vec4 fragColor;

void main() {
  fragColor.xyz = v_Value;

  #ifdef MODULE_GEOMETRY
  geometry.uv = vec2(0.);
  DECKGL_FILTER_COLOR(fragColor, geometry);
  #endif

  fragColor.w = 1.0;
}
`;return new Lm(t,{bufferLayout:e.bufferLayout,modules:[...e.modules||[],LHe],defines:{...e.defines,NON_INSTANCED_MODEL:1,NUM_CHANNELS:e.channelCount},isInstanced:!1,vs:n,fs:i,topology:"point-list",disableWarnings:!0})}const zHe=`uniform aggregatorTransformUniforms {
  ivec4 binIdRange;
  bvec3 isCount;
  bvec3 isMean;
  float naN;
} aggregatorTransform;
`,jHe={name:"aggregatorTransform",vs:zHe,uniformTypes:{binIdRange:"vec4<i32>",isCount:"vec3<f32>",isMean:"vec3<f32>"}};class UHe{constructor(e,r){this.binBuffer=null,this.valueBuffer=null,this._domains=null,this.device=e,this.channelCount=r.channelCount,this.transform=VHe(e,r),this.domainFBO=_re(e,2,1)}destroy(){this.transform.destroy(),this.binBuffer?.destroy(),this.valueBuffer?.destroy(),this.domainFBO.colorAttachments[0].texture.destroy(),this.domainFBO.destroy()}get domains(){if(!this._domains){const e=this.device.readPixelsToArrayWebGL(this.domainFBO).buffer,r=new Float32Array(e);this._domains=[[-r[4],r[0]],[-r[5],r[1]],[-r[6],r[2]]].slice(0,this.channelCount)}return this._domains}setDimensions(e,r){const{model:n,transformFeedback:i}=this.transform;n.setVertexCount(e);const a={binIdRange:[r[0][0],r[0][1],r[1]?.[0]||0,r[1]?.[1]||0]};n.shaderInputs.setProps({aggregatorTransform:a});const s=e*r.length*4;(!this.binBuffer||this.binBuffer.byteLength<s)&&(this.binBuffer?.destroy(),this.binBuffer=this.device.createBuffer({byteLength:s}),i.setBuffer("binIds",this.binBuffer));const o=e*this.channelCount*4;(!this.valueBuffer||this.valueBuffer.byteLength<o)&&(this.valueBuffer?.destroy(),this.valueBuffer=this.device.createBuffer({byteLength:o}),i.setBuffer("values",this.valueBuffer))}update(e,r){if(!e)return;const n=this.transform,i=this.domainFBO,a=[0,1,2].map(u=>r[u]==="COUNT"?1:0),s=[0,1,2].map(u=>r[u]==="MEAN"?1:0),o={isCount:a,isMean:s,bins:e};n.model.shaderInputs.setProps({aggregatorTransform:o}),n.run({id:"gpu-aggregation-domain",framebuffer:i,parameters:{viewport:[0,0,2,1]},clearColor:[-3e38,-3e38,-3e38,0],clearDepth:!1,clearStencil:!1}),this._domains=null}}function VHe(t,e){const r=`#version 300 es
#define SHADER_NAME gpu-aggregation-domain-vertex

uniform sampler2D bins;

#if NUM_DIMS == 1
out float binIds;
#else
out vec2 binIds;
#endif

#if NUM_CHANNELS == 1
flat out float values;
#elif NUM_CHANNELS == 2
flat out vec2 values;
#else
flat out vec3 values;
#endif

const float NAN = intBitsToFloat(-1);

void main() {
  int row = gl_VertexID / SAMPLER_WIDTH;
  int col = gl_VertexID - row * SAMPLER_WIDTH;
  vec4 weights = texelFetch(bins, ivec2(col, row), 0);
  vec3 value3 = mix(
    mix(weights.rgb, vec3(weights.a), aggregatorTransform.isCount),
    weights.rgb / max(weights.a, 1.0),
    aggregatorTransform.isMean
  );
  if (weights.a == 0.0) {
    value3 = vec3(NAN);
  }

#if NUM_DIMS == 1
  binIds = float(gl_VertexID + aggregatorTransform.binIdRange.x);
#else
  int y = gl_VertexID / (aggregatorTransform.binIdRange.y - aggregatorTransform.binIdRange.x);
  int x = gl_VertexID - y * (aggregatorTransform.binIdRange.y - aggregatorTransform.binIdRange.x);
  binIds.y = float(y + aggregatorTransform.binIdRange.z);
  binIds.x = float(x + aggregatorTransform.binIdRange.x);
#endif

#if NUM_CHANNELS == 3
  values = value3;
#elif NUM_CHANNELS == 2
  values = value3.xy;
#else
  values = value3.x;
#endif

  gl_Position = vec4(0., 0., 0., 1.);
  // This model renders into a 2x1 texture to obtain min and max simultaneously.
  // See comments in fragment shader
  gl_PointSize = 2.0;
}
`,n=`#version 300 es
#define SHADER_NAME gpu-aggregation-domain-fragment

precision highp float;

#if NUM_CHANNELS == 1
flat in float values;
#elif NUM_CHANNELS == 2
flat in vec2 values;
#else
flat in vec3 values;
#endif

out vec4 fragColor;

void main() {
  vec3 value3;
#if NUM_CHANNELS == 3
  value3 = values;
#elif NUM_CHANNELS == 2
  value3.xy = values;
#else
  value3.x = values;
#endif
  if (isnan(value3.x)) discard;
  // This shader renders into a 2x1 texture with blending=max
  // The left pixel yields the max value of each channel
  // The right pixel yields the min value of each channel
  if (gl_FragCoord.x < 1.0) {
    fragColor = vec4(value3, 1.0);
  } else {
    fragColor = vec4(-value3, 1.0);
  }
}
`;return new Nm(t,{vs:r,fs:n,topology:"point-list",modules:[jHe],parameters:{blend:!0,blendColorSrcFactor:"one",blendColorDstFactor:"one",blendColorOperation:"max",blendAlphaSrcFactor:"one",blendAlphaDstFactor:"one",blendAlphaOperation:"max"},defines:{NUM_DIMS:e.dimensions,NUM_CHANNELS:e.channelCount,SAMPLER_WIDTH:zw},varyings:["binIds","values"],disableWarnings:!0})}class GH{static isSupported(e){return e.features.has("float32-renderable-webgl")&&e.features.has("texture-blend-float-webgl")}constructor(e,r){this.binCount=0,this.binIds=null,this.results=[],this.device=e,this.dimensions=r.dimensions,this.channelCount=r.channelCount,this.props={...r,pointCount:0,binIdRange:[[0,0]],operations:[],attributes:{},binOptions:{}},this.needsUpdate=new Array(this.channelCount).fill(!0),this.binSorter=new DHe(e,r),this.aggregationTransform=new UHe(e,r),this.setProps(r)}getBins(){const e=this.aggregationTransform.binBuffer;return e?(this.binIds?.buffer!==e&&(this.binIds={buffer:e,type:"float32",size:this.dimensions}),this.binIds):null}getResult(e){const r=this.aggregationTransform.valueBuffer;return!r||e>=this.channelCount?null:(this.results[e]?.buffer!==r&&(this.results[e]={buffer:r,type:"float32",size:1,stride:this.channelCount*4,offset:e*4}),this.results[e])}getResultDomain(e){return this.aggregationTransform.domains[e]}getBin(e){if(e<0||e>=this.binCount)return null;const{binIdRange:r}=this.props;let n;if(this.dimensions===1)n=[e+r[0][0]];else{const[[o,u],[h]]=r,f=u-o;n=[e%f+o,Math.floor(e/f)+h]}const i=this.binSorter.getBinValues(e);if(!i)return null;const a=i[3],s=[];for(let o=0;o<this.channelCount;o++){const u=this.props.operations[o];u==="COUNT"?s[o]=a:a===0?s[o]=NaN:s[o]=u==="MEAN"?i[o]/a:i[o]}return{id:n,value:s,count:a}}destroy(){this.binSorter.destroy(),this.aggregationTransform.destroy()}setProps(e){const r=this.props;if("binIdRange"in e&&!vc(e.binIdRange,r.binIdRange,2)){const n=e.binIdRange;if(Za.assert(n.length===this.dimensions),this.dimensions===1){const[[i,a]]=n;this.binCount=a-i}else{const[[i,a],[s,o]]=n;this.binCount=(a-i)*(o-s)}this.binSorter.setDimensions(this.binCount,n),this.aggregationTransform.setDimensions(this.binCount,n),this.setNeedsUpdate()}if(e.operations)for(let n=0;n<this.channelCount;n++)e.operations[n]!==r.operations[n]&&this.setNeedsUpdate(n);if(e.pointCount!==void 0&&e.pointCount!==r.pointCount&&(this.binSorter.setModelProps({vertexCount:e.pointCount}),this.setNeedsUpdate()),e.binOptions&&(vc(e.binOptions,r.binOptions,2)||this.setNeedsUpdate(),this.binSorter.model.shaderInputs.setProps({binOptions:e.binOptions})),e.attributes){const n={},i={};for(const a of Object.values(e.attributes))for(const[s,o]of Object.entries(a.getValue()))ArrayBuffer.isView(o)?i[s]=o:o&&(n[s]=o);this.binSorter.setModelProps({attributes:n,constantAttributes:i})}e.shaderModuleProps&&this.binSorter.setModelProps({shaderModuleProps:e.shaderModuleProps}),Object.assign(this.props,e)}setNeedsUpdate(e){e===void 0?this.needsUpdate.fill(!0):this.needsUpdate[e]=!0}update(){}preDraw(){if(!this.needsUpdate.some(Boolean))return;const{operations:e}=this.props,r=this.needsUpdate.map((n,i)=>n?e[i]:null);this.binSorter.update(r),this.aggregationTransform.update(this.binSorter.texture,e);for(let n=0;n<this.channelCount;n++)this.needsUpdate[n]&&(this.needsUpdate[n]=!1,this.props.onUpdate?.({channel:n}))}}class xre extends hre{get isDrawable(){return!0}initializeState(){this.getAttributeManager().remove(["instancePickingColors"])}updateState(e){super.updateState(e);const r=this.getAggregatorType();if(e.changeFlags.extensionsChanged||this.state.aggregatorType!==r){this.state.aggregator?.destroy();const n=this.createAggregator(r);return n.setProps({attributes:this.getAttributeManager()?.attributes}),this.setState({aggregator:n,aggregatorType:r}),!0}return!1}finalizeState(e){super.finalizeState(e),this.state.aggregator.destroy()}updateAttributes(e){const{aggregator:r}=this.state;r.setProps({attributes:e});for(const n in e)this.onAttributeChange(n);r.update()}draw({shaderModuleProps:e}){const{aggregator:r}=this.state;r.setProps({shaderModuleProps:e}),r.preDraw()}_getAttributeManager(){return new lre(this.context.device,{id:this.props.id,stats:this.context.stats})}}xre.layerName="AggregationLayer";const $He=[[255,255,178],[254,217,118],[254,178,76],[253,141,60],[240,59,32],[189,0,38]];function qHe(t,e=!1,r=Float32Array){let n;if(Number.isFinite(t[0]))n=new r(t);else{n=new r(t.length*4);let i=0;for(let a=0;a<t.length;a++){const s=t[a];n[i++]=s[0],n[i++]=s[1],n[i++]=s[2],n[i++]=Number.isFinite(s[3])?s[3]:255}}if(e)for(let i=0;i<n.length;i++)n[i]/=255;return n}const CE={linear:"linear",quantile:"nearest",quantize:"nearest",ordinal:"nearest"};function HHe(t,e){t.setSampler({minFilter:CE[e],magFilter:CE[e]})}function WHe(t,e,r="linear"){const n=qHe(e,!1,Uint8Array);return t.createTexture({format:"rgba8unorm",mipmaps:!1,sampler:{minFilter:CE[r],magFilter:CE[r],addressModeU:"clamp-to-edge",addressModeV:"clamp-to-edge"},data:n,width:n.length/4,height:1})}class XH{constructor(e,r){this.props={scaleType:"linear",lowerPercentile:0,upperPercentile:100},this.domain=null,this.cutoff=null,this.input=e,this.inputLength=r,this.attribute=e}getScalePercentile(){if(!this._percentile){const e=YH(this.input,this.inputLength);this._percentile=XHe(e)}return this._percentile}getScaleOrdinal(){if(!this._ordinal){const e=YH(this.input,this.inputLength);this._ordinal=GHe(e)}return this._ordinal}getCutoff({scaleType:e,lowerPercentile:r,upperPercentile:n}){if(e==="quantile")return[r,n-1];if(r>0||n<100){const{domain:i}=this.getScalePercentile();let a=i[Math.floor(r)-1]??-1/0,s=i[Math.floor(n)-1]??1/0;if(e==="ordinal"){const{domain:o}=this.getScaleOrdinal();a=o.findIndex(u=>u>=a),s=o.findIndex(u=>u>s)-1,s===-2&&(s=o.length-1)}return[a,s]}return null}update(e){const r=this.props;if(e.scaleType!==r.scaleType)switch(e.scaleType){case"quantile":{const{attribute:n}=this.getScalePercentile();this.attribute=n,this.domain=[0,99];break}case"ordinal":{const{attribute:n,domain:i}=this.getScaleOrdinal();this.attribute=n,this.domain=[0,i.length-1];break}default:this.attribute=this.input,this.domain=null}return(e.scaleType!==r.scaleType||e.lowerPercentile!==r.lowerPercentile||e.upperPercentile!==r.upperPercentile)&&(this.cutoff=this.getCutoff(e)),this.props=e,this}}function GHe(t){const e=new Set;for(const i of t)Number.isFinite(i)&&e.add(i);const r=Array.from(e).sort(),n=new Map;for(let i=0;i<r.length;i++)n.set(r[i],i);return{attribute:{value:t.map(i=>Number.isFinite(i)?n.get(i):NaN),type:"float32",size:1},domain:r}}function XHe(t,e=100){const r=Array.from(t).filter(Number.isFinite).sort(YHe);let n=0;const i=Math.max(1,e),a=new Array(i-1);for(;++n<i;)a[n-1]=ZHe(r,n/i);return{attribute:{value:t.map(s=>Number.isFinite(s)?KHe(a,s):NaN),type:"float32",size:1},domain:a}}function YH(t,e){const r=(t.stride??4)/4,n=(t.offset??0)/4;let i=t.value;if(!i){const s=t.buffer?.readSyncWebGL(0,r*4*e);s&&(i=new Float32Array(s.buffer),t.value=i)}if(r===1)return i.subarray(0,e);const a=new Float32Array(e);for(let s=0;s<e;s++)a[s]=i[s*r+n];return a}function YHe(t,e){return t-e}function ZHe(t,e){const r=t.length;if(e<=0||r<2)return t[0];if(e>=1)return t[r-1];const n=(r-1)*e,i=Math.floor(n),a=t[i],s=t[i+1];return a+(s-a)*(n-i)}function KHe(t,e){let r=0,n=t.length;for(;r<n;){const i=r+n>>>1;t[i]>e?n=i:r=i+1}return r}function JHe({dataBounds:t,getBinId:e,padding:r=0}){const n=[t[0],t[1],[t[0][0],t[1][1]],[t[1][0],t[0][1]]].map(u=>e(u)),i=Math.min(...n.map(u=>u[0]))-r,a=Math.min(...n.map(u=>u[1]))-r,s=Math.max(...n.map(u=>u[0]))+r+1,o=Math.max(...n.map(u=>u[1]))+r+1;return[[i,s],[a,o]]}const QHe={COUNTER_CLOCKWISE:-1};function eWe(t,e,r={}){return tWe(t,r)!==e?(nWe(t,r),!0):!1}function tWe(t,e={}){return Math.sign(rWe(t,e))}const ZH={x:0,y:1,z:2};function rWe(t,e={}){const{start:r=0,end:n=t.length,plane:i="xy"}=e,a=e.size||2;let s=0;const o=ZH[i[0]],u=ZH[i[1]];for(let h=r,f=n-a;h<n;h+=a)s+=(t[h+o]-t[f+o])*(t[h+u]+t[f+u]),f=h;return s/2}function nWe(t,e){const{start:r=0,end:n=t.length,size:i=2}=e,a=(n-r)/i,s=Math.floor(a/2);for(let o=0;o<s;++o){const u=r+o*i,h=r+(a-1-o)*i;for(let f=0;f<i;++f){const g=t[u+f];t[u+f]=t[h+f],t[h+f]=g}}}class iWe extends iUe{constructor(e){const{indices:r,attributes:n}=aWe(e);super({...e,indices:r,attributes:n})}}function aWe(t){const{radius:e,height:r=1,nradial:n=10}=t;let{vertices:i}=t;i&&(Za.assert(i.length>=n),i=i.flatMap(v=>[v[0],v[1]]),eWe(i,QHe.COUNTER_CLOCKWISE));const a=r>0,s=n+1,o=a?s*3+1:n,u=Math.PI*2/n,h=new Uint16Array(a?n*3*2:0),f=new Float32Array(o*3),g=new Float32Array(o*3);let b=0;if(a){for(let v=0;v<s;v++){const S=v*u,E=v%n,P=Math.sin(S),k=Math.cos(S);for(let L=0;L<2;L++)f[b+0]=i?i[E*2]:k*e,f[b+1]=i?i[E*2+1]:P*e,f[b+2]=(1/2-L)*r,g[b+0]=i?i[E*2]:k,g[b+1]=i?i[E*2+1]:P,b+=3}f[b+0]=f[b-3],f[b+1]=f[b-2],f[b+2]=f[b-1],b+=3}for(let v=a?0:1;v<s;v++){const S=Math.floor(v/2)*Math.sign(.5-v%2),E=S*u,P=(S+n)%n,k=Math.sin(E),L=Math.cos(E);f[b+0]=i?i[P*2]:L*e,f[b+1]=i?i[P*2+1]:k*e,f[b+2]=r/2,g[b+2]=1,b+=3}if(a){let v=0;for(let S=0;S<n;S++)h[v++]=S*2+0,h[v++]=S*2+2,h[v++]=S*2+0,h[v++]=S*2+1,h[v++]=S*2+1,h[v++]=S*2+3}return{indices:h,attributes:{POSITION:{size:3,value:f},NORMAL:{size:3,value:g}}}}const KH=`uniform columnUniforms {
  float radius;
  float angle;
  vec2 offset;
  bool extruded;
  bool stroked;
  bool isStroke;
  float coverage;
  float elevationScale;
  float edgeDistance;
  float widthScale;
  float widthMinPixels;
  float widthMaxPixels;
  highp int radiusUnits;
  highp int widthUnits;
} column;
`,oWe={name:"column",vs:KH,fs:KH,uniformTypes:{radius:"f32",angle:"f32",offset:"vec2<f32>",extruded:"f32",stroked:"f32",isStroke:"f32",coverage:"f32",elevationScale:"f32",edgeDistance:"f32",widthScale:"f32",widthMinPixels:"f32",widthMaxPixels:"f32",radiusUnits:"i32",widthUnits:"i32"}},sWe=`#version 300 es
#define SHADER_NAME column-layer-vertex-shader
in vec3 positions;
in vec3 normals;
in vec3 instancePositions;
in float instanceElevations;
in vec3 instancePositions64Low;
in vec4 instanceFillColors;
in vec4 instanceLineColors;
in float instanceStrokeWidths;
in vec3 instancePickingColors;
out vec4 vColor;
#ifdef FLAT_SHADING
out vec3 cameraPosition;
out vec4 position_commonspace;
#endif
void main(void) {
geometry.worldPosition = instancePositions;
vec4 color = column.isStroke ? instanceLineColors : instanceFillColors;
mat2 rotationMatrix = mat2(cos(column.angle), sin(column.angle), -sin(column.angle), cos(column.angle));
float elevation = 0.0;
float strokeOffsetRatio = 1.0;
if (column.extruded) {
elevation = instanceElevations * (positions.z + 1.0) / 2.0 * column.elevationScale;
} else if (column.stroked) {
float widthPixels = clamp(
project_size_to_pixel(instanceStrokeWidths * column.widthScale, column.widthUnits),
column.widthMinPixels, column.widthMaxPixels) / 2.0;
float halfOffset = project_pixel_size(widthPixels) / project_size(column.edgeDistance * column.coverage * column.radius);
if (column.isStroke) {
strokeOffsetRatio -= sign(positions.z) * halfOffset;
} else {
strokeOffsetRatio -= halfOffset;
}
}
float shouldRender = float(color.a > 0.0 && instanceElevations >= 0.0);
float dotRadius = column.radius * column.coverage * shouldRender;
geometry.pickingColor = instancePickingColors;
vec3 centroidPosition = vec3(instancePositions.xy, instancePositions.z + elevation);
vec3 centroidPosition64Low = instancePositions64Low;
vec2 offset = (rotationMatrix * positions.xy * strokeOffsetRatio + column.offset) * dotRadius;
if (column.radiusUnits == UNIT_METERS) {
offset = project_size(offset);
}
vec3 pos = vec3(offset, 0.);
DECKGL_FILTER_SIZE(pos, geometry);
gl_Position = project_position_to_clipspace(centroidPosition, centroidPosition64Low, pos, geometry.position);
geometry.normal = project_normal(vec3(rotationMatrix * normals.xy, normals.z));
DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
if (column.extruded && !column.isStroke) {
#ifdef FLAT_SHADING
cameraPosition = project.cameraPosition;
position_commonspace = geometry.position;
vColor = vec4(color.rgb, color.a * layer.opacity);
#else
vec3 lightColor = lighting_getLightColor(color.rgb, project.cameraPosition, geometry.position.xyz, geometry.normal);
vColor = vec4(lightColor, color.a * layer.opacity);
#endif
} else {
vColor = vec4(color.rgb, color.a * layer.opacity);
}
DECKGL_FILTER_COLOR(vColor, geometry);
}
`,lWe=`#version 300 es
#define SHADER_NAME column-layer-fragment-shader
precision highp float;
out vec4 fragColor;
in vec4 vColor;
#ifdef FLAT_SHADING
in vec3 cameraPosition;
in vec4 position_commonspace;
#endif
void main(void) {
fragColor = vColor;
geometry.uv = vec2(0.);
#ifdef FLAT_SHADING
if (column.extruded && !column.isStroke && !bool(picking.isActive)) {
vec3 normal = normalize(cross(dFdx(position_commonspace.xyz), dFdy(position_commonspace.xyz)));
fragColor.rgb = lighting_getLightColor(vColor.rgb, cameraPosition, position_commonspace.xyz, normal);
}
#endif
DECKGL_FILTER_COLOR(fragColor, geometry);
}
`,AE=[0,0,0,255],uWe={diskResolution:{type:"number",min:4,value:20},vertices:null,radius:{type:"number",min:0,value:1e3},angle:{type:"number",value:0},offset:{type:"array",value:[0,0]},coverage:{type:"number",min:0,max:1,value:1},elevationScale:{type:"number",min:0,value:1},radiusUnits:"meters",lineWidthUnits:"meters",lineWidthScale:1,lineWidthMinPixels:0,lineWidthMaxPixels:Number.MAX_SAFE_INTEGER,extruded:!0,wireframe:!1,filled:!0,stroked:!1,flatShading:!1,getPosition:{type:"accessor",value:t=>t.position},getFillColor:{type:"accessor",value:AE},getLineColor:{type:"accessor",value:AE},getLineWidth:{type:"accessor",value:1},getElevation:{type:"accessor",value:1e3},material:!0,getColor:{deprecatedFor:["getFillColor","getLineColor"]}};class uD extends oC{getShaders(){const e={},{flatShading:r}=this.props;return r&&(e.FLAT_SHADING=1),super.getShaders({vs:sWe,fs:lWe,defines:e,modules:[vte,r?ote:ate,s7e,oWe]})}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{size:3,type:"float64",fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceElevations:{size:1,transition:!0,accessor:"getElevation"},instanceFillColors:{size:this.props.colorFormat.length,type:"unorm8",transition:!0,accessor:"getFillColor",defaultValue:AE},instanceLineColors:{size:this.props.colorFormat.length,type:"unorm8",transition:!0,accessor:"getLineColor",defaultValue:AE},instanceStrokeWidths:{size:1,accessor:"getLineWidth",transition:!0}})}updateState(e){super.updateState(e);const{props:r,oldProps:n,changeFlags:i}=e,a=i.extensionsChanged||r.flatShading!==n.flatShading;a&&(this.state.models?.forEach(o=>o.destroy()),this.setState(this._getModels()),this.getAttributeManager().invalidateAll());const s=this.getNumInstances();this.state.fillModel.setInstanceCount(s),this.state.wireframeModel.setInstanceCount(s),(a||r.diskResolution!==n.diskResolution||r.vertices!==n.vertices||(r.extruded||r.stroked)!==(n.extruded||n.stroked))&&this._updateGeometry(r)}getGeometry(e,r,n){const i=new iWe({radius:1,height:n?2:0,vertices:r,nradial:e});let a=0;if(r)for(let s=0;s<e;s++){const o=r[s],u=Math.sqrt(o[0]*o[0]+o[1]*o[1]);a+=u/e}else a=1;return this.setState({edgeDistance:Math.cos(Math.PI/e)*a}),i}_getModels(){const e=this.getShaders(),r=this.getAttributeManager().getBufferLayouts(),n=new Lm(this.context.device,{...e,id:`${this.props.id}-fill`,bufferLayout:r,isInstanced:!0}),i=new Lm(this.context.device,{...e,id:`${this.props.id}-wireframe`,bufferLayout:r,isInstanced:!0});return{fillModel:n,wireframeModel:i,models:[i,n]}}_updateGeometry({diskResolution:e,vertices:r,extruded:n,stroked:i}){const a=this.getGeometry(e,r,n||i);this.setState({fillVertexCount:a.attributes.POSITION.value.length/3});const s=this.state.fillModel,o=this.state.wireframeModel;s.setGeometry(a),s.setTopology("triangle-strip"),s.setIndexBuffer(null),o.setGeometry(a),o.setTopology("line-list")}draw({uniforms:e}){const{lineWidthUnits:r,lineWidthScale:n,lineWidthMinPixels:i,lineWidthMaxPixels:a,radiusUnits:s,elevationScale:o,extruded:u,filled:h,stroked:f,wireframe:g,offset:b,coverage:v,radius:S,angle:E}=this.props,P=this.state.fillModel,k=this.state.wireframeModel,{fillVertexCount:L,edgeDistance:O}=this.state,M={radius:S,angle:E/180*Math.PI,offset:b,extruded:u,stroked:f,coverage:v,elevationScale:o,edgeDistance:O,radiusUnits:S0[s],widthUnits:S0[r],widthScale:n,widthMinPixels:i,widthMaxPixels:a};u&&g&&(k.shaderInputs.setProps({column:{...M,isStroke:!0}}),k.draw(this.context.renderPass)),h&&(P.setVertexCount(L),P.shaderInputs.setProps({column:{...M,isStroke:!1}}),P.draw(this.context.renderPass)),!u&&f&&(P.setVertexCount(L*2/3),P.shaderInputs.setProps({column:{...M,isStroke:!0}}),P.draw(this.context.renderPass))}}uD.layerName="ColumnLayer";uD.defaultProps=uWe;const wre=Math.PI/3,sC=2*Math.sin(wre),lC=1.5,cWe=Array.from({length:6},(t,e)=>{const r=e*wre;return[Math.sin(r),-Math.cos(r)]});function sP([t,e],r){let n=Math.round(e=e/r/lC),i=Math.round(t=t/r/sC-(n&1)/2);const a=e-n;if(Math.abs(a)*3>1){const s=t-i,o=i+(t<i?-1:1)/2,u=n+(e<n?-1:1),h=t-o,f=e-u;s*s+a*a>h*h+f*f&&(i=o+(n&1?1:-1)/2,n=u)}return[i,n]}const hWe=`
const vec2 DIST = vec2(${sC}, ${lC});

ivec2 pointToHexbin(vec2 p, float radius) {
  p /= radius * DIST;
  float pj = round(p.y);
  float pjm2 = mod(pj, 2.0);
  p.x -= pjm2 * 0.5;
  float pi = round(p.x);
  vec2 d1 = p - vec2(pi, pj);

  if (abs(d1.y) * 3. > 1.) {
    vec2 v2 = step(0.0, d1) - 0.5;
    v2.y *= 2.0;
    vec2 d2 = d1 - v2;
    if (dot(d1, d1) > dot(d2, d2)) {
      pi += v2.x + pjm2 - 0.5;
      pj += v2.y;
    }
  }
  return ivec2(pi, pj);
}
`;function JH([t,e],r){return[(t+(e&1)/2)*r*sC,e*r*lC]}const fWe=`
const vec2 DIST = vec2(${sC}, ${lC});

vec2 hexbinCentroid(vec2 binId, float radius) {
  binId.x += fract(binId.y * 0.5);
  return binId * DIST * radius;
}
`,dWe=`#version 300 es
#define SHADER_NAME hexagon-cell-layer-vertex-shader
in vec3 positions;
in vec3 normals;
in vec2 instancePositions;
in float instanceElevationValues;
in float instanceColorValues;
in vec3 instancePickingColors;
uniform sampler2D colorRange;
out vec4 vColor;
${fWe}
float interp(float value, vec2 domain, vec2 range) {
float r = min(max((value - domain.x) / (domain.y - domain.x), 0.), 1.);
return mix(range.x, range.y, r);
}
vec4 interp(float value, vec2 domain, sampler2D range) {
float r = (value - domain.x) / (domain.y - domain.x);
return texture(range, vec2(r, 0.5));
}
void main(void) {
geometry.pickingColor = instancePickingColors;
if (isnan(instanceColorValues) ||
instanceColorValues < hexagon.colorDomain.z ||
instanceColorValues > hexagon.colorDomain.w ||
instanceElevationValues < hexagon.elevationDomain.z ||
instanceElevationValues > hexagon.elevationDomain.w
) {
gl_Position = vec4(0.);
return;
}
vec2 commonPosition = hexbinCentroid(instancePositions, column.radius) + (hexagon.originCommon - project.commonOrigin.xy);
commonPosition += positions.xy * column.radius * column.coverage;
geometry.position = vec4(commonPosition, 0.0, 1.0);
geometry.normal = project_normal(normals);
float elevation = 0.0;
if (column.extruded) {
elevation = interp(instanceElevationValues, hexagon.elevationDomain.xy, hexagon.elevationRange);
elevation = project_size(elevation);
geometry.position.z = (positions.z + 1.0) / 2.0 * elevation;
}
gl_Position = project_common_position_to_clipspace(geometry.position);
DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
vColor = interp(instanceColorValues, hexagon.colorDomain.xy, colorRange);
vColor.a *= layer.opacity;
if (column.extruded) {
vColor.rgb = lighting_getLightColor(vColor.rgb, project.cameraPosition, geometry.position.xyz, geometry.normal);
}
DECKGL_FILTER_COLOR(vColor, geometry);
}
`,pWe=`uniform hexagonUniforms {
  vec4 colorDomain;
  vec4 elevationDomain;
  vec2 elevationRange;
  vec2 originCommon;
} hexagon;
`,gWe={name:"hexagon",vs:pWe,uniformTypes:{colorDomain:"vec4<f32>",elevationDomain:"vec4<f32>",elevationRange:"vec2<f32>",originCommon:"vec2<f32>"}};class Sre extends uD{getShaders(){const e=super.getShaders();return e.modules.push(gWe),{...e,vs:dWe}}initializeState(){super.initializeState();const e=this.getAttributeManager();e.remove(["instanceElevations","instanceFillColors","instanceLineColors","instanceStrokeWidths"]),e.addInstanced({instancePositions:{size:2,type:"float32",accessor:"getBin"},instanceColorValues:{size:1,type:"float32",accessor:"getColorValue"},instanceElevationValues:{size:1,type:"float32",accessor:"getElevationValue"}})}updateState(e){super.updateState(e);const{props:r,oldProps:n}=e,i=this.state.fillModel;if(n.colorRange!==r.colorRange){this.state.colorTexture?.destroy(),this.state.colorTexture=WHe(this.context.device,r.colorRange,r.colorScaleType);const a={colorRange:this.state.colorTexture};i.shaderInputs.setProps({hexagon:a})}else n.colorScaleType!==r.colorScaleType&&HHe(this.state.colorTexture,r.colorScaleType)}finalizeState(e){super.finalizeState(e),this.state.colorTexture?.destroy()}draw({uniforms:e}){const{radius:r,hexOriginCommon:n,elevationRange:i,elevationScale:a,extruded:s,coverage:o,colorDomain:u,elevationDomain:h}=this.props,f=this.props.colorCutoff||[-1/0,1/0],g=this.props.elevationCutoff||[-1/0,1/0],b=this.state.fillModel;b.vertexArray.indexBuffer&&b.setIndexBuffer(null),b.setVertexCount(this.state.fillVertexCount);const v={colorDomain:[Math.max(u[0],f[0]),Math.min(u[1],f[1]),Math.max(u[0]-1,f[0]),Math.min(u[1]+1,f[1])],elevationDomain:[Math.max(h[0],g[0]),Math.min(h[1],g[1]),Math.max(h[0]-1,g[0]),Math.min(h[1]+1,g[1])],elevationRange:[i[0]*a,i[1]*a],originCommon:n};b.shaderInputs.setProps({column:{extruded:s,coverage:o,radius:r},hexagon:v}),b.draw(this.context.renderPass)}}Sre.layerName="HexagonCellLayer";const mWe=`uniform binOptionsUniforms {
  vec2 hexOriginCommon;
  float radiusCommon;
} binOptions;
`,yWe={name:"binOptions",vs:mWe,uniformTypes:{hexOriginCommon:"vec2<f32>",radiusCommon:"f32"}};function QH(){}const vWe={gpuAggregation:!0,colorDomain:null,colorRange:$He,getColorValue:{type:"accessor",value:null},getColorWeight:{type:"accessor",value:1},colorAggregation:"SUM",lowerPercentile:{type:"number",min:0,max:100,value:0},upperPercentile:{type:"number",min:0,max:100,value:100},colorScaleType:"quantize",onSetColorDomain:QH,elevationDomain:null,elevationRange:[0,1e3],getElevationValue:{type:"accessor",value:null},getElevationWeight:{type:"accessor",value:1},elevationAggregation:"SUM",elevationScale:{type:"number",min:0,value:1},elevationLowerPercentile:{type:"number",min:0,max:100,value:0},elevationUpperPercentile:{type:"number",min:0,max:100,value:100},elevationScaleType:"linear",onSetElevationDomain:QH,radius:{type:"number",min:1,value:1e3},coverage:{type:"number",min:0,max:1,value:1},getPosition:{type:"accessor",value:t=>t.position},hexagonAggregator:{type:"function",optional:!0,value:null},extruded:!1,material:!0};class IE extends xre{getAggregatorType(){const{gpuAggregation:e,hexagonAggregator:r,getColorValue:n,getElevationValue:i}=this.props;return e&&(r||n||i)?(Za.warn("Features not supported by GPU aggregation, falling back to CPU")(),"cpu"):e&&GH.isSupported(this.context.device)?"gpu":"cpu"}createAggregator(e){if(e==="cpu"){const{hexagonAggregator:r,radius:n}=this.props;return new RHe({dimensions:2,getBin:{sources:["positions"],getValue:({positions:i},a,s)=>{if(r)return r(i,n);const u=this.state.aggregatorViewport.projectPosition(i),{radiusCommon:h,hexOriginCommon:f}=s;return sP([u[0]-f[0],u[1]-f[1]],h)}},getValue:[{sources:["colorWeights"],getValue:({colorWeights:i})=>i},{sources:["elevationWeights"],getValue:({elevationWeights:i})=>i}]})}return new GH(this.context.device,{dimensions:2,channelCount:2,bufferLayout:this.getAttributeManager().getBufferLayouts({isInstanced:!1}),...super.getShaders({modules:[vte,yWe],vs:`
  in vec3 positions;
  in vec3 positions64Low;
  in float colorWeights;
  in float elevationWeights;
  
  ${hWe}

  void getBin(out ivec2 binId) {
    vec3 positionCommon = project_position(positions, positions64Low);
    binId = pointToHexbin(positionCommon.xy, binOptions.radiusCommon);
  }
  void getValue(out vec2 value) {
    value = vec2(colorWeights, elevationWeights);
  }
  `})})}initializeState(){super.initializeState(),this.getAttributeManager().add({positions:{size:3,accessor:"getPosition",type:"float64",fp64:this.use64bitPositions()},colorWeights:{size:1,accessor:"getColorWeight"},elevationWeights:{size:1,accessor:"getElevationWeight"}})}updateState(e){const r=super.updateState(e),{props:n,oldProps:i,changeFlags:a}=e,{aggregator:s}=this.state;if((a.dataChanged||!this.state.dataAsArray)&&(n.getColorValue||n.getElevationValue)&&(this.state.dataAsArray=Array.from(Kte(n.data).iterable)),r||a.dataChanged||n.radius!==i.radius||n.getColorValue!==i.getColorValue||n.getElevationValue!==i.getElevationValue||n.colorAggregation!==i.colorAggregation||n.elevationAggregation!==i.elevationAggregation){this._updateBinOptions();const{radiusCommon:o,hexOriginCommon:u,binIdRange:h,dataAsArray:f}=this.state;if(s.setProps({binIdRange:h,pointCount:this.getNumInstances(),operations:[n.colorAggregation,n.elevationAggregation],binOptions:{radiusCommon:o,hexOriginCommon:u},onUpdate:this._onAggregationUpdate.bind(this)}),f){const{getColorValue:g,getElevationValue:b}=this.props;s.setProps({customOperations:[g&&(v=>g(v.map(S=>f[S]),{indices:v,data:n.data})),b&&(v=>b(v.map(S=>f[S]),{indices:v,data:n.data}))]})}}return a.updateTriggersChanged&&a.updateTriggersChanged.getColorValue&&s.setNeedsUpdate(0),a.updateTriggersChanged&&a.updateTriggersChanged.getElevationValue&&s.setNeedsUpdate(1),r}_updateBinOptions(){const e=this.getBounds();let r=1,n=[0,0],i=[[0,1],[0,1]],a=this.context.viewport;if(e&&Number.isFinite(e[0][0])){let s=[(e[0][0]+e[1][0])/2,(e[0][1]+e[1][1])/2];const{radius:o}=this.props,{unitsPerMeter:u}=a.getDistanceScales(s);r=u[0]*o;const h=sP(a.projectFlat(s),r);s=a.unprojectFlat(JH(h,r));const f=a.constructor;a=a.isGeospatial?new f({longitude:s[0],latitude:s[1],zoom:12}):new Qm({position:[s[0],s[1],0],zoom:12}),n=[Math.fround(a.center[0]),Math.fround(a.center[1])],i=JHe({dataBounds:e,getBinId:g=>{const b=a.projectFlat(g);return b[0]-=n[0],b[1]-=n[1],sP(b,r)},padding:1})}this.setState({radiusCommon:r,hexOriginCommon:n,binIdRange:i,aggregatorViewport:a})}draw(e){e.shaderModuleProps.project&&(e.shaderModuleProps.project.viewport=this.state.aggregatorViewport),super.draw(e)}_onAggregationUpdate({channel:e}){const r=this.getCurrentLayer().props,{aggregator:n}=this.state;if(e===0){const i=n.getResult(0);this.setState({colors:new XH(i,n.binCount)}),r.onSetColorDomain(n.getResultDomain(0))}else if(e===1){const i=n.getResult(1);this.setState({elevations:new XH(i,n.binCount)}),r.onSetElevationDomain(n.getResultDomain(1))}}onAttributeChange(e){const{aggregator:r}=this.state;switch(e){case"positions":r.setNeedsUpdate(),this._updateBinOptions();const{radiusCommon:n,hexOriginCommon:i,binIdRange:a}=this.state;r.setProps({binIdRange:a,binOptions:{radiusCommon:n,hexOriginCommon:i}});break;case"colorWeights":r.setNeedsUpdate(0);break;case"elevationWeights":r.setNeedsUpdate(1);break}}renderLayers(){const{aggregator:e,radiusCommon:r,hexOriginCommon:n}=this.state,{elevationScale:i,colorRange:a,elevationRange:s,extruded:o,coverage:u,material:h,transitions:f,colorScaleType:g,lowerPercentile:b,upperPercentile:v,colorDomain:S,elevationScaleType:E,elevationLowerPercentile:P,elevationUpperPercentile:k,elevationDomain:L}=this.props,O=this.getSubLayerClass("cells",Sre),M=e.getBins(),z=this.state.colors?.update({scaleType:g,lowerPercentile:b,upperPercentile:v}),B=this.state.elevations?.update({scaleType:E,lowerPercentile:P,upperPercentile:k});return!z||!B?null:new O(this.getSubLayerProps({id:"cells"}),{data:{length:e.binCount,attributes:{getBin:M,getColorValue:z.attribute,getElevationValue:B.attribute}},dataComparator:(q,W)=>q.length===W.length,updateTriggers:{getBin:[M],getColorValue:[z.attribute],getElevationValue:[B.attribute]},diskResolution:6,vertices:cWe,radius:r,hexOriginCommon:n,elevationScale:i,colorRange:a,colorScaleType:g,elevationRange:s,extruded:o,coverage:u,material:h,colorDomain:z.domain||S||e.getResultDomain(0),elevationDomain:B.domain||L||e.getResultDomain(1),colorCutoff:z.cutoff,elevationCutoff:B.cutoff,transitions:f&&{getFillColor:f.getColorValue||f.getColorWeight,getElevation:f.getElevationValue||f.getElevationWeight},extensions:[]})}getPickingInfo(e){const r=e.info,{index:n}=r;if(n>=0){const i=this.state.aggregator.getBin(n);let a;if(i){const s=JH(i.id,this.state.radiusCommon),o=this.context.viewport.unprojectFlat(s);a={col:i.id[0],row:i.id[1],position:o,colorValue:i.value[0],elevationValue:i.value[1],count:i.count},i.pointIndices&&(a.pointIndices=i.pointIndices,a.points=Array.isArray(this.props.data)?i.pointIndices.map(u=>this.props.data[u]):[])}r.object=a}return r}}IE.layerName="HexagonLayer";IE.defaultProps=vWe;const PE=t=>{const e="assets/3D/laerm_points.json",r=wHe(),[n,i]=ee.useState({type:"",features:[]}),a=()=>{fetch(e,{headers:{"Content-Type":"application/json",Accept:"application/json"}}).then(function(v){return v.json()}).then(function(v){i(v)})};ee.useEffect(()=>{a()},[]);const s=.8,o=[51,51,51],u=v=>[[1,152,189,Math.round(80*v)],[73,227,206,Math.round(90*v)],[216,254,181,Math.round(100*v)],[254,237,177,Math.round(110*v)],[254,173,84,Math.round(120*v)],[209,55,78,Math.round(150*v)]],h=[30,75],f=ee.useMemo(()=>({id:"deckgl-layer",data:n?n.features:[],type:IE,colorRange:u(s),coverage:.9,elevationRange:h,elevationScale:10,extruded:!0,autoHighlight:!0,getPosition:v=>v.geometry.coordinates,pickable:!0,radius:16,upperPercentile:100,material:{ambient:.8,diffuse:.5,shininess:20,specularColor:o},transitions:{elevationScale:1500},getColorValue:v=>{const S=v.reduce((E,P)=>!P?.properties&&P.source.properties?E<P.source.properties.dba?P.source.properties.dba:E:E<P.properties.dba?P.properties.dba:E,-1/0);return Math.round(S)},getElevationValue:v=>{const S=v.reduce((E,P)=>!P.properties&&P.source.properties?E<P.source.properties.dba?P.source.properties.dba:E:E<P.properties.dba?P.properties.dba:E,-1/0);return Math.round(S)},_filterData:null}),[n.features]),g=ha({mapId:t.mapId,waitForLayer:t.insertBeforeLayer}),b=ee.useRef(!1);return ee.useEffect(()=>{if(!g.map||n.features.length<=0||b.current&&n.features.length>=0)return;b.current=!0;const v=new IE({...f});return r.addLayer(v),()=>{v&&r.removeLayer(v),b.current=!1}},[g.map,t.mapId,f]),K.jsx(K.Fragment,{})};try{PE.displayName="MlHexagonMap",PE.__docgenInfo={description:"",displayName:"MlHexagonMap",props:{mapId:{defaultValue:null,description:"Id of the target MapLibre instance in mapContext",name:"mapId",required:!1,type:{name:"string | undefined"}},insertBeforeLayer:{defaultValue:null,description:`Id of an existing layer in the mapLibre instance to help specify the layer order
This layer will be visually beneath the layer with the "insertBeforeLayer" id.`,name:"insertBeforeLayer",required:!1,type:{name:"string | undefined"}}}}}catch{}const _We={title:"MapComponents/MlHexagonMap",component:PE,argTypes:{},decorators:FDe},bWe=t=>K.jsx(mR,{...t,children:K.jsx(PE,{...t})}),tm=bWe.bind({});tm.parameters={};tm.args={mapId:"map_1"};tm.parameters={...tm.parameters,docs:{...tm.parameters?.docs,source:{originalSource:`(props: TemplateProps) => <DeckGlContextProvider {...props}>
        <MlHexagonMap {...props} />
    </DeckGlContextProvider>`,...tm.parameters?.docs?.source}}};const xWe=["NoiseMap"],kWe=Object.freeze(Object.defineProperty({__proto__:null,NoiseMap:tm,__namedExportsOrder:xWe,default:_We},Symbol.toStringTag,{value:"Module"}));export{kWe as M,ao as _};
