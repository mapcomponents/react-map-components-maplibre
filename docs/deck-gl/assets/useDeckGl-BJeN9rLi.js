const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./index.es-DmW57HDq.js","./iframe-MAYk9TAT.js","./preload-helper-D9Z9MdNV.js","./iframe-DG6F43G8.css","./index-DGdF4PAP.js","./index-BrbOrtGx.js"])))=>i.map(i=>d[i]);
import{j as J,P as P1,r as fp}from"./index-DGdF4PAP.js";import{g as Id,V as jS,r as te,R as gt,a as HW,c as cg,b as wx}from"./iframe-MAYk9TAT.js";import{_ as ib}from"./preload-helper-D9Z9MdNV.js";var aS={exports:{}};/**
 * MapLibre GL JS
 * @license 3-Clause BSD. Full text of license: https://github.com/maplibre/maplibre-gl-js/blob/v5.16.0/LICENSE.txt
 */var yoe=aS.exports,V8;function voe(){return V8||(V8=1,(function(t,e){(function(r,n){t.exports=n()})(yoe,(function(){var r={},n={};function i(s,o,c){if(n[s]=c,s==="index"){var f="var sharedModule = {}; ("+n.shared+")(sharedModule); ("+n.worker+")(sharedModule);",d={};return n.shared(d),n.index(r,d),typeof window<"u"&&r.setWorkerUrl(window.URL.createObjectURL(new Blob([f],{type:"text/javascript"}))),r}}i("shared",["exports"],(function(s){function o(p,l,h,v){return new(h||(h=Promise))((function(S,k){function R(Z){try{V(v.next(Z))}catch(ie){k(ie)}}function B(Z){try{V(v.throw(Z))}catch(ie){k(ie)}}function V(Z){var ie;Z.done?S(Z.value):(ie=Z.value,ie instanceof h?ie:new h((function(ce){ce(ie)}))).then(R,B)}V((v=v.apply(p,l||[])).next())}))}function c(p,l){this.x=p,this.y=l}function f(p){return p&&p.__esModule&&Object.prototype.hasOwnProperty.call(p,"default")?p.default:p}var d,m;typeof SuppressedError=="function"&&SuppressedError,c.prototype={clone(){return new c(this.x,this.y)},add(p){return this.clone()._add(p)},sub(p){return this.clone()._sub(p)},multByPoint(p){return this.clone()._multByPoint(p)},divByPoint(p){return this.clone()._divByPoint(p)},mult(p){return this.clone()._mult(p)},div(p){return this.clone()._div(p)},rotate(p){return this.clone()._rotate(p)},rotateAround(p,l){return this.clone()._rotateAround(p,l)},matMult(p){return this.clone()._matMult(p)},unit(){return this.clone()._unit()},perp(){return this.clone()._perp()},round(){return this.clone()._round()},mag(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals(p){return this.x===p.x&&this.y===p.y},dist(p){return Math.sqrt(this.distSqr(p))},distSqr(p){const l=p.x-this.x,h=p.y-this.y;return l*l+h*h},angle(){return Math.atan2(this.y,this.x)},angleTo(p){return Math.atan2(this.y-p.y,this.x-p.x)},angleWith(p){return this.angleWithSep(p.x,p.y)},angleWithSep(p,l){return Math.atan2(this.x*l-this.y*p,this.x*p+this.y*l)},_matMult(p){const l=p[2]*this.x+p[3]*this.y;return this.x=p[0]*this.x+p[1]*this.y,this.y=l,this},_add(p){return this.x+=p.x,this.y+=p.y,this},_sub(p){return this.x-=p.x,this.y-=p.y,this},_mult(p){return this.x*=p,this.y*=p,this},_div(p){return this.x/=p,this.y/=p,this},_multByPoint(p){return this.x*=p.x,this.y*=p.y,this},_divByPoint(p){return this.x/=p.x,this.y/=p.y,this},_unit(){return this._div(this.mag()),this},_perp(){const p=this.y;return this.y=this.x,this.x=-p,this},_rotate(p){const l=Math.cos(p),h=Math.sin(p),v=h*this.x+l*this.y;return this.x=l*this.x-h*this.y,this.y=v,this},_rotateAround(p,l){const h=Math.cos(p),v=Math.sin(p),S=l.y+v*(this.x-l.x)+h*(this.y-l.y);return this.x=l.x+h*(this.x-l.x)-v*(this.y-l.y),this.y=S,this},_round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},constructor:c},c.convert=function(p){if(p instanceof c)return p;if(Array.isArray(p))return new c(+p[0],+p[1]);if(p.x!==void 0&&p.y!==void 0)return new c(+p.x,+p.y);throw new Error("Expected [x, y] or {x, y} point format")};var b=(function(){if(m)return d;function p(l,h,v,S){this.cx=3*l,this.bx=3*(v-l)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*h,this.by=3*(S-h)-this.cy,this.ay=1-this.cy-this.by,this.p1x=l,this.p1y=h,this.p2x=v,this.p2y=S}return m=1,d=p,p.prototype={sampleCurveX:function(l){return((this.ax*l+this.bx)*l+this.cx)*l},sampleCurveY:function(l){return((this.ay*l+this.by)*l+this.cy)*l},sampleCurveDerivativeX:function(l){return(3*this.ax*l+2*this.bx)*l+this.cx},solveCurveX:function(l,h){if(h===void 0&&(h=1e-6),l<0)return 0;if(l>1)return 1;for(var v=l,S=0;S<8;S++){var k=this.sampleCurveX(v)-l;if(Math.abs(k)<h)return v;var R=this.sampleCurveDerivativeX(v);if(Math.abs(R)<1e-6)break;v-=k/R}var B=0,V=1;for(v=l,S=0;S<20&&(k=this.sampleCurveX(v),!(Math.abs(k-l)<h));S++)l>k?B=v:V=v,v=.5*(V-B)+B;return v},solve:function(l,h){return this.sampleCurveY(this.solveCurveX(l,h))}},d})(),x=f(b);let E,T;function A(){return E==null&&(E=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")&&typeof createImageBitmap=="function"),E}function M(){if(T==null&&(T=!1,A())){const l=new OffscreenCanvas(5,5).getContext("2d",{willReadFrequently:!0});if(l){for(let v=0;v<25;v++){const S=4*v;l.fillStyle=`rgb(${S},${S+1},${S+2})`,l.fillRect(v%5,Math.floor(v/5),1,1)}const h=l.getImageData(0,0,5,5).data;for(let v=0;v<100;v++)if(v%4!=3&&h[v]!==v){T=!0;break}}}return T||!1}var F=1e-6,N=typeof Float32Array<"u"?Float32Array:Array;function O(){var p=new N(9);return N!=Float32Array&&(p[1]=0,p[2]=0,p[3]=0,p[5]=0,p[6]=0,p[7]=0),p[0]=1,p[4]=1,p[8]=1,p}function U(p){return p[0]=1,p[1]=0,p[2]=0,p[3]=0,p[4]=0,p[5]=1,p[6]=0,p[7]=0,p[8]=0,p[9]=0,p[10]=1,p[11]=0,p[12]=0,p[13]=0,p[14]=0,p[15]=1,p}function j(){var p=new N(3);return N!=Float32Array&&(p[0]=0,p[1]=0,p[2]=0),p}function H(p){var l=p[0],h=p[1],v=p[2];return Math.sqrt(l*l+h*h+v*v)}function W(p,l,h){var v=new N(3);return v[0]=p,v[1]=l,v[2]=h,v}function X(p,l,h){return p[0]=l[0]+h[0],p[1]=l[1]+h[1],p[2]=l[2]+h[2],p}function oe(p,l,h){return p[0]=l[0]*h,p[1]=l[1]*h,p[2]=l[2]*h,p}function Q(p,l,h){var v=l[0],S=l[1],k=l[2],R=h[0],B=h[1],V=h[2];return p[0]=S*V-k*B,p[1]=k*R-v*V,p[2]=v*B-S*R,p}var G,ae=H;function se(p,l,h){var v=l[0],S=l[1],k=l[2],R=l[3];return p[0]=h[0]*v+h[4]*S+h[8]*k+h[12]*R,p[1]=h[1]*v+h[5]*S+h[9]*k+h[13]*R,p[2]=h[2]*v+h[6]*S+h[10]*k+h[14]*R,p[3]=h[3]*v+h[7]*S+h[11]*k+h[15]*R,p}function fe(){var p=new N(4);return N!=Float32Array&&(p[0]=0,p[1]=0,p[2]=0),p[3]=1,p}function _e(p,l,h,v){var S=arguments.length>4&&arguments[4]!==void 0?arguments[4]:"zyx",k=Math.PI/360;l*=k,v*=k,h*=k;var R=Math.sin(l),B=Math.cos(l),V=Math.sin(h),Z=Math.cos(h),ie=Math.sin(v),ce=Math.cos(v);switch(S){case"xyz":p[0]=R*Z*ce+B*V*ie,p[1]=B*V*ce-R*Z*ie,p[2]=B*Z*ie+R*V*ce,p[3]=B*Z*ce-R*V*ie;break;case"xzy":p[0]=R*Z*ce-B*V*ie,p[1]=B*V*ce-R*Z*ie,p[2]=B*Z*ie+R*V*ce,p[3]=B*Z*ce+R*V*ie;break;case"yxz":p[0]=R*Z*ce+B*V*ie,p[1]=B*V*ce-R*Z*ie,p[2]=B*Z*ie-R*V*ce,p[3]=B*Z*ce+R*V*ie;break;case"yzx":p[0]=R*Z*ce+B*V*ie,p[1]=B*V*ce+R*Z*ie,p[2]=B*Z*ie-R*V*ce,p[3]=B*Z*ce-R*V*ie;break;case"zxy":p[0]=R*Z*ce-B*V*ie,p[1]=B*V*ce+R*Z*ie,p[2]=B*Z*ie+R*V*ce,p[3]=B*Z*ce-R*V*ie;break;case"zyx":p[0]=R*Z*ce-B*V*ie,p[1]=B*V*ce+R*Z*ie,p[2]=B*Z*ie-R*V*ce,p[3]=B*Z*ce+R*V*ie;break;default:throw new Error("Unknown angle order "+S)}return p}function Le(){var p=new N(2);return N!=Float32Array&&(p[0]=0,p[1]=0),p}function ye(p,l){var h=new N(2);return h[0]=p,h[1]=l,h}j(),G=new N(4),N!=Float32Array&&(G[0]=0,G[1]=0,G[2]=0,G[3]=0),j(),W(1,0,0),W(0,1,0),fe(),fe(),O(),Le();const Te=8192;function Ie(p,l,h){return l*(Te/(p.tileSize*Math.pow(2,h-p.tileID.overscaledZ)))}function Me(p,l){return(p%l+l)%l}function de(p,l,h){return p*(1-h)+l*h}function Se(p){if(p<=0)return 0;if(p>=1)return 1;const l=p*p,h=l*p;return 4*(p<.5?h:3*(p-l)+h-.75)}function we(p,l,h,v){const S=new x(p,l,h,v);return k=>S.solve(k)}const De=we(.25,.1,.25,1);function Fe(p,l,h){return Math.min(h,Math.max(l,p))}function Xe(p,l,h){const v=h-l,S=((p-l)%v+v)%v+l;return S===l?h:S}function Be(p,...l){for(const h of l)for(const v in h)p[v]=h[v];return p}let st=1;function Qe(p,l,h){const v={};for(const S in p)v[S]=l.call(this,p[S],S,p);return v}function it(p,l,h){const v={};for(const S in p)l.call(this,p[S],S,p)&&(v[S]=p[S]);return v}function be(p){return Array.isArray(p)?p.map(be):typeof p=="object"&&p?Qe(p,be):p}const Ot={};function at(p){Ot[p]||(typeof console<"u"&&console.warn(p),Ot[p]=!0)}function $e(p,l,h){return(h.y-p.y)*(l.x-p.x)>(l.y-p.y)*(h.x-p.x)}function Xt(p){return typeof WorkerGlobalScope<"u"&&p!==void 0&&p instanceof WorkerGlobalScope}let $t=null;function cr(p){return typeof ImageBitmap<"u"&&p instanceof ImageBitmap}const _t="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";function gr(p,l,h,v,S){return o(this,void 0,void 0,(function*(){if(typeof VideoFrame>"u")throw new Error("VideoFrame not supported");const k=new VideoFrame(p,{timestamp:0});try{const R=k?.format;if(!R||!R.startsWith("BGR")&&!R.startsWith("RGB"))throw new Error(`Unrecognized format ${R}`);const B=R.startsWith("BGR"),V=new Uint8ClampedArray(v*S*4);if(yield k.copyTo(V,(function(Z,ie,ce,ve,Ee){const Ne=4*Math.max(-ie,0),ze=(Math.max(0,ce)-ce)*ve*4+Ne,Ve=4*ve,et=Math.max(0,ie),Ct=Math.max(0,ce);return{rect:{x:et,y:Ct,width:Math.min(Z.width,ie+ve)-et,height:Math.min(Z.height,ce+Ee)-Ct},layout:[{offset:ze,stride:Ve}]}})(p,l,h,v,S)),B)for(let Z=0;Z<V.length;Z+=4){const ie=V[Z];V[Z]=V[Z+2],V[Z+2]=ie}return V}finally{k.close()}}))}let mr,ar;function Cr(p,l,h,v){return p.addEventListener(l,h,v),{unsubscribe:()=>{p.removeEventListener(l,h,v)}}}function Er(p){return p*Math.PI/180}function Jt(p){return p/Math.PI*180}const ot={touchstart:!0,touchmove:!0,touchmoveWindow:!0,touchend:!0,touchcancel:!0},Ce={dblclick:!0,click:!0,mouseover:!0,mouseout:!0,mousedown:!0,mousemove:!0,mousemoveWindow:!0,mouseup:!0,mouseupWindow:!0,contextmenu:!0,wheel:!0},xe="AbortError";class je extends Error{constructor(l=xe){super(l instanceof Error?l.message:l),this.name=xe,l instanceof Error&&l.stack&&(this.stack=l.stack)}}function qe(p){return p.name===xe}const Ge={MAX_PARALLEL_IMAGE_REQUESTS:16,MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:8,MAX_TILE_CACHE_ZOOM_LEVELS:5,REGISTERED_PROTOCOLS:{},WORKER_URL:""};function Ft(p){return Ge.REGISTERED_PROTOCOLS[p.substring(0,p.indexOf("://"))]}const Et="global-dispatcher";class mt extends Error{constructor(l,h,v,S){super(`AJAXError: ${h} (${l}): ${v}`),this.status=l,this.statusText=h,this.url=v,this.body=S}}const ct=()=>Xt(self)?self.worker&&self.worker.referrer:(window.location.protocol==="blob:"?window.parent:window).location.href,Qt=function(p,l){if(/:\/\//.test(p.url)&&!/^https?:|^file:/.test(p.url)){const v=Ft(p.url);if(v)return v(p,l);if(Xt(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:p,targetMapId:Et},l)}if(!(/^file:/.test(h=p.url)||/^file:/.test(ct())&&!/^\w+:/.test(h))){if(fetch&&Request&&AbortController&&Object.prototype.hasOwnProperty.call(Request.prototype,"signal"))return(function(v,S){return o(this,void 0,void 0,(function*(){const k=new Request(v.url,{method:v.method||"GET",body:v.body,credentials:v.credentials,headers:v.headers,cache:v.cache,referrer:ct(),signal:S.signal});let R,B;v.type!=="json"||k.headers.has("Accept")||k.headers.set("Accept","application/json");try{R=yield fetch(k)}catch(Z){throw qe(Z)?Z:new mt(0,Z.message,v.url,new Blob)}if(!R.ok){const Z=yield R.blob();throw new mt(R.status,R.statusText,v.url,Z)}B=v.type==="arrayBuffer"||v.type==="image"?R.arrayBuffer():v.type==="json"?R.json():R.text();const V=yield B;return S.signal.throwIfAborted(),{data:V,cacheControl:R.headers.get("Cache-Control"),expires:R.headers.get("Expires")}}))})(p,l);if(Xt(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:p,mustQueue:!0,targetMapId:Et},l)}var h;return(function(v,S){return new Promise(((k,R)=>{var B;const V=new XMLHttpRequest;V.open(v.method||"GET",v.url,!0),v.type!=="arrayBuffer"&&v.type!=="image"||(V.responseType="arraybuffer");for(const Z in v.headers)V.setRequestHeader(Z,v.headers[Z]);v.type==="json"&&(V.responseType="text",!((B=v.headers)===null||B===void 0)&&B.Accept||V.setRequestHeader("Accept","application/json")),V.withCredentials=v.credentials==="include",V.onerror=()=>{R(new Error(V.statusText))},V.onload=()=>{if(!S.signal.aborted)if((V.status>=200&&V.status<300||V.status===0)&&V.response!==null){let Z=V.response;if(v.type==="json")try{Z=JSON.parse(V.response)}catch(ie){return void R(ie)}k({data:Z,cacheControl:V.getResponseHeader("Cache-Control"),expires:V.getResponseHeader("Expires")})}else{const Z=new Blob([V.response],{type:V.getResponseHeader("Content-Type")});R(new mt(V.status,V.statusText,v.url,Z))}},S.signal.addEventListener("abort",(()=>{V.abort(),R(new je(S.signal.reason))})),V.send(v.body)}))})(p,l)};function Ht(p){if(!p||p.indexOf("://")<=0||p.indexOf("data:image/")===0||p.indexOf("blob:")===0)return!0;const l=new URL(p),h=window.location;return l.protocol===h.protocol&&l.host===h.host}function Ir(p,l,h){h[p]&&h[p].indexOf(l)!==-1||(h[p]=h[p]||[],h[p].push(l))}function Ar(p,l,h){if(h&&h[p]){const v=h[p].indexOf(l);v!==-1&&h[p].splice(v,1)}}class $r{constructor(l,h={}){Be(this,h),this.type=l}}class fn extends $r{constructor(l,h={}){super("error",Be({error:l},h))}}class zr{on(l,h){return this._listeners=this._listeners||{},Ir(l,h,this._listeners),{unsubscribe:()=>{this.off(l,h)}}}off(l,h){return Ar(l,h,this._listeners),Ar(l,h,this._oneTimeListeners),this}once(l,h){return h?(this._oneTimeListeners=this._oneTimeListeners||{},Ir(l,h,this._oneTimeListeners),this):new Promise((v=>this.once(l,v)))}fire(l,h){typeof l=="string"&&(l=new $r(l,h||{}));const v=l.type;if(this.listens(v)){l.target=this;const S=this._listeners&&this._listeners[v]?this._listeners[v].slice():[];for(const B of S)B.call(this,l);const k=this._oneTimeListeners&&this._oneTimeListeners[v]?this._oneTimeListeners[v].slice():[];for(const B of k)Ar(v,B,this._oneTimeListeners),B.call(this,l);const R=this._eventedParent;R&&(Be(l,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),R.fire(l))}else l instanceof fn&&console.error(l.error);return this}listens(l){return this._listeners&&this._listeners[l]&&this._listeners[l].length>0||this._oneTimeListeners&&this._oneTimeListeners[l]&&this._oneTimeListeners[l].length>0||this._eventedParent&&this._eventedParent.listens(l)}setEventedParent(l,h){return this._eventedParent=l,this._eventedParentData=h,this}}var Mt={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number",length:2},centerAltitude:{type:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},roll:{type:"number",default:0,units:"degrees"},state:{type:"state",default:{}},light:{type:"light"},sky:{type:"sky"},projection:{type:"projection"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"sprite"},glyphs:{type:"string"},"font-faces":{type:"fontFaces"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},encoding:{type:"enum",values:{mvt:{},mlt:{}},default:"mvt"},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{},custom:{}},default:"mapbox"},redFactor:{type:"number",default:1},blueFactor:{type:"number",default:1},greenFactor:{type:"number",default:1},baseShift:{type:"number",default:0},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{required:!0,type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"filter"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},"color-relief":{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_color-relief","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible",expression:{interpolated:!1,parameters:["global-state"]},"property-type":"data-constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible",expression:{interpolated:!1,parameters:["global-state"]},"property-type":"data-constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible",expression:{interpolated:!1,parameters:["global-state"]},"property-type":"data-constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible",expression:{interpolated:!1,parameters:["global-state"]},"property-type":"data-constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible",expression:{interpolated:!1,parameters:["global-state"]},"property-type":"data-constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible",expression:{interpolated:!1,parameters:["global-state"]},"property-type":"data-constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"padding",default:[2],units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-variable-anchor-offset":{type:"variableAnchorOffsetCollection",requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible",expression:{interpolated:!1,parameters:["global-state"]},"property-type":"data-constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible",expression:{interpolated:!1,parameters:["global-state"]},"property-type":"data-constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible",expression:{interpolated:!1,parameters:["global-state"]},"property-type":"data-constant"}},"layout_color-relief":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible",expression:{interpolated:!1,parameters:["global-state"]},"property-type":"data-constant"}},filter:{type:"boolean",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"expression_name",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},sky:{"sky-color":{type:"color","property-type":"data-constant",default:"#88C6FC",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-ground-blend":{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-fog-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"sky-horizon-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"atmosphere-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},terrain:{source:{type:"string",required:!0},exaggeration:{type:"number",minimum:0,default:1}},projection:{type:{type:"projectionDefinition",default:"mercator","property-type":"data-constant",transition:!1,expression:{interpolated:!0,parameters:["zoom"]}}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_color-relief","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"numberArray",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-altitude":{type:"numberArray",default:45,minimum:0,maximum:90,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"colorArray",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"colorArray",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-method":{type:"enum",values:{standard:{},basic:{},combined:{},igor:{},multidirectional:{}},default:"standard",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},"paint_color-relief":{"color-relief-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"color-relief-color":{type:"color",transition:!1,expression:{interpolated:!0,parameters:["elevation"]},"property-type":"color-ramp"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}},interpolation:{type:"array",value:"interpolation_name",minimum:1},interpolation_name:{type:"enum",values:{linear:{syntax:{overloads:[{parameters:[],"output-type":"interpolation"}],parameters:[]}},exponential:{syntax:{overloads:[{parameters:["base"],"output-type":"interpolation"}],parameters:[{name:"base",type:"number literal"}]}},"cubic-bezier":{syntax:{overloads:[{parameters:["x1","y1","x2","y2"],"output-type":"interpolation"}],parameters:[{name:"x1",type:"number literal"},{name:"y1",type:"number literal"},{name:"x2",type:"number literal"},{name:"y2",type:"number literal"}]}}}}};const en=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function jn(p,l){const h={};for(const v in p)v!=="ref"&&(h[v]=p[v]);return en.forEach((v=>{v in l&&(h[v]=l[v])})),h}function Qr(p,l){if(Array.isArray(p)){if(!Array.isArray(l)||p.length!==l.length)return!1;for(let h=0;h<p.length;h++)if(!Qr(p[h],l[h]))return!1;return!0}if(typeof p=="object"&&p!==null&&l!==null){if(typeof l!="object"||Object.keys(p).length!==Object.keys(l).length)return!1;for(const h in p)if(!Qr(p[h],l[h]))return!1;return!0}return p===l}function nr(p,l){p.push(l)}function oi(p,l,h){nr(h,{command:"addSource",args:[p,l[p]]})}function un(p,l,h){nr(l,{command:"removeSource",args:[p]}),h[p]=!0}function Kn(p,l,h,v){un(p,h,v),oi(p,l,h)}function Re(p,l,h){let v;for(v in p[h])if(Object.prototype.hasOwnProperty.call(p[h],v)&&v!=="data"&&!Qr(p[h][v],l[h][v]))return!1;for(v in l[h])if(Object.prototype.hasOwnProperty.call(l[h],v)&&v!=="data"&&!Qr(p[h][v],l[h][v]))return!1;return!0}function He(p,l,h,v,S,k){p=p||{},l=l||{};for(const R in p)Object.prototype.hasOwnProperty.call(p,R)&&(Qr(p[R],l[R])||h.push({command:k,args:[v,R,l[R],S]}));for(const R in l)Object.prototype.hasOwnProperty.call(l,R)&&!Object.prototype.hasOwnProperty.call(p,R)&&(Qr(p[R],l[R])||h.push({command:k,args:[v,R,l[R],S]}))}function Tt(p){return p.id}function Gt(p,l){return p[l.id]=l,p}class Ut{constructor(l,h,v,S){this.message=(l?`${l}: `:"")+v,S&&(this.identifier=S),h!=null&&h.__line__&&(this.line=h.__line__)}}function Xr(p,...l){for(const h of l)for(const v in h)p[v]=h[v];return p}class Nn extends Error{constructor(l,h){super(h),this.message=h,this.key=l}}class Bi{constructor(l,h=[]){this.parent=l,this.bindings={};for(const[v,S]of h)this.bindings[v]=S}concat(l){return new Bi(this,l)}get(l){if(this.bindings[l])return this.bindings[l];if(this.parent)return this.parent.get(l);throw new Error(`${l} not found in scope.`)}has(l){return!!this.bindings[l]||!!this.parent&&this.parent.has(l)}}const Ci={kind:"null"},Fr={kind:"number"},Mn={kind:"string"},Bn={kind:"boolean"},ei={kind:"color"},ua={kind:"projectionDefinition"},ha={kind:"object"},zn={kind:"value"},La={kind:"collator"},Wi={kind:"formatted"},hs={kind:"padding"},Ca={kind:"colorArray"},Mo={kind:"numberArray"},Ya={kind:"resolvedImage"},ol={kind:"variableAnchorOffsetCollection"};function xi(p,l){return{kind:"array",itemType:p,N:l}}function zi(p){if(p.kind==="array"){const l=zi(p.itemType);return typeof p.N=="number"?`array<${l}, ${p.N}>`:p.itemType.kind==="value"?"array":`array<${l}>`}return p.kind}const Iu=[Ci,Fr,Mn,Bn,ei,ua,Wi,ha,xi(zn),hs,Mo,Ca,Ya,ol];function ga(p,l){if(l.kind==="error")return null;if(p.kind==="array"){if(l.kind==="array"&&(l.N===0&&l.itemType.kind==="value"||!ga(p.itemType,l.itemType))&&(typeof p.N!="number"||p.N===l.N))return null}else{if(p.kind===l.kind)return null;if(p.kind==="value"){for(const h of Iu)if(!ga(h,l))return null}}return`Expected ${zi(p)} but found ${zi(l)} instead.`}function Za(p,l){return l.some((h=>h.kind===p.kind))}function ds(p,l){return l.some((h=>h==="null"?p===null:h==="array"?Array.isArray(p):h==="object"?p&&!Array.isArray(p)&&typeof p=="object":h===typeof p))}function Aa(p,l){return p.kind==="array"&&l.kind==="array"?p.itemType.kind===l.itemType.kind&&typeof p.N=="number":p.kind===l.kind}const ps=.96422,Ul=.82521,Fa=4/29,_a=6/29,wc=3*_a*_a,sl=_a*_a*_a,ts=Math.PI/180,oo=180/Math.PI;function rs(p){return(p%=360)<0&&(p+=360),p}function Ba([p,l,h,v]){let S,k;const R=$c((.2225045*(p=Us(p))+.7168786*(l=Us(l))+.0606169*(h=Us(h)))/1);p===l&&l===h?S=k=R:(S=$c((.4360747*p+.3850649*l+.1430804*h)/ps),k=$c((.0139322*p+.0971045*l+.7141733*h)/Ul));const B=116*R-16;return[B<0?0:B,500*(S-R),200*(R-k),v]}function Us(p){return p<=.04045?p/12.92:Math.pow((p+.055)/1.055,2.4)}function $c(p){return p>sl?Math.pow(p,1/3):p/wc+Fa}function Pu([p,l,h,v]){let S=(p+16)/116,k=isNaN(l)?S:S+l/500,R=isNaN(h)?S:S-h/200;return S=1*pe(S),k=ps*pe(k),R=Ul*pe(R),[ee(3.1338561*k-1.6168667*S-.4906146*R),ee(-.9787684*k+1.9161415*S+.033454*R),ee(.0719453*k-.2289914*S+1.4052427*R),v]}function ee(p){return(p=p<=.00304?12.92*p:1.055*Math.pow(p,1/2.4)-.055)<0?0:p>1?1:p}function pe(p){return p>_a?p*p*p:wc*(p-Fa)}const Ke=Object.hasOwn||function(p,l){return Object.prototype.hasOwnProperty.call(p,l)};function It(p,l){return Ke(p,l)?p[l]:void 0}function Vt(p){return parseInt(p.padEnd(2,p),16)/255}function qt(p,l){return er(l?p/100:p,0,1)}function er(p,l,h){return Math.min(Math.max(l,p),h)}function Yr(p){return!p.some(Number.isNaN)}const tn={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};function Gr(p,l,h){return p+h*(l-p)}function on(p,l,h){return p.map(((v,S)=>Gr(v,l[S],h)))}class kr{constructor(l,h,v,S=1,k=!0){this.r=l,this.g=h,this.b=v,this.a=S,k||(this.r*=S,this.g*=S,this.b*=S,S||this.overwriteGetter("rgb",[l,h,v,S]))}static parse(l){if(l instanceof kr)return l;if(typeof l!="string")return;const h=(function(v){if((v=v.toLowerCase().trim())==="transparent")return[0,0,0,0];const S=It(tn,v);if(S){const[R,B,V]=S;return[R/255,B/255,V/255,1]}if(v.startsWith("#")&&/^#(?:[0-9a-f]{3,4}|[0-9a-f]{6}|[0-9a-f]{8})$/.test(v)){const R=v.length<6?1:2;let B=1;return[Vt(v.slice(B,B+=R)),Vt(v.slice(B,B+=R)),Vt(v.slice(B,B+=R)),Vt(v.slice(B,B+R)||"ff")]}if(v.startsWith("rgb")){const R=v.match(/^rgba?\(\s*([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(R){const[B,V,Z,ie,ce,ve,Ee,Ne,ze,Ve,et,Ct]=R,rt=[ie||" ",Ee||" ",Ve].join("");if(rt==="  "||rt==="  /"||rt===",,"||rt===",,,"){const ut=[Z,ve,ze].join(""),Rt=ut==="%%%"?100:ut===""?255:0;if(Rt){const Bt=[er(+V/Rt,0,1),er(+ce/Rt,0,1),er(+Ne/Rt,0,1),et?qt(+et,Ct):1];if(Yr(Bt))return Bt}}return}}const k=v.match(/^hsla?\(\s*([\de.+-]+)(?:deg)?(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(k){const[R,B,V,Z,ie,ce,ve,Ee,Ne]=k,ze=[V||" ",ie||" ",ve].join("");if(ze==="  "||ze==="  /"||ze===",,"||ze===",,,"){const Ve=[+B,er(+Z,0,100),er(+ce,0,100),Ee?qt(+Ee,Ne):1];if(Yr(Ve))return(function([et,Ct,rt,ut]){function Rt(Bt){const dr=(Bt+et/30)%12,Or=Ct*Math.min(rt,1-rt);return rt-Or*Math.max(-1,Math.min(dr-3,9-dr,1))}return et=rs(et),Ct/=100,rt/=100,[Rt(0),Rt(8),Rt(4),ut]})(Ve)}}})(l);return h?new kr(...h,!1):void 0}get rgb(){const{r:l,g:h,b:v,a:S}=this,k=S||1/0;return this.overwriteGetter("rgb",[l/k,h/k,v/k,S])}get hcl(){return this.overwriteGetter("hcl",(function(l){const[h,v,S,k]=Ba(l),R=Math.sqrt(v*v+S*S);return[Math.round(1e4*R)?rs(Math.atan2(S,v)*oo):NaN,R,h,k]})(this.rgb))}get lab(){return this.overwriteGetter("lab",Ba(this.rgb))}overwriteGetter(l,h){return Object.defineProperty(this,l,{value:h}),h}toString(){const[l,h,v,S]=this.rgb;return`rgba(${[l,h,v].map((k=>Math.round(255*k))).join(",")},${S})`}static interpolate(l,h,v,S="rgb"){switch(S){case"rgb":{const[k,R,B,V]=on(l.rgb,h.rgb,v);return new kr(k,R,B,V,!1)}case"hcl":{const[k,R,B,V]=l.hcl,[Z,ie,ce,ve]=h.hcl;let Ee,Ne;if(isNaN(k)||isNaN(Z))isNaN(k)?isNaN(Z)?Ee=NaN:(Ee=Z,B!==1&&B!==0||(Ne=ie)):(Ee=k,ce!==1&&ce!==0||(Ne=R));else{let rt=Z-k;Z>k&&rt>180?rt-=360:Z<k&&k-Z>180&&(rt+=360),Ee=k+v*rt}const[ze,Ve,et,Ct]=(function([rt,ut,Rt,Bt]){return rt=isNaN(rt)?0:rt*ts,Pu([Rt,Math.cos(rt)*ut,Math.sin(rt)*ut,Bt])})([Ee,Ne??Gr(R,ie,v),Gr(B,ce,v),Gr(V,ve,v)]);return new kr(ze,Ve,et,Ct,!1)}case"lab":{const[k,R,B,V]=Pu(on(l.lab,h.lab,v));return new kr(k,R,B,V,!1)}}}}kr.black=new kr(0,0,0,1),kr.white=new kr(1,1,1,1),kr.transparent=new kr(0,0,0,0),kr.red=new kr(1,0,0,1);class ti{constructor(l,h,v){this.sensitivity=l?h?"variant":"case":h?"accent":"base",this.locale=v,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(l,h){return this.collator.compare(l,h)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}const Ri=["bottom","center","top"];class $n{constructor(l,h,v,S,k,R){this.text=l,this.image=h,this.scale=v,this.fontStack=S,this.textColor=k,this.verticalAlign=R}}class _n{constructor(l){this.sections=l}static fromString(l){return new _n([new $n(l,null,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some((l=>l.text.length!==0||l.image&&l.image.name.length!==0))}static factory(l){return l instanceof _n?l:_n.fromString(l)}toString(){return this.sections.length===0?"":this.sections.map((l=>l.text)).join("")}}class Mr{constructor(l){this.values=l.slice()}static parse(l){if(l instanceof Mr)return l;if(typeof l=="number")return new Mr([l,l,l,l]);if(Array.isArray(l)&&!(l.length<1||l.length>4)){for(const h of l)if(typeof h!="number")return;switch(l.length){case 1:l=[l[0],l[0],l[0],l[0]];break;case 2:l=[l[0],l[1],l[0],l[1]];break;case 3:l=[l[0],l[1],l[2],l[1]]}return new Mr(l)}}toString(){return JSON.stringify(this.values)}static interpolate(l,h,v){return new Mr(on(l.values,h.values,v))}}class hn{constructor(l){this.values=l.slice()}static parse(l){if(l instanceof hn)return l;if(typeof l=="number")return new hn([l]);if(Array.isArray(l)){for(const h of l)if(typeof h!="number")return;return new hn(l)}}toString(){return JSON.stringify(this.values)}static interpolate(l,h,v){return new hn(on(l.values,h.values,v))}}class mn{constructor(l){this.values=l.slice()}static parse(l){if(l instanceof mn)return l;if(typeof l=="string"){const v=kr.parse(l);return v?new mn([v]):void 0}if(!Array.isArray(l))return;const h=[];for(const v of l){if(typeof v!="string")return;const S=kr.parse(v);if(!S)return;h.push(S)}return new mn(h)}toString(){return JSON.stringify(this.values)}static interpolate(l,h,v,S="rgb"){const k=[];if(l.values.length!=h.values.length)throw new Error(`colorArray: Arrays have mismatched length (${l.values.length} vs. ${h.values.length}), cannot interpolate.`);for(let R=0;R<l.values.length;R++)k.push(kr.interpolate(l.values[R],h.values[R],v,S));return new mn(k)}}class fi extends Error{constructor(l){super(l),this.name="RuntimeError"}toJSON(){return this.message}}const $i=new Set(["center","left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"]);class ba{constructor(l){this.values=l.slice()}static parse(l){if(l instanceof ba)return l;if(Array.isArray(l)&&!(l.length<1)&&l.length%2==0){for(let h=0;h<l.length;h+=2){const v=l[h],S=l[h+1];if(typeof v!="string"||!$i.has(v)||!Array.isArray(S)||S.length!==2||typeof S[0]!="number"||typeof S[1]!="number")return}return new ba(l)}}toString(){return JSON.stringify(this.values)}static interpolate(l,h,v){const S=l.values,k=h.values;if(S.length!==k.length)throw new fi(`Cannot interpolate values of different length. from: ${l.toString()}, to: ${h.toString()}`);const R=[];for(let B=0;B<S.length;B+=2){if(S[B]!==k[B])throw new fi(`Cannot interpolate values containing mismatched anchors. from[${B}]: ${S[B]}, to[${B}]: ${k[B]}`);R.push(S[B]);const[V,Z]=S[B+1],[ie,ce]=k[B+1];R.push([Gr(V,ie,v),Gr(Z,ce,v)])}return new ba(R)}}class wi{constructor(l){this.name=l.name,this.available=l.available}toString(){return this.name}static fromString(l){return l?new wi({name:l,available:!1}):null}}class hi{constructor(l,h,v){this.from=l,this.to=h,this.transition=v}static interpolate(l,h,v){return new hi(l,h,v)}static parse(l){return l instanceof hi?l:Array.isArray(l)&&l.length===3&&typeof l[0]=="string"&&typeof l[1]=="string"&&typeof l[2]=="number"?new hi(l[0],l[1],l[2]):typeof l=="object"&&typeof l.from=="string"&&typeof l.to=="string"&&typeof l.transition=="number"?new hi(l.from,l.to,l.transition):typeof l=="string"?new hi(l,l,1):void 0}}function Ts(p,l,h,v){return typeof p=="number"&&p>=0&&p<=255&&typeof l=="number"&&l>=0&&l<=255&&typeof h=="number"&&h>=0&&h<=255?v===void 0||typeof v=="number"&&v>=0&&v<=1?null:`Invalid rgba value [${[p,l,h,v].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof v=="number"?[p,l,h,v]:[p,l,h]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function Vs(p){if(p===null||typeof p=="string"||typeof p=="boolean"||typeof p=="number"||p instanceof hi||p instanceof kr||p instanceof ti||p instanceof _n||p instanceof Mr||p instanceof hn||p instanceof mn||p instanceof ba||p instanceof wi)return!0;if(Array.isArray(p)){for(const l of p)if(!Vs(l))return!1;return!0}if(typeof p=="object"){for(const l in p)if(!Vs(p[l]))return!1;return!0}return!1}function Mi(p){if(p===null)return Ci;if(typeof p=="string")return Mn;if(typeof p=="boolean")return Bn;if(typeof p=="number")return Fr;if(p instanceof kr)return ei;if(p instanceof hi)return ua;if(p instanceof ti)return La;if(p instanceof _n)return Wi;if(p instanceof Mr)return hs;if(p instanceof hn)return Mo;if(p instanceof mn)return Ca;if(p instanceof ba)return ol;if(p instanceof wi)return Ya;if(Array.isArray(p)){const l=p.length;let h;for(const v of p){const S=Mi(v);if(h){if(h===S)continue;h=zn;break}h=S}return xi(h||zn,l)}return ha}function Cs(p){const l=typeof p;return p===null?"":l==="string"||l==="number"||l==="boolean"?String(p):p instanceof kr||p instanceof hi||p instanceof _n||p instanceof Mr||p instanceof hn||p instanceof mn||p instanceof ba||p instanceof wi?p.toString():JSON.stringify(p)}class oa{constructor(l,h){this.type=l,this.value=h}static parse(l,h){if(l.length!==2)return h.error(`'literal' expression requires exactly one argument, but found ${l.length-1} instead.`);if(!Vs(l[1]))return h.error("invalid value");const v=l[1];let S=Mi(v);const k=h.expectedType;return S.kind!=="array"||S.N!==0||!k||k.kind!=="array"||typeof k.N=="number"&&k.N!==0||(S=k),new oa(S,v)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}}const ku={string:Mn,number:Fr,boolean:Bn,object:ha};class Ka{constructor(l,h){this.type=l,this.args=h}static parse(l,h){if(l.length<2)return h.error("Expected at least one argument.");let v,S=1;const k=l[0];if(k==="array"){let B,V;if(l.length>2){const Z=l[1];if(typeof Z!="string"||!(Z in ku)||Z==="object")return h.error('The item type argument of "array" must be one of string, number, boolean',1);B=ku[Z],S++}else B=zn;if(l.length>3){if(l[2]!==null&&(typeof l[2]!="number"||l[2]<0||l[2]!==Math.floor(l[2])))return h.error('The length argument to "array" must be a positive integer literal',2);V=l[2],S++}v=xi(B,V)}else{if(!ku[k])throw new Error(`Types doesn't contain name = ${k}`);v=ku[k]}const R=[];for(;S<l.length;S++){const B=h.parse(l[S],S,zn);if(!B)return null;R.push(B)}return new Ka(v,R)}evaluate(l){for(let h=0;h<this.args.length;h++){const v=this.args[h].evaluate(l);if(!ga(this.type,Mi(v)))return v;if(h===this.args.length-1)throw new fi(`Expected value to be of type ${zi(this.type)}, but found ${zi(Mi(v))} instead.`)}throw new Error}eachChild(l){this.args.forEach(l)}outputDefined(){return this.args.every((l=>l.outputDefined()))}}const $s={"to-boolean":Bn,"to-color":ei,"to-number":Fr,"to-string":Mn};class Vo{constructor(l,h){this.type=l,this.args=h}static parse(l,h){if(l.length<2)return h.error("Expected at least one argument.");const v=l[0];if(!$s[v])throw new Error(`Can't parse ${v} as it is not part of the known types`);if((v==="to-boolean"||v==="to-string")&&l.length!==2)return h.error("Expected one argument.");const S=$s[v],k=[];for(let R=1;R<l.length;R++){const B=h.parse(l[R],R,zn);if(!B)return null;k.push(B)}return new Vo(S,k)}evaluate(l){switch(this.type.kind){case"boolean":return!!this.args[0].evaluate(l);case"color":{let h,v;for(const S of this.args){if(h=S.evaluate(l),v=null,h instanceof kr)return h;if(typeof h=="string"){const k=l.parseColor(h);if(k)return k}else if(Array.isArray(h)&&(v=h.length<3||h.length>4?`Invalid rgba value ${JSON.stringify(h)}: expected an array containing either three or four numeric values.`:Ts(h[0],h[1],h[2],h[3]),!v))return new kr(h[0]/255,h[1]/255,h[2]/255,h[3])}throw new fi(v||`Could not parse color from value '${typeof h=="string"?h:JSON.stringify(h)}'`)}case"padding":{let h;for(const v of this.args){h=v.evaluate(l);const S=Mr.parse(h);if(S)return S}throw new fi(`Could not parse padding from value '${typeof h=="string"?h:JSON.stringify(h)}'`)}case"numberArray":{let h;for(const v of this.args){h=v.evaluate(l);const S=hn.parse(h);if(S)return S}throw new fi(`Could not parse numberArray from value '${typeof h=="string"?h:JSON.stringify(h)}'`)}case"colorArray":{let h;for(const v of this.args){h=v.evaluate(l);const S=mn.parse(h);if(S)return S}throw new fi(`Could not parse colorArray from value '${typeof h=="string"?h:JSON.stringify(h)}'`)}case"variableAnchorOffsetCollection":{let h;for(const v of this.args){h=v.evaluate(l);const S=ba.parse(h);if(S)return S}throw new fi(`Could not parse variableAnchorOffsetCollection from value '${typeof h=="string"?h:JSON.stringify(h)}'`)}case"number":{let h=null;for(const v of this.args){if(h=v.evaluate(l),h===null)return 0;const S=Number(h);if(!isNaN(S))return S}throw new fi(`Could not convert ${JSON.stringify(h)} to number.`)}case"formatted":return _n.fromString(Cs(this.args[0].evaluate(l)));case"resolvedImage":return wi.fromString(Cs(this.args[0].evaluate(l)));case"projectionDefinition":return this.args[0].evaluate(l);default:return Cs(this.args[0].evaluate(l))}}eachChild(l){this.args.forEach(l)}outputDefined(){return this.args.every((l=>l.outputDefined()))}}const Ru=["Unknown","Point","LineString","Polygon"];class Mu{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache=new Map,this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?Ru[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(l){let h=this._parseColorCache.get(l);return h||(h=kr.parse(l),this._parseColorCache.set(l,h)),h}}class go{constructor(l,h,v=[],S,k=new Bi,R=[]){this.registry=l,this.path=v,this.key=v.map((B=>`[${B}]`)).join(""),this.scope=k,this.errors=R,this.expectedType=S,this._isConstant=h}parse(l,h,v,S,k={}){return h?this.concat(h,v,S)._parse(l,k):this._parse(l,k)}_parse(l,h){function v(S,k,R){return R==="assert"?new Ka(k,[S]):R==="coerce"?new Vo(k,[S]):S}if(l!==null&&typeof l!="string"&&typeof l!="boolean"&&typeof l!="number"||(l=["literal",l]),Array.isArray(l)){if(l.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const S=l[0];if(typeof S!="string")return this.error(`Expression name must be a string, but found ${typeof S} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const k=this.registry[S];if(k){let R=k.parse(l,this);if(!R)return null;if(this.expectedType){const B=this.expectedType,V=R.type;if(B.kind!=="string"&&B.kind!=="number"&&B.kind!=="boolean"&&B.kind!=="object"&&B.kind!=="array"||V.kind!=="value"){if(B.kind==="projectionDefinition"&&["string","array"].includes(V.kind)||["color","formatted","resolvedImage"].includes(B.kind)&&["value","string"].includes(V.kind)||["padding","numberArray"].includes(B.kind)&&["value","number","array"].includes(V.kind)||B.kind==="colorArray"&&["value","string","array"].includes(V.kind)||B.kind==="variableAnchorOffsetCollection"&&["value","array"].includes(V.kind))R=v(R,B,h.typeAnnotation||"coerce");else if(this.checkSubtype(B,V))return null}else R=v(R,B,h.typeAnnotation||"assert")}if(!(R instanceof oa)&&R.type.kind!=="resolvedImage"&&this._isConstant(R)){const B=new Mu;try{R=new oa(R.type,R.evaluate(B))}catch(V){return this.error(V.message),null}}return R}return this.error(`Unknown expression "${S}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(l===void 0?"'undefined' value invalid. Use null instead.":typeof l=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof l} instead.`)}concat(l,h,v){const S=typeof l=="number"?this.path.concat(l):this.path,k=v?this.scope.concat(v):this.scope;return new go(this.registry,this._isConstant,S,h||null,k,this.errors)}error(l,...h){const v=`${this.key}${h.map((S=>`[${S}]`)).join("")}`;this.errors.push(new Nn(v,l))}checkSubtype(l,h){const v=ga(l,h);return v&&this.error(v),v}}class ji{constructor(l,h){this.type=h.type,this.bindings=[].concat(l),this.result=h}evaluate(l){return this.result.evaluate(l)}eachChild(l){for(const h of this.bindings)l(h[1]);l(this.result)}static parse(l,h){if(l.length<4)return h.error(`Expected at least 3 arguments, but found ${l.length-1} instead.`);const v=[];for(let k=1;k<l.length-1;k+=2){const R=l[k];if(typeof R!="string")return h.error(`Expected string, but found ${typeof R} instead.`,k);if(/[^a-zA-Z0-9_]/.test(R))return h.error("Variable names must contain only alphanumeric characters or '_'.",k);const B=h.parse(l[k+1],k+1);if(!B)return null;v.push([R,B])}const S=h.parse(l[l.length-1],l.length-1,h.expectedType,v);return S?new ji(v,S):null}outputDefined(){return this.result.outputDefined()}}class qs{constructor(l,h){this.type=h.type,this.name=l,this.boundExpression=h}static parse(l,h){if(l.length!==2||typeof l[1]!="string")return h.error("'var' expression requires exactly one string literal argument.");const v=l[1];return h.scope.has(v)?new qs(v,h.scope.get(v)):h.error(`Unknown variable "${v}". Make sure "${v}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(l){return this.boundExpression.evaluate(l)}eachChild(){}outputDefined(){return!1}}class ii{constructor(l,h,v){this.type=l,this.index=h,this.input=v}static parse(l,h){if(l.length!==3)return h.error(`Expected 2 arguments, but found ${l.length-1} instead.`);const v=h.parse(l[1],1,Fr),S=h.parse(l[2],2,xi(h.expectedType||zn));return v&&S?new ii(S.type.itemType,v,S):null}evaluate(l){const h=this.index.evaluate(l),v=this.input.evaluate(l);if(h<0)throw new fi(`Array index out of bounds: ${h} < 0.`);if(h>=v.length)throw new fi(`Array index out of bounds: ${h} > ${v.length-1}.`);if(h!==Math.floor(h))throw new fi(`Array index must be an integer, but found ${h} instead.`);return v[h]}eachChild(l){l(this.index),l(this.input)}outputDefined(){return!1}}class ri{constructor(l,h){this.type=Bn,this.needle=l,this.haystack=h}static parse(l,h){if(l.length!==3)return h.error(`Expected 2 arguments, but found ${l.length-1} instead.`);const v=h.parse(l[1],1,zn),S=h.parse(l[2],2,zn);return v&&S?Za(v.type,[Bn,Mn,Fr,Ci,zn])?new ri(v,S):h.error(`Expected first argument to be of type boolean, string, number or null, but found ${zi(v.type)} instead`):null}evaluate(l){const h=this.needle.evaluate(l),v=this.haystack.evaluate(l);if(!v)return!1;if(!ds(h,["boolean","string","number","null"]))throw new fi(`Expected first argument to be of type boolean, string, number or null, but found ${zi(Mi(h))} instead.`);if(!ds(v,["string","array"]))throw new fi(`Expected second argument to be of type array or string, but found ${zi(Mi(v))} instead.`);return v.indexOf(h)>=0}eachChild(l){l(this.needle),l(this.haystack)}outputDefined(){return!0}}class Do{constructor(l,h,v){this.type=Fr,this.needle=l,this.haystack=h,this.fromIndex=v}static parse(l,h){if(l.length<=2||l.length>=5)return h.error(`Expected 2 or 3 arguments, but found ${l.length-1} instead.`);const v=h.parse(l[1],1,zn),S=h.parse(l[2],2,zn);if(!v||!S)return null;if(!Za(v.type,[Bn,Mn,Fr,Ci,zn]))return h.error(`Expected first argument to be of type boolean, string, number or null, but found ${zi(v.type)} instead`);if(l.length===4){const k=h.parse(l[3],3,Fr);return k?new Do(v,S,k):null}return new Do(v,S)}evaluate(l){const h=this.needle.evaluate(l),v=this.haystack.evaluate(l);if(!ds(h,["boolean","string","number","null"]))throw new fi(`Expected first argument to be of type boolean, string, number or null, but found ${zi(Mi(h))} instead.`);let S;if(this.fromIndex&&(S=this.fromIndex.evaluate(l)),ds(v,["string"])){const k=v.indexOf(h,S);return k===-1?-1:[...v.slice(0,k)].length}if(ds(v,["array"]))return v.indexOf(h,S);throw new fi(`Expected second argument to be of type array or string, but found ${zi(Mi(v))} instead.`)}eachChild(l){l(this.needle),l(this.haystack),this.fromIndex&&l(this.fromIndex)}outputDefined(){return!1}}class ai{constructor(l,h,v,S,k,R){this.inputType=l,this.type=h,this.input=v,this.cases=S,this.outputs=k,this.otherwise=R}static parse(l,h){if(l.length<5)return h.error(`Expected at least 4 arguments, but found only ${l.length-1}.`);if(l.length%2!=1)return h.error("Expected an even number of arguments.");let v,S;h.expectedType&&h.expectedType.kind!=="value"&&(S=h.expectedType);const k={},R=[];for(let Z=2;Z<l.length-1;Z+=2){let ie=l[Z];const ce=l[Z+1];Array.isArray(ie)||(ie=[ie]);const ve=h.concat(Z);if(ie.length===0)return ve.error("Expected at least one branch label.");for(const Ne of ie){if(typeof Ne!="number"&&typeof Ne!="string")return ve.error("Branch labels must be numbers or strings.");if(typeof Ne=="number"&&Math.abs(Ne)>Number.MAX_SAFE_INTEGER)return ve.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof Ne=="number"&&Math.floor(Ne)!==Ne)return ve.error("Numeric branch labels must be integer values.");if(v){if(ve.checkSubtype(v,Mi(Ne)))return null}else v=Mi(Ne);if(k[String(Ne)]!==void 0)return ve.error("Branch labels must be unique.");k[String(Ne)]=R.length}const Ee=h.parse(ce,Z,S);if(!Ee)return null;S=S||Ee.type,R.push(Ee)}const B=h.parse(l[1],1,zn);if(!B)return null;const V=h.parse(l[l.length-1],l.length-1,S);return V?B.type.kind!=="value"&&h.concat(1).checkSubtype(v,B.type)?null:new ai(v,S,B,k,R,V):null}evaluate(l){const h=this.input.evaluate(l);return(Mi(h)===this.inputType&&this.outputs[this.cases[h]]||this.otherwise).evaluate(l)}eachChild(l){l(this.input),this.outputs.forEach(l),l(this.otherwise)}outputDefined(){return this.outputs.every((l=>l.outputDefined()))&&this.otherwise.outputDefined()}}class ue{constructor(l,h,v){this.type=l,this.branches=h,this.otherwise=v}static parse(l,h){if(l.length<4)return h.error(`Expected at least 3 arguments, but found only ${l.length-1}.`);if(l.length%2!=0)return h.error("Expected an odd number of arguments.");let v;h.expectedType&&h.expectedType.kind!=="value"&&(v=h.expectedType);const S=[];for(let R=1;R<l.length-1;R+=2){const B=h.parse(l[R],R,Bn);if(!B)return null;const V=h.parse(l[R+1],R+1,v);if(!V)return null;S.push([B,V]),v=v||V.type}const k=h.parse(l[l.length-1],l.length-1,v);if(!k)return null;if(!v)throw new Error("Can't infer output type");return new ue(v,S,k)}evaluate(l){for(const[h,v]of this.branches)if(h.evaluate(l))return v.evaluate(l);return this.otherwise.evaluate(l)}eachChild(l){for(const[h,v]of this.branches)l(h),l(v);l(this.otherwise)}outputDefined(){return this.branches.every((([l,h])=>h.outputDefined()))&&this.otherwise.outputDefined()}}class We{constructor(l,h,v,S){this.type=l,this.input=h,this.beginIndex=v,this.endIndex=S}static parse(l,h){if(l.length<=2||l.length>=5)return h.error(`Expected 2 or 3 arguments, but found ${l.length-1} instead.`);const v=h.parse(l[1],1,zn),S=h.parse(l[2],2,Fr);if(!v||!S)return null;if(!Za(v.type,[xi(zn),Mn,zn]))return h.error(`Expected first argument to be of type array or string, but found ${zi(v.type)} instead`);if(l.length===4){const k=h.parse(l[3],3,Fr);return k?new We(v.type,v,S,k):null}return new We(v.type,v,S)}evaluate(l){const h=this.input.evaluate(l),v=this.beginIndex.evaluate(l);let S;if(this.endIndex&&(S=this.endIndex.evaluate(l)),ds(h,["string"]))return[...h].slice(v,S).join("");if(ds(h,["array"]))return h.slice(v,S);throw new fi(`Expected first argument to be of type array or string, but found ${zi(Mi(h))} instead.`)}eachChild(l){l(this.input),l(this.beginIndex),this.endIndex&&l(this.endIndex)}outputDefined(){return!1}}function bt(p,l){const h=p.length-1;let v,S,k=0,R=h,B=0;for(;k<=R;)if(B=Math.floor((k+R)/2),v=p[B],S=p[B+1],v<=l){if(B===h||l<S)return B;k=B+1}else{if(!(v>l))throw new fi("Input is not a number.");R=B-1}return 0}class zt{constructor(l,h,v){this.type=l,this.input=h,this.labels=[],this.outputs=[];for(const[S,k]of v)this.labels.push(S),this.outputs.push(k)}static parse(l,h){if(l.length-1<4)return h.error(`Expected at least 4 arguments, but found only ${l.length-1}.`);if((l.length-1)%2!=0)return h.error("Expected an even number of arguments.");const v=h.parse(l[1],1,Fr);if(!v)return null;const S=[];let k=null;h.expectedType&&h.expectedType.kind!=="value"&&(k=h.expectedType);for(let R=1;R<l.length;R+=2){const B=R===1?-1/0:l[R],V=l[R+1],Z=R,ie=R+1;if(typeof B!="number")return h.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',Z);if(S.length&&S[S.length-1][0]>=B)return h.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',Z);const ce=h.parse(V,ie,k);if(!ce)return null;k=k||ce.type,S.push([B,ce])}return new zt(k,v,S)}evaluate(l){const h=this.labels,v=this.outputs;if(h.length===1)return v[0].evaluate(l);const S=this.input.evaluate(l);if(S<=h[0])return v[0].evaluate(l);const k=h.length;return S>=h[k-1]?v[k-1].evaluate(l):v[bt(h,S)].evaluate(l)}eachChild(l){l(this.input);for(const h of this.outputs)l(h)}outputDefined(){return this.outputs.every((l=>l.outputDefined()))}}function lr(p){return p&&p.__esModule&&Object.prototype.hasOwnProperty.call(p,"default")?p.default:p}var Nr,Zr,Ln=(function(){if(Zr)return Nr;function p(l,h,v,S){this.cx=3*l,this.bx=3*(v-l)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*h,this.by=3*(S-h)-this.cy,this.ay=1-this.cy-this.by,this.p1x=l,this.p1y=h,this.p2x=v,this.p2y=S}return Zr=1,Nr=p,p.prototype={sampleCurveX:function(l){return((this.ax*l+this.bx)*l+this.cx)*l},sampleCurveY:function(l){return((this.ay*l+this.by)*l+this.cy)*l},sampleCurveDerivativeX:function(l){return(3*this.ax*l+2*this.bx)*l+this.cx},solveCurveX:function(l,h){if(h===void 0&&(h=1e-6),l<0)return 0;if(l>1)return 1;for(var v=l,S=0;S<8;S++){var k=this.sampleCurveX(v)-l;if(Math.abs(k)<h)return v;var R=this.sampleCurveDerivativeX(v);if(Math.abs(R)<1e-6)break;v-=k/R}var B=0,V=1;for(v=l,S=0;S<20&&(k=this.sampleCurveX(v),!(Math.abs(k-l)<h));S++)l>k?B=v:V=v,v=.5*(V-B)+B;return v},solve:function(l,h){return this.sampleCurveY(this.solveCurveX(l,h))}},Nr})(),qn=lr(Ln);class Un{constructor(l,h,v,S,k){this.type=l,this.operator=h,this.interpolation=v,this.input=S,this.labels=[],this.outputs=[];for(const[R,B]of k)this.labels.push(R),this.outputs.push(B)}static interpolationFactor(l,h,v,S){let k=0;if(l.name==="exponential")k=ui(h,l.base,v,S);else if(l.name==="linear")k=ui(h,1,v,S);else if(l.name==="cubic-bezier"){const R=l.controlPoints;k=new qn(R[0],R[1],R[2],R[3]).solve(ui(h,1,v,S))}return k}static parse(l,h){let[v,S,k,...R]=l;if(!Array.isArray(S)||S.length===0)return h.error("Expected an interpolation type expression.",1);if(S[0]==="linear")S={name:"linear"};else if(S[0]==="exponential"){const Z=S[1];if(typeof Z!="number")return h.error("Exponential interpolation requires a numeric base.",1,1);S={name:"exponential",base:Z}}else{if(S[0]!=="cubic-bezier")return h.error(`Unknown interpolation type ${String(S[0])}`,1,0);{const Z=S.slice(1);if(Z.length!==4||Z.some((ie=>typeof ie!="number"||ie<0||ie>1)))return h.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);S={name:"cubic-bezier",controlPoints:Z}}}if(l.length-1<4)return h.error(`Expected at least 4 arguments, but found only ${l.length-1}.`);if((l.length-1)%2!=0)return h.error("Expected an even number of arguments.");if(k=h.parse(k,2,Fr),!k)return null;const B=[];let V=null;v!=="interpolate-hcl"&&v!=="interpolate-lab"||h.expectedType==Ca?h.expectedType&&h.expectedType.kind!=="value"&&(V=h.expectedType):V=ei;for(let Z=0;Z<R.length;Z+=2){const ie=R[Z],ce=R[Z+1],ve=Z+3,Ee=Z+4;if(typeof ie!="number")return h.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',ve);if(B.length&&B[B.length-1][0]>=ie)return h.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',ve);const Ne=h.parse(ce,Ee,V);if(!Ne)return null;V=V||Ne.type,B.push([ie,Ne])}return Aa(V,Fr)||Aa(V,ua)||Aa(V,ei)||Aa(V,hs)||Aa(V,Mo)||Aa(V,Ca)||Aa(V,ol)||Aa(V,xi(Fr))?new Un(V,v,S,k,B):h.error(`Type ${zi(V)} is not interpolatable.`)}evaluate(l){const h=this.labels,v=this.outputs;if(h.length===1)return v[0].evaluate(l);const S=this.input.evaluate(l);if(S<=h[0])return v[0].evaluate(l);const k=h.length;if(S>=h[k-1])return v[k-1].evaluate(l);const R=bt(h,S),B=Un.interpolationFactor(this.interpolation,S,h[R],h[R+1]),V=v[R].evaluate(l),Z=v[R+1].evaluate(l);switch(this.operator){case"interpolate":switch(this.type.kind){case"number":return Gr(V,Z,B);case"color":return kr.interpolate(V,Z,B);case"padding":return Mr.interpolate(V,Z,B);case"colorArray":return mn.interpolate(V,Z,B);case"numberArray":return hn.interpolate(V,Z,B);case"variableAnchorOffsetCollection":return ba.interpolate(V,Z,B);case"array":return on(V,Z,B);case"projectionDefinition":return hi.interpolate(V,Z,B)}case"interpolate-hcl":switch(this.type.kind){case"color":return kr.interpolate(V,Z,B,"hcl");case"colorArray":return mn.interpolate(V,Z,B,"hcl")}case"interpolate-lab":switch(this.type.kind){case"color":return kr.interpolate(V,Z,B,"lab");case"colorArray":return mn.interpolate(V,Z,B,"lab")}}}eachChild(l){l(this.input);for(const h of this.outputs)l(h)}outputDefined(){return this.outputs.every((l=>l.outputDefined()))}}function ui(p,l,h,v){const S=v-h,k=p-h;return S===0?0:l===1?k/S:(Math.pow(l,k)-1)/(Math.pow(l,S)-1)}const Hn={color:kr.interpolate,number:Gr,padding:Mr.interpolate,numberArray:hn.interpolate,colorArray:mn.interpolate,variableAnchorOffsetCollection:ba.interpolate,array:on};class Ui{constructor(l,h){this.type=l,this.args=h}static parse(l,h){if(l.length<2)return h.error("Expected at least one argument.");let v=null;const S=h.expectedType;S&&S.kind!=="value"&&(v=S);const k=[];for(const B of l.slice(1)){const V=h.parse(B,1+k.length,v,void 0,{typeAnnotation:"omit"});if(!V)return null;v=v||V.type,k.push(V)}if(!v)throw new Error("No output type");const R=S&&k.some((B=>ga(S,B.type)));return new Ui(R?zn:v,k)}evaluate(l){let h,v=null,S=0;for(const k of this.args)if(S++,v=k.evaluate(l),v&&v instanceof wi&&!v.available&&(h||(h=v.name),v=null,S===this.args.length&&(v=h)),v!==null)break;return v}eachChild(l){this.args.forEach(l)}outputDefined(){return this.args.every((l=>l.outputDefined()))}}function Xi(p,l){return p==="=="||p==="!="?l.kind==="boolean"||l.kind==="string"||l.kind==="number"||l.kind==="null"||l.kind==="value":l.kind==="string"||l.kind==="number"||l.kind==="value"}function ra(p,l,h,v){return v.compare(l,h)===0}function Si(p,l,h){const v=p!=="=="&&p!=="!=";return class GW{constructor(k,R,B){this.type=Bn,this.lhs=k,this.rhs=R,this.collator=B,this.hasUntypedArgument=k.type.kind==="value"||R.type.kind==="value"}static parse(k,R){if(k.length!==3&&k.length!==4)return R.error("Expected two or three arguments.");const B=k[0];let V=R.parse(k[1],1,zn);if(!V)return null;if(!Xi(B,V.type))return R.concat(1).error(`"${B}" comparisons are not supported for type '${zi(V.type)}'.`);let Z=R.parse(k[2],2,zn);if(!Z)return null;if(!Xi(B,Z.type))return R.concat(2).error(`"${B}" comparisons are not supported for type '${zi(Z.type)}'.`);if(V.type.kind!==Z.type.kind&&V.type.kind!=="value"&&Z.type.kind!=="value")return R.error(`Cannot compare types '${zi(V.type)}' and '${zi(Z.type)}'.`);v&&(V.type.kind==="value"&&Z.type.kind!=="value"?V=new Ka(Z.type,[V]):V.type.kind!=="value"&&Z.type.kind==="value"&&(Z=new Ka(V.type,[Z])));let ie=null;if(k.length===4){if(V.type.kind!=="string"&&Z.type.kind!=="string"&&V.type.kind!=="value"&&Z.type.kind!=="value")return R.error("Cannot use collator to compare non-string types.");if(ie=R.parse(k[3],3,La),!ie)return null}return new GW(V,Z,ie)}evaluate(k){const R=this.lhs.evaluate(k),B=this.rhs.evaluate(k);if(v&&this.hasUntypedArgument){const V=Mi(R),Z=Mi(B);if(V.kind!==Z.kind||V.kind!=="string"&&V.kind!=="number")throw new fi(`Expected arguments for "${p}" to be (string, string) or (number, number), but found (${V.kind}, ${Z.kind}) instead.`)}if(this.collator&&!v&&this.hasUntypedArgument){const V=Mi(R),Z=Mi(B);if(V.kind!=="string"||Z.kind!=="string")return l(k,R,B)}return this.collator?h(k,R,B,this.collator.evaluate(k)):l(k,R,B)}eachChild(k){k(this.lhs),k(this.rhs),this.collator&&k(this.collator)}outputDefined(){return!0}}}const Ia=Si("==",(function(p,l,h){return l===h}),ra),za=Si("!=",(function(p,l,h){return l!==h}),(function(p,l,h,v){return!ra(0,l,h,v)})),Hs=Si("<",(function(p,l,h){return l<h}),(function(p,l,h,v){return v.compare(l,h)<0})),ll=Si(">",(function(p,l,h){return l>h}),(function(p,l,h,v){return v.compare(l,h)>0})),Gs=Si("<=",(function(p,l,h){return l<=h}),(function(p,l,h,v){return v.compare(l,h)<=0})),$o=Si(">=",(function(p,l,h){return l>=h}),(function(p,l,h,v){return v.compare(l,h)>=0}));class Ws{constructor(l,h,v){this.type=La,this.locale=v,this.caseSensitive=l,this.diacriticSensitive=h}static parse(l,h){if(l.length!==2)return h.error("Expected one argument.");const v=l[1];if(typeof v!="object"||Array.isArray(v))return h.error("Collator options argument must be an object.");const S=h.parse(v["case-sensitive"]!==void 0&&v["case-sensitive"],1,Bn);if(!S)return null;const k=h.parse(v["diacritic-sensitive"]!==void 0&&v["diacritic-sensitive"],1,Bn);if(!k)return null;let R=null;return v.locale&&(R=h.parse(v.locale,1,Mn),!R)?null:new Ws(S,k,R)}evaluate(l){return new ti(this.caseSensitive.evaluate(l),this.diacriticSensitive.evaluate(l),this.locale?this.locale.evaluate(l):null)}eachChild(l){l(this.caseSensitive),l(this.diacriticSensitive),this.locale&&l(this.locale)}outputDefined(){return!1}}class Pa{constructor(l,h,v,S,k){this.type=Mn,this.number=l,this.locale=h,this.currency=v,this.minFractionDigits=S,this.maxFractionDigits=k}static parse(l,h){if(l.length!==3)return h.error("Expected two arguments.");const v=h.parse(l[1],1,Fr);if(!v)return null;const S=l[2];if(typeof S!="object"||Array.isArray(S))return h.error("NumberFormat options argument must be an object.");let k=null;if(S.locale&&(k=h.parse(S.locale,1,Mn),!k))return null;let R=null;if(S.currency&&(R=h.parse(S.currency,1,Mn),!R))return null;let B=null;if(S["min-fraction-digits"]&&(B=h.parse(S["min-fraction-digits"],1,Fr),!B))return null;let V=null;return S["max-fraction-digits"]&&(V=h.parse(S["max-fraction-digits"],1,Fr),!V)?null:new Pa(v,k,R,B,V)}evaluate(l){return new Intl.NumberFormat(this.locale?this.locale.evaluate(l):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(l):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(l):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(l):void 0}).format(this.number.evaluate(l))}eachChild(l){l(this.number),this.locale&&l(this.locale),this.currency&&l(this.currency),this.minFractionDigits&&l(this.minFractionDigits),this.maxFractionDigits&&l(this.maxFractionDigits)}outputDefined(){return!1}}class Xs{constructor(l){this.type=Wi,this.sections=l}static parse(l,h){if(l.length<2)return h.error("Expected at least one argument.");const v=l[1];if(!Array.isArray(v)&&typeof v=="object")return h.error("First argument must be an image or text section.");const S=[];let k=!1;for(let R=1;R<=l.length-1;++R){const B=l[R];if(k&&typeof B=="object"&&!Array.isArray(B)){k=!1;let V=null;if(B["font-scale"]&&(V=h.parse(B["font-scale"],1,Fr),!V))return null;let Z=null;if(B["text-font"]&&(Z=h.parse(B["text-font"],1,xi(Mn)),!Z))return null;let ie=null;if(B["text-color"]&&(ie=h.parse(B["text-color"],1,ei),!ie))return null;let ce=null;if(B["vertical-align"]){if(typeof B["vertical-align"]=="string"&&!Ri.includes(B["vertical-align"]))return h.error(`'vertical-align' must be one of: 'bottom', 'center', 'top' but found '${B["vertical-align"]}' instead.`);if(ce=h.parse(B["vertical-align"],1,Mn),!ce)return null}const ve=S[S.length-1];ve.scale=V,ve.font=Z,ve.textColor=ie,ve.verticalAlign=ce}else{const V=h.parse(l[R],1,zn);if(!V)return null;const Z=V.type.kind;if(Z!=="string"&&Z!=="value"&&Z!=="null"&&Z!=="resolvedImage")return h.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");k=!0,S.push({content:V,scale:null,font:null,textColor:null,verticalAlign:null})}}return new Xs(S)}evaluate(l){return new _n(this.sections.map((h=>{const v=h.content.evaluate(l);return Mi(v)===Ya?new $n("",v,null,null,null,h.verticalAlign?h.verticalAlign.evaluate(l):null):new $n(Cs(v),null,h.scale?h.scale.evaluate(l):null,h.font?h.font.evaluate(l).join(","):null,h.textColor?h.textColor.evaluate(l):null,h.verticalAlign?h.verticalAlign.evaluate(l):null)})))}eachChild(l){for(const h of this.sections)l(h.content),h.scale&&l(h.scale),h.font&&l(h.font),h.textColor&&l(h.textColor),h.verticalAlign&&l(h.verticalAlign)}outputDefined(){return!1}}class Il{constructor(l){this.type=Ya,this.input=l}static parse(l,h){if(l.length!==2)return h.error("Expected two arguments.");const v=h.parse(l[1],1,Mn);return v?new Il(v):h.error("No image name provided.")}evaluate(l){const h=this.input.evaluate(l),v=wi.fromString(h);return v&&l.availableImages&&(v.available=l.availableImages.indexOf(h)>-1),v}eachChild(l){l(this.input)}outputDefined(){return!1}}class gs{constructor(l){this.type=Fr,this.input=l}static parse(l,h){if(l.length!==2)return h.error(`Expected 1 argument, but found ${l.length-1} instead.`);const v=h.parse(l[1],1);return v?v.type.kind!=="array"&&v.type.kind!=="string"&&v.type.kind!=="value"?h.error(`Expected argument of type string or array, but found ${zi(v.type)} instead.`):new gs(v):null}evaluate(l){const h=this.input.evaluate(l);if(typeof h=="string")return[...h].length;if(Array.isArray(h))return h.length;throw new fi(`Expected value to be of type string or array, but found ${zi(Mi(h))} instead.`)}eachChild(l){l(this.input)}outputDefined(){return!1}}const Di=8192;function qo(p,l){const h=(180+p[0])/360,v=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+p[1]*Math.PI/360)))/360,S=Math.pow(2,l.z);return[Math.round(h*S*Di),Math.round(v*S*Di)]}function Da(p,l){const h=Math.pow(2,l.z);return[(S=(p[0]/Di+l.x)/h,360*S-180),(v=(p[1]/Di+l.y)/h,360/Math.PI*Math.atan(Math.exp((180-360*v)*Math.PI/180))-90)];var v,S}function ns(p,l){p[0]=Math.min(p[0],l[0]),p[1]=Math.min(p[1],l[1]),p[2]=Math.max(p[2],l[0]),p[3]=Math.max(p[3],l[1])}function As(p,l){return!(p[0]<=l[0]||p[2]>=l[2]||p[1]<=l[1]||p[3]>=l[3])}function Ja(p,l,h){const v=p[0]-l[0],S=p[1]-l[1],k=p[0]-h[0],R=p[1]-h[1];return v*R-k*S==0&&v*k<=0&&S*R<=0}function rc(p,l,h,v){return(S=[v[0]-h[0],v[1]-h[1]])[0]*(k=[l[0]-p[0],l[1]-p[1]])[1]-S[1]*k[0]!=0&&!(!ic(p,l,h,v)||!ic(h,v,p,l));var S,k}function uu(p,l,h){for(const v of h)for(let S=0;S<v.length-1;++S)if(rc(p,l,v[S],v[S+1]))return!0;return!1}function Ys(p,l,h=!1){let v=!1;for(const B of l)for(let V=0;V<B.length-1;V++){if(Ja(p,B[V],B[V+1]))return h;(k=B[V])[1]>(S=p)[1]!=(R=B[V+1])[1]>S[1]&&S[0]<(R[0]-k[0])*(S[1]-k[1])/(R[1]-k[1])+k[0]&&(v=!v)}var S,k,R;return v}function ja(p,l){for(const h of l)if(Ys(p,h))return!0;return!1}function Is(p,l){for(const h of p)if(!Ys(h,l))return!1;for(let h=0;h<p.length-1;++h)if(uu(p[h],p[h+1],l))return!1;return!0}function nc(p,l){for(const h of l)if(Is(p,h))return!0;return!1}function ic(p,l,h,v){const S=v[0]-h[0],k=v[1]-h[1],R=(p[0]-h[0])*k-S*(p[1]-h[1]),B=(l[0]-h[0])*k-S*(l[1]-h[1]);return R>0&&B<0||R<0&&B>0}function ul(p,l,h){const v=[];for(let S=0;S<p.length;S++){const k=[];for(let R=0;R<p[S].length;R++){const B=qo(p[S][R],h);ns(l,B),k.push(B)}v.push(k)}return v}function cu(p,l,h){const v=[];for(let S=0;S<p.length;S++){const k=ul(p[S],l,h);v.push(k)}return v}function Oo(p,l,h,v){if(p[0]<h[0]||p[0]>h[2]){const S=.5*v;let k=p[0]-h[0]>S?-v:h[0]-p[0]>S?v:0;k===0&&(k=p[0]-h[2]>S?-v:h[2]-p[0]>S?v:0),p[0]+=k}ns(l,p)}function mo(p,l,h,v){const S=Math.pow(2,v.z)*Di,k=[v.x*Di,v.y*Di],R=[];for(const B of p)for(const V of B){const Z=[V.x+k[0],V.y+k[1]];Oo(Z,l,h,S),R.push(Z)}return R}function Du(p,l,h,v){const S=Math.pow(2,v.z)*Di,k=[v.x*Di,v.y*Di],R=[];for(const V of p){const Z=[];for(const ie of V){const ce=[ie.x+k[0],ie.y+k[1]];ns(l,ce),Z.push(ce)}R.push(Z)}if(l[2]-l[0]<=S/2){(B=l)[0]=B[1]=1/0,B[2]=B[3]=-1/0;for(const V of R)for(const Z of V)Oo(Z,l,h,S)}var B;return R}class Ua{constructor(l,h){this.type=Bn,this.geojson=l,this.geometries=h}static parse(l,h){if(l.length!==2)return h.error(`'within' expression requires exactly one argument, but found ${l.length-1} instead.`);if(Vs(l[1])){const v=l[1];if(v.type==="FeatureCollection"){const S=[];for(const k of v.features){const{type:R,coordinates:B}=k.geometry;R==="Polygon"&&S.push(B),R==="MultiPolygon"&&S.push(...B)}if(S.length)return new Ua(v,{type:"MultiPolygon",coordinates:S})}else if(v.type==="Feature"){const S=v.geometry.type;if(S==="Polygon"||S==="MultiPolygon")return new Ua(v,v.geometry)}else if(v.type==="Polygon"||v.type==="MultiPolygon")return new Ua(v,v)}return h.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(l){if(l.geometry()!=null&&l.canonicalID()!=null){if(l.geometryType()==="Point")return(function(h,v){const S=[1/0,1/0,-1/0,-1/0],k=[1/0,1/0,-1/0,-1/0],R=h.canonicalID();if(v.type==="Polygon"){const B=ul(v.coordinates,k,R),V=mo(h.geometry(),S,k,R);if(!As(S,k))return!1;for(const Z of V)if(!Ys(Z,B))return!1}if(v.type==="MultiPolygon"){const B=cu(v.coordinates,k,R),V=mo(h.geometry(),S,k,R);if(!As(S,k))return!1;for(const Z of V)if(!ja(Z,B))return!1}return!0})(l,this.geometries);if(l.geometryType()==="LineString")return(function(h,v){const S=[1/0,1/0,-1/0,-1/0],k=[1/0,1/0,-1/0,-1/0],R=h.canonicalID();if(v.type==="Polygon"){const B=ul(v.coordinates,k,R),V=Du(h.geometry(),S,k,R);if(!As(S,k))return!1;for(const Z of V)if(!Is(Z,B))return!1}if(v.type==="MultiPolygon"){const B=cu(v.coordinates,k,R),V=Du(h.geometry(),S,k,R);if(!As(S,k))return!1;for(const Z of V)if(!nc(Z,B))return!1}return!0})(l,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}}let fu=class{constructor(p=[],l=(h,v)=>h<v?-1:h>v?1:0){if(this.data=p,this.length=this.data.length,this.compare=l,this.length>0)for(let h=(this.length>>1)-1;h>=0;h--)this._down(h)}push(p){this.data.push(p),this._up(this.length++)}pop(){if(this.length===0)return;const p=this.data[0],l=this.data.pop();return--this.length>0&&(this.data[0]=l,this._down(0)),p}peek(){return this.data[0]}_up(p){const{data:l,compare:h}=this,v=l[p];for(;p>0;){const S=p-1>>1,k=l[S];if(h(v,k)>=0)break;l[p]=k,p=S}l[p]=v}_down(p){const{data:l,compare:h}=this,v=this.length>>1,S=l[p];for(;p<v;){let k=1+(p<<1);const R=k+1;if(R<this.length&&h(l[R],l[k])<0&&(k=R),h(l[k],S)>=0)break;l[p]=l[k],p=k}l[p]=S}};function Zs(p,l,h=0,v=p.length-1,S=Va){for(;v>h;){if(v-h>600){const V=v-h+1,Z=l-h+1,ie=Math.log(V),ce=.5*Math.exp(2*ie/3),ve=.5*Math.sqrt(ie*ce*(V-ce)/V)*(Z-V/2<0?-1:1);Zs(p,l,Math.max(h,Math.floor(l-Z*ce/V+ve)),Math.min(v,Math.floor(l+(V-Z)*ce/V+ve)),S)}const k=p[l];let R=h,B=v;for(ms(p,h,l),S(p[v],k)>0&&ms(p,h,v);R<B;){for(ms(p,R,B),R++,B--;S(p[R],k)<0;)R++;for(;S(p[B],k)>0;)B--}S(p[h],k)===0?ms(p,h,B):(B++,ms(p,B,v)),B<=l&&(h=B+1),l<=B&&(v=B-1)}}function ms(p,l,h){const v=p[l];p[l]=p[h],p[h]=v}function Va(p,l){return p<l?-1:p>l?1:0}function Vl(p,l){if(p.length<=1)return[p];const h=[];let v,S;for(const k of p){const R=fl(k);R!==0&&(k.area=Math.abs(R),S===void 0&&(S=R<0),S===R<0?(v&&h.push(v),v=[k]):v.push(k))}if(v&&h.push(v),l>1)for(let k=0;k<h.length;k++)h[k].length<=l||(Zs(h[k],l,1,h[k].length-1,cl),h[k]=h[k].slice(0,l));return h}function cl(p,l){return l.area-p.area}function fl(p){let l=0;for(let h,v,S=0,k=p.length,R=k-1;S<k;R=S++)h=p[S],v=p[R],l+=(v.x-h.x)*(h.y+v.y);return l}const $l=1/298.257223563,ql=$l*(2-$l),hl=Math.PI/180;class Hl{constructor(l){const h=6378.137*hl*1e3,v=Math.cos(l*hl),S=1/(1-ql*(1-v*v)),k=Math.sqrt(S);this.kx=h*k*v,this.ky=h*k*S*(1-ql)}distance(l,h){const v=this.wrap(l[0]-h[0])*this.kx,S=(l[1]-h[1])*this.ky;return Math.sqrt(v*v+S*S)}pointOnLine(l,h){let v,S,k,R,B=1/0;for(let V=0;V<l.length-1;V++){let Z=l[V][0],ie=l[V][1],ce=this.wrap(l[V+1][0]-Z)*this.kx,ve=(l[V+1][1]-ie)*this.ky,Ee=0;ce===0&&ve===0||(Ee=(this.wrap(h[0]-Z)*this.kx*ce+(h[1]-ie)*this.ky*ve)/(ce*ce+ve*ve),Ee>1?(Z=l[V+1][0],ie=l[V+1][1]):Ee>0&&(Z+=ce/this.kx*Ee,ie+=ve/this.ky*Ee)),ce=this.wrap(h[0]-Z)*this.kx,ve=(h[1]-ie)*this.ky;const Ne=ce*ce+ve*ve;Ne<B&&(B=Ne,v=Z,S=ie,k=V,R=Ee)}return{point:[v,S],index:k,t:Math.max(0,Math.min(1,R))}}wrap(l){for(;l<-180;)l+=360;for(;l>180;)l-=360;return l}}function Ou(p,l){return l[0]-p[0]}function tr(p){return p[1]-p[0]+1}function vr(p,l){return p[1]>=p[0]&&p[1]<l}function dn(p,l){if(p[0]>p[1])return[null,null];const h=tr(p);if(l){if(h===2)return[p,null];const S=Math.floor(h/2);return[[p[0],p[0]+S],[p[0]+S,p[1]]]}if(h===1)return[p,null];const v=Math.floor(h/2)-1;return[[p[0],p[0]+v],[p[0]+v+1,p[1]]]}function In(p,l){if(!vr(l,p.length))return[1/0,1/0,-1/0,-1/0];const h=[1/0,1/0,-1/0,-1/0];for(let v=l[0];v<=l[1];++v)ns(h,p[v]);return h}function vi(p){const l=[1/0,1/0,-1/0,-1/0];for(const h of p)for(const v of h)ns(l,v);return l}function Pn(p){return p[0]!==-1/0&&p[1]!==-1/0&&p[2]!==1/0&&p[3]!==1/0}function I(p,l,h){if(!Pn(p)||!Pn(l))return NaN;let v=0,S=0;return p[2]<l[0]&&(v=l[0]-p[2]),p[0]>l[2]&&(v=p[0]-l[2]),p[1]>l[3]&&(S=p[1]-l[3]),p[3]<l[1]&&(S=l[1]-p[3]),h.distance([0,0],[v,S])}function y(p,l,h){const v=h.pointOnLine(l,p);return h.distance(p,v.point)}function _(p,l,h,v,S){const k=Math.min(y(p,[h,v],S),y(l,[h,v],S)),R=Math.min(y(h,[p,l],S),y(v,[p,l],S));return Math.min(k,R)}function P(p,l,h,v,S){if(!vr(l,p.length)||!vr(v,h.length))return 1/0;let k=1/0;for(let R=l[0];R<l[1];++R){const B=p[R],V=p[R+1];for(let Z=v[0];Z<v[1];++Z){const ie=h[Z],ce=h[Z+1];if(rc(B,V,ie,ce))return 0;k=Math.min(k,_(B,V,ie,ce,S))}}return k}function $(p,l,h,v,S){if(!vr(l,p.length)||!vr(v,h.length))return NaN;let k=1/0;for(let R=l[0];R<=l[1];++R)for(let B=v[0];B<=v[1];++B)if(k=Math.min(k,S.distance(p[R],h[B])),k===0)return k;return k}function ne(p,l,h){if(Ys(p,l,!0))return 0;let v=1/0;for(const S of l){const k=S[0],R=S[S.length-1];if(k!==R&&(v=Math.min(v,y(p,[R,k],h)),v===0))return v;const B=h.pointOnLine(S,p);if(v=Math.min(v,h.distance(p,B.point)),v===0)return v}return v}function me(p,l,h,v){if(!vr(l,p.length))return NaN;for(let k=l[0];k<=l[1];++k)if(Ys(p[k],h,!0))return 0;let S=1/0;for(let k=l[0];k<l[1];++k){const R=p[k],B=p[k+1];for(const V of h)for(let Z=0,ie=V.length,ce=ie-1;Z<ie;ce=Z++){const ve=V[ce],Ee=V[Z];if(rc(R,B,ve,Ee))return 0;S=Math.min(S,_(R,B,ve,Ee,v))}}return S}function Oe(p,l){for(const h of p)for(const v of h)if(Ys(v,l,!0))return!0;return!1}function tt(p,l,h,v=1/0){const S=vi(p),k=vi(l);if(v!==1/0&&I(S,k,h)>=v)return v;if(As(S,k)){if(Oe(p,l))return 0}else if(Oe(l,p))return 0;let R=1/0;for(const B of p)for(let V=0,Z=B.length,ie=Z-1;V<Z;ie=V++){const ce=B[ie],ve=B[V];for(const Ee of l)for(let Ne=0,ze=Ee.length,Ve=ze-1;Ne<ze;Ve=Ne++){const et=Ee[Ve],Ct=Ee[Ne];if(rc(ce,ve,et,Ct))return 0;R=Math.min(R,_(ce,ve,et,Ct,h))}}return R}function ft(p,l,h,v,S,k){if(!k)return;const R=I(In(v,k),S,h);R<l&&p.push([R,k,[0,0]])}function rr(p,l,h,v,S,k,R){if(!k||!R)return;const B=I(In(v,k),In(S,R),h);B<l&&p.push([B,k,R])}function ur(p,l,h,v,S=1/0){let k=Math.min(v.distance(p[0],h[0][0]),S);if(k===0)return k;const R=new fu([[0,[0,p.length-1],[0,0]]],Ou),B=vi(h);for(;R.length>0;){const V=R.pop();if(V[0]>=k)continue;const Z=V[1],ie=l?50:100;if(tr(Z)<=ie){if(!vr(Z,p.length))return NaN;if(l){const ce=me(p,Z,h,v);if(isNaN(ce)||ce===0)return ce;k=Math.min(k,ce)}else for(let ce=Z[0];ce<=Z[1];++ce){const ve=ne(p[ce],h,v);if(k=Math.min(k,ve),k===0)return 0}}else{const ce=dn(Z,l);ft(R,k,v,p,B,ce[0]),ft(R,k,v,p,B,ce[1])}}return k}function qr(p,l,h,v,S,k=1/0){let R=Math.min(k,S.distance(p[0],h[0]));if(R===0)return R;const B=new fu([[0,[0,p.length-1],[0,h.length-1]]],Ou);for(;B.length>0;){const V=B.pop();if(V[0]>=R)continue;const Z=V[1],ie=V[2],ce=l?50:100,ve=v?50:100;if(tr(Z)<=ce&&tr(ie)<=ve){if(!vr(Z,p.length)&&vr(ie,h.length))return NaN;let Ee;if(l&&v)Ee=P(p,Z,h,ie,S),R=Math.min(R,Ee);else if(l&&!v){const Ne=p.slice(Z[0],Z[1]+1);for(let ze=ie[0];ze<=ie[1];++ze)if(Ee=y(h[ze],Ne,S),R=Math.min(R,Ee),R===0)return R}else if(!l&&v){const Ne=h.slice(ie[0],ie[1]+1);for(let ze=Z[0];ze<=Z[1];++ze)if(Ee=y(p[ze],Ne,S),R=Math.min(R,Ee),R===0)return R}else Ee=$(p,Z,h,ie,S),R=Math.min(R,Ee)}else{const Ee=dn(Z,l),Ne=dn(ie,v);rr(B,R,S,p,h,Ee[0],Ne[0]),rr(B,R,S,p,h,Ee[0],Ne[1]),rr(B,R,S,p,h,Ee[1],Ne[0]),rr(B,R,S,p,h,Ee[1],Ne[1])}}return R}function bn(p){return p.type==="MultiPolygon"?p.coordinates.map((l=>({type:"Polygon",coordinates:l}))):p.type==="MultiLineString"?p.coordinates.map((l=>({type:"LineString",coordinates:l}))):p.type==="MultiPoint"?p.coordinates.map((l=>({type:"Point",coordinates:l}))):[p]}class Dn{constructor(l,h){this.type=Fr,this.geojson=l,this.geometries=h}static parse(l,h){if(l.length!==2)return h.error(`'distance' expression requires exactly one argument, but found ${l.length-1} instead.`);if(Vs(l[1])){const v=l[1];if(v.type==="FeatureCollection")return new Dn(v,v.features.map((S=>bn(S.geometry))).flat());if(v.type==="Feature")return new Dn(v,bn(v.geometry));if("type"in v&&"coordinates"in v)return new Dn(v,bn(v))}return h.error("'distance' expression requires valid geojson object that contains polygon geometry type.")}evaluate(l){if(l.geometry()!=null&&l.canonicalID()!=null){if(l.geometryType()==="Point")return(function(h,v){const S=h.geometry(),k=S.flat().map((V=>Da([V.x,V.y],h.canonical)));if(S.length===0)return NaN;const R=new Hl(k[0][1]);let B=1/0;for(const V of v){switch(V.type){case"Point":B=Math.min(B,qr(k,!1,[V.coordinates],!1,R,B));break;case"LineString":B=Math.min(B,qr(k,!1,V.coordinates,!0,R,B));break;case"Polygon":B=Math.min(B,ur(k,!1,V.coordinates,R,B))}if(B===0)return B}return B})(l,this.geometries);if(l.geometryType()==="LineString")return(function(h,v){const S=h.geometry(),k=S.flat().map((V=>Da([V.x,V.y],h.canonical)));if(S.length===0)return NaN;const R=new Hl(k[0][1]);let B=1/0;for(const V of v){switch(V.type){case"Point":B=Math.min(B,qr(k,!0,[V.coordinates],!1,R,B));break;case"LineString":B=Math.min(B,qr(k,!0,V.coordinates,!0,R,B));break;case"Polygon":B=Math.min(B,ur(k,!0,V.coordinates,R,B))}if(B===0)return B}return B})(l,this.geometries);if(l.geometryType()==="Polygon")return(function(h,v){const S=h.geometry();if(S.length===0||S[0].length===0)return NaN;const k=Vl(S,0).map((V=>V.map((Z=>Z.map((ie=>Da([ie.x,ie.y],h.canonical))))))),R=new Hl(k[0][0][0][1]);let B=1/0;for(const V of v)for(const Z of k){switch(V.type){case"Point":B=Math.min(B,ur([V.coordinates],!1,Z,R,B));break;case"LineString":B=Math.min(B,ur(V.coordinates,!0,Z,R,B));break;case"Polygon":B=Math.min(B,tt(Z,V.coordinates,R,B))}if(B===0)return B}return B})(l,this.geometries)}return NaN}eachChild(){}outputDefined(){return!0}}class Xn{constructor(l){this.type=zn,this.key=l}static parse(l,h){if(l.length!==2)return h.error(`Expected 1 argument, but found ${l.length-1} instead.`);const v=l[1];return v==null?h.error("Global state property must be defined."):typeof v!="string"?h.error(`Global state property must be string, but found ${typeof l[1]} instead.`):new Xn(v)}evaluate(l){var h;const v=(h=l.globals)===null||h===void 0?void 0:h.globalState;return v&&Object.keys(v).length!==0?It(v,this.key):null}eachChild(){}outputDefined(){return!1}}const Fn={"==":Ia,"!=":za,">":ll,"<":Hs,">=":$o,"<=":Gs,array:Ka,at:ii,boolean:Ka,case:ue,coalesce:Ui,collator:Ws,format:Xs,image:Il,in:ri,"index-of":Do,interpolate:Un,"interpolate-hcl":Un,"interpolate-lab":Un,length:gs,let:ji,literal:oa,match:ai,number:Ka,"number-format":Pa,object:Ka,slice:We,step:zt,string:Ka,"to-boolean":Vo,"to-color":Vo,"to-number":Vo,"to-string":Vo,var:qs,within:Ua,distance:Dn,"global-state":Xn};class En{constructor(l,h,v,S){this.name=l,this.type=h,this._evaluate=v,this.args=S}evaluate(l){return this._evaluate(l,this.args)}eachChild(l){this.args.forEach(l)}outputDefined(){return!1}static parse(l,h){const v=l[0],S=En.definitions[v];if(!S)return h.error(`Unknown expression "${v}". If you wanted a literal array, use ["literal", [...]].`,0);const k=Array.isArray(S)?S[0]:S.type,R=Array.isArray(S)?[[S[1],S[2]]]:S.overloads,B=R.filter((([Z])=>!Array.isArray(Z)||Z.length===l.length-1));let V=null;for(const[Z,ie]of B){V=new go(h.registry,Ho,h.path,null,h.scope);const ce=[];let ve=!1;for(let Ee=1;Ee<l.length;Ee++){const Ne=l[Ee],ze=Array.isArray(Z)?Z[Ee-1]:Z.type,Ve=V.parse(Ne,1+ce.length,ze);if(!Ve){ve=!0;break}ce.push(Ve)}if(!ve)if(Array.isArray(Z)&&Z.length!==ce.length)V.error(`Expected ${Z.length} arguments, but found ${ce.length} instead.`);else{for(let Ee=0;Ee<ce.length;Ee++){const Ne=Array.isArray(Z)?Z[Ee]:Z.type,ze=ce[Ee];V.concat(Ee+1).checkSubtype(Ne,ze.type)}if(V.errors.length===0)return new En(v,k,ie,ce)}}if(B.length===1)h.errors.push(...V.errors);else{const Z=(B.length?B:R).map((([ce])=>{return ve=ce,Array.isArray(ve)?`(${ve.map(zi).join(", ")})`:`(${zi(ve.type)}...)`;var ve})).join(" | "),ie=[];for(let ce=1;ce<l.length;ce++){const ve=h.parse(l[ce],1+ie.length);if(!ve)return null;ie.push(zi(ve.type))}h.error(`Expected arguments of type ${Z}, but found (${ie.join(", ")}) instead.`)}return null}static register(l,h){En.definitions=h;for(const v in h)l[v]=En}}function na(p,[l,h,v,S]){l=l.evaluate(p),h=h.evaluate(p),v=v.evaluate(p);const k=S?S.evaluate(p):1,R=Ts(l,h,v,k);if(R)throw new fi(R);return new kr(l/255,h/255,v/255,k,!1)}function ca(p,l){return p in l}function so(p,l){const h=l[p];return h===void 0?null:h}function ka(p){return{type:p}}function Ho(p){if(p instanceof qs)return Ho(p.boundExpression);if(p instanceof En&&p.name==="error"||p instanceof Ws||p instanceof Ua||p instanceof Dn||p instanceof Xn)return!1;const l=p instanceof Vo||p instanceof Ka;let h=!0;return p.eachChild((v=>{h=l?h&&Ho(v):h&&v instanceof oa})),!!h&&Ks(p)&&hu(p,["zoom","heatmap-density","elevation","line-progress","accumulated","is-supported-script"])}function Ks(p){if(p instanceof En&&(p.name==="get"&&p.args.length===1||p.name==="feature-state"||p.name==="has"&&p.args.length===1||p.name==="properties"||p.name==="geometry-type"||p.name==="id"||/^filter-/.test(p.name))||p instanceof Ua||p instanceof Dn)return!1;let l=!0;return p.eachChild((h=>{l&&!Ks(h)&&(l=!1)})),l}function Pl(p){if(p instanceof En&&p.name==="feature-state")return!1;let l=!0;return p.eachChild((h=>{l&&!Pl(h)&&(l=!1)})),l}function hu(p,l){if(p instanceof En&&l.indexOf(p.name)>=0)return!1;let h=!0;return p.eachChild((v=>{h&&!hu(v,l)&&(h=!1)})),h}function du(p){return{result:"success",value:p}}function Ps(p){return{result:"error",value:p}}function Gl(p){return p["property-type"]==="data-driven"||p["property-type"]==="cross-faded-data-driven"}function Wl(p){return!!p.expression&&p.expression.parameters.indexOf("zoom")>-1}function Eo(p){return!!p.expression&&p.expression.interpolated}function ni(p){return p instanceof Number?"number":p instanceof String?"string":p instanceof Boolean?"boolean":Array.isArray(p)?"array":p===null?"null":typeof p}function Nu(p){return typeof p=="object"&&p!==null&&!Array.isArray(p)&&Mi(p)===ha}function th(p){return p}function bf(p,l){const h=p.stops&&typeof p.stops[0][0]=="object",v=h||!(h||p.property!==void 0),S=p.type||(Eo(l)?"exponential":"interval"),k=(function(ie){switch(ie.type){case"color":return kr.parse;case"padding":return Mr.parse;case"numberArray":return hn.parse;case"colorArray":return mn.parse;default:return null}})(l);if(k&&((p=Xr({},p)).stops&&(p.stops=p.stops.map((ie=>[ie[0],k(ie[1])]))),p.default=k(p.default?p.default:l.default)),p.colorSpace&&(R=p.colorSpace)!=="rgb"&&R!=="hcl"&&R!=="lab")throw new Error(`Unknown color space: "${p.colorSpace}"`);var R;const B=(function(ie){switch(ie){case"exponential":return $g;case"interval":return Vg;case"categorical":return Op;case"identity":return qg;default:throw new Error(`Unknown function type "${ie}"`)}})(S);let V,Z;if(S==="categorical"){V=Object.create(null);for(const ie of p.stops)V[ie[0]]=ie[1];Z=typeof p.stops[0][0]}if(h){const ie={},ce=[];for(let Ne=0;Ne<p.stops.length;Ne++){const ze=p.stops[Ne],Ve=ze[0].zoom;ie[Ve]===void 0&&(ie[Ve]={zoom:Ve,type:p.type,property:p.property,default:p.default,stops:[]},ce.push(Ve)),ie[Ve].stops.push([ze[0].value,ze[1]])}const ve=[];for(const Ne of ce)ve.push([ie[Ne].zoom,bf(ie[Ne],l)]);const Ee={name:"linear"};return{kind:"composite",interpolationType:Ee,interpolationFactor:Un.interpolationFactor.bind(void 0,Ee),zoomStops:ve.map((Ne=>Ne[0])),evaluate:({zoom:Ne},ze)=>$g({stops:ve,base:p.base},l,Ne).evaluate(Ne,ze)}}if(v){const ie=S==="exponential"?{name:"exponential",base:p.base!==void 0?p.base:1}:null;return{kind:"camera",interpolationType:ie,interpolationFactor:Un.interpolationFactor.bind(void 0,ie),zoomStops:p.stops.map((ce=>ce[0])),evaluate:({zoom:ce})=>B(p,l,ce,V,Z)}}return{kind:"source",evaluate(ie,ce){const ve=ce&&ce.properties?ce.properties[p.property]:void 0;return ve===void 0?pu(p.default,l.default):B(p,l,ve,V,Z)}}}function pu(p,l,h){return p!==void 0?p:l!==void 0?l:h!==void 0?h:void 0}function Op(p,l,h,v,S){return pu(typeof h===S?v[h]:void 0,p.default,l.default)}function Vg(p,l,h){if(ni(h)!=="number")return pu(p.default,l.default);const v=p.stops.length;if(v===1||h<=p.stops[0][0])return p.stops[0][1];if(h>=p.stops[v-1][0])return p.stops[v-1][1];const S=bt(p.stops.map((k=>k[0])),h);return p.stops[S][1]}function $g(p,l,h){const v=p.base!==void 0?p.base:1;if(ni(h)!=="number")return pu(p.default,l.default);const S=p.stops.length;if(S===1||h<=p.stops[0][0])return p.stops[0][1];if(h>=p.stops[S-1][0])return p.stops[S-1][1];const k=bt(p.stops.map((ie=>ie[0])),h),R=(function(ie,ce,ve,Ee){const Ne=Ee-ve,ze=ie-ve;return Ne===0?0:ce===1?ze/Ne:(Math.pow(ce,ze)-1)/(Math.pow(ce,Ne)-1)})(h,v,p.stops[k][0],p.stops[k+1][0]),B=p.stops[k][1],V=p.stops[k+1][1],Z=Hn[l.type]||th;return typeof B.evaluate=="function"?{evaluate(...ie){const ce=B.evaluate.apply(void 0,ie),ve=V.evaluate.apply(void 0,ie);if(ce!==void 0&&ve!==void 0)return Z(ce,ve,R,p.colorSpace)}}:Z(B,V,R,p.colorSpace)}function qg(p,l,h){switch(l.type){case"color":h=kr.parse(h);break;case"formatted":h=_n.fromString(h.toString());break;case"resolvedImage":h=wi.fromString(h.toString());break;case"padding":h=Mr.parse(h);break;case"colorArray":h=mn.parse(h);break;case"numberArray":h=hn.parse(h);break;default:ni(h)===l.type||l.type==="enum"&&l.values[h]||(h=void 0)}return pu(h,p.default,l.default)}En.register(Fn,{error:[{kind:"error"},[Mn],(p,[l])=>{throw new fi(l.evaluate(p))}],typeof:[Mn,[zn],(p,[l])=>zi(Mi(l.evaluate(p)))],"to-rgba":[xi(Fr,4),[ei],(p,[l])=>{const[h,v,S,k]=l.evaluate(p).rgb;return[255*h,255*v,255*S,k]}],rgb:[ei,[Fr,Fr,Fr],na],rgba:[ei,[Fr,Fr,Fr,Fr],na],has:{type:Bn,overloads:[[[Mn],(p,[l])=>ca(l.evaluate(p),p.properties())],[[Mn,ha],(p,[l,h])=>ca(l.evaluate(p),h.evaluate(p))]]},get:{type:zn,overloads:[[[Mn],(p,[l])=>so(l.evaluate(p),p.properties())],[[Mn,ha],(p,[l,h])=>so(l.evaluate(p),h.evaluate(p))]]},"feature-state":[zn,[Mn],(p,[l])=>so(l.evaluate(p),p.featureState||{})],properties:[ha,[],p=>p.properties()],"geometry-type":[Mn,[],p=>p.geometryType()],id:[zn,[],p=>p.id()],zoom:[Fr,[],p=>p.globals.zoom],"heatmap-density":[Fr,[],p=>p.globals.heatmapDensity||0],elevation:[Fr,[],p=>p.globals.elevation||0],"line-progress":[Fr,[],p=>p.globals.lineProgress||0],accumulated:[zn,[],p=>p.globals.accumulated===void 0?null:p.globals.accumulated],"+":[Fr,ka(Fr),(p,l)=>{let h=0;for(const v of l)h+=v.evaluate(p);return h}],"*":[Fr,ka(Fr),(p,l)=>{let h=1;for(const v of l)h*=v.evaluate(p);return h}],"-":{type:Fr,overloads:[[[Fr,Fr],(p,[l,h])=>l.evaluate(p)-h.evaluate(p)],[[Fr],(p,[l])=>-l.evaluate(p)]]},"/":[Fr,[Fr,Fr],(p,[l,h])=>l.evaluate(p)/h.evaluate(p)],"%":[Fr,[Fr,Fr],(p,[l,h])=>l.evaluate(p)%h.evaluate(p)],ln2:[Fr,[],()=>Math.LN2],pi:[Fr,[],()=>Math.PI],e:[Fr,[],()=>Math.E],"^":[Fr,[Fr,Fr],(p,[l,h])=>Math.pow(l.evaluate(p),h.evaluate(p))],sqrt:[Fr,[Fr],(p,[l])=>Math.sqrt(l.evaluate(p))],log10:[Fr,[Fr],(p,[l])=>Math.log(l.evaluate(p))/Math.LN10],ln:[Fr,[Fr],(p,[l])=>Math.log(l.evaluate(p))],log2:[Fr,[Fr],(p,[l])=>Math.log(l.evaluate(p))/Math.LN2],sin:[Fr,[Fr],(p,[l])=>Math.sin(l.evaluate(p))],cos:[Fr,[Fr],(p,[l])=>Math.cos(l.evaluate(p))],tan:[Fr,[Fr],(p,[l])=>Math.tan(l.evaluate(p))],asin:[Fr,[Fr],(p,[l])=>Math.asin(l.evaluate(p))],acos:[Fr,[Fr],(p,[l])=>Math.acos(l.evaluate(p))],atan:[Fr,[Fr],(p,[l])=>Math.atan(l.evaluate(p))],min:[Fr,ka(Fr),(p,l)=>Math.min(...l.map((h=>h.evaluate(p))))],max:[Fr,ka(Fr),(p,l)=>Math.max(...l.map((h=>h.evaluate(p))))],abs:[Fr,[Fr],(p,[l])=>Math.abs(l.evaluate(p))],round:[Fr,[Fr],(p,[l])=>{const h=l.evaluate(p);return h<0?-Math.round(-h):Math.round(h)}],floor:[Fr,[Fr],(p,[l])=>Math.floor(l.evaluate(p))],ceil:[Fr,[Fr],(p,[l])=>Math.ceil(l.evaluate(p))],"filter-==":[Bn,[Mn,zn],(p,[l,h])=>p.properties()[l.value]===h.value],"filter-id-==":[Bn,[zn],(p,[l])=>p.id()===l.value],"filter-type-==":[Bn,[Mn],(p,[l])=>p.geometryType()===l.value],"filter-<":[Bn,[Mn,zn],(p,[l,h])=>{const v=p.properties()[l.value],S=h.value;return typeof v==typeof S&&v<S}],"filter-id-<":[Bn,[zn],(p,[l])=>{const h=p.id(),v=l.value;return typeof h==typeof v&&h<v}],"filter->":[Bn,[Mn,zn],(p,[l,h])=>{const v=p.properties()[l.value],S=h.value;return typeof v==typeof S&&v>S}],"filter-id->":[Bn,[zn],(p,[l])=>{const h=p.id(),v=l.value;return typeof h==typeof v&&h>v}],"filter-<=":[Bn,[Mn,zn],(p,[l,h])=>{const v=p.properties()[l.value],S=h.value;return typeof v==typeof S&&v<=S}],"filter-id-<=":[Bn,[zn],(p,[l])=>{const h=p.id(),v=l.value;return typeof h==typeof v&&h<=v}],"filter->=":[Bn,[Mn,zn],(p,[l,h])=>{const v=p.properties()[l.value],S=h.value;return typeof v==typeof S&&v>=S}],"filter-id->=":[Bn,[zn],(p,[l])=>{const h=p.id(),v=l.value;return typeof h==typeof v&&h>=v}],"filter-has":[Bn,[zn],(p,[l])=>l.value in p.properties()],"filter-has-id":[Bn,[],p=>p.id()!==null&&p.id()!==void 0],"filter-type-in":[Bn,[xi(Mn)],(p,[l])=>l.value.indexOf(p.geometryType())>=0],"filter-id-in":[Bn,[xi(zn)],(p,[l])=>l.value.indexOf(p.id())>=0],"filter-in-small":[Bn,[Mn,xi(zn)],(p,[l,h])=>h.value.indexOf(p.properties()[l.value])>=0],"filter-in-large":[Bn,[Mn,xi(zn)],(p,[l,h])=>(function(v,S,k,R){for(;k<=R;){const B=k+R>>1;if(S[B]===v)return!0;S[B]>v?R=B-1:k=B+1}return!1})(p.properties()[l.value],h.value,0,h.value.length-1)],all:{type:Bn,overloads:[[[Bn,Bn],(p,[l,h])=>l.evaluate(p)&&h.evaluate(p)],[ka(Bn),(p,l)=>{for(const h of l)if(!h.evaluate(p))return!1;return!0}]]},any:{type:Bn,overloads:[[[Bn,Bn],(p,[l,h])=>l.evaluate(p)||h.evaluate(p)],[ka(Bn),(p,l)=>{for(const h of l)if(h.evaluate(p))return!0;return!1}]]},"!":[Bn,[Bn],(p,[l])=>!l.evaluate(p)],"is-supported-script":[Bn,[Mn],(p,[l])=>{const h=p.globals&&p.globals.isSupportedScript;return!h||h(l.evaluate(p))}],upcase:[Mn,[Mn],(p,[l])=>l.evaluate(p).toUpperCase()],downcase:[Mn,[Mn],(p,[l])=>l.evaluate(p).toLowerCase()],concat:[Mn,ka(zn),(p,l)=>l.map((h=>Cs(h.evaluate(p)))).join("")],"resolved-locale":[Mn,[La],(p,[l])=>l.evaluate(p).resolvedLocale()]});class Od{constructor(l,h,v){this.expression=l,this._warningHistory={},this._evaluator=new Mu,this._defaultValue=h?(function(S){if(S.type==="color"&&Nu(S.default))return new kr(0,0,0,0);switch(S.type){case"color":return kr.parse(S.default)||null;case"padding":return Mr.parse(S.default)||null;case"numberArray":return hn.parse(S.default)||null;case"colorArray":return mn.parse(S.default)||null;case"variableAnchorOffsetCollection":return ba.parse(S.default)||null;case"projectionDefinition":return hi.parse(S.default)||null;default:return S.default===void 0?null:S.default}})(h):null,this._enumValues=h&&h.type==="enum"?h.values:null,this._globalState=v}evaluateWithoutErrorHandling(l,h,v,S,k,R){return this._globalState&&(l=nh(l,this._globalState)),this._evaluator.globals=l,this._evaluator.feature=h,this._evaluator.featureState=v,this._evaluator.canonical=S,this._evaluator.availableImages=k||null,this._evaluator.formattedSection=R,this.expression.evaluate(this._evaluator)}evaluate(l,h,v,S,k,R){this._globalState&&(l=nh(l,this._globalState)),this._evaluator.globals=l,this._evaluator.feature=h||null,this._evaluator.featureState=v||null,this._evaluator.canonical=S,this._evaluator.availableImages=k||null,this._evaluator.formattedSection=R||null;try{const B=this.expression.evaluate(this._evaluator);if(B==null||typeof B=="number"&&B!=B)return this._defaultValue;if(this._enumValues&&!(B in this._enumValues))throw new fi(`Expected value to be one of ${Object.keys(this._enumValues).map((V=>JSON.stringify(V))).join(", ")}, but found ${JSON.stringify(B)} instead.`);return B}catch(B){return this._warningHistory[B.message]||(this._warningHistory[B.message]=!0,typeof console<"u"&&console.warn(B.message)),this._defaultValue}}}function qc(p){return Array.isArray(p)&&p.length>0&&typeof p[0]=="string"&&p[0]in Fn}function rh(p,l,h){const v=new go(Fn,Ho,[],l?(function(k){const R={color:ei,string:Mn,number:Fr,enum:Mn,boolean:Bn,formatted:Wi,padding:hs,numberArray:Mo,colorArray:Ca,projectionDefinition:ua,resolvedImage:Ya,variableAnchorOffsetCollection:ol};return k.type==="array"?xi(R[k.value]||zn,k.length):R[k.type]})(l):void 0),S=v.parse(p,void 0,void 0,void 0,l&&l.type==="string"?{typeAnnotation:"coerce"}:void 0);return S?du(new Od(S,l,h)):Ps(v.errors)}class Np{constructor(l,h,v){this.kind=l,this._styleExpression=h,this.isStateDependent=l!=="constant"&&!Pl(h.expression),this.globalStateRefs=xf(h.expression),this._globalState=v}evaluateWithoutErrorHandling(l,h,v,S,k,R){return this._globalState&&(l=nh(l,this._globalState)),this._styleExpression.evaluateWithoutErrorHandling(l,h,v,S,k,R)}evaluate(l,h,v,S,k,R){return this._globalState&&(l=nh(l,this._globalState)),this._styleExpression.evaluate(l,h,v,S,k,R)}}class Hg{constructor(l,h,v,S,k){this.kind=l,this.zoomStops=v,this._styleExpression=h,this.isStateDependent=l!=="camera"&&!Pl(h.expression),this.globalStateRefs=xf(h.expression),this.interpolationType=S,this._globalState=k}evaluateWithoutErrorHandling(l,h,v,S,k,R){return this._globalState&&(l=nh(l,this._globalState)),this._styleExpression.evaluateWithoutErrorHandling(l,h,v,S,k,R)}evaluate(l,h,v,S,k,R){return this._globalState&&(l=nh(l,this._globalState)),this._styleExpression.evaluate(l,h,v,S,k,R)}interpolationFactor(l,h,v){return this.interpolationType?Un.interpolationFactor(this.interpolationType,l,h,v):0}}function Lp(p,l,h){const v=rh(p,l,h);if(v.result==="error")return v;const S=v.value.expression,k=Ks(S);if(!k&&!Gl(l))return Ps([new Nn("","data expressions not supported")]);const R=hu(S,["zoom"]);if(!R&&!Wl(l))return Ps([new Nn("","zoom expressions not supported")]);const B=Bp(S);return B||R?B instanceof Nn?Ps([B]):B instanceof Un&&!Eo(l)?Ps([new Nn("",'"interpolate" expressions cannot be used with this property')]):du(B?new Hg(k?"camera":"composite",v.value,B.labels,B instanceof Un?B.interpolation:void 0,h):new Np(k?"constant":"source",v.value,h)):Ps([new Nn("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class Fp{constructor(l,h){this._parameters=l,this._specification=h,Xr(this,bf(this._parameters,this._specification))}static deserialize(l){return new Fp(l._parameters,l._specification)}static serialize(l){return{_parameters:l._parameters,_specification:l._specification}}}function Bp(p){let l=null;if(p instanceof ji)l=Bp(p.result);else if(p instanceof Ui){for(const h of p.args)if(l=Bp(h),l)break}else(p instanceof zt||p instanceof Un)&&p.input instanceof En&&p.input.name==="zoom"&&(l=p);return l instanceof Nn||p.eachChild((h=>{const v=Bp(h);v instanceof Nn?l=v:!l&&v?l=new Nn("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):l&&v&&l!==v&&(l=new Nn("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))})),l}function xf(p,l=new Set){return p instanceof Xn&&l.add(p.key),p.eachChild((h=>{xf(h,l)})),l}function nh(p,l){const{zoom:h,heatmapDensity:v,elevation:S,lineProgress:k,isSupportedScript:R,accumulated:B}=p??{};return{zoom:h,heatmapDensity:v,elevation:S,lineProgress:k,isSupportedScript:R,accumulated:B,globalState:l}}function Gg(p){if(p===!0||p===!1)return!0;if(!Array.isArray(p)||p.length===0)return!1;switch(p[0]){case"has":return p.length>=2&&p[1]!=="$id"&&p[1]!=="$type";case"in":return p.length>=3&&(typeof p[1]!="string"||Array.isArray(p[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return p.length!==3||Array.isArray(p[1])||Array.isArray(p[2]);case"any":case"all":for(const l of p.slice(1))if(!Gg(l)&&typeof l!="boolean")return!1;return!0;default:return!0}}const Wg={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function ih(p,l){if(p==null)return{filter:()=>!0,needGeometry:!1,getGlobalStateRefs:()=>new Set};Gg(p)||(p=Ld(p));const h=rh(p,Wg,l);if(h.result==="error")throw new Error(h.value.map((v=>`${v.key}: ${v.message}`)).join(", "));return{filter:(v,S,k)=>h.value.evaluate(v,S,{},k),needGeometry:Ly(p),getGlobalStateRefs:()=>xf(h.value.expression)}}function Nd(p,l){return p<l?-1:p>l?1:0}function Ly(p){if(!Array.isArray(p))return!1;if(p[0]==="within"||p[0]==="distance")return!0;for(let l=1;l<p.length;l++)if(Ly(p[l]))return!0;return!1}function Ld(p){if(!p)return!0;const l=p[0];return p.length<=1?l!=="any":l==="=="?Fd(p[1],p[2],"=="):l==="!="?Bd(Fd(p[1],p[2],"==")):l==="<"||l===">"||l==="<="||l===">="?Fd(p[1],p[2],l):l==="any"?(h=p.slice(1),["any"].concat(h.map(Ld))):l==="all"?["all"].concat(p.slice(1).map(Ld)):l==="none"?["all"].concat(p.slice(1).map(Ld).map(Bd)):l==="in"?Fy(p[1],p.slice(2)):l==="!in"?Bd(Fy(p[1],p.slice(2))):l==="has"?By(p[1]):l!=="!has"||Bd(By(p[1]));var h}function Fd(p,l,h){switch(p){case"$type":return[`filter-type-${h}`,l];case"$id":return[`filter-id-${h}`,l];default:return[`filter-${h}`,p,l]}}function Fy(p,l){if(l.length===0)return!1;switch(p){case"$type":return["filter-type-in",["literal",l]];case"$id":return["filter-id-in",["literal",l]];default:return l.length>200&&!l.some((h=>typeof h!=typeof l[0]))?["filter-in-large",p,["literal",l.sort(Nd)]]:["filter-in-small",p,["literal",l]]}}function By(p){switch(p){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",p]}}function Bd(p){return["!",p]}function zp(p){const l=typeof p;if(l==="number"||l==="boolean"||l==="string"||p==null)return JSON.stringify(p);if(Array.isArray(p)){let S="[";for(const k of p)S+=`${zp(k)},`;return`${S}]`}const h=Object.keys(p).sort();let v="{";for(let S=0;S<h.length;S++)v+=`${JSON.stringify(h[S])}:${zp(p[h[S]])},`;return`${v}}`}function Hc(p){let l="";for(const h of en)l+=`/${zp(p[h])}`;return l}function Lu(p){const l=p.value;return l?[new Ut(p.key,l,"constants have been deprecated as of v8")]:[]}function xa(p){return p instanceof Number||p instanceof String||p instanceof Boolean?p.valueOf():p}function ah(p){if(Array.isArray(p))return p.map(ah);if(p instanceof Object&&!(p instanceof Number||p instanceof String||p instanceof Boolean)){const l={};for(const h in p)l[h]=ah(p[h]);return l}return xa(p)}function Xl(p){const l=p.key,h=p.value,v=p.valueSpec||{},S=p.objectElementValidators||{},k=p.style,R=p.styleSpec,B=p.validateSpec;let V=[];const Z=ni(h);if(Z!=="object")return[new Ut(l,h,`object expected, ${Z} found`)];for(const ie in h){const ce=ie.split(".")[0],ve=It(v,ce)||v["*"];let Ee;if(It(S,ce))Ee=S[ce];else if(It(v,ce)){if(h[ie]===void 0)continue;Ee=B}else if(S["*"])Ee=S["*"];else{if(!v["*"]){V.push(new Ut(l,h[ie],`unknown property "${ie}"`));continue}Ee=B}V=V.concat(Ee({key:(l&&`${l}.`)+ie,value:h[ie],valueSpec:ve,style:k,styleSpec:R,object:h,objectKey:ie,validateSpec:B},h))}for(const ie in v)S[ie]||v[ie].required&&v[ie].default===void 0&&h[ie]===void 0&&V.push(new Ut(l,h,`missing required property "${ie}"`));return V}function ac(p){const l=p.value,h=p.valueSpec,v=p.style,S=p.styleSpec,k=p.key,R=p.arrayElementValidator||p.validateSpec;if(ni(l)!=="array")return[new Ut(k,l,`array expected, ${ni(l)} found`)];if(h.length&&l.length!==h.length)return[new Ut(k,l,`array length ${h.length} expected, length ${l.length} found`)];let B={type:h.value,values:h.values};S.$version<7&&(B.function=h.function),ni(h.value)==="object"&&(B=h.value);let V=[];for(let Z=0;Z<l.length;Z++)V=V.concat(R({array:l,arrayIndex:Z,value:l[Z],valueSpec:B,validateSpec:p.validateSpec,style:v,styleSpec:S,key:`${k}[${Z}]`}));return V}function dl(p){const l=p.key,h=p.value,v=p.valueSpec;let S=ni(h);return S==="number"&&h!=h&&(S="NaN"),S!=="number"?[new Ut(l,h,`number expected, ${S} found`)]:"minimum"in v&&h<v.minimum?[new Ut(l,h,`${h} is less than the minimum value ${v.minimum}`)]:"maximum"in v&&h>v.maximum?[new Ut(l,h,`${h} is greater than the maximum value ${v.maximum}`)]:[]}function jp(p){const l=p.valueSpec,h=xa(p.value.type);let v,S,k,R={};const B=h!=="categorical"&&p.value.property===void 0,V=!B,Z=ni(p.value.stops)==="array"&&ni(p.value.stops[0])==="array"&&ni(p.value.stops[0][0])==="object",ie=Xl({key:p.key,value:p.value,valueSpec:p.styleSpec.function,validateSpec:p.validateSpec,style:p.style,styleSpec:p.styleSpec,objectElementValidators:{stops:function(Ee){if(h==="identity")return[new Ut(Ee.key,Ee.value,'identity function may not have a "stops" property')];let Ne=[];const ze=Ee.value;return Ne=Ne.concat(ac({key:Ee.key,value:ze,valueSpec:Ee.valueSpec,validateSpec:Ee.validateSpec,style:Ee.style,styleSpec:Ee.styleSpec,arrayElementValidator:ce})),ni(ze)==="array"&&ze.length===0&&Ne.push(new Ut(Ee.key,ze,"array must have at least one stop")),Ne},default:function(Ee){return Ee.validateSpec({key:Ee.key,value:Ee.value,valueSpec:l,validateSpec:Ee.validateSpec,style:Ee.style,styleSpec:Ee.styleSpec})}}});return h==="identity"&&B&&ie.push(new Ut(p.key,p.value,'missing required property "property"')),h==="identity"||p.value.stops||ie.push(new Ut(p.key,p.value,'missing required property "stops"')),h==="exponential"&&p.valueSpec.expression&&!Eo(p.valueSpec)&&ie.push(new Ut(p.key,p.value,"exponential functions not supported")),p.styleSpec.$version>=8&&(V&&!Gl(p.valueSpec)?ie.push(new Ut(p.key,p.value,"property functions not supported")):B&&!Wl(p.valueSpec)&&ie.push(new Ut(p.key,p.value,"zoom functions not supported"))),h!=="categorical"&&!Z||p.value.property!==void 0||ie.push(new Ut(p.key,p.value,'"property" property is required')),ie;function ce(Ee){let Ne=[];const ze=Ee.value,Ve=Ee.key;if(ni(ze)!=="array")return[new Ut(Ve,ze,`array expected, ${ni(ze)} found`)];if(ze.length!==2)return[new Ut(Ve,ze,`array length 2 expected, length ${ze.length} found`)];if(Z){if(ni(ze[0])!=="object")return[new Ut(Ve,ze,`object expected, ${ni(ze[0])} found`)];if(ze[0].zoom===void 0)return[new Ut(Ve,ze,"object stop key must have zoom")];if(ze[0].value===void 0)return[new Ut(Ve,ze,"object stop key must have value")];if(k&&k>xa(ze[0].zoom))return[new Ut(Ve,ze[0].zoom,"stop zoom values must appear in ascending order")];xa(ze[0].zoom)!==k&&(k=xa(ze[0].zoom),S=void 0,R={}),Ne=Ne.concat(Xl({key:`${Ve}[0]`,value:ze[0],valueSpec:{zoom:{}},validateSpec:Ee.validateSpec,style:Ee.style,styleSpec:Ee.styleSpec,objectElementValidators:{zoom:dl,value:ve}}))}else Ne=Ne.concat(ve({key:`${Ve}[0]`,value:ze[0],validateSpec:Ee.validateSpec,style:Ee.style,styleSpec:Ee.styleSpec},ze));return qc(ah(ze[1]))?Ne.concat([new Ut(`${Ve}[1]`,ze[1],"expressions are not allowed in function stops.")]):Ne.concat(Ee.validateSpec({key:`${Ve}[1]`,value:ze[1],valueSpec:l,validateSpec:Ee.validateSpec,style:Ee.style,styleSpec:Ee.styleSpec}))}function ve(Ee,Ne){const ze=ni(Ee.value),Ve=xa(Ee.value),et=Ee.value!==null?Ee.value:Ne;if(v){if(ze!==v)return[new Ut(Ee.key,et,`${ze} stop domain type must match previous stop domain type ${v}`)]}else v=ze;if(ze!=="number"&&ze!=="string"&&ze!=="boolean")return[new Ut(Ee.key,et,"stop domain value must be a number, string, or boolean")];if(ze!=="number"&&h!=="categorical"){let Ct=`number expected, ${ze} found`;return Gl(l)&&h===void 0&&(Ct+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new Ut(Ee.key,et,Ct)]}return h!=="categorical"||ze!=="number"||isFinite(Ve)&&Math.floor(Ve)===Ve?h!=="categorical"&&ze==="number"&&S!==void 0&&Ve<S?[new Ut(Ee.key,et,"stop domain values must appear in ascending order")]:(S=Ve,h==="categorical"&&Ve in R?[new Ut(Ee.key,et,"stop domain values must be unique")]:(R[Ve]=!0,[])):[new Ut(Ee.key,et,`integer expected, found ${Ve}`)]}}function wf(p){const l=(p.expressionContext==="property"?Lp:rh)(ah(p.value),p.valueSpec);if(l.result==="error")return l.value.map((v=>new Ut(`${p.key}${v.key}`,p.value,v.message)));const h=l.value.expression||l.value._styleExpression.expression;if(p.expressionContext==="property"&&p.propertyKey==="text-font"&&!h.outputDefined())return[new Ut(p.key,p.value,`Invalid data expression for "${p.propertyKey}". Output values must be contained as literals within the expression.`)];if(p.expressionContext==="property"&&p.propertyType==="layout"&&!Pl(h))return[new Ut(p.key,p.value,'"feature-state" data expressions are not supported with layout properties.')];if(p.expressionContext==="filter"&&!Pl(h))return[new Ut(p.key,p.value,'"feature-state" data expressions are not supported with filters.')];if(p.expressionContext&&p.expressionContext.indexOf("cluster")===0){if(!hu(h,["zoom","feature-state"]))return[new Ut(p.key,p.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(p.expressionContext==="cluster-initial"&&!Ks(h))return[new Ut(p.key,p.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function zh(p){const l=p.key,h=p.value,v=ni(h);return v!=="string"?[new Ut(l,h,`color expected, ${v} found`)]:kr.parse(String(h))?[]:[new Ut(l,h,`color expected, "${h}" found`)]}function Sf(p){const l=p.key,h=p.value,v=p.valueSpec,S=[];return Array.isArray(v.values)?v.values.indexOf(xa(h))===-1&&S.push(new Ut(l,h,`expected one of [${v.values.join(", ")}], ${JSON.stringify(h)} found`)):Object.keys(v.values).indexOf(xa(h))===-1&&S.push(new Ut(l,h,`expected one of [${Object.keys(v.values).join(", ")}], ${JSON.stringify(h)} found`)),S}function oh(p){return Gg(ah(p.value))?wf(Xr({},p,{expressionContext:"filter",valueSpec:{value:"boolean"}})):Xg(p)}function Xg(p){const l=p.value,h=p.key;if(ni(l)!=="array")return[new Ut(h,l,`array expected, ${ni(l)} found`)];const v=p.styleSpec;let S,k=[];if(l.length<1)return[new Ut(h,l,"filter array must have at least 1 element")];switch(k=k.concat(Sf({key:`${h}[0]`,value:l[0],valueSpec:v.filter_operator,style:p.style,styleSpec:p.styleSpec})),xa(l[0])){case"<":case"<=":case">":case">=":l.length>=2&&xa(l[1])==="$type"&&k.push(new Ut(h,l,`"$type" cannot be use with operator "${l[0]}"`));case"==":case"!=":l.length!==3&&k.push(new Ut(h,l,`filter array for operator "${l[0]}" must have 3 elements`));case"in":case"!in":l.length>=2&&(S=ni(l[1]),S!=="string"&&k.push(new Ut(`${h}[1]`,l[1],`string expected, ${S} found`)));for(let R=2;R<l.length;R++)S=ni(l[R]),xa(l[1])==="$type"?k=k.concat(Sf({key:`${h}[${R}]`,value:l[R],valueSpec:v.geometry_type,style:p.style,styleSpec:p.styleSpec})):S!=="string"&&S!=="number"&&S!=="boolean"&&k.push(new Ut(`${h}[${R}]`,l[R],`string, number, or boolean expected, ${S} found`));break;case"any":case"all":case"none":for(let R=1;R<l.length;R++)k=k.concat(Xg({key:`${h}[${R}]`,value:l[R],style:p.style,styleSpec:p.styleSpec}));break;case"has":case"!has":S=ni(l[1]),l.length!==2?k.push(new Ut(h,l,`filter array for "${l[0]}" operator must have 2 elements`)):S!=="string"&&k.push(new Ut(`${h}[1]`,l[1],`string expected, ${S} found`))}return k}function zy(p,l){const h=p.key,v=p.validateSpec,S=p.style,k=p.styleSpec,R=p.value,B=p.objectKey,V=k[`${l}_${p.layerType}`];if(!V)return[];const Z=B.match(/^(.*)-transition$/);if(l==="paint"&&Z&&V[Z[1]]&&V[Z[1]].transition)return v({key:h,value:R,valueSpec:k.transition,style:S,styleSpec:k});const ie=p.valueSpec||V[B];if(!ie)return[new Ut(h,R,`unknown property "${B}"`)];let ce;if(ni(R)==="string"&&Gl(ie)&&!ie.tokens&&(ce=/^{([^}]+)}$/.exec(R)))return[new Ut(h,R,`"${B}" does not support interpolation syntax
Use an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(ce[1])} }\`.`)];const ve=[];return p.layerType==="symbol"&&B==="text-font"&&Nu(ah(R))&&xa(R.type)==="identity"&&ve.push(new Ut(h,R,'"text-font" does not support identity functions')),ve.concat(v({key:p.key,value:R,valueSpec:ie,style:S,styleSpec:k,expressionContext:"property",propertyType:l,propertyKey:B}))}function zd(p){return zy(p,"paint")}function jd(p){return zy(p,"layout")}function jh(p){let l=[];const h=p.value,v=p.key,S=p.style,k=p.styleSpec;if(ni(h)!=="object")return[new Ut(v,h,`object expected, ${ni(h)} found`)];h.type||h.ref||l.push(new Ut(v,h,'either "type" or "ref" is required'));let R=xa(h.type);const B=xa(h.ref);if(h.id){const V=xa(h.id);for(let Z=0;Z<p.arrayIndex;Z++){const ie=S.layers[Z];xa(ie.id)===V&&l.push(new Ut(v,h.id,`duplicate layer id "${h.id}", previously used at line ${ie.id.__line__}`))}}if("ref"in h){let V;["type","source","source-layer","filter","layout"].forEach((Z=>{Z in h&&l.push(new Ut(v,h[Z],`"${Z}" is prohibited for ref layers`))})),S.layers.forEach((Z=>{xa(Z.id)===B&&(V=Z)})),V?V.ref?l.push(new Ut(v,h.ref,"ref cannot reference another ref layer")):R=xa(V.type):l.push(new Ut(v,h.ref,`ref layer "${B}" not found`))}else if(R!=="background")if(h.source){const V=S.sources&&S.sources[h.source],Z=V&&xa(V.type);V?Z==="vector"&&R==="raster"?l.push(new Ut(v,h.source,`layer "${h.id}" requires a raster source`)):Z!=="raster-dem"&&R==="hillshade"||Z!=="raster-dem"&&R==="color-relief"?l.push(new Ut(v,h.source,`layer "${h.id}" requires a raster-dem source`)):Z==="raster"&&R!=="raster"?l.push(new Ut(v,h.source,`layer "${h.id}" requires a vector source`)):Z!=="vector"||h["source-layer"]?Z==="raster-dem"&&R!=="hillshade"&&R!=="color-relief"?l.push(new Ut(v,h.source,"raster-dem source can only be used with layer type 'hillshade' or 'color-relief'.")):R!=="line"||!h.paint||!h.paint["line-gradient"]||Z==="geojson"&&V.lineMetrics||l.push(new Ut(v,h,`layer "${h.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):l.push(new Ut(v,h,`layer "${h.id}" must specify a "source-layer"`)):l.push(new Ut(v,h.source,`source "${h.source}" not found`))}else l.push(new Ut(v,h,'missing required property "source"'));return l=l.concat(Xl({key:v,value:h,valueSpec:k.layer,style:p.style,styleSpec:p.styleSpec,validateSpec:p.validateSpec,objectElementValidators:{"*":()=>[],type:()=>p.validateSpec({key:`${v}.type`,value:h.type,valueSpec:k.layer.type,style:p.style,styleSpec:p.styleSpec,validateSpec:p.validateSpec,object:h,objectKey:"type"}),filter:oh,layout:V=>Xl({layer:h,key:V.key,value:V.value,style:V.style,styleSpec:V.styleSpec,validateSpec:V.validateSpec,objectElementValidators:{"*":Z=>jd(Xr({layerType:R},Z))}}),paint:V=>Xl({layer:h,key:V.key,value:V.value,style:V.style,styleSpec:V.styleSpec,validateSpec:V.validateSpec,objectElementValidators:{"*":Z=>zd(Xr({layerType:R},Z))}})}})),l}function Sc(p){const l=p.value,h=p.key,v=ni(l);return v!=="string"?[new Ut(h,l,`string expected, ${v} found`)]:[]}const Yg={promoteId:function({key:p,value:l}){if(ni(l)==="string")return Sc({key:p,value:l});{const h=[];for(const v in l)h.push(...Sc({key:`${p}.${v}`,value:l[v]}));return h}}};function Up(p){const l=p.value,h=p.key,v=p.styleSpec,S=p.style,k=p.validateSpec;if(!l.type)return[new Ut(h,l,'"type" is required')];const R=xa(l.type);let B;switch(R){case"vector":case"raster":return B=Xl({key:h,value:l,valueSpec:v[`source_${R.replace("-","_")}`],style:p.style,styleSpec:v,objectElementValidators:Yg,validateSpec:k}),B;case"raster-dem":return B=(function(V){var Z;const ie=(Z=V.sourceName)!==null&&Z!==void 0?Z:"",ce=V.value,ve=V.styleSpec,Ee=ve.source_raster_dem,Ne=V.style;let ze=[];const Ve=ni(ce);if(ce===void 0)return ze;if(Ve!=="object")return ze.push(new Ut("source_raster_dem",ce,`object expected, ${Ve} found`)),ze;const et=xa(ce.encoding)==="custom",Ct=["redFactor","greenFactor","blueFactor","baseShift"],rt=V.value.encoding?`"${V.value.encoding}"`:"Default";for(const ut in ce)!et&&Ct.includes(ut)?ze.push(new Ut(ut,ce[ut],`In "${ie}": "${ut}" is only valid when "encoding" is set to "custom". ${rt} encoding found`)):Ee[ut]?ze=ze.concat(V.validateSpec({key:ut,value:ce[ut],valueSpec:Ee[ut],validateSpec:V.validateSpec,style:Ne,styleSpec:ve})):ze.push(new Ut(ut,ce[ut],`unknown property "${ut}"`));return ze})({sourceName:h,value:l,style:p.style,styleSpec:v,validateSpec:k}),B;case"geojson":if(B=Xl({key:h,value:l,valueSpec:v.source_geojson,style:S,styleSpec:v,validateSpec:k,objectElementValidators:Yg}),l.cluster)for(const V in l.clusterProperties){const[Z,ie]=l.clusterProperties[V],ce=typeof Z=="string"?[Z,["accumulated"],["get",V]]:Z;B.push(...wf({key:`${h}.${V}.map`,value:ie,expressionContext:"cluster-map"})),B.push(...wf({key:`${h}.${V}.reduce`,value:ce,expressionContext:"cluster-reduce"}))}return B;case"video":return Xl({key:h,value:l,valueSpec:v.source_video,style:S,validateSpec:k,styleSpec:v});case"image":return Xl({key:h,value:l,valueSpec:v.source_image,style:S,validateSpec:k,styleSpec:v});case"canvas":return[new Ut(h,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Sf({key:`${h}.type`,value:l.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]}})}}function Ud(p){const l=p.value,h=p.styleSpec,v=h.light,S=p.style;let k=[];const R=ni(l);if(l===void 0)return k;if(R!=="object")return k=k.concat([new Ut("light",l,`object expected, ${R} found`)]),k;for(const B in l){const V=B.match(/^(.*)-transition$/);k=k.concat(V&&v[V[1]]&&v[V[1]].transition?p.validateSpec({key:B,value:l[B],valueSpec:h.transition,validateSpec:p.validateSpec,style:S,styleSpec:h}):v[B]?p.validateSpec({key:B,value:l[B],valueSpec:v[B],validateSpec:p.validateSpec,style:S,styleSpec:h}):[new Ut(B,l[B],`unknown property "${B}"`)])}return k}function jy(p){const l=p.value,h=p.styleSpec,v=h.sky,S=p.style,k=ni(l);if(l===void 0)return[];if(k!=="object")return[new Ut("sky",l,`object expected, ${k} found`)];let R=[];for(const B in l)R=R.concat(v[B]?p.validateSpec({key:B,value:l[B],valueSpec:v[B],style:S,styleSpec:h}):[new Ut(B,l[B],`unknown property "${B}"`)]);return R}function Zg(p){const l=p.value,h=p.styleSpec,v=h.terrain,S=p.style;let k=[];const R=ni(l);if(l===void 0)return k;if(R!=="object")return k=k.concat([new Ut("terrain",l,`object expected, ${R} found`)]),k;for(const B in l)k=k.concat(v[B]?p.validateSpec({key:B,value:l[B],valueSpec:v[B],validateSpec:p.validateSpec,style:S,styleSpec:h}):[new Ut(B,l[B],`unknown property "${B}"`)]);return k}function Kg(p){let l=[];const h=p.value,v=p.key;if(Array.isArray(h)){const S=[],k=[];for(const R in h)h[R].id&&S.includes(h[R].id)&&l.push(new Ut(v,h,`all the sprites' ids must be unique, but ${h[R].id} is duplicated`)),S.push(h[R].id),h[R].url&&k.includes(h[R].url)&&l.push(new Ut(v,h,`all the sprites' URLs must be unique, but ${h[R].url} is duplicated`)),k.push(h[R].url),l=l.concat(Xl({key:`${v}[${R}]`,value:h[R],valueSpec:{id:{type:"string",required:!0},url:{type:"string",required:!0}},validateSpec:p.validateSpec}));return l}return Sc({key:v,value:h})}function Uy(p){return!!p&&p.constructor===Object}function Jg(p){return Uy(p.value)?[]:[new Ut(p.key,p.value,`object expected, ${ni(p.value)} found`)]}const Vp={"*":()=>[],array:ac,boolean:function(p){const l=p.value,h=p.key,v=ni(l);return v!=="boolean"?[new Ut(h,l,`boolean expected, ${v} found`)]:[]},number:dl,color:zh,constants:Lu,enum:Sf,filter:oh,function:jp,layer:jh,object:Xl,source:Up,light:Ud,sky:jy,terrain:Zg,projection:function(p){const l=p.value,h=p.styleSpec,v=h.projection,S=p.style,k=ni(l);if(l===void 0)return[];if(k!=="object")return[new Ut("projection",l,`object expected, ${k} found`)];let R=[];for(const B in l)R=R.concat(v[B]?p.validateSpec({key:B,value:l[B],valueSpec:v[B],style:S,styleSpec:h}):[new Ut(B,l[B],`unknown property "${B}"`)]);return R},projectionDefinition:function(p){const l=p.key;let h=p.value;h=h instanceof String?h.valueOf():h;const v=ni(h);return v!=="array"||(function(S){return Array.isArray(S)&&S.length===3&&typeof S[0]=="string"&&typeof S[1]=="string"&&typeof S[2]=="number"})(h)||(function(S){return!!["interpolate","step","literal"].includes(S[0])})(h)?["array","string"].includes(v)?[]:[new Ut(l,h,`projection expected, invalid type "${v}" found`)]:[new Ut(l,h,`projection expected, invalid array ${JSON.stringify(h)} found`)]},string:Sc,formatted:function(p){return Sc(p).length===0?[]:wf(p)},resolvedImage:function(p){return Sc(p).length===0?[]:wf(p)},padding:function(p){const l=p.key,h=p.value;if(ni(h)==="array"){if(h.length<1||h.length>4)return[new Ut(l,h,`padding requires 1 to 4 values; ${h.length} values found`)];const v={type:"number"};let S=[];for(let k=0;k<h.length;k++)S=S.concat(p.validateSpec({key:`${l}[${k}]`,value:h[k],validateSpec:p.validateSpec,valueSpec:v}));return S}return dl({key:l,value:h,valueSpec:{}})},numberArray:function(p){const l=p.key,h=p.value;if(ni(h)==="array"){const v={type:"number"};if(h.length<1)return[new Ut(l,h,"array length at least 1 expected, length 0 found")];let S=[];for(let k=0;k<h.length;k++)S=S.concat(p.validateSpec({key:`${l}[${k}]`,value:h[k],validateSpec:p.validateSpec,valueSpec:v}));return S}return dl({key:l,value:h,valueSpec:{}})},colorArray:function(p){const l=p.key,h=p.value;if(ni(h)==="array"){if(h.length<1)return[new Ut(l,h,"array length at least 1 expected, length 0 found")];let v=[];for(let S=0;S<h.length;S++)v=v.concat(zh({key:`${l}[${S}]`,value:h[S]}));return v}return zh({key:l,value:h})},variableAnchorOffsetCollection:function(p){const l=p.key,h=p.value,v=ni(h),S=p.styleSpec;if(v!=="array"||h.length<1||h.length%2!=0)return[new Ut(l,h,"variableAnchorOffsetCollection requires a non-empty array of even length")];let k=[];for(let R=0;R<h.length;R+=2)k=k.concat(Sf({key:`${l}[${R}]`,value:h[R],valueSpec:S.layout_symbol["text-anchor"]})),k=k.concat(ac({key:`${l}[${R+1}]`,value:h[R+1],valueSpec:{length:2,value:"number"},validateSpec:p.validateSpec,style:p.style,styleSpec:S}));return k},sprite:Kg,state:Jg,fontFaces:function(p){const l=p.key,h=p.value,v=p.validateSpec,S=p.styleSpec,k=p.style;if(!Uy(h))return[new Ut(l,h,`object expected, ${ni(h)} found`)];const R=[];for(const B in h){const V=h[B],Z=ni(V);if(Z==="string")R.push(...Sc({key:`${l}.${B}`,value:V}));else if(Z==="array"){const ie={url:{type:"string",required:!0},"unicode-range":{type:"array",value:"string"}};for(const[ce,ve]of V.entries())R.push(...Xl({key:`${l}.${B}[${ce}]`,value:ve,valueSpec:ie,styleSpec:S,style:k,validateSpec:v}))}else R.push(new Ut(`${l}.${B}`,V,`string or array expected, ${Z} found`))}return R}};function oc(p){const l=p.value,h=p.valueSpec,v=p.styleSpec;return p.validateSpec=oc,h.expression&&Nu(xa(l))?jp(p):h.expression&&qc(ah(l))?wf(p):h.type&&Vp[h.type]?Vp[h.type](p):Xl(Xr({},p,{valueSpec:h.type?v[h.type]:h}))}function Vy(p){const l=p.value,h=p.key,v=Sc(p);return v.length||(l.indexOf("{fontstack}")===-1&&v.push(new Ut(h,l,'"glyphs" url must include a "{fontstack}" token')),l.indexOf("{range}")===-1&&v.push(new Ut(h,l,'"glyphs" url must include a "{range}" token'))),v}function Fu(p,l=Mt){let h=[];return h=h.concat(oc({key:"",value:p,valueSpec:l.$root,styleSpec:l,style:p,validateSpec:oc,objectElementValidators:{glyphs:Vy,"*":()=>[]}})),p.constants&&(h=h.concat(Lu({key:"constants",value:p.constants}))),q(h)}function Bu(p){return function(l){return p(Object.assign({},l,{validateSpec:oc}))}}function q(p){return[].concat(p).sort(((l,h)=>l.line-h.line))}function K(p){return function(...l){return q(p.apply(this,l))}}Fu.source=K(Bu(Up)),Fu.sprite=K(Bu(Kg)),Fu.glyphs=K(Bu(Vy)),Fu.light=K(Bu(Ud)),Fu.sky=K(Bu(jy)),Fu.terrain=K(Bu(Zg)),Fu.state=K(Bu(Jg)),Fu.layer=K(Bu(jh)),Fu.filter=K(Bu(oh)),Fu.paintProperty=K(Bu(zd)),Fu.layoutProperty=K(Bu(jd));const ge={type:"enum","property-type":"data-constant",expression:{interpolated:!1,parameters:["global-state"]},values:{visible:{},none:{}},transition:!1,default:"visible"};class ke{constructor(l,h){this._globalState=h,this.setValue(l)}evaluate(){var l;return(l=this._literalValue)!==null&&l!==void 0?l:this._compiledValue.evaluate({})}setValue(l){if(l==null||l==="visible"||l==="none")return this._literalValue=l==="none"?"none":"visible",this._compiledValue=void 0,void(this._globalStateRefs=new Set);const h=rh(l,ge,this._globalState);if(h.result==="error")throw this._literalValue="visible",this._compiledValue=void 0,new Error(h.value.map((v=>`${v.key}: ${v.message}`)).join(", "));this._literalValue=void 0,this._compiledValue=h.value,this._globalStateRefs=xf(h.value.expression)}getGlobalStateRefs(){return this._globalStateRefs}}const Ye=Mt,Je=Fu,nt=Je.light,lt=Je.sky,yt=Je.paintProperty,At=Je.layoutProperty;function Yt(p,l){let h=!1;if(l&&l.length)for(const v of l)p.fire(new fn(new Error(v.message))),h=!0;return h}class br{constructor(l,h,v){const S=this.cells=[];if(l instanceof ArrayBuffer){this.arrayBuffer=l;const R=new Int32Array(this.arrayBuffer);l=R[0],this.d=(h=R[1])+2*(v=R[2]);for(let V=0;V<this.d*this.d;V++){const Z=R[3+V],ie=R[3+V+1];S.push(Z===ie?null:R.subarray(Z,ie))}const B=R[3+S.length+1];this.keys=R.subarray(R[3+S.length],B),this.bboxes=R.subarray(B),this.insert=this._insertReadonly}else{this.d=h+2*v;for(let R=0;R<this.d*this.d;R++)S.push([]);this.keys=[],this.bboxes=[]}this.n=h,this.extent=l,this.padding=v,this.scale=h/l,this.uid=0;const k=v/h*l;this.min=-k,this.max=l+k}insert(l,h,v,S,k){this._forEachCell(h,v,S,k,this._insertCell,this.uid++,void 0,void 0),this.keys.push(l),this.bboxes.push(h),this.bboxes.push(v),this.bboxes.push(S),this.bboxes.push(k)}_insertReadonly(){throw new Error("Cannot insert into a GridIndex created from an ArrayBuffer.")}_insertCell(l,h,v,S,k,R){this.cells[k].push(R)}query(l,h,v,S,k){const R=this.min,B=this.max;if(l<=R&&h<=R&&B<=v&&B<=S&&!k)return Array.prototype.slice.call(this.keys);{const V=[];return this._forEachCell(l,h,v,S,this._queryCell,V,{},k),V}}_queryCell(l,h,v,S,k,R,B,V){const Z=this.cells[k];if(Z!==null){const ie=this.keys,ce=this.bboxes;for(let ve=0;ve<Z.length;ve++){const Ee=Z[ve];if(B[Ee]===void 0){const Ne=4*Ee;(V?V(ce[Ne+0],ce[Ne+1],ce[Ne+2],ce[Ne+3]):l<=ce[Ne+2]&&h<=ce[Ne+3]&&v>=ce[Ne+0]&&S>=ce[Ne+1])?(B[Ee]=!0,R.push(ie[Ee])):B[Ee]=!1}}}}_forEachCell(l,h,v,S,k,R,B,V){const Z=this._convertToCellCoord(l),ie=this._convertToCellCoord(h),ce=this._convertToCellCoord(v),ve=this._convertToCellCoord(S);for(let Ee=Z;Ee<=ce;Ee++)for(let Ne=ie;Ne<=ve;Ne++){const ze=this.d*Ne+Ee;if((!V||V(this._convertFromCellCoord(Ee),this._convertFromCellCoord(Ne),this._convertFromCellCoord(Ee+1),this._convertFromCellCoord(Ne+1)))&&k.call(this,l,h,v,S,ze,R,B,V))return}}_convertFromCellCoord(l){return(l-this.padding)/this.scale}_convertToCellCoord(l){return Math.max(0,Math.min(this.d-1,Math.floor(l*this.scale)+this.padding))}toArrayBuffer(){if(this.arrayBuffer)return this.arrayBuffer;const l=this.cells,h=3+this.cells.length+1+1;let v=0;for(let R=0;R<this.cells.length;R++)v+=this.cells[R].length;const S=new Int32Array(h+v+this.keys.length+this.bboxes.length);S[0]=this.extent,S[1]=this.n,S[2]=this.padding;let k=h;for(let R=0;R<l.length;R++){const B=l[R];S[3+R]=k,S.set(B,k),k+=B.length}return S[3+l.length]=k,S.set(this.keys,k),k+=this.keys.length,S[3+l.length+1]=k,S.set(this.bboxes,k),k+=this.bboxes.length,S.buffer}static serialize(l,h){const v=l.toArrayBuffer();return h&&h.push(v),{buffer:v}}static deserialize(l){return new br(l.buffer)}}const St={};function Pt(p,l,h={}){if(St[p])throw new Error(`${p} is already registered.`);Object.defineProperty(l,"_classRegistryKey",{value:p,writeable:!1}),St[p]={klass:l,omit:h.omit||[],shallow:h.shallow||[]}}Pt("Object",Object),Pt("Set",Set),Pt("TransferableGridIndex",br),Pt("Color",kr),Pt("Error",Error),Pt("AJAXError",mt),Pt("ResolvedImage",wi),Pt("StylePropertyFunction",Fp),Pt("StyleExpression",Od,{omit:["_evaluator"]}),Pt("ZoomDependentExpression",Hg),Pt("ZoomConstantExpression",Np),Pt("CompoundExpression",En,{omit:["_evaluate"]});for(const p in Fn)Fn[p]._classRegistryKey||Pt(`Expression_${p}`,Fn[p]);function hr(p){return p&&typeof ArrayBuffer<"u"&&(p instanceof ArrayBuffer||p.constructor&&p.constructor.name==="ArrayBuffer")}function Lr(p){return p.$name||p.constructor._classRegistryKey}function yr(p){return!(function(l){if(l===null||typeof l!="object")return!1;const h=Lr(l);return!(!h||h==="Object")})(p)&&(p==null||typeof p=="boolean"||typeof p=="number"||typeof p=="string"||p instanceof Boolean||p instanceof Number||p instanceof String||p instanceof Date||p instanceof RegExp||p instanceof Blob||p instanceof Error||hr(p)||cr(p)||ArrayBuffer.isView(p)||p instanceof ImageData)}function Br(p,l){if(yr(p))return(hr(p)||cr(p))&&l&&l.push(p),ArrayBuffer.isView(p)&&l&&l.push(p.buffer),p instanceof ImageData&&l&&l.push(p.data.buffer),p;if(Array.isArray(p)){const k=[];for(const R of p)k.push(Br(R,l));return k}if(typeof p!="object")throw new Error("can't serialize object of type "+typeof p);const h=Lr(p);if(!h)throw new Error(`can't serialize object of unregistered class ${p.constructor.name}`);if(!St[h])throw new Error(`${h} is not registered.`);const{klass:v}=St[h],S=v.serialize?v.serialize(p,l):{};if(v.serialize){if(l&&S===l[l.length-1])throw new Error("statically serialized object won't survive transfer of $name property")}else{for(const k in p){if(!p.hasOwnProperty(k)||St[h].omit.indexOf(k)>=0)continue;const R=p[k];S[k]=St[h].shallow.indexOf(k)>=0?R:Br(R,l)}p instanceof Error&&(S.message=p.message)}if(S.$name)throw new Error("$name property is reserved for worker serialization logic.");return h!=="Object"&&(S.$name=h),S}function jr(p){if(yr(p))return p;if(Array.isArray(p))return p.map(jr);if(typeof p!="object")throw new Error("can't deserialize object of type "+typeof p);const l=Lr(p)||"Object";if(!St[l])throw new Error(`can't deserialize unregistered class ${l}`);const{klass:h}=St[l];if(!h)throw new Error(`can't deserialize unregistered class ${l}`);if(h.deserialize)return h.deserialize(p);const v=Object.create(h.prototype);for(const S of Object.keys(p)){if(S==="$name")continue;const k=p[S];v[S]=St[l].shallow.indexOf(S)>=0?k:jr(k)}return v}class sn{constructor(){this.first=!0}update(l,h){const v=Math.floor(l);return this.first?(this.first=!1,this.lastIntegerZoom=v,this.lastIntegerZoomTime=0,this.lastZoom=l,this.lastFloorZoom=v,!0):(this.lastFloorZoom>v?(this.lastIntegerZoom=v+1,this.lastIntegerZoomTime=h):this.lastFloorZoom<v&&(this.lastIntegerZoom=v,this.lastIntegerZoomTime=h),l!==this.lastZoom&&(this.lastZoom=l,this.lastFloorZoom=v,!0))}}function Jr(p){return/[\u02EA\u02EB\u2E80-\u2FDF\u2FF0-\u303F\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FD-\u30FF\u3105-\u312F\u31A0-\u4DBF\u4E00-\uA48C\uA490-\uA4C6\uF900-\uFA6D\uFA70-\uFAD9\uFE10-\uFE1F\uFE30-\uFE4F\uFF00-\uFFEF]|\uD81B[\uDFE0-\uDFFF]|[\uD81C-\uD822\uD840-\uD868\uD86A-\uD86D\uD86F-\uD872\uD874-\uD879\uD880-\uD883\uD885-\uD88C][\uDC00-\uDFFF]|\uD823[\uDC00-\uDCD5\uDCFF-\uDD1E\uDD80-\uDDF2]|\uD82B[\uDFF0-\uDFFF]|\uD82C[\uDC00-\uDEFB]|\uD83C[\uDE00-\uDEFF]|\uD869[\uDC00-\uDEDF\uDF00-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEAD\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0\uDFF0-\uDFFF]|\uD87B[\uDC00-\uDE5D]|\uD87E[\uDC00-\uDE1D]|\uD884[\uDC00-\uDF4A\uDF50-\uDFFF]|\uD88D[\uDC00-\uDC79]/gim.test(String.fromCodePoint(p))}function Jn(p){return/[\u02EA\u02EB\u1100-\u11FF\u1400-\u167F\u18B0-\u18F5\u2E80-\u2E99\u2E9B-\u2EF3\u2F00-\u2FD5\u2FF0-\u3007\u3012\u3013\u3020-\u302F\u3031-\u303F\u3041-\u3096\u309D-\u30FB\u30FD-\u30FF\u3105-\u312F\u3131-\u318E\u3190-\uA48C\uA490-\uA4C6\uA960-\uA97C\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFE10-\uFE1F\uFE30-\uFE48\uFE50-\uFE57\uFE5F-\uFE62\uFE67-\uFE6F\uFF00-\uFF07\uFF0A-\uFF0C\uFF0E-\uFF19\uFF1F-\uFF3A\uFF3C\uFF3E\uFF40-\uFF5A\uFFE0-\uFFE2\uFFE4-\uFFE7]|\uD802[\uDD80-\uDD9F]|\uD805[\uDD80-\uDDFF]|\uD806[\uDE00-\uDEBF]|\uD811[\uDC00-\uDE7F]|\uD81B[\uDFE0-\uDFE4\uDFF0-\uDFF6]|[\uD81C-\uD822\uD83D\uD840-\uD868\uD86A-\uD86D\uD86F-\uD872\uD874-\uD879\uD880-\uD883\uD885-\uD88C][\uDC00-\uDFFF]|\uD823[\uDC00-\uDCD5\uDCFF-\uDD1E\uDD80-\uDDF2]|\uD82B[\uDFF0-\uDFF3\uDFF5-\uDFFB\uDFFD\uDFFE]|\uD82C[\uDC00-\uDD22\uDD30-\uDEFB]|\uD833[\uDEC0-\uDFCF]|\uD834[\uDC00-\uDDFF\uDEE0-\uDF7F]|\uD836[\uDC00-\uDEAF]|\uD83C[\uDC00-\uDE00\uDF00-\uDFFF]|\uD83E[\uDD00-\uDEFF]|\uD869[\uDC00-\uDEDF\uDF00-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEAD\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0\uDFF0-\uDFFF]|\uD87B[\uDC00-\uDE5D]|\uD87E[\uDC00-\uDE1D]|\uD884[\uDC00-\uDF4A\uDF50-\uDFFF]|\uD88D[\uDC00-\uDC79]/gim.test(String.fromCodePoint(p))}function Vn(p){return/\s/u.test(String.fromCodePoint(p))}function Ai(p){for(const l of p)if(Jn(l.codePointAt(0)))return!0;return!1}function Zn(p){for(const l of p)if(!Ni(l.codePointAt(0)))return!1;return!0}function Yi(p){const l=p.map((h=>{try{return new RegExp(`\\p{sc=${h}}`,"u").source}catch{return null}})).filter((h=>h));return new RegExp(l.join("|"),"u")}const No=Yi(["Arab","Dupl","Mong","Ougr","Syrc"]);function Ni(p){return!No.test(String.fromCodePoint(p))}function Yn(p){return!(Jn(p)||(l=p,/[\xA7\xA9\xAE\xB1\xBC-\xBE\xD7\xF7\u2016\u2020\u2021\u2030\u2031\u203B\u203C\u2042\u2047-\u2049\u2051\u2100-\u218F\u221E\u2234\u2235\u2300-\u2307\u230C-\u231F\u2324-\u2328\u232B\u237D-\u239A\u23BE-\u23CD\u23CF\u23D1-\u23DB\u23E2-\u2422\u2424-\u24FF\u25A0-\u2619\u2620-\u2767\u2776-\u2793\u2B12-\u2B2F\u2B50-\u2B59\u2BB8-\u2BEB\u3000-\u303F\u30A0-\u30FF\uE000-\uF8FF\uFE30-\uFE6F\uFF00-\uFFEF\uFFFC\uFFFD]|[\uDB80-\uDBFF][\uDC00-\uDFFF]/gim.test(String.fromCodePoint(l))));var l}const wn=Yi(["Adlm","Arab","Armi","Avst","Chrs","Cprt","Egyp","Elym","Gara","Hatr","Hebr","Hung","Khar","Lydi","Mand","Mani","Mend","Merc","Mero","Narb","Nbat","Nkoo","Orkh","Palm","Phli","Phlp","Phnx","Prti","Rohg","Samr","Sarb","Sogo","Syrc","Thaa","Todr","Yezi"]);function To(p){return wn.test(String.fromCodePoint(p))}function Pi(p,l){return!(!l&&To(p)||/[\u0900-\u0DFF\u0F00-\u109F\u1780-\u17FF]/gim.test(String.fromCodePoint(p)))}function aa(p){for(const l of p)if(To(l.codePointAt(0)))return!0;return!1}const da=new class{constructor(){this.TIMEOUT=5e3,this.applyArabicShaping=null,this.processBidirectionalText=null,this.processStyledBidirectionalText=null,this.pluginStatus="unavailable",this.pluginURL=null,this.loadScriptResolve=()=>{}}setState(p){this.pluginStatus=p.pluginStatus,this.pluginURL=p.pluginURL}getState(){return{pluginStatus:this.pluginStatus,pluginURL:this.pluginURL}}setMethods(p){if(da.isParsed())throw new Error("RTL text plugin already registered.");this.applyArabicShaping=p.applyArabicShaping,this.processBidirectionalText=p.processBidirectionalText,this.processStyledBidirectionalText=p.processStyledBidirectionalText,this.loadScriptResolve()}isParsed(){return this.applyArabicShaping!=null&&this.processBidirectionalText!=null&&this.processStyledBidirectionalText!=null}getRTLTextPluginStatus(){return this.pluginStatus}syncState(p,l){return o(this,void 0,void 0,(function*(){if(this.isParsed())return this.getState();if(p.pluginStatus!=="loading")return this.setState(p),p;const h=p.pluginURL,v=new Promise((k=>{this.loadScriptResolve=k}));l(h);const S=new Promise((k=>setTimeout((()=>k()),this.TIMEOUT)));if(yield Promise.race([v,S]),this.isParsed()){const k={pluginStatus:"loaded",pluginURL:h};return this.setState(k),k}throw this.setState({pluginStatus:"error",pluginURL:""}),new Error(`RTL Text Plugin failed to import scripts from ${h}`)}))}};class ki{constructor(l,h){this.isSupportedScript=kl,this.zoom=l,h?(this.now=h.now||0,this.fadeDuration=h.fadeDuration||0,this.zoomHistory=h.zoomHistory||new sn,this.transition=h.transition||{}):(this.now=0,this.fadeDuration=0,this.zoomHistory=new sn,this.transition={})}crossFadingFactor(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){const l=this.zoom,h=l-Math.floor(l),v=this.crossFadingFactor();return l>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:h+(1-h)*v}:{fromScale:.5,toScale:1,t:1-(1-v)*h}}}function kl(p){return(function(l,h){for(const v of l)if(!Pi(v.codePointAt(0),h))return!1;return!0})(p,da.getRTLTextPluginStatus()==="loaded")}const Qa="-transition";class ys{constructor(l,h,v){this.property=l,this.value=h,this.expression=(function(S,k,R){if(Nu(S))return new Fp(S,k);if(qc(S)){const B=Lp(S,k,R);if(B.result==="error")throw new Error(B.value.map((V=>`${V.key}: ${V.message}`)).join(", "));return B.value}{let B=S;return k.type==="color"&&typeof S=="string"?B=kr.parse(S):k.type!=="padding"||typeof S!="number"&&!Array.isArray(S)?k.type!=="numberArray"||typeof S!="number"&&!Array.isArray(S)?k.type!=="colorArray"||typeof S!="string"&&!Array.isArray(S)?k.type==="variableAnchorOffsetCollection"&&Array.isArray(S)?B=ba.parse(S):k.type==="projectionDefinition"&&typeof S=="string"&&(B=hi.parse(S)):B=mn.parse(S):B=hn.parse(S):B=Mr.parse(S),{globalStateRefs:new Set,_globalState:null,kind:"constant",evaluate:()=>B}}})(h===void 0?l.specification.default:h,l.specification,v)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}getGlobalStateRefs(){return this.expression.globalStateRefs||new Set}possiblyEvaluate(l,h,v){return this.property.possiblyEvaluate(this,l,h,v)}}class ks{constructor(l,h){this.property=l,this.value=new ys(l,void 0,h)}transitioned(l,h){return new sa(this.property,this.value,h,Be({},l.transition,this.transition),l.now)}untransitioned(){return new sa(this.property,this.value,null,{},0)}}class Go{constructor(l,h){this._properties=l,this._values=Object.create(l.defaultTransitionablePropertyValues),this._globalState=h}getValue(l){return be(this._values[l].value.value)}setValue(l,h){Object.prototype.hasOwnProperty.call(this._values,l)||(this._values[l]=new ks(this._values[l].property,this._globalState)),this._values[l].value=new ys(this._values[l].property,h===null?void 0:be(h),this._globalState)}getTransition(l){return be(this._values[l].transition)}setTransition(l,h){Object.prototype.hasOwnProperty.call(this._values,l)||(this._values[l]=new ks(this._values[l].property,this._globalState)),this._values[l].transition=be(h)||void 0}serialize(){const l={};for(const h of Object.keys(this._values)){const v=this.getValue(h);v!==void 0&&(l[h]=v);const S=this.getTransition(h);S!==void 0&&(l[`${h}${Qa}`]=S)}return l}transitioned(l,h){const v=new wa(this._properties);for(const S of Object.keys(this._values))v._values[S]=this._values[S].transitioned(l,h._values[S]);return v}untransitioned(){const l=new wa(this._properties);for(const h of Object.keys(this._values))l._values[h]=this._values[h].untransitioned();return l}}class sa{constructor(l,h,v,S,k){this.property=l,this.value=h,this.begin=k+S.delay||0,this.end=this.begin+S.duration||0,l.specification.transition&&(S.delay||S.duration)&&(this.prior=v)}possiblyEvaluate(l,h,v){const S=l.now||0,k=this.value.possiblyEvaluate(l,h,v),R=this.prior;if(R){if(S>this.end)return this.prior=null,k;if(this.value.isDataDriven())return this.prior=null,k;if(S<this.begin)return R.possiblyEvaluate(l,h,v);{const B=(S-this.begin)/(this.end-this.begin);return this.property.interpolate(R.possiblyEvaluate(l,h,v),k,Se(B))}}return k}}class wa{constructor(l){this._properties=l,this._values=Object.create(l.defaultTransitioningPropertyValues)}possiblyEvaluate(l,h,v){const S=new Wo(this._properties);for(const k of Object.keys(this._values))S._values[k]=this._values[k].possiblyEvaluate(l,h,v);return S}hasTransition(){for(const l of Object.keys(this._values))if(this._values[l].prior)return!0;return!1}}class Co{constructor(l,h){this._properties=l,this._values=Object.create(l.defaultPropertyValues),this._globalState=h}hasValue(l){return this._values[l].value!==void 0}getValue(l){return be(this._values[l].value)}setValue(l,h){this._values[l]=new ys(this._values[l].property,h===null?void 0:be(h),this._globalState)}serialize(){const l={};for(const h of Object.keys(this._values)){const v=this.getValue(h);v!==void 0&&(l[h]=v)}return l}possiblyEvaluate(l,h,v){const S=new Wo(this._properties);for(const k of Object.keys(this._values))S._values[k]=this._values[k].possiblyEvaluate(l,h,v);return S}}class qi{constructor(l,h,v){this.property=l,this.value=h,this.parameters=v}isConstant(){return this.value.kind==="constant"}constantOr(l){return this.value.kind==="constant"?this.value.value:l}evaluate(l,h,v,S){return this.property.evaluate(this.value,this.parameters,l,h,v,S)}}class Wo{constructor(l){this._properties=l,this._values=Object.create(l.defaultPossiblyEvaluatedValues)}get(l){return this._values[l]}}class Tn{constructor(l){this.specification=l}possiblyEvaluate(l,h){if(l.isDataDriven())throw new Error("Value should not be data driven");return l.expression.evaluate(h)}interpolate(l,h,v){const S=Hn[this.specification.type];return S?S(l,h,v):l}}class Sn{constructor(l,h){this.specification=l,this.overrides=h}possiblyEvaluate(l,h,v,S){return new qi(this,l.expression.kind==="constant"||l.expression.kind==="camera"?{kind:"constant",value:l.expression.evaluate(h,null,{},v,S)}:l.expression,h)}interpolate(l,h,v){if(l.value.kind!=="constant"||h.value.kind!=="constant")return l;if(l.value.value===void 0||h.value.value===void 0)return new qi(this,{kind:"constant",value:void 0},l.parameters);const S=Hn[this.specification.type];if(S){const k=S(l.value.value,h.value.value,v);return new qi(this,{kind:"constant",value:k},l.parameters)}return l}evaluate(l,h,v,S,k,R){return l.kind==="constant"?l.value:l.evaluate(h,v,S,k,R)}}class Rs extends Sn{possiblyEvaluate(l,h,v,S){if(l.value===void 0)return new qi(this,{kind:"constant",value:void 0},h);if(l.expression.kind==="constant"){const k=l.expression.evaluate(h,null,{},v,S),R=l.property.specification.type==="resolvedImage"&&typeof k!="string"?k.name:k,B=this._calculate(R,R,R,h);return new qi(this,{kind:"constant",value:B},h)}if(l.expression.kind==="camera"){const k=this._calculate(l.expression.evaluate({zoom:h.zoom-1}),l.expression.evaluate({zoom:h.zoom}),l.expression.evaluate({zoom:h.zoom+1}),h);return new qi(this,{kind:"constant",value:k},h)}return new qi(this,l.expression,h)}evaluate(l,h,v,S,k,R){if(l.kind==="source"){const B=l.evaluate(h,v,S,k,R);return this._calculate(B,B,B,h)}return l.kind==="composite"?this._calculate(l.evaluate({zoom:Math.floor(h.zoom)-1},v,S),l.evaluate({zoom:Math.floor(h.zoom)},v,S),l.evaluate({zoom:Math.floor(h.zoom)+1},v,S),h):l.value}_calculate(l,h,v,S){return S.zoom>S.zoomHistory.lastIntegerZoom?{from:l,to:h}:{from:v,to:h}}interpolate(l){return l}}class Sa{constructor(l){this.specification=l}possiblyEvaluate(l,h,v,S){if(l.value!==void 0){if(l.expression.kind==="constant"){const k=l.expression.evaluate(h,null,{},v,S);return this._calculate(k,k,k,h)}return this._calculate(l.expression.evaluate(new ki(Math.floor(h.zoom-1),h)),l.expression.evaluate(new ki(Math.floor(h.zoom),h)),l.expression.evaluate(new ki(Math.floor(h.zoom+1),h)),h)}}_calculate(l,h,v,S){return S.zoom>S.zoomHistory.lastIntegerZoom?{from:l,to:h}:{from:v,to:h}}interpolate(l){return l}}class Lo{constructor(l){this.specification=l}possiblyEvaluate(l,h,v,S){return!!l.expression.evaluate(h,null,{},v,S)}interpolate(){return!1}}class $a{constructor(l){this.properties=l,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(const h in l){const v=l[h];v.specification.overridable&&this.overridableProperties.push(h);const S=this.defaultPropertyValues[h]=new ys(v,void 0,void 0),k=this.defaultTransitionablePropertyValues[h]=new ks(v,void 0);this.defaultTransitioningPropertyValues[h]=k.untransitioned(),this.defaultPossiblyEvaluatedValues[h]=S.possiblyEvaluate({})}}}Pt("DataDrivenProperty",Sn),Pt("DataConstantProperty",Tn),Pt("CrossFadedDataDrivenProperty",Rs),Pt("CrossFadedProperty",Sa),Pt("ColorRampProperty",Lo);class eo extends zr{constructor(l,h,v){if(super(),this.id=l.id,this.type=l.type,this._globalState=v,this._featureFilter={filter:()=>!0,needGeometry:!1,getGlobalStateRefs:()=>new Set},this._visibilityExpression=(function(S,k){return new ke(S,k)})(this.visibility,v),l.type!=="custom"&&(this.metadata=l.metadata,this.minzoom=l.minzoom,this.maxzoom=l.maxzoom,l.type!=="background"&&(this.source=l.source,this.sourceLayer=l["source-layer"],this.filter=l.filter,this._featureFilter=ih(l.filter,v)),h.layout&&(this._unevaluatedLayout=new Co(h.layout,v)),h.paint)){this._transitionablePaint=new Go(h.paint,v);for(const S in l.paint)this.setPaintProperty(S,l.paint[S],{validate:!1});for(const S in l.layout)this.setLayoutProperty(S,l.layout[S],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new Wo(h.paint)}}setFilter(l){this.filter=l,this._featureFilter=ih(l,this._globalState)}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(l){return l==="visibility"?this.visibility:this._unevaluatedLayout.getValue(l)}getLayoutAffectingGlobalStateRefs(){const l=new Set;for(const h of this._visibilityExpression.getGlobalStateRefs())l.add(h);if(this._unevaluatedLayout)for(const h in this._unevaluatedLayout._values){const v=this._unevaluatedLayout._values[h];for(const S of v.getGlobalStateRefs())l.add(S)}for(const h of this._featureFilter.getGlobalStateRefs())l.add(h);return l}getPaintAffectingGlobalStateRefs(){var l;const h=new globalThis.Map;if(this._transitionablePaint)for(const v in this._transitionablePaint._values){const S=this._transitionablePaint._values[v].value;for(const k of S.getGlobalStateRefs()){const R=(l=h.get(k))!==null&&l!==void 0?l:[];R.push({name:v,value:S.value}),h.set(k,R)}}return h}getVisibilityAffectingGlobalStateRefs(){return this._visibilityExpression.getGlobalStateRefs()}setLayoutProperty(l,h,v={}){if(h==null||!this._validate(At,`layers.${this.id}.layout.${l}`,l,h,v))return l==="visibility"?(this.visibility=h,this._visibilityExpression.setValue(h),void this.recalculateVisibility()):void this._unevaluatedLayout.setValue(l,h)}getPaintProperty(l){return l.endsWith(Qa)?this._transitionablePaint.getTransition(l.slice(0,-11)):this._transitionablePaint.getValue(l)}setPaintProperty(l,h,v={}){if(h!=null&&this._validate(yt,`layers.${this.id}.paint.${l}`,l,h,v))return!1;if(l.endsWith(Qa))return this._transitionablePaint.setTransition(l.slice(0,-11),h||void 0),!1;{const S=this._transitionablePaint._values[l],k=S.property.specification["property-type"]==="cross-faded-data-driven",R=S.value.isDataDriven(),B=S.value;this._transitionablePaint.setValue(l,h),this._handleSpecialPaintPropertyUpdate(l);const V=this._transitionablePaint._values[l].value;return V.isDataDriven()||R||k||this._handleOverridablePaintPropertyUpdate(l,B,V)}}_handleSpecialPaintPropertyUpdate(l){}_handleOverridablePaintPropertyUpdate(l,h,v){return!1}isHidden(l=this.minzoom,h=!1){return!!(this.minzoom&&l<(h?Math.floor(this.minzoom):this.minzoom))||!!(this.maxzoom&&l>=this.maxzoom)||this._evaluatedVisibility==="none"}updateTransitions(l){this._transitioningPaint=this._transitionablePaint.transitioned(l,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculateVisibility(){this._evaluatedVisibility=this._visibilityExpression.evaluate()}recalculate(l,h){l.getCrossfadeParameters&&(this._crossfadeParameters=l.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(l,void 0,h)),this.paint=this._transitioningPaint.possiblyEvaluate(l,void 0,h)}serialize(){const l={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(l.layout=l.layout||{},l.layout.visibility=this.visibility),it(l,((h,v)=>!(h===void 0||v==="layout"&&!Object.keys(h).length||v==="paint"&&!Object.keys(h).length)))}_validate(l,h,v,S,k={}){return(!k||k.validate!==!1)&&Yt(this,l.call(Je,{key:h,layerType:this.type,objectKey:v,value:S,styleSpec:Mt,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const l in this.paint._values){const h=this.paint.get(l);if(h instanceof qi&&Gl(h.property.specification)&&(h.value.kind==="source"||h.value.kind==="composite")&&h.value.isStateDependent)return!0}return!1}}let Rl;var Yl={get paint(){return Rl=Rl||new $a({"raster-opacity":new Tn(Mt.paint_raster["raster-opacity"]),"raster-hue-rotate":new Tn(Mt.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new Tn(Mt.paint_raster["raster-brightness-min"]),"raster-brightness-max":new Tn(Mt.paint_raster["raster-brightness-max"]),"raster-saturation":new Tn(Mt.paint_raster["raster-saturation"]),"raster-contrast":new Tn(Mt.paint_raster["raster-contrast"]),"raster-resampling":new Tn(Mt.paint_raster["raster-resampling"]),"raster-fade-duration":new Tn(Mt.paint_raster["raster-fade-duration"])})}};class Zl extends eo{constructor(l,h){super(l,Yl,h)}}const gu={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class Ea{constructor(l,h){this._structArray=l,this._pos1=h*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class ia{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(l,h){return l._trim(),h&&(l.isTransferred=!0,h.push(l.arrayBuffer)),{length:l.length,arrayBuffer:l.arrayBuffer}}static deserialize(l){const h=Object.create(this.prototype);return h.arrayBuffer=l.arrayBuffer,h.length=l.length,h.capacity=l.arrayBuffer.byteLength/h.bytesPerElement,h._refreshViews(),h}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(l){this.reserve(l),this.length=l}reserve(l){if(l>this.capacity){this.capacity=Math.max(l,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const h=this.uint8;this._refreshViews(),h&&this.uint8.set(h)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}}function pa(p,l=1){let h=0,v=0;return{members:p.map((S=>{const k=gu[S.type].BYTES_PER_ELEMENT,R=h=mu(h,Math.max(l,k)),B=S.components||1;return v=Math.max(v,k),h+=k*B,{name:S.name,type:S.type,components:B,offset:R}})),size:mu(h,Math.max(v,l)),alignment:l}}function mu(p,l){return Math.ceil(p/l)*l}class yu extends ia{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(l,h){const v=this.length;return this.resize(v+1),this.emplace(v,l,h)}emplace(l,h,v){const S=2*l;return this.int16[S+0]=h,this.int16[S+1]=v,l}}yu.prototype.bytesPerElement=4,Pt("StructArrayLayout2i4",yu);class is extends ia{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(l,h,v){const S=this.length;return this.resize(S+1),this.emplace(S,l,h,v)}emplace(l,h,v,S){const k=3*l;return this.int16[k+0]=h,this.int16[k+1]=v,this.int16[k+2]=S,l}}is.prototype.bytesPerElement=6,Pt("StructArrayLayout3i6",is);class Uh extends ia{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(l,h,v,S){const k=this.length;return this.resize(k+1),this.emplace(k,l,h,v,S)}emplace(l,h,v,S,k){const R=4*l;return this.int16[R+0]=h,this.int16[R+1]=v,this.int16[R+2]=S,this.int16[R+3]=k,l}}Uh.prototype.bytesPerElement=8,Pt("StructArrayLayout4i8",Uh);class Vh extends ia{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(l,h,v,S,k,R){const B=this.length;return this.resize(B+1),this.emplace(B,l,h,v,S,k,R)}emplace(l,h,v,S,k,R,B){const V=6*l;return this.int16[V+0]=h,this.int16[V+1]=v,this.int16[V+2]=S,this.int16[V+3]=k,this.int16[V+4]=R,this.int16[V+5]=B,l}}Vh.prototype.bytesPerElement=12,Pt("StructArrayLayout2i4i12",Vh);class $h extends ia{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(l,h,v,S,k,R){const B=this.length;return this.resize(B+1),this.emplace(B,l,h,v,S,k,R)}emplace(l,h,v,S,k,R,B){const V=4*l,Z=8*l;return this.int16[V+0]=h,this.int16[V+1]=v,this.uint8[Z+4]=S,this.uint8[Z+5]=k,this.uint8[Z+6]=R,this.uint8[Z+7]=B,l}}$h.prototype.bytesPerElement=8,Pt("StructArrayLayout2i4ub8",$h);class Gc extends ia{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(l,h){const v=this.length;return this.resize(v+1),this.emplace(v,l,h)}emplace(l,h,v){const S=2*l;return this.float32[S+0]=h,this.float32[S+1]=v,l}}Gc.prototype.bytesPerElement=8,Pt("StructArrayLayout2f8",Gc);class Wc extends ia{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(l,h,v,S,k,R,B,V,Z,ie){const ce=this.length;return this.resize(ce+1),this.emplace(ce,l,h,v,S,k,R,B,V,Z,ie)}emplace(l,h,v,S,k,R,B,V,Z,ie,ce){const ve=10*l;return this.uint16[ve+0]=h,this.uint16[ve+1]=v,this.uint16[ve+2]=S,this.uint16[ve+3]=k,this.uint16[ve+4]=R,this.uint16[ve+5]=B,this.uint16[ve+6]=V,this.uint16[ve+7]=Z,this.uint16[ve+8]=ie,this.uint16[ve+9]=ce,l}}Wc.prototype.bytesPerElement=20,Pt("StructArrayLayout10ui20",Wc);class $p extends ia{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(l,h,v,S,k,R,B,V){const Z=this.length;return this.resize(Z+1),this.emplace(Z,l,h,v,S,k,R,B,V)}emplace(l,h,v,S,k,R,B,V,Z){const ie=8*l;return this.uint16[ie+0]=h,this.uint16[ie+1]=v,this.uint16[ie+2]=S,this.uint16[ie+3]=k,this.uint16[ie+4]=R,this.uint16[ie+5]=B,this.uint16[ie+6]=V,this.uint16[ie+7]=Z,l}}$p.prototype.bytesPerElement=16,Pt("StructArrayLayout8ui16",$p);class sh extends ia{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(l,h,v,S,k,R,B,V,Z,ie,ce,ve){const Ee=this.length;return this.resize(Ee+1),this.emplace(Ee,l,h,v,S,k,R,B,V,Z,ie,ce,ve)}emplace(l,h,v,S,k,R,B,V,Z,ie,ce,ve,Ee){const Ne=12*l;return this.int16[Ne+0]=h,this.int16[Ne+1]=v,this.int16[Ne+2]=S,this.int16[Ne+3]=k,this.uint16[Ne+4]=R,this.uint16[Ne+5]=B,this.uint16[Ne+6]=V,this.uint16[Ne+7]=Z,this.int16[Ne+8]=ie,this.int16[Ne+9]=ce,this.int16[Ne+10]=ve,this.int16[Ne+11]=Ee,l}}sh.prototype.bytesPerElement=24,Pt("StructArrayLayout4i4ui4i24",sh);class sc extends ia{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(l,h,v){const S=this.length;return this.resize(S+1),this.emplace(S,l,h,v)}emplace(l,h,v,S){const k=3*l;return this.float32[k+0]=h,this.float32[k+1]=v,this.float32[k+2]=S,l}}sc.prototype.bytesPerElement=12,Pt("StructArrayLayout3f12",sc);class Vd extends ia{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(l){const h=this.length;return this.resize(h+1),this.emplace(h,l)}emplace(l,h){return this.uint32[1*l+0]=h,l}}Vd.prototype.bytesPerElement=4,Pt("StructArrayLayout1ul4",Vd);class Qg extends ia{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(l,h,v,S,k,R,B,V,Z){const ie=this.length;return this.resize(ie+1),this.emplace(ie,l,h,v,S,k,R,B,V,Z)}emplace(l,h,v,S,k,R,B,V,Z,ie){const ce=10*l,ve=5*l;return this.int16[ce+0]=h,this.int16[ce+1]=v,this.int16[ce+2]=S,this.int16[ce+3]=k,this.int16[ce+4]=R,this.int16[ce+5]=B,this.uint32[ve+3]=V,this.uint16[ce+8]=Z,this.uint16[ce+9]=ie,l}}Qg.prototype.bytesPerElement=20,Pt("StructArrayLayout6i1ul2ui20",Qg);class qh extends ia{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(l,h,v,S,k,R){const B=this.length;return this.resize(B+1),this.emplace(B,l,h,v,S,k,R)}emplace(l,h,v,S,k,R,B){const V=6*l;return this.int16[V+0]=h,this.int16[V+1]=v,this.int16[V+2]=S,this.int16[V+3]=k,this.int16[V+4]=R,this.int16[V+5]=B,l}}qh.prototype.bytesPerElement=12,Pt("StructArrayLayout2i2i2i12",qh);class Ef extends ia{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(l,h,v,S,k){const R=this.length;return this.resize(R+1),this.emplace(R,l,h,v,S,k)}emplace(l,h,v,S,k,R){const B=4*l,V=8*l;return this.float32[B+0]=h,this.float32[B+1]=v,this.float32[B+2]=S,this.int16[V+6]=k,this.int16[V+7]=R,l}}Ef.prototype.bytesPerElement=16,Pt("StructArrayLayout2f1f2i16",Ef);class Hh extends ia{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(l,h,v,S,k,R){const B=this.length;return this.resize(B+1),this.emplace(B,l,h,v,S,k,R)}emplace(l,h,v,S,k,R,B){const V=16*l,Z=4*l,ie=8*l;return this.uint8[V+0]=h,this.uint8[V+1]=v,this.float32[Z+1]=S,this.float32[Z+2]=k,this.int16[ie+6]=R,this.int16[ie+7]=B,l}}Hh.prototype.bytesPerElement=16,Pt("StructArrayLayout2ub2f2i16",Hh);class Gh extends ia{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(l,h,v){const S=this.length;return this.resize(S+1),this.emplace(S,l,h,v)}emplace(l,h,v,S){const k=3*l;return this.uint16[k+0]=h,this.uint16[k+1]=v,this.uint16[k+2]=S,l}}Gh.prototype.bytesPerElement=6,Pt("StructArrayLayout3ui6",Gh);class Tf extends ia{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(l,h,v,S,k,R,B,V,Z,ie,ce,ve,Ee,Ne,ze,Ve,et){const Ct=this.length;return this.resize(Ct+1),this.emplace(Ct,l,h,v,S,k,R,B,V,Z,ie,ce,ve,Ee,Ne,ze,Ve,et)}emplace(l,h,v,S,k,R,B,V,Z,ie,ce,ve,Ee,Ne,ze,Ve,et,Ct){const rt=24*l,ut=12*l,Rt=48*l;return this.int16[rt+0]=h,this.int16[rt+1]=v,this.uint16[rt+2]=S,this.uint16[rt+3]=k,this.uint32[ut+2]=R,this.uint32[ut+3]=B,this.uint32[ut+4]=V,this.uint16[rt+10]=Z,this.uint16[rt+11]=ie,this.uint16[rt+12]=ce,this.float32[ut+7]=ve,this.float32[ut+8]=Ee,this.uint8[Rt+36]=Ne,this.uint8[Rt+37]=ze,this.uint8[Rt+38]=Ve,this.uint32[ut+10]=et,this.int16[rt+22]=Ct,l}}Tf.prototype.bytesPerElement=48,Pt("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",Tf);class Wh extends ia{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(l,h,v,S,k,R,B,V,Z,ie,ce,ve,Ee,Ne,ze,Ve,et,Ct,rt,ut,Rt,Bt,dr,Or,Pr,Vr,pn,Wr){const Rr=this.length;return this.resize(Rr+1),this.emplace(Rr,l,h,v,S,k,R,B,V,Z,ie,ce,ve,Ee,Ne,ze,Ve,et,Ct,rt,ut,Rt,Bt,dr,Or,Pr,Vr,pn,Wr)}emplace(l,h,v,S,k,R,B,V,Z,ie,ce,ve,Ee,Ne,ze,Ve,et,Ct,rt,ut,Rt,Bt,dr,Or,Pr,Vr,pn,Wr,Rr){const Tr=32*l,Cn=16*l;return this.int16[Tr+0]=h,this.int16[Tr+1]=v,this.int16[Tr+2]=S,this.int16[Tr+3]=k,this.int16[Tr+4]=R,this.int16[Tr+5]=B,this.int16[Tr+6]=V,this.int16[Tr+7]=Z,this.uint16[Tr+8]=ie,this.uint16[Tr+9]=ce,this.uint16[Tr+10]=ve,this.uint16[Tr+11]=Ee,this.uint16[Tr+12]=Ne,this.uint16[Tr+13]=ze,this.uint16[Tr+14]=Ve,this.uint16[Tr+15]=et,this.uint16[Tr+16]=Ct,this.uint16[Tr+17]=rt,this.uint16[Tr+18]=ut,this.uint16[Tr+19]=Rt,this.uint16[Tr+20]=Bt,this.uint16[Tr+21]=dr,this.uint16[Tr+22]=Or,this.uint32[Cn+12]=Pr,this.float32[Cn+13]=Vr,this.float32[Cn+14]=pn,this.uint16[Tr+30]=Wr,this.uint16[Tr+31]=Rr,l}}Wh.prototype.bytesPerElement=64,Pt("StructArrayLayout8i15ui1ul2f2ui64",Wh);class Xh extends ia{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(l){const h=this.length;return this.resize(h+1),this.emplace(h,l)}emplace(l,h){return this.float32[1*l+0]=h,l}}Xh.prototype.bytesPerElement=4,Pt("StructArrayLayout1f4",Xh);class Cf extends ia{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(l,h,v){const S=this.length;return this.resize(S+1),this.emplace(S,l,h,v)}emplace(l,h,v,S){const k=3*l;return this.uint16[6*l+0]=h,this.float32[k+1]=v,this.float32[k+2]=S,l}}Cf.prototype.bytesPerElement=12,Pt("StructArrayLayout1ui2f12",Cf);class qp extends ia{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(l,h,v){const S=this.length;return this.resize(S+1),this.emplace(S,l,h,v)}emplace(l,h,v,S){const k=4*l;return this.uint32[2*l+0]=h,this.uint16[k+2]=v,this.uint16[k+3]=S,l}}qp.prototype.bytesPerElement=8,Pt("StructArrayLayout1ul2ui8",qp);class D extends ia{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(l,h){const v=this.length;return this.resize(v+1),this.emplace(v,l,h)}emplace(l,h,v){const S=2*l;return this.uint16[S+0]=h,this.uint16[S+1]=v,l}}D.prototype.bytesPerElement=4,Pt("StructArrayLayout2ui4",D);class u extends ia{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(l){const h=this.length;return this.resize(h+1),this.emplace(h,l)}emplace(l,h){return this.uint16[1*l+0]=h,l}}u.prototype.bytesPerElement=2,Pt("StructArrayLayout1ui2",u);class g extends ia{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(l,h,v,S){const k=this.length;return this.resize(k+1),this.emplace(k,l,h,v,S)}emplace(l,h,v,S,k){const R=4*l;return this.float32[R+0]=h,this.float32[R+1]=v,this.float32[R+2]=S,this.float32[R+3]=k,l}}g.prototype.bytesPerElement=16,Pt("StructArrayLayout4f16",g);class w extends Ea{get anchorPointX(){return this._structArray.int16[this._pos2+0]}get anchorPointY(){return this._structArray.int16[this._pos2+1]}get x1(){return this._structArray.int16[this._pos2+2]}get y1(){return this._structArray.int16[this._pos2+3]}get x2(){return this._structArray.int16[this._pos2+4]}get y2(){return this._structArray.int16[this._pos2+5]}get featureIndex(){return this._structArray.uint32[this._pos4+3]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+8]}get bucketIndex(){return this._structArray.uint16[this._pos2+9]}get anchorPoint(){return new c(this.anchorPointX,this.anchorPointY)}}w.prototype.size=20;class C extends Qg{get(l){return new w(this,l)}}Pt("CollisionBoxArray",C);class L extends Ea{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+2]}get numGlyphs(){return this._structArray.uint16[this._pos2+3]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+2]}get lineStartIndex(){return this._structArray.uint32[this._pos4+3]}get lineLength(){return this._structArray.uint32[this._pos4+4]}get segment(){return this._structArray.uint16[this._pos2+10]}get lowerSize(){return this._structArray.uint16[this._pos2+11]}get upperSize(){return this._structArray.uint16[this._pos2+12]}get lineOffsetX(){return this._structArray.float32[this._pos4+7]}get lineOffsetY(){return this._structArray.float32[this._pos4+8]}get writingMode(){return this._structArray.uint8[this._pos1+36]}get placedOrientation(){return this._structArray.uint8[this._pos1+37]}set placedOrientation(l){this._structArray.uint8[this._pos1+37]=l}get hidden(){return this._structArray.uint8[this._pos1+38]}set hidden(l){this._structArray.uint8[this._pos1+38]=l}get crossTileID(){return this._structArray.uint32[this._pos4+10]}set crossTileID(l){this._structArray.uint32[this._pos4+10]=l}get associatedIconIndex(){return this._structArray.int16[this._pos2+22]}}L.prototype.size=48;class z extends Tf{get(l){return new L(this,l)}}Pt("PlacedSymbolArray",z);class Y extends Ea{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+2]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+3]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+4]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+5]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+6]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+7]}get key(){return this._structArray.uint16[this._pos2+8]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+9]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+10]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+11]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+12]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+13]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+14]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get featureIndex(){return this._structArray.uint16[this._pos2+17]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+18]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+19]}get numIconVertices(){return this._structArray.uint16[this._pos2+20]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+21]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+22]}get crossTileID(){return this._structArray.uint32[this._pos4+12]}set crossTileID(l){this._structArray.uint32[this._pos4+12]=l}get textBoxScale(){return this._structArray.float32[this._pos4+13]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+14]}get textAnchorOffsetStartIndex(){return this._structArray.uint16[this._pos2+30]}get textAnchorOffsetEndIndex(){return this._structArray.uint16[this._pos2+31]}}Y.prototype.size=64;class re extends Wh{get(l){return new Y(this,l)}}Pt("SymbolInstanceArray",re);class le extends Xh{getoffsetX(l){return this.float32[1*l+0]}}Pt("GlyphOffsetArray",le);class he extends is{getx(l){return this.int16[3*l+0]}gety(l){return this.int16[3*l+1]}gettileUnitDistanceFromAnchor(l){return this.int16[3*l+2]}}Pt("SymbolLineVertexArray",he);class Pe extends Ea{get textAnchor(){return this._structArray.uint16[this._pos2+0]}get textOffset0(){return this._structArray.float32[this._pos4+1]}get textOffset1(){return this._structArray.float32[this._pos4+2]}}Pe.prototype.size=12;class Ae extends Cf{get(l){return new Pe(this,l)}}Pt("TextAnchorOffsetArray",Ae);class Ue extends Ea{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}}Ue.prototype.size=8;class Ze extends qp{get(l){return new Ue(this,l)}}Pt("FeatureIndexArray",Ze);class ht extends yu{}class pt extends yu{}class dt extends yu{}class xt extends Vh{}class Nt extends $h{}class wt extends Gc{}class Lt extends Wc{}class jt extends $p{}class Dt extends sh{}class Zt extends sc{}class Sr extends Vd{}class pr extends qh{}class _r extends Hh{}class xr extends Gh{}class an extends D{}const ln=pa([{name:"a_pos",components:2,type:"Int16"}],4),{members:Hr}=ln;class gn{constructor(l=[]){this._forceNewSegmentOnNextPrepare=!1,this.segments=l}prepareSegment(l,h,v,S){const k=this.segments[this.segments.length-1];return l>gn.MAX_VERTEX_ARRAY_LENGTH&&at(`Max vertices per segment is ${gn.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${l}. Consider using the \`fillLargeMeshArrays\` function if you require meshes with more than ${gn.MAX_VERTEX_ARRAY_LENGTH} vertices.`),this._forceNewSegmentOnNextPrepare||!k||k.vertexLength+l>gn.MAX_VERTEX_ARRAY_LENGTH||k.sortKey!==S?this.createNewSegment(h,v,S):k}createNewSegment(l,h,v){const S={vertexOffset:l.length,primitiveOffset:h.length,vertexLength:0,primitiveLength:0,vaos:{}};return v!==void 0&&(S.sortKey=v),this._forceNewSegmentOnNextPrepare=!1,this.segments.push(S),S}getOrCreateLatestSegment(l,h,v){return this.prepareSegment(0,l,h,v)}forceNewSegmentOnNextPrepare(){this._forceNewSegmentOnNextPrepare=!0}get(){return this.segments}destroy(){for(const l of this.segments)for(const h in l.vaos)l.vaos[h].destroy()}static simpleSegment(l,h,v,S){return new gn([{vertexOffset:l,primitiveOffset:h,vertexLength:v,primitiveLength:S,vaos:{},sortKey:0}])}}function Ti(p,l){return 256*(p=Fe(Math.floor(p),0,255))+Fe(Math.floor(l),0,255)}gn.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,Pt("SegmentVector",gn);const Ra=pa([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]),yo=pa([{name:"a_dasharray_from",components:4,type:"Uint16"},{name:"a_dasharray_to",components:4,type:"Uint16"}]);var to,Ao,ro,Xo={exports:{}},Io={exports:{}},pl={exports:{}},vs=(function(){if(ro)return Xo.exports;ro=1;var p=(to||(to=1,Io.exports=function(h,v){var S,k,R,B,V,Z,ie,ce;for(k=h.length-(S=3&h.length),R=v,V=3432918353,Z=461845907,ce=0;ce<k;)ie=255&h.charCodeAt(ce)|(255&h.charCodeAt(++ce))<<8|(255&h.charCodeAt(++ce))<<16|(255&h.charCodeAt(++ce))<<24,++ce,R=27492+(65535&(B=5*(65535&(R=(R^=ie=(65535&(ie=(ie=(65535&ie)*V+(((ie>>>16)*V&65535)<<16)&4294967295)<<15|ie>>>17))*Z+(((ie>>>16)*Z&65535)<<16)&4294967295)<<13|R>>>19))+((5*(R>>>16)&65535)<<16)&4294967295))+((58964+(B>>>16)&65535)<<16);switch(ie=0,S){case 3:ie^=(255&h.charCodeAt(ce+2))<<16;case 2:ie^=(255&h.charCodeAt(ce+1))<<8;case 1:R^=ie=(65535&(ie=(ie=(65535&(ie^=255&h.charCodeAt(ce)))*V+(((ie>>>16)*V&65535)<<16)&4294967295)<<15|ie>>>17))*Z+(((ie>>>16)*Z&65535)<<16)&4294967295}return R^=h.length,R=2246822507*(65535&(R^=R>>>16))+((2246822507*(R>>>16)&65535)<<16)&4294967295,R=3266489909*(65535&(R^=R>>>13))+((3266489909*(R>>>16)&65535)<<16)&4294967295,(R^=R>>>16)>>>0}),Io.exports),l=(Ao||(Ao=1,pl.exports=function(h,v){for(var S,k=h.length,R=v^k,B=0;k>=4;)S=1540483477*(65535&(S=255&h.charCodeAt(B)|(255&h.charCodeAt(++B))<<8|(255&h.charCodeAt(++B))<<16|(255&h.charCodeAt(++B))<<24))+((1540483477*(S>>>16)&65535)<<16),R=1540483477*(65535&R)+((1540483477*(R>>>16)&65535)<<16)^(S=1540483477*(65535&(S^=S>>>24))+((1540483477*(S>>>16)&65535)<<16)),k-=4,++B;switch(k){case 3:R^=(255&h.charCodeAt(B+2))<<16;case 2:R^=(255&h.charCodeAt(B+1))<<8;case 1:R=1540483477*(65535&(R^=255&h.charCodeAt(B)))+((1540483477*(R>>>16)&65535)<<16)}return R=1540483477*(65535&(R^=R>>>13))+((1540483477*(R>>>16)&65535)<<16),(R^=R>>>15)>>>0}),pl.exports);return Xo.exports=p,Xo.exports.murmur3=p,Xo.exports.murmur2=l,Xo.exports})(),as=f(vs);class Ml{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(l,h,v,S){this.ids.push(Yh(l)),this.positions.push(h,v,S)}getPositions(l){if(!this.indexed)throw new Error("Trying to get index, but feature positions are not indexed");const h=Yh(l);let v=0,S=this.ids.length-1;for(;v<S;){const R=v+S>>1;this.ids[R]>=h?S=R:v=R+1}const k=[];for(;this.ids[v]===h;)k.push({index:this.positions[3*v],start:this.positions[3*v+1],end:this.positions[3*v+2]}),v++;return k}static serialize(l,h){const v=new Float64Array(l.ids),S=new Uint32Array(l.positions);return lh(v,S,0,v.length-1),h&&h.push(v.buffer,S.buffer),{ids:v,positions:S}}static deserialize(l){const h=new Ml;return h.ids=l.ids,h.positions=l.positions,h.indexed=!0,h}}function Yh(p){const l=+p;return!isNaN(l)&&l<=Number.MAX_SAFE_INTEGER?l:as(String(p))}function lh(p,l,h,v){for(;h<v;){const S=p[h+v>>1];let k=h-1,R=v+1;for(;;){do k++;while(p[k]<S);do R--;while(p[R]>S);if(k>=R)break;Af(p,k,R),Af(l,3*k,3*R),Af(l,3*k+1,3*R+1),Af(l,3*k+2,3*R+2)}R-h<v-R?(lh(p,l,h,R),h=R+1):(lh(p,l,R+1,v),v=R)}}function Af(p,l,h){const v=p[l];p[l]=p[h],p[h]=v}Pt("FeaturePositionMap",Ml);class zu{constructor(l,h){this.gl=l.gl,this.location=h}}class $d extends zu{constructor(l,h){super(l,h),this.current=0}set(l){this.current!==l&&(this.current=l,this.gl.uniform1f(this.location,l))}}class em extends zu{constructor(l,h){super(l,h),this.current=[0,0,0,0]}set(l){l[0]===this.current[0]&&l[1]===this.current[1]&&l[2]===this.current[2]&&l[3]===this.current[3]||(this.current=l,this.gl.uniform4f(this.location,l[0],l[1],l[2],l[3]))}}class qd extends zu{constructor(l,h){super(l,h),this.current=kr.transparent}set(l){l.r===this.current.r&&l.g===this.current.g&&l.b===this.current.b&&l.a===this.current.a||(this.current=l,this.gl.uniform4f(this.location,l.r,l.g,l.b,l.a))}}const Ec=new Float32Array(16);function If(p){return[Ti(255*p.r,255*p.g),Ti(255*p.b,255*p.a)]}class Xc{constructor(l,h,v){this.value=l,this.uniformNames=h.map((S=>`u_${S}`)),this.type=v}setUniform(l,h,v){l.set(v.constantOr(this.value))}getBinding(l,h,v){return this.type==="color"?new qd(l,h):new $d(l,h)}}class Yc{constructor(l,h){this.uniformNames=h.map((v=>`u_${v}`)),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(l,h){this.pixelRatioFrom=h.pixelRatio,this.pixelRatioTo=l.pixelRatio,this.patternFrom=h.tlbr,this.patternTo=l.tlbr}setConstantDashPositions(l,h){this.dashTo=[0,l.y,l.height,l.width],this.dashFrom=[0,h.y,h.height,h.width]}setUniform(l,h,v,S){let k=null;S==="u_pattern_to"?k=this.patternTo:S==="u_pattern_from"?k=this.patternFrom:S==="u_dasharray_to"?k=this.dashTo:S==="u_dasharray_from"?k=this.dashFrom:S==="u_pixel_ratio_to"?k=this.pixelRatioTo:S==="u_pixel_ratio_from"&&(k=this.pixelRatioFrom),k!==null&&l.set(k)}getBinding(l,h,v){return v.substr(0,9)==="u_pattern"||v.substr(0,12)==="u_dasharray_"?new em(l,h):new $d(l,h)}}class lo{constructor(l,h,v,S){this.expression=l,this.type=v,this.maxValue=0,this.paintVertexAttributes=h.map((k=>({name:`a_${k}`,type:"Float32",components:v==="color"?2:1,offset:0}))),this.paintVertexArray=new S}populatePaintArray(l,h,v){const S=this.paintVertexArray.length,k=this.expression.evaluate(new ki(0,v),h,{},v.canonical,[],v.formattedSection);this.paintVertexArray.resize(l),this._setPaintValue(S,l,k)}updatePaintArray(l,h,v,S,k){const R=this.expression.evaluate(new ki(0,k),v,S);this._setPaintValue(l,h,R)}_setPaintValue(l,h,v){if(this.type==="color"){const S=If(v);for(let k=l;k<h;k++)this.paintVertexArray.emplace(k,S[0],S[1])}else{for(let S=l;S<h;S++)this.paintVertexArray.emplace(S,v);this.maxValue=Math.max(this.maxValue,Math.abs(v))}}upload(l){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=l.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class no{constructor(l,h,v,S,k,R){this.expression=l,this.uniformNames=h.map((B=>`u_${B}_t`)),this.type=v,this.useIntegerZoom=S,this.zoom=k,this.maxValue=0,this.paintVertexAttributes=h.map((B=>({name:`a_${B}`,type:"Float32",components:v==="color"?4:2,offset:0}))),this.paintVertexArray=new R}populatePaintArray(l,h,v){const S=this.expression.evaluate(new ki(this.zoom,v),h,{},v.canonical,[],v.formattedSection),k=this.expression.evaluate(new ki(this.zoom+1,v),h,{},v.canonical,[],v.formattedSection),R=this.paintVertexArray.length;this.paintVertexArray.resize(l),this._setPaintValue(R,l,S,k)}updatePaintArray(l,h,v,S,k){const R=this.expression.evaluate(new ki(this.zoom,k),v,S),B=this.expression.evaluate(new ki(this.zoom+1,k),v,S);this._setPaintValue(l,h,R,B)}_setPaintValue(l,h,v,S){if(this.type==="color"){const k=If(v),R=If(S);for(let B=l;B<h;B++)this.paintVertexArray.emplace(B,k[0],k[1],R[0],R[1])}else{for(let k=l;k<h;k++)this.paintVertexArray.emplace(k,v,S);this.maxValue=Math.max(this.maxValue,Math.abs(v),Math.abs(S))}}upload(l){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=l.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(l,h){const v=this.useIntegerZoom?Math.floor(h.zoom):h.zoom,S=Fe(this.expression.interpolationFactor(v,this.zoom,this.zoom+1),0,1);l.set(S)}getBinding(l,h,v){return new $d(l,h)}}class Js{constructor(l,h,v,S,k,R){this.expression=l,this.type=h,this.useIntegerZoom=v,this.zoom=S,this.layerId=R,this.zoomInPaintVertexArray=new k,this.zoomOutPaintVertexArray=new k}populatePaintArray(l,h,v){const S=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(l),this.zoomOutPaintVertexArray.resize(l),this._setPaintValues(S,l,this.getPositionIds(h),v)}updatePaintArray(l,h,v,S,k){this._setPaintValues(l,h,this.getPositionIds(v),k)}_setPaintValues(l,h,v,S){const k=this.getPositions(S);if(!k||!v)return;const R=k[v.min],B=k[v.mid],V=k[v.max];if(R&&B&&V)for(let Z=l;Z<h;Z++)this.emplace(this.zoomInPaintVertexArray,Z,B,R),this.emplace(this.zoomOutPaintVertexArray,Z,B,V)}upload(l){if(this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer){const h=this.getVertexAttributes();this.zoomInPaintVertexBuffer=l.createVertexBuffer(this.zoomInPaintVertexArray,h,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=l.createVertexBuffer(this.zoomOutPaintVertexArray,h,this.expression.isStateDependent)}}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class Qs extends Js{getPositions(l){return l.imagePositions}getPositionIds(l){return l.patterns&&l.patterns[this.layerId]}getVertexAttributes(){return Ra.members}emplace(l,h,v,S){l.emplace(h,v.tlbr[0],v.tlbr[1],v.tlbr[2],v.tlbr[3],S.tlbr[0],S.tlbr[1],S.tlbr[2],S.tlbr[3],v.pixelRatio,S.pixelRatio)}}class u2 extends Js{getPositions(l){return l.dashPositions}getPositionIds(l){return l.dashes&&l.dashes[this.layerId]}getVertexAttributes(){return yo.members}emplace(l,h,v,S){l.emplace(h,0,v.y,v.height,v.width,0,S.y,S.height,S.width)}}class c2{constructor(l,h,v){this.binders={},this._buffers=[];const S=[];for(const k in l.paint._values){if(!v(k))continue;const R=l.paint.get(k);if(!(R instanceof qi&&Gl(R.property.specification)))continue;const B=rC(k,l.type),V=R.value,Z=R.property.specification.type,ie=R.property.useIntegerZoom,ce=R.property.specification["property-type"],ve=ce==="cross-faded"||ce==="cross-faded-data-driven";if(V.kind==="constant")this.binders[k]=ve?new Yc(V.value,B):new Xc(V.value,B,Z),S.push(`/u_${k}`);else if(V.kind==="source"||ve){const Ee=f2(k,Z,"source");this.binders[k]=ve?k==="line-dasharray"?new u2(V,Z,ie,h,Ee,l.id):new Qs(V,Z,ie,h,Ee,l.id):new lo(V,B,Z,Ee),S.push(`/a_${k}`)}else{const Ee=f2(k,Z,"composite");this.binders[k]=new no(V,B,Z,ie,h,Ee),S.push(`/z_${k}`)}}this.cacheKey=S.sort().join("")}getMaxValue(l){const h=this.binders[l];return h instanceof lo||h instanceof no?h.maxValue:0}populatePaintArrays(l,h,v){for(const S in this.binders){const k=this.binders[S];(k instanceof lo||k instanceof no||k instanceof Js)&&k.populatePaintArray(l,h,v)}}setConstantPatternPositions(l,h){for(const v in this.binders){const S=this.binders[v];S instanceof Yc&&S.setConstantPatternPositions(l,h)}}setConstantDashPositions(l,h){for(const v in this.binders){const S=this.binders[v];S instanceof Yc&&S.setConstantDashPositions(l,h)}}updatePaintArrays(l,h,v,S,k){let R=!1;for(const B in l){const V=h.getPositions(B);for(const Z of V){const ie=v.feature(Z.index);for(const ce in this.binders){const ve=this.binders[ce];if((ve instanceof lo||ve instanceof no||ve instanceof Js)&&ve.expression.isStateDependent===!0){const Ee=S.paint.get(ce);ve.expression=Ee.value,ve.updatePaintArray(Z.start,Z.end,ie,l[B],k),R=!0}}}}return R}defines(){const l=[];for(const h in this.binders){const v=this.binders[h];(v instanceof Xc||v instanceof Yc)&&l.push(...v.uniformNames.map((S=>`#define HAS_UNIFORM_${S}`)))}return l}getBinderAttributes(){const l=[];for(const h in this.binders){const v=this.binders[h];if(v instanceof lo||v instanceof no)for(let S=0;S<v.paintVertexAttributes.length;S++)l.push(v.paintVertexAttributes[S].name);else if(v instanceof Js){const S=v.getVertexAttributes();for(const k of S)l.push(k.name)}}return l}getBinderUniforms(){const l=[];for(const h in this.binders){const v=this.binders[h];if(v instanceof Xc||v instanceof Yc||v instanceof no)for(const S of v.uniformNames)l.push(S)}return l}getPaintVertexBuffers(){return this._buffers}getUniforms(l,h){const v=[];for(const S in this.binders){const k=this.binders[S];if(k instanceof Xc||k instanceof Yc||k instanceof no){for(const R of k.uniformNames)if(h[R]){const B=k.getBinding(l,h[R],R);v.push({name:R,property:S,binding:B})}}}return v}setUniforms(l,h,v,S){for(const{name:k,property:R,binding:B}of h)this.binders[R].setUniform(B,S,v.get(R),k)}updatePaintBuffers(l){this._buffers=[];for(const h in this.binders){const v=this.binders[h];if(l&&v instanceof Js){const S=l.fromScale===2?v.zoomInPaintVertexBuffer:v.zoomOutPaintVertexBuffer;S&&this._buffers.push(S)}else(v instanceof lo||v instanceof no)&&v.paintVertexBuffer&&this._buffers.push(v.paintVertexBuffer)}}upload(l){for(const h in this.binders){const v=this.binders[h];(v instanceof lo||v instanceof no||v instanceof Js)&&v.upload(l)}this.updatePaintBuffers()}destroy(){for(const l in this.binders){const h=this.binders[l];(h instanceof lo||h instanceof no||h instanceof Js)&&h.destroy()}}}class Hd{constructor(l,h,v=()=>!0){this.programConfigurations={};for(const S of l)this.programConfigurations[S.id]=new c2(S,h,v);this.needsUpload=!1,this._featureMap=new Ml,this._bufferOffset=0}populatePaintArrays(l,h,v,S){for(const k in this.programConfigurations)this.programConfigurations[k].populatePaintArrays(l,h,S);h.id!==void 0&&this._featureMap.add(h.id,v,this._bufferOffset,l),this._bufferOffset=l,this.needsUpload=!0}updatePaintArrays(l,h,v,S){for(const k of v)this.needsUpload=this.programConfigurations[k.id].updatePaintArrays(l,this._featureMap,h,k,S)||this.needsUpload}get(l){return this.programConfigurations[l]}upload(l){if(this.needsUpload){for(const h in this.programConfigurations)this.programConfigurations[h].upload(l);this.needsUpload=!1}}destroy(){for(const l in this.programConfigurations)this.programConfigurations[l].destroy()}}function rC(p,l){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-dasharray":["dasharray_to","dasharray_from"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[p]||[p.replace(`${l}-`,"").replace(/-/g,"_")]}function f2(p,l,h){const v={color:{source:Gc,composite:g},number:{source:Xh,composite:Gc}},S=(function(k){return{"line-pattern":{source:Lt,composite:Lt},"fill-pattern":{source:Lt,composite:Lt},"fill-extrusion-pattern":{source:Lt,composite:Lt},"line-dasharray":{source:jt,composite:jt}}[k]})(p);return S&&S[h]||v[l][h]}Pt("ConstantBinder",Xc),Pt("CrossFadedConstantBinder",Yc),Pt("SourceExpressionBinder",lo),Pt("CrossFadedPatternBinder",Qs),Pt("CrossFadedDasharrayBinder",u2),Pt("CompositeExpressionBinder",no),Pt("ProgramConfiguration",c2,{omit:["_buffers"]}),Pt("ProgramConfigurationSet",Hd);const R_=Math.pow(2,14)-1,Zh=-R_-1;function Kh(p){const l=Te/p.extent,h=p.loadGeometry();for(let v=0;v<h.length;v++){const S=h[v];for(let k=0;k<S.length;k++){const R=S[k],B=Math.round(R.x*l),V=Math.round(R.y*l);R.x=Fe(B,Zh,R_),R.y=Fe(V,Zh,R_),(B<R.x||B>R.x+1||V<R.y||V>R.y+1)&&at("Geometry exceeds allowed extent, reduce your vector tile buffer size")}}return h}function Jh(p,l){return{type:p.type,id:p.id,properties:p.properties,geometry:l?Kh(p):[]}}const M_=-32768;function D_(p,l,h,v,S){p.emplaceBack(M_+8*l+v,M_+8*h+S)}class $y{constructor(l){this.zoom=l.zoom,this.overscaling=l.overscaling,this.layers=l.layers,this.layerIds=this.layers.map((h=>h.id)),this.index=l.index,this.hasDependencies=!1,this.layoutVertexArray=new pt,this.indexArray=new xr,this.segments=new gn,this.programConfigurations=new Hd(l.layers,l.zoom),this.stateDependentLayerIds=this.layers.filter((h=>h.isStateDependent())).map((h=>h.id))}populate(l,h,v){const S=this.layers[0],k=[];let R=null,B=!1,V=S.type==="heatmap";if(S.type==="circle"){const ie=S;R=ie.layout.get("circle-sort-key"),B=!R.isConstant(),V=V||ie.paint.get("circle-pitch-alignment")==="map"}const Z=V?h.subdivisionGranularity.circle:1;for(const{feature:ie,id:ce,index:ve,sourceLayerIndex:Ee}of l){const Ne=this.layers[0]._featureFilter.needGeometry,ze=Jh(ie,Ne);if(!this.layers[0]._featureFilter.filter(new ki(this.zoom),ze,v))continue;const Ve=B?R.evaluate(ze,{},v):void 0,et={id:ce,properties:ie.properties,type:ie.type,sourceLayerIndex:Ee,index:ve,geometry:Ne?ze.geometry:Kh(ie),patterns:{},sortKey:Ve};k.push(et)}B&&k.sort(((ie,ce)=>ie.sortKey-ce.sortKey));for(const ie of k){const{geometry:ce,index:ve,sourceLayerIndex:Ee}=ie,Ne=l[ve].feature;this.addFeature(ie,ce,ve,v,Z),h.featureIndex.insert(Ne,ce,ve,Ee,this.index)}}update(l,h,v){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(l,h,this.stateDependentLayers,{imagePositions:v})}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(l){this.uploaded||(this.layoutVertexBuffer=l.createVertexBuffer(this.layoutVertexArray,Hr),this.indexBuffer=l.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(l),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(l,h,v,S,k=1){let R;switch(k){case 1:R=[0,7];break;case 3:R=[0,2,5,7];break;case 5:R=[0,1,3,4,6,7];break;case 7:R=[0,1,2,3,4,5,6,7];break;default:throw new Error(`Invalid circle bucket granularity: ${k}; valid values are 1, 3, 5, 7.`)}const B=R.length;for(const V of h)for(const Z of V){const ie=Z.x,ce=Z.y;if(ie<0||ie>=Te||ce<0||ce>=Te)continue;const ve=this.segments.prepareSegment(B*B,this.layoutVertexArray,this.indexArray,l.sortKey),Ee=ve.vertexLength;for(let Ne=0;Ne<B;Ne++)for(let ze=0;ze<B;ze++)D_(this.layoutVertexArray,ie,ce,R[ze],R[Ne]);for(let Ne=0;Ne<B-1;Ne++)for(let ze=0;ze<B-1;ze++){const Ve=Ee+Ne*B+ze,et=Ee+(Ne+1)*B+ze;this.indexArray.emplaceBack(Ve,et+1,Ve+1),this.indexArray.emplaceBack(Ve,et,et+1)}ve.vertexLength+=B*B,ve.primitiveLength+=(B-1)*(B-1)*2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,l,v,{imagePositions:{},canonical:S})}}function qy(p,l){for(let h=0;h<p.length;h++)if(Hy(l,p[h]))return!0;for(let h=0;h<l.length;h++)if(Hy(p,l[h]))return!0;return!!nC(p,l)}function h2(p,l,h){return!!Hy(p,l)||!!iC(l,p,h)}function R6(p,l){if(p.length===1)return D6(l,p[0]);for(let h=0;h<l.length;h++){const v=l[h];for(let S=0;S<v.length;S++)if(Hy(p,v[S]))return!0}for(let h=0;h<p.length;h++)if(D6(l,p[h]))return!0;for(let h=0;h<l.length;h++)if(nC(p,l[h]))return!0;return!1}function Wne(p,l,h){if(p.length>1){if(nC(p,l))return!0;for(let v=0;v<l.length;v++)if(iC(l[v],p,h))return!0}for(let v=0;v<p.length;v++)if(iC(p[v],l,h))return!0;return!1}function nC(p,l){if(p.length===0||l.length===0)return!1;for(let h=0;h<p.length-1;h++){const v=p[h],S=p[h+1];for(let k=0;k<l.length-1;k++)if(Xne(v,S,l[k],l[k+1]))return!0}return!1}function Xne(p,l,h,v){return $e(p,h,v)!==$e(l,h,v)&&$e(p,l,h)!==$e(p,l,v)}function iC(p,l,h){const v=h*h;if(l.length===1)return p.distSqr(l[0])<v;for(let S=1;S<l.length;S++)if(M6(p,l[S-1],l[S])<v)return!0;return!1}function M6(p,l,h){const v=l.distSqr(h);if(v===0)return p.distSqr(l);const S=((p.x-l.x)*(h.x-l.x)+(p.y-l.y)*(h.y-l.y))/v;return p.distSqr(S<0?l:S>1?h:h.sub(l)._mult(S)._add(l))}function D6(p,l){let h,v,S,k=!1;for(let R=0;R<p.length;R++){h=p[R];for(let B=0,V=h.length-1;B<h.length;V=B++)v=h[B],S=h[V],v.y>l.y!=S.y>l.y&&l.x<(S.x-v.x)*(l.y-v.y)/(S.y-v.y)+v.x&&(k=!k)}return k}function Hy(p,l){let h=!1;for(let v=0,S=p.length-1;v<p.length;S=v++){const k=p[v],R=p[S];k.y>l.y!=R.y>l.y&&l.x<(R.x-k.x)*(l.y-k.y)/(R.y-k.y)+k.x&&(h=!h)}return h}function Yne(p,l,h){const v=h[0],S=h[2];if(p.x<v.x&&l.x<v.x||p.x>S.x&&l.x>S.x||p.y<v.y&&l.y<v.y||p.y>S.y&&l.y>S.y)return!1;const k=$e(p,l,h[0]);return k!==$e(p,l,h[1])||k!==$e(p,l,h[2])||k!==$e(p,l,h[3])}function Gy(p,l,h){const v=l.paint.get(p).value;return v.kind==="constant"?v.value:h.programConfigurations.get(l.id).getMaxValue(p)}function d2(p){return Math.sqrt(p[0]*p[0]+p[1]*p[1])}function p2(p,l,h,v,S){if(!l[0]&&!l[1])return p;const k=c.convert(l)._mult(S);h==="viewport"&&k._rotate(-v);const R=[];for(let B=0;B<p.length;B++)R.push(p[B].sub(k));return R}function Zne(p){const l=[];for(let h=0;h<p.length;h++){const v=p[h],S=l.at(-1);(h===0||S&&!v.equals(S))&&l.push(v)}return l}function Kne({queryGeometry:p,size:l},h){return h2(p,h,l)}function Jne({queryGeometry:p,size:l,transform:h,unwrappedTileID:v,getElevation:S},k){return h2(p,k,l*(h.projectTileCoordinates(k.x,k.y,v,S).signedDistanceFromCamera/h.cameraToCenterDistance))}function Qne({queryGeometry:p,size:l,transform:h,unwrappedTileID:v,getElevation:S},k){const R=h.projectTileCoordinates(k.x,k.y,v,S).signedDistanceFromCamera,B=l*(h.cameraToCenterDistance/R);return h2(p,aC(k,h,v,S),B)}function eie({queryGeometry:p,size:l,transform:h,unwrappedTileID:v,getElevation:S},k){return h2(p,aC(k,h,v,S),l)}function O6({queryGeometry:p,size:l,transform:h,unwrappedTileID:v,getElevation:S,pitchAlignment:k="map",pitchScale:R="map"},B){const V=k==="map"?R==="map"?Kne:Jne:R==="map"?Qne:eie,Z={queryGeometry:p,size:l,transform:h,unwrappedTileID:v,getElevation:S};for(const ie of B)for(const ce of ie)if(V(Z,ce))return!0;return!1}function aC(p,l,h,v){const S=l.projectTileCoordinates(p.x,p.y,h,v).point;return new c((.5*S.x+.5)*l.width,(.5*-S.y+.5)*l.height)}let N6,L6;Pt("CircleBucket",$y,{omit:["layers"]});var tie={get paint(){return L6=L6||new $a({"circle-radius":new Sn(Mt.paint_circle["circle-radius"]),"circle-color":new Sn(Mt.paint_circle["circle-color"]),"circle-blur":new Sn(Mt.paint_circle["circle-blur"]),"circle-opacity":new Sn(Mt.paint_circle["circle-opacity"]),"circle-translate":new Tn(Mt.paint_circle["circle-translate"]),"circle-translate-anchor":new Tn(Mt.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new Tn(Mt.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new Tn(Mt.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new Sn(Mt.paint_circle["circle-stroke-width"]),"circle-stroke-color":new Sn(Mt.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new Sn(Mt.paint_circle["circle-stroke-opacity"])})},get layout(){return N6=N6||new $a({"circle-sort-key":new Sn(Mt.layout_circle["circle-sort-key"])})}};class rie extends eo{constructor(l,h){super(l,tie,h)}createBucket(l){return new $y(l)}queryRadius(l){const h=l;return Gy("circle-radius",this,h)+Gy("circle-stroke-width",this,h)+d2(this.paint.get("circle-translate"))}queryIntersectsFeature({queryGeometry:l,feature:h,featureState:v,geometry:S,transform:k,pixelsToTileUnits:R,unwrappedTileID:B,getElevation:V}){const Z=p2(l,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),-k.bearingInRadians,R),ie=this.paint.get("circle-radius").evaluate(h,v)+this.paint.get("circle-stroke-width").evaluate(h,v),ce=this.paint.get("circle-pitch-scale"),ve=this.paint.get("circle-pitch-alignment");let Ee,Ne;return ve==="map"?(Ee=Z,Ne=ie*R):(Ee=(function(ze,Ve,et,Ct){return ze.map((rt=>aC(rt,Ve,et,Ct)))})(Z,k,B,V),Ne=ie),O6({queryGeometry:Ee,size:Ne,transform:k,unwrappedTileID:B,getElevation:V,pitchAlignment:ve,pitchScale:ce},S)}}class F6 extends $y{}let B6;Pt("HeatmapBucket",F6,{omit:["layers"]});var nie={get paint(){return B6=B6||new $a({"heatmap-radius":new Sn(Mt.paint_heatmap["heatmap-radius"]),"heatmap-weight":new Sn(Mt.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new Tn(Mt.paint_heatmap["heatmap-intensity"]),"heatmap-color":new Lo(Mt.paint_heatmap["heatmap-color"]),"heatmap-opacity":new Tn(Mt.paint_heatmap["heatmap-opacity"])})}};function oC(p,{width:l,height:h},v,S){if(S){if(S instanceof Uint8ClampedArray)S=new Uint8Array(S.buffer);else if(S.length!==l*h*v)throw new RangeError(`mismatched image size. expected: ${S.length} but got: ${l*h*v}`)}else S=new Uint8Array(l*h*v);return p.width=l,p.height=h,p.data=S,p}function z6(p,{width:l,height:h},v){if(l===p.width&&h===p.height)return;const S=oC({},{width:l,height:h},v);sC(p,S,{x:0,y:0},{x:0,y:0},{width:Math.min(p.width,l),height:Math.min(p.height,h)},v),p.width=l,p.height=h,p.data=S.data}function sC(p,l,h,v,S,k){if(S.width===0||S.height===0)return l;if(S.width>p.width||S.height>p.height||h.x>p.width-S.width||h.y>p.height-S.height)throw new RangeError("out of range source coordinates for image copy");if(S.width>l.width||S.height>l.height||v.x>l.width-S.width||v.y>l.height-S.height)throw new RangeError("out of range destination coordinates for image copy");const R=p.data,B=l.data;if(R===B)throw new Error("srcData equals dstData, so image is already copied");for(let V=0;V<S.height;V++){const Z=((h.y+V)*p.width+h.x)*k,ie=((v.y+V)*l.width+v.x)*k;for(let ce=0;ce<S.width*k;ce++)B[ie+ce]=R[Z+ce]}return l}class O_{constructor(l,h){oC(this,l,1,h)}resize(l){z6(this,l,1)}clone(){return new O_({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(l,h,v,S,k){sC(l,h,v,S,k,1)}}class lc{constructor(l,h){oC(this,l,4,h)}resize(l){z6(this,l,4)}replace(l,h){h?this.data.set(l):this.data=l instanceof Uint8ClampedArray?new Uint8Array(l.buffer):l}clone(){return new lc({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(l,h,v,S,k){sC(l,h,v,S,k,4)}setPixel(l,h,v){const S=4*(l*this.width+h);this.data[S+0]=Math.round(255*v.r/v.a),this.data[S+1]=Math.round(255*v.g/v.a),this.data[S+2]=Math.round(255*v.b/v.a),this.data[S+3]=Math.round(255*v.a)}}function j6(p){const l={},h=p.resolution||256,v=p.clips?p.clips.length:1,S=p.image||new lc({width:h,height:v});if(Math.log(h)/Math.LN2%1!=0)throw new Error(`width is not a power of 2 - ${h}`);const k=(R,B,V)=>{l[p.evaluationKey]=V;const Z=p.expression.evaluate(l);S.setPixel(R/4/h,B/4,Z)};if(p.clips)for(let R=0,B=0;R<v;++R,B+=4*h)for(let V=0,Z=0;V<h;V++,Z+=4){const ie=V/(h-1),{start:ce,end:ve}=p.clips[R];k(B,Z,ce*(1-ie)+ve*ie)}else for(let R=0,B=0;R<h;R++,B+=4)k(0,B,R/(h-1));return S}Pt("AlphaImage",O_),Pt("RGBAImage",lc);const lC="big-fb";class iie extends eo{createBucket(l){return new F6(l)}constructor(l,h){super(l,nie,h),this.heatmapFbos=new Map,this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(l){l==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=j6({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbos.has(lC)&&this.heatmapFbos.delete(lC)}queryRadius(l){return Gy("heatmap-radius",this,l)}queryIntersectsFeature({queryGeometry:l,feature:h,featureState:v,geometry:S,transform:k,pixelsToTileUnits:R,unwrappedTileID:B,getElevation:V}){return O6({queryGeometry:l,size:this.paint.get("heatmap-radius").evaluate(h,v)*R,transform:k,unwrappedTileID:B,getElevation:V},S)}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&!this.isHidden()}}let U6;var aie={get paint(){return U6=U6||new $a({"hillshade-illumination-direction":new Tn(Mt.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-altitude":new Tn(Mt.paint_hillshade["hillshade-illumination-altitude"]),"hillshade-illumination-anchor":new Tn(Mt.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new Tn(Mt.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new Tn(Mt.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new Tn(Mt.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new Tn(Mt.paint_hillshade["hillshade-accent-color"]),"hillshade-method":new Tn(Mt.paint_hillshade["hillshade-method"])})}};class oie extends eo{constructor(l,h){super(l,aie,h),this.recalculate({zoom:0,zoomHistory:{}},void 0)}getIlluminationProperties(){let l=this.paint.get("hillshade-illumination-direction").values,h=this.paint.get("hillshade-illumination-altitude").values,v=this.paint.get("hillshade-highlight-color").values,S=this.paint.get("hillshade-shadow-color").values;const k=Math.max(l.length,h.length,v.length,S.length);l=l.concat(Array(k-l.length).fill(l.at(-1))),h=h.concat(Array(k-h.length).fill(h.at(-1))),v=v.concat(Array(k-v.length).fill(v.at(-1))),S=S.concat(Array(k-S.length).fill(S.at(-1)));const R=h.map(Er);return{directionRadians:l.map(Er),altitudeRadians:R,shadowColor:S,highlightColor:v}}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&!this.isHidden()}}let V6;var sie={get paint(){return V6=V6||new $a({"color-relief-opacity":new Tn(Mt["paint_color-relief"]["color-relief-opacity"]),"color-relief-color":new Lo(Mt["paint_color-relief"]["color-relief-color"])})}};class uC{constructor(l,h,v,S){this.context=l,this.format=v,this.texture=l.gl.createTexture(),this.update(h,S)}update(l,h,v){const{width:S,height:k}=l,R=!(this.size&&this.size[0]===S&&this.size[1]===k||v),{context:B}=this,{gl:V}=B;if(this.useMipmap=!!(h&&h.useMipmap),V.bindTexture(V.TEXTURE_2D,this.texture),B.pixelStoreUnpackFlipY.set(!1),B.pixelStoreUnpack.set(1),B.pixelStoreUnpackPremultiplyAlpha.set(this.format===V.RGBA&&(!h||h.premultiply!==!1)),R)this.size=[S,k],l instanceof HTMLImageElement||l instanceof HTMLCanvasElement||l instanceof HTMLVideoElement||l instanceof ImageData||cr(l)?V.texImage2D(V.TEXTURE_2D,0,this.format,this.format,V.UNSIGNED_BYTE,l):V.texImage2D(V.TEXTURE_2D,0,this.format,S,k,0,this.format,V.UNSIGNED_BYTE,l.data);else{const{x:Z,y:ie}=v||{x:0,y:0};l instanceof HTMLImageElement||l instanceof HTMLCanvasElement||l instanceof HTMLVideoElement||l instanceof ImageData||cr(l)?V.texSubImage2D(V.TEXTURE_2D,0,Z,ie,V.RGBA,V.UNSIGNED_BYTE,l):V.texSubImage2D(V.TEXTURE_2D,0,Z,ie,S,k,V.RGBA,V.UNSIGNED_BYTE,l.data)}this.useMipmap&&this.isSizePowerOfTwo()&&V.generateMipmap(V.TEXTURE_2D),B.pixelStoreUnpackFlipY.setDefault(),B.pixelStoreUnpack.setDefault(),B.pixelStoreUnpackPremultiplyAlpha.setDefault()}bind(l,h,v){const{context:S}=this,{gl:k}=S;k.bindTexture(k.TEXTURE_2D,this.texture),v!==k.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(v=k.LINEAR),l!==this.filter&&(k.texParameteri(k.TEXTURE_2D,k.TEXTURE_MAG_FILTER,l),k.texParameteri(k.TEXTURE_2D,k.TEXTURE_MIN_FILTER,v||l),this.filter=l),h!==this.wrap&&(k.texParameteri(k.TEXTURE_2D,k.TEXTURE_WRAP_S,h),k.texParameteri(k.TEXTURE_2D,k.TEXTURE_WRAP_T,h),this.wrap=h)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:l}=this.context;l.deleteTexture(this.texture),this.texture=null}}class $6{constructor(l,h,v,S=1,k=1,R=1,B=0){if(this.uid=l,h.height!==h.width)throw new RangeError("DEM tiles must be square");if(v&&!["mapbox","terrarium","custom"].includes(v))return void at(`"${v}" is not a valid encoding type. Valid types include "mapbox", "terrarium" and "custom".`);this.stride=h.height;const V=this.dim=h.height-2;switch(this.data=new Uint32Array(h.data.buffer),v){case"terrarium":this.redFactor=256,this.greenFactor=1,this.blueFactor=1/256,this.baseShift=32768;break;case"custom":this.redFactor=S,this.greenFactor=k,this.blueFactor=R,this.baseShift=B;break;default:this.redFactor=6553.6,this.greenFactor=25.6,this.blueFactor=.1,this.baseShift=1e4}for(let Z=0;Z<V;Z++)this.data[this._idx(-1,Z)]=this.data[this._idx(0,Z)],this.data[this._idx(V,Z)]=this.data[this._idx(V-1,Z)],this.data[this._idx(Z,-1)]=this.data[this._idx(Z,0)],this.data[this._idx(Z,V)]=this.data[this._idx(Z,V-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(V,-1)]=this.data[this._idx(V-1,0)],this.data[this._idx(-1,V)]=this.data[this._idx(0,V-1)],this.data[this._idx(V,V)]=this.data[this._idx(V-1,V-1)],this.min=Number.MAX_SAFE_INTEGER,this.max=Number.MIN_SAFE_INTEGER;for(let Z=0;Z<V;Z++)for(let ie=0;ie<V;ie++){const ce=this.get(Z,ie);ce>this.max&&(this.max=ce),ce<this.min&&(this.min=ce)}}get(l,h){const v=new Uint8Array(this.data.buffer),S=4*this._idx(l,h);return this.unpack(v[S],v[S+1],v[S+2])}getUnpackVector(){return[this.redFactor,this.greenFactor,this.blueFactor,this.baseShift]}_idx(l,h){if(l<-1||l>=this.dim+1||h<-1||h>=this.dim+1)throw new RangeError(`Out of range source coordinates for DEM data. x: ${l}, y: ${h}, dim: ${this.dim}`);return(h+1)*this.stride+(l+1)}unpack(l,h,v){return l*this.redFactor+h*this.greenFactor+v*this.blueFactor-this.baseShift}pack(l){return q6(l,this.getUnpackVector())}getPixels(){return new lc({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(l,h,v){if(this.dim!==l.dim)throw new Error("dem dimension mismatch");let S=h*this.dim,k=h*this.dim+this.dim,R=v*this.dim,B=v*this.dim+this.dim;switch(h){case-1:S=k-1;break;case 1:k=S+1}switch(v){case-1:R=B-1;break;case 1:B=R+1}const V=-h*this.dim,Z=-v*this.dim;for(let ie=R;ie<B;ie++)for(let ce=S;ce<k;ce++)this.data[this._idx(ce,ie)]=l.data[this._idx(ce+V,ie+Z)]}}function q6(p,l){const h=l[0],v=l[1],S=l[2],k=l[3],R=Math.min(h,v,S),B=Math.round((p+k)/R);return{r:Math.floor(B*R/h)%256,g:Math.floor(B*R/v)%256,b:Math.floor(B*R/S)%256}}Pt("DEMData",$6);class lie extends eo{constructor(l,h){super(l,sie,h)}_createColorRamp(l){const h={elevationStops:[],colorStops:[]},v=this._transitionablePaint._values["color-relief-color"].value.expression;if(v instanceof Np&&v._styleExpression.expression instanceof Un){this.colorRampExpression=v;const R=v._styleExpression.expression;h.elevationStops=R.labels,h.colorStops=[];for(const B of h.elevationStops)h.colorStops.push(R.evaluate({globals:{elevation:B}}))}if(h.elevationStops.length<1&&(h.elevationStops=[0],h.colorStops=[kr.transparent]),h.elevationStops.length<2&&(h.elevationStops.push(h.elevationStops[0]+1),h.colorStops.push(h.colorStops[0])),h.elevationStops.length<=l)return h;const S={elevationStops:[],colorStops:[]},k=(h.elevationStops.length-1)/(l-1);for(let R=0;R<h.elevationStops.length-.5;R+=k)S.elevationStops.push(h.elevationStops[Math.round(R)]),S.colorStops.push(h.colorStops[Math.round(R)]);return at(`Too many colors in specification of ${this.id} color-relief layer, may not render properly. Max possible colors: ${l}, provided: ${h.elevationStops.length}`),S}_colorRampChanged(){return this.colorRampExpression!=this._transitionablePaint._values["color-relief-color"].value.expression}getColorRampTextures(l,h,v){if(this.colorRampTextures&&!this._colorRampChanged())return this.colorRampTextures;const S=this._createColorRamp(h),k=new lc({width:S.colorStops.length,height:1}),R=new lc({width:S.colorStops.length,height:1});for(let B=0;B<S.elevationStops.length;B++){const V=q6(S.elevationStops[B],v);R.setPixel(0,B,new kr(V.r/255,V.g/255,V.b/255,1)),k.setPixel(0,B,S.colorStops[B])}return this.colorRampTextures={elevationTexture:new uC(l,R,l.gl.RGBA),colorTexture:new uC(l,k,l.gl.RGBA)},this.colorRampTextures}hasOffscreenPass(){return!this.isHidden()&&!!this.colorRampTextures}}const uie=pa([{name:"a_pos",components:2,type:"Int16"}],4),{members:cie}=uie;function g2(p,l,h){const v=h.patternDependencies;let S=!1;for(const k of l){const R=k.paint.get(`${p}-pattern`);R.isConstant()||(S=!0);const B=R.constantOr(null);B&&(S=!0,v[B.to]=!0,v[B.from]=!0)}return S}function cC(p,l,h,v,S){const{zoom:k}=v,R=S.patternDependencies;for(const B of l){const V=B.paint.get(`${p}-pattern`).value;if(V.kind!=="constant"){let Z=V.evaluate({zoom:k-1},h,{},S.availableImages),ie=V.evaluate({zoom:k},h,{},S.availableImages),ce=V.evaluate({zoom:k+1},h,{},S.availableImages);Z=Z&&Z.name?Z.name:Z,ie=ie&&ie.name?ie.name:ie,ce=ce&&ce.name?ce.name:ce,R[Z]=!0,R[ie]=!0,R[ce]=!0,h.patterns[B.id]={min:Z,mid:ie,max:ce}}}return h}function H6(p,l,h,v,S){let k;if(S===(function(R,B,V,Z){let ie=0;for(let ce=B,ve=V-Z;ce<V;ce+=Z)ie+=(R[ve]-R[ce])*(R[ce+1]+R[ve+1]),ve=ce;return ie})(p,l,h,v)>0)for(let R=l;R<h;R+=v)k=Y6(R/v|0,p[R],p[R+1],k);else for(let R=h-v;R>=l;R-=v)k=Y6(R/v|0,p[R],p[R+1],k);return k&&Wy(k,k.next)&&(B_(k),k=k.next),k}function tm(p,l){if(!p)return p;l||(l=p);let h,v=p;do if(h=!1,v.steiner||!Wy(v,v.next)&&_s(v.prev,v,v.next)!==0)v=v.next;else{if(B_(v),v=l=v.prev,v===v.next)break;h=!0}while(h||v!==l);return l}function N_(p,l,h,v,S,k,R){if(!p)return;!R&&k&&(function(V,Z,ie,ce){let ve=V;do ve.z===0&&(ve.z=fC(ve.x,ve.y,Z,ie,ce)),ve.prevZ=ve.prev,ve.nextZ=ve.next,ve=ve.next;while(ve!==V);ve.prevZ.nextZ=null,ve.prevZ=null,(function(Ee){let Ne,ze=1;do{let Ve,et=Ee;Ee=null;let Ct=null;for(Ne=0;et;){Ne++;let rt=et,ut=0;for(let Bt=0;Bt<ze&&(ut++,rt=rt.nextZ,rt);Bt++);let Rt=ze;for(;ut>0||Rt>0&&rt;)ut!==0&&(Rt===0||!rt||et.z<=rt.z)?(Ve=et,et=et.nextZ,ut--):(Ve=rt,rt=rt.nextZ,Rt--),Ct?Ct.nextZ=Ve:Ee=Ve,Ve.prevZ=Ct,Ct=Ve;et=rt}Ct.nextZ=null,ze*=2}while(Ne>1)})(ve)})(p,v,S,k);let B=p;for(;p.prev!==p.next;){const V=p.prev,Z=p.next;if(k?hie(p,v,S,k):fie(p))l.push(V.i,p.i,Z.i),B_(p),p=Z.next,B=Z.next;else if((p=Z)===B){R?R===1?N_(p=die(tm(p),l),l,h,v,S,k,2):R===2&&pie(p,l,h,v,S,k):N_(tm(p),l,h,v,S,k,1);break}}}function fie(p){const l=p.prev,h=p,v=p.next;if(_s(l,h,v)>=0)return!1;const S=l.x,k=h.x,R=v.x,B=l.y,V=h.y,Z=v.y,ie=Math.min(S,k,R),ce=Math.min(B,V,Z),ve=Math.max(S,k,R),Ee=Math.max(B,V,Z);let Ne=v.next;for(;Ne!==l;){if(Ne.x>=ie&&Ne.x<=ve&&Ne.y>=ce&&Ne.y<=Ee&&L_(S,B,k,V,R,Z,Ne.x,Ne.y)&&_s(Ne.prev,Ne,Ne.next)>=0)return!1;Ne=Ne.next}return!0}function hie(p,l,h,v){const S=p.prev,k=p,R=p.next;if(_s(S,k,R)>=0)return!1;const B=S.x,V=k.x,Z=R.x,ie=S.y,ce=k.y,ve=R.y,Ee=Math.min(B,V,Z),Ne=Math.min(ie,ce,ve),ze=Math.max(B,V,Z),Ve=Math.max(ie,ce,ve),et=fC(Ee,Ne,l,h,v),Ct=fC(ze,Ve,l,h,v);let rt=p.prevZ,ut=p.nextZ;for(;rt&&rt.z>=et&&ut&&ut.z<=Ct;){if(rt.x>=Ee&&rt.x<=ze&&rt.y>=Ne&&rt.y<=Ve&&rt!==S&&rt!==R&&L_(B,ie,V,ce,Z,ve,rt.x,rt.y)&&_s(rt.prev,rt,rt.next)>=0||(rt=rt.prevZ,ut.x>=Ee&&ut.x<=ze&&ut.y>=Ne&&ut.y<=Ve&&ut!==S&&ut!==R&&L_(B,ie,V,ce,Z,ve,ut.x,ut.y)&&_s(ut.prev,ut,ut.next)>=0))return!1;ut=ut.nextZ}for(;rt&&rt.z>=et;){if(rt.x>=Ee&&rt.x<=ze&&rt.y>=Ne&&rt.y<=Ve&&rt!==S&&rt!==R&&L_(B,ie,V,ce,Z,ve,rt.x,rt.y)&&_s(rt.prev,rt,rt.next)>=0)return!1;rt=rt.prevZ}for(;ut&&ut.z<=Ct;){if(ut.x>=Ee&&ut.x<=ze&&ut.y>=Ne&&ut.y<=Ve&&ut!==S&&ut!==R&&L_(B,ie,V,ce,Z,ve,ut.x,ut.y)&&_s(ut.prev,ut,ut.next)>=0)return!1;ut=ut.nextZ}return!0}function die(p,l){let h=p;do{const v=h.prev,S=h.next.next;!Wy(v,S)&&W6(v,h,h.next,S)&&F_(v,S)&&F_(S,v)&&(l.push(v.i,h.i,S.i),B_(h),B_(h.next),h=p=S),h=h.next}while(h!==p);return tm(h)}function pie(p,l,h,v,S,k){let R=p;do{let B=R.next.next;for(;B!==R.prev;){if(R.i!==B.i&&_ie(R,B)){let V=X6(R,B);return R=tm(R,R.next),V=tm(V,V.next),N_(R,l,h,v,S,k,0),void N_(V,l,h,v,S,k,0)}B=B.next}R=R.next}while(R!==p)}function gie(p,l){let h=p.x-l.x;return h===0&&(h=p.y-l.y,h===0)&&(h=(p.next.y-p.y)/(p.next.x-p.x)-(l.next.y-l.y)/(l.next.x-l.x)),h}function mie(p,l){const h=(function(S,k){let R=k;const B=S.x,V=S.y;let Z,ie=-1/0;if(Wy(S,R))return R;do{if(Wy(S,R.next))return R.next;if(V<=R.y&&V>=R.next.y&&R.next.y!==R.y){const ze=R.x+(V-R.y)*(R.next.x-R.x)/(R.next.y-R.y);if(ze<=B&&ze>ie&&(ie=ze,Z=R.x<R.next.x?R:R.next,ze===B))return Z}R=R.next}while(R!==k);if(!Z)return null;const ce=Z,ve=Z.x,Ee=Z.y;let Ne=1/0;R=Z;do{if(B>=R.x&&R.x>=ve&&B!==R.x&&G6(V<Ee?B:ie,V,ve,Ee,V<Ee?ie:B,V,R.x,R.y)){const ze=Math.abs(V-R.y)/(B-R.x);F_(R,S)&&(ze<Ne||ze===Ne&&(R.x>Z.x||R.x===Z.x&&yie(Z,R)))&&(Z=R,Ne=ze)}R=R.next}while(R!==ce);return Z})(p,l);if(!h)return l;const v=X6(h,p);return tm(v,v.next),tm(h,h.next)}function yie(p,l){return _s(p.prev,p,l.prev)<0&&_s(l.next,p,p.next)<0}function fC(p,l,h,v,S){return(p=1431655765&((p=858993459&((p=252645135&((p=16711935&((p=(p-h)*S|0)|p<<8))|p<<4))|p<<2))|p<<1))|(l=1431655765&((l=858993459&((l=252645135&((l=16711935&((l=(l-v)*S|0)|l<<8))|l<<4))|l<<2))|l<<1))<<1}function vie(p){let l=p,h=p;do(l.x<h.x||l.x===h.x&&l.y<h.y)&&(h=l),l=l.next;while(l!==p);return h}function G6(p,l,h,v,S,k,R,B){return(S-R)*(l-B)>=(p-R)*(k-B)&&(p-R)*(v-B)>=(h-R)*(l-B)&&(h-R)*(k-B)>=(S-R)*(v-B)}function L_(p,l,h,v,S,k,R,B){return!(p===R&&l===B)&&G6(p,l,h,v,S,k,R,B)}function _ie(p,l){return p.next.i!==l.i&&p.prev.i!==l.i&&!(function(h,v){let S=h;do{if(S.i!==h.i&&S.next.i!==h.i&&S.i!==v.i&&S.next.i!==v.i&&W6(S,S.next,h,v))return!0;S=S.next}while(S!==h);return!1})(p,l)&&(F_(p,l)&&F_(l,p)&&(function(h,v){let S=h,k=!1;const R=(h.x+v.x)/2,B=(h.y+v.y)/2;do S.y>B!=S.next.y>B&&S.next.y!==S.y&&R<(S.next.x-S.x)*(B-S.y)/(S.next.y-S.y)+S.x&&(k=!k),S=S.next;while(S!==h);return k})(p,l)&&(_s(p.prev,p,l.prev)||_s(p,l.prev,l))||Wy(p,l)&&_s(p.prev,p,p.next)>0&&_s(l.prev,l,l.next)>0)}function _s(p,l,h){return(l.y-p.y)*(h.x-l.x)-(l.x-p.x)*(h.y-l.y)}function Wy(p,l){return p.x===l.x&&p.y===l.y}function W6(p,l,h,v){const S=y2(_s(p,l,h)),k=y2(_s(p,l,v)),R=y2(_s(h,v,p)),B=y2(_s(h,v,l));return S!==k&&R!==B||!(S!==0||!m2(p,h,l))||!(k!==0||!m2(p,v,l))||!(R!==0||!m2(h,p,v))||!(B!==0||!m2(h,l,v))}function m2(p,l,h){return l.x<=Math.max(p.x,h.x)&&l.x>=Math.min(p.x,h.x)&&l.y<=Math.max(p.y,h.y)&&l.y>=Math.min(p.y,h.y)}function y2(p){return p>0?1:p<0?-1:0}function F_(p,l){return _s(p.prev,p,p.next)<0?_s(p,l,p.next)>=0&&_s(p,p.prev,l)>=0:_s(p,l,p.prev)<0||_s(p,p.next,l)<0}function X6(p,l){const h=hC(p.i,p.x,p.y),v=hC(l.i,l.x,l.y),S=p.next,k=l.prev;return p.next=l,l.prev=p,h.next=S,S.prev=h,v.next=h,h.prev=v,k.next=v,v.prev=k,v}function Y6(p,l,h,v){const S=hC(p,l,h);return v?(S.next=v.next,S.prev=v,v.next.prev=S,v.next=S):(S.prev=S,S.next=S),S}function B_(p){p.next.prev=p.prev,p.prev.next=p.next,p.prevZ&&(p.prevZ.nextZ=p.nextZ),p.nextZ&&(p.nextZ.prevZ=p.prevZ)}function hC(p,l,h){return{i:p,x:l,y:h,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}class Xy{constructor(l,h){if(h>l)throw new Error("Min granularity must not be greater than base granularity.");this._baseZoomGranularity=l,this._minGranularity=h}getGranularityForZoomLevel(l){return Math.max(Math.floor(this._baseZoomGranularity/(1<<l)),this._minGranularity,1)}}class v2{constructor(l){this.fill=l.fill,this.line=l.line,this.tile=l.tile,this.stencil=l.stencil,this.circle=l.circle}}v2.noSubdivision=new v2({fill:new Xy(0,0),line:new Xy(0,0),tile:new Xy(0,0),stencil:new Xy(0,0),circle:1}),Pt("SubdivisionGranularityExpression",Xy),Pt("SubdivisionGranularitySetting",v2);const Yy=-32768,z_=32767;class bie{constructor(l,h){this._vertexBuffer=[],this._vertexDictionary=new Map,this._used=!1,this._granularity=l,this._granularityCellSize=Te/l,this._canonical=h}_getKey(l,h){return(l+=32768)<<16|h+32768}_vertexToIndex(l,h){if(l<-32768||h<-32768||l>32767||h>32767)throw new Error("Vertex coordinates are out of signed 16 bit integer range.");const v=0|Math.round(l),S=0|Math.round(h),k=this._getKey(v,S);if(this._vertexDictionary.has(k))return this._vertexDictionary.get(k);const R=this._vertexBuffer.length/2;return this._vertexDictionary.set(k,R),this._vertexBuffer.push(v,S),R}_subdivideTrianglesScanline(l){if(this._granularity<2)return(function(S,k){const R=[];for(let B=0;B<k.length;B+=3){const V=k[B],Z=k[B+1],ie=k[B+2],ce=S[2*V],ve=S[2*V+1];(S[2*Z]-ce)*(S[2*ie+1]-ve)-(S[2*Z+1]-ve)*(S[2*ie]-ce)>0?(R.push(V),R.push(ie),R.push(Z)):(R.push(V),R.push(Z),R.push(ie))}return R})(this._vertexBuffer,l);const h=[],v=l.length;for(let S=0;S<v;S+=3){const k=[l[S+0],l[S+1],l[S+2]],R=[this._vertexBuffer[2*l[S+0]+0],this._vertexBuffer[2*l[S+0]+1],this._vertexBuffer[2*l[S+1]+0],this._vertexBuffer[2*l[S+1]+1],this._vertexBuffer[2*l[S+2]+0],this._vertexBuffer[2*l[S+2]+1]];let B=1/0,V=1/0,Z=-1/0,ie=-1/0;for(let ze=0;ze<3;ze++){const Ve=R[2*ze],et=R[2*ze+1];B=Math.min(B,Ve),Z=Math.max(Z,Ve),V=Math.min(V,et),ie=Math.max(ie,et)}if(B===Z||V===ie)continue;const ce=Math.floor(B/this._granularityCellSize),ve=Math.ceil(Z/this._granularityCellSize),Ee=Math.floor(V/this._granularityCellSize),Ne=Math.ceil(ie/this._granularityCellSize);if(ce!==ve||Ee!==Ne)for(let ze=Ee;ze<Ne;ze++){const Ve=this._scanlineGenerateVertexRingForCellRow(ze,R,k);xie(this._vertexBuffer,Ve,h)}else h.push(...k)}return h}_scanlineGenerateVertexRingForCellRow(l,h,v){const S=l*this._granularityCellSize,k=S+this._granularityCellSize,R=[];for(let B=0;B<3;B++){const V=h[2*B],Z=h[2*B+1],ie=h[2*(B+1)%6],ce=h[(2*(B+1)+1)%6],ve=h[2*(B+2)%6],Ee=h[(2*(B+2)+1)%6],Ne=ie-V,ze=ce-Z,Ve=Ne===0,et=ze===0,Ct=(S-Z)/ze,rt=(k-Z)/ze,ut=Math.min(Ct,rt),Rt=Math.max(Ct,rt);if(!et&&(ut>=1||Rt<=0)||et&&(Z<S||Z>k)){ce>=S&&ce<=k&&R.push(v[(B+1)%3]);continue}!et&&ut>0&&R.push(this._vertexToIndex(V+Ne*ut,Z+ze*ut));const Bt=V+Ne*Math.max(ut,0),dr=V+Ne*Math.min(Rt,1);Ve||this._generateIntraEdgeVertices(R,V,Z,ie,ce,Bt,dr),!et&&Rt<1&&R.push(this._vertexToIndex(V+Ne*Rt,Z+ze*Rt)),(et||ce>=S&&ce<=k)&&R.push(v[(B+1)%3]),!et&&(ce<=S||ce>=k)&&this._generateInterEdgeVertices(R,V,Z,ie,ce,ve,Ee,dr,S,k)}return R}_generateIntraEdgeVertices(l,h,v,S,k,R,B){const V=S-h,Z=k-v,ie=Z===0,ce=ie?Math.min(h,S):Math.min(R,B),ve=ie?Math.max(h,S):Math.max(R,B),Ee=Math.floor(ce/this._granularityCellSize)+1,Ne=Math.ceil(ve/this._granularityCellSize)-1;if(ie?h<S:R<B)for(let ze=Ee;ze<=Ne;ze++){const Ve=ze*this._granularityCellSize;l.push(this._vertexToIndex(Ve,v+Z*(Ve-h)/V))}else for(let ze=Ne;ze>=Ee;ze--){const Ve=ze*this._granularityCellSize;l.push(this._vertexToIndex(Ve,v+Z*(Ve-h)/V))}}_generateInterEdgeVertices(l,h,v,S,k,R,B,V,Z,ie){const ce=k-v,ve=R-S,Ee=B-k,Ne=(Z-k)/Ee,ze=(ie-k)/Ee,Ve=Math.min(Ne,ze),et=Math.max(Ne,ze),Ct=S+ve*Ve;let rt=Math.floor(Math.min(Ct,V)/this._granularityCellSize)+1,ut=Math.ceil(Math.max(Ct,V)/this._granularityCellSize)-1,Rt=V<Ct;const Bt=Ee===0;if(Bt&&(B===Z||B===ie))return;if(Bt||Ve>=1||et<=0){const Or=v-B,Pr=R+(h-R)*Math.min((Z-B)/Or,(ie-B)/Or);rt=Math.floor(Math.min(Pr,V)/this._granularityCellSize)+1,ut=Math.ceil(Math.max(Pr,V)/this._granularityCellSize)-1,Rt=V<Pr}const dr=ce>0?ie:Z;if(Rt)for(let Or=rt;Or<=ut;Or++)l.push(this._vertexToIndex(Or*this._granularityCellSize,dr));else for(let Or=ut;Or>=rt;Or--)l.push(this._vertexToIndex(Or*this._granularityCellSize,dr))}_generateOutline(l){const h=[];for(const v of l){const S=rm(v,this._granularity,!0),k=this._pointArrayToIndices(S),R=[];for(let B=1;B<k.length;B++)R.push(k[B-1]),R.push(k[B]);h.push(R)}return h}_handlePoles(l){let h=!1,v=!1;this._canonical&&(this._canonical.y===0&&(h=!0),this._canonical.y===(1<<this._canonical.z)-1&&(v=!0)),(h||v)&&this._fillPoles(l,h,v)}_ensureNoPoleVertices(){const l=this._vertexBuffer;for(let h=0;h<l.length;h+=2){const v=l[h+1];v===Yy&&(l[h+1]=-32767),v===z_&&(l[h+1]=32766)}}_generatePoleQuad(l,h,v,S,k,R){S>k!=(R===Yy)?(l.push(h),l.push(v),l.push(this._vertexToIndex(S,R)),l.push(v),l.push(this._vertexToIndex(k,R)),l.push(this._vertexToIndex(S,R))):(l.push(v),l.push(h),l.push(this._vertexToIndex(S,R)),l.push(this._vertexToIndex(k,R)),l.push(v),l.push(this._vertexToIndex(S,R)))}_fillPoles(l,h,v){const S=this._vertexBuffer,k=Te,R=l.length;for(let B=2;B<R;B+=3){const V=l[B-2],Z=l[B-1],ie=l[B],ce=S[2*V],ve=S[2*V+1],Ee=S[2*Z],Ne=S[2*Z+1],ze=S[2*ie],Ve=S[2*ie+1];h&&(ve===0&&Ne===0&&this._generatePoleQuad(l,V,Z,ce,Ee,Yy),Ne===0&&Ve===0&&this._generatePoleQuad(l,Z,ie,Ee,ze,Yy),Ve===0&&ve===0&&this._generatePoleQuad(l,ie,V,ze,ce,Yy)),v&&(ve===k&&Ne===k&&this._generatePoleQuad(l,V,Z,ce,Ee,z_),Ne===k&&Ve===k&&this._generatePoleQuad(l,Z,ie,Ee,ze,z_),Ve===k&&ve===k&&this._generatePoleQuad(l,ie,V,ze,ce,z_))}}_initializeVertices(l){for(let h=0;h<l.length;h+=2)this._vertexToIndex(l[h],l[h+1])}subdividePolygonInternal(l,h){if(this._used)throw new Error("Subdivision: multiple use not allowed.");this._used=!0;const{flattened:v,holeIndices:S}=(function(B){const V=[],Z=[];for(const ie of B)if(ie.length!==0){ie!==B[0]&&V.push(Z.length/2);for(let ce=0;ce<ie.length;ce++)Z.push(ie[ce].x),Z.push(ie[ce].y)}return{flattened:Z,holeIndices:V}})(l);let k;this._initializeVertices(v);try{const B=(function(Z,ie,ce=2){const ve=ie&&ie.length,Ee=ve?ie[0]*ce:Z.length;let Ne=H6(Z,0,Ee,ce,!0);const ze=[];if(!Ne||Ne.next===Ne.prev)return ze;let Ve,et,Ct;if(ve&&(Ne=(function(rt,ut,Rt,Bt){const dr=[];for(let Or=0,Pr=ut.length;Or<Pr;Or++){const Vr=H6(rt,ut[Or]*Bt,Or<Pr-1?ut[Or+1]*Bt:rt.length,Bt,!1);Vr===Vr.next&&(Vr.steiner=!0),dr.push(vie(Vr))}dr.sort(gie);for(let Or=0;Or<dr.length;Or++)Rt=mie(dr[Or],Rt);return Rt})(Z,ie,Ne,ce)),Z.length>80*ce){Ve=Z[0],et=Z[1];let rt=Ve,ut=et;for(let Rt=ce;Rt<Ee;Rt+=ce){const Bt=Z[Rt],dr=Z[Rt+1];Bt<Ve&&(Ve=Bt),dr<et&&(et=dr),Bt>rt&&(rt=Bt),dr>ut&&(ut=dr)}Ct=Math.max(rt-Ve,ut-et),Ct=Ct!==0?32767/Ct:0}return N_(Ne,ze,ce,Ve,et,Ct,0),ze})(v,S),V=this._convertIndices(v,B);k=this._subdivideTrianglesScanline(V)}catch(B){console.error(B)}let R=[];return h&&(R=this._generateOutline(l)),this._ensureNoPoleVertices(),this._handlePoles(k),{verticesFlattened:this._vertexBuffer,indicesTriangles:k,indicesLineList:R}}_convertIndices(l,h){const v=[];for(let S=0;S<h.length;S++)v.push(this._vertexToIndex(l[2*h[S]],l[2*h[S]+1]));return v}_pointArrayToIndices(l){const h=[];for(let v=0;v<l.length;v++){const S=l[v];h.push(this._vertexToIndex(S.x,S.y))}return h}}function Z6(p,l,h,v=!0){return new bie(h,l).subdividePolygonInternal(p,v)}function rm(p,l,h=!1){if(!p||p.length<1)return[];if(p.length<2)return[];const v=p[0],S=p[p.length-1],k=h&&(v.x!==S.x||v.y!==S.y);if(l<2)return k?[...p,p[0]]:[...p];const R=Math.floor(Te/l),B=[];B.push(new c(p[0].x,p[0].y));const V=p.length,Z=k?V:V-1;for(let ie=0;ie<Z;ie++){const ce=p[ie],ve=ie<V-1?p[ie+1]:p[0],Ee=ce.x,Ne=ce.y,ze=ve.x,Ve=ve.y,et=Ee!==ze,Ct=Ne!==Ve;if(!et&&!Ct)continue;const rt=ze-Ee,ut=Ve-Ne,Rt=Math.abs(rt),Bt=Math.abs(ut);let dr=Ee,Or=Ne;for(;;){const Vr=rt>0?(Math.floor(dr/R)+1)*R:(Math.ceil(dr/R)-1)*R,pn=ut>0?(Math.floor(Or/R)+1)*R:(Math.ceil(Or/R)-1)*R,Wr=Math.abs(dr-Vr),Rr=Math.abs(Or-pn),Tr=Math.abs(dr-ze),Cn=Math.abs(Or-Ve),xn=et?Wr/Rt:Number.POSITIVE_INFINITY,kn=Ct?Rr/Bt:Number.POSITIVE_INFINITY;if((Tr<=Wr||!et)&&(Cn<=Rr||!Ct))break;if(xn<kn&&et||!Ct){dr=Vr,Or+=ut*xn;const vn=new c(dr,Math.round(Or));B[B.length-1].x===vn.x&&B[B.length-1].y===vn.y||B.push(vn)}else{dr+=rt*kn,Or=pn;const vn=new c(Math.round(dr),Or);B[B.length-1].x===vn.x&&B[B.length-1].y===vn.y||B.push(vn)}}const Pr=new c(ze,Ve);B[B.length-1].x===Pr.x&&B[B.length-1].y===Pr.y||B.push(Pr)}return B}function xie(p,l,h){if(l.length===0)throw new Error("Subdivision vertex ring is empty.");let v=0,S=p[2*l[0]];for(let V=1;V<l.length;V++){const Z=p[2*l[V]];Z<S&&(S=Z,v=V)}const k=l.length;let R=v,B=(R+1)%k;for(;;){const V=R-1>=0?R-1:k-1,Z=(B+1)%k,ie=p[2*l[V]],ce=p[2*l[Z]],ve=p[2*l[R]],Ee=p[2*l[R]+1],Ne=p[2*l[B]+1];let ze=!1;if(ie<ce)ze=!0;else if(ie>ce)ze=!1;else{const Ve=Ne-Ee,et=-(p[2*l[B]]-ve),Ct=Ee<Ne?1:-1;((ie-ve)*Ve+(p[2*l[V]+1]-Ee)*et)*Ct>((ce-ve)*Ve+(p[2*l[Z]+1]-Ee)*et)*Ct&&(ze=!0)}if(ze){const Ve=l[V],et=l[R],Ct=l[B];Ve!==et&&Ve!==Ct&&et!==Ct&&h.push(Ct,et,Ve),R--,R<0&&(R=k-1)}else{const Ve=l[Z],et=l[R],Ct=l[B];Ve!==et&&Ve!==Ct&&et!==Ct&&h.push(Ct,et,Ve),B++,B>=k&&(B=0)}if(V===Z)break}}function K6(p,l,h,v,S,k,R,B,V){const Z=S.length/2,ie=R&&B&&V;if(Z<gn.MAX_VERTEX_ARRAY_LENGTH){const ce=l.prepareSegment(Z,h,v),ve=ce.vertexLength;for(let ze=0;ze<k.length;ze+=3)v.emplaceBack(ve+k[ze],ve+k[ze+1],ve+k[ze+2]);let Ee,Ne;ce.vertexLength+=Z,ce.primitiveLength+=k.length/3,ie&&(Ne=R.prepareSegment(Z,h,B),Ee=Ne.vertexLength,Ne.vertexLength+=Z);for(let ze=0;ze<S.length;ze+=2)p(S[ze],S[ze+1]);if(ie)for(let ze=0;ze<V.length;ze++){const Ve=V[ze];for(let et=1;et<Ve.length;et+=2)B.emplaceBack(Ee+Ve[et-1],Ee+Ve[et]);Ne.primitiveLength+=Ve.length/2}}else(function(ce,ve,Ee,Ne,ze,Ve){const et=[];for(let Bt=0;Bt<Ne.length/2;Bt++)et.push(-1);const Ct={count:0};let rt=0,ut=ce.getOrCreateLatestSegment(ve,Ee),Rt=ut.vertexLength;for(let Bt=2;Bt<ze.length;Bt+=3){const dr=ze[Bt-2],Or=ze[Bt-1],Pr=ze[Bt];let Vr=et[dr]<rt,pn=et[Or]<rt,Wr=et[Pr]<rt;ut.vertexLength+((Vr?1:0)+(pn?1:0)+(Wr?1:0))>gn.MAX_VERTEX_ARRAY_LENGTH&&(ut=ce.createNewSegment(ve,Ee),rt=Ct.count,Vr=!0,pn=!0,Wr=!0,Rt=0);const Rr=j_(et,Ne,Ve,Ct,dr,Vr,ut),Tr=j_(et,Ne,Ve,Ct,Or,pn,ut),Cn=j_(et,Ne,Ve,Ct,Pr,Wr,ut);Ee.emplaceBack(Rt+Rr-rt,Rt+Tr-rt,Rt+Cn-rt),ut.primitiveLength++}})(l,h,v,S,k,p),ie&&(function(ce,ve,Ee,Ne,ze,Ve){const et=[];for(let Bt=0;Bt<Ne.length/2;Bt++)et.push(-1);const Ct={count:0};let rt=0,ut=ce.getOrCreateLatestSegment(ve,Ee),Rt=ut.vertexLength;for(let Bt=0;Bt<ze.length;Bt++){const dr=ze[Bt];for(let Or=1;Or<ze[Bt].length;Or+=2){const Pr=dr[Or-1],Vr=dr[Or];let pn=et[Pr]<rt,Wr=et[Vr]<rt;ut.vertexLength+((pn?1:0)+(Wr?1:0))>gn.MAX_VERTEX_ARRAY_LENGTH&&(ut=ce.createNewSegment(ve,Ee),rt=Ct.count,pn=!0,Wr=!0,Rt=0);const Rr=j_(et,Ne,Ve,Ct,Pr,pn,ut),Tr=j_(et,Ne,Ve,Ct,Vr,Wr,ut);Ee.emplaceBack(Rt+Rr-rt,Rt+Tr-rt),ut.primitiveLength++}}})(R,h,B,S,V,p),l.forceNewSegmentOnNextPrepare(),R?.forceNewSegmentOnNextPrepare()}function j_(p,l,h,v,S,k,R){if(k){const B=v.count;return h(l[2*S],l[2*S+1]),p[S]=v.count,v.count++,R.vertexLength++,B}return p[S]}class dC{constructor(l){this.zoom=l.zoom,this.overscaling=l.overscaling,this.layers=l.layers,this.layerIds=this.layers.map((h=>h.id)),this.index=l.index,this.hasDependencies=!1,this.patternFeatures=[],this.layoutVertexArray=new dt,this.indexArray=new xr,this.indexArray2=new an,this.programConfigurations=new Hd(l.layers,l.zoom),this.segments=new gn,this.segments2=new gn,this.stateDependentLayerIds=this.layers.filter((h=>h.isStateDependent())).map((h=>h.id))}populate(l,h,v){this.hasDependencies=g2("fill",this.layers,h);const S=this.layers[0].layout.get("fill-sort-key"),k=!S.isConstant(),R=[];for(const{feature:B,id:V,index:Z,sourceLayerIndex:ie}of l){const ce=this.layers[0]._featureFilter.needGeometry,ve=Jh(B,ce);if(!this.layers[0]._featureFilter.filter(new ki(this.zoom),ve,v))continue;const Ee=k?S.evaluate(ve,{},v,h.availableImages):void 0,Ne={id:V,properties:B.properties,type:B.type,sourceLayerIndex:ie,index:Z,geometry:ce?ve.geometry:Kh(B),patterns:{},sortKey:Ee};R.push(Ne)}k&&R.sort(((B,V)=>B.sortKey-V.sortKey));for(const B of R){const{geometry:V,index:Z,sourceLayerIndex:ie}=B;if(this.hasDependencies){const ce=cC("fill",this.layers,B,{zoom:this.zoom},h);this.patternFeatures.push(ce)}else this.addFeature(B,V,Z,v,{},h.subdivisionGranularity);h.featureIndex.insert(l[Z].feature,V,Z,ie,this.index)}}update(l,h,v){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(l,h,this.stateDependentLayers,{imagePositions:v})}addFeatures(l,h,v){for(const S of this.patternFeatures)this.addFeature(S,S.geometry,S.index,h,v,l.subdivisionGranularity)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(l){this.uploaded||(this.layoutVertexBuffer=l.createVertexBuffer(this.layoutVertexArray,cie),this.indexBuffer=l.createIndexBuffer(this.indexArray),this.indexBuffer2=l.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(l),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(l,h,v,S,k,R){for(const B of Vl(h,500)){const V=Z6(B,S,R.fill.getGranularityForZoomLevel(S.z)),Z=this.layoutVertexArray;K6(((ie,ce)=>{Z.emplaceBack(ie,ce)}),this.segments,this.layoutVertexArray,this.indexArray,V.verticesFlattened,V.indicesTriangles,this.segments2,this.indexArray2,V.indicesLineList)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,l,v,{imagePositions:k,canonical:S})}}let J6,Q6;Pt("FillBucket",dC,{omit:["layers","patternFeatures"]});var wie={get paint(){return Q6=Q6||new $a({"fill-antialias":new Tn(Mt.paint_fill["fill-antialias"]),"fill-opacity":new Sn(Mt.paint_fill["fill-opacity"]),"fill-color":new Sn(Mt.paint_fill["fill-color"]),"fill-outline-color":new Sn(Mt.paint_fill["fill-outline-color"]),"fill-translate":new Tn(Mt.paint_fill["fill-translate"]),"fill-translate-anchor":new Tn(Mt.paint_fill["fill-translate-anchor"]),"fill-pattern":new Rs(Mt.paint_fill["fill-pattern"])})},get layout(){return J6=J6||new $a({"fill-sort-key":new Sn(Mt.layout_fill["fill-sort-key"])})}};class Sie extends eo{constructor(l,h){super(l,wie,h)}recalculate(l,h){super.recalculate(l,h);const v=this.paint._values["fill-outline-color"];v.value.kind==="constant"&&v.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(l){return new dC(l)}queryRadius(){return d2(this.paint.get("fill-translate"))}queryIntersectsFeature({queryGeometry:l,geometry:h,transform:v,pixelsToTileUnits:S}){return R6(p2(l,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),-v.bearingInRadians,S),h)}isTileClipped(){return!0}}const Eie=pa([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4),Tie=pa([{name:"a_centroid",components:2,type:"Int16"}],4),{members:Cie}=Eie;class U_{constructor(l,h,v,S,k){this.properties={},this.extent=v,this.type=0,this.id=void 0,this._pbf=l,this._geometry=-1,this._keys=S,this._values=k,l.readFields(Aie,this,h)}loadGeometry(){const l=this._pbf;l.pos=this._geometry;const h=l.readVarint()+l.pos,v=[];let S,k=1,R=0,B=0,V=0;for(;l.pos<h;){if(R<=0){const Z=l.readVarint();k=7&Z,R=Z>>3}if(R--,k===1||k===2)B+=l.readSVarint(),V+=l.readSVarint(),k===1&&(S&&v.push(S),S=[]),S&&S.push(new c(B,V));else{if(k!==7)throw new Error(`unknown command ${k}`);S&&S.push(S[0].clone())}}return S&&v.push(S),v}bbox(){const l=this._pbf;l.pos=this._geometry;const h=l.readVarint()+l.pos;let v=1,S=0,k=0,R=0,B=1/0,V=-1/0,Z=1/0,ie=-1/0;for(;l.pos<h;){if(S<=0){const ce=l.readVarint();v=7&ce,S=ce>>3}if(S--,v===1||v===2)k+=l.readSVarint(),R+=l.readSVarint(),k<B&&(B=k),k>V&&(V=k),R<Z&&(Z=R),R>ie&&(ie=R);else if(v!==7)throw new Error(`unknown command ${v}`)}return[B,Z,V,ie]}toGeoJSON(l,h,v){const S=this.extent*Math.pow(2,v),k=this.extent*l,R=this.extent*h,B=this.loadGeometry();function V(ve){return[360*(ve.x+k)/S-180,360/Math.PI*Math.atan(Math.exp((1-2*(ve.y+R)/S)*Math.PI))-90]}function Z(ve){return ve.map(V)}let ie;if(this.type===1){const ve=[];for(const Ne of B)ve.push(Ne[0]);const Ee=Z(ve);ie=ve.length===1?{type:"Point",coordinates:Ee[0]}:{type:"MultiPoint",coordinates:Ee}}else if(this.type===2){const ve=B.map(Z);ie=ve.length===1?{type:"LineString",coordinates:ve[0]}:{type:"MultiLineString",coordinates:ve}}else{if(this.type!==3)throw new Error("unknown feature type");{const ve=eF(B),Ee=[];for(const Ne of ve)Ee.push(Ne.map(Z));ie=Ee.length===1?{type:"Polygon",coordinates:Ee[0]}:{type:"MultiPolygon",coordinates:Ee}}}const ce={type:"Feature",geometry:ie,properties:this.properties};return this.id!=null&&(ce.id=this.id),ce}}function Aie(p,l,h){p===1?l.id=h.readVarint():p===2?(function(v,S){const k=v.readVarint()+v.pos;for(;v.pos<k;){const R=S._keys[v.readVarint()],B=S._values[v.readVarint()];S.properties[R]=B}})(h,l):p===3?l.type=h.readVarint():p===4&&(l._geometry=h.pos)}function eF(p){const l=p.length;if(l<=1)return[p];const h=[];let v,S;for(let k=0;k<l;k++){const R=Iie(p[k]);R!==0&&(S===void 0&&(S=R<0),S===R<0?(v&&h.push(v),v=[p[k]]):v&&v.push(p[k]))}return v&&h.push(v),h}function Iie(p){let l=0;for(let h,v,S=0,k=p.length,R=k-1;S<k;R=S++)h=p[S],v=p[R],l+=(v.x-h.x)*(h.y+v.y);return l}U_.types=["Unknown","Point","LineString","Polygon"];class Pie{constructor(l,h){this.version=1,this.name="",this.extent=4096,this.length=0,this._pbf=l,this._keys=[],this._values=[],this._features=[],l.readFields(kie,this,h),this.length=this._features.length}feature(l){if(l<0||l>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[l];const h=this._pbf.readVarint()+this._pbf.pos;return new U_(this._pbf,h,this.extent,this._keys,this._values)}}function kie(p,l,h){p===15?l.version=h.readVarint():p===1?l.name=h.readString():p===5?l.extent=h.readVarint():p===2?l._features.push(h.pos):p===3?l._keys.push(h.readString()):p===4&&l._values.push((function(v){let S=null;const k=v.readVarint()+v.pos;for(;v.pos<k;){const R=v.readVarint()>>3;S=R===1?v.readString():R===2?v.readFloat():R===3?v.readDouble():R===4?v.readVarint64():R===5?v.readVarint():R===6?v.readSVarint():R===7?v.readBoolean():null}if(S==null)throw new Error("unknown feature value");return S})(h))}class tF{constructor(l,h){this.layers=l.readFields(Rie,{},h)}}function Rie(p,l,h){if(p===3){const v=new Pie(h,h.readVarint()+h.pos);v.length&&(l[v.name]=v)}}const pC=Math.pow(2,13);function V_(p,l,h,v,S,k,R,B){p.emplaceBack(l,h,2*Math.floor(v*pC)+R,S*pC*2,k*pC*2,Math.round(B))}class gC{constructor(l){this.zoom=l.zoom,this.overscaling=l.overscaling,this.layers=l.layers,this.layerIds=this.layers.map((h=>h.id)),this.index=l.index,this.hasDependencies=!1,this.layoutVertexArray=new xt,this.centroidVertexArray=new ht,this.indexArray=new xr,this.programConfigurations=new Hd(l.layers,l.zoom),this.segments=new gn,this.stateDependentLayerIds=this.layers.filter((h=>h.isStateDependent())).map((h=>h.id))}populate(l,h,v){this.features=[],this.hasDependencies=g2("fill-extrusion",this.layers,h);for(const{feature:S,id:k,index:R,sourceLayerIndex:B}of l){const V=this.layers[0]._featureFilter.needGeometry,Z=Jh(S,V);if(!this.layers[0]._featureFilter.filter(new ki(this.zoom),Z,v))continue;const ie={id:k,sourceLayerIndex:B,index:R,geometry:V?Z.geometry:Kh(S),properties:S.properties,type:S.type,patterns:{}};this.hasDependencies?this.features.push(cC("fill-extrusion",this.layers,ie,{zoom:this.zoom},h)):this.addFeature(ie,ie.geometry,R,v,{},h.subdivisionGranularity),h.featureIndex.insert(S,ie.geometry,R,B,this.index,!0)}}addFeatures(l,h,v){for(const S of this.features){const{geometry:k}=S;this.addFeature(S,k,S.index,h,v,l.subdivisionGranularity)}}update(l,h,v){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(l,h,this.stateDependentLayers,{imagePositions:v})}isEmpty(){return this.layoutVertexArray.length===0&&this.centroidVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(l){this.uploaded||(this.layoutVertexBuffer=l.createVertexBuffer(this.layoutVertexArray,Cie),this.centroidVertexBuffer=l.createVertexBuffer(this.centroidVertexArray,Tie.members,!0),this.indexBuffer=l.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(l),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.centroidVertexBuffer.destroy())}addFeature(l,h,v,S,k,R){for(const B of Vl(h,500)){const V={x:0,y:0,sampleCount:0},Z=this.layoutVertexArray.length;this.processPolygon(V,S,l,B,R);const ie=this.layoutVertexArray.length-Z,ce=Math.floor(V.x/V.sampleCount),ve=Math.floor(V.y/V.sampleCount);for(let Ee=0;Ee<ie;Ee++)this.centroidVertexArray.emplaceBack(ce,ve)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,l,v,{imagePositions:k,canonical:S})}processPolygon(l,h,v,S,k){if(S.length<1||rF(S[0]))return;for(const ce of S)ce.length!==0&&Mie(l,ce);const R={segment:this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray)},B=k.fill.getGranularityForZoomLevel(h.z),V=U_.types[v.type]==="Polygon";for(const ce of S){if(ce.length===0||rF(ce))continue;const ve=rm(ce,B,V);this._generateSideFaces(ve,R)}if(!V)return;const Z=Z6(S,h,B,!1),ie=this.layoutVertexArray;K6(((ce,ve)=>{V_(ie,ce,ve,0,0,1,1,0)}),this.segments,this.layoutVertexArray,this.indexArray,Z.verticesFlattened,Z.indicesTriangles)}_generateSideFaces(l,h){let v=0;for(let S=1;S<l.length;S++){const k=l[S],R=l[S-1];if(Die(k,R))continue;h.segment.vertexLength+4>gn.MAX_VERTEX_ARRAY_LENGTH&&(h.segment=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));const B=k.sub(R)._perp()._unit(),V=R.dist(k);v+V>32768&&(v=0),V_(this.layoutVertexArray,k.x,k.y,B.x,B.y,0,0,v),V_(this.layoutVertexArray,k.x,k.y,B.x,B.y,0,1,v),v+=V,V_(this.layoutVertexArray,R.x,R.y,B.x,B.y,0,0,v),V_(this.layoutVertexArray,R.x,R.y,B.x,B.y,0,1,v);const Z=h.segment.vertexLength;this.indexArray.emplaceBack(Z,Z+2,Z+1),this.indexArray.emplaceBack(Z+1,Z+2,Z+3),h.segment.vertexLength+=4,h.segment.primitiveLength+=2}}}function Mie(p,l){for(let h=0;h<l.length;h++){const v=l[h];h===l.length-1&&l[0].x===v.x&&l[0].y===v.y||(p.x+=v.x,p.y+=v.y,p.sampleCount++)}}function Die(p,l){return p.x===l.x&&(p.x<0||p.x>Te)||p.y===l.y&&(p.y<0||p.y>Te)}function rF(p){return p.every((l=>l.x<0))||p.every((l=>l.x>Te))||p.every((l=>l.y<0))||p.every((l=>l.y>Te))}let nF;Pt("FillExtrusionBucket",gC,{omit:["layers","features"]});var Oie={get paint(){return nF=nF||new $a({"fill-extrusion-opacity":new Tn(Mt["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new Sn(Mt["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new Tn(Mt["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new Tn(Mt["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new Rs(Mt["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new Sn(Mt["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new Sn(Mt["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new Tn(Mt["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})}};class Nie extends eo{constructor(l,h){super(l,Oie,h)}createBucket(l){return new gC(l)}queryRadius(){return d2(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}queryIntersectsFeature({queryGeometry:l,feature:h,featureState:v,geometry:S,transform:k,pixelsToTileUnits:R,pixelPosMatrix:B}){const V=p2(l,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),-k.bearingInRadians,R),Z=this.paint.get("fill-extrusion-height").evaluate(h,v),ie=this.paint.get("fill-extrusion-base").evaluate(h,v),ce=(function(Ee,Ne){const ze=[];for(const Ve of Ee){const et=[Ve.x,Ve.y,0,1];se(et,et,Ne),ze.push(new c(et[0]/et[3],et[1]/et[3]))}return ze})(V,B),ve=(function(Ee,Ne,ze,Ve){const et=[],Ct=[],rt=Ve[8]*Ne,ut=Ve[9]*Ne,Rt=Ve[10]*Ne,Bt=Ve[11]*Ne,dr=Ve[8]*ze,Or=Ve[9]*ze,Pr=Ve[10]*ze,Vr=Ve[11]*ze;for(const pn of Ee){const Wr=[],Rr=[];for(const Tr of pn){const Cn=Tr.x,xn=Tr.y,kn=Ve[0]*Cn+Ve[4]*xn+Ve[12],vn=Ve[1]*Cn+Ve[5]*xn+Ve[13],Gn=Ve[2]*Cn+Ve[6]*xn+Ve[14],la=Ve[3]*Cn+Ve[7]*xn+Ve[15],Hi=Gn+Rt,Po=la+Bt,Ql=kn+dr,Ms=vn+Or,ko=Gn+Pr,vo=la+Vr,Ta=new c((kn+rt)/Po,(vn+ut)/Po);Ta.z=Hi/Po,Wr.push(Ta);const Yo=new c(Ql/vo,Ms/vo);Yo.z=ko/vo,Rr.push(Yo)}et.push(Wr),Ct.push(Rr)}return[et,Ct]})(S,ie,Z,B);return(function(Ee,Ne,ze){let Ve=1/0;R6(ze,Ne)&&(Ve=iF(ze,Ne[0]));for(let et=0;et<Ne.length;et++){const Ct=Ne[et],rt=Ee[et];for(let ut=0;ut<Ct.length-1;ut++){const Rt=Ct[ut],Bt=[Rt,Ct[ut+1],rt[ut+1],rt[ut],Rt];qy(ze,Bt)&&(Ve=Math.min(Ve,iF(ze,Bt)))}}return Ve!==1/0&&Ve})(ve[0],ve[1],ce)}}function $_(p,l){return p.x*l.x+p.y*l.y}function iF(p,l){if(p.length===1){let h=0;const v=l[h++];let S;for(;!S||v.equals(S);)if(S=l[h++],!S)return 1/0;for(;h<l.length;h++){const k=l[h],R=p[0],B=S.sub(v),V=k.sub(v),Z=R.sub(v),ie=$_(B,B),ce=$_(B,V),ve=$_(V,V),Ee=$_(Z,B),Ne=$_(Z,V),ze=ie*ve-ce*ce,Ve=(ve*Ee-ce*Ne)/ze,et=(ie*Ne-ce*Ee)/ze,Ct=v.z*(1-Ve-et)+S.z*Ve+k.z*et;if(isFinite(Ct))return Ct}return 1/0}{let h=1/0;for(const v of l)h=Math.min(h,v.z);return h}}const Lie=pa([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4),{members:Fie}=Lie,Bie=pa([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]),{members:zie}=Bie,jie=Math.cos(Math.PI/180*37.5),aF=Math.pow(2,14)/.5;class mC{constructor(l){this.zoom=l.zoom,this.overscaling=l.overscaling,this.layers=l.layers,this.layerIds=this.layers.map((h=>h.id)),this.index=l.index,this.hasDependencies=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach((h=>{this.gradients[h.id]={}})),this.layoutVertexArray=new Nt,this.layoutVertexArray2=new wt,this.indexArray=new xr,this.programConfigurations=new Hd(l.layers,l.zoom),this.segments=new gn,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter((h=>h.isStateDependent())).map((h=>h.id))}populate(l,h,v){this.hasDependencies=g2("line",this.layers,h)||this.hasLineDasharray(this.layers);const S=this.layers[0].layout.get("line-sort-key"),k=!S.isConstant(),R=[];for(const{feature:B,id:V,index:Z,sourceLayerIndex:ie}of l){const ce=this.layers[0]._featureFilter.needGeometry,ve=Jh(B,ce);if(!this.layers[0]._featureFilter.filter(new ki(this.zoom),ve,v))continue;const Ee=k?S.evaluate(ve,{},v):void 0,Ne={id:V,properties:B.properties,type:B.type,sourceLayerIndex:ie,index:Z,geometry:ce?ve.geometry:Kh(B),patterns:{},dashes:{},sortKey:Ee};R.push(Ne)}k&&R.sort(((B,V)=>B.sortKey-V.sortKey));for(const B of R){const{geometry:V,index:Z,sourceLayerIndex:ie}=B;this.hasDependencies?(g2("line",this.layers,h)?cC("line",this.layers,B,{zoom:this.zoom},h):this.hasLineDasharray(this.layers)&&this.addLineDashDependencies(this.layers,B,this.zoom,h),this.patternFeatures.push(B)):this.addFeature(B,V,Z,v,{},{},h.subdivisionGranularity),h.featureIndex.insert(l[Z].feature,V,Z,ie,this.index)}}update(l,h,v,S){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(l,h,this.stateDependentLayers,{imagePositions:v,dashPositions:S})}addFeatures(l,h,v,S){for(const k of this.patternFeatures)this.addFeature(k,k.geometry,k.index,h,v,S,l.subdivisionGranularity)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(l){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=l.createVertexBuffer(this.layoutVertexArray2,zie)),this.layoutVertexBuffer=l.createVertexBuffer(this.layoutVertexArray,Fie),this.indexBuffer=l.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(l),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(l){if(l.properties&&Object.prototype.hasOwnProperty.call(l.properties,"mapbox_clip_start")&&Object.prototype.hasOwnProperty.call(l.properties,"mapbox_clip_end"))return{start:+l.properties.mapbox_clip_start,end:+l.properties.mapbox_clip_end}}addFeature(l,h,v,S,k,R,B){const V=this.layers[0].layout,Z=V.get("line-join").evaluate(l,{}),ie=V.get("line-cap"),ce=V.get("line-miter-limit"),ve=V.get("line-round-limit");this.lineClips=this.lineFeatureClips(l);for(const Ee of h)this.addLine(Ee,l,Z,ie,ce,ve,S,B);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,l,v,{imagePositions:k,dashPositions:R,canonical:S})}addLine(l,h,v,S,k,R,B,V){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,l=rm(l,B?V.line.getGranularityForZoomLevel(B.z):1),this.lineClips){this.lineClipsArray.push(this.lineClips);for(let rt=0;rt<l.length-1;rt++)this.totalDistance+=l[rt].dist(l[rt+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const Z=U_.types[h.type]==="Polygon";let ie=l.length;for(;ie>=2&&l[ie-1].equals(l[ie-2]);)ie--;let ce=0;for(;ce<ie-1&&l[ce].equals(l[ce+1]);)ce++;if(ie<(Z?3:2))return;v==="bevel"&&(k=1.05);const ve=this.overscaling<=16?122880/(512*this.overscaling):0,Ee=this.segments.prepareSegment(10*ie,this.layoutVertexArray,this.indexArray);let Ne,ze,Ve,et,Ct;this.e1=this.e2=-1,Z&&(Ne=l[ie-2],Ct=l[ce].sub(Ne)._unit()._perp());for(let rt=ce;rt<ie;rt++){if(Ve=rt===ie-1?Z?l[ce+1]:void 0:l[rt+1],Ve&&l[rt].equals(Ve))continue;Ct&&(et=Ct),Ne&&(ze=Ne),Ne=l[rt],Ct=Ve?Ve.sub(Ne)._unit()._perp():et,et=et||Ct;let ut=et.add(Ct);ut.x===0&&ut.y===0||ut._unit();const Rt=et.x*Ct.x+et.y*Ct.y,Bt=ut.x*Ct.x+ut.y*Ct.y,dr=Bt!==0?1/Bt:1/0,Or=2*Math.sqrt(2-2*Bt),Pr=Bt<jie&&ze&&Ve,Vr=et.x*Ct.y-et.y*Ct.x>0;if(Pr&&rt>ce){const Rr=Ne.dist(ze);if(Rr>2*ve){const Tr=Ne.sub(Ne.sub(ze)._mult(ve/Rr)._round());this.updateDistance(ze,Tr),this.addCurrentVertex(Tr,et,0,0,Ee),ze=Tr}}const pn=ze&&Ve;let Wr=pn?v:Z?"butt":S;if(pn&&Wr==="round"&&(dr<R?Wr="miter":dr<=2&&(Wr="fakeround")),Wr==="miter"&&dr>k&&(Wr="bevel"),Wr==="bevel"&&(dr>2&&(Wr="flipbevel"),dr<k&&(Wr="miter")),ze&&this.updateDistance(ze,Ne),Wr==="miter")ut._mult(dr),this.addCurrentVertex(Ne,ut,0,0,Ee);else if(Wr==="flipbevel"){if(dr>100)ut=Ct.mult(-1);else{const Rr=dr*et.add(Ct).mag()/et.sub(Ct).mag();ut._perp()._mult(Rr*(Vr?-1:1))}this.addCurrentVertex(Ne,ut,0,0,Ee),this.addCurrentVertex(Ne,ut.mult(-1),0,0,Ee)}else if(Wr==="bevel"||Wr==="fakeround"){const Rr=-Math.sqrt(dr*dr-1),Tr=Vr?Rr:0,Cn=Vr?0:Rr;if(ze&&this.addCurrentVertex(Ne,et,Tr,Cn,Ee),Wr==="fakeround"){const xn=Math.round(180*Or/Math.PI/20);for(let kn=1;kn<xn;kn++){let vn=kn/xn;if(vn!==.5){const la=vn-.5;vn+=vn*la*(vn-1)*((1.0904+Rt*(Rt*(3.55645-1.43519*Rt)-3.2452))*la*la+(.848013+Rt*(.215638*Rt-1.06021)))}const Gn=Ct.sub(et)._mult(vn)._add(et)._unit()._mult(Vr?-1:1);this.addHalfVertex(Ne,Gn.x,Gn.y,!1,Vr,0,Ee)}}Ve&&this.addCurrentVertex(Ne,Ct,-Tr,-Cn,Ee)}else if(Wr==="butt")this.addCurrentVertex(Ne,ut,0,0,Ee);else if(Wr==="square"){const Rr=ze?1:-1;this.addCurrentVertex(Ne,ut,Rr,Rr,Ee)}else Wr==="round"&&(ze&&(this.addCurrentVertex(Ne,et,0,0,Ee),this.addCurrentVertex(Ne,et,1,1,Ee,!0)),Ve&&(this.addCurrentVertex(Ne,Ct,-1,-1,Ee,!0),this.addCurrentVertex(Ne,Ct,0,0,Ee)));if(Pr&&rt<ie-1){const Rr=Ne.dist(Ve);if(Rr>2*ve){const Tr=Ne.add(Ve.sub(Ne)._mult(ve/Rr)._round());this.updateDistance(Ne,Tr),this.addCurrentVertex(Tr,Ct,0,0,Ee),Ne=Tr}}}}addCurrentVertex(l,h,v,S,k,R=!1){const B=h.y*S-h.x,V=-h.y-h.x*S;this.addHalfVertex(l,h.x+h.y*v,h.y-h.x*v,R,!1,v,k),this.addHalfVertex(l,B,V,R,!0,-S,k),this.distance>aF/2&&this.totalDistance===0&&(this.distance=0,this.updateScaledDistance(),this.addCurrentVertex(l,h,v,S,k,R))}addHalfVertex({x:l,y:h},v,S,k,R,B,V){const Z=.5*(this.lineClips?this.scaledDistance*(aF-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((l<<1)+(k?1:0),(h<<1)+(R?1:0),Math.round(63*v)+128,Math.round(63*S)+128,1+(B===0?0:B<0?-1:1)|(63&Z)<<2,Z>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);const ie=V.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,ie,this.e2),V.primitiveLength++),R?this.e2=ie:this.e1=ie}updateScaledDistance(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance}updateDistance(l,h){this.distance+=l.dist(h),this.updateScaledDistance()}hasLineDasharray(l){for(const h of l){const v=h.paint.get("line-dasharray");if(v&&!v.isConstant())return!0}return!1}addLineDashDependencies(l,h,v,S){for(const k of l){const R=k.paint.get("line-dasharray");if(!R||R.value.kind==="constant")continue;const B=k.layout.get("line-cap")==="round",V={dasharray:R.value.evaluate({zoom:v-1},h,{}),round:B},Z={dasharray:R.value.evaluate({zoom:v},h,{}),round:B},ie={dasharray:R.value.evaluate({zoom:v+1},h,{}),round:B},ce=`${V.dasharray.join(",")},${V.round}`,ve=`${Z.dasharray.join(",")},${Z.round}`,Ee=`${ie.dasharray.join(",")},${ie.round}`;S.dashDependencies[ce]=V,S.dashDependencies[ve]=Z,S.dashDependencies[Ee]=ie,h.dashes[k.id]={min:ce,mid:ve,max:Ee}}}}let oF,sF;Pt("LineBucket",mC,{omit:["layers","patternFeatures"]});var lF={get paint(){return sF=sF||new $a({"line-opacity":new Sn(Mt.paint_line["line-opacity"]),"line-color":new Sn(Mt.paint_line["line-color"]),"line-translate":new Tn(Mt.paint_line["line-translate"]),"line-translate-anchor":new Tn(Mt.paint_line["line-translate-anchor"]),"line-width":new Sn(Mt.paint_line["line-width"]),"line-gap-width":new Sn(Mt.paint_line["line-gap-width"]),"line-offset":new Sn(Mt.paint_line["line-offset"]),"line-blur":new Sn(Mt.paint_line["line-blur"]),"line-dasharray":new Rs(Mt.paint_line["line-dasharray"]),"line-pattern":new Rs(Mt.paint_line["line-pattern"]),"line-gradient":new Lo(Mt.paint_line["line-gradient"])})},get layout(){return oF=oF||new $a({"line-cap":new Tn(Mt.layout_line["line-cap"]),"line-join":new Sn(Mt.layout_line["line-join"]),"line-miter-limit":new Tn(Mt.layout_line["line-miter-limit"]),"line-round-limit":new Tn(Mt.layout_line["line-round-limit"]),"line-sort-key":new Sn(Mt.layout_line["line-sort-key"])})}};class Uie extends Sn{possiblyEvaluate(l,h){return h=new ki(Math.floor(h.zoom),{now:h.now,fadeDuration:h.fadeDuration,zoomHistory:h.zoomHistory,transition:h.transition}),super.possiblyEvaluate(l,h)}evaluate(l,h,v,S){return h=Be({},h,{zoom:Math.floor(h.zoom)}),super.evaluate(l,h,v,S)}}let _2;class Vie extends eo{constructor(l,h){super(l,lF,h),this.gradientVersion=0,_2||(_2=new Uie(lF.paint.properties["line-width"].specification),_2.useIntegerZoom=!0)}_handleSpecialPaintPropertyUpdate(l){if(l==="line-gradient"){const h=this.gradientExpression();this.stepInterpolant=!!(function(v){return v._styleExpression!==void 0})(h)&&h._styleExpression.expression instanceof zt,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(l,h){super.recalculate(l,h),this.paint._values["line-floorwidth"]=_2.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,l)}createBucket(l){return new mC(l)}queryRadius(l){const h=l,v=uF(Gy("line-width",this,h),Gy("line-gap-width",this,h)),S=Gy("line-offset",this,h);return v/2+Math.abs(S)+d2(this.paint.get("line-translate"))}queryIntersectsFeature({queryGeometry:l,feature:h,featureState:v,geometry:S,transform:k,pixelsToTileUnits:R}){const B=p2(l,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),-k.bearingInRadians,R),V=R/2*uF(this.paint.get("line-width").evaluate(h,v),this.paint.get("line-gap-width").evaluate(h,v)),Z=this.paint.get("line-offset").evaluate(h,v);return Z&&(S=(function(ie,ce){const ve=[];for(let Ee=0;Ee<ie.length;Ee++){const Ne=Zne(ie[Ee]),ze=[];for(let Ve=0;Ve<Ne.length;Ve++){const et=Ne[Ve],Ct=Ne[Ve-1],rt=Ne[Ve+1],ut=Ve===0?new c(0,0):et.sub(Ct)._unit()._perp(),Rt=Ve===Ne.length-1?new c(0,0):rt.sub(et)._unit()._perp(),Bt=ut._add(Rt)._unit(),dr=Bt.x*Rt.x+Bt.y*Rt.y;dr!==0&&Bt._mult(1/dr),ze.push(Bt._mult(ce)._add(et))}ve.push(ze)}return ve})(S,Z*R)),(function(ie,ce,ve){for(let Ee=0;Ee<ce.length;Ee++){const Ne=ce[Ee];if(ie.length>=3){for(let ze=0;ze<Ne.length;ze++)if(Hy(ie,Ne[ze]))return!0}if(Wne(ie,Ne,ve))return!0}return!1})(B,S,V)}isTileClipped(){return!0}}function uF(p,l){return l>0?l+2*p:p}const $ie=pa([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),qie=pa([{name:"a_projected_pos",components:3,type:"Float32"}],4);pa([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const Hie=pa([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"},{name:"a_box_real",components:2,type:"Int16"}]);pa([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const cF=pa([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),Gie=pa([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function Wie(p,l,h){return p.sections.forEach((v=>{v.text=(function(S,k,R){const B=k.layout.get("text-transform").evaluate(R,{});return B==="uppercase"?S=S.toLocaleUpperCase():B==="lowercase"&&(S=S.toLocaleLowerCase()),da.applyArabicShaping&&(S=da.applyArabicShaping(S)),S})(v.text,l,h)})),p}pa([{name:"triangle",components:3,type:"Uint16"}]),pa([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),pa([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Uint16",name:"textAnchorOffsetStartIndex"},{type:"Uint16",name:"textAnchorOffsetEndIndex"}]),pa([{type:"Float32",name:"offsetX"}]),pa([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]),pa([{type:"Uint16",name:"textAnchor"},{type:"Float32",components:2,name:"textOffset"}]);var gl=24;const q_={"!":"","#":"",$:"","%":"","&":"","(":"",")":"","*":"","+":"",",":"","-":"",".":"","/":"",":":"",";":"","<":"","=":"",">":"","?":"","@":"","[":"","\\":"","]":"","^":"",_:"","`":"","{":"","|":"","}":"","~":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":""},Xie={10:!0,32:!0,38:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0},Yie={40:!0};function fF(p,l,h,v,S,k){if("fontStack"in l){const R=h[l.fontStack],B=R&&R[p];return B?B.metrics.advance*l.scale+S:0}{const R=v[l.imageName];return R?R.displaySize[0]*l.scale*gl/k+S:0}}function hF(p,l,h,v){const S=Math.pow(p-l,2);return v?p<l?S/2:2*S:S+Math.abs(h)*h}function Zie(p,l,h){let v=0;return p===10&&(v-=1e4),h&&(v+=150),p!==40&&p!==65288||(v+=50),l!==41&&l!==65289||(v+=50),v}function dF(p,l,h,v,S,k){let R=null,B=hF(l,h,S,k);for(const V of v){const Z=hF(l-V.x,h,S,k)+V.badness;Z<=B&&(R=V,B=Z)}return{index:p,x:l,priorBreak:R,badness:B}}function pF(p){return p?pF(p.priorBreak).concat(p.index):[]}class Zy{constructor(l="",h=[],v=[]){this.text=l,this.sections=h,this.sectionIndex=v,this.imageSectionID=null}static fromFeature(l,h){const v=new Zy;for(let S=0;S<l.sections.length;S++){const k=l.sections[S];k.image?v.addImageSection(k):v.addTextSection(k,h)}return v}length(){return[...this.text].length}getSection(l){return this.sections[this.sectionIndex[l]]}getSectionIndex(l){return this.sectionIndex[l]}verticalizePunctuation(){this.text=(function(l){let h="",v={premature:!0,value:void 0};const S=l[Symbol.iterator]();let k=S.next();const R=l[Symbol.iterator]();R.next();let B=R.next();for(;!k.done;)h+=!B.done&&Yn(B.value.codePointAt(0))&&!q_[B.value]||!v.premature&&Yn(v.value.codePointAt(0))&&!q_[v.value]||!q_[k.value]?k.value:q_[k.value],v={value:k.value,premature:!1},k=S.next(),B=R.next();return h})(this.text)}hasZeroWidthSpaces(){return this.text.includes("")}trim(){const l=this.text.match(/^\s*/),h=l?l[0].length:0,v=this.text.match(/\S\s*$/),S=v?v[0].length-1:0;this.text=this.text.substring(h,this.text.length-S),this.sectionIndex=this.sectionIndex.slice(h,this.sectionIndex.length-S)}substring(l,h){const v=[...this.text].slice(l,h).join(""),S=this.sectionIndex.slice(l,h);return new Zy(v,this.sections,S)}toCodeUnitIndex(l){return[...this.text].slice(0,l).join("").length}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce(((l,h)=>Math.max(l,this.sections[h].scale)),0)}getMaxImageSize(l){let h=0,v=0;for(let S=0;S<this.length();S++){const k=this.getSection(S);if("imageName"in k){const R=l[k.imageName];if(!R)continue;const B=R.displaySize;h=Math.max(h,B[0]),v=Math.max(v,B[1])}}return{maxImageWidth:h,maxImageHeight:v}}addTextSection(l,h){this.text+=l.text,this.sections.push({scale:l.scale||1,verticalAlign:l.verticalAlign||"bottom",fontStack:l.fontStack||h});const v=this.sections.length-1;this.sectionIndex.push(...[...l.text].map((()=>v)))}addImageSection(l){const h=l.image?l.image.name:"";if(h.length===0)return void at("Can't add FormattedSection with an empty image.");const v=this.getNextImageSectionCharCode();v?(this.text+=String.fromCharCode(v),this.sections.push({scale:1,verticalAlign:l.verticalAlign||"bottom",imageName:h}),this.sectionIndex.push(this.sections.length-1)):at("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}determineLineBreaks(l,h,v,S,k){const R=[],B=this.determineAverageLineWidth(l,h,v,S,k),V=this.hasZeroWidthSpaces();let Z=0,ie=0;const ce=this.text[Symbol.iterator]();let ve=ce.next();const Ee=this.text[Symbol.iterator]();Ee.next();let Ne=Ee.next();const ze=this.text[Symbol.iterator]();ze.next(),ze.next();let Ve=ze.next();for(;!ve.done;){const et=this.getSection(ie),Ct=ve.value.codePointAt(0);if(Vn(Ct)||(Z+=fF(Ct,et,v,S,l,k)),!Ne.done){const rt=Jr(Ct),ut=Ne.value.codePointAt(0);(Xie[Ct]||rt||"imageName"in et||!Ve.done&&Yie[ut])&&R.push(dF(ie+1,Z,B,R,Zie(Ct,ut,rt&&V),!1))}ie++,ve=ce.next(),Ne=Ee.next(),Ve=ze.next()}return pF(dF(this.length(),Z,B,R,0,!0))}determineAverageLineWidth(l,h,v,S,k){let R=0,B=0;for(const V of this.text){const Z=this.getSection(B);R+=fF(V.codePointAt(0),Z,v,S,l,k),B++}return R/Math.max(1,Math.ceil(R/h))}}const yC=4294967296,gF=1/yC,mF=typeof TextDecoder>"u"?null:new TextDecoder("utf-8");class b2{constructor(l=new Uint8Array(16)){this.buf=ArrayBuffer.isView(l)?l:new Uint8Array(l),this.dataView=new DataView(this.buf.buffer),this.pos=0,this.type=0,this.length=this.buf.length}readFields(l,h,v=this.length){for(;this.pos<v;){const S=this.readVarint(),k=S>>3,R=this.pos;this.type=7&S,l(k,h,this),this.pos===R&&this.skip(S)}return h}readMessage(l,h){return this.readFields(l,h,this.readVarint()+this.pos)}readFixed32(){const l=this.dataView.getUint32(this.pos,!0);return this.pos+=4,l}readSFixed32(){const l=this.dataView.getInt32(this.pos,!0);return this.pos+=4,l}readFixed64(){const l=this.dataView.getUint32(this.pos,!0)+this.dataView.getUint32(this.pos+4,!0)*yC;return this.pos+=8,l}readSFixed64(){const l=this.dataView.getUint32(this.pos,!0)+this.dataView.getInt32(this.pos+4,!0)*yC;return this.pos+=8,l}readFloat(){const l=this.dataView.getFloat32(this.pos,!0);return this.pos+=4,l}readDouble(){const l=this.dataView.getFloat64(this.pos,!0);return this.pos+=8,l}readVarint(l){const h=this.buf;let v,S;return S=h[this.pos++],v=127&S,S<128?v:(S=h[this.pos++],v|=(127&S)<<7,S<128?v:(S=h[this.pos++],v|=(127&S)<<14,S<128?v:(S=h[this.pos++],v|=(127&S)<<21,S<128?v:(S=h[this.pos],v|=(15&S)<<28,(function(k,R,B){const V=B.buf;let Z,ie;if(ie=V[B.pos++],Z=(112&ie)>>4,ie<128||(ie=V[B.pos++],Z|=(127&ie)<<3,ie<128)||(ie=V[B.pos++],Z|=(127&ie)<<10,ie<128)||(ie=V[B.pos++],Z|=(127&ie)<<17,ie<128)||(ie=V[B.pos++],Z|=(127&ie)<<24,ie<128)||(ie=V[B.pos++],Z|=(1&ie)<<31,ie<128))return Ky(k,Z,R);throw new Error("Expected varint not more than 10 bytes")})(v,l,this)))))}readVarint64(){return this.readVarint(!0)}readSVarint(){const l=this.readVarint();return l%2==1?(l+1)/-2:l/2}readBoolean(){return!!this.readVarint()}readString(){const l=this.readVarint()+this.pos,h=this.pos;return this.pos=l,l-h>=12&&mF?mF.decode(this.buf.subarray(h,l)):(function(v,S,k){let R="",B=S;for(;B<k;){const V=v[B];let Z,ie,ce,ve=null,Ee=V>239?4:V>223?3:V>191?2:1;if(B+Ee>k)break;Ee===1?V<128&&(ve=V):Ee===2?(Z=v[B+1],(192&Z)==128&&(ve=(31&V)<<6|63&Z,ve<=127&&(ve=null))):Ee===3?(Z=v[B+1],ie=v[B+2],(192&Z)==128&&(192&ie)==128&&(ve=(15&V)<<12|(63&Z)<<6|63&ie,(ve<=2047||ve>=55296&&ve<=57343)&&(ve=null))):Ee===4&&(Z=v[B+1],ie=v[B+2],ce=v[B+3],(192&Z)==128&&(192&ie)==128&&(192&ce)==128&&(ve=(15&V)<<18|(63&Z)<<12|(63&ie)<<6|63&ce,(ve<=65535||ve>=1114112)&&(ve=null))),ve===null?(ve=65533,Ee=1):ve>65535&&(ve-=65536,R+=String.fromCharCode(ve>>>10&1023|55296),ve=56320|1023&ve),R+=String.fromCharCode(ve),B+=Ee}return R})(this.buf,h,l)}readBytes(){const l=this.readVarint()+this.pos,h=this.buf.subarray(this.pos,l);return this.pos=l,h}readPackedVarint(l=[],h){const v=this.readPackedEnd();for(;this.pos<v;)l.push(this.readVarint(h));return l}readPackedSVarint(l=[]){const h=this.readPackedEnd();for(;this.pos<h;)l.push(this.readSVarint());return l}readPackedBoolean(l=[]){const h=this.readPackedEnd();for(;this.pos<h;)l.push(this.readBoolean());return l}readPackedFloat(l=[]){const h=this.readPackedEnd();for(;this.pos<h;)l.push(this.readFloat());return l}readPackedDouble(l=[]){const h=this.readPackedEnd();for(;this.pos<h;)l.push(this.readDouble());return l}readPackedFixed32(l=[]){const h=this.readPackedEnd();for(;this.pos<h;)l.push(this.readFixed32());return l}readPackedSFixed32(l=[]){const h=this.readPackedEnd();for(;this.pos<h;)l.push(this.readSFixed32());return l}readPackedFixed64(l=[]){const h=this.readPackedEnd();for(;this.pos<h;)l.push(this.readFixed64());return l}readPackedSFixed64(l=[]){const h=this.readPackedEnd();for(;this.pos<h;)l.push(this.readSFixed64());return l}readPackedEnd(){return this.type===2?this.readVarint()+this.pos:this.pos+1}skip(l){const h=7&l;if(h===0)for(;this.buf[this.pos++]>127;);else if(h===2)this.pos=this.readVarint()+this.pos;else if(h===5)this.pos+=4;else{if(h!==1)throw new Error(`Unimplemented type: ${h}`);this.pos+=8}}writeTag(l,h){this.writeVarint(l<<3|h)}realloc(l){let h=this.length||16;for(;h<this.pos+l;)h*=2;if(h!==this.length){const v=new Uint8Array(h);v.set(this.buf),this.buf=v,this.dataView=new DataView(v.buffer),this.length=h}}finish(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)}writeFixed32(l){this.realloc(4),this.dataView.setInt32(this.pos,l,!0),this.pos+=4}writeSFixed32(l){this.realloc(4),this.dataView.setInt32(this.pos,l,!0),this.pos+=4}writeFixed64(l){this.realloc(8),this.dataView.setInt32(this.pos,-1&l,!0),this.dataView.setInt32(this.pos+4,Math.floor(l*gF),!0),this.pos+=8}writeSFixed64(l){this.realloc(8),this.dataView.setInt32(this.pos,-1&l,!0),this.dataView.setInt32(this.pos+4,Math.floor(l*gF),!0),this.pos+=8}writeVarint(l){(l=+l||0)>268435455||l<0?(function(h,v){let S,k;if(h>=0?(S=h%4294967296|0,k=h/4294967296|0):(S=~(-h%4294967296),k=~(-h/4294967296),4294967295^S?S=S+1|0:(S=0,k=k+1|0)),h>=18446744073709552e3||h<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");v.realloc(10),(function(R,B,V){V.buf[V.pos++]=127&R|128,R>>>=7,V.buf[V.pos++]=127&R|128,R>>>=7,V.buf[V.pos++]=127&R|128,R>>>=7,V.buf[V.pos++]=127&R|128,V.buf[V.pos]=127&(R>>>=7)})(S,0,v),(function(R,B){const V=(7&R)<<4;B.buf[B.pos++]|=V|((R>>>=3)?128:0),R&&(B.buf[B.pos++]=127&R|((R>>>=7)?128:0),R&&(B.buf[B.pos++]=127&R|((R>>>=7)?128:0),R&&(B.buf[B.pos++]=127&R|((R>>>=7)?128:0),R&&(B.buf[B.pos++]=127&R|((R>>>=7)?128:0),R&&(B.buf[B.pos++]=127&R)))))})(k,v)})(l,this):(this.realloc(4),this.buf[this.pos++]=127&l|(l>127?128:0),l<=127||(this.buf[this.pos++]=127&(l>>>=7)|(l>127?128:0),l<=127||(this.buf[this.pos++]=127&(l>>>=7)|(l>127?128:0),l<=127||(this.buf[this.pos++]=l>>>7&127))))}writeSVarint(l){this.writeVarint(l<0?2*-l-1:2*l)}writeBoolean(l){this.writeVarint(+l)}writeString(l){l=String(l),this.realloc(4*l.length),this.pos++;const h=this.pos;this.pos=(function(S,k,R){for(let B,V,Z=0;Z<k.length;Z++){if(B=k.charCodeAt(Z),B>55295&&B<57344){if(!V){B>56319||Z+1===k.length?(S[R++]=239,S[R++]=191,S[R++]=189):V=B;continue}if(B<56320){S[R++]=239,S[R++]=191,S[R++]=189,V=B;continue}B=V-55296<<10|B-56320|65536,V=null}else V&&(S[R++]=239,S[R++]=191,S[R++]=189,V=null);B<128?S[R++]=B:(B<2048?S[R++]=B>>6|192:(B<65536?S[R++]=B>>12|224:(S[R++]=B>>18|240,S[R++]=B>>12&63|128),S[R++]=B>>6&63|128),S[R++]=63&B|128)}return R})(this.buf,l,this.pos);const v=this.pos-h;v>=128&&yF(h,v,this),this.pos=h-1,this.writeVarint(v),this.pos+=v}writeFloat(l){this.realloc(4),this.dataView.setFloat32(this.pos,l,!0),this.pos+=4}writeDouble(l){this.realloc(8),this.dataView.setFloat64(this.pos,l,!0),this.pos+=8}writeBytes(l){const h=l.length;this.writeVarint(h),this.realloc(h);for(let v=0;v<h;v++)this.buf[this.pos++]=l[v]}writeRawMessage(l,h){this.pos++;const v=this.pos;l(h,this);const S=this.pos-v;S>=128&&yF(v,S,this),this.pos=v-1,this.writeVarint(S),this.pos+=S}writeMessage(l,h,v){this.writeTag(l,2),this.writeRawMessage(h,v)}writePackedVarint(l,h){h.length&&this.writeMessage(l,Kie,h)}writePackedSVarint(l,h){h.length&&this.writeMessage(l,Jie,h)}writePackedBoolean(l,h){h.length&&this.writeMessage(l,tae,h)}writePackedFloat(l,h){h.length&&this.writeMessage(l,Qie,h)}writePackedDouble(l,h){h.length&&this.writeMessage(l,eae,h)}writePackedFixed32(l,h){h.length&&this.writeMessage(l,rae,h)}writePackedSFixed32(l,h){h.length&&this.writeMessage(l,nae,h)}writePackedFixed64(l,h){h.length&&this.writeMessage(l,iae,h)}writePackedSFixed64(l,h){h.length&&this.writeMessage(l,aae,h)}writeBytesField(l,h){this.writeTag(l,2),this.writeBytes(h)}writeFixed32Field(l,h){this.writeTag(l,5),this.writeFixed32(h)}writeSFixed32Field(l,h){this.writeTag(l,5),this.writeSFixed32(h)}writeFixed64Field(l,h){this.writeTag(l,1),this.writeFixed64(h)}writeSFixed64Field(l,h){this.writeTag(l,1),this.writeSFixed64(h)}writeVarintField(l,h){this.writeTag(l,0),this.writeVarint(h)}writeSVarintField(l,h){this.writeTag(l,0),this.writeSVarint(h)}writeStringField(l,h){this.writeTag(l,2),this.writeString(h)}writeFloatField(l,h){this.writeTag(l,5),this.writeFloat(h)}writeDoubleField(l,h){this.writeTag(l,1),this.writeDouble(h)}writeBooleanField(l,h){this.writeVarintField(l,+h)}}function Ky(p,l,h){return h?4294967296*l+(p>>>0):4294967296*(l>>>0)+(p>>>0)}function yF(p,l,h){const v=l<=16383?1:l<=2097151?2:l<=268435455?3:Math.floor(Math.log(l)/(7*Math.LN2));h.realloc(v);for(let S=h.pos-1;S>=p;S--)h.buf[S+v]=h.buf[S]}function Kie(p,l){for(let h=0;h<p.length;h++)l.writeVarint(p[h])}function Jie(p,l){for(let h=0;h<p.length;h++)l.writeSVarint(p[h])}function Qie(p,l){for(let h=0;h<p.length;h++)l.writeFloat(p[h])}function eae(p,l){for(let h=0;h<p.length;h++)l.writeDouble(p[h])}function tae(p,l){for(let h=0;h<p.length;h++)l.writeBoolean(p[h])}function rae(p,l){for(let h=0;h<p.length;h++)l.writeFixed32(p[h])}function nae(p,l){for(let h=0;h<p.length;h++)l.writeSFixed32(p[h])}function iae(p,l){for(let h=0;h<p.length;h++)l.writeFixed64(p[h])}function aae(p,l){for(let h=0;h<p.length;h++)l.writeSFixed64(p[h])}function oae(p,l,h){p===1&&h.readMessage(sae,l)}function sae(p,l,h){if(p===3){const{id:v,bitmap:S,width:k,height:R,left:B,top:V,advance:Z}=h.readMessage(lae,{});l.push({id:v,bitmap:new O_({width:k+6,height:R+6},S),metrics:{width:k,height:R,left:B,top:V,advance:Z}})}}function lae(p,l,h){p===1?l.id=h.readVarint():p===2?l.bitmap=h.readBytes():p===3?l.width=h.readVarint():p===4?l.height=h.readVarint():p===5?l.left=h.readSVarint():p===6?l.top=h.readSVarint():p===7&&(l.advance=h.readVarint())}function vF(p){let l=0,h=0;for(const R of p)l+=R.w*R.h,h=Math.max(h,R.w);p.sort(((R,B)=>B.h-R.h));const v=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(l/.95)),h),h:1/0}];let S=0,k=0;for(const R of p)for(let B=v.length-1;B>=0;B--){const V=v[B];if(!(R.w>V.w||R.h>V.h)){if(R.x=V.x,R.y=V.y,k=Math.max(k,R.y+R.h),S=Math.max(S,R.x+R.w),R.w===V.w&&R.h===V.h){const Z=v.pop();Z&&B<v.length&&(v[B]=Z)}else R.h===V.h?(V.x+=R.w,V.w-=R.w):R.w===V.w?(V.y+=R.h,V.h-=R.h):(v.push({x:V.x+R.w,y:V.y,w:V.w-R.w,h:R.h}),V.y+=R.h,V.h-=R.h);break}}return{w:S,h:k,fill:l/(S*k)||0}}class vC{constructor(l,{pixelRatio:h,version:v,stretchX:S,stretchY:k,content:R,textFitWidth:B,textFitHeight:V}){this.paddedRect=l,this.pixelRatio=h,this.stretchX=S,this.stretchY=k,this.content=R,this.version=v,this.textFitWidth=B,this.textFitHeight=V}get tl(){return[this.paddedRect.x+1,this.paddedRect.y+1]}get br(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]}get tlbr(){return this.tl.concat(this.br)}get displaySize(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]}}class _F{constructor(l,h){const v={},S={};this.haveRenderCallbacks=[];const k=[];this.addImages(l,v,k),this.addImages(h,S,k);const{w:R,h:B}=vF(k),V=new lc({width:R||1,height:B||1});for(const Z in l){const ie=l[Z],ce=v[Z].paddedRect;lc.copy(ie.data,V,{x:0,y:0},{x:ce.x+1,y:ce.y+1},ie.data)}for(const Z in h){const ie=h[Z],ce=S[Z].paddedRect,ve=ce.x+1,Ee=ce.y+1,Ne=ie.data.width,ze=ie.data.height;lc.copy(ie.data,V,{x:0,y:0},{x:ve,y:Ee},ie.data),lc.copy(ie.data,V,{x:0,y:ze-1},{x:ve,y:Ee-1},{width:Ne,height:1}),lc.copy(ie.data,V,{x:0,y:0},{x:ve,y:Ee+ze},{width:Ne,height:1}),lc.copy(ie.data,V,{x:Ne-1,y:0},{x:ve-1,y:Ee},{width:1,height:ze}),lc.copy(ie.data,V,{x:0,y:0},{x:ve+Ne,y:Ee},{width:1,height:ze})}this.image=V,this.iconPositions=v,this.patternPositions=S}addImages(l,h,v){for(const S in l){const k=l[S],R={x:0,y:0,w:k.data.width+2,h:k.data.height+2};v.push(R),h[S]=new vC(R,k),k.hasRenderCallback&&this.haveRenderCallbacks.push(S)}}patchUpdatedImages(l,h){l.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const v in l.updatedImages)this.patchUpdatedImage(this.iconPositions[v],l.getImage(v),h),this.patchUpdatedImage(this.patternPositions[v],l.getImage(v),h)}patchUpdatedImage(l,h,v){if(!l||!h||l.version===h.version)return;l.version=h.version;const[S,k]=l.tl;v.update(h.data,void 0,{x:S,y:k})}}var Hp;function x2(p,l,h,v,S,k,R,B,V,Z,ie,ce,ve,Ee,Ne){const ze=Zy.fromFeature(p,S);let Ve;ce===s.az.vertical&&ze.verticalizePunctuation();let et=ze.determineLineBreaks(Z,k,l,v,Ee);const{processBidirectionalText:Ct,processStyledBidirectionalText:rt}=da;if(Ct&&ze.sections.length===1){Ve=[],et=et.map((dr=>ze.toCodeUnitIndex(dr)));const Bt=Ct(ze.toString(),et);for(const dr of Bt){const Or=[...dr].map((()=>0));Ve.push(new Zy(dr,ze.sections,Or))}}else if(rt){Ve=[],et=et.map((Pr=>ze.toCodeUnitIndex(Pr)));let Bt=0;const dr=[];for(const Pr of ze.text)dr.push(...Array(Pr.length).fill(ze.sectionIndex[Bt])),Bt++;const Or=rt(ze.text,dr,et);for(const Pr of Or){const Vr=[];let pn="";for(const Wr of Pr[0])Vr.push(Pr[1][pn.length]),pn+=Wr;Ve.push(new Zy(Pr[0],ze.sections,Vr))}}else Ve=(function(Bt,dr){const Or=[];let Pr=0;for(const Vr of dr)Or.push(Bt.substring(Pr,Vr)),Pr=Vr;return Pr<Bt.length()&&Or.push(Bt.substring(Pr,Bt.length())),Or})(ze,et);const ut=[],Rt={positionedLines:ut,text:ze.toString(),top:ie[1],bottom:ie[1],left:ie[0],right:ie[0],writingMode:ce,iconsInText:!1,verticalizable:!1};return(function(Bt,dr,Or,Pr,Vr,pn,Wr,Rr,Tr,Cn,xn,kn){let vn=0,Gn=0,la=0,Hi=0;const Po=Rr==="right"?1:Rr==="left"?0:.5,Ql=gl/kn;let Ms=0;for(const Ta of Vr){Ta.trim();const Yo=Ta.getMaxScale(),os={positionedGlyphs:[],lineOffset:0};Bt.positionedLines[Ms]=os;const uo=os.positionedGlyphs;let uc=0;if(!Ta.length()){Gn+=pn,++Ms;continue}const eu=uae(Pr,Ta,Ql);let cc=0;for(const vl of Ta.text){const Fo=Ta.getSection(cc),Ds=vl.codePointAt(0),Zo=cae(Tr,xn,Ds),_l={glyph:Ds,imageName:null,x:vn,y:Gn+-17,vertical:Zo,scale:1,fontStack:"",sectionIndex:Ta.getSectionIndex(cc),metrics:null,rect:null};let Xd;if("fontStack"in Fo){if(Xd=fae(Fo,Ds,Zo,eu,dr,Or),!Xd)continue;_l.fontStack=Fo.fontStack}else{if(Bt.iconsInText=!0,Fo.scale*=Ql,Xd=hae(Fo,Zo,Yo,eu,Pr),!Xd)continue;uc=Math.max(uc,Xd.imageOffset),_l.imageName=Fo.imageName}const{rect:fh,metrics:K_,baselineOffset:Zp}=Xd;_l.y+=Zp,_l.scale=Fo.scale,_l.metrics=K_,_l.rect=fh,uo.push(_l),Zo?(Bt.verticalizable=!0,vn+=("imageName"in Fo?K_.advance:gl)*Fo.scale+Cn):vn+=K_.advance*Fo.scale+Cn,cc++}uo.length!==0&&(la=Math.max(vn-Cn,la),dae(uo,0,uo.length-1,Po)),vn=0,os.lineOffset=Math.max(uc,(Yo-1)*gl);const Pf=pn*Yo+uc;Gn+=Pf,Hi=Math.max(Pf,Hi),++Ms}const{horizontalAlign:ko,verticalAlign:vo}=_C(Wr);(function(Ta,Yo,os,uo,uc,eu,cc,Pf,vl){const Fo=(Yo-os)*uc;let Ds=0;Ds=eu!==cc?-Pf*uo- -17:-uo*vl*cc+.5*cc;for(const Zo of Ta)for(const _l of Zo.positionedGlyphs)_l.x+=Fo,_l.y+=Ds})(Bt.positionedLines,Po,ko,vo,la,Hi,pn,Gn,Vr.length),Bt.top+=-vo*Gn,Bt.bottom=Bt.top+Gn,Bt.left+=-ko*la,Bt.right=Bt.left+la})(Rt,l,h,v,Ve,R,B,V,ce,Z,ve,Ne),!(function(Bt){for(const dr of Bt)if(dr.positionedGlyphs.length!==0)return!1;return!0})(ut)&&Rt}function _C(p){let l=.5,h=.5;switch(p){case"right":case"top-right":case"bottom-right":l=1;break;case"left":case"top-left":case"bottom-left":l=0}switch(p){case"bottom":case"bottom-right":case"bottom-left":h=1;break;case"top":case"top-right":case"top-left":h=0}return{horizontalAlign:l,verticalAlign:h}}function uae(p,l,h){const v=l.getMaxScale()*gl,{maxImageWidth:S,maxImageHeight:k}=l.getMaxImageSize(p),R=Math.max(v,k*h);return{verticalLineContentWidth:Math.max(v,S*h),horizontalLineContentHeight:R}}function bF(p){switch(p){case"top":return 0;case"center":return .5;default:return 1}}function cae(p,l,h){return!(p===s.az.horizontal||!l&&!Jn(h)||l&&(Vn(h)||(v=h,new RegExp("\\p{sc=Arab}","u").test(String.fromCodePoint(v)))));var v}function fae(p,l,h,v,S,k){const R=k[p.fontStack],B=(function(Z,ie,ce,ve){if(Z&&Z.rect)return Z;const Ee=ie[ce.fontStack],Ne=Ee&&Ee[ve];return Ne?{rect:null,metrics:Ne.metrics}:null})(R&&R[l],S,p,l);if(B===null)return null;let V;if(h)V=v.verticalLineContentWidth-p.scale*gl;else{const Z=bF(p.verticalAlign);V=(v.horizontalLineContentHeight-p.scale*gl)*Z}return{rect:B.rect,metrics:B.metrics,baselineOffset:V}}function hae(p,l,h,v,S){const k=S[p.imageName];if(!k)return null;const R=k.paddedRect,B=k.displaySize,V={width:B[0],height:B[1],left:1,top:-3,advance:l?B[1]:B[0]};let Z;if(l)Z=v.verticalLineContentWidth-B[1]*p.scale;else{const ie=bF(p.verticalAlign);Z=(v.horizontalLineContentHeight-B[1]*p.scale)*ie}return{rect:R,metrics:V,baselineOffset:Z,imageOffset:(l?B[0]:B[1])*p.scale-gl*h}}function dae(p,l,h,v){if(v===0)return;const S=p[h],k=(p[h].x+S.metrics.advance*S.scale)*v;for(let R=l;R<=h;R++)p[R].x-=k}function pae(p,l,h){const{horizontalAlign:v,verticalAlign:S}=_C(h),k=l[0]-p.displaySize[0]*v,R=l[1]-p.displaySize[1]*S;return{image:p,top:R,bottom:R+p.displaySize[1],left:k,right:k+p.displaySize[0]}}function xF(p){var l,h;let v=p.left,S=p.top,k=p.right-v,R=p.bottom-S;const B=(l=p.image.textFitWidth)!==null&&l!==void 0?l:"stretchOrShrink",V=(h=p.image.textFitHeight)!==null&&h!==void 0?h:"stretchOrShrink",Z=(p.image.content[2]-p.image.content[0])/(p.image.content[3]-p.image.content[1]);if(V==="proportional"){if(B==="stretchOnly"&&k/R<Z||B==="proportional"){const ie=Math.ceil(R*Z);v*=ie/k,k=ie}}else if(B==="proportional"&&V==="stretchOnly"&&Z!==0&&k/R>Z){const ie=Math.ceil(k/Z);S*=ie/R,R=ie}return{x1:v,y1:S,x2:v+k,y2:S+R}}function wF(p,l,h,v,S,k){const R=p.image;let B;if(R.content){const Ve=R.content,et=R.pixelRatio||1;B=[Ve[0]/et,Ve[1]/et,R.displaySize[0]-Ve[2]/et,R.displaySize[1]-Ve[3]/et]}const V=l.left*k,Z=l.right*k;let ie,ce,ve,Ee;h==="width"||h==="both"?(Ee=S[0]+V-v[3],ce=S[0]+Z+v[1]):(Ee=S[0]+(V+Z-R.displaySize[0])/2,ce=Ee+R.displaySize[0]);const Ne=l.top*k,ze=l.bottom*k;return h==="height"||h==="both"?(ie=S[1]+Ne-v[0],ve=S[1]+ze+v[2]):(ie=S[1]+(Ne+ze-R.displaySize[1])/2,ve=ie+R.displaySize[1]),{image:R,top:ie,right:ce,bottom:ve,left:Ee,collisionPadding:B}}Pt("ImagePosition",vC),Pt("ImageAtlas",_F),s.az=void 0,(Hp=s.az||(s.az={}))[Hp.none=0]="none",Hp[Hp.horizontal=1]="horizontal",Hp[Hp.vertical=2]="vertical",Hp[Hp.horizontalOnly=3]="horizontalOnly";const Gd=128,Gp=32640;function SF(p,l){const{expression:h}=l;if(h.kind==="constant")return{kind:"constant",layoutSize:h.evaluate(new ki(p+1))};if(h.kind==="source")return{kind:"source"};{const{zoomStops:v,interpolationType:S}=h;let k=0;for(;k<v.length&&v[k]<=p;)k++;k=Math.max(0,k-1);let R=k;for(;R<v.length&&v[R]<p+1;)R++;R=Math.min(v.length-1,R);const B=v[k],V=v[R];return h.kind==="composite"?{kind:"composite",minZoom:B,maxZoom:V,interpolationType:S}:{kind:"camera",minZoom:B,maxZoom:V,minSize:h.evaluate(new ki(B)),maxSize:h.evaluate(new ki(V)),interpolationType:S}}}function bC(p,l,h){let v="never";const S=p.get(l);return S?v=S:p.get(h)&&(v="always"),v}const gae=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function w2(p,l,h,v,S,k,R,B,V,Z,ie,ce,ve){const Ee=B?Math.min(Gp,Math.round(B[0])):0,Ne=B?Math.min(Gp,Math.round(B[1])):0;p.emplaceBack(l,h,Math.round(32*v),Math.round(32*S),k,R,(Ee<<1)+(V?1:0),Ne,16*Z,16*ie,256*ce,256*ve)}function xC(p,l,h){p.emplaceBack(l.x,l.y,h),p.emplaceBack(l.x,l.y,h),p.emplaceBack(l.x,l.y,h),p.emplaceBack(l.x,l.y,h)}function mae(p){for(const l of p.sections)if(aa(l.text))return!0;return!1}class wC{constructor(l){this.layoutVertexArray=new Dt,this.indexArray=new xr,this.programConfigurations=l,this.segments=new gn,this.dynamicLayoutVertexArray=new Zt,this.opacityVertexArray=new Sr,this.hasVisibleVertices=!1,this.placedSymbolArray=new z}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(l,h,v,S){this.isEmpty()||(v&&(this.layoutVertexBuffer=l.createVertexBuffer(this.layoutVertexArray,$ie.members),this.indexBuffer=l.createIndexBuffer(this.indexArray,h),this.dynamicLayoutVertexBuffer=l.createVertexBuffer(this.dynamicLayoutVertexArray,qie.members,!0),this.opacityVertexBuffer=l.createVertexBuffer(this.opacityVertexArray,gae,!0),this.opacityVertexBuffer.itemSize=1),(v||S)&&this.programConfigurations.upload(l))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}}Pt("SymbolBuffers",wC);class SC{constructor(l,h,v){this.layoutVertexArray=new l,this.layoutAttributes=h,this.indexArray=new v,this.segments=new gn,this.collisionVertexArray=new _r}upload(l){this.layoutVertexBuffer=l.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=l.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=l.createVertexBuffer(this.collisionVertexArray,Hie.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())}}Pt("CollisionBuffers",SC);class Jy{constructor(l){this.collisionBoxArray=l.collisionBoxArray,this.zoom=l.zoom,this.overscaling=l.overscaling,this.layers=l.layers,this.layerIds=this.layers.map((R=>R.id)),this.index=l.index,this.pixelRatio=l.pixelRatio,this.sourceLayerIndex=l.sourceLayerIndex,this.hasDependencies=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[];const h=this.layers[0]._unevaluatedLayout._values;this.textSizeData=SF(this.zoom,h["text-size"]),this.iconSizeData=SF(this.zoom,h["icon-size"]);const v=this.layers[0].layout,S=v.get("symbol-sort-key"),k=v.get("symbol-z-order");this.canOverlap=bC(v,"text-overlap","text-allow-overlap")!=="never"||bC(v,"icon-overlap","icon-allow-overlap")!=="never"||v.get("text-ignore-placement")||v.get("icon-ignore-placement"),this.sortFeaturesByKey=k!=="viewport-y"&&!S.isConstant(),this.sortFeaturesByY=(k==="viewport-y"||k==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,v.get("symbol-placement")==="point"&&(this.writingModes=v.get("text-writing-mode").map((R=>s.az[R]))),this.stateDependentLayerIds=this.layers.filter((R=>R.isStateDependent())).map((R=>R.id)),this.sourceID=l.sourceID}createArrays(){this.text=new wC(new Hd(this.layers,this.zoom,(l=>/^text/.test(l)))),this.icon=new wC(new Hd(this.layers,this.zoom,(l=>/^icon/.test(l)))),this.glyphOffsetArray=new le,this.lineVertexArray=new he,this.symbolInstances=new re,this.textAnchorOffsets=new Ae}calculateGlyphDependencies(l,h,v,S,k){for(const R of l)if(h[R.codePointAt(0)]=!0,(v||S)&&k){const B=q_[R];B&&(h[B.codePointAt(0)]=!0)}}populate(l,h,v){const S=this.layers[0],k=S.layout,R=k.get("text-font"),B=k.get("text-field"),V=k.get("icon-image"),Z=(B.value.kind!=="constant"||B.value.value instanceof _n&&!B.value.value.isEmpty()||B.value.value.toString().length>0)&&(R.value.kind!=="constant"||R.value.value.length>0),ie=V.value.kind!=="constant"||!!V.value.value||Object.keys(V.parameters).length>0,ce=k.get("symbol-sort-key");if(this.features=[],!Z&&!ie)return;const ve=h.iconDependencies,Ee=h.glyphDependencies,Ne=h.availableImages,ze=new ki(this.zoom);for(const{feature:Ve,id:et,index:Ct,sourceLayerIndex:rt}of l){const ut=S._featureFilter.needGeometry,Rt=Jh(Ve,ut);if(!S._featureFilter.filter(ze,Rt,v))continue;let Bt,dr;if(ut||(Rt.geometry=Kh(Ve)),Z){const Pr=S.getValueAndResolveTokens("text-field",Rt,v,Ne),Vr=_n.factory(Pr),pn=this.hasRTLText=this.hasRTLText||mae(Vr);(!pn||da.getRTLTextPluginStatus()==="unavailable"||pn&&da.isParsed())&&(Bt=Wie(Vr,S,Rt))}if(ie){const Pr=S.getValueAndResolveTokens("icon-image",Rt,v,Ne);dr=Pr instanceof wi?Pr:wi.fromString(Pr)}if(!Bt&&!dr)continue;const Or=this.sortFeaturesByKey?ce.evaluate(Rt,{},v):void 0;if(this.features.push({id:et,text:Bt,icon:dr,index:Ct,sourceLayerIndex:rt,geometry:Rt.geometry,properties:Ve.properties,type:U_.types[Ve.type],sortKey:Or}),dr&&(ve[dr.name]=!0),Bt){const Pr=R.evaluate(Rt,{},v).join(","),Vr=k.get("text-rotation-alignment")!=="viewport"&&k.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(s.az.vertical)>=0;for(const pn of Bt.sections)if(pn.image)ve[pn.image.name]=!0;else{const Wr=Ai(Bt.toString()),Rr=pn.fontStack||Pr,Tr=Ee[Rr]=Ee[Rr]||{};this.calculateGlyphDependencies(pn.text,Tr,Vr,this.allowVerticalPlacement,Wr)}}}k.get("symbol-placement")==="line"&&(this.features=(function(Ve){const et={},Ct={},rt=[];let ut=0;function Rt(Pr){rt.push(Ve[Pr]),ut++}function Bt(Pr,Vr,pn){const Wr=Ct[Pr];return delete Ct[Pr],Ct[Vr]=Wr,rt[Wr].geometry[0].pop(),rt[Wr].geometry[0]=rt[Wr].geometry[0].concat(pn[0]),Wr}function dr(Pr,Vr,pn){const Wr=et[Vr];return delete et[Vr],et[Pr]=Wr,rt[Wr].geometry[0].shift(),rt[Wr].geometry[0]=pn[0].concat(rt[Wr].geometry[0]),Wr}function Or(Pr,Vr,pn){const Wr=pn?Vr[0][Vr[0].length-1]:Vr[0][0];return`${Pr}:${Wr.x}:${Wr.y}`}for(let Pr=0;Pr<Ve.length;Pr++){const Vr=Ve[Pr],pn=Vr.geometry,Wr=Vr.text?Vr.text.toString():null;if(!Wr){Rt(Pr);continue}const Rr=Or(Wr,pn),Tr=Or(Wr,pn,!0);if(Rr in Ct&&Tr in et&&Ct[Rr]!==et[Tr]){const Cn=dr(Rr,Tr,pn),xn=Bt(Rr,Tr,rt[Cn].geometry);delete et[Rr],delete Ct[Tr],Ct[Or(Wr,rt[xn].geometry,!0)]=xn,rt[Cn].geometry=null}else Rr in Ct?Bt(Rr,Tr,pn):Tr in et?dr(Rr,Tr,pn):(Rt(Pr),et[Rr]=ut-1,Ct[Tr]=ut-1)}return rt.filter((Pr=>Pr.geometry))})(this.features)),this.sortFeaturesByKey&&this.features.sort(((Ve,et)=>Ve.sortKey-et.sortKey))}update(l,h,v){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(l,h,this.layers,{imagePositions:v}),this.icon.programConfigurations.updatePaintArrays(l,h,this.layers,{imagePositions:v}))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(l){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(l),this.iconCollisionBox.upload(l)),this.text.upload(l,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(l,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(l,h){const v=this.lineVertexArray.length;if(l.segment!==void 0){let S=l.dist(h[l.segment+1]),k=l.dist(h[l.segment]);const R={};for(let B=l.segment+1;B<h.length;B++)R[B]={x:h[B].x,y:h[B].y,tileUnitDistanceFromAnchor:S},B<h.length-1&&(S+=h[B+1].dist(h[B]));for(let B=l.segment||0;B>=0;B--)R[B]={x:h[B].x,y:h[B].y,tileUnitDistanceFromAnchor:k},B>0&&(k+=h[B-1].dist(h[B]));for(let B=0;B<h.length;B++){const V=R[B];this.lineVertexArray.emplaceBack(V.x,V.y,V.tileUnitDistanceFromAnchor)}}return{lineStartIndex:v,lineLength:this.lineVertexArray.length-v}}addSymbols(l,h,v,S,k,R,B,V,Z,ie,ce,ve){const Ee=l.indexArray,Ne=l.layoutVertexArray,ze=l.segments.prepareSegment(4*h.length,Ne,Ee,this.canOverlap?R.sortKey:void 0),Ve=this.glyphOffsetArray.length,et=ze.vertexLength,Ct=this.allowVerticalPlacement&&B===s.az.vertical?Math.PI/2:0,rt=R.text&&R.text.sections;for(let ut=0;ut<h.length;ut++){const{tl:Rt,tr:Bt,bl:dr,br:Or,tex:Pr,pixelOffsetTL:Vr,pixelOffsetBR:pn,minFontScaleX:Wr,minFontScaleY:Rr,glyphOffset:Tr,isSDF:Cn,sectionIndex:xn}=h[ut],kn=ze.vertexLength,vn=Tr[1];w2(Ne,V.x,V.y,Rt.x,vn+Rt.y,Pr.x,Pr.y,v,Cn,Vr.x,Vr.y,Wr,Rr),w2(Ne,V.x,V.y,Bt.x,vn+Bt.y,Pr.x+Pr.w,Pr.y,v,Cn,pn.x,Vr.y,Wr,Rr),w2(Ne,V.x,V.y,dr.x,vn+dr.y,Pr.x,Pr.y+Pr.h,v,Cn,Vr.x,pn.y,Wr,Rr),w2(Ne,V.x,V.y,Or.x,vn+Or.y,Pr.x+Pr.w,Pr.y+Pr.h,v,Cn,pn.x,pn.y,Wr,Rr),xC(l.dynamicLayoutVertexArray,V,Ct),Ee.emplaceBack(kn,kn+2,kn+1),Ee.emplaceBack(kn+1,kn+2,kn+3),ze.vertexLength+=4,ze.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(Tr[0]),ut!==h.length-1&&xn===h[ut+1].sectionIndex||l.programConfigurations.populatePaintArrays(Ne.length,R,R.index,{imagePositions:{},canonical:ve,formattedSection:rt&&rt[xn]})}l.placedSymbolArray.emplaceBack(V.x,V.y,Ve,this.glyphOffsetArray.length-Ve,et,Z,ie,V.segment,v?v[0]:0,v?v[1]:0,S[0],S[1],B,0,!1,0,ce)}_addCollisionDebugVertex(l,h,v,S,k,R){return h.emplaceBack(0,0),l.emplaceBack(v.x,v.y,S,k,Math.round(R.x),Math.round(R.y))}addCollisionDebugVertices(l,h,v,S,k,R,B){const V=k.segments.prepareSegment(4,k.layoutVertexArray,k.indexArray),Z=V.vertexLength,ie=k.layoutVertexArray,ce=k.collisionVertexArray,ve=B.anchorX,Ee=B.anchorY;this._addCollisionDebugVertex(ie,ce,R,ve,Ee,new c(l,h)),this._addCollisionDebugVertex(ie,ce,R,ve,Ee,new c(v,h)),this._addCollisionDebugVertex(ie,ce,R,ve,Ee,new c(v,S)),this._addCollisionDebugVertex(ie,ce,R,ve,Ee,new c(l,S)),V.vertexLength+=4;const Ne=k.indexArray;Ne.emplaceBack(Z,Z+1),Ne.emplaceBack(Z+1,Z+2),Ne.emplaceBack(Z+2,Z+3),Ne.emplaceBack(Z+3,Z),V.primitiveLength+=4}addDebugCollisionBoxes(l,h,v,S){for(let k=l;k<h;k++){const R=this.collisionBoxArray.get(k);this.addCollisionDebugVertices(R.x1,R.y1,R.x2,R.y2,S?this.textCollisionBox:this.iconCollisionBox,R.anchorPoint,v)}}generateCollisionDebugBuffers(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new SC(pr,cF.members,an),this.iconCollisionBox=new SC(pr,cF.members,an);for(let l=0;l<this.symbolInstances.length;l++){const h=this.symbolInstances.get(l);this.addDebugCollisionBoxes(h.textBoxStartIndex,h.textBoxEndIndex,h,!0),this.addDebugCollisionBoxes(h.verticalTextBoxStartIndex,h.verticalTextBoxEndIndex,h,!0),this.addDebugCollisionBoxes(h.iconBoxStartIndex,h.iconBoxEndIndex,h,!1),this.addDebugCollisionBoxes(h.verticalIconBoxStartIndex,h.verticalIconBoxEndIndex,h,!1)}}_deserializeCollisionBoxesForSymbol(l,h,v,S,k,R,B,V,Z){const ie={};for(let ce=h;ce<v;ce++){const ve=l.get(ce);ie.textBox={x1:ve.x1,y1:ve.y1,x2:ve.x2,y2:ve.y2,anchorPointX:ve.anchorPointX,anchorPointY:ve.anchorPointY},ie.textFeatureIndex=ve.featureIndex;break}for(let ce=S;ce<k;ce++){const ve=l.get(ce);ie.verticalTextBox={x1:ve.x1,y1:ve.y1,x2:ve.x2,y2:ve.y2,anchorPointX:ve.anchorPointX,anchorPointY:ve.anchorPointY},ie.verticalTextFeatureIndex=ve.featureIndex;break}for(let ce=R;ce<B;ce++){const ve=l.get(ce);ie.iconBox={x1:ve.x1,y1:ve.y1,x2:ve.x2,y2:ve.y2,anchorPointX:ve.anchorPointX,anchorPointY:ve.anchorPointY},ie.iconFeatureIndex=ve.featureIndex;break}for(let ce=V;ce<Z;ce++){const ve=l.get(ce);ie.verticalIconBox={x1:ve.x1,y1:ve.y1,x2:ve.x2,y2:ve.y2,anchorPointX:ve.anchorPointX,anchorPointY:ve.anchorPointY},ie.verticalIconFeatureIndex=ve.featureIndex;break}return ie}deserializeCollisionBoxes(l){this.collisionArrays=[];for(let h=0;h<this.symbolInstances.length;h++){const v=this.symbolInstances.get(h);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(l,v.textBoxStartIndex,v.textBoxEndIndex,v.verticalTextBoxStartIndex,v.verticalTextBoxEndIndex,v.iconBoxStartIndex,v.iconBoxEndIndex,v.verticalIconBoxStartIndex,v.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(l,h){const v=l.placedSymbolArray.get(h),S=v.vertexStartIndex+4*v.numGlyphs;for(let k=v.vertexStartIndex;k<S;k+=4)l.indexArray.emplaceBack(k,k+2,k+1),l.indexArray.emplaceBack(k+1,k+2,k+3)}getSortedSymbolIndexes(l){if(this.sortedAngle===l&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const h=Math.sin(l),v=Math.cos(l),S=[],k=[],R=[];for(let B=0;B<this.symbolInstances.length;++B){R.push(B);const V=this.symbolInstances.get(B);S.push(0|Math.round(h*V.anchorX+v*V.anchorY)),k.push(V.featureIndex)}return R.sort(((B,V)=>S[B]-S[V]||k[V]-k[B])),R}addToSortKeyRanges(l,h){const v=this.sortKeyRanges[this.sortKeyRanges.length-1];v&&v.sortKey===h?v.symbolInstanceEnd=l+1:this.sortKeyRanges.push({sortKey:h,symbolInstanceStart:l,symbolInstanceEnd:l+1})}sortFeatures(l){if(this.sortFeaturesByY&&this.sortedAngle!==l&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(l),this.sortedAngle=l,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const h of this.symbolInstanceIndexes){const v=this.symbolInstances.get(h);this.featureSortOrder.push(v.featureIndex),[v.rightJustifiedTextSymbolIndex,v.centerJustifiedTextSymbolIndex,v.leftJustifiedTextSymbolIndex].forEach(((S,k,R)=>{S>=0&&R.indexOf(S)===k&&this.addIndicesForPlacedSymbol(this.text,S)})),v.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,v.verticalPlacedTextSymbolIndex),v.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,v.placedIconSymbolIndex),v.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,v.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}let EF,TF;Pt("SymbolBucket",Jy,{omit:["layers","collisionBoxArray","features","compareText"]}),Jy.MAX_GLYPHS=65535,Jy.addDynamicAttributes=xC;var EC={get paint(){return TF=TF||new $a({"icon-opacity":new Sn(Mt.paint_symbol["icon-opacity"]),"icon-color":new Sn(Mt.paint_symbol["icon-color"]),"icon-halo-color":new Sn(Mt.paint_symbol["icon-halo-color"]),"icon-halo-width":new Sn(Mt.paint_symbol["icon-halo-width"]),"icon-halo-blur":new Sn(Mt.paint_symbol["icon-halo-blur"]),"icon-translate":new Tn(Mt.paint_symbol["icon-translate"]),"icon-translate-anchor":new Tn(Mt.paint_symbol["icon-translate-anchor"]),"text-opacity":new Sn(Mt.paint_symbol["text-opacity"]),"text-color":new Sn(Mt.paint_symbol["text-color"],{runtimeType:ei,getOverride:p=>p.textColor,hasOverride:p=>!!p.textColor}),"text-halo-color":new Sn(Mt.paint_symbol["text-halo-color"]),"text-halo-width":new Sn(Mt.paint_symbol["text-halo-width"]),"text-halo-blur":new Sn(Mt.paint_symbol["text-halo-blur"]),"text-translate":new Tn(Mt.paint_symbol["text-translate"]),"text-translate-anchor":new Tn(Mt.paint_symbol["text-translate-anchor"])})},get layout(){return EF=EF||new $a({"symbol-placement":new Tn(Mt.layout_symbol["symbol-placement"]),"symbol-spacing":new Tn(Mt.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new Tn(Mt.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new Sn(Mt.layout_symbol["symbol-sort-key"]),"symbol-z-order":new Tn(Mt.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new Tn(Mt.layout_symbol["icon-allow-overlap"]),"icon-overlap":new Tn(Mt.layout_symbol["icon-overlap"]),"icon-ignore-placement":new Tn(Mt.layout_symbol["icon-ignore-placement"]),"icon-optional":new Tn(Mt.layout_symbol["icon-optional"]),"icon-rotation-alignment":new Tn(Mt.layout_symbol["icon-rotation-alignment"]),"icon-size":new Sn(Mt.layout_symbol["icon-size"]),"icon-text-fit":new Tn(Mt.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new Tn(Mt.layout_symbol["icon-text-fit-padding"]),"icon-image":new Sn(Mt.layout_symbol["icon-image"]),"icon-rotate":new Sn(Mt.layout_symbol["icon-rotate"]),"icon-padding":new Sn(Mt.layout_symbol["icon-padding"]),"icon-keep-upright":new Tn(Mt.layout_symbol["icon-keep-upright"]),"icon-offset":new Sn(Mt.layout_symbol["icon-offset"]),"icon-anchor":new Sn(Mt.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new Tn(Mt.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new Tn(Mt.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new Tn(Mt.layout_symbol["text-rotation-alignment"]),"text-field":new Sn(Mt.layout_symbol["text-field"]),"text-font":new Sn(Mt.layout_symbol["text-font"]),"text-size":new Sn(Mt.layout_symbol["text-size"]),"text-max-width":new Sn(Mt.layout_symbol["text-max-width"]),"text-line-height":new Tn(Mt.layout_symbol["text-line-height"]),"text-letter-spacing":new Sn(Mt.layout_symbol["text-letter-spacing"]),"text-justify":new Sn(Mt.layout_symbol["text-justify"]),"text-radial-offset":new Sn(Mt.layout_symbol["text-radial-offset"]),"text-variable-anchor":new Tn(Mt.layout_symbol["text-variable-anchor"]),"text-variable-anchor-offset":new Sn(Mt.layout_symbol["text-variable-anchor-offset"]),"text-anchor":new Sn(Mt.layout_symbol["text-anchor"]),"text-max-angle":new Tn(Mt.layout_symbol["text-max-angle"]),"text-writing-mode":new Tn(Mt.layout_symbol["text-writing-mode"]),"text-rotate":new Sn(Mt.layout_symbol["text-rotate"]),"text-padding":new Tn(Mt.layout_symbol["text-padding"]),"text-keep-upright":new Tn(Mt.layout_symbol["text-keep-upright"]),"text-transform":new Sn(Mt.layout_symbol["text-transform"]),"text-offset":new Sn(Mt.layout_symbol["text-offset"]),"text-allow-overlap":new Tn(Mt.layout_symbol["text-allow-overlap"]),"text-overlap":new Tn(Mt.layout_symbol["text-overlap"]),"text-ignore-placement":new Tn(Mt.layout_symbol["text-ignore-placement"]),"text-optional":new Tn(Mt.layout_symbol["text-optional"])})}};class CF{constructor(l){if(l.property.overrides===void 0)throw new Error("overrides must be provided to instantiate FormatSectionOverride class");this.type=l.property.overrides?l.property.overrides.runtimeType:Ci,this.defaultValue=l}evaluate(l){if(l.formattedSection){const h=this.defaultValue.property.overrides;if(h&&h.hasOverride(l.formattedSection))return h.getOverride(l.formattedSection)}return l.feature&&l.featureState?this.defaultValue.evaluate(l.feature,l.featureState):this.defaultValue.property.specification.default}eachChild(l){this.defaultValue.isConstant()||l(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}Pt("FormatSectionOverride",CF,{omit:["defaultValue"]});class S2 extends eo{constructor(l,h){super(l,EC,h)}recalculate(l,h){if(super.recalculate(l,h),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")==="map"?"map":"viewport"),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){const v=this.layout.get("text-writing-mode");if(v){const S=[];for(const k of v)S.indexOf(k)<0&&S.push(k);this.layout._values["text-writing-mode"]=S}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()}getValueAndResolveTokens(l,h,v,S){const k=this.layout.get(l).evaluate(h,{},v,S),R=this._unevaluatedLayout._values[l];return R.isDataDriven()||qc(R.value)||!k?k:(function(B,V){return V.replace(/{([^{}]+)}/g,((Z,ie)=>B&&ie in B?String(B[ie]):""))})(h.properties,k)}createBucket(l){return new Jy(l)}queryRadius(){return 0}queryIntersectsFeature(){throw new Error("Should take a different path in FeatureIndex")}_setPaintOverrides(){for(const l of EC.paint.overridableProperties){if(!S2.hasPaintOverride(this.layout,l))continue;const h=this.paint.get(l),v=new CF(h),S=new Od(v,h.property.specification);let k=null;k=h.value.kind==="constant"||h.value.kind==="source"?new Np("source",S):new Hg("composite",S,h.value.zoomStops),this.paint._values[l]=new qi(h.property,k,h.parameters)}}_handleOverridablePaintPropertyUpdate(l,h,v){return!(!this.layout||h.isDataDriven()||v.isDataDriven())&&S2.hasPaintOverride(this.layout,l)}static hasPaintOverride(l,h){const v=l.get("text-field"),S=EC.paint.properties[h];let k=!1;const R=B=>{for(const V of B)if(S.overrides&&S.overrides.hasOverride(V))return void(k=!0)};if(v.value.kind==="constant"&&v.value.value instanceof _n)R(v.value.value.sections);else if(v.value.kind==="source"||v.value.kind==="composite"){const B=Z=>{k||(Z instanceof oa&&Mi(Z.value)===Wi?R(Z.value.sections):Z instanceof Xs?R(Z.sections):Z.eachChild(B))},V=v.value;V._styleExpression&&B(V._styleExpression.expression)}return k}}let AF;var yae={get paint(){return AF=AF||new $a({"background-color":new Tn(Mt.paint_background["background-color"]),"background-pattern":new Sa(Mt.paint_background["background-pattern"]),"background-opacity":new Tn(Mt.paint_background["background-opacity"])})}};class vae extends eo{constructor(l,h){super(l,yae,h)}}class _ae extends eo{constructor(l,h){super(l,{},h),this.onAdd=v=>{this.implementation.onAdd&&this.implementation.onAdd(v,v.painter.context.gl)},this.onRemove=v=>{this.implementation.onRemove&&this.implementation.onRemove(v,v.painter.context.gl)},this.implementation=l}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){throw new Error("Custom layers cannot be serialized")}}class bae{constructor(l){this._methodToThrottle=l,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._methodToThrottle()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout((()=>{this._triggered=!1,this._methodToThrottle()}),0))}remove(){delete this._channel,this._methodToThrottle=()=>{}}}const xae={once:!0},TC=63710088e-1;class Wp{constructor(l,h){if(isNaN(l)||isNaN(h))throw new Error(`Invalid LngLat object: (${l}, ${h})`);if(this.lng=+l,this.lat=+h,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new Wp(Xe(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(l){const h=Math.PI/180,v=this.lat*h,S=l.lat*h,k=Math.sin(v)*Math.sin(S)+Math.cos(v)*Math.cos(S)*Math.cos((l.lng-this.lng)*h);return TC*Math.acos(Math.min(k,1))}static convert(l){if(l instanceof Wp)return l;if(Array.isArray(l)&&(l.length===2||l.length===3))return new Wp(Number(l[0]),Number(l[1]));if(!Array.isArray(l)&&typeof l=="object"&&l!==null)return new Wp(Number("lng"in l?l.lng:l.lon),Number(l.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}const IF=2*Math.PI*TC;function PF(p){return IF*Math.cos(p*Math.PI/180)}function kF(p){return(180+p)/360}function RF(p){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+p*Math.PI/360)))/360}function MF(p,l){return p/PF(l)}function DF(p){return 360*p-180}function E2(p){return 360/Math.PI*Math.atan(Math.exp((180-360*p)*Math.PI/180))-90}function OF(p,l){return p*PF(E2(l))}class H_{constructor(l,h,v=0){this.x=+l,this.y=+h,this.z=+v}static fromLngLat(l,h=0){const v=Wp.convert(l);return new H_(kF(v.lng),RF(v.lat),MF(h,v.lat))}toLngLat(){return new Wp(DF(this.x),E2(this.y))}toAltitude(){return OF(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/IF*(l=E2(this.y),1/Math.cos(l*Math.PI/180));var l}}function NF(p,l,h){var v=2*Math.PI*6378137/256/Math.pow(2,h);return[p*v-2*Math.PI*6378137/2,l*v-2*Math.PI*6378137/2]}class CC{constructor(l,h,v){if(!(function(S,k,R){return!(S<0||S>25||R<0||R>=Math.pow(2,S)||k<0||k>=Math.pow(2,S))})(l,h,v))throw new Error(`x=${h}, y=${v}, z=${l} outside of bounds. 0<=x<${Math.pow(2,l)}, 0<=y<${Math.pow(2,l)} 0<=z<=25 `);this.z=l,this.x=h,this.y=v,this.key=Qy(0,l,l,h,v)}equals(l){return this.z===l.z&&this.x===l.x&&this.y===l.y}url(l,h,v){const S=(function(R,B,V){var Z=NF(256*R,256*(B=Math.pow(2,V)-B-1),V),ie=NF(256*(R+1),256*(B+1),V);return Z[0]+","+Z[1]+","+ie[0]+","+ie[1]})(this.x,this.y,this.z),k=(function(R,B,V){let Z,ie="";for(let ce=R;ce>0;ce--)Z=1<<ce-1,ie+=(B&Z?1:0)+(V&Z?2:0);return ie})(this.z,this.x,this.y);return l[(this.x+this.y)%l.length].replace(/{prefix}/g,(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(v==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace(/{ratio}/g,h>1?"@2x":"").replace(/{quadkey}/g,k).replace(/{bbox-epsg-3857}/g,S)}isChildOf(l){const h=this.z-l.z;return h>0&&l.x===this.x>>h&&l.y===this.y>>h}getTilePoint(l){const h=Math.pow(2,this.z);return new c((l.x*h-this.x)*Te,(l.y*h-this.y)*Te)}toString(){return`${this.z}/${this.x}/${this.y}`}}class LF{constructor(l,h){this.wrap=l,this.canonical=h,this.key=Qy(l,h.z,h.z,h.x,h.y)}}class Zc{constructor(l,h,v,S,k){if(this.terrainRttPosMatrix32f=null,l<v)throw new Error(`overscaledZ should be >= z; overscaledZ = ${l}; z = ${v}`);this.overscaledZ=l,this.wrap=h,this.canonical=new CC(v,+S,+k),this.key=Qy(h,l,v,S,k)}clone(){return new Zc(this.overscaledZ,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)}equals(l){return this.overscaledZ===l.overscaledZ&&this.wrap===l.wrap&&this.canonical.equals(l.canonical)}scaledTo(l){if(l>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${l}; overscaledZ = ${this.overscaledZ}`);const h=this.canonical.z-l;return l>this.canonical.z?new Zc(l,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new Zc(l,this.wrap,l,this.canonical.x>>h,this.canonical.y>>h)}isOverscaled(){return this.overscaledZ>this.canonical.z}calculateScaledKey(l,h){if(l>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${l}; overscaledZ = ${this.overscaledZ}`);const v=this.canonical.z-l;return l>this.canonical.z?Qy(this.wrap*+h,l,this.canonical.z,this.canonical.x,this.canonical.y):Qy(this.wrap*+h,l,l,this.canonical.x>>v,this.canonical.y>>v)}isChildOf(l){if(l.wrap!==this.wrap||this.overscaledZ-l.overscaledZ<=0)return!1;if(l.overscaledZ===0)return this.overscaledZ>0;const h=this.canonical.z-l.canonical.z;return!(h<0)&&l.canonical.x===this.canonical.x>>h&&l.canonical.y===this.canonical.y>>h}children(l){if(this.overscaledZ>=l)return[new Zc(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const h=this.canonical.z+1,v=2*this.canonical.x,S=2*this.canonical.y;return[new Zc(h,this.wrap,h,v,S),new Zc(h,this.wrap,h,v+1,S),new Zc(h,this.wrap,h,v,S+1),new Zc(h,this.wrap,h,v+1,S+1)]}isLessThan(l){return this.wrap<l.wrap||!(this.wrap>l.wrap)&&(this.overscaledZ<l.overscaledZ||!(this.overscaledZ>l.overscaledZ)&&(this.canonical.x<l.canonical.x||!(this.canonical.x>l.canonical.x)&&this.canonical.y<l.canonical.y))}wrapped(){return new Zc(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(l){return new Zc(this.overscaledZ,l,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new LF(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}getTilePoint(l){return this.canonical.getTilePoint(new H_(l.x-this.wrap,l.y))}}function Qy(p,l,h,v,S){(p*=2)<0&&(p=-1*p-1);const k=1<<h;return(k*k*p+k*S+v).toString(36)+h.toString(36)+l.toString(36)}function AC(p,l){return l?p.properties[l]:p.id}function wae(p,l){const h={id:p.id};if(l.removeAllProperties&&(delete p.removeProperties,delete p.addOrUpdateProperties,delete l.removeProperties),l.removeProperties)for(const v of l.removeProperties){const S=p.addOrUpdateProperties.findIndex((k=>k.key===v));S>-1&&p.addOrUpdateProperties.splice(S,1)}return(p.removeAllProperties||l.removeAllProperties)&&(h.removeAllProperties=!0),(p.removeProperties||l.removeProperties)&&(h.removeProperties=[...p.removeProperties||[],...l.removeProperties||[]]),(p.addOrUpdateProperties||l.addOrUpdateProperties)&&(h.addOrUpdateProperties=[...p.addOrUpdateProperties||[],...l.addOrUpdateProperties||[]]),(p.newGeometry||l.newGeometry)&&(h.newGeometry=l.newGeometry||p.newGeometry),h}function FF(p){var l,h;if(!p)return{};const v={};return v.removeAll=p.removeAll,v.remove=new Set(p.remove||[]),v.add=new Map((l=p.add)===null||l===void 0?void 0:l.map((S=>[S.id,S]))),v.update=new Map((h=p.update)===null||h===void 0?void 0:h.map((S=>[S.id,S]))),v}Pt("CanonicalTileID",CC),Pt("OverscaledTileID",Zc,{omit:["terrainRttPosMatrix32f"]});class nm{constructor(){this.minX=1/0,this.maxX=-1/0,this.minY=1/0,this.maxY=-1/0}extend(l){return this.minX=Math.min(this.minX,l.x),this.minY=Math.min(this.minY,l.y),this.maxX=Math.max(this.maxX,l.x),this.maxY=Math.max(this.maxY,l.y),this}expandBy(l){return this.minX-=l,this.minY-=l,this.maxX+=l,this.maxY+=l,(this.minX>this.maxX||this.minY>this.maxY)&&(this.minX=1/0,this.maxX=-1/0,this.minY=1/0,this.maxY=-1/0),this}shrinkBy(l){return this.expandBy(-l)}map(l){const h=new nm;return h.extend(l(new c(this.minX,this.minY))),h.extend(l(new c(this.maxX,this.minY))),h.extend(l(new c(this.minX,this.maxY))),h.extend(l(new c(this.maxX,this.maxY))),h}static fromPoints(l){const h=new nm;for(const v of l)h.extend(v);return h}contains(l){return l.x>=this.minX&&l.x<=this.maxX&&l.y>=this.minY&&l.y<=this.maxY}empty(){return this.minX>this.maxX}width(){return this.maxX-this.minX}height(){return this.maxY-this.minY}covers(l){return!this.empty()&&!l.empty()&&l.minX>=this.minX&&l.maxX<=this.maxX&&l.minY>=this.minY&&l.maxY<=this.maxY}intersects(l){return!this.empty()&&!l.empty()&&l.minX<=this.maxX&&l.maxX>=this.minX&&l.minY<=this.maxY&&l.maxY>=this.minY}}class BF{constructor(l){this._stringToNumber={},this._numberToString=[];for(let h=0;h<l.length;h++){const v=l[h];this._stringToNumber[v]=h,this._numberToString[h]=v}}encode(l){return this._stringToNumber[l]}decode(l){if(l>=this._numberToString.length)throw new Error(`Out of bounds. Index requested n=${l} can't be >= this._numberToString.length ${this._numberToString.length}`);return this._numberToString[l]}}class zF{constructor(l,h,v,S,k){this.type="Feature",this._vectorTileFeature=l,this._x=v,this._y=S,this._z=h,this.properties=l.properties,this.id=k}projectPoint(l,h,v,S){return[360*(l.x+h)/S-180,360/Math.PI*Math.atan(Math.exp((1-2*(l.y+v)/S)*Math.PI))-90]}projectLine(l,h,v,S){return l.map((k=>this.projectPoint(k,h,v,S)))}get geometry(){if(this._geometry)return this._geometry;const l=this._vectorTileFeature,h=l.extent*Math.pow(2,this._z),v=l.extent*this._x,S=l.extent*this._y,k=l.loadGeometry();switch(l.type){case 1:{const R=[];for(const V of k)R.push(V[0]);const B=this.projectLine(R,v,S,h);this._geometry=R.length===1?{type:"Point",coordinates:B[0]}:{type:"MultiPoint",coordinates:B};break}case 2:{const R=k.map((B=>this.projectLine(B,v,S,h)));this._geometry=R.length===1?{type:"LineString",coordinates:R[0]}:{type:"MultiLineString",coordinates:R};break}case 3:{const R=eF(k),B=[];for(const V of R)B.push(V.map((Z=>this.projectLine(Z,v,S,h))));this._geometry=B.length===1?{type:"Polygon",coordinates:B[0]}:{type:"MultiPolygon",coordinates:B};break}default:throw new Error(`unknown feature type: ${l.type}`)}return this._geometry}set geometry(l){this._geometry=l}toJSON(){const l={geometry:this.geometry};for(const h in this)h!=="_geometry"&&h!=="_vectorTileFeature"&&h!=="_x"&&h!=="_y"&&h!=="_z"&&(l[h]=this[h]);return l}}class ev{_name;dataBuffer;nullabilityBuffer;_size;constructor(l,h,v){this._name=l,this.dataBuffer=h,typeof v=="number"?this._size=v:(this.nullabilityBuffer=v,this._size=v.size())}getValue(l){return this.nullabilityBuffer&&!this.nullabilityBuffer.get(l)?null:this.getValueFromBuffer(l)}has(l){return this.nullabilityBuffer&&this.nullabilityBuffer.get(l)||!this.nullabilityBuffer}get name(){return this._name}get size(){return this._size}}class T2 extends ev{}class IC extends T2{getValueFromBuffer(l){return this.dataBuffer[l]}}class PC extends T2{getValueFromBuffer(l){return this.dataBuffer[l]}}class jF extends ev{delta;constructor(l,h,v,S){super(l,h,S),this.delta=v}}class kC extends jF{constructor(l,h,v,S){super(l,Int32Array.of(h),v,S)}getValueFromBuffer(l){return this.dataBuffer[0]+l*this.delta}}class RC extends ev{constructor(l,h,v){super(l,Int32Array.of(h),v)}getValueFromBuffer(l){return this.dataBuffer[0]}}class Sae{_name;_geometryVector;_idVector;_propertyVectors;_extent;propertyVectorsMap;constructor(l,h,v,S,k=4096){this._name=l,this._geometryVector=h,this._idVector=v,this._propertyVectors=S,this._extent=k}get name(){return this._name}get idVector(){return this._idVector}get geometryVector(){return this._geometryVector}get propertyVectors(){return this._propertyVectors}getPropertyVector(l){return this.propertyVectorsMap||(this.propertyVectorsMap=new Map(this._propertyVectors.map((h=>[h.name,h])))),this.propertyVectorsMap.get(l)}*[Symbol.iterator](){const l=this.geometryVector[Symbol.iterator]();let h=0;for(;h<this.numFeatures;){let v;this.idVector&&(v=this.containsMaxSaveIntegerValues(this.idVector)?Number(this.idVector.getValue(h)):this.idVector.getValue(h));const S=l?.next().value,k={};for(const R of this.propertyVectors){if(!R)continue;const B=R.name,V=R.getValue(h);V!==null&&(k[B]=V)}h++,yield{id:v,geometry:S,properties:k}}}get numFeatures(){return this.geometryVector.numGeometries}get extent(){return this._extent}getFeatures(){const l=[],h=this.geometryVector.getGeometries();for(let v=0;v<this.numFeatures;v++){let S;this.idVector&&(S=this.containsMaxSaveIntegerValues(this.idVector)?Number(this.idVector.getValue(v)):this.idVector.getValue(v));const k={coordinates:h[v],type:this.geometryVector.geometryType(v)},R={};for(const B of this.propertyVectors){if(!B)continue;const V=B.name,Z=B.getValue(v);Z!==null&&(R[V]=Z)}l.push({id:S,geometry:k,properties:R})}return l}containsMaxSaveIntegerValues(l){return l instanceof IC||l instanceof RC&&l instanceof kC||l instanceof PC}}class Eae{value;constructor(l){this.value=l}get(){return this.value}set(l){this.value=l}increment(){return this.value++}add(l){this.value+=l}}var Zi,Wd,Kl,uh,im,Tc,ml,yl,UF,Kc;function Dl(p,l,h){const v=new Int32Array(h);let S=0,k=l.get();for(let R=0;R<v.length;R++){let B=p[k++],V=127&B;B<128||(B=p[k++],V|=(127&B)<<7,B<128||(B=p[k++],V|=(127&B)<<14,B<128||(B=p[k++],V|=(127&B)<<21,B<128||(B=p[k++],V|=(15&B)<<28)))),v[S++]=V}return l.set(k),v}function C2(p,l,h){const v=new BigInt64Array(h);for(let S=0;S<v.length;S++)v[S]=Cae(p,l);return v}function Tae(p,l){let h,v;return v=p[l.get()],l.increment(),h=127&v,v<128?h:(v=p[l.get()],l.increment(),h|=(127&v)<<7,v<128?h:(v=p[l.get()],l.increment(),h|=(127&v)<<14,v<128?h:(v=p[l.get()],l.increment(),h|=(127&v)<<21,v<128?h:(v=p[l.get()],h|=(15&v)<<28,(function(S,k,R){let B,V;if(V=k[R.get()],R.increment(),B=(112&V)>>4,V<128||(V=k[R.get()],R.increment(),B|=(127&V)<<3,V<128)||(V=k[R.get()],R.increment(),B|=(127&V)<<10,V<128)||(V=k[R.get()],R.increment(),B|=(127&V)<<17,V<128)||(V=k[R.get()],R.increment(),B|=(127&V)<<24,V<128)||(V=k[R.get()],R.increment(),B|=(1&V)<<31,V<128))return 4294967296*B+(S>>>0);throw new Error("Expected varint not more than 10 bytes")})(h,p,l)))))}function VF(p,l,h,v){throw new Error("FastPFor is not implemented yet.")}function am(p){return p>>>1^-(1&p)}function tv(p){return p>>1n^-(1n&p)}function Cae(p,l){let h=0n,v=0,S=l.get();for(;S<p.length;){const k=p[S++];if(h|=BigInt(127&k)<<BigInt(v),!(128&k))break;if(v+=7,v>=64)throw new Error("Varint too long")}return l.set(S),h}function $F(p,l,h){const v=new Int32Array(h);let S=0;for(let k=0;k<l;k++){const R=p[k];v.fill(p[k+l],S,S+R),S+=R}return v}function qF(p,l,h){const v=new BigInt64Array(h);let S=0;for(let k=0;k<l;k++){const R=Number(p[k]);v.fill(p[k+l],S,S+R),S+=R}return v}function HF(p,l,h){const v=new Float64Array(h);let S=0;for(let k=0;k<l;k++){const R=p[k];v.fill(p[k+l],S,S+R),S+=R}return v}function MC(p){const l=p.length/4*4;let h=1;if(l>=4)for(let v=p[0];h<l-4;h+=4)v=p[h]+=v,v=p[h+1]+=v,v=p[h+2]+=v,v=p[h+3]+=v;for(;h!=p.length;)p[h]+=p[h-1],++h}function GF(p){p[0]=p[0]>>>1^-(1&p[0]),p[1]=p[1]>>>1^-(1&p[1]);const l=p.length/4*4;let h=2;if(l>=4)for(;h<l-4;h+=4){const v=p[h],S=p[h+1],k=p[h+2],R=p[h+3];p[h]=(v>>>1^-(1&v))+p[h-2],p[h+1]=(S>>>1^-(1&S))+p[h-1],p[h+2]=(k>>>1^-(1&k))+p[h],p[h+3]=(R>>>1^-(1&R))+p[h+1]}for(;h!=p.length;h+=2)p[h]=(p[h]>>>1^-(1&p[h]))+p[h-2],p[h+1]=(p[h+1]>>>1^-(1&p[h+1]))+p[h-1]}(function(p){p.NONE="NONE",p.DELTA="DELTA",p.COMPONENTWISE_DELTA="COMPONENTWISE_DELTA",p.RLE="RLE",p.MORTON="MORTON",p.PDE="PDE"})(Zi||(Zi={})),(function(p){p.NONE="NONE",p.FAST_PFOR="FAST_PFOR",p.VARINT="VARINT",p.ALP="ALP"})(Wd||(Wd={})),(function(p){p.PRESENT="PRESENT",p.DATA="DATA",p.OFFSET="OFFSET",p.LENGTH="LENGTH"})(Kl||(Kl={}));class DC{_dictionaryType;_offsetType;_lengthType;constructor(l,h,v){this._dictionaryType=l,this._offsetType=h,this._lengthType=v}get dictionaryType(){return this._dictionaryType}get offsetType(){return this._offsetType}get lengthType(){return this._lengthType}}function ju(p,l){const h=(function(v,S){const k=v[S.get()],R=Object.values(Kl)[k>>4];let B=null;switch(R){case Kl.DATA:B=new DC(Object.values(uh)[15&k]);break;case Kl.OFFSET:B=new DC(null,Object.values(im)[15&k]);break;case Kl.LENGTH:B=new DC(null,null,Object.values(Tc)[15&k])}S.increment();const V=v[S.get()],Z=Object.values(Zi)[V>>5],ie=Object.values(Zi)[V>>2&7],ce=Object.values(Wd)[3&V];S.increment();const ve=Dl(v,S,2),Ee=ve[0];return{physicalStreamType:R,logicalStreamType:B,logicalLevelTechnique1:Z,logicalLevelTechnique2:ie,physicalLevelTechnique:ce,numValues:Ee,byteLength:ve[1],decompressedCount:Ee}})(p,l);return h.logicalLevelTechnique1===Zi.MORTON?(function(v,S,k){const R=Dl(S,k,2);return{physicalStreamType:v.physicalStreamType,logicalStreamType:v.logicalStreamType,logicalLevelTechnique1:v.logicalLevelTechnique1,logicalLevelTechnique2:v.logicalLevelTechnique2,physicalLevelTechnique:v.physicalLevelTechnique,numValues:v.numValues,byteLength:v.byteLength,decompressedCount:v.decompressedCount,numBits:R[0],coordinateShift:R[1]}})(h,p,l):Zi.RLE!==h.logicalLevelTechnique1&&Zi.RLE!==h.logicalLevelTechnique2||Wd.NONE===h.physicalLevelTechnique?h:(function(v,S,k){const R=Dl(S,k,2);return{physicalStreamType:v.physicalStreamType,logicalStreamType:v.logicalStreamType,logicalLevelTechnique1:v.logicalLevelTechnique1,logicalLevelTechnique2:v.logicalLevelTechnique2,physicalLevelTechnique:v.physicalLevelTechnique,numValues:v.numValues,byteLength:v.byteLength,decompressedCount:R[1],runs:R[0],numRleValues:R[1]}})(h,p,l)}(function(p){p.NONE="NONE",p.SINGLE="SINGLE",p.SHARED="SHARED",p.VERTEX="VERTEX",p.MORTON="MORTON",p.FSST="FSST"})(uh||(uh={})),(function(p){p.VERTEX="VERTEX",p.INDEX="INDEX",p.STRING="STRING",p.KEY="KEY"})(im||(im={})),(function(p){p.VAR_BINARY="VAR_BINARY",p.GEOMETRIES="GEOMETRIES",p.PARTS="PARTS",p.RINGS="RINGS",p.TRIANGLES="TRIANGLES",p.SYMBOL="SYMBOL",p.DICTIONARY="DICTIONARY"})(Tc||(Tc={})),(function(p){p[p.FLAT=0]="FLAT",p[p.CONST=1]="CONST",p[p.SEQUENCE=2]="SEQUENCE",p[p.DICTIONARY=3]="DICTIONARY",p[p.FSST_DICTIONARY=4]="FSST_DICTIONARY"})(ml||(ml={}));class ch{values;_size;constructor(l,h){this.values=l,this._size=h}get(l){const h=Math.floor(l/8);return(this.values[h]>>l%8&1)==1}set(l,h){const v=Math.floor(l/8);this.values[v]=this.values[v]|(h?1:0)<<l%8}getInt(l){const h=Math.floor(l/8);return this.values[h]>>l%8&1}size(){return this._size}getBuffer(){return this.values}}function Uu(p,l,h,v,S){return(function(k,R,B){switch(R.logicalLevelTechnique1){case Zi.DELTA:return R.logicalLevelTechnique2===Zi.RLE?(function(V,Z,ie){const ce=new Int32Array(ie);let ve=0,Ee=0;for(let Ne=0;Ne<Z;Ne++){const ze=V[Ne],Ve=am(V[Ne+Z]);for(let et=0;et<ze;et++)Ee+=Ve,ce[ve++]=Ee}return ce})(k,R.runs,R.numRleValues):((function(V){V[0]=V[0]>>>1^-(1&V[0]);const Z=V.length/4*4;let ie=1;if(Z>=4)for(;ie<Z-4;ie+=4){const ce=V[ie],ve=V[ie+1],Ee=V[ie+2],Ne=V[ie+3];V[ie]=(ce>>>1^-(1&ce))+V[ie-1],V[ie+1]=(ve>>>1^-(1&ve))+V[ie],V[ie+2]=(Ee>>>1^-(1&Ee))+V[ie+1],V[ie+3]=(Ne>>>1^-(1&Ne))+V[ie+2]}for(;ie!=V.length;++ie)V[ie]=(V[ie]>>>1^-(1&V[ie]))+V[ie-1]})(k),k);case Zi.RLE:return(function(V,Z,ie){return ie?(function(ce,ve,Ee){const Ne=new Int32Array(Ee);let ze=0;for(let Ve=0;Ve<ve;Ve++){const et=ce[Ve];let Ct=ce[Ve+ve];Ct=Ct>>>1^-(1&Ct),Ne.fill(Ct,ze,ze+et),ze+=et}return Ne})(V,Z.runs,Z.numRleValues):$F(V,Z.runs,Z.numRleValues)})(k,R,B);case Zi.MORTON:return MC(k),k;case Zi.COMPONENTWISE_DELTA:return GF(k),k;case Zi.NONE:return B&&(function(V){for(let Z=0;Z<V.length;Z++){const ie=V[Z];V[Z]=ie>>>1^-(1&ie)}})(k),k;default:throw new Error(`The specified Logical level technique is not supported: ${R.logicalLevelTechnique1}`)}})(A2(p,l,h),h,v)}function Xp(p,l,h){return(function(v,S){if(S.logicalLevelTechnique1===Zi.DELTA&&S.logicalLevelTechnique2===Zi.NONE)return(function(R){const B=new Int32Array(R.length+1);B[0]=0,B[1]=am(R[0]);let V=B[1],Z=2;for(;Z!=B.length;++Z){const ie=R[Z-1];V+=ie>>>1^-(1&ie),B[Z]=B[Z-1]+V}return B})(v);if(S.logicalLevelTechnique1===Zi.RLE&&S.logicalLevelTechnique2===Zi.NONE)return(function(R,B,V){const Z=new Int32Array(V+1);Z[0]=0;let ie=1,ce=Z[0];for(let ve=0;ve<B;ve++){const Ee=R[ve],Ne=R[ve+B];for(let ze=ie;ze<ie+Ee;ze++)Z[ze]=Ne+ce,ce=Z[ze];ie+=Ee}return Z})(v,S.runs,S.numRleValues);if(S.logicalLevelTechnique1===Zi.NONE&&S.logicalLevelTechnique2===Zi.NONE){(function(R){let B=0;for(let V=0;V<R.length;V++)R[V]+=B,B=R[V]})(v);const k=new Int32Array(S.numValues+1);return k[0]=0,k.set(v,1),k}if(S.logicalLevelTechnique1===Zi.DELTA&&S.logicalLevelTechnique2===Zi.RLE){const k=(function(R,B,V){const Z=new Int32Array(V+1);Z[0]=0;let ie=1,ce=Z[0];for(let ve=0;ve<B;ve++){const Ee=R[ve];let Ne=R[ve+B];Ne=Ne>>>1^-(1&Ne);for(let ze=ie;ze<ie+Ee;ze++)Z[ze]=Ne+ce,ce=Z[ze];ie+=Ee}return Z})(v,S.runs,S.numRleValues);return MC(k),k}throw new Error("Only delta encoding is supported for transforming length to offset streams yet.")})(A2(p,l,h),h)}function A2(p,l,h){const v=h.physicalLevelTechnique;if(v===Wd.FAST_PFOR)return VF();if(v===Wd.VARINT)return Dl(p,l,h.numValues);if(v===Wd.NONE){const S=l.get();l.add(h.byteLength);const k=p.subarray(S,l.get());return new Int32Array(k)}throw new Error("Specified physicalLevelTechnique is not supported (yet).")}function OC(p,l,h,v){const S=A2(p,l,h);if(S.length===1){const k=S[0];return v?am(k):k}return v?(function(k){return am(k[1])})(S):(function(k){return k[1]})(S)}function WF(p,l,h){return(function(v){if(v.length==2){const S=am(v[1]);return[S,S]}return[am(v[2]),am(v[3])]})(A2(p,l,h))}function XF(p,l,h){return(function(v){if(v.length==2){const S=tv(v[1]);return[S,S]}return[tv(v[2]),tv(v[3])]})(C2(p,l,h.numValues))}function YF(p,l,h,v){return(function(S,k,R){switch(k.logicalLevelTechnique1){case Zi.DELTA:return k.logicalLevelTechnique2===Zi.RLE?(function(B,V,Z){const ie=new BigInt64Array(Z);let ce=0,ve=0n;for(let Ee=0;Ee<V;Ee++){const Ne=Number(B[Ee]),ze=tv(B[Ee+V]);for(let Ve=0;Ve<Ne;Ve++)ve+=ze,ie[ce++]=ve}return ie})(S,k.runs,k.numRleValues):((function(B){B[0]=B[0]>>1n^-(1n&B[0]);const V=B.length/4*4;let Z=1;if(V>=4)for(;Z<V-4;Z+=4){const ie=B[Z],ce=B[Z+1],ve=B[Z+2],Ee=B[Z+3];B[Z]=(ie>>1n^-(1n&ie))+B[Z-1],B[Z+1]=(ce>>1n^-(1n&ce))+B[Z],B[Z+2]=(ve>>1n^-(1n&ve))+B[Z+1],B[Z+3]=(Ee>>1n^-(1n&Ee))+B[Z+2]}for(;Z!=B.length;++Z)B[Z]=(B[Z]>>1n^-(1n&B[Z]))+B[Z-1]})(S),S);case Zi.RLE:return(function(B,V,Z){return Z?(function(ie,ce,ve){const Ee=new BigInt64Array(ve);let Ne=0;for(let ze=0;ze<ce;ze++){const Ve=Number(ie[ze]);let et=ie[ze+ce];et=et>>1n^-(1n&et),Ee.fill(et,Ne,Ne+Ve),Ne+=Ve}return Ee})(B,V.runs,V.numRleValues):qF(B,V.runs,V.numRleValues)})(S,k,R);case Zi.NONE:return R&&(function(B){for(let V=0;V<B.length;V++){const Z=B[V];B[V]=Z>>1n^-(1n&Z)}})(S),S;default:throw new Error(`The specified Logical level technique is not supported: ${k.logicalLevelTechnique1}`)}})(C2(p,l,h.numValues),h,v)}function ZF(p,l,h,v){const S=C2(p,l,h.numValues);if(S.length===1){const k=S[0];return v?tv(k):k}return v?(function(k){return tv(k[1])})(S):(function(k){return k[1]})(S)}function NC(p,l,h,v,S){return(function(k,R,B,V){switch(R.logicalLevelTechnique1){case Zi.DELTA:return R.logicalLevelTechnique2===Zi.RLE&&(k=$F(k,R.runs,R.numRleValues)),(function(Z,ie){const ce=new Int32Array(Z.size());let ve=0;Z.get(0)?(ce[0]=Z.get(0)?ie[0]>>>1^-(1&ie[0]):0,ve=1):ce[0]=0;let Ee=1;for(;Ee!=ce.length;++Ee)ce[Ee]=Z.get(Ee)?ce[Ee-1]+(ie[ve]>>>1^-(1&ie[ve++])):ce[Ee-1];return ce})(V,k);case Zi.RLE:return(function(Z,ie,ce,ve){const Ee=ie;return ce?(function(Ne,ze,Ve){const et=new Int32Array(Ne.size());let Ct=0;for(let rt=0;rt<Ve;rt++){const ut=ze[rt];let Rt=ze[rt+Ve];Rt=Rt>>>1^-(1&Rt);for(let Bt=Ct;Bt<Ct+ut;Bt++)Ne.get(Bt)?et[Bt]=Rt:(et[Bt]=0,Ct++);Ct+=ut}return et})(ve,Z,Ee.runs):(function(Ne,ze,Ve){const et=new Int32Array(Ne.size());let Ct=0;for(let rt=0;rt<Ve;rt++){const ut=ze[rt],Rt=ze[rt+Ve];for(let Bt=Ct;Bt<Ct+ut;Bt++)Ne.get(Bt)?et[Bt]=Rt:(et[Bt]=0,Ct++);Ct+=ut}return et})(ve,Z,Ee.runs)})(k,R,B,V);case Zi.MORTON:return MC(k),k;case Zi.COMPONENTWISE_DELTA:return GF(k),k;case Zi.NONE:return k=B?(function(Z,ie){const ce=new Int32Array(Z.size());let ve=0,Ee=0;for(;Ee!=ce.length;++Ee)if(Z.get(Ee)){const Ne=ie[ve++];ce[Ee]=Ne>>>1^-(1&Ne)}else ce[Ee]=0;return ce})(V,k):(function(Z,ie){const ce=new Int32Array(Z.size());let ve=0,Ee=0;for(;Ee!=ce.length;++Ee)ce[Ee]=Z.get(Ee)?ie[ve++]:0;return ce})(V,k),k;default:throw new Error("The specified Logical level technique is not supported")}})(h.physicalLevelTechnique===Wd.FAST_PFOR?VF():Dl(p,l,h.numValues),h,v,S)}function I2(p,l,h,v){const S=p.logicalLevelTechnique1;if(S===Zi.RLE)return p.runs===1?ml.CONST:ml.FLAT;const k=l instanceof ch?l.size():l;if(S===Zi.DELTA&&p.logicalLevelTechnique2===Zi.RLE){const R=p.runs,B=2;if(p.numRleValues!==k)return ml.FLAT;if(R===1)return ml.SEQUENCE;if(R===2){const V=v.get();let Z;if(p.physicalLevelTechnique===Wd.VARINT)Z=Dl(h,v,4);else{const ie=v.get();Z=new Int32Array(h.buffer,h.byteOffset+ie,4)}if(v.set(V),Z[2]===B&&Z[3]===B)return ml.SEQUENCE}}return p.numValues===1?ml.CONST:ml.FLAT}class KF extends T2{getValueFromBuffer(l){return this.dataBuffer[l]}}class JF extends jF{constructor(l,h,v,S){super(l,BigInt64Array.of(h),v,S)}getValueFromBuffer(l){return this.dataBuffer[0]+BigInt(l)*this.delta}}class rv{_geometryOffsets;_partOffsets;_ringOffsets;constructor(l,h,v){this._geometryOffsets=l,this._partOffsets=h,this._ringOffsets=v}get geometryOffsets(){return this._geometryOffsets}get partOffsets(){return this._partOffsets}get ringOffsets(){return this._ringOffsets}}function LC(p,l,h){return{x:QF(p,l)-h,y:QF(p>>1,l)-h}}function QF(p,l){let h=0;for(let v=0;v<l;v++)h|=(p&1<<2*v)>>v;return h}(function(p){p[p.POINT=0]="POINT",p[p.LINESTRING=1]="LINESTRING",p[p.POLYGON=2]="POLYGON",p[p.MULTIPOINT=3]="MULTIPOINT",p[p.MULTILINESTRING=4]="MULTILINESTRING",p[p.MULTIPOLYGON=5]="MULTIPOLYGON"})(yl||(yl={})),(function(p){p[p.POINT=0]="POINT",p[p.LINESTRING=1]="LINESTRING",p[p.POLYGON=2]="POLYGON"})(UF||(UF={})),(function(p){p[p.MORTON=0]="MORTON",p[p.VEC_2=1]="VEC_2",p[p.VEC_3=2]="VEC_3"})(Kc||(Kc={}));class Aae{createPoint(l){return[[l]]}createMultiPoint(l){return l.map((h=>[h]))}createLineString(l){return[l]}createMultiLineString(l){return l}createPolygon(l,h){return[l].concat(h)}createMultiPolygon(l){return l.flat()}}function e8(p){const l=new Array(p.numGeometries);let h=1,v=1,S=1,k=0;const R=new Aae;let B=0,V=0;const Z=p.mortonSettings,ie=p.topologyVector,ce=ie.geometryOffsets,ve=ie.partOffsets,Ee=ie.ringOffsets,Ne=p.vertexOffsets,ze=p.containsPolygonGeometry(),Ve=p.vertexBuffer;for(let et=0;et<p.numGeometries;et++){const Ct=p.geometryType(et);if(Ct===yl.POINT){if(Ne&&Ne.length!==0)if(p.vertexBufferType===Kc.VEC_2){const rt=2*Ne[V++],ut=new c(Ve[rt],Ve[rt+1]);l[k++]=R.createPoint(ut)}else{const rt=LC(Ve[Ne[V++]],Z.numBits,Z.coordinateShift),ut=new c(rt.x,rt.y);l[k++]=R.createPoint(ut)}else{const rt=new c(Ve[B++],Ve[B++]);l[k++]=R.createPoint(rt)}ce&&S++,ve&&h++,Ee&&v++}else if(Ct===yl.MULTIPOINT){const rt=ce[S]-ce[S-1];S++;const ut=new Array(rt);if(Ne&&Ne.length!==0){for(let Rt=0;Rt<rt;Rt++){const Bt=2*Ne[V++];ut[Rt]=new c(Ve[Bt],Ve[Bt+1])}l[k++]=R.createMultiPoint(ut)}else{for(let Rt=0;Rt<rt;Rt++){const Bt=Ve[B++],dr=Ve[B++];ut[Rt]=new c(Bt,dr)}l[k++]=R.createMultiPoint(ut)}}else if(Ct===yl.LINESTRING){let rt,ut=0;ze?(ut=Ee[v]-Ee[v-1],v++):ut=ve[h]-ve[h-1],h++,Ne&&Ne.length!==0?(rt=p.vertexBufferType===Kc.VEC_2?BC(Ve,Ne,V,ut,!1):zC(Ve,Ne,V,ut,!1,Z),V+=ut):(rt=FC(Ve,B,ut,!1),B+=2*ut),l[k++]=R.createLineString(rt),ce&&S++}else if(Ct===yl.POLYGON){const rt=ve[h]-ve[h-1];h++;const ut=new Array(rt-1);let Rt=Ee[v]-Ee[v-1];if(v++,Ne&&Ne.length!==0){const Bt=p.vertexBufferType===Kc.VEC_2?k2(Ve,Ne,V,Rt):R2(Ve,Ne,V,Rt,0,Z);V+=Rt;for(let dr=0;dr<ut.length;dr++)Rt=Ee[v]-Ee[v-1],v++,ut[dr]=p.vertexBufferType===Kc.VEC_2?k2(Ve,Ne,V,Rt):R2(Ve,Ne,V,Rt,0,Z),V+=Rt;l[k++]=R.createPolygon(Bt,ut)}else{const Bt=P2(Ve,B,Rt);B+=2*Rt;for(let dr=0;dr<ut.length;dr++)Rt=Ee[v]-Ee[v-1],v++,ut[dr]=P2(Ve,B,Rt),B+=2*Rt;l[k++]=R.createPolygon(Bt,ut)}ce&&S++}else if(Ct===yl.MULTILINESTRING){const rt=ce[S]-ce[S-1];S++;const ut=new Array(rt);if(Ne&&Ne.length!==0){for(let Rt=0;Rt<rt;Rt++){let Bt=0;ze?(Bt=Ee[v]-Ee[v-1],v++):Bt=ve[h]-ve[h-1],h++;const dr=p.vertexBufferType===Kc.VEC_2?BC(Ve,Ne,V,Bt,!1):zC(Ve,Ne,V,Bt,!1,Z);ut[Rt]=dr,V+=Bt}l[k++]=R.createMultiLineString(ut)}else{for(let Rt=0;Rt<rt;Rt++){let Bt=0;ze?(Bt=Ee[v]-Ee[v-1],v++):Bt=ve[h]-ve[h-1],h++,ut[Rt]=FC(Ve,B,Bt,!1),B+=2*Bt}l[k++]=R.createMultiLineString(ut)}}else{if(Ct!==yl.MULTIPOLYGON)throw new Error("The specified geometry type is currently not supported.");{const rt=ce[S]-ce[S-1];S++;const ut=new Array(rt);let Rt=0;if(Ne&&Ne.length!==0){for(let Bt=0;Bt<rt;Bt++){const dr=ve[h]-ve[h-1];h++;const Or=new Array(dr-1);Rt=Ee[v]-Ee[v-1],v++;const Pr=p.vertexBufferType===Kc.VEC_2?k2(Ve,Ne,V,Rt):R2(Ve,Ne,V,Rt,0,Z);V+=Rt;for(let Vr=0;Vr<Or.length;Vr++)Rt=Ee[v]-Ee[v-1],v++,Or[Vr]=p.vertexBufferType===Kc.VEC_2?k2(Ve,Ne,V,Rt):R2(Ve,Ne,V,Rt,0,Z),V+=Rt;ut[Bt]=R.createPolygon(Pr,Or)}l[k++]=R.createMultiPolygon(ut)}else{for(let Bt=0;Bt<rt;Bt++){const dr=ve[h]-ve[h-1];h++;const Or=new Array(dr-1);Rt=Ee[v]-Ee[v-1],v++;const Pr=P2(Ve,B,Rt);B+=2*Rt;for(let Vr=0;Vr<Or.length;Vr++){const pn=Ee[v]-Ee[v-1];v++,Or[Vr]=P2(Ve,B,pn),B+=2*pn}ut[Bt]=R.createPolygon(Pr,Or)}l[k++]=R.createMultiPolygon(ut)}}}}return l}function P2(p,l,h){return FC(p,l,h,!0)}function k2(p,l,h,v){return BC(p,l,h,v,!0)}function R2(p,l,h,v,S,k){return zC(p,l,h,v,!0,k)}function FC(p,l,h,v){const S=new Array(v?h+1:h);for(let k=0;k<2*h;k+=2)S[k/2]=new c(p[l+k],p[l+k+1]);return v&&(S[S.length-1]=S[0]),S}function BC(p,l,h,v,S){const k=new Array(S?v+1:v);for(let R=0;R<2*v;R+=2){const B=2*l[h+R/2];k[R/2]=new c(p[B],p[B+1])}return S&&(k[k.length-1]=k[0]),k}function zC(p,l,h,v,S,k){const R=new Array(S?v+1:v);for(let B=0;B<v;B++){const V=LC(p[l[h+B]],k.numBits,k.coordinateShift);R[B]=new c(V.x,V.y)}return S&&(R[R.length-1]=R[0]),R}class t8{_vertexBufferType;_topologyVector;_vertexOffsets;_vertexBuffer;_mortonSettings;constructor(l,h,v,S,k){this._vertexBufferType=l,this._topologyVector=h,this._vertexOffsets=v,this._vertexBuffer=S,this._mortonSettings=k}get vertexBufferType(){return this._vertexBufferType}get topologyVector(){return this._topologyVector}get vertexOffsets(){return this._vertexOffsets}get vertexBuffer(){return this._vertexBuffer}*[Symbol.iterator](){const l=e8(this);let h=0;for(;h<this.numGeometries;)yield{coordinates:l[h],type:this.geometryType(h)},h++}getSimpleEncodedVertex(l){const h=this.vertexOffsets?2*this.vertexOffsets[l]:2*l;return[this.vertexBuffer[h],this.vertexBuffer[h+1]]}getVertex(l){if(this.vertexOffsets&&this.mortonSettings){const v=LC(this.vertexBuffer[this.vertexOffsets[l]],this.mortonSettings.numBits,this.mortonSettings.coordinateShift);return[v.x,v.y]}const h=this.vertexOffsets?2*this.vertexOffsets[l]:2*l;return[this.vertexBuffer[h],this.vertexBuffer[h+1]]}getGeometries(){return e8(this)}get mortonSettings(){return this._mortonSettings}}class r8 extends t8{_numGeometries;_geometryType;constructor(l,h,v,S,k,R,B){super(v,S,k,R,B),this._numGeometries=l,this._geometryType=h}geometryType(l){return this._geometryType}get numGeometries(){return this._numGeometries}containsPolygonGeometry(){return this._geometryType===yl.POLYGON||this._geometryType===yl.MULTIPOLYGON}containsSingleGeometryType(){return!0}}class n8 extends t8{_geometryTypes;constructor(l,h,v,S,k,R){super(l,v,S,k,R),this._geometryTypes=h}geometryType(l){return this._geometryTypes[l]}get numGeometries(){return this._geometryTypes.length}containsPolygonGeometry(){for(let l=0;l<this.numGeometries;l++)if(this.geometryType(l)===yl.POLYGON||this.geometryType(l)===yl.MULTIPOLYGON)return!0;return!1}containsSingleGeometryType(){return!1}}class i8{_triangleOffsets;_indexBuffer;_vertexBuffer;_topologyVector;constructor(l,h,v,S){this._triangleOffsets=l,this._indexBuffer=h,this._vertexBuffer=v,this._topologyVector=S}get triangleOffsets(){return this._triangleOffsets}get indexBuffer(){return this._indexBuffer}get vertexBuffer(){return this._vertexBuffer}get topologyVector(){return this._topologyVector}getGeometries(){if(!this._topologyVector)throw new Error("Cannot convert GpuVector to coordinates without topology information");const l=new Array(this.numGeometries),h=this._topologyVector,v=h.partOffsets,S=h.ringOffsets,k=h.geometryOffsets;let R=0,B=1,V=1,Z=1;for(let ie=0;ie<this.numGeometries;ie++)switch(this.geometryType(ie)){case yl.POLYGON:{const ce=v[B]-v[B-1];B++;const ve=[];for(let Ee=0;Ee<ce;Ee++){const Ne=S[V]-S[V-1];V++;const ze=[];for(let Ve=0;Ve<Ne;Ve++){const et=this._vertexBuffer[R++],Ct=this._vertexBuffer[R++];ze.push(new c(et,Ct))}ze.length>0&&ze.push(ze[0]),ve.push(ze)}l[ie]=ve,k&&Z++}break;case yl.MULTIPOLYGON:{const ce=k[Z]-k[Z-1];Z++;const ve=[];for(let Ee=0;Ee<ce;Ee++){const Ne=v[B]-v[B-1];B++;for(let ze=0;ze<Ne;ze++){const Ve=S[V]-S[V-1];V++;const et=[];for(let Ct=0;Ct<Ve;Ct++){const rt=this._vertexBuffer[R++],ut=this._vertexBuffer[R++];et.push(new c(rt,ut))}et.length>0&&et.push(et[0]),ve.push(et)}}l[ie]=ve}}return l}[Symbol.iterator](){return null}}function a8(p,l,h,v,S,k){return new Iae(p,l,h,v,S,k)}class Iae extends i8{_numGeometries;_geometryType;constructor(l,h,v,S,k,R){super(v,S,k,R),this._numGeometries=l,this._geometryType=h}geometryType(l){return this._geometryType}get numGeometries(){return this._numGeometries}containsSingleGeometryType(){return!0}}function o8(p,l,h,v,S){return new Pae(p,l,h,v,S)}class Pae extends i8{_geometryTypes;constructor(l,h,v,S,k){super(h,v,S,k),this._geometryTypes=l}geometryType(l){return this._geometryTypes[l]}get numGeometries(){return this._geometryTypes.length}containsSingleGeometryType(){return!1}}function kae(p,l,h,v,S){const k=ju(p,h);let R=null,B=null,V=null,Z=null,ie=null,ce=null,ve=null,Ee=null;if(I2(k,v,p,h)===ml.CONST){const ze=OC(p,h,k,!1);for(let Ve=0;Ve<l-1;Ve++){const et=ju(p,h);switch(et.physicalStreamType){case Kl.LENGTH:switch(et.logicalStreamType.lengthType){case Tc.GEOMETRIES:R=Xp(p,h,et);break;case Tc.PARTS:B=Xp(p,h,et);break;case Tc.RINGS:V=Xp(p,h,et);break;case Tc.TRIANGLES:ve=Xp(p,h,et)}break;case Kl.OFFSET:switch(et.logicalStreamType.offsetType){case im.VERTEX:Z=Uu(p,h,et,!1);break;case im.INDEX:Ee=Uu(p,h,et,!1)}break;case Kl.DATA:uh.VERTEX===et.logicalStreamType.dictionaryType?ie=Uu(p,h,et,!0):(ce={numBits:et.numBits,coordinateShift:et.coordinateShift},ie=Uu(p,h,et,!1))}}return Ee!==null?R!=null||B!=null?a8(v,ze,ve,Ee,ie,new rv(R,B,V)):a8(v,ze,ve,Ee,ie):ce===null?(function(Ve,et,Ct,rt,ut){return new r8(Ve,et,Kc.VEC_2,Ct,rt,ut)})(v,ze,new rv(R,B,V),Z,ie):(function(Ve,et,Ct,rt,ut,Rt){return new r8(Ve,et,Kc.MORTON,Ct,rt,ut,Rt)})(v,ze,new rv(R,B,V),Z,ie,ce)}const Ne=Uu(p,h,k,!1);for(let ze=0;ze<l-1;ze++){const Ve=ju(p,h);switch(Ve.physicalStreamType){case Kl.LENGTH:switch(Ve.logicalStreamType.lengthType){case Tc.GEOMETRIES:R=Uu(p,h,Ve,!1);break;case Tc.PARTS:B=Uu(p,h,Ve,!1);break;case Tc.RINGS:V=Uu(p,h,Ve,!1);break;case Tc.TRIANGLES:ve=Xp(p,h,Ve)}break;case Kl.OFFSET:switch(Ve.logicalStreamType.offsetType){case im.VERTEX:Z=Uu(p,h,Ve,!1);break;case im.INDEX:Ee=Uu(p,h,Ve,!1)}break;case Kl.DATA:uh.VERTEX===Ve.logicalStreamType.dictionaryType?ie=Uu(p,h,Ve,!0):(ce={numBits:Ve.numBits,coordinateShift:Ve.coordinateShift},ie=Uu(p,h,Ve,!1))}}return Ee!==null&&B===null?o8(Ne,ve,Ee,ie):(R!==null?(R=jC(Ne,R,2),B!==null&&V!==null?(B=s8(Ne,R,B,!1),V=(function(ze,Ve,et,Ct){const rt=new Int32Array(et[et.length-1]+1);let ut=0;rt[0]=ut;let Rt=1,Bt=1,dr=0;for(let Or=0;Or<ze.length;Or++){const Pr=ze[Or],Vr=Ve[Or+1]-Ve[Or];if(Pr!==0&&Pr!==3)for(let pn=0;pn<Vr;pn++){const Wr=et[Rt]-et[Rt-1];Rt++;for(let Rr=0;Rr<Wr;Rr++)ut=rt[Bt++]=ut+Ct[dr++]}else for(let pn=0;pn<Vr;pn++)rt[Bt++]=++ut,Rt++}return rt})(Ne,R,B,V)):B!==null&&(B=(function(ze,Ve,et){const Ct=new Int32Array(Ve[Ve.length-1]+1);let rt=0;Ct[0]=rt;let ut=1,Rt=0;for(let Bt=0;Bt<ze.length;Bt++){const dr=ze[Bt],Or=Ve[Bt+1]-Ve[Bt];if(dr===4||dr===1)for(let Pr=0;Pr<Or;Pr++)rt=Ct[ut++]=rt+et[Rt++];else for(let Pr=0;Pr<Or;Pr++)Ct[ut++]=++rt}return Ct})(Ne,R,B))):B!==null&&V!==null?(B=jC(Ne,B,1),V=s8(Ne,B,V,!0)):B!==null&&(B=jC(Ne,B,0)),Ee!==null?o8(Ne,ve,Ee,ie,new rv(R,B,V)):ce===null?(function(ze,Ve,et,Ct){return new n8(Kc.VEC_2,ze,Ve,et,Ct)})(Ne,new rv(R,B,V),Z,ie):(function(ze,Ve,et,Ct,rt){return new n8(Kc.MORTON,ze,Ve,et,Ct,rt)})(Ne,new rv(R,B,V),Z,ie,ce))}function jC(p,l,h){const v=new Int32Array(p.length+1);let S=0;v[0]=S;let k=0;for(let R=0;R<p.length;R++)S=v[R+1]=S+(p[R]>h?l[k++]:1);return v}function s8(p,l,h,v){const S=new Int32Array(l[l.length-1]+1);let k=0;S[0]=k;let R=1,B=0;for(let V=0;V<p.length;V++){const Z=p[V],ie=l[V+1]-l[V];if(Z===5||Z===2||v&&(Z===4||Z===1))for(let ce=0;ce<ie;ce++)k=S[R++]=k+h[B++];else for(let ce=0;ce<ie;ce++)S[R++]=++k}return S}class Rae extends ev{dataVector;constructor(l,h,v){super(l,h.getBuffer(),v),this.dataVector=h}getValueFromBuffer(l){return this.dataVector.get(l)}}class Mae extends T2{getValueFromBuffer(l){return this.dataBuffer[l]}}class l8 extends ev{constructor(l,h,v){super(l,BigInt64Array.of(h),v)}getValueFromBuffer(l){return this.dataBuffer[0]}}function G_(p,l,h){return u8(p,Math.ceil(l/8),h)}function u8(p,l,h){const v=new Uint8Array(l);let S=0;for(;S<l;){const k=p[h.increment()];if(k<=127){const R=k+3,B=p[h.increment()],V=S+R;v.fill(B,S,V),S=V}else{const R=256-k;for(let B=0;B<R;B++)v[S++]=p[h.increment()]}}return v}const Dae=new TextDecoder;function UC(p,l,h){return h-l>=12?Dae.decode(p.subarray(l,h)):(function(v,S,k){let R="",B=S;for(;B<k;){const V=v[B];let Z,ie,ce,ve=null,Ee=V>239?4:V>223?3:V>191?2:1;if(B+Ee>k)break;Ee===1?V<128&&(ve=V):Ee===2?(Z=v[B+1],(192&Z)==128&&(ve=(31&V)<<6|63&Z,ve<=127&&(ve=null))):Ee===3?(Z=v[B+1],ie=v[B+2],(192&Z)==128&&(192&ie)==128&&(ve=(15&V)<<12|(63&Z)<<6|63&ie,(ve<=2047||ve>=55296&&ve<=57343)&&(ve=null))):Ee===4&&(Z=v[B+1],ie=v[B+2],ce=v[B+3],(192&Z)==128&&(192&ie)==128&&(192&ce)==128&&(ve=(15&V)<<18|(63&Z)<<12|(63&ie)<<6|63&ce,(ve<=65535||ve>=1114112)&&(ve=null))),ve===null?(ve=65533,Ee=1):ve>65535&&(ve-=65536,R+=String.fromCharCode(ve>>>10&1023|55296),ve=56320|1023&ve),R+=String.fromCharCode(ve),B+=Ee}return R})(p,l,h)}class VC extends ev{offsetBuffer;constructor(l,h,v,S){super(l,v,S),this.offsetBuffer=h}}class c8 extends VC{textEncoder;constructor(l,h,v,S){super(l,h,v,S??h.length-1),this.textEncoder=new TextEncoder}getValueFromBuffer(l){return UC(this.dataBuffer,this.offsetBuffer[l],this.offsetBuffer[l+1])}}class nv extends VC{indexBuffer;textEncoder;constructor(l,h,v,S,k){super(l,v,S,k??h.length),this.indexBuffer=h,this.indexBuffer=h,this.textEncoder=new TextEncoder}getValueFromBuffer(l){const h=this.indexBuffer[l];return UC(this.dataBuffer,this.offsetBuffer[h],this.offsetBuffer[h+1])}}class f8 extends VC{indexBuffer;symbolOffsetBuffer;symbolTableBuffer;textEncoder;symbolLengthBuffer;lengthBuffer;decodedDictionary;constructor(l,h,v,S,k,R,B){super(l,v,S,B),this.indexBuffer=h,this.symbolOffsetBuffer=k,this.symbolTableBuffer=R,this.textEncoder=new TextEncoder}getValueFromBuffer(l){this.decodedDictionary==null&&(this.symbolLengthBuffer==null&&(this.symbolLengthBuffer=this.offsetToLengthBuffer(this.symbolOffsetBuffer),this.lengthBuffer=this.offsetToLengthBuffer(this.offsetBuffer)),this.decodedDictionary=(function(v,S,k){const R=[],B=new Array(S.length).fill(0);for(let V=1;V<S.length;V++)B[V]=B[V-1]+S[V-1];for(let V=0;V<k.length;V++)if(k[V]===255)R.push(k[++V]);else{const Z=S[k[V]],ie=B[k[V]];for(let ce=0;ce<Z;ce++)R.push(v[ie+ce])}return new Uint8Array(R)})(this.symbolTableBuffer,this.symbolLengthBuffer,this.dataBuffer));const h=this.indexBuffer[l];return UC(this.decodedDictionary,this.offsetBuffer[h],this.offsetBuffer[h+1])}offsetToLengthBuffer(l){const h=new Uint32Array(l.length-1);let v=l[0];for(let S=1;S<l.length;S++){const k=l[S];h[S-1]=k-v,v=k}return h}}function Oae(p,l,h,v,S,k){return h.type==="scalarType"?(function(R,B,V,Z,ie,ce){let ve=null,Ee=0;if(R===0)return null;if(ce.nullable){const ze=ju(B,V);Ee=ze.numValues;const Ve=V.get(),et=G_(B,Ee,V);V.set(Ve+ze.byteLength),ve=new ch(et,ze.numValues)}const Ne=ve??Z;switch(ie.physicalType){case 4:case 3:return(function(ze,Ve,et,Ct,rt){const ut=ju(ze,Ve),Rt=I2(ut,rt,ze,Ve),Bt=Ct.physicalType===3;if(Rt===ml.FLAT){const dr=W_(rt)?NC(ze,Ve,ut,Bt,rt):Uu(ze,Ve,ut,Bt);return new IC(et.name,dr,rt)}if(Rt===ml.SEQUENCE){const dr=WF(ze,Ve,ut);return new kC(et.name,dr[0],dr[1],ut.numRleValues)}{const dr=OC(ze,Ve,ut,Bt);return new RC(et.name,dr,rt)}})(B,V,ce,ie,Ne);case 9:return(function(ze,Ve,et,Ct,rt){let ut=null,Rt=null,Bt=null,dr=null,Or=null,Pr=null,Vr=null,pn=null;for(let Wr=0;Wr<Ct;Wr++){const Rr=ju(Ve,et);if(Rr.byteLength!==0)switch(Rr.physicalStreamType){case Kl.PRESENT:{const Tr=G_(Ve,Rr.numValues,et);Pr=new ch(Tr,Rr.numValues);break}case Kl.OFFSET:Rt=rt!=null||Pr!=null?NC(Ve,et,Rr,!1,rt??Pr):Uu(Ve,et,Rr,!1);break;case Kl.LENGTH:{const Tr=Xp(Ve,et,Rr);Tc.DICTIONARY===Rr.logicalStreamType.lengthType?ut=Tr:Tc.SYMBOL===Rr.logicalStreamType.lengthType?dr=Tr:Vr=Tr;break}case Kl.DATA:{const Tr=Ve.subarray(et.get(),et.get()+Rr.byteLength);et.add(Rr.byteLength);const Cn=Rr.logicalStreamType.dictionaryType;uh.FSST===Cn?Or=Tr:uh.SINGLE===Cn||uh.SHARED===Cn?Bt=Tr:uh.NONE===Cn&&(pn=Tr);break}}}return(function(Wr,Rr,Tr,Cn,xn,kn,vn){return Rr?new f8(Wr,Tr,Cn,xn,kn,Rr,vn):null})(ze,Or,Rt,ut,Bt,dr,rt??Pr)??(function(Wr,Rr,Tr,Cn,xn){return Rr?xn?new nv(Wr,Tr,Cn,Rr,xn):new nv(Wr,Tr,Cn,Rr):null})(ze,Bt,Rt,ut,rt??Pr)??(function(Wr,Rr,Tr,Cn,xn){if(!Rr||!Tr)return null;if(Cn)return xn?new nv(Wr,Cn,Rr,Tr,xn):new nv(Wr,Cn,Rr,Tr);if(xn&&xn.size()!==Rr.length-1){const kn=new Int32Array(xn.size());let vn=0;for(let Gn=0;Gn<xn.size();Gn++)kn[Gn]=xn.get(Gn)?vn++:0;return new nv(Wr,kn,Rr,Tr,xn)}return xn?new c8(Wr,Rr,Tr,xn):new c8(Wr,Rr,Tr)})(ze,Vr,pn,Rt,rt??Pr)})(ce.name,B,V,ce.nullable?R-1:R,ve);case 0:return(function(ze,Ve,et,Ct,rt){const ut=ju(ze,Ve),Rt=ut.numValues,Bt=Ve.get(),dr=W_(rt)?(function(Pr,Vr,pn,Wr){const Rr=u8(Pr,Math.ceil(Vr/8),pn),Tr=new ch(Rr,Vr),Cn=Wr.size(),xn=new ch(new Uint8Array(Cn),Cn);let kn=0;for(let vn=0;vn<Wr.size();vn++){const Gn=!!Wr.get(vn)&&Tr.get(kn++);xn.set(vn,Gn)}return xn.getBuffer()})(ze,Rt,Ve,rt):G_(ze,Rt,Ve);Ve.set(Bt+ut.byteLength);const Or=new ch(dr,Rt);return new Rae(et.name,Or,rt)})(B,V,ce,0,Ne);case 6:case 5:return(function(ze,Ve,et,Ct,rt){const ut=ju(ze,Ve),Rt=I2(ut,Ct,ze,Ve),Bt=rt.physicalType===5;if(Rt===ml.FLAT){const dr=W_(Ct)?(function(Or,Pr,Vr,pn,Wr){return(function(Rr,Tr,Cn,xn){switch(Tr.logicalLevelTechnique1){case Zi.DELTA:return Tr.logicalLevelTechnique2===Zi.RLE&&(Rr=qF(Rr,Tr.runs,Tr.numRleValues)),(function(kn,vn){const Gn=new BigInt64Array(kn.size());let la=0;kn.get(0)?(Gn[0]=kn.get(0)?vn[0]>>1n^-(1n&vn[0]):0n,la=1):Gn[0]=0n;let Hi=1;for(;Hi!=Gn.length;++Hi)Gn[Hi]=kn.get(Hi)?Gn[Hi-1]+(vn[la]>>1n^-(1n&vn[la++])):Gn[Hi-1];return Gn})(xn,Rr);case Zi.RLE:return(function(kn,vn,Gn,la){const Hi=vn;return Gn?(function(Po,Ql,Ms){const ko=new BigInt64Array(Po.size());let vo=0;for(let Ta=0;Ta<Ms;Ta++){const Yo=Number(Ql[Ta]);let os=Ql[Ta+Ms];os=os>>1n^-(1n&os);for(let uo=vo;uo<vo+Yo;uo++)Po.get(uo)?ko[uo]=os:(ko[uo]=0n,vo++);vo+=Yo}return ko})(la,kn,Hi.runs):(function(Po,Ql,Ms){const ko=new BigInt64Array(Po.size());let vo=0;for(let Ta=0;Ta<Ms;Ta++){const Yo=Number(Ql[Ta]),os=Ql[Ta+Ms];for(let uo=vo;uo<vo+Yo;uo++)Po.get(uo)?ko[uo]=os:(ko[uo]=0n,vo++);vo+=Yo}return ko})(la,kn,Hi.runs)})(Rr,Tr,Cn,xn);case Zi.NONE:return Rr=Cn?(function(kn,vn){const Gn=new BigInt64Array(kn.size());let la=0,Hi=0;for(;Hi!=Gn.length;++Hi)if(kn.get(Hi)){const Po=vn[la++];Gn[Hi]=Po>>1n^-(1n&Po)}else Gn[Hi]=0n;return Gn})(xn,Rr):(function(kn,vn){const Gn=new BigInt64Array(kn.size());let la=0,Hi=0;for(;Hi!=Gn.length;++Hi)Gn[Hi]=kn.get(Hi)?vn[la++]:0n;return Gn})(xn,Rr),Rr;default:throw new Error("The specified Logical level technique is not supported")}})(C2(Or,Pr,Vr.numValues),Vr,pn,Wr)})(ze,Ve,ut,Bt,Ct):YF(ze,Ve,ut,Bt);return new KF(et.name,dr,Ct)}if(Rt===ml.SEQUENCE){const dr=XF(ze,Ve,ut);return new JF(et.name,dr[0],dr[1],ut.numRleValues)}{const dr=ZF(ze,Ve,ut,Bt);return new l8(et.name,dr,Ct)}})(B,V,ce,Ne,ie);case 7:return(function(ze,Ve,et,Ct){const rt=ju(ze,Ve),ut=W_(Ct)?(function(Rt,Bt,dr,Or){const Pr=Bt.get(),Vr=Pr+Or*Float32Array.BYTES_PER_ELEMENT,pn=new Uint8Array(Rt.subarray(Pr,Vr)).buffer,Wr=new Float32Array(pn);Bt.set(Vr);const Rr=dr.size(),Tr=new Float32Array(Rr);let Cn=0;for(let xn=0;xn<Rr;xn++)Tr[xn]=dr.get(xn)?Wr[Cn++]:0;return Tr})(ze,Ve,Ct,rt.numValues):(function(Rt,Bt,dr){const Or=Bt.get(),Pr=Or+dr*Float32Array.BYTES_PER_ELEMENT,Vr=new Uint8Array(Rt.subarray(Or,Pr)).buffer,pn=new Float32Array(Vr);return Bt.set(Pr),pn})(ze,Ve,rt.numValues);return new Mae(et.name,ut,Ct)})(B,V,ce,Ne);case 8:return(function(ze,Ve,et,Ct){const rt=ju(ze,Ve),ut=W_(Ct)?(function(Rt,Bt,dr,Or){const Pr=Bt.get(),Vr=Pr+Or*Float64Array.BYTES_PER_ELEMENT,pn=new Uint8Array(Rt.subarray(Pr,Vr)).buffer,Wr=new Float64Array(pn);Bt.set(Vr);const Rr=dr.size(),Tr=new Float64Array(Rr);let Cn=0;for(let xn=0;xn<Rr;xn++)Tr[xn]=dr.get(xn)?Wr[Cn++]:0;return Tr})(ze,Ve,Ct,rt.numValues):(function(Rt,Bt,dr){const Or=Bt.get(),Pr=Or+dr*Float64Array.BYTES_PER_ELEMENT,Vr=new Uint8Array(Rt.subarray(Or,Pr)).buffer,pn=new Float64Array(Vr);return Bt.set(Pr),pn})(ze,Ve,rt.numValues);return new PC(et.name,ut,Ct)})(B,V,ce,Ne);default:throw new Error(`The specified data type for the field is currently not supported: ${ie}`)}})(v,p,l,S,h.scalarType,h):v!=1?null:(function(R,B,V,Z){let ie=null,ce=null,ve=null,Ee=null,Ne=!1;for(;!Ne;){const Ct=ju(R,B);switch(Ct.physicalStreamType){case Kl.LENGTH:Tc.DICTIONARY===Ct.logicalStreamType.lengthType?ie=Xp(R,B,Ct):ve=Xp(R,B,Ct);break;case Kl.DATA:uh.SINGLE===Ct.logicalStreamType.dictionaryType||uh.SHARED===Ct.logicalStreamType.dictionaryType?(ce=R.subarray(B.get(),B.get()+Ct.byteLength),Ne=!0):Ee=R.subarray(B.get(),B.get()+Ct.byteLength),B.add(Ct.byteLength)}}const ze=V.complexType.children,Ve=[];let et=0;for(const Ct of ze){const rt=Dl(R,B,1)[0];if(rt==0)continue;const ut=`${V.name}${Ct.name==="default"?"":":"+Ct.name}`;if(rt!==2||Ct.type!=="scalarField"||Ct.scalarField.physicalType!==9)throw new Error("Currently only optional string fields are implemented for a struct.");const Rt=ju(R,B),Bt=G_(R,Rt.numValues,B),dr=ju(R,B),Or=dr.decompressedCount!==Z?NC(R,B,dr,!1,new ch(Bt,Rt.numValues)):Uu(R,B,dr,!1);Ve[et++]=Ee?new f8(ut,Or,ie,ce,ve,Ee,new ch(Bt,Rt.numValues)):new nv(ut,Or,ie,ce,new ch(Bt,Rt.numValues))}return Ve})(p,l,h,S)}function W_(p){return p instanceof ch}function Nae(p){if(p.name==="id")return!1;if(p.type==="scalarType"){const l=p.scalarType;if(l.type==="physicalType")switch(l.physicalType){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:default:return!1;case 9:return!0}else if(l.type==="logicalType")return!1}else if(p.type==="complexType"){const l=p.complexType;if(l.type==="physicalType")switch(l.physicalType){case 0:case 1:return!0;default:return!1}}return console.warn("Unexpected column type in hasStreamCount",p),!1}const Lae=new TextDecoder;function h8(p,l){const h=Dl(p,l,1)[0];if(h===0)return"";const v=l.get(),S=p.subarray(v,v+h);return l.add(h),Lae.decode(S)}function d8(p,l){const h=Dl(p,l,1)[0]>>>0,v=!!(4&h),S=!!(2&h),k=Dl(p,l,1)[0]>>>0,R={};if(1&h&&(R.nullable=!0),S){const B={};if(v?(B.type="logicalType",B.logicalType=k):(B.type="physicalType",B.physicalType=k),8&h){const V=Dl(p,l,1)[0]>>>0;B.children=new Array(V);for(let Z=0;Z<V;Z++)B.children[Z]=d8(p,l)}R.type="complexField",R.complexField=B}else{const B={};v?(B.type="logicalType",B.logicalType=k):(B.type="physicalType",B.physicalType=k),R.type="scalarField",R.scalarField=B}return R}function Fae(p,l){const h=Dl(p,l,1)[0]>>>0,v=(function(S){switch(S){case 0:case 1:case 2:case 3:{const k={};k.nullable=!!(1&S),k.columnScope=0;const R={};return R.physicalType=S>1?6:4,R.type="physicalType",k.scalarType=R,k.type="scalarType",k}case 4:{const k={nullable:!1,columnScope:0},R={type:"physicalType",physicalType:0};return k.type="complexType",k.complexType=R,k}case 30:{const k={nullable:!1,columnScope:0},R={type:"physicalType",physicalType:1};return k.type="complexType",k.complexType=R,k}default:return(function(k){let R=null;switch(k){case 10:case 11:R=0;break;case 12:case 13:R=1;break;case 14:case 15:R=2;break;case 16:case 17:R=3;break;case 18:case 19:R=4;break;case 20:case 21:R=5;break;case 22:case 23:R=6;break;case 24:case 25:R=7;break;case 26:case 27:R=8;break;case 28:case 29:R=9;break;default:return null}const B={};B.nullable=!!(1&k),B.columnScope=0;const V={type:"physicalType"};return V.physicalType=R,B.type="scalarType",B.scalarType=V,B})(S)}})(h);if(!v)throw new Error(`Unsupported column type code: ${h}`);if((function(S){return S>=10})(h)?v.name=h8(p,l):h>=0&&h<=3?v.name="id":h===4&&(v.name="geometry"),(function(S){return S===30})(h)){const S=Dl(p,l,1)[0]>>>0,k=v.complexType;k.children=new Array(S);for(let R=0;R<S;R++)k.children[R]=d8(p,l)}return v}function Bae(p,l){const h={featureTables:[]},v={};v.name=h8(p,l);const S=Dl(p,l,1)[0]>>>0,k=Dl(p,l,1)[0]>>>0;v.columns=new Array(k);for(let R=0;R<k;R++)v.columns[R]=Fae(p,l);return h.featureTables.push(v),[h,S]}function zae(p,l,h,v,S,k,R=!1){const B=l.scalarType.physicalType,V=I2(S,k,p,h);if(B===4)switch(V){case ml.FLAT:{const Z=Uu(p,h,S,!1);return new IC(v,Z,k)}case ml.SEQUENCE:{const Z=WF(p,h,S);return new kC(v,Z[0],Z[1],S.numRleValues)}case ml.CONST:{const Z=OC(p,h,S,!1);return new RC(v,Z,k)}}else switch(V){case ml.FLAT:{if(R){const ie=(function(ce,ve,Ee,Ne){const ze=(function(Ve,et,Ct){const rt=new Float64Array(et);for(let ut=0;ut<et;ut++)rt[ut]=Tae(Ve,Ct);return rt})(ce,Ee.numValues,ve);return(function(Ve,et,Ct){switch(et.logicalLevelTechnique1){case Zi.DELTA:return et.logicalLevelTechnique2===Zi.RLE&&(Ve=HF(Ve,et.runs,et.numRleValues)),(function(rt){rt[0]=rt[0]%2==1?(rt[0]+1)/-2:rt[0]/2;const ut=rt.length/4*4;let Rt=1;if(ut>=4)for(;Rt<ut-4;Rt+=4){const Bt=rt[Rt],dr=rt[Rt+1],Or=rt[Rt+2],Pr=rt[Rt+3];rt[Rt]=(Bt%2==1?(Bt+1)/-2:Bt/2)+rt[Rt-1],rt[Rt+1]=(dr%2==1?(dr+1)/-2:dr/2)+rt[Rt],rt[Rt+2]=(Or%2==1?(Or+1)/-2:Or/2)+rt[Rt+1],rt[Rt+3]=(Pr%2==1?(Pr+1)/-2:Pr/2)+rt[Rt+2]}for(;Rt!=rt.length;++Rt)rt[Rt]=(rt[Rt]%2==1?(rt[Rt]+1)/-2:rt[Rt]/2)+rt[Rt-1]})(Ve),Ve;case Zi.RLE:return(function(rt,ut,Rt){return HF(rt,ut.runs,ut.numRleValues)})(Ve,et);case Zi.NONE:return Ve;default:throw new Error(`The specified Logical level technique is not supported: ${et.logicalLevelTechnique1}`)}})(ze,Ee)})(p,h,S);return new PC(v,ie,k)}const Z=YF(p,h,S,!1);return new KF(v,Z,k)}case ml.SEQUENCE:{const Z=XF(p,h,S);return new JF(v,Z[0],Z[1],S.numRleValues)}case ml.CONST:{const Z=ZF(p,h,S,!1);return new l8(v,Z,k)}}throw new Error("Vector type not supported for id column.")}class jae{constructor(l,h){var v;switch(this._featureData=l,this.properties=this._featureData.properties||{},(v=this._featureData.geometry)===null||v===void 0?void 0:v.type){case yl.POINT:case yl.MULTIPOINT:this.type=1;break;case yl.LINESTRING:case yl.MULTILINESTRING:this.type=2;break;case yl.POLYGON:case yl.MULTIPOLYGON:this.type=3;break;default:this.type=0}this.extent=h,this.id=Number(this._featureData.id)}loadGeometry(){const l=[];for(const h of this._featureData.geometry.coordinates){const v=[];for(const S of h)v.push(new c(S.x,S.y));l.push(v)}return l}}class Uae{constructor(l){this.features=[],this.featureTable=l,this.name=l.name,this.extent=l.extent,this.version=2,this.features=l.getFeatures(),this.length=this.features.length}feature(l){return new jae(this.features[l],this.extent)}}class p8{constructor(l){this.layers={};const h=(function(v,S,k=!0){const R=new Eae(0),B=[];for(;R.get()<v.length;){const V=Dl(v,R,1)[0]>>>0,Z=R.get()+V;if(Z>v.length)throw new Error(`Block overruns tile: ${Z} > ${v.length}`);if(Dl(v,R,1)[0]>>>0!=1){R.set(Z);continue}const ie=Bae(v,R),ce=ie[1],ve=ie[0].featureTables[0];let Ee=null,Ne=null;const ze=[];let Ve=0;for(const Ct of ve.columns){const rt=Ct.name;if(rt==="id"){let ut=null;if(Ct.nullable){const Bt=ju(v,R),dr=R.get(),Or=G_(v,Bt.numValues,R);R.set(dr+Bt.byteLength),ut=new ch(Or,Bt.numValues)}const Rt=ju(v,R);Ve=Rt.decompressedCount,Ee=zae(v,Ct,R,rt,Rt,ut??Ve,k)}else if(rt==="geometry"){const ut=Dl(v,R,1)[0];if(Ve===0){const Rt=R.get();Ve=ju(v,R).decompressedCount,R.set(Rt)}Ne=kae(v,ut,R,Ve)}else{const ut=Nae(Ct)?Dl(v,R,1)[0]:1;if(ut===0&&Ct.type==="scalarType")continue;const Rt=Oae(v,R,Ct,ut,Ve);if(Rt)if(Array.isArray(Rt))for(const Bt of Rt)ze.push(Bt);else ze.push(Rt)}}const et=new Sae(ve.name,Ne,Ee,ze,ce);B.push(et),R.set(Z)}return B})(new Uint8Array(l));this.layers=h.reduce(((v,S)=>Object.assign(Object.assign({},v),{[S.name]:new Uae(S)})),{})}}class Vae{constructor(l,h){this.feature=l,this.type=l.type,this.properties=l.tags?l.tags:{},this.extent=h,"id"in l&&(typeof l.id=="string"?this.id=parseInt(l.id,10):typeof l.id!="number"||isNaN(l.id)||(this.id=l.id))}loadGeometry(){const l=[],h=this.feature.type===1?[this.feature.geometry]:this.feature.geometry;for(const v of h){const S=[];for(const k of v)S.push(new c(k[0],k[1]));l.push(S)}return l}}const X_="_geojsonTileLayer";function $ae(p,l){l.writeVarintField(15,p.version||1),l.writeStringField(1,p.name||""),l.writeVarintField(5,p.extent||4096);const h={keys:[],values:[],keycache:{},valuecache:{}};for(let k=0;k<p.length;k++)h.feature=p.feature(k),l.writeMessage(2,qae,h);const v=h.keys;for(const k of v)l.writeStringField(3,k);const S=h.values;for(const k of S)l.writeMessage(4,Wae,k)}function qae(p,l){if(!p.feature)return;const h=p.feature;h.id!==void 0&&l.writeVarintField(1,h.id),l.writeMessage(2,Hae,p),l.writeVarintField(3,h.type),l.writeMessage(4,Gae,h)}function Hae(p,l){for(const h in p.feature?.properties){let v=p.feature.properties[h],S=p.keycache[h];if(v==null)continue;S===void 0&&(p.keys.push(h),S=p.keys.length-1,p.keycache[h]=S),l.writeVarint(S),typeof v!="string"&&typeof v!="boolean"&&typeof v!="number"&&(v=JSON.stringify(v));const k=typeof v+":"+v;let R=p.valuecache[k];R===void 0&&(p.values.push(v),R=p.values.length-1,p.valuecache[k]=R),l.writeVarint(R)}}function $C(p,l){return(l<<3)+(7&p)}function g8(p){return p<<1^p>>31}function Gae(p,l){const h=p.loadGeometry(),v=p.type;let S=0,k=0;for(const R of h){let B=1;v===1&&(B=R.length),l.writeVarint($C(1,B));const V=v===3?R.length-1:R.length;for(let Z=0;Z<V;Z++){Z===1&&v!==1&&l.writeVarint($C(2,V-1));const ie=R[Z].x-S,ce=R[Z].y-k;l.writeVarint(g8(ie)),l.writeVarint(g8(ce)),S+=ie,k+=ce}p.type===3&&l.writeVarint($C(7,1))}}function Wae(p,l){const h=typeof p;h==="string"?l.writeStringField(1,p):h==="boolean"?l.writeBooleanField(7,p):h==="number"&&(p%1!=0?l.writeDoubleField(3,p):p<0?l.writeSVarintField(6,p):l.writeVarintField(5,p))}class m8{constructor(l,h){this.tileID=l,this.x=l.canonical.x,this.y=l.canonical.y,this.z=l.canonical.z,this.grid=new br(Te,16,0),this.grid3D=new br(Te,16,0),this.featureIndexArray=new Ze,this.promoteId=h}insert(l,h,v,S,k,R){const B=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(v,S,k);const V=R?this.grid3D:this.grid;for(let Z=0;Z<h.length;Z++){const ie=h[Z],ce=[1/0,1/0,-1/0,-1/0];for(let ve=0;ve<ie.length;ve++){const Ee=ie[ve];ce[0]=Math.min(ce[0],Ee.x),ce[1]=Math.min(ce[1],Ee.y),ce[2]=Math.max(ce[2],Ee.x),ce[3]=Math.max(ce[3],Ee.y)}ce[0]<Te&&ce[1]<Te&&ce[2]>=0&&ce[3]>=0&&V.insert(B,ce[0],ce[1],ce[2],ce[3])}}loadVTLayers(){return this.vtLayers||(this.vtLayers=this.encoding!=="mlt"?new tF(new b2(this.rawTileData)).layers:new p8(this.rawTileData).layers,this.sourceLayerCoder=new BF(this.vtLayers?Object.keys(this.vtLayers).sort():[X_])),this.vtLayers}query(l,h,v,S){this.loadVTLayers();const k=l.params,R=Te/l.tileSize/l.scale,B=ih(k.filter,k.globalState),V=l.queryGeometry,Z=l.queryPadding*R,ie=nm.fromPoints(V),ce=this.grid.query(ie.minX-Z,ie.minY-Z,ie.maxX+Z,ie.maxY+Z),ve=nm.fromPoints(l.cameraQueryGeometry).expandBy(Z),Ee=this.grid3D.query(ve.minX,ve.minY,ve.maxX,ve.maxY,((Ve,et,Ct,rt)=>(function(ut,Rt,Bt,dr,Or){for(const Vr of ut)if(Rt<=Vr.x&&Bt<=Vr.y&&dr>=Vr.x&&Or>=Vr.y)return!0;const Pr=[new c(Rt,Bt),new c(Rt,Or),new c(dr,Or),new c(dr,Bt)];if(ut.length>2){for(const Vr of Pr)if(Hy(ut,Vr))return!0}for(let Vr=0;Vr<ut.length-1;Vr++)if(Yne(ut[Vr],ut[Vr+1],Pr))return!0;return!1})(l.cameraQueryGeometry,Ve-Z,et-Z,Ct+Z,rt+Z)));for(const Ve of Ee)ce.push(Ve);ce.sort(Xae);const Ne={};let ze;for(let Ve=0;Ve<ce.length;Ve++){const et=ce[Ve];if(et===ze)continue;ze=et;const Ct=this.featureIndexArray.get(et);let rt=null;this.loadMatchingFeature(Ne,Ct.bucketIndex,Ct.sourceLayerIndex,Ct.featureIndex,B,k.layers,k.availableImages,h,v,S,((ut,Rt,Bt)=>(rt||(rt=Kh(ut)),Rt.queryIntersectsFeature({queryGeometry:V,feature:ut,featureState:Bt,geometry:rt,zoom:this.z,transform:l.transform,pixelsToTileUnits:R,pixelPosMatrix:l.pixelPosMatrix,unwrappedTileID:this.tileID.toUnwrapped(),getElevation:l.getElevation}))))}return Ne}loadMatchingFeature(l,h,v,S,k,R,B,V,Z,ie,ce){const ve=this.bucketLayerIDs[h];if(R&&!ve.some((Ve=>R.has(Ve))))return;const Ee=this.sourceLayerCoder.decode(v),Ne=this.vtLayers[Ee].feature(S);if(k.needGeometry){const Ve=Jh(Ne,!0);if(!k.filter(new ki(this.tileID.overscaledZ),Ve,this.tileID.canonical))return}else if(!k.filter(new ki(this.tileID.overscaledZ),Ne))return;const ze=this.getId(Ne,Ee);for(let Ve=0;Ve<ve.length;Ve++){const et=ve[Ve];if(R&&!R.has(et))continue;const Ct=V[et];if(!Ct)continue;let rt={};ze&&ie&&(rt=ie.getState(Ct.sourceLayer||X_,ze));const ut=Be({},Z[et]);ut.paint=y8(ut.paint,Ct.paint,Ne,rt,B),ut.layout=y8(ut.layout,Ct.layout,Ne,rt,B);const Rt=!ce||ce(Ne,Ct,rt);if(!Rt)continue;const Bt=new zF(Ne,this.z,this.x,this.y,ze);Bt.layer=ut;let dr=l[et];dr===void 0&&(dr=l[et]=[]),dr.push({featureIndex:S,feature:Bt,intersectionZ:Rt})}}lookupSymbolFeatures(l,h,v,S,k,R,B,V){const Z={};this.loadVTLayers();const ie=ih(k.filterSpec,k.globalState);for(const ce of l)this.loadMatchingFeature(Z,v,S,ce,ie,R,B,V,h);return Z}hasLayer(l){for(const h of this.bucketLayerIDs)for(const v of h)if(l===v)return!0;return!1}getId(l,h){var v;let S=l.id;return this.promoteId&&(S=l.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[h]],typeof S=="boolean"&&(S=Number(S)),S===void 0&&(!((v=l.properties)===null||v===void 0)&&v.cluster)&&this.promoteId&&(S=Number(l.properties.cluster_id))),S}}function y8(p,l,h,v,S){return Qe(p,((k,R)=>{const B=l instanceof Wo?l.get(R):null;return B&&B.evaluate?B.evaluate(h,v,S):B}))}function Xae(p,l){return l-p}function v8(p,l,h,v,S){const k=[];for(let R=0;R<p.length;R++){const B=p[R];let V;for(let Z=0;Z<B.length-1;Z++){let ie=B[Z],ce=B[Z+1];ie.x<l&&ce.x<l||(ie.x<l?ie=new c(l,ie.y+(l-ie.x)/(ce.x-ie.x)*(ce.y-ie.y))._round():ce.x<l&&(ce=new c(l,ie.y+(l-ie.x)/(ce.x-ie.x)*(ce.y-ie.y))._round()),ie.y<h&&ce.y<h||(ie.y<h?ie=new c(ie.x+(h-ie.y)/(ce.y-ie.y)*(ce.x-ie.x),h)._round():ce.y<h&&(ce=new c(ie.x+(h-ie.y)/(ce.y-ie.y)*(ce.x-ie.x),h)._round()),ie.x>=v&&ce.x>=v||(ie.x>=v?ie=new c(v,ie.y+(v-ie.x)/(ce.x-ie.x)*(ce.y-ie.y))._round():ce.x>=v&&(ce=new c(v,ie.y+(v-ie.x)/(ce.x-ie.x)*(ce.y-ie.y))._round()),ie.y>=S&&ce.y>=S||(ie.y>=S?ie=new c(ie.x+(S-ie.y)/(ce.y-ie.y)*(ce.x-ie.x),S)._round():ce.y>=S&&(ce=new c(ie.x+(S-ie.y)/(ce.y-ie.y)*(ce.x-ie.x),S)._round()),V&&ie.equals(V[V.length-1])||(V=[ie],k.push(V)),V.push(ce)))))}}return k}function _8(p,l,h,v,S){switch(l){case 1:return(function(k,R,B,V){const Z=[];for(const ie of k)for(const ce of ie){const ve=V===0?ce.x:ce.y;ve>=R&&ve<=B&&Z.push([ce])}return Z})(p,h,v,S);case 2:return b8(p,h,v,S,!1);case 3:return b8(p,h,v,S,!0)}return[]}function Yae(p,l,h,v,S){const k=v===0?Zae:Kae;let R=[];const B=[];for(let ie=0;ie<p.length-1;ie++){const ce=p[ie],ve=p[ie+1],Ee=v===0?ce.x:ce.y,Ne=v===0?ve.x:ve.y;let ze=!1;Ee<l?Ne>l&&R.push(k(ce,ve,l)):Ee>h?Ne<h&&R.push(k(ce,ve,h)):R.push(ce),Ne<l&&Ee>=l&&(R.push(k(ce,ve,l)),ze=!0),Ne>h&&Ee<=h&&(R.push(k(ce,ve,h)),ze=!0),!S&&ze&&(B.push(R),R=[])}const V=p.length-1,Z=v===0?p[V].x:p[V].y;return Z>=l&&Z<=h&&R.push(p[V]),S&&R.length>0&&!R[0].equals(R[R.length-1])&&R.push(new c(R[0].x,R[0].y)),R.length>0&&B.push(R),B}function b8(p,l,h,v,S){const k=[];for(const R of p){const B=Yae(R,l,h,v,S);B.length>0&&k.push(...B)}return k}function Zae(p,l,h){return new c(h,p.y+(h-p.x)/(l.x-p.x)*(l.y-p.y))}function Kae(p,l,h){return new c(p.x+(h-p.y)/(l.y-p.y)*(l.x-p.x),h)}Pt("FeatureIndex",m8,{omit:["rawTileData","sourceLayerCoder"]});class Yp extends c{constructor(l,h,v,S){super(l,h),this.angle=v,S!==void 0&&(this.segment=S)}clone(){return new Yp(this.x,this.y,this.angle,this.segment)}}function x8(p,l,h,v,S){if(l.segment===void 0||h===0)return!0;let k=l,R=l.segment+1,B=0;for(;B>-h/2;){if(R--,R<0)return!1;B-=p[R].dist(k),k=p[R]}B+=p[R].dist(p[R+1]),R++;const V=[];let Z=0;for(;B<h/2;){const ie=p[R],ce=p[R+1];if(!ce)return!1;let ve=p[R-1].angleTo(ie)-ie.angleTo(ce);for(ve=Math.abs((ve+3*Math.PI)%(2*Math.PI)-Math.PI),V.push({distance:B,angleDelta:ve}),Z+=ve;B-V[0].distance>v;)Z-=V.shift().angleDelta;if(Z>S)return!1;R++,B+=ie.dist(ce)}return!0}function w8(p){let l=0;for(let h=0;h<p.length-1;h++)l+=p[h].dist(p[h+1]);return l}function S8(p,l,h){return p?.6*l*h:0}function E8(p,l){return Math.max(p?p.right-p.left:0,l?l.right-l.left:0)}function Jae(p,l,h,v,S,k){const R=S8(h,S,k),B=E8(h,v)*k;let V=0;const Z=w8(p)/2;for(let ie=0;ie<p.length-1;ie++){const ce=p[ie],ve=p[ie+1],Ee=ce.dist(ve);if(V+Ee>Z){const Ne=(Z-V)/Ee,ze=Hn.number(ce.x,ve.x,Ne),Ve=Hn.number(ce.y,ve.y,Ne),et=new Yp(ze,Ve,ve.angleTo(ce),ie);return et._round(),!R||x8(p,et,B,R,l)?et:void 0}V+=Ee}}function Qae(p,l,h,v,S,k,R,B,V){const Z=S8(v,k,R),ie=E8(v,S),ce=ie*R,ve=p[0].x===0||p[0].x===V||p[0].y===0||p[0].y===V;return l-ce<l/4&&(l=ce+l/4),T8(p,ve?l/2*B%l:(ie/2+2*k)*R*B%l,l,Z,h,ce,ve,!1,V)}function T8(p,l,h,v,S,k,R,B,V){const Z=k/2,ie=w8(p);let ce=0,ve=l-h,Ee=[];for(let Ne=0;Ne<p.length-1;Ne++){const ze=p[Ne],Ve=p[Ne+1],et=ze.dist(Ve),Ct=Ve.angleTo(ze);for(;ve+h<ce+et;){ve+=h;const rt=(ve-ce)/et,ut=Hn.number(ze.x,Ve.x,rt),Rt=Hn.number(ze.y,Ve.y,rt);if(ut>=0&&ut<V&&Rt>=0&&Rt<V&&ve-Z>=0&&ve+Z<=ie){const Bt=new Yp(ut,Rt,Ct,Ne);Bt._round(),v&&!x8(p,Bt,k,v,S)||Ee.push(Bt)}}ce+=et}return B||Ee.length||R||(Ee=T8(p,ce/2,h,v,S,k,R,!0,V)),Ee}function C8(p,l,h,v){const S=[],k=p.image,R=k.pixelRatio,B=k.paddedRect.w-2,V=k.paddedRect.h-2;let Z={x1:p.left,y1:p.top,x2:p.right,y2:p.bottom};const ie=k.stretchX||[[0,B]],ce=k.stretchY||[[0,V]],ve=(Tr,Cn)=>Tr+Cn[1]-Cn[0],Ee=ie.reduce(ve,0),Ne=ce.reduce(ve,0),ze=B-Ee,Ve=V-Ne;let et=0,Ct=Ee,rt=0,ut=Ne,Rt=0,Bt=ze,dr=0,Or=Ve;if(k.content&&v){const Tr=k.content,Cn=Tr[2]-Tr[0],xn=Tr[3]-Tr[1];(k.textFitWidth||k.textFitHeight)&&(Z=xF(p)),et=M2(ie,0,Tr[0]),rt=M2(ce,0,Tr[1]),Ct=M2(ie,Tr[0],Tr[2]),ut=M2(ce,Tr[1],Tr[3]),Rt=Tr[0]-et,dr=Tr[1]-rt,Bt=Cn-Ct,Or=xn-ut}const Pr=Z.x1,Vr=Z.y1,pn=Z.x2-Pr,Wr=Z.y2-Vr,Rr=(Tr,Cn,xn,kn)=>{const vn=D2(Tr.stretch-et,Ct,pn,Pr),Gn=O2(Tr.fixed-Rt,Bt,Tr.stretch,Ee),la=D2(Cn.stretch-rt,ut,Wr,Vr),Hi=O2(Cn.fixed-dr,Or,Cn.stretch,Ne),Po=D2(xn.stretch-et,Ct,pn,Pr),Ql=O2(xn.fixed-Rt,Bt,xn.stretch,Ee),Ms=D2(kn.stretch-rt,ut,Wr,Vr),ko=O2(kn.fixed-dr,Or,kn.stretch,Ne),vo=new c(vn,la),Ta=new c(Po,la),Yo=new c(Po,Ms),os=new c(vn,Ms),uo=new c(Gn/R,Hi/R),uc=new c(Ql/R,ko/R),eu=l*Math.PI/180;if(eu){const vl=Math.sin(eu),Fo=Math.cos(eu),Ds=[Fo,-vl,vl,Fo];vo._matMult(Ds),Ta._matMult(Ds),os._matMult(Ds),Yo._matMult(Ds)}const cc=Tr.stretch+Tr.fixed,Pf=Cn.stretch+Cn.fixed;return{tl:vo,tr:Ta,bl:os,br:Yo,tex:{x:k.paddedRect.x+1+cc,y:k.paddedRect.y+1+Pf,w:xn.stretch+xn.fixed-cc,h:kn.stretch+kn.fixed-Pf},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:uo,pixelOffsetBR:uc,minFontScaleX:Bt/R/pn,minFontScaleY:Or/R/Wr,isSDF:h}};if(v&&(k.stretchX||k.stretchY)){const Tr=A8(ie,ze,Ee),Cn=A8(ce,Ve,Ne);for(let xn=0;xn<Tr.length-1;xn++){const kn=Tr[xn],vn=Tr[xn+1];for(let Gn=0;Gn<Cn.length-1;Gn++)S.push(Rr(kn,Cn[Gn],vn,Cn[Gn+1]))}}else S.push(Rr({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:B+1},{fixed:0,stretch:V+1}));return S}function M2(p,l,h){let v=0;for(const S of p)v+=Math.max(l,Math.min(h,S[1]))-Math.max(l,Math.min(h,S[0]));return v}function A8(p,l,h){const v=[{fixed:-1,stretch:0}];for(const[S,k]of p){const R=v[v.length-1];v.push({fixed:S-R.stretch,stretch:R.stretch}),v.push({fixed:S-R.stretch,stretch:R.stretch+(k-S)})}return v.push({fixed:l+1,stretch:h}),v}function D2(p,l,h,v){return p/l*h+v}function O2(p,l,h,v){return p-l*h/v}Pt("Anchor",Yp);class N2{constructor(l,h,v,S,k,R,B,V,Z,ie){var ce;if(this.boxStartIndex=l.length,Z){let ve=R.top,Ee=R.bottom;const Ne=R.collisionPadding;Ne&&(ve-=Ne[1],Ee+=Ne[3]);let ze=Ee-ve;ze>0&&(ze=Math.max(10,ze),this.circleDiameter=ze)}else{const ve=!((ce=R.image)===null||ce===void 0)&&ce.content&&(R.image.textFitWidth||R.image.textFitHeight)?xF(R):{x1:R.left,y1:R.top,x2:R.right,y2:R.bottom};ve.y1=ve.y1*B-V[0],ve.y2=ve.y2*B+V[2],ve.x1=ve.x1*B-V[3],ve.x2=ve.x2*B+V[1];const Ee=R.collisionPadding;if(Ee&&(ve.x1-=Ee[0]*B,ve.y1-=Ee[1]*B,ve.x2+=Ee[2]*B,ve.y2+=Ee[3]*B),ie){const Ne=new c(ve.x1,ve.y1),ze=new c(ve.x2,ve.y1),Ve=new c(ve.x1,ve.y2),et=new c(ve.x2,ve.y2),Ct=ie*Math.PI/180;Ne._rotate(Ct),ze._rotate(Ct),Ve._rotate(Ct),et._rotate(Ct),ve.x1=Math.min(Ne.x,ze.x,Ve.x,et.x),ve.x2=Math.max(Ne.x,ze.x,Ve.x,et.x),ve.y1=Math.min(Ne.y,ze.y,Ve.y,et.y),ve.y2=Math.max(Ne.y,ze.y,Ve.y,et.y)}l.emplaceBack(h.x,h.y,ve.x1,ve.y1,ve.x2,ve.y2,v,S,k)}this.boxEndIndex=l.length}}class eoe{constructor(l=[],h=(v,S)=>v<S?-1:v>S?1:0){if(this.data=l,this.length=this.data.length,this.compare=h,this.length>0)for(let v=(this.length>>1)-1;v>=0;v--)this._down(v)}push(l){this.data.push(l),this._up(this.length++)}pop(){if(this.length===0)return;const l=this.data[0],h=this.data.pop();return--this.length>0&&(this.data[0]=h,this._down(0)),l}peek(){return this.data[0]}_up(l){const{data:h,compare:v}=this,S=h[l];for(;l>0;){const k=l-1>>1,R=h[k];if(v(S,R)>=0)break;h[l]=R,l=k}h[l]=S}_down(l){const{data:h,compare:v}=this,S=this.length>>1,k=h[l];for(;l<S;){let R=1+(l<<1);const B=R+1;if(B<this.length&&v(h[B],h[R])<0&&(R=B),v(h[R],k)>=0)break;h[l]=h[R],l=R}h[l]=k}}function toe(p,l=1,h=!1){const v=nm.fromPoints(p[0]),S=Math.min(v.width(),v.height());let k=S/2;const R=new eoe([],roe),{minX:B,minY:V,maxX:Z,maxY:ie}=v;if(S===0)return new c(B,V);for(let Ee=B;Ee<Z;Ee+=S)for(let Ne=V;Ne<ie;Ne+=S)R.push(new iv(Ee+k,Ne+k,k,p));let ce=(function(Ee){let Ne=0,ze=0,Ve=0;const et=Ee[0];for(let Ct=0,rt=et.length,ut=rt-1;Ct<rt;ut=Ct++){const Rt=et[Ct],Bt=et[ut],dr=Rt.x*Bt.y-Bt.x*Rt.y;ze+=(Rt.x+Bt.x)*dr,Ve+=(Rt.y+Bt.y)*dr,Ne+=3*dr}return new iv(ze/Ne,Ve/Ne,0,Ee)})(p),ve=R.length;for(;R.length;){const Ee=R.pop();(Ee.d>ce.d||!ce.d)&&(ce=Ee,h&&console.log("found best %d after %d probes",Math.round(1e4*Ee.d)/1e4,ve)),Ee.max-ce.d<=l||(k=Ee.h/2,R.push(new iv(Ee.p.x-k,Ee.p.y-k,k,p)),R.push(new iv(Ee.p.x+k,Ee.p.y-k,k,p)),R.push(new iv(Ee.p.x-k,Ee.p.y+k,k,p)),R.push(new iv(Ee.p.x+k,Ee.p.y+k,k,p)),ve+=4)}return h&&(console.log(`num probes: ${ve}`),console.log(`best distance: ${ce.d}`)),ce.p}function roe(p,l){return l.max-p.max}function iv(p,l,h,v){this.p=new c(p,l),this.h=h,this.d=(function(S,k){let R=!1,B=1/0;for(let V=0;V<k.length;V++){const Z=k[V];for(let ie=0,ce=Z.length,ve=ce-1;ie<ce;ve=ie++){const Ee=Z[ie],Ne=Z[ve];Ee.y>S.y!=Ne.y>S.y&&S.x<(Ne.x-Ee.x)*(S.y-Ee.y)/(Ne.y-Ee.y)+Ee.x&&(R=!R),B=Math.min(B,M6(S,Ee,Ne))}}return(R?1:-1)*Math.sqrt(B)})(this.p,v),this.max=this.d+this.h*Math.SQRT2}var Jl;s.aP=void 0,(Jl=s.aP||(s.aP={}))[Jl.center=1]="center",Jl[Jl.left=2]="left",Jl[Jl.right=3]="right",Jl[Jl.top=4]="top",Jl[Jl.bottom=5]="bottom",Jl[Jl["top-left"]=6]="top-left",Jl[Jl["top-right"]=7]="top-right",Jl[Jl["bottom-left"]=8]="bottom-left",Jl[Jl["bottom-right"]=9]="bottom-right";const qC=Number.POSITIVE_INFINITY;function I8(p,l){return l[1]!==qC?(function(h,v,S){let k=0,R=0;switch(v=Math.abs(v),S=Math.abs(S),h){case"top-right":case"top-left":case"top":R=S-7;break;case"bottom-right":case"bottom-left":case"bottom":R=7-S}switch(h){case"top-right":case"bottom-right":case"right":k=-v;break;case"top-left":case"bottom-left":case"left":k=v}return[k,R]})(p,l[0],l[1]):(function(h,v){let S=0,k=0;v<0&&(v=0);const R=v/Math.SQRT2;switch(h){case"top-right":case"top-left":k=R-7;break;case"bottom-right":case"bottom-left":k=7-R;break;case"bottom":k=7-v;break;case"top":k=v-7}switch(h){case"top-right":case"bottom-right":S=-R;break;case"top-left":case"bottom-left":S=R;break;case"left":S=v;break;case"right":S=-v}return[S,k]})(p,l[0])}function P8(p,l,h){var v;const S=p.layout,k=(v=S.get("text-variable-anchor-offset"))===null||v===void 0?void 0:v.evaluate(l,{},h);if(k){const B=k.values,V=[];for(let Z=0;Z<B.length;Z+=2){const ie=V[Z]=B[Z],ce=B[Z+1].map((ve=>ve*gl));ie.startsWith("top")?ce[1]-=7:ie.startsWith("bottom")&&(ce[1]+=7),V[Z+1]=ce}return new ba(V)}const R=S.get("text-variable-anchor");if(R){let B;B=p._unevaluatedLayout.getValue("text-radial-offset")!==void 0?[S.get("text-radial-offset").evaluate(l,{},h)*gl,qC]:S.get("text-offset").evaluate(l,{},h).map((Z=>Z*gl));const V=[];for(const Z of R)V.push(Z,I8(Z,B));return new ba(V)}return null}function HC(p){switch(p){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function noe(p,l,h,v,S,k,R,B,V,Z,ie,ce){let ve=k.textMaxSize.evaluate(l,{});ve===void 0&&(ve=R);const Ee=p.layers[0].layout,Ne=Ee.get("icon-offset").evaluate(l,{},ie),ze=R8(h.horizontal),Ve=R/24,et=p.tilePixelRatio*Ve,Ct=p.tilePixelRatio*ve/24,rt=p.tilePixelRatio*B,ut=p.tilePixelRatio*Ee.get("symbol-spacing"),Rt=Ee.get("text-padding")*p.tilePixelRatio,Bt=(function(xn,kn,vn,Gn=1){const la=xn.get("icon-padding").evaluate(kn,{},vn),Hi=la&&la.values;return[Hi[0]*Gn,Hi[1]*Gn,Hi[2]*Gn,Hi[3]*Gn]})(Ee,l,ie,p.tilePixelRatio),dr=Ee.get("text-max-angle")/180*Math.PI,Or=Ee.get("text-rotation-alignment")!=="viewport"&&Ee.get("symbol-placement")!=="point",Pr=Ee.get("icon-rotation-alignment")==="map"&&Ee.get("symbol-placement")!=="point",Vr=Ee.get("symbol-placement"),pn=ut/2,Wr=Ee.get("icon-text-fit");let Rr;v&&Wr!=="none"&&(p.allowVerticalPlacement&&h.vertical&&(Rr=wF(v,h.vertical,Wr,Ee.get("icon-text-fit-padding"),Ne,Ve)),ze&&(v=wF(v,ze,Wr,Ee.get("icon-text-fit-padding"),Ne,Ve)));const Tr=ie?ce.line.getGranularityForZoomLevel(ie.z):1,Cn=(xn,kn)=>{kn.x<0||kn.x>=Te||kn.y<0||kn.y>=Te||(function(vn,Gn,la,Hi,Po,Ql,Ms,ko,vo,Ta,Yo,os,uo,uc,eu,cc,Pf,vl,Fo,Ds,Zo,_l,Xd,fh,K_){const Zp=vn.addToLineVertexArray(Gn,la);let om,av,ov,sv,N8=0,L8=0,F8=0,B8=0,QC=-1,eA=-1;const Yd={};let z8=as("");if(vn.allowVerticalPlacement&&Hi.vertical){const vu=ko.layout.get("text-rotate").evaluate(Zo,{},fh)+90;ov=new N2(vo,Gn,Ta,Yo,os,Hi.vertical,uo,uc,eu,vu),Ms&&(sv=new N2(vo,Gn,Ta,Yo,os,Ms,Pf,vl,eu,vu))}if(Po){const vu=ko.layout.get("icon-rotate").evaluate(Zo,{}),Jc=ko.layout.get("icon-text-fit")!=="none",sm=C8(Po,vu,Xd,Jc),dh=Ms?C8(Ms,vu,Xd,Jc):void 0;av=new N2(vo,Gn,Ta,Yo,os,Po,Pf,vl,!1,vu),N8=4*sm.length;const lm=vn.iconSizeData;let Qh=null;lm.kind==="source"?(Qh=[Gd*ko.layout.get("icon-size").evaluate(Zo,{})],Qh[0]>Gp&&at(`${vn.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)):lm.kind==="composite"&&(Qh=[Gd*_l.compositeIconSizes[0].evaluate(Zo,{},fh),Gd*_l.compositeIconSizes[1].evaluate(Zo,{},fh)],(Qh[0]>Gp||Qh[1]>Gp)&&at(`${vn.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)),vn.addSymbols(vn.icon,sm,Qh,Ds,Fo,Zo,s.az.none,Gn,Zp.lineStartIndex,Zp.lineLength,-1,fh),QC=vn.icon.placedSymbolArray.length-1,dh&&(L8=4*dh.length,vn.addSymbols(vn.icon,dh,Qh,Ds,Fo,Zo,s.az.vertical,Gn,Zp.lineStartIndex,Zp.lineLength,-1,fh),eA=vn.icon.placedSymbolArray.length-1)}const j8=Object.keys(Hi.horizontal);for(const vu of j8){const Jc=Hi.horizontal[vu];if(!om){z8=as(Jc.text);const dh=ko.layout.get("text-rotate").evaluate(Zo,{},fh);om=new N2(vo,Gn,Ta,Yo,os,Jc,uo,uc,eu,dh)}const sm=Jc.positionedLines.length===1;if(F8+=k8(vn,Gn,Jc,Ql,ko,eu,Zo,cc,Zp,Hi.vertical?s.az.horizontal:s.az.horizontalOnly,sm?j8:[vu],Yd,QC,_l,fh),sm)break}Hi.vertical&&(B8+=k8(vn,Gn,Hi.vertical,Ql,ko,eu,Zo,cc,Zp,s.az.vertical,["vertical"],Yd,eA,_l,fh));const ooe=om?om.boxStartIndex:vn.collisionBoxArray.length,soe=om?om.boxEndIndex:vn.collisionBoxArray.length,loe=ov?ov.boxStartIndex:vn.collisionBoxArray.length,uoe=ov?ov.boxEndIndex:vn.collisionBoxArray.length,coe=av?av.boxStartIndex:vn.collisionBoxArray.length,foe=av?av.boxEndIndex:vn.collisionBoxArray.length,hoe=sv?sv.boxStartIndex:vn.collisionBoxArray.length,doe=sv?sv.boxEndIndex:vn.collisionBoxArray.length;let hh=-1;const F2=(vu,Jc)=>vu&&vu.circleDiameter?Math.max(vu.circleDiameter,Jc):Jc;hh=F2(om,hh),hh=F2(ov,hh),hh=F2(av,hh),hh=F2(sv,hh);const U8=hh>-1?1:0;U8&&(hh*=K_/gl),vn.glyphOffsetArray.length>=Jy.MAX_GLYPHS&&at("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),Zo.sortKey!==void 0&&vn.addToSortKeyRanges(vn.symbolInstances.length,Zo.sortKey);const poe=P8(ko,Zo,fh),[goe,moe]=(function(vu,Jc){const sm=vu.length,dh=Jc?.values;if(dh?.length>0)for(let lm=0;lm<dh.length;lm+=2){const Qh=dh[lm+1];vu.emplaceBack(s.aP[dh[lm]],Qh[0],Qh[1])}return[sm,vu.length]})(vn.textAnchorOffsets,poe);vn.symbolInstances.emplaceBack(Gn.x,Gn.y,Yd.right>=0?Yd.right:-1,Yd.center>=0?Yd.center:-1,Yd.left>=0?Yd.left:-1,Yd.vertical||-1,QC,eA,z8,ooe,soe,loe,uoe,coe,foe,hoe,doe,Ta,F8,B8,N8,L8,U8,0,uo,hh,goe,moe)})(p,kn,xn,h,v,S,Rr,p.layers[0],p.collisionBoxArray,l.index,l.sourceLayerIndex,p.index,et,[Rt,Rt,Rt,Rt],Or,V,rt,Bt,Pr,Ne,l,k,Z,ie,R)};if(Vr==="line")for(const xn of v8(l.geometry,0,0,Te,Te)){const kn=rm(xn,Tr),vn=Qae(kn,ut,dr,h.vertical||ze,v,24,Ct,p.overscaling,Te);for(const Gn of vn)ze&&ioe(p,ze.text,pn,Gn)||Cn(kn,Gn)}else if(Vr==="line-center"){for(const xn of l.geometry)if(xn.length>1){const kn=rm(xn,Tr),vn=Jae(kn,dr,h.vertical||ze,v,24,Ct);vn&&Cn(kn,vn)}}else if(l.type==="Polygon")for(const xn of Vl(l.geometry,0)){const kn=toe(xn,16);Cn(rm(xn[0],Tr,!0),new Yp(kn.x,kn.y,0))}else if(l.type==="LineString")for(const xn of l.geometry){const kn=rm(xn,Tr);Cn(kn,new Yp(kn[0].x,kn[0].y,0))}else if(l.type==="Point")for(const xn of l.geometry)for(const kn of xn)Cn([kn],new Yp(kn.x,kn.y,0))}function k8(p,l,h,v,S,k,R,B,V,Z,ie,ce,ve,Ee,Ne){const ze=(function(Ct,rt,ut,Rt,Bt,dr,Or,Pr){const Vr=Rt.layout.get("text-rotate").evaluate(dr,{})*Math.PI/180,pn=[];for(const Wr of rt.positionedLines)for(const Rr of Wr.positionedGlyphs){if(!Rr.rect)continue;const Tr=Rr.rect||{};let Cn=4,xn=!0,kn=1,vn=0;const Gn=(Bt||Pr)&&Rr.vertical,la=Rr.metrics.advance*Rr.scale/2;if(Pr&&rt.verticalizable&&(vn=Wr.lineOffset/2-(Rr.imageName?-(gl-Rr.metrics.width*Rr.scale)/2:(Rr.scale-1)*gl)),Rr.imageName){const vl=Or[Rr.imageName];xn=vl.sdf,kn=vl.pixelRatio,Cn=1/kn}const Hi=Bt?[Rr.x+la,Rr.y]:[0,0];let Po=Bt?[0,0]:[Rr.x+la+ut[0],Rr.y+ut[1]-vn],Ql=[0,0];Gn&&(Ql=Po,Po=[0,0]);const Ms=Rr.metrics.isDoubleResolution?2:1,ko=(Rr.metrics.left-Cn)*Rr.scale-la+Po[0],vo=(-Rr.metrics.top-Cn)*Rr.scale+Po[1],Ta=ko+Tr.w/Ms*Rr.scale/kn,Yo=vo+Tr.h/Ms*Rr.scale/kn,os=new c(ko,vo),uo=new c(Ta,vo),uc=new c(ko,Yo),eu=new c(Ta,Yo);if(Gn){const vl=new c(-la,la- -17),Fo=-Math.PI/2,Ds=12-la,Zo=new c(22-Ds,-(Rr.imageName?Ds:0)),_l=new c(...Ql);os._rotateAround(Fo,vl)._add(Zo)._add(_l),uo._rotateAround(Fo,vl)._add(Zo)._add(_l),uc._rotateAround(Fo,vl)._add(Zo)._add(_l),eu._rotateAround(Fo,vl)._add(Zo)._add(_l)}if(Vr){const vl=Math.sin(Vr),Fo=Math.cos(Vr),Ds=[Fo,-vl,vl,Fo];os._matMult(Ds),uo._matMult(Ds),uc._matMult(Ds),eu._matMult(Ds)}const cc=new c(0,0),Pf=new c(0,0);pn.push({tl:os,tr:uo,bl:uc,br:eu,tex:Tr,writingMode:rt.writingMode,glyphOffset:Hi,sectionIndex:Rr.sectionIndex,isSDF:xn,pixelOffsetTL:cc,pixelOffsetBR:Pf,minFontScaleX:0,minFontScaleY:0})}return pn})(0,h,B,S,k,R,v,p.allowVerticalPlacement),Ve=p.textSizeData;let et=null;Ve.kind==="source"?(et=[Gd*S.layout.get("text-size").evaluate(R,{})],et[0]>Gp&&at(`${p.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)):Ve.kind==="composite"&&(et=[Gd*Ee.compositeTextSizes[0].evaluate(R,{},Ne),Gd*Ee.compositeTextSizes[1].evaluate(R,{},Ne)],(et[0]>Gp||et[1]>Gp)&&at(`${p.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)),p.addSymbols(p.text,ze,et,B,k,R,Z,l,V.lineStartIndex,V.lineLength,ve,Ne);for(const Ct of ie)ce[Ct]=p.text.placedSymbolArray.length-1;return 4*ze.length}function R8(p){for(const l in p)return p[l];return null}function ioe(p,l,h,v){const S=p.compareText;if(l in S){const k=S[l];for(let R=k.length-1;R>=0;R--)if(v.dist(k[R])<h)return!0}else S[l]=[];return S[l].push(v),!1}const M8=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class GC{static from(l){if(!(l instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[h,v]=new Uint8Array(l,0,2);if(h!==219)throw new Error("Data does not appear to be in a KDBush format.");const S=v>>4;if(S!==1)throw new Error(`Got v${S} data when expected v1.`);const k=M8[15&v];if(!k)throw new Error("Unrecognized array type.");const[R]=new Uint16Array(l,2,1),[B]=new Uint32Array(l,4,1);return new GC(B,R,k,l)}constructor(l,h=64,v=Float64Array,S){if(isNaN(l)||l<0)throw new Error(`Unpexpected numItems value: ${l}.`);this.numItems=+l,this.nodeSize=Math.min(Math.max(+h,2),65535),this.ArrayType=v,this.IndexArrayType=l<65536?Uint16Array:Uint32Array;const k=M8.indexOf(this.ArrayType),R=2*l*this.ArrayType.BYTES_PER_ELEMENT,B=l*this.IndexArrayType.BYTES_PER_ELEMENT,V=(8-B%8)%8;if(k<0)throw new Error(`Unexpected typed array class: ${v}.`);S&&S instanceof ArrayBuffer?(this.data=S,this.ids=new this.IndexArrayType(this.data,8,l),this.coords=new this.ArrayType(this.data,8+B+V,2*l),this._pos=2*l,this._finished=!0):(this.data=new ArrayBuffer(8+R+B+V),this.ids=new this.IndexArrayType(this.data,8,l),this.coords=new this.ArrayType(this.data,8+B+V,2*l),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+k]),new Uint16Array(this.data,2,1)[0]=h,new Uint32Array(this.data,4,1)[0]=l)}add(l,h){const v=this._pos>>1;return this.ids[v]=v,this.coords[this._pos++]=l,this.coords[this._pos++]=h,v}finish(){const l=this._pos>>1;if(l!==this.numItems)throw new Error(`Added ${l} items when expected ${this.numItems}.`);return WC(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(l,h,v,S){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:k,coords:R,nodeSize:B}=this,V=[0,k.length-1,0],Z=[];for(;V.length;){const ie=V.pop()||0,ce=V.pop()||0,ve=V.pop()||0;if(ce-ve<=B){for(let Ve=ve;Ve<=ce;Ve++){const et=R[2*Ve],Ct=R[2*Ve+1];et>=l&&et<=v&&Ct>=h&&Ct<=S&&Z.push(k[Ve])}continue}const Ee=ve+ce>>1,Ne=R[2*Ee],ze=R[2*Ee+1];Ne>=l&&Ne<=v&&ze>=h&&ze<=S&&Z.push(k[Ee]),(ie===0?l<=Ne:h<=ze)&&(V.push(ve),V.push(Ee-1),V.push(1-ie)),(ie===0?v>=Ne:S>=ze)&&(V.push(Ee+1),V.push(ce),V.push(1-ie))}return Z}within(l,h,v){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:S,coords:k,nodeSize:R}=this,B=[0,S.length-1,0],V=[],Z=v*v;for(;B.length;){const ie=B.pop()||0,ce=B.pop()||0,ve=B.pop()||0;if(ce-ve<=R){for(let Ve=ve;Ve<=ce;Ve++)O8(k[2*Ve],k[2*Ve+1],l,h)<=Z&&V.push(S[Ve]);continue}const Ee=ve+ce>>1,Ne=k[2*Ee],ze=k[2*Ee+1];O8(Ne,ze,l,h)<=Z&&V.push(S[Ee]),(ie===0?l-v<=Ne:h-v<=ze)&&(B.push(ve),B.push(Ee-1),B.push(1-ie)),(ie===0?l+v>=Ne:h+v>=ze)&&(B.push(Ee+1),B.push(ce),B.push(1-ie))}return V}}function WC(p,l,h,v,S,k){if(S-v<=h)return;const R=v+S>>1;D8(p,l,R,v,S,k),WC(p,l,h,v,R-1,1-k),WC(p,l,h,R+1,S,1-k)}function D8(p,l,h,v,S,k){for(;S>v;){if(S-v>600){const Z=S-v+1,ie=h-v+1,ce=Math.log(Z),ve=.5*Math.exp(2*ce/3),Ee=.5*Math.sqrt(ce*ve*(Z-ve)/Z)*(ie-Z/2<0?-1:1);D8(p,l,h,Math.max(v,Math.floor(h-ie*ve/Z+Ee)),Math.min(S,Math.floor(h+(Z-ie)*ve/Z+Ee)),k)}const R=l[2*h+k];let B=v,V=S;for(Y_(p,l,v,h),l[2*S+k]>R&&Y_(p,l,v,S);B<V;){for(Y_(p,l,B,V),B++,V--;l[2*B+k]<R;)B++;for(;l[2*V+k]>R;)V--}l[2*v+k]===R?Y_(p,l,v,V):(V++,Y_(p,l,V,S)),V<=h&&(v=V+1),h<=V&&(S=V-1)}}function Y_(p,l,h,v){XC(p,h,v),XC(l,2*h,2*v),XC(l,2*h+1,2*v+1)}function XC(p,l,h){const v=p[l];p[l]=p[h],p[h]=v}function O8(p,l,h,v){const S=p-h,k=l-v;return S*S+k*k}var YC;s.cH=void 0,(YC=s.cH||(s.cH={})).create="create",YC.load="load",YC.fullLoad="fullLoad";let L2=null,Z_=[];const ZC=1e3/60,KC="loadTime",JC="fullLoadTime",aoe={mark(p){performance.mark(p)},frame(p){const l=p;L2!=null&&Z_.push(l-L2),L2=l},clearMetrics(){L2=null,Z_=[],performance.clearMeasures(KC),performance.clearMeasures(JC);for(const p in s.cH)performance.clearMarks(s.cH[p])},getPerformanceMetrics(){performance.measure(KC,s.cH.create,s.cH.load),performance.measure(JC,s.cH.create,s.cH.fullLoad);const p=performance.getEntriesByName(KC)[0].duration,l=performance.getEntriesByName(JC)[0].duration,h=Z_.length,v=1/(Z_.reduce(((k,R)=>k+R),0)/h/1e3),S=Z_.filter((k=>k>ZC)).reduce(((k,R)=>k+(R-ZC)/ZC),0);return{loadTime:p,fullLoadTime:l,fps:v,percentDroppedFrames:S/(h+S)*100,totalFrames:h}}};s.$=A,s.A=N,s.B=Yt,s.C=Je,s.D=Tn,s.E=zr,s.F=function([p,l,h]){return l+=90,l*=Math.PI/180,h*=Math.PI/180,{x:p*Math.cos(l)*Math.sin(h),y:p*Math.sin(l)*Math.sin(h),z:p*Math.cos(h)}},s.G=Hn,s.H=ki,s.I=vC,s.J=lt,s.K=function(p){if($t==null){const l=p.navigator?p.navigator.userAgent:null;$t=!!p.safari||!(!l||!(/\b(iPad|iPhone|iPod)\b/.test(l)||l.match("Safari")&&!l.match("Chrome")))}return $t},s.L=class{constructor(p,l){this.target=p,this.mapId=l,this.resolveRejects={},this.tasks={},this.taskQueue=[],this.abortControllers={},this.messageHandlers={},this.invoker=new bae((()=>this.process())),this.subscription=Cr(this.target,"message",(h=>this.receive(h)),!1),this.globalScope=Xt(self)?p:window}registerMessageHandler(p,l){this.messageHandlers[p]=l}unregisterMessageHandler(p){delete this.messageHandlers[p]}sendAsync(p,l){return new Promise(((h,v)=>{const S=Math.round(1e18*Math.random()).toString(36).substring(0,10),k=l?Cr(l.signal,"abort",(()=>{k?.unsubscribe(),delete this.resolveRejects[S];const V={id:S,type:"<cancel>",origin:location.origin,targetMapId:p.targetMapId,sourceMapId:this.mapId};this.target.postMessage(V)}),xae):null;this.resolveRejects[S]={resolve:V=>{k?.unsubscribe(),h(V)},reject:V=>{k?.unsubscribe(),v(V)}};const R=[],B=Object.assign(Object.assign({},p),{id:S,sourceMapId:this.mapId,origin:location.origin,data:Br(p.data,R)});this.target.postMessage(B,{transfer:R})}))}receive(p){const l=p.data,h=l.id;if(!(l.origin!=="file://"&&location.origin!=="file://"&&l.origin!=="resource://android"&&location.origin!=="resource://android"&&l.origin!==location.origin||l.targetMapId&&this.mapId!==l.targetMapId)){if(l.type==="<cancel>"){delete this.tasks[h];const v=this.abortControllers[h];return delete this.abortControllers[h],void(v&&v.abort())}if(Xt(self)||l.mustQueue)return this.tasks[h]=l,this.taskQueue.push(h),void this.invoker.trigger();this.processTask(h,l)}}process(){if(this.taskQueue.length===0)return;const p=this.taskQueue.shift(),l=this.tasks[p];delete this.tasks[p],this.taskQueue.length>0&&this.invoker.trigger(),l&&this.processTask(p,l)}processTask(p,l){return o(this,void 0,void 0,(function*(){if(l.type==="<response>"){const S=this.resolveRejects[p];return delete this.resolveRejects[p],S?void(l.error?S.reject(jr(l.error)):S.resolve(jr(l.data))):void 0}if(!this.messageHandlers[l.type])return void this.completeTask(p,new Error(`Could not find a registered handler for ${l.type}, map ID: ${this.mapId}, available handlers: ${Object.keys(this.messageHandlers).join(", ")}`));const h=jr(l.data),v=new AbortController;this.abortControllers[p]=v;try{const S=yield this.messageHandlers[l.type](l.sourceMapId,h,v);this.completeTask(p,null,S)}catch(S){this.completeTask(p,S)}}))}completeTask(p,l,h){const v=[];delete this.abortControllers[p];const S={id:p,type:"<response>",sourceMapId:this.mapId,origin:location.origin,error:l?Br(l):null,data:Br(h,v)};this.target.postMessage(S,{transfer:v})}remove(){this.invoker.remove(),this.subscription.unsubscribe()}},s.M=Et,s.N=function(){var p=new N(16);return N!=Float32Array&&(p[1]=0,p[2]=0,p[3]=0,p[4]=0,p[6]=0,p[7]=0,p[8]=0,p[9]=0,p[11]=0,p[12]=0,p[13]=0,p[14]=0),p[0]=1,p[5]=1,p[10]=1,p[15]=1,p},s.O=function(p,l,h){var v,S,k,R,B,V,Z,ie,ce,ve,Ee,Ne,ze=h[0],Ve=h[1],et=h[2];return l===p?(p[12]=l[0]*ze+l[4]*Ve+l[8]*et+l[12],p[13]=l[1]*ze+l[5]*Ve+l[9]*et+l[13],p[14]=l[2]*ze+l[6]*Ve+l[10]*et+l[14],p[15]=l[3]*ze+l[7]*Ve+l[11]*et+l[15]):(S=l[1],k=l[2],R=l[3],B=l[4],V=l[5],Z=l[6],ie=l[7],ce=l[8],ve=l[9],Ee=l[10],Ne=l[11],p[0]=v=l[0],p[1]=S,p[2]=k,p[3]=R,p[4]=B,p[5]=V,p[6]=Z,p[7]=ie,p[8]=ce,p[9]=ve,p[10]=Ee,p[11]=Ne,p[12]=v*ze+B*Ve+ce*et+l[12],p[13]=S*ze+V*Ve+ve*et+l[13],p[14]=k*ze+Z*Ve+Ee*et+l[14],p[15]=R*ze+ie*Ve+Ne*et+l[15]),p},s.P=c,s.Q=function(p,l,h){var v=h[0],S=h[1],k=h[2];return p[0]=l[0]*v,p[1]=l[1]*v,p[2]=l[2]*v,p[3]=l[3]*v,p[4]=l[4]*S,p[5]=l[5]*S,p[6]=l[6]*S,p[7]=l[7]*S,p[8]=l[8]*k,p[9]=l[9]*k,p[10]=l[10]*k,p[11]=l[11]*k,p[12]=l[12],p[13]=l[13],p[14]=l[14],p[15]=l[15],p},s.R=lc,s.S=function(p,l,h){var v=l[0],S=l[1],k=l[2],R=l[3],B=l[4],V=l[5],Z=l[6],ie=l[7],ce=l[8],ve=l[9],Ee=l[10],Ne=l[11],ze=l[12],Ve=l[13],et=l[14],Ct=l[15],rt=h[0],ut=h[1],Rt=h[2],Bt=h[3];return p[0]=rt*v+ut*B+Rt*ce+Bt*ze,p[1]=rt*S+ut*V+Rt*ve+Bt*Ve,p[2]=rt*k+ut*Z+Rt*Ee+Bt*et,p[3]=rt*R+ut*ie+Rt*Ne+Bt*Ct,p[4]=(rt=h[4])*v+(ut=h[5])*B+(Rt=h[6])*ce+(Bt=h[7])*ze,p[5]=rt*S+ut*V+Rt*ve+Bt*Ve,p[6]=rt*k+ut*Z+Rt*Ee+Bt*et,p[7]=rt*R+ut*ie+Rt*Ne+Bt*Ct,p[8]=(rt=h[8])*v+(ut=h[9])*B+(Rt=h[10])*ce+(Bt=h[11])*ze,p[9]=rt*S+ut*V+Rt*ve+Bt*Ve,p[10]=rt*k+ut*Z+Rt*Ee+Bt*et,p[11]=rt*R+ut*ie+Rt*Ne+Bt*Ct,p[12]=(rt=h[12])*v+(ut=h[13])*B+(Rt=h[14])*ce+(Bt=h[15])*ze,p[13]=rt*S+ut*V+Rt*ve+Bt*Ve,p[14]=rt*k+ut*Z+Rt*Ee+Bt*et,p[15]=rt*R+ut*ie+Rt*Ne+Bt*Ct,p},s.T=uC,s.U=function(p,l){const h={};for(let v=0;v<l.length;v++){const S=l[v];S in p&&(h[S]=p[S])}return h},s.V=Wp,s.W=Xe,s.X=RF,s.Y=kF,s.Z=qe,s._=o,s.a=je,s.a$=oe,s.a0=M,s.a1=gr,s.a2=Zc,s.a3=DF,s.a4=E2,s.a5=Te,s.a6=function(p,l,h){if(!p)return l||{};if(!l)return p||{};const v=FF(p),S=FF(l);(function(R,B){B.removeAll&&(R.add.clear(),R.update.clear(),R.remove.clear(),B.remove.clear());for(const V of B.remove)R.add.delete(V),R.update.delete(V);for(const[V,Z]of B.update){const ie=R.update.get(V);ie&&(B.update.set(V,wae(ie,Z)),R.update.delete(V))}})(v,S);const k={};if((v.removeAll||S.removeAll)&&(k.removeAll=!0),k.remove=new Set([...v.remove,...S.remove]),k.add=new Map([...v.add,...S.add]),k.update=new Map([...v.update,...S.update]),k.remove.size&&k.add.size)for(const R of k.add.keys())k.remove.delete(R);return(function(R){const B={};return R.removeAll&&(B.removeAll=R.removeAll),R.remove&&(B.remove=Array.from(R.remove)),R.add&&(B.add=Array.from(R.add.values())),R.update&&(B.update=Array.from(R.update.values())),B})(k)},s.a7=function(p,l){const h=new Map;if(p==null||p.type==null)return h;if(p.type==="Feature"){const v=AC(p,l);return v==null?void 0:(h.set(v,p),h)}if(p.type==="FeatureCollection"){const v=new Set;for(const S of p.features){const k=AC(S,l);if(k==null||v.has(k))return;v.add(k),h.set(k,S)}return h}},s.a8=function(p,l,h){var v,S;const k=[];if(l.removeAll)p.clear();else if(l.remove)for(const R of l.remove){const B=p.get(R);B&&(k.push(B.geometry),p.delete(R))}if(l.add)for(const R of l.add){const B=AC(R,h);if(B==null)continue;const V=p.get(B);V&&k.push(V.geometry),k.push(R.geometry),p.set(B,R)}if(l.update)for(const R of l.update){const B=p.get(R.id);if(!B)continue;const V=!!R.newGeometry,Z=R.removeAllProperties||((v=R.removeProperties)===null||v===void 0?void 0:v.length)>0||((S=R.addOrUpdateProperties)===null||S===void 0?void 0:S.length)>0;if(!V&&!Z)continue;k.push(B.geometry);const ie=Object.assign({},B);if(p.set(R.id,ie),V&&(k.push(R.newGeometry),ie.geometry=R.newGeometry),Z){if(ie.properties=R.removeAllProperties?{}:Object.assign({},ie.properties||{}),R.removeProperties)for(const ce of R.removeProperties)delete ie.properties[ce];if(R.addOrUpdateProperties)for(const{key:ce,value:ve}of R.addOrUpdateProperties)ie.properties[ce]=ve}}return k},s.a9=H_,s.aA=function(p,{uSize:l,uSizeT:h},{lowerSize:v,upperSize:S}){return p.kind==="source"?v/Gd:p.kind==="composite"?Hn.number(v/Gd,S/Gd,h):l},s.aB=function(p,l){var h=l[0],v=l[1],S=l[2],k=l[3],R=l[4],B=l[5],V=l[6],Z=l[7],ie=l[8],ce=l[9],ve=l[10],Ee=l[11],Ne=l[12],ze=l[13],Ve=l[14],et=l[15],Ct=h*B-v*R,rt=h*V-S*R,ut=h*Z-k*R,Rt=v*V-S*B,Bt=v*Z-k*B,dr=S*Z-k*V,Or=ie*ze-ce*Ne,Pr=ie*Ve-ve*Ne,Vr=ie*et-Ee*Ne,pn=ce*Ve-ve*ze,Wr=ce*et-Ee*ze,Rr=ve*et-Ee*Ve,Tr=Ct*Rr-rt*Wr+ut*pn+Rt*Vr-Bt*Pr+dr*Or;return Tr?(p[0]=(B*Rr-V*Wr+Z*pn)*(Tr=1/Tr),p[1]=(S*Wr-v*Rr-k*pn)*Tr,p[2]=(ze*dr-Ve*Bt+et*Rt)*Tr,p[3]=(ve*Bt-ce*dr-Ee*Rt)*Tr,p[4]=(V*Vr-R*Rr-Z*Pr)*Tr,p[5]=(h*Rr-S*Vr+k*Pr)*Tr,p[6]=(Ve*ut-Ne*dr-et*rt)*Tr,p[7]=(ie*dr-ve*ut+Ee*rt)*Tr,p[8]=(R*Wr-B*Vr+Z*Or)*Tr,p[9]=(v*Vr-h*Wr-k*Or)*Tr,p[10]=(Ne*Bt-ze*ut+et*Ct)*Tr,p[11]=(ce*ut-ie*Bt-Ee*Ct)*Tr,p[12]=(B*Pr-R*pn-V*Or)*Tr,p[13]=(h*pn-v*Pr+S*Or)*Tr,p[14]=(ze*rt-Ne*Rt-Ve*Ct)*Tr,p[15]=(ie*Rt-ce*rt+ve*Ct)*Tr,p):null},s.aC=Le,s.aD=function(p){var l=p[0],h=p[1];return Math.sqrt(l*l+h*h)},s.aE=function(p){return p[0]=0,p[1]=0,p},s.aF=function(p,l,h){return p[0]=l[0]*h,p[1]=l[1]*h,p},s.aG=xC,s.aH=se,s.aI=function(p,l,h,v){const S=l.y-p.y,k=l.x-p.x,R=v.y-h.y,B=v.x-h.x,V=R*k-B*S;if(V===0)return null;const Z=(B*(p.y-h.y)-R*(p.x-h.x))/V;return new c(p.x+Z*k,p.y+Z*S)},s.aJ=v8,s.aK=qy,s.aL=function(p){let l=1/0,h=1/0,v=-1/0,S=-1/0;for(const k of p)l=Math.min(l,k.x),h=Math.min(h,k.y),v=Math.max(v,k.x),S=Math.max(S,k.y);return[l,h,v,S]},s.aM=gl,s.aN=Ie,s.aO=function(p,l,h,v,S=!1){if(!h[0]&&!h[1])return[0,0];const k=S?v==="map"?-p.bearingInRadians:0:v==="viewport"?p.bearingInRadians:0;if(k){const R=Math.sin(k),B=Math.cos(k);h=[h[0]*B-h[1]*R,h[0]*R+h[1]*B]}return[S?h[0]:Ie(l,h[0],p.zoom),S?h[1]:Ie(l,h[1],p.zoom)]},s.aQ=bC,s.aR=HC,s.aS=_C,s.aT=GC,s.aU=pa,s.aV=v2,s.aW=ht,s.aX=gn,s.aY=xr,s.aZ=Jt,s.a_=OF,s.aa=nm,s.ab=25,s.ac=CC,s.ad=p=>{const l=window.document.createElement("video");return l.muted=!0,new Promise((h=>{l.onloadstart=()=>{h(l)};for(const v of p){const S=window.document.createElement("source");Ht(v)||(l.crossOrigin="Anonymous"),S.src=v,l.appendChild(S)}}))},s.ae=Ut,s.af=function(){return st++},s.ag=C,s.ah=Jy,s.ai=X_,s.aj=ih,s.ak=Jh,s.al=zF,s.am=function(p){const l={};if(p.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,((h,v,S,k)=>{const R=S||k;return l[v]=!R||R.toLowerCase(),""})),l["max-age"]){const h=parseInt(l["max-age"],10);isNaN(h)?delete l["max-age"]:l["max-age"]=h}return l},s.an=Fe,s.ao=85.051129,s.ap=Er,s.aq=function(p){return Math.pow(2,p)},s.ar=U,s.as=MF,s.at=function(p){return Math.log(p)/Math.LN2},s.au=function(p){var l=p[0],h=p[1];return l*l+h*h},s.av=function(p){if(!p.length)return new Set;const l=Math.max(...p.map((V=>V.canonical.z)));let h=1/0,v=-1/0,S=1/0,k=-1/0;const R=[];for(const V of p){const{x:Z,y:ie,z:ce}=V.canonical,ve=Math.pow(2,l-ce),Ee=Z*ve,Ne=ie*ve;R.push({id:V,x:Ee,y:Ne}),Ee<h&&(h=Ee),Ee>v&&(v=Ee),Ne<S&&(S=Ne),Ne>k&&(k=Ne)}const B=new Set;for(const V of R)V.x!==h&&V.x!==v&&V.y!==S&&V.y!==k||B.add(V.id);return B},s.aw=function(p,l){const h=Math.abs(2*p.wrap)-+(p.wrap<0),v=Math.abs(2*l.wrap)-+(l.wrap<0);return p.overscaledZ-l.overscaledZ||v-h||l.canonical.y-p.canonical.y||l.canonical.x-p.canonical.x},s.ax=class{constructor(p,l){this.max=p,this.onRemove=l,this.reset()}reset(){for(const p in this.data)for(const l of this.data[p])l.timeout&&clearTimeout(l.timeout),this.onRemove(l.value);return this.data={},this.order=[],this}add(p,l,h){const v=p.wrapped().key;this.data[v]===void 0&&(this.data[v]=[]);const S={value:l,timeout:void 0};if(h!==void 0&&(S.timeout=setTimeout((()=>{this.remove(p,S)}),h)),this.data[v].push(S),this.order.push(v),this.order.length>this.max){const k=this._getAndRemoveByKey(this.order[0]);k&&this.onRemove(k)}return this}has(p){return p.wrapped().key in this.data}getAndRemove(p){return this.has(p)?this._getAndRemoveByKey(p.wrapped().key):null}_getAndRemoveByKey(p){const l=this.data[p].shift();return l.timeout&&clearTimeout(l.timeout),this.data[p].length===0&&delete this.data[p],this.order.splice(this.order.indexOf(p),1),l.value}getByKey(p){const l=this.data[p];return l?l[0].value:null}get(p){return this.has(p)?this.data[p.wrapped().key][0].value:null}remove(p,l){if(!this.has(p))return this;const h=p.wrapped().key,v=l===void 0?0:this.data[h].indexOf(l),S=this.data[h][v];return this.data[h].splice(v,1),S.timeout&&clearTimeout(S.timeout),this.data[h].length===0&&delete this.data[h],this.onRemove(S.value),this.order.splice(this.order.indexOf(h),1),this}setMaxSize(p){for(this.max=p;this.order.length>this.max;){const l=this._getAndRemoveByKey(this.order[0]);l&&this.onRemove(l)}return this}filter(p){const l=[];for(const h in this.data)for(const v of this.data[h])p(v.value)||l.push(v);for(const h of l)this.remove(h.value.tileID,h)}},s.ay=function(p,l){let h=0,v=0;if(p.kind==="constant")v=p.layoutSize;else if(p.kind!=="source"){const{interpolationType:S,minZoom:k,maxZoom:R}=p,B=S?Fe(Un.interpolationFactor(S,l,k,R),0,1):0;p.kind==="camera"?v=Hn.number(p.minSize,p.maxSize,B):h=B}return{uSizeT:h,uSize:v}},s.b=cr,s.b$=qd,s.b0=X,s.b1=function(p){var l=new N(3);return l[0]=p[0],l[1]=p[1],l[2]=p[2],l},s.b2=function(p,l,h){return p[0]=l[0]-h[0],p[1]=l[1]-h[1],p[2]=l[2]-h[2],p},s.b3=function(p,l){var h=l[0],v=l[1],S=l[2],k=h*h+v*v+S*S;return k>0&&(k=1/Math.sqrt(k)),p[0]=l[0]*k,p[1]=l[1]*k,p[2]=l[2]*k,p},s.b4=Q,s.b5=function(p,l){return p[0]*l[0]+p[1]*l[1]+p[2]*l[2]},s.b6=function(p,l,h){return p[0]=l[0]*h[0],p[1]=l[1]*h[1],p[2]=l[2]*h[2],p[3]=l[3]*h[3],p},s.b7=H,s.b8=function(p,l,h){const v=l[0]*h[0]+l[1]*h[1]+l[2]*h[2];return v===0?null:(-(p[0]*h[0]+p[1]*h[1]+p[2]*h[2])-h[3])/v},s.b9=ae,s.bA=function(p,l,h,v){return p[0]=l[0]+h[0]*v,p[1]=l[1]+h[1]*v,p[2]=l[2]+h[2]*v,p},s.bB=_e,s.bC=function(p,l,h){var v=h[0],S=h[1],k=h[2],R=h[3],B=l[0],V=l[1],Z=l[2],ie=S*Z-k*V,ce=k*B-v*Z,ve=v*V-S*B;return p[0]=B+R*(ie+=ie)+S*(ve+=ve)-k*(ce+=ce),p[1]=V+R*ce+k*ie-v*ve,p[2]=Z+R*ve+v*ce-S*ie,p},s.bD=function(p,l,h){const v=(function(V){var Z=V[3],ie=V[4],ce=V[5],ve=V[6],Ee=V[7],Ne=V[8];return V[0]*(Ne*ie-ce*Ee)+V[1]*(-Ne*Z+ce*ve)+V[2]*(Ee*Z-ie*ve)})([p[0],p[1],p[2],l[0],l[1],l[2],h[0],h[1],h[2]]);if(v===0)return null;const S=Q([],[l[0],l[1],l[2]],[h[0],h[1],h[2]]),k=Q([],[h[0],h[1],h[2]],[p[0],p[1],p[2]]),R=Q([],[p[0],p[1],p[2]],[l[0],l[1],l[2]]),B=oe([],S,-p[3]);return X(B,B,oe([],k,-l[3])),X(B,B,oe([],R,-h[3])),oe(B,B,1/v),B},s.bE=TC,s.bF=function(){return new Float64Array(4)},s.bG=function(p,l,h,v){var S=[],k=[];return S[0]=l[0]-h[0],S[1]=l[1]-h[1],S[2]=l[2]-h[2],k[0]=S[0]*Math.cos(v)-S[1]*Math.sin(v),k[1]=S[0]*Math.sin(v)+S[1]*Math.cos(v),k[2]=S[2],p[0]=k[0]+h[0],p[1]=k[1]+h[1],p[2]=k[2]+h[2],p},s.bH=function(p,l,h,v){var S=[],k=[];return S[0]=l[0]-h[0],S[1]=l[1]-h[1],S[2]=l[2]-h[2],k[0]=S[0],k[1]=S[1]*Math.cos(v)-S[2]*Math.sin(v),k[2]=S[1]*Math.sin(v)+S[2]*Math.cos(v),p[0]=k[0]+h[0],p[1]=k[1]+h[1],p[2]=k[2]+h[2],p},s.bI=function(p,l,h,v){var S=[],k=[];return S[0]=l[0]-h[0],S[1]=l[1]-h[1],S[2]=l[2]-h[2],k[0]=S[2]*Math.sin(v)+S[0]*Math.cos(v),k[1]=S[1],k[2]=S[2]*Math.cos(v)-S[0]*Math.sin(v),p[0]=k[0]+h[0],p[1]=k[1]+h[1],p[2]=k[2]+h[2],p},s.bJ=function(p,l,h){var v=Math.sin(h),S=Math.cos(h),k=l[0],R=l[1],B=l[2],V=l[3],Z=l[8],ie=l[9],ce=l[10],ve=l[11];return l!==p&&(p[4]=l[4],p[5]=l[5],p[6]=l[6],p[7]=l[7],p[12]=l[12],p[13]=l[13],p[14]=l[14],p[15]=l[15]),p[0]=k*S-Z*v,p[1]=R*S-ie*v,p[2]=B*S-ce*v,p[3]=V*S-ve*v,p[8]=k*v+Z*S,p[9]=R*v+ie*S,p[10]=B*v+ce*S,p[11]=V*v+ve*S,p},s.bK=function(p,l){const h=Me(p,360),v=Me(l,360),S=v-h,k=v>h?S-360:S+360;return Math.abs(S)<Math.abs(k)?S:k},s.bL=function(p){return p[0]=0,p[1]=0,p[2]=0,p},s.bM=function(p,l,h,v){const S=Math.sqrt(p*p+l*l),k=Math.sqrt(h*h+v*v);p/=S,l/=S,h/=k,v/=k;const R=Math.acos(p*h+l*v);return-l*h+p*v>0?R:-R},s.bN=function(p,l){const h=Me(p,2*Math.PI),v=Me(l,2*Math.PI);return Math.min(Math.abs(h-v),Math.abs(h-v+2*Math.PI),Math.abs(h-v-2*Math.PI))},s.bO=function(){const p={},l=Mt.$version;for(const h in Mt.$root){const v=Mt.$root[h];if(v.required){let S=null;S=h==="version"?l:v.type==="array"?[]:{},S!=null&&(p[h]=S)}}return p},s.bP=ct,s.bQ=sn,s.bR=function p(l,h){if(Array.isArray(l)){if(!Array.isArray(h)||l.length!==h.length)return!1;for(let v=0;v<l.length;v++)if(!p(l[v],h[v]))return!1;return!0}if(typeof l=="object"&&l!==null&&h!==null){if(typeof h!="object"||Object.keys(l).length!==Object.keys(h).length)return!1;for(const v in l)if(!p(l[v],h[v]))return!1;return!0}return l===h},s.bS=function(p){p=p.slice();const l=Object.create(null);for(let h=0;h<p.length;h++)l[p[h].id]=p[h];for(let h=0;h<p.length;h++)"ref"in p[h]&&(p[h]=jn(p[h],l[p[h].ref]));return p},s.bT=function(p,l){if(p.type==="custom")return new _ae(p,l);switch(p.type){case"background":return new vae(p,l);case"circle":return new rie(p,l);case"color-relief":return new lie(p,l);case"fill":return new Sie(p,l);case"fill-extrusion":return new Nie(p,l);case"heatmap":return new iie(p,l);case"hillshade":return new oie(p,l);case"line":return new Vie(p,l);case"raster":return new Zl(p,l);case"symbol":return new S2(p,l)}},s.bU=p=>p.type==="raster",s.bV=be,s.bW=function(p,l){if(!p)return[{command:"setStyle",args:[l]}];let h=[];try{if(!Qr(p.version,l.version))return[{command:"setStyle",args:[l]}];Qr(p.center,l.center)||h.push({command:"setCenter",args:[l.center]}),Qr(p.state,l.state)||h.push({command:"setGlobalState",args:[l.state]}),Qr(p.centerAltitude,l.centerAltitude)||h.push({command:"setCenterAltitude",args:[l.centerAltitude]}),Qr(p.zoom,l.zoom)||h.push({command:"setZoom",args:[l.zoom]}),Qr(p.bearing,l.bearing)||h.push({command:"setBearing",args:[l.bearing]}),Qr(p.pitch,l.pitch)||h.push({command:"setPitch",args:[l.pitch]}),Qr(p.roll,l.roll)||h.push({command:"setRoll",args:[l.roll]}),Qr(p.sprite,l.sprite)||h.push({command:"setSprite",args:[l.sprite]}),Qr(p.glyphs,l.glyphs)||h.push({command:"setGlyphs",args:[l.glyphs]}),Qr(p.transition,l.transition)||h.push({command:"setTransition",args:[l.transition]}),Qr(p.light,l.light)||h.push({command:"setLight",args:[l.light]}),Qr(p.terrain,l.terrain)||h.push({command:"setTerrain",args:[l.terrain]}),Qr(p.sky,l.sky)||h.push({command:"setSky",args:[l.sky]}),Qr(p.projection,l.projection)||h.push({command:"setProjection",args:[l.projection]});const v={},S=[];(function(R,B,V,Z){let ie;for(ie in B=B||{},R=R||{})Object.prototype.hasOwnProperty.call(R,ie)&&(Object.prototype.hasOwnProperty.call(B,ie)||un(ie,V,Z));for(ie in B)Object.prototype.hasOwnProperty.call(B,ie)&&(Object.prototype.hasOwnProperty.call(R,ie)?Qr(R[ie],B[ie])||(R[ie].type==="geojson"&&B[ie].type==="geojson"&&Re(R,B,ie)?nr(V,{command:"setGeoJSONSourceData",args:[ie,B[ie].data]}):Kn(ie,B,V,Z)):oi(ie,B,V))})(p.sources,l.sources,S,v);const k=[];p.layers&&p.layers.forEach((R=>{"source"in R&&v[R.source]?h.push({command:"removeLayer",args:[R.id]}):k.push(R)})),h=h.concat(S),(function(R,B,V){B=B||[];const Z=(R=R||[]).map(Tt),ie=B.map(Tt),ce=R.reduce(Gt,{}),ve=B.reduce(Gt,{}),Ee=Z.slice(),Ne=Object.create(null);let ze,Ve,et,Ct,rt;for(let ut=0,Rt=0;ut<Z.length;ut++)ze=Z[ut],Object.prototype.hasOwnProperty.call(ve,ze)?Rt++:(nr(V,{command:"removeLayer",args:[ze]}),Ee.splice(Ee.indexOf(ze,Rt),1));for(let ut=0,Rt=0;ut<ie.length;ut++)ze=ie[ie.length-1-ut],Ee[Ee.length-1-ut]!==ze&&(Object.prototype.hasOwnProperty.call(ce,ze)?(nr(V,{command:"removeLayer",args:[ze]}),Ee.splice(Ee.lastIndexOf(ze,Ee.length-Rt),1)):Rt++,Ct=Ee[Ee.length-ut],nr(V,{command:"addLayer",args:[ve[ze],Ct]}),Ee.splice(Ee.length-ut,0,ze),Ne[ze]=!0);for(let ut=0;ut<ie.length;ut++)if(ze=ie[ut],Ve=ce[ze],et=ve[ze],!Ne[ze]&&!Qr(Ve,et))if(Qr(Ve.source,et.source)&&Qr(Ve["source-layer"],et["source-layer"])&&Qr(Ve.type,et.type)){for(rt in He(Ve.layout,et.layout,V,ze,null,"setLayoutProperty"),He(Ve.paint,et.paint,V,ze,null,"setPaintProperty"),Qr(Ve.filter,et.filter)||nr(V,{command:"setFilter",args:[ze,et.filter]}),Qr(Ve.minzoom,et.minzoom)&&Qr(Ve.maxzoom,et.maxzoom)||nr(V,{command:"setLayerZoomRange",args:[ze,et.minzoom,et.maxzoom]}),Ve)Object.prototype.hasOwnProperty.call(Ve,rt)&&rt!=="layout"&&rt!=="paint"&&rt!=="filter"&&rt!=="metadata"&&rt!=="minzoom"&&rt!=="maxzoom"&&(rt.indexOf("paint.")===0?He(Ve[rt],et[rt],V,ze,rt.slice(6),"setPaintProperty"):Qr(Ve[rt],et[rt])||nr(V,{command:"setLayerProperty",args:[ze,rt,et[rt]]}));for(rt in et)Object.prototype.hasOwnProperty.call(et,rt)&&!Object.prototype.hasOwnProperty.call(Ve,rt)&&rt!=="layout"&&rt!=="paint"&&rt!=="filter"&&rt!=="metadata"&&rt!=="minzoom"&&rt!=="maxzoom"&&(rt.indexOf("paint.")===0?He(Ve[rt],et[rt],V,ze,rt.slice(6),"setPaintProperty"):Qr(Ve[rt],et[rt])||nr(V,{command:"setLayerProperty",args:[ze,rt,et[rt]]}))}else nr(V,{command:"removeLayer",args:[ze]}),Ct=Ee[Ee.lastIndexOf(ze)+1],nr(V,{command:"addLayer",args:[et,Ct]})})(k,l.layers,h)}catch(v){console.warn("Unable to compute style diff:",v),h=[{command:"setStyle",args:[l]}]}return h},s.bX=function(p){const l=[],h=p.id;return h===void 0&&l.push({message:`layers.${h}: missing required property "id"`}),p.render===void 0&&l.push({message:`layers.${h}: missing required method "render"`}),p.renderingMode&&p.renderingMode!=="2d"&&p.renderingMode!=="3d"&&l.push({message:`layers.${h}: property "renderingMode" must be either "2d" or "3d"`}),l},s.bY=Qe,s.bZ=it,s.b_=class extends zu{constructor(p,l){super(p,l),this.current=0}set(p){this.current!==p&&(this.current=p,this.gl.uniform1i(this.location,p))}},s.ba=function(p,l,h){return p[0]=l[0]*h,p[1]=l[1]*h,p[2]=l[2]*h,p[3]=l[3]*h,p},s.bb=function(p,l){return p[0]*l[0]+p[1]*l[1]+p[2]*l[2]+p[3]},s.bc=LF,s.bd=Qy,s.be=function(p,l,h,v,S){var k=1/Math.tan(l/2);if(p[0]=k/h,p[1]=0,p[2]=0,p[3]=0,p[4]=0,p[5]=k,p[6]=0,p[7]=0,p[8]=0,p[9]=0,p[11]=-1,p[12]=0,p[13]=0,p[15]=0,S!=null&&S!==1/0){var R=1/(v-S);p[10]=(S+v)*R,p[14]=2*S*v*R}else p[10]=-1,p[14]=-2*v;return p},s.bf=function(p){var l=new N(16);return l[0]=p[0],l[1]=p[1],l[2]=p[2],l[3]=p[3],l[4]=p[4],l[5]=p[5],l[6]=p[6],l[7]=p[7],l[8]=p[8],l[9]=p[9],l[10]=p[10],l[11]=p[11],l[12]=p[12],l[13]=p[13],l[14]=p[14],l[15]=p[15],l},s.bg=function(p,l,h){var v=Math.sin(h),S=Math.cos(h),k=l[0],R=l[1],B=l[2],V=l[3],Z=l[4],ie=l[5],ce=l[6],ve=l[7];return l!==p&&(p[8]=l[8],p[9]=l[9],p[10]=l[10],p[11]=l[11],p[12]=l[12],p[13]=l[13],p[14]=l[14],p[15]=l[15]),p[0]=k*S+Z*v,p[1]=R*S+ie*v,p[2]=B*S+ce*v,p[3]=V*S+ve*v,p[4]=Z*S-k*v,p[5]=ie*S-R*v,p[6]=ce*S-B*v,p[7]=ve*S-V*v,p},s.bh=function(p,l,h){var v=Math.sin(h),S=Math.cos(h),k=l[4],R=l[5],B=l[6],V=l[7],Z=l[8],ie=l[9],ce=l[10],ve=l[11];return l!==p&&(p[0]=l[0],p[1]=l[1],p[2]=l[2],p[3]=l[3],p[12]=l[12],p[13]=l[13],p[14]=l[14],p[15]=l[15]),p[4]=k*S+Z*v,p[5]=R*S+ie*v,p[6]=B*S+ce*v,p[7]=V*S+ve*v,p[8]=Z*S-k*v,p[9]=ie*S-R*v,p[10]=ce*S-B*v,p[11]=ve*S-V*v,p},s.bi=function(){const p=new Float32Array(16);return U(p),p},s.bj=function(){const p=new Float64Array(16);return U(p),p},s.bk=function(){return new Float64Array(16)},s.bl=function(p,l,h){const v=new Float64Array(4);return _e(v,p,l-90,h),v},s.bm=function(p,l,h,v){var S,k,R,B,V,Z=l[0],ie=l[1],ce=l[2],ve=l[3],Ee=h[0],Ne=h[1],ze=h[2],Ve=h[3];return(k=Z*Ee+ie*Ne+ce*ze+ve*Ve)<0&&(k=-k,Ee=-Ee,Ne=-Ne,ze=-ze,Ve=-Ve),1-k>F?(S=Math.acos(k),R=Math.sin(S),B=Math.sin((1-v)*S)/R,V=Math.sin(v*S)/R):(B=1-v,V=v),p[0]=B*Z+V*Ee,p[1]=B*ie+V*Ne,p[2]=B*ce+V*ze,p[3]=B*ve+V*Ve,p},s.bn=function(p){const l=new Float64Array(9);(function(k,R){var B=R[0],V=R[1],Z=R[2],ie=R[3],ce=B+B,ve=V+V,Ee=Z+Z,Ne=B*ce,ze=V*ce,Ve=V*ve,et=Z*ce,Ct=Z*ve,rt=Z*Ee,ut=ie*ce,Rt=ie*ve,Bt=ie*Ee;k[0]=1-Ve-rt,k[3]=ze-Bt,k[6]=et+Rt,k[1]=ze+Bt,k[4]=1-Ne-rt,k[7]=Ct-ut,k[2]=et-Rt,k[5]=Ct+ut,k[8]=1-Ne-Ve})(l,p);const h=Jt(-Math.asin(Fe(l[2],-1,1)));let v,S;return Math.hypot(l[5],l[8])<.001?(v=0,S=-Jt(Math.atan2(l[3],l[4]))):(v=Jt(l[5]===0&&l[8]===0?0:Math.atan2(l[5],l[8])),S=Jt(l[1]===0&&l[0]===0?0:Math.atan2(l[1],l[0]))),{roll:v,pitch:h+90,bearing:S}},s.bo=function(p,l){return p.roll==l.roll&&p.pitch==l.pitch&&p.bearing==l.bearing},s.bp=kr,s.bq=$d,s.br=Yy,s.bs=z_,s.bt=Xy,s.bu=de,s.bv=Se,s.bw=hi,s.bx=function(p,l,h,v,S){return de(v,S,Fe((p-l)/(h-l),0,1))},s.by=Me,s.bz=function(){return new Float64Array(3)},s.c=Ge,s.c$=function(p,l,h,v,S){return o(this,void 0,void 0,(function*(){if(M())try{return yield gr(p,l,h,v,S)}catch{}return(function(k,R,B,V,Z){const ie=k.width,ce=k.height;mr&&ar||(mr=new OffscreenCanvas(ie,ce),ar=mr.getContext("2d",{willReadFrequently:!0})),mr.width=ie,mr.height=ce,ar.drawImage(k,0,0,ie,ce);const ve=ar.getImageData(R,B,V,Z);return ar.clearRect(0,0,ie,ce),ve.data})(p,l,h,v,S)}))},s.c0=class extends zu{constructor(p,l){super(p,l),this.current=Ec}set(p){if(p[12]!==this.current[12]||p[0]!==this.current[0])return this.current=p,void this.gl.uniformMatrix4fv(this.location,!1,p);for(let l=1;l<16;l++)if(p[l]!==this.current[l]){this.current=p,this.gl.uniformMatrix4fv(this.location,!1,p);break}}},s.c1=em,s.c2=class extends zu{constructor(p,l){super(p,l),this.current=[0,0,0]}set(p){p[0]===this.current[0]&&p[1]===this.current[1]&&p[2]===this.current[2]||(this.current=p,this.gl.uniform3f(this.location,p[0],p[1],p[2]))}},s.c3=class extends zu{constructor(p,l){super(p,l),this.current=[0,0]}set(p){p[0]===this.current[0]&&p[1]===this.current[1]||(this.current=p,this.gl.uniform2f(this.location,p[0],p[1]))}},s.c4=O,s.c5=function(p,l){var h=Math.sin(l),v=Math.cos(l);return p[0]=v,p[1]=h,p[2]=0,p[3]=-h,p[4]=v,p[5]=0,p[6]=0,p[7]=0,p[8]=1,p},s.c6=function(p,l,h){var v=l[0],S=l[1],k=l[2];return p[0]=v*h[0]+S*h[3]+k*h[6],p[1]=v*h[1]+S*h[4]+k*h[7],p[2]=v*h[2]+S*h[5]+k*h[8],p},s.c7=function(p,l,h,v,S,k,R){var B=1/(l-h),V=1/(v-S),Z=1/(k-R);return p[0]=-2*B,p[1]=0,p[2]=0,p[3]=0,p[4]=0,p[5]=-2*V,p[6]=0,p[7]=0,p[8]=0,p[9]=0,p[10]=2*Z,p[11]=0,p[12]=(l+h)*B,p[13]=(S+v)*V,p[14]=(R+k)*Z,p[15]=1,p},s.c8=class extends zu{constructor(p,l){super(p,l),this.current=new Array}set(p){if(p!=this.current){this.current=p;const l=new Float32Array(4*p.length);for(let h=0;h<p.length;h++)l[4*h]=p[h].r,l[4*h+1]=p[h].g,l[4*h+2]=p[h].b,l[4*h+3]=p[h].a;this.gl.uniform4fv(this.location,l)}}},s.c9=class extends zu{constructor(p,l){super(p,l),this.current=new Array}set(p){if(p!=this.current){this.current=p;const l=new Float32Array(p);this.gl.uniform1fv(this.location,l)}}},s.cA=function(p,l){return ot[l]&&"touches"in p},s.cB=function(p){return ot[p]||Ce[p]},s.cC=function(p,l,h){var v=l[0],S=l[1];return p[0]=h[0]*v+h[4]*S+h[12],p[1]=h[1]*v+h[5]*S+h[13],p},s.cD=function(p,l){const{x:h,y:v}=H_.fromLngLat(l);return!(p<0||p>25||v<0||v>=1||h<0||h>=1)},s.cE=function(p,l){return p[0]=l[0],p[1]=0,p[2]=0,p[3]=0,p[4]=0,p[5]=l[1],p[6]=0,p[7]=0,p[8]=0,p[9]=0,p[10]=l[2],p[11]=0,p[12]=0,p[13]=0,p[14]=0,p[15]=1,p},s.cF=class extends is{},s.cG=aoe,s.cI=mt,s.cJ=function(p,l){Ge.REGISTERED_PROTOCOLS[p]=l},s.cK=function(p){delete Ge.REGISTERED_PROTOCOLS[p]},s.cL=function(p,l){const h={};for(let S=0;S<p.length;S++){const k=l&&l[p[S].id]||Hc(p[S]);l&&(l[p[S].id]=k);let R=h[k];R||(R=h[k]=[]),R.push(p[S])}const v=[];for(const S in h)v.push(h[S]);return v},s.cM=Pt,s.cN=BF,s.cO=m8,s.cP=_F,s.cQ=function(p){p.bucket.createArrays(),p.bucket.tilePixelRatio=Te/(512*p.bucket.overscaling),p.bucket.compareText={},p.bucket.iconsNeedLinear=!1;const l=p.bucket.layers[0],h=l.layout,v=l._unevaluatedLayout._values,S={layoutIconSize:v["icon-size"].possiblyEvaluate(new ki(p.bucket.zoom+1),p.canonical),layoutTextSize:v["text-size"].possiblyEvaluate(new ki(p.bucket.zoom+1),p.canonical),textMaxSize:v["text-size"].possiblyEvaluate(new ki(18))};if(p.bucket.textSizeData.kind==="composite"){const{minZoom:Z,maxZoom:ie}=p.bucket.textSizeData;S.compositeTextSizes=[v["text-size"].possiblyEvaluate(new ki(Z),p.canonical),v["text-size"].possiblyEvaluate(new ki(ie),p.canonical)]}if(p.bucket.iconSizeData.kind==="composite"){const{minZoom:Z,maxZoom:ie}=p.bucket.iconSizeData;S.compositeIconSizes=[v["icon-size"].possiblyEvaluate(new ki(Z),p.canonical),v["icon-size"].possiblyEvaluate(new ki(ie),p.canonical)]}const k=h.get("text-line-height")*gl,R=h.get("text-rotation-alignment")!=="viewport"&&h.get("symbol-placement")!=="point",B=h.get("text-keep-upright"),V=h.get("text-size");for(const Z of p.bucket.features){const ie=h.get("text-font").evaluate(Z,{},p.canonical).join(","),ce=V.evaluate(Z,{},p.canonical),ve=S.layoutTextSize.evaluate(Z,{},p.canonical),Ee=S.layoutIconSize.evaluate(Z,{},p.canonical),Ne={horizontal:{},vertical:void 0},ze=Z.text;let Ve,et=[0,0];if(ze){const ut=ze.toString(),Rt=h.get("text-letter-spacing").evaluate(Z,{},p.canonical)*gl,Bt=Zn(ut)?Rt:0,dr=h.get("text-anchor").evaluate(Z,{},p.canonical),Or=P8(l,Z,p.canonical);if(!Or){const Wr=h.get("text-radial-offset").evaluate(Z,{},p.canonical);et=Wr?I8(dr,[Wr*gl,qC]):h.get("text-offset").evaluate(Z,{},p.canonical).map((Rr=>Rr*gl))}let Pr=R?"center":h.get("text-justify").evaluate(Z,{},p.canonical);const Vr=h.get("symbol-placement")==="point"?h.get("text-max-width").evaluate(Z,{},p.canonical)*gl:1/0,pn=()=>{p.bucket.allowVerticalPlacement&&Ai(ut)&&(Ne.vertical=x2(ze,p.glyphMap,p.glyphPositions,p.imagePositions,ie,Vr,k,dr,"left",Bt,et,s.az.vertical,!0,ve,ce))};if(!R&&Or){const Wr=new Set;if(Pr==="auto")for(let Tr=0;Tr<Or.values.length;Tr+=2)Wr.add(HC(Or.values[Tr]));else Wr.add(Pr);let Rr=!1;for(const Tr of Wr)if(!Ne.horizontal[Tr])if(Rr)Ne.horizontal[Tr]=Ne.horizontal[0];else{const Cn=x2(ze,p.glyphMap,p.glyphPositions,p.imagePositions,ie,Vr,k,"center",Tr,Bt,et,s.az.horizontal,!1,ve,ce);Cn&&(Ne.horizontal[Tr]=Cn,Rr=Cn.positionedLines.length===1)}pn()}else{Pr==="auto"&&(Pr=HC(dr));const Wr=x2(ze,p.glyphMap,p.glyphPositions,p.imagePositions,ie,Vr,k,dr,Pr,Bt,et,s.az.horizontal,!1,ve,ce);Wr&&(Ne.horizontal[Pr]=Wr),pn(),Ai(ut)&&R&&B&&(Ne.vertical=x2(ze,p.glyphMap,p.glyphPositions,p.imagePositions,ie,Vr,k,dr,Pr,Bt,et,s.az.vertical,!1,ve,ce))}}let Ct=!1;if(Z.icon&&Z.icon.name){const ut=p.imageMap[Z.icon.name];ut&&(Ve=pae(p.imagePositions[Z.icon.name],h.get("icon-offset").evaluate(Z,{},p.canonical),h.get("icon-anchor").evaluate(Z,{},p.canonical)),Ct=!!ut.sdf,p.bucket.sdfIcons===void 0?p.bucket.sdfIcons=Ct:p.bucket.sdfIcons!==Ct&&at("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(ut.pixelRatio!==p.bucket.pixelRatio||h.get("icon-rotate").constantOr(1)!==0)&&(p.bucket.iconsNeedLinear=!0))}const rt=R8(Ne.horizontal)||Ne.vertical;p.bucket.iconsInText=!!rt&&rt.iconsInText,(rt||Ve)&&noe(p.bucket,Z,Ne,Ve,p.imageMap,S,ve,Ee,et,Ct,p.canonical,p.subdivisionGranularity)}p.showCollisionBoxes&&p.bucket.generateCollisionDebugBuffers()},s.cR=dC,s.cS=gC,s.cT=mC,s.cU=function(p){const l=new b2;return(function(h,v){for(const S in h.layers)v.writeMessage(3,$ae,h.layers[S])})(p,l),l.finish()},s.cV=function(p,l,h,v,S,k){let R=_8(p,l,h,S,0);return R=_8(R,l,v,k,1),R},s.cW=class{constructor(p){this.maxEntries=p,this.map=new Map}get(p){const l=this.map.get(p);return l!==void 0&&(this.map.delete(p),this.map.set(p,l)),l}set(p,l){if(this.map.has(p))this.map.delete(p);else if(this.map.size>=this.maxEntries){const h=this.map.keys().next().value;this.map.delete(h)}this.map.set(p,l)}clear(){this.map.clear()}},s.cX=tF,s.cY=b2,s.cZ=p8,s.c_=class{constructor(p){this._marks={start:[p.url,"start"].join("#"),end:[p.url,"end"].join("#"),measure:p.url.toString()},performance.mark(this._marks.start)}finish(){performance.mark(this._marks.end);let p=performance.getEntriesByName(this._marks.measure);return p.length===0&&(performance.measure(this._marks.measure,this._marks.start,this._marks.end),p=performance.getEntriesByName(this._marks.measure),performance.clearMarks(this._marks.start),performance.clearMarks(this._marks.end),performance.clearMeasures(this._marks.measure)),p}},s.ca=class extends Ef{},s.cb=Gie,s.cc=class extends Gh{},s.cd=lC,s.ce=function(p){return p<=1?1:Math.pow(2,Math.ceil(Math.log(p)/Math.LN2))},s.cf=j6,s.cg=function(p,l,h){var v=l[0],S=l[1],k=l[2],R=h[3]*v+h[7]*S+h[11]*k+h[15];return p[0]=(h[0]*v+h[4]*S+h[8]*k+h[12])/(R=R||1),p[1]=(h[1]*v+h[5]*S+h[9]*k+h[13])/R,p[2]=(h[2]*v+h[6]*S+h[10]*k+h[14])/R,p},s.ch=class extends Uh{},s.ci=class extends u{},s.cj=function(p,l){return p[0]===l[0]&&p[1]===l[1]&&p[2]===l[2]&&p[3]===l[3]&&p[4]===l[4]&&p[5]===l[5]&&p[6]===l[6]&&p[7]===l[7]&&p[8]===l[8]&&p[9]===l[9]&&p[10]===l[10]&&p[11]===l[11]&&p[12]===l[12]&&p[13]===l[13]&&p[14]===l[14]&&p[15]===l[15]},s.ck=function(p,l){var h=p[0],v=p[1],S=p[2],k=p[3],R=p[4],B=p[5],V=p[6],Z=p[7],ie=p[8],ce=p[9],ve=p[10],Ee=p[11],Ne=p[12],ze=p[13],Ve=p[14],et=p[15],Ct=l[0],rt=l[1],ut=l[2],Rt=l[3],Bt=l[4],dr=l[5],Or=l[6],Pr=l[7],Vr=l[8],pn=l[9],Wr=l[10],Rr=l[11],Tr=l[12],Cn=l[13],xn=l[14],kn=l[15];return Math.abs(h-Ct)<=F*Math.max(1,Math.abs(h),Math.abs(Ct))&&Math.abs(v-rt)<=F*Math.max(1,Math.abs(v),Math.abs(rt))&&Math.abs(S-ut)<=F*Math.max(1,Math.abs(S),Math.abs(ut))&&Math.abs(k-Rt)<=F*Math.max(1,Math.abs(k),Math.abs(Rt))&&Math.abs(R-Bt)<=F*Math.max(1,Math.abs(R),Math.abs(Bt))&&Math.abs(B-dr)<=F*Math.max(1,Math.abs(B),Math.abs(dr))&&Math.abs(V-Or)<=F*Math.max(1,Math.abs(V),Math.abs(Or))&&Math.abs(Z-Pr)<=F*Math.max(1,Math.abs(Z),Math.abs(Pr))&&Math.abs(ie-Vr)<=F*Math.max(1,Math.abs(ie),Math.abs(Vr))&&Math.abs(ce-pn)<=F*Math.max(1,Math.abs(ce),Math.abs(pn))&&Math.abs(ve-Wr)<=F*Math.max(1,Math.abs(ve),Math.abs(Wr))&&Math.abs(Ee-Rr)<=F*Math.max(1,Math.abs(Ee),Math.abs(Rr))&&Math.abs(Ne-Tr)<=F*Math.max(1,Math.abs(Ne),Math.abs(Tr))&&Math.abs(ze-Cn)<=F*Math.max(1,Math.abs(ze),Math.abs(Cn))&&Math.abs(Ve-xn)<=F*Math.max(1,Math.abs(Ve),Math.abs(xn))&&Math.abs(et-kn)<=F*Math.max(1,Math.abs(et),Math.abs(kn))},s.cl=function(p,l){return p[0]=l[0],p[1]=l[1],p[2]=l[2],p[3]=l[3],p[4]=l[4],p[5]=l[5],p[6]=l[6],p[7]=l[7],p[8]=l[8],p[9]=l[9],p[10]=l[10],p[11]=l[11],p[12]=l[12],p[13]=l[13],p[14]=l[14],p[15]=l[15],p},s.cm=p=>p.type==="symbol",s.cn=p=>p.type==="circle",s.co=p=>p.type==="heatmap",s.cp=p=>p.type==="line",s.cq=p=>p.type==="fill",s.cr=p=>p.type==="fill-extrusion",s.cs=p=>p.type==="hillshade",s.ct=p=>p.type==="color-relief",s.cu=p=>p.type==="background",s.cv=p=>p.type==="custom",s.cw=we,s.cx=function(p,l,h){const v=ye(l.x-h.x,l.y-h.y),S=ye(p.x-h.x,p.y-h.y),k=Math.atan2(v[0]*S[1]-v[1]*S[0],(function(R,B){return R[0]*B[0]+R[1]*B[1]})(v,S));return Jt(k)},s.cy=De,s.cz=function(p,l){return Ce[l]&&(p instanceof MouseEvent||p instanceof WheelEvent)},s.d=Ht,s.d0=$6,s.d1=f,s.d2=class{constructor(p,l){this.layers={[X_]:this},this.name=X_,this.version=l?l.version:1,this.extent=l?l.extent:4096,this.length=p.length,this.features=p}feature(p){return new Vae(this.features[p],this.extent)}},s.d3=rh,s.d4=da,s.e=Be,s.f=p=>o(void 0,void 0,void 0,(function*(){if(p.byteLength===0)return createImageBitmap(new ImageData(1,1));const l=new Blob([new Uint8Array(p)],{type:"image/png"});try{return createImageBitmap(l)}catch(h){throw new Error(`Could not load image because of ${h.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`)}})),s.g=Ft,s.h=p=>new Promise(((l,h)=>{const v=new Image;v.onload=()=>{l(v),URL.revokeObjectURL(v.src),v.onload=null,window.requestAnimationFrame((()=>{v.src=_t}))},v.onerror=()=>h(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const S=new Blob([new Uint8Array(p)],{type:"image/png"});v.src=p.byteLength?URL.createObjectURL(S):_t})),s.i=Xt,s.j=(p,l)=>Qt(Be(p,{type:"json"}),l),s.k=fn,s.l=$r,s.m=Qt,s.n=(p,l)=>Qt(Be(p,{type:"arrayBuffer"}),l),s.o=function(p){return new b2(p).readFields(oae,[])},s.p=vF,s.q=function(p){return/[\u02EA\u02EB\u1100-\u11FF\u2E80-\u2FDF\u3000-\u30FF\u3105-\u312F\u3131-\u318E\u31A0-\u4DBF\u4E00-\uA48C\uA490-\uA4C6\uA960-\uA97C\uAC00-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFE10-\uFE1F\uFE30-\uFE4F\uFF00-\uFFEF]|\uD81B[\uDFE0-\uDFFF]|[\uD81C-\uD822\uD840-\uD868\uD86A-\uD86D\uD86F-\uD872\uD874-\uD879\uD880-\uD883\uD885-\uD88C][\uDC00-\uDFFF]|\uD823[\uDC00-\uDCD5\uDCFF-\uDD1E\uDD80-\uDDF2]|\uD82B[\uDFF0-\uDFFF]|\uD82C[\uDC00-\uDEFB]|\uD83C[\uDE00-\uDEFF]|\uD869[\uDC00-\uDEDF\uDF00-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEAD\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0\uDFF0-\uDFFF]|\uD87B[\uDC00-\uDE5D]|\uD87E[\uDC00-\uDE1D]|\uD884[\uDC00-\uDF4A\uDF50-\uDFFF]|\uD88D[\uDC00-\uDC79]/gim.test(String.fromCodePoint(p))},s.r=O_,s.s=Cr,s.t=$a,s.u=Mt,s.v=Ye,s.w=at,s.x=Go,s.y=nt,s.z=Qa})),i("worker",["./shared"],(function(s){class o{constructor(Ce,xe){this.keyCache={},Ce&&this.replace(Ce,xe)}replace(Ce,xe){this._layerConfigs={},this._layers={},this.update(Ce,[],xe)}update(Ce,xe,je){for(const Ge of Ce){this._layerConfigs[Ge.id]=Ge;const Ft=this._layers[Ge.id]=s.bT(Ge,je);Ft._featureFilter=s.aj(Ft.filter,je),this.keyCache[Ge.id]&&delete this.keyCache[Ge.id]}for(const Ge of xe)delete this.keyCache[Ge],delete this._layerConfigs[Ge],delete this._layers[Ge];this.familiesBySource={};const qe=s.cL(Object.values(this._layerConfigs),this.keyCache);for(const Ge of qe){const Ft=Ge.map((Ir=>this._layers[Ir.id])),Et=Ft[0];if(Et.isHidden())continue;const mt=Et.source||"";let ct=this.familiesBySource[mt];ct||(ct=this.familiesBySource[mt]={});const Qt=Et.sourceLayer||s.ai;let Ht=ct[Qt];Ht||(Ht=ct[Qt]=[]),Ht.push(Ft)}}}class c{constructor(Ce){const xe={},je=[];for(const Et in Ce){const mt=Ce[Et],ct=xe[Et]={};for(const Qt in mt){const Ht=mt[+Qt];if(!Ht||Ht.bitmap.width===0||Ht.bitmap.height===0)continue;const Ir={x:0,y:0,w:Ht.bitmap.width+2,h:Ht.bitmap.height+2};je.push(Ir),ct[Qt]={rect:Ir,metrics:Ht.metrics}}}const{w:qe,h:Ge}=s.p(je),Ft=new s.r({width:qe||1,height:Ge||1});for(const Et in Ce){const mt=Ce[Et];for(const ct in mt){const Qt=mt[+ct];if(!Qt||Qt.bitmap.width===0||Qt.bitmap.height===0)continue;const Ht=xe[Et][ct].rect;s.r.copy(Qt.bitmap,Ft,{x:0,y:0},{x:Ht.x+1,y:Ht.y+1},Qt.bitmap)}}this.image=Ft,this.positions=xe}}s.cM("GlyphAtlas",c);class f{constructor(Ce){this.tileID=new s.a2(Ce.tileID.overscaledZ,Ce.tileID.wrap,Ce.tileID.canonical.z,Ce.tileID.canonical.x,Ce.tileID.canonical.y),this.uid=Ce.uid,this.zoom=Ce.zoom,this.pixelRatio=Ce.pixelRatio,this.tileSize=Ce.tileSize,this.source=Ce.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=Ce.showCollisionBoxes,this.collectResourceTiming=!!Ce.collectResourceTiming,this.returnDependencies=!!Ce.returnDependencies,this.promoteId=Ce.promoteId,this.inFlightDependencies=[]}parse(Ce,xe,je,qe,Ge){return s._(this,void 0,void 0,(function*(){this.status="parsing",this.data=Ce,this.collisionBoxArray=new s.ag;const Ft=new s.cN(Object.keys(Ce.layers).sort()),Et=new s.cO(this.tileID,this.promoteId);Et.bucketLayerIDs=[];const mt={},ct={featureIndex:Et,iconDependencies:{},patternDependencies:{},glyphDependencies:{},dashDependencies:{},availableImages:je,subdivisionGranularity:Ge},Qt=xe.familiesBySource[this.source];for(const Re in Qt){const He=Ce.layers[Re];if(!He)continue;He.version===1&&s.w(`Vector tile source "${this.source}" layer "${Re}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const Tt=Ft.encode(Re),Gt=[];for(let Ut=0;Ut<He.length;Ut++){const Xr=He.feature(Ut),Nn=Et.getId(Xr,Re);Gt.push({feature:Xr,id:Nn,index:Ut,sourceLayerIndex:Tt})}for(const Ut of Qt[Re]){const Xr=Ut[0];Xr.source!==this.source&&s.w(`layer.source = ${Xr.source} does not equal this.source = ${this.source}`),Xr.isHidden(this.zoom,!0)||(d(Ut,this.zoom,je),(mt[Xr.id]=Xr.createBucket({index:Et.bucketLayerIDs.length,layers:Ut,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:Tt,sourceID:this.source})).populate(Gt,ct,this.tileID.canonical),Et.bucketLayerIDs.push(Ut.map((Nn=>Nn.id))))}}const Ht=s.bY(ct.glyphDependencies,(Re=>Object.keys(Re).map(Number)));this.inFlightDependencies.forEach((Re=>Re?.abort())),this.inFlightDependencies=[];let Ir=Promise.resolve({});if(Object.keys(Ht).length){const Re=new AbortController;this.inFlightDependencies.push(Re),Ir=qe.sendAsync({type:"GG",data:{stacks:Ht,source:this.source,tileID:this.tileID,type:"glyphs"}},Re)}const Ar=Object.keys(ct.iconDependencies);let $r=Promise.resolve({});if(Ar.length){const Re=new AbortController;this.inFlightDependencies.push(Re),$r=qe.sendAsync({type:"GI",data:{icons:Ar,source:this.source,tileID:this.tileID,type:"icons"}},Re)}const fn=Object.keys(ct.patternDependencies);let zr=Promise.resolve({});if(fn.length){const Re=new AbortController;this.inFlightDependencies.push(Re),zr=qe.sendAsync({type:"GI",data:{icons:fn,source:this.source,tileID:this.tileID,type:"patterns"}},Re)}const Mt=ct.dashDependencies;let en=Promise.resolve({});if(Object.keys(Mt).length){const Re=new AbortController;this.inFlightDependencies.push(Re),en=qe.sendAsync({type:"GDA",data:{dashes:Mt}},Re)}const[jn,Qr,nr,oi]=yield Promise.all([Ir,$r,zr,en]),un=new c(jn),Kn=new s.cP(Qr,nr);for(const Re in mt){const He=mt[Re];He instanceof s.ah?(d(He.layers,this.zoom,je),s.cQ({bucket:He,glyphMap:jn,glyphPositions:un.positions,imageMap:Qr,imagePositions:Kn.iconPositions,showCollisionBoxes:this.showCollisionBoxes,canonical:this.tileID.canonical,subdivisionGranularity:ct.subdivisionGranularity})):He.hasDependencies&&(He instanceof s.cR||He instanceof s.cS||He instanceof s.cT)&&(d(He.layers,this.zoom,je),He.addFeatures(ct,this.tileID.canonical,Kn.patternPositions,oi))}return this.status="done",{buckets:Object.values(mt).filter((Re=>!Re.isEmpty())),featureIndex:Et,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:un.image,imageAtlas:Kn,dashPositions:oi,glyphMap:this.returnDependencies?jn:null,iconMap:this.returnDependencies?Qr:null,glyphPositions:this.returnDependencies?un.positions:null}}))}}function d(ot,Ce,xe){const je=new s.H(Ce);for(const qe of ot)qe.recalculate(je,xe)}class m{constructor(Ce,xe,je,qe,Ge){this.type=Ce,this.properties=je||{},this.extent=Ge,this.pointsArray=xe,this.id=qe}loadGeometry(){return this.pointsArray.map((Ce=>Ce.map((xe=>new s.P(xe.x,xe.y)))))}}class b{constructor(Ce,xe,je){this.version=2,this._myFeatures=Ce,this.name=xe,this.length=Ce.length,this.extent=je}feature(Ce){return this._myFeatures[Ce]}}class x{constructor(){this.layers={}}addLayer(Ce){this.layers[Ce.name]=Ce}}function E(ot){let Ce=s.cU(ot);return Ce.byteOffset===0&&Ce.byteLength===Ce.buffer.byteLength||(Ce=new Uint8Array(Ce)),{vectorTile:ot,rawData:Ce.buffer}}function T(ot,Ce,xe){const{extent:je}=ot,qe=Math.pow(2,xe.z-Ce.z),Ge=(xe.x-Ce.x*qe)*je,Ft=(xe.y-Ce.y*qe)*je,Et=[];for(let mt=0;mt<ot.length;mt++){const ct=ot.feature(mt);let Qt=ct.loadGeometry();for(const Ir of Qt)for(const Ar of Ir)Ar.x=Ar.x*qe-Ge,Ar.y=Ar.y*qe-Ft;const Ht=128;Qt=s.cV(Qt,ct.type,-Ht,-Ht,je+Ht,je+Ht),Qt.length!==0&&Et.push(new m(ct.type,Qt,ct.properties,ct.id,je))}return new b(Et,ot.name,je)}class A{constructor(Ce,xe,je){this.actor=Ce,this.layerIndex=xe,this.availableImages=je,this.fetching={},this.loading={},this.loaded={},this.overzoomedTileResultCache=new s.cW(1e3)}loadVectorTile(Ce,xe){return s._(this,void 0,void 0,(function*(){const je=yield s.n(Ce.request,xe);try{return{vectorTile:Ce.encoding!=="mlt"?new s.cX(new s.cY(je.data)):new s.cZ(je.data),rawData:je.data,cacheControl:je.cacheControl,expires:je.expires}}catch(qe){const Ge=new Uint8Array(je.data);let Ft=`Unable to parse the tile at ${Ce.request.url}, `;throw Ft+=Ge[0]===31&&Ge[1]===139?"please make sure the data is not gzipped and that you have configured the relevant header in the server":`got error: ${qe.message}`,new Error(Ft)}}))}loadTile(Ce){return s._(this,void 0,void 0,(function*(){const{uid:xe,overzoomParameters:je}=Ce;je&&(Ce.request=je.overzoomRequest);const qe=!!(Ce&&Ce.request&&Ce.request.collectResourceTiming)&&new s.c_(Ce.request),Ge=new f(Ce);this.loading[xe]=Ge;const Ft=new AbortController;Ge.abort=Ft;try{const Et=yield this.loadVectorTile(Ce,Ft);if(delete this.loading[xe],!Et)return null;if(je){const Ir=this._getOverzoomTile(Ce,Et.vectorTile);Et.rawData=Ir.rawData,Et.vectorTile=Ir.vectorTile}const mt=Et.rawData,ct={};Et.expires&&(ct.expires=Et.expires),Et.cacheControl&&(ct.cacheControl=Et.cacheControl);const Qt={};if(qe){const Ir=qe.finish();Ir&&(Qt.resourceTiming=JSON.parse(JSON.stringify(Ir)))}Ge.vectorTile=Et.vectorTile;const Ht=Ge.parse(Et.vectorTile,this.layerIndex,this.availableImages,this.actor,Ce.subdivisionGranularity);this.loaded[xe]=Ge,this.fetching[xe]={rawTileData:mt,cacheControl:ct,resourceTiming:Qt};try{const Ir=yield Ht;return s.e({rawTileData:mt.slice(0),encoding:Ce.encoding},Ir,ct,Qt)}finally{delete this.fetching[xe]}}catch(Et){throw delete this.loading[xe],Ge.status="done",this.loaded[xe]=Ge,Et}}))}_getOverzoomTile(Ce,xe){const{tileID:je,source:qe,overzoomParameters:Ge}=Ce,{maxZoomTileID:Ft}=Ge,Et=`${Ft.key}_${je.key}`,mt=this.overzoomedTileResultCache.get(Et);if(mt)return mt;const ct=new x,Qt=this.layerIndex.familiesBySource[qe];for(const Ir in Qt){const Ar=xe.layers[Ir];if(!Ar)continue;const $r=T(Ar,Ft,je.canonical);$r.length>0&&ct.addLayer($r)}const Ht=E(ct);return this.overzoomedTileResultCache.set(Et,Ht),Ht}reloadTile(Ce){return s._(this,void 0,void 0,(function*(){const xe=Ce.uid;if(!this.loaded||!this.loaded[xe])throw new Error("Should not be trying to reload a tile that was never loaded or has been removed");const je=this.loaded[xe];if(je.showCollisionBoxes=Ce.showCollisionBoxes,je.status==="parsing"){const qe=yield je.parse(je.vectorTile,this.layerIndex,this.availableImages,this.actor,Ce.subdivisionGranularity);let Ge;if(this.fetching[xe]){const{rawTileData:Ft,cacheControl:Et,resourceTiming:mt}=this.fetching[xe];delete this.fetching[xe],Ge=s.e({rawTileData:Ft.slice(0),encoding:Ce.encoding},qe,Et,mt)}else Ge=qe;return Ge}if(je.status==="done"&&je.vectorTile)return je.parse(je.vectorTile,this.layerIndex,this.availableImages,this.actor,Ce.subdivisionGranularity)}))}abortTile(Ce){return s._(this,void 0,void 0,(function*(){const xe=this.loading,je=Ce.uid;xe&&xe[je]&&xe[je].abort&&(xe[je].abort.abort(),delete xe[je])}))}removeTile(Ce){return s._(this,void 0,void 0,(function*(){this.loaded&&this.loaded[Ce.uid]&&delete this.loaded[Ce.uid]}))}}class M{constructor(){this.loaded={}}loadTile(Ce){return s._(this,void 0,void 0,(function*(){const{uid:xe,encoding:je,rawImageData:qe,redFactor:Ge,greenFactor:Ft,blueFactor:Et,baseShift:mt}=Ce,ct=qe.width+2,Qt=qe.height+2,Ht=s.b(qe)?new s.R({width:ct,height:Qt},yield s.c$(qe,-1,-1,ct,Qt)):qe,Ir=new s.d0(xe,Ht,je,Ge,Ft,Et,mt);return this.loaded=this.loaded||{},this.loaded[xe]=Ir,Ir}))}removeTile(Ce){const xe=this.loaded,je=Ce.uid;xe&&xe[je]&&delete xe[je]}}var F,N,O=(function(){if(N)return F;function ot(xe,je){if(xe.length!==0){Ce(xe[0],je);for(var qe=1;qe<xe.length;qe++)Ce(xe[qe],!je)}}function Ce(xe,je){for(var qe=0,Ge=0,Ft=0,Et=xe.length,mt=Et-1;Ft<Et;mt=Ft++){var ct=(xe[Ft][0]-xe[mt][0])*(xe[mt][1]+xe[Ft][1]),Qt=qe+ct;Ge+=Math.abs(qe)>=Math.abs(ct)?qe-Qt+ct:ct-Qt+qe,qe=Qt}qe+Ge>=0!=!!je&&xe.reverse()}return N=1,F=function xe(je,qe){var Ge,Ft=je&&je.type;if(Ft==="FeatureCollection")for(Ge=0;Ge<je.features.length;Ge++)xe(je.features[Ge],qe);else if(Ft==="GeometryCollection")for(Ge=0;Ge<je.geometries.length;Ge++)xe(je.geometries[Ge],qe);else if(Ft==="Feature")xe(je.geometry,qe);else if(Ft==="Polygon")ot(je.coordinates,qe);else if(Ft==="MultiPolygon")for(Ge=0;Ge<je.coordinates.length;Ge++)ot(je.coordinates[Ge],qe);return je}})(),U=s.d1(O);const j={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:ot=>ot},H=Math.fround||(W=new Float32Array(1),ot=>(W[0]=+ot,W[0]));var W;class X{constructor(Ce){this.options=Object.assign(Object.create(j),Ce),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(Ce){const{log:xe,minZoom:je,maxZoom:qe}=this.options;xe&&console.time("total time");const Ge=`prepare ${Ce.length} points`;xe&&console.time(Ge),this.points=Ce;const Ft=[];for(let mt=0;mt<Ce.length;mt++){const ct=Ce[mt];if(!ct.geometry)continue;const[Qt,Ht]=ct.geometry.coordinates,Ir=H(G(Qt)),Ar=H(ae(Ht));Ft.push(Ir,Ar,1/0,mt,-1,1),this.options.reduce&&Ft.push(0)}let Et=this.trees[qe+1]=this._createTree(Ft);xe&&console.timeEnd(Ge);for(let mt=qe;mt>=je;mt--){const ct=+Date.now();Et=this.trees[mt]=this._createTree(this._cluster(Et,mt)),xe&&console.log("z%d: %d clusters in %dms",mt,Et.numItems,+Date.now()-ct)}return xe&&console.timeEnd("total time"),this}getClusters(Ce,xe){let je=((Ce[0]+180)%360+360)%360-180;const qe=Math.max(-90,Math.min(90,Ce[1]));let Ge=Ce[2]===180?180:((Ce[2]+180)%360+360)%360-180;const Ft=Math.max(-90,Math.min(90,Ce[3]));if(Ce[2]-Ce[0]>=360)je=-180,Ge=180;else if(je>Ge){const Ht=this.getClusters([je,qe,180,Ft],xe),Ir=this.getClusters([-180,qe,Ge,Ft],xe);return Ht.concat(Ir)}const Et=this.trees[this._limitZoom(xe)],mt=Et.range(G(je),ae(Ft),G(Ge),ae(qe)),ct=Et.data,Qt=[];for(const Ht of mt){const Ir=this.stride*Ht;Qt.push(ct[Ir+5]>1?oe(ct,Ir,this.clusterProps):this.points[ct[Ir+3]])}return Qt}getChildren(Ce){const xe=this._getOriginId(Ce),je=this._getOriginZoom(Ce),qe="No cluster with the specified id.",Ge=this.trees[je];if(!Ge)throw new Error(qe);const Ft=Ge.data;if(xe*this.stride>=Ft.length)throw new Error(qe);const Et=this.options.radius/(this.options.extent*Math.pow(2,je-1)),mt=Ge.within(Ft[xe*this.stride],Ft[xe*this.stride+1],Et),ct=[];for(const Qt of mt){const Ht=Qt*this.stride;Ft[Ht+4]===Ce&&ct.push(Ft[Ht+5]>1?oe(Ft,Ht,this.clusterProps):this.points[Ft[Ht+3]])}if(ct.length===0)throw new Error(qe);return ct}getLeaves(Ce,xe,je){const qe=[];return this._appendLeaves(qe,Ce,xe=xe||10,je=je||0,0),qe}getTile(Ce,xe,je){const qe=this.trees[this._limitZoom(Ce)],Ge=Math.pow(2,Ce),{extent:Ft,radius:Et}=this.options,mt=Et/Ft,ct=(je-mt)/Ge,Qt=(je+1+mt)/Ge,Ht={features:[]};return this._addTileFeatures(qe.range((xe-mt)/Ge,ct,(xe+1+mt)/Ge,Qt),qe.data,xe,je,Ge,Ht),xe===0&&this._addTileFeatures(qe.range(1-mt/Ge,ct,1,Qt),qe.data,Ge,je,Ge,Ht),xe===Ge-1&&this._addTileFeatures(qe.range(0,ct,mt/Ge,Qt),qe.data,-1,je,Ge,Ht),Ht.features.length?Ht:null}getClusterExpansionZoom(Ce){let xe=this._getOriginZoom(Ce)-1;for(;xe<=this.options.maxZoom;){const je=this.getChildren(Ce);if(xe++,je.length!==1)break;Ce=je[0].properties.cluster_id}return xe}_appendLeaves(Ce,xe,je,qe,Ge){const Ft=this.getChildren(xe);for(const Et of Ft){const mt=Et.properties;if(mt&&mt.cluster?Ge+mt.point_count<=qe?Ge+=mt.point_count:Ge=this._appendLeaves(Ce,mt.cluster_id,je,qe,Ge):Ge<qe?Ge++:Ce.push(Et),Ce.length===je)break}return Ge}_createTree(Ce){const xe=new s.aT(Ce.length/this.stride|0,this.options.nodeSize,Float32Array);for(let je=0;je<Ce.length;je+=this.stride)xe.add(Ce[je],Ce[je+1]);return xe.finish(),xe.data=Ce,xe}_addTileFeatures(Ce,xe,je,qe,Ge,Ft){for(const Et of Ce){const mt=Et*this.stride,ct=xe[mt+5]>1;let Qt,Ht,Ir;if(ct)Qt=Q(xe,mt,this.clusterProps),Ht=xe[mt],Ir=xe[mt+1];else{const fn=this.points[xe[mt+3]];Qt=fn.properties;const[zr,Mt]=fn.geometry.coordinates;Ht=G(zr),Ir=ae(Mt)}const Ar={type:1,geometry:[[Math.round(this.options.extent*(Ht*Ge-je)),Math.round(this.options.extent*(Ir*Ge-qe))]],tags:Qt};let $r;$r=ct||this.options.generateId?xe[mt+3]:this.points[xe[mt+3]].id,$r!==void 0&&(Ar.id=$r),Ft.features.push(Ar)}}_limitZoom(Ce){return Math.max(this.options.minZoom,Math.min(Math.floor(+Ce),this.options.maxZoom+1))}_cluster(Ce,xe){const{radius:je,extent:qe,reduce:Ge,minPoints:Ft}=this.options,Et=je/(qe*Math.pow(2,xe)),mt=Ce.data,ct=[],Qt=this.stride;for(let Ht=0;Ht<mt.length;Ht+=Qt){if(mt[Ht+2]<=xe)continue;mt[Ht+2]=xe;const Ir=mt[Ht],Ar=mt[Ht+1],$r=Ce.within(mt[Ht],mt[Ht+1],Et),fn=mt[Ht+5];let zr=fn;for(const Mt of $r){const en=Mt*Qt;mt[en+2]>xe&&(zr+=mt[en+5])}if(zr>fn&&zr>=Ft){let Mt,en=Ir*fn,jn=Ar*fn,Qr=-1;const nr=(Ht/Qt<<5)+(xe+1)+this.points.length;for(const oi of $r){const un=oi*Qt;if(mt[un+2]<=xe)continue;mt[un+2]=xe;const Kn=mt[un+5];en+=mt[un]*Kn,jn+=mt[un+1]*Kn,mt[un+4]=nr,Ge&&(Mt||(Mt=this._map(mt,Ht,!0),Qr=this.clusterProps.length,this.clusterProps.push(Mt)),Ge(Mt,this._map(mt,un)))}mt[Ht+4]=nr,ct.push(en/zr,jn/zr,1/0,nr,-1,zr),Ge&&ct.push(Qr)}else{for(let Mt=0;Mt<Qt;Mt++)ct.push(mt[Ht+Mt]);if(zr>1)for(const Mt of $r){const en=Mt*Qt;if(!(mt[en+2]<=xe)){mt[en+2]=xe;for(let jn=0;jn<Qt;jn++)ct.push(mt[en+jn])}}}}return ct}_getOriginId(Ce){return Ce-this.points.length>>5}_getOriginZoom(Ce){return(Ce-this.points.length)%32}_map(Ce,xe,je){if(Ce[xe+5]>1){const Ft=this.clusterProps[Ce[xe+6]];return je?Object.assign({},Ft):Ft}const qe=this.points[Ce[xe+3]].properties,Ge=this.options.map(qe);return je&&Ge===qe?Object.assign({},Ge):Ge}}function oe(ot,Ce,xe){return{type:"Feature",id:ot[Ce+3],properties:Q(ot,Ce,xe),geometry:{type:"Point",coordinates:[(je=ot[Ce],360*(je-.5)),se(ot[Ce+1])]}};var je}function Q(ot,Ce,xe){const je=ot[Ce+5],qe=je>=1e4?`${Math.round(je/1e3)}k`:je>=1e3?Math.round(je/100)/10+"k":je,Ge=ot[Ce+6],Ft=Ge===-1?{}:Object.assign({},xe[Ge]);return Object.assign(Ft,{cluster:!0,cluster_id:ot[Ce+3],point_count:je,point_count_abbreviated:qe})}function G(ot){return ot/360+.5}function ae(ot){const Ce=Math.sin(ot*Math.PI/180),xe=.5-.25*Math.log((1+Ce)/(1-Ce))/Math.PI;return xe<0?0:xe>1?1:xe}function se(ot){const Ce=(180-360*ot)*Math.PI/180;return 360*Math.atan(Math.exp(Ce))/Math.PI-90}function fe(ot,Ce,xe,je){let qe=je;const Ge=Ce+(xe-Ce>>1);let Ft,Et=xe-Ce;const mt=ot[Ce],ct=ot[Ce+1],Qt=ot[xe],Ht=ot[xe+1];for(let Ir=Ce+3;Ir<xe;Ir+=3){const Ar=_e(ot[Ir],ot[Ir+1],mt,ct,Qt,Ht);if(Ar>qe)Ft=Ir,qe=Ar;else if(Ar===qe){const $r=Math.abs(Ir-Ge);$r<Et&&(Ft=Ir,Et=$r)}}qe>je&&(Ft-Ce>3&&fe(ot,Ce,Ft,je),ot[Ft+2]=qe,xe-Ft>3&&fe(ot,Ft,xe,je))}function _e(ot,Ce,xe,je,qe,Ge){let Ft=qe-xe,Et=Ge-je;if(Ft!==0||Et!==0){const mt=((ot-xe)*Ft+(Ce-je)*Et)/(Ft*Ft+Et*Et);mt>1?(xe=qe,je=Ge):mt>0&&(xe+=Ft*mt,je+=Et*mt)}return Ft=ot-xe,Et=Ce-je,Ft*Ft+Et*Et}function Le(ot,Ce,xe,je){const qe={id:ot??null,type:Ce,geometry:xe,tags:je,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};if(Ce==="Point"||Ce==="MultiPoint"||Ce==="LineString")ye(qe,xe);else if(Ce==="Polygon")ye(qe,xe[0]);else if(Ce==="MultiLineString")for(const Ge of xe)ye(qe,Ge);else if(Ce==="MultiPolygon")for(const Ge of xe)ye(qe,Ge[0]);return qe}function ye(ot,Ce){for(let xe=0;xe<Ce.length;xe+=3)ot.minX=Math.min(ot.minX,Ce[xe]),ot.minY=Math.min(ot.minY,Ce[xe+1]),ot.maxX=Math.max(ot.maxX,Ce[xe]),ot.maxY=Math.max(ot.maxY,Ce[xe+1])}function Te(ot,Ce,xe,je){if(!Ce.geometry)return;const qe=Ce.geometry.coordinates;if(qe&&qe.length===0)return;const Ge=Ce.geometry.type,Ft=Math.pow(xe.tolerance/((1<<xe.maxZoom)*xe.extent),2);let Et=[],mt=Ce.id;if(xe.promoteId?mt=Ce.properties[xe.promoteId]:xe.generateId&&(mt=je||0),Ge==="Point")Ie(qe,Et);else if(Ge==="MultiPoint")for(const ct of qe)Ie(ct,Et);else if(Ge==="LineString")Me(qe,Et,Ft,!1);else if(Ge==="MultiLineString"){if(xe.lineMetrics){for(const ct of qe)Et=[],Me(ct,Et,Ft,!1),ot.push(Le(mt,"LineString",Et,Ce.properties));return}de(qe,Et,Ft,!1)}else if(Ge==="Polygon")de(qe,Et,Ft,!0);else{if(Ge!=="MultiPolygon"){if(Ge==="GeometryCollection"){for(const ct of Ce.geometry.geometries)Te(ot,{id:mt,geometry:ct,properties:Ce.properties},xe,je);return}throw new Error("Input data is not a valid GeoJSON object.")}for(const ct of qe){const Qt=[];de(ct,Qt,Ft,!0),Et.push(Qt)}}ot.push(Le(mt,Ge,Et,Ce.properties))}function Ie(ot,Ce){Ce.push(Se(ot[0]),we(ot[1]),0)}function Me(ot,Ce,xe,je){let qe,Ge,Ft=0;for(let mt=0;mt<ot.length;mt++){const ct=Se(ot[mt][0]),Qt=we(ot[mt][1]);Ce.push(ct,Qt,0),mt>0&&(Ft+=je?(qe*Qt-ct*Ge)/2:Math.sqrt(Math.pow(ct-qe,2)+Math.pow(Qt-Ge,2))),qe=ct,Ge=Qt}const Et=Ce.length-3;Ce[2]=1,fe(Ce,0,Et,xe),Ce[Et+2]=1,Ce.size=Math.abs(Ft),Ce.start=0,Ce.end=Ce.size}function de(ot,Ce,xe,je){for(let qe=0;qe<ot.length;qe++){const Ge=[];Me(ot[qe],Ge,xe,je),Ce.push(Ge)}}function Se(ot){return ot/360+.5}function we(ot){const Ce=Math.sin(ot*Math.PI/180),xe=.5-.25*Math.log((1+Ce)/(1-Ce))/Math.PI;return xe<0?0:xe>1?1:xe}function De(ot,Ce,xe,je,qe,Ge,Ft,Et){if(je/=Ce,Ge>=(xe/=Ce)&&Ft<je)return ot;if(Ft<xe||Ge>=je)return null;const mt=[];for(const ct of ot){const Qt=ct.geometry;let Ht=ct.type;const Ir=qe===0?ct.minX:ct.minY,Ar=qe===0?ct.maxX:ct.maxY;if(Ir>=xe&&Ar<je){mt.push(ct);continue}if(Ar<xe||Ir>=je)continue;let $r=[];if(Ht==="Point"||Ht==="MultiPoint")Fe(Qt,$r,xe,je,qe);else if(Ht==="LineString")Xe(Qt,$r,xe,je,qe,!1,Et.lineMetrics);else if(Ht==="MultiLineString")st(Qt,$r,xe,je,qe,!1);else if(Ht==="Polygon")st(Qt,$r,xe,je,qe,!0);else if(Ht==="MultiPolygon")for(const fn of Qt){const zr=[];st(fn,zr,xe,je,qe,!0),zr.length&&$r.push(zr)}if($r.length){if(Et.lineMetrics&&Ht==="LineString"){for(const fn of $r)mt.push(Le(ct.id,Ht,fn,ct.tags));continue}Ht!=="LineString"&&Ht!=="MultiLineString"||($r.length===1?(Ht="LineString",$r=$r[0]):Ht="MultiLineString"),Ht!=="Point"&&Ht!=="MultiPoint"||(Ht=$r.length===3?"Point":"MultiPoint"),mt.push(Le(ct.id,Ht,$r,ct.tags))}}return mt.length?mt:null}function Fe(ot,Ce,xe,je,qe){for(let Ge=0;Ge<ot.length;Ge+=3){const Ft=ot[Ge+qe];Ft>=xe&&Ft<=je&&Qe(Ce,ot[Ge],ot[Ge+1],ot[Ge+2])}}function Xe(ot,Ce,xe,je,qe,Ge,Ft){let Et=Be(ot);const mt=qe===0?it:be;let ct,Qt,Ht=ot.start;for(let zr=0;zr<ot.length-3;zr+=3){const Mt=ot[zr],en=ot[zr+1],jn=ot[zr+2],Qr=ot[zr+3],nr=ot[zr+4],oi=qe===0?Mt:en,un=qe===0?Qr:nr;let Kn=!1;Ft&&(ct=Math.sqrt(Math.pow(Mt-Qr,2)+Math.pow(en-nr,2))),oi<xe?un>xe&&(Qt=mt(Et,Mt,en,Qr,nr,xe),Ft&&(Et.start=Ht+ct*Qt)):oi>je?un<je&&(Qt=mt(Et,Mt,en,Qr,nr,je),Ft&&(Et.start=Ht+ct*Qt)):Qe(Et,Mt,en,jn),un<xe&&oi>=xe&&(Qt=mt(Et,Mt,en,Qr,nr,xe),Kn=!0),un>je&&oi<=je&&(Qt=mt(Et,Mt,en,Qr,nr,je),Kn=!0),!Ge&&Kn&&(Ft&&(Et.end=Ht+ct*Qt),Ce.push(Et),Et=Be(ot)),Ft&&(Ht+=ct)}let Ir=ot.length-3;const Ar=ot[Ir],$r=ot[Ir+1],fn=qe===0?Ar:$r;fn>=xe&&fn<=je&&Qe(Et,Ar,$r,ot[Ir+2]),Ir=Et.length-3,Ge&&Ir>=3&&(Et[Ir]!==Et[0]||Et[Ir+1]!==Et[1])&&Qe(Et,Et[0],Et[1],Et[2]),Et.length&&Ce.push(Et)}function Be(ot){const Ce=[];return Ce.size=ot.size,Ce.start=ot.start,Ce.end=ot.end,Ce}function st(ot,Ce,xe,je,qe,Ge){for(const Ft of ot)Xe(Ft,Ce,xe,je,qe,Ge,!1)}function Qe(ot,Ce,xe,je){ot.push(Ce,xe,je)}function it(ot,Ce,xe,je,qe,Ge){const Ft=(Ge-Ce)/(je-Ce);return Qe(ot,Ge,xe+(qe-xe)*Ft,1),Ft}function be(ot,Ce,xe,je,qe,Ge){const Ft=(Ge-xe)/(qe-xe);return Qe(ot,Ce+(je-Ce)*Ft,Ge,1),Ft}function Ot(ot,Ce){const xe=[];for(let je=0;je<ot.length;je++){const qe=ot[je],Ge=qe.type;let Ft;if(Ge==="Point"||Ge==="MultiPoint"||Ge==="LineString")Ft=at(qe.geometry,Ce);else if(Ge==="MultiLineString"||Ge==="Polygon"){Ft=[];for(const Et of qe.geometry)Ft.push(at(Et,Ce))}else if(Ge==="MultiPolygon"){Ft=[];for(const Et of qe.geometry){const mt=[];for(const ct of Et)mt.push(at(ct,Ce));Ft.push(mt)}}xe.push(Le(qe.id,Ge,Ft,qe.tags))}return xe}function at(ot,Ce){const xe=[];xe.size=ot.size,ot.start!==void 0&&(xe.start=ot.start,xe.end=ot.end);for(let je=0;je<ot.length;je+=3)xe.push(ot[je]+Ce,ot[je+1],ot[je+2]);return xe}function $e(ot,Ce){if(ot.transformed)return ot;const xe=1<<ot.z,je=ot.x,qe=ot.y;for(const Ge of ot.features){const Ft=Ge.geometry,Et=Ge.type;if(Ge.geometry=[],Et===1)for(let mt=0;mt<Ft.length;mt+=2)Ge.geometry.push(Xt(Ft[mt],Ft[mt+1],Ce,xe,je,qe));else for(let mt=0;mt<Ft.length;mt++){const ct=[];for(let Qt=0;Qt<Ft[mt].length;Qt+=2)ct.push(Xt(Ft[mt][Qt],Ft[mt][Qt+1],Ce,xe,je,qe));Ge.geometry.push(ct)}}return ot.transformed=!0,ot}function Xt(ot,Ce,xe,je,qe,Ge){return[Math.round(xe*(ot*je-qe)),Math.round(xe*(Ce*je-Ge))]}function $t(ot,Ce,xe,je,qe){const Ge=Ce===qe.maxZoom?0:qe.tolerance/((1<<Ce)*qe.extent),Ft={features:[],numPoints:0,numSimplified:0,numFeatures:ot.length,source:null,x:xe,y:je,z:Ce,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0};for(const Et of ot)cr(Ft,Et,Ge,qe);return Ft}function cr(ot,Ce,xe,je){const qe=Ce.geometry,Ge=Ce.type,Ft=[];if(ot.minX=Math.min(ot.minX,Ce.minX),ot.minY=Math.min(ot.minY,Ce.minY),ot.maxX=Math.max(ot.maxX,Ce.maxX),ot.maxY=Math.max(ot.maxY,Ce.maxY),Ge==="Point"||Ge==="MultiPoint")for(let Et=0;Et<qe.length;Et+=3)Ft.push(qe[Et],qe[Et+1]),ot.numPoints++,ot.numSimplified++;else if(Ge==="LineString")_t(Ft,qe,ot,xe,!1,!1);else if(Ge==="MultiLineString"||Ge==="Polygon")for(let Et=0;Et<qe.length;Et++)_t(Ft,qe[Et],ot,xe,Ge==="Polygon",Et===0);else if(Ge==="MultiPolygon")for(let Et=0;Et<qe.length;Et++){const mt=qe[Et];for(let ct=0;ct<mt.length;ct++)_t(Ft,mt[ct],ot,xe,!0,ct===0)}if(Ft.length){let Et=Ce.tags||null;if(Ge==="LineString"&&je.lineMetrics){Et={};for(const ct in Ce.tags)Et[ct]=Ce.tags[ct];Et.mapbox_clip_start=qe.start/qe.size,Et.mapbox_clip_end=qe.end/qe.size}const mt={geometry:Ft,type:Ge==="Polygon"||Ge==="MultiPolygon"?3:Ge==="LineString"||Ge==="MultiLineString"?2:1,tags:Et};Ce.id!==null&&(mt.id=Ce.id),ot.features.push(mt)}}function _t(ot,Ce,xe,je,qe,Ge){const Ft=je*je;if(je>0&&Ce.size<(qe?Ft:je))return void(xe.numPoints+=Ce.length/3);const Et=[];for(let mt=0;mt<Ce.length;mt+=3)(je===0||Ce[mt+2]>Ft)&&(xe.numSimplified++,Et.push(Ce[mt],Ce[mt+1])),xe.numPoints++;qe&&(function(mt,ct){let Qt=0;for(let Ht=0,Ir=mt.length,Ar=Ir-2;Ht<Ir;Ar=Ht,Ht+=2)Qt+=(mt[Ht]-mt[Ar])*(mt[Ht+1]+mt[Ar+1]);if(Qt>0===ct)for(let Ht=0,Ir=mt.length;Ht<Ir/2;Ht+=2){const Ar=mt[Ht],$r=mt[Ht+1];mt[Ht]=mt[Ir-2-Ht],mt[Ht+1]=mt[Ir-1-Ht],mt[Ir-2-Ht]=Ar,mt[Ir-1-Ht]=$r}})(Et,Ge),ot.push(Et)}const gr={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0};class mr{constructor(Ce,xe){const je=(xe=this.options=(function(Ge,Ft){for(const Et in Ft)Ge[Et]=Ft[Et];return Ge})(Object.create(gr),xe)).debug;if(je&&console.time("preprocess data"),xe.maxZoom<0||xe.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(xe.promoteId&&xe.generateId)throw new Error("promoteId and generateId cannot be used together.");let qe=(function(Ge,Ft){const Et=[];if(Ge.type==="FeatureCollection")for(let mt=0;mt<Ge.features.length;mt++)Te(Et,Ge.features[mt],Ft,mt);else Te(Et,Ge.type==="Feature"?Ge:{geometry:Ge},Ft);return Et})(Ce,xe);this.tiles={},this.tileCoords=[],je&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",xe.indexMaxZoom,xe.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),qe=(function(Ge,Ft){const Et=Ft.buffer/Ft.extent;let mt=Ge;const ct=De(Ge,1,-1-Et,Et,0,-1,2,Ft),Qt=De(Ge,1,1-Et,2+Et,0,-1,2,Ft);return(ct||Qt)&&(mt=De(Ge,1,-Et,1+Et,0,-1,2,Ft)||[],ct&&(mt=Ot(ct,1).concat(mt)),Qt&&(mt=mt.concat(Ot(Qt,-1)))),mt})(qe,xe),qe.length&&this.splitTile(qe,0,0,0),je&&(qe.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}splitTile(Ce,xe,je,qe,Ge,Ft,Et){const mt=[Ce,xe,je,qe],ct=this.options,Qt=ct.debug;for(;mt.length;){qe=mt.pop(),je=mt.pop(),xe=mt.pop(),Ce=mt.pop();const Ht=1<<xe,Ir=ar(xe,je,qe);let Ar=this.tiles[Ir];if(!Ar&&(Qt>1&&console.time("creation"),Ar=this.tiles[Ir]=$t(Ce,xe,je,qe,ct),this.tileCoords.push({z:xe,x:je,y:qe}),Qt)){Qt>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",xe,je,qe,Ar.numFeatures,Ar.numPoints,Ar.numSimplified),console.timeEnd("creation"));const Kn=`z${xe}`;this.stats[Kn]=(this.stats[Kn]||0)+1,this.total++}if(Ar.source=Ce,Ge==null){if(xe===ct.indexMaxZoom||Ar.numPoints<=ct.indexMaxPoints)continue}else{if(xe===ct.maxZoom||xe===Ge)continue;if(Ge!=null){const Kn=Ge-xe;if(je!==Ft>>Kn||qe!==Et>>Kn)continue}}if(Ar.source=null,Ce.length===0)continue;Qt>1&&console.time("clipping");const $r=.5*ct.buffer/ct.extent,fn=.5-$r,zr=.5+$r,Mt=1+$r;let en=null,jn=null,Qr=null,nr=null,oi=De(Ce,Ht,je-$r,je+zr,0,Ar.minX,Ar.maxX,ct),un=De(Ce,Ht,je+fn,je+Mt,0,Ar.minX,Ar.maxX,ct);Ce=null,oi&&(en=De(oi,Ht,qe-$r,qe+zr,1,Ar.minY,Ar.maxY,ct),jn=De(oi,Ht,qe+fn,qe+Mt,1,Ar.minY,Ar.maxY,ct),oi=null),un&&(Qr=De(un,Ht,qe-$r,qe+zr,1,Ar.minY,Ar.maxY,ct),nr=De(un,Ht,qe+fn,qe+Mt,1,Ar.minY,Ar.maxY,ct),un=null),Qt>1&&console.timeEnd("clipping"),mt.push(en||[],xe+1,2*je,2*qe),mt.push(jn||[],xe+1,2*je,2*qe+1),mt.push(Qr||[],xe+1,2*je+1,2*qe),mt.push(nr||[],xe+1,2*je+1,2*qe+1)}}getTile(Ce,xe,je){Ce=+Ce,xe=+xe,je=+je;const qe=this.options,{extent:Ge,debug:Ft}=qe;if(Ce<0||Ce>24)return null;const Et=1<<Ce,mt=ar(Ce,xe=xe+Et&Et-1,je);if(this.tiles[mt])return $e(this.tiles[mt],Ge);Ft>1&&console.log("drilling down to z%d-%d-%d",Ce,xe,je);let ct,Qt=Ce,Ht=xe,Ir=je;for(;!ct&&Qt>0;)Qt--,Ht>>=1,Ir>>=1,ct=this.tiles[ar(Qt,Ht,Ir)];return ct&&ct.source?(Ft>1&&(console.log("found parent tile z%d-%d-%d",Qt,Ht,Ir),console.time("drilling down")),this.splitTile(ct.source,Qt,Ht,Ir,Ce,xe,je),Ft>1&&console.timeEnd("drilling down"),this.tiles[mt]?$e(this.tiles[mt],Ge):null):null}}function ar(ot,Ce,xe){return 32*((1<<ot)*xe+Ce)+ot}class Cr extends A{constructor(Ce,xe,je,qe=Er){super(Ce,xe,je),this._dataUpdateable=new Map,this._createGeoJSONIndex=qe}loadVectorTile(Ce,xe){return s._(this,void 0,void 0,(function*(){const je=Ce.tileID.canonical;if(!this._geoJSONIndex)throw new Error("Unable to parse the data into a cluster or geojson");const qe=this._geoJSONIndex.getTile(je.z,je.x,je.y);return qe?E(new s.d2(qe.features,{version:2,extent:s.a5})):null}))}loadData(Ce){return s._(this,void 0,void 0,(function*(){var xe;(xe=this._pendingRequest)===null||xe===void 0||xe.abort();const je=this._startPerformance(Ce);this._pendingRequest=new AbortController;try{(!this._pendingData||Ce.request||Ce.data||Ce.dataDiff)&&(this._pendingData=this.loadAndProcessGeoJSON(Ce,this._pendingRequest));const qe=yield this._pendingData;this._geoJSONIndex=this._createGeoJSONIndex(qe,Ce),this.loaded={};const Ge={};return Ce.request&&(Ge.data=qe),this._finishPerformance(je,Ce,Ge),Ge}catch(qe){if(delete this._pendingRequest,s.Z(qe))return{abandoned:!0};throw qe}}))}_startPerformance(Ce){var xe;if(!((xe=Ce?.request)===null||xe===void 0)&&xe.collectResourceTiming)return new s.c_(Ce.request)}_finishPerformance(Ce,xe,je){if(!Ce)return;const qe=Ce.finish();qe&&(je.resourceTiming={},je.resourceTiming[xe.source]=JSON.parse(JSON.stringify(qe)))}getData(){return s._(this,void 0,void 0,(function*(){return this._pendingData}))}reloadTile(Ce){const xe=this.loaded;return xe&&xe[Ce.uid]?super.reloadTile(Ce):this.loadTile(Ce)}loadAndProcessGeoJSON(Ce,xe){return s._(this,void 0,void 0,(function*(){let je;if(Ce.request?je=yield this.loadGeoJSONFromUrl(Ce.request,Ce.promoteId,xe):Ce.data?je=this._loadGeoJSONFromObject(Ce.data,Ce.promoteId):Ce.dataDiff&&(je=this._loadGeoJSONFromDiff(Ce.dataDiff,Ce.promoteId,Ce.source)),delete this._pendingRequest,typeof je!="object")throw new Error(`Input data given to '${Ce.source}' is not a valid GeoJSON object.`);return U(je,!0),Ce.filter&&(je=this._filterGeoJSON(je,Ce.filter)),je}))}loadGeoJSONFromUrl(Ce,xe,je){return s._(this,void 0,void 0,(function*(){const qe=yield s.j(Ce,je);return this._dataUpdateable=s.a7(qe.data,xe),qe.data}))}_loadGeoJSONFromObject(Ce,xe){return this._dataUpdateable=s.a7(Ce,xe),Ce}_loadGeoJSONFromDiff(Ce,xe,je){if(!this._dataUpdateable)throw new Error(`Cannot update existing geojson data in ${je}`);s.a8(this._dataUpdateable,Ce,xe);const qe=Array.from(this._dataUpdateable.values());return this._toFeatureCollection(qe)}_filterGeoJSON(Ce,xe){const je=s.d3(xe,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(je.result==="error")throw new Error(je.value.map((Ge=>`${Ge.key}: ${Ge.message}`)).join(", "));const qe=Ce.features.filter((Ge=>je.value.evaluate({zoom:0},Ge)));return this._toFeatureCollection(qe)}_toFeatureCollection(Ce){return{type:"FeatureCollection",features:Ce}}removeSource(Ce){return s._(this,void 0,void 0,(function*(){this._pendingRequest&&this._pendingRequest.abort()}))}getClusterExpansionZoom(Ce){return this._geoJSONIndex.getClusterExpansionZoom(Ce.clusterId)}getClusterChildren(Ce){return this._geoJSONIndex.getChildren(Ce.clusterId)}getClusterLeaves(Ce){return this._geoJSONIndex.getLeaves(Ce.clusterId,Ce.limit,Ce.offset)}}function Er(ot,Ce){return Ce.cluster?new X((function({superclusterOptions:xe,clusterProperties:je}){if(!je||!xe)return xe;const qe={},Ge={},Ft={accumulated:null,zoom:0},Et={properties:null},mt=Object.keys(je);for(const ct of mt){const[Qt,Ht]=je[ct],Ir=s.d3(Ht),Ar=s.d3(typeof Qt=="string"?[Qt,["accumulated"],["get",ct]]:Qt);qe[ct]=Ir.value,Ge[ct]=Ar.value}return xe.map=ct=>{Et.properties=ct;const Qt={};for(const Ht of mt)Qt[Ht]=qe[Ht].evaluate(Ft,Et);return Qt},xe.reduce=(ct,Qt)=>{Et.properties=Qt;for(const Ht of mt)Ft.accumulated=ct[Ht],ct[Ht]=Ge[Ht].evaluate(Ft,Et)},xe})(Ce)).load(ot.features):(function(xe,je){return new mr(xe,je)})(ot,Ce.geojsonVtOptions)}class Jt{constructor(Ce){this.self=Ce,this.actor=new s.L(Ce),this.layerIndexes={},this.availableImages={},this.workerSources={},this.demWorkerSources={},this.externalWorkerSourceTypes={},this.globalStates=new Map,this.self.registerWorkerSource=(xe,je)=>{if(this.externalWorkerSourceTypes[xe])throw new Error(`Worker source with name "${xe}" already registered.`);this.externalWorkerSourceTypes[xe]=je},this.self.addProtocol=s.cJ,this.self.removeProtocol=s.cK,this.self.registerRTLTextPlugin=xe=>{s.d4.setMethods(xe)},this.actor.registerMessageHandler("LDT",((xe,je)=>this._getDEMWorkerSource(xe,je.source).loadTile(je))),this.actor.registerMessageHandler("RDT",((xe,je)=>s._(this,void 0,void 0,(function*(){this._getDEMWorkerSource(xe,je.source).removeTile(je)})))),this.actor.registerMessageHandler("GCEZ",((xe,je)=>s._(this,void 0,void 0,(function*(){return this._getWorkerSource(xe,je.type,je.source).getClusterExpansionZoom(je)})))),this.actor.registerMessageHandler("GCC",((xe,je)=>s._(this,void 0,void 0,(function*(){return this._getWorkerSource(xe,je.type,je.source).getClusterChildren(je)})))),this.actor.registerMessageHandler("GCL",((xe,je)=>s._(this,void 0,void 0,(function*(){return this._getWorkerSource(xe,je.type,je.source).getClusterLeaves(je)})))),this.actor.registerMessageHandler("LD",((xe,je)=>this._getWorkerSource(xe,je.type,je.source).loadData(je))),this.actor.registerMessageHandler("GD",((xe,je)=>this._getWorkerSource(xe,je.type,je.source).getData())),this.actor.registerMessageHandler("LT",((xe,je)=>this._getWorkerSource(xe,je.type,je.source).loadTile(je))),this.actor.registerMessageHandler("RT",((xe,je)=>this._getWorkerSource(xe,je.type,je.source).reloadTile(je))),this.actor.registerMessageHandler("AT",((xe,je)=>this._getWorkerSource(xe,je.type,je.source).abortTile(je))),this.actor.registerMessageHandler("RMT",((xe,je)=>this._getWorkerSource(xe,je.type,je.source).removeTile(je))),this.actor.registerMessageHandler("RS",((xe,je)=>s._(this,void 0,void 0,(function*(){if(!this.workerSources[xe]||!this.workerSources[xe][je.type]||!this.workerSources[xe][je.type][je.source])return;const qe=this.workerSources[xe][je.type][je.source];delete this.workerSources[xe][je.type][je.source],qe.removeSource!==void 0&&qe.removeSource(je)})))),this.actor.registerMessageHandler("RM",(xe=>s._(this,void 0,void 0,(function*(){delete this.layerIndexes[xe],delete this.availableImages[xe],delete this.workerSources[xe],delete this.demWorkerSources[xe],this.globalStates.delete(xe)})))),this.actor.registerMessageHandler("SR",((xe,je)=>s._(this,void 0,void 0,(function*(){this.referrer=je})))),this.actor.registerMessageHandler("SRPS",((xe,je)=>this._syncRTLPluginState(xe,je))),this.actor.registerMessageHandler("IS",((xe,je)=>s._(this,void 0,void 0,(function*(){this.self.importScripts(je)})))),this.actor.registerMessageHandler("SI",((xe,je)=>this._setImages(xe,je))),this.actor.registerMessageHandler("UL",((xe,je)=>s._(this,void 0,void 0,(function*(){this._getLayerIndex(xe).update(je.layers,je.removedIds,this._getGlobalState(xe))})))),this.actor.registerMessageHandler("UGS",((xe,je)=>s._(this,void 0,void 0,(function*(){const qe=this._getGlobalState(xe);for(const Ge in je)qe[Ge]=je[Ge]})))),this.actor.registerMessageHandler("SL",((xe,je)=>s._(this,void 0,void 0,(function*(){this._getLayerIndex(xe).replace(je,this._getGlobalState(xe))}))))}_getGlobalState(Ce){let xe=this.globalStates.get(Ce);return xe||(xe={},this.globalStates.set(Ce,xe)),xe}_setImages(Ce,xe){return s._(this,void 0,void 0,(function*(){this.availableImages[Ce]=xe;for(const je in this.workerSources[Ce]){const qe=this.workerSources[Ce][je];for(const Ge in qe)qe[Ge].availableImages=xe}}))}_syncRTLPluginState(Ce,xe){return s._(this,void 0,void 0,(function*(){return yield s.d4.syncState(xe,this.self.importScripts)}))}_getAvailableImages(Ce){let xe=this.availableImages[Ce];return xe||(xe=[]),xe}_getLayerIndex(Ce){let xe=this.layerIndexes[Ce];return xe||(xe=this.layerIndexes[Ce]=new o),xe}_getWorkerSource(Ce,xe,je){if(this.workerSources[Ce]||(this.workerSources[Ce]={}),this.workerSources[Ce][xe]||(this.workerSources[Ce][xe]={}),!this.workerSources[Ce][xe][je]){const qe={sendAsync:(Ge,Ft)=>(Ge.targetMapId=Ce,this.actor.sendAsync(Ge,Ft))};switch(xe){case"vector":this.workerSources[Ce][xe][je]=new A(qe,this._getLayerIndex(Ce),this._getAvailableImages(Ce));break;case"geojson":this.workerSources[Ce][xe][je]=new Cr(qe,this._getLayerIndex(Ce),this._getAvailableImages(Ce));break;default:this.workerSources[Ce][xe][je]=new this.externalWorkerSourceTypes[xe](qe,this._getLayerIndex(Ce),this._getAvailableImages(Ce))}}return this.workerSources[Ce][xe][je]}_getDEMWorkerSource(Ce,xe){return this.demWorkerSources[Ce]||(this.demWorkerSources[Ce]={}),this.demWorkerSources[Ce][xe]||(this.demWorkerSources[Ce][xe]=new M),this.demWorkerSources[Ce][xe]}}return s.i(self)&&(self.worker=new Jt(self)),Jt})),i("index",["exports","./shared"],(function(s,o){var c="5.16.0";function f(){var D=new o.A(4);return o.A!=Float32Array&&(D[1]=0,D[2]=0),D[0]=1,D[3]=1,D}let d,m,b;const x={frame(D,u,g){const w=requestAnimationFrame((L=>{C(),u(L)})),{unsubscribe:C}=o.s(D.signal,"abort",(()=>{C(),cancelAnimationFrame(w),g(new o.a(D.signal.reason))}),!1)},frameAsync(D){return new Promise(((u,g)=>{this.frame(D,u,g)}))},getImageData(D,u=0){return this.getImageCanvasContext(D).getImageData(-u,-u,D.width+2*u,D.height+2*u)},getImageCanvasContext(D){const u=window.document.createElement("canvas"),g=u.getContext("2d",{willReadFrequently:!0});if(!g)throw new Error("failed to create canvas 2d context");return u.width=D.width,u.height=D.height,g.drawImage(D,0,0,D.width,D.height),g},resolveURL:D=>(d||(d=document.createElement("a")),d.href=D,d.href),hardwareConcurrency:typeof navigator<"u"&&navigator.hardwareConcurrency||4,get prefersReducedMotion(){return b!==void 0?b:!!matchMedia&&(m==null&&(m=matchMedia("(prefers-reduced-motion: reduce)")),m.matches)},set prefersReducedMotion(D){b=D}},E=new class{constructor(){this._realTime=typeof performance<"u"&&performance&&performance.now?performance.now.bind(performance):Date.now.bind(Date),this._frozenAt=null}getCurrentTime(){return this._frozenAt!==null?this._frozenAt:this._realTime()}setNow(D){this._frozenAt=D}restoreNow(){this._frozenAt=null}isFrozen(){return this._frozenAt!==null}};function T(){return E.getCurrentTime()}class A{static testProp(u){if(!A.docStyle)return u[0];for(let g=0;g<u.length;g++)if(u[g]in A.docStyle)return u[g];return u[0]}static create(u,g,w){const C=window.document.createElement(u);return g!==void 0&&(C.className=g),w&&w.appendChild(C),C}static createNS(u,g){return window.document.createElementNS(u,g)}static disableDrag(){A.docStyle&&A.selectProp&&(A.userSelect=A.docStyle[A.selectProp],A.docStyle[A.selectProp]="none")}static enableDrag(){A.docStyle&&A.selectProp&&(A.docStyle[A.selectProp]=A.userSelect)}static setTransform(u,g){u.style[A.transformProp]=g}static addEventListener(u,g,w,C={}){u.addEventListener(g,w,"passive"in C?C:C.capture)}static removeEventListener(u,g,w,C={}){u.removeEventListener(g,w,"passive"in C?C:C.capture)}static suppressClickInternal(u){u.preventDefault(),u.stopPropagation(),window.removeEventListener("click",A.suppressClickInternal,!0)}static suppressClick(){window.addEventListener("click",A.suppressClickInternal,!0),window.setTimeout((()=>{window.removeEventListener("click",A.suppressClickInternal,!0)}),0)}static getScale(u){const g=u.getBoundingClientRect();return{x:g.width/u.offsetWidth||1,y:g.height/u.offsetHeight||1,boundingClientRect:g}}static getPoint(u,g,w){const C=g.boundingClientRect;return new o.P((w.clientX-C.left)/g.x-u.clientLeft,(w.clientY-C.top)/g.y-u.clientTop)}static mousePos(u,g){const w=A.getScale(u);return A.getPoint(u,w,g)}static touchPos(u,g){const w=[],C=A.getScale(u);for(let L=0;L<g.length;L++)w.push(A.getPoint(u,C,g[L]));return w}static mouseButton(u){return u.button}static remove(u){u.parentNode&&u.parentNode.removeChild(u)}static sanitize(u){const g=new DOMParser().parseFromString(u,"text/html").body||document.createElement("body"),w=g.querySelectorAll("script");for(const C of w)C.remove();return A.clean(g),g.innerHTML}static isPossiblyDangerous(u,g){const w=g.replace(/\s+/g,"").toLowerCase();return!(!["src","href","xlink:href"].includes(u)||!w.includes("javascript:")&&!w.includes("data:"))||!!u.startsWith("on")||void 0}static clean(u){const g=u.children;for(const w of g)A.removeAttributes(w),A.clean(w)}static removeAttributes(u){for(const{name:g,value:w}of u.attributes)A.isPossiblyDangerous(g,w)&&u.removeAttribute(g)}}A.docStyle=typeof window<"u"&&window.document&&window.document.documentElement.style,A.selectProp=A.testProp(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),A.transformProp=A.testProp(["transform","WebkitTransform"]);const M={supported:!1,testSupport:function(D){!O&&N&&(U?j(D):F=D)}};let F,N,O=!1,U=!1;function j(D){const u=D.createTexture();D.bindTexture(D.TEXTURE_2D,u);try{if(D.texImage2D(D.TEXTURE_2D,0,D.RGBA,D.RGBA,D.UNSIGNED_BYTE,N),D.isContextLost())return;M.supported=!0}catch{}D.deleteTexture(u),O=!0}var H;typeof document<"u"&&(N=document.createElement("img"),N.onload=()=>{F&&j(F),F=null,U=!0},N.onerror=()=>{O=!0,F=null},N.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA="),(function(D){let u,g,w,C;D.resetRequestQueue=()=>{u=[],g=0,w=0,C={}},D.addThrottleControl=re=>{const le=w++;return C[le]=re,le},D.removeThrottleControl=re=>{delete C[re],z()},D.getImage=(re,le,he=!0)=>new Promise(((Pe,Ae)=>{M.supported&&(re.headers||(re.headers={}),re.headers.accept="image/webp,*/*"),o.e(re,{type:"image"}),u.push({abortController:le,requestParameters:re,supportImageRefresh:he,state:"queued",onError:Ue=>{Ae(Ue)},onSuccess:Ue=>{Pe(Ue)}}),z()}));const L=re=>o._(this,void 0,void 0,(function*(){re.state="running";const{requestParameters:le,supportImageRefresh:he,onError:Pe,onSuccess:Ae,abortController:Ue}=re,Ze=he===!1&&!o.i(self)&&!o.g(le.url)&&(!le.headers||Object.keys(le.headers).reduce(((dt,xt)=>dt&&xt==="accept"),!0));g++;const ht=Ze?Y(le,Ue):o.m(le,Ue);try{const dt=yield ht;delete re.abortController,re.state="completed",dt.data instanceof HTMLImageElement||o.b(dt.data)?Ae(dt):dt.data&&Ae({data:yield(pt=dt.data,typeof createImageBitmap=="function"?o.f(pt):o.h(pt)),cacheControl:dt.cacheControl,expires:dt.expires})}catch(dt){delete re.abortController,Pe(dt)}finally{g--,z()}var pt})),z=()=>{const re=(()=>{for(const le of Object.keys(C))if(C[le]())return!0;return!1})()?o.c.MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:o.c.MAX_PARALLEL_IMAGE_REQUESTS;for(let le=g;le<re&&u.length>0;le++){const he=u.shift();he.abortController.signal.aborted?le--:L(he)}},Y=(re,le)=>new Promise(((he,Pe)=>{const Ae=new Image,Ue=re.url,Ze=re.credentials;Ze&&Ze==="include"?Ae.crossOrigin="use-credentials":(Ze&&Ze==="same-origin"||!o.d(Ue))&&(Ae.crossOrigin="anonymous"),le.signal.addEventListener("abort",(()=>{Ae.src="",Pe(new o.a(le.signal.reason))})),Ae.fetchPriority="high",Ae.onload=()=>{Ae.onerror=Ae.onload=null,he({data:Ae})},Ae.onerror=()=>{Ae.onerror=Ae.onload=null,le.signal.aborted||Pe(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))},Ae.src=Ue}))})(H||(H={})),H.resetRequestQueue();class W{constructor(u){this._transformRequestFn=u??null}transformRequest(u,g){return this._transformRequestFn&&this._transformRequestFn(u,g)||{url:u}}setTransformRequest(u){this._transformRequestFn=u}}function X(D){const u=[];if(typeof D=="string")u.push({id:"default",url:D});else if(D&&D.length>0){const g=[];for(const{id:w,url:C}of D){const L=`${w}${C}`;g.indexOf(L)===-1&&(g.push(L),u.push({id:w,url:C}))}}return u}function oe(D,u,g){try{const w=new URL(D);return w.pathname+=`${u}${g}`,w.toString()}catch{throw new Error(`Invalid sprite URL "${D}", must be absolute. Modify style specification directly or use TransformStyleFunction to correct the issue dynamically`)}}function Q(D){const{userImage:u}=D;return!!(u&&u.render&&u.render())&&(D.data.replace(new Uint8Array(u.data.buffer)),!0)}class G extends o.E{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new o.R({width:1,height:1}),this.dirty=!0}destroy(){this.atlasTexture&&(this.atlasTexture.destroy(),this.atlasTexture=null);for(const u of Object.keys(this.images))this.removeImage(u);this.patterns={},this.atlasImage=new o.R({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(u){if(this.loaded!==u&&(this.loaded=u,u)){for(const{ids:g,promiseResolve:w}of this.requestors)w(this._getImagesForIds(g));this.requestors=[]}}getImage(u){const g=this.images[u];if(g&&!g.data&&g.spriteData){const w=g.spriteData;g.data=new o.R({width:w.width,height:w.height},w.context.getImageData(w.x,w.y,w.width,w.height).data),g.spriteData=null}return g}addImage(u,g){if(this.images[u])throw new Error(`Image id ${u} already exist, use updateImage instead`);this._validate(u,g)&&(this.images[u]=g)}_validate(u,g){let w=!0;const C=g.data||g.spriteData;return this._validateStretch(g.stretchX,C&&C.width)||(this.fire(new o.k(new Error(`Image "${u}" has invalid "stretchX" value`))),w=!1),this._validateStretch(g.stretchY,C&&C.height)||(this.fire(new o.k(new Error(`Image "${u}" has invalid "stretchY" value`))),w=!1),this._validateContent(g.content,g)||(this.fire(new o.k(new Error(`Image "${u}" has invalid "content" value`))),w=!1),w}_validateStretch(u,g){if(!u)return!0;let w=0;for(const C of u){if(C[0]<w||C[1]<C[0]||g<C[1])return!1;w=C[1]}return!0}_validateContent(u,g){if(!u)return!0;if(u.length!==4)return!1;const w=g.spriteData,C=w&&w.width||g.data.width,L=w&&w.height||g.data.height;return!(u[0]<0||C<u[0]||u[1]<0||L<u[1]||u[2]<0||C<u[2]||u[3]<0||L<u[3]||u[2]<u[0]||u[3]<u[1])}updateImage(u,g,w=!0){const C=this.getImage(u);if(w&&(C.data.width!==g.data.width||C.data.height!==g.data.height))throw new Error(`size mismatch between old image (${C.data.width}x${C.data.height}) and new image (${g.data.width}x${g.data.height}).`);g.version=C.version+1,this.images[u]=g,this.updatedImages[u]=!0}removeImage(u){const g=this.images[u];delete this.images[u],delete this.patterns[u],g.userImage&&g.userImage.onRemove&&g.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(u){return new Promise(((g,w)=>{let C=!0;if(!this.isLoaded())for(const L of u)this.images[L]||(C=!1);this.isLoaded()||C?g(this._getImagesForIds(u)):this.requestors.push({ids:u,promiseResolve:g})}))}_getImagesForIds(u){const g={};for(const w of u){let C=this.getImage(w);C||(this.fire(new o.l("styleimagemissing",{id:w})),C=this.getImage(w)),C?g[w]={data:C.data.clone(),pixelRatio:C.pixelRatio,sdf:C.sdf,version:C.version,stretchX:C.stretchX,stretchY:C.stretchY,content:C.content,textFitWidth:C.textFitWidth,textFitHeight:C.textFitHeight,hasRenderCallback:!!(C.userImage&&C.userImage.render)}:o.w(`Image "${w}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}return g}getPixelSize(){const{width:u,height:g}=this.atlasImage;return{width:u,height:g}}getPattern(u){const g=this.patterns[u],w=this.getImage(u);if(!w)return null;if(g&&g.position.version===w.version)return g.position;if(g)g.position.version=w.version;else{const C={w:w.data.width+2,h:w.data.height+2,x:0,y:0},L=new o.I(C,w);this.patterns[u]={bin:C,position:L}}return this._updatePatternAtlas(),this.patterns[u].position}bind(u){const g=u.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new o.T(u,this.atlasImage,g.RGBA),this.atlasTexture.bind(g.LINEAR,g.CLAMP_TO_EDGE)}_updatePatternAtlas(){const u=[];for(const L in this.patterns)u.push(this.patterns[L].bin);const{w:g,h:w}=o.p(u),C=this.atlasImage;C.resize({width:g||1,height:w||1});for(const L in this.patterns){const{bin:z}=this.patterns[L],Y=z.x+1,re=z.y+1,le=this.getImage(L).data,he=le.width,Pe=le.height;o.R.copy(le,C,{x:0,y:0},{x:Y,y:re},{width:he,height:Pe}),o.R.copy(le,C,{x:0,y:Pe-1},{x:Y,y:re-1},{width:he,height:1}),o.R.copy(le,C,{x:0,y:0},{x:Y,y:re+Pe},{width:he,height:1}),o.R.copy(le,C,{x:he-1,y:0},{x:Y-1,y:re},{width:1,height:Pe}),o.R.copy(le,C,{x:0,y:0},{x:Y+he,y:re},{width:1,height:Pe})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(u){for(const g of u){if(this.callbackDispatchedThisFrame[g])continue;this.callbackDispatchedThisFrame[g]=!0;const w=this.getImage(g);w||o.w(`Image with ID: "${g}" was not found`),Q(w)&&this.updateImage(g,w)}}cloneImages(){const u={};for(const g in this.images){const w=this.images[g];u[g]=Object.assign(Object.assign({},w),{data:w.data?w.data.clone():null})}return u}}const ae=1e20;function se(D,u,g,w,C,L,z,Y,re){for(let le=u;le<u+w;le++)fe(D,g*L+le,L,C,z,Y,re);for(let le=g;le<g+C;le++)fe(D,le*L+u,1,w,z,Y,re)}function fe(D,u,g,w,C,L,z){L[0]=0,z[0]=-ae,z[1]=ae,C[0]=D[u];for(let Y=1,re=0,le=0;Y<w;Y++){C[Y]=D[u+Y*g];const he=Y*Y;do{const Pe=L[re];le=(C[Y]-C[Pe]+he-Pe*Pe)/(Y-Pe)/2}while(le<=z[re]&&--re>-1);re++,L[re]=Y,z[re]=le,z[re+1]=ae}for(let Y=0,re=0;Y<w;Y++){for(;z[re+1]<Y;)re++;const le=L[re],he=Y-le;D[u+Y*g]=C[le]+he*he}}const _e=o.v.layout_symbol["text-font"].default.join(",");class Le{constructor(u,g,w){this.requestManager=u,this.localIdeographFontFamily=g,this.entries={},this.lang=w}setURL(u){this.url=u}getGlyphs(u){return o._(this,void 0,void 0,(function*(){const g=[];for(const L in u)for(const z of u[L])g.push(this._getAndCacheGlyphsPromise(L,z));const w=yield Promise.all(g),C={};for(const{stack:L,id:z,glyph:Y}of w)C[L]||(C[L]={}),C[L][z]=Y&&{id:Y.id,bitmap:Y.bitmap.clone(),metrics:Y.metrics};return C}))}_getAndCacheGlyphsPromise(u,g){return o._(this,void 0,void 0,(function*(){let w=this.entries[u];w||(w=this.entries[u]={glyphs:{},requests:{},ranges:{}});let C=w.glyphs[g];return C!==void 0?{stack:u,id:g,glyph:C}:!this.url||this._charUsesLocalIdeographFontFamily(g)?(C=w.glyphs[g]=this._drawGlyph(w,u,g),{stack:u,id:g,glyph:C}):yield this._downloadAndCacheRangePromise(u,g)}))}_downloadAndCacheRangePromise(u,g){return o._(this,void 0,void 0,(function*(){const w=this.entries[u],C=Math.floor(g/256);if(w.ranges[C])return{stack:u,id:g,glyph:null};if(!w.requests[C]){const L=Le.loadGlyphRange(u,C,this.url,this.requestManager);w.requests[C]=L}try{const L=yield w.requests[C];for(const z in L)w.glyphs[+z]=L[+z];return w.ranges[C]=!0,{stack:u,id:g,glyph:L[g]||null}}catch(L){const z=w.glyphs[g]=this._drawGlyph(w,u,g);return this._warnOnMissingGlyphRange(z,C,g,L),{stack:u,id:g,glyph:z}}}))}_warnOnMissingGlyphRange(u,g,w,C){const L=256*g,z=L+255,Y=w.toString(16).padStart(4,"0").toUpperCase();o.w(`Unable to load glyph range ${g}, ${L}-${z}. Rendering codepoint U+${Y} locally instead. ${C}`)}_charUsesLocalIdeographFontFamily(u){return!!this.localIdeographFontFamily&&o.q(u)}_drawGlyph(u,g,w){const C=g===_e&&this.localIdeographFontFamily!==""&&this._charUsesLocalIdeographFontFamily(w),L=C?"ideographTinySDF":"tinySDF";u[L]||(u[L]=this._createTinySDF(C?this.localIdeographFontFamily:g));const z=u[L].draw(String.fromCodePoint(w)),Y=new RegExp("^\\p{gc=Cf}+$","u").test(String.fromCodePoint(w));return{id:w,bitmap:new o.r({width:z.width||60,height:z.height||60},z.data),metrics:{width:Y?0:z.glyphWidth/2||24,height:z.glyphHeight/2||24,left:z.glyphLeft/2+.5||0,top:z.glyphTop/2-27.5||-8,advance:Y?0:z.glyphAdvance/2||24,isDoubleResolution:!0}}}_createTinySDF(u){const g=u?u.split(","):[];g.push("sans-serif");const w=g.map((C=>/[-\w]+/.test(C)?C:`'${CSS.escape(C)}'`)).join(",");return new Le.TinySDF({fontSize:48,buffer:6,radius:16,cutoff:.25,fontFamily:w,fontWeight:this._fontWeight(g[0]),fontStyle:this._fontStyle(g[0]),lang:this.lang})}_fontStyle(u){return/italic/i.test(u)?"italic":/oblique/i.test(u)?"oblique":"normal"}_fontWeight(u){const g={thin:100,hairline:100,"extra light":200,"ultra light":200,light:300,normal:400,regular:400,medium:500,semibold:600,demibold:600,bold:700,"extra bold":800,"ultra bold":800,black:900,heavy:900,"extra black":950,"ultra black":950};let w;for(const[C,L]of Object.entries(g))new RegExp(`\\b${C}\\b`,"i").test(u)&&(w=`${L}`);return w}destroy(){for(const u in this.entries){const g=this.entries[u];g.tinySDF&&(g.tinySDF=null),g.ideographTinySDF&&(g.ideographTinySDF=null),g.glyphs={},g.requests={},g.ranges={}}this.entries={}}}Le.loadGlyphRange=function(D,u,g,w){return o._(this,void 0,void 0,(function*(){const C=256*u,L=C+255,z=w.transformRequest(g.replace("{fontstack}",D).replace("{range}",`${C}-${L}`),"Glyphs"),Y=yield o.n(z,new AbortController);if(!Y||!Y.data)throw new Error(`Could not load glyph range. range: ${u}, ${C}-${L}`);const re={};for(const le of o.o(Y.data))re[le.id]=le;return re}))},Le.TinySDF=class{constructor({fontSize:D=24,buffer:u=3,radius:g=8,cutoff:w=.25,fontFamily:C="sans-serif",fontWeight:L="normal",fontStyle:z="normal",lang:Y=null}={}){this.buffer=u,this.cutoff=w,this.radius=g,this.lang=Y;const re=this.size=D+4*u,le=this._createCanvas(re),he=this.ctx=le.getContext("2d",{willReadFrequently:!0});he.font=`${z} ${L} ${D}px ${C}`,he.textBaseline="alphabetic",he.textAlign="left",he.fillStyle="black",this.gridOuter=new Float64Array(re*re),this.gridInner=new Float64Array(re*re),this.f=new Float64Array(re),this.z=new Float64Array(re+1),this.v=new Uint16Array(re)}_createCanvas(D){const u=document.createElement("canvas");return u.width=u.height=D,u}draw(D){const{width:u,actualBoundingBoxAscent:g,actualBoundingBoxDescent:w,actualBoundingBoxLeft:C,actualBoundingBoxRight:L}=this.ctx.measureText(D),z=Math.ceil(g),Y=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(L-C))),re=Math.min(this.size-this.buffer,z+Math.ceil(w)),le=Y+2*this.buffer,he=re+2*this.buffer,Pe=Math.max(le*he,0),Ae=new Uint8ClampedArray(Pe),Ue={data:Ae,width:le,height:he,glyphWidth:Y,glyphHeight:re,glyphTop:z,glyphLeft:0,glyphAdvance:u};if(Y===0||re===0)return Ue;const{ctx:Ze,buffer:ht,gridInner:pt,gridOuter:dt}=this;this.lang&&(Ze.lang=this.lang),Ze.clearRect(ht,ht,Y,re),Ze.fillText(D,ht,ht+z);const xt=Ze.getImageData(ht,ht,Y,re);dt.fill(ae,0,Pe),pt.fill(0,0,Pe);for(let Nt=0;Nt<re;Nt++)for(let wt=0;wt<Y;wt++){const Lt=xt.data[4*(Nt*Y+wt)+3]/255;if(Lt===0)continue;const jt=(Nt+ht)*le+wt+ht;if(Lt===1)dt[jt]=0,pt[jt]=ae;else{const Dt=.5-Lt;dt[jt]=Dt>0?Dt*Dt:0,pt[jt]=Dt<0?Dt*Dt:0}}se(dt,0,0,le,he,le,this.f,this.v,this.z),se(pt,ht,ht,Y,re,le,this.f,this.v,this.z);for(let Nt=0;Nt<Pe;Nt++){const wt=Math.sqrt(dt[Nt])-Math.sqrt(pt[Nt]);Ae[Nt]=Math.round(255-255*(wt/this.radius+this.cutoff))}return Ue}};class ye{constructor(){this.specification=o.u.light.position}possiblyEvaluate(u,g){return o.F(u.expression.evaluate(g))}interpolate(u,g,w){return{x:o.G.number(u.x,g.x,w),y:o.G.number(u.y,g.y,w),z:o.G.number(u.z,g.z,w)}}}let Te;class Ie extends o.E{constructor(u){super(),Te=Te||new o.t({anchor:new o.D(o.u.light.anchor),position:new ye,color:new o.D(o.u.light.color),intensity:new o.D(o.u.light.intensity)}),this._transitionable=new o.x(Te,void 0),this.setLight(u),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(u,g={}){if(!this._validate(o.y,u,g))for(const w in u){const C=u[w];w.endsWith(o.z)?this._transitionable.setTransition(w.slice(0,-o.z.length),C):this._transitionable.setValue(w,C)}}updateTransitions(u){this._transitioning=this._transitionable.transitioned(u,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(u){this.properties=this._transitioning.possiblyEvaluate(u)}_validate(u,g,w){return(!w||w.validate!==!1)&&o.B(this,u.call(o.C,{value:g,style:{glyphs:!0,sprite:!0},styleSpec:o.u}))}}const Me=new o.t({"sky-color":new o.D(o.u.sky["sky-color"]),"horizon-color":new o.D(o.u.sky["horizon-color"]),"fog-color":new o.D(o.u.sky["fog-color"]),"fog-ground-blend":new o.D(o.u.sky["fog-ground-blend"]),"horizon-fog-blend":new o.D(o.u.sky["horizon-fog-blend"]),"sky-horizon-blend":new o.D(o.u.sky["sky-horizon-blend"]),"atmosphere-blend":new o.D(o.u.sky["atmosphere-blend"])});class de extends o.E{constructor(u){super(),this._transitionable=new o.x(Me,void 0),this.setSky(u),this._transitioning=this._transitionable.untransitioned(),this.recalculate(new o.H(0))}setSky(u,g={}){if(!this._validate(o.J,u,g)){u||(u={"sky-color":"transparent","horizon-color":"transparent","fog-color":"transparent","fog-ground-blend":1,"atmosphere-blend":0});for(const w in u){const C=u[w];w.endsWith(o.z)?this._transitionable.setTransition(w.slice(0,-o.z.length),C):this._transitionable.setValue(w,C)}}}getSky(){return this._transitionable.serialize()}updateTransitions(u){this._transitioning=this._transitionable.transitioned(u,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(u){this.properties=this._transitioning.possiblyEvaluate(u)}_validate(u,g,w={}){return w?.validate!==!1&&o.B(this,u.call(o.C,o.e({value:g,style:{glyphs:!0,sprite:!0},styleSpec:o.u})))}calculateFogBlendOpacity(u){return u<60?0:u<70?(u-60)/10:1}}class Se{constructor(u,g){this.width=u,this.height=g,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}}getDash(u,g){const w=u.join(",")+String(g);return this.dashEntry[w]||(this.dashEntry[w]=this.addDash(u,g)),this.dashEntry[w]}getDashRanges(u,g,w){const C=[];let L=u.length%2==1?-u[u.length-1]*w:0,z=u[0]*w,Y=!0;C.push({left:L,right:z,isDash:Y,zeroLength:u[0]===0});let re=u[0];for(let le=1;le<u.length;le++){Y=!Y;const he=u[le];L=re*w,re+=he,z=re*w,C.push({left:L,right:z,isDash:Y,zeroLength:he===0})}return C}addRoundDash(u,g,w){const C=g/2;for(let L=-w;L<=w;L++){const z=this.width*(this.nextRow+w+L);let Y=0,re=u[Y];for(let le=0;le<this.width;le++){le/re.right>1&&(re=u[++Y]);const he=Math.abs(le-re.left),Pe=Math.abs(le-re.right),Ae=Math.min(he,Pe);let Ue;const Ze=L/w*(C+1);if(re.isDash){const ht=C-Math.abs(Ze);Ue=Math.sqrt(Ae*Ae+ht*ht)}else Ue=C-Math.sqrt(Ae*Ae+Ze*Ze);this.data[z+le]=Math.max(0,Math.min(255,Ue+128))}}}addRegularDash(u){for(let Y=u.length-1;Y>=0;--Y){const re=u[Y],le=u[Y+1];re.zeroLength?u.splice(Y,1):le&&le.isDash===re.isDash&&(le.left=re.left,u.splice(Y,1))}const g=u[0],w=u[u.length-1];g.isDash===w.isDash&&(g.left=w.left-this.width,w.right=g.right+this.width);const C=this.width*this.nextRow;let L=0,z=u[L];for(let Y=0;Y<this.width;Y++){Y/z.right>1&&(z=u[++L]);const re=Math.abs(Y-z.left),le=Math.abs(Y-z.right),he=Math.min(re,le);this.data[C+Y]=Math.max(0,Math.min(255,(z.isDash?he:-he)+128))}}addDash(u,g){const w=g?7:0,C=2*w+1;if(this.nextRow+C>this.height)return o.w("LineAtlas out of space"),null;let L=0;for(let Y=0;Y<u.length;Y++)L+=u[Y];if(L!==0){const Y=this.width/L,re=this.getDashRanges(u,this.width,Y);g?this.addRoundDash(re,Y,w):this.addRegularDash(re)}const z={y:this.nextRow+w,height:2*w,width:L};return this.nextRow+=C,this.dirty=!0,z}bind(u){const g=u.gl;this.texture?(g.bindTexture(g.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,g.texSubImage2D(g.TEXTURE_2D,0,0,0,this.width,this.height,g.ALPHA,g.UNSIGNED_BYTE,this.data))):(this.texture=g.createTexture(),g.bindTexture(g.TEXTURE_2D,this.texture),g.texParameteri(g.TEXTURE_2D,g.TEXTURE_WRAP_S,g.REPEAT),g.texParameteri(g.TEXTURE_2D,g.TEXTURE_WRAP_T,g.REPEAT),g.texParameteri(g.TEXTURE_2D,g.TEXTURE_MIN_FILTER,g.LINEAR),g.texParameteri(g.TEXTURE_2D,g.TEXTURE_MAG_FILTER,g.LINEAR),g.texImage2D(g.TEXTURE_2D,0,g.ALPHA,this.width,this.height,0,g.ALPHA,g.UNSIGNED_BYTE,this.data))}}const we="maplibre_preloaded_worker_pool";class De{constructor(){this.active={}}acquire(u){if(!this.workers)for(this.workers=[];this.workers.length<De.workerCount;)this.workers.push(new Worker(o.c.WORKER_URL));return this.active[u]=!0,this.workers.slice()}release(u){delete this.active[u],this.numActive()===0&&(this.workers.forEach((g=>{g.terminate()})),this.workers=null)}isPreloaded(){return!!this.active[we]}numActive(){return Object.keys(this.active).length}}const Fe=Math.floor(x.hardwareConcurrency/2);let Xe,Be;function st(){return Xe||(Xe=new De),Xe}De.workerCount=o.K(globalThis)?Math.max(Math.min(Fe,3),1):1;class Qe{constructor(u,g){this.workerPool=u,this.actors=[],this.currentActor=0,this.id=g;const w=this.workerPool.acquire(g);for(let C=0;C<w.length;C++){const L=new o.L(w[C],g);L.name=`Worker ${C}`,this.actors.push(L)}if(!this.actors.length)throw new Error("No actors found")}broadcast(u,g){const w=[];for(const C of this.actors)w.push(C.sendAsync({type:u,data:g}));return Promise.all(w)}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(u=!0){this.actors.forEach((g=>{g.remove()})),this.actors=[],u&&this.workerPool.release(this.id)}registerMessageHandler(u,g){for(const w of this.actors)w.registerMessageHandler(u,g)}unregisterMessageHandler(u){for(const g of this.actors)g.unregisterMessageHandler(u)}}function it(){return Be||(Be=new Qe(st(),o.M),Be.registerMessageHandler("GR",((D,u,g)=>o.m(u,g)))),Be}function be(D,u){const g=o.N();return o.O(g,g,[1,1,0]),o.Q(g,g,[.5*D.width,.5*D.height,1]),D.calculatePosMatrix?o.S(g,g,D.calculatePosMatrix(u.toUnwrapped())):g}function Ot(D,u,g,w,C,L,z){var Y;const re=(function(Ae,Ue,Ze){if(Ae)for(const ht of Ae){const pt=Ue[ht];if(pt&&pt.source===Ze&&pt.type==="fill-extrusion")return!0}else for(const ht in Ue){const pt=Ue[ht];if(pt.source===Ze&&pt.type==="fill-extrusion")return!0}return!1})((Y=C?.layers)!==null&&Y!==void 0?Y:null,u,D.id),le=L.maxPitchScaleFactor(),he=D.tilesIn(w,le,re);he.sort(at);const Pe=[];for(const Ae of he)Pe.push({wrappedTileID:Ae.tileID.wrapped().key,queryResults:Ae.tile.queryRenderedFeatures(u,g,D.getState(),Ae.queryGeometry,Ae.cameraQueryGeometry,Ae.scale,C,L,le,be(L,Ae.tileID),z?(Ue,Ze)=>z(Ae.tileID,Ue,Ze):void 0)});return(function(Ae,Ue){for(const Ze in Ae)for(const ht of Ae[Ze])$e(ht,Ue);return Ae})((function(Ae){const Ue={},Ze={};for(const ht of Ae){const pt=ht.queryResults,dt=ht.wrappedTileID,xt=Ze[dt]=Ze[dt]||{};for(const Nt in pt){const wt=pt[Nt],Lt=xt[Nt]=xt[Nt]||{},jt=Ue[Nt]=Ue[Nt]||[];for(const Dt of wt)Lt[Dt.featureIndex]||(Lt[Dt.featureIndex]=!0,jt.push(Dt))}}return Ue})(Pe),D)}function at(D,u){const g=D.tileID,w=u.tileID;return g.overscaledZ-w.overscaledZ||g.canonical.y-w.canonical.y||g.wrap-w.wrap||g.canonical.x-w.canonical.x}function $e(D,u){const g=D.feature,w=u.getFeatureState(g.layer["source-layer"],g.id);g.source=g.layer.source,g.layer["source-layer"]&&(g.sourceLayer=g.layer["source-layer"]),g.state=w}function Xt(D,u,g){return o._(this,void 0,void 0,(function*(){let w=D;if(D.url?w=(yield o.j(u.transformRequest(D.url,"Source"),g)).data:yield x.frameAsync(g),!w)return null;const C=o.U(o.e(w,D),["tiles","minzoom","maxzoom","attribution","bounds","scheme","tileSize","encoding"]);return"vector_layers"in w&&w.vector_layers&&(C.vectorLayerIds=w.vector_layers.map((L=>L.id))),C}))}class $t{constructor(u,g){u&&(g?this.setSouthWest(u).setNorthEast(g):Array.isArray(u)&&(u.length===4?this.setSouthWest([u[0],u[1]]).setNorthEast([u[2],u[3]]):this.setSouthWest(u[0]).setNorthEast(u[1])))}setNorthEast(u){return this._ne=u instanceof o.V?new o.V(u.lng,u.lat):o.V.convert(u),this}setSouthWest(u){return this._sw=u instanceof o.V?new o.V(u.lng,u.lat):o.V.convert(u),this}extend(u){const g=this._sw,w=this._ne;let C,L;if(u instanceof o.V)C=u,L=u;else{if(!(u instanceof $t))return Array.isArray(u)?u.length===4||u.every(Array.isArray)?this.extend($t.convert(u)):this.extend(o.V.convert(u)):u&&("lng"in u||"lon"in u)&&"lat"in u?this.extend(o.V.convert(u)):this;if(C=u._sw,L=u._ne,!C||!L)return this}return g||w?(g.lng=Math.min(C.lng,g.lng),g.lat=Math.min(C.lat,g.lat),w.lng=Math.max(L.lng,w.lng),w.lat=Math.max(L.lat,w.lat)):(this._sw=new o.V(C.lng,C.lat),this._ne=new o.V(L.lng,L.lat)),this}getCenter(){return new o.V((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new o.V(this.getWest(),this.getNorth())}getSouthEast(){return new o.V(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(u){const{lng:g,lat:w}=o.V.convert(u);let C=this._sw.lng<=g&&g<=this._ne.lng;return this._sw.lng>this._ne.lng&&(C=this._sw.lng>=g&&g>=this._ne.lng),this._sw.lat<=w&&w<=this._ne.lat&&C}intersects(u){if(!((u=$t.convert(u)).getNorth()>=this.getSouth()&&u.getSouth()<=this.getNorth()))return!1;const g=Math.abs(this.getEast()-this.getWest()),w=Math.abs(u.getEast()-u.getWest());if(g>=360||w>=360)return!0;const C=o.W(this.getWest(),-180,180),L=o.W(this.getEast(),-180,180),z=o.W(u.getWest(),-180,180),Y=o.W(u.getEast(),-180,180),re=C>=L,le=z>=Y;return!(!re||!le)||(re?Y>=C||z<=L:le?L>=z||C<=Y:z<=L&&Y>=C)}static convert(u){return u instanceof $t?u:u&&new $t(u)}static fromLngLat(u,g=0){const w=360*g/40075017,C=w/Math.cos(Math.PI/180*u.lat);return new $t(new o.V(u.lng-C,u.lat-w),new o.V(u.lng+C,u.lat+w))}adjustAntiMeridian(){const u=new o.V(this._sw.lng,this._sw.lat),g=new o.V(this._ne.lng,this._ne.lat);return new $t(u,u.lng>g.lng?new o.V(g.lng+360,g.lat):g)}}class cr{constructor(u,g,w){this.bounds=$t.convert(this.validateBounds(u)),this.minzoom=g||0,this.maxzoom=w||24}validateBounds(u){return Array.isArray(u)&&u.length===4?[Math.max(-180,u[0]),Math.max(-90,u[1]),Math.min(180,u[2]),Math.min(90,u[3])]:[-180,-90,180,90]}contains(u){const g=Math.pow(2,u.z),w=Math.floor(o.Y(this.bounds.getWest())*g),C=Math.floor(o.X(this.bounds.getNorth())*g),L=Math.ceil(o.Y(this.bounds.getEast())*g),z=Math.ceil(o.X(this.bounds.getSouth())*g);return u.x>=w&&u.x<L&&u.y>=C&&u.y<z}}class _t extends o.E{constructor(u,g,w,C){if(super(),this.id=u,this.dispatcher=w,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,o.e(this,o.U(g,["url","scheme","tileSize","promoteId","encoding"])),this._options=o.e({type:"vector"},g),this._collectResourceTiming=g.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(C)}load(){return o._(this,void 0,void 0,(function*(){this._loaded=!1,this.fire(new o.l("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const u=yield Xt(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,this.map.style.tileManagers[this.id].clearTiles(),u&&(o.e(this,u),u.bounds&&(this.tileBounds=new cr(u.bounds,this.minzoom,this.maxzoom)),this.fire(new o.l("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new o.l("data",{dataType:"source",sourceDataType:"content"})))}catch(u){this._tileJSONRequest=null,this._loaded=!0,o.Z(u)||this.fire(new o.k(u))}}))}loaded(){return this._loaded}hasTile(u){return!this.tileBounds||this.tileBounds.contains(u.canonical)}onAdd(u){this.map=u,this.load()}setSourceProperty(u){this._tileJSONRequest&&this._tileJSONRequest.abort(),u(),this.load()}setTiles(u){return this.setSourceProperty((()=>{this._options.tiles=u})),this}setUrl(u){return this.setSourceProperty((()=>{this.url=u,this._options.url=u})),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}serialize(){return o.e({},this._options)}loadTile(u){return o._(this,void 0,void 0,(function*(){const g=u.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),w={request:this.map._requestManager.transformRequest(g,"Tile"),uid:u.uid,tileID:u.tileID,zoom:u.tileID.overscaledZ,tileSize:this.tileSize*u.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,subdivisionGranularity:this.map.style.projection.subdivisionGranularity,encoding:this.encoding,overzoomParameters:this._getOverzoomParameters(u)};w.request.collectResourceTiming=this._collectResourceTiming;let C="RT";if(u.actor&&u.state!=="expired"){if(u.state==="loading")return new Promise(((L,z)=>{u.reloadPromise={resolve:L,reject:z}}))}else u.actor=this.dispatcher.getActor(),C="LT";u.abortController=new AbortController;try{const L=yield u.actor.sendAsync({type:C,data:w},u.abortController);if(delete u.abortController,u.aborted)return;this._afterTileLoadWorkerResponse(u,L)}catch(L){if(delete u.abortController,u.aborted)return;if(L&&L.status!==404)throw L;this._afterTileLoadWorkerResponse(u,null)}}))}_getOverzoomParameters(u){if(u.tileID.canonical.z<=this.maxzoom||this.map._zoomLevelsToOverscale===void 0)return;const g=u.tileID.scaledTo(this.maxzoom).canonical,w=g.url(this.tiles,this.map.getPixelRatio(),this.scheme);return{maxZoomTileID:g,overzoomRequest:this.map._requestManager.transformRequest(w,"Tile")}}_afterTileLoadWorkerResponse(u,g){if(g&&g.resourceTiming&&(u.resourceTiming=g.resourceTiming),g&&this.map._refreshExpiredTiles&&u.setExpiryData(g),u.loadVectorData(g,this.map.painter),u.reloadPromise){const w=u.reloadPromise;u.reloadPromise=null,this.loadTile(u).then(w.resolve).catch(w.reject)}}abortTile(u){return o._(this,void 0,void 0,(function*(){u.abortController&&(u.abortController.abort(),delete u.abortController),u.actor&&(yield u.actor.sendAsync({type:"AT",data:{uid:u.uid,type:this.type,source:this.id}}))}))}unloadTile(u){return o._(this,void 0,void 0,(function*(){u.unloadVectorData(),u.actor&&(yield u.actor.sendAsync({type:"RMT",data:{uid:u.uid,type:this.type,source:this.id}}))}))}hasTransition(){return!1}}class gr extends o.E{constructor(u,g,w,C){super(),this.id=u,this.dispatcher=w,this.setEventedParent(C),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=o.e({type:"raster"},g),o.e(this,o.U(g,["url","scheme","tileSize"]))}load(){return o._(this,arguments,void 0,(function*(u=!1){this._loaded=!1,this.fire(new o.l("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const g=yield Xt(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,g&&(o.e(this,g),g.bounds&&(this.tileBounds=new cr(g.bounds,this.minzoom,this.maxzoom)),this.fire(new o.l("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new o.l("data",{dataType:"source",sourceDataType:"content",sourceDataChanged:u})))}catch(g){this._tileJSONRequest=null,this._loaded=!0,o.Z(g)||this.fire(new o.k(g))}}))}loaded(){return this._loaded}onAdd(u){this.map=u,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}setSourceProperty(u){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null),u(),this.load(!0)}setTiles(u){return this.setSourceProperty((()=>{this._options.tiles=u})),this}setUrl(u){return this.setSourceProperty((()=>{this.url=u,this._options.url=u})),this}serialize(){return o.e({},this._options)}hasTile(u){return!this.tileBounds||this.tileBounds.contains(u.canonical)}loadTile(u){return o._(this,void 0,void 0,(function*(){const g=u.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);u.abortController=new AbortController;try{const w=yield H.getImage(this.map._requestManager.transformRequest(g,"Tile"),u.abortController,this.map._refreshExpiredTiles);if(delete u.abortController,u.aborted)return void(u.state="unloaded");if(w&&w.data){this.map._refreshExpiredTiles&&(w.cacheControl||w.expires)&&u.setExpiryData({cacheControl:w.cacheControl,expires:w.expires});const C=this.map.painter.context,L=C.gl,z=w.data;u.texture=this.map.painter.getTileTexture(z.width),u.texture?u.texture.update(z,{useMipmap:!0}):(u.texture=new o.T(C,z,L.RGBA,{useMipmap:!0}),u.texture.bind(L.LINEAR,L.CLAMP_TO_EDGE,L.LINEAR_MIPMAP_NEAREST)),u.state="loaded"}}catch(w){if(delete u.abortController,u.aborted)u.state="unloaded";else if(w)throw u.state="errored",w}}))}abortTile(u){return o._(this,void 0,void 0,(function*(){u.abortController&&(u.abortController.abort(),delete u.abortController)}))}unloadTile(u){return o._(this,void 0,void 0,(function*(){u.texture&&this.map.painter.saveTileTexture(u.texture)}))}hasTransition(){return!1}}class mr extends gr{constructor(u,g,w,C){super(u,g,w,C),this.type="raster-dem",this.maxzoom=22,this._options=o.e({type:"raster-dem"},g),this.encoding=g.encoding||"mapbox",this.redFactor=g.redFactor,this.greenFactor=g.greenFactor,this.blueFactor=g.blueFactor,this.baseShift=g.baseShift}loadTile(u){return o._(this,void 0,void 0,(function*(){const g=u.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),w=this.map._requestManager.transformRequest(g,"Tile");u.neighboringTiles=this._getNeighboringTiles(u.tileID),u.abortController=new AbortController;try{const C=yield H.getImage(w,u.abortController,this.map._refreshExpiredTiles);if(delete u.abortController,u.aborted)return void(u.state="unloaded");if(C&&C.data){const L=C.data;this.map._refreshExpiredTiles&&(C.cacheControl||C.expires)&&u.setExpiryData({cacheControl:C.cacheControl,expires:C.expires});const z=o.b(L)&&o.$()?L:yield this.readImageNow(L),Y={type:this.type,uid:u.uid,source:this.id,rawImageData:z,encoding:this.encoding,redFactor:this.redFactor,greenFactor:this.greenFactor,blueFactor:this.blueFactor,baseShift:this.baseShift};if(!u.actor||u.state==="expired"){u.actor=this.dispatcher.getActor();const re=yield u.actor.sendAsync({type:"LDT",data:Y});u.dem=re,u.needsHillshadePrepare=!0,u.needsTerrainPrepare=!0,u.state="loaded"}}}catch(C){if(delete u.abortController,u.aborted)u.state="unloaded";else if(C)throw u.state="errored",C}}))}readImageNow(u){return o._(this,void 0,void 0,(function*(){if(typeof VideoFrame<"u"&&o.a0()){const g=u.width+2,w=u.height+2;try{return new o.R({width:g,height:w},yield o.a1(u,-1,-1,g,w))}catch{}}return x.getImageData(u,1)}))}_getNeighboringTiles(u){const g=u.canonical,w=Math.pow(2,g.z),C=(g.x-1+w)%w,L=g.x===0?u.wrap-1:u.wrap,z=(g.x+1+w)%w,Y=g.x+1===w?u.wrap+1:u.wrap,re={};return re[new o.a2(u.overscaledZ,L,g.z,C,g.y).key]={backfilled:!1},re[new o.a2(u.overscaledZ,Y,g.z,z,g.y).key]={backfilled:!1},g.y>0&&(re[new o.a2(u.overscaledZ,L,g.z,C,g.y-1).key]={backfilled:!1},re[new o.a2(u.overscaledZ,u.wrap,g.z,g.x,g.y-1).key]={backfilled:!1},re[new o.a2(u.overscaledZ,Y,g.z,z,g.y-1).key]={backfilled:!1}),g.y+1<w&&(re[new o.a2(u.overscaledZ,L,g.z,C,g.y+1).key]={backfilled:!1},re[new o.a2(u.overscaledZ,u.wrap,g.z,g.x,g.y+1).key]={backfilled:!1},re[new o.a2(u.overscaledZ,Y,g.z,z,g.y+1).key]={backfilled:!1}),re}unloadTile(u){return o._(this,void 0,void 0,(function*(){u.demTexture&&this.map.painter.saveTileTexture(u.demTexture),u.fbo&&(u.fbo.destroy(),delete u.fbo),u.dem&&delete u.dem,delete u.neighboringTiles,u.state="unloaded",u.actor&&(yield u.actor.sendAsync({type:"RDT",data:{type:this.type,uid:u.uid,source:this.id}}))}))}}function ar(D){return D.type==="GeometryCollection"?D.geometries.map((u=>u.coordinates)).flat(1/0):D.coordinates.flat(1/0)}function Cr(D){const u=new $t;let g;switch(D.type){case"FeatureCollection":g=D.features.map((w=>ar(w.geometry))).flat(1/0);break;case"Feature":g=ar(D.geometry);break;default:g=ar(D)}if(g.length==0)return u;for(let w=0;w<g.length-1;w+=2)u.extend([g[w],g[w+1]]);return u}class Er extends o.E{constructor(u,g,w,C){super(),this.id=u,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._isUpdatingWorker=!1,this._pendingWorkerUpdate={data:g.data},this.actor=w.getActor(),this.setEventedParent(C),this._data=typeof g.data=="string"?{url:g.data}:{geojson:g.data},this._options=o.e({},g),this._collectResourceTiming=g.collectResourceTiming,g.maxzoom!==void 0&&(this.maxzoom=g.maxzoom),g.type&&(this.type=g.type),g.attribution&&(this.attribution=g.attribution),this.promoteId=g.promoteId,g.clusterMaxZoom!==void 0&&this.maxzoom<=g.clusterMaxZoom&&o.w(`The maxzoom value "${this.maxzoom}" is expected to be greater than the clusterMaxZoom value "${g.clusterMaxZoom}".`),this.workerOptions=o.e({source:this.id,cluster:g.cluster||!1,geojsonVtOptions:{buffer:this._pixelsToTileUnits(g.buffer!==void 0?g.buffer:128),tolerance:this._pixelsToTileUnits(g.tolerance!==void 0?g.tolerance:.375),extent:o.a5,maxZoom:this.maxzoom,lineMetrics:g.lineMetrics||!1,generateId:g.generateId||!1},superclusterOptions:{maxZoom:this._getClusterMaxZoom(g.clusterMaxZoom),minPoints:Math.max(2,g.clusterMinPoints||2),extent:o.a5,radius:this._pixelsToTileUnits(g.clusterRadius||50),log:!1,generateId:g.generateId||!1},clusterProperties:g.clusterProperties,filter:g.filter},g.workerOptions),typeof this.promoteId=="string"&&(this.workerOptions.promoteId=this.promoteId)}_hasPendingWorkerUpdate(){return this._pendingWorkerUpdate.data!==void 0||this._pendingWorkerUpdate.diff!==void 0||this._pendingWorkerUpdate.optionsChanged}_pixelsToTileUnits(u){return u*(o.a5/this.tileSize)}_getClusterMaxZoom(u){const g=u?Math.round(u):this.maxzoom-1;return Number.isInteger(u)||u===void 0||o.w(`Integer expected for option 'clusterMaxZoom': provided value "${u}" rounded to "${g}"`),g}load(){return o._(this,void 0,void 0,(function*(){yield this._updateWorkerData()}))}onAdd(u){this.map=u,this.load()}setData(u,g){this._data=typeof u=="string"?{url:u}:{geojson:u},this._pendingWorkerUpdate={data:u};const w=this._updateWorkerData();return g?w:this}updateData(u,g){this._pendingWorkerUpdate.diff=o.a6(this._pendingWorkerUpdate.diff,u);const w=this._updateWorkerData();return g?w:this}getData(){return o._(this,void 0,void 0,(function*(){const u=o.e({type:this.type},this.workerOptions);return this.actor.sendAsync({type:"GD",data:u})}))}getBounds(){return o._(this,void 0,void 0,(function*(){return Cr(yield this.getData())}))}setClusterOptions(u){return this.workerOptions.cluster=u.cluster,u.clusterRadius!==void 0&&(this.workerOptions.superclusterOptions.radius=this._pixelsToTileUnits(u.clusterRadius)),u.clusterMaxZoom!==void 0&&(this.workerOptions.superclusterOptions.maxZoom=this._getClusterMaxZoom(u.clusterMaxZoom)),this._pendingWorkerUpdate.optionsChanged=!0,this._updateWorkerData(),this}getClusterExpansionZoom(u){return this.actor.sendAsync({type:"GCEZ",data:{type:this.type,clusterId:u,source:this.id}})}getClusterChildren(u){return this.actor.sendAsync({type:"GCC",data:{type:this.type,clusterId:u,source:this.id}})}getClusterLeaves(u,g,w){return this.actor.sendAsync({type:"GCL",data:{type:this.type,source:this.id,clusterId:u,limit:g,offset:w}})}_updateWorkerData(){return o._(this,void 0,void 0,(function*(){if(this._isUpdatingWorker)return;if(!this._hasPendingWorkerUpdate())return void o.w(`No pending worker updates for GeoJSONSource ${this.id}.`);const{data:u,diff:g}=this._pendingWorkerUpdate,w=o.e({type:this.type},this.workerOptions);u!==void 0?(typeof u=="string"?(w.request=this.map._requestManager.transformRequest(x.resolveURL(u),"Source"),w.request.collectResourceTiming=this._collectResourceTiming):w.data=u,this._pendingWorkerUpdate.data=void 0):g&&(w.dataDiff=g,this._pendingWorkerUpdate.diff=void 0),this._pendingWorkerUpdate.optionsChanged=void 0,this._isUpdatingWorker=!0,this.fire(new o.l("dataloading",{dataType:"source"}));try{const C=yield this.actor.sendAsync({type:"LD",data:w});if(this._isUpdatingWorker=!1,this._removed||C.abandoned)return void this.fire(new o.l("dataabort",{dataType:"source"}));C.data&&(this._data={geojson:C.data});const L=this._applyDiffToSource(g),z=this._getShouldReloadTileOptions(L);let Y=null;C.resourceTiming&&C.resourceTiming[this.id]&&(Y=C.resourceTiming[this.id].slice(0));const re={dataType:"source"};this._collectResourceTiming&&Y&&Y.length>0&&o.e(re,{resourceTiming:Y}),this.fire(new o.l("data",Object.assign(Object.assign({},re),{sourceDataType:"metadata"}))),this.fire(new o.l("data",Object.assign(Object.assign({},re),{sourceDataType:"content",shouldReloadTileOptions:z})))}catch(C){if(this._isUpdatingWorker=!1,this._removed)return void this.fire(new o.l("dataabort",{dataType:"source"}));this.fire(new o.k(C))}finally{this._hasPendingWorkerUpdate()&&this._updateWorkerData()}}))}_applyDiffToSource(u){if(!u)return;const g=typeof this.promoteId=="string"?this.promoteId:void 0;if(!this._data.url&&!this._data.updateable){const C=o.a7(this._data.geojson,g);if(!C)throw new Error(`GeoJSONSource "${this.id}": GeoJSON data is not compatible with updateData`);this._data={updateable:C}}if(!this._data.updateable)return;const w=o.a8(this._data.updateable,u,g);return u.removeAll||this._options.cluster?void 0:w}_getShouldReloadTileOptions(u){if(u)return{affectedBounds:u.filter(Boolean).map((g=>Cr(g)))}}shouldReloadTile(u,{affectedBounds:g}){if(u.state==="loading")return!0;if(u.state==="unloaded")return!1;const{buffer:w,extent:C}=this.workerOptions.geojsonVtOptions,L=(function({x:z,y:Y,z:re},le=0){const he=o.a3((z-le)/Math.pow(2,re)),Pe=o.a4((Y+1+le)/Math.pow(2,re)),Ae=o.a3((z+1+le)/Math.pow(2,re)),Ue=o.a4((Y-le)/Math.pow(2,re));return new $t([he,Pe],[Ae,Ue])})(u.tileID.canonical,w/C);for(const z of g)if(L.intersects(z))return!0;return!1}loaded(){return!this._isUpdatingWorker&&!this._hasPendingWorkerUpdate()}loadTile(u){return o._(this,void 0,void 0,(function*(){const g=u.actor?"RT":"LT";u.actor=this.actor;const w={type:this.type,uid:u.uid,tileID:u.tileID,zoom:u.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,subdivisionGranularity:this.map.style.projection.subdivisionGranularity};u.abortController=new AbortController;const C=yield this.actor.sendAsync({type:g,data:w},u.abortController);delete u.abortController,u.unloadVectorData(),u.aborted||u.loadVectorData(C,this.map.painter,g==="RT")}))}abortTile(u){return o._(this,void 0,void 0,(function*(){u.abortController&&(u.abortController.abort(),delete u.abortController),u.aborted=!0}))}unloadTile(u){return o._(this,void 0,void 0,(function*(){u.unloadVectorData(),yield this.actor.sendAsync({type:"RMT",data:{uid:u.uid,type:this.type,source:this.id}})}))}onRemove(){this._removed=!0,this.actor.sendAsync({type:"RS",data:{type:this.type,source:this.id}})}serialize(){return o.e({},this._options,{type:this.type,data:this._data.updateable?{type:"FeatureCollection",features:Array.from(this._data.updateable.values())}:this._data.url||this._data.geojson})}hasTransition(){return!1}}class Jt extends o.E{constructor(u,g,w,C){super(),this.flippedWindingOrder=!1,this.id=u,this.dispatcher=w,this.coordinates=g.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(C),this.options=g}load(u){return o._(this,void 0,void 0,(function*(){this._loaded=!1,this.fire(new o.l("dataloading",{dataType:"source"})),this.url=this.options.url,this._request=new AbortController;try{const g=yield H.getImage(this.map._requestManager.transformRequest(this.url,"Image"),this._request);this._request=null,this._loaded=!0,g&&g.data&&(this.image=g.data,u&&(this.coordinates=u),this._finishLoading())}catch(g){this._request=null,this._loaded=!0,o.Z(g)||this.fire(new o.k(g))}}))}loaded(){return this._loaded}updateImage(u){return u.url?(this._request&&(this._request.abort(),this._request=null),this.options.url=u.url,this.load(u.coordinates).finally((()=>{this.texture=null})),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new o.l("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(u){this.map=u,this.load()}onRemove(){this._request&&(this._request.abort(),this._request=null)}setCoordinates(u){this.coordinates=u;const g=u.map(o.a9.fromLngLat);var w;return this.tileID=(function(C){const L=o.aa.fromPoints(C),z=L.width(),Y=L.height(),re=Math.max(z,Y),le=Math.max(0,Math.floor(-Math.log(re)/Math.LN2)),he=Math.pow(2,le);return new o.ac(le,Math.floor((L.minX+L.maxX)/2*he),Math.floor((L.minY+L.maxY)/2*he))})(g),this.terrainTileRanges=this._getOverlappingTileRanges(g),this.minzoom=this.maxzoom=this.tileID.z,this.tileCoords=g.map((C=>this.tileID.getTilePoint(C)._round())),this.flippedWindingOrder=((w=this.tileCoords)[1].x-w[0].x)*(w[2].y-w[0].y)-(w[1].y-w[0].y)*(w[2].x-w[0].x)<0,this.fire(new o.l("data",{dataType:"source",sourceDataType:"content"})),this}prepare(){if(Object.keys(this.tiles).length===0||!this.image)return;const u=this.map.painter.context,g=u.gl;this.texture||(this.texture=new o.T(u,this.image,g.RGBA),this.texture.bind(g.LINEAR,g.CLAMP_TO_EDGE));let w=!1;for(const C in this.tiles){const L=this.tiles[C];L.state!=="loaded"&&(L.state="loaded",L.texture=this.texture,w=!0)}w&&this.fire(new o.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}loadTile(u){return o._(this,void 0,void 0,(function*(){this.tileID&&this.tileID.equals(u.tileID.canonical)?(this.tiles[String(u.tileID.wrap)]=u,u.buckets={}):u.state="errored"}))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}_getOverlappingTileRanges(u){const{minX:g,minY:w,maxX:C,maxY:L}=o.aa.fromPoints(u),z={};for(let Y=0;Y<=o.ab;Y++){const re=Math.pow(2,Y),le=Math.floor(g*re),he=Math.floor(w*re),Pe=Math.floor(C*re),Ae=Math.floor(L*re),Ue=(le%re+re)%re,Ze=Pe%re,ht=Math.floor(le/re),pt=Math.floor(Pe/re);z[Y]={minWrap:ht,maxWrap:pt,minTileXWrapped:Ue,maxTileXWrapped:Ze,minTileY:he,maxTileY:Ae}}return z}}class ot extends Jt{constructor(u,g,w,C){super(u,g,w,C),this.roundZoom=!0,this.type="video",this.options=g}load(){return o._(this,void 0,void 0,(function*(){this._loaded=!1;const u=this.options;this.urls=[];for(const g of u.urls)this.urls.push(this.map._requestManager.transformRequest(g,"Source").url);try{const g=yield o.ad(this.urls);if(this._loaded=!0,!g)return;this.video=g,this.video.loop=!0,this.video.addEventListener("playing",(()=>{this.map.triggerRepaint()})),this.map&&this.video.play(),this._finishLoading()}catch(g){this.fire(new o.k(g))}}))}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(u){if(this.video){const g=this.video.seekable;u<g.start(0)||u>g.end(0)?this.fire(new o.k(new o.ae(`sources.${this.id}`,null,`Playback for this video can be set only between the ${g.start(0)} and ${g.end(0)}-second mark.`))):this.video.currentTime=u}}getVideo(){return this.video}onAdd(u){this.map||(this.map=u,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const u=this.map.painter.context,g=u.gl;this.texture?this.video.paused||(this.texture.bind(g.LINEAR,g.CLAMP_TO_EDGE),g.texSubImage2D(g.TEXTURE_2D,0,0,0,g.RGBA,g.UNSIGNED_BYTE,this.video)):(this.texture=new o.T(u,this.video,g.RGBA),this.texture.bind(g.LINEAR,g.CLAMP_TO_EDGE));let w=!1;for(const C in this.tiles){const L=this.tiles[C];L.state!=="loaded"&&(L.state="loaded",L.texture=this.texture,w=!0)}w&&this.fire(new o.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}}class Ce extends Jt{constructor(u,g,w,C){super(u,g,w,C),g.coordinates?Array.isArray(g.coordinates)&&g.coordinates.length===4&&!g.coordinates.some((L=>!Array.isArray(L)||L.length!==2||L.some((z=>typeof z!="number"))))||this.fire(new o.k(new o.ae(`sources.${u}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new o.k(new o.ae(`sources.${u}`,null,'missing required property "coordinates"'))),g.animate&&typeof g.animate!="boolean"&&this.fire(new o.k(new o.ae(`sources.${u}`,null,'optional "animate" property must be a boolean value'))),g.canvas?typeof g.canvas=="string"||g.canvas instanceof HTMLCanvasElement||this.fire(new o.k(new o.ae(`sources.${u}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new o.k(new o.ae(`sources.${u}`,null,'missing required property "canvas"'))),this.options=g,this.animate=g.animate===void 0||g.animate}load(){return o._(this,void 0,void 0,(function*(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new o.k(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}))}getCanvas(){return this.canvas}onAdd(u){this.map=u,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let u=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,u=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,u=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const g=this.map.painter.context,w=g.gl;this.texture?(u||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):(this.texture=new o.T(g,this.canvas,w.RGBA,{premultiply:!0}),this.texture.bind(w.LINEAR,w.CLAMP_TO_EDGE));let C=!1;for(const L in this.tiles){const z=this.tiles[L];z.state!=="loaded"&&(z.state="loaded",z.texture=this.texture,C=!0)}C&&this.fire(new o.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"canvas",animate:this.animate,canvas:this.options.canvas,coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const u of[this.canvas.width,this.canvas.height])if(isNaN(u)||u<=0)return!0;return!1}}const xe={},je=D=>{switch(D){case"geojson":return Er;case"image":return Jt;case"raster":return gr;case"raster-dem":return mr;case"vector":return _t;case"video":return ot;case"canvas":return Ce}return xe[D]},qe="RTLPluginLoaded";class Ge extends o.E{constructor(){super(...arguments),this.status="unavailable",this.url=null,this.dispatcher=it()}_syncState(u){return this.status=u,this.dispatcher.broadcast("SRPS",{pluginStatus:u,pluginURL:this.url}).catch((g=>{throw this.status="error",g}))}getRTLTextPluginStatus(){return this.status}clearRTLTextPlugin(){this.status="unavailable",this.url=null}setRTLTextPlugin(u){return o._(this,arguments,void 0,(function*(g,w=!1){if(this.url)throw new Error("setRTLTextPlugin cannot be called multiple times.");if(this.url=x.resolveURL(g),!this.url)throw new Error(`requested url ${g} is invalid`);if(this.status==="unavailable"){if(!w)return this._requestImport();this.status="deferred",this._syncState(this.status)}else if(this.status==="requested")return this._requestImport()}))}_requestImport(){return o._(this,void 0,void 0,(function*(){yield this._syncState("loading"),this.status="loaded",this.fire(new o.l(qe))}))}lazyLoad(){this.status==="unavailable"?this.status="requested":this.status==="deferred"&&this._requestImport()}}let Ft=null;function Et(){return Ft||(Ft=new Ge),Ft}var mt,ct;(function(D){D[D.Base=0]="Base",D[D.Parent=1]="Parent"})(mt||(mt={})),(function(D){D[D.Departing=0]="Departing",D[D.Incoming=1]="Incoming"})(ct||(ct={}));class Qt{constructor(u,g){this.timeAdded=0,this.fadeEndTime=0,this.fadeOpacity=1,this.tileID=u,this.uid=o.af(),this.uses=0,this.tileSize=g,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.rtt=[],this.rttCoords={},this.expiredRequestCount=0,this.state="loading"}isRenderable(u){return this.hasData()&&(!this.fadeEndTime||this.fadeOpacity>0)&&(u||!this.holdingForSymbolFade())}setCrossFadeLogic({fadingRole:u,fadingDirection:g,fadingParentID:w,fadeEndTime:C}){this.resetFadeLogic(),this.fadingRole=u,this.fadingDirection=g,this.fadingParentID=w,this.fadeEndTime=C}setSelfFadeLogic(u){this.resetFadeLogic(),this.selfFading=!0,this.fadeEndTime=u}resetFadeLogic(){this.fadingRole=null,this.fadingDirection=null,this.fadingParentID=null,this.selfFading=!1,this.timeAdded=T(),this.fadeEndTime=0,this.fadeOpacity=1}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}clearTextures(u){this.demTexture&&u.saveTileTexture(this.demTexture),this.demTexture=null}loadVectorData(u,g,w){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",u){u.featureIndex&&(this.latestFeatureIndex=u.featureIndex,u.rawTileData?(this.latestRawTileData=u.rawTileData,this.latestFeatureIndex.rawTileData=u.rawTileData,this.latestFeatureIndex.encoding=u.encoding):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData,this.latestFeatureIndex.encoding=this.latestEncoding)),this.collisionBoxArray=u.collisionBoxArray,this.buckets=(function(C,L){const z={};if(!L)return z;for(const Y of C){const re=Y.layerIds.map((le=>L.getLayer(le))).filter(Boolean);if(re.length!==0){Y.layers=re,Y.stateDependentLayerIds&&(Y.stateDependentLayers=Y.stateDependentLayerIds.map((le=>re.filter((he=>he.id===le))[0])));for(const le of re)z[le.id]=Y}}return z})(u.buckets,g?.style),this.hasSymbolBuckets=!1;for(const C in this.buckets){const L=this.buckets[C];if(L instanceof o.ah){if(this.hasSymbolBuckets=!0,!w)break;L.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const C in this.buckets){const L=this.buckets[C];if(L instanceof o.ah&&L.hasRTLText){this.hasRTLText=!0,Et().lazyLoad();break}}this.queryPadding=0;for(const C in this.buckets){const L=this.buckets[C];this.queryPadding=Math.max(this.queryPadding,g.style.getLayer(C).queryRadius(L))}u.imageAtlas&&(this.imageAtlas=u.imageAtlas),u.glyphAtlasImage&&(this.glyphAtlasImage=u.glyphAtlasImage),this.dashPositions=u.dashPositions}else this.collisionBoxArray=new o.ag}unloadVectorData(){for(const u in this.buckets)this.buckets[u].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.dashPositions&&(this.dashPositions=null),this.latestFeatureIndex=null,this.state="unloaded"}getBucket(u){return this.buckets[u.id]}upload(u){for(const w in this.buckets){const C=this.buckets[w];C.uploadPending()&&C.upload(u)}const g=u.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new o.T(u,this.imageAtlas.image,g.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new o.T(u,this.glyphAtlasImage,g.ALPHA),this.glyphAtlasImage=null)}prepare(u){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(u,this.imageAtlasTexture)}queryRenderedFeatures(u,g,w,C,L,z,Y,re,le,he,Pe){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:C,cameraQueryGeometry:L,scale:z,tileSize:this.tileSize,pixelPosMatrix:he,transform:re,params:Y,queryPadding:this.queryPadding*le,getElevation:Pe},u,g,w):{}}querySourceFeatures(u,g){const w=this.latestFeatureIndex;if(!w||!w.rawTileData)return;const C=w.loadVTLayers(),L=g&&g.sourceLayer?g.sourceLayer:"",z=C[o.ai]||C[L];if(!z)return;const Y=o.aj(g?.filter,g?.globalState),{z:re,x:le,y:he}=this.tileID.canonical,Pe={z:re,x:le,y:he};for(let Ae=0;Ae<z.length;Ae++){const Ue=z.feature(Ae);if(Y.needGeometry){const pt=o.ak(Ue,!0);if(!Y.filter(new o.H(this.tileID.overscaledZ),pt,this.tileID.canonical))continue}else if(!Y.filter(new o.H(this.tileID.overscaledZ),Ue))continue;const Ze=w.getId(Ue,L),ht=new o.al(Ue,re,le,he,Ze);ht.tile=Pe,u.push(ht)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(u){const g=this.expirationTime;if(u.cacheControl){const w=o.am(u.cacheControl);w["max-age"]&&(this.expirationTime=Date.now()+1e3*w["max-age"])}else u.expires&&(this.expirationTime=new Date(u.expires).getTime());if(this.expirationTime){const w=Date.now();let C=!1;if(this.expirationTime>w)C=!1;else if(g)if(this.expirationTime<g)C=!0;else{const L=this.expirationTime-g;L?this.expirationTime=w+Math.max(L,3e4):C=!0}else C=!0;C?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(u,g){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(u).length===0)return;const w=this.latestFeatureIndex.loadVTLayers();for(const C in this.buckets){if(!g.style.hasLayer(C))continue;const L=this.buckets[C],z=L.layers[0].sourceLayer||o.ai,Y=w[z],re=u[z];if(!Y||!re||Object.keys(re).length===0)continue;L.update(re,Y,this.imageAtlas&&this.imageAtlas.patternPositions||{},this.dashPositions||{});const le=g&&g.style&&g.style.getLayer(C);le&&(this.queryPadding=Math.max(this.queryPadding,le.queryRadius(L)))}}holdingForSymbolFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<T()}clearSymbolFadeHold(){this.symbolFadeHoldUntil=void 0}setSymbolHoldDuration(u){this.symbolFadeHoldUntil=T()+u}setDependencies(u,g){const w={};for(const C of g)w[C]=!0;this.dependencies[u]=w}hasDependency(u,g){for(const w of u){const C=this.dependencies[w];if(C){for(const L of g)if(C[L])return!0}}return!1}}class Ht{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(u,g,w){const C=String(g);if(this.stateChanges[u]=this.stateChanges[u]||{},this.stateChanges[u][C]=this.stateChanges[u][C]||{},o.e(this.stateChanges[u][C],w),this.deletedStates[u]===null){this.deletedStates[u]={};for(const L in this.state[u])L!==C&&(this.deletedStates[u][L]=null)}else if(this.deletedStates[u]&&this.deletedStates[u][C]===null){this.deletedStates[u][C]={};for(const L in this.state[u][C])w[L]||(this.deletedStates[u][C][L]=null)}else for(const L in w)this.deletedStates[u]&&this.deletedStates[u][C]&&this.deletedStates[u][C][L]===null&&delete this.deletedStates[u][C][L]}removeFeatureState(u,g,w){if(this.deletedStates[u]===null)return;const C=String(g);if(this.deletedStates[u]=this.deletedStates[u]||{},w&&g!==void 0)this.deletedStates[u][C]!==null&&(this.deletedStates[u][C]=this.deletedStates[u][C]||{},this.deletedStates[u][C][w]=null);else if(g!==void 0)if(this.stateChanges[u]&&this.stateChanges[u][C])for(w in this.deletedStates[u][C]={},this.stateChanges[u][C])this.deletedStates[u][C][w]=null;else this.deletedStates[u][C]=null;else this.deletedStates[u]=null}getState(u,g){const w=String(g),C=o.e({},(this.state[u]||{})[w],(this.stateChanges[u]||{})[w]);if(this.deletedStates[u]===null)return{};if(this.deletedStates[u]){const L=this.deletedStates[u][g];if(L===null)return{};for(const z in L)delete C[z]}return C}initializeTileState(u,g){u.setFeatureState(this.state,g)}coalesceChanges(u,g){const w={};for(const C in this.stateChanges){this.state[C]=this.state[C]||{};const L={};for(const z in this.stateChanges[C])this.state[C][z]||(this.state[C][z]={}),o.e(this.state[C][z],this.stateChanges[C][z]),L[z]=this.state[C][z];w[C]=L}for(const C in this.deletedStates){this.state[C]=this.state[C]||{};const L={};if(this.deletedStates[C]===null)for(const z in this.state[C])L[z]={},this.state[C][z]={};else for(const z in this.deletedStates[C]){if(this.deletedStates[C][z]===null)this.state[C][z]={};else for(const Y of Object.keys(this.deletedStates[C][z]))delete this.state[C][z][Y];L[z]=this.state[C][z]}w[C]=w[C]||{},o.e(w[C],L)}this.stateChanges={},this.deletedStates={},Object.keys(w).length!==0&&u.setFeatureState(w,g)}}const Ir=89.25;function Ar(D,u){const g=o.an(u.lat,-o.ao,o.ao);return new o.P(o.Y(u.lng)*D,o.X(g)*D)}function $r(D,u){return new o.a9(u.x/D,u.y/D).toLngLat()}function fn(D){return D.cameraToCenterDistance*Math.min(.85*Math.tan(o.ap(90-D.pitch)),Math.tan(o.ap(Ir-D.pitch)))}function zr(D,u){const g=D.canonical,w=u/o.aq(g.z),C=g.x+Math.pow(2,g.z)*D.wrap,L=o.ar(new Float64Array(16));return o.O(L,L,[C*w,g.y*w,0]),o.Q(L,L,[w/o.a5,w/o.a5,1]),L}function Mt(D,u,g,w,C){const L=o.a9.fromLngLat(D,u),z=C*o.as(1,D.lat),{x:Y,y:re,z:le}=en(g,w);return new o.a9(L.x+z*-Y,L.y+z*-re,L.z+z*-le)}function en(D,u){const g=o.ap(D),w=o.ap(u),C=Math.cos(-g),L=Math.sin(g);return{x:L*Math.sin(w),y:-L*Math.cos(w),z:C}}function jn(D,u,g){const w=u.intersectsFrustum(D);if(!g||w===0)return w;const C=u.intersectsPlane(g);return C===0?0:w===2&&C===2?2:1}function Qr(D,u,g){let w=0;const C=(g-u)/10;for(let L=0;L<10;L++)w+=C*Math.pow(Math.cos(u+(L+.5)/10*(g-u)),D);return w}function nr(D,u){return function(g,w,C,L,z){const Y=2*((D-1)/o.at(Math.cos(o.ap(Ir-z))/Math.cos(o.ap(Ir)))-1),re=Math.acos(C/L),le=2*Qr(Y-1,0,o.ap(z/2)),he=Math.min(o.ap(Ir),re+o.ap(z/2)),Pe=Qr(Y-1,Math.min(he,re-o.ap(z/2)),he),Ae=Math.atan(w/C),Ue=Math.hypot(w,C);let Ze=g;return Ze+=o.at(L/Ue/Math.max(.5,Math.cos(o.ap(z/2)))),Ze+=Y*o.at(Math.cos(Ae))/2,Ze-=o.at(Math.max(1,Pe/le/u))/2,Ze}}const oi=nr(9.314,3);function un(D,u){const g=(u.roundZoom?Math.round:Math.floor)(D.zoom+o.at(D.tileSize/u.tileSize));return Math.max(0,g)}function Kn(D,u){const g=D.getCameraFrustum(),w=D.getClippingPlane(),C=D.screenPointToMercatorCoordinate(D.getCameraPoint()),L=o.a9.fromLngLat(D.center,D.elevation);C.z=L.z+Math.cos(D.pitchInRadians)*D.cameraToCenterDistance/D.worldSize;const z=D.getCoveringTilesDetailsProvider(),Y=z.allowVariableZoom(D,u),re=un(D,u),le=u.minzoom||0,he=u.maxzoom!==void 0?u.maxzoom:D.maxZoom,Pe=Math.min(Math.max(0,re),he),Ae=Math.pow(2,Pe),Ue=[Ae*C.x,Ae*C.y,0],Ze=[Ae*L.x,Ae*L.y,0],ht=Math.hypot(L.x-C.x,L.y-C.y),pt=Math.abs(L.z-C.z),dt=Math.hypot(ht,pt),xt=Lt=>({zoom:0,x:0,y:0,wrap:Lt,fullyVisible:!1}),Nt=[],wt=[];if(D.renderWorldCopies&&z.allowWorldCopies())for(let Lt=1;Lt<=3;Lt++)Nt.push(xt(-Lt)),Nt.push(xt(Lt));for(Nt.push(xt(0));Nt.length>0;){const Lt=Nt.pop(),jt=Lt.x,Dt=Lt.y;let Zt=Lt.fullyVisible;const Sr={x:jt,y:Dt,z:Lt.zoom},pr=z.getTileBoundingVolume(Sr,Lt.wrap,D.elevation,u);if(!Zt){const ln=jn(g,pr,w);if(ln===0)continue;Zt=ln===2}const _r=z.distanceToTile2d(C.x,C.y,Sr,pr);let xr=re;Y&&(xr=(u.calculateTileZoom||oi)(D.zoom+o.at(D.tileSize/u.tileSize),_r,pt,dt,D.fov)),xr=(u.roundZoom?Math.round:Math.floor)(xr),xr=Math.max(0,xr);const an=Math.min(xr,he);if(Lt.wrap=z.getWrap(L,Sr,Lt.wrap),Lt.zoom>=an){if(Lt.zoom<le)continue;const ln=Pe-Lt.zoom,Hr=Ue[0]-.5-(jt<<ln),gn=Ue[1]-.5-(Dt<<ln),Ti=u.reparseOverscaled?Math.max(Lt.zoom,xr):Lt.zoom;wt.push({tileID:new o.a2(Lt.zoom===he?Ti:Lt.zoom,Lt.wrap,Lt.zoom,jt,Dt),distanceSq:o.au([Ze[0]-.5-jt,Ze[1]-.5-Dt]),tileDistanceToCamera:Math.sqrt(Hr*Hr+gn*gn)})}else for(let ln=0;ln<4;ln++)Nt.push({zoom:Lt.zoom+1,x:(jt<<1)+ln%2,y:(Dt<<1)+(ln>>1),wrap:Lt.wrap,fullyVisible:Zt})}return wt.sort(((Lt,jt)=>Lt.distanceSq-jt.distanceSq)).map((Lt=>Lt.tileID))}const Re=o.aa.fromPoints([new o.P(0,0),new o.P(o.a5,o.a5)]);function He(D){return D==="raster"||D==="image"||D==="video"}function Tt(D,u,g,w,C,L,z){if(!u.hasData())return!1;const{tileID:Y,fadingRole:re,fadingDirection:le,fadingParentID:he}=u;if(re===mt.Base&&le===ct.Incoming&&he)return g[he.key]=he,!0;const Pe=Math.max(Y.overscaledZ-C,L);for(let Ae=Y.overscaledZ-1;Ae>=Pe;Ae--){const Ue=Y.scaledTo(Ae),Ze=D.getLoadedTile(Ue);if(Ze)return u.setCrossFadeLogic({fadingRole:mt.Base,fadingDirection:ct.Incoming,fadingParentID:Ze.tileID,fadeEndTime:w+z}),Ze.setCrossFadeLogic({fadingRole:mt.Parent,fadingDirection:ct.Departing,fadeEndTime:w+z}),g[Ue.key]=Ue,!0}return!1}function Gt(D,u,g,w,C,L){if(!u.hasData())return!1;const z=u.tileID.children(C);let Y=Ut(D,u,z,g,w,C,L);if(Y)return!0;for(const re of z)Ut(D,u,re.children(C),g,w,C,L)&&(Y=!0);return Y}function Ut(D,u,g,w,C,L,z){if(g[0].overscaledZ>=L)return!1;let Y=!1;for(const re of g){const le=D.getLoadedTile(re);if(!le)continue;const{fadingRole:he,fadingDirection:Pe,fadingParentID:Ae}=le;he===mt.Base&&Pe===ct.Departing&&Ae||(le.setCrossFadeLogic({fadingRole:mt.Base,fadingDirection:ct.Departing,fadingParentID:u.tileID,fadeEndTime:C+z}),u.setCrossFadeLogic({fadingRole:mt.Parent,fadingDirection:ct.Incoming,fadeEndTime:C+z})),w[re.key]=re,Y=!0}return Y}function Xr(D,u,g,w){const C=D.tileID;return!!D.selfFading||!D.hasData()&&!!u.has(C)&&(D.setSelfFadeLogic(g+w),!0)}function Nn(D,u){var g;D.needsHillshadePrepare=!0,D.needsTerrainPrepare=!0;let w=u.tileID.canonical.x-D.tileID.canonical.x;const C=u.tileID.canonical.y-D.tileID.canonical.y,L=Math.pow(2,D.tileID.canonical.z),z=u.tileID.key;w===0&&C===0||Math.abs(C)>1||(Math.abs(w)>1&&(Math.abs(w+L)===1?w+=L:Math.abs(w-L)===1&&(w-=L)),u.dem&&D.dem&&(D.dem.backfillBorder(u.dem,w,C),!((g=D.neighboringTiles)===null||g===void 0)&&g[z]&&(D.neighboringTiles[z].backfilled=!0)))}class Bi{constructor(){this._tiles={}}handleWrapJump(u){const g={};for(const w in this._tiles){const C=this._tiles[w];C.tileID=C.tileID.unwrapTo(C.tileID.wrap+u),g[C.tileID.key]=C}this._tiles=g}setFeatureState(u,g){for(const w in this._tiles)this._tiles[w].setFeatureState(u,g)}getAllTiles(){return Object.values(this._tiles)}getAllIds(u=!1){return u?Object.values(this._tiles).map((g=>g.tileID)).sort(o.aw).map((g=>g.key)):Object.keys(this._tiles)}getTileById(u){return this._tiles[u]}setTile(u,g){this._tiles[u]=g}deleteTileById(u){delete this._tiles[u]}getLoadedTile(u){const g=this.getTileById(u.key);return g?.hasData()?g:null}isIdRenderable(u,g=!1){var w;return(w=this.getTileById(u))===null||w===void 0?void 0:w.isRenderable(g)}getRenderableIds(u=0,g){const w=[];for(const C of this.getAllIds())this.isIdRenderable(C,g)&&w.push(this.getTileById(C));return g?w.sort(((C,L)=>{const z=C.tileID,Y=L.tileID,re=new o.P(z.canonical.x,z.canonical.y)._rotate(-u),le=new o.P(Y.canonical.x,Y.canonical.y)._rotate(-u);return z.overscaledZ-Y.overscaledZ||le.y-re.y||le.x-re.x})).map((C=>C.tileID.key)):w.map((C=>C.tileID)).sort(o.aw).map((C=>C.key))}}class Ci extends o.E{constructor(u,g,w){super(),this.id=u,this.dispatcher=w,this.on("data",(C=>this._dataHandler(C))),this.on("dataloading",(()=>{this._sourceErrored=!1})),this.on("error",(()=>{this._sourceErrored=this._source.loaded()})),this._source=((C,L,z,Y)=>{const re=new(je(L.type))(C,L,z,Y);if(re.id!==C)throw new Error(`Expected Source id to be ${C} instead of ${re.id}`);return re})(u,g,w,this),this._inViewTiles=new Bi,this._outOfViewCache=new o.ax(0,(C=>this._unloadTile(C))),this._timers={},this._maxTileCacheSize=null,this._maxTileCacheZoomLevels=null,this._rasterFadeDuration=0,this._maxFadingAncestorLevels=5,this._state=new Ht,this._didEmitContent=!1,this._updated=!1}onAdd(u){this.map=u,this._maxTileCacheSize=u?u._maxTileCacheSize:null,this._maxTileCacheZoomLevels=u?u._maxTileCacheZoomLevels:null,this._source&&this._source.onAdd&&this._source.onAdd(u)}onRemove(u){for(const g of this._inViewTiles.getAllTiles())g.unloadVectorData();this.clearTiles(),this._source&&this._source.onRemove&&this._source.onRemove(u),this._inViewTiles=new Bi}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;if(!(this.used===void 0&&this.usedForTerrain===void 0||this.used||this.usedForTerrain))return!0;if(!this._updated)return!1;for(const u of this._inViewTiles.getAllTiles())if(u.state!=="loaded"&&u.state!=="errored")return!1;return!0}getSource(){return this._source}getState(){return this._state}pause(){this._paused=!0}resume(){if(!this._paused)return;const u=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,u&&this.reload(),this.transform&&this.update(this.transform,this.terrain)}_loadTile(u,g,w){return o._(this,void 0,void 0,(function*(){try{yield this._source.loadTile(u),this._tileLoaded(u,g,w)}catch(C){u.state="errored",C.status!==404?this._source.fire(new o.k(C,{tile:u})):this.update(this.transform,this.terrain)}}))}_unloadTile(u){this._source.unloadTile&&this._source.unloadTile(u)}_abortTile(u){this._source.abortTile&&this._source.abortTile(u),this._source.fire(new o.l("dataabort",{tile:u,coord:u.tileID,dataType:"source"}))}serialize(){return this._source.serialize()}prepare(u){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._inViewTiles,this.map?this.map.painter:null);for(const g of this._inViewTiles.getAllTiles())g.upload(u),g.prepare(this.map.style.imageManager)}getIds(){return this._inViewTiles.getAllIds(!0)}getRenderableIds(u){var g;return this._inViewTiles.getRenderableIds((g=this.transform)===null||g===void 0?void 0:g.bearingInRadians,u)}hasRenderableParent(u){const g=u.overscaledZ-1;if(g>=this._source.minzoom){const w=this.getLoadedTile(u.scaledTo(g));if(w)return this._inViewTiles.isIdRenderable(w.tileID.key)}return!1}reload(u,g=void 0){if(this._paused)this._shouldReloadOnResume=!0;else{this._outOfViewCache.reset();for(const w of this._inViewTiles.getAllIds()){const C=this._inViewTiles.getTileById(w);g&&!this._source.shouldReloadTile(C,g)||(u?this._reloadTile(w,"expired"):C.state!=="errored"&&this._reloadTile(w,"reloading"))}}}_reloadTile(u,g){return o._(this,void 0,void 0,(function*(){const w=this._inViewTiles.getTileById(u);w&&(w.state!=="loading"&&(w.state=g),yield this._loadTile(w,u,g))}))}_tileLoaded(u,g,w){u.timeAdded=T(),u.selfFading&&(u.fadeEndTime=u.timeAdded+this._rasterFadeDuration),w==="expired"&&(u.refreshedUponExpiration=!0),this._setTileReloadTimer(g,u),this.getSource().type==="raster-dem"&&u.dem&&(function(C,L){var z,Y;const re=L.getRenderableIds();for(const le of re){if(!C.neighboringTiles||!C.neighboringTiles[le])continue;const he=L.getTileById(le);C.neighboringTiles[le].backfilled||Nn(C,he),!((Y=(z=he.neighboringTiles)===null||z===void 0?void 0:z[C.tileID.key])===null||Y===void 0)&&Y.backfilled||Nn(he,C)}})(u,this._inViewTiles),this._state.initializeTileState(u,this.map?this.map.painter:null),u.aborted||this._source.fire(new o.l("data",{dataType:"source",tile:u,coord:u.tileID}))}getTile(u){return this.getTileByID(u.key)}getTileByID(u){return this._inViewTiles.getTileById(u)}_retainLoadedChildren(u,g){const w=this._getLoadedDescendents(g),C=new Set;for(const L of g){const z=w[L.key];if(!z?.length){C.add(L);continue}const Y=L.overscaledZ+Ci.maxOverzooming,re=z.filter((Pe=>Pe.tileID.overscaledZ<=Y));if(!re.length){C.add(L);continue}const le=Math.min(...re.map((Pe=>Pe.tileID.overscaledZ))),he=re.filter((Pe=>Pe.tileID.overscaledZ===le)).map((Pe=>Pe.tileID));for(const Pe of he)u[Pe.key]=Pe;this._areDescendentsComplete(he,le,L.overscaledZ)||C.add(L)}return C}_getLoadedDescendents(u){var g;const w={};for(const C of this._inViewTiles.getAllTiles().filter((L=>L.hasData())))for(const L of u)C.tileID.isChildOf(L)&&(w[g=L.key]||(w[g]=[])).push(C);return w}_areDescendentsComplete(u,g,w){return u.length===1&&u[0].isOverscaled()?u[0].overscaledZ===g:Math.pow(4,g-w)===u.length}getLoadedTile(u){return this._inViewTiles.getLoadedTile(u)}updateCacheSize(u){const g=Math.ceil(u.width/this._source.tileSize)+1,w=Math.ceil(u.height/this._source.tileSize)+1,C=Math.floor(g*w*(this._maxTileCacheZoomLevels===null?o.c.MAX_TILE_CACHE_ZOOM_LEVELS:this._maxTileCacheZoomLevels)),L=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,C):C;this._outOfViewCache.setMaxSize(L)}handleWrapJump(u){const g=Math.round((u-(this._prevLng===void 0?u:this._prevLng))/360);this._prevLng=u,g&&(this._inViewTiles.handleWrapJump(g),this._resetTileReloadTimers())}update(u,g){if(!this._sourceLoaded||this._paused)return;let w;this.transform=u,this.terrain=g,this.updateCacheSize(u),this.handleWrapJump(this.transform.center.lng),this.used||this.usedForTerrain?this._source.tileID?w=u.getVisibleUnwrappedCoordinates(this._source.tileID).map((re=>new o.a2(re.canonical.z,re.wrap,re.canonical.z,re.canonical.x,re.canonical.y))):(w=Kn(u,{tileSize:this.usedForTerrain?this.tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.type==="vector"&&this.map._zoomLevelsToOverscale!==void 0?u.maxZoom-this.map._zoomLevelsToOverscale:this._source.maxzoom,roundZoom:!this.usedForTerrain&&this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled,terrain:g,calculateTileZoom:this._source.calculateTileZoom}),this._source.hasTile&&(w=w.filter((re=>this._source.hasTile(re))))):w=[],this.usedForTerrain&&(w=this._addTerrainIdealTiles(w));const C=w.length===0&&!this._updated&&this._didEmitContent;this._updated=!0,C&&this.fire(new o.l("data",{sourceDataType:"idle",dataType:"source",sourceId:this.id}));const L=un(u,this._source),z=this._updateRetainedTiles(w,L),Y=He(this._source.type);Y&&this._rasterFadeDuration>0&&!g&&(function(re,le,he,Pe,Ae,Ue,Ze){const ht=T(),pt=o.av(le);for(const dt of le){const xt=re.getTileById(dt.key);xt.fadingDirection!==ct.Departing&&xt.fadeOpacity!==0||xt.resetFadeLogic(),Tt(re,xt,he,ht,Pe,Ae,Ze)||Gt(re,xt,he,ht,Ue,Ze)||Xr(xt,pt,ht,Ze)||xt.resetFadeLogic()}})(this._inViewTiles,w,z,this._maxFadingAncestorLevels,this._source.minzoom,this._source.maxzoom,this._rasterFadeDuration),Y?this._cleanUpRasterTiles(z):this._cleanUpVectorTiles(z)}_cleanUpRasterTiles(u){for(const g of this._inViewTiles.getAllIds())u[g]||this._removeTile(g)}_cleanUpVectorTiles(u){for(const g of this._inViewTiles.getAllIds()){const w=this._inViewTiles.getTileById(g);u[g]?w.clearSymbolFadeHold():w.hasSymbolBuckets?w.holdingForSymbolFade()?w.symbolFadeFinished()&&this._removeTile(g):w.setSymbolHoldDuration(this.map._fadeDuration):this._removeTile(g)}}_addTerrainIdealTiles(u){const g=[];for(const w of u)if(w.canonical.z>this._source.minzoom){const C=w.scaledTo(w.canonical.z-1);g.push(C);const L=w.scaledTo(Math.max(this._source.minzoom,Math.min(w.canonical.z,5)));g.push(L)}return u.concat(g)}releaseSymbolFadeTiles(){for(const u of this._inViewTiles.getAllIds())this._inViewTiles.getTileById(u).holdingForSymbolFade()&&this._removeTile(u)}_updateRetainedTiles(u,g){var w;const C=new Set;for(const le of u)this._addTile(le).hasData()||C.add(le);const L=u.reduce(((le,he)=>(le[he.key]=he,le)),{}),z=this._retainLoadedChildren(L,C),Y={},re=Math.max(g-Ci.maxUnderzooming,this._source.minzoom);for(const le of z){let he=this._inViewTiles.getTileById(le.key),Pe=he?.wasRequested();for(let Ae=le.overscaledZ-1;Ae>=re;--Ae){const Ue=le.scaledTo(Ae);if(Y[Ue.key])break;if(Y[Ue.key]=!0,he=this.getTile(Ue),!he&&Pe&&(he=this._addTile(Ue)),he){const Ze=he.hasData();if((Ze||!(!((w=this.map)===null||w===void 0)&&w.cancelPendingTileRequestsWhileZooming)||Pe)&&(L[Ue.key]=Ue),Pe=he.wasRequested(),Ze)break}}}return L}_addTile(u){let g=this._inViewTiles.getTileById(u.key);if(g)return g;g=this._outOfViewCache.getAndRemove(u),g&&(g.resetFadeLogic(),this._setTileReloadTimer(u.key,g),g.tileID=u,this._state.initializeTileState(g,this.map?this.map.painter:null));const w=g;return g||(g=new Qt(u,this._source.tileSize*u.overscaleFactor()),this._loadTile(g,u.key,g.state)),g.uses++,this._inViewTiles.setTile(u.key,g),w||this._source.fire(new o.l("dataloading",{tile:g,coord:g.tileID,dataType:"source"})),g}_setTileReloadTimer(u,g){this._clearTileReloadTimer(u);const w=g.getExpiryTimeout();w&&(this._timers[u]=setTimeout((()=>{this._reloadTile(u,"expired"),delete this._timers[u]}),w))}_clearTileReloadTimer(u){const g=this._timers[u];g&&(clearTimeout(g),delete this._timers[u])}_resetTileReloadTimers(){for(const u in this._timers)clearTimeout(this._timers[u]),delete this._timers[u];for(const u of this._inViewTiles.getAllIds()){const g=this._inViewTiles.getTileById(u);this._setTileReloadTimer(u,g)}}refreshTiles(u){for(const g of this._inViewTiles.getAllIds()){const w=this._inViewTiles.getTileById(g);(this._inViewTiles.isIdRenderable(g)||w.state=="errored")&&u.some((C=>C.equals(w.tileID.canonical)))&&this._reloadTile(g,"expired")}}_removeTile(u){const g=this._inViewTiles.getTileById(u);g&&(g.uses--,this._inViewTiles.deleteTileById(u),this._clearTileReloadTimer(u),g.uses>0||(g.hasData()&&g.state!=="reloading"?this._outOfViewCache.add(g.tileID,g,g.getExpiryTimeout()):(g.aborted=!0,this._abortTile(g),this._unloadTile(g))))}_dataHandler(u){u.dataType==="source"&&(u.sourceDataType!=="metadata"?u.sourceDataType==="content"&&this._sourceLoaded&&!this._paused&&(this.reload(u.sourceDataChanged,u.shouldReloadTileOptions),this.transform&&this.update(this.transform,this.terrain),this._didEmitContent=!0):this._sourceLoaded=!0)}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const u of this._inViewTiles.getAllIds())this._removeTile(u);this._outOfViewCache.reset()}tilesIn(u,g,w){const C=[],L=this.transform;if(!L)return C;const z=L.getCoveringTilesDetailsProvider().allowWorldCopies(),Y=w?L.getCameraQueryGeometry(u):u,re=Ue=>L.screenPointToMercatorCoordinate(Ue,this.terrain),le=this.transformBbox(u,re,!z),he=this.transformBbox(Y,re,!z),Pe=this.getIds(),Ae=o.aa.fromPoints(he);for(let Ue=0;Ue<Pe.length;Ue++){const Ze=this._inViewTiles.getTileById(Pe[Ue]);if(Ze.holdingForSymbolFade())continue;const ht=z?[Ze.tileID]:[Ze.tileID.unwrapTo(-1),Ze.tileID.unwrapTo(0)],pt=Math.pow(2,L.zoom-Ze.tileID.overscaledZ),dt=g*Ze.queryPadding*o.a5/Ze.tileSize/pt;for(const xt of ht){const Nt=Ae.map((wt=>xt.getTilePoint(new o.a9(wt.x,wt.y))));if(Nt.expandBy(dt),Nt.intersects(Re)){const wt=le.map((jt=>xt.getTilePoint(jt))),Lt=he.map((jt=>xt.getTilePoint(jt)));C.push({tile:Ze,tileID:z?xt:xt.unwrapTo(0),queryGeometry:wt,cameraQueryGeometry:Lt,scale:pt})}}}return C}transformBbox(u,g,w){let C=u.map(g);if(w){const L=o.aa.fromPoints(u);L.shrinkBy(.001*Math.min(L.width(),L.height()));const z=L.map(g);o.aa.fromPoints(C).covers(z)||(C=C.map((Y=>Y.x>.5?new o.a9(Y.x-1,Y.y,Y.z):Y)))}return C}getVisibleCoordinates(u){const g=this.getRenderableIds(u).map((w=>this._inViewTiles.getTileById(w).tileID));return this.transform&&this.transform.populateCache(g),g}hasTransition(){return!!this._source.hasTransition()||!(!He(this._source.type)||!(function(u,g){if(g<=0)return!1;const w=T();for(const C of u.getAllTiles())if(C.fadeEndTime>=w)return!0;return!1})(this._inViewTiles,this._rasterFadeDuration))}setRasterFadeDuration(u){this._rasterFadeDuration=u}setFeatureState(u,g,w){this._state.updateState(u=u||o.ai,g,w)}removeFeatureState(u,g,w){this._state.removeFeatureState(u=u||o.ai,g,w)}getFeatureState(u,g){return this._state.getState(u=u||o.ai,g)}setDependencies(u,g,w){const C=this._inViewTiles.getTileById(u);C&&C.setDependencies(g,w)}reloadTilesForDependencies(u,g){for(const w of this._inViewTiles.getAllIds())this._inViewTiles.getTileById(w).hasDependency(u,g)&&this._reloadTile(w,"reloading");this._outOfViewCache.filter((w=>!w.hasDependency(u,g)))}areTilesLoaded(){for(const u of this._inViewTiles.getAllTiles())if(u.state!=="loaded"&&u.state!=="errored")return!1;return!0}}Ci.maxUnderzooming=10,Ci.maxOverzooming=3;class Fr{constructor(u,g){this.reset(u,g)}reset(u,g){this.points=u||[],this._distances=[0];for(let w=1;w<this.points.length;w++)this._distances[w]=this._distances[w-1]+this.points[w].dist(this.points[w-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(g||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(u){if(this.points.length===1)return this.points[0];u=o.an(u,0,1);let g=1,w=this._distances[g];const C=u*this.paddedLength+this.padding;for(;w<C&&g<this._distances.length;)w=this._distances[++g];const L=g-1,z=this._distances[L],Y=w-z,re=Y>0?(C-z)/Y:0;return this.points[L].mult(1-re).add(this.points[g].mult(re))}}function Mn(D,u){let g=!0;return D==="always"||D!=="never"&&u!=="never"||(g=!1),g}class Bn{constructor(u,g,w){const C=this.boxCells=[],L=this.circleCells=[];this.xCellCount=Math.ceil(u/w),this.yCellCount=Math.ceil(g/w);for(let z=0;z<this.xCellCount*this.yCellCount;z++)C.push([]),L.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=u,this.height=g,this.xScale=this.xCellCount/u,this.yScale=this.yCellCount/g,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(u,g,w,C,L){this._forEachCell(g,w,C,L,this._insertBoxCell,this.boxUid++),this.boxKeys.push(u),this.bboxes.push(g),this.bboxes.push(w),this.bboxes.push(C),this.bboxes.push(L)}insertCircle(u,g,w,C){this._forEachCell(g-C,w-C,g+C,w+C,this._insertCircleCell,this.circleUid++),this.circleKeys.push(u),this.circles.push(g),this.circles.push(w),this.circles.push(C)}_insertBoxCell(u,g,w,C,L,z){this.boxCells[L].push(z)}_insertCircleCell(u,g,w,C,L,z){this.circleCells[L].push(z)}_query(u,g,w,C,L,z,Y){if(w<0||u>this.width||C<0||g>this.height)return[];const re=[];if(u<=0&&g<=0&&this.width<=w&&this.height<=C){if(L)return[{key:null,x1:u,y1:g,x2:w,y2:C}];for(let le=0;le<this.boxKeys.length;le++)re.push({key:this.boxKeys[le],x1:this.bboxes[4*le],y1:this.bboxes[4*le+1],x2:this.bboxes[4*le+2],y2:this.bboxes[4*le+3]});for(let le=0;le<this.circleKeys.length;le++){const he=this.circles[3*le],Pe=this.circles[3*le+1],Ae=this.circles[3*le+2];re.push({key:this.circleKeys[le],x1:he-Ae,y1:Pe-Ae,x2:he+Ae,y2:Pe+Ae})}}else this._forEachCell(u,g,w,C,this._queryCell,re,{hitTest:L,overlapMode:z,seenUids:{box:{},circle:{}}},Y);return re}query(u,g,w,C){return this._query(u,g,w,C,!1,null)}hitTest(u,g,w,C,L,z){return this._query(u,g,w,C,!0,L,z).length>0}hitTestCircle(u,g,w,C,L){const z=u-w,Y=u+w,re=g-w,le=g+w;if(Y<0||z>this.width||le<0||re>this.height)return!1;const he=[];return this._forEachCell(z,re,Y,le,this._queryCellCircle,he,{hitTest:!0,overlapMode:C,circle:{x:u,y:g,radius:w},seenUids:{box:{},circle:{}}},L),he.length>0}_queryCell(u,g,w,C,L,z,Y,re){const{seenUids:le,hitTest:he,overlapMode:Pe}=Y,Ae=this.boxCells[L];if(Ae!==null){const Ze=this.bboxes;for(const ht of Ae)if(!le.box[ht]){le.box[ht]=!0;const pt=4*ht,dt=this.boxKeys[ht];if(u<=Ze[pt+2]&&g<=Ze[pt+3]&&w>=Ze[pt+0]&&C>=Ze[pt+1]&&(!re||re(dt))&&(!he||!Mn(Pe,dt.overlapMode))&&(z.push({key:dt,x1:Ze[pt],y1:Ze[pt+1],x2:Ze[pt+2],y2:Ze[pt+3]}),he))return!0}}const Ue=this.circleCells[L];if(Ue!==null){const Ze=this.circles;for(const ht of Ue)if(!le.circle[ht]){le.circle[ht]=!0;const pt=3*ht,dt=this.circleKeys[ht];if(this._circleAndRectCollide(Ze[pt],Ze[pt+1],Ze[pt+2],u,g,w,C)&&(!re||re(dt))&&(!he||!Mn(Pe,dt.overlapMode))){const xt=Ze[pt],Nt=Ze[pt+1],wt=Ze[pt+2];if(z.push({key:dt,x1:xt-wt,y1:Nt-wt,x2:xt+wt,y2:Nt+wt}),he)return!0}}}return!1}_queryCellCircle(u,g,w,C,L,z,Y,re){const{circle:le,seenUids:he,overlapMode:Pe}=Y,Ae=this.boxCells[L];if(Ae!==null){const Ze=this.bboxes;for(const ht of Ae)if(!he.box[ht]){he.box[ht]=!0;const pt=4*ht,dt=this.boxKeys[ht];if(this._circleAndRectCollide(le.x,le.y,le.radius,Ze[pt+0],Ze[pt+1],Ze[pt+2],Ze[pt+3])&&(!re||re(dt))&&!Mn(Pe,dt.overlapMode))return z.push(!0),!0}}const Ue=this.circleCells[L];if(Ue!==null){const Ze=this.circles;for(const ht of Ue)if(!he.circle[ht]){he.circle[ht]=!0;const pt=3*ht,dt=this.circleKeys[ht];if(this._circlesCollide(Ze[pt],Ze[pt+1],Ze[pt+2],le.x,le.y,le.radius)&&(!re||re(dt))&&!Mn(Pe,dt.overlapMode))return z.push(!0),!0}}}_forEachCell(u,g,w,C,L,z,Y,re){const le=this._convertToXCellCoord(u),he=this._convertToYCellCoord(g),Pe=this._convertToXCellCoord(w),Ae=this._convertToYCellCoord(C);for(let Ue=le;Ue<=Pe;Ue++)for(let Ze=he;Ze<=Ae;Ze++)if(L.call(this,u,g,w,C,this.xCellCount*Ze+Ue,z,Y,re))return}_convertToXCellCoord(u){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(u*this.xScale)))}_convertToYCellCoord(u){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(u*this.yScale)))}_circlesCollide(u,g,w,C,L,z){const Y=C-u,re=L-g,le=w+z;return le*le>Y*Y+re*re}_circleAndRectCollide(u,g,w,C,L,z,Y){const re=(z-C)/2,le=Math.abs(u-(C+re));if(le>re+w)return!1;const he=(Y-L)/2,Pe=Math.abs(g-(L+he));if(Pe>he+w)return!1;if(le<=re||Pe<=he)return!0;const Ae=le-re,Ue=Pe-he;return Ae*Ae+Ue*Ue<=w*w}}function ei(D,u,g){const w=o.N();if(!D){const{vecSouth:Pe,vecEast:Ae}=ha(u),Ue=f();Ue[0]=Ae[0],Ue[1]=Ae[1],Ue[2]=Pe[0],Ue[3]=Pe[1],C=Ue,(he=(z=(L=Ue)[0])*(le=L[3])-(re=L[2])*(Y=L[1]))&&(C[0]=le*(he=1/he),C[1]=-Y*he,C[2]=-re*he,C[3]=z*he),w[0]=Ue[0],w[1]=Ue[1],w[4]=Ue[2],w[5]=Ue[3]}var C,L,z,Y,re,le,he;return o.Q(w,w,[1/g,1/g,1]),w}function ua(D,u,g,w){if(D){const C=o.N();if(!u){const{vecSouth:L,vecEast:z}=ha(g);C[0]=z[0],C[1]=z[1],C[4]=L[0],C[5]=L[1]}return o.Q(C,C,[w,w,1]),C}return g.pixelsToClipSpaceMatrix}function ha(D){const u=Math.cos(D.rollInRadians),g=Math.sin(D.rollInRadians),w=Math.cos(D.pitchInRadians),C=Math.cos(D.bearingInRadians),L=Math.sin(D.bearingInRadians),z=o.aC();z[0]=-C*w*g-L*u,z[1]=-L*w*g+C*u;const Y=o.aD(z);Y<1e-9?o.aE(z):o.aF(z,z,1/Y);const re=o.aC();re[0]=C*w*u-L*g,re[1]=L*w*u+C*g;const le=o.aD(re);return le<1e-9?o.aE(re):o.aF(re,re,1/le),{vecEast:re,vecSouth:z}}function zn(D,u,g,w){let C;w?(C=[D,u,w(D,u),1],o.aH(C,C,g)):(C=[D,u,0,1],Fa(C,C,g));const L=C[3];return{point:new o.P(C[0]/L,C[1]/L),signedDistanceFromCamera:L,isOccluded:!1}}function La(D,u){return .5+D/u*.5}function Wi(D,u){return D.x>=-u[0]&&D.x<=u[0]&&D.y>=-u[1]&&D.y<=u[1]}function hs(D,u,g,w,C,L,z,Y,re,le,he,Pe,Ae){const Ue=g?D.textSizeData:D.iconSizeData,Ze=o.ay(Ue,u.transform.zoom),ht=[256/u.width*2+1,256/u.height*2+1],pt=g?D.text.dynamicLayoutVertexArray:D.icon.dynamicLayoutVertexArray;pt.clear();const dt=D.lineVertexArray,xt=g?D.text.placedSymbolArray:D.icon.placedSymbolArray,Nt=u.transform.width/u.transform.height;let wt=!1;for(let Lt=0;Lt<xt.length;Lt++){const jt=xt.get(Lt);if(jt.hidden||jt.writingMode===o.az.vertical&&!wt){Ul(jt.numGlyphs,pt);continue}wt=!1;const Dt=new o.P(jt.anchorX,jt.anchorY),Zt={getElevation:Ae,pitchedLabelPlaneMatrix:w,lineVertexArray:dt,pitchWithMap:L,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},transform:u.transform,tileAnchorPoint:Dt,unwrappedTileID:re,width:le,height:he,translation:Pe},Sr=ga(jt.anchorX,jt.anchorY,Zt);if(!Wi(Sr.point,ht)){Ul(jt.numGlyphs,pt);continue}const pr=La(u.transform.cameraToCenterDistance,Sr.signedDistanceFromCamera),_r=o.aA(Ue,Ze,jt),xr=L?_r*u.transform.getPitchedTextCorrection(jt.anchorX,jt.anchorY,re)/pr:_r*pr,an=Ya({projectionContext:Zt,pitchedLabelPlaneMatrixInverse:C,symbol:jt,fontSize:xr,flip:!1,keepUpright:z,glyphOffsetArray:D.glyphOffsetArray,dynamicLayoutVertexArray:pt,aspectRatio:Nt,rotateToLine:Y});wt=an.useVertical,(an.notEnoughRoom||wt||an.needsFlipping&&Ya({projectionContext:Zt,pitchedLabelPlaneMatrixInverse:C,symbol:jt,fontSize:xr,flip:!0,keepUpright:z,glyphOffsetArray:D.glyphOffsetArray,dynamicLayoutVertexArray:pt,aspectRatio:Nt,rotateToLine:Y}).notEnoughRoom)&&Ul(jt.numGlyphs,pt)}g?D.text.dynamicLayoutVertexBuffer.updateData(pt):D.icon.dynamicLayoutVertexBuffer.updateData(pt)}function Ca(D,u,g,w,C,L,z,Y){const re=L.glyphStartIndex+L.numGlyphs,le=L.lineStartIndex,he=L.lineStartIndex+L.lineLength,Pe=u.getoffsetX(L.glyphStartIndex),Ae=u.getoffsetX(re-1),Ue=Aa(D*Pe,g,w,C,L.segment,le,he,Y,z);if(!Ue)return null;const Ze=Aa(D*Ae,g,w,C,L.segment,le,he,Y,z);return Ze?Y.projectionCache.anyProjectionOccluded?null:{first:Ue,last:Ze}:null}function Mo(D,u,g,w){return D===o.az.horizontal&&Math.abs(g.y-u.y)>Math.abs(g.x-u.x)*w?{useVertical:!0}:(D===o.az.vertical?u.y<g.y:u.x>g.x)?{needsFlipping:!0}:null}function Ya(D){const{projectionContext:u,pitchedLabelPlaneMatrixInverse:g,symbol:w,fontSize:C,flip:L,keepUpright:z,glyphOffsetArray:Y,dynamicLayoutVertexArray:re,aspectRatio:le,rotateToLine:he}=D,Pe=C/24,Ae=w.lineOffsetX*Pe,Ue=w.lineOffsetY*Pe;let Ze;if(w.numGlyphs>1){const ht=w.glyphStartIndex+w.numGlyphs,pt=w.lineStartIndex,dt=w.lineStartIndex+w.lineLength,xt=Ca(Pe,Y,Ae,Ue,L,w,he,u);if(!xt)return{notEnoughRoom:!0};const Nt=Iu(xt.first.point.x,xt.first.point.y,u,g),wt=Iu(xt.last.point.x,xt.last.point.y,u,g);if(z&&!L){const Lt=Mo(w.writingMode,Nt,wt,le);if(Lt)return Lt}Ze=[xt.first];for(let Lt=w.glyphStartIndex+1;Lt<ht-1;Lt++){const jt=Aa(Pe*Y.getoffsetX(Lt),Ae,Ue,L,w.segment,pt,dt,u,he);if(!jt)return{notEnoughRoom:!0};Ze.push(jt)}Ze.push(xt.last)}else{if(z&&!L){const pt=zi(u.tileAnchorPoint.x,u.tileAnchorPoint.y,u).point,dt=w.lineStartIndex+w.segment+1,xt=new o.P(u.lineVertexArray.getx(dt),u.lineVertexArray.gety(dt)),Nt=zi(xt.x,xt.y,u),wt=Nt.signedDistanceFromCamera>0?Nt.point:ol(u.tileAnchorPoint,xt,pt,1,u),Lt=Iu(pt.x,pt.y,u,g),jt=Iu(wt.x,wt.y,u,g),Dt=Mo(w.writingMode,Lt,jt,le);if(Dt)return Dt}const ht=Aa(Pe*Y.getoffsetX(w.glyphStartIndex),Ae,Ue,L,w.segment,w.lineStartIndex,w.lineStartIndex+w.lineLength,u,he);if(!ht||u.projectionCache.anyProjectionOccluded)return{notEnoughRoom:!0};Ze=[ht]}for(const ht of Ze)o.aG(re,ht.point,ht.angle);return{}}function ol(D,u,g,w,C){const L=D.add(D.sub(u)._unit()),z=zi(L.x,L.y,C).point,Y=g.sub(z);return g.add(Y._mult(w/Y.mag()))}function xi(D,u,g){const w=u.projectionCache;if(w.projections[D])return w.projections[D];const C=new o.P(u.lineVertexArray.getx(D),u.lineVertexArray.gety(D)),L=zi(C.x,C.y,u);if(L.signedDistanceFromCamera>0)return w.projections[D]=L.point,w.anyProjectionOccluded=w.anyProjectionOccluded||L.isOccluded,L.point;const z=D-g.direction;return ol(g.distanceFromAnchor===0?u.tileAnchorPoint:new o.P(u.lineVertexArray.getx(z),u.lineVertexArray.gety(z)),C,g.previousVertex,g.absOffsetX-g.distanceFromAnchor+1,u)}function zi(D,u,g){const w=D+g.translation[0],C=u+g.translation[1];let L;return g.pitchWithMap?(L=zn(w,C,g.pitchedLabelPlaneMatrix,g.getElevation),L.isOccluded=!1):(L=g.transform.projectTileCoordinates(w,C,g.unwrappedTileID,g.getElevation),L.point.x=(.5*L.point.x+.5)*g.width,L.point.y=(.5*-L.point.y+.5)*g.height),L}function Iu(D,u,g,w){if(g.pitchWithMap){const C=[D,u,0,1];return o.aH(C,C,w),g.transform.projectTileCoordinates(C[0]/C[3],C[1]/C[3],g.unwrappedTileID,g.getElevation).point}return{x:D/g.width*2-1,y:1-u/g.height*2}}function ga(D,u,g){return g.transform.projectTileCoordinates(D,u,g.unwrappedTileID,g.getElevation)}function Za(D,u,g){return D._unit()._perp()._mult(u*g)}function ds(D,u,g,w,C,L,z,Y,re){if(Y.projectionCache.offsets[D])return Y.projectionCache.offsets[D];const le=g.add(u);if(D+re.direction<w||D+re.direction>=C)return Y.projectionCache.offsets[D]=le,le;const he=xi(D+re.direction,Y,re),Pe=Za(he.sub(g),z,re.direction),Ae=g.add(Pe),Ue=he.add(Pe);return Y.projectionCache.offsets[D]=o.aI(L,le,Ae,Ue)||le,Y.projectionCache.offsets[D]}function Aa(D,u,g,w,C,L,z,Y,re){const le=w?D-u:D+u;let he=le>0?1:-1,Pe=0;w&&(he*=-1,Pe=Math.PI),he<0&&(Pe+=Math.PI);let Ae,Ue=he>0?L+C:L+C+1;Y.projectionCache.cachedAnchorPoint?Ae=Y.projectionCache.cachedAnchorPoint:(Ae=zi(Y.tileAnchorPoint.x,Y.tileAnchorPoint.y,Y).point,Y.projectionCache.cachedAnchorPoint=Ae);let Ze,ht,pt=Ae,dt=Ae,xt=0,Nt=0;const wt=Math.abs(le),Lt=[];let jt;for(;xt+Nt<=wt;){if(Ue+=he,Ue<L||Ue>=z)return null;xt+=Nt,dt=pt,ht=Ze;const Sr={absOffsetX:wt,direction:he,distanceFromAnchor:xt,previousVertex:dt};if(pt=xi(Ue,Y,Sr),g===0)Lt.push(dt),jt=pt.sub(dt);else{let pr;const _r=pt.sub(dt);pr=_r.mag()===0?Za(xi(Ue+he,Y,Sr).sub(pt),g,he):Za(_r,g,he),ht||(ht=dt.add(pr)),Ze=ds(Ue,pr,pt,L,z,ht,g,Y,Sr),Lt.push(ht),jt=Ze.sub(ht)}Nt=jt.mag()}const Dt=jt._mult((wt-xt)/Nt)._add(ht||dt),Zt=Pe+Math.atan2(pt.y-dt.y,pt.x-dt.x);return Lt.push(Dt),{point:Dt,angle:re?Zt:0,path:Lt}}const ps=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function Ul(D,u){for(let g=0;g<D;g++){const w=u.length;u.resize(w+4),u.float32.set(ps,3*w)}}function Fa(D,u,g){const w=u[0],C=u[1];return D[0]=g[0]*w+g[4]*C+g[12],D[1]=g[1]*w+g[5]*C+g[13],D[3]=g[3]*w+g[7]*C+g[15],D}const _a=100;class wc{constructor(u,g=new Bn(u.width+200,u.height+200,25),w=new Bn(u.width+200,u.height+200,25)){this.transform=u,this.grid=g,this.ignoredGrid=w,this.pitchFactor=Math.cos(u.pitch*Math.PI/180)*u.cameraToCenterDistance,this.screenRightBoundary=u.width+_a,this.screenBottomBoundary=u.height+_a,this.gridRightBoundary=u.width+200,this.gridBottomBoundary=u.height+200,this.perspectiveRatioCutoff=.6}placeCollisionBox(u,g,w,C,L,z,Y,re,le,he,Pe,Ae){const Ue=this.projectAndGetPerspectiveRatio(u.anchorPointX+re[0],u.anchorPointY+re[1],L,he,Ae),Ze=w*Ue.perspectiveRatio;let ht;if(z||Y)ht=this._projectCollisionBox(u,Ze,C,L,z,Y,re,Ue,he,Pe,Ae);else{const jt=Ue.x+(Pe?Pe.x*Ze:0),Dt=Ue.y+(Pe?Pe.y*Ze:0);ht={allPointsOccluded:!1,box:[jt+u.x1*Ze,Dt+u.y1*Ze,jt+u.x2*Ze,Dt+u.y2*Ze]}}const[pt,dt,xt,Nt]=ht.box,wt=z?ht.allPointsOccluded:Ue.isOccluded;let Lt=wt;return Lt||(Lt=Ue.perspectiveRatio<this.perspectiveRatioCutoff),Lt||(Lt=!this.isInsideGrid(pt,dt,xt,Nt)),Lt||g!=="always"&&this.grid.hitTest(pt,dt,xt,Nt,g,le)?{box:[pt,dt,xt,Nt],placeable:!1,offscreen:!1,occluded:wt}:{box:[pt,dt,xt,Nt],placeable:!0,offscreen:this.isOffscreen(pt,dt,xt,Nt),occluded:wt}}placeCollisionCircles(u,g,w,C,L,z,Y,re,le,he,Pe,Ae,Ue,Ze){const ht=[],pt=new o.P(g.anchorX,g.anchorY),dt=this.getPerspectiveRatio(pt.x,pt.y,z,Ze),xt=(le?L*this.transform.getPitchedTextCorrection(g.anchorX,g.anchorY,z)/dt:L*dt)/o.aM,Nt={getElevation:Ze,pitchedLabelPlaneMatrix:Y,lineVertexArray:w,pitchWithMap:le,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},transform:this.transform,tileAnchorPoint:pt,unwrappedTileID:z,width:this.transform.width,height:this.transform.height,translation:Ue},wt=Ca(xt,C,g.lineOffsetX*xt,g.lineOffsetY*xt,!1,g,!1,Nt);let Lt=!1,jt=!1,Dt=!0;if(wt){const Zt=.5*Pe*dt+Ae,Sr=new o.P(-100,-100),pr=new o.P(this.screenRightBoundary,this.screenBottomBoundary),_r=new Fr,xr=wt.first,an=wt.last;let ln=[];for(let Ti=xr.path.length-1;Ti>=1;Ti--)ln.push(xr.path[Ti]);for(let Ti=1;Ti<an.path.length;Ti++)ln.push(an.path[Ti]);const Hr=2.5*Zt;if(le){const Ti=this.projectPathToScreenSpace(ln,Nt);ln=Ti.some((Ra=>Ra.signedDistanceFromCamera<=0))?[]:Ti.map((Ra=>Ra.point))}let gn=[];if(ln.length>0){const Ti=ln[0].clone(),Ra=ln[0].clone();for(let yo=1;yo<ln.length;yo++)Ti.x=Math.min(Ti.x,ln[yo].x),Ti.y=Math.min(Ti.y,ln[yo].y),Ra.x=Math.max(Ra.x,ln[yo].x),Ra.y=Math.max(Ra.y,ln[yo].y);gn=Ti.x>=Sr.x&&Ra.x<=pr.x&&Ti.y>=Sr.y&&Ra.y<=pr.y?[ln]:Ra.x<Sr.x||Ti.x>pr.x||Ra.y<Sr.y||Ti.y>pr.y?[]:o.aJ([ln],Sr.x,Sr.y,pr.x,pr.y)}for(const Ti of gn){_r.reset(Ti,.25*Zt);let Ra=0;Ra=_r.length<=.5*Zt?1:Math.ceil(_r.paddedLength/Hr)+1;for(let yo=0;yo<Ra;yo++){const to=yo/Math.max(Ra-1,1),Ao=_r.lerp(to),ro=Ao.x+_a,Xo=Ao.y+_a;ht.push(ro,Xo,Zt,0);const Io=ro-Zt,pl=Xo-Zt,vs=ro+Zt,as=Xo+Zt;if(Dt=Dt&&this.isOffscreen(Io,pl,vs,as),jt=jt||this.isInsideGrid(Io,pl,vs,as),u!=="always"&&this.grid.hitTestCircle(ro,Xo,Zt,u,he)&&(Lt=!0,!re))return{circles:[],offscreen:!1,collisionDetected:Lt}}}}return{circles:!re&&Lt||!jt||dt<this.perspectiveRatioCutoff?[]:ht,offscreen:Dt,collisionDetected:Lt}}projectPathToScreenSpace(u,g){const w=(function(C,L){const z=o.N();return o.aB(z,L.pitchedLabelPlaneMatrix),C.map((Y=>{const re=zn(Y.x,Y.y,z,L.getElevation),le=L.transform.projectTileCoordinates(re.point.x,re.point.y,L.unwrappedTileID,L.getElevation);return le.point.x=(.5*le.point.x+.5)*L.width,le.point.y=(.5*-le.point.y+.5)*L.height,le}))})(u,g);return(function(C){let L=0,z=0,Y=0,re=0;for(let le=0;le<C.length;le++)C[le].isOccluded?(Y=le+1,re=0):(re++,re>z&&(z=re,L=Y));return C.slice(L,L+z)})(w)}queryRenderedSymbols(u){if(u.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const g=[],w=new o.aa;for(const Pe of u){const Ae=new o.P(Pe.x+_a,Pe.y+_a);w.extend(Ae),g.push(Ae)}const{minX:C,minY:L,maxX:z,maxY:Y}=w,re=this.grid.query(C,L,z,Y).concat(this.ignoredGrid.query(C,L,z,Y)),le={},he={};for(const Pe of re){const Ae=Pe.key;if(le[Ae.bucketInstanceId]===void 0&&(le[Ae.bucketInstanceId]={}),le[Ae.bucketInstanceId][Ae.featureIndex])continue;const Ue=[new o.P(Pe.x1,Pe.y1),new o.P(Pe.x2,Pe.y1),new o.P(Pe.x2,Pe.y2),new o.P(Pe.x1,Pe.y2)];o.aK(g,Ue)&&(le[Ae.bucketInstanceId][Ae.featureIndex]=!0,he[Ae.bucketInstanceId]===void 0&&(he[Ae.bucketInstanceId]=[]),he[Ae.bucketInstanceId].push(Ae.featureIndex))}return he}insertCollisionBox(u,g,w,C,L,z){(w?this.ignoredGrid:this.grid).insert({bucketInstanceId:C,featureIndex:L,collisionGroupID:z,overlapMode:g},u[0],u[1],u[2],u[3])}insertCollisionCircles(u,g,w,C,L,z){const Y=w?this.ignoredGrid:this.grid,re={bucketInstanceId:C,featureIndex:L,collisionGroupID:z,overlapMode:g};for(let le=0;le<u.length;le+=4)Y.insertCircle(re,u[le],u[le+1],u[le+2])}projectAndGetPerspectiveRatio(u,g,w,C,L){if(L){let z;C?(z=[u,g,C(u,g),1],o.aH(z,z,L)):(z=[u,g,0,1],Fa(z,z,L));const Y=z[3];return{x:(z[0]/Y+1)/2*this.transform.width+_a,y:(-z[1]/Y+1)/2*this.transform.height+_a,perspectiveRatio:.5+this.transform.cameraToCenterDistance/Y*.5,isOccluded:!1,signedDistanceFromCamera:Y}}{const z=this.transform.projectTileCoordinates(u,g,w,C);return{x:(z.point.x+1)/2*this.transform.width+_a,y:(1-z.point.y)/2*this.transform.height+_a,perspectiveRatio:.5+this.transform.cameraToCenterDistance/z.signedDistanceFromCamera*.5,isOccluded:z.isOccluded,signedDistanceFromCamera:z.signedDistanceFromCamera}}}getPerspectiveRatio(u,g,w,C){const L=this.transform.projectTileCoordinates(u,g,w,C);return .5+this.transform.cameraToCenterDistance/L.signedDistanceFromCamera*.5}isOffscreen(u,g,w,C){return w<_a||u>=this.screenRightBoundary||C<_a||g>this.screenBottomBoundary}isInsideGrid(u,g,w,C){return w>=0&&u<this.gridRightBoundary&&C>=0&&g<this.gridBottomBoundary}getViewportMatrix(){const u=o.ar([]);return o.O(u,u,[-100,-100,0]),u}_projectCollisionBox(u,g,w,C,L,z,Y,re,le,he,Pe){let Ae=1,Ue=0,Ze=0,ht=1;const pt=u.anchorPointX+Y[0],dt=u.anchorPointY+Y[1];if(z&&!L){const ln=this.projectAndGetPerspectiveRatio(pt+1,dt,C,le,Pe),Hr=ln.x-re.x,gn=Math.atan((ln.y-re.y)/Hr)+(Hr<0?Math.PI:0),Ti=Math.sin(gn),Ra=Math.cos(gn);Ae=Ra,Ue=Ti,Ze=-Ti,ht=Ra}else if(!z&&L){const ln=ha(this.transform);Ae=ln.vecEast[0],Ue=ln.vecEast[1],Ze=ln.vecSouth[0],ht=ln.vecSouth[1]}let xt=re.x,Nt=re.y,wt=g;L&&(xt=pt,Nt=dt,wt=Math.pow(2,-(this.transform.zoom-w.overscaledZ)),wt*=this.transform.getPitchedTextCorrection(pt,dt,C),he||(wt*=o.an(.5+re.signedDistanceFromCamera/this.transform.cameraToCenterDistance*.5,0,4))),he&&(xt+=Ae*he.x*wt+Ze*he.y*wt,Nt+=Ue*he.x*wt+ht*he.y*wt);const Lt=u.x1*wt,jt=u.x2*wt,Dt=(Lt+jt)/2,Zt=u.y1*wt,Sr=u.y2*wt,pr=(Zt+Sr)/2,_r=[{offsetX:Lt,offsetY:Zt},{offsetX:Dt,offsetY:Zt},{offsetX:jt,offsetY:Zt},{offsetX:jt,offsetY:pr},{offsetX:jt,offsetY:Sr},{offsetX:Dt,offsetY:Sr},{offsetX:Lt,offsetY:Sr},{offsetX:Lt,offsetY:pr}];let xr=[];for(const{offsetX:ln,offsetY:Hr}of _r)xr.push(new o.P(xt+Ae*ln+Ze*Hr,Nt+Ue*ln+ht*Hr));let an=!1;if(L){const ln=xr.map((Hr=>this.projectAndGetPerspectiveRatio(Hr.x,Hr.y,C,le,Pe)));an=ln.some((Hr=>!Hr.isOccluded)),xr=ln.map((Hr=>new o.P(Hr.x,Hr.y)))}else an=!0;return{box:o.aL(xr),allPointsOccluded:!an}}}class sl{constructor(u,g,w,C){this.opacity=u?Math.max(0,Math.min(1,u.opacity+(u.placed?g:-g))):C&&w?1:0,this.placed=w}isHidden(){return this.opacity===0&&!this.placed}}class ts{constructor(u,g,w,C,L){this.text=new sl(u?u.text:null,g,w,L),this.icon=new sl(u?u.icon:null,g,C,L)}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class oo{constructor(u,g,w){this.text=u,this.icon=g,this.skipFade=w}}class rs{constructor(u,g,w,C,L){this.bucketInstanceId=u,this.featureIndex=g,this.sourceLayerIndex=w,this.bucketIndex=C,this.tileID=L}}class Ba{constructor(u){this.crossSourceCollisions=u,this.maxGroupID=0,this.collisionGroups={}}get(u){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[u]){const g=++this.maxGroupID;this.collisionGroups[u]={ID:g,predicate:w=>w.collisionGroupID===g}}return this.collisionGroups[u]}}function Us(D,u,g,w,C){const{horizontalAlign:L,verticalAlign:z}=o.aS(D);return new o.P(-(L-.5)*u+w[0]*C,-(z-.5)*g+w[1]*C)}class $c{constructor(u,g,w,C,L){this.transform=u.clone(),this.terrain=g,this.collisionIndex=new wc(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=w,this.retainedQueryData={},this.collisionGroups=new Ba(C),this.collisionCircleArrays={},this.collisionBoxArrays=new Map,this.prevPlacement=L,L&&(L.prevPlacement=void 0),this.placedOrientations={}}_getTerrainElevationFunc(u){const g=this.terrain;return g?(w,C)=>g.getElevation(u,w,C):null}getBucketParts(u,g,w,C){const L=w.getBucket(g),z=w.latestFeatureIndex;if(!L||!z||g.id!==L.layerIds[0])return;const Y=w.collisionBoxArray,re=L.layers[0].layout,le=L.layers[0].paint,he=Math.pow(2,this.transform.zoom-w.tileID.overscaledZ),Pe=w.tileSize/o.a5,Ae=w.tileID.toUnwrapped(),Ue=re.get("text-rotation-alignment")==="map",Ze=o.aN(w,1,this.transform.zoom),ht=o.aO(this.collisionIndex.transform,w,le.get("text-translate"),le.get("text-translate-anchor")),pt=o.aO(this.collisionIndex.transform,w,le.get("icon-translate"),le.get("icon-translate-anchor")),dt=ei(Ue,this.transform,Ze);this.retainedQueryData[L.bucketInstanceId]=new rs(L.bucketInstanceId,z,L.sourceLayerIndex,L.index,w.tileID);const xt={bucket:L,layout:re,translationText:ht,translationIcon:pt,unwrappedTileID:Ae,pitchedLabelPlaneMatrix:dt,scale:he,textPixelRatio:Pe,holdingForFade:w.holdingForSymbolFade(),collisionBoxArray:Y,partiallyEvaluatedTextSize:o.ay(L.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(L.sourceID)};if(C)for(const Nt of L.sortKeyRanges){const{sortKey:wt,symbolInstanceStart:Lt,symbolInstanceEnd:jt}=Nt;u.push({sortKey:wt,symbolInstanceStart:Lt,symbolInstanceEnd:jt,parameters:xt})}else u.push({symbolInstanceStart:0,symbolInstanceEnd:L.symbolInstances.length,parameters:xt})}attemptAnchorPlacement(u,g,w,C,L,z,Y,re,le,he,Pe,Ae,Ue,Ze,ht,pt,dt,xt,Nt,wt){const Lt=o.aP[u.textAnchor],jt=[u.textOffset0,u.textOffset1],Dt=Us(Lt,w,C,jt,L),Zt=this.collisionIndex.placeCollisionBox(g,Ae,re,le,he,Y,z,pt,Pe.predicate,Nt,Dt,wt);if((!xt||this.collisionIndex.placeCollisionBox(xt,Ae,re,le,he,Y,z,dt,Pe.predicate,Nt,Dt,wt).placeable)&&Zt.placeable){let Sr;if(this.prevPlacement&&this.prevPlacement.variableOffsets[Ue.crossTileID]&&this.prevPlacement.placements[Ue.crossTileID]&&this.prevPlacement.placements[Ue.crossTileID].text&&(Sr=this.prevPlacement.variableOffsets[Ue.crossTileID].anchor),Ue.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");return this.variableOffsets[Ue.crossTileID]={textOffset:jt,width:w,height:C,anchor:Lt,textBoxScale:L,prevAnchor:Sr},this.markUsedJustification(Ze,Lt,Ue,ht),Ze.allowVerticalPlacement&&(this.markUsedOrientation(Ze,ht,Ue),this.placedOrientations[Ue.crossTileID]=ht),{shift:Dt,placedGlyphBoxes:Zt}}}placeLayerBucketPart(u,g,w){const{bucket:C,layout:L,translationText:z,translationIcon:Y,unwrappedTileID:re,pitchedLabelPlaneMatrix:le,textPixelRatio:he,holdingForFade:Pe,collisionBoxArray:Ae,partiallyEvaluatedTextSize:Ue,collisionGroup:Ze}=u.parameters,ht=L.get("text-optional"),pt=L.get("icon-optional"),dt=o.aQ(L,"text-overlap","text-allow-overlap"),xt=dt==="always",Nt=o.aQ(L,"icon-overlap","icon-allow-overlap"),wt=Nt==="always",Lt=L.get("text-rotation-alignment")==="map",jt=L.get("text-pitch-alignment")==="map",Dt=L.get("icon-text-fit")!=="none",Zt=L.get("symbol-z-order")==="viewport-y",Sr=xt&&(wt||!C.hasIconData()||pt),pr=wt&&(xt||!C.hasTextData()||ht);!C.collisionArrays&&Ae&&C.deserializeCollisionBoxes(Ae);const _r=this.retainedQueryData[C.bucketInstanceId].tileID,xr=this._getTerrainElevationFunc(_r),an=this.transform.getFastPathSimpleProjectionMatrix(_r),ln=(Hr,gn,Ti)=>{var Ra,yo;if(g[Hr.crossTileID])return;if(Pe)return void(this.placements[Hr.crossTileID]=new oo(!1,!1,!1));let to=!1,Ao=!1,ro=!0,Xo=null,Io={box:null,placeable:!1,offscreen:null,occluded:!1},pl={placeable:!1},vs=null,as=null,Ml=null,Yh=0,lh=0,Af=0;gn.textFeatureIndex?Yh=gn.textFeatureIndex:Hr.useRuntimeCollisionCircles&&(Yh=Hr.featureIndex),gn.verticalTextFeatureIndex&&(lh=gn.verticalTextFeatureIndex);const zu=gn.textBox;if(zu){const Ec=lo=>{let no=o.az.horizontal;if(C.allowVerticalPlacement&&!lo&&this.prevPlacement){const Js=this.prevPlacement.placedOrientations[Hr.crossTileID];Js&&(this.placedOrientations[Hr.crossTileID]=Js,no=Js,this.markUsedOrientation(C,no,Hr))}return no},If=(lo,no)=>{if(C.allowVerticalPlacement&&Hr.numVerticalGlyphVertices>0&&gn.verticalTextBox){for(const Js of C.writingModes)if(Js===o.az.vertical?(Io=no(),pl=Io):Io=lo(),Io&&Io.placeable)break}else Io=lo()},Xc=Hr.textAnchorOffsetStartIndex,Yc=Hr.textAnchorOffsetEndIndex;if(Yc===Xc){const lo=(no,Js)=>{const Qs=this.collisionIndex.placeCollisionBox(no,dt,he,_r,re,jt,Lt,z,Ze.predicate,xr,void 0,an);return Qs&&Qs.placeable&&(this.markUsedOrientation(C,Js,Hr),this.placedOrientations[Hr.crossTileID]=Js),Qs};If((()=>lo(zu,o.az.horizontal)),(()=>{const no=gn.verticalTextBox;return C.allowVerticalPlacement&&Hr.numVerticalGlyphVertices>0&&no?lo(no,o.az.vertical):{box:null,offscreen:null}})),Ec(Io&&Io.placeable)}else{let lo=o.aP[(yo=(Ra=this.prevPlacement)===null||Ra===void 0?void 0:Ra.variableOffsets[Hr.crossTileID])===null||yo===void 0?void 0:yo.anchor];const no=(Qs,u2,c2)=>{const Hd=Qs.x2-Qs.x1,rC=Qs.y2-Qs.y1,f2=Hr.textBoxScale,R_=Dt&&Nt==="never"?u2:null;let Zh=null,Kh=dt==="never"?1:2,Jh="never";lo&&Kh++;for(let M_=0;M_<Kh;M_++){for(let D_=Xc;D_<Yc;D_++){const $y=C.textAnchorOffsets.get(D_);if(lo&&$y.textAnchor!==lo)continue;const qy=this.attemptAnchorPlacement($y,Qs,Hd,rC,f2,Lt,jt,he,_r,re,Ze,Jh,Hr,C,c2,z,Y,R_,xr);if(qy&&(Zh=qy.placedGlyphBoxes,Zh&&Zh.placeable))return to=!0,Xo=qy.shift,Zh}lo?lo=null:Jh=dt}return w&&!Zh&&(Zh={box:this.collisionIndex.placeCollisionBox(zu,"always",he,_r,re,jt,Lt,z,Ze.predicate,xr,void 0,an).box,offscreen:!1,placeable:!1,occluded:!1}),Zh};If((()=>no(zu,gn.iconBox,o.az.horizontal)),(()=>{const Qs=gn.verticalTextBox;return C.allowVerticalPlacement&&(!Io||!Io.placeable)&&Hr.numVerticalGlyphVertices>0&&Qs?no(Qs,gn.verticalIconBox,o.az.vertical):{box:null,occluded:!0,offscreen:null}})),Io&&(to=Io.placeable,ro=Io.offscreen);const Js=Ec(Io&&Io.placeable);if(!to&&this.prevPlacement){const Qs=this.prevPlacement.variableOffsets[Hr.crossTileID];Qs&&(this.variableOffsets[Hr.crossTileID]=Qs,this.markUsedJustification(C,Qs.anchor,Hr,Js))}}}if(vs=Io,to=vs&&vs.placeable,ro=vs&&vs.offscreen,Hr.useRuntimeCollisionCircles&&Hr.centerJustifiedTextSymbolIndex>=0){const Ec=C.text.placedSymbolArray.get(Hr.centerJustifiedTextSymbolIndex),If=o.aA(C.textSizeData,Ue,Ec),Xc=L.get("text-padding");as=this.collisionIndex.placeCollisionCircles(dt,Ec,C.lineVertexArray,C.glyphOffsetArray,If,re,le,w,jt,Ze.predicate,Hr.collisionCircleDiameter,Xc,z,xr),as.circles.length&&as.collisionDetected&&!w&&o.w("Collisions detected, but collision boxes are not shown"),to=xt||as.circles.length>0&&!as.collisionDetected,ro=ro&&as.offscreen}if(gn.iconFeatureIndex&&(Af=gn.iconFeatureIndex),gn.iconBox){const Ec=If=>this.collisionIndex.placeCollisionBox(If,Nt,he,_r,re,jt,Lt,Y,Ze.predicate,xr,Dt&&Xo?Xo:void 0,an);pl&&pl.placeable&&gn.verticalIconBox?(Ml=Ec(gn.verticalIconBox),Ao=Ml.placeable):(Ml=Ec(gn.iconBox),Ao=Ml.placeable),ro=ro&&Ml.offscreen}const $d=ht||Hr.numHorizontalGlyphVertices===0&&Hr.numVerticalGlyphVertices===0,em=pt||Hr.numIconVertices===0;$d||em?em?$d||(Ao=Ao&&to):to=Ao&&to:Ao=to=Ao&&to;const qd=Ao&&Ml.placeable;if(to&&vs.placeable&&this.collisionIndex.insertCollisionBox(vs.box,dt,L.get("text-ignore-placement"),C.bucketInstanceId,pl&&pl.placeable&&lh?lh:Yh,Ze.ID),qd&&this.collisionIndex.insertCollisionBox(Ml.box,Nt,L.get("icon-ignore-placement"),C.bucketInstanceId,Af,Ze.ID),as&&to&&this.collisionIndex.insertCollisionCircles(as.circles,dt,L.get("text-ignore-placement"),C.bucketInstanceId,Yh,Ze.ID),w&&this.storeCollisionData(C.bucketInstanceId,Ti,gn,vs,Ml,as),Hr.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");if(C.bucketInstanceId===0)throw new Error("bucket.bucketInstanceId can't be 0");this.placements[Hr.crossTileID]=new oo((to||Sr)&&!vs?.occluded,(Ao||pr)&&!Ml?.occluded,ro||C.justReloaded),g[Hr.crossTileID]=!0};if(Zt){if(u.symbolInstanceStart!==0)throw new Error("bucket.bucketInstanceId should be 0");const Hr=C.getSortedSymbolIndexes(-this.transform.bearingInRadians);for(let gn=Hr.length-1;gn>=0;--gn){const Ti=Hr[gn];ln(C.symbolInstances.get(Ti),C.collisionArrays[Ti],Ti)}}else for(let Hr=u.symbolInstanceStart;Hr<u.symbolInstanceEnd;Hr++)ln(C.symbolInstances.get(Hr),C.collisionArrays[Hr],Hr);C.justReloaded=!1}storeCollisionData(u,g,w,C,L,z){if(w.textBox||w.iconBox){let Y,re;this.collisionBoxArrays.has(u)?Y=this.collisionBoxArrays.get(u):(Y=new Map,this.collisionBoxArrays.set(u,Y)),Y.has(g)?re=Y.get(g):(re={text:null,icon:null},Y.set(g,re)),w.textBox&&(re.text=C.box),w.iconBox&&(re.icon=L.box)}if(z){let Y=this.collisionCircleArrays[u];Y===void 0&&(Y=this.collisionCircleArrays[u]=[]);for(let re=0;re<z.circles.length;re+=4)Y.push(z.circles[re+0]-_a),Y.push(z.circles[re+1]-_a),Y.push(z.circles[re+2]),Y.push(z.collisionDetected?1:0)}}markUsedJustification(u,g,w,C){let L;L=C===o.az.vertical?w.verticalPlacedTextSymbolIndex:{left:w.leftJustifiedTextSymbolIndex,center:w.centerJustifiedTextSymbolIndex,right:w.rightJustifiedTextSymbolIndex}[o.aR(g)];const z=[w.leftJustifiedTextSymbolIndex,w.centerJustifiedTextSymbolIndex,w.rightJustifiedTextSymbolIndex,w.verticalPlacedTextSymbolIndex];for(const Y of z)Y>=0&&(u.text.placedSymbolArray.get(Y).crossTileID=L>=0&&Y!==L?0:w.crossTileID)}markUsedOrientation(u,g,w){const C=g===o.az.horizontal||g===o.az.horizontalOnly?g:0,L=g===o.az.vertical?g:0,z=[w.leftJustifiedTextSymbolIndex,w.centerJustifiedTextSymbolIndex,w.rightJustifiedTextSymbolIndex];for(const Y of z)u.text.placedSymbolArray.get(Y).placedOrientation=C;w.verticalPlacedTextSymbolIndex&&(u.text.placedSymbolArray.get(w.verticalPlacedTextSymbolIndex).placedOrientation=L)}commit(u){this.commitTime=u,this.zoomAtLastRecencyCheck=this.transform.zoom;const g=this.prevPlacement;let w=!1;this.prevZoomAdjustment=g?g.zoomAdjustment(this.transform.zoom):0;const C=g?g.symbolFadeChange(u):1,L=g?g.opacities:{},z=g?g.variableOffsets:{},Y=g?g.placedOrientations:{};for(const re in this.placements){const le=this.placements[re],he=L[re];he?(this.opacities[re]=new ts(he,C,le.text,le.icon),w=w||le.text!==he.text.placed||le.icon!==he.icon.placed):(this.opacities[re]=new ts(null,C,le.text,le.icon,le.skipFade),w=w||le.text||le.icon)}for(const re in L){const le=L[re];if(!this.opacities[re]){const he=new ts(le,C,!1,!1);he.isHidden()||(this.opacities[re]=he,w=w||le.text.placed||le.icon.placed)}}for(const re in z)this.variableOffsets[re]||!this.opacities[re]||this.opacities[re].isHidden()||(this.variableOffsets[re]=z[re]);for(const re in Y)this.placedOrientations[re]||!this.opacities[re]||this.opacities[re].isHidden()||(this.placedOrientations[re]=Y[re]);if(g&&g.lastPlacementChangeTime===void 0)throw new Error("Last placement time for previous placement is not defined");w?this.lastPlacementChangeTime=u:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=g?g.lastPlacementChangeTime:u)}updateLayerOpacities(u,g){const w={};for(const C of g){const L=C.getBucket(u);L&&C.latestFeatureIndex&&u.id===L.layerIds[0]&&this.updateBucketOpacities(L,C.tileID,w,C.collisionBoxArray)}}updateBucketOpacities(u,g,w,C){u.hasTextData()&&(u.text.opacityVertexArray.clear(),u.text.hasVisibleVertices=!1),u.hasIconData()&&(u.icon.opacityVertexArray.clear(),u.icon.hasVisibleVertices=!1),u.hasIconCollisionBoxData()&&u.iconCollisionBox.collisionVertexArray.clear(),u.hasTextCollisionBoxData()&&u.textCollisionBox.collisionVertexArray.clear();const L=u.layers[0],z=L.layout,Y=new ts(null,0,!1,!1,!0),re=z.get("text-allow-overlap"),le=z.get("icon-allow-overlap"),he=L._unevaluatedLayout.hasValue("text-variable-anchor")||L._unevaluatedLayout.hasValue("text-variable-anchor-offset"),Pe=z.get("text-rotation-alignment")==="map",Ae=z.get("text-pitch-alignment")==="map",Ue=z.get("icon-text-fit")!=="none",Ze=new ts(null,0,re&&(le||!u.hasIconData()||z.get("icon-optional")),le&&(re||!u.hasTextData()||z.get("text-optional")),!0);!u.collisionArrays&&C&&(u.hasIconCollisionBoxData()||u.hasTextCollisionBoxData())&&u.deserializeCollisionBoxes(C);const ht=(dt,xt,Nt)=>{for(let wt=0;wt<xt/4;wt++)dt.opacityVertexArray.emplaceBack(Nt);dt.hasVisibleVertices=dt.hasVisibleVertices||Nt!==tn},pt=this.collisionBoxArrays.get(u.bucketInstanceId);for(let dt=0;dt<u.symbolInstances.length;dt++){const xt=u.symbolInstances.get(dt),{numHorizontalGlyphVertices:Nt,numVerticalGlyphVertices:wt,crossTileID:Lt}=xt;let jt=this.opacities[Lt];w[Lt]?jt=Y:jt||(jt=Ze,this.opacities[Lt]=jt),w[Lt]=!0;const Dt=xt.numIconVertices>0,Zt=this.placedOrientations[xt.crossTileID],Sr=Zt===o.az.vertical,pr=Zt===o.az.horizontal||Zt===o.az.horizontalOnly;if(Nt>0||wt>0){const xr=Yr(jt.text);ht(u.text,Nt,Sr?tn:xr),ht(u.text,wt,pr?tn:xr);const an=jt.text.isHidden();[xt.rightJustifiedTextSymbolIndex,xt.centerJustifiedTextSymbolIndex,xt.leftJustifiedTextSymbolIndex].forEach((gn=>{gn>=0&&(u.text.placedSymbolArray.get(gn).hidden=an||Sr?1:0)})),xt.verticalPlacedTextSymbolIndex>=0&&(u.text.placedSymbolArray.get(xt.verticalPlacedTextSymbolIndex).hidden=an||pr?1:0);const ln=this.variableOffsets[xt.crossTileID];ln&&this.markUsedJustification(u,ln.anchor,xt,Zt);const Hr=this.placedOrientations[xt.crossTileID];Hr&&(this.markUsedJustification(u,"left",xt,Hr),this.markUsedOrientation(u,Hr,xt))}if(Dt){const xr=Yr(jt.icon),an=!(Ue&&xt.verticalPlacedIconSymbolIndex&&Sr);xt.placedIconSymbolIndex>=0&&(ht(u.icon,xt.numIconVertices,an?xr:tn),u.icon.placedSymbolArray.get(xt.placedIconSymbolIndex).hidden=jt.icon.isHidden()),xt.verticalPlacedIconSymbolIndex>=0&&(ht(u.icon,xt.numVerticalIconVertices,an?tn:xr),u.icon.placedSymbolArray.get(xt.verticalPlacedIconSymbolIndex).hidden=jt.icon.isHidden())}const _r=pt&&pt.has(dt)?pt.get(dt):{text:null,icon:null};if(u.hasIconCollisionBoxData()||u.hasTextCollisionBoxData()){const xr=u.collisionArrays[dt];if(xr){let an=new o.P(0,0);if(xr.textBox||xr.verticalTextBox){let ln=!0;if(he){const Hr=this.variableOffsets[Lt];Hr?(an=Us(Hr.anchor,Hr.width,Hr.height,Hr.textOffset,Hr.textBoxScale),Pe&&an._rotate(Ae?-this.transform.bearingInRadians:this.transform.bearingInRadians)):ln=!1}if(xr.textBox||xr.verticalTextBox){let Hr;xr.textBox&&(Hr=Sr),xr.verticalTextBox&&(Hr=pr),Pu(u.textCollisionBox.collisionVertexArray,jt.text.placed,!ln||Hr,_r.text,an.x,an.y)}}if(xr.iconBox||xr.verticalIconBox){const ln=!!(!pr&&xr.verticalIconBox);let Hr;xr.iconBox&&(Hr=ln),xr.verticalIconBox&&(Hr=!ln),Pu(u.iconCollisionBox.collisionVertexArray,jt.icon.placed,Hr,_r.icon,Ue?an.x:0,Ue?an.y:0)}}}}if(u.sortFeatures(-this.transform.bearingInRadians),this.retainedQueryData[u.bucketInstanceId]&&(this.retainedQueryData[u.bucketInstanceId].featureSortOrder=u.featureSortOrder),u.hasTextData()&&u.text.opacityVertexBuffer&&u.text.opacityVertexBuffer.updateData(u.text.opacityVertexArray),u.hasIconData()&&u.icon.opacityVertexBuffer&&u.icon.opacityVertexBuffer.updateData(u.icon.opacityVertexArray),u.hasIconCollisionBoxData()&&u.iconCollisionBox.collisionVertexBuffer&&u.iconCollisionBox.collisionVertexBuffer.updateData(u.iconCollisionBox.collisionVertexArray),u.hasTextCollisionBoxData()&&u.textCollisionBox.collisionVertexBuffer&&u.textCollisionBox.collisionVertexBuffer.updateData(u.textCollisionBox.collisionVertexArray),u.text.opacityVertexArray.length!==u.text.layoutVertexArray.length/4)throw new Error(`bucket.text.opacityVertexArray.length (= ${u.text.opacityVertexArray.length}) !== bucket.text.layoutVertexArray.length (= ${u.text.layoutVertexArray.length}) / 4`);if(u.icon.opacityVertexArray.length!==u.icon.layoutVertexArray.length/4)throw new Error(`bucket.icon.opacityVertexArray.length (= ${u.icon.opacityVertexArray.length}) !== bucket.icon.layoutVertexArray.length (= ${u.icon.layoutVertexArray.length}) / 4`);u.bucketInstanceId in this.collisionCircleArrays&&(u.collisionCircleArray=this.collisionCircleArrays[u.bucketInstanceId],delete this.collisionCircleArrays[u.bucketInstanceId])}symbolFadeChange(u){return this.fadeDuration===0?1:(u-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(u){return Math.max(0,(this.transform.zoom-u)/1.5)}hasTransitions(u){return this.stale||u-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(u,g){const w=this.zoomAtLastRecencyCheck===g?1-this.zoomAdjustment(g):1;return this.zoomAtLastRecencyCheck=g,this.commitTime+this.fadeDuration*w>u}setStale(){this.stale=!0}}function Pu(D,u,g,w,C,L){w&&w.length!==0||(w=[0,0,0,0]);const z=w[0]-_a,Y=w[1]-_a,re=w[2]-_a,le=w[3]-_a;D.emplaceBack(u?1:0,g?1:0,C||0,L||0,z,Y),D.emplaceBack(u?1:0,g?1:0,C||0,L||0,re,Y),D.emplaceBack(u?1:0,g?1:0,C||0,L||0,re,le),D.emplaceBack(u?1:0,g?1:0,C||0,L||0,z,le)}const ee=Math.pow(2,25),pe=Math.pow(2,24),Ke=Math.pow(2,17),It=Math.pow(2,16),Vt=Math.pow(2,9),qt=Math.pow(2,8),er=Math.pow(2,1);function Yr(D){if(D.opacity===0&&!D.placed)return 0;if(D.opacity===1&&D.placed)return 4294967295;const u=D.placed?1:0,g=Math.floor(127*D.opacity);return g*ee+u*pe+g*Ke+u*It+g*Vt+u*qt+g*er+u}const tn=0;class Gr{constructor(u){this._sortAcrossTiles=u.layout.get("symbol-z-order")!=="viewport-y"&&!u.layout.get("symbol-sort-key").isConstant(),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(u,g,w,C,L){const z=this._bucketParts;for(;this._currentTileIndex<u.length;)if(g.getBucketParts(z,C,u[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,L())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,z.sort(((Y,re)=>Y.sortKey-re.sortKey)));this._currentPartIndex<z.length;)if(g.placeLayerBucketPart(z[this._currentPartIndex],this._seenCrossTileIDs,w),this._currentPartIndex++,L())return!0;return!1}}class on{constructor(u,g,w,C,L,z,Y,re){this.placement=new $c(u,g,z,Y,re),this._currentPlacementIndex=w.length-1,this._forceFullPlacement=C,this._showCollisionBoxes=L,this._done=!1}isDone(){return this._done}continuePlacement(u,g,w){const C=T(),L=()=>!this._forceFullPlacement&&T()-C>2;for(;this._currentPlacementIndex>=0;){const z=g[u[this._currentPlacementIndex]],Y=this.placement.collisionIndex.transform.zoom;if(z.type==="symbol"&&(!z.minzoom||z.minzoom<=Y)&&(!z.maxzoom||z.maxzoom>Y)){if(this._inProgressLayer||(this._inProgressLayer=new Gr(z)),this._inProgressLayer.continuePlacement(w[z.source],this.placement,this._showCollisionBoxes,z,L))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(u){return this.placement.commit(u),this.placement}}const kr=512/o.a5/2;class ti{constructor(u,g,w){this.tileID=u,this.bucketInstanceId=w,this._symbolsByKey={};const C=new Map;for(let L=0;L<g.length;L++){const z=g.get(L),Y=z.key,re=C.get(Y);re?re.push(z):C.set(Y,[z])}for(const[L,z]of C){const Y={positions:z.map((re=>({x:Math.floor(re.anchorX*kr),y:Math.floor(re.anchorY*kr)}))),crossTileIDs:z.map((re=>re.crossTileID))};if(Y.positions.length>128){const re=new o.aT(Y.positions.length,16,Uint16Array);for(const{x:le,y:he}of Y.positions)re.add(le,he);re.finish(),delete Y.positions,Y.index=re}this._symbolsByKey[L]=Y}}getScaledCoordinates(u,g){const{x:w,y:C,z:L}=this.tileID.canonical,{x:z,y:Y,z:re}=g.canonical,le=kr/Math.pow(2,re-L),he=(Y*o.a5+u.anchorY)*le,Pe=C*o.a5*kr;return{x:Math.floor((z*o.a5+u.anchorX)*le-w*o.a5*kr),y:Math.floor(he-Pe)}}findMatches(u,g,w){const C=this.tileID.canonical.z<g.canonical.z?1:Math.pow(2,this.tileID.canonical.z-g.canonical.z);for(let L=0;L<u.length;L++){const z=u.get(L);if(z.crossTileID)continue;const Y=this._symbolsByKey[z.key];if(!Y)continue;const re=this.getScaledCoordinates(z,g);if(Y.index){const le=Y.index.range(re.x-C,re.y-C,re.x+C,re.y+C).sort();for(const he of le){const Pe=Y.crossTileIDs[he];if(!w[Pe]){w[Pe]=!0,z.crossTileID=Pe;break}}}else if(Y.positions)for(let le=0;le<Y.positions.length;le++){const he=Y.positions[le],Pe=Y.crossTileIDs[le];if(Math.abs(he.x-re.x)<=C&&Math.abs(he.y-re.y)<=C&&!w[Pe]){w[Pe]=!0,z.crossTileID=Pe;break}}}}getCrossTileIDsLists(){return Object.values(this._symbolsByKey).map((({crossTileIDs:u})=>u))}}class Ri{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class $n{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(u){const g=Math.round((u-this.lng)/360);if(g!==0)for(const w in this.indexes){const C=this.indexes[w],L={};for(const z in C){const Y=C[z];Y.tileID=Y.tileID.unwrapTo(Y.tileID.wrap+g),L[Y.tileID.key]=Y}this.indexes[w]=L}this.lng=u}addBucket(u,g,w){if(this.indexes[u.overscaledZ]&&this.indexes[u.overscaledZ][u.key]){if(this.indexes[u.overscaledZ][u.key].bucketInstanceId===g.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(u.overscaledZ,this.indexes[u.overscaledZ][u.key])}for(let L=0;L<g.symbolInstances.length;L++)g.symbolInstances.get(L).crossTileID=0;this.usedCrossTileIDs[u.overscaledZ]||(this.usedCrossTileIDs[u.overscaledZ]={});const C=this.usedCrossTileIDs[u.overscaledZ];for(const L in this.indexes){const z=this.indexes[L];if(Number(L)>u.overscaledZ)for(const Y in z){const re=z[Y];re.tileID.isChildOf(u)&&re.findMatches(g.symbolInstances,u,C)}else{const Y=z[u.scaledTo(Number(L)).key];Y&&Y.findMatches(g.symbolInstances,u,C)}}for(let L=0;L<g.symbolInstances.length;L++){const z=g.symbolInstances.get(L);z.crossTileID||(z.crossTileID=w.generate(),C[z.crossTileID]=!0)}return this.indexes[u.overscaledZ]===void 0&&(this.indexes[u.overscaledZ]={}),this.indexes[u.overscaledZ][u.key]=new ti(u,g.symbolInstances,g.bucketInstanceId),!0}removeBucketCrossTileIDs(u,g){for(const w of g.getCrossTileIDsLists())for(const C of w)delete this.usedCrossTileIDs[u][C]}removeStaleBuckets(u){let g=!1;for(const w in this.indexes){const C=this.indexes[w];for(const L in C)u[C[L].bucketInstanceId]||(this.removeBucketCrossTileIDs(w,C[L]),delete C[L],g=!0)}return g}}class _n{constructor(){this.layerIndexes={},this.crossTileIDs=new Ri,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(u,g,w){let C=this.layerIndexes[u.id];C===void 0&&(C=this.layerIndexes[u.id]=new $n);let L=!1;const z={};C.handleWrapJump(w);for(const Y of g){const re=Y.getBucket(u);re&&u.id===re.layerIds[0]&&(re.bucketInstanceId||(re.bucketInstanceId=++this.maxBucketInstanceId),C.addBucket(Y.tileID,re,this.crossTileIDs)&&(L=!0),z[re.bucketInstanceId]=!0)}return C.removeStaleBuckets(z)&&(L=!0),L}pruneUnusedLayers(u){const g={};u.forEach((w=>{g[w]=!0}));for(const w in this.layerIndexes)g[w]||delete this.layerIndexes[w]}}var Mr="void main() {fragColor=vec4(1.0);}";const hn={prelude:mn(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
out highp vec4 fragColor;`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}mat3 rotationMatrixFromAxisAngle(vec3 u,float angle) {float c=cos(angle);float s=sin(angle);float c2=1.0-c;return mat3(u.x*u.x*c2+      c,u.x*u.y*c2-u.z*s,u.x*u.z*c2+u.y*s,u.y*u.x*c2+u.z*s,u.y*u.y*c2+    c,u.y*u.z*c2-u.x*s,u.z*u.x*c2-u.y*s,u.z*u.y*c2+u.x*s,u.z*u.z*c2+    c
);}
#ifdef TERRAIN3D
uniform sampler2D u_terrain;uniform float u_terrain_dim;uniform mat4 u_terrain_matrix;uniform vec4 u_terrain_unpack;uniform float u_terrain_exaggeration;uniform highp sampler2D u_depth;
#endif
const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitShifts=vec4(1.)/bitSh;highp float unpack(highp vec4 color) {return dot(color,bitShifts);}highp float depthOpacity(vec3 frag) {
#ifdef TERRAIN3D
highp float d=unpack(texture(u_depth,frag.xy*0.5+0.5))+0.0001-frag.z;return 1.0-max(0.0,min(1.0,-d*500.0));
#else
return 1.0;
#endif
}float calculate_visibility(vec4 pos) {
#ifdef TERRAIN3D
vec3 frag=pos.xyz/pos.w;highp float d=depthOpacity(frag);if (d > 0.95) return 1.0;return (d+depthOpacity(frag+vec3(0.0,0.01,0.0)))/2.0;
#else
return 1.0;
#endif
}float ele(vec2 pos) {
#ifdef TERRAIN3D
vec4 rgb=(texture(u_terrain,pos)*255.0)*u_terrain_unpack;return rgb.r+rgb.g+rgb.b-u_terrain_unpack.a;
#else
return 0.0;
#endif
}float get_elevation(vec2 pos) {
#ifdef TERRAIN3D
#ifdef GLOBE
if ((pos.y <-32767.5) || (pos.y > 32766.5)) {return 0.0;}
#endif
vec2 coord=(u_terrain_matrix*vec4(pos,0.0,1.0)).xy*u_terrain_dim+1.0;vec2 f=fract(coord);vec2 c=(floor(coord)+0.5)/(u_terrain_dim+2.0);float d=1.0/(u_terrain_dim+2.0);float tl=ele(c);float tr=ele(c+vec2(d,0.0));float bl=ele(c+vec2(0.0,d));float br=ele(c+vec2(d,d));float elevation=mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);return elevation*u_terrain_exaggeration;
#else
return 0.0;
#endif
}const float PI=3.141592653589793;uniform mat4 u_projection_matrix;`),projectionMercator:mn("","float projectLineThickness(float tileY) {return 1.0;}float projectCircleRadius(float tileY) {return 1.0;}vec4 projectTile(vec2 p) {vec4 result=u_projection_matrix*vec4(p,0.0,1.0);return result;}vec4 projectTile(vec2 p,vec2 rawPos) {vec4 result=u_projection_matrix*vec4(p,0.0,1.0);if (rawPos.y <-32767.5 || rawPos.y > 32766.5) {result.z=-10000000.0;}return result;}vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_projection_matrix*vec4(posInTile,elevation,1.0);}vec4 projectTileFor3D(vec2 posInTile,float elevation) {return projectTileWithElevation(posInTile,elevation);}"),projectionGlobe:mn("",`#define GLOBE_RADIUS 6371008.8
uniform highp vec4 u_projection_tile_mercator_coords;uniform highp vec4 u_projection_clipping_plane;uniform highp float u_projection_transition;uniform mat4 u_projection_fallback_matrix;vec3 globeRotateVector(vec3 vec,vec2 angles) {vec3 axisRight=vec3(vec.z,0.0,-vec.x);vec3 axisUp=cross(axisRight,vec);axisRight=normalize(axisRight);axisUp=normalize(axisUp);vec2 t=tan(angles);return normalize(vec+axisRight*t.x+axisUp*t.y);}mat3 globeGetRotationMatrix(vec3 spherePos) {vec3 axisRight=vec3(spherePos.z,0.0,-spherePos.x);vec3 axisDown=cross(axisRight,spherePos);axisRight=normalize(axisRight);axisDown=normalize(axisDown);return mat3(axisRight,axisDown,spherePos
);}float circumferenceRatioAtTileY(float tileY) {float mercator_pos_y=u_projection_tile_mercator_coords.y+u_projection_tile_mercator_coords.w*tileY;float spherical_y=2.0*atan(exp(PI-(mercator_pos_y*PI*2.0)))-PI*0.5;return cos(spherical_y);}float projectLineThickness(float tileY) {float thickness=1.0/circumferenceRatioAtTileY(tileY); 
if (u_projection_transition < 0.999) {return mix(1.0,thickness,u_projection_transition);} else {return thickness;}}vec3 projectToSphere(vec2 translatedPos,vec2 rawPos) {vec2 mercator_pos=u_projection_tile_mercator_coords.xy+u_projection_tile_mercator_coords.zw*translatedPos;vec2 spherical;spherical.x=mercator_pos.x*PI*2.0+PI;spherical.y=2.0*atan(exp(PI-(mercator_pos.y*PI*2.0)))-PI*0.5;float len=cos(spherical.y);vec3 pos=vec3(sin(spherical.x)*len,sin(spherical.y),cos(spherical.x)*len
);if (rawPos.y <-32767.5) {pos=vec3(0.0,1.0,0.0);}if (rawPos.y > 32766.5) {pos=vec3(0.0,-1.0,0.0);}return pos;}vec3 projectToSphere(vec2 posInTile) {return projectToSphere(posInTile,vec2(0.0,0.0));}float globeComputeClippingZ(vec3 spherePos) {return (1.0-(dot(spherePos,u_projection_clipping_plane.xyz)+u_projection_clipping_plane.w));}vec4 interpolateProjection(vec2 posInTile,vec3 spherePos,float elevation) {vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);vec4 globePosition=u_projection_matrix*vec4(elevatedPos,1.0);globePosition.z=globeComputeClippingZ(elevatedPos)*globePosition.w;if (u_projection_transition > 0.999) {return globePosition;}vec4 flatPosition=u_projection_fallback_matrix*vec4(posInTile,elevation,1.0);const float z_globeness_threshold=0.2;vec4 result=globePosition;result.z=mix(0.0,globePosition.z,clamp((u_projection_transition-z_globeness_threshold)/(1.0-z_globeness_threshold),0.0,1.0));result.xyw=mix(flatPosition.xyw,globePosition.xyw,u_projection_transition);if ((posInTile.y <-32767.5) || (posInTile.y > 32766.5)) {result=globePosition;const float poles_hidden_anim_percentage=0.02;result.z=mix(globePosition.z,100.0,pow(max((1.0-u_projection_transition)/poles_hidden_anim_percentage,0.0),8.0));}return result;}vec4 interpolateProjectionFor3D(vec2 posInTile,vec3 spherePos,float elevation) {vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);vec4 globePosition=u_projection_matrix*vec4(elevatedPos,1.0);if (u_projection_transition > 0.999) {return globePosition;}vec4 fallbackPosition=u_projection_fallback_matrix*vec4(posInTile,elevation,1.0);return mix(fallbackPosition,globePosition,u_projection_transition);}vec4 projectTile(vec2 posInTile) {return interpolateProjection(posInTile,projectToSphere(posInTile),0.0);}vec4 projectTile(vec2 posInTile,vec2 rawPos) {return interpolateProjection(posInTile,projectToSphere(posInTile,rawPos),0.0);}vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return interpolateProjection(posInTile,projectToSphere(posInTile),elevation);}vec4 projectTileFor3D(vec2 posInTile,float elevation) {vec3 spherePos=projectToSphere(posInTile,posInTile);return interpolateProjectionFor3D(posInTile,spherePos,elevation);}`),background:mn(`uniform vec4 u_color;uniform float u_opacity;void main() {fragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"in vec2 a_pos;void main() {gl_Position=projectTile(a_pos);}"),backgroundPattern:mn(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);fragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;void main() {gl_Position=projectTile(a_pos);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),circle:mn(`in vec3 v_data;in float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);float antialiased_blur=v_data.z;float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));fragColor=v_visibility*opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);const float epsilon=0.5/255.0;if (fragColor.r < epsilon && fragColor.g < epsilon && fragColor.b < epsilon && fragColor.a < epsilon) {discard;}
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform highp float u_globe_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;uniform vec2 u_translate;in vec2 a_pos;out vec3 v_data;out float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 pos_raw=a_pos+32768.0;vec2 extrude=vec2(mod(pos_raw,8.0)/7.0*2.0-1.0);vec2 circle_center=floor(pos_raw/8.0)+u_translate;float ele=get_elevation(circle_center);v_visibility=calculate_visibility(projectTileWithElevation(circle_center,ele));if (u_pitch_with_map) {
#ifdef GLOBE
vec3 center_vector=projectToSphere(circle_center);
#endif
float angle_scale=u_globe_extrude_scale;vec2 corner_position=circle_center;if (u_scale_with_map) {angle_scale*=(radius+stroke_width);corner_position+=extrude*u_extrude_scale*(radius+stroke_width);} else {
#ifdef GLOBE
vec4 projected_center=interpolateProjection(circle_center,center_vector,ele);
#else
vec4 projected_center=projectTileWithElevation(circle_center,ele);
#endif
corner_position+=extrude*u_extrude_scale*(radius+stroke_width)*(projected_center.w/u_camera_to_center_distance);angle_scale*=(radius+stroke_width)*(projected_center.w/u_camera_to_center_distance);}
#ifdef GLOBE
vec2 angles=extrude*angle_scale;vec3 corner_vector=globeRotateVector(center_vector,angles);gl_Position=interpolateProjection(corner_position,corner_vector,ele);
#else
gl_Position=projectTileWithElevation(corner_position,ele);
#endif
} else {gl_Position=projectTileWithElevation(circle_center,ele);if (gl_Position.z/gl_Position.w > 1.0) {gl_Position.xy=vec2(10000.0);}if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}float antialiasblur=-max(1.0/u_device_pixel_ratio/(radius+stroke_width),blur);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),clippingMask:mn(Mr,"in vec2 a_pos;void main() {gl_Position=projectTile(a_pos);}"),heatmap:mn(`uniform highp float u_intensity;in vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);fragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;uniform highp float u_globe_extrude_scale;in vec2 a_pos;out vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 pos_raw=a_pos+32768.0;vec2 unscaled_extrude=vec2(mod(pos_raw,8.0)/7.0*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 circle_center=floor(pos_raw/8.0);
#ifdef GLOBE
vec2 angles=v_extrude*radius*u_globe_extrude_scale;vec3 center_vector=projectToSphere(circle_center);vec3 corner_vector=globeRotateVector(center_vector,angles);gl_Position=interpolateProjection(circle_center+extrude,corner_vector,0.0);
#else
gl_Position=projectTileFor3D(circle_center+extrude,get_elevation(circle_center));
#endif
}`),heatmapTexture:mn(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;in vec2 v_pos;void main() {float t=texture(u_image,v_pos).r;vec4 color=texture(u_color_ramp,vec2(t,0.5));fragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),collisionBox:mn("in float v_placed;in float v_notUsed;void main() {float alpha=0.5;fragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {fragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {fragColor*=.1;}}","in vec2 a_anchor_pos;in vec2 a_placed;in vec2 a_box_real;uniform vec2 u_pixel_extrude_scale;out float v_placed;out float v_notUsed;void main() {gl_Position=projectTileWithElevation(a_anchor_pos,get_elevation(a_anchor_pos));gl_Position.xy=((a_box_real+0.5)*u_pixel_extrude_scale*2.0-1.0)*vec2(1.0,-1.0)*gl_Position.w;if (gl_Position.z/gl_Position.w < 1.1) {gl_Position.z=0.5;}v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:mn("in float v_radius;in vec2 v_extrude;in float v_collision;void main() {float alpha=0.5;float stroke_radius=0.9;float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);fragColor=color*alpha*opacity_t;}","in vec2 a_pos;in float a_radius;in vec2 a_flags;uniform vec2 u_viewport_size;out float v_radius;out vec2 v_extrude;out float v_collision;void main() {float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_collision=collision;gl_Position=vec4((a_pos/u_viewport_size*2.0-1.0)*vec2(1.0,-1.0),0.0,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),colorRelief:mn(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;uniform vec4 u_unpack;uniform sampler2D u_elevation_stops;uniform sampler2D u_color_stops;uniform int u_color_ramp_size;uniform float u_opacity;in vec2 v_pos;float getElevation(vec2 coord) {vec4 data=texture(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack);}float getElevationStop(int stop) {float x=(float(stop)+0.5)/float(u_color_ramp_size);vec4 data=texture(u_elevation_stops,vec2(x,0))*255.0;data.a=-1.0;return dot(data,u_unpack);}void main() {float el=getElevation(v_pos);int r=(u_color_ramp_size-1);int l=0;float el_l=getElevationStop(l);float el_r=getElevationStop(r);while(r-l > 1){int m=(r+l)/2;float el_m=getElevationStop(m);if(el < el_m){r=m;el_r=el_m;}else
{l=m;el_l=el_m;}}float x=(float(l)+(el-el_l)/(el_r-el_l)+0.5)/float(u_color_ramp_size);fragColor=u_opacity*texture(u_color_stops,vec2(x,0));
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform vec2 u_dimension;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=projectTile(a_pos,a_pos);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_pos/8192.0)*scale+epsilon;if (a_pos.y <-32767.5) {v_pos.y=0.0;}if (a_pos.y > 32766.5) {v_pos.y=1.0;}}"),debug:mn("uniform highp vec4 u_color;uniform sampler2D u_overlay;in vec2 v_uv;void main() {vec4 overlay_color=texture(u_overlay,v_uv);fragColor=mix(u_color,overlay_color,overlay_color.a);}","in vec2 a_pos;out vec2 v_uv;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=projectTileWithElevation(a_pos*u_overlay_scale,get_elevation(a_pos));}"),depth:mn(Mr,`in vec2 a_pos;void main() {
#ifdef GLOBE
gl_Position=projectTileFor3D(a_pos,0.0);
#else
gl_Position=u_projection_matrix*vec4(a_pos,0.0,1.0);
#endif
}`),fill:mn(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
fragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_fill_translate;in vec2 a_pos;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=projectTile(a_pos+u_fill_translate,a_pos);}`),fillOutline:mn(`in vec2 v_pos;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);fragColor=outline_color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_world;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=projectTile(a_pos+u_fill_translate,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
}`),fillOutlinePattern:mn(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;in vec2 v_pos_a;in vec2 v_pos_b;in vec2 v_pos;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);fragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;out vec2 v_pos;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=projectTile(a_pos+u_fill_translate,a_pos);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
}`),fillPattern:mn(`#ifdef GL_ES
precision highp float;
#endif
uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);fragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=projectTile(a_pos+u_fill_translate,a_pos);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),fillExtrusion:mn(`in vec4 v_color;void main() {fragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp vec3 u_lightpos_globe;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec2 u_fill_translate;in vec2 a_pos;in vec4 a_normal_ed;
#ifdef TERRAIN3D
in vec2 a_centroid;
#endif
out vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float elevation=t > 0.0 ? height : base;vec2 posInTile=a_pos+u_fill_translate;
#ifdef GLOBE
vec3 spherePos=projectToSphere(posInTile,a_pos);gl_Position=interpolateProjectionFor3D(posInTile,spherePos,elevation);
#else
gl_Position=u_projection_matrix*vec4(posInTile,elevation,1.0);
#endif
float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;vec3 normalForLighting=normal/16384.0;float directional=clamp(dot(normalForLighting,u_lightpos),0.0,1.0);
#ifdef GLOBE
mat3 rotMatrix=globeGetRotationMatrix(spherePos);normalForLighting=rotMatrix*normalForLighting;directional=mix(directional,clamp(dot(normalForLighting,u_lightpos_globe),0.0,1.0),u_projection_transition);
#endif
directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),fillExtrusionPattern:mn(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;in vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);fragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec2 u_fill_translate;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp vec3 u_lightpos_globe;uniform lowp float u_lightintensity;in vec2 a_pos;in vec4 a_normal_ed;
#ifdef TERRAIN3D
in vec2 a_centroid;
#endif
#ifdef GLOBE
out vec3 v_sphere_pos;
#endif
out vec2 v_pos_a;out vec2 v_pos_b;out vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float elevation=t > 0.0 ? height : base;vec2 posInTile=a_pos+u_fill_translate;
#ifdef GLOBE
vec3 spherePos=projectToSphere(posInTile,a_pos);vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);v_sphere_pos=elevatedPos;gl_Position=interpolateProjectionFor3D(posInTile,spherePos,elevation);
#else
gl_Position=u_projection_matrix*vec4(posInTile,elevation,1.0);
#endif
vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,elevation*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),hillshadePrepare:mn(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack);}void main() {vec2 epsilon=1.0/u_dimension;float tileSize=u_dimension.x-2.0;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))*tileSize/pow(2.0,exaggeration+(28.2562-u_zoom));fragColor=clamp(vec4(deriv.x/8.0+0.5,deriv.y/8.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:mn(`uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_latrange;uniform float u_exaggeration;uniform vec4 u_accent;uniform int u_method;uniform float u_altitudes[NUM_ILLUMINATION_SOURCES];uniform float u_azimuths[NUM_ILLUMINATION_SOURCES];uniform vec4 u_shadows[NUM_ILLUMINATION_SOURCES];uniform vec4 u_highlights[NUM_ILLUMINATION_SOURCES];
#define PI 3.141592653589793
#define STANDARD 0
#define COMBINED 1
#define IGOR 2
#define MULTIDIRECTIONAL 3
#define BASIC 4
float get_aspect(vec2 deriv){return deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);}void igor_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;float aspect=get_aspect(deriv);float azimuth=u_azimuths[0]+PI;float slope_stength=atan(length(deriv))*2.0/PI;float aspect_strength=1.0-abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);float shadow_strength=slope_stength*aspect_strength;float highlight_strength=slope_stength*(1.0-aspect_strength);fragColor=u_shadows[0]*shadow_strength+u_highlights[0]*highlight_strength;}void standard_hillshade(vec2 deriv){float azimuth=u_azimuths[0]+PI;float slope=atan(0.625*length(deriv));float aspect=get_aspect(deriv);float intensity=u_exaggeration;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadows[0],u_highlights[0],shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);fragColor=accent_color*(1.0-shade_color.a)+shade_color;}void basic_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;float azimuth=u_azimuths[0]+PI;float cos_az=cos(azimuth);float sin_az=sin(azimuth);float cos_alt=cos(u_altitudes[0]);float sin_alt=sin(u_altitudes[0]);float cang=(sin_alt-(deriv.y*cos_az*cos_alt-deriv.x*sin_az*cos_alt))/sqrt(1.0+dot(deriv,deriv));float shade=clamp(cang,0.0,1.0);if(shade > 0.5){fragColor=u_highlights[0]*(2.0*shade-1.0);}else
{fragColor=u_shadows[0]*(1.0-2.0*shade);}}void multidirectional_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;fragColor=vec4(0,0,0,0);for(int i=0; i < NUM_ILLUMINATION_SOURCES; i++){float cos_alt=cos(u_altitudes[i]);float sin_alt=sin(u_altitudes[i]);float cos_az=-cos(u_azimuths[i]);float sin_az=-sin(u_azimuths[i]);float cang=(sin_alt-(deriv.y*cos_az*cos_alt-deriv.x*sin_az*cos_alt))/sqrt(1.0+dot(deriv,deriv));float shade=clamp(cang,0.0,1.0);if(shade > 0.5){fragColor+=u_highlights[i]*(2.0*shade-1.0)/float(NUM_ILLUMINATION_SOURCES);}else
{fragColor+=u_shadows[i]*(1.0-2.0*shade)/float(NUM_ILLUMINATION_SOURCES);}}}void combined_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;float azimuth=u_azimuths[0]+PI;float cos_az=cos(azimuth);float sin_az=sin(azimuth);float cos_alt=cos(u_altitudes[0]);float sin_alt=sin(u_altitudes[0]);float cang=acos((sin_alt-(deriv.y*cos_az*cos_alt-deriv.x*sin_az*cos_alt))/sqrt(1.0+dot(deriv,deriv)));cang=clamp(cang,0.0,PI/2.0);float shade=cang*atan(length(deriv))*4.0/PI/PI;float highlight=(PI/2.0-cang)*atan(length(deriv))*4.0/PI/PI;fragColor=u_shadows[0]*shade+u_highlights[0]*highlight;}void main() {vec4 pixel=texture(u_image,v_pos);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));vec2 deriv=((pixel.rg*8.0)-4.0)/scaleFactor;if (u_method==BASIC) {basic_hillshade(deriv);} else if (u_method==COMBINED) {combined_hillshade(deriv);} else if (u_method==IGOR) {igor_hillshade(deriv);} else if (u_method==MULTIDIRECTIONAL) {multidirectional_hillshade(deriv);} else if (u_method==STANDARD) {standard_hillshade(deriv);} else {standard_hillshade(deriv);}
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=projectTile(a_pos,a_pos);v_pos=a_pos/8192.0;if (a_pos.y <-32767.5) {v_pos.y=0.0;}if (a_pos.y > 32766.5) {v_pos.y=1.0;}}"),line:mn(`uniform lowp float u_device_pixel_ratio;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp float v_linesofar;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),lineGradient:mn(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;in highp vec2 v_uv;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture(u_image,v_uv);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
in vec2 a_pos_normal;in vec4 a_data;in float a_uv_x;in float a_split_index;uniform vec2 u_translation;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp vec2 v_uv;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),linePattern:mn(`#ifdef GL_ES
precision highp float;
#endif
uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;in vec2 v_normal;in vec2 v_width2;in float v_linesofar;in float v_gamma_scale;in float v_width;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture(u_image,pos_a),texture(u_image,pos_b),u_fade);fragColor=color*alpha*opacity;
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;out vec2 v_normal;out vec2 v_width2;out float v_linesofar;out float v_gamma_scale;out float v_width;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),lineSDF:mn(`uniform lowp float u_device_pixel_ratio;uniform lowp float u_lineatlas_width;uniform sampler2D u_image;uniform float u_mix;in vec2 v_normal;in vec2 v_width2;in vec2 v_tex_a;in vec2 v_tex_b;in float v_gamma_scale;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define mediump vec4 dasharray_from
#pragma mapbox: define mediump vec4 dasharray_to
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 dasharray_from
#pragma mapbox: initialize mediump vec4 dasharray_to
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture(u_image,v_tex_a).a;float sdfdist_b=texture(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);float sdfgamma=(u_lineatlas_width/256.0/u_device_pixel_ratio)/min(dasharray_from.w,dasharray_to.w);alpha*=smoothstep(0.5-sdfgamma/floorwidth,0.5+sdfgamma/floorwidth,sdfdist);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_tileratio;uniform float u_crossfade_from;uniform float u_crossfade_to;uniform float u_lineatlas_height;out vec2 v_normal;out vec2 v_width2;out vec2 v_tex_a;out vec2 v_tex_b;out float v_gamma_scale;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define mediump vec4 dasharray_from
#pragma mapbox: define mediump vec4 dasharray_to
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 dasharray_from
#pragma mapbox: initialize mediump vec4 dasharray_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
float u_patternscale_a_x=u_tileratio/dasharray_from.w/u_crossfade_from;float u_patternscale_a_y=-dasharray_from.z/2.0/u_lineatlas_height;float u_patternscale_b_x=u_tileratio/dasharray_to.w/u_crossfade_to;float u_patternscale_b_y=-dasharray_to.z/2.0/u_lineatlas_height;v_tex_a=vec2(a_linesofar*u_patternscale_a_x/floorwidth,normal.y*u_patternscale_a_y+(float(dasharray_from.y)+0.5)/u_lineatlas_height);v_tex_b=vec2(a_linesofar*u_patternscale_b_x/floorwidth,normal.y*u_patternscale_b_y+(float(dasharray_to.y)+0.5)/u_lineatlas_height);v_width2=vec2(outset,inset);}`),lineGradientSDF:mn(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform sampler2D u_image_dash;uniform float u_mix;uniform lowp float u_lineatlas_width;in vec2 v_normal;in vec2 v_width2;in vec2 v_tex_a;in vec2 v_tex_b;in float v_gamma_scale;in highp vec2 v_uv;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define mediump vec4 dasharray_from
#pragma mapbox: define mediump vec4 dasharray_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 dasharray_from
#pragma mapbox: initialize mediump vec4 dasharray_to
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture(u_image,v_uv);float sdfdist_a=texture(u_image_dash,v_tex_a).a;float sdfdist_b=texture(u_image_dash,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);float sdfgamma=(u_lineatlas_width/256.0)/min(dasharray_from.w,dasharray_to.w);float dash_alpha=smoothstep(0.5-sdfgamma/floorwidth,0.5+sdfgamma/floorwidth,sdfdist);fragColor=color*(alpha*dash_alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
in vec2 a_pos_normal;in vec4 a_data;in float a_uv_x;in float a_split_index;uniform vec2 u_translation;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;uniform float u_tileratio;uniform float u_crossfade_from;uniform float u_crossfade_to;uniform float u_lineatlas_height;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp vec2 v_uv;out vec2 v_tex_a;out vec2 v_tex_b;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define mediump vec4 dasharray_from
#pragma mapbox: define mediump vec4 dasharray_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 dasharray_from
#pragma mapbox: initialize mediump vec4 dasharray_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;float texel_height=1.0/u_image_height;float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
float u_patternscale_a_x=u_tileratio/dasharray_from.w/u_crossfade_from;float u_patternscale_a_y=-dasharray_from.z/2.0/u_lineatlas_height;float u_patternscale_b_x=u_tileratio/dasharray_to.w/u_crossfade_to;float u_patternscale_b_y=-dasharray_to.z/2.0/u_lineatlas_height;v_tex_a=vec2(a_linesofar*u_patternscale_a_x/floorwidth,normal.y*u_patternscale_a_y+(float(dasharray_from.y)+0.5)/u_lineatlas_height);v_tex_b=vec2(a_linesofar*u_patternscale_b_x/floorwidth,normal.y*u_patternscale_b_y+(float(dasharray_to.y)+0.5)/u_lineatlas_height);v_width2=vec2(outset,inset);}`),raster:mn(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;in vec2 v_pos0;in vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture(u_image0,v_pos0);vec4 color1=texture(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);fragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;uniform vec4 u_coords_top;uniform vec4 u_coords_bottom;in vec2 a_pos;out vec2 v_pos0;out vec2 v_pos1;void main() {vec2 fractionalPos=a_pos/8192.0;vec2 position=mix(mix(u_coords_top.xy,u_coords_top.zw,fractionalPos.x),mix(u_coords_bottom.xy,u_coords_bottom.zw,fractionalPos.x),fractionalPos.y);gl_Position=projectTile(position,position);v_pos0=((fractionalPos-0.5)/u_buffer_scale)+0.5;
#ifdef GLOBE
if (a_pos.y <-32767.5) {v_pos0.y=0.0;}if (a_pos.y > 32766.5) {v_pos0.y=1.0;}
#endif
v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}`),symbolIcon:mn(`uniform sampler2D u_texture;in vec2 v_tex;in float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;fragColor=texture(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec4 a_pixeloffset;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;out vec2 v_tex;out float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}gl_Position=finalPos;v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float visibility=calculate_visibility(projectedPoint);v_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));}`),symbolSDF:mn(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;in vec2 v_data0;in vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float inner_edge=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);inner_edge=inner_edge+gamma*gamma_scale;}lowp float dist=texture(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(inner_edge-gamma_scaled,inner_edge+gamma_scaled,dist);if (u_is_halo) {lowp float halo_edge=(6.0-halo_width/fontScale)/SDF_PX;alpha=min(smoothstep(halo_edge-gamma_scaled,halo_edge+gamma_scaled,dist),1.0-alpha);}fragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec4 a_pixeloffset;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_translation;uniform float u_pitched_scale;out vec2 v_data0;out vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),symbolTextAndIcon:mn(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;in vec4 v_data0;in vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;fragColor=texture(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);fragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;out vec4 v_data0;out vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map && !u_is_along_line) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`),terrain:mn("uniform sampler2D u_texture;uniform vec4 u_fog_color;uniform vec4 u_horizon_color;uniform float u_fog_ground_blend;uniform float u_fog_ground_blend_opacity;uniform float u_horizon_fog_blend;uniform bool u_is_globe_mode;in vec2 v_texture_pos;in float v_fog_depth;const float gamma=2.2;vec4 gammaToLinear(vec4 color) {return pow(color,vec4(gamma));}vec4 linearToGamma(vec4 color) {return pow(color,vec4(1.0/gamma));}void main() {vec4 surface_color=texture(u_texture,vec2(v_texture_pos.x,1.0-v_texture_pos.y));if (!u_is_globe_mode && v_fog_depth > u_fog_ground_blend) {vec4 surface_color_linear=gammaToLinear(surface_color);float blend_color=smoothstep(0.0,1.0,max((v_fog_depth-u_horizon_fog_blend)/(1.0-u_horizon_fog_blend),0.0));vec4 fog_horizon_color_linear=mix(gammaToLinear(u_fog_color),gammaToLinear(u_horizon_color),blend_color);float factor_fog=max(v_fog_depth-u_fog_ground_blend,0.0)/(1.0-u_fog_ground_blend);fragColor=linearToGamma(mix(surface_color_linear,fog_horizon_color_linear,pow(factor_fog,2.0)*u_fog_ground_blend_opacity));} else {fragColor=surface_color;}}","in vec3 a_pos3d;uniform mat4 u_fog_matrix;uniform float u_ele_delta;out vec2 v_texture_pos;out float v_fog_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=projectTileFor3D(a_pos3d.xy,get_elevation(a_pos3d.xy)-ele_delta);vec4 pos=u_fog_matrix*vec4(a_pos3d.xy,ele,1.0);v_fog_depth=pos.z/pos.w*0.5+0.5;}"),terrainDepth:mn("in float v_depth;const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitMsk=vec4(0.,vec3(1./256.0));highp vec4 pack(highp float value) {highp vec4 comp=fract(value*bitSh);comp-=comp.xxyz*bitMsk;return comp;}void main() {fragColor=pack(v_depth);}","in vec3 a_pos3d;uniform float u_ele_delta;out float v_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;gl_Position=projectTileFor3D(a_pos3d.xy,ele-ele_delta);v_depth=gl_Position.z/gl_Position.w;}"),terrainCoords:mn("precision mediump float;uniform sampler2D u_texture;uniform float u_terrain_coords_id;in vec2 v_texture_pos;void main() {vec4 rgba=texture(u_texture,v_texture_pos);fragColor=vec4(rgba.r,rgba.g,rgba.b,u_terrain_coords_id);}","in vec3 a_pos3d;uniform float u_ele_delta;out vec2 v_texture_pos;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=projectTileFor3D(a_pos3d.xy,ele-ele_delta);}"),projectionErrorMeasurement:mn("in vec4 v_output_error_encoded;void main() {fragColor=v_output_error_encoded;}","in vec2 a_pos;uniform highp float u_input;uniform highp float u_output_expected;out vec4 v_output_error_encoded;void main() {float real_output=2.0*atan(exp(PI-(u_input*PI*2.0)))-PI*0.5;float error=real_output-u_output_expected;float abs_error=abs(error)*128.0;v_output_error_encoded.x=min(floor(abs_error*256.0),255.0)/255.0;abs_error-=v_output_error_encoded.x;v_output_error_encoded.y=min(floor(abs_error*65536.0),255.0)/255.0;abs_error-=v_output_error_encoded.x/255.0;v_output_error_encoded.z=min(floor(abs_error*16777216.0),255.0)/255.0;v_output_error_encoded.w=error >=0.0 ? 1.0 : 0.0;gl_Position=vec4(a_pos,0.0,1.0);}"),atmosphere:mn(`#ifdef GL_ES
precision highp float;
#endif
in vec3 view_direction;uniform vec3 u_sun_pos;uniform vec3 u_globe_position;uniform float u_globe_radius;uniform float u_atmosphere_blend;/**Shader use from https:*Made some change to adapt to MapLibre Globe geometry*/const float PI=3.141592653589793;const int iSteps=5;const int jSteps=3;/*radius of the planet*/const float EARTH_RADIUS=6371e3;/*radius of the atmosphere*/const float ATMOS_RADIUS=6471e3;vec2 rsi(vec3 r0,vec3 rd,float sr) {float a=dot(rd,rd);float b=2.0*dot(rd,r0);float c=dot(r0,r0)-(sr*sr);float d=(b*b)-4.0*a*c;if (d < 0.0) return vec2(1e5,-1e5);return vec2((-b-sqrt(d))/(2.0*a),(-b+sqrt(d))/(2.0*a));}vec4 atmosphere(vec3 r,vec3 r0,vec3 pSun,float iSun,float rPlanet,float rAtmos,vec3 kRlh,float kMie,float shRlh,float shMie,float g) {pSun=normalize(pSun);r=normalize(r);vec2 p=rsi(r0,r,rAtmos);if (p.x > p.y) {return vec4(0.0,0.0,0.0,1.0);}if (p.x < 0.0) {p.x=0.0;}vec3 pos=r0+r*p.x;vec2 p2=rsi(r0,r,rPlanet);if (p2.x <=p2.y && p2.x > 0.0) {p.y=min(p.y,p2.x);}float iStepSize=(p.y-p.x)/float(iSteps);float iTime=p.x+iStepSize*0.5;vec3 totalRlh=vec3(0,0,0);vec3 totalMie=vec3(0,0,0);float iOdRlh=0.0;float iOdMie=0.0;float mu=dot(r,pSun);float mumu=mu*mu;float gg=g*g;float pRlh=3.0/(16.0*PI)*(1.0+mumu);float pMie=3.0/(8.0*PI)*((1.0-gg)*(mumu+1.0))/(pow(1.0+gg-2.0*mu*g,1.5)*(2.0+gg));for (int i=0; i < iSteps; i++) {vec3 iPos=r0+r*iTime;float iHeight=length(iPos)-rPlanet;float odStepRlh=exp(-iHeight/shRlh)*iStepSize;float odStepMie=exp(-iHeight/shMie)*iStepSize;iOdRlh+=odStepRlh;iOdMie+=odStepMie;float jStepSize=rsi(iPos,pSun,rAtmos).y/float(jSteps);float jTime=jStepSize*0.5;float jOdRlh=0.0;float jOdMie=0.0;for (int j=0; j < jSteps; j++) {vec3 jPos=iPos+pSun*jTime;float jHeight=length(jPos)-rPlanet;jOdRlh+=exp(-jHeight/shRlh)*jStepSize;jOdMie+=exp(-jHeight/shMie)*jStepSize;jTime+=jStepSize;}vec3 attn=exp(-(kMie*(iOdMie+jOdMie)+kRlh*(iOdRlh+jOdRlh)));totalRlh+=odStepRlh*attn;totalMie+=odStepMie*attn;iTime+=iStepSize;}float opacity=exp(-(length(kRlh)*length(totalRlh)+kMie*length(totalMie)));vec3 color=iSun*(pRlh*kRlh*totalRlh+pMie*kMie*totalMie);return vec4(color,opacity);}void main() {vec3 scale_camera_pos=-u_globe_position*EARTH_RADIUS/u_globe_radius;vec4 color=atmosphere(normalize(view_direction),scale_camera_pos,u_sun_pos,22.0,EARTH_RADIUS,ATMOS_RADIUS,vec3(5.5e-6,13.0e-6,22.4e-6),21e-6,8e3,1.2e3,0.758
);color.rgb=1.0-exp(-1.0*color.rgb);color=pow(color,vec4(1.0/2.2));fragColor=vec4(color.rgb,1.0-color.a)*u_atmosphere_blend;}`,"in vec2 a_pos;uniform mat4 u_inv_proj_matrix;out vec3 view_direction;void main() {view_direction=(u_inv_proj_matrix*vec4(a_pos,0.0,1.0)).xyz;gl_Position=vec4(a_pos,0.0,1.0);}"),sky:mn("uniform vec4 u_sky_color;uniform vec4 u_horizon_color;uniform vec2 u_horizon;uniform vec2 u_horizon_normal;uniform float u_sky_horizon_blend;uniform float u_sky_blend;void main() {float x=gl_FragCoord.x;float y=gl_FragCoord.y;float blend=(y-u_horizon.y)*u_horizon_normal.y+(x-u_horizon.x)*u_horizon_normal.x;if (blend > 0.0) {if (blend < u_sky_horizon_blend) {fragColor=mix(u_sky_color,u_horizon_color,pow(1.0-blend/u_sky_horizon_blend,2.0));} else {fragColor=u_sky_color;}}fragColor=mix(fragColor,vec4(vec3(0.0),0.0),u_sky_blend);}","in vec2 a_pos;void main() {gl_Position=vec4(a_pos,1.0,1.0);}")};function mn(D,u){const g=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,w=u.match(/in ([\w]+) ([\w]+)/g),C=D.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),L=u.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),z=L?L.concat(C):C,Y={};return{fragmentSource:D=D.replace(g,((re,le,he,Pe,Ae)=>(Y[Ae]=!0,le==="define"?`
#ifndef HAS_UNIFORM_u_${Ae}
in ${he} ${Pe} ${Ae};
#else
uniform ${he} ${Pe} u_${Ae};
#endif
`:`
#ifdef HAS_UNIFORM_u_${Ae}
    ${he} ${Pe} ${Ae} = u_${Ae};
#endif
`))),vertexSource:u=u.replace(g,((re,le,he,Pe,Ae)=>{const Ue=Pe==="float"?"vec2":"vec4",Ze=Ae.match(/color/)?"color":Ue;return Y[Ae]?le==="define"?`
#ifndef HAS_UNIFORM_u_${Ae}
uniform lowp float u_${Ae}_t;
in ${he} ${Ue} a_${Ae};
out ${he} ${Pe} ${Ae};
#else
uniform ${he} ${Pe} u_${Ae};
#endif
`:Ze==="vec4"?`
#ifndef HAS_UNIFORM_u_${Ae}
    ${Ae} = a_${Ae};
#else
    ${he} ${Pe} ${Ae} = u_${Ae};
#endif
`:`
#ifndef HAS_UNIFORM_u_${Ae}
    ${Ae} = unpack_mix_${Ze}(a_${Ae}, u_${Ae}_t);
#else
    ${he} ${Pe} ${Ae} = u_${Ae};
#endif
`:le==="define"?`
#ifndef HAS_UNIFORM_u_${Ae}
uniform lowp float u_${Ae}_t;
in ${he} ${Ue} a_${Ae};
#else
uniform ${he} ${Pe} u_${Ae};
#endif
`:Ze==="vec4"?`
#ifndef HAS_UNIFORM_u_${Ae}
    ${he} ${Pe} ${Ae} = a_${Ae};
#else
    ${he} ${Pe} ${Ae} = u_${Ae};
#endif
`:`
#ifndef HAS_UNIFORM_u_${Ae}
    ${he} ${Pe} ${Ae} = unpack_mix_${Ze}(a_${Ae}, u_${Ae}_t);
#else
    ${he} ${Pe} ${Ae} = u_${Ae};
#endif
`})),staticAttributes:w,staticUniforms:z}}class fi{constructor(u,g,w){this.vertexBuffer=u,this.indexBuffer=g,this.segments=w}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.vertexBuffer=null,this.indexBuffer=null,this.segments=null}}var $i=o.aU([{name:"a_pos",type:"Int16",components:2}]);const ba="#define PROJECTION_MERCATOR",wi="mercator";class hi{constructor(){this._cachedMesh=null}get name(){return"mercator"}get useSubdivision(){return!1}get shaderVariantName(){return wi}get shaderDefine(){return ba}get shaderPreludeCode(){return hn.projectionMercator}get vertexShaderPreludeCode(){return hn.projectionMercator.vertexSource}get subdivisionGranularity(){return o.aV.noSubdivision}get useGlobeControls(){return!1}get transitionState(){return 0}get latitudeErrorCorrectionRadians(){return 0}destroy(){}updateGPUdependent(u){}getMeshFromTileID(u,g,w,C,L){if(this._cachedMesh)return this._cachedMesh;const z=new o.aW;z.emplaceBack(0,0),z.emplaceBack(o.a5,0),z.emplaceBack(0,o.a5),z.emplaceBack(o.a5,o.a5);const Y=u.createVertexBuffer(z,$i.members),re=o.aX.simpleSegment(0,0,4,2),le=new o.aY;le.emplaceBack(1,0,2),le.emplaceBack(1,2,3);const he=u.createIndexBuffer(le);return this._cachedMesh=new fi(Y,he,re),this._cachedMesh}recalculate(){}hasTransition(){return!1}setErrorQueryLatitudeDegrees(u){}}class Ts{constructor(u=0,g=0,w=0,C=0){if(isNaN(u)||u<0||isNaN(g)||g<0||isNaN(w)||w<0||isNaN(C)||C<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=u,this.bottom=g,this.left=w,this.right=C}interpolate(u,g,w){return g.top!=null&&u.top!=null&&(this.top=o.G.number(u.top,g.top,w)),g.bottom!=null&&u.bottom!=null&&(this.bottom=o.G.number(u.bottom,g.bottom,w)),g.left!=null&&u.left!=null&&(this.left=o.G.number(u.left,g.left,w)),g.right!=null&&u.right!=null&&(this.right=o.G.number(u.right,g.right,w)),this}getCenter(u,g){const w=o.an((this.left+u-this.right)/2,0,u),C=o.an((this.top+g-this.bottom)/2,0,g);return new o.P(w,C)}equals(u){return this.top===u.top&&this.bottom===u.bottom&&this.left===u.left&&this.right===u.right}clone(){return new Ts(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}function Vs(D,u){if(!D.renderWorldCopies||D.lngRange)return;const g=u.lng-D.center.lng;u.lng+=g>180?-360:g<-180?360:0}function Mi(D){return Math.max(0,Math.floor(D))}class Cs{constructor(u,g){var w;this.applyConstrain=(C,L)=>this._constrainOverride!==null?this._constrainOverride(C,L):this._callbacks.defaultConstrain(C,L),this._callbacks=u,this._tileSize=512,this._renderWorldCopies=g?.renderWorldCopies===void 0||!!g?.renderWorldCopies,this._minZoom=g?.minZoom||0,this._maxZoom=g?.maxZoom||22,this._minPitch=g?.minPitch==null?0:g?.minPitch,this._maxPitch=g?.maxPitch==null?60:g?.maxPitch,this._constrainOverride=(w=g?.constrainOverride)!==null&&w!==void 0?w:null,this.setMaxBounds(),this._width=0,this._height=0,this._center=new o.V(0,0),this._elevation=0,this._zoom=0,this._tileZoom=Mi(this._zoom),this._scale=o.aq(this._zoom),this._bearingInRadians=0,this._fovInRadians=.6435011087932844,this._pitchInRadians=0,this._rollInRadians=0,this._unmodified=!0,this._edgeInsets=new Ts,this._minElevationForCurrentTile=0,this._autoCalculateNearFarZ=!0}apply(u,g,w){this._constrainOverride=u.constrainOverride,this._latRange=u.latRange,this._lngRange=u.lngRange,this._width=u.width,this._height=u.height,this._center=u.center,this._elevation=u.elevation,this._minElevationForCurrentTile=u.minElevationForCurrentTile,this._zoom=u.zoom,this._tileZoom=Mi(this._zoom),this._scale=o.aq(this._zoom),this._bearingInRadians=u.bearingInRadians,this._fovInRadians=u.fovInRadians,this._pitchInRadians=u.pitchInRadians,this._rollInRadians=u.rollInRadians,this._unmodified=u.unmodified,this._edgeInsets=new Ts(u.padding.top,u.padding.bottom,u.padding.left,u.padding.right),this._minZoom=u.minZoom,this._maxZoom=u.maxZoom,this._minPitch=u.minPitch,this._maxPitch=u.maxPitch,this._renderWorldCopies=u.renderWorldCopies,this._cameraToCenterDistance=u.cameraToCenterDistance,this._nearZ=u.nearZ,this._farZ=u.farZ,this._autoCalculateNearFarZ=!w&&u.autoCalculateNearFarZ,g&&this.constrainInternal(),this._calcMatrices()}get pixelsToClipSpaceMatrix(){return this._pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._clipSpaceToPixelsMatrix}get minElevationForCurrentTile(){return this._minElevationForCurrentTile}setMinElevationForCurrentTile(u){this._minElevationForCurrentTile=u}get tileSize(){return this._tileSize}get tileZoom(){return this._tileZoom}get scale(){return this._scale}get width(){return this._width}get height(){return this._height}get bearingInRadians(){return this._bearingInRadians}get lngRange(){return this._lngRange}get latRange(){return this._latRange}get pixelsToGLUnits(){return this._pixelsToGLUnits}get minZoom(){return this._minZoom}setMinZoom(u){this._minZoom!==u&&(this._minZoom=u,this.setZoom(this.applyConstrain(this._center,this.zoom).zoom))}get maxZoom(){return this._maxZoom}setMaxZoom(u){this._maxZoom!==u&&(this._maxZoom=u,this.setZoom(this.applyConstrain(this._center,this.zoom).zoom))}get minPitch(){return this._minPitch}setMinPitch(u){this._minPitch!==u&&(this._minPitch=u,this.setPitch(Math.max(this.pitch,u)))}get maxPitch(){return this._maxPitch}setMaxPitch(u){this._maxPitch!==u&&(this._maxPitch=u,this.setPitch(Math.min(this.pitch,u)))}get renderWorldCopies(){return this._renderWorldCopies}setRenderWorldCopies(u){u===void 0?u=!0:u===null&&(u=!1),this._renderWorldCopies=u}get constrainOverride(){return this._constrainOverride}setConstrainOverride(u){u===void 0&&(u=null),this._constrainOverride!==u&&(this._constrainOverride=u,this.constrainInternal(),this._calcMatrices())}get worldSize(){return this._tileSize*this._scale}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new o.P(this._width,this._height)}get bearing(){return this._bearingInRadians/Math.PI*180}setBearing(u){const g=o.W(u,-180,180)*Math.PI/180;var w,C,L,z,Y,re,le,he,Pe;this._bearingInRadians!==g&&(this._unmodified=!1,this._bearingInRadians=g,this._calcMatrices(),this._rotationMatrix=f(),w=this._rotationMatrix,L=-this._bearingInRadians,z=(C=this._rotationMatrix)[0],Y=C[1],re=C[2],le=C[3],he=Math.sin(L),Pe=Math.cos(L),w[0]=z*Pe+re*he,w[1]=Y*Pe+le*he,w[2]=z*-he+re*Pe,w[3]=Y*-he+le*Pe)}get rotationMatrix(){return this._rotationMatrix}get pitchInRadians(){return this._pitchInRadians}get pitch(){return this._pitchInRadians/Math.PI*180}setPitch(u){const g=o.an(u,this.minPitch,this.maxPitch)/180*Math.PI;this._pitchInRadians!==g&&(this._unmodified=!1,this._pitchInRadians=g,this._calcMatrices())}get rollInRadians(){return this._rollInRadians}get roll(){return this._rollInRadians/Math.PI*180}setRoll(u){const g=u/180*Math.PI;this._rollInRadians!==g&&(this._unmodified=!1,this._rollInRadians=g,this._calcMatrices())}get fovInRadians(){return this._fovInRadians}get fov(){return o.aZ(this._fovInRadians)}setFov(u){u=o.an(u,.1,150),this.fov!==u&&(this._unmodified=!1,this._fovInRadians=o.ap(u),this._calcMatrices())}get zoom(){return this._zoom}setZoom(u){const g=this.applyConstrain(this._center,u).zoom;this._zoom!==g&&(this._unmodified=!1,this._zoom=g,this._tileZoom=Math.max(0,Math.floor(g)),this._scale=o.aq(g),this.constrainInternal(),this._calcMatrices())}get center(){return this._center}setCenter(u){u.lat===this._center.lat&&u.lng===this._center.lng||(this._unmodified=!1,this._center=u,this.constrainInternal(),this._calcMatrices())}get elevation(){return this._elevation}setElevation(u){u!==this._elevation&&(this._elevation=u,this.constrainInternal(),this._calcMatrices())}get padding(){return this._edgeInsets.toJSON()}setPadding(u){this._edgeInsets.equals(u)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,u,1),this._calcMatrices())}get centerPoint(){return this._edgeInsets.getCenter(this._width,this._height)}get pixelsPerMeter(){return this._pixelPerMeter}get unmodified(){return this._unmodified}get cameraToCenterDistance(){return this._cameraToCenterDistance}get nearZ(){return this._nearZ}get farZ(){return this._farZ}get autoCalculateNearFarZ(){return this._autoCalculateNearFarZ}overrideNearFarZ(u,g){this._autoCalculateNearFarZ=!1,this._nearZ=u,this._farZ=g,this._calcMatrices()}clearNearFarZOverride(){this._autoCalculateNearFarZ=!0,this._calcMatrices()}isPaddingEqual(u){return this._edgeInsets.equals(u)}interpolatePadding(u,g,w){this._unmodified=!1,this._edgeInsets.interpolate(u,g,w),this.constrainInternal(),this._calcMatrices()}resize(u,g,w=!0){this._width=u,this._height=g,w&&this.constrainInternal(),this._calcMatrices()}getMaxBounds(){return this._latRange&&this._latRange.length===2&&this._lngRange&&this._lngRange.length===2?new $t([this._lngRange[0],this._latRange[0]],[this._lngRange[1],this._latRange[1]]):null}setMaxBounds(u){u?(this._lngRange=[u.getWest(),u.getEast()],this._latRange=[u.getSouth(),u.getNorth()],this.constrainInternal()):(this._lngRange=null,this._latRange=[-o.ao,o.ao])}getCameraQueryGeometry(u,g){if(g.length===1)return[g[0],u];{const{minX:w,minY:C,maxX:L,maxY:z}=o.aa.fromPoints(g).extend(u);return[new o.P(w,C),new o.P(L,C),new o.P(L,z),new o.P(w,z),new o.P(w,C)]}}constrainInternal(){if(!this.center||!this._width||!this._height||this._constraining)return;this._constraining=!0;const u=this._unmodified,{center:g,zoom:w}=this.applyConstrain(this.center,this.zoom);this.setCenter(g),this.setZoom(w),this._unmodified=u,this._constraining=!1}_calcMatrices(){if(this._width&&this._height){this._pixelsToGLUnits=[2/this._width,-2/this._height];let u=o.ar(new Float64Array(16));o.Q(u,u,[this._width/2,-this._height/2,1]),o.O(u,u,[1,-1,0]),this._clipSpaceToPixelsMatrix=u,u=o.ar(new Float64Array(16)),o.Q(u,u,[1,-1,1]),o.O(u,u,[-1,-1,0]),o.Q(u,u,[2/this._width,2/this._height,1]),this._pixelsToClipSpaceMatrix=u,this._cameraToCenterDistance=.5/Math.tan(this.fovInRadians/2)*this._height}this._callbacks.calcMatrices()}calculateCenterFromCameraLngLatAlt(u,g,w,C){const L=w!==void 0?w:this.bearing,z=C=C!==void 0?C:this.pitch,{distanceToCenter:Y,clampedElevation:re}=this._distanceToCenterFromAltElevationPitch(g,this.elevation,z),{x:le,y:he}=en(z,L),Pe=o.a9.fromLngLat(u,g);let Ae,Ue,Ze=o.a_(1,Pe.y),ht=0;do{if(ht+=1,ht>10)break;Ue=Y/Ze,Ae=new o.a9(Pe.x+le*Ue,Pe.y+he*Ue),Ze=1/Ae.meterInMercatorCoordinateUnits()}while(Math.abs(Y-Ue*Ze)>1e-12);return{center:Ae.toLngLat(),elevation:re,zoom:o.at(this.height/2/Math.tan(this.fovInRadians/2)/Ue/this.tileSize)}}recalculateZoomAndCenter(u){if(this.elevation-u==0)return;const g=1/this.worldSize,w=o.as(1,this.center.lat)*this.worldSize,C=o.a9.fromLngLat(this.center,this.elevation),L=C.x/g,z=C.y/g,Y=C.z/g,re=this.pitch,le=this.bearing,{x:he,y:Pe,z:Ae}=en(re,le),Ue=this.cameraToCenterDistance,Ze=L+Ue*-he,ht=z+Ue*-Pe,pt=Y+Ue*Ae,{distanceToCenter:dt,clampedElevation:xt}=this._distanceToCenterFromAltElevationPitch(pt/w,u,re),Nt=dt*w,wt=new o.a9((Ze+he*Nt)*g,(ht+Pe*Nt)*g,0).toLngLat(),Lt=o.as(1,wt.lat),jt=o.at(this.height/2/Math.tan(this.fovInRadians/2)/dt/Lt/this.tileSize);this._elevation=xt,this._center=wt,this.setZoom(jt)}_distanceToCenterFromAltElevationPitch(u,g,w){const C=-Math.cos(o.ap(w)),L=u-g;let z,Y=g;return C*L>=0||Math.abs(C)<.1?(z=1e4,Y=u+z*C):z=-L/C,{distanceToCenter:z,clampedElevation:Y}}getCameraPoint(){const u=Math.tan(this.pitchInRadians)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new o.P(u*Math.sin(this.rollInRadians),u*Math.cos(this.rollInRadians)))}getCameraAltitude(){return Math.cos(this.pitchInRadians)*this._cameraToCenterDistance/this._pixelPerMeter+this.elevation}getCameraLngLat(){const u=o.as(1,this.center.lat)*this.worldSize;return Mt(this.center,this.elevation,this.pitch,this.bearing,this.cameraToCenterDistance/u).toLngLat()}getMercatorTileCoordinates(u){if(!u)return[0,0,1,1];const g=u.canonical.z>=0?1<<u.canonical.z:Math.pow(2,u.canonical.z);return[u.canonical.x/g,u.canonical.y/g,1/g/o.a5,1/g/o.a5]}}class oa{constructor(u,g){this.min=u,this.max=g,this.center=o.a$([],o.b0([],this.min,this.max),.5)}quadrant(u){const g=[u%2==0,u<2],w=o.b1(this.min),C=o.b1(this.max);for(let L=0;L<g.length;L++)w[L]=g[L]?this.min[L]:this.center[L],C[L]=g[L]?this.center[L]:this.max[L];return C[2]=this.max[2],new oa(w,C)}distanceX(u){return Math.max(Math.min(this.max[0],u[0]),this.min[0])-u[0]}distanceY(u){return Math.max(Math.min(this.max[1],u[1]),this.min[1])-u[1]}intersectsFrustum(u){let g=!0;for(let w=0;w<u.planes.length;w++){const C=this.intersectsPlane(u.planes[w]);if(C===0)return 0;C===1&&(g=!1)}return g?2:u.aabb.min[0]>this.max[0]||u.aabb.min[1]>this.max[1]||u.aabb.min[2]>this.max[2]||u.aabb.max[0]<this.min[0]||u.aabb.max[1]<this.min[1]||u.aabb.max[2]<this.min[2]?0:1}intersectsPlane(u){let g=u[3],w=u[3];for(let C=0;C<3;C++)u[C]>0?(g+=u[C]*this.min[C],w+=u[C]*this.max[C]):(w+=u[C]*this.min[C],g+=u[C]*this.max[C]);return g>=0?2:w<0?0:1}}class ku{distanceToTile2d(u,g,w,C){const L=C.distanceX([u,g]),z=C.distanceY([u,g]);return Math.hypot(L,z)}getWrap(u,g,w){return w}getTileBoundingVolume(u,g,w,C){var L,z;let Y=0,re=0;if(C?.terrain){const he=new o.a2(u.z,g,u.z,u.x,u.y),Pe=C.terrain.getMinMaxElevation(he);Y=(L=Pe.minElevation)!==null&&L!==void 0?L:Math.min(0,w),re=(z=Pe.maxElevation)!==null&&z!==void 0?z:Math.max(0,w)}const le=1<<u.z;return new oa([g+u.x/le,u.y/le,Y],[g+(u.x+1)/le,(u.y+1)/le,re])}allowVariableZoom(u,g){const w=u.fov*(Math.abs(Math.cos(u.rollInRadians))*u.height+Math.abs(Math.sin(u.rollInRadians))*u.width)/u.height,C=o.an(78.5-w/2,0,60);return!!g.terrain||u.pitch>C}allowWorldCopies(){return!0}prepareNextFrame(){}}class Ka{constructor(u,g,w){this.points=u,this.planes=g,this.aabb=w}static fromInvProjectionMatrix(u,g=1,w=0,C,L){const z=L?[[6,5,4],[0,1,2],[0,3,7],[2,1,5],[3,2,6],[0,4,5]]:[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]],Y=Math.pow(2,w),re=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map((Ae=>(function(Ue,Ze,ht,pt){const dt=o.aH([],Ue,Ze),xt=1/dt[3]/ht*pt;return o.b6(dt,dt,[xt,xt,1/dt[3],xt])})(Ae,u,g,Y)));C&&(function(Ae,Ue,Ze,ht){const pt=ht?4:0,dt=ht?0:4;let xt=0;const Nt=[],wt=[];for(let Dt=0;Dt<4;Dt++){const Zt=o.b2([],Ae[Dt+dt],Ae[Dt+pt]),Sr=o.b7(Zt);o.a$(Zt,Zt,1/Sr),Nt.push(Sr),wt.push(Zt)}for(let Dt=0;Dt<4;Dt++){const Zt=o.b8(Ae[Dt+pt],wt[Dt],Ze);xt=Zt!==null&&Zt>=0?Math.max(xt,Zt):Math.max(xt,Nt[Dt])}const Lt=(function(Dt,Zt){const Sr=o.b2([],Dt[Zt[0]],Dt[Zt[1]]),pr=o.b2([],Dt[Zt[2]],Dt[Zt[1]]),_r=[0,0,0,0];return o.b3(_r,o.b4([],Sr,pr)),_r[3]=-o.b5(_r,Dt[Zt[0]]),_r})(Ae,Ue),jt=(function(Dt,Zt){const Sr=o.b9(Dt),pr=o.ba([],Dt,1/Sr),_r=o.b2([],Zt,o.a$([],pr,o.b5(Zt,pr))),xr=o.b9(_r);if(xr>0){const an=Math.sqrt(1-pr[3]*pr[3]),ln=o.a$([],pr,-pr[3]),Hr=o.b0([],ln,o.a$([],_r,an/xr));return o.bb(Zt,Hr)}return null})(Ze,Lt);if(jt!==null){const Dt=jt/o.b5(wt[0],Lt);xt=Math.min(xt,Dt)}for(let Dt=0;Dt<4;Dt++){const Zt=Math.min(xt,Nt[Dt]);Ae[Dt+dt]=[Ae[Dt+pt][0]+wt[Dt][0]*Zt,Ae[Dt+pt][1]+wt[Dt][1]*Zt,Ae[Dt+pt][2]+wt[Dt][2]*Zt,1]}})(re,z[0],C,L);const le=z.map((Ae=>{const Ue=o.b2([],re[Ae[0]],re[Ae[1]]),Ze=o.b2([],re[Ae[2]],re[Ae[1]]),ht=o.b3([],o.b4([],Ue,Ze)),pt=-o.b5(ht,re[Ae[1]]);return ht.concat(pt)})),he=[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY],Pe=[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY];for(const Ae of re)for(let Ue=0;Ue<3;Ue++)he[Ue]=Math.min(he[Ue],Ae[Ue]),Pe[Ue]=Math.max(Pe[Ue],Ae[Ue]);return new Ka(re,le,new oa(he,Pe))}}class $s{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(u){this._helper.setMinZoom(u)}setMaxZoom(u){this._helper.setMaxZoom(u)}setMinPitch(u){this._helper.setMinPitch(u)}setMaxPitch(u){this._helper.setMaxPitch(u)}setRenderWorldCopies(u){this._helper.setRenderWorldCopies(u)}setBearing(u){this._helper.setBearing(u)}setPitch(u){this._helper.setPitch(u)}setRoll(u){this._helper.setRoll(u)}setFov(u){this._helper.setFov(u)}setZoom(u){this._helper.setZoom(u)}setCenter(u){this._helper.setCenter(u)}setElevation(u){this._helper.setElevation(u)}setMinElevationForCurrentTile(u){this._helper.setMinElevationForCurrentTile(u)}setPadding(u){this._helper.setPadding(u)}interpolatePadding(u,g,w){return this._helper.interpolatePadding(u,g,w)}isPaddingEqual(u){return this._helper.isPaddingEqual(u)}resize(u,g,w=!0){this._helper.resize(u,g,w)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(u){this._helper.setMaxBounds(u)}setConstrainOverride(u){this._helper.setConstrainOverride(u)}overrideNearFarZ(u,g){this._helper.overrideNearFarZ(u,g)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(u){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),u)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}get constrainOverride(){return this._helper.constrainOverride}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}setTransitionState(u,g){}constructor(u){this._posMatrixCache=new Map,this._alignedPosMatrixCache=new Map,this._fogMatrixCacheF32=new Map,this.defaultConstrain=(g,w)=>{w=o.an(+w,this.minZoom,this.maxZoom);const C={center:new o.V(g.lng,g.lat),zoom:w};let L=this._helper._lngRange;if(!this._helper._renderWorldCopies&&L===null){const wt=179.9999999999;L=[-wt,wt]}const z=this.tileSize*o.aq(C.zoom);let Y=0,re=z,le=0,he=z,Pe=0,Ae=0;const{x:Ue,y:Ze}=this.size;if(this._helper._latRange){const wt=this._helper._latRange;Y=o.X(wt[1])*z,re=o.X(wt[0])*z,re-Y<Ze&&(Pe=Ze/(re-Y))}L&&(le=o.W(o.Y(L[0])*z,0,z),he=o.W(o.Y(L[1])*z,0,z),he<le&&(he+=z),he-le<Ue&&(Ae=Ue/(he-le)));const{x:ht,y:pt}=Ar(z,g);let dt,xt;const Nt=Math.max(Ae||0,Pe||0);if(Nt){const wt=new o.P(Ae?(he+le)/2:ht,Pe?(re+Y)/2:pt);return C.center=$r(z,wt).wrap(),C.zoom+=o.at(Nt),C}if(this._helper._latRange){const wt=Ze/2;pt-wt<Y&&(xt=Y+wt),pt+wt>re&&(xt=re-wt)}if(L){const wt=(le+he)/2;let Lt=ht;this._helper._renderWorldCopies&&(Lt=o.W(ht,wt-z/2,wt+z/2));const jt=Ue/2;Lt-jt<le&&(dt=le+jt),Lt+jt>he&&(dt=he-jt)}if(dt!==void 0||xt!==void 0){const wt=new o.P(dt??ht,xt??pt);C.center=$r(z,wt).wrap()}return C},this.applyConstrain=(g,w)=>this._helper.applyConstrain(g,w),this._helper=new Cs({calcMatrices:()=>{this._calcMatrices()},defaultConstrain:(g,w)=>this.defaultConstrain(g,w)},u),this._coveringTilesDetailsProvider=new ku}clone(){const u=new $s;return u.apply(this,!1),u}apply(u,g,w){this._helper.apply(u,g,w)}get cameraPosition(){return this._cameraPosition}get projectionMatrix(){return this._projectionMatrix}get modelViewProjectionMatrix(){return this._viewProjMatrix}get inverseProjectionMatrix(){return this._invProjMatrix}get mercatorMatrix(){return this._mercatorMatrix}getVisibleUnwrappedCoordinates(u){const g=[new o.bc(0,u)];if(this._helper._renderWorldCopies){const w=this.screenPointToMercatorCoordinate(new o.P(0,0)),C=this.screenPointToMercatorCoordinate(new o.P(this._helper._width,0)),L=this.screenPointToMercatorCoordinate(new o.P(this._helper._width,this._helper._height)),z=this.screenPointToMercatorCoordinate(new o.P(0,this._helper._height)),Y=Math.floor(Math.min(w.x,C.x,L.x,z.x)),re=Math.floor(Math.max(w.x,C.x,L.x,z.x)),le=1;for(let he=Y-le;he<=re+le;he++)he!==0&&g.push(new o.bc(he,u))}return g}getCameraFrustum(){return Ka.fromInvProjectionMatrix(this._invViewProjMatrix,this.worldSize)}getClippingPlane(){return null}getCoveringTilesDetailsProvider(){return this._coveringTilesDetailsProvider}recalculateZoomAndCenter(u){const g=this.screenPointToLocation(this.centerPoint,u),w=u?u.getElevationForLngLatZoom(g,this._helper._tileZoom):0;this._helper.recalculateZoomAndCenter(w)}setLocationAtPoint(u,g){const w=o.as(this.elevation,this.center.lat),C=this.screenPointToMercatorCoordinateAtZ(g,w),L=this.screenPointToMercatorCoordinateAtZ(this.centerPoint,w),z=o.a9.fromLngLat(u),Y=new o.a9(z.x-(C.x-L.x),z.y-(C.y-L.y));this.setCenter(Y?.toLngLat()),this._helper._renderWorldCopies&&this.setCenter(this.center.wrap())}locationToScreenPoint(u,g){return g?this.coordinatePoint(o.a9.fromLngLat(u),g.getElevationForLngLat(u,this),this._pixelMatrix3D):this.coordinatePoint(o.a9.fromLngLat(u))}screenPointToLocation(u,g){var w;return(w=this.screenPointToMercatorCoordinate(u,g))===null||w===void 0?void 0:w.toLngLat()}screenPointToMercatorCoordinate(u,g){if(g){const w=g.pointCoordinate(u);if(w!=null)return w}return this.screenPointToMercatorCoordinateAtZ(u)}screenPointToMercatorCoordinateAtZ(u,g){const w=g||0,C=[u.x,u.y,0,1],L=[u.x,u.y,1,1];o.aH(C,C,this._pixelMatrixInverse),o.aH(L,L,this._pixelMatrixInverse);const z=C[3],Y=L[3],re=C[1]/z,le=L[1]/Y,he=C[2]/z,Pe=L[2]/Y,Ae=he===Pe?0:(w-he)/(Pe-he);return new o.a9(o.G.number(C[0]/z,L[0]/Y,Ae)/this.worldSize,o.G.number(re,le,Ae)/this.worldSize,w)}coordinatePoint(u,g=0,w=this._pixelMatrix){const C=[u.x*this.worldSize,u.y*this.worldSize,g,1];return o.aH(C,C,w),new o.P(C[0]/C[3],C[1]/C[3])}getBounds(){const u=Math.max(0,this._helper._height/2-fn(this));return new $t().extend(this.screenPointToLocation(new o.P(0,u))).extend(this.screenPointToLocation(new o.P(this._helper._width,u))).extend(this.screenPointToLocation(new o.P(this._helper._width,this._helper._height))).extend(this.screenPointToLocation(new o.P(0,this._helper._height)))}isPointOnMapSurface(u,g){return g?g.pointCoordinate(u)!=null:u.y>this.height/2-fn(this)}calculatePosMatrix(u,g=!1,w){var C;const L=(C=u.key)!==null&&C!==void 0?C:o.bd(u.wrap,u.canonical.z,u.canonical.z,u.canonical.x,u.canonical.y),z=g?this._alignedPosMatrixCache:this._posMatrixCache;if(z.has(L)){const le=z.get(L);return w?le.f32:le.f64}const Y=zr(u,this.worldSize);o.S(Y,g?this._alignedProjMatrix:this._viewProjMatrix,Y);const re={f64:Y,f32:new Float32Array(Y)};return z.set(L,re),w?re.f32:re.f64}calculateFogMatrix(u){const g=u.key,w=this._fogMatrixCacheF32;if(w.has(g))return w.get(g);const C=zr(u,this.worldSize);return o.S(C,this._fogMatrix,C),w.set(g,new Float32Array(C)),w.get(g)}calculateCenterFromCameraLngLatAlt(u,g,w,C){return this._helper.calculateCenterFromCameraLngLatAlt(u,g,w,C)}_calculateNearFarZIfNeeded(u,g,w){if(!this._helper.autoCalculateNearFarZ)return;const C=Math.min(this.elevation,this.minElevationForCurrentTile,this.getCameraAltitude()-100),L=u-C*this._helper._pixelPerMeter/Math.cos(g),z=C<0?L:u,Y=Math.PI/2+this.pitchInRadians,re=o.ap(this.fov)*(Math.abs(Math.cos(o.ap(this.roll)))*this.height+Math.abs(Math.sin(o.ap(this.roll)))*this.width)/this.height*(.5+w.y/this.height),le=Math.sin(re)*z/Math.sin(o.an(Math.PI-Y-re,.01,Math.PI-.01)),he=fn(this),Pe=Math.atan(he/this._helper.cameraToCenterDistance),Ae=o.ap(.75),Ue=Pe>Ae?2*Pe*(.5+w.y/(2*he)):Ae,Ze=Math.sin(Ue)*z/Math.sin(o.an(Math.PI-Y-Ue,.01,Math.PI-.01)),ht=Math.min(le,Ze);this._helper._farZ=1.01*(Math.cos(Math.PI/2-g)*ht+z),this._helper._nearZ=this._helper._height/50}_calcMatrices(){if(!this._helper._height)return;const u=this.centerOffset,g=Ar(this.worldSize,this.center),w=g.x,C=g.y;this._helper._pixelPerMeter=o.as(1,this.center.lat)*this.worldSize;const L=o.ap(Math.min(this.pitch,Ir)),z=Math.max(this._helper.cameraToCenterDistance/2,this._helper.cameraToCenterDistance+this._helper._elevation*this._helper._pixelPerMeter/Math.cos(L));let Y;this._calculateNearFarZIfNeeded(z,L,u),Y=new Float64Array(16),o.be(Y,this.fovInRadians,this._helper._width/this._helper._height,this._helper._nearZ,this._helper._farZ),this._invProjMatrix=new Float64Array(16),o.aB(this._invProjMatrix,Y),Y[8]=2*-u.x/this._helper._width,Y[9]=2*u.y/this._helper._height,this._projectionMatrix=o.bf(Y),o.Q(Y,Y,[1,-1,1]),o.O(Y,Y,[0,0,-this._helper.cameraToCenterDistance]),o.bg(Y,Y,-this.rollInRadians),o.bh(Y,Y,this.pitchInRadians),o.bg(Y,Y,-this.bearingInRadians),o.O(Y,Y,[-w,-C,0]),this._mercatorMatrix=o.Q([],Y,[this.worldSize,this.worldSize,this.worldSize]),o.Q(Y,Y,[1,1,this._helper._pixelPerMeter]),this._pixelMatrix=o.S(new Float64Array(16),this.clipSpaceToPixelsMatrix,Y),o.O(Y,Y,[0,0,-this.elevation]),this._viewProjMatrix=Y,this._invViewProjMatrix=o.aB([],Y);const re=[0,0,-1,1];o.aH(re,re,this._invViewProjMatrix),this._cameraPosition=[re[0]/re[3],re[1]/re[3],re[2]/re[3]],this._fogMatrix=new Float64Array(16),o.be(this._fogMatrix,this.fovInRadians,this.width/this.height,z,this._helper._farZ),this._fogMatrix[8]=2*-u.x/this.width,this._fogMatrix[9]=2*u.y/this.height,o.Q(this._fogMatrix,this._fogMatrix,[1,-1,1]),o.O(this._fogMatrix,this._fogMatrix,[0,0,-this.cameraToCenterDistance]),o.bg(this._fogMatrix,this._fogMatrix,-this.rollInRadians),o.bh(this._fogMatrix,this._fogMatrix,this.pitchInRadians),o.bg(this._fogMatrix,this._fogMatrix,-this.bearingInRadians),o.O(this._fogMatrix,this._fogMatrix,[-w,-C,0]),o.Q(this._fogMatrix,this._fogMatrix,[1,1,this._helper._pixelPerMeter]),o.O(this._fogMatrix,this._fogMatrix,[0,0,-this.elevation]),this._pixelMatrix3D=o.S(new Float64Array(16),this.clipSpaceToPixelsMatrix,Y);const le=this._helper._width%2/2,he=this._helper._height%2/2,Pe=Math.cos(this.bearingInRadians),Ae=Math.sin(-this.bearingInRadians),Ue=w-Math.round(w)+Pe*le+Ae*he,Ze=C-Math.round(C)+Pe*he+Ae*le,ht=new Float64Array(Y);if(o.O(ht,ht,[Ue>.5?Ue-1:Ue,Ze>.5?Ze-1:Ze,0]),this._alignedProjMatrix=ht,Y=o.aB(new Float64Array(16),this._pixelMatrix),!Y)throw new Error("failed to invert matrix");this._pixelMatrixInverse=Y,this._clearMatrixCaches()}_clearMatrixCaches(){this._posMatrixCache.clear(),this._alignedPosMatrixCache.clear(),this._fogMatrixCacheF32.clear()}maxPitchScaleFactor(){if(!this._pixelMatrixInverse)return 1;const u=this.screenPointToMercatorCoordinate(new o.P(0,0)),g=[u.x*this.worldSize,u.y*this.worldSize,0,1];return o.aH(g,g,this._pixelMatrix)[3]/this._helper.cameraToCenterDistance}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){const u=o.as(1,this.center.lat)*this.worldSize;return Mt(this.center,this.elevation,this.pitch,this.bearing,this._helper.cameraToCenterDistance/u).toLngLat()}lngLatToCameraDepth(u,g){const w=o.a9.fromLngLat(u),C=[w.x*this.worldSize,w.y*this.worldSize,g,1];return o.aH(C,C,this._viewProjMatrix),C[2]/C[3]}getProjectionData(u){const{overscaledTileID:g,aligned:w,applyTerrainMatrix:C}=u,L=this._helper.getMercatorTileCoordinates(g),z=g?this.calculatePosMatrix(g,w,!0):null;let Y;return Y=g&&g.terrainRttPosMatrix32f&&C?g.terrainRttPosMatrix32f:z||o.bi(),{mainMatrix:Y,tileMercatorCoords:L,clippingPlane:[0,0,0,0],projectionTransition:0,fallbackMatrix:Y}}isLocationOccluded(u){return!1}getPixelScale(){return 1}getCircleRadiusCorrection(){return 1}getPitchedTextCorrection(u,g,w){return 1}transformLightDirection(u){return o.b1(u)}getRayDirectionFromPixel(u){throw new Error("Not implemented.")}projectTileCoordinates(u,g,w,C){const L=this.calculatePosMatrix(w);let z;C?(z=[u,g,C(u,g),1],o.aH(z,z,L)):(z=[u,g,0,1],Fa(z,z,L));const Y=z[3];return{point:new o.P(z[0]/Y,z[1]/Y),signedDistanceFromCamera:Y,isOccluded:!1}}populateCache(u){for(const g of u)this.calculatePosMatrix(g)}getMatrixForModel(u,g){const w=o.a9.fromLngLat(u,g),C=w.meterInMercatorCoordinateUnits(),L=o.bj();return o.O(L,L,[w.x,w.y,w.z]),o.bg(L,L,Math.PI),o.bh(L,L,Math.PI/2),o.Q(L,L,[-C,C,C]),L}getProjectionDataForCustomLayer(u=!0){const g=new o.a2(0,0,0,0,0),w=this.getProjectionData({overscaledTileID:g,applyGlobeMatrix:u}),C=zr(g,this.worldSize);o.S(C,this._viewProjMatrix,C),w.tileMercatorCoords=[0,0,1,1];const L=[o.a5,o.a5,this.worldSize/this._helper.pixelsPerMeter],z=o.bk();return o.Q(z,C,L),w.fallbackMatrix=z,w.mainMatrix=z,w}getFastPathSimpleProjectionMatrix(u){return this.calculatePosMatrix(u)}}function Vo(){o.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.")}function Ru(D){if(D.useSlerp)if(D.k<1){const u=o.bl(D.startEulerAngles.roll,D.startEulerAngles.pitch,D.startEulerAngles.bearing),g=o.bl(D.endEulerAngles.roll,D.endEulerAngles.pitch,D.endEulerAngles.bearing),w=new Float64Array(4);o.bm(w,u,g,D.k);const C=o.bn(w);D.tr.setRoll(C.roll),D.tr.setPitch(C.pitch),D.tr.setBearing(C.bearing)}else D.tr.setRoll(D.endEulerAngles.roll),D.tr.setPitch(D.endEulerAngles.pitch),D.tr.setBearing(D.endEulerAngles.bearing);else D.tr.setRoll(o.G.number(D.startEulerAngles.roll,D.endEulerAngles.roll,D.k)),D.tr.setPitch(o.G.number(D.startEulerAngles.pitch,D.endEulerAngles.pitch,D.k)),D.tr.setBearing(o.G.number(D.startEulerAngles.bearing,D.endEulerAngles.bearing,D.k))}function Mu(D,u,g,w,C){const L=C.padding,z=Ar(C.worldSize,g.getNorthWest()),Y=Ar(C.worldSize,g.getNorthEast()),re=Ar(C.worldSize,g.getSouthEast()),le=Ar(C.worldSize,g.getSouthWest()),he=o.ap(-w),Pe=z.rotate(he),Ae=Y.rotate(he),Ue=re.rotate(he),Ze=le.rotate(he),ht=new o.P(Math.max(Pe.x,Ae.x,Ze.x,Ue.x),Math.max(Pe.y,Ae.y,Ze.y,Ue.y)),pt=new o.P(Math.min(Pe.x,Ae.x,Ze.x,Ue.x),Math.min(Pe.y,Ae.y,Ze.y,Ue.y)),dt=ht.sub(pt),xt=(C.width-(L.left+L.right+u.left+u.right))/dt.x,Nt=(C.height-(L.top+L.bottom+u.top+u.bottom))/dt.y;if(Nt<0||xt<0)return void Vo();const wt=Math.min(o.at(C.scale*Math.min(xt,Nt)),D.maxZoom),Lt=o.P.convert(D.offset),jt=new o.P((u.left-u.right)/2,(u.top-u.bottom)/2).rotate(o.ap(w)),Dt=Lt.add(jt).mult(C.scale/o.aq(wt));return{center:$r(C.worldSize,z.add(re).div(2).sub(Dt)),zoom:wt,bearing:w}}class go{get useGlobeControls(){return!1}handlePanInertia(u,g){const w=u.mag(),C=Math.abs(fn(g));return{easingOffset:u.mult(Math.min(.75*C/w,1)),easingCenter:g.center}}handleMapControlsRollPitchBearingZoom(u,g){u.bearingDelta&&g.setBearing(g.bearing+u.bearingDelta),u.pitchDelta&&g.setPitch(g.pitch+u.pitchDelta),u.rollDelta&&g.setRoll(g.roll+u.rollDelta),u.zoomDelta&&g.setZoom(g.zoom+u.zoomDelta)}handleMapControlsPan(u,g,w){u.around.distSqr(g.centerPoint)<.01||g.setLocationAtPoint(w,u.around)}cameraForBoxAndBearing(u,g,w,C,L){return Mu(u,g,w,C,L)}handleJumpToCenterZoom(u,g){u.zoom!==(g.zoom!==void 0?+g.zoom:u.zoom)&&u.setZoom(+g.zoom),g.center!==void 0&&u.setCenter(o.V.convert(g.center))}handleEaseTo(u,g){const w=u.zoom,C=u.padding,L={roll:u.roll,pitch:u.pitch,bearing:u.bearing},z={roll:g.roll===void 0?u.roll:g.roll,pitch:g.pitch===void 0?u.pitch:g.pitch,bearing:g.bearing===void 0?u.bearing:g.bearing},Y=g.zoom!==void 0,re=!u.isPaddingEqual(g.padding);let le=!1;const he=Y?+g.zoom:u.zoom;let Pe=u.centerPoint.add(g.offsetAsPoint);const Ae=u.screenPointToLocation(Pe),{center:Ue,zoom:Ze}=u.applyConstrain(o.V.convert(g.center||Ae),he??w);Vs(u,Ue);const ht=Ar(u.worldSize,Ae),pt=Ar(u.worldSize,Ue).sub(ht),dt=o.aq(Ze-w);return le=Ze!==w,{easeFunc:xt=>{if(le&&u.setZoom(o.G.number(w,Ze,xt)),o.bo(L,z)||Ru({startEulerAngles:L,endEulerAngles:z,tr:u,k:xt,useSlerp:L.roll!=z.roll}),re&&(u.interpolatePadding(C,g.padding,xt),Pe=u.centerPoint.add(g.offsetAsPoint)),g.around)u.setLocationAtPoint(g.around,g.aroundPoint);else{const Nt=o.aq(u.zoom-w),wt=Ze>w?Math.min(2,dt):Math.max(.5,dt),Lt=Math.pow(wt,1-xt),jt=$r(u.worldSize,ht.add(pt.mult(xt*Lt)).mult(Nt));u.setLocationAtPoint(u.renderWorldCopies?jt.wrap():jt,Pe)}},isZooming:le,elevationCenter:Ue}}handleFlyTo(u,g){const w=g.zoom!==void 0,C=u.zoom,L=u.applyConstrain(o.V.convert(g.center||g.locationAtOffset),w?+g.zoom:C),z=L.center,Y=L.zoom;Vs(u,z);const re=Ar(u.worldSize,g.locationAtOffset),le=Ar(u.worldSize,z).sub(re),he=le.mag(),Pe=o.aq(Y-C);let Ae;if(g.minZoom!==void 0){const Ue=Math.min(+g.minZoom,C,Y),Ze=u.applyConstrain(z,Ue).zoom;Ae=o.aq(Ze-C)}return{easeFunc:(Ue,Ze,ht,pt)=>{u.setZoom(Ue===1?Y:C+o.at(Ze));const dt=Ue===1?z:$r(u.worldSize,re.add(le.mult(ht)).mult(Ze));u.setLocationAtPoint(u.renderWorldCopies?dt.wrap():dt,pt)},scaleOfZoom:Pe,targetCenter:z,scaleOfMinZoom:Ae,pixelPathLength:he}}}class ji{constructor(u,g,w){this.blendFunction=u,this.blendColor=g,this.mask=w}}ji.Replace=[1,0],ji.disabled=new ji(ji.Replace,o.bp.transparent,[!1,!1,!1,!1]),ji.unblended=new ji(ji.Replace,o.bp.transparent,[!0,!0,!0,!0]),ji.alphaBlended=new ji([1,771],o.bp.transparent,[!0,!0,!0,!0]);const qs=2305;class ii{constructor(u,g,w){this.enable=u,this.mode=g,this.frontFace=w}}ii.disabled=new ii(!1,1029,qs),ii.backCCW=new ii(!0,1029,qs),ii.frontCCW=new ii(!0,1028,qs);class ri{constructor(u,g,w){this.func=u,this.mask=g,this.range=w}}ri.ReadOnly=!1,ri.ReadWrite=!0,ri.disabled=new ri(519,ri.ReadOnly,[0,1]);const Do=7680;class ai{constructor(u,g,w,C,L,z){this.test=u,this.ref=g,this.mask=w,this.fail=C,this.depthFail=L,this.pass=z}}ai.disabled=new ai({func:519,mask:0},0,0,Do,Do,Do);const ue=new WeakMap;function We(D){var u;if(ue.has(D))return ue.get(D);{const g=(u=D.getParameter(D.VERSION))===null||u===void 0?void 0:u.startsWith("WebGL 2.0");return ue.set(D,g),g}}class bt{get awaitingQuery(){return!!this._readbackQueue}constructor(u){this._readbackWaitFrames=4,this._measureWaitFrames=6,this._texWidth=1,this._texHeight=1,this._measuredError=0,this._updateCount=0,this._lastReadbackFrame=-1e3,this._readbackQueue=null,this._cachedRenderContext=u;const g=u.context,w=g.gl;this._texFormat=w.RGBA,this._texType=w.UNSIGNED_BYTE;const C=new o.aW;C.emplaceBack(-1,-1),C.emplaceBack(2,-1),C.emplaceBack(-1,2);const L=new o.aY;L.emplaceBack(0,1,2),this._fullscreenTriangle=new fi(g.createVertexBuffer(C,$i.members),g.createIndexBuffer(L),o.aX.simpleSegment(0,0,C.length,L.length)),this._resultBuffer=new Uint8Array(4),g.activeTexture.set(w.TEXTURE1);const z=w.createTexture();w.bindTexture(w.TEXTURE_2D,z),w.texParameteri(w.TEXTURE_2D,w.TEXTURE_WRAP_S,w.CLAMP_TO_EDGE),w.texParameteri(w.TEXTURE_2D,w.TEXTURE_WRAP_T,w.CLAMP_TO_EDGE),w.texParameteri(w.TEXTURE_2D,w.TEXTURE_MIN_FILTER,w.NEAREST),w.texParameteri(w.TEXTURE_2D,w.TEXTURE_MAG_FILTER,w.NEAREST),w.texImage2D(w.TEXTURE_2D,0,this._texFormat,this._texWidth,this._texHeight,0,this._texFormat,this._texType,null),this._fbo=g.createFramebuffer(this._texWidth,this._texHeight,!1,!1),this._fbo.colorAttachment.set(z),We(w)&&(this._pbo=w.createBuffer(),w.bindBuffer(w.PIXEL_PACK_BUFFER,this._pbo),w.bufferData(w.PIXEL_PACK_BUFFER,4,w.STREAM_READ),w.bindBuffer(w.PIXEL_PACK_BUFFER,null))}destroy(){const u=this._cachedRenderContext.context.gl;this._fullscreenTriangle.destroy(),this._fbo.destroy(),u.deleteBuffer(this._pbo),this._fullscreenTriangle=null,this._fbo=null,this._pbo=null,this._resultBuffer=null}updateErrorLoop(u,g){const w=this._updateCount;return this._readbackQueue?w>=this._readbackQueue.frameNumberIssued+this._readbackWaitFrames&&this._tryReadback():w>=this._lastReadbackFrame+this._measureWaitFrames&&this._renderErrorTexture(u,g),this._updateCount++,this._measuredError}_bindFramebuffer(){const u=this._cachedRenderContext.context,g=u.gl;u.activeTexture.set(g.TEXTURE1),g.bindTexture(g.TEXTURE_2D,this._fbo.colorAttachment.get()),u.bindFramebuffer.set(this._fbo.framebuffer)}_renderErrorTexture(u,g){const w=this._cachedRenderContext.context,C=w.gl;if(this._bindFramebuffer(),w.viewport.set([0,0,this._texWidth,this._texHeight]),w.clear({color:o.bp.transparent}),this._cachedRenderContext.useProgram("projectionErrorMeasurement").draw(w,C.TRIANGLES,ri.disabled,ai.disabled,ji.unblended,ii.disabled,((L,z)=>({u_input:L,u_output_expected:z}))(u,g),null,null,"$clipping",this._fullscreenTriangle.vertexBuffer,this._fullscreenTriangle.indexBuffer,this._fullscreenTriangle.segments),this._pbo&&We(C)){C.bindBuffer(C.PIXEL_PACK_BUFFER,this._pbo),C.readBuffer(C.COLOR_ATTACHMENT0),C.readPixels(0,0,this._texWidth,this._texHeight,this._texFormat,this._texType,0),C.bindBuffer(C.PIXEL_PACK_BUFFER,null);const L=C.fenceSync(C.SYNC_GPU_COMMANDS_COMPLETE,0);C.flush(),this._readbackQueue={frameNumberIssued:this._updateCount,sync:L}}else this._readbackQueue={frameNumberIssued:this._updateCount,sync:null}}_tryReadback(){const u=this._cachedRenderContext.context.gl;if(this._pbo&&this._readbackQueue&&We(u)){const g=u.clientWaitSync(this._readbackQueue.sync,0,0);if(g===u.WAIT_FAILED)return o.w("WebGL2 clientWaitSync failed."),this._readbackQueue=null,void(this._lastReadbackFrame=this._updateCount);if(g===u.TIMEOUT_EXPIRED)return;u.bindBuffer(u.PIXEL_PACK_BUFFER,this._pbo),u.getBufferSubData(u.PIXEL_PACK_BUFFER,0,this._resultBuffer,0,4),u.bindBuffer(u.PIXEL_PACK_BUFFER,null)}else this._bindFramebuffer(),u.readPixels(0,0,this._texWidth,this._texHeight,this._texFormat,this._texType,this._resultBuffer);this._readbackQueue=null,this._measuredError=bt._parseRGBA8float(this._resultBuffer),this._lastReadbackFrame=this._updateCount}static _parseRGBA8float(u){let g=0;return g+=u[0]/256,g+=u[1]/65536,g+=u[2]/16777216,u[3]<127&&(g=-g),g/128}}const zt=o.a5/128;function lr(D,u){const g=D.granularity!==void 0?Math.max(D.granularity,1):1,w=g+(D.generateBorders?2:0),C=g+(D.extendToNorthPole||D.generateBorders?1:0)+(D.extendToSouthPole||D.generateBorders?1:0),L=w+1,z=C+1,Y=D.generateBorders?-1:0,re=D.generateBorders||D.extendToNorthPole?-1:0,le=g+(D.generateBorders?1:0),he=g+(D.generateBorders||D.extendToSouthPole?1:0),Pe=L*z,Ae=w*C*6,Ue=L*z>65536;if(Ue&&u==="16bit")throw new Error("Granularity is too large and meshes would not fit inside 16 bit vertex indices.");const Ze=Ue||u==="32bit",ht=new Int16Array(2*Pe);let pt=0;for(let Nt=re;Nt<=he;Nt++)for(let wt=Y;wt<=le;wt++){let Lt=wt/g*o.a5;wt===-1&&(Lt=-zt),wt===g+1&&(Lt=o.a5+zt);let jt=Nt/g*o.a5;Nt===-1&&(jt=D.extendToNorthPole?o.br:-zt),Nt===g+1&&(jt=D.extendToSouthPole?o.bs:o.a5+zt),ht[pt++]=Lt,ht[pt++]=jt}const dt=Ze?new Uint32Array(Ae):new Uint16Array(Ae);let xt=0;for(let Nt=0;Nt<C;Nt++)for(let wt=0;wt<w;wt++){const Lt=wt+1+Nt*L,jt=wt+(Nt+1)*L,Dt=wt+1+(Nt+1)*L;dt[xt++]=wt+Nt*L,dt[xt++]=jt,dt[xt++]=Lt,dt[xt++]=Lt,dt[xt++]=jt,dt[xt++]=Dt}return{vertices:ht.buffer.slice(0),indices:dt.buffer.slice(0),uses32bitIndices:Ze}}const Nr=new o.aV({fill:new o.bt(128,2),line:new o.bt(512,0),tile:new o.bt(128,32),stencil:new o.bt(128,1),circle:3});class Zr{constructor(){this._tileMeshCache={},this._errorCorrectionUsable=0,this._errorMeasurementLastValue=0,this._errorCorrectionPreviousValue=0,this._errorMeasurementLastChangeTime=-1e3}get name(){return"vertical-perspective"}get transitionState(){return 1}get useSubdivision(){return!0}get shaderVariantName(){return"globe"}get shaderDefine(){return"#define GLOBE"}get shaderPreludeCode(){return hn.projectionGlobe}get vertexShaderPreludeCode(){return hn.projectionMercator.vertexSource}get subdivisionGranularity(){return Nr}get useGlobeControls(){return!0}get latitudeErrorCorrectionRadians(){return this._errorCorrectionUsable}destroy(){this._errorMeasurement&&this._errorMeasurement.destroy()}updateGPUdependent(u){this._errorMeasurement||(this._errorMeasurement=new bt(u));const g=o.X(this._errorQueryLatitudeDegrees),w=2*Math.atan(Math.exp(Math.PI-g*Math.PI*2))-.5*Math.PI,C=this._errorMeasurement.updateErrorLoop(g,w),L=T();C!==this._errorMeasurementLastValue&&(this._errorCorrectionPreviousValue=this._errorCorrectionUsable,this._errorMeasurementLastValue=C,this._errorMeasurementLastChangeTime=L);const z=Math.min(Math.max((L-this._errorMeasurementLastChangeTime)/1e3/.5,0),1);this._errorCorrectionUsable=o.bu(this._errorCorrectionPreviousValue,-this._errorMeasurementLastValue,o.bv(z))}_getMeshKey(u){return`${u.granularity.toString(36)}_${u.generateBorders?"b":""}${u.extendToNorthPole?"n":""}${u.extendToSouthPole?"s":""}`}getMeshFromTileID(u,g,w,C,L){const z=(L==="stencil"?Nr.stencil:Nr.tile).getGranularityForZoomLevel(g.z);return this._getMesh(u,{granularity:z,generateBorders:w,extendToNorthPole:g.y===0&&C,extendToSouthPole:g.y===(1<<g.z)-1&&C})}_getMesh(u,g){const w=this._getMeshKey(g);if(w in this._tileMeshCache)return this._tileMeshCache[w];const C=(function(L,z){const Y=lr(z,"16bit"),re=o.aW.deserialize({arrayBuffer:Y.vertices,length:Y.vertices.byteLength/2/2}),le=o.aY.deserialize({arrayBuffer:Y.indices,length:Y.indices.byteLength/2/3});return new fi(L.createVertexBuffer(re,$i.members),L.createIndexBuffer(le),o.aX.simpleSegment(0,0,re.length,le.length))})(u,g);return this._tileMeshCache[w]=C,C}recalculate(u){}hasTransition(){const u=T();let g=!1;return g=g||(u-this._errorMeasurementLastChangeTime)/1e3<.7,g=g||this._errorMeasurement&&this._errorMeasurement.awaitingQuery,g}setErrorQueryLatitudeDegrees(u){this._errorQueryLatitudeDegrees=u}}const Ln=new o.t({type:new o.D(o.u.projection.type)});class qn extends o.E{constructor(u){super(),this._transitionable=new o.x(Ln,void 0),this.setProjection(u),this._transitioning=this._transitionable.untransitioned(),this.recalculate(new o.H(0)),this._mercatorProjection=new hi,this._verticalPerspectiveProjection=new Zr}get transitionState(){const u=this.properties.get("type");if(typeof u=="string"&&u==="mercator")return 0;if(typeof u=="string"&&u==="vertical-perspective")return 1;if(u instanceof o.bw){if(u.from==="vertical-perspective"&&u.to==="mercator")return 1-u.transition;if(u.from==="mercator"&&u.to==="vertical-perspective")return u.transition}return 1}get useGlobeRendering(){return this.transitionState>0}get latitudeErrorCorrectionRadians(){return this._verticalPerspectiveProjection.latitudeErrorCorrectionRadians}get currentProjection(){return this.useGlobeRendering?this._verticalPerspectiveProjection:this._mercatorProjection}get name(){return"globe"}get useSubdivision(){return this.currentProjection.useSubdivision}get shaderVariantName(){return this.currentProjection.shaderVariantName}get shaderDefine(){return this.currentProjection.shaderDefine}get shaderPreludeCode(){return this.currentProjection.shaderPreludeCode}get vertexShaderPreludeCode(){return this.currentProjection.vertexShaderPreludeCode}get subdivisionGranularity(){return this.currentProjection.subdivisionGranularity}get useGlobeControls(){return this.transitionState>0}destroy(){this._mercatorProjection.destroy(),this._verticalPerspectiveProjection.destroy()}updateGPUdependent(u){this._mercatorProjection.updateGPUdependent(u),this._verticalPerspectiveProjection.updateGPUdependent(u)}getMeshFromTileID(u,g,w,C,L){return this.currentProjection.getMeshFromTileID(u,g,w,C,L)}setProjection(u){this._transitionable.setValue("type",u?.type||"mercator")}updateTransitions(u){this._transitioning=this._transitionable.transitioned(u,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()||this.currentProjection.hasTransition()}recalculate(u){this.properties=this._transitioning.possiblyEvaluate(u)}setErrorQueryLatitudeDegrees(u){this._verticalPerspectiveProjection.setErrorQueryLatitudeDegrees(u),this._mercatorProjection.setErrorQueryLatitudeDegrees(u)}}function Un(D){const u=Ui(D.worldSize,D.center.lat);return 2*Math.PI*u}function ui(D,u,g,w,C){const L=1/(1<<C),z=u/o.a5*L+w*L,Y=o.by((D/o.a5*L+g*L)*Math.PI*2+Math.PI,2*Math.PI),re=2*Math.atan(Math.exp(Math.PI-z*Math.PI*2))-.5*Math.PI,le=Math.cos(re),he=new Float64Array(3);return he[0]=Math.sin(Y)*le,he[1]=Math.sin(re),he[2]=Math.cos(Y)*le,he}function Hn(D){return(function(u,g){const w=Math.cos(g),C=new Float64Array(3);return C[0]=Math.sin(u)*w,C[1]=Math.sin(g),C[2]=Math.cos(u)*w,C})(D.lng*Math.PI/180,D.lat*Math.PI/180)}function Ui(D,u){return D/(2*Math.PI)/Math.cos(u*Math.PI/180)}function Xi(D){const u=Math.asin(D[1])/Math.PI*180,g=Math.sqrt(D[0]*D[0]+D[2]*D[2]);if(g>1e-6){const w=D[0]/g,C=Math.acos(D[2]/g),L=(w>0?C:-C)/Math.PI*180;return new o.V(o.W(L,-180,180),u)}return new o.V(0,u)}function ra(D){return Math.cos(D*Math.PI/180)}function Si(D,u){const g=ra(D),w=ra(u);return o.at(w/g)}function Ia(D,u){const g=D.rotate(u.bearingInRadians),w=u.zoom+Si(u.center.lat,0),C=o.bu(1/ra(u.center.lat),1/ra(Math.min(Math.abs(u.center.lat),60)),o.bx(w,7,3,0,1)),L=360/Un({worldSize:u.worldSize,center:{lat:u.center.lat}});return new o.V(u.center.lng-g.x*L*C,o.an(u.center.lat+g.y*L,-o.ao,o.ao))}function za(D){const u=.5*D,g=Math.sin(u),w=Math.cos(u);return Math.log(g+w)-Math.log(w-g)}function Hs(D,u,g,w){const C=D.lat+g*w;if(Math.abs(g)>1){const L=(Math.sign(D.lat+g)!==Math.sign(D.lat)?-Math.abs(D.lat):Math.abs(D.lat))*Math.PI/180,z=Math.abs(D.lat+g)*Math.PI/180,Y=za(L+w*(z-L)),re=za(L),le=za(z);return new o.V(D.lng+u*((Y-re)/(le-re)),C)}return new o.V(D.lng+u*w,C)}class ll{constructor(u){this._cachePrevious=new Map,this._cache=new Map,this._hadAnyChanges=!1,this._boundingVolumeFactory=u}swapBuffers(){if(!this._hadAnyChanges)return;const u=this._cachePrevious;this._cachePrevious=this._cache,this._cache=u,this._cache.clear(),this._hadAnyChanges=!1}getTileBoundingVolume(u,g,w,C){const L=`${u.z}_${u.x}_${u.y}_${C?.terrain?"t":""}`,z=this._cache.get(L);if(z)return z;const Y=this._cachePrevious.get(L);if(Y)return this._cache.set(L,Y),Y;const re=this._boundingVolumeFactory(u,g,w,C);return this._cache.set(L,re),this._hadAnyChanges=!0,re}}class Gs{constructor(u,g,w,C){this.min=w,this.max=C,this.points=u,this.planes=g}static fromAabb(u,g){const w=[];for(let C=0;C<8;C++)w.push([1&~C?u[0]:g[0],(C>>1&1)==1?g[1]:u[1],(C>>2&1)==1?g[2]:u[2]]);return new Gs(w,[[-1,0,0,g[0]],[1,0,0,-u[0]],[0,-1,0,g[1]],[0,1,0,-u[1]],[0,0,-1,g[2]],[0,0,1,-u[2]]],u,g)}static fromCenterSizeAngles(u,g,w){const C=o.bB([],w[0],w[1],w[2]),L=o.bC([],[g[0],0,0],C),z=o.bC([],[0,g[1],0],C),Y=o.bC([],[0,0,g[2]],C),re=[...u],le=[...u];for(let Pe=0;Pe<8;Pe++)for(let Ae=0;Ae<3;Ae++){const Ue=u[Ae]+L[Ae]*(1&~Pe?-1:1)+z[Ae]*((Pe>>1&1)==1?1:-1)+Y[Ae]*((Pe>>2&1)==1?1:-1);re[Ae]=Math.min(re[Ae],Ue),le[Ae]=Math.max(le[Ae],Ue)}const he=[];for(let Pe=0;Pe<8;Pe++){const Ae=[...u];o.b0(Ae,Ae,o.a$([],L,1&~Pe?-1:1)),o.b0(Ae,Ae,o.a$([],z,(Pe>>1&1)==1?1:-1)),o.b0(Ae,Ae,o.a$([],Y,(Pe>>2&1)==1?1:-1)),he.push(Ae)}return new Gs(he,[[...L,-o.b5(L,he[0])],[...z,-o.b5(z,he[0])],[...Y,-o.b5(Y,he[0])],[-L[0],-L[1],-L[2],-o.b5(L,he[7])],[-z[0],-z[1],-z[2],-o.b5(z,he[7])],[-Y[0],-Y[1],-Y[2],-o.b5(Y,he[7])]],re,le)}intersectsFrustum(u){let g=!0;const w=this.points.length,C=this.planes.length,L=u.planes.length,z=u.points.length;for(let Y=0;Y<L;Y++){const re=u.planes[Y];let le=0;for(let he=0;he<w;he++){const Pe=this.points[he];re[0]*Pe[0]+re[1]*Pe[1]+re[2]*Pe[2]+re[3]>=0&&le++}if(le===0)return 0;le<w&&(g=!1)}if(g)return 2;for(let Y=0;Y<C;Y++){const re=this.planes[Y];let le=0;for(let he=0;he<z;he++){const Pe=u.points[he];re[0]*Pe[0]+re[1]*Pe[1]+re[2]*Pe[2]+re[3]>=0&&le++}if(le===0)return 0}return 1}intersectsPlane(u){const g=this.points.length;let w=0;for(let C=0;C<g;C++){const L=this.points[C];u[0]*L[0]+u[1]*L[1]+u[2]*L[2]+u[3]>=0&&w++}return w===g?2:w===0?0:1}}function $o(D,u,g){const w=D-u;return w<0?-w:Math.max(0,w-g)}function Ws(D,u,g,w,C){const L=D-g;let z;return z=L<0?Math.min(-L,1+L-C):L>1?Math.min(Math.max(L-C,0),1-L):0,Math.max(z,$o(u,w,C))}class Pa{constructor(){this._boundingVolumeCache=new ll(this._computeTileBoundingVolume)}prepareNextFrame(){this._boundingVolumeCache.swapBuffers()}distanceToTile2d(u,g,w,C){const L=1<<w.z,z=1/L,Y=w.x/L,re=w.y/L;let le=2;return le=Math.min(le,Ws(u,g,Y,re,z)),le=Math.min(le,Ws(u,g,Y+.5,-re-z,z)),le=Math.min(le,Ws(u,g,Y+.5,2-re-z,z)),le}getWrap(u,g,w){const C=1<<g.z,L=1/C,z=g.x/C,Y=$o(u.x,z,L),re=$o(u.x,z-1,L),le=$o(u.x,z+1,L),he=Math.min(Y,re,le);return he===le?1:he===re?-1:0}allowVariableZoom(u,g){return un(u,g)>4}allowWorldCopies(){return!1}getTileBoundingVolume(u,g,w,C){return this._boundingVolumeCache.getTileBoundingVolume(u,g,w,C)}_computeTileBoundingVolume(u,g,w,C){var L,z;let Y=0,re=0;if(C?.terrain){const le=new o.a2(u.z,g,u.z,u.x,u.y),he=C.terrain.getMinMaxElevation(le);Y=(L=he.minElevation)!==null&&L!==void 0?L:Math.min(0,w),re=(z=he.maxElevation)!==null&&z!==void 0?z:Math.max(0,w)}if(Y/=o.bE,re/=o.bE,Y+=1,re+=1,u.z<=0)return Gs.fromAabb([-re,-re,-re],[re,re,re]);if(u.z===1)return Gs.fromAabb([u.x===0?-re:0,u.y===0?0:-re,-re],[u.x===0?0:re,u.y===0?re:0,re]);{const le=[ui(0,0,u.x,u.y,u.z),ui(o.a5,0,u.x,u.y,u.z),ui(o.a5,o.a5,u.x,u.y,u.z),ui(0,o.a5,u.x,u.y,u.z)],he=[];for(const _r of le)he.push(o.a$([],_r,re));if(re!==Y)for(const _r of le)he.push(o.a$([],_r,Y));u.y===0&&he.push([0,1,0]),u.y===(1<<u.z)-1&&he.push([0,-1,0]);const Pe=[1,1,1],Ae=[-1,-1,-1];for(const _r of he)for(let xr=0;xr<3;xr++)Pe[xr]=Math.min(Pe[xr],_r[xr]),Ae[xr]=Math.max(Ae[xr],_r[xr]);const Ue=ui(o.a5/2,o.a5/2,u.x,u.y,u.z),Ze=o.b4([],[0,1,0],Ue);o.b3(Ze,Ze);const ht=o.b4([],Ue,Ze);o.b3(ht,ht);const pt=o.b4([],le[2],le[1]);o.b3(pt,pt);const dt=o.b4([],le[0],le[3]);o.b3(dt,dt),he.push(o.a$([],Ue,re)),u.y>=(1<<u.z)/2&&he.push(o.a$([],ui(o.a5/2,0,u.x,u.y,u.z),re)),u.y<(1<<u.z)/2&&he.push(o.a$([],ui(o.a5/2,o.a5,u.x,u.y,u.z),re));const xt=Xs(Ue,he),Nt=Xs(ht,he),wt=[-Ue[0],-Ue[1],-Ue[2],xt.max],Lt=[Ue[0],Ue[1],Ue[2],-xt.min],jt=[-ht[0],-ht[1],-ht[2],Nt.max],Dt=[ht[0],ht[1],ht[2],-Nt.min],Zt=[...pt,0],Sr=[...dt,0],pr=[];return u.y===0?pr.push(o.bD(Sr,Zt,wt),o.bD(Sr,Zt,Lt)):pr.push(o.bD(jt,Zt,wt),o.bD(jt,Zt,Lt),o.bD(jt,Sr,wt),o.bD(jt,Sr,Lt)),u.y===(1<<u.z)-1?pr.push(o.bD(Sr,Zt,wt),o.bD(Sr,Zt,Lt)):pr.push(o.bD(Dt,Zt,wt),o.bD(Dt,Zt,Lt),o.bD(Dt,Sr,wt),o.bD(Dt,Sr,Lt)),new Gs(pr,[wt,Lt,jt,Dt,Zt,Sr],Pe,Ae)}}}function Xs(D,u){let g=1/0,w=-1/0;for(const C of u){const L=o.b5(D,C);g=Math.min(g,L),w=Math.max(w,L)}return{min:g,max:w}}class Il{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(u){this._helper.setMinZoom(u)}setMaxZoom(u){this._helper.setMaxZoom(u)}setMinPitch(u){this._helper.setMinPitch(u)}setMaxPitch(u){this._helper.setMaxPitch(u)}setRenderWorldCopies(u){this._helper.setRenderWorldCopies(u)}setBearing(u){this._helper.setBearing(u)}setPitch(u){this._helper.setPitch(u)}setRoll(u){this._helper.setRoll(u)}setFov(u){this._helper.setFov(u)}setZoom(u){this._helper.setZoom(u)}setCenter(u){this._helper.setCenter(u)}setElevation(u){this._helper.setElevation(u)}setMinElevationForCurrentTile(u){this._helper.setMinElevationForCurrentTile(u)}setPadding(u){this._helper.setPadding(u)}interpolatePadding(u,g,w){return this._helper.interpolatePadding(u,g,w)}isPaddingEqual(u){return this._helper.isPaddingEqual(u)}resize(u,g){this._helper.resize(u,g)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(u){this._helper.setMaxBounds(u)}setConstrainOverride(u){this._helper.setConstrainOverride(u)}overrideNearFarZ(u,g){this._helper.overrideNearFarZ(u,g)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(u){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),u)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get constrainOverride(){return this._helper.constrainOverride}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}setTransitionState(u){}constructor(u){this._cachedClippingPlane=o.bF(),this._projectionMatrix=o.bj(),this._globeViewProjMatrix32f=o.bi(),this._globeViewProjMatrixNoCorrection=o.bj(),this._globeViewProjMatrixNoCorrectionInverted=o.bj(),this._globeProjMatrixInverted=o.bj(),this._cameraPosition=o.bz(),this._globeLatitudeErrorCorrectionRadians=0,this.defaultConstrain=(g,w)=>{const C=o.an(g.lat,-o.ao,o.ao),L=o.an(+w,this.minZoom+Si(0,C),this.maxZoom);return{center:new o.V(g.lng,C),zoom:L}},this.applyConstrain=(g,w)=>this._helper.applyConstrain(g,w),this._helper=new Cs({calcMatrices:()=>{this._calcMatrices()},defaultConstrain:(g,w)=>this.defaultConstrain(g,w)},u),this._coveringTilesDetailsProvider=new Pa}clone(){const u=new Il;return u.apply(this,!1),u}apply(u,g,w){this._globeLatitudeErrorCorrectionRadians=w||0,this._helper.apply(u,g)}get projectionMatrix(){return this._projectionMatrix}get modelViewProjectionMatrix(){return this._globeViewProjMatrixNoCorrection}get inverseProjectionMatrix(){return this._globeProjMatrixInverted}get cameraPosition(){const u=o.bz();return u[0]=this._cameraPosition[0],u[1]=this._cameraPosition[1],u[2]=this._cameraPosition[2],u}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}getProjectionData(u){const{overscaledTileID:g,applyGlobeMatrix:w}=u,C=this._helper.getMercatorTileCoordinates(g);return{mainMatrix:this._globeViewProjMatrix32f,tileMercatorCoords:C,clippingPlane:this._cachedClippingPlane,projectionTransition:w?1:0,fallbackMatrix:this._globeViewProjMatrix32f}}_computeClippingPlane(u){const g=this.pitchInRadians,w=this.cameraToCenterDistance/u,C=Math.sin(g)*w,L=Math.cos(g)*w+1,z=1/Math.sqrt(C*C+L*L)*1;let Y=-C,re=L;const le=Math.sqrt(Y*Y+re*re);Y/=le,re/=le;const he=[0,Y,re];o.bG(he,he,[0,0,0],-this.bearingInRadians),o.bH(he,he,[0,0,0],-1*this.center.lat*Math.PI/180),o.bI(he,he,[0,0,0],this.center.lng*Math.PI/180);const Pe=1/o.b7(he);return o.a$(he,he,Pe),[...he,-z*Pe]}isLocationOccluded(u){return!this.isSurfacePointVisible(Hn(u))}transformLightDirection(u){const g=this._helper._center.lng*Math.PI/180,w=this._helper._center.lat*Math.PI/180,C=Math.cos(w),L=[Math.sin(g)*C,Math.sin(w),Math.cos(g)*C],z=[L[2],0,-L[0]],Y=[0,0,0];o.b4(Y,z,L),o.b3(z,z),o.b3(Y,Y);const re=[0,0,0];return o.b3(re,[z[0]*u[0]+Y[0]*u[1]+L[0]*u[2],z[1]*u[0]+Y[1]*u[1]+L[1]*u[2],z[2]*u[0]+Y[2]*u[1]+L[2]*u[2]]),re}getPixelScale(){return 1/Math.cos(this._helper._center.lat*Math.PI/180)}getCircleRadiusCorrection(){return Math.cos(this._helper._center.lat*Math.PI/180)}getPitchedTextCorrection(u,g,w){const C=(function(Y,re,le){const he=1/(1<<le.z);return new o.a9(Y/o.a5*he+le.x*he,re/o.a5*he+le.y*he)})(u,g,w.canonical),L=(z=C.y,[o.by(C.x*Math.PI*2+Math.PI,2*Math.PI),2*Math.atan(Math.exp(Math.PI-z*Math.PI*2))-.5*Math.PI]);var z;return this.getCircleRadiusCorrection()/Math.cos(L[1])}projectTileCoordinates(u,g,w,C){const L=w.canonical,z=ui(u,g,L.x,L.y,L.z),Y=1+(C?C(u,g):0)/o.bE,re=[z[0]*Y,z[1]*Y,z[2]*Y,1];o.aH(re,re,this._globeViewProjMatrixNoCorrection);const le=this._cachedClippingPlane,he=le[0]*z[0]+le[1]*z[1]+le[2]*z[2]+le[3]<0;return{point:new o.P(re[0]/re[3],re[1]/re[3]),signedDistanceFromCamera:re[3],isOccluded:he}}_calcMatrices(){if(!this._helper._width||!this._helper._height)return;const u=Ui(this.worldSize,this.center.lat),g=o.bk(),w=o.bk();this._helper.autoCalculateNearFarZ&&(this._helper._nearZ=.5,this._helper._farZ=this.cameraToCenterDistance+2*u),o.be(g,this.fovInRadians,this.width/this.height,this._helper._nearZ,this._helper._farZ);const C=this.centerOffset;g[8]=2*-C.x/this._helper._width,g[9]=2*C.y/this._helper._height,this._projectionMatrix=o.bf(g),this._globeProjMatrixInverted=o.bk(),o.aB(this._globeProjMatrixInverted,g),o.O(g,g,[0,0,-this.cameraToCenterDistance]),o.bg(g,g,this.rollInRadians),o.bh(g,g,-this.pitchInRadians),o.bg(g,g,this.bearingInRadians),o.O(g,g,[0,0,-u]);const L=o.bz();L[0]=u,L[1]=u,L[2]=u,o.bh(w,g,this.center.lat*Math.PI/180),o.bJ(w,w,-this.center.lng*Math.PI/180),o.Q(w,w,L),this._globeViewProjMatrixNoCorrection=w,o.bh(g,g,this.center.lat*Math.PI/180-this._globeLatitudeErrorCorrectionRadians),o.bJ(g,g,-this.center.lng*Math.PI/180),o.Q(g,g,L),this._globeViewProjMatrix32f=new Float32Array(g),this._globeViewProjMatrixNoCorrectionInverted=o.bk(),o.aB(this._globeViewProjMatrixNoCorrectionInverted,w);const z=o.bz();this._cameraPosition=o.bz(),this._cameraPosition[2]=this.cameraToCenterDistance/u,o.bG(this._cameraPosition,this._cameraPosition,z,-this.rollInRadians),o.bH(this._cameraPosition,this._cameraPosition,z,this.pitchInRadians),o.bG(this._cameraPosition,this._cameraPosition,z,-this.bearingInRadians),o.b0(this._cameraPosition,this._cameraPosition,[0,0,1]),o.bH(this._cameraPosition,this._cameraPosition,z,-this.center.lat*Math.PI/180),o.bI(this._cameraPosition,this._cameraPosition,z,this.center.lng*Math.PI/180),this._cachedClippingPlane=this._computeClippingPlane(u);const Y=o.bf(this._globeViewProjMatrixNoCorrectionInverted);o.Q(Y,Y,[1,1,-1]),this._cachedFrustum=Ka.fromInvProjectionMatrix(Y,1,0,this._cachedClippingPlane,!0)}calculateFogMatrix(u){o.w("calculateFogMatrix is not supported on globe projection.");const g=o.bk();return o.ar(g),g}getVisibleUnwrappedCoordinates(u){return[new o.bc(0,u)]}getCameraFrustum(){return this._cachedFrustum}getClippingPlane(){return this._cachedClippingPlane}getCoveringTilesDetailsProvider(){return this._coveringTilesDetailsProvider}recalculateZoomAndCenter(u){u&&o.w("terrain is not fully supported on vertical perspective projection."),this._helper.recalculateZoomAndCenter(0)}maxPitchScaleFactor(){return 1}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){return this._helper.getCameraLngLat()}lngLatToCameraDepth(u,g){if(!this._globeViewProjMatrixNoCorrection)return 1;const w=Hn(u);o.a$(w,w,1+g/o.bE);const C=o.bF();return o.aH(C,[w[0],w[1],w[2],1],this._globeViewProjMatrixNoCorrection),C[2]/C[3]}populateCache(u){}getBounds(){const u=.5*this.width,g=.5*this.height,w=[new o.P(0,0),new o.P(u,0),new o.P(this.width,0),new o.P(this.width,g),new o.P(this.width,this.height),new o.P(u,this.height),new o.P(0,this.height),new o.P(0,g)],C=[];for(const Pe of w)C.push(this.unprojectScreenPoint(Pe));let L=0,z=0,Y=0,re=0;const le=this.center;for(const Pe of C){const Ae=o.bK(le.lng,Pe.lng),Ue=o.bK(le.lat,Pe.lat);Ae<z&&(z=Ae),Ae>L&&(L=Ae),Ue<re&&(re=Ue),Ue>Y&&(Y=Ue)}const he=[le.lng+z,le.lat+re,le.lng+L,le.lat+Y];return this.isSurfacePointOnScreen([0,1,0])&&(he[3]=90,he[0]=-180,he[2]=180),this.isSurfacePointOnScreen([0,-1,0])&&(he[1]=-90,he[0]=-180,he[2]=180),new $t(he)}calculateCenterFromCameraLngLatAlt(u,g,w,C){return this._helper.calculateCenterFromCameraLngLatAlt(u,g,w,C)}setLocationAtPoint(u,g){const w=Hn(this.unprojectScreenPoint(g)),C=Hn(u),L=o.bz();o.bL(L);const z=o.bz();o.bI(z,w,L,-this.center.lng*Math.PI/180),o.bH(z,z,L,this.center.lat*Math.PI/180);const Y=C[0]*C[0]+C[2]*C[2],re=z[0]*z[0];if(Y<re)return;const le=Math.sqrt(Y-re),he=-le,Pe=o.bM(C[0],C[2],z[0],le),Ae=o.bM(C[0],C[2],z[0],he),Ue=o.bz();o.bI(Ue,C,L,-Pe);const Ze=o.bM(Ue[1],Ue[2],z[1],z[2]),ht=o.bz();o.bI(ht,C,L,-Ae);const pt=o.bM(ht[1],ht[2],z[1],z[2]),dt=.5*Math.PI,xt=Ze>=-dt&&Ze<=dt,Nt=pt>=-dt&&pt<=dt;let wt,Lt;if(xt&&Nt){const Sr=this.center.lng*Math.PI/180,pr=this.center.lat*Math.PI/180;o.bN(Pe,Sr)+o.bN(Ze,pr)<o.bN(Ae,Sr)+o.bN(pt,pr)?(wt=Pe,Lt=Ze):(wt=Ae,Lt=pt)}else if(xt)wt=Pe,Lt=Ze;else{if(!Nt)return;wt=Ae,Lt=pt}const jt=wt/Math.PI*180,Dt=Lt/Math.PI*180,Zt=this.center.lat;this.setCenter(new o.V(jt,o.an(Dt,-90,90))),this.setZoom(this.zoom+Si(Zt,this.center.lat))}locationToScreenPoint(u,g){const w=Hn(u);if(g){const C=g.getElevationForLngLatZoom(u,this._helper._tileZoom);o.a$(w,w,1+C/o.bE)}return this._projectSurfacePointToScreen(w)}_projectSurfacePointToScreen(u){const g=o.bF();return o.aH(g,[...u,1],this._globeViewProjMatrixNoCorrection),g[0]/=g[3],g[1]/=g[3],new o.P((.5*g[0]+.5)*this.width,(.5*-g[1]+.5)*this.height)}screenPointToMercatorCoordinate(u,g){if(g){const w=g.pointCoordinate(u);if(w)return w}return o.a9.fromLngLat(this.unprojectScreenPoint(u))}screenPointToLocation(u,g){var w;return(w=this.screenPointToMercatorCoordinate(u,g))===null||w===void 0?void 0:w.toLngLat()}isPointOnMapSurface(u,g){const w=this._cameraPosition,C=this.getRayDirectionFromPixel(u);return!!this.rayPlanetIntersection(w,C)}getRayDirectionFromPixel(u){const g=o.bF();g[0]=u.x/this.width*2-1,g[1]=-1*(u.y/this.height*2-1),g[2]=1,g[3]=1,o.aH(g,g,this._globeViewProjMatrixNoCorrectionInverted),g[0]/=g[3],g[1]/=g[3],g[2]/=g[3];const w=o.bz();w[0]=g[0]-this._cameraPosition[0],w[1]=g[1]-this._cameraPosition[1],w[2]=g[2]-this._cameraPosition[2];const C=o.bz();return o.b3(C,w),C}isSurfacePointVisible(u){const g=this._cachedClippingPlane;return g[0]*u[0]+g[1]*u[1]+g[2]*u[2]+g[3]>=0}isSurfacePointOnScreen(u){if(!this.isSurfacePointVisible(u))return!1;const g=o.bF();return o.aH(g,[...u,1],this._globeViewProjMatrixNoCorrection),g[0]/=g[3],g[1]/=g[3],g[2]/=g[3],g[0]>-1&&g[0]<1&&g[1]>-1&&g[1]<1&&g[2]>-1&&g[2]<1}rayPlanetIntersection(u,g){const w=o.b5(u,g),C=o.bz(),L=o.bz();o.a$(L,g,w),o.b2(C,u,L);const z=1-o.b5(C,C);if(z<0)return null;const Y=o.b5(u,u)-1,re=-w+(w<0?1:-1)*Math.sqrt(z),le=Y/re,he=re;return{tMin:Math.min(le,he),tMax:Math.max(le,he)}}unprojectScreenPoint(u){const g=this._cameraPosition,w=this.getRayDirectionFromPixel(u),C=this.rayPlanetIntersection(g,w);if(C){const he=o.bz();o.b0(he,g,[w[0]*C.tMin,w[1]*C.tMin,w[2]*C.tMin]);const Pe=o.bz();return o.b3(Pe,he),Xi(Pe)}const L=this._cachedClippingPlane,z=L[0]*w[0]+L[1]*w[1]+L[2]*w[2],Y=-o.bb(L,g)/z,re=o.bz();if(Y>0)o.b0(re,g,[w[0]*Y,w[1]*Y,w[2]*Y]);else{const he=o.bz();o.b0(he,g,[2*w[0],2*w[1],2*w[2]]);const Pe=o.bb(this._cachedClippingPlane,he);o.b2(re,he,[this._cachedClippingPlane[0]*Pe,this._cachedClippingPlane[1]*Pe,this._cachedClippingPlane[2]*Pe])}const le=(function(he){const Pe=o.bz();return Pe[0]=he[0]*-he[3],Pe[1]=he[1]*-he[3],Pe[2]=he[2]*-he[3],{center:Pe,radius:Math.sqrt(1-he[3]*he[3])}})(L);return Xi((function(he,Pe,Ae){const Ue=o.bz();o.b2(Ue,Ae,he);const Ze=o.bz();return o.bA(Ze,he,Ue,Pe/o.b9(Ue)),Ze})(le.center,le.radius,re))}getMatrixForModel(u,g){const w=o.V.convert(u),C=1/o.bE,L=o.bj();return o.bJ(L,L,w.lng/180*Math.PI),o.bh(L,L,-w.lat/180*Math.PI),o.O(L,L,[0,0,1+g/o.bE]),o.bh(L,L,.5*Math.PI),o.Q(L,L,[C,C,C]),L}getProjectionDataForCustomLayer(u=!0){const g=this.getProjectionData({overscaledTileID:new o.a2(0,0,0,0,0),applyGlobeMatrix:u});return g.tileMercatorCoords=[0,0,1,1],g}getFastPathSimpleProjectionMatrix(u){}}class gs{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(u){this._helper.setMinZoom(u)}setMaxZoom(u){this._helper.setMaxZoom(u)}setMinPitch(u){this._helper.setMinPitch(u)}setMaxPitch(u){this._helper.setMaxPitch(u)}setRenderWorldCopies(u){this._helper.setRenderWorldCopies(u)}setBearing(u){this._helper.setBearing(u)}setPitch(u){this._helper.setPitch(u)}setRoll(u){this._helper.setRoll(u)}setFov(u){this._helper.setFov(u)}setZoom(u){this._helper.setZoom(u)}setCenter(u){this._helper.setCenter(u)}setElevation(u){this._helper.setElevation(u)}setMinElevationForCurrentTile(u){this._helper.setMinElevationForCurrentTile(u)}setPadding(u){this._helper.setPadding(u)}interpolatePadding(u,g,w){return this._helper.interpolatePadding(u,g,w)}isPaddingEqual(u){return this._helper.isPaddingEqual(u)}resize(u,g,w=!0){this._helper.resize(u,g,w)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(u){this._helper.setMaxBounds(u)}setConstrainOverride(u){this._helper.setConstrainOverride(u)}overrideNearFarZ(u,g){this._helper.overrideNearFarZ(u,g)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(u){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),u)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}get constrainOverride(){return this._helper.constrainOverride}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}get isGlobeRendering(){return this._globeness>0}setTransitionState(u,g){this._globeness=u,this._globeLatitudeErrorCorrectionRadians=g,this._calcMatrices(),this._verticalPerspectiveTransform.getCoveringTilesDetailsProvider().prepareNextFrame(),this._mercatorTransform.getCoveringTilesDetailsProvider().prepareNextFrame()}get currentTransform(){return this.isGlobeRendering?this._verticalPerspectiveTransform:this._mercatorTransform}constructor(u){this._globeLatitudeErrorCorrectionRadians=0,this._globeness=1,this.defaultConstrain=(g,w)=>this.currentTransform.defaultConstrain(g,w),this.applyConstrain=(g,w)=>this._helper.applyConstrain(g,w),this._helper=new Cs({calcMatrices:()=>{this._calcMatrices()},defaultConstrain:(g,w)=>this.defaultConstrain(g,w)},u),this._globeness=1,this._mercatorTransform=new $s,this._verticalPerspectiveTransform=new Il}clone(){const u=new gs;return u._globeness=this._globeness,u._globeLatitudeErrorCorrectionRadians=this._globeLatitudeErrorCorrectionRadians,u.apply(this,!1),u}apply(u,g){this._helper.apply(u,g),this._mercatorTransform.apply(this,!1),this._verticalPerspectiveTransform.apply(this,!1,this._globeLatitudeErrorCorrectionRadians)}get projectionMatrix(){return this.currentTransform.projectionMatrix}get modelViewProjectionMatrix(){return this.currentTransform.modelViewProjectionMatrix}get inverseProjectionMatrix(){return this.currentTransform.inverseProjectionMatrix}get cameraPosition(){return this.currentTransform.cameraPosition}getProjectionData(u){const g=this._mercatorTransform.getProjectionData(u),w=this._verticalPerspectiveTransform.getProjectionData(u);return{mainMatrix:this.isGlobeRendering?w.mainMatrix:g.mainMatrix,clippingPlane:w.clippingPlane,tileMercatorCoords:w.tileMercatorCoords,projectionTransition:u.applyGlobeMatrix?this._globeness:0,fallbackMatrix:g.fallbackMatrix}}isLocationOccluded(u){return this.currentTransform.isLocationOccluded(u)}transformLightDirection(u){return this.currentTransform.transformLightDirection(u)}getPixelScale(){return o.bu(this._mercatorTransform.getPixelScale(),this._verticalPerspectiveTransform.getPixelScale(),this._globeness)}getCircleRadiusCorrection(){return o.bu(this._mercatorTransform.getCircleRadiusCorrection(),this._verticalPerspectiveTransform.getCircleRadiusCorrection(),this._globeness)}getPitchedTextCorrection(u,g,w){const C=this._mercatorTransform.getPitchedTextCorrection(u,g,w),L=this._verticalPerspectiveTransform.getPitchedTextCorrection(u,g,w);return o.bu(C,L,this._globeness)}projectTileCoordinates(u,g,w,C){return this.currentTransform.projectTileCoordinates(u,g,w,C)}_calcMatrices(){this._helper._width&&this._helper._height&&(this._verticalPerspectiveTransform.apply(this,!1,this._globeLatitudeErrorCorrectionRadians),this._helper._nearZ=this._verticalPerspectiveTransform.nearZ,this._helper._farZ=this._verticalPerspectiveTransform.farZ,this._mercatorTransform.apply(this,!0,this.isGlobeRendering),this._helper._nearZ=this._mercatorTransform.nearZ,this._helper._farZ=this._mercatorTransform.farZ)}calculateFogMatrix(u){return this.currentTransform.calculateFogMatrix(u)}getVisibleUnwrappedCoordinates(u){return this.currentTransform.getVisibleUnwrappedCoordinates(u)}getCameraFrustum(){return this.currentTransform.getCameraFrustum()}getClippingPlane(){return this.currentTransform.getClippingPlane()}getCoveringTilesDetailsProvider(){return this.currentTransform.getCoveringTilesDetailsProvider()}recalculateZoomAndCenter(u){this._mercatorTransform.recalculateZoomAndCenter(u),this._verticalPerspectiveTransform.recalculateZoomAndCenter(u)}maxPitchScaleFactor(){return this._mercatorTransform.maxPitchScaleFactor()}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){return this._helper.getCameraLngLat()}lngLatToCameraDepth(u,g){return this.currentTransform.lngLatToCameraDepth(u,g)}populateCache(u){this._mercatorTransform.populateCache(u),this._verticalPerspectiveTransform.populateCache(u)}getBounds(){return this.currentTransform.getBounds()}calculateCenterFromCameraLngLatAlt(u,g,w,C){return this._helper.calculateCenterFromCameraLngLatAlt(u,g,w,C)}setLocationAtPoint(u,g){if(!this.isGlobeRendering)return this._mercatorTransform.setLocationAtPoint(u,g),void this.apply(this._mercatorTransform,!1);this._verticalPerspectiveTransform.setLocationAtPoint(u,g),this.apply(this._verticalPerspectiveTransform,!1)}locationToScreenPoint(u,g){return this.currentTransform.locationToScreenPoint(u,g)}screenPointToMercatorCoordinate(u,g){return this.currentTransform.screenPointToMercatorCoordinate(u,g)}screenPointToLocation(u,g){return this.currentTransform.screenPointToLocation(u,g)}isPointOnMapSurface(u,g){return this.currentTransform.isPointOnMapSurface(u,g)}getRayDirectionFromPixel(u){return this._verticalPerspectiveTransform.getRayDirectionFromPixel(u)}getMatrixForModel(u,g){return this.currentTransform.getMatrixForModel(u,g)}getProjectionDataForCustomLayer(u=!0){const g=this._mercatorTransform.getProjectionDataForCustomLayer(u);if(!this.isGlobeRendering)return g;const w=this._verticalPerspectiveTransform.getProjectionDataForCustomLayer(u);return w.fallbackMatrix=g.mainMatrix,w}getFastPathSimpleProjectionMatrix(u){return this.currentTransform.getFastPathSimpleProjectionMatrix(u)}}class Di{get useGlobeControls(){return!0}handlePanInertia(u,g){const w=Ia(u,g);return Math.abs(w.lng-g.center.lng)>180&&(w.lng=g.center.lng+179.5*Math.sign(w.lng-g.center.lng)),{easingCenter:w,easingOffset:new o.P(0,0)}}handleMapControlsRollPitchBearingZoom(u,g){const w=u.around,C=g.screenPointToLocation(w);u.bearingDelta&&g.setBearing(g.bearing+u.bearingDelta),u.pitchDelta&&g.setPitch(g.pitch+u.pitchDelta),u.rollDelta&&g.setRoll(g.roll+u.rollDelta);const L=g.zoom;u.zoomDelta&&g.setZoom(g.zoom+u.zoomDelta);const z=g.zoom-L;if(z===0)return;const Y=o.bK(g.center.lng,C.lng),re=Y/(Math.abs(Y/180)+1),le=o.bK(g.center.lat,C.lat),he=g.getRayDirectionFromPixel(w),Pe=g.cameraPosition,Ae=-1*o.b5(Pe,he),Ue=o.bz();o.b0(Ue,Pe,[he[0]*Ae,he[1]*Ae,he[2]*Ae]);const Ze=o.b7(Ue)-1,ht=Math.exp(.5*-Math.max(Ze-.3,0)),pt=Ui(g.worldSize,g.center.lat)/Math.min(g.width,g.height),dt=o.bx(pt,.9,.5,1,.25),xt=(1-o.aq(-z))*Math.min(ht,dt),Nt=g.center.lat,wt=g.zoom,Lt=new o.V(g.center.lng+re*xt,o.an(g.center.lat+le*xt,-o.ao,o.ao));g.setLocationAtPoint(C,w);const jt=g.center,Dt=o.bx(Math.abs(Y),45,85,0,1),Zt=o.bx(pt,.75,.35,0,1),Sr=Math.pow(Math.max(Dt,Zt),.25),pr=o.bK(jt.lng,Lt.lng),_r=o.bK(jt.lat,Lt.lat);g.setCenter(new o.V(jt.lng+pr*Sr,jt.lat+_r*Sr).wrap()),g.setZoom(wt+Si(Nt,g.center.lat))}handleMapControlsPan(u,g,w){if(!u.panDelta)return;const C=g.center.lat,L=g.zoom;g.setCenter(Ia(u.panDelta,g).wrap()),g.setZoom(L+Si(C,g.center.lat))}cameraForBoxAndBearing(u,g,w,C,L){const z=Mu(u,g,w,C,L),Y=g.left/L.width*2-1,re=(L.width-g.right)/L.width*2-1,le=g.top/L.height*-2+1,he=(L.height-g.bottom)/L.height*-2+1,Pe=o.bK(w.getWest(),w.getEast())<0,Ae=Pe?w.getEast():w.getWest(),Ue=Pe?w.getWest():w.getEast(),Ze=Math.max(w.getNorth(),w.getSouth()),ht=Math.min(w.getNorth(),w.getSouth()),pt=Ae+.5*o.bK(Ae,Ue),dt=Ze+.5*o.bK(Ze,ht),xt=L.clone();xt.setCenter(z.center),xt.setBearing(z.bearing),xt.setPitch(0),xt.setRoll(0),xt.setZoom(z.zoom);const Nt=xt.modelViewProjectionMatrix,wt=[Hn(w.getNorthWest()),Hn(w.getNorthEast()),Hn(w.getSouthWest()),Hn(w.getSouthEast()),Hn(new o.V(Ue,dt)),Hn(new o.V(Ae,dt)),Hn(new o.V(pt,Ze)),Hn(new o.V(pt,ht))],Lt=Hn(z.center);let jt=Number.POSITIVE_INFINITY;for(const Dt of wt)Y<0&&(jt=Di.getLesserNonNegativeNonNull(jt,Di.solveVectorScale(Dt,Lt,Nt,"x",Y))),re>0&&(jt=Di.getLesserNonNegativeNonNull(jt,Di.solveVectorScale(Dt,Lt,Nt,"x",re))),le>0&&(jt=Di.getLesserNonNegativeNonNull(jt,Di.solveVectorScale(Dt,Lt,Nt,"y",le))),he<0&&(jt=Di.getLesserNonNegativeNonNull(jt,Di.solveVectorScale(Dt,Lt,Nt,"y",he)));if(Number.isFinite(jt)&&jt!==0)return z.zoom=xt.zoom+o.at(jt),z;Vo()}handleJumpToCenterZoom(u,g){const w=u.center.lat,C=u.applyConstrain(g.center?o.V.convert(g.center):u.center,u.zoom).center;u.setCenter(C.wrap());const L=g.zoom!==void 0?+g.zoom:u.zoom+Si(w,C.lat);u.zoom!==L&&u.setZoom(L)}handleEaseTo(u,g){const w=u.zoom,C=u.center,L=u.padding,z={roll:u.roll,pitch:u.pitch,bearing:u.bearing},Y={roll:g.roll===void 0?u.roll:g.roll,pitch:g.pitch===void 0?u.pitch:g.pitch,bearing:g.bearing===void 0?u.bearing:g.bearing},re=g.zoom!==void 0,le=!u.isPaddingEqual(g.padding);let he=!1;const Pe=g.center?o.V.convert(g.center):C,Ae=u.applyConstrain(Pe,w).center;Vs(u,Ae);const Ue=u.clone();Ue.setCenter(Ae),Ue.setZoom(re?+g.zoom:w+Si(C.lat,Pe.lat)),Ue.setBearing(g.bearing);const Ze=new o.P(o.an(u.centerPoint.x+g.offsetAsPoint.x,0,u.width),o.an(u.centerPoint.y+g.offsetAsPoint.y,0,u.height));Ue.setLocationAtPoint(Ae,Ze);const ht=(g.offset&&g.offsetAsPoint.mag())>0?Ue.center:Ae,pt=re?+g.zoom:w+Si(C.lat,ht.lat),dt=w+Si(C.lat,0),xt=pt+Si(ht.lat,0),Nt=o.bK(C.lng,ht.lng),wt=o.bK(C.lat,ht.lat),Lt=o.aq(xt-dt);return he=pt!==w,{easeFunc:jt=>{if(o.bo(z,Y)||Ru({startEulerAngles:z,endEulerAngles:Y,tr:u,k:jt,useSlerp:z.roll!=Y.roll}),le&&u.interpolatePadding(L,g.padding,jt),g.around)o.w("Easing around a point is not supported under globe projection."),u.setLocationAtPoint(g.around,g.aroundPoint);else{const Dt=xt>dt?Math.min(2,Lt):Math.max(.5,Lt),Zt=Math.pow(Dt,1-jt),Sr=Hs(C,Nt,wt,jt*Zt);u.setCenter(Sr.wrap())}if(he){const Dt=o.G.number(dt,xt,jt)+Si(0,u.center.lat);u.setZoom(Dt)}},isZooming:he,elevationCenter:ht}}handleFlyTo(u,g){const w=g.zoom!==void 0,C=u.center,L=u.zoom,z=u.padding,Y=!u.isPaddingEqual(g.padding),re=u.applyConstrain(o.V.convert(g.center||g.locationAtOffset),L).center,le=w?+g.zoom:u.zoom+Si(u.center.lat,re.lat),he=u.clone();he.setCenter(re),he.setZoom(le),he.setBearing(g.bearing);const Pe=new o.P(o.an(u.centerPoint.x+g.offsetAsPoint.x,0,u.width),o.an(u.centerPoint.y+g.offsetAsPoint.y,0,u.height));he.setLocationAtPoint(re,Pe);const Ae=he.center;Vs(u,Ae);const Ue=(function(wt,Lt,jt){const Dt=Hn(Lt),Zt=Hn(jt),Sr=o.b5(Dt,Zt),pr=Math.acos(Sr),_r=Un(wt);return pr/(2*Math.PI)*_r})(u,C,Ae),Ze=L+Si(C.lat,0),ht=le+Si(Ae.lat,0),pt=o.aq(ht-Ze);let dt;if(typeof g.minZoom=="number"){const wt=+g.minZoom+Si(Ae.lat,0),Lt=Math.min(wt,Ze,ht)+Si(0,Ae.lat),jt=u.applyConstrain(Ae,Lt).zoom+Si(Ae.lat,0);dt=o.aq(jt-Ze)}const xt=o.bK(C.lng,Ae.lng),Nt=o.bK(C.lat,Ae.lat);return{easeFunc:(wt,Lt,jt,Dt)=>{const Zt=Hs(C,xt,Nt,jt);Y&&u.interpolatePadding(z,g.padding,wt);const Sr=wt===1?Ae:Zt;u.setCenter(Sr.wrap());const pr=Ze+o.at(Lt);u.setZoom(wt===1?le:pr+Si(0,Sr.lat))},scaleOfZoom:pt,targetCenter:Ae,scaleOfMinZoom:dt,pixelPathLength:Ue}}static solveVectorScale(u,g,w,C,L){const z=C==="x"?[w[0],w[4],w[8],w[12]]:[w[1],w[5],w[9],w[13]],Y=[w[3],w[7],w[11],w[15]],re=u[0]*z[0]+u[1]*z[1]+u[2]*z[2],le=u[0]*Y[0]+u[1]*Y[1]+u[2]*Y[2],he=g[0]*z[0]+g[1]*z[1]+g[2]*z[2],Pe=g[0]*Y[0]+g[1]*Y[1]+g[2]*Y[2];return he+L*le===re+L*Pe||Y[3]*(re-he)+z[3]*(Pe-le)+re*Pe==he*le?null:(he+z[3]-L*Pe-L*Y[3])/(he-re-L*Pe+L*le)}static getLesserNonNegativeNonNull(u,g){return g!==null&&g>=0&&g<u?g:u}}class qo{constructor(u){this._globe=u,this._mercatorCameraHelper=new go,this._verticalPerspectiveCameraHelper=new Di}get useGlobeControls(){return this._globe.useGlobeRendering}get currentHelper(){return this.useGlobeControls?this._verticalPerspectiveCameraHelper:this._mercatorCameraHelper}handlePanInertia(u,g){return this.currentHelper.handlePanInertia(u,g)}handleMapControlsRollPitchBearingZoom(u,g){return this.currentHelper.handleMapControlsRollPitchBearingZoom(u,g)}handleMapControlsPan(u,g,w){this.currentHelper.handleMapControlsPan(u,g,w)}cameraForBoxAndBearing(u,g,w,C,L){return this.currentHelper.cameraForBoxAndBearing(u,g,w,C,L)}handleJumpToCenterZoom(u,g){this.currentHelper.handleJumpToCenterZoom(u,g)}handleEaseTo(u,g){return this.currentHelper.handleEaseTo(u,g)}handleFlyTo(u,g){return this.currentHelper.handleFlyTo(u,g)}}const Da=(D,u)=>o.B(D,u&&u.filter((g=>g.identifier!=="source.canvas"))),ns=o.bO();class As extends o.E{constructor(u,g={}){var w,C;super(),this._rtlPluginLoaded=()=>{for(const z in this.tileManagers){const Y=this.tileManagers[z].getSource().type;Y!=="vector"&&Y!=="geojson"||this.tileManagers[z].reload()}},this.map=u,this.dispatcher=new Qe(st(),u._getMapId()),this.dispatcher.registerMessageHandler("GG",((z,Y)=>this.getGlyphs(z,Y))),this.dispatcher.registerMessageHandler("GI",((z,Y)=>this.getImages(z,Y))),this.dispatcher.registerMessageHandler("GDA",((z,Y)=>this.getDashes(z,Y))),this.imageManager=new G,this.imageManager.setEventedParent(this);const L=((w=u._container)===null||w===void 0?void 0:w.lang)||typeof document<"u"&&((C=document.documentElement)===null||C===void 0?void 0:C.lang)||void 0;this.glyphManager=new Le(u._requestManager,g.localIdeographFontFamily,L),this.lineAtlas=new Se(256,512),this.crossTileSymbolIndex=new _n,this._setInitialValues(),this._resetUpdates(),this.dispatcher.broadcast("SR",o.bP()),Et().on(qe,this._rtlPluginLoaded),this.on("data",(z=>{if(z.dataType!=="source"||z.sourceDataType!=="metadata")return;const Y=this.tileManagers[z.sourceId];if(!Y)return;const re=Y.getSource();if(re&&re.vectorLayerIds)for(const le in this._layers){const he=this._layers[le];he.source===re.id&&this._validateLayer(he)}}))}_setInitialValues(){var u;this._spritesImagesIds={},this._layers={},this._order=[],this.tileManagers={},this.zoomHistory=new o.bQ,this._availableImages=[],this._globalState={},this._serializedLayers={},this.stylesheet=null,this.light=null,this.sky=null,this.projection&&(this.projection.destroy(),delete this.projection),this._loaded=!1,this._changed=!1,this._updatedLayers={},this._updatedSources={},this._changedImages={},this._glyphsDidChange=!1,this._updatedPaintProps={},this._layerOrderChanged=!1,this.crossTileSymbolIndex=new(((u=this.crossTileSymbolIndex)===null||u===void 0?void 0:u.constructor)||Object),this.pauseablePlacement=void 0,this.placement=void 0,this.z=0}setGlobalStateProperty(u,g){var w,C,L;this._checkLoaded();const z=g===null?(L=(C=(w=this.stylesheet.state)===null||w===void 0?void 0:w[u])===null||C===void 0?void 0:C.default)!==null&&L!==void 0?L:null:g;if(o.bR(z,this._globalState[u]))return this;this._globalState[u]=z,this._applyGlobalStateChanges([u])}getGlobalState(){return this._globalState}setGlobalState(u){this._checkLoaded();const g=[];for(const w in u)!o.bR(this._globalState[w],u[w].default)&&(g.push(w),this._globalState[w]=u[w].default);this._applyGlobalStateChanges(g)}_applyGlobalStateChanges(u){if(u.length===0)return;const g=new Set,w={};for(const C of u){w[C]=this._globalState[C];for(const L in this._layers){const z=this._layers[L],Y=z.getLayoutAffectingGlobalStateRefs(),re=z.getPaintAffectingGlobalStateRefs(),le=z.getVisibilityAffectingGlobalStateRefs();if(Y.has(C)&&g.add(z.source),re.has(C))for(const{name:he,value:Pe}of re.get(C))this._updatePaintProperty(z,he,Pe);le?.has(C)&&(z.recalculateVisibility(),this._updateLayer(z))}}this.dispatcher.broadcast("UGS",w);for(const C in this.tileManagers)g.has(C)&&(this._reloadSource(C),this._changed=!0)}loadURL(u,g={},w){this.fire(new o.l("dataloading",{dataType:"style"})),g.validate=typeof g.validate!="boolean"||g.validate;const C=this.map._requestManager.transformRequest(u,"Style");this._loadStyleRequest=new AbortController;const L=this._loadStyleRequest;o.j(C,this._loadStyleRequest).then((z=>{this._loadStyleRequest=null,this._load(z.data,g,w)})).catch((z=>{this._loadStyleRequest=null,z&&!L.signal.aborted&&this.fire(new o.k(z))}))}loadJSON(u,g={},w){this.fire(new o.l("dataloading",{dataType:"style"})),this._frameRequest=new AbortController,x.frameAsync(this._frameRequest).then((()=>{this._frameRequest=null,g.validate=g.validate!==!1,this._load(u,g,w)})).catch((()=>{}))}loadEmpty(){this.fire(new o.l("dataloading",{dataType:"style"})),this._load(ns,{validate:!1})}_load(u,g,w){var C,L;let z=g.transformStyle?g.transformStyle(w,u):u;if(!g.validate||!Da(this,o.C(z))){z=Object.assign({},z),this._loaded=!0,this.stylesheet=z;for(const Y in z.sources)this.addSource(Y,z.sources[Y],{validate:!1});z.sprite?this._loadSprite(z.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(z.glyphs),this._createLayers(),this.light=new Ie(this.stylesheet.light),this._setProjectionInternal(((C=this.stylesheet.projection)===null||C===void 0?void 0:C.type)||"mercator"),this.sky=new de(this.stylesheet.sky),this.map.setTerrain((L=this.stylesheet.terrain)!==null&&L!==void 0?L:null),this.fire(new o.l("data",{dataType:"style"})),this.fire(new o.l("style.load"))}}_createLayers(){var u,g,w;const C=o.bS(this.stylesheet.layers);this.setGlobalState((u=this.stylesheet.state)!==null&&u!==void 0?u:null),this.dispatcher.broadcast("SL",C),this._order=C.map((L=>L.id)),this._layers={},this._serializedLayers=null;for(const L of C){const z=o.bT(L,this._globalState);if(z.setEventedParent(this,{layer:{id:L.id}}),this._layers[L.id]=z,o.bU(z)&&this.tileManagers[z.source]){const Y=(w=(g=L.paint)===null||g===void 0?void 0:g["raster-fade-duration"])!==null&&w!==void 0?w:z.paint.get("raster-fade-duration");this.tileManagers[z.source].setRasterFadeDuration(Y)}}}_loadSprite(u,g=!1,w=void 0){this.imageManager.setLoaded(!1);const C=new AbortController;let L;this._spriteRequest=C,(function(z,Y,re,le){return o._(this,void 0,void 0,(function*(){const he=X(z),Pe=re>1?"@2x":"",Ae={},Ue={};for(const{id:Ze,url:ht}of he){const pt=Y.transformRequest(oe(ht,Pe,".json"),"SpriteJSON");Ae[Ze]=o.j(pt,le);const dt=Y.transformRequest(oe(ht,Pe,".png"),"SpriteImage");Ue[Ze]=H.getImage(dt,le)}return yield Promise.all([...Object.values(Ae),...Object.values(Ue)]),(function(Ze,ht){return o._(this,void 0,void 0,(function*(){const pt={};for(const dt in Ze){pt[dt]={};const xt=x.getImageCanvasContext((yield ht[dt]).data),Nt=(yield Ze[dt]).data;for(const wt in Nt){const{width:Lt,height:jt,x:Dt,y:Zt,sdf:Sr,pixelRatio:pr,stretchX:_r,stretchY:xr,content:an,textFitWidth:ln,textFitHeight:Hr}=Nt[wt];pt[dt][wt]={data:null,pixelRatio:pr,sdf:Sr,stretchX:_r,stretchY:xr,content:an,textFitWidth:ln,textFitHeight:Hr,spriteData:{width:Lt,height:jt,x:Dt,y:Zt,context:xt}}}}return pt}))})(Ae,Ue)}))})(u,this.map._requestManager,this.map.getPixelRatio(),this._spriteRequest).then((z=>{if(this._spriteRequest=null,z)for(const Y in z){this._spritesImagesIds[Y]=[];const re=this._spritesImagesIds[Y]?this._spritesImagesIds[Y].filter((le=>!(le in z))):[];for(const le of re)this.imageManager.removeImage(le),this._changedImages[le]=!0;for(const le in z[Y]){const he=Y==="default"?le:`${Y}:${le}`;this._spritesImagesIds[Y].push(he),he in this.imageManager.images?this.imageManager.updateImage(he,z[Y][le],!1):this.imageManager.addImage(he,z[Y][le]),g&&(this._changedImages[he]=!0)}}})).catch((z=>{this._spriteRequest=null,L=z,C.signal.aborted||this.fire(new o.k(L))})).finally((()=>{this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),g&&(this._changed=!0),this.dispatcher.broadcast("SI",this._availableImages),this.fire(new o.l("data",{dataType:"style"})),w&&w(L)}))}_unloadSprite(){for(const u of Object.values(this._spritesImagesIds).flat())this.imageManager.removeImage(u),this._changedImages[u]=!0;this._spritesImagesIds={},this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new o.l("data",{dataType:"style"}))}_validateLayer(u){const g=this.tileManagers[u.source];if(!g)return;const w=u.sourceLayer;if(!w)return;const C=g.getSource();(C.type==="geojson"||C.vectorLayerIds&&C.vectorLayerIds.indexOf(w)===-1)&&this.fire(new o.k(new Error(`Source layer "${w}" does not exist on source "${C.id}" as specified by style layer "${u.id}".`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const u in this.tileManagers)if(!this.tileManagers[u].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeByIds(u,g=!1){const w=this._serializedAllLayers();if(!u||u.length===0)return Object.values(g?o.bV(w):w);const C=[];for(const L of u)if(w[L]){const z=g?o.bV(w[L]):w[L];C.push(z)}return C}_serializedAllLayers(){let u=this._serializedLayers;if(u)return u;u=this._serializedLayers={};const g=Object.keys(this._layers);for(const w of g){const C=this._layers[w];C.type!=="custom"&&(u[w]=C.serialize())}return u}hasTransitions(){var u,g,w;if(!((u=this.light)===null||u===void 0)&&u.hasTransition()||!((g=this.sky)===null||g===void 0)&&g.hasTransition()||!((w=this.projection)===null||w===void 0)&&w.hasTransition())return!0;for(const C in this.tileManagers)if(this.tileManagers[C].hasTransition())return!0;for(const C in this._layers)if(this._layers[C].hasTransition())return!0;return!1}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading.")}update(u){if(!this._loaded)return;const g=this._changed;if(g){const C=Object.keys(this._updatedLayers),L=Object.keys(this._removedLayers);(C.length||L.length)&&this._updateWorkerLayers(C,L);for(const z in this._updatedSources){const Y=this._updatedSources[z];if(Y==="reload")this._reloadSource(z);else{if(Y!=="clear")throw new Error(`Invalid action ${Y}`);this._clearSource(z)}}this._updateTilesForChangedImages(),this._updateTilesForChangedGlyphs();for(const z in this._updatedPaintProps)this._layers[z].updateTransitions(u);this.light.updateTransitions(u),this.sky.updateTransitions(u),this._resetUpdates()}const w={};for(const C in this.tileManagers){const L=this.tileManagers[C];w[C]=L.used,L.used=!1}for(const C of this._order){const L=this._layers[C];L.recalculate(u,this._availableImages),!L.isHidden(u.zoom)&&L.source&&(this.tileManagers[L.source].used=!0)}for(const C in w){const L=this.tileManagers[C];!!w[C]!=!!L.used&&L.fire(new o.l("data",{sourceDataType:"visibility",dataType:"source",sourceId:C}))}this.light.recalculate(u),this.sky.recalculate(u),this.projection.recalculate(u),this.z=u.zoom,g&&this.fire(new o.l("data",{dataType:"style"}))}_updateTilesForChangedImages(){const u=Object.keys(this._changedImages);if(u.length){for(const g in this.tileManagers)this.tileManagers[g].reloadTilesForDependencies(["icons","patterns"],u);this._changedImages={}}}_updateTilesForChangedGlyphs(){if(this._glyphsDidChange){for(const u in this.tileManagers)this.tileManagers[u].reloadTilesForDependencies(["glyphs"],[""]);this._glyphsDidChange=!1}}_updateWorkerLayers(u,g){this.dispatcher.broadcast("UL",{layers:this._serializeByIds(u,!1),removedIds:g})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={},this._glyphsDidChange=!1}setState(u,g={}){var w;this._checkLoaded();const C=this.serialize();if(u=g.transformStyle?g.transformStyle(C,u):u,((w=g.validate)===null||w===void 0||w)&&Da(this,o.C(u)))return!1;(u=o.bV(u)).layers=o.bS(u.layers);const L=o.bW(C,u),z=this._getOperationsToPerform(L);if(z.unimplemented.length>0)throw new Error(`Unimplemented: ${z.unimplemented.join(", ")}.`);if(z.operations.length===0)return!1;for(const Y of z.operations)Y();return this.stylesheet=u,this._serializedLayers=null,this.fire(new o.l("style.load",{style:this})),!0}_getOperationsToPerform(u){const g=[],w=[];for(const C of u)switch(C.command){case"setCenter":case"setZoom":case"setBearing":case"setPitch":case"setRoll":continue;case"addLayer":g.push((()=>this.addLayer.apply(this,C.args)));break;case"removeLayer":g.push((()=>this.removeLayer.apply(this,C.args)));break;case"setPaintProperty":g.push((()=>this.setPaintProperty.apply(this,C.args)));break;case"setLayoutProperty":g.push((()=>this.setLayoutProperty.apply(this,C.args)));break;case"setFilter":g.push((()=>this.setFilter.apply(this,C.args)));break;case"addSource":g.push((()=>this.addSource.apply(this,C.args)));break;case"removeSource":g.push((()=>this.removeSource.apply(this,C.args)));break;case"setLayerZoomRange":g.push((()=>this.setLayerZoomRange.apply(this,C.args)));break;case"setLight":g.push((()=>this.setLight.apply(this,C.args)));break;case"setGeoJSONSourceData":g.push((()=>this.setGeoJSONSourceData.apply(this,C.args)));break;case"setGlyphs":g.push((()=>this.setGlyphs.apply(this,C.args)));break;case"setSprite":g.push((()=>this.setSprite.apply(this,C.args)));break;case"setTerrain":g.push((()=>this.map.setTerrain.apply(this,C.args)));break;case"setSky":g.push((()=>this.setSky.apply(this,C.args)));break;case"setProjection":this.setProjection.apply(this,C.args);break;case"setGlobalState":g.push((()=>this.setGlobalState.apply(this,C.args)));break;case"setTransition":g.push((()=>{}));break;default:w.push(C.command)}return{operations:g,unimplemented:w}}addImage(u,g){if(this.getImage(u))return this.fire(new o.k(new Error(`An image named "${u}" already exists.`)));this.imageManager.addImage(u,g),this._afterImageUpdated(u)}updateImage(u,g){this.imageManager.updateImage(u,g)}getImage(u){return this.imageManager.getImage(u)}removeImage(u){if(!this.getImage(u))return this.fire(new o.k(new Error(`An image named "${u}" does not exist.`)));this.imageManager.removeImage(u),this._afterImageUpdated(u)}_afterImageUpdated(u){this._availableImages=this.imageManager.listImages(),this._changedImages[u]=!0,this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new o.l("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this.imageManager.listImages()}addSource(u,g,w={}){if(this._checkLoaded(),this.tileManagers[u]!==void 0)throw new Error(`Source "${u}" already exists.`);if(!g.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(g).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(g.type)>=0&&this._validate(o.C.source,`sources.${u}`,g,null,w))return;this.map&&this.map._collectResourceTiming&&(g.collectResourceTiming=!0);const C=this.tileManagers[u]=new Ci(u,g,this.dispatcher);C.style=this,C.setEventedParent(this,(()=>({isSourceLoaded:C.loaded(),source:C.serialize(),sourceId:u}))),C.onAdd(this.map),this._changed=!0}removeSource(u){if(this._checkLoaded(),this.tileManagers[u]===void 0)throw new Error("There is no source with this ID");for(const w in this._layers)if(this._layers[w].source===u)return this.fire(new o.k(new Error(`Source "${u}" cannot be removed while layer "${w}" is using it.`)));const g=this.tileManagers[u];delete this.tileManagers[u],delete this._updatedSources[u],g.fire(new o.l("data",{sourceDataType:"metadata",dataType:"source",sourceId:u})),g.setEventedParent(null),g.onRemove(this.map),this._changed=!0}setGeoJSONSourceData(u,g){if(this._checkLoaded(),this.tileManagers[u]===void 0)throw new Error(`There is no source with this ID=${u}`);const w=this.tileManagers[u].getSource();if(w.type!=="geojson")throw new Error(`geojsonSource.type is ${w.type}, which is !== 'geojson`);w.setData(g),this._changed=!0}getSource(u){return this.tileManagers[u]&&this.tileManagers[u].getSource()}addLayer(u,g,w={}){this._checkLoaded();const C=u.id;if(this.getLayer(C))return void this.fire(new o.k(new Error(`Layer "${C}" already exists on this map.`)));let L;if(u.type==="custom"){if(Da(this,o.bX(u)))return;L=o.bT(u,this._globalState)}else{if("source"in u&&typeof u.source=="object"&&(this.addSource(C,u.source),u=o.bV(u),u=o.e(u,{source:C})),this._validate(o.C.layer,`layers.${C}`,u,{arrayIndex:-1},w))return;L=o.bT(u,this._globalState),this._validateLayer(L),L.setEventedParent(this,{layer:{id:C}})}const z=g?this._order.indexOf(g):this._order.length;if(g&&z===-1)this.fire(new o.k(new Error(`Cannot add layer "${C}" before non-existing layer "${g}".`)));else{if(this._order.splice(z,0,C),this._layerOrderChanged=!0,this._layers[C]=L,this._removedLayers[C]&&L.source&&L.type!=="custom"){const Y=this._removedLayers[C];delete this._removedLayers[C],Y.type!==L.type?this._updatedSources[L.source]="clear":(this._updatedSources[L.source]="reload",this.tileManagers[L.source].pause())}this._updateLayer(L),L.onAdd&&L.onAdd(this.map)}}moveLayer(u,g){if(this._checkLoaded(),this._changed=!0,!this._layers[u])return void this.fire(new o.k(new Error(`The layer '${u}' does not exist in the map's style and cannot be moved.`)));if(u===g)return;const w=this._order.indexOf(u);this._order.splice(w,1);const C=g?this._order.indexOf(g):this._order.length;g&&C===-1?this.fire(new o.k(new Error(`Cannot move layer "${u}" before non-existing layer "${g}".`))):(this._order.splice(C,0,u),this._layerOrderChanged=!0)}removeLayer(u){this._checkLoaded();const g=this._layers[u];if(!g)return void this.fire(new o.k(new Error(`Cannot remove non-existing layer "${u}".`)));g.setEventedParent(null);const w=this._order.indexOf(u);this._order.splice(w,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[u]=g,delete this._layers[u],this._serializedLayers&&delete this._serializedLayers[u],delete this._updatedLayers[u],delete this._updatedPaintProps[u],g.onRemove&&g.onRemove(this.map)}getLayer(u){return this._layers[u]}getLayersOrder(){return[...this._order]}hasLayer(u){return u in this._layers}setLayerZoomRange(u,g,w){this._checkLoaded();const C=this.getLayer(u);C?C.minzoom===g&&C.maxzoom===w||(g!=null&&(C.minzoom=g),w!=null&&(C.maxzoom=w),this._updateLayer(C)):this.fire(new o.k(new Error(`Cannot set the zoom range of non-existing layer "${u}".`)))}setFilter(u,g,w={}){this._checkLoaded();const C=this.getLayer(u);if(C){if(!o.bR(C.filter,g))return g==null?(C.setFilter(void 0),void this._updateLayer(C)):void(this._validate(o.C.filter,`layers.${C.id}.filter`,g,null,w)||(C.setFilter(o.bV(g)),this._updateLayer(C)))}else this.fire(new o.k(new Error(`Cannot filter non-existing layer "${u}".`)))}getFilter(u){return o.bV(this.getLayer(u).filter)}setLayoutProperty(u,g,w,C={}){this._checkLoaded();const L=this.getLayer(u);L?o.bR(L.getLayoutProperty(g),w)||(L.setLayoutProperty(g,w,C),this._updateLayer(L)):this.fire(new o.k(new Error(`Cannot style non-existing layer "${u}".`)))}getLayoutProperty(u,g){const w=this.getLayer(u);if(w)return w.getLayoutProperty(g);this.fire(new o.k(new Error(`Cannot get style of non-existing layer "${u}".`)))}setPaintProperty(u,g,w,C={}){this._checkLoaded();const L=this.getLayer(u);L?o.bR(L.getPaintProperty(g),w)||this._updatePaintProperty(L,g,w,C):this.fire(new o.k(new Error(`Cannot style non-existing layer "${u}".`)))}_updatePaintProperty(u,g,w,C={}){u.setPaintProperty(g,w,C)&&this._updateLayer(u),o.bU(u)&&g==="raster-fade-duration"&&this.tileManagers[u.source].setRasterFadeDuration(w),this._changed=!0,this._updatedPaintProps[u.id]=!0,this._serializedLayers=null}getPaintProperty(u,g){return this.getLayer(u).getPaintProperty(g)}setFeatureState(u,g){this._checkLoaded();const w=u.source,C=u.sourceLayer,L=this.tileManagers[w];if(L===void 0)return void this.fire(new o.k(new Error(`The source '${w}' does not exist in the map's style.`)));const z=L.getSource().type;z==="geojson"&&C?this.fire(new o.k(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):z!=="vector"||C?(u.id===void 0&&this.fire(new o.k(new Error("The feature id parameter must be provided."))),L.setFeatureState(C,u.id,g)):this.fire(new o.k(new Error("The sourceLayer parameter must be provided for vector source types.")))}removeFeatureState(u,g){this._checkLoaded();const w=u.source,C=this.tileManagers[w];if(C===void 0)return void this.fire(new o.k(new Error(`The source '${w}' does not exist in the map's style.`)));const L=C.getSource().type,z=L==="vector"?u.sourceLayer:void 0;L!=="vector"||z?g&&typeof u.id!="string"&&typeof u.id!="number"?this.fire(new o.k(new Error("A feature id is required to remove its specific state property."))):C.removeFeatureState(z,u.id,g):this.fire(new o.k(new Error("The sourceLayer parameter must be provided for vector source types.")))}getFeatureState(u){this._checkLoaded();const g=u.source,w=u.sourceLayer,C=this.tileManagers[g];if(C!==void 0)return C.getSource().type!=="vector"||w?(u.id===void 0&&this.fire(new o.k(new Error("The feature id parameter must be provided."))),C.getFeatureState(w,u.id)):void this.fire(new o.k(new Error("The sourceLayer parameter must be provided for vector source types.")));this.fire(new o.k(new Error(`The source '${g}' does not exist in the map's style.`)))}getTransition(){return o.e({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){if(!this._loaded)return;const u=o.bY(this.tileManagers,(L=>L.serialize())),g=this._serializeByIds(this._order,!0),w=this.map.getTerrain()||void 0,C=this.stylesheet;return o.bZ({version:C.version,name:C.name,metadata:C.metadata,light:C.light,sky:C.sky,center:C.center,zoom:C.zoom,bearing:C.bearing,pitch:C.pitch,sprite:C.sprite,glyphs:C.glyphs,transition:C.transition,projection:C.projection,sources:u,layers:g,terrain:w},(L=>L!==void 0))}_updateLayer(u){this._updatedLayers[u.id]=!0,u.source&&!this._updatedSources[u.source]&&this.tileManagers[u.source].getSource().type!=="raster"&&(this._updatedSources[u.source]="reload",this.tileManagers[u.source].pause()),this._serializedLayers=null,this._changed=!0}_flattenAndSortRenderedFeatures(u){const g=z=>this._layers[z].type==="fill-extrusion",w={},C=[];for(let z=this._order.length-1;z>=0;z--){const Y=this._order[z];if(g(Y)){w[Y]=z;for(const re of u){const le=re[Y];if(le)for(const he of le)C.push(he)}}}C.sort(((z,Y)=>Y.intersectionZ-z.intersectionZ));const L=[];for(let z=this._order.length-1;z>=0;z--){const Y=this._order[z];if(g(Y))for(let re=C.length-1;re>=0;re--){const le=C[re].feature;if(w[le.layer.id]<z)break;L.push(le),C.pop()}else for(const re of u){const le=re[Y];if(le)for(const he of le)L.push(he.feature)}}return L}queryRenderedFeatures(u,g,w){g&&g.filter&&this._validate(o.C.filter,"queryRenderedFeatures.filter",g.filter,null,g);const C={};if(g&&g.layers){if(!(Array.isArray(g.layers)||g.layers instanceof Set))return this.fire(new o.k(new Error("parameters.layers must be an Array or a Set of strings"))),[];for(const le of g.layers){const he=this._layers[le];if(!he)return this.fire(new o.k(new Error(`The layer '${le}' does not exist in the map's style and cannot be queried for features.`))),[];C[he.source]=!0}}const L=[];g.availableImages=this._availableImages;const z=this._serializedAllLayers(),Y=g.layers instanceof Set?g.layers:Array.isArray(g.layers)?new Set(g.layers):null,re=Object.assign(Object.assign({},g),{layers:Y,globalState:this._globalState});for(const le in this.tileManagers)g.layers&&!C[le]||L.push(Ot(this.tileManagers[le],this._layers,z,u,re,w,this.map.terrain?(he,Pe,Ae)=>this.map.terrain.getElevation(he,Pe,Ae):void 0));return this.placement&&L.push((function(le,he,Pe,Ae,Ue,Ze,ht){const pt={},dt=Ze.queryRenderedSymbols(Ae),xt=[];for(const Nt of Object.keys(dt).map(Number))xt.push(ht[Nt]);xt.sort(at);for(const Nt of xt){const wt=Nt.featureIndex.lookupSymbolFeatures(dt[Nt.bucketInstanceId],he,Nt.bucketIndex,Nt.sourceLayerIndex,{filterSpec:Ue.filter,globalState:Ue.globalState},Ue.layers,Ue.availableImages,le);for(const Lt in wt){const jt=pt[Lt]=pt[Lt]||[],Dt=wt[Lt];Dt.sort(((Zt,Sr)=>{const pr=Nt.featureSortOrder;if(pr){const _r=pr.indexOf(Zt.featureIndex);return pr.indexOf(Sr.featureIndex)-_r}return Sr.featureIndex-Zt.featureIndex}));for(const Zt of Dt)jt.push(Zt)}}return(function(Nt,wt,Lt){for(const jt in Nt)for(const Dt of Nt[jt])$e(Dt,Lt[wt[jt].source]);return Nt})(pt,le,Pe)})(this._layers,z,this.tileManagers,u,re,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(L)}querySourceFeatures(u,g){g?.filter&&this._validate(o.C.filter,"querySourceFeatures.filter",g.filter,null,g);const w=this.tileManagers[u];return w?(function(C,L){const z=C.getRenderableIds().map((le=>C.getTileByID(le))),Y=[],re={};for(let le=0;le<z.length;le++){const he=z[le],Pe=he.tileID.canonical.key;re[Pe]||(re[Pe]=!0,he.querySourceFeatures(Y,L))}return Y})(w,g?Object.assign(Object.assign({},g),{globalState:this._globalState}):{globalState:this._globalState}):[]}getLight(){return this.light.getLight()}setLight(u,g={}){this._checkLoaded();const w=this.light.getLight();let C=!1;for(const z in u)if(!o.bR(u[z],w[z])){C=!0;break}if(!C)return;const L={now:T(),transition:o.e({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(u,g),this.light.updateTransitions(L)}getProjection(){var u;return(u=this.stylesheet)===null||u===void 0?void 0:u.projection}setProjection(u){if(this._checkLoaded(),this.projection){if(this.projection.name===u.type)return;this.projection.destroy(),delete this.projection}this.stylesheet.projection=u,this._setProjectionInternal(u.type)}getSky(){var u;return(u=this.stylesheet)===null||u===void 0?void 0:u.sky}setSky(u,g={}){this._checkLoaded();const w=this.getSky();let C=!1;if(!u&&!w)return;if(u&&!w)C=!0;else if(!u&&w)C=!0;else for(const z in u)if(!o.bR(u[z],w[z])){C=!0;break}if(!C)return;const L={now:T(),transition:o.e({duration:300,delay:0},this.stylesheet.transition)};this.stylesheet.sky=u,this.sky.setSky(u,g),this.sky.updateTransitions(L)}_setProjectionInternal(u){const g=(function(w,C){const L={constrainOverride:C};if(Array.isArray(w)){const z=new qn({type:w});return{projection:z,transform:new gs(L),cameraHelper:new qo(z)}}switch(w){case"mercator":return{projection:new hi,transform:new $s(L),cameraHelper:new go};case"globe":{const z=new qn({type:["interpolate",["linear"],["zoom"],11,"vertical-perspective",12,"mercator"]});return{projection:z,transform:new gs(L),cameraHelper:new qo(z)}}case"vertical-perspective":return{projection:new Zr,transform:new Il(L),cameraHelper:new Di};default:return o.w(`Unknown projection name: ${w}. Falling back to mercator projection.`),{projection:new hi,transform:new $s(L),cameraHelper:new go}}})(u,this.map.transformConstrain);this.projection=g.projection,this.map.migrateProjection(g.transform,g.cameraHelper);for(const w in this.tileManagers)this.tileManagers[w].reload()}_validate(u,g,w,C,L={}){return(!L||L.validate!==!1)&&Da(this,u.call(o.C,o.e({key:g,style:this.serialize(),value:w,styleSpec:o.u},C)))}_remove(u=!0){this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._loadStyleRequest&&(this._loadStyleRequest.abort(),this._loadStyleRequest=null),this._spriteRequest&&(this._spriteRequest.abort(),this._spriteRequest=null),Et().off(qe,this._rtlPluginLoaded);for(const g in this._layers)this._layers[g].setEventedParent(null);for(const g in this.tileManagers){const w=this.tileManagers[g];w.setEventedParent(null),w.onRemove(this.map)}this.imageManager.setEventedParent(null),this.setEventedParent(null),u&&this.dispatcher.broadcast("RM",void 0),this.dispatcher.remove(u)}_clearSource(u){this.tileManagers[u].clearTiles()}_reloadSource(u){this.tileManagers[u].resume(),this.tileManagers[u].reload()}_updateSources(u){for(const g in this.tileManagers)this.tileManagers[g].update(u,this.map.terrain)}_generateCollisionBoxes(){for(const u in this.tileManagers)this._reloadSource(u)}_updatePlacement(u,g,w,C,L=!1){let z=!1,Y=!1;const re={};for(const le of this._order){const he=this._layers[le];if(he.type!=="symbol")continue;if(!re[he.source]){const Ae=this.tileManagers[he.source];re[he.source]=Ae.getRenderableIds(!0).map((Ue=>Ae.getTileByID(Ue))).sort(((Ue,Ze)=>Ze.tileID.overscaledZ-Ue.tileID.overscaledZ||(Ue.tileID.isLessThan(Ze.tileID)?-1:1)))}const Pe=this.crossTileSymbolIndex.addLayer(he,re[he.source],u.center.lng);z=z||Pe}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((L=L||this._layerOrderChanged||w===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(T(),u.zoom))&&(this.pauseablePlacement=new on(u,this.map.terrain,this._order,L,g,w,C,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,re),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(T()),Y=!0),z&&this.pauseablePlacement.placement.setStale()),Y||z)for(const le of this._order){const he=this._layers[le];he.type==="symbol"&&this.placement.updateLayerOpacities(he,re[he.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(T())}_releaseSymbolFadeTiles(){for(const u in this.tileManagers)this.tileManagers[u].releaseSymbolFadeTiles()}getImages(u,g){return o._(this,void 0,void 0,(function*(){const w=yield this.imageManager.getImages(g.icons);this._updateTilesForChangedImages();const C=this.tileManagers[g.source];return C&&C.setDependencies(g.tileID.key,g.type,g.icons),w}))}getGlyphs(u,g){return o._(this,void 0,void 0,(function*(){const w=yield this.glyphManager.getGlyphs(g.stacks),C=this.tileManagers[g.source];return C&&C.setDependencies(g.tileID.key,g.type,[""]),w}))}getGlyphsUrl(){return this.stylesheet.glyphs||null}setGlyphs(u,g={}){this._checkLoaded(),u&&this._validate(o.C.glyphs,"glyphs",u,null,g)||(this._glyphsDidChange=!0,this.stylesheet.glyphs=u,this.glyphManager.entries={},this.glyphManager.setURL(u))}getDashes(u,g){return o._(this,void 0,void 0,(function*(){const w={};for(const[C,L]of Object.entries(g.dashes))w[C]=this.lineAtlas.getDash(L.dasharray,L.round);return w}))}addSprite(u,g,w={},C){this._checkLoaded();const L=[{id:u,url:g}],z=[...X(this.stylesheet.sprite),...L];this._validate(o.C.sprite,"sprite",z,null,w)||(this.stylesheet.sprite=z,this._loadSprite(L,!0,C))}removeSprite(u){this._checkLoaded();const g=X(this.stylesheet.sprite);if(g.find((w=>w.id===u))){if(this._spritesImagesIds[u])for(const w of this._spritesImagesIds[u])this.imageManager.removeImage(w),this._changedImages[w]=!0;g.splice(g.findIndex((w=>w.id===u)),1),this.stylesheet.sprite=g.length>0?g:void 0,delete this._spritesImagesIds[u],this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new o.l("data",{dataType:"style"}))}else this.fire(new o.k(new Error(`Sprite "${u}" doesn't exists on this map.`)))}getSprite(){return X(this.stylesheet.sprite)}setSprite(u,g={},w){this._checkLoaded(),u&&this._validate(o.C.sprite,"sprite",u,null,g)||(this.stylesheet.sprite=u,u?this._loadSprite(u,!0,w):(this._unloadSprite(),w&&w(null)))}destroy(){this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._loadStyleRequest&&(this._loadStyleRequest.abort(),this._loadStyleRequest=null),this._spriteRequest&&(this._spriteRequest.abort(),this._spriteRequest=null);for(const u in this.tileManagers){const g=this.tileManagers[u];g.setEventedParent(null),g.onRemove(this.map)}this.tileManagers={},this.imageManager&&(this.imageManager.setEventedParent(null),this.imageManager.destroy(),this._availableImages=[],this._spritesImagesIds={}),this.glyphManager&&this.glyphManager.destroy();for(const u in this._layers){const g=this._layers[u];g.setEventedParent(null),g.onRemove&&g.onRemove(this.map)}this._setInitialValues(),this.setEventedParent(null),this.dispatcher.unregisterMessageHandler("GG"),this.dispatcher.unregisterMessageHandler("GI"),this.dispatcher.unregisterMessageHandler("GDA"),this.dispatcher.remove(!0),this._listeners={},this._oneTimeListeners={}}}var Ja=o.aU([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);class rc{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(u,g,w,C,L,z,Y,re,le){this.context=u;let he=this.boundPaintVertexBuffers.length!==C.length;for(let Pe=0;!he&&Pe<C.length;Pe++)this.boundPaintVertexBuffers[Pe]!==C[Pe]&&(he=!0);!this.vao||this.boundProgram!==g||this.boundLayoutVertexBuffer!==w||he||this.boundIndexBuffer!==L||this.boundVertexOffset!==z||this.boundDynamicVertexBuffer!==Y||this.boundDynamicVertexBuffer2!==re||this.boundDynamicVertexBuffer3!==le?this.freshBind(g,w,C,L,z,Y,re,le):(u.bindVertexArray.set(this.vao),Y&&Y.bind(),L&&L.dynamicDraw&&L.bind(),re&&re.bind(),le&&le.bind())}freshBind(u,g,w,C,L,z,Y,re){const le=u.numAttributes,he=this.context,Pe=he.gl;this.vao&&this.destroy(),this.vao=he.createVertexArray(),he.bindVertexArray.set(this.vao),this.boundProgram=u,this.boundLayoutVertexBuffer=g,this.boundPaintVertexBuffers=w,this.boundIndexBuffer=C,this.boundVertexOffset=L,this.boundDynamicVertexBuffer=z,this.boundDynamicVertexBuffer2=Y,this.boundDynamicVertexBuffer3=re,g.enableAttributes(Pe,u);for(const Ae of w)Ae.enableAttributes(Pe,u);z&&z.enableAttributes(Pe,u),Y&&Y.enableAttributes(Pe,u),re&&re.enableAttributes(Pe,u),g.bind(),g.setVertexAttribPointers(Pe,u,L);for(const Ae of w)Ae.bind(),Ae.setVertexAttribPointers(Pe,u,L);z&&(z.bind(),z.setVertexAttribPointers(Pe,u,L)),C&&C.bind(),Y&&(Y.bind(),Y.setVertexAttribPointers(Pe,u,L)),re&&(re.bind(),re.setVertexAttribPointers(Pe,u,L)),he.currentNumAttributes=le}destroy(){this.vao&&(this.context.deleteVertexArray(this.vao),this.vao=null)}}const uu=(D,u,g,w,C)=>({u_texture:0,u_ele_delta:D,u_fog_matrix:u,u_fog_color:g?g.properties.get("fog-color"):o.bp.white,u_fog_ground_blend:g?g.properties.get("fog-ground-blend"):1,u_fog_ground_blend_opacity:C?0:g?g.calculateFogBlendOpacity(w):0,u_horizon_color:g?g.properties.get("horizon-color"):o.bp.white,u_horizon_fog_blend:g?g.properties.get("horizon-fog-blend"):1,u_is_globe_mode:C?1:0}),Ys={mainMatrix:"u_projection_matrix",tileMercatorCoords:"u_projection_tile_mercator_coords",clippingPlane:"u_projection_clipping_plane",projectionTransition:"u_projection_transition",fallbackMatrix:"u_projection_fallback_matrix"};function ja(D){const u=[];for(let g=0;g<D.length;g++){if(D[g]===null)continue;const w=D[g].split(" ");u.push(w.pop())}return u}class Is{constructor(u,g,w,C,L,z,Y,re,le=[]){const he=u.gl;this.program=he.createProgram();const Pe=ja(g.staticAttributes),Ae=w?w.getBinderAttributes():[],Ue=Pe.concat(Ae),Ze=hn.prelude.staticUniforms?ja(hn.prelude.staticUniforms):[],ht=Y.staticUniforms?ja(Y.staticUniforms):[],pt=g.staticUniforms?ja(g.staticUniforms):[],dt=w?w.getBinderUniforms():[],xt=Ze.concat(ht).concat(pt).concat(dt),Nt=[];for(const pr of xt)Nt.indexOf(pr)<0&&Nt.push(pr);const wt=w?w.defines():[];We(he)&&wt.unshift("#version 300 es"),L&&wt.push("#define OVERDRAW_INSPECTOR;"),z&&wt.push("#define TERRAIN3D;"),re&&wt.push(re),le&&wt.push(...le);let Lt=wt.concat(hn.prelude.fragmentSource,Y.fragmentSource,g.fragmentSource).join(`
`),jt=wt.concat(hn.prelude.vertexSource,Y.vertexSource,g.vertexSource).join(`
`);We(he)||(Lt=(function(pr){return pr.replace(/\bin\s/g,"varying ").replace("out highp vec4 fragColor;","").replace(/fragColor/g,"gl_FragColor").replace(/texture\(/g,"texture2D(")})(Lt),jt=(function(pr){return pr.replace(/\bin\s/g,"attribute ").replace(/\bout\s/g,"varying ").replace(/texture\(/g,"texture2D(")})(jt));const Dt=he.createShader(he.FRAGMENT_SHADER);if(he.isContextLost())return void(this.failedToCreate=!0);if(he.shaderSource(Dt,Lt),he.compileShader(Dt),!he.getShaderParameter(Dt,he.COMPILE_STATUS))throw new Error(`Could not compile fragment shader: ${he.getShaderInfoLog(Dt)}`);he.attachShader(this.program,Dt);const Zt=he.createShader(he.VERTEX_SHADER);if(he.isContextLost())return void(this.failedToCreate=!0);if(he.shaderSource(Zt,jt),he.compileShader(Zt),!he.getShaderParameter(Zt,he.COMPILE_STATUS))throw new Error(`Could not compile vertex shader: ${he.getShaderInfoLog(Zt)}`);he.attachShader(this.program,Zt),this.attributes={};const Sr={};this.numAttributes=Ue.length;for(let pr=0;pr<this.numAttributes;pr++)Ue[pr]&&(he.bindAttribLocation(this.program,pr,Ue[pr]),this.attributes[Ue[pr]]=pr);if(he.linkProgram(this.program),!he.getProgramParameter(this.program,he.LINK_STATUS))throw new Error(`Program failed to link: ${he.getProgramInfoLog(this.program)}`);he.deleteShader(Zt),he.deleteShader(Dt);for(let pr=0;pr<Nt.length;pr++){const _r=Nt[pr];if(_r&&!Sr[_r]){const xr=he.getUniformLocation(this.program,_r);xr&&(Sr[_r]=xr)}}this.fixedUniforms=C(u,Sr),this.terrainUniforms=((pr,_r)=>({u_depth:new o.b_(pr,_r.u_depth),u_terrain:new o.b_(pr,_r.u_terrain),u_terrain_dim:new o.bq(pr,_r.u_terrain_dim),u_terrain_matrix:new o.c0(pr,_r.u_terrain_matrix),u_terrain_unpack:new o.c1(pr,_r.u_terrain_unpack),u_terrain_exaggeration:new o.bq(pr,_r.u_terrain_exaggeration)}))(u,Sr),this.projectionUniforms=((pr,_r)=>({u_projection_matrix:new o.c0(pr,_r.u_projection_matrix),u_projection_tile_mercator_coords:new o.c1(pr,_r.u_projection_tile_mercator_coords),u_projection_clipping_plane:new o.c1(pr,_r.u_projection_clipping_plane),u_projection_transition:new o.bq(pr,_r.u_projection_transition),u_projection_fallback_matrix:new o.c0(pr,_r.u_projection_fallback_matrix)}))(u,Sr),this.binderUniforms=w?w.getUniforms(u,Sr):[]}draw(u,g,w,C,L,z,Y,re,le,he,Pe,Ae,Ue,Ze,ht,pt,dt,xt,Nt){const wt=u.gl;if(this.failedToCreate)return;if(u.program.set(this.program),u.setDepthMode(w),u.setStencilMode(C),u.setColorMode(L),u.setCullFace(z),re){u.activeTexture.set(wt.TEXTURE2),wt.bindTexture(wt.TEXTURE_2D,re.depthTexture),u.activeTexture.set(wt.TEXTURE3),wt.bindTexture(wt.TEXTURE_2D,re.texture);for(const jt in this.terrainUniforms)this.terrainUniforms[jt].set(re[jt])}if(le)for(const jt in le)this.projectionUniforms[Ys[jt]].set(le[jt]);if(Y)for(const jt in this.fixedUniforms)this.fixedUniforms[jt].set(Y[jt]);pt&&pt.setUniforms(u,this.binderUniforms,Ze,{zoom:ht});let Lt=0;switch(g){case wt.LINES:Lt=2;break;case wt.TRIANGLES:Lt=3;break;case wt.LINE_STRIP:Lt=1}for(const jt of Ue.get()){const Dt=jt.vaos||(jt.vaos={});(Dt[he]||(Dt[he]=new rc)).bind(u,this,Pe,pt?pt.getPaintVertexBuffers():[],Ae,jt.vertexOffset,dt,xt,Nt),wt.drawElements(g,jt.primitiveLength*Lt,wt.UNSIGNED_SHORT,jt.primitiveOffset*Lt*2)}}}function nc(D,u,g){const w=1/o.aN(g,1,u.transform.tileZoom),C=Math.pow(2,g.tileID.overscaledZ),L=g.tileSize*Math.pow(2,u.transform.tileZoom)/C,z=L*(g.tileID.canonical.x+g.tileID.wrap*C),Y=L*g.tileID.canonical.y;return{u_image:0,u_texsize:g.imageAtlasTexture.size,u_scale:[w,D.fromScale,D.toScale],u_fade:D.t,u_pixel_coord_upper:[z>>16,Y>>16],u_pixel_coord_lower:[65535&z,65535&Y]}}const ic=(D,u,g,w)=>{const C=D.style.light,L=C.properties.get("position"),z=[L.x,L.y,L.z],Y=o.c4();C.properties.get("anchor")==="viewport"&&o.c5(Y,D.transform.bearingInRadians),o.c6(z,z,Y);const re=D.transform.transformLightDirection(z),le=C.properties.get("color");return{u_lightpos:z,u_lightpos_globe:re,u_lightintensity:C.properties.get("intensity"),u_lightcolor:[le.r,le.g,le.b],u_vertical_gradient:+u,u_opacity:g,u_fill_translate:w}},ul=(D,u,g,w,C,L,z)=>o.e(ic(D,u,g,w),nc(L,D,z),{u_height_factor:-Math.pow(2,C.overscaledZ)/z.tileSize/8}),cu=(D,u,g,w)=>o.e(nc(u,D,g),{u_fill_translate:w}),Oo=(D,u)=>({u_world:D,u_fill_translate:u}),mo=(D,u,g,w,C)=>o.e(cu(D,u,g,C),{u_world:w}),Du=(D,u,g,w,C)=>{const L=D.transform;let z,Y,re=0;if(g.paint.get("circle-pitch-alignment")==="map"){const le=o.aN(u,1,L.zoom);z=!0,Y=[le,le],re=le/(o.a5*Math.pow(2,u.tileID.overscaledZ))*2*Math.PI*C}else z=!1,Y=L.pixelsToGLUnits;return{u_camera_to_center_distance:L.cameraToCenterDistance,u_scale_with_map:+(g.paint.get("circle-pitch-scale")==="map"),u_pitch_with_map:+z,u_device_pixel_ratio:D.pixelRatio,u_extrude_scale:Y,u_globe_extrude_scale:re,u_translate:w}},Ua=D=>({u_pixel_extrude_scale:[1/D.width,1/D.height]}),fu=D=>({u_viewport_size:[D.width,D.height]}),Zs=(D,u=1)=>({u_color:D,u_overlay:0,u_overlay_scale:u}),ms=(D,u,g,w)=>{const C=o.aN(D,1,u)/(o.a5*Math.pow(2,D.tileID.overscaledZ))*2*Math.PI*w;return{u_extrude_scale:o.aN(D,1,u),u_intensity:g,u_globe_extrude_scale:C}},Va=(D,u,g,w)=>{const C=o.N();o.c7(C,0,D.width,D.height,0,0,1);const L=D.context.gl;return{u_matrix:C,u_world:[L.drawingBufferWidth,L.drawingBufferHeight],u_image:g,u_color_ramp:w,u_opacity:u.paint.get("heatmap-opacity")}},Vl=(D,u,g)=>{const w=g.paint.get("hillshade-accent-color");let C;switch(g.paint.get("hillshade-method")){case"basic":C=4;break;case"combined":C=1;break;case"igor":C=2;break;case"multidirectional":C=3;break;default:C=0}const L=g.getIlluminationProperties();for(let z=0;z<L.directionRadians.length;z++)g.paint.get("hillshade-illumination-anchor")==="viewport"&&(L.directionRadians[z]+=D.transform.bearingInRadians);return{u_image:0,u_latrange:fl(0,u.tileID),u_exaggeration:g.paint.get("hillshade-exaggeration"),u_altitudes:L.altitudeRadians,u_azimuths:L.directionRadians,u_accent:w,u_method:C,u_highlights:L.highlightColor,u_shadows:L.shadowColor}},cl=(D,u)=>{const g=u.stride,w=o.N();return o.c7(w,0,o.a5,-o.a5,0,0,1),o.O(w,w,[0,-o.a5,0]),{u_matrix:w,u_image:1,u_dimension:[g,g],u_zoom:D.overscaledZ,u_unpack:u.getUnpackVector()}};function fl(D,u){const g=Math.pow(2,u.canonical.z),w=u.canonical.y;return[new o.a9(0,w/g).toLngLat().lat,new o.a9(0,(w+1)/g).toLngLat().lat]}const $l=(D,u,g=0)=>({u_image:0,u_unpack:u.getUnpackVector(),u_dimension:[u.stride,u.stride],u_elevation_stops:1,u_color_stops:4,u_color_ramp_size:g,u_opacity:D.paint.get("color-relief-opacity")}),ql=(D,u,g,w)=>{const C=D.transform;return{u_translation:dn(D,u,g),u_ratio:w/o.aN(u,1,C.zoom),u_device_pixel_ratio:D.pixelRatio,u_units_to_pixels:[1/C.pixelsToGLUnits[0],1/C.pixelsToGLUnits[1]]}},hl=(D,u,g,w,C)=>o.e(ql(D,u,g,w),{u_image:0,u_image_height:C}),Hl=(D,u,g,w,C)=>{const L=D.transform,z=vr(u,L);return{u_translation:dn(D,u,g),u_texsize:u.imageAtlasTexture.size,u_ratio:w/o.aN(u,1,L.zoom),u_device_pixel_ratio:D.pixelRatio,u_image:0,u_scale:[z,C.fromScale,C.toScale],u_fade:C.t,u_units_to_pixels:[1/L.pixelsToGLUnits[0],1/L.pixelsToGLUnits[1]]}},Ou=(D,u,g,w,C)=>{const L=vr(u,D.transform);return o.e(ql(D,u,g,w),{u_tileratio:L,u_crossfade_from:C.fromScale,u_crossfade_to:C.toScale,u_image:0,u_mix:C.t,u_lineatlas_width:D.lineAtlas.width,u_lineatlas_height:D.lineAtlas.height})},tr=(D,u,g,w,C,L)=>{const z=vr(u,D.transform);return o.e(ql(D,u,g,w),{u_image:0,u_image_height:L,u_tileratio:z,u_crossfade_from:C.fromScale,u_crossfade_to:C.toScale,u_image_dash:1,u_mix:C.t,u_lineatlas_width:D.lineAtlas.width,u_lineatlas_height:D.lineAtlas.height})};function vr(D,u){return 1/o.aN(D,1,u.tileZoom)}function dn(D,u,g){return o.aO(D.transform,u,g.paint.get("line-translate"),g.paint.get("line-translate-anchor"))}const In=(D,u,g,w,C)=>{return{u_tl_parent:D,u_scale_parent:u,u_buffer_scale:1,u_fade_t:g.mix,u_opacity:g.opacity*w.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:w.paint.get("raster-brightness-min"),u_brightness_high:w.paint.get("raster-brightness-max"),u_saturation_factor:(z=w.paint.get("raster-saturation"),z>0?1-1/(1.001-z):-z),u_contrast_factor:(L=w.paint.get("raster-contrast"),L>0?1/(1-L):1+L),u_spin_weights:vi(w.paint.get("raster-hue-rotate")),u_coords_top:[C[0].x,C[0].y,C[1].x,C[1].y],u_coords_bottom:[C[3].x,C[3].y,C[2].x,C[2].y]};var L,z};function vi(D){D*=Math.PI/180;const u=Math.sin(D),g=Math.cos(D);return[(2*g+1)/3,(-Math.sqrt(3)*u-g+1)/3,(Math.sqrt(3)*u-g+1)/3]}const Pn=(D,u,g,w,C,L,z,Y,re,le,he,Pe,Ae)=>{const Ue=z.transform;return{u_is_size_zoom_constant:+(D==="constant"||D==="source"),u_is_size_feature_constant:+(D==="constant"||D==="camera"),u_size_t:u?u.uSizeT:0,u_size:u?u.uSize:0,u_camera_to_center_distance:Ue.cameraToCenterDistance,u_pitch:Ue.pitch/360*2*Math.PI,u_rotate_symbol:+g,u_aspect_ratio:Ue.width/Ue.height,u_fade_change:z.options.fadeDuration?z.symbolFadeChange:1,u_label_plane_matrix:Y,u_coord_matrix:re,u_is_text:+he,u_pitch_with_map:+w,u_is_along_line:C,u_is_variable_anchor:L,u_texsize:Pe,u_texture:0,u_translation:le,u_pitched_scale:Ae}},I=(D,u,g,w,C,L,z,Y,re,le,he,Pe,Ae,Ue)=>{const Ze=z.transform;return o.e(Pn(D,u,g,w,C,L,z,Y,re,le,he,Pe,Ue),{u_gamma_scale:w?Math.cos(Ze.pitch*Math.PI/180)*Ze.cameraToCenterDistance:1,u_device_pixel_ratio:z.pixelRatio,u_is_halo:1})},y=(D,u,g,w,C,L,z,Y,re,le,he,Pe,Ae)=>o.e(I(D,u,g,w,C,L,z,Y,re,le,!0,he,0,Ae),{u_texsize_icon:Pe,u_texture_icon:1}),_=(D,u)=>({u_opacity:D,u_color:u}),P=(D,u,g,w,C)=>o.e((function(L,z,Y,re){const le=Y.imageManager.getPattern(L.from.toString()),he=Y.imageManager.getPattern(L.to.toString()),{width:Pe,height:Ae}=Y.imageManager.getPixelSize(),Ue=Math.pow(2,re.tileID.overscaledZ),Ze=re.tileSize*Math.pow(2,Y.transform.tileZoom)/Ue,ht=Ze*(re.tileID.canonical.x+re.tileID.wrap*Ue),pt=Ze*re.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:le.tl,u_pattern_br_a:le.br,u_pattern_tl_b:he.tl,u_pattern_br_b:he.br,u_texsize:[Pe,Ae],u_mix:z.t,u_pattern_size_a:le.displaySize,u_pattern_size_b:he.displaySize,u_scale_a:z.fromScale,u_scale_b:z.toScale,u_tile_units_to_pixels:1/o.aN(re,1,Y.transform.tileZoom),u_pixel_coord_upper:[ht>>16,pt>>16],u_pixel_coord_lower:[65535&ht,65535&pt]}})(g,C,u,w),{u_opacity:D}),$=(D,u)=>{},ne={fillExtrusion:(D,u)=>({u_lightpos:new o.c2(D,u.u_lightpos),u_lightpos_globe:new o.c2(D,u.u_lightpos_globe),u_lightintensity:new o.bq(D,u.u_lightintensity),u_lightcolor:new o.c2(D,u.u_lightcolor),u_vertical_gradient:new o.bq(D,u.u_vertical_gradient),u_opacity:new o.bq(D,u.u_opacity),u_fill_translate:new o.c3(D,u.u_fill_translate)}),fillExtrusionPattern:(D,u)=>({u_lightpos:new o.c2(D,u.u_lightpos),u_lightpos_globe:new o.c2(D,u.u_lightpos_globe),u_lightintensity:new o.bq(D,u.u_lightintensity),u_lightcolor:new o.c2(D,u.u_lightcolor),u_vertical_gradient:new o.bq(D,u.u_vertical_gradient),u_height_factor:new o.bq(D,u.u_height_factor),u_opacity:new o.bq(D,u.u_opacity),u_fill_translate:new o.c3(D,u.u_fill_translate),u_image:new o.b_(D,u.u_image),u_texsize:new o.c3(D,u.u_texsize),u_pixel_coord_upper:new o.c3(D,u.u_pixel_coord_upper),u_pixel_coord_lower:new o.c3(D,u.u_pixel_coord_lower),u_scale:new o.c2(D,u.u_scale),u_fade:new o.bq(D,u.u_fade)}),fill:(D,u)=>({u_fill_translate:new o.c3(D,u.u_fill_translate)}),fillPattern:(D,u)=>({u_image:new o.b_(D,u.u_image),u_texsize:new o.c3(D,u.u_texsize),u_pixel_coord_upper:new o.c3(D,u.u_pixel_coord_upper),u_pixel_coord_lower:new o.c3(D,u.u_pixel_coord_lower),u_scale:new o.c2(D,u.u_scale),u_fade:new o.bq(D,u.u_fade),u_fill_translate:new o.c3(D,u.u_fill_translate)}),fillOutline:(D,u)=>({u_world:new o.c3(D,u.u_world),u_fill_translate:new o.c3(D,u.u_fill_translate)}),fillOutlinePattern:(D,u)=>({u_world:new o.c3(D,u.u_world),u_image:new o.b_(D,u.u_image),u_texsize:new o.c3(D,u.u_texsize),u_pixel_coord_upper:new o.c3(D,u.u_pixel_coord_upper),u_pixel_coord_lower:new o.c3(D,u.u_pixel_coord_lower),u_scale:new o.c2(D,u.u_scale),u_fade:new o.bq(D,u.u_fade),u_fill_translate:new o.c3(D,u.u_fill_translate)}),circle:(D,u)=>({u_camera_to_center_distance:new o.bq(D,u.u_camera_to_center_distance),u_scale_with_map:new o.b_(D,u.u_scale_with_map),u_pitch_with_map:new o.b_(D,u.u_pitch_with_map),u_extrude_scale:new o.c3(D,u.u_extrude_scale),u_device_pixel_ratio:new o.bq(D,u.u_device_pixel_ratio),u_globe_extrude_scale:new o.bq(D,u.u_globe_extrude_scale),u_translate:new o.c3(D,u.u_translate)}),collisionBox:(D,u)=>({u_pixel_extrude_scale:new o.c3(D,u.u_pixel_extrude_scale)}),collisionCircle:(D,u)=>({u_viewport_size:new o.c3(D,u.u_viewport_size)}),debug:(D,u)=>({u_color:new o.b$(D,u.u_color),u_overlay:new o.b_(D,u.u_overlay),u_overlay_scale:new o.bq(D,u.u_overlay_scale)}),depth:$,clippingMask:$,heatmap:(D,u)=>({u_extrude_scale:new o.bq(D,u.u_extrude_scale),u_intensity:new o.bq(D,u.u_intensity),u_globe_extrude_scale:new o.bq(D,u.u_globe_extrude_scale)}),heatmapTexture:(D,u)=>({u_matrix:new o.c0(D,u.u_matrix),u_world:new o.c3(D,u.u_world),u_image:new o.b_(D,u.u_image),u_color_ramp:new o.b_(D,u.u_color_ramp),u_opacity:new o.bq(D,u.u_opacity)}),hillshade:(D,u)=>({u_image:new o.b_(D,u.u_image),u_latrange:new o.c3(D,u.u_latrange),u_exaggeration:new o.bq(D,u.u_exaggeration),u_altitudes:new o.c9(D,u.u_altitudes),u_azimuths:new o.c9(D,u.u_azimuths),u_accent:new o.b$(D,u.u_accent),u_method:new o.b_(D,u.u_method),u_shadows:new o.c8(D,u.u_shadows),u_highlights:new o.c8(D,u.u_highlights)}),hillshadePrepare:(D,u)=>({u_matrix:new o.c0(D,u.u_matrix),u_image:new o.b_(D,u.u_image),u_dimension:new o.c3(D,u.u_dimension),u_zoom:new o.bq(D,u.u_zoom),u_unpack:new o.c1(D,u.u_unpack)}),colorRelief:(D,u)=>({u_image:new o.b_(D,u.u_image),u_unpack:new o.c1(D,u.u_unpack),u_dimension:new o.c3(D,u.u_dimension),u_elevation_stops:new o.b_(D,u.u_elevation_stops),u_color_stops:new o.b_(D,u.u_color_stops),u_color_ramp_size:new o.b_(D,u.u_color_ramp_size),u_opacity:new o.bq(D,u.u_opacity)}),line:(D,u)=>({u_translation:new o.c3(D,u.u_translation),u_ratio:new o.bq(D,u.u_ratio),u_device_pixel_ratio:new o.bq(D,u.u_device_pixel_ratio),u_units_to_pixels:new o.c3(D,u.u_units_to_pixels)}),lineGradient:(D,u)=>({u_translation:new o.c3(D,u.u_translation),u_ratio:new o.bq(D,u.u_ratio),u_device_pixel_ratio:new o.bq(D,u.u_device_pixel_ratio),u_units_to_pixels:new o.c3(D,u.u_units_to_pixels),u_image:new o.b_(D,u.u_image),u_image_height:new o.bq(D,u.u_image_height)}),linePattern:(D,u)=>({u_translation:new o.c3(D,u.u_translation),u_texsize:new o.c3(D,u.u_texsize),u_ratio:new o.bq(D,u.u_ratio),u_device_pixel_ratio:new o.bq(D,u.u_device_pixel_ratio),u_image:new o.b_(D,u.u_image),u_units_to_pixels:new o.c3(D,u.u_units_to_pixels),u_scale:new o.c2(D,u.u_scale),u_fade:new o.bq(D,u.u_fade)}),lineSDF:(D,u)=>({u_translation:new o.c3(D,u.u_translation),u_ratio:new o.bq(D,u.u_ratio),u_device_pixel_ratio:new o.bq(D,u.u_device_pixel_ratio),u_units_to_pixels:new o.c3(D,u.u_units_to_pixels),u_image:new o.b_(D,u.u_image),u_mix:new o.bq(D,u.u_mix),u_tileratio:new o.bq(D,u.u_tileratio),u_crossfade_from:new o.bq(D,u.u_crossfade_from),u_crossfade_to:new o.bq(D,u.u_crossfade_to),u_lineatlas_width:new o.bq(D,u.u_lineatlas_width),u_lineatlas_height:new o.bq(D,u.u_lineatlas_height)}),lineGradientSDF:(D,u)=>({u_translation:new o.c3(D,u.u_translation),u_ratio:new o.bq(D,u.u_ratio),u_device_pixel_ratio:new o.bq(D,u.u_device_pixel_ratio),u_units_to_pixels:new o.c3(D,u.u_units_to_pixels),u_image:new o.b_(D,u.u_image),u_image_height:new o.bq(D,u.u_image_height),u_tileratio:new o.bq(D,u.u_tileratio),u_crossfade_from:new o.bq(D,u.u_crossfade_from),u_crossfade_to:new o.bq(D,u.u_crossfade_to),u_image_dash:new o.b_(D,u.u_image_dash),u_mix:new o.bq(D,u.u_mix),u_lineatlas_width:new o.bq(D,u.u_lineatlas_width),u_lineatlas_height:new o.bq(D,u.u_lineatlas_height)}),raster:(D,u)=>({u_tl_parent:new o.c3(D,u.u_tl_parent),u_scale_parent:new o.bq(D,u.u_scale_parent),u_buffer_scale:new o.bq(D,u.u_buffer_scale),u_fade_t:new o.bq(D,u.u_fade_t),u_opacity:new o.bq(D,u.u_opacity),u_image0:new o.b_(D,u.u_image0),u_image1:new o.b_(D,u.u_image1),u_brightness_low:new o.bq(D,u.u_brightness_low),u_brightness_high:new o.bq(D,u.u_brightness_high),u_saturation_factor:new o.bq(D,u.u_saturation_factor),u_contrast_factor:new o.bq(D,u.u_contrast_factor),u_spin_weights:new o.c2(D,u.u_spin_weights),u_coords_top:new o.c1(D,u.u_coords_top),u_coords_bottom:new o.c1(D,u.u_coords_bottom)}),symbolIcon:(D,u)=>({u_is_size_zoom_constant:new o.b_(D,u.u_is_size_zoom_constant),u_is_size_feature_constant:new o.b_(D,u.u_is_size_feature_constant),u_size_t:new o.bq(D,u.u_size_t),u_size:new o.bq(D,u.u_size),u_camera_to_center_distance:new o.bq(D,u.u_camera_to_center_distance),u_pitch:new o.bq(D,u.u_pitch),u_rotate_symbol:new o.b_(D,u.u_rotate_symbol),u_aspect_ratio:new o.bq(D,u.u_aspect_ratio),u_fade_change:new o.bq(D,u.u_fade_change),u_label_plane_matrix:new o.c0(D,u.u_label_plane_matrix),u_coord_matrix:new o.c0(D,u.u_coord_matrix),u_is_text:new o.b_(D,u.u_is_text),u_pitch_with_map:new o.b_(D,u.u_pitch_with_map),u_is_along_line:new o.b_(D,u.u_is_along_line),u_is_variable_anchor:new o.b_(D,u.u_is_variable_anchor),u_texsize:new o.c3(D,u.u_texsize),u_texture:new o.b_(D,u.u_texture),u_translation:new o.c3(D,u.u_translation),u_pitched_scale:new o.bq(D,u.u_pitched_scale)}),symbolSDF:(D,u)=>({u_is_size_zoom_constant:new o.b_(D,u.u_is_size_zoom_constant),u_is_size_feature_constant:new o.b_(D,u.u_is_size_feature_constant),u_size_t:new o.bq(D,u.u_size_t),u_size:new o.bq(D,u.u_size),u_camera_to_center_distance:new o.bq(D,u.u_camera_to_center_distance),u_pitch:new o.bq(D,u.u_pitch),u_rotate_symbol:new o.b_(D,u.u_rotate_symbol),u_aspect_ratio:new o.bq(D,u.u_aspect_ratio),u_fade_change:new o.bq(D,u.u_fade_change),u_label_plane_matrix:new o.c0(D,u.u_label_plane_matrix),u_coord_matrix:new o.c0(D,u.u_coord_matrix),u_is_text:new o.b_(D,u.u_is_text),u_pitch_with_map:new o.b_(D,u.u_pitch_with_map),u_is_along_line:new o.b_(D,u.u_is_along_line),u_is_variable_anchor:new o.b_(D,u.u_is_variable_anchor),u_texsize:new o.c3(D,u.u_texsize),u_texture:new o.b_(D,u.u_texture),u_gamma_scale:new o.bq(D,u.u_gamma_scale),u_device_pixel_ratio:new o.bq(D,u.u_device_pixel_ratio),u_is_halo:new o.b_(D,u.u_is_halo),u_translation:new o.c3(D,u.u_translation),u_pitched_scale:new o.bq(D,u.u_pitched_scale)}),symbolTextAndIcon:(D,u)=>({u_is_size_zoom_constant:new o.b_(D,u.u_is_size_zoom_constant),u_is_size_feature_constant:new o.b_(D,u.u_is_size_feature_constant),u_size_t:new o.bq(D,u.u_size_t),u_size:new o.bq(D,u.u_size),u_camera_to_center_distance:new o.bq(D,u.u_camera_to_center_distance),u_pitch:new o.bq(D,u.u_pitch),u_rotate_symbol:new o.b_(D,u.u_rotate_symbol),u_aspect_ratio:new o.bq(D,u.u_aspect_ratio),u_fade_change:new o.bq(D,u.u_fade_change),u_label_plane_matrix:new o.c0(D,u.u_label_plane_matrix),u_coord_matrix:new o.c0(D,u.u_coord_matrix),u_is_text:new o.b_(D,u.u_is_text),u_pitch_with_map:new o.b_(D,u.u_pitch_with_map),u_is_along_line:new o.b_(D,u.u_is_along_line),u_is_variable_anchor:new o.b_(D,u.u_is_variable_anchor),u_texsize:new o.c3(D,u.u_texsize),u_texsize_icon:new o.c3(D,u.u_texsize_icon),u_texture:new o.b_(D,u.u_texture),u_texture_icon:new o.b_(D,u.u_texture_icon),u_gamma_scale:new o.bq(D,u.u_gamma_scale),u_device_pixel_ratio:new o.bq(D,u.u_device_pixel_ratio),u_is_halo:new o.b_(D,u.u_is_halo),u_translation:new o.c3(D,u.u_translation),u_pitched_scale:new o.bq(D,u.u_pitched_scale)}),background:(D,u)=>({u_opacity:new o.bq(D,u.u_opacity),u_color:new o.b$(D,u.u_color)}),backgroundPattern:(D,u)=>({u_opacity:new o.bq(D,u.u_opacity),u_image:new o.b_(D,u.u_image),u_pattern_tl_a:new o.c3(D,u.u_pattern_tl_a),u_pattern_br_a:new o.c3(D,u.u_pattern_br_a),u_pattern_tl_b:new o.c3(D,u.u_pattern_tl_b),u_pattern_br_b:new o.c3(D,u.u_pattern_br_b),u_texsize:new o.c3(D,u.u_texsize),u_mix:new o.bq(D,u.u_mix),u_pattern_size_a:new o.c3(D,u.u_pattern_size_a),u_pattern_size_b:new o.c3(D,u.u_pattern_size_b),u_scale_a:new o.bq(D,u.u_scale_a),u_scale_b:new o.bq(D,u.u_scale_b),u_pixel_coord_upper:new o.c3(D,u.u_pixel_coord_upper),u_pixel_coord_lower:new o.c3(D,u.u_pixel_coord_lower),u_tile_units_to_pixels:new o.bq(D,u.u_tile_units_to_pixels)}),terrain:(D,u)=>({u_texture:new o.b_(D,u.u_texture),u_ele_delta:new o.bq(D,u.u_ele_delta),u_fog_matrix:new o.c0(D,u.u_fog_matrix),u_fog_color:new o.b$(D,u.u_fog_color),u_fog_ground_blend:new o.bq(D,u.u_fog_ground_blend),u_fog_ground_blend_opacity:new o.bq(D,u.u_fog_ground_blend_opacity),u_horizon_color:new o.b$(D,u.u_horizon_color),u_horizon_fog_blend:new o.bq(D,u.u_horizon_fog_blend),u_is_globe_mode:new o.bq(D,u.u_is_globe_mode)}),terrainDepth:(D,u)=>({u_ele_delta:new o.bq(D,u.u_ele_delta)}),terrainCoords:(D,u)=>({u_texture:new o.b_(D,u.u_texture),u_terrain_coords_id:new o.bq(D,u.u_terrain_coords_id),u_ele_delta:new o.bq(D,u.u_ele_delta)}),projectionErrorMeasurement:(D,u)=>({u_input:new o.bq(D,u.u_input),u_output_expected:new o.bq(D,u.u_output_expected)}),atmosphere:(D,u)=>({u_sun_pos:new o.c2(D,u.u_sun_pos),u_atmosphere_blend:new o.bq(D,u.u_atmosphere_blend),u_globe_position:new o.c2(D,u.u_globe_position),u_globe_radius:new o.bq(D,u.u_globe_radius),u_inv_proj_matrix:new o.c0(D,u.u_inv_proj_matrix)}),sky:(D,u)=>({u_sky_color:new o.b$(D,u.u_sky_color),u_horizon_color:new o.b$(D,u.u_horizon_color),u_horizon:new o.c3(D,u.u_horizon),u_horizon_normal:new o.c3(D,u.u_horizon_normal),u_sky_horizon_blend:new o.bq(D,u.u_sky_horizon_blend),u_sky_blend:new o.bq(D,u.u_sky_blend)})};class me{constructor(u,g,w){this.context=u;const C=u.gl;this.buffer=C.createBuffer(),this.dynamicDraw=!!w,this.context.unbindVAO(),u.bindElementBuffer.set(this.buffer),C.bufferData(C.ELEMENT_ARRAY_BUFFER,g.arrayBuffer,this.dynamicDraw?C.DYNAMIC_DRAW:C.STATIC_DRAW),this.dynamicDraw||delete g.arrayBuffer}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(u){const g=this.context.gl;if(!this.dynamicDraw)throw new Error("Attempted to update data while not in dynamic mode.");this.context.unbindVAO(),this.bind(),g.bufferSubData(g.ELEMENT_ARRAY_BUFFER,0,u.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const Oe={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class tt{constructor(u,g,w,C){this.length=g.length,this.attributes=w,this.itemSize=g.bytesPerElement,this.dynamicDraw=C,this.context=u;const L=u.gl;this.buffer=L.createBuffer(),u.bindVertexBuffer.set(this.buffer),L.bufferData(L.ARRAY_BUFFER,g.arrayBuffer,this.dynamicDraw?L.DYNAMIC_DRAW:L.STATIC_DRAW),this.dynamicDraw||delete g.arrayBuffer}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(u){if(u.length!==this.length)throw new Error(`Length of new data is ${u.length}, which doesn't match current length of ${this.length}`);const g=this.context.gl;this.bind(),g.bufferSubData(g.ARRAY_BUFFER,0,u.arrayBuffer)}enableAttributes(u,g){for(let w=0;w<this.attributes.length;w++){const C=g.attributes[this.attributes[w].name];C!==void 0&&u.enableVertexAttribArray(C)}}setVertexAttribPointers(u,g,w){for(let C=0;C<this.attributes.length;C++){const L=this.attributes[C],z=g.attributes[L.name];z!==void 0&&u.vertexAttribPointer(z,L.components,u[Oe[L.type]],!1,this.itemSize,L.offset+this.itemSize*(w||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class ft{constructor(u){this.gl=u.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(u){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class rr extends ft{getDefault(){return o.bp.transparent}set(u){const g=this.current;(u.r!==g.r||u.g!==g.g||u.b!==g.b||u.a!==g.a||this.dirty)&&(this.gl.clearColor(u.r,u.g,u.b,u.a),this.current=u,this.dirty=!1)}}class ur extends ft{getDefault(){return 1}set(u){(u!==this.current||this.dirty)&&(this.gl.clearDepth(u),this.current=u,this.dirty=!1)}}class qr extends ft{getDefault(){return 0}set(u){(u!==this.current||this.dirty)&&(this.gl.clearStencil(u),this.current=u,this.dirty=!1)}}class bn extends ft{getDefault(){return[!0,!0,!0,!0]}set(u){const g=this.current;(u[0]!==g[0]||u[1]!==g[1]||u[2]!==g[2]||u[3]!==g[3]||this.dirty)&&(this.gl.colorMask(u[0],u[1],u[2],u[3]),this.current=u,this.dirty=!1)}}class Dn extends ft{getDefault(){return!0}set(u){(u!==this.current||this.dirty)&&(this.gl.depthMask(u),this.current=u,this.dirty=!1)}}class Xn extends ft{getDefault(){return 255}set(u){(u!==this.current||this.dirty)&&(this.gl.stencilMask(u),this.current=u,this.dirty=!1)}}class Fn extends ft{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(u){const g=this.current;(u.func!==g.func||u.ref!==g.ref||u.mask!==g.mask||this.dirty)&&(this.gl.stencilFunc(u.func,u.ref,u.mask),this.current=u,this.dirty=!1)}}class En extends ft{getDefault(){const u=this.gl;return[u.KEEP,u.KEEP,u.KEEP]}set(u){const g=this.current;(u[0]!==g[0]||u[1]!==g[1]||u[2]!==g[2]||this.dirty)&&(this.gl.stencilOp(u[0],u[1],u[2]),this.current=u,this.dirty=!1)}}class na extends ft{getDefault(){return!1}set(u){if(u===this.current&&!this.dirty)return;const g=this.gl;u?g.enable(g.STENCIL_TEST):g.disable(g.STENCIL_TEST),this.current=u,this.dirty=!1}}class ca extends ft{getDefault(){return[0,1]}set(u){const g=this.current;(u[0]!==g[0]||u[1]!==g[1]||this.dirty)&&(this.gl.depthRange(u[0],u[1]),this.current=u,this.dirty=!1)}}class so extends ft{getDefault(){return!1}set(u){if(u===this.current&&!this.dirty)return;const g=this.gl;u?g.enable(g.DEPTH_TEST):g.disable(g.DEPTH_TEST),this.current=u,this.dirty=!1}}class ka extends ft{getDefault(){return this.gl.LESS}set(u){(u!==this.current||this.dirty)&&(this.gl.depthFunc(u),this.current=u,this.dirty=!1)}}class Ho extends ft{getDefault(){return!1}set(u){if(u===this.current&&!this.dirty)return;const g=this.gl;u?g.enable(g.BLEND):g.disable(g.BLEND),this.current=u,this.dirty=!1}}class Ks extends ft{getDefault(){const u=this.gl;return[u.ONE,u.ZERO]}set(u){const g=this.current;(u[0]!==g[0]||u[1]!==g[1]||this.dirty)&&(this.gl.blendFunc(u[0],u[1]),this.current=u,this.dirty=!1)}}class Pl extends ft{getDefault(){return o.bp.transparent}set(u){const g=this.current;(u.r!==g.r||u.g!==g.g||u.b!==g.b||u.a!==g.a||this.dirty)&&(this.gl.blendColor(u.r,u.g,u.b,u.a),this.current=u,this.dirty=!1)}}class hu extends ft{getDefault(){return this.gl.FUNC_ADD}set(u){(u!==this.current||this.dirty)&&(this.gl.blendEquation(u),this.current=u,this.dirty=!1)}}class du extends ft{getDefault(){return!1}set(u){if(u===this.current&&!this.dirty)return;const g=this.gl;u?g.enable(g.CULL_FACE):g.disable(g.CULL_FACE),this.current=u,this.dirty=!1}}class Ps extends ft{getDefault(){return this.gl.BACK}set(u){(u!==this.current||this.dirty)&&(this.gl.cullFace(u),this.current=u,this.dirty=!1)}}class Gl extends ft{getDefault(){return this.gl.CCW}set(u){(u!==this.current||this.dirty)&&(this.gl.frontFace(u),this.current=u,this.dirty=!1)}}class Wl extends ft{getDefault(){return null}set(u){(u!==this.current||this.dirty)&&(this.gl.useProgram(u),this.current=u,this.dirty=!1)}}class Eo extends ft{getDefault(){return this.gl.TEXTURE0}set(u){(u!==this.current||this.dirty)&&(this.gl.activeTexture(u),this.current=u,this.dirty=!1)}}class ni extends ft{getDefault(){const u=this.gl;return[0,0,u.drawingBufferWidth,u.drawingBufferHeight]}set(u){const g=this.current;(u[0]!==g[0]||u[1]!==g[1]||u[2]!==g[2]||u[3]!==g[3]||this.dirty)&&(this.gl.viewport(u[0],u[1],u[2],u[3]),this.current=u,this.dirty=!1)}}class Nu extends ft{getDefault(){return null}set(u){if(u===this.current&&!this.dirty)return;const g=this.gl;g.bindFramebuffer(g.FRAMEBUFFER,u),this.current=u,this.dirty=!1}}class th extends ft{getDefault(){return null}set(u){if(u===this.current&&!this.dirty)return;const g=this.gl;g.bindRenderbuffer(g.RENDERBUFFER,u),this.current=u,this.dirty=!1}}class bf extends ft{getDefault(){return null}set(u){if(u===this.current&&!this.dirty)return;const g=this.gl;g.bindTexture(g.TEXTURE_2D,u),this.current=u,this.dirty=!1}}class pu extends ft{getDefault(){return null}set(u){if(u===this.current&&!this.dirty)return;const g=this.gl;g.bindBuffer(g.ARRAY_BUFFER,u),this.current=u,this.dirty=!1}}class Op extends ft{getDefault(){return null}set(u){const g=this.gl;g.bindBuffer(g.ELEMENT_ARRAY_BUFFER,u),this.current=u,this.dirty=!1}}class Vg extends ft{getDefault(){return null}set(u){var g;if(u===this.current&&!this.dirty)return;const w=this.gl;We(w)?w.bindVertexArray(u):(g=w.getExtension("OES_vertex_array_object"))===null||g===void 0||g.bindVertexArrayOES(u),this.current=u,this.dirty=!1}}class $g extends ft{getDefault(){return 4}set(u){if(u===this.current&&!this.dirty)return;const g=this.gl;g.pixelStorei(g.UNPACK_ALIGNMENT,u),this.current=u,this.dirty=!1}}class qg extends ft{getDefault(){return!1}set(u){if(u===this.current&&!this.dirty)return;const g=this.gl;g.pixelStorei(g.UNPACK_PREMULTIPLY_ALPHA_WEBGL,u),this.current=u,this.dirty=!1}}class Od extends ft{getDefault(){return!1}set(u){if(u===this.current&&!this.dirty)return;const g=this.gl;g.pixelStorei(g.UNPACK_FLIP_Y_WEBGL,u),this.current=u,this.dirty=!1}}class qc extends ft{constructor(u,g){super(u),this.context=u,this.parent=g}getDefault(){return null}}class rh extends qc{setDirty(){this.dirty=!0}set(u){if(u===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const g=this.gl;g.framebufferTexture2D(g.FRAMEBUFFER,g.COLOR_ATTACHMENT0,g.TEXTURE_2D,u,0),this.current=u,this.dirty=!1}}class Np extends qc{set(u){if(u===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const g=this.gl;g.framebufferRenderbuffer(g.FRAMEBUFFER,g.DEPTH_ATTACHMENT,g.RENDERBUFFER,u),this.current=u,this.dirty=!1}}class Hg extends qc{set(u){if(u===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const g=this.gl;g.framebufferRenderbuffer(g.FRAMEBUFFER,g.DEPTH_STENCIL_ATTACHMENT,g.RENDERBUFFER,u),this.current=u,this.dirty=!1}}const Lp="Framebuffer is not complete";class Fp{constructor(u,g,w,C,L){this.context=u,this.width=g,this.height=w;const z=u.gl,Y=this.framebuffer=z.createFramebuffer();if(this.colorAttachment=new rh(u,Y),C)this.depthAttachment=L?new Hg(u,Y):new Np(u,Y);else if(L)throw new Error("Stencil cannot be set without depth");if(z.checkFramebufferStatus(z.FRAMEBUFFER)!==z.FRAMEBUFFER_COMPLETE)throw new Error(Lp)}destroy(){const u=this.context.gl,g=this.colorAttachment.get();if(g&&u.deleteTexture(g),this.depthAttachment){const w=this.depthAttachment.get();w&&u.deleteRenderbuffer(w)}u.deleteFramebuffer(this.framebuffer)}}class Bp{constructor(u){var g,w;if(this.gl=u,this.clearColor=new rr(this),this.clearDepth=new ur(this),this.clearStencil=new qr(this),this.colorMask=new bn(this),this.depthMask=new Dn(this),this.stencilMask=new Xn(this),this.stencilFunc=new Fn(this),this.stencilOp=new En(this),this.stencilTest=new na(this),this.depthRange=new ca(this),this.depthTest=new so(this),this.depthFunc=new ka(this),this.blend=new Ho(this),this.blendFunc=new Ks(this),this.blendColor=new Pl(this),this.blendEquation=new hu(this),this.cullFace=new du(this),this.cullFaceSide=new Ps(this),this.frontFace=new Gl(this),this.program=new Wl(this),this.activeTexture=new Eo(this),this.viewport=new ni(this),this.bindFramebuffer=new Nu(this),this.bindRenderbuffer=new th(this),this.bindTexture=new bf(this),this.bindVertexBuffer=new pu(this),this.bindElementBuffer=new Op(this),this.bindVertexArray=new Vg(this),this.pixelStoreUnpack=new $g(this),this.pixelStoreUnpackPremultiplyAlpha=new qg(this),this.pixelStoreUnpackFlipY=new Od(this),this.extTextureFilterAnisotropic=u.getExtension("EXT_texture_filter_anisotropic")||u.getExtension("MOZ_EXT_texture_filter_anisotropic")||u.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=u.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.maxTextureSize=u.getParameter(u.MAX_TEXTURE_SIZE),We(u)){this.HALF_FLOAT=u.HALF_FLOAT;const C=u.getExtension("EXT_color_buffer_half_float");this.RGBA16F=(g=u.RGBA16F)!==null&&g!==void 0?g:C?.RGBA16F_EXT,this.RGB16F=(w=u.RGB16F)!==null&&w!==void 0?w:C?.RGB16F_EXT,u.getExtension("EXT_color_buffer_float")}else{u.getExtension("EXT_color_buffer_half_float"),u.getExtension("OES_texture_half_float_linear");const C=u.getExtension("OES_texture_half_float");this.HALF_FLOAT=C?.HALF_FLOAT_OES}}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArray.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(u,g){return new me(this,u,g)}createVertexBuffer(u,g,w){return new tt(this,u,g,w)}createRenderbuffer(u,g,w){const C=this.gl,L=C.createRenderbuffer();return this.bindRenderbuffer.set(L),C.renderbufferStorage(C.RENDERBUFFER,u,g,w),this.bindRenderbuffer.set(null),L}createFramebuffer(u,g,w,C){return new Fp(this,u,g,w,C)}clear({color:u,depth:g,stencil:w}){const C=this.gl;let L=0;u&&(L|=C.COLOR_BUFFER_BIT,this.clearColor.set(u),this.colorMask.set([!0,!0,!0,!0])),g!==void 0&&(L|=C.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(g),this.depthMask.set(!0)),w!==void 0&&(L|=C.STENCIL_BUFFER_BIT,this.clearStencil.set(w),this.stencilMask.set(255)),C.clear(L)}setCullFace(u){u.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(u.mode),this.frontFace.set(u.frontFace))}setDepthMode(u){u.func!==this.gl.ALWAYS||u.mask?(this.depthTest.set(!0),this.depthFunc.set(u.func),this.depthMask.set(u.mask),this.depthRange.set(u.range)):this.depthTest.set(!1)}setStencilMode(u){u.test.func!==this.gl.ALWAYS||u.mask?(this.stencilTest.set(!0),this.stencilMask.set(u.mask),this.stencilOp.set([u.fail,u.depthFail,u.pass]),this.stencilFunc.set({func:u.test.func,ref:u.ref,mask:u.test.mask})):this.stencilTest.set(!1)}setColorMode(u){o.bR(u.blendFunction,ji.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(u.blendFunction),this.blendColor.set(u.blendColor)),this.colorMask.set(u.mask)}createVertexArray(){var u;return We(this.gl)?this.gl.createVertexArray():(u=this.gl.getExtension("OES_vertex_array_object"))===null||u===void 0?void 0:u.createVertexArrayOES()}deleteVertexArray(u){var g;return We(this.gl)?this.gl.deleteVertexArray(u):(g=this.gl.getExtension("OES_vertex_array_object"))===null||g===void 0?void 0:g.deleteVertexArrayOES(u)}unbindVAO(){this.bindVertexArray.set(null)}}let xf;function nh(D,u,g,w,C){const L=D.context,z=D.transform,Y=L.gl,re=D.useProgram("collisionBox"),le=[];let he=0,Pe=0;for(let dt=0;dt<w.length;dt++){const xt=w[dt],Nt=u.getTile(xt).getBucket(g);if(!Nt)continue;const wt=C?Nt.textCollisionBox:Nt.iconCollisionBox,Lt=Nt.collisionCircleArray;Lt.length>0&&(le.push({circleArray:Lt,circleOffset:Pe,coord:xt}),he+=Lt.length/4,Pe=he),wt&&re.draw(L,Y.LINES,ri.disabled,ai.disabled,D.colorModeForRenderPass(),ii.disabled,Ua(D.transform),D.style.map.terrain&&D.style.map.terrain.getTerrainData(xt),z.getProjectionData({overscaledTileID:xt,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),g.id,wt.layoutVertexBuffer,wt.indexBuffer,wt.segments,null,D.transform.zoom,null,null,wt.collisionVertexBuffer)}if(!C||!le.length)return;const Ae=D.useProgram("collisionCircle"),Ue=new o.ca;Ue.resize(4*he),Ue._trim();let Ze=0;for(const dt of le)for(let xt=0;xt<dt.circleArray.length/4;xt++){const Nt=4*xt,wt=dt.circleArray[Nt+0],Lt=dt.circleArray[Nt+1],jt=dt.circleArray[Nt+2],Dt=dt.circleArray[Nt+3];Ue.emplace(Ze++,wt,Lt,jt,Dt,0),Ue.emplace(Ze++,wt,Lt,jt,Dt,1),Ue.emplace(Ze++,wt,Lt,jt,Dt,2),Ue.emplace(Ze++,wt,Lt,jt,Dt,3)}(!xf||xf.length<2*he)&&(xf=(function(dt){const xt=2*dt,Nt=new o.cc;Nt.resize(xt),Nt._trim();for(let wt=0;wt<xt;wt++){const Lt=6*wt;Nt.uint16[Lt+0]=4*wt+0,Nt.uint16[Lt+1]=4*wt+1,Nt.uint16[Lt+2]=4*wt+2,Nt.uint16[Lt+3]=4*wt+2,Nt.uint16[Lt+4]=4*wt+3,Nt.uint16[Lt+5]=4*wt+0}return Nt})(he));const ht=L.createIndexBuffer(xf,!0),pt=L.createVertexBuffer(Ue,o.cb.members,!0);for(const dt of le){const xt=fu(D.transform);Ae.draw(L,Y.TRIANGLES,ri.disabled,ai.disabled,D.colorModeForRenderPass(),ii.disabled,xt,D.style.map.terrain&&D.style.map.terrain.getTerrainData(dt.coord),null,g.id,pt,ht,o.aX.simpleSegment(0,2*dt.circleOffset,dt.circleArray.length,dt.circleArray.length/2),null,D.transform.zoom,null,null,null)}pt.destroy(),ht.destroy()}const Gg=o.ar(new Float32Array(16));function Wg(D,u,g,w,C,L){const{horizontalAlign:z,verticalAlign:Y}=o.aS(D);return new o.P((-(z-.5)*u/C+w[0])*L,(-(Y-.5)*g/C+w[1])*L)}function ih(D,u,g,w,C,L){const z=u.tileAnchorPoint.add(new o.P(u.translation[0],u.translation[1]));if(u.pitchWithMap){let Y=w.mult(L);g||(Y=Y.rotate(-C));const re=z.add(Y);return zn(re.x,re.y,u.pitchedLabelPlaneMatrix,u.getElevation).point}if(g){const Y=zi(u.tileAnchorPoint.x+1,u.tileAnchorPoint.y,u).point.sub(D),re=Math.atan(Y.y/Y.x)+(Y.x<0?Math.PI:0);return D.add(w.rotate(re))}return D.add(w)}function Nd(D,u,g,w,C,L,z,Y,re,le,he,Pe){const Ae=D.text.placedSymbolArray,Ue=D.text.dynamicLayoutVertexArray,Ze=D.icon.dynamicLayoutVertexArray,ht={};Ue.clear();for(let pt=0;pt<Ae.length;pt++){const dt=Ae.get(pt),xt=dt.hidden||!dt.crossTileID||D.allowVerticalPlacement&&!dt.placedOrientation?null:w[dt.crossTileID];if(xt){const Nt=new o.P(dt.anchorX,dt.anchorY),wt={getElevation:Pe,width:C.width,height:C.height,pitchedLabelPlaneMatrix:L,pitchWithMap:g,transform:C,tileAnchorPoint:Nt,translation:le,unwrappedTileID:he},Lt=g?ga(Nt.x,Nt.y,wt):zi(Nt.x,Nt.y,wt),jt=La(C.cameraToCenterDistance,Lt.signedDistanceFromCamera);let Dt=o.aA(D.textSizeData,Y,dt)*jt/o.aM;g&&(Dt*=D.tilePixelRatio/z);const{width:Zt,height:Sr,anchor:pr,textOffset:_r,textBoxScale:xr}=xt,an=Wg(pr,Zt,Sr,_r,xr,Dt),ln=C.getPitchedTextCorrection(Nt.x+le[0],Nt.y+le[1],he),Hr=ih(Lt.point,wt,u,an,-C.bearingInRadians,ln),gn=D.allowVerticalPlacement&&dt.placedOrientation===o.az.vertical?Math.PI/2:0;for(let Ti=0;Ti<dt.numGlyphs;Ti++)o.aG(Ue,Hr,gn);re&&dt.associatedIconIndex>=0&&(ht[dt.associatedIconIndex]={shiftedAnchor:Hr,angle:gn})}else Ul(dt.numGlyphs,Ue)}if(re){Ze.clear();const pt=D.icon.placedSymbolArray;for(let dt=0;dt<pt.length;dt++){const xt=pt.get(dt);if(xt.hidden)Ul(xt.numGlyphs,Ze);else{const Nt=ht[dt];if(Nt)for(let wt=0;wt<xt.numGlyphs;wt++)o.aG(Ze,Nt.shiftedAnchor,Nt.angle);else Ul(xt.numGlyphs,Ze)}}D.icon.dynamicLayoutVertexBuffer.updateData(Ze)}D.text.dynamicLayoutVertexBuffer.updateData(Ue)}function Ly(D,u,g){return g.iconsInText&&u?"symbolTextAndIcon":D?"symbolSDF":"symbolIcon"}function Ld(D,u,g,w,C,L,z,Y,re,le,he,Pe,Ae){const Ue=D.context,Ze=Ue.gl,ht=D.transform,pt=Y==="map",dt=re==="map",xt=Y!=="viewport"&&g.layout.get("symbol-placement")!=="point",Nt=pt&&!dt&&!xt,wt=!g.layout.get("symbol-sort-key").isConstant();let Lt=!1;const jt=D.getDepthModeForSublayer(0,ri.ReadOnly),Dt=g._unevaluatedLayout.hasValue("text-variable-anchor")||g._unevaluatedLayout.hasValue("text-variable-anchor-offset"),Zt=[],Sr=ht.getCircleRadiusCorrection();for(const pr of w){const _r=u.getTile(pr),xr=_r.getBucket(g);if(!xr)continue;const an=C?xr.text:xr.icon;if(!an||!an.segments.get().length||!an.hasVisibleVertices)continue;const ln=an.programConfigurations.get(g.id),Hr=C||xr.sdfIcons,gn=C?xr.textSizeData:xr.iconSizeData,Ti=dt||ht.pitch!==0,Ra=D.useProgram(Ly(Hr,C,xr),ln),yo=o.ay(gn,ht.zoom),to=D.style.map.terrain&&D.style.map.terrain.getTerrainData(pr);let Ao,ro,Xo,Io,pl=[0,0],vs=null;if(C)ro=_r.glyphAtlasTexture,Xo=Ze.LINEAR,Ao=_r.glyphAtlasTexture.size,xr.iconsInText&&(pl=_r.imageAtlasTexture.size,vs=_r.imageAtlasTexture,Io=Ti||D.options.rotating||D.options.zooming||gn.kind==="composite"||gn.kind==="camera"?Ze.LINEAR:Ze.NEAREST);else{const lo=g.layout.get("icon-size").constantOr(0)!==1||xr.iconsNeedLinear;ro=_r.imageAtlasTexture,Xo=Hr||D.options.rotating||D.options.zooming||lo||Ti?Ze.LINEAR:Ze.NEAREST,Ao=_r.imageAtlasTexture.size}const as=o.aN(_r,1,D.transform.zoom),Ml=ei(pt,D.transform,as),Yh=o.N();o.aB(Yh,Ml);const lh=ua(dt,pt,D.transform,as),Af=o.aO(ht,_r,L,z),zu=ht.getProjectionData({overscaledTileID:pr,applyGlobeMatrix:!Ae,applyTerrainMatrix:!0}),$d=Dt&&xr.hasTextData(),em=g.layout.get("icon-text-fit")!=="none"&&$d&&xr.hasIconData();if(xt){const lo=D.style.map.terrain?(Js,Qs)=>D.style.map.terrain.getElevation(pr,Js,Qs):null,no=g.layout.get("text-rotation-alignment")==="map";hs(xr,D,C,Ml,Yh,dt,le,no,pr.toUnwrapped(),ht.width,ht.height,Af,lo)}const qd=C&&Dt||em,Ec=xt||qd?Gg:dt?Ml:D.transform.clipSpaceToPixelsMatrix,If=Hr&&g.paint.get(C?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let Xc;Xc=Hr?xr.iconsInText?y(gn.kind,yo,Nt,dt,xt,qd,D,Ec,lh,Af,Ao,pl,Sr):I(gn.kind,yo,Nt,dt,xt,qd,D,Ec,lh,Af,C,Ao,0,Sr):Pn(gn.kind,yo,Nt,dt,xt,qd,D,Ec,lh,Af,C,Ao,Sr);const Yc={program:Ra,buffers:an,uniformValues:Xc,projectionData:zu,atlasTexture:ro,atlasTextureIcon:vs,atlasInterpolation:Xo,atlasInterpolationIcon:Io,isSDF:Hr,hasHalo:If};if(wt&&xr.canOverlap){Lt=!0;const lo=an.segments.get();for(const no of lo)Zt.push({segments:new o.aX([no]),sortKey:no.sortKey,state:Yc,terrainData:to})}else Zt.push({segments:an.segments,sortKey:0,state:Yc,terrainData:to})}Lt&&Zt.sort(((pr,_r)=>pr.sortKey-_r.sortKey));for(const pr of Zt){const _r=pr.state;if(Ue.activeTexture.set(Ze.TEXTURE0),_r.atlasTexture.bind(_r.atlasInterpolation,Ze.CLAMP_TO_EDGE),_r.atlasTextureIcon&&(Ue.activeTexture.set(Ze.TEXTURE1),_r.atlasTextureIcon&&_r.atlasTextureIcon.bind(_r.atlasInterpolationIcon,Ze.CLAMP_TO_EDGE)),_r.isSDF){const xr=_r.uniformValues;_r.hasHalo&&(xr.u_is_halo=1,Fd(_r.buffers,pr.segments,g,D,_r.program,jt,he,Pe,xr,_r.projectionData,pr.terrainData)),xr.u_is_halo=0}Fd(_r.buffers,pr.segments,g,D,_r.program,jt,he,Pe,_r.uniformValues,_r.projectionData,pr.terrainData)}}function Fd(D,u,g,w,C,L,z,Y,re,le,he){const Pe=w.context;C.draw(Pe,Pe.gl.TRIANGLES,L,z,Y,ii.backCCW,re,he,le,g.id,D.layoutVertexBuffer,D.indexBuffer,u,g.paint,w.transform.zoom,D.programConfigurations.get(g.id),D.dynamicLayoutVertexBuffer,D.opacityVertexBuffer)}function Fy(D,u,g,w,C){const L=D.context,z=L.gl,Y=ai.disabled,re=new ji([z.ONE,z.ONE],o.bp.transparent,[!0,!0,!0,!0]),le=u.getBucket(g);if(!le)return;const he=w.key;let Pe=g.heatmapFbos.get(he);Pe||(Pe=Bd(L,u.tileSize,u.tileSize),g.heatmapFbos.set(he,Pe)),L.bindFramebuffer.set(Pe.framebuffer),L.viewport.set([0,0,u.tileSize,u.tileSize]),L.clear({color:o.bp.transparent});const Ae=le.programConfigurations.get(g.id),Ue=D.useProgram("heatmap",Ae,!C),Ze=D.transform.getProjectionData({overscaledTileID:u.tileID,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),ht=D.style.map.terrain.getTerrainData(w);Ue.draw(L,z.TRIANGLES,ri.disabled,Y,re,ii.disabled,ms(u,D.transform.zoom,g.paint.get("heatmap-intensity"),1),ht,Ze,g.id,le.layoutVertexBuffer,le.indexBuffer,le.segments,g.paint,D.transform.zoom,Ae)}function By(D,u,g,w,C){const L=D.context,z=L.gl,Y=D.transform;L.setColorMode(D.colorModeForRenderPass());const re=zp(L,u),le=g.key,he=u.heatmapFbos.get(le);if(!he)return;L.activeTexture.set(z.TEXTURE0),z.bindTexture(z.TEXTURE_2D,he.colorAttachment.get()),L.activeTexture.set(z.TEXTURE1),re.bind(z.LINEAR,z.CLAMP_TO_EDGE);const Pe=Y.getProjectionData({overscaledTileID:g,applyTerrainMatrix:C,applyGlobeMatrix:!w});D.useProgram("heatmapTexture").draw(L,z.TRIANGLES,ri.disabled,ai.disabled,D.colorModeForRenderPass(),ii.disabled,Va(D,u,0,1),null,Pe,u.id,D.rasterBoundsBuffer,D.quadTriangleIndexBuffer,D.rasterBoundsSegments,u.paint,Y.zoom),he.destroy(),u.heatmapFbos.delete(le)}function Bd(D,u,g){var w,C;const L=D.gl,z=L.createTexture();L.bindTexture(L.TEXTURE_2D,z),L.texParameteri(L.TEXTURE_2D,L.TEXTURE_WRAP_S,L.CLAMP_TO_EDGE),L.texParameteri(L.TEXTURE_2D,L.TEXTURE_WRAP_T,L.CLAMP_TO_EDGE),L.texParameteri(L.TEXTURE_2D,L.TEXTURE_MIN_FILTER,L.LINEAR),L.texParameteri(L.TEXTURE_2D,L.TEXTURE_MAG_FILTER,L.LINEAR);const Y=(w=D.HALF_FLOAT)!==null&&w!==void 0?w:L.UNSIGNED_BYTE,re=(C=D.RGBA16F)!==null&&C!==void 0?C:L.RGBA;L.texImage2D(L.TEXTURE_2D,0,re,u,g,0,L.RGBA,Y,null);const le=D.createFramebuffer(u,g,!1,!1);return le.colorAttachment.set(z),le}function zp(D,u){return u.colorRampTexture||(u.colorRampTexture=new o.T(D,u.colorRamp,D.gl.RGBA)),u.colorRampTexture}function Hc(D,u,g,w,C,L,z,Y){let re=256;if(C.stepInterpolant){const le=u.getSource().maxzoom,he=z.canonical.z===le?Math.ceil(1<<D.transform.maxZoom-z.canonical.z):1;re=o.an(o.ce(L.maxLineLength/o.a5*1024*he),256,g.maxTextureSize)}return Y.gradient=o.cf({expression:C.gradientExpression(),evaluationKey:"lineProgress",resolution:re,image:Y.gradient||void 0,clips:L.lineClipsArray}),Y.texture?Y.texture.update(Y.gradient):Y.texture=new o.T(g,Y.gradient,w.RGBA),Y.version=C.gradientVersion,Y.texture}function Lu(D,u,g,w,C){D.activeTexture.set(u.TEXTURE0),g.imageAtlasTexture.bind(u.LINEAR,u.CLAMP_TO_EDGE),w.updatePaintBuffers(C)}function xa(D,u,g,w,C,L){(C||D.lineAtlas.dirty)&&(u.activeTexture.set(g.TEXTURE0),D.lineAtlas.bind(u)),w.updatePaintBuffers(L)}function ah(D,u,g,w,C,L,z){const Y=L.gradients[C.id];let re=Y.texture;C.gradientVersion!==Y.version&&(re=Hc(D,u,g,w,C,L,z,Y)),g.activeTexture.set(w.TEXTURE0),re.bind(C.stepInterpolant?w.NEAREST:w.LINEAR,w.CLAMP_TO_EDGE)}function Xl(D,u,g,w,C,L,z,Y,re){const le=L.gradients[C.id];let he=le.texture;C.gradientVersion!==le.version&&(he=Hc(D,u,g,w,C,L,z,le)),g.activeTexture.set(w.TEXTURE0),he.bind(C.stepInterpolant?w.NEAREST:w.LINEAR,w.CLAMP_TO_EDGE),g.activeTexture.set(w.TEXTURE1),D.lineAtlas.bind(g),Y.updatePaintBuffers(re)}function ac(D,u,g,w,C){if(!g||!w||!w.imageAtlas)return;const L=w.imageAtlas.patternPositions;let z=L[g.to.toString()],Y=L[g.from.toString()];if(!z&&Y&&(z=Y),!Y&&z&&(Y=z),!z||!Y){const re=C.getPaintProperty(u);z=L[re],Y=L[re]}z&&Y&&D.setConstantPatternPositions(z,Y)}function dl(D,u,g,w,C,L,z,Y){const re=D.context.gl,le="fill-pattern",he=g.paint.get(le),Pe=he&&he.constantOr(1),Ae=g.getCrossfadeParameters();let Ue,Ze,ht,pt,dt;const xt=D.transform,Nt=g.paint.get("fill-translate"),wt=g.paint.get("fill-translate-anchor");z?(Ze=Pe&&!g.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",Ue=re.LINES):(Ze=Pe?"fillPattern":"fill",Ue=re.TRIANGLES);const Lt=he.constantOr(null);for(const jt of w){const Dt=u.getTile(jt);if(Pe&&!Dt.patternsLoaded())continue;const Zt=Dt.getBucket(g);if(!Zt)continue;const Sr=Zt.programConfigurations.get(g.id),pr=D.useProgram(Ze,Sr),_r=D.style.map.terrain&&D.style.map.terrain.getTerrainData(jt);Pe&&(D.context.activeTexture.set(re.TEXTURE0),Dt.imageAtlasTexture.bind(re.LINEAR,re.CLAMP_TO_EDGE),Sr.updatePaintBuffers(Ae)),ac(Sr,le,Lt,Dt,g);const xr=xt.getProjectionData({overscaledTileID:jt,applyGlobeMatrix:!Y,applyTerrainMatrix:!0}),an=o.aO(xt,Dt,Nt,wt);if(z){pt=Zt.indexBuffer2,dt=Zt.segments2;const Hr=[re.drawingBufferWidth,re.drawingBufferHeight];ht=Ze==="fillOutlinePattern"&&Pe?mo(D,Ae,Dt,Hr,an):Oo(Hr,an)}else pt=Zt.indexBuffer,dt=Zt.segments,ht=Pe?cu(D,Ae,Dt,an):{u_fill_translate:an};const ln=D.stencilModeForClipping(jt);pr.draw(D.context,Ue,C,ln,L,ii.backCCW,ht,_r,xr,g.id,Zt.layoutVertexBuffer,pt,dt,g.paint,D.transform.zoom,Sr)}}function jp(D,u,g,w,C,L,z,Y){const re=D.context,le=re.gl,he="fill-extrusion-pattern",Pe=g.paint.get(he),Ae=Pe.constantOr(1),Ue=g.getCrossfadeParameters(),Ze=g.paint.get("fill-extrusion-opacity"),ht=Pe.constantOr(null),pt=D.transform;for(const dt of w){const xt=u.getTile(dt),Nt=xt.getBucket(g);if(!Nt)continue;const wt=D.style.map.terrain&&D.style.map.terrain.getTerrainData(dt),Lt=Nt.programConfigurations.get(g.id),jt=D.useProgram(Ae?"fillExtrusionPattern":"fillExtrusion",Lt);Ae&&(D.context.activeTexture.set(le.TEXTURE0),xt.imageAtlasTexture.bind(le.LINEAR,le.CLAMP_TO_EDGE),Lt.updatePaintBuffers(Ue));const Dt=pt.getProjectionData({overscaledTileID:dt,applyGlobeMatrix:!Y,applyTerrainMatrix:!0});ac(Lt,he,ht,xt,g);const Zt=o.aO(pt,xt,g.paint.get("fill-extrusion-translate"),g.paint.get("fill-extrusion-translate-anchor")),Sr=g.paint.get("fill-extrusion-vertical-gradient"),pr=Ae?ul(D,Sr,Ze,Zt,dt,Ue,xt):ic(D,Sr,Ze,Zt);jt.draw(re,re.gl.TRIANGLES,C,L,z,ii.backCCW,pr,wt,Dt,g.id,Nt.layoutVertexBuffer,Nt.indexBuffer,Nt.segments,g.paint,D.transform.zoom,Lt,D.style.map.terrain&&Nt.centroidVertexBuffer)}}function wf(D,u,g,w,C,L,z,Y,re){var le;const he=D.style.projection,Pe=D.context,Ae=D.transform,Ue=Pe.gl,Ze=[`#define NUM_ILLUMINATION_SOURCES ${g.paint.get("hillshade-highlight-color").values.length}`],ht=D.useProgram("hillshade",null,!1,Ze),pt=!D.options.moving;for(const dt of w){const xt=u.getTile(dt),Nt=xt.fbo;if(!Nt)continue;const wt=he.getMeshFromTileID(Pe,dt.canonical,Y,!0,"raster"),Lt=(le=D.style.map.terrain)===null||le===void 0?void 0:le.getTerrainData(dt);Pe.activeTexture.set(Ue.TEXTURE0),Ue.bindTexture(Ue.TEXTURE_2D,Nt.colorAttachment.get());const jt=Ae.getProjectionData({overscaledTileID:dt,aligned:pt,applyGlobeMatrix:!re,applyTerrainMatrix:!0});ht.draw(Pe,Ue.TRIANGLES,L,C[dt.overscaledZ],z,ii.backCCW,Vl(D,xt,g),Lt,jt,g.id,wt.vertexBuffer,wt.indexBuffer,wt.segments)}}function zh(D,u,g,w,C,L,z,Y,re){var le;const he=D.style.projection,Pe=D.context,Ae=D.transform,Ue=Pe.gl,Ze=D.useProgram("colorRelief"),ht=!D.options.moving;let pt=!0,dt=0;for(const xt of w){const Nt=u.getTile(xt),wt=Nt.dem;if(pt){const pr=Ue.getParameter(Ue.MAX_TEXTURE_SIZE),{elevationTexture:_r,colorTexture:xr}=g.getColorRampTextures(Pe,pr,wt.getUnpackVector());Pe.activeTexture.set(Ue.TEXTURE1),_r.bind(Ue.NEAREST,Ue.CLAMP_TO_EDGE),Pe.activeTexture.set(Ue.TEXTURE4),xr.bind(Ue.LINEAR,Ue.CLAMP_TO_EDGE),pt=!1,dt=_r.size[0]}if(!wt||!wt.data)continue;const Lt=wt.stride,jt=wt.getPixels();if(Pe.activeTexture.set(Ue.TEXTURE0),Pe.pixelStoreUnpackPremultiplyAlpha.set(!1),Nt.demTexture=Nt.demTexture||D.getTileTexture(Lt),Nt.demTexture){const pr=Nt.demTexture;pr.update(jt,{premultiply:!1}),pr.bind(Ue.LINEAR,Ue.CLAMP_TO_EDGE)}else Nt.demTexture=new o.T(Pe,jt,Ue.RGBA,{premultiply:!1}),Nt.demTexture.bind(Ue.LINEAR,Ue.CLAMP_TO_EDGE);const Dt=he.getMeshFromTileID(Pe,xt.canonical,Y,!0,"raster"),Zt=(le=D.style.map.terrain)===null||le===void 0?void 0:le.getTerrainData(xt),Sr=Ae.getProjectionData({overscaledTileID:xt,aligned:ht,applyGlobeMatrix:!re,applyTerrainMatrix:!0});Ze.draw(Pe,Ue.TRIANGLES,L,C[xt.overscaledZ],z,ii.backCCW,$l(g,Nt.dem,dt),Zt,Sr,g.id,Dt.vertexBuffer,Dt.indexBuffer,Dt.segments)}}const Sf=[new o.P(0,0),new o.P(o.a5,0),new o.P(o.a5,o.a5),new o.P(0,o.a5)];function oh(D,u,g,w,C,L,z,Y,re=!1,le=!1){const he=w[w.length-1].overscaledZ,Pe=D.context,Ae=Pe.gl,Ue=D.useProgram("raster"),Ze=D.transform,ht=D.style.projection,pt=D.colorModeForRenderPass(),dt=!D.options.moving,xt=g.paint.get("raster-opacity"),Nt=g.paint.get("raster-resampling"),wt=g.paint.get("raster-fade-duration"),Lt=!!D.style.map.terrain;for(const jt of w){const Dt=D.getDepthModeForSublayer(jt.overscaledZ-he,xt===1?ri.ReadWrite:ri.ReadOnly,Ae.LESS),Zt=u.getTile(jt),Sr=Nt==="nearest"?Ae.NEAREST:Ae.LINEAR;Pe.activeTexture.set(Ae.TEXTURE0),Zt.texture.bind(Sr,Ae.CLAMP_TO_EDGE,Ae.LINEAR_MIPMAP_NEAREST),Pe.activeTexture.set(Ae.TEXTURE1);const{parentTile:pr,parentScaleBy:_r,parentTopLeft:xr,fadeValues:an}=Xg(Zt,u,wt,Lt);Zt.fadeOpacity=an.tileOpacity,pr?(pr.fadeOpacity=an.parentTileOpacity,pr.texture.bind(Sr,Ae.CLAMP_TO_EDGE,Ae.LINEAR_MIPMAP_NEAREST)):Zt.texture.bind(Sr,Ae.CLAMP_TO_EDGE,Ae.LINEAR_MIPMAP_NEAREST),Zt.texture.useMipmap&&Pe.extTextureFilterAnisotropic&&D.transform.pitch>20&&Ae.texParameterf(Ae.TEXTURE_2D,Pe.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,Pe.extTextureFilterAnisotropicMax);const ln=D.style.map.terrain&&D.style.map.terrain.getTerrainData(jt),Hr=Ze.getProjectionData({overscaledTileID:jt,aligned:dt,applyGlobeMatrix:!le,applyTerrainMatrix:!0}),gn=In(xr,_r,an.fadeMix,g,Y),Ti=ht.getMeshFromTileID(Pe,jt.canonical,L,z,"raster");Ue.draw(Pe,Ae.TRIANGLES,Dt,C?C[jt.overscaledZ]:ai.disabled,pt,re?ii.frontCCW:ii.backCCW,gn,ln,Hr,g.id,Ti.vertexBuffer,Ti.indexBuffer,Ti.segments)}}function Xg(D,u,g,w){const C={parentTile:null,parentScaleBy:1,parentTopLeft:[0,0],fadeValues:{tileOpacity:1,parentTileOpacity:1,fadeMix:{opacity:1,mix:0}}};if(g===0||w)return C;if(D.fadingParentID){const L=u.getLoadedTile(D.fadingParentID);if(!L)return C;const z=Math.pow(2,L.tileID.overscaledZ-D.tileID.overscaledZ),Y=[D.tileID.canonical.x*z%1,D.tileID.canonical.y*z%1],re=(function(le,he,Pe){const Ae=T(),Ue=(Ae-he.timeAdded)/Pe,Ze=le.fadingDirection===ct.Incoming,ht=o.an((Ae-le.timeAdded)/Pe,0,1),pt=o.an(1-Ue,0,1),dt=Ze?ht:pt;return{tileOpacity:dt,parentTileOpacity:Ze?pt:ht,fadeMix:{opacity:1,mix:1-dt}}})(D,L,g);return{parentTile:L,parentScaleBy:z,parentTopLeft:Y,fadeValues:re}}if(D.selfFading){const L=(function(z,Y){const re=(T()-z.timeAdded)/Y,le=o.an(re,0,1);return{tileOpacity:le,fadeMix:{opacity:le,mix:0}}})(D,g);return{parentTile:null,parentScaleBy:1,parentTopLeft:[0,0],fadeValues:L}}return C}const zy=new o.bp(1,0,0,1),zd=new o.bp(0,1,0,1),jd=new o.bp(0,0,1,1),jh=new o.bp(1,0,1,1),Sc=new o.bp(0,1,1,1);function Yg(D,u,g,w){Ud(D,0,u+g/2,D.transform.width,g,w)}function Up(D,u,g,w){Ud(D,u-g/2,0,g,D.transform.height,w)}function Ud(D,u,g,w,C,L){const z=D.context,Y=z.gl;Y.enable(Y.SCISSOR_TEST),Y.scissor(u*D.pixelRatio,g*D.pixelRatio,w*D.pixelRatio,C*D.pixelRatio),z.clear({color:L}),Y.disable(Y.SCISSOR_TEST)}function jy(D,u,g){const w=D.context,C=w.gl,L=D.useProgram("debug"),z=ri.disabled,Y=ai.disabled,re=D.colorModeForRenderPass(),le="$debug",he=D.style.map.terrain&&D.style.map.terrain.getTerrainData(g);w.activeTexture.set(C.TEXTURE0);const Pe=u.getTileByID(g.key).latestRawTileData,Ae=Math.floor((Pe&&Pe.byteLength||0)/1024),Ue=u.getTile(g).tileSize,Ze=512/Math.min(Ue,512)*(g.overscaledZ/D.transform.zoom)*.5;let ht=g.canonical.toString();g.overscaledZ!==g.canonical.z&&(ht+=` => ${g.overscaledZ}`),(function(dt,xt){dt.initDebugOverlayCanvas();const Nt=dt.debugOverlayCanvas,wt=dt.context.gl,Lt=dt.debugOverlayCanvas.getContext("2d");Lt.clearRect(0,0,Nt.width,Nt.height),Lt.shadowColor="white",Lt.shadowBlur=2,Lt.lineWidth=1.5,Lt.strokeStyle="white",Lt.textBaseline="top",Lt.font="bold 36px Open Sans, sans-serif",Lt.fillText(xt,5,5),Lt.strokeText(xt,5,5),dt.debugOverlayTexture.update(Nt),dt.debugOverlayTexture.bind(wt.LINEAR,wt.CLAMP_TO_EDGE)})(D,`${ht} ${Ae}kB`);const pt=D.transform.getProjectionData({overscaledTileID:g,applyGlobeMatrix:!0,applyTerrainMatrix:!0});L.draw(w,C.TRIANGLES,z,Y,ji.alphaBlended,ii.disabled,Zs(o.bp.transparent,Ze),null,pt,le,D.debugBuffer,D.quadTriangleIndexBuffer,D.debugSegments),L.draw(w,C.LINE_STRIP,z,Y,re,ii.disabled,Zs(o.bp.red),he,pt,le,D.debugBuffer,D.tileBorderIndexBuffer,D.debugSegments)}function Zg(D,u,g,w){const{isRenderingGlobe:C}=w,L=D.context,z=L.gl,Y=D.transform,re=D.colorModeForRenderPass(),le=D.getDepthModeFor3D(),he=D.useProgram("terrain");L.bindFramebuffer.set(null),L.viewport.set([0,0,D.width,D.height]);for(const Pe of g){const Ae=u.getTerrainMesh(Pe.tileID),Ue=D.renderToTexture.getTexture(Pe),Ze=u.getTerrainData(Pe.tileID);L.activeTexture.set(z.TEXTURE0),z.bindTexture(z.TEXTURE_2D,Ue.texture);const ht=u.getMeshFrameDelta(Y.zoom),pt=Y.calculateFogMatrix(Pe.tileID.toUnwrapped()),dt=uu(ht,pt,D.style.sky,Y.pitch,C),xt=Y.getProjectionData({overscaledTileID:Pe.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0});he.draw(L,z.TRIANGLES,le,ai.disabled,re,ii.backCCW,dt,Ze,xt,"terrain",Ae.vertexBuffer,Ae.indexBuffer,Ae.segments)}}function Kg(D,u){if(!u.mesh){const g=new o.aW;g.emplaceBack(-1,-1),g.emplaceBack(1,-1),g.emplaceBack(1,1),g.emplaceBack(-1,1);const w=new o.aY;w.emplaceBack(0,1,2),w.emplaceBack(0,2,3),u.mesh=new fi(D.createVertexBuffer(g,$i.members),D.createIndexBuffer(w),o.aX.simpleSegment(0,0,g.length,w.length))}return u.mesh}class Uy{constructor(u,g){this.context=new Bp(u),this.transform=g,this._tileTextures={},this.terrainFacilitator={dirty:!0,matrix:o.ar(new Float64Array(16)),renderTime:0},this.setup(),this.numSublayers=Ci.maxOverzooming+Ci.maxUnderzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new _n}resize(u,g,w){if(this.width=Math.floor(u*w),this.height=Math.floor(g*w),this.pixelRatio=w,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const C of this.style._order)this.style._layers[C].resize()}setup(){const u=this.context,g=new o.aW;g.emplaceBack(0,0),g.emplaceBack(o.a5,0),g.emplaceBack(0,o.a5),g.emplaceBack(o.a5,o.a5),this.tileExtentBuffer=u.createVertexBuffer(g,$i.members),this.tileExtentSegments=o.aX.simpleSegment(0,0,4,2);const w=new o.aW;w.emplaceBack(0,0),w.emplaceBack(o.a5,0),w.emplaceBack(0,o.a5),w.emplaceBack(o.a5,o.a5),this.debugBuffer=u.createVertexBuffer(w,$i.members),this.debugSegments=o.aX.simpleSegment(0,0,4,5);const C=new o.ch;C.emplaceBack(0,0,0,0),C.emplaceBack(o.a5,0,o.a5,0),C.emplaceBack(0,o.a5,0,o.a5),C.emplaceBack(o.a5,o.a5,o.a5,o.a5),this.rasterBoundsBuffer=u.createVertexBuffer(C,Ja.members),this.rasterBoundsSegments=o.aX.simpleSegment(0,0,4,2);const L=new o.aW;L.emplaceBack(0,0),L.emplaceBack(o.a5,0),L.emplaceBack(0,o.a5),L.emplaceBack(o.a5,o.a5),this.rasterBoundsBufferPosOnly=u.createVertexBuffer(L,$i.members),this.rasterBoundsSegmentsPosOnly=o.aX.simpleSegment(0,0,4,5);const z=new o.aW;z.emplaceBack(0,0),z.emplaceBack(1,0),z.emplaceBack(0,1),z.emplaceBack(1,1),this.viewportBuffer=u.createVertexBuffer(z,$i.members),this.viewportSegments=o.aX.simpleSegment(0,0,4,2);const Y=new o.ci;Y.emplaceBack(0),Y.emplaceBack(1),Y.emplaceBack(3),Y.emplaceBack(2),Y.emplaceBack(0),this.tileBorderIndexBuffer=u.createIndexBuffer(Y);const re=new o.aY;re.emplaceBack(1,0,2),re.emplaceBack(1,2,3),this.quadTriangleIndexBuffer=u.createIndexBuffer(re);const le=this.context.gl;this.stencilClearMode=new ai({func:le.ALWAYS,mask:0},0,255,le.ZERO,le.ZERO,le.ZERO),this.tileExtentMesh=new fi(this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}clearStencil(){const u=this.context,g=u.gl;this.nextStencilID=1,this.currentStencilSource=void 0;const w=o.N();o.c7(w,0,this.width,this.height,0,0,1),o.Q(w,w,[g.drawingBufferWidth,g.drawingBufferHeight,0]);const C={mainMatrix:w,tileMercatorCoords:[0,0,1,1],clippingPlane:[0,0,0,0],projectionTransition:0,fallbackMatrix:w};this.useProgram("clippingMask",null,!0).draw(u,g.TRIANGLES,ri.disabled,this.stencilClearMode,ji.disabled,ii.disabled,null,null,C,"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}_renderTileClippingMasks(u,g,w){if(this.currentStencilSource===u.source||!u.isTileClipped()||!g||!g.length)return;this.currentStencilSource=u.source,this.nextStencilID+g.length>256&&this.clearStencil();const C=this.context;C.setColorMode(ji.disabled),C.setDepthMode(ri.disabled);const L={};for(const z of g)L[z.key]=this.nextStencilID++;this._renderTileMasks(L,g,w,!0),this._renderTileMasks(L,g,w,!1),this._tileClippingMaskIDs=L}_renderTileMasks(u,g,w,C){const L=this.context,z=L.gl,Y=this.style.projection,re=this.transform,le=this.useProgram("clippingMask");for(const he of g){const Pe=u[he.key],Ae=this.style.map.terrain&&this.style.map.terrain.getTerrainData(he),Ue=Y.getMeshFromTileID(this.context,he.canonical,C,!0,"stencil"),Ze=re.getProjectionData({overscaledTileID:he,applyGlobeMatrix:!w,applyTerrainMatrix:!0});le.draw(L,z.TRIANGLES,ri.disabled,new ai({func:z.ALWAYS,mask:0},Pe,255,z.KEEP,z.KEEP,z.REPLACE),ji.disabled,w?ii.disabled:ii.backCCW,null,Ae,Ze,"$clipping",Ue.vertexBuffer,Ue.indexBuffer,Ue.segments)}}_renderTilesDepthBuffer(){const u=this.context,g=u.gl,w=this.style.projection,C=this.transform,L=this.useProgram("depth"),z=this.getDepthModeFor3D(),Y=Kn(C,{tileSize:C.tileSize});for(const re of Y){const le=this.style.map.terrain&&this.style.map.terrain.getTerrainData(re),he=w.getMeshFromTileID(this.context,re.canonical,!0,!0,"raster"),Pe=C.getProjectionData({overscaledTileID:re,applyGlobeMatrix:!0,applyTerrainMatrix:!0});L.draw(u,g.TRIANGLES,z,ai.disabled,ji.disabled,ii.backCCW,null,le,Pe,"$clipping",he.vertexBuffer,he.indexBuffer,he.segments)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const u=this.nextStencilID++,g=this.context.gl;return new ai({func:g.NOTEQUAL,mask:255},u,255,g.KEEP,g.KEEP,g.REPLACE)}stencilModeForClipping(u){const g=this.context.gl;return new ai({func:g.EQUAL,mask:255},this._tileClippingMaskIDs[u.key],0,g.KEEP,g.KEEP,g.REPLACE)}getStencilConfigForOverlapAndUpdateStencilID(u){const g=this.context.gl,w=u.sort(((z,Y)=>Y.overscaledZ-z.overscaledZ)),C=w[w.length-1].overscaledZ,L=w[0].overscaledZ-C+1;if(L>1){this.currentStencilSource=void 0,this.nextStencilID+L>256&&this.clearStencil();const z={};for(let Y=0;Y<L;Y++)z[Y+C]=new ai({func:g.GEQUAL,mask:255},Y+this.nextStencilID,255,g.KEEP,g.KEEP,g.REPLACE);return this.nextStencilID+=L,[z,w]}return[{[C]:ai.disabled},w]}stencilConfigForOverlapTwoPass(u){const g=this.context.gl,w=u.sort(((z,Y)=>Y.overscaledZ-z.overscaledZ)),C=w[w.length-1].overscaledZ,L=w[0].overscaledZ-C+1;if(this.clearStencil(),L>1){const z={},Y={};for(let re=0;re<L;re++)z[re+C]=new ai({func:g.GREATER,mask:255},L+1+re,255,g.KEEP,g.KEEP,g.REPLACE),Y[re+C]=new ai({func:g.GREATER,mask:255},1+re,255,g.KEEP,g.KEEP,g.REPLACE);return this.nextStencilID=2*L+1,[z,Y,w]}return this.nextStencilID=3,[{[C]:new ai({func:g.GREATER,mask:255},2,255,g.KEEP,g.KEEP,g.REPLACE)},{[C]:new ai({func:g.GREATER,mask:255},1,255,g.KEEP,g.KEEP,g.REPLACE)},w]}colorModeForRenderPass(){const u=this.context.gl;return this._showOverdrawInspector?new ji([u.CONSTANT_COLOR,u.ONE],new o.bp(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?ji.unblended:ji.alphaBlended}getDepthModeForSublayer(u,g,w){if(!this.opaquePassEnabledForLayer())return ri.disabled;const C=1-((1+this.currentLayer)*this.numSublayers+u)*this.depthEpsilon;return new ri(w||this.context.gl.LEQUAL,g,[C,C])}getDepthModeFor3D(){return new ri(this.context.gl.LEQUAL,ri.ReadWrite,this.depthRangeFor3D)}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(u,g){var w,C;this.style=u,this.options=g,this.lineAtlas=u.lineAtlas,this.imageManager=u.imageManager,this.glyphManager=u.glyphManager,this.symbolFadeChange=u.placement.symbolFadeChange(T()),this.imageManager.beginFrame();const L=this.style._order,z=this.style.tileManagers,Y={},re={},le={},he={isRenderingToTexture:!1,isRenderingGlobe:((w=u.projection)===null||w===void 0?void 0:w.transitionState)>0};for(const Ae in z){const Ue=z[Ae];Ue.used&&Ue.prepare(this.context),Y[Ae]=Ue.getVisibleCoordinates(!1),re[Ae]=Y[Ae].slice().reverse(),le[Ae]=Ue.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let Ae=0;Ae<L.length;Ae++)if(this.style._layers[L[Ae]].is3D()){this.opaquePassCutoff=Ae;break}this.maybeDrawDepthAndCoords(!1),this.renderToTexture&&(this.renderToTexture.prepareForRender(this.style,this.transform.zoom),this.opaquePassCutoff=0),this.renderPass="offscreen";for(const Ae of L){const Ue=this.style._layers[Ae];if(!Ue.hasOffscreenPass()||Ue.isHidden(this.transform.zoom))continue;const Ze=re[Ue.source];(Ue.type==="custom"||Ze.length)&&this.renderLayer(this,z[Ue.source],Ue,Ze,he)}if((C=this.style.projection)===null||C===void 0||C.updateGPUdependent({context:this.context,useProgram:Ae=>this.useProgram(Ae)}),this.context.viewport.set([0,0,this.width,this.height]),this.context.bindFramebuffer.set(null),this.context.clear({color:g.showOverdrawInspector?o.bp.black:o.bp.transparent,depth:1}),this.clearStencil(),this.style.sky&&(function(Ae,Ue){const Ze=Ae.context,ht=Ze.gl,pt=((jt,Dt,Zt)=>{const Sr=Math.cos(Dt.rollInRadians),pr=Math.sin(Dt.rollInRadians),_r=fn(Dt),xr=Dt.getProjectionData({overscaledTileID:null,applyGlobeMatrix:!0,applyTerrainMatrix:!0}).projectionTransition;return{u_sky_color:jt.properties.get("sky-color"),u_horizon_color:jt.properties.get("horizon-color"),u_horizon:[(Dt.width/2-_r*pr)*Zt,(Dt.height/2+_r*Sr)*Zt],u_horizon_normal:[-pr,Sr],u_sky_horizon_blend:jt.properties.get("sky-horizon-blend")*Dt.height/2*Zt,u_sky_blend:xr}})(Ue,Ae.style.map.transform,Ae.pixelRatio),dt=new ri(ht.LEQUAL,ri.ReadWrite,[0,1]),xt=ai.disabled,Nt=Ae.colorModeForRenderPass(),wt=Ae.useProgram("sky"),Lt=Kg(Ze,Ue);wt.draw(Ze,ht.TRIANGLES,dt,xt,Nt,ii.disabled,pt,null,void 0,"sky",Lt.vertexBuffer,Lt.indexBuffer,Lt.segments)})(this,this.style.sky),this._showOverdrawInspector=g.showOverdrawInspector,this.depthRangeFor3D=[0,1-(u._order.length+2)*this.numSublayers*this.depthEpsilon],!this.renderToTexture)for(this.renderPass="opaque",this.currentLayer=L.length-1;this.currentLayer>=0;this.currentLayer--){const Ae=this.style._layers[L[this.currentLayer]],Ue=z[Ae.source],Ze=Y[Ae.source];this._renderTileClippingMasks(Ae,Ze,!1),this.renderLayer(this,Ue,Ae,Ze,he)}this.renderPass="translucent";let Pe=!1;for(this.currentLayer=0;this.currentLayer<L.length;this.currentLayer++){const Ae=this.style._layers[L[this.currentLayer]],Ue=z[Ae.source];if(this.renderToTexture&&this.renderToTexture.renderLayer(Ae,he))continue;this.opaquePassEnabledForLayer()||Pe||(Pe=!0,he.isRenderingGlobe&&!this.style.map.terrain&&this._renderTilesDepthBuffer());const Ze=(Ae.type==="symbol"?le:re)[Ae.source];this._renderTileClippingMasks(Ae,Y[Ae.source],!!this.renderToTexture),this.renderLayer(this,Ue,Ae,Ze,he)}if(he.isRenderingGlobe&&(function(Ae,Ue,Ze){const ht=Ae.context,pt=ht.gl,dt=Ae.useProgram("atmosphere"),xt=new ri(pt.LEQUAL,ri.ReadOnly,[0,1]),Nt=Ae.transform,wt=(function(xr,an){const ln=xr.properties.get("position"),Hr=[-ln.x,-ln.y,-ln.z],gn=o.ar(new Float64Array(16));return xr.properties.get("anchor")==="map"&&(o.bg(gn,gn,an.rollInRadians),o.bh(gn,gn,-an.pitchInRadians),o.bg(gn,gn,an.bearingInRadians),o.bh(gn,gn,an.center.lat*Math.PI/180),o.bJ(gn,gn,-an.center.lng*Math.PI/180)),o.cg(Hr,Hr,gn),Hr})(Ze,Ae.transform),Lt=Nt.getProjectionData({overscaledTileID:null,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),jt=Ue.properties.get("atmosphere-blend")*Lt.projectionTransition;if(jt===0)return;const Dt=Ui(Nt.worldSize,Nt.center.lat),Zt=Nt.inverseProjectionMatrix,Sr=new Float64Array(4);Sr[3]=1,o.aH(Sr,Sr,Nt.modelViewProjectionMatrix),Sr[0]/=Sr[3],Sr[1]/=Sr[3],Sr[2]/=Sr[3],Sr[3]=1,o.aH(Sr,Sr,Zt),Sr[0]/=Sr[3],Sr[1]/=Sr[3],Sr[2]/=Sr[3],Sr[3]=1;const pr=((xr,an,ln,Hr,gn)=>({u_sun_pos:xr,u_atmosphere_blend:an,u_globe_position:ln,u_globe_radius:Hr,u_inv_proj_matrix:gn}))(wt,jt,[Sr[0],Sr[1],Sr[2]],Dt,Zt),_r=Kg(ht,Ue);dt.draw(ht,pt.TRIANGLES,xt,ai.disabled,ji.alphaBlended,ii.disabled,pr,null,null,"atmosphere",_r.vertexBuffer,_r.indexBuffer,_r.segments)})(this,this.style.sky,this.style.light),this.options.showTileBoundaries){const Ae=(function(Ue,Ze){let ht=null;const pt=Object.values(Ue._layers).flatMap((wt=>wt.source&&!wt.isHidden(Ze)?[Ue.tileManagers[wt.source]]:[])),dt=pt.filter((wt=>wt.getSource().type==="vector")),xt=pt.filter((wt=>wt.getSource().type!=="vector")),Nt=wt=>{(!ht||ht.getSource().maxzoom<wt.getSource().maxzoom)&&(ht=wt)};return dt.forEach((wt=>Nt(wt))),ht||xt.forEach((wt=>Nt(wt))),ht})(this.style,this.transform.zoom);Ae&&(function(Ue,Ze,ht){for(let pt=0;pt<ht.length;pt++)jy(Ue,Ze,ht[pt])})(this,Ae,Ae.getVisibleCoordinates())}this.options.showPadding&&(function(Ae){const Ue=Ae.transform.padding;Yg(Ae,Ae.transform.height-(Ue.top||0),3,zy),Yg(Ae,Ue.bottom||0,3,zd),Up(Ae,Ue.left||0,3,jd),Up(Ae,Ae.transform.width-(Ue.right||0),3,jh);const Ze=Ae.transform.centerPoint;(function(ht,pt,dt,xt){Ud(ht,pt-1,dt-10,2,20,xt),Ud(ht,pt-10,dt-1,20,2,xt)})(Ae,Ze.x,Ae.transform.height-Ze.y,Sc)})(this),this.context.setDefault()}maybeDrawDepthAndCoords(u){if(!this.style||!this.style.map||!this.style.map.terrain)return;const g=this.terrainFacilitator.matrix,w=this.transform.modelViewProjectionMatrix;let C=this.terrainFacilitator.dirty;C||(C=u?!o.cj(g,w):!o.ck(g,w)),C||(C=this.style.map.terrain.tileManager.anyTilesAfterTime(this.terrainFacilitator.renderTime)),C&&(o.cl(g,w),this.terrainFacilitator.renderTime=Date.now(),this.terrainFacilitator.dirty=!1,(function(L,z){const Y=L.context,re=Y.gl,le=L.transform,he=ji.unblended,Pe=new ri(re.LEQUAL,ri.ReadWrite,[0,1]),Ae=z.tileManager.getRenderableTiles(),Ue=L.useProgram("terrainDepth");Y.bindFramebuffer.set(z.getFramebuffer("depth").framebuffer),Y.viewport.set([0,0,L.width/devicePixelRatio,L.height/devicePixelRatio]),Y.clear({color:o.bp.transparent,depth:1});for(const Ze of Ae){const ht=z.getTerrainMesh(Ze.tileID),pt=z.getTerrainData(Ze.tileID),dt=le.getProjectionData({overscaledTileID:Ze.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0}),xt={u_ele_delta:z.getMeshFrameDelta(le.zoom)};Ue.draw(Y,re.TRIANGLES,Pe,ai.disabled,he,ii.backCCW,xt,pt,dt,"terrain",ht.vertexBuffer,ht.indexBuffer,ht.segments)}Y.bindFramebuffer.set(null),Y.viewport.set([0,0,L.width,L.height])})(this,this.style.map.terrain),(function(L,z){const Y=L.context,re=Y.gl,le=L.transform,he=ji.unblended,Pe=new ri(re.LEQUAL,ri.ReadWrite,[0,1]),Ae=z.getCoordsTexture(),Ue=z.tileManager.getRenderableTiles(),Ze=L.useProgram("terrainCoords");Y.bindFramebuffer.set(z.getFramebuffer("coords").framebuffer),Y.viewport.set([0,0,L.width/devicePixelRatio,L.height/devicePixelRatio]),Y.clear({color:o.bp.transparent,depth:1}),z.coordsIndex=[];for(const ht of Ue){const pt=z.getTerrainMesh(ht.tileID),dt=z.getTerrainData(ht.tileID);Y.activeTexture.set(re.TEXTURE0),re.bindTexture(re.TEXTURE_2D,Ae.texture);const xt={u_terrain_coords_id:(255-z.coordsIndex.length)/255,u_texture:0,u_ele_delta:z.getMeshFrameDelta(le.zoom)},Nt=le.getProjectionData({overscaledTileID:ht.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0});Ze.draw(Y,re.TRIANGLES,Pe,ai.disabled,he,ii.backCCW,xt,dt,Nt,"terrain",pt.vertexBuffer,pt.indexBuffer,pt.segments),z.coordsIndex.push(ht.tileID.key)}Y.bindFramebuffer.set(null),Y.viewport.set([0,0,L.width,L.height])})(this,this.style.map.terrain))}renderLayer(u,g,w,C,L){w.isHidden(this.transform.zoom)||(w.type==="background"||w.type==="custom"||(C||[]).length)&&(this.id=w.id,o.cm(w)?(function(z,Y,re,le,he,Pe){if(z.renderPass!=="translucent")return;const{isRenderingToTexture:Ae}=Pe,Ue=ai.disabled,Ze=z.colorModeForRenderPass();(re._unevaluatedLayout.hasValue("text-variable-anchor")||re._unevaluatedLayout.hasValue("text-variable-anchor-offset"))&&(function(ht,pt,dt,xt,Nt,wt,Lt,jt,Dt){const Zt=pt.transform,Sr=pt.style.map.terrain,pr=Nt==="map",_r=wt==="map";for(const xr of ht){const an=xt.getTile(xr),ln=an.getBucket(dt);if(!ln||!ln.text||!ln.text.segments.get().length)continue;const Hr=o.ay(ln.textSizeData,Zt.zoom),gn=o.aN(an,1,pt.transform.zoom),Ti=ei(pr,pt.transform,gn),Ra=dt.layout.get("icon-text-fit")!=="none"&&ln.hasIconData();if(Hr){const yo=Math.pow(2,Zt.zoom-an.tileID.overscaledZ),to=Sr?(Ao,ro)=>Sr.getElevation(xr,Ao,ro):null;Nd(ln,pr,_r,Dt,Zt,Ti,yo,Hr,Ra,o.aO(Zt,an,Lt,jt),xr.toUnwrapped(),to)}}})(le,z,re,Y,re.layout.get("text-rotation-alignment"),re.layout.get("text-pitch-alignment"),re.paint.get("text-translate"),re.paint.get("text-translate-anchor"),he),re.paint.get("icon-opacity").constantOr(1)!==0&&Ld(z,Y,re,le,!1,re.paint.get("icon-translate"),re.paint.get("icon-translate-anchor"),re.layout.get("icon-rotation-alignment"),re.layout.get("icon-pitch-alignment"),re.layout.get("icon-keep-upright"),Ue,Ze,Ae),re.paint.get("text-opacity").constantOr(1)!==0&&Ld(z,Y,re,le,!0,re.paint.get("text-translate"),re.paint.get("text-translate-anchor"),re.layout.get("text-rotation-alignment"),re.layout.get("text-pitch-alignment"),re.layout.get("text-keep-upright"),Ue,Ze,Ae),Y.map.showCollisionBoxes&&(nh(z,Y,re,le,!0),nh(z,Y,re,le,!1))})(u,g,w,C,this.style.placement.variableOffsets,L):o.cn(w)?(function(z,Y,re,le,he){if(z.renderPass!=="translucent")return;const{isRenderingToTexture:Pe}=he,Ae=re.paint.get("circle-opacity"),Ue=re.paint.get("circle-stroke-width"),Ze=re.paint.get("circle-stroke-opacity"),ht=!re.layout.get("circle-sort-key").isConstant();if(Ae.constantOr(1)===0&&(Ue.constantOr(1)===0||Ze.constantOr(1)===0))return;const pt=z.context,dt=pt.gl,xt=z.transform,Nt=z.getDepthModeForSublayer(0,ri.ReadOnly),wt=ai.disabled,Lt=z.colorModeForRenderPass(),jt=[],Dt=xt.getCircleRadiusCorrection();for(let Zt=0;Zt<le.length;Zt++){const Sr=le[Zt],pr=Y.getTile(Sr),_r=pr.getBucket(re);if(!_r)continue;const xr=re.paint.get("circle-translate"),an=re.paint.get("circle-translate-anchor"),ln=o.aO(xt,pr,xr,an),Hr=_r.programConfigurations.get(re.id),gn=z.useProgram("circle",Hr),Ti=_r.layoutVertexBuffer,Ra=_r.indexBuffer,yo=z.style.map.terrain&&z.style.map.terrain.getTerrainData(Sr),to={programConfiguration:Hr,program:gn,layoutVertexBuffer:Ti,indexBuffer:Ra,uniformValues:Du(z,pr,re,ln,Dt),terrainData:yo,projectionData:xt.getProjectionData({overscaledTileID:Sr,applyGlobeMatrix:!Pe,applyTerrainMatrix:!0})};if(ht){const Ao=_r.segments.get();for(const ro of Ao)jt.push({segments:new o.aX([ro]),sortKey:ro.sortKey,state:to})}else jt.push({segments:_r.segments,sortKey:0,state:to})}ht&&jt.sort(((Zt,Sr)=>Zt.sortKey-Sr.sortKey));for(const Zt of jt){const{programConfiguration:Sr,program:pr,layoutVertexBuffer:_r,indexBuffer:xr,uniformValues:an,terrainData:ln,projectionData:Hr}=Zt.state;pr.draw(pt,dt.TRIANGLES,Nt,wt,Lt,ii.backCCW,an,ln,Hr,re.id,_r,xr,Zt.segments,re.paint,z.transform.zoom,Sr)}})(u,g,w,C,L):o.co(w)?(function(z,Y,re,le,he){if(re.paint.get("heatmap-opacity")===0)return;const Pe=z.context,{isRenderingToTexture:Ae,isRenderingGlobe:Ue}=he;if(z.style.map.terrain){for(const Ze of le){const ht=Y.getTile(Ze);Y.hasRenderableParent(Ze)||(z.renderPass==="offscreen"?Fy(z,ht,re,Ze,Ue):z.renderPass==="translucent"&&By(z,re,Ze,Ae,Ue))}Pe.viewport.set([0,0,z.width,z.height])}else z.renderPass==="offscreen"?(function(Ze,ht,pt,dt){const xt=Ze.context,Nt=xt.gl,wt=Ze.transform,Lt=ai.disabled,jt=new ji([Nt.ONE,Nt.ONE],o.bp.transparent,[!0,!0,!0,!0]);(function(Dt,Zt,Sr){const pr=Dt.gl;Dt.activeTexture.set(pr.TEXTURE1),Dt.viewport.set([0,0,Zt.width/4,Zt.height/4]);let _r=Sr.heatmapFbos.get(o.cd);_r?(pr.bindTexture(pr.TEXTURE_2D,_r.colorAttachment.get()),Dt.bindFramebuffer.set(_r.framebuffer)):(_r=Bd(Dt,Zt.width/4,Zt.height/4),Sr.heatmapFbos.set(o.cd,_r))})(xt,Ze,pt),xt.clear({color:o.bp.transparent});for(let Dt=0;Dt<dt.length;Dt++){const Zt=dt[Dt];if(ht.hasRenderableParent(Zt))continue;const Sr=ht.getTile(Zt),pr=Sr.getBucket(pt);if(!pr)continue;const _r=pr.programConfigurations.get(pt.id),xr=Ze.useProgram("heatmap",_r),an=wt.getProjectionData({overscaledTileID:Zt,applyGlobeMatrix:!0,applyTerrainMatrix:!1}),ln=wt.getCircleRadiusCorrection();xr.draw(xt,Nt.TRIANGLES,ri.disabled,Lt,jt,ii.backCCW,ms(Sr,wt.zoom,pt.paint.get("heatmap-intensity"),ln),null,an,pt.id,pr.layoutVertexBuffer,pr.indexBuffer,pr.segments,pt.paint,wt.zoom,_r)}xt.viewport.set([0,0,Ze.width,Ze.height])})(z,Y,re,le):z.renderPass==="translucent"&&(function(Ze,ht){const pt=Ze.context,dt=pt.gl;pt.setColorMode(Ze.colorModeForRenderPass());const xt=ht.heatmapFbos.get(o.cd);xt&&(pt.activeTexture.set(dt.TEXTURE0),dt.bindTexture(dt.TEXTURE_2D,xt.colorAttachment.get()),pt.activeTexture.set(dt.TEXTURE1),zp(pt,ht).bind(dt.LINEAR,dt.CLAMP_TO_EDGE),Ze.useProgram("heatmapTexture").draw(pt,dt.TRIANGLES,ri.disabled,ai.disabled,Ze.colorModeForRenderPass(),ii.disabled,Va(Ze,ht,0,1),null,null,ht.id,Ze.viewportBuffer,Ze.quadTriangleIndexBuffer,Ze.viewportSegments,ht.paint,Ze.transform.zoom))})(z,re)})(u,g,w,C,L):o.cp(w)?(function(z,Y,re,le,he){if(z.renderPass!=="translucent")return;const{isRenderingToTexture:Pe}=he,Ae=re.paint.get("line-opacity"),Ue=re.paint.get("line-width");if(Ae.constantOr(1)===0||Ue.constantOr(1)===0)return;const Ze=z.getDepthModeForSublayer(0,ri.ReadOnly),ht=z.colorModeForRenderPass(),pt=re.paint.get("line-dasharray"),dt=pt.constantOr(1),xt=re.paint.get("line-pattern"),Nt=xt.constantOr(1),wt=re.paint.get("line-gradient"),Lt=re.getCrossfadeParameters();let jt;jt=Nt?"linePattern":dt&&wt?"lineGradientSDF":dt?"lineSDF":wt?"lineGradient":"line";const Dt=z.context,Zt=Dt.gl,Sr=z.transform;let pr=!0;for(const _r of le){const xr=Y.getTile(_r);if(Nt&&!xr.patternsLoaded())continue;const an=xr.getBucket(re);if(!an)continue;const ln=an.programConfigurations.get(re.id),Hr=z.context.program.get(),gn=z.useProgram(jt,ln),Ti=pr||gn.program!==Hr,Ra=z.style.map.terrain&&z.style.map.terrain.getTerrainData(_r),yo=xt.constantOr(null),to=pt&&pt.constantOr(null);if(yo&&xr.imageAtlas){const pl=xr.imageAtlas,vs=pl.patternPositions[yo.to.toString()],as=pl.patternPositions[yo.from.toString()];vs&&as&&ln.setConstantPatternPositions(vs,as)}else if(to){const pl=re.layout.get("line-cap")==="round",vs=z.lineAtlas.getDash(to.to,pl),as=z.lineAtlas.getDash(to.from,pl);ln.setConstantDashPositions(vs,as)}const Ao=Sr.getProjectionData({overscaledTileID:_r,applyGlobeMatrix:!Pe,applyTerrainMatrix:!0}),ro=Sr.getPixelScale();let Xo;Nt?(Xo=Hl(z,xr,re,ro,Lt),Lu(Dt,Zt,xr,ln,Lt)):dt&&wt?(Xo=tr(z,xr,re,ro,Lt,an.lineClipsArray.length),Xl(z,Y,Dt,Zt,re,an,_r,ln,Lt)):dt?(Xo=Ou(z,xr,re,ro,Lt),xa(z,Dt,Zt,ln,Ti,Lt)):wt?(Xo=hl(z,xr,re,ro,an.lineClipsArray.length),ah(z,Y,Dt,Zt,re,an,_r)):Xo=ql(z,xr,re,ro);const Io=z.stencilModeForClipping(_r);gn.draw(Dt,Zt.TRIANGLES,Ze,Io,ht,ii.disabled,Xo,Ra,Ao,re.id,an.layoutVertexBuffer,an.indexBuffer,an.segments,re.paint,z.transform.zoom,ln,an.layoutVertexBuffer2),pr=!1}})(u,g,w,C,L):o.cq(w)?(function(z,Y,re,le,he){const Pe=re.paint.get("fill-color"),Ae=re.paint.get("fill-opacity");if(Ae.constantOr(1)===0)return;const{isRenderingToTexture:Ue}=he,Ze=z.colorModeForRenderPass(),ht=re.paint.get("fill-pattern"),pt=z.opaquePassEnabledForLayer()&&!ht.constantOr(1)&&Pe.constantOr(o.bp.transparent).a===1&&Ae.constantOr(0)===1?"opaque":"translucent";if(z.renderPass===pt){const dt=z.getDepthModeForSublayer(1,z.renderPass==="opaque"?ri.ReadWrite:ri.ReadOnly);dl(z,Y,re,le,dt,Ze,!1,Ue)}if(z.renderPass==="translucent"&&re.paint.get("fill-antialias")){const dt=z.getDepthModeForSublayer(re.getPaintProperty("fill-outline-color")?2:0,ri.ReadOnly);dl(z,Y,re,le,dt,Ze,!0,Ue)}})(u,g,w,C,L):o.cr(w)?(function(z,Y,re,le,he){const Pe=re.paint.get("fill-extrusion-opacity");if(Pe===0)return;const{isRenderingToTexture:Ae}=he;if(z.renderPass==="translucent"){const Ue=new ri(z.context.gl.LEQUAL,ri.ReadWrite,z.depthRangeFor3D);if(Pe!==1||re.paint.get("fill-extrusion-pattern").constantOr(1))jp(z,Y,re,le,Ue,ai.disabled,ji.disabled,Ae),jp(z,Y,re,le,Ue,z.stencilModeFor3D(),z.colorModeForRenderPass(),Ae);else{const Ze=z.colorModeForRenderPass();jp(z,Y,re,le,Ue,ai.disabled,Ze,Ae)}}})(u,g,w,C,L):o.cs(w)?(function(z,Y,re,le,he){if(z.renderPass!=="offscreen"&&z.renderPass!=="translucent")return;const{isRenderingToTexture:Pe}=he,Ae=z.context,Ue=z.style.projection.useSubdivision,Ze=z.getDepthModeForSublayer(0,ri.ReadOnly),ht=z.colorModeForRenderPass();if(z.renderPass==="offscreen")(function(pt,dt,xt,Nt,wt,Lt,jt){const Dt=pt.context,Zt=Dt.gl;for(const Sr of xt){const pr=dt.getTile(Sr),_r=pr.dem;if(!_r||!_r.data||!pr.needsHillshadePrepare)continue;const xr=_r.dim,an=_r.stride,ln=_r.getPixels();if(Dt.activeTexture.set(Zt.TEXTURE1),Dt.pixelStoreUnpackPremultiplyAlpha.set(!1),pr.demTexture=pr.demTexture||pt.getTileTexture(an),pr.demTexture){const gn=pr.demTexture;gn.update(ln,{premultiply:!1}),gn.bind(Zt.NEAREST,Zt.CLAMP_TO_EDGE)}else pr.demTexture=new o.T(Dt,ln,Zt.RGBA,{premultiply:!1}),pr.demTexture.bind(Zt.NEAREST,Zt.CLAMP_TO_EDGE);Dt.activeTexture.set(Zt.TEXTURE0);let Hr=pr.fbo;if(!Hr){const gn=new o.T(Dt,{width:xr,height:xr,data:null},Zt.RGBA);gn.bind(Zt.LINEAR,Zt.CLAMP_TO_EDGE),Hr=pr.fbo=Dt.createFramebuffer(xr,xr,!0,!1),Hr.colorAttachment.set(gn.texture)}Dt.bindFramebuffer.set(Hr.framebuffer),Dt.viewport.set([0,0,xr,xr]),pt.useProgram("hillshadePrepare").draw(Dt,Zt.TRIANGLES,wt,Lt,jt,ii.disabled,cl(pr.tileID,_r),null,null,Nt.id,pt.rasterBoundsBuffer,pt.quadTriangleIndexBuffer,pt.rasterBoundsSegments),pr.needsHillshadePrepare=!1}})(z,Y,le,re,Ze,ai.disabled,ht),Ae.viewport.set([0,0,z.width,z.height]);else if(z.renderPass==="translucent")if(Ue){const[pt,dt,xt]=z.stencilConfigForOverlapTwoPass(le);wf(z,Y,re,xt,pt,Ze,ht,!1,Pe),wf(z,Y,re,xt,dt,Ze,ht,!0,Pe)}else{const[pt,dt]=z.getStencilConfigForOverlapAndUpdateStencilID(le);wf(z,Y,re,dt,pt,Ze,ht,!1,Pe)}})(u,g,w,C,L):o.ct(w)?(function(z,Y,re,le,he){if(z.renderPass!=="translucent"||!le.length)return;const{isRenderingToTexture:Pe}=he,Ae=z.style.projection.useSubdivision,Ue=z.getDepthModeForSublayer(0,ri.ReadOnly),Ze=z.colorModeForRenderPass();if(Ae){const[ht,pt,dt]=z.stencilConfigForOverlapTwoPass(le);zh(z,Y,re,dt,ht,Ue,Ze,!1,Pe),zh(z,Y,re,dt,pt,Ue,Ze,!0,Pe)}else{const[ht,pt]=z.getStencilConfigForOverlapAndUpdateStencilID(le);zh(z,Y,re,pt,ht,Ue,Ze,!1,Pe)}})(u,g,w,C,L):o.bU(w)?(function(z,Y,re,le,he){if(z.renderPass!=="translucent"||re.paint.get("raster-opacity")===0||!le.length)return;const{isRenderingToTexture:Pe}=he,Ae=Y.getSource(),Ue=z.style.projection.useSubdivision;if(Ae instanceof Jt)oh(z,Y,re,le,null,!1,!1,Ae.tileCoords,Ae.flippedWindingOrder,Pe);else if(Ue){const[Ze,ht,pt]=z.stencilConfigForOverlapTwoPass(le);oh(z,Y,re,pt,Ze,!1,!0,Sf,!1,Pe),oh(z,Y,re,pt,ht,!0,!0,Sf,!1,Pe)}else{const[Ze,ht]=z.getStencilConfigForOverlapAndUpdateStencilID(le);oh(z,Y,re,ht,Ze,!1,!0,Sf,!1,Pe)}})(u,g,w,C,L):o.cu(w)?(function(z,Y,re,le,he){const Pe=re.paint.get("background-color"),Ae=re.paint.get("background-opacity");if(Ae===0)return;const{isRenderingToTexture:Ue}=he,Ze=z.context,ht=Ze.gl,pt=z.style.projection,dt=z.transform,xt=dt.tileSize,Nt=re.paint.get("background-pattern");if(z.isPatternMissing(Nt))return;const wt=!Nt&&Pe.a===1&&Ae===1&&z.opaquePassEnabledForLayer()?"opaque":"translucent";if(z.renderPass!==wt)return;const Lt=ai.disabled,jt=z.getDepthModeForSublayer(0,wt==="opaque"?ri.ReadWrite:ri.ReadOnly),Dt=z.colorModeForRenderPass(),Zt=z.useProgram(Nt?"backgroundPattern":"background"),Sr=le||Kn(dt,{tileSize:xt,terrain:z.style.map.terrain});Nt&&(Ze.activeTexture.set(ht.TEXTURE0),z.imageManager.bind(z.context));const pr=re.getCrossfadeParameters();for(const _r of Sr){const xr=dt.getProjectionData({overscaledTileID:_r,applyGlobeMatrix:!Ue,applyTerrainMatrix:!0}),an=Nt?P(Ae,z,Nt,{tileID:_r,tileSize:xt},pr):_(Ae,Pe),ln=z.style.map.terrain&&z.style.map.terrain.getTerrainData(_r),Hr=pt.getMeshFromTileID(Ze,_r.canonical,!1,!0,"raster");Zt.draw(Ze,ht.TRIANGLES,jt,Lt,Dt,ii.backCCW,an,ln,xr,re.id,Hr.vertexBuffer,Hr.indexBuffer,Hr.segments)}})(u,0,w,C,L):o.cv(w)&&(function(z,Y,re,le){const{isRenderingGlobe:he}=le,Pe=z.context,Ae=re.implementation,Ue=z.style.projection,Ze=z.transform,ht=Ze.getProjectionDataForCustomLayer(he),pt={farZ:Ze.farZ,nearZ:Ze.nearZ,fov:Ze.fov*Math.PI/180,modelViewProjectionMatrix:Ze.modelViewProjectionMatrix,projectionMatrix:Ze.projectionMatrix,shaderData:{variantName:Ue.shaderVariantName,vertexShaderPrelude:`const float PI = 3.141592653589793;
uniform mat4 u_projection_matrix;
${Ue.shaderPreludeCode.vertexSource}`,define:Ue.shaderDefine},defaultProjectionData:ht},dt=Ae.renderingMode?Ae.renderingMode:"2d";if(z.renderPass==="offscreen"){const xt=Ae.prerender;xt&&(z.setCustomLayerDefaults(),Pe.setColorMode(z.colorModeForRenderPass()),xt.call(Ae,Pe.gl,pt),Pe.setDirty(),z.setBaseState())}else if(z.renderPass==="translucent"){z.setCustomLayerDefaults(),Pe.setColorMode(z.colorModeForRenderPass()),Pe.setStencilMode(ai.disabled);const xt=dt==="3d"?z.getDepthModeFor3D():z.getDepthModeForSublayer(0,ri.ReadOnly);Pe.setDepthMode(xt),Ae.render(Pe.gl,pt),Pe.setDirty(),z.setBaseState(),Pe.bindFramebuffer.set(null)}})(u,0,w,L))}saveTileTexture(u){const g=this._tileTextures[u.size[0]];g?g.push(u):this._tileTextures[u.size[0]]=[u]}getTileTexture(u){const g=this._tileTextures[u];return g&&g.length>0?g.pop():null}isPatternMissing(u){if(!u)return!1;if(!u.from||!u.to)return!0;const g=this.imageManager.getPattern(u.from.toString()),w=this.imageManager.getPattern(u.to.toString());return!g||!w}useProgram(u,g,w=!1,C=[]){this.cache=this.cache||{};const L=!!this.style.map.terrain,z=this.style.projection,Y=w?hn.projectionMercator:z.shaderPreludeCode,re=w?ba:z.shaderDefine,le=u+(g?g.cacheKey:"")+`/${w?wi:z.shaderVariantName}`+(this._showOverdrawInspector?"/overdraw":"")+(L?"/terrain":"")+(C?`/${C.join("/")}`:"");return this.cache[le]||(this.cache[le]=new Is(this.context,hn[u],g,ne[u],this._showOverdrawInspector,L,Y,re,C)),this.cache[le]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const u=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(u.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new o.T(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){var u,g;if(this._tileTextures){for(const w in this._tileTextures){const C=this._tileTextures[w];if(C)for(const L of C)L.destroy()}this._tileTextures={}}if(this.tileExtentBuffer&&this.tileExtentBuffer.destroy(),this.debugBuffer&&this.debugBuffer.destroy(),this.rasterBoundsBuffer&&this.rasterBoundsBuffer.destroy(),this.rasterBoundsBufferPosOnly&&this.rasterBoundsBufferPosOnly.destroy(),this.viewportBuffer&&this.viewportBuffer.destroy(),this.tileBorderIndexBuffer&&this.tileBorderIndexBuffer.destroy(),this.quadTriangleIndexBuffer&&this.quadTriangleIndexBuffer.destroy(),this.tileExtentMesh&&((u=this.tileExtentMesh.vertexBuffer)===null||u===void 0||u.destroy()),this.tileExtentMesh&&((g=this.tileExtentMesh.indexBuffer)===null||g===void 0||g.destroy()),this.debugOverlayTexture&&this.debugOverlayTexture.destroy(),this.cache){for(const w in this.cache){const C=this.cache[w];C&&C.program&&this.context.gl.deleteProgram(C.program)}this.cache={}}this.context&&this.context.setDefault()}overLimit(){const{drawingBufferWidth:u,drawingBufferHeight:g}=this.context.gl;return this.width!==u||this.height!==g}}function Jg(D,u){let g,w=!1,C=null,L=null;const z=()=>{C=null,w&&(D.apply(L,g),C=setTimeout(z,u),w=!1)};return(...Y)=>(w=!0,L=this,g=Y,C||z(),C)}class Vp{constructor(u){this._getCurrentHash=()=>{const g=window.location.hash.replace("#","");if(this._hashName){let w;return g.split("&").map((C=>C.split("="))).forEach((C=>{C[0]===this._hashName&&(w=C)})),(w&&w[1]||"").split("/")}return g.split("/")},this._onHashChange=()=>{const g=this._getCurrentHash();if(!this._isValidHash(g))return!1;const w=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(g[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+g[2],+g[1]],zoom:+g[0],bearing:w,pitch:+(g[4]||0)}),!0},this._updateHashUnthrottled=()=>{const g=window.location.href.replace(/(#.*)?$/,this.getHashString());window.history.replaceState(window.history.state,null,g)},this._removeHash=()=>{const g=this._getCurrentHash();if(g.length===0)return;const w=g.join("/");let C=w;C.split("&").length>0&&(C=C.split("&")[0]),this._hashName&&(C=`${this._hashName}=${w}`);let L=window.location.hash.replace(C,"");L.startsWith("#&")?L=L.slice(0,1)+L.slice(2):L==="#"&&(L="");let z=window.location.href.replace(/(#.+)?$/,L);z=z.replace("&&","&"),window.history.replaceState(window.history.state,null,z)},this._updateHash=Jg(this._updateHashUnthrottled,300),this._hashName=u&&encodeURIComponent(u)}addTo(u){return this._map=u,addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this}remove(){return removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),this._removeHash(),delete this._map,this}getHashString(u){const g=this._map.getCenter(),w=Math.round(100*this._map.getZoom())/100,C=Math.ceil((w*Math.LN2+Math.log(512/360/.5))/Math.LN10),L=Math.pow(10,C),z=Math.round(g.lng*L)/L,Y=Math.round(g.lat*L)/L,re=this._map.getBearing(),le=this._map.getPitch();let he="";if(he+=u?`/${z}/${Y}/${w}`:`${w}/${Y}/${z}`,(re||le)&&(he+="/"+Math.round(10*re)/10),le&&(he+=`/${Math.round(le)}`),this._hashName){const Pe=this._hashName;let Ae=!1;const Ue=window.location.hash.slice(1).split("&").map((Ze=>{const ht=Ze.split("=")[0];return ht===Pe?(Ae=!0,`${ht}=${he}`):Ze})).filter((Ze=>Ze));return Ae||Ue.push(`${Pe}=${he}`),`#${Ue.join("&")}`}return`#${he}`}_isValidHash(u){if(u.length<3||u.some(isNaN))return!1;try{new o.V(+u[2],+u[1])}catch{return!1}const g=+u[0],w=+(u[3]||0),C=+(u[4]||0);return g>=this._map.getMinZoom()&&g<=this._map.getMaxZoom()&&w>=-180&&w<=180&&C>=this._map.getMinPitch()&&C<=this._map.getMaxPitch()}}const oc={linearity:.3,easing:o.cw(0,0,.3,1)},Vy=o.e({deceleration:2500,maxSpeed:1400},oc),Fu=o.e({deceleration:20,maxSpeed:1400},oc),Bu=o.e({deceleration:1e3,maxSpeed:360},oc),q=o.e({deceleration:1e3,maxSpeed:90},oc),K=o.e({deceleration:1e3,maxSpeed:360},oc);class ge{constructor(u){this._map=u,this.clear()}clear(){this._inertiaBuffer=[]}record(u){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:T(),settings:u})}_drainInertiaBuffer(){const u=this._inertiaBuffer,g=T();for(;u.length>0&&g-u[0].time>160;)u.shift()}_onMoveEnd(u){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const g={zoom:0,bearing:0,pitch:0,roll:0,pan:new o.P(0,0),pinchAround:void 0,around:void 0};for(const{settings:L}of this._inertiaBuffer)g.zoom+=L.zoomDelta||0,g.bearing+=L.bearingDelta||0,g.pitch+=L.pitchDelta||0,g.roll+=L.rollDelta||0,L.panDelta&&g.pan._add(L.panDelta),L.around&&(g.around=L.around),L.pinchAround&&(g.pinchAround=L.pinchAround);const w=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,C={};if(g.pan.mag()){const L=Ye(g.pan.mag(),w,o.e({},Vy,u||{})),z=g.pan.mult(L.amount/g.pan.mag()),Y=this._map.cameraHelper.handlePanInertia(z,this._map.transform);C.center=Y.easingCenter,C.offset=Y.easingOffset,ke(C,L)}if(g.zoom){const L=Ye(g.zoom,w,Fu);C.zoom=this._map.transform.zoom+L.amount,ke(C,L)}if(g.bearing){const L=Ye(g.bearing,w,Bu);C.bearing=this._map.transform.bearing+o.an(L.amount,-179,179),ke(C,L)}if(g.pitch){const L=Ye(g.pitch,w,q);C.pitch=this._map.transform.pitch+L.amount,ke(C,L)}if(g.roll){const L=Ye(g.roll,w,K);C.roll=this._map.transform.roll+o.an(L.amount,-179,179),ke(C,L)}if(C.zoom||C.bearing){const L=g.pinchAround===void 0?g.around:g.pinchAround;C.around=L?this._map.unproject(L):this._map.getCenter()}return this.clear(),o.e(C,{noMoveStart:!0})}}function ke(D,u){(!D.duration||D.duration<u.duration)&&(D.duration=u.duration,D.easing=u.easing)}function Ye(D,u,g){const{maxSpeed:w,linearity:C,deceleration:L}=g,z=o.an(D*C/(u/1e3),-w,w),Y=Math.abs(z)/(L*C);return{easing:g.easing,duration:1e3*Y,amount:z*(Y/2)}}class Je extends o.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(u,g,w,C={}){w=w instanceof MouseEvent?w:new MouseEvent(u,w);const L=A.mousePos(g.getCanvas(),w),z=g.unproject(L);super(u,o.e({point:L,lngLat:z,originalEvent:w},C)),this._defaultPrevented=!1,this.target=g}}class nt extends o.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(u,g,w){const C=u==="touchend"?w.changedTouches:w.touches,L=A.touchPos(g.getCanvasContainer(),C),z=L.map((re=>g.unproject(re))),Y=L.reduce(((re,le,he,Pe)=>re.add(le.div(Pe.length))),new o.P(0,0));super(u,{points:L,point:Y,lngLats:z,lngLat:g.unproject(Y),originalEvent:w}),this._defaultPrevented=!1}}class lt extends o.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(u,g,w){super(u,{originalEvent:w}),this._defaultPrevented=!1}}class yt{constructor(u,g){this._map=u,this._clickTolerance=g.clickTolerance}reset(){delete this._mousedownPos}wheel(u){return this._firePreventable(new lt(u.type,this._map,u))}mousedown(u,g){return this._mousedownPos=g,this._firePreventable(new Je(u.type,this._map,u))}mouseup(u){this._map.fire(new Je(u.type,this._map,u))}click(u,g){this._mousedownPos&&this._mousedownPos.dist(g)>=this._clickTolerance||this._map.fire(new Je(u.type,this._map,u))}dblclick(u){return this._firePreventable(new Je(u.type,this._map,u))}mouseover(u){this._map.fire(new Je(u.type,this._map,u))}mouseout(u){this._map.fire(new Je(u.type,this._map,u))}touchstart(u){return this._firePreventable(new nt(u.type,this._map,u))}touchmove(u){this._map.fire(new nt(u.type,this._map,u))}touchend(u){this._map.fire(new nt(u.type,this._map,u))}touchcancel(u){this._map.fire(new nt(u.type,this._map,u))}_firePreventable(u){if(this._map.fire(u),u.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class At{constructor(u){this._map=u}reset(){this._delayContextMenu=!1,this._ignoreContextMenu=!0,delete this._contextMenuEvent}mousemove(u){this._map.fire(new Je(u.type,this._map,u))}mousedown(){this._delayContextMenu=!0,this._ignoreContextMenu=!1}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new Je("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(u){this._delayContextMenu?this._contextMenuEvent=u:this._ignoreContextMenu||this._map.fire(new Je(u.type,this._map,u)),this._map.listens("contextmenu")&&u.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Yt{constructor(u){this._map=u}get transform(){return this._map._requestedCameraState||this._map.transform}get center(){return{lng:this.transform.center.lng,lat:this.transform.center.lat}}get zoom(){return this.transform.zoom}get pitch(){return this.transform.pitch}get bearing(){return this.transform.bearing}unproject(u){return this.transform.screenPointToLocation(o.P.convert(u),this._map.terrain)}}class br{constructor(u,g){this._map=u,this._tr=new Yt(u),this._el=u.getCanvasContainer(),this._container=u.getContainer(),this._clickTolerance=g.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(u,g){this.isEnabled()&&u.shiftKey&&u.button===0&&(A.disableDrag(),this._startPos=this._lastPos=g,this._active=!0)}mousemoveWindow(u,g){if(!this._active)return;const w=g;if(this._lastPos.equals(w)||!this._box&&w.dist(this._startPos)<this._clickTolerance)return;const C=this._startPos;this._lastPos=w,this._box||(this._box=A.create("div","maplibregl-boxzoom",this._container),this._container.classList.add("maplibregl-crosshair"),this._fireEvent("boxzoomstart",u));const L=Math.min(C.x,w.x),z=Math.max(C.x,w.x),Y=Math.min(C.y,w.y),re=Math.max(C.y,w.y);A.setTransform(this._box,`translate(${L}px,${Y}px)`),this._box.style.width=z-L+"px",this._box.style.height=re-Y+"px"}mouseupWindow(u,g){if(!this._active||u.button!==0)return;const w=this._startPos,C=g;if(this.reset(),A.suppressClick(),w.x!==C.x||w.y!==C.y)return this._map.fire(new o.l("boxzoomend",{originalEvent:u})),{cameraAnimation:L=>L.fitScreenCoordinates(w,C,this._tr.bearing,{linear:!0})};this._fireEvent("boxzoomcancel",u)}keydown(u){this._active&&u.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",u))}reset(){this._active=!1,this._container.classList.remove("maplibregl-crosshair"),this._box&&(A.remove(this._box),this._box=null),A.enableDrag(),delete this._startPos,delete this._lastPos}_fireEvent(u,g){return this._map.fire(new o.l(u,{originalEvent:g}))}}function St(D,u){if(D.length!==u.length)throw new Error(`The number of touches and points are not equal - touches ${D.length}, points ${u.length}`);const g={};for(let w=0;w<D.length;w++)g[D[w].identifier]=u[w];return g}class Pt{constructor(u){this.reset(),this.numTouches=u.numTouches}reset(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}touchstart(u,g,w){(this.centroid||w.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=u.timeStamp),w.length===this.numTouches&&(this.centroid=(function(C){const L=new o.P(0,0);for(const z of C)L._add(z);return L.div(C.length)})(g),this.touches=St(w,g)))}touchmove(u,g,w){if(this.aborted||!this.centroid)return;const C=St(w,g);for(const L in this.touches){const z=C[L];(!z||z.dist(this.touches[L])>30)&&(this.aborted=!0)}}touchend(u,g,w){if((!this.centroid||u.timeStamp-this.startTime>500)&&(this.aborted=!0),w.length===0){const C=!this.aborted&&this.centroid;if(this.reset(),C)return C}}}class hr{constructor(u){this.singleTap=new Pt(u),this.numTaps=u.numTaps,this.reset()}reset(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}touchstart(u,g,w){this.singleTap.touchstart(u,g,w)}touchmove(u,g,w){this.singleTap.touchmove(u,g,w)}touchend(u,g,w){const C=this.singleTap.touchend(u,g,w);if(C){const L=u.timeStamp-this.lastTime<500,z=!this.lastTap||this.lastTap.dist(C)<30;if(L&&z||this.reset(),this.count++,this.lastTime=u.timeStamp,this.lastTap=C,this.count===this.numTaps)return this.reset(),C}}}class Lr{constructor(u){this._tr=new Yt(u),this._zoomIn=new hr({numTouches:1,numTaps:2}),this._zoomOut=new hr({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(u,g,w){this._zoomIn.touchstart(u,g,w),this._zoomOut.touchstart(u,g,w)}touchmove(u,g,w){this._zoomIn.touchmove(u,g,w),this._zoomOut.touchmove(u,g,w)}touchend(u,g,w){const C=this._zoomIn.touchend(u,g,w),L=this._zoomOut.touchend(u,g,w),z=this._tr;return C?(this._active=!0,u.preventDefault(),setTimeout((()=>this.reset()),0),{cameraAnimation:Y=>Y.easeTo({duration:300,zoom:z.zoom+1,around:z.unproject(C)},{originalEvent:u})}):L?(this._active=!0,u.preventDefault(),setTimeout((()=>this.reset()),0),{cameraAnimation:Y=>Y.easeTo({duration:300,zoom:z.zoom-1,around:z.unproject(L)},{originalEvent:u})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class yr{constructor(u){this._enabled=!!u.enable,this._moveStateManager=u.moveStateManager,this._clickTolerance=u.clickTolerance||1,this._moveFunction=u.move,this._activateOnStart=!!u.activateOnStart,u.assignEvents(this),this.reset()}reset(u){this._active=!1,this._moved=!1,delete this._lastPoint,this._moveStateManager.endMove(u)}_move(...u){const g=this._moveFunction(...u);if(g.bearingDelta||g.pitchDelta||g.rollDelta||g.around||g.panDelta)return this._active=!0,g}dragStart(u,g){this.isEnabled()&&!this._lastPoint&&this._moveStateManager.isValidStartEvent(u)&&(this._moveStateManager.startMove(u),this._lastPoint=Array.isArray(g)?g[0]:g,this._activateOnStart&&this._lastPoint&&(this._active=!0))}dragMove(u,g){if(!this.isEnabled())return;const w=this._lastPoint;if(!w)return;if(u.preventDefault(),!this._moveStateManager.isValidMoveEvent(u))return void this.reset(u);const C=Array.isArray(g)?g[0]:g;return!this._moved&&C.dist(w)<this._clickTolerance?void 0:(this._moved=!0,this._lastPoint=C,this._move(w,C))}dragEnd(u){this.isEnabled()&&this._lastPoint&&this._moveStateManager.isValidEndEvent(u)&&(this._moved&&A.suppressClick(),this.reset(u))}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}getClickTolerance(){return this._clickTolerance}}const Br=0,jr=2,sn={[Br]:1,[jr]:2};class Jr{constructor(u){this._correctEvent=u.checkCorrectEvent}startMove(u){const g=A.mouseButton(u);this._eventButton=g}endMove(u){delete this._eventButton}isValidStartEvent(u){return this._correctEvent(u)}isValidMoveEvent(u){return!(function(g,w){const C=sn[w];return g.buttons===void 0||(g.buttons&C)!==C})(u,this._eventButton)}isValidEndEvent(u){return A.mouseButton(u)===this._eventButton}}class Jn{constructor(){this._firstTouch=void 0}_isOneFingerTouch(u){return u.targetTouches.length===1}_isSameTouchEvent(u){return u.targetTouches[0].identifier===this._firstTouch}startMove(u){this._firstTouch=u.targetTouches[0].identifier}endMove(u){delete this._firstTouch}isValidStartEvent(u){return this._isOneFingerTouch(u)}isValidMoveEvent(u){return this._isOneFingerTouch(u)&&this._isSameTouchEvent(u)}isValidEndEvent(u){return this._isOneFingerTouch(u)&&this._isSameTouchEvent(u)}}class Vn{constructor(u=new Jr({checkCorrectEvent:()=>!0}),g=new Jn){this.mouseMoveStateManager=u,this.oneFingerTouchMoveStateManager=g}_executeRelevantHandler(u,g,w){return u instanceof MouseEvent?g(u):typeof TouchEvent<"u"&&u instanceof TouchEvent?w(u):void 0}startMove(u){this._executeRelevantHandler(u,(g=>this.mouseMoveStateManager.startMove(g)),(g=>this.oneFingerTouchMoveStateManager.startMove(g)))}endMove(u){this._executeRelevantHandler(u,(g=>this.mouseMoveStateManager.endMove(g)),(g=>this.oneFingerTouchMoveStateManager.endMove(g)))}isValidStartEvent(u){return this._executeRelevantHandler(u,(g=>this.mouseMoveStateManager.isValidStartEvent(g)),(g=>this.oneFingerTouchMoveStateManager.isValidStartEvent(g)))}isValidMoveEvent(u){return this._executeRelevantHandler(u,(g=>this.mouseMoveStateManager.isValidMoveEvent(g)),(g=>this.oneFingerTouchMoveStateManager.isValidMoveEvent(g)))}isValidEndEvent(u){return this._executeRelevantHandler(u,(g=>this.mouseMoveStateManager.isValidEndEvent(g)),(g=>this.oneFingerTouchMoveStateManager.isValidEndEvent(g)))}}const Ai=D=>{D.mousedown=D.dragStart,D.mousemoveWindow=D.dragMove,D.mouseup=D.dragEnd,D.contextmenu=u=>{u.preventDefault()}};class Zn{constructor(u,g){this._clickTolerance=u.clickTolerance||1,this._map=g,this.reset()}reset(){this._active=!1,this._touches={},this._sum=new o.P(0,0)}_shouldBePrevented(u){return u<(this._map.cooperativeGestures.isEnabled()?2:1)}touchstart(u,g,w){return this._calculateTransform(u,g,w)}touchmove(u,g,w){if(this._active){if(!this._shouldBePrevented(w.length))return u.preventDefault(),this._calculateTransform(u,g,w);this._map.cooperativeGestures.notifyGestureBlocked("touch_pan",u)}}touchend(u,g,w){this._calculateTransform(u,g,w),this._active&&this._shouldBePrevented(w.length)&&this.reset()}touchcancel(){this.reset()}_calculateTransform(u,g,w){w.length>0&&(this._active=!0);const C=St(w,g),L=new o.P(0,0),z=new o.P(0,0);let Y=0;for(const le in C){const he=C[le],Pe=this._touches[le];Pe&&(L._add(he),z._add(he.sub(Pe)),Y++,C[le]=he)}if(this._touches=C,this._shouldBePrevented(Y)||!z.mag())return;const re=z.div(Y);return this._sum._add(re),this._sum.mag()<this._clickTolerance?void 0:{around:L.div(Y),panDelta:re}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Yi{constructor(){this.reset()}reset(){this._active=!1,delete this._firstTwoTouches}touchstart(u,g,w){this._firstTwoTouches||w.length<2||(this._firstTwoTouches=[w[0].identifier,w[1].identifier],this._start([g[0],g[1]]))}touchmove(u,g,w){if(!this._firstTwoTouches)return;u.preventDefault();const[C,L]=this._firstTwoTouches,z=No(w,g,C),Y=No(w,g,L);if(!z||!Y)return;const re=this._aroundCenter?null:z.add(Y).div(2);return this._move([z,Y],re,u)}touchend(u,g,w){if(!this._firstTwoTouches)return;const[C,L]=this._firstTwoTouches,z=No(w,g,C),Y=No(w,g,L);z&&Y||(this._active&&A.suppressClick(),this.reset())}touchcancel(){this.reset()}enable(u){this._enabled=!0,this._aroundCenter=!!u&&u.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}}function No(D,u,g){for(let w=0;w<D.length;w++)if(D[w].identifier===g)return u[w]}function Ni(D,u){return Math.log(D/u)/Math.LN2}class Yn extends Yi{reset(){super.reset(),delete this._distance,delete this._startDistance}_start(u){this._startDistance=this._distance=u[0].dist(u[1])}_move(u,g){const w=this._distance;if(this._distance=u[0].dist(u[1]),this._active||!(Math.abs(Ni(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:Ni(this._distance,w),pinchAround:g}}}function wn(D,u){return 180*D.angleWith(u)/Math.PI}class To extends Yi{reset(){super.reset(),delete this._minDiameter,delete this._startVector,delete this._vector}_start(u){this._startVector=this._vector=u[0].sub(u[1]),this._minDiameter=u[0].dist(u[1])}_move(u,g,w){const C=this._vector;if(this._vector=u[0].sub(u[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:wn(this._vector,C),pinchAround:g}}_isBelowThreshold(u){this._minDiameter=Math.min(this._minDiameter,u.mag());const g=25/(Math.PI*this._minDiameter)*360,w=wn(u,this._startVector);return Math.abs(w)<g}}function Pi(D){return Math.abs(D.y)>Math.abs(D.x)}class aa extends Yi{constructor(u){super(),this._currentTouchCount=0,this._map=u}reset(){super.reset(),this._valid=void 0,delete this._firstMove,delete this._lastPoints}touchstart(u,g,w){super.touchstart(u,g,w),this._currentTouchCount=w.length}_start(u){this._lastPoints=u,Pi(u[0].sub(u[1]))&&(this._valid=!1)}_move(u,g,w){if(this._map.cooperativeGestures.isEnabled()&&this._currentTouchCount<3)return;const C=u[0].sub(this._lastPoints[0]),L=u[1].sub(this._lastPoints[1]);return this._valid=this.gestureBeginsVertically(C,L,w.timeStamp),this._valid?(this._lastPoints=u,this._active=!0,{pitchDelta:(C.y+L.y)/2*-.5}):void 0}gestureBeginsVertically(u,g,w){if(this._valid!==void 0)return this._valid;const C=u.mag()>=2,L=g.mag()>=2;if(!C&&!L)return;if(!C||!L)return this._firstMove===void 0&&(this._firstMove=w),w-this._firstMove<100&&void 0;const z=u.y>0==g.y>0;return Pi(u)&&Pi(g)&&z}}const da={panStep:100,bearingStep:15,pitchStep:10};class ki{constructor(u){this._tr=new Yt(u);const g=da;this._panStep=g.panStep,this._bearingStep=g.bearingStep,this._pitchStep=g.pitchStep,this._rotationDisabled=!1}reset(){this._active=!1}keydown(u){if(u.altKey||u.ctrlKey||u.metaKey)return;let g=0,w=0,C=0,L=0,z=0;switch(u.keyCode){case 61:case 107:case 171:case 187:g=1;break;case 189:case 109:case 173:g=-1;break;case 37:u.shiftKey?w=-1:(u.preventDefault(),L=-1);break;case 39:u.shiftKey?w=1:(u.preventDefault(),L=1);break;case 38:u.shiftKey?C=1:(u.preventDefault(),z=-1);break;case 40:u.shiftKey?C=-1:(u.preventDefault(),z=1);break;default:return}return this._rotationDisabled&&(w=0,C=0),{cameraAnimation:Y=>{const re=this._tr;Y.easeTo({duration:300,easeId:"keyboardHandler",easing:kl,zoom:g?Math.round(re.zoom)+g*(u.shiftKey?2:1):re.zoom,bearing:re.bearing+w*this._bearingStep,pitch:re.pitch+C*this._pitchStep,offset:[-L*this._panStep,-z*this._panStep],center:re.center},{originalEvent:u})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function kl(D){return D*(2-D)}const Qa=4.000244140625,ys=1/450;class ks{constructor(u,g){this._onTimeout=w=>{this._type="wheel",this._delta-=this._lastValue,this._active||this._start(w)},this._map=u,this._tr=new Yt(u),this._triggerRenderFrame=g,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=ys}setZoomRate(u){this._defaultZoomRate=u}setWheelZoomRate(u){this._wheelZoomRate=u}isEnabled(){return!!this._enabled}isActive(){return!!this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(u){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!u&&u.around==="center")}disable(){this.isEnabled()&&(this._enabled=!1)}_shouldBePrevented(u){return!!this._map.cooperativeGestures.isEnabled()&&!(u.ctrlKey||this._map.cooperativeGestures.isBypassed(u))}wheel(u){if(!this.isEnabled())return;if(this._shouldBePrevented(u))return void this._map.cooperativeGestures.notifyGestureBlocked("wheel_zoom",u);let g=u.deltaMode===WheelEvent.DOM_DELTA_LINE?40*u.deltaY:u.deltaY;const w=T(),C=w-(this._lastWheelEventTime||0);this._lastWheelEventTime=w,g!==0&&g%Qa==0?this._type="wheel":g!==0&&Math.abs(g)<4?this._type="trackpad":C>400?(this._type=null,this._lastValue=g,this._timeout=setTimeout(this._onTimeout,40,u)):this._type||(this._type=Math.abs(C*g)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,g+=this._lastValue)),u.shiftKey&&g&&(g/=4),this._type&&(this._lastWheelEvent=u,this._delta-=g,this._active||this._start(u)),u.preventDefault()}_start(u){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const g=A.mousePos(this._map.getCanvas(),u),w=this._tr;this._aroundPoint=this._aroundCenter?w.transform.locationToScreenPoint(o.V.convert(w.center)):g,this._frameId||(this._frameId=!0,this._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const u=this._tr.transform;if(typeof this._lastExpectedZoom=="number"){const Y=u.zoom-this._lastExpectedZoom;typeof this._startZoom=="number"&&(this._startZoom+=Y),typeof this._targetZoom=="number"&&(this._targetZoom+=Y)}if(this._delta!==0){const Y=this._type==="wheel"&&Math.abs(this._delta)>Qa?this._wheelZoomRate:this._defaultZoomRate;let re=2/(1+Math.exp(-Math.abs(this._delta*Y)));this._delta<0&&re!==0&&(re=1/re);const le=typeof this._targetZoom!="number"?u.scale:o.aq(this._targetZoom);this._targetZoom=u.applyConstrain(u.getCameraLngLat(),o.at(le*re)).zoom,this._type==="wheel"&&(this._startZoom=u.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}const g=typeof this._targetZoom!="number"?u.zoom:this._targetZoom,w=this._startZoom,C=this._easing;let L,z=!1;if(this._type==="wheel"&&w&&C){const Y=T()-this._lastWheelEventTime,re=Math.min((Y+5)/200,1),le=C(re);L=o.G.number(w,g,le),re<1?this._frameId||(this._frameId=!0):z=!0}else L=g,z=!0;return this._active=!0,z&&(this._active=!1,this._finishTimeout=setTimeout((()=>{this._zooming=!1,this._triggerRenderFrame(),delete this._targetZoom,delete this._lastExpectedZoom,delete this._finishTimeout}),200)),this._lastExpectedZoom=L,{noInertia:!0,needsRenderFrame:!z,zoomDelta:L-u.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}_smoothOutEasing(u){let g=o.cy;if(this._prevEase){const w=this._prevEase,C=(T()-w.start)/w.duration,L=w.easing(C+.01)-w.easing(C),z=.27/Math.sqrt(L*L+1e-4)*.01,Y=Math.sqrt(.0729-z*z);g=o.cw(z,Y,.25,1)}return this._prevEase={start:T(),duration:u,easing:g},g}reset(){this._active=!1,this._zooming=!1,delete this._targetZoom,delete this._lastExpectedZoom,this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout)}}class Go{constructor(u,g){this._clickZoom=u,this._tapZoom=g}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class sa{constructor(u){this._tr=new Yt(u),this.reset()}reset(){this._active=!1}dblclick(u,g){return u.preventDefault(),{cameraAnimation:w=>{w.easeTo({duration:300,zoom:this._tr.zoom+(u.shiftKey?-1:1),around:this._tr.unproject(g)},{originalEvent:u})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class wa{constructor(){this._tap=new hr({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,delete this._tapPoint,this._tap.reset()}touchstart(u,g,w){if(!this._swipePoint)if(this._tapTime){const C=g[0],L=u.timeStamp-this._tapTime<500,z=this._tapPoint.dist(C)<30;L&&z?w.length>0&&(this._swipePoint=C,this._swipeTouch=w[0].identifier):this.reset()}else this._tap.touchstart(u,g,w)}touchmove(u,g,w){if(this._tapTime){if(this._swipePoint){if(w[0].identifier!==this._swipeTouch)return;const C=g[0],L=C.y-this._swipePoint.y;return this._swipePoint=C,u.preventDefault(),this._active=!0,{zoomDelta:L/128}}}else this._tap.touchmove(u,g,w)}touchend(u,g,w){if(this._tapTime)this._swipePoint&&w.length===0&&this.reset();else{const C=this._tap.touchend(u,g,w);C&&(this._tapTime=u.timeStamp,this._tapPoint=C)}}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Co{constructor(u,g,w){this._el=u,this._mousePan=g,this._touchPan=w}enable(u){this._inertiaOptions=u||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("maplibregl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("maplibregl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class qi{constructor(u,g,w,C){this._pitchWithRotate=u.pitchWithRotate,this._rollEnabled=u.rollEnabled,this._mouseRotate=g,this._mousePitch=w,this._mouseRoll=C}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable(),this._rollEnabled&&this._mouseRoll.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable(),this._mouseRoll.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())&&(!this._rollEnabled||this._mouseRoll.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()||this._mouseRoll.isActive()}}class Wo{constructor(u,g,w,C){this._el=u,this._touchZoom=g,this._touchRotate=w,this._tapDragZoom=C,this._rotationDisabled=!1,this._enabled=!0}enable(u){this._touchZoom.enable(u),this._rotationDisabled||this._touchRotate.enable(u),this._tapDragZoom.enable(),this._el.classList.add("maplibregl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("maplibregl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}class Tn{constructor(u,g){this._bypassKey=navigator.userAgent.indexOf("Mac")!==-1?"metaKey":"ctrlKey",this._map=u,this._options=g,this._enabled=!1}isActive(){return!1}reset(){}_setupUI(){if(this._container)return;const u=this._map.getCanvasContainer();u.classList.add("maplibregl-cooperative-gestures"),this._container=A.create("div","maplibregl-cooperative-gesture-screen",u);let g=this._map._getUIString("CooperativeGesturesHandler.WindowsHelpText");this._bypassKey==="metaKey"&&(g=this._map._getUIString("CooperativeGesturesHandler.MacHelpText"));const w=this._map._getUIString("CooperativeGesturesHandler.MobileHelpText"),C=document.createElement("div");C.className="maplibregl-desktop-message",C.textContent=g,this._container.appendChild(C);const L=document.createElement("div");L.className="maplibregl-mobile-message",L.textContent=w,this._container.appendChild(L),this._container.setAttribute("aria-hidden","true")}_destroyUI(){this._container&&(A.remove(this._container),this._map.getCanvasContainer().classList.remove("maplibregl-cooperative-gestures")),delete this._container}enable(){this._setupUI(),this._enabled=!0}disable(){this._enabled=!1,this._destroyUI()}isEnabled(){return this._enabled}isBypassed(u){return u[this._bypassKey]}notifyGestureBlocked(u,g){this._enabled&&(this._map.fire(new o.l("cooperativegestureprevented",{gestureType:u,originalEvent:g})),this._container.classList.add("maplibregl-show"),setTimeout((()=>{this._container.classList.remove("maplibregl-show")}),100))}}const Sn=D=>D.zoom||D.drag||D.roll||D.pitch||D.rotate;class Rs extends o.l{}function Sa(D){return D.panDelta&&D.panDelta.mag()||D.zoomDelta||D.bearingDelta||D.pitchDelta||D.rollDelta}class Lo{constructor(u,g){this.handleWindowEvent=C=>{this.handleEvent(C,`${C.type}Window`)},this.handleEvent=(C,L)=>{if(C.type==="blur")return void this.stop(!0);this._updatingCamera=!0;const z=C.type==="renderFrame"?void 0:C,Y={needsRenderFrame:!1},re={},le={};for(const{handlerName:Ae,handler:Ue,allowed:Ze}of this._handlers){if(!Ue.isEnabled())continue;let ht;if(this._blockedByActive(le,Ze,Ae))Ue.reset();else if(Ue[L||C.type]){if(o.cz(C,L||C.type)){const pt=A.mousePos(this._map.getCanvas(),C);ht=Ue[L||C.type](C,pt)}else if(o.cA(C,L||C.type)){const pt=this._getMapTouches(C.touches),dt=A.touchPos(this._map.getCanvas(),pt);ht=Ue[L||C.type](C,dt,pt)}else o.cB(L||C.type)||(ht=Ue[L||C.type](C));this.mergeHandlerResult(Y,re,ht,Ae,z),ht&&ht.needsRenderFrame&&this._triggerRenderFrame()}(ht||Ue.isActive())&&(le[Ae]=Ue)}const he={};for(const Ae in this._previousActiveHandlers)le[Ae]||(he[Ae]=z);this._previousActiveHandlers=le,(Object.keys(he).length||Sa(Y))&&(this._changes.push([Y,re,he]),this._triggerRenderFrame()),(Object.keys(le).length||Sa(Y))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:Pe}=Y;Pe&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],Pe(this._map))},this._map=u,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new ge(u),this._bearingSnap=g.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(g);const w=this._el;this._listeners=[[w,"touchstart",{passive:!0}],[w,"touchmove",{passive:!1}],[w,"touchend",void 0],[w,"touchcancel",void 0],[w,"mousedown",void 0],[w,"mousemove",void 0],[w,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[w,"mouseover",void 0],[w,"mouseout",void 0],[w,"dblclick",void 0],[w,"click",void 0],[w,"keydown",{capture:!1}],[w,"keyup",void 0],[w,"wheel",{passive:!1}],[w,"contextmenu",void 0],[window,"blur",void 0]];for(const[C,L,z]of this._listeners)A.addEventListener(C,L,C===document?this.handleWindowEvent:this.handleEvent,z)}destroy(){for(const[u,g,w]of this._listeners)A.removeEventListener(u,g,u===document?this.handleWindowEvent:this.handleEvent,w)}_addDefaultHandlers(u){const g=this._map,w=g.getCanvasContainer();this._add("mapEvent",new yt(g,u));const C=g.boxZoom=new br(g,u);this._add("boxZoom",C),u.interactive&&u.boxZoom&&C.enable();const L=g.cooperativeGestures=new Tn(g,u.cooperativeGestures);this._add("cooperativeGestures",L),u.cooperativeGestures&&L.enable();const z=new Lr(g),Y=new sa(g);g.doubleClickZoom=new Go(Y,z),this._add("tapZoom",z),this._add("clickZoom",Y),u.interactive&&u.doubleClickZoom&&g.doubleClickZoom.enable();const re=new wa;this._add("tapDragZoom",re);const le=g.touchPitch=new aa(g);this._add("touchPitch",le),u.interactive&&u.touchPitch&&g.touchPitch.enable(u.touchPitch);const he=()=>g.project(g.getCenter()),Pe=(function({enable:wt,clickTolerance:Lt,aroundCenter:jt=!0,minPixelCenterThreshold:Dt=100,rotateDegreesPerPixelMoved:Zt=.8},Sr){const pr=new Jr({checkCorrectEvent:_r=>A.mouseButton(_r)===0&&_r.ctrlKey||A.mouseButton(_r)===2&&!_r.ctrlKey});return new yr({clickTolerance:Lt,move:(_r,xr)=>{const an=Sr();if(jt&&Math.abs(an.y-_r.y)>Dt)return{bearingDelta:o.cx(new o.P(_r.x,xr.y),xr,an)};let ln=(xr.x-_r.x)*Zt;return jt&&xr.y<an.y&&(ln=-ln),{bearingDelta:ln}},moveStateManager:pr,enable:wt,assignEvents:Ai})})(u,he),Ae=(function({enable:wt,clickTolerance:Lt,pitchDegreesPerPixelMoved:jt=-.5}){const Dt=new Jr({checkCorrectEvent:Zt=>A.mouseButton(Zt)===0&&Zt.ctrlKey||A.mouseButton(Zt)===2});return new yr({clickTolerance:Lt,move:(Zt,Sr)=>({pitchDelta:(Sr.y-Zt.y)*jt}),moveStateManager:Dt,enable:wt,assignEvents:Ai})})(u),Ue=(function({enable:wt,clickTolerance:Lt,rollDegreesPerPixelMoved:jt=.3},Dt){const Zt=new Jr({checkCorrectEvent:Sr=>A.mouseButton(Sr)===2&&Sr.ctrlKey});return new yr({clickTolerance:Lt,move:(Sr,pr)=>{const _r=Dt();let xr=(pr.x-Sr.x)*jt;return pr.y<_r.y&&(xr=-xr),{rollDelta:xr}},moveStateManager:Zt,enable:wt,assignEvents:Ai})})(u,he);g.dragRotate=new qi(u,Pe,Ae,Ue),this._add("mouseRotate",Pe,["mousePitch"]),this._add("mousePitch",Ae,["mouseRotate","mouseRoll"]),this._add("mouseRoll",Ue,["mousePitch"]),u.interactive&&u.dragRotate&&g.dragRotate.enable();const Ze=(function({enable:wt,clickTolerance:Lt}){const jt=new Jr({checkCorrectEvent:Dt=>A.mouseButton(Dt)===0&&!Dt.ctrlKey});return new yr({clickTolerance:Lt,move:(Dt,Zt)=>({around:Zt,panDelta:Zt.sub(Dt)}),activateOnStart:!0,moveStateManager:jt,enable:wt,assignEvents:Ai})})(u),ht=new Zn(u,g);g.dragPan=new Co(w,Ze,ht),this._add("mousePan",Ze),this._add("touchPan",ht,["touchZoom","touchRotate"]),u.interactive&&u.dragPan&&g.dragPan.enable(u.dragPan);const pt=new To,dt=new Yn;g.touchZoomRotate=new Wo(w,dt,pt,re),this._add("touchRotate",pt,["touchPan","touchZoom"]),this._add("touchZoom",dt,["touchPan","touchRotate"]),u.interactive&&u.touchZoomRotate&&g.touchZoomRotate.enable(u.touchZoomRotate),this._add("blockableMapEvent",new At(g));const xt=g.scrollZoom=new ks(g,(()=>this._triggerRenderFrame()));this._add("scrollZoom",xt,["mousePan"]),u.interactive&&u.scrollZoom&&g.scrollZoom.enable(u.scrollZoom);const Nt=g.keyboard=new ki(g);this._add("keyboard",Nt),u.interactive&&u.keyboard&&g.keyboard.enable()}_add(u,g,w){this._handlers.push({handlerName:u,handler:g,allowed:w}),this._handlersById[u]=g}stop(u){if(!this._updatingCamera){for(const{handler:g}of this._handlers)g.reset();this._inertia.clear(),this._fireEvents({},{},u),this._changes=[]}}isActive(){for(const{handler:u}of this._handlers)if(u.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!Sn(this._eventsInProgress)||this.isZooming()}_blockedByActive(u,g,w){for(const C in u)if(C!==w&&(!g||g.indexOf(C)<0))return!0;return!1}_getMapTouches(u){const g=[];for(const w of u)this._el.contains(w.target)&&g.push(w);return g}mergeHandlerResult(u,g,w,C,L){if(!w)return;o.e(u,w);const z={handlerName:C,originalEvent:w.originalEvent||L};w.zoomDelta!==void 0&&(g.zoom=z),w.panDelta!==void 0&&(g.drag=z),w.rollDelta!==void 0&&(g.roll=z),w.pitchDelta!==void 0&&(g.pitch=z),w.bearingDelta!==void 0&&(g.rotate=z)}_applyChanges(){const u={},g={},w={};for(const[C,L,z]of this._changes)C.panDelta&&(u.panDelta=(u.panDelta||new o.P(0,0))._add(C.panDelta)),C.zoomDelta&&(u.zoomDelta=(u.zoomDelta||0)+C.zoomDelta),C.bearingDelta&&(u.bearingDelta=(u.bearingDelta||0)+C.bearingDelta),C.pitchDelta&&(u.pitchDelta=(u.pitchDelta||0)+C.pitchDelta),C.rollDelta&&(u.rollDelta=(u.rollDelta||0)+C.rollDelta),C.around!==void 0&&(u.around=C.around),C.pinchAround!==void 0&&(u.pinchAround=C.pinchAround),C.noInertia&&(u.noInertia=C.noInertia),o.e(g,L),o.e(w,z);this._updateMapTransform(u,g,w),this._changes=[]}_updateMapTransform(u,g,w){const C=this._map,L=C._getTransformForUpdate(),z=C.terrain;if(!(Sa(u)||z&&this._terrainMovement))return this._fireEvents(g,w,!0);C._stop(!0);let{panDelta:Y,zoomDelta:re,bearingDelta:le,pitchDelta:he,rollDelta:Pe,around:Ae,pinchAround:Ue}=u;Ue!==void 0&&(Ae=Ue),Ae=Ae||C.transform.centerPoint,z&&!L.isPointOnMapSurface(Ae)&&(Ae=L.centerPoint);const Ze={panDelta:Y,zoomDelta:re,rollDelta:Pe,pitchDelta:he,bearingDelta:le,around:Ae};this._map.cameraHelper.useGlobeControls&&!L.isPointOnMapSurface(Ae)&&(Ae=L.centerPoint);const ht=Ae.distSqr(L.centerPoint)<.01?L.center:L.screenPointToLocation(Y?Ae.sub(Y):Ae);this._handleMapControls({terrain:z,tr:L,deltasForHelper:Ze,preZoomAroundLoc:ht,combinedEventsInProgress:g,panDelta:Y}),C._applyUpdatedTransform(L),this._map._update(),u.noInertia||this._inertia.record(u),this._fireEvents(g,w,!0)}_handleMapControls({terrain:u,tr:g,deltasForHelper:w,preZoomAroundLoc:C,combinedEventsInProgress:L,panDelta:z}){const Y=this._map.cameraHelper;if(Y.handleMapControlsRollPitchBearingZoom(w,g),u)return Y.useGlobeControls?(this._terrainMovement||!L.drag&&!L.zoom||(this._terrainMovement=!0,this._map._elevationFreeze=!0),void Y.handleMapControlsPan(w,g,C)):this._terrainMovement||!L.drag&&!L.zoom?void(L.drag&&this._terrainMovement&&z?g.setCenter(g.screenPointToLocation(g.centerPoint.sub(z))):Y.handleMapControlsPan(w,g,C)):(this._terrainMovement=!0,this._map._elevationFreeze=!0,void Y.handleMapControlsPan(w,g,C));Y.handleMapControlsPan(w,g,C)}_fireEvents(u,g,w){const C=Sn(this._eventsInProgress),L=Sn(u),z={};for(const Pe in u){const{originalEvent:Ae}=u[Pe];this._eventsInProgress[Pe]||(z[`${Pe}start`]=Ae),this._eventsInProgress[Pe]=u[Pe]}!C&&L&&this._fireEvent("movestart",L.originalEvent);for(const Pe in z)this._fireEvent(Pe,z[Pe]);L&&this._fireEvent("move",L.originalEvent);for(const Pe in u){const{originalEvent:Ae}=u[Pe];this._fireEvent(Pe,Ae)}const Y={};let re;for(const Pe in this._eventsInProgress){const{handlerName:Ae,originalEvent:Ue}=this._eventsInProgress[Pe];this._handlersById[Ae].isActive()||(delete this._eventsInProgress[Pe],re=g[Ae]||Ue,Y[`${Pe}end`]=re)}for(const Pe in Y)this._fireEvent(Pe,Y[Pe]);const le=Sn(this._eventsInProgress),he=(C||L)&&!le;if(he&&this._terrainMovement){this._map._elevationFreeze=!1,this._terrainMovement=!1;const Pe=this._map._getTransformForUpdate();this._map.getCenterClampedToGround()&&Pe.recalculateZoomAndCenter(this._map.terrain),this._map._applyUpdatedTransform(Pe)}if(w&&he){this._updatingCamera=!0;const Pe=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),Ae=Ue=>Ue!==0&&-this._bearingSnap<Ue&&Ue<this._bearingSnap;!Pe||!Pe.essential&&x.prefersReducedMotion?(this._map.fire(new o.l("moveend",{originalEvent:re})),Ae(this._map.getBearing())&&this._map.resetNorth()):(Ae(Pe.bearing||this._map.getBearing())&&(Pe.bearing=0),Pe.freezeElevation=!0,this._map.easeTo(Pe,{originalEvent:re})),this._updatingCamera=!1}}_fireEvent(u,g){this._map.fire(new o.l(u,g?{originalEvent:g}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add((u=>{delete this._frameId,this.handleEvent(new Rs("renderFrame",{timeStamp:u})),this._applyChanges()}))}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}class $a extends o.E{constructor(u,g,w){super(),this._renderFrameCallback=()=>{const C=Math.min((T()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(C)),C<1&&this._easeFrameId?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},this._moving=!1,this._zooming=!1,this.transform=u,this._bearingSnap=w.bearingSnap,this.cameraHelper=g,this.on("moveend",(()=>{delete this._requestedCameraState}))}migrateProjection(u,g){u.apply(this.transform,!0),this.transform=u,this.cameraHelper=g}getCenter(){return new o.V(this.transform.center.lng,this.transform.center.lat)}setCenter(u,g){return this.jumpTo({center:u},g)}getCenterElevation(){return this.transform.elevation}setCenterElevation(u,g){return this.jumpTo({elevation:u},g),this}getCenterClampedToGround(){return this._centerClampedToGround}setCenterClampedToGround(u){this._centerClampedToGround=u}panBy(u,g,w){return u=o.P.convert(u).mult(-1),this.panTo(this.transform.center,o.e({offset:u},g),w)}panTo(u,g,w){return this.easeTo(o.e({center:u},g),w)}getZoom(){return this.transform.zoom}setZoom(u,g){return this.jumpTo({zoom:u},g),this}zoomTo(u,g,w){return this.easeTo(o.e({zoom:u},g),w)}zoomIn(u,g){return this.zoomTo(this.getZoom()+1,u,g),this}zoomOut(u,g){return this.zoomTo(this.getZoom()-1,u,g),this}getVerticalFieldOfView(){return this.transform.fov}setVerticalFieldOfView(u,g){return u!=this.transform.fov&&(this.transform.setFov(u),this.fire(new o.l("movestart",g)).fire(new o.l("move",g)).fire(new o.l("moveend",g))),this}getBearing(){return this.transform.bearing}setBearing(u,g){return this.jumpTo({bearing:u},g),this}getPadding(){return this.transform.padding}setPadding(u,g){return this.jumpTo({padding:u},g),this}rotateTo(u,g,w){return this.easeTo(o.e({bearing:u},g),w)}resetNorth(u,g){return this.rotateTo(0,o.e({duration:1e3},u),g),this}resetNorthPitch(u,g){return this.easeTo(o.e({bearing:0,pitch:0,roll:0,duration:1e3},u),g),this}snapToNorth(u,g){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(u,g):this}getPitch(){return this.transform.pitch}setPitch(u,g){return this.jumpTo({pitch:u},g),this}getRoll(){return this.transform.roll}setRoll(u,g){return this.jumpTo({roll:u},g),this}cameraForBounds(u,g){u=$t.convert(u).adjustAntiMeridian();const w=g&&g.bearing||0;return this._cameraForBoxAndBearing(u.getNorthWest(),u.getSouthEast(),w,g)}_cameraForBoxAndBearing(u,g,w,C){const L={top:0,bottom:0,right:0,left:0};if(typeof(C=o.e({padding:L,offset:[0,0],maxZoom:this.transform.maxZoom},C)).padding=="number"){const le=C.padding;C.padding={top:le,bottom:le,right:le,left:le}}const z=o.e(L,C.padding);C.padding=z;const Y=this.transform,re=new $t(u,g);return this.cameraHelper.cameraForBoxAndBearing(C,z,re,w,Y)}fitBounds(u,g,w){return this._fitInternal(this.cameraForBounds(u,g),g,w)}fitScreenCoordinates(u,g,w,C,L){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.screenPointToLocation(o.P.convert(u)),this.transform.screenPointToLocation(o.P.convert(g)),w,C),C,L)}_fitInternal(u,g,w){return u?(delete(g=o.e(u,g)).padding,g.linear?this.easeTo(g,w):this.flyTo(g,w)):this}jumpTo(u,g){this.stop();const w=this._getTransformForUpdate();let C=!1,L=!1,z=!1;const Y=w.zoom;this.cameraHelper.handleJumpToCenterZoom(w,u);const re=w.zoom!==Y;return"elevation"in u&&w.elevation!==+u.elevation&&w.setElevation(+u.elevation),"bearing"in u&&w.bearing!==+u.bearing&&(C=!0,w.setBearing(+u.bearing)),"pitch"in u&&w.pitch!==+u.pitch&&(L=!0,w.setPitch(+u.pitch)),"roll"in u&&w.roll!==+u.roll&&(z=!0,w.setRoll(+u.roll)),u.padding==null||w.isPaddingEqual(u.padding)||w.setPadding(u.padding),this._applyUpdatedTransform(w),this.fire(new o.l("movestart",g)).fire(new o.l("move",g)),re&&this.fire(new o.l("zoomstart",g)).fire(new o.l("zoom",g)).fire(new o.l("zoomend",g)),C&&this.fire(new o.l("rotatestart",g)).fire(new o.l("rotate",g)).fire(new o.l("rotateend",g)),L&&this.fire(new o.l("pitchstart",g)).fire(new o.l("pitch",g)).fire(new o.l("pitchend",g)),z&&this.fire(new o.l("rollstart",g)).fire(new o.l("roll",g)).fire(new o.l("rollend",g)),this.fire(new o.l("moveend",g))}calculateCameraOptionsFromTo(u,g,w,C=0){const L=o.a9.fromLngLat(u,g),z=o.a9.fromLngLat(w,C),Y=z.x-L.x,re=z.y-L.y,le=z.z-L.z,he=Math.hypot(Y,re,le);if(he===0)throw new Error("Can't calculate camera options with same From and To");const Pe=Math.hypot(Y,re),Ae=o.at(this.transform.cameraToCenterDistance/he/this.transform.tileSize),Ue=180*Math.atan2(Y,-re)/Math.PI;let Ze=180*Math.acos(Pe/he)/Math.PI;return Ze=le<0?90-Ze:90+Ze,{center:z.toLngLat(),elevation:C,zoom:Ae,pitch:Ze,bearing:Ue}}calculateCameraOptionsFromCameraLngLatAltRotation(u,g,w,C,L){const z=this.transform.calculateCenterFromCameraLngLatAlt(u,g,w,C);return{center:z.center,elevation:z.elevation,zoom:z.zoom,bearing:w,pitch:C,roll:L}}easeTo(u,g){this._stop(!1,u.easeId),((u=o.e({offset:[0,0],duration:500,easing:o.cy},u)).animate===!1||!u.essential&&x.prefersReducedMotion)&&(u.duration=0);const w=this._getTransformForUpdate(),C=this.getBearing(),L=w.pitch,z=w.roll,Y="bearing"in u?this._normalizeBearing(u.bearing,C):C,re="pitch"in u?+u.pitch:L,le="roll"in u?this._normalizeBearing(u.roll,z):z,he="padding"in u?u.padding:w.padding,Pe=o.P.convert(u.offset);let Ae,Ue;u.around&&(Ae=o.V.convert(u.around),Ue=w.locationToScreenPoint(Ae));const Ze={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching,rolling:this._rolling},ht=this.cameraHelper.handleEaseTo(w,{bearing:Y,pitch:re,roll:le,padding:he,around:Ae,aroundPoint:Ue,offsetAsPoint:Pe,offset:u.offset,zoom:u.zoom,center:u.center});return this._rotating=this._rotating||C!==Y,this._pitching=this._pitching||re!==L,this._rolling=this._rolling||le!==z,this._padding=!w.isPaddingEqual(he),this._zooming=this._zooming||ht.isZooming,this._easeId=u.easeId,this._prepareEase(g,u.noMoveStart,Ze),this.terrain&&this._prepareElevation(ht.elevationCenter),this._ease((pt=>{ht.easeFunc(pt),this.terrain&&!u.freezeElevation&&this._updateElevation(pt),this._applyUpdatedTransform(w),this._fireMoveEvents(g)}),(pt=>{this.terrain&&u.freezeElevation&&this._finalizeElevation(),this._afterEase(g,pt)}),u),this}_prepareEase(u,g,w={}){this._moving=!0,g||w.moving||this.fire(new o.l("movestart",u)),this._zooming&&!w.zooming&&this.fire(new o.l("zoomstart",u)),this._rotating&&!w.rotating&&this.fire(new o.l("rotatestart",u)),this._pitching&&!w.pitching&&this.fire(new o.l("pitchstart",u)),this._rolling&&!w.rolling&&this.fire(new o.l("rollstart",u))}_prepareElevation(u){this._elevationCenter=u,this._elevationStart=this.transform.elevation,this._elevationTarget=this.terrain.getElevationForLngLatZoom(u,this.transform.tileZoom),this._elevationFreeze=!0}_updateElevation(u){this._elevationStart!==void 0&&this._elevationCenter!==void 0||this._prepareElevation(this.transform.center),this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom));const g=this.terrain.getElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);if(u<1&&g!==this._elevationTarget){const w=this._elevationTarget-this._elevationStart;this._elevationStart+=u*(w-(g-(w*u+this._elevationStart))/(1-u)),this._elevationTarget=g}this.transform.setElevation(o.G.number(this._elevationStart,this._elevationTarget,u))}_finalizeElevation(){this._elevationFreeze=!1,this.getCenterClampedToGround()&&this.transform.recalculateZoomAndCenter(this.terrain)}_getTransformForUpdate(){return this.transformCameraUpdate||this.terrain?(this._requestedCameraState||(this._requestedCameraState=this.transform.clone()),this._requestedCameraState):this.transform}_elevateCameraIfInsideTerrain(u){if(!this.terrain&&u.elevation>=0&&u.pitch<=90)return{};const g=u.getCameraLngLat(),w=u.getCameraAltitude(),C=this.terrain?this.terrain.getElevationForLngLatZoom(g,u.zoom):0;if(w<C){const L=this.calculateCameraOptionsFromTo(g,C,u.center,u.elevation);return{pitch:L.pitch,zoom:L.zoom}}return{}}_applyUpdatedTransform(u){const g=[];if(g.push((C=>this._elevateCameraIfInsideTerrain(C))),this.transformCameraUpdate&&g.push((C=>this.transformCameraUpdate(C))),!g.length)return;const w=u.clone();for(const C of g){const L=w.clone(),{center:z,zoom:Y,roll:re,pitch:le,bearing:he,elevation:Pe}=C(L);z&&L.setCenter(z),Pe!==void 0&&L.setElevation(Pe),Y!==void 0&&L.setZoom(Y),re!==void 0&&L.setRoll(re),le!==void 0&&L.setPitch(le),he!==void 0&&L.setBearing(he),w.apply(L,!1)}this.transform.apply(w,!1)}_fireMoveEvents(u){this.fire(new o.l("move",u)),this._zooming&&this.fire(new o.l("zoom",u)),this._rotating&&this.fire(new o.l("rotate",u)),this._pitching&&this.fire(new o.l("pitch",u)),this._rolling&&this.fire(new o.l("roll",u))}_afterEase(u,g){if(this._easeId&&g&&this._easeId===g)return;delete this._easeId;const w=this._zooming,C=this._rotating,L=this._pitching,z=this._rolling;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._rolling=!1,this._padding=!1,w&&this.fire(new o.l("zoomend",u)),C&&this.fire(new o.l("rotateend",u)),L&&this.fire(new o.l("pitchend",u)),z&&this.fire(new o.l("rollend",u)),this.fire(new o.l("moveend",u))}flyTo(u,g){if(!u.essential&&x.prefersReducedMotion){const xr=o.U(u,["center","zoom","bearing","pitch","roll","elevation","padding"]);return this.jumpTo(xr,g)}this.stop(),u=o.e({offset:[0,0],speed:1.2,curve:1.42,easing:o.cy},u);const w=this._getTransformForUpdate(),C=w.bearing,L=w.pitch,z=w.roll,Y=w.padding,re="bearing"in u?this._normalizeBearing(u.bearing,C):C,le="pitch"in u?+u.pitch:L,he="roll"in u?this._normalizeBearing(u.roll,z):z,Pe="padding"in u?u.padding:w.padding,Ae=o.P.convert(u.offset);let Ue=w.centerPoint.add(Ae);const Ze=w.screenPointToLocation(Ue),ht=this.cameraHelper.handleFlyTo(w,{bearing:re,pitch:le,roll:he,padding:Pe,locationAtOffset:Ze,offsetAsPoint:Ae,center:u.center,minZoom:u.minZoom,zoom:u.zoom});let pt=u.curve;const dt=Math.max(w.width,w.height),xt=dt/ht.scaleOfZoom,Nt=ht.pixelPathLength;typeof ht.scaleOfMinZoom=="number"&&(pt=Math.sqrt(dt/ht.scaleOfMinZoom/Nt*2));const wt=pt*pt;function Lt(xr){const an=(xt*xt-dt*dt+(xr?-1:1)*wt*wt*Nt*Nt)/(2*(xr?xt:dt)*wt*Nt);return Math.log(Math.sqrt(an*an+1)-an)}function jt(xr){return(Math.exp(xr)-Math.exp(-xr))/2}function Dt(xr){return(Math.exp(xr)+Math.exp(-xr))/2}const Zt=Lt(!1);let Sr=function(xr){return Dt(Zt)/Dt(Zt+pt*xr)},pr=function(xr){return dt*((Dt(Zt)*(jt(an=Zt+pt*xr)/Dt(an))-jt(Zt))/wt)/Nt;var an},_r=(Lt(!0)-Zt)/pt;if(Math.abs(Nt)<2e-6||!isFinite(_r)){if(Math.abs(dt-xt)<1e-6)return this.easeTo(u,g);const xr=xt<dt?-1:1;_r=Math.abs(Math.log(xt/dt))/pt,pr=()=>0,Sr=an=>Math.exp(xr*pt*an)}return u.duration="duration"in u?+u.duration:1e3*_r/("screenSpeed"in u?+u.screenSpeed/pt:+u.speed),u.maxDuration&&u.duration>u.maxDuration&&(u.duration=0),this._zooming=!0,this._rotating=C!==re,this._pitching=le!==L,this._rolling=he!==z,this._padding=!w.isPaddingEqual(Pe),this._prepareEase(g,!1),this.terrain&&this._prepareElevation(ht.targetCenter),this._ease((xr=>{const an=xr*_r,ln=1/Sr(an),Hr=pr(an);this._rotating&&w.setBearing(o.G.number(C,re,xr)),this._pitching&&w.setPitch(o.G.number(L,le,xr)),this._rolling&&w.setRoll(o.G.number(z,he,xr)),this._padding&&(w.interpolatePadding(Y,Pe,xr),Ue=w.centerPoint.add(Ae)),ht.easeFunc(xr,ln,Hr,Ue),this.terrain&&!u.freezeElevation&&this._updateElevation(xr),this._applyUpdatedTransform(w),this._fireMoveEvents(g)}),(()=>{this.terrain&&u.freezeElevation&&this._finalizeElevation(),this._afterEase(g)}),u),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(u,g){var w;if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){const C=this._onEaseEnd;delete this._onEaseEnd,C.call(this,g)}return u||(w=this.handlers)===null||w===void 0||w.stop(!1),this}_ease(u,g,w){w.animate===!1||w.duration===0?(u(1),g()):(this._easeStart=T(),this._easeOptions=w,this._onEaseFrame=u,this._onEaseEnd=g,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_normalizeBearing(u,g){u=o.W(u,-180,180);const w=Math.abs(u-g);return Math.abs(u-360-g)<w&&(u-=360),Math.abs(u+360-g)<w&&(u+=360),u}queryTerrainElevation(u){return this.terrain?this.terrain.getElevationForLngLat(o.V.convert(u),this.transform):null}}const eo={compact:!0,customAttribution:'<a href="https://maplibre.org/" target="_blank">MapLibre</a>'};class Rl{constructor(u=eo){this._toggleAttribution=()=>{this._container.classList.contains("maplibregl-compact")&&(this._container.classList.contains("maplibregl-compact-show")?(this._container.setAttribute("open",""),this._container.classList.remove("maplibregl-compact-show")):(this._container.classList.add("maplibregl-compact-show"),this._container.removeAttribute("open")))},this._updateData=g=>{!g||g.sourceDataType!=="metadata"&&g.sourceDataType!=="visibility"&&g.dataType!=="style"&&g.type!=="terrain"||this._updateAttributions()},this._updateCompact=()=>{this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact===!1?this._container.setAttribute("open",""):this._container.classList.contains("maplibregl-compact")||this._container.classList.contains("maplibregl-attrib-empty")||(this._container.setAttribute("open",""),this._container.classList.add("maplibregl-compact","maplibregl-compact-show")):(this._container.setAttribute("open",""),this._container.classList.contains("maplibregl-compact")&&this._container.classList.remove("maplibregl-compact","maplibregl-compact-show"))},this._updateCompactMinimize=()=>{this._container.classList.contains("maplibregl-compact")&&this._container.classList.contains("maplibregl-compact-show")&&this._container.classList.remove("maplibregl-compact-show")},this.options=u}getDefaultPosition(){return"bottom-right"}onAdd(u){return this._map=u,this._compact=this.options.compact,this._container=A.create("details","maplibregl-ctrl maplibregl-ctrl-attrib"),this._compactButton=A.create("summary","maplibregl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=A.create("div","maplibregl-ctrl-attrib-inner",this._container),this._updateAttributions(),this._updateCompact(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("terrain",this._updateData),this._map.on("resize",this._updateCompact),this._map.on("drag",this._updateCompactMinimize),this._container}onRemove(){A.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("terrain",this._updateData),this._map.off("resize",this._updateCompact),this._map.off("drag",this._updateCompactMinimize),this._map=void 0,this._compact=void 0,this._attribHTML=void 0}_setElementTitle(u,g){const w=this._map._getUIString(`AttributionControl.${g}`);u.title=w,u.setAttribute("aria-label",w)}_updateAttributions(){if(!this._map.style)return;let u=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?u=u.concat(this.options.customAttribution.map((C=>typeof C!="string"?"":C))):typeof this.options.customAttribution=="string"&&u.push(this.options.customAttribution)),this._map.style.stylesheet){const C=this._map.style.stylesheet;this.styleOwner=C.owner,this.styleId=C.id}const g=this._map.style.tileManagers;for(const C in g){const L=g[C];if(L.used||L.usedForTerrain){const z=L.getSource();z.attribution&&u.indexOf(z.attribution)<0&&u.push(z.attribution)}}u=u.filter((C=>String(C).trim())),u.sort(((C,L)=>C.length-L.length)),u=u.filter(((C,L)=>{for(let z=L+1;z<u.length;z++)if(u[z].indexOf(C)>=0)return!1;return!0}));const w=u.join(" | ");w!==this._attribHTML&&(this._attribHTML=w,u.length?(this._innerContainer.innerHTML=A.sanitize(w),this._container.classList.remove("maplibregl-attrib-empty")):this._container.classList.add("maplibregl-attrib-empty"),this._updateCompact(),this._editLink=null)}}class Yl{constructor(u={}){this._updateCompact=()=>{const g=this._container.children;if(g.length){const w=g[0];this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact!==!1&&w.classList.add("maplibregl-compact"):w.classList.remove("maplibregl-compact")}},this.options=u}getDefaultPosition(){return"bottom-left"}onAdd(u){this._map=u,this._compact=this.options&&this.options.compact,this._container=A.create("div","maplibregl-ctrl");const g=A.create("a","maplibregl-ctrl-logo");return g.target="_blank",g.rel="noopener nofollow",g.href="https://maplibre.org/",g.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),g.setAttribute("rel","noopener nofollow"),this._container.appendChild(g),this._container.style.display="block",this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){A.remove(this._container),this._map.off("resize",this._updateCompact),this._map=void 0,this._compact=void 0}}class Zl{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(u){const g=++this._id;return this._queue.push({callback:u,id:g,cancelled:!1}),g}remove(u){const g=this._currentlyRunning,w=g?this._queue.concat(g):this._queue;for(const C of w)if(C.id===u)return void(C.cancelled=!0)}run(u=0){if(this._currentlyRunning)throw new Error("Attempting to run(), but is already running.");const g=this._currentlyRunning=this._queue;this._queue=[];for(const w of g)if(!w.cancelled&&(w.callback(u),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}var gu=o.aU([{name:"a_pos3d",type:"Int16",components:3}]);class Ea extends o.E{constructor(u){super(),this._lastTilesetChange=T(),this.tileManager=u,this._tiles={},this._renderableTilesKeys=[],this._sourceTileCache={},this.minzoom=0,this.maxzoom=22,this.deltaZoom=1,this.tileSize=u._source.tileSize*2**this.deltaZoom,u.usedForTerrain=!0,u.tileSize=this.tileSize}destruct(){this.tileManager.usedForTerrain=!1,this.tileManager.tileSize=null}getSource(){return this.tileManager._source}update(u,g){this.tileManager.update(u,g),this._renderableTilesKeys=[];const w={};for(const C of Kn(u,{tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,reparseOverscaled:!1,terrain:g,calculateTileZoom:this.tileManager._source.calculateTileZoom}))w[C.key]=!0,this._renderableTilesKeys.push(C.key),this._tiles[C.key]||(C.terrainRttPosMatrix32f=new Float64Array(16),o.c7(C.terrainRttPosMatrix32f,0,o.a5,o.a5,0,0,1),this._tiles[C.key]=new Qt(C,this.tileSize),this._lastTilesetChange=T());for(const C in this._tiles)w[C]||delete this._tiles[C]}freeRtt(u){for(const g in this._tiles){const w=this._tiles[g];(!u||w.tileID.equals(u)||w.tileID.isChildOf(u)||u.isChildOf(w.tileID))&&(w.rtt=[])}}getRenderableTiles(){return this._renderableTilesKeys.map((u=>this.getTileByID(u)))}getTileByID(u){return this._tiles[u]}getTerrainCoords(u,g){return g?this._getTerrainCoordsForTileRanges(u,g):this._getTerrainCoordsForRegularTile(u)}_getTerrainCoordsForRegularTile(u){const g={};for(const w of this._renderableTilesKeys){const C=this._tiles[w].tileID,L=u.clone(),z=o.bk();if(C.canonical.equals(u.canonical))o.c7(z,0,o.a5,o.a5,0,0,1);else if(C.canonical.isChildOf(u.canonical)){const Y=C.canonical.z-u.canonical.z,re=C.canonical.x-(C.canonical.x>>Y<<Y),le=C.canonical.y-(C.canonical.y>>Y<<Y),he=o.a5>>Y;o.c7(z,0,he,he,0,0,1),o.O(z,z,[-re*he,-le*he,0])}else{if(!u.canonical.isChildOf(C.canonical))continue;{const Y=u.canonical.z-C.canonical.z,re=u.canonical.x-(u.canonical.x>>Y<<Y),le=u.canonical.y-(u.canonical.y>>Y<<Y),he=o.a5>>Y;o.c7(z,0,o.a5,o.a5,0,0,1),o.O(z,z,[re*he,le*he,0]),o.Q(z,z,[1/2**Y,1/2**Y,0])}}L.terrainRttPosMatrix32f=new Float32Array(z),g[w]=L}return g}_getTerrainCoordsForTileRanges(u,g){const w={};for(const C of this._renderableTilesKeys){const L=this._tiles[C].tileID;if(!this._isWithinTileRanges(L,g))continue;const z=u.clone(),Y=o.bk();if(L.canonical.z===u.canonical.z){const re=u.canonical.x-L.canonical.x+u.wrap*(1<<u.canonical.z),le=u.canonical.y-L.canonical.y;o.c7(Y,0,o.a5,o.a5,0,0,1),o.O(Y,Y,[re*o.a5,le*o.a5,0])}else if(L.canonical.z>u.canonical.z){const re=L.canonical.z-u.canonical.z,le=L.canonical.x-(L.canonical.x>>re<<re)+u.wrap*(1<<L.canonical.z),he=L.canonical.y-(L.canonical.y>>re<<re),Pe=u.canonical.x-(L.canonical.x>>re),Ae=u.canonical.y-(L.canonical.y>>re),Ue=o.a5>>re;o.c7(Y,0,Ue,Ue,0,0,1),o.O(Y,Y,[-le*Ue+Pe*o.a5,-he*Ue+Ae*o.a5,0])}else{const re=u.canonical.z-L.canonical.z,le=u.canonical.x-(u.canonical.x>>re<<re)+u.wrap*(1<<u.canonical.z),he=u.canonical.y-(u.canonical.y>>re<<re),Pe=(u.canonical.x>>re)-L.canonical.x,Ae=(u.canonical.y>>re)-L.canonical.y,Ue=o.a5<<re;o.c7(Y,0,Ue,Ue,0,0,1),o.O(Y,Y,[le*o.a5+Pe*Ue,he*o.a5+Ae*Ue,0])}z.terrainRttPosMatrix32f=new Float32Array(Y),w[C]=z}return w}getSourceTile(u,g){const w=this.tileManager._source;let C=u.overscaledZ-this.deltaZoom;if(C>w.maxzoom&&(C=w.maxzoom),C<w.minzoom)return;this._sourceTileCache[u.key]||(this._sourceTileCache[u.key]=u.scaledTo(C).key);let L=this.findTileInCaches(this._sourceTileCache[u.key]);if(!L?.dem&&g)for(;C>=w.minzoom&&!L?.dem;)L=this.findTileInCaches(u.scaledTo(C--).key);return L}findTileInCaches(u){let g=this.tileManager.getTileByID(u);return g||(g=this.tileManager._outOfViewCache.getByKey(u),g)}anyTilesAfterTime(u=Date.now()){return this._lastTilesetChange>=u}_isWithinTileRanges(u,g){const w=g[u.canonical.z];return!!w&&(u.wrap>w.minWrap||u.wrap<w.maxWrap||u.canonical.x>=w.minTileXWrapped&&u.canonical.x<=w.maxTileXWrapped&&u.canonical.y>=w.minTileY&&u.canonical.y<=w.maxTileY)}}class ia{constructor(u,g,w){this._meshCache={},this.painter=u,this.tileManager=new Ea(g),this.options=w,this.exaggeration=typeof w.exaggeration=="number"?w.exaggeration:1,this.qualityFactor=2,this.meshSize=128,this._demMatrixCache={},this.coordsIndex=[],this._coordsTextureSize=1024}getDEMElevation(u,g,w,C=o.a5){var L;if(!(g>=0&&g<C&&w>=0&&w<C))return 0;const z=this.getTerrainData(u),Y=(L=z.tile)===null||L===void 0?void 0:L.dem;if(!Y)return 0;const re=o.cC([],[g/C*o.a5,w/C*o.a5],z.u_terrain_matrix),le=[re[0]*Y.dim,re[1]*Y.dim],he=Math.floor(le[0]),Pe=Math.floor(le[1]),Ae=le[0]-he,Ue=le[1]-Pe;return Y.get(he,Pe)*(1-Ae)*(1-Ue)+Y.get(he+1,Pe)*Ae*(1-Ue)+Y.get(he,Pe+1)*(1-Ae)*Ue+Y.get(he+1,Pe+1)*Ae*Ue}getElevationForLngLatZoom(u,g){if(!o.cD(g,u.wrap()))return 0;const{tileID:w,mercatorX:C,mercatorY:L}=this._getOverscaledTileIDFromLngLatZoom(u,g);return this.getElevation(w,C%o.a5,L%o.a5,o.a5)}getElevationForLngLat(u,g){const w=Kn(g,{maxzoom:this.tileManager.maxzoom,minzoom:this.tileManager.minzoom,tileSize:512,terrain:this});let C=0;for(const L of w)L.canonical.z>C&&(C=Math.min(L.canonical.z,this.tileManager.maxzoom));return this.getElevationForLngLatZoom(u,C)}getElevation(u,g,w,C=o.a5){return this.getDEMElevation(u,g,w,C)*this.exaggeration}getTerrainData(u){if(!this._emptyDemTexture){const C=this.painter.context,L=new o.R({width:1,height:1},new Uint8Array(4));this._emptyDepthTexture=new o.T(C,L,C.gl.RGBA,{premultiply:!1}),this._emptyDemUnpack=[0,0,0,0],this._emptyDemTexture=new o.T(C,new o.R({width:1,height:1}),C.gl.RGBA,{premultiply:!1}),this._emptyDemTexture.bind(C.gl.NEAREST,C.gl.CLAMP_TO_EDGE),this._emptyDemMatrix=o.ar([])}const g=this.tileManager.getSourceTile(u,!0);if(g&&g.dem&&(!g.demTexture||g.needsTerrainPrepare)){const C=this.painter.context;g.demTexture=this.painter.getTileTexture(g.dem.stride),g.demTexture?g.demTexture.update(g.dem.getPixels(),{premultiply:!1}):g.demTexture=new o.T(C,g.dem.getPixels(),C.gl.RGBA,{premultiply:!1}),g.demTexture.bind(C.gl.NEAREST,C.gl.CLAMP_TO_EDGE),g.needsTerrainPrepare=!1}const w=g&&g.toString()+g.tileID.key+u.key;if(w&&!this._demMatrixCache[w]){const C=this.tileManager.getSource().maxzoom;let L=u.canonical.z-g.tileID.canonical.z;u.overscaledZ>u.canonical.z&&(u.canonical.z>=C?L=u.canonical.z-C:o.w("cannot calculate elevation if elevation maxzoom > source.maxzoom"));const z=u.canonical.x-(u.canonical.x>>L<<L),Y=u.canonical.y-(u.canonical.y>>L<<L),re=o.cE(new Float64Array(16),[1/(o.a5<<L),1/(o.a5<<L),0]);o.O(re,re,[z*o.a5,Y*o.a5,0]),this._demMatrixCache[u.key]={matrix:re,coord:u}}return{u_depth:2,u_terrain:3,u_terrain_dim:g&&g.dem&&g.dem.dim||1,u_terrain_matrix:w?this._demMatrixCache[u.key].matrix:this._emptyDemMatrix,u_terrain_unpack:g&&g.dem&&g.dem.getUnpackVector()||this._emptyDemUnpack,u_terrain_exaggeration:this.exaggeration,texture:(g&&g.demTexture||this._emptyDemTexture).texture,depthTexture:(this._fboDepthTexture||this._emptyDepthTexture).texture,tile:g}}getFramebuffer(u){const g=this.painter,w=g.width/devicePixelRatio,C=g.height/devicePixelRatio;return!this._fbo||this._fbo.width===w&&this._fbo.height===C||(this._fbo.destroy(),this._fboCoordsTexture.destroy(),this._fboDepthTexture.destroy(),delete this._fbo,delete this._fboDepthTexture,delete this._fboCoordsTexture),this._fboCoordsTexture||(this._fboCoordsTexture=new o.T(g.context,{width:w,height:C,data:null},g.context.gl.RGBA,{premultiply:!1}),this._fboCoordsTexture.bind(g.context.gl.NEAREST,g.context.gl.CLAMP_TO_EDGE)),this._fboDepthTexture||(this._fboDepthTexture=new o.T(g.context,{width:w,height:C,data:null},g.context.gl.RGBA,{premultiply:!1}),this._fboDepthTexture.bind(g.context.gl.NEAREST,g.context.gl.CLAMP_TO_EDGE)),this._fbo||(this._fbo=g.context.createFramebuffer(w,C,!0,!1),this._fbo.depthAttachment.set(g.context.createRenderbuffer(g.context.gl.DEPTH_COMPONENT16,w,C))),this._fbo.colorAttachment.set(u==="coords"?this._fboCoordsTexture.texture:this._fboDepthTexture.texture),this._fbo}getCoordsTexture(){const u=this.painter.context;if(this._coordsTexture)return this._coordsTexture;const g=new Uint8Array(this._coordsTextureSize*this._coordsTextureSize*4);for(let L=0,z=0;L<this._coordsTextureSize;L++)for(let Y=0;Y<this._coordsTextureSize;Y++,z+=4)g[z+0]=255&Y,g[z+1]=255&L,g[z+2]=Y>>8<<4|L>>8,g[z+3]=0;const w=new o.R({width:this._coordsTextureSize,height:this._coordsTextureSize},new Uint8Array(g.buffer)),C=new o.T(u,w,u.gl.RGBA,{premultiply:!1});return C.bind(u.gl.NEAREST,u.gl.CLAMP_TO_EDGE),this._coordsTexture=C,C}pointCoordinate(u){this.painter.maybeDrawDepthAndCoords(!0);const g=new Uint8Array(4),w=this.painter.context,C=w.gl,L=Math.round(u.x*this.painter.pixelRatio/devicePixelRatio),z=Math.round(u.y*this.painter.pixelRatio/devicePixelRatio),Y=Math.round(this.painter.height/devicePixelRatio);w.bindFramebuffer.set(this.getFramebuffer("coords").framebuffer),C.readPixels(L,Y-z-1,1,1,C.RGBA,C.UNSIGNED_BYTE,g),w.bindFramebuffer.set(null);const re=g[0]+(g[2]>>4<<8),le=g[1]+((15&g[2])<<8),he=this.coordsIndex[255-g[3]],Pe=he&&this.tileManager.getTileByID(he);if(!Pe)return null;const Ae=this._coordsTextureSize,Ue=(1<<Pe.tileID.canonical.z)*Ae;return new o.a9((Pe.tileID.canonical.x*Ae+re)/Ue+Pe.tileID.wrap,(Pe.tileID.canonical.y*Ae+le)/Ue,this.getElevation(Pe.tileID,re,le,Ae))}depthAtPoint(u){const g=new Uint8Array(4),w=this.painter.context,C=w.gl;return w.bindFramebuffer.set(this.getFramebuffer("depth").framebuffer),C.readPixels(u.x,this.painter.height/devicePixelRatio-u.y-1,1,1,C.RGBA,C.UNSIGNED_BYTE,g),w.bindFramebuffer.set(null),(g[0]/16777216+g[1]/65536+g[2]/256+g[3])/256}getTerrainMesh(u){var g;const w=((g=this.painter.style.projection)===null||g===void 0?void 0:g.transitionState)>0,C=w&&u.canonical.y===0,L=w&&u.canonical.y===(1<<u.canonical.z)-1,z=`m_${C?"n":""}_${L?"s":""}`;if(this._meshCache[z])return this._meshCache[z];const Y=this.painter.context,re=new o.cF,le=new o.aY,he=this.meshSize,Pe=o.a5/he,Ae=he*he;for(let Dt=0;Dt<=he;Dt++)for(let Zt=0;Zt<=he;Zt++)re.emplaceBack(Zt*Pe,Dt*Pe,0);for(let Dt=0;Dt<Ae;Dt+=he+1)for(let Zt=0;Zt<he;Zt++)le.emplaceBack(Zt+Dt,he+Zt+Dt+1,he+Zt+Dt+2),le.emplaceBack(Zt+Dt,he+Zt+Dt+2,Zt+Dt+1);const Ue=re.length,Ze=Ue+(he+1),ht=(he+1)*he,pt=C?o.br:0,dt=C?0:1,xt=L?o.bs:o.a5,Nt=L?0:1;for(let Dt=0;Dt<=he;Dt++)re.emplaceBack(Dt*Pe,pt,dt);for(let Dt=0;Dt<=he;Dt++)re.emplaceBack(Dt*Pe,xt,Nt);for(let Dt=0;Dt<he;Dt++)le.emplaceBack(ht+Dt,Ze+Dt,Ze+Dt+1),le.emplaceBack(ht+Dt,Ze+Dt+1,ht+Dt+1),le.emplaceBack(0+Dt,Ue+Dt+1,Ue+Dt),le.emplaceBack(0+Dt,0+Dt+1,Ue+Dt+1);const wt=re.length,Lt=wt+2*(he+1);for(const Dt of[0,1])for(let Zt=0;Zt<=he;Zt++)for(const Sr of[0,1])re.emplaceBack(Dt*o.a5,Zt*Pe,Sr);for(let Dt=0;Dt<2*he;Dt+=2)le.emplaceBack(wt+Dt,wt+Dt+1,wt+Dt+3),le.emplaceBack(wt+Dt,wt+Dt+3,wt+Dt+2),le.emplaceBack(Lt+Dt,Lt+Dt+3,Lt+Dt+1),le.emplaceBack(Lt+Dt,Lt+Dt+2,Lt+Dt+3);const jt=new fi(Y.createVertexBuffer(re,gu.members),Y.createIndexBuffer(le),o.aX.simpleSegment(0,0,re.length,le.length));return this._meshCache[z]=jt,jt}getMeshFrameDelta(u){return 2*Math.PI*o.bE/Math.pow(2,Math.max(u,0))/5}getMinTileElevationForLngLatZoom(u,g){var w;if(!o.cD(g,u.wrap()))return 0;const{tileID:C}=this._getOverscaledTileIDFromLngLatZoom(u,g);return(w=this.getMinMaxElevation(C).minElevation)!==null&&w!==void 0?w:0}getMinMaxElevation(u){const g=this.getTerrainData(u).tile,w={minElevation:null,maxElevation:null};return g&&g.dem&&(w.minElevation=g.dem.min*this.exaggeration,w.maxElevation=g.dem.max*this.exaggeration),w}_getOverscaledTileIDFromLngLatZoom(u,g){const w=o.a9.fromLngLat(u.wrap()),C=(1<<g)*o.a5,L=w.x*C,z=w.y*C,Y=Math.floor(L/o.a5),re=Math.floor(z/o.a5);return{tileID:new o.a2(g,0,g,Y,re),mercatorX:L,mercatorY:z}}}class pa{constructor(u,g,w){this._context=u,this._size=g,this._tileSize=w,this._objects=[],this._recentlyUsed=[],this._stamp=0}destruct(){for(const u of this._objects)u.texture.destroy(),u.fbo.destroy()}_createObject(u){const g=this._context.createFramebuffer(this._tileSize,this._tileSize,!0,!0),w=new o.T(this._context,{width:this._tileSize,height:this._tileSize,data:null},this._context.gl.RGBA);return w.bind(this._context.gl.LINEAR,this._context.gl.CLAMP_TO_EDGE),this._context.extTextureFilterAnisotropic&&this._context.gl.texParameterf(this._context.gl.TEXTURE_2D,this._context.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,this._context.extTextureFilterAnisotropicMax),g.depthAttachment.set(this._context.createRenderbuffer(this._context.gl.DEPTH_STENCIL,this._tileSize,this._tileSize)),g.colorAttachment.set(w.texture),{id:u,fbo:g,texture:w,stamp:-1,inUse:!1}}getObjectForId(u){return this._objects[u]}useObject(u){u.inUse=!0,this._recentlyUsed=this._recentlyUsed.filter((g=>u.id!==g)),this._recentlyUsed.push(u.id)}stampObject(u){u.stamp=++this._stamp}getOrCreateFreeObject(){for(const g of this._recentlyUsed)if(!this._objects[g].inUse)return this._objects[g];if(this._objects.length>=this._size)throw new Error("No free RenderPool available, call freeAllObjects() required!");const u=this._createObject(this._objects.length);return this._objects.push(u),u}freeObject(u){u.inUse=!1}freeAllObjects(){for(const u of this._objects)this.freeObject(u)}isFull(){return!(this._objects.length<this._size)&&this._objects.some((u=>!u.inUse))===!1}}const mu={background:!0,fill:!0,line:!0,raster:!0,hillshade:!0,"color-relief":!0};class yu{constructor(u,g){this.painter=u,this.terrain=g,this.pool=new pa(u.context,30,g.tileManager.tileSize*g.qualityFactor)}destruct(){this.pool.destruct()}getTexture(u){return this.pool.getObjectForId(u.rtt[this._stacks.length-1].id).texture}prepareForRender(u,g){this._stacks=[],this._prevType=null,this._rttTiles=[],this._renderableTiles=this.terrain.tileManager.getRenderableTiles(),this._renderableLayerIds=u._order.filter((w=>!u._layers[w].isHidden(g))),this._coordsAscending={};for(const w in u.tileManagers){this._coordsAscending[w]={};const C=u.tileManagers[w].getVisibleCoordinates(),L=u.tileManagers[w].getSource(),z=L instanceof Jt?L.terrainTileRanges:null;for(const Y of C){const re=this.terrain.tileManager.getTerrainCoords(Y,z);for(const le in re)this._coordsAscending[w][le]||(this._coordsAscending[w][le]=[]),this._coordsAscending[w][le].push(re[le])}}this._coordsAscendingStr={};for(const w of u._order){const C=u._layers[w],L=C.source;if(mu[C.type]&&!this._coordsAscendingStr[L]){this._coordsAscendingStr[L]={};for(const z in this._coordsAscending[L])this._coordsAscendingStr[L][z]=this._coordsAscending[L][z].map((Y=>Y.key)).sort().join()}}for(const w of this._renderableTiles)for(const C in this._coordsAscendingStr){const L=this._coordsAscendingStr[C][w.tileID.key];L&&L!==w.rttCoords[C]&&(w.rtt=[])}}renderLayer(u,g){if(u.isHidden(this.painter.transform.zoom))return!1;const w=Object.assign(Object.assign({},g),{isRenderingToTexture:!0}),C=u.type,L=this.painter,z=this._renderableLayerIds[this._renderableLayerIds.length-1]===u.id;if(mu[C]&&(this._prevType&&mu[this._prevType]||this._stacks.push([]),this._prevType=C,this._stacks[this._stacks.length-1].push(u.id),!z))return!0;if(mu[this._prevType]||mu[C]&&z){this._prevType=C;const Y=this._stacks.length-1,re=this._stacks[Y]||[];for(const le of this._renderableTiles){if(this.pool.isFull()&&(Zg(this.painter,this.terrain,this._rttTiles,w),this._rttTiles=[],this.pool.freeAllObjects()),this._rttTiles.push(le),le.rtt[Y]){const Pe=this.pool.getObjectForId(le.rtt[Y].id);if(Pe.stamp===le.rtt[Y].stamp){this.pool.useObject(Pe);continue}}const he=this.pool.getOrCreateFreeObject();this.pool.useObject(he),this.pool.stampObject(he),le.rtt[Y]={id:he.id,stamp:he.stamp},L.context.bindFramebuffer.set(he.fbo.framebuffer),L.context.clear({color:o.bp.transparent,stencil:0}),L.currentStencilSource=void 0;for(let Pe=0;Pe<re.length;Pe++){const Ae=L.style._layers[re[Pe]],Ue=Ae.source?this._coordsAscending[Ae.source][le.tileID.key]:[le.tileID];L.context.viewport.set([0,0,he.fbo.width,he.fbo.height]),L._renderTileClippingMasks(Ae,Ue,!0),L.renderLayer(L,L.style.tileManagers[Ae.source],Ae,Ue,w),Ae.source&&(le.rttCoords[Ae.source]=this._coordsAscendingStr[Ae.source][le.tileID.key])}}return Zg(this.painter,this.terrain,this._rttTiles,w),this._rttTiles=[],this.pool.freeAllObjects(),mu[C]}return!1}}const is={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"MapLibre logo","Map.Title":"Map","Marker.Title":"Map marker","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","Popup.Close":"Close popup","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm","GlobeControl.Enable":"Enable globe","GlobeControl.Disable":"Disable globe","TerrainControl.Enable":"Enable terrain","TerrainControl.Disable":"Disable terrain","CooperativeGesturesHandler.WindowsHelpText":"Use Ctrl + scroll to zoom the map","CooperativeGesturesHandler.MacHelpText":"Use  + scroll to zoom the map","CooperativeGesturesHandler.MobileHelpText":"Use two fingers to move the map"},Uh=c,Vh={hash:!1,interactive:!0,bearingSnap:7,attributionControl:eo,maplibreLogo:!1,refreshExpiredTiles:!0,canvasContextAttributes:{antialias:!1,preserveDrawingBuffer:!1,powerPreference:"high-performance",failIfMajorPerformanceCaveat:!1,desynchronized:!1,contextType:void 0},scrollZoom:!0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,trackResize:!0,center:[0,0],elevation:0,zoom:0,bearing:0,pitch:0,roll:0,renderWorldCopies:!0,maxTileCacheSize:null,maxTileCacheZoomLevels:o.c.MAX_TILE_CACHE_ZOOM_LEVELS,transformRequest:null,transformCameraUpdate:null,transformConstrain:null,fadeDuration:300,crossSourceCollisions:!0,clickTolerance:3,localIdeographFontFamily:"sans-serif",pitchWithRotate:!0,rollEnabled:!1,reduceMotion:void 0,validateStyle:!0,maxCanvasSize:[4096,4096],cancelPendingTileRequestsWhileZooming:!0,centerClampedToGround:!0,experimentalZoomLevelsToOverscale:void 0},$h={showCompass:!0,showZoom:!0,visualizePitch:!1,visualizeRoll:!0};class Gc{constructor(u,g,w=!1){this.mousedown=L=>{this.startMove(L,A.mousePos(this.element,L)),A.addEventListener(window,"mousemove",this.mousemove),A.addEventListener(window,"mouseup",this.mouseup)},this.mousemove=L=>{this.move(L,A.mousePos(this.element,L))},this.mouseup=L=>{this._rotatePitchHandler.dragEnd(L),this.offTemp()},this.touchstart=L=>{L.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=A.touchPos(this.element,L.targetTouches)[0],this.startMove(L,this._startPos),A.addEventListener(window,"touchmove",this.touchmove,{passive:!1}),A.addEventListener(window,"touchend",this.touchend))},this.touchmove=L=>{L.targetTouches.length!==1?this.reset():(this._lastPos=A.touchPos(this.element,L.targetTouches)[0],this.move(L,this._lastPos))},this.touchend=L=>{L.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),delete this._startPos,delete this._lastPos,this.offTemp()},this.reset=()=>{this._rotatePitchHandler.reset(),delete this._startPos,delete this._lastPos,this.offTemp()},this._clickTolerance=10,this.element=g;const C=new Vn;this._rotatePitchHandler=new yr({clickTolerance:3,move:(L,z)=>{const Y=g.getBoundingClientRect(),re=new o.P((Y.bottom-Y.top)/2,(Y.right-Y.left)/2);return{bearingDelta:o.cx(new o.P(L.x,z.y),z,re),pitchDelta:w?-.5*(z.y-L.y):void 0}},moveStateManager:C,enable:!0,assignEvents:()=>{}}),this.map=u,A.addEventListener(g,"mousedown",this.mousedown),A.addEventListener(g,"touchstart",this.touchstart,{passive:!1}),A.addEventListener(g,"touchcancel",this.reset)}startMove(u,g){this._rotatePitchHandler.dragStart(u,g),A.disableDrag()}move(u,g){const w=this.map,{bearingDelta:C,pitchDelta:L}=this._rotatePitchHandler.dragMove(u,g)||{};C&&w.setBearing(w.getBearing()+C),L&&w.setPitch(w.getPitch()+L)}off(){const u=this.element;A.removeEventListener(u,"mousedown",this.mousedown),A.removeEventListener(u,"touchstart",this.touchstart,{passive:!1}),A.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),A.removeEventListener(window,"touchend",this.touchend),A.removeEventListener(u,"touchcancel",this.reset),this.offTemp()}offTemp(){A.enableDrag(),A.removeEventListener(window,"mousemove",this.mousemove),A.removeEventListener(window,"mouseup",this.mouseup),A.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),A.removeEventListener(window,"touchend",this.touchend)}}let Wc;function $p(D,u,g,w=!1){if(w||!g.getCoveringTilesDetailsProvider().allowWorldCopies())return D?.wrap();const C=new o.V(D.lng,D.lat);if(D=new o.V(D.lng,D.lat),u){const L=new o.V(D.lng-360,D.lat),z=new o.V(D.lng+360,D.lat),Y=g.locationToScreenPoint(D).distSqr(u);g.locationToScreenPoint(L).distSqr(u)<Y?D=L:g.locationToScreenPoint(z).distSqr(u)<Y&&(D=z)}for(;Math.abs(D.lng-g.center.lng)>180;){const L=g.locationToScreenPoint(D);if(L.x>=0&&L.y>=0&&L.x<=g.width&&L.y<=g.height)break;D.lng>g.center.lng?D.lng-=360:D.lng+=360}return D.lng!==C.lng&&g.isPointOnMapSurface(g.locationToScreenPoint(D))?D:C}const sh={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function sc(D,u,g){const w=D.classList;for(const C in sh)w.remove(`maplibregl-${g}-anchor-${C}`);w.add(`maplibregl-${g}-anchor-${u}`)}class Vd extends o.E{constructor(u){if(super(),this._onKeyPress=g=>{const w=g.code,C=g.charCode||g.keyCode;w!=="Space"&&w!=="Enter"&&C!==32&&C!==13||this.togglePopup()},this._onMapClick=g=>{const w=g.originalEvent.target,C=this._element;this._popup&&(w===C||C.contains(w))&&this.togglePopup()},this._update=g=>{if(!this._map)return;const w=this._map.loaded()&&!this._map.isMoving();(g?.type==="terrain"||g?.type==="render"&&!w)&&this._map.once("render",this._update),this._lngLat=$p(this._lngLat,this._flatPos,this._map.transform),this._flatPos=this._pos=this._map.project(this._lngLat)._add(this._offset),this._map.terrain&&(this._flatPos=this._map.transform.locationToScreenPoint(this._lngLat)._add(this._offset));let C="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?C=`rotateZ(${this._rotation}deg)`:this._rotationAlignment==="map"&&(C=`rotateZ(${this._rotation-this._map.getBearing()}deg)`);let L="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?L="rotateX(0deg)":this._pitchAlignment==="map"&&(L=`rotateX(${this._map.getPitch()}deg)`),this._subpixelPositioning||g&&g.type!=="moveend"||(this._pos=this._pos.round()),A.setTransform(this._element,`${sh[this._anchor]} translate(${this._pos.x}px, ${this._pos.y}px) ${L} ${C}`),x.frameAsync(new AbortController).then((()=>{this._updateOpacity(g&&g.type==="moveend")})).catch((()=>{}))},this._onMove=g=>{if(!this._isDragging){const w=this._clickTolerance||this._map._clickTolerance;this._isDragging=g.point.dist(this._pointerdownPos)>=w}this._isDragging&&(this._pos=g.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new o.l("dragstart"))),this.fire(new o.l("drag")))},this._onUp=()=>{this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new o.l("dragend")),this._state="inactive"},this._addDragHandler=g=>{this._element.contains(g.originalEvent.target)&&(g.preventDefault(),this._positionDelta=g.point.sub(this._pos).add(this._offset),this._pointerdownPos=g.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},this._anchor=u&&u.anchor||"center",this._color=u&&u.color||"#3FB1CE",this._scale=u&&u.scale||1,this._draggable=u&&u.draggable||!1,this._clickTolerance=u&&u.clickTolerance||0,this._subpixelPositioning=u&&u.subpixelPositioning||!1,this._isDragging=!1,this._state="inactive",this._rotation=u&&u.rotation||0,this._rotationAlignment=u&&u.rotationAlignment||"auto",this._pitchAlignment=u&&u.pitchAlignment&&u.pitchAlignment!=="auto"?u.pitchAlignment:this._rotationAlignment,this.setOpacity(u?.opacity,u?.opacityWhenCovered),u&&u.element)this._element=u.element,this._offset=o.P.convert(u&&u.offset||[0,0]);else{this._defaultMarker=!0,this._element=A.create("div");const g=A.createNS("http://www.w3.org/2000/svg","svg"),w=41,C=27;g.setAttributeNS(null,"display","block"),g.setAttributeNS(null,"height",`${w}px`),g.setAttributeNS(null,"width",`${C}px`),g.setAttributeNS(null,"viewBox",`0 0 ${C} ${w}`);const L=A.createNS("http://www.w3.org/2000/svg","g");L.setAttributeNS(null,"stroke","none"),L.setAttributeNS(null,"stroke-width","1"),L.setAttributeNS(null,"fill","none"),L.setAttributeNS(null,"fill-rule","evenodd");const z=A.createNS("http://www.w3.org/2000/svg","g");z.setAttributeNS(null,"fill-rule","nonzero");const Y=A.createNS("http://www.w3.org/2000/svg","g");Y.setAttributeNS(null,"transform","translate(3.0, 29.0)"),Y.setAttributeNS(null,"fill","#000000");const re=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];for(const dt of re){const xt=A.createNS("http://www.w3.org/2000/svg","ellipse");xt.setAttributeNS(null,"opacity","0.04"),xt.setAttributeNS(null,"cx","10.5"),xt.setAttributeNS(null,"cy","5.80029008"),xt.setAttributeNS(null,"rx",dt.rx),xt.setAttributeNS(null,"ry",dt.ry),Y.appendChild(xt)}const le=A.createNS("http://www.w3.org/2000/svg","g");le.setAttributeNS(null,"fill",this._color);const he=A.createNS("http://www.w3.org/2000/svg","path");he.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),le.appendChild(he);const Pe=A.createNS("http://www.w3.org/2000/svg","g");Pe.setAttributeNS(null,"opacity","0.25"),Pe.setAttributeNS(null,"fill","#000000");const Ae=A.createNS("http://www.w3.org/2000/svg","path");Ae.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),Pe.appendChild(Ae);const Ue=A.createNS("http://www.w3.org/2000/svg","g");Ue.setAttributeNS(null,"transform","translate(6.0, 7.0)"),Ue.setAttributeNS(null,"fill","#FFFFFF");const Ze=A.createNS("http://www.w3.org/2000/svg","g");Ze.setAttributeNS(null,"transform","translate(8.0, 8.0)");const ht=A.createNS("http://www.w3.org/2000/svg","circle");ht.setAttributeNS(null,"fill","#000000"),ht.setAttributeNS(null,"opacity","0.25"),ht.setAttributeNS(null,"cx","5.5"),ht.setAttributeNS(null,"cy","5.5"),ht.setAttributeNS(null,"r","5.4999962");const pt=A.createNS("http://www.w3.org/2000/svg","circle");pt.setAttributeNS(null,"fill","#FFFFFF"),pt.setAttributeNS(null,"cx","5.5"),pt.setAttributeNS(null,"cy","5.5"),pt.setAttributeNS(null,"r","5.4999962"),Ze.appendChild(ht),Ze.appendChild(pt),z.appendChild(Y),z.appendChild(le),z.appendChild(Pe),z.appendChild(Ue),z.appendChild(Ze),g.appendChild(z),g.setAttributeNS(null,"height",w*this._scale+"px"),g.setAttributeNS(null,"width",C*this._scale+"px"),this._element.appendChild(g),this._offset=o.P.convert(u&&u.offset||[0,-14])}if(this._element.classList.add("maplibregl-marker"),this._element.addEventListener("dragstart",(g=>{g.preventDefault()})),this._element.addEventListener("mousedown",(g=>{g.preventDefault()})),sc(this._element,this._anchor,"marker"),u&&u.className)for(const g of u.className.split(" "))this._element.classList.add(g);this._popup=null}addTo(u){return this.remove(),this._map=u,this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label",u._getUIString("Marker.Title")),this._element.hasAttribute("role")||this._element.setAttribute("role","button"),u.getCanvasContainer().appendChild(this._element),u.on("move",this._update),u.on("moveend",this._update),u.on("terrain",this._update),u.on("projectiontransition",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this}remove(){return this._opacityTimeout&&(clearTimeout(this._opacityTimeout),delete this._opacityTimeout),this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("terrain",this._update),this._map.off("projectiontransition",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),A.remove(this._element),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(u){return this._lngLat=o.V.convert(u),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this}getElement(){return this._element}setPopup(u){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),u){if(!("offset"in u.options)){const C=Math.abs(13.5)/Math.SQRT2;u.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[C,-1*(38.1-13.5+C)],"bottom-right":[-C,-1*(38.1-13.5+C)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=u,this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this}setSubpixelPositioning(u){return this._subpixelPositioning=u,this}getPopup(){return this._popup}togglePopup(){const u=this._popup;return this._element.style.opacity===this._opacityWhenCovered?this:u?(u.isOpen()?u.remove():(u.setLngLat(this._lngLat),u.addTo(this._map)),this):this}_updateOpacity(u=!1){var g,w;const C=(g=this._map)===null||g===void 0?void 0:g.terrain,L=this._map.transform.isLocationOccluded(this._lngLat);if(!C||L){const Ue=L?this._opacityWhenCovered:this._opacity;return void(this._element.style.opacity!==Ue&&(this._element.style.opacity=Ue))}if(u)this._opacityTimeout=null;else{if(this._opacityTimeout)return;this._opacityTimeout=setTimeout((()=>{this._opacityTimeout=null}),100)}const z=this._map,Y=z.terrain.depthAtPoint(this._pos),re=z.terrain.getElevationForLngLat(this._lngLat,z.transform);if(z.transform.lngLatToCameraDepth(this._lngLat,re)-Y<.006)return void(this._element.style.opacity=this._opacity);const le=-this._offset.y/z.transform.pixelsPerMeter,he=Math.sin(z.getPitch()*Math.PI/180)*le,Pe=z.terrain.depthAtPoint(new o.P(this._pos.x,this._pos.y-this._offset.y)),Ae=z.transform.lngLatToCameraDepth(this._lngLat,re+he)-Pe>.006;!((w=this._popup)===null||w===void 0)&&w.isOpen()&&Ae&&this._popup.remove(),this._element.style.opacity=Ae?this._opacityWhenCovered:this._opacity}getOffset(){return this._offset}setOffset(u){return this._offset=o.P.convert(u),this._update(),this}addClassName(u){this._element.classList.add(u)}removeClassName(u){this._element.classList.remove(u)}toggleClassName(u){return this._element.classList.toggle(u)}setDraggable(u){return this._draggable=!!u,this._map&&(u?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(u){return this._rotation=u||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(u){return this._rotationAlignment=u||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(u){return this._pitchAlignment=u&&u!=="auto"?u:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}setOpacity(u,g){return(this._opacity===void 0||u===void 0&&g===void 0)&&(this._opacity="1",this._opacityWhenCovered="0.2"),u!==void 0&&(this._opacity=u),g!==void 0&&(this._opacityWhenCovered=g),this._map&&this._updateOpacity(!0),this}}const Qg={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0};let qh=0,Ef=!1;const Hh={maxWidth:100,unit:"metric"};function Gh(D,u,g){const w=g&&g.maxWidth||100,C=D._container.clientHeight/2,L=D._container.clientWidth/2,z=D.unproject([L-w/2,C]),Y=D.unproject([L+w/2,C]),re=Math.round(D.project(Y).x-D.project(z).x),le=Math.min(w,re,D._container.clientWidth),he=z.distanceTo(Y);if(g&&g.unit==="imperial"){const Pe=3.2808*he;Pe>5280?Tf(u,le,Pe/5280,D._getUIString("ScaleControl.Miles")):Tf(u,le,Pe,D._getUIString("ScaleControl.Feet"))}else g&&g.unit==="nautical"?Tf(u,le,he/1852,D._getUIString("ScaleControl.NauticalMiles")):he>=1e3?Tf(u,le,he/1e3,D._getUIString("ScaleControl.Kilometers")):Tf(u,le,he,D._getUIString("ScaleControl.Meters"))}function Tf(D,u,g,w){const C=(function(L){const z=Math.pow(10,`${Math.floor(L)}`.length-1);let Y=L/z;return Y=Y>=10?10:Y>=5?5:Y>=3?3:Y>=2?2:Y>=1?1:(function(re){const le=Math.pow(10,Math.ceil(-Math.log(re)/Math.LN10));return Math.round(re*le)/le})(Y),z*Y})(g);D.style.width=u*(C/g)+"px",D.innerHTML=`${C}&nbsp;${w}`}const Wh={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px",subpixelPositioning:!1,locationOccludedOpacity:void 0,padding:void 0},Xh=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function Cf(D){if(D){if(typeof D=="number"){const u=Math.round(Math.abs(D)/Math.SQRT2);return{center:new o.P(0,0),top:new o.P(0,D),"top-left":new o.P(u,u),"top-right":new o.P(-u,u),bottom:new o.P(0,-D),"bottom-left":new o.P(u,-u),"bottom-right":new o.P(-u,-u),left:new o.P(D,0),right:new o.P(-D,0)}}if(D instanceof o.P||Array.isArray(D)){const u=o.P.convert(D);return{center:u,top:u,"top-left":u,"top-right":u,bottom:u,"bottom-left":u,"bottom-right":u,left:u,right:u}}return{center:o.P.convert(D.center||[0,0]),top:o.P.convert(D.top||[0,0]),"top-left":o.P.convert(D["top-left"]||[0,0]),"top-right":o.P.convert(D["top-right"]||[0,0]),bottom:o.P.convert(D.bottom||[0,0]),"bottom-left":o.P.convert(D["bottom-left"]||[0,0]),"bottom-right":o.P.convert(D["bottom-right"]||[0,0]),left:o.P.convert(D.left||[0,0]),right:o.P.convert(D.right||[0,0])}}return Cf(new o.P(0,0))}const qp=c;s.AJAXError=o.cI,s.Event=o.l,s.Evented=o.E,s.LngLat=o.V,s.MercatorCoordinate=o.a9,s.Point=o.P,s.addProtocol=o.cJ,s.config=o.c,s.removeProtocol=o.cK,s.AttributionControl=Rl,s.BoxZoomHandler=br,s.CanvasSource=Ce,s.CooperativeGesturesHandler=Tn,s.DoubleClickZoomHandler=Go,s.DragPanHandler=Co,s.DragRotateHandler=qi,s.EdgeInsets=Ts,s.FullscreenControl=class extends o.E{constructor(D={}){super(),this._onFullscreenChange=()=>{var u;let g=window.document.fullscreenElement||window.document.mozFullScreenElement||window.document.webkitFullscreenElement||window.document.msFullscreenElement;for(;!((u=g?.shadowRoot)===null||u===void 0)&&u.fullscreenElement;)g=g.shadowRoot.fullscreenElement;g===this._container!==this._fullscreen&&this._handleFullscreenChange()},this._onClickFullscreen=()=>{this._isFullscreen()?this._exitFullscreen():this._requestFullscreen()},this._fullscreen=!1,D&&D.container&&(D.container instanceof HTMLElement?this._container=D.container:o.w("Full screen control 'container' must be a DOM element.")),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in document&&(this._fullscreenchange="MSFullscreenChange")}onAdd(D){return this._map=D,this._container||(this._container=this._map.getContainer()),this._controlContainer=A.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),this._controlContainer}onRemove(){A.remove(this._controlContainer),this._map=null,window.document.removeEventListener(this._fullscreenchange,this._onFullscreenChange)}_setupUI(){const D=this._fullscreenButton=A.create("button","maplibregl-ctrl-fullscreen",this._controlContainer);A.create("span","maplibregl-ctrl-icon",D).setAttribute("aria-hidden","true"),D.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),window.document.addEventListener(this._fullscreenchange,this._onFullscreenChange)}_updateTitle(){const D=this._getTitle();this._fullscreenButton.setAttribute("aria-label",D),this._fullscreenButton.title=D}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_handleFullscreenChange(){this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("maplibregl-ctrl-shrink"),this._fullscreenButton.classList.toggle("maplibregl-ctrl-fullscreen"),this._updateTitle(),this._fullscreen?(this.fire(new o.l("fullscreenstart")),this._prevCooperativeGesturesEnabled=this._map.cooperativeGestures.isEnabled(),this._map.cooperativeGestures.disable()):(this.fire(new o.l("fullscreenend")),this._prevCooperativeGesturesEnabled&&this._map.cooperativeGestures.enable())}_exitFullscreen(){window.document.exitFullscreen?window.document.exitFullscreen():window.document.mozCancelFullScreen?window.document.mozCancelFullScreen():window.document.msExitFullscreen?window.document.msExitFullscreen():window.document.webkitCancelFullScreen?window.document.webkitCancelFullScreen():this._togglePseudoFullScreen()}_requestFullscreen(){this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen?this._container.webkitRequestFullscreen():this._togglePseudoFullScreen()}_togglePseudoFullScreen(){this._container.classList.toggle("maplibregl-pseudo-fullscreen"),this._handleFullscreenChange(),this._map.resize()}},s.GeoJSONSource=Er,s.GeolocateControl=class extends o.E{constructor(D){super(),this._onSuccess=u=>{if(this._map){if(this._isOutOfMapMaxBounds(u))return this._setErrorState(),this.fire(new o.l("outofmaxbounds",u)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=u,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background");break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(u),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(u),this.options.showUserLocation&&this._dotElement.classList.remove("maplibregl-user-location-dot-stale"),this.fire(new o.l("geolocate",u)),this._finish()}},this._updateCamera=u=>{const g=new o.V(u.coords.longitude,u.coords.latitude),w=u.coords.accuracy,C=this._map.getBearing(),L=o.e({bearing:C},this.options.fitBoundsOptions),z=$t.fromLngLat(g,w);this._map.fitBounds(z,L,{geolocateSource:!0})},this._updateMarker=u=>{if(u){const g=new o.V(u.coords.longitude,u.coords.latitude);this._accuracyCircleMarker.setLngLat(g).addTo(this._map),this._userLocationDotMarker.setLngLat(g).addTo(this._map),this._accuracy=u.coords.accuracy,this._updateCircleRadiusIfNeeded()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},this._onUpdate=()=>{this._updateCircleRadiusIfNeeded()},this._onError=u=>{if(this._map){if(u.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const g=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=g,this._geolocateButton.setAttribute("aria-label",g),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(u.code===3&&Ef)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("maplibregl-user-location-dot-stale"),this.fire(new o.l("error",u)),this._finish()}},this._finish=()=>{this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},this._setupUI=()=>{this._map&&(this._container.addEventListener("contextmenu",(u=>u.preventDefault())),this._geolocateButton=A.create("button","maplibregl-ctrl-geolocate",this._container),A.create("span","maplibregl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",this._geolocateButton.disabled=!0)},this._finishSetupUI=u=>{if(this._map){if(u===!1){o.w("Geolocation support is not available so the GeolocateControl will be disabled.");const g=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=g,this._geolocateButton.setAttribute("aria-label",g)}else{const g=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.disabled=!1,this._geolocateButton.title=g,this._geolocateButton.setAttribute("aria-label",g)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=A.create("div","maplibregl-user-location-dot"),this._userLocationDotMarker=new Vd({element:this._dotElement}),this._circleElement=A.create("div","maplibregl-user-location-accuracy-circle"),this._accuracyCircleMarker=new Vd({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onUpdate),this._map.on("move",this._onUpdate),this._map.on("rotate",this._onUpdate),this._map.on("pitch",this._onUpdate)),this._geolocateButton.addEventListener("click",(()=>this.trigger())),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",(g=>{const w=g?.[0]instanceof ResizeObserverEntry;g.geolocateSource||this._watchState!=="ACTIVE_LOCK"||w||this._map.isZooming()||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this.fire(new o.l("trackuserlocationend")),this.fire(new o.l("userlocationlostfocus")))}))}},this.options=o.e({},Qg,D)}onAdd(D){return this._map=D,this._container=A.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),(function(){return o._(this,arguments,void 0,(function*(u=!1){if(Wc!==void 0&&!u)return Wc;if(window.navigator.permissions===void 0)return Wc=!!window.navigator.geolocation,Wc;try{Wc=(yield window.navigator.permissions.query({name:"geolocation"})).state!=="denied"}catch{Wc=!!window.navigator.geolocation}return Wc}))})().then((u=>this._finishSetupUI(u))),this._container}onRemove(){this._geolocationWatchID!==void 0&&(window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),A.remove(this._container),this._map.off("zoom",this._onUpdate),this._map.off("move",this._onUpdate),this._map.off("rotate",this._onUpdate),this._map.off("pitch",this._onUpdate),this._map=void 0,qh=0,Ef=!1}_isOutOfMapMaxBounds(D){const u=this._map.getMaxBounds(),g=D.coords;return u&&(g.longitude<u.getWest()||g.longitude>u.getEast()||g.latitude<u.getSouth()||g.latitude>u.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"ACTIVE_ERROR":case"BACKGROUND_ERROR":case"OFF":case void 0:break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}}_updateCircleRadiusIfNeeded(){const D=this._userLocationDotMarker.getLngLat();if(!(this.options.showUserLocation&&this.options.showAccuracyCircle&&this._accuracy&&D))return;const u=this._map.project(D),g=this._map.unproject([u.x+100,u.y]),w=D.distanceTo(g)/100,C=2*this._accuracy/w;this._circleElement.style.width=`${C.toFixed(2)}px`,this._circleElement.style.height=`${C.toFixed(2)}px`}trigger(){if(!this._setup)return o.w("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new o.l("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":qh--,Ef=!1,this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this.fire(new o.l("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new o.l("trackuserlocationstart")),this.fire(new o.l("userlocationfocus"));break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"OFF":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let D;this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),qh++,qh>1?(D={maximumAge:6e5,timeout:0},Ef=!0):(D=this.options.positionOptions,Ef=!1),this._geolocationWatchID=window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,D)}}else window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_clearWatch(){window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},s.GlobeControl=class{constructor(){this._toggleProjection=()=>{var D;const u=(D=this._map.getProjection())===null||D===void 0?void 0:D.type;this._map.setProjection(u!=="mercator"&&u?{type:"mercator"}:{type:"globe"}),this._updateGlobeIcon()},this._updateGlobeIcon=()=>{var D;this._globeButton.classList.remove("maplibregl-ctrl-globe"),this._globeButton.classList.remove("maplibregl-ctrl-globe-enabled"),((D=this._map.getProjection())===null||D===void 0?void 0:D.type)==="globe"?(this._globeButton.classList.add("maplibregl-ctrl-globe-enabled"),this._globeButton.title=this._map._getUIString("GlobeControl.Disable")):(this._globeButton.classList.add("maplibregl-ctrl-globe"),this._globeButton.title=this._map._getUIString("GlobeControl.Enable"))}}onAdd(D){return this._map=D,this._container=A.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._globeButton=A.create("button","maplibregl-ctrl-globe",this._container),A.create("span","maplibregl-ctrl-icon",this._globeButton).setAttribute("aria-hidden","true"),this._globeButton.type="button",this._globeButton.addEventListener("click",this._toggleProjection),this._updateGlobeIcon(),this._map.on("styledata",this._updateGlobeIcon),this._container}onRemove(){A.remove(this._container),this._map.off("styledata",this._updateGlobeIcon),this._globeButton.removeEventListener("click",this._toggleProjection),this._map=void 0}},s.Hash=Vp,s.ImageSource=Jt,s.KeyboardHandler=ki,s.LngLatBounds=$t,s.LogoControl=Yl,s.Map=class extends $a{constructor(D){var u,g;o.cG.mark(o.cH.create);const w=Object.assign(Object.assign(Object.assign({},Vh),D),{canvasContextAttributes:Object.assign(Object.assign({},Vh.canvasContextAttributes),D.canvasContextAttributes)});if(w.minZoom!=null&&w.maxZoom!=null&&w.minZoom>w.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(w.minPitch!=null&&w.maxPitch!=null&&w.minPitch>w.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(w.minPitch!=null&&w.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(w.maxPitch!=null&&w.maxPitch>180)throw new Error("maxPitch must be less than or equal to 180");const C=new $s,L=new go;if(w.minZoom!==void 0&&C.setMinZoom(w.minZoom),w.maxZoom!==void 0&&C.setMaxZoom(w.maxZoom),w.minPitch!==void 0&&C.setMinPitch(w.minPitch),w.maxPitch!==void 0&&C.setMaxPitch(w.maxPitch),w.renderWorldCopies!==void 0&&C.setRenderWorldCopies(w.renderWorldCopies),w.transformConstrain!==null&&C.setConstrainOverride(w.transformConstrain),super(C,L,{bearingSnap:w.bearingSnap}),this._idleTriggered=!1,this._crossFadingFactor=1,this._renderTaskQueue=new Zl,this._controls=[],this._mapId=o.af(),this._lostContextStyle={style:null,images:null},this._contextLost=Y=>{Y.preventDefault(),this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this.painter.destroy();for(const re of Object.values(this.style._layers))if(re.type==="custom"&&console.warn(`Custom layer with id '${re.id}' cannot be restored after WebGL context loss. You will need to re-add it manually after context restoration.`),re._listeners)for(const[le]of Object.entries(re._listeners))console.warn(`Custom layer with id '${re.id}' had event listeners for event '${le}' which cannot be restored after WebGL context loss. You will need to re-add them manually after context restoration.`);this._lostContextStyle=this._getStyleAndImages(),this.style.destroy(),this.style=null,this.fire(new o.l("webglcontextlost",{originalEvent:Y}))},this._contextRestored=Y=>{this._lostContextStyle.style&&this.setStyle(this._lostContextStyle.style,{diff:!1}),this._lostContextStyle.images&&(this.style.imageManager.images=this._lostContextStyle.images),this._lostContextStyle={style:null,images:null},this._setupPainter(),this.resize(),this._update(),this._resizeInternal(),this.fire(new o.l("webglcontextrestored",{originalEvent:Y}))},this._onMapScroll=Y=>{if(Y.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},this._onWindowOnline=()=>{this._update()},this._interactive=w.interactive,this._maxTileCacheSize=w.maxTileCacheSize,this._maxTileCacheZoomLevels=w.maxTileCacheZoomLevels,this._canvasContextAttributes=Object.assign({},w.canvasContextAttributes),this._trackResize=w.trackResize===!0,this._bearingSnap=w.bearingSnap,this._centerClampedToGround=w.centerClampedToGround,this._refreshExpiredTiles=w.refreshExpiredTiles===!0,this._fadeDuration=w.fadeDuration,this._crossSourceCollisions=w.crossSourceCollisions===!0,this._collectResourceTiming=w.collectResourceTiming===!0,this._locale=Object.assign(Object.assign({},is),w.locale),this._clickTolerance=w.clickTolerance,this._overridePixelRatio=w.pixelRatio,this._maxCanvasSize=w.maxCanvasSize,this._zoomLevelsToOverscale=w.experimentalZoomLevelsToOverscale,this.transformCameraUpdate=w.transformCameraUpdate,this.transformConstrain=w.transformConstrain,this.cancelPendingTileRequestsWhileZooming=w.cancelPendingTileRequestsWhileZooming===!0,w.reduceMotion!==void 0&&(x.prefersReducedMotion=w.reduceMotion),this._imageQueueHandle=H.addThrottleControl((()=>this.isMoving())),this._requestManager=new W(w.transformRequest),typeof w.container=="string"){if(this._container=document.getElementById(w.container),!this._container)throw new Error(`Container '${w.container}' not found.`)}else{if(!(w.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=w.container}if(w.maxBounds&&this.setMaxBounds(w.maxBounds),this._setupContainer(),this._setupPainter(),this.on("move",(()=>this._update(!1))),this.on("moveend",(()=>this._update(!1))),this.on("zoom",(()=>this._update(!0))),this.on("terrain",(()=>{this.painter.terrainFacilitator.dirty=!0,this._update(!0)})),this.once("idle",(()=>{this._idleTriggered=!0})),typeof window<"u"){addEventListener("online",this._onWindowOnline,!1);let Y=!1;const re=Jg((le=>{this._trackResize&&!this._removed&&(this.resize(le),this.redraw())}),50);this._resizeObserver=new ResizeObserver((le=>{Y?re(le):Y=!0})),this._resizeObserver.observe(this._container)}this.handlers=new Lo(this,w),this._hash=w.hash&&new Vp(typeof w.hash=="string"&&w.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:w.center,elevation:w.elevation,zoom:w.zoom,bearing:w.bearing,pitch:w.pitch,roll:w.roll}),w.bounds&&(this.resize(),this.fitBounds(w.bounds,o.e({},w.fitBoundsOptions,{duration:0}))));const z=typeof w.style=="string"||((g=(u=w.style)===null||u===void 0?void 0:u.projection)===null||g===void 0?void 0:g.type)!=="globe";this.resize(null,z),this._localIdeographFontFamily=w.localIdeographFontFamily,this._validateStyle=w.validateStyle,w.style&&this.setStyle(w.style,{localIdeographFontFamily:w.localIdeographFontFamily}),w.attributionControl&&this.addControl(new Rl(typeof w.attributionControl=="boolean"?void 0:w.attributionControl)),w.maplibreLogo&&this.addControl(new Yl,w.logoPosition),this.on("style.load",(()=>{if(z||this._resizeTransform(),this.transform.unmodified){const Y=o.U(this.style.stylesheet,["center","zoom","bearing","pitch","roll"]);this.jumpTo(Y)}})),this.on("data",(Y=>{this._update(Y.dataType==="style"),this.fire(new o.l(`${Y.dataType}data`,Y))})),this.on("dataloading",(Y=>{this.fire(new o.l(`${Y.dataType}dataloading`,Y))})),this.on("dataabort",(Y=>{this.fire(new o.l("sourcedataabort",Y))}))}_getMapId(){return this._mapId}setGlobalStateProperty(D,u){return this.style.setGlobalStateProperty(D,u),this._update(!0)}getGlobalState(){return this.style.getGlobalState()}addControl(D,u){if(u===void 0&&(u=D.getDefaultPosition?D.getDefaultPosition():"top-right"),!D||!D.onAdd)return this.fire(new o.k(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const g=D.onAdd(this);this._controls.push(D);const w=this._controlPositions[u];return u.indexOf("bottom")!==-1?w.insertBefore(g,w.firstChild):w.appendChild(g),this}removeControl(D){if(!D||!D.onRemove)return this.fire(new o.k(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const u=this._controls.indexOf(D);return u>-1&&this._controls.splice(u,1),D.onRemove(this),this}hasControl(D){return this._controls.indexOf(D)>-1}coveringTiles(D){return Kn(this.transform,D)}calculateCameraOptionsFromTo(D,u,g,w){return w==null&&this.terrain&&(w=this.terrain.getElevationForLngLat(g,this.transform)),super.calculateCameraOptionsFromTo(D,u,g,w)}resize(D,u=!0){if(this._lostContextStyle.style!==null)return this;this._resizeInternal(u);const g=!this._moving;return g&&(this.stop(),this.fire(new o.l("movestart",D)).fire(new o.l("move",D))),this.fire(new o.l("resize",D)),g&&this.fire(new o.l("moveend",D)),this}_resizeInternal(D=!0){const[u,g]=this._containerDimensions(),w=this._getClampedPixelRatio(u,g);if(this._resizeCanvas(u,g,w),this.painter.resize(u,g,w),this.painter.overLimit()){const C=this.painter.context.gl;this._maxCanvasSize=[C.drawingBufferWidth,C.drawingBufferHeight];const L=this._getClampedPixelRatio(u,g);this._resizeCanvas(u,g,L),this.painter.resize(u,g,L)}this._resizeTransform(D)}_resizeTransform(D=!0){var u;const[g,w]=this._containerDimensions();this.transform.resize(g,w,D),(u=this._requestedCameraState)===null||u===void 0||u.resize(g,w,D)}_getClampedPixelRatio(D,u){const{0:g,1:w}=this._maxCanvasSize,C=this.getPixelRatio(),L=D*C,z=u*C;return Math.min(L>g?g/L:1,z>w?w/z:1)*C}getPixelRatio(){var D;return(D=this._overridePixelRatio)!==null&&D!==void 0?D:devicePixelRatio}setPixelRatio(D){this._overridePixelRatio=D,this.resize()}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()}setMaxBounds(D){return this.transform.setMaxBounds($t.convert(D)),this._update()}setMinZoom(D){if((D=D??-2)>=-2&&D<=this.transform.maxZoom){const u=this._getTransformForUpdate();return u.setMinZoom(D),this._applyUpdatedTransform(u),this._update(),this}throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(D){if((D=D??22)>=this.transform.minZoom){const u=this._getTransformForUpdate();return u.setMaxZoom(D),this._applyUpdatedTransform(u),this._update(),this}throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(D){if((D=D??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(D>=0&&D<=this.transform.maxPitch)return this.transform.setMinPitch(D),this._update(),this.getPitch()<D&&this.setPitch(D),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(D){if((D=D??60)>180)throw new Error("maxPitch must be less than or equal to 180");if(D>=this.transform.minPitch)return this.transform.setMaxPitch(D),this._update(),this.getPitch()>D&&this.setPitch(D),this;throw new Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(D){return this.transform.setRenderWorldCopies(D),this._update()}setTransformConstrain(D){return this.transform.setConstrainOverride(D),this._update()}project(D){return this.transform.locationToScreenPoint(o.V.convert(D),this.style&&this.terrain)}unproject(D){return this.transform.screenPointToLocation(o.P.convert(D),this.terrain)}isMoving(){var D;return this._moving||((D=this.handlers)===null||D===void 0?void 0:D.isMoving())}isZooming(){var D;return this._zooming||((D=this.handlers)===null||D===void 0?void 0:D.isZooming())}isRotating(){var D;return this._rotating||((D=this.handlers)===null||D===void 0?void 0:D.isRotating())}_createDelegatedListener(D,u,g){if(D==="mouseenter"||D==="mouseover"){let w=!1;return{layers:u,listener:g,delegates:{mousemove:L=>{const z=u.filter((re=>this.getLayer(re))),Y=z.length!==0?this.queryRenderedFeatures(L.point,{layers:z}):[];Y.length?w||(w=!0,g.call(this,new Je(D,this,L.originalEvent,{features:Y}))):w=!1},mouseout:()=>{w=!1}}}}if(D==="mouseleave"||D==="mouseout"){let w=!1;return{layers:u,listener:g,delegates:{mousemove:z=>{const Y=u.filter((re=>this.getLayer(re)));(Y.length!==0?this.queryRenderedFeatures(z.point,{layers:Y}):[]).length?w=!0:w&&(w=!1,g.call(this,new Je(D,this,z.originalEvent)))},mouseout:z=>{w&&(w=!1,g.call(this,new Je(D,this,z.originalEvent)))}}}}{const w=C=>{const L=u.filter((Y=>this.getLayer(Y))),z=L.length!==0?this.queryRenderedFeatures(C.point,{layers:L}):[];z.length&&(C.features=z,g.call(this,C),delete C.features)};return{layers:u,listener:g,delegates:{[D]:w}}}}_saveDelegatedListener(D,u){this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[D]=this._delegatedListeners[D]||[],this._delegatedListeners[D].push(u)}_removeDelegatedListener(D,u,g){if(!this._delegatedListeners||!this._delegatedListeners[D])return;const w=this._delegatedListeners[D];for(let C=0;C<w.length;C++){const L=w[C];if(L.listener===g&&L.layers.length===u.length&&L.layers.every((z=>u.includes(z)))){for(const z in L.delegates)this.off(z,L.delegates[z]);return void w.splice(C,1)}}}on(D,u,g){if(g===void 0)return super.on(D,u);const w=typeof u=="string"?[u]:u,C=this._createDelegatedListener(D,w,g);this._saveDelegatedListener(D,C);for(const L in C.delegates)this.on(L,C.delegates[L]);return{unsubscribe:()=>{this._removeDelegatedListener(D,w,g)}}}once(D,u,g){if(g===void 0)return super.once(D,u);const w=typeof u=="string"?[u]:u,C=this._createDelegatedListener(D,w,g);for(const L in C.delegates){const z=C.delegates[L];C.delegates[L]=(...Y)=>{this._removeDelegatedListener(D,w,g),z(...Y)}}this._saveDelegatedListener(D,C);for(const L in C.delegates)this.once(L,C.delegates[L]);return this}off(D,u,g){return g===void 0?super.off(D,u):(this._removeDelegatedListener(D,typeof u=="string"?[u]:u,g),this)}queryRenderedFeatures(D,u){if(!this.style)return[];let g;const w=D instanceof o.P||Array.isArray(D),C=w?D:[[0,0],[this.transform.width,this.transform.height]];if(u=u||(w?{}:D)||{},C instanceof o.P||typeof C[0]=="number")g=[o.P.convert(C)];else{const L=o.P.convert(C[0]),z=o.P.convert(C[1]);g=[L,new o.P(z.x,L.y),z,new o.P(L.x,z.y),L]}return this.style.queryRenderedFeatures(g,u,this.transform)}querySourceFeatures(D,u){return this.style.querySourceFeatures(D,u)}setStyle(D,u){return(u=o.e({},{localIdeographFontFamily:this._localIdeographFontFamily,validate:this._validateStyle},u)).diff!==!1&&u.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&D?(this._diffStyle(D,u),this):(this._localIdeographFontFamily=u.localIdeographFontFamily,this._updateStyle(D,u))}setTransformRequest(D){return this._requestManager.setTransformRequest(D),this}_getUIString(D){const u=this._locale[D];if(u==null)throw new Error(`Missing UI string '${D}'`);return u}_updateStyle(D,u){var g,w;if(u.transformStyle&&this.style&&!this.style._loaded)return void this.style.once("style.load",(()=>this._updateStyle(D,u)));const C=this.style&&u.transformStyle?this.style.serialize():void 0;return this.style&&(this.style.setEventedParent(null),this.style._remove(!D)),D?(this.style=new As(this,u||{}),this.style.setEventedParent(this,{style:this.style}),typeof D=="string"?this.style.loadURL(D,u,C):this.style.loadJSON(D,u,C),this):((w=(g=this.style)===null||g===void 0?void 0:g.projection)===null||w===void 0||w.destroy(),delete this.style,this)}_lazyInitEmptyStyle(){this.style||(this.style=new As(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(D,u){if(typeof D=="string"){const g=this._requestManager.transformRequest(D,"Style");o.j(g,new AbortController).then((w=>{this._updateDiff(w.data,u)})).catch((w=>{w&&this.fire(new o.k(w))}))}else typeof D=="object"&&this._updateDiff(D,u)}_updateDiff(D,u){try{this.style.setState(D,u)&&this._update(!0)}catch(g){o.w(`Unable to perform style diff: ${g.message||g.error||g}.  Rebuilding the style from scratch.`),this._updateStyle(D,u)}}getStyle(){if(this.style)return this.style.serialize()}_getStyleAndImages(){return this.style?{style:this.style.serialize(),images:this.style.imageManager.cloneImages()}:{style:null,images:{}}}isStyleLoaded(){return this.style?this.style.loaded():o.w("There is no style added to the map.")}addSource(D,u){return this._lazyInitEmptyStyle(),this.style.addSource(D,u),this._update(!0)}isSourceLoaded(D){const u=this.style&&this.style.tileManagers[D];if(u!==void 0)return u.loaded();this.fire(new o.k(new Error(`There is no tile manager with ID '${D}'`)))}setTerrain(D){if(this.style._checkLoaded(),this._terrainDataCallback&&this.style.off("data",this._terrainDataCallback),D){const u=this.style.tileManagers[D.source];if(!u)throw new Error(`cannot load terrain, because there exists no source with ID: ${D.source}`);this.terrain===null&&u.reload();for(const g in this.style._layers){const w=this.style._layers[g];w.type==="hillshade"&&w.source===D.source&&o.w("You are using the same source for a hillshade layer and for 3D terrain. Please consider using two separate sources to improve rendering quality."),w.type==="color-relief"&&w.source===D.source&&o.w("You are using the same source for a color-relief layer and for 3D terrain. Please consider using two separate sources to improve rendering quality.")}this.terrain=new ia(this.painter,u,D),this.painter.renderToTexture=new yu(this.painter,this.terrain),this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this._terrainDataCallback=g=>{var w;g.dataType==="style"?this.terrain.tileManager.freeRtt():g.dataType==="source"&&g.tile&&(g.sourceId!==D.source||this._elevationFreeze||(this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this._centerClampedToGround&&this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))),((w=g.source)===null||w===void 0?void 0:w.type)==="image"?this.terrain.tileManager.freeRtt():this.terrain.tileManager.freeRtt(g.tile.tileID))},this.style.on("data",this._terrainDataCallback)}else this.terrain&&this.terrain.tileManager.destruct(),this.terrain=null,this.painter.renderToTexture&&this.painter.renderToTexture.destruct(),this.painter.renderToTexture=null,this.transform.setMinElevationForCurrentTile(0),this._centerClampedToGround&&this.transform.setElevation(0);return this.fire(new o.l("terrain",{terrain:D})),this}getTerrain(){var D,u;return(u=(D=this.terrain)===null||D===void 0?void 0:D.options)!==null&&u!==void 0?u:null}areTilesLoaded(){const D=this.style&&this.style.tileManagers;for(const u of Object.values(D))if(!u.areTilesLoaded())return!1;return!0}removeSource(D){return this.style.removeSource(D),this._update(!0)}getSource(D){return this.style.getSource(D)}setSourceTileLodParams(D,u,g){if(g){const w=this.getSource(g);if(!w)throw new Error(`There is no source with ID "${g}", cannot set LOD parameters`);w.calculateTileZoom=nr(Math.max(1,D),Math.max(1,u))}else for(const w in this.style.tileManagers)this.style.tileManagers[w].getSource().calculateTileZoom=nr(Math.max(1,D),Math.max(1,u));return this._update(!0),this}refreshTiles(D,u){const g=this.style.tileManagers[D];if(!g)throw new Error(`There is no tile manager with ID "${D}", cannot refresh tile`);u===void 0?g.reload(!0):g.refreshTiles(u.map((w=>new o.ac(w.z,w.x,w.y))))}addImage(D,u,g={}){const{pixelRatio:w=1,sdf:C=!1,stretchX:L,stretchY:z,content:Y,textFitWidth:re,textFitHeight:le}=g;if(this._lazyInitEmptyStyle(),!(u instanceof HTMLImageElement||o.b(u))){if(u.width===void 0||u.height===void 0)return this.fire(new o.k(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));{const{width:he,height:Pe,data:Ae}=u,Ue=u;return this.style.addImage(D,{data:new o.R({width:he,height:Pe},new Uint8Array(Ae)),pixelRatio:w,stretchX:L,stretchY:z,content:Y,textFitWidth:re,textFitHeight:le,sdf:C,version:0,userImage:Ue}),Ue.onAdd&&Ue.onAdd(this,D),this}}{const{width:he,height:Pe,data:Ae}=x.getImageData(u);this.style.addImage(D,{data:new o.R({width:he,height:Pe},Ae),pixelRatio:w,stretchX:L,stretchY:z,content:Y,textFitWidth:re,textFitHeight:le,sdf:C,version:0})}}updateImage(D,u){const g=this.style.getImage(D);if(!g)return this.fire(new o.k(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const w=u instanceof HTMLImageElement||o.b(u)?x.getImageData(u):u,{width:C,height:L,data:z}=w;if(C===void 0||L===void 0)return this.fire(new o.k(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(C!==g.data.width||L!==g.data.height)return this.fire(new o.k(new Error("The width and height of the updated image must be that same as the previous version of the image")));const Y=!(u instanceof HTMLImageElement||o.b(u));return g.data.replace(z,Y),this.style.updateImage(D,g),this}getImage(D){return this.style.getImage(D)}hasImage(D){return D?!!this.style.getImage(D):(this.fire(new o.k(new Error("Missing required image id"))),!1)}removeImage(D){this.style.removeImage(D)}loadImage(D){return H.getImage(this._requestManager.transformRequest(D,"Image"),new AbortController)}listImages(){return this.style.listImages()}addLayer(D,u){return this._lazyInitEmptyStyle(),this.style.addLayer(D,u),this._update(!0)}moveLayer(D,u){return this.style.moveLayer(D,u),this._update(!0)}removeLayer(D){return this.style.removeLayer(D),this._update(!0)}getLayer(D){return this.style.getLayer(D)}getLayersOrder(){return this.style.getLayersOrder()}setLayerZoomRange(D,u,g){return this.style.setLayerZoomRange(D,u,g),this._update(!0)}setFilter(D,u,g={}){return this.style.setFilter(D,u,g),this._update(!0)}getFilter(D){return this.style.getFilter(D)}setPaintProperty(D,u,g,w={}){return this.style.setPaintProperty(D,u,g,w),this._update(!0)}getPaintProperty(D,u){return this.style.getPaintProperty(D,u)}setLayoutProperty(D,u,g,w={}){return this.style.setLayoutProperty(D,u,g,w),this._update(!0)}getLayoutProperty(D,u){return this.style.getLayoutProperty(D,u)}setGlyphs(D,u={}){return this._lazyInitEmptyStyle(),this.style.setGlyphs(D,u),this._update(!0)}getGlyphs(){return this.style.getGlyphsUrl()}addSprite(D,u,g={}){return this._lazyInitEmptyStyle(),this.style.addSprite(D,u,g,(w=>{w||this._update(!0)})),this}removeSprite(D){return this._lazyInitEmptyStyle(),this.style.removeSprite(D),this._update(!0)}getSprite(){return this.style.getSprite()}setSprite(D,u={}){return this._lazyInitEmptyStyle(),this.style.setSprite(D,u,(g=>{g||this._update(!0)})),this}setLight(D,u={}){return this._lazyInitEmptyStyle(),this.style.setLight(D,u),this._update(!0)}getLight(){return this.style.getLight()}setSky(D,u={}){return this._lazyInitEmptyStyle(),this.style.setSky(D,u),this._update(!0)}getSky(){return this.style.getSky()}setFeatureState(D,u){return this.style.setFeatureState(D,u),this._update()}removeFeatureState(D,u){return this.style.removeFeatureState(D,u),this._update()}getFeatureState(D){return this.style.getFeatureState(D)}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}_containerDimensions(){let D=0,u=0;return this._container&&(D=this._container.clientWidth||400,u=this._container.clientHeight||300),[D,u]}_setupContainer(){const D=this._container;D.classList.add("maplibregl-map");const u=this._canvasContainer=A.create("div","maplibregl-canvas-container",D);this._interactive&&u.classList.add("maplibregl-interactive"),this._canvas=A.create("canvas","maplibregl-canvas",u),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex",this._interactive?"0":"-1"),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region");const g=this._containerDimensions(),w=this._getClampedPixelRatio(g[0],g[1]);this._resizeCanvas(g[0],g[1],w);const C=this._controlContainer=A.create("div","maplibregl-control-container",D),L=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach((z=>{L[z]=A.create("div",`maplibregl-ctrl-${z} `,C)})),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(D,u,g){this._canvas.width=Math.floor(g*D),this._canvas.height=Math.floor(g*u),this._canvas.style.width=`${D}px`,this._canvas.style.height=`${u}px`}_setupPainter(){const D=Object.assign(Object.assign({},this._canvasContextAttributes),{alpha:!0,depth:!0,stencil:!0,premultipliedAlpha:!0});let u=null;this._canvas.addEventListener("webglcontextcreationerror",(w=>{u={requestedAttributes:D},w&&(u.statusMessage=w.statusMessage,u.type=w.type)}),{once:!0});let g=null;if(g=this._canvasContextAttributes.contextType?this._canvas.getContext(this._canvasContextAttributes.contextType,D):this._canvas.getContext("webgl2",D)||this._canvas.getContext("webgl",D),!g){const w="Failed to initialize WebGL";throw u?(u.message=w,new Error(JSON.stringify(u))):new Error(w)}this.painter=new Uy(g,this.transform),M.testSupport(g)}migrateProjection(D,u){super.migrateProjection(D,u),this.painter.transform=D,this.fire(new o.l("projectiontransition",{newProjection:this.style.projection.name}))}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(D){return this.style&&this.style._loaded?(this._styleDirty=this._styleDirty||D,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(D){return this._update(),this._renderTaskQueue.add(D)}_cancelRenderFrame(D){this._renderTaskQueue.remove(D)}_render(D){var u,g,w,C,L;const z=this._idleTriggered?this._fadeDuration:0,Y=((u=this.style.projection)===null||u===void 0?void 0:u.transitionState)>0;if(this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(D),this._removed)return;let re=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;const Pe=this.transform.zoom,Ae=T();this.style.zoomHistory.update(Pe,Ae);const Ue=new o.H(Pe,{now:Ae,fadeDuration:z,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),Ze=Ue.crossFadingFactor();Ze===1&&Ze===this._crossFadingFactor||(re=!0,this._crossFadingFactor=Ze),this.style.update(Ue)}const le=((g=this.style.projection)===null||g===void 0?void 0:g.transitionState)>0!==Y;(w=this.style.projection)===null||w===void 0||w.setErrorQueryLatitudeDegrees(this.transform.center.lat),this.transform.setTransitionState((C=this.style.projection)===null||C===void 0?void 0:C.transitionState,(L=this.style.projection)===null||L===void 0?void 0:L.latitudeErrorCorrectionRadians),this.style&&(this._sourcesDirty||le)&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this.terrain?(this.terrain.tileManager.update(this.transform,this.terrain),this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),!this._elevationFreeze&&this._centerClampedToGround&&this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))):(this.transform.setMinElevationForCurrentTile(0),this._centerClampedToGround&&this.transform.setElevation(0)),this._placementDirty=this.style&&this.style._updatePlacement(this.transform,this.showCollisionBoxes,z,this._crossSourceCollisions,le),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:z,showPadding:this.showPadding}),this.fire(new o.l("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,o.cG.mark(o.cH.load),this.fire(new o.l("load"))),this.style&&(this.style.hasTransitions()||re)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles();const he=this._sourcesDirty||this._styleDirty||this._placementDirty;return he||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new o.l("idle")),!this._loaded||this._fullyLoaded||he||(this._fullyLoaded=!0,o.cG.mark(o.cH.fullLoad)),this}redraw(){return this.style&&(this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._render(0)),this}remove(){var D;this._hash&&this._hash.remove();for(const g of this._controls)g.onRemove(this);this._controls=[],this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),typeof window<"u"&&removeEventListener("online",this._onWindowOnline,!1),H.removeThrottleControl(this._imageQueueHandle),(D=this._resizeObserver)===null||D===void 0||D.disconnect();const u=this.painter.context.gl.getExtension("WEBGL_lose_context");u?.loseContext&&u.loseContext(),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),A.remove(this._canvasContainer),A.remove(this._controlContainer),this._container.removeEventListener("scroll",this._onMapScroll,!1),this._container.classList.remove("maplibregl-map"),o.cG.clearMetrics(),this._removed=!0,this.fire(new o.l("remove"))}triggerRepaint(){this.style&&!this._frameRequest&&(this._frameRequest=new AbortController,x.frame(this._frameRequest,(D=>{o.cG.frame(D),this._frameRequest=null;try{this._render(D)}catch(u){if(!o.Z(u)&&!(function(g){return g.message===Lp})(u))throw u}}),(()=>{})))}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(D){this._showTileBoundaries!==D&&(this._showTileBoundaries=D,this._update())}get showPadding(){return!!this._showPadding}set showPadding(D){this._showPadding!==D&&(this._showPadding=D,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(D){this._showCollisionBoxes!==D&&(this._showCollisionBoxes=D,D?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(D){this._showOverdrawInspector!==D&&(this._showOverdrawInspector=D,this._update())}get repaint(){return!!this._repaint}set repaint(D){this._repaint!==D&&(this._repaint=D,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(D){this._vertices=D,this._update()}get version(){return Uh}getCameraTargetElevation(){return this.transform.elevation}getProjection(){return this.style.getProjection()}setProjection(D){return this._lazyInitEmptyStyle(),this.style.setProjection(D),this._update(!0)}},s.MapMouseEvent=Je,s.MapTouchEvent=nt,s.MapWheelEvent=lt,s.Marker=Vd,s.NavigationControl=class{constructor(D){this._updateZoomButtons=()=>{const u=this._map.getZoom(),g=u===this._map.getMaxZoom(),w=u===this._map.getMinZoom();this._zoomInButton.disabled=g,this._zoomOutButton.disabled=w,this._zoomInButton.setAttribute("aria-disabled",g.toString()),this._zoomOutButton.setAttribute("aria-disabled",w.toString())},this._rotateCompassArrow=()=>{this._compassIcon.style.transform=this.options.visualizePitch&&this.options.visualizeRoll?`scale(${1/Math.pow(Math.cos(this._map.transform.pitchInRadians),.5)}) rotateZ(${-this._map.transform.roll}deg) rotateX(${this._map.transform.pitch}deg) rotateZ(${-this._map.transform.bearing}deg)`:this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(this._map.transform.pitchInRadians),.5)}) rotateX(${this._map.transform.pitch}deg) rotateZ(${-this._map.transform.bearing}deg)`:this.options.visualizeRoll?`rotate(${-this._map.transform.bearing-this._map.transform.roll}deg)`:`rotate(${-this._map.transform.bearing}deg)`},this._setButtonTitle=(u,g)=>{const w=this._map._getUIString(`NavigationControl.${g}`);u.title=w,u.setAttribute("aria-label",w)},this.options=o.e({},$h,D),this._container=A.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._container.addEventListener("contextmenu",(u=>u.preventDefault())),this.options.showZoom&&(this._zoomInButton=this._createButton("maplibregl-ctrl-zoom-in",(u=>this._map.zoomIn({},{originalEvent:u}))),A.create("span","maplibregl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("maplibregl-ctrl-zoom-out",(u=>this._map.zoomOut({},{originalEvent:u}))),A.create("span","maplibregl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(this._compass=this._createButton("maplibregl-ctrl-compass",(u=>{this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:u}):this._map.resetNorth({},{originalEvent:u})})),this._compassIcon=A.create("span","maplibregl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}onAdd(D){return this._map=D,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this.options.visualizeRoll&&this._map.on("roll",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new Gc(this._map,this._compass,this.options.visualizePitch)),this._container}onRemove(){A.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this.options.visualizeRoll&&this._map.off("roll",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map}_createButton(D,u){const g=A.create("button",D,this._container);return g.type="button",g.addEventListener("click",u),g}},s.Popup=class extends o.E{constructor(D){super(),this._updateOpacity=()=>{this.options.locationOccludedOpacity!==void 0&&(this._container.style.opacity=this._map.transform.isLocationOccluded(this.getLngLat())?`${this.options.locationOccludedOpacity}`:"")},this.remove=()=>(this._content&&A.remove(this._content),this._container&&(A.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),this._map._canvasContainer.classList.remove("maplibregl-track-pointer"),delete this._map,this.fire(new o.l("close"))),this),this._onMouseUp=u=>{this._update(u.point)},this._onMouseMove=u=>{this._update(u.point)},this._onDrag=u=>{this._update(u.point)},this._update=u=>{if(!this._map||!this._lngLat&&!this._trackPointer||!this._content)return;if(!this._container){if(this._container=A.create("div","maplibregl-popup",this._map.getContainer()),this._tip=A.create("div","maplibregl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className)for(const z of this.options.className.split(" "))this._container.classList.add(z);this._closeButton&&this._closeButton.setAttribute("aria-label",this._map._getUIString("Popup.Close")),this._trackPointer&&this._container.classList.add("maplibregl-popup-track-pointer")}if(this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._lngLat=$p(this._lngLat,this._flatPos,this._map.transform,this._trackPointer),this._trackPointer&&!u)return;const g=this._flatPos=this._pos=this._trackPointer&&u?u:this._map.project(this._lngLat);this._map.terrain&&(this._flatPos=this._trackPointer&&u?u:this._map.transform.locationToScreenPoint(this._lngLat));let w=this.options.anchor;const C=Cf(this.options.offset);if(!w){const z=this._container.offsetWidth,Y=this._container.offsetHeight,re=(function(he){var Pe,Ae,Ue,Ze;return he?{top:(Pe=he.top)!==null&&Pe!==void 0?Pe:0,right:(Ae=he.right)!==null&&Ae!==void 0?Ae:0,bottom:(Ue=he.bottom)!==null&&Ue!==void 0?Ue:0,left:(Ze=he.left)!==null&&Ze!==void 0?Ze:0}:{top:0,right:0,bottom:0,left:0}})(this.options.padding);let le;le=g.y+C.bottom.y<Y+re.top?["top"]:g.y>this._map.transform.height-Y-re.bottom?["bottom"]:[],g.x<z/2+re.left?le.push("left"):g.x>this._map.transform.width-z/2-re.right&&le.push("right"),w=le.length===0?"bottom":le.join("-")}let L=g.add(C[w]);this.options.subpixelPositioning||(L=L.round()),A.setTransform(this._container,`${sh[w]} translate(${L.x}px,${L.y}px)`),sc(this._container,w,"popup"),this._updateOpacity()},this._onClose=()=>{this.remove()},this.options=o.e(Object.create(Wh),D)}addTo(D){return this._map&&this.remove(),this._map=D,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")):this._map.on("move",this._update),this.fire(new o.l("open")),this}isOpen(){return!!this._map}getLngLat(){return this._lngLat}setLngLat(D){return this._lngLat=o.V.convert(D),this._pos=null,this._flatPos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.remove("maplibregl-track-pointer")),this}trackPointer(){return this._trackPointer=!0,this._pos=null,this._flatPos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")),this}getElement(){return this._container}setText(D){return this.setDOMContent(document.createTextNode(D))}setHTML(D){const u=document.createDocumentFragment(),g=document.createElement("body");let w;for(g.innerHTML=D;w=g.firstChild,w;)u.appendChild(w);return this.setDOMContent(u)}getMaxWidth(){var D;return(D=this._container)===null||D===void 0?void 0:D.style.maxWidth}setMaxWidth(D){return this.options.maxWidth=D,this._update(),this}setDOMContent(D){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=A.create("div","maplibregl-popup-content",this._container);return this._content.appendChild(D),this._createCloseButton(),this._update(),this._focusFirstElement(),this}addClassName(D){return this._container&&this._container.classList.add(D),this}removeClassName(D){return this._container&&this._container.classList.remove(D),this}setOffset(D){return this.options.offset=D,this._update(),this}toggleClassName(D){if(this._container)return this._container.classList.toggle(D)}setSubpixelPositioning(D){this.options.subpixelPositioning=D}setPadding(D){this.options.padding=D,this._update()}_createCloseButton(){this.options.closeButton&&(this._closeButton=A.create("button","maplibregl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const D=this._container.querySelector(Xh);D&&D.focus()}},s.RasterDEMTileSource=mr,s.RasterTileSource=gr,s.ScaleControl=class{constructor(D){this._onMove=()=>{Gh(this._map,this._container,this.options)},this.setUnit=u=>{this.options.unit=u,Gh(this._map,this._container,this.options)},this.options=Object.assign(Object.assign({},Hh),D)}getDefaultPosition(){return"bottom-left"}onAdd(D){return this._map=D,this._container=A.create("div","maplibregl-ctrl maplibregl-ctrl-scale",D.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){A.remove(this._container),this._map.off("move",this._onMove),this._map=void 0}},s.ScrollZoomHandler=ks,s.Style=As,s.TerrainControl=class{constructor(D){this._toggleTerrain=()=>{this._map.getTerrain()?this._map.setTerrain(null):this._map.setTerrain(this.options),this._updateTerrainIcon()},this._updateTerrainIcon=()=>{this._terrainButton.classList.remove("maplibregl-ctrl-terrain"),this._terrainButton.classList.remove("maplibregl-ctrl-terrain-enabled"),this._map.terrain?(this._terrainButton.classList.add("maplibregl-ctrl-terrain-enabled"),this._terrainButton.title=this._map._getUIString("TerrainControl.Disable")):(this._terrainButton.classList.add("maplibregl-ctrl-terrain"),this._terrainButton.title=this._map._getUIString("TerrainControl.Enable"))},this.options=D}onAdd(D){return this._map=D,this._container=A.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._terrainButton=A.create("button","maplibregl-ctrl-terrain",this._container),A.create("span","maplibregl-ctrl-icon",this._terrainButton).setAttribute("aria-hidden","true"),this._terrainButton.type="button",this._terrainButton.addEventListener("click",this._toggleTerrain),this._updateTerrainIcon(),this._map.on("terrain",this._updateTerrainIcon),this._container}onRemove(){A.remove(this._container),this._map.off("terrain",this._updateTerrainIcon),this._map=void 0}},s.TwoFingersTouchPitchHandler=aa,s.TwoFingersTouchRotateHandler=To,s.TwoFingersTouchZoomHandler=Yn,s.TwoFingersTouchZoomRotateHandler=Wo,s.VectorTileSource=_t,s.VideoSource=ot,s.addSourceType=(D,u)=>o._(void 0,void 0,void 0,(function*(){if(je(D))throw new Error(`A source type called "${D}" already exists.`);((g,w)=>{xe[g]=w})(D,u)})),s.clearPrewarmedResources=function(){const D=Xe;D&&(D.isPreloaded()&&D.numActive()===1?(D.release(we),Xe=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},s.createTileMesh=lr,s.getMaxParallelImageRequests=function(){return o.c.MAX_PARALLEL_IMAGE_REQUESTS},s.getRTLTextPluginStatus=function(){return Et().getRTLTextPluginStatus()},s.getVersion=function(){return qp},s.getWorkerCount=function(){return De.workerCount},s.getWorkerUrl=function(){return o.c.WORKER_URL},s.importScriptInWorkers=function(D){return it().broadcast("IS",D)},s.isTimeFrozen=function(){return E.isFrozen()},s.now=T,s.prewarm=function(){st().acquire(we)},s.restoreNow=function(){E.restoreNow()},s.setMaxParallelImageRequests=function(D){o.c.MAX_PARALLEL_IMAGE_REQUESTS=D},s.setNow=function(D){E.setNow(D)},s.setRTLTextPlugin=function(D,u){return Et().setRTLTextPlugin(D,u)},s.setWorkerCount=function(D){De.workerCount=D},s.setWorkerUrl=function(D){o.c.WORKER_URL=D}}));var a=r;return a}))})(aS)),aS.exports}var AT=voe();const vk=Id(AT);class _oe{registeredElements;baseLayers;firstSymbolLayer;eventHandlers;wrapper;initRegisteredElements;addNativeMaplibreFunctionsAndProps;map;style;styleJson;addSource;addControl;on;cleanup;constructor(e){const r=this;this.registeredElements={},this.baseLayers=[],this.firstSymbolLayer=void 0,this.eventHandlers={layerchange:[],viewportchange:[],addsource:[],addlayer:[]},this.wrapper={on:(o,c,f,d)=>{if(!r.eventHandlers[o])return;typeof f=="string"&&(d=f,f={}),r.eventHandlers[o].push({handler:c,options:f});const m=[o,c];d&&typeof d=="string"&&(r.initRegisteredElements(d),r.registeredElements[d].wrapperEvents.push(m))},off:(o,c)=>{r.eventHandlers[o]&&(r.eventHandlers[o]=r.eventHandlers[o].filter(f=>Object.is(f.handler,c)?!1:f))},fire:(o,c)=>{if(!r.eventHandlers[o])return;const f=c||window,d=new Event(o);r.eventHandlers[o].forEach(function(m){m.handler.call(f,d,r,c)})},layerState:[],layerStateString:"",oldLayerStateStrings:{},buildLayerObject:o=>{if(o)return{id:o.id,type:o.type,visible:o.visibility!=="none",baseLayer:r.baseLayers.indexOf(o.id)!==-1}},buildLayerObjects:()=>r.map.style._order.map(o=>r.wrapper.buildLayerObject(r.map.style._layers[o])).filter(o=>typeof o<"u"),refreshLayerState:()=>{r.wrapper.layerState=r.wrapper.buildLayerObjects(),JSON.stringify(r.wrapper.layerState)!==r.wrapper.layerStateString&&(r.wrapper.fire("layerchange"),r.wrapper.layerStateString=JSON.stringify(r.wrapper.layerState))},viewportState:{center:{lng:0,lat:0},zoom:0,bearing:0,pitch:0},viewportStateString:"{}",oldViewportStateString:"{}",getViewport:()=>typeof r.map.getCenter=="function"?{center:(({lng:o,lat:c})=>({lng:o,lat:c}))(r.map.getCenter()),zoom:r.map.getZoom(),bearing:r.map.getBearing(),pitch:r.map.getPitch()}:{center:{lng:0,lat:0},zoom:0,bearing:0,pitch:0},refreshViewport:()=>{r.wrapper.viewportState=r.wrapper.getViewport()}},this.cancelled=!1,this.initRegisteredElements=(o,c)=>{(typeof r.registeredElements[o]>"u"||typeof c<"u"&&c)&&(r.registeredElements[o]={layers:[],sources:[],images:[],events:[],controls:[],wrapperEvents:[]})},this.addLayer=(o,c,f)=>r.map.style?(f&&typeof f=="string"&&typeof o.id<"u"&&(r.initRegisteredElements(f),r.registeredElements[f].layers.push(o.id),o?.source&&typeof o?.source!="string"&&r.registeredElements[f].sources.push(o.id)),r.map.addLayer(o,c),r.wrapper.fire("addlayer",{layer_id:o.id}),this):this,this.addSource=(o,c,f)=>r.map.style?(f&&typeof f=="string"&&typeof o<"u"&&(r.initRegisteredElements(f),r.registeredElements[f].sources.push(o)),r.map.addSource(o,c),r.wrapper.fire("addsource",{source_id:o}),this):this,this.addImage=(o,c,f,d)=>r.map.style?typeof f=="string"&&typeof d>"u"?r.addImage(o,c,void 0,f):(d&&typeof d=="string"&&typeof o<"u"&&(r.initRegisteredElements(d),r.registeredElements[d].images.push(o)),r.map.addImage(o,c,f),this):this,this.on=(o,c,f,d)=>{if(typeof f=="string"&&typeof c=="function")return r.on.call(r,o,void 0,c,f);let m=[o,c,f];return c||(m=[o,f]),d&&typeof d=="string"&&(r.initRegisteredElements(d),r.registeredElements[d].events.push(m)),r.map.on(...m),this},this.addControl=(o,c,f)=>(f&&typeof f=="string"&&(r.initRegisteredElements(f),r.registeredElements[f].controls.push(o)),r.map.addControl(o,c),this),this.cleanup=o=>{r.map.style&&typeof r.registeredElements[o]<"u"&&(r.registeredElements[o].layers.forEach(c=>{r.map.style.getLayer(c)&&r.map.style.removeLayer(c)}),r.registeredElements[o].sources.forEach(c=>{r.map.style.getSource(c)&&r.map.style.removeSource(c)}),r.registeredElements[o].images.forEach(c=>{r.map.hasImage(c)&&r.map.style.removeImage(c)}),r.registeredElements[o].events.forEach(c=>{r.map.off(...c)}),r.registeredElements[o].controls.forEach(c=>{r.map.removeControl(c)}),r.registeredElements[o].wrapperEvents.forEach(c=>{r.wrapper.off(...c)}),r.initRegisteredElements(o,!0))},["moveLayer","removeLayer","removeSource","setPaintProperty","setLayoutProperty"].forEach(o=>{this[o]=(...c)=>(r.map&&r.map.style&&typeof r.map.style[o]=="function"&&r.map.style[o](...c),r.map._update?r.map._update(!0):void 0)}),["getLayer","getSource","listImages","getPaintProperty","getLayoutProperty","removeImage"].forEach(o=>{this[o]=(...c)=>r.map&&r.map.style?r.map.style[o](...c):!1}),this.addNativeMaplibreFunctionsAndProps=()=>{Object.getOwnPropertyNames(Object.getPrototypeOf(this.map)).forEach(o=>{typeof this[o]>"u"&&(this[o]=(...c)=>r.map[o](...c))}),Object.keys(this.map).forEach(o=>{typeof this[o]>"u"&&(this[o]=r.map[o])})},["getZoom","setZoom","getCenter","setCenter","getBearing","setBearing","getPitch","setPitch","jumpTo","flyTo","panTo","panBy","panBy","zoomTo","zoomIn","zoomOut","getPadding","setPadding","rotateTo","resetNorth","resetNorthPitch","snapToNorth","cameraForBounds","fitBounds","fitScreenCoordinates","getFreeCameraOptions","setFreeCameraOptions","easeTo","stop"].forEach(o=>{this[o]=(...c)=>{if(typeof r.map[o]=="function")return r.map[o].call(r.map,...c)}}),(async()=>{typeof e.mapOptions.style=="string"&&e.mapOptions.style.indexOf("mapbox://")===-1&&await fetch(e.mapOptions.style).then(o=>{if(o.ok)return o.json();throw new Error("error loading map style.json")}).then(o=>{o.layers.forEach(c=>{r.baseLayers.push(c.id),!r.firstSymbolLayer&&c.type==="symbol"&&(r.firstSymbolLayer=c.id)}),r.styleJson=o,e.mapOptions.style=o}).catch(o=>{console.log(o)}),r.map=new AT.Map(e.mapOptions),r.addNativeMaplibreFunctionsAndProps(),r.wrapper.refreshViewport(),r.wrapper.fire("viewportchange"),r.map.on("load",()=>{r.addNativeMaplibreFunctionsAndProps()}),r.map.on("move",()=>{r.wrapper.viewportState=r.wrapper.getViewport(),r.wrapper.fire("viewportchange")}),r.map.on("idle",()=>{r.wrapper.refreshLayerState()}),r.map.on("data",()=>{r.wrapper.refreshLayerState()}),typeof e.onReady=="function"&&e.onReady(r.map,r)})()}}function _p(t,...e){const r=new URL(`https://mui.com/production-error/?code=${t}`);return e.forEach(n=>r.searchParams.append("args[]",n)),`Minified MUI error #${t}; visit ${r} for the full message.`}const Eh="$$material";function US(){return US=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},US.apply(null,arguments)}function boe(t){if(t.sheet)return t.sheet;for(var e=0;e<document.styleSheets.length;e++)if(document.styleSheets[e].ownerNode===t)return document.styleSheets[e]}function xoe(t){var e=document.createElement("style");return e.setAttribute("data-emotion",t.key),t.nonce!==void 0&&e.setAttribute("nonce",t.nonce),e.appendChild(document.createTextNode("")),e.setAttribute("data-s",""),e}var woe=(function(){function t(r){var n=this;this._insertTag=function(i){var a;n.tags.length===0?n.insertionPoint?a=n.insertionPoint.nextSibling:n.prepend?a=n.container.firstChild:a=n.before:a=n.tags[n.tags.length-1].nextSibling,n.container.insertBefore(i,a),n.tags.push(i)},this.isSpeedy=r.speedy===void 0?!0:r.speedy,this.tags=[],this.ctr=0,this.nonce=r.nonce,this.key=r.key,this.container=r.container,this.prepend=r.prepend,this.insertionPoint=r.insertionPoint,this.before=null}var e=t.prototype;return e.hydrate=function(n){n.forEach(this._insertTag)},e.insert=function(n){this.ctr%(this.isSpeedy?65e3:1)===0&&this._insertTag(xoe(this));var i=this.tags[this.tags.length-1];if(this.isSpeedy){var a=boe(i);try{a.insertRule(n,a.cssRules.length)}catch{}}else i.appendChild(document.createTextNode(n));this.ctr++},e.flush=function(){this.tags.forEach(function(n){var i;return(i=n.parentNode)==null?void 0:i.removeChild(n)}),this.tags=[],this.ctr=0},t})(),Zu="-ms-",VS="-moz-",Ha="-webkit-",WW="comm",ID="rule",PD="decl",Soe="@import",XW="@keyframes",Eoe="@layer",Toe=Math.abs,IT=String.fromCharCode,Coe=Object.assign;function Aoe(t,e){return wu(t,0)^45?(((e<<2^wu(t,0))<<2^wu(t,1))<<2^wu(t,2))<<2^wu(t,3):0}function YW(t){return t.trim()}function Ioe(t,e){return(t=e.exec(t))?t[0]:t}function Ga(t,e,r){return t.replace(e,r)}function _k(t,e){return t.indexOf(e)}function wu(t,e){return t.charCodeAt(e)|0}function Mb(t,e,r){return t.slice(e,r)}function ld(t){return t.length}function kD(t){return t.length}function B2(t,e){return e.push(t),t}function Poe(t,e){return t.map(e).join("")}var PT=1,L0=1,ZW=0,Lc=0,Sl=0,c_="";function kT(t,e,r,n,i,a,s){return{value:t,root:e,parent:r,type:n,props:i,children:a,line:PT,column:L0,length:s,return:""}}function J_(t,e){return Coe(kT("",null,null,"",null,null,0),t,{length:-t.length},e)}function koe(){return Sl}function Roe(){return Sl=Lc>0?wu(c_,--Lc):0,L0--,Sl===10&&(L0=1,PT--),Sl}function ff(){return Sl=Lc<ZW?wu(c_,Lc++):0,L0++,Sl===10&&(L0=1,PT++),Sl}function yd(){return wu(c_,Lc)}function oS(){return Lc}function Sx(t,e){return Mb(c_,t,e)}function Db(t){switch(t){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function KW(t){return PT=L0=1,ZW=ld(c_=t),Lc=0,[]}function JW(t){return c_="",t}function sS(t){return YW(Sx(Lc-1,bk(t===91?t+2:t===40?t+1:t)))}function Moe(t){for(;(Sl=yd())&&Sl<33;)ff();return Db(t)>2||Db(Sl)>3?"":" "}function Doe(t,e){for(;--e&&ff()&&!(Sl<48||Sl>102||Sl>57&&Sl<65||Sl>70&&Sl<97););return Sx(t,oS()+(e<6&&yd()==32&&ff()==32))}function bk(t){for(;ff();)switch(Sl){case t:return Lc;case 34:case 39:t!==34&&t!==39&&bk(Sl);break;case 40:t===41&&bk(t);break;case 92:ff();break}return Lc}function Ooe(t,e){for(;ff()&&t+Sl!==57;)if(t+Sl===84&&yd()===47)break;return"/*"+Sx(e,Lc-1)+"*"+IT(t===47?t:ff())}function Noe(t){for(;!Db(yd());)ff();return Sx(t,Lc)}function Loe(t){return JW(lS("",null,null,null,[""],t=KW(t),0,[0],t))}function lS(t,e,r,n,i,a,s,o,c){for(var f=0,d=0,m=s,b=0,x=0,E=0,T=1,A=1,M=1,F=0,N="",O=i,U=a,j=n,H=N;A;)switch(E=F,F=ff()){case 40:if(E!=108&&wu(H,m-1)==58){_k(H+=Ga(sS(F),"&","&\f"),"&\f")!=-1&&(M=-1);break}case 34:case 39:case 91:H+=sS(F);break;case 9:case 10:case 13:case 32:H+=Moe(E);break;case 92:H+=Doe(oS()-1,7);continue;case 47:switch(yd()){case 42:case 47:B2(Foe(Ooe(ff(),oS()),e,r),c);break;default:H+="/"}break;case 123*T:o[f++]=ld(H)*M;case 125*T:case 59:case 0:switch(F){case 0:case 125:A=0;case 59+d:M==-1&&(H=Ga(H,/\f/g,"")),x>0&&ld(H)-m&&B2(x>32?q8(H+";",n,r,m-1):q8(Ga(H," ","")+";",n,r,m-2),c);break;case 59:H+=";";default:if(B2(j=$8(H,e,r,f,d,i,o,N,O=[],U=[],m),a),F===123)if(d===0)lS(H,e,j,j,O,a,m,o,U);else switch(b===99&&wu(H,3)===110?100:b){case 100:case 108:case 109:case 115:lS(t,j,j,n&&B2($8(t,j,j,0,0,i,o,N,i,O=[],m),U),i,U,m,o,n?O:U);break;default:lS(H,j,j,j,[""],U,0,o,U)}}f=d=x=0,T=M=1,N=H="",m=s;break;case 58:m=1+ld(H),x=E;default:if(T<1){if(F==123)--T;else if(F==125&&T++==0&&Roe()==125)continue}switch(H+=IT(F),F*T){case 38:M=d>0?1:(H+="\f",-1);break;case 44:o[f++]=(ld(H)-1)*M,M=1;break;case 64:yd()===45&&(H+=sS(ff())),b=yd(),d=m=ld(N=H+=Noe(oS())),F++;break;case 45:E===45&&ld(H)==2&&(T=0)}}return a}function $8(t,e,r,n,i,a,s,o,c,f,d){for(var m=i-1,b=i===0?a:[""],x=kD(b),E=0,T=0,A=0;E<n;++E)for(var M=0,F=Mb(t,m+1,m=Toe(T=s[E])),N=t;M<x;++M)(N=YW(T>0?b[M]+" "+F:Ga(F,/&\f/g,b[M])))&&(c[A++]=N);return kT(t,e,r,i===0?ID:o,c,f,d)}function Foe(t,e,r){return kT(t,e,r,WW,IT(koe()),Mb(t,2,-2),0)}function q8(t,e,r,n){return kT(t,e,r,PD,Mb(t,0,n),Mb(t,n+1,-1),n)}function w0(t,e){for(var r="",n=kD(t),i=0;i<n;i++)r+=e(t[i],i,t,e)||"";return r}function Boe(t,e,r,n){switch(t.type){case Eoe:if(t.children.length)break;case Soe:case PD:return t.return=t.return||t.value;case WW:return"";case XW:return t.return=t.value+"{"+w0(t.children,n)+"}";case ID:t.value=t.props.join(",")}return ld(r=w0(t.children,n))?t.return=t.value+"{"+r+"}":""}function zoe(t){var e=kD(t);return function(r,n,i,a){for(var s="",o=0;o<e;o++)s+=t[o](r,n,i,a)||"";return s}}function joe(t){return function(e){e.root||(e=e.return)&&t(e)}}function QW(t){var e=Object.create(null);return function(r){return e[r]===void 0&&(e[r]=t(r)),e[r]}}var Uoe=function(e,r,n){for(var i=0,a=0;i=a,a=yd(),i===38&&a===12&&(r[n]=1),!Db(a);)ff();return Sx(e,Lc)},Voe=function(e,r){var n=-1,i=44;do switch(Db(i)){case 0:i===38&&yd()===12&&(r[n]=1),e[n]+=Uoe(Lc-1,r,n);break;case 2:e[n]+=sS(i);break;case 4:if(i===44){e[++n]=yd()===58?"&\f":"",r[n]=e[n].length;break}default:e[n]+=IT(i)}while(i=ff());return e},$oe=function(e,r){return JW(Voe(KW(e),r))},H8=new WeakMap,qoe=function(e){if(!(e.type!=="rule"||!e.parent||e.length<1)){for(var r=e.value,n=e.parent,i=e.column===n.column&&e.line===n.line;n.type!=="rule";)if(n=n.parent,!n)return;if(!(e.props.length===1&&r.charCodeAt(0)!==58&&!H8.get(n))&&!i){H8.set(e,!0);for(var a=[],s=$oe(r,a),o=n.props,c=0,f=0;c<s.length;c++)for(var d=0;d<o.length;d++,f++)e.props[f]=a[c]?s[c].replace(/&\f/g,o[d]):o[d]+" "+s[c]}}},Hoe=function(e){if(e.type==="decl"){var r=e.value;r.charCodeAt(0)===108&&r.charCodeAt(2)===98&&(e.return="",e.value="")}};function eX(t,e){switch(Aoe(t,e)){case 5103:return Ha+"print-"+t+t;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return Ha+t+t;case 5349:case 4246:case 4810:case 6968:case 2756:return Ha+t+VS+t+Zu+t+t;case 6828:case 4268:return Ha+t+Zu+t+t;case 6165:return Ha+t+Zu+"flex-"+t+t;case 5187:return Ha+t+Ga(t,/(\w+).+(:[^]+)/,Ha+"box-$1$2"+Zu+"flex-$1$2")+t;case 5443:return Ha+t+Zu+"flex-item-"+Ga(t,/flex-|-self/,"")+t;case 4675:return Ha+t+Zu+"flex-line-pack"+Ga(t,/align-content|flex-|-self/,"")+t;case 5548:return Ha+t+Zu+Ga(t,"shrink","negative")+t;case 5292:return Ha+t+Zu+Ga(t,"basis","preferred-size")+t;case 6060:return Ha+"box-"+Ga(t,"-grow","")+Ha+t+Zu+Ga(t,"grow","positive")+t;case 4554:return Ha+Ga(t,/([^-])(transform)/g,"$1"+Ha+"$2")+t;case 6187:return Ga(Ga(Ga(t,/(zoom-|grab)/,Ha+"$1"),/(image-set)/,Ha+"$1"),t,"")+t;case 5495:case 3959:return Ga(t,/(image-set\([^]*)/,Ha+"$1$`$1");case 4968:return Ga(Ga(t,/(.+:)(flex-)?(.*)/,Ha+"box-pack:$3"+Zu+"flex-pack:$3"),/s.+-b[^;]+/,"justify")+Ha+t+t;case 4095:case 3583:case 4068:case 2532:return Ga(t,/(.+)-inline(.+)/,Ha+"$1$2")+t;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(ld(t)-1-e>6)switch(wu(t,e+1)){case 109:if(wu(t,e+4)!==45)break;case 102:return Ga(t,/(.+:)(.+)-([^]+)/,"$1"+Ha+"$2-$3$1"+VS+(wu(t,e+3)==108?"$3":"$2-$3"))+t;case 115:return~_k(t,"stretch")?eX(Ga(t,"stretch","fill-available"),e)+t:t}break;case 4949:if(wu(t,e+1)!==115)break;case 6444:switch(wu(t,ld(t)-3-(~_k(t,"!important")&&10))){case 107:return Ga(t,":",":"+Ha)+t;case 101:return Ga(t,/(.+:)([^;!]+)(;|!.+)?/,"$1"+Ha+(wu(t,14)===45?"inline-":"")+"box$3$1"+Ha+"$2$3$1"+Zu+"$2box$3")+t}break;case 5936:switch(wu(t,e+11)){case 114:return Ha+t+Zu+Ga(t,/[svh]\w+-[tblr]{2}/,"tb")+t;case 108:return Ha+t+Zu+Ga(t,/[svh]\w+-[tblr]{2}/,"tb-rl")+t;case 45:return Ha+t+Zu+Ga(t,/[svh]\w+-[tblr]{2}/,"lr")+t}return Ha+t+Zu+t+t}return t}var Goe=function(e,r,n,i){if(e.length>-1&&!e.return)switch(e.type){case PD:e.return=eX(e.value,e.length);break;case XW:return w0([J_(e,{value:Ga(e.value,"@","@"+Ha)})],i);case ID:if(e.length)return Poe(e.props,function(a){switch(Ioe(a,/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":return w0([J_(e,{props:[Ga(a,/:(read-\w+)/,":"+VS+"$1")]})],i);case"::placeholder":return w0([J_(e,{props:[Ga(a,/:(plac\w+)/,":"+Ha+"input-$1")]}),J_(e,{props:[Ga(a,/:(plac\w+)/,":"+VS+"$1")]}),J_(e,{props:[Ga(a,/:(plac\w+)/,Zu+"input-$1")]})],i)}return""})}},Woe=[Goe],Xoe=function(e){var r=e.key;if(r==="css"){var n=document.querySelectorAll("style[data-emotion]:not([data-s])");Array.prototype.forEach.call(n,function(T){var A=T.getAttribute("data-emotion");A.indexOf(" ")!==-1&&(document.head.appendChild(T),T.setAttribute("data-s",""))})}var i=e.stylisPlugins||Woe,a={},s,o=[];s=e.container||document.head,Array.prototype.forEach.call(document.querySelectorAll('style[data-emotion^="'+r+' "]'),function(T){for(var A=T.getAttribute("data-emotion").split(" "),M=1;M<A.length;M++)a[A[M]]=!0;o.push(T)});var c,f=[qoe,Hoe];{var d,m=[Boe,joe(function(T){d.insert(T)})],b=zoe(f.concat(i,m)),x=function(A){return w0(Loe(A),b)};c=function(A,M,F,N){d=F,x(A?A+"{"+M.styles+"}":M.styles),N&&(E.inserted[M.name]=!0)}}var E={key:r,sheet:new woe({key:r,container:s,nonce:e.nonce,speedy:e.speedy,prepend:e.prepend,insertionPoint:e.insertionPoint}),nonce:e.nonce,inserted:a,registered:{},insert:c};return E.sheet.hydrate(o),E},tA={exports:{}},io={};/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var G8;function Yoe(){if(G8)return io;G8=1;var t=typeof Symbol=="function"&&Symbol.for,e=t?Symbol.for("react.element"):60103,r=t?Symbol.for("react.portal"):60106,n=t?Symbol.for("react.fragment"):60107,i=t?Symbol.for("react.strict_mode"):60108,a=t?Symbol.for("react.profiler"):60114,s=t?Symbol.for("react.provider"):60109,o=t?Symbol.for("react.context"):60110,c=t?Symbol.for("react.async_mode"):60111,f=t?Symbol.for("react.concurrent_mode"):60111,d=t?Symbol.for("react.forward_ref"):60112,m=t?Symbol.for("react.suspense"):60113,b=t?Symbol.for("react.suspense_list"):60120,x=t?Symbol.for("react.memo"):60115,E=t?Symbol.for("react.lazy"):60116,T=t?Symbol.for("react.block"):60121,A=t?Symbol.for("react.fundamental"):60117,M=t?Symbol.for("react.responder"):60118,F=t?Symbol.for("react.scope"):60119;function N(U){if(typeof U=="object"&&U!==null){var j=U.$$typeof;switch(j){case e:switch(U=U.type,U){case c:case f:case n:case a:case i:case m:return U;default:switch(U=U&&U.$$typeof,U){case o:case d:case E:case x:case s:return U;default:return j}}case r:return j}}}function O(U){return N(U)===f}return io.AsyncMode=c,io.ConcurrentMode=f,io.ContextConsumer=o,io.ContextProvider=s,io.Element=e,io.ForwardRef=d,io.Fragment=n,io.Lazy=E,io.Memo=x,io.Portal=r,io.Profiler=a,io.StrictMode=i,io.Suspense=m,io.isAsyncMode=function(U){return O(U)||N(U)===c},io.isConcurrentMode=O,io.isContextConsumer=function(U){return N(U)===o},io.isContextProvider=function(U){return N(U)===s},io.isElement=function(U){return typeof U=="object"&&U!==null&&U.$$typeof===e},io.isForwardRef=function(U){return N(U)===d},io.isFragment=function(U){return N(U)===n},io.isLazy=function(U){return N(U)===E},io.isMemo=function(U){return N(U)===x},io.isPortal=function(U){return N(U)===r},io.isProfiler=function(U){return N(U)===a},io.isStrictMode=function(U){return N(U)===i},io.isSuspense=function(U){return N(U)===m},io.isValidElementType=function(U){return typeof U=="string"||typeof U=="function"||U===n||U===f||U===a||U===i||U===m||U===b||typeof U=="object"&&U!==null&&(U.$$typeof===E||U.$$typeof===x||U.$$typeof===s||U.$$typeof===o||U.$$typeof===d||U.$$typeof===A||U.$$typeof===M||U.$$typeof===F||U.$$typeof===T)},io.typeOf=N,io}var W8;function Zoe(){return W8||(W8=1,tA.exports=Yoe()),tA.exports}var rA,X8;function Koe(){if(X8)return rA;X8=1;var t=Zoe(),e={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},r={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},n={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},i={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},a={};a[t.ForwardRef]=n,a[t.Memo]=i;function s(E){return t.isMemo(E)?i:a[E.$$typeof]||e}var o=Object.defineProperty,c=Object.getOwnPropertyNames,f=Object.getOwnPropertySymbols,d=Object.getOwnPropertyDescriptor,m=Object.getPrototypeOf,b=Object.prototype;function x(E,T,A){if(typeof T!="string"){if(b){var M=m(T);M&&M!==b&&x(E,M,A)}var F=c(T);f&&(F=F.concat(f(T)));for(var N=s(E),O=s(T),U=0;U<F.length;++U){var j=F[U];if(!r[j]&&!(A&&A[j])&&!(O&&O[j])&&!(N&&N[j])){var H=d(T,j);try{o(E,j,H)}catch{}}}}return E}return rA=x,rA}Koe();var Joe=!0;function tX(t,e,r){var n="";return r.split(" ").forEach(function(i){t[i]!==void 0?e.push(t[i]+";"):i&&(n+=i+" ")}),n}var RD=function(e,r,n){var i=e.key+"-"+r.name;(n===!1||Joe===!1)&&e.registered[i]===void 0&&(e.registered[i]=r.styles)},MD=function(e,r,n){RD(e,r,n);var i=e.key+"-"+r.name;if(e.inserted[r.name]===void 0){var a=r;do e.insert(r===a?"."+i:"",a,e.sheet,!0),a=a.next;while(a!==void 0)}};function Qoe(t){for(var e=0,r,n=0,i=t.length;i>=4;++n,i-=4)r=t.charCodeAt(n)&255|(t.charCodeAt(++n)&255)<<8|(t.charCodeAt(++n)&255)<<16|(t.charCodeAt(++n)&255)<<24,r=(r&65535)*1540483477+((r>>>16)*59797<<16),r^=r>>>24,e=(r&65535)*1540483477+((r>>>16)*59797<<16)^(e&65535)*1540483477+((e>>>16)*59797<<16);switch(i){case 3:e^=(t.charCodeAt(n+2)&255)<<16;case 2:e^=(t.charCodeAt(n+1)&255)<<8;case 1:e^=t.charCodeAt(n)&255,e=(e&65535)*1540483477+((e>>>16)*59797<<16)}return e^=e>>>13,e=(e&65535)*1540483477+((e>>>16)*59797<<16),((e^e>>>15)>>>0).toString(36)}var ese={animationIterationCount:1,aspectRatio:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,scale:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},tse=/[A-Z]|^ms/g,rse=/_EMO_([^_]+?)_([^]*?)_EMO_/g,rX=function(e){return e.charCodeAt(1)===45},Y8=function(e){return e!=null&&typeof e!="boolean"},nA=QW(function(t){return rX(t)?t:t.replace(tse,"-$&").toLowerCase()}),Z8=function(e,r){switch(e){case"animation":case"animationName":if(typeof r=="string")return r.replace(rse,function(n,i,a){return ud={name:i,styles:a,next:ud},i})}return ese[e]!==1&&!rX(e)&&typeof r=="number"&&r!==0?r+"px":r};function Ob(t,e,r){if(r==null)return"";var n=r;if(n.__emotion_styles!==void 0)return n;switch(typeof r){case"boolean":return"";case"object":{var i=r;if(i.anim===1)return ud={name:i.name,styles:i.styles,next:ud},i.name;var a=r;if(a.styles!==void 0){var s=a.next;if(s!==void 0)for(;s!==void 0;)ud={name:s.name,styles:s.styles,next:ud},s=s.next;var o=a.styles+";";return o}return nse(t,e,r)}case"function":{if(t!==void 0){var c=ud,f=r(t);return ud=c,Ob(t,e,f)}break}}var d=r;if(e==null)return d;var m=e[d];return m!==void 0?m:d}function nse(t,e,r){var n="";if(Array.isArray(r))for(var i=0;i<r.length;i++)n+=Ob(t,e,r[i])+";";else for(var a in r){var s=r[a];if(typeof s!="object"){var o=s;e!=null&&e[o]!==void 0?n+=a+"{"+e[o]+"}":Y8(o)&&(n+=nA(a)+":"+Z8(a,o)+";")}else if(Array.isArray(s)&&typeof s[0]=="string"&&(e==null||e[s[0]]===void 0))for(var c=0;c<s.length;c++)Y8(s[c])&&(n+=nA(a)+":"+Z8(a,s[c])+";");else{var f=Ob(t,e,s);switch(a){case"animation":case"animationName":{n+=nA(a)+":"+f+";";break}default:n+=a+"{"+f+"}"}}}return n}var K8=/label:\s*([^\s;{]+)\s*(;|$)/g,ud;function Ex(t,e,r){if(t.length===1&&typeof t[0]=="object"&&t[0]!==null&&t[0].styles!==void 0)return t[0];var n=!0,i="";ud=void 0;var a=t[0];if(a==null||a.raw===void 0)n=!1,i+=Ob(r,e,a);else{var s=a;i+=s[0]}for(var o=1;o<t.length;o++)if(i+=Ob(r,e,t[o]),n){var c=a;i+=c[o]}K8.lastIndex=0;for(var f="",d;(d=K8.exec(i))!==null;)f+="-"+d[1];var m=Qoe(i)+f;return{name:m,styles:i,next:ud}}var ise=function(e){return e()},nX=jS.useInsertionEffect?jS.useInsertionEffect:!1,iX=nX||ise,J8=nX||te.useLayoutEffect,aX=te.createContext(typeof HTMLElement<"u"?Xoe({key:"css"}):null);aX.Provider;var DD=function(e){return te.forwardRef(function(r,n){var i=te.useContext(aX);return e(r,i,n)})},Tx=te.createContext({}),OD={}.hasOwnProperty,xk="__EMOTION_TYPE_PLEASE_DO_NOT_USE__",ase=function(e,r){var n={};for(var i in r)OD.call(r,i)&&(n[i]=r[i]);return n[xk]=e,n},ose=function(e){var r=e.cache,n=e.serialized,i=e.isStringTag;return RD(r,n,i),iX(function(){return MD(r,n,i)}),null},sse=DD(function(t,e,r){var n=t.css;typeof n=="string"&&e.registered[n]!==void 0&&(n=e.registered[n]);var i=t[xk],a=[n],s="";typeof t.className=="string"?s=tX(e.registered,a,t.className):t.className!=null&&(s=t.className+" ");var o=Ex(a,void 0,te.useContext(Tx));s+=e.key+"-"+o.name;var c={};for(var f in t)OD.call(t,f)&&f!=="css"&&f!==xk&&(c[f]=t[f]);return c.className=s,r&&(c.ref=r),te.createElement(te.Fragment,null,te.createElement(ose,{cache:e,serialized:o,isStringTag:typeof i=="string"}),te.createElement(i,c))}),lse=sse,Q8=function(e,r){var n=arguments;if(r==null||!OD.call(r,"css"))return te.createElement.apply(void 0,n);var i=n.length,a=new Array(i);a[0]=lse,a[1]=ase(e,r);for(var s=2;s<i;s++)a[s]=n[s];return te.createElement.apply(null,a)};(function(t){var e;e||(e=t.JSX||(t.JSX={}))})(Q8||(Q8={}));var oX=DD(function(t,e){var r=t.styles,n=Ex([r],void 0,te.useContext(Tx)),i=te.useRef();return J8(function(){var a=e.key+"-global",s=new e.sheet.constructor({key:a,nonce:e.sheet.nonce,container:e.sheet.container,speedy:e.sheet.isSpeedy}),o=!1,c=document.querySelector('style[data-emotion="'+a+" "+n.name+'"]');return e.sheet.tags.length&&(s.before=e.sheet.tags[0]),c!==null&&(o=!0,c.setAttribute("data-emotion",a),s.hydrate([c])),i.current=[s,o],function(){s.flush()}},[e]),J8(function(){var a=i.current,s=a[0],o=a[1];if(o){a[1]=!1;return}if(n.next!==void 0&&MD(e,n.next,!0),s.tags.length){var c=s.tags[s.tags.length-1].nextElementSibling;s.before=c,s.flush()}e.insert("",n,s,!1)},[e,n.name]),null});function ND(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];return Ex(e)}function Cx(){var t=ND.apply(void 0,arguments),e="animation-"+t.name;return{name:e,styles:"@keyframes "+e+"{"+t.styles+"}",anim:1,toString:function(){return"_EMO_"+this.name+"_"+this.styles+"_EMO_"}}}var use=/^((children|dangerouslySetInnerHTML|key|ref|autoFocus|defaultValue|defaultChecked|innerHTML|suppressContentEditableWarning|suppressHydrationWarning|valueLink|abbr|accept|acceptCharset|accessKey|action|allow|allowUserMedia|allowPaymentRequest|allowFullScreen|allowTransparency|alt|async|autoComplete|autoPlay|capture|cellPadding|cellSpacing|challenge|charSet|checked|cite|classID|className|cols|colSpan|content|contentEditable|contextMenu|controls|controlsList|coords|crossOrigin|data|dateTime|decoding|default|defer|dir|disabled|disablePictureInPicture|disableRemotePlayback|download|draggable|encType|enterKeyHint|fetchpriority|fetchPriority|form|formAction|formEncType|formMethod|formNoValidate|formTarget|frameBorder|headers|height|hidden|high|href|hrefLang|htmlFor|httpEquiv|id|inputMode|integrity|is|keyParams|keyType|kind|label|lang|list|loading|loop|low|marginHeight|marginWidth|max|maxLength|media|mediaGroup|method|min|minLength|multiple|muted|name|nonce|noValidate|open|optimum|pattern|placeholder|playsInline|popover|popoverTarget|popoverTargetAction|poster|preload|profile|radioGroup|readOnly|referrerPolicy|rel|required|reversed|role|rows|rowSpan|sandbox|scope|scoped|scrolling|seamless|selected|shape|size|sizes|slot|span|spellCheck|src|srcDoc|srcLang|srcSet|start|step|style|summary|tabIndex|target|title|translate|type|useMap|value|width|wmode|wrap|about|datatype|inlist|prefix|property|resource|typeof|vocab|autoCapitalize|autoCorrect|autoSave|color|incremental|fallback|inert|itemProp|itemScope|itemType|itemID|itemRef|on|option|results|security|unselectable|accentHeight|accumulate|additive|alignmentBaseline|allowReorder|alphabetic|amplitude|arabicForm|ascent|attributeName|attributeType|autoReverse|azimuth|baseFrequency|baselineShift|baseProfile|bbox|begin|bias|by|calcMode|capHeight|clip|clipPathUnits|clipPath|clipRule|colorInterpolation|colorInterpolationFilters|colorProfile|colorRendering|contentScriptType|contentStyleType|cursor|cx|cy|d|decelerate|descent|diffuseConstant|direction|display|divisor|dominantBaseline|dur|dx|dy|edgeMode|elevation|enableBackground|end|exponent|externalResourcesRequired|fill|fillOpacity|fillRule|filter|filterRes|filterUnits|floodColor|floodOpacity|focusable|fontFamily|fontSize|fontSizeAdjust|fontStretch|fontStyle|fontVariant|fontWeight|format|from|fr|fx|fy|g1|g2|glyphName|glyphOrientationHorizontal|glyphOrientationVertical|glyphRef|gradientTransform|gradientUnits|hanging|horizAdvX|horizOriginX|ideographic|imageRendering|in|in2|intercept|k|k1|k2|k3|k4|kernelMatrix|kernelUnitLength|kerning|keyPoints|keySplines|keyTimes|lengthAdjust|letterSpacing|lightingColor|limitingConeAngle|local|markerEnd|markerMid|markerStart|markerHeight|markerUnits|markerWidth|mask|maskContentUnits|maskUnits|mathematical|mode|numOctaves|offset|opacity|operator|order|orient|orientation|origin|overflow|overlinePosition|overlineThickness|panose1|paintOrder|pathLength|patternContentUnits|patternTransform|patternUnits|pointerEvents|points|pointsAtX|pointsAtY|pointsAtZ|preserveAlpha|preserveAspectRatio|primitiveUnits|r|radius|refX|refY|renderingIntent|repeatCount|repeatDur|requiredExtensions|requiredFeatures|restart|result|rotate|rx|ry|scale|seed|shapeRendering|slope|spacing|specularConstant|specularExponent|speed|spreadMethod|startOffset|stdDeviation|stemh|stemv|stitchTiles|stopColor|stopOpacity|strikethroughPosition|strikethroughThickness|string|stroke|strokeDasharray|strokeDashoffset|strokeLinecap|strokeLinejoin|strokeMiterlimit|strokeOpacity|strokeWidth|surfaceScale|systemLanguage|tableValues|targetX|targetY|textAnchor|textDecoration|textRendering|textLength|to|transform|u1|u2|underlinePosition|underlineThickness|unicode|unicodeBidi|unicodeRange|unitsPerEm|vAlphabetic|vHanging|vIdeographic|vMathematical|values|vectorEffect|version|vertAdvY|vertOriginX|vertOriginY|viewBox|viewTarget|visibility|widths|wordSpacing|writingMode|x|xHeight|x1|x2|xChannelSelector|xlinkActuate|xlinkArcrole|xlinkHref|xlinkRole|xlinkShow|xlinkTitle|xlinkType|xmlBase|xmlns|xmlnsXlink|xmlLang|xmlSpace|y|y1|y2|yChannelSelector|z|zoomAndPan|for|class|autofocus)|(([Dd][Aa][Tt][Aa]|[Aa][Rr][Ii][Aa]|x)-.*))$/,cse=QW(function(t){return use.test(t)||t.charCodeAt(0)===111&&t.charCodeAt(1)===110&&t.charCodeAt(2)<91}),fse=cse,hse=function(e){return e!=="theme"},eB=function(e){return typeof e=="string"&&e.charCodeAt(0)>96?fse:hse},tB=function(e,r,n){var i;if(r){var a=r.shouldForwardProp;i=e.__emotion_forwardProp&&a?function(s){return e.__emotion_forwardProp(s)&&a(s)}:a}return typeof i!="function"&&n&&(i=e.__emotion_forwardProp),i},dse=function(e){var r=e.cache,n=e.serialized,i=e.isStringTag;return RD(r,n,i),iX(function(){return MD(r,n,i)}),null},pse=function t(e,r){var n=e.__emotion_real===e,i=n&&e.__emotion_base||e,a,s;r!==void 0&&(a=r.label,s=r.target);var o=tB(e,r,n),c=o||eB(i),f=!c("as");return function(){var d=arguments,m=n&&e.__emotion_styles!==void 0?e.__emotion_styles.slice(0):[];if(a!==void 0&&m.push("label:"+a+";"),d[0]==null||d[0].raw===void 0)m.push.apply(m,d);else{var b=d[0];m.push(b[0]);for(var x=d.length,E=1;E<x;E++)m.push(d[E],b[E])}var T=DD(function(A,M,F){var N=f&&A.as||i,O="",U=[],j=A;if(A.theme==null){j={};for(var H in A)j[H]=A[H];j.theme=te.useContext(Tx)}typeof A.className=="string"?O=tX(M.registered,U,A.className):A.className!=null&&(O=A.className+" ");var W=Ex(m.concat(U),M.registered,j);O+=M.key+"-"+W.name,s!==void 0&&(O+=" "+s);var X=f&&o===void 0?eB(N):c,oe={};for(var Q in A)f&&Q==="as"||X(Q)&&(oe[Q]=A[Q]);return oe.className=O,F&&(oe.ref=F),te.createElement(te.Fragment,null,te.createElement(dse,{cache:M,serialized:W,isStringTag:typeof N=="string"}),te.createElement(N,oe))});return T.displayName=a!==void 0?a:"Styled("+(typeof i=="string"?i:i.displayName||i.name||"Component")+")",T.defaultProps=e.defaultProps,T.__emotion_real=T,T.__emotion_base=i,T.__emotion_styles=m,T.__emotion_forwardProp=o,Object.defineProperty(T,"toString",{value:function(){return"."+s}}),T.withComponent=function(A,M){var F=t(A,US({},r,M,{shouldForwardProp:tB(T,M,!0)}));return F.apply(void 0,m)},T}},gse=["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","marquee","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","title","tr","track","u","ul","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","tspan"],wk=pse.bind(null);gse.forEach(function(t){wk[t]=wk(t)});var iA={exports:{}},aA,rB;function mse(){if(rB)return aA;rB=1;var t="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";return aA=t,aA}var oA,nB;function yse(){if(nB)return oA;nB=1;var t=mse();function e(){}function r(){}return r.resetWarningCache=e,oA=function(){function n(s,o,c,f,d,m){if(m!==t){var b=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw b.name="Invariant Violation",b}}n.isRequired=n;function i(){return n}var a={array:n,bigint:n,bool:n,func:n,number:n,object:n,string:n,symbol:n,any:n,arrayOf:i,element:n,elementType:n,instanceOf:i,node:n,objectOf:i,oneOf:i,oneOfType:i,shape:i,exact:i,checkPropTypes:r,resetWarningCache:e};return a.PropTypes=a,a},oA}var iB;function vse(){return iB||(iB=1,iA.exports=yse()()),iA.exports}var _se=vse();const Rn=Id(_se);function bse(t){return t==null||Object.keys(t).length===0}function sX(t){const{styles:e,defaultTheme:r={}}=t,n=typeof e=="function"?i=>e(bse(i)?r:i):e;return J.jsx(oX,{styles:n})}function lX(t,e){return wk(t,e)}function xse(t,e){Array.isArray(t.__emotion_styles)&&(t.__emotion_styles=e(t.__emotion_styles))}const aB=[];function vg(t){return aB[0]=t,Ex(aB)}var sA={exports:{}},_o={};/**
 * @license React
 * react-is.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var oB;function wse(){if(oB)return _o;oB=1;var t=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),a=Symbol.for("react.consumer"),s=Symbol.for("react.context"),o=Symbol.for("react.forward_ref"),c=Symbol.for("react.suspense"),f=Symbol.for("react.suspense_list"),d=Symbol.for("react.memo"),m=Symbol.for("react.lazy"),b=Symbol.for("react.view_transition"),x=Symbol.for("react.client.reference");function E(T){if(typeof T=="object"&&T!==null){var A=T.$$typeof;switch(A){case t:switch(T=T.type,T){case r:case i:case n:case c:case f:case b:return T;default:switch(T=T&&T.$$typeof,T){case s:case o:case m:case d:return T;case a:return T;default:return A}}case e:return A}}}return _o.ContextConsumer=a,_o.ContextProvider=s,_o.Element=t,_o.ForwardRef=o,_o.Fragment=r,_o.Lazy=m,_o.Memo=d,_o.Portal=e,_o.Profiler=i,_o.StrictMode=n,_o.Suspense=c,_o.SuspenseList=f,_o.isContextConsumer=function(T){return E(T)===a},_o.isContextProvider=function(T){return E(T)===s},_o.isElement=function(T){return typeof T=="object"&&T!==null&&T.$$typeof===t},_o.isForwardRef=function(T){return E(T)===o},_o.isFragment=function(T){return E(T)===r},_o.isLazy=function(T){return E(T)===m},_o.isMemo=function(T){return E(T)===d},_o.isPortal=function(T){return E(T)===e},_o.isProfiler=function(T){return E(T)===i},_o.isStrictMode=function(T){return E(T)===n},_o.isSuspense=function(T){return E(T)===c},_o.isSuspenseList=function(T){return E(T)===f},_o.isValidElementType=function(T){return typeof T=="string"||typeof T=="function"||T===r||T===i||T===n||T===c||T===f||typeof T=="object"&&T!==null&&(T.$$typeof===m||T.$$typeof===d||T.$$typeof===s||T.$$typeof===a||T.$$typeof===o||T.$$typeof===x||T.getModuleId!==void 0)},_o.typeOf=E,_o}var sB;function Sse(){return sB||(sB=1,sA.exports=wse()),sA.exports}var uX=Sse();function cd(t){if(typeof t!="object"||t===null)return!1;const e=Object.getPrototypeOf(t);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)}function cX(t){if(te.isValidElement(t)||uX.isValidElementType(t)||!cd(t))return t;const e={};return Object.keys(t).forEach(r=>{e[r]=cX(t[r])}),e}function Qu(t,e,r={clone:!0}){const n=r.clone?{...t}:t;return cd(t)&&cd(e)&&Object.keys(e).forEach(i=>{te.isValidElement(e[i])||uX.isValidElementType(e[i])?n[i]=e[i]:cd(e[i])&&Object.prototype.hasOwnProperty.call(t,i)&&cd(t[i])?n[i]=Qu(t[i],e[i],r):r.clone?n[i]=cd(e[i])?cX(e[i]):e[i]:n[i]=e[i]}),n}const Ese=t=>{const e=Object.keys(t).map(r=>({key:r,val:t[r]}))||[];return e.sort((r,n)=>r.val-n.val),e.reduce((r,n)=>({...r,[n.key]:n.val}),{})};function Tse(t){const{values:e={xs:0,sm:600,md:900,lg:1200,xl:1536},unit:r="px",step:n=5,...i}=t,a=Ese(e),s=Object.keys(a);function o(b){return`@media (min-width:${typeof e[b]=="number"?e[b]:b}${r})`}function c(b){return`@media (max-width:${(typeof e[b]=="number"?e[b]:b)-n/100}${r})`}function f(b,x){const E=s.indexOf(x);return`@media (min-width:${typeof e[b]=="number"?e[b]:b}${r}) and (max-width:${(E!==-1&&typeof e[s[E]]=="number"?e[s[E]]:x)-n/100}${r})`}function d(b){return s.indexOf(b)+1<s.length?f(b,s[s.indexOf(b)+1]):o(b)}function m(b){const x=s.indexOf(b);return x===0?o(s[1]):x===s.length-1?c(s[x]):f(b,s[s.indexOf(b)+1]).replace("@media","@media not all and")}return{keys:s,values:a,up:o,down:c,between:f,only:d,not:m,unit:r,...i}}function lB(t,e){if(!t.containerQueries)return e;const r=Object.keys(e).filter(n=>n.startsWith("@container")).sort((n,i)=>{const a=/min-width:\s*([0-9.]+)/;return+(n.match(a)?.[1]||0)-+(i.match(a)?.[1]||0)});return r.length?r.reduce((n,i)=>{const a=e[i];return delete n[i],n[i]=a,n},{...e}):e}function Cse(t,e){return e==="@"||e.startsWith("@")&&(t.some(r=>e.startsWith(`@${r}`))||!!e.match(/^@\d/))}function Ase(t,e){const r=e.match(/^@([^/]+)?\/?(.+)?$/);if(!r)return null;const[,n,i]=r,a=Number.isNaN(+n)?n||0:+n;return t.containerQueries(i).up(a)}function Ise(t){const e=(a,s)=>a.replace("@media",s?`@container ${s}`:"@container");function r(a,s){a.up=(...o)=>e(t.breakpoints.up(...o),s),a.down=(...o)=>e(t.breakpoints.down(...o),s),a.between=(...o)=>e(t.breakpoints.between(...o),s),a.only=(...o)=>e(t.breakpoints.only(...o),s),a.not=(...o)=>{const c=e(t.breakpoints.not(...o),s);return c.includes("not all and")?c.replace("not all and ","").replace("min-width:","width<").replace("max-width:","width>").replace("and","or"):c}}const n={},i=a=>(r(n,a),n);return r(i),{...t,containerQueries:i}}const Pse={borderRadius:4};function ab(t,e){return e?Qu(t,e,{clone:!1}):t}const RT={xs:0,sm:600,md:900,lg:1200,xl:1536},uB={keys:["xs","sm","md","lg","xl"],up:t=>`@media (min-width:${RT[t]}px)`},kse={containerQueries:t=>({up:e=>{let r=typeof e=="number"?e:RT[e]||e;return typeof r=="number"&&(r=`${r}px`),t?`@container ${t} (min-width:${r})`:`@container (min-width:${r})`}})};function bp(t,e,r){const n=t.theme||{};if(Array.isArray(e)){const a=n.breakpoints||uB;return e.reduce((s,o,c)=>(s[a.up(a.keys[c])]=r(e[c]),s),{})}if(typeof e=="object"){const a=n.breakpoints||uB;return Object.keys(e).reduce((s,o)=>{if(Cse(a.keys,o)){const c=Ase(n.containerQueries?n:kse,o);c&&(s[c]=r(e[o],o))}else if(Object.keys(a.values||RT).includes(o)){const c=a.up(o);s[c]=r(e[o],o)}else{const c=o;s[c]=e[c]}return s},{})}return r(e)}function Rse(t={}){return t.keys?.reduce((r,n)=>{const i=t.up(n);return r[i]={},r},{})||{}}function cB(t,e){return t.reduce((r,n)=>{const i=r[n];return(!i||Object.keys(i).length===0)&&delete r[n],r},e)}function cn(t){if(typeof t!="string")throw new Error(_p(7));return t.charAt(0).toUpperCase()+t.slice(1)}function MT(t,e,r=!0){if(!e||typeof e!="string")return null;if(t&&t.vars&&r){const n=`vars.${e}`.split(".").reduce((i,a)=>i&&i[a]?i[a]:null,t);if(n!=null)return n}return e.split(".").reduce((n,i)=>n&&n[i]!=null?n[i]:null,t)}function $S(t,e,r,n=r){let i;return typeof t=="function"?i=t(r):Array.isArray(t)?i=t[r]||n:i=MT(t,r)||n,e&&(i=e(i,n,t)),i}function al(t){const{prop:e,cssProperty:r=t.prop,themeKey:n,transform:i}=t,a=s=>{if(s[e]==null)return null;const o=s[e],c=s.theme,f=MT(c,n)||{};return bp(s,o,m=>{let b=$S(f,i,m);return m===b&&typeof m=="string"&&(b=$S(f,i,`${e}${m==="default"?"":cn(m)}`,m)),r===!1?b:{[r]:b}})};return a.propTypes={},a.filterProps=[e],a}function Mse(t){const e={};return r=>(e[r]===void 0&&(e[r]=t(r)),e[r])}const Dse={m:"margin",p:"padding"},Ose={t:"Top",r:"Right",b:"Bottom",l:"Left",x:["Left","Right"],y:["Top","Bottom"]},fB={marginX:"mx",marginY:"my",paddingX:"px",paddingY:"py"},Nse=Mse(t=>{if(t.length>2)if(fB[t])t=fB[t];else return[t];const[e,r]=t.split(""),n=Dse[e],i=Ose[r]||"";return Array.isArray(i)?i.map(a=>n+a):[n+i]}),LD=["m","mt","mr","mb","ml","mx","my","margin","marginTop","marginRight","marginBottom","marginLeft","marginX","marginY","marginInline","marginInlineStart","marginInlineEnd","marginBlock","marginBlockStart","marginBlockEnd"],FD=["p","pt","pr","pb","pl","px","py","padding","paddingTop","paddingRight","paddingBottom","paddingLeft","paddingX","paddingY","paddingInline","paddingInlineStart","paddingInlineEnd","paddingBlock","paddingBlockStart","paddingBlockEnd"];[...LD,...FD];function Ax(t,e,r,n){const i=MT(t,e,!0)??r;return typeof i=="number"||typeof i=="string"?a=>typeof a=="string"?a:typeof i=="string"?i.startsWith("var(")&&a===0?0:i.startsWith("var(")&&a===1?i:`calc(${a} * ${i})`:i*a:Array.isArray(i)?a=>{if(typeof a=="string")return a;const s=Math.abs(a),o=i[s];return a>=0?o:typeof o=="number"?-o:typeof o=="string"&&o.startsWith("var(")?`calc(-1 * ${o})`:`-${o}`}:typeof i=="function"?i:()=>{}}function BD(t){return Ax(t,"spacing",8)}function Ix(t,e){return typeof e=="string"||e==null?e:t(e)}function Lse(t,e){return r=>t.reduce((n,i)=>(n[i]=Ix(e,r),n),{})}function Fse(t,e,r,n){if(!e.includes(r))return null;const i=Nse(r),a=Lse(i,n),s=t[r];return bp(t,s,a)}function fX(t,e){const r=BD(t.theme);return Object.keys(t).map(n=>Fse(t,e,n,r)).reduce(ab,{})}function Ls(t){return fX(t,LD)}Ls.propTypes={};Ls.filterProps=LD;function Fs(t){return fX(t,FD)}Fs.propTypes={};Fs.filterProps=FD;function hX(t=8,e=BD({spacing:t})){if(t.mui)return t;const r=(...n)=>(n.length===0?[1]:n).map(a=>{const s=e(a);return typeof s=="number"?`${s}px`:s}).join(" ");return r.mui=!0,r}function DT(...t){const e=t.reduce((n,i)=>(i.filterProps.forEach(a=>{n[a]=i}),n),{}),r=n=>Object.keys(n).reduce((i,a)=>e[a]?ab(i,e[a](n)):i,{});return r.propTypes={},r.filterProps=t.reduce((n,i)=>n.concat(i.filterProps),[]),r}function Nf(t){return typeof t!="number"?t:`${t}px solid`}function Jf(t,e){return al({prop:t,themeKey:"borders",transform:e})}const Bse=Jf("border",Nf),zse=Jf("borderTop",Nf),jse=Jf("borderRight",Nf),Use=Jf("borderBottom",Nf),Vse=Jf("borderLeft",Nf),$se=Jf("borderColor"),qse=Jf("borderTopColor"),Hse=Jf("borderRightColor"),Gse=Jf("borderBottomColor"),Wse=Jf("borderLeftColor"),Xse=Jf("outline",Nf),Yse=Jf("outlineColor"),OT=t=>{if(t.borderRadius!==void 0&&t.borderRadius!==null){const e=Ax(t.theme,"shape.borderRadius",4),r=n=>({borderRadius:Ix(e,n)});return bp(t,t.borderRadius,r)}return null};OT.propTypes={};OT.filterProps=["borderRadius"];DT(Bse,zse,jse,Use,Vse,$se,qse,Hse,Gse,Wse,OT,Xse,Yse);const NT=t=>{if(t.gap!==void 0&&t.gap!==null){const e=Ax(t.theme,"spacing",8),r=n=>({gap:Ix(e,n)});return bp(t,t.gap,r)}return null};NT.propTypes={};NT.filterProps=["gap"];const LT=t=>{if(t.columnGap!==void 0&&t.columnGap!==null){const e=Ax(t.theme,"spacing",8),r=n=>({columnGap:Ix(e,n)});return bp(t,t.columnGap,r)}return null};LT.propTypes={};LT.filterProps=["columnGap"];const FT=t=>{if(t.rowGap!==void 0&&t.rowGap!==null){const e=Ax(t.theme,"spacing",8),r=n=>({rowGap:Ix(e,n)});return bp(t,t.rowGap,r)}return null};FT.propTypes={};FT.filterProps=["rowGap"];const Zse=al({prop:"gridColumn"}),Kse=al({prop:"gridRow"}),Jse=al({prop:"gridAutoFlow"}),Qse=al({prop:"gridAutoColumns"}),ele=al({prop:"gridAutoRows"}),tle=al({prop:"gridTemplateColumns"}),rle=al({prop:"gridTemplateRows"}),nle=al({prop:"gridTemplateAreas"}),ile=al({prop:"gridArea"});DT(NT,LT,FT,Zse,Kse,Jse,Qse,ele,tle,rle,nle,ile);function S0(t,e){return e==="grey"?e:t}const ale=al({prop:"color",themeKey:"palette",transform:S0}),ole=al({prop:"bgcolor",cssProperty:"backgroundColor",themeKey:"palette",transform:S0}),sle=al({prop:"backgroundColor",themeKey:"palette",transform:S0});DT(ale,ole,sle);function of(t){return t<=1&&t!==0?`${t*100}%`:t}const lle=al({prop:"width",transform:of}),zD=t=>{if(t.maxWidth!==void 0&&t.maxWidth!==null){const e=r=>{const n=t.theme?.breakpoints?.values?.[r]||RT[r];return n?t.theme?.breakpoints?.unit!=="px"?{maxWidth:`${n}${t.theme.breakpoints.unit}`}:{maxWidth:n}:{maxWidth:of(r)}};return bp(t,t.maxWidth,e)}return null};zD.filterProps=["maxWidth"];const ule=al({prop:"minWidth",transform:of}),cle=al({prop:"height",transform:of}),fle=al({prop:"maxHeight",transform:of}),hle=al({prop:"minHeight",transform:of});al({prop:"size",cssProperty:"width",transform:of});al({prop:"size",cssProperty:"height",transform:of});const dle=al({prop:"boxSizing"});DT(lle,zD,ule,cle,fle,hle,dle);const Px={border:{themeKey:"borders",transform:Nf},borderTop:{themeKey:"borders",transform:Nf},borderRight:{themeKey:"borders",transform:Nf},borderBottom:{themeKey:"borders",transform:Nf},borderLeft:{themeKey:"borders",transform:Nf},borderColor:{themeKey:"palette"},borderTopColor:{themeKey:"palette"},borderRightColor:{themeKey:"palette"},borderBottomColor:{themeKey:"palette"},borderLeftColor:{themeKey:"palette"},outline:{themeKey:"borders",transform:Nf},outlineColor:{themeKey:"palette"},borderRadius:{themeKey:"shape.borderRadius",style:OT},color:{themeKey:"palette",transform:S0},bgcolor:{themeKey:"palette",cssProperty:"backgroundColor",transform:S0},backgroundColor:{themeKey:"palette",transform:S0},p:{style:Fs},pt:{style:Fs},pr:{style:Fs},pb:{style:Fs},pl:{style:Fs},px:{style:Fs},py:{style:Fs},padding:{style:Fs},paddingTop:{style:Fs},paddingRight:{style:Fs},paddingBottom:{style:Fs},paddingLeft:{style:Fs},paddingX:{style:Fs},paddingY:{style:Fs},paddingInline:{style:Fs},paddingInlineStart:{style:Fs},paddingInlineEnd:{style:Fs},paddingBlock:{style:Fs},paddingBlockStart:{style:Fs},paddingBlockEnd:{style:Fs},m:{style:Ls},mt:{style:Ls},mr:{style:Ls},mb:{style:Ls},ml:{style:Ls},mx:{style:Ls},my:{style:Ls},margin:{style:Ls},marginTop:{style:Ls},marginRight:{style:Ls},marginBottom:{style:Ls},marginLeft:{style:Ls},marginX:{style:Ls},marginY:{style:Ls},marginInline:{style:Ls},marginInlineStart:{style:Ls},marginInlineEnd:{style:Ls},marginBlock:{style:Ls},marginBlockStart:{style:Ls},marginBlockEnd:{style:Ls},displayPrint:{cssProperty:!1,transform:t=>({"@media print":{display:t}})},display:{},overflow:{},textOverflow:{},visibility:{},whiteSpace:{},flexBasis:{},flexDirection:{},flexWrap:{},justifyContent:{},alignItems:{},alignContent:{},order:{},flex:{},flexGrow:{},flexShrink:{},alignSelf:{},justifyItems:{},justifySelf:{},gap:{style:NT},rowGap:{style:FT},columnGap:{style:LT},gridColumn:{},gridRow:{},gridAutoFlow:{},gridAutoColumns:{},gridAutoRows:{},gridTemplateColumns:{},gridTemplateRows:{},gridTemplateAreas:{},gridArea:{},position:{},zIndex:{themeKey:"zIndex"},top:{},right:{},bottom:{},left:{},boxShadow:{themeKey:"shadows"},width:{transform:of},maxWidth:{style:zD},minWidth:{transform:of},height:{transform:of},maxHeight:{transform:of},minHeight:{transform:of},boxSizing:{},font:{themeKey:"font"},fontFamily:{themeKey:"typography"},fontSize:{themeKey:"typography"},fontStyle:{themeKey:"typography"},fontWeight:{themeKey:"typography"},letterSpacing:{},textTransform:{},lineHeight:{},textAlign:{},typography:{cssProperty:!1,themeKey:"typography"}};function ple(...t){const e=t.reduce((n,i)=>n.concat(Object.keys(i)),[]),r=new Set(e);return t.every(n=>r.size===Object.keys(n).length)}function gle(t,e){return typeof t=="function"?t(e):t}function mle(){function t(r,n,i,a){const s={[r]:n,theme:i},o=a[r];if(!o)return{[r]:n};const{cssProperty:c=r,themeKey:f,transform:d,style:m}=o;if(n==null)return null;if(f==="typography"&&n==="inherit")return{[r]:n};const b=MT(i,f)||{};return m?m(s):bp(s,n,E=>{let T=$S(b,d,E);return E===T&&typeof E=="string"&&(T=$S(b,d,`${r}${E==="default"?"":cn(E)}`,E)),c===!1?T:{[c]:T}})}function e(r){const{sx:n,theme:i={},nested:a}=r||{};if(!n)return null;const s=i.unstable_sxConfig??Px;function o(c){let f=c;if(typeof c=="function")f=c(i);else if(typeof c!="object")return c;if(!f)return null;const d=Rse(i.breakpoints),m=Object.keys(d);let b=d;return Object.keys(f).forEach(x=>{const E=gle(f[x],i);if(E!=null)if(typeof E=="object")if(s[x])b=ab(b,t(x,E,i,s));else{const T=bp({theme:i},E,A=>({[x]:A}));ple(T,E)?b[x]=e({sx:E,theme:i,nested:!0}):b=ab(b,T)}else b=ab(b,t(x,E,i,s))}),!a&&i.modularCssLayers?{"@layer sx":lB(i,cB(m,b))}:lB(i,cB(m,b))}return Array.isArray(n)?n.map(o):o(n)}return e}const Sg=mle();Sg.filterProps=["sx"];function yle(t,e){const r=this;if(r.vars){if(!r.colorSchemes?.[t]||typeof r.getColorSchemeSelector!="function")return{};let n=r.getColorSchemeSelector(t);return n==="&"?e:((n.includes("data-")||n.includes("."))&&(n=`*:where(${n.replace(/\s*&$/,"")}) &`),{[n]:e})}return r.palette.mode===t?e:{}}function BT(t={},...e){const{breakpoints:r={},palette:n={},spacing:i,shape:a={},...s}=t,o=Tse(r),c=hX(i);let f=Qu({breakpoints:o,direction:"ltr",components:{},palette:{mode:"light",...n},spacing:c,shape:{...Pse,...a}},s);return f=Ise(f),f.applyStyles=yle,f=e.reduce((d,m)=>Qu(d,m),f),f.unstable_sxConfig={...Px,...s?.unstable_sxConfig},f.unstable_sx=function(m){return Sg({sx:m,theme:this})},f}function vle(t){return Object.keys(t).length===0}function zT(t=null){const e=te.useContext(Tx);return!e||vle(e)?t:e}const _le=BT();function kx(t=_le){return zT(t)}function lA(t){const e=vg(t);return t!==e&&e.styles?(e.styles.match(/^@layer\s+[^{]*$/)||(e.styles=`@layer global{${e.styles}}`),e):t}function dX({styles:t,themeId:e,defaultTheme:r={}}){const n=kx(r),i=e&&n[e]||n;let a=typeof t=="function"?t(i):t;return i.modularCssLayers&&(Array.isArray(a)?a=a.map(s=>lA(typeof s=="function"?s(i):s)):a=lA(a)),J.jsx(sX,{styles:a})}const ble=t=>{const e={systemProps:{},otherProps:{}},r=t?.theme?.unstable_sxConfig??Px;return Object.keys(t).forEach(n=>{r[n]?e.systemProps[n]=t[n]:e.otherProps[n]=t[n]}),e};function jD(t){const{sx:e,...r}=t,{systemProps:n,otherProps:i}=ble(r);let a;return Array.isArray(e)?a=[n,...e]:typeof e=="function"?a=(...s)=>{const o=e(...s);return cd(o)?{...n,...o}:n}:a={...n,...e},{...i,sx:a}}const hB=t=>t,xle=()=>{let t=hB;return{configure(e){t=e},generate(e){return t(e)},reset(){t=hB}}},UD=xle();function pX(t){var e,r,n="";if(typeof t=="string"||typeof t=="number")n+=t;else if(typeof t=="object")if(Array.isArray(t)){var i=t.length;for(e=0;e<i;e++)t[e]&&(r=pX(t[e]))&&(n&&(n+=" "),n+=r)}else for(r in t)t[r]&&(n&&(n+=" "),n+=r);return n}function An(){for(var t,e,r=0,n="",i=arguments.length;r<i;r++)(t=arguments[r])&&(e=pX(t))&&(n&&(n+=" "),n+=e);return n}function gX(t={}){const{themeId:e,defaultTheme:r,defaultClassName:n="MuiBox-root",generateClassName:i}=t,a=lX("div",{shouldForwardProp:o=>o!=="theme"&&o!=="sx"&&o!=="as"})(Sg);return te.forwardRef(function(c,f){const d=kx(r),{className:m,component:b="div",...x}=jD(c);return J.jsx(a,{as:b,ref:f,className:An(m,i?i(n):n),theme:e&&d[e]||d,...x})})}const wle={active:"active",checked:"checked",completed:"completed",disabled:"disabled",error:"error",expanded:"expanded",focused:"focused",focusVisible:"focusVisible",open:"open",readOnly:"readOnly",required:"required",selected:"selected"};function gi(t,e,r="Mui"){const n=wle[e];return n?`${r}-${n}`:`${UD.generate(t)}-${e}`}function pi(t,e,r="Mui"){const n={};return e.forEach(i=>{n[i]=gi(t,i,r)}),n}const Sle=pi("MuiBox",["root"]),Ov=gX({defaultClassName:Sle.root,generateClassName:UD.generate});function mX(t){const{variants:e,...r}=t,n={variants:e,style:vg(r),isProcessed:!0};return n.style===r||e&&e.forEach(i=>{typeof i.style!="function"&&(i.style=vg(i.style))}),n}const Ele=BT();function uA(t){return t!=="ownerState"&&t!=="theme"&&t!=="sx"&&t!=="as"}function Im(t,e){return e&&t&&typeof t=="object"&&t.styles&&!t.styles.startsWith("@layer")&&(t.styles=`@layer ${e}{${String(t.styles)}}`),t}function Tle(t){return t?(e,r)=>r[t]:null}function Cle(t,e,r){t.theme=Ile(t.theme)?r:t.theme[e]||t.theme}function uS(t,e,r){const n=typeof e=="function"?e(t):e;if(Array.isArray(n))return n.flatMap(i=>uS(t,i,r));if(Array.isArray(n?.variants)){let i;if(n.isProcessed)i=r?Im(n.style,r):n.style;else{const{variants:a,...s}=n;i=r?Im(vg(s),r):s}return yX(t,n.variants,[i],r)}return n?.isProcessed?r?Im(vg(n.style),r):n.style:r?Im(vg(n),r):n}function yX(t,e,r=[],n=void 0){let i;e:for(let a=0;a<e.length;a+=1){const s=e[a];if(typeof s.props=="function"){if(i??={...t,...t.ownerState,ownerState:t.ownerState},!s.props(i))continue}else for(const o in s.props)if(t[o]!==s.props[o]&&t.ownerState?.[o]!==s.props[o])continue e;typeof s.style=="function"?(i??={...t,...t.ownerState,ownerState:t.ownerState},r.push(n?Im(vg(s.style(i)),n):s.style(i))):r.push(n?Im(vg(s.style),n):s.style)}return r}function vX(t={}){const{themeId:e,defaultTheme:r=Ele,rootShouldForwardProp:n=uA,slotShouldForwardProp:i=uA}=t;function a(o){Cle(o,e,r)}return(o,c={})=>{xse(o,j=>j.filter(H=>H!==Sg));const{name:f,slot:d,skipVariantsResolver:m,skipSx:b,overridesResolver:x=Tle(kle(d)),...E}=c,T=f&&f.startsWith("Mui")||d?"components":"custom",A=m!==void 0?m:d&&d!=="Root"&&d!=="root"||!1,M=b||!1;let F=uA;d==="Root"||d==="root"?F=n:d?F=i:Ple(o)&&(F=void 0);const N=lX(o,{shouldForwardProp:F,label:Ale(),...E}),O=j=>{if(j.__emotion_real===j)return j;if(typeof j=="function")return function(W){return uS(W,j,W.theme.modularCssLayers?T:void 0)};if(cd(j)){const H=mX(j);return function(X){return H.variants?uS(X,H,X.theme.modularCssLayers?T:void 0):X.theme.modularCssLayers?Im(H.style,T):H.style}}return j},U=(...j)=>{const H=[],W=j.map(O),X=[];if(H.push(a),f&&x&&X.push(function(ae){const fe=ae.theme.components?.[f]?.styleOverrides;if(!fe)return null;const _e={};for(const Le in fe)_e[Le]=uS(ae,fe[Le],ae.theme.modularCssLayers?"theme":void 0);return x(ae,_e)}),f&&!A&&X.push(function(ae){const fe=ae.theme?.components?.[f]?.variants;return fe?yX(ae,fe,[],ae.theme.modularCssLayers?"theme":void 0):null}),M||X.push(Sg),Array.isArray(W[0])){const G=W.shift(),ae=new Array(H.length).fill(""),se=new Array(X.length).fill("");let fe;fe=[...ae,...G,...se],fe.raw=[...ae,...G.raw,...se],H.unshift(fe)}const oe=[...H,...W,...X],Q=N(...oe);return o.muiName&&(Q.muiName=o.muiName),Q};return N.withConfig&&(U.withConfig=N.withConfig),U}}function Ale(t,e){return void 0}function Ile(t){for(const e in t)return!1;return!0}function Ple(t){return typeof t=="string"&&t.charCodeAt(0)>96}function kle(t){return t&&t.charAt(0).toLowerCase()+t.slice(1)}const _y=vX();function Nb(t,e,r=!1){const n={...e};for(const i in t)if(Object.prototype.hasOwnProperty.call(t,i)){const a=i;if(a==="components"||a==="slots")n[a]={...t[a],...n[a]};else if(a==="componentsProps"||a==="slotProps"){const s=t[a],o=e[a];if(!o)n[a]=s||{};else if(!s)n[a]=o;else{n[a]={...o};for(const c in s)if(Object.prototype.hasOwnProperty.call(s,c)){const f=c;n[a][f]=Nb(s[f],o[f],r)}}}else a==="className"&&r&&e.className?n.className=An(t?.className,e?.className):a==="style"&&r&&e.style?n.style={...t?.style,...e?.style}:n[a]===void 0&&(n[a]=t[a])}return n}function _X(t){const{theme:e,name:r,props:n}=t;return!e||!e.components||!e.components[r]||!e.components[r].defaultProps?n:Nb(e.components[r].defaultProps,n)}function Rle({props:t,name:e,defaultTheme:r,themeId:n}){let i=kx(r);return n&&(i=i[n]||i),_X({theme:i,name:e,props:t})}const Tu=typeof window<"u"?te.useLayoutEffect:te.useEffect;function Mle(t,e,r,n,i){const[a,s]=te.useState(()=>i&&r?r(t).matches:n?n(t).matches:e);return Tu(()=>{if(!r)return;const o=r(t),c=()=>{s(o.matches)};return c(),o.addEventListener("change",c),()=>{o.removeEventListener("change",c)}},[t,r]),a}const Dle={...jS},bX=Dle.useSyncExternalStore;function Ole(t,e,r,n,i){const a=te.useCallback(()=>e,[e]),s=te.useMemo(()=>{if(i&&r)return()=>r(t).matches;if(n!==null){const{matches:d}=n(t);return()=>d}return a},[a,t,n,i,r]),[o,c]=te.useMemo(()=>{if(r===null)return[a,()=>()=>{}];const d=r(t);return[()=>d.matches,m=>(d.addEventListener("change",m),()=>{d.removeEventListener("change",m)})]},[a,r,t]);return bX(c,o,s)}function xX(t={}){const{themeId:e}=t;return function(n,i={}){let a=zT();a&&e&&(a=a[e]||a);const s=typeof window<"u"&&typeof window.matchMedia<"u",{defaultMatches:o=!1,matchMedia:c=s?window.matchMedia:null,ssrMatchMedia:f=null,noSsr:d=!1}=_X({name:"MuiUseMediaQuery",props:i,theme:a});let m=typeof n=="function"?n(a):n;return m=m.replace(/^@media( ?)/m,""),m.includes("print")&&console.warn(["MUI: You have provided a `print` query to the `useMediaQuery` hook.","Using the print media query to modify print styles can lead to unexpected results.","Consider using the `displayPrint` field in the `sx` prop instead.","More information about `displayPrint` on our docs: https://mui.com/system/display/#display-in-print."].join(`
`)),(bX!==void 0?Ole:Mle)(m,o,c,f,d)}}xX();function Nv(t,e=Number.MIN_SAFE_INTEGER,r=Number.MAX_SAFE_INTEGER){return Math.max(e,Math.min(t,r))}function VD(t,e=0,r=1){return Nv(t,e,r)}function Nle(t){t=t.slice(1);const e=new RegExp(`.{1,${t.length>=6?2:1}}`,"g");let r=t.match(e);return r&&r[0].length===1&&(r=r.map(n=>n+n)),r?`rgb${r.length===4?"a":""}(${r.map((n,i)=>i<3?parseInt(n,16):Math.round(parseInt(n,16)/255*1e3)/1e3).join(", ")})`:""}function Eg(t){if(t.type)return t;if(t.charAt(0)==="#")return Eg(Nle(t));const e=t.indexOf("("),r=t.substring(0,e);if(!["rgb","rgba","hsl","hsla","color"].includes(r))throw new Error(_p(9,t));let n=t.substring(e+1,t.length-1),i;if(r==="color"){if(n=n.split(" "),i=n.shift(),n.length===4&&n[3].charAt(0)==="/"&&(n[3]=n[3].slice(1)),!["srgb","display-p3","a98-rgb","prophoto-rgb","rec-2020"].includes(i))throw new Error(_p(10,i))}else n=n.split(",");return n=n.map(a=>parseFloat(a)),{type:r,values:n,colorSpace:i}}const Lle=t=>{const e=Eg(t);return e.values.slice(0,3).map((r,n)=>e.type.includes("hsl")&&n!==0?`${r}%`:r).join(" ")},k1=(t,e)=>{try{return Lle(t)}catch{return t}};function jT(t){const{type:e,colorSpace:r}=t;let{values:n}=t;return e.includes("rgb")?n=n.map((i,a)=>a<3?parseInt(i,10):i):e.includes("hsl")&&(n[1]=`${n[1]}%`,n[2]=`${n[2]}%`),e.includes("color")?n=`${r} ${n.join(" ")}`:n=`${n.join(", ")}`,`${e}(${n})`}function wX(t){t=Eg(t);const{values:e}=t,r=e[0],n=e[1]/100,i=e[2]/100,a=n*Math.min(i,1-i),s=(f,d=(f+r/30)%12)=>i-a*Math.max(Math.min(d-3,9-d,1),-1);let o="rgb";const c=[Math.round(s(0)*255),Math.round(s(8)*255),Math.round(s(4)*255)];return t.type==="hsla"&&(o+="a",c.push(e[3])),jT({type:o,values:c})}function Sk(t){t=Eg(t);let e=t.type==="hsl"||t.type==="hsla"?Eg(wX(t)).values:t.values;return e=e.map(r=>(t.type!=="color"&&(r/=255),r<=.03928?r/12.92:((r+.055)/1.055)**2.4)),Number((.2126*e[0]+.7152*e[1]+.0722*e[2]).toFixed(3))}function Fle(t,e){const r=Sk(t),n=Sk(e);return(Math.max(r,n)+.05)/(Math.min(r,n)+.05)}function qS(t,e){return t=Eg(t),e=VD(e),(t.type==="rgb"||t.type==="hsl")&&(t.type+="a"),t.type==="color"?t.values[3]=`/${e}`:t.values[3]=e,jT(t)}function um(t,e,r){try{return qS(t,e)}catch{return t}}function UT(t,e){if(t=Eg(t),e=VD(e),t.type.includes("hsl"))t.values[2]*=1-e;else if(t.type.includes("rgb")||t.type.includes("color"))for(let r=0;r<3;r+=1)t.values[r]*=1-e;return jT(t)}function co(t,e,r){try{return UT(t,e)}catch{return t}}function VT(t,e){if(t=Eg(t),e=VD(e),t.type.includes("hsl"))t.values[2]+=(100-t.values[2])*e;else if(t.type.includes("rgb"))for(let r=0;r<3;r+=1)t.values[r]+=(255-t.values[r])*e;else if(t.type.includes("color"))for(let r=0;r<3;r+=1)t.values[r]+=(1-t.values[r])*e;return jT(t)}function fo(t,e,r){try{return VT(t,e)}catch{return t}}function Ek(t,e=.15){return Sk(t)>.5?UT(t,e):VT(t,e)}function z2(t,e,r){try{return Ek(t,e)}catch{return t}}const SX=te.createContext(null);function $D(){return te.useContext(SX)}const Ble=typeof Symbol=="function"&&Symbol.for,zle=Ble?Symbol.for("mui.nested"):"__THEME_NESTED__";function jle(t,e){return typeof e=="function"?e(t):{...t,...e}}function Ule(t){const{children:e,theme:r}=t,n=$D(),i=te.useMemo(()=>{const a=n===null?{...r}:jle(n,r);return a!=null&&(a[zle]=n!==null),a},[r,n]);return J.jsx(SX.Provider,{value:i,children:e})}const EX=te.createContext();function Vle({value:t,...e}){return J.jsx(EX.Provider,{value:t??!0,...e})}const Rx=()=>te.useContext(EX)??!1,TX=te.createContext(void 0);function $le({value:t,children:e}){return J.jsx(TX.Provider,{value:t,children:e})}function qle(t){const{theme:e,name:r,props:n}=t;if(!e||!e.components||!e.components[r])return n;const i=e.components[r];return i.defaultProps?Nb(i.defaultProps,n,e.components.mergeClassNameAndStyle):!i.styleOverrides&&!i.variants?Nb(i,n,e.components.mergeClassNameAndStyle):n}function Hle({props:t,name:e}){const r=te.useContext(TX);return qle({props:t,name:e,theme:{components:r}})}let dB=0;function Gle(t){const[e,r]=te.useState(t),n=t||e;return te.useEffect(()=>{e==null&&(dB+=1,r(`mui-${dB}`))},[e]),n}const Wle={...jS},pB=Wle.useId;function Og(t){if(pB!==void 0){const e=pB();return t??e}return Gle(t)}function Xle(t){const e=zT(),r=Og()||"",{modularCssLayers:n}=t;let i="mui.global, mui.components, mui.theme, mui.custom, mui.sx";return!n||e!==null?i="":typeof n=="string"?i=n.replace(/mui(?!\.)/g,i):i=`@layer ${i};`,Tu(()=>{const a=document.querySelector("head");if(!a)return;const s=a.firstChild;if(i){if(s&&s.hasAttribute?.("data-mui-layer-order")&&s.getAttribute("data-mui-layer-order")===r)return;const o=document.createElement("style");o.setAttribute("data-mui-layer-order",r),o.textContent=i,a.prepend(o)}else a.querySelector(`style[data-mui-layer-order="${r}"]`)?.remove()},[i,r]),i?J.jsx(dX,{styles:i}):null}const gB={};function mB(t,e,r,n=!1){return te.useMemo(()=>{const i=t&&e[t]||e;if(typeof r=="function"){const a=r(i),s=t?{...e,[t]:a}:a;return n?()=>s:s}return t?{...e,[t]:r}:{...e,...r}},[t,e,r,n])}function CX(t){const{children:e,theme:r,themeId:n}=t,i=zT(gB),a=$D()||gB,s=mB(n,i,r),o=mB(n,a,r,!0),c=(n?s[n]:s).direction==="rtl",f=Xle(s);return J.jsx(Ule,{theme:o,children:J.jsx(Tx.Provider,{value:s,children:J.jsx(Vle,{value:c,children:J.jsxs($le,{value:n?s[n].components:s.components,children:[f,e]})})})})}const yB={theme:void 0};function Yle(t){let e,r;return function(i){let a=e;return(a===void 0||i.theme!==r)&&(yB.theme=i.theme,a=mX(t(yB)),e=a,r=i.theme),a}}const qD="mode",HD="color-scheme",Zle="data-color-scheme";function Kle(t){const{defaultMode:e="system",defaultLightColorScheme:r="light",defaultDarkColorScheme:n="dark",modeStorageKey:i=qD,colorSchemeStorageKey:a=HD,attribute:s=Zle,colorSchemeNode:o="document.documentElement",nonce:c}=t||{};let f="",d=s;if(s==="class"&&(d=".%s"),s==="data"&&(d="[data-%s]"),d.startsWith(".")){const b=d.substring(1);f+=`${o}.classList.remove('${b}'.replace('%s', light), '${b}'.replace('%s', dark));
      ${o}.classList.add('${b}'.replace('%s', colorScheme));`}const m=d.match(/\[([^[\]]+)\]/);if(m){const[b,x]=m[1].split("=");x||(f+=`${o}.removeAttribute('${b}'.replace('%s', light));
      ${o}.removeAttribute('${b}'.replace('%s', dark));`),f+=`
      ${o}.setAttribute('${b}'.replace('%s', colorScheme), ${x?`${x}.replace('%s', colorScheme)`:'""'});`}else f+=`${o}.setAttribute('${d}', colorScheme);`;return J.jsx("script",{suppressHydrationWarning:!0,nonce:typeof window>"u"?c:"",dangerouslySetInnerHTML:{__html:`(function() {
try {
  let colorScheme = '';
  const mode = localStorage.getItem('${i}') || '${e}';
  const dark = localStorage.getItem('${a}-dark') || '${n}';
  const light = localStorage.getItem('${a}-light') || '${r}';
  if (mode === 'system') {
    // handle system mode
    const mql = window.matchMedia('(prefers-color-scheme: dark)');
    if (mql.matches) {
      colorScheme = dark
    } else {
      colorScheme = light
    }
  }
  if (mode === 'light') {
    colorScheme = light;
  }
  if (mode === 'dark') {
    colorScheme = dark;
  }
  if (colorScheme) {
    ${f}
  }
} catch(e){}})();`}},"mui-color-scheme-init")}function Jle(){}const Qle=({key:t,storageWindow:e})=>(!e&&typeof window<"u"&&(e=window),{get(r){if(typeof window>"u")return;if(!e)return r;let n;try{n=e.localStorage.getItem(t)}catch{}return n||r},set:r=>{if(e)try{e.localStorage.setItem(t,r)}catch{}},subscribe:r=>{if(!e)return Jle;const n=i=>{const a=i.newValue;i.key===t&&r(a)};return e.addEventListener("storage",n),()=>{e.removeEventListener("storage",n)}}});function cA(){}function vB(t){if(typeof window<"u"&&typeof window.matchMedia=="function"&&t==="system")return window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"}function AX(t,e){if(t.mode==="light"||t.mode==="system"&&t.systemMode==="light")return e("light");if(t.mode==="dark"||t.mode==="system"&&t.systemMode==="dark")return e("dark")}function eue(t){return AX(t,e=>{if(e==="light")return t.lightColorScheme;if(e==="dark")return t.darkColorScheme})}function tue(t){const{defaultMode:e="light",defaultLightColorScheme:r,defaultDarkColorScheme:n,supportedColorSchemes:i=[],modeStorageKey:a=qD,colorSchemeStorageKey:s=HD,storageWindow:o=typeof window>"u"?void 0:window,storageManager:c=Qle,noSsr:f=!1}=t,d=i.join(","),m=i.length>1,b=te.useMemo(()=>c?.({key:a,storageWindow:o}),[c,a,o]),x=te.useMemo(()=>c?.({key:`${s}-light`,storageWindow:o}),[c,s,o]),E=te.useMemo(()=>c?.({key:`${s}-dark`,storageWindow:o}),[c,s,o]),[T,A]=te.useState(()=>{const W=b?.get(e)||e,X=x?.get(r)||r,oe=E?.get(n)||n;return{mode:W,systemMode:vB(W),lightColorScheme:X,darkColorScheme:oe}}),[M,F]=te.useState(f||!m);te.useEffect(()=>{F(!0)},[]);const N=eue(T),O=te.useCallback(W=>{A(X=>{if(W===X.mode)return X;const oe=W??e;return b?.set(oe),{...X,mode:oe,systemMode:vB(oe)}})},[b,e]),U=te.useCallback(W=>{W?typeof W=="string"?W&&!d.includes(W)?console.error(`\`${W}\` does not exist in \`theme.colorSchemes\`.`):A(X=>{const oe={...X};return AX(X,Q=>{Q==="light"&&(x?.set(W),oe.lightColorScheme=W),Q==="dark"&&(E?.set(W),oe.darkColorScheme=W)}),oe}):A(X=>{const oe={...X},Q=W.light===null?r:W.light,G=W.dark===null?n:W.dark;return Q&&(d.includes(Q)?(oe.lightColorScheme=Q,x?.set(Q)):console.error(`\`${Q}\` does not exist in \`theme.colorSchemes\`.`)),G&&(d.includes(G)?(oe.darkColorScheme=G,E?.set(G)):console.error(`\`${G}\` does not exist in \`theme.colorSchemes\`.`)),oe}):A(X=>(x?.set(r),E?.set(n),{...X,lightColorScheme:r,darkColorScheme:n}))},[d,x,E,r,n]),j=te.useCallback(W=>{T.mode==="system"&&A(X=>{const oe=W?.matches?"dark":"light";return X.systemMode===oe?X:{...X,systemMode:oe}})},[T.mode]),H=te.useRef(j);return H.current=j,te.useEffect(()=>{if(typeof window.matchMedia!="function"||!m)return;const W=(...oe)=>H.current(...oe),X=window.matchMedia("(prefers-color-scheme: dark)");return X.addListener(W),W(X),()=>{X.removeListener(W)}},[m]),te.useEffect(()=>{if(m){const W=b?.subscribe(Q=>{(!Q||["light","dark","system"].includes(Q))&&O(Q||e)})||cA,X=x?.subscribe(Q=>{(!Q||d.match(Q))&&U({light:Q})})||cA,oe=E?.subscribe(Q=>{(!Q||d.match(Q))&&U({dark:Q})})||cA;return()=>{W(),X(),oe()}}},[U,O,d,e,o,m,b,x,E]),{...T,mode:M?T.mode:void 0,systemMode:M?T.systemMode:void 0,colorScheme:M?N:void 0,setMode:O,setColorScheme:U}}const rue="*{-webkit-transition:none!important;-moz-transition:none!important;-o-transition:none!important;-ms-transition:none!important;transition:none!important}";function nue(t){const{themeId:e,theme:r={},modeStorageKey:n=qD,colorSchemeStorageKey:i=HD,disableTransitionOnChange:a=!1,defaultColorScheme:s,resolveTheme:o}=t,c={allColorSchemes:[],colorScheme:void 0,darkColorScheme:void 0,lightColorScheme:void 0,mode:void 0,setColorScheme:()=>{},setMode:()=>{},systemMode:void 0},f=te.createContext(void 0),d=()=>te.useContext(f)||c,m={},b={};function x(M){const{children:F,theme:N,modeStorageKey:O=n,colorSchemeStorageKey:U=i,disableTransitionOnChange:j=a,storageManager:H,storageWindow:W=typeof window>"u"?void 0:window,documentNode:X=typeof document>"u"?void 0:document,colorSchemeNode:oe=typeof document>"u"?void 0:document.documentElement,disableNestedContext:Q=!1,disableStyleSheetGeneration:G=!1,defaultMode:ae="system",forceThemeRerender:se=!1,noSsr:fe}=M,_e=te.useRef(!1),Le=$D(),ye=te.useContext(f),Te=!!ye&&!Q,Ie=te.useMemo(()=>N||(typeof r=="function"?r():r),[N]),Me=Ie[e],de=Me||Ie,{colorSchemes:Se=m,components:we=b,cssVarPrefix:De}=de,Fe=Object.keys(Se).filter(ot=>!!Se[ot]).join(","),Xe=te.useMemo(()=>Fe.split(","),[Fe]),Be=typeof s=="string"?s:s.light,st=typeof s=="string"?s:s.dark,Qe=Se[Be]&&Se[st]?ae:Se[de.defaultColorScheme]?.palette?.mode||de.palette?.mode,{mode:it,setMode:be,systemMode:Ot,lightColorScheme:at,darkColorScheme:$e,colorScheme:Xt,setColorScheme:$t}=tue({supportedColorSchemes:Xe,defaultLightColorScheme:Be,defaultDarkColorScheme:st,modeStorageKey:O,colorSchemeStorageKey:U,defaultMode:Qe,storageManager:H,storageWindow:W,noSsr:fe});let cr=it,_t=Xt;Te&&(cr=ye.mode,_t=ye.colorScheme);let gr=_t||de.defaultColorScheme;de.vars&&!se&&(gr=de.defaultColorScheme);const mr=te.useMemo(()=>{const ot=de.generateThemeVars?.()||de.vars,Ce={...de,components:we,colorSchemes:Se,cssVarPrefix:De,vars:ot};if(typeof Ce.generateSpacing=="function"&&(Ce.spacing=Ce.generateSpacing()),gr){const xe=Se[gr];xe&&typeof xe=="object"&&Object.keys(xe).forEach(je=>{xe[je]&&typeof xe[je]=="object"?Ce[je]={...Ce[je],...xe[je]}:Ce[je]=xe[je]})}return o?o(Ce):Ce},[de,gr,we,Se,De]),ar=de.colorSchemeSelector;Tu(()=>{if(_t&&oe&&ar&&ar!=="media"){const ot=ar;let Ce=ar;if(ot==="class"&&(Ce=".%s"),ot==="data"&&(Ce="[data-%s]"),ot?.startsWith("data-")&&!ot.includes("%s")&&(Ce=`[${ot}="%s"]`),Ce.startsWith("."))oe.classList.remove(...Xe.map(xe=>Ce.substring(1).replace("%s",xe))),oe.classList.add(Ce.substring(1).replace("%s",_t));else{const xe=Ce.replace("%s",_t).match(/\[([^\]]+)\]/);if(xe){const[je,qe]=xe[1].split("=");qe||Xe.forEach(Ge=>{oe.removeAttribute(je.replace(_t,Ge))}),oe.setAttribute(je,qe?qe.replace(/"|'/g,""):"")}else oe.setAttribute(Ce,_t)}}},[_t,ar,oe,Xe]),te.useEffect(()=>{let ot;if(j&&_e.current&&X){const Ce=X.createElement("style");Ce.appendChild(X.createTextNode(rue)),X.head.appendChild(Ce),window.getComputedStyle(X.body),ot=setTimeout(()=>{X.head.removeChild(Ce)},1)}return()=>{clearTimeout(ot)}},[_t,j,X]),te.useEffect(()=>(_e.current=!0,()=>{_e.current=!1}),[]);const Cr=te.useMemo(()=>({allColorSchemes:Xe,colorScheme:_t,darkColorScheme:$e,lightColorScheme:at,mode:cr,setColorScheme:$t,setMode:be,systemMode:Ot}),[Xe,_t,$e,at,cr,$t,be,Ot,mr.colorSchemeSelector]);let Er=!0;(G||de.cssVariables===!1||Te&&Le?.cssVarPrefix===De)&&(Er=!1);const Jt=J.jsxs(te.Fragment,{children:[J.jsx(CX,{themeId:Me?e:void 0,theme:mr,children:F}),Er&&J.jsx(sX,{styles:mr.generateStyleSheets?.()||[]})]});return Te?Jt:J.jsx(f.Provider,{value:Cr,children:Jt})}const E=typeof s=="string"?s:s.light,T=typeof s=="string"?s:s.dark;return{CssVarsProvider:x,useColorScheme:d,getInitColorSchemeScript:M=>Kle({colorSchemeStorageKey:i,defaultLightColorScheme:E,defaultDarkColorScheme:T,modeStorageKey:n,...M})}}function iue(t=""){function e(...n){if(!n.length)return"";const i=n[0];return typeof i=="string"&&!i.match(/(#|\(|\)|(-?(\d*\.)?\d+)(px|em|%|ex|ch|rem|vw|vh|vmin|vmax|cm|mm|in|pt|pc))|^(-?(\d*\.)?\d+)$|(\d+ \d+ \d+)/)?`, var(--${t?`${t}-`:""}${i}${e(...n.slice(1))})`:`, ${i}`}return(n,...i)=>`var(--${t?`${t}-`:""}${n}${e(...i)})`}const _B=(t,e,r,n=[])=>{let i=t;e.forEach((a,s)=>{s===e.length-1?Array.isArray(i)?i[Number(a)]=r:i&&typeof i=="object"&&(i[a]=r):i&&typeof i=="object"&&(i[a]||(i[a]=n.includes(a)?[]:{}),i=i[a])})},aue=(t,e,r)=>{function n(i,a=[],s=[]){Object.entries(i).forEach(([o,c])=>{(!r||r&&!r([...a,o]))&&c!=null&&(typeof c=="object"&&Object.keys(c).length>0?n(c,[...a,o],Array.isArray(c)?[...s,o]:s):e([...a,o],c,s))})}n(t)},oue=(t,e)=>typeof e=="number"?["lineHeight","fontWeight","opacity","zIndex"].some(n=>t.includes(n))||t[t.length-1].toLowerCase().includes("opacity")?e:`${e}px`:e;function fA(t,e){const{prefix:r,shouldSkipGeneratingVar:n}=e||{},i={},a={},s={};return aue(t,(o,c,f)=>{if((typeof c=="string"||typeof c=="number")&&(!n||!n(o,c))){const d=`--${r?`${r}-`:""}${o.join("-")}`,m=oue(o,c);Object.assign(i,{[d]:m}),_B(a,o,`var(${d})`,f),_B(s,o,`var(${d}, ${m})`,f)}},o=>o[0]==="vars"),{css:i,vars:a,varsWithDefaults:s}}function sue(t,e={}){const{getSelector:r=M,disableCssColorScheme:n,colorSchemeSelector:i,enableContrastVars:a}=e,{colorSchemes:s={},components:o,defaultColorScheme:c="light",...f}=t,{vars:d,css:m,varsWithDefaults:b}=fA(f,e);let x=b;const E={},{[c]:T,...A}=s;if(Object.entries(A||{}).forEach(([O,U])=>{const{vars:j,css:H,varsWithDefaults:W}=fA(U,e);x=Qu(x,W),E[O]={css:H,vars:j}}),T){const{css:O,vars:U,varsWithDefaults:j}=fA(T,e);x=Qu(x,j),E[c]={css:O,vars:U}}function M(O,U){let j=i;if(i==="class"&&(j=".%s"),i==="data"&&(j="[data-%s]"),i?.startsWith("data-")&&!i.includes("%s")&&(j=`[${i}="%s"]`),O){if(j==="media")return t.defaultColorScheme===O?":root":{[`@media (prefers-color-scheme: ${s[O]?.palette?.mode||O})`]:{":root":U}};if(j)return t.defaultColorScheme===O?`:root, ${j.replace("%s",String(O))}`:j.replace("%s",String(O))}return":root"}return{vars:x,generateThemeVars:()=>{let O={...d};return Object.entries(E).forEach(([,{vars:U}])=>{O=Qu(O,U)}),O},generateStyleSheets:()=>{const O=[],U=t.defaultColorScheme||"light";function j(X,oe){Object.keys(oe).length&&O.push(typeof X=="string"?{[X]:{...oe}}:X)}j(r(void 0,{...m}),m);const{[U]:H,...W}=E;if(H){const{css:X}=H,oe=s[U]?.palette?.mode,Q=!n&&oe?{colorScheme:oe,...X}:{...X};j(r(U,{...Q}),Q)}return Object.entries(W).forEach(([X,{css:oe}])=>{const Q=s[X]?.palette?.mode,G=!n&&Q?{colorScheme:Q,...oe}:{...oe};j(r(X,{...G}),G)}),a&&O.push({":root":{"--__l-threshold":"0.7","--__l":"clamp(0, (l / var(--__l-threshold) - 1) * -infinity, 1)","--__a":"clamp(0.87, (l / var(--__l-threshold) - 1) * -infinity, 1)"}}),O}}}function lue(t){return function(r){return t==="media"?`@media (prefers-color-scheme: ${r})`:t?t.startsWith("data-")&&!t.includes("%s")?`[${t}="${r}"] &`:t==="class"?`.${r} &`:t==="data"?`[data-${r}] &`:`${t.replace("%s",r)} &`:"&"}}function mi(t,e,r=void 0){const n={};for(const i in t){const a=t[i];let s="",o=!0;for(let c=0;c<a.length;c+=1){const f=a[c];f&&(s+=(o===!0?"":" ")+e(f),o=!1,r&&r[f]&&(s+=" "+r[f]))}n[i]=s}return n}function ob(t,e){return te.isValidElement(t)&&e.indexOf(t.type.muiName??t.type?._payload?.value?.muiName)!==-1}const uue=(t,e)=>t.filter(r=>e.includes(r)),f_=(t,e,r)=>{const n=t.keys[0];Array.isArray(e)?e.forEach((i,a)=>{r((s,o)=>{a<=t.keys.length-1&&(a===0?Object.assign(s,o):s[t.up(t.keys[a])]=o)},i)}):e&&typeof e=="object"?(Object.keys(e).length>t.keys.length?t.keys:uue(t.keys,Object.keys(e))).forEach(a=>{if(t.keys.includes(a)){const s=e[a];s!==void 0&&r((o,c)=>{n===a?Object.assign(o,c):o[t.up(a)]=c},s)}}):(typeof e=="number"||typeof e=="string")&&r((i,a)=>{Object.assign(i,a)},e)};function HS(t){return`--Grid-${t}Spacing`}function $T(t){return`--Grid-parent-${t}Spacing`}const bB="--Grid-columns",E0="--Grid-parent-columns",cue=({theme:t,ownerState:e})=>{const r={};return f_(t.breakpoints,e.size,(n,i)=>{let a={};i==="grow"&&(a={flexBasis:0,flexGrow:1,maxWidth:"100%"}),i==="auto"&&(a={flexBasis:"auto",flexGrow:0,flexShrink:0,maxWidth:"none",width:"auto"}),typeof i=="number"&&(a={flexGrow:0,flexBasis:"auto",width:`calc(100% * ${i} / var(${E0}) - (var(${E0}) - ${i}) * (var(${$T("column")}) / var(${E0})))`}),n(r,a)}),r},fue=({theme:t,ownerState:e})=>{const r={};return f_(t.breakpoints,e.offset,(n,i)=>{let a={};i==="auto"&&(a={marginLeft:"auto"}),typeof i=="number"&&(a={marginLeft:i===0?"0px":`calc(100% * ${i} / var(${E0}) + var(${$T("column")}) * ${i} / var(${E0}))`}),n(r,a)}),r},hue=({theme:t,ownerState:e})=>{if(!e.container)return{};const r={[bB]:12};return f_(t.breakpoints,e.columns,(n,i)=>{const a=i??12;n(r,{[bB]:a,"> *":{[E0]:a}})}),r},due=({theme:t,ownerState:e})=>{if(!e.container)return{};const r={};return f_(t.breakpoints,e.rowSpacing,(n,i)=>{const a=typeof i=="string"?i:t.spacing?.(i);n(r,{[HS("row")]:a,"> *":{[$T("row")]:a}})}),r},pue=({theme:t,ownerState:e})=>{if(!e.container)return{};const r={};return f_(t.breakpoints,e.columnSpacing,(n,i)=>{const a=typeof i=="string"?i:t.spacing?.(i);n(r,{[HS("column")]:a,"> *":{[$T("column")]:a}})}),r},gue=({theme:t,ownerState:e})=>{if(!e.container)return{};const r={};return f_(t.breakpoints,e.direction,(n,i)=>{n(r,{flexDirection:i})}),r},mue=({ownerState:t})=>({minWidth:0,boxSizing:"border-box",...t.container&&{display:"flex",flexWrap:"wrap",...t.wrap&&t.wrap!=="wrap"&&{flexWrap:t.wrap},gap:`var(${HS("row")}) var(${HS("column")})`}}),yue=t=>{const e=[];return Object.entries(t).forEach(([r,n])=>{n!==!1&&n!==void 0&&e.push(`grid-${r}-${String(n)}`)}),e},vue=(t,e="xs")=>{function r(n){return n===void 0?!1:typeof n=="string"&&!Number.isNaN(Number(n))||typeof n=="number"&&n>0}if(r(t))return[`spacing-${e}-${String(t)}`];if(typeof t=="object"&&!Array.isArray(t)){const n=[];return Object.entries(t).forEach(([i,a])=>{r(a)&&n.push(`spacing-${i}-${String(a)}`)}),n}return[]},_ue=t=>t===void 0?[]:typeof t=="object"?Object.entries(t).map(([e,r])=>`direction-${e}-${r}`):[`direction-xs-${String(t)}`];function bue(t,e){t.item!==void 0&&delete t.item,t.zeroMinWidth!==void 0&&delete t.zeroMinWidth,e.keys.forEach(r=>{t[r]!==void 0&&delete t[r]})}const xue=BT(),wue=_y("div",{name:"MuiGrid",slot:"Root"});function Sue(t){return Rle({props:t,name:"MuiGrid",defaultTheme:xue})}function Eue(t={}){const{createStyledComponent:e=wue,useThemeProps:r=Sue,useTheme:n=kx,componentName:i="MuiGrid"}=t,a=(f,d)=>{const{container:m,direction:b,spacing:x,wrap:E,size:T}=f,A={root:["root",m&&"container",E!=="wrap"&&`wrap-xs-${String(E)}`,..._ue(b),...yue(T),...m?vue(x,d.breakpoints.keys[0]):[]]};return mi(A,M=>gi(i,M),{})};function s(f,d,m=()=>!0){const b={};return f===null||(Array.isArray(f)?f.forEach((x,E)=>{x!==null&&m(x)&&d.keys[E]&&(b[d.keys[E]]=x)}):typeof f=="object"?Object.keys(f).forEach(x=>{const E=f[x];E!=null&&m(E)&&(b[x]=E)}):b[d.keys[0]]=f),b}const o=e(hue,pue,due,cue,gue,mue,fue),c=te.forwardRef(function(d,m){const b=n(),x=r(d),E=jD(x);bue(E,b.breakpoints);const{className:T,children:A,columns:M=12,container:F=!1,component:N="div",direction:O="row",wrap:U="wrap",size:j={},offset:H={},spacing:W=0,rowSpacing:X=W,columnSpacing:oe=W,unstable_level:Q=0,...G}=E,ae=s(j,b.breakpoints,Me=>Me!==!1),se=s(H,b.breakpoints),fe=d.columns??(Q?void 0:M),_e=d.spacing??(Q?void 0:W),Le=d.rowSpacing??d.spacing??(Q?void 0:X),ye=d.columnSpacing??d.spacing??(Q?void 0:oe),Te={...E,level:Q,columns:fe,container:F,direction:O,wrap:U,spacing:_e,rowSpacing:Le,columnSpacing:ye,size:ae,offset:se},Ie=a(Te,b);return J.jsx(o,{ref:m,as:N,ownerState:Te,className:An(Ie.root,T),...G,children:te.Children.map(A,Me=>te.isValidElement(Me)&&ob(Me,["Grid"])&&F&&Me.props.container?te.cloneElement(Me,{unstable_level:Me.props?.unstable_level??Q+1}):Me)})});return c.muiName="Grid",c}const Lb={black:"#000",white:"#fff"},Tue={50:"#fafafa",100:"#f5f5f5",200:"#eeeeee",300:"#e0e0e0",400:"#bdbdbd",500:"#9e9e9e",600:"#757575",700:"#616161",800:"#424242",900:"#212121",A100:"#f5f5f5",A200:"#eeeeee",A400:"#bdbdbd",A700:"#616161"},lv={50:"#f3e5f5",200:"#ce93d8",300:"#ba68c8",400:"#ab47bc",500:"#9c27b0",700:"#7b1fa2"},uv={300:"#e57373",400:"#ef5350",500:"#f44336",700:"#d32f2f",800:"#c62828"},Q_={300:"#ffb74d",400:"#ffa726",500:"#ff9800",700:"#f57c00",900:"#e65100"},cv={50:"#e3f2fd",200:"#90caf9",400:"#42a5f5",700:"#1976d2",800:"#1565c0"},fv={300:"#4fc3f7",400:"#29b6f6",500:"#03a9f4",700:"#0288d1",900:"#01579b"},hv={300:"#81c784",400:"#66bb6a",500:"#4caf50",700:"#388e3c",800:"#2e7d32",900:"#1b5e20"};function IX(){return{text:{primary:"rgba(0, 0, 0, 0.87)",secondary:"rgba(0, 0, 0, 0.6)",disabled:"rgba(0, 0, 0, 0.38)"},divider:"rgba(0, 0, 0, 0.12)",background:{paper:Lb.white,default:Lb.white},action:{active:"rgba(0, 0, 0, 0.54)",hover:"rgba(0, 0, 0, 0.04)",hoverOpacity:.04,selected:"rgba(0, 0, 0, 0.08)",selectedOpacity:.08,disabled:"rgba(0, 0, 0, 0.26)",disabledBackground:"rgba(0, 0, 0, 0.12)",disabledOpacity:.38,focus:"rgba(0, 0, 0, 0.12)",focusOpacity:.12,activatedOpacity:.12}}}const PX=IX();function kX(){return{text:{primary:Lb.white,secondary:"rgba(255, 255, 255, 0.7)",disabled:"rgba(255, 255, 255, 0.5)",icon:"rgba(255, 255, 255, 0.5)"},divider:"rgba(255, 255, 255, 0.12)",background:{paper:"#121212",default:"#121212"},action:{active:Lb.white,hover:"rgba(255, 255, 255, 0.08)",hoverOpacity:.08,selected:"rgba(255, 255, 255, 0.16)",selectedOpacity:.16,disabled:"rgba(255, 255, 255, 0.3)",disabledBackground:"rgba(255, 255, 255, 0.12)",disabledOpacity:.38,focus:"rgba(255, 255, 255, 0.12)",focusOpacity:.12,activatedOpacity:.24}}}const Tk=kX();function xB(t,e,r,n){const i=n.light||n,a=n.dark||n*1.5;t[e]||(t.hasOwnProperty(r)?t[e]=t[r]:e==="light"?t.light=VT(t.main,i):e==="dark"&&(t.dark=UT(t.main,a)))}function wB(t,e,r,n,i){const a=i.light||i,s=i.dark||i*1.5;e[r]||(e.hasOwnProperty(n)?e[r]=e[n]:r==="light"?e.light=`color-mix(in ${t}, ${e.main}, #fff ${(a*100).toFixed(0)}%)`:r==="dark"&&(e.dark=`color-mix(in ${t}, ${e.main}, #000 ${(s*100).toFixed(0)}%)`))}function Cue(t="light"){return t==="dark"?{main:cv[200],light:cv[50],dark:cv[400]}:{main:cv[700],light:cv[400],dark:cv[800]}}function Aue(t="light"){return t==="dark"?{main:lv[200],light:lv[50],dark:lv[400]}:{main:lv[500],light:lv[300],dark:lv[700]}}function Iue(t="light"){return t==="dark"?{main:uv[500],light:uv[300],dark:uv[700]}:{main:uv[700],light:uv[400],dark:uv[800]}}function Pue(t="light"){return t==="dark"?{main:fv[400],light:fv[300],dark:fv[700]}:{main:fv[700],light:fv[500],dark:fv[900]}}function kue(t="light"){return t==="dark"?{main:hv[400],light:hv[300],dark:hv[700]}:{main:hv[800],light:hv[500],dark:hv[900]}}function Rue(t="light"){return t==="dark"?{main:Q_[400],light:Q_[300],dark:Q_[700]}:{main:"#ed6c02",light:Q_[500],dark:Q_[900]}}function Mue(t){return`oklch(from ${t} var(--__l) 0 h / var(--__a))`}function GD(t){const{mode:e="light",contrastThreshold:r=3,tonalOffset:n=.2,colorSpace:i,...a}=t,s=t.primary||Cue(e),o=t.secondary||Aue(e),c=t.error||Iue(e),f=t.info||Pue(e),d=t.success||kue(e),m=t.warning||Rue(e);function b(A){return i?Mue(A):Fle(A,Tk.text.primary)>=r?Tk.text.primary:PX.text.primary}const x=({color:A,name:M,mainShade:F=500,lightShade:N=300,darkShade:O=700})=>{if(A={...A},!A.main&&A[F]&&(A.main=A[F]),!A.hasOwnProperty("main"))throw new Error(_p(11,M?` (${M})`:"",F));if(typeof A.main!="string")throw new Error(_p(12,M?` (${M})`:"",JSON.stringify(A.main)));return i?(wB(i,A,"light",N,n),wB(i,A,"dark",O,n)):(xB(A,"light",N,n),xB(A,"dark",O,n)),A.contrastText||(A.contrastText=b(A.main)),A};let E;return e==="light"?E=IX():e==="dark"&&(E=kX()),Qu({common:{...Lb},mode:e,primary:x({color:s,name:"primary"}),secondary:x({color:o,name:"secondary",mainShade:"A400",lightShade:"A200",darkShade:"A700"}),error:x({color:c,name:"error"}),warning:x({color:m,name:"warning"}),info:x({color:f,name:"info"}),success:x({color:d,name:"success"}),grey:Tue,contrastThreshold:r,getContrastText:b,augmentColor:x,tonalOffset:n,...E},a)}function Due(t){const e={};return Object.entries(t).forEach(n=>{const[i,a]=n;typeof a=="object"&&(e[i]=`${a.fontStyle?`${a.fontStyle} `:""}${a.fontVariant?`${a.fontVariant} `:""}${a.fontWeight?`${a.fontWeight} `:""}${a.fontStretch?`${a.fontStretch} `:""}${a.fontSize||""}${a.lineHeight?`/${a.lineHeight} `:""}${a.fontFamily||""}`)}),e}function Oue(t,e){return{toolbar:{minHeight:56,[t.up("xs")]:{"@media (orientation: landscape)":{minHeight:48}},[t.up("sm")]:{minHeight:64}},...e}}function Nue(t){return Math.round(t*1e5)/1e5}const SB={textTransform:"uppercase"},EB='"Roboto", "Helvetica", "Arial", sans-serif';function RX(t,e){const{fontFamily:r=EB,fontSize:n=14,fontWeightLight:i=300,fontWeightRegular:a=400,fontWeightMedium:s=500,fontWeightBold:o=700,htmlFontSize:c=16,allVariants:f,pxToRem:d,...m}=typeof e=="function"?e(t):e,b=n/14,x=d||(A=>`${A/c*b}rem`),E=(A,M,F,N,O)=>({fontFamily:r,fontWeight:A,fontSize:x(M),lineHeight:F,...r===EB?{letterSpacing:`${Nue(N/M)}em`}:{},...O,...f}),T={h1:E(i,96,1.167,-1.5),h2:E(i,60,1.2,-.5),h3:E(a,48,1.167,0),h4:E(a,34,1.235,.25),h5:E(a,24,1.334,0),h6:E(s,20,1.6,.15),subtitle1:E(a,16,1.75,.15),subtitle2:E(s,14,1.57,.1),body1:E(a,16,1.5,.15),body2:E(a,14,1.43,.15),button:E(s,14,1.75,.4,SB),caption:E(a,12,1.66,.4),overline:E(a,12,2.66,1,SB),inherit:{fontFamily:"inherit",fontWeight:"inherit",fontSize:"inherit",lineHeight:"inherit",letterSpacing:"inherit"}};return Qu({htmlFontSize:c,pxToRem:x,fontFamily:r,fontSize:n,fontWeightLight:i,fontWeightRegular:a,fontWeightMedium:s,fontWeightBold:o,...T},m,{clone:!1})}const Lue=.2,Fue=.14,Bue=.12;function ss(...t){return[`${t[0]}px ${t[1]}px ${t[2]}px ${t[3]}px rgba(0,0,0,${Lue})`,`${t[4]}px ${t[5]}px ${t[6]}px ${t[7]}px rgba(0,0,0,${Fue})`,`${t[8]}px ${t[9]}px ${t[10]}px ${t[11]}px rgba(0,0,0,${Bue})`].join(",")}const zue=["none",ss(0,2,1,-1,0,1,1,0,0,1,3,0),ss(0,3,1,-2,0,2,2,0,0,1,5,0),ss(0,3,3,-2,0,3,4,0,0,1,8,0),ss(0,2,4,-1,0,4,5,0,0,1,10,0),ss(0,3,5,-1,0,5,8,0,0,1,14,0),ss(0,3,5,-1,0,6,10,0,0,1,18,0),ss(0,4,5,-2,0,7,10,1,0,2,16,1),ss(0,5,5,-3,0,8,10,1,0,3,14,2),ss(0,5,6,-3,0,9,12,1,0,3,16,2),ss(0,6,6,-3,0,10,14,1,0,4,18,3),ss(0,6,7,-4,0,11,15,1,0,4,20,3),ss(0,7,8,-4,0,12,17,2,0,5,22,4),ss(0,7,8,-4,0,13,19,2,0,5,24,4),ss(0,7,9,-4,0,14,21,2,0,5,26,4),ss(0,8,9,-5,0,15,22,2,0,6,28,5),ss(0,8,10,-5,0,16,24,2,0,6,30,5),ss(0,8,11,-5,0,17,26,2,0,6,32,5),ss(0,9,11,-5,0,18,28,2,0,7,34,6),ss(0,9,12,-6,0,19,29,2,0,7,36,6),ss(0,10,13,-6,0,20,31,3,0,8,38,7),ss(0,10,13,-6,0,21,33,3,0,8,40,7),ss(0,10,14,-6,0,22,35,3,0,8,42,7),ss(0,11,14,-7,0,23,36,3,0,9,44,8),ss(0,11,15,-7,0,24,38,3,0,9,46,8)],jue={easeInOut:"cubic-bezier(0.4, 0, 0.2, 1)",easeOut:"cubic-bezier(0.0, 0, 0.2, 1)",easeIn:"cubic-bezier(0.4, 0, 1, 1)",sharp:"cubic-bezier(0.4, 0, 0.6, 1)"},MX={shortest:150,shorter:200,short:250,standard:300,complex:375,enteringScreen:225,leavingScreen:195};function TB(t){return`${Math.round(t)}ms`}function Uue(t){if(!t)return 0;const e=t/36;return Math.min(Math.round((4+15*e**.25+e/5)*10),3e3)}function Vue(t){const e={...jue,...t.easing},r={...MX,...t.duration};return{getAutoHeightDuration:Uue,create:(i=["all"],a={})=>{const{duration:s=r.standard,easing:o=e.easeInOut,delay:c=0,...f}=a;return(Array.isArray(i)?i:[i]).map(d=>`${d} ${typeof s=="string"?s:TB(s)} ${o} ${typeof c=="string"?c:TB(c)}`).join(",")},...t,easing:e,duration:r}}const $ue={mobileStepper:1e3,fab:1050,speedDial:1050,appBar:1100,drawer:1200,modal:1300,snackbar:1400,tooltip:1500};function que(t){return cd(t)||typeof t>"u"||typeof t=="string"||typeof t=="boolean"||typeof t=="number"||Array.isArray(t)}function DX(t={}){const e={...t};function r(n){const i=Object.entries(n);for(let a=0;a<i.length;a++){const[s,o]=i[a];!que(o)||s.startsWith("unstable_")?delete n[s]:cd(o)&&(n[s]={...o},r(n[s]))}}return r(e),`import { unstable_createBreakpoints as createBreakpoints, createTransitions } from '@mui/material/styles';

const theme = ${JSON.stringify(e,null,2)};

theme.breakpoints = createBreakpoints(theme.breakpoints || {});
theme.transitions = createTransitions(theme.transitions || {});

export default theme;`}function CB(t){return typeof t=="number"?`${(t*100).toFixed(0)}%`:`calc((${t}) * 100%)`}const Hue=t=>{if(!Number.isNaN(+t))return+t;const e=t.match(/\d*\.?\d+/g);if(!e)return 0;let r=0;for(let n=0;n<e.length;n+=1)r+=+e[n];return r};function Gue(t){Object.assign(t,{alpha(e,r){const n=this||t;return n.colorSpace?`oklch(from ${e} l c h / ${typeof r=="string"?`calc(${r})`:r})`:n.vars?`rgba(${e.replace(/var\(--([^,\s)]+)(?:,[^)]+)?\)+/g,"var(--$1Channel)")} / ${typeof r=="string"?`calc(${r})`:r})`:qS(e,Hue(r))},lighten(e,r){const n=this||t;return n.colorSpace?`color-mix(in ${n.colorSpace}, ${e}, #fff ${CB(r)})`:VT(e,r)},darken(e,r){const n=this||t;return n.colorSpace?`color-mix(in ${n.colorSpace}, ${e}, #000 ${CB(r)})`:UT(e,r)}})}function Ck(t={},...e){const{breakpoints:r,mixins:n={},spacing:i,palette:a={},transitions:s={},typography:o={},shape:c,colorSpace:f,...d}=t;if(t.vars&&t.generateThemeVars===void 0)throw new Error(_p(20));const m=GD({...a,colorSpace:f}),b=BT(t);let x=Qu(b,{mixins:Oue(b.breakpoints,n),palette:m,shadows:zue.slice(),typography:RX(m,o),transitions:Vue(s),zIndex:{...$ue}});return x=Qu(x,d),x=e.reduce((E,T)=>Qu(E,T),x),x.unstable_sxConfig={...Px,...d?.unstable_sxConfig},x.unstable_sx=function(T){return Sg({sx:T,theme:this})},x.toRuntimeSource=DX,Gue(x),x}function Ak(t){let e;return t<1?e=5.11916*t**2:e=4.5*Math.log(t+1)+2,Math.round(e*10)/1e3}const Wue=[...Array(25)].map((t,e)=>{if(e===0)return"none";const r=Ak(e);return`linear-gradient(rgba(255 255 255 / ${r}), rgba(255 255 255 / ${r}))`});function OX(t){return{inputPlaceholder:t==="dark"?.5:.42,inputUnderline:t==="dark"?.7:.42,switchTrackDisabled:t==="dark"?.2:.12,switchTrack:t==="dark"?.3:.38}}function NX(t){return t==="dark"?Wue:[]}function Xue(t){const{palette:e={mode:"light"},opacity:r,overlays:n,colorSpace:i,...a}=t,s=GD({...e,colorSpace:i});return{palette:s,opacity:{...OX(s.mode),...r},overlays:n||NX(s.mode),...a}}function Yue(t){return!!t[0].match(/(cssVarPrefix|colorSchemeSelector|modularCssLayers|rootSelector|typography|mixins|breakpoints|direction|transitions)/)||!!t[0].match(/sxConfig$/)||t[0]==="palette"&&!!t[1]?.match(/(mode|contrastThreshold|tonalOffset)/)}const Zue=t=>[...[...Array(25)].map((e,r)=>`--${t?`${t}-`:""}overlays-${r}`),`--${t?`${t}-`:""}palette-AppBar-darkBg`,`--${t?`${t}-`:""}palette-AppBar-darkColor`],Kue=t=>(e,r)=>{const n=t.rootSelector||":root",i=t.colorSchemeSelector;let a=i;if(i==="class"&&(a=".%s"),i==="data"&&(a="[data-%s]"),i?.startsWith("data-")&&!i.includes("%s")&&(a=`[${i}="%s"]`),t.defaultColorScheme===e){if(e==="dark"){const s={};return Zue(t.cssVarPrefix).forEach(o=>{s[o]=r[o],delete r[o]}),a==="media"?{[n]:r,"@media (prefers-color-scheme: dark)":{[n]:s}}:a?{[a.replace("%s",e)]:s,[`${n}, ${a.replace("%s",e)}`]:r}:{[n]:{...r,...s}}}if(a&&a!=="media")return`${n}, ${a.replace("%s",String(e))}`}else if(e){if(a==="media")return{[`@media (prefers-color-scheme: ${String(e)})`]:{[n]:r}};if(a)return a.replace("%s",String(e))}return n};function Jue(t,e){e.forEach(r=>{t[r]||(t[r]={})})}function Ur(t,e,r){!t[e]&&r&&(t[e]=r)}function R1(t){return typeof t!="string"||!t.startsWith("hsl")?t:wX(t)}function Zd(t,e){`${e}Channel`in t||(t[`${e}Channel`]=k1(R1(t[e])))}function Que(t){return typeof t=="number"?`${t}px`:typeof t=="string"||typeof t=="function"||Array.isArray(t)?t:"8px"}const ed=t=>{try{return t()}catch{}},ece=(t="mui")=>iue(t);function hA(t,e,r,n,i){if(!r)return;r=r===!0?{}:r;const a=i==="dark"?"dark":"light";if(!n){e[i]=Xue({...r,palette:{mode:a,...r?.palette},colorSpace:t});return}const{palette:s,...o}=Ck({...n,palette:{mode:a,...r?.palette},colorSpace:t});return e[i]={...r,palette:s,opacity:{...OX(a),...r?.opacity},overlays:r?.overlays||NX(a)},o}function tce(t={},...e){const{colorSchemes:r={light:!0},defaultColorScheme:n,disableCssColorScheme:i=!1,cssVarPrefix:a="mui",nativeColor:s=!1,shouldSkipGeneratingVar:o=Yue,colorSchemeSelector:c=r.light&&r.dark?"media":void 0,rootSelector:f=":root",...d}=t,m=Object.keys(r)[0],b=n||(r.light&&m!=="light"?"light":m),x=ece(a),{[b]:E,light:T,dark:A,...M}=r,F={...M};let N=E;if((b==="dark"&&!("dark"in r)||b==="light"&&!("light"in r))&&(N=!0),!N)throw new Error(_p(21,b));let O;s&&(O="oklch");const U=hA(O,F,N,d,b);T&&!F.light&&hA(O,F,T,void 0,"light"),A&&!F.dark&&hA(O,F,A,void 0,"dark");let j={defaultColorScheme:b,...U,cssVarPrefix:a,colorSchemeSelector:c,rootSelector:f,getCssVar:x,colorSchemes:F,font:{...Due(U.typography),...U.font},spacing:Que(d.spacing)};Object.keys(j.colorSchemes).forEach(Q=>{const G=j.colorSchemes[Q].palette,ae=fe=>{const _e=fe.split("-"),Le=_e[1],ye=_e[2];return x(fe,G[Le][ye])};G.mode==="light"&&(Ur(G.common,"background","#fff"),Ur(G.common,"onBackground","#000")),G.mode==="dark"&&(Ur(G.common,"background","#000"),Ur(G.common,"onBackground","#fff"));function se(fe,_e,Le){if(O){let ye;return fe===um&&(ye=`transparent ${((1-Le)*100).toFixed(0)}%`),fe===co&&(ye=`#000 ${(Le*100).toFixed(0)}%`),fe===fo&&(ye=`#fff ${(Le*100).toFixed(0)}%`),`color-mix(in ${O}, ${_e}, ${ye})`}return fe(_e,Le)}if(Jue(G,["Alert","AppBar","Avatar","Button","Chip","FilledInput","LinearProgress","Skeleton","Slider","SnackbarContent","SpeedDialAction","StepConnector","StepContent","Switch","TableCell","Tooltip"]),G.mode==="light"){Ur(G.Alert,"errorColor",se(co,G.error.light,.6)),Ur(G.Alert,"infoColor",se(co,G.info.light,.6)),Ur(G.Alert,"successColor",se(co,G.success.light,.6)),Ur(G.Alert,"warningColor",se(co,G.warning.light,.6)),Ur(G.Alert,"errorFilledBg",ae("palette-error-main")),Ur(G.Alert,"infoFilledBg",ae("palette-info-main")),Ur(G.Alert,"successFilledBg",ae("palette-success-main")),Ur(G.Alert,"warningFilledBg",ae("palette-warning-main")),Ur(G.Alert,"errorFilledColor",ed(()=>G.getContrastText(G.error.main))),Ur(G.Alert,"infoFilledColor",ed(()=>G.getContrastText(G.info.main))),Ur(G.Alert,"successFilledColor",ed(()=>G.getContrastText(G.success.main))),Ur(G.Alert,"warningFilledColor",ed(()=>G.getContrastText(G.warning.main))),Ur(G.Alert,"errorStandardBg",se(fo,G.error.light,.9)),Ur(G.Alert,"infoStandardBg",se(fo,G.info.light,.9)),Ur(G.Alert,"successStandardBg",se(fo,G.success.light,.9)),Ur(G.Alert,"warningStandardBg",se(fo,G.warning.light,.9)),Ur(G.Alert,"errorIconColor",ae("palette-error-main")),Ur(G.Alert,"infoIconColor",ae("palette-info-main")),Ur(G.Alert,"successIconColor",ae("palette-success-main")),Ur(G.Alert,"warningIconColor",ae("palette-warning-main")),Ur(G.AppBar,"defaultBg",ae("palette-grey-100")),Ur(G.Avatar,"defaultBg",ae("palette-grey-400")),Ur(G.Button,"inheritContainedBg",ae("palette-grey-300")),Ur(G.Button,"inheritContainedHoverBg",ae("palette-grey-A100")),Ur(G.Chip,"defaultBorder",ae("palette-grey-400")),Ur(G.Chip,"defaultAvatarColor",ae("palette-grey-700")),Ur(G.Chip,"defaultIconColor",ae("palette-grey-700")),Ur(G.FilledInput,"bg","rgba(0, 0, 0, 0.06)"),Ur(G.FilledInput,"hoverBg","rgba(0, 0, 0, 0.09)"),Ur(G.FilledInput,"disabledBg","rgba(0, 0, 0, 0.12)"),Ur(G.LinearProgress,"primaryBg",se(fo,G.primary.main,.62)),Ur(G.LinearProgress,"secondaryBg",se(fo,G.secondary.main,.62)),Ur(G.LinearProgress,"errorBg",se(fo,G.error.main,.62)),Ur(G.LinearProgress,"infoBg",se(fo,G.info.main,.62)),Ur(G.LinearProgress,"successBg",se(fo,G.success.main,.62)),Ur(G.LinearProgress,"warningBg",se(fo,G.warning.main,.62)),Ur(G.Skeleton,"bg",O?se(um,G.text.primary,.11):`rgba(${ae("palette-text-primaryChannel")} / 0.11)`),Ur(G.Slider,"primaryTrack",se(fo,G.primary.main,.62)),Ur(G.Slider,"secondaryTrack",se(fo,G.secondary.main,.62)),Ur(G.Slider,"errorTrack",se(fo,G.error.main,.62)),Ur(G.Slider,"infoTrack",se(fo,G.info.main,.62)),Ur(G.Slider,"successTrack",se(fo,G.success.main,.62)),Ur(G.Slider,"warningTrack",se(fo,G.warning.main,.62));const fe=O?se(co,G.background.default,.6825):z2(G.background.default,.8);Ur(G.SnackbarContent,"bg",fe),Ur(G.SnackbarContent,"color",ed(()=>O?Tk.text.primary:G.getContrastText(fe))),Ur(G.SpeedDialAction,"fabHoverBg",z2(G.background.paper,.15)),Ur(G.StepConnector,"border",ae("palette-grey-400")),Ur(G.StepContent,"border",ae("palette-grey-400")),Ur(G.Switch,"defaultColor",ae("palette-common-white")),Ur(G.Switch,"defaultDisabledColor",ae("palette-grey-100")),Ur(G.Switch,"primaryDisabledColor",se(fo,G.primary.main,.62)),Ur(G.Switch,"secondaryDisabledColor",se(fo,G.secondary.main,.62)),Ur(G.Switch,"errorDisabledColor",se(fo,G.error.main,.62)),Ur(G.Switch,"infoDisabledColor",se(fo,G.info.main,.62)),Ur(G.Switch,"successDisabledColor",se(fo,G.success.main,.62)),Ur(G.Switch,"warningDisabledColor",se(fo,G.warning.main,.62)),Ur(G.TableCell,"border",se(fo,se(um,G.divider,1),.88)),Ur(G.Tooltip,"bg",se(um,G.grey[700],.92))}if(G.mode==="dark"){Ur(G.Alert,"errorColor",se(fo,G.error.light,.6)),Ur(G.Alert,"infoColor",se(fo,G.info.light,.6)),Ur(G.Alert,"successColor",se(fo,G.success.light,.6)),Ur(G.Alert,"warningColor",se(fo,G.warning.light,.6)),Ur(G.Alert,"errorFilledBg",ae("palette-error-dark")),Ur(G.Alert,"infoFilledBg",ae("palette-info-dark")),Ur(G.Alert,"successFilledBg",ae("palette-success-dark")),Ur(G.Alert,"warningFilledBg",ae("palette-warning-dark")),Ur(G.Alert,"errorFilledColor",ed(()=>G.getContrastText(G.error.dark))),Ur(G.Alert,"infoFilledColor",ed(()=>G.getContrastText(G.info.dark))),Ur(G.Alert,"successFilledColor",ed(()=>G.getContrastText(G.success.dark))),Ur(G.Alert,"warningFilledColor",ed(()=>G.getContrastText(G.warning.dark))),Ur(G.Alert,"errorStandardBg",se(co,G.error.light,.9)),Ur(G.Alert,"infoStandardBg",se(co,G.info.light,.9)),Ur(G.Alert,"successStandardBg",se(co,G.success.light,.9)),Ur(G.Alert,"warningStandardBg",se(co,G.warning.light,.9)),Ur(G.Alert,"errorIconColor",ae("palette-error-main")),Ur(G.Alert,"infoIconColor",ae("palette-info-main")),Ur(G.Alert,"successIconColor",ae("palette-success-main")),Ur(G.Alert,"warningIconColor",ae("palette-warning-main")),Ur(G.AppBar,"defaultBg",ae("palette-grey-900")),Ur(G.AppBar,"darkBg",ae("palette-background-paper")),Ur(G.AppBar,"darkColor",ae("palette-text-primary")),Ur(G.Avatar,"defaultBg",ae("palette-grey-600")),Ur(G.Button,"inheritContainedBg",ae("palette-grey-800")),Ur(G.Button,"inheritContainedHoverBg",ae("palette-grey-700")),Ur(G.Chip,"defaultBorder",ae("palette-grey-700")),Ur(G.Chip,"defaultAvatarColor",ae("palette-grey-300")),Ur(G.Chip,"defaultIconColor",ae("palette-grey-300")),Ur(G.FilledInput,"bg","rgba(255, 255, 255, 0.09)"),Ur(G.FilledInput,"hoverBg","rgba(255, 255, 255, 0.13)"),Ur(G.FilledInput,"disabledBg","rgba(255, 255, 255, 0.12)"),Ur(G.LinearProgress,"primaryBg",se(co,G.primary.main,.5)),Ur(G.LinearProgress,"secondaryBg",se(co,G.secondary.main,.5)),Ur(G.LinearProgress,"errorBg",se(co,G.error.main,.5)),Ur(G.LinearProgress,"infoBg",se(co,G.info.main,.5)),Ur(G.LinearProgress,"successBg",se(co,G.success.main,.5)),Ur(G.LinearProgress,"warningBg",se(co,G.warning.main,.5)),Ur(G.Skeleton,"bg",O?se(um,G.text.primary,.13):`rgba(${ae("palette-text-primaryChannel")} / 0.13)`),Ur(G.Slider,"primaryTrack",se(co,G.primary.main,.5)),Ur(G.Slider,"secondaryTrack",se(co,G.secondary.main,.5)),Ur(G.Slider,"errorTrack",se(co,G.error.main,.5)),Ur(G.Slider,"infoTrack",se(co,G.info.main,.5)),Ur(G.Slider,"successTrack",se(co,G.success.main,.5)),Ur(G.Slider,"warningTrack",se(co,G.warning.main,.5));const fe=O?se(fo,G.background.default,.985):z2(G.background.default,.98);Ur(G.SnackbarContent,"bg",fe),Ur(G.SnackbarContent,"color",ed(()=>O?PX.text.primary:G.getContrastText(fe))),Ur(G.SpeedDialAction,"fabHoverBg",z2(G.background.paper,.15)),Ur(G.StepConnector,"border",ae("palette-grey-600")),Ur(G.StepContent,"border",ae("palette-grey-600")),Ur(G.Switch,"defaultColor",ae("palette-grey-300")),Ur(G.Switch,"defaultDisabledColor",ae("palette-grey-600")),Ur(G.Switch,"primaryDisabledColor",se(co,G.primary.main,.55)),Ur(G.Switch,"secondaryDisabledColor",se(co,G.secondary.main,.55)),Ur(G.Switch,"errorDisabledColor",se(co,G.error.main,.55)),Ur(G.Switch,"infoDisabledColor",se(co,G.info.main,.55)),Ur(G.Switch,"successDisabledColor",se(co,G.success.main,.55)),Ur(G.Switch,"warningDisabledColor",se(co,G.warning.main,.55)),Ur(G.TableCell,"border",se(co,se(um,G.divider,1),.68)),Ur(G.Tooltip,"bg",se(um,G.grey[700],.92))}Zd(G.background,"default"),Zd(G.background,"paper"),Zd(G.common,"background"),Zd(G.common,"onBackground"),Zd(G,"divider"),Object.keys(G).forEach(fe=>{const _e=G[fe];fe!=="tonalOffset"&&_e&&typeof _e=="object"&&(_e.main&&Ur(G[fe],"mainChannel",k1(R1(_e.main))),_e.light&&Ur(G[fe],"lightChannel",k1(R1(_e.light))),_e.dark&&Ur(G[fe],"darkChannel",k1(R1(_e.dark))),_e.contrastText&&Ur(G[fe],"contrastTextChannel",k1(R1(_e.contrastText))),fe==="text"&&(Zd(G[fe],"primary"),Zd(G[fe],"secondary")),fe==="action"&&(_e.active&&Zd(G[fe],"active"),_e.selected&&Zd(G[fe],"selected")))})}),j=e.reduce((Q,G)=>Qu(Q,G),j);const H={prefix:a,disableCssColorScheme:i,shouldSkipGeneratingVar:o,getSelector:Kue(j),enableContrastVars:s},{vars:W,generateThemeVars:X,generateStyleSheets:oe}=sue(j,H);return j.vars=W,Object.entries(j.colorSchemes[j.defaultColorScheme]).forEach(([Q,G])=>{j[Q]=G}),j.generateThemeVars=X,j.generateStyleSheets=oe,j.generateSpacing=function(){return hX(d.spacing,BD(this))},j.getColorSchemeSelector=lue(c),j.spacing=j.generateSpacing(),j.shouldSkipGeneratingVar=o,j.unstable_sxConfig={...Px,...d?.unstable_sxConfig},j.unstable_sx=function(G){return Sg({sx:G,theme:this})},j.toRuntimeSource=DX,j}function AB(t,e,r){t.colorSchemes&&r&&(t.colorSchemes[e]={...r!==!0&&r,palette:GD({...r===!0?{}:r.palette,mode:e})})}function h_(t={},...e){const{palette:r,cssVariables:n=!1,colorSchemes:i=r?void 0:{light:!0},defaultColorScheme:a=r?.mode,...s}=t,o=a||"light",c=i?.[o],f={...i,...r?{[o]:{...typeof c!="boolean"&&c,palette:r}}:void 0};if(n===!1){if(!("colorSchemes"in t))return Ck(t,...e);let d=r;"palette"in t||f[o]&&(f[o]!==!0?d=f[o].palette:o==="dark"&&(d={mode:"dark"}));const m=Ck({...t,palette:d},...e);return m.defaultColorScheme=o,m.colorSchemes=f,m.palette.mode==="light"&&(m.colorSchemes.light={...f.light!==!0&&f.light,palette:m.palette},AB(m,"dark",f.dark)),m.palette.mode==="dark"&&(m.colorSchemes.dark={...f.dark!==!0&&f.dark,palette:m.palette},AB(m,"light",f.light)),m}return!r&&!("light"in f)&&o==="light"&&(f.light=!0),tce({...s,colorSchemes:f,defaultColorScheme:o,...typeof n!="boolean"&&n},...e)}const WD=h_();function Bc(){const t=kx(WD);return t[Eh]||t}function qT(t){return t!=="ownerState"&&t!=="theme"&&t!=="sx"&&t!=="as"}const Al=t=>qT(t)&&t!=="classes",Dr=vX({themeId:Eh,defaultTheme:WD,rootShouldForwardProp:Al});function rce({theme:t,...e}){const r=Eh in t?t[Eh]:void 0;return J.jsx(CX,{...e,themeId:r?Eh:void 0,theme:r||t})}const j2={colorSchemeStorageKey:"mui-color-scheme",defaultLightColorScheme:"light",defaultDarkColorScheme:"dark",modeStorageKey:"mui-mode"},{CssVarsProvider:nce}=nue({themeId:Eh,theme:()=>h_({cssVariables:!0}),colorSchemeStorageKey:j2.colorSchemeStorageKey,modeStorageKey:j2.modeStorageKey,defaultColorScheme:{light:j2.defaultLightColorScheme,dark:j2.defaultDarkColorScheme},resolveTheme:t=>{const e={...t,typography:RX(t.palette,t.typography)};return e.unstable_sx=function(n){return Sg({sx:n,theme:this})},e}}),ice=nce;function LX({theme:t,...e}){const r=te.useMemo(()=>{if(typeof t=="function")return t;const n=Eh in t?t[Eh]:t;return"colorSchemes"in n?null:"vars"in n?t:{...t,vars:null}},[t]);return r?J.jsx(rce,{theme:r,...e}):J.jsx(ice,{theme:t,...e})}const ace=h_({palette:{mode:"light"}}),oce=h_({palette:{mode:"dark"}}),sce=t=>({...t==="light"?ace:oce,palette:{mode:t,...t==="dark"?{primary:{main:"#009EE0"},secondary:{main:"#747577"},background:{paper:"#313131"},text:{primary:"#FFF",contrast:"#000"},topToolbar:{barColor:"#000"},navigation:{buttonColor:"#fff",navColor:"#313131",navHover:"#747577"},GPS:{GPSActiveColor:"#fff",GPSInactiveColor:"#fff",GPSActiveBackgroundColor:"#747577"},compass:{compColor:"#313131",compHover:"#747577",compStroke:"#d3dce1",compNorth:"#cf003f",compSouth:"#d3dcf0"}}:{primary:{main:"#009EE0"},secondary:{main:"#747577"},text:{primary:"#000",contrast:"#fff"},topToolbar:{barColor:"#fff"},navigation:{buttonColor:"#747577",navColor:"#fff",navHover:"#f5f5f5"},GPS:{GPSActiveColor:"#009EE0",GPSInactiveColor:"#747577",GPSActiveBackgroundColor:"#fff"},compass:{compColor:"#fff",compHover:"#f5f5f5",compStroke:"#009ee0",compNorth:"#cf003f",compSouth:"#d3dcf0"}}}}),FX=t=>{const e=sce(t&&["light","dark"].includes(t)?t:"light");return h_(e,{components:{MuiTypography:{styleOverrides:{root:{}}},MuiAppBar:{styleOverrides:{root:{backgroundColor:e.palette.topToolbar.barColor}}},MuiButton:{variants:[{props:{variant:"navtools"},style:{minWidth:"20px",minHeight:"20px",fontWeight:600,[e.breakpoints.down("md")]:{width:"50px",height:"50px",fontSize:"1.4em"},[e.breakpoints.up("md")]:{width:"30px",height:"30px",fontSize:"1.2em"},color:e.palette.text.primary,backgroundColor:e.palette.navigation.navColor,borderRadius:"23%",margin:"0.15px",marginTop:"4px",":hover":{backgroundColor:e.palette.navigation.navHover}}}]},MuiListItemText:{styleOverrides:{primary:({ownerState:r})=>r?.variant==="layerlist"?{fontSize:"0.9rem"}:{},secondary:({ownerState:r})=>r?.variant==="layerlist"?{fontSize:"0.7rem"}:{}}}}})};try{MapcomponentsTheme.displayName="MapcomponentsTheme",MapcomponentsTheme.__docgenInfo={description:"",displayName:"MapcomponentsTheme",props:{}}}catch{}const ec={source_openmaptiles_url:"https://wms.wheregroup.com/tileserver/tile/world-0-14.json",sprite:"https://wms.wheregroup.com/tileserver/sprites/osm-bright",glyphs:"https://wms.wheregroup.com/tileserver/fonts/{fontstack}/{range}.pbf",sourceOptions_tiles:["https://wms.wheregroup.com/tileserver/tile/world-0-14/{z}/{x}/{y}.pbf"]},bu=[];for(let t=0;t<256;++t)bu.push((t+256).toString(16).slice(1));function lce(t,e=0){return(bu[t[e+0]]+bu[t[e+1]]+bu[t[e+2]]+bu[t[e+3]]+"-"+bu[t[e+4]]+bu[t[e+5]]+"-"+bu[t[e+6]]+bu[t[e+7]]+"-"+bu[t[e+8]]+bu[t[e+9]]+"-"+bu[t[e+10]]+bu[t[e+11]]+bu[t[e+12]]+bu[t[e+13]]+bu[t[e+14]]+bu[t[e+15]]).toLowerCase()}let dA;const uce=new Uint8Array(16);function cce(){if(!dA){if(typeof crypto>"u"||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");dA=crypto.getRandomValues.bind(crypto)}return dA(uce)}const fce=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),IB={randomUUID:fce};function _c(t,e,r){if(IB.randomUUID&&!t)return IB.randomUUID();t=t||{};const n=t.random??t.rng?.()??cce();if(n.length<16)throw new Error("Random bytes length must be >= 16");return n[6]=n[6]&15|64,n[8]=n[8]&63|128,lce(n)}const XD=gt.createContext({});function Ik(t){const[e,r]=gt.useState([]),[n,i]=gt.useState([]),[a,s]=gt.useState([]),[o,c]=gt.useState(ec.sourceOptions_tiles[0]),f=te.useMemo(()=>({layerId:"openmaptiles",sourceOptions:{type:"vector",tiles:[o]}}),[o]),d=T=>{if(!T)return;const A=[],M=[];T.layers.forEach((F,N)=>{F.type==="symbol"?M.push(F):(N===0&&(F.id=T.name||"background"),A.push(F))}),i(A),s(M)};te.useEffect(()=>{if(e.filter(T=>!T?.id).length){const T=[...e];T.forEach(A=>{A?.id||(A.id=_c())}),r(T)}},[e]);const m=te.useCallback((T,A)=>{const M=e?.filter?.(F=>F.id===T);if(M.length>0){const F=[...e],N=M[0],O=e.indexOf(N),U=A(O);U>=0&&U<=e.length-1&&(F.splice(O,1),F.splice(U,0,N),r(F))}},[e]),b=te.useCallback(T=>{m(T,A=>A+1)},[m]),x=te.useCallback(T=>{m(T,A=>A-1)},[m]),E={layers:e,setLayers:r,backgroundLayers:n,setBackgroundLayers:i,symbolLayers:a,setSymbolLayers:s,updateStyle:d,vtLayerConfig:f,tileUrl:o,setTileUrl:c,moveUp:x,moveDown:b,moveLayer:m};return J.jsx(XD.Provider,{value:E,children:t.children})}try{Ik.displayName="LayerContextProvider",Ik.__docgenInfo={description:"",displayName:"LayerContextProvider",props:{}}}catch{}const Ng=gt.createContext({}),Pk=({children:t})=>{const[e,r]=te.useState(void 0),[n,i]=te.useState([]),a=te.useRef([]),s=te.useRef({}),o=d=>{if(d){typeof s.current[d]<"u"&&delete s.current[d];const m=a.current.indexOf(d);m>-1&&a.current.splice(m,1),i([...a.current]),a.current.length===0&&e&&r(void 0)}else o("anonymous_map")},f={map:e,setMap:d=>{if(r(d),n.length===0){const m="anonymous_map";i([...n,m]),s.current[m]=d}},maps:s.current,mapIds:n,registerMap:(d,m)=>{d&&m&&(s.current[d]=m,a.current.push(d),i([...a.current]),(!e||e?.cancelled===!0)&&r(m))},removeMap:o,mapExists:d=>d&&Object.keys(s.current).indexOf(d)===-1?!1:!(!d&&!e),getMap:d=>d&&n.indexOf(d)!==-1?s.current[d]:!d&&e?e:null};return J.jsx(Ng.Provider,{value:f,children:J.jsx(Ik,{children:J.jsx(LX,{theme:FX("light"),children:t})})})};try{Pk.displayName="MapComponentsProvider",Pk.__docgenInfo={description:`MapComponentsProvider must be imported and wrapped around component where at least one of its child nodes requires access to a MapLibre-gl or openlayers instance that is registered in this mapContext.
MapComponentsProvider must be used one level higher than the first use of MapContext.

MapComponentsProvider requires at least one use of the MapLibreMap component somewhere down the component tree that will create the MapLibre-gl object and set the reference at MapContext.map. For MapLibre maps it is a good idea to provide a mapId attribute to the MapLibreMap Component even if you are only using a single map instance at start. It will make a later transition to using multiple instances within the same project much easier.`,displayName:"MapComponentsProvider",props:{}}}catch{}const BX={mapId:void 0,options:{center:{lng:8.607,lat:53.1409349},zoom:11,container:"",style:{version:8,name:"blank",center:[0,0],zoom:0,sources:{},sprite:"https://wms.wheregroup.com/tileserver/sprites/osm-bright",glyphs:"https://wms.wheregroup.com/tileserver/fonts/{fontstack}/{range}.pbf",layers:[{id:"_background",type:"background",paint:{"background-color":"rgba(0,0,0,0)"}}]}}},zX=t=>{const e=te.useRef(null),r=te.useRef(null),n=te.useContext(Ng),i=te.useRef(t.mapId),a=te.useRef(!1),s=te.useRef(t.options?.style);return te.useEffect(()=>{const o=i.current;return()=>{a.current=!1,n.removeMap(o),e.current&&(e.current.map?.remove?.(),e.current.cancelled=!0,e.current=null)}},[]),te.useEffect(()=>{a.current||r.current&&(a.current=!0,t?.options?.style&&(s.current=JSON.stringify(t.options.style)),e.current=new _oe({mapOptions:{style:"",...t.options,...t?.options?.style?{}:{style:BX?.options?.style},container:r.current},onReady:(o,c)=>{o.once("load",()=>{c?.cancelled?o.remove():(window._map=o,t.mapId?n.registerMap(t.mapId,c):n.setMap(c))})}}))},[t.options,t.mapId]),te.useEffect(()=>{if(e.current?.map&&t?.options?.style){const o=JSON.stringify(t.options.style);s.current!==o&&(s.current=o,e.current.map.setStyle(t.options.style))}},[t?.options?.style]),J.jsx("div",{ref:r,className:"mapContainer",style:t.style})};zX.defaultProps=BX;function HT(t){const e=te.useContext(Ng),r=te.useRef(!1),n=te.useRef(null),[i,a]=te.useState(),s=te.useRef(void 0),[o,c]=te.useState([]),f=te.useRef(""),d=te.useRef(_c()),m=te.useCallback(x=>!t?.filter?.includeBaseLayers&&x?.baseLayer?!1:typeof t.filter?.matchLayerIds<"u"?t.filter.matchLayerIds instanceof RegExp?t.filter.matchLayerIds.test(x.id):x.id.includes(t.filter.matchLayerIds):!0,[t.filter]),b=te.useCallback(()=>{if(!n.current)return;const x=n.current.wrapper.layerState.filter(m),E=JSON.stringify(x);f.current!==E&&(f.current=E,c(x))},[m]);return te.useEffect(()=>{const x=d.current;return()=>{n.current&&(n.current.cleanup(x),n.current=null),r.current=!1}},[]),te.useEffect(()=>{if(!(!e.mapExists(t.mapId)||r.current)){if(r.current=!0,n.current=e.getMap(t.mapId),!n.current){r.current=!1;return}t?.watch?.viewport&&(a(n.current.wrapper.viewportState),n.current.wrapper.on("viewportchange",()=>{s.current!==n.current?.wrapper.viewportStateString&&a(n.current?.wrapper.viewportState)},d.current)),t?.watch?.layers&&(b(),n.current.wrapper.on("layerchange",b,{includeBaseLayers:t?.filter?.includeBaseLayers,matchLayerIds:t?.filter?.matchLayerIds},d.current))}},[e.mapIds,e,t.mapId,b,t]),{layers:o,viewport:i}}HT.defaultProps={mapId:void 0,watch:{layers:!0,sources:!1,viewport:!1},filter:{includeBaseLayers:!1}};function va(t){const e=te.useContext(Ng),[r,n]=te.useState({map:void 0,ready:!1}),i=HT({mapId:t?.mapId,watch:{viewport:!1,layers:!!t?.waitForLayer,sources:!1},filter:{includeBaseLayers:!0}}),a=te.useRef(null),s=te.useRef(_c()),o=()=>{a.current&&a.current.cleanup(s.current)};return te.useEffect(()=>()=>{o(),a.current=null},[]),te.useEffect(()=>{if(a.current&&a.current.cancelled===!0&&(a.current=null,n({map:void 0,ready:!1})),!(a.current||!e.mapExists(t?.mapId))){if(t?.waitForLayer){let c=!1;if(i?.layers?.forEach(f=>{f.id===t?.waitForLayer&&(c=!0)}),!c)return}a.current=e.getMap(t?.mapId),n({map:a.current,ready:!0})}},[e.mapIds,i.layers,e,t]),{map:r.map,mapIsReady:r.ready,componentId:s.current,layers:i.layers,cleanup:o}}function kk(...t){return t.reduce((e,r)=>r==null?e:function(...i){e.apply(this,i),r.apply(this,i)},()=>{})}function hce(t){return J.jsx(dX,{...t,defaultTheme:WD,themeId:Eh})}function dce(t){return function(r){return J.jsx(hce,{styles:typeof t=="function"?n=>t({theme:n,...r}):t})}}function pce(){return jD}const ci=Yle;function bi(t){return Hle(t)}function gce(t){return gi("MuiSvgIcon",t)}pi("MuiSvgIcon",["root","colorPrimary","colorSecondary","colorAction","colorError","colorDisabled","fontSizeInherit","fontSizeSmall","fontSizeMedium","fontSizeLarge"]);const mce=t=>{const{color:e,fontSize:r,classes:n}=t,i={root:["root",e!=="inherit"&&`color${cn(e)}`,`fontSize${cn(r)}`]};return mi(i,gce,n)},yce=Dr("svg",{name:"MuiSvgIcon",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.root,r.color!=="inherit"&&e[`color${cn(r.color)}`],e[`fontSize${cn(r.fontSize)}`]]}})(ci(({theme:t})=>({userSelect:"none",width:"1em",height:"1em",display:"inline-block",flexShrink:0,transition:t.transitions?.create?.("fill",{duration:(t.vars??t).transitions?.duration?.shorter}),variants:[{props:e=>!e.hasSvgAsChild,style:{fill:"currentColor"}},{props:{fontSize:"inherit"},style:{fontSize:"inherit"}},{props:{fontSize:"small"},style:{fontSize:t.typography?.pxToRem?.(20)||"1.25rem"}},{props:{fontSize:"medium"},style:{fontSize:t.typography?.pxToRem?.(24)||"1.5rem"}},{props:{fontSize:"large"},style:{fontSize:t.typography?.pxToRem?.(35)||"2.1875rem"}},...Object.entries((t.vars??t).palette).filter(([,e])=>e&&e.main).map(([e])=>({props:{color:e},style:{color:(t.vars??t).palette?.[e]?.main}})),{props:{color:"action"},style:{color:(t.vars??t).palette?.action?.active}},{props:{color:"disabled"},style:{color:(t.vars??t).palette?.action?.disabled}},{props:{color:"inherit"},style:{color:void 0}}]}))),Rk=te.forwardRef(function(e,r){const n=bi({props:e,name:"MuiSvgIcon"}),{children:i,className:a,color:s="inherit",component:o="svg",fontSize:c="medium",htmlColor:f,inheritViewBox:d=!1,titleAccess:m,viewBox:b="0 0 24 24",...x}=n,E=te.isValidElement(i)&&i.type==="svg",T={...n,color:s,component:o,fontSize:c,instanceFontSize:e.fontSize,inheritViewBox:d,viewBox:b,hasSvgAsChild:E},A={};d||(A.viewBox=b);const M=mce(T);return J.jsxs(yce,{as:o,className:An(M.root,a),focusable:"false",color:f,"aria-hidden":m?void 0:!0,role:m?"img":void 0,ref:r,...A,...x,...E&&i.props,ownerState:T,children:[E?i.props.children:i,m?J.jsx("title",{children:m}):null]})});Rk.muiName="SvgIcon";function Ji(t,e){function r(n,i){return J.jsx(Rk,{"data-testid":void 0,ref:i,...n,children:t})}return r.muiName=Rk.muiName,te.memo(te.forwardRef(r))}function YD(t,e=166){let r;function n(...i){const a=()=>{t.apply(this,i)};clearTimeout(r),r=setTimeout(a,e)}return n.clear=()=>{clearTimeout(r)},n}function cs(t){return t&&t.ownerDocument||document}function bc(t){return cs(t).defaultView||window}function PB(t,e){typeof t=="function"?t(e):t&&(t.current=e)}function Ym(t){const{controlled:e,default:r,name:n,state:i="value"}=t,{current:a}=te.useRef(e!==void 0),[s,o]=te.useState(r),c=a?e:s,f=te.useCallback(d=>{a||o(d)},[]);return[c,f]}function ou(t){const e=te.useRef(t);return Tu(()=>{e.current=t}),te.useRef((...r)=>(0,e.current)(...r)).current}function Uo(...t){const e=te.useRef(void 0),r=te.useCallback(n=>{const i=t.map(a=>{if(a==null)return null;if(typeof a=="function"){const s=a,o=s(n);return typeof o=="function"?o:()=>{s(null)}}return a.current=n,()=>{a.current=null}});return()=>{i.forEach(a=>a?.())}},t);return te.useMemo(()=>t.every(n=>n==null)?null:n=>{e.current&&(e.current(),e.current=void 0),n!=null&&(e.current=r(n))},t)}function vce(t,e){const r=t.charCodeAt(2);return t[0]==="o"&&t[1]==="n"&&r>=65&&r<=90&&typeof e=="function"}function Fb(t,e){if(!t)return e;function r(s,o){const c={};return Object.keys(o).forEach(f=>{vce(f,o[f])&&typeof s[f]=="function"&&(c[f]=(...d)=>{s[f](...d),o[f](...d)})}),c}if(typeof t=="function"||typeof e=="function")return s=>{const o=typeof e=="function"?e(s):e,c=typeof t=="function"?t({...s,...o}):t,f=An(s?.className,o?.className,c?.className),d=r(c,o);return{...o,...c,...d,...!!f&&{className:f},...o?.style&&c?.style&&{style:{...o.style,...c.style}},...o?.sx&&c?.sx&&{sx:[...Array.isArray(o.sx)?o.sx:[o.sx],...Array.isArray(c.sx)?c.sx:[c.sx]]}}};const n=e,i=r(t,n),a=An(n?.className,t?.className);return{...e,...t,...i,...!!a&&{className:a},...n?.style&&t?.style&&{style:{...n.style,...t.style}},...n?.sx&&t?.sx&&{sx:[...Array.isArray(n.sx)?n.sx:[n.sx],...Array.isArray(t.sx)?t.sx:[t.sx]]}}}function jX(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}function Mk(t,e){return Mk=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},Mk(t,e)}function UX(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,Mk(t,e)}const kB={disabled:!1},GS=gt.createContext(null);var _ce=function(e){return e.scrollTop},M1="unmounted",ym="exited",vm="entering",Lv="entered",Dk="exiting",Qf=(function(t){UX(e,t);function e(n,i){var a;a=t.call(this,n,i)||this;var s=i,o=s&&!s.isMounting?n.enter:n.appear,c;return a.appearStatus=null,n.in?o?(c=ym,a.appearStatus=vm):c=Lv:n.unmountOnExit||n.mountOnEnter?c=M1:c=ym,a.state={status:c},a.nextCallback=null,a}e.getDerivedStateFromProps=function(i,a){var s=i.in;return s&&a.status===M1?{status:ym}:null};var r=e.prototype;return r.componentDidMount=function(){this.updateStatus(!0,this.appearStatus)},r.componentDidUpdate=function(i){var a=null;if(i!==this.props){var s=this.state.status;this.props.in?s!==vm&&s!==Lv&&(a=vm):(s===vm||s===Lv)&&(a=Dk)}this.updateStatus(!1,a)},r.componentWillUnmount=function(){this.cancelNextCallback()},r.getTimeouts=function(){var i=this.props.timeout,a,s,o;return a=s=o=i,i!=null&&typeof i!="number"&&(a=i.exit,s=i.enter,o=i.appear!==void 0?i.appear:s),{exit:a,enter:s,appear:o}},r.updateStatus=function(i,a){if(i===void 0&&(i=!1),a!==null)if(this.cancelNextCallback(),a===vm){if(this.props.unmountOnExit||this.props.mountOnEnter){var s=this.props.nodeRef?this.props.nodeRef.current:P1.findDOMNode(this);s&&_ce(s)}this.performEnter(i)}else this.performExit();else this.props.unmountOnExit&&this.state.status===ym&&this.setState({status:M1})},r.performEnter=function(i){var a=this,s=this.props.enter,o=this.context?this.context.isMounting:i,c=this.props.nodeRef?[o]:[P1.findDOMNode(this),o],f=c[0],d=c[1],m=this.getTimeouts(),b=o?m.appear:m.enter;if(!i&&!s||kB.disabled){this.safeSetState({status:Lv},function(){a.props.onEntered(f)});return}this.props.onEnter(f,d),this.safeSetState({status:vm},function(){a.props.onEntering(f,d),a.onTransitionEnd(b,function(){a.safeSetState({status:Lv},function(){a.props.onEntered(f,d)})})})},r.performExit=function(){var i=this,a=this.props.exit,s=this.getTimeouts(),o=this.props.nodeRef?void 0:P1.findDOMNode(this);if(!a||kB.disabled){this.safeSetState({status:ym},function(){i.props.onExited(o)});return}this.props.onExit(o),this.safeSetState({status:Dk},function(){i.props.onExiting(o),i.onTransitionEnd(s.exit,function(){i.safeSetState({status:ym},function(){i.props.onExited(o)})})})},r.cancelNextCallback=function(){this.nextCallback!==null&&(this.nextCallback.cancel(),this.nextCallback=null)},r.safeSetState=function(i,a){a=this.setNextCallback(a),this.setState(i,a)},r.setNextCallback=function(i){var a=this,s=!0;return this.nextCallback=function(o){s&&(s=!1,a.nextCallback=null,i(o))},this.nextCallback.cancel=function(){s=!1},this.nextCallback},r.onTransitionEnd=function(i,a){this.setNextCallback(a);var s=this.props.nodeRef?this.props.nodeRef.current:P1.findDOMNode(this),o=i==null&&!this.props.addEndListener;if(!s||o){setTimeout(this.nextCallback,0);return}if(this.props.addEndListener){var c=this.props.nodeRef?[this.nextCallback]:[s,this.nextCallback],f=c[0],d=c[1];this.props.addEndListener(f,d)}i!=null&&setTimeout(this.nextCallback,i)},r.render=function(){var i=this.state.status;if(i===M1)return null;var a=this.props,s=a.children;a.in,a.mountOnEnter,a.unmountOnExit,a.appear,a.enter,a.exit,a.timeout,a.addEndListener,a.onEnter,a.onEntering,a.onEntered,a.onExit,a.onExiting,a.onExited,a.nodeRef;var o=jX(a,["children","in","mountOnEnter","unmountOnExit","appear","enter","exit","timeout","addEndListener","onEnter","onEntering","onEntered","onExit","onExiting","onExited","nodeRef"]);return gt.createElement(GS.Provider,{value:null},typeof s=="function"?s(i,o):gt.cloneElement(gt.Children.only(s),o))},e})(gt.Component);Qf.contextType=GS;Qf.propTypes={};function dv(){}Qf.defaultProps={in:!1,mountOnEnter:!1,unmountOnExit:!1,appear:!1,enter:!0,exit:!0,onEnter:dv,onEntering:dv,onEntered:dv,onExit:dv,onExiting:dv,onExited:dv};Qf.UNMOUNTED=M1;Qf.EXITED=ym;Qf.ENTERING=vm;Qf.ENTERED=Lv;Qf.EXITING=Dk;function bce(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function ZD(t,e){var r=function(a){return e&&te.isValidElement(a)?e(a):a},n=Object.create(null);return t&&te.Children.map(t,function(i){return i}).forEach(function(i){n[i.key]=r(i)}),n}function xce(t,e){t=t||{},e=e||{};function r(d){return d in e?e[d]:t[d]}var n=Object.create(null),i=[];for(var a in t)a in e?i.length&&(n[a]=i,i=[]):i.push(a);var s,o={};for(var c in e){if(n[c])for(s=0;s<n[c].length;s++){var f=n[c][s];o[n[c][s]]=r(f)}o[c]=r(c)}for(s=0;s<i.length;s++)o[i[s]]=r(i[s]);return o}function Pm(t,e,r){return r[e]!=null?r[e]:t.props[e]}function wce(t,e){return ZD(t.children,function(r){return te.cloneElement(r,{onExited:e.bind(null,r),in:!0,appear:Pm(r,"appear",t),enter:Pm(r,"enter",t),exit:Pm(r,"exit",t)})})}function Sce(t,e,r){var n=ZD(t.children),i=xce(e,n);return Object.keys(i).forEach(function(a){var s=i[a];if(te.isValidElement(s)){var o=a in e,c=a in n,f=e[a],d=te.isValidElement(f)&&!f.props.in;c&&(!o||d)?i[a]=te.cloneElement(s,{onExited:r.bind(null,s),in:!0,exit:Pm(s,"exit",t),enter:Pm(s,"enter",t)}):!c&&o&&!d?i[a]=te.cloneElement(s,{in:!1}):c&&o&&te.isValidElement(f)&&(i[a]=te.cloneElement(s,{onExited:r.bind(null,s),in:f.props.in,exit:Pm(s,"exit",t),enter:Pm(s,"enter",t)}))}}),i}var Ece=Object.values||function(t){return Object.keys(t).map(function(e){return t[e]})},Tce={component:"div",childFactory:function(e){return e}},KD=(function(t){UX(e,t);function e(n,i){var a;a=t.call(this,n,i)||this;var s=a.handleExited.bind(bce(a));return a.state={contextValue:{isMounting:!0},handleExited:s,firstRender:!0},a}var r=e.prototype;return r.componentDidMount=function(){this.mounted=!0,this.setState({contextValue:{isMounting:!1}})},r.componentWillUnmount=function(){this.mounted=!1},e.getDerivedStateFromProps=function(i,a){var s=a.children,o=a.handleExited,c=a.firstRender;return{children:c?wce(i,o):Sce(i,s,o),firstRender:!1}},r.handleExited=function(i,a){var s=ZD(this.props.children);i.key in s||(i.props.onExited&&i.props.onExited(a),this.mounted&&this.setState(function(o){var c=US({},o.children);return delete c[i.key],{children:c}}))},r.render=function(){var i=this.props,a=i.component,s=i.childFactory,o=jX(i,["component","childFactory"]),c=this.state.contextValue,f=Ece(this.state.children).map(s);return delete o.appear,delete o.enter,delete o.exit,a===null?gt.createElement(GS.Provider,{value:c},f):gt.createElement(GS.Provider,{value:c},gt.createElement(a,o,f))},e})(gt.Component);KD.propTypes={};KD.defaultProps=Tce;const RB={};function VX(t,e){const r=te.useRef(RB);return r.current===RB&&(r.current=t(e)),r}const Cce=[];function Ace(t){te.useEffect(t,Cce)}class GT{static create(){return new GT}currentId=null;start(e,r){this.clear(),this.currentId=setTimeout(()=>{this.currentId=null,r()},e)}clear=()=>{this.currentId!==null&&(clearTimeout(this.currentId),this.currentId=null)};disposeEffect=()=>this.clear}function fg(){const t=VX(GT.create).current;return Ace(t.disposeEffect),t}const JD=t=>t.scrollTop;function xp(t,e){const{timeout:r,easing:n,style:i={}}=t;return{duration:i.transitionDuration??(typeof r=="number"?r:r[e.mode]||0),easing:i.transitionTimingFunction??(typeof n=="object"?n[e.mode]:n),delay:i.transitionDelay}}function Ice(t){return gi("MuiCollapse",t)}pi("MuiCollapse",["root","horizontal","vertical","entered","hidden","wrapper","wrapperInner"]);const Pce=t=>{const{orientation:e,classes:r}=t,n={root:["root",`${e}`],entered:["entered"],hidden:["hidden"],wrapper:["wrapper",`${e}`],wrapperInner:["wrapperInner",`${e}`]};return mi(n,Ice,r)},kce=Dr("div",{name:"MuiCollapse",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.root,e[r.orientation],r.state==="entered"&&e.entered,r.state==="exited"&&!r.in&&r.collapsedSize==="0px"&&e.hidden]}})(ci(({theme:t})=>({height:0,overflow:"hidden",transition:t.transitions.create("height"),variants:[{props:{orientation:"horizontal"},style:{height:"auto",width:0,transition:t.transitions.create("width")}},{props:{state:"entered"},style:{height:"auto",overflow:"visible"}},{props:{state:"entered",orientation:"horizontal"},style:{width:"auto"}},{props:({ownerState:e})=>e.state==="exited"&&!e.in&&e.collapsedSize==="0px",style:{visibility:"hidden"}}]}))),Rce=Dr("div",{name:"MuiCollapse",slot:"Wrapper"})({display:"flex",width:"100%",variants:[{props:{orientation:"horizontal"},style:{width:"auto",height:"100%"}}]}),Mce=Dr("div",{name:"MuiCollapse",slot:"WrapperInner"})({width:"100%",variants:[{props:{orientation:"horizontal"},style:{width:"auto",height:"100%"}}]}),Ok=te.forwardRef(function(e,r){const n=bi({props:e,name:"MuiCollapse"}),{addEndListener:i,children:a,className:s,collapsedSize:o="0px",component:c,easing:f,in:d,onEnter:m,onEntered:b,onEntering:x,onExit:E,onExited:T,onExiting:A,orientation:M="vertical",style:F,timeout:N=MX.standard,TransitionComponent:O=Qf,...U}=n,j={...n,orientation:M,collapsedSize:o},H=Pce(j),W=Bc(),X=fg(),oe=te.useRef(null),Q=te.useRef(),G=typeof o=="number"?`${o}px`:o,ae=M==="horizontal",se=ae?"width":"height",fe=te.useRef(null),_e=Uo(r,fe),Le=Fe=>Xe=>{if(Fe){const Be=fe.current;Xe===void 0?Fe(Be):Fe(Be,Xe)}},ye=()=>oe.current?oe.current[ae?"clientWidth":"clientHeight"]:0,Te=Le((Fe,Xe)=>{oe.current&&ae&&(oe.current.style.position="absolute"),Fe.style[se]=G,m&&m(Fe,Xe)}),Ie=Le((Fe,Xe)=>{const Be=ye();oe.current&&ae&&(oe.current.style.position="");const{duration:st,easing:Qe}=xp({style:F,timeout:N,easing:f},{mode:"enter"});if(N==="auto"){const it=W.transitions.getAutoHeightDuration(Be);Fe.style.transitionDuration=`${it}ms`,Q.current=it}else Fe.style.transitionDuration=typeof st=="string"?st:`${st}ms`;Fe.style[se]=`${Be}px`,Fe.style.transitionTimingFunction=Qe,x&&x(Fe,Xe)}),Me=Le((Fe,Xe)=>{Fe.style[se]="auto",b&&b(Fe,Xe)}),de=Le(Fe=>{Fe.style[se]=`${ye()}px`,E&&E(Fe)}),Se=Le(T),we=Le(Fe=>{const Xe=ye(),{duration:Be,easing:st}=xp({style:F,timeout:N,easing:f},{mode:"exit"});if(N==="auto"){const Qe=W.transitions.getAutoHeightDuration(Xe);Fe.style.transitionDuration=`${Qe}ms`,Q.current=Qe}else Fe.style.transitionDuration=typeof Be=="string"?Be:`${Be}ms`;Fe.style[se]=G,Fe.style.transitionTimingFunction=st,A&&A(Fe)}),De=Fe=>{N==="auto"&&X.start(Q.current||0,Fe),i&&i(fe.current,Fe)};return J.jsx(O,{in:d,onEnter:Te,onEntered:Me,onEntering:Ie,onExit:de,onExited:Se,onExiting:we,addEndListener:De,nodeRef:fe,timeout:N==="auto"?null:N,...U,children:(Fe,{ownerState:Xe,...Be})=>J.jsx(kce,{as:c,className:An(H.root,s,{entered:H.entered,exited:!d&&G==="0px"&&H.hidden}[Fe]),style:{[ae?"minWidth":"minHeight"]:G,...F},ref:_e,ownerState:{...j,state:Fe},...Be,children:J.jsx(Rce,{ownerState:{...j,state:Fe},className:H.wrapper,ref:oe,children:J.jsx(Mce,{ownerState:{...j,state:Fe},className:H.wrapperInner,children:a})})})})});Ok&&(Ok.muiSupportAuto=!0);function Dce(t){return gi("MuiPaper",t)}pi("MuiPaper",["root","rounded","outlined","elevation","elevation0","elevation1","elevation2","elevation3","elevation4","elevation5","elevation6","elevation7","elevation8","elevation9","elevation10","elevation11","elevation12","elevation13","elevation14","elevation15","elevation16","elevation17","elevation18","elevation19","elevation20","elevation21","elevation22","elevation23","elevation24"]);const Oce=t=>{const{square:e,elevation:r,variant:n,classes:i}=t,a={root:["root",n,!e&&"rounded",n==="elevation"&&`elevation${r}`]};return mi(a,Dce,i)},Nce=Dr("div",{name:"MuiPaper",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.root,e[r.variant],!r.square&&e.rounded,r.variant==="elevation"&&e[`elevation${r.elevation}`]]}})(ci(({theme:t})=>({backgroundColor:(t.vars||t).palette.background.paper,color:(t.vars||t).palette.text.primary,transition:t.transitions.create("box-shadow"),variants:[{props:({ownerState:e})=>!e.square,style:{borderRadius:t.shape.borderRadius}},{props:{variant:"outlined"},style:{border:`1px solid ${(t.vars||t).palette.divider}`}},{props:{variant:"elevation"},style:{boxShadow:"var(--Paper-shadow)",backgroundImage:"var(--Paper-overlay)"}}]}))),hf=te.forwardRef(function(e,r){const n=bi({props:e,name:"MuiPaper"}),i=Bc(),{className:a,component:s="div",elevation:o=1,square:c=!1,variant:f="elevation",...d}=n,m={...n,component:s,elevation:o,square:c,variant:f},b=Oce(m);return J.jsx(Nce,{as:s,ownerState:m,className:An(b.root,a),ref:r,...d,style:{...f==="elevation"&&{"--Paper-shadow":(i.vars||i).shadows[o],...i.vars&&{"--Paper-overlay":i.vars.overlays?.[o]},...!i.vars&&i.palette.mode==="dark"&&{"--Paper-overlay":`linear-gradient(${qS("#fff",Ak(o))}, ${qS("#fff",Ak(o))})`}},...d.style}})}),$X=te.createContext({});function vd(t){return typeof t=="string"}function qX(t,e,r){return t===void 0||vd(t)?e:{...e,ownerState:{...e.ownerState,...r}}}function HX(t,e,r){return typeof t=="function"?t(e,r):t}function Nm(t,e=[]){if(t===void 0)return{};const r={};return Object.keys(t).filter(n=>n.match(/^on[A-Z]/)&&typeof t[n]=="function"&&!e.includes(n)).forEach(n=>{r[n]=t[n]}),r}function MB(t){if(t===void 0)return{};const e={};return Object.keys(t).filter(r=>!(r.match(/^on[A-Z]/)&&typeof t[r]=="function")).forEach(r=>{e[r]=t[r]}),e}function GX(t){const{getSlotProps:e,additionalProps:r,externalSlotProps:n,externalForwardedProps:i,className:a}=t;if(!e){const x=An(r?.className,a,i?.className,n?.className),E={...r?.style,...i?.style,...n?.style},T={...r,...i,...n};return x.length>0&&(T.className=x),Object.keys(E).length>0&&(T.style=E),{props:T,internalRef:void 0}}const s=Nm({...i,...n}),o=MB(n),c=MB(i),f=e(s),d=An(f?.className,r?.className,a,i?.className,n?.className),m={...f?.style,...r?.style,...i?.style,...n?.style},b={...f,...r,...c,...o};return d.length>0&&(b.className=d),Object.keys(m).length>0&&(b.style=m),{props:b,internalRef:f.ref}}function Ei(t,e){const{className:r,elementType:n,ownerState:i,externalForwardedProps:a,internalForwardedProps:s,shouldForwardComponentProp:o=!1,...c}=e,{component:f,slots:d={[t]:void 0},slotProps:m={[t]:void 0},...b}=a,x=d[t]||n,E=HX(m[t],i),{props:{component:T,...A},internalRef:M}=GX({className:r,...c,externalForwardedProps:t==="root"?b:void 0,externalSlotProps:E}),F=Uo(M,E?.ref,e.ref),N=t==="root"?T||f:T,O=qX(x,{...t==="root"&&!f&&!d[t]&&s,...t!=="root"&&!d[t]&&s,...A,...N&&!o&&{as:N},...N&&o&&{component:N},ref:F},i);return[x,O]}function Lce(t){return gi("MuiAccordion",t)}const U2=pi("MuiAccordion",["root","heading","rounded","expanded","disabled","gutters","region"]),Fce=t=>{const{classes:e,square:r,expanded:n,disabled:i,disableGutters:a}=t;return mi({root:["root",!r&&"rounded",n&&"expanded",i&&"disabled",!a&&"gutters"],heading:["heading"],region:["region"]},Lce,e)},Bce=Dr(hf,{name:"MuiAccordion",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[{[`& .${U2.region}`]:e.region},e.root,!r.square&&e.rounded,!r.disableGutters&&e.gutters]}})(ci(({theme:t})=>{const e={duration:t.transitions.duration.shortest};return{position:"relative",transition:t.transitions.create(["margin"],e),overflowAnchor:"none","&::before":{position:"absolute",left:0,top:-1,right:0,height:1,content:'""',opacity:1,backgroundColor:(t.vars||t).palette.divider,transition:t.transitions.create(["opacity","background-color"],e)},"&:first-of-type":{"&::before":{display:"none"}},[`&.${U2.expanded}`]:{"&::before":{opacity:0},"&:first-of-type":{marginTop:0},"&:last-of-type":{marginBottom:0},"& + &":{"&::before":{display:"none"}}},[`&.${U2.disabled}`]:{backgroundColor:(t.vars||t).palette.action.disabledBackground}}}),ci(({theme:t})=>({variants:[{props:e=>!e.square,style:{borderRadius:0,"&:first-of-type":{borderTopLeftRadius:(t.vars||t).shape.borderRadius,borderTopRightRadius:(t.vars||t).shape.borderRadius},"&:last-of-type":{borderBottomLeftRadius:(t.vars||t).shape.borderRadius,borderBottomRightRadius:(t.vars||t).shape.borderRadius,"@supports (-ms-ime-align: auto)":{borderBottomLeftRadius:0,borderBottomRightRadius:0}}}},{props:e=>!e.disableGutters,style:{[`&.${U2.expanded}`]:{margin:"16px 0"}}}]}))),zce=Dr("h3",{name:"MuiAccordion",slot:"Heading"})({all:"unset"}),jce=Dr("div",{name:"MuiAccordion",slot:"Region"})({}),Uce=te.forwardRef(function(e,r){const n=bi({props:e,name:"MuiAccordion"}),{children:i,className:a,defaultExpanded:s=!1,disabled:o=!1,disableGutters:c=!1,expanded:f,onChange:d,square:m=!1,slots:b={},slotProps:x={},TransitionComponent:E,TransitionProps:T,...A}=n,[M,F]=Ym({controlled:f,default:s,name:"Accordion",state:"expanded"}),N=te.useCallback(Ie=>{F(!M),d&&d(Ie,!M)},[M,d,F]),[O,...U]=te.Children.toArray(i),j=te.useMemo(()=>({expanded:M,disabled:o,disableGutters:c,toggle:N}),[M,o,c,N]),H={...n,square:m,disabled:o,disableGutters:c,expanded:M},W=Fce(H),X={transition:E,...b},oe={transition:T,...x},Q={slots:X,slotProps:oe},[G,ae]=Ei("root",{elementType:Bce,externalForwardedProps:{...Q,...A},className:An(W.root,a),shouldForwardComponentProp:!0,ownerState:H,ref:r,additionalProps:{square:m}}),[se,fe]=Ei("heading",{elementType:zce,externalForwardedProps:Q,className:W.heading,ownerState:H}),[_e,Le]=Ei("transition",{elementType:Ok,externalForwardedProps:Q,ownerState:H}),[ye,Te]=Ei("region",{elementType:jce,externalForwardedProps:Q,ownerState:H,className:W.region,additionalProps:{"aria-labelledby":O.props.id,id:O.props["aria-controls"],role:"region"}});return J.jsxs(G,{...ae,children:[J.jsx(se,{...fe,children:J.jsx($X.Provider,{value:j,children:O})}),J.jsx(_e,{in:M,timeout:"auto",...Le,children:J.jsx(ye,{...Te,children:U})})]})});function F0(t){try{return t.matches(":focus-visible")}catch{}return!1}class WS{static create(){return new WS}static use(){const e=VX(WS.create).current,[r,n]=te.useState(!1);return e.shouldMount=r,e.setShouldMount=n,te.useEffect(e.mountEffect,[r]),e}constructor(){this.ref={current:null},this.mounted=null,this.didMount=!1,this.shouldMount=!1,this.setShouldMount=null}mount(){return this.mounted||(this.mounted=$ce(),this.shouldMount=!0,this.setShouldMount(this.shouldMount)),this.mounted}mountEffect=()=>{this.shouldMount&&!this.didMount&&this.ref.current!==null&&(this.didMount=!0,this.mounted.resolve())};start(...e){this.mount().then(()=>this.ref.current?.start(...e))}stop(...e){this.mount().then(()=>this.ref.current?.stop(...e))}pulsate(...e){this.mount().then(()=>this.ref.current?.pulsate(...e))}}function Vce(){return WS.use()}function $ce(){let t,e;const r=new Promise((n,i)=>{t=n,e=i});return r.resolve=t,r.reject=e,r}function qce(t){const{className:e,classes:r,pulsate:n=!1,rippleX:i,rippleY:a,rippleSize:s,in:o,onExited:c,timeout:f}=t,[d,m]=te.useState(!1),b=An(e,r.ripple,r.rippleVisible,n&&r.ripplePulsate),x={width:s,height:s,top:-(s/2)+a,left:-(s/2)+i},E=An(r.child,d&&r.childLeaving,n&&r.childPulsate);return!o&&!d&&m(!0),te.useEffect(()=>{if(!o&&c!=null){const T=setTimeout(c,f);return()=>{clearTimeout(T)}}},[c,o,f]),J.jsx("span",{className:b,style:x,children:J.jsx("span",{className:E})})}const Df=pi("MuiTouchRipple",["root","ripple","rippleVisible","ripplePulsate","child","childLeaving","childPulsate"]),Nk=550,Hce=80,Gce=Cx`
  0% {
    transform: scale(0);
    opacity: 0.1;
  }

  100% {
    transform: scale(1);
    opacity: 0.3;
  }
`,Wce=Cx`
  0% {
    opacity: 1;
  }

  100% {
    opacity: 0;
  }
`,Xce=Cx`
  0% {
    transform: scale(1);
  }

  50% {
    transform: scale(0.92);
  }

  100% {
    transform: scale(1);
  }
`,Yce=Dr("span",{name:"MuiTouchRipple",slot:"Root"})({overflow:"hidden",pointerEvents:"none",position:"absolute",zIndex:0,top:0,right:0,bottom:0,left:0,borderRadius:"inherit"}),Zce=Dr(qce,{name:"MuiTouchRipple",slot:"Ripple"})`
  opacity: 0;
  position: absolute;

  &.${Df.rippleVisible} {
    opacity: 0.3;
    transform: scale(1);
    animation-name: ${Gce};
    animation-duration: ${Nk}ms;
    animation-timing-function: ${({theme:t})=>t.transitions.easing.easeInOut};
  }

  &.${Df.ripplePulsate} {
    animation-duration: ${({theme:t})=>t.transitions.duration.shorter}ms;
  }

  & .${Df.child} {
    opacity: 1;
    display: block;
    width: 100%;
    height: 100%;
    border-radius: 50%;
    background-color: currentColor;
  }

  & .${Df.childLeaving} {
    opacity: 0;
    animation-name: ${Wce};
    animation-duration: ${Nk}ms;
    animation-timing-function: ${({theme:t})=>t.transitions.easing.easeInOut};
  }

  & .${Df.childPulsate} {
    position: absolute;
    /* @noflip */
    left: 0px;
    top: 0;
    animation-name: ${Xce};
    animation-duration: 2500ms;
    animation-timing-function: ${({theme:t})=>t.transitions.easing.easeInOut};
    animation-iteration-count: infinite;
    animation-delay: 200ms;
  }
`,Kce=te.forwardRef(function(e,r){const n=bi({props:e,name:"MuiTouchRipple"}),{center:i=!1,classes:a={},className:s,...o}=n,[c,f]=te.useState([]),d=te.useRef(0),m=te.useRef(null);te.useEffect(()=>{m.current&&(m.current(),m.current=null)},[c]);const b=te.useRef(!1),x=fg(),E=te.useRef(null),T=te.useRef(null),A=te.useCallback(O=>{const{pulsate:U,rippleX:j,rippleY:H,rippleSize:W,cb:X}=O;f(oe=>[...oe,J.jsx(Zce,{classes:{ripple:An(a.ripple,Df.ripple),rippleVisible:An(a.rippleVisible,Df.rippleVisible),ripplePulsate:An(a.ripplePulsate,Df.ripplePulsate),child:An(a.child,Df.child),childLeaving:An(a.childLeaving,Df.childLeaving),childPulsate:An(a.childPulsate,Df.childPulsate)},timeout:Nk,pulsate:U,rippleX:j,rippleY:H,rippleSize:W},d.current)]),d.current+=1,m.current=X},[a]),M=te.useCallback((O={},U={},j=()=>{})=>{const{pulsate:H=!1,center:W=i||U.pulsate,fakeElement:X=!1}=U;if(O?.type==="mousedown"&&b.current){b.current=!1;return}O?.type==="touchstart"&&(b.current=!0);const oe=X?null:T.current,Q=oe?oe.getBoundingClientRect():{width:0,height:0,left:0,top:0};let G,ae,se;if(W||O===void 0||O.clientX===0&&O.clientY===0||!O.clientX&&!O.touches)G=Math.round(Q.width/2),ae=Math.round(Q.height/2);else{const{clientX:fe,clientY:_e}=O.touches&&O.touches.length>0?O.touches[0]:O;G=Math.round(fe-Q.left),ae=Math.round(_e-Q.top)}if(W)se=Math.sqrt((2*Q.width**2+Q.height**2)/3),se%2===0&&(se+=1);else{const fe=Math.max(Math.abs((oe?oe.clientWidth:0)-G),G)*2+2,_e=Math.max(Math.abs((oe?oe.clientHeight:0)-ae),ae)*2+2;se=Math.sqrt(fe**2+_e**2)}O?.touches?E.current===null&&(E.current=()=>{A({pulsate:H,rippleX:G,rippleY:ae,rippleSize:se,cb:j})},x.start(Hce,()=>{E.current&&(E.current(),E.current=null)})):A({pulsate:H,rippleX:G,rippleY:ae,rippleSize:se,cb:j})},[i,A,x]),F=te.useCallback(()=>{M({},{pulsate:!0})},[M]),N=te.useCallback((O,U)=>{if(x.clear(),O?.type==="touchend"&&E.current){E.current(),E.current=null,x.start(0,()=>{N(O,U)});return}E.current=null,f(j=>j.length>0?j.slice(1):j),m.current=U},[x]);return te.useImperativeHandle(r,()=>({pulsate:F,start:M,stop:N}),[F,M,N]),J.jsx(Yce,{className:An(Df.root,a.root,s),ref:T,...o,children:J.jsx(KD,{component:null,exit:!0,children:c})})});function Jce(t){return gi("MuiButtonBase",t)}const Qce=pi("MuiButtonBase",["root","disabled","focusVisible"]),efe=t=>{const{disabled:e,focusVisible:r,focusVisibleClassName:n,classes:i}=t,s=mi({root:["root",e&&"disabled",r&&"focusVisible"]},Jce,i);return r&&n&&(s.root+=` ${n}`),s},tfe=Dr("button",{name:"MuiButtonBase",slot:"Root"})({display:"inline-flex",alignItems:"center",justifyContent:"center",position:"relative",boxSizing:"border-box",WebkitTapHighlightColor:"transparent",backgroundColor:"transparent",outline:0,border:0,margin:0,borderRadius:0,padding:0,cursor:"pointer",userSelect:"none",verticalAlign:"middle",MozAppearance:"none",WebkitAppearance:"none",textDecoration:"none",color:"inherit","&::-moz-focus-inner":{borderStyle:"none"},[`&.${Qce.disabled}`]:{pointerEvents:"none",cursor:"default"},"@media print":{colorAdjust:"exact"}}),d_=te.forwardRef(function(e,r){const n=bi({props:e,name:"MuiButtonBase"}),{action:i,centerRipple:a=!1,children:s,className:o,component:c="button",disabled:f=!1,disableRipple:d=!1,disableTouchRipple:m=!1,focusRipple:b=!1,focusVisibleClassName:x,LinkComponent:E="a",onBlur:T,onClick:A,onContextMenu:M,onDragLeave:F,onFocus:N,onFocusVisible:O,onKeyDown:U,onKeyUp:j,onMouseDown:H,onMouseLeave:W,onMouseUp:X,onTouchEnd:oe,onTouchMove:Q,onTouchStart:G,tabIndex:ae=0,TouchRippleProps:se,touchRippleRef:fe,type:_e,...Le}=n,ye=te.useRef(null),Te=Vce(),Ie=Uo(Te.ref,fe),[Me,de]=te.useState(!1);f&&Me&&de(!1),te.useImperativeHandle(i,()=>({focusVisible:()=>{de(!0),ye.current.focus()}}),[]);const Se=Te.shouldMount&&!d&&!f;te.useEffect(()=>{Me&&b&&!d&&Te.pulsate()},[d,b,Me,Te]);const we=Kd(Te,"start",H,m),De=Kd(Te,"stop",M,m),Fe=Kd(Te,"stop",F,m),Xe=Kd(Te,"stop",X,m),Be=Kd(Te,"stop",ar=>{Me&&ar.preventDefault(),W&&W(ar)},m),st=Kd(Te,"start",G,m),Qe=Kd(Te,"stop",oe,m),it=Kd(Te,"stop",Q,m),be=Kd(Te,"stop",ar=>{F0(ar.target)||de(!1),T&&T(ar)},!1),Ot=ou(ar=>{ye.current||(ye.current=ar.currentTarget),F0(ar.target)&&(de(!0),O&&O(ar)),N&&N(ar)}),at=()=>{const ar=ye.current;return c&&c!=="button"&&!(ar.tagName==="A"&&ar.href)},$e=ou(ar=>{b&&!ar.repeat&&Me&&ar.key===" "&&Te.stop(ar,()=>{Te.start(ar)}),ar.target===ar.currentTarget&&at()&&ar.key===" "&&ar.preventDefault(),U&&U(ar),ar.target===ar.currentTarget&&at()&&ar.key==="Enter"&&!f&&(ar.preventDefault(),A&&A(ar))}),Xt=ou(ar=>{b&&ar.key===" "&&Me&&!ar.defaultPrevented&&Te.stop(ar,()=>{Te.pulsate(ar)}),j&&j(ar),A&&ar.target===ar.currentTarget&&at()&&ar.key===" "&&!ar.defaultPrevented&&A(ar)});let $t=c;$t==="button"&&(Le.href||Le.to)&&($t=E);const cr={};$t==="button"?(cr.type=_e===void 0?"button":_e,cr.disabled=f):(!Le.href&&!Le.to&&(cr.role="button"),f&&(cr["aria-disabled"]=f));const _t=Uo(r,ye),gr={...n,centerRipple:a,component:c,disabled:f,disableRipple:d,disableTouchRipple:m,focusRipple:b,tabIndex:ae,focusVisible:Me},mr=efe(gr);return J.jsxs(tfe,{as:$t,className:An(mr.root,o),ownerState:gr,onBlur:be,onClick:A,onContextMenu:De,onFocus:Ot,onKeyDown:$e,onKeyUp:Xt,onMouseDown:we,onMouseLeave:Be,onMouseUp:Xe,onDragLeave:Fe,onTouchEnd:Qe,onTouchMove:it,onTouchStart:st,ref:_t,tabIndex:f?-1:ae,type:_e,...cr,...Le,children:[s,Se?J.jsx(Kce,{ref:Ie,center:a,...se}):null]})});function Kd(t,e,r,n=!1){return ou(i=>(r&&r(i),n||t[e](i),!0))}function rfe(t){return gi("MuiAccordionSummary",t)}const a0=pi("MuiAccordionSummary",["root","expanded","focusVisible","disabled","gutters","contentGutters","content","expandIconWrapper"]),nfe=t=>{const{classes:e,expanded:r,disabled:n,disableGutters:i}=t;return mi({root:["root",r&&"expanded",n&&"disabled",!i&&"gutters"],focusVisible:["focusVisible"],content:["content",r&&"expanded",!i&&"contentGutters"],expandIconWrapper:["expandIconWrapper",r&&"expanded"]},rfe,e)},ife=Dr(d_,{name:"MuiAccordionSummary",slot:"Root"})(ci(({theme:t})=>{const e={duration:t.transitions.duration.shortest};return{display:"flex",width:"100%",minHeight:48,padding:t.spacing(0,2),transition:t.transitions.create(["min-height","background-color"],e),[`&.${a0.focusVisible}`]:{backgroundColor:(t.vars||t).palette.action.focus},[`&.${a0.disabled}`]:{opacity:(t.vars||t).palette.action.disabledOpacity},[`&:hover:not(.${a0.disabled})`]:{cursor:"pointer"},variants:[{props:r=>!r.disableGutters,style:{[`&.${a0.expanded}`]:{minHeight:64}}}]}})),afe=Dr("span",{name:"MuiAccordionSummary",slot:"Content"})(ci(({theme:t})=>({display:"flex",textAlign:"start",flexGrow:1,margin:"12px 0",variants:[{props:e=>!e.disableGutters,style:{transition:t.transitions.create(["margin"],{duration:t.transitions.duration.shortest}),[`&.${a0.expanded}`]:{margin:"20px 0"}}}]}))),ofe=Dr("span",{name:"MuiAccordionSummary",slot:"ExpandIconWrapper"})(ci(({theme:t})=>({display:"flex",color:(t.vars||t).palette.action.active,transform:"rotate(0deg)",transition:t.transitions.create("transform",{duration:t.transitions.duration.shortest}),[`&.${a0.expanded}`]:{transform:"rotate(180deg)"}}))),sfe=te.forwardRef(function(e,r){const n=bi({props:e,name:"MuiAccordionSummary"}),{children:i,className:a,expandIcon:s,focusVisibleClassName:o,onClick:c,slots:f,slotProps:d,...m}=n,{disabled:b=!1,disableGutters:x,expanded:E,toggle:T}=te.useContext($X),A=oe=>{T&&T(oe),c&&c(oe)},M={...n,expanded:E,disabled:b,disableGutters:x},F=nfe(M),N={slots:f,slotProps:d},[O,U]=Ei("root",{ref:r,shouldForwardComponentProp:!0,className:An(F.root,a),elementType:ife,externalForwardedProps:{...N,...m},ownerState:M,additionalProps:{focusRipple:!1,disableRipple:!0,disabled:b,"aria-expanded":E,focusVisibleClassName:An(F.focusVisible,o)},getSlotProps:oe=>({...oe,onClick:Q=>{oe.onClick?.(Q),A(Q)}})}),[j,H]=Ei("content",{className:F.content,elementType:afe,externalForwardedProps:N,ownerState:M}),[W,X]=Ei("expandIconWrapper",{className:F.expandIconWrapper,elementType:ofe,externalForwardedProps:N,ownerState:M});return J.jsxs(O,{...U,children:[J.jsx(j,{...H,children:i}),s&&J.jsx(W,{...X,children:s})]})});function lfe(t){return typeof t.main=="string"}function ufe(t,e=[]){if(!lfe(t))return!1;for(const r of e)if(!t.hasOwnProperty(r)||typeof t[r]!="string")return!1;return!0}function jl(t=[]){return([,e])=>e&&ufe(e,t)}function cfe(t){return gi("MuiCircularProgress",t)}pi("MuiCircularProgress",["root","determinate","indeterminate","colorPrimary","colorSecondary","svg","circle","circleDeterminate","circleIndeterminate","circleDisableShrink"]);const Kp=44,Lk=Cx`
  0% {
    transform: rotate(0deg);
  }

  100% {
    transform: rotate(360deg);
  }
`,Fk=Cx`
  0% {
    stroke-dasharray: 1px, 200px;
    stroke-dashoffset: 0;
  }

  50% {
    stroke-dasharray: 100px, 200px;
    stroke-dashoffset: -15px;
  }

  100% {
    stroke-dasharray: 1px, 200px;
    stroke-dashoffset: -126px;
  }
`,ffe=typeof Lk!="string"?ND`
        animation: ${Lk} 1.4s linear infinite;
      `:null,hfe=typeof Fk!="string"?ND`
        animation: ${Fk} 1.4s ease-in-out infinite;
      `:null,dfe=t=>{const{classes:e,variant:r,color:n,disableShrink:i}=t,a={root:["root",r,`color${cn(n)}`],svg:["svg"],circle:["circle",`circle${cn(r)}`,i&&"circleDisableShrink"]};return mi(a,cfe,e)},pfe=Dr("span",{name:"MuiCircularProgress",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.root,e[r.variant],e[`color${cn(r.color)}`]]}})(ci(({theme:t})=>({display:"inline-block",variants:[{props:{variant:"determinate"},style:{transition:t.transitions.create("transform")}},{props:{variant:"indeterminate"},style:ffe||{animation:`${Lk} 1.4s linear infinite`}},...Object.entries(t.palette).filter(jl()).map(([e])=>({props:{color:e},style:{color:(t.vars||t).palette[e].main}}))]}))),gfe=Dr("svg",{name:"MuiCircularProgress",slot:"Svg"})({display:"block"}),mfe=Dr("circle",{name:"MuiCircularProgress",slot:"Circle",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.circle,e[`circle${cn(r.variant)}`],r.disableShrink&&e.circleDisableShrink]}})(ci(({theme:t})=>({stroke:"currentColor",variants:[{props:{variant:"determinate"},style:{transition:t.transitions.create("stroke-dashoffset")}},{props:{variant:"indeterminate"},style:{strokeDasharray:"80px, 200px",strokeDashoffset:0}},{props:({ownerState:e})=>e.variant==="indeterminate"&&!e.disableShrink,style:hfe||{animation:`${Fk} 1.4s ease-in-out infinite`}}]}))),WT=te.forwardRef(function(e,r){const n=bi({props:e,name:"MuiCircularProgress"}),{className:i,color:a="primary",disableShrink:s=!1,size:o=40,style:c,thickness:f=3.6,value:d=0,variant:m="indeterminate",...b}=n,x={...n,color:a,disableShrink:s,size:o,thickness:f,value:d,variant:m},E=dfe(x),T={},A={},M={};if(m==="determinate"){const F=2*Math.PI*((Kp-f)/2);T.strokeDasharray=F.toFixed(3),M["aria-valuenow"]=Math.round(d),T.strokeDashoffset=`${((100-d)/100*F).toFixed(3)}px`,A.transform="rotate(-90deg)"}return J.jsx(pfe,{className:An(E.root,i),style:{width:o,height:o,...A,...c},ownerState:x,ref:r,role:"progressbar",...M,...b,children:J.jsx(gfe,{className:E.svg,ownerState:x,viewBox:`${Kp/2} ${Kp/2} ${Kp} ${Kp}`,children:J.jsx(mfe,{className:E.circle,style:T,ownerState:x,cx:Kp,cy:Kp,r:(Kp-f)/2,fill:"none",strokeWidth:f})})})});function yfe(t){return gi("MuiIconButton",t)}const DB=pi("MuiIconButton",["root","disabled","colorInherit","colorPrimary","colorSecondary","colorError","colorInfo","colorSuccess","colorWarning","edgeStart","edgeEnd","sizeSmall","sizeMedium","sizeLarge","loading","loadingIndicator","loadingWrapper"]),vfe=t=>{const{classes:e,disabled:r,color:n,edge:i,size:a,loading:s}=t,o={root:["root",s&&"loading",r&&"disabled",n!=="default"&&`color${cn(n)}`,i&&`edge${cn(i)}`,`size${cn(a)}`],loadingIndicator:["loadingIndicator"],loadingWrapper:["loadingWrapper"]};return mi(o,yfe,e)},_fe=Dr(d_,{name:"MuiIconButton",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.root,r.loading&&e.loading,r.color!=="default"&&e[`color${cn(r.color)}`],r.edge&&e[`edge${cn(r.edge)}`],e[`size${cn(r.size)}`]]}})(ci(({theme:t})=>({textAlign:"center",flex:"0 0 auto",fontSize:t.typography.pxToRem(24),padding:8,borderRadius:"50%",color:(t.vars||t).palette.action.active,transition:t.transitions.create("background-color",{duration:t.transitions.duration.shortest}),variants:[{props:e=>!e.disableRipple,style:{"--IconButton-hoverBg":t.alpha((t.vars||t).palette.action.active,(t.vars||t).palette.action.hoverOpacity),"&:hover":{backgroundColor:"var(--IconButton-hoverBg)","@media (hover: none)":{backgroundColor:"transparent"}}}},{props:{edge:"start"},style:{marginLeft:-12}},{props:{edge:"start",size:"small"},style:{marginLeft:-3}},{props:{edge:"end"},style:{marginRight:-12}},{props:{edge:"end",size:"small"},style:{marginRight:-3}}]})),ci(({theme:t})=>({variants:[{props:{color:"inherit"},style:{color:"inherit"}},...Object.entries(t.palette).filter(jl()).map(([e])=>({props:{color:e},style:{color:(t.vars||t).palette[e].main}})),...Object.entries(t.palette).filter(jl()).map(([e])=>({props:{color:e},style:{"--IconButton-hoverBg":t.alpha((t.vars||t).palette[e].main,(t.vars||t).palette.action.hoverOpacity)}})),{props:{size:"small"},style:{padding:5,fontSize:t.typography.pxToRem(18)}},{props:{size:"large"},style:{padding:12,fontSize:t.typography.pxToRem(28)}}],[`&.${DB.disabled}`]:{backgroundColor:"transparent",color:(t.vars||t).palette.action.disabled},[`&.${DB.loading}`]:{color:"transparent"}}))),bfe=Dr("span",{name:"MuiIconButton",slot:"LoadingIndicator"})(({theme:t})=>({display:"none",position:"absolute",visibility:"visible",top:"50%",left:"50%",transform:"translate(-50%, -50%)",color:(t.vars||t).palette.action.disabled,variants:[{props:{loading:!0},style:{display:"flex"}}]})),Rc=te.forwardRef(function(e,r){const n=bi({props:e,name:"MuiIconButton"}),{edge:i=!1,children:a,className:s,color:o="default",disabled:c=!1,disableFocusRipple:f=!1,size:d="medium",id:m,loading:b=null,loadingIndicator:x,...E}=n,T=Og(m),A=x??J.jsx(WT,{"aria-labelledby":T,color:"inherit",size:16}),M={...n,edge:i,color:o,disabled:c,disableFocusRipple:f,loading:b,loadingIndicator:A,size:d},F=vfe(M);return J.jsxs(_fe,{id:b?T:m,className:An(F.root,s),centerRipple:!0,focusRipple:!f,disabled:c||b,ref:r,...E,ownerState:M,children:[typeof b=="boolean"&&J.jsx("span",{className:F.loadingWrapper,style:{display:"contents"},children:J.jsx(bfe,{className:F.loadingIndicator,ownerState:M,children:b&&A})}),a]})});function xfe(t){return gi("MuiTypography",t)}const OB=pi("MuiTypography",["root","h1","h2","h3","h4","h5","h6","subtitle1","subtitle2","body1","body2","inherit","button","caption","overline","alignLeft","alignRight","alignCenter","alignJustify","noWrap","gutterBottom","paragraph"]),wfe={primary:!0,secondary:!0,error:!0,info:!0,success:!0,warning:!0,textPrimary:!0,textSecondary:!0,textDisabled:!0},Sfe=pce(),Efe=t=>{const{align:e,gutterBottom:r,noWrap:n,paragraph:i,variant:a,classes:s}=t,o={root:["root",a,t.align!=="inherit"&&`align${cn(e)}`,r&&"gutterBottom",n&&"noWrap",i&&"paragraph"]};return mi(o,xfe,s)},Tfe=Dr("span",{name:"MuiTypography",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.root,r.variant&&e[r.variant],r.align!=="inherit"&&e[`align${cn(r.align)}`],r.noWrap&&e.noWrap,r.gutterBottom&&e.gutterBottom,r.paragraph&&e.paragraph]}})(ci(({theme:t})=>({margin:0,variants:[{props:{variant:"inherit"},style:{font:"inherit",lineHeight:"inherit",letterSpacing:"inherit"}},...Object.entries(t.typography).filter(([e,r])=>e!=="inherit"&&r&&typeof r=="object").map(([e,r])=>({props:{variant:e},style:r})),...Object.entries(t.palette).filter(jl()).map(([e])=>({props:{color:e},style:{color:(t.vars||t).palette[e].main}})),...Object.entries(t.palette?.text||{}).filter(([,e])=>typeof e=="string").map(([e])=>({props:{color:`text${cn(e)}`},style:{color:(t.vars||t).palette.text[e]}})),{props:({ownerState:e})=>e.align!=="inherit",style:{textAlign:"var(--Typography-textAlign)"}},{props:({ownerState:e})=>e.noWrap,style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"}},{props:({ownerState:e})=>e.gutterBottom,style:{marginBottom:"0.35em"}},{props:({ownerState:e})=>e.paragraph,style:{marginBottom:16}}]}))),NB={h1:"h1",h2:"h2",h3:"h3",h4:"h4",h5:"h5",h6:"h6",subtitle1:"h6",subtitle2:"h6",body1:"p",body2:"p",inherit:"p"},Ss=te.forwardRef(function(e,r){const{color:n,...i}=bi({props:e,name:"MuiTypography"}),a=!wfe[n],s=Sfe({...i,...a&&{color:n}}),{align:o="inherit",className:c,component:f,gutterBottom:d=!1,noWrap:m=!1,paragraph:b=!1,variant:x="body1",variantMapping:E=NB,...T}=s,A={...s,align:o,color:n,className:c,component:f,gutterBottom:d,noWrap:m,paragraph:b,variant:x,variantMapping:E},M=f||(b?"p":E[x]||NB[x])||"span",F=Efe(A);return J.jsx(Tfe,{as:M,ref:r,className:An(F.root,c),...T,ownerState:A,style:{...o!=="inherit"&&{"--Typography-textAlign":o},...T.style}})});function Cfe(t){return gi("MuiAppBar",t)}pi("MuiAppBar",["root","positionFixed","positionAbsolute","positionSticky","positionStatic","positionRelative","colorDefault","colorPrimary","colorSecondary","colorInherit","colorTransparent","colorError","colorInfo","colorSuccess","colorWarning"]);const Afe=t=>{const{color:e,position:r,classes:n}=t,i={root:["root",`color${cn(e)}`,`position${cn(r)}`]};return mi(i,Cfe,n)},LB=(t,e)=>t?`${t?.replace(")","")}, ${e})`:e,Ife=Dr(hf,{name:"MuiAppBar",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.root,e[`position${cn(r.position)}`],e[`color${cn(r.color)}`]]}})(ci(({theme:t})=>({display:"flex",flexDirection:"column",width:"100%",boxSizing:"border-box",flexShrink:0,variants:[{props:{position:"fixed"},style:{position:"fixed",zIndex:(t.vars||t).zIndex.appBar,top:0,left:"auto",right:0,"@media print":{position:"absolute"}}},{props:{position:"absolute"},style:{position:"absolute",zIndex:(t.vars||t).zIndex.appBar,top:0,left:"auto",right:0}},{props:{position:"sticky"},style:{position:"sticky",zIndex:(t.vars||t).zIndex.appBar,top:0,left:"auto",right:0}},{props:{position:"static"},style:{position:"static"}},{props:{position:"relative"},style:{position:"relative"}},{props:{color:"inherit"},style:{"--AppBar-color":"inherit"}},{props:{color:"default"},style:{"--AppBar-background":t.vars?t.vars.palette.AppBar.defaultBg:t.palette.grey[100],"--AppBar-color":t.vars?t.vars.palette.text.primary:t.palette.getContrastText(t.palette.grey[100]),...t.applyStyles("dark",{"--AppBar-background":t.vars?t.vars.palette.AppBar.defaultBg:t.palette.grey[900],"--AppBar-color":t.vars?t.vars.palette.text.primary:t.palette.getContrastText(t.palette.grey[900])})}},...Object.entries(t.palette).filter(jl(["contrastText"])).map(([e])=>({props:{color:e},style:{"--AppBar-background":(t.vars??t).palette[e].main,"--AppBar-color":(t.vars??t).palette[e].contrastText}})),{props:e=>e.enableColorOnDark===!0&&!["inherit","transparent"].includes(e.color),style:{backgroundColor:"var(--AppBar-background)",color:"var(--AppBar-color)"}},{props:e=>e.enableColorOnDark===!1&&!["inherit","transparent"].includes(e.color),style:{backgroundColor:"var(--AppBar-background)",color:"var(--AppBar-color)",...t.applyStyles("dark",{backgroundColor:t.vars?LB(t.vars.palette.AppBar.darkBg,"var(--AppBar-background)"):null,color:t.vars?LB(t.vars.palette.AppBar.darkColor,"var(--AppBar-color)"):null})}},{props:{color:"transparent"},style:{"--AppBar-background":"transparent","--AppBar-color":"inherit",backgroundColor:"var(--AppBar-background)",color:"var(--AppBar-color)",...t.applyStyles("dark",{backgroundImage:"none"})}}]}))),Pfe=te.forwardRef(function(e,r){const n=bi({props:e,name:"MuiAppBar"}),{className:i,color:a="primary",enableColorOnDark:s=!1,position:o="fixed",...c}=n,f={...n,color:a,position:o,enableColorOnDark:s},d=Afe(f);return J.jsx(Ife,{square:!0,component:"header",ownerState:f,elevation:4,className:An(d.root,i,o==="fixed"&&"mui-fixed"),ref:r,...c})});var Mc="top",qf="bottom",Hf="right",Dc="left",QD="auto",Mx=[Mc,qf,Hf,Dc],B0="start",Bb="end",kfe="clippingParents",WX="viewport",e1="popper",Rfe="reference",FB=Mx.reduce(function(t,e){return t.concat([e+"-"+B0,e+"-"+Bb])},[]),XX=[].concat(Mx,[QD]).reduce(function(t,e){return t.concat([e,e+"-"+B0,e+"-"+Bb])},[]),Mfe="beforeRead",Dfe="read",Ofe="afterRead",Nfe="beforeMain",Lfe="main",Ffe="afterMain",Bfe="beforeWrite",zfe="write",jfe="afterWrite",Ufe=[Mfe,Dfe,Ofe,Nfe,Lfe,Ffe,Bfe,zfe,jfe];function Sd(t){return t?(t.nodeName||"").toLowerCase():null}function df(t){if(t==null)return window;if(t.toString()!=="[object Window]"){var e=t.ownerDocument;return e&&e.defaultView||window}return t}function Zm(t){var e=df(t).Element;return t instanceof e||t instanceof Element}function zf(t){var e=df(t).HTMLElement;return t instanceof e||t instanceof HTMLElement}function eO(t){if(typeof ShadowRoot>"u")return!1;var e=df(t).ShadowRoot;return t instanceof e||t instanceof ShadowRoot}function Vfe(t){var e=t.state;Object.keys(e.elements).forEach(function(r){var n=e.styles[r]||{},i=e.attributes[r]||{},a=e.elements[r];!zf(a)||!Sd(a)||(Object.assign(a.style,n),Object.keys(i).forEach(function(s){var o=i[s];o===!1?a.removeAttribute(s):a.setAttribute(s,o===!0?"":o)}))})}function $fe(t){var e=t.state,r={popper:{position:e.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(e.elements.popper.style,r.popper),e.styles=r,e.elements.arrow&&Object.assign(e.elements.arrow.style,r.arrow),function(){Object.keys(e.elements).forEach(function(n){var i=e.elements[n],a=e.attributes[n]||{},s=Object.keys(e.styles.hasOwnProperty(n)?e.styles[n]:r[n]),o=s.reduce(function(c,f){return c[f]="",c},{});!zf(i)||!Sd(i)||(Object.assign(i.style,o),Object.keys(a).forEach(function(c){i.removeAttribute(c)}))})}}const qfe={name:"applyStyles",enabled:!0,phase:"write",fn:Vfe,effect:$fe,requires:["computeStyles"]};function _d(t){return t.split("-")[0]}var Lm=Math.max,XS=Math.min,z0=Math.round;function Bk(){var t=navigator.userAgentData;return t!=null&&t.brands&&Array.isArray(t.brands)?t.brands.map(function(e){return e.brand+"/"+e.version}).join(" "):navigator.userAgent}function YX(){return!/^((?!chrome|android).)*safari/i.test(Bk())}function j0(t,e,r){e===void 0&&(e=!1),r===void 0&&(r=!1);var n=t.getBoundingClientRect(),i=1,a=1;e&&zf(t)&&(i=t.offsetWidth>0&&z0(n.width)/t.offsetWidth||1,a=t.offsetHeight>0&&z0(n.height)/t.offsetHeight||1);var s=Zm(t)?df(t):window,o=s.visualViewport,c=!YX()&&r,f=(n.left+(c&&o?o.offsetLeft:0))/i,d=(n.top+(c&&o?o.offsetTop:0))/a,m=n.width/i,b=n.height/a;return{width:m,height:b,top:d,right:f+m,bottom:d+b,left:f,x:f,y:d}}function tO(t){var e=j0(t),r=t.offsetWidth,n=t.offsetHeight;return Math.abs(e.width-r)<=1&&(r=e.width),Math.abs(e.height-n)<=1&&(n=e.height),{x:t.offsetLeft,y:t.offsetTop,width:r,height:n}}function ZX(t,e){var r=e.getRootNode&&e.getRootNode();if(t.contains(e))return!0;if(r&&eO(r)){var n=e;do{if(n&&t.isSameNode(n))return!0;n=n.parentNode||n.host}while(n)}return!1}function wp(t){return df(t).getComputedStyle(t)}function Hfe(t){return["table","td","th"].indexOf(Sd(t))>=0}function Lg(t){return((Zm(t)?t.ownerDocument:t.document)||window.document).documentElement}function XT(t){return Sd(t)==="html"?t:t.assignedSlot||t.parentNode||(eO(t)?t.host:null)||Lg(t)}function BB(t){return!zf(t)||wp(t).position==="fixed"?null:t.offsetParent}function Gfe(t){var e=/firefox/i.test(Bk()),r=/Trident/i.test(Bk());if(r&&zf(t)){var n=wp(t);if(n.position==="fixed")return null}var i=XT(t);for(eO(i)&&(i=i.host);zf(i)&&["html","body"].indexOf(Sd(i))<0;){var a=wp(i);if(a.transform!=="none"||a.perspective!=="none"||a.contain==="paint"||["transform","perspective"].indexOf(a.willChange)!==-1||e&&a.willChange==="filter"||e&&a.filter&&a.filter!=="none")return i;i=i.parentNode}return null}function Dx(t){for(var e=df(t),r=BB(t);r&&Hfe(r)&&wp(r).position==="static";)r=BB(r);return r&&(Sd(r)==="html"||Sd(r)==="body"&&wp(r).position==="static")?e:r||Gfe(t)||e}function rO(t){return["top","bottom"].indexOf(t)>=0?"x":"y"}function sb(t,e,r){return Lm(t,XS(e,r))}function Wfe(t,e,r){var n=sb(t,e,r);return n>r?r:n}function KX(){return{top:0,right:0,bottom:0,left:0}}function JX(t){return Object.assign({},KX(),t)}function QX(t,e){return e.reduce(function(r,n){return r[n]=t,r},{})}var Xfe=function(e,r){return e=typeof e=="function"?e(Object.assign({},r.rects,{placement:r.placement})):e,JX(typeof e!="number"?e:QX(e,Mx))};function Yfe(t){var e,r=t.state,n=t.name,i=t.options,a=r.elements.arrow,s=r.modifiersData.popperOffsets,o=_d(r.placement),c=rO(o),f=[Dc,Hf].indexOf(o)>=0,d=f?"height":"width";if(!(!a||!s)){var m=Xfe(i.padding,r),b=tO(a),x=c==="y"?Mc:Dc,E=c==="y"?qf:Hf,T=r.rects.reference[d]+r.rects.reference[c]-s[c]-r.rects.popper[d],A=s[c]-r.rects.reference[c],M=Dx(a),F=M?c==="y"?M.clientHeight||0:M.clientWidth||0:0,N=T/2-A/2,O=m[x],U=F-b[d]-m[E],j=F/2-b[d]/2+N,H=sb(O,j,U),W=c;r.modifiersData[n]=(e={},e[W]=H,e.centerOffset=H-j,e)}}function Zfe(t){var e=t.state,r=t.options,n=r.element,i=n===void 0?"[data-popper-arrow]":n;i!=null&&(typeof i=="string"&&(i=e.elements.popper.querySelector(i),!i)||ZX(e.elements.popper,i)&&(e.elements.arrow=i))}const Kfe={name:"arrow",enabled:!0,phase:"main",fn:Yfe,effect:Zfe,requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function U0(t){return t.split("-")[1]}var Jfe={top:"auto",right:"auto",bottom:"auto",left:"auto"};function Qfe(t,e){var r=t.x,n=t.y,i=e.devicePixelRatio||1;return{x:z0(r*i)/i||0,y:z0(n*i)/i||0}}function zB(t){var e,r=t.popper,n=t.popperRect,i=t.placement,a=t.variation,s=t.offsets,o=t.position,c=t.gpuAcceleration,f=t.adaptive,d=t.roundOffsets,m=t.isFixed,b=s.x,x=b===void 0?0:b,E=s.y,T=E===void 0?0:E,A=typeof d=="function"?d({x,y:T}):{x,y:T};x=A.x,T=A.y;var M=s.hasOwnProperty("x"),F=s.hasOwnProperty("y"),N=Dc,O=Mc,U=window;if(f){var j=Dx(r),H="clientHeight",W="clientWidth";if(j===df(r)&&(j=Lg(r),wp(j).position!=="static"&&o==="absolute"&&(H="scrollHeight",W="scrollWidth")),j=j,i===Mc||(i===Dc||i===Hf)&&a===Bb){O=qf;var X=m&&j===U&&U.visualViewport?U.visualViewport.height:j[H];T-=X-n.height,T*=c?1:-1}if(i===Dc||(i===Mc||i===qf)&&a===Bb){N=Hf;var oe=m&&j===U&&U.visualViewport?U.visualViewport.width:j[W];x-=oe-n.width,x*=c?1:-1}}var Q=Object.assign({position:o},f&&Jfe),G=d===!0?Qfe({x,y:T},df(r)):{x,y:T};if(x=G.x,T=G.y,c){var ae;return Object.assign({},Q,(ae={},ae[O]=F?"0":"",ae[N]=M?"0":"",ae.transform=(U.devicePixelRatio||1)<=1?"translate("+x+"px, "+T+"px)":"translate3d("+x+"px, "+T+"px, 0)",ae))}return Object.assign({},Q,(e={},e[O]=F?T+"px":"",e[N]=M?x+"px":"",e.transform="",e))}function ehe(t){var e=t.state,r=t.options,n=r.gpuAcceleration,i=n===void 0?!0:n,a=r.adaptive,s=a===void 0?!0:a,o=r.roundOffsets,c=o===void 0?!0:o,f={placement:_d(e.placement),variation:U0(e.placement),popper:e.elements.popper,popperRect:e.rects.popper,gpuAcceleration:i,isFixed:e.options.strategy==="fixed"};e.modifiersData.popperOffsets!=null&&(e.styles.popper=Object.assign({},e.styles.popper,zB(Object.assign({},f,{offsets:e.modifiersData.popperOffsets,position:e.options.strategy,adaptive:s,roundOffsets:c})))),e.modifiersData.arrow!=null&&(e.styles.arrow=Object.assign({},e.styles.arrow,zB(Object.assign({},f,{offsets:e.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:c})))),e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-placement":e.placement})}const the={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:ehe,data:{}};var V2={passive:!0};function rhe(t){var e=t.state,r=t.instance,n=t.options,i=n.scroll,a=i===void 0?!0:i,s=n.resize,o=s===void 0?!0:s,c=df(e.elements.popper),f=[].concat(e.scrollParents.reference,e.scrollParents.popper);return a&&f.forEach(function(d){d.addEventListener("scroll",r.update,V2)}),o&&c.addEventListener("resize",r.update,V2),function(){a&&f.forEach(function(d){d.removeEventListener("scroll",r.update,V2)}),o&&c.removeEventListener("resize",r.update,V2)}}const nhe={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:rhe,data:{}};var ihe={left:"right",right:"left",bottom:"top",top:"bottom"};function cS(t){return t.replace(/left|right|bottom|top/g,function(e){return ihe[e]})}var ahe={start:"end",end:"start"};function jB(t){return t.replace(/start|end/g,function(e){return ahe[e]})}function nO(t){var e=df(t),r=e.pageXOffset,n=e.pageYOffset;return{scrollLeft:r,scrollTop:n}}function iO(t){return j0(Lg(t)).left+nO(t).scrollLeft}function ohe(t,e){var r=df(t),n=Lg(t),i=r.visualViewport,a=n.clientWidth,s=n.clientHeight,o=0,c=0;if(i){a=i.width,s=i.height;var f=YX();(f||!f&&e==="fixed")&&(o=i.offsetLeft,c=i.offsetTop)}return{width:a,height:s,x:o+iO(t),y:c}}function she(t){var e,r=Lg(t),n=nO(t),i=(e=t.ownerDocument)==null?void 0:e.body,a=Lm(r.scrollWidth,r.clientWidth,i?i.scrollWidth:0,i?i.clientWidth:0),s=Lm(r.scrollHeight,r.clientHeight,i?i.scrollHeight:0,i?i.clientHeight:0),o=-n.scrollLeft+iO(t),c=-n.scrollTop;return wp(i||r).direction==="rtl"&&(o+=Lm(r.clientWidth,i?i.clientWidth:0)-a),{width:a,height:s,x:o,y:c}}function aO(t){var e=wp(t),r=e.overflow,n=e.overflowX,i=e.overflowY;return/auto|scroll|overlay|hidden/.test(r+i+n)}function eY(t){return["html","body","#document"].indexOf(Sd(t))>=0?t.ownerDocument.body:zf(t)&&aO(t)?t:eY(XT(t))}function lb(t,e){var r;e===void 0&&(e=[]);var n=eY(t),i=n===((r=t.ownerDocument)==null?void 0:r.body),a=df(n),s=i?[a].concat(a.visualViewport||[],aO(n)?n:[]):n,o=e.concat(s);return i?o:o.concat(lb(XT(s)))}function zk(t){return Object.assign({},t,{left:t.x,top:t.y,right:t.x+t.width,bottom:t.y+t.height})}function lhe(t,e){var r=j0(t,!1,e==="fixed");return r.top=r.top+t.clientTop,r.left=r.left+t.clientLeft,r.bottom=r.top+t.clientHeight,r.right=r.left+t.clientWidth,r.width=t.clientWidth,r.height=t.clientHeight,r.x=r.left,r.y=r.top,r}function UB(t,e,r){return e===WX?zk(ohe(t,r)):Zm(e)?lhe(e,r):zk(she(Lg(t)))}function uhe(t){var e=lb(XT(t)),r=["absolute","fixed"].indexOf(wp(t).position)>=0,n=r&&zf(t)?Dx(t):t;return Zm(n)?e.filter(function(i){return Zm(i)&&ZX(i,n)&&Sd(i)!=="body"}):[]}function che(t,e,r,n){var i=e==="clippingParents"?uhe(t):[].concat(e),a=[].concat(i,[r]),s=a[0],o=a.reduce(function(c,f){var d=UB(t,f,n);return c.top=Lm(d.top,c.top),c.right=XS(d.right,c.right),c.bottom=XS(d.bottom,c.bottom),c.left=Lm(d.left,c.left),c},UB(t,s,n));return o.width=o.right-o.left,o.height=o.bottom-o.top,o.x=o.left,o.y=o.top,o}function tY(t){var e=t.reference,r=t.element,n=t.placement,i=n?_d(n):null,a=n?U0(n):null,s=e.x+e.width/2-r.width/2,o=e.y+e.height/2-r.height/2,c;switch(i){case Mc:c={x:s,y:e.y-r.height};break;case qf:c={x:s,y:e.y+e.height};break;case Hf:c={x:e.x+e.width,y:o};break;case Dc:c={x:e.x-r.width,y:o};break;default:c={x:e.x,y:e.y}}var f=i?rO(i):null;if(f!=null){var d=f==="y"?"height":"width";switch(a){case B0:c[f]=c[f]-(e[d]/2-r[d]/2);break;case Bb:c[f]=c[f]+(e[d]/2-r[d]/2);break}}return c}function zb(t,e){e===void 0&&(e={});var r=e,n=r.placement,i=n===void 0?t.placement:n,a=r.strategy,s=a===void 0?t.strategy:a,o=r.boundary,c=o===void 0?kfe:o,f=r.rootBoundary,d=f===void 0?WX:f,m=r.elementContext,b=m===void 0?e1:m,x=r.altBoundary,E=x===void 0?!1:x,T=r.padding,A=T===void 0?0:T,M=JX(typeof A!="number"?A:QX(A,Mx)),F=b===e1?Rfe:e1,N=t.rects.popper,O=t.elements[E?F:b],U=che(Zm(O)?O:O.contextElement||Lg(t.elements.popper),c,d,s),j=j0(t.elements.reference),H=tY({reference:j,element:N,placement:i}),W=zk(Object.assign({},N,H)),X=b===e1?W:j,oe={top:U.top-X.top+M.top,bottom:X.bottom-U.bottom+M.bottom,left:U.left-X.left+M.left,right:X.right-U.right+M.right},Q=t.modifiersData.offset;if(b===e1&&Q){var G=Q[i];Object.keys(oe).forEach(function(ae){var se=[Hf,qf].indexOf(ae)>=0?1:-1,fe=[Mc,qf].indexOf(ae)>=0?"y":"x";oe[ae]+=G[fe]*se})}return oe}function fhe(t,e){e===void 0&&(e={});var r=e,n=r.placement,i=r.boundary,a=r.rootBoundary,s=r.padding,o=r.flipVariations,c=r.allowedAutoPlacements,f=c===void 0?XX:c,d=U0(n),m=d?o?FB:FB.filter(function(E){return U0(E)===d}):Mx,b=m.filter(function(E){return f.indexOf(E)>=0});b.length===0&&(b=m);var x=b.reduce(function(E,T){return E[T]=zb(t,{placement:T,boundary:i,rootBoundary:a,padding:s})[_d(T)],E},{});return Object.keys(x).sort(function(E,T){return x[E]-x[T]})}function hhe(t){if(_d(t)===QD)return[];var e=cS(t);return[jB(t),e,jB(e)]}function dhe(t){var e=t.state,r=t.options,n=t.name;if(!e.modifiersData[n]._skip){for(var i=r.mainAxis,a=i===void 0?!0:i,s=r.altAxis,o=s===void 0?!0:s,c=r.fallbackPlacements,f=r.padding,d=r.boundary,m=r.rootBoundary,b=r.altBoundary,x=r.flipVariations,E=x===void 0?!0:x,T=r.allowedAutoPlacements,A=e.options.placement,M=_d(A),F=M===A,N=c||(F||!E?[cS(A)]:hhe(A)),O=[A].concat(N).reduce(function(we,De){return we.concat(_d(De)===QD?fhe(e,{placement:De,boundary:d,rootBoundary:m,padding:f,flipVariations:E,allowedAutoPlacements:T}):De)},[]),U=e.rects.reference,j=e.rects.popper,H=new Map,W=!0,X=O[0],oe=0;oe<O.length;oe++){var Q=O[oe],G=_d(Q),ae=U0(Q)===B0,se=[Mc,qf].indexOf(G)>=0,fe=se?"width":"height",_e=zb(e,{placement:Q,boundary:d,rootBoundary:m,altBoundary:b,padding:f}),Le=se?ae?Hf:Dc:ae?qf:Mc;U[fe]>j[fe]&&(Le=cS(Le));var ye=cS(Le),Te=[];if(a&&Te.push(_e[G]<=0),o&&Te.push(_e[Le]<=0,_e[ye]<=0),Te.every(function(we){return we})){X=Q,W=!1;break}H.set(Q,Te)}if(W)for(var Ie=E?3:1,Me=function(De){var Fe=O.find(function(Xe){var Be=H.get(Xe);if(Be)return Be.slice(0,De).every(function(st){return st})});if(Fe)return X=Fe,"break"},de=Ie;de>0;de--){var Se=Me(de);if(Se==="break")break}e.placement!==X&&(e.modifiersData[n]._skip=!0,e.placement=X,e.reset=!0)}}const phe={name:"flip",enabled:!0,phase:"main",fn:dhe,requiresIfExists:["offset"],data:{_skip:!1}};function VB(t,e,r){return r===void 0&&(r={x:0,y:0}),{top:t.top-e.height-r.y,right:t.right-e.width+r.x,bottom:t.bottom-e.height+r.y,left:t.left-e.width-r.x}}function $B(t){return[Mc,Hf,qf,Dc].some(function(e){return t[e]>=0})}function ghe(t){var e=t.state,r=t.name,n=e.rects.reference,i=e.rects.popper,a=e.modifiersData.preventOverflow,s=zb(e,{elementContext:"reference"}),o=zb(e,{altBoundary:!0}),c=VB(s,n),f=VB(o,i,a),d=$B(c),m=$B(f);e.modifiersData[r]={referenceClippingOffsets:c,popperEscapeOffsets:f,isReferenceHidden:d,hasPopperEscaped:m},e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-reference-hidden":d,"data-popper-escaped":m})}const mhe={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:ghe};function yhe(t,e,r){var n=_d(t),i=[Dc,Mc].indexOf(n)>=0?-1:1,a=typeof r=="function"?r(Object.assign({},e,{placement:t})):r,s=a[0],o=a[1];return s=s||0,o=(o||0)*i,[Dc,Hf].indexOf(n)>=0?{x:o,y:s}:{x:s,y:o}}function vhe(t){var e=t.state,r=t.options,n=t.name,i=r.offset,a=i===void 0?[0,0]:i,s=XX.reduce(function(d,m){return d[m]=yhe(m,e.rects,a),d},{}),o=s[e.placement],c=o.x,f=o.y;e.modifiersData.popperOffsets!=null&&(e.modifiersData.popperOffsets.x+=c,e.modifiersData.popperOffsets.y+=f),e.modifiersData[n]=s}const _he={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:vhe};function bhe(t){var e=t.state,r=t.name;e.modifiersData[r]=tY({reference:e.rects.reference,element:e.rects.popper,placement:e.placement})}const xhe={name:"popperOffsets",enabled:!0,phase:"read",fn:bhe,data:{}};function whe(t){return t==="x"?"y":"x"}function She(t){var e=t.state,r=t.options,n=t.name,i=r.mainAxis,a=i===void 0?!0:i,s=r.altAxis,o=s===void 0?!1:s,c=r.boundary,f=r.rootBoundary,d=r.altBoundary,m=r.padding,b=r.tether,x=b===void 0?!0:b,E=r.tetherOffset,T=E===void 0?0:E,A=zb(e,{boundary:c,rootBoundary:f,padding:m,altBoundary:d}),M=_d(e.placement),F=U0(e.placement),N=!F,O=rO(M),U=whe(O),j=e.modifiersData.popperOffsets,H=e.rects.reference,W=e.rects.popper,X=typeof T=="function"?T(Object.assign({},e.rects,{placement:e.placement})):T,oe=typeof X=="number"?{mainAxis:X,altAxis:X}:Object.assign({mainAxis:0,altAxis:0},X),Q=e.modifiersData.offset?e.modifiersData.offset[e.placement]:null,G={x:0,y:0};if(j){if(a){var ae,se=O==="y"?Mc:Dc,fe=O==="y"?qf:Hf,_e=O==="y"?"height":"width",Le=j[O],ye=Le+A[se],Te=Le-A[fe],Ie=x?-W[_e]/2:0,Me=F===B0?H[_e]:W[_e],de=F===B0?-W[_e]:-H[_e],Se=e.elements.arrow,we=x&&Se?tO(Se):{width:0,height:0},De=e.modifiersData["arrow#persistent"]?e.modifiersData["arrow#persistent"].padding:KX(),Fe=De[se],Xe=De[fe],Be=sb(0,H[_e],we[_e]),st=N?H[_e]/2-Ie-Be-Fe-oe.mainAxis:Me-Be-Fe-oe.mainAxis,Qe=N?-H[_e]/2+Ie+Be+Xe+oe.mainAxis:de+Be+Xe+oe.mainAxis,it=e.elements.arrow&&Dx(e.elements.arrow),be=it?O==="y"?it.clientTop||0:it.clientLeft||0:0,Ot=(ae=Q?.[O])!=null?ae:0,at=Le+st-Ot-be,$e=Le+Qe-Ot,Xt=sb(x?XS(ye,at):ye,Le,x?Lm(Te,$e):Te);j[O]=Xt,G[O]=Xt-Le}if(o){var $t,cr=O==="x"?Mc:Dc,_t=O==="x"?qf:Hf,gr=j[U],mr=U==="y"?"height":"width",ar=gr+A[cr],Cr=gr-A[_t],Er=[Mc,Dc].indexOf(M)!==-1,Jt=($t=Q?.[U])!=null?$t:0,ot=Er?ar:gr-H[mr]-W[mr]-Jt+oe.altAxis,Ce=Er?gr+H[mr]+W[mr]-Jt-oe.altAxis:Cr,xe=x&&Er?Wfe(ot,gr,Ce):sb(x?ot:ar,gr,x?Ce:Cr);j[U]=xe,G[U]=xe-gr}e.modifiersData[n]=G}}const Ehe={name:"preventOverflow",enabled:!0,phase:"main",fn:She,requiresIfExists:["offset"]};function The(t){return{scrollLeft:t.scrollLeft,scrollTop:t.scrollTop}}function Che(t){return t===df(t)||!zf(t)?nO(t):The(t)}function Ahe(t){var e=t.getBoundingClientRect(),r=z0(e.width)/t.offsetWidth||1,n=z0(e.height)/t.offsetHeight||1;return r!==1||n!==1}function Ihe(t,e,r){r===void 0&&(r=!1);var n=zf(e),i=zf(e)&&Ahe(e),a=Lg(e),s=j0(t,i,r),o={scrollLeft:0,scrollTop:0},c={x:0,y:0};return(n||!n&&!r)&&((Sd(e)!=="body"||aO(a))&&(o=Che(e)),zf(e)?(c=j0(e,!0),c.x+=e.clientLeft,c.y+=e.clientTop):a&&(c.x=iO(a))),{x:s.left+o.scrollLeft-c.x,y:s.top+o.scrollTop-c.y,width:s.width,height:s.height}}function Phe(t){var e=new Map,r=new Set,n=[];t.forEach(function(a){e.set(a.name,a)});function i(a){r.add(a.name);var s=[].concat(a.requires||[],a.requiresIfExists||[]);s.forEach(function(o){if(!r.has(o)){var c=e.get(o);c&&i(c)}}),n.push(a)}return t.forEach(function(a){r.has(a.name)||i(a)}),n}function khe(t){var e=Phe(t);return Ufe.reduce(function(r,n){return r.concat(e.filter(function(i){return i.phase===n}))},[])}function Rhe(t){var e;return function(){return e||(e=new Promise(function(r){Promise.resolve().then(function(){e=void 0,r(t())})})),e}}function Mhe(t){var e=t.reduce(function(r,n){var i=r[n.name];return r[n.name]=i?Object.assign({},i,n,{options:Object.assign({},i.options,n.options),data:Object.assign({},i.data,n.data)}):n,r},{});return Object.keys(e).map(function(r){return e[r]})}var qB={placement:"bottom",modifiers:[],strategy:"absolute"};function HB(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];return!e.some(function(n){return!(n&&typeof n.getBoundingClientRect=="function")})}function Dhe(t){t===void 0&&(t={});var e=t,r=e.defaultModifiers,n=r===void 0?[]:r,i=e.defaultOptions,a=i===void 0?qB:i;return function(o,c,f){f===void 0&&(f=a);var d={placement:"bottom",orderedModifiers:[],options:Object.assign({},qB,a),modifiersData:{},elements:{reference:o,popper:c},attributes:{},styles:{}},m=[],b=!1,x={state:d,setOptions:function(M){var F=typeof M=="function"?M(d.options):M;T(),d.options=Object.assign({},a,d.options,F),d.scrollParents={reference:Zm(o)?lb(o):o.contextElement?lb(o.contextElement):[],popper:lb(c)};var N=khe(Mhe([].concat(n,d.options.modifiers)));return d.orderedModifiers=N.filter(function(O){return O.enabled}),E(),x.update()},forceUpdate:function(){if(!b){var M=d.elements,F=M.reference,N=M.popper;if(HB(F,N)){d.rects={reference:Ihe(F,Dx(N),d.options.strategy==="fixed"),popper:tO(N)},d.reset=!1,d.placement=d.options.placement,d.orderedModifiers.forEach(function(oe){return d.modifiersData[oe.name]=Object.assign({},oe.data)});for(var O=0;O<d.orderedModifiers.length;O++){if(d.reset===!0){d.reset=!1,O=-1;continue}var U=d.orderedModifiers[O],j=U.fn,H=U.options,W=H===void 0?{}:H,X=U.name;typeof j=="function"&&(d=j({state:d,options:W,name:X,instance:x})||d)}}}},update:Rhe(function(){return new Promise(function(A){x.forceUpdate(),A(d)})}),destroy:function(){T(),b=!0}};if(!HB(o,c))return x;x.setOptions(f).then(function(A){!b&&f.onFirstUpdate&&f.onFirstUpdate(A)});function E(){d.orderedModifiers.forEach(function(A){var M=A.name,F=A.options,N=F===void 0?{}:F,O=A.effect;if(typeof O=="function"){var U=O({state:d,name:M,instance:x,options:N}),j=function(){};m.push(U||j)}})}function T(){m.forEach(function(A){return A()}),m=[]}return x}}var Ohe=[nhe,xhe,the,qfe,_he,phe,Ehe,Kfe,mhe],Nhe=Dhe({defaultModifiers:Ohe});function od(t){const{elementType:e,externalSlotProps:r,ownerState:n,skipResolvingSlotProps:i=!1,...a}=t,s=i?{}:HX(r,n),{props:o,internalRef:c}=GX({...a,externalSlotProps:s}),f=Uo(c,s?.ref,t.additionalProps?.ref);return qX(e,{...o,ref:f},n)}function Fg(t){return parseInt(te.version,10)>=19?t?.props?.ref||null:t?.ref||null}function Lhe(t){return typeof t=="function"?t():t}const rY=te.forwardRef(function(e,r){const{children:n,container:i,disablePortal:a=!1}=e,[s,o]=te.useState(null),c=Uo(te.isValidElement(n)?Fg(n):null,r);if(Tu(()=>{a||o(Lhe(i)||document.body)},[i,a]),Tu(()=>{if(s&&!a)return PB(r,s),()=>{PB(r,null)}},[r,s,a]),a){if(te.isValidElement(n)){const f={ref:c};return te.cloneElement(n,f)}return n}return s&&fp.createPortal(n,s)});function Fhe(t){return gi("MuiPopper",t)}pi("MuiPopper",["root"]);function Bhe(t,e){if(e==="ltr")return t;switch(t){case"bottom-end":return"bottom-start";case"bottom-start":return"bottom-end";case"top-end":return"top-start";case"top-start":return"top-end";default:return t}}function jk(t){return typeof t=="function"?t():t}function zhe(t){return t.nodeType!==void 0}const jhe=t=>{const{classes:e}=t;return mi({root:["root"]},Fhe,e)},Uhe={},Vhe=te.forwardRef(function(e,r){const{anchorEl:n,children:i,direction:a,disablePortal:s,modifiers:o,open:c,placement:f,popperOptions:d,popperRef:m,slotProps:b={},slots:x={},TransitionProps:E,ownerState:T,...A}=e,M=te.useRef(null),F=Uo(M,r),N=te.useRef(null),O=Uo(N,m),U=te.useRef(O);Tu(()=>{U.current=O},[O]),te.useImperativeHandle(m,()=>N.current,[]);const j=Bhe(f,a),[H,W]=te.useState(j),[X,oe]=te.useState(jk(n));te.useEffect(()=>{N.current&&N.current.forceUpdate()}),te.useEffect(()=>{n&&oe(jk(n))},[n]),Tu(()=>{if(!X||!c)return;const fe=ye=>{W(ye.placement)};let _e=[{name:"preventOverflow",options:{altBoundary:s}},{name:"flip",options:{altBoundary:s}},{name:"onUpdate",enabled:!0,phase:"afterWrite",fn:({state:ye})=>{fe(ye)}}];o!=null&&(_e=_e.concat(o)),d&&d.modifiers!=null&&(_e=_e.concat(d.modifiers));const Le=Nhe(X,M.current,{placement:j,...d,modifiers:_e});return U.current(Le),()=>{Le.destroy(),U.current(null)}},[X,s,o,c,d,j]);const Q={placement:H};E!==null&&(Q.TransitionProps=E);const G=jhe(e),ae=x.root??"div",se=od({elementType:ae,externalSlotProps:b.root,externalForwardedProps:A,additionalProps:{role:"tooltip",ref:F},ownerState:e,className:G.root});return J.jsx(ae,{...se,children:typeof i=="function"?i(Q):i})}),$he=te.forwardRef(function(e,r){const{anchorEl:n,children:i,container:a,direction:s="ltr",disablePortal:o=!1,keepMounted:c=!1,modifiers:f,open:d,placement:m="bottom",popperOptions:b=Uhe,popperRef:x,style:E,transition:T=!1,slotProps:A={},slots:M={},...F}=e,[N,O]=te.useState(!0),U=()=>{O(!1)},j=()=>{O(!0)};if(!c&&!d&&(!T||N))return null;let H;if(a)H=a;else if(n){const oe=jk(n);H=oe&&zhe(oe)?cs(oe).body:cs(null).body}const W=!d&&c&&(!T||N)?"none":void 0,X=T?{in:d,onEnter:U,onExited:j}:void 0;return J.jsx(rY,{disablePortal:o,container:H,children:J.jsx(Vhe,{anchorEl:n,direction:s,disablePortal:o,modifiers:f,ref:r,open:T?!N:d,placement:m,popperOptions:b,popperRef:x,slotProps:A,slots:M,...F,style:{position:"fixed",top:0,left:0,display:W,...E},TransitionProps:X,children:i})})}),qhe=Dr($he,{name:"MuiPopper",slot:"Root"})({}),nY=te.forwardRef(function(e,r){const n=Rx(),i=bi({props:e,name:"MuiPopper"}),{anchorEl:a,component:s,components:o,componentsProps:c,container:f,disablePortal:d,keepMounted:m,modifiers:b,open:x,placement:E,popperOptions:T,popperRef:A,transition:M,slots:F,slotProps:N,...O}=i,U=F?.root??o?.Root,j={anchorEl:a,container:f,disablePortal:d,keepMounted:m,modifiers:b,open:x,placement:E,popperOptions:T,popperRef:A,transition:M,...O};return J.jsx(qhe,{as:s,direction:n?"rtl":"ltr",slots:{root:U},slotProps:N??c,...j,ref:r})});function $2(t){return parseInt(t,10)||0}const Hhe={shadow:{visibility:"hidden",position:"absolute",overflow:"hidden",height:0,top:0,left:0,transform:"translateZ(0)"}};function Ghe(t){for(const e in t)return!1;return!0}function GB(t){return Ghe(t)||t.outerHeightStyle===0&&!t.overflowing}const Whe=te.forwardRef(function(e,r){const{onChange:n,maxRows:i,minRows:a=1,style:s,value:o,...c}=e,{current:f}=te.useRef(o!=null),d=te.useRef(null),m=Uo(r,d),b=te.useRef(null),x=te.useRef(null),E=te.useCallback(()=>{const N=d.current,O=x.current;if(!N||!O)return;const j=bc(N).getComputedStyle(N);if(j.width==="0px")return{outerHeightStyle:0,overflowing:!1};O.style.width=j.width,O.value=N.value||e.placeholder||"x",O.value.slice(-1)===`
`&&(O.value+=" ");const H=j.boxSizing,W=$2(j.paddingBottom)+$2(j.paddingTop),X=$2(j.borderBottomWidth)+$2(j.borderTopWidth),oe=O.scrollHeight;O.value="x";const Q=O.scrollHeight;let G=oe;a&&(G=Math.max(Number(a)*Q,G)),i&&(G=Math.min(Number(i)*Q,G)),G=Math.max(G,Q);const ae=G+(H==="border-box"?W+X:0),se=Math.abs(G-oe)<=1;return{outerHeightStyle:ae,overflowing:se}},[i,a,e.placeholder]),T=ou(()=>{const N=d.current,O=E();if(!N||!O||GB(O))return!1;const U=O.outerHeightStyle;return b.current!=null&&b.current!==U}),A=te.useCallback(()=>{const N=d.current,O=E();if(!N||!O||GB(O))return;const U=O.outerHeightStyle;b.current!==U&&(b.current=U,N.style.height=`${U}px`),N.style.overflow=O.overflowing?"hidden":""},[E]),M=te.useRef(-1);Tu(()=>{const N=YD(A),O=d?.current;if(!O)return;const U=bc(O);U.addEventListener("resize",N);let j;return typeof ResizeObserver<"u"&&(j=new ResizeObserver(()=>{T()&&(j.unobserve(O),cancelAnimationFrame(M.current),A(),M.current=requestAnimationFrame(()=>{j.observe(O)}))}),j.observe(O)),()=>{N.clear(),cancelAnimationFrame(M.current),U.removeEventListener("resize",N),j&&j.disconnect()}},[E,A,T]),Tu(()=>{A()});const F=N=>{f||A();const O=N.target,U=O.value.length,j=O.value.endsWith(`
`),H=O.selectionStart===U;j&&H&&O.setSelectionRange(U,U),n&&n(N)};return J.jsxs(te.Fragment,{children:[J.jsx("textarea",{value:o,onChange:F,ref:m,rows:a,style:s,...c}),J.jsx("textarea",{"aria-hidden":!0,className:e.className,readOnly:!0,ref:x,tabIndex:-1,style:{...Hhe.shadow,...s,paddingTop:0,paddingBottom:0}})]})});function Bg({props:t,states:e,muiFormControl:r}){return e.reduce((n,i)=>(n[i]=t[i],r&&typeof t[i]>"u"&&(n[i]=r[i]),n),{})}const oO=te.createContext(void 0);function Pd(){return te.useContext(oO)}function WB(t){return t!=null&&!(Array.isArray(t)&&t.length===0)}function YS(t,e=!1){return t&&(WB(t.value)&&t.value!==""||e&&WB(t.defaultValue)&&t.defaultValue!=="")}function Xhe(t){return t.startAdornment}function Yhe(t){return gi("MuiInputBase",t)}const V0=pi("MuiInputBase",["root","formControl","focused","disabled","adornedStart","adornedEnd","error","sizeSmall","multiline","colorSecondary","fullWidth","hiddenLabel","readOnly","input","inputSizeSmall","inputMultiline","inputTypeSearch","inputAdornedStart","inputAdornedEnd","inputHiddenLabel"]);var XB;const YT=(t,e)=>{const{ownerState:r}=t;return[e.root,r.formControl&&e.formControl,r.startAdornment&&e.adornedStart,r.endAdornment&&e.adornedEnd,r.error&&e.error,r.size==="small"&&e.sizeSmall,r.multiline&&e.multiline,r.color&&e[`color${cn(r.color)}`],r.fullWidth&&e.fullWidth,r.hiddenLabel&&e.hiddenLabel]},ZT=(t,e)=>{const{ownerState:r}=t;return[e.input,r.size==="small"&&e.inputSizeSmall,r.multiline&&e.inputMultiline,r.type==="search"&&e.inputTypeSearch,r.startAdornment&&e.inputAdornedStart,r.endAdornment&&e.inputAdornedEnd,r.hiddenLabel&&e.inputHiddenLabel]},Zhe=t=>{const{classes:e,color:r,disabled:n,error:i,endAdornment:a,focused:s,formControl:o,fullWidth:c,hiddenLabel:f,multiline:d,readOnly:m,size:b,startAdornment:x,type:E}=t,T={root:["root",`color${cn(r)}`,n&&"disabled",i&&"error",c&&"fullWidth",s&&"focused",o&&"formControl",b&&b!=="medium"&&`size${cn(b)}`,d&&"multiline",x&&"adornedStart",a&&"adornedEnd",f&&"hiddenLabel",m&&"readOnly"],input:["input",n&&"disabled",E==="search"&&"inputTypeSearch",d&&"inputMultiline",b==="small"&&"inputSizeSmall",f&&"inputHiddenLabel",x&&"inputAdornedStart",a&&"inputAdornedEnd",m&&"readOnly"]};return mi(T,Yhe,e)},KT=Dr("div",{name:"MuiInputBase",slot:"Root",overridesResolver:YT})(ci(({theme:t})=>({...t.typography.body1,color:(t.vars||t).palette.text.primary,lineHeight:"1.4375em",boxSizing:"border-box",position:"relative",cursor:"text",display:"inline-flex",alignItems:"center",[`&.${V0.disabled}`]:{color:(t.vars||t).palette.text.disabled,cursor:"default"},variants:[{props:({ownerState:e})=>e.multiline,style:{padding:"4px 0 5px"}},{props:({ownerState:e,size:r})=>e.multiline&&r==="small",style:{paddingTop:1}},{props:({ownerState:e})=>e.fullWidth,style:{width:"100%"}}]}))),JT=Dr("input",{name:"MuiInputBase",slot:"Input",overridesResolver:ZT})(ci(({theme:t})=>{const e=t.palette.mode==="light",r={color:"currentColor",...t.vars?{opacity:t.vars.opacity.inputPlaceholder}:{opacity:e?.42:.5},transition:t.transitions.create("opacity",{duration:t.transitions.duration.shorter})},n={opacity:"0 !important"},i=t.vars?{opacity:t.vars.opacity.inputPlaceholder}:{opacity:e?.42:.5};return{font:"inherit",letterSpacing:"inherit",color:"currentColor",padding:"4px 0 5px",border:0,boxSizing:"content-box",background:"none",height:"1.4375em",margin:0,WebkitTapHighlightColor:"transparent",display:"block",minWidth:0,width:"100%","&::-webkit-input-placeholder":r,"&::-moz-placeholder":r,"&::-ms-input-placeholder":r,"&:focus":{outline:0},"&:invalid":{boxShadow:"none"},"&::-webkit-search-decoration":{WebkitAppearance:"none"},[`label[data-shrink=false] + .${V0.formControl} &`]:{"&::-webkit-input-placeholder":n,"&::-moz-placeholder":n,"&::-ms-input-placeholder":n,"&:focus::-webkit-input-placeholder":i,"&:focus::-moz-placeholder":i,"&:focus::-ms-input-placeholder":i},[`&.${V0.disabled}`]:{opacity:1,WebkitTextFillColor:(t.vars||t).palette.text.disabled},variants:[{props:({ownerState:a})=>!a.disableInjectingGlobalStyles,style:{animationName:"mui-auto-fill-cancel",animationDuration:"10ms","&:-webkit-autofill":{animationDuration:"5000s",animationName:"mui-auto-fill"}}},{props:{size:"small"},style:{paddingTop:1}},{props:({ownerState:a})=>a.multiline,style:{height:"auto",resize:"none",padding:0,paddingTop:0}},{props:{type:"search"},style:{MozAppearance:"textfield"}}]}})),YB=dce({"@keyframes mui-auto-fill":{from:{display:"block"}},"@keyframes mui-auto-fill-cancel":{from:{display:"block"}}}),sO=te.forwardRef(function(e,r){const n=bi({props:e,name:"MuiInputBase"}),{"aria-describedby":i,autoComplete:a,autoFocus:s,className:o,color:c,components:f={},componentsProps:d={},defaultValue:m,disabled:b,disableInjectingGlobalStyles:x,endAdornment:E,error:T,fullWidth:A=!1,id:M,inputComponent:F="input",inputProps:N={},inputRef:O,margin:U,maxRows:j,minRows:H,multiline:W=!1,name:X,onBlur:oe,onChange:Q,onClick:G,onFocus:ae,onKeyDown:se,onKeyUp:fe,placeholder:_e,readOnly:Le,renderSuffix:ye,rows:Te,size:Ie,slotProps:Me={},slots:de={},startAdornment:Se,type:we="text",value:De,...Fe}=n,Xe=N.value!=null?N.value:De,{current:Be}=te.useRef(Xe!=null),st=te.useRef(),Qe=te.useCallback(Ge=>{},[]),it=Uo(st,O,N.ref,Qe),[be,Ot]=te.useState(!1),at=Pd(),$e=Bg({props:n,muiFormControl:at,states:["color","disabled","error","hiddenLabel","size","required","filled"]});$e.focused=at?at.focused:be,te.useEffect(()=>{!at&&b&&be&&(Ot(!1),oe&&oe())},[at,b,be,oe]);const Xt=at&&at.onFilled,$t=at&&at.onEmpty,cr=te.useCallback(Ge=>{YS(Ge)?Xt&&Xt():$t&&$t()},[Xt,$t]);Tu(()=>{Be&&cr({value:Xe})},[Xe,cr,Be]);const _t=Ge=>{ae&&ae(Ge),N.onFocus&&N.onFocus(Ge),at&&at.onFocus?at.onFocus(Ge):Ot(!0)},gr=Ge=>{oe&&oe(Ge),N.onBlur&&N.onBlur(Ge),at&&at.onBlur?at.onBlur(Ge):Ot(!1)},mr=(Ge,...Ft)=>{if(!Be){const Et=Ge.target||st.current;if(Et==null)throw new Error(_p(1));cr({value:Et.value})}N.onChange&&N.onChange(Ge,...Ft),Q&&Q(Ge,...Ft)};te.useEffect(()=>{cr(st.current)},[]);const ar=Ge=>{st.current&&Ge.currentTarget===Ge.target&&st.current.focus(),G&&G(Ge)};let Cr=F,Er=N;W&&Cr==="input"&&(Te?Er={type:void 0,minRows:Te,maxRows:Te,...Er}:Er={type:void 0,maxRows:j,minRows:H,...Er},Cr=Whe);const Jt=Ge=>{cr(Ge.animationName==="mui-auto-fill-cancel"?st.current:{value:"x"})};te.useEffect(()=>{at&&at.setAdornedStart(!!Se)},[at,Se]);const ot={...n,color:$e.color||"primary",disabled:$e.disabled,endAdornment:E,error:$e.error,focused:$e.focused,formControl:at,fullWidth:A,hiddenLabel:$e.hiddenLabel,multiline:W,size:$e.size,startAdornment:Se,type:we},Ce=Zhe(ot),xe=de.root||f.Root||KT,je=Me.root||d.root||{},qe=de.input||f.Input||JT;return Er={...Er,...Me.input??d.input},J.jsxs(te.Fragment,{children:[!x&&typeof YB=="function"&&(XB||(XB=J.jsx(YB,{}))),J.jsxs(xe,{...je,ref:r,onClick:ar,...Fe,...!vd(xe)&&{ownerState:{...ot,...je.ownerState}},className:An(Ce.root,je.className,o,Le&&"MuiInputBase-readOnly"),children:[Se,J.jsx(oO.Provider,{value:null,children:J.jsx(qe,{"aria-invalid":$e.error,"aria-describedby":i,autoComplete:a,autoFocus:s,defaultValue:m,disabled:$e.disabled,id:M,onAnimationStart:Jt,name:X,placeholder:_e,readOnly:Le,required:$e.required,rows:Te,value:Xe,onKeyDown:se,onKeyUp:fe,type:we,...Er,...!vd(qe)&&{as:Cr,ownerState:{...ot,...Er.ownerState}},ref:it,className:An(Ce.input,Er.className,Le&&"MuiInputBase-readOnly"),onBlur:gr,onChange:mr,onFocus:_t})}),E,ye?ye({...$e,startAdornment:Se}):null]})]})});function Khe(t){return gi("MuiInput",t)}const t1={...V0,...pi("MuiInput",["root","underline","input"])};function Jhe(t){return gi("MuiOutlinedInput",t)}const td={...V0,...pi("MuiOutlinedInput",["root","notchedOutline","input"])};function Qhe(t){return gi("MuiFilledInput",t)}const cm={...V0,...pi("MuiFilledInput",["root","underline","input","adornedStart","adornedEnd","sizeSmall","multiline","hiddenLabel"])},ede=Ji(J.jsx("path",{d:"M7 10l5 5 5-5z"})),tde=Ji(J.jsx("path",{d:"M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"}));function rde(t){return gi("MuiAvatar",t)}pi("MuiAvatar",["root","colorDefault","circular","rounded","square","img","fallback"]);const nde=t=>{const{classes:e,variant:r,colorDefault:n}=t;return mi({root:["root",r,n&&"colorDefault"],img:["img"],fallback:["fallback"]},rde,e)},ide=Dr("div",{name:"MuiAvatar",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.root,e[r.variant],r.colorDefault&&e.colorDefault]}})(ci(({theme:t})=>({position:"relative",display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0,width:40,height:40,fontFamily:t.typography.fontFamily,fontSize:t.typography.pxToRem(20),lineHeight:1,borderRadius:"50%",overflow:"hidden",userSelect:"none",variants:[{props:{variant:"rounded"},style:{borderRadius:(t.vars||t).shape.borderRadius}},{props:{variant:"square"},style:{borderRadius:0}},{props:{colorDefault:!0},style:{color:(t.vars||t).palette.background.default,...t.vars?{backgroundColor:t.vars.palette.Avatar.defaultBg}:{backgroundColor:t.palette.grey[400],...t.applyStyles("dark",{backgroundColor:t.palette.grey[600]})}}}]}))),ade=Dr("img",{name:"MuiAvatar",slot:"Img"})({width:"100%",height:"100%",textAlign:"center",objectFit:"cover",color:"transparent",textIndent:1e4}),ode=Dr(tde,{name:"MuiAvatar",slot:"Fallback"})({width:"75%",height:"75%"});function sde({crossOrigin:t,referrerPolicy:e,src:r,srcSet:n}){const[i,a]=te.useState(!1);return te.useEffect(()=>{if(!r&&!n)return;a(!1);let s=!0;const o=new Image;return o.onload=()=>{s&&a("loaded")},o.onerror=()=>{s&&a("error")},o.crossOrigin=t,o.referrerPolicy=e,o.src=r,n&&(o.srcset=n),()=>{s=!1}},[t,e,r,n]),i}const iY=te.forwardRef(function(e,r){const n=bi({props:e,name:"MuiAvatar"}),{alt:i,children:a,className:s,component:o="div",slots:c={},slotProps:f={},imgProps:d,sizes:m,src:b,srcSet:x,variant:E="circular",...T}=n;let A=null;const M={...n,component:o,variant:E},F=sde({...d,...typeof f.img=="function"?f.img(M):f.img,src:b,srcSet:x}),N=b||x,O=N&&F!=="error";M.colorDefault=!O,delete M.ownerState;const U=nde(M),[j,H]=Ei("root",{ref:r,className:An(U.root,s),elementType:ide,externalForwardedProps:{slots:c,slotProps:f,component:o,...T},ownerState:M}),[W,X]=Ei("img",{className:U.img,elementType:ade,externalForwardedProps:{slots:c,slotProps:{img:{...d,...f.img}}},additionalProps:{alt:i,src:b,srcSet:x,sizes:m},ownerState:M}),[oe,Q]=Ei("fallback",{className:U.fallback,elementType:ode,externalForwardedProps:{slots:c,slotProps:f},shouldForwardComponentProp:!0,ownerState:M});return O?A=J.jsx(W,{...X}):a||a===0?A=a:N&&i?A=i[0]:A=J.jsx(oe,{...Q}),J.jsx(j,{...H,children:A})}),lde={entering:{opacity:1},entered:{opacity:1}},Uk=te.forwardRef(function(e,r){const n=Bc(),i={enter:n.transitions.duration.enteringScreen,exit:n.transitions.duration.leavingScreen},{addEndListener:a,appear:s=!0,children:o,easing:c,in:f,onEnter:d,onEntered:m,onEntering:b,onExit:x,onExited:E,onExiting:T,style:A,timeout:M=i,TransitionComponent:F=Qf,...N}=e,O=te.useRef(null),U=Uo(O,Fg(o),r),j=se=>fe=>{if(se){const _e=O.current;fe===void 0?se(_e):se(_e,fe)}},H=j(b),W=j((se,fe)=>{JD(se);const _e=xp({style:A,timeout:M,easing:c},{mode:"enter"});se.style.webkitTransition=n.transitions.create("opacity",_e),se.style.transition=n.transitions.create("opacity",_e),d&&d(se,fe)}),X=j(m),oe=j(T),Q=j(se=>{const fe=xp({style:A,timeout:M,easing:c},{mode:"exit"});se.style.webkitTransition=n.transitions.create("opacity",fe),se.style.transition=n.transitions.create("opacity",fe),x&&x(se)}),G=j(E),ae=se=>{a&&a(O.current,se)};return J.jsx(F,{appear:s,in:f,nodeRef:O,onEnter:W,onEntered:X,onEntering:H,onExit:Q,onExited:G,onExiting:oe,addEndListener:ae,timeout:M,...N,children:(se,{ownerState:fe,..._e})=>te.cloneElement(o,{style:{opacity:0,visibility:se==="exited"&&!f?"hidden":void 0,...lde[se],...A,...o.props.style},ref:U,..._e})})});function ude(t){return gi("MuiBackdrop",t)}pi("MuiBackdrop",["root","invisible"]);const cde=t=>{const{classes:e,invisible:r}=t;return mi({root:["root",r&&"invisible"]},ude,e)},fde=Dr("div",{name:"MuiBackdrop",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.root,r.invisible&&e.invisible]}})({position:"fixed",display:"flex",alignItems:"center",justifyContent:"center",right:0,bottom:0,top:0,left:0,backgroundColor:"rgba(0, 0, 0, 0.5)",WebkitTapHighlightColor:"transparent",variants:[{props:{invisible:!0},style:{backgroundColor:"transparent"}}]}),aY=te.forwardRef(function(e,r){const n=bi({props:e,name:"MuiBackdrop"}),{children:i,className:a,component:s="div",invisible:o=!1,open:c,components:f={},componentsProps:d={},slotProps:m={},slots:b={},TransitionComponent:x,transitionDuration:E,...T}=n,A={...n,component:s,invisible:o},M=cde(A),F={transition:x,root:f.Root,...b},N={...d,...m},O={component:s,slots:F,slotProps:N},[U,j]=Ei("root",{elementType:fde,externalForwardedProps:O,className:An(M.root,a),ownerState:A}),[H,W]=Ei("transition",{elementType:Uk,externalForwardedProps:O,ownerState:A});return J.jsx(H,{in:c,timeout:E,...T,...W,children:J.jsx(U,{"aria-hidden":!0,...j,classes:M,ref:r,children:i})})}),hde=pi("MuiBox",["root"]),dde=h_(),Bo=gX({themeId:Eh,defaultTheme:dde,defaultClassName:hde.root,generateClassName:UD.generate});function pde(t){return gi("MuiButton",t)}const fm=pi("MuiButton",["root","text","textInherit","textPrimary","textSecondary","textSuccess","textError","textInfo","textWarning","outlined","outlinedInherit","outlinedPrimary","outlinedSecondary","outlinedSuccess","outlinedError","outlinedInfo","outlinedWarning","contained","containedInherit","containedPrimary","containedSecondary","containedSuccess","containedError","containedInfo","containedWarning","disableElevation","focusVisible","disabled","colorInherit","colorPrimary","colorSecondary","colorSuccess","colorError","colorInfo","colorWarning","textSizeSmall","textSizeMedium","textSizeLarge","outlinedSizeSmall","outlinedSizeMedium","outlinedSizeLarge","containedSizeSmall","containedSizeMedium","containedSizeLarge","sizeMedium","sizeSmall","sizeLarge","fullWidth","startIcon","endIcon","icon","iconSizeSmall","iconSizeMedium","iconSizeLarge","loading","loadingWrapper","loadingIconPlaceholder","loadingIndicator","loadingPositionCenter","loadingPositionStart","loadingPositionEnd"]),oY=te.createContext({}),sY=te.createContext(void 0),gde=t=>{const{color:e,disableElevation:r,fullWidth:n,size:i,variant:a,loading:s,loadingPosition:o,classes:c}=t,f={root:["root",s&&"loading",a,`${a}${cn(e)}`,`size${cn(i)}`,`${a}Size${cn(i)}`,`color${cn(e)}`,r&&"disableElevation",n&&"fullWidth",s&&`loadingPosition${cn(o)}`],startIcon:["icon","startIcon",`iconSize${cn(i)}`],endIcon:["icon","endIcon",`iconSize${cn(i)}`],loadingIndicator:["loadingIndicator"],loadingWrapper:["loadingWrapper"]},d=mi(f,pde,c);return{...c,...d}},lY=[{props:{size:"small"},style:{"& > *:nth-of-type(1)":{fontSize:18}}},{props:{size:"medium"},style:{"& > *:nth-of-type(1)":{fontSize:20}}},{props:{size:"large"},style:{"& > *:nth-of-type(1)":{fontSize:22}}}],mde=Dr(d_,{shouldForwardProp:t=>Al(t)||t==="classes",name:"MuiButton",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.root,e[r.variant],e[`${r.variant}${cn(r.color)}`],e[`size${cn(r.size)}`],e[`${r.variant}Size${cn(r.size)}`],r.color==="inherit"&&e.colorInherit,r.disableElevation&&e.disableElevation,r.fullWidth&&e.fullWidth,r.loading&&e.loading]}})(ci(({theme:t})=>{const e=t.palette.mode==="light"?t.palette.grey[300]:t.palette.grey[800],r=t.palette.mode==="light"?t.palette.grey.A100:t.palette.grey[700];return{...t.typography.button,minWidth:64,padding:"6px 16px",border:0,borderRadius:(t.vars||t).shape.borderRadius,transition:t.transitions.create(["background-color","box-shadow","border-color","color"],{duration:t.transitions.duration.short}),"&:hover":{textDecoration:"none"},[`&.${fm.disabled}`]:{color:(t.vars||t).palette.action.disabled},variants:[{props:{variant:"contained"},style:{color:"var(--variant-containedColor)",backgroundColor:"var(--variant-containedBg)",boxShadow:(t.vars||t).shadows[2],"&:hover":{boxShadow:(t.vars||t).shadows[4],"@media (hover: none)":{boxShadow:(t.vars||t).shadows[2]}},"&:active":{boxShadow:(t.vars||t).shadows[8]},[`&.${fm.focusVisible}`]:{boxShadow:(t.vars||t).shadows[6]},[`&.${fm.disabled}`]:{color:(t.vars||t).palette.action.disabled,boxShadow:(t.vars||t).shadows[0],backgroundColor:(t.vars||t).palette.action.disabledBackground}}},{props:{variant:"outlined"},style:{padding:"5px 15px",border:"1px solid currentColor",borderColor:"var(--variant-outlinedBorder, currentColor)",backgroundColor:"var(--variant-outlinedBg)",color:"var(--variant-outlinedColor)",[`&.${fm.disabled}`]:{border:`1px solid ${(t.vars||t).palette.action.disabledBackground}`}}},{props:{variant:"text"},style:{padding:"6px 8px",color:"var(--variant-textColor)",backgroundColor:"var(--variant-textBg)"}},...Object.entries(t.palette).filter(jl()).map(([n])=>({props:{color:n},style:{"--variant-textColor":(t.vars||t).palette[n].main,"--variant-outlinedColor":(t.vars||t).palette[n].main,"--variant-outlinedBorder":t.alpha((t.vars||t).palette[n].main,.5),"--variant-containedColor":(t.vars||t).palette[n].contrastText,"--variant-containedBg":(t.vars||t).palette[n].main,"@media (hover: hover)":{"&:hover":{"--variant-containedBg":(t.vars||t).palette[n].dark,"--variant-textBg":t.alpha((t.vars||t).palette[n].main,(t.vars||t).palette.action.hoverOpacity),"--variant-outlinedBorder":(t.vars||t).palette[n].main,"--variant-outlinedBg":t.alpha((t.vars||t).palette[n].main,(t.vars||t).palette.action.hoverOpacity)}}}})),{props:{color:"inherit"},style:{color:"inherit",borderColor:"currentColor","--variant-containedBg":t.vars?t.vars.palette.Button.inheritContainedBg:e,"@media (hover: hover)":{"&:hover":{"--variant-containedBg":t.vars?t.vars.palette.Button.inheritContainedHoverBg:r,"--variant-textBg":t.alpha((t.vars||t).palette.text.primary,(t.vars||t).palette.action.hoverOpacity),"--variant-outlinedBg":t.alpha((t.vars||t).palette.text.primary,(t.vars||t).palette.action.hoverOpacity)}}}},{props:{size:"small",variant:"text"},style:{padding:"4px 5px",fontSize:t.typography.pxToRem(13)}},{props:{size:"large",variant:"text"},style:{padding:"8px 11px",fontSize:t.typography.pxToRem(15)}},{props:{size:"small",variant:"outlined"},style:{padding:"3px 9px",fontSize:t.typography.pxToRem(13)}},{props:{size:"large",variant:"outlined"},style:{padding:"7px 21px",fontSize:t.typography.pxToRem(15)}},{props:{size:"small",variant:"contained"},style:{padding:"4px 10px",fontSize:t.typography.pxToRem(13)}},{props:{size:"large",variant:"contained"},style:{padding:"8px 22px",fontSize:t.typography.pxToRem(15)}},{props:{disableElevation:!0},style:{boxShadow:"none","&:hover":{boxShadow:"none"},[`&.${fm.focusVisible}`]:{boxShadow:"none"},"&:active":{boxShadow:"none"},[`&.${fm.disabled}`]:{boxShadow:"none"}}},{props:{fullWidth:!0},style:{width:"100%"}},{props:{loadingPosition:"center"},style:{transition:t.transitions.create(["background-color","box-shadow","border-color"],{duration:t.transitions.duration.short}),[`&.${fm.loading}`]:{color:"transparent"}}}]}})),yde=Dr("span",{name:"MuiButton",slot:"StartIcon",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.startIcon,r.loading&&e.startIconLoadingStart,e[`iconSize${cn(r.size)}`]]}})(({theme:t})=>({display:"inherit",marginRight:8,marginLeft:-4,variants:[{props:{size:"small"},style:{marginLeft:-2}},{props:{loadingPosition:"start",loading:!0},style:{transition:t.transitions.create(["opacity"],{duration:t.transitions.duration.short}),opacity:0}},{props:{loadingPosition:"start",loading:!0,fullWidth:!0},style:{marginRight:-8}},...lY]})),vde=Dr("span",{name:"MuiButton",slot:"EndIcon",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.endIcon,r.loading&&e.endIconLoadingEnd,e[`iconSize${cn(r.size)}`]]}})(({theme:t})=>({display:"inherit",marginRight:-4,marginLeft:8,variants:[{props:{size:"small"},style:{marginRight:-2}},{props:{loadingPosition:"end",loading:!0},style:{transition:t.transitions.create(["opacity"],{duration:t.transitions.duration.short}),opacity:0}},{props:{loadingPosition:"end",loading:!0,fullWidth:!0},style:{marginLeft:-8}},...lY]})),_de=Dr("span",{name:"MuiButton",slot:"LoadingIndicator"})(({theme:t})=>({display:"none",position:"absolute",visibility:"visible",variants:[{props:{loading:!0},style:{display:"flex"}},{props:{loadingPosition:"start"},style:{left:14}},{props:{loadingPosition:"start",size:"small"},style:{left:10}},{props:{variant:"text",loadingPosition:"start"},style:{left:6}},{props:{loadingPosition:"center"},style:{left:"50%",transform:"translate(-50%)",color:(t.vars||t).palette.action.disabled}},{props:{loadingPosition:"end"},style:{right:14}},{props:{loadingPosition:"end",size:"small"},style:{right:10}},{props:{variant:"text",loadingPosition:"end"},style:{right:6}},{props:{loadingPosition:"start",fullWidth:!0},style:{position:"relative",left:-10}},{props:{loadingPosition:"end",fullWidth:!0},style:{position:"relative",right:-10}}]})),ZB=Dr("span",{name:"MuiButton",slot:"LoadingIconPlaceholder"})({display:"inline-block",width:"1em",height:"1em"}),ta=te.forwardRef(function(e,r){const n=te.useContext(oY),i=te.useContext(sY),a=Nb(n,e),s=bi({props:a,name:"MuiButton"}),{children:o,color:c="primary",component:f="button",className:d,disabled:m=!1,disableElevation:b=!1,disableFocusRipple:x=!1,endIcon:E,focusVisibleClassName:T,fullWidth:A=!1,id:M,loading:F=null,loadingIndicator:N,loadingPosition:O="center",size:U="medium",startIcon:j,type:H,variant:W="text",...X}=s,oe=Og(M),Q=N??J.jsx(WT,{"aria-labelledby":oe,color:"inherit",size:16}),G={...s,color:c,component:f,disabled:m,disableElevation:b,disableFocusRipple:x,fullWidth:A,loading:F,loadingIndicator:Q,loadingPosition:O,size:U,type:H,variant:W},ae=gde(G),se=(j||F&&O==="start")&&J.jsx(yde,{className:ae.startIcon,ownerState:G,children:j||J.jsx(ZB,{className:ae.loadingIconPlaceholder,ownerState:G})}),fe=(E||F&&O==="end")&&J.jsx(vde,{className:ae.endIcon,ownerState:G,children:E||J.jsx(ZB,{className:ae.loadingIconPlaceholder,ownerState:G})}),_e=i||"",Le=typeof F=="boolean"?J.jsx("span",{className:ae.loadingWrapper,style:{display:"contents"},children:F&&J.jsx(_de,{className:ae.loadingIndicator,ownerState:G,children:Q})}):null;return J.jsxs(mde,{ownerState:G,className:An(n.className,ae.root,d,_e),component:f,disabled:m||F,focusRipple:!x,focusVisibleClassName:An(ae.focusVisible,T),ref:r,type:H,id:F?oe:M,...X,classes:ae,children:[se,O!=="end"&&Le,o,O==="end"&&Le,fe]})});function bde(t){return te.Children.toArray(t).filter(e=>te.isValidElement(e))}function xde(t){return gi("MuiButtonGroup",t)}const ea=pi("MuiButtonGroup",["root","contained","outlined","text","disableElevation","disabled","firstButton","fullWidth","horizontal","vertical","colorPrimary","colorSecondary","grouped","groupedHorizontal","groupedVertical","groupedText","groupedTextHorizontal","groupedTextVertical","groupedTextPrimary","groupedTextSecondary","groupedOutlined","groupedOutlinedHorizontal","groupedOutlinedVertical","groupedOutlinedPrimary","groupedOutlinedSecondary","groupedContained","groupedContainedHorizontal","groupedContainedVertical","groupedContainedPrimary","groupedContainedSecondary","lastButton","middleButton"]),wde=(t,e)=>{const{ownerState:r}=t;return[{[`& .${ea.grouped}`]:e.grouped},{[`& .${ea.grouped}`]:e[`grouped${cn(r.orientation)}`]},{[`& .${ea.grouped}`]:e[`grouped${cn(r.variant)}`]},{[`& .${ea.grouped}`]:e[`grouped${cn(r.variant)}${cn(r.orientation)}`]},{[`& .${ea.grouped}`]:e[`grouped${cn(r.variant)}${cn(r.color)}`]},{[`& .${ea.firstButton}`]:e.firstButton},{[`& .${ea.lastButton}`]:e.lastButton},{[`& .${ea.middleButton}`]:e.middleButton},e.root,e[r.variant],r.disableElevation===!0&&e.disableElevation,r.fullWidth&&e.fullWidth,r.orientation==="vertical"&&e.vertical]},Sde=t=>{const{classes:e,color:r,disabled:n,disableElevation:i,fullWidth:a,orientation:s,variant:o}=t,c={root:["root",o,s,a&&"fullWidth",i&&"disableElevation",`color${cn(r)}`],grouped:["grouped",`grouped${cn(s)}`,`grouped${cn(o)}`,`grouped${cn(o)}${cn(s)}`,`grouped${cn(o)}${cn(r)}`,n&&"disabled"],firstButton:["firstButton"],lastButton:["lastButton"],middleButton:["middleButton"]};return mi(c,xde,e)},Ede=Dr("div",{name:"MuiButtonGroup",slot:"Root",overridesResolver:wde})(ci(({theme:t})=>({display:"inline-flex",borderRadius:(t.vars||t).shape.borderRadius,variants:[{props:{variant:"contained"},style:{boxShadow:(t.vars||t).shadows[2]}},{props:{disableElevation:!0},style:{boxShadow:"none"}},{props:{fullWidth:!0},style:{width:"100%"}},{props:{orientation:"vertical"},style:{flexDirection:"column",[`& .${ea.lastButton},& .${ea.middleButton}`]:{borderTopRightRadius:0,borderTopLeftRadius:0},[`& .${ea.firstButton},& .${ea.middleButton}`]:{borderBottomRightRadius:0,borderBottomLeftRadius:0}}},{props:{orientation:"horizontal"},style:{[`& .${ea.firstButton},& .${ea.middleButton}`]:{borderTopRightRadius:0,borderBottomRightRadius:0},[`& .${ea.lastButton},& .${ea.middleButton}`]:{borderTopLeftRadius:0,borderBottomLeftRadius:0}}},{props:{variant:"text",orientation:"horizontal"},style:{[`& .${ea.firstButton},& .${ea.middleButton}`]:{borderRight:t.vars?`1px solid ${t.alpha(t.vars.palette.common.onBackground,.23)}`:`1px solid ${t.palette.mode==="light"?"rgba(0, 0, 0, 0.23)":"rgba(255, 255, 255, 0.23)"}`,[`&.${ea.disabled}`]:{borderRight:`1px solid ${(t.vars||t).palette.action.disabled}`}}}},{props:{variant:"text",orientation:"vertical"},style:{[`& .${ea.firstButton},& .${ea.middleButton}`]:{borderBottom:t.vars?`1px solid ${t.alpha(t.vars.palette.common.onBackground,.23)}`:`1px solid ${t.palette.mode==="light"?"rgba(0, 0, 0, 0.23)":"rgba(255, 255, 255, 0.23)"}`,[`&.${ea.disabled}`]:{borderBottom:`1px solid ${(t.vars||t).palette.action.disabled}`}}}},...Object.entries(t.palette).filter(jl()).flatMap(([e])=>[{props:{variant:"text",color:e},style:{[`& .${ea.firstButton},& .${ea.middleButton}`]:{borderColor:t.alpha((t.vars||t).palette[e].main,.5)}}}]),{props:{variant:"outlined",orientation:"horizontal"},style:{[`& .${ea.firstButton},& .${ea.middleButton}`]:{borderRightColor:"transparent","&:hover":{borderRightColor:"currentColor"}},[`& .${ea.lastButton},& .${ea.middleButton}`]:{marginLeft:-1}}},{props:{variant:"outlined",orientation:"vertical"},style:{[`& .${ea.firstButton},& .${ea.middleButton}`]:{borderBottomColor:"transparent","&:hover":{borderBottomColor:"currentColor"}},[`& .${ea.lastButton},& .${ea.middleButton}`]:{marginTop:-1}}},{props:{variant:"contained",orientation:"horizontal"},style:{[`& .${ea.firstButton},& .${ea.middleButton}`]:{borderRight:`1px solid ${(t.vars||t).palette.grey[400]}`,[`&.${ea.disabled}`]:{borderRight:`1px solid ${(t.vars||t).palette.action.disabled}`}}}},{props:{variant:"contained",orientation:"vertical"},style:{[`& .${ea.firstButton},& .${ea.middleButton}`]:{borderBottom:`1px solid ${(t.vars||t).palette.grey[400]}`,[`&.${ea.disabled}`]:{borderBottom:`1px solid ${(t.vars||t).palette.action.disabled}`}}}},...Object.entries(t.palette).filter(jl(["dark"])).map(([e])=>({props:{variant:"contained",color:e},style:{[`& .${ea.firstButton},& .${ea.middleButton}`]:{borderColor:(t.vars||t).palette[e].dark}}}))],[`& .${ea.grouped}`]:{minWidth:40,boxShadow:"none",props:{variant:"contained"},style:{"&:hover":{boxShadow:"none"}}}}))),Vk=te.forwardRef(function(e,r){const n=bi({props:e,name:"MuiButtonGroup"}),{children:i,className:a,color:s="primary",component:o="div",disabled:c=!1,disableElevation:f=!1,disableFocusRipple:d=!1,disableRipple:m=!1,fullWidth:b=!1,orientation:x="horizontal",size:E="medium",variant:T="outlined",...A}=n,M={...n,color:s,component:o,disabled:c,disableElevation:f,disableFocusRipple:d,disableRipple:m,fullWidth:b,orientation:x,size:E,variant:T},F=Sde(M),N=te.useMemo(()=>({className:F.grouped,color:s,disabled:c,disableElevation:f,disableFocusRipple:d,disableRipple:m,fullWidth:b,size:E,variant:T}),[s,c,f,d,m,b,E,T,F.grouped]),O=bde(i),U=O.length,j=H=>{const W=H===0,X=H===U-1;return W&&X?"":W?F.firstButton:X?F.lastButton:F.middleButton};return J.jsx(Ede,{as:o,role:"group",className:An(F.root,a),ref:r,ownerState:M,...A,children:J.jsx(oY.Provider,{value:N,children:O.map((H,W)=>J.jsx(sY.Provider,{value:j(W),children:H},W))})})});function Tde(t){return gi("PrivateSwitchBase",t)}pi("PrivateSwitchBase",["root","checked","disabled","input","edgeStart","edgeEnd"]);const Cde=t=>{const{classes:e,checked:r,disabled:n,edge:i}=t,a={root:["root",r&&"checked",n&&"disabled",i&&`edge${cn(i)}`],input:["input"]};return mi(a,Tde,e)},Ade=Dr(d_,{name:"MuiSwitchBase"})({padding:9,borderRadius:"50%",variants:[{props:{edge:"start",size:"small"},style:{marginLeft:-3}},{props:({edge:t,ownerState:e})=>t==="start"&&e.size!=="small",style:{marginLeft:-12}},{props:{edge:"end",size:"small"},style:{marginRight:-3}},{props:({edge:t,ownerState:e})=>t==="end"&&e.size!=="small",style:{marginRight:-12}}]}),Ide=Dr("input",{name:"MuiSwitchBase",shouldForwardProp:Al})({cursor:"inherit",position:"absolute",opacity:0,width:"100%",height:"100%",top:0,left:0,margin:0,padding:0,zIndex:1}),uY=te.forwardRef(function(e,r){const{autoFocus:n,checked:i,checkedIcon:a,defaultChecked:s,disabled:o,disableFocusRipple:c=!1,edge:f=!1,icon:d,id:m,inputProps:b,inputRef:x,name:E,onBlur:T,onChange:A,onFocus:M,readOnly:F,required:N=!1,tabIndex:O,type:U,value:j,slots:H={},slotProps:W={},...X}=e,[oe,Q]=Ym({controlled:i,default:!!s,name:"SwitchBase",state:"checked"}),G=Pd(),ae=De=>{M&&M(De),G&&G.onFocus&&G.onFocus(De)},se=De=>{T&&T(De),G&&G.onBlur&&G.onBlur(De)},fe=De=>{if(De.nativeEvent.defaultPrevented)return;const Fe=De.target.checked;Q(Fe),A&&A(De,Fe)};let _e=o;G&&typeof _e>"u"&&(_e=G.disabled);const Le=U==="checkbox"||U==="radio",ye={...e,checked:oe,disabled:_e,disableFocusRipple:c,edge:f},Te=Cde(ye),Ie={slots:H,slotProps:{input:b,...W}},[Me,de]=Ei("root",{ref:r,elementType:Ade,className:Te.root,shouldForwardComponentProp:!0,externalForwardedProps:{...Ie,component:"span",...X},getSlotProps:De=>({...De,onFocus:Fe=>{De.onFocus?.(Fe),ae(Fe)},onBlur:Fe=>{De.onBlur?.(Fe),se(Fe)}}),ownerState:ye,additionalProps:{centerRipple:!0,focusRipple:!c,disabled:_e,role:void 0,tabIndex:null}}),[Se,we]=Ei("input",{ref:x,elementType:Ide,className:Te.input,externalForwardedProps:Ie,getSlotProps:De=>({...De,onChange:Fe=>{De.onChange?.(Fe),fe(Fe)}}),ownerState:ye,additionalProps:{autoFocus:n,checked:i,defaultChecked:s,disabled:_e,id:Le?m:void 0,name:E,readOnly:F,required:N,tabIndex:O,type:U,...U==="checkbox"&&j===void 0?{}:{value:j}}});return J.jsxs(Me,{...de,children:[J.jsx(Se,{...we}),oe?a:d]})}),Pde=Ji(J.jsx("path",{d:"M19 5v14H5V5h14m0-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2z"})),kde=Ji(J.jsx("path",{d:"M19 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.11 0 2-.9 2-2V5c0-1.1-.89-2-2-2zm-9 14l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"})),Rde=Ji(J.jsx("path",{d:"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-2 10H7v-2h10v2z"}));function Mde(t){return gi("MuiCheckbox",t)}const pA=pi("MuiCheckbox",["root","checked","disabled","indeterminate","colorPrimary","colorSecondary","sizeSmall","sizeMedium"]),Dde=t=>{const{classes:e,indeterminate:r,color:n,size:i}=t,a={root:["root",r&&"indeterminate",`color${cn(n)}`,`size${cn(i)}`]},s=mi(a,Mde,e);return{...e,...s}},Ode=Dr(uY,{shouldForwardProp:t=>Al(t)||t==="classes",name:"MuiCheckbox",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.root,r.indeterminate&&e.indeterminate,e[`size${cn(r.size)}`],r.color!=="default"&&e[`color${cn(r.color)}`]]}})(ci(({theme:t})=>({color:(t.vars||t).palette.text.secondary,variants:[{props:{color:"default",disableRipple:!1},style:{"&:hover":{backgroundColor:t.alpha((t.vars||t).palette.action.active,(t.vars||t).palette.action.hoverOpacity)}}},...Object.entries(t.palette).filter(jl()).map(([e])=>({props:{color:e,disableRipple:!1},style:{"&:hover":{backgroundColor:t.alpha((t.vars||t).palette[e].main,(t.vars||t).palette.action.hoverOpacity)}}})),...Object.entries(t.palette).filter(jl()).map(([e])=>({props:{color:e},style:{[`&.${pA.checked}, &.${pA.indeterminate}`]:{color:(t.vars||t).palette[e].main},[`&.${pA.disabled}`]:{color:(t.vars||t).palette.action.disabled}}})),{props:{disableRipple:!1},style:{"&:hover":{"@media (hover: none)":{backgroundColor:"transparent"}}}}]}))),Nde=J.jsx(kde,{}),Lde=J.jsx(Pde,{}),Fde=J.jsx(Rde,{}),$0=te.forwardRef(function(e,r){const n=bi({props:e,name:"MuiCheckbox"}),{checkedIcon:i=Nde,color:a="primary",icon:s=Lde,indeterminate:o=!1,indeterminateIcon:c=Fde,inputProps:f,size:d="medium",disableRipple:m=!1,className:b,slots:x={},slotProps:E={},...T}=n,A=o?c:s,M=o?c:i,F={...n,disableRipple:m,color:a,indeterminate:o,size:d},N=Dde(F),O=E.input??f,[U,j]=Ei("root",{ref:r,elementType:Ode,className:An(N.root,b),shouldForwardComponentProp:!0,externalForwardedProps:{slots:x,slotProps:E,...T},ownerState:F,additionalProps:{type:"checkbox",icon:te.cloneElement(A,{fontSize:A.props.fontSize??d}),checkedIcon:te.cloneElement(M,{fontSize:M.props.fontSize??d}),disableRipple:m,slots:x,slotProps:{input:Fb(typeof O=="function"?O(F):O,{"data-indeterminate":o})}}});return J.jsx(U,{...j,classes:N})});function KB(t){return t.substring(2).toLowerCase()}function Bde(t,e){return e.documentElement.clientWidth<t.clientX||e.documentElement.clientHeight<t.clientY}function zde(t){const{children:e,disableReactTree:r=!1,mouseEvent:n="onClick",onClickAway:i,touchEvent:a="onTouchEnd"}=t,s=te.useRef(!1),o=te.useRef(null),c=te.useRef(!1),f=te.useRef(!1);te.useEffect(()=>(setTimeout(()=>{c.current=!0},0),()=>{c.current=!1}),[]);const d=Uo(Fg(e),o),m=ou(E=>{const T=f.current;f.current=!1;const A=cs(o.current);if(!c.current||!o.current||"clientX"in E&&Bde(E,A))return;if(s.current){s.current=!1;return}let M;E.composedPath?M=E.composedPath().includes(o.current):M=!A.documentElement.contains(E.target)||o.current.contains(E.target),!M&&(r||!T)&&i(E)}),b=E=>T=>{f.current=!0;const A=e.props[E];A&&A(T)},x={ref:d};return a!==!1&&(x[a]=b(a)),te.useEffect(()=>{if(a!==!1){const E=KB(a),T=cs(o.current),A=()=>{s.current=!0};return T.addEventListener(E,m),T.addEventListener("touchmove",A),()=>{T.removeEventListener(E,m),T.removeEventListener("touchmove",A)}}},[m,a]),n!==!1&&(x[n]=b(n)),te.useEffect(()=>{if(n!==!1){const E=KB(n),T=cs(o.current);return T.addEventListener(E,m),()=>{T.removeEventListener(E,m)}}},[m,n]),te.cloneElement(e,x)}function cY(t=window){const e=t.document.documentElement.clientWidth;return t.innerWidth-e}function jde(t){const e=cs(t);return e.body===t?bc(t).innerWidth>e.documentElement.clientWidth:t.scrollHeight>t.clientHeight}function ub(t,e){e?t.setAttribute("aria-hidden","true"):t.removeAttribute("aria-hidden")}function JB(t){return parseInt(bc(t).getComputedStyle(t).paddingRight,10)||0}function Ude(t){const r=["TEMPLATE","SCRIPT","STYLE","LINK","MAP","META","NOSCRIPT","PICTURE","COL","COLGROUP","PARAM","SLOT","SOURCE","TRACK"].includes(t.tagName),n=t.tagName==="INPUT"&&t.getAttribute("type")==="hidden";return r||n}function QB(t,e,r,n,i){const a=[e,r,...n];[].forEach.call(t.children,s=>{const o=!a.includes(s),c=!Ude(s);o&&c&&ub(s,i)})}function gA(t,e){let r=-1;return t.some((n,i)=>e(n)?(r=i,!0):!1),r}function Vde(t,e){const r=[],n=t.container;if(!e.disableScrollLock){if(jde(n)){const s=cY(bc(n));r.push({value:n.style.paddingRight,property:"padding-right",el:n}),n.style.paddingRight=`${JB(n)+s}px`;const o=cs(n).querySelectorAll(".mui-fixed");[].forEach.call(o,c=>{r.push({value:c.style.paddingRight,property:"padding-right",el:c}),c.style.paddingRight=`${JB(c)+s}px`})}let a;if(n.parentNode instanceof DocumentFragment)a=cs(n).body;else{const s=n.parentElement,o=bc(n);a=s?.nodeName==="HTML"&&o.getComputedStyle(s).overflowY==="scroll"?s:n}r.push({value:a.style.overflow,property:"overflow",el:a},{value:a.style.overflowX,property:"overflow-x",el:a},{value:a.style.overflowY,property:"overflow-y",el:a}),a.style.overflow="hidden"}return()=>{r.forEach(({value:a,el:s,property:o})=>{a?s.style.setProperty(o,a):s.style.removeProperty(o)})}}function $de(t){const e=[];return[].forEach.call(t.children,r=>{r.getAttribute("aria-hidden")==="true"&&e.push(r)}),e}class qde{constructor(){this.modals=[],this.containers=[]}add(e,r){let n=this.modals.indexOf(e);if(n!==-1)return n;n=this.modals.length,this.modals.push(e),e.modalRef&&ub(e.modalRef,!1);const i=$de(r);QB(r,e.mount,e.modalRef,i,!0);const a=gA(this.containers,s=>s.container===r);return a!==-1?(this.containers[a].modals.push(e),n):(this.containers.push({modals:[e],container:r,restore:null,hiddenSiblings:i}),n)}mount(e,r){const n=gA(this.containers,a=>a.modals.includes(e)),i=this.containers[n];i.restore||(i.restore=Vde(i,r))}remove(e,r=!0){const n=this.modals.indexOf(e);if(n===-1)return n;const i=gA(this.containers,s=>s.modals.includes(e)),a=this.containers[i];if(a.modals.splice(a.modals.indexOf(e),1),this.modals.splice(n,1),a.modals.length===0)a.restore&&a.restore(),e.modalRef&&ub(e.modalRef,r),QB(a.container,e.mount,e.modalRef,a.hiddenSiblings,!1),this.containers.splice(i,1);else{const s=a.modals[a.modals.length-1];s.modalRef&&ub(s.modalRef,!1)}return n}isTopModal(e){return this.modals.length>0&&this.modals[this.modals.length-1]===e}}const Hde=["input","select","textarea","a[href]","button","[tabindex]","audio[controls]","video[controls]",'[contenteditable]:not([contenteditable="false"])'].join(",");function Gde(t){const e=parseInt(t.getAttribute("tabindex")||"",10);return Number.isNaN(e)?t.contentEditable==="true"||(t.nodeName==="AUDIO"||t.nodeName==="VIDEO"||t.nodeName==="DETAILS")&&t.getAttribute("tabindex")===null?0:t.tabIndex:e}function Wde(t){if(t.tagName!=="INPUT"||t.type!=="radio"||!t.name)return!1;const e=n=>t.ownerDocument.querySelector(`input[type="radio"]${n}`);let r=e(`[name="${t.name}"]:checked`);return r||(r=e(`[name="${t.name}"]`)),r!==t}function Xde(t){return!(t.disabled||t.tagName==="INPUT"&&t.type==="hidden"||Wde(t))}function Yde(t){const e=[],r=[];return Array.from(t.querySelectorAll(Hde)).forEach((n,i)=>{const a=Gde(n);a===-1||!Xde(n)||(a===0?e.push(n):r.push({documentOrder:i,tabIndex:a,node:n}))}),r.sort((n,i)=>n.tabIndex===i.tabIndex?n.documentOrder-i.documentOrder:n.tabIndex-i.tabIndex).map(n=>n.node).concat(e)}function Zde(){return!0}function Kde(t){const{children:e,disableAutoFocus:r=!1,disableEnforceFocus:n=!1,disableRestoreFocus:i=!1,getTabbable:a=Yde,isEnabled:s=Zde,open:o}=t,c=te.useRef(!1),f=te.useRef(null),d=te.useRef(null),m=te.useRef(null),b=te.useRef(null),x=te.useRef(!1),E=te.useRef(null),T=Uo(Fg(e),E),A=te.useRef(null);te.useEffect(()=>{!o||!E.current||(x.current=!r)},[r,o]),te.useEffect(()=>{if(!o||!E.current)return;const N=cs(E.current);return E.current.contains(N.activeElement)||(E.current.hasAttribute("tabIndex")||E.current.setAttribute("tabIndex","-1"),x.current&&E.current.focus()),()=>{i||(m.current&&m.current.focus&&(c.current=!0,m.current.focus()),m.current=null)}},[o]),te.useEffect(()=>{if(!o||!E.current)return;const N=cs(E.current),O=H=>{A.current=H,!(n||!s()||H.key!=="Tab")&&N.activeElement===E.current&&H.shiftKey&&(c.current=!0,d.current&&d.current.focus())},U=()=>{const H=E.current;if(H===null)return;if(!N.hasFocus()||!s()||c.current){c.current=!1;return}if(H.contains(N.activeElement)||n&&N.activeElement!==f.current&&N.activeElement!==d.current)return;if(N.activeElement!==b.current)b.current=null;else if(b.current!==null)return;if(!x.current)return;let W=[];if((N.activeElement===f.current||N.activeElement===d.current)&&(W=a(E.current)),W.length>0){const X=!!(A.current?.shiftKey&&A.current?.key==="Tab"),oe=W[0],Q=W[W.length-1];typeof oe!="string"&&typeof Q!="string"&&(X?Q.focus():oe.focus())}else H.focus()};N.addEventListener("focusin",U),N.addEventListener("keydown",O,!0);const j=setInterval(()=>{N.activeElement&&N.activeElement.tagName==="BODY"&&U()},50);return()=>{clearInterval(j),N.removeEventListener("focusin",U),N.removeEventListener("keydown",O,!0)}},[r,n,i,s,o,a]);const M=N=>{m.current===null&&(m.current=N.relatedTarget),x.current=!0,b.current=N.target;const O=e.props.onFocus;O&&O(N)},F=N=>{m.current===null&&(m.current=N.relatedTarget),x.current=!0};return J.jsxs(te.Fragment,{children:[J.jsx("div",{tabIndex:o?0:-1,onFocus:F,ref:f,"data-testid":"sentinelStart"}),te.cloneElement(e,{ref:T,onFocus:M}),J.jsx("div",{tabIndex:o?0:-1,onFocus:F,ref:d,"data-testid":"sentinelEnd"})]})}function Jde(t){return typeof t=="function"?t():t}function Qde(t){return t?t.props.hasOwnProperty("in"):!1}const ez=()=>{},q2=new qde;function epe(t){const{container:e,disableEscapeKeyDown:r=!1,disableScrollLock:n=!1,closeAfterTransition:i=!1,onTransitionEnter:a,onTransitionExited:s,children:o,onClose:c,open:f,rootRef:d}=t,m=te.useRef({}),b=te.useRef(null),x=te.useRef(null),E=Uo(x,d),[T,A]=te.useState(!f),M=Qde(o);let F=!0;(t["aria-hidden"]==="false"||t["aria-hidden"]===!1)&&(F=!1);const N=()=>cs(b.current),O=()=>(m.current.modalRef=x.current,m.current.mount=b.current,m.current),U=()=>{q2.mount(O(),{disableScrollLock:n}),x.current&&(x.current.scrollTop=0)},j=ou(()=>{const fe=Jde(e)||N().body;q2.add(O(),fe),x.current&&U()}),H=()=>q2.isTopModal(O()),W=ou(fe=>{b.current=fe,fe&&(f&&H()?U():x.current&&ub(x.current,F))}),X=te.useCallback(()=>{q2.remove(O(),F)},[F]);te.useEffect(()=>()=>{X()},[X]),te.useEffect(()=>{f?j():(!M||!i)&&X()},[f,X,M,i,j]);const oe=fe=>_e=>{fe.onKeyDown?.(_e),!(_e.key!=="Escape"||_e.which===229||!H())&&(r||(_e.stopPropagation(),c&&c(_e,"escapeKeyDown")))},Q=fe=>_e=>{fe.onClick?.(_e),_e.target===_e.currentTarget&&c&&c(_e,"backdropClick")};return{getRootProps:(fe={})=>{const _e=Nm(t);delete _e.onTransitionEnter,delete _e.onTransitionExited;const Le={..._e,...fe};return{role:"presentation",...Le,onKeyDown:oe(Le),ref:E}},getBackdropProps:(fe={})=>{const _e=fe;return{"aria-hidden":!0,..._e,onClick:Q(_e),open:f}},getTransitionProps:()=>{const fe=()=>{A(!1),a&&a()},_e=()=>{A(!0),s&&s(),i&&X()};return{onEnter:kk(fe,o?.props.onEnter??ez),onExited:kk(_e,o?.props.onExited??ez)}},rootRef:E,portalRef:W,isTopModal:H,exited:T,hasTransition:M}}function tpe(t){return gi("MuiModal",t)}pi("MuiModal",["root","hidden","backdrop"]);const rpe=t=>{const{open:e,exited:r,classes:n}=t;return mi({root:["root",!e&&r&&"hidden"],backdrop:["backdrop"]},tpe,n)},npe=Dr("div",{name:"MuiModal",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.root,!r.open&&r.exited&&e.hidden]}})(ci(({theme:t})=>({position:"fixed",zIndex:(t.vars||t).zIndex.modal,right:0,bottom:0,top:0,left:0,variants:[{props:({ownerState:e})=>!e.open&&e.exited,style:{visibility:"hidden"}}]}))),ipe=Dr(aY,{name:"MuiModal",slot:"Backdrop"})({zIndex:-1}),lO=te.forwardRef(function(e,r){const n=bi({name:"MuiModal",props:e}),{BackdropComponent:i=ipe,BackdropProps:a,classes:s,className:o,closeAfterTransition:c=!1,children:f,container:d,component:m,components:b={},componentsProps:x={},disableAutoFocus:E=!1,disableEnforceFocus:T=!1,disableEscapeKeyDown:A=!1,disablePortal:M=!1,disableRestoreFocus:F=!1,disableScrollLock:N=!1,hideBackdrop:O=!1,keepMounted:U=!1,onClose:j,onTransitionEnter:H,onTransitionExited:W,open:X,slotProps:oe={},slots:Q={},theme:G,...ae}=n,se={...n,closeAfterTransition:c,disableAutoFocus:E,disableEnforceFocus:T,disableEscapeKeyDown:A,disablePortal:M,disableRestoreFocus:F,disableScrollLock:N,hideBackdrop:O,keepMounted:U},{getRootProps:fe,getBackdropProps:_e,getTransitionProps:Le,portalRef:ye,isTopModal:Te,exited:Ie,hasTransition:Me}=epe({...se,rootRef:r}),de={...se,exited:Ie},Se=rpe(de),we={};if(f.props.tabIndex===void 0&&(we.tabIndex="-1"),Me){const{onEnter:Qe,onExited:it}=Le();we.onEnter=Qe,we.onExited=it}const De={slots:{root:b.Root,backdrop:b.Backdrop,...Q},slotProps:{...x,...oe}},[Fe,Xe]=Ei("root",{ref:r,elementType:npe,externalForwardedProps:{...De,...ae,component:m},getSlotProps:fe,ownerState:de,className:An(o,Se?.root,!de.open&&de.exited&&Se?.hidden)}),[Be,st]=Ei("backdrop",{ref:a?.ref,elementType:i,externalForwardedProps:De,shouldForwardComponentProp:!0,additionalProps:a,getSlotProps:Qe=>_e({...Qe,onClick:it=>{Qe?.onClick&&Qe.onClick(it)}}),className:An(a?.className,Se?.backdrop),ownerState:de});return!U&&!X&&(!Me||Ie)?null:J.jsx(rY,{ref:ye,container:d,disablePortal:M,children:J.jsxs(Fe,{...Xe,children:[!O&&i?J.jsx(Be,{...st}):null,J.jsx(Kde,{disableEnforceFocus:T,disableAutoFocus:E,disableRestoreFocus:F,isEnabled:Te,open:X,children:te.cloneElement(f,we)})]})})});function ape(t){return gi("MuiDialog",t)}const mA=pi("MuiDialog",["root","scrollPaper","scrollBody","container","paper","paperScrollPaper","paperScrollBody","paperWidthFalse","paperWidthXs","paperWidthSm","paperWidthMd","paperWidthLg","paperWidthXl","paperFullWidth","paperFullScreen"]),fY=te.createContext({}),ope=Dr(aY,{name:"MuiDialog",slot:"Backdrop",overrides:(t,e)=>e.backdrop})({zIndex:-1}),spe=t=>{const{classes:e,scroll:r,maxWidth:n,fullWidth:i,fullScreen:a}=t,s={root:["root"],container:["container",`scroll${cn(r)}`],paper:["paper",`paperScroll${cn(r)}`,`paperWidth${cn(String(n))}`,i&&"paperFullWidth",a&&"paperFullScreen"]};return mi(s,ape,e)},lpe=Dr(lO,{name:"MuiDialog",slot:"Root"})({"@media print":{position:"absolute !important"}}),upe=Dr("div",{name:"MuiDialog",slot:"Container",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.container,e[`scroll${cn(r.scroll)}`]]}})({height:"100%","@media print":{height:"auto"},outline:0,variants:[{props:{scroll:"paper"},style:{display:"flex",justifyContent:"center",alignItems:"center"}},{props:{scroll:"body"},style:{overflowY:"auto",overflowX:"hidden",textAlign:"center","&::after":{content:'""',display:"inline-block",verticalAlign:"middle",height:"100%",width:"0"}}}]}),cpe=Dr(hf,{name:"MuiDialog",slot:"Paper",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.paper,e[`scrollPaper${cn(r.scroll)}`],e[`paperWidth${cn(String(r.maxWidth))}`],r.fullWidth&&e.paperFullWidth,r.fullScreen&&e.paperFullScreen]}})(ci(({theme:t})=>({margin:32,position:"relative",overflowY:"auto","@media print":{overflowY:"visible",boxShadow:"none"},variants:[{props:{scroll:"paper"},style:{display:"flex",flexDirection:"column",maxHeight:"calc(100% - 64px)"}},{props:{scroll:"body"},style:{display:"inline-block",verticalAlign:"middle",textAlign:"initial"}},{props:({ownerState:e})=>!e.maxWidth,style:{maxWidth:"calc(100% - 64px)"}},{props:{maxWidth:"xs"},style:{maxWidth:t.breakpoints.unit==="px"?Math.max(t.breakpoints.values.xs,444):`max(${t.breakpoints.values.xs}${t.breakpoints.unit}, 444px)`,[`&.${mA.paperScrollBody}`]:{[t.breakpoints.down(Math.max(t.breakpoints.values.xs,444)+64)]:{maxWidth:"calc(100% - 64px)"}}}},...Object.keys(t.breakpoints.values).filter(e=>e!=="xs").map(e=>({props:{maxWidth:e},style:{maxWidth:`${t.breakpoints.values[e]}${t.breakpoints.unit}`,[`&.${mA.paperScrollBody}`]:{[t.breakpoints.down(t.breakpoints.values[e]+64)]:{maxWidth:"calc(100% - 64px)"}}}})),{props:({ownerState:e})=>e.fullWidth,style:{width:"calc(100% - 64px)"}},{props:({ownerState:e})=>e.fullScreen,style:{margin:0,width:"100%",maxWidth:"100%",height:"100%",maxHeight:"none",borderRadius:0,[`&.${mA.paperScrollBody}`]:{margin:0,maxWidth:"100%"}}}]}))),uO=te.forwardRef(function(e,r){const n=bi({props:e,name:"MuiDialog"}),i=Bc(),a={enter:i.transitions.duration.enteringScreen,exit:i.transitions.duration.leavingScreen},{"aria-describedby":s,"aria-labelledby":o,"aria-modal":c=!0,BackdropComponent:f,BackdropProps:d,children:m,className:b,disableEscapeKeyDown:x=!1,fullScreen:E=!1,fullWidth:T=!1,maxWidth:A="sm",onClick:M,onClose:F,open:N,PaperComponent:O=hf,PaperProps:U={},scroll:j="paper",slots:H={},slotProps:W={},TransitionComponent:X=Uk,transitionDuration:oe=a,TransitionProps:Q,...G}=n,ae={...n,disableEscapeKeyDown:x,fullScreen:E,fullWidth:T,maxWidth:A,scroll:j},se=spe(ae),fe=te.useRef(),_e=Ot=>{fe.current=Ot.target===Ot.currentTarget},Le=Ot=>{M&&M(Ot),fe.current&&(fe.current=null,F&&F(Ot,"backdropClick"))},ye=Og(o),Te=te.useMemo(()=>({titleId:ye}),[ye]),Ie={transition:X,...H},Me={transition:Q,paper:U,backdrop:d,...W},de={slots:Ie,slotProps:Me},[Se,we]=Ei("root",{elementType:lpe,shouldForwardComponentProp:!0,externalForwardedProps:de,ownerState:ae,className:An(se.root,b),ref:r}),[De,Fe]=Ei("backdrop",{elementType:ope,shouldForwardComponentProp:!0,externalForwardedProps:de,ownerState:ae}),[Xe,Be]=Ei("paper",{elementType:cpe,shouldForwardComponentProp:!0,externalForwardedProps:de,ownerState:ae,className:An(se.paper,U.className)}),[st,Qe]=Ei("container",{elementType:upe,externalForwardedProps:de,ownerState:ae,className:se.container}),[it,be]=Ei("transition",{elementType:Uk,externalForwardedProps:de,ownerState:ae,additionalProps:{appear:!0,in:N,timeout:oe,role:"presentation"}});return J.jsx(Se,{closeAfterTransition:!0,slots:{backdrop:De},slotProps:{backdrop:{transitionDuration:oe,as:f,...Fe}},disableEscapeKeyDown:x,onClose:F,open:N,onClick:Le,...we,...G,children:J.jsx(it,{...be,children:J.jsx(st,{onMouseDown:_e,...Qe,children:J.jsx(Xe,{as:O,elevation:24,role:"dialog","aria-describedby":s,"aria-labelledby":ye,"aria-modal":c,...Be,children:J.jsx(fY.Provider,{value:Te,children:m})})})})})});function fpe(t){return gi("MuiDialogActions",t)}pi("MuiDialogActions",["root","spacing"]);const hpe=t=>{const{classes:e,disableSpacing:r}=t;return mi({root:["root",!r&&"spacing"]},fpe,e)},dpe=Dr("div",{name:"MuiDialogActions",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.root,!r.disableSpacing&&e.spacing]}})({display:"flex",alignItems:"center",padding:8,justifyContent:"flex-end",flex:"0 0 auto",variants:[{props:({ownerState:t})=>!t.disableSpacing,style:{"& > :not(style) ~ :not(style)":{marginLeft:8}}}]}),Ox=te.forwardRef(function(e,r){const n=bi({props:e,name:"MuiDialogActions"}),{className:i,disableSpacing:a=!1,...s}=n,o={...n,disableSpacing:a},c=hpe(o);return J.jsx(dpe,{className:An(c.root,i),ownerState:o,ref:r,...s})});function ppe(t){return gi("MuiDialogContent",t)}pi("MuiDialogContent",["root","dividers"]);function gpe(t){return gi("MuiDialogTitle",t)}const mpe=pi("MuiDialogTitle",["root"]),ype=t=>{const{classes:e,dividers:r}=t;return mi({root:["root",r&&"dividers"]},ppe,e)},vpe=Dr("div",{name:"MuiDialogContent",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.root,r.dividers&&e.dividers]}})(ci(({theme:t})=>({flex:"1 1 auto",WebkitOverflowScrolling:"touch",overflowY:"auto",padding:"20px 24px",variants:[{props:({ownerState:e})=>e.dividers,style:{padding:"16px 24px",borderTop:`1px solid ${(t.vars||t).palette.divider}`,borderBottom:`1px solid ${(t.vars||t).palette.divider}`}},{props:({ownerState:e})=>!e.dividers,style:{[`.${mpe.root} + &`]:{paddingTop:0}}}]}))),cO=te.forwardRef(function(e,r){const n=bi({props:e,name:"MuiDialogContent"}),{className:i,dividers:a=!1,...s}=n,o={...n,dividers:a},c=ype(o);return J.jsx(vpe,{className:An(c.root,i),ownerState:o,ref:r,...s})});function _pe(t){return gi("MuiDialogContentText",t)}pi("MuiDialogContentText",["root"]);const bpe=t=>{const{classes:e}=t,n=mi({root:["root"]},_pe,e);return{...e,...n}},xpe=Dr(Ss,{shouldForwardProp:t=>Al(t)||t==="classes",name:"MuiDialogContentText",slot:"Root"})({}),wpe=te.forwardRef(function(e,r){const n=bi({props:e,name:"MuiDialogContentText"}),{children:i,className:a,...s}=n,o=bpe(s);return J.jsx(xpe,{component:"p",variant:"body1",color:"textSecondary",ref:r,ownerState:s,className:An(o.root,a),...n,classes:o})}),Spe=t=>{const{classes:e}=t;return mi({root:["root"]},gpe,e)},Epe=Dr(Ss,{name:"MuiDialogTitle",slot:"Root"})({padding:"16px 24px",flex:"0 0 auto"}),by=te.forwardRef(function(e,r){const n=bi({props:e,name:"MuiDialogTitle"}),{className:i,id:a,...s}=n,o=n,c=Spe(o),{titleId:f=a}=te.useContext(fY);return J.jsx(Epe,{component:"h2",className:An(c.root,i),ownerState:o,ref:r,variant:"h6",id:a??f,...s})});function Tpe(t){return gi("MuiDivider",t)}const tz=pi("MuiDivider",["root","absolute","fullWidth","inset","middle","flexItem","light","vertical","withChildren","withChildrenVertical","textAlignRight","textAlignLeft","wrapper","wrapperVertical"]),Cpe=t=>{const{absolute:e,children:r,classes:n,flexItem:i,light:a,orientation:s,textAlign:o,variant:c}=t;return mi({root:["root",e&&"absolute",c,a&&"light",s==="vertical"&&"vertical",i&&"flexItem",r&&"withChildren",r&&s==="vertical"&&"withChildrenVertical",o==="right"&&s!=="vertical"&&"textAlignRight",o==="left"&&s!=="vertical"&&"textAlignLeft"],wrapper:["wrapper",s==="vertical"&&"wrapperVertical"]},Tpe,n)},Ape=Dr("div",{name:"MuiDivider",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.root,r.absolute&&e.absolute,e[r.variant],r.light&&e.light,r.orientation==="vertical"&&e.vertical,r.flexItem&&e.flexItem,r.children&&e.withChildren,r.children&&r.orientation==="vertical"&&e.withChildrenVertical,r.textAlign==="right"&&r.orientation!=="vertical"&&e.textAlignRight,r.textAlign==="left"&&r.orientation!=="vertical"&&e.textAlignLeft]}})(ci(({theme:t})=>({margin:0,flexShrink:0,borderWidth:0,borderStyle:"solid",borderColor:(t.vars||t).palette.divider,borderBottomWidth:"thin",variants:[{props:{absolute:!0},style:{position:"absolute",bottom:0,left:0,width:"100%"}},{props:{light:!0},style:{borderColor:t.alpha((t.vars||t).palette.divider,.08)}},{props:{variant:"inset"},style:{marginLeft:72}},{props:{variant:"middle",orientation:"horizontal"},style:{marginLeft:t.spacing(2),marginRight:t.spacing(2)}},{props:{variant:"middle",orientation:"vertical"},style:{marginTop:t.spacing(1),marginBottom:t.spacing(1)}},{props:{orientation:"vertical"},style:{height:"100%",borderBottomWidth:0,borderRightWidth:"thin"}},{props:{flexItem:!0},style:{alignSelf:"stretch",height:"auto"}},{props:({ownerState:e})=>!!e.children,style:{display:"flex",textAlign:"center",border:0,borderTopStyle:"solid",borderLeftStyle:"solid","&::before, &::after":{content:'""',alignSelf:"center"}}},{props:({ownerState:e})=>e.children&&e.orientation!=="vertical",style:{"&::before, &::after":{width:"100%",borderTop:`thin solid ${(t.vars||t).palette.divider}`,borderTopStyle:"inherit"}}},{props:({ownerState:e})=>e.orientation==="vertical"&&e.children,style:{flexDirection:"column","&::before, &::after":{height:"100%",borderLeft:`thin solid ${(t.vars||t).palette.divider}`,borderLeftStyle:"inherit"}}},{props:({ownerState:e})=>e.textAlign==="right"&&e.orientation!=="vertical",style:{"&::before":{width:"90%"},"&::after":{width:"10%"}}},{props:({ownerState:e})=>e.textAlign==="left"&&e.orientation!=="vertical",style:{"&::before":{width:"10%"},"&::after":{width:"90%"}}}]}))),Ipe=Dr("span",{name:"MuiDivider",slot:"Wrapper",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.wrapper,r.orientation==="vertical"&&e.wrapperVertical]}})(ci(({theme:t})=>({display:"inline-block",paddingLeft:`calc(${t.spacing(1)} * 1.2)`,paddingRight:`calc(${t.spacing(1)} * 1.2)`,whiteSpace:"nowrap",variants:[{props:{orientation:"vertical"},style:{paddingTop:`calc(${t.spacing(1)} * 1.2)`,paddingBottom:`calc(${t.spacing(1)} * 1.2)`}}]}))),$k=te.forwardRef(function(e,r){const n=bi({props:e,name:"MuiDivider"}),{absolute:i=!1,children:a,className:s,orientation:o="horizontal",component:c=a||o==="vertical"?"div":"hr",flexItem:f=!1,light:d=!1,role:m=c!=="hr"?"separator":void 0,textAlign:b="center",variant:x="fullWidth",...E}=n,T={...n,absolute:i,component:c,flexItem:f,light:d,orientation:o,role:m,textAlign:b,variant:x},A=Cpe(T);return J.jsx(Ape,{as:c,className:An(A.root,s),role:m,ref:r,ownerState:T,"aria-orientation":m==="separator"&&(c!=="hr"||o==="vertical")?o:void 0,...E,children:a?J.jsx(Ipe,{className:A.wrapper,ownerState:T,children:a}):null})});$k&&($k.muiSkipListHighlight=!0);function Ppe(t,e,r){const n=e.getBoundingClientRect(),i=r&&r.getBoundingClientRect(),a=bc(e);let s;if(e.fakeTransform)s=e.fakeTransform;else{const f=a.getComputedStyle(e);s=f.getPropertyValue("-webkit-transform")||f.getPropertyValue("transform")}let o=0,c=0;if(s&&s!=="none"&&typeof s=="string"){const f=s.split("(")[1].split(")")[0].split(",");o=parseInt(f[4],10),c=parseInt(f[5],10)}return t==="left"?i?`translateX(${i.right+o-n.left}px)`:`translateX(${a.innerWidth+o-n.left}px)`:t==="right"?i?`translateX(-${n.right-i.left-o}px)`:`translateX(-${n.left+n.width-o}px)`:t==="up"?i?`translateY(${i.bottom+c-n.top}px)`:`translateY(${a.innerHeight+c-n.top}px)`:i?`translateY(-${n.top-i.top+n.height-c}px)`:`translateY(-${n.top+n.height-c}px)`}function kpe(t){return typeof t=="function"?t():t}function H2(t,e,r){const n=kpe(r),i=Ppe(t,e,n);i&&(e.style.webkitTransform=i,e.style.transform=i)}const Rpe=te.forwardRef(function(e,r){const n=Bc(),i={enter:n.transitions.easing.easeOut,exit:n.transitions.easing.sharp},a={enter:n.transitions.duration.enteringScreen,exit:n.transitions.duration.leavingScreen},{addEndListener:s,appear:o=!0,children:c,container:f,direction:d="down",easing:m=i,in:b,onEnter:x,onEntered:E,onEntering:T,onExit:A,onExited:M,onExiting:F,style:N,timeout:O=a,TransitionComponent:U=Qf,...j}=e,H=te.useRef(null),W=Uo(Fg(c),H,r),X=ye=>Te=>{ye&&(Te===void 0?ye(H.current):ye(H.current,Te))},oe=X((ye,Te)=>{H2(d,ye,f),JD(ye),x&&x(ye,Te)}),Q=X((ye,Te)=>{const Ie=xp({timeout:O,style:N,easing:m},{mode:"enter"});ye.style.webkitTransition=n.transitions.create("-webkit-transform",{...Ie}),ye.style.transition=n.transitions.create("transform",{...Ie}),ye.style.webkitTransform="none",ye.style.transform="none",T&&T(ye,Te)}),G=X(E),ae=X(F),se=X(ye=>{const Te=xp({timeout:O,style:N,easing:m},{mode:"exit"});ye.style.webkitTransition=n.transitions.create("-webkit-transform",Te),ye.style.transition=n.transitions.create("transform",Te),H2(d,ye,f),A&&A(ye)}),fe=X(ye=>{ye.style.webkitTransition="",ye.style.transition="",M&&M(ye)}),_e=ye=>{s&&s(H.current,ye)},Le=te.useCallback(()=>{H.current&&H2(d,H.current,f)},[d,f]);return te.useEffect(()=>{if(b||d==="down"||d==="right")return;const ye=YD(()=>{H.current&&H2(d,H.current,f)}),Te=bc(H.current);return Te.addEventListener("resize",ye),()=>{ye.clear(),Te.removeEventListener("resize",ye)}},[d,b,f]),te.useEffect(()=>{b||Le()},[b,Le]),J.jsx(U,{nodeRef:H,onEnter:oe,onEntered:G,onEntering:Q,onExit:se,onExited:fe,onExiting:ae,addEndListener:_e,appear:o,in:b,timeout:O,...j,children:(ye,{ownerState:Te,...Ie})=>te.cloneElement(c,{ref:W,style:{visibility:ye==="exited"&&!b?"hidden":void 0,...N,...c.props.style},...Ie})})});function Mpe(t){return gi("MuiDrawer",t)}pi("MuiDrawer",["root","docked","paper","anchorLeft","anchorRight","anchorTop","anchorBottom","paperAnchorLeft","paperAnchorRight","paperAnchorTop","paperAnchorBottom","paperAnchorDockedLeft","paperAnchorDockedRight","paperAnchorDockedTop","paperAnchorDockedBottom","modal"]);const hY=(t,e)=>{const{ownerState:r}=t;return[e.root,(r.variant==="permanent"||r.variant==="persistent")&&e.docked,e.modal]},Dpe=t=>{const{classes:e,anchor:r,variant:n}=t,i={root:["root",`anchor${cn(r)}`],docked:[(n==="permanent"||n==="persistent")&&"docked"],modal:["modal"],paper:["paper",`paperAnchor${cn(r)}`,n!=="temporary"&&`paperAnchorDocked${cn(r)}`]};return mi(i,Mpe,e)},Ope=Dr(lO,{name:"MuiDrawer",slot:"Root",overridesResolver:hY})(ci(({theme:t})=>({zIndex:(t.vars||t).zIndex.drawer}))),Npe=Dr("div",{shouldForwardProp:Al,name:"MuiDrawer",slot:"Docked",skipVariantsResolver:!1,overridesResolver:hY})({flex:"0 0 auto"}),Lpe=Dr(hf,{name:"MuiDrawer",slot:"Paper",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.paper,e[`paperAnchor${cn(r.anchor)}`],r.variant!=="temporary"&&e[`paperAnchorDocked${cn(r.anchor)}`]]}})(ci(({theme:t})=>({overflowY:"auto",display:"flex",flexDirection:"column",height:"100%",flex:"1 0 auto",zIndex:(t.vars||t).zIndex.drawer,WebkitOverflowScrolling:"touch",position:"fixed",top:0,outline:0,variants:[{props:{anchor:"left"},style:{left:0}},{props:{anchor:"top"},style:{top:0,left:0,right:0,height:"auto",maxHeight:"100%"}},{props:{anchor:"right"},style:{right:0}},{props:{anchor:"bottom"},style:{top:"auto",left:0,bottom:0,right:0,height:"auto",maxHeight:"100%"}},{props:({ownerState:e})=>e.anchor==="left"&&e.variant!=="temporary",style:{borderRight:`1px solid ${(t.vars||t).palette.divider}`}},{props:({ownerState:e})=>e.anchor==="top"&&e.variant!=="temporary",style:{borderBottom:`1px solid ${(t.vars||t).palette.divider}`}},{props:({ownerState:e})=>e.anchor==="right"&&e.variant!=="temporary",style:{borderLeft:`1px solid ${(t.vars||t).palette.divider}`}},{props:({ownerState:e})=>e.anchor==="bottom"&&e.variant!=="temporary",style:{borderTop:`1px solid ${(t.vars||t).palette.divider}`}}]}))),dY={left:"right",right:"left",top:"down",bottom:"up"};function xm(t){return["left","right"].includes(t)}function D1({direction:t},e){return t==="rtl"&&xm(e)?dY[e]:e}const fO=te.forwardRef(function(e,r){const n=bi({props:e,name:"MuiDrawer"}),i=Bc(),a=Rx(),s={enter:i.transitions.duration.enteringScreen,exit:i.transitions.duration.leavingScreen},{anchor:o="left",BackdropProps:c,children:f,className:d,elevation:m=16,hideBackdrop:b=!1,ModalProps:{BackdropProps:x,...E}={},onClose:T,open:A=!1,PaperProps:M={},SlideProps:F,TransitionComponent:N,transitionDuration:O=s,variant:U="temporary",slots:j={},slotProps:H={},...W}=n,X=te.useRef(!1);te.useEffect(()=>{X.current=!0},[]);const oe=D1({direction:a?"rtl":"ltr"},o),G={...n,anchor:o,elevation:m,open:A,variant:U,...W},ae=Dpe(G),se={slots:{transition:N,...j},slotProps:{paper:M,transition:F,...H,backdrop:Fb(H.backdrop||{...c,...x},{transitionDuration:O})}},[fe,_e]=Ei("root",{ref:r,elementType:Ope,className:An(ae.root,ae.modal,d),shouldForwardComponentProp:!0,ownerState:G,externalForwardedProps:{...se,...W,...E},additionalProps:{open:A,onClose:T,hideBackdrop:b,slots:{backdrop:se.slots.backdrop},slotProps:{backdrop:se.slotProps.backdrop}}}),[Le,ye]=Ei("paper",{elementType:Lpe,shouldForwardComponentProp:!0,className:An(ae.paper,M.className),ownerState:G,externalForwardedProps:se,additionalProps:{elevation:U==="temporary"?m:0,square:!0,...U==="temporary"&&{role:"dialog","aria-modal":"true"}}}),[Te,Ie]=Ei("docked",{elementType:Npe,ref:r,className:An(ae.root,ae.docked,d),ownerState:G,externalForwardedProps:se,additionalProps:W}),[Me,de]=Ei("transition",{elementType:Rpe,ownerState:G,externalForwardedProps:se,additionalProps:{in:A,direction:dY[oe],timeout:O,appear:X.current}}),Se=J.jsx(Le,{...ye,children:f});if(U==="permanent")return J.jsx(Te,{...Ie,children:Se});const we=J.jsx(Me,{...de,children:Se});return U==="persistent"?J.jsx(Te,{...Ie,children:we}):J.jsx(fe,{..._e,children:we})}),Fpe=t=>{const{classes:e,disableUnderline:r,startAdornment:n,endAdornment:i,size:a,hiddenLabel:s,multiline:o}=t,c={root:["root",!r&&"underline",n&&"adornedStart",i&&"adornedEnd",a==="small"&&`size${cn(a)}`,s&&"hiddenLabel",o&&"multiline"],input:["input"]},f=mi(c,Qhe,e);return{...e,...f}},Bpe=Dr(KT,{shouldForwardProp:t=>Al(t)||t==="classes",name:"MuiFilledInput",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[...YT(t,e),!r.disableUnderline&&e.underline]}})(ci(({theme:t})=>{const e=t.palette.mode==="light",r=e?"rgba(0, 0, 0, 0.42)":"rgba(255, 255, 255, 0.7)",n=e?"rgba(0, 0, 0, 0.06)":"rgba(255, 255, 255, 0.09)",i=e?"rgba(0, 0, 0, 0.09)":"rgba(255, 255, 255, 0.13)",a=e?"rgba(0, 0, 0, 0.12)":"rgba(255, 255, 255, 0.12)";return{position:"relative",backgroundColor:t.vars?t.vars.palette.FilledInput.bg:n,borderTopLeftRadius:(t.vars||t).shape.borderRadius,borderTopRightRadius:(t.vars||t).shape.borderRadius,transition:t.transitions.create("background-color",{duration:t.transitions.duration.shorter,easing:t.transitions.easing.easeOut}),"&:hover":{backgroundColor:t.vars?t.vars.palette.FilledInput.hoverBg:i,"@media (hover: none)":{backgroundColor:t.vars?t.vars.palette.FilledInput.bg:n}},[`&.${cm.focused}`]:{backgroundColor:t.vars?t.vars.palette.FilledInput.bg:n},[`&.${cm.disabled}`]:{backgroundColor:t.vars?t.vars.palette.FilledInput.disabledBg:a},variants:[{props:({ownerState:s})=>!s.disableUnderline,style:{"&::after":{left:0,bottom:0,content:'""',position:"absolute",right:0,transform:"scaleX(0)",transition:t.transitions.create("transform",{duration:t.transitions.duration.shorter,easing:t.transitions.easing.easeOut}),pointerEvents:"none"},[`&.${cm.focused}:after`]:{transform:"scaleX(1) translateX(0)"},[`&.${cm.error}`]:{"&::before, &::after":{borderBottomColor:(t.vars||t).palette.error.main}},"&::before":{borderBottom:`1px solid ${t.vars?t.alpha(t.vars.palette.common.onBackground,t.vars.opacity.inputUnderline):r}`,left:0,bottom:0,content:'"\\00a0"',position:"absolute",right:0,transition:t.transitions.create("border-bottom-color",{duration:t.transitions.duration.shorter}),pointerEvents:"none"},[`&:hover:not(.${cm.disabled}, .${cm.error}):before`]:{borderBottom:`1px solid ${(t.vars||t).palette.text.primary}`},[`&.${cm.disabled}:before`]:{borderBottomStyle:"dotted"}}},...Object.entries(t.palette).filter(jl()).map(([s])=>({props:{disableUnderline:!1,color:s},style:{"&::after":{borderBottom:`2px solid ${(t.vars||t).palette[s]?.main}`}}})),{props:({ownerState:s})=>s.startAdornment,style:{paddingLeft:12}},{props:({ownerState:s})=>s.endAdornment,style:{paddingRight:12}},{props:({ownerState:s})=>s.multiline,style:{padding:"25px 12px 8px"}},{props:({ownerState:s,size:o})=>s.multiline&&o==="small",style:{paddingTop:21,paddingBottom:4}},{props:({ownerState:s})=>s.multiline&&s.hiddenLabel,style:{paddingTop:16,paddingBottom:17}},{props:({ownerState:s})=>s.multiline&&s.hiddenLabel&&s.size==="small",style:{paddingTop:8,paddingBottom:9}}]}})),zpe=Dr(JT,{name:"MuiFilledInput",slot:"Input",overridesResolver:ZT})(ci(({theme:t})=>({paddingTop:25,paddingRight:12,paddingBottom:8,paddingLeft:12,...!t.vars&&{"&:-webkit-autofill":{WebkitBoxShadow:t.palette.mode==="light"?null:"0 0 0 100px #266798 inset",WebkitTextFillColor:t.palette.mode==="light"?null:"#fff",caretColor:t.palette.mode==="light"?null:"#fff",borderTopLeftRadius:"inherit",borderTopRightRadius:"inherit"}},...t.vars&&{"&:-webkit-autofill":{borderTopLeftRadius:"inherit",borderTopRightRadius:"inherit"},[t.getColorSchemeSelector("dark")]:{"&:-webkit-autofill":{WebkitBoxShadow:"0 0 0 100px #266798 inset",WebkitTextFillColor:"#fff",caretColor:"#fff"}}},variants:[{props:{size:"small"},style:{paddingTop:21,paddingBottom:4}},{props:({ownerState:e})=>e.hiddenLabel,style:{paddingTop:16,paddingBottom:17}},{props:({ownerState:e})=>e.startAdornment,style:{paddingLeft:0}},{props:({ownerState:e})=>e.endAdornment,style:{paddingRight:0}},{props:({ownerState:e})=>e.hiddenLabel&&e.size==="small",style:{paddingTop:8,paddingBottom:9}},{props:({ownerState:e})=>e.multiline,style:{paddingTop:0,paddingBottom:0,paddingLeft:0,paddingRight:0}}]}))),hO=te.forwardRef(function(e,r){const n=bi({props:e,name:"MuiFilledInput"}),{disableUnderline:i=!1,components:a={},componentsProps:s,fullWidth:o=!1,hiddenLabel:c,inputComponent:f="input",multiline:d=!1,slotProps:m,slots:b={},type:x="text",...E}=n,T={...n,disableUnderline:i,fullWidth:o,inputComponent:f,multiline:d,type:x},A=Fpe(n),M={root:{ownerState:T},input:{ownerState:T}},F=m??s?Qu(M,m??s):M,N=b.root??a.Root??Bpe,O=b.input??a.Input??zpe;return J.jsx(sO,{slots:{root:N,input:O},slotProps:F,fullWidth:o,inputComponent:f,multiline:d,ref:r,type:x,...E,classes:A})});hO.muiName="Input";function jpe(t){return gi("MuiFormControl",t)}pi("MuiFormControl",["root","marginNone","marginNormal","marginDense","fullWidth","disabled"]);const Upe=t=>{const{classes:e,margin:r,fullWidth:n}=t,i={root:["root",r!=="none"&&`margin${cn(r)}`,n&&"fullWidth"]};return mi(i,jpe,e)},Vpe=Dr("div",{name:"MuiFormControl",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.root,e[`margin${cn(r.margin)}`],r.fullWidth&&e.fullWidth]}})({display:"inline-flex",flexDirection:"column",position:"relative",minWidth:0,padding:0,margin:0,border:0,verticalAlign:"top",variants:[{props:{margin:"normal"},style:{marginTop:16,marginBottom:8}},{props:{margin:"dense"},style:{marginTop:8,marginBottom:4}},{props:{fullWidth:!0},style:{width:"100%"}}]}),sf=te.forwardRef(function(e,r){const n=bi({props:e,name:"MuiFormControl"}),{children:i,className:a,color:s="primary",component:o="div",disabled:c=!1,error:f=!1,focused:d,fullWidth:m=!1,hiddenLabel:b=!1,margin:x="none",required:E=!1,size:T="medium",variant:A="outlined",...M}=n,F={...n,color:s,component:o,disabled:c,error:f,fullWidth:m,hiddenLabel:b,margin:x,required:E,size:T,variant:A},N=Upe(F),[O,U]=te.useState(()=>{let fe=!1;return i&&te.Children.forEach(i,_e=>{if(!ob(_e,["Input","Select"]))return;const Le=ob(_e,["Select"])?_e.props.input:_e;Le&&Xhe(Le.props)&&(fe=!0)}),fe}),[j,H]=te.useState(()=>{let fe=!1;return i&&te.Children.forEach(i,_e=>{ob(_e,["Input","Select"])&&(YS(_e.props,!0)||YS(_e.props.inputProps,!0))&&(fe=!0)}),fe}),[W,X]=te.useState(!1);c&&W&&X(!1);const oe=d!==void 0&&!c?d:W;let Q;te.useRef(!1);const G=te.useCallback(()=>{H(!0)},[]),ae=te.useCallback(()=>{H(!1)},[]),se=te.useMemo(()=>({adornedStart:O,setAdornedStart:U,color:s,disabled:c,error:f,filled:j,focused:oe,fullWidth:m,hiddenLabel:b,size:T,onBlur:()=>{X(!1)},onFocus:()=>{X(!0)},onEmpty:ae,onFilled:G,registerEffect:Q,required:E,variant:A}),[O,s,c,f,j,oe,m,b,Q,ae,G,E,T,A]);return J.jsx(oO.Provider,{value:se,children:J.jsx(Vpe,{as:o,ownerState:F,className:An(N.root,a),ref:r,...M,children:i})})});function $pe(t){return gi("MuiFormControlLabel",t)}const O1=pi("MuiFormControlLabel",["root","labelPlacementStart","labelPlacementTop","labelPlacementBottom","disabled","label","error","required","asterisk"]),qpe=t=>{const{classes:e,disabled:r,labelPlacement:n,error:i,required:a}=t,s={root:["root",r&&"disabled",`labelPlacement${cn(n)}`,i&&"error",a&&"required"],label:["label",r&&"disabled"],asterisk:["asterisk",i&&"error"]};return mi(s,$pe,e)},Hpe=Dr("label",{name:"MuiFormControlLabel",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[{[`& .${O1.label}`]:e.label},e.root,e[`labelPlacement${cn(r.labelPlacement)}`]]}})(ci(({theme:t})=>({display:"inline-flex",alignItems:"center",cursor:"pointer",verticalAlign:"middle",WebkitTapHighlightColor:"transparent",marginLeft:-11,marginRight:16,[`&.${O1.disabled}`]:{cursor:"default"},[`& .${O1.label}`]:{[`&.${O1.disabled}`]:{color:(t.vars||t).palette.text.disabled}},variants:[{props:{labelPlacement:"start"},style:{flexDirection:"row-reverse",marginRight:-11}},{props:{labelPlacement:"top"},style:{flexDirection:"column-reverse"}},{props:{labelPlacement:"bottom"},style:{flexDirection:"column"}},{props:({labelPlacement:e})=>e==="start"||e==="top"||e==="bottom",style:{marginLeft:16}}]}))),Gpe=Dr("span",{name:"MuiFormControlLabel",slot:"Asterisk"})(ci(({theme:t})=>({[`&.${O1.error}`]:{color:(t.vars||t).palette.error.main}}))),qk=te.forwardRef(function(e,r){const n=bi({props:e,name:"MuiFormControlLabel"}),{checked:i,className:a,componentsProps:s={},control:o,disabled:c,disableTypography:f,inputRef:d,label:m,labelPlacement:b="end",name:x,onChange:E,required:T,slots:A={},slotProps:M={},value:F,...N}=n,O=Pd(),U=c??o.props.disabled??O?.disabled,j=T??o.props.required,H={disabled:U,required:j};["checked","name","onChange","value","inputRef"].forEach(fe=>{typeof o.props[fe]>"u"&&typeof n[fe]<"u"&&(H[fe]=n[fe])});const W=Bg({props:n,muiFormControl:O,states:["error"]}),X={...n,disabled:U,labelPlacement:b,required:j,error:W.error},oe=qpe(X),Q={slots:A,slotProps:{...s,...M}},[G,ae]=Ei("typography",{elementType:Ss,externalForwardedProps:Q,ownerState:X});let se=m;return se!=null&&se.type!==Ss&&!f&&(se=J.jsx(G,{component:"span",...ae,className:An(oe.label,ae?.className),children:se})),J.jsxs(Hpe,{className:An(oe.root,a),ownerState:X,ref:r,...N,children:[te.cloneElement(o,H),j?J.jsxs("div",{children:[se,J.jsxs(Gpe,{ownerState:X,"aria-hidden":!0,className:oe.asterisk,children:["","*"]})]}):se]})});function Wpe(t){return gi("MuiFormGroup",t)}pi("MuiFormGroup",["root","row","error"]);const Xpe=t=>{const{classes:e,row:r,error:n}=t;return mi({root:["root",r&&"row",n&&"error"]},Wpe,e)},Ype=Dr("div",{name:"MuiFormGroup",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.root,r.row&&e.row]}})({display:"flex",flexDirection:"column",flexWrap:"wrap",variants:[{props:{row:!0},style:{flexDirection:"row"}}]}),pY=te.forwardRef(function(e,r){const n=bi({props:e,name:"MuiFormGroup"}),{className:i,row:a=!1,...s}=n,o=Pd(),c=Bg({props:n,muiFormControl:o,states:["error"]}),f={...n,row:a,error:c.error},d=Xpe(f);return J.jsx(Ype,{className:An(d.root,i),ownerState:f,ref:r,...s})});function Zpe(t){return gi("MuiFormHelperText",t)}const rz=pi("MuiFormHelperText",["root","error","disabled","sizeSmall","sizeMedium","contained","focused","filled","required"]);var nz;const Kpe=t=>{const{classes:e,contained:r,size:n,disabled:i,error:a,filled:s,focused:o,required:c}=t,f={root:["root",i&&"disabled",a&&"error",n&&`size${cn(n)}`,r&&"contained",o&&"focused",s&&"filled",c&&"required"]};return mi(f,Zpe,e)},Jpe=Dr("p",{name:"MuiFormHelperText",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.root,r.size&&e[`size${cn(r.size)}`],r.contained&&e.contained,r.filled&&e.filled]}})(ci(({theme:t})=>({color:(t.vars||t).palette.text.secondary,...t.typography.caption,textAlign:"left",marginTop:3,marginRight:0,marginBottom:0,marginLeft:0,[`&.${rz.disabled}`]:{color:(t.vars||t).palette.text.disabled},[`&.${rz.error}`]:{color:(t.vars||t).palette.error.main},variants:[{props:{size:"small"},style:{marginTop:4}},{props:({ownerState:e})=>e.contained,style:{marginLeft:14,marginRight:14}}]}))),Qpe=te.forwardRef(function(e,r){const n=bi({props:e,name:"MuiFormHelperText"}),{children:i,className:a,component:s="p",disabled:o,error:c,filled:f,focused:d,margin:m,required:b,variant:x,...E}=n,T=Pd(),A=Bg({props:n,muiFormControl:T,states:["variant","size","disabled","error","filled","focused","required"]}),M={...n,component:s,contained:A.variant==="filled"||A.variant==="outlined",variant:A.variant,size:A.size,disabled:A.disabled,error:A.error,filled:A.filled,focused:A.focused,required:A.required};delete M.ownerState;const F=Kpe(M);return J.jsx(Jpe,{as:s,className:An(F.root,a),ref:r,...E,ownerState:M,children:i===" "?nz||(nz=J.jsx("span",{className:"notranslate","aria-hidden":!0,children:""})):i})});function ege(t){return gi("MuiFormLabel",t)}const cb=pi("MuiFormLabel",["root","colorSecondary","focused","disabled","error","filled","required","asterisk"]),tge=t=>{const{classes:e,color:r,focused:n,disabled:i,error:a,filled:s,required:o}=t,c={root:["root",`color${cn(r)}`,i&&"disabled",a&&"error",s&&"filled",n&&"focused",o&&"required"],asterisk:["asterisk",a&&"error"]};return mi(c,ege,e)},rge=Dr("label",{name:"MuiFormLabel",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.root,r.color==="secondary"&&e.colorSecondary,r.filled&&e.filled]}})(ci(({theme:t})=>({color:(t.vars||t).palette.text.secondary,...t.typography.body1,lineHeight:"1.4375em",padding:0,position:"relative",variants:[...Object.entries(t.palette).filter(jl()).map(([e])=>({props:{color:e},style:{[`&.${cb.focused}`]:{color:(t.vars||t).palette[e].main}}})),{props:{},style:{[`&.${cb.disabled}`]:{color:(t.vars||t).palette.text.disabled},[`&.${cb.error}`]:{color:(t.vars||t).palette.error.main}}}]}))),nge=Dr("span",{name:"MuiFormLabel",slot:"Asterisk"})(ci(({theme:t})=>({[`&.${cb.error}`]:{color:(t.vars||t).palette.error.main}}))),gY=te.forwardRef(function(e,r){const n=bi({props:e,name:"MuiFormLabel"}),{children:i,className:a,color:s,component:o="label",disabled:c,error:f,filled:d,focused:m,required:b,...x}=n,E=Pd(),T=Bg({props:n,muiFormControl:E,states:["color","required","focused","disabled","error","filled"]}),A={...n,color:T.color||"primary",component:o,disabled:T.disabled,error:T.error,filled:T.filled,focused:T.focused,required:T.required},M=tge(A);return J.jsxs(rge,{as:o,ownerState:A,className:An(M.root,a),ref:r,...x,children:[i,T.required&&J.jsxs(nge,{ownerState:A,"aria-hidden":!0,className:M.asterisk,children:["","*"]})]})}),hp=Eue({createStyledComponent:Dr("div",{name:"MuiGrid",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.root,r.container&&e.container]}}),componentName:"MuiGrid",useThemeProps:t=>bi({props:t,name:"MuiGrid"}),useTheme:Bc});function Hk(t){return`scale(${t}, ${t**2})`}const ige={entering:{opacity:1,transform:Hk(1)},entered:{opacity:1,transform:"none"}},yA=typeof navigator<"u"&&/^((?!chrome|android).)*(safari|mobile)/i.test(navigator.userAgent)&&/(os |version\/)15(.|_)4/i.test(navigator.userAgent),jb=te.forwardRef(function(e,r){const{addEndListener:n,appear:i=!0,children:a,easing:s,in:o,onEnter:c,onEntered:f,onEntering:d,onExit:m,onExited:b,onExiting:x,style:E,timeout:T="auto",TransitionComponent:A=Qf,...M}=e,F=fg(),N=te.useRef(),O=Bc(),U=te.useRef(null),j=Uo(U,Fg(a),r),H=fe=>_e=>{if(fe){const Le=U.current;_e===void 0?fe(Le):fe(Le,_e)}},W=H(d),X=H((fe,_e)=>{JD(fe);const{duration:Le,delay:ye,easing:Te}=xp({style:E,timeout:T,easing:s},{mode:"enter"});let Ie;T==="auto"?(Ie=O.transitions.getAutoHeightDuration(fe.clientHeight),N.current=Ie):Ie=Le,fe.style.transition=[O.transitions.create("opacity",{duration:Ie,delay:ye}),O.transitions.create("transform",{duration:yA?Ie:Ie*.666,delay:ye,easing:Te})].join(","),c&&c(fe,_e)}),oe=H(f),Q=H(x),G=H(fe=>{const{duration:_e,delay:Le,easing:ye}=xp({style:E,timeout:T,easing:s},{mode:"exit"});let Te;T==="auto"?(Te=O.transitions.getAutoHeightDuration(fe.clientHeight),N.current=Te):Te=_e,fe.style.transition=[O.transitions.create("opacity",{duration:Te,delay:Le}),O.transitions.create("transform",{duration:yA?Te:Te*.666,delay:yA?Le:Le||Te*.333,easing:ye})].join(","),fe.style.opacity=0,fe.style.transform=Hk(.75),m&&m(fe)}),ae=H(b),se=fe=>{T==="auto"&&F.start(N.current||0,fe),n&&n(U.current,fe)};return J.jsx(A,{appear:i,in:o,nodeRef:U,onEnter:X,onEntered:oe,onEntering:W,onExit:G,onExited:ae,onExiting:Q,addEndListener:se,timeout:T==="auto"?null:T,...M,children:(fe,{ownerState:_e,...Le})=>te.cloneElement(a,{style:{opacity:0,transform:Hk(.75),visibility:fe==="exited"&&!o?"hidden":void 0,...ige[fe],...E,...a.props.style},ref:j,...Le})})});jb&&(jb.muiSupportAuto=!0);const age=t=>{const{classes:e,disableUnderline:r}=t,i=mi({root:["root",!r&&"underline"],input:["input"]},Khe,e);return{...e,...i}},oge=Dr(KT,{shouldForwardProp:t=>Al(t)||t==="classes",name:"MuiInput",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[...YT(t,e),!r.disableUnderline&&e.underline]}})(ci(({theme:t})=>{let r=t.palette.mode==="light"?"rgba(0, 0, 0, 0.42)":"rgba(255, 255, 255, 0.7)";return t.vars&&(r=t.alpha(t.vars.palette.common.onBackground,t.vars.opacity.inputUnderline)),{position:"relative",variants:[{props:({ownerState:n})=>n.formControl,style:{"label + &":{marginTop:16}}},{props:({ownerState:n})=>!n.disableUnderline,style:{"&::after":{left:0,bottom:0,content:'""',position:"absolute",right:0,transform:"scaleX(0)",transition:t.transitions.create("transform",{duration:t.transitions.duration.shorter,easing:t.transitions.easing.easeOut}),pointerEvents:"none"},[`&.${t1.focused}:after`]:{transform:"scaleX(1) translateX(0)"},[`&.${t1.error}`]:{"&::before, &::after":{borderBottomColor:(t.vars||t).palette.error.main}},"&::before":{borderBottom:`1px solid ${r}`,left:0,bottom:0,content:'"\\00a0"',position:"absolute",right:0,transition:t.transitions.create("border-bottom-color",{duration:t.transitions.duration.shorter}),pointerEvents:"none"},[`&:hover:not(.${t1.disabled}, .${t1.error}):before`]:{borderBottom:`2px solid ${(t.vars||t).palette.text.primary}`,"@media (hover: none)":{borderBottom:`1px solid ${r}`}},[`&.${t1.disabled}:before`]:{borderBottomStyle:"dotted"}}},...Object.entries(t.palette).filter(jl()).map(([n])=>({props:{color:n,disableUnderline:!1},style:{"&::after":{borderBottom:`2px solid ${(t.vars||t).palette[n].main}`}}}))]}})),sge=Dr(JT,{name:"MuiInput",slot:"Input",overridesResolver:ZT})({}),dO=te.forwardRef(function(e,r){const n=bi({props:e,name:"MuiInput"}),{disableUnderline:i=!1,components:a={},componentsProps:s,fullWidth:o=!1,inputComponent:c="input",multiline:f=!1,slotProps:d,slots:m={},type:b="text",...x}=n,E=age(n),A={root:{ownerState:{disableUnderline:i}}},M=d??s?Qu(d??s,A):A,F=m.root??a.Root??oge,N=m.input??a.Input??sge;return J.jsx(sO,{slots:{root:F,input:N},slotProps:M,fullWidth:o,inputComponent:c,multiline:f,ref:r,type:b,...x,classes:E})});dO.muiName="Input";function lge(t){return gi("MuiInputLabel",t)}pi("MuiInputLabel",["root","focused","disabled","error","required","asterisk","formControl","sizeSmall","shrink","animated","standard","filled","outlined"]);const uge=t=>{const{classes:e,formControl:r,size:n,shrink:i,disableAnimation:a,variant:s,required:o}=t,c={root:["root",r&&"formControl",!a&&"animated",i&&"shrink",n&&n!=="medium"&&`size${cn(n)}`,s],asterisk:[o&&"asterisk"]},f=mi(c,lge,e);return{...e,...f}},cge=Dr(gY,{shouldForwardProp:t=>Al(t)||t==="classes",name:"MuiInputLabel",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[{[`& .${cb.asterisk}`]:e.asterisk},e.root,r.formControl&&e.formControl,r.size==="small"&&e.sizeSmall,r.shrink&&e.shrink,!r.disableAnimation&&e.animated,r.focused&&e.focused,e[r.variant]]}})(ci(({theme:t})=>({display:"block",transformOrigin:"top left",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",maxWidth:"100%",variants:[{props:({ownerState:e})=>e.formControl,style:{position:"absolute",left:0,top:0,transform:"translate(0, 20px) scale(1)"}},{props:{size:"small"},style:{transform:"translate(0, 17px) scale(1)"}},{props:({ownerState:e})=>e.shrink,style:{transform:"translate(0, -1.5px) scale(0.75)",transformOrigin:"top left",maxWidth:"133%"}},{props:({ownerState:e})=>!e.disableAnimation,style:{transition:t.transitions.create(["color","transform","max-width"],{duration:t.transitions.duration.shorter,easing:t.transitions.easing.easeOut})}},{props:{variant:"filled"},style:{zIndex:1,pointerEvents:"none",transform:"translate(12px, 16px) scale(1)",maxWidth:"calc(100% - 24px)"}},{props:{variant:"filled",size:"small"},style:{transform:"translate(12px, 13px) scale(1)"}},{props:({variant:e,ownerState:r})=>e==="filled"&&r.shrink,style:{userSelect:"none",pointerEvents:"auto",transform:"translate(12px, 7px) scale(0.75)",maxWidth:"calc(133% - 24px)"}},{props:({variant:e,ownerState:r,size:n})=>e==="filled"&&r.shrink&&n==="small",style:{transform:"translate(12px, 4px) scale(0.75)"}},{props:{variant:"outlined"},style:{zIndex:1,pointerEvents:"none",transform:"translate(14px, 16px) scale(1)",maxWidth:"calc(100% - 24px)"}},{props:{variant:"outlined",size:"small"},style:{transform:"translate(14px, 9px) scale(1)"}},{props:({variant:e,ownerState:r})=>e==="outlined"&&r.shrink,style:{userSelect:"none",pointerEvents:"auto",maxWidth:"calc(133% - 32px)",transform:"translate(14px, -9px) scale(0.75)"}}]}))),_g=te.forwardRef(function(e,r){const n=bi({name:"MuiInputLabel",props:e}),{disableAnimation:i=!1,margin:a,shrink:s,variant:o,className:c,...f}=n,d=Pd();let m=s;typeof m>"u"&&d&&(m=d.filled||d.focused||d.adornedStart);const b=Bg({props:n,muiFormControl:d,states:["size","variant","required","focused"]}),x={...n,disableAnimation:i,formControl:d,shrink:m,size:b.size,variant:b.variant,required:b.required,focused:b.focused},E=uge(x);return J.jsx(cge,{"data-shrink":m,ref:r,className:An(E.root,c),...f,ownerState:x,classes:E})}),jf=te.createContext({});function fge(t){return gi("MuiList",t)}pi("MuiList",["root","padding","dense","subheader"]);const hge=t=>{const{classes:e,disablePadding:r,dense:n,subheader:i}=t;return mi({root:["root",!r&&"padding",n&&"dense",i&&"subheader"]},fge,e)},dge=Dr("ul",{name:"MuiList",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.root,!r.disablePadding&&e.padding,r.dense&&e.dense,r.subheader&&e.subheader]}})({listStyle:"none",margin:0,padding:0,position:"relative",variants:[{props:({ownerState:t})=>!t.disablePadding,style:{paddingTop:8,paddingBottom:8}},{props:({ownerState:t})=>t.subheader,style:{paddingTop:0}}]}),Mh=te.forwardRef(function(e,r){const n=bi({props:e,name:"MuiList"}),{children:i,className:a,component:s="ul",dense:o=!1,disablePadding:c=!1,subheader:f,...d}=n,m=te.useMemo(()=>({dense:o}),[o]),b={...n,component:s,dense:o,disablePadding:c},x=hge(b);return J.jsx(jf.Provider,{value:m,children:J.jsxs(dge,{as:s,className:An(x.root,a),ref:r,ownerState:b,...d,children:[f,i]})})});function pge(t){return gi("MuiListItem",t)}pi("MuiListItem",["root","container","dense","alignItemsFlexStart","divider","gutters","padding","secondaryAction"]);function gge(t){return gi("MuiListItemButton",t)}const Fv=pi("MuiListItemButton",["root","focusVisible","dense","alignItemsFlexStart","disabled","divider","gutters","selected"]),mge=(t,e)=>{const{ownerState:r}=t;return[e.root,r.dense&&e.dense,r.alignItems==="flex-start"&&e.alignItemsFlexStart,r.divider&&e.divider,!r.disableGutters&&e.gutters]},yge=t=>{const{alignItems:e,classes:r,dense:n,disabled:i,disableGutters:a,divider:s,selected:o}=t,f=mi({root:["root",n&&"dense",!a&&"gutters",s&&"divider",i&&"disabled",e==="flex-start"&&"alignItemsFlexStart",o&&"selected"]},gge,r);return{...r,...f}},vge=Dr(d_,{shouldForwardProp:t=>Al(t)||t==="classes",name:"MuiListItemButton",slot:"Root",overridesResolver:mge})(ci(({theme:t})=>({display:"flex",flexGrow:1,justifyContent:"flex-start",alignItems:"center",position:"relative",textDecoration:"none",minWidth:0,boxSizing:"border-box",textAlign:"left",paddingTop:8,paddingBottom:8,transition:t.transitions.create("background-color",{duration:t.transitions.duration.shortest}),"&:hover":{textDecoration:"none",backgroundColor:(t.vars||t).palette.action.hover,"@media (hover: none)":{backgroundColor:"transparent"}},[`&.${Fv.selected}`]:{backgroundColor:t.alpha((t.vars||t).palette.primary.main,(t.vars||t).palette.action.selectedOpacity),[`&.${Fv.focusVisible}`]:{backgroundColor:t.alpha((t.vars||t).palette.primary.main,`${(t.vars||t).palette.action.selectedOpacity} + ${(t.vars||t).palette.action.focusOpacity}`)}},[`&.${Fv.selected}:hover`]:{backgroundColor:t.alpha((t.vars||t).palette.primary.main,`${(t.vars||t).palette.action.selectedOpacity} + ${(t.vars||t).palette.action.hoverOpacity}`),"@media (hover: none)":{backgroundColor:t.alpha((t.vars||t).palette.primary.main,(t.vars||t).palette.action.selectedOpacity)}},[`&.${Fv.focusVisible}`]:{backgroundColor:(t.vars||t).palette.action.focus},[`&.${Fv.disabled}`]:{opacity:(t.vars||t).palette.action.disabledOpacity},variants:[{props:({ownerState:e})=>e.divider,style:{borderBottom:`1px solid ${(t.vars||t).palette.divider}`,backgroundClip:"padding-box"}},{props:{alignItems:"flex-start"},style:{alignItems:"flex-start"}},{props:({ownerState:e})=>!e.disableGutters,style:{paddingLeft:16,paddingRight:16}},{props:({ownerState:e})=>e.dense,style:{paddingTop:4,paddingBottom:4}}]}))),mY=te.forwardRef(function(e,r){const n=bi({props:e,name:"MuiListItemButton"}),{alignItems:i="center",autoFocus:a=!1,component:s="div",children:o,dense:c=!1,disableGutters:f=!1,divider:d=!1,focusVisibleClassName:m,selected:b=!1,className:x,...E}=n,T=te.useContext(jf),A=te.useMemo(()=>({dense:c||T.dense||!1,alignItems:i,disableGutters:f}),[i,T.dense,c,f]),M=te.useRef(null);Tu(()=>{a&&M.current&&M.current.focus()},[a]);const F={...n,alignItems:i,dense:A.dense,disableGutters:f,divider:d,selected:b},N=yge(F),O=Uo(M,r);return J.jsx(jf.Provider,{value:A,children:J.jsx(vge,{ref:O,href:E.href||E.to,component:(E.href||E.to)&&s==="div"?"button":s,focusVisibleClassName:An(N.focusVisible,m),ownerState:F,className:An(N.root,x),...E,classes:N,children:o})})});function _ge(t){return gi("MuiListItemSecondaryAction",t)}pi("MuiListItemSecondaryAction",["root","disableGutters"]);const bge=t=>{const{disableGutters:e,classes:r}=t;return mi({root:["root",e&&"disableGutters"]},_ge,r)},xge=Dr("div",{name:"MuiListItemSecondaryAction",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.root,r.disableGutters&&e.disableGutters]}})({position:"absolute",right:16,top:"50%",transform:"translateY(-50%)",variants:[{props:({ownerState:t})=>t.disableGutters,style:{right:0}}]}),yY=te.forwardRef(function(e,r){const n=bi({props:e,name:"MuiListItemSecondaryAction"}),{className:i,...a}=n,s=te.useContext(jf),o={...n,disableGutters:s.disableGutters},c=bge(o);return J.jsx(xge,{className:An(c.root,i),ownerState:o,ref:r,...a})});yY.muiName="ListItemSecondaryAction";const wge=(t,e)=>{const{ownerState:r}=t;return[e.root,r.dense&&e.dense,r.alignItems==="flex-start"&&e.alignItemsFlexStart,r.divider&&e.divider,!r.disableGutters&&e.gutters,!r.disablePadding&&e.padding,r.hasSecondaryAction&&e.secondaryAction]},Sge=t=>{const{alignItems:e,classes:r,dense:n,disableGutters:i,disablePadding:a,divider:s,hasSecondaryAction:o}=t;return mi({root:["root",n&&"dense",!i&&"gutters",!a&&"padding",s&&"divider",e==="flex-start"&&"alignItemsFlexStart",o&&"secondaryAction"],container:["container"]},pge,r)},Ege=Dr("div",{name:"MuiListItem",slot:"Root",overridesResolver:wge})(ci(({theme:t})=>({display:"flex",justifyContent:"flex-start",alignItems:"center",position:"relative",textDecoration:"none",width:"100%",boxSizing:"border-box",textAlign:"left",variants:[{props:({ownerState:e})=>!e.disablePadding,style:{paddingTop:8,paddingBottom:8}},{props:({ownerState:e})=>!e.disablePadding&&e.dense,style:{paddingTop:4,paddingBottom:4}},{props:({ownerState:e})=>!e.disablePadding&&!e.disableGutters,style:{paddingLeft:16,paddingRight:16}},{props:({ownerState:e})=>!e.disablePadding&&!!e.secondaryAction,style:{paddingRight:48}},{props:({ownerState:e})=>!!e.secondaryAction,style:{[`& > .${Fv.root}`]:{paddingRight:48}}},{props:{alignItems:"flex-start"},style:{alignItems:"flex-start"}},{props:({ownerState:e})=>e.divider,style:{borderBottom:`1px solid ${(t.vars||t).palette.divider}`,backgroundClip:"padding-box"}},{props:({ownerState:e})=>e.button,style:{transition:t.transitions.create("background-color",{duration:t.transitions.duration.shortest}),"&:hover":{textDecoration:"none",backgroundColor:(t.vars||t).palette.action.hover,"@media (hover: none)":{backgroundColor:"transparent"}}}},{props:({ownerState:e})=>e.hasSecondaryAction,style:{paddingRight:48}}]}))),Tge=Dr("li",{name:"MuiListItem",slot:"Container"})({position:"relative"}),Gf=te.forwardRef(function(e,r){const n=bi({props:e,name:"MuiListItem"}),{alignItems:i="center",children:a,className:s,component:o,components:c={},componentsProps:f={},ContainerComponent:d="li",ContainerProps:{className:m,...b}={},dense:x=!1,disableGutters:E=!1,disablePadding:T=!1,divider:A=!1,secondaryAction:M,slotProps:F={},slots:N={},...O}=n,U=te.useContext(jf),j=te.useMemo(()=>({dense:x||U.dense||!1,alignItems:i,disableGutters:E}),[i,U.dense,x,E]),H=te.useRef(null),W=te.Children.toArray(a),X=W.length&&ob(W[W.length-1],["ListItemSecondaryAction"]),oe={...n,alignItems:i,dense:j.dense,disableGutters:E,disablePadding:T,divider:A,hasSecondaryAction:X},Q=Sge(oe),G=Uo(H,r),ae=N.root||c.Root||Ege,se=F.root||f.root||{},fe={className:An(Q.root,se.className,s),...O};let _e=o||"li";return X?(_e=!fe.component&&!o?"div":_e,d==="li"&&(_e==="li"?_e="div":fe.component==="li"&&(fe.component="div")),J.jsx(jf.Provider,{value:j,children:J.jsxs(Tge,{as:d,className:An(Q.container,m),ref:G,ownerState:oe,...b,children:[J.jsx(ae,{...se,...!vd(ae)&&{as:_e,ownerState:{...oe,...se.ownerState}},...fe,children:W}),W.pop()]})})):J.jsx(jf.Provider,{value:j,children:J.jsxs(ae,{...se,as:_e,ref:G,...!vd(ae)&&{ownerState:{...oe,...se.ownerState}},...fe,children:[W,M&&J.jsx(yY,{children:M})]})})});function Cge(t){return gi("MuiListItemAvatar",t)}pi("MuiListItemAvatar",["root","alignItemsFlexStart"]);const Age=t=>{const{alignItems:e,classes:r}=t;return mi({root:["root",e==="flex-start"&&"alignItemsFlexStart"]},Cge,r)},Ige=Dr("div",{name:"MuiListItemAvatar",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.root,r.alignItems==="flex-start"&&e.alignItemsFlexStart]}})({minWidth:56,flexShrink:0,variants:[{props:{alignItems:"flex-start"},style:{marginTop:8}}]}),vY=te.forwardRef(function(e,r){const n=bi({props:e,name:"MuiListItemAvatar"}),{className:i,...a}=n,s=te.useContext(jf),o={...n,alignItems:s.alignItems},c=Age(o);return J.jsx(Ige,{className:An(c.root,i),ownerState:o,ref:r,...a})});function Pge(t){return gi("MuiListItemIcon",t)}const iz=pi("MuiListItemIcon",["root","alignItemsFlexStart"]),kge=t=>{const{alignItems:e,classes:r}=t;return mi({root:["root",e==="flex-start"&&"alignItemsFlexStart"]},Pge,r)},Rge=Dr("div",{name:"MuiListItemIcon",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.root,r.alignItems==="flex-start"&&e.alignItemsFlexStart]}})(ci(({theme:t})=>({minWidth:56,color:(t.vars||t).palette.action.active,flexShrink:0,display:"inline-flex",variants:[{props:{alignItems:"flex-start"},style:{marginTop:8}}]}))),Ub=te.forwardRef(function(e,r){const n=bi({props:e,name:"MuiListItemIcon"}),{className:i,...a}=n,s=te.useContext(jf),o={...n,alignItems:s.alignItems},c=kge(o);return J.jsx(Rge,{className:An(c.root,i),ownerState:o,ref:r,...a})});function Mge(t){return gi("MuiListItemText",t)}const o0=pi("MuiListItemText",["root","multiline","dense","inset","primary","secondary"]),Dge=t=>{const{classes:e,inset:r,primary:n,secondary:i,dense:a}=t;return mi({root:["root",r&&"inset",a&&"dense",n&&i&&"multiline"],primary:["primary"],secondary:["secondary"]},Mge,e)},Oge=Dr("div",{name:"MuiListItemText",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[{[`& .${o0.primary}`]:e.primary},{[`& .${o0.secondary}`]:e.secondary},e.root,r.inset&&e.inset,r.primary&&r.secondary&&e.multiline,r.dense&&e.dense]}})({flex:"1 1 auto",minWidth:0,marginTop:4,marginBottom:4,[`.${OB.root}:where(& .${o0.primary})`]:{display:"block"},[`.${OB.root}:where(& .${o0.secondary})`]:{display:"block"},variants:[{props:({ownerState:t})=>t.primary&&t.secondary,style:{marginTop:6,marginBottom:6}},{props:({ownerState:t})=>t.inset,style:{paddingLeft:56}}]}),Lf=te.forwardRef(function(e,r){const n=bi({props:e,name:"MuiListItemText"}),{children:i,className:a,disableTypography:s=!1,inset:o=!1,primary:c,primaryTypographyProps:f,secondary:d,secondaryTypographyProps:m,slots:b={},slotProps:x={},...E}=n,{dense:T}=te.useContext(jf);let A=c??i,M=d;const F={...n,disableTypography:s,inset:o,primary:!!A,secondary:!!M,dense:T},N=Dge(F),O={slots:b,slotProps:{primary:f,secondary:m,...x}},[U,j]=Ei("root",{className:An(N.root,a),elementType:Oge,externalForwardedProps:{...O,...E},ownerState:F,ref:r}),[H,W]=Ei("primary",{className:N.primary,elementType:Ss,externalForwardedProps:O,ownerState:F}),[X,oe]=Ei("secondary",{className:N.secondary,elementType:Ss,externalForwardedProps:O,ownerState:F});return A!=null&&A.type!==Ss&&!s&&(A=J.jsx(H,{variant:T?"body2":"body1",component:W?.variant?void 0:"span",...W,children:A})),M!=null&&M.type!==Ss&&!s&&(M=J.jsx(X,{variant:"body2",color:"textSecondary",...oe,children:M})),J.jsxs(U,{...j,children:[A,M]})});function vA(t,e,r){return t===e?t.firstChild:e&&e.nextElementSibling?e.nextElementSibling:r?null:t.firstChild}function az(t,e,r){return t===e?r?t.firstChild:t.lastChild:e&&e.previousElementSibling?e.previousElementSibling:r?null:t.lastChild}function _Y(t,e){if(e===void 0)return!0;let r=t.innerText;return r===void 0&&(r=t.textContent),r=r.trim().toLowerCase(),r.length===0?!1:e.repeating?r[0]===e.keys[0]:r.startsWith(e.keys.join(""))}function r1(t,e,r,n,i,a){let s=!1,o=i(t,e,e?r:!1);for(;o;){if(o===t.firstChild){if(s)return!1;s=!0}const c=n?!1:o.disabled||o.getAttribute("aria-disabled")==="true";if(!o.hasAttribute("tabindex")||!_Y(o,a)||c)o=i(t,o,r);else return o.focus(),!0}return!1}const Nge=te.forwardRef(function(e,r){const{actions:n,autoFocus:i=!1,autoFocusItem:a=!1,children:s,className:o,disabledItemsFocusable:c=!1,disableListWrap:f=!1,onKeyDown:d,variant:m="selectedMenu",...b}=e,x=te.useRef(null),E=te.useRef({keys:[],repeating:!0,previousKeyMatched:!0,lastTime:null});Tu(()=>{i&&x.current.focus()},[i]),te.useImperativeHandle(n,()=>({adjustStyleForScrollbar:(N,{direction:O})=>{const U=!x.current.style.width;if(N.clientHeight<x.current.clientHeight&&U){const j=`${cY(bc(N))}px`;x.current.style[O==="rtl"?"paddingLeft":"paddingRight"]=j,x.current.style.width=`calc(100% + ${j})`}return x.current}}),[]);const T=N=>{const O=x.current,U=N.key;if(N.ctrlKey||N.metaKey||N.altKey){d&&d(N);return}const H=cs(O).activeElement;if(U==="ArrowDown")N.preventDefault(),r1(O,H,f,c,vA);else if(U==="ArrowUp")N.preventDefault(),r1(O,H,f,c,az);else if(U==="Home")N.preventDefault(),r1(O,null,f,c,vA);else if(U==="End")N.preventDefault(),r1(O,null,f,c,az);else if(U.length===1){const W=E.current,X=U.toLowerCase(),oe=performance.now();W.keys.length>0&&(oe-W.lastTime>500?(W.keys=[],W.repeating=!0,W.previousKeyMatched=!0):W.repeating&&X!==W.keys[0]&&(W.repeating=!1)),W.lastTime=oe,W.keys.push(X);const Q=H&&!W.repeating&&_Y(H,W);W.previousKeyMatched&&(Q||r1(O,H,!1,c,vA,W))?N.preventDefault():W.previousKeyMatched=!1}d&&d(N)},A=Uo(x,r);let M=-1;te.Children.forEach(s,(N,O)=>{if(!te.isValidElement(N)){M===O&&(M+=1,M>=s.length&&(M=-1));return}N.props.disabled||(m==="selectedMenu"&&N.props.selected||M===-1)&&(M=O),M===O&&(N.props.disabled||N.props.muiSkipListHighlight||N.type.muiSkipListHighlight)&&(M+=1,M>=s.length&&(M=-1))});const F=te.Children.map(s,(N,O)=>{if(O===M){const U={};return a&&(U.autoFocus=!0),N.props.tabIndex===void 0&&m==="selectedMenu"&&(U.tabIndex=0),te.cloneElement(N,U)}return N});return J.jsx(Mh,{role:"menu",ref:A,className:o,onKeyDown:T,tabIndex:i?0:-1,...b,children:F})});function Lge(t){return gi("MuiPopover",t)}pi("MuiPopover",["root","paper"]);function oz(t,e){let r=0;return typeof e=="number"?r=e:e==="center"?r=t.height/2:e==="bottom"&&(r=t.height),r}function sz(t,e){let r=0;return typeof e=="number"?r=e:e==="center"?r=t.width/2:e==="right"&&(r=t.width),r}function lz(t){return[t.horizontal,t.vertical].map(e=>typeof e=="number"?`${e}px`:e).join(" ")}function G2(t){return typeof t=="function"?t():t}const Fge=t=>{const{classes:e}=t;return mi({root:["root"],paper:["paper"]},Lge,e)},Bge=Dr(lO,{name:"MuiPopover",slot:"Root"})({}),bY=Dr(hf,{name:"MuiPopover",slot:"Paper"})({position:"absolute",overflowY:"auto",overflowX:"hidden",minWidth:16,minHeight:16,maxWidth:"calc(100% - 32px)",maxHeight:"calc(100% - 32px)",outline:0}),zge=te.forwardRef(function(e,r){const n=bi({props:e,name:"MuiPopover"}),{action:i,anchorEl:a,anchorOrigin:s={vertical:"top",horizontal:"left"},anchorPosition:o,anchorReference:c="anchorEl",children:f,className:d,container:m,elevation:b=8,marginThreshold:x=16,open:E,PaperProps:T={},slots:A={},slotProps:M={},transformOrigin:F={vertical:"top",horizontal:"left"},TransitionComponent:N,transitionDuration:O="auto",TransitionProps:U={},disableScrollLock:j=!1,...H}=n,W=te.useRef(),X={...n,anchorOrigin:s,anchorReference:c,elevation:b,marginThreshold:x,transformOrigin:F,TransitionComponent:N,transitionDuration:O,TransitionProps:U},oe=Fge(X),Q=te.useCallback(()=>{if(c==="anchorPosition")return o;const Qe=G2(a),be=(Qe&&Qe.nodeType===1?Qe:cs(W.current).body).getBoundingClientRect();return{top:be.top+oz(be,s.vertical),left:be.left+sz(be,s.horizontal)}},[a,s.horizontal,s.vertical,o,c]),G=te.useCallback(Qe=>({vertical:oz(Qe,F.vertical),horizontal:sz(Qe,F.horizontal)}),[F.horizontal,F.vertical]),ae=te.useCallback(Qe=>{const it={width:Qe.offsetWidth,height:Qe.offsetHeight},be=G(it);if(c==="none")return{top:null,left:null,transformOrigin:lz(be)};const Ot=Q();let at=Ot.top-be.vertical,$e=Ot.left-be.horizontal;const Xt=at+it.height,$t=$e+it.width,cr=bc(G2(a)),_t=cr.innerHeight-x,gr=cr.innerWidth-x;if(x!==null&&at<x){const mr=at-x;at-=mr,be.vertical+=mr}else if(x!==null&&Xt>_t){const mr=Xt-_t;at-=mr,be.vertical+=mr}if(x!==null&&$e<x){const mr=$e-x;$e-=mr,be.horizontal+=mr}else if($t>gr){const mr=$t-gr;$e-=mr,be.horizontal+=mr}return{top:`${Math.round(at)}px`,left:`${Math.round($e)}px`,transformOrigin:lz(be)}},[a,c,Q,G,x]),[se,fe]=te.useState(E),_e=te.useCallback(()=>{const Qe=W.current;if(!Qe)return;const it=ae(Qe);it.top!==null&&Qe.style.setProperty("top",it.top),it.left!==null&&(Qe.style.left=it.left),Qe.style.transformOrigin=it.transformOrigin,fe(!0)},[ae]);te.useEffect(()=>(j&&window.addEventListener("scroll",_e),()=>window.removeEventListener("scroll",_e)),[a,j,_e]);const Le=()=>{_e()},ye=()=>{fe(!1)};te.useEffect(()=>{E&&_e()}),te.useImperativeHandle(i,()=>E?{updatePosition:()=>{_e()}}:null,[E,_e]),te.useEffect(()=>{if(!E)return;const Qe=YD(()=>{_e()}),it=bc(G2(a));return it.addEventListener("resize",Qe),()=>{Qe.clear(),it.removeEventListener("resize",Qe)}},[a,E,_e]);let Te=O;const Ie={slots:{transition:N,...A},slotProps:{transition:U,paper:T,...M}},[Me,de]=Ei("transition",{elementType:jb,externalForwardedProps:Ie,ownerState:X,getSlotProps:Qe=>({...Qe,onEntering:(it,be)=>{Qe.onEntering?.(it,be),Le()},onExited:it=>{Qe.onExited?.(it),ye()}}),additionalProps:{appear:!0,in:E}});O==="auto"&&!Me.muiSupportAuto&&(Te=void 0);const Se=m||(a?cs(G2(a)).body:void 0),[we,{slots:De,slotProps:Fe,...Xe}]=Ei("root",{ref:r,elementType:Bge,externalForwardedProps:{...Ie,...H},shouldForwardComponentProp:!0,additionalProps:{slots:{backdrop:A.backdrop},slotProps:{backdrop:Fb(typeof M.backdrop=="function"?M.backdrop(X):M.backdrop,{invisible:!0})},container:Se,open:E},ownerState:X,className:An(oe.root,d)}),[Be,st]=Ei("paper",{ref:W,className:oe.paper,elementType:bY,externalForwardedProps:Ie,shouldForwardComponentProp:!0,additionalProps:{elevation:b,style:se?void 0:{opacity:0}},ownerState:X});return J.jsx(we,{...Xe,...!vd(we)&&{slots:De,slotProps:Fe,disableScrollLock:j},children:J.jsx(Me,{...de,timeout:Te,children:J.jsx(Be,{...st,children:f})})})});function jge(t){return gi("MuiMenu",t)}pi("MuiMenu",["root","paper","list"]);const Uge={vertical:"top",horizontal:"right"},Vge={vertical:"top",horizontal:"left"},$ge=t=>{const{classes:e}=t;return mi({root:["root"],paper:["paper"],list:["list"]},jge,e)},qge=Dr(zge,{shouldForwardProp:t=>Al(t)||t==="classes",name:"MuiMenu",slot:"Root"})({}),Hge=Dr(bY,{name:"MuiMenu",slot:"Paper"})({maxHeight:"calc(100% - 96px)",WebkitOverflowScrolling:"touch"}),Gge=Dr(Nge,{name:"MuiMenu",slot:"List"})({outline:0}),xY=te.forwardRef(function(e,r){const n=bi({props:e,name:"MuiMenu"}),{autoFocus:i=!0,children:a,className:s,disableAutoFocusItem:o=!1,MenuListProps:c={},onClose:f,open:d,PaperProps:m={},PopoverClasses:b,transitionDuration:x="auto",TransitionProps:{onEntering:E,...T}={},variant:A="selectedMenu",slots:M={},slotProps:F={},...N}=n,O=Rx(),U={...n,autoFocus:i,disableAutoFocusItem:o,MenuListProps:c,onEntering:E,PaperProps:m,transitionDuration:x,TransitionProps:T,variant:A},j=$ge(U),H=i&&!o&&d,W=te.useRef(null),X=(Te,Ie)=>{W.current&&W.current.adjustStyleForScrollbar(Te,{direction:O?"rtl":"ltr"}),E&&E(Te,Ie)},oe=Te=>{Te.key==="Tab"&&(Te.preventDefault(),f&&f(Te,"tabKeyDown"))};let Q=-1;te.Children.map(a,(Te,Ie)=>{te.isValidElement(Te)&&(Te.props.disabled||(A==="selectedMenu"&&Te.props.selected||Q===-1)&&(Q=Ie))});const G={slots:M,slotProps:{list:c,transition:T,paper:m,...F}},ae=od({elementType:M.root,externalSlotProps:F.root,ownerState:U,className:[j.root,s]}),[se,fe]=Ei("paper",{className:j.paper,elementType:Hge,externalForwardedProps:G,shouldForwardComponentProp:!0,ownerState:U}),[_e,Le]=Ei("list",{className:An(j.list,c.className),elementType:Gge,shouldForwardComponentProp:!0,externalForwardedProps:G,getSlotProps:Te=>({...Te,onKeyDown:Ie=>{oe(Ie),Te.onKeyDown?.(Ie)}}),ownerState:U}),ye=typeof G.slotProps.transition=="function"?G.slotProps.transition(U):G.slotProps.transition;return J.jsx(qge,{onClose:f,anchorOrigin:{vertical:"bottom",horizontal:O?"right":"left"},transformOrigin:O?Uge:Vge,slots:{root:M.root,paper:se,backdrop:M.backdrop,...M.transition&&{transition:M.transition}},slotProps:{root:ae,paper:fe,backdrop:typeof F.backdrop=="function"?F.backdrop(U):F.backdrop,transition:{...ye,onEntering:(...Te)=>{X(...Te),ye?.onEntering?.(...Te)}}},open:d,ref:r,transitionDuration:x,ownerState:U,...N,classes:b,children:J.jsx(_e,{actions:W,autoFocus:i&&(Q===-1||o),autoFocusItem:H,variant:A,...Le,children:a})})});function Wge(t){return gi("MuiMenuItem",t)}const n1=pi("MuiMenuItem",["root","focusVisible","dense","disabled","divider","gutters","selected"]),Xge=(t,e)=>{const{ownerState:r}=t;return[e.root,r.dense&&e.dense,r.divider&&e.divider,!r.disableGutters&&e.gutters]},Yge=t=>{const{disabled:e,dense:r,divider:n,disableGutters:i,selected:a,classes:s}=t,c=mi({root:["root",r&&"dense",e&&"disabled",!i&&"gutters",n&&"divider",a&&"selected"]},Wge,s);return{...s,...c}},Zge=Dr(d_,{shouldForwardProp:t=>Al(t)||t==="classes",name:"MuiMenuItem",slot:"Root",overridesResolver:Xge})(ci(({theme:t})=>({...t.typography.body1,display:"flex",justifyContent:"flex-start",alignItems:"center",position:"relative",textDecoration:"none",minHeight:48,paddingTop:6,paddingBottom:6,boxSizing:"border-box",whiteSpace:"nowrap","&:hover":{textDecoration:"none",backgroundColor:(t.vars||t).palette.action.hover,"@media (hover: none)":{backgroundColor:"transparent"}},[`&.${n1.selected}`]:{backgroundColor:t.alpha((t.vars||t).palette.primary.main,(t.vars||t).palette.action.selectedOpacity),[`&.${n1.focusVisible}`]:{backgroundColor:t.alpha((t.vars||t).palette.primary.main,`${(t.vars||t).palette.action.selectedOpacity} + ${(t.vars||t).palette.action.focusOpacity}`)}},[`&.${n1.selected}:hover`]:{backgroundColor:t.alpha((t.vars||t).palette.primary.main,`${(t.vars||t).palette.action.selectedOpacity} + ${(t.vars||t).palette.action.hoverOpacity}`),"@media (hover: none)":{backgroundColor:t.alpha((t.vars||t).palette.primary.main,(t.vars||t).palette.action.selectedOpacity)}},[`&.${n1.focusVisible}`]:{backgroundColor:(t.vars||t).palette.action.focus},[`&.${n1.disabled}`]:{opacity:(t.vars||t).palette.action.disabledOpacity},[`& + .${tz.root}`]:{marginTop:t.spacing(1),marginBottom:t.spacing(1)},[`& + .${tz.inset}`]:{marginLeft:52},[`& .${o0.root}`]:{marginTop:0,marginBottom:0},[`& .${o0.inset}`]:{paddingLeft:36},[`& .${iz.root}`]:{minWidth:36},variants:[{props:({ownerState:e})=>!e.disableGutters,style:{paddingLeft:16,paddingRight:16}},{props:({ownerState:e})=>e.divider,style:{borderBottom:`1px solid ${(t.vars||t).palette.divider}`,backgroundClip:"padding-box"}},{props:({ownerState:e})=>!e.dense,style:{[t.breakpoints.up("sm")]:{minHeight:"auto"}}},{props:({ownerState:e})=>e.dense,style:{minHeight:32,paddingTop:4,paddingBottom:4,...t.typography.body2,[`& .${iz.root} svg`]:{fontSize:"1.25rem"}}}]}))),Fm=te.forwardRef(function(e,r){const n=bi({props:e,name:"MuiMenuItem"}),{autoFocus:i=!1,component:a="li",dense:s=!1,divider:o=!1,disableGutters:c=!1,focusVisibleClassName:f,role:d="menuitem",tabIndex:m,className:b,...x}=n,E=te.useContext(jf),T=te.useMemo(()=>({dense:s||E.dense||!1,disableGutters:c}),[E.dense,s,c]),A=te.useRef(null);Tu(()=>{i&&A.current&&A.current.focus()},[i]);const M={...n,dense:T.dense,divider:o,disableGutters:c},F=Yge(n),N=Uo(A,r);let O;return n.disabled||(O=m!==void 0?m:-1),J.jsx(jf.Provider,{value:T,children:J.jsx(Zge,{ref:N,role:d,tabIndex:O,component:a,focusVisibleClassName:An(F.focusVisible,f),className:An(F.root,b),...x,ownerState:M,classes:F})})});function Kge(t){return gi("MuiNativeSelect",t)}const pO=pi("MuiNativeSelect",["root","select","multiple","filled","outlined","standard","disabled","icon","iconOpen","iconFilled","iconOutlined","iconStandard","nativeInput","error"]),Jge=t=>{const{classes:e,variant:r,disabled:n,multiple:i,open:a,error:s}=t,o={select:["select",r,n&&"disabled",i&&"multiple",s&&"error"],icon:["icon",`icon${cn(r)}`,a&&"iconOpen",n&&"disabled"]};return mi(o,Kge,e)},wY=Dr("select",{name:"MuiNativeSelect"})(({theme:t})=>({MozAppearance:"none",WebkitAppearance:"none",userSelect:"none",borderRadius:0,cursor:"pointer","&:focus":{borderRadius:0},[`&.${pO.disabled}`]:{cursor:"default"},"&[multiple]":{height:"auto"},"&:not([multiple]) option, &:not([multiple]) optgroup":{backgroundColor:(t.vars||t).palette.background.paper},variants:[{props:({ownerState:e})=>e.variant!=="filled"&&e.variant!=="outlined",style:{"&&&":{paddingRight:24,minWidth:16}}},{props:{variant:"filled"},style:{"&&&":{paddingRight:32}}},{props:{variant:"outlined"},style:{borderRadius:(t.vars||t).shape.borderRadius,"&:focus":{borderRadius:(t.vars||t).shape.borderRadius},"&&&":{paddingRight:32}}}]})),Qge=Dr(wY,{name:"MuiNativeSelect",slot:"Select",shouldForwardProp:Al,overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.select,e[r.variant],r.error&&e.error,{[`&.${pO.multiple}`]:e.multiple}]}})({}),SY=Dr("svg",{name:"MuiNativeSelect"})(({theme:t})=>({position:"absolute",right:0,top:"calc(50% - .5em)",pointerEvents:"none",color:(t.vars||t).palette.action.active,[`&.${pO.disabled}`]:{color:(t.vars||t).palette.action.disabled},variants:[{props:({ownerState:e})=>e.open,style:{transform:"rotate(180deg)"}},{props:{variant:"filled"},style:{right:7}},{props:{variant:"outlined"},style:{right:7}}]})),eme=Dr(SY,{name:"MuiNativeSelect",slot:"Icon",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.icon,r.variant&&e[`icon${cn(r.variant)}`],r.open&&e.iconOpen]}})({}),tme=te.forwardRef(function(e,r){const{className:n,disabled:i,error:a,IconComponent:s,inputRef:o,variant:c="standard",...f}=e,d={...e,disabled:i,variant:c,error:a},m=Jge(d);return J.jsxs(te.Fragment,{children:[J.jsx(Qge,{ownerState:d,className:An(m.select,n),disabled:i,ref:o||r,...f}),e.multiple?null:J.jsx(eme,{as:s,ownerState:d,className:m.icon})]})});function rme(t){const{children:e,defer:r=!1,fallback:n=null}=t,[i,a]=te.useState(!1);return Tu(()=>{r||a(!0)},[r]),te.useEffect(()=>{r&&a(!0)},[r]),i?e:n}var uz;const nme=Dr("fieldset",{name:"MuiNotchedOutlined",shouldForwardProp:Al})({textAlign:"left",position:"absolute",bottom:0,right:0,top:-5,left:0,margin:0,padding:"0 8px",pointerEvents:"none",borderRadius:"inherit",borderStyle:"solid",borderWidth:1,overflow:"hidden",minWidth:"0%"}),ime=Dr("legend",{name:"MuiNotchedOutlined",shouldForwardProp:Al})(ci(({theme:t})=>({float:"unset",width:"auto",overflow:"hidden",variants:[{props:({ownerState:e})=>!e.withLabel,style:{padding:0,lineHeight:"11px",transition:t.transitions.create("width",{duration:150,easing:t.transitions.easing.easeOut})}},{props:({ownerState:e})=>e.withLabel,style:{display:"block",padding:0,height:11,fontSize:"0.75em",visibility:"hidden",maxWidth:.01,transition:t.transitions.create("max-width",{duration:50,easing:t.transitions.easing.easeOut}),whiteSpace:"nowrap","& > span":{paddingLeft:5,paddingRight:5,display:"inline-block",opacity:0,visibility:"visible"}}},{props:({ownerState:e})=>e.withLabel&&e.notched,style:{maxWidth:"100%",transition:t.transitions.create("max-width",{duration:100,easing:t.transitions.easing.easeOut,delay:50})}}]})));function ame(t){const{children:e,classes:r,className:n,label:i,notched:a,...s}=t,o=i!=null&&i!=="",c={...t,notched:a,withLabel:o};return J.jsx(nme,{"aria-hidden":!0,className:n,ownerState:c,...s,children:J.jsx(ime,{ownerState:c,children:o?J.jsx("span",{children:i}):uz||(uz=J.jsx("span",{className:"notranslate","aria-hidden":!0,children:""}))})})}const ome=t=>{const{classes:e}=t,n=mi({root:["root"],notchedOutline:["notchedOutline"],input:["input"]},Jhe,e);return{...e,...n}},sme=Dr(KT,{shouldForwardProp:t=>Al(t)||t==="classes",name:"MuiOutlinedInput",slot:"Root",overridesResolver:YT})(ci(({theme:t})=>{const e=t.palette.mode==="light"?"rgba(0, 0, 0, 0.23)":"rgba(255, 255, 255, 0.23)";return{position:"relative",borderRadius:(t.vars||t).shape.borderRadius,[`&:hover .${td.notchedOutline}`]:{borderColor:(t.vars||t).palette.text.primary},"@media (hover: none)":{[`&:hover .${td.notchedOutline}`]:{borderColor:t.vars?t.alpha(t.vars.palette.common.onBackground,.23):e}},[`&.${td.focused} .${td.notchedOutline}`]:{borderWidth:2},variants:[...Object.entries(t.palette).filter(jl()).map(([r])=>({props:{color:r},style:{[`&.${td.focused} .${td.notchedOutline}`]:{borderColor:(t.vars||t).palette[r].main}}})),{props:{},style:{[`&.${td.error} .${td.notchedOutline}`]:{borderColor:(t.vars||t).palette.error.main},[`&.${td.disabled} .${td.notchedOutline}`]:{borderColor:(t.vars||t).palette.action.disabled}}},{props:({ownerState:r})=>r.startAdornment,style:{paddingLeft:14}},{props:({ownerState:r})=>r.endAdornment,style:{paddingRight:14}},{props:({ownerState:r})=>r.multiline,style:{padding:"16.5px 14px"}},{props:({ownerState:r,size:n})=>r.multiline&&n==="small",style:{padding:"8.5px 14px"}}]}})),lme=Dr(ame,{name:"MuiOutlinedInput",slot:"NotchedOutline"})(ci(({theme:t})=>{const e=t.palette.mode==="light"?"rgba(0, 0, 0, 0.23)":"rgba(255, 255, 255, 0.23)";return{borderColor:t.vars?t.alpha(t.vars.palette.common.onBackground,.23):e}})),ume=Dr(JT,{name:"MuiOutlinedInput",slot:"Input",overridesResolver:ZT})(ci(({theme:t})=>({padding:"16.5px 14px",...!t.vars&&{"&:-webkit-autofill":{WebkitBoxShadow:t.palette.mode==="light"?null:"0 0 0 100px #266798 inset",WebkitTextFillColor:t.palette.mode==="light"?null:"#fff",caretColor:t.palette.mode==="light"?null:"#fff",borderRadius:"inherit"}},...t.vars&&{"&:-webkit-autofill":{borderRadius:"inherit"},[t.getColorSchemeSelector("dark")]:{"&:-webkit-autofill":{WebkitBoxShadow:"0 0 0 100px #266798 inset",WebkitTextFillColor:"#fff",caretColor:"#fff"}}},variants:[{props:{size:"small"},style:{padding:"8.5px 14px"}},{props:({ownerState:e})=>e.multiline,style:{padding:0}},{props:({ownerState:e})=>e.startAdornment,style:{paddingLeft:0}},{props:({ownerState:e})=>e.endAdornment,style:{paddingRight:0}}]}))),QT=te.forwardRef(function(e,r){const n=bi({props:e,name:"MuiOutlinedInput"}),{components:i={},fullWidth:a=!1,inputComponent:s="input",label:o,multiline:c=!1,notched:f,slots:d={},slotProps:m={},type:b="text",...x}=n,E=ome(n),T=Pd(),A=Bg({props:n,muiFormControl:T,states:["color","disabled","error","focused","hiddenLabel","size","required"]}),M={...n,color:A.color||"primary",disabled:A.disabled,error:A.error,focused:A.focused,formControl:T,fullWidth:a,hiddenLabel:A.hiddenLabel,multiline:c,size:A.size,type:b},F=d.root??i.Root??sme,N=d.input??i.Input??ume,[O,U]=Ei("notchedOutline",{elementType:lme,className:E.notchedOutline,shouldForwardComponentProp:!0,ownerState:M,externalForwardedProps:{slots:d,slotProps:m},additionalProps:{label:o!=null&&o!==""&&A.required?J.jsxs(te.Fragment,{children:[o,"","*"]}):o}});return J.jsx(sO,{slots:{root:F,input:N},slotProps:m,renderSuffix:j=>J.jsx(O,{...U,notched:typeof f<"u"?f:!!(j.startAdornment||j.filled||j.focused)}),fullWidth:a,inputComponent:s,multiline:c,ref:r,type:b,...x,classes:{...E,notchedOutline:null}})});QT.muiName="Input";const cme=Ji(J.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8z"})),fme=Ji(J.jsx("path",{d:"M8.465 8.465C9.37 7.56 10.62 7 12 7C14.76 7 17 9.24 17 12C17 13.38 16.44 14.63 15.535 15.535C14.63 16.44 13.38 17 12 17C9.24 17 7 14.76 7 12C7 10.62 7.56 9.37 8.465 8.465Z"})),hme=Dr("span",{name:"MuiRadioButtonIcon",shouldForwardProp:Al})({position:"relative",display:"flex"}),dme=Dr(cme,{name:"MuiRadioButtonIcon"})({transform:"scale(1)"}),pme=Dr(fme,{name:"MuiRadioButtonIcon"})(ci(({theme:t})=>({left:0,position:"absolute",transform:"scale(0)",transition:t.transitions.create("transform",{easing:t.transitions.easing.easeIn,duration:t.transitions.duration.shortest}),variants:[{props:{checked:!0},style:{transform:"scale(1)",transition:t.transitions.create("transform",{easing:t.transitions.easing.easeOut,duration:t.transitions.duration.shortest})}}]})));function EY(t){const{checked:e=!1,classes:r={},fontSize:n}=t,i={...t,checked:e};return J.jsxs(hme,{className:r.root,ownerState:i,children:[J.jsx(dme,{fontSize:n,className:r.background,ownerState:i}),J.jsx(pme,{fontSize:n,className:r.dot,ownerState:i})]})}const TY=te.createContext(void 0);function gme(){return te.useContext(TY)}function mme(t){return gi("MuiRadio",t)}const cz=pi("MuiRadio",["root","checked","disabled","colorPrimary","colorSecondary","sizeSmall"]),yme=t=>{const{classes:e,color:r,size:n}=t,i={root:["root",`color${cn(r)}`,n!=="medium"&&`size${cn(n)}`]};return{...e,...mi(i,mme,e)}},vme=Dr(uY,{shouldForwardProp:t=>Al(t)||t==="classes",name:"MuiRadio",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.root,r.size!=="medium"&&e[`size${cn(r.size)}`],e[`color${cn(r.color)}`]]}})(ci(({theme:t})=>({color:(t.vars||t).palette.text.secondary,[`&.${cz.disabled}`]:{color:(t.vars||t).palette.action.disabled},variants:[{props:{color:"default",disabled:!1,disableRipple:!1},style:{"&:hover":{backgroundColor:t.alpha((t.vars||t).palette.action.active,(t.vars||t).palette.action.hoverOpacity)}}},...Object.entries(t.palette).filter(jl()).map(([e])=>({props:{color:e,disabled:!1,disableRipple:!1},style:{"&:hover":{backgroundColor:t.alpha((t.vars||t).palette[e].main,(t.vars||t).palette.action.hoverOpacity)}}})),...Object.entries(t.palette).filter(jl()).map(([e])=>({props:{color:e,disabled:!1},style:{[`&.${cz.checked}`]:{color:(t.vars||t).palette[e].main}}})),{props:{disableRipple:!1},style:{"&:hover":{"@media (hover: none)":{backgroundColor:"transparent"}}}}]})));function _me(t,e){return typeof e=="object"&&e!==null?t===e:String(t)===String(e)}const bme=J.jsx(EY,{checked:!0}),xme=J.jsx(EY,{}),fz=te.forwardRef(function(e,r){const n=bi({props:e,name:"MuiRadio"}),{checked:i,checkedIcon:a=bme,color:s="primary",icon:o=xme,name:c,onChange:f,size:d="medium",className:m,disabled:b,disableRipple:x=!1,slots:E={},slotProps:T={},inputProps:A,...M}=n,F=Pd();let N=b;F&&typeof N>"u"&&(N=F.disabled),N??=!1;const O={...n,disabled:N,disableRipple:x,color:s,size:d},U=yme(O),j=gme();let H=i;const W=kk(f,j&&j.onChange);let X=c;j&&(typeof H>"u"&&(H=_me(j.value,n.value)),typeof X>"u"&&(X=j.name));const oe=T.input??A,[Q,G]=Ei("root",{ref:r,elementType:vme,className:An(U.root,m),shouldForwardComponentProp:!0,externalForwardedProps:{slots:E,slotProps:T,...M},getSlotProps:ae=>({...ae,onChange:(se,...fe)=>{ae.onChange?.(se,...fe),W(se,...fe)}}),ownerState:O,additionalProps:{type:"radio",icon:te.cloneElement(o,{fontSize:o.props.fontSize??d}),checkedIcon:te.cloneElement(a,{fontSize:a.props.fontSize??d}),disabled:N,name:X,checked:H,slots:E,slotProps:{input:typeof oe=="function"?oe(O):oe}}});return J.jsx(Q,{...G,classes:U})});function wme(t){return gi("MuiRadioGroup",t)}pi("MuiRadioGroup",["root","row","error"]);const Sme=t=>{const{classes:e,row:r,error:n}=t;return mi({root:["root",r&&"row",n&&"error"]},wme,e)},Eme=te.forwardRef(function(e,r){const{actions:n,children:i,className:a,defaultValue:s,name:o,onChange:c,value:f,...d}=e,m=te.useRef(null),b=Sme(e),[x,E]=Ym({controlled:f,default:s,name:"RadioGroup"});te.useImperativeHandle(n,()=>({focus:()=>{let F=m.current.querySelector("input:not(:disabled):checked");F||(F=m.current.querySelector("input:not(:disabled)")),F&&F.focus()}}),[]);const T=Uo(r,m),A=Og(o),M=te.useMemo(()=>({name:A,onChange(F){E(F.target.value),c&&c(F,F.target.value)},value:x}),[A,c,E,x]);return J.jsx(TY.Provider,{value:M,children:J.jsx(pY,{role:"radiogroup",ref:T,className:An(b.root,a),...d,children:i})})}),Tme={border:0,clip:"rect(0 0 0 0)",height:"1px",margin:"-1px",overflow:"hidden",padding:0,position:"absolute",whiteSpace:"nowrap",width:"1px"};function CY(t){return gi("MuiSelect",t)}const i1=pi("MuiSelect",["root","select","multiple","filled","outlined","standard","disabled","focused","icon","iconOpen","iconFilled","iconOutlined","iconStandard","nativeInput","error"]);var hz;const Cme=Dr(wY,{name:"MuiSelect",slot:"Select",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[{[`&.${i1.select}`]:e.select},{[`&.${i1.select}`]:e[r.variant]},{[`&.${i1.error}`]:e.error},{[`&.${i1.multiple}`]:e.multiple}]}})({[`&.${i1.select}`]:{height:"auto",minHeight:"1.4375em",textOverflow:"ellipsis",whiteSpace:"nowrap",overflow:"hidden"}}),Ame=Dr(SY,{name:"MuiSelect",slot:"Icon",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.icon,r.variant&&e[`icon${cn(r.variant)}`],r.open&&e.iconOpen]}})({}),Ime=Dr("input",{shouldForwardProp:t=>qT(t)&&t!=="classes",name:"MuiSelect",slot:"NativeInput"})({bottom:0,left:0,position:"absolute",opacity:0,pointerEvents:"none",width:"100%",boxSizing:"border-box"});function dz(t,e){return typeof e=="object"&&e!==null?t===e:String(t)===String(e)}function Pme(t){return t==null||typeof t=="string"&&!t.trim()}const kme=t=>{const{classes:e,variant:r,disabled:n,multiple:i,open:a,error:s}=t,o={select:["select",r,n&&"disabled",i&&"multiple",s&&"error"],icon:["icon",`icon${cn(r)}`,a&&"iconOpen",n&&"disabled"],nativeInput:["nativeInput"]};return mi(o,CY,e)},Rme=te.forwardRef(function(e,r){const{"aria-describedby":n,"aria-label":i,autoFocus:a,autoWidth:s,children:o,className:c,defaultOpen:f,defaultValue:d,disabled:m,displayEmpty:b,error:x=!1,IconComponent:E,inputRef:T,labelId:A,MenuProps:M={},multiple:F,name:N,onBlur:O,onChange:U,onClose:j,onFocus:H,onOpen:W,open:X,readOnly:oe,renderValue:Q,required:G,SelectDisplayProps:ae={},tabIndex:se,type:fe,value:_e,variant:Le="standard",...ye}=e,[Te,Ie]=Ym({controlled:_e,default:d,name:"Select"}),[Me,de]=Ym({controlled:X,default:f,name:"Select"}),Se=te.useRef(null),we=te.useRef(null),[De,Fe]=te.useState(null),{current:Xe}=te.useRef(X!=null),[Be,st]=te.useState(),Qe=Uo(r,T),it=te.useCallback(ct=>{we.current=ct,ct&&Fe(ct)},[]),be=De?.parentNode;te.useImperativeHandle(Qe,()=>({focus:()=>{we.current.focus()},node:Se.current,value:Te}),[Te]),te.useEffect(()=>{f&&Me&&De&&!Xe&&(st(s?null:be.clientWidth),we.current.focus())},[De,s]),te.useEffect(()=>{a&&we.current.focus()},[a]),te.useEffect(()=>{if(!A)return;const ct=cs(we.current).getElementById(A);if(ct){const Qt=()=>{getSelection().isCollapsed&&we.current.focus()};return ct.addEventListener("click",Qt),()=>{ct.removeEventListener("click",Qt)}}},[A]);const Ot=(ct,Qt)=>{ct?W&&W(Qt):j&&j(Qt),Xe||(st(s?null:be.clientWidth),de(ct))},at=ct=>{ct.button===0&&(ct.preventDefault(),we.current.focus(),Ot(!0,ct))},$e=ct=>{Ot(!1,ct)},Xt=te.Children.toArray(o),$t=ct=>{const Qt=Xt.find(Ht=>Ht.props.value===ct.target.value);Qt!==void 0&&(Ie(Qt.props.value),U&&U(ct,Qt))},cr=ct=>Qt=>{let Ht;if(Qt.currentTarget.hasAttribute("tabindex")){if(F){Ht=Array.isArray(Te)?Te.slice():[];const Ir=Te.indexOf(ct.props.value);Ir===-1?Ht.push(ct.props.value):Ht.splice(Ir,1)}else Ht=ct.props.value;if(ct.props.onClick&&ct.props.onClick(Qt),Te!==Ht&&(Ie(Ht),U)){const Ir=Qt.nativeEvent||Qt,Ar=new Ir.constructor(Ir.type,Ir);Object.defineProperty(Ar,"target",{writable:!0,value:{value:Ht,name:N}}),U(Ar,ct)}F||Ot(!1,Qt)}},_t=ct=>{oe||[" ","ArrowUp","ArrowDown","Enter"].includes(ct.key)&&(ct.preventDefault(),Ot(!0,ct))},gr=De!==null&&Me,mr=ct=>{!gr&&O&&(Object.defineProperty(ct,"target",{writable:!0,value:{value:Te,name:N}}),O(ct))};delete ye["aria-invalid"];let ar,Cr;const Er=[];let Jt=!1;(YS({value:Te})||b)&&(Q?ar=Q(Te):Jt=!0);const ot=Xt.map(ct=>{if(!te.isValidElement(ct))return null;let Qt;if(F){if(!Array.isArray(Te))throw new Error(_p(2));Qt=Te.some(Ht=>dz(Ht,ct.props.value)),Qt&&Jt&&Er.push(ct.props.children)}else Qt=dz(Te,ct.props.value),Qt&&Jt&&(Cr=ct.props.children);return te.cloneElement(ct,{"aria-selected":Qt?"true":"false",onClick:cr(ct),onKeyUp:Ht=>{Ht.key===" "&&Ht.preventDefault(),ct.props.onKeyUp&&ct.props.onKeyUp(Ht)},role:"option",selected:Qt,value:void 0,"data-value":ct.props.value})});Jt&&(F?Er.length===0?ar=null:ar=Er.reduce((ct,Qt,Ht)=>(ct.push(Qt),Ht<Er.length-1&&ct.push(", "),ct),[]):ar=Cr);let Ce=Be;!s&&Xe&&De&&(Ce=be.clientWidth);let xe;typeof se<"u"?xe=se:xe=m?null:0;const je=ae.id||(N?`mui-component-select-${N}`:void 0),qe={...e,variant:Le,value:Te,open:gr,error:x},Ge=kme(qe),Ft={...M.PaperProps,...typeof M.slotProps?.paper=="function"?M.slotProps.paper(qe):M.slotProps?.paper},Et={...M.MenuListProps,...typeof M.slotProps?.list=="function"?M.slotProps.list(qe):M.slotProps?.list},mt=Og();return J.jsxs(te.Fragment,{children:[J.jsx(Cme,{as:"div",ref:it,tabIndex:xe,role:"combobox","aria-controls":gr?mt:void 0,"aria-disabled":m?"true":void 0,"aria-expanded":gr?"true":"false","aria-haspopup":"listbox","aria-label":i,"aria-labelledby":[A,je].filter(Boolean).join(" ")||void 0,"aria-describedby":n,"aria-required":G?"true":void 0,"aria-invalid":x?"true":void 0,onKeyDown:_t,onMouseDown:m||oe?null:at,onBlur:mr,onFocus:H,...ae,ownerState:qe,className:An(ae.className,Ge.select,c),id:je,children:Pme(ar)?hz||(hz=J.jsx("span",{className:"notranslate","aria-hidden":!0,children:""})):ar}),J.jsx(Ime,{"aria-invalid":x,value:Array.isArray(Te)?Te.join(","):Te,name:N,ref:Se,"aria-hidden":!0,onChange:$t,tabIndex:-1,disabled:m,className:Ge.nativeInput,autoFocus:a,required:G,...ye,ownerState:qe}),J.jsx(Ame,{as:E,className:Ge.icon,ownerState:qe}),J.jsx(xY,{id:`menu-${N||""}`,anchorEl:be,open:gr,onClose:$e,anchorOrigin:{vertical:"bottom",horizontal:"center"},transformOrigin:{vertical:"top",horizontal:"center"},...M,slotProps:{...M.slotProps,list:{"aria-labelledby":A,role:"listbox","aria-multiselectable":F?"true":void 0,disableListWrap:!0,id:mt,...Et},paper:{...Ft,style:{minWidth:Ce,...Ft!=null?Ft.style:null}}},children:ot})]})}),Mme=t=>{const{classes:e}=t,n=mi({root:["root"]},CY,e);return{...e,...n}},gO={name:"MuiSelect",slot:"Root",shouldForwardProp:t=>Al(t)&&t!=="variant"},Dme=Dr(dO,gO)(""),Ome=Dr(QT,gO)(""),Nme=Dr(hO,gO)(""),bg=te.forwardRef(function(e,r){const n=bi({name:"MuiSelect",props:e}),{autoWidth:i=!1,children:a,classes:s={},className:o,defaultOpen:c=!1,displayEmpty:f=!1,IconComponent:d=ede,id:m,input:b,inputProps:x,label:E,labelId:T,MenuProps:A,multiple:M=!1,native:F=!1,onClose:N,onOpen:O,open:U,renderValue:j,SelectDisplayProps:H,variant:W="outlined",...X}=n,oe=F?tme:Rme,Q=Pd(),G=Bg({props:n,muiFormControl:Q,states:["variant","error"]}),ae=G.variant||W,se={...n,variant:ae,classes:s},fe=Mme(se),{root:_e,...Le}=fe,ye=b||{standard:J.jsx(Dme,{ownerState:se}),outlined:J.jsx(Ome,{label:E,ownerState:se}),filled:J.jsx(Nme,{ownerState:se})}[ae],Te=Uo(r,Fg(ye));return J.jsx(te.Fragment,{children:te.cloneElement(ye,{inputComponent:oe,inputProps:{children:a,error:G.error,IconComponent:d,variant:ae,type:void 0,multiple:M,...F?{id:m}:{autoWidth:i,defaultOpen:c,displayEmpty:f,labelId:T,MenuProps:A,onClose:N,onOpen:O,open:U,renderValue:j,SelectDisplayProps:{id:m,...H}},...x,classes:x?Qu(Le,x.classes):Le,...b?b.props.inputProps:{}},...(M&&F||f)&&ae==="outlined"?{notched:!0}:{},ref:Te,className:An(ye.props.className,o,fe.root),...!b&&{variant:ae},...X})})});bg.muiName="Select";function Lme(t,e,r=(n,i)=>n===i){return t.length===e.length&&t.every((n,i)=>r(n,e[i]))}const Fme=2;function pv(t,e,r,n,i){return r===1?Math.min(t+e,i):Math.max(t-e,n)}function AY(t,e){return t-e}function pz(t,e){const{index:r}=t.reduce((n,i,a)=>{const s=Math.abs(e-i);return n===null||s<n.distance||s===n.distance?{distance:s,index:a}:n},null)??{};return r}function W2(t,e){if(e.current!==void 0&&t.changedTouches){const r=t;for(let n=0;n<r.changedTouches.length;n+=1){const i=r.changedTouches[n];if(i.identifier===e.current)return{x:i.clientX,y:i.clientY}}return!1}return{x:t.clientX,y:t.clientY}}function ZS(t,e,r){return(t-e)*100/(r-e)}function Bme(t,e,r){return(r-e)*t+e}function zme(t){if(Math.abs(t)<1){const r=t.toExponential().split("e-"),n=r[0].split(".")[1];return(n?n.length:0)+parseInt(r[1],10)}const e=t.toString().split(".")[1];return e?e.length:0}function jme(t,e,r){const n=Math.round((t-r)/e)*e+r;return Number(n.toFixed(zme(e)))}function gz({values:t,newValue:e,index:r}){const n=t.slice();return n[r]=e,n.sort(AY)}function X2({sliderRef:t,activeIndex:e,setActive:r}){const n=cs(t.current);(!t.current?.contains(n.activeElement)||Number(n?.activeElement?.getAttribute("data-index"))!==e)&&t.current?.querySelector(`[type="range"][data-index="${e}"]`).focus(),r&&r(e)}function Y2(t,e){return typeof t=="number"&&typeof e=="number"?t===e:typeof t=="object"&&typeof e=="object"?Lme(t,e):!1}const Ume={horizontal:{offset:t=>({left:`${t}%`}),leap:t=>({width:`${t}%`})},"horizontal-reverse":{offset:t=>({right:`${t}%`}),leap:t=>({width:`${t}%`})},vertical:{offset:t=>({bottom:`${t}%`}),leap:t=>({height:`${t}%`})}},Vme=t=>t;let Z2;function mz(){return Z2===void 0&&(typeof CSS<"u"&&typeof CSS.supports=="function"?Z2=CSS.supports("touch-action","none"):Z2=!0),Z2}function $me(t){const{"aria-labelledby":e,defaultValue:r,disabled:n=!1,disableSwap:i=!1,isRtl:a=!1,marks:s=!1,max:o=100,min:c=0,name:f,onChange:d,onChangeCommitted:m,orientation:b="horizontal",rootRef:x,scale:E=Vme,step:T=1,shiftStep:A=10,tabIndex:M,value:F}=t,N=te.useRef(void 0),[O,U]=te.useState(-1),[j,H]=te.useState(-1),[W,X]=te.useState(!1),oe=te.useRef(0),Q=te.useRef(null),[G,ae]=Ym({controlled:F,default:r??c,name:"Slider"}),se=d&&((Jt,ot,Ce)=>{const xe=Jt.nativeEvent||Jt,je=new xe.constructor(xe.type,xe);Object.defineProperty(je,"target",{writable:!0,value:{value:ot,name:f}}),Q.current=ot,d(je,ot,Ce)}),fe=Array.isArray(G);let _e=fe?G.slice().sort(AY):[G];_e=_e.map(Jt=>Jt==null?c:Nv(Jt,c,o));const Le=s===!0&&T!==null?[...Array(Math.floor((o-c)/T)+1)].map((Jt,ot)=>({value:c+T*ot})):s||[],ye=Le.map(Jt=>Jt.value),[Te,Ie]=te.useState(-1),Me=te.useRef(null),de=Uo(x,Me),Se=Jt=>ot=>{const Ce=Number(ot.currentTarget.getAttribute("data-index"));F0(ot.target)&&Ie(Ce),H(Ce),Jt?.onFocus?.(ot)},we=Jt=>ot=>{F0(ot.target)||Ie(-1),H(-1),Jt?.onBlur?.(ot)},De=(Jt,ot)=>{const Ce=Number(Jt.currentTarget.getAttribute("data-index")),xe=_e[Ce],je=ye.indexOf(xe);let qe=ot;if(Le&&T==null){const Ge=ye[ye.length-1];qe>=Ge?qe=Ge:qe<=ye[0]?qe=ye[0]:qe=qe<xe?ye[je-1]:ye[je+1]}if(qe=Nv(qe,c,o),fe){i&&(qe=Nv(qe,_e[Ce-1]||-1/0,_e[Ce+1]||1/0));const Ge=qe;qe=gz({values:_e,newValue:qe,index:Ce});let Ft=Ce;i||(Ft=qe.indexOf(Ge)),X2({sliderRef:Me,activeIndex:Ft})}ae(qe),Ie(Ce),se&&!Y2(qe,G)&&se(Jt,qe,Ce),m&&m(Jt,Q.current??qe)},Fe=Jt=>ot=>{if(["ArrowUp","ArrowDown","ArrowLeft","ArrowRight","PageUp","PageDown","Home","End"].includes(ot.key)){ot.preventDefault();const Ce=Number(ot.currentTarget.getAttribute("data-index")),xe=_e[Ce];let je=null;if(T!=null){const qe=ot.shiftKey?A:T;switch(ot.key){case"ArrowUp":je=pv(xe,qe,1,c,o);break;case"ArrowRight":je=pv(xe,qe,a?-1:1,c,o);break;case"ArrowDown":je=pv(xe,qe,-1,c,o);break;case"ArrowLeft":je=pv(xe,qe,a?1:-1,c,o);break;case"PageUp":je=pv(xe,A,1,c,o);break;case"PageDown":je=pv(xe,A,-1,c,o);break;case"Home":je=c;break;case"End":je=o;break}}else if(Le){const qe=ye[ye.length-1],Ge=ye.indexOf(xe),Ft=[a?"ArrowRight":"ArrowLeft","ArrowDown","PageDown","Home"],Et=[a?"ArrowLeft":"ArrowRight","ArrowUp","PageUp","End"];Ft.includes(ot.key)?Ge===0?je=ye[0]:je=ye[Ge-1]:Et.includes(ot.key)&&(Ge===ye.length-1?je=qe:je=ye[Ge+1])}je!=null&&De(ot,je)}Jt?.onKeyDown?.(ot)};Tu(()=>{n&&Me.current.contains(document.activeElement)&&document.activeElement?.blur()},[n]),n&&O!==-1&&U(-1),n&&Te!==-1&&Ie(-1);const Xe=Jt=>ot=>{Jt.onChange?.(ot),De(ot,ot.target.valueAsNumber)},Be=te.useRef(void 0);let st=b;a&&b==="horizontal"&&(st+="-reverse");const Qe=({finger:Jt,move:ot=!1})=>{const{current:Ce}=Me,{width:xe,height:je,bottom:qe,left:Ge}=Ce.getBoundingClientRect();let Ft;st.startsWith("vertical")?Ft=(qe-Jt.y)/je:Ft=(Jt.x-Ge)/xe,st.includes("-reverse")&&(Ft=1-Ft);let Et;if(Et=Bme(Ft,c,o),T)Et=jme(Et,T,c);else{const ct=pz(ye,Et);Et=ye[ct]}Et=Nv(Et,c,o);let mt=0;if(fe){ot?mt=Be.current:mt=pz(_e,Et),i&&(Et=Nv(Et,_e[mt-1]||-1/0,_e[mt+1]||1/0));const ct=Et;Et=gz({values:_e,newValue:Et,index:mt}),i&&ot||(mt=Et.indexOf(ct),Be.current=mt)}return{newValue:Et,activeIndex:mt}},it=ou(Jt=>{const ot=W2(Jt,N);if(!ot)return;if(oe.current+=1,Jt.type==="mousemove"&&Jt.buttons===0){be(Jt);return}const{newValue:Ce,activeIndex:xe}=Qe({finger:ot,move:!0});X2({sliderRef:Me,activeIndex:xe,setActive:U}),ae(Ce),!W&&oe.current>Fme&&X(!0),se&&!Y2(Ce,G)&&se(Jt,Ce,xe)}),be=ou(Jt=>{const ot=W2(Jt,N);if(X(!1),!ot)return;const{newValue:Ce}=Qe({finger:ot,move:!0});U(-1),Jt.type==="touchend"&&H(-1),m&&m(Jt,Q.current??Ce),N.current=void 0,at()}),Ot=ou(Jt=>{if(n)return;mz()||Jt.preventDefault();const ot=Jt.changedTouches[0];ot!=null&&(N.current=ot.identifier);const Ce=W2(Jt,N);if(Ce!==!1){const{newValue:je,activeIndex:qe}=Qe({finger:Ce});X2({sliderRef:Me,activeIndex:qe,setActive:U}),ae(je),se&&!Y2(je,G)&&se(Jt,je,qe)}oe.current=0;const xe=cs(Me.current);xe.addEventListener("touchmove",it,{passive:!0}),xe.addEventListener("touchend",be,{passive:!0})}),at=te.useCallback(()=>{const Jt=cs(Me.current);Jt.removeEventListener("mousemove",it),Jt.removeEventListener("mouseup",be),Jt.removeEventListener("touchmove",it),Jt.removeEventListener("touchend",be)},[be,it]);te.useEffect(()=>{const{current:Jt}=Me;return Jt.addEventListener("touchstart",Ot,{passive:mz()}),()=>{Jt.removeEventListener("touchstart",Ot),at()}},[at,Ot]),te.useEffect(()=>{n&&at()},[n,at]);const $e=Jt=>ot=>{if(Jt.onMouseDown?.(ot),n||ot.defaultPrevented||ot.button!==0)return;ot.preventDefault();const Ce=W2(ot,N);if(Ce!==!1){const{newValue:je,activeIndex:qe}=Qe({finger:Ce});X2({sliderRef:Me,activeIndex:qe,setActive:U}),ae(je),se&&!Y2(je,G)&&se(ot,je,qe)}oe.current=0;const xe=cs(Me.current);xe.addEventListener("mousemove",it,{passive:!0}),xe.addEventListener("mouseup",be)},Xt=ZS(fe?_e[0]:c,c,o),$t=ZS(_e[_e.length-1],c,o)-Xt,cr=(Jt={})=>{const ot=Nm(Jt),Ce={onMouseDown:$e(ot||{})},xe={...ot,...Ce};return{...Jt,ref:de,...xe}},_t=Jt=>ot=>{Jt.onMouseOver?.(ot);const Ce=Number(ot.currentTarget.getAttribute("data-index"));H(Ce)},gr=Jt=>ot=>{Jt.onMouseLeave?.(ot),H(-1)},mr=(Jt={})=>{const ot=Nm(Jt),Ce={onMouseOver:_t(ot||{}),onMouseLeave:gr(ot||{})};return{...Jt,...ot,...Ce}},ar=Jt=>({pointerEvents:O!==-1&&O!==Jt?"none":void 0});let Cr;return b==="vertical"&&(Cr=a?"vertical-rl":"vertical-lr"),{active:O,axis:st,axisProps:Ume,dragging:W,focusedThumbIndex:Te,getHiddenInputProps:(Jt={})=>{const ot=Nm(Jt),Ce={onChange:Xe(ot||{}),onFocus:Se(ot||{}),onBlur:we(ot||{}),onKeyDown:Fe(ot||{})},xe={...ot,...Ce};return{tabIndex:M,"aria-labelledby":e,"aria-orientation":b,"aria-valuemax":E(o),"aria-valuemin":E(c),name:f,type:"range",min:t.min,max:t.max,step:t.step===null&&t.marks?"any":t.step??void 0,disabled:n,...Jt,...xe,style:{...Tme,direction:a?"rtl":"ltr",width:"100%",height:"100%",writingMode:Cr}}},getRootProps:cr,getThumbProps:mr,marks:Le,open:j,range:fe,rootRef:de,trackLeap:$t,trackOffset:Xt,values:_e,getThumbStyle:ar}}const qme=t=>!t||!vd(t);function Hme(t){return gi("MuiSlider",t)}const Ff=pi("MuiSlider",["root","active","colorPrimary","colorSecondary","colorError","colorInfo","colorSuccess","colorWarning","disabled","dragging","focusVisible","mark","markActive","marked","markLabel","markLabelActive","rail","sizeSmall","thumb","thumbColorPrimary","thumbColorSecondary","thumbColorError","thumbColorSuccess","thumbColorInfo","thumbColorWarning","track","trackInverted","trackFalse","thumbSizeSmall","valueLabel","valueLabelOpen","valueLabelCircle","valueLabelLabel","vertical"]),Gme=t=>{const{open:e}=t;return{offset:An(e&&Ff.valueLabelOpen),circle:Ff.valueLabelCircle,label:Ff.valueLabelLabel}};function Wme(t){const{children:e,className:r,value:n}=t,i=Gme(t);return e?te.cloneElement(e,{className:e.props.className},J.jsxs(te.Fragment,{children:[e.props.children,J.jsx("span",{className:An(i.offset,r),"aria-hidden":!0,children:J.jsx("span",{className:i.circle,children:J.jsx("span",{className:i.label,children:n})})})]})):null}function yz(t){return t}const Xme=Dr("span",{name:"MuiSlider",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.root,e[`color${cn(r.color)}`],r.size!=="medium"&&e[`size${cn(r.size)}`],r.marked&&e.marked,r.orientation==="vertical"&&e.vertical,r.track==="inverted"&&e.trackInverted,r.track===!1&&e.trackFalse]}})(ci(({theme:t})=>({borderRadius:12,boxSizing:"content-box",display:"inline-block",position:"relative",cursor:"pointer",touchAction:"none",WebkitTapHighlightColor:"transparent","@media print":{colorAdjust:"exact"},[`&.${Ff.disabled}`]:{pointerEvents:"none",cursor:"default",color:(t.vars||t).palette.grey[400]},[`&.${Ff.dragging}`]:{[`& .${Ff.thumb}, & .${Ff.track}`]:{transition:"none"}},variants:[...Object.entries(t.palette).filter(jl()).map(([e])=>({props:{color:e},style:{color:(t.vars||t).palette[e].main}})),{props:{orientation:"horizontal"},style:{height:4,width:"100%",padding:"13px 0","@media (pointer: coarse)":{padding:"20px 0"}}},{props:{orientation:"horizontal",size:"small"},style:{height:2}},{props:{orientation:"horizontal",marked:!0},style:{marginBottom:20}},{props:{orientation:"vertical"},style:{height:"100%",width:4,padding:"0 13px","@media (pointer: coarse)":{padding:"0 20px"}}},{props:{orientation:"vertical",size:"small"},style:{width:2}},{props:{orientation:"vertical",marked:!0},style:{marginRight:44}}]}))),Yme=Dr("span",{name:"MuiSlider",slot:"Rail"})({display:"block",position:"absolute",borderRadius:"inherit",backgroundColor:"currentColor",opacity:.38,variants:[{props:{orientation:"horizontal"},style:{width:"100%",height:"inherit",top:"50%",transform:"translateY(-50%)"}},{props:{orientation:"vertical"},style:{height:"100%",width:"inherit",left:"50%",transform:"translateX(-50%)"}},{props:{track:"inverted"},style:{opacity:1}}]}),Zme=Dr("span",{name:"MuiSlider",slot:"Track"})(ci(({theme:t})=>({display:"block",position:"absolute",borderRadius:"inherit",border:"1px solid currentColor",backgroundColor:"currentColor",transition:t.transitions.create(["left","width","bottom","height"],{duration:t.transitions.duration.shortest}),variants:[{props:{size:"small"},style:{border:"none"}},{props:{orientation:"horizontal"},style:{height:"inherit",top:"50%",transform:"translateY(-50%)"}},{props:{orientation:"vertical"},style:{width:"inherit",left:"50%",transform:"translateX(-50%)"}},{props:{track:!1},style:{display:"none"}},...Object.entries(t.palette).filter(jl()).map(([e])=>({props:{color:e,track:"inverted"},style:{...t.vars?{backgroundColor:t.vars.palette.Slider[`${e}Track`],borderColor:t.vars.palette.Slider[`${e}Track`]}:{backgroundColor:t.lighten(t.palette[e].main,.62),borderColor:t.lighten(t.palette[e].main,.62),...t.applyStyles("dark",{backgroundColor:t.darken(t.palette[e].main,.5)}),...t.applyStyles("dark",{borderColor:t.darken(t.palette[e].main,.5)})}}}))]}))),Kme=Dr("span",{name:"MuiSlider",slot:"Thumb",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.thumb,e[`thumbColor${cn(r.color)}`],r.size!=="medium"&&e[`thumbSize${cn(r.size)}`]]}})(ci(({theme:t})=>({position:"absolute",width:20,height:20,boxSizing:"border-box",borderRadius:"50%",outline:0,backgroundColor:"currentColor",display:"flex",alignItems:"center",justifyContent:"center",transition:t.transitions.create(["box-shadow","left","bottom"],{duration:t.transitions.duration.shortest}),"&::before":{position:"absolute",content:'""',borderRadius:"inherit",width:"100%",height:"100%",boxShadow:(t.vars||t).shadows[2]},"&::after":{position:"absolute",content:'""',borderRadius:"50%",width:42,height:42,top:"50%",left:"50%",transform:"translate(-50%, -50%)"},[`&.${Ff.disabled}`]:{"&:hover":{boxShadow:"none"}},variants:[{props:{size:"small"},style:{width:12,height:12,"&::before":{boxShadow:"none"}}},{props:{orientation:"horizontal"},style:{top:"50%",transform:"translate(-50%, -50%)"}},{props:{orientation:"vertical"},style:{left:"50%",transform:"translate(-50%, 50%)"}},...Object.entries(t.palette).filter(jl()).map(([e])=>({props:{color:e},style:{[`&:hover, &.${Ff.focusVisible}`]:{boxShadow:`0px 0px 0px 8px ${t.alpha((t.vars||t).palette[e].main,.16)}`,"@media (hover: none)":{boxShadow:"none"}},[`&.${Ff.active}`]:{boxShadow:`0px 0px 0px 14px ${t.alpha((t.vars||t).palette[e].main,.16)}`}}}))]}))),Jme=Dr(Wme,{name:"MuiSlider",slot:"ValueLabel"})(ci(({theme:t})=>({zIndex:1,whiteSpace:"nowrap",...t.typography.body2,fontWeight:500,transition:t.transitions.create(["transform"],{duration:t.transitions.duration.shortest}),position:"absolute",backgroundColor:(t.vars||t).palette.grey[600],borderRadius:2,color:(t.vars||t).palette.common.white,display:"flex",alignItems:"center",justifyContent:"center",padding:"0.25rem 0.75rem",variants:[{props:{orientation:"horizontal"},style:{transform:"translateY(-100%) scale(0)",top:"-10px",transformOrigin:"bottom center","&::before":{position:"absolute",content:'""',width:8,height:8,transform:"translate(-50%, 50%) rotate(45deg)",backgroundColor:"inherit",bottom:0,left:"50%"},[`&.${Ff.valueLabelOpen}`]:{transform:"translateY(-100%) scale(1)"}}},{props:{orientation:"vertical"},style:{transform:"translateY(-50%) scale(0)",right:"30px",top:"50%",transformOrigin:"right center","&::before":{position:"absolute",content:'""',width:8,height:8,transform:"translate(-50%, -50%) rotate(45deg)",backgroundColor:"inherit",right:-8,top:"50%"},[`&.${Ff.valueLabelOpen}`]:{transform:"translateY(-50%) scale(1)"}}},{props:{size:"small"},style:{fontSize:t.typography.pxToRem(12),padding:"0.25rem 0.5rem"}},{props:{orientation:"vertical",size:"small"},style:{right:"20px"}}]}))),Qme=Dr("span",{name:"MuiSlider",slot:"Mark",shouldForwardProp:t=>qT(t)&&t!=="markActive",overridesResolver:(t,e)=>{const{markActive:r}=t;return[e.mark,r&&e.markActive]}})(ci(({theme:t})=>({position:"absolute",width:2,height:2,borderRadius:1,backgroundColor:"currentColor",variants:[{props:{orientation:"horizontal"},style:{top:"50%",transform:"translate(-1px, -50%)"}},{props:{orientation:"vertical"},style:{left:"50%",transform:"translate(-50%, 1px)"}},{props:{markActive:!0},style:{backgroundColor:(t.vars||t).palette.background.paper,opacity:.8}}]}))),eye=Dr("span",{name:"MuiSlider",slot:"MarkLabel",shouldForwardProp:t=>qT(t)&&t!=="markLabelActive"})(ci(({theme:t})=>({...t.typography.body2,color:(t.vars||t).palette.text.secondary,position:"absolute",whiteSpace:"nowrap",variants:[{props:{orientation:"horizontal"},style:{top:30,transform:"translateX(-50%)","@media (pointer: coarse)":{top:40}}},{props:{orientation:"vertical"},style:{left:36,transform:"translateY(50%)","@media (pointer: coarse)":{left:44}}},{props:{markLabelActive:!0},style:{color:(t.vars||t).palette.text.primary}}]}))),tye=t=>{const{disabled:e,dragging:r,marked:n,orientation:i,track:a,classes:s,color:o,size:c}=t,f={root:["root",e&&"disabled",r&&"dragging",n&&"marked",i==="vertical"&&"vertical",a==="inverted"&&"trackInverted",a===!1&&"trackFalse",o&&`color${cn(o)}`,c&&`size${cn(c)}`],rail:["rail"],track:["track"],mark:["mark"],markActive:["markActive"],markLabel:["markLabel"],markLabelActive:["markLabelActive"],valueLabel:["valueLabel"],thumb:["thumb",e&&"disabled",c&&`thumbSize${cn(c)}`,o&&`thumbColor${cn(o)}`],active:["active"],disabled:["disabled"],focusVisible:["focusVisible"]};return mi(f,Hme,s)},rye=({children:t})=>t,mO=te.forwardRef(function(e,r){const n=bi({props:e,name:"MuiSlider"}),i=Rx(),{"aria-label":a,"aria-valuetext":s,"aria-labelledby":o,component:c="span",components:f={},componentsProps:d={},color:m="primary",classes:b,className:x,disableSwap:E=!1,disabled:T=!1,getAriaLabel:A,getAriaValueText:M,marks:F=!1,max:N=100,min:O=0,name:U,onChange:j,onChangeCommitted:H,orientation:W="horizontal",shiftStep:X=10,size:oe="medium",step:Q=1,scale:G=yz,slotProps:ae,slots:se,tabIndex:fe,track:_e="normal",value:Le,valueLabelDisplay:ye="off",valueLabelFormat:Te=yz,...Ie}=n,Me={...n,isRtl:i,max:N,min:O,classes:b,disabled:T,disableSwap:E,orientation:W,marks:F,color:m,size:oe,step:Q,shiftStep:X,scale:G,track:_e,valueLabelDisplay:ye,valueLabelFormat:Te},{axisProps:de,getRootProps:Se,getHiddenInputProps:we,getThumbProps:De,open:Fe,active:Xe,axis:Be,focusedThumbIndex:st,range:Qe,dragging:it,marks:be,values:Ot,trackOffset:at,trackLeap:$e,getThumbStyle:Xt}=$me({...Me,rootRef:r});Me.marked=be.length>0&&be.some(zr=>zr.label),Me.dragging=it,Me.focusedThumbIndex=st;const $t=tye(Me),cr=se?.root??f.Root??Xme,_t=se?.rail??f.Rail??Yme,gr=se?.track??f.Track??Zme,mr=se?.thumb??f.Thumb??Kme,ar=se?.valueLabel??f.ValueLabel??Jme,Cr=se?.mark??f.Mark??Qme,Er=se?.markLabel??f.MarkLabel??eye,Jt=se?.input??f.Input??"input",ot=ae?.root??d.root,Ce=ae?.rail??d.rail,xe=ae?.track??d.track,je=ae?.thumb??d.thumb,qe=ae?.valueLabel??d.valueLabel,Ge=ae?.mark??d.mark,Ft=ae?.markLabel??d.markLabel,Et=ae?.input??d.input,mt=od({elementType:cr,getSlotProps:Se,externalSlotProps:ot,externalForwardedProps:Ie,additionalProps:{...qme(cr)&&{as:c}},ownerState:{...Me,...ot?.ownerState},className:[$t.root,x]}),ct=od({elementType:_t,externalSlotProps:Ce,ownerState:Me,className:$t.rail}),Qt=od({elementType:gr,externalSlotProps:xe,additionalProps:{style:{...de[Be].offset(at),...de[Be].leap($e)}},ownerState:{...Me,...xe?.ownerState},className:$t.track}),Ht=od({elementType:mr,getSlotProps:De,externalSlotProps:je,ownerState:{...Me,...je?.ownerState},className:$t.thumb}),Ir=od({elementType:ar,externalSlotProps:qe,ownerState:{...Me,...qe?.ownerState},className:$t.valueLabel}),Ar=od({elementType:Cr,externalSlotProps:Ge,ownerState:Me,className:$t.mark}),$r=od({elementType:Er,externalSlotProps:Ft,ownerState:Me,className:$t.markLabel}),fn=od({elementType:Jt,getSlotProps:we,externalSlotProps:Et,ownerState:Me});return J.jsxs(cr,{...mt,children:[J.jsx(_t,{...ct}),J.jsx(gr,{...Qt}),be.filter(zr=>zr.value>=O&&zr.value<=N).map((zr,Mt)=>{const en=ZS(zr.value,O,N),jn=de[Be].offset(en);let Qr;return _e===!1?Qr=Ot.includes(zr.value):Qr=_e==="normal"&&(Qe?zr.value>=Ot[0]&&zr.value<=Ot[Ot.length-1]:zr.value<=Ot[0])||_e==="inverted"&&(Qe?zr.value<=Ot[0]||zr.value>=Ot[Ot.length-1]:zr.value>=Ot[0]),J.jsxs(te.Fragment,{children:[J.jsx(Cr,{"data-index":Mt,...Ar,...!vd(Cr)&&{markActive:Qr},style:{...jn,...Ar.style},className:An(Ar.className,Qr&&$t.markActive)}),zr.label!=null?J.jsx(Er,{"aria-hidden":!0,"data-index":Mt,...$r,...!vd(Er)&&{markLabelActive:Qr},style:{...jn,...$r.style},className:An($t.markLabel,$r.className,Qr&&$t.markLabelActive),children:zr.label}):null]},Mt)}),Ot.map((zr,Mt)=>{const en=ZS(zr,O,N),jn=de[Be].offset(en),Qr=ye==="off"?rye:ar;return J.jsx(Qr,{...!vd(Qr)&&{valueLabelFormat:Te,valueLabelDisplay:ye,value:typeof Te=="function"?Te(G(zr),Mt):Te,index:Mt,open:Fe===Mt||Xe===Mt||ye==="on",disabled:T},...Ir,children:J.jsx(mr,{"data-index":Mt,...Ht,className:An($t.thumb,Ht.className,Xe===Mt&&$t.active,st===Mt&&$t.focusVisible),style:{...jn,...Xt(Mt),...Ht.style},children:J.jsx(Jt,{"data-index":Mt,"aria-label":A?A(Mt):a,"aria-valuenow":G(zr),"aria-labelledby":o,"aria-valuetext":M?M(G(zr),Mt):s,value:Ot[Mt],...fn})})},Mt)})]})});function nye(t={}){const{autoHideDuration:e=null,disableWindowBlurListener:r=!1,onClose:n,open:i,resumeHideDuration:a}=t,s=fg();te.useEffect(()=>{if(!i)return;function M(F){F.defaultPrevented||F.key==="Escape"&&n?.(F,"escapeKeyDown")}return document.addEventListener("keydown",M),()=>{document.removeEventListener("keydown",M)}},[i,n]);const o=ou((M,F)=>{n?.(M,F)}),c=ou(M=>{!n||M==null||s.start(M,()=>{o(null,"timeout")})});te.useEffect(()=>(i&&c(e),s.clear),[i,e,c,s]);const f=M=>{n?.(M,"clickaway")},d=s.clear,m=te.useCallback(()=>{e!=null&&c(a??e*.5)},[e,a,c]),b=M=>F=>{const N=M.onBlur;N?.(F),m()},x=M=>F=>{const N=M.onFocus;N?.(F),d()},E=M=>F=>{const N=M.onMouseEnter;N?.(F),d()},T=M=>F=>{const N=M.onMouseLeave;N?.(F),m()};return te.useEffect(()=>{if(!r&&i)return window.addEventListener("focus",m),window.addEventListener("blur",d),()=>{window.removeEventListener("focus",m),window.removeEventListener("blur",d)}},[r,i,m,d]),{getRootProps:(M={})=>{const F={...Nm(t),...Nm(M)};return{role:"presentation",...M,...F,onBlur:b(F),onFocus:x(F),onMouseEnter:E(F),onMouseLeave:T(F)}},onClickAway:f}}function iye(t){return gi("MuiSnackbarContent",t)}pi("MuiSnackbarContent",["root","message","action"]);const aye=t=>{const{classes:e}=t;return mi({root:["root"],action:["action"],message:["message"]},iye,e)},oye=Dr(hf,{name:"MuiSnackbarContent",slot:"Root"})(ci(({theme:t})=>{const e=t.palette.mode==="light"?.8:.98;return{...t.typography.body2,color:t.vars?t.vars.palette.SnackbarContent.color:t.palette.getContrastText(Ek(t.palette.background.default,e)),backgroundColor:t.vars?t.vars.palette.SnackbarContent.bg:Ek(t.palette.background.default,e),display:"flex",alignItems:"center",flexWrap:"wrap",padding:"6px 16px",flexGrow:1,[t.breakpoints.up("sm")]:{flexGrow:"initial",minWidth:288}}})),sye=Dr("div",{name:"MuiSnackbarContent",slot:"Message"})({padding:"8px 0"}),lye=Dr("div",{name:"MuiSnackbarContent",slot:"Action"})({display:"flex",alignItems:"center",marginLeft:"auto",paddingLeft:16,marginRight:-8}),uye=te.forwardRef(function(e,r){const n=bi({props:e,name:"MuiSnackbarContent"}),{action:i,className:a,message:s,role:o="alert",...c}=n,f=n,d=aye(f);return J.jsxs(oye,{role:o,elevation:6,className:An(d.root,a),ownerState:f,ref:r,...c,children:[J.jsx(sye,{className:d.message,ownerState:f,children:s}),i?J.jsx(lye,{className:d.action,ownerState:f,children:i}):null]})});function cye(t){return gi("MuiSnackbar",t)}pi("MuiSnackbar",["root","anchorOriginTopCenter","anchorOriginBottomCenter","anchorOriginTopRight","anchorOriginBottomRight","anchorOriginTopLeft","anchorOriginBottomLeft"]);const fye=t=>{const{classes:e,anchorOrigin:r}=t,n={root:["root",`anchorOrigin${cn(r.vertical)}${cn(r.horizontal)}`]};return mi(n,cye,e)},hye=Dr("div",{name:"MuiSnackbar",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.root,e[`anchorOrigin${cn(r.anchorOrigin.vertical)}${cn(r.anchorOrigin.horizontal)}`]]}})(ci(({theme:t})=>({zIndex:(t.vars||t).zIndex.snackbar,position:"fixed",display:"flex",left:8,right:8,justifyContent:"center",alignItems:"center",variants:[{props:({ownerState:e})=>e.anchorOrigin.vertical==="top",style:{top:8,[t.breakpoints.up("sm")]:{top:24}}},{props:({ownerState:e})=>e.anchorOrigin.vertical!=="top",style:{bottom:8,[t.breakpoints.up("sm")]:{bottom:24}}},{props:({ownerState:e})=>e.anchorOrigin.horizontal==="left",style:{justifyContent:"flex-start",[t.breakpoints.up("sm")]:{left:24,right:"auto"}}},{props:({ownerState:e})=>e.anchorOrigin.horizontal==="right",style:{justifyContent:"flex-end",[t.breakpoints.up("sm")]:{right:24,left:"auto"}}},{props:({ownerState:e})=>e.anchorOrigin.horizontal==="center",style:{[t.breakpoints.up("sm")]:{left:"50%",right:"auto",transform:"translateX(-50%)"}}}]}))),dye=te.forwardRef(function(e,r){const n=bi({props:e,name:"MuiSnackbar"}),i=Bc(),a={enter:i.transitions.duration.enteringScreen,exit:i.transitions.duration.leavingScreen},{action:s,anchorOrigin:{vertical:o,horizontal:c}={vertical:"bottom",horizontal:"left"},autoHideDuration:f=null,children:d,className:m,ClickAwayListenerProps:b,ContentProps:x,disableWindowBlurListener:E=!1,message:T,onBlur:A,onClose:M,onFocus:F,onMouseEnter:N,onMouseLeave:O,open:U,resumeHideDuration:j,slots:H={},slotProps:W={},TransitionComponent:X,transitionDuration:oe=a,TransitionProps:{onEnter:Q,onExited:G,...ae}={},...se}=n,fe={...n,anchorOrigin:{vertical:o,horizontal:c},autoHideDuration:f,disableWindowBlurListener:E,TransitionComponent:X,transitionDuration:oe},_e=fye(fe),{getRootProps:Le,onClickAway:ye}=nye({...fe}),[Te,Ie]=te.useState(!0),Me=Ot=>{Ie(!0),G&&G(Ot)},de=(Ot,at)=>{Ie(!1),Q&&Q(Ot,at)},Se={slots:{transition:X,...H},slotProps:{content:x,clickAwayListener:b,transition:ae,...W}},[we,De]=Ei("root",{ref:r,className:[_e.root,m],elementType:hye,getSlotProps:Le,externalForwardedProps:{...Se,...se},ownerState:fe}),[Fe,{ownerState:Xe,...Be}]=Ei("clickAwayListener",{elementType:zde,externalForwardedProps:Se,getSlotProps:Ot=>({onClickAway:(...at)=>{const $e=at[0];Ot.onClickAway?.(...at),!$e?.defaultMuiPrevented&&ye(...at)}}),ownerState:fe}),[st,Qe]=Ei("content",{elementType:uye,shouldForwardComponentProp:!0,externalForwardedProps:Se,additionalProps:{message:T,action:s},ownerState:fe}),[it,be]=Ei("transition",{elementType:jb,externalForwardedProps:Se,getSlotProps:Ot=>({onEnter:(...at)=>{Ot.onEnter?.(...at),de(...at)},onExited:(...at)=>{Ot.onExited?.(...at),Me(...at)}}),additionalProps:{appear:!0,in:U,timeout:oe,direction:o==="top"?"down":"up"},ownerState:fe});return!U&&Te?null:J.jsx(Fe,{...Be,...H.clickAwayListener&&{ownerState:Xe},children:J.jsx(we,{...De,children:J.jsx(it,{...be,children:d||J.jsx(st,{...Qe})})})})});function pye(t){return gi("MuiTooltip",t)}const Bs=pi("MuiTooltip",["popper","popperInteractive","popperArrow","popperClose","tooltip","tooltipArrow","touch","tooltipPlacementLeft","tooltipPlacementRight","tooltipPlacementTop","tooltipPlacementBottom","arrow"]);function gye(t){return Math.round(t*1e5)/1e5}const mye=t=>{const{classes:e,disableInteractive:r,arrow:n,touch:i,placement:a}=t,s={popper:["popper",!r&&"popperInteractive",n&&"popperArrow"],tooltip:["tooltip",n&&"tooltipArrow",i&&"touch",`tooltipPlacement${cn(a.split("-")[0])}`],arrow:["arrow"]};return mi(s,pye,e)},yye=Dr(nY,{name:"MuiTooltip",slot:"Popper",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.popper,!r.disableInteractive&&e.popperInteractive,r.arrow&&e.popperArrow,!r.open&&e.popperClose]}})(ci(({theme:t})=>({zIndex:(t.vars||t).zIndex.tooltip,pointerEvents:"none",variants:[{props:({ownerState:e})=>!e.disableInteractive,style:{pointerEvents:"auto"}},{props:({open:e})=>!e,style:{pointerEvents:"none"}},{props:({ownerState:e})=>e.arrow,style:{[`&[data-popper-placement*="bottom"] .${Bs.arrow}`]:{top:0,marginTop:"-0.71em","&::before":{transformOrigin:"0 100%"}},[`&[data-popper-placement*="top"] .${Bs.arrow}`]:{bottom:0,marginBottom:"-0.71em","&::before":{transformOrigin:"100% 0"}},[`&[data-popper-placement*="right"] .${Bs.arrow}`]:{height:"1em",width:"0.71em","&::before":{transformOrigin:"100% 100%"}},[`&[data-popper-placement*="left"] .${Bs.arrow}`]:{height:"1em",width:"0.71em","&::before":{transformOrigin:"0 0"}}}},{props:({ownerState:e})=>e.arrow&&!e.isRtl,style:{[`&[data-popper-placement*="right"] .${Bs.arrow}`]:{left:0,marginLeft:"-0.71em"}}},{props:({ownerState:e})=>e.arrow&&!!e.isRtl,style:{[`&[data-popper-placement*="right"] .${Bs.arrow}`]:{right:0,marginRight:"-0.71em"}}},{props:({ownerState:e})=>e.arrow&&!e.isRtl,style:{[`&[data-popper-placement*="left"] .${Bs.arrow}`]:{right:0,marginRight:"-0.71em"}}},{props:({ownerState:e})=>e.arrow&&!!e.isRtl,style:{[`&[data-popper-placement*="left"] .${Bs.arrow}`]:{left:0,marginLeft:"-0.71em"}}}]}))),vye=Dr("div",{name:"MuiTooltip",slot:"Tooltip",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.tooltip,r.touch&&e.touch,r.arrow&&e.tooltipArrow,e[`tooltipPlacement${cn(r.placement.split("-")[0])}`]]}})(ci(({theme:t})=>({backgroundColor:t.vars?t.vars.palette.Tooltip.bg:t.alpha(t.palette.grey[700],.92),borderRadius:(t.vars||t).shape.borderRadius,color:(t.vars||t).palette.common.white,fontFamily:t.typography.fontFamily,padding:"4px 8px",fontSize:t.typography.pxToRem(11),maxWidth:300,margin:2,wordWrap:"break-word",fontWeight:t.typography.fontWeightMedium,[`.${Bs.popper}[data-popper-placement*="left"] &`]:{transformOrigin:"right center"},[`.${Bs.popper}[data-popper-placement*="right"] &`]:{transformOrigin:"left center"},[`.${Bs.popper}[data-popper-placement*="top"] &`]:{transformOrigin:"center bottom",marginBottom:"14px"},[`.${Bs.popper}[data-popper-placement*="bottom"] &`]:{transformOrigin:"center top",marginTop:"14px"},variants:[{props:({ownerState:e})=>e.arrow,style:{position:"relative",margin:0}},{props:({ownerState:e})=>e.touch,style:{padding:"8px 16px",fontSize:t.typography.pxToRem(14),lineHeight:`${gye(16/14)}em`,fontWeight:t.typography.fontWeightRegular}},{props:({ownerState:e})=>!e.isRtl,style:{[`.${Bs.popper}[data-popper-placement*="left"] &`]:{marginRight:"14px"},[`.${Bs.popper}[data-popper-placement*="right"] &`]:{marginLeft:"14px"}}},{props:({ownerState:e})=>!e.isRtl&&e.touch,style:{[`.${Bs.popper}[data-popper-placement*="left"] &`]:{marginRight:"24px"},[`.${Bs.popper}[data-popper-placement*="right"] &`]:{marginLeft:"24px"}}},{props:({ownerState:e})=>!!e.isRtl,style:{[`.${Bs.popper}[data-popper-placement*="left"] &`]:{marginLeft:"14px"},[`.${Bs.popper}[data-popper-placement*="right"] &`]:{marginRight:"14px"}}},{props:({ownerState:e})=>!!e.isRtl&&e.touch,style:{[`.${Bs.popper}[data-popper-placement*="left"] &`]:{marginLeft:"24px"},[`.${Bs.popper}[data-popper-placement*="right"] &`]:{marginRight:"24px"}}},{props:({ownerState:e})=>e.touch,style:{[`.${Bs.popper}[data-popper-placement*="top"] &`]:{marginBottom:"24px"}}},{props:({ownerState:e})=>e.touch,style:{[`.${Bs.popper}[data-popper-placement*="bottom"] &`]:{marginTop:"24px"}}}]}))),_ye=Dr("span",{name:"MuiTooltip",slot:"Arrow"})(ci(({theme:t})=>({overflow:"hidden",position:"absolute",width:"1em",height:"0.71em",boxSizing:"border-box",color:t.vars?t.vars.palette.Tooltip.bg:t.alpha(t.palette.grey[700],.9),"&::before":{content:'""',margin:"auto",display:"block",width:"100%",height:"100%",backgroundColor:"currentColor",transform:"rotate(45deg)"}})));let K2=!1;const vz=new GT;let a1={x:0,y:0};function J2(t,e){return(r,...n)=>{e&&e(r,...n),t(r,...n)}}const hg=te.forwardRef(function(e,r){const n=bi({props:e,name:"MuiTooltip"}),{arrow:i=!1,children:a,classes:s,components:o={},componentsProps:c={},describeChild:f=!1,disableFocusListener:d=!1,disableHoverListener:m=!1,disableInteractive:b=!1,disableTouchListener:x=!1,enterDelay:E=100,enterNextDelay:T=0,enterTouchDelay:A=700,followCursor:M=!1,id:F,leaveDelay:N=0,leaveTouchDelay:O=1500,onClose:U,onOpen:j,open:H,placement:W="bottom",PopperComponent:X,PopperProps:oe={},slotProps:Q={},slots:G={},title:ae,TransitionComponent:se,TransitionProps:fe,..._e}=n,Le=te.isValidElement(a)?a:J.jsx("span",{children:a}),ye=Bc(),Te=Rx(),[Ie,Me]=te.useState(),[de,Se]=te.useState(null),we=te.useRef(!1),De=b||M,Fe=fg(),Xe=fg(),Be=fg(),st=fg(),[Qe,it]=Ym({controlled:H,default:!1,name:"Tooltip",state:"open"});let be=Qe;const Ot=Og(F),at=te.useRef(),$e=ou(()=>{at.current!==void 0&&(document.body.style.WebkitUserSelect=at.current,at.current=void 0),st.clear()});te.useEffect(()=>$e,[$e]);const Xt=nr=>{vz.clear(),K2=!0,it(!0),j&&!be&&j(nr)},$t=ou(nr=>{vz.start(800+N,()=>{K2=!1}),it(!1),U&&be&&U(nr),Fe.start(ye.transitions.duration.shortest,()=>{we.current=!1})}),cr=nr=>{we.current&&nr.type!=="touchstart"||(Ie&&Ie.removeAttribute("title"),Xe.clear(),Be.clear(),E||K2&&T?Xe.start(K2?T:E,()=>{Xt(nr)}):Xt(nr))},_t=nr=>{Xe.clear(),Be.start(N,()=>{$t(nr)})},[,gr]=te.useState(!1),mr=nr=>{F0(nr.target)||(gr(!1),_t(nr))},ar=nr=>{Ie||Me(nr.currentTarget),F0(nr.target)&&(gr(!0),cr(nr))},Cr=nr=>{we.current=!0;const oi=Le.props;oi.onTouchStart&&oi.onTouchStart(nr)},Er=nr=>{Cr(nr),Be.clear(),Fe.clear(),$e(),at.current=document.body.style.WebkitUserSelect,document.body.style.WebkitUserSelect="none",st.start(A,()=>{document.body.style.WebkitUserSelect=at.current,cr(nr)})},Jt=nr=>{Le.props.onTouchEnd&&Le.props.onTouchEnd(nr),$e(),Be.start(O,()=>{$t(nr)})};te.useEffect(()=>{if(!be)return;function nr(oi){oi.key==="Escape"&&$t(oi)}return document.addEventListener("keydown",nr),()=>{document.removeEventListener("keydown",nr)}},[$t,be]);const ot=Uo(Fg(Le),Me,r);!ae&&ae!==0&&(be=!1);const Ce=te.useRef(),xe=nr=>{const oi=Le.props;oi.onMouseMove&&oi.onMouseMove(nr),a1={x:nr.clientX,y:nr.clientY},Ce.current&&Ce.current.update()},je={},qe=typeof ae=="string";f?(je.title=!be&&qe&&!m?ae:null,je["aria-describedby"]=be?Ot:null):(je["aria-label"]=qe?ae:null,je["aria-labelledby"]=be&&!qe?Ot:null);const Ge={...je,..._e,...Le.props,className:An(_e.className,Le.props.className),onTouchStart:Cr,ref:ot,...M?{onMouseMove:xe}:{}},Ft={};x||(Ge.onTouchStart=Er,Ge.onTouchEnd=Jt),m||(Ge.onMouseOver=J2(cr,Ge.onMouseOver),Ge.onMouseLeave=J2(_t,Ge.onMouseLeave),De||(Ft.onMouseOver=cr,Ft.onMouseLeave=_t)),d||(Ge.onFocus=J2(ar,Ge.onFocus),Ge.onBlur=J2(mr,Ge.onBlur),De||(Ft.onFocus=ar,Ft.onBlur=mr));const Et={...n,isRtl:Te,arrow:i,disableInteractive:De,placement:W,PopperComponentProp:X,touch:we.current},mt=typeof Q.popper=="function"?Q.popper(Et):Q.popper,ct=te.useMemo(()=>{let nr=[{name:"arrow",enabled:!!de,options:{element:de,padding:4}}];return oe.popperOptions?.modifiers&&(nr=nr.concat(oe.popperOptions.modifiers)),mt?.popperOptions?.modifiers&&(nr=nr.concat(mt.popperOptions.modifiers)),{...oe.popperOptions,...mt?.popperOptions,modifiers:nr}},[de,oe.popperOptions,mt?.popperOptions]),Qt=mye(Et),Ht=typeof Q.transition=="function"?Q.transition(Et):Q.transition,Ir={slots:{popper:o.Popper,transition:o.Transition??se,tooltip:o.Tooltip,arrow:o.Arrow,...G},slotProps:{arrow:Q.arrow??c.arrow,popper:{...oe,...mt??c.popper},tooltip:Q.tooltip??c.tooltip,transition:{...fe,...Ht??c.transition}}},[Ar,$r]=Ei("popper",{elementType:yye,externalForwardedProps:Ir,ownerState:Et,className:An(Qt.popper,oe?.className)}),[fn,zr]=Ei("transition",{elementType:jb,externalForwardedProps:Ir,ownerState:Et}),[Mt,en]=Ei("tooltip",{elementType:vye,className:Qt.tooltip,externalForwardedProps:Ir,ownerState:Et}),[jn,Qr]=Ei("arrow",{elementType:_ye,className:Qt.arrow,externalForwardedProps:Ir,ownerState:Et,ref:Se});return J.jsxs(te.Fragment,{children:[te.cloneElement(Le,Ge),J.jsx(Ar,{as:X??nY,placement:W,anchorEl:M?{getBoundingClientRect:()=>({top:a1.y,left:a1.x,right:a1.x,bottom:a1.y,width:0,height:0})}:Ie,popperRef:Ce,open:Ie?be:!1,id:Ot,transition:!0,...Ft,...$r,popperOptions:ct,children:({TransitionProps:nr})=>J.jsx(fn,{timeout:ye.transitions.duration.shorter,...nr,...zr,children:J.jsxs(Mt,{...en,children:[ae,i?J.jsx(jn,{...Qr}):null]})})})]})}),bye=Dr("div",{name:"MuiSwipeArea",shouldForwardProp:Al})(ci(({theme:t})=>({position:"fixed",top:0,left:0,bottom:0,zIndex:t.zIndex.drawer-1,variants:[{props:{anchor:"left"},style:{right:"auto"}},{props:{anchor:"right"},style:{left:"auto",right:0}},{props:{anchor:"top"},style:{bottom:"auto",right:0}},{props:{anchor:"bottom"},style:{top:"auto",bottom:0,right:0}}]}))),xye=te.forwardRef(function(e,r){const{anchor:n,classes:i={},className:a,width:s,style:o,...c}=e,f=e;return J.jsx(bye,{className:An("PrivateSwipeArea-root",i.root,i[`anchor${cn(n)}`],a),ref:r,style:{[xm(n)?"width":"height"]:s,...o},ownerState:f,...c})}),Q2=3,_A=20;let Jd=null;function bA(t,e,r){return t==="right"?r.body.offsetWidth-e[0].pageX:e[0].pageX}function xA(t,e,r){return t==="bottom"?r.innerHeight-e[0].clientY:e[0].clientY}function o1(t,e){return t?e.clientWidth:e.clientHeight}function _z(t,e,r,n){return Math.min(Math.max(r?e-t:n+e-t,0),n)}function wye(t,e){const r=[];for(;t&&t!==e.parentElement;){const n=bc(e).getComputedStyle(t);n.getPropertyValue("position")==="absolute"||n.getPropertyValue("overflow-x")==="hidden"||(t.clientWidth>0&&t.scrollWidth>t.clientWidth||t.clientHeight>0&&t.scrollHeight>t.clientHeight)&&r.push(t),t=t.parentElement}return r}function Sye({domTreeShapes:t,start:e,current:r,anchor:n}){const i={scrollPosition:{x:"scrollLeft",y:"scrollTop"},scrollLength:{x:"scrollWidth",y:"scrollHeight"},clientLength:{x:"clientWidth",y:"clientHeight"}};return t.some(a=>{let s=r>=e;(n==="top"||n==="left")&&(s=!s);const o=n==="left"||n==="right"?"x":"y",c=Math.round(a[i.scrollPosition[o]]),f=c>0,d=c+a[i.clientLength[o]]<a[i.scrollLength[o]];return!!(s&&d||!s&&f)})}const Eye=typeof navigator<"u"&&/iPad|iPhone|iPod/.test(navigator.userAgent),Tye=te.forwardRef(function(e,r){const n=bi({name:"MuiSwipeableDrawer",props:e}),i=Bc(),a={enter:i.transitions.duration.enteringScreen,exit:i.transitions.duration.leavingScreen},{anchor:s="left",disableBackdropTransition:o=!1,disableDiscovery:c=!1,disableSwipeToOpen:f=Eye,hideBackdrop:d,hysteresis:m=.52,allowSwipeInChildren:b=!1,minFlingVelocity:x=450,ModalProps:{BackdropProps:E,...T}={},onClose:A,onOpen:M,open:F=!1,PaperProps:N={},SwipeAreaProps:O,swipeAreaWidth:U=20,transitionDuration:j=a,variant:H="temporary",slots:W={},slotProps:X={},...oe}=n,[Q,G]=te.useState(!1),ae=te.useRef({isSwiping:null}),se=te.useRef(),fe=te.useRef(),_e=te.useRef(),Le=Uo(N.ref,_e),ye=te.useRef(!1),Te=te.useRef();Tu(()=>{Te.current=null},[F]);const Ie=te.useCallback((Xe,Be={})=>{const{mode:st=null,changeTransition:Qe=!0}=Be,it=D1(i,s),be=["right","bottom"].includes(it)?1:-1,Ot=xm(s),at=Ot?`translate(${be*Xe}px, 0)`:`translate(0, ${be*Xe}px)`,$e=_e.current.style;$e.webkitTransform=at,$e.transform=at;let Xt="";if(st&&(Xt=i.transitions.create("all",xp({easing:void 0,style:void 0,timeout:j},{mode:st}))),Qe&&($e.webkitTransition=Xt,$e.transition=Xt),!o&&!d){const $t=fe.current.style;$t.opacity=1-Xe/o1(Ot,_e.current),Qe&&($t.webkitTransition=Xt,$t.transition=Xt)}},[s,o,d,i,j]),Me=ou(Xe=>{if(!ye.current)return;if(Jd=null,ye.current=!1,fp.flushSync(()=>{G(!1)}),!ae.current.isSwiping){ae.current.isSwiping=null;return}ae.current.isSwiping=null;const Be=D1(i,s),st=xm(s);let Qe;st?Qe=bA(Be,Xe.changedTouches,cs(Xe.currentTarget)):Qe=xA(Be,Xe.changedTouches,bc(Xe.currentTarget));const it=st?ae.current.startX:ae.current.startY,be=o1(st,_e.current),Ot=_z(Qe,it,F,be),at=Ot/be;if(Math.abs(ae.current.velocity)>x&&(Te.current=Math.abs((be-Ot)/ae.current.velocity)*1e3),F){ae.current.velocity>x||at>m?A():Ie(0,{mode:"exit"});return}ae.current.velocity<-x||1-at>m?M():Ie(o1(st,_e.current),{mode:"enter"})}),de=(Xe=!1)=>{if(!Q){(Xe||!(c&&b))&&fp.flushSync(()=>{G(!0)});const Be=xm(s);!F&&_e.current&&Ie(o1(Be,_e.current)+(c?15:-_A),{changeTransition:!1}),ae.current.velocity=0,ae.current.lastTime=null,ae.current.lastTranslate=null,ae.current.paperHit=!1,ye.current=!0}},Se=ou(Xe=>{if(!_e.current||!ye.current||Jd!==null&&Jd!==ae.current)return;de(!0);const Be=D1(i,s),st=xm(s),Qe=bA(Be,Xe.touches,cs(Xe.currentTarget)),it=xA(Be,Xe.touches,bc(Xe.currentTarget));if(F&&_e.current.contains(Xe.target)&&Jd===null){const Xt=wye(Xe.target,_e.current);if(Sye({domTreeShapes:Xt,start:st?ae.current.startX:ae.current.startY,current:st?Qe:it,anchor:s})){Jd=!0;return}Jd=ae.current}if(ae.current.isSwiping==null){const Xt=Math.abs(Qe-ae.current.startX),$t=Math.abs(it-ae.current.startY),cr=st?Xt>$t&&Xt>Q2:$t>Xt&&$t>Q2;if(cr&&Xe.cancelable&&Xe.preventDefault(),cr===!0||(st?$t>Q2:Xt>Q2)){if(ae.current.isSwiping=cr,!cr){Me(Xe);return}ae.current.startX=Qe,ae.current.startY=it,!c&&!F&&(st?ae.current.startX-=_A:ae.current.startY-=_A)}}if(!ae.current.isSwiping)return;const be=o1(st,_e.current);let Ot=st?ae.current.startX:ae.current.startY;F&&!ae.current.paperHit&&(Ot=Math.min(Ot,be));const at=_z(st?Qe:it,Ot,F,be);if(F)if(ae.current.paperHit)at===0&&(ae.current.startX=Qe,ae.current.startY=it);else if(st?Qe<be:it<be)ae.current.paperHit=!0,ae.current.startX=Qe,ae.current.startY=it;else return;ae.current.lastTranslate===null&&(ae.current.lastTranslate=at,ae.current.lastTime=performance.now()+1);const $e=(at-ae.current.lastTranslate)/(performance.now()-ae.current.lastTime)*1e3;ae.current.velocity=ae.current.velocity*.4+$e*.6,ae.current.lastTranslate=at,ae.current.lastTime=performance.now(),Xe.cancelable&&Xe.preventDefault(),Ie(at)}),we=ou(Xe=>{if(Xe.defaultPrevented||Xe.defaultMuiPrevented||F&&(d||!fe.current.contains(Xe.target))&&!_e.current.contains(Xe.target))return;const Be=D1(i,s),st=xm(s),Qe=bA(Be,Xe.touches,cs(Xe.currentTarget)),it=xA(Be,Xe.touches,bc(Xe.currentTarget));if(!F){if(f||!(Xe.target===se.current||_e.current?.contains(Xe.target)&&(typeof b=="function"?b(Xe,se.current,_e.current):b)))return;if(st){if(Qe>U)return}else if(it>U)return}Xe.defaultMuiPrevented=!0,Jd=null,ae.current.startX=Qe,ae.current.startY=it,de()});te.useEffect(()=>{if(H==="temporary"){const Xe=cs(_e.current);return Xe.addEventListener("touchstart",we),Xe.addEventListener("touchmove",Se,{passive:!F}),Xe.addEventListener("touchend",Me),()=>{Xe.removeEventListener("touchstart",we),Xe.removeEventListener("touchmove",Se,{passive:!F}),Xe.removeEventListener("touchend",Me)}}},[H,F,we,Se,Me]),te.useEffect(()=>()=>{Jd===ae.current&&(Jd=null)},[]),te.useEffect(()=>{F||G(!1)},[F]);const[De,Fe]=Ei("swipeArea",{ref:se,elementType:xye,ownerState:n,externalForwardedProps:{slots:W,slotProps:{swipeArea:O,...X}},additionalProps:{width:U,anchor:s}});return J.jsxs(te.Fragment,{children:[J.jsx(fO,{open:H==="temporary"&&Q?!0:F,variant:H,ModalProps:{BackdropProps:{...E,ref:fe},...H==="temporary"&&{keepMounted:!0},...T},hideBackdrop:d,anchor:s,transitionDuration:Te.current||j,onClose:A,ref:r,slots:W,slotProps:{...X,backdrop:Fb(X.backdrop??E,{ref:fe}),paper:Fb(X.paper??N,{style:{pointerEvents:H==="temporary"&&!F&&!b?"none":""},ref:Le})},...oe}),!f&&H==="temporary"&&J.jsx(rme,{children:J.jsx(De,{...Fe})})]})});function Cye(t){return gi("MuiToolbar",t)}pi("MuiToolbar",["root","gutters","regular","dense"]);const Aye=t=>{const{classes:e,disableGutters:r,variant:n}=t;return mi({root:["root",!r&&"gutters",n]},Cye,e)},Iye=Dr("div",{name:"MuiToolbar",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.root,!r.disableGutters&&e.gutters,e[r.variant]]}})(ci(({theme:t})=>({position:"relative",display:"flex",alignItems:"center",variants:[{props:({ownerState:e})=>!e.disableGutters,style:{paddingLeft:t.spacing(2),paddingRight:t.spacing(2),[t.breakpoints.up("sm")]:{paddingLeft:t.spacing(3),paddingRight:t.spacing(3)}}},{props:{variant:"dense"},style:{minHeight:48}},{props:{variant:"regular"},style:t.mixins.toolbar}]}))),Pye=te.forwardRef(function(e,r){const n=bi({props:e,name:"MuiToolbar"}),{className:i,component:a="div",disableGutters:s=!1,variant:o="regular",...c}=n,f={...n,component:a,disableGutters:s,variant:o},d=Aye(f);return J.jsx(Iye,{as:a,className:An(d.root,i),ref:r,ownerState:f,...c})});function kye(t){return gi("MuiTextField",t)}pi("MuiTextField",["root"]);const Rye={standard:dO,filled:hO,outlined:QT},Mye=t=>{const{classes:e}=t;return mi({root:["root"]},kye,e)},Dye=Dr(sf,{name:"MuiTextField",slot:"Root"})({}),e3=te.forwardRef(function(e,r){const n=bi({props:e,name:"MuiTextField"}),{autoComplete:i,autoFocus:a=!1,children:s,className:o,color:c="primary",defaultValue:f,disabled:d=!1,error:m=!1,FormHelperTextProps:b,fullWidth:x=!1,helperText:E,id:T,InputLabelProps:A,inputProps:M,InputProps:F,inputRef:N,label:O,maxRows:U,minRows:j,multiline:H=!1,name:W,onBlur:X,onChange:oe,onFocus:Q,placeholder:G,required:ae=!1,rows:se,select:fe=!1,SelectProps:_e,slots:Le={},slotProps:ye={},type:Te,value:Ie,variant:Me="outlined",...de}=n,Se={...n,autoFocus:a,color:c,disabled:d,error:m,fullWidth:x,multiline:H,required:ae,select:fe,variant:Me},we=Mye(Se),De=Og(T),Fe=E&&De?`${De}-helper-text`:void 0,Xe=O&&De?`${De}-label`:void 0,Be=Rye[Me],st={slots:Le,slotProps:{input:F,inputLabel:A,htmlInput:M,formHelperText:b,select:_e,...ye}},Qe={},it=st.slotProps.inputLabel;Me==="outlined"&&(it&&typeof it.shrink<"u"&&(Qe.notched=it.shrink),Qe.label=O),fe&&((!_e||!_e.native)&&(Qe.id=void 0),Qe["aria-describedby"]=void 0);const[be,Ot]=Ei("root",{elementType:Dye,shouldForwardComponentProp:!0,externalForwardedProps:{...st,...de},ownerState:Se,className:An(we.root,o),ref:r,additionalProps:{disabled:d,error:m,fullWidth:x,required:ae,color:c,variant:Me}}),[at,$e]=Ei("input",{elementType:Be,externalForwardedProps:st,additionalProps:Qe,ownerState:Se}),[Xt,$t]=Ei("inputLabel",{elementType:_g,externalForwardedProps:st,ownerState:Se}),[cr,_t]=Ei("htmlInput",{elementType:"input",externalForwardedProps:st,ownerState:Se}),[gr,mr]=Ei("formHelperText",{elementType:Qpe,externalForwardedProps:st,ownerState:Se}),[ar,Cr]=Ei("select",{elementType:bg,externalForwardedProps:st,ownerState:Se}),Er=J.jsx(at,{"aria-describedby":Fe,autoComplete:i,autoFocus:a,defaultValue:f,fullWidth:x,multiline:H,name:W,rows:se,maxRows:U,minRows:j,type:Te,value:Ie,id:De,inputRef:N,onBlur:X,onChange:oe,onFocus:Q,placeholder:G,inputProps:_t,slots:{input:Le.htmlInput?cr:void 0},...$e});return J.jsxs(be,{...Ot,children:[O!=null&&O!==""&&J.jsx(Xt,{htmlFor:De,id:Xe,...$t,children:O}),fe?J.jsx(ar,{"aria-describedby":Fe,id:De,labelId:Xe,value:Ie,input:Er,...Cr,children:s}):Er,E&&J.jsx(gr,{id:Fe,...mr,children:E})]})}),Nx=xX({themeId:Eh}),Oye=Ji(J.jsx("path",{d:"M5 15H3v4c0 1.1.9 2 2 2h4v-2H5zM5 5h4V3H5c-1.1 0-2 .9-2 2v4h2zm14-2h-4v2h4v4h2V5c0-1.1-.9-2-2-2m0 16h-4v2h4c1.1 0 2-.9 2-2v-4h-2zM12 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3"})),Gk=t=>{const e=va({mapId:t.mapId,waitForLayer:t.insertBeforeLayer}),[r,n]=te.useState(!1),i=()=>{navigator.geolocation.getCurrentPosition(a,s)},a=te.useCallback(o=>{e.map?.map.setCenter?.([o.coords.longitude,o.coords.latitude])},[e.map]),s=()=>{console.log("Access of user location denied"),n(!0)};return J.jsx(J.Fragment,{children:J.jsx(ta,{variant:"navtools",sx:o=>({zIndex:1002,color:r?t.offColor??o.palette.navigation.buttonColor:t.onColor??o.palette.navigation.buttonColor}),onClick:i,disabled:r,children:J.jsx(Oye,{sx:{fontSize:{xs:"1.4em",md:"1em"}}})})})};try{Gk.displayName="MlCenterPosition",Gk.__docgenInfo={description:"Component template",displayName:"MlCenterPosition",props:{mapId:{defaultValue:null,description:"Id of the target MapLibre instance in mapContext",name:"mapId",required:!1,type:{name:"string | undefined"}},insertBeforeLayer:{defaultValue:null,description:`Id of an existing layer in the mapLibre instance to help specify the layer order
This layer will be visually beneath the layer with the "insertBeforeLayer" id.`,name:"insertBeforeLayer",required:!1,type:{name:"string | undefined"}},onColor:{defaultValue:null,description:"Active button font color",name:"onColor",required:!1,type:{name:"string | undefined"}},offColor:{defaultValue:null,description:"Inactive button font color",name:"offColor",required:!1,type:{name:"string | undefined"}},style:{defaultValue:null,description:"CSS style object that is applied to the button component",name:"style",required:!1,type:{name:"SxProps<Theme> | undefined"}}}}}catch{}const bz=t=>{const e=va({mapId:t.mapId});return console.log(e.componentId+" remove this log"),J.jsx(J.Fragment,{})};try{bz.displayName="MlComponentTemplate",bz.__docgenInfo={description:"Component description",displayName:"MlComponentTemplate",props:{mapId:{defaultValue:null,description:"Id of the target MapLibre instance in mapContext",name:"mapId",required:!1,type:{name:"string | undefined"}}}}}catch{}const Nye=Ji(J.jsx("path",{d:"M19 8H5c-1.66 0-3 1.34-3 3v6h4v4h12v-4h4v-6c0-1.66-1.34-3-3-3m-3 11H8v-5h8zm3-7c-.55 0-1-.45-1-1s.45-1 1-1 1 .45 1 1-.45 1-1 1m-1-9H6v4h12z"}));function ho(t){"@babel/helpers - typeof";return ho=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ho(t)}var Ch=Uint8Array,lf=Uint16Array,yO=Int32Array,vO=new Ch([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),_O=new Ch([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),xz=new Ch([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),IY=function(t,e){for(var r=new lf(31),n=0;n<31;++n)r[n]=e+=1<<t[n-1];for(var i=new yO(r[30]),n=1;n<30;++n)for(var a=r[n];a<r[n+1];++a)i[a]=a-r[n]<<5|n;return{b:r,r:i}},PY=IY(vO,2),Lye=PY.b,Wk=PY.r;Lye[28]=258,Wk[258]=28;var Fye=IY(_O,0),wz=Fye.r,Xk=new lf(32768);for(var Qo=0;Qo<32768;++Qo){var Jp=(Qo&43690)>>1|(Qo&21845)<<1;Jp=(Jp&52428)>>2|(Jp&13107)<<2,Jp=(Jp&61680)>>4|(Jp&3855)<<4,Xk[Qo]=((Jp&65280)>>8|(Jp&255)<<8)>>1}var fb=(function(t,e,r){for(var n=t.length,i=0,a=new lf(e);i<n;++i)t[i]&&++a[t[i]-1];var s=new lf(e);for(i=1;i<e;++i)s[i]=s[i-1]+a[i-1]<<1;var o;if(r){o=new lf(1<<e);var c=15-e;for(i=0;i<n;++i)if(t[i])for(var f=i<<4|t[i],d=e-t[i],m=s[t[i]-1]++<<d,b=m|(1<<d)-1;m<=b;++m)o[Xk[m]>>c]=f}else for(o=new lf(n),i=0;i<n;++i)t[i]&&(o[i]=Xk[s[t[i]-1]++]>>15-t[i]);return o}),Km=new Ch(288);for(var Qo=0;Qo<144;++Qo)Km[Qo]=8;for(var Qo=144;Qo<256;++Qo)Km[Qo]=9;for(var Qo=256;Qo<280;++Qo)Km[Qo]=7;for(var Qo=280;Qo<288;++Qo)Km[Qo]=8;var KS=new Ch(32);for(var Qo=0;Qo<32;++Qo)KS[Qo]=5;var Bye=fb(Km,9,0),zye=fb(KS,5,0),kY=function(t){return(t+7)/8|0},jye=function(t,e,r){return(r==null||r>t.length)&&(r=t.length),new Ch(t.subarray(e,r))},Qd=function(t,e,r){r<<=e&7;var n=e/8|0;t[n]|=r,t[n+1]|=r>>8},s1=function(t,e,r){r<<=e&7;var n=e/8|0;t[n]|=r,t[n+1]|=r>>8,t[n+2]|=r>>16},wA=function(t,e){for(var r=[],n=0;n<t.length;++n)t[n]&&r.push({s:n,f:t[n]});var i=r.length,a=r.slice();if(!i)return{t:MY,l:0};if(i==1){var s=new Ch(r[0].s+1);return s[r[0].s]=1,{t:s,l:1}}r.sort(function(U,j){return U.f-j.f}),r.push({s:-1,f:25001});var o=r[0],c=r[1],f=0,d=1,m=2;for(r[0]={s:-1,f:o.f+c.f,l:o,r:c};d!=i-1;)o=r[r[f].f<r[m].f?f++:m++],c=r[f!=d&&r[f].f<r[m].f?f++:m++],r[d++]={s:-1,f:o.f+c.f,l:o,r:c};for(var b=a[0].s,n=1;n<i;++n)a[n].s>b&&(b=a[n].s);var x=new lf(b+1),E=Yk(r[d-1],x,0);if(E>e){var n=0,T=0,A=E-e,M=1<<A;for(a.sort(function(j,H){return x[H.s]-x[j.s]||j.f-H.f});n<i;++n){var F=a[n].s;if(x[F]>e)T+=M-(1<<E-x[F]),x[F]=e;else break}for(T>>=A;T>0;){var N=a[n].s;x[N]<e?T-=1<<e-x[N]++-1:++n}for(;n>=0&&T;--n){var O=a[n].s;x[O]==e&&(--x[O],++T)}E=e}return{t:new Ch(x),l:E}},Yk=function(t,e,r){return t.s==-1?Math.max(Yk(t.l,e,r+1),Yk(t.r,e,r+1)):e[t.s]=r},Sz=function(t){for(var e=t.length;e&&!t[--e];);for(var r=new lf(++e),n=0,i=t[0],a=1,s=function(c){r[n++]=c},o=1;o<=e;++o)if(t[o]==i&&o!=e)++a;else{if(!i&&a>2){for(;a>138;a-=138)s(32754);a>2&&(s(a>10?a-11<<5|28690:a-3<<5|12305),a=0)}else if(a>3){for(s(i),--a;a>6;a-=6)s(8304);a>2&&(s(a-3<<5|8208),a=0)}for(;a--;)s(i);a=1,i=t[o]}return{c:r.subarray(0,n),n:e}},l1=function(t,e){for(var r=0,n=0;n<e.length;++n)r+=t[n]*e[n];return r},RY=function(t,e,r){var n=r.length,i=kY(e+2);t[i]=n&255,t[i+1]=n>>8,t[i+2]=t[i]^255,t[i+3]=t[i+1]^255;for(var a=0;a<n;++a)t[i+a+4]=r[a];return(i+4+n)*8},Ez=function(t,e,r,n,i,a,s,o,c,f,d){Qd(e,d++,r),++i[256];for(var m=wA(i,15),b=m.t,x=m.l,E=wA(a,15),T=E.t,A=E.l,M=Sz(b),F=M.c,N=M.n,O=Sz(T),U=O.c,j=O.n,H=new lf(19),W=0;W<F.length;++W)++H[F[W]&31];for(var W=0;W<U.length;++W)++H[U[W]&31];for(var X=wA(H,7),oe=X.t,Q=X.l,G=19;G>4&&!oe[xz[G-1]];--G);var ae=f+5<<3,se=l1(i,Km)+l1(a,KS)+s,fe=l1(i,b)+l1(a,T)+s+14+3*G+l1(H,oe)+2*H[16]+3*H[17]+7*H[18];if(c>=0&&ae<=se&&ae<=fe)return RY(e,d,t.subarray(c,c+f));var _e,Le,ye,Te;if(Qd(e,d,1+(fe<se)),d+=2,fe<se){_e=fb(b,x,0),Le=b,ye=fb(T,A,0),Te=T;var Ie=fb(oe,Q,0);Qd(e,d,N-257),Qd(e,d+5,j-1),Qd(e,d+10,G-4),d+=14;for(var W=0;W<G;++W)Qd(e,d+3*W,oe[xz[W]]);d+=3*G;for(var Me=[F,U],de=0;de<2;++de)for(var Se=Me[de],W=0;W<Se.length;++W){var we=Se[W]&31;Qd(e,d,Ie[we]),d+=oe[we],we>15&&(Qd(e,d,Se[W]>>5&127),d+=Se[W]>>12)}}else _e=Bye,Le=Km,ye=zye,Te=KS;for(var W=0;W<o;++W){var De=n[W];if(De>255){var we=De>>18&31;s1(e,d,_e[we+257]),d+=Le[we+257],we>7&&(Qd(e,d,De>>23&31),d+=vO[we]);var Fe=De&31;s1(e,d,ye[Fe]),d+=Te[Fe],Fe>3&&(s1(e,d,De>>5&8191),d+=_O[Fe])}else s1(e,d,_e[De]),d+=Le[De]}return s1(e,d,_e[256]),d+Le[256]},Uye=new yO([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),MY=new Ch(0),Vye=function(t,e,r,n,i,a){var s=a.z||t.length,o=new Ch(n+s+5*(1+Math.ceil(s/7e3))+i),c=o.subarray(n,o.length-i),f=a.l,d=(a.r||0)&7;if(e){d&&(c[0]=a.r>>3);for(var m=Uye[e-1],b=m>>13,x=m&8191,E=(1<<r)-1,T=a.p||new lf(32768),A=a.h||new lf(E+1),M=Math.ceil(r/3),F=2*M,N=function(at){return(t[at]^t[at+1]<<M^t[at+2]<<F)&E},O=new yO(25e3),U=new lf(288),j=new lf(32),H=0,W=0,X=a.i||0,oe=0,Q=a.w||0,G=0;X+2<s;++X){var ae=N(X),se=X&32767,fe=A[ae];if(T[se]=fe,A[ae]=se,Q<=X){var _e=s-X;if((H>7e3||oe>24576)&&(_e>423||!f)){d=Ez(t,c,0,O,U,j,W,oe,G,X-G,d),oe=H=W=0,G=X;for(var Le=0;Le<286;++Le)U[Le]=0;for(var Le=0;Le<30;++Le)j[Le]=0}var ye=2,Te=0,Ie=x,Me=se-fe&32767;if(_e>2&&ae==N(X-Me))for(var de=Math.min(b,_e)-1,Se=Math.min(32767,X),we=Math.min(258,_e);Me<=Se&&--Ie&&se!=fe;){if(t[X+ye]==t[X+ye-Me]){for(var De=0;De<we&&t[X+De]==t[X+De-Me];++De);if(De>ye){if(ye=De,Te=Me,De>de)break;for(var Fe=Math.min(Me,De-2),Xe=0,Le=0;Le<Fe;++Le){var Be=X-Me+Le&32767,st=T[Be],Qe=Be-st&32767;Qe>Xe&&(Xe=Qe,fe=Be)}}}se=fe,fe=T[se],Me+=se-fe&32767}if(Te){O[oe++]=268435456|Wk[ye]<<18|wz[Te];var it=Wk[ye]&31,be=wz[Te]&31;W+=vO[it]+_O[be],++U[257+it],++j[be],Q=X+ye,++H}else O[oe++]=t[X],++U[t[X]]}}for(X=Math.max(X,Q);X<s;++X)O[oe++]=t[X],++U[t[X]];d=Ez(t,c,f,O,U,j,W,oe,G,X-G,d),f||(a.r=d&7|c[d/8|0]<<3,d-=7,a.h=A,a.p=T,a.i=X,a.w=Q)}else{for(var X=a.w||0;X<s+f;X+=65535){var Ot=X+65535;Ot>=s&&(c[d/8|0]=f,Ot=s),d=RY(c,d+1,t.subarray(X,Ot))}a.i=s}return jye(o,0,n+kY(d)+i)},DY=function(){var t=1,e=0;return{p:function(r){for(var n=t,i=e,a=r.length|0,s=0;s!=a;){for(var o=Math.min(s+2655,a);s<o;++s)i+=n+=r[s];n=(n&65535)+15*(n>>16),i=(i&65535)+15*(i>>16)}t=n,e=i},d:function(){return t%=65521,e%=65521,(t&255)<<24|(t&65280)<<8|(e&255)<<8|e>>8}}},$ye=function(t,e,r,n,i){if(!i&&(i={l:1},e.dictionary)){var a=e.dictionary.subarray(-32768),s=new Ch(a.length+t.length);s.set(a),s.set(t,a.length),t=s,i.w=a.length}return Vye(t,e.level==null?6:e.level,e.mem==null?i.l?Math.ceil(Math.max(8,Math.min(13,Math.log(t.length)))*1.5):20:12+e.mem,r,n,i)},OY=function(t,e,r){for(;r;++e)t[e]=r,r>>>=8},qye=function(t,e){var r=e.level,n=r==0?0:r<6?1:r==9?3:2;if(t[0]=120,t[1]=n<<6|(e.dictionary&&32),t[1]|=31-(t[0]<<8|t[1])%31,e.dictionary){var i=DY();i.p(e.dictionary),OY(t,2,i.d())}};function Zk(t,e){e||(e={});var r=DY();r.p(t);var n=$ye(t,e,e.dictionary?6:2,4);return qye(n,e),OY(n,n.length-4,r.d()),n}var Hye=typeof TextDecoder<"u"&&new TextDecoder,Gye=0;try{Hye.decode(MY,{stream:!0}),Gye=1}catch{}function Wye(t){if(Array.isArray(t))return t}function Xye(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,i,a,s,o=[],c=!0,f=!1;try{if(a=(r=r.call(t)).next,e!==0)for(;!(c=(n=a.call(r)).done)&&(o.push(n.value),o.length!==e);c=!0);}catch(d){f=!0,i=d}finally{try{if(!c&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(f)throw i}}return o}}function Tz(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function Yye(t,e){if(t){if(typeof t=="string")return Tz(t,e);var r={}.toString.call(t).slice(8,-1);return r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set"?Array.from(t):r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Tz(t,e):void 0}}function Zye(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Cz(t,e){return Wye(t)||Xye(t,e)||Yye(t,e)||Zye()}function Az(t,e="utf8"){return new TextDecoder(e).decode(t)}const Kye=new TextEncoder;function Jye(t){return Kye.encode(t)}const Qye=1024*8,eve=(()=>{const t=new Uint8Array(4),e=new Uint32Array(t.buffer);return!((e[0]=1)&t[0])})(),SA={int8:globalThis.Int8Array,uint8:globalThis.Uint8Array,int16:globalThis.Int16Array,uint16:globalThis.Uint16Array,int32:globalThis.Int32Array,uint32:globalThis.Uint32Array,uint64:globalThis.BigUint64Array,int64:globalThis.BigInt64Array,float32:globalThis.Float32Array,float64:globalThis.Float64Array};class bO{buffer;byteLength;byteOffset;length;offset;lastWrittenByte;littleEndian;_data;_mark;_marks;constructor(e=Qye,r={}){let n=!1;typeof e=="number"?e=new ArrayBuffer(e):(n=!0,this.lastWrittenByte=e.byteLength);const i=r.offset?r.offset>>>0:0,a=e.byteLength-i;let s=i;(ArrayBuffer.isView(e)||e instanceof bO)&&(e.byteLength!==e.buffer.byteLength&&(s=e.byteOffset+i),e=e.buffer),n?this.lastWrittenByte=a:this.lastWrittenByte=0,this.buffer=e,this.length=a,this.byteLength=a,this.byteOffset=s,this.offset=0,this.littleEndian=!0,this._data=new DataView(this.buffer,s,a),this._mark=0,this._marks=[]}available(e=1){return this.offset+e<=this.length}isLittleEndian(){return this.littleEndian}setLittleEndian(){return this.littleEndian=!0,this}isBigEndian(){return!this.littleEndian}setBigEndian(){return this.littleEndian=!1,this}skip(e=1){return this.offset+=e,this}back(e=1){return this.offset-=e,this}seek(e){return this.offset=e,this}mark(){return this._mark=this.offset,this}reset(){return this.offset=this._mark,this}pushMark(){return this._marks.push(this.offset),this}popMark(){const e=this._marks.pop();if(e===void 0)throw new Error("Mark stack empty");return this.seek(e),this}rewind(){return this.offset=0,this}ensureAvailable(e=1){if(!this.available(e)){const n=(this.offset+e)*2,i=new Uint8Array(n);i.set(new Uint8Array(this.buffer)),this.buffer=i.buffer,this.length=n,this.byteLength=n,this._data=new DataView(this.buffer)}return this}readBoolean(){return this.readUint8()!==0}readInt8(){return this._data.getInt8(this.offset++)}readUint8(){return this._data.getUint8(this.offset++)}readByte(){return this.readUint8()}readBytes(e=1){return this.readArray(e,"uint8")}readArray(e,r){const n=SA[r].BYTES_PER_ELEMENT*e,i=this.byteOffset+this.offset,a=this.buffer.slice(i,i+n);if(this.littleEndian===eve&&r!=="uint8"&&r!=="int8"){const o=new Uint8Array(this.buffer.slice(i,i+n));o.reverse();const c=new SA[r](o.buffer);return this.offset+=n,c.reverse(),c}const s=new SA[r](a);return this.offset+=n,s}readInt16(){const e=this._data.getInt16(this.offset,this.littleEndian);return this.offset+=2,e}readUint16(){const e=this._data.getUint16(this.offset,this.littleEndian);return this.offset+=2,e}readInt32(){const e=this._data.getInt32(this.offset,this.littleEndian);return this.offset+=4,e}readUint32(){const e=this._data.getUint32(this.offset,this.littleEndian);return this.offset+=4,e}readFloat32(){const e=this._data.getFloat32(this.offset,this.littleEndian);return this.offset+=4,e}readFloat64(){const e=this._data.getFloat64(this.offset,this.littleEndian);return this.offset+=8,e}readBigInt64(){const e=this._data.getBigInt64(this.offset,this.littleEndian);return this.offset+=8,e}readBigUint64(){const e=this._data.getBigUint64(this.offset,this.littleEndian);return this.offset+=8,e}readChar(){return String.fromCharCode(this.readInt8())}readChars(e=1){let r="";for(let n=0;n<e;n++)r+=this.readChar();return r}readUtf8(e=1){return Az(this.readBytes(e))}decodeText(e=1,r="utf8"){return Az(this.readBytes(e),r)}writeBoolean(e){return this.writeUint8(e?255:0),this}writeInt8(e){return this.ensureAvailable(1),this._data.setInt8(this.offset++,e),this._updateLastWrittenByte(),this}writeUint8(e){return this.ensureAvailable(1),this._data.setUint8(this.offset++,e),this._updateLastWrittenByte(),this}writeByte(e){return this.writeUint8(e)}writeBytes(e){this.ensureAvailable(e.length);for(let r=0;r<e.length;r++)this._data.setUint8(this.offset++,e[r]);return this._updateLastWrittenByte(),this}writeInt16(e){return this.ensureAvailable(2),this._data.setInt16(this.offset,e,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeUint16(e){return this.ensureAvailable(2),this._data.setUint16(this.offset,e,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeInt32(e){return this.ensureAvailable(4),this._data.setInt32(this.offset,e,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeUint32(e){return this.ensureAvailable(4),this._data.setUint32(this.offset,e,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat32(e){return this.ensureAvailable(4),this._data.setFloat32(this.offset,e,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat64(e){return this.ensureAvailable(8),this._data.setFloat64(this.offset,e,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigInt64(e){return this.ensureAvailable(8),this._data.setBigInt64(this.offset,e,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigUint64(e){return this.ensureAvailable(8),this._data.setBigUint64(this.offset,e,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeChar(e){return this.writeUint8(e.charCodeAt(0))}writeChars(e){for(let r=0;r<e.length;r++)this.writeUint8(e.charCodeAt(r));return this}writeUtf8(e){return this.writeBytes(Jye(e))}toArray(){return new Uint8Array(this.buffer,this.byteOffset,this.lastWrittenByte)}getWrittenByteLength(){return this.lastWrittenByte-this.byteOffset}_updateLastWrittenByte(){this.offset>this.lastWrittenByte&&(this.lastWrittenByte=this.offset)}}function p_(t){let e=t.length;for(;--e>=0;)t[e]=0}const tve=3,rve=258,NY=29,nve=256,ive=nve+1+NY,LY=30,ave=512,ove=new Array((ive+2)*2);p_(ove);const sve=new Array(LY*2);p_(sve);const lve=new Array(ave);p_(lve);const uve=new Array(rve-tve+1);p_(uve);const cve=new Array(NY);p_(cve);const fve=new Array(LY);p_(fve);const hve=(t,e,r,n)=>{let i=t&65535|0,a=t>>>16&65535|0,s=0;for(;r!==0;){s=r>2e3?2e3:r,r-=s;do i=i+e[n++]|0,a=a+i|0;while(--s);i%=65521,a%=65521}return i|a<<16|0};var Kk=hve;const dve=()=>{let t,e=[];for(var r=0;r<256;r++){t=r;for(var n=0;n<8;n++)t=t&1?3988292384^t>>>1:t>>>1;e[r]=t}return e},pve=new Uint32Array(dve()),gve=(t,e,r,n)=>{const i=pve,a=n+r;t^=-1;for(let s=n;s<a;s++)t=t>>>8^i[(t^e[s])&255];return t^-1};var rd=gve,Jk={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},FY={Z_NO_FLUSH:0,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_DEFLATED:8};const mve=(t,e)=>Object.prototype.hasOwnProperty.call(t,e);var yve=function(t){const e=Array.prototype.slice.call(arguments,1);for(;e.length;){const r=e.shift();if(r){if(typeof r!="object")throw new TypeError(r+"must be non-object");for(const n in r)mve(r,n)&&(t[n]=r[n])}}return t},vve=t=>{let e=0;for(let n=0,i=t.length;n<i;n++)e+=t[n].length;const r=new Uint8Array(e);for(let n=0,i=0,a=t.length;n<a;n++){let s=t[n];r.set(s,i),i+=s.length}return r},BY={assign:yve,flattenChunks:vve};let zY=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{zY=!1}const Vb=new Uint8Array(256);for(let t=0;t<256;t++)Vb[t]=t>=252?6:t>=248?5:t>=240?4:t>=224?3:t>=192?2:1;Vb[254]=Vb[254]=1;var _ve=t=>{if(typeof TextEncoder=="function"&&TextEncoder.prototype.encode)return new TextEncoder().encode(t);let e,r,n,i,a,s=t.length,o=0;for(i=0;i<s;i++)r=t.charCodeAt(i),(r&64512)===55296&&i+1<s&&(n=t.charCodeAt(i+1),(n&64512)===56320&&(r=65536+(r-55296<<10)+(n-56320),i++)),o+=r<128?1:r<2048?2:r<65536?3:4;for(e=new Uint8Array(o),a=0,i=0;a<o;i++)r=t.charCodeAt(i),(r&64512)===55296&&i+1<s&&(n=t.charCodeAt(i+1),(n&64512)===56320&&(r=65536+(r-55296<<10)+(n-56320),i++)),r<128?e[a++]=r:r<2048?(e[a++]=192|r>>>6,e[a++]=128|r&63):r<65536?(e[a++]=224|r>>>12,e[a++]=128|r>>>6&63,e[a++]=128|r&63):(e[a++]=240|r>>>18,e[a++]=128|r>>>12&63,e[a++]=128|r>>>6&63,e[a++]=128|r&63);return e};const bve=(t,e)=>{if(e<65534&&t.subarray&&zY)return String.fromCharCode.apply(null,t.length===e?t:t.subarray(0,e));let r="";for(let n=0;n<e;n++)r+=String.fromCharCode(t[n]);return r};var xve=(t,e)=>{const r=e||t.length;if(typeof TextDecoder=="function"&&TextDecoder.prototype.decode)return new TextDecoder().decode(t.subarray(0,e));let n,i;const a=new Array(r*2);for(i=0,n=0;n<r;){let s=t[n++];if(s<128){a[i++]=s;continue}let o=Vb[s];if(o>4){a[i++]=65533,n+=o-1;continue}for(s&=o===2?31:o===3?15:7;o>1&&n<r;)s=s<<6|t[n++]&63,o--;if(o>1){a[i++]=65533;continue}s<65536?a[i++]=s:(s-=65536,a[i++]=55296|s>>10&1023,a[i++]=56320|s&1023)}return bve(a,i)},wve=(t,e)=>{e=e||t.length,e>t.length&&(e=t.length);let r=e-1;for(;r>=0&&(t[r]&192)===128;)r--;return r<0||r===0?e:r+Vb[t[r]]>e?r:e},Qk={string2buf:_ve,buf2string:xve,utf8border:wve};function Sve(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}var Eve=Sve;const ew=16209,Tve=16191;var Cve=function(e,r){let n,i,a,s,o,c,f,d,m,b,x,E,T,A,M,F,N,O,U,j,H,W,X,oe;const Q=e.state;n=e.next_in,X=e.input,i=n+(e.avail_in-5),a=e.next_out,oe=e.output,s=a-(r-e.avail_out),o=a+(e.avail_out-257),c=Q.dmax,f=Q.wsize,d=Q.whave,m=Q.wnext,b=Q.window,x=Q.hold,E=Q.bits,T=Q.lencode,A=Q.distcode,M=(1<<Q.lenbits)-1,F=(1<<Q.distbits)-1;e:do{E<15&&(x+=X[n++]<<E,E+=8,x+=X[n++]<<E,E+=8),N=T[x&M];t:for(;;){if(O=N>>>24,x>>>=O,E-=O,O=N>>>16&255,O===0)oe[a++]=N&65535;else if(O&16){U=N&65535,O&=15,O&&(E<O&&(x+=X[n++]<<E,E+=8),U+=x&(1<<O)-1,x>>>=O,E-=O),E<15&&(x+=X[n++]<<E,E+=8,x+=X[n++]<<E,E+=8),N=A[x&F];r:for(;;){if(O=N>>>24,x>>>=O,E-=O,O=N>>>16&255,O&16){if(j=N&65535,O&=15,E<O&&(x+=X[n++]<<E,E+=8,E<O&&(x+=X[n++]<<E,E+=8)),j+=x&(1<<O)-1,j>c){e.msg="invalid distance too far back",Q.mode=ew;break e}if(x>>>=O,E-=O,O=a-s,j>O){if(O=j-O,O>d&&Q.sane){e.msg="invalid distance too far back",Q.mode=ew;break e}if(H=0,W=b,m===0){if(H+=f-O,O<U){U-=O;do oe[a++]=b[H++];while(--O);H=a-j,W=oe}}else if(m<O){if(H+=f+m-O,O-=m,O<U){U-=O;do oe[a++]=b[H++];while(--O);if(H=0,m<U){O=m,U-=O;do oe[a++]=b[H++];while(--O);H=a-j,W=oe}}}else if(H+=m-O,O<U){U-=O;do oe[a++]=b[H++];while(--O);H=a-j,W=oe}for(;U>2;)oe[a++]=W[H++],oe[a++]=W[H++],oe[a++]=W[H++],U-=3;U&&(oe[a++]=W[H++],U>1&&(oe[a++]=W[H++]))}else{H=a-j;do oe[a++]=oe[H++],oe[a++]=oe[H++],oe[a++]=oe[H++],U-=3;while(U>2);U&&(oe[a++]=oe[H++],U>1&&(oe[a++]=oe[H++]))}}else if((O&64)===0){N=A[(N&65535)+(x&(1<<O)-1)];continue r}else{e.msg="invalid distance code",Q.mode=ew;break e}break}}else if((O&64)===0){N=T[(N&65535)+(x&(1<<O)-1)];continue t}else if(O&32){Q.mode=Tve;break e}else{e.msg="invalid literal/length code",Q.mode=ew;break e}break}}while(n<i&&a<o);U=E>>3,n-=U,E-=U<<3,x&=(1<<E)-1,e.next_in=n,e.next_out=a,e.avail_in=n<i?5+(i-n):5-(n-i),e.avail_out=a<o?257+(o-a):257-(a-o),Q.hold=x,Q.bits=E};const gv=15,Iz=852,Pz=592,kz=0,EA=1,Rz=2,Ave=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),Ive=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),Pve=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),kve=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]),Rve=(t,e,r,n,i,a,s,o)=>{const c=o.bits;let f=0,d=0,m=0,b=0,x=0,E=0,T=0,A=0,M=0,F=0,N,O,U,j,H,W=null,X;const oe=new Uint16Array(gv+1),Q=new Uint16Array(gv+1);let G=null,ae,se,fe;for(f=0;f<=gv;f++)oe[f]=0;for(d=0;d<n;d++)oe[e[r+d]]++;for(x=c,b=gv;b>=1&&oe[b]===0;b--);if(x>b&&(x=b),b===0)return i[a++]=1<<24|64<<16|0,i[a++]=1<<24|64<<16|0,o.bits=1,0;for(m=1;m<b&&oe[m]===0;m++);for(x<m&&(x=m),A=1,f=1;f<=gv;f++)if(A<<=1,A-=oe[f],A<0)return-1;if(A>0&&(t===kz||b!==1))return-1;for(Q[1]=0,f=1;f<gv;f++)Q[f+1]=Q[f]+oe[f];for(d=0;d<n;d++)e[r+d]!==0&&(s[Q[e[r+d]]++]=d);if(t===kz?(W=G=s,X=20):t===EA?(W=Ave,G=Ive,X=257):(W=Pve,G=kve,X=0),F=0,d=0,f=m,H=a,E=x,T=0,U=-1,M=1<<x,j=M-1,t===EA&&M>Iz||t===Rz&&M>Pz)return 1;for(;;){ae=f-T,s[d]+1<X?(se=0,fe=s[d]):s[d]>=X?(se=G[s[d]-X],fe=W[s[d]-X]):(se=96,fe=0),N=1<<f-T,O=1<<E,m=O;do O-=N,i[H+(F>>T)+O]=ae<<24|se<<16|fe|0;while(O!==0);for(N=1<<f-1;F&N;)N>>=1;if(N!==0?(F&=N-1,F+=N):F=0,d++,--oe[f]===0){if(f===b)break;f=e[r+s[d]]}if(f>x&&(F&j)!==U){for(T===0&&(T=x),H+=m,E=f-T,A=1<<E;E+T<b&&(A-=oe[E+T],!(A<=0));)E++,A<<=1;if(M+=1<<E,t===EA&&M>Iz||t===Rz&&M>Pz)return 1;U=F&j,i[U]=x<<24|E<<16|H-a|0}}return F!==0&&(i[H+F]=f-T<<24|64<<16|0),o.bits=x,0};var hb=Rve;const Mve=0,jY=1,UY=2,{Z_FINISH:Mz,Z_BLOCK:Dve,Z_TREES:tw,Z_OK:Jm,Z_STREAM_END:Ove,Z_NEED_DICT:Nve,Z_STREAM_ERROR:Wf,Z_DATA_ERROR:VY,Z_MEM_ERROR:$Y,Z_BUF_ERROR:Lve,Z_DEFLATED:Dz}=FY,t3=16180,Oz=16181,Nz=16182,Lz=16183,Fz=16184,Bz=16185,zz=16186,jz=16187,Uz=16188,Vz=16189,JS=16190,ep=16191,TA=16192,$z=16193,CA=16194,qz=16195,Hz=16196,Gz=16197,Wz=16198,rw=16199,nw=16200,Xz=16201,Yz=16202,Zz=16203,Kz=16204,Jz=16205,AA=16206,Qz=16207,e9=16208,ls=16209,qY=16210,HY=16211,Fve=852,Bve=592,zve=15,jve=zve,t9=t=>(t>>>24&255)+(t>>>8&65280)+((t&65280)<<8)+((t&255)<<24);function Uve(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const xy=t=>{if(!t)return 1;const e=t.state;return!e||e.strm!==t||e.mode<t3||e.mode>HY?1:0},GY=t=>{if(xy(t))return Wf;const e=t.state;return t.total_in=t.total_out=e.total=0,t.msg="",e.wrap&&(t.adler=e.wrap&1),e.mode=t3,e.last=0,e.havedict=0,e.flags=-1,e.dmax=32768,e.head=null,e.hold=0,e.bits=0,e.lencode=e.lendyn=new Int32Array(Fve),e.distcode=e.distdyn=new Int32Array(Bve),e.sane=1,e.back=-1,Jm},WY=t=>{if(xy(t))return Wf;const e=t.state;return e.wsize=0,e.whave=0,e.wnext=0,GY(t)},XY=(t,e)=>{let r;if(xy(t))return Wf;const n=t.state;return e<0?(r=0,e=-e):(r=(e>>4)+5,e<48&&(e&=15)),e&&(e<8||e>15)?Wf:(n.window!==null&&n.wbits!==e&&(n.window=null),n.wrap=r,n.wbits=e,WY(t))},YY=(t,e)=>{if(!t)return Wf;const r=new Uve;t.state=r,r.strm=t,r.window=null,r.mode=t3;const n=XY(t,e);return n!==Jm&&(t.state=null),n},Vve=t=>YY(t,jve);let r9=!0,IA,PA;const $ve=t=>{if(r9){IA=new Int32Array(512),PA=new Int32Array(32);let e=0;for(;e<144;)t.lens[e++]=8;for(;e<256;)t.lens[e++]=9;for(;e<280;)t.lens[e++]=7;for(;e<288;)t.lens[e++]=8;for(hb(jY,t.lens,0,288,IA,0,t.work,{bits:9}),e=0;e<32;)t.lens[e++]=5;hb(UY,t.lens,0,32,PA,0,t.work,{bits:5}),r9=!1}t.lencode=IA,t.lenbits=9,t.distcode=PA,t.distbits=5},ZY=(t,e,r,n)=>{let i;const a=t.state;return a.window===null&&(a.wsize=1<<a.wbits,a.wnext=0,a.whave=0,a.window=new Uint8Array(a.wsize)),n>=a.wsize?(a.window.set(e.subarray(r-a.wsize,r),0),a.wnext=0,a.whave=a.wsize):(i=a.wsize-a.wnext,i>n&&(i=n),a.window.set(e.subarray(r-n,r-n+i),a.wnext),n-=i,n?(a.window.set(e.subarray(r-n,r),0),a.wnext=n,a.whave=a.wsize):(a.wnext+=i,a.wnext===a.wsize&&(a.wnext=0),a.whave<a.wsize&&(a.whave+=i))),0},qve=(t,e)=>{let r,n,i,a,s,o,c,f,d,m,b,x,E,T,A=0,M,F,N,O,U,j,H,W;const X=new Uint8Array(4);let oe,Q;const G=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(xy(t)||!t.output||!t.input&&t.avail_in!==0)return Wf;r=t.state,r.mode===ep&&(r.mode=TA),s=t.next_out,i=t.output,c=t.avail_out,a=t.next_in,n=t.input,o=t.avail_in,f=r.hold,d=r.bits,m=o,b=c,W=Jm;e:for(;;)switch(r.mode){case t3:if(r.wrap===0){r.mode=TA;break}for(;d<16;){if(o===0)break e;o--,f+=n[a++]<<d,d+=8}if(r.wrap&2&&f===35615){r.wbits===0&&(r.wbits=15),r.check=0,X[0]=f&255,X[1]=f>>>8&255,r.check=rd(r.check,X,2,0),f=0,d=0,r.mode=Oz;break}if(r.head&&(r.head.done=!1),!(r.wrap&1)||(((f&255)<<8)+(f>>8))%31){t.msg="incorrect header check",r.mode=ls;break}if((f&15)!==Dz){t.msg="unknown compression method",r.mode=ls;break}if(f>>>=4,d-=4,H=(f&15)+8,r.wbits===0&&(r.wbits=H),H>15||H>r.wbits){t.msg="invalid window size",r.mode=ls;break}r.dmax=1<<r.wbits,r.flags=0,t.adler=r.check=1,r.mode=f&512?Vz:ep,f=0,d=0;break;case Oz:for(;d<16;){if(o===0)break e;o--,f+=n[a++]<<d,d+=8}if(r.flags=f,(r.flags&255)!==Dz){t.msg="unknown compression method",r.mode=ls;break}if(r.flags&57344){t.msg="unknown header flags set",r.mode=ls;break}r.head&&(r.head.text=f>>8&1),r.flags&512&&r.wrap&4&&(X[0]=f&255,X[1]=f>>>8&255,r.check=rd(r.check,X,2,0)),f=0,d=0,r.mode=Nz;case Nz:for(;d<32;){if(o===0)break e;o--,f+=n[a++]<<d,d+=8}r.head&&(r.head.time=f),r.flags&512&&r.wrap&4&&(X[0]=f&255,X[1]=f>>>8&255,X[2]=f>>>16&255,X[3]=f>>>24&255,r.check=rd(r.check,X,4,0)),f=0,d=0,r.mode=Lz;case Lz:for(;d<16;){if(o===0)break e;o--,f+=n[a++]<<d,d+=8}r.head&&(r.head.xflags=f&255,r.head.os=f>>8),r.flags&512&&r.wrap&4&&(X[0]=f&255,X[1]=f>>>8&255,r.check=rd(r.check,X,2,0)),f=0,d=0,r.mode=Fz;case Fz:if(r.flags&1024){for(;d<16;){if(o===0)break e;o--,f+=n[a++]<<d,d+=8}r.length=f,r.head&&(r.head.extra_len=f),r.flags&512&&r.wrap&4&&(X[0]=f&255,X[1]=f>>>8&255,r.check=rd(r.check,X,2,0)),f=0,d=0}else r.head&&(r.head.extra=null);r.mode=Bz;case Bz:if(r.flags&1024&&(x=r.length,x>o&&(x=o),x&&(r.head&&(H=r.head.extra_len-r.length,r.head.extra||(r.head.extra=new Uint8Array(r.head.extra_len)),r.head.extra.set(n.subarray(a,a+x),H)),r.flags&512&&r.wrap&4&&(r.check=rd(r.check,n,x,a)),o-=x,a+=x,r.length-=x),r.length))break e;r.length=0,r.mode=zz;case zz:if(r.flags&2048){if(o===0)break e;x=0;do H=n[a+x++],r.head&&H&&r.length<65536&&(r.head.name+=String.fromCharCode(H));while(H&&x<o);if(r.flags&512&&r.wrap&4&&(r.check=rd(r.check,n,x,a)),o-=x,a+=x,H)break e}else r.head&&(r.head.name=null);r.length=0,r.mode=jz;case jz:if(r.flags&4096){if(o===0)break e;x=0;do H=n[a+x++],r.head&&H&&r.length<65536&&(r.head.comment+=String.fromCharCode(H));while(H&&x<o);if(r.flags&512&&r.wrap&4&&(r.check=rd(r.check,n,x,a)),o-=x,a+=x,H)break e}else r.head&&(r.head.comment=null);r.mode=Uz;case Uz:if(r.flags&512){for(;d<16;){if(o===0)break e;o--,f+=n[a++]<<d,d+=8}if(r.wrap&4&&f!==(r.check&65535)){t.msg="header crc mismatch",r.mode=ls;break}f=0,d=0}r.head&&(r.head.hcrc=r.flags>>9&1,r.head.done=!0),t.adler=r.check=0,r.mode=ep;break;case Vz:for(;d<32;){if(o===0)break e;o--,f+=n[a++]<<d,d+=8}t.adler=r.check=t9(f),f=0,d=0,r.mode=JS;case JS:if(r.havedict===0)return t.next_out=s,t.avail_out=c,t.next_in=a,t.avail_in=o,r.hold=f,r.bits=d,Nve;t.adler=r.check=1,r.mode=ep;case ep:if(e===Dve||e===tw)break e;case TA:if(r.last){f>>>=d&7,d-=d&7,r.mode=AA;break}for(;d<3;){if(o===0)break e;o--,f+=n[a++]<<d,d+=8}switch(r.last=f&1,f>>>=1,d-=1,f&3){case 0:r.mode=$z;break;case 1:if($ve(r),r.mode=rw,e===tw){f>>>=2,d-=2;break e}break;case 2:r.mode=Hz;break;case 3:t.msg="invalid block type",r.mode=ls}f>>>=2,d-=2;break;case $z:for(f>>>=d&7,d-=d&7;d<32;){if(o===0)break e;o--,f+=n[a++]<<d,d+=8}if((f&65535)!==(f>>>16^65535)){t.msg="invalid stored block lengths",r.mode=ls;break}if(r.length=f&65535,f=0,d=0,r.mode=CA,e===tw)break e;case CA:r.mode=qz;case qz:if(x=r.length,x){if(x>o&&(x=o),x>c&&(x=c),x===0)break e;i.set(n.subarray(a,a+x),s),o-=x,a+=x,c-=x,s+=x,r.length-=x;break}r.mode=ep;break;case Hz:for(;d<14;){if(o===0)break e;o--,f+=n[a++]<<d,d+=8}if(r.nlen=(f&31)+257,f>>>=5,d-=5,r.ndist=(f&31)+1,f>>>=5,d-=5,r.ncode=(f&15)+4,f>>>=4,d-=4,r.nlen>286||r.ndist>30){t.msg="too many length or distance symbols",r.mode=ls;break}r.have=0,r.mode=Gz;case Gz:for(;r.have<r.ncode;){for(;d<3;){if(o===0)break e;o--,f+=n[a++]<<d,d+=8}r.lens[G[r.have++]]=f&7,f>>>=3,d-=3}for(;r.have<19;)r.lens[G[r.have++]]=0;if(r.lencode=r.lendyn,r.lenbits=7,oe={bits:r.lenbits},W=hb(Mve,r.lens,0,19,r.lencode,0,r.work,oe),r.lenbits=oe.bits,W){t.msg="invalid code lengths set",r.mode=ls;break}r.have=0,r.mode=Wz;case Wz:for(;r.have<r.nlen+r.ndist;){for(;A=r.lencode[f&(1<<r.lenbits)-1],M=A>>>24,F=A>>>16&255,N=A&65535,!(M<=d);){if(o===0)break e;o--,f+=n[a++]<<d,d+=8}if(N<16)f>>>=M,d-=M,r.lens[r.have++]=N;else{if(N===16){for(Q=M+2;d<Q;){if(o===0)break e;o--,f+=n[a++]<<d,d+=8}if(f>>>=M,d-=M,r.have===0){t.msg="invalid bit length repeat",r.mode=ls;break}H=r.lens[r.have-1],x=3+(f&3),f>>>=2,d-=2}else if(N===17){for(Q=M+3;d<Q;){if(o===0)break e;o--,f+=n[a++]<<d,d+=8}f>>>=M,d-=M,H=0,x=3+(f&7),f>>>=3,d-=3}else{for(Q=M+7;d<Q;){if(o===0)break e;o--,f+=n[a++]<<d,d+=8}f>>>=M,d-=M,H=0,x=11+(f&127),f>>>=7,d-=7}if(r.have+x>r.nlen+r.ndist){t.msg="invalid bit length repeat",r.mode=ls;break}for(;x--;)r.lens[r.have++]=H}}if(r.mode===ls)break;if(r.lens[256]===0){t.msg="invalid code -- missing end-of-block",r.mode=ls;break}if(r.lenbits=9,oe={bits:r.lenbits},W=hb(jY,r.lens,0,r.nlen,r.lencode,0,r.work,oe),r.lenbits=oe.bits,W){t.msg="invalid literal/lengths set",r.mode=ls;break}if(r.distbits=6,r.distcode=r.distdyn,oe={bits:r.distbits},W=hb(UY,r.lens,r.nlen,r.ndist,r.distcode,0,r.work,oe),r.distbits=oe.bits,W){t.msg="invalid distances set",r.mode=ls;break}if(r.mode=rw,e===tw)break e;case rw:r.mode=nw;case nw:if(o>=6&&c>=258){t.next_out=s,t.avail_out=c,t.next_in=a,t.avail_in=o,r.hold=f,r.bits=d,Cve(t,b),s=t.next_out,i=t.output,c=t.avail_out,a=t.next_in,n=t.input,o=t.avail_in,f=r.hold,d=r.bits,r.mode===ep&&(r.back=-1);break}for(r.back=0;A=r.lencode[f&(1<<r.lenbits)-1],M=A>>>24,F=A>>>16&255,N=A&65535,!(M<=d);){if(o===0)break e;o--,f+=n[a++]<<d,d+=8}if(F&&(F&240)===0){for(O=M,U=F,j=N;A=r.lencode[j+((f&(1<<O+U)-1)>>O)],M=A>>>24,F=A>>>16&255,N=A&65535,!(O+M<=d);){if(o===0)break e;o--,f+=n[a++]<<d,d+=8}f>>>=O,d-=O,r.back+=O}if(f>>>=M,d-=M,r.back+=M,r.length=N,F===0){r.mode=Jz;break}if(F&32){r.back=-1,r.mode=ep;break}if(F&64){t.msg="invalid literal/length code",r.mode=ls;break}r.extra=F&15,r.mode=Xz;case Xz:if(r.extra){for(Q=r.extra;d<Q;){if(o===0)break e;o--,f+=n[a++]<<d,d+=8}r.length+=f&(1<<r.extra)-1,f>>>=r.extra,d-=r.extra,r.back+=r.extra}r.was=r.length,r.mode=Yz;case Yz:for(;A=r.distcode[f&(1<<r.distbits)-1],M=A>>>24,F=A>>>16&255,N=A&65535,!(M<=d);){if(o===0)break e;o--,f+=n[a++]<<d,d+=8}if((F&240)===0){for(O=M,U=F,j=N;A=r.distcode[j+((f&(1<<O+U)-1)>>O)],M=A>>>24,F=A>>>16&255,N=A&65535,!(O+M<=d);){if(o===0)break e;o--,f+=n[a++]<<d,d+=8}f>>>=O,d-=O,r.back+=O}if(f>>>=M,d-=M,r.back+=M,F&64){t.msg="invalid distance code",r.mode=ls;break}r.offset=N,r.extra=F&15,r.mode=Zz;case Zz:if(r.extra){for(Q=r.extra;d<Q;){if(o===0)break e;o--,f+=n[a++]<<d,d+=8}r.offset+=f&(1<<r.extra)-1,f>>>=r.extra,d-=r.extra,r.back+=r.extra}if(r.offset>r.dmax){t.msg="invalid distance too far back",r.mode=ls;break}r.mode=Kz;case Kz:if(c===0)break e;if(x=b-c,r.offset>x){if(x=r.offset-x,x>r.whave&&r.sane){t.msg="invalid distance too far back",r.mode=ls;break}x>r.wnext?(x-=r.wnext,E=r.wsize-x):E=r.wnext-x,x>r.length&&(x=r.length),T=r.window}else T=i,E=s-r.offset,x=r.length;x>c&&(x=c),c-=x,r.length-=x;do i[s++]=T[E++];while(--x);r.length===0&&(r.mode=nw);break;case Jz:if(c===0)break e;i[s++]=r.length,c--,r.mode=nw;break;case AA:if(r.wrap){for(;d<32;){if(o===0)break e;o--,f|=n[a++]<<d,d+=8}if(b-=c,t.total_out+=b,r.total+=b,r.wrap&4&&b&&(t.adler=r.check=r.flags?rd(r.check,i,b,s-b):Kk(r.check,i,b,s-b)),b=c,r.wrap&4&&(r.flags?f:t9(f))!==r.check){t.msg="incorrect data check",r.mode=ls;break}f=0,d=0}r.mode=Qz;case Qz:if(r.wrap&&r.flags){for(;d<32;){if(o===0)break e;o--,f+=n[a++]<<d,d+=8}if(r.wrap&4&&f!==(r.total&4294967295)){t.msg="incorrect length check",r.mode=ls;break}f=0,d=0}r.mode=e9;case e9:W=Ove;break e;case ls:W=VY;break e;case qY:return $Y;case HY:default:return Wf}return t.next_out=s,t.avail_out=c,t.next_in=a,t.avail_in=o,r.hold=f,r.bits=d,(r.wsize||b!==t.avail_out&&r.mode<ls&&(r.mode<AA||e!==Mz))&&ZY(t,t.output,t.next_out,b-t.avail_out),m-=t.avail_in,b-=t.avail_out,t.total_in+=m,t.total_out+=b,r.total+=b,r.wrap&4&&b&&(t.adler=r.check=r.flags?rd(r.check,i,b,t.next_out-b):Kk(r.check,i,b,t.next_out-b)),t.data_type=r.bits+(r.last?64:0)+(r.mode===ep?128:0)+(r.mode===rw||r.mode===CA?256:0),(m===0&&b===0||e===Mz)&&W===Jm&&(W=Lve),W},Hve=t=>{if(xy(t))return Wf;let e=t.state;return e.window&&(e.window=null),t.state=null,Jm},Gve=(t,e)=>{if(xy(t))return Wf;const r=t.state;return(r.wrap&2)===0?Wf:(r.head=e,e.done=!1,Jm)},Wve=(t,e)=>{const r=e.length;let n,i,a;return xy(t)||(n=t.state,n.wrap!==0&&n.mode!==JS)?Wf:n.mode===JS&&(i=1,i=Kk(i,e,r,0),i!==n.check)?VY:(a=ZY(t,e,r,r),a?(n.mode=qY,$Y):(n.havedict=1,Jm))};var Xve=WY,Yve=XY,Zve=GY,Kve=Vve,Jve=YY,Qve=qve,e0e=Hve,t0e=Gve,r0e=Wve,n0e="pako inflate (from Nodeca project)",ap={inflateReset:Xve,inflateReset2:Yve,inflateResetKeep:Zve,inflateInit:Kve,inflateInit2:Jve,inflate:Qve,inflateEnd:e0e,inflateGetHeader:t0e,inflateSetDictionary:r0e,inflateInfo:n0e};function i0e(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}var a0e=i0e;const KY=Object.prototype.toString,{Z_NO_FLUSH:o0e,Z_FINISH:s0e,Z_OK:$b,Z_STREAM_END:kA,Z_NEED_DICT:RA,Z_STREAM_ERROR:l0e,Z_DATA_ERROR:n9,Z_MEM_ERROR:u0e}=FY;function Lx(t){this.options=BY.assign({chunkSize:1024*64,windowBits:15,to:""},t||{});const e=this.options;e.raw&&e.windowBits>=0&&e.windowBits<16&&(e.windowBits=-e.windowBits,e.windowBits===0&&(e.windowBits=-15)),e.windowBits>=0&&e.windowBits<16&&!(t&&t.windowBits)&&(e.windowBits+=32),e.windowBits>15&&e.windowBits<48&&(e.windowBits&15)===0&&(e.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new Eve,this.strm.avail_out=0;let r=ap.inflateInit2(this.strm,e.windowBits);if(r!==$b)throw new Error(Jk[r]);if(this.header=new a0e,ap.inflateGetHeader(this.strm,this.header),e.dictionary&&(typeof e.dictionary=="string"?e.dictionary=Qk.string2buf(e.dictionary):KY.call(e.dictionary)==="[object ArrayBuffer]"&&(e.dictionary=new Uint8Array(e.dictionary)),e.raw&&(r=ap.inflateSetDictionary(this.strm,e.dictionary),r!==$b)))throw new Error(Jk[r])}Lx.prototype.push=function(t,e){const r=this.strm,n=this.options.chunkSize,i=this.options.dictionary;let a,s,o;if(this.ended)return!1;for(e===~~e?s=e:s=e===!0?s0e:o0e,KY.call(t)==="[object ArrayBuffer]"?r.input=new Uint8Array(t):r.input=t,r.next_in=0,r.avail_in=r.input.length;;){for(r.avail_out===0&&(r.output=new Uint8Array(n),r.next_out=0,r.avail_out=n),a=ap.inflate(r,s),a===RA&&i&&(a=ap.inflateSetDictionary(r,i),a===$b?a=ap.inflate(r,s):a===n9&&(a=RA));r.avail_in>0&&a===kA&&r.state.wrap>0&&t[r.next_in]!==0;)ap.inflateReset(r),a=ap.inflate(r,s);switch(a){case l0e:case n9:case RA:case u0e:return this.onEnd(a),this.ended=!0,!1}if(o=r.avail_out,r.next_out&&(r.avail_out===0||a===kA))if(this.options.to==="string"){let c=Qk.utf8border(r.output,r.next_out),f=r.next_out-c,d=Qk.buf2string(r.output,c);r.next_out=f,r.avail_out=n-f,f&&r.output.set(r.output.subarray(c,c+f),0),this.onData(d)}else this.onData(r.output.length===r.next_out?r.output:r.output.subarray(0,r.next_out));if(!(a===$b&&o===0)){if(a===kA)return a=ap.inflateEnd(this.strm),this.onEnd(a),this.ended=!0,!0;if(r.avail_in===0)break}}return!0};Lx.prototype.onData=function(t){this.chunks.push(t)};Lx.prototype.onEnd=function(t){t===$b&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=BY.flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg};function c0e(t,e){const r=new Lx(e);if(r.push(t),r.err)throw r.msg||Jk[r.err];return r.result}var f0e=Lx,h0e=c0e,d0e={Inflate:f0e,inflate:h0e};const{Inflate:p0e,inflate:g0e}=d0e;var i9=p0e,m0e=g0e;const JY=[];for(let t=0;t<256;t++){let e=t;for(let r=0;r<8;r++)e&1?e=3988292384^e>>>1:e=e>>>1;JY[t]=e}const a9=4294967295;function y0e(t,e,r){let n=t;for(let i=0;i<r;i++)n=JY[(n^e[i])&255]^n>>>8;return n}function v0e(t,e){return(y0e(a9,t,e)^a9)>>>0}function o9(t,e,r){const n=t.readUint32(),i=v0e(new Uint8Array(t.buffer,t.byteOffset+t.offset-e-4,e),e);if(i!==n)throw new Error(`CRC mismatch for chunk ${r}. Expected ${n}, found ${i}`)}function QY(t,e,r){for(let n=0;n<r;n++)e[n]=t[n]}function eZ(t,e,r,n){let i=0;for(;i<n;i++)e[i]=t[i];for(;i<r;i++)e[i]=t[i]+e[i-n]&255}function tZ(t,e,r,n){let i=0;if(r.length===0)for(;i<n;i++)e[i]=t[i];else for(;i<n;i++)e[i]=t[i]+r[i]&255}function rZ(t,e,r,n,i){let a=0;if(r.length===0){for(;a<i;a++)e[a]=t[a];for(;a<n;a++)e[a]=t[a]+(e[a-i]>>1)&255}else{for(;a<i;a++)e[a]=t[a]+(r[a]>>1)&255;for(;a<n;a++)e[a]=t[a]+(e[a-i]+r[a]>>1)&255}}function nZ(t,e,r,n,i){let a=0;if(r.length===0){for(;a<i;a++)e[a]=t[a];for(;a<n;a++)e[a]=t[a]+e[a-i]&255}else{for(;a<i;a++)e[a]=t[a]+r[a]&255;for(;a<n;a++)e[a]=t[a]+_0e(e[a-i],r[a],r[a-i])&255}}function _0e(t,e,r){const n=t+e-r,i=Math.abs(n-t),a=Math.abs(n-e),s=Math.abs(n-r);return i<=a&&i<=s?t:a<=s?e:r}function b0e(t,e,r,n,i,a){switch(t){case 0:QY(e,r,i);break;case 1:eZ(e,r,i,a);break;case 2:tZ(e,r,n,i);break;case 3:rZ(e,r,n,i,a);break;case 4:nZ(e,r,n,i,a);break;default:throw new Error(`Unsupported filter: ${t}`)}}const x0e=new Uint16Array([255]),w0e=new Uint8Array(x0e.buffer),S0e=w0e[0]===255;function E0e(t){const{data:e,width:r,height:n,channels:i,depth:a}=t,s=[{x:0,y:0,xStep:8,yStep:8},{x:4,y:0,xStep:8,yStep:8},{x:0,y:4,xStep:4,yStep:8},{x:2,y:0,xStep:4,yStep:4},{x:0,y:2,xStep:2,yStep:4},{x:1,y:0,xStep:2,yStep:2},{x:0,y:1,xStep:1,yStep:2}],o=Math.ceil(a/8)*i,c=new Uint8Array(n*r*o);let f=0;for(let d=0;d<7;d++){const m=s[d],b=Math.ceil((r-m.x)/m.xStep),x=Math.ceil((n-m.y)/m.yStep);if(b<=0||x<=0)continue;const E=b*o,T=new Uint8Array(E);for(let A=0;A<x;A++){const M=e[f++],F=e.subarray(f,f+E);f+=E;const N=new Uint8Array(E);b0e(M,F,N,T,E,o),T.set(N);for(let O=0;O<b;O++){const U=m.x+O*m.xStep,j=m.y+A*m.yStep;if(!(U>=r||j>=n))for(let H=0;H<o;H++)c[(j*r+U)*o+H]=N[O*o+H]}}}if(a===16){const d=new Uint16Array(c.buffer);if(S0e)for(let m=0;m<d.length;m++)d[m]=T0e(d[m]);return d}else return c}function T0e(t){return(t&255)<<8|t>>8&255}const C0e=new Uint16Array([255]),A0e=new Uint8Array(C0e.buffer),I0e=A0e[0]===255,P0e=new Uint8Array(0);function s9(t){const{data:e,width:r,height:n,channels:i,depth:a}=t,s=Math.ceil(a/8)*i,o=Math.ceil(a/8*i*r),c=new Uint8Array(n*o);let f=P0e,d=0,m,b;for(let x=0;x<n;x++){switch(m=e.subarray(d+1,d+1+o),b=c.subarray(x*o,(x+1)*o),e[d]){case 0:QY(m,b,o);break;case 1:eZ(m,b,o,s);break;case 2:tZ(m,b,f,o);break;case 3:rZ(m,b,f,o,s);break;case 4:nZ(m,b,f,o,s);break;default:throw new Error(`Unsupported filter: ${e[d]}`)}f=b,d+=o+1}if(a===16){const x=new Uint16Array(c.buffer);if(I0e)for(let E=0;E<x.length;E++)x[E]=k0e(x[E]);return x}else return c}function k0e(t){return(t&255)<<8|t>>8&255}const fS=Uint8Array.of(137,80,78,71,13,10,26,10);function l9(t){if(!R0e(t.readBytes(fS.length)))throw new Error("wrong PNG signature")}function R0e(t){if(t.length<fS.length)return!1;for(let e=0;e<fS.length;e++)if(t[e]!==fS[e])return!1;return!0}const M0e="tEXt",D0e=0,iZ=new TextDecoder("latin1");function O0e(t){if(L0e(t),t.length===0||t.length>79)throw new Error("keyword length must be between 1 and 79")}const N0e=/^[\u0000-\u00FF]*$/;function L0e(t){if(!N0e.test(t))throw new Error("invalid latin1 text")}function F0e(t,e,r){const n=aZ(e);t[n]=B0e(e,r-n.length-1)}function aZ(t){for(t.mark();t.readByte()!==D0e;);const e=t.offset;t.reset();const r=iZ.decode(t.readBytes(e-t.offset-1));return t.skip(1),O0e(r),r}function B0e(t,e){return iZ.decode(t.readBytes(e))}const Qc={UNKNOWN:-1,GREYSCALE:0,TRUECOLOUR:2,INDEXED_COLOUR:3,GREYSCALE_ALPHA:4,TRUECOLOUR_ALPHA:6},MA={UNKNOWN:-1,DEFLATE:0},u9={UNKNOWN:-1,ADAPTIVE:0},DA={UNKNOWN:-1,NO_INTERLACE:0,ADAM7:1},iw={NONE:0,BACKGROUND:1,PREVIOUS:2},OA={SOURCE:0,OVER:1};class z0e extends bO{_checkCrc;_inflator;_png;_apng;_end;_hasPalette;_palette;_hasTransparency;_transparency;_compressionMethod;_filterMethod;_interlaceMethod;_colorType;_isAnimated;_numberOfFrames;_numberOfPlays;_frames;_writingDataChunks;constructor(e,r={}){super(e);const{checkCrc:n=!1}=r;this._checkCrc=n,this._inflator=new i9,this._png={width:-1,height:-1,channels:-1,data:new Uint8Array(0),depth:1,text:{}},this._apng={width:-1,height:-1,channels:-1,depth:1,numberOfFrames:1,numberOfPlays:0,text:{},frames:[]},this._end=!1,this._hasPalette=!1,this._palette=[],this._hasTransparency=!1,this._transparency=new Uint16Array(0),this._compressionMethod=MA.UNKNOWN,this._filterMethod=u9.UNKNOWN,this._interlaceMethod=DA.UNKNOWN,this._colorType=Qc.UNKNOWN,this._isAnimated=!1,this._numberOfFrames=1,this._numberOfPlays=0,this._frames=[],this._writingDataChunks=!1,this.setBigEndian()}decode(){for(l9(this);!this._end;){const e=this.readUint32(),r=this.readChars(4);this.decodeChunk(e,r)}return this.decodeImage(),this._png}decodeApng(){for(l9(this);!this._end;){const e=this.readUint32(),r=this.readChars(4);this.decodeApngChunk(e,r)}return this.decodeApngImage(),this._apng}decodeChunk(e,r){const n=this.offset;switch(r){case"IHDR":this.decodeIHDR();break;case"PLTE":this.decodePLTE(e);break;case"IDAT":this.decodeIDAT(e);break;case"IEND":this._end=!0;break;case"tRNS":this.decodetRNS(e);break;case"iCCP":this.decodeiCCP(e);break;case M0e:F0e(this._png.text,this,e);break;case"pHYs":this.decodepHYs();break;default:this.skip(e);break}if(this.offset-n!==e)throw new Error(`Length mismatch while decoding chunk ${r}`);this._checkCrc?o9(this,e+4,r):this.skip(4)}decodeApngChunk(e,r){const n=this.offset;switch(r!=="fdAT"&&r!=="IDAT"&&this._writingDataChunks&&this.pushDataToFrame(),r){case"acTL":this.decodeACTL();break;case"fcTL":this.decodeFCTL();break;case"fdAT":this.decodeFDAT(e);break;default:this.decodeChunk(e,r),this.offset=n+e;break}if(this.offset-n!==e)throw new Error(`Length mismatch while decoding chunk ${r}`);this._checkCrc?o9(this,e+4,r):this.skip(4)}decodeIHDR(){const e=this._png;e.width=this.readUint32(),e.height=this.readUint32(),e.depth=j0e(this.readUint8());const r=this.readUint8();this._colorType=r;let n;switch(r){case Qc.GREYSCALE:n=1;break;case Qc.TRUECOLOUR:n=3;break;case Qc.INDEXED_COLOUR:n=1;break;case Qc.GREYSCALE_ALPHA:n=2;break;case Qc.TRUECOLOUR_ALPHA:n=4;break;case Qc.UNKNOWN:default:throw new Error(`Unknown color type: ${r}`)}if(this._png.channels=n,this._compressionMethod=this.readUint8(),this._compressionMethod!==MA.DEFLATE)throw new Error(`Unsupported compression method: ${this._compressionMethod}`);this._filterMethod=this.readUint8(),this._interlaceMethod=this.readUint8()}decodeACTL(){this._numberOfFrames=this.readUint32(),this._numberOfPlays=this.readUint32(),this._isAnimated=!0}decodeFCTL(){const e={sequenceNumber:this.readUint32(),width:this.readUint32(),height:this.readUint32(),xOffset:this.readUint32(),yOffset:this.readUint32(),delayNumber:this.readUint16(),delayDenominator:this.readUint16(),disposeOp:this.readUint8(),blendOp:this.readUint8(),data:new Uint8Array(0)};this._frames.push(e)}decodePLTE(e){if(e%3!==0)throw new RangeError(`PLTE field length must be a multiple of 3. Got ${e}`);const r=e/3;this._hasPalette=!0;const n=[];this._palette=n;for(let i=0;i<r;i++)n.push([this.readUint8(),this.readUint8(),this.readUint8()])}decodeIDAT(e){this._writingDataChunks=!0;const r=e,n=this.offset+this.byteOffset;if(this._inflator.push(new Uint8Array(this.buffer,n,r)),this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);this.skip(e)}decodeFDAT(e){this._writingDataChunks=!0;let r=e,n=this.offset+this.byteOffset;if(n+=4,r-=4,this._inflator.push(new Uint8Array(this.buffer,n,r)),this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);this.skip(e)}decodetRNS(e){switch(this._colorType){case Qc.GREYSCALE:case Qc.TRUECOLOUR:{if(e%2!==0)throw new RangeError(`tRNS chunk length must be a multiple of 2. Got ${e}`);if(e/2>this._png.width*this._png.height)throw new Error(`tRNS chunk contains more alpha values than there are pixels (${e/2} vs ${this._png.width*this._png.height})`);this._hasTransparency=!0,this._transparency=new Uint16Array(e/2);for(let r=0;r<e/2;r++)this._transparency[r]=this.readUint16();break}case Qc.INDEXED_COLOUR:{if(e>this._palette.length)throw new Error(`tRNS chunk contains more alpha values than there are palette colors (${e} vs ${this._palette.length})`);let r=0;for(;r<e;r++){const n=this.readByte();this._palette[r].push(n)}for(;r<this._palette.length;r++)this._palette[r].push(255);break}case Qc.UNKNOWN:case Qc.GREYSCALE_ALPHA:case Qc.TRUECOLOUR_ALPHA:default:throw new Error(`tRNS chunk is not supported for color type ${this._colorType}`)}}decodeiCCP(e){const r=aZ(this),n=this.readUint8();if(n!==MA.DEFLATE)throw new Error(`Unsupported iCCP compression method: ${n}`);const i=this.readBytes(e-r.length-2);this._png.iccEmbeddedProfile={name:r,profile:m0e(i)}}decodepHYs(){const e=this.readUint32(),r=this.readUint32(),n=this.readByte();this._png.resolution={x:e,y:r,unit:n}}decodeApngImage(){this._apng.width=this._png.width,this._apng.height=this._png.height,this._apng.channels=this._png.channels,this._apng.depth=this._png.depth,this._apng.numberOfFrames=this._numberOfFrames,this._apng.numberOfPlays=this._numberOfPlays,this._apng.text=this._png.text,this._apng.resolution=this._png.resolution;for(let e=0;e<this._numberOfFrames;e++){const r={sequenceNumber:this._frames[e].sequenceNumber,delayNumber:this._frames[e].delayNumber,delayDenominator:this._frames[e].delayDenominator,data:this._apng.depth===8?new Uint8Array(this._apng.width*this._apng.height*this._apng.channels):new Uint16Array(this._apng.width*this._apng.height*this._apng.channels)},n=this._frames.at(e);if(n){if(n.data=s9({data:n.data,width:n.width,height:n.height,channels:this._apng.channels,depth:this._apng.depth}),this._hasPalette&&(this._apng.palette=this._palette),this._hasTransparency&&(this._apng.transparency=this._transparency),e===0||n.xOffset===0&&n.yOffset===0&&n.width===this._png.width&&n.height===this._png.height)r.data=n.data;else{const i=this._apng.frames.at(e-1);this.disposeFrame(n,i,r),this.addFrameDataToCanvas(r,n)}this._apng.frames.push(r)}}return this._apng}disposeFrame(e,r,n){switch(e.disposeOp){case iw.NONE:break;case iw.BACKGROUND:for(let i=0;i<this._png.height;i++)for(let a=0;a<this._png.width;a++){const s=(i*e.width+a)*this._png.channels;for(let o=0;o<this._png.channels;o++)n.data[s+o]=0}break;case iw.PREVIOUS:n.data.set(r.data);break;default:throw new Error("Unknown disposeOp")}}addFrameDataToCanvas(e,r){const n=1<<this._png.depth,i=(a,s)=>{const o=((a+r.yOffset)*this._png.width+r.xOffset+s)*this._png.channels,c=(a*r.width+s)*this._png.channels;return{index:o,frameIndex:c}};switch(r.blendOp){case OA.SOURCE:for(let a=0;a<r.height;a++)for(let s=0;s<r.width;s++){const{index:o,frameIndex:c}=i(a,s);for(let f=0;f<this._png.channels;f++)e.data[o+f]=r.data[c+f]}break;case OA.OVER:for(let a=0;a<r.height;a++)for(let s=0;s<r.width;s++){const{index:o,frameIndex:c}=i(a,s);for(let f=0;f<this._png.channels;f++){const d=r.data[c+this._png.channels-1]/n,m=f%(this._png.channels-1)===0?1:r.data[c+f],b=Math.floor(d*m+(1-d)*e.data[o+f]);e.data[o+f]+=b}}break;default:throw new Error("Unknown blendOp")}}decodeImage(){if(this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);const e=this._isAnimated?(this._frames?.at(0)).data:this._inflator.result;if(this._filterMethod!==u9.ADAPTIVE)throw new Error(`Filter method ${this._filterMethod} not supported`);if(this._interlaceMethod===DA.NO_INTERLACE)this._png.data=s9({data:e,width:this._png.width,height:this._png.height,channels:this._png.channels,depth:this._png.depth});else if(this._interlaceMethod===DA.ADAM7)this._png.data=E0e({data:e,width:this._png.width,height:this._png.height,channels:this._png.channels,depth:this._png.depth});else throw new Error(`Interlace method ${this._interlaceMethod} not supported`);this._hasPalette&&(this._png.palette=this._palette),this._hasTransparency&&(this._png.transparency=this._transparency)}pushDataToFrame(){const e=this._inflator.result,r=this._frames.at(-1);r?r.data=e:this._frames.push({sequenceNumber:0,width:this._png.width,height:this._png.height,xOffset:0,yOffset:0,delayNumber:0,delayDenominator:0,disposeOp:iw.NONE,blendOp:OA.SOURCE,data:e}),this._inflator=new i9,this._writingDataChunks=!1}}function j0e(t){if(t!==1&&t!==2&&t!==4&&t!==8&&t!==16)throw new Error(`invalid bit depth: ${t}`);return t}var c9;(function(t){t[t.UNKNOWN=0]="UNKNOWN",t[t.METRE=1]="METRE"})(c9||(c9={}));function U0e(t,e){return new z0e(t,e).decode()}var Oi=(function(){return typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:this})();function NA(){Oi.console&&typeof Oi.console.log=="function"&&Oi.console.log.apply(Oi.console,arguments)}var Ro={log:NA,warn:function(t){Oi.console&&(typeof Oi.console.warn=="function"?Oi.console.warn.apply(Oi.console,arguments):NA.call(null,arguments))},error:function(t){Oi.console&&(typeof Oi.console.error=="function"?Oi.console.error.apply(Oi.console,arguments):NA(t))}};function LA(t,e,r){var n=new XMLHttpRequest;n.open("GET",t),n.responseType="blob",n.onload=function(){_m(n.response,e,r)},n.onerror=function(){Ro.error("could not download file")},n.send()}function f9(t){var e=new XMLHttpRequest;e.open("HEAD",t,!1);try{e.send()}catch{}return e.status>=200&&e.status<=299}function aw(t){try{t.dispatchEvent(new MouseEvent("click"))}catch{var e=document.createEvent("MouseEvents");e.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),t.dispatchEvent(e)}}var _m=Oi.saveAs||((typeof window>"u"?"undefined":ho(window))!=="object"||window!==Oi?function(){}:typeof HTMLAnchorElement<"u"&&"download"in HTMLAnchorElement.prototype?function(t,e,r){var n=Oi.URL||Oi.webkitURL,i=document.createElement("a");e=e||t.name||"download",i.download=e,i.rel="noopener",typeof t=="string"?(i.href=t,i.origin!==location.origin?f9(i.href)?LA(t,e,r):aw(i,i.target="_blank"):aw(i)):(i.href=n.createObjectURL(t),setTimeout(function(){n.revokeObjectURL(i.href)},4e4),setTimeout(function(){aw(i)},0))}:"msSaveOrOpenBlob"in navigator?function(t,e,r){if(e=e||t.name||"download",typeof t=="string")if(f9(t))LA(t,e,r);else{var n=document.createElement("a");n.href=t,n.target="_blank",setTimeout(function(){aw(n)})}else navigator.msSaveOrOpenBlob((function(i,a){return a===void 0?a={autoBom:!1}:ho(a)!=="object"&&(Ro.warn("Deprecated: Expected third argument to be a object"),a={autoBom:!a}),a.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(i.type)?new Blob(["\uFEFF",i],{type:i.type}):i})(t,r),e)}:function(t,e,r,n){if((n=n||open("","_blank"))&&(n.document.title=n.document.body.innerText="downloading..."),typeof t=="string")return LA(t,e,r);var i=t.type==="application/octet-stream",a=/constructor/i.test(Oi.HTMLElement)||Oi.safari,s=/CriOS\/[\d]+/.test(navigator.userAgent);if((s||i&&a)&&(typeof FileReader>"u"?"undefined":ho(FileReader))==="object"){var o=new FileReader;o.onloadend=function(){var d=o.result;d=s?d:d.replace(/^data:[^;]*;/,"data:attachment/file;"),n?n.location.href=d:location=d,n=null},o.readAsDataURL(t)}else{var c=Oi.URL||Oi.webkitURL,f=c.createObjectURL(t);n?n.location=f:location.href=f,n=null,setTimeout(function(){c.revokeObjectURL(f)},4e4)}});/**
 * A class to parse color values
 * @author Stoyan Stefanov <sstoo@gmail.com>
 * {@link   http://www.phpied.com/rgb-color-parser-in-javascript/}
 * @license Use it if you like it
 */function oZ(t){var e;t=t||"",this.ok=!1,t.charAt(0)=="#"&&(t=t.substr(1,6)),t={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"}[t=(t=t.replace(/ /g,"")).toLowerCase()]||t;for(var r=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(o){return[parseInt(o[1]),parseInt(o[2]),parseInt(o[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(o){return[parseInt(o[1],16),parseInt(o[2],16),parseInt(o[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(o){return[parseInt(o[1]+o[1],16),parseInt(o[2]+o[2],16),parseInt(o[3]+o[3],16)]}}],n=0;n<r.length;n++){var i=r[n].re,a=r[n].process,s=i.exec(t);s&&(e=a(s),this.r=e[0],this.g=e[1],this.b=e[2],this.ok=!0)}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toHex=function(){var o=this.r.toString(16),c=this.g.toString(16),f=this.b.toString(16);return o.length==1&&(o="0"+o),c.length==1&&(c="0"+c),f.length==1&&(f="0"+f),"#"+o+c+f}}var hS=Oi.atob.bind(Oi),h9=Oi.btoa.bind(Oi);/**
 * @license
 * Joseph Myers does not specify a particular license for his work.
 *
 * Author: Joseph Myers
 * Accessed from: http://www.myersdaily.org/joseph/javascript/md5.js
 *
 * Modified by: Owen Leong
 */function FA(t,e){var r=t[0],n=t[1],i=t[2],a=t[3];r=Vu(r,n,i,a,e[0],7,-680876936),a=Vu(a,r,n,i,e[1],12,-389564586),i=Vu(i,a,r,n,e[2],17,606105819),n=Vu(n,i,a,r,e[3],22,-1044525330),r=Vu(r,n,i,a,e[4],7,-176418897),a=Vu(a,r,n,i,e[5],12,1200080426),i=Vu(i,a,r,n,e[6],17,-1473231341),n=Vu(n,i,a,r,e[7],22,-45705983),r=Vu(r,n,i,a,e[8],7,1770035416),a=Vu(a,r,n,i,e[9],12,-1958414417),i=Vu(i,a,r,n,e[10],17,-42063),n=Vu(n,i,a,r,e[11],22,-1990404162),r=Vu(r,n,i,a,e[12],7,1804603682),a=Vu(a,r,n,i,e[13],12,-40341101),i=Vu(i,a,r,n,e[14],17,-1502002290),r=$u(r,n=Vu(n,i,a,r,e[15],22,1236535329),i,a,e[1],5,-165796510),a=$u(a,r,n,i,e[6],9,-1069501632),i=$u(i,a,r,n,e[11],14,643717713),n=$u(n,i,a,r,e[0],20,-373897302),r=$u(r,n,i,a,e[5],5,-701558691),a=$u(a,r,n,i,e[10],9,38016083),i=$u(i,a,r,n,e[15],14,-660478335),n=$u(n,i,a,r,e[4],20,-405537848),r=$u(r,n,i,a,e[9],5,568446438),a=$u(a,r,n,i,e[14],9,-1019803690),i=$u(i,a,r,n,e[3],14,-187363961),n=$u(n,i,a,r,e[8],20,1163531501),r=$u(r,n,i,a,e[13],5,-1444681467),a=$u(a,r,n,i,e[2],9,-51403784),i=$u(i,a,r,n,e[7],14,1735328473),r=qu(r,n=$u(n,i,a,r,e[12],20,-1926607734),i,a,e[5],4,-378558),a=qu(a,r,n,i,e[8],11,-2022574463),i=qu(i,a,r,n,e[11],16,1839030562),n=qu(n,i,a,r,e[14],23,-35309556),r=qu(r,n,i,a,e[1],4,-1530992060),a=qu(a,r,n,i,e[4],11,1272893353),i=qu(i,a,r,n,e[7],16,-155497632),n=qu(n,i,a,r,e[10],23,-1094730640),r=qu(r,n,i,a,e[13],4,681279174),a=qu(a,r,n,i,e[0],11,-358537222),i=qu(i,a,r,n,e[3],16,-722521979),n=qu(n,i,a,r,e[6],23,76029189),r=qu(r,n,i,a,e[9],4,-640364487),a=qu(a,r,n,i,e[12],11,-421815835),i=qu(i,a,r,n,e[15],16,530742520),r=Hu(r,n=qu(n,i,a,r,e[2],23,-995338651),i,a,e[0],6,-198630844),a=Hu(a,r,n,i,e[7],10,1126891415),i=Hu(i,a,r,n,e[14],15,-1416354905),n=Hu(n,i,a,r,e[5],21,-57434055),r=Hu(r,n,i,a,e[12],6,1700485571),a=Hu(a,r,n,i,e[3],10,-1894986606),i=Hu(i,a,r,n,e[10],15,-1051523),n=Hu(n,i,a,r,e[1],21,-2054922799),r=Hu(r,n,i,a,e[8],6,1873313359),a=Hu(a,r,n,i,e[15],10,-30611744),i=Hu(i,a,r,n,e[6],15,-1560198380),n=Hu(n,i,a,r,e[13],21,1309151649),r=Hu(r,n,i,a,e[4],6,-145523070),a=Hu(a,r,n,i,e[11],10,-1120210379),i=Hu(i,a,r,n,e[2],15,718787259),n=Hu(n,i,a,r,e[9],21,-343485551),t[0]=dg(r,t[0]),t[1]=dg(n,t[1]),t[2]=dg(i,t[2]),t[3]=dg(a,t[3])}function r3(t,e,r,n,i,a){return e=dg(dg(e,t),dg(n,a)),dg(e<<i|e>>>32-i,r)}function Vu(t,e,r,n,i,a,s){return r3(e&r|~e&n,t,e,i,a,s)}function $u(t,e,r,n,i,a,s){return r3(e&n|r&~n,t,e,i,a,s)}function qu(t,e,r,n,i,a,s){return r3(e^r^n,t,e,i,a,s)}function Hu(t,e,r,n,i,a,s){return r3(r^(e|~n),t,e,i,a,s)}function sZ(t){var e,r=t.length,n=[1732584193,-271733879,-1732584194,271733878];for(e=64;e<=t.length;e+=64)FA(n,V0e(t.substring(e-64,e)));t=t.substring(e-64);var i=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(e=0;e<t.length;e++)i[e>>2]|=t.charCodeAt(e)<<(e%4<<3);if(i[e>>2]|=128<<(e%4<<3),e>55)for(FA(n,i),e=0;e<16;e++)i[e]=0;return i[14]=8*r,FA(n,i),n}function V0e(t){var e,r=[];for(e=0;e<64;e+=4)r[e>>2]=t.charCodeAt(e)+(t.charCodeAt(e+1)<<8)+(t.charCodeAt(e+2)<<16)+(t.charCodeAt(e+3)<<24);return r}var d9="0123456789abcdef".split("");function $0e(t){for(var e="",r=0;r<4;r++)e+=d9[t>>8*r+4&15]+d9[t>>8*r&15];return e}function q0e(t){return String.fromCharCode(255&t,(65280&t)>>8,(16711680&t)>>16,(4278190080&t)>>24)}function eR(t){return sZ(t).map(q0e).join("")}var H0e=(function(t){for(var e=0;e<t.length;e++)t[e]=$0e(t[e]);return t.join("")})(sZ("hello"))!="5d41402abc4b2a76b9719d911017c592";function dg(t,e){if(H0e){var r=(65535&t)+(65535&e);return(t>>16)+(e>>16)+(r>>16)<<16|65535&r}return t+e&4294967295}/**
 * @license
 * FPDF is released under a permissive license: there is no usage restriction.
 * You may embed it freely in your application (commercial or not), with or
 * without modifications.
 *
 * Reference: http://www.fpdf.org/en/script/script37.php
 */function tR(t,e){var r,n,i,a;if(t!==r){for(var s=(i=t,a=1+(256/t.length|0),new Array(a+1).join(i)),o=[],c=0;c<256;c++)o[c]=c;var f=0;for(c=0;c<256;c++){var d=o[c];f=(f+d+s.charCodeAt(c))%256,o[c]=o[f],o[f]=d}r=t,n=o}else o=n;var m=e.length,b=0,x=0,E="";for(c=0;c<m;c++)x=(x+(d=o[b=(b+1)%256]))%256,o[b]=o[x],o[x]=d,s=o[(o[b]+o[x])%256],E+=String.fromCharCode(e.charCodeAt(c)^s);return E}/**
 * @license
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 * Author: Owen Leong (@owenl131)
 * Date: 15 Oct 2020
 * References:
 * https://www.cs.cmu.edu/~dst/Adobe/Gallery/anon21jul01-pdf-encryption.txt
 * https://github.com/foliojs/pdfkit/blob/master/lib/security.js
 * http://www.fpdf.org/en/script/script37.php
 */var p9={print:4,modify:8,copy:16,"annot-forms":32};function Bv(t,e,r,n){this.v=1,this.r=2;var i=192;t.forEach(function(o){if(p9.perm!==void 0)throw new Error("Invalid permission: "+o);i+=p9[o]}),this.padding="(N^NuAd\0NV\b..\0h>/\fdSiz";var a=(e+this.padding).substr(0,32),s=(r+this.padding).substr(0,32);this.O=this.processOwnerPassword(a,s),this.P=-(1+(255^i)),this.encryptionKey=eR(a+this.O+this.lsbFirstWord(this.P)+this.hexToBytes(n)).substr(0,5),this.U=tR(this.encryptionKey,this.padding)}function zv(t){if(/[^\u0000-\u00ff]/.test(t))throw new Error("Invalid PDF Name Object: "+t+", Only accept ASCII characters.");for(var e="",r=t.length,n=0;n<r;n++){var i=t.charCodeAt(n);e+=i<33||i===35||i===37||i===40||i===41||i===47||i===60||i===62||i===91||i===93||i===123||i===125||i>126?"#"+("0"+i.toString(16)).slice(-2):t[n]}return e}function g9(t){if(ho(t)!=="object")throw new Error("Invalid Context passed to initialize PubSub (jsPDF-module)");var e={};this.subscribe=function(r,n,i){if(i=i||!1,typeof r!="string"||typeof n!="function"||typeof i!="boolean")throw new Error("Invalid arguments passed to PubSub.subscribe (jsPDF-module)");e.hasOwnProperty(r)||(e[r]={});var a=Math.random().toString(35);return e[r][a]=[n,!!i],a},this.unsubscribe=function(r){for(var n in e)if(e[n][r])return delete e[n][r],Object.keys(e[n]).length===0&&delete e[n],!0;return!1},this.publish=function(r){if(e.hasOwnProperty(r)){var n=Array.prototype.slice.call(arguments,1),i=[];for(var a in e[r]){var s=e[r][a];try{s[0].apply(t,n)}catch(o){Oi.console&&Ro.error("jsPDF PubSub Error",o.message,o)}s[1]&&i.push(a)}i.length&&i.forEach(this.unsubscribe)}},this.getTopics=function(){return e}}function QS(t){if(!(this instanceof QS))return new QS(t);var e="opacity,stroke-opacity".split(",");for(var r in t)t.hasOwnProperty(r)&&e.indexOf(r)>=0&&(this[r]=t[r]);this.id="",this.objectNumber=-1}function lZ(t,e){this.gState=t,this.matrix=e,this.id="",this.objectNumber=-1}function wm(t,e,r,n,i){if(!(this instanceof wm))return new wm(t,e,r,n,i);this.type=t==="axial"?2:3,this.coords=e,this.colors=r,lZ.call(this,n,i)}function s0(t,e,r,n,i){if(!(this instanceof s0))return new s0(t,e,r,n,i);this.boundingBox=t,this.xStep=e,this.yStep=r,this.stream="",this.cloneIndex=0,lZ.call(this,n,i)}function di(t){var e,r=typeof arguments[0]=="string"?arguments[0]:"p",n=arguments[1],i=arguments[2],a=arguments[3],s=[],o=1,c=16,f="S",d=null;ho(t=t||{})==="object"&&(r=t.orientation,n=t.unit||n,i=t.format||i,a=t.compress||t.compressPdf||a,(d=t.encryption||null)!==null&&(d.userPassword=d.userPassword||"",d.ownerPassword=d.ownerPassword||"",d.userPermissions=d.userPermissions||[]),o=typeof t.userUnit=="number"?Math.abs(t.userUnit):1,t.precision!==void 0&&(e=t.precision),t.floatPrecision!==void 0&&(c=t.floatPrecision),f=t.defaultPathOperation||"S"),s=t.filters||(a===!0?["FlateEncode"]:s),n=n||"mm",r=(""+(r||"P")).toLowerCase();var m=t.putOnlyUsedFonts||!1,b={},x={internal:{},__private__:{}};x.__private__.PubSub=g9;var E="1.3",T=x.__private__.getPdfVersion=function(){return E};x.__private__.setPdfVersion=function(ue){E=ue};var A={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};x.__private__.getPageFormats=function(){return A};var M=x.__private__.getPageFormat=function(ue){return A[ue]};i=i||"a4";var F="compat",N="advanced",O=F;function U(){this.saveGraphicsState(),$e(new un(qe,0,0,-qe,0,Do()*qe).toString()+" cm"),this.setFontSize(this.getFontSize()/qe),f="n",O=N}function j(){this.restoreGraphicsState(),f="S",O=F}var H=x.__private__.combineFontStyleAndFontWeight=function(ue,We){if(ue=="bold"&&We=="normal"||ue=="bold"&&We==400||ue=="normal"&&We=="italic"||ue=="bold"&&We=="italic")throw new Error("Invalid Combination of fontweight and fontstyle");return We&&(ue=We==400||We==="normal"?ue==="italic"?"italic":"normal":We!=700&&We!=="bold"||ue!=="normal"?(We==700?"bold":We)+""+ue:"bold"),ue};x.advancedAPI=function(ue){var We=O===F;return We&&U.call(this),typeof ue!="function"||(ue(this),We&&j.call(this)),this},x.compatAPI=function(ue){var We=O===N;return We&&j.call(this),typeof ue!="function"||(ue(this),We&&U.call(this)),this},x.isAdvancedAPI=function(){return O===N};var W,X=function(ue){if(O!==N)throw new Error(ue+" is only available in 'advanced' API mode. You need to call advancedAPI() first.")},oe=x.roundToPrecision=x.__private__.roundToPrecision=function(ue,We){var bt=e||We;if(isNaN(ue)||isNaN(bt))throw new Error("Invalid argument passed to jsPDF.roundToPrecision");return ue.toFixed(bt).replace(/0+$/,"")};W=x.hpf=x.__private__.hpf=typeof c=="number"?function(ue){if(isNaN(ue))throw new Error("Invalid argument passed to jsPDF.hpf");return oe(ue,c)}:c==="smart"?function(ue){if(isNaN(ue))throw new Error("Invalid argument passed to jsPDF.hpf");return oe(ue,ue>-1&&ue<1?16:5)}:function(ue){if(isNaN(ue))throw new Error("Invalid argument passed to jsPDF.hpf");return oe(ue,16)};var Q=x.f2=x.__private__.f2=function(ue){if(isNaN(ue))throw new Error("Invalid argument passed to jsPDF.f2");return oe(ue,2)},G=x.__private__.f3=function(ue){if(isNaN(ue))throw new Error("Invalid argument passed to jsPDF.f3");return oe(ue,3)},ae=x.scale=x.__private__.scale=function(ue){if(isNaN(ue))throw new Error("Invalid argument passed to jsPDF.scale");return O===F?ue*qe:O===N?ue:void 0},se=function(ue){return ae((function(We){return O===F?Do()-We:O===N?We:void 0})(ue))};x.__private__.setPrecision=x.setPrecision=function(ue){typeof parseInt(ue,10)=="number"&&(e=parseInt(ue,10))};var fe,_e="00000000000000000000000000000000",Le=x.__private__.getFileId=function(){return _e},ye=x.__private__.setFileId=function(ue){return _e=ue!==void 0&&/^[a-fA-F0-9]{32}$/.test(ue)?ue.toUpperCase():_e.split("").map(function(){return"ABCDEF0123456789".charAt(Math.floor(16*Math.random()))}).join(""),d!==null&&(Ba=new Bv(d.userPermissions,d.userPassword,d.ownerPassword,_e)),_e};x.setFileId=function(ue){return ye(ue),this},x.getFileId=function(){return Le()};var Te=x.__private__.convertDateToPDFDate=function(ue){var We=ue.getTimezoneOffset(),bt=We<0?"+":"-",zt=Math.floor(Math.abs(We/60)),lr=Math.abs(We%60),Nr=[bt,we(zt),"'",we(lr),"'"].join("");return["D:",ue.getFullYear(),we(ue.getMonth()+1),we(ue.getDate()),we(ue.getHours()),we(ue.getMinutes()),we(ue.getSeconds()),Nr].join("")},Ie=x.__private__.convertPDFDateToDate=function(ue){var We=parseInt(ue.substr(2,4),10),bt=parseInt(ue.substr(6,2),10)-1,zt=parseInt(ue.substr(8,2),10),lr=parseInt(ue.substr(10,2),10),Nr=parseInt(ue.substr(12,2),10),Zr=parseInt(ue.substr(14,2),10);return new Date(We,bt,zt,lr,Nr,Zr,0)},Me=x.__private__.setCreationDate=function(ue){var We;if(ue===void 0&&(ue=new Date),ue instanceof Date)We=Te(ue);else{if(!/^D:(20[0-2][0-9]|203[0-7]|19[7-9][0-9])(0[0-9]|1[0-2])([0-2][0-9]|3[0-1])(0[0-9]|1[0-9]|2[0-3])(0[0-9]|[1-5][0-9])(0[0-9]|[1-5][0-9])(\+0[0-9]|\+1[0-4]|-0[0-9]|-1[0-1])'(0[0-9]|[1-5][0-9])'?$/.test(ue))throw new Error("Invalid argument passed to jsPDF.setCreationDate");We=ue}return fe=We},de=x.__private__.getCreationDate=function(ue){var We=fe;return ue==="jsDate"&&(We=Ie(fe)),We};x.setCreationDate=function(ue){return Me(ue),this},x.getCreationDate=function(ue){return de(ue)};var Se,we=x.__private__.padd2=function(ue){return("0"+parseInt(ue)).slice(-2)},De=x.__private__.padd2Hex=function(ue){return("00"+(ue=ue.toString())).substr(ue.length)},Fe=0,Xe=[],Be=[],st=0,Qe=[],it=[],be=!1,Ot=Be;x.__private__.setCustomOutputDestination=function(ue){be=!0,Ot=ue};var at=function(ue){be||(Ot=ue)};x.__private__.resetCustomOutputDestination=function(){be=!1,Ot=Be};var $e=x.__private__.out=function(ue){return ue=ue.toString(),st+=ue.length+1,Ot.push(ue),Ot},Xt=x.__private__.write=function(ue){return $e(arguments.length===1?ue.toString():Array.prototype.join.call(arguments," "))},$t=x.__private__.getArrayBuffer=function(ue){for(var We=ue.length,bt=new ArrayBuffer(We),zt=new Uint8Array(bt);We--;)zt[We]=ue.charCodeAt(We);return bt},cr=[["Helvetica","helvetica","normal","WinAnsiEncoding"],["Helvetica-Bold","helvetica","bold","WinAnsiEncoding"],["Helvetica-Oblique","helvetica","italic","WinAnsiEncoding"],["Helvetica-BoldOblique","helvetica","bolditalic","WinAnsiEncoding"],["Courier","courier","normal","WinAnsiEncoding"],["Courier-Bold","courier","bold","WinAnsiEncoding"],["Courier-Oblique","courier","italic","WinAnsiEncoding"],["Courier-BoldOblique","courier","bolditalic","WinAnsiEncoding"],["Times-Roman","times","normal","WinAnsiEncoding"],["Times-Bold","times","bold","WinAnsiEncoding"],["Times-Italic","times","italic","WinAnsiEncoding"],["Times-BoldItalic","times","bolditalic","WinAnsiEncoding"],["ZapfDingbats","zapfdingbats","normal",null],["Symbol","symbol","normal",null]];x.__private__.getStandardFonts=function(){return cr};var _t=t.fontSize||16;x.__private__.setFontSize=x.setFontSize=function(ue){return _t=O===N?ue/qe:ue,this};var gr,mr=x.__private__.getFontSize=x.getFontSize=function(){return O===F?_t:_t*qe},ar=t.R2L||!1;x.__private__.setR2L=x.setR2L=function(ue){return ar=ue,this},x.__private__.getR2L=x.getR2L=function(){return ar};var Cr,Er=x.__private__.setZoomMode=function(ue){if(/^(?:\d+\.\d*|\d*\.\d+|\d+)%$/.test(ue))gr=ue;else if(isNaN(ue)){if([void 0,null,"fullwidth","fullheight","fullpage","original"].indexOf(ue)===-1)throw new Error('zoom must be Integer (e.g. 2), a percentage Value (e.g. 300%) or fullwidth, fullheight, fullpage, original. "'+ue+'" is not recognized.');gr=ue}else gr=parseInt(ue,10)};x.__private__.getZoomMode=function(){return gr};var Jt,ot=x.__private__.setPageMode=function(ue){if([void 0,null,"UseNone","UseOutlines","UseThumbs","FullScreen"].indexOf(ue)==-1)throw new Error('Page mode must be one of UseNone, UseOutlines, UseThumbs, or FullScreen. "'+ue+'" is not recognized.');Cr=ue};x.__private__.getPageMode=function(){return Cr};var Ce=x.__private__.setLayoutMode=function(ue){if([void 0,null,"continuous","single","twoleft","tworight","two"].indexOf(ue)==-1)throw new Error('Layout mode must be one of continuous, single, twoleft, tworight. "'+ue+'" is not recognized.');Jt=ue};x.__private__.getLayoutMode=function(){return Jt},x.__private__.setDisplayMode=x.setDisplayMode=function(ue,We,bt){return Er(ue),Ce(We),ot(bt),this};var xe={title:"",subject:"",author:"",keywords:"",creator:""};x.__private__.getDocumentProperty=function(ue){if(Object.keys(xe).indexOf(ue)===-1)throw new Error("Invalid argument passed to jsPDF.getDocumentProperty");return xe[ue]},x.__private__.getDocumentProperties=function(){return xe},x.__private__.setDocumentProperties=x.setProperties=x.setDocumentProperties=function(ue){for(var We in xe)xe.hasOwnProperty(We)&&ue[We]&&(xe[We]=ue[We]);return this},x.__private__.setDocumentProperty=function(ue,We){if(Object.keys(xe).indexOf(ue)===-1)throw new Error("Invalid arguments passed to jsPDF.setDocumentProperty");return xe[ue]=We};var je,qe,Ge,Ft,Et,mt={},ct={},Qt=[],Ht={},Ir={},Ar={},$r={},fn=null,zr=0,Mt=[],en=new g9(x),jn=t.hotfixes||[],Qr={},nr={},oi=[],un=function ue(We,bt,zt,lr,Nr,Zr){if(!(this instanceof ue))return new ue(We,bt,zt,lr,Nr,Zr);isNaN(We)&&(We=1),isNaN(bt)&&(bt=0),isNaN(zt)&&(zt=0),isNaN(lr)&&(lr=1),isNaN(Nr)&&(Nr=0),isNaN(Zr)&&(Zr=0),this._matrix=[We,bt,zt,lr,Nr,Zr]};Object.defineProperty(un.prototype,"sx",{get:function(){return this._matrix[0]},set:function(ue){this._matrix[0]=ue}}),Object.defineProperty(un.prototype,"shy",{get:function(){return this._matrix[1]},set:function(ue){this._matrix[1]=ue}}),Object.defineProperty(un.prototype,"shx",{get:function(){return this._matrix[2]},set:function(ue){this._matrix[2]=ue}}),Object.defineProperty(un.prototype,"sy",{get:function(){return this._matrix[3]},set:function(ue){this._matrix[3]=ue}}),Object.defineProperty(un.prototype,"tx",{get:function(){return this._matrix[4]},set:function(ue){this._matrix[4]=ue}}),Object.defineProperty(un.prototype,"ty",{get:function(){return this._matrix[5]},set:function(ue){this._matrix[5]=ue}}),Object.defineProperty(un.prototype,"a",{get:function(){return this._matrix[0]},set:function(ue){this._matrix[0]=ue}}),Object.defineProperty(un.prototype,"b",{get:function(){return this._matrix[1]},set:function(ue){this._matrix[1]=ue}}),Object.defineProperty(un.prototype,"c",{get:function(){return this._matrix[2]},set:function(ue){this._matrix[2]=ue}}),Object.defineProperty(un.prototype,"d",{get:function(){return this._matrix[3]},set:function(ue){this._matrix[3]=ue}}),Object.defineProperty(un.prototype,"e",{get:function(){return this._matrix[4]},set:function(ue){this._matrix[4]=ue}}),Object.defineProperty(un.prototype,"f",{get:function(){return this._matrix[5]},set:function(ue){this._matrix[5]=ue}}),Object.defineProperty(un.prototype,"rotation",{get:function(){return Math.atan2(this.shx,this.sx)}}),Object.defineProperty(un.prototype,"scaleX",{get:function(){return this.decompose().scale.sx}}),Object.defineProperty(un.prototype,"scaleY",{get:function(){return this.decompose().scale.sy}}),Object.defineProperty(un.prototype,"isIdentity",{get:function(){return this.sx===1&&this.shy===0&&this.shx===0&&this.sy===1&&this.tx===0&&this.ty===0}}),un.prototype.join=function(ue){return[this.sx,this.shy,this.shx,this.sy,this.tx,this.ty].map(W).join(ue)},un.prototype.multiply=function(ue){var We=ue.sx*this.sx+ue.shy*this.shx,bt=ue.sx*this.shy+ue.shy*this.sy,zt=ue.shx*this.sx+ue.sy*this.shx,lr=ue.shx*this.shy+ue.sy*this.sy,Nr=ue.tx*this.sx+ue.ty*this.shx+this.tx,Zr=ue.tx*this.shy+ue.ty*this.sy+this.ty;return new un(We,bt,zt,lr,Nr,Zr)},un.prototype.decompose=function(){var ue=this.sx,We=this.shy,bt=this.shx,zt=this.sy,lr=this.tx,Nr=this.ty,Zr=Math.sqrt(ue*ue+We*We),Ln=(ue/=Zr)*bt+(We/=Zr)*zt;bt-=ue*Ln,zt-=We*Ln;var qn=Math.sqrt(bt*bt+zt*zt);return Ln/=qn,ue*(zt/=qn)<We*(bt/=qn)&&(ue=-ue,We=-We,Ln=-Ln,Zr=-Zr),{scale:new un(Zr,0,0,qn,0,0),translate:new un(1,0,0,1,lr,Nr),rotate:new un(ue,We,-We,ue,0,0),skew:new un(1,0,Ln,1,0,0)}},un.prototype.toString=function(ue){return this.join(" ")},un.prototype.inversed=function(){var ue=this.sx,We=this.shy,bt=this.shx,zt=this.sy,lr=this.tx,Nr=this.ty,Zr=1/(ue*zt-We*bt),Ln=zt*Zr,qn=-We*Zr,Un=-bt*Zr,ui=ue*Zr;return new un(Ln,qn,Un,ui,-Ln*lr-Un*Nr,-qn*lr-ui*Nr)},un.prototype.applyToPoint=function(ue){var We=ue.x*this.sx+ue.y*this.shx+this.tx,bt=ue.x*this.shy+ue.y*this.sy+this.ty;return new Ru(We,bt)},un.prototype.applyToRectangle=function(ue){var We=this.applyToPoint(ue),bt=this.applyToPoint(new Ru(ue.x+ue.w,ue.y+ue.h));return new Mu(We.x,We.y,bt.x-We.x,bt.y-We.y)},un.prototype.clone=function(){var ue=this.sx,We=this.shy,bt=this.shx,zt=this.sy,lr=this.tx,Nr=this.ty;return new un(ue,We,bt,zt,lr,Nr)},x.Matrix=un;var Kn=x.matrixMult=function(ue,We){return We.multiply(ue)},Re=new un(1,0,0,1,0,0);x.unitMatrix=x.identityMatrix=Re;var He=function(ue,We){if(!Ir[ue]){var bt=(We instanceof wm?"Sh":"P")+(Object.keys(Ht).length+1).toString(10);We.id=bt,Ir[ue]=bt,Ht[bt]=We,en.publish("addPattern",We)}};x.ShadingPattern=wm,x.TilingPattern=s0,x.addShadingPattern=function(ue,We){return X("addShadingPattern()"),He(ue,We),this},x.beginTilingPattern=function(ue){X("beginTilingPattern()"),ji(ue.boundingBox[0],ue.boundingBox[1],ue.boundingBox[2]-ue.boundingBox[0],ue.boundingBox[3]-ue.boundingBox[1],ue.matrix)},x.endTilingPattern=function(ue,We){X("endTilingPattern()"),We.stream=it[Se].join(`
`),He(ue,We),en.publish("endTilingPattern",We),oi.pop().restore()};var Tt,Gt=x.__private__.newObject=function(){var ue=Ut();return Xr(ue,!0),ue},Ut=x.__private__.newObjectDeferred=function(){return Fe++,Xe[Fe]=function(){return st},Fe},Xr=function(ue,We){return We=typeof We=="boolean"&&We,Xe[ue]=st,We&&$e(ue+" 0 obj"),ue},Nn=x.__private__.newAdditionalObject=function(){var ue={objId:Ut(),content:""};return Qe.push(ue),ue},Bi=Ut(),Ci=Ut(),Fr=x.__private__.decodeColorString=function(ue){var We=ue.split(" ");if(We.length!==2||We[1]!=="g"&&We[1]!=="G")We.length!==5||We[4]!=="k"&&We[4]!=="K"||(We=[(1-We[0])*(1-We[3]),(1-We[1])*(1-We[3]),(1-We[2])*(1-We[3]),"r"]);else{var bt=parseFloat(We[0]);We=[bt,bt,bt,"r"]}for(var zt="#",lr=0;lr<3;lr++)zt+=("0"+Math.floor(255*parseFloat(We[lr])).toString(16)).slice(-2);return zt},Mn=x.__private__.encodeColorString=function(ue){var We;typeof ue=="string"&&(ue={ch1:ue});var bt=ue.ch1,zt=ue.ch2,lr=ue.ch3,Nr=ue.ch4,Zr=ue.pdfColorType==="draw"?["G","RG","K"]:["g","rg","k"];if(typeof bt=="string"&&bt.charAt(0)!=="#"){var Ln=new oZ(bt);if(Ln.ok)bt=Ln.toHex();else if(!/^\d*\.?\d*$/.test(bt))throw new Error('Invalid color "'+bt+'" passed to jsPDF.encodeColorString.')}if(typeof bt=="string"&&/^#[0-9A-Fa-f]{3}$/.test(bt)&&(bt="#"+bt[1]+bt[1]+bt[2]+bt[2]+bt[3]+bt[3]),typeof bt=="string"&&/^#[0-9A-Fa-f]{6}$/.test(bt)){var qn=parseInt(bt.substr(1),16);bt=qn>>16&255,zt=qn>>8&255,lr=255&qn}if(zt===void 0||Nr===void 0&&bt===zt&&zt===lr)We=typeof bt=="string"?bt+" "+Zr[0]:ue.precision===2?Q(bt/255)+" "+Zr[0]:G(bt/255)+" "+Zr[0];else if(Nr===void 0||ho(Nr)==="object"){if(Nr&&!isNaN(Nr.a)&&Nr.a===0)return["1.","1.","1.",Zr[1]].join(" ");We=typeof bt=="string"?[bt,zt,lr,Zr[1]].join(" "):ue.precision===2?[Q(bt/255),Q(zt/255),Q(lr/255),Zr[1]].join(" "):[G(bt/255),G(zt/255),G(lr/255),Zr[1]].join(" ")}else We=typeof bt=="string"?[bt,zt,lr,Nr,Zr[2]].join(" "):ue.precision===2?[Q(bt),Q(zt),Q(lr),Q(Nr),Zr[2]].join(" "):[G(bt),G(zt),G(lr),G(Nr),Zr[2]].join(" ");return We},Bn=x.__private__.getFilters=function(){return s},ei=x.__private__.putStream=function(ue){var We=(ue=ue||{}).data||"",bt=ue.filters||Bn(),zt=ue.alreadyAppliedFilters||[],lr=ue.addLength1||!1,Nr=We.length,Zr=ue.objectId,Ln=function(Si){return Si};if(d!==null&&Zr===void 0)throw new Error("ObjectId must be passed to putStream for file encryption");d!==null&&(Ln=Ba.encryptor(Zr,0));var qn={};bt===!0&&(bt=["FlateEncode"]);var Un=ue.additionalKeyValues||[],ui=(qn=di.API.processDataByFilters!==void 0?di.API.processDataByFilters(We,bt):{data:We,reverseChain:[]}).reverseChain+(Array.isArray(zt)?zt.join(" "):zt.toString());if(qn.data.length!==0&&(Un.push({key:"Length",value:qn.data.length}),lr===!0&&Un.push({key:"Length1",value:Nr})),ui.length!=0)if(ui.split("/").length-1==1)Un.push({key:"Filter",value:ui});else{Un.push({key:"Filter",value:"["+ui+"]"});for(var Hn=0;Hn<Un.length;Hn+=1)if(Un[Hn].key==="DecodeParms"){for(var Ui=[],Xi=0;Xi<qn.reverseChain.split("/").length-1;Xi+=1)Ui.push("null");Ui.push(Un[Hn].value),Un[Hn].value="["+Ui.join(" ")+"]"}}$e("<<");for(var ra=0;ra<Un.length;ra++)$e("/"+Un[ra].key+" "+Un[ra].value);$e(">>"),qn.data.length!==0&&($e("stream"),$e(Ln(qn.data)),$e("endstream"))},ua=x.__private__.putPage=function(ue){var We=ue.number,bt=ue.data,zt=ue.objId,lr=ue.contentsObjId;Xr(zt,!0),$e("<</Type /Page"),$e("/Parent "+ue.rootDictionaryObjId+" 0 R"),$e("/Resources "+ue.resourceDictionaryObjId+" 0 R"),$e("/MediaBox ["+parseFloat(W(ue.mediaBox.bottomLeftX))+" "+parseFloat(W(ue.mediaBox.bottomLeftY))+" "+W(ue.mediaBox.topRightX)+" "+W(ue.mediaBox.topRightY)+"]"),ue.cropBox!==null&&$e("/CropBox ["+W(ue.cropBox.bottomLeftX)+" "+W(ue.cropBox.bottomLeftY)+" "+W(ue.cropBox.topRightX)+" "+W(ue.cropBox.topRightY)+"]"),ue.bleedBox!==null&&$e("/BleedBox ["+W(ue.bleedBox.bottomLeftX)+" "+W(ue.bleedBox.bottomLeftY)+" "+W(ue.bleedBox.topRightX)+" "+W(ue.bleedBox.topRightY)+"]"),ue.trimBox!==null&&$e("/TrimBox ["+W(ue.trimBox.bottomLeftX)+" "+W(ue.trimBox.bottomLeftY)+" "+W(ue.trimBox.topRightX)+" "+W(ue.trimBox.topRightY)+"]"),ue.artBox!==null&&$e("/ArtBox ["+W(ue.artBox.bottomLeftX)+" "+W(ue.artBox.bottomLeftY)+" "+W(ue.artBox.topRightX)+" "+W(ue.artBox.topRightY)+"]"),typeof ue.userUnit=="number"&&ue.userUnit!==1&&$e("/UserUnit "+ue.userUnit),en.publish("putPage",{objId:zt,pageContext:Mt[We],pageNumber:We,page:bt}),$e("/Contents "+lr+" 0 R"),$e(">>"),$e("endobj");var Nr=bt.join(`
`);return O===N&&(Nr+=`
Q`),Xr(lr,!0),ei({data:Nr,filters:Bn(),objectId:lr}),$e("endobj"),zt},ha=x.__private__.putPages=function(){var ue,We,bt=[];for(ue=1;ue<=zr;ue++)Mt[ue].objId=Ut(),Mt[ue].contentsObjId=Ut();for(ue=1;ue<=zr;ue++)bt.push(ua({number:ue,data:it[ue],objId:Mt[ue].objId,contentsObjId:Mt[ue].contentsObjId,mediaBox:Mt[ue].mediaBox,cropBox:Mt[ue].cropBox,bleedBox:Mt[ue].bleedBox,trimBox:Mt[ue].trimBox,artBox:Mt[ue].artBox,userUnit:Mt[ue].userUnit,rootDictionaryObjId:Bi,resourceDictionaryObjId:Ci}));Xr(Bi,!0),$e("<</Type /Pages");var zt="/Kids [";for(We=0;We<zr;We++)zt+=bt[We]+" 0 R ";$e(zt+"]"),$e("/Count "+zr),$e(">>"),$e("endobj"),en.publish("postPutPages")},zn=function(ue){en.publish("putFont",{font:ue,out:$e,newObject:Gt,putStream:ei}),ue.isAlreadyPutted!==!0&&(ue.objectNumber=Gt(),$e("<<"),$e("/Type /Font"),$e("/BaseFont /"+zv(ue.postScriptName)),$e("/Subtype /Type1"),typeof ue.encoding=="string"&&$e("/Encoding /"+ue.encoding),$e("/FirstChar 32"),$e("/LastChar 255"),$e(">>"),$e("endobj"))},La=function(ue){ue.objectNumber=Gt();var We=[];We.push({key:"Type",value:"/XObject"}),We.push({key:"Subtype",value:"/Form"}),We.push({key:"BBox",value:"["+[W(ue.x),W(ue.y),W(ue.x+ue.width),W(ue.y+ue.height)].join(" ")+"]"}),We.push({key:"Matrix",value:"["+ue.matrix.toString()+"]"});var bt=ue.pages[1].join(`
`);ei({data:bt,additionalKeyValues:We,objectId:ue.objectNumber}),$e("endobj")},Wi=function(ue,We){We||(We=21);var bt=Gt(),zt=(function(Zr,Ln){var qn,Un=[],ui=1/(Ln-1);for(qn=0;qn<1;qn+=ui)Un.push(qn);if(Un.push(1),Zr[0].offset!=0){var Hn={offset:0,color:Zr[0].color};Zr.unshift(Hn)}if(Zr[Zr.length-1].offset!=1){var Ui={offset:1,color:Zr[Zr.length-1].color};Zr.push(Ui)}for(var Xi="",ra=0,Si=0;Si<Un.length;Si++){for(qn=Un[Si];qn>Zr[ra+1].offset;)ra++;var Ia=Zr[ra].offset,za=(qn-Ia)/(Zr[ra+1].offset-Ia),Hs=Zr[ra].color,ll=Zr[ra+1].color;Xi+=De(Math.round((1-za)*Hs[0]+za*ll[0]).toString(16))+De(Math.round((1-za)*Hs[1]+za*ll[1]).toString(16))+De(Math.round((1-za)*Hs[2]+za*ll[2]).toString(16))}return Xi.trim()})(ue.colors,We),lr=[];lr.push({key:"FunctionType",value:"0"}),lr.push({key:"Domain",value:"[0.0 1.0]"}),lr.push({key:"Size",value:"["+We+"]"}),lr.push({key:"BitsPerSample",value:"8"}),lr.push({key:"Range",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),lr.push({key:"Decode",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),ei({data:zt,additionalKeyValues:lr,alreadyAppliedFilters:["/ASCIIHexDecode"],objectId:bt}),$e("endobj"),ue.objectNumber=Gt(),$e("<< /ShadingType "+ue.type),$e("/ColorSpace /DeviceRGB");var Nr="/Coords ["+W(parseFloat(ue.coords[0]))+" "+W(parseFloat(ue.coords[1]))+" ";ue.type===2?Nr+=W(parseFloat(ue.coords[2]))+" "+W(parseFloat(ue.coords[3])):Nr+=W(parseFloat(ue.coords[2]))+" "+W(parseFloat(ue.coords[3]))+" "+W(parseFloat(ue.coords[4]))+" "+W(parseFloat(ue.coords[5])),$e(Nr+="]"),ue.matrix&&$e("/Matrix ["+ue.matrix.toString()+"]"),$e("/Function "+bt+" 0 R"),$e("/Extend [true true]"),$e(">>"),$e("endobj")},hs=function(ue,We){var bt=Ut(),zt=Gt();We.push({resourcesOid:bt,objectOid:zt}),ue.objectNumber=zt;var lr=[];lr.push({key:"Type",value:"/Pattern"}),lr.push({key:"PatternType",value:"1"}),lr.push({key:"PaintType",value:"1"}),lr.push({key:"TilingType",value:"1"}),lr.push({key:"BBox",value:"["+ue.boundingBox.map(W).join(" ")+"]"}),lr.push({key:"XStep",value:W(ue.xStep)}),lr.push({key:"YStep",value:W(ue.yStep)}),lr.push({key:"Resources",value:bt+" 0 R"}),ue.matrix&&lr.push({key:"Matrix",value:"["+ue.matrix.toString()+"]"}),ei({data:ue.stream,additionalKeyValues:lr,objectId:ue.objectNumber}),$e("endobj")},Ca=function(ue){for(var We in ue.objectNumber=Gt(),$e("<<"),ue)switch(We){case"opacity":$e("/ca "+Q(ue[We]));break;case"stroke-opacity":$e("/CA "+Q(ue[We]))}$e(">>"),$e("endobj")},Mo=function(ue){Xr(ue.resourcesOid,!0),$e("<<"),$e("/ProcSet [/PDF /Text /ImageB /ImageC /ImageI]"),(function(){for(var We in $e("/Font <<"),mt)mt.hasOwnProperty(We)&&(m===!1||m===!0&&b.hasOwnProperty(We))&&$e("/"+We+" "+mt[We].objectNumber+" 0 R");$e(">>")})(),(function(){if(Object.keys(Ht).length>0){for(var We in $e("/Shading <<"),Ht)Ht.hasOwnProperty(We)&&Ht[We]instanceof wm&&Ht[We].objectNumber>=0&&$e("/"+We+" "+Ht[We].objectNumber+" 0 R");en.publish("putShadingPatternDict"),$e(">>")}})(),(function(We){if(Object.keys(Ht).length>0){for(var bt in $e("/Pattern <<"),Ht)Ht.hasOwnProperty(bt)&&Ht[bt]instanceof x.TilingPattern&&Ht[bt].objectNumber>=0&&Ht[bt].objectNumber<We&&$e("/"+bt+" "+Ht[bt].objectNumber+" 0 R");en.publish("putTilingPatternDict"),$e(">>")}})(ue.objectOid),(function(){if(Object.keys(Ar).length>0){var We;for(We in $e("/ExtGState <<"),Ar)Ar.hasOwnProperty(We)&&Ar[We].objectNumber>=0&&$e("/"+We+" "+Ar[We].objectNumber+" 0 R");en.publish("putGStateDict"),$e(">>")}})(),(function(){for(var We in $e("/XObject <<"),Qr)Qr.hasOwnProperty(We)&&Qr[We].objectNumber>=0&&$e("/"+We+" "+Qr[We].objectNumber+" 0 R");en.publish("putXobjectDict"),$e(">>")})(),$e(">>"),$e("endobj")},Ya=function(ue){ct[ue.fontName]=ct[ue.fontName]||{},ct[ue.fontName][ue.fontStyle]=ue.id},ol=function(ue,We,bt,zt,lr){var Nr={id:"F"+(Object.keys(mt).length+1).toString(10),postScriptName:ue,fontName:We,fontStyle:bt,encoding:zt,isStandardFont:lr||!1,metadata:{}};return en.publish("addFont",{font:Nr,instance:this}),mt[Nr.id]=Nr,Ya(Nr),Nr.id},xi=x.__private__.pdfEscape=x.pdfEscape=function(ue,We){return(function(bt,zt){var lr,Nr,Zr,Ln,qn,Un,ui,Hn,Ui;if(Zr=(zt=zt||{}).sourceEncoding||"Unicode",qn=zt.outputEncoding,(zt.autoencode||qn)&&mt[je].metadata&&mt[je].metadata[Zr]&&mt[je].metadata[Zr].encoding&&(Ln=mt[je].metadata[Zr].encoding,!qn&&mt[je].encoding&&(qn=mt[je].encoding),!qn&&Ln.codePages&&(qn=Ln.codePages[0]),typeof qn=="string"&&(qn=Ln[qn]),qn)){for(ui=!1,Un=[],lr=0,Nr=bt.length;lr<Nr;lr++)(Hn=qn[bt.charCodeAt(lr)])?Un.push(String.fromCharCode(Hn)):Un.push(bt[lr]),Un[lr].charCodeAt(0)>>8&&(ui=!0);bt=Un.join("")}for(lr=bt.length;ui===void 0&&lr!==0;)bt.charCodeAt(lr-1)>>8&&(ui=!0),lr--;if(!ui)return bt;for(Un=zt.noBOM?[]:[254,255],lr=0,Nr=bt.length;lr<Nr;lr++){if((Ui=(Hn=bt.charCodeAt(lr))>>8)>>8)throw new Error("Character at position "+lr+" of string '"+bt+"' exceeds 16bits. Cannot be encoded into UCS-2 BE");Un.push(Ui),Un.push(Hn-(Ui<<8))}return String.fromCharCode.apply(void 0,Un)})(ue,We).replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},zi=x.__private__.beginPage=function(ue){it[++zr]=[],Mt[zr]={objId:0,contentsObjId:0,userUnit:Number(o),artBox:null,bleedBox:null,cropBox:null,trimBox:null,mediaBox:{bottomLeftX:0,bottomLeftY:0,topRightX:Number(ue[0]),topRightY:Number(ue[1])}},Za(zr),at(it[Se])},Iu=function(ue,We){var bt,zt,lr;switch(r=We||r,typeof ue=="string"&&(bt=M(ue.toLowerCase()),Array.isArray(bt)&&(zt=bt[0],lr=bt[1])),Array.isArray(ue)&&(zt=ue[0]*qe,lr=ue[1]*qe),isNaN(zt)&&(zt=i[0],lr=i[1]),(zt>14400||lr>14400)&&(Ro.warn("A page in a PDF can not be wider or taller than 14400 userUnit. jsPDF limits the width/height to 14400"),zt=Math.min(14400,zt),lr=Math.min(14400,lr)),i=[zt,lr],r.substr(0,1)){case"l":lr>zt&&(i=[lr,zt]);break;case"p":zt>lr&&(i=[lr,zt])}zi(i),Mr($n),$e(Ts),Ka!==0&&$e(Ka+" J"),$s!==0&&$e($s+" j"),en.publish("addPage",{pageNumber:zr})},ga=function(ue){ue>0&&ue<=zr&&(it.splice(ue,1),Mt.splice(ue,1),zr--,Se>zr&&(Se=zr),this.setPage(Se))},Za=function(ue){ue>0&&ue<=zr&&(Se=ue)},ds=x.__private__.getNumberOfPages=x.getNumberOfPages=function(){return it.length-1},Aa=function(ue,We,bt){var zt,lr=void 0;return bt=bt||{},ue=ue!==void 0?ue:mt[je].fontName,We=We!==void 0?We:mt[je].fontStyle,zt=ue.toLowerCase(),ct[zt]!==void 0&&ct[zt][We]!==void 0?lr=ct[zt][We]:ct[ue]!==void 0&&ct[ue][We]!==void 0?lr=ct[ue][We]:bt.disableWarning===!1&&Ro.warn("Unable to look up font label for font '"+ue+"', '"+We+"'. Refer to getFontList() for available fonts."),lr||bt.noFallback||(lr=ct.times[We])==null&&(lr=ct.times.normal),lr},ps=x.__private__.putInfo=function(){var ue=Gt(),We=function(zt){return zt};for(var bt in d!==null&&(We=Ba.encryptor(ue,0)),$e("<<"),$e("/Producer ("+xi(We("jsPDF "+di.version))+")"),xe)xe.hasOwnProperty(bt)&&xe[bt]&&$e("/"+bt.substr(0,1).toUpperCase()+bt.substr(1)+" ("+xi(We(xe[bt]))+")");$e("/CreationDate ("+xi(We(fe))+")"),$e(">>"),$e("endobj")},Ul=x.__private__.putCatalog=function(ue){var We=(ue=ue||{}).rootDictionaryObjId||Bi;switch(Gt(),$e("<<"),$e("/Type /Catalog"),$e("/Pages "+We+" 0 R"),gr||(gr="fullwidth"),gr){case"fullwidth":$e("/OpenAction [3 0 R /FitH null]");break;case"fullheight":$e("/OpenAction [3 0 R /FitV null]");break;case"fullpage":$e("/OpenAction [3 0 R /Fit]");break;case"original":$e("/OpenAction [3 0 R /XYZ null null 1]");break;default:var bt=""+gr;bt.substr(bt.length-1)==="%"&&(gr=parseInt(gr)/100),typeof gr=="number"&&$e("/OpenAction [3 0 R /XYZ null null "+Q(gr)+"]")}switch(Jt||(Jt="continuous"),Jt){case"continuous":$e("/PageLayout /OneColumn");break;case"single":$e("/PageLayout /SinglePage");break;case"two":case"twoleft":$e("/PageLayout /TwoColumnLeft");break;case"tworight":$e("/PageLayout /TwoColumnRight")}Cr&&$e("/PageMode /"+Cr),en.publish("putCatalog"),$e(">>"),$e("endobj")},Fa=x.__private__.putTrailer=function(){$e("trailer"),$e("<<"),$e("/Size "+(Fe+1)),$e("/Root "+Fe+" 0 R"),$e("/Info "+(Fe-1)+" 0 R"),d!==null&&$e("/Encrypt "+Ba.oid+" 0 R"),$e("/ID [ <"+_e+"> <"+_e+"> ]"),$e(">>")},_a=x.__private__.putHeader=function(){$e("%PDF-"+E),$e("%")},wc=x.__private__.putXRef=function(){var ue="0000000000";$e("xref"),$e("0 "+(Fe+1)),$e("0000000000 65535 f ");for(var We=1;We<=Fe;We++)typeof Xe[We]=="function"?$e((ue+Xe[We]()).slice(-10)+" 00000 n "):Xe[We]!==void 0?$e((ue+Xe[We]).slice(-10)+" 00000 n "):$e("0000000000 00000 n ")},sl=x.__private__.buildDocument=function(){var ue;Fe=0,st=0,Be=[],Xe=[],Qe=[],Bi=Ut(),Ci=Ut(),at(Be),en.publish("buildDocument"),_a(),ha(),(function(){en.publish("putAdditionalObjects");for(var bt=0;bt<Qe.length;bt++){var zt=Qe[bt];Xr(zt.objId,!0),$e(zt.content),$e("endobj")}en.publish("postPutAdditionalObjects")})(),ue=[],(function(){for(var bt in mt)mt.hasOwnProperty(bt)&&(m===!1||m===!0&&b.hasOwnProperty(bt))&&zn(mt[bt])})(),(function(){var bt;for(bt in Ar)Ar.hasOwnProperty(bt)&&Ca(Ar[bt])})(),(function(){for(var bt in Qr)Qr.hasOwnProperty(bt)&&La(Qr[bt])})(),(function(bt){var zt;for(zt in Ht)Ht.hasOwnProperty(zt)&&(Ht[zt]instanceof wm?Wi(Ht[zt]):Ht[zt]instanceof s0&&hs(Ht[zt],bt))})(ue),en.publish("putResources"),ue.forEach(Mo),Mo({resourcesOid:Ci,objectOid:Number.MAX_SAFE_INTEGER}),en.publish("postPutResources"),d!==null&&(Ba.oid=Gt(),$e("<<"),$e("/Filter /Standard"),$e("/V "+Ba.v),$e("/R "+Ba.r),$e("/U <"+Ba.toHexString(Ba.U)+">"),$e("/O <"+Ba.toHexString(Ba.O)+">"),$e("/P "+Ba.P),$e(">>"),$e("endobj")),ps(),Ul();var We=st;return wc(),Fa(),$e("startxref"),$e(""+We),$e("%%EOF"),at(it[Se]),Be.join(`
`)},ts=x.__private__.getBlob=function(ue){return new Blob([$t(ue)],{type:"application/pdf"})},oo=x.output=x.__private__.output=(Tt=function(ue,We){switch(typeof(We=We||{})=="string"?We={filename:We}:We.filename=We.filename||"generated.pdf",ue){case void 0:return sl();case"save":x.save(We.filename);break;case"arraybuffer":return $t(sl());case"blob":return ts(sl());case"bloburi":case"bloburl":if(Oi.URL!==void 0&&typeof Oi.URL.createObjectURL=="function")return Oi.URL&&Oi.URL.createObjectURL(ts(sl()))||void 0;Ro.warn("bloburl is not supported by your system, because URL.createObjectURL is not supported by your browser.");break;case"datauristring":case"dataurlstring":var bt="",zt=sl();try{bt=h9(zt)}catch{bt=h9(unescape(encodeURIComponent(zt)))}return"data:application/pdf;filename="+We.filename+";base64,"+bt;case"pdfobjectnewwindow":if(Object.prototype.toString.call(Oi)==="[object Window]"){var lr="https://cdnjs.cloudflare.com/ajax/libs/pdfobject/2.1.1/pdfobject.min.js",Nr=' integrity="sha512-4ze/a9/4jqu+tX9dfOqJYSvyYd5M6qum/3HpCLr+/Jqf0whc37VUbkpNGHR7/8pSnCFw47T1fmIpwBV7UySh3g==" crossorigin="anonymous"';We.pdfObjectUrl&&(lr=We.pdfObjectUrl,Nr="");var Zr='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><script src="'+lr+'"'+Nr+'><\/script><script >PDFObject.embed("'+this.output("dataurlstring")+'", '+JSON.stringify(We)+");<\/script></body></html>",Ln=Oi.open();return Ln!==null&&Ln.document.write(Zr),Ln}throw new Error("The option pdfobjectnewwindow just works in a browser-environment.");case"pdfjsnewwindow":if(Object.prototype.toString.call(Oi)==="[object Window]"){var qn='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe id="pdfViewer" src="'+(We.pdfJsUrl||"examples/PDF.js/web/viewer.html")+"?file=&downloadName="+We.filename+'" width="500px" height="400px" /></body></html>',Un=Oi.open();if(Un!==null){Un.document.write(qn);var ui=this;Un.document.documentElement.querySelector("#pdfViewer").onload=function(){Un.document.title=We.filename,Un.document.documentElement.querySelector("#pdfViewer").contentWindow.PDFViewerApplication.open(ui.output("bloburl"))}}return Un}throw new Error("The option pdfjsnewwindow just works in a browser-environment.");case"dataurlnewwindow":if(Object.prototype.toString.call(Oi)!=="[object Window]")throw new Error("The option dataurlnewwindow just works in a browser-environment.");var Hn='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe src="'+this.output("datauristring",We)+'"></iframe></body></html>',Ui=Oi.open();if(Ui!==null&&(Ui.document.write(Hn),Ui.document.title=We.filename),Ui||typeof safari>"u")return Ui;break;case"datauri":case"dataurl":return Oi.document.location.href=this.output("datauristring",We);default:return null}},Tt.foo=function(){try{return Tt.apply(this,arguments)}catch(bt){var ue=bt.stack||"";~ue.indexOf(" at ")&&(ue=ue.split(" at ")[1]);var We="Error in function "+ue.split(`
`)[0].split("<")[0]+": "+bt.message;if(!Oi.console)throw new Error(We);Oi.console.error(We,bt),Oi.alert&&alert(We)}},Tt.foo.bar=Tt,Tt.foo),rs=function(ue){return Array.isArray(jn)===!0&&jn.indexOf(ue)>-1};switch(n){case"pt":qe=1;break;case"mm":qe=72/25.4;break;case"cm":qe=72/2.54;break;case"in":qe=72;break;case"px":qe=rs("px_scaling")==1?.75:96/72;break;case"pc":case"em":qe=12;break;case"ex":qe=6;break;default:if(typeof n!="number")throw new Error("Invalid unit: "+n);qe=n}var Ba=null;Me(),ye();var Us=x.__private__.getPageInfo=x.getPageInfo=function(ue){if(isNaN(ue)||ue%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfo");return{objId:Mt[ue].objId,pageNumber:ue,pageContext:Mt[ue]}},$c=x.__private__.getPageInfoByObjId=function(ue){if(isNaN(ue)||ue%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfoByObjId");for(var We in Mt)if(Mt[We].objId===ue)break;return Us(We)},Pu=x.__private__.getCurrentPageInfo=x.getCurrentPageInfo=function(){return{objId:Mt[Se].objId,pageNumber:Se,pageContext:Mt[Se]}};x.addPage=function(){return Iu.apply(this,arguments),this},x.setPage=function(){return Za.apply(this,arguments),at.call(this,it[Se]),this},x.insertPage=function(ue){return this.addPage(),this.movePage(Se,ue),this},x.movePage=function(ue,We){var bt,zt;if(ue>We){bt=it[ue],zt=Mt[ue];for(var lr=ue;lr>We;lr--)it[lr]=it[lr-1],Mt[lr]=Mt[lr-1];it[We]=bt,Mt[We]=zt,this.setPage(We)}else if(ue<We){bt=it[ue],zt=Mt[ue];for(var Nr=ue;Nr<We;Nr++)it[Nr]=it[Nr+1],Mt[Nr]=Mt[Nr+1];it[We]=bt,Mt[We]=zt,this.setPage(We)}return this},x.deletePage=function(){return ga.apply(this,arguments),this},x.__private__.text=x.text=function(ue,We,bt,zt,lr){var Nr,Zr,Ln,qn,Un,ui,Hn,Ui,Xi,ra=(zt=zt||{}).scope||this;if(typeof ue=="number"&&typeof We=="number"&&(typeof bt=="string"||Array.isArray(bt))){var Si=bt;bt=We,We=ue,ue=Si}if(arguments[3]instanceof un==0?(Ln=arguments[4],qn=arguments[5],ho(Hn=arguments[3])==="object"&&Hn!==null||(typeof Ln=="string"&&(qn=Ln,Ln=null),typeof Hn=="string"&&(qn=Hn,Hn=null),typeof Hn=="number"&&(Ln=Hn,Hn=null),zt={flags:Hn,angle:Ln,align:qn})):(X("The transform parameter of text() with a Matrix value"),Xi=lr),isNaN(We)||isNaN(bt)||ue==null)throw new Error("Invalid arguments passed to jsPDF.text");if(ue.length===0)return ra;var Ia,za="",Hs=typeof zt.lineHeightFactor=="number"?zt.lineHeightFactor:Ri,ll=ra.internal.scaleFactor;function Gs(Pn){return Pn=Pn.split("	").join(Array(zt.TabLen||9).join(" ")),xi(Pn,Hn)}function $o(Pn){for(var I,y=Pn.concat(),_=[],P=y.length;P--;)typeof(I=y.shift())=="string"?_.push(I):Array.isArray(Pn)&&(I.length===1||I[1]===void 0&&I[2]===void 0)?_.push(I[0]):_.push([I[0],I[1],I[2]]);return _}function Ws(Pn,I){var y;if(typeof Pn=="string")y=I(Pn)[0];else if(Array.isArray(Pn)){for(var _,P,$=Pn.concat(),ne=[],me=$.length;me--;)typeof(_=$.shift())=="string"?ne.push(I(_)[0]):Array.isArray(_)&&typeof _[0]=="string"&&(P=I(_[0],_[1],_[2]),ne.push([P[0],P[1],P[2]]));y=ne}return y}var Pa=!1,Xs=!0;if(typeof ue=="string")Pa=!0;else if(Array.isArray(ue)){var Il=ue.concat();Zr=[];for(var gs,Di=Il.length;Di--;)(typeof(gs=Il.shift())!="string"||Array.isArray(gs)&&typeof gs[0]!="string")&&(Xs=!1);Pa=Xs}if(Pa===!1)throw new Error('Type of text must be string or Array. "'+ue+'" is not recognized.');typeof ue=="string"&&(ue=ue.match(/[\r?\n]/)?ue.split(/\r\n|\r|\n/g):[ue]);var qo=_t/ra.internal.scaleFactor,Da=qo*(Hs-1);switch(zt.baseline){case"bottom":bt-=Da;break;case"top":bt+=qo-Da;break;case"hanging":bt+=qo-2*Da;break;case"middle":bt+=qo/2-Da}if((ui=zt.maxWidth||0)>0&&(typeof ue=="string"?ue=ra.splitTextToSize(ue,ui):Object.prototype.toString.call(ue)==="[object Array]"&&(ue=ue.reduce(function(Pn,I){return Pn.concat(ra.splitTextToSize(I,ui))},[]))),Nr={text:ue,x:We,y:bt,options:zt,mutex:{pdfEscape:xi,activeFontKey:je,fonts:mt,activeFontSize:_t}},en.publish("preProcessText",Nr),ue=Nr.text,Ln=(zt=Nr.options).angle,Xi instanceof un==0&&Ln&&typeof Ln=="number"){Ln*=Math.PI/180,zt.rotationDirection===0&&(Ln=-Ln),O===N&&(Ln=-Ln);var ns=Math.cos(Ln),As=Math.sin(Ln);Xi=new un(ns,As,-As,ns,0,0)}else Ln&&Ln instanceof un&&(Xi=Ln);O!==N||Xi||(Xi=Re),(Un=zt.charSpace||oa)!==void 0&&(za+=W(ae(Un))+` Tc
`,this.setCharSpace(this.getCharSpace()||0)),(Ui=zt.horizontalScale)!==void 0&&(za+=W(100*Ui)+` Tz
`),zt.lang;var Ja=-1,rc=zt.renderingMode!==void 0?zt.renderingMode:zt.stroke,uu=ra.internal.getCurrentPageInfo().pageContext;switch(rc){case 0:case!1:case"fill":Ja=0;break;case 1:case!0:case"stroke":Ja=1;break;case 2:case"fillThenStroke":Ja=2;break;case 3:case"invisible":Ja=3;break;case 4:case"fillAndAddForClipping":Ja=4;break;case 5:case"strokeAndAddPathForClipping":Ja=5;break;case 6:case"fillThenStrokeAndAddToPathForClipping":Ja=6;break;case 7:case"addToPathForClipping":Ja=7}var Ys=uu.usedRenderingMode!==void 0?uu.usedRenderingMode:-1;Ja!==-1?za+=Ja+` Tr
`:Ys!==-1&&(za+=`0 Tr
`),Ja!==-1&&(uu.usedRenderingMode=Ja),qn=zt.align||"left";var ja,Is=_t*Hs,nc=ra.internal.pageSize.getWidth(),ic=mt[je];Un=zt.charSpace||oa,ui=zt.maxWidth||0,Hn=Object.assign({autoencode:!0,noBOM:!0},zt.flags);var ul=[],cu=function(Pn){return ra.getStringUnitWidth(Pn,{font:ic,charSpace:Un,fontSize:_t,doKerning:!1})*_t/ll};if(Object.prototype.toString.call(ue)==="[object Array]"){var Oo;Zr=$o(ue),qn!=="left"&&(ja=Zr.map(cu));var mo,Du=0;if(qn==="right"){We-=ja[0],ue=[],Di=Zr.length;for(var Ua=0;Ua<Di;Ua++)Ua===0?(mo=$i(We),Oo=ba(bt)):(mo=ae(Du-ja[Ua]),Oo=-Is),ue.push([Zr[Ua],mo,Oo]),Du=ja[Ua]}else if(qn==="center"){We-=ja[0]/2,ue=[],Di=Zr.length;for(var fu=0;fu<Di;fu++)fu===0?(mo=$i(We),Oo=ba(bt)):(mo=ae((Du-ja[fu])/2),Oo=-Is),ue.push([Zr[fu],mo,Oo]),Du=ja[fu]}else if(qn==="left"){ue=[],Di=Zr.length;for(var Zs=0;Zs<Di;Zs++)ue.push(Zr[Zs])}else if(qn==="justify"&&ic.encoding==="Identity-H"){ue=[],Di=Zr.length,ui=ui!==0?ui:nc;for(var ms=0,Va=0;Va<Di;Va++)if(Oo=Va===0?ba(bt):-Is,mo=Va===0?$i(We):ms,Va<Di-1){var Vl=ae((ui-ja[Va])/(Zr[Va].split(" ").length-1)),cl=Zr[Va].split(" ");ue.push([cl[0]+" ",mo,Oo]),ms=0;for(var fl=1;fl<cl.length;fl++){var $l=(cu(cl[fl-1]+" "+cl[fl])-cu(cl[fl]))*ll+Vl;fl==cl.length-1?ue.push([cl[fl],$l,0]):ue.push([cl[fl]+" ",$l,0]),ms-=$l}}else ue.push([Zr[Va],mo,Oo]);ue.push(["",ms,0])}else{if(qn!=="justify")throw new Error('Unrecognized alignment option, use "left", "center", "right" or "justify".');for(ue=[],Di=Zr.length,ui=ui!==0?ui:nc,Va=0;Va<Di;Va++)Oo=Va===0?ba(bt):-Is,mo=Va===0?$i(We):0,Va<Di-1?ul.push(W(ae((ui-ja[Va])/(Zr[Va].split(" ").length-1)))):ul.push(0),ue.push([Zr[Va],mo,Oo])}}(typeof zt.R2L=="boolean"?zt.R2L:ar)===!0&&(ue=Ws(ue,function(Pn,I,y){return[Pn.split("").reverse().join(""),I,y]})),Nr={text:ue,x:We,y:bt,options:zt,mutex:{pdfEscape:xi,activeFontKey:je,fonts:mt,activeFontSize:_t}},en.publish("postProcessText",Nr),ue=Nr.text,Ia=Nr.mutex.isHex||!1;var ql=mt[je].encoding;ql!=="WinAnsiEncoding"&&ql!=="StandardEncoding"||(ue=Ws(ue,function(Pn,I,y){return[Gs(Pn),I,y]})),Zr=$o(ue),ue=[];for(var hl,Hl,Ou,tr=Array.isArray(Zr[0])?1:0,vr="",dn=function(Pn,I,y){var _="";return y instanceof un?(y=typeof zt.angle=="number"?Kn(y,new un(1,0,0,1,Pn,I)):Kn(new un(1,0,0,1,Pn,I),y),O===N&&(y=Kn(new un(1,0,0,-1,0,0),y)),_=y.join(" ")+` Tm
`):_=W(Pn)+" "+W(I)+` Td
`,_},In=0;In<Zr.length;In++){switch(vr="",tr){case 1:Ou=(Ia?"<":"(")+Zr[In][0]+(Ia?">":")"),hl=parseFloat(Zr[In][1]),Hl=parseFloat(Zr[In][2]);break;case 0:Ou=(Ia?"<":"(")+Zr[In]+(Ia?">":")"),hl=$i(We),Hl=ba(bt)}ul!==void 0&&ul[In]!==void 0&&(vr=ul[In]+` Tw
`),In===0?ue.push(vr+dn(hl,Hl,Xi)+Ou):tr===0?ue.push(vr+Ou):tr===1&&ue.push(vr+dn(hl,Hl,Xi)+Ou)}ue=tr===0?ue.join(` Tj
T* `):ue.join(` Tj
`),ue+=` Tj
`;var vi=`BT
/`;return vi+=je+" "+_t+` Tf
`,vi+=W(_t*Hs)+` TL
`,vi+=Mi+`
`,vi+=za,vi+=ue,$e(vi+="ET"),b[je]=!0,ra};var ee=x.__private__.clip=x.clip=function(ue){return $e(ue==="evenodd"?"W*":"W"),this};x.clipEvenOdd=function(){return ee("evenodd")},x.__private__.discardPath=x.discardPath=function(){return $e("n"),this};var pe=x.__private__.isValidStyle=function(ue){var We=!1;return[void 0,null,"S","D","F","DF","FD","f","f*","B","B*","n"].indexOf(ue)!==-1&&(We=!0),We};x.__private__.setDefaultPathOperation=x.setDefaultPathOperation=function(ue){return pe(ue)&&(f=ue),this};var Ke=x.__private__.getStyle=x.getStyle=function(ue){var We=f;switch(ue){case"D":case"S":We="S";break;case"F":We="f";break;case"FD":case"DF":We="B";break;case"f":case"f*":case"B":case"B*":We=ue}return We},It=x.close=function(){return $e("h"),this};x.stroke=function(){return $e("S"),this},x.fill=function(ue){return Vt("f",ue),this},x.fillEvenOdd=function(ue){return Vt("f*",ue),this},x.fillStroke=function(ue){return Vt("B",ue),this},x.fillStrokeEvenOdd=function(ue){return Vt("B*",ue),this};var Vt=function(ue,We){ho(We)==="object"?Yr(We,ue):$e(ue)},qt=function(ue){ue===null||O===N&&ue===void 0||(ue=Ke(ue),$e(ue))};function er(ue,We,bt,zt,lr){var Nr=new s0(We||this.boundingBox,bt||this.xStep,zt||this.yStep,this.gState,lr||this.matrix);Nr.stream=this.stream;var Zr=ue+"$$"+this.cloneIndex+++"$$";return He(Zr,Nr),Nr}var Yr=function(ue,We){var bt=Ir[ue.key],zt=Ht[bt];if(zt instanceof wm)$e("q"),$e(tn(We)),zt.gState&&x.setGState(zt.gState),$e(ue.matrix.toString()+" cm"),$e("/"+bt+" sh"),$e("Q");else if(zt instanceof s0){var lr=new un(1,0,0,-1,0,Do());ue.matrix&&(lr=lr.multiply(ue.matrix||Re),bt=er.call(zt,ue.key,ue.boundingBox,ue.xStep,ue.yStep,lr).id),$e("q"),$e("/Pattern cs"),$e("/"+bt+" scn"),zt.gState&&x.setGState(zt.gState),$e(We),$e("Q")}},tn=function(ue){switch(ue){case"f":case"F":case"n":return"W n";case"f*":return"W* n";case"B":case"S":return"W S";case"B*":return"W* S"}},Gr=x.moveTo=function(ue,We){return $e(W(ae(ue))+" "+W(se(We))+" m"),this},on=x.lineTo=function(ue,We){return $e(W(ae(ue))+" "+W(se(We))+" l"),this},kr=x.curveTo=function(ue,We,bt,zt,lr,Nr){return $e([W(ae(ue)),W(se(We)),W(ae(bt)),W(se(zt)),W(ae(lr)),W(se(Nr)),"c"].join(" ")),this};x.__private__.line=x.line=function(ue,We,bt,zt,lr){if(isNaN(ue)||isNaN(We)||isNaN(bt)||isNaN(zt)||!pe(lr))throw new Error("Invalid arguments passed to jsPDF.line");return O===F?this.lines([[bt-ue,zt-We]],ue,We,[1,1],lr||"S"):this.lines([[bt-ue,zt-We]],ue,We,[1,1]).stroke()},x.__private__.lines=x.lines=function(ue,We,bt,zt,lr,Nr){var Zr,Ln,qn,Un,ui,Hn,Ui,Xi,ra,Si,Ia,za;if(typeof ue=="number"&&(za=bt,bt=We,We=ue,ue=za),zt=zt||[1,1],Nr=Nr||!1,isNaN(We)||isNaN(bt)||!Array.isArray(ue)||!Array.isArray(zt)||!pe(lr)||typeof Nr!="boolean")throw new Error("Invalid arguments passed to jsPDF.lines");for(Gr(We,bt),Zr=zt[0],Ln=zt[1],Un=ue.length,Si=We,Ia=bt,qn=0;qn<Un;qn++)(ui=ue[qn]).length===2?(Si=ui[0]*Zr+Si,Ia=ui[1]*Ln+Ia,on(Si,Ia)):(Hn=ui[0]*Zr+Si,Ui=ui[1]*Ln+Ia,Xi=ui[2]*Zr+Si,ra=ui[3]*Ln+Ia,Si=ui[4]*Zr+Si,Ia=ui[5]*Ln+Ia,kr(Hn,Ui,Xi,ra,Si,Ia));return Nr&&It(),qt(lr),this},x.path=function(ue){for(var We=0;We<ue.length;We++){var bt=ue[We],zt=bt.c;switch(bt.op){case"m":Gr(zt[0],zt[1]);break;case"l":on(zt[0],zt[1]);break;case"c":kr.apply(this,zt);break;case"h":It()}}return this},x.__private__.rect=x.rect=function(ue,We,bt,zt,lr){if(isNaN(ue)||isNaN(We)||isNaN(bt)||isNaN(zt)||!pe(lr))throw new Error("Invalid arguments passed to jsPDF.rect");return O===F&&(zt=-zt),$e([W(ae(ue)),W(se(We)),W(ae(bt)),W(ae(zt)),"re"].join(" ")),qt(lr),this},x.__private__.triangle=x.triangle=function(ue,We,bt,zt,lr,Nr,Zr){if(isNaN(ue)||isNaN(We)||isNaN(bt)||isNaN(zt)||isNaN(lr)||isNaN(Nr)||!pe(Zr))throw new Error("Invalid arguments passed to jsPDF.triangle");return this.lines([[bt-ue,zt-We],[lr-bt,Nr-zt],[ue-lr,We-Nr]],ue,We,[1,1],Zr,!0),this},x.__private__.roundedRect=x.roundedRect=function(ue,We,bt,zt,lr,Nr,Zr){if(isNaN(ue)||isNaN(We)||isNaN(bt)||isNaN(zt)||isNaN(lr)||isNaN(Nr)||!pe(Zr))throw new Error("Invalid arguments passed to jsPDF.roundedRect");var Ln=4/3*(Math.SQRT2-1);return lr=Math.min(lr,.5*bt),Nr=Math.min(Nr,.5*zt),this.lines([[bt-2*lr,0],[lr*Ln,0,lr,Nr-Nr*Ln,lr,Nr],[0,zt-2*Nr],[0,Nr*Ln,-lr*Ln,Nr,-lr,Nr],[2*lr-bt,0],[-lr*Ln,0,-lr,-Nr*Ln,-lr,-Nr],[0,2*Nr-zt],[0,-Nr*Ln,lr*Ln,-Nr,lr,-Nr]],ue+lr,We,[1,1],Zr,!0),this},x.__private__.ellipse=x.ellipse=function(ue,We,bt,zt,lr){if(isNaN(ue)||isNaN(We)||isNaN(bt)||isNaN(zt)||!pe(lr))throw new Error("Invalid arguments passed to jsPDF.ellipse");var Nr=4/3*(Math.SQRT2-1)*bt,Zr=4/3*(Math.SQRT2-1)*zt;return Gr(ue+bt,We),kr(ue+bt,We-Zr,ue+Nr,We-zt,ue,We-zt),kr(ue-Nr,We-zt,ue-bt,We-Zr,ue-bt,We),kr(ue-bt,We+Zr,ue-Nr,We+zt,ue,We+zt),kr(ue+Nr,We+zt,ue+bt,We+Zr,ue+bt,We),qt(lr),this},x.__private__.circle=x.circle=function(ue,We,bt,zt){if(isNaN(ue)||isNaN(We)||isNaN(bt)||!pe(zt))throw new Error("Invalid arguments passed to jsPDF.circle");return this.ellipse(ue,We,bt,bt,zt)},x.setFont=function(ue,We,bt){return bt&&(We=H(We,bt)),je=Aa(ue,We,{disableWarning:!1}),this};var ti=x.__private__.getFont=x.getFont=function(){return mt[Aa.apply(x,arguments)]};x.__private__.getFontList=x.getFontList=function(){var ue,We,bt={};for(ue in ct)if(ct.hasOwnProperty(ue))for(We in bt[ue]=[],ct[ue])ct[ue].hasOwnProperty(We)&&bt[ue].push(We);return bt},x.addFont=function(ue,We,bt,zt,lr){var Nr=["StandardEncoding","MacRomanEncoding","Identity-H","WinAnsiEncoding"];return arguments[3]&&Nr.indexOf(arguments[3])!==-1?lr=arguments[3]:arguments[3]&&Nr.indexOf(arguments[3])==-1&&(bt=H(bt,zt)),ol.call(this,ue,We,bt,lr=lr||"Identity-H")};var Ri,$n=t.lineWidth||.200025,_n=x.__private__.getLineWidth=x.getLineWidth=function(){return $n},Mr=x.__private__.setLineWidth=x.setLineWidth=function(ue){return $n=ue,$e(W(ae(ue))+" w"),this};x.__private__.setLineDash=di.API.setLineDash=di.API.setLineDashPattern=function(ue,We){if(ue=ue||[],We=We||0,isNaN(We)||!Array.isArray(ue))throw new Error("Invalid arguments passed to jsPDF.setLineDash");return ue=ue.map(function(bt){return W(ae(bt))}).join(" "),We=W(ae(We)),$e("["+ue+"] "+We+" d"),this};var hn=x.__private__.getLineHeight=x.getLineHeight=function(){return _t*Ri};x.__private__.getLineHeight=x.getLineHeight=function(){return _t*Ri};var mn=x.__private__.setLineHeightFactor=x.setLineHeightFactor=function(ue){return typeof(ue=ue||1.15)=="number"&&(Ri=ue),this},fi=x.__private__.getLineHeightFactor=x.getLineHeightFactor=function(){return Ri};mn(t.lineHeight);var $i=x.__private__.getHorizontalCoordinate=function(ue){return ae(ue)},ba=x.__private__.getVerticalCoordinate=function(ue){return O===N?ue:Mt[Se].mediaBox.topRightY-Mt[Se].mediaBox.bottomLeftY-ae(ue)},wi=x.__private__.getHorizontalCoordinateString=x.getHorizontalCoordinateString=function(ue){return W($i(ue))},hi=x.__private__.getVerticalCoordinateString=x.getVerticalCoordinateString=function(ue){return W(ba(ue))},Ts=t.strokeColor||"0 G";x.__private__.getStrokeColor=x.getDrawColor=function(){return Fr(Ts)},x.__private__.setStrokeColor=x.setDrawColor=function(ue,We,bt,zt){return Ts=Mn({ch1:ue,ch2:We,ch3:bt,ch4:zt,pdfColorType:"draw",precision:2}),$e(Ts),this};var Vs=t.fillColor||"0 g";x.__private__.getFillColor=x.getFillColor=function(){return Fr(Vs)},x.__private__.setFillColor=x.setFillColor=function(ue,We,bt,zt){return Vs=Mn({ch1:ue,ch2:We,ch3:bt,ch4:zt,pdfColorType:"fill",precision:2}),$e(Vs),this};var Mi=t.textColor||"0 g",Cs=x.__private__.getTextColor=x.getTextColor=function(){return Fr(Mi)};x.__private__.setTextColor=x.setTextColor=function(ue,We,bt,zt){return Mi=Mn({ch1:ue,ch2:We,ch3:bt,ch4:zt,pdfColorType:"text",precision:3}),this};var oa=t.charSpace,ku=x.__private__.getCharSpace=x.getCharSpace=function(){return parseFloat(oa||0)};x.__private__.setCharSpace=x.setCharSpace=function(ue){if(isNaN(ue))throw new Error("Invalid argument passed to jsPDF.setCharSpace");return oa=ue,this};var Ka=0;x.CapJoinStyles={0:0,butt:0,but:0,miter:0,1:1,round:1,rounded:1,circle:1,2:2,projecting:2,project:2,square:2,bevel:2},x.__private__.setLineCap=x.setLineCap=function(ue){var We=x.CapJoinStyles[ue];if(We===void 0)throw new Error("Line cap style of '"+ue+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return Ka=We,$e(We+" J"),this};var $s=0;x.__private__.setLineJoin=x.setLineJoin=function(ue){var We=x.CapJoinStyles[ue];if(We===void 0)throw new Error("Line join style of '"+ue+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return $s=We,$e(We+" j"),this},x.__private__.setLineMiterLimit=x.__private__.setMiterLimit=x.setLineMiterLimit=x.setMiterLimit=function(ue){if(ue=ue||0,isNaN(ue))throw new Error("Invalid argument passed to jsPDF.setLineMiterLimit");return $e(W(ae(ue))+" M"),this},x.GState=QS,x.setGState=function(ue){(ue=typeof ue=="string"?Ar[$r[ue]]:Vo(null,ue)).equals(fn)||($e("/"+ue.id+" gs"),fn=ue)};var Vo=function(ue,We){if(!ue||!$r[ue]){var bt=!1;for(var zt in Ar)if(Ar.hasOwnProperty(zt)&&Ar[zt].equals(We)){bt=!0;break}if(bt)We=Ar[zt];else{var lr="GS"+(Object.keys(Ar).length+1).toString(10);Ar[lr]=We,We.id=lr}return ue&&($r[ue]=We.id),en.publish("addGState",We),We}};x.addGState=function(ue,We){return Vo(ue,We),this},x.saveGraphicsState=function(){return $e("q"),Qt.push({key:je,size:_t,color:Mi}),this},x.restoreGraphicsState=function(){$e("Q");var ue=Qt.pop();return je=ue.key,_t=ue.size,Mi=ue.color,fn=null,this},x.setCurrentTransformationMatrix=function(ue){return $e(ue.toString()+" cm"),this},x.comment=function(ue){return $e("#"+ue),this};var Ru=function(ue,We){var bt=ue||0;Object.defineProperty(this,"x",{enumerable:!0,get:function(){return bt},set:function(Nr){isNaN(Nr)||(bt=parseFloat(Nr))}});var zt=We||0;Object.defineProperty(this,"y",{enumerable:!0,get:function(){return zt},set:function(Nr){isNaN(Nr)||(zt=parseFloat(Nr))}});var lr="pt";return Object.defineProperty(this,"type",{enumerable:!0,get:function(){return lr},set:function(Nr){lr=Nr.toString()}}),this},Mu=function(ue,We,bt,zt){Ru.call(this,ue,We),this.type="rect";var lr=bt||0;Object.defineProperty(this,"w",{enumerable:!0,get:function(){return lr},set:function(Zr){isNaN(Zr)||(lr=parseFloat(Zr))}});var Nr=zt||0;return Object.defineProperty(this,"h",{enumerable:!0,get:function(){return Nr},set:function(Zr){isNaN(Zr)||(Nr=parseFloat(Zr))}}),this},go=function(){this.page=zr,this.currentPage=Se,this.pages=it.slice(0),this.pagesContext=Mt.slice(0),this.x=Ge,this.y=Ft,this.matrix=Et,this.width=ii(Se),this.height=Do(Se),this.outputDestination=Ot,this.id="",this.objectNumber=-1};go.prototype.restore=function(){zr=this.page,Se=this.currentPage,Mt=this.pagesContext,it=this.pages,Ge=this.x,Ft=this.y,Et=this.matrix,ri(Se,this.width),ai(Se,this.height),Ot=this.outputDestination};var ji=function(ue,We,bt,zt,lr){oi.push(new go),zr=Se=0,it=[],Ge=ue,Ft=We,Et=lr,zi([bt,zt])};for(var qs in x.beginFormObject=function(ue,We,bt,zt,lr){return ji(ue,We,bt,zt,lr),this},x.endFormObject=function(ue){return(function(We){if(nr[We])oi.pop().restore();else{var bt=new go,zt="Xo"+(Object.keys(Qr).length+1).toString(10);bt.id=zt,nr[We]=zt,Qr[zt]=bt,en.publish("addFormObject",bt),oi.pop().restore()}})(ue),this},x.doFormObject=function(ue,We){var bt=Qr[nr[ue]];return $e("q"),$e(We.toString()+" cm"),$e("/"+bt.id+" Do"),$e("Q"),this},x.getFormObject=function(ue){var We=Qr[nr[ue]];return{x:We.x,y:We.y,width:We.width,height:We.height,matrix:We.matrix}},x.save=function(ue,We){return ue=ue||"generated.pdf",(We=We||{}).returnPromise=We.returnPromise||!1,We.returnPromise===!1?(_m(ts(sl()),ue),typeof _m.unload=="function"&&Oi.setTimeout&&setTimeout(_m.unload,911),this):new Promise(function(bt,zt){try{var lr=_m(ts(sl()),ue);typeof _m.unload=="function"&&Oi.setTimeout&&setTimeout(_m.unload,911),bt(lr)}catch(Nr){zt(Nr.message)}})},di.API)di.API.hasOwnProperty(qs)&&(qs==="events"&&di.API.events.length?(function(ue,We){var bt,zt,lr;for(lr=We.length-1;lr!==-1;lr--)bt=We[lr][0],zt=We[lr][1],ue.subscribe.apply(ue,[bt].concat(typeof zt=="function"?[zt]:zt))})(en,di.API.events):x[qs]=di.API[qs]);var ii=x.getPageWidth=function(ue){return(Mt[ue=ue||Se].mediaBox.topRightX-Mt[ue].mediaBox.bottomLeftX)/qe},ri=x.setPageWidth=function(ue,We){Mt[ue].mediaBox.topRightX=We*qe+Mt[ue].mediaBox.bottomLeftX},Do=x.getPageHeight=function(ue){return(Mt[ue=ue||Se].mediaBox.topRightY-Mt[ue].mediaBox.bottomLeftY)/qe},ai=x.setPageHeight=function(ue,We){Mt[ue].mediaBox.topRightY=We*qe+Mt[ue].mediaBox.bottomLeftY};return x.internal={pdfEscape:xi,getStyle:Ke,getFont:ti,getFontSize:mr,getCharSpace:ku,getTextColor:Cs,getLineHeight:hn,getLineHeightFactor:fi,getLineWidth:_n,write:Xt,getHorizontalCoordinate:$i,getVerticalCoordinate:ba,getCoordinateString:wi,getVerticalCoordinateString:hi,collections:{},newObject:Gt,newAdditionalObject:Nn,newObjectDeferred:Ut,newObjectDeferredBegin:Xr,getFilters:Bn,putStream:ei,events:en,scaleFactor:qe,pageSize:{getWidth:function(){return ii(Se)},setWidth:function(ue){ri(Se,ue)},getHeight:function(){return Do(Se)},setHeight:function(ue){ai(Se,ue)}},encryptionOptions:d,encryption:Ba,getEncryptor:function(ue){return d!==null?Ba.encryptor(ue,0):function(We){return We}},output:oo,getNumberOfPages:ds,pages:it,out:$e,f2:Q,f3:G,getPageInfo:Us,getPageInfoByObjId:$c,getCurrentPageInfo:Pu,getPDFVersion:T,Point:Ru,Rectangle:Mu,Matrix:un,hasHotfix:rs},Object.defineProperty(x.internal.pageSize,"width",{get:function(){return ii(Se)},set:function(ue){ri(Se,ue)},enumerable:!0,configurable:!0}),Object.defineProperty(x.internal.pageSize,"height",{get:function(){return Do(Se)},set:function(ue){ai(Se,ue)},enumerable:!0,configurable:!0}),(function(ue){for(var We=0,bt=cr.length;We<bt;We++){var zt=ol.call(this,ue[We][0],ue[We][1],ue[We][2],cr[We][3],!0);m===!1&&(b[zt]=!0);var lr=ue[We][0].split("-");Ya({id:zt,fontName:lr[0],fontStyle:lr[1]||""})}en.publish("addFonts",{fonts:mt,dictionary:ct})}).call(x,cr),je="F1",Iu(i,r),en.publish("initialized"),x}Bv.prototype.lsbFirstWord=function(t){return String.fromCharCode(255&t,t>>8&255,t>>16&255,t>>24&255)},Bv.prototype.toHexString=function(t){return t.split("").map(function(e){return("0"+(255&e.charCodeAt(0)).toString(16)).slice(-2)}).join("")},Bv.prototype.hexToBytes=function(t){for(var e=[],r=0;r<t.length;r+=2)e.push(String.fromCharCode(parseInt(t.substr(r,2),16)));return e.join("")},Bv.prototype.processOwnerPassword=function(t,e){return tR(eR(e).substr(0,5),t)},Bv.prototype.encryptor=function(t,e){var r=eR(this.encryptionKey+String.fromCharCode(255&t,t>>8&255,t>>16&255,255&e,e>>8&255)).substr(0,10);return function(n){return tR(r,n)}},QS.prototype.equals=function(t){var e,r="id,objectNumber,equals";if(!t||ho(t)!==ho(this))return!1;var n=0;for(e in this)if(!(r.indexOf(e)>=0)){if(this.hasOwnProperty(e)&&!t.hasOwnProperty(e)||this[e]!==t[e])return!1;n++}for(e in t)t.hasOwnProperty(e)&&r.indexOf(e)<0&&n--;return n===0},di.API={events:[]},di.version="3.0.2";var zs=di.API,xO=1,wy=function(t){return t.replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},mv=function(t){return t.replace(/\\\\/g,"\\").replace(/\\\(/g,"(").replace(/\\\)/g,")")},Vi=function(t){return t.toFixed(2)},Qp=function(t){return t.toFixed(5)};zs.__acroform__={};var zc=function(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t},m9=function(t){return t*xO},ad=function(t){var e=new cZ,r=Qn.internal.getHeight(t)||0,n=Qn.internal.getWidth(t)||0;return e.BBox=[0,0,Number(Vi(n)),Number(Vi(r))],e},G0e=zs.__acroform__.setBit=function(t,e){if(t=t||0,e=e||0,isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBit");return t|1<<e},W0e=zs.__acroform__.clearBit=function(t,e){if(t=t||0,e=e||0,isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBit");return t&~(1<<e)},X0e=zs.__acroform__.getBit=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBit");return t&1<<e?1:0},el=zs.__acroform__.getBitForPdf=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBitForPdf");return X0e(t,e-1)},tl=zs.__acroform__.setBitForPdf=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBitForPdf");return G0e(t,e-1)},rl=zs.__acroform__.clearBitForPdf=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBitForPdf");return W0e(t,e-1)},Y0e=zs.__acroform__.calculateCoordinates=function(t,e){var r=e.internal.getHorizontalCoordinate,n=e.internal.getVerticalCoordinate,i=t[0],a=t[1],s=t[2],o=t[3],c={};return c.lowerLeft_X=r(i)||0,c.lowerLeft_Y=n(a+o)||0,c.upperRight_X=r(i+s)||0,c.upperRight_Y=n(a)||0,[Number(Vi(c.lowerLeft_X)),Number(Vi(c.lowerLeft_Y)),Number(Vi(c.upperRight_X)),Number(Vi(c.upperRight_Y))]},Z0e=function(t){if(t.appearanceStreamContent)return t.appearanceStreamContent;if(t.V||t.DV){var e=[],r=t._V||t.DV,n=rR(t,r),i=t.scope.internal.getFont(t.fontName,t.fontStyle).id;e.push("/Tx BMC"),e.push("q"),e.push("BT"),e.push(t.scope.__private__.encodeColorString(t.color)),e.push("/"+i+" "+Vi(n.fontSize)+" Tf"),e.push("1 0 0 1 0 0 Tm"),e.push(n.text),e.push("ET"),e.push("Q"),e.push("EMC");var a=ad(t);return a.scope=t.scope,a.stream=e.join(`
`),a}},rR=function(t,e){var r=t.fontSize===0?t.maxFontSize:t.fontSize,n={text:"",fontSize:""},i=(e=(e=e.substr(0,1)=="("?e.substr(1):e).substr(e.length-1)==")"?e.substr(0,e.length-1):e).split(" ");i=t.multiline?i.map(function(Q){return Q.split(`
`)}):i.map(function(Q){return[Q]});var a=r,s=Qn.internal.getHeight(t)||0;s=s<0?-s:s;var o=Qn.internal.getWidth(t)||0;o=o<0?-o:o;var c=function(Q,G,ae){if(Q+1<i.length){var se=G+" "+i[Q+1][0];return ow(se,t,ae).width<=o-4}return!1};a++;e:for(;a>0;){e="",a--;var f,d,m=ow("3",t,a).height,b=t.multiline?s-a:(s-m)/2,x=b+=2,E=0,T=0,A=0;if(a<=0){e=`(...) Tj
`,e+="% Width of Text: "+ow(e,t,a=12).width+", FieldWidth:"+o+`
`;break}for(var M="",F=0,N=0;N<i.length;N++)if(i.hasOwnProperty(N)){var O=!1;if(i[N].length!==1&&A!==i[N].length-1){if((m+2)*(F+2)+2>s)continue e;M+=i[N][A],O=!0,T=N,N--}else{M=(M+=i[N][A]+" ").substr(M.length-1)==" "?M.substr(0,M.length-1):M;var U=parseInt(N),j=c(U,M,a),H=N>=i.length-1;if(j&&!H){M+=" ",A=0;continue}if(j||H){if(H)T=U;else if(t.multiline&&(m+2)*(F+2)+2>s)continue e}else{if(!t.multiline||(m+2)*(F+2)+2>s)continue e;T=U}}for(var W="",X=E;X<=T;X++){var oe=i[X];if(t.multiline){if(X===T){W+=oe[A]+" ",A=(A+1)%oe.length;continue}if(X===E){W+=oe[oe.length-1]+" ";continue}}W+=oe[0]+" "}switch(W=W.substr(W.length-1)==" "?W.substr(0,W.length-1):W,d=ow(W,t,a).width,t.textAlign){case"right":f=o-d-2;break;case"center":f=(o-d)/2;break;default:f=2}e+=Vi(f)+" "+Vi(x)+` Td
`,e+="("+wy(W)+`) Tj
`,e+=-Vi(f)+` 0 Td
`,x=-(a+2),d=0,E=O?T:T+1,F++,M=""}break}return n.text=e,n.fontSize=a,n},ow=function(t,e,r){var n=e.scope.internal.getFont(e.fontName,e.fontStyle),i=e.scope.getStringUnitWidth(t,{font:n,fontSize:parseFloat(r),charSpace:0})*parseFloat(r);return{height:e.scope.getStringUnitWidth("3",{font:n,fontSize:parseFloat(r),charSpace:0})*parseFloat(r)*1.5,width:i}},K0e={fields:[],xForms:[],acroFormDictionaryRoot:null,printedOut:!1,internal:null,isInitialized:!1},J0e=function(t,e){var r={type:"reference",object:t};e.internal.getPageInfo(t.page).pageContext.annotations.find(function(n){return n.type===r.type&&n.object===r.object})===void 0&&e.internal.getPageInfo(t.page).pageContext.annotations.push(r)},Q0e=function(t,e){if(e.scope=t,t.internal!==void 0&&(t.internal.acroformPlugin===void 0||t.internal.acroformPlugin.isInitialized===!1)){if(Dh.FieldNum=0,t.internal.acroformPlugin=JSON.parse(JSON.stringify(K0e)),t.internal.acroformPlugin.acroFormDictionaryRoot)throw new Error("Exception while creating AcroformDictionary");xO=t.internal.scaleFactor,t.internal.acroformPlugin.acroFormDictionaryRoot=new fZ,t.internal.acroformPlugin.acroFormDictionaryRoot.scope=t,t.internal.acroformPlugin.acroFormDictionaryRoot._eventID=t.internal.events.subscribe("postPutResources",function(){(function(r){r.internal.events.unsubscribe(r.internal.acroformPlugin.acroFormDictionaryRoot._eventID),delete r.internal.acroformPlugin.acroFormDictionaryRoot._eventID,r.internal.acroformPlugin.printedOut=!0})(t)}),t.internal.events.subscribe("buildDocument",function(){(function(r){r.internal.acroformPlugin.acroFormDictionaryRoot.objId=void 0;var n=r.internal.acroformPlugin.acroFormDictionaryRoot.Fields;for(var i in n)if(n.hasOwnProperty(i)){var a=n[i];a.objId=void 0,a.hasAnnotation&&J0e(a,r)}})(t)}),t.internal.events.subscribe("putCatalog",function(){(function(r){if(r.internal.acroformPlugin.acroFormDictionaryRoot===void 0)throw new Error("putCatalogCallback: Root missing.");r.internal.write("/AcroForm "+r.internal.acroformPlugin.acroFormDictionaryRoot.objId+" 0 R")})(t)}),t.internal.events.subscribe("postPutPages",function(r){(function(n,i){var a=!n;for(var s in n||(i.internal.newObjectDeferredBegin(i.internal.acroformPlugin.acroFormDictionaryRoot.objId,!0),i.internal.acroformPlugin.acroFormDictionaryRoot.putStream()),n=n||i.internal.acroformPlugin.acroFormDictionaryRoot.Kids)if(n.hasOwnProperty(s)){var o=n[s],c=[],f=o.Rect;if(o.Rect&&(o.Rect=Y0e(o.Rect,i)),i.internal.newObjectDeferredBegin(o.objId,!0),o.DA=Qn.createDefaultAppearanceStream(o),ho(o)==="object"&&typeof o.getKeyValueListForStream=="function"&&(c=o.getKeyValueListForStream()),o.Rect=f,o.hasAppearanceStream&&!o.appearanceStreamContent){var d=Z0e(o);c.push({key:"AP",value:"<</N "+d+">>"}),i.internal.acroformPlugin.xForms.push(d)}if(o.appearanceStreamContent){var m="";for(var b in o.appearanceStreamContent)if(o.appearanceStreamContent.hasOwnProperty(b)){var x=o.appearanceStreamContent[b];if(m+="/"+b+" ",m+="<<",Object.keys(x).length>=1||Array.isArray(x)){for(var s in x)if(x.hasOwnProperty(s)){var E=x[s];typeof E=="function"&&(E=E.call(i,o)),m+="/"+s+" "+E+" ",i.internal.acroformPlugin.xForms.indexOf(E)>=0||i.internal.acroformPlugin.xForms.push(E)}}else typeof(E=x)=="function"&&(E=E.call(i,o)),m+="/"+s+" "+E,i.internal.acroformPlugin.xForms.indexOf(E)>=0||i.internal.acroformPlugin.xForms.push(E);m+=">>"}c.push({key:"AP",value:`<<
`+m+">>"})}i.internal.putStream({additionalKeyValues:c,objectId:o.objId}),i.internal.out("endobj")}a&&(function(T,A){for(var M in T)if(T.hasOwnProperty(M)){var F=M,N=T[M];A.internal.newObjectDeferredBegin(N.objId,!0),ho(N)==="object"&&typeof N.putStream=="function"&&N.putStream(),delete T[F]}})(i.internal.acroformPlugin.xForms,i)})(r,t)}),t.internal.acroformPlugin.isInitialized=!0}},uZ=zs.__acroform__.arrayToPdfArray=function(t,e,r){var n=function(s){return s};if(Array.isArray(t)){for(var i="[",a=0;a<t.length;a++)switch(a!==0&&(i+=" "),ho(t[a])){case"boolean":case"number":case"object":i+=t[a].toString();break;case"string":t[a].substr(0,1)!=="/"?(e!==void 0&&r&&(n=r.internal.getEncryptor(e)),i+="("+wy(n(t[a].toString()))+")"):i+=t[a].toString()}return i+"]"}throw new Error("Invalid argument passed to jsPDF.__acroform__.arrayToPdfArray")},BA=function(t,e,r){var n=function(i){return i};return e!==void 0&&r&&(n=r.internal.getEncryptor(e)),(t=t||"").toString(),"("+wy(n(t))+")"},hd=function(){this._objId=void 0,this._scope=void 0,Object.defineProperty(this,"objId",{get:function(){if(this._objId===void 0){if(this.scope===void 0)return;this._objId=this.scope.internal.newObjectDeferred()}return this._objId},set:function(t){this._objId=t}}),Object.defineProperty(this,"scope",{value:this._scope,writable:!0})};hd.prototype.toString=function(){return this.objId+" 0 R"},hd.prototype.putStream=function(){var t=this.getKeyValueListForStream();this.scope.internal.putStream({data:this.stream,additionalKeyValues:t,objectId:this.objId}),this.scope.internal.out("endobj")},hd.prototype.getKeyValueListForStream=function(){var t=[],e=Object.getOwnPropertyNames(this).filter(function(a){return a!="content"&&a!="appearanceStreamContent"&&a!="scope"&&a!="objId"&&a.substring(0,1)!="_"});for(var r in e)if(Object.getOwnPropertyDescriptor(this,e[r]).configurable===!1){var n=e[r],i=this[n];i&&(Array.isArray(i)?t.push({key:n,value:uZ(i,this.objId,this.scope)}):i instanceof hd?(i.scope=this.scope,t.push({key:n,value:i.objId+" 0 R"})):typeof i!="function"&&t.push({key:n,value:i}))}return t};var cZ=function(){hd.call(this),Object.defineProperty(this,"Type",{value:"/XObject",configurable:!1,writable:!0}),Object.defineProperty(this,"Subtype",{value:"/Form",configurable:!1,writable:!0}),Object.defineProperty(this,"FormType",{value:1,configurable:!1,writable:!0});var t,e=[];Object.defineProperty(this,"BBox",{configurable:!1,get:function(){return e},set:function(r){e=r}}),Object.defineProperty(this,"Resources",{value:"2 0 R",configurable:!1,writable:!0}),Object.defineProperty(this,"stream",{enumerable:!1,configurable:!0,set:function(r){t=r.trim()},get:function(){return t||null}})};zc(cZ,hd);var fZ=function(){hd.call(this);var t,e=[];Object.defineProperty(this,"Kids",{enumerable:!1,configurable:!0,get:function(){return e.length>0?e:void 0}}),Object.defineProperty(this,"Fields",{enumerable:!1,configurable:!1,get:function(){return e}}),Object.defineProperty(this,"DA",{enumerable:!1,configurable:!1,get:function(){if(t){var r=function(n){return n};return this.scope&&(r=this.scope.internal.getEncryptor(this.objId)),"("+wy(r(t))+")"}},set:function(r){t=r}})};zc(fZ,hd);var Dh=function t(){hd.call(this);var e=4;Object.defineProperty(this,"F",{enumerable:!1,configurable:!1,get:function(){return e},set:function(M){if(isNaN(M))throw new Error('Invalid value "'+M+'" for attribute F supplied.');e=M}}),Object.defineProperty(this,"showWhenPrinted",{enumerable:!0,configurable:!0,get:function(){return!!el(e,3)},set:function(M){M?this.F=tl(e,3):this.F=rl(e,3)}});var r=0;Object.defineProperty(this,"Ff",{enumerable:!1,configurable:!1,get:function(){return r},set:function(M){if(isNaN(M))throw new Error('Invalid value "'+M+'" for attribute Ff supplied.');r=M}});var n=[];Object.defineProperty(this,"Rect",{enumerable:!1,configurable:!1,get:function(){if(n.length!==0)return n},set:function(M){n=M!==void 0?M:[]}}),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[0])?0:n[0]},set:function(M){n[0]=M}}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[1])?0:n[1]},set:function(M){n[1]=M}}),Object.defineProperty(this,"width",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[2])?0:n[2]},set:function(M){n[2]=M}}),Object.defineProperty(this,"height",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[3])?0:n[3]},set:function(M){n[3]=M}});var i="";Object.defineProperty(this,"FT",{enumerable:!0,configurable:!1,get:function(){return i},set:function(M){switch(M){case"/Btn":case"/Tx":case"/Ch":case"/Sig":i=M;break;default:throw new Error('Invalid value "'+M+'" for attribute FT supplied.')}}});var a=null;Object.defineProperty(this,"T",{enumerable:!0,configurable:!1,get:function(){if(!a||a.length<1){if(this instanceof eE)return;a="FieldObject"+t.FieldNum++}var M=function(F){return F};return this.scope&&(M=this.scope.internal.getEncryptor(this.objId)),"("+wy(M(a))+")"},set:function(M){a=M.toString()}}),Object.defineProperty(this,"fieldName",{configurable:!0,enumerable:!0,get:function(){return a},set:function(M){a=M}});var s="helvetica";Object.defineProperty(this,"fontName",{enumerable:!0,configurable:!0,get:function(){return s},set:function(M){s=M}});var o="normal";Object.defineProperty(this,"fontStyle",{enumerable:!0,configurable:!0,get:function(){return o},set:function(M){o=M}});var c=0;Object.defineProperty(this,"fontSize",{enumerable:!0,configurable:!0,get:function(){return c},set:function(M){c=M}});var f=void 0;Object.defineProperty(this,"maxFontSize",{enumerable:!0,configurable:!0,get:function(){return f===void 0?50/xO:f},set:function(M){f=M}});var d="black";Object.defineProperty(this,"color",{enumerable:!0,configurable:!0,get:function(){return d},set:function(M){d=M}});var m="/F1 0 Tf 0 g";Object.defineProperty(this,"DA",{enumerable:!0,configurable:!1,get:function(){if(!(!m||this instanceof eE||this instanceof Bm))return BA(m,this.objId,this.scope)},set:function(M){M=M.toString(),m=M}});var b=null;Object.defineProperty(this,"DV",{enumerable:!1,configurable:!1,get:function(){if(b)return this instanceof nu==0?BA(b,this.objId,this.scope):b},set:function(M){M=M.toString(),b=this instanceof nu==0?M.substr(0,1)==="("?mv(M.substr(1,M.length-2)):mv(M):M}}),Object.defineProperty(this,"defaultValue",{enumerable:!0,configurable:!0,get:function(){return this instanceof nu==1?mv(b.substr(1,b.length-1)):b},set:function(M){M=M.toString(),b=this instanceof nu==1?"/"+M:M}});var x=null;Object.defineProperty(this,"_V",{enumerable:!1,configurable:!1,get:function(){if(x)return x},set:function(M){this.V=M}}),Object.defineProperty(this,"V",{enumerable:!1,configurable:!1,get:function(){if(x)return this instanceof nu==0?BA(x,this.objId,this.scope):x},set:function(M){M=M.toString(),x=this instanceof nu==0?M.substr(0,1)==="("?mv(M.substr(1,M.length-2)):mv(M):M}}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,get:function(){return this instanceof nu==1?mv(x.substr(1,x.length-1)):x},set:function(M){M=M.toString(),x=this instanceof nu==1?"/"+M:M}}),Object.defineProperty(this,"hasAnnotation",{enumerable:!0,configurable:!0,get:function(){return this.Rect}}),Object.defineProperty(this,"Type",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Annot":null}}),Object.defineProperty(this,"Subtype",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Widget":null}});var E,T=!1;Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return T},set:function(M){M=!!M,T=M}}),Object.defineProperty(this,"page",{enumerable:!0,configurable:!0,get:function(){if(E)return E},set:function(M){E=M}}),Object.defineProperty(this,"readOnly",{enumerable:!0,configurable:!0,get:function(){return!!el(this.Ff,1)},set:function(M){M?this.Ff=tl(this.Ff,1):this.Ff=rl(this.Ff,1)}}),Object.defineProperty(this,"required",{enumerable:!0,configurable:!0,get:function(){return!!el(this.Ff,2)},set:function(M){M?this.Ff=tl(this.Ff,2):this.Ff=rl(this.Ff,2)}}),Object.defineProperty(this,"noExport",{enumerable:!0,configurable:!0,get:function(){return!!el(this.Ff,3)},set:function(M){M?this.Ff=tl(this.Ff,3):this.Ff=rl(this.Ff,3)}});var A=null;Object.defineProperty(this,"Q",{enumerable:!0,configurable:!1,get:function(){if(A!==null)return A},set:function(M){if([0,1,2].indexOf(M)===-1)throw new Error('Invalid value "'+M+'" for attribute Q supplied.');A=M}}),Object.defineProperty(this,"textAlign",{get:function(){var M;switch(A){case 0:default:M="left";break;case 1:M="center";break;case 2:M="right"}return M},configurable:!0,enumerable:!0,set:function(M){switch(M){case"right":case 2:A=2;break;case"center":case 1:A=1;break;default:A=0}}})};zc(Dh,hd);var T0=function(){Dh.call(this),this.FT="/Ch",this.V="()",this.fontName="zapfdingbats";var t=0;Object.defineProperty(this,"TI",{enumerable:!0,configurable:!1,get:function(){return t},set:function(r){t=r}}),Object.defineProperty(this,"topIndex",{enumerable:!0,configurable:!0,get:function(){return t},set:function(r){t=r}});var e=[];Object.defineProperty(this,"Opt",{enumerable:!0,configurable:!1,get:function(){return uZ(e,this.objId,this.scope)},set:function(r){var n,i;i=[],typeof(n=r)=="string"&&(i=(function(a,s,o){o||(o=1);for(var c,f=[];c=s.exec(a);)f.push(c[o]);return f})(n,/\((.*?)\)/g)),e=i}}),this.getOptions=function(){return e},this.setOptions=function(r){e=r,this.sort&&e.sort()},this.addOption=function(r){r=(r=r||"").toString(),e.push(r),this.sort&&e.sort()},this.removeOption=function(r,n){for(n=n||!1,r=(r=r||"").toString();e.indexOf(r)!==-1&&(e.splice(e.indexOf(r),1),n!==!1););},Object.defineProperty(this,"combo",{enumerable:!0,configurable:!0,get:function(){return!!el(this.Ff,18)},set:function(r){r?this.Ff=tl(this.Ff,18):this.Ff=rl(this.Ff,18)}}),Object.defineProperty(this,"edit",{enumerable:!0,configurable:!0,get:function(){return!!el(this.Ff,19)},set:function(r){this.combo===!0&&(r?this.Ff=tl(this.Ff,19):this.Ff=rl(this.Ff,19))}}),Object.defineProperty(this,"sort",{enumerable:!0,configurable:!0,get:function(){return!!el(this.Ff,20)},set:function(r){r?(this.Ff=tl(this.Ff,20),e.sort()):this.Ff=rl(this.Ff,20)}}),Object.defineProperty(this,"multiSelect",{enumerable:!0,configurable:!0,get:function(){return!!el(this.Ff,22)},set:function(r){r?this.Ff=tl(this.Ff,22):this.Ff=rl(this.Ff,22)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!el(this.Ff,23)},set:function(r){r?this.Ff=tl(this.Ff,23):this.Ff=rl(this.Ff,23)}}),Object.defineProperty(this,"commitOnSelChange",{enumerable:!0,configurable:!0,get:function(){return!!el(this.Ff,27)},set:function(r){r?this.Ff=tl(this.Ff,27):this.Ff=rl(this.Ff,27)}}),this.hasAppearanceStream=!1};zc(T0,Dh);var C0=function(){T0.call(this),this.fontName="helvetica",this.combo=!1};zc(C0,T0);var A0=function(){C0.call(this),this.combo=!0};zc(A0,C0);var dS=function(){A0.call(this),this.edit=!0};zc(dS,A0);var nu=function(){Dh.call(this),this.FT="/Btn",Object.defineProperty(this,"noToggleToOff",{enumerable:!0,configurable:!0,get:function(){return!!el(this.Ff,15)},set:function(r){r?this.Ff=tl(this.Ff,15):this.Ff=rl(this.Ff,15)}}),Object.defineProperty(this,"radio",{enumerable:!0,configurable:!0,get:function(){return!!el(this.Ff,16)},set:function(r){r?this.Ff=tl(this.Ff,16):this.Ff=rl(this.Ff,16)}}),Object.defineProperty(this,"pushButton",{enumerable:!0,configurable:!0,get:function(){return!!el(this.Ff,17)},set:function(r){r?this.Ff=tl(this.Ff,17):this.Ff=rl(this.Ff,17)}}),Object.defineProperty(this,"radioIsUnison",{enumerable:!0,configurable:!0,get:function(){return!!el(this.Ff,26)},set:function(r){r?this.Ff=tl(this.Ff,26):this.Ff=rl(this.Ff,26)}});var t,e={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var r=function(a){return a};if(this.scope&&(r=this.scope.internal.getEncryptor(this.objId)),Object.keys(e).length!==0){var n,i=[];for(n in i.push("<<"),e)i.push("/"+n+" ("+wy(r(e[n]))+")");return i.push(">>"),i.join(`
`)}},set:function(r){ho(r)==="object"&&(e=r)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return e.CA||""},set:function(r){typeof r=="string"&&(e.CA=r)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return t},set:function(r){t=r}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return t.substr(1,t.length-1)},set:function(r){t="/"+r}})};zc(nu,Dh);var pS=function(){nu.call(this),this.pushButton=!0};zc(pS,nu);var I0=function(){nu.call(this),this.radio=!0,this.pushButton=!1;var t=[];Object.defineProperty(this,"Kids",{enumerable:!0,configurable:!1,get:function(){return t},set:function(e){t=e!==void 0?e:[]}})};zc(I0,nu);var eE=function(){var t,e;Dh.call(this),Object.defineProperty(this,"Parent",{enumerable:!1,configurable:!1,get:function(){return t},set:function(i){t=i}}),Object.defineProperty(this,"optionName",{enumerable:!1,configurable:!0,get:function(){return e},set:function(i){e=i}});var r,n={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var i=function(o){return o};this.scope&&(i=this.scope.internal.getEncryptor(this.objId));var a,s=[];for(a in s.push("<<"),n)s.push("/"+a+" ("+wy(i(n[a]))+")");return s.push(">>"),s.join(`
`)},set:function(i){ho(i)==="object"&&(n=i)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return n.CA||""},set:function(i){typeof i=="string"&&(n.CA=i)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return r},set:function(i){r=i}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return r.substr(1,r.length-1)},set:function(i){r="/"+i}}),this.caption="l",this.appearanceState="Off",this._AppearanceType=Qn.RadioButton.Circle,this.appearanceStreamContent=this._AppearanceType.createAppearanceStream(this.optionName)};zc(eE,Dh),I0.prototype.setAppearance=function(t){if(!("createAppearanceStream"in t)||!("getCA"in t))throw new Error("Couldn't assign Appearance to RadioButton. Appearance was Invalid!");for(var e in this.Kids)if(this.Kids.hasOwnProperty(e)){var r=this.Kids[e];r.appearanceStreamContent=t.createAppearanceStream(r.optionName),r.caption=t.getCA()}},I0.prototype.createOption=function(t){var e=new eE;return e.Parent=this,e.optionName=t,this.Kids.push(e),e_e.call(this.scope,e),e};var gS=function(){nu.call(this),this.fontName="zapfdingbats",this.caption="3",this.appearanceState="On",this.value="On",this.textAlign="center",this.appearanceStreamContent=Qn.CheckBox.createAppearanceStream()};zc(gS,nu);var Bm=function(){Dh.call(this),this.FT="/Tx",Object.defineProperty(this,"multiline",{enumerable:!0,configurable:!0,get:function(){return!!el(this.Ff,13)},set:function(e){e?this.Ff=tl(this.Ff,13):this.Ff=rl(this.Ff,13)}}),Object.defineProperty(this,"fileSelect",{enumerable:!0,configurable:!0,get:function(){return!!el(this.Ff,21)},set:function(e){e?this.Ff=tl(this.Ff,21):this.Ff=rl(this.Ff,21)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!el(this.Ff,23)},set:function(e){e?this.Ff=tl(this.Ff,23):this.Ff=rl(this.Ff,23)}}),Object.defineProperty(this,"doNotScroll",{enumerable:!0,configurable:!0,get:function(){return!!el(this.Ff,24)},set:function(e){e?this.Ff=tl(this.Ff,24):this.Ff=rl(this.Ff,24)}}),Object.defineProperty(this,"comb",{enumerable:!0,configurable:!0,get:function(){return!!el(this.Ff,25)},set:function(e){e?this.Ff=tl(this.Ff,25):this.Ff=rl(this.Ff,25)}}),Object.defineProperty(this,"richText",{enumerable:!0,configurable:!0,get:function(){return!!el(this.Ff,26)},set:function(e){e?this.Ff=tl(this.Ff,26):this.Ff=rl(this.Ff,26)}});var t=null;Object.defineProperty(this,"MaxLen",{enumerable:!0,configurable:!1,get:function(){return t},set:function(e){t=e}}),Object.defineProperty(this,"maxLength",{enumerable:!0,configurable:!0,get:function(){return t},set:function(e){Number.isInteger(e)&&(t=e)}}),Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return this.V||this.DV}})};zc(Bm,Dh);var mS=function(){Bm.call(this),Object.defineProperty(this,"password",{enumerable:!0,configurable:!0,get:function(){return!!el(this.Ff,14)},set:function(t){t?this.Ff=tl(this.Ff,14):this.Ff=rl(this.Ff,14)}}),this.password=!0};zc(mS,Bm);var Qn={CheckBox:{createAppearanceStream:function(){return{N:{On:Qn.CheckBox.YesNormal},D:{On:Qn.CheckBox.YesPushDown,Off:Qn.CheckBox.OffPushDown}}},YesPushDown:function(t){var e=ad(t);e.scope=t.scope;var r=[],n=t.scope.internal.getFont(t.fontName,t.fontStyle).id,i=t.scope.__private__.encodeColorString(t.color),a=rR(t,t.caption);return r.push("0.749023 g"),r.push("0 0 "+Vi(Qn.internal.getWidth(t))+" "+Vi(Qn.internal.getHeight(t))+" re"),r.push("f"),r.push("BMC"),r.push("q"),r.push("0 0 1 rg"),r.push("/"+n+" "+Vi(a.fontSize)+" Tf "+i),r.push("BT"),r.push(a.text),r.push("ET"),r.push("Q"),r.push("EMC"),e.stream=r.join(`
`),e},YesNormal:function(t){var e=ad(t);e.scope=t.scope;var r=t.scope.internal.getFont(t.fontName,t.fontStyle).id,n=t.scope.__private__.encodeColorString(t.color),i=[],a=Qn.internal.getHeight(t),s=Qn.internal.getWidth(t),o=rR(t,t.caption);return i.push("1 g"),i.push("0 0 "+Vi(s)+" "+Vi(a)+" re"),i.push("f"),i.push("q"),i.push("0 0 1 rg"),i.push("0 0 "+Vi(s-1)+" "+Vi(a-1)+" re"),i.push("W"),i.push("n"),i.push("0 g"),i.push("BT"),i.push("/"+r+" "+Vi(o.fontSize)+" Tf "+n),i.push(o.text),i.push("ET"),i.push("Q"),e.stream=i.join(`
`),e},OffPushDown:function(t){var e=ad(t);e.scope=t.scope;var r=[];return r.push("0.749023 g"),r.push("0 0 "+Vi(Qn.internal.getWidth(t))+" "+Vi(Qn.internal.getHeight(t))+" re"),r.push("f"),e.stream=r.join(`
`),e}},RadioButton:{Circle:{createAppearanceStream:function(t){var e={D:{Off:Qn.RadioButton.Circle.OffPushDown},N:{}};return e.N[t]=Qn.RadioButton.Circle.YesNormal,e.D[t]=Qn.RadioButton.Circle.YesPushDown,e},getCA:function(){return"l"},YesNormal:function(t){var e=ad(t);e.scope=t.scope;var r=[],n=Qn.internal.getWidth(t)<=Qn.internal.getHeight(t)?Qn.internal.getWidth(t)/4:Qn.internal.getHeight(t)/4;n=Number((.9*n).toFixed(5));var i=Qn.internal.Bezier_C,a=Number((n*i).toFixed(5));return r.push("q"),r.push("1 0 0 1 "+Qp(Qn.internal.getWidth(t)/2)+" "+Qp(Qn.internal.getHeight(t)/2)+" cm"),r.push(n+" 0 m"),r.push(n+" "+a+" "+a+" "+n+" 0 "+n+" c"),r.push("-"+a+" "+n+" -"+n+" "+a+" -"+n+" 0 c"),r.push("-"+n+" -"+a+" -"+a+" -"+n+" 0 -"+n+" c"),r.push(a+" -"+n+" "+n+" -"+a+" "+n+" 0 c"),r.push("f"),r.push("Q"),e.stream=r.join(`
`),e},YesPushDown:function(t){var e=ad(t);e.scope=t.scope;var r=[],n=Qn.internal.getWidth(t)<=Qn.internal.getHeight(t)?Qn.internal.getWidth(t)/4:Qn.internal.getHeight(t)/4;n=Number((.9*n).toFixed(5));var i=Number((2*n).toFixed(5)),a=Number((i*Qn.internal.Bezier_C).toFixed(5)),s=Number((n*Qn.internal.Bezier_C).toFixed(5));return r.push("0.749023 g"),r.push("q"),r.push("1 0 0 1 "+Qp(Qn.internal.getWidth(t)/2)+" "+Qp(Qn.internal.getHeight(t)/2)+" cm"),r.push(i+" 0 m"),r.push(i+" "+a+" "+a+" "+i+" 0 "+i+" c"),r.push("-"+a+" "+i+" -"+i+" "+a+" -"+i+" 0 c"),r.push("-"+i+" -"+a+" -"+a+" -"+i+" 0 -"+i+" c"),r.push(a+" -"+i+" "+i+" -"+a+" "+i+" 0 c"),r.push("f"),r.push("Q"),r.push("0 g"),r.push("q"),r.push("1 0 0 1 "+Qp(Qn.internal.getWidth(t)/2)+" "+Qp(Qn.internal.getHeight(t)/2)+" cm"),r.push(n+" 0 m"),r.push(n+" "+s+" "+s+" "+n+" 0 "+n+" c"),r.push("-"+s+" "+n+" -"+n+" "+s+" -"+n+" 0 c"),r.push("-"+n+" -"+s+" -"+s+" -"+n+" 0 -"+n+" c"),r.push(s+" -"+n+" "+n+" -"+s+" "+n+" 0 c"),r.push("f"),r.push("Q"),e.stream=r.join(`
`),e},OffPushDown:function(t){var e=ad(t);e.scope=t.scope;var r=[],n=Qn.internal.getWidth(t)<=Qn.internal.getHeight(t)?Qn.internal.getWidth(t)/4:Qn.internal.getHeight(t)/4;n=Number((.9*n).toFixed(5));var i=Number((2*n).toFixed(5)),a=Number((i*Qn.internal.Bezier_C).toFixed(5));return r.push("0.749023 g"),r.push("q"),r.push("1 0 0 1 "+Qp(Qn.internal.getWidth(t)/2)+" "+Qp(Qn.internal.getHeight(t)/2)+" cm"),r.push(i+" 0 m"),r.push(i+" "+a+" "+a+" "+i+" 0 "+i+" c"),r.push("-"+a+" "+i+" -"+i+" "+a+" -"+i+" 0 c"),r.push("-"+i+" -"+a+" -"+a+" -"+i+" 0 -"+i+" c"),r.push(a+" -"+i+" "+i+" -"+a+" "+i+" 0 c"),r.push("f"),r.push("Q"),e.stream=r.join(`
`),e}},Cross:{createAppearanceStream:function(t){var e={D:{Off:Qn.RadioButton.Cross.OffPushDown},N:{}};return e.N[t]=Qn.RadioButton.Cross.YesNormal,e.D[t]=Qn.RadioButton.Cross.YesPushDown,e},getCA:function(){return"8"},YesNormal:function(t){var e=ad(t);e.scope=t.scope;var r=[],n=Qn.internal.calculateCross(t);return r.push("q"),r.push("1 1 "+Vi(Qn.internal.getWidth(t)-2)+" "+Vi(Qn.internal.getHeight(t)-2)+" re"),r.push("W"),r.push("n"),r.push(Vi(n.x1.x)+" "+Vi(n.x1.y)+" m"),r.push(Vi(n.x2.x)+" "+Vi(n.x2.y)+" l"),r.push(Vi(n.x4.x)+" "+Vi(n.x4.y)+" m"),r.push(Vi(n.x3.x)+" "+Vi(n.x3.y)+" l"),r.push("s"),r.push("Q"),e.stream=r.join(`
`),e},YesPushDown:function(t){var e=ad(t);e.scope=t.scope;var r=Qn.internal.calculateCross(t),n=[];return n.push("0.749023 g"),n.push("0 0 "+Vi(Qn.internal.getWidth(t))+" "+Vi(Qn.internal.getHeight(t))+" re"),n.push("f"),n.push("q"),n.push("1 1 "+Vi(Qn.internal.getWidth(t)-2)+" "+Vi(Qn.internal.getHeight(t)-2)+" re"),n.push("W"),n.push("n"),n.push(Vi(r.x1.x)+" "+Vi(r.x1.y)+" m"),n.push(Vi(r.x2.x)+" "+Vi(r.x2.y)+" l"),n.push(Vi(r.x4.x)+" "+Vi(r.x4.y)+" m"),n.push(Vi(r.x3.x)+" "+Vi(r.x3.y)+" l"),n.push("s"),n.push("Q"),e.stream=n.join(`
`),e},OffPushDown:function(t){var e=ad(t);e.scope=t.scope;var r=[];return r.push("0.749023 g"),r.push("0 0 "+Vi(Qn.internal.getWidth(t))+" "+Vi(Qn.internal.getHeight(t))+" re"),r.push("f"),e.stream=r.join(`
`),e}}},createDefaultAppearanceStream:function(t){var e=t.scope.internal.getFont(t.fontName,t.fontStyle).id,r=t.scope.__private__.encodeColorString(t.color);return"/"+e+" "+t.fontSize+" Tf "+r}};Qn.internal={Bezier_C:.551915024494,calculateCross:function(t){var e=Qn.internal.getWidth(t),r=Qn.internal.getHeight(t),n=Math.min(e,r);return{x1:{x:(e-n)/2,y:(r-n)/2+n},x2:{x:(e-n)/2+n,y:(r-n)/2},x3:{x:(e-n)/2,y:(r-n)/2},x4:{x:(e-n)/2+n,y:(r-n)/2+n}}}},Qn.internal.getWidth=function(t){var e=0;return ho(t)==="object"&&(e=m9(t.Rect[2])),e},Qn.internal.getHeight=function(t){var e=0;return ho(t)==="object"&&(e=m9(t.Rect[3])),e};var e_e=zs.addField=function(t){if(Q0e(this,t),!(t instanceof Dh))throw new Error("Invalid argument passed to jsPDF.addField.");var e;return(e=t).scope.internal.acroformPlugin.printedOut&&(e.scope.internal.acroformPlugin.printedOut=!1,e.scope.internal.acroformPlugin.acroFormDictionaryRoot=null),e.scope.internal.acroformPlugin.acroFormDictionaryRoot.Fields.push(e),t.page=t.scope.internal.getCurrentPageInfo().pageNumber,this};zs.AcroFormChoiceField=T0,zs.AcroFormListBox=C0,zs.AcroFormComboBox=A0,zs.AcroFormEditBox=dS,zs.AcroFormButton=nu,zs.AcroFormPushButton=pS,zs.AcroFormRadioButton=I0,zs.AcroFormCheckBox=gS,zs.AcroFormTextField=Bm,zs.AcroFormPasswordField=mS,zs.AcroFormAppearance=Qn,zs.AcroForm={ChoiceField:T0,ListBox:C0,ComboBox:A0,EditBox:dS,Button:nu,PushButton:pS,RadioButton:I0,CheckBox:gS,TextField:Bm,PasswordField:mS,Appearance:Qn},di.AcroForm={ChoiceField:T0,ListBox:C0,ComboBox:A0,EditBox:dS,Button:nu,PushButton:pS,RadioButton:I0,CheckBox:gS,TextField:Bm,PasswordField:mS,Appearance:Qn};di.AcroForm;function hZ(t){return t.reduce(function(e,r,n){return e[r]=n,e},{})}(function(t){var e="addImage_";t.__addimage__={};var r="UNKNOWN",n={PNG:[[137,80,78,71]],TIFF:[[77,77,0,42],[73,73,42,0]],JPEG:[[255,216,255,224,void 0,void 0,74,70,73,70,0],[255,216,255,225,void 0,void 0,69,120,105,102,0,0],[255,216,255,219],[255,216,255,238]],JPEG2000:[[0,0,0,12,106,80,32,32]],GIF87a:[[71,73,70,56,55,97]],GIF89a:[[71,73,70,56,57,97]],WEBP:[[82,73,70,70,void 0,void 0,void 0,void 0,87,69,66,80]],BMP:[[66,77],[66,65],[67,73],[67,80],[73,67],[80,84]]},i=t.__addimage__.getImageFileTypeByImageData=function(Q,G){var ae,se,fe,_e,Le,ye=r;if((G=G||r)==="RGBA"||Q.data!==void 0&&Q.data instanceof Uint8ClampedArray&&"height"in Q&&"width"in Q)return"RGBA";if(j(Q))for(Le in n)for(fe=n[Le],ae=0;ae<fe.length;ae+=1){for(_e=!0,se=0;se<fe[ae].length;se+=1)if(fe[ae][se]!==void 0&&fe[ae][se]!==Q[se]){_e=!1;break}if(_e===!0){ye=Le;break}}else for(Le in n)for(fe=n[Le],ae=0;ae<fe.length;ae+=1){for(_e=!0,se=0;se<fe[ae].length;se+=1)if(fe[ae][se]!==void 0&&fe[ae][se]!==Q.charCodeAt(se)){_e=!1;break}if(_e===!0){ye=Le;break}}return ye===r&&G!==r&&(ye=G),ye},a=function Q(G){for(var ae=this.internal.write,se=this.internal.putStream,fe=(0,this.internal.getFilters)();fe.indexOf("FlateEncode")!==-1;)fe.splice(fe.indexOf("FlateEncode"),1);G.objectId=this.internal.newObject();var _e=[];if(_e.push({key:"Type",value:"/XObject"}),_e.push({key:"Subtype",value:"/Image"}),_e.push({key:"Width",value:G.width}),_e.push({key:"Height",value:G.height}),G.colorSpace===M.INDEXED?_e.push({key:"ColorSpace",value:"[/Indexed /DeviceRGB "+(G.palette.length/3-1)+" "+("sMask"in G&&G.sMask!==void 0?G.objectId+2:G.objectId+1)+" 0 R]"}):(_e.push({key:"ColorSpace",value:"/"+G.colorSpace}),G.colorSpace===M.DEVICE_CMYK&&_e.push({key:"Decode",value:"[1 0 1 0 1 0 1 0]"})),_e.push({key:"BitsPerComponent",value:G.bitsPerComponent}),"decodeParameters"in G&&G.decodeParameters!==void 0&&_e.push({key:"DecodeParms",value:"<<"+G.decodeParameters+">>"}),"transparency"in G&&Array.isArray(G.transparency)){for(var Le="",ye=0,Te=G.transparency.length;ye<Te;ye++)Le+=G.transparency[ye]+" "+G.transparency[ye]+" ";_e.push({key:"Mask",value:"["+Le+"]"})}G.sMask!==void 0&&_e.push({key:"SMask",value:G.objectId+1+" 0 R"});var Ie=G.filter!==void 0?["/"+G.filter]:void 0;if(se({data:G.data,additionalKeyValues:_e,alreadyAppliedFilters:Ie,objectId:G.objectId}),ae("endobj"),"sMask"in G&&G.sMask!==void 0){var Me=(G.predictor!=null?"/Predictor "+G.predictor:"")+" /Colors 1 /BitsPerComponent 8 /Columns "+G.width,de={width:G.width,height:G.height,colorSpace:"DeviceGray",bitsPerComponent:G.bitsPerComponent,decodeParameters:Me,data:G.sMask};"filter"in G&&(de.filter=G.filter),Q.call(this,de)}if(G.colorSpace===M.INDEXED){var Se=this.internal.newObject();se({data:W(new Uint8Array(G.palette)),objectId:Se}),ae("endobj")}},s=function(){var Q=this.internal.collections[e+"images"];for(var G in Q)a.call(this,Q[G])},o=function(){var Q,G=this.internal.collections[e+"images"],ae=this.internal.write;for(var se in G)ae("/I"+(Q=G[se]).index,Q.objectId,"0","R")},c=function(){this.internal.collections[e+"images"]||(this.internal.collections[e+"images"]={},this.internal.events.subscribe("putResources",s),this.internal.events.subscribe("putXobjectDict",o))},f=function(){var Q=this.internal.collections[e+"images"];return c.call(this),Q},d=function(){return Object.keys(this.internal.collections[e+"images"]).length},m=function(Q){return typeof t["process"+Q.toUpperCase()]=="function"},b=function(Q){return ho(Q)==="object"&&Q.nodeType===1},x=function(Q,G){if(Q.nodeName==="IMG"&&Q.hasAttribute("src")){var ae=""+Q.getAttribute("src");if(ae.indexOf("data:image/")===0)return hS(unescape(ae).split("base64,").pop());var se=t.loadFile(ae,!0);if(se!==void 0)return se}if(Q.nodeName==="CANVAS"){if(Q.width===0||Q.height===0)throw new Error("Given canvas must have data. Canvas width: "+Q.width+", height: "+Q.height);var fe;switch(G){case"PNG":fe="image/png";break;case"WEBP":fe="image/webp";break;default:fe="image/jpeg"}return hS(Q.toDataURL(fe,1).split("base64,").pop())}},E=function(Q){var G=this.internal.collections[e+"images"];if(G){for(var ae in G)if(Q===G[ae].alias)return G[ae]}},T=function(Q,G,ae){return Q||G||(Q=-96,G=-96),Q<0&&(Q=-1*ae.width*72/Q/this.internal.scaleFactor),G<0&&(G=-1*ae.height*72/G/this.internal.scaleFactor),Q===0&&(Q=G*ae.width/ae.height),G===0&&(G=Q*ae.height/ae.width),[Q,G]},A=function(Q,G,ae,se,fe,_e){var Le=T.call(this,ae,se,fe),ye=this.internal.getCoordinateString,Te=this.internal.getVerticalCoordinateString,Ie=f.call(this);if(ae=Le[0],se=Le[1],Ie[fe.index]=fe,_e){_e*=Math.PI/180;var Me=Math.cos(_e),de=Math.sin(_e),Se=function(De){return De.toFixed(4)},we=[Se(Me),Se(de),Se(-1*de),Se(Me),0,0,"cm"]}this.internal.write("q"),_e?(this.internal.write([1,"0","0",1,ye(Q),Te(G+se),"cm"].join(" ")),this.internal.write(we.join(" ")),this.internal.write([ye(ae),"0","0",ye(se),"0","0","cm"].join(" "))):this.internal.write([ye(ae),"0","0",ye(se),ye(Q),Te(G+se),"cm"].join(" ")),this.isAdvancedAPI()&&this.internal.write([1,0,0,-1,0,0,"cm"].join(" ")),this.internal.write("/I"+fe.index+" Do"),this.internal.write("Q")},M=t.color_spaces={DEVICE_RGB:"DeviceRGB",DEVICE_GRAY:"DeviceGray",DEVICE_CMYK:"DeviceCMYK",CAL_GREY:"CalGray",CAL_RGB:"CalRGB",LAB:"Lab",ICC_BASED:"ICCBased",INDEXED:"Indexed",PATTERN:"Pattern",SEPARATION:"Separation",DEVICE_N:"DeviceN"};t.decode={DCT_DECODE:"DCTDecode",FLATE_DECODE:"FlateDecode",LZW_DECODE:"LZWDecode",JPX_DECODE:"JPXDecode",JBIG2_DECODE:"JBIG2Decode",ASCII85_DECODE:"ASCII85Decode",ASCII_HEX_DECODE:"ASCIIHexDecode",RUN_LENGTH_DECODE:"RunLengthDecode",CCITT_FAX_DECODE:"CCITTFaxDecode"};var F=t.image_compression={NONE:"NONE",FAST:"FAST",MEDIUM:"MEDIUM",SLOW:"SLOW"},N=t.__addimage__.sHashCode=function(Q){var G,ae,se=0;if(typeof Q=="string")for(ae=Q.length,G=0;G<ae;G++)se=(se<<5)-se+Q.charCodeAt(G),se|=0;else if(j(Q))for(ae=Q.byteLength/2,G=0;G<ae;G++)se=(se<<5)-se+Q[G],se|=0;return se},O=t.__addimage__.validateStringAsBase64=function(Q){(Q=Q||"").toString().trim();var G=!0;return Q.length===0&&(G=!1),Q.length%4!=0&&(G=!1),/^[A-Za-z0-9+/]+$/.test(Q.substr(0,Q.length-2))===!1&&(G=!1),/^[A-Za-z0-9/][A-Za-z0-9+/]|[A-Za-z0-9+/]=|==$/.test(Q.substr(-2))===!1&&(G=!1),G},U=t.__addimage__.extractImageFromDataUrl=function(Q){if(Q==null||!(Q=Q.trim()).startsWith("data:"))return null;var G=Q.indexOf(",");return G<0?null:Q.substring(0,G).trim().endsWith("base64")?Q.substring(G+1):null};t.__addimage__.isArrayBuffer=function(Q){return Q instanceof ArrayBuffer};var j=t.__addimage__.isArrayBufferView=function(Q){return Q instanceof Int8Array||Q instanceof Uint8Array||Q instanceof Uint8ClampedArray||Q instanceof Int16Array||Q instanceof Uint16Array||Q instanceof Int32Array||Q instanceof Uint32Array||Q instanceof Float32Array||Q instanceof Float64Array},H=t.__addimage__.binaryStringToUint8Array=function(Q){for(var G=Q.length,ae=new Uint8Array(G),se=0;se<G;se++)ae[se]=Q.charCodeAt(se);return ae},W=t.__addimage__.arrayBufferToBinaryString=function(Q){for(var G="",ae=j(Q)?Q:new Uint8Array(Q),se=0;se<ae.length;se+=8192)G+=String.fromCharCode.apply(null,ae.subarray(se,se+8192));return G};t.addImage=function(){var Q,G,ae,se,fe,_e,Le,ye,Te;if(typeof arguments[1]=="number"?(G=r,ae=arguments[1],se=arguments[2],fe=arguments[3],_e=arguments[4],Le=arguments[5],ye=arguments[6],Te=arguments[7]):(G=arguments[1],ae=arguments[2],se=arguments[3],fe=arguments[4],_e=arguments[5],Le=arguments[6],ye=arguments[7],Te=arguments[8]),ho(Q=arguments[0])==="object"&&!b(Q)&&"imageData"in Q){var Ie=Q;Q=Ie.imageData,G=Ie.format||G||r,ae=Ie.x||ae||0,se=Ie.y||se||0,fe=Ie.w||Ie.width||fe,_e=Ie.h||Ie.height||_e,Le=Ie.alias||Le,ye=Ie.compression||ye,Te=Ie.rotation||Ie.angle||Te}var Me=this.internal.getFilters();if(ye===void 0&&Me.indexOf("FlateEncode")!==-1&&(ye="SLOW"),isNaN(ae)||isNaN(se))throw new Error("Invalid coordinates passed to jsPDF.addImage");c.call(this);var de=X.call(this,Q,G,Le,ye);return A.call(this,ae,se,fe,_e,de,Te),this};var X=function(Q,G,ae,se){var fe,_e,Le;if(typeof Q=="string"&&i(Q)===r){Q=unescape(Q);var ye=oe(Q,!1);(ye!==""||(ye=t.loadFile(Q,!0))!==void 0)&&(Q=ye)}if(b(Q)&&(Q=x(Q,G)),G=i(Q,G),!m(G))throw new Error("addImage does not support files of type '"+G+"', please ensure that a plugin for '"+G+"' support is added.");if(((Le=ae)==null||Le.length===0)&&(ae=(function(Te){return typeof Te=="string"||j(Te)?N(Te):j(Te.data)?N(Te.data):null})(Q)),(fe=E.call(this,ae))||(Q instanceof Uint8Array||G==="RGBA"||(_e=Q,Q=H(Q)),fe=this["process"+G.toUpperCase()](Q,d.call(this),ae,(function(Te){return Te&&typeof Te=="string"&&(Te=Te.toUpperCase()),Te in t.image_compression?Te:F.NONE})(se),_e)),!fe)throw new Error("An unknown error occurred whilst processing the image.");return fe},oe=t.__addimage__.convertBase64ToBinaryString=function(Q,G){G=typeof G!="boolean"||G;var ae,se="";if(typeof Q=="string"){var fe;ae=(fe=U(Q))!==null&&fe!==void 0?fe:Q;try{se=hS(ae)}catch(_e){if(G)throw O(ae)?new Error("atob-Error in jsPDF.convertBase64ToBinaryString "+_e.message):new Error("Supplied Data is not a valid base64-String jsPDF.convertBase64ToBinaryString ")}}return se};t.getImageProperties=function(Q){var G,ae,se="";if(b(Q)&&(Q=x(Q)),typeof Q=="string"&&i(Q)===r&&((se=oe(Q,!1))===""&&(se=t.loadFile(Q)||""),Q=se),ae=i(Q),!m(ae))throw new Error("addImage does not support files of type '"+ae+"', please ensure that a plugin for '"+ae+"' support is added.");if(Q instanceof Uint8Array||(Q=H(Q)),!(G=this["process"+ae.toUpperCase()](Q)))throw new Error("An unknown error occurred whilst processing the image");return G.fileType=ae,G}})(di.API),(function(t){var e=function(r){if(r!==void 0&&r!="")return!0};di.API.events.push(["addPage",function(r){this.internal.getPageInfo(r.pageNumber).pageContext.annotations=[]}]),t.events.push(["putPage",function(r){for(var n,i,a,s=this.internal.getCoordinateString,o=this.internal.getVerticalCoordinateString,c=this.internal.getPageInfoByObjId(r.objId),f=r.pageContext.annotations,d=!1,m=0;m<f.length&&!d;m++)switch((n=f[m]).type){case"link":(e(n.options.url)||e(n.options.pageNumber))&&(d=!0);break;case"reference":case"text":case"freetext":d=!0}if(d!=0){this.internal.write("/Annots [");for(var b=0;b<f.length;b++){n=f[b];var x=this.internal.pdfEscape,E=this.internal.getEncryptor(r.objId);switch(n.type){case"reference":this.internal.write(" "+n.object.objId+" 0 R ");break;case"text":var T=this.internal.newAdditionalObject(),A=this.internal.newAdditionalObject(),M=this.internal.getEncryptor(T.objId),F=n.title||"Note";a="<</Type /Annot /Subtype /Text "+(i="/Rect ["+s(n.bounds.x)+" "+o(n.bounds.y+n.bounds.h)+" "+s(n.bounds.x+n.bounds.w)+" "+o(n.bounds.y)+"] ")+"/Contents ("+x(M(n.contents))+")",a+=" /Popup "+A.objId+" 0 R",a+=" /P "+c.objId+" 0 R",a+=" /T ("+x(M(F))+") >>",T.content=a;var N=T.objId+" 0 R";a="<</Type /Annot /Subtype /Popup "+(i="/Rect ["+s(n.bounds.x+30)+" "+o(n.bounds.y+n.bounds.h)+" "+s(n.bounds.x+n.bounds.w+30)+" "+o(n.bounds.y)+"] ")+" /Parent "+N,n.open&&(a+=" /Open true"),a+=" >>",A.content=a,this.internal.write(T.objId,"0 R",A.objId,"0 R");break;case"freetext":i="/Rect ["+s(n.bounds.x)+" "+o(n.bounds.y)+" "+s(n.bounds.x+n.bounds.w)+" "+o(n.bounds.y+n.bounds.h)+"] ";var O=n.color||"#000000";a="<</Type /Annot /Subtype /FreeText "+i+"/Contents ("+x(E(n.contents))+")",a+=" /DS(font: Helvetica,sans-serif 12.0pt; text-align:left; color:#"+O+")",a+=" /Border [0 0 0]",a+=" >>",this.internal.write(a);break;case"link":if(n.options.name){var U=this.annotations._nameMap[n.options.name];n.options.pageNumber=U.page,n.options.top=U.y}else n.options.top||(n.options.top=0);if(i="/Rect ["+n.finalBounds.x+" "+n.finalBounds.y+" "+n.finalBounds.w+" "+n.finalBounds.h+"] ",a="",n.options.url)a="<</Type /Annot /Subtype /Link "+i+"/Border [0 0 0] /A <</S /URI /URI ("+x(E(n.options.url))+") >>";else if(n.options.pageNumber)switch(a="<</Type /Annot /Subtype /Link "+i+"/Border [0 0 0] /Dest ["+this.internal.getPageInfo(n.options.pageNumber).objId+" 0 R",n.options.magFactor=n.options.magFactor||"XYZ",n.options.magFactor){case"Fit":a+=" /Fit]";break;case"FitH":a+=" /FitH "+n.options.top+"]";break;case"FitV":n.options.left=n.options.left||0,a+=" /FitV "+n.options.left+"]";break;default:var j=o(n.options.top);n.options.left=n.options.left||0,n.options.zoom===void 0&&(n.options.zoom=0),a+=" /XYZ "+n.options.left+" "+j+" "+n.options.zoom+"]"}a!=""&&(a+=" >>",this.internal.write(a))}}this.internal.write("]")}}]),t.createAnnotation=function(r){var n=this.internal.getCurrentPageInfo();switch(r.type){case"link":this.link(r.bounds.x,r.bounds.y,r.bounds.w,r.bounds.h,r);break;case"text":case"freetext":n.pageContext.annotations.push(r)}},t.link=function(r,n,i,a,s){var o=this.internal.getCurrentPageInfo(),c=this.internal.getCoordinateString,f=this.internal.getVerticalCoordinateString;o.pageContext.annotations.push({finalBounds:{x:c(r),y:f(n),w:c(r+i),h:f(n+a)},options:s,type:"link"})},t.textWithLink=function(r,n,i,a){var s,o,c=this.getTextWidth(r),f=this.internal.getLineHeight()/this.internal.scaleFactor;if(a.maxWidth!==void 0){o=a.maxWidth;var d=this.splitTextToSize(r,o).length;s=Math.ceil(f*d)}else o=c,s=f;return this.text(r,n,i,a),i+=.2*f,a.align==="center"&&(n-=c/2),a.align==="right"&&(n-=c),this.link(n,i-f,o,s,a),c},t.getTextWidth=function(r){var n=this.internal.getFontSize();return this.getStringUnitWidth(r)*n/this.internal.scaleFactor}})(di.API),(function(t){var e={1569:[65152],1570:[65153,65154],1571:[65155,65156],1572:[65157,65158],1573:[65159,65160],1574:[65161,65162,65163,65164],1575:[65165,65166],1576:[65167,65168,65169,65170],1577:[65171,65172],1578:[65173,65174,65175,65176],1579:[65177,65178,65179,65180],1580:[65181,65182,65183,65184],1581:[65185,65186,65187,65188],1582:[65189,65190,65191,65192],1583:[65193,65194],1584:[65195,65196],1585:[65197,65198],1586:[65199,65200],1587:[65201,65202,65203,65204],1588:[65205,65206,65207,65208],1589:[65209,65210,65211,65212],1590:[65213,65214,65215,65216],1591:[65217,65218,65219,65220],1592:[65221,65222,65223,65224],1593:[65225,65226,65227,65228],1594:[65229,65230,65231,65232],1601:[65233,65234,65235,65236],1602:[65237,65238,65239,65240],1603:[65241,65242,65243,65244],1604:[65245,65246,65247,65248],1605:[65249,65250,65251,65252],1606:[65253,65254,65255,65256],1607:[65257,65258,65259,65260],1608:[65261,65262],1609:[65263,65264,64488,64489],1610:[65265,65266,65267,65268],1649:[64336,64337],1655:[64477],1657:[64358,64359,64360,64361],1658:[64350,64351,64352,64353],1659:[64338,64339,64340,64341],1662:[64342,64343,64344,64345],1663:[64354,64355,64356,64357],1664:[64346,64347,64348,64349],1667:[64374,64375,64376,64377],1668:[64370,64371,64372,64373],1670:[64378,64379,64380,64381],1671:[64382,64383,64384,64385],1672:[64392,64393],1676:[64388,64389],1677:[64386,64387],1678:[64390,64391],1681:[64396,64397],1688:[64394,64395],1700:[64362,64363,64364,64365],1702:[64366,64367,64368,64369],1705:[64398,64399,64400,64401],1709:[64467,64468,64469,64470],1711:[64402,64403,64404,64405],1713:[64410,64411,64412,64413],1715:[64406,64407,64408,64409],1722:[64414,64415],1723:[64416,64417,64418,64419],1726:[64426,64427,64428,64429],1728:[64420,64421],1729:[64422,64423,64424,64425],1733:[64480,64481],1734:[64473,64474],1735:[64471,64472],1736:[64475,64476],1737:[64482,64483],1739:[64478,64479],1740:[64508,64509,64510,64511],1744:[64484,64485,64486,64487],1746:[64430,64431],1747:[64432,64433]},r={65247:{65154:65269,65156:65271,65160:65273,65166:65275},65248:{65154:65270,65156:65272,65160:65274,65166:65276},65165:{65247:{65248:{65258:65010}}},1617:{1612:64606,1613:64607,1614:64608,1615:64609,1616:64610}},n={1612:64606,1613:64607,1614:64608,1615:64609,1616:64610},i=[1570,1571,1573,1575];t.__arabicParser__={};var a=t.__arabicParser__.isInArabicSubstitutionA=function(T){return e[T.charCodeAt(0)]!==void 0},s=t.__arabicParser__.isArabicLetter=function(T){return typeof T=="string"&&/^[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDFF\uFE70-\uFEFF]+$/.test(T)},o=t.__arabicParser__.isArabicEndLetter=function(T){return s(T)&&a(T)&&e[T.charCodeAt(0)].length<=2},c=t.__arabicParser__.isArabicAlfLetter=function(T){return s(T)&&i.indexOf(T.charCodeAt(0))>=0};t.__arabicParser__.arabicLetterHasIsolatedForm=function(T){return s(T)&&a(T)&&e[T.charCodeAt(0)].length>=1};var f=t.__arabicParser__.arabicLetterHasFinalForm=function(T){return s(T)&&a(T)&&e[T.charCodeAt(0)].length>=2};t.__arabicParser__.arabicLetterHasInitialForm=function(T){return s(T)&&a(T)&&e[T.charCodeAt(0)].length>=3};var d=t.__arabicParser__.arabicLetterHasMedialForm=function(T){return s(T)&&a(T)&&e[T.charCodeAt(0)].length==4},m=t.__arabicParser__.resolveLigatures=function(T){var A=0,M=r,F="",N=0;for(A=0;A<T.length;A+=1)M[T.charCodeAt(A)]!==void 0?(N++,typeof(M=M[T.charCodeAt(A)])=="number"&&(F+=String.fromCharCode(M),M=r,N=0),A===T.length-1&&(M=r,F+=T.charAt(A-(N-1)),A-=N-1,N=0)):(M=r,F+=T.charAt(A-N),A-=N,N=0);return F};t.__arabicParser__.isArabicDiacritic=function(T){return T!==void 0&&n[T.charCodeAt(0)]!==void 0};var b=t.__arabicParser__.getCorrectForm=function(T,A,M){return s(T)?a(T)===!1?-1:!f(T)||!s(A)&&!s(M)||!s(M)&&o(A)||o(T)&&!s(A)||o(T)&&c(A)||o(T)&&o(A)?0:d(T)&&s(A)&&!o(A)&&s(M)&&f(M)?3:o(T)||!s(M)?1:2:-1},x=function(T){var A=0,M=0,F=0,N="",O="",U="",j=(T=T||"").split("\\s+"),H=[];for(A=0;A<j.length;A+=1){for(H.push(""),M=0;M<j[A].length;M+=1)N=j[A][M],O=j[A][M-1],U=j[A][M+1],s(N)?(F=b(N,O,U),H[A]+=F!==-1?String.fromCharCode(e[N.charCodeAt(0)][F]):N):H[A]+=N;H[A]=m(H[A])}return H.join(" ")},E=t.__arabicParser__.processArabic=t.processArabic=function(){var T,A=typeof arguments[0]=="string"?arguments[0]:arguments[0].text,M=[];if(Array.isArray(A)){var F=0;for(M=[],F=0;F<A.length;F+=1)Array.isArray(A[F])?M.push([x(A[F][0]),A[F][1],A[F][2]]):M.push([x(A[F])]);T=M}else T=x(A);return typeof arguments[0]=="string"?T:(arguments[0].text=T,arguments[0])};t.events.push(["preProcessText",E])})(di.API),di.API.autoPrint=function(t){var e;return(t=t||{}).variant=t.variant||"non-conform",t.variant==="javascript"?this.addJS("print({});"):(this.internal.events.subscribe("postPutResources",function(){e=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /Named"),this.internal.out("/Type /Action"),this.internal.out("/N /Print"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){this.internal.out("/OpenAction "+e+" 0 R")})),this},(function(t){var e=function(){var r=void 0;Object.defineProperty(this,"pdf",{get:function(){return r},set:function(o){r=o}});var n=150;Object.defineProperty(this,"width",{get:function(){return n},set:function(o){n=isNaN(o)||Number.isInteger(o)===!1||o<0?150:o,this.getContext("2d").pageWrapXEnabled&&(this.getContext("2d").pageWrapX=n+1)}});var i=300;Object.defineProperty(this,"height",{get:function(){return i},set:function(o){i=isNaN(o)||Number.isInteger(o)===!1||o<0?300:o,this.getContext("2d").pageWrapYEnabled&&(this.getContext("2d").pageWrapY=i+1)}});var a=[];Object.defineProperty(this,"childNodes",{get:function(){return a},set:function(o){a=o}});var s={};Object.defineProperty(this,"style",{get:function(){return s},set:function(o){s=o}}),Object.defineProperty(this,"parentNode",{})};e.prototype.getContext=function(r,n){var i;if((r=r||"2d")!=="2d")return null;for(i in n)this.pdf.context2d.hasOwnProperty(i)&&(this.pdf.context2d[i]=n[i]);return this.pdf.context2d._canvas=this,this.pdf.context2d},e.prototype.toDataURL=function(){throw new Error("toDataURL is not implemented.")},t.events.push(["initialized",function(){this.canvas=new e,this.canvas.pdf=this}])})(di.API),(function(t){var e={left:0,top:0,bottom:0,right:0},r=!1,n=function(){this.internal.__cell__===void 0&&(this.internal.__cell__={},this.internal.__cell__.padding=3,this.internal.__cell__.headerFunction=void 0,this.internal.__cell__.margins=Object.assign({},e),this.internal.__cell__.margins.width=this.getPageWidth(),i.call(this))},i=function(){this.internal.__cell__.lastCell=new a,this.internal.__cell__.pages=1},a=function(){var c=arguments[0];Object.defineProperty(this,"x",{enumerable:!0,get:function(){return c},set:function(T){c=T}});var f=arguments[1];Object.defineProperty(this,"y",{enumerable:!0,get:function(){return f},set:function(T){f=T}});var d=arguments[2];Object.defineProperty(this,"width",{enumerable:!0,get:function(){return d},set:function(T){d=T}});var m=arguments[3];Object.defineProperty(this,"height",{enumerable:!0,get:function(){return m},set:function(T){m=T}});var b=arguments[4];Object.defineProperty(this,"text",{enumerable:!0,get:function(){return b},set:function(T){b=T}});var x=arguments[5];Object.defineProperty(this,"lineNumber",{enumerable:!0,get:function(){return x},set:function(T){x=T}});var E=arguments[6];return Object.defineProperty(this,"align",{enumerable:!0,get:function(){return E},set:function(T){E=T}}),this};a.prototype.clone=function(){return new a(this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align)},a.prototype.toArray=function(){return[this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align]},t.setHeaderFunction=function(c){return n.call(this),this.internal.__cell__.headerFunction=typeof c=="function"?c:void 0,this},t.getTextDimensions=function(c,f){n.call(this);var d=(f=f||{}).fontSize||this.getFontSize(),m=f.font||this.getFont(),b=f.scaleFactor||this.internal.scaleFactor,x=0,E=0,T=0,A=this;if(!Array.isArray(c)&&typeof c!="string"){if(typeof c!="number")throw new Error("getTextDimensions expects text-parameter to be of type String or type Number or an Array of Strings.");c=String(c)}var M=f.maxWidth;M>0?typeof c=="string"?c=this.splitTextToSize(c,M):Object.prototype.toString.call(c)==="[object Array]"&&(c=c.reduce(function(N,O){return N.concat(A.splitTextToSize(O,M))},[])):c=Array.isArray(c)?c:[c];for(var F=0;F<c.length;F++)x<(T=this.getStringUnitWidth(c[F],{font:m})*d)&&(x=T);return x!==0&&(E=c.length),{w:x/=b,h:Math.max((E*d*this.getLineHeightFactor()-d*(this.getLineHeightFactor()-1))/b,0)}},t.cellAddPage=function(){n.call(this),this.addPage();var c=this.internal.__cell__.margins||e;return this.internal.__cell__.lastCell=new a(c.left,c.top,void 0,void 0),this.internal.__cell__.pages+=1,this};var s=t.cell=function(){var c;c=arguments[0]instanceof a?arguments[0]:new a(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5]),n.call(this);var f=this.internal.__cell__.lastCell,d=this.internal.__cell__.padding,m=this.internal.__cell__.margins||e,b=this.internal.__cell__.tableHeaderRow,x=this.internal.__cell__.printHeaders;return f.lineNumber!==void 0&&(f.lineNumber===c.lineNumber?(c.x=(f.x||0)+(f.width||0),c.y=f.y||0):f.y+f.height+c.height+m.bottom>this.getPageHeight()?(this.cellAddPage(),c.y=m.top,x&&b&&(this.printHeaderRow(c.lineNumber,!0),c.y+=b[0].height)):c.y=f.y+f.height||c.y),c.text[0]!==void 0&&(this.rect(c.x,c.y,c.width,c.height,r===!0?"FD":void 0),c.align==="right"?this.text(c.text,c.x+c.width-d,c.y+d,{align:"right",baseline:"top"}):c.align==="center"?this.text(c.text,c.x+c.width/2,c.y+d,{align:"center",baseline:"top",maxWidth:c.width-d-d}):this.text(c.text,c.x+d,c.y+d,{align:"left",baseline:"top",maxWidth:c.width-d-d})),this.internal.__cell__.lastCell=c,this};t.table=function(c,f,d,m,b){if(n.call(this),!d)throw new Error("No data for PDF table.");var x,E,T,A,M=[],F=[],N=[],O={},U={},j=[],H=[],W=(b=b||{}).autoSize||!1,X=b.printHeaders!==!1,oe=b.css&&b.css["font-size"]!==void 0?16*b.css["font-size"]:b.fontSize||12,Q=b.margins||Object.assign({width:this.getPageWidth()},e),G=typeof b.padding=="number"?b.padding:3,ae=b.headerBackgroundColor||"#c8c8c8",se=b.headerTextColor||"#000";if(i.call(this),this.internal.__cell__.printHeaders=X,this.internal.__cell__.margins=Q,this.internal.__cell__.table_font_size=oe,this.internal.__cell__.padding=G,this.internal.__cell__.headerBackgroundColor=ae,this.internal.__cell__.headerTextColor=se,this.setFontSize(oe),m==null)F=M=Object.keys(d[0]),N=M.map(function(){return"left"});else if(Array.isArray(m)&&ho(m[0])==="object")for(M=m.map(function(Ie){return Ie.name}),F=m.map(function(Ie){return Ie.prompt||Ie.name||""}),N=m.map(function(Ie){return Ie.align||"left"}),x=0;x<m.length;x+=1)U[m[x].name]=.7499990551181103*m[x].width;else Array.isArray(m)&&typeof m[0]=="string"&&(F=M=m,N=M.map(function(){return"left"}));if(W||Array.isArray(m)&&typeof m[0]=="string")for(x=0;x<M.length;x+=1){for(O[A=M[x]]=d.map(function(Ie){return Ie[A]}),this.setFont(void 0,"bold"),j.push(this.getTextDimensions(F[x],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w),E=O[A],this.setFont(void 0,"normal"),T=0;T<E.length;T+=1)j.push(this.getTextDimensions(E[T],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w);U[A]=Math.max.apply(null,j)+G+G,j=[]}if(X){var fe={};for(x=0;x<M.length;x+=1)fe[M[x]]={},fe[M[x]].text=F[x],fe[M[x]].align=N[x];var _e=o.call(this,fe,U);H=M.map(function(Ie){return new a(c,f,U[Ie],_e,fe[Ie].text,void 0,fe[Ie].align)}),this.setTableHeaderRow(H),this.printHeaderRow(1,!1)}var Le=m.reduce(function(Ie,Me){return Ie[Me.name]=Me.align,Ie},{});for(x=0;x<d.length;x+=1){"rowStart"in b&&b.rowStart instanceof Function&&b.rowStart({row:x,data:d[x]},this);var ye=o.call(this,d[x],U);for(T=0;T<M.length;T+=1){var Te=d[x][M[T]];"cellStart"in b&&b.cellStart instanceof Function&&b.cellStart({row:x,col:T,data:Te},this),s.call(this,new a(c,f,U[M[T]],ye,Te,x+2,Le[M[T]]))}}return this.internal.__cell__.table_x=c,this.internal.__cell__.table_y=f,this};var o=function(c,f){var d=this.internal.__cell__.padding,m=this.internal.__cell__.table_font_size,b=this.internal.scaleFactor;return Object.keys(c).map(function(x){var E=c[x];return this.splitTextToSize(E.hasOwnProperty("text")?E.text:E,f[x]-d-d)},this).map(function(x){return this.getLineHeightFactor()*x.length*m/b+d+d},this).reduce(function(x,E){return Math.max(x,E)},0)};t.setTableHeaderRow=function(c){n.call(this),this.internal.__cell__.tableHeaderRow=c},t.printHeaderRow=function(c,f){if(n.call(this),!this.internal.__cell__.tableHeaderRow)throw new Error("Property tableHeaderRow does not exist.");var d;if(r=!0,typeof this.internal.__cell__.headerFunction=="function"){var m=this.internal.__cell__.headerFunction(this,this.internal.__cell__.pages);this.internal.__cell__.lastCell=new a(m[0],m[1],m[2],m[3],void 0,-1)}this.setFont(void 0,"bold");for(var b=[],x=0;x<this.internal.__cell__.tableHeaderRow.length;x+=1){d=this.internal.__cell__.tableHeaderRow[x].clone(),f&&(d.y=this.internal.__cell__.margins.top||0,b.push(d)),d.lineNumber=c;var E=this.getTextColor();this.setTextColor(this.internal.__cell__.headerTextColor),this.setFillColor(this.internal.__cell__.headerBackgroundColor),s.call(this,d),this.setTextColor(E)}b.length>0&&this.setTableHeaderRow(b),this.setFont(void 0,"normal"),r=!1}})(di.API);var dZ={italic:["italic","oblique","normal"],oblique:["oblique","italic","normal"],normal:["normal","oblique","italic"]},pZ=["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded"],nR=hZ(pZ),gZ=[100,200,300,400,500,600,700,800,900],t_e=hZ(gZ);function zA(t){var e=t.family.replace(/"|'/g,"").toLowerCase(),r=(function(a){return dZ[a=a||"normal"]?a:"normal"})(t.style),n=(function(a){return a?typeof a=="number"?a>=100&&a<=900&&a%100==0?a:400:/^\d00$/.test(a)?parseInt(a):a==="bold"?700:400:400})(t.weight),i=(function(a){return typeof nR[a=a||"normal"]=="number"?a:"normal"})(t.stretch);return{family:e,style:r,weight:n,stretch:i,src:t.src||[],ref:t.ref||{name:e,style:[i,r,n].join(" ")}}}function y9(t,e,r,n){var i;for(i=r;i>=0&&i<e.length;i+=n)if(t[e[i]])return t[e[i]];for(i=r;i>=0&&i<e.length;i-=n)if(t[e[i]])return t[e[i]]}var r_e={"sans-serif":"helvetica",fixed:"courier",monospace:"courier",terminal:"courier",cursive:"times",fantasy:"times",serif:"times"},v9={caption:"times",icon:"times",menu:"times","message-box":"times","small-caption":"times","status-bar":"times"};function _9(t){return[t.stretch,t.style,t.weight,t.family].join(" ")}function b9(t){return t.trimLeft()}function n_e(t,e){for(var r=0;r<t.length;){if(t.charAt(r)===e)return[t.substring(0,r),t.substring(r+1)];r+=1}return null}function i_e(t){var e=t.match(/^(-[a-z_]|[a-z_])[a-z0-9_-]*/i);return e===null?null:[e[0],t.substring(e[0].length)]}var sw,x9,w9,yv,lw,S9,E9,T9,jA=["times"];function C9(t,e,r,n){var i=4,a=I9;switch(n){case di.API.image_compression.FAST:i=1,a=A9;break;case di.API.image_compression.MEDIUM:i=6,a=P9;break;case di.API.image_compression.SLOW:i=9,a=k9}t=(function(o,c,f,d){for(var m,b=o.length/c,x=new Uint8Array(o.length+b),E=[a_e,A9,I9,P9,k9],T=0;T<b;T+=1){var A=T*c,M=o.subarray(A,A+c);if(d)x.set(d(M,f,m),A+T);else{for(var F=E.length,N=[],O=0;O<F;O+=1)N[O]=E[O](M,f,m);var U=s_e(N.concat());x.set(N[U],A+T)}m=M}return x})(t,e,r,a);var s=Zk(t,{level:i});return di.API.__addimage__.arrayBufferToBinaryString(s)}function a_e(t){var e=Array.apply([],t);return e.unshift(0),e}function A9(t,e){var r=t.length,n=[];n[0]=1;for(var i=0;i<r;i+=1){var a=t[i-e]||0;n[i+1]=t[i]-a+256&255}return n}function I9(t,e,r){var n=t.length,i=[];i[0]=2;for(var a=0;a<n;a+=1){var s=r&&r[a]||0;i[a+1]=t[a]-s+256&255}return i}function P9(t,e,r){var n=t.length,i=[];i[0]=3;for(var a=0;a<n;a+=1){var s=t[a-e]||0,o=r&&r[a]||0;i[a+1]=t[a]+256-(s+o>>>1)&255}return i}function k9(t,e,r){var n=t.length,i=[];i[0]=4;for(var a=0;a<n;a+=1){var s=o_e(t[a-e]||0,r&&r[a]||0,r&&r[a-e]||0);i[a+1]=t[a]-s+256&255}return i}function o_e(t,e,r){if(t===e&&e===r)return t;var n=Math.abs(e-r),i=Math.abs(t-r),a=Math.abs(t+e-r-r);return n<=i&&n<=a?t:i<=a?e:r}function s_e(t){var e=t.map(function(r){return r.reduce(function(n,i){return n+Math.abs(i)},0)});return e.indexOf(Math.min.apply(null,e))}function UA(t,e,r){var n=e*r,i=Math.floor(n/8),a=16-(n-8*i+r),s=(1<<r)-1;return mZ(t,i)>>a&s}function R9(t,e,r,n){var i=r*n,a=Math.floor(i/8),s=16-(i-8*a+n),o=(1<<n)-1,c=(e&o)<<s;(function(f,d,m){if(d+1<f.byteLength)f.setUint16(d,m,!1);else{var b=m>>8&255;f.setUint8(d,b)}})(t,a,mZ(t,a)&~(o<<s)&65535|c)}function mZ(t,e){return e+1<t.byteLength?t.getUint16(e,!1):t.getUint8(e)<<8}function l_e(t){var e=0;if(t[e++]!==71||t[e++]!==73||t[e++]!==70||t[e++]!==56||(t[e++]+1&253)!=56||t[e++]!==97)throw new Error("Invalid GIF 87a/89a header.");var r=t[e++]|t[e++]<<8,n=t[e++]|t[e++]<<8,i=t[e++],a=i>>7,s=1<<1+(7&i);t[e++],t[e++];var o=null,c=null;a&&(o=e,c=s,e+=3*s);var f=!0,d=[],m=0,b=null,x=0,E=null;for(this.width=r,this.height=n;f&&e<t.length;)switch(t[e++]){case 33:switch(t[e++]){case 255:if(t[e]!==11||t[e+1]==78&&t[e+2]==69&&t[e+3]==84&&t[e+4]==83&&t[e+5]==67&&t[e+6]==65&&t[e+7]==80&&t[e+8]==69&&t[e+9]==50&&t[e+10]==46&&t[e+11]==48&&t[e+12]==3&&t[e+13]==1&&t[e+16]==0)e+=14,E=t[e++]|t[e++]<<8,e++;else for(e+=12;;){if(!((Q=t[e++])>=0))throw Error("Invalid block size");if(Q===0)break;e+=Q}break;case 249:if(t[e++]!==4||t[e+4]!==0)throw new Error("Invalid graphics extension block.");var T=t[e++];m=t[e++]|t[e++]<<8,b=t[e++],1&T||(b=null),x=T>>2&7,e++;break;case 254:for(;;){if(!((Q=t[e++])>=0))throw Error("Invalid block size");if(Q===0)break;e+=Q}break;default:throw new Error("Unknown graphic control label: 0x"+t[e-1].toString(16))}break;case 44:var A=t[e++]|t[e++]<<8,M=t[e++]|t[e++]<<8,F=t[e++]|t[e++]<<8,N=t[e++]|t[e++]<<8,O=t[e++],U=O>>6&1,j=1<<1+(7&O),H=o,W=c,X=!1;O>>7&&(X=!0,H=e,W=j,e+=3*j);var oe=e;for(e++;;){var Q;if(!((Q=t[e++])>=0))throw Error("Invalid block size");if(Q===0)break;e+=Q}d.push({x:A,y:M,width:F,height:N,has_local_palette:X,palette_offset:H,palette_size:W,data_offset:oe,data_length:e-oe,transparent_index:b,interlaced:!!U,delay:m,disposal:x});break;case 59:f=!1;break;default:throw new Error("Unknown gif block: 0x"+t[e-1].toString(16))}this.numFrames=function(){return d.length},this.loopCount=function(){return E},this.frameInfo=function(G){if(G<0||G>=d.length)throw new Error("Frame index out of range.");return d[G]},this.decodeAndBlitFrameBGRA=function(G,ae){var se=this.frameInfo(G),fe=se.width*se.height,_e=new Uint8Array(fe);M9(t,se.data_offset,_e,fe);var Le=se.palette_offset,ye=se.transparent_index;ye===null&&(ye=256);var Te=se.width,Ie=r-Te,Me=Te,de=4*(se.y*r+se.x),Se=4*((se.y+se.height)*r+se.x),we=de,De=4*Ie;se.interlaced===!0&&(De+=4*r*7);for(var Fe=8,Xe=0,Be=_e.length;Xe<Be;++Xe){var st=_e[Xe];if(Me===0&&(Me=Te,(we+=De)>=Se&&(De=4*Ie+4*r*(Fe-1),we=de+(Te+Ie)*(Fe<<1),Fe>>=1)),st===ye)we+=4;else{var Qe=t[Le+3*st],it=t[Le+3*st+1],be=t[Le+3*st+2];ae[we++]=be,ae[we++]=it,ae[we++]=Qe,ae[we++]=255}--Me}},this.decodeAndBlitFrameRGBA=function(G,ae){var se=this.frameInfo(G),fe=se.width*se.height,_e=new Uint8Array(fe);M9(t,se.data_offset,_e,fe);var Le=se.palette_offset,ye=se.transparent_index;ye===null&&(ye=256);var Te=se.width,Ie=r-Te,Me=Te,de=4*(se.y*r+se.x),Se=4*((se.y+se.height)*r+se.x),we=de,De=4*Ie;se.interlaced===!0&&(De+=4*r*7);for(var Fe=8,Xe=0,Be=_e.length;Xe<Be;++Xe){var st=_e[Xe];if(Me===0&&(Me=Te,(we+=De)>=Se&&(De=4*Ie+4*r*(Fe-1),we=de+(Te+Ie)*(Fe<<1),Fe>>=1)),st===ye)we+=4;else{var Qe=t[Le+3*st],it=t[Le+3*st+1],be=t[Le+3*st+2];ae[we++]=Qe,ae[we++]=it,ae[we++]=be,ae[we++]=255}--Me}}}function M9(t,e,r,n){for(var i=t[e++],a=1<<i,s=a+1,o=s+1,c=i+1,f=(1<<c)-1,d=0,m=0,b=0,x=t[e++],E=new Int32Array(4096),T=null;;){for(;d<16&&x!==0;)m|=t[e++]<<d,d+=8,x===1?x=t[e++]:--x;if(d<c)break;var A=m&f;if(m>>=c,d-=c,A!==a){if(A===s)break;for(var M=A<o?A:T,F=0,N=M;N>a;)N=E[N]>>8,++F;var O=N;if(b+F+(M!==A?1:0)>n)return void Ro.log("Warning, gif stream longer than expected.");r[b++]=O;var U=b+=F;for(M!==A&&(r[b++]=O),N=M;F--;)N=E[N],r[--U]=255&N,N>>=8;T!==null&&o<4096&&(E[o++]=T<<8|O,o>=f+1&&c<12&&(++c,f=f<<1|1)),T=A}else o=s+1,f=(1<<(c=i+1))-1,T=null}return b!==n&&Ro.log("Warning, gif stream shorter than expected."),r}/**
 * @license
  Copyright (c) 2008, Adobe Systems Incorporated
  All rights reserved.

  Redistribution and use in source and binary forms, with or without 
  modification, are permitted provided that the following conditions are
  met:

  * Redistributions of source code must retain the above copyright notice, 
    this list of conditions and the following disclaimer.
  
  * Redistributions in binary form must reproduce the above copyright
    notice, this list of conditions and the following disclaimer in the 
    documentation and/or other materials provided with the distribution.
  
  * Neither the name of Adobe Systems Incorporated nor the names of its 
    contributors may be used to endorse or promote products derived from 
    this software without specific prior written permission.

  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS
  IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO,
  THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
  PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR 
  CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
  EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
  PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
  PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
  SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
*/function VA(t){var e,r,n,i,a,s=Math.floor,o=new Array(64),c=new Array(64),f=new Array(64),d=new Array(64),m=new Array(65535),b=new Array(65535),x=new Array(64),E=new Array(64),T=[],A=0,M=7,F=new Array(64),N=new Array(64),O=new Array(64),U=new Array(256),j=new Array(2048),H=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],W=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],X=[0,1,2,3,4,5,6,7,8,9,10,11],oe=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],Q=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],G=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],ae=[0,1,2,3,4,5,6,7,8,9,10,11],se=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],fe=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function _e(de,Se){for(var we=0,De=0,Fe=new Array,Xe=1;Xe<=16;Xe++){for(var Be=1;Be<=de[Xe];Be++)Fe[Se[De]]=[],Fe[Se[De]][0]=we,Fe[Se[De]][1]=Xe,De++,we++;we*=2}return Fe}function Le(de){for(var Se=de[0],we=de[1]-1;we>=0;)Se&1<<we&&(A|=1<<M),we--,--M<0&&(A==255?(ye(255),ye(0)):ye(A),M=7,A=0)}function ye(de){T.push(de)}function Te(de){ye(de>>8&255),ye(255&de)}function Ie(de,Se,we,De,Fe){for(var Xe,Be=Fe[0],st=Fe[240],Qe=(function(_t,gr){var mr,ar,Cr,Er,Jt,ot,Ce,xe,je,qe,Ge=0;for(je=0;je<8;++je){mr=_t[Ge],ar=_t[Ge+1],Cr=_t[Ge+2],Er=_t[Ge+3],Jt=_t[Ge+4],ot=_t[Ge+5],Ce=_t[Ge+6];var Ft=mr+(xe=_t[Ge+7]),Et=mr-xe,mt=ar+Ce,ct=ar-Ce,Qt=Cr+ot,Ht=Cr-ot,Ir=Er+Jt,Ar=Er-Jt,$r=Ft+Ir,fn=Ft-Ir,zr=mt+Qt,Mt=mt-Qt;_t[Ge]=$r+zr,_t[Ge+4]=$r-zr;var en=.707106781*(Mt+fn);_t[Ge+2]=fn+en,_t[Ge+6]=fn-en;var jn=.382683433*(($r=Ar+Ht)-(Mt=ct+Et)),Qr=.5411961*$r+jn,nr=1.306562965*Mt+jn,oi=.707106781*(zr=Ht+ct),un=Et+oi,Kn=Et-oi;_t[Ge+5]=Kn+Qr,_t[Ge+3]=Kn-Qr,_t[Ge+1]=un+nr,_t[Ge+7]=un-nr,Ge+=8}for(Ge=0,je=0;je<8;++je){mr=_t[Ge],ar=_t[Ge+8],Cr=_t[Ge+16],Er=_t[Ge+24],Jt=_t[Ge+32],ot=_t[Ge+40],Ce=_t[Ge+48];var Re=mr+(xe=_t[Ge+56]),He=mr-xe,Tt=ar+Ce,Gt=ar-Ce,Ut=Cr+ot,Xr=Cr-ot,Nn=Er+Jt,Bi=Er-Jt,Ci=Re+Nn,Fr=Re-Nn,Mn=Tt+Ut,Bn=Tt-Ut;_t[Ge]=Ci+Mn,_t[Ge+32]=Ci-Mn;var ei=.707106781*(Bn+Fr);_t[Ge+16]=Fr+ei,_t[Ge+48]=Fr-ei;var ua=.382683433*((Ci=Bi+Xr)-(Bn=Gt+He)),ha=.5411961*Ci+ua,zn=1.306562965*Bn+ua,La=.707106781*(Mn=Xr+Gt),Wi=He+La,hs=He-La;_t[Ge+40]=hs+ha,_t[Ge+24]=hs-ha,_t[Ge+8]=Wi+zn,_t[Ge+56]=Wi-zn,Ge++}for(je=0;je<64;++je)qe=_t[je]*gr[je],x[je]=qe>0?qe+.5|0:qe-.5|0;return x})(de,Se),it=0;it<64;++it)E[H[it]]=Qe[it];var be=E[0]-we;we=E[0],be==0?Le(De[0]):(Le(De[b[Xe=32767+be]]),Le(m[Xe]));for(var Ot=63;Ot>0&&E[Ot]==0;)Ot--;if(Ot==0)return Le(Be),we;for(var at,$e=1;$e<=Ot;){for(var Xt=$e;E[$e]==0&&$e<=Ot;)++$e;var $t=$e-Xt;if($t>=16){at=$t>>4;for(var cr=1;cr<=at;++cr)Le(st);$t&=15}Xe=32767+E[$e],Le(Fe[($t<<4)+b[Xe]]),Le(m[Xe]),$e++}return Ot!=63&&Le(Be),we}function Me(de){de=Math.min(Math.max(de,1),100),a!=de&&((function(Se){for(var we=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],De=0;De<64;De++){var Fe=s((we[De]*Se+50)/100);Fe=Math.min(Math.max(Fe,1),255),o[H[De]]=Fe}for(var Xe=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],Be=0;Be<64;Be++){var st=s((Xe[Be]*Se+50)/100);st=Math.min(Math.max(st,1),255),c[H[Be]]=st}for(var Qe=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],it=0,be=0;be<8;be++)for(var Ot=0;Ot<8;Ot++)f[it]=1/(o[H[it]]*Qe[be]*Qe[Ot]*8),d[it]=1/(c[H[it]]*Qe[be]*Qe[Ot]*8),it++})(de<50?Math.floor(5e3/de):Math.floor(200-2*de)),a=de)}this.encode=function(de,Se){Se&&Me(Se),T=new Array,A=0,M=7,Te(65496),Te(65504),Te(16),ye(74),ye(70),ye(73),ye(70),ye(0),ye(1),ye(1),ye(0),Te(1),Te(1),ye(0),ye(0),(function(){Te(65499),Te(132),ye(0);for(var ar=0;ar<64;ar++)ye(o[ar]);ye(1);for(var Cr=0;Cr<64;Cr++)ye(c[Cr])})(),(function(ar,Cr){Te(65472),Te(17),ye(8),Te(Cr),Te(ar),ye(3),ye(1),ye(17),ye(0),ye(2),ye(17),ye(1),ye(3),ye(17),ye(1)})(de.width,de.height),(function(){Te(65476),Te(418),ye(0);for(var ar=0;ar<16;ar++)ye(W[ar+1]);for(var Cr=0;Cr<=11;Cr++)ye(X[Cr]);ye(16);for(var Er=0;Er<16;Er++)ye(oe[Er+1]);for(var Jt=0;Jt<=161;Jt++)ye(Q[Jt]);ye(1);for(var ot=0;ot<16;ot++)ye(G[ot+1]);for(var Ce=0;Ce<=11;Ce++)ye(ae[Ce]);ye(17);for(var xe=0;xe<16;xe++)ye(se[xe+1]);for(var je=0;je<=161;je++)ye(fe[je])})(),Te(65498),Te(12),ye(3),ye(1),ye(0),ye(2),ye(17),ye(3),ye(17),ye(0),ye(63),ye(0);var we=0,De=0,Fe=0;A=0,M=7,this.encode.displayName="_encode_";for(var Xe,Be,st,Qe,it,be,Ot,at,$e,Xt=de.data,$t=de.width,cr=de.height,_t=4*$t,gr=0;gr<cr;){for(Xe=0;Xe<_t;){for(it=_t*gr+Xe,Ot=-1,at=0,$e=0;$e<64;$e++)be=it+(at=$e>>3)*_t+(Ot=4*(7&$e)),gr+at>=cr&&(be-=_t*(gr+1+at-cr)),Xe+Ot>=_t&&(be-=Xe+Ot-_t+4),Be=Xt[be++],st=Xt[be++],Qe=Xt[be++],F[$e]=(j[Be]+j[st+256|0]+j[Qe+512|0]>>16)-128,N[$e]=(j[Be+768|0]+j[st+1024|0]+j[Qe+1280|0]>>16)-128,O[$e]=(j[Be+1280|0]+j[st+1536|0]+j[Qe+1792|0]>>16)-128;we=Ie(F,f,we,e,n),De=Ie(N,d,De,r,i),Fe=Ie(O,d,Fe,r,i),Xe+=32}gr+=8}if(M>=0){var mr=[];mr[1]=M+1,mr[0]=(1<<M+1)-1,Le(mr)}return Te(65497),new Uint8Array(T)},t=t||50,(function(){for(var de=String.fromCharCode,Se=0;Se<256;Se++)U[Se]=de(Se)})(),e=_e(W,X),r=_e(G,ae),n=_e(oe,Q),i=_e(se,fe),(function(){for(var de=1,Se=2,we=1;we<=15;we++){for(var De=de;De<Se;De++)b[32767+De]=we,m[32767+De]=[],m[32767+De][1]=we,m[32767+De][0]=De;for(var Fe=-(Se-1);Fe<=-de;Fe++)b[32767+Fe]=we,m[32767+Fe]=[],m[32767+Fe][1]=we,m[32767+Fe][0]=Se-1+Fe;de<<=1,Se<<=1}})(),(function(){for(var de=0;de<256;de++)j[de]=19595*de,j[de+256|0]=38470*de,j[de+512|0]=7471*de+32768,j[de+768|0]=-11059*de,j[de+1024|0]=-21709*de,j[de+1280|0]=32768*de+8421375,j[de+1536|0]=-27439*de,j[de+1792|0]=-5329*de})(),Me(t)}/**
 * @license
 * Copyright (c) 2017 Aras Abbasi
 *
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 */function ph(t,e){if(this.pos=0,this.buffer=t,this.datav=new DataView(t.buffer),this.is_with_alpha=!!e,this.bottom_up=!0,this.flag=String.fromCharCode(this.buffer[0])+String.fromCharCode(this.buffer[1]),this.pos+=2,["BM","BA","CI","CP","IC","PT"].indexOf(this.flag)===-1)throw new Error("Invalid BMP File");this.parseHeader(),this.parseBGR()}function D9(t){function e(X){if(!X)throw Error("assert :P")}function r(X,oe,Q){for(var G=0;4>G;G++)if(X[oe+G]!=Q.charCodeAt(G))return!0;return!1}function n(X,oe,Q,G,ae){for(var se=0;se<ae;se++)X[oe+se]=Q[G+se]}function i(X,oe,Q,G){for(var ae=0;ae<G;ae++)X[oe+ae]=Q}function a(X){return new Int32Array(X)}function s(X,oe){for(var Q=[],G=0;G<X;G++)Q.push(new oe);return Q}function o(X,oe){var Q=[];return(function G(ae,se,fe){for(var _e=fe[se],Le=0;Le<_e&&(ae.push(fe.length>se+1?[]:new oe),!(fe.length<se+1));Le++)G(ae[Le],se+1,fe)})(Q,0,X),Q}var c=function(){var X=this;function oe(q,K){for(var ge=1<<K-1>>>0;q&ge;)ge>>>=1;return ge?(q&ge-1)+ge:q}function Q(q,K,ge,ke,Ye){e(!(ke%ge));do q[K+(ke-=ge)]=Ye;while(0<ke)}function G(q,K,ge,ke,Ye){if(e(2328>=Ye),512>=Ye)var Je=a(512);else if((Je=a(Ye))==null)return 0;return(function(nt,lt,yt,At,Yt,br){var St,Pt,hr=lt,Lr=1<<yt,yr=a(16),Br=a(16);for(e(Yt!=0),e(At!=null),e(nt!=null),e(0<yt),Pt=0;Pt<Yt;++Pt){if(15<At[Pt])return 0;++yr[At[Pt]]}if(yr[0]==Yt)return 0;for(Br[1]=0,St=1;15>St;++St){if(yr[St]>1<<St)return 0;Br[St+1]=Br[St]+yr[St]}for(Pt=0;Pt<Yt;++Pt)St=At[Pt],0<At[Pt]&&(br[Br[St]++]=Pt);if(Br[15]==1)return(At=new ae).g=0,At.value=br[0],Q(nt,hr,1,Lr,At),Lr;var jr,sn=-1,Jr=Lr-1,Jn=0,Vn=1,Ai=1,Zn=1<<yt;for(Pt=0,St=1,Yt=2;St<=yt;++St,Yt<<=1){if(Vn+=Ai<<=1,0>(Ai-=yr[St]))return 0;for(;0<yr[St];--yr[St])(At=new ae).g=St,At.value=br[Pt++],Q(nt,hr+Jn,Yt,Zn,At),Jn=oe(Jn,St)}for(St=yt+1,Yt=2;15>=St;++St,Yt<<=1){if(Vn+=Ai<<=1,0>(Ai-=yr[St]))return 0;for(;0<yr[St];--yr[St]){if(At=new ae,(Jn&Jr)!=sn){for(hr+=Zn,jr=1<<(sn=St)-yt;15>sn&&!(0>=(jr-=yr[sn]));)++sn,jr<<=1;Lr+=Zn=1<<(jr=sn-yt),nt[lt+(sn=Jn&Jr)].g=jr+yt,nt[lt+sn].value=hr-lt-sn}At.g=St-yt,At.value=br[Pt++],Q(nt,hr+(Jn>>yt),Yt,Zn,At),Jn=oe(Jn,St)}}return Vn!=2*Br[15]-1?0:Lr})(q,K,ge,ke,Ye,Je)}function ae(){this.value=this.g=0}function se(){this.value=this.g=0}function fe(){this.G=s(5,ae),this.H=a(5),this.jc=this.Qb=this.qb=this.nd=0,this.pd=s(Ua,se)}function _e(q,K,ge,ke){e(q!=null),e(K!=null),e(2147483648>ke),q.Ca=254,q.I=0,q.b=-8,q.Ka=0,q.oa=K,q.pa=ge,q.Jd=K,q.Yc=ge+ke,q.Zc=4<=ke?ge+ke-4+1:ge,Be(q)}function Le(q,K){for(var ge=0;0<K--;)ge|=Qe(q,128)<<K;return ge}function ye(q,K){var ge=Le(q,K);return st(q)?-ge:ge}function Te(q,K,ge,ke){var Ye,Je=0;for(e(q!=null),e(K!=null),e(4294967288>ke),q.Sb=ke,q.Ra=0,q.u=0,q.h=0,4<ke&&(ke=4),Ye=0;Ye<ke;++Ye)Je+=K[ge+Ye]<<8*Ye;q.Ra=Je,q.bb=ke,q.oa=K,q.pa=ge}function Ie(q){for(;8<=q.u&&q.bb<q.Sb;)q.Ra>>>=8,q.Ra+=q.oa[q.pa+q.bb]<<ms-8>>>0,++q.bb,q.u-=8;De(q)&&(q.h=1,q.u=0)}function Me(q,K){if(e(0<=K),!q.h&&K<=Zs){var ge=we(q)&fu[K];return q.u+=K,Ie(q),ge}return q.h=1,q.u=0}function de(){this.b=this.Ca=this.I=0,this.oa=[],this.pa=0,this.Jd=[],this.Yc=0,this.Zc=[],this.Ka=0}function Se(){this.Ra=0,this.oa=[],this.h=this.u=this.bb=this.Sb=this.pa=0}function we(q){return q.Ra>>>(q.u&ms-1)>>>0}function De(q){return e(q.bb<=q.Sb),q.h||q.bb==q.Sb&&q.u>ms}function Fe(q,K){q.u=K,q.h=De(q)}function Xe(q){q.u>=Va&&(e(q.u>=Va),Ie(q))}function Be(q){e(q!=null&&q.oa!=null),q.pa<q.Zc?(q.I=(q.oa[q.pa++]|q.I<<8)>>>0,q.b+=8):(e(q!=null&&q.oa!=null),q.pa<q.Yc?(q.b+=8,q.I=q.oa[q.pa++]|q.I<<8):q.Ka?q.b=0:(q.I<<=8,q.b+=8,q.Ka=1))}function st(q){return Le(q,1)}function Qe(q,K){var ge=q.Ca;0>q.b&&Be(q);var ke=q.b,Ye=ge*K>>>8,Je=(q.I>>>ke>Ye)+0;for(Je?(ge-=Ye,q.I-=Ye+1<<ke>>>0):ge=Ye+1,ke=ge,Ye=0;256<=ke;)Ye+=8,ke>>=8;return ke=7^Ye+Vl[ke],q.b-=ke,q.Ca=(ge<<ke)-1,Je}function it(q,K,ge){q[K+0]=ge>>24&255,q[K+1]=ge>>16&255,q[K+2]=ge>>8&255,q[K+3]=255&ge}function be(q,K){return q[K+0]|q[K+1]<<8}function Ot(q,K){return be(q,K)|q[K+2]<<16}function at(q,K){return be(q,K)|be(q,K+2)<<16}function $e(q,K){var ge=1<<K;return e(q!=null),e(0<K),q.X=a(ge),q.X==null?0:(q.Mb=32-K,q.Xa=K,1)}function Xt(q,K){e(q!=null),e(K!=null),e(q.Xa==K.Xa),n(K.X,0,q.X,0,1<<K.Xa)}function $t(){this.X=[],this.Xa=this.Mb=0}function cr(q,K,ge,ke){e(ge!=null),e(ke!=null);var Ye=ge[0],Je=ke[0];return Ye==0&&(Ye=(q*Je+K/2)/K),Je==0&&(Je=(K*Ye+q/2)/q),0>=Ye||0>=Je?0:(ge[0]=Ye,ke[0]=Je,1)}function _t(q,K){return q+(1<<K)-1>>>K}function gr(q,K){return((4278255360&q)+(4278255360&K)>>>0&4278255360)+((16711935&q)+(16711935&K)>>>0&16711935)>>>0}function mr(q,K){X[K]=function(ge,ke,Ye,Je,nt,lt,yt){var At;for(At=0;At<nt;++At){var Yt=X[q](lt[yt+At-1],Ye,Je+At);lt[yt+At]=gr(ge[ke+At],Yt)}}}function ar(){this.ud=this.hd=this.jd=0}function Cr(q,K){return((4278124286&(q^K))>>>1)+(q&K)>>>0}function Er(q){return 0<=q&&256>q?q:0>q?0:255<q?255:void 0}function Jt(q,K){return Er(q+(q-K+.5>>1))}function ot(q,K,ge){return Math.abs(K-ge)-Math.abs(q-ge)}function Ce(q,K,ge,ke,Ye,Je,nt){for(ke=Je[nt-1],ge=0;ge<Ye;++ge)Je[nt+ge]=ke=gr(q[K+ge],ke)}function xe(q,K,ge,ke,Ye){var Je;for(Je=0;Je<ge;++Je){var nt=q[K+Je],lt=nt>>8&255,yt=16711935&(yt=(yt=16711935&nt)+((lt<<16)+lt));ke[Ye+Je]=(4278255360&nt)+yt>>>0}}function je(q,K){K.jd=255&q,K.hd=q>>8&255,K.ud=q>>16&255}function qe(q,K,ge,ke,Ye,Je){var nt;for(nt=0;nt<ke;++nt){var lt=K[ge+nt],yt=lt>>>8,At=lt,Yt=255&(Yt=(Yt=lt>>>16)+((q.jd<<24>>24)*(yt<<24>>24)>>>5));At=255&(At=(At+=(q.hd<<24>>24)*(yt<<24>>24)>>>5)+((q.ud<<24>>24)*(Yt<<24>>24)>>>5)),Ye[Je+nt]=(4278255360&lt)+(Yt<<16)+At}}function Ge(q,K,ge,ke,Ye){X[K]=function(Je,nt,lt,yt,At,Yt,br,St,Pt){for(yt=br;yt<St;++yt)for(br=0;br<Pt;++br)At[Yt++]=Ye(lt[ke(Je[nt++])])},X[q]=function(Je,nt,lt,yt,At,Yt,br){var St=8>>Je.b,Pt=Je.Ea,hr=Je.K[0],Lr=Je.w;if(8>St)for(Je=(1<<Je.b)-1,Lr=(1<<St)-1;nt<lt;++nt){var yr,Br=0;for(yr=0;yr<Pt;++yr)yr&Je||(Br=ke(yt[At++])),Yt[br++]=Ye(hr[Br&Lr]),Br>>=St}else X["VP8LMapColor"+ge](yt,At,hr,Lr,Yt,br,nt,lt,Pt)}}function Ft(q,K,ge,ke,Ye){for(ge=K+ge;K<ge;){var Je=q[K++];ke[Ye++]=Je>>16&255,ke[Ye++]=Je>>8&255,ke[Ye++]=255&Je}}function Et(q,K,ge,ke,Ye){for(ge=K+ge;K<ge;){var Je=q[K++];ke[Ye++]=Je>>16&255,ke[Ye++]=Je>>8&255,ke[Ye++]=255&Je,ke[Ye++]=Je>>24&255}}function mt(q,K,ge,ke,Ye){for(ge=K+ge;K<ge;){var Je=(nt=q[K++])>>16&240|nt>>12&15,nt=240&nt|nt>>28&15;ke[Ye++]=Je,ke[Ye++]=nt}}function ct(q,K,ge,ke,Ye){for(ge=K+ge;K<ge;){var Je=(nt=q[K++])>>16&248|nt>>13&7,nt=nt>>5&224|nt>>3&31;ke[Ye++]=Je,ke[Ye++]=nt}}function Qt(q,K,ge,ke,Ye){for(ge=K+ge;K<ge;){var Je=q[K++];ke[Ye++]=255&Je,ke[Ye++]=Je>>8&255,ke[Ye++]=Je>>16&255}}function Ht(q,K,ge,ke,Ye,Je){if(Je==0)for(ge=K+ge;K<ge;)it(ke,((Je=q[K++])[0]>>24|Je[1]>>8&65280|Je[2]<<8&16711680|Je[3]<<24)>>>0),Ye+=32;else n(ke,Ye,q,K,ge)}function Ir(q,K){X[K][0]=X[q+"0"],X[K][1]=X[q+"1"],X[K][2]=X[q+"2"],X[K][3]=X[q+"3"],X[K][4]=X[q+"4"],X[K][5]=X[q+"5"],X[K][6]=X[q+"6"],X[K][7]=X[q+"7"],X[K][8]=X[q+"8"],X[K][9]=X[q+"9"],X[K][10]=X[q+"10"],X[K][11]=X[q+"11"],X[K][12]=X[q+"12"],X[K][13]=X[q+"13"],X[K][14]=X[q+"0"],X[K][15]=X[q+"0"]}function Ar(q){return q==qg||q==Od||q==qc||q==rh}function $r(){this.eb=[],this.size=this.A=this.fb=0}function fn(){this.y=[],this.f=[],this.ea=[],this.F=[],this.Tc=this.Ed=this.Cd=this.Fd=this.lb=this.Db=this.Ab=this.fa=this.J=this.W=this.N=this.O=0}function zr(){this.Rd=this.height=this.width=this.S=0,this.f={},this.f.RGBA=new $r,this.f.kb=new fn,this.sd=null}function Mt(){this.width=[0],this.height=[0],this.Pd=[0],this.Qd=[0],this.format=[0]}function en(){this.Id=this.fd=this.Md=this.hb=this.ib=this.da=this.bd=this.cd=this.j=this.v=this.Da=this.Sd=this.ob=0}function jn(q){return alert("todo:WebPSamplerProcessPlane"),q.T}function Qr(q,K){var ge=q.T,ke=K.ba.f.RGBA,Ye=ke.eb,Je=ke.fb+q.ka*ke.A,nt=dl[K.ba.S],lt=q.y,yt=q.O,At=q.f,Yt=q.N,br=q.ea,St=q.W,Pt=K.cc,hr=K.dc,Lr=K.Mc,yr=K.Nc,Br=q.ka,jr=q.ka+q.T,sn=q.U,Jr=sn+1>>1;for(Br==0?nt(lt,yt,null,null,At,Yt,br,St,At,Yt,br,St,Ye,Je,null,null,sn):(nt(K.ec,K.fc,lt,yt,Pt,hr,Lr,yr,At,Yt,br,St,Ye,Je-ke.A,Ye,Je,sn),++ge);Br+2<jr;Br+=2)Pt=At,hr=Yt,Lr=br,yr=St,Yt+=q.Rc,St+=q.Rc,Je+=2*ke.A,nt(lt,(yt+=2*q.fa)-q.fa,lt,yt,Pt,hr,Lr,yr,At,Yt,br,St,Ye,Je-ke.A,Ye,Je,sn);return yt+=q.fa,q.j+jr<q.o?(n(K.ec,K.fc,lt,yt,sn),n(K.cc,K.dc,At,Yt,Jr),n(K.Mc,K.Nc,br,St,Jr),ge--):1&jr||nt(lt,yt,null,null,At,Yt,br,St,At,Yt,br,St,Ye,Je+ke.A,null,null,sn),ge}function nr(q,K,ge){var ke=q.F,Ye=[q.J];if(ke!=null){var Je=q.U,nt=K.ba.S,lt=nt==Op||nt==qc;K=K.ba.f.RGBA;var yt=[0],At=q.ka;yt[0]=q.T,q.Kb&&(At==0?--yt[0]:(--At,Ye[0]-=q.width),q.j+q.ka+q.T==q.o&&(yt[0]=q.o-q.j-At));var Yt=K.eb;At=K.fb+At*K.A,q=ka(ke,Ye[0],q.width,Je,yt,Yt,At+(lt?0:3),K.A),e(ge==yt),q&&Ar(nt)&&ca(Yt,At,lt,Je,yt,K.A)}return 0}function oi(q){var K=q.ma,ge=K.ba.S,ke=11>ge,Ye=ge==th||ge==pu||ge==Op||ge==Vg||ge==12||Ar(ge);if(K.memory=null,K.Ib=null,K.Jb=null,K.Nd=null,!Oo(K.Oa,q,Ye?11:12))return 0;if(Ye&&Ar(ge)&&Xs(),q.da)alert("todo:use_scaling");else{if(ke){if(K.Ib=jn,q.Kb){if(ge=q.U+1>>1,K.memory=a(q.U+2*ge),K.memory==null)return 0;K.ec=K.memory,K.fc=0,K.cc=K.ec,K.dc=K.fc+q.U,K.Mc=K.cc,K.Nc=K.dc+ge,K.Ib=Qr,Xs()}}else alert("todo:EmitYUV");Ye&&(K.Jb=nr,ke&&Ws())}if(ke&&!Up){for(q=0;256>q;++q)Ud[q]=89858*(q-128)+jd>>zd,Kg[q]=-22014*(q-128)+jd,Zg[q]=-45773*(q-128),jy[q]=113618*(q-128)+jd>>zd;for(q=jh;q<Sc;++q)K=76283*(q-16)+jd>>zd,Uy[q-jh]=ja(K,255),Jg[q-jh]=ja(K+8>>4,15);Up=1}return 1}function un(q){var K=q.ma,ge=q.U,ke=q.T;return e(!(1&q.ka)),0>=ge||0>=ke?0:(ge=K.Ib(q,K),K.Jb!=null&&K.Jb(q,K,ge),K.Dc+=ge,1)}function Kn(q){q.ma.memory=null}function Re(q,K,ge,ke){return Me(q,8)!=47?0:(K[0]=Me(q,14)+1,ge[0]=Me(q,14)+1,ke[0]=Me(q,1),Me(q,3)!=0?0:!q.h)}function He(q,K){if(4>q)return q+1;var ge=q-2>>1;return(2+(1&q)<<ge)+Me(K,ge)+1}function Tt(q,K){return 120<K?K-120:1<=(ge=((ge=xf[K-1])>>4)*q+(8-(15&ge)))?ge:1;var ge}function Gt(q,K,ge){var ke=we(ge),Ye=q[K+=255&ke].g-8;return 0<Ye&&(Fe(ge,ge.u+8),ke=we(ge),K+=q[K].value,K+=ke&(1<<Ye)-1),Fe(ge,ge.u+q[K].g),q[K].value}function Ut(q,K,ge){return ge.g+=q.g,ge.value+=q.value<<K>>>0,e(8>=ge.g),q.g}function Xr(q,K,ge){var ke=q.xc;return e((K=ke==0?0:q.vc[q.md*(ge>>ke)+(K>>ke)])<q.Wb),q.Ya[K]}function Nn(q,K,ge,ke){var Ye=q.ab,Je=q.c*K,nt=q.C;K=nt+K;var lt=ge,yt=ke;for(ke=q.Ta,ge=q.Ua;0<Ye--;){var At=q.gc[Ye],Yt=nt,br=K,St=lt,Pt=yt,hr=(yt=ke,lt=ge,At.Ea);switch(e(Yt<br),e(br<=At.nc),At.hc){case 2:$l(St,Pt,(br-Yt)*hr,yt,lt);break;case 0:var Lr=Yt,yr=br,Br=yt,jr=lt,sn=(Zn=At).Ea;Lr==0&&(cl(St,Pt,null,null,1,Br,jr),Ce(St,Pt+1,0,0,sn-1,Br,jr+1),Pt+=sn,jr+=sn,++Lr);for(var Jr=1<<Zn.b,Jn=Jr-1,Vn=_t(sn,Zn.b),Ai=Zn.K,Zn=Zn.w+(Lr>>Zn.b)*Vn;Lr<yr;){var Yi=Ai,No=Zn,Ni=1;for(fl(St,Pt,Br,jr-sn,1,Br,jr);Ni<sn;){var Yn=(Ni&~Jn)+Jr;Yn>sn&&(Yn=sn),(0,tr[Yi[No++]>>8&15])(St,Pt+ +Ni,Br,jr+Ni-sn,Yn-Ni,Br,jr+Ni),Ni=Yn}Pt+=sn,jr+=sn,++Lr&Jn||(Zn+=Vn)}br!=At.nc&&n(yt,lt-hr,yt,lt+(br-Yt-1)*hr,hr);break;case 1:for(hr=St,yr=Pt,sn=(St=At.Ea)-(jr=St&~(Br=(Pt=1<<At.b)-1)),Lr=_t(St,At.b),Jr=At.K,At=At.w+(Yt>>At.b)*Lr;Yt<br;){for(Jn=Jr,Vn=At,Ai=new ar,Zn=yr+jr,Yi=yr+St;yr<Zn;)je(Jn[Vn++],Ai),vr(Ai,hr,yr,Pt,yt,lt),yr+=Pt,lt+=Pt;yr<Yi&&(je(Jn[Vn++],Ai),vr(Ai,hr,yr,sn,yt,lt),yr+=sn,lt+=sn),++Yt&Br||(At+=Lr)}break;case 3:if(St==yt&&Pt==lt&&0<At.b){for(yr=yt,St=hr=lt+(br-Yt)*hr-(jr=(br-Yt)*_t(At.Ea,At.b)),Pt=yt,Br=lt,Lr=[],jr=(sn=jr)-1;0<=jr;--jr)Lr[jr]=Pt[Br+jr];for(jr=sn-1;0<=jr;--jr)yr[St+jr]=Lr[jr];ql(At,Yt,br,yt,hr,yt,lt)}else ql(At,Yt,br,St,Pt,yt,lt)}lt=ke,yt=ge}yt!=ge&&n(ke,ge,lt,yt,Je)}function Bi(q,K){var ge=q.V,ke=q.Ba+q.c*q.C,Ye=K-q.C;if(e(K<=q.l.o),e(16>=Ye),0<Ye){var Je=q.l,nt=q.Ta,lt=q.Ua,yt=Je.width;if(Nn(q,Ye,ge,ke),Ye=lt=[lt],e((ge=q.C)<(ke=K)),e(Je.v<Je.va),ke>Je.o&&(ke=Je.o),ge<Je.j){var At=Je.j-ge;ge=Je.j,Ye[0]+=At*yt}if(ge>=ke?ge=0:(Ye[0]+=4*Je.v,Je.ka=ge-Je.j,Je.U=Je.va-Je.v,Je.T=ke-ge,ge=1),ge){if(lt=lt[0],11>(ge=q.ca).S){var Yt=ge.f.RGBA,br=(ke=ge.S,Ye=Je.U,Je=Je.T,At=Yt.eb,Yt.A),St=Je;for(Yt=Yt.fb+q.Ma*Yt.A;0<St--;){var Pt=nt,hr=lt,Lr=Ye,yr=At,Br=Yt;switch(ke){case Nu:dn(Pt,hr,Lr,yr,Br);break;case th:In(Pt,hr,Lr,yr,Br);break;case qg:In(Pt,hr,Lr,yr,Br),ca(yr,Br,0,Lr,1,0);break;case bf:I(Pt,hr,Lr,yr,Br);break;case pu:Ht(Pt,hr,Lr,yr,Br,1);break;case Od:Ht(Pt,hr,Lr,yr,Br,1),ca(yr,Br,0,Lr,1,0);break;case Op:Ht(Pt,hr,Lr,yr,Br,0);break;case qc:Ht(Pt,hr,Lr,yr,Br,0),ca(yr,Br,1,Lr,1,0);break;case Vg:vi(Pt,hr,Lr,yr,Br);break;case rh:vi(Pt,hr,Lr,yr,Br),so(yr,Br,Lr,1,0);break;case $g:Pn(Pt,hr,Lr,yr,Br);break;default:e(0)}lt+=yt,Yt+=br}q.Ma+=Je}else alert("todo:EmitRescaledRowsYUVA");e(q.Ma<=ge.height)}}q.C=K,e(q.C<=q.i)}function Ci(q){var K;if(0<q.ua)return 0;for(K=0;K<q.Wb;++K){var ge=q.Ya[K].G,ke=q.Ya[K].H;if(0<ge[1][ke[1]+0].g||0<ge[2][ke[2]+0].g||0<ge[3][ke[3]+0].g)return 0}return 1}function Fr(q,K,ge,ke,Ye,Je){if(q.Z!=0){var nt=q.qd,lt=q.rd;for(e(ac[q.Z]!=null);K<ge;++K)ac[q.Z](nt,lt,ke,Ye,ke,Ye,Je),nt=ke,lt=Ye,Ye+=Je;q.qd=nt,q.rd=lt}}function Mn(q,K){var ge=q.l.ma,ke=ge.Z==0||ge.Z==1?q.l.j:q.C;if(ke=q.C<ke?ke:q.C,e(K<=q.l.o),K>ke){var Ye=q.l.width,Je=ge.ca,nt=ge.tb+Ye*ke,lt=q.V,yt=q.Ba+q.c*ke,At=q.gc;e(q.ab==1),e(At[0].hc==3),Hl(At[0],ke,K,lt,yt,Je,nt),Fr(ge,ke,K,Je,nt,Ye)}q.C=q.Ma=K}function Bn(q,K,ge,ke,Ye,Je,nt){var lt=q.$/ke,yt=q.$%ke,At=q.m,Yt=q.s,br=ge+q.$,St=br;Ye=ge+ke*Ye;var Pt=ge+ke*Je,hr=280+Yt.ua,Lr=q.Pb?lt:16777216,yr=0<Yt.ua?Yt.Wa:null,Br=Yt.wc,jr=br<Pt?Xr(Yt,yt,lt):null;e(q.C<Je),e(Pt<=Ye);var sn=!1;e:for(;;){for(;sn||br<Pt;){var Jr=0;if(lt>=Lr){var Jn=br-ge;e((Lr=q).Pb),Lr.wd=Lr.m,Lr.xd=Jn,0<Lr.s.ua&&Xt(Lr.s.Wa,Lr.s.vb),Lr=lt+Gg}if(yt&Br||(jr=Xr(Yt,yt,lt)),e(jr!=null),jr.Qb&&(K[br]=jr.qb,sn=!0),!sn)if(Xe(At),jr.jc){Jr=At,Jn=K;var Vn=br,Ai=jr.pd[we(Jr)&Ua-1];e(jr.jc),256>Ai.g?(Fe(Jr,Jr.u+Ai.g),Jn[Vn]=Ai.value,Jr=0):(Fe(Jr,Jr.u+Ai.g-256),e(256<=Ai.value),Jr=Ai.value),Jr==0&&(sn=!0)}else Jr=Gt(jr.G[0],jr.H[0],At);if(At.h)break;if(sn||256>Jr){if(!sn)if(jr.nd)K[br]=(jr.qb|Jr<<8)>>>0;else{if(Xe(At),sn=Gt(jr.G[1],jr.H[1],At),Xe(At),Jn=Gt(jr.G[2],jr.H[2],At),Vn=Gt(jr.G[3],jr.H[3],At),At.h)break;K[br]=(Vn<<24|sn<<16|Jr<<8|Jn)>>>0}if(sn=!1,++br,++yt>=ke&&(yt=0,++lt,nt!=null&&lt<=Je&&!(lt%16)&&nt(q,lt),yr!=null))for(;St<br;)Jr=K[St++],yr.X[(506832829*Jr&4294967295)>>>yr.Mb]=Jr}else if(280>Jr){if(Jr=He(Jr-256,At),Jn=Gt(jr.G[4],jr.H[4],At),Xe(At),Jn=Tt(ke,Jn=He(Jn,At)),At.h)break;if(br-ge<Jn||Ye-br<Jr)break e;for(Vn=0;Vn<Jr;++Vn)K[br+Vn]=K[br+Vn-Jn];for(br+=Jr,yt+=Jr;yt>=ke;)yt-=ke,++lt,nt!=null&&lt<=Je&&!(lt%16)&&nt(q,lt);if(e(br<=Ye),yt&Br&&(jr=Xr(Yt,yt,lt)),yr!=null)for(;St<br;)Jr=K[St++],yr.X[(506832829*Jr&4294967295)>>>yr.Mb]=Jr}else{if(!(Jr<hr))break e;for(sn=Jr-280,e(yr!=null);St<br;)Jr=K[St++],yr.X[(506832829*Jr&4294967295)>>>yr.Mb]=Jr;Jr=br,e(!(sn>>>(Jn=yr).Xa)),K[Jr]=Jn.X[sn],sn=!0}sn||e(At.h==De(At))}if(q.Pb&&At.h&&br<Ye)e(q.m.h),q.a=5,q.m=q.wd,q.$=q.xd,0<q.s.ua&&Xt(q.s.vb,q.s.Wa);else{if(At.h)break e;nt?.(q,lt>Je?Je:lt),q.a=0,q.$=br-ge}return 1}return q.a=3,0}function ei(q){e(q!=null),q.vc=null,q.yc=null,q.Ya=null;var K=q.Wa;K!=null&&(K.X=null),q.vb=null,e(q!=null)}function ua(){var q=new Ui;return q==null?null:(q.a=0,q.xb=Xl,Ir("Predictor","VP8LPredictors"),Ir("Predictor","VP8LPredictors_C"),Ir("PredictorAdd","VP8LPredictorsAdd"),Ir("PredictorAdd","VP8LPredictorsAdd_C"),$l=xe,vr=qe,dn=Ft,In=Et,vi=mt,Pn=ct,I=Qt,X.VP8LMapColor32b=hl,X.VP8LMapColor8b=Ou,q)}function ha(q,K,ge,ke,Ye){var Je=1,nt=[q],lt=[K],yt=ke.m,At=ke.s,Yt=null,br=0;e:for(;;){if(ge)for(;Je&&Me(yt,1);){var St=nt,Pt=lt,hr=ke,Lr=1,yr=hr.m,Br=hr.gc[hr.ab],jr=Me(yr,2);if(hr.Oc&1<<jr)Je=0;else{switch(hr.Oc|=1<<jr,Br.hc=jr,Br.Ea=St[0],Br.nc=Pt[0],Br.K=[null],++hr.ab,e(4>=hr.ab),jr){case 0:case 1:Br.b=Me(yr,3)+2,Lr=ha(_t(Br.Ea,Br.b),_t(Br.nc,Br.b),0,hr,Br.K),Br.K=Br.K[0];break;case 3:var sn,Jr=Me(yr,8)+1,Jn=16<Jr?0:4<Jr?1:2<Jr?2:3;if(St[0]=_t(Br.Ea,Jn),Br.b=Jn,sn=Lr=ha(Jr,1,0,hr,Br.K)){var Vn,Ai=Jr,Zn=Br,Yi=1<<(8>>Zn.b),No=a(Yi);if(No==null)sn=0;else{var Ni=Zn.K[0],Yn=Zn.w;for(No[0]=Zn.K[0][0],Vn=1;Vn<1*Ai;++Vn)No[Vn]=gr(Ni[Yn+Vn],No[Vn-1]);for(;Vn<4*Yi;++Vn)No[Vn]=0;Zn.K[0]=null,Zn.K[0]=No,sn=1}}Lr=sn;break;case 2:break;default:e(0)}Je=Lr}}if(nt=nt[0],lt=lt[0],Je&&Me(yt,1)&&!(Je=1<=(br=Me(yt,4))&&11>=br)){ke.a=3;break e}var wn;if(wn=Je)t:{var To,Pi,aa,da=ke,ki=nt,kl=lt,Qa=br,ys=ge,ks=da.m,Go=da.s,sa=[null],wa=1,Co=0,qi=nh[Qa];r:for(;;){if(ys&&Me(ks,1)){var Wo=Me(ks,3)+2,Tn=_t(ki,Wo),Sn=_t(kl,Wo),Rs=Tn*Sn;if(!ha(Tn,Sn,0,da,sa))break r;for(sa=sa[0],Go.xc=Wo,To=0;To<Rs;++To){var Sa=sa[To]>>8&65535;sa[To]=Sa,Sa>=wa&&(wa=Sa+1)}}if(ks.h)break r;for(Pi=0;5>Pi;++Pi){var Lo=Lp[Pi];!Pi&&0<Qa&&(Lo+=1<<Qa),Co<Lo&&(Co=Lo)}var $a=s(wa*qi,ae),eo=wa,Rl=s(eo,fe);if(Rl==null)var Yl=null;else e(65536>=eo),Yl=Rl;var Zl=a(Co);if(Yl==null||Zl==null||$a==null){da.a=1;break r}var gu=$a;for(To=aa=0;To<wa;++To){var Ea=Yl[To],ia=Ea.G,pa=Ea.H,mu=0,yu=1,is=0;for(Pi=0;5>Pi;++Pi){Lo=Lp[Pi],ia[Pi]=gu,pa[Pi]=aa,!Pi&&0<Qa&&(Lo+=1<<Qa);i:{var Uh,Vh=Lo,$h=da,Gc=Zl,Wc=gu,$p=aa,sh=0,sc=$h.m,Vd=Me(sc,1);if(i(Gc,0,0,Vh),Vd){var Qg=Me(sc,1)+1,qh=Me(sc,1),Ef=Me(sc,qh==0?1:8);Gc[Ef]=1,Qg==2&&(Gc[Ef=Me(sc,8)]=1);var Hh=1}else{var Gh=a(19),Tf=Me(sc,4)+4;if(19<Tf){$h.a=3;var Wh=0;break i}for(Uh=0;Uh<Tf;++Uh)Gh[Bp[Uh]]=Me(sc,3);var Xh=void 0,Cf=void 0,qp=$h,D=Gh,u=Vh,g=Gc,w=0,C=qp.m,L=8,z=s(128,ae);n:for(;G(z,0,7,D,19);){if(Me(C,1)){var Y=2+2*Me(C,3);if((Xh=2+Me(C,Y))>u)break n}else Xh=u;for(Cf=0;Cf<u&&Xh--;){Xe(C);var re=z[0+(127&we(C))];Fe(C,C.u+re.g);var le=re.value;if(16>le)g[Cf++]=le,le!=0&&(L=le);else{var he=le==16,Pe=le-16,Ae=Hg[Pe],Ue=Me(C,Np[Pe])+Ae;if(Cf+Ue>u)break n;for(var Ze=he?L:0;0<Ue--;)g[Cf++]=Ze}}w=1;break n}w||(qp.a=3),Hh=w}(Hh=Hh&&!sc.h)&&(sh=G(Wc,$p,8,Gc,Vh)),Hh&&sh!=0?Wh=sh:($h.a=3,Wh=0)}if(Wh==0)break r;if(yu&&Fp[Pi]==1&&(yu=gu[aa].g==0),mu+=gu[aa].g,aa+=Wh,3>=Pi){var ht,pt=Zl[0];for(ht=1;ht<Lo;++ht)Zl[ht]>pt&&(pt=Zl[ht]);is+=pt}}if(Ea.nd=yu,Ea.Qb=0,yu&&(Ea.qb=(ia[3][pa[3]+0].value<<24|ia[1][pa[1]+0].value<<16|ia[2][pa[2]+0].value)>>>0,mu==0&&256>ia[0][pa[0]+0].value&&(Ea.Qb=1,Ea.qb+=ia[0][pa[0]+0].value<<8)),Ea.jc=!Ea.Qb&&6>is,Ea.jc){var dt,xt=Ea;for(dt=0;dt<Ua;++dt){var Nt=dt,wt=xt.pd[Nt],Lt=xt.G[0][xt.H[0]+Nt];256<=Lt.value?(wt.g=Lt.g+256,wt.value=Lt.value):(wt.g=0,wt.value=0,Nt>>=Ut(Lt,8,wt),Nt>>=Ut(xt.G[1][xt.H[1]+Nt],16,wt),Nt>>=Ut(xt.G[2][xt.H[2]+Nt],0,wt),Ut(xt.G[3][xt.H[3]+Nt],24,wt))}}}Go.vc=sa,Go.Wb=wa,Go.Ya=Yl,Go.yc=$a,wn=1;break t}wn=0}if(!(Je=wn)){ke.a=3;break e}if(0<br){if(At.ua=1<<br,!$e(At.Wa,br)){ke.a=1,Je=0;break e}}else At.ua=0;var jt=ke,Dt=nt,Zt=lt,Sr=jt.s,pr=Sr.xc;if(jt.c=Dt,jt.i=Zt,Sr.md=_t(Dt,pr),Sr.wc=pr==0?-1:(1<<pr)-1,ge){ke.xb=ah;break e}if((Yt=a(nt*lt))==null){ke.a=1,Je=0;break e}Je=(Je=Bn(ke,Yt,0,nt,lt,lt,null))&&!yt.h;break e}return Je?(Ye!=null?Ye[0]=Yt:(e(Yt==null),e(ge)),ke.$=0,ge||ei(At)):ei(At),Je}function zn(q,K){var ge=q.c*q.i,ke=ge+K+16*K;return e(q.c<=K),q.V=a(ke),q.V==null?(q.Ta=null,q.Ua=0,q.a=1,0):(q.Ta=q.V,q.Ua=q.Ba+ge+K,1)}function La(q,K){var ge=q.C,ke=K-ge,Ye=q.V,Je=q.Ba+q.c*ge;for(e(K<=q.l.o);0<ke;){var nt=16<ke?16:ke,lt=q.l.ma,yt=q.l.width,At=yt*nt,Yt=lt.ca,br=lt.tb+yt*ge,St=q.Ta,Pt=q.Ua;Nn(q,nt,Ye,Je),Ho(St,Pt,Yt,br,At),Fr(lt,ge,ge+nt,Yt,br,yt),ke-=nt,Ye+=nt*q.c,ge+=nt}e(ge==K),q.C=q.Ma=K}function Wi(){this.ub=this.yd=this.td=this.Rb=0}function hs(){this.Kd=this.Ld=this.Ud=this.Td=this.i=this.c=0}function Ca(){this.Fb=this.Bb=this.Cb=0,this.Zb=a(4),this.Lb=a(4)}function Mo(){this.Yb=(function(){var q=[];return(function K(ge,ke,Ye){for(var Je=Ye[ke],nt=0;nt<Je&&(ge.push(Ye.length>ke+1?[]:0),!(Ye.length<ke+1));nt++)K(ge[nt],ke+1,Ye)})(q,0,[3,11]),q})()}function Ya(){this.jb=a(3),this.Wc=o([4,8],Mo),this.Xc=o([4,17],Mo)}function ol(){this.Pc=this.wb=this.Tb=this.zd=0,this.vd=new a(4),this.od=new a(4)}function xi(){this.ld=this.La=this.dd=this.tc=0}function zi(){this.Na=this.la=0}function Iu(){this.Sc=[0,0],this.Eb=[0,0],this.Qc=[0,0],this.ia=this.lc=0}function ga(){this.ad=a(384),this.Za=0,this.Ob=a(16),this.$b=this.Ad=this.ia=this.Gc=this.Hc=this.Dd=0}function Za(){this.uc=this.M=this.Nb=0,this.wa=Array(new xi),this.Y=0,this.ya=Array(new ga),this.aa=0,this.l=new ps}function ds(){this.y=a(16),this.f=a(8),this.ea=a(8)}function Aa(){this.cb=this.a=0,this.sc="",this.m=new de,this.Od=new Wi,this.Kc=new hs,this.ed=new ol,this.Qa=new Ca,this.Ic=this.$c=this.Aa=0,this.D=new Za,this.Xb=this.Va=this.Hb=this.zb=this.yb=this.Ub=this.za=0,this.Jc=s(8,de),this.ia=0,this.pb=s(4,Iu),this.Pa=new Ya,this.Bd=this.kc=0,this.Ac=[],this.Bc=0,this.zc=[0,0,0,0],this.Gd=Array(new ds),this.Hd=0,this.rb=Array(new zi),this.sb=0,this.wa=Array(new xi),this.Y=0,this.oc=[],this.pc=0,this.sa=[],this.ta=0,this.qa=[],this.ra=0,this.Ha=[],this.B=this.R=this.Ia=0,this.Ec=[],this.M=this.ja=this.Vb=this.Fc=0,this.ya=Array(new ga),this.L=this.aa=0,this.gd=o([4,2],xi),this.ga=null,this.Fa=[],this.Cc=this.qc=this.P=0,this.Gb=[],this.Uc=0,this.mb=[],this.nb=0,this.rc=[],this.Ga=this.Vc=0}function ps(){this.T=this.U=this.ka=this.height=this.width=0,this.y=[],this.f=[],this.ea=[],this.Rc=this.fa=this.W=this.N=this.O=0,this.ma="void",this.put="VP8IoPutHook",this.ac="VP8IoSetupHook",this.bc="VP8IoTeardownHook",this.ha=this.Kb=0,this.data=[],this.hb=this.ib=this.da=this.o=this.j=this.va=this.v=this.Da=this.ob=this.w=0,this.F=[],this.J=0}function Ul(){var q=new Aa;return q!=null&&(q.a=0,q.sc="OK",q.cb=0,q.Xb=0,Nd||(Nd=sl)),q}function Fa(q,K,ge){return q.a==0&&(q.a=K,q.sc=ge,q.cb=0),0}function _a(q,K,ge){return 3<=ge&&q[K+0]==157&&q[K+1]==1&&q[K+2]==42}function wc(q,K){if(q==null)return 0;if(q.a=0,q.sc="OK",K==null)return Fa(q,2,"null VP8Io passed to VP8GetHeaders()");var ge=K.data,ke=K.w,Ye=K.ha;if(4>Ye)return Fa(q,7,"Truncated header.");var Je=ge[ke+0]|ge[ke+1]<<8|ge[ke+2]<<16,nt=q.Od;if(nt.Rb=!(1&Je),nt.td=Je>>1&7,nt.yd=Je>>4&1,nt.ub=Je>>5,3<nt.td)return Fa(q,3,"Incorrect keyframe parameters.");if(!nt.yd)return Fa(q,4,"Frame not displayable.");ke+=3,Ye-=3;var lt=q.Kc;if(nt.Rb){if(7>Ye)return Fa(q,7,"cannot parse picture header");if(!_a(ge,ke,Ye))return Fa(q,3,"Bad code word");lt.c=16383&(ge[ke+4]<<8|ge[ke+3]),lt.Td=ge[ke+4]>>6,lt.i=16383&(ge[ke+6]<<8|ge[ke+5]),lt.Ud=ge[ke+6]>>6,ke+=7,Ye-=7,q.za=lt.c+15>>4,q.Ub=lt.i+15>>4,K.width=lt.c,K.height=lt.i,K.Da=0,K.j=0,K.v=0,K.va=K.width,K.o=K.height,K.da=0,K.ib=K.width,K.hb=K.height,K.U=K.width,K.T=K.height,i((Je=q.Pa).jb,0,255,Je.jb.length),e((Je=q.Qa)!=null),Je.Cb=0,Je.Bb=0,Je.Fb=1,i(Je.Zb,0,0,Je.Zb.length),i(Je.Lb,0,0,Je.Lb)}if(nt.ub>Ye)return Fa(q,7,"bad partition length");_e(Je=q.m,ge,ke,nt.ub),ke+=nt.ub,Ye-=nt.ub,nt.Rb&&(lt.Ld=st(Je),lt.Kd=st(Je)),lt=q.Qa;var yt,At=q.Pa;if(e(Je!=null),e(lt!=null),lt.Cb=st(Je),lt.Cb){if(lt.Bb=st(Je),st(Je)){for(lt.Fb=st(Je),yt=0;4>yt;++yt)lt.Zb[yt]=st(Je)?ye(Je,7):0;for(yt=0;4>yt;++yt)lt.Lb[yt]=st(Je)?ye(Je,6):0}if(lt.Bb)for(yt=0;3>yt;++yt)At.jb[yt]=st(Je)?Le(Je,8):255}else lt.Bb=0;if(Je.Ka)return Fa(q,3,"cannot parse segment header");if((lt=q.ed).zd=st(Je),lt.Tb=Le(Je,6),lt.wb=Le(Je,3),lt.Pc=st(Je),lt.Pc&&st(Je)){for(At=0;4>At;++At)st(Je)&&(lt.vd[At]=ye(Je,6));for(At=0;4>At;++At)st(Je)&&(lt.od[At]=ye(Je,6))}if(q.L=lt.Tb==0?0:lt.zd?1:2,Je.Ka)return Fa(q,3,"cannot parse filter header");var Yt=Ye;if(Ye=yt=ke,ke=yt+Yt,lt=Yt,q.Xb=(1<<Le(q.m,2))-1,Yt<3*(At=q.Xb))ge=7;else{for(yt+=3*At,lt-=3*At,Yt=0;Yt<At;++Yt){var br=ge[Ye+0]|ge[Ye+1]<<8|ge[Ye+2]<<16;br>lt&&(br=lt),_e(q.Jc[+Yt],ge,yt,br),yt+=br,lt-=br,Ye+=3}_e(q.Jc[+At],ge,yt,lt),ge=yt<ke?0:5}if(ge!=0)return Fa(q,ge,"cannot parse partitions");for(ge=Le(yt=q.m,7),Ye=st(yt)?ye(yt,4):0,ke=st(yt)?ye(yt,4):0,lt=st(yt)?ye(yt,4):0,At=st(yt)?ye(yt,4):0,yt=st(yt)?ye(yt,4):0,Yt=q.Qa,br=0;4>br;++br){if(Yt.Cb){var St=Yt.Zb[br];Yt.Fb||(St+=ge)}else{if(0<br){q.pb[br]=q.pb[0];continue}St=ge}var Pt=q.pb[br];Pt.Sc[0]=Wg[ja(St+Ye,127)],Pt.Sc[1]=ih[ja(St+0,127)],Pt.Eb[0]=2*Wg[ja(St+ke,127)],Pt.Eb[1]=101581*ih[ja(St+lt,127)]>>16,8>Pt.Eb[1]&&(Pt.Eb[1]=8),Pt.Qc[0]=Wg[ja(St+At,117)],Pt.Qc[1]=ih[ja(St+yt,127)],Pt.lc=St+yt}if(!nt.Rb)return Fa(q,4,"Not a key frame.");for(st(Je),nt=q.Pa,ge=0;4>ge;++ge){for(Ye=0;8>Ye;++Ye)for(ke=0;3>ke;++ke)for(lt=0;11>lt;++lt)At=Qe(Je,Bd[ge][Ye][ke][lt])?Le(Je,8):Fy[ge][Ye][ke][lt],nt.Wc[ge][Ye].Yb[ke][lt]=At;for(Ye=0;17>Ye;++Ye)nt.Xc[ge][Ye]=nt.Wc[ge][zp[Ye]]}return q.kc=st(Je),q.kc&&(q.Bd=Le(Je,8)),q.cb=1}function sl(q,K,ge,ke,Ye,Je,nt){var lt=K[Ye].Yb[ge];for(ge=0;16>Ye;++Ye){if(!Qe(q,lt[ge+0]))return Ye;for(;!Qe(q,lt[ge+1]);)if(lt=K[++Ye].Yb[0],ge=0,Ye==16)return 16;var yt=K[Ye+1].Yb;if(Qe(q,lt[ge+2])){var At=q,Yt=0;if(Qe(At,(St=lt)[(br=ge)+3]))if(Qe(At,St[br+6])){for(lt=0,br=2*(Yt=Qe(At,St[br+8]))+(St=Qe(At,St[br+9+Yt])),Yt=0,St=Ly[br];St[lt];++lt)Yt+=Yt+Qe(At,St[lt]);Yt+=3+(8<<br)}else Qe(At,St[br+7])?(Yt=7+2*Qe(At,165),Yt+=Qe(At,145)):Yt=5+Qe(At,159);else Yt=Qe(At,St[br+4])?3+Qe(At,St[br+5]):2;lt=yt[2]}else Yt=1,lt=yt[1];yt=nt+Ld[Ye],0>(At=q).b&&Be(At);var br,St=At.b,Pt=(br=At.Ca>>1)-(At.I>>St)>>31;--At.b,At.Ca+=Pt,At.Ca|=1,At.I-=(br+1&Pt)<<St,Je[yt]=((Yt^Pt)-Pt)*ke[(0<Ye)+0]}return 16}function ts(q){var K=q.rb[q.sb-1];K.la=0,K.Na=0,i(q.zc,0,0,q.zc.length),q.ja=0}function oo(q,K,ge,ke,Ye){Ye=q[K+ge+32*ke]+(Ye>>3),q[K+ge+32*ke]=-256&Ye?0>Ye?0:255:Ye}function rs(q,K,ge,ke,Ye,Je){oo(q,K,0,ge,ke+Ye),oo(q,K,1,ge,ke+Je),oo(q,K,2,ge,ke-Je),oo(q,K,3,ge,ke-Ye)}function Ba(q){return(20091*q>>16)+q}function Us(q,K,ge,ke){var Ye,Je=0,nt=a(16);for(Ye=0;4>Ye;++Ye){var lt=q[K+0]+q[K+8],yt=q[K+0]-q[K+8],At=(35468*q[K+4]>>16)-Ba(q[K+12]),Yt=Ba(q[K+4])+(35468*q[K+12]>>16);nt[Je+0]=lt+Yt,nt[Je+1]=yt+At,nt[Je+2]=yt-At,nt[Je+3]=lt-Yt,Je+=4,K++}for(Ye=Je=0;4>Ye;++Ye)lt=(q=nt[Je+0]+4)+nt[Je+8],yt=q-nt[Je+8],At=(35468*nt[Je+4]>>16)-Ba(nt[Je+12]),oo(ge,ke,0,0,lt+(Yt=Ba(nt[Je+4])+(35468*nt[Je+12]>>16))),oo(ge,ke,1,0,yt+At),oo(ge,ke,2,0,yt-At),oo(ge,ke,3,0,lt-Yt),Je++,ke+=32}function $c(q,K,ge,ke){var Ye=q[K+0]+4,Je=35468*q[K+4]>>16,nt=Ba(q[K+4]),lt=35468*q[K+1]>>16;rs(ge,ke,0,Ye+nt,q=Ba(q[K+1]),lt),rs(ge,ke,1,Ye+Je,q,lt),rs(ge,ke,2,Ye-Je,q,lt),rs(ge,ke,3,Ye-nt,q,lt)}function Pu(q,K,ge,ke,Ye){Us(q,K,ge,ke),Ye&&Us(q,K+16,ge,ke+4)}function ee(q,K,ge,ke){_(q,K+0,ge,ke,1),_(q,K+32,ge,ke+128,1)}function pe(q,K,ge,ke){var Ye;for(q=q[K+0]+4,Ye=0;4>Ye;++Ye)for(K=0;4>K;++K)oo(ge,ke,K,Ye,q)}function Ke(q,K,ge,ke){q[K+0]&&ne(q,K+0,ge,ke),q[K+16]&&ne(q,K+16,ge,ke+4),q[K+32]&&ne(q,K+32,ge,ke+128),q[K+48]&&ne(q,K+48,ge,ke+128+4)}function It(q,K,ge,ke){var Ye,Je=a(16);for(Ye=0;4>Ye;++Ye){var nt=q[K+0+Ye]+q[K+12+Ye],lt=q[K+4+Ye]+q[K+8+Ye],yt=q[K+4+Ye]-q[K+8+Ye],At=q[K+0+Ye]-q[K+12+Ye];Je[0+Ye]=nt+lt,Je[8+Ye]=nt-lt,Je[4+Ye]=At+yt,Je[12+Ye]=At-yt}for(Ye=0;4>Ye;++Ye)nt=(q=Je[0+4*Ye]+3)+Je[3+4*Ye],lt=Je[1+4*Ye]+Je[2+4*Ye],yt=Je[1+4*Ye]-Je[2+4*Ye],At=q-Je[3+4*Ye],ge[ke+0]=nt+lt>>3,ge[ke+16]=At+yt>>3,ge[ke+32]=nt-lt>>3,ge[ke+48]=At-yt>>3,ke+=64}function Vt(q,K,ge){var ke,Ye=K-32,Je=Eo,nt=255-q[Ye-1];for(ke=0;ke<ge;++ke){var lt,yt=Je,At=nt+q[K-1];for(lt=0;lt<ge;++lt)q[K+lt]=yt[At+q[Ye+lt]];K+=32}}function qt(q,K){Vt(q,K,4)}function er(q,K){Vt(q,K,8)}function Yr(q,K){Vt(q,K,16)}function tn(q,K){var ge;for(ge=0;16>ge;++ge)n(q,K+32*ge,q,K-32,16)}function Gr(q,K){var ge;for(ge=16;0<ge;--ge)i(q,K,q[K-1],16),K+=32}function on(q,K,ge){var ke;for(ke=0;16>ke;++ke)i(K,ge+32*ke,q,16)}function kr(q,K){var ge,ke=16;for(ge=0;16>ge;++ge)ke+=q[K-1+32*ge]+q[K+ge-32];on(ke>>5,q,K)}function ti(q,K){var ge,ke=8;for(ge=0;16>ge;++ge)ke+=q[K-1+32*ge];on(ke>>4,q,K)}function Ri(q,K){var ge,ke=8;for(ge=0;16>ge;++ge)ke+=q[K+ge-32];on(ke>>4,q,K)}function $n(q,K){on(128,q,K)}function _n(q,K,ge){return q+2*K+ge+2>>2}function Mr(q,K){var ge,ke=K-32;for(ke=new Uint8Array([_n(q[ke-1],q[ke+0],q[ke+1]),_n(q[ke+0],q[ke+1],q[ke+2]),_n(q[ke+1],q[ke+2],q[ke+3]),_n(q[ke+2],q[ke+3],q[ke+4])]),ge=0;4>ge;++ge)n(q,K+32*ge,ke,0,ke.length)}function hn(q,K){var ge=q[K-1],ke=q[K-1+32],Ye=q[K-1+64],Je=q[K-1+96];it(q,K+0,16843009*_n(q[K-1-32],ge,ke)),it(q,K+32,16843009*_n(ge,ke,Ye)),it(q,K+64,16843009*_n(ke,Ye,Je)),it(q,K+96,16843009*_n(Ye,Je,Je))}function mn(q,K){var ge,ke=4;for(ge=0;4>ge;++ge)ke+=q[K+ge-32]+q[K-1+32*ge];for(ke>>=3,ge=0;4>ge;++ge)i(q,K+32*ge,ke,4)}function fi(q,K){var ge=q[K-1+0],ke=q[K-1+32],Ye=q[K-1+64],Je=q[K-1-32],nt=q[K+0-32],lt=q[K+1-32],yt=q[K+2-32],At=q[K+3-32];q[K+0+96]=_n(ke,Ye,q[K-1+96]),q[K+1+96]=q[K+0+64]=_n(ge,ke,Ye),q[K+2+96]=q[K+1+64]=q[K+0+32]=_n(Je,ge,ke),q[K+3+96]=q[K+2+64]=q[K+1+32]=q[K+0+0]=_n(nt,Je,ge),q[K+3+64]=q[K+2+32]=q[K+1+0]=_n(lt,nt,Je),q[K+3+32]=q[K+2+0]=_n(yt,lt,nt),q[K+3+0]=_n(At,yt,lt)}function $i(q,K){var ge=q[K+1-32],ke=q[K+2-32],Ye=q[K+3-32],Je=q[K+4-32],nt=q[K+5-32],lt=q[K+6-32],yt=q[K+7-32];q[K+0+0]=_n(q[K+0-32],ge,ke),q[K+1+0]=q[K+0+32]=_n(ge,ke,Ye),q[K+2+0]=q[K+1+32]=q[K+0+64]=_n(ke,Ye,Je),q[K+3+0]=q[K+2+32]=q[K+1+64]=q[K+0+96]=_n(Ye,Je,nt),q[K+3+32]=q[K+2+64]=q[K+1+96]=_n(Je,nt,lt),q[K+3+64]=q[K+2+96]=_n(nt,lt,yt),q[K+3+96]=_n(lt,yt,yt)}function ba(q,K){var ge=q[K-1+0],ke=q[K-1+32],Ye=q[K-1+64],Je=q[K-1-32],nt=q[K+0-32],lt=q[K+1-32],yt=q[K+2-32],At=q[K+3-32];q[K+0+0]=q[K+1+64]=Je+nt+1>>1,q[K+1+0]=q[K+2+64]=nt+lt+1>>1,q[K+2+0]=q[K+3+64]=lt+yt+1>>1,q[K+3+0]=yt+At+1>>1,q[K+0+96]=_n(Ye,ke,ge),q[K+0+64]=_n(ke,ge,Je),q[K+0+32]=q[K+1+96]=_n(ge,Je,nt),q[K+1+32]=q[K+2+96]=_n(Je,nt,lt),q[K+2+32]=q[K+3+96]=_n(nt,lt,yt),q[K+3+32]=_n(lt,yt,At)}function wi(q,K){var ge=q[K+0-32],ke=q[K+1-32],Ye=q[K+2-32],Je=q[K+3-32],nt=q[K+4-32],lt=q[K+5-32],yt=q[K+6-32],At=q[K+7-32];q[K+0+0]=ge+ke+1>>1,q[K+1+0]=q[K+0+64]=ke+Ye+1>>1,q[K+2+0]=q[K+1+64]=Ye+Je+1>>1,q[K+3+0]=q[K+2+64]=Je+nt+1>>1,q[K+0+32]=_n(ge,ke,Ye),q[K+1+32]=q[K+0+96]=_n(ke,Ye,Je),q[K+2+32]=q[K+1+96]=_n(Ye,Je,nt),q[K+3+32]=q[K+2+96]=_n(Je,nt,lt),q[K+3+64]=_n(nt,lt,yt),q[K+3+96]=_n(lt,yt,At)}function hi(q,K){var ge=q[K-1+0],ke=q[K-1+32],Ye=q[K-1+64],Je=q[K-1+96];q[K+0+0]=ge+ke+1>>1,q[K+2+0]=q[K+0+32]=ke+Ye+1>>1,q[K+2+32]=q[K+0+64]=Ye+Je+1>>1,q[K+1+0]=_n(ge,ke,Ye),q[K+3+0]=q[K+1+32]=_n(ke,Ye,Je),q[K+3+32]=q[K+1+64]=_n(Ye,Je,Je),q[K+3+64]=q[K+2+64]=q[K+0+96]=q[K+1+96]=q[K+2+96]=q[K+3+96]=Je}function Ts(q,K){var ge=q[K-1+0],ke=q[K-1+32],Ye=q[K-1+64],Je=q[K-1+96],nt=q[K-1-32],lt=q[K+0-32],yt=q[K+1-32],At=q[K+2-32];q[K+0+0]=q[K+2+32]=ge+nt+1>>1,q[K+0+32]=q[K+2+64]=ke+ge+1>>1,q[K+0+64]=q[K+2+96]=Ye+ke+1>>1,q[K+0+96]=Je+Ye+1>>1,q[K+3+0]=_n(lt,yt,At),q[K+2+0]=_n(nt,lt,yt),q[K+1+0]=q[K+3+32]=_n(ge,nt,lt),q[K+1+32]=q[K+3+64]=_n(ke,ge,nt),q[K+1+64]=q[K+3+96]=_n(Ye,ke,ge),q[K+1+96]=_n(Je,Ye,ke)}function Vs(q,K){var ge;for(ge=0;8>ge;++ge)n(q,K+32*ge,q,K-32,8)}function Mi(q,K){var ge;for(ge=0;8>ge;++ge)i(q,K,q[K-1],8),K+=32}function Cs(q,K,ge){var ke;for(ke=0;8>ke;++ke)i(K,ge+32*ke,q,8)}function oa(q,K){var ge,ke=8;for(ge=0;8>ge;++ge)ke+=q[K+ge-32]+q[K-1+32*ge];Cs(ke>>4,q,K)}function ku(q,K){var ge,ke=4;for(ge=0;8>ge;++ge)ke+=q[K+ge-32];Cs(ke>>3,q,K)}function Ka(q,K){var ge,ke=4;for(ge=0;8>ge;++ge)ke+=q[K-1+32*ge];Cs(ke>>3,q,K)}function $s(q,K){Cs(128,q,K)}function Vo(q,K,ge){var ke=q[K-ge],Ye=q[K+0],Je=3*(Ye-ke)+Gl[1020+q[K-2*ge]-q[K+ge]],nt=Wl[112+(Je+4>>3)];q[K-ge]=Eo[255+ke+Wl[112+(Je+3>>3)]],q[K+0]=Eo[255+Ye-nt]}function Ru(q,K,ge,ke){var Ye=q[K+0],Je=q[K+ge];return ni[255+q[K-2*ge]-q[K-ge]]>ke||ni[255+Je-Ye]>ke}function Mu(q,K,ge,ke){return 4*ni[255+q[K-ge]-q[K+0]]+ni[255+q[K-2*ge]-q[K+ge]]<=ke}function go(q,K,ge,ke,Ye){var Je=q[K-3*ge],nt=q[K-2*ge],lt=q[K-ge],yt=q[K+0],At=q[K+ge],Yt=q[K+2*ge],br=q[K+3*ge];return 4*ni[255+lt-yt]+ni[255+nt-At]>ke?0:ni[255+q[K-4*ge]-Je]<=Ye&&ni[255+Je-nt]<=Ye&&ni[255+nt-lt]<=Ye&&ni[255+br-Yt]<=Ye&&ni[255+Yt-At]<=Ye&&ni[255+At-yt]<=Ye}function ji(q,K,ge,ke){var Ye=2*ke+1;for(ke=0;16>ke;++ke)Mu(q,K+ke,ge,Ye)&&Vo(q,K+ke,ge)}function qs(q,K,ge,ke){var Ye=2*ke+1;for(ke=0;16>ke;++ke)Mu(q,K+ke*ge,1,Ye)&&Vo(q,K+ke*ge,1)}function ii(q,K,ge,ke){var Ye;for(Ye=3;0<Ye;--Ye)ji(q,K+=4*ge,ge,ke)}function ri(q,K,ge,ke){var Ye;for(Ye=3;0<Ye;--Ye)qs(q,K+=4,ge,ke)}function Do(q,K,ge,ke,Ye,Je,nt,lt){for(Je=2*Je+1;0<Ye--;){if(go(q,K,ge,Je,nt))if(Ru(q,K,ge,lt))Vo(q,K,ge);else{var yt=q,At=K,Yt=ge,br=yt[At-2*Yt],St=yt[At-Yt],Pt=yt[At+0],hr=yt[At+Yt],Lr=yt[At+2*Yt],yr=27*(jr=Gl[1020+3*(Pt-St)+Gl[1020+br-hr]])+63>>7,Br=18*jr+63>>7,jr=9*jr+63>>7;yt[At-3*Yt]=Eo[255+yt[At-3*Yt]+jr],yt[At-2*Yt]=Eo[255+br+Br],yt[At-Yt]=Eo[255+St+yr],yt[At+0]=Eo[255+Pt-yr],yt[At+Yt]=Eo[255+hr-Br],yt[At+2*Yt]=Eo[255+Lr-jr]}K+=ke}}function ai(q,K,ge,ke,Ye,Je,nt,lt){for(Je=2*Je+1;0<Ye--;){if(go(q,K,ge,Je,nt))if(Ru(q,K,ge,lt))Vo(q,K,ge);else{var yt=q,At=K,Yt=ge,br=yt[At-Yt],St=yt[At+0],Pt=yt[At+Yt],hr=Wl[112+(4+(Lr=3*(St-br))>>3)],Lr=Wl[112+(Lr+3>>3)],yr=hr+1>>1;yt[At-2*Yt]=Eo[255+yt[At-2*Yt]+yr],yt[At-Yt]=Eo[255+br+Lr],yt[At+0]=Eo[255+St-hr],yt[At+Yt]=Eo[255+Pt-yr]}K+=ke}}function ue(q,K,ge,ke,Ye,Je){Do(q,K,ge,1,16,ke,Ye,Je)}function We(q,K,ge,ke,Ye,Je){Do(q,K,1,ge,16,ke,Ye,Je)}function bt(q,K,ge,ke,Ye,Je){var nt;for(nt=3;0<nt;--nt)ai(q,K+=4*ge,ge,1,16,ke,Ye,Je)}function zt(q,K,ge,ke,Ye,Je){var nt;for(nt=3;0<nt;--nt)ai(q,K+=4,1,ge,16,ke,Ye,Je)}function lr(q,K,ge,ke,Ye,Je,nt,lt){Do(q,K,Ye,1,8,Je,nt,lt),Do(ge,ke,Ye,1,8,Je,nt,lt)}function Nr(q,K,ge,ke,Ye,Je,nt,lt){Do(q,K,1,Ye,8,Je,nt,lt),Do(ge,ke,1,Ye,8,Je,nt,lt)}function Zr(q,K,ge,ke,Ye,Je,nt,lt){ai(q,K+4*Ye,Ye,1,8,Je,nt,lt),ai(ge,ke+4*Ye,Ye,1,8,Je,nt,lt)}function Ln(q,K,ge,ke,Ye,Je,nt,lt){ai(q,K+4,1,Ye,8,Je,nt,lt),ai(ge,ke+4,1,Ye,8,Je,nt,lt)}function qn(){this.ba=new zr,this.ec=[],this.cc=[],this.Mc=[],this.Dc=this.Nc=this.dc=this.fc=0,this.Oa=new en,this.memory=0,this.Ib="OutputFunc",this.Jb="OutputAlphaFunc",this.Nd="OutputRowFunc"}function Un(){this.data=[],this.offset=this.kd=this.ha=this.w=0,this.na=[],this.xa=this.gb=this.Ja=this.Sa=this.P=0}function ui(){this.nc=this.Ea=this.b=this.hc=0,this.K=[],this.w=0}function Hn(){this.ua=0,this.Wa=new $t,this.vb=new $t,this.md=this.xc=this.wc=0,this.vc=[],this.Wb=0,this.Ya=new fe,this.yc=new ae}function Ui(){this.xb=this.a=0,this.l=new ps,this.ca=new zr,this.V=[],this.Ba=0,this.Ta=[],this.Ua=0,this.m=new Se,this.Pb=0,this.wd=new Se,this.Ma=this.$=this.C=this.i=this.c=this.xd=0,this.s=new Hn,this.ab=0,this.gc=s(4,ui),this.Oc=0}function Xi(){this.Lc=this.Z=this.$a=this.i=this.c=0,this.l=new ps,this.ic=0,this.ca=[],this.tb=0,this.qd=null,this.rd=0}function ra(q,K,ge,ke,Ye,Je,nt){for(q=q==null?0:q[K+0],K=0;K<nt;++K)Ye[Je+K]=q+ge[ke+K]&255,q=Ye[Je+K]}function Si(q,K,ge,ke,Ye,Je,nt){var lt;if(q==null)ra(null,null,ge,ke,Ye,Je,nt);else for(lt=0;lt<nt;++lt)Ye[Je+lt]=q[K+lt]+ge[ke+lt]&255}function Ia(q,K,ge,ke,Ye,Je,nt){if(q==null)ra(null,null,ge,ke,Ye,Je,nt);else{var lt,yt=q[K+0],At=yt,Yt=yt;for(lt=0;lt<nt;++lt)At=Yt+(yt=q[K+lt])-At,Yt=ge[ke+lt]+(-256&At?0>At?0:255:At)&255,At=yt,Ye[Je+lt]=Yt}}function za(q,K,ge,ke){var Ye=K.width,Je=K.o;if(e(q!=null&&K!=null),0>ge||0>=ke||ge+ke>Je)return null;if(!q.Cc){if(q.ga==null){var nt;if(q.ga=new Xi,(nt=q.ga==null)||(nt=K.width*K.o,e(q.Gb.length==0),q.Gb=a(nt),q.Uc=0,q.Gb==null?nt=0:(q.mb=q.Gb,q.nb=q.Uc,q.rc=null,nt=1),nt=!nt),!nt){nt=q.ga;var lt=q.Fa,yt=q.P,At=q.qc,Yt=q.mb,br=q.nb,St=yt+1,Pt=At-1,hr=nt.l;if(e(lt!=null&&Yt!=null&&K!=null),ac[0]=null,ac[1]=ra,ac[2]=Si,ac[3]=Ia,nt.ca=Yt,nt.tb=br,nt.c=K.width,nt.i=K.height,e(0<nt.c&&0<nt.i),1>=At)K=0;else if(nt.$a=3&lt[yt+0],nt.Z=lt[yt+0]>>2&3,nt.Lc=lt[yt+0]>>4&3,yt=lt[yt+0]>>6&3,0>nt.$a||1<nt.$a||4<=nt.Z||1<nt.Lc||yt)K=0;else if(hr.put=un,hr.ac=oi,hr.bc=Kn,hr.ma=nt,hr.width=K.width,hr.height=K.height,hr.Da=K.Da,hr.v=K.v,hr.va=K.va,hr.j=K.j,hr.o=K.o,nt.$a)e:{e(nt.$a==1),K=ua();t:for(;;){if(K==null){K=0;break e}if(e(nt!=null),nt.mc=K,K.c=nt.c,K.i=nt.i,K.l=nt.l,K.l.ma=nt,K.l.width=nt.c,K.l.height=nt.i,K.a=0,Te(K.m,lt,St,Pt),!ha(nt.c,nt.i,1,K,null)||(K.ab==1&&K.gc[0].hc==3&&Ci(K.s)?(nt.ic=1,lt=K.c*K.i,K.Ta=null,K.Ua=0,K.V=a(lt),K.Ba=0,K.V==null?(K.a=1,K=0):K=1):(nt.ic=0,K=zn(K,nt.c)),!K))break t;K=1;break e}nt.mc=null,K=0}else K=Pt>=nt.c*nt.i;nt=!K}if(nt)return null;q.ga.Lc!=1?q.Ga=0:ke=Je-ge}e(q.ga!=null),e(ge+ke<=Je);e:{if(K=(lt=q.ga).c,Je=lt.l.o,lt.$a==0){if(St=q.rc,Pt=q.Vc,hr=q.Fa,yt=q.P+1+ge*K,At=q.mb,Yt=q.nb+ge*K,e(yt<=q.P+q.qc),lt.Z!=0)for(e(ac[lt.Z]!=null),nt=0;nt<ke;++nt)ac[lt.Z](St,Pt,hr,yt,At,Yt,K),St=At,Pt=Yt,Yt+=K,yt+=K;else for(nt=0;nt<ke;++nt)n(At,Yt,hr,yt,K),St=At,Pt=Yt,Yt+=K,yt+=K;q.rc=St,q.Vc=Pt}else{if(e(lt.mc!=null),K=ge+ke,e((nt=lt.mc)!=null),e(K<=nt.i),nt.C>=K)K=1;else if(lt.ic||Ws(),lt.ic){lt=nt.V,St=nt.Ba,Pt=nt.c;var Lr=nt.i,yr=(hr=1,yt=nt.$/Pt,At=nt.$%Pt,Yt=nt.m,br=nt.s,nt.$),Br=Pt*Lr,jr=Pt*K,sn=br.wc,Jr=yr<jr?Xr(br,At,yt):null;e(yr<=Br),e(K<=Lr),e(Ci(br));t:for(;;){for(;!Yt.h&&yr<jr;){if(At&sn||(Jr=Xr(br,At,yt)),e(Jr!=null),Xe(Yt),256>(Lr=Gt(Jr.G[0],Jr.H[0],Yt)))lt[St+yr]=Lr,++yr,++At>=Pt&&(At=0,++yt<=K&&!(yt%16)&&Mn(nt,yt));else{if(!(280>Lr)){hr=0;break t}Lr=He(Lr-256,Yt);var Jn,Vn=Gt(Jr.G[4],Jr.H[4],Yt);if(Xe(Yt),!(yr>=(Vn=Tt(Pt,Vn=He(Vn,Yt)))&&Br-yr>=Lr)){hr=0;break t}for(Jn=0;Jn<Lr;++Jn)lt[St+yr+Jn]=lt[St+yr+Jn-Vn];for(yr+=Lr,At+=Lr;At>=Pt;)At-=Pt,++yt<=K&&!(yt%16)&&Mn(nt,yt);yr<jr&&At&sn&&(Jr=Xr(br,At,yt))}e(Yt.h==De(Yt))}Mn(nt,yt>K?K:yt);break t}!hr||Yt.h&&yr<Br?(hr=0,nt.a=Yt.h?5:3):nt.$=yr,K=hr}else K=Bn(nt,nt.V,nt.Ba,nt.c,nt.i,K,La);if(!K){ke=0;break e}}ge+ke>=Je&&(q.Cc=1),ke=1}if(!ke)return null;if(q.Cc&&((ke=q.ga)!=null&&(ke.mc=null),q.ga=null,0<q.Ga))return alert("todo:WebPDequantizeLevels"),null}return q.nb+ge*Ye}function Hs(q,K,ge,ke,Ye,Je){for(;0<Ye--;){var nt,lt=q,yt=K+(ge?1:0),At=q,Yt=K+(ge?0:3);for(nt=0;nt<ke;++nt){var br=At[Yt+4*nt];br!=255&&(br*=32897,lt[yt+4*nt+0]=lt[yt+4*nt+0]*br>>23,lt[yt+4*nt+1]=lt[yt+4*nt+1]*br>>23,lt[yt+4*nt+2]=lt[yt+4*nt+2]*br>>23)}K+=Je}}function ll(q,K,ge,ke,Ye){for(;0<ke--;){var Je;for(Je=0;Je<ge;++Je){var nt=q[K+2*Je+0],lt=15&(At=q[K+2*Je+1]),yt=4369*lt,At=(240&At|At>>4)*yt>>16;q[K+2*Je+0]=(240&nt|nt>>4)*yt>>16&240|(15&nt|nt<<4)*yt>>16>>4&15,q[K+2*Je+1]=240&At|lt}K+=Ye}}function Gs(q,K,ge,ke,Ye,Je,nt,lt){var yt,At,Yt=255;for(At=0;At<Ye;++At){for(yt=0;yt<ke;++yt){var br=q[K+yt];Je[nt+4*yt]=br,Yt&=br}K+=ge,nt+=lt}return Yt!=255}function $o(q,K,ge,ke,Ye){var Je;for(Je=0;Je<Ye;++Je)ge[ke+Je]=q[K+Je]>>8}function Ws(){ca=Hs,so=ll,ka=Gs,Ho=$o}function Pa(q,K,ge){X[q]=function(ke,Ye,Je,nt,lt,yt,At,Yt,br,St,Pt,hr,Lr,yr,Br,jr,sn){var Jr,Jn=sn-1>>1,Vn=lt[yt+0]|At[Yt+0]<<16,Ai=br[St+0]|Pt[hr+0]<<16;e(ke!=null);var Zn=3*Vn+Ai+131074>>2;for(K(ke[Ye+0],255&Zn,Zn>>16,Lr,yr),Je!=null&&(Zn=3*Ai+Vn+131074>>2,K(Je[nt+0],255&Zn,Zn>>16,Br,jr)),Jr=1;Jr<=Jn;++Jr){var Yi=lt[yt+Jr]|At[Yt+Jr]<<16,No=br[St+Jr]|Pt[hr+Jr]<<16,Ni=Vn+Yi+Ai+No+524296,Yn=Ni+2*(Yi+Ai)>>3;Zn=Yn+Vn>>1,Vn=(Ni=Ni+2*(Vn+No)>>3)+Yi>>1,K(ke[Ye+2*Jr-1],255&Zn,Zn>>16,Lr,yr+(2*Jr-1)*ge),K(ke[Ye+2*Jr-0],255&Vn,Vn>>16,Lr,yr+(2*Jr-0)*ge),Je!=null&&(Zn=Ni+Ai>>1,Vn=Yn+No>>1,K(Je[nt+2*Jr-1],255&Zn,Zn>>16,Br,jr+(2*Jr-1)*ge),K(Je[nt+2*Jr+0],255&Vn,Vn>>16,Br,jr+(2*Jr+0)*ge)),Vn=Yi,Ai=No}1&sn||(Zn=3*Vn+Ai+131074>>2,K(ke[Ye+sn-1],255&Zn,Zn>>16,Lr,yr+(sn-1)*ge),Je!=null&&(Zn=3*Ai+Vn+131074>>2,K(Je[nt+sn-1],255&Zn,Zn>>16,Br,jr+(sn-1)*ge)))}}function Xs(){dl[Nu]=jp,dl[th]=zh,dl[bf]=wf,dl[pu]=Sf,dl[Op]=oh,dl[Vg]=Xg,dl[$g]=zy,dl[qg]=zh,dl[Od]=Sf,dl[qc]=oh,dl[rh]=Xg}function Il(q){return q&-16384?0>q?0:255:q>>Yg}function gs(q,K){return Il((19077*q>>8)+(26149*K>>8)-14234)}function Di(q,K,ge){return Il((19077*q>>8)-(6419*K>>8)-(13320*ge>>8)+8708)}function qo(q,K){return Il((19077*q>>8)+(33050*K>>8)-17685)}function Da(q,K,ge,ke,Ye){ke[Ye+0]=gs(q,ge),ke[Ye+1]=Di(q,K,ge),ke[Ye+2]=qo(q,K)}function ns(q,K,ge,ke,Ye){ke[Ye+0]=qo(q,K),ke[Ye+1]=Di(q,K,ge),ke[Ye+2]=gs(q,ge)}function As(q,K,ge,ke,Ye){var Je=Di(q,K,ge);K=Je<<3&224|qo(q,K)>>3,ke[Ye+0]=248&gs(q,ge)|Je>>5,ke[Ye+1]=K}function Ja(q,K,ge,ke,Ye){var Je=240&qo(q,K)|15;ke[Ye+0]=240&gs(q,ge)|Di(q,K,ge)>>4,ke[Ye+1]=Je}function rc(q,K,ge,ke,Ye){ke[Ye+0]=255,Da(q,K,ge,ke,Ye+1)}function uu(q,K,ge,ke,Ye){ns(q,K,ge,ke,Ye),ke[Ye+3]=255}function Ys(q,K,ge,ke,Ye){Da(q,K,ge,ke,Ye),ke[Ye+3]=255}function ja(q,K){return 0>q?0:q>K?K:q}function Is(q,K,ge){X[q]=function(ke,Ye,Je,nt,lt,yt,At,Yt,br){for(var St=Yt+(-2&br)*ge;Yt!=St;)K(ke[Ye+0],Je[nt+0],lt[yt+0],At,Yt),K(ke[Ye+1],Je[nt+0],lt[yt+0],At,Yt+ge),Ye+=2,++nt,++yt,Yt+=2*ge;1&br&&K(ke[Ye+0],Je[nt+0],lt[yt+0],At,Yt)}}function nc(q,K,ge){return ge==0?q==0?K==0?6:5:K==0?4:0:ge}function ic(q,K,ge,ke,Ye){switch(q>>>30){case 3:_(K,ge,ke,Ye,0);break;case 2:P(K,ge,ke,Ye);break;case 1:ne(K,ge,ke,Ye)}}function ul(q,K){var ge,ke,Ye=K.M,Je=K.Nb,nt=q.oc,lt=q.pc+40,yt=q.oc,At=q.pc+584,Yt=q.oc,br=q.pc+600;for(ge=0;16>ge;++ge)nt[lt+32*ge-1]=129;for(ge=0;8>ge;++ge)yt[At+32*ge-1]=129,Yt[br+32*ge-1]=129;for(0<Ye?nt[lt-1-32]=yt[At-1-32]=Yt[br-1-32]=129:(i(nt,lt-32-1,127,21),i(yt,At-32-1,127,9),i(Yt,br-32-1,127,9)),ke=0;ke<q.za;++ke){var St=K.ya[K.aa+ke];if(0<ke){for(ge=-1;16>ge;++ge)n(nt,lt+32*ge-4,nt,lt+32*ge+12,4);for(ge=-1;8>ge;++ge)n(yt,At+32*ge-4,yt,At+32*ge+4,4),n(Yt,br+32*ge-4,Yt,br+32*ge+4,4)}var Pt=q.Gd,hr=q.Hd+ke,Lr=St.ad,yr=St.Hc;if(0<Ye&&(n(nt,lt-32,Pt[hr].y,0,16),n(yt,At-32,Pt[hr].f,0,8),n(Yt,br-32,Pt[hr].ea,0,8)),St.Za){var Br=nt,jr=lt-32+16;for(0<Ye&&(ke>=q.za-1?i(Br,jr,Pt[hr].y[15],4):n(Br,jr,Pt[hr+1].y,0,4)),ge=0;4>ge;ge++)Br[jr+128+ge]=Br[jr+256+ge]=Br[jr+384+ge]=Br[jr+0+ge];for(ge=0;16>ge;++ge,yr<<=2)Br=nt,jr=lt+Vp[ge],Lu[St.Ob[ge]](Br,jr),ic(yr,Lr,16*+ge,Br,jr)}else if(Br=nc(ke,Ye,St.Ob[0]),Hc[Br](nt,lt),yr!=0)for(ge=0;16>ge;++ge,yr<<=2)ic(yr,Lr,16*+ge,nt,lt+Vp[ge]);for(ge=St.Gc,Br=nc(ke,Ye,St.Dd),xa[Br](yt,At),xa[Br](Yt,br),yr=Lr,Br=yt,jr=At,255&(St=0|ge)&&(170&St?$(yr,256,Br,jr):me(yr,256,Br,jr)),St=Yt,yr=br,255&(ge>>=8)&&(170&ge?$(Lr,320,St,yr):me(Lr,320,St,yr)),Ye<q.Ub-1&&(n(Pt[hr].y,0,nt,lt+480,16),n(Pt[hr].f,0,yt,At+224,8),n(Pt[hr].ea,0,Yt,br+224,8)),ge=8*Je*q.B,Pt=q.sa,hr=q.ta+16*ke+16*Je*q.R,Lr=q.qa,St=q.ra+8*ke+ge,yr=q.Ha,Br=q.Ia+8*ke+ge,ge=0;16>ge;++ge)n(Pt,hr+ge*q.R,nt,lt+32*ge,16);for(ge=0;8>ge;++ge)n(Lr,St+ge*q.B,yt,At+32*ge,8),n(yr,Br+ge*q.B,Yt,br+32*ge,8)}}function cu(q,K,ge,ke,Ye,Je,nt,lt,yt){var At=[0],Yt=[0],br=0,St=yt!=null?yt.kd:0,Pt=yt??new Un;if(q==null||12>ge)return 7;Pt.data=q,Pt.w=K,Pt.ha=ge,K=[K],ge=[ge],Pt.gb=[Pt.gb];e:{var hr=K,Lr=ge,yr=Pt.gb;if(e(q!=null),e(Lr!=null),e(yr!=null),yr[0]=0,12<=Lr[0]&&!r(q,hr[0],"RIFF")){if(r(q,hr[0]+8,"WEBP")){yr=3;break e}var Br=at(q,hr[0]+4);if(12>Br||4294967286<Br){yr=3;break e}if(St&&Br>Lr[0]-8){yr=7;break e}yr[0]=Br,hr[0]+=12,Lr[0]-=12}yr=0}if(yr!=0)return yr;for(Br=0<Pt.gb[0],ge=ge[0];;){e:{var jr=q;Lr=K,yr=ge;var sn=At,Jr=Yt,Jn=hr=[0];if((Zn=br=[br])[0]=0,8>yr[0])yr=7;else{if(!r(jr,Lr[0],"VP8X")){if(at(jr,Lr[0]+4)!=10){yr=3;break e}if(18>yr[0]){yr=7;break e}var Vn=at(jr,Lr[0]+8),Ai=1+Ot(jr,Lr[0]+12);if(2147483648<=Ai*(jr=1+Ot(jr,Lr[0]+15))){yr=3;break e}Jn!=null&&(Jn[0]=Vn),sn!=null&&(sn[0]=Ai),Jr!=null&&(Jr[0]=jr),Lr[0]+=18,yr[0]-=18,Zn[0]=1}yr=0}}if(br=br[0],hr=hr[0],yr!=0)return yr;if(Lr=!!(2&hr),!Br&&br)return 3;if(Je!=null&&(Je[0]=!!(16&hr)),nt!=null&&(nt[0]=Lr),lt!=null&&(lt[0]=0),nt=At[0],hr=Yt[0],br&&Lr&&yt==null){yr=0;break}if(4>ge){yr=7;break}if(Br&&br||!Br&&!br&&!r(q,K[0],"ALPH")){ge=[ge],Pt.na=[Pt.na],Pt.P=[Pt.P],Pt.Sa=[Pt.Sa];e:{Vn=q,yr=K,Br=ge;var Zn=Pt.gb;sn=Pt.na,Jr=Pt.P,Jn=Pt.Sa,Ai=22,e(Vn!=null),e(Br!=null),jr=yr[0];var Yi=Br[0];for(e(sn!=null),e(Jn!=null),sn[0]=null,Jr[0]=null,Jn[0]=0;;){if(yr[0]=jr,Br[0]=Yi,8>Yi){yr=7;break e}var No=at(Vn,jr+4);if(4294967286<No){yr=3;break e}var Ni=8+No+1&-2;if(Ai+=Ni,0<Zn&&Ai>Zn){yr=3;break e}if(!r(Vn,jr,"VP8 ")||!r(Vn,jr,"VP8L")){yr=0;break e}if(Yi[0]<Ni){yr=7;break e}r(Vn,jr,"ALPH")||(sn[0]=Vn,Jr[0]=jr+8,Jn[0]=No),jr+=Ni,Yi-=Ni}}if(ge=ge[0],Pt.na=Pt.na[0],Pt.P=Pt.P[0],Pt.Sa=Pt.Sa[0],yr!=0)break}ge=[ge],Pt.Ja=[Pt.Ja],Pt.xa=[Pt.xa];e:if(Zn=q,yr=K,Br=ge,sn=Pt.gb[0],Jr=Pt.Ja,Jn=Pt.xa,Vn=yr[0],jr=!r(Zn,Vn,"VP8 "),Ai=!r(Zn,Vn,"VP8L"),e(Zn!=null),e(Br!=null),e(Jr!=null),e(Jn!=null),8>Br[0])yr=7;else{if(jr||Ai){if(Zn=at(Zn,Vn+4),12<=sn&&Zn>sn-12){yr=3;break e}if(St&&Zn>Br[0]-8){yr=7;break e}Jr[0]=Zn,yr[0]+=8,Br[0]-=8,Jn[0]=Ai}else Jn[0]=5<=Br[0]&&Zn[Vn+0]==47&&!(Zn[Vn+4]>>5),Jr[0]=Br[0];yr=0}if(ge=ge[0],Pt.Ja=Pt.Ja[0],Pt.xa=Pt.xa[0],K=K[0],yr!=0)break;if(4294967286<Pt.Ja)return 3;if(lt==null||Lr||(lt[0]=Pt.xa?2:1),nt=[nt],hr=[hr],Pt.xa){if(5>ge){yr=7;break}lt=nt,St=hr,Lr=Je,q==null||5>ge?q=0:5<=ge&&q[K+0]==47&&!(q[K+4]>>5)?(Br=[0],Zn=[0],sn=[0],Te(Jr=new Se,q,K,ge),Re(Jr,Br,Zn,sn)?(lt!=null&&(lt[0]=Br[0]),St!=null&&(St[0]=Zn[0]),Lr!=null&&(Lr[0]=sn[0]),q=1):q=0):q=0}else{if(10>ge){yr=7;break}lt=hr,q==null||10>ge||!_a(q,K+3,ge-3)?q=0:(St=q[K+0]|q[K+1]<<8|q[K+2]<<16,Lr=16383&(q[K+7]<<8|q[K+6]),q=16383&(q[K+9]<<8|q[K+8]),1&St||3<(St>>1&7)||!(St>>4&1)||St>>5>=Pt.Ja||!Lr||!q?q=0:(nt&&(nt[0]=Lr),lt&&(lt[0]=q),q=1))}if(!q||(nt=nt[0],hr=hr[0],br&&(At[0]!=nt||Yt[0]!=hr)))return 3;yt!=null&&(yt[0]=Pt,yt.offset=K-yt.w,e(4294967286>K-yt.w),e(yt.offset==yt.ha-ge));break}return yr==0||yr==7&&br&&yt==null?(Je!=null&&(Je[0]|=Pt.na!=null&&0<Pt.na.length),ke!=null&&(ke[0]=nt),Ye!=null&&(Ye[0]=hr),0):yr}function Oo(q,K,ge){var ke=K.width,Ye=K.height,Je=0,nt=0,lt=ke,yt=Ye;if(K.Da=q!=null&&0<q.Da,K.Da&&(lt=q.cd,yt=q.bd,Je=q.v,nt=q.j,11>ge||(Je&=-2,nt&=-2),0>Je||0>nt||0>=lt||0>=yt||Je+lt>ke||nt+yt>Ye))return 0;if(K.v=Je,K.j=nt,K.va=Je+lt,K.o=nt+yt,K.U=lt,K.T=yt,K.da=q!=null&&0<q.da,K.da){if(!cr(lt,yt,ge=[q.ib],Je=[q.hb]))return 0;K.ib=ge[0],K.hb=Je[0]}return K.ob=q!=null&&q.ob,K.Kb=q==null||!q.Sd,K.da&&(K.ob=K.ib<3*ke/4&&K.hb<3*Ye/4,K.Kb=0),1}function mo(q){if(q==null)return 2;if(11>q.S){var K=q.f.RGBA;K.fb+=(q.height-1)*K.A,K.A=-K.A}else K=q.f.kb,q=q.height,K.O+=(q-1)*K.fa,K.fa=-K.fa,K.N+=(q-1>>1)*K.Ab,K.Ab=-K.Ab,K.W+=(q-1>>1)*K.Db,K.Db=-K.Db,K.F!=null&&(K.J+=(q-1)*K.lb,K.lb=-K.lb);return 0}function Du(q,K,ge,ke){if(ke==null||0>=q||0>=K)return 2;if(ge!=null){if(ge.Da){var Ye=ge.cd,Je=ge.bd,nt=-2&ge.v,lt=-2&ge.j;if(0>nt||0>lt||0>=Ye||0>=Je||nt+Ye>q||lt+Je>K)return 2;q=Ye,K=Je}if(ge.da){if(!cr(q,K,Ye=[ge.ib],Je=[ge.hb]))return 2;q=Ye[0],K=Je[0]}}ke.width=q,ke.height=K;e:{var yt=ke.width,At=ke.height;if(q=ke.S,0>=yt||0>=At||!(q>=Nu&&13>q))q=2;else{if(0>=ke.Rd&&ke.sd==null){nt=Je=Ye=K=0;var Yt=(lt=yt*Bu[q])*At;if(11>q||(Je=(At+1)/2*(K=(yt+1)/2),q==12&&(nt=(Ye=yt)*At)),(At=a(Yt+2*Je+nt))==null){q=1;break e}ke.sd=At,11>q?((yt=ke.f.RGBA).eb=At,yt.fb=0,yt.A=lt,yt.size=Yt):((yt=ke.f.kb).y=At,yt.O=0,yt.fa=lt,yt.Fd=Yt,yt.f=At,yt.N=0+Yt,yt.Ab=K,yt.Cd=Je,yt.ea=At,yt.W=0+Yt+Je,yt.Db=K,yt.Ed=Je,q==12&&(yt.F=At,yt.J=0+Yt+2*Je),yt.Tc=nt,yt.lb=Ye)}if(K=1,Ye=ke.S,Je=ke.width,nt=ke.height,Ye>=Nu&&13>Ye)if(11>Ye)q=ke.f.RGBA,K&=(lt=Math.abs(q.A))*(nt-1)+Je<=q.size,K&=lt>=Je*Bu[Ye],K&=q.eb!=null;else{q=ke.f.kb,lt=(Je+1)/2,Yt=(nt+1)/2,yt=Math.abs(q.fa),At=Math.abs(q.Ab);var br=Math.abs(q.Db),St=Math.abs(q.lb),Pt=St*(nt-1)+Je;K&=yt*(nt-1)+Je<=q.Fd,K&=At*(Yt-1)+lt<=q.Cd,K=(K&=br*(Yt-1)+lt<=q.Ed)&yt>=Je&At>=lt&br>=lt,K&=q.y!=null,K&=q.f!=null,K&=q.ea!=null,Ye==12&&(K&=St>=Je,K&=Pt<=q.Tc,K&=q.F!=null)}else K=0;q=K?0:2}}return q!=0||ge!=null&&ge.fd&&(q=mo(ke)),q}var Ua=64,fu=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535,131071,262143,524287,1048575,2097151,4194303,8388607,16777215],Zs=24,ms=32,Va=8,Vl=[0,0,1,1,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7];mr("Predictor0","PredictorAdd0"),X.Predictor0=function(){return 4278190080},X.Predictor1=function(q){return q},X.Predictor2=function(q,K,ge){return K[ge+0]},X.Predictor3=function(q,K,ge){return K[ge+1]},X.Predictor4=function(q,K,ge){return K[ge-1]},X.Predictor5=function(q,K,ge){return Cr(Cr(q,K[ge+1]),K[ge+0])},X.Predictor6=function(q,K,ge){return Cr(q,K[ge-1])},X.Predictor7=function(q,K,ge){return Cr(q,K[ge+0])},X.Predictor8=function(q,K,ge){return Cr(K[ge-1],K[ge+0])},X.Predictor9=function(q,K,ge){return Cr(K[ge+0],K[ge+1])},X.Predictor10=function(q,K,ge){return Cr(Cr(q,K[ge-1]),Cr(K[ge+0],K[ge+1]))},X.Predictor11=function(q,K,ge){var ke=K[ge+0];return 0>=ot(ke>>24&255,q>>24&255,(K=K[ge-1])>>24&255)+ot(ke>>16&255,q>>16&255,K>>16&255)+ot(ke>>8&255,q>>8&255,K>>8&255)+ot(255&ke,255&q,255&K)?ke:q},X.Predictor12=function(q,K,ge){var ke=K[ge+0];return(Er((q>>24&255)+(ke>>24&255)-((K=K[ge-1])>>24&255))<<24|Er((q>>16&255)+(ke>>16&255)-(K>>16&255))<<16|Er((q>>8&255)+(ke>>8&255)-(K>>8&255))<<8|Er((255&q)+(255&ke)-(255&K)))>>>0},X.Predictor13=function(q,K,ge){var ke=K[ge-1];return(Jt((q=Cr(q,K[ge+0]))>>24&255,ke>>24&255)<<24|Jt(q>>16&255,ke>>16&255)<<16|Jt(q>>8&255,ke>>8&255)<<8|Jt(255&q,255&ke))>>>0};var cl=X.PredictorAdd0;X.PredictorAdd1=Ce,mr("Predictor2","PredictorAdd2"),mr("Predictor3","PredictorAdd3"),mr("Predictor4","PredictorAdd4"),mr("Predictor5","PredictorAdd5"),mr("Predictor6","PredictorAdd6"),mr("Predictor7","PredictorAdd7"),mr("Predictor8","PredictorAdd8"),mr("Predictor9","PredictorAdd9"),mr("Predictor10","PredictorAdd10"),mr("Predictor11","PredictorAdd11"),mr("Predictor12","PredictorAdd12"),mr("Predictor13","PredictorAdd13");var fl=X.PredictorAdd2;Ge("ColorIndexInverseTransform","MapARGB","32b",function(q){return q>>8&255},function(q){return q}),Ge("VP8LColorIndexInverseTransformAlpha","MapAlpha","8b",function(q){return q},function(q){return q>>8&255});var $l,ql=X.ColorIndexInverseTransform,hl=X.MapARGB,Hl=X.VP8LColorIndexInverseTransformAlpha,Ou=X.MapAlpha,tr=X.VP8LPredictorsAdd=[];tr.length=16,(X.VP8LPredictors=[]).length=16,(X.VP8LPredictorsAdd_C=[]).length=16,(X.VP8LPredictors_C=[]).length=16;var vr,dn,In,vi,Pn,I,y,_,P,$,ne,me,Oe,tt,ft,rr,ur,qr,bn,Dn,Xn,Fn,En,na,ca,so,ka,Ho,Ks=a(511),Pl=a(2041),hu=a(225),du=a(767),Ps=0,Gl=Pl,Wl=hu,Eo=du,ni=Ks,Nu=0,th=1,bf=2,pu=3,Op=4,Vg=5,$g=6,qg=7,Od=8,qc=9,rh=10,Np=[2,3,7],Hg=[3,3,11],Lp=[280,256,256,256,40],Fp=[0,1,1,1,0],Bp=[17,18,0,1,2,3,4,5,16,6,7,8,9,10,11,12,13,14,15],xf=[24,7,23,25,40,6,39,41,22,26,38,42,56,5,55,57,21,27,54,58,37,43,72,4,71,73,20,28,53,59,70,74,36,44,88,69,75,52,60,3,87,89,19,29,86,90,35,45,68,76,85,91,51,61,104,2,103,105,18,30,102,106,34,46,84,92,67,77,101,107,50,62,120,1,119,121,83,93,17,31,100,108,66,78,118,122,33,47,117,123,49,63,99,109,82,94,0,116,124,65,79,16,32,98,110,48,115,125,81,95,64,114,126,97,111,80,113,127,96,112],nh=[2954,2956,2958,2962,2970,2986,3018,3082,3212,3468,3980,5004],Gg=8,Wg=[4,5,6,7,8,9,10,10,11,12,13,14,15,16,17,17,18,19,20,20,21,21,22,22,23,23,24,25,25,26,27,28,29,30,31,32,33,34,35,36,37,37,38,39,40,41,42,43,44,45,46,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,76,77,78,79,80,81,82,83,84,85,86,87,88,89,91,93,95,96,98,100,101,102,104,106,108,110,112,114,116,118,122,124,126,128,130,132,134,136,138,140,143,145,148,151,154,157],ih=[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,60,62,64,66,68,70,72,74,76,78,80,82,84,86,88,90,92,94,96,98,100,102,104,106,108,110,112,114,116,119,122,125,128,131,134,137,140,143,146,149,152,155,158,161,164,167,170,173,177,181,185,189,193,197,201,205,209,213,217,221,225,229,234,239,245,249,254,259,264,269,274,279,284],Nd=null,Ly=[[173,148,140,0],[176,155,140,135,0],[180,157,141,134,130,0],[254,254,243,230,196,177,153,140,133,130,129,0]],Ld=[0,1,4,8,5,2,3,6,9,12,13,10,7,11,14,15],Fd=[-0,1,-1,2,-2,3,4,6,-3,5,-4,-5,-6,7,-7,8,-8,-9],Fy=[[[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]],[[253,136,254,255,228,219,128,128,128,128,128],[189,129,242,255,227,213,255,219,128,128,128],[106,126,227,252,214,209,255,255,128,128,128]],[[1,98,248,255,236,226,255,255,128,128,128],[181,133,238,254,221,234,255,154,128,128,128],[78,134,202,247,198,180,255,219,128,128,128]],[[1,185,249,255,243,255,128,128,128,128,128],[184,150,247,255,236,224,128,128,128,128,128],[77,110,216,255,236,230,128,128,128,128,128]],[[1,101,251,255,241,255,128,128,128,128,128],[170,139,241,252,236,209,255,255,128,128,128],[37,116,196,243,228,255,255,255,128,128,128]],[[1,204,254,255,245,255,128,128,128,128,128],[207,160,250,255,238,128,128,128,128,128,128],[102,103,231,255,211,171,128,128,128,128,128]],[[1,152,252,255,240,255,128,128,128,128,128],[177,135,243,255,234,225,128,128,128,128,128],[80,129,211,255,194,224,128,128,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[246,1,255,128,128,128,128,128,128,128,128],[255,128,128,128,128,128,128,128,128,128,128]]],[[[198,35,237,223,193,187,162,160,145,155,62],[131,45,198,221,172,176,220,157,252,221,1],[68,47,146,208,149,167,221,162,255,223,128]],[[1,149,241,255,221,224,255,255,128,128,128],[184,141,234,253,222,220,255,199,128,128,128],[81,99,181,242,176,190,249,202,255,255,128]],[[1,129,232,253,214,197,242,196,255,255,128],[99,121,210,250,201,198,255,202,128,128,128],[23,91,163,242,170,187,247,210,255,255,128]],[[1,200,246,255,234,255,128,128,128,128,128],[109,178,241,255,231,245,255,255,128,128,128],[44,130,201,253,205,192,255,255,128,128,128]],[[1,132,239,251,219,209,255,165,128,128,128],[94,136,225,251,218,190,255,255,128,128,128],[22,100,174,245,186,161,255,199,128,128,128]],[[1,182,249,255,232,235,128,128,128,128,128],[124,143,241,255,227,234,128,128,128,128,128],[35,77,181,251,193,211,255,205,128,128,128]],[[1,157,247,255,236,231,255,255,128,128,128],[121,141,235,255,225,227,255,255,128,128,128],[45,99,188,251,195,217,255,224,128,128,128]],[[1,1,251,255,213,255,128,128,128,128,128],[203,1,248,255,255,128,128,128,128,128,128],[137,1,177,255,224,255,128,128,128,128,128]]],[[[253,9,248,251,207,208,255,192,128,128,128],[175,13,224,243,193,185,249,198,255,255,128],[73,17,171,221,161,179,236,167,255,234,128]],[[1,95,247,253,212,183,255,255,128,128,128],[239,90,244,250,211,209,255,255,128,128,128],[155,77,195,248,188,195,255,255,128,128,128]],[[1,24,239,251,218,219,255,205,128,128,128],[201,51,219,255,196,186,128,128,128,128,128],[69,46,190,239,201,218,255,228,128,128,128]],[[1,191,251,255,255,128,128,128,128,128,128],[223,165,249,255,213,255,128,128,128,128,128],[141,124,248,255,255,128,128,128,128,128,128]],[[1,16,248,255,255,128,128,128,128,128,128],[190,36,230,255,236,255,128,128,128,128,128],[149,1,255,128,128,128,128,128,128,128,128]],[[1,226,255,128,128,128,128,128,128,128,128],[247,192,255,128,128,128,128,128,128,128,128],[240,128,255,128,128,128,128,128,128,128,128]],[[1,134,252,255,255,128,128,128,128,128,128],[213,62,250,255,255,128,128,128,128,128,128],[55,93,255,128,128,128,128,128,128,128,128]],[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]]],[[[202,24,213,235,186,191,220,160,240,175,255],[126,38,182,232,169,184,228,174,255,187,128],[61,46,138,219,151,178,240,170,255,216,128]],[[1,112,230,250,199,191,247,159,255,255,128],[166,109,228,252,211,215,255,174,128,128,128],[39,77,162,232,172,180,245,178,255,255,128]],[[1,52,220,246,198,199,249,220,255,255,128],[124,74,191,243,183,193,250,221,255,255,128],[24,71,130,219,154,170,243,182,255,255,128]],[[1,182,225,249,219,240,255,224,128,128,128],[149,150,226,252,216,205,255,171,128,128,128],[28,108,170,242,183,194,254,223,255,255,128]],[[1,81,230,252,204,203,255,192,128,128,128],[123,102,209,247,188,196,255,233,128,128,128],[20,95,153,243,164,173,255,203,128,128,128]],[[1,222,248,255,216,213,128,128,128,128,128],[168,175,246,252,235,205,255,255,128,128,128],[47,116,215,255,211,212,255,255,128,128,128]],[[1,121,236,253,212,214,255,255,128,128,128],[141,84,213,252,201,202,255,219,128,128,128],[42,80,160,240,162,185,255,205,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[244,1,255,128,128,128,128,128,128,128,128],[238,1,255,128,128,128,128,128,128,128,128]]]],By=[[[231,120,48,89,115,113,120,152,112],[152,179,64,126,170,118,46,70,95],[175,69,143,80,85,82,72,155,103],[56,58,10,171,218,189,17,13,152],[114,26,17,163,44,195,21,10,173],[121,24,80,195,26,62,44,64,85],[144,71,10,38,171,213,144,34,26],[170,46,55,19,136,160,33,206,71],[63,20,8,114,114,208,12,9,226],[81,40,11,96,182,84,29,16,36]],[[134,183,89,137,98,101,106,165,148],[72,187,100,130,157,111,32,75,80],[66,102,167,99,74,62,40,234,128],[41,53,9,178,241,141,26,8,107],[74,43,26,146,73,166,49,23,157],[65,38,105,160,51,52,31,115,128],[104,79,12,27,217,255,87,17,7],[87,68,71,44,114,51,15,186,23],[47,41,14,110,182,183,21,17,194],[66,45,25,102,197,189,23,18,22]],[[88,88,147,150,42,46,45,196,205],[43,97,183,117,85,38,35,179,61],[39,53,200,87,26,21,43,232,171],[56,34,51,104,114,102,29,93,77],[39,28,85,171,58,165,90,98,64],[34,22,116,206,23,34,43,166,73],[107,54,32,26,51,1,81,43,31],[68,25,106,22,64,171,36,225,114],[34,19,21,102,132,188,16,76,124],[62,18,78,95,85,57,50,48,51]],[[193,101,35,159,215,111,89,46,111],[60,148,31,172,219,228,21,18,111],[112,113,77,85,179,255,38,120,114],[40,42,1,196,245,209,10,25,109],[88,43,29,140,166,213,37,43,154],[61,63,30,155,67,45,68,1,209],[100,80,8,43,154,1,51,26,71],[142,78,78,16,255,128,34,197,171],[41,40,5,102,211,183,4,1,221],[51,50,17,168,209,192,23,25,82]],[[138,31,36,171,27,166,38,44,229],[67,87,58,169,82,115,26,59,179],[63,59,90,180,59,166,93,73,154],[40,40,21,116,143,209,34,39,175],[47,15,16,183,34,223,49,45,183],[46,17,33,183,6,98,15,32,183],[57,46,22,24,128,1,54,17,37],[65,32,73,115,28,128,23,128,205],[40,3,9,115,51,192,18,6,223],[87,37,9,115,59,77,64,21,47]],[[104,55,44,218,9,54,53,130,226],[64,90,70,205,40,41,23,26,57],[54,57,112,184,5,41,38,166,213],[30,34,26,133,152,116,10,32,134],[39,19,53,221,26,114,32,73,255],[31,9,65,234,2,15,1,118,73],[75,32,12,51,192,255,160,43,51],[88,31,35,67,102,85,55,186,85],[56,21,23,111,59,205,45,37,192],[55,38,70,124,73,102,1,34,98]],[[125,98,42,88,104,85,117,175,82],[95,84,53,89,128,100,113,101,45],[75,79,123,47,51,128,81,171,1],[57,17,5,71,102,57,53,41,49],[38,33,13,121,57,73,26,1,85],[41,10,67,138,77,110,90,47,114],[115,21,2,10,102,255,166,23,6],[101,29,16,10,85,128,101,196,26],[57,18,10,102,102,213,34,20,43],[117,20,15,36,163,128,68,1,26]],[[102,61,71,37,34,53,31,243,192],[69,60,71,38,73,119,28,222,37],[68,45,128,34,1,47,11,245,171],[62,17,19,70,146,85,55,62,70],[37,43,37,154,100,163,85,160,1],[63,9,92,136,28,64,32,201,85],[75,15,9,9,64,255,184,119,16],[86,6,28,5,64,255,25,248,1],[56,8,17,132,137,255,55,116,128],[58,15,20,82,135,57,26,121,40]],[[164,50,31,137,154,133,25,35,218],[51,103,44,131,131,123,31,6,158],[86,40,64,135,148,224,45,183,128],[22,26,17,131,240,154,14,1,209],[45,16,21,91,64,222,7,1,197],[56,21,39,155,60,138,23,102,213],[83,12,13,54,192,255,68,47,28],[85,26,85,85,128,128,32,146,171],[18,11,7,63,144,171,4,4,246],[35,27,10,146,174,171,12,26,128]],[[190,80,35,99,180,80,126,54,45],[85,126,47,87,176,51,41,20,32],[101,75,128,139,118,146,116,128,85],[56,41,15,176,236,85,37,9,62],[71,30,17,119,118,255,17,18,138],[101,38,60,138,55,70,43,26,142],[146,36,19,30,171,255,97,27,20],[138,45,61,62,219,1,81,188,64],[32,41,20,117,151,142,20,21,163],[112,19,12,61,195,128,48,4,24]]],Bd=[[[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[176,246,255,255,255,255,255,255,255,255,255],[223,241,252,255,255,255,255,255,255,255,255],[249,253,253,255,255,255,255,255,255,255,255]],[[255,244,252,255,255,255,255,255,255,255,255],[234,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255]],[[255,246,254,255,255,255,255,255,255,255,255],[239,253,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[251,255,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[251,254,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,254,253,255,254,255,255,255,255,255,255],[250,255,254,255,254,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[217,255,255,255,255,255,255,255,255,255,255],[225,252,241,253,255,255,254,255,255,255,255],[234,250,241,250,253,255,253,254,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[223,254,254,255,255,255,255,255,255,255,255],[238,253,254,254,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[249,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,255,255,255,255,255,255,255,255,255],[247,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[252,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[186,251,250,255,255,255,255,255,255,255,255],[234,251,244,254,255,255,255,255,255,255,255],[251,251,243,253,254,255,254,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[236,253,254,255,255,255,255,255,255,255,255],[251,253,253,254,254,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[254,254,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[254,254,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[248,255,255,255,255,255,255,255,255,255,255],[250,254,252,254,255,255,255,255,255,255,255],[248,254,249,253,255,255,255,255,255,255,255]],[[255,253,253,255,255,255,255,255,255,255,255],[246,253,253,255,255,255,255,255,255,255,255],[252,254,251,254,254,255,255,255,255,255,255]],[[255,254,252,255,255,255,255,255,255,255,255],[248,254,253,255,255,255,255,255,255,255,255],[253,255,254,254,255,255,255,255,255,255,255]],[[255,251,254,255,255,255,255,255,255,255,255],[245,251,254,255,255,255,255,255,255,255,255],[253,253,254,255,255,255,255,255,255,255,255]],[[255,251,253,255,255,255,255,255,255,255,255],[252,253,254,255,255,255,255,255,255,255,255],[255,254,255,255,255,255,255,255,255,255,255]],[[255,252,255,255,255,255,255,255,255,255,255],[249,255,254,255,255,255,255,255,255,255,255],[255,255,254,255,255,255,255,255,255,255,255]],[[255,255,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]]],zp=[0,1,2,3,6,4,5,6,6,6,6,6,6,6,6,7,0],Hc=[],Lu=[],xa=[],ah=1,Xl=2,ac=[],dl=[];Pa("UpsampleRgbLinePair",Da,3),Pa("UpsampleBgrLinePair",ns,3),Pa("UpsampleRgbaLinePair",Ys,4),Pa("UpsampleBgraLinePair",uu,4),Pa("UpsampleArgbLinePair",rc,4),Pa("UpsampleRgba4444LinePair",Ja,2),Pa("UpsampleRgb565LinePair",As,2);var jp=X.UpsampleRgbLinePair,wf=X.UpsampleBgrLinePair,zh=X.UpsampleRgbaLinePair,Sf=X.UpsampleBgraLinePair,oh=X.UpsampleArgbLinePair,Xg=X.UpsampleRgba4444LinePair,zy=X.UpsampleRgb565LinePair,zd=16,jd=1<<zd-1,jh=-227,Sc=482,Yg=6,Up=0,Ud=a(256),jy=a(256),Zg=a(256),Kg=a(256),Uy=a(Sc-jh),Jg=a(Sc-jh);Is("YuvToRgbRow",Da,3),Is("YuvToBgrRow",ns,3),Is("YuvToRgbaRow",Ys,4),Is("YuvToBgraRow",uu,4),Is("YuvToArgbRow",rc,4),Is("YuvToRgba4444Row",Ja,2),Is("YuvToRgb565Row",As,2);var Vp=[0,4,8,12,128,132,136,140,256,260,264,268,384,388,392,396],oc=[0,2,8],Vy=[8,7,6,4,4,2,2,2,1,1,1,1],Fu=1;this.WebPDecodeRGBA=function(q,K,ge,ke,Ye){var Je=th,nt=new qn,lt=new zr;nt.ba=lt,lt.S=Je,lt.width=[lt.width],lt.height=[lt.height];var yt=lt.width,At=lt.height,Yt=new Mt;if(Yt==null||q==null)var br=2;else e(Yt!=null),br=cu(q,K,ge,Yt.width,Yt.height,Yt.Pd,Yt.Qd,Yt.format,null);if(br!=0?yt=0:(yt!=null&&(yt[0]=Yt.width[0]),At!=null&&(At[0]=Yt.height[0]),yt=1),yt){lt.width=lt.width[0],lt.height=lt.height[0],ke!=null&&(ke[0]=lt.width),Ye!=null&&(Ye[0]=lt.height);e:{if(ke=new ps,(Ye=new Un).data=q,Ye.w=K,Ye.ha=ge,Ye.kd=1,K=[0],e(Ye!=null),((q=cu(Ye.data,Ye.w,Ye.ha,null,null,null,K,null,Ye))==0||q==7)&&K[0]&&(q=4),(K=q)==0){if(e(nt!=null),ke.data=Ye.data,ke.w=Ye.w+Ye.offset,ke.ha=Ye.ha-Ye.offset,ke.put=un,ke.ac=oi,ke.bc=Kn,ke.ma=nt,Ye.xa){if((q=ua())==null){nt=1;break e}if((function(St,Pt){var hr=[0],Lr=[0],yr=[0];t:for(;;){if(St==null)return 0;if(Pt==null)return St.a=2,0;if(St.l=Pt,St.a=0,Te(St.m,Pt.data,Pt.w,Pt.ha),!Re(St.m,hr,Lr,yr)){St.a=3;break t}if(St.xb=Xl,Pt.width=hr[0],Pt.height=Lr[0],!ha(hr[0],Lr[0],1,St,null))break t;return 1}return e(St.a!=0),0})(q,ke)){if(ke=(K=Du(ke.width,ke.height,nt.Oa,nt.ba))==0){t:{ke=q;r:for(;;){if(ke==null){ke=0;break t}if(e(ke.s.yc!=null),e(ke.s.Ya!=null),e(0<ke.s.Wb),e((ge=ke.l)!=null),e((Ye=ge.ma)!=null),ke.xb!=0){if(ke.ca=Ye.ba,ke.tb=Ye.tb,e(ke.ca!=null),!Oo(Ye.Oa,ge,pu)){ke.a=2;break r}if(!zn(ke,ge.width)||ge.da)break r;if((ge.da||Ar(ke.ca.S))&&Ws(),11>ke.ca.S||(alert("todo:WebPInitConvertARGBToYUV"),ke.ca.f.kb.F!=null&&Ws()),ke.Pb&&0<ke.s.ua&&ke.s.vb.X==null&&!$e(ke.s.vb,ke.s.Wa.Xa)){ke.a=1;break r}ke.xb=0}if(!Bn(ke,ke.V,ke.Ba,ke.c,ke.i,ge.o,Bi))break r;Ye.Dc=ke.Ma,ke=1;break t}e(ke.a!=0),ke=0}ke=!ke}ke&&(K=q.a)}else K=q.a}else{if((q=new Ul)==null){nt=1;break e}if(q.Fa=Ye.na,q.P=Ye.P,q.qc=Ye.Sa,wc(q,ke)){if((K=Du(ke.width,ke.height,nt.Oa,nt.ba))==0){if(q.Aa=0,ge=nt.Oa,e((Ye=q)!=null),ge!=null){if(0<(yt=0>(yt=ge.Md)?0:100<yt?255:255*yt/100)){for(At=Yt=0;4>At;++At)12>(br=Ye.pb[At]).lc&&(br.ia=yt*Vy[0>br.lc?0:br.lc]>>3),Yt|=br.ia;Yt&&(alert("todo:VP8InitRandom"),Ye.ia=1)}Ye.Ga=ge.Id,100<Ye.Ga?Ye.Ga=100:0>Ye.Ga&&(Ye.Ga=0)}(function(St,Pt){if(St==null)return 0;if(Pt==null)return Fa(St,2,"NULL VP8Io parameter in VP8Decode().");if(!St.cb&&!wc(St,Pt))return 0;if(e(St.cb),Pt.ac==null||Pt.ac(Pt)){Pt.ob&&(St.L=0);var hr=oc[St.L];if(St.L==2?(St.yb=0,St.zb=0):(St.yb=Pt.v-hr>>4,St.zb=Pt.j-hr>>4,0>St.yb&&(St.yb=0),0>St.zb&&(St.zb=0)),St.Va=Pt.o+15+hr>>4,St.Hb=Pt.va+15+hr>>4,St.Hb>St.za&&(St.Hb=St.za),St.Va>St.Ub&&(St.Va=St.Ub),0<St.L){var Lr=St.ed;for(hr=0;4>hr;++hr){var yr;if(St.Qa.Cb){var Br=St.Qa.Lb[hr];St.Qa.Fb||(Br+=Lr.Tb)}else Br=Lr.Tb;for(yr=0;1>=yr;++yr){var jr=St.gd[hr][yr],sn=Br;if(Lr.Pc&&(sn+=Lr.vd[0],yr&&(sn+=Lr.od[0])),0<(sn=0>sn?0:63<sn?63:sn)){var Jr=sn;0<Lr.wb&&(Jr=4<Lr.wb?Jr>>2:Jr>>1)>9-Lr.wb&&(Jr=9-Lr.wb),1>Jr&&(Jr=1),jr.dd=Jr,jr.tc=2*sn+Jr,jr.ld=40<=sn?2:15<=sn?1:0}else jr.tc=0;jr.La=yr}}}hr=0}else Fa(St,6,"Frame setup failed"),hr=St.a;if(hr=hr==0){if(hr){St.$c=0,0<St.Aa||(St.Ic=Fu);t:{hr=St.Ic,Lr=4*(Jr=St.za);var Jn=32*Jr,Vn=Jr+1,Ai=0<St.L?Jr*(0<St.Aa?2:1):0,Zn=(St.Aa==2?2:1)*Jr;if((jr=Lr+832+(yr=3*(16*hr+oc[St.L])/2*Jn)+(Br=St.Fa!=null&&0<St.Fa.length?St.Kc.c*St.Kc.i:0))!=jr)hr=0;else{if(jr>St.Vb){if(St.Vb=0,St.Ec=a(jr),St.Fc=0,St.Ec==null){hr=Fa(St,1,"no memory during frame initialization.");break t}St.Vb=jr}jr=St.Ec,sn=St.Fc,St.Ac=jr,St.Bc=sn,sn+=Lr,St.Gd=s(Jn,ds),St.Hd=0,St.rb=s(Vn+1,zi),St.sb=1,St.wa=Ai?s(Ai,xi):null,St.Y=0,St.D.Nb=0,St.D.wa=St.wa,St.D.Y=St.Y,0<St.Aa&&(St.D.Y+=Jr),e(!0),St.oc=jr,St.pc=sn,sn+=832,St.ya=s(Zn,ga),St.aa=0,St.D.ya=St.ya,St.D.aa=St.aa,St.Aa==2&&(St.D.aa+=Jr),St.R=16*Jr,St.B=8*Jr,Jr=(Jn=oc[St.L])*St.R,Jn=Jn/2*St.B,St.sa=jr,St.ta=sn+Jr,St.qa=St.sa,St.ra=St.ta+16*hr*St.R+Jn,St.Ha=St.qa,St.Ia=St.ra+8*hr*St.B+Jn,St.$c=0,sn+=yr,St.mb=Br?jr:null,St.nb=Br?sn:null,e(sn+Br<=St.Fc+St.Vb),ts(St),i(St.Ac,St.Bc,0,Lr),hr=1}}if(hr){if(Pt.ka=0,Pt.y=St.sa,Pt.O=St.ta,Pt.f=St.qa,Pt.N=St.ra,Pt.ea=St.Ha,Pt.Vd=St.Ia,Pt.fa=St.R,Pt.Rc=St.B,Pt.F=null,Pt.J=0,!Ps){for(hr=-255;255>=hr;++hr)Ks[255+hr]=0>hr?-hr:hr;for(hr=-1020;1020>=hr;++hr)Pl[1020+hr]=-128>hr?-128:127<hr?127:hr;for(hr=-112;112>=hr;++hr)hu[112+hr]=-16>hr?-16:15<hr?15:hr;for(hr=-255;510>=hr;++hr)du[255+hr]=0>hr?0:255<hr?255:hr;Ps=1}y=It,_=Pu,$=ee,ne=pe,me=Ke,P=$c,Oe=ue,tt=We,ft=lr,rr=Nr,ur=bt,qr=zt,bn=Zr,Dn=Ln,Xn=ji,Fn=qs,En=ii,na=ri,Lu[0]=mn,Lu[1]=qt,Lu[2]=Mr,Lu[3]=hn,Lu[4]=fi,Lu[5]=ba,Lu[6]=$i,Lu[7]=wi,Lu[8]=Ts,Lu[9]=hi,Hc[0]=kr,Hc[1]=Yr,Hc[2]=tn,Hc[3]=Gr,Hc[4]=ti,Hc[5]=Ri,Hc[6]=$n,xa[0]=oa,xa[1]=er,xa[2]=Vs,xa[3]=Mi,xa[4]=Ka,xa[5]=ku,xa[6]=$s,hr=1}else hr=0}hr&&(hr=(function(Yi,No){for(Yi.M=0;Yi.M<Yi.Va;++Yi.M){var Ni,Yn=Yi.Jc[Yi.M&Yi.Xb],wn=Yi.m,To=Yi;for(Ni=0;Ni<To.za;++Ni){var Pi=wn,aa=To,da=aa.Ac,ki=aa.Bc+4*Ni,kl=aa.zc,Qa=aa.ya[aa.aa+Ni];if(aa.Qa.Bb?Qa.$b=Qe(Pi,aa.Pa.jb[0])?2+Qe(Pi,aa.Pa.jb[2]):Qe(Pi,aa.Pa.jb[1]):Qa.$b=0,aa.kc&&(Qa.Ad=Qe(Pi,aa.Bd)),Qa.Za=!Qe(Pi,145)+0,Qa.Za){var ys=Qa.Ob,ks=0;for(aa=0;4>aa;++aa){var Go,sa=kl[0+aa];for(Go=0;4>Go;++Go){sa=By[da[ki+Go]][sa];for(var wa=Fd[Qe(Pi,sa[0])];0<wa;)wa=Fd[2*wa+Qe(Pi,sa[wa])];sa=-wa,da[ki+Go]=sa}n(ys,ks,da,ki,4),ks+=4,kl[0+aa]=sa}}else sa=Qe(Pi,156)?Qe(Pi,128)?1:3:Qe(Pi,163)?2:0,Qa.Ob[0]=sa,i(da,ki,sa,4),i(kl,0,sa,4);Qa.Dd=Qe(Pi,142)?Qe(Pi,114)?Qe(Pi,183)?1:3:2:0}if(To.m.Ka)return Fa(Yi,7,"Premature end-of-partition0 encountered.");for(;Yi.ja<Yi.za;++Yi.ja){if(To=Yn,Pi=(wn=Yi).rb[wn.sb-1],da=wn.rb[wn.sb+wn.ja],Ni=wn.ya[wn.aa+wn.ja],ki=wn.kc?Ni.Ad:0)Pi.la=da.la=0,Ni.Za||(Pi.Na=da.Na=0),Ni.Hc=0,Ni.Gc=0,Ni.ia=0;else{var Co,qi;if(Pi=da,da=To,ki=wn.Pa.Xc,kl=wn.ya[wn.aa+wn.ja],Qa=wn.pb[kl.$b],aa=kl.ad,ys=0,ks=wn.rb[wn.sb-1],sa=Go=0,i(aa,ys,0,384),kl.Za)var Wo=0,Tn=ki[3];else{wa=a(16);var Sn=Pi.Na+ks.Na;if(Sn=Nd(da,ki[1],Sn,Qa.Eb,0,wa,0),Pi.Na=ks.Na=(0<Sn)+0,1<Sn)y(wa,0,aa,ys);else{var Rs=wa[0]+3>>3;for(wa=0;256>wa;wa+=16)aa[ys+wa]=Rs}Wo=1,Tn=ki[0]}var Sa=15&Pi.la,Lo=15&ks.la;for(wa=0;4>wa;++wa){var $a=1&Lo;for(Rs=qi=0;4>Rs;++Rs)Sa=Sa>>1|($a=(Sn=Nd(da,Tn,Sn=$a+(1&Sa),Qa.Sc,Wo,aa,ys))>Wo)<<7,qi=qi<<2|(3<Sn?3:1<Sn?2:aa[ys+0]!=0),ys+=16;Sa>>=4,Lo=Lo>>1|$a<<7,Go=(Go<<8|qi)>>>0}for(Tn=Sa,Wo=Lo>>4,Co=0;4>Co;Co+=2){for(qi=0,Sa=Pi.la>>4+Co,Lo=ks.la>>4+Co,wa=0;2>wa;++wa){for($a=1&Lo,Rs=0;2>Rs;++Rs)Sn=$a+(1&Sa),Sa=Sa>>1|($a=0<(Sn=Nd(da,ki[2],Sn,Qa.Qc,0,aa,ys)))<<3,qi=qi<<2|(3<Sn?3:1<Sn?2:aa[ys+0]!=0),ys+=16;Sa>>=2,Lo=Lo>>1|$a<<5}sa|=qi<<4*Co,Tn|=Sa<<4<<Co,Wo|=(240&Lo)<<Co}Pi.la=Tn,ks.la=Wo,kl.Hc=Go,kl.Gc=sa,kl.ia=43690&sa?0:Qa.ia,ki=!(Go|sa)}if(0<wn.L&&(wn.wa[wn.Y+wn.ja]=wn.gd[Ni.$b][Ni.Za],wn.wa[wn.Y+wn.ja].La|=!ki),To.Ka)return Fa(Yi,7,"Premature end-of-file encountered.")}if(ts(Yi),wn=No,To=1,Ni=(Yn=Yi).D,Pi=0<Yn.L&&Yn.M>=Yn.zb&&Yn.M<=Yn.Va,Yn.Aa==0)t:{if(Ni.M=Yn.M,Ni.uc=Pi,ul(Yn,Ni),To=1,Ni=(qi=Yn.D).Nb,Pi=(sa=oc[Yn.L])*Yn.R,da=sa/2*Yn.B,wa=16*Ni*Yn.R,Rs=8*Ni*Yn.B,ki=Yn.sa,kl=Yn.ta-Pi+wa,Qa=Yn.qa,aa=Yn.ra-da+Rs,ys=Yn.Ha,ks=Yn.Ia-da+Rs,Lo=(Sa=qi.M)==0,Go=Sa>=Yn.Va-1,Yn.Aa==2&&ul(Yn,qi),qi.uc)for($a=(Sn=Yn).D.M,e(Sn.D.uc),qi=Sn.yb;qi<Sn.Hb;++qi){Wo=qi,Tn=$a;var eo=(Rl=(is=Sn).D).Nb;Co=is.R;var Rl=Rl.wa[Rl.Y+Wo],Yl=is.sa,Zl=is.ta+16*eo*Co+16*Wo,gu=Rl.dd,Ea=Rl.tc;if(Ea!=0)if(e(3<=Ea),is.L==1)0<Wo&&Fn(Yl,Zl,Co,Ea+4),Rl.La&&na(Yl,Zl,Co,Ea),0<Tn&&Xn(Yl,Zl,Co,Ea+4),Rl.La&&En(Yl,Zl,Co,Ea);else{var ia=is.B,pa=is.qa,mu=is.ra+8*eo*ia+8*Wo,yu=is.Ha,is=is.Ia+8*eo*ia+8*Wo;eo=Rl.ld,0<Wo&&(tt(Yl,Zl,Co,Ea+4,gu,eo),rr(pa,mu,yu,is,ia,Ea+4,gu,eo)),Rl.La&&(qr(Yl,Zl,Co,Ea,gu,eo),Dn(pa,mu,yu,is,ia,Ea,gu,eo)),0<Tn&&(Oe(Yl,Zl,Co,Ea+4,gu,eo),ft(pa,mu,yu,is,ia,Ea+4,gu,eo)),Rl.La&&(ur(Yl,Zl,Co,Ea,gu,eo),bn(pa,mu,yu,is,ia,Ea,gu,eo))}}if(Yn.ia&&alert("todo:DitherRow"),wn.put!=null){if(qi=16*Sa,Sa=16*(Sa+1),Lo?(wn.y=Yn.sa,wn.O=Yn.ta+wa,wn.f=Yn.qa,wn.N=Yn.ra+Rs,wn.ea=Yn.Ha,wn.W=Yn.Ia+Rs):(qi-=sa,wn.y=ki,wn.O=kl,wn.f=Qa,wn.N=aa,wn.ea=ys,wn.W=ks),Go||(Sa-=sa),Sa>wn.o&&(Sa=wn.o),wn.F=null,wn.J=null,Yn.Fa!=null&&0<Yn.Fa.length&&qi<Sa&&(wn.J=za(Yn,wn,qi,Sa-qi),wn.F=Yn.mb,wn.F==null&&wn.F.length==0)){To=Fa(Yn,3,"Could not decode alpha data.");break t}qi<wn.j&&(sa=wn.j-qi,qi=wn.j,e(!(1&sa)),wn.O+=Yn.R*sa,wn.N+=Yn.B*(sa>>1),wn.W+=Yn.B*(sa>>1),wn.F!=null&&(wn.J+=wn.width*sa)),qi<Sa&&(wn.O+=wn.v,wn.N+=wn.v>>1,wn.W+=wn.v>>1,wn.F!=null&&(wn.J+=wn.v),wn.ka=qi-wn.j,wn.U=wn.va-wn.v,wn.T=Sa-qi,To=wn.put(wn))}Ni+1!=Yn.Ic||Go||(n(Yn.sa,Yn.ta-Pi,ki,kl+16*Yn.R,Pi),n(Yn.qa,Yn.ra-da,Qa,aa+8*Yn.B,da),n(Yn.Ha,Yn.Ia-da,ys,ks+8*Yn.B,da))}if(!To)return Fa(Yi,6,"Output aborted.")}return 1})(St,Pt)),Pt.bc!=null&&Pt.bc(Pt),hr&=1}return hr?(St.cb=0,hr):0})(q,ke)||(K=q.a)}}else K=q.a}K==0&&nt.Oa!=null&&nt.Oa.fd&&(K=mo(nt.ba))}nt=K}Je=nt!=0?null:11>Je?lt.f.RGBA.eb:lt.f.kb.y}else Je=null;return Je};var Bu=[3,4,3,4,4,2,2,4,4,4,2,1,1]};function f(X,oe){for(var Q="",G=0;G<4;G++)Q+=String.fromCharCode(X[oe++]);return Q}function d(X,oe){return X[oe+0]|X[oe+1]<<8}function m(X,oe){return(X[oe+0]|X[oe+1]<<8|X[oe+2]<<16)>>>0}function b(X,oe){return(X[oe+0]|X[oe+1]<<8|X[oe+2]<<16|X[oe+3]<<24)>>>0}new c;var x=[0],E=[0],T=[],A=new c,M=t,F=(function(X,oe){var Q={},G=0,ae=!1,se=0,fe=0;if(Q.frames=[],!(function(de,Se){for(var we=0;we<4;we++)if(de[Se+we]!="RIFF".charCodeAt(we))return!0;return!1})(X,oe)){for(b(X,oe+=4),oe+=8;oe<X.length;){var _e=f(X,oe),Le=b(X,oe+=4);oe+=4;var ye=Le+(1&Le);switch(_e){case"VP8 ":case"VP8L":Q.frames[G]===void 0&&(Q.frames[G]={}),(Me=Q.frames[G]).src_off=ae?fe:oe-8,Me.src_size=se+Le+8,G++,ae&&(ae=!1,se=0,fe=0);break;case"VP8X":(Me=Q.header={}).feature_flags=X[oe];var Te=oe+4;Me.canvas_width=1+m(X,Te),Te+=3,Me.canvas_height=1+m(X,Te),Te+=3;break;case"ALPH":ae=!0,se=ye+8,fe=oe-8;break;case"ANIM":(Me=Q.header).bgcolor=b(X,oe),Te=oe+4,Me.loop_count=d(X,Te),Te+=2;break;case"ANMF":var Ie,Me;(Me=Q.frames[G]={}).offset_x=2*m(X,oe),oe+=3,Me.offset_y=2*m(X,oe),oe+=3,Me.width=1+m(X,oe),oe+=3,Me.height=1+m(X,oe),oe+=3,Me.duration=m(X,oe),oe+=3,Ie=X[oe++],Me.dispose=1&Ie,Me.blend=Ie>>1&1}_e!="ANMF"&&(oe+=ye)}return Q}})(M,0);F.response=M,F.rgbaoutput=!0,F.dataurl=!1;var N=F.header?F.header:null,O=F.frames?F.frames:null;if(N){N.loop_counter=N.loop_count,x=[N.canvas_height],E=[N.canvas_width];for(var U=0;U<O.length&&O[U].blend!=0;U++);}var j=O[0],H=A.WebPDecodeRGBA(M,j.src_off,j.src_size,E,x);j.rgba=H,j.imgwidth=E[0],j.imgheight=x[0];for(var W=0;W<E[0]*x[0]*4;W++)T[W]=H[W];return this.width=E,this.height=x,this.data=T,this}(function(t){var e,r,n,i,a,s,o,c,f,d=function(de){return de=de||{},this.isStrokeTransparent=de.isStrokeTransparent||!1,this.strokeOpacity=de.strokeOpacity||1,this.strokeStyle=de.strokeStyle||"#000000",this.fillStyle=de.fillStyle||"#000000",this.isFillTransparent=de.isFillTransparent||!1,this.fillOpacity=de.fillOpacity||1,this.font=de.font||"10px sans-serif",this.textBaseline=de.textBaseline||"alphabetic",this.textAlign=de.textAlign||"left",this.lineWidth=de.lineWidth||1,this.lineJoin=de.lineJoin||"miter",this.lineCap=de.lineCap||"butt",this.path=de.path||[],this.transform=de.transform!==void 0?de.transform.clone():new c,this.globalCompositeOperation=de.globalCompositeOperation||"normal",this.globalAlpha=de.globalAlpha||1,this.clip_path=de.clip_path||[],this.currentPoint=de.currentPoint||new s,this.miterLimit=de.miterLimit||10,this.lastPoint=de.lastPoint||new s,this.lineDashOffset=de.lineDashOffset||0,this.lineDash=de.lineDash||[],this.margin=de.margin||[0,0,0,0],this.prevPageLastElemOffset=de.prevPageLastElemOffset||0,this.ignoreClearRect=typeof de.ignoreClearRect!="boolean"||de.ignoreClearRect,this};t.events.push(["initialized",function(){this.context2d=new m(this),e=this.internal.f2,r=this.internal.getCoordinateString,n=this.internal.getVerticalCoordinateString,i=this.internal.getHorizontalCoordinate,a=this.internal.getVerticalCoordinate,s=this.internal.Point,o=this.internal.Rectangle,c=this.internal.Matrix,f=new d}]);var m=function(de){Object.defineProperty(this,"canvas",{get:function(){return{parentNode:!1,style:!1}}});var Se=de;Object.defineProperty(this,"pdf",{get:function(){return Se}});var we=!1;Object.defineProperty(this,"pageWrapXEnabled",{get:function(){return we},set:function(at){we=!!at}});var De=!1;Object.defineProperty(this,"pageWrapYEnabled",{get:function(){return De},set:function(at){De=!!at}});var Fe=0;Object.defineProperty(this,"posX",{get:function(){return Fe},set:function(at){isNaN(at)||(Fe=at)}});var Xe=0;Object.defineProperty(this,"posY",{get:function(){return Xe},set:function(at){isNaN(at)||(Xe=at)}}),Object.defineProperty(this,"margin",{get:function(){return f.margin},set:function(at){var $e;typeof at=="number"?$e=[at,at,at,at]:(($e=new Array(4))[0]=at[0],$e[1]=at.length>=2?at[1]:$e[0],$e[2]=at.length>=3?at[2]:$e[0],$e[3]=at.length>=4?at[3]:$e[1]),f.margin=$e}});var Be=!1;Object.defineProperty(this,"autoPaging",{get:function(){return Be},set:function(at){Be=at}});var st=0;Object.defineProperty(this,"lastBreak",{get:function(){return st},set:function(at){st=at}});var Qe=[];Object.defineProperty(this,"pageBreaks",{get:function(){return Qe},set:function(at){Qe=at}}),Object.defineProperty(this,"ctx",{get:function(){return f},set:function(at){at instanceof d&&(f=at)}}),Object.defineProperty(this,"path",{get:function(){return f.path},set:function(at){f.path=at}});var it=[];Object.defineProperty(this,"ctxStack",{get:function(){return it},set:function(at){it=at}}),Object.defineProperty(this,"fillStyle",{get:function(){return this.ctx.fillStyle},set:function(at){var $e;$e=b(at),this.ctx.fillStyle=$e.style,this.ctx.isFillTransparent=$e.a===0,this.ctx.fillOpacity=$e.a,this.pdf.setFillColor($e.r,$e.g,$e.b,{a:$e.a}),this.pdf.setTextColor($e.r,$e.g,$e.b,{a:$e.a})}}),Object.defineProperty(this,"strokeStyle",{get:function(){return this.ctx.strokeStyle},set:function(at){var $e=b(at);this.ctx.strokeStyle=$e.style,this.ctx.isStrokeTransparent=$e.a===0,this.ctx.strokeOpacity=$e.a,$e.a===0?this.pdf.setDrawColor(255,255,255):($e.a,this.pdf.setDrawColor($e.r,$e.g,$e.b))}}),Object.defineProperty(this,"lineCap",{get:function(){return this.ctx.lineCap},set:function(at){["butt","round","square"].indexOf(at)!==-1&&(this.ctx.lineCap=at,this.pdf.setLineCap(at))}}),Object.defineProperty(this,"lineWidth",{get:function(){return this.ctx.lineWidth},set:function(at){isNaN(at)||(this.ctx.lineWidth=at,this.pdf.setLineWidth(at))}}),Object.defineProperty(this,"lineJoin",{get:function(){return this.ctx.lineJoin},set:function(at){["bevel","round","miter"].indexOf(at)!==-1&&(this.ctx.lineJoin=at,this.pdf.setLineJoin(at))}}),Object.defineProperty(this,"miterLimit",{get:function(){return this.ctx.miterLimit},set:function(at){isNaN(at)||(this.ctx.miterLimit=at,this.pdf.setMiterLimit(at))}}),Object.defineProperty(this,"textBaseline",{get:function(){return this.ctx.textBaseline},set:function(at){this.ctx.textBaseline=at}}),Object.defineProperty(this,"textAlign",{get:function(){return this.ctx.textAlign},set:function(at){["right","end","center","left","start"].indexOf(at)!==-1&&(this.ctx.textAlign=at)}});var be=null,Ot=null;Object.defineProperty(this,"fontFaces",{get:function(){return Ot},set:function(at){be=null,Ot=at}}),Object.defineProperty(this,"font",{get:function(){return this.ctx.font},set:function(at){var $e;if(this.ctx.font=at,($e=/^\s*(?=(?:(?:[-a-z]+\s*){0,2}(italic|oblique))?)(?=(?:(?:[-a-z]+\s*){0,2}(small-caps))?)(?=(?:(?:[-a-z]+\s*){0,2}(bold(?:er)?|lighter|[1-9]00))?)(?:(?:normal|\1|\2|\3)\s*){0,3}((?:xx?-)?(?:small|large)|medium|smaller|larger|[.\d]+(?:\%|in|[cem]m|ex|p[ctx]))(?:\s*\/\s*(normal|[.\d]+(?:\%|in|[cem]m|ex|p[ctx])))?\s*([-_,\"\'\sa-z]+?)\s*$/i.exec(at))!==null){var Xt=$e[1];$e[2];var $t=$e[3],cr=$e[4];$e[5];var _t=$e[6],gr=/^([.\d]+)((?:%|in|[cem]m|ex|p[ctx]))$/i.exec(cr)[2];cr=Math.floor(gr==="px"?parseFloat(cr)*this.pdf.internal.scaleFactor:gr==="em"?parseFloat(cr)*this.pdf.getFontSize():parseFloat(cr)*this.pdf.internal.scaleFactor),this.pdf.setFontSize(cr);var mr=(function(qe){var Ge,Ft,Et=[],mt=qe.trim();if(mt==="")return jA;if(mt in v9)return[v9[mt]];for(;mt!=="";){switch(Ft=null,Ge=(mt=b9(mt)).charAt(0)){case'"':case"'":Ft=n_e(mt.substring(1),Ge);break;default:Ft=i_e(mt)}if(Ft===null||(Et.push(Ft[0]),(mt=b9(Ft[1]))!==""&&mt.charAt(0)!==","))return jA;mt=mt.replace(/^,/,"")}return Et})(_t);if(this.fontFaces){var ar=(function(qe,Ge){if(be===null){var Ft=(function(Et){var mt=[];return Object.keys(Et).forEach(function(ct){Et[ct].forEach(function(Qt){var Ht=null;switch(Qt){case"bold":Ht={family:ct,weight:"bold"};break;case"italic":Ht={family:ct,style:"italic"};break;case"bolditalic":Ht={family:ct,weight:"bold",style:"italic"};break;case"":case"normal":Ht={family:ct}}Ht!==null&&(Ht.ref={name:ct,style:Qt},mt.push(Ht))})}),mt})(qe.getFontList());be=(function(Et){for(var mt={},ct=0;ct<Et.length;++ct){var Qt=zA(Et[ct]),Ht=Qt.family,Ir=Qt.stretch,Ar=Qt.style,$r=Qt.weight;mt[Ht]=mt[Ht]||{},mt[Ht][Ir]=mt[Ht][Ir]||{},mt[Ht][Ir][Ar]=mt[Ht][Ir][Ar]||{},mt[Ht][Ir][Ar][$r]=Qt}return mt})(Ft.concat(Ge))}return be})(this.pdf,this.fontFaces),Cr=mr.map(function(qe){return{family:qe,stretch:"normal",weight:$t,style:Xt}}),Er=(function(qe,Ge,Ft){for(var Et=(Ft=Ft||{}).defaultFontFamily||"times",mt=Object.assign({},r_e,Ft.genericFontFamilies||{}),ct=null,Qt=null,Ht=0;Ht<Ge.length;++Ht)if(mt[(ct=zA(Ge[Ht])).family]&&(ct.family=mt[ct.family]),qe.hasOwnProperty(ct.family)){Qt=qe[ct.family];break}if(!(Qt=Qt||qe[Et]))throw new Error("Could not find a font-family for the rule '"+_9(ct)+"' and default family '"+Et+"'.");if(Qt=(function(Ir,Ar){if(Ar[Ir])return Ar[Ir];var $r=nR[Ir],fn=$r<=nR.normal?-1:1,zr=y9(Ar,pZ,$r,fn);if(!zr)throw new Error("Could not find a matching font-stretch value for "+Ir);return zr})(ct.stretch,Qt),Qt=(function(Ir,Ar){if(Ar[Ir])return Ar[Ir];for(var $r=dZ[Ir],fn=0;fn<$r.length;++fn)if(Ar[$r[fn]])return Ar[$r[fn]];throw new Error("Could not find a matching font-style for "+Ir)})(ct.style,Qt),!(Qt=(function(Ir,Ar){if(Ar[Ir])return Ar[Ir];if(Ir===400&&Ar[500])return Ar[500];if(Ir===500&&Ar[400])return Ar[400];var $r=t_e[Ir],fn=y9(Ar,gZ,$r,Ir<400?-1:1);if(!fn)throw new Error("Could not find a matching font-weight for value "+Ir);return fn})(ct.weight,Qt)))throw new Error("Failed to resolve a font for the rule '"+_9(ct)+"'.");return Qt})(ar,Cr);this.pdf.setFont(Er.ref.name,Er.ref.style)}else{var Jt="";($t==="bold"||parseInt($t,10)>=700||Xt==="bold")&&(Jt="bold"),Xt==="italic"&&(Jt+="italic"),Jt.length===0&&(Jt="normal");for(var ot="",Ce={arial:"Helvetica",Arial:"Helvetica",verdana:"Helvetica",Verdana:"Helvetica",helvetica:"Helvetica",Helvetica:"Helvetica","sans-serif":"Helvetica",fixed:"Courier",monospace:"Courier",terminal:"Courier",cursive:"Times",fantasy:"Times",serif:"Times"},xe=0;xe<mr.length;xe++){if(this.pdf.internal.getFont(mr[xe],Jt,{noFallback:!0,disableWarning:!0})!==void 0){ot=mr[xe];break}if(Jt==="bolditalic"&&this.pdf.internal.getFont(mr[xe],"bold",{noFallback:!0,disableWarning:!0})!==void 0)ot=mr[xe],Jt="bold";else if(this.pdf.internal.getFont(mr[xe],"normal",{noFallback:!0,disableWarning:!0})!==void 0){ot=mr[xe],Jt="normal";break}}if(ot===""){for(var je=0;je<mr.length;je++)if(Ce[mr[je]]){ot=Ce[mr[je]];break}}ot=ot===""?"Times":ot,this.pdf.setFont(ot,Jt)}}}}),Object.defineProperty(this,"globalCompositeOperation",{get:function(){return this.ctx.globalCompositeOperation},set:function(at){this.ctx.globalCompositeOperation=at}}),Object.defineProperty(this,"globalAlpha",{get:function(){return this.ctx.globalAlpha},set:function(at){this.ctx.globalAlpha=at}}),Object.defineProperty(this,"lineDashOffset",{get:function(){return this.ctx.lineDashOffset},set:function(at){this.ctx.lineDashOffset=at,Me.call(this)}}),Object.defineProperty(this,"lineDash",{get:function(){return this.ctx.lineDash},set:function(at){this.ctx.lineDash=at,Me.call(this)}}),Object.defineProperty(this,"ignoreClearRect",{get:function(){return this.ctx.ignoreClearRect},set:function(at){this.ctx.ignoreClearRect=!!at}})};m.prototype.setLineDash=function(de){this.lineDash=de},m.prototype.getLineDash=function(){return this.lineDash.length%2?this.lineDash.concat(this.lineDash):this.lineDash.slice()},m.prototype.fill=function(){O.call(this,"fill",!1)},m.prototype.stroke=function(){O.call(this,"stroke",!1)},m.prototype.beginPath=function(){this.path=[{type:"begin"}]},m.prototype.moveTo=function(de,Se){if(isNaN(de)||isNaN(Se))throw Ro.error("jsPDF.context2d.moveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.moveTo");var we=this.ctx.transform.applyToPoint(new s(de,Se));this.path.push({type:"mt",x:we.x,y:we.y}),this.ctx.lastPoint=new s(de,Se)},m.prototype.closePath=function(){var de=new s(0,0),Se=0;for(Se=this.path.length-1;Se!==-1;Se--)if(this.path[Se].type==="begin"&&ho(this.path[Se+1])==="object"&&typeof this.path[Se+1].x=="number"){de=new s(this.path[Se+1].x,this.path[Se+1].y);break}this.path.push({type:"close"}),this.ctx.lastPoint=new s(de.x,de.y)},m.prototype.lineTo=function(de,Se){if(isNaN(de)||isNaN(Se))throw Ro.error("jsPDF.context2d.lineTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.lineTo");var we=this.ctx.transform.applyToPoint(new s(de,Se));this.path.push({type:"lt",x:we.x,y:we.y}),this.ctx.lastPoint=new s(we.x,we.y)},m.prototype.clip=function(){this.ctx.clip_path=JSON.parse(JSON.stringify(this.path)),O.call(this,null,!0)},m.prototype.quadraticCurveTo=function(de,Se,we,De){if(isNaN(we)||isNaN(De)||isNaN(de)||isNaN(Se))throw Ro.error("jsPDF.context2d.quadraticCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.quadraticCurveTo");var Fe=this.ctx.transform.applyToPoint(new s(we,De)),Xe=this.ctx.transform.applyToPoint(new s(de,Se));this.path.push({type:"qct",x1:Xe.x,y1:Xe.y,x:Fe.x,y:Fe.y}),this.ctx.lastPoint=new s(Fe.x,Fe.y)},m.prototype.bezierCurveTo=function(de,Se,we,De,Fe,Xe){if(isNaN(Fe)||isNaN(Xe)||isNaN(de)||isNaN(Se)||isNaN(we)||isNaN(De))throw Ro.error("jsPDF.context2d.bezierCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.bezierCurveTo");var Be=this.ctx.transform.applyToPoint(new s(Fe,Xe)),st=this.ctx.transform.applyToPoint(new s(de,Se)),Qe=this.ctx.transform.applyToPoint(new s(we,De));this.path.push({type:"bct",x1:st.x,y1:st.y,x2:Qe.x,y2:Qe.y,x:Be.x,y:Be.y}),this.ctx.lastPoint=new s(Be.x,Be.y)},m.prototype.arc=function(de,Se,we,De,Fe,Xe){if(isNaN(de)||isNaN(Se)||isNaN(we)||isNaN(De)||isNaN(Fe))throw Ro.error("jsPDF.context2d.arc: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.arc");if(Xe=!!Xe,!this.ctx.transform.isIdentity){var Be=this.ctx.transform.applyToPoint(new s(de,Se));de=Be.x,Se=Be.y;var st=this.ctx.transform.applyToPoint(new s(0,we)),Qe=this.ctx.transform.applyToPoint(new s(0,0));we=Math.sqrt(Math.pow(st.x-Qe.x,2)+Math.pow(st.y-Qe.y,2))}Math.abs(Fe-De)>=2*Math.PI&&(De=0,Fe=2*Math.PI),this.path.push({type:"arc",x:de,y:Se,radius:we,startAngle:De,endAngle:Fe,counterclockwise:Xe})},m.prototype.arcTo=function(de,Se,we,De,Fe){throw new Error("arcTo not implemented.")},m.prototype.rect=function(de,Se,we,De){if(isNaN(de)||isNaN(Se)||isNaN(we)||isNaN(De))throw Ro.error("jsPDF.context2d.rect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rect");this.moveTo(de,Se),this.lineTo(de+we,Se),this.lineTo(de+we,Se+De),this.lineTo(de,Se+De),this.lineTo(de,Se),this.lineTo(de+we,Se),this.lineTo(de,Se)},m.prototype.fillRect=function(de,Se,we,De){if(isNaN(de)||isNaN(Se)||isNaN(we)||isNaN(De))throw Ro.error("jsPDF.context2d.fillRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillRect");if(!x.call(this)){var Fe={};this.lineCap!=="butt"&&(Fe.lineCap=this.lineCap,this.lineCap="butt"),this.lineJoin!=="miter"&&(Fe.lineJoin=this.lineJoin,this.lineJoin="miter"),this.beginPath(),this.rect(de,Se,we,De),this.fill(),Fe.hasOwnProperty("lineCap")&&(this.lineCap=Fe.lineCap),Fe.hasOwnProperty("lineJoin")&&(this.lineJoin=Fe.lineJoin)}},m.prototype.strokeRect=function(de,Se,we,De){if(isNaN(de)||isNaN(Se)||isNaN(we)||isNaN(De))throw Ro.error("jsPDF.context2d.strokeRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeRect");E.call(this)||(this.beginPath(),this.rect(de,Se,we,De),this.stroke())},m.prototype.clearRect=function(de,Se,we,De){if(isNaN(de)||isNaN(Se)||isNaN(we)||isNaN(De))throw Ro.error("jsPDF.context2d.clearRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.clearRect");this.ignoreClearRect||(this.fillStyle="#ffffff",this.fillRect(de,Se,we,De))},m.prototype.save=function(de){de=typeof de!="boolean"||de;for(var Se=this.pdf.internal.getCurrentPageInfo().pageNumber,we=0;we<this.pdf.internal.getNumberOfPages();we++)this.pdf.setPage(we+1),this.pdf.internal.out("q");if(this.pdf.setPage(Se),de){this.ctx.fontSize=this.pdf.internal.getFontSize();var De=new d(this.ctx);this.ctxStack.push(this.ctx),this.ctx=De}},m.prototype.restore=function(de){de=typeof de!="boolean"||de;for(var Se=this.pdf.internal.getCurrentPageInfo().pageNumber,we=0;we<this.pdf.internal.getNumberOfPages();we++)this.pdf.setPage(we+1),this.pdf.internal.out("Q");this.pdf.setPage(Se),de&&this.ctxStack.length!==0&&(this.ctx=this.ctxStack.pop(),this.fillStyle=this.ctx.fillStyle,this.strokeStyle=this.ctx.strokeStyle,this.font=this.ctx.font,this.lineCap=this.ctx.lineCap,this.lineWidth=this.ctx.lineWidth,this.lineJoin=this.ctx.lineJoin,this.lineDash=this.ctx.lineDash,this.lineDashOffset=this.ctx.lineDashOffset)},m.prototype.toDataURL=function(){throw new Error("toDataUrl not implemented.")};var b=function(de){var Se,we,De,Fe;if(de.isCanvasGradient===!0&&(de=de.getColor()),!de)return{r:0,g:0,b:0,a:0,style:de};if(/transparent|rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*0+\s*\)/.test(de))Se=0,we=0,De=0,Fe=0;else{var Xe=/rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/.exec(de);if(Xe!==null)Se=parseInt(Xe[1]),we=parseInt(Xe[2]),De=parseInt(Xe[3]),Fe=1;else if((Xe=/rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*([\d.]+)\s*\)/.exec(de))!==null)Se=parseInt(Xe[1]),we=parseInt(Xe[2]),De=parseInt(Xe[3]),Fe=parseFloat(Xe[4]);else{if(Fe=1,typeof de=="string"&&de.charAt(0)!=="#"){var Be=new oZ(de);de=Be.ok?Be.toHex():"#000000"}de.length===4?(Se=de.substring(1,2),Se+=Se,we=de.substring(2,3),we+=we,De=de.substring(3,4),De+=De):(Se=de.substring(1,3),we=de.substring(3,5),De=de.substring(5,7)),Se=parseInt(Se,16),we=parseInt(we,16),De=parseInt(De,16)}}return{r:Se,g:we,b:De,a:Fe,style:de}},x=function(){return this.ctx.isFillTransparent||this.globalAlpha==0},E=function(){return!!(this.ctx.isStrokeTransparent||this.globalAlpha==0)};m.prototype.fillText=function(de,Se,we,De){if(isNaN(Se)||isNaN(we)||typeof de!="string")throw Ro.error("jsPDF.context2d.fillText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillText");if(De=isNaN(De)?void 0:De,!x.call(this)){var Fe=ye(this.ctx.transform.rotation),Xe=this.ctx.transform.scaleX;G.call(this,{text:de,x:Se,y:we,scale:Xe,angle:Fe,align:this.textAlign,maxWidth:De})}},m.prototype.strokeText=function(de,Se,we,De){if(isNaN(Se)||isNaN(we)||typeof de!="string")throw Ro.error("jsPDF.context2d.strokeText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeText");if(!E.call(this)){De=isNaN(De)?void 0:De;var Fe=ye(this.ctx.transform.rotation),Xe=this.ctx.transform.scaleX;G.call(this,{text:de,x:Se,y:we,scale:Xe,renderingMode:"stroke",angle:Fe,align:this.textAlign,maxWidth:De})}},m.prototype.measureText=function(de){if(typeof de!="string")throw Ro.error("jsPDF.context2d.measureText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.measureText");var Se=this.pdf,we=this.pdf.internal.scaleFactor,De=Se.internal.getFontSize(),Fe=Se.getStringUnitWidth(de)*De/Se.internal.scaleFactor;return new function(Xe){var Be=(Xe=Xe||{}).width||0;return Object.defineProperty(this,"width",{get:function(){return Be}}),this}({width:Fe*=Math.round(96*we/72*1e4)/1e4})},m.prototype.scale=function(de,Se){if(isNaN(de)||isNaN(Se))throw Ro.error("jsPDF.context2d.scale: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.scale");var we=new c(de,0,0,Se,0,0);this.ctx.transform=this.ctx.transform.multiply(we)},m.prototype.rotate=function(de){if(isNaN(de))throw Ro.error("jsPDF.context2d.rotate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rotate");var Se=new c(Math.cos(de),Math.sin(de),-Math.sin(de),Math.cos(de),0,0);this.ctx.transform=this.ctx.transform.multiply(Se)},m.prototype.translate=function(de,Se){if(isNaN(de)||isNaN(Se))throw Ro.error("jsPDF.context2d.translate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.translate");var we=new c(1,0,0,1,de,Se);this.ctx.transform=this.ctx.transform.multiply(we)},m.prototype.transform=function(de,Se,we,De,Fe,Xe){if(isNaN(de)||isNaN(Se)||isNaN(we)||isNaN(De)||isNaN(Fe)||isNaN(Xe))throw Ro.error("jsPDF.context2d.transform: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.transform");var Be=new c(de,Se,we,De,Fe,Xe);this.ctx.transform=this.ctx.transform.multiply(Be)},m.prototype.setTransform=function(de,Se,we,De,Fe,Xe){de=isNaN(de)?1:de,Se=isNaN(Se)?0:Se,we=isNaN(we)?0:we,De=isNaN(De)?1:De,Fe=isNaN(Fe)?0:Fe,Xe=isNaN(Xe)?0:Xe,this.ctx.transform=new c(de,Se,we,De,Fe,Xe)};var T=function(){return this.margin[0]>0||this.margin[1]>0||this.margin[2]>0||this.margin[3]>0};m.prototype.drawImage=function(de,Se,we,De,Fe,Xe,Be,st,Qe){var it=this.pdf.getImageProperties(de),be=1,Ot=1,at=1,$e=1;De!==void 0&&st!==void 0&&(at=st/De,$e=Qe/Fe,be=it.width/De*st/De,Ot=it.height/Fe*Qe/Fe),Xe===void 0&&(Xe=Se,Be=we,Se=0,we=0),De!==void 0&&st===void 0&&(st=De,Qe=Fe),De===void 0&&st===void 0&&(st=it.width,Qe=it.height);for(var Xt,$t=this.ctx.transform.decompose(),cr=ye($t.rotate.shx),_t=new c,gr=(_t=(_t=(_t=_t.multiply($t.translate)).multiply($t.skew)).multiply($t.scale)).applyToRectangle(new o(Xe-Se*at,Be-we*$e,De*be,Fe*Ot)),mr=A.call(this,gr),ar=[],Cr=0;Cr<mr.length;Cr+=1)ar.indexOf(mr[Cr])===-1&&ar.push(mr[Cr]);if(N(ar),this.autoPaging)for(var Er=ar[0],Jt=ar[ar.length-1],ot=Er;ot<Jt+1;ot++){this.pdf.setPage(ot);var Ce=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],xe=ot===1?this.posY+this.margin[0]:this.margin[0],je=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],qe=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],Ge=ot===1?0:je+(ot-2)*qe;if(this.ctx.clip_path.length!==0){var Ft=this.path;Xt=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=F(Xt,this.posX+this.margin[3],-Ge+xe+this.ctx.prevPageLastElemOffset),U.call(this,"fill",!0),this.path=Ft}var Et=JSON.parse(JSON.stringify(gr));Et=F([Et],this.posX+this.margin[3],-Ge+xe+this.ctx.prevPageLastElemOffset)[0];var mt=(ot>Er||ot<Jt)&&T.call(this);mt&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Ce,qe,null).clip().discardPath()),this.pdf.addImage(de,"JPEG",Et.x,Et.y,Et.w,Et.h,null,null,cr),mt&&this.pdf.restoreGraphicsState()}else this.pdf.addImage(de,"JPEG",gr.x,gr.y,gr.w,gr.h,null,null,cr)};var A=function(de,Se,we){var De=[];Se=Se||this.pdf.internal.pageSize.width,we=we||this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2];var Fe=this.posY+this.ctx.prevPageLastElemOffset;switch(de.type){default:case"mt":case"lt":De.push(Math.floor((de.y+Fe)/we)+1);break;case"arc":De.push(Math.floor((de.y+Fe-de.radius)/we)+1),De.push(Math.floor((de.y+Fe+de.radius)/we)+1);break;case"qct":var Xe=Te(this.ctx.lastPoint.x,this.ctx.lastPoint.y,de.x1,de.y1,de.x,de.y);De.push(Math.floor((Xe.y+Fe)/we)+1),De.push(Math.floor((Xe.y+Xe.h+Fe)/we)+1);break;case"bct":var Be=Ie(this.ctx.lastPoint.x,this.ctx.lastPoint.y,de.x1,de.y1,de.x2,de.y2,de.x,de.y);De.push(Math.floor((Be.y+Fe)/we)+1),De.push(Math.floor((Be.y+Be.h+Fe)/we)+1);break;case"rect":De.push(Math.floor((de.y+Fe)/we)+1),De.push(Math.floor((de.y+de.h+Fe)/we)+1)}for(var st=0;st<De.length;st+=1)for(;this.pdf.internal.getNumberOfPages()<De[st];)M.call(this);return De},M=function(){var de=this.fillStyle,Se=this.strokeStyle,we=this.font,De=this.lineCap,Fe=this.lineWidth,Xe=this.lineJoin;this.pdf.addPage(),this.fillStyle=de,this.strokeStyle=Se,this.font=we,this.lineCap=De,this.lineWidth=Fe,this.lineJoin=Xe},F=function(de,Se,we){for(var De=0;De<de.length;De++)switch(de[De].type){case"bct":de[De].x2+=Se,de[De].y2+=we;case"qct":de[De].x1+=Se,de[De].y1+=we;default:de[De].x+=Se,de[De].y+=we}return de},N=function(de){return de.sort(function(Se,we){return Se-we})},O=function(de,Se){for(var we,De,Fe=this.fillStyle,Xe=this.strokeStyle,Be=this.lineCap,st=this.lineWidth,Qe=Math.abs(st*this.ctx.transform.scaleX),it=this.lineJoin,be=JSON.parse(JSON.stringify(this.path)),Ot=JSON.parse(JSON.stringify(this.path)),at=[],$e=0;$e<Ot.length;$e++)if(Ot[$e].x!==void 0)for(var Xt=A.call(this,Ot[$e]),$t=0;$t<Xt.length;$t+=1)at.indexOf(Xt[$t])===-1&&at.push(Xt[$t]);for(var cr=0;cr<at.length;cr++)for(;this.pdf.internal.getNumberOfPages()<at[cr];)M.call(this);if(N(at),this.autoPaging)for(var _t=at[0],gr=at[at.length-1],mr=_t;mr<gr+1;mr++){this.pdf.setPage(mr),this.fillStyle=Fe,this.strokeStyle=Xe,this.lineCap=Be,this.lineWidth=Qe,this.lineJoin=it;var ar=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],Cr=mr===1?this.posY+this.margin[0]:this.margin[0],Er=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],Jt=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],ot=mr===1?0:Er+(mr-2)*Jt;if(this.ctx.clip_path.length!==0){var Ce=this.path;we=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=F(we,this.posX+this.margin[3],-ot+Cr+this.ctx.prevPageLastElemOffset),U.call(this,de,!0),this.path=Ce}if(De=JSON.parse(JSON.stringify(be)),this.path=F(De,this.posX+this.margin[3],-ot+Cr+this.ctx.prevPageLastElemOffset),Se===!1||mr===0){var xe=(mr>_t||mr<gr)&&T.call(this);xe&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],ar,Jt,null).clip().discardPath()),U.call(this,de,Se),xe&&this.pdf.restoreGraphicsState()}this.lineWidth=st}else this.lineWidth=Qe,U.call(this,de,Se),this.lineWidth=st;this.path=be},U=function(de,Se){if((de!=="stroke"||Se||!E.call(this))&&(de==="stroke"||Se||!x.call(this))){for(var we,De,Fe=[],Xe=this.path,Be=0;Be<Xe.length;Be++){var st=Xe[Be];switch(st.type){case"begin":Fe.push({begin:!0});break;case"close":Fe.push({close:!0});break;case"mt":Fe.push({start:st,deltas:[],abs:[]});break;case"lt":var Qe=Fe.length;if(Xe[Be-1]&&!isNaN(Xe[Be-1].x)&&(we=[st.x-Xe[Be-1].x,st.y-Xe[Be-1].y],Qe>0)){for(;Qe>=0;Qe--)if(Fe[Qe-1].close!==!0&&Fe[Qe-1].begin!==!0){Fe[Qe-1].deltas.push(we),Fe[Qe-1].abs.push(st);break}}break;case"bct":we=[st.x1-Xe[Be-1].x,st.y1-Xe[Be-1].y,st.x2-Xe[Be-1].x,st.y2-Xe[Be-1].y,st.x-Xe[Be-1].x,st.y-Xe[Be-1].y],Fe[Fe.length-1].deltas.push(we);break;case"qct":var it=Xe[Be-1].x+2/3*(st.x1-Xe[Be-1].x),be=Xe[Be-1].y+2/3*(st.y1-Xe[Be-1].y),Ot=st.x+2/3*(st.x1-st.x),at=st.y+2/3*(st.y1-st.y),$e=st.x,Xt=st.y;we=[it-Xe[Be-1].x,be-Xe[Be-1].y,Ot-Xe[Be-1].x,at-Xe[Be-1].y,$e-Xe[Be-1].x,Xt-Xe[Be-1].y],Fe[Fe.length-1].deltas.push(we);break;case"arc":Fe.push({deltas:[],abs:[],arc:!0}),Array.isArray(Fe[Fe.length-1].abs)&&Fe[Fe.length-1].abs.push(st)}}De=Se?null:de==="stroke"?"stroke":"fill";for(var $t=!1,cr=0;cr<Fe.length;cr++)if(Fe[cr].arc)for(var _t=Fe[cr].abs,gr=0;gr<_t.length;gr++){var mr=_t[gr];mr.type==="arc"?W.call(this,mr.x,mr.y,mr.radius,mr.startAngle,mr.endAngle,mr.counterclockwise,void 0,Se,!$t):ae.call(this,mr.x,mr.y),$t=!0}else if(Fe[cr].close===!0)this.pdf.internal.out("h"),$t=!1;else if(Fe[cr].begin!==!0){var ar=Fe[cr].start.x,Cr=Fe[cr].start.y;se.call(this,Fe[cr].deltas,ar,Cr),$t=!0}De&&X.call(this,De),Se&&oe.call(this)}},j=function(de){var Se=this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor,we=Se*(this.pdf.internal.getLineHeightFactor()-1);switch(this.ctx.textBaseline){case"bottom":return de-we;case"top":return de+Se-we;case"hanging":return de+Se-2*we;case"middle":return de+Se/2-we;default:return de}},H=function(de){return de+this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor*(this.pdf.internal.getLineHeightFactor()-1)};m.prototype.createLinearGradient=function(){var de=function(){};return de.colorStops=[],de.addColorStop=function(Se,we){this.colorStops.push([Se,we])},de.getColor=function(){return this.colorStops.length===0?"#000000":this.colorStops[0][1]},de.isCanvasGradient=!0,de},m.prototype.createPattern=function(){return this.createLinearGradient()},m.prototype.createRadialGradient=function(){return this.createLinearGradient()};var W=function(de,Se,we,De,Fe,Xe,Be,st,Qe){for(var it=_e.call(this,we,De,Fe,Xe),be=0;be<it.length;be++){var Ot=it[be];be===0&&(Qe?Q.call(this,Ot.x1+de,Ot.y1+Se):ae.call(this,Ot.x1+de,Ot.y1+Se)),fe.call(this,de,Se,Ot.x2,Ot.y2,Ot.x3,Ot.y3,Ot.x4,Ot.y4)}st?oe.call(this):X.call(this,Be)},X=function(de){switch(de){case"stroke":this.pdf.internal.out("S");break;case"fill":this.pdf.internal.out("f")}},oe=function(){this.pdf.clip(),this.pdf.discardPath()},Q=function(de,Se){this.pdf.internal.out(r(de)+" "+n(Se)+" m")},G=function(de){var Se;switch(de.align){case"right":case"end":Se="right";break;case"center":Se="center";break;default:Se="left"}var we=this.pdf.getTextDimensions(de.text),De=j.call(this,de.y),Fe=H.call(this,De)-we.h,Xe=this.ctx.transform.applyToPoint(new s(de.x,De)),Be=this.ctx.transform.decompose(),st=new c;st=(st=(st=st.multiply(Be.translate)).multiply(Be.skew)).multiply(Be.scale);for(var Qe,it,be,Ot=this.ctx.transform.applyToRectangle(new o(de.x,De,we.w,we.h)),at=st.applyToRectangle(new o(de.x,Fe,we.w,we.h)),$e=A.call(this,at),Xt=[],$t=0;$t<$e.length;$t+=1)Xt.indexOf($e[$t])===-1&&Xt.push($e[$t]);if(N(Xt),this.autoPaging)for(var cr=Xt[0],_t=Xt[Xt.length-1],gr=cr;gr<_t+1;gr++){this.pdf.setPage(gr);var mr=gr===1?this.posY+this.margin[0]:this.margin[0],ar=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],Cr=this.pdf.internal.pageSize.height-this.margin[2],Er=Cr-this.margin[0],Jt=this.pdf.internal.pageSize.width-this.margin[1],ot=Jt-this.margin[3],Ce=gr===1?0:ar+(gr-2)*Er;if(this.ctx.clip_path.length!==0){var xe=this.path;Qe=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=F(Qe,this.posX+this.margin[3],-1*Ce+mr),U.call(this,"fill",!0),this.path=xe}var je=F([JSON.parse(JSON.stringify(at))],this.posX+this.margin[3],-Ce+mr+this.ctx.prevPageLastElemOffset)[0];de.scale>=.01&&(it=this.pdf.internal.getFontSize(),this.pdf.setFontSize(it*de.scale),be=this.lineWidth,this.lineWidth=be*de.scale);var qe=this.autoPaging!=="text";if(qe||je.y+je.h<=Cr){if(qe||je.y>=mr&&je.x<=Jt){var Ge=qe?de.text:this.pdf.splitTextToSize(de.text,de.maxWidth||Jt-je.x)[0],Ft=F([JSON.parse(JSON.stringify(Ot))],this.posX+this.margin[3],-Ce+mr+this.ctx.prevPageLastElemOffset)[0],Et=qe&&(gr>cr||gr<_t)&&T.call(this);Et&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],ot,Er,null).clip().discardPath()),this.pdf.text(Ge,Ft.x,Ft.y,{angle:de.angle,align:Se,renderingMode:de.renderingMode}),Et&&this.pdf.restoreGraphicsState()}}else je.y<Cr&&(this.ctx.prevPageLastElemOffset+=Cr-je.y);de.scale>=.01&&(this.pdf.setFontSize(it),this.lineWidth=be)}else de.scale>=.01&&(it=this.pdf.internal.getFontSize(),this.pdf.setFontSize(it*de.scale),be=this.lineWidth,this.lineWidth=be*de.scale),this.pdf.text(de.text,Xe.x+this.posX,Xe.y+this.posY,{angle:de.angle,align:Se,renderingMode:de.renderingMode,maxWidth:de.maxWidth}),de.scale>=.01&&(this.pdf.setFontSize(it),this.lineWidth=be)},ae=function(de,Se,we,De){we=we||0,De=De||0,this.pdf.internal.out(r(de+we)+" "+n(Se+De)+" l")},se=function(de,Se,we){return this.pdf.lines(de,Se,we,null,null)},fe=function(de,Se,we,De,Fe,Xe,Be,st){this.pdf.internal.out([e(i(we+de)),e(a(De+Se)),e(i(Fe+de)),e(a(Xe+Se)),e(i(Be+de)),e(a(st+Se)),"c"].join(" "))},_e=function(de,Se,we,De){for(var Fe=2*Math.PI,Xe=Math.PI/2;Se>we;)Se-=Fe;var Be=Math.abs(we-Se);Be<Fe&&De&&(Be=Fe-Be);for(var st=[],Qe=De?-1:1,it=Se;Be>1e-5;){var be=it+Qe*Math.min(Be,Xe);st.push(Le.call(this,de,it,be)),Be-=Math.abs(be-it),it=be}return st},Le=function(de,Se,we){var De=(we-Se)/2,Fe=de*Math.cos(De),Xe=de*Math.sin(De),Be=Fe,st=-Xe,Qe=Be*Be+st*st,it=Qe+Be*Fe+st*Xe,be=4/3*(Math.sqrt(2*Qe*it)-it)/(Be*Xe-st*Fe),Ot=Be-be*st,at=st+be*Be,$e=Ot,Xt=-at,$t=De+Se,cr=Math.cos($t),_t=Math.sin($t);return{x1:de*Math.cos(Se),y1:de*Math.sin(Se),x2:Ot*cr-at*_t,y2:Ot*_t+at*cr,x3:$e*cr-Xt*_t,y3:$e*_t+Xt*cr,x4:de*Math.cos(we),y4:de*Math.sin(we)}},ye=function(de){return 180*de/Math.PI},Te=function(de,Se,we,De,Fe,Xe){var Be=de+.5*(we-de),st=Se+.5*(De-Se),Qe=Fe+.5*(we-Fe),it=Xe+.5*(De-Xe),be=Math.min(de,Fe,Be,Qe),Ot=Math.max(de,Fe,Be,Qe),at=Math.min(Se,Xe,st,it),$e=Math.max(Se,Xe,st,it);return new o(be,at,Ot-be,$e-at)},Ie=function(de,Se,we,De,Fe,Xe,Be,st){var Qe,it,be,Ot,at,$e,Xt,$t,cr,_t,gr,mr,ar,Cr,Er=we-de,Jt=De-Se,ot=Fe-we,Ce=Xe-De,xe=Be-Fe,je=st-Xe;for(it=0;it<41;it++)cr=(Xt=(be=de+(Qe=it/40)*Er)+Qe*((at=we+Qe*ot)-be))+Qe*(at+Qe*(Fe+Qe*xe-at)-Xt),_t=($t=(Ot=Se+Qe*Jt)+Qe*(($e=De+Qe*Ce)-Ot))+Qe*($e+Qe*(Xe+Qe*je-$e)-$t),it==0?(gr=cr,mr=_t,ar=cr,Cr=_t):(gr=Math.min(gr,cr),mr=Math.min(mr,_t),ar=Math.max(ar,cr),Cr=Math.max(Cr,_t));return new o(Math.round(gr),Math.round(mr),Math.round(ar-gr),Math.round(Cr-mr))},Me=function(){if(this.prevLineDash||this.ctx.lineDash.length||this.ctx.lineDashOffset){var de,Se,we=(de=this.ctx.lineDash,Se=this.ctx.lineDashOffset,JSON.stringify({lineDash:de,lineDashOffset:Se}));this.prevLineDash!==we&&(this.pdf.setLineDash(this.ctx.lineDash,this.ctx.lineDashOffset),this.prevLineDash=we)}}})(di.API),(function(t){var e=function(s){var o,c,f,d,m,b,x,E,T,A;for(c=[],f=0,d=(s+=o="\0\0\0\0".slice(s.length%4||4)).length;d>f;f+=4)(m=(s.charCodeAt(f)<<24)+(s.charCodeAt(f+1)<<16)+(s.charCodeAt(f+2)<<8)+s.charCodeAt(f+3))!==0?(b=(m=((m=((m=((m=(m-(A=m%85))/85)-(T=m%85))/85)-(E=m%85))/85)-(x=m%85))/85)%85,c.push(b+33,x+33,E+33,T+33,A+33)):c.push(122);return(function(M,F){for(var N=F;N>0;N--)M.pop()})(c,o.length),String.fromCharCode.apply(String,c)+"~>"},r=function(s){var o,c,f,d,m,b=String,x="length",E=255,T="charCodeAt",A="slice",M="replace";for(s[A](-2),s=s[A](0,-2)[M](/\s/g,"")[M]("z","!!!!!"),f=[],d=0,m=(s+=o="uuuuu"[A](s[x]%5||5))[x];m>d;d+=5)c=52200625*(s[T](d)-33)+614125*(s[T](d+1)-33)+7225*(s[T](d+2)-33)+85*(s[T](d+3)-33)+(s[T](d+4)-33),f.push(E&c>>24,E&c>>16,E&c>>8,E&c);return(function(F,N){for(var O=N;O>0;O--)F.pop()})(f,o[x]),b.fromCharCode.apply(b,f)},n=function(s){return s.split("").map(function(o){return("0"+o.charCodeAt().toString(16)).slice(-2)}).join("")+">"},i=function(s){var o=new RegExp(/^([0-9A-Fa-f]{2})+$/);if((s=s.replace(/\s/g,"")).indexOf(">")!==-1&&(s=s.substr(0,s.indexOf(">"))),s.length%2&&(s+="0"),o.test(s)===!1)return"";for(var c="",f=0;f<s.length;f+=2)c+=String.fromCharCode("0x"+(s[f]+s[f+1]));return c},a=function(s){for(var o=new Uint8Array(s.length),c=s.length;c--;)o[c]=s.charCodeAt(c);return(o=Zk(o)).reduce(function(f,d){return f+String.fromCharCode(d)},"")};t.processDataByFilters=function(s,o){var c=0,f=s||"",d=[];for(typeof(o=o||[])=="string"&&(o=[o]),c=0;c<o.length;c+=1)switch(o[c]){case"ASCII85Decode":case"/ASCII85Decode":f=r(f),d.push("/ASCII85Encode");break;case"ASCII85Encode":case"/ASCII85Encode":f=e(f),d.push("/ASCII85Decode");break;case"ASCIIHexDecode":case"/ASCIIHexDecode":f=i(f),d.push("/ASCIIHexEncode");break;case"ASCIIHexEncode":case"/ASCIIHexEncode":f=n(f),d.push("/ASCIIHexDecode");break;case"FlateEncode":case"/FlateEncode":f=a(f),d.push("/FlateDecode");break;default:throw new Error('The filter: "'+o[c]+'" is not implemented')}return{data:f,reverseChain:d.reverse().join(" ")}}})(di.API),(function(t){t.loadFile=function(e,r,n){return(function(i,a,s){a=a!==!1,s=typeof s=="function"?s:function(){};var o=void 0;try{o=(function(c,f,d){var m=new XMLHttpRequest,b=0,x=function(E){var T=E.length,A=[],M=String.fromCharCode;for(b=0;b<T;b+=1)A.push(M(255&E.charCodeAt(b)));return A.join("")};if(m.open("GET",c,!f),m.overrideMimeType("text/plain; charset=x-user-defined"),f===!1&&(m.onload=function(){m.status===200?d(x(this.responseText)):d(void 0)}),m.send(null),f&&m.status===200)return x(m.responseText)})(i,a,s)}catch{}return o})(e,r,n)},t.loadImageFile=t.loadFile})(di.API),(function(t){function e(){return(Oi.html2canvas?Promise.resolve(Oi.html2canvas):ib(()=>import("./html2canvas.esm-B0tyYwQk.js"),[],import.meta.url)).catch(function(o){return Promise.reject(new Error("Could not load html2canvas: "+o))}).then(function(o){return o.default?o.default:o})}function r(){return(Oi.DOMPurify?Promise.resolve(Oi.DOMPurify):ib(()=>import("./purify.es-CQJ0hv7W.js"),[],import.meta.url)).catch(function(o){return Promise.reject(new Error("Could not load dompurify: "+o))}).then(function(o){return o.default?o.default:o})}var n=function(o){var c=ho(o);return c==="undefined"?"undefined":c==="string"||o instanceof String?"string":c==="number"||o instanceof Number?"number":c==="function"||o instanceof Function?"function":o&&o.constructor===Array?"array":o&&o.nodeType===1?"element":c==="object"?"object":"unknown"},i=function(o,c){var f=document.createElement(o);for(var d in c.className&&(f.className=c.className),c.innerHTML&&c.dompurify&&(f.innerHTML=c.dompurify.sanitize(c.innerHTML)),c.style)f.style[d]=c.style[d];return f},a=function o(c,f){for(var d=c.nodeType===3?document.createTextNode(c.nodeValue):c.cloneNode(!1),m=c.firstChild;m;m=m.nextSibling)f!==!0&&m.nodeType===1&&m.nodeName==="SCRIPT"||d.appendChild(o(m,f));return c.nodeType===1&&(c.nodeName==="CANVAS"?(d.width=c.width,d.height=c.height,d.getContext("2d").drawImage(c,0,0)):c.nodeName!=="TEXTAREA"&&c.nodeName!=="SELECT"||(d.value=c.value),d.addEventListener("load",function(){d.scrollTop=c.scrollTop,d.scrollLeft=c.scrollLeft},!0)),d},s=function o(c){var f=Object.assign(o.convert(Promise.resolve()),JSON.parse(JSON.stringify(o.template))),d=o.convert(Promise.resolve(),f);return(d=d.setProgress(1,o,1,[o])).set(c)};(s.prototype=Object.create(Promise.prototype)).constructor=s,s.convert=function(o,c){return o.__proto__=c||s.prototype,o},s.template={prop:{src:null,container:null,overlay:null,canvas:null,img:null,pdf:null,pageSize:null,callback:function(){}},progress:{val:0,state:null,n:0,stack:[]},opt:{filename:"file.pdf",margin:[0,0,0,0],enableLinks:!0,x:0,y:0,html2canvas:{},jsPDF:{},backgroundColor:"transparent"}},s.prototype.from=function(o,c){return this.then(function(){switch(c=c||(function(f){switch(n(f)){case"string":return"string";case"element":return f.nodeName.toLowerCase()==="canvas"?"canvas":"element";default:return"unknown"}})(o),c){case"string":return this.then(r).then(function(f){return this.set({src:i("div",{innerHTML:o,dompurify:f})})});case"element":return this.set({src:o});case"canvas":return this.set({canvas:o});case"img":return this.set({img:o});default:return this.error("Unknown source type.")}})},s.prototype.to=function(o){switch(o){case"container":return this.toContainer();case"canvas":return this.toCanvas();case"img":return this.toImg();case"pdf":return this.toPdf();default:return this.error("Invalid target.")}},s.prototype.toContainer=function(){return this.thenList([function(){return this.prop.src||this.error("Cannot duplicate - no source HTML.")},function(){return this.prop.pageSize||this.setPageSize()}]).then(function(){var o={position:"relative",display:"inline-block",width:(typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?Math.max(this.prop.src.clientWidth,this.prop.src.scrollWidth,this.prop.src.offsetWidth):this.opt.windowWidth)+"px",left:0,right:0,top:0,margin:"auto",backgroundColor:this.opt.backgroundColor},c=a(this.prop.src,this.opt.html2canvas.javascriptEnabled);c.tagName==="BODY"&&(o.height=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight)+"px"),this.prop.overlay=i("div",{className:"html2pdf__overlay",style:{position:"fixed",overflow:"hidden",zIndex:1e3,left:"-100000px",right:0,bottom:0,top:0}}),this.prop.container=i("div",{className:"html2pdf__container",style:o}),this.prop.container.appendChild(c),this.prop.container.firstChild.appendChild(i("div",{style:{clear:"both",border:"0 none transparent",margin:0,padding:0,height:0}})),this.prop.container.style.float="none",this.prop.overlay.appendChild(this.prop.container),document.body.appendChild(this.prop.overlay),this.prop.container.firstChild.style.position="relative",this.prop.container.height=Math.max(this.prop.container.firstChild.clientHeight,this.prop.container.firstChild.scrollHeight,this.prop.container.firstChild.offsetHeight)+"px"})},s.prototype.toCanvas=function(){var o=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(o).then(e).then(function(c){var f=Object.assign({},this.opt.html2canvas);return delete f.onrendered,c(this.prop.container,f)}).then(function(c){(this.opt.html2canvas.onrendered||function(){})(c),this.prop.canvas=c,document.body.removeChild(this.prop.overlay)})},s.prototype.toContext2d=function(){var o=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(o).then(e).then(function(c){var f=this.opt.jsPDF,d=this.opt.fontFaces,m=typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?1:this.opt.width/this.opt.windowWidth,b=Object.assign({async:!0,allowTaint:!0,scale:m,scrollX:this.opt.scrollX||0,scrollY:this.opt.scrollY||0,backgroundColor:"#ffffff",imageTimeout:15e3,logging:!0,proxy:null,removeContainer:!0,foreignObjectRendering:!1,useCORS:!1},this.opt.html2canvas);if(delete b.onrendered,f.context2d.autoPaging=this.opt.autoPaging===void 0||this.opt.autoPaging,f.context2d.posX=this.opt.x,f.context2d.posY=this.opt.y,f.context2d.margin=this.opt.margin,f.context2d.fontFaces=d,d)for(var x=0;x<d.length;++x){var E=d[x],T=E.src.find(function(A){return A.format==="truetype"});T&&f.addFont(T.url,E.ref.name,E.ref.style)}return b.windowHeight=b.windowHeight||0,b.windowHeight=b.windowHeight==0?Math.max(this.prop.container.clientHeight,this.prop.container.scrollHeight,this.prop.container.offsetHeight):b.windowHeight,f.context2d.save(!0),c(this.prop.container,b)}).then(function(c){this.opt.jsPDF.context2d.restore(!0),(this.opt.html2canvas.onrendered||function(){})(c),this.prop.canvas=c,document.body.removeChild(this.prop.overlay)})},s.prototype.toImg=function(){return this.thenList([function(){return this.prop.canvas||this.toCanvas()}]).then(function(){var o=this.prop.canvas.toDataURL("image/"+this.opt.image.type,this.opt.image.quality);this.prop.img=document.createElement("img"),this.prop.img.src=o})},s.prototype.toPdf=function(){return this.thenList([function(){return this.toContext2d()}]).then(function(){this.prop.pdf=this.prop.pdf||this.opt.jsPDF})},s.prototype.output=function(o,c,f){return(f=f||"pdf").toLowerCase()==="img"||f.toLowerCase()==="image"?this.outputImg(o,c):this.outputPdf(o,c)},s.prototype.outputPdf=function(o,c){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){return this.prop.pdf.output(o,c)})},s.prototype.outputImg=function(o){return this.thenList([function(){return this.prop.img||this.toImg()}]).then(function(){switch(o){case void 0:case"img":return this.prop.img;case"datauristring":case"dataurlstring":return this.prop.img.src;case"datauri":case"dataurl":return document.location.href=this.prop.img.src;default:throw'Image output type "'+o+'" is not supported.'}})},s.prototype.save=function(o){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).set(o?{filename:o}:null).then(function(){this.prop.pdf.save(this.opt.filename)})},s.prototype.doCallback=function(){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){this.prop.callback(this.prop.pdf)})},s.prototype.set=function(o){if(n(o)!=="object")return this;var c=Object.keys(o||{}).map(function(f){if(f in s.template.prop)return function(){this.prop[f]=o[f]};switch(f){case"margin":return this.setMargin.bind(this,o.margin);case"jsPDF":return function(){return this.opt.jsPDF=o.jsPDF,this.setPageSize()};case"pageSize":return this.setPageSize.bind(this,o.pageSize);default:return function(){this.opt[f]=o[f]}}},this);return this.then(function(){return this.thenList(c)})},s.prototype.get=function(o,c){return this.then(function(){var f=o in s.template.prop?this.prop[o]:this.opt[o];return c?c(f):f})},s.prototype.setMargin=function(o){return this.then(function(){switch(n(o)){case"number":o=[o,o,o,o];case"array":if(o.length===2&&(o=[o[0],o[1],o[0],o[1]]),o.length===4)break;default:return this.error("Invalid margin array.")}this.opt.margin=o}).then(this.setPageSize)},s.prototype.setPageSize=function(o){function c(f,d){return Math.floor(f*d/72*96)}return this.then(function(){(o=o||di.getPageSize(this.opt.jsPDF)).hasOwnProperty("inner")||(o.inner={width:o.width-this.opt.margin[1]-this.opt.margin[3],height:o.height-this.opt.margin[0]-this.opt.margin[2]},o.inner.px={width:c(o.inner.width,o.k),height:c(o.inner.height,o.k)},o.inner.ratio=o.inner.height/o.inner.width),this.prop.pageSize=o})},s.prototype.setProgress=function(o,c,f,d){return o!=null&&(this.progress.val=o),c!=null&&(this.progress.state=c),f!=null&&(this.progress.n=f),d!=null&&(this.progress.stack=d),this.progress.ratio=this.progress.val/this.progress.state,this},s.prototype.updateProgress=function(o,c,f,d){return this.setProgress(o?this.progress.val+o:null,c||null,f?this.progress.n+f:null,d?this.progress.stack.concat(d):null)},s.prototype.then=function(o,c){var f=this;return this.thenCore(o,c,function(d,m){return f.updateProgress(null,null,1,[d]),Promise.prototype.then.call(this,function(b){return f.updateProgress(null,d),b}).then(d,m).then(function(b){return f.updateProgress(1),b})})},s.prototype.thenCore=function(o,c,f){f=f||Promise.prototype.then;var d=this;o&&(o=o.bind(d)),c&&(c=c.bind(d));var m=Promise.toString().indexOf("[native code]")!==-1&&Promise.name==="Promise"?d:s.convert(Object.assign({},d),Promise.prototype),b=f.call(m,o,c);return s.convert(b,d.__proto__)},s.prototype.thenExternal=function(o,c){return Promise.prototype.then.call(this,o,c)},s.prototype.thenList=function(o){var c=this;return o.forEach(function(f){c=c.thenCore(f)}),c},s.prototype.catch=function(o){o&&(o=o.bind(this));var c=Promise.prototype.catch.call(this,o);return s.convert(c,this)},s.prototype.catchExternal=function(o){return Promise.prototype.catch.call(this,o)},s.prototype.error=function(o){return this.then(function(){throw new Error(o)})},s.prototype.using=s.prototype.set,s.prototype.saveAs=s.prototype.save,s.prototype.export=s.prototype.output,s.prototype.run=s.prototype.then,di.getPageSize=function(o,c,f){if(ho(o)==="object"){var d=o;o=d.orientation,c=d.unit||c,f=d.format||f}c=c||"mm",f=f||"a4",o=(""+(o||"P")).toLowerCase();var m,b=(""+f).toLowerCase(),x={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};switch(c){case"pt":m=1;break;case"mm":m=72/25.4;break;case"cm":m=72/2.54;break;case"in":m=72;break;case"px":m=.75;break;case"pc":case"em":m=12;break;case"ex":m=6;break;default:throw"Invalid unit: "+c}var E,T=0,A=0;if(x.hasOwnProperty(b))T=x[b][1]/m,A=x[b][0]/m;else try{T=f[1],A=f[0]}catch{throw new Error("Invalid format: "+f)}if(o==="p"||o==="portrait")o="p",A>T&&(E=A,A=T,T=E);else{if(o!=="l"&&o!=="landscape")throw"Invalid orientation: "+o;o="l",T>A&&(E=A,A=T,T=E)}return{width:A,height:T,unit:c,k:m,orientation:o}},t.html=function(o,c){(c=c||{}).callback=c.callback||function(){},c.html2canvas=c.html2canvas||{},c.html2canvas.canvas=c.html2canvas.canvas||this.canvas,c.jsPDF=c.jsPDF||this,c.fontFaces=c.fontFaces?c.fontFaces.map(zA):null;var f=new s(c);return c.worker?f:f.from(o).doCallback()}})(di.API),di.API.addJS=function(t){return w9=t,this.internal.events.subscribe("postPutResources",function(){sw=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/Names [(EmbeddedJS) "+(sw+1)+" 0 R]"),this.internal.out(">>"),this.internal.out("endobj"),x9=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /JavaScript"),this.internal.out("/JS ("+w9+")"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){sw!==void 0&&x9!==void 0&&this.internal.out("/Names <</JavaScript "+sw+" 0 R>>")}),this},(function(t){var e;t.events.push(["postPutResources",function(){var r=this,n=/^(\d+) 0 obj$/;if(this.outline.root.children.length>0)for(var i=r.outline.render().split(/\r\n/),a=0;a<i.length;a++){var s=i[a],o=n.exec(s);if(o!=null){var c=o[1];r.internal.newObjectDeferredBegin(c,!1)}r.internal.write(s)}if(this.outline.createNamedDestinations){var f=this.internal.pages.length,d=[];for(a=0;a<f;a++){var m=r.internal.newObject();d.push(m);var b=r.internal.getPageInfo(a+1);r.internal.write("<< /D["+b.objId+" 0 R /XYZ null null null]>> endobj")}var x=r.internal.newObject();for(r.internal.write("<< /Names [ "),a=0;a<d.length;a++)r.internal.write("(page_"+(a+1)+")"+d[a]+" 0 R");r.internal.write(" ] >>","endobj"),e=r.internal.newObject(),r.internal.write("<< /Dests "+x+" 0 R"),r.internal.write(">>","endobj")}}]),t.events.push(["putCatalog",function(){var r=this;r.outline.root.children.length>0&&(r.internal.write("/Outlines",this.outline.makeRef(this.outline.root)),this.outline.createNamedDestinations&&r.internal.write("/Names "+e+" 0 R"))}]),t.events.push(["initialized",function(){var r=this;r.outline={createNamedDestinations:!1,root:{children:[]}},r.outline.add=function(n,i,a){var s={title:i,options:a,children:[]};return n==null&&(n=this.root),n.children.push(s),s},r.outline.render=function(){return this.ctx={},this.ctx.val="",this.ctx.pdf=r,this.genIds_r(this.root),this.renderRoot(this.root),this.renderItems(this.root),this.ctx.val},r.outline.genIds_r=function(n){n.id=r.internal.newObjectDeferred();for(var i=0;i<n.children.length;i++)this.genIds_r(n.children[i])},r.outline.renderRoot=function(n){this.objStart(n),this.line("/Type /Outlines"),n.children.length>0&&(this.line("/First "+this.makeRef(n.children[0])),this.line("/Last "+this.makeRef(n.children[n.children.length-1]))),this.line("/Count "+this.count_r({count:0},n)),this.objEnd()},r.outline.renderItems=function(n){for(var i=this.ctx.pdf.internal.getVerticalCoordinateString,a=0;a<n.children.length;a++){var s=n.children[a];this.objStart(s),this.line("/Title "+this.makeString(s.title)),this.line("/Parent "+this.makeRef(n)),a>0&&this.line("/Prev "+this.makeRef(n.children[a-1])),a<n.children.length-1&&this.line("/Next "+this.makeRef(n.children[a+1])),s.children.length>0&&(this.line("/First "+this.makeRef(s.children[0])),this.line("/Last "+this.makeRef(s.children[s.children.length-1])));var o=this.count=this.count_r({count:0},s);if(o>0&&this.line("/Count "+o),s.options&&s.options.pageNumber){var c=r.internal.getPageInfo(s.options.pageNumber);this.line("/Dest ["+c.objId+" 0 R /XYZ 0 "+i(0)+" 0]")}this.objEnd()}for(var f=0;f<n.children.length;f++)this.renderItems(n.children[f])},r.outline.line=function(n){this.ctx.val+=n+`\r
`},r.outline.makeRef=function(n){return n.id+" 0 R"},r.outline.makeString=function(n){return"("+r.internal.pdfEscape(n)+")"},r.outline.objStart=function(n){this.ctx.val+=`\r
`+n.id+` 0 obj\r
<<\r
`},r.outline.objEnd=function(){this.ctx.val+=`>> \r
endobj\r
`},r.outline.count_r=function(n,i){for(var a=0;a<i.children.length;a++)n.count++,this.count_r(n,i.children[a]);return n.count}}])})(di.API),(function(t){var e=[192,193,194,195,196,197,198,199];t.processJPEG=function(r,n,i,a,s,o){var c,f=this.decode.DCT_DECODE,d=null;if(typeof r=="string"||this.__addimage__.isArrayBuffer(r)||this.__addimage__.isArrayBufferView(r)){switch(r=s||r,r=this.__addimage__.isArrayBuffer(r)?new Uint8Array(r):r,c=(function(m){for(var b,x=256*m.charCodeAt(4)+m.charCodeAt(5),E=m.length,T={width:0,height:0,numcomponents:1},A=4;A<E;A+=2){if(A+=x,e.indexOf(m.charCodeAt(A+1))!==-1){b=256*m.charCodeAt(A+5)+m.charCodeAt(A+6),T={width:256*m.charCodeAt(A+7)+m.charCodeAt(A+8),height:b,numcomponents:m.charCodeAt(A+9)};break}x=256*m.charCodeAt(A+2)+m.charCodeAt(A+3)}return T})(r=this.__addimage__.isArrayBufferView(r)?this.__addimage__.arrayBufferToBinaryString(r):r),c.numcomponents){case 1:o=this.color_spaces.DEVICE_GRAY;break;case 4:o=this.color_spaces.DEVICE_CMYK;break;case 3:o=this.color_spaces.DEVICE_RGB}d={data:r,width:c.width,height:c.height,colorSpace:o,bitsPerComponent:8,filter:f,index:n,alias:i}}return d}})(di.API),di.API.processPNG=function(t,e,r,n){if(this.__addimage__.isArrayBuffer(t)&&(t=new Uint8Array(t)),this.__addimage__.isArrayBufferView(t)){var i,a=U0e(t,{checkCrc:!0}),s=a.width,o=a.height,c=a.channels,f=a.palette,d=a.depth;i=f&&c===1?(function(H){for(var W=H.width,X=H.height,oe=H.data,Q=H.palette,G=H.depth,ae=!1,se=[],fe=[],_e=void 0,Le=!1,ye=0,Te=0;Te<Q.length;Te++){var Ie=Cz(Q[Te],4),Me=Ie[0],de=Ie[1],Se=Ie[2],we=Ie[3];se.push(Me,de,Se),we!=null&&(we===0?(ye++,fe.length<1&&fe.push(Te)):we<255&&(Le=!0))}if(Le||ye>1){ae=!0,fe=void 0;var De=W*X;_e=new Uint8Array(De);for(var Fe=new DataView(oe.buffer),Xe=0;Xe<De;Xe++){var Be=UA(Fe,Xe,G),st=Cz(Q[Be],4)[3];_e[Xe]=st}}return{colorSpace:"Indexed",colorsPerPixel:1,colorBytes:oe,alphaBytes:_e,needSMask:ae,palette:se,mask:fe}})(a):c===2||c===4?(function(H){for(var W=H.data,X=H.width,oe=H.height,Q=H.channels,G=H.depth,ae=Q===2?"DeviceGray":"DeviceRGB",se=Q-1,fe=X*oe,_e=se,Le=fe*_e,ye=1*fe,Te=Math.ceil(Le*G/8),Ie=Math.ceil(ye*G/8),Me=new Uint8Array(Te),de=new Uint8Array(Ie),Se=new DataView(W.buffer),we=new DataView(Me.buffer),De=new DataView(de.buffer),Fe=!1,Xe=0;Xe<fe;Xe++){for(var Be=Xe*Q,st=0;st<_e;st++)R9(we,UA(Se,Be+st,G),Xe*_e+st,G);var Qe=UA(Se,Be+_e,G);Qe<(1<<G)-1&&(Fe=!0),R9(De,Qe,1*Xe,G)}return{colorSpace:ae,colorsPerPixel:se,colorBytes:Me,alphaBytes:de,needSMask:Fe}})(a):(function(H){var W=H.data,X=H.channels===1?"DeviceGray":"DeviceRGB";return{colorSpace:X,colorsPerPixel:X==="DeviceGray"?1:3,colorBytes:W instanceof Uint8Array?W:new Uint8Array(W.buffer),needSMask:!1}})(a);var m,b,x,E=i,T=E.colorSpace,A=E.colorsPerPixel,M=E.colorBytes,F=E.alphaBytes,N=E.needSMask,O=E.palette,U=E.mask,j=null;return n!==di.API.image_compression.NONE&&typeof Zk=="function"?(j=(function(H){var W;switch(H){case di.API.image_compression.FAST:W=11;break;case di.API.image_compression.MEDIUM:W=13;break;case di.API.image_compression.SLOW:W=14;break;default:W=12}return W})(n),m=this.decode.FLATE_DECODE,b="/Predictor ".concat(j," "),t=C9(M,s*A,A,n),N&&(x=C9(F,s,1,n))):(m=void 0,b="",t=M,N&&(x=F)),b+="/Colors ".concat(A," /BitsPerComponent ").concat(d," /Columns ").concat(s),(this.__addimage__.isArrayBuffer(t)||this.__addimage__.isArrayBufferView(t))&&(t=this.__addimage__.arrayBufferToBinaryString(t)),(x&&this.__addimage__.isArrayBuffer(x)||this.__addimage__.isArrayBufferView(x))&&(x=this.__addimage__.arrayBufferToBinaryString(x)),{alias:r,data:t,index:e,filter:m,decodeParameters:b,transparency:U,palette:O,sMask:x,predictor:j,width:s,height:o,bitsPerComponent:d,colorSpace:T}}},(function(t){t.processGIF89A=function(e,r,n,i){var a=new l_e(e),s=a.width,o=a.height,c=[];a.decodeAndBlitFrameRGBA(0,c);var f={data:c,width:s,height:o},d=new VA(100).encode(f,100);return t.processJPEG.call(this,d,r,n,i)},t.processGIF87A=t.processGIF89A})(di.API),ph.prototype.parseHeader=function(){if(this.fileSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.reserved=this.datav.getUint32(this.pos,!0),this.pos+=4,this.offset=this.datav.getUint32(this.pos,!0),this.pos+=4,this.headerSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.width=this.datav.getUint32(this.pos,!0),this.pos+=4,this.height=this.datav.getInt32(this.pos,!0),this.pos+=4,this.planes=this.datav.getUint16(this.pos,!0),this.pos+=2,this.bitPP=this.datav.getUint16(this.pos,!0),this.pos+=2,this.compress=this.datav.getUint32(this.pos,!0),this.pos+=4,this.rawSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.hr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.vr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.colors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.importantColors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.bitPP===16&&this.is_with_alpha&&(this.bitPP=15),this.bitPP<15){var t=this.colors===0?1<<this.bitPP:this.colors;this.palette=new Array(t);for(var e=0;e<t;e++){var r=this.datav.getUint8(this.pos++,!0),n=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0);this.palette[e]={red:i,green:n,blue:r,quad:a}}}this.height<0&&(this.height*=-1,this.bottom_up=!1)},ph.prototype.parseBGR=function(){this.pos=this.offset;try{var t="bit"+this.bitPP,e=this.width*this.height*4;this.data=new Uint8Array(e),this[t]()}catch(r){Ro.log("bit decode error:"+r)}},ph.prototype.bit1=function(){var t,e=Math.ceil(this.width/8),r=e%4;for(t=this.height-1;t>=0;t--){for(var n=this.bottom_up?t:this.height-1-t,i=0;i<e;i++)for(var a=this.datav.getUint8(this.pos++,!0),s=n*this.width*4+8*i*4,o=0;o<8&&8*i+o<this.width;o++){var c=this.palette[a>>7-o&1];this.data[s+4*o]=c.blue,this.data[s+4*o+1]=c.green,this.data[s+4*o+2]=c.red,this.data[s+4*o+3]=255}r!==0&&(this.pos+=4-r)}},ph.prototype.bit4=function(){for(var t=Math.ceil(this.width/2),e=t%4,r=this.height-1;r>=0;r--){for(var n=this.bottom_up?r:this.height-1-r,i=0;i<t;i++){var a=this.datav.getUint8(this.pos++,!0),s=n*this.width*4+2*i*4,o=a>>4,c=15&a,f=this.palette[o];if(this.data[s]=f.blue,this.data[s+1]=f.green,this.data[s+2]=f.red,this.data[s+3]=255,2*i+1>=this.width)break;f=this.palette[c],this.data[s+4]=f.blue,this.data[s+4+1]=f.green,this.data[s+4+2]=f.red,this.data[s+4+3]=255}e!==0&&(this.pos+=4-e)}},ph.prototype.bit8=function(){for(var t=this.width%4,e=this.height-1;e>=0;e--){for(var r=this.bottom_up?e:this.height-1-e,n=0;n<this.width;n++){var i=this.datav.getUint8(this.pos++,!0),a=r*this.width*4+4*n;if(i<this.palette.length){var s=this.palette[i];this.data[a]=s.red,this.data[a+1]=s.green,this.data[a+2]=s.blue,this.data[a+3]=255}else this.data[a]=255,this.data[a+1]=255,this.data[a+2]=255,this.data[a+3]=255}t!==0&&(this.pos+=4-t)}},ph.prototype.bit15=function(){for(var t=this.width%3,e=parseInt("11111",2),r=this.height-1;r>=0;r--){for(var n=this.bottom_up?r:this.height-1-r,i=0;i<this.width;i++){var a=this.datav.getUint16(this.pos,!0);this.pos+=2;var s=(a&e)/e*255|0,o=(a>>5&e)/e*255|0,c=(a>>10&e)/e*255|0,f=a>>15?255:0,d=n*this.width*4+4*i;this.data[d]=c,this.data[d+1]=o,this.data[d+2]=s,this.data[d+3]=f}this.pos+=t}},ph.prototype.bit16=function(){for(var t=this.width%3,e=parseInt("11111",2),r=parseInt("111111",2),n=this.height-1;n>=0;n--){for(var i=this.bottom_up?n:this.height-1-n,a=0;a<this.width;a++){var s=this.datav.getUint16(this.pos,!0);this.pos+=2;var o=(s&e)/e*255|0,c=(s>>5&r)/r*255|0,f=(s>>11)/e*255|0,d=i*this.width*4+4*a;this.data[d]=f,this.data[d+1]=c,this.data[d+2]=o,this.data[d+3]=255}this.pos+=t}},ph.prototype.bit24=function(){for(var t=this.height-1;t>=0;t--){for(var e=this.bottom_up?t:this.height-1-t,r=0;r<this.width;r++){var n=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),s=e*this.width*4+4*r;this.data[s]=a,this.data[s+1]=i,this.data[s+2]=n,this.data[s+3]=255}this.pos+=this.width%4}},ph.prototype.bit32=function(){for(var t=this.height-1;t>=0;t--)for(var e=this.bottom_up?t:this.height-1-t,r=0;r<this.width;r++){var n=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),o=e*this.width*4+4*r;this.data[o]=a,this.data[o+1]=i,this.data[o+2]=n,this.data[o+3]=s}},ph.prototype.getData=function(){return this.data},(function(t){t.processBMP=function(e,r,n,i){var a=new ph(e,!1),s=a.width,o=a.height,c={data:a.getData(),width:s,height:o},f=new VA(100).encode(c,100);return t.processJPEG.call(this,f,r,n,i)}})(di.API),D9.prototype.getData=function(){return this.data},(function(t){t.processWEBP=function(e,r,n,i){var a=new D9(e),s=a.width,o=a.height,c={data:a.getData(),width:s,height:o},f=new VA(100).encode(c,100);return t.processJPEG.call(this,f,r,n,i)}})(di.API),di.API.processRGBA=function(t,e,r){for(var n=t.data,i=n.length,a=new Uint8Array(i/4*3),s=new Uint8Array(i/4),o=0,c=0,f=0;f<i;f+=4){var d=n[f],m=n[f+1],b=n[f+2],x=n[f+3];a[o++]=d,a[o++]=m,a[o++]=b,s[c++]=x}var E=this.__addimage__.arrayBufferToBinaryString(a);return{alpha:this.__addimage__.arrayBufferToBinaryString(s),data:E,index:e,alias:r,colorSpace:"DeviceRGB",bitsPerComponent:8,width:t.width,height:t.height}},di.API.setLanguage=function(t){return this.internal.languageSettings===void 0&&(this.internal.languageSettings={},this.internal.languageSettings.isSubscribed=!1),{af:"Afrikaans",sq:"Albanian",ar:"Arabic (Standard)","ar-DZ":"Arabic (Algeria)","ar-BH":"Arabic (Bahrain)","ar-EG":"Arabic (Egypt)","ar-IQ":"Arabic (Iraq)","ar-JO":"Arabic (Jordan)","ar-KW":"Arabic (Kuwait)","ar-LB":"Arabic (Lebanon)","ar-LY":"Arabic (Libya)","ar-MA":"Arabic (Morocco)","ar-OM":"Arabic (Oman)","ar-QA":"Arabic (Qatar)","ar-SA":"Arabic (Saudi Arabia)","ar-SY":"Arabic (Syria)","ar-TN":"Arabic (Tunisia)","ar-AE":"Arabic (U.A.E.)","ar-YE":"Arabic (Yemen)",an:"Aragonese",hy:"Armenian",as:"Assamese",ast:"Asturian",az:"Azerbaijani",eu:"Basque",be:"Belarusian",bn:"Bengali",bs:"Bosnian",br:"Breton",bg:"Bulgarian",my:"Burmese",ca:"Catalan",ch:"Chamorro",ce:"Chechen",zh:"Chinese","zh-HK":"Chinese (Hong Kong)","zh-CN":"Chinese (PRC)","zh-SG":"Chinese (Singapore)","zh-TW":"Chinese (Taiwan)",cv:"Chuvash",co:"Corsican",cr:"Cree",hr:"Croatian",cs:"Czech",da:"Danish",nl:"Dutch (Standard)","nl-BE":"Dutch (Belgian)",en:"English","en-AU":"English (Australia)","en-BZ":"English (Belize)","en-CA":"English (Canada)","en-IE":"English (Ireland)","en-JM":"English (Jamaica)","en-NZ":"English (New Zealand)","en-PH":"English (Philippines)","en-ZA":"English (South Africa)","en-TT":"English (Trinidad & Tobago)","en-GB":"English (United Kingdom)","en-US":"English (United States)","en-ZW":"English (Zimbabwe)",eo:"Esperanto",et:"Estonian",fo:"Faeroese",fj:"Fijian",fi:"Finnish",fr:"French (Standard)","fr-BE":"French (Belgium)","fr-CA":"French (Canada)","fr-FR":"French (France)","fr-LU":"French (Luxembourg)","fr-MC":"French (Monaco)","fr-CH":"French (Switzerland)",fy:"Frisian",fur:"Friulian",gd:"Gaelic (Scots)","gd-IE":"Gaelic (Irish)",gl:"Galacian",ka:"Georgian",de:"German (Standard)","de-AT":"German (Austria)","de-DE":"German (Germany)","de-LI":"German (Liechtenstein)","de-LU":"German (Luxembourg)","de-CH":"German (Switzerland)",el:"Greek",gu:"Gujurati",ht:"Haitian",he:"Hebrew",hi:"Hindi",hu:"Hungarian",is:"Icelandic",id:"Indonesian",iu:"Inuktitut",ga:"Irish",it:"Italian (Standard)","it-CH":"Italian (Switzerland)",ja:"Japanese",kn:"Kannada",ks:"Kashmiri",kk:"Kazakh",km:"Khmer",ky:"Kirghiz",tlh:"Klingon",ko:"Korean","ko-KP":"Korean (North Korea)","ko-KR":"Korean (South Korea)",la:"Latin",lv:"Latvian",lt:"Lithuanian",lb:"Luxembourgish",mk:"North Macedonia",ms:"Malay",ml:"Malayalam",mt:"Maltese",mi:"Maori",mr:"Marathi",mo:"Moldavian",nv:"Navajo",ng:"Ndonga",ne:"Nepali",no:"Norwegian",nb:"Norwegian (Bokmal)",nn:"Norwegian (Nynorsk)",oc:"Occitan",or:"Oriya",om:"Oromo",fa:"Persian","fa-IR":"Persian/Iran",pl:"Polish",pt:"Portuguese","pt-BR":"Portuguese (Brazil)",pa:"Punjabi","pa-IN":"Punjabi (India)","pa-PK":"Punjabi (Pakistan)",qu:"Quechua",rm:"Rhaeto-Romanic",ro:"Romanian","ro-MO":"Romanian (Moldavia)",ru:"Russian","ru-MO":"Russian (Moldavia)",sz:"Sami (Lappish)",sg:"Sango",sa:"Sanskrit",sc:"Sardinian",sd:"Sindhi",si:"Singhalese",sr:"Serbian",sk:"Slovak",sl:"Slovenian",so:"Somani",sb:"Sorbian",es:"Spanish","es-AR":"Spanish (Argentina)","es-BO":"Spanish (Bolivia)","es-CL":"Spanish (Chile)","es-CO":"Spanish (Colombia)","es-CR":"Spanish (Costa Rica)","es-DO":"Spanish (Dominican Republic)","es-EC":"Spanish (Ecuador)","es-SV":"Spanish (El Salvador)","es-GT":"Spanish (Guatemala)","es-HN":"Spanish (Honduras)","es-MX":"Spanish (Mexico)","es-NI":"Spanish (Nicaragua)","es-PA":"Spanish (Panama)","es-PY":"Spanish (Paraguay)","es-PE":"Spanish (Peru)","es-PR":"Spanish (Puerto Rico)","es-ES":"Spanish (Spain)","es-UY":"Spanish (Uruguay)","es-VE":"Spanish (Venezuela)",sx:"Sutu",sw:"Swahili",sv:"Swedish","sv-FI":"Swedish (Finland)","sv-SV":"Swedish (Sweden)",ta:"Tamil",tt:"Tatar",te:"Teluga",th:"Thai",tig:"Tigre",ts:"Tsonga",tn:"Tswana",tr:"Turkish",tk:"Turkmen",uk:"Ukrainian",hsb:"Upper Sorbian",ur:"Urdu",ve:"Venda",vi:"Vietnamese",vo:"Volapuk",wa:"Walloon",cy:"Welsh",xh:"Xhosa",ji:"Yiddish",zu:"Zulu"}[t]!==void 0&&(this.internal.languageSettings.languageCode=t,this.internal.languageSettings.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){this.internal.write("/Lang ("+this.internal.languageSettings.languageCode+")")}),this.internal.languageSettings.isSubscribed=!0)),this},yv=di.API,lw=yv.getCharWidthsArray=function(t,e){var r,n,i=(e=e||{}).font||this.internal.getFont(),a=e.fontSize||this.internal.getFontSize(),s=e.charSpace||this.internal.getCharSpace(),o=e.widths?e.widths:i.metadata.Unicode.widths,c=o.fof?o.fof:1,f=e.kerning?e.kerning:i.metadata.Unicode.kerning,d=f.fof?f.fof:1,m=e.doKerning!==!1,b=0,x=t.length,E=0,T=o[0]||c,A=[];for(r=0;r<x;r++)n=t.charCodeAt(r),typeof i.metadata.widthOfString=="function"?A.push((i.metadata.widthOfGlyph(i.metadata.characterToGlyph(n))+s*(1e3/a)||0)/1e3):(b=m&&ho(f[n])==="object"&&!isNaN(parseInt(f[n][E],10))?f[n][E]/d:0,A.push((o[n]||T)/c+b)),E=n;return A},S9=yv.getStringUnitWidth=function(t,e){var r=(e=e||{}).fontSize||this.internal.getFontSize(),n=e.font||this.internal.getFont(),i=e.charSpace||this.internal.getCharSpace();return yv.processArabic&&(t=yv.processArabic(t)),typeof n.metadata.widthOfString=="function"?n.metadata.widthOfString(t,r,i)/r:lw.apply(this,arguments).reduce(function(a,s){return a+s},0)},E9=function(t,e,r,n){for(var i=[],a=0,s=t.length,o=0;a!==s&&o+e[a]<r;)o+=e[a],a++;i.push(t.slice(0,a));var c=a;for(o=0;a!==s;)o+e[a]>n&&(i.push(t.slice(c,a)),o=0,c=a),o+=e[a],a++;return c!==a&&i.push(t.slice(c,a)),i},T9=function(t,e,r){r||(r={});var n,i,a,s,o,c,f,d=[],m=[d],b=r.textIndent||0,x=0,E=0,T=t.split(" "),A=lw.apply(this,[" ",r])[0];if(c=r.lineIndent===-1?T[0].length+2:r.lineIndent||0){var M=Array(c).join(" "),F=[];T.map(function(O){(O=O.split(/\s*\n/)).length>1?F=F.concat(O.map(function(U,j){return(j&&U.length?`
`:"")+U})):F.push(O[0])}),T=F,c=S9.apply(this,[M,r])}for(a=0,s=T.length;a<s;a++){var N=0;if(n=T[a],c&&n[0]==`
`&&(n=n.substr(1),N=1),b+x+(E=(i=lw.apply(this,[n,r])).reduce(function(O,U){return O+U},0))>e||N){if(E>e){for(o=E9.apply(this,[n,i,e-(b+x),e]),d.push(o.shift()),d=[o.pop()];o.length;)m.push([o.shift()]);E=i.slice(n.length-(d[0]?d[0].length:0)).reduce(function(O,U){return O+U},0)}else d=[n];m.push(d),b=E+c,x=A}else d.push(n),b+=x+E,x=A}return f=c?function(O,U){return(U?M:"")+O.join(" ")}:function(O){return O.join(" ")},m.map(f)},yv.splitTextToSize=function(t,e,r){var n,i=(r=r||{}).fontSize||this.internal.getFontSize(),a=(function(d){if(d.widths&&d.kerning)return{widths:d.widths,kerning:d.kerning};var m=this.internal.getFont(d.fontName,d.fontStyle),b="Unicode";return m.metadata[b]?{widths:m.metadata[b].widths||{0:1},kerning:m.metadata[b].kerning||{}}:{font:m.metadata,fontSize:this.internal.getFontSize(),charSpace:this.internal.getCharSpace()}}).call(this,r);n=Array.isArray(t)?t:String(t).split(/\r?\n/);var s=1*this.internal.scaleFactor*e/i;a.textIndent=r.textIndent?1*r.textIndent*this.internal.scaleFactor/i:0,a.lineIndent=r.lineIndent;var o,c,f=[];for(o=0,c=n.length;o<c;o++)f=f.concat(T9.apply(this,[n[o],s,a]));return f},(function(t){t.__fontmetrics__=t.__fontmetrics__||{};for(var e="0123456789abcdef",r="klmnopqrstuvwxyz",n={},i={},a=0;a<16;a++)n[r[a]]=e[a],i[e[a]]=r[a];var s=function(b){return"0x"+parseInt(b,10).toString(16)},o=t.__fontmetrics__.compress=function(b){var x,E,T,A,M=["{"];for(var F in b){if(x=b[F],isNaN(parseInt(F,10))?E="'"+F+"'":(F=parseInt(F,10),E=(E=s(F).slice(2)).slice(0,-1)+i[E.slice(-1)]),typeof x=="number")x<0?(T=s(x).slice(3),A="-"):(T=s(x).slice(2),A=""),T=A+T.slice(0,-1)+i[T.slice(-1)];else{if(ho(x)!=="object")throw new Error("Don't know what to do with value type "+ho(x)+".");T=o(x)}M.push(E+T)}return M.push("}"),M.join("")},c=t.__fontmetrics__.uncompress=function(b){if(typeof b!="string")throw new Error("Invalid argument passed to uncompress.");for(var x,E,T,A,M={},F=1,N=M,O=[],U="",j="",H=b.length-1,W=1;W<H;W+=1)(A=b[W])=="'"?x?(T=x.join(""),x=void 0):x=[]:x?x.push(A):A=="{"?(O.push([N,T]),N={},T=void 0):A=="}"?((E=O.pop())[0][E[1]]=N,T=void 0,N=E[0]):A=="-"?F=-1:T===void 0?n.hasOwnProperty(A)?(U+=n[A],T=parseInt(U,16)*F,F=1,U=""):U+=A:n.hasOwnProperty(A)?(j+=n[A],N[T]=parseInt(j,16)*F,F=1,T=void 0,j=""):j+=A;return M},f={codePages:["WinAnsiEncoding"],WinAnsiEncoding:c("{19m8n201n9q201o9r201s9l201t9m201u8m201w9n201x9o201y8o202k8q202l8r202m9p202q8p20aw8k203k8t203t8v203u9v2cq8s212m9t15m8w15n9w2dw9s16k8u16l9u17s9z17x8y17y9y}")},d={Unicode:{Courier:f,"Courier-Bold":f,"Courier-BoldOblique":f,"Courier-Oblique":f,Helvetica:f,"Helvetica-Bold":f,"Helvetica-BoldOblique":f,"Helvetica-Oblique":f,"Times-Roman":f,"Times-Bold":f,"Times-BoldItalic":f,"Times-Italic":f}},m={Unicode:{"Courier-Oblique":c("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-BoldItalic":c("{'widths'{k3o2q4ycx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2r202m2n2n3m2o3m2p5n202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5n4l4m4m4m4n4m4o4s4p4m4q4m4r4s4s4y4t2r4u3m4v4m4w3x4x5t4y4s4z4s5k3x5l4s5m4m5n3r5o3x5p4s5q4m5r5t5s4m5t3x5u3x5v2l5w1w5x2l5y3t5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q2l6r3m6s3r6t1w6u1w6v3m6w1w6x4y6y3r6z3m7k3m7l3m7m2r7n2r7o1w7p3r7q2w7r4m7s3m7t2w7u2r7v2n7w1q7x2n7y3t202l3mcl4mal2ram3man3mao3map3mar3mas2lat4uau1uav3maw3way4uaz2lbk2sbl3t'fof'6obo2lbp3tbq3mbr1tbs2lbu1ybv3mbz3mck4m202k3mcm4mcn4mco4mcp4mcq5ycr4mcs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz2w203k6o212m6o2dw2l2cq2l3t3m3u2l17s3x19m3m}'kerning'{cl{4qu5kt5qt5rs17ss5ts}201s{201ss}201t{cks4lscmscnscoscpscls2wu2yu201ts}201x{2wu2yu}2k{201ts}2w{4qx5kx5ou5qx5rs17su5tu}2x{17su5tu5ou}2y{4qx5kx5ou5qx5rs17ss5ts}'fof'-6ofn{17sw5tw5ou5qw5rs}7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qs}3v{17su5tu5os5qs}7p{17su5tu}ck{4qu5kt5qt5rs17ss5ts}4l{4qu5kt5qt5rs17ss5ts}cm{4qu5kt5qt5rs17ss5ts}cn{4qu5kt5qt5rs17ss5ts}co{4qu5kt5qt5rs17ss5ts}cp{4qu5kt5qt5rs17ss5ts}6l{4qu5ou5qw5rt17su5tu}5q{ckuclucmucnucoucpu4lu}5r{ckuclucmucnucoucpu4lu}7q{cksclscmscnscoscps4ls}6p{4qu5ou5qw5rt17sw5tw}ek{4qu5ou5qw5rt17su5tu}el{4qu5ou5qw5rt17su5tu}em{4qu5ou5qw5rt17su5tu}en{4qu5ou5qw5rt17su5tu}eo{4qu5ou5qw5rt17su5tu}ep{4qu5ou5qw5rt17su5tu}es{17ss5ts5qs4qu}et{4qu5ou5qw5rt17sw5tw}eu{4qu5ou5qw5rt17ss5ts}ev{17ss5ts5qs4qu}6z{17sw5tw5ou5qw5rs}fm{17sw5tw5ou5qw5rs}7n{201ts}fo{17sw5tw5ou5qw5rs}fp{17sw5tw5ou5qw5rs}fq{17sw5tw5ou5qw5rs}7r{cksclscmscnscoscps4ls}fs{17sw5tw5ou5qw5rs}ft{17su5tu}fu{17su5tu}fv{17su5tu}fw{17su5tu}fz{cksclscmscnscoscps4ls}}}"),"Helvetica-Bold":c("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),Courier:c("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-BoldOblique":c("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Bold":c("{'widths'{k3q2q5ncx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2l202m2n2n3m2o3m2p6o202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5x4l4s4m4m4n4s4o4s4p4m4q3x4r4y4s4y4t2r4u3m4v4y4w4m4x5y4y4s4z4y5k3x5l4y5m4s5n3r5o4m5p4s5q4s5r6o5s4s5t4s5u4m5v2l5w1w5x2l5y3u5z3m6k2l6l3m6m3r6n2w6o3r6p2w6q2l6r3m6s3r6t1w6u2l6v3r6w1w6x5n6y3r6z3m7k3r7l3r7m2w7n2r7o2l7p3r7q3m7r4s7s3m7t3m7u2w7v2r7w1q7x2r7y3o202l3mcl4sal2lam3man3mao3map3mar3mas2lat4uau1yav3maw3tay4uaz2lbk2sbl3t'fof'6obo2lbp3rbr1tbs2lbu2lbv3mbz3mck4s202k3mcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3rek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3m3u2l17s4s19m3m}'kerning'{cl{4qt5ks5ot5qy5rw17sv5tv}201t{cks4lscmscnscoscpscls4wv}2k{201ts}2w{4qu5ku7mu5os5qx5ru17su5tu}2x{17su5tu5ou5qs}2y{4qv5kv7mu5ot5qz5ru17su5tu}'fof'-6o7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qu}3v{17su5tu5os5qu}fu{17su5tu5ou5qu}7p{17su5tu5ou5qu}ck{4qt5ks5ot5qy5rw17sv5tv}4l{4qt5ks5ot5qy5rw17sv5tv}cm{4qt5ks5ot5qy5rw17sv5tv}cn{4qt5ks5ot5qy5rw17sv5tv}co{4qt5ks5ot5qy5rw17sv5tv}cp{4qt5ks5ot5qy5rw17sv5tv}6l{17st5tt5ou5qu}17s{ckuclucmucnucoucpu4lu4wu}5o{ckuclucmucnucoucpu4lu4wu}5q{ckzclzcmzcnzcozcpz4lz4wu}5r{ckxclxcmxcnxcoxcpx4lx4wu}5t{ckuclucmucnucoucpu4lu4wu}7q{ckuclucmucnucoucpu4lu}6p{17sw5tw5ou5qu}ek{17st5tt5qu}el{17st5tt5ou5qu}em{17st5tt5qu}en{17st5tt5qu}eo{17st5tt5qu}ep{17st5tt5ou5qu}es{17ss5ts5qu}et{17sw5tw5ou5qu}eu{17sw5tw5ou5qu}ev{17ss5ts5qu}6z{17sw5tw5ou5qu5rs}fm{17sw5tw5ou5qu5rs}fn{17sw5tw5ou5qu5rs}fo{17sw5tw5ou5qu5rs}fp{17sw5tw5ou5qu5rs}fq{17sw5tw5ou5qu5rs}7r{cktcltcmtcntcotcpt4lt5os}fs{17sw5tw5ou5qu5rs}ft{17su5tu5ou5qu}7m{5os}fv{17su5tu5ou5qu}fw{17su5tu5ou5qu}fz{cksclscmscnscoscps4ls}}}"),Symbol:c("{'widths'{k3uaw4r19m3m2k1t2l2l202m2y2n3m2p5n202q6o3k3m2s2l2t2l2v3r2w1t3m3m2y1t2z1wbk2sbl3r'fof'6o3n3m3o3m3p3m3q3m3r3m3s3m3t3m3u1w3v1w3w3r3x3r3y3r3z2wbp3t3l3m5v2l5x2l5z3m2q4yfr3r7v3k7w1o7x3k}'kerning'{'fof'-6o}}"),Helvetica:c("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}"),"Helvetica-BoldOblique":c("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),ZapfDingbats:c("{'widths'{k4u2k1w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-Bold":c("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Italic":c("{'widths'{k3n2q4ycx2l201n3m201o5t201s2l201t2l201u2l201w3r201x3r201y3r2k1t2l2l202m2n2n3m2o3m2p5n202q5t2r1p2s2l2t2l2u3m2v4n2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w4n3x4n3y4n3z3m4k5w4l3x4m3x4n4m4o4s4p3x4q3x4r4s4s4s4t2l4u2w4v4m4w3r4x5n4y4m4z4s5k3x5l4s5m3x5n3m5o3r5p4s5q3x5r5n5s3x5t3r5u3r5v2r5w1w5x2r5y2u5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q1w6r3m6s3m6t1w6u1w6v2w6w1w6x4s6y3m6z3m7k3m7l3m7m2r7n2r7o1w7p3m7q2w7r4m7s2w7t2w7u2r7v2s7w1v7x2s7y3q202l3mcl3xal2ram3man3mao3map3mar3mas2lat4wau1vav3maw4nay4waz2lbk2sbl4n'fof'6obo2lbp3mbq3obr1tbs2lbu1zbv3mbz3mck3x202k3mcm3xcn3xco3xcp3xcq5tcr4mcs3xct3xcu3xcv3xcw2l2m2ucy2lcz2ldl4mdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr4nfs3mft3mfu3mfv3mfw3mfz2w203k6o212m6m2dw2l2cq2l3t3m3u2l17s3r19m3m}'kerning'{cl{5kt4qw}201s{201sw}201t{201tw2wy2yy6q-t}201x{2wy2yy}2k{201tw}2w{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}2x{17ss5ts5os}2y{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}'fof'-6o6t{17ss5ts5qs}7t{5os}3v{5qs}7p{17su5tu5qs}ck{5kt4qw}4l{5kt4qw}cm{5kt4qw}cn{5kt4qw}co{5kt4qw}cp{5kt4qw}6l{4qs5ks5ou5qw5ru17su5tu}17s{2ks}5q{ckvclvcmvcnvcovcpv4lv}5r{ckuclucmucnucoucpu4lu}5t{2ks}6p{4qs5ks5ou5qw5ru17su5tu}ek{4qs5ks5ou5qw5ru17su5tu}el{4qs5ks5ou5qw5ru17su5tu}em{4qs5ks5ou5qw5ru17su5tu}en{4qs5ks5ou5qw5ru17su5tu}eo{4qs5ks5ou5qw5ru17su5tu}ep{4qs5ks5ou5qw5ru17su5tu}es{5ks5qs4qs}et{4qs5ks5ou5qw5ru17su5tu}eu{4qs5ks5qw5ru17su5tu}ev{5ks5qs4qs}ex{17ss5ts5qs}6z{4qv5ks5ou5qw5ru17su5tu}fm{4qv5ks5ou5qw5ru17su5tu}fn{4qv5ks5ou5qw5ru17su5tu}fo{4qv5ks5ou5qw5ru17su5tu}fp{4qv5ks5ou5qw5ru17su5tu}fq{4qv5ks5ou5qw5ru17su5tu}7r{5os}fs{4qv5ks5ou5qw5ru17su5tu}ft{17su5tu5qs}fu{17su5tu5qs}fv{17su5tu5qs}fw{17su5tu5qs}}}"),"Times-Roman":c("{'widths'{k3n2q4ycx2l201n3m201o6o201s2l201t2l201u2l201w2w201x2w201y2w2k1t2l2l202m2n2n3m2o3m2p5n202q6o2r1m2s2l2t2l2u3m2v3s2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v1w3w3s3x3s3y3s3z2w4k5w4l4s4m4m4n4m4o4s4p3x4q3r4r4s4s4s4t2l4u2r4v4s4w3x4x5t4y4s4z4s5k3r5l4s5m4m5n3r5o3x5p4s5q4s5r5y5s4s5t4s5u3x5v2l5w1w5x2l5y2z5z3m6k2l6l2w6m3m6n2w6o3m6p2w6q2l6r3m6s3m6t1w6u1w6v3m6w1w6x4y6y3m6z3m7k3m7l3m7m2l7n2r7o1w7p3m7q3m7r4s7s3m7t3m7u2w7v3k7w1o7x3k7y3q202l3mcl4sal2lam3man3mao3map3mar3mas2lat4wau1vav3maw3say4waz2lbk2sbl3s'fof'6obo2lbp3mbq2xbr1tbs2lbu1zbv3mbz2wck4s202k3mcm4scn4sco4scp4scq5tcr4mcs3xct3xcu3xcv3xcw2l2m2tcy2lcz2ldl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek2wel2wem2wen2weo2wep2weq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr3sfs3mft3mfu3mfv3mfw3mfz3m203k6o212m6m2dw2l2cq2l3t3m3u1w17s4s19m3m}'kerning'{cl{4qs5ku17sw5ou5qy5rw201ss5tw201ws}201s{201ss}201t{ckw4lwcmwcnwcowcpwclw4wu201ts}2k{201ts}2w{4qs5kw5os5qx5ru17sx5tx}2x{17sw5tw5ou5qu}2y{4qs5kw5os5qx5ru17sx5tx}'fof'-6o7t{ckuclucmucnucoucpu4lu5os5rs}3u{17su5tu5qs}3v{17su5tu5qs}7p{17sw5tw5qs}ck{4qs5ku17sw5ou5qy5rw201ss5tw201ws}4l{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cm{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cn{4qs5ku17sw5ou5qy5rw201ss5tw201ws}co{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cp{4qs5ku17sw5ou5qy5rw201ss5tw201ws}6l{17su5tu5os5qw5rs}17s{2ktclvcmvcnvcovcpv4lv4wuckv}5o{ckwclwcmwcnwcowcpw4lw4wu}5q{ckyclycmycnycoycpy4ly4wu5ms}5r{cktcltcmtcntcotcpt4lt4ws}5t{2ktclvcmvcnvcovcpv4lv4wuckv}7q{cksclscmscnscoscps4ls}6p{17su5tu5qw5rs}ek{5qs5rs}el{17su5tu5os5qw5rs}em{17su5tu5os5qs5rs}en{17su5qs5rs}eo{5qs5rs}ep{17su5tu5os5qw5rs}es{5qs}et{17su5tu5qw5rs}eu{17su5tu5qs5rs}ev{5qs}6z{17sv5tv5os5qx5rs}fm{5os5qt5rs}fn{17sv5tv5os5qx5rs}fo{17sv5tv5os5qx5rs}fp{5os5qt5rs}fq{5os5qt5rs}7r{ckuclucmucnucoucpu4lu5os}fs{17sv5tv5os5qx5rs}ft{17ss5ts5qs}fu{17sw5tw5qs}fv{17sw5tw5qs}fw{17ss5ts5qs}fz{ckuclucmucnucoucpu4lu5os5rs}}}"),"Helvetica-Oblique":c("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}")}};t.events.push(["addFont",function(b){var x=b.font,E=m.Unicode[x.postScriptName];E&&(x.metadata.Unicode={},x.metadata.Unicode.widths=E.widths,x.metadata.Unicode.kerning=E.kerning);var T=d.Unicode[x.postScriptName];T&&(x.metadata.Unicode.encoding=T,x.encoding=T.codePages[0])}])})(di.API),(function(t){var e=function(r){for(var n=r.length,i=new Uint8Array(n),a=0;a<n;a++)i[a]=r.charCodeAt(a);return i};t.API.events.push(["addFont",function(r){var n=void 0,i=r.font,a=r.instance;if(!i.isStandardFont){if(a===void 0)throw new Error("Font does not exist in vFS, import fonts or remove declaration doc.addFont('"+i.postScriptName+"').");if(typeof(n=a.existsFileInVFS(i.postScriptName)===!1?a.loadFile(i.postScriptName):a.getFileFromVFS(i.postScriptName))!="string")throw new Error("Font is not stored as string-data in vFS, import fonts or remove declaration doc.addFont('"+i.postScriptName+"').");(function(s,o){o=/^\x00\x01\x00\x00/.test(o)?e(o):e(hS(o)),s.metadata=t.API.TTFFont.open(o),s.metadata.Unicode=s.metadata.Unicode||{encoding:{},kerning:{},widths:[]},s.metadata.glyIdsUsed=[0]})(i,n)}}])})(di),di.API.addSvgAsImage=function(t,e,r,n,i,a,s,o){if(isNaN(e)||isNaN(r))throw Ro.error("jsPDF.addSvgAsImage: Invalid coordinates",arguments),new Error("Invalid coordinates passed to jsPDF.addSvgAsImage");if(isNaN(n)||isNaN(i))throw Ro.error("jsPDF.addSvgAsImage: Invalid measurements",arguments),new Error("Invalid measurements (width and/or height) passed to jsPDF.addSvgAsImage");var c=document.createElement("canvas");c.width=n,c.height=i;var f=c.getContext("2d");f.fillStyle="#fff",f.fillRect(0,0,c.width,c.height);var d={ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0},m=this;return(Oi.canvg?Promise.resolve(Oi.canvg):ib(()=>import("./index.es-DmW57HDq.js"),__vite__mapDeps([0,1,2,3,4,5]),import.meta.url)).catch(function(b){return Promise.reject(new Error("Could not load canvg: "+b))}).then(function(b){return b.default?b.default:b}).then(function(b){return b.fromString(f,t,d)},function(){return Promise.reject(new Error("Could not load canvg."))}).then(function(b){return b.render(d)}).then(function(){m.addImage(c.toDataURL("image/jpeg",1),e,r,n,i,s,o)})},di.API.putTotalPages=function(t){var e,r=0;parseInt(this.internal.getFont().id.substr(1),10)<15?(e=new RegExp(t,"g"),r=this.internal.getNumberOfPages()):(e=new RegExp(this.pdfEscape16(t,this.internal.getFont()),"g"),r=this.pdfEscape16(this.internal.getNumberOfPages()+"",this.internal.getFont()));for(var n=1;n<=this.internal.getNumberOfPages();n++)for(var i=0;i<this.internal.pages[n].length;i++)this.internal.pages[n][i]=this.internal.pages[n][i].replace(e,r);return this},di.API.viewerPreferences=function(t,e){var r;t=t||{},e=e||!1;var n,i,a,s={HideToolbar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideMenubar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideWindowUI:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},FitWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},CenterWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},DisplayDocTitle:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.4},NonFullScreenPageMode:{defaultValue:"UseNone",value:"UseNone",type:"name",explicitSet:!1,valueSet:["UseNone","UseOutlines","UseThumbs","UseOC"],pdfVersion:1.3},Direction:{defaultValue:"L2R",value:"L2R",type:"name",explicitSet:!1,valueSet:["L2R","R2L"],pdfVersion:1.3},ViewArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},ViewClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintScaling:{defaultValue:"AppDefault",value:"AppDefault",type:"name",explicitSet:!1,valueSet:["AppDefault","None"],pdfVersion:1.6},Duplex:{defaultValue:"",value:"none",type:"name",explicitSet:!1,valueSet:["Simplex","DuplexFlipShortEdge","DuplexFlipLongEdge","none"],pdfVersion:1.7},PickTrayByPDFSize:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.7},PrintPageRange:{defaultValue:"",value:"",type:"array",explicitSet:!1,valueSet:null,pdfVersion:1.7},NumCopies:{defaultValue:1,value:1,type:"integer",explicitSet:!1,valueSet:null,pdfVersion:1.7}},o=Object.keys(s),c=[],f=0,d=0,m=0;function b(E,T){var A,M=!1;for(A=0;A<E.length;A+=1)E[A]===T&&(M=!0);return M}if(this.internal.viewerpreferences===void 0&&(this.internal.viewerpreferences={},this.internal.viewerpreferences.configuration=JSON.parse(JSON.stringify(s)),this.internal.viewerpreferences.isSubscribed=!1),r=this.internal.viewerpreferences.configuration,t==="reset"||e===!0){var x=o.length;for(m=0;m<x;m+=1)r[o[m]].value=r[o[m]].defaultValue,r[o[m]].explicitSet=!1}if(ho(t)==="object"){for(i in t)if(a=t[i],b(o,i)&&a!==void 0){if(r[i].type==="boolean"&&typeof a=="boolean")r[i].value=a;else if(r[i].type==="name"&&b(r[i].valueSet,a))r[i].value=a;else if(r[i].type==="integer"&&Number.isInteger(a))r[i].value=a;else if(r[i].type==="array"){for(f=0;f<a.length;f+=1)if(n=!0,a[f].length===1&&typeof a[f][0]=="number")c.push(String(a[f]-1));else if(a[f].length>1){for(d=0;d<a[f].length;d+=1)typeof a[f][d]!="number"&&(n=!1);n===!0&&c.push([a[f][0]-1,a[f][1]-1].join(" "))}r[i].value="["+c.join(" ")+"]"}else r[i].value=r[i].defaultValue;r[i].explicitSet=!0}}return this.internal.viewerpreferences.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){var E,T=[];for(E in r)r[E].explicitSet===!0&&(r[E].type==="name"?T.push("/"+E+" /"+r[E].value):T.push("/"+E+" "+r[E].value));T.length!==0&&this.internal.write(`/ViewerPreferences
<<
`+T.join(`
`)+`
>>`)}),this.internal.viewerpreferences.isSubscribed=!0),this.internal.viewerpreferences.configuration=r,this},(function(t){var e=function(){var n='<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"><rdf:Description rdf:about="" xmlns:jspdf="'+this.internal.__metadata__.namespaceuri+'"><jspdf:metadata>',i=unescape(encodeURIComponent('<x:xmpmeta xmlns:x="adobe:ns:meta/">')),a=unescape(encodeURIComponent(n)),s=unescape(encodeURIComponent(this.internal.__metadata__.metadata)),o=unescape(encodeURIComponent("</jspdf:metadata></rdf:Description></rdf:RDF>")),c=unescape(encodeURIComponent("</x:xmpmeta>")),f=a.length+s.length+o.length+i.length+c.length;this.internal.__metadata__.metadata_object_number=this.internal.newObject(),this.internal.write("<< /Type /Metadata /Subtype /XML /Length "+f+" >>"),this.internal.write("stream"),this.internal.write(i+a+s+o+c),this.internal.write("endstream"),this.internal.write("endobj")},r=function(){this.internal.__metadata__.metadata_object_number&&this.internal.write("/Metadata "+this.internal.__metadata__.metadata_object_number+" 0 R")};t.addMetadata=function(n,i){return this.internal.__metadata__===void 0&&(this.internal.__metadata__={metadata:n,namespaceuri:i||"http://jspdf.default.namespaceuri/"},this.internal.events.subscribe("putCatalog",r),this.internal.events.subscribe("postPutResources",e)),this}})(di.API),(function(t){var e=t.API,r=e.pdfEscape16=function(a,s){for(var o,c=s.metadata.Unicode.widths,f=["","0","00","000","0000"],d=[""],m=0,b=a.length;m<b;++m){if(o=s.metadata.characterToGlyph(a.charCodeAt(m)),s.metadata.glyIdsUsed.push(o),s.metadata.toUnicode[o]=a.charCodeAt(m),c.indexOf(o)==-1&&(c.push(o),c.push([parseInt(s.metadata.widthOfGlyph(o),10)])),o=="0")return d.join("");o=o.toString(16),d.push(f[4-o.length],o)}return d.join("")},n=function(a){var s,o,c,f,d,m,b;for(d=`/CIDInit /ProcSet findresource begin
12 dict begin
begincmap
/CIDSystemInfo <<
  /Registry (Adobe)
  /Ordering (UCS)
  /Supplement 0
>> def
/CMapName /Adobe-Identity-UCS def
/CMapType 2 def
1 begincodespacerange
<0000><ffff>
endcodespacerange`,c=[],m=0,b=(o=Object.keys(a).sort(function(x,E){return x-E})).length;m<b;m++)s=o[m],c.length>=100&&(d+=`
`+c.length+` beginbfchar
`+c.join(`
`)+`
endbfchar`,c=[]),a[s]!==void 0&&a[s]!==null&&typeof a[s].toString=="function"&&(f=("0000"+a[s].toString(16)).slice(-4),s=("0000"+(+s).toString(16)).slice(-4),c.push("<"+s+"><"+f+">"));return c.length&&(d+=`
`+c.length+` beginbfchar
`+c.join(`
`)+`
endbfchar
`),d+`endcmap
CMapName currentdict /CMap defineresource pop
end
end`};e.events.push(["putFont",function(a){(function(s){var o=s.font,c=s.out,f=s.newObject,d=s.putStream;if(o.metadata instanceof t.API.TTFFont&&o.encoding==="Identity-H"){for(var m=o.metadata.Unicode.widths,b=o.metadata.subset.encode(o.metadata.glyIdsUsed,1),x="",E=0;E<b.length;E++)x+=String.fromCharCode(b[E]);var T=f();d({data:x,addLength1:!0,objectId:T}),c("endobj");var A=f();d({data:n(o.metadata.toUnicode),addLength1:!0,objectId:A}),c("endobj");var M=f();c("<<"),c("/Type /FontDescriptor"),c("/FontName /"+zv(o.fontName)),c("/FontFile2 "+T+" 0 R"),c("/FontBBox "+t.API.PDFObject.convert(o.metadata.bbox)),c("/Flags "+o.metadata.flags),c("/StemV "+o.metadata.stemV),c("/ItalicAngle "+o.metadata.italicAngle),c("/Ascent "+o.metadata.ascender),c("/Descent "+o.metadata.decender),c("/CapHeight "+o.metadata.capHeight),c(">>"),c("endobj");var F=f();c("<<"),c("/Type /Font"),c("/BaseFont /"+zv(o.fontName)),c("/FontDescriptor "+M+" 0 R"),c("/W "+t.API.PDFObject.convert(m)),c("/CIDToGIDMap /Identity"),c("/DW 1000"),c("/Subtype /CIDFontType2"),c("/CIDSystemInfo"),c("<<"),c("/Supplement 0"),c("/Registry (Adobe)"),c("/Ordering ("+o.encoding+")"),c(">>"),c(">>"),c("endobj"),o.objectNumber=f(),c("<<"),c("/Type /Font"),c("/Subtype /Type0"),c("/ToUnicode "+A+" 0 R"),c("/BaseFont /"+zv(o.fontName)),c("/Encoding /"+o.encoding),c("/DescendantFonts ["+F+" 0 R]"),c(">>"),c("endobj"),o.isAlreadyPutted=!0}})(a)}]),e.events.push(["putFont",function(a){(function(s){var o=s.font,c=s.out,f=s.newObject,d=s.putStream;if(o.metadata instanceof t.API.TTFFont&&o.encoding==="WinAnsiEncoding"){for(var m=o.metadata.rawData,b="",x=0;x<m.length;x++)b+=String.fromCharCode(m[x]);var E=f();d({data:b,addLength1:!0,objectId:E}),c("endobj");var T=f();d({data:n(o.metadata.toUnicode),addLength1:!0,objectId:T}),c("endobj");var A=f();c("<<"),c("/Descent "+o.metadata.decender),c("/CapHeight "+o.metadata.capHeight),c("/StemV "+o.metadata.stemV),c("/Type /FontDescriptor"),c("/FontFile2 "+E+" 0 R"),c("/Flags 96"),c("/FontBBox "+t.API.PDFObject.convert(o.metadata.bbox)),c("/FontName /"+zv(o.fontName)),c("/ItalicAngle "+o.metadata.italicAngle),c("/Ascent "+o.metadata.ascender),c(">>"),c("endobj"),o.objectNumber=f();for(var M=0;M<o.metadata.hmtx.widths.length;M++)o.metadata.hmtx.widths[M]=parseInt(o.metadata.hmtx.widths[M]*(1e3/o.metadata.head.unitsPerEm));c("<</Subtype/TrueType/Type/Font/ToUnicode "+T+" 0 R/BaseFont/"+zv(o.fontName)+"/FontDescriptor "+A+" 0 R/Encoding/"+o.encoding+" /FirstChar 29 /LastChar 255 /Widths "+t.API.PDFObject.convert(o.metadata.hmtx.widths)+">>"),c("endobj"),o.isAlreadyPutted=!0}})(a)}]);var i=function(a){var s,o=a.text||"",c=a.x,f=a.y,d=a.options||{},m=a.mutex||{},b=m.pdfEscape,x=m.activeFontKey,E=m.fonts,T=x,A="",M=0,F="",N=E[T].encoding;if(E[T].encoding!=="Identity-H")return{text:o,x:c,y:f,options:d,mutex:m};for(F=o,T=x,Array.isArray(o)&&(F=o[0]),M=0;M<F.length;M+=1)E[T].metadata.hasOwnProperty("cmap")&&(s=E[T].metadata.cmap.unicode.codeMap[F[M].charCodeAt(0)]),s||F[M].charCodeAt(0)<256&&E[T].metadata.hasOwnProperty("Unicode")?A+=F[M]:A+="";var O="";return parseInt(T.slice(1))<14||N==="WinAnsiEncoding"?O=b(A,T).split("").map(function(U){return U.charCodeAt(0).toString(16)}).join(""):N==="Identity-H"&&(O=r(A,E[T])),m.isHex=!0,{text:O,x:c,y:f,options:d,mutex:m}};e.events.push(["postProcessText",function(a){var s=a.text||"",o=[],c={text:s,x:a.x,y:a.y,options:a.options,mutex:a.mutex};if(Array.isArray(s)){var f=0;for(f=0;f<s.length;f+=1)Array.isArray(s[f])&&s[f].length===3?o.push([i(Object.assign({},c,{text:s[f][0]})).text,s[f][1],s[f][2]]):o.push(i(Object.assign({},c,{text:s[f]})).text);a.text=o}else a.text=i(Object.assign({},c,{text:s})).text}])})(di),(function(t){var e=function(){return this.internal.vFS===void 0&&(this.internal.vFS={}),!0};t.existsFileInVFS=function(r){return e.call(this),this.internal.vFS[r]!==void 0},t.addFileToVFS=function(r,n){return e.call(this),this.internal.vFS[r]=n,this},t.getFileFromVFS=function(r){return e.call(this),this.internal.vFS[r]!==void 0?this.internal.vFS[r]:null}})(di.API),(function(t){t.__bidiEngine__=t.prototype.__bidiEngine__=function(n){var i,a,s,o,c,f,d,m=e,b=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],x=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],E={L:0,R:1,EN:2,AN:3,N:4,B:5,S:6},T={0:0,5:1,6:2,7:3,32:4,251:5,254:6,255:7},A=["(",")","(","<",">","<","[","]","[","{","}","{","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],M=new RegExp(/^([1-4|9]|1[0-9]|2[0-9]|3[0168]|4[04589]|5[012]|7[78]|159|16[0-9]|17[0-2]|21[569]|22[03489]|250)$/),F=!1,N=0;this.__bidiEngine__={};var O=function(Q){var G=Q.charCodeAt(),ae=G>>8,se=T[ae];return se!==void 0?m[256*se+(255&G)]:ae===252||ae===253?"AL":M.test(ae)?"L":ae===8?"R":"N"},U=function(Q){for(var G,ae=0;ae<Q.length;ae++){if((G=O(Q.charAt(ae)))==="L")return!1;if(G==="R")return!0}return!1},j=function(Q,G,ae,se){var fe,_e,Le,ye,Te=G[se];switch(Te){case"L":case"R":case"LRE":case"RLE":case"LRO":case"RLO":case"PDF":F=!1;break;case"N":case"AN":break;case"EN":F&&(Te="AN");break;case"AL":F=!0,Te="R";break;case"WS":case"BN":Te="N";break;case"CS":se<1||se+1>=G.length||(fe=ae[se-1])!=="EN"&&fe!=="AN"||(_e=G[se+1])!=="EN"&&_e!=="AN"?Te="N":F&&(_e="AN"),Te=_e===fe?_e:"N";break;case"ES":Te=(fe=se>0?ae[se-1]:"B")==="EN"&&se+1<G.length&&G[se+1]==="EN"?"EN":"N";break;case"ET":if(se>0&&ae[se-1]==="EN"){Te="EN";break}if(F){Te="N";break}for(Le=se+1,ye=G.length;Le<ye&&G[Le]==="ET";)Le++;Te=Le<ye&&G[Le]==="EN"?"EN":"N";break;case"NSM":if(s&&!o){for(ye=G.length,Le=se+1;Le<ye&&G[Le]==="NSM";)Le++;if(Le<ye){var Ie=Q[se],Me=Ie>=1425&&Ie<=2303||Ie===64286;if(fe=G[Le],Me&&(fe==="R"||fe==="AL")){Te="R";break}}}Te=se<1||(fe=G[se-1])==="B"?"N":ae[se-1];break;case"B":F=!1,i=!0,Te=N;break;case"S":a=!0,Te="N"}return Te},H=function(Q,G,ae){var se=Q.split("");return ae&&W(se,ae,{hiLevel:N}),se.reverse(),G&&G.reverse(),se.join("")},W=function(Q,G,ae){var se,fe,_e,Le,ye,Te=-1,Ie=Q.length,Me=0,de=[],Se=N?x:b,we=[];for(F=!1,i=!1,a=!1,fe=0;fe<Ie;fe++)we[fe]=O(Q[fe]);for(_e=0;_e<Ie;_e++){if(ye=Me,de[_e]=j(Q,we,de,_e),se=240&(Me=Se[ye][E[de[_e]]]),Me&=15,G[_e]=Le=Se[Me][5],se>0)if(se===16){for(fe=Te;fe<_e;fe++)G[fe]=1;Te=-1}else Te=-1;if(Se[Me][6])Te===-1&&(Te=_e);else if(Te>-1){for(fe=Te;fe<_e;fe++)G[fe]=Le;Te=-1}we[_e]==="B"&&(G[_e]=0),ae.hiLevel|=Le}a&&(function(De,Fe,Xe){for(var Be=0;Be<Xe;Be++)if(De[Be]==="S"){Fe[Be]=N;for(var st=Be-1;st>=0&&De[st]==="WS";st--)Fe[st]=N}})(we,G,Ie)},X=function(Q,G,ae,se,fe){if(!(fe.hiLevel<Q)){if(Q===1&&N===1&&!i)return G.reverse(),void(ae&&ae.reverse());for(var _e,Le,ye,Te,Ie=G.length,Me=0;Me<Ie;){if(se[Me]>=Q){for(ye=Me+1;ye<Ie&&se[ye]>=Q;)ye++;for(Te=Me,Le=ye-1;Te<Le;Te++,Le--)_e=G[Te],G[Te]=G[Le],G[Le]=_e,ae&&(_e=ae[Te],ae[Te]=ae[Le],ae[Le]=_e);Me=ye}Me++}}},oe=function(Q,G,ae){var se=Q.split(""),fe={hiLevel:N};return ae||(ae=[]),W(se,ae,fe),(function(_e,Le,ye){if(ye.hiLevel!==0&&d)for(var Te,Ie=0;Ie<_e.length;Ie++)Le[Ie]===1&&(Te=A.indexOf(_e[Ie]))>=0&&(_e[Ie]=A[Te+1])})(se,ae,fe),X(2,se,G,ae,fe),X(1,se,G,ae,fe),se.join("")};return this.__bidiEngine__.doBidiReorder=function(Q,G,ae){if((function(fe,_e){if(_e)for(var Le=0;Le<fe.length;Le++)_e[Le]=Le;o===void 0&&(o=U(fe)),f===void 0&&(f=U(fe))})(Q,G),s||!c||f)if(s&&c&&o^f)N=o?1:0,Q=H(Q,G,ae);else if(!s&&c&&f)N=o?1:0,Q=oe(Q,G,ae),Q=H(Q,G);else if(!s||o||c||f){if(s&&!c&&o^f)Q=H(Q,G),o?(N=0,Q=oe(Q,G,ae)):(N=1,Q=oe(Q,G,ae),Q=H(Q,G));else if(s&&o&&!c&&f)N=1,Q=oe(Q,G,ae),Q=H(Q,G);else if(!s&&!c&&o^f){var se=d;o?(N=1,Q=oe(Q,G,ae),N=0,d=!1,Q=oe(Q,G,ae),d=se):(N=0,Q=oe(Q,G,ae),Q=H(Q,G),N=1,d=!1,Q=oe(Q,G,ae),d=se,Q=H(Q,G))}}else N=0,Q=oe(Q,G,ae);else N=o?1:0,Q=oe(Q,G,ae);return Q},this.__bidiEngine__.setOptions=function(Q){Q&&(s=Q.isInputVisual,c=Q.isOutputVisual,o=Q.isInputRtl,f=Q.isOutputRtl,d=Q.isSymmetricSwapping)},this.__bidiEngine__.setOptions(n),this.__bidiEngine__};var e=["BN","BN","BN","BN","BN","BN","BN","BN","BN","S","B","S","WS","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","B","B","B","S","WS","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","BN","BN","BN","BN","BN","BN","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","CS","N","ET","ET","ET","ET","N","N","N","N","L","N","N","BN","N","N","ET","ET","EN","EN","N","L","N","N","N","EN","L","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","N","N","N","N","N","ET","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","NSM","R","NSM","NSM","R","NSM","NSM","R","NSM","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","N","N","N","N","N","R","R","R","R","R","N","N","N","N","N","N","N","N","N","N","N","AN","AN","AN","AN","AN","AN","N","N","AL","ET","ET","AL","CS","AL","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","AN","AN","AN","AN","AN","AN","AN","AN","AN","ET","AN","AN","AL","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","N","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","NSM","NSM","N","NSM","NSM","NSM","NSM","AL","AL","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","R","N","N","N","N","R","N","N","N","N","N","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","BN","BN","BN","L","R","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","B","LRE","RLE","PDF","LRO","RLO","CS","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","BN","BN","BN","BN","BN","N","LRI","RLI","FSI","PDI","BN","BN","BN","BN","BN","BN","EN","L","N","N","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","L","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","N","N","N","N","N","R","NSM","R","R","R","R","R","R","R","R","R","R","ES","R","R","R","R","R","R","R","R","R","R","R","R","R","N","R","R","R","R","R","N","R","N","R","R","N","R","R","N","R","R","R","R","R","R","R","R","R","R","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","CS","N","N","CS","N","N","N","N","N","N","N","N","N","ET","N","N","ES","ES","N","N","N","N","N","ET","ET","N","N","N","N","N","AL","AL","AL","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","BN","N","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","N","N","N","ET","ET","N","N","N","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N"],r=new t.__bidiEngine__({isInputVisual:!0});t.API.events.push(["postProcessText",function(n){var i=n.text;n.x,n.y;var a=n.options||{};n.mutex,a.lang;var s=[];if(a.isInputVisual=typeof a.isInputVisual!="boolean"||a.isInputVisual,r.setOptions(a),Object.prototype.toString.call(i)==="[object Array]"){var o=0;for(s=[],o=0;o<i.length;o+=1)Object.prototype.toString.call(i[o])==="[object Array]"?s.push([r.doBidiReorder(i[o][0]),i[o][1],i[o][2]]):s.push([r.doBidiReorder(i[o])]);n.text=s}else n.text=r.doBidiReorder(i);r.setOptions({isInputVisual:!0})}])})(di),di.API.TTFFont=(function(){function t(e){var r;if(this.rawData=e,r=this.contents=new Tg(e),this.contents.pos=4,r.readString(4)==="ttcf")throw new Error("TTCF not supported.");r.pos=0,this.parse(),this.subset=new S_e(this),this.registerTTF()}return t.open=function(e){return new t(e)},t.prototype.parse=function(){return this.directory=new u_e(this.contents),this.head=new f_e(this),this.name=new m_e(this),this.cmap=new yZ(this),this.toUnicode={},this.hhea=new h_e(this),this.maxp=new y_e(this),this.hmtx=new v_e(this),this.post=new p_e(this),this.os2=new d_e(this),this.loca=new w_e(this),this.glyf=new __e(this),this.ascender=this.os2.exists&&this.os2.ascender||this.hhea.ascender,this.decender=this.os2.exists&&this.os2.decender||this.hhea.decender,this.lineGap=this.os2.exists&&this.os2.lineGap||this.hhea.lineGap,this.bbox=[this.head.xMin,this.head.yMin,this.head.xMax,this.head.yMax]},t.prototype.registerTTF=function(){var e,r,n,i,a;if(this.scaleFactor=1e3/this.head.unitsPerEm,this.bbox=(function(){var s,o,c,f;for(f=[],s=0,o=(c=this.bbox).length;s<o;s++)e=c[s],f.push(Math.round(e*this.scaleFactor));return f}).call(this),this.stemV=0,this.post.exists?(n=255&(i=this.post.italic_angle),32768&(r=i>>16)&&(r=-(1+(65535^r))),this.italicAngle=+(r+"."+n)):this.italicAngle=0,this.ascender=Math.round(this.ascender*this.scaleFactor),this.decender=Math.round(this.decender*this.scaleFactor),this.lineGap=Math.round(this.lineGap*this.scaleFactor),this.capHeight=this.os2.exists&&this.os2.capHeight||this.ascender,this.xHeight=this.os2.exists&&this.os2.xHeight||0,this.familyClass=(this.os2.exists&&this.os2.familyClass||0)>>8,this.isSerif=(a=this.familyClass)===1||a===2||a===3||a===4||a===5||a===7,this.isScript=this.familyClass===10,this.flags=0,this.post.isFixedPitch&&(this.flags|=1),this.isSerif&&(this.flags|=2),this.isScript&&(this.flags|=8),this.italicAngle!==0&&(this.flags|=64),this.flags|=32,!this.cmap.unicode)throw new Error("No unicode cmap for font")},t.prototype.characterToGlyph=function(e){var r;return((r=this.cmap.unicode)!=null?r.codeMap[e]:void 0)||0},t.prototype.widthOfGlyph=function(e){var r;return r=1e3/this.head.unitsPerEm,this.hmtx.forGlyph(e).advance*r},t.prototype.widthOfString=function(e,r,n){var i,a,s,o;for(s=0,a=0,o=(e=""+e).length;0<=o?a<o:a>o;a=0<=o?++a:--a)i=e.charCodeAt(a),s+=this.widthOfGlyph(this.characterToGlyph(i))+n*(1e3/r)||0;return s*(r/1e3)},t.prototype.lineHeight=function(e,r){var n;return r==null&&(r=!1),n=r?this.lineGap:0,(this.ascender+n-this.decender)/1e3*e},t})();var Oh,Tg=(function(){function t(e){this.data=e??[],this.pos=0,this.length=this.data.length}return t.prototype.readByte=function(){return this.data[this.pos++]},t.prototype.writeByte=function(e){return this.data[this.pos++]=e},t.prototype.readUInt32=function(){return 16777216*this.readByte()+(this.readByte()<<16)+(this.readByte()<<8)+this.readByte()},t.prototype.writeUInt32=function(e){return this.writeByte(e>>>24&255),this.writeByte(e>>16&255),this.writeByte(e>>8&255),this.writeByte(255&e)},t.prototype.readInt32=function(){var e;return(e=this.readUInt32())>=2147483648?e-4294967296:e},t.prototype.writeInt32=function(e){return e<0&&(e+=4294967296),this.writeUInt32(e)},t.prototype.readUInt16=function(){return this.readByte()<<8|this.readByte()},t.prototype.writeUInt16=function(e){return this.writeByte(e>>8&255),this.writeByte(255&e)},t.prototype.readInt16=function(){var e;return(e=this.readUInt16())>=32768?e-65536:e},t.prototype.writeInt16=function(e){return e<0&&(e+=65536),this.writeUInt16(e)},t.prototype.readString=function(e){var r,n;for(n=[],r=0;0<=e?r<e:r>e;r=0<=e?++r:--r)n[r]=String.fromCharCode(this.readByte());return n.join("")},t.prototype.writeString=function(e){var r,n,i;for(i=[],r=0,n=e.length;0<=n?r<n:r>n;r=0<=n?++r:--r)i.push(this.writeByte(e.charCodeAt(r)));return i},t.prototype.readShort=function(){return this.readInt16()},t.prototype.writeShort=function(e){return this.writeInt16(e)},t.prototype.readLongLong=function(){var e,r,n,i,a,s,o,c;return e=this.readByte(),r=this.readByte(),n=this.readByte(),i=this.readByte(),a=this.readByte(),s=this.readByte(),o=this.readByte(),c=this.readByte(),128&e?-1*(72057594037927940*(255^e)+281474976710656*(255^r)+1099511627776*(255^n)+4294967296*(255^i)+16777216*(255^a)+65536*(255^s)+256*(255^o)+(255^c)+1):72057594037927940*e+281474976710656*r+1099511627776*n+4294967296*i+16777216*a+65536*s+256*o+c},t.prototype.writeLongLong=function(e){var r,n;return r=Math.floor(e/4294967296),n=4294967295&e,this.writeByte(r>>24&255),this.writeByte(r>>16&255),this.writeByte(r>>8&255),this.writeByte(255&r),this.writeByte(n>>24&255),this.writeByte(n>>16&255),this.writeByte(n>>8&255),this.writeByte(255&n)},t.prototype.readInt=function(){return this.readInt32()},t.prototype.writeInt=function(e){return this.writeInt32(e)},t.prototype.read=function(e){var r,n;for(r=[],n=0;0<=e?n<e:n>e;n=0<=e?++n:--n)r.push(this.readByte());return r},t.prototype.write=function(e){var r,n,i,a;for(a=[],n=0,i=e.length;n<i;n++)r=e[n],a.push(this.writeByte(r));return a},t})(),u_e=(function(){var t;function e(r){var n,i,a;for(this.scalarType=r.readInt(),this.tableCount=r.readShort(),this.searchRange=r.readShort(),this.entrySelector=r.readShort(),this.rangeShift=r.readShort(),this.tables={},i=0,a=this.tableCount;0<=a?i<a:i>a;i=0<=a?++i:--i)n={tag:r.readString(4),checksum:r.readInt(),offset:r.readInt(),length:r.readInt()},this.tables[n.tag]=n}return e.prototype.encode=function(r){var n,i,a,s,o,c,f,d,m,b,x,E,T;for(T in x=Object.keys(r).length,c=Math.log(2),m=16*Math.floor(Math.log(x)/c),s=Math.floor(m/c),d=16*x-m,(i=new Tg).writeInt(this.scalarType),i.writeShort(x),i.writeShort(m),i.writeShort(s),i.writeShort(d),a=16*x,f=i.pos+a,o=null,E=[],r)for(b=r[T],i.writeString(T),i.writeInt(t(b)),i.writeInt(f),i.writeInt(b.length),E=E.concat(b),T==="head"&&(o=f),f+=b.length;f%4;)E.push(0),f++;return i.write(E),n=2981146554-t(i.data),i.pos=o+8,i.writeUInt32(n),i.data},t=function(r){var n,i,a,s;for(r=vZ.call(r);r.length%4;)r.push(0);for(a=new Tg(r),i=0,n=0,s=r.length;n<s;n=n+=4)i+=a.readUInt32();return 4294967295&i},e})(),c_e={}.hasOwnProperty,kd=function(t,e){for(var r in e)c_e.call(e,r)&&(t[r]=e[r]);function n(){this.constructor=t}return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};Oh=(function(){function t(e){var r;this.file=e,r=this.file.directory.tables[this.tag],this.exists=!!r,r&&(this.offset=r.offset,this.length=r.length,this.parse(this.file.contents))}return t.prototype.parse=function(){},t.prototype.encode=function(){},t.prototype.raw=function(){return this.exists?(this.file.contents.pos=this.offset,this.file.contents.read(this.length)):null},t})();var f_e=(function(){function t(){return t.__super__.constructor.apply(this,arguments)}return kd(t,Oh),t.prototype.tag="head",t.prototype.parse=function(e){return e.pos=this.offset,this.version=e.readInt(),this.revision=e.readInt(),this.checkSumAdjustment=e.readInt(),this.magicNumber=e.readInt(),this.flags=e.readShort(),this.unitsPerEm=e.readShort(),this.created=e.readLongLong(),this.modified=e.readLongLong(),this.xMin=e.readShort(),this.yMin=e.readShort(),this.xMax=e.readShort(),this.yMax=e.readShort(),this.macStyle=e.readShort(),this.lowestRecPPEM=e.readShort(),this.fontDirectionHint=e.readShort(),this.indexToLocFormat=e.readShort(),this.glyphDataFormat=e.readShort()},t.prototype.encode=function(e){var r;return(r=new Tg).writeInt(this.version),r.writeInt(this.revision),r.writeInt(this.checkSumAdjustment),r.writeInt(this.magicNumber),r.writeShort(this.flags),r.writeShort(this.unitsPerEm),r.writeLongLong(this.created),r.writeLongLong(this.modified),r.writeShort(this.xMin),r.writeShort(this.yMin),r.writeShort(this.xMax),r.writeShort(this.yMax),r.writeShort(this.macStyle),r.writeShort(this.lowestRecPPEM),r.writeShort(this.fontDirectionHint),r.writeShort(e),r.writeShort(this.glyphDataFormat),r.data},t})(),O9=(function(){function t(e,r){var n,i,a,s,o,c,f,d,m,b,x,E,T,A,M,F,N;switch(this.platformID=e.readUInt16(),this.encodingID=e.readShort(),this.offset=r+e.readInt(),m=e.pos,e.pos=this.offset,this.format=e.readUInt16(),this.length=e.readUInt16(),this.language=e.readUInt16(),this.isUnicode=this.platformID===3&&this.encodingID===1&&this.format===4||this.platformID===0&&this.format===4,this.codeMap={},this.format){case 0:for(c=0;c<256;++c)this.codeMap[c]=e.readByte();break;case 4:for(x=e.readUInt16(),b=x/2,e.pos+=6,a=(function(){var O,U;for(U=[],c=O=0;0<=b?O<b:O>b;c=0<=b?++O:--O)U.push(e.readUInt16());return U})(),e.pos+=2,T=(function(){var O,U;for(U=[],c=O=0;0<=b?O<b:O>b;c=0<=b?++O:--O)U.push(e.readUInt16());return U})(),f=(function(){var O,U;for(U=[],c=O=0;0<=b?O<b:O>b;c=0<=b?++O:--O)U.push(e.readUInt16());return U})(),d=(function(){var O,U;for(U=[],c=O=0;0<=b?O<b:O>b;c=0<=b?++O:--O)U.push(e.readUInt16());return U})(),i=(this.length-e.pos+this.offset)/2,o=(function(){var O,U;for(U=[],c=O=0;0<=i?O<i:O>i;c=0<=i?++O:--O)U.push(e.readUInt16());return U})(),c=M=0,N=a.length;M<N;c=++M)for(A=a[c],n=F=E=T[c];E<=A?F<=A:F>=A;n=E<=A?++F:--F)d[c]===0?s=n+f[c]:(s=o[d[c]/2+(n-E)-(b-c)]||0)!==0&&(s+=f[c]),this.codeMap[n]=65535&s}e.pos=m}return t.encode=function(e,r){var n,i,a,s,o,c,f,d,m,b,x,E,T,A,M,F,N,O,U,j,H,W,X,oe,Q,G,ae,se,fe,_e,Le,ye,Te,Ie,Me,de,Se,we,De,Fe,Xe,Be,st,Qe,it,be;switch(se=new Tg,s=Object.keys(e).sort(function(Ot,at){return Ot-at}),r){case"macroman":for(T=0,A=(function(){var Ot=[];for(E=0;E<256;++E)Ot.push(0);return Ot})(),F={0:0},a={},fe=0,Te=s.length;fe<Te;fe++)F[st=e[i=s[fe]]]==null&&(F[st]=++T),a[i]={old:e[i],new:F[e[i]]},A[i]=F[e[i]];return se.writeUInt16(1),se.writeUInt16(0),se.writeUInt32(12),se.writeUInt16(0),se.writeUInt16(262),se.writeUInt16(0),se.write(A),{charMap:a,subtable:se.data,maxGlyphID:T+1};case"unicode":for(G=[],m=[],N=0,F={},n={},M=f=null,_e=0,Ie=s.length;_e<Ie;_e++)F[U=e[i=s[_e]]]==null&&(F[U]=++N),n[i]={old:U,new:F[U]},o=F[U]-i,M!=null&&o===f||(M&&m.push(M),G.push(i),f=o),M=i;for(M&&m.push(M),m.push(65535),G.push(65535),oe=2*(X=G.length),W=2*Math.pow(Math.log(X)/Math.LN2,2),b=Math.log(W/2)/Math.LN2,H=2*X-W,c=[],j=[],x=[],E=Le=0,Me=G.length;Le<Me;E=++Le){if(Q=G[E],d=m[E],Q===65535){c.push(0),j.push(0);break}if(Q-(ae=n[Q].new)>=32768)for(c.push(0),j.push(2*(x.length+X-E)),i=ye=Q;Q<=d?ye<=d:ye>=d;i=Q<=d?++ye:--ye)x.push(n[i].new);else c.push(ae-Q),j.push(0)}for(se.writeUInt16(3),se.writeUInt16(1),se.writeUInt32(12),se.writeUInt16(4),se.writeUInt16(16+8*X+2*x.length),se.writeUInt16(0),se.writeUInt16(oe),se.writeUInt16(W),se.writeUInt16(b),se.writeUInt16(H),Xe=0,de=m.length;Xe<de;Xe++)i=m[Xe],se.writeUInt16(i);for(se.writeUInt16(0),Be=0,Se=G.length;Be<Se;Be++)i=G[Be],se.writeUInt16(i);for(Qe=0,we=c.length;Qe<we;Qe++)o=c[Qe],se.writeUInt16(o);for(it=0,De=j.length;it<De;it++)O=j[it],se.writeUInt16(O);for(be=0,Fe=x.length;be<Fe;be++)T=x[be],se.writeUInt16(T);return{charMap:n,subtable:se.data,maxGlyphID:N+1}}},t})(),yZ=(function(){function t(){return t.__super__.constructor.apply(this,arguments)}return kd(t,Oh),t.prototype.tag="cmap",t.prototype.parse=function(e){var r,n,i;for(e.pos=this.offset,this.version=e.readUInt16(),i=e.readUInt16(),this.tables=[],this.unicode=null,n=0;0<=i?n<i:n>i;n=0<=i?++n:--n)r=new O9(e,this.offset),this.tables.push(r),r.isUnicode&&this.unicode==null&&(this.unicode=r);return!0},t.encode=function(e,r){var n,i;return r==null&&(r="macroman"),n=O9.encode(e,r),(i=new Tg).writeUInt16(0),i.writeUInt16(1),n.table=i.data.concat(n.subtable),n},t})(),h_e=(function(){function t(){return t.__super__.constructor.apply(this,arguments)}return kd(t,Oh),t.prototype.tag="hhea",t.prototype.parse=function(e){return e.pos=this.offset,this.version=e.readInt(),this.ascender=e.readShort(),this.decender=e.readShort(),this.lineGap=e.readShort(),this.advanceWidthMax=e.readShort(),this.minLeftSideBearing=e.readShort(),this.minRightSideBearing=e.readShort(),this.xMaxExtent=e.readShort(),this.caretSlopeRise=e.readShort(),this.caretSlopeRun=e.readShort(),this.caretOffset=e.readShort(),e.pos+=8,this.metricDataFormat=e.readShort(),this.numberOfMetrics=e.readUInt16()},t})(),d_e=(function(){function t(){return t.__super__.constructor.apply(this,arguments)}return kd(t,Oh),t.prototype.tag="OS/2",t.prototype.parse=function(e){if(e.pos=this.offset,this.version=e.readUInt16(),this.averageCharWidth=e.readShort(),this.weightClass=e.readUInt16(),this.widthClass=e.readUInt16(),this.type=e.readShort(),this.ySubscriptXSize=e.readShort(),this.ySubscriptYSize=e.readShort(),this.ySubscriptXOffset=e.readShort(),this.ySubscriptYOffset=e.readShort(),this.ySuperscriptXSize=e.readShort(),this.ySuperscriptYSize=e.readShort(),this.ySuperscriptXOffset=e.readShort(),this.ySuperscriptYOffset=e.readShort(),this.yStrikeoutSize=e.readShort(),this.yStrikeoutPosition=e.readShort(),this.familyClass=e.readShort(),this.panose=(function(){var r,n;for(n=[],r=0;r<10;++r)n.push(e.readByte());return n})(),this.charRange=(function(){var r,n;for(n=[],r=0;r<4;++r)n.push(e.readInt());return n})(),this.vendorID=e.readString(4),this.selection=e.readShort(),this.firstCharIndex=e.readShort(),this.lastCharIndex=e.readShort(),this.version>0&&(this.ascent=e.readShort(),this.descent=e.readShort(),this.lineGap=e.readShort(),this.winAscent=e.readShort(),this.winDescent=e.readShort(),this.codePageRange=(function(){var r,n;for(n=[],r=0;r<2;r=++r)n.push(e.readInt());return n})(),this.version>1))return this.xHeight=e.readShort(),this.capHeight=e.readShort(),this.defaultChar=e.readShort(),this.breakChar=e.readShort(),this.maxContext=e.readShort()},t})(),p_e=(function(){function t(){return t.__super__.constructor.apply(this,arguments)}return kd(t,Oh),t.prototype.tag="post",t.prototype.parse=function(e){var r,n,i;switch(e.pos=this.offset,this.format=e.readInt(),this.italicAngle=e.readInt(),this.underlinePosition=e.readShort(),this.underlineThickness=e.readShort(),this.isFixedPitch=e.readInt(),this.minMemType42=e.readInt(),this.maxMemType42=e.readInt(),this.minMemType1=e.readInt(),this.maxMemType1=e.readInt(),this.format){case 65536:case 196608:break;case 131072:var a;for(n=e.readUInt16(),this.glyphNameIndex=[],a=0;0<=n?a<n:a>n;a=0<=n?++a:--a)this.glyphNameIndex.push(e.readUInt16());for(this.names=[],i=[];e.pos<this.offset+this.length;)r=e.readByte(),i.push(this.names.push(e.readString(r)));return i;case 151552:return n=e.readUInt16(),this.offsets=e.read(n);case 262144:return this.map=(function(){var s,o,c;for(c=[],a=s=0,o=this.file.maxp.numGlyphs;0<=o?s<o:s>o;a=0<=o?++s:--s)c.push(e.readUInt32());return c}).call(this)}},t})(),g_e=function(t,e){this.raw=t,this.length=t.length,this.platformID=e.platformID,this.encodingID=e.encodingID,this.languageID=e.languageID},m_e=(function(){function t(){return t.__super__.constructor.apply(this,arguments)}return kd(t,Oh),t.prototype.tag="name",t.prototype.parse=function(e){var r,n,i,a,s,o,c,f,d,m,b;for(e.pos=this.offset,e.readShort(),r=e.readShort(),o=e.readShort(),n=[],a=0;0<=r?a<r:a>r;a=0<=r?++a:--a)n.push({platformID:e.readShort(),encodingID:e.readShort(),languageID:e.readShort(),nameID:e.readShort(),length:e.readShort(),offset:this.offset+o+e.readShort()});for(c={},a=d=0,m=n.length;d<m;a=++d)i=n[a],e.pos=i.offset,f=e.readString(i.length),s=new g_e(f,i),c[b=i.nameID]==null&&(c[b]=[]),c[i.nameID].push(s);this.strings=c,this.copyright=c[0],this.fontFamily=c[1],this.fontSubfamily=c[2],this.uniqueSubfamily=c[3],this.fontName=c[4],this.version=c[5];try{this.postscriptName=c[6][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}catch{this.postscriptName=c[4][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}return this.trademark=c[7],this.manufacturer=c[8],this.designer=c[9],this.description=c[10],this.vendorUrl=c[11],this.designerUrl=c[12],this.license=c[13],this.licenseUrl=c[14],this.preferredFamily=c[15],this.preferredSubfamily=c[17],this.compatibleFull=c[18],this.sampleText=c[19]},t})(),y_e=(function(){function t(){return t.__super__.constructor.apply(this,arguments)}return kd(t,Oh),t.prototype.tag="maxp",t.prototype.parse=function(e){return e.pos=this.offset,this.version=e.readInt(),this.numGlyphs=e.readUInt16(),this.maxPoints=e.readUInt16(),this.maxContours=e.readUInt16(),this.maxCompositePoints=e.readUInt16(),this.maxComponentContours=e.readUInt16(),this.maxZones=e.readUInt16(),this.maxTwilightPoints=e.readUInt16(),this.maxStorage=e.readUInt16(),this.maxFunctionDefs=e.readUInt16(),this.maxInstructionDefs=e.readUInt16(),this.maxStackElements=e.readUInt16(),this.maxSizeOfInstructions=e.readUInt16(),this.maxComponentElements=e.readUInt16(),this.maxComponentDepth=e.readUInt16()},t})(),v_e=(function(){function t(){return t.__super__.constructor.apply(this,arguments)}return kd(t,Oh),t.prototype.tag="hmtx",t.prototype.parse=function(e){var r,n,i,a,s,o,c;for(e.pos=this.offset,this.metrics=[],r=0,o=this.file.hhea.numberOfMetrics;0<=o?r<o:r>o;r=0<=o?++r:--r)this.metrics.push({advance:e.readUInt16(),lsb:e.readInt16()});for(i=this.file.maxp.numGlyphs-this.file.hhea.numberOfMetrics,this.leftSideBearings=(function(){var f,d;for(d=[],r=f=0;0<=i?f<i:f>i;r=0<=i?++f:--f)d.push(e.readInt16());return d})(),this.widths=(function(){var f,d,m,b;for(b=[],f=0,d=(m=this.metrics).length;f<d;f++)a=m[f],b.push(a.advance);return b}).call(this),n=this.widths[this.widths.length-1],c=[],r=s=0;0<=i?s<i:s>i;r=0<=i?++s:--s)c.push(this.widths.push(n));return c},t.prototype.forGlyph=function(e){return e in this.metrics?this.metrics[e]:{advance:this.metrics[this.metrics.length-1].advance,lsb:this.leftSideBearings[e-this.metrics.length]}},t})(),vZ=[].slice,__e=(function(){function t(){return t.__super__.constructor.apply(this,arguments)}return kd(t,Oh),t.prototype.tag="glyf",t.prototype.parse=function(){return this.cache={}},t.prototype.glyphFor=function(e){var r,n,i,a,s,o,c,f,d,m;return e in this.cache?this.cache[e]:(a=this.file.loca,r=this.file.contents,n=a.indexOf(e),(i=a.lengthOf(e))===0?this.cache[e]=null:(r.pos=this.offset+n,s=(o=new Tg(r.read(i))).readShort(),f=o.readShort(),m=o.readShort(),c=o.readShort(),d=o.readShort(),this.cache[e]=s===-1?new x_e(o,f,m,c,d):new b_e(o,s,f,m,c,d),this.cache[e]))},t.prototype.encode=function(e,r,n){var i,a,s,o,c;for(s=[],a=[],o=0,c=r.length;o<c;o++)i=e[r[o]],a.push(s.length),i&&(s=s.concat(i.encode(n)));return a.push(s.length),{table:s,offsets:a}},t})(),b_e=(function(){function t(e,r,n,i,a,s){this.raw=e,this.numberOfContours=r,this.xMin=n,this.yMin=i,this.xMax=a,this.yMax=s,this.compound=!1}return t.prototype.encode=function(){return this.raw.data},t})(),x_e=(function(){function t(e,r,n,i,a){var s,o;for(this.raw=e,this.xMin=r,this.yMin=n,this.xMax=i,this.yMax=a,this.compound=!0,this.glyphIDs=[],this.glyphOffsets=[],s=this.raw;o=s.readShort(),this.glyphOffsets.push(s.pos),this.glyphIDs.push(s.readUInt16()),32&o;)s.pos+=1&o?4:2,128&o?s.pos+=8:64&o?s.pos+=4:8&o&&(s.pos+=2)}return t.prototype.encode=function(){var e,r,n;for(r=new Tg(vZ.call(this.raw.data)),e=0,n=this.glyphIDs.length;e<n;++e)r.pos=this.glyphOffsets[e];return r.data},t})(),w_e=(function(){function t(){return t.__super__.constructor.apply(this,arguments)}return kd(t,Oh),t.prototype.tag="loca",t.prototype.parse=function(e){var r,n;return e.pos=this.offset,r=this.file.head.indexToLocFormat,this.offsets=r===0?(function(){var i,a;for(a=[],n=0,i=this.length;n<i;n+=2)a.push(2*e.readUInt16());return a}).call(this):(function(){var i,a;for(a=[],n=0,i=this.length;n<i;n+=4)a.push(e.readUInt32());return a}).call(this)},t.prototype.indexOf=function(e){return this.offsets[e]},t.prototype.lengthOf=function(e){return this.offsets[e+1]-this.offsets[e]},t.prototype.encode=function(e,r){for(var n=new Uint32Array(this.offsets.length),i=0,a=0,s=0;s<n.length;++s)if(n[s]=i,a<r.length&&r[a]==s){++a,n[s]=i;var o=this.offsets[s],c=this.offsets[s+1]-o;c>0&&(i+=c)}for(var f=new Array(4*n.length),d=0;d<n.length;++d)f[4*d+3]=255&n[d],f[4*d+2]=(65280&n[d])>>8,f[4*d+1]=(16711680&n[d])>>16,f[4*d]=(4278190080&n[d])>>24;return f},t})(),S_e=(function(){function t(e){this.font=e,this.subset={},this.unicodes={},this.next=33}return t.prototype.generateCmap=function(){var e,r,n,i,a;for(r in i=this.font.cmap.tables[0].codeMap,e={},a=this.subset)n=a[r],e[r]=i[n];return e},t.prototype.glyphsFor=function(e){var r,n,i,a,s,o,c;for(i={},s=0,o=e.length;s<o;s++)i[a=e[s]]=this.font.glyf.glyphFor(a);for(a in r=[],i)(n=i[a])!=null&&n.compound&&r.push.apply(r,n.glyphIDs);if(r.length>0)for(a in c=this.glyphsFor(r))n=c[a],i[a]=n;return i},t.prototype.encode=function(e,r){var n,i,a,s,o,c,f,d,m,b,x,E,T,A,M;for(i in n=yZ.encode(this.generateCmap(),"unicode"),s=this.glyphsFor(e),x={0:0},M=n.charMap)x[(c=M[i]).old]=c.new;for(E in b=n.maxGlyphID,s)E in x||(x[E]=b++);return d=(function(F){var N,O;for(N in O={},F)O[F[N]]=N;return O})(x),m=Object.keys(d).sort(function(F,N){return F-N}),T=(function(){var F,N,O;for(O=[],F=0,N=m.length;F<N;F++)o=m[F],O.push(d[o]);return O})(),a=this.font.glyf.encode(s,T,x),f=this.font.loca.encode(a.offsets,T),A={cmap:this.font.cmap.raw(),glyf:a.table,loca:f,hmtx:this.font.hmtx.raw(),hhea:this.font.hhea.raw(),maxp:this.font.maxp.raw(),post:this.font.post.raw(),name:this.font.name.raw(),head:this.font.head.encode(r)},this.font.os2.exists&&(A["OS/2"]=this.font.os2.raw()),this.font.directory.encode(A)},t})();di.API.PDFObject=(function(){var t;function e(){}return t=function(r,n){return(Array(n+1).join("0")+r).slice(-n)},e.convert=function(r){var n,i,a,s;if(Array.isArray(r))return"["+(function(){var o,c,f;for(f=[],o=0,c=r.length;o<c;o++)n=r[o],f.push(e.convert(n));return f})().join(" ")+"]";if(typeof r=="string")return"/"+r;if(r?.isString)return"("+r+")";if(r instanceof Date)return"(D:"+t(r.getUTCFullYear(),4)+t(r.getUTCMonth(),2)+t(r.getUTCDate(),2)+t(r.getUTCHours(),2)+t(r.getUTCMinutes(),2)+t(r.getUTCSeconds(),2)+"Z)";if({}.toString.call(r)==="[object Object]"){for(i in a=["<<"],r)s=r[i],a.push("/"+i+" "+e.convert(s));return a.push(">>"),a.join(`
`)}return""+r},e})();const E_e=t=>{const e=t.width,r=t.height,n=document.createElement("div");n.className="hidden-map",n.style.width="0px",n.style.height="0px",n.style.overflow="hidden",document.body.appendChild(n);const i=document.createElement("div");i.style.width=e+"px",i.style.height=r+"px",n.appendChild(i);const a=t.map.map.getStyle();for(const c in a.sources){const f=a.sources[c];Object.keys(f).forEach(d=>{f[d]||delete f[d]})}const s=new AT.Map({container:i,center:t.map.map.getCenter(),zoom:t.map.map.getZoom(),bearing:0,pitch:0,interactive:!1,preserveDrawingBuffer:!0,fadeDuration:0,attributionControl:!1,style:a}),o=s._cameraForBoxAndBearing([t.bboxUnrotated[0],t.bboxUnrotated[1]],[t.bboxUnrotated[2],t.bboxUnrotated[3]],t.bearing+t.map.map.getBearing());return s._fitInternal(o),new Promise(c=>{console.log("before idle"),s.once("idle",function(){const f={...t,renderMap:s,hiddenContainer:n,createPdf:d=>T_e({...t,renderMap:s,hiddenContainer:n,...d}),createPng:d=>A_e({...t,renderMap:s,hiddenContainer:n,...d})};c(f)})})};function T_e(t){const e=new di({orientation:t?.orientation==="portrait"?"p":"l",unit:"mm",compress:!0,format:t.format});return Object.defineProperty(window,"devicePixelRatio",{get:function(){return 300/96}}),new Promise(r=>{e.addImage(t.renderMap.getCanvas().toDataURL("image/png"),"png",0,0,e.internal.pageSize.getWidth(),e.internal.pageSize.getHeight(),void 0,"FAST"),t.renderMap.remove(),t.hiddenContainer.parentNode?.removeChild(t.hiddenContainer);const n={...t,pdf:e,downloadPdf:i=>C_e({...n,...i}),formData:new FormData};r(n)})}function C_e(t){return t.pdf.save("Map.pdf"),new Promise(function(e){e({...t})})}function A_e(t){return new Promise(e=>{const r=t.renderMap.getCanvas().toDataURL("image/png"),n={...t,png:r,downloadPng:i=>I_e({...n,...i})};e(n)})}function I_e(t){const e=document.createElement("a");return e.download=t?.name?t.name+".png":"map.png",e.href=t.png,document.body.appendChild(e),e.click(),document.body.removeChild(e),new Promise(function(r){r({...t})})}function _Z(t){const e=va({mapId:t.mapId});return{createExport:te.useMemo(()=>{if(e.map)return n=>E_e({map:e.map,...n})},[e.map])}}const N9=t=>{const e=va({mapId:t.mapId}),r=_Z({mapId:t.mapId}),[n,i]=gt.useState(!1);return J.jsx(J.Fragment,{children:J.jsx(ta,{color:"primary",variant:"contained",onClick:()=>{if(e.map&&r?.createExport){i(!0);const a=e.map.getBounds(),s=[a.getWest(),a.getSouth(),a.getEast(),a.getNorth()];r.createExport({width:595*1.4,height:842*1.4,bbox:s,bboxUnrotated:s,bearing:e.map.getBearing(),format:"a4",orientation:"portrait",...t.exportOptions}).then(o=>o.createPdf()).then(o=>(i(!1),o.downloadPdf())).catch(o=>{console.log(o),i(!1)})}},children:n?J.jsx(WT,{size:24,sx:{color:"#fff"}}):J.jsx(Nye,{})})})};try{N9.displayName="MlCreatePdfButton",N9.__docgenInfo={description:"Renders a button that will create a PDF version of the current map view (dimensions adjusted to fit Din A4 Paper).",displayName:"MlCreatePdfButton",props:{mapId:{defaultValue:null,description:"ID of the target MapLibre instance in mapContext",name:"mapId",required:!1,type:{name:"string | undefined"}},exportOptions:{defaultValue:null,description:"Option overrides for the createExport function",name:"exportOptions",required:!1,type:{name:"createExportOptions | undefined"}}}}}catch{}const l0={A4:{"300dpi":{width:2480,height:3508},"150dpi":{width:1240,height:1754},"72dpi":{width:595,height:842}},A3:{"300dpi":{width:3505,height:4961},"150dpi":{width:1754,height:2480},"72dpi":{width:842,height:1191}},A2:{"300dpi":{width:4961,height:7016},"150dpi":{width:2480,height:3508},"72dpi":{width:1191,height:1684}},A1:{"300dpi":{width:7016,height:9933},"150dpi":{width:3508,height:4967},"72dpi":{width:1684,height:2384}},A0:{"300dpi":{width:9933,height:14043},"150dpi":{width:4967,height:7022},"72dpi":{width:2384,height:3370}}},bZ=gt.createContext({}),P_e=l0.A4["72dpi"],iR=({children:t})=>{const[e,r]=te.useState("A4"),[n,i]=te.useState("72dpi"),[a,s]=te.useState({center:void 0,scale:void 0,rotate:0,width:210,height:297,orientation:"portrait",fixedScale:0}),o=te.useRef(null),c=te.useMemo(()=>typeof l0[e][n]<"u"?a.orientation==="portrait"?l0[e][n]:{width:l0[e][n].height,height:l0[e][n].width}:P_e,[e,n,a.orientation]),f={options:a,setOptions:s,format:e,setFormat:r,quality:n,setQuality:i,geojsonRef:o,template:c};return J.jsx(bZ.Provider,{value:f,children:t})};try{iR.displayName="PdfContextProvider",iR.__docgenInfo={description:"",displayName:"PdfContextProvider",props:{}}}catch{}function wO(t,e){for(var r=t.length,n=0;n<r;++n)if(e(t[n],n))return!0;return!1}function xZ(t,e){for(var r=t.length,n=0;n<r;++n)if(e(t[n],n))return t[n];return null}function wZ(t){var e=t;if(typeof e>"u"){if(typeof navigator>"u"||!navigator)return"";e=navigator.userAgent||""}return e.toLowerCase()}function SO(t,e){try{return new RegExp(t,"g").exec(e)}catch{return null}}function k_e(){if(typeof navigator>"u"||!navigator||!navigator.userAgentData)return!1;var t=navigator.userAgentData,e=t.brands||t.uaList;return!!(e&&e.length)}function R_e(t,e){var r=SO("("+t+")((?:\\/|\\s|:)([0-9|\\.|_]+))",e);return r?r[3]:""}function aR(t){return t.replace(/_/g,".")}function N1(t,e){var r=null,n="-1";return wO(t,function(i){var a=SO("("+i.test+")((?:\\/|\\s|:)([0-9|\\.|_]+))?",e);return!a||i.brand?!1:(r=i,n=a[3]||"-1",i.versionAlias?n=i.versionAlias:i.versionTest&&(n=R_e(i.versionTest.toLowerCase(),e)||n),n=aR(n),!0)}),{preset:r,version:n}}function uw(t,e){var r={brand:"",version:"-1"};return wO(t,function(n){var i=SZ(e,n);return i?(r.brand=n.id,r.version=n.versionAlias||i.version,r.version!=="-1"):!1}),r}function SZ(t,e){return xZ(t,function(r){var n=r.brand;return SO(""+e.test,n.toLowerCase())})}var EZ=[{test:"phantomjs",id:"phantomjs"},{test:"whale",id:"whale"},{test:"edgios|edge|edg",id:"edge"},{test:"msie|trident|windows phone",id:"ie",versionTest:"iemobile|msie|rv"},{test:"miuibrowser",id:"miui browser"},{test:"samsungbrowser",id:"samsung internet"},{test:"samsung",id:"samsung internet",versionTest:"version"},{test:"chrome|crios",id:"chrome"},{test:"firefox|fxios",id:"firefox"},{test:"android",id:"android browser",versionTest:"version"},{test:"safari|iphone|ipad|ipod",id:"safari",versionTest:"version"}],TZ=[{test:"(?=.*applewebkit/(53[0-7]|5[0-2]|[0-4]))(?=.*\\schrome)",id:"chrome",versionTest:"chrome"},{test:"chromium",id:"chrome"},{test:"whale",id:"chrome",versionAlias:"-1",brand:!0}],oR=[{test:"applewebkit",id:"webkit",versionTest:"applewebkit|safari"}],CZ=[{test:"(?=(iphone|ipad))(?!(.*version))",id:"webview"},{test:"(?=(android|iphone|ipad))(?=.*(naver|daum|; wv))",id:"webview"},{test:"webview",id:"webview"}],AZ=[{test:"windows phone",id:"windows phone"},{test:"windows 2000",id:"window",versionAlias:"5.0"},{test:"windows nt",id:"window"},{test:"win32|windows",id:"window"},{test:"iphone|ipad|ipod",id:"ios",versionTest:"iphone os|cpu os"},{test:"macos|macintel|mac os x",id:"mac"},{test:"android|linux armv81",id:"android"},{test:"tizen",id:"tizen"},{test:"webos|web0s",id:"webos"}];function IZ(t){return!!N1(CZ,t).preset}function M_e(t){var e=wZ(t),r=!!/mobi/g.exec(e),n={name:"unknown",version:"-1",majorVersion:-1,webview:IZ(e),chromium:!1,chromiumVersion:"-1",webkit:!1,webkitVersion:"-1"},i={name:"unknown",version:"-1",majorVersion:-1},a=N1(EZ,e),s=a.preset,o=a.version,c=N1(AZ,e),f=c.preset,d=c.version,m=N1(TZ,e);if(n.chromium=!!m.preset,n.chromiumVersion=m.version,!n.chromium){var b=N1(oR,e);n.webkit=!!b.preset,n.webkitVersion=b.version}return f&&(i.name=f.id,i.version=d,i.majorVersion=parseInt(d,10)),s&&(n.name=s.id,n.version=o,n.webview&&i.name==="ios"&&n.name!=="safari"&&(n.webview=!1)),n.majorVersion=parseInt(n.version,10),{browser:n,os:i,isMobile:r,isHints:!1}}function D_e(t){var e=navigator.userAgentData,r=(e.uaList||e.brands).slice(),n=e.mobile||!1,i=r[0],a=(e.platform||navigator.platform).toLowerCase(),s={name:i.brand,version:i.version,majorVersion:-1,webkit:!1,webkitVersion:"-1",chromium:!1,chromiumVersion:"-1",webview:!!uw(CZ,r).brand||IZ(wZ())},o={name:"unknown",version:"-1",majorVersion:-1};s.webkit=!s.chromium&&wO(oR,function(b){return SZ(r,b)});var c=uw(TZ,r);if(s.chromium=!!c.brand,s.chromiumVersion=c.version||"-1",!s.chromium){var f=uw(oR,r);s.webkit=!!f.brand,s.webkitVersion=f.version||"-1"}var d=xZ(AZ,function(b){return new RegExp(""+b.test,"g").exec(a)});o.name=d?d.id:"";{var m=uw(EZ,r);s.name=m.brand||s.name,s.version=m.brand&&t?t.uaFullVersion:m.version}return s.webkit&&(o.name=n?"ios":"mac"),o.name==="ios"&&s.webview&&(s.version="-1"),o.version=aR(o.version),s.version=aR(s.version),o.majorVersion=parseInt(o.version,10),s.majorVersion=parseInt(s.version,10),{browser:s,os:o,isMobile:n,isHints:!0}}function O_e(t){return k_e()?D_e():M_e(t)}function N_e(t){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];return e.map(function(n){return n.split(" ").map(function(i){return i?""+t+i:""}).join(" ")}).join(" ")}function L_e(t,e){return e.replace(/([^}{]*){/gm,function(r,n){return n.replace(/\.([^{,\s\d.]+)/g,"."+t+"$1")+"{"})}function zm(t,e){return function(r){r&&(t[e]=r)}}function PZ(t,e,r){return function(n){n&&(t[e][r]=n)}}function F_e(t,e){return e===void 0&&(e={}),function(r,n){t.forEach(function(i){var a=e[i]||i;a in r||(r[a]=function(){for(var s,o=[],c=0;c<arguments.length;c++)o[c]=arguments[c];var f=(s=this[n])[i].apply(s,o);return f===this[n]?this:f})})}}var B_e="function",z_e="object",j_e="string",U_e="number",EO="undefined",kZ=typeof window!==EO,V_e=typeof document!==EO&&document,$_e=[{open:"(",close:")"},{open:'"',close:'"'},{open:"'",close:"'"},{open:'\\"',close:'\\"'},{open:"\\'",close:"\\'"}],Tl=1e-7,cw={cm:function(t){return t*96/2.54},mm:function(t){return t*96/254},in:function(t){return t*96},pt:function(t){return t*96/72},pc:function(t){return t*96/6},"%":function(t,e){return t*e/100},vw:function(t,e){return e===void 0&&(e=window.innerWidth),t/100*e},vh:function(t,e){return e===void 0&&(e=window.innerHeight),t/100*e},vmax:function(t,e){return e===void 0&&(e=Math.max(window.innerWidth,window.innerHeight)),t/100*e},vmin:function(t,e){return e===void 0&&(e=Math.min(window.innerWidth,window.innerHeight)),t/100*e}};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */function q_e(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;for(var n=Array(t),i=0,e=0;e<r;e++)for(var a=arguments[e],s=0,o=a.length;s<o;s++,i++)n[i]=a[s];return n}function tE(t,e,r,n){return(t*n+e*r)/(r+n)}function TO(t){return typeof t===EO}function Ah(t){return t&&typeof t===z_e}function su(t){return Array.isArray(t)}function kp(t){return typeof t===j_e}function qb(t){return typeof t===U_e}function CO(t){return typeof t===B_e}function H_e(t,e){var r=t===""||t==" ",n=e===""||e==" ";return n&&r||t===e}function RZ(t,e,r,n,i){var a=AO(t,e,r);return a?r:G_e(t,e,r+1,n,i)}function AO(t,e,r){if(!t.ignore)return null;var n=e.slice(Math.max(r-3,0),r+3).join("");return new RegExp(t.ignore).exec(n)}function G_e(t,e,r,n,i){for(var a=function(f){var d=e[f].trim();if(d===t.close&&!AO(t,e,f))return{value:f};var m=f,b=pf(i,function(x){var E=x.open;return E===d});if(b&&(m=RZ(b,e,f,n,i)),m===-1)return s=f,"break";f=m,s=f},s,o=r;o<n;++o){var c=a(o);if(o=s,typeof c=="object")return c.value;if(c==="break")break}return-1}function IO(t,e){var r=kp(e)?{separator:e}:e,n=r.separator,i=n===void 0?",":n,a=r.isSeparateFirst,s=r.isSeparateOnlyOpenClose,o=r.isSeparateOpenClose,c=o===void 0?s:o,f=r.openCloseCharacters,d=f===void 0?$_e:f,m=d.map(function(H){var W=H.open,X=H.close;return W===X?W:W+"|"+X}).join("|"),b="(\\s*"+i+"\\s*|"+m+"|\\s+)",x=new RegExp(b,"g"),E=t.split(x).filter(function(H){return H&&H!=="undefined"}),T=E.length,A=[],M=[];function F(){return M.length?(A.push(M.join("")),M=[],!0):!1}for(var N=function(H){var W=E[H].trim(),X=H,oe=pf(d,function(ae){var se=ae.open;return se===W}),Q=pf(d,function(ae){var se=ae.close;return se===W});if(oe){if(X=RZ(oe,E,H,T,d),X!==-1&&c)return F()&&a||(A.push(E.slice(H,X+1).join("")),H=X,a)?(O=H,"break"):(O=H,"continue")}else if(Q&&!AO(Q,E,H)){var G=q_e(d);return G.splice(d.indexOf(Q),1),{value:IO(t,{separator:i,isSeparateFirst:a,isSeparateOnlyOpenClose:s,isSeparateOpenClose:c,openCloseCharacters:G})}}else if(H_e(W,i)&&!s)return F(),a?(O=H,"break"):(O=H,"continue");X===-1&&(X=T-1),M.push(E.slice(H,X+1).join("")),H=X,O=H},O,U=0;U<T;++U){var j=N(U);if(U=O,typeof j=="object")return j.value;if(j==="break")break}return M.length&&A.push(M.join("")),A}function Cg(t){return IO(t,"")}function km(t){return IO(t,",")}function MZ(t){var e=/([^(]*)\(([\s\S]*)\)([\s\S]*)/g.exec(t);return!e||e.length<4?{}:{prefix:e[1],value:e[2],suffix:e[3]}}function Fx(t){var e=/^([^\d|e|\-|\+]*)((?:\d|\.|-|e-|e\+)+)(\S*)$/g.exec(t);if(!e)return{prefix:"",unit:"",value:NaN};var r=e[1],n=e[2],i=e[3];return{prefix:r,unit:i,value:parseFloat(n)}}function W_e(t,e){return t.replace(/([a-z])([A-Z])/g,function(r,n,i){return""+n+e+i.toLowerCase()})}function Hb(){return Date.now?Date.now():new Date().getTime()}function Sp(t,e,r){r===void 0&&(r=-1);for(var n=t.length,i=0;i<n;++i)if(e(t[i],i,t))return i;return r}function pf(t,e,r){var n=Sp(t,e);return n>-1?t[n]:r}var DZ=(function(){var t=Hb(),e=kZ&&(window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.msRequestAnimationFrame);return e?e.bind(window):function(r){var n=Hb(),i=setTimeout(function(){r(n-t)},1e3/60);return i}})(),X_e=(function(){var t=kZ&&(window.cancelAnimationFrame||window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||window.msCancelAnimationFrame);return t?t.bind(window):function(e){clearTimeout(e)}})();function g_(t){return Object.keys(t)}function xo(t,e){var r=Fx(t),n=r.value,i=r.unit;if(Ah(e)){var a=e[i];if(a){if(CO(a))return a(n);if(cw[i])return cw[i](n,a)}}else if(i==="%")return n*e/100;return cw[i]?cw[i](n):n}function sR(t,e,r){return Math.max(e,Math.min(t,r))}function L9(t,e,r,n){return n===void 0&&(n=t[0]/t[1]),[[Fi(e[0],Tl),Fi(e[0]/n,Tl)],[Fi(e[1]*n,Tl),Fi(e[1],Tl)]].filter(function(i){return i.every(function(a,s){var o=e[s],c=Fi(o,Tl);return r?a<=o||a<=c:a>=o||a>=c})})[0]||t}function OZ(t,e,r,n){if(!n)return t.map(function(x,E){return sR(x,e[E],r[E])});var i=t[0],a=t[1],s=n===!0?i/a:n,o=L9(t,e,!1,s),c=o[0],f=o[1],d=L9(t,r,!0,s),m=d[0],b=d[1];return i<c||a<f?(i=c,a=f):(i>m||a>b)&&(i=m,a=b),[i,a]}function Y_e(t){for(var e=t.length,r=0,n=e-1;n>=0;--n)r+=t[n];return r}function lR(t){for(var e=t.length,r=0,n=e-1;n>=0;--n)r+=t[n];return e?r/e:0}function il(t,e){var r=e[0]-t[0],n=e[1]-t[1],i=Math.atan2(n,r);return i>=0?i:i+Math.PI*2}function Z_e(t){return[0,1].map(function(e){return lR(t.map(function(r){return r[e]}))})}function F9(t){var e=Z_e(t),r=il(e,t[0]),n=il(e,t[1]);return r<n&&n-r<Math.PI||r>n&&n-r<-Math.PI?1:-1}function gp(t,e){return Math.sqrt(Math.pow((e?e[0]:0)-t[0],2)+Math.pow((e?e[1]:0)-t[1],2))}function Fi(t,e){if(!e)return t;var r=1/e;return Math.round(t/e)/r}function B9(t,e){return t.forEach(function(r,n){t[n]=Fi(t[n],e)}),t}function K_e(t){for(var e=[],r=0;r<t;++r)e.push(r);return e}function J_e(t){return t.reduce(function(e,r){return e.concat(r)},[])}function Bl(t,e){return t.classList?t.classList.contains(e):!!t.className.match(new RegExp("(\\s|^)"+e+"(\\s|$)"))}function NZ(t,e){t.classList?t.classList.add(e):t.className+=" "+e}function LZ(t,e){if(t.classList)t.classList.remove(e);else{var r=new RegExp("(\\s|^)"+e+"(\\s|$)");t.className=t.className.replace(r," ")}}function Gu(t,e,r,n){t.addEventListener(e,r,n)}function _u(t,e,r,n){t.removeEventListener(e,r,n)}function PO(t){return t?.ownerDocument||V_e}function kO(t){return PO(t).documentElement}function zg(t){return PO(t).body}function xg(t){var e;return((e=t?.ownerDocument)===null||e===void 0?void 0:e.defaultView)||window}function FZ(t){return t&&"postMessage"in t&&"blur"in t&&"self"in t}function RO(t){return Ah(t)&&t.nodeName&&t.nodeType&&"ownerDocument"in t}function Q_e(t,e,r,n,i,a){for(var s=0;s<i;++s){var o=r+s*i,c=n+s*i;t[o]+=t[c]*a,e[o]+=e[c]*a}}function e1e(t,e,r,n,i){for(var a=0;a<i;++a){var s=r+a*i,o=n+a*i,c=t[s],f=e[s];t[s]=t[o],t[o]=c,e[s]=e[o],e[o]=f}}function t1e(t,e,r,n,i){for(var a=0;a<n;++a){var s=r+a*n;t[s]/=i,e[s]/=i}}function BZ(t,e,r){for(var n=t.slice(),i=0;i<r;++i)n[i*r+e-1]=0,n[(e-1)*r+i]=0;return n[(e-1)*(r+1)]=1,n}function Ed(t,e){e===void 0&&(e=Math.sqrt(t.length));for(var r=t.slice(),n=Jo(e),i=0;i<e;++i){var a=e*i+i;if(!Fi(r[a],Tl)){for(var s=i+1;s<e;++s)if(r[e*i+s]){e1e(r,n,i,s,e);break}}if(!Fi(r[a],Tl))return[];t1e(r,n,i,e,r[a]);for(var s=0;s<e;++s){var o=s,c=s+i*e,f=r[c];!Fi(f,Tl)||i===s||Q_e(r,n,o,i,e,-f)}}return n}function r1e(t,e){e===void 0&&(e=Math.sqrt(t.length));for(var r=[],n=0;n<e;++n)for(var i=0;i<e;++i)r[i*e+n]=t[e*n+i];return r}function zZ(t,e){e===void 0&&(e=Math.sqrt(t.length));for(var r=[],n=t[e*e-1],i=0;i<e-1;++i)r[i]=t[e*(e-1)+i]/n;return r[e-1]=0,r}function n1e(t,e){for(var r=Jo(e),n=0;n<e-1;++n)r[e*(e-1)+n]=t[n]||0;return r}function Qm(t,e){for(var r=t.slice(),n=t.length;n<e-1;++n)r[n]=0;return r[e-1]=1,r}function Ih(t,e,r){if(e===void 0&&(e=Math.sqrt(t.length)),e===r)return t;for(var n=Jo(r),i=Math.min(e,r),a=0;a<i-1;++a){for(var s=0;s<i-1;++s)n[a*r+s]=t[a*e+s];n[(a+1)*r-1]=t[(a+1)*e-1],n[(r-1)*r+a]=t[(e-1)*e+a]}return n[r*r-1]=t[e*e-1],n}function rE(t){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];var n=Jo(t);return e.forEach(function(i){n=wo(n,i,t)}),n}function wo(t,e,r){r===void 0&&(r=Math.sqrt(t.length));var n=[],i=t.length/r,a=e.length/i;if(i){if(!a)return t}else return e;for(var s=0;s<r;++s)for(var o=0;o<a;++o){n[o*r+s]=0;for(var c=0;c<i;++c)n[o*r+s]+=t[c*r+s]*e[o*i+c]}return n}function Ma(t,e){for(var r=Math.min(t.length,e.length),n=t.slice(),i=0;i<r;++i)n[i]=n[i]+e[i];return n}function _i(t,e){for(var r=Math.min(t.length,e.length),n=t.slice(),i=0;i<r;++i)n[i]=n[i]-e[i];return n}function i1e(t,e){return e===void 0&&(e=t.length===6),e?[t[0],t[1],0,t[2],t[3],0,t[4],t[5],1]:t}function jZ(t,e){return e===void 0&&(e=t.length===9),e?[t[0],t[1],t[3],t[4],t[6],t[7]]:t}function tc(t,e,r){r===void 0&&(r=e.length);var n=wo(t,e,r),i=n[r-1];return n.map(function(a){return a/i})}function a1e(t,e){return wo(t,[1,0,0,0,0,Math.cos(e),Math.sin(e),0,0,-Math.sin(e),Math.cos(e),0,0,0,0,1],4)}function o1e(t,e){return wo(t,[Math.cos(e),0,-Math.sin(e),0,0,1,0,0,Math.sin(e),0,Math.cos(e),0,0,0,0,1],4)}function s1e(t,e){return wo(t,zx(e,4))}function fw(t,e){var r=e[0],n=r===void 0?1:r,i=e[1],a=i===void 0?1:i,s=e[2],o=s===void 0?1:s;return wo(t,[n,0,0,0,0,a,0,0,0,0,o,0,0,0,0,1],4)}function Bx(t,e){return tc(zx(e,3),Qm(t,3))}function $A(t,e){var r=e[0],n=r===void 0?0:r,i=e[1],a=i===void 0?0:i,s=e[2],o=s===void 0?0:s;return wo(t,[1,0,0,0,0,1,0,0,0,0,1,0,n,a,o,1],4)}function z9(t,e){return wo(t,e,4)}function zx(t,e){var r=Math.cos(t),n=Math.sin(t),i=Jo(e);return i[0]=r,i[1]=n,i[e]=-n,i[e+1]=r,i}function Jo(t){for(var e=t*t,r=[],n=0;n<e;++n)r[n]=n%(t+1)?0:1;return r}function MO(t,e){for(var r=Jo(e),n=Math.min(t.length,e-1),i=0;i<n;++i)r[(e+1)*i]=t[i];return r}function ey(t,e){for(var r=Jo(e),n=Math.min(t.length,e-1),i=0;i<n;++i)r[e*(e-1)+i]=t[i];return r}function DO(t,e,r,n,i,a,s,o){var c=t[0],f=t[1],d=e[0],m=e[1],b=r[0],x=r[1],E=n[0],T=n[1],A=i[0],M=i[1],F=a[0],N=a[1],O=s[0],U=s[1],j=o[0],H=o[1],W=[c,0,d,0,b,0,E,0,f,0,m,0,x,0,T,0,1,0,1,0,1,0,1,0,0,c,0,d,0,b,0,E,0,f,0,m,0,x,0,T,0,1,0,1,0,1,0,1,-A*c,-M*c,-F*d,-N*d,-O*b,-U*b,-j*E,-H*E,-A*f,-M*f,-F*m,-N*m,-O*x,-U*x,-j*T,-H*T],X=Ed(W,8);if(!X.length)return[];var oe=wo(X,[A,M,F,N,O,U,j,H],8);return oe[8]=1,Ih(r1e(oe),3,4)}var db=function(){return db=Object.assign||function(e){for(var r,n=1,i=arguments.length;n<i;n++){r=arguments[n];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},db.apply(this,arguments)};function l1e(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function Gb(t,e){return e===void 0&&(e=0),jv(q0(t,e))}function u1e(t,e){var r=tc(t,[e[0],e[1]||0,e[2]||0,1],4),n=r[3]||1;return[r[0]/n,r[1]/n,r[2]/n]}function jv(t){var e=l1e();return t.forEach(function(r){var n=r.matrixFunction,i=r.functionValue;n&&(e=n(e,i))}),e}function q0(t,e){e===void 0&&(e=0);var r=su(t)?t:Cg(t);return r.map(function(n){var i=MZ(n),a=i.prefix,s=i.value,o=null,c=a,f="";if(a==="translate"||a==="translateX"||a==="translate3d"){var d=Ah(e)?db(db({},e),{"o%":e["%"]}):{"%":e,"o%":e},m=km(s).map(function(ae,se){return se===0&&"x%"in d?d["%"]=e["x%"]:se===1&&"y%"in d?d["%"]=e["y%"]:d["%"]=e["o%"],xo(ae,d)}),b=m[0],x=m[1],E=x===void 0?0:x,T=m[2],A=T===void 0?0:T;o=$A,f=[b,E,A]}else if(a==="translateY"){var M=Ah(e)?db({"%":e["y%"]},e):{"%":e},E=xo(s,M);o=$A,f=[0,E,0]}else if(a==="translateZ"){var A=parseFloat(s);o=$A,f=[0,0,A]}else if(a==="scale"||a==="scale3d"){var F=km(s).map(function(ae){return parseFloat(ae)}),N=F[0],O=F[1],U=O===void 0?N:O,j=F[2],H=j===void 0?1:j;o=fw,f=[N,U,H]}else if(a==="scaleX"){var N=parseFloat(s);o=fw,f=[N,1,1]}else if(a==="scaleY"){var U=parseFloat(s);o=fw,f=[1,U,1]}else if(a==="scaleZ"){var H=parseFloat(s);o=fw,f=[1,1,H]}else if(a==="rotate"||a==="rotateZ"||a==="rotateX"||a==="rotateY"){var W=Fx(s),X=W.unit,oe=W.value,Q=X==="rad"?oe:oe*Math.PI/180;a==="rotate"||a==="rotateZ"?(c="rotateZ",o=s1e):a==="rotateX"?o=a1e:a==="rotateY"&&(o=o1e),f=Q}else if(a==="matrix3d")o=z9,f=km(s).map(function(ae){return parseFloat(ae)});else if(a==="matrix"){var G=km(s).map(function(ae){return parseFloat(ae)});o=z9,f=[G[0],G[1],0,0,G[2],G[3],0,0,0,0,1,0,G[4],G[5],0,1]}else c="";return{name:a,functionName:c,value:s,matrixFunction:o,functionValue:f}})}var c1e=(function(){function t(){this.keys=[],this.values=[]}var e=t.prototype;return e.get=function(r){return this.values[this.keys.indexOf(r)]},e.set=function(r,n){var i=this.keys,a=this.values,s=i.indexOf(r),o=s===-1?i.length:s;i[o]=r,a[o]=n},t})(),f1e=(function(){function t(){this.object={}}var e=t.prototype;return e.get=function(r){return this.object[r]},e.set=function(r,n){this.object[r]=n},t})(),h1e=typeof Map=="function",d1e=(function(){function t(){}var e=t.prototype;return e.connect=function(r,n){this.prev=r,this.next=n,r&&(r.next=this),n&&(n.prev=this)},e.disconnect=function(){var r=this.prev,n=this.next;r&&(r.next=n),n&&(n.prev=r)},e.getIndex=function(){for(var r=this,n=-1;r;)r=r.prev,++n;return n},t})();function p1e(t,e){var r=[],n=[];return t.forEach(function(i){var a=i[0],s=i[1],o=new d1e;r[a]=o,n[s]=o}),r.forEach(function(i,a){i.connect(r[a-1])}),t.filter(function(i,a){return!e[a]}).map(function(i,a){var s=i[0],o=i[1];if(s===o)return[0,0];var c=r[s],f=n[o-1],d=c.getIndex();c.disconnect(),f?c.connect(f,f.next):c.connect(void 0,r[0]);var m=c.getIndex();return[d,m]})}var g1e=(function(){function t(r,n,i,a,s,o,c,f){this.prevList=r,this.list=n,this.added=i,this.removed=a,this.changed=s,this.maintained=o,this.changedBeforeAdded=c,this.fixed=f}var e=t.prototype;return Object.defineProperty(e,"ordered",{get:function(){return this.cacheOrdered||this.caculateOrdered(),this.cacheOrdered},enumerable:!0,configurable:!0}),Object.defineProperty(e,"pureChanged",{get:function(){return this.cachePureChanged||this.caculateOrdered(),this.cachePureChanged},enumerable:!0,configurable:!0}),e.caculateOrdered=function(){var r=p1e(this.changedBeforeAdded,this.fixed),n=this.changed,i=[];this.cacheOrdered=r.filter(function(a,s){var o=a[0],c=a[1],f=n[s],d=f[0],m=f[1];if(o!==c)return i.push([d,m]),!0}),this.cachePureChanged=i},t})();function OO(t,e,r){var n=h1e?Map:r?f1e:c1e,i=r||function(F){return F},a=[],s=[],o=[],c=t.map(i),f=e.map(i),d=new n,m=new n,b=[],x=[],E={},T=[],A=0,M=0;return c.forEach(function(F,N){d.set(F,N)}),f.forEach(function(F,N){m.set(F,N)}),c.forEach(function(F,N){var O=m.get(F);typeof O>"u"?(++M,s.push(N)):E[O]=M}),f.forEach(function(F,N){var O=d.get(F);typeof O>"u"?(a.push(N),++A):(o.push([O,N]),M=E[N]||0,b.push([O-M,N-A]),x.push(N===O),O!==N&&T.push([O,N]))}),s.reverse(),new g1e(t,e,a,s,T,o,b,x)}var m1e=(function(){function t(r,n){r===void 0&&(r=[]),this.findKeyCallback=n,this.list=[].slice.call(r)}var e=t.prototype;return e.update=function(r){var n=[].slice.call(r),i=OO(this.list,n,this.findKeyCallback);return this.list=n,i},t})();/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */var uR=function(t,e){return uR=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var i in n)n.hasOwnProperty(i)&&(r[i]=n[i])},uR(t,e)};function y1e(t,e){uR(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}var UZ=typeof Map=="function"?void 0:(function(){var t=0;return function(e){return e.__DIFF_KEY__||(e.__DIFF_KEY__=++t)}})(),VZ=(function(t){y1e(e,t);function e(r){return r===void 0&&(r=[]),t.call(this,r,UZ)||this}return e})(m1e);function v1e(t,e){return OO(t,e,UZ)}/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var cR=function(){return cR=Object.assign||function(e){for(var r,n=1,i=arguments.length;n<i;n++){r=arguments[n];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},cR.apply(this,arguments)};function _1e(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;for(var n=Array(t),i=0,e=0;e<r;e++)for(var a=arguments[e],s=0,o=a.length;s<o;s++,i++)n[i]=a[s];return n}var NO=(function(){function t(){this._events={}}var e=t.prototype;return e.on=function(r,n){if(Ah(r))for(var i in r)this.on(i,r[i]);else this._addEvent(r,n,{});return this},e.off=function(r,n){if(!r)this._events={};else if(Ah(r))for(var i in r)this.off(i);else if(!n)this._events[r]=[];else{var a=this._events[r];if(a){var s=Sp(a,function(o){return o.listener===n});s>-1&&a.splice(s,1)}}return this},e.once=function(r,n){var i=this;return n&&this._addEvent(r,n,{once:!0}),new Promise(function(a){i._addEvent(r,a,{once:!0})})},e.emit=function(r,n){var i=this;n===void 0&&(n={});var a=this._events[r];if(!r||!a)return!0;var s=!1;return n.eventType=r,n.stop=function(){s=!0},n.currentTarget=this,_1e(a).forEach(function(o){o.listener(n),o.once&&i.off(r,o.listener)}),!s},e.trigger=function(r,n){return n===void 0&&(n={}),this.emit(r,n)},e._addEvent=function(r,n,i){var a=this._events;a[r]=a[r]||[];var s=a[r];s.push(cR({listener:n},i))},t})();/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var fR=function(t,e){return fR=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var i in n)n.hasOwnProperty(i)&&(r[i]=n[i])},fR(t,e)};function b1e(t,e){fR(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}var u0=function(){return u0=Object.assign||function(e){for(var r,n=1,i=arguments.length;n<i;n++){r=arguments[n];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},u0.apply(this,arguments)};function x1e(t){var e=t.container;return e===document.body?[e.scrollLeft||document.documentElement.scrollLeft,e.scrollTop||document.documentElement.scrollTop]:[e.scrollLeft,e.scrollTop]}function j9(t,e){return t.addEventListener("scroll",e),function(){t.removeEventListener("scroll",e)}}function hw(t){if(t){if(kp(t))return document.querySelector(t)}else return null;if(CO(t))return t();if(t instanceof Element)return t;if("current"in t)return t.current;if("value"in t)return t.value}var w1e=(function(t){b1e(e,t);function e(){var n=t!==null&&t.apply(this,arguments)||this;return n._startRect=null,n._startPos=[],n._prevTime=0,n._timer=0,n._prevScrollPos=[0,0],n._isWait=!1,n._flag=!1,n._currentOptions=null,n._lock=!1,n._unregister=null,n._onScroll=function(){var i=n._currentOptions;n._lock||!i||n.emit("scrollDrag",{next:function(a){n.checkScroll({container:i.container,inputEvent:a})}})},n}var r=e.prototype;return r.dragStart=function(n,i){var a=hw(i.container);if(!a){this._flag=!1;return}var s=0,o=0,c=0,f=0;if(a===document.body)c=window.innerWidth,f=window.innerHeight;else{var d=a.getBoundingClientRect();s=d.top,o=d.left,c=d.width,f=d.height}this._flag=!0,this._startPos=[n.clientX,n.clientY],this._startRect={top:s,left:o,width:c,height:f},this._prevScrollPos=this._getScrollPosition([0,0],i),this._currentOptions=i,this._registerScrollEvent(i)},r.drag=function(n,i){if(clearTimeout(this._timer),!!this._flag){var a=n.clientX,s=n.clientY,o=i.threshold,c=o===void 0?0:o,f=this,d=f._startRect,m=f._startPos;this._currentOptions=i;var b=[0,0];return d.top>s-c?(m[1]>d.top||s<m[1])&&(b[1]=-1):d.top+d.height<s+c&&(m[1]<d.top+d.height||s>m[1])&&(b[1]=1),d.left>a-c?(m[0]>d.left||a<m[0])&&(b[0]=-1):d.left+d.width<a+c&&(m[0]<d.left+d.width||a>m[0])&&(b[0]=1),!b[0]&&!b[1]?!1:this._continueDrag(u0(u0({},i),{direction:b,inputEvent:n,isDrag:!0}))}},r.checkScroll=function(n){var i=this;if(this._isWait)return!1;var a=n.prevScrollPos,s=a===void 0?this._prevScrollPos:a,o=n.direction,c=n.throttleTime,f=c===void 0?0:c,d=n.inputEvent,m=n.isDrag,b=this._getScrollPosition(o||[0,0],n),x=b[0]-s[0],E=b[1]-s[1],T=o||[x?Math.abs(x)/x:0,E?Math.abs(E)/E:0];return this._prevScrollPos=b,this._lock=!1,!x&&!E?!1:(this.emit("move",{offsetX:T[0]?x:0,offsetY:T[1]?E:0,inputEvent:d}),f&&m&&(clearTimeout(this._timer),this._timer=window.setTimeout(function(){i._continueDrag(n)},f)),!0)},r.dragEnd=function(){this._flag=!1,this._lock=!1,clearTimeout(this._timer),this._unregisterScrollEvent()},r._getScrollPosition=function(n,i){var a=i.container,s=i.getScrollPosition,o=s===void 0?x1e:s;return o({container:hw(a),direction:n})},r._continueDrag=function(n){var i=this,a,s=n.container,o=n.direction,c=n.throttleTime,f=n.useScroll,d=n.isDrag,m=n.inputEvent;if(!(!this._flag||d&&this._isWait)){var b=Hb(),x=Math.max(c+this._prevTime-b,0);if(x>0)return clearTimeout(this._timer),this._timer=window.setTimeout(function(){i._continueDrag(n)},x),!1;this._prevTime=b;var E=this._getScrollPosition(o,n);this._prevScrollPos=E,d&&(this._isWait=!0),f||(this._lock=!0);var T={container:hw(s),direction:o,inputEvent:m};return(a=n.requestScroll)===null||a===void 0||a.call(n,T),this.emit("scroll",T),this._isWait=!1,f||this.checkScroll(u0(u0({},n),{prevScrollPos:E,direction:o,inputEvent:m}))}},r._registerScrollEvent=function(n){this._unregisterScrollEvent();var i=n.checkScrollEvent;if(i){var a=i===!0?j9:i,s=hw(n.container);i===!0&&(s===document.body||s===document.documentElement)?this._unregister=j9(window,this._onScroll):this._unregister=a(s,this._onScroll)}},r._unregisterScrollEvent=function(){var n;(n=this._unregister)===null||n===void 0||n.call(this),this._unregister=null},e})(NO);/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */function S1e(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;for(var n=Array(t),i=0,e=0;e<r;e++)for(var a=arguments[e],s=0,o=a.length;s<o;s++,i++)n[i]=a[s];return n}function Pc(t){return Fi(t,Tl)}function E1e(t,e){return t.every(function(r,n){return Pc(r-e[n])===0})}function T1e(t,e){return!Pc(t[0]-e[0])&&!Pc(t[1]-e[1])}function $Z(t){return t.length<3?0:Math.abs(Y_e(t.map(function(e,r){var n=t[r+1]||t[0];return e[0]*n[1]-n[0]*e[1]})))/2}function U9(t,e){var r=e.width,n=e.height,i=e.left,a=e.top,s=ty(t),o=s.minX,c=s.minY,f=s.maxX,d=s.maxY,m=r/(f-o),b=n/(d-c);return t.map(function(x){return[i+(x[0]-o)*m,a+(x[1]-c)*b]})}function ty(t){var e=t.map(function(n){return n[0]}),r=t.map(function(n){return n[1]});return{minX:Math.min.apply(Math,e),minY:Math.min.apply(Math,r),maxX:Math.max.apply(Math,e),maxY:Math.max.apply(Math,r)}}function hR(t,e,r){var n=t[0],i=t[1],a=ty(e),s=a.minX,o=a.maxX,c=[[s,i],[o,i]],f=nE(c[0],c[1]),d=dR(e),m=[];if(d.forEach(function(E){var T=nE(E[0],E[1]),A=E[0];if(E1e(f,T))m.push({pos:t,line:E,type:"line"});else{var M=qZ(LO(f,T),[c,E]);M.forEach(function(F){E.some(function(N){return T1e(N,F)})?m.push({pos:F,line:E,type:"point"}):Pc(A[1]-i)!==0&&m.push({pos:F,line:E,type:"intersection"})})}}),pf(m,function(E){return E[0]===n}))return!0;var b=0,x={};return m.forEach(function(E){var T=E.pos,A=E.type,M=E.line;if(!(T[0]>n))if(A==="intersection")++b;else{if(A==="line")return;if(A==="point"){var F=pf(M,function(U){return U[1]!==i}),N=x[T[0]],O=F[1]>i?1:-1;N?N!==O&&++b:x[T[0]]=O}}}),b%2===1}function nE(t,e){var r=t[0],n=t[1],i=e[0],a=e[1],s=i-r,o=a-n;Math.abs(s)<Tl&&(s=0),Math.abs(o)<Tl&&(o=0);var c=0,f=0,d=0;return s?o?(c=-o/s,f=1,d=-c*r-n):(f=1,d=-n):o&&(c=-1,d=r),[c,f,d]}function LO(t,e){var r=t[0],n=t[1],i=t[2],a=e[0],s=e[1],o=e[2],c=r===0&&a===0,f=n===0&&s===0,d=[];if(c&&f)return[];if(c){var m=-i/n,b=-o/s;return m!==b?[]:[[-1/0,m],[1/0,m]]}else if(f){var x=-i/r,E=-o/a;return x!==E?[]:[[x,-1/0],[x,1/0]]}else if(r===0){var T=-i/n,A=-(s*T+o)/a;d=[[A,T]]}else if(a===0){var T=-o/s,A=-(n*T+i)/r;d=[[A,T]]}else if(n===0){var A=-i/r,T=-(a*A+o)/s;d=[[A,T]]}else if(s===0){var A=-o/a,T=-(r*A+i)/n;d=[[A,T]]}else{var A=(n*o-s*i)/(s*r-n*a),T=-(r*A+i)/n;d=[[A,T]]}return d.map(function(M){return[M[0],M[1]]})}function qZ(t,e){var r=e.map(function(m){return[0,1].map(function(b){return[Math.min(m[0][b],m[1][b]),Math.max(m[0][b],m[1][b])]})}),n=[];if(t.length===2){var i=t[0],a=i[0],s=i[1];if(Pc(a-t[1][0])){if(!Pc(s-t[1][1])){var f=Math.max.apply(Math,r.map(function(m){return m[0][0]})),d=Math.min.apply(Math,r.map(function(m){return m[0][1]}));if(Pc(f-d)>0)return[];n=[[f,s],[d,s]]}}else{var o=Math.max.apply(Math,r.map(function(m){return m[1][0]})),c=Math.min.apply(Math,r.map(function(m){return m[1][1]}));if(Pc(o-c)>0)return[];n=[[a,o],[a,c]]}}return n.length||(n=t.filter(function(m){var b=m[0],x=m[1];return r.every(function(E){return 0<=Pc(b-E[0][0])&&0<=Pc(E[0][1]-b)&&0<=Pc(x-E[1][0])&&0<=Pc(E[1][1]-x)})})),n.map(function(m){return[Pc(m[0]),Pc(m[1])]})}function dR(t){return S1e(t.slice(1),[t[0]]).map(function(e,r){return[t[r],e]})}function C1e(t,e){var r=t.slice(),n=e.slice();F9(r)===-1&&r.reverse(),F9(n)===-1&&n.reverse();var i=dR(r),a=dR(n),s=i.map(function(d){return nE(d[0],d[1])}),o=a.map(function(d){return nE(d[0],d[1])}),c=[];s.forEach(function(d,m){var b=i[m],x=[];o.forEach(function(E,T){var A=LO(d,E),M=qZ(A,[b,a[T]]);x.push.apply(x,M.map(function(F){return{index1:m,index2:T,pos:F,type:"intersection"}}))}),x.sort(function(E,T){return gp(b[0],E.pos)-gp(b[0],T.pos)}),c.push.apply(c,x),hR(b[1],n)&&c.push({index1:m,index2:-1,pos:b[1],type:"inside"})}),a.forEach(function(d,m){if(hR(d[1],r)){var b=!1,x=Sp(c,function(E){var T=E.index2;return T===m?(b=!0,!1):!!b});x===-1&&(b=!1,x=Sp(c,function(E){var T=E.index1,A=E.index2;return T===-1&&A+1===m?(b=!0,!1):!!b})),x===-1?c.push({index1:-1,index2:m,pos:d[1],type:"inside"}):c.splice(x,0,{index1:-1,index2:m,pos:d[1],type:"inside"})}});var f={};return c.filter(function(d){var m=d.pos,b=m[0]+"x"+m[1];return f[b]?!1:(f[b]=!0,!0)})}function A1e(t,e){var r=C1e(t,e);return r.map(function(n){var i=n.pos;return i})}function I1e(t,e){var r=A1e(t,e);return $Z(r)}/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var pR=function(t,e){return pR=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var i in n)n.hasOwnProperty(i)&&(r[i]=n[i])},pR(t,e)};function P1e(t,e){pR(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}var xl=function(){return xl=Object.assign||function(e){for(var r,n=1,i=arguments.length;n<i;n++){r=arguments[n];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},xl.apply(this,arguments)};function k1e(t,e){var r=e[0]-t[0],n=e[1]-t[1],i=Math.atan2(n,r);return i>=0?i:i+Math.PI*2}function qA(t){return k1e([t[0].clientX,t[0].clientY],[t[1].clientX,t[1].clientY])/Math.PI*180}function R1e(t){return t.touches&&t.touches.length>=2}function dw(t){return t?t.touches?D1e(t.touches):[HZ(t)]:[]}function M1e(t){return t&&(t.type.indexOf("mouse")>-1||"button"in t)}function V9(t,e,r){var n=r.length,i=pb(t,n),a=i.clientX,s=i.clientY,o=i.originalClientX,c=i.originalClientY,f=pb(e,n),d=f.clientX,m=f.clientY,b=pb(r,n),x=b.clientX,E=b.clientY,T=a-d,A=s-m,M=a-x,F=s-E;return{clientX:o,clientY:c,deltaX:T,deltaY:A,distX:M,distY:F}}function HA(t){return Math.sqrt(Math.pow(t[0].clientX-t[1].clientX,2)+Math.pow(t[0].clientY-t[1].clientY,2))}function D1e(t){for(var e=Math.min(t.length,2),r=[],n=0;n<e;++n)r.push(HZ(t[n]));return r}function HZ(t){return{clientX:t.clientX,clientY:t.clientY}}function pb(t,e){e===void 0&&(e=t.length);for(var r={clientX:0,clientY:0,originalClientX:0,originalClientY:0},n=Math.min(t.length,e),i=0;i<n;++i){var a=t[i];r.originalClientX+="originalClientX"in a?a.originalClientX:a.clientX,r.originalClientY+="originalClientY"in a?a.originalClientY:a.clientY,r.clientX+=a.clientX,r.clientY+=a.clientY}return e?{clientX:r.clientX/e,clientY:r.clientY/e,originalClientX:r.originalClientX/e,originalClientY:r.originalClientY/e}:r}var GA=(function(){function t(e){this.prevClients=[],this.startClients=[],this.movement=0,this.length=0,this.startClients=e,this.prevClients=e,this.length=e.length}return t.prototype.getAngle=function(e){return e===void 0&&(e=this.prevClients),qA(e)},t.prototype.getRotation=function(e){return e===void 0&&(e=this.prevClients),qA(e)-qA(this.startClients)},t.prototype.getPosition=function(e,r){e===void 0&&(e=this.prevClients);var n=V9(e||this.prevClients,this.prevClients,this.startClients),i=n.deltaX,a=n.deltaY;return this.movement+=Math.sqrt(i*i+a*a),this.prevClients=e,n},t.prototype.getPositions=function(e){e===void 0&&(e=this.prevClients);for(var r=this.prevClients,n=this.startClients,i=Math.min(this.length,r.length),a=[],s=0;s<i;++s)a[s]=V9([e[s]],[r[s]],[n[s]]);return a},t.prototype.getMovement=function(e){var r=this.movement;if(!e)return r;var n=pb(e,this.length),i=pb(this.prevClients,this.length),a=n.clientX-i.clientX,s=n.clientY-i.clientY;return Math.sqrt(a*a+s*s)+r},t.prototype.getDistance=function(e){return e===void 0&&(e=this.prevClients),HA(e)},t.prototype.getScale=function(e){return e===void 0&&(e=this.prevClients),HA(e)/HA(this.startClients)},t.prototype.move=function(e,r){this.startClients.forEach(function(n){n.clientX-=e,n.clientY-=r}),this.prevClients.forEach(function(n){n.clientX-=e,n.clientY-=r})},t})(),$9=["textarea","input"],O1e=(function(t){P1e(e,t);function e(r,n){n===void 0&&(n={});var i=t.call(this)||this;i.options={},i.flag=!1,i.pinchFlag=!1,i.data={},i.isDrag=!1,i.isPinch=!1,i.clientStores=[],i.targets=[],i.prevTime=0,i.doubleFlag=!1,i._useMouse=!1,i._useTouch=!1,i._useDrag=!1,i._dragFlag=!1,i._isTrusted=!1,i._isMouseEvent=!1,i._isSecondaryButton=!1,i._preventMouseEvent=!1,i._prevInputEvent=null,i._isDragAPI=!1,i._isIdle=!0,i._preventMouseEventId=0,i._window=window,i.onDragStart=function(b,x){if(x===void 0&&(x=!0),!(!i.flag&&b.cancelable===!1)){var E=b.type.indexOf("drag")>=-1;if(!(i.flag&&E)){i._isDragAPI=!0;var T=i.options,A=T.container,M=T.pinchOutside,F=T.preventWheelClick,N=T.preventRightClick,O=T.preventDefault,U=T.checkInput,j=T.dragFocusedInput,H=T.preventClickEventOnDragStart,W=T.preventClickEventOnDrag,X=T.preventClickEventByCondition,oe=i._useTouch,Q=!i.flag;if(i._isSecondaryButton=b.which===3||b.button===2,F&&(b.which===2||b.button===1)||N&&(b.which===3||b.button===2))return i.stop(),!1;if(Q){var G=i._window.document.activeElement,ae=b.target;if(ae){var se=ae.tagName.toLowerCase(),fe=$9.indexOf(se)>-1,_e=ae.isContentEditable;if(fe||_e){if(U||!j&&G===ae)return!1;if(G&&(G===ae||_e&&G.isContentEditable&&G.contains(ae)))if(j)ae.blur();else return!1}else if((O||b.type==="touchstart")&&G){var Le=G.tagName.toLowerCase();(G.isContentEditable||$9.indexOf(Le)>-1)&&G.blur()}(H||W||X)&&Gu(i._window,"click",i._onClick,!0)}i.clientStores=[new GA(dw(b))],i._isIdle=!1,i.flag=!0,i.isDrag=!1,i._isTrusted=x,i._dragFlag=!0,i._prevInputEvent=b,i.data={},i.doubleFlag=Hb()-i.prevTime<200,i._isMouseEvent=M1e(b),!i._isMouseEvent&&i._preventMouseEvent&&i._allowMouseEvent();var ye=i._preventMouseEvent||i.emit("dragStart",xl(xl({data:i.data,datas:i.data,inputEvent:b,isMouseEvent:i._isMouseEvent,isSecondaryButton:i._isSecondaryButton,isTrusted:x,isDouble:i.doubleFlag},i.getCurrentStore().getPosition()),{preventDefault:function(){b.preventDefault()},preventDrag:function(){i._dragFlag=!1}}));ye===!1&&i.stop(),i._isMouseEvent&&i.flag&&O&&b.preventDefault()}if(!i.flag)return!1;var Te=0;if(Q?(i._attchDragEvent(),oe&&M&&(Te=setTimeout(function(){Gu(A,"touchstart",i.onDragStart,{passive:!1})}))):oe&&M&&_u(A,"touchstart",i.onDragStart),i.flag&&R1e(b)){if(clearTimeout(Te),Q&&b.touches.length!==b.changedTouches.length)return;i.pinchFlag||i.onPinchStart(b)}}}},i.onDrag=function(b,x){if(i.flag){var E=i.options.preventDefault;!i._isMouseEvent&&E&&b.preventDefault(),i._prevInputEvent=b;var T=dw(b),A=i.moveClients(T,b,!1);if(i._dragFlag){if(i.pinchFlag||A.deltaX||A.deltaY){var M=i._preventMouseEvent||i.emit("drag",xl(xl({},A),{isScroll:!!x,inputEvent:b}));if(M===!1){i.stop();return}}i.pinchFlag&&i.onPinch(b,T)}i.getCurrentStore().getPosition(T,!0)}},i.onDragEnd=function(b){if(i.flag){var x=i.options,E=x.pinchOutside,T=x.container,A=x.preventClickEventOnDrag,M=x.preventClickEventOnDragStart,F=x.preventClickEventByCondition,N=i.isDrag;(A||M||F)&&requestAnimationFrame(function(){i._allowClickEvent()}),!F&&!M&&A&&!N&&i._allowClickEvent(),i._useTouch&&E&&_u(T,"touchstart",i.onDragStart),i.pinchFlag&&i.onPinchEnd(b);var O=b?.touches?dw(b):[],U=O.length;U===0||!i.options.keepDragging?i.flag=!1:i._addStore(new GA(O));var j=i._getPosition(),H=Hb(),W=!N&&i.doubleFlag;i._prevInputEvent=null,i.prevTime=N||W?0:H,i.flag||(i._dettachDragEvent(),i._preventMouseEvent||i.emit("dragEnd",xl({data:i.data,datas:i.data,isDouble:W,isDrag:N,isClick:!N,isMouseEvent:i._isMouseEvent,isSecondaryButton:i._isSecondaryButton,inputEvent:b,isTrusted:i._isTrusted},j)),i.clientStores=[],i._isMouseEvent||(i._preventMouseEvent=!0,clearTimeout(i._preventMouseEventId),i._preventMouseEventId=setTimeout(function(){i._preventMouseEvent=!1},200)),i._isIdle=!0)}},i.onBlur=function(){i.onDragEnd()},i._allowClickEvent=function(){_u(i._window,"click",i._onClick,!0)},i._onClick=function(b){i._allowClickEvent(),i._allowMouseEvent();var x=i.options.preventClickEventByCondition;x?.(b)||(b.stopPropagation(),b.preventDefault())},i._onContextMenu=function(b){var x=i.options;x.preventRightClick?i.onDragEnd(b):b.preventDefault()},i._passCallback=function(){};var a=[].concat(r),s=a[0];i._window=FZ(s)?s:xg(s),i.options=xl({checkInput:!1,container:s&&!("document"in s)?xg(s):s,preventRightClick:!0,preventWheelClick:!0,preventClickEventOnDragStart:!1,preventClickEventOnDrag:!1,preventClickEventByCondition:null,preventDefault:!0,checkWindowBlur:!1,keepDragging:!1,pinchThreshold:0,events:["touch","mouse"]},n);var o=i.options,c=o.container,f=o.events,d=o.checkWindowBlur;if(i._useDrag=f.indexOf("drag")>-1,i._useTouch=f.indexOf("touch")>-1,i._useMouse=f.indexOf("mouse")>-1,i.targets=a,i._useDrag&&a.forEach(function(b){Gu(b,"dragstart",i.onDragStart)}),i._useMouse&&(a.forEach(function(b){Gu(b,"mousedown",i.onDragStart),Gu(b,"mousemove",i._passCallback)}),Gu(c,"contextmenu",i._onContextMenu)),d&&Gu(xg(),"blur",i.onBlur),i._useTouch){var m={passive:!1};a.forEach(function(b){Gu(b,"touchstart",i.onDragStart,m),Gu(b,"touchmove",i._passCallback,m)})}return i}return e.prototype.stop=function(){this.isDrag=!1,this.data={},this.clientStores=[],this.pinchFlag=!1,this.doubleFlag=!1,this.prevTime=0,this.flag=!1,this._isIdle=!0,this._allowClickEvent(),this._dettachDragEvent(),this._isDragAPI=!1},e.prototype.getMovement=function(r){return this.getCurrentStore().getMovement(r)+this.clientStores.slice(1).reduce(function(n,i){return n+i.movement},0)},e.prototype.isDragging=function(){return this.isDrag},e.prototype.isIdle=function(){return this._isIdle},e.prototype.isFlag=function(){return this.flag},e.prototype.isPinchFlag=function(){return this.pinchFlag},e.prototype.isDoubleFlag=function(){return this.doubleFlag},e.prototype.isPinching=function(){return this.isPinch},e.prototype.scrollBy=function(r,n,i,a){a===void 0&&(a=!0),this.flag&&(this.clientStores[0].move(r,n),a&&this.onDrag(i,!0))},e.prototype.move=function(r,n){var i=r[0],a=r[1],s=this.getCurrentStore(),o=s.prevClients;return this.moveClients(o.map(function(c){var f=c.clientX,d=c.clientY;return{clientX:f+i,clientY:d+a,originalClientX:f,originalClientY:d}}),n,!0)},e.prototype.triggerDragStart=function(r){this.onDragStart(r,!1)},e.prototype.setEventData=function(r){var n=this.data;for(var i in r)n[i]=r[i];return this},e.prototype.setEventDatas=function(r){return this.setEventData(r)},e.prototype.getCurrentEvent=function(r){return r===void 0&&(r=this._prevInputEvent),xl(xl({data:this.data,datas:this.data},this._getPosition()),{movement:this.getMovement(),isDrag:this.isDrag,isPinch:this.isPinch,isScroll:!1,inputEvent:r})},e.prototype.getEventData=function(){return this.data},e.prototype.getEventDatas=function(){return this.data},e.prototype.unset=function(){var r=this,n=this.targets,i=this.options.container;this.off(),_u(this._window,"blur",this.onBlur),this._useDrag&&n.forEach(function(a){_u(a,"dragstart",r.onDragStart)}),this._useMouse&&(n.forEach(function(a){_u(a,"mousedown",r.onDragStart)}),_u(i,"contextmenu",this._onContextMenu)),this._useTouch&&(n.forEach(function(a){_u(a,"touchstart",r.onDragStart)}),_u(i,"touchstart",this.onDragStart)),this._prevInputEvent=null,this._allowClickEvent(),this._dettachDragEvent()},e.prototype.onPinchStart=function(r){var n=this,i=this.options.pinchThreshold;if(!(this.isDrag&&this.getMovement()>i)){var a=new GA(dw(r));this.pinchFlag=!0,this._addStore(a);var s=this.emit("pinchStart",xl(xl({data:this.data,datas:this.data,angle:a.getAngle(),touches:this.getCurrentStore().getPositions()},a.getPosition()),{inputEvent:r,isTrusted:this._isTrusted,preventDefault:function(){r.preventDefault()},preventDrag:function(){n._dragFlag=!1}}));s===!1&&(this.pinchFlag=!1)}},e.prototype.onPinch=function(r,n){if(!(!this.flag||!this.pinchFlag||n.length<2)){var i=this.getCurrentStore();this.isPinch=!0,this.emit("pinch",xl(xl({data:this.data,datas:this.data,movement:this.getMovement(n),angle:i.getAngle(n),rotation:i.getRotation(n),touches:i.getPositions(n),scale:i.getScale(n),distance:i.getDistance(n)},i.getPosition(n)),{inputEvent:r,isTrusted:this._isTrusted}))}},e.prototype.onPinchEnd=function(r){if(this.pinchFlag){var n=this.isPinch;this.isPinch=!1,this.pinchFlag=!1;var i=this.getCurrentStore();this.emit("pinchEnd",xl(xl({data:this.data,datas:this.data,isPinch:n,touches:i.getPositions()},i.getPosition()),{inputEvent:r}))}},e.prototype.getCurrentStore=function(){return this.clientStores[0]},e.prototype.moveClients=function(r,n,i){var a=this._getPosition(r,i),s=this.isDrag;(a.deltaX||a.deltaY)&&(this.isDrag=!0);var o=!1;return!s&&this.isDrag&&(o=!0),xl(xl({data:this.data,datas:this.data},a),{movement:this.getMovement(r),isDrag:this.isDrag,isPinch:this.isPinch,isScroll:!1,isMouseEvent:this._isMouseEvent,isSecondaryButton:this._isSecondaryButton,inputEvent:n,isTrusted:this._isTrusted,isFirstDrag:o})},e.prototype._addStore=function(r){this.clientStores.splice(0,0,r)},e.prototype._getPosition=function(r,n){var i=this.getCurrentStore(),a=i.getPosition(r,n),s=this.clientStores.slice(1).reduce(function(f,d){var m=d.getPosition();return f.distX+=m.distX,f.distY+=m.distY,f},a),o=s.distX,c=s.distY;return xl(xl({},a),{distX:o,distY:c})},e.prototype._attchDragEvent=function(){var r=this._window,n=this.options.container,i={passive:!1};this._isDragAPI&&(Gu(n,"dragover",this.onDrag,i),Gu(r,"dragend",this.onDragEnd)),this._useMouse&&(Gu(n,"mousemove",this.onDrag),Gu(r,"mouseup",this.onDragEnd)),this._useTouch&&(Gu(n,"touchmove",this.onDrag,i),Gu(r,"touchend",this.onDragEnd,i),Gu(r,"touchcancel",this.onDragEnd,i))},e.prototype._dettachDragEvent=function(){var r=this._window,n=this.options.container;this._isDragAPI&&(_u(n,"dragover",this.onDrag),_u(r,"dragend",this.onDragEnd)),this._useMouse&&(_u(n,"mousemove",this.onDrag),_u(r,"mouseup",this.onDragEnd)),this._useTouch&&(_u(n,"touchstart",this.onDragStart),_u(n,"touchmove",this.onDrag),_u(r,"touchend",this.onDragEnd),_u(r,"touchcancel",this.onDragEnd))},e.prototype._allowMouseEvent=function(){this._preventMouseEvent=!1,clearTimeout(this._preventMouseEventId)},e})(NO);function N1e(t){for(var e=5381,r=t.length;r;)e=e*33^t.charCodeAt(--r);return e>>>0}var L1e=N1e;function F1e(t){return L1e(t).toString(36)}function B1e(t){if(t&&t.getRootNode){var e=t.getRootNode();if(e.nodeType===11)return e}}function z1e(t,e,r){return r.original?e:e.replace(/([^};{\s}][^};{]*|^\s*){/mg,function(n,i){var a=i.trim();return(a?km(a):[""]).map(function(s){var o=s.trim();return o.indexOf("@")===0?o:o.indexOf(":global")>-1?o.replace(/\:global/g,""):o.indexOf(":host")>-1?"".concat(o.replace(/\:host/g,".".concat(t))):o?".".concat(t," ").concat(o):".".concat(t)}).join(", ")+" {"})}function j1e(t,e,r,n,i){var a=PO(n),s=a.createElement("style");return s.setAttribute("type","text/css"),s.setAttribute("data-styled-id",t),s.setAttribute("data-styled-count","1"),r.nonce&&s.setAttribute("nonce",r.nonce),s.innerHTML=z1e(t,e,r),(i||a.head||a.body).appendChild(s),s}function U1e(t){var e="rCS"+F1e(t);return{className:e,inject:function(r,n){n===void 0&&(n={});var i=B1e(r),a=(i||r.ownerDocument||document).querySelector('style[data-styled-id="'.concat(e,'"]'));if(!a)a=j1e(e,t,n,r,i);else{var s=parseFloat(a.getAttribute("data-styled-count"))||0;a.setAttribute("data-styled-count","".concat(s+1))}return{destroy:function(){var o,c=parseFloat(a.getAttribute("data-styled-count"))||0;c<=1?(a.remove?a.remove():(o=a.parentNode)===null||o===void 0||o.removeChild(a),a=null):a.setAttribute("data-styled-count","".concat(c-1))}}}}}var gR=function(){return gR=Object.assign||function(e){for(var r,n=1,i=arguments.length;n<i;n++){r=arguments[n];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},gR.apply(this,arguments)};function V1e(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(t);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(r[n[i]]=t[n[i]]);return r}function GZ(t,e){var r=U1e(e),n=r.className;return te.forwardRef(function(i,a){var s=i.className,o=s===void 0?"":s;i.cspNonce;var c=V1e(i,["className","cspNonce"]),f=te.useRef();return te.useImperativeHandle(a,function(){return f.current},[]),te.useEffect(function(){var d=r.inject(f.current,{nonce:i.cspNonce});return function(){d.destroy()}},[]),te.createElement(t,gR({ref:f,"data-styled-id":n,className:"".concat(o," ").concat(n)},c))})}var mR=function(t,e){return mR=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(r[i]=n[i])},mR(t,e)};function jx(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");mR(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}var Wt=function(){return Wt=Object.assign||function(e){for(var r,n=1,i=arguments.length;n<i;n++){r=arguments[n];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},Wt.apply(this,arguments)};function $1e(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(t);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(r[n[i]]=t[n[i]]);return r}function q1e(t,e,r,n){var i=arguments.length,a=i<3?e:n,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(t,e,r,n);else for(var o=t.length-1;o>=0;o--)(s=t[o])&&(a=(i<3?s(a):i>3?s(e,r,a):s(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a}function H1e(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Kt(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var n=r.call(t),i,a=[],s;try{for(;(e===void 0||e-- >0)&&!(i=n.next()).done;)a.push(i.value)}catch(o){s={error:o}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(s)throw s.error}}return a}function yn(t,e,r){if(arguments.length===2)for(var n=0,i=e.length,a;n<i;n++)(a||!(n in e))&&(a||(a=Array.prototype.slice.call(e,0,n)),a[n]=e[n]);return t.concat(a||Array.prototype.slice.call(e))}function Ux(t,e){return Wt({events:[],props:[],name:t},e)}var G1e=["n","w","s","e"],FO=["n","w","s","e","nw","ne","sw","se"];function W1e(t,e){return'data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="'.concat(32*t,'px" height="').concat(32*t,'px" viewBox="0 0 32 32" ><path d="M 16,5 L 12,10 L 14.5,10 L 14.5,22 L 12,22 L 16,27 L 20,22 L 17.5,22 L 17.5,10 L 20, 10 L 16,5 Z" stroke-linejoin="round" stroke-width="1.2" fill="black" stroke="white" style="transform:rotate(').concat(e,'deg);transform-origin: 16px 16px"></path></svg>')}function X1e(t){var e=W1e(1,t),r=Math.round(t/45)*45%180,n="ns-resize";return r===135?n="nwse-resize":r===45?n="nesw-resize":r===90&&(n="ew-resize"),"cursor:".concat(n,";cursor: url('").concat(e,"') 16 16, ").concat(n,";")}var m_=O_e(),WZ=m_.browser.webkit,XZ=WZ&&(function(){var t=typeof window>"u"?{userAgent:""}:window.navigator,e=/applewebkit\/([^\s]+)/g.exec(t.userAgent.toLowerCase());return e?parseFloat(e[1])<605:!1})(),YZ=m_.browser.name,ZZ=parseInt(m_.browser.version,10),Y1e=YZ==="chrome",Z1e=m_.browser.chromium,K1e=parseInt(m_.browser.chromiumVersion,10)||0,J1e=Y1e&&ZZ>=109||Z1e&&K1e>=109,Q1e=YZ==="firefox",ebe=parseInt(m_.browser.webkitVersion,10)>=612||ZZ>=15,BO="moveable-",tbe=FO.map(function(t){var e="",r="",n="center",i="center",a="calc(var(--moveable-control-padding, 20) * -1px)";return t.indexOf("n")>-1&&(e="top: ".concat(a,";"),i="bottom"),t.indexOf("s")>-1&&(e="top: 0px;",i="top"),t.indexOf("w")>-1&&(r="left: ".concat(a,";"),n="right"),t.indexOf("e")>-1&&(r="left: 0px;",n="left"),'.around-control[data-direction*="'.concat(t,`"] {
        `).concat(r).concat(e,`
        transform-origin: `).concat(n," ").concat(i,`;
    }`)}).join(`
`),rbe=`
{
position: absolute;
width: 1px;
height: 1px;
left: 0;
top: 0;
z-index: 3000;
--moveable-color: #4af;
--zoom: 1;
--zoompx: 1px;
--moveable-line-padding: 0;
--moveable-control-padding: 0;
will-change: transform;
outline: 1px solid transparent;
}
.control-box {
z-index: 0;
}
.line, .control {
position: absolute;
left: 0;
top: 0;
will-change: transform;
}
.control {
width: 14px;
height: 14px;
border-radius: 50%;
border: 2px solid #fff;
box-sizing: border-box;
background: #4af;
background: var(--moveable-color);
margin-top: -7px;
margin-left: -7px;
border: 2px solid #fff;
z-index: 10;
}
.around-control {
position: absolute;
will-change: transform;
width: calc(var(--moveable-control-padding, 20) * 1px);
height: calc(var(--moveable-control-padding, 20) * 1px);
left: calc(var(--moveable-control-padding, 20) * -0.5px);
top: calc(var(--moveable-control-padding, 20) * -0.5px);
box-sizing: border-box;
background: transparent;
z-index: 8;
cursor: alias;
transform-origin: center center;
}
`.concat(tbe,`
.padding {
position: absolute;
top: 0px;
left: 0px;
width: 100px;
height: 100px;
transform-origin: 0 0;
}
.line {
width: 1px;
height: 1px;
background: #4af;
background: var(--moveable-color);
transform-origin: 0px 50%;
}
.line.edge {
z-index: 1;
background: transparent;
}
.line.dashed {
box-sizing: border-box;
background: transparent;
}
.line.dashed.horizontal {
border-top: 1px dashed #4af;
border-top-color: #4af;
border-top-color: var(--moveable-color);
}
.line.dashed.vertical {
border-left: 1px dashed #4af;
border-left-color: #4af;
border-left-color: var(--moveable-color);
}
.line.vertical {
transform: translateX(-50%);
}
.line.horizontal {
transform: translateY(-50%);
}
.line.vertical.bold {
width: 2px;
}
.line.horizontal.bold {
height: 2px;
}

.control.origin {
border-color: #f55;
background: #fff;
width: 12px;
height: 12px;
margin-top: -6px;
margin-left: -6px;
pointer-events: none;
}
`).concat([0,15,30,45,60,75,90,105,120,135,150,165].map(function(t){return`
.direction[data-rotation="`.concat(t,'"], :global .view-control-rotation').concat(t,` {
`).concat(X1e(t),`
}
`)}).join(`
`),`

.line.direction:before {
content: "";
position: absolute;
width: 100%;
height: calc(var(--moveable-line-padding, 0) * 1px);
bottom: 0;
left: 0;
}
.group {
z-index: -1;
}
.area {
position: absolute;
}
.area-pieces {
position: absolute;
top: 0;
left: 0;
display: none;
}
.area.avoid, .area.pass {
pointer-events: none;
}
.area.avoid+.area-pieces {
display: block;
}
.area-piece {
position: absolute;
}

`).concat(XZ?`:global svg *:before {
content:"";
transform-origin: inherit;
}`:"",`
`),nbe=[[0,1,2],[1,0,3],[2,0,3],[3,1,2]],yR=1e-4,xc=1e-7,pw=1e-9,vR=Math.pow(10,10),q9=-vR,ibe={n:[0,-1],e:[1,0],s:[0,1],w:[-1,0],nw:[-1,-1],ne:[1,-1],sw:[-1,1],se:[1,1]},zO={n:[0,1],e:[1,3],s:[3,2],w:[2,0],nw:[0],ne:[1],sw:[2],se:[3]},KZ={n:0,s:180,w:270,e:90,nw:315,ne:45,sw:225,se:135},abe=["isMoveableElement","updateRect","updateTarget","destroy","dragStart","isInside","hitTest","setState","getRect","request","isDragging","getManager","forceUpdate","waitToChangeTarget","updateSelectors","getTargets","stopDrag","getControlBoxElement","getMoveables","getDragElement"];function Vx(t,e,r,n,i,a){var s,o;a===void 0&&(a="draggable");var c=(o=(s=e.gestos[a])===null||s===void 0?void 0:s.move(r,t.inputEvent))!==null&&o!==void 0?o:{},f=c.originalDatas||c.datas,d=f[a]||(f[a]={});return Wt(Wt({},c),{isPinch:!!n,parentEvent:!0,datas:d,originalDatas:t.originalDatas})}var H0=(function(){function t(e){var r;e===void 0&&(e="draggable"),this.ableName=e,this.prevX=0,this.prevY=0,this.startX=0,this.startY=0,this.isDrag=!1,this.isFlag=!1,this.datas={draggable:{}},this.datas=(r={},r[e]={},r)}return t.prototype.dragStart=function(e,r){this.isDrag=!1,this.isFlag=!1;var n=r.originalDatas;return this.datas=n,n[this.ableName]||(n[this.ableName]={}),Wt(Wt({},this.move(e,r.inputEvent)),{type:"dragstart"})},t.prototype.drag=function(e,r){return this.move([e[0]-this.prevX,e[1]-this.prevY],r)},t.prototype.move=function(e,r){var n,i,a=!1;if(!this.isFlag)this.prevX=e[0],this.prevY=e[1],this.startX=e[0],this.startY=e[1],n=e[0],i=e[1],this.isFlag=!0;else{var s=this.isDrag;n=this.prevX+e[0],i=this.prevY+e[1],(e[0]||e[1])&&(this.isDrag=!0),!s&&this.isDrag&&(a=!0)}return this.prevX=n,this.prevY=i,{type:"drag",clientX:n,clientY:i,inputEvent:r,isFirstDrag:a,isDrag:this.isDrag,distX:n-this.startX,distY:i-this.startY,deltaX:e[0],deltaY:e[1],datas:this.datas[this.ableName],originalDatas:this.datas,parentEvent:!0,parentGesto:this}},t})();function P0(t,e,r,n){var i=t.length===16,a=i?4:3,s=Ey(t,r,n,a),o=Kt(s,4),c=Kt(o[0],2),f=c[0],d=c[1],m=Kt(o[1],2),b=m[0],x=m[1],E=Kt(o[2],2),T=E[0],A=E[1],M=Kt(o[3],2),F=M[0],N=M[1],O=Kt(bs(t,e,a),2),U=O[0],j=O[1],H=Math.min(f,b,T,F),W=Math.min(d,x,A,N),X=Math.max(f,b,T,F),oe=Math.max(d,x,A,N);f=f-H||0,b=b-H||0,T=T-H||0,F=F-H||0,d=d-W||0,x=x-W||0,A=A-W||0,N=N-W||0,U=U-H||0,j=j-W||0;var Q=t[0],G=t[a+1],ae=mc(Q*G);return{left:H,top:W,right:X,bottom:oe,origin:[U,j],pos1:[f,d],pos2:[b,x],pos3:[T,A],pos4:[F,N],direction:ae}}function JZ(t,e){var r=e.clientX,n=e.clientY,i=e.datas,a=t.state,s=a.moveableClientRect,o=a.rootMatrix,c=a.is3d,f=a.pos1,d=s.left,m=s.top,b=c?4:3,x=Kt(_i(X0(o,[r-d,n-m],b),f),2),E=x[0],T=x[1],A=Kt(Rd({datas:i,distX:E,distY:T}),2),M=A[0],F=A[1];return[M,F]}function Sy(t,e){var r=e.datas,n=t.state,i=n.allMatrix,a=n.beforeMatrix,s=n.is3d,o=n.left,c=n.top,f=n.origin,d=n.offsetMatrix,m=n.targetMatrix,b=n.transformOrigin,x=s?4:3;r.is3d=s,r.matrix=i,r.targetMatrix=m,r.beforeMatrix=a,r.offsetMatrix=d,r.transformOrigin=b,r.inverseMatrix=Ed(i,x),r.inverseBeforeMatrix=Ed(a,x),r.absoluteOrigin=Qm(Ma([o,c],f),x),r.startDragBeforeDist=tc(r.inverseBeforeMatrix,r.absoluteOrigin,x),r.startDragDist=tc(r.inverseMatrix,r.absoluteOrigin,x)}function obe(t){return P0(t.datas.beforeTransform,[50,50],100,100).direction}function n3(t,e,r){var n=e.datas,i=e.originalDatas.beforeRenderable,a=n.transformIndex,s=i.nextTransforms,o=s.length,c=i.nextTransformAppendedIndexes,f=-1;a===-1?(r==="translate"?f=0:r==="rotate"&&(f=Sp(s,function(x){return x.match(/scale\(/g)})),f===-1&&(f=s.length),n.transformIndex=f):pf(c,function(x){return x.index===a&&x.functionName===r})?f=a:f=a+c.filter(function(x){return x.index<a}).length;var d=Mxe(s,t.state,f),m=d.targetFunction,b=r==="rotate"?"rotateZ":r;n.beforeFunctionTexts=d.beforeFunctionTexts,n.afterFunctionTexts=d.afterFunctionTexts,n.beforeTransform=d.beforeFunctionMatrix,n.beforeTransform2=d.beforeFunctionMatrix2,n.targetTansform=d.targetFunctionMatrix,n.afterTransform=d.afterFunctionMatrix,n.afterTransform2=d.afterFunctionMatrix2,n.targetAllTransform=d.allFunctionMatrix,m.functionName===b?(n.afterFunctionTexts.splice(0,1),n.isAppendTransform=!1):o>f&&(n.isAppendTransform=!0,i.nextTransformAppendedIndexes=yn(yn([],Kt(c),!1),[{functionName:r,index:f,isAppend:!0}],!1))}function i3(t,e,r){return"".concat(t.beforeFunctionTexts.join(" ")," ").concat(t.isAppendTransform?r:e," ").concat(t.afterFunctionTexts.join(" "))}function sbe(t){var e=t.datas,r=t.distX,n=t.distY,i=Kt(eK({datas:e,distX:r,distY:n}),2),a=i[0],s=i[1],o=QZ(e,n1e([a,s],4));return tc(o,Qm([0,0,0],4),4)}function QZ(t,e,r){var n=t.beforeTransform,i=t.afterTransform,a=t.beforeTransform2,s=t.afterTransform2,o=t.targetAllTransform,c=r?wo(o,e,4):wo(e,o,4),f=wo(Ed(r?a:n,4),c,4),d=wo(f,Ed(r?s:i,4),4);return d}function eK(t){var e=t.datas,r=t.distX,n=t.distY,i=e.inverseBeforeMatrix,a=e.is3d,s=e.startDragBeforeDist,o=e.absoluteOrigin,c=a?4:3;return _i(tc(i,Ma(o,[r,n]),c),s)}function Rd(t,e){var r=t.datas,n=t.distX,i=t.distY,a=r.inverseBeforeMatrix,s=r.inverseMatrix,o=r.is3d,c=r.startDragBeforeDist,f=r.startDragDist,d=r.absoluteOrigin,m=o?4:3;return _i(tc(e?a:s,Ma(d,[n,i]),m),e?c:f)}function lbe(t,e){var r=t.datas,n=t.distX,i=t.distY;r.beforeMatrix;var a=r.matrix,s=r.is3d;r.startDragBeforeDist;var o=r.startDragDist,c=r.absoluteOrigin,f=s?4:3;return _i(tc(a,Ma(o,[n,i]),f),c)}function ube(t,e,r,n,i,a){return n===void 0&&(n=e),i===void 0&&(i=r),a===void 0&&(a=[0,0]),t?t.map(function(s,o){var c=Fx(s),f=c.value,d=c.unit,m=o?i:n,b=o?r:e;if(s==="%"||isNaN(f)){var x=m?a[o]/m:0;return b*x}else if(d!=="%")return f;return b*f/100}):a}function tK(t){var e=[];return t[1]>=0&&(t[0]>=0&&e.push(3),t[0]<=0&&e.push(2)),t[1]<=0&&(t[0]>=0&&e.push(1),t[0]<=0&&e.push(0)),e}function cbe(t,e){return tK(e).map(function(r){return t[r]})}function WA(t,e){var r=(e+1)/2;return[tE(t[0][0],t[1][0],r,1-r),tE(t[0][1],t[1][1],r,1-r)]}function zl(t,e){var r=WA([t[0],t[1]],e[0]),n=WA([t[2],t[3]],e[0]);return WA([r,n],e[1])}function fbe(t,e,r,n,i,a){var s=Ey(e,r,n,i),o=zl(s,a),c=t[0]-o[0],f=t[1]-o[1];return[c,f]}function $x(t,e,r,n){return wo(t,mb(e,n,r),n)}function hbe(t,e,r,n){var i=t.transformOrigin,a=t.offsetMatrix,s=t.is3d,o=s?4:3,c;if(kp(r)){var f=e.beforeTransform,d=e.afterTransform;n?c=Ih(Gb(r),4,o):c=Ih(wo(wo(f,Gb([r]),4),d,4),4,o)}else c=r;return $x(a,c,i,o)}function dbe(t,e){var r=t.transformOrigin,n=t.offsetMatrix,i=t.is3d,a=t.targetMatrix,s=t.targetAllTransform,o=i?4:3;return $x(n,wo(s||a,MO(e,o),o),r,o)}function a3(t,e){var r=y_(e);return{setTransform:function(n,i){i===void 0&&(i=-1),r.startTransforms=su(n)?n:Cg(n),_R(t,e,i)},setTransformIndex:function(n){_R(t,e,n)}}}function o3(t,e,r){var n=y_(e),i=n.startTransforms;_R(t,e,Sp(i,function(a){return a.indexOf("".concat(r,"("))===0}))}function _R(t,e,r){var n=y_(e),i=e.datas;if(i.transformIndex=r,r!==-1){var a=n.startTransforms[r];if(a){var s=t.state,o=q0([a],{"x%":function(c){return c/100*s.offsetWidth},"y%":function(c){return c/100*s.offsetHeight}});i.startValue=o[0].functionValue}}}function jO(t,e){var r=y_(t);r.nextTransforms=Cg(e)}function y_(t){return t.originalDatas.beforeRenderable}function iE(t){var e=t.originalDatas.beforeRenderable;return e.nextTransforms}function gw(t){return(iE(t)||[]).join(" ")}function mw(t){return y_(t).nextStyle}function rK(t,e,r,n,i){jO(i,e);var a=gc.drag(t,Vx(i,t.state,r,n)),s=a?a.transform:e;return Wt(Wt({transform:e,drag:a},vc({transform:s},i)),{afterTransform:s})}function UO(t,e,r,n,i,a){var s=hbe(t.state,i,e,a),o=mbe(t,r,n,s);return o}function nK(t,e,r,n,i,a,s){var o=UO(t,e,r,i,a,s),c=t.state,f=c.left,d=c.top,m=t.props.groupable,b=m?f:0,x=m?d:0,E=_i(n,o);return _i(E,[b,x])}function pbe(t,e,r,n,i,a,s){var o=nK(t,e,r,n,i,a,s);return o}function gbe(t,e,r){return[e?-1+t[0]/(e/2):0,r?-1+t[1]/(r/2):0]}function mbe(t,e,r,n){n===void 0&&(n=t.state.allMatrix);var i=t.state,a=i.width,s=i.height,o=i.is3d,c=o?4:3,f=[a/2*(1+e[0])+r[0],s/2*(1+e[1])+r[1]];return bs(n,f,c)}function ybe(t,e,r){var n=r.fixedDirection,i=r.fixedPosition,a=r.fixedOffset;return nK(t,"rotate(".concat(e,"deg)"),n,i,a,r)}function vbe(t,e,r,n,i,a){var s=t.props.groupable,o=t.state,c=o.transformOrigin,f=o.offsetMatrix,d=o.is3d,m=o.width,b=o.height,x=o.left,E=o.top,T=a.fixedDirection,A=a.nextTargetMatrix||o.targetMatrix,M=d?4:3,F=ube(i,e,r,m,b,c),N=s?x:0,O=s?E:0,U=$x(f,A,F,M),j=fbe(n,U,e,r,M,T);return _i(j,[N,O])}function _be(t,e){return zl(Yf(t.state),e)}function bbe(t,e){var r=t.targetGesto,n=t.controlGesto,i;return r?.isFlag()&&(i=r.getEventData()[e]),!i&&n?.isFlag()&&(i=n.getEventData()[e]),i||{}}function xbe(t){if(t&&t.getRootNode){var e=t.getRootNode();if(e.nodeType===11)return e}}function wbe(t){var e=t("scale"),r=t("rotate"),n=t("translate"),i=[];return n&&n!=="0px"&&n!=="none"&&i.push("translate(".concat(n.split(/\s+/).join(","),")")),r&&r!=="1"&&r!=="none"&&i.push("rotate(".concat(r,")")),e&&e!=="1"&&e!=="none"&&i.push("scale(".concat(e.split(/\s+/).join(","),")")),i}function iK(t,e,r){for(var n=t,i=[],a=kO(t)||zg(t),s=!r&&t===e||t===a,o=s,c=!1,f=3,d,m,b,x=!1,E=Xb(e,e,!0).offsetParent,T=1;n&&!o;){o=s;var A=Fc(n),M=A("position"),F=IK(n),N=M==="fixed",O=wbe(A),U=i1e(_xe(F)),j=void 0,H=!1,W=!1,X=0,oe=0,Q=0,G=0,ae={hasTransform:!1,fixedContainer:null};N&&(x=!0,ae=Exe(n),E=ae.fixedContainer);var se=U.length;!c&&(se===16||O.length)&&(c=!0,f=4,TR(i),b&&(b=Ih(b,3,4))),c&&se===9&&(U=Ih(U,3,4));var fe=Sxe(n,t),_e=fe.tagName,Le=fe.hasOffset,ye=fe.isSVG,Te=fe.origin,Ie=fe.targetOrigin,Me=fe.offset,de=Kt(Me,2),Se=de[0],we=de[1];_e==="svg"&&!n.ownerSVGElement&&b&&(i.push({type:"target",target:n,matrix:Txe(n,f)}),i.push({type:"offset",target:n,matrix:Jo(f)}));var De=parseFloat(A("zoom"))||1;if(N)j=ae.fixedContainer,H=!0;else{var Fe=Xb(n,e,!1,!0,A),Xe=Fe.offsetZoom;if(j=Fe.offsetParent,H=Fe.isEnd,W=Fe.isStatic,T*=Xe,(Fe.isCustomElement||Xe!==1)&&W)Se-=j.offsetLeft,we-=j.offsetTop;else if(Q1e||J1e){var Be=Fe.parentSlotElement;if(Be){for(var st=j,Qe=0,it=0;st&&xbe(st);)Qe+=st.offsetLeft,it+=st.offsetTop,st=st.offsetParent;Se-=Qe,we-=it}}}if(WZ&&!ebe&&Le&&!ye&&W&&(M==="relative"||M==="static")&&(Se-=j.offsetLeft,we-=j.offsetTop,s=s||H),N)Le&&ae.hasTransform&&(Q=j.clientLeft,G=j.clientTop);else if(Le&&E!==j&&(X=j.clientLeft,oe=j.clientTop),Le&&j===a){var be=PK(n,!1);Se+=be[0],we+=be[1]}if(i.push({type:"target",target:n,matrix:mb(U,f,Te)}),O.length&&(i.push({type:"offset",target:n,matrix:Jo(f)}),i.push({type:"target",target:n,matrix:mb(Gb(O),f,Te)})),Le){var Ot=n===t,at=Ot?0:n.scrollLeft,$e=Ot?0:n.scrollTop;i.push({type:"offset",target:n,matrix:ey([Se-at+X-Q,we-$e+oe-G],f)})}else i.push({type:"offset",target:n,origin:Te});if(De!==1&&i.push({type:"zoom",target:n,matrix:mb(MO([De,De],f),f,[0,0])}),b||(b=U),d||(d=Te),m||(m=Ie),o||N)break;n=j,s=H,(!r||n===a)&&(o=s)}return b||(b=Jo(f)),d||(d=[0,0]),m||(m=[0,0]),{zoom:T,offsetContainer:E,matrixes:i,targetMatrix:b,transformOrigin:d,targetOrigin:m,is3d:c,hasFixed:x}}var Sm=null,Em=null,c0=null;function G0(t){t?(window.Map&&(Sm=new Map,Em=new Map),c0=[]):(Sm=null,c0=null,Em=null)}function Sbe(t){var e=Em?.get(t);if(e)return e;var r=yb(t,!0);return Em&&Em.set(t,r),r}function Ebe(t,e){if(c0){var r=pf(c0,function(i){return i[0][0]==t&&i[0][1]==e});if(r)return r[1]}var n=iK(t,e,!0);return c0&&c0.push([[t,e],n]),n}function Fc(t){var e=Sm?.get(t);if(!e){var r=xg(t).getComputedStyle(t);if(!Sm)return function(a){return r[a]};e={style:r,cached:{}},Sm.set(t,e)}var n=e.cached,i=e.style;return function(a){return a in n||(n[a]=i[a]),n[a]}}function Th(t,e,r){var n=r.originalDatas;n.groupable=n.groupable||{};var i=n.groupable;i.childDatas=i.childDatas||[];var a=i.childDatas;return t.moveables.map(function(s,o){return a[o]=a[o]||{},a[o][e]=a[o][e]||{},Wt(Wt({},r),{isRequestChild:!0,datas:a[o][e],originalDatas:a[o]})})}function XA(t,e,r,n,i,a,s){var o=!!r.match(/Start$/g),c=!!r.match(/End$/g),f=i.isPinch,d=i.datas,m=Th(t,e.name,i),b=t.moveables,x=[],E=m.map(function(T,A){var M=b[A],F=M.state,N=F.gestos,O=T;if(o)O=new H0(s).dragStart(n,T),x.push(O);else{if(N[s]||(N[s]=d.childGestos[A]),!N[s])return;O=Vx(T,F,n,f,a,s),x.push(O)}var U=e[r](M,Wt(Wt({},O),{parentFlag:!0}));return c&&(N[s]=null),U});return o&&(d.childGestos=b.map(function(T){return T.state.gestos[s]})),{eventParams:E,childEvents:x}}function mp(t,e,r,n,i,a){i===void 0&&(i=function(d,m){return m});var s=!!r.match(/End$/g),o=Th(t,e.name,n),c=t.moveables,f=o.map(function(d,m){var b=c[m],x=d;x=i(b,d);var E=e[r](b,Wt(Wt({},x),{parentFlag:!0}));return s&&(b.state.gestos={}),E});return f}function aE(t,e,r,n){var i=r.fixedDirection,a=r.fixedPosition,s=n.datas.startPositions||Yf(e.state),o=zl(s,i),c=Kt(tc(zx(-t.rotation/180*Math.PI,3),[o[0]-a[0],o[1]-a[1],1],3),2),f=c[0],d=c[1];return n.datas.originalX=f,n.datas.originalY=d,n}function aK(t,e,r,n){var i=t.getState(),a=i.renderPoses,s=i.rotation,o=i.direction,c=ry(t.props,e).zoom,f=gb(s/Math.PI*180),d={},m=t.renderState;m.renderDirectionMap||(m.renderDirectionMap={});var b=m.renderDirectionMap;r.forEach(function(E){var T=E.dir;d[T]=!0});var x=mc(o);return r.map(function(E){var T=E.data,A=E.classNames,M=E.dir,F=zO[M];if(!F||!d[M])return null;b[M]=!0;var N=(Fi(f,15)+x*KZ[M]+720)%180,O={};return g_(T).forEach(function(U){O["data-".concat(U)]=T[U]}),n.createElement("div",Wt({className:yi.apply(void 0,yn(["control","direction",M,e],Kt(A),!1)),"data-rotation":N,"data-direction":M},O,{key:"direction-".concat(M),style:uE.apply(void 0,yn([s,c],Kt(F.map(function(U){return a[U]})),!1))}))})}function oK(t,e,r,n){var i=ry(t.props,r),a=i.renderDirections,s=a===void 0?e:a,o=i.displayAroundControls;if(!s)return[];var c=s===!0?FO:s;return yn(yn([],Kt(o?cK(t,n,r,c):[]),!1),Kt(aK(t,r,c.map(function(f){return{data:{},classNames:[],dir:f}}),n)),!1)}function Wb(t,e,r,n,i,a){for(var s=[],o=6;o<arguments.length;o++)s[o-6]=arguments[o];var c=il(r,n),f=e?Fi(c/Math.PI*180,15)%180:-1;return t.createElement("div",{key:"line-".concat(a),className:yi.apply(void 0,yn(["line","direction",e?"edge":"",e],Kt(s),!1)),"data-rotation":f,"data-line-key":a,"data-direction":e,style:F1(r,n,i,c)})}function sK(t,e,r,n,i){var a=r===!0?G1e:r;return a.map(function(s,o){var c=Kt(zO[s],2),f=c[0],d=c[1];if(d!=null)return Wb(t,s,n[f],n[d],i,"".concat(e,"Edge").concat(o),e)}).filter(Boolean)}function lK(t){return function(e,r){var n=ry(e.props,t).edge;return n&&(n===!0||n.length)?yn(yn([],Kt(sK(r,t,n,e.getState().renderPoses,e.props.zoom)),!1),Kt(Tbe(e,t,r)),!1):uK(e,t,r)}}function uK(t,e,r){return oK(t,FO,e,r)}function Tbe(t,e,r){return oK(t,["nw","ne","sw","se"],e,r)}function cK(t,e,r,n){var i=t.renderState;i.renderDirectionMap||(i.renderDirectionMap={});var a=t.getState(),s=a.renderPoses,o=a.rotation,c=a.direction,f=i.renderDirectionMap,d=t.props.zoom,m=mc(c),b=o/Math.PI*180;return(n||g_(f)).map(function(x){var E=zO[x];if(!E)return null;var T=(Fi(b,15)+m*KZ[x]+720)%180,A=["around-control"];return r&&A.push("direction",r),e.createElement("div",{className:yi.apply(void 0,yn([],Kt(A),!1)),"data-rotation":T,"data-direction":x,key:"direction-around-".concat(x),style:uE.apply(void 0,yn([o,d],Kt(E.map(function(M){return s[M]})),!1))})})}function VO(t,e,r){var n=t||{},i=n.position,a=i===void 0?"client":i,s=n.left,o=s===void 0?-1/0:s,c=n.top,f=c===void 0?-1/0:c,d=n.right,m=d===void 0?1/0:d,b=n.bottom,x=b===void 0?1/0:b,E={position:a,left:o,top:f,right:m,bottom:x};return{vertical:H9(E,e,!0),horizontal:H9(E,r,!1)}}function s3(t,e){var r=t.state,n=r.containerClientRect,i=n.clientHeight,a=n.clientWidth,s=n.clientLeft,o=n.clientTop,c=r.snapOffset,f=c.left,d=c.top,m=c.right,b=c.bottom,x=e||t.props.bounds||{},E=x.position||"client",T=E==="css",A=x.left,M=A===void 0?-1/0:A,F=x.top,N=F===void 0?-1/0:F,O=x.right,U=O===void 0?T?-1/0:1/0:O,j=x.bottom,H=j===void 0?T?-1/0:1/0:j;return T&&(U=a+m-f-U,H=i+b-d-H),{left:M+f-s,right:U+f-s,top:N+d-o,bottom:H+d-o}}function Cbe(t,e,r){var n=s3(t),i=n.left,a=n.top,s=n.right,o=n.bottom,c=Kt(r,2),f=c[0],d=c[1],m=Kt(_i(r,e),2),b=m[0],x=m[1];nn(b)<xc&&(b=0),nn(x)<xc&&(x=0);var E=x>0,T=b>0,A={isBound:!1,offset:0,pos:0},M={isBound:!1,offset:0,pos:0};if(b===0&&x===0)return{vertical:A,horizontal:M};if(b===0)E?o<d&&(M.pos=o,M.offset=d-o):a>d&&(M.pos=a,M.offset=d-a);else if(x===0)T?s<f&&(A.pos=s,A.offset=f-s):i>f&&(A.pos=i,A.offset=f-i);else{var F=x/b,N=r[1]-F*f,O=0,U=0,j=!1;T&&s<=f?(O=F*s+N,U=s,j=!0):!T&&f<=i&&(O=F*i+N,U=i,j=!0),j&&(O<a||O>o)&&(j=!1),j||(E&&o<=d?(O=o,U=(O-N)/F,j=!0):!E&&d<=a&&(O=a,U=(O-N)/F,j=!0)),j&&(A.isBound=!0,A.pos=U,A.offset=f-U,M.isBound=!0,M.pos=O,M.offset=d-O)}return{vertical:A,horizontal:M}}function H9(t,e,r){var n=t[r?"left":"top"],i=t[r?"right":"bottom"],a=Math.min.apply(Math,yn([],Kt(e),!1)),s=Math.max.apply(Math,yn([],Kt(e),!1)),o=[];return n+1>a&&o.push({direction:"start",isBound:!0,offset:a-n,pos:n}),i-1<s&&o.push({direction:"end",isBound:!0,offset:s-i,pos:i}),o.length||o.push({isBound:!1,offset:0,pos:0}),o.sort(function(c,f){return nn(f.offset)-nn(c.offset)})}function G9(t,e,r){var n=r?t.map(function(i){return Bx(i,r)}):t;return n.some(function(i){return i[0]<e.left&&nn(i[0]-e.left)>.1||i[0]>e.right&&nn(i[0]-e.right)>.1||i[1]<e.top&&nn(i[1]-e.top)>.1||i[1]>e.bottom&&nn(i[1]-e.bottom)>.1})}function Abe(t,e,r){var n=Xf(t),i=Math.sqrt(n*n-e*e)||0;return[i,-i].sort(function(a,s){return nn(a-t[r?0:1])-nn(s-t[r?0:1])}).map(function(a){return il([0,0],r?[a,e]:[e,a])})}function Ibe(t,e,r,n,i){if(!t.props.bounds)return[];var a=i*Math.PI/180,s=s3(t),o=s.left,c=s.top,f=s.right,d=s.bottom,m=o-n[0],b=f-n[0],x=c-n[1],E=d-n[1],T={left:m,top:x,right:b,bottom:E};if(!G9(r,T,0))return[];var A=[];return[[m,0],[b,0],[x,1],[E,1]].forEach(function(M){var F=Kt(M,2),N=F[0],O=F[1];r.forEach(function(U){var j=il([0,0],U);A.push.apply(A,yn([],Kt(Abe(U,N,O).map(function(H){return a+H-j}).filter(function(H){return!G9(e,T,H)}).map(function(H){return Fi(H*180/Math.PI,xc)})),!1))})}),A}var Pbe=["left","right","center"],kbe=["top","bottom","middle"],W9={left:"start",right:"end",center:"center",top:"start",bottom:"end",middle:"center"},Ag={start:"left",end:"right",center:"center"},Ig={start:"top",end:"bottom",center:"middle"};function f0(){return{left:!1,top:!1,right:!1,bottom:!1}}function v_(t,e){var r=t.props,n=r.snappable,i=r.bounds,a=r.innerBounds,s=r.verticalGuidelines,o=r.horizontalGuidelines,c=r.snapGridWidth,f=r.snapGridHeight,d=t.state,m=d.guidelines,b=d.enableSnap;return!n||!b||e&&n!==!0&&n.indexOf(e)<0?!1:!!(c||f||i||a||m&&m.length||s&&s.length||o&&o.length)}function $O(t){return t===!1?{}:t===!0||!t?{left:!0,right:!0,top:!0,bottom:!0}:t}function Rbe(t,e){var r=$O(t),n={};for(var i in r)i in e&&r[i]&&(n[i]=e[i]);return n}function qO(t,e){var r=Rbe(t,e),n=kbe.filter(function(a){return a in r}),i=Pbe.filter(function(a){return a in r});return{horizontalNames:n,verticalNames:i,horizontal:n.map(function(a){return r[a]}),vertical:i.map(function(a){return r[a]})}}function Mbe(t,e,r){var n=bs(t,[e.clientLeft,e.clientTop],r);return[e.left+n[0],e.top+n[1]]}function Dbe(t){var e=Kt(t,2),r=e[0],n=e[1],i=n[0]-r[0],a=n[1]-r[1];Math.abs(i)<Tl&&(i=0),Math.abs(a)<Tl&&(a=0);var s=0,o=0,c=0;return i?a?(s=-a/i,o=1,c=s*r[0]-r[1]):(o=1,c=-r[1]):(s=-1,c=r[0]),[s,o,c].map(function(f){return Fi(f,Tl)})}var fK="snapRotationThreshold",hK="snapRotationDegrees",dK="snapHorizontalThreshold",pK="snapVerticalThreshold";function l3(t,e,r,n,i,a,s){var o;n===void 0&&(n=[]),i===void 0&&(i=[]);var c=t.props,f=((o=t.state.snapThresholdInfo)===null||o===void 0?void 0:o.multiples)||[1,1],d=l7(s,c[dK],5),m=l7(a,c[pK],5);return gK(t.state.guidelines,e,r,n,i,d,m,f)}function gK(t,e,r,n,i,a,s,o){return{vertical:Y9(t,"vertical",e,s*o[0],n),horizontal:Y9(t,"horizontal",r,a*o[1],i)}}function Obe(t,e,r){var n=Kt(r,2),i=n[0],a=n[1],s=Kt(e,2),o=s[0],c=s[1],f=Kt(_i(r,e),2),d=f[0],m=f[1],b=m>0,x=d>0;d=cE(d),m=cE(m);var E={isSnap:!1,offset:0,pos:0},T={isSnap:!1,offset:0,pos:0};if(d===0&&m===0)return{vertical:E,horizontal:T};var A=l3(t,d?[i]:[],m?[a]:[],[],[],void 0,void 0),M=A.vertical,F=A.horizontal;M.posInfos.filter(function(_e){var Le=_e.pos;return x?Le>=o:Le<=o}),F.posInfos.filter(function(_e){var Le=_e.pos;return b?Le>=c:Le<=c}),M.isSnap=M.posInfos.length>0,F.isSnap=F.posInfos.length>0;var N=bR(M),O=N.isSnap,U=N.guideline,j=bR(F),H=j.isSnap,W=j.guideline,X=H?W.pos[1]:0,oe=O?U.pos[0]:0;if(d===0)H&&(T.isSnap=!0,T.pos=W.pos[1],T.offset=a-T.pos);else if(m===0)O&&(E.isSnap=!0,E.pos=oe,E.offset=i-oe);else{var Q=m/d,G=r[1]-Q*i,ae=0,se=0,fe=!1;O?(se=oe,ae=Q*se+G,fe=!0):H&&(ae=X,se=(ae-G)/Q,fe=!0),fe&&(E.isSnap=!0,E.pos=se,E.offset=i-se,T.isSnap=!0,T.pos=ae,T.offset=a-ae)}return{vertical:E,horizontal:T}}function pg(t){var e="";return t===-1||t==="top"||t==="left"?e="start":t===0||t==="center"||t==="middle"?e="center":(t===1||t==="right"||t==="bottom")&&(e="end"),e}function X9(t,e,r,n){var i=qO(t.props.snapDirections,e),a=l3(t,i.vertical,i.horizontal,i.verticalNames.map(function(c){return pg(c)}),i.horizontalNames.map(function(c){return pg(c)}),r,n),s=pg(i.horizontalNames[a.horizontal.index]),o=pg(i.verticalNames[a.vertical.index]);return{vertical:Wt(Wt({},a.vertical),{direction:o}),horizontal:Wt(Wt({},a.horizontal),{direction:s})}}function bR(t){var e=t.isSnap;if(!e)return{isSnap:!1,offset:0,dist:-1,pos:0,guideline:null};var r=t.posInfos[0],n=r.guidelineInfos[0],i=n.offset,a=n.dist,s=n.guideline;return{isSnap:e,offset:i,dist:a,pos:r.pos,guideline:s}}function Y9(t,e,r,n,i){var a,s;if(i===void 0&&(i=[]),!t||!t.length)return{isSnap:!1,index:-1,direction:"",posInfos:[]};var o=e==="vertical",c=o?0:1,f=r.map(function(m,b){var x=i[b]||"",E=t.map(function(T){var A=T.pos,M=m-A[c];return{offset:M,dist:nn(M),guideline:T,direction:x}}).filter(function(T){var A=T.guideline,M=T.dist,F=A.type;return!(F!==e||M>n)}).sort(function(T,A){return T.dist-A.dist});return{pos:m,index:b,guidelineInfos:E,direction:x}}).filter(function(m){return m.guidelineInfos.length>0}).sort(function(m,b){return m.guidelineInfos[0].dist-b.guidelineInfos[0].dist}),d=f.length>0;return{isSnap:d,index:d?f[0].index:-1,direction:(s=(a=f[0])===null||a===void 0?void 0:a.direction)!==null&&s!==void 0?s:"",posInfos:f}}function Nbe(t,e,r,n,i){var a=[];r[0]&&r[1]?a=[r,[-r[0],r[1]],[r[0],-r[1]]]:!r[0]&&!r[1]?[[-1,-1],[1,-1],[1,1],[-1,1]].forEach(function(b,x,E){var T=E[x+1]||E[0];a.push(b),a.push([(b[0]+T[0])/2,(b[1]+T[1])/2])}):t.props.keepRatio?a.push([-1,-1],[-1,1],[1,-1],[1,1],r):(a.push.apply(a,yn([],Kt(cbe([[-1,-1],[1,-1],[-1,-1],[1,1]],r)),!1)),a.length>1&&a.push([(a[0][0]+a[1][0])/2,(a[0][1]+a[1][1])/2]));var s=a.map(function(b){return zl(e,b)}),o=s.map(function(b){return b[0]}),c=s.map(function(b){return b[1]}),f=l3(t,o,c,a.map(function(b){return pg(b[0])}),a.map(function(b){return pg(b[1])}),n,i),d=pg(a.map(function(b){return b[0]})[f.vertical.index]),m=pg(a.map(function(b){return b[1]})[f.horizontal.index]);return{vertical:Wt(Wt({},f.vertical),{direction:d}),horizontal:Wt(Wt({},f.horizontal),{direction:m})}}function mK(t,e){var r=nn(t.offset),n=nn(e.offset);return t.isBound&&e.isBound?n-r:t.isBound?-1:e.isBound?1:t.isSnap&&e.isSnap?n-r:t.isSnap?-1:e.isSnap||r<xc?1:n<xc?-1:r-n}function oE(t,e){return t.slice().sort(function(r,n){var i=r.sign[e],a=n.sign[e],s=r.offset[e],o=n.offset[e];if(i){if(!a)return-1}else return 1;return mK({isBound:r.isBound,isSnap:r.isSnap,offset:s},{isBound:n.isBound,isSnap:n.isSnap,offset:o})})[0]}function Lbe(t,e,r){var n=[];if(r)nn(e[0])!==1||nn(e[1])!==1?n.push([e,[-1,-1]],[e,[-1,1]],[e,[1,-1]],[e,[1,1]]):n.push([e,[t[0],-t[1]]],[e,[-t[0],t[1]]]),n.push([e,t]);else if(t[0]&&t[1]||!t[0]&&!t[1]){var i=t[0]?t:[1,1];[1,-1].forEach(function(s){[1,-1].forEach(function(o){var c=[s*i[0],o*i[1]];e[0]===c[0]&&e[1]===c[1]||n.push([e,c])})})}else if(t[0]){var a=nn(e[0])===1?[1]:[1,-1];a.forEach(function(s){n.push([[e[0],-1],[s*t[0],-1]],[[e[0],0],[s*t[0],0]],[[e[0],1],[s*t[0],1]])})}else if(t[1]){var a=nn(e[1])===1?[1]:[1,-1];a.forEach(function(o){n.push([[-1,e[1]],[-1,o*t[1]]],[[0,e[1]],[0,o*t[1]]],[[1,e[1]],[1,o*t[1]]])})}return n}function yK(t,e){var r=lR([e[0][0],e[1][0]]),n=lR([e[0][1],e[1][1]]);return{vertical:r<=t[0],horizontal:n<=t[1]}}function HO(t,e){var r=Kt(e,2),n=r[0],i=r[1],a=i[0]-n[0],s=i[1]-n[1];nn(a)<xc&&(a=0),nn(s)<xc&&(s=0);var o,c;if(!a)o=n[0],c=t[0];else if(!s)o=n[1],c=t[1];else{var f=s/a;o=f*(t[0]-n[0])+n[1],c=t[1]}return o-c}function vK(t,e,r,n){return n===void 0&&(n=xc),t.every(function(i){var a=HO(i,e),s=a<=0;return s===r||nn(a)<=n})}function Z9(t,e,r,n,i){return i===void 0&&(i=0),n&&e-i<=t||!n&&t<=r+i?{isBound:!0,offset:n?e-t:r-t}:{isBound:!1,offset:0}}function Fbe(t,e){var r=e.line,n=e.centerSign,i=e.verticalSign,a=e.horizontalSign,s=e.lineConstants,o=t.props.innerBounds;if(!o)return{isAllBound:!1,isBound:!1,isVerticalBound:!1,isHorizontalBound:!1,offset:[0,0]};var c=o.left,f=o.top,d=o.width,m=o.height,b=[[c,f],[c,f+m]],x=[[c,f],[c+d,f]],E=[[c+d,f],[c+d,f+m]],T=[[c,f+m],[c+d,f+m]];if(vK([[c,f],[c+d,f],[c,f+m],[c+d,f+m]],r,n))return{isAllBound:!1,isBound:!1,isVerticalBound:!1,isHorizontalBound:!1,offset:[0,0]};var A=gg(r,s,x,i),M=gg(r,s,T,i),F=gg(r,s,b,a),N=gg(r,s,E,a),O=A.isBound&&M.isBound,U=A.isBound||M.isBound,j=F.isBound&&N.isBound,H=F.isBound||N.isBound,W=W0(A.offset,M.offset),X=W0(F.offset,N.offset),oe=[0,0],Q=!1,G=!1;return nn(X)<nn(W)?(oe=[W,0],Q=U,G=O):(oe=[0,X],Q=H,G=j),{isAllBound:G,isVerticalBound:U,isHorizontalBound:H,isBound:Q,offset:oe}}function gg(t,e,r,n,i,a){var s=Kt(e,2),o=s[0],c=s[1],f=t[0],d=r[0],m=r[1],b=cE(m[1]-d[1]),x=cE(m[0]-d[0]),E=c,T=o,A=-o/c;if(x){if(!b){if(a&&!E)return{isBound:!1,offset:0};if(T){var O=(d[1]-f[1])/A+f[0];return Z9(O,d[0],m[0],n,i)}else{var F=d[1]-f[1],N=nn(F)<=(i||0);return{isBound:N,offset:N?F:0}}}}else{if(a&&!T)return{isBound:!1,offset:0};if(E){var M=A*(d[0]-f[0])+f[1];return Z9(M,d[1],m[1],n,i)}else{var F=d[0]-f[0],N=nn(F)<=(i||0);return{isBound:N,offset:N?F:0}}}return{isBound:!1,offset:0}}function _K(t,e,r){return e.map(function(n){var i=Fbe(t,n),a=i.isBound,s=i.offset,o=i.isVerticalBound,c=i.isHorizontalBound,f=n.multiple,d=Rd({datas:r,distX:s[0],distY:s[1]}).map(function(m,b){return m*(f[b]?2/f[b]:0)});return{sign:f,isBound:a,isVerticalBound:o,isHorizontalBound:c,isSnap:!1,offset:d}})}function Bbe(t,e,r){var n,i=GO(t,e,[0,0],!1).map(function(b){return Wt(Wt({},b),{multiple:b.multiple.map(function(x){return nn(x)*2})})}),a=_K(t,i,r),s=oE(a,0),o=oE(a,1),c=0,f=0,d=s.isVerticalBound||o.isVerticalBound,m=s.isHorizontalBound||o.isHorizontalBound;return(d||m)&&(n=Kt(lbe({datas:r,distX:-s.offset[0],distY:-o.offset[1]}),2),c=n[0],f=n[1]),{vertical:{isBound:d,offset:c},horizontal:{isBound:m,offset:f}}}function zbe(t,e){var r=[],n=t[0],i=t[1];return n&&i?r.push([[0,i*2],t,[-n,i]],[[n*2,0],t,[n,-i]]):n?(r.push([[n*2,0],[n,1],[n,-1]]),e&&r.push([[0,-1],[n,-1],[-n,-1]],[[0,1],[n,1],[-n,1]])):i?(r.push([[0,i*2],[1,i],[-1,i]]),e&&r.push([[-1,0],[-1,i],[-1,-i]],[[1,0],[1,i],[1,-i]])):r.push([[-1,0],[-1,-1],[-1,1]],[[1,0],[1,-1],[1,1]],[[0,-1],[-1,-1],[1,-1]],[[0,1],[-1,1],[1,1]]),r}function GO(t,e,r,n){var i=t.state,a=i.allMatrix,s=i.is3d,o=Ey(a,100,100,s?4:3),c=zl(o,[0,0]);return zbe(r,n).map(function(f){var d=Kt(f,3),m=d[0],b=d[1],x=d[2],E=[zl(o,b),zl(o,x)],T=Dbe(E),A=yK(c,E),M=A.vertical,F=A.horizontal,N=HO(c,E)<=0;return{multiple:m,centerSign:N,verticalSign:M,horizontalSign:F,lineConstants:T,line:[zl(e,b),zl(e,x)]}})}function K9(t,e,r,n){var i=n?t.map(function(a){return Bx(a,n)}):t;return[[i[0],i[1]],[i[1],i[3]],[i[3],i[2]],[i[2],i[0]]].some(function(a){var s=HO(r,a)<=0;return!vK(e,a,s)})}function jbe(t){var e=Kt(t,2),r=e[0],n=e[1],i=n[0]-r[0],a=n[1]-r[1];if(!i)return nn(r[0]);if(!a)return nn(r[1]);var s=a/i;return nn((-s*r[0]+r[1])/Math.sqrt(Math.pow(s,2)+1))}function Ube(t){var e=Kt(t,2),r=e[0],n=e[1],i=n[0]-r[0],a=n[1]-r[1];if(!i)return[r[0],0];if(!a)return[0,r[1]];var s=a/i,o=-s*r[0]+r[1];return[-o/(s+1/s),o/(s*s+1)]}function Vbe(t,e,r,n,i){var a=t.props.innerBounds,s=i*Math.PI/180;if(!a)return[];var o=a.left,c=a.top,f=a.width,d=a.height,m=o-n[0],b=o+f-n[0],x=c-n[1],E=c+d-n[1],T=[[m,x],[b,x],[m,E],[b,E]],A=zl(r,[0,0]);if(!K9(r,T,A,0))return[];var M=[],F=T.map(function(N){return[Xf(N),il([0,0],N)]});return[[r[0],r[1]],[r[1],r[3]],[r[3],r[2]],[r[2],r[0]]].forEach(function(N){var O=il([0,0],Ube(N)),U=jbe(N);M.push.apply(M,yn([],Kt(F.filter(function(j){var H=Kt(j,1),W=H[0];return W&&U<=W}).map(function(j){var H=Kt(j,2),W=H[0],X=H[1],oe=Math.acos(W?U/W:0),Q=X+oe,G=X-oe;return[s+Q-O,s+G-O]}).reduce(function(j,H){return j.push.apply(j,yn([],Kt(H),!1)),j},[]).filter(function(j){return!K9(e,T,A,j)}).map(function(j){return Fi(j*180/Math.PI,xc)})),!1))}),M}function $be(t){var e=t.props.innerBounds,r=f0();if(!e)return{boundMap:r,vertical:[],horizontal:[]};var n=t.getRect(),i=n.pos1,a=n.pos2,s=n.pos3,o=n.pos4,c=[i,a,s,o],f=zl(c,[0,0]),d=e.left,m=e.top,b=e.width,x=e.height,E=[[d,m],[d,m+x]],T=[[d,m],[d+b,m]],A=[[d+b,m],[d+b,m+x]],M=[[d,m+x],[d+b,m+x]],F=GO(t,c,[0,0],!1),N=[],O=[];return F.forEach(function(U){var j=U.line,H=U.lineConstants,W=yK(f,j),X=W.horizontal,oe=W.vertical,Q=gg(j,H,T,oe,1,!0),G=gg(j,H,M,oe,1,!0),ae=gg(j,H,E,X,1,!0),se=gg(j,H,A,X,1,!0);Q.isBound&&!r.top&&(N.push(m),r.top=!0),G.isBound&&!r.bottom&&(N.push(m+x),r.bottom=!0),ae.isBound&&!r.left&&(O.push(d),r.left=!0),se.isBound&&!r.right&&(O.push(d+b),r.right=!0)}),{boundMap:r,horizontal:N,vertical:O}}function qbe(t,e,r,n){var i=e[0]-t[0],a=e[1]-t[1];if(nn(i)<Tl&&(i=0),nn(a)<Tl&&(a=0),!i)return n?[0,0]:[0,r];if(!a)return n?[r,0]:[0,0];var s=a/i,o=t[1]-s*t[0];if(n){var c=s*(e[0]+r)+o;return[r,c-e[1]]}else{var f=(e[1]+r-o)/s;return[f-e[0],r]}}function xR(t,e,r,n,i){var a=qbe(t,e,r,n);if(!a)return{isOutside:!1,offset:[0,0]};var s=gp(t,e),o=gp(a,t),c=gp(a,e),f=o>s||c>s,d=Kt(Rd({datas:i,distX:a[0],distY:a[1]}),2),m=d[0],b=d[1];return{offset:[m,b],isOutside:f}}function sE(t,e){return t.isBound?t.offset:e.isSnap?bR(e).offset:0}function Hbe(t,e,r,n,i){var a=Kt(e,2),s=a[0],o=a[1],c=Kt(r,2),f=c[0],d=c[1],m=Kt(n,2),b=m[0],x=m[1],E=Kt(i,2),T=E[0],A=E[1],M=-T,F=-A;if(t&&s&&o){M=0,F=0;var N=[];if(f&&d?N.push([0,A],[T,0]):f?N.push([T,0]):d?N.push([0,A]):b&&x?N.push([0,A],[T,0]):b?N.push([T,0]):x&&N.push([0,A]),N.length){N.sort(function(H,W){return Xf(_i([s,o],H))-Xf(_i([s,o],W))});var O=N[0];if(O[0]&&nn(s)>Tl)M=-O[0],F=o*nn(s+M)/nn(s)-o;else if(O[1]&&nn(o)>Tl){var U=o;F=-O[1],M=s*nn(o+F)/nn(U)-s}if(t&&d&&f)if(nn(M)>Tl&&nn(M)<nn(T)){var j=nn(T)/nn(M);M*=j,F*=j}else if(nn(F)>Tl&&nn(F)<nn(A)){var j=nn(A)/nn(F);M*=j,F*=j}else M=W0(-T,M),F=W0(-A,F)}}else M=s||f?-T:0,F=o||d?-A:0;return[M,F]}function Gbe(t,e,r,n,i,a){if(!v_(t,"draggable"))return[{isSnap:!1,isBound:!1,offset:0},{isSnap:!1,isBound:!1,offset:0}];var s=YO(a.absolutePoses,[e,r]),o=Uf(s),c=o.left,f=o.right,d=o.top,m=o.bottom,b={horizontal:s.map(function(se){return se[1]}),vertical:s.map(function(se){return se[0]})},x=$O(t.props.snapDirections),E=qO(x,{left:c,right:f,top:d,bottom:m,center:(c+f)/2,middle:(d+m)/2}),T=u3(t,i,E,b),A=T.vertical,M=T.horizontal,F=Bbe(t,s,a),N=F.vertical,O=F.horizontal,U=A.isSnap,j=M.isSnap,H=A.isBound||N.isBound,W=M.isBound||O.isBound,X=W0(A.offset,N.offset),oe=W0(M.offset,O.offset),Q=Kt(Hbe(n,[e,r],[H,W],[U,j],[X,oe]),2),G=Q[0],ae=Q[1];return[{isBound:H,isSnap:U,offset:G},{isBound:W,isSnap:j,offset:ae}]}function u3(t,e,r,n){n===void 0&&(n=r);var i=VO(s3(t),n.vertical,n.horizontal),a=i.horizontal,s=i.vertical,o=e?{horizontal:{isSnap:!1,index:-1},vertical:{isSnap:!1,index:-1}}:l3(t,r.vertical,r.horizontal,void 0,void 0,void 0,void 0),c=o.horizontal,f=o.vertical,d=sE(a[0],c),m=sE(s[0],f),b=nn(d),x=nn(m);return{horizontal:{isBound:a[0].isBound,isSnap:c.isSnap,snapIndex:c.index,offset:d,dist:b,bounds:a,snap:c},vertical:{isBound:s[0].isBound,isSnap:f.isSnap,snapIndex:f.index,offset:m,dist:x,bounds:s,snap:f}}}function J9(t,e,r,n,i,a,s){s===void 0&&(s=[1,1]);var o=VO(e,r,n),c=o.horizontal,f=o.vertical,d=gK(t,r,n,[],[],i,a,s),m=d.horizontal,b=d.vertical,x=sE(c[0],m),E=sE(f[0],b),T=nn(x),A=nn(E);return{horizontal:{isBound:c[0].isBound,isSnap:m.isSnap,snapIndex:m.index,offset:x,dist:T,bounds:c,snap:m},vertical:{isBound:f[0].isBound,isSnap:b.isSnap,snapIndex:b.index,offset:E,dist:A,bounds:f,snap:b}}}function Wbe(t,e,r,n){var i=il(t,e)/Math.PI*180,a=r.vertical,s=a.isBound,o=a.isSnap,c=a.dist,f=r.horizontal,d=f.isBound,m=f.isSnap,b=f.dist,x=i%180,E=x<3||x>177,T=x>87&&x<93;return b<c&&(s||o&&!T&&(!n||!E))?"vertical":d||m&&!E&&(!n||!T)?"horizontal":""}function Xbe(t,e,r,n,i,a){return r.map(function(s){var o=Kt(s,2),c=o[0],f=o[1],d=zl(e,c),m=zl(e,f),b=n?Ybe(t,d,m,i):u3(t,i,{vertical:[m[0]],horizontal:[m[1]]}),x=b.horizontal,E=x.offset,T=x.isBound,A=x.isSnap,M=b.vertical,F=M.offset,N=M.isBound,O=M.isSnap,U=_i(f,c);if(!F&&!E)return{isBound:N||T,isSnap:O||A,sign:U,offset:[0,0]};var j=Wbe(d,m,b,n);if(!j)return{sign:U,isBound:!1,isSnap:!1,offset:[0,0]};var H=j==="vertical",W=[0,0];return!n&&nn(f[0])===1&&nn(f[1])===1&&c[0]!==f[0]&&c[1]!==f[1]?W=Rd({datas:a,distX:-F,distY:-E}):W=xR(d,m,-(H?F:E),H,a).offset,W=W.map(function(X,oe){return X*(U[oe]?2/U[oe]:0)}),{sign:U,isBound:H?N:T,isSnap:H?O:A,offset:W}})}function Q9(t,e){return t.isBound?t.offset:e.isSnap?e.offset:0}function Ybe(t,e,r,n){var i=Cbe(t,e,r),a=i.horizontal,s=i.vertical,o=n?{horizontal:{isSnap:!1},vertical:{isSnap:!1}}:Obe(t,e,r),c=o.horizontal,f=o.vertical,d=Q9(a,c),m=Q9(s,f),b=nn(d),x=nn(m);return{horizontal:{isBound:a.isBound,isSnap:c.isSnap,offset:d,dist:b},vertical:{isBound:s.isBound,isSnap:f.isSnap,offset:m,dist:x}}}function Zbe(t,e,r,n,i){var a=[-r[0],-r[1]],s=t.state,o=s.width,c=s.height,f=t.props.bounds,d=1/0,m=1/0;if(f){var b=[[r[0],-r[1]],[-r[0],r[1]]],x=f.left,E=x===void 0?-1/0:x,T=f.top,A=T===void 0?-1/0:T,M=f.right,F=M===void 0?1/0:M,N=f.bottom,O=N===void 0?1/0:N;b.forEach(function(U){var j=U[0]!==a[0],H=U[1]!==a[1],W=zl(e,U),X=il(n,W)*360/Math.PI;if(H){var oe=W.slice();(nn(X-360)<2||nn(X-180)<2)&&(oe[1]=n[1]);var Q=xR(n,oe,(n[1]<W[1]?O:A)-W[1],!1,i),G=Kt(Q.offset,2),ae=G[1],se=Q.isOutside;isNaN(ae)||(m=c+(se?1:-1)*nn(ae))}if(j){var oe=W.slice();(nn(X-90)<2||nn(X-270)<2)&&(oe[0]=n[0]);var fe=xR(n,oe,(n[0]<W[0]?F:E)-W[0],!0,i),_e=Kt(fe.offset,1),Le=_e[0],ye=fe.isOutside;isNaN(Le)||(d=o+(ye?1:-1)*nn(Le))}})}return{maxWidth:d,maxHeight:m}}var gc={name:"draggable",props:["draggable","throttleDrag","throttleDragRotate","hideThrottleDragRotateLine","startDragRotate","edgeDraggable"],events:["dragStart","drag","dragEnd","dragGroupStart","dragGroup","dragGroupEnd"],requestStyle:function(){return["left","top","right","bottom"]},requestChildStyle:function(){return["left","top","right","bottom"]},render:function(t,e){var r=t.props,n=r.hideThrottleDragRotateLine,i=r.throttleDragRotate,a=r.zoom,s=t.getState(),o=s.dragInfo,c=s.beforeOrigin;if(n||!i||!o)return[];var f=o.dist;if(!f[0]&&!f[1])return[];var d=Xf(f),m=il(f,[0,0]);return[e.createElement("div",{className:yi("line","horizontal","dragline","dashed"),key:"dragRotateGuideline",style:{width:"".concat(d,"px"),transform:"translate(".concat(c[0],"px, ").concat(c[1],"px) rotate(").concat(m,"rad) scaleY(").concat(a,")")}})]},dragStart:function(t,e){var r=e.datas,n=e.parentEvent,i=e.parentGesto,a=t.state,s=a.gestos,o=a.style;if(s.draggable)return!1;s.draggable=i||t.targetGesto,r.datas={},r.left=parseFloat(o.left||"")||0,r.top=parseFloat(o.top||"")||0,r.bottom=parseFloat(o.bottom||"")||0,r.right=parseFloat(o.right||"")||0,r.startValue=[0,0],Sy(t,e),o3(t,e,"translate"),gxe(t,r),r.prevDist=[0,0],r.prevBeforeDist=[0,0],r.isDrag=!1,r.deltaOffset=[0,0];var c=Ki(t,e,Wt({set:function(d){r.startValue=d}},a3(t,e))),f=n||Wn(t,"onDragStart",c);return f!==!1?(r.isDrag=!0,t.state.dragInfo={startRect:t.getRect(),dist:[0,0]}):(s.draggable=null,r.isPinch=!1),r.isDrag?c:!1},drag:function(t,e){if(e){n3(t,e,"translate");var r=e.datas,n=e.parentEvent,i=e.parentFlag,a=e.isPinch,s=e.deltaOffset,o=e.useSnap,c=e.isRequest,f=e.isGroup,d=e.parentThrottleDrag,m=e.distX,b=e.distY,x=r.isDrag,E=r.prevDist,T=r.prevBeforeDist,A=r.startValue;if(x){s&&(m+=s[0],b+=s[1]);var M=t.props,F=M.parentMoveable,N=f?0:M.throttleDrag||d||0,O=n?0:M.throttleDragRotate||0,U=0,j=!1,H=!1,W=!1,X=!1;if(!n&&O>0&&(m||b)){var oe=M.startDragRotate||0,Q=Fi(oe+il([0,0],[m,b])*180/Math.PI,O)-oe,G=b*Math.abs(Math.cos((Q-90)/180*Math.PI)),ae=m*Math.abs(Math.cos(Q/180*Math.PI)),se=Xf([ae,G]);U=Q*Math.PI/180,m=se*Math.cos(U),b=se*Math.sin(U)}if(!a&&!n&&!i){var fe=Kt(Gbe(t,m,b,O,!o&&c||s,r),2),_e=fe[0],Le=fe[1];j=_e.isSnap,H=_e.isBound,W=Le.isSnap,X=Le.isBound;var ye=_e.offset,Te=Le.offset;m+=ye,b+=Te}var Ie=Ma(eK({datas:r,distX:m,distY:b}),A),Me=Ma(sbe({datas:r,distX:m,distY:b}),A);B9(Me,xc),B9(Ie,xc),O||(!j&&!H&&(Me[0]=Fi(Me[0],N),Ie[0]=Fi(Ie[0],N)),!W&&!X&&(Me[1]=Fi(Me[1],N),Ie[1]=Fi(Ie[1],N)));var de=_i(Ie,A),Se=_i(Me,A),we=_i(Se,E),De=_i(de,T);r.prevDist=Se,r.prevBeforeDist=de,r.passDelta=we,r.passDist=Se;var Fe=r.left+de[0],Xe=r.top+de[1],Be=r.right-de[0],st=r.bottom-de[1],Qe=i3(r,"translate(".concat(Me[0],"px, ").concat(Me[1],"px)"),"translate(".concat(Se[0],"px, ").concat(Se[1],"px)"));if(jO(e,Qe),t.state.dragInfo.dist=n?[0,0]:Se,!(!n&&!F&&we.every(function($e){return!$e})&&De.some(function($e){return!$e}))){var it=t.state,be=it.width,Ot=it.height,at=Ki(t,e,Wt({transform:Qe,dist:Se,delta:we,translate:Me,beforeDist:de,beforeDelta:De,beforeTranslate:Ie,left:Fe,top:Xe,right:Be,bottom:st,width:be,height:Ot,isPinch:a},vc({transform:Qe},e)));return!n&&Wn(t,"onDrag",at),at}}}},dragAfter:function(t,e){var r=e.datas,n=r.deltaOffset;return n[0]||n[1]?(r.deltaOffset=[0,0],this.drag(t,Wt(Wt({},e),{deltaOffset:n}))):!1},dragEnd:function(t,e){var r=e.parentEvent,n=e.datas;if(t.state.dragInfo=null,!!n.isDrag){n.isDrag=!1;var i=gf(t,e,{});return!r&&Wn(t,"onDragEnd",i),i}},dragGroupStart:function(t,e){var r,n,i=e.datas,a=e.clientX,s=e.clientY,o=this.dragStart(t,e);if(!o)return!1;var c=XA(t,this,"dragStart",[a||0,s||0],e,!1,"draggable"),f=c.childEvents,d=c.eventParams,m=Wt(Wt({},o),{targets:t.props.targets,events:d}),b=Wn(t,"onDragGroupStart",m);i.isDrag=b!==!1;var x=(n=(r=f[0])===null||r===void 0?void 0:r.datas.startValue)!==null&&n!==void 0?n:[0,0];return i.throttleOffset=[x[0]%1,x[1]%1],i.isDrag?o:!1},dragGroup:function(t,e){var r=e.datas;if(r.isDrag){var n=this.drag(t,Wt(Wt({},e),{parentThrottleDrag:t.props.throttleDrag})),i=e.datas.passDelta,a=XA(t,this,"drag",i,e,!1,"draggable").eventParams;if(n){var s=Wt({targets:t.props.targets,events:a},n);return Wn(t,"onDragGroup",s),s}}},dragGroupEnd:function(t,e){var r=e.isDrag,n=e.datas;if(n.isDrag){this.dragEnd(t,e);var i=XA(t,this,"dragEnd",[0,0],e,!1,"draggable").eventParams;return Wn(t,"onDragGroupEnd",gf(t,e,{targets:t.props.targets,events:i})),r}},request:function(t){var e={},r=t.getRect(),n=0,i=0,a=!1;return{isControl:!1,requestStart:function(s){return a=s.useSnap,{datas:e,useSnap:a}},request:function(s){return"x"in s?n=s.x-r.left:"deltaX"in s&&(n+=s.deltaX),"y"in s?i=s.y-r.top:"deltaY"in s&&(i+=s.deltaY),{datas:e,distX:n,distY:i,useSnap:a}},requestEnd:function(){return{datas:e,isDrag:!0,useSnap:a}}}},unset:function(t){t.state.gestos.draggable=null,t.state.dragInfo=null}};function bK(t,e){var r=zl(t,e),n=[0,0];return{fixedPosition:r,fixedDirection:e,fixedOffset:n}}function Kbe(t,e){var r=t.allMatrix,n=t.is3d,i=t.width,a=t.height,s=n?4:3,o=[i/2*(1+e[0]),a/2*(1+e[1])],c=bs(r,o,s),f=[0,0];return{fixedPosition:c,fixedDirection:e,fixedOffset:f}}function xK(t,e){var r=t.allMatrix,n=t.is3d,i=t.width,a=t.height,s=n?4:3,o=gbe(e,i,a),c=bs(r,e,s),f=[i?0:e[0],a?0:e[1]];return{fixedPosition:c,fixedDirection:o,fixedOffset:f}}var e7=JO("resizable"),wR={name:"resizable",ableGroup:"size",canPinch:!0,props:["resizable","throttleResize","renderDirections","displayAroundControls","keepRatio","resizeFormat","keepRatioFinally","edge","checkResizableError"],events:["resizeStart","beforeResize","resize","resizeEnd","resizeGroupStart","beforeResizeGroup","resizeGroup","resizeGroupEnd"],render:lK("resizable"),dragControlCondition:e7,viewClassName:KO("resizable"),dragControlStart:function(t,e){var r,n=e.inputEvent,i=e.isPinch,a=e.isGroup,s=e.parentDirection,o=e.parentGesto,c=e.datas,f=e.parentFixedDirection,d=e.parentEvent,m=OK(s,i,n,c),b=t.state,x=b.target,E=b.width,T=b.height,A=b.gestos;if(!m||!x||A.resizable)return!1;A.resizable=o||t.controlGesto,!i&&Sy(t,e),c.datas={},c.direction=m,c.startOffsetWidth=E,c.startOffsetHeight=T,c.prevWidth=0,c.prevHeight=0,c.minSize=[0,0],c.startWidth=b.inlineCSSWidth||b.cssWidth,c.startHeight=b.inlineCSSHeight||b.cssHeight,c.maxSize=[1/0,1/0],a||(c.minSize=[b.minOffsetWidth,b.minOffsetHeight],c.maxSize=[b.maxOffsetWidth,b.maxOffsetHeight]);var M=t.props.transformOrigin||"% %";c.transformOrigin=kp(M)?M.split(" "):M,c.startOffsetMatrix=b.offsetMatrix,c.startTransformOrigin=b.transformOrigin,c.isWidth=(r=e?.parentIsWidth)!==null&&r!==void 0?r:!m[0]&&!m[1]||m[0]||!m[1];function F(X){c.ratio=X&&isFinite(X)?X:0}c.startPositions=Yf(t.state);function N(X){var oe=bK(c.startPositions,X);c.fixedDirection=oe.fixedDirection,c.fixedPosition=oe.fixedPosition,c.fixedOffset=oe.fixedOffset}function O(X){var oe=xK(t.state,X);c.fixedDirection=oe.fixedDirection,c.fixedPosition=oe.fixedPosition,c.fixedOffset=oe.fixedOffset}function U(X){c.minSize=[xo("".concat(X[0]),0)||0,xo("".concat(X[1]),0)||0]}function j(X){var oe=[X[0]||1/0,X[1]||1/0];(!qb(oe[0])||isFinite(oe[0]))&&(oe[0]=xo("".concat(oe[0]),0)||1/0),(!qb(oe[1])||isFinite(oe[1]))&&(oe[1]=xo("".concat(oe[1]),0)||1/0),c.maxSize=oe}F(E/T),N(f||[-m[0],-m[1]]),c.setFixedDirection=N,c.setFixedPosition=O,c.setMin=U,c.setMax=j;var H=Ki(t,e,{direction:m,startRatio:c.ratio,set:function(X){var oe=Kt(X,2),Q=oe[0],G=oe[1];c.startWidth=Q,c.startHeight=G},setMin:U,setMax:j,setRatio:F,setFixedDirection:N,setFixedPosition:O,setOrigin:function(X){c.transformOrigin=X},dragStart:gc.dragStart(t,new H0().dragStart([0,0],e))}),W=d||Wn(t,"onResizeStart",H);return c.startFixedDirection=c.fixedDirection,c.startFixedPosition=c.fixedPosition,W!==!1&&(c.isResize=!0,t.state.snapRenderInfo={request:e.isRequest,direction:m}),c.isResize?H:!1},dragControl:function(t,e){var r,n=e.datas,i=e.parentFlag,a=e.isPinch,s=e.parentKeepRatio,o=e.dragClient,c=e.parentDist,f=e.useSnap,d=e.isRequest,m=e.isGroup,b=e.parentEvent,x=e.resolveMatrix,E=n.isResize,T=n.transformOrigin,A=n.startWidth,M=n.startHeight,F=n.prevWidth,N=n.prevHeight,O=n.minSize,U=n.maxSize,j=n.ratio,H=n.startOffsetWidth,W=n.startOffsetHeight,X=n.isWidth;if(!E)return;if(x){var oe=t.state.is3d,Q=n.startOffsetMatrix,G=n.startTransformOrigin,ae=oe?4:3,se=Gb(iE(e)),fe=Math.sqrt(se.length);ae!==fe&&(se=Ih(se,fe,ae));var _e=$x(Q,se,G,ae),Le=Ey(_e,H,W,ae);n.startPositions=Le,n.nextTargetMatrix=se,n.nextAllMatrix=_e}var ye=ry(t.props,"resizable"),Te=ye.resizeFormat,Ie=ye.throttleResize,Me=Ie===void 0?i?0:1:Ie,de=ye.parentMoveable,Se=ye.keepRatioFinally,we=n.direction,De=we,Fe=0,Xe=0;!we[0]&&!we[1]&&(De=[1,1]);var Be=j&&(s??ye.keepRatio)||!1;function st(){var Er=n.fixedDirection,Jt=jK(De,Be,n,e);Fe=Jt.distWidth,Xe=Jt.distHeight;var ot=De[0]-Er[0]||Be?Math.max(H+Fe,xc):H,Ce=De[1]-Er[1]||Be?Math.max(W+Xe,xc):W;return Be&&H&&W&&(X?Ce=ot/j:ot=Ce*j),[ot,Ce]}var Qe=Kt(st(),2),it=Qe[0],be=Qe[1];b||(n.setFixedDirection(n.fixedDirection),Wn(t,"onBeforeResize",Ki(t,e,{startFixedDirection:n.startFixedDirection,startFixedPosition:n.startFixedPosition,setFixedDirection:function(Er){var Jt;return n.setFixedDirection(Er),Jt=Kt(st(),2),it=Jt[0],be=Jt[1],[it,be]},setFixedPosition:function(Er){var Jt;return n.setFixedPosition(Er),Jt=Kt(st(),2),it=Jt[0],be=Jt[1],[it,be]},boundingWidth:it,boundingHeight:be,setSize:function(Er){var Jt;Jt=Kt(Er,2),it=Jt[0],be=Jt[1]}},!0)));var Ot=o;o||(!i&&a?Ot=_be(t,[0,0]):Ot=n.fixedPosition);var at=[0,0];a||(at=dxe(t,it,be,we,Ot,!f&&d,n)),c&&(!c[0]&&(at[0]=0),!c[1]&&(at[1]=0));function $e(){var Er;Te&&(Er=Kt(Te([it,be]),2),it=Er[0],be=Er[1]),it=Fi(it,Me),be=Fi(be,Me)}if(Be){De[0]&&De[1]&&at[0]&&at[1]&&(nn(at[0])>nn(at[1])?at[1]=0:at[0]=0);var Xt=!at[0]&&!at[1];Xt&&$e(),De[0]&&!De[1]||at[0]&&!at[1]||Xt&&X?(it+=at[0],be=it/j):(!De[0]&&De[1]||!at[0]&&at[1]||Xt&&!X)&&(be+=at[1],it=be*j)}else it+=at[0],be+=at[1],it=Math.max(0,it),be=Math.max(0,be);r=Kt(OZ([it,be],O,U,Be?j:!1),2),it=r[0],be=r[1],$e(),Be&&(m||Se)&&(X?be=it/j:it=be*j),Fe=it-H,Xe=be-W;var $t=[Fe-F,Xe-N];n.prevWidth=Fe,n.prevHeight=Xe;var cr=vbe(t,it,be,Ot,T,n);if(!(!de&&$t.every(function(Er){return!Er})&&cr.every(function(Er){return!Er}))){var _t=gc.drag(t,Vx(e,t.state,cr,!!a,!1,"draggable")),gr=_t.transform,mr=A+Fe,ar=M+Xe,Cr=Ki(t,e,Wt({width:mr,height:ar,offsetWidth:Math.round(it),offsetHeight:Math.round(be),startRatio:j,boundingWidth:it,boundingHeight:be,direction:we,dist:[Fe,Xe],delta:$t,isPinch:!!a,drag:_t},LK({style:{width:"".concat(mr,"px"),height:"".concat(ar,"px")},transform:gr},_t,e)));return!b&&Wn(t,"onResize",Cr),Cr}},dragControlAfter:function(t,e){var r=e.datas,n=r.isResize,i=r.startOffsetWidth,a=r.startOffsetHeight,s=r.prevWidth,o=r.prevHeight;if(!(!n||t.props.checkResizableError===!1)){var c=t.state,f=c.width,d=c.height,m=f-(i+s),b=d-(a+o),x=nn(m)>3,E=nn(b)>3;if(x&&(r.startWidth+=m,r.startOffsetWidth+=m,r.prevWidth+=m),E&&(r.startHeight+=b,r.startOffsetHeight+=b,r.prevHeight+=b),x||E)return this.dragControl(t,e)}},dragControlEnd:function(t,e){var r=e.datas,n=e.parentEvent;if(r.isResize){r.isResize=!1;var i=gf(t,e,{});return!n&&Wn(t,"onResizeEnd",i),i}},dragGroupControlCondition:e7,dragGroupControlStart:function(t,e){var r=e.datas,n=this.dragControlStart(t,Wt(Wt({},e),{isGroup:!0}));if(!n)return!1;var i=Th(t,"resizable",e),a=r.startOffsetWidth,s=r.startOffsetHeight;function o(){var x=r.minSize;i.forEach(function(E){var T=E.datas,A=T.minSize,M=T.startOffsetWidth,F=T.startOffsetHeight,N=a*(M?A[0]/M:0),O=s*(F?A[1]/F:0);x[0]=Math.max(x[0],N),x[1]=Math.max(x[1],O)})}function c(){var x=r.maxSize;i.forEach(function(E){var T=E.datas,A=T.maxSize,M=T.startOffsetWidth,F=T.startOffsetHeight,N=a*(M?A[0]/M:0),O=s*(F?A[1]/F:0);x[0]=Math.min(x[0],N),x[1]=Math.min(x[1],O)})}var f=mp(t,this,"dragControlStart",e,function(x,E){return aE(t,x,r,E)});o(),c();var d=function(x){n.setFixedDirection(x),f.forEach(function(E,T){E.setFixedDirection(x),aE(t,E.moveable,r,i[T])})};r.setFixedDirection=d;var m=Wt(Wt({},n),{targets:t.props.targets,events:f.map(function(x){return Wt(Wt({},x),{setMin:function(E){x.setMin(E),o()},setMax:function(E){x.setMax(E),c()}})}),setFixedDirection:d,setMin:function(x){n.setMin(x),o()},setMax:function(x){n.setMax(x),c()}}),b=Wn(t,"onResizeGroupStart",m);return r.isResize=b!==!1,r.isResize?n:!1},dragGroupControl:function(t,e){var r=e.datas;if(r.isResize){var n=ry(t.props,"resizable");f3(t,"onBeforeResize",function(x){Wn(t,"onBeforeResizeGroup",Ki(t,e,Wt(Wt({},x),{targets:n.targets}),!0))});var i=this.dragControl(t,Wt(Wt({},e),{isGroup:!0}));if(i){var a=i.boundingWidth,s=i.boundingHeight,o=i.dist,c=n.keepRatio,f=[a/(a-o[0]),s/(s-o[1])],d=r.fixedPosition,m=mp(t,this,"dragControl",e,function(x,E){var T=Kt(tc(zx(t.rotation/180*Math.PI,3),[E.datas.originalX*f[0],E.datas.originalY*f[1],1],3),2),A=T[0],M=T[1];return Wt(Wt({},E),{parentDist:null,parentScale:f,dragClient:Ma(d,[A,M]),parentKeepRatio:c})}),b=Wt({targets:n.targets,events:m},i);return Wn(t,"onResizeGroup",b),b}}},dragGroupControlEnd:function(t,e){var r=e.isDrag,n=e.datas;if(n.isResize){this.dragControlEnd(t,e);var i=mp(t,this,"dragControlEnd",e),a=gf(t,e,{targets:t.props.targets,events:i});return Wn(t,"onResizeGroupEnd",a),r}},request:function(t){var e={},r=0,n=0,i=!1,a=t.getRect();return{isControl:!0,requestStart:function(s){var o;return i=s.useSnap,{datas:e,parentDirection:s.direction||[1,1],parentIsWidth:(o=s?.horizontal)!==null&&o!==void 0?o:!0,useSnap:i}},request:function(s){return"offsetWidth"in s?r=s.offsetWidth-a.offsetWidth:"deltaWidth"in s&&(r+=s.deltaWidth),"offsetHeight"in s?n=s.offsetHeight-a.offsetHeight:"deltaHeight"in s&&(n+=s.deltaHeight),{datas:e,parentDist:[r,n],parentKeepRatio:s.keepRatio,useSnap:i}},requestEnd:function(){return{datas:e,isDrag:!0,useSnap:i}}}},unset:function(t){t.state.gestos.resizable=null}};function YA(t,e,r,n,i){var a=t.props.groupable,s=t.state,o=s.is3d?4:3,c=e.origin,f=bs(t.state.rootMatrix,_i([c[0],c[1]],a?[0,0]:[s.left,s.top]),o),d=Ma([i.left,i.top],f);e.startAbsoluteOrigin=d,e.prevDeg=il(d,[r,n])/Math.PI*180,e.defaultDeg=e.prevDeg,e.prevSnapDeg=0,e.loop=0,e.startDist=gp(d,[r,n])}function yS(t,e,r){var n=r.defaultDeg,i=r.prevDeg,a=i%360,s=Math.floor(i/360);a<0&&(a+=360),a>t&&a>270&&t<90?++s:a<t&&a<90&&t>270&&--s;var o=e*(s*360+t-n);return r.prevDeg=n+o,o}function ZA(t,e,r,n){return yS(il(n.startAbsoluteOrigin,[t,e])/Math.PI*180,r,n)}function KA(t,e,r,n,i,a){var s=t.props.throttleRotate,o=s===void 0?0:s,c=r.prevSnapDeg,f=0,d=!1;if(a){var m=hxe(t,e,n,i+n);d=m.isSnap,f=i+m.dist}d||(f=Fi(i+n,o));var b=f-i;return r.prevSnapDeg=b,[b-c,b,f]}function wK(t,e,r){var n=Kt(e,4),i=n[0],a=n[1],s=n[2],o=n[3];if(t==="none")return[];if(su(t))return t.map(function(A){return wK(A,[i,a,s,o],r)[0]});var c=Kt((t||"top").split("-"),2),f=c[0],d=c[1],m=[i,a];f==="left"?m=[s,i]:f==="right"?m=[a,o]:f==="bottom"&&(m=[o,s]);var b=[(m[0][0]+m[1][0])/2,(m[0][1]+m[1][1])/2],x=MK(m,r);if(d){var E=d==="top"||d==="left",T=f==="bottom"||f==="left";b=m[E&&!T||!E&&T?0:1]}return[[b,x]]}function SR(t,e){if(e.isRequest)return e.requestAble==="rotatable";var r=e.inputEvent.target;if(Bl(r,yi("rotation-control"))||t.props.rotateAroundControls&&Bl(r,yi("around-control"))||Bl(r,yi("control"))&&Bl(r,yi("rotatable")))return!0;var n=t.props.rotationTarget;return n?QO(n,!0).some(function(i){return i?r===i||r.contains(i):!1}):!1}var Jbe=`.rotation {
position: absolute;
height: 40px;
width: 1px;
transform-origin: 50% 100%;
height: calc(40px * var(--zoom));
top: auto;
left: 0;
bottom: 100%;
will-change: transform;
}
.rotation .rotation-line {
display: block;
width: 100%;
height: 100%;
transform-origin: 50% 50%;
}
.rotation .rotation-control {
border-color: #4af;
border-color: var(--moveable-color);
background:#fff;
cursor: alias;
}
:global .view-rotation-dragging, .rotatable.direction.control {
cursor: alias;
}
.rotatable.direction.control.move {
cursor: move;
}
`,Qbe={name:"rotatable",canPinch:!0,props:["rotatable","rotationPosition","throttleRotate","renderDirections","rotationTarget","rotateAroundControls","edge","resolveAblesWithRotatable","displayAroundControls"],events:["rotateStart","beforeRotate","rotate","rotateEnd","rotateGroupStart","beforeRotateGroup","rotateGroup","rotateGroupEnd"],css:[Jbe],viewClassName:function(t){return t.isDragging("rotatable")?yi("view-rotation-dragging"):""},render:function(t,e){var r=ry(t.props,"rotatable"),n=r.rotatable,i=r.rotationPosition,a=r.zoom,s=r.renderDirections,o=r.rotateAroundControls,c=r.resolveAblesWithRotatable,f=t.getState(),d=f.renderPoses,m=f.direction;if(!n)return null;var b=wK(i,d,m),x=[];if(b.forEach(function(M,F){var N=Kt(M,2),O=N[0],U=N[1];x.push(e.createElement("div",{key:"rotation".concat(F),className:yi("rotation"),style:{transform:"translate(-50%) translate(".concat(O[0],"px, ").concat(O[1],"px) rotate(").concat(U,"rad)")}},e.createElement("div",{className:yi("line rotation-line"),style:{transform:"scaleX(".concat(a,")")}}),e.createElement("div",{className:yi("control rotation-control"),style:{transform:"translate(0.5px) scale(".concat(a,")")}})))}),s){var E=g_(c||{}),T={};E.forEach(function(M){c[M].forEach(function(F){T[F]=M})});var A=[];su(s)&&(A=s.map(function(M){var F=T[M];return{data:F?{resolve:F}:{},classNames:F?["move"]:[],dir:M}})),x.push.apply(x,yn([],Kt(aK(t,"rotatable",A,e)),!1))}return o&&x.push.apply(x,yn([],Kt(cK(t,e)),!1)),x},dragControlCondition:SR,dragControlStart:function(t,e){var r,n,i=e.datas,a=e.clientX,s=e.clientY,o=e.parentRotate,c=e.parentFlag,f=e.isPinch,d=e.isRequest,m=t.state,b=m.target,x=m.left,E=m.top,T=m.direction,A=m.beforeDirection,M=m.targetTransform,F=m.moveableClientRect,N=m.offsetMatrix,O=m.targetMatrix,U=m.allMatrix,j=m.width,H=m.height;if(!d&&!b)return!1;var W=t.getRect();i.rect=W,i.transform=M,i.left=x,i.top=E;var X=function(De){var Fe=xK(t.state,De);i.fixedDirection=Fe.fixedDirection,i.fixedOffset=Fe.fixedOffset,i.fixedPosition=Fe.fixedPosition,Me&&Me.setFixedPosition(De)},oe=function(De){var Fe=Kbe(t.state,De);i.fixedDirection=Fe.fixedDirection,i.fixedOffset=Fe.fixedOffset,i.fixedPosition=Fe.fixedPosition,Me&&Me.setFixedDirection(De)},Q=a,G=s;if(d||f||c){var ae=o||0;i.beforeInfo={origin:W.beforeOrigin,prevDeg:ae,defaultDeg:ae,prevSnapDeg:0,startDist:0},i.afterInfo=Wt(Wt({},i.beforeInfo),{origin:W.origin}),i.absoluteInfo=Wt(Wt({},i.beforeInfo),{origin:W.origin,startValue:ae})}else{var se=(n=e.inputEvent)===null||n===void 0?void 0:n.target;if(se){var fe=se.getAttribute("data-direction")||"",_e=ibe[fe];if(_e){i.isControl=!0,i.isAroundControl=Bl(se,yi("around-control")),i.controlDirection=_e;var Le=se.getAttribute("data-resolve");Le&&(i.resolveAble=Le);var ye=Ixe(m.rootMatrix,m.renderPoses,F);r=Kt(zl(ye,_e),2),Q=r[0],G=r[1]}}i.beforeInfo={origin:W.beforeOrigin},i.afterInfo={origin:W.origin},i.absoluteInfo={origin:W.origin,startValue:W.rotation};var Te=X;X=function(De){var Fe=m.is3d?4:3,Xe=Kt(Ma(zZ(O,Fe),De),2),Be=Xe[0],st=Xe[1],Qe=tc(N,Qm([Be,st],Fe)),it=tc(U,Qm([De[0],De[1]],Fe));Te(De);var be=m.posDelta;i.beforeInfo.origin=_i(Qe,be),i.afterInfo.origin=_i(it,be),i.absoluteInfo.origin=_i(it,be),YA(t,i.beforeInfo,Q,G,F),YA(t,i.afterInfo,Q,G,F),YA(t,i.absoluteInfo,Q,G,F)},oe=function(De){var Fe=zl([[0,0],[j,0],[0,H],[j,H]],De);X(Fe)}}i.startClientX=Q,i.startClientY=G,i.direction=T,i.beforeDirection=A,i.startValue=0,i.datas={},o3(t,e,"rotate");var Ie=!1,Me=!1;if(i.isControl&&i.resolveAble){var de=i.resolveAble;de==="resizable"&&(Me=wR.dragControlStart(t,Wt(Wt({},new H0("resizable").dragStart([0,0],e)),{parentPosition:i.controlPosition,parentFixedPosition:i.fixedPosition})))}Me||(Ie=gc.dragStart(t,new H0().dragStart([0,0],e))),X(Pxe(t));var Se=Ki(t,e,Wt(Wt({set:function(De){i.startValue=De*Math.PI/180},setFixedDirection:oe,setFixedPosition:X},a3(t,e)),{dragStart:Ie,resizeStart:Me})),we=Wn(t,"onRotateStart",Se);return i.isRotate=we!==!1,m.snapRenderInfo={request:e.isRequest},i.isRotate?Se:!1},dragControl:function(t,e){var r,n,i,a=e.datas,s=e.clientDistX,o=e.clientDistY,c=e.parentRotate,f=e.parentFlag,d=e.isPinch,m=e.groupDelta,b=e.resolveMatrix,x=a.beforeDirection,E=a.beforeInfo,T=a.afterInfo,A=a.absoluteInfo,M=a.isRotate,F=a.startValue,N=a.rect,O=a.startClientX,U=a.startClientY;if(M){n3(t,e,"rotate");var j=obe(e),H=x*j,W=t.props.parentMoveable,X=0,oe,Q,G=0,ae,se,fe=0,_e,Le,ye=180/Math.PI*F,Te=A.startValue,Ie=!1,Me=O+s,de=U+o;if(!f&&"parentDist"in e){var Se=e.parentDist;oe=Se,ae=Se,_e=Se}else d||f?(oe=yS(c,x,E),ae=yS(c,H,T),_e=yS(c,H,A)):(oe=ZA(Me,de,x,E),ae=ZA(Me,de,H,T),_e=ZA(Me,de,H,A),Ie=!0);if(Q=ye+oe,se=ye+ae,Le=Te+_e,Wn(t,"onBeforeRotate",Ki(t,e,{beforeRotation:Q,rotation:se,absoluteRotation:Le,setRotation:function(Ot){ae=Ot-ye,oe=ae,_e=ae}},!0)),r=Kt(KA(t,N,E,oe,ye,Ie),3),X=r[0],oe=r[1],Q=r[2],n=Kt(KA(t,N,T,ae,ye,Ie),3),G=n[0],ae=n[1],se=n[2],i=Kt(KA(t,N,A,_e,Te,Ie),3),fe=i[0],_e=i[1],Le=i[2],!(!fe&&!G&&!X&&!W&&!b)){var we=i3(a,"rotate(".concat(se,"deg)"),"rotate(".concat(ae,"deg)"));b&&(a.fixedPosition=UO(t,a.targetAllTransform,a.fixedDirection,a.fixedOffset,a));var De=ybe(t,ae,a),Fe=_i(Ma(m||[0,0],De),a.prevInverseDist||[0,0]);a.prevInverseDist=De,a.requestValue=null;var Xe=rK(t,we,Fe,d,e),Be=Xe,st=gp([Me,de],A.startAbsoluteOrigin)-A.startDist,Qe=void 0;if(a.resolveAble==="resizable"){var it=wR.dragControl(t,Wt(Wt({},Vx(e,t.state,[e.deltaX,e.deltaY],!!d,!1,"resizable")),{resolveMatrix:!0,parentDistance:st}));it&&(Qe=it,Be=LK(Be,it,e))}var be=Ki(t,e,Wt(Wt({delta:G,dist:ae,rotate:se,rotation:se,beforeDist:oe,beforeDelta:X,beforeRotate:Q,beforeRotation:Q,absoluteDist:_e,absoluteDelta:fe,absoluteRotate:Le,absoluteRotation:Le,isPinch:!!d,resize:Qe},Xe),Be));return Wn(t,"onRotate",be),be}}},dragControlEnd:function(t,e){var r=e.datas;if(r.isRotate){r.isRotate=!1;var n=gf(t,e,{});return Wn(t,"onRotateEnd",n),n}},dragGroupControlCondition:SR,dragGroupControlStart:function(t,e){var r=e.datas,n=t.state,i=n.left,a=n.top,s=n.beforeOrigin,o=this.dragControlStart(t,e);if(!o)return!1;o.set(r.beforeDirection*t.rotation);var c=mp(t,this,"dragControlStart",e,function(m,b){var x=m.state,E=x.left,T=x.top,A=x.beforeOrigin,M=Ma(_i([E,T],[i,a]),_i(A,s));return b.datas.startGroupClient=M,b.datas.groupClient=M,Wt(Wt({},b),{parentRotate:0})}),f=Wt(Wt({},o),{targets:t.props.targets,events:c}),d=Wn(t,"onRotateGroupStart",f);return r.isRotate=d!==!1,r.isRotate?o:!1},dragGroupControl:function(t,e){var r=e.datas;if(r.isRotate){f3(t,"onBeforeRotate",function(f){Wn(t,"onBeforeRotateGroup",Ki(t,e,Wt(Wt({},f),{targets:t.props.targets}),!0))});var n=this.dragControl(t,e);if(n){var i=r.beforeDirection,a=n.beforeDist,s=a/180*Math.PI,o=mp(t,this,"dragControl",e,function(f,d){var m=d.datas.startGroupClient,b=Kt(d.datas.groupClient,2),x=b[0],E=b[1],T=Kt(Bx(m,s*i),2),A=T[0],M=T[1],F=[A-x,M-E];return d.datas.groupClient=[A,M],Wt(Wt({},d),{parentRotate:a,groupDelta:F})});t.rotation=i*n.beforeRotation;var c=Wt({targets:t.props.targets,events:o,set:function(f){t.rotation=f},setGroupRotation:function(f){t.rotation=f}},n);return Wn(t,"onRotateGroup",c),c}}},dragGroupControlEnd:function(t,e){var r=e.isDrag,n=e.datas;if(n.isRotate){this.dragControlEnd(t,e);var i=mp(t,this,"dragControlEnd",e),a=gf(t,e,{targets:t.props.targets,events:i});return Wn(t,"onRotateGroupEnd",a),r}},request:function(t){var e={},r=0,n=t.getRotation();return{isControl:!0,requestStart:function(){return{datas:e}},request:function(i){return"deltaRotate"in i?r+=i.deltaRotate:"rotate"in i&&(r=i.rotate-n),{datas:e,parentDist:r}},requestEnd:function(){return{datas:e,isDrag:!0}}}}};function exe(t,e){var r,n=t.direction,i=t.classNames,a=t.size,s=t.pos,o=t.zoom,c=t.key,f=n==="horizontal",d=f?"Y":"X";return e.createElement("div",{key:c,className:i.join(" "),style:(r={},r[f?"width":"height"]="".concat(a),r.transform="translate(".concat(s[0],", ").concat(s[1],") translate").concat(d,"(-50%) scale").concat(d,"(").concat(o,")"),r)})}function WO(t,e){return exe(Wt(Wt({},t),{classNames:yn([yi("line","guideline",t.direction)],Kt(t.classNames),!1).filter(function(r){return r}),size:t.size||"".concat(t.sizeValue,"px"),pos:t.pos||t.posValue.map(function(r){return"".concat(Fi(r,.1),"px")})}),e)}function t7(t,e,r,n,i,a,s,o){var c=t.props.zoom;return r.map(function(f,d){var m=f.type,b=f.pos,x=[0,0];return x[s]=n,x[s?0:1]=-i+b,WO({key:"".concat(e,"TargetGuideline").concat(d),classNames:[yi("target","bold",m)],posValue:x,sizeValue:a,zoom:c,direction:e},o)})}function r7(t,e,r,n,i,a){var s=t.props,o=s.zoom,c=s.isDisplayInnerSnapDigit,f=e==="horizontal"?Ag:Ig,d=i[f.start],m=i[f.end];return r.filter(function(b){var x=b.hide,E=b.elementRect;if(x)return!1;if(c&&E){var T=E.rect;if(T[f.start]<=d&&m<=T[f.end])return!1}return!0}).map(function(b,x){var E=b.pos,T=b.size,A=b.element,M=b.className,F=[-n[0]+E[0],-n[1]+E[1]];return WO({key:"".concat(e,"-default-guideline-").concat(x),classNames:A?[yi("bold"),M]:[yi("normal"),M],direction:e,posValue:F,sizeValue:T,zoom:o},a)})}function L1(t,e,r,n,i,a,s,o){var c,f=t.props,d=f.snapDigit,m=d===void 0?0:d,b=f.isDisplaySnapDigit,x=b===void 0?!0:b,E=f.snapDistFormat,T=E===void 0?function(U,j){return U}:E,A=f.zoom,M=e==="horizontal"?"X":"Y",F=e==="vertical"?"height":"width",N=Math.abs(i),O=x?parseFloat(N.toFixed(m)):0;return o.createElement("div",{key:"".concat(e,"-").concat(r,"-guideline-").concat(n),className:yi("guideline-group",e),style:(c={left:"".concat(a[0],"px"),top:"".concat(a[1],"px")},c[F]="".concat(N,"px"),c)},WO({direction:e,classNames:[yi(r),s],size:"100%",posValue:[0,0],sizeValue:N,zoom:A},o),o.createElement("div",{className:yi("size-value","gap"),style:{transform:"translate".concat(M,"(-50%) scale(").concat(A,")")}},O>0?T(O,e):""))}function txe(t,e,r,n){var i=t==="vertical"?0:1,a=t==="vertical"?1:0,s=i?Ag:Ig,o=r[s.start],c=r[s.end];return FK(e,function(f){return f.pos[i]}).map(function(f){var d=[],m=[],b=[];return f.forEach(function(x){var E,T,A=x.element,M=x.elementRect.rect;if(M[s.end]<o)d.push(x);else if(c<M[s.start])m.push(x);else if(M[s.start]<=o&&c<=M[s.end]&&n){var F=x.pos,N={element:A,rect:Wt(Wt({},M),(E={},E[s.end]=M[s.start],E))},O={element:A,rect:Wt(Wt({},M),(T={},T[s.start]=M[s.end],T))},U=[0,0],j=[0,0];U[i]=F[i],U[a]=F[a],j[i]=F[i],j[a]=F[a]+x.size,d.push({type:t,pos:U,size:0,elementRect:N,direction:"",elementDirection:"end"}),m.push({type:t,pos:j,size:0,elementRect:O,direction:"",elementDirection:"start"})}}),d.sort(function(x,E){return E.pos[a]-x.pos[a]}),m.sort(function(x,E){return x.pos[a]-E.pos[a]}),{total:f,start:d,end:m,inner:b}})}function rxe(t,e,r,n,i){var a=t.props.isDisplayInnerSnapDigit,s=[];return["vertical","horizontal"].forEach(function(o){var c=e.filter(function(A){return A.type===o}),f=o==="vertical"?1:0,d=f?0:1,m=txe(o,c,n,a),b=f?Ig:Ag,x=f?Ag:Ig,E=n[b.start],T=n[b.end];m.forEach(function(A){var M=A.total,F=A.start,N=A.end,O=A.inner,U=r[d]+M[0].pos[d]-n[x.start],j=n;F.forEach(function(H){var W=H.elementRect.rect,X=j[b.start]-W[b.end];if(X>0){var oe=[0,0];oe[f]=r[f]+j[b.start]-E-X,oe[d]=U,s.push(L1(t,o,"dashed",s.length,X,oe,H.className,i))}j=W}),j=n,N.forEach(function(H){var W=H.elementRect.rect,X=W[b.start]-j[b.end];if(X>0){var oe=[0,0];oe[f]=r[f]+j[b.end]-E,oe[d]=U,s.push(L1(t,o,"dashed",s.length,X,oe,H.className,i))}j=W}),O.forEach(function(H){var W=H.elementRect.rect,X=E-W[b.start],oe=W[b.end]-T,Q=[0,0],G=[0,0];Q[f]=r[f]-X,Q[d]=U,G[f]=r[f]+T-E,G[d]=U,s.push(L1(t,o,"dashed",s.length,X,Q,H.className,i)),s.push(L1(t,o,"dashed",s.length,oe,G,H.className,i))})})}),s}function nxe(t,e,r,n,i){var a=[];return["horizontal","vertical"].forEach(function(s){var o=e.filter(function(A){return A.type===s}).slice(0,1),c=s==="vertical"?0:1,f=c?0:1,d=c?Ig:Ag,m=c?Ag:Ig,b=n[d.start],x=n[d.end],E=n[m.start],T=n[m.end];o.forEach(function(A){var M=A.gap,F=A.gapRects,N=Math.max.apply(Math,yn([E],Kt(F.map(function(j){var H=j.rect;return H[m.start]})),!1)),O=Math.min.apply(Math,yn([T],Kt(F.map(function(j){var H=j.rect;return H[m.end]})),!1)),U=(N+O)/2;N===O||U===(E+T)/2||F.forEach(function(j){var H=j.rect,W=j.className,X=[r[0],r[1]];if(H[d.end]<b)X[c]+=H[d.end]-b;else if(x<H[d.start])X[c]+=H[d.start]-b-M;else return;X[f]+=U-E,a.push(L1(t,c?"vertical":"horizontal","gap",a.length,M,X,W,i))})})}),a}function ER(t){var e,r,n=t.state,i=n.containerClientRect,a=n.hasFixed,s=i.overflow,o=i.scrollHeight,c=i.scrollWidth,f=i.clientHeight,d=i.clientWidth,m=i.clientLeft,b=i.clientTop,x=t.props,E=x.snapGap,T=E===void 0?!0:E,A=x.verticalGuidelines,M=x.horizontalGuidelines,F=x.snapThreshold,N=F===void 0?5:F,O=x.maxSnapElementGuidelineDistance,U=O===void 0?1/0:O,j=x.isDisplayGridGuidelines,H=Uf(Yf(t.state)),W=H.top,X=H.left,oe=H.bottom,Q=H.right,G={top:W,left:X,bottom:oe,right:Q,center:(X+Q)/2,middle:(W+oe)/2},ae=sxe(t),se=yn([],Kt(ae),!1),fe=((r=(e=n.snapThresholdInfo)===null||e===void 0?void 0:e.multiples)!==null&&r!==void 0?r:[1,1]).map(function(Te){return Te*N});T&&se.push.apply(se,yn([],Kt(ixe(t,G,fe)),!1));var _e=Wt({},n.snapOffset||{left:0,top:0,bottom:0,right:0});if(se.push.apply(se,yn([],Kt(oxe(t,s?c:d,s?o:f,m,b,_e,j)),!1)),a){var Le=i.left,ye=i.top;_e.left+=Le,_e.top+=ye,_e.right+=Le,_e.bottom+=ye}return se.push.apply(se,yn([],Kt(EK(M||!1,A||!1,s?c:d,s?o:f,m,b,_e)),!1)),se=se.filter(function(Te){var Ie=Te.element,Me=Te.elementRect,de=Te.type;if(!Ie||!Me)return!0;var Se=Me.rect;return SK(G,Se,de,U)}),se}function ixe(t,e,r){var n=t.props,i=n.maxSnapElementGuidelineDistance,a=i===void 0?1/0:i,s=n.maxSnapElementGapDistance,o=s===void 0?1/0:s,c=t.state.elementRects,f=[];return[["vertical",Ag,Ig],["horizontal",Ig,Ag]].forEach(function(d){var m=Kt(d,3),b=m[0],x=m[1],E=m[2],T=e[x.start],A=e[x.end],M=e[x.center],F=e[E.start],N=e[E.end],O={left:r[0],top:r[1]};function U(W){var X=W.rect,oe=O[x.start];return X[x.end]<T+oe?T-X[x.end]:A-oe<X[x.start]?X[x.start]-A:-1}var j=c.filter(function(W){var X=W.rect;return X[E.start]>N||X[E.end]<F?!1:U(W)>0}).sort(function(W,X){return U(W)-U(X)}),H=[];j.forEach(function(W){j.forEach(function(X){if(W!==X){var oe=W.rect,Q=X.rect,G=oe[E.start],ae=oe[E.end],se=Q[E.start],fe=Q[E.end];G>fe||se>ae||H.push([W,X])}})}),H.forEach(function(W){var X=Kt(W,2),oe=X[0],Q=X[1],G=oe.rect,ae=Q.rect,se=G[x.start],fe=G[x.end],_e=ae[x.start],Le=ae[x.end],ye=O[x.start],Te=0,Ie=0,Me=!1,de=!1,Se=!1;if(fe<=T&&A<=_e){if(de=!0,Te=(_e-fe-(A-T))/2,Ie=fe+Te+(A-T)/2,nn(Ie-M)>ye)return}else if(fe<_e&&Le<T+ye){if(Me=!0,Te=_e-fe,Ie=Le+Te,nn(Ie-T)>ye)return}else if(fe<_e&&A-ye<se){if(Se=!0,Te=_e-fe,Ie=se-Te,nn(Ie-A)>ye)return}else return;Te&&SK(e,ae,b,a)&&(Te>o||f.push({type:b,pos:b==="vertical"?[Ie,0]:[0,Ie],element:Q.element,size:0,className:Q.className,isStart:Me,isCenter:de,isEnd:Se,gap:Te,hide:!0,gapRects:[oe,Q],direction:"",elementDirection:""}))})}),f}function axe(t,e,r,n){var i,a,s=t.props,o=t.state,c=s.snapGridAll,f=s.snapGridWidth,d=f===void 0?0:f,m=s.snapGridHeight,b=m===void 0?0:m,x=o.snapRenderInfo,E=x&&(((i=x.direction)===null||i===void 0?void 0:i[0])||((a=x.direction)===null||a===void 0?void 0:a[1])),T=t.moveables;if(c&&T&&E&&(d||b)){if(o.snapThresholdInfo)return;o.snapThresholdInfo={multiples:[1,1],offset:[0,0]};var A=t.getRect(),M=A.children,F=x.direction;if(M){var N=F.map(function(U,j){var H=j===0?{snapSize:d,posName:"left",sizeName:"width",clientOffset:n.left-e}:{snapSize:b,posName:"top",sizeName:"height",clientOffset:n.top-r},W=H.snapSize,X=H.posName,oe=H.sizeName,Q=H.clientOffset;if(!W)return{dir:U,multiple:1,snapSize:W,snapOffset:0};var G=A[oe],ae=A[X],se=J_e(M.map(function(Me){return[Me[X]-ae,Me[oe],G-Me[oe]-Me[X]+ae]})).filter(function(Me){return Me}).sort(function(Me,de){return Me-de}),fe=se[0],_e=se.map(function(Me){return Fi(Me/fe,.1)*W}),Le=1,ye=Fi(G/fe,.1);for(Le=1;Le<=10&&!_e.every(function(Me){return Me*Le%1===0});++Le);var Te=(-U+1)/2,Ie=tE(ae-Q,ae-Q+G,Te,1-Te);return{multiple:ye*Le,dir:U,snapSize:W,snapOffset:Math.round(Ie/W)}}),O=N.map(function(U){return U.multiple||1});o.snapThresholdInfo.multiples=O,o.snapThresholdInfo.offset=N.map(function(U){return U.snapOffset}),N.forEach(function(U,j){U.snapSize})}}else o.snapThresholdInfo=null}function oxe(t,e,r,n,i,a,s){n===void 0&&(n=0),i===void 0&&(i=0);var o=t.props,c=t.state,f=o.snapGridWidth,d=f===void 0?0:f,m=o.snapGridHeight,b=m===void 0?0:m,x=[],E=a.left,T=a.top,A=[0,0];axe(t,n,i,a);var M=c.snapThresholdInfo,F=d,N=b;if(M&&(d*=M.multiples[0]||1,b*=M.multiples[1]||1,A=M.offset),b){for(var O=function(j){x.push({type:"horizontal",pos:[E,Fi(A[1]*N+j-i+T,.1)],className:yi("grid-guideline"),size:e,hide:!s,direction:"",grid:!0})},U=0;U<=r*2;U+=b)O(U);for(var U=-b;U>=-r;U-=b)O(U)}if(d){for(var O=function(H){x.push({type:"vertical",pos:[Fi(A[0]*F+H-n+E,.1),T],className:yi("grid-guideline"),size:r,hide:!s,direction:"",grid:!0})},U=0;U<=e*2;U+=d)O(U);for(var U=-d;U>=-e;U-=d)O(U)}return x}function SK(t,e,r,n){return r==="horizontal"?nn(t.right-e.left)<=n||nn(t.left-e.right)<=n||t.left<=e.right&&e.left<=t.right:r==="vertical"?nn(t.bottom-e.top)<=n||nn(t.top-e.bottom)<=n||t.top<=e.bottom&&e.top<=t.bottom:!0}function sxe(t){var e=t.state,r=t.props.elementGuidelines,n=r===void 0?[]:r;if(!n.length)return e.elementRects=[],[];var i=(e.elementRects||[]).filter(function(b){return!b.refresh}),a=n.map(function(b){return Ah(b)&&"element"in b?Wt(Wt({},b),{element:bd(b.element,!0)}):{element:bd(b,!0)}}).filter(function(b){return b.element}),s=v1e(i.map(function(b){return b.element}),a.map(function(b){return b.element})),o=s.maintained,c=s.added,f=[];o.forEach(function(b){var x=Kt(b,2),E=x[0],T=x[1];f[T]=i[E]}),lxe(t,c.map(function(b){return a[b]})).map(function(b,x){f[c[x]]=b}),e.elementRects=f;var d=$O(t.props.elementSnapDirections),m=[];return f.forEach(function(b){var x=b.element,E=b.top,T=E===void 0?d.top:E,A=b.left,M=A===void 0?d.left:A,F=b.right,N=F===void 0?d.right:F,O=b.bottom,U=O===void 0?d.bottom:O,j=b.center,H=j===void 0?d.center:j,W=b.middle,X=W===void 0?d.middle:W,oe=b.className,Q=b.rect,G=qO({top:T,right:N,left:M,bottom:U,center:H,middle:X},Q),ae=G.horizontal,se=G.vertical,fe=G.horizontalNames,_e=G.verticalNames,Le=Q.top,ye=Q.left,Te=Q.right-ye,Ie=Q.bottom-Le,Me=[Te,Ie];se.forEach(function(de,Se){m.push({type:"vertical",element:x,pos:[Fi(de,.1),Le],size:Ie,sizes:Me,className:oe,elementRect:b,elementDirection:W9[_e[Se]]||_e[Se],direction:""})}),ae.forEach(function(de,Se){m.push({type:"horizontal",element:x,pos:[ye,Fi(de,.1)],size:Te,sizes:Me,className:oe,elementRect:b,elementDirection:W9[fe[Se]]||fe[Se],direction:""})})}),m}function n7(t,e){return t?t.map(function(r){var n=Ah(r)?r:{pos:r},i=n.pos;return qb(i)?n:Wt(Wt({},n),{pos:xo(i,e)})}):[]}function EK(t,e,r,n,i,a,s){i===void 0&&(i=0),a===void 0&&(a=0),s===void 0&&(s={left:0,top:0,right:0,bottom:0});var o=[],c=s.left,f=s.top,d=s.bottom,m=s.right,b=r+m-c,x=n+d-f;return n7(t,x).forEach(function(E){o.push({type:"horizontal",pos:[c,Fi(E.pos-a+f,.1)],size:b,className:E.className,direction:""})}),n7(e,b).forEach(function(E){o.push({type:"vertical",pos:[Fi(E.pos-i+c,.1),f],size:x,className:E.className,direction:""})}),o}function lxe(t,e){if(!e.length)return[];var r=t.props.groupable,n=t.state,i=n.containerClientRect,a=n.rootMatrix,s=n.is3d,o=n.offsetDelta,c=s?4:3,f=Kt(Mbe(a,i,c),2),d=f[0],m=f[1],b=r?0:o[0],x=r?0:o[1];return e.map(function(E){var T=E.element.getBoundingClientRect(),A=T.left-d-b,M=T.top-m-x,F=M+T.height,N=A+T.width,O=Kt(X0(a,[A,M],c),2),U=O[0],j=O[1],H=Kt(X0(a,[N,F],c),2),W=H[0],X=H[1];return Wt(Wt({},E),{rect:{left:U,right:W,top:j,bottom:X,center:(U+W)/2,middle:(j+X)/2}})})}function yw(t){var e=t.state,r=e.container,n=t.props.snapContainer||r;if(e.snapContainer===n&&e.guidelines&&e.guidelines.length)return!1;var i=e.containerClientRect,a={left:0,top:0,bottom:0,right:0};if(r!==n){var s=bd(n,!0);if(s){var o=yb(s),c=u7(e,[o.left-i.left,o.top-i.top]),f=u7(e,[o.right-i.right,o.bottom-i.bottom]);a.left=Fi(c[0],1e-5),a.top=Fi(c[1],1e-5),a.right=Fi(f[0],1e-5),a.bottom=Fi(f[1],1e-5)}}return e.snapContainer=n,e.snapOffset=a,e.guidelines=ER(t),e.enableSnap=!0,!0}function TK(t,e,r,n,i,a){var s=Ey(t,e,r,a?4:3),o=zl(s,n);return YO(s,_i(i,o))}function i7(t){return t?t/nn(t):0}function uxe(t,e,r,n,i,a){var s=a.fixedDirection,o=Lbe(r,s,n),c=GO(t,e,r,n),f=yn(yn([],Kt(Xbe(t,e,o,n,i,a)),!1),Kt(_K(t,c,a)),!1),d=oE(f,0),m=oE(f,1);return{width:{isBound:d.isBound,offset:d.offset[0]},height:{isBound:m.isBound,offset:m.offset[1]}}}function cxe(t,e,r,n,i,a,s,o,c){var f=zl(e,s),d=u3(t,o,{vertical:[f[0]],horizontal:[f[1]]}),m=d.horizontal.offset,b=d.vertical.offset;if(Fi(b,yR)||Fi(m,yR)){var x=Kt(Rd({datas:c,distX:-b,distY:-m}),2),E=x[0],T=x[1],A=Math.min(i||1/0,r+s[0]*E),M=Math.min(a||1/0,n+s[1]*T);return[A-r,M-n]}return[0,0]}function CK(t,e,r,n,i,a,s,o){for(var c=Yf(t.state),f=t.props.keepRatio,d=0,m=0,b=0;b<2;++b){var x=e(d,m),E=uxe(t,x,i,f,s,o),T=E.width,A=E.height,M=T.isBound,F=A.isBound,N=T.offset,O=A.offset;if(b===1&&(M||(N=0),F||(O=0)),b===0&&s&&!M&&!F)return[0,0];if(f){var U=nn(N)*(r?1/r:1),j=nn(O)*(n?1/n:1),H=M&&F?U<j:F||!M&&U<j;H?N=r*O/n:O=n*N/r}d+=N,m+=O}if(!f&&i[0]&&i[1]){var W=Zbe(t,c,i,a,o),X=W.maxWidth,oe=W.maxHeight,Q=Kt(cxe(t,e(d,m).map(function(se){return se.map(function(fe){return Fi(fe,yR)})}),r+d,n+m,X,oe,i,s,o),2),N=Q[0],O=Q[1];d+=N,m+=O}return[d,m]}function gb(t){return t<0&&(t=t%360+360),t%=360,t}function fxe(t,e){e=gb(e);var r=Math.floor(t/360),n=r*360+360-e,i=r*360+e;return nn(t-n)<nn(t-i)?n:i}function JA(t,e){t=gb(t),e=gb(e);var r=gb(t-e);return Math.min(r,360-r)}function hxe(t,e,r,n){var i,a=t.props,s=(i=a[fK])!==null&&i!==void 0?i:5,o=a[hK];if(v_(t,"rotatable")){var c=e.pos1,f=e.pos2,d=e.pos3,m=e.pos4,b=e.origin,x=r*Math.PI/180,E=[c,f,d,m].map(function(O){return _i(O,b)}),T=E.map(function(O){return Bx(O,x)}),A=yn(yn([],Kt(Ibe(t,E,T,b,r)),!1),Kt(Vbe(t,E,T,b,r)),!1);A.sort(function(O,U){return nn(O-r)-nn(U-r)});var M=A.length>0;if(M)return{isSnap:M,dist:M?A[0]:r}}if(o?.length&&s){var F=o.slice().sort(function(O,U){return JA(O,n)-JA(U,n)}),N=F[0];if(JA(N,n)<=s)return{isSnap:!0,dist:r+fxe(n,N)-n}}return{isSnap:!1,dist:r}}function dxe(t,e,r,n,i,a,s){if(!v_(t,"resizable"))return[0,0];var o=s.fixedDirection,c=s.nextAllMatrix,f=t.state,d=f.allMatrix,m=f.is3d;return CK(t,function(b,x){return TK(c||d,e+b,r+x,o,i,m)},e,r,n,i,a,s)}function pxe(t,e,r,n,i){if(!v_(t,"scalable"))return[0,0];var a=i.startOffsetWidth,s=i.startOffsetHeight,o=i.fixedPosition,c=i.fixedDirection,f=i.is3d,d=CK(t,function(m,b){return TK(dbe(i,Ma(e,[m/a,b/s])),a,s,c,o,f)},a,s,r,o,n,i);return[d[0]/a,d[1]/s]}function gxe(t,e){e.absolutePoses=Yf(t.state)}function a7(t){var e=[];return t.forEach(function(r){r.guidelineInfos.forEach(function(n){var i=n.guideline;pf(e,function(a){return a.guideline===i})||(i.direction="",e.push({guideline:i,posInfo:r}))})}),e.map(function(r){var n=r.guideline,i=r.posInfo;return Wt(Wt({},n),{direction:i.direction})})}function o7(t,e,r,n,i,a){var s=VO(s3(t,a),e,r),o=s.vertical,c=s.horizontal,f=f0();o.forEach(function(E){E.isBound&&(E.direction==="start"&&(f.left=!0),E.direction==="end"&&(f.right=!0),n.push({type:"bounds",pos:E.pos}))}),c.forEach(function(E){E.isBound&&(E.direction==="start"&&(f.top=!0),E.direction==="end"&&(f.bottom=!0),i.push({type:"bounds",pos:E.pos}))});var d=$be(t),m=d.boundMap,b=d.vertical,x=d.horizontal;return b.forEach(function(E){Sp(n,function(T){var A=T.type,M=T.pos;return A==="bounds"&&M===E})>=0||n.push({type:"bounds",pos:E})}),x.forEach(function(E){Sp(i,function(T){var A=T.type,M=T.pos;return A==="bounds"&&M===E})>=0||i.push({type:"bounds",pos:E})}),{boundMap:f,innerBoundMap:m}}var mxe=JO("",["resizable","scalable"]),yxe={name:"snappable",dragRelation:"strong",props:["snappable","snapContainer","snapDirections","elementSnapDirections","snapGap","snapGridWidth","snapGridHeight","isDisplaySnapDigit","isDisplayInnerSnapDigit","isDisplayGridGuidelines","snapDigit","snapThreshold","snapRenderThreshold","snapGridAll",fK,hK,dK,pK,"horizontalGuidelines","verticalGuidelines","elementGuidelines","bounds","innerBounds","snapDistFormat","maxSnapElementGuidelineDistance","maxSnapElementGapDistance"],events:["snap","bound"],css:[`:host {
--bounds-color: #d66;
}
.guideline {
pointer-events: none;
z-index: 2;
}
.guideline.bounds {
background: #d66;
background: var(--bounds-color);
}
.guideline-group {
position: absolute;
top: 0;
left: 0;
}
.guideline-group .size-value {
position: absolute;
color: #f55;
font-size: 12px;
font-size: calc(12px * var(--zoom));
font-weight: bold;
}
.guideline-group.horizontal .size-value {
transform-origin: 50% 100%;
transform: translateX(-50%);
left: 50%;
bottom: 5px;
bottom: calc(2px + 3px * var(--zoom));
}
.guideline-group.vertical .size-value {
transform-origin: 0% 50%;
top: 50%;
transform: translateY(-50%);
left: 5px;
left: calc(2px + 3px * var(--zoom));
}
.guideline.gap {
background: #f55;
}
.size-value.gap {
color: #f55;
}
`],render:function(t,e){var r=t.state,n=r.top,i=r.left,a=r.pos1,s=r.pos2,o=r.pos3,c=r.pos4,f=r.snapRenderInfo,d=t.props.snapRenderThreshold,m=d===void 0?1:d;if(!f||!f.render||!v_(t,""))return d0(t,"boundMap",f0(),function(we){return JSON.stringify(we)}),d0(t,"innerBoundMap",f0(),function(we){return JSON.stringify(we)}),[];r.guidelines=ER(t);var b=Math.min(a[0],s[0],o[0],c[0]),x=Math.min(a[1],s[1],o[1],c[1]),E=f.externalPoses||[],T=Yf(t.state),A=[],M=[],F=[],N=[],O=[],U=Uf(T),j=U.width,H=U.height,W=U.top,X=U.left,oe=U.bottom,Q=U.right,G={left:X,right:Q,top:W,bottom:oe,center:(X+Q)/2,middle:(W+oe)/2},ae=E.length>0,se=ae?Uf(E):{};if(!f.request){if(f.direction&&O.push(Nbe(t,T,f.direction,m,m)),f.snap){var fe=Uf(T);f.center&&(fe.middle=(fe.top+fe.bottom)/2,fe.center=(fe.left+fe.right)/2),O.push(X9(t,fe,m,m))}ae&&(f.center&&(se.middle=(se.top+se.bottom)/2,se.center=(se.left+se.right)/2),O.push(X9(t,se,m,m))),O.forEach(function(we){var De=we.vertical.posInfos,Fe=we.horizontal.posInfos;A.push.apply(A,yn([],Kt(De.filter(function(Xe){var Be=Xe.guidelineInfos;return Be.some(function(st){var Qe=st.guideline;return!Qe.hide})}).map(function(Xe){return{type:"snap",pos:Xe.pos}})),!1)),M.push.apply(M,yn([],Kt(Fe.filter(function(Xe){var Be=Xe.guidelineInfos;return Be.some(function(st){var Qe=st.guideline;return!Qe.hide})}).map(function(Xe){return{type:"snap",pos:Xe.pos}})),!1)),F.push.apply(F,yn([],Kt(a7(De)),!1)),N.push.apply(N,yn([],Kt(a7(Fe)),!1))})}var _e=o7(t,[X,Q],[W,oe],A,M),Le=_e.boundMap,ye=_e.innerBoundMap;ae&&o7(t,[se.left,se.right],[se.top,se.bottom],A,M,f.externalBounds);var Te=yn(yn([],Kt(F),!1),Kt(N),!1),Ie=Te.filter(function(we){return we.element&&!we.gapRects}),Me=Te.filter(function(we){return we.gapRects}).sort(function(we,De){return we.gap-De.gap});Wn(t,"onSnap",{guidelines:Te.filter(function(we){var De=we.element;return!De}),elements:Ie,gaps:Me},!0);var de=d0(t,"boundMap",Le,function(we){return JSON.stringify(we)},f0()),Se=d0(t,"innerBoundMap",ye,function(we){return JSON.stringify(we)},f0());return(Le===de||ye===Se)&&Wn(t,"onBound",{bounds:Le,innerBounds:ye},!0),yn(yn(yn(yn(yn(yn([],Kt(rxe(t,Ie,[b,x],G,e)),!1),Kt(nxe(t,Me,[b,x],G,e)),!1),Kt(r7(t,"horizontal",N,[i,n],G,e)),!1),Kt(r7(t,"vertical",F,[i,n],G,e)),!1),Kt(t7(t,"horizontal",M,b,n,j,0,e)),!1),Kt(t7(t,"vertical",A,x,i,H,1,e)),!1)},dragStart:function(t,e){t.state.snapRenderInfo={request:e.isRequest,snap:!0,center:!0},yw(t)},drag:function(t){var e=t.state;yw(t)||(e.guidelines=ER(t)),e.snapRenderInfo&&(e.snapRenderInfo.render=!0)},pinchStart:function(t){this.unset(t)},dragEnd:function(t){this.unset(t)},dragControlCondition:function(t,e){if(mxe(t,e)||SR(t,e))return!0;if(!e.isRequest&&e.inputEvent)return Bl(e.inputEvent.target,yi("snap-control"))},dragControlStart:function(t){t.state.snapRenderInfo=null,yw(t)},dragControl:function(t){this.drag(t)},dragControlEnd:function(t){this.unset(t)},dragGroupStart:function(t,e){this.dragStart(t,e)},dragGroup:function(t){this.drag(t)},dragGroupEnd:function(t){this.unset(t)},dragGroupControlStart:function(t){t.state.snapRenderInfo=null,yw(t)},dragGroupControl:function(t){this.drag(t)},dragGroupControlEnd:function(t){this.unset(t)},unset:function(t){var e=t.state;e.enableSnap=!1,e.guidelines=[],e.snapRenderInfo=null,e.elementRects=[]}};function vxe(t,e){return[t[0]*e[0],t[1]*e[1]]}function yi(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return N_e.apply(void 0,yn([BO],Kt(t),!1))}function AK(t){t()}function _xe(t){return!t||t==="none"?[1,0,0,1,0,0]:Ah(t)?t:Gb(t)}function mb(t,e,r){return rE(e,ey(r,e),t,ey(r.map(function(n){return-n}),e))}function bxe(t,e,r){if(e==="%"){var n=XO(t.ownerSVGElement);return n[r?"width":"height"]/100}return 1}function xxe(t){var e=wxe(ZO(t,":before"));return e.map(function(r,n){var i=Fx(r),a=i.value,s=i.unit;return a*bxe(t,s,n===0)})}function lE(t){return t?t.split(" "):["0","0"]}function wxe(t){return lE(t.transformOrigin)}function IK(t){var e=Fc(t),r=e("transform");if(r&&r!=="none")return r;if("transform"in t){var n=t.transform,i=n.baseVal;if(!i)return"";var a=i.length;if(!a)return"";for(var s=[],o=function(f){var d=i[f].matrix;s.push("matrix(".concat(["a","b","c","d","e","f"].map(function(m){return d[m]}).join(", "),")"))},c=0;c<a;++c)o(c);return s.join(" ")}return""}function Xb(t,e,r,n,i){var a,s,o=kO(t)||zg(t),c=!1,f,d;if(!t||r)f=t;else{var m=(a=t?.assignedSlot)===null||a===void 0?void 0:a.parentElement,b=t.parentElement;m?(c=!0,d=b,f=m):f=b}for(var x=!1,E=t===e||f===e,T="relative",A=1,M=parseFloat(i?.("zoom"))||1,F=i?.("position");f&&f!==o;){e===f&&(E=!0);var N=Fc(f),O=f.tagName.toLowerCase(),U=IK(f),j=N("willChange"),H=parseFloat(N("zoom"))||1;if(T=N("position"),n&&H!==1){A=H;break}if(!r&&n&&M!==1&&F&&F!=="absolute"||O==="svg"||O==="foreignobject"||T!=="static"||U&&U!=="none"||j==="transform")break;var W=(s=t?.assignedSlot)===null||s===void 0?void 0:s.parentNode,X=f.parentNode;W&&(c=!0,d=X);var oe=X;if(oe&&oe.nodeType===11){f=oe.host,x=!0,T=Fc(f)("position");break}f=oe,T="relative"}return{offsetZoom:A,hasSlot:c,parentSlotElement:d,isCustomElement:x,isStatic:T==="static",isEnd:E||!f||f===o,offsetParent:f||o}}function Sxe(t,e){var r,n=t.tagName.toLowerCase(),i=t.offsetLeft,a=t.offsetTop,s=Fc(t),o=TO(i),c=!o,f,d;return!c&&(n!=="svg"||t.ownerSVGElement)?(f=XZ?xxe(t):lE(s("transformOrigin")).map(function(m){return parseFloat(m)}),d=f.slice(),c=!0,n==="svg"?(i=0,a=0):(r=Kt(Cxe(t,f,t===e&&e.tagName.toLowerCase()==="g"),4),i=r[0],a=r[1],f[0]=r[2],f[1]=r[3])):(f=lE(s("transformOrigin")).map(function(m){return parseFloat(m)}),d=f.slice()),{tagName:n,isSVG:o,hasOffset:c,offset:[i||0,a||0],origin:f,targetOrigin:d}}function PK(t,e){var r=Fc(t),n=Fc(zg(t)),i=n("position");if(!e&&(!i||i==="static"))return[0,0];var a=parseInt(n("marginLeft"),10),s=parseInt(n("marginTop"),10);return r("position")==="absolute"&&((r("top")!=="auto"||r("bottom")!=="auto")&&(s=0),(r("left")!=="auto"||r("right")!=="auto")&&(a=0)),[a,s]}function TR(t){t.forEach(function(e){var r=e.matrix;r&&(e.matrix=Ih(r,3,4))})}function Exe(t){for(var e=t.parentElement,r=!1,n=zg(t);e;){var i=ZO(e).transform;if(i&&i!=="none"){r=!0;break}if(e===n)break;e=e.parentElement}return{fixedContainer:e||n,hasTransform:r}}function c3(t,e){return e===void 0&&(e=t.length>9),"".concat(e?"matrix3d":"matrix","(").concat(jZ(t,!e).join(","),")")}function XO(t){var e=t.clientWidth,r=t.clientHeight;if(!t)return{x:0,y:0,width:0,height:0,clientWidth:e,clientHeight:r};var n=t.viewBox,i=n&&n.baseVal||{x:0,y:0,width:0,height:0};return{x:i.x,y:i.y,width:i.width||e,height:i.height||r,clientWidth:e,clientHeight:r}}function Txe(t,e){var r,n=XO(t),i=n.width,a=n.height,s=n.clientWidth,o=n.clientHeight,c=s/i,f=o/a,d=t.preserveAspectRatio.baseVal,m=d.align,b=d.meetOrSlice,x=[0,0],E=[c,f],T=[0,0];if(m!==1){var A=(m-2)%3,M=Math.floor((m-2)/3);x[0]=i*A/2,x[1]=a*M/2;var F=b===2?Math.max(f,c):Math.min(c,f);E[0]=F,E[1]=F,T[0]=(s-i)/2*A,T[1]=(o-a)/2*M}var N=MO(E,e);return r=Kt(T,2),N[e*(e-1)]=r[0],N[e*(e-1)+1]=r[1],mb(N,e,x)}function Cxe(t,e,r){var n=t.tagName.toLowerCase();if(!t.getBBox||!r&&n==="g")return[0,0,0,0];var i=Fc(t),a=i("transform-box")==="fill-box",s=t.getBBox(),o=XO(t.ownerSVGElement),c=s.x,f=s.y;n==="foreignobject"&&!c&&!f&&(c=parseFloat(t.getAttribute("x"))||0,f=parseFloat(t.getAttribute("y"))||0);var d=c-o.x,m=f-o.y,b=a?e[0]:e[0]-d,x=a?e[1]:e[1]-m;return[d,m,b,x]}function bs(t,e,r){return tc(t,Qm(e,r),r)}function Ey(t,e,r,n){return[[0,0],[e,0],[0,r],[e,r]].map(function(i){return bs(t,i,n)})}function Uf(t){var e=t.map(function(f){return f[0]}),r=t.map(function(f){return f[1]}),n=Math.min.apply(Math,yn([],Kt(e),!1)),i=Math.min.apply(Math,yn([],Kt(r),!1)),a=Math.max.apply(Math,yn([],Kt(e),!1)),s=Math.max.apply(Math,yn([],Kt(r),!1)),o=a-n,c=s-i;return{left:n,top:i,right:a,bottom:s,width:o,height:c}}function s7(t,e,r,n){var i=Ey(t,e,r,n);return Uf(i)}function Axe(t,e,r,n,i){var a,s=t.target,o=t.origin,c=e.matrix,f=RK(s),d=f.offsetWidth,m=f.offsetHeight,b=r.getBoundingClientRect(),x=[0,0];r===zg(r)&&(x=PK(s,!0));for(var E=s.getBoundingClientRect(),T=E.left-b.left+r.scrollLeft-(r.clientLeft||0)+x[0],A=E.top-b.top+r.scrollTop-(r.clientTop||0)+x[1],M=E.width,F=E.height,N=rE(n,i,c),O=s7(N,d,m,n),U=O.left,j=O.top,H=O.width,W=O.height,X=bs(N,o,n),oe=_i(X,[U,j]),Q=[T+oe[0]*M/H,A+oe[1]*F/W],G=[0,0],ae=0;++ae<10;){var se=Ed(i,n);a=Kt(_i(bs(se,Q,n),bs(se,X,n)),2),G[0]=a[0],G[1]=a[1];var fe=rE(n,i,ey(G,n),c),_e=s7(fe,d,m,n),Le=_e.left,ye=_e.top,Te=Le-T,Ie=ye-A;if(nn(Te)<2&&nn(Ie)<2)break;Q[0]-=Te,Q[1]-=Ie}return G.map(function(Me){return Math.round(Me)})}function Ixe(t,e,r){var n=t.length===16,i=n?4:3,a=e.map(function(c){return bs(t,c,i)}),s=r.left,o=r.top;return a.map(function(c){return[c[0]+s,c[1]+o]})}function Xf(t){return Math.sqrt(t[0]*t[0]+t[1]*t[1])}function kK(t,e){return Xf([e[0]-t[0],e[1]-t[1]])}function F1(t,e,r,n){r===void 0&&(r=1),n===void 0&&(n=il(t,e));var i=kK(t,e);return{transform:"translateY(-50%) translate(".concat(t[0],"px, ").concat(t[1],"px) rotate(").concat(n,"rad) scaleY(").concat(r,")"),width:"".concat(i,"px")}}function uE(t,e){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];var i=r.length,a=r.reduce(function(o,c){return o+c[0]},0)/i,s=r.reduce(function(o,c){return o+c[1]},0)/i;return{transform:"translateZ(0px) translate(".concat(a,"px, ").concat(s,"px) rotate(").concat(t,"rad) scale(").concat(e,")")}}function ry(t,e){var r=t[e];return Ah(r)?Wt(Wt({},t),r):t}function RK(t){var e=t&&!TO(t.offsetWidth),r=0,n=0,i=0,a=0,s=0,o=0,c=0,f=0,d=0,m=0,b=0,x=0,E=1/0,T=1/0,A=1/0,M=1/0,F=0,N=0,O=!1;if(t)if(!e&&t.ownerSVGElement){var U=t.getBBox();O=!0,r=U.width,n=U.height,s=r,o=n,c=r,f=n,i=r,a=n}else{var j=Fc(t),H=t.style,W=j("boxSizing")==="border-box",X=parseFloat(j("borderLeftWidth"))||0,oe=parseFloat(j("borderRightWidth"))||0,Q=parseFloat(j("borderTopWidth"))||0,G=parseFloat(j("borderBottomWidth"))||0,ae=parseFloat(j("paddingLeft"))||0,se=parseFloat(j("paddingRight"))||0,fe=parseFloat(j("paddingTop"))||0,_e=parseFloat(j("paddingBottom"))||0,Le=ae+se,ye=fe+_e,Te=X+oe,Ie=Q+G,Me=Le+Te,de=ye+Ie,Se=j("position"),we=0,De=0;if("clientLeft"in t){var Fe=null;if(Se==="absolute"){var Xe=Xb(t,zg(t));Fe=Xe.offsetParent}else Fe=t.parentElement;if(Fe){var Be=Fc(Fe);we=parseFloat(Be("width")),De=parseFloat(Be("height"))}}d=Math.max(Le,xo(j("minWidth"),we)||0),m=Math.max(ye,xo(j("minHeight"),De)||0),E=xo(j("maxWidth"),we),T=xo(j("maxHeight"),De),isNaN(E)&&(E=1/0),isNaN(T)&&(T=1/0),F=xo(H.width,0)||0,N=xo(H.height,0)||0,s=parseFloat(j("width"))||0,o=parseFloat(j("height"))||0,c=nn(s-F)<1?sR(d,F||s,E):s,f=nn(o-N)<1?sR(m,N||o,T):o,r=c,n=f,i=c,a=f,W?(A=E,M=T,b=d,x=m,c=r-Me,f=n-de):(A=E+Me,M=T+de,b=d+Me,x=m+de,r=c+Me,n=f+de),i=c+Le,a=f+ye}return{svg:O,offsetWidth:r,offsetHeight:n,clientWidth:i,clientHeight:a,contentWidth:c,contentHeight:f,inlineCSSWidth:F,inlineCSSHeight:N,cssWidth:s,cssHeight:o,minWidth:d,minHeight:m,maxWidth:E,maxHeight:T,minOffsetWidth:b,minOffsetHeight:x,maxOffsetWidth:A,maxOffsetHeight:M}}function MK(t,e){return il(e>0?t[0]:t[1],e>0?t[1]:t[0])}function vw(){return{left:0,top:0,width:0,height:0,right:0,bottom:0,clientLeft:0,clientTop:0,clientWidth:0,clientHeight:0,scrollWidth:0,scrollHeight:0}}function DK(t,e){var r=t===zg(t)||t===kO(t),n={clientLeft:t.clientLeft,clientTop:t.clientTop,clientWidth:t.clientWidth,clientHeight:t.clientHeight,scrollWidth:t.scrollWidth,scrollHeight:t.scrollHeight,overflow:!1};return r&&(n.clientHeight=Math.max(e.height,n.clientHeight),n.scrollHeight=Math.max(e.height,n.scrollHeight)),n.overflow=Fc(t)("overflow")!=="visible",Wt(Wt({},e),n)}function QA(t,e,r,n){var i=t.left,a=t.right,s=t.top,o=t.bottom,c=e.top,f=e.left,d={left:f+i,top:c+s,right:f+a,bottom:c+o,width:a-i,height:o-s};return r&&n?DK(r,d):d}function yb(t,e){var r=0,n=0,i=0,a=0;if(t){var s=t.getBoundingClientRect();r=s.left,n=s.top,i=s.width,a=s.height}var o={left:r,top:n,width:i,height:a,right:r+i,bottom:n+a};return t&&e?DK(t,o):o}function Pxe(t){var e=t.props,r=e.groupable,n=e.svgOrigin,i=t.getState(),a=i.offsetWidth,s=i.offsetHeight,o=i.svg,c=i.transformOrigin;return!r&&o&&n?eN(n,a,s):c}function OK(t,e,r,n){var i;if(t)i=t;else if(e)i=[0,0];else{var a=r.target;i=NK(a,n)}return i}function NK(t,e){if(t){var r=t.getAttribute("data-rotation")||"",n=t.getAttribute("data-direction");if(e.deg=r,!!n){var i=[0,0];return n.indexOf("w")>-1&&(i[0]=-1),n.indexOf("e")>-1&&(i[0]=1),n.indexOf("n")>-1&&(i[1]=-1),n.indexOf("s")>-1&&(i[1]=1),i}}}function YO(t,e){return[Ma(e,t[0]),Ma(e,t[1]),Ma(e,t[2]),Ma(e,t[3])]}function Yf(t){var e=t.left,r=t.top,n=t.pos1,i=t.pos2,a=t.pos3,s=t.pos4;return YO([n,i,a,s],[e,r])}function CR(t,e){t[e?"controlAbles":"targetAbles"].forEach(function(r){r.unset&&r.unset(t)})}function h0(t,e){var r=e?"controlGesto":"targetGesto",n=t[r];n?.isIdle()===!1&&CR(t,e),n?.unset(),t[r]=null}function vc(t,e){if(e){var r=y_(e);r.nextStyle=Wt(Wt({},r.nextStyle),t)}return{style:t,cssText:g_(t).map(function(n){return"".concat(W_e(n,"-"),": ").concat(t[n],";")}).join("")}}function LK(t,e,r){var n=e.afterTransform||e.transform;return Wt(Wt({},vc(Wt(Wt(Wt({},t.style),e.style),{transform:n}),r)),{afterTransform:n,transform:t.transform})}function Ki(t,e,r,n){var i=e.datas;i.datas||(i.datas={});var a=Wt(Wt({},r),{target:t.state.target,clientX:e.clientX,clientY:e.clientY,inputEvent:e.inputEvent,currentTarget:t,moveable:t,datas:i.datas,isRequest:e.isRequest,isRequestChild:e.isRequestChild,isFirstDrag:!!e.isFirstDrag,isTrusted:e.isTrusted!==!1,stopAble:function(){i.isEventStart=!1},stopDrag:function(){var s;(s=e.stop)===null||s===void 0||s.call(e)}});return i.isStartEvent?n||(i.lastEvent=a):i.isStartEvent=!0,a}function gf(t,e,r){var n=e.datas,i="isDrag"in r?r.isDrag:e.isDrag;return n.datas||(n.datas={}),Wt(Wt({isDrag:i},r),{moveable:t,target:t.state.target,clientX:e.clientX,clientY:e.clientY,inputEvent:e.inputEvent,currentTarget:t,lastEvent:n.lastEvent,isDouble:e.isDouble,datas:n.datas,isFirstDrag:!!e.isFirstDrag})}function f3(t,e,r){t._emitter.on(e,r)}function Wn(t,e,r,n,i){return t.triggerEvent(e,r,n,i)}function ZO(t,e){return xg(t).getComputedStyle(t,e)}function _w(t,e,r){var n={},i={};return t.filter(function(a){var s=a.name;if(n[s]||!e.some(function(o){return a[o]}))return!1;if(!r&&a.ableGroup){if(i[a.ableGroup])return!1;i[a.ableGroup]=!0}return n[s]=!0,!0})}function AR(t,e){return t===e||t==null&&e==null}function l7(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var r=t.length-1,n=0;n<r;++n){var i=t[n];if(!TO(i))return i}return t[r]}function FK(t,e){var r=[],n=[];return t.forEach(function(i,a){var s=e(i,a,t),o=n.indexOf(s),c=r[o]||[];o===-1&&(n.push(s),r.push(c)),c.push(i)}),r}function kxe(t,e){var r=[],n={};return t.forEach(function(i,a){var s=e(i,a,t),o=n[s];o||(o=[],n[s]=o,r.push(o)),o.push(i)}),r}function BK(t){return t.reduce(function(e,r){return e.concat(r)},[])}function W0(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return t.sort(function(r,n){return nn(n)-nn(r)}),t[0]}function X0(t,e,r){return tc(Ed(t,r),Qm(e,r),r)}function Rxe(t,e){var r,n=t.is3d,i=t.rootMatrix,a=n?4:3;return r=Kt(X0(i,[e.distX,e.distY],a),2),e.distX=r[0],e.distY=r[1],e}function kf(t,e,r,n){if(!r[0]&&!r[1])return e;var i=bs(t,[i7(r[0]||1),0],n),a=bs(t,[0,i7(r[1]||1)],n),s=bs(t,[r[0]/Xf(i),r[1]/Xf(a)],n);return Ma(e,s)}function vh(t,e,r){return r?"".concat(t/e*100,"%"):"".concat(t,"px")}function cE(t){return nn(t)<=xc?0:t}function KO(t){return function(e){if(!e.isDragging(t))return"";var r=bbe(e,t),n=r.deg;return n?yi("view-control-rotation".concat(n)):""}}function JO(t,e){return e===void 0&&(e=[t]),function(r,n){if(n.isRequest)return e.some(function(a){return n.requestAble===a})?n.parentDirection:!1;var i=n.inputEvent.target;return Bl(i,yi("direction"))&&(!t||Bl(i,yi(t)))}}function Mxe(t,e,r){var n,i=q0(t,{"x%":function(U){return U/100*e.offsetWidth},"y%":function(U){return U/100*e.offsetHeight}}),a=t.slice(0,r<0?void 0:r),s=t.slice(0,r<0?void 0:r+1),o=t[r]||"",c=r<0?[]:t.slice(r),f=r<0?[]:t.slice(r+1),d=i.slice(0,r<0?void 0:r),m=i.slice(0,r<0?void 0:r+1),b=(n=i[r])!==null&&n!==void 0?n:q0([""])[0],x=r<0?[]:i.slice(r),E=r<0?[]:i.slice(r+1),T=b?[b]:[],A=jv(d),M=jv(m),F=jv(x),N=jv(E),O=wo(A,F,4);return{transforms:t,beforeFunctionMatrix:A,beforeFunctionMatrix2:M,targetFunctionMatrix:jv(T),afterFunctionMatrix:F,afterFunctionMatrix2:N,allFunctionMatrix:O,beforeFunctions:d,beforeFunctions2:m,targetFunction:T[0],afterFunctions:x,afterFunctions2:E,beforeFunctionTexts:a,beforeFunctionTexts2:s,targetFunctionText:o,afterFunctionTexts:c,afterFunctionTexts2:f}}function Dxe(t){return!t||!Ah(t)||RO(t)?!1:su(t)||"length"in t}function bd(t,e){return t?RO(t)?t:kp(t)?e?document.querySelector(t):t:CO(t)?t():FZ(t)?t:"current"in t?t.current:t:null}function QO(t,e){if(!t)return[];var r=Dxe(t)?[].slice.call(t):[t];return r.reduce(function(n,i){return kp(i)&&e?yn(yn([],Kt(n),!1),Kt([].slice.call(document.querySelectorAll(i))),!1):(su(i)?n.push(QO(i,e)):n.push(bd(i,e)),n)},[])}function Oxe(t,e,r){var n=il(t,e)/Math.PI*180;return n=r>=0?n:180-n,n=n>=0?n:360+n,n}function u7(t,e){var r=t.rootMatrix,n=t.is3d,i=n?4:3,a=Ed(r,i);return n||(a=Ih(a,3,4)),a[12]=0,a[13]=0,a[14]=0,u1e(a,e)}function zK(t,e,r,n,i){var a=Kt(t,2),s=a[0],o=a[1],c=0,f=0;if(i&&s&&o){var d=il([0,0],e),m=il([0,0],n),b=Xf(e),x=Math.cos(d-m)*b;if(!n[0])f=x,c=f*r;else if(!n[1])c=x,f=c/r;else{var E=n[0]*s,T=n[1]*o,A=Math.atan2(E+e[0],T+e[1]),M=Math.atan2(E,T);A<0&&(A+=Math.PI*2),M<0&&(M+=Math.PI*2);var F=0;nn(A-M)<Math.PI/2||nn(A-M)>Math.PI/2*3||(M+=Math.PI),F=A-M,F>Math.PI*2?F-=Math.PI*2:F>Math.PI?F=2*Math.PI-F:F<-Math.PI&&(F=-2*Math.PI-F);var N=Xf([E+e[0],T+e[1]])*Math.cos(F);c=N*Math.sin(M)-E,f=N*Math.cos(M)-T,n[0]<0&&(c*=-1),n[1]<0&&(f*=-1)}}else c=n[0]*e[0],f=n[1]*e[1];return[c,f]}function jK(t,e,r,n){var i,a=r.ratio,s=r.startOffsetWidth,o=r.startOffsetHeight,c=0,f=0,d=n.distX,m=n.distY,b=n.pinchScale,x=n.parentDistance,E=n.parentDist,T=n.parentScale,A=r.fixedDirection,M=[0,1].map(function(H){return nn(t[H]-A[H])}),F=[0,1].map(function(H){var W=M[H];return W!==0&&(W=2/W),W});if(E)c=E[0],f=E[1],e&&(c?f||(f=c/a):c=f*a);else if(qb(b))c=(b-1)*s,f=(b-1)*o;else if(T)c=(T[0]-1)*s,f=(T[1]-1)*o;else if(x){var N=s*M[0],O=o*M[1],U=Xf([N,O]);c=x/U*N*F[0],f=x/U*O*F[1]}else{var j=Rd({datas:r,distX:d,distY:m});j=F.map(function(H,W){return j[W]*H}),i=Kt(zK([s,o],j,a,t,e),2),c=i[0],f=i[1]}return{distWidth:c,distHeight:f}}function IR(t,e){if(e){if(t==="left")return{x:"0%",y:"50%"};if(t==="top")return{x:"50%",y:"50%"};if(t==="center")return{x:"50%",y:"50%"};if(t==="right")return{x:"100%",y:"50%"};if(t==="bottom")return{x:"50%",y:"100%"};var r=Kt(t.split(" "),2),n=r[0],i=r[1],a=IR(n||""),s=IR(i||""),o=Wt(Wt({},a),s),c={x:"50%",y:"50%"};return o.x&&(c.x=o.x),o.y&&(c.y=o.y),o.value&&(o.x&&!o.y&&(c.y=o.value),!o.x&&o.y&&(c.x=o.value)),c}return t==="left"?{x:"0%"}:t==="right"?{x:"100%"}:t==="top"?{y:"0%"}:t==="bottom"?{y:"100%"}:t?t==="center"?{value:"50%"}:{value:t}:{}}function eN(t,e,r){var n=IR(t,!0),i=n.x,a=n.y;return[xo(i,e)||0,xo(a,r)||0]}function Nxe(t,e,r){var n=t.map(function(a){return _i(a,e)}),i=n.map(function(a){return Bx(a,r)});return{prev:n,next:i,result:i.map(function(a){return Ma(a,e)})}}function UK(t,e){return t.length===e.length&&t.every(function(r,n){var i=e[n],a=su(r),s=su(i);return a&&s?UK(r,i):!a&&!s?r===i:!1})}function d0(t,e,r,n,i){var a=t._store,s=a[e];if(!(e in a))if(i!=null)a[e]=i,s=i;else return a[e]=r,r;return s===r||n(s)===n(r)?s:(a[e]=r,r)}function mc(t){return t>=0?1:-1}function nn(t){return Math.abs(t)}function e5(t,e){return K_e(t).map(function(r){return e(r)})}function VK(t){return qb(t)?{top:t,left:t,right:t,bottom:t}:{left:t.left||0,top:t.top||0,right:t.right||0,bottom:t.bottom||0}}var Lxe=Ux("pinchable",{props:["pinchable"],events:["pinchStart","pinch","pinchEnd","pinchGroupStart","pinchGroup","pinchGroupEnd"],dragStart:function(){return!0},pinchStart:function(t,e){var r=e.datas,n=e.targets,i=e.angle,a=e.originalDatas,s=t.props,o=s.pinchable,c=s.ables;if(!o)return!1;var f="onPinch".concat(n?"Group":"","Start"),d="drag".concat(n?"Group":"","ControlStart"),m=(o===!0?t.controlAbles:c.filter(function(T){return o.indexOf(T.name)>-1})).filter(function(T){return T.canPinch&&T[d]}),b=Ki(t,e,{});n&&(b.targets=n);var x=Wn(t,f,b);r.isPinch=x!==!1,r.ables=m;var E=r.isPinch;return E?(m.forEach(function(T){if(a[T.name]=a[T.name]||{},!!T[d]){var A=Wt(Wt({},e),{datas:a[T.name],parentRotate:i,isPinch:!0});T[d](t,A)}}),t.state.snapRenderInfo={request:e.isRequest,direction:[0,0]},E):!1},pinch:function(t,e){var r=e.datas,n=e.scale,i=e.distance,a=e.originalDatas,s=e.inputEvent,o=e.targets,c=e.angle;if(r.isPinch){var f=i*(1-1/n),d=Ki(t,e,{});o&&(d.targets=o);var m="onPinch".concat(o?"Group":"");Wn(t,m,d);var b=r.ables,x="drag".concat(o?"Group":"","Control");return b.forEach(function(E){E[x]&&E[x](t,Wt(Wt({},e),{datas:a[E.name],inputEvent:s,resolveMatrix:!0,pinchScale:n,parentDistance:f,parentRotate:c,isPinch:!0}))}),d}},pinchEnd:function(t,e){var r=e.datas,n=e.isPinch,i=e.inputEvent,a=e.targets,s=e.originalDatas;if(r.isPinch){var o="onPinch".concat(a?"Group":"","End"),c=gf(t,e,{isDrag:n});a&&(c.targets=a),Wn(t,o,c);var f=r.ables,d="drag".concat(a?"Group":"","ControlEnd");return f.forEach(function(m){m[d]&&m[d](t,Wt(Wt({},e),{isDrag:n,datas:s[m.name],inputEvent:i,isPinch:!0}))}),n}},pinchGroupStart:function(t,e){return this.pinchStart(t,Wt(Wt({},e),{targets:t.props.targets}))},pinchGroup:function(t,e){return this.pinch(t,Wt(Wt({},e),{targets:t.props.targets}))},pinchGroupEnd:function(t,e){return this.pinchEnd(t,Wt(Wt({},e),{targets:t.props.targets}))}}),c7=JO("scalable"),Fxe={name:"scalable",ableGroup:"size",canPinch:!0,props:["scalable","throttleScale","renderDirections","keepRatio","edge","displayAroundControls"],events:["scaleStart","beforeScale","scale","scaleEnd","scaleGroupStart","beforeScaleGroup","scaleGroup","scaleGroupEnd"],render:lK("scalable"),dragControlCondition:c7,viewClassName:KO("scalable"),dragControlStart:function(t,e){var r=e.datas,n=e.isPinch,i=e.inputEvent,a=e.parentDirection,s=OK(a,n,i,r),o=t.state,c=o.width,f=o.height,d=o.targetTransform,m=o.target,b=o.pos1,x=o.pos2,E=o.pos4;if(!s||!m)return!1;n||Sy(t,e),r.datas={},r.transform=d,r.prevDist=[1,1],r.direction=s,r.startOffsetWidth=c,r.startOffsetHeight=f,r.startValue=[1,1];var T=!s[0]&&!s[1]||s[0]||!s[1];o3(t,e,"scale"),r.isWidth=T;function A(j){r.ratio=j&&isFinite(j)?j:0}r.startPositions=Yf(t.state);function M(j){var H=bK(r.startPositions,j);r.fixedDirection=H.fixedDirection,r.fixedPosition=H.fixedPosition,r.fixedOffset=H.fixedOffset}r.setFixedDirection=M,A(gp(b,x)/gp(x,E)),M([-s[0],-s[1]]);var F=function(j){r.minScaleSize=j},N=function(j){r.maxScaleSize=j};F([-1/0,-1/0]),N([1/0,1/0]);var O=Ki(t,e,Wt(Wt({direction:s,set:function(j){r.startValue=j},setRatio:A,setFixedDirection:M,setMinScaleSize:F,setMaxScaleSize:N},a3(t,e)),{dragStart:gc.dragStart(t,new H0().dragStart([0,0],e))})),U=Wn(t,"onScaleStart",O);return r.startFixedDirection=r.fixedDirection,U!==!1&&(r.isScale=!0,t.state.snapRenderInfo={request:e.isRequest,direction:s}),r.isScale?O:!1},dragControl:function(t,e){n3(t,e,"scale");var r=e.datas,n=e.parentKeepRatio,i=e.parentFlag,a=e.isPinch,s=e.dragClient,o=e.isRequest,c=e.useSnap,f=e.resolveMatrix,d=r.prevDist,m=r.direction,b=r.startOffsetWidth,x=r.startOffsetHeight,E=r.isScale,T=r.startValue,A=r.isWidth,M=r.ratio;if(!E)return!1;var F=t.props,N=F.throttleScale,O=F.parentMoveable,U=m;!m[0]&&!m[1]&&(U=[1,1]);var j=M&&(n??F.keepRatio)||!1,H=t.state,W=[T[0],T[1]];function X(){var it=jK(U,j,r,e),be=it.distWidth,Ot=it.distHeight,at=b?(b+be)/b:1,$e=x?(x+Ot)/x:1;T[0]||(W[0]=be/b),T[1]||(W[1]=Ot/x);var Xt=(U[0]||j?at:1)*W[0],$t=(U[1]||j?$e:1)*W[1];return Xt===0&&(Xt=mc(d[0])*pw),$t===0&&($t=mc(d[1])*pw),[Xt,$t]}var oe=X();if(!a&&t.props.groupable){var Q=H.snapRenderInfo||{},G=Q.direction;su(G)&&(G[0]||G[1])&&(H.snapRenderInfo={direction:m,request:e.isRequest})}Wn(t,"onBeforeScale",Ki(t,e,{scale:oe,setFixedDirection:function(it){return r.setFixedDirection(it),oe=X(),oe},startFixedDirection:r.startFixedDirection,setScale:function(it){oe=it}},!0));var ae=[oe[0]/W[0],oe[1]/W[1]],se=s,fe=[0,0],_e=mc(ae[0]*ae[1]),Le=!s&&!i&&a;if(Le||f?se=UO(t,r.targetAllTransform,[0,0],[0,0],r):s||(se=r.fixedPosition),a||(fe=pxe(t,ae,m,!c&&o,r)),j){U[0]&&U[1]&&fe[0]&&fe[1]&&(Math.abs(fe[0]*b)>Math.abs(fe[1]*x)?fe[1]=0:fe[0]=0);var ye=!fe[0]&&!fe[1];if(ye&&(A?ae[0]=Fi(ae[0]*W[0],N)/W[0]:ae[1]=Fi(ae[1]*W[1],N)/W[1]),U[0]&&!U[1]||fe[0]&&!fe[1]||ye&&A){ae[0]+=fe[0];var Te=b*ae[0]*W[0]/M;ae[1]=mc(_e*ae[0])*nn(Te/x/W[1])}else if(!U[0]&&U[1]||!fe[0]&&fe[1]||ye&&!A){ae[1]+=fe[1];var Ie=x*ae[1]*W[1]*M;ae[0]=mc(_e*ae[1])*nn(Ie/b/W[0])}}else ae[0]+=fe[0],ae[1]+=fe[1],fe[0]||(ae[0]=Fi(ae[0]*W[0],N)/W[0]),fe[1]||(ae[1]=Fi(ae[1]*W[1],N)/W[1]);ae[0]===0&&(ae[0]=mc(d[0])*pw),ae[1]===0&&(ae[1]=mc(d[1])*pw),oe=vxe(ae,[W[0],W[1]]);var Me=[b,x],de=[b*oe[0],x*oe[1]];de=OZ(de,r.minScaleSize,r.maxScaleSize,j?M:!1),oe=e5(2,function(it){return Me[it]?de[it]/Me[it]:de[it]}),ae=e5(2,function(it){return oe[it]/W[it]});var Se=e5(2,function(it){return d[it]?ae[it]/d[it]:ae[it]}),we="scale(".concat(ae.join(", "),")"),De="scale(".concat(oe.join(", "),")"),Fe=i3(r,De,we),Xe=!T[0]||!T[1],Be=pbe(t,Xe?De:we,r.fixedDirection,se,r.fixedOffset,r,Xe),st=Le?Be:_i(Be,r.prevInverseDist||[0,0]);if(r.prevDist=ae,r.prevInverseDist=Be,oe[0]===d[0]&&oe[1]===d[1]&&st.every(function(it){return!it})&&!O&&!Le)return!1;var Qe=Ki(t,e,Wt({offsetWidth:b,offsetHeight:x,direction:m,scale:oe,dist:ae,delta:Se,isPinch:!!a},rK(t,Fe,st,a,e)));return Wn(t,"onScale",Qe),Qe},dragControlEnd:function(t,e){var r=e.datas;if(!r.isScale)return!1;r.isScale=!1;var n=gf(t,e,{});return Wn(t,"onScaleEnd",n),n},dragGroupControlCondition:c7,dragGroupControlStart:function(t,e){var r=e.datas,n=this.dragControlStart(t,e);if(!n)return!1;var i=Th(t,"resizable",e);r.moveableScale=t.scale;var a=mp(t,this,"dragControlStart",e,function(f,d){return aE(t,f,r,d)}),s=function(f){n.setFixedDirection(f),a.forEach(function(d,m){d.setFixedDirection(f),aE(t,d.moveable,r,i[m])})};r.setFixedDirection=s;var o=Wt(Wt({},n),{targets:t.props.targets,events:a,setFixedDirection:s}),c=Wn(t,"onScaleGroupStart",o);return r.isScale=c!==!1,r.isScale?o:!1},dragGroupControl:function(t,e){var r=e.datas;if(r.isScale){f3(t,"onBeforeScale",function(d){Wn(t,"onBeforeScaleGroup",Ki(t,e,Wt(Wt({},d),{targets:t.props.targets}),!0))});var n=this.dragControl(t,e);if(n){var i=n.dist,a=r.moveableScale;t.scale=[i[0]*a[0],i[1]*a[1]];var s=t.props.keepRatio,o=r.fixedPosition,c=mp(t,this,"dragControl",e,function(d,m){var b=Kt(tc(zx(t.rotation/180*Math.PI,3),[m.datas.originalX*i[0],m.datas.originalY*i[1],1],3),2),x=b[0],E=b[1];return Wt(Wt({},m),{parentDist:null,parentScale:i,parentKeepRatio:s,dragClient:Ma(o,[x,E])})}),f=Wt({targets:t.props.targets,events:c},n);return Wn(t,"onScaleGroup",f),f}}},dragGroupControlEnd:function(t,e){var r=e.isDrag,n=e.datas;if(n.isScale){this.dragControlEnd(t,e);var i=mp(t,this,"dragControlEnd",e),a=gf(t,e,{targets:t.props.targets,events:i});return Wn(t,"onScaleGroupEnd",a),r}},request:function(){var t={},e=0,r=0,n=!1;return{isControl:!0,requestStart:function(i){return n=i.useSnap,{datas:t,parentDirection:i.direction||[1,1],useSnap:n}},request:function(i){return e+=i.deltaWidth,r+=i.deltaHeight,{datas:t,parentDist:[e,r],parentKeepRatio:i.keepRatio,useSnap:n}},requestEnd:function(){return{datas:t,isDrag:!0,useSnap:n}}}}};function eg(t,e){return t.map(function(r,n){return tE(r,e[n],1,2)})}function f7(t,e,r){var n=il(t,e),i=il(t,r),a=i-n;return a>=0?a:a+2*Math.PI}function Bxe(t,e){var r=f7(t[0],t[1],t[2]),n=f7(e[0],e[1],e[2]),i=Math.PI;return!(r>=i&&n<=i||r<=i&&n>=i)}var zxe={name:"warpable",ableGroup:"size",props:["warpable","renderDirections","edge","displayAroundControls"],events:["warpStart","warp","warpEnd"],viewClassName:KO("warpable"),render:function(t,e){var r=t.props,n=r.resizable,i=r.scalable,a=r.warpable,s=r.zoom;if(n||i||!a)return[];var o=t.state,c=o.pos1,f=o.pos2,d=o.pos3,m=o.pos4,b=eg(c,f),x=eg(f,c),E=eg(c,d),T=eg(d,c),A=eg(d,m),M=eg(m,d),F=eg(f,m),N=eg(m,f);return yn([e.createElement("div",{className:yi("line"),key:"middeLine1",style:F1(b,A,s)}),e.createElement("div",{className:yi("line"),key:"middeLine2",style:F1(x,M,s)}),e.createElement("div",{className:yi("line"),key:"middeLine3",style:F1(E,F,s)}),e.createElement("div",{className:yi("line"),key:"middeLine4",style:F1(T,N,s)})],Kt(uK(t,"warpable",e)),!1)},dragControlCondition:function(t,e){if(e.isRequest)return!1;var r=e.inputEvent.target;return Bl(r,yi("direction"))&&Bl(r,yi("warpable"))},dragControlStart:function(t,e){var r=e.datas,n=e.inputEvent,i=t.props.target,a=n.target,s=NK(a,r);if(!s||!i)return!1;var o=t.state,c=o.transformOrigin,f=o.is3d,d=o.targetTransform,m=o.targetMatrix,b=o.width,x=o.height,E=o.left,T=o.top;r.datas={},r.targetTransform=d,r.warpTargetMatrix=f?m:Ih(m,3,4),r.targetInverseMatrix=BZ(Ed(r.warpTargetMatrix,4),3,4),r.direction=s,r.left=E,r.top=T,r.poses=[[0,0],[b,0],[0,x],[b,x]].map(function(F){return _i(F,c)}),r.nextPoses=r.poses.map(function(F){var N=Kt(F,2),O=N[0],U=N[1];return tc(r.warpTargetMatrix,[O,U,0,1],4)}),r.startValue=Jo(4),r.prevMatrix=Jo(4),r.absolutePoses=Yf(o),r.posIndexes=tK(s),Sy(t,e),o3(t,e,"matrix3d"),o.snapRenderInfo={request:e.isRequest,direction:s};var A=Ki(t,e,Wt({set:function(F){r.startValue=F}},a3(t,e))),M=Wn(t,"onWarpStart",A);return M!==!1&&(r.isWarp=!0),r.isWarp},dragControl:function(t,e){var r=e.datas,n=e.isRequest,i=e.distX,a=e.distY,s=r.targetInverseMatrix,o=r.prevMatrix,c=r.isWarp,f=r.startValue,d=r.poses,m=r.posIndexes,b=r.absolutePoses;if(!c)return!1;if(n3(t,e,"matrix3d"),v_(t,"warpable")){var x=m.map(function(X){return b[X]});x.length>1&&x.push([(x[0][0]+x[1][0])/2,(x[0][1]+x[1][1])/2]);var E=u3(t,n,{horizontal:x.map(function(X){return X[1]+a}),vertical:x.map(function(X){return X[0]+i})}),T=E.horizontal,A=E.vertical;a-=T.offset,i-=A.offset}var M=Rd({datas:r,distX:i,distY:a},!0),F=r.nextPoses.slice();if(m.forEach(function(X){F[X]=Ma(F[X],M)}),!nbe.every(function(X){return Bxe(X.map(function(oe){return d[oe]}),X.map(function(oe){return F[oe]}))}))return!1;var N=DO(d[0],d[2],d[1],d[3],F[0],F[2],F[1],F[3]);if(!N.length)return!1;var O=wo(s,N,4),U=QZ(r,O,!0),j=wo(Ed(o,4),U,4);r.prevMatrix=U;var H=wo(f,U,4),W=i3(r,"matrix3d(".concat(H.join(", "),")"),"matrix3d(".concat(U.join(", "),")"));return jO(e,W),Wn(t,"onWarp",Ki(t,e,Wt({delta:j,matrix:H,dist:U,multiply:wo,transform:W},vc({transform:W},e)))),!0},dragControlEnd:function(t,e){var r=e.datas,n=e.isDrag;return r.isWarp?(r.isWarp=!1,Wn(t,"onWarpEnd",gf(t,e,{})),n):!1}},jxe=yi("area-pieces"),bw=yi("area-piece"),$K=yi("avoid"),Uxe=yi("view-dragging");function t5(t){var e=t.areaElement;if(e){var r=t.state,n=r.width,i=r.height;LZ(e,$K),e.style.cssText+="left: 0px; top: 0px; width: ".concat(n,"px; height: ").concat(i,"px")}}function h7(t){return t.createElement("div",{key:"area_pieces",className:jxe},t.createElement("div",{className:bw}),t.createElement("div",{className:bw}),t.createElement("div",{className:bw}),t.createElement("div",{className:bw}))}var qK={name:"dragArea",props:["dragArea","passDragArea"],events:["click","clickGroup"],render:function(t,e){var r=t.props,n=r.target,i=r.dragArea,a=r.groupable,s=r.passDragArea,o=t.getState(),c=o.width,f=o.height,d=o.renderPoses,m=s?yi("area","pass"):yi("area");if(a)return[e.createElement("div",{key:"area",ref:zm(t,"areaElement"),className:m}),h7(e)];if(!n||!i)return[];var b=DO([0,0],[c,0],[0,f],[c,f],d[0],d[1],d[2],d[3]),x=b.length?c3(b,!0):"none";return[e.createElement("div",{key:"area",ref:zm(t,"areaElement"),className:m,style:{top:"0px",left:"0px",width:"".concat(c,"px"),height:"".concat(f,"px"),transformOrigin:"0 0",transform:x}}),h7(e)]},dragStart:function(t,e){var r=e.datas,n=e.clientX,i=e.clientY,a=e.inputEvent;if(!a)return!1;r.isDragArea=!1;var s=t.areaElement,o=t.state,c=o.moveableClientRect,f=o.renderPoses,d=o.rootMatrix,m=o.is3d,b=c.left,x=c.top,E=Uf(f),T=E.left,A=E.top,M=E.width,F=E.height,N=m?4:3,O=Kt(X0(d,[n-b,i-x],N),2),U=O[0],j=O[1];U-=T,j-=A;var H=[{left:T,top:A,width:M,height:j-10},{left:T,top:A,width:U-10,height:F},{left:T,top:A+j+10,width:M,height:F-j-10},{left:T+U+10,top:A,width:M-U-10,height:F}],W=[].slice.call(s.nextElementSibling.children);H.forEach(function(X,oe){W[oe].style.cssText="left: ".concat(X.left,"px;top: ").concat(X.top,"px; width: ").concat(X.width,"px; height: ").concat(X.height,"px;")}),NZ(s,$K),o.disableNativeEvent=!0},drag:function(t,e){var r=e.datas,n=e.inputEvent;if(this.enableNativeEvent(t),!n)return!1;r.isDragArea||(r.isDragArea=!0,t5(t))},dragEnd:function(t,e){this.enableNativeEvent(t);var r=e.inputEvent,n=e.datas;if(!r)return!1;n.isDragArea||t5(t)},dragGroupStart:function(t,e){return this.dragStart(t,e)},dragGroup:function(t,e){return this.drag(t,e)},dragGroupEnd:function(t,e){return this.dragEnd(t,e)},unset:function(t){t5(t),t.state.disableNativeEvent=!1},enableNativeEvent:function(t){var e=t.state;e.disableNativeEvent&&DZ(function(){e.disableNativeEvent=!1})}},Vxe=Ux("origin",{props:["origin","svgOrigin"],render:function(t,e){var r=t.props,n=r.zoom,i=r.svgOrigin,a=r.groupable,s=t.getState(),o=s.beforeOrigin,c=s.rotation,f=s.svg,d=s.allMatrix,m=s.is3d,b=s.left,x=s.top,E=s.offsetWidth,T=s.offsetHeight,A;if(!a&&f&&i){var M=Kt(eN(i,E,T),2),F=M[0],N=M[1],O=m?4:3,U=bs(d,[F,N],O);A=uE(c,n,_i(U,[b,x]))}else A=uE(c,n,o);return[e.createElement("div",{className:yi("control","origin"),style:A,key:"beforeOrigin"})]}});function $xe(t){var e=t.scrollContainer;return[e.scrollLeft,e.scrollTop]}var qxe={name:"scrollable",canPinch:!0,props:["scrollable","scrollContainer","scrollThreshold","scrollThrottleTime","getScrollPosition","scrollOptions"],events:["scroll","scrollGroup"],dragRelation:"strong",dragStart:function(t,e){var r=t.props,n=r.scrollContainer,i=n===void 0?t.getContainer():n,a=r.scrollOptions,s=new w1e,o=bd(i,!0);e.datas.dragScroll=s,t.state.dragScroll=s;var c=e.isControl?"controlGesto":"targetGesto",f=e.targets;s.on("scroll",function(d){var m=d.container,b=d.direction,x=Ki(t,e,{scrollContainer:m,direction:b}),E=f?"onScrollGroup":"onScroll";f&&(x.targets=f),Wn(t,E,x)}).on("move",function(d){var m=d.offsetX,b=d.offsetY,x=d.inputEvent;t[c].scrollBy(m,b,x.inputEvent,!1)}).on("scrollDrag",function(d){var m=d.next;m(t[c].getCurrentEvent())}),s.dragStart(e,Wt({container:o},a))},checkScroll:function(t,e){var r=e.datas.dragScroll;if(r){var n=t.props,i=n.scrollContainer,a=i===void 0?t.getContainer():i,s=n.scrollThreshold,o=s===void 0?0:s,c=n.scrollThrottleTime,f=c===void 0?0:c,d=n.getScrollPosition,m=d===void 0?$xe:d,b=n.scrollOptions;return r.drag(e,Wt({container:a,threshold:o,throttleTime:f,getScrollPosition:function(x){return m({scrollContainer:x.container,direction:x.direction})}},b)),!0}},drag:function(t,e){return this.checkScroll(t,e)},dragEnd:function(t,e){e.datas.dragScroll.dragEnd(),e.datas.dragScroll=null},dragControlStart:function(t,e){return this.dragStart(t,Wt(Wt({},e),{isControl:!0}))},dragControl:function(t,e){return this.drag(t,e)},dragControlEnd:function(t,e){return this.dragEnd(t,e)},dragGroupStart:function(t,e){return this.dragStart(t,Wt(Wt({},e),{targets:t.props.targets}))},dragGroup:function(t,e){return this.drag(t,Wt(Wt({},e),{targets:t.props.targets}))},dragGroupEnd:function(t,e){return this.dragEnd(t,Wt(Wt({},e),{targets:t.props.targets}))},dragGroupControlStart:function(t,e){return this.dragStart(t,Wt(Wt({},e),{targets:t.props.targets,isControl:!0}))},dragGroupControl:function(t,e){return this.drag(t,Wt(Wt({},e),{targets:t.props.targets}))},dragGroupControEnd:function(t,e){return this.dragEnd(t,Wt(Wt({},e),{targets:t.props.targets}))},unset:function(t){var e,r=t.state;(e=r.dragScroll)===null||e===void 0||e.dragEnd(),r.dragScroll=null}},HK={name:"",props:["target","dragTargetSelf","dragTarget","dragContainer","container","warpSelf","rootContainer","useResizeObserver","useMutationObserver","zoom","dragFocusedInput","transformOrigin","ables","className","pinchThreshold","pinchOutside","triggerAblesSimultaneously","checkInput","cspNonce","translateZ","hideDefaultLines","props","flushSync","stopPropagation","preventClickEventOnDrag","preventClickDefault","viewContainer","persistData","useAccuratePosition","firstRenderState","linePadding","controlPadding","preventDefault","preventRightClick","preventWheelClick","requestStyles"],events:["changeTargets"]},Hxe=Ux("padding",{props:["padding"],render:function(t,e){var r=t.props;if(r.dragArea)return[];var n=VK(r.padding||{}),i=n.left,a=n.top,s=n.right,o=n.bottom,c=t.getState(),f=c.renderPoses,d=c.pos1,m=c.pos2,b=c.pos3,x=c.pos4,E=[d,m,b,x],T=[];return i>0&&T.push([0,2]),a>0&&T.push([0,1]),s>0&&T.push([1,3]),o>0&&T.push([2,3]),T.map(function(A,M){var F=Kt(A,2),N=F[0],O=F[1],U=E[N],j=E[O],H=f[N],W=f[O],X=DO([0,0],[100,0],[0,100],[100,100],U,j,H,W);if(X.length)return e.createElement("div",{key:"padding".concat(M),className:yi("padding"),style:{transform:c3(X,!0)}})})}}),d7=["nw","ne","se","sw"];function xw(t,e){var r=t[0]+t[1],n=r>e?e/r:1;return t[0]*=n,t[1]=e-t[1]*n,t}var Gxe=[1,2,5,6],Wxe=[0,3,4,7],Tm=[1,-1,-1,1],Cm=[1,1,-1,-1];function tN(t,e,r,n,i,a,s,o){i===void 0&&(i=0),a===void 0&&(a=0),s===void 0&&(s=r),o===void 0&&(o=n);var c=[],f=!1,d=t.filter(function(b){return!b.virtual}),m=d.map(function(b){var x=b.horizontal,E=b.vertical,T=b.pos;if(E&&!f&&(f=!0,c.push("/")),f){var A=Math.max(0,E===1?T[1]-a:o-T[1]);return c.push(vh(A,n,e)),A}else{var A=Math.max(0,x===1?T[0]-i:s-T[0]);return c.push(vh(A,r,e)),A}});return{radiusPoses:d,styles:c,raws:m}}function GK(t){for(var e=[0,0],r=[0,0],n=t.length,i=0;i<n;++i){var a=t[i];a.sub&&(a.horizontal&&(e[1]===0&&(e[0]=i),e[1]=i-e[0]+1,r[0]=i+1),a.vertical&&(r[1]===0&&(r[0]=i),r[1]=i-r[0]+1))}return{horizontalRange:e,verticalRange:r}}function WK(t,e,r,n,i,a,s){var o,c,f,d;a===void 0&&(a=[0,0]),s===void 0&&(s=!1);var m=t.indexOf("/"),b=(m>-1?t.slice(0,m):t).length,x=t.slice(0,b),E=t.slice(b+1),T=x.length,A=E.length,M=A>0,F=Kt(x,4),N=F[0],O=N===void 0?"0px":N,U=F[1],j=U===void 0?O:U,H=F[2],W=H===void 0?O:H,X=F[3],oe=X===void 0?j:X,Q=Kt(E,4),G=Q[0],ae=G===void 0?O:G,se=Q[1],fe=se===void 0?M?ae:j:se,_e=Q[2],Le=_e===void 0?M?ae:W:_e,ye=Q[3],Te=ye===void 0?M?fe:oe:ye,Ie=[O,j,W,oe].map(function(Fe){return xo(Fe,e)}),Me=[ae,fe,Le,Te].map(function(Fe){return xo(Fe,r)}),de=Ie.slice(),Se=Me.slice();o=Kt(xw([de[0],de[1]],e),2),de[0]=o[0],de[1]=o[1],c=Kt(xw([de[3],de[2]],e),2),de[3]=c[0],de[2]=c[1],f=Kt(xw([Se[0],Se[3]],r),2),Se[0]=f[0],Se[3]=f[1],d=Kt(xw([Se[1],Se[2]],r),2),Se[1]=d[0],Se[2]=d[1];var we=s?de:de.slice(0,Math.max(a[0],T)),De=s?Se:Se.slice(0,Math.max(a[1],A));return yn(yn([],Kt(we.map(function(Fe,Xe){var Be=d7[Xe];return{virtual:Xe>=T,horizontal:Tm[Xe],vertical:0,pos:[n+Fe,i+(Cm[Xe]===-1?r:0)],sub:!0,raw:Ie[Xe],direction:Be}})),!1),Kt(De.map(function(Fe,Xe){var Be=d7[Xe];return{virtual:Xe>=A,horizontal:0,vertical:Cm[Xe],pos:[n+(Tm[Xe]===-1?e:0),i+Fe],sub:!0,raw:Me[Xe],direction:Be}})),!1)}function Xxe(t,e,r,n,i){i===void 0&&(i=e.length);var a=GK(t.slice(n)),s=a.horizontalRange,o=a.verticalRange,c=r-n,f=0;if(c===0)f=i;else if(c>0&&c<s[1])f=s[1]-c;else if(c>=o[0])f=o[0]+o[1]-c;else return;t.splice(r,f),e.splice(r,f)}function Yxe(t,e,r,n,i,a,s,o,c,f,d){f===void 0&&(f=0),d===void 0&&(d=0);var m=GK(t.slice(r)),b=m.horizontalRange,x=m.verticalRange;if(n>-1)for(var E=Tm[n]===1?a-f:o-a,T=b[1];T<=n;++T){var A=Cm[T]===1?d:c,M=0;if(n===T?M=a:T===0?M=f+E:Tm[T]===-1&&(M=o-(e[r][0]-f)),t.splice(r+T,0,{horizontal:Tm[T],vertical:0,pos:[M,A]}),e.splice(r+T,0,[M,A]),T===0)break}else if(i>-1){var F=Cm[i]===1?s-d:c-s;if(b[1]===0&&x[1]===0){var N=[f+F,d];t.push({horizontal:Tm[0],vertical:0,pos:N}),e.push(N)}for(var O=x[0],T=x[1];T<=i;++T){var M=Tm[T]===1?f:o,A=0;if(i===T?A=s:T===0?A=d+F:Cm[T]===1?A=e[r+O][1]:Cm[T]===-1&&(A=c-(e[r+O][1]-d)),t.push({horizontal:0,vertical:Cm[T],pos:[M,A]}),e.push([M,A]),T===0)break}}}function Zxe(t,e){e===void 0&&(e=t.map(function(i){return i.raw}));var r=t.map(function(i,a){return i.horizontal?e[a]:null}).filter(function(i){return i!=null}),n=t.map(function(i,a){return i.vertical?e[a]:null}).filter(function(i){return i!=null});return{horizontals:r,verticals:n}}var Kxe=[[0,-1,"n"],[1,0,"e"]],Jxe=[[-1,-1,"nw"],[0,-1,"n"],[1,-1,"ne"],[1,0,"e"],[1,1,"se"],[0,1,"s"],[-1,1,"sw"],[-1,0,"w"]];function rN(t,e,r){var n=t.props.clipRelative,i=t.state,a=i.width,s=i.height,o=e,c=o.type,f=o.poses,d=c==="rect",m=c==="circle";if(c==="polygon")return r.map(function(j){return"".concat(vh(j[0],a,n)," ").concat(vh(j[1],s,n))});if(d||c==="inset"){var b=r[1][1],x=r[3][0],E=r[7][0],T=r[5][1];if(d)return[b,x,T,E].map(function(j){return"".concat(j,"px")});var A=[b,a-x,s-T,E].map(function(j,H){return vh(j,H%2?a:s,n)});if(r.length>8){var M=Kt(_i(r[4],r[0]),2),F=M[0],N=M[1];A.push.apply(A,yn(["round"],Kt(tN(f.slice(8).map(function(j,H){return Wt(Wt({},j),{pos:r[H]})}),n,F,N,E,b,x,T).styles),!1))}return A}else if(m||c==="ellipse"){var O=r[0],U=vh(nn(r[1][1]-O[1]),m?Math.sqrt((a*a+s*s)/2):s,n),A=m?[U]:[vh(nn(r[2][0]-O[0]),a,n),U];return A.push("at",vh(O[0],a,n),vh(O[1],s,n)),A}}function fE(t,e,r,n){var i=[n,(n+e)/2,e],a=[t,(t+r)/2,r];return Jxe.map(function(s){var o=Kt(s,3),c=o[0],f=o[1],d=o[2],m=i[c+1],b=a[f+1];return{vertical:nn(f),horizontal:nn(c),direction:d,pos:[m,b]}})}function XK(t){var e=[1/0,-1/0],r=[1/0,-1/0];return t.forEach(function(n){var i=n.pos;e[0]=Math.min(e[0],i[0]),e[1]=Math.max(e[1],i[0]),r[0]=Math.min(r[0],i[1]),r[1]=Math.max(r[1],i[1])}),[nn(e[1]-e[0]),nn(r[1]-r[0])]}function p7(t,e,r,n,i){var a,s,o,c,f,d,m,b,x;if(t){var E=i;if(!E){var T=Fc(t),A=T("clipPath");E=A!=="none"?A:T("clip")}if(!((!E||E==="none"||E==="auto")&&(E=n,!E))){var M=MZ(E),F=M.prefix,N=F===void 0?E:F,O=M.value,U=O===void 0?"":O,j=N==="circle",H=" ";if(N==="polygon"){var W=km(U||"0% 0%, 100% 0%, 100% 100%, 0% 100%");H=",";var X=W.map(function(mr){var ar=Kt(mr.split(" "),2),Cr=ar[0],Er=ar[1];return{vertical:1,horizontal:1,pos:[xo(Cr,e),xo(Er,r)]}}),oe=ty(X.map(function(mr){return mr.pos}));return{type:N,clipText:E,poses:X,splitter:H,left:oe.minX,right:oe.maxX,top:oe.minY,bottom:oe.maxY}}else if(j||N==="ellipse"){var Q="",G="",ae=0,se=0,W=Cg(U);if(j){var fe="";a=Kt(W,4),s=a[0],fe=s===void 0?"50%":s,o=a[2],Q=o===void 0?"50%":o,c=a[3],G=c===void 0?"50%":c,ae=xo(fe,Math.sqrt((e*e+r*r)/2)),se=ae}else{var _e="",Le="";f=Kt(W,5),d=f[0],_e=d===void 0?"50%":d,m=f[1],Le=m===void 0?"50%":m,b=f[3],Q=b===void 0?"50%":b,x=f[4],G=x===void 0?"50%":x,ae=xo(_e,e),se=xo(Le,r)}var ye=[xo(Q,e),xo(G,r)],X=yn([{vertical:1,horizontal:1,pos:ye,direction:"nesw"}],Kt(Kxe.slice(0,j?1:2).map(function(Cr){return{vertical:nn(Cr[1]),horizontal:Cr[0],direction:Cr[2],sub:!0,pos:[ye[0]+Cr[0]*ae,ye[1]+Cr[1]*se]}})),!1);return{type:N,clipText:E,radiusX:ae,radiusY:se,left:ye[0]-ae,top:ye[1]-se,right:ye[0]+ae,bottom:ye[1]+se,poses:X,splitter:H}}else if(N==="inset"){var W=Cg(U||"0 0 0 0"),Te=W.indexOf("round"),Ie=(Te>-1?W.slice(0,Te):W).length,Me=W.slice(Ie+1),de=Kt(W.slice(0,Ie),4),Se=de[0],we=de[1],De=we===void 0?Se:we,Fe=de[2],Xe=Fe===void 0?Se:Fe,Be=de[3],st=Be===void 0?De:Be,Qe=Kt([Se,Xe].map(function(Cr){return xo(Cr,r)}),2),it=Qe[0],be=Qe[1],Ot=Kt([st,De].map(function(Cr){return xo(Cr,e)}),2),at=Ot[0],$e=Ot[1],Xt=e-$e,$t=r-be,cr=WK(Me,Xt-at,$t-it,at,it),X=yn(yn([],Kt(fE(it,Xt,$t,at)),!1),Kt(cr),!1);return{type:"inset",clipText:E,poses:X,top:it,left:at,right:Xt,bottom:$t,radius:Me,splitter:H}}else if(N==="rect"){var W=km(U||"0px, ".concat(e,"px, ").concat(r,"px, 0px"));H=",";var _t=Kt(W.map(function(ot){var Ce=Fx(ot).value;return Ce}),4),gr=_t[0],$e=_t[1],be=_t[2],at=_t[3],X=fE(gr,$e,be,at);return{type:"rect",clipText:E,poses:X,top:gr,right:$e,bottom:be,left:at,values:W,splitter:H}}}}}function Qxe(t,e,r,n,i){var a=t[e],s=a.direction,o=a.sub,c=t.map(function(){return[0,0]}),f=s?s.split(""):[];if(n&&e<8){var d=f.filter(function(ae){return ae==="w"||ae==="e"}),m=f.filter(function(ae){return ae==="n"||ae==="s"}),b=d[0],x=m[0];c[e]=r;var E=Kt(XK(t),2),T=E[0],A=E[1],M=T&&A?T/A:0;if(M&&i){var F=(e+4)%8,N=t[F].pos,O=[0,0];s.indexOf("w")>-1?O[0]=-1:s.indexOf("e")>-1&&(O[0]=1),s.indexOf("n")>-1?O[1]=-1:s.indexOf("s")>-1&&(O[1]=1);var U=zK([T,A],r,M,O,!0),j=T+U[0],H=A+U[1],W=N[1],X=N[1],oe=N[0],Q=N[0];O[0]===-1?oe=Q-j:O[0]===1?Q=oe+j:(oe=oe-j/2,Q=Q+j/2),O[1]===-1?W=X-H:(O[1]===1||(W=X-H/2),X=W+H);var G=fE(W,Q,X,oe);t.forEach(function(ae,se){c[se][0]=G[se].pos[0]-ae.pos[0],c[se][1]=G[se].pos[1]-ae.pos[1]})}else t.forEach(function(ae,se){var fe=ae.direction;fe&&(fe.indexOf(b)>-1&&(c[se][0]=r[0]),fe.indexOf(x)>-1&&(c[se][1]=r[1]))}),b&&(c[1][0]=r[0]/2,c[5][0]=r[0]/2),x&&(c[3][1]=r[1]/2,c[7][1]=r[1]/2)}else s&&!o?f.forEach(function(ae){var se=ae==="n"||ae==="s";t.forEach(function(fe,_e){var Le=fe.direction,ye=fe.horizontal,Te=fe.vertical;!Le||Le.indexOf(ae)===-1||(c[_e]=[se||!ye?0:r[0],!se||!Te?0:r[1]])})}):c[e]=r;return c}function e2e(t,e){var r=Kt(JZ(t,e),2),n=r[0],i=r[1],a=e.datas,s=a.clipPath,o=a.clipIndex,c=s,f=c.type,d=c.poses,m=c.splitter,b=d.map(function(F){return F.pos});if(f==="polygon")b.splice(o,0,[n,i]);else if(f==="inset"){var x=Gxe.indexOf(o),E=Wxe.indexOf(o),T=d.length;if(Yxe(d,b,8,x,E,n,i,b[4][0],b[4][1],b[0][0],b[0][1]),T===d.length)return}else return;var A=rN(t,s,b),M="".concat(f,"(").concat(A.join(m),")");Wn(t,"onClip",Ki(t,e,Wt({clipEventType:"added",clipType:f,poses:b,clipStyles:A,clipStyle:M,distX:0,distY:0},vc({clipPath:M},e))))}function t2e(t,e){var r=e.datas,n=r.clipPath,i=r.clipIndex,a=n,s=a.type,o=a.poses,c=a.splitter,f=o.map(function(x){return x.pos}),d=f.length;if(s==="polygon")o.splice(i,1),f.splice(i,1);else if(s==="inset"){if(i<8||(Xxe(o,f,i,8,d),d===o.length))return}else return;var m=rN(t,n,f),b="".concat(s,"(").concat(m.join(c),")");Wn(t,"onClip",Ki(t,e,Wt({clipEventType:"removed",clipType:s,poses:f,clipStyles:m,clipStyle:b,distX:0,distY:0},vc({clipPath:b},e))))}var r2e={name:"clippable",props:["clippable","defaultClipPath","customClipPath","keepRatio","clipRelative","clipArea","dragWithClip","clipTargetBounds","clipVerticalGuidelines","clipHorizontalGuidelines","clipSnapThreshold"],events:["clipStart","clip","clipEnd"],css:[`.control.clip-control {
background: #6d6;
cursor: pointer;
}
.control.clip-control.clip-radius {
background: #d66;
}
.line.clip-line {
background: #6e6;
cursor: move;
z-index: 1;
}
.clip-area {
position: absolute;
top: 0;
left: 0;
}
.clip-ellipse {
position: absolute;
cursor: move;
border: 1px solid #6d6;
border: var(--zoompx) solid #6d6;
border-radius: 50%;
transform-origin: 0px 0px;
}`,`:host {
--bounds-color: #d66;
}`,`.guideline {
pointer-events: none;
z-index: 2;
}`,`.line.guideline.bounds {
background: #d66;
background: var(--bounds-color);
}`],render:function(t,e){var r=t.props,n=r.customClipPath,i=r.defaultClipPath,a=r.clipArea,s=r.zoom,o=r.groupable,c=t.getState(),f=c.target,d=c.width,m=c.height,b=c.allMatrix,x=c.is3d,E=c.left,T=c.top,A=c.pos1,M=c.pos2,F=c.pos3,N=c.pos4,O=c.clipPathState,U=c.snapBoundInfos,j=c.rotation;if(!f||o)return[];var H=p7(f,d,m,i||"inset",O||n);if(!H)return[];var W=x?4:3,X=H.type,oe=H.poses,Q=oe.map(function($e){var Xt=bs(b,$e.pos,W);return[Xt[0]-E,Xt[1]-T]}),G=[],ae=[],se=X==="rect",fe=X==="inset",_e=X==="polygon";if(se||fe||_e){var Le=fe?Q.slice(0,8):Q;ae=Le.map(function($e,Xt){var $t=Xt===0?Le[Le.length-1]:Le[Xt-1],cr=il($t,$e),_t=kK($t,$e);return e.createElement("div",{key:"clipLine".concat(Xt),className:yi("line","clip-line","snap-control"),"data-clip-index":Xt,style:{width:"".concat(_t,"px"),transform:"translate(".concat($t[0],"px, ").concat($t[1],"px) rotate(").concat(cr,"rad) scaleY(").concat(s,")")}})})}if(G=Q.map(function($e,Xt){return e.createElement("div",{key:"clipControl".concat(Xt),className:yi("control","clip-control","snap-control"),"data-clip-index":Xt,style:{transform:"translate(".concat($e[0],"px, ").concat($e[1],"px) rotate(").concat(j,"rad) scale(").concat(s,")")}})}),fe&&G.push.apply(G,yn([],Kt(Q.slice(8).map(function($e,Xt){return e.createElement("div",{key:"clipRadiusControl".concat(Xt),className:yi("control","clip-control","clip-radius","snap-control"),"data-clip-index":8+Xt,style:{transform:"translate(".concat($e[0],"px, ").concat($e[1],"px) rotate(").concat(j,"rad) scale(").concat(s,")")}})})),!1)),X==="circle"||X==="ellipse"){var ye=H.left,Te=H.top,Ie=H.radiusX,Me=H.radiusY,de=Kt(_i(bs(b,[ye,Te],W),bs(b,[0,0],W)),2),Se=de[0],we=de[1],De="none";if(!a){for(var Fe=Math.max(10,Ie/5,Me/5),Xe=[],Be=0;Be<=Fe;++Be){var st=Math.PI*2/Fe*Be;Xe.push([Ie+(Ie-s)*Math.cos(st),Me+(Me-s)*Math.sin(st)])}Xe.push([Ie,-2]),Xe.push([-2,-2]),Xe.push([-2,Me*2+2]),Xe.push([Ie*2+2,Me*2+2]),Xe.push([Ie*2+2,-2]),Xe.push([Ie,-2]),De="polygon(".concat(Xe.map(function($e){return"".concat($e[0],"px ").concat($e[1],"px")}).join(", "),")")}G.push(e.createElement("div",{key:"clipEllipse",className:yi("clip-ellipse","snap-control"),style:{width:"".concat(Ie*2,"px"),height:"".concat(Me*2,"px"),clipPath:De,transform:"translate(".concat(-E+Se,"px, ").concat(-T+we,"px) ").concat(c3(b))}}))}if(a){var Qe=Uf(yn([A,M,F,N],Kt(Q),!1)),it=Qe.width,be=Qe.height,Ot=Qe.left,at=Qe.top;if(_e||se||fe){var Xe=fe?Q.slice(0,8):Q;G.push(e.createElement("div",{key:"clipArea",className:yi("clip-area","snap-control"),style:{width:"".concat(it,"px"),height:"".concat(be,"px"),transform:"translate(".concat(Ot,"px, ").concat(at,"px)"),clipPath:"polygon(".concat(Xe.map(function(Xt){return"".concat(Xt[0]-Ot,"px ").concat(Xt[1]-at,"px")}).join(", "),")")}}))}}return U&&["vertical","horizontal"].forEach(function($e){var Xt=U[$e],$t=$e==="horizontal";Xt.isSnap&&ae.push.apply(ae,yn([],Kt(Xt.snap.posInfos.map(function(cr,_t){var gr=cr.pos,mr=_i(bs(b,$t?[0,gr]:[gr,0],W),[E,T]),ar=_i(bs(b,$t?[d,gr]:[gr,m],W),[E,T]);return Wb(e,"",mr,ar,s,"clip".concat($e,"snap").concat(_t),"guideline")})),!1)),Xt.isBound&&ae.push.apply(ae,yn([],Kt(Xt.bounds.map(function(cr,_t){var gr=cr.pos,mr=_i(bs(b,$t?[0,gr]:[gr,0],W),[E,T]),ar=_i(bs(b,$t?[d,gr]:[gr,m],W),[E,T]);return Wb(e,"",mr,ar,s,"clip".concat($e,"bounds").concat(_t),"guideline","bounds","bold")})),!1))}),yn(yn([],Kt(G),!1),Kt(ae),!1)},dragControlCondition:function(t,e){return e.inputEvent&&(e.inputEvent.target.getAttribute("class")||"").indexOf("clip")>-1},dragStart:function(t,e){var r=t.props,n=r.dragWithClip,i=n===void 0?!0:n;return i?!1:this.dragControlStart(t,e)},drag:function(t,e){return this.dragControl(t,Wt(Wt({},e),{isDragTarget:!0}))},dragEnd:function(t,e){return this.dragControlEnd(t,e)},dragControlStart:function(t,e){var r=t.state,n=t.props,i=n.defaultClipPath,a=n.customClipPath,s=r.target,o=r.width,c=r.height,f=e.inputEvent?e.inputEvent.target:null,d=f&&f.getAttribute("class")||"",m=e.datas,b=p7(s,o,c,i||"inset",a);if(!b)return!1;var x=b.clipText,E=b.type,T=b.poses,A=Wn(t,"onClipStart",Ki(t,e,{clipType:E,clipStyle:x,poses:T.map(function(M){return M.pos})}));return A===!1?(m.isClipStart=!1,!1):(m.isControl=d&&d.indexOf("clip-control")>-1,m.isLine=d.indexOf("clip-line")>-1,m.isArea=d.indexOf("clip-area")>-1||d.indexOf("clip-ellipse")>-1,m.clipIndex=f?parseInt(f.getAttribute("data-clip-index"),10):-1,m.clipPath=b,m.isClipStart=!0,r.clipPathState=x,Sy(t,e),!0)},dragControl:function(t,e){var r,n,i,a=e.datas,s=e.originalDatas,o=e.isDragTarget;if(!a.isClipStart)return!1;var c=a,f=c.isControl,d=c.isLine,m=c.isArea,b=c.clipIndex,x=c.clipPath;if(!x)return!1;var E=ry(t.props,"clippable"),T=E.keepRatio,A=0,M=0,F=s.draggable,N=Rd(e);o&&F?(r=Kt(F.prevBeforeDist,2),A=r[0],M=r[1]):(n=Kt(N,2),A=n[0],M=n[1]);var O=[A,M],U=t.state,j=U.width,H=U.height,W=!m&&!f&&!d,X=x.type,oe=x.poses,Q=x.splitter,G=oe.map(function($r){return $r.pos});W&&(A=-A,M=-M);var ae=!f||oe[b].direction==="nesw",se=X==="inset"||X==="rect",fe=oe.map(function(){return[0,0]});if(f&&!ae){var _e=oe[b],Le=_e.horizontal,ye=_e.vertical,Te=[A*nn(Le),M*nn(ye)];fe=Qxe(oe,b,Te,se,T)}else ae&&(fe=G.map(function(){return[A,M]}));var Ie=G.map(function($r,fn){return Ma($r,fe[fn])}),Me=yn([],Kt(Ie),!1);U.snapBoundInfos=null;var de=x.type==="circle",Se=x.type==="ellipse";if(de||Se){var we=Uf(Ie),De=nn(we.bottom-we.top),Fe=nn(Se?we.right-we.left:De),Xe=Ie[0][1]+De,Be=Ie[0][0]-Fe,st=Ie[0][0]+Fe;de&&(Me.push([st,we.bottom]),fe.push([1,0])),Me.push([we.left,Xe]),fe.push([0,1]),Me.push([Be,we.bottom]),fe.push([1,0])}var Qe=EK((E.clipHorizontalGuidelines||[]).map(function($r){return xo("".concat($r),H)}),(E.clipVerticalGuidelines||[]).map(function($r){return xo("".concat($r),j)}),j,H),it=[],be=[];if(de||Se)it=[Me[4][0],Me[2][0]],be=[Me[1][1],Me[3][1]];else if(se){var Ot=[Me[0],Me[2],Me[4],Me[6]],at=[fe[0],fe[2],fe[4],fe[6]];it=Ot.filter(function($r,fn){return at[fn][0]}).map(function($r){return $r[0]}),be=Ot.filter(function($r,fn){return at[fn][1]}).map(function($r){return $r[1]})}else it=Me.filter(function($r,fn){return fe[fn][0]}).map(function($r){return $r[0]}),be=Me.filter(function($r,fn){return fe[fn][1]}).map(function($r){return $r[1]});var $e=[0,0],Xt=J9(Qe,E.clipTargetBounds&&{left:0,top:0,right:j,bottom:H},it,be,5,5),$t=Xt.horizontal,cr=Xt.vertical,_t=$t.offset,gr=cr.offset;if($t.isBound&&($e[1]+=_t),cr.isBound&&($e[0]+=gr),(Se||de)&&fe[0][0]===0&&fe[0][1]===0){var we=Uf(Ie),mr=we.bottom-we.top,ar=Se?we.right-we.left:mr,Cr=cr.isBound?nn(gr):cr.snapIndex===0?-gr:gr,Er=$t.isBound?nn(_t):$t.snapIndex===0?-_t:_t;ar-=Cr,mr-=Er,de&&(mr=mK(cr,$t)>0?mr:ar,ar=mr);var Jt=Me[0];Me[1][1]=Jt[1]-mr,Me[2][0]=Jt[0]+ar,Me[3][1]=Jt[1]+mr,Me[4][0]=Jt[0]-ar}else if(se&&T&&f){var ot=Kt(XK(oe),2),Ce=ot[0],xe=ot[1],je=Ce&&xe?Ce/xe:0,qe=oe[b],Ge=qe.direction||"",Ft=Me[1][1],Xe=Me[5][1],Be=Me[7][0],st=Me[3][0];nn(_t)<=nn(gr)?_t=mc(_t)*nn(gr)/je:gr=mc(gr)*nn(_t)*je,Ge.indexOf("w")>-1?Be-=gr:Ge.indexOf("e")>-1?st-=gr:(Be+=gr/2,st-=gr/2),Ge.indexOf("n")>-1?Ft-=_t:Ge.indexOf("s")>-1?Xe-=_t:(Ft+=_t/2,Xe-=_t/2);var Et=fE(Ft,st,Xe,Be);Me.forEach(function(Mt,en){var jn;jn=Kt(Et[en].pos,2),Mt[0]=jn[0],Mt[1]=jn[1]})}else Me.forEach(function($r,fn){var zr=fe[fn];zr[0]&&($r[0]-=gr),zr[1]&&($r[1]-=_t)});var mt=rN(t,x,Ie),ct="".concat(X,"(").concat(mt.join(Q),")");if(U.clipPathState=ct,de||Se)it=[Me[4][0],Me[2][0]],be=[Me[1][1],Me[3][1]];else if(se){var Ot=[Me[0],Me[2],Me[4],Me[6]];it=Ot.map(function(fn){return fn[0]}),be=Ot.map(function(fn){return fn[1]})}else it=Me.map(function($r){return $r[0]}),be=Me.map(function($r){return $r[1]});if(U.snapBoundInfos=J9(Qe,E.clipTargetBounds&&{left:0,top:0,right:j,bottom:H},it,be,1,1),F){var Qt=U.is3d,Ht=U.allMatrix,Ir=Qt?4:3,Ar=$e;o&&(Ar=[O[0]+$e[0]-N[0],O[1]+$e[1]-N[1]]),F.deltaOffset=wo(Ht,[Ar[0],Ar[1],0,0],Ir)}return Wn(t,"onClip",Ki(t,e,Wt({clipEventType:"changed",clipType:X,poses:Ie,clipStyle:ct,clipStyles:mt,distX:A,distY:M},vc((i={},i[X==="rect"?"clip":"clipPath"]=ct,i),e)))),!0},dragControlEnd:function(t,e){this.unset(t);var r=e.isDrag,n=e.datas,i=e.isDouble,a=n.isLine,s=n.isClipStart,o=n.isControl;return s?(Wn(t,"onClipEnd",gf(t,e,{})),i&&(o?t2e(t,e):a&&e2e(t,e)),i||r):!1},unset:function(t){t.state.clipPathState="",t.state.snapBoundInfos=null}},n2e={name:"originDraggable",props:["originDraggable","originRelative"],events:["dragOriginStart","dragOrigin","dragOriginEnd"],css:[`:host[data-able-origindraggable] .control.origin {
pointer-events: auto;
}`],dragControlCondition:function(t,e){return e.isRequest?e.requestAble==="originDraggable":Bl(e.inputEvent.target,yi("origin"))},dragControlStart:function(t,e){var r=e.datas;Sy(t,e);var n=Ki(t,e,{dragStart:gc.dragStart(t,new H0().dragStart([0,0],e))}),i=Wn(t,"onDragOriginStart",n);return r.startOrigin=t.state.transformOrigin,r.startTargetOrigin=t.state.targetOrigin,r.prevOrigin=[0,0],r.isDragOrigin=!0,i===!1?(r.isDragOrigin=!1,!1):n},dragControl:function(t,e){var r=e.datas,n=e.isPinch,i=e.isRequest;if(!r.isDragOrigin)return!1;var a=Kt(Rd(e),2),s=a[0],o=a[1],c=t.state,f=c.width,d=c.height,m=c.offsetMatrix,b=c.targetMatrix,x=c.is3d,E=t.props.originRelative,T=E===void 0?!0:E,A=x?4:3,M=[s,o];if(i){var F=e.distOrigin;(F[0]||F[1])&&(M=F)}var N=Ma(r.startOrigin,M),O=Ma(r.startTargetOrigin,M),U=_i(M,r.prevOrigin),j=$x(m,b,N,A),H=t.getRect(),W=Uf(Ey(j,f,d,A)),X=[H.left-W.left,H.top-W.top];r.prevOrigin=M;var oe=[vh(O[0],f,T),vh(O[1],d,T)].join(" "),Q=gc.drag(t,Vx(e,t.state,X,!!n)),G=Ki(t,e,Wt(Wt({width:f,height:d,origin:N,dist:M,delta:U,transformOrigin:oe,drag:Q},vc({transformOrigin:oe,transform:Q.transform},e)),{afterTransform:Q.transform}));return Wn(t,"onDragOrigin",G),G},dragControlEnd:function(t,e){var r=e.datas;return r.isDragOrigin?(Wn(t,"onDragOriginEnd",gf(t,e,{})),!0):!1},dragGroupControlCondition:function(t,e){return this.dragControlCondition(t,e)},dragGroupControlStart:function(t,e){var r=this.dragControlStart(t,e);return!!r},dragGroupControl:function(t,e){var r=this.dragControl(t,e);return r?(t.transformOrigin=r.transformOrigin,!0):!1},request:function(t){var e={},r=t.getRect(),n=0,i=0,a=r.transformOrigin,s=[0,0];return{isControl:!0,requestStart:function(){return{datas:e}},request:function(o){return"deltaOrigin"in o?(s[0]+=o.deltaOrigin[0],s[1]+=o.deltaOrigin[1]):"origin"in o?(s[0]=o.origin[0]-a[0],s[1]=o.origin[1]-a[1]):("x"in o?n=o.x-r.left:"deltaX"in o&&(n+=o.deltaX),"y"in o?i=o.y-r.top:"deltaY"in o&&(i+=o.deltaY)),{datas:e,distX:n,distY:i,distOrigin:s}},requestEnd:function(){return{datas:e,isDrag:!0}}}}};function i2e(t,e,r,n){var i=t.filter(function(c){var f=c.virtual,d=c.horizontal;return d&&!f}).length,a=t.filter(function(c){var f=c.virtual,d=c.vertical;return d&&!f}).length,s=-1;if(e===0&&(i===0?s=0:i===1&&(s=1)),e===2&&(i<=2?s=2:i<=3&&(s=3)),e===3&&(a===0?s=4:a<4&&(s=7)),e===1&&(a<=1?s=5:a<=2&&(s=6)),!(s===-1||!t[s].virtual)){var o=t[s];a2e(t,s),s<4?o.pos[0]=r:o.pos[1]=n}}function a2e(t,e){e<4?t.slice(0,e+1).forEach(function(r){r.virtual=!1}):(t[0].virtual&&(t[0].virtual=!1),t.slice(4,e+1).forEach(function(r){r.virtual=!1}))}function o2e(t,e){e<4?t.slice(e,4).forEach(function(r){r.virtual=!0}):t.slice(e).forEach(function(r){r.virtual=!0})}function g7(t,e,r,n,i){n===void 0&&(n=[0,0]);var a=[];return!t||t==="0px"?a=[]:a=Cg(t),WK(a,e,r,0,0,n,i)}function m7(t,e,r,n,i){var a=t.state,s=a.width,o=a.height,c=tN(i,t.props.roundRelative,s,o),f=c.raws,d=c.styles,m=c.radiusPoses,b=Zxe(m,f),x=b.horizontals,E=b.verticals,T=d.join(" ");a.borderRadiusState=T;var A=Ki(t,e,Wt({horizontals:x,verticals:E,borderRadius:T,width:s,height:o,delta:n,dist:r},vc({borderRadius:T},e)));return Wn(t,"onRound",A),A}function y7(t){var e,r,n=t.getState().style,i=n.borderRadius||"";if(!i&&t.props.groupable){var a=t.moveables[0],s=t.getTargets()[0];s&&(a?.props.target===s?(i=(r=(e=t.moveables[0])===null||e===void 0?void 0:e.state.style.borderRadius)!==null&&r!==void 0?r:"",n.borderRadius=i):(i=ZO(s).borderRadius,n.borderRadius=i))}return i}var s2e={name:"roundable",props:["roundable","roundRelative","minRoundControls","maxRoundControls","roundClickable","roundPadding","isDisplayShadowRoundControls"],events:["roundStart","round","roundEnd","roundGroupStart","roundGroup","roundGroupEnd"],css:[`.control.border-radius {
background: #d66;
cursor: pointer;
z-index: 3;
}`,`.control.border-radius.vertical {
background: #d6d;
z-index: 2;
}`,`.control.border-radius.virtual {
opacity: 0.5;
z-index: 1;
}`,`:host.round-line-clickable .line.direction {
cursor: pointer;
}`],className:function(t){var e=t.props.roundClickable;return e===!0||e==="line"?yi("round-line-clickable"):""},requestStyle:function(){return["borderRadius"]},requestChildStyle:function(){return["borderRadius"]},render:function(t,e){var r=t.getState(),n=r.target,i=r.width,a=r.height,s=r.allMatrix,o=r.is3d,c=r.left,f=r.top,d=r.borderRadiusState,m=t.props,b=m.minRoundControls,x=b===void 0?[0,0]:b,E=m.maxRoundControls,T=E===void 0?[4,4]:E,A=m.zoom,M=m.roundPadding,F=M===void 0?0:M,N=m.isDisplayShadowRoundControls,O=m.groupable;if(!n)return null;var U=d||y7(t),j=o?4:3,H=g7(U,i,a,x,!0);if(!H)return null;var W=0,X=0,oe=O?[0,0]:[c,f];return H.map(function(Q,G){var ae=Q.horizontal,se=Q.vertical,fe=Q.direction||"",_e=yn([],Kt(Q.pos),!1);X+=Math.abs(ae),W+=Math.abs(se),ae&&fe.indexOf("n")>-1&&(_e[1]-=F),se&&fe.indexOf("w")>-1&&(_e[0]-=F),ae&&fe.indexOf("s")>-1&&(_e[1]+=F),se&&fe.indexOf("e")>-1&&(_e[0]+=F);var Le=_i(bs(s,_e,j),oe),ye=N&&N!=="horizontal",Te=Q.vertical?W<=T[1]&&(ye||!Q.virtual):X<=T[0]&&(N||!Q.virtual);return e.createElement("div",{key:"borderRadiusControl".concat(G),className:yi("control","border-radius",Q.vertical?"vertical":"",Q.virtual?"virtual":""),"data-radius-index":G,style:{display:Te?"block":"none",transform:"translate(".concat(Le[0],"px, ").concat(Le[1],"px) scale(").concat(A,")")}})})},dragControlCondition:function(t,e){if(!e.inputEvent||e.isRequest)return!1;var r=e.inputEvent.target.getAttribute("class")||"";return r.indexOf("border-radius")>-1||r.indexOf("moveable-line")>-1&&r.indexOf("moveable-direction")>-1},dragGroupControlCondition:function(t,e){return this.dragControlCondition(t,e)},dragControlStart:function(t,e){var r=e.inputEvent,n=e.datas,i=r.target,a=i.getAttribute("class")||"",s=a.indexOf("border-radius")>-1,o=a.indexOf("moveable-line")>-1&&a.indexOf("moveable-direction")>-1,c=s?parseInt(i.getAttribute("data-radius-index"),10):-1,f=-1;if(o){var d=i.getAttribute("data-line-key")||"";d&&(f=parseInt(d.replace(/render-line-/g,""),10),isNaN(f)&&(f=-1))}if(!s&&!o)return!1;var m=Ki(t,e,{}),b=Wn(t,"onRoundStart",m);if(b===!1)return!1;n.lineIndex=f,n.controlIndex=c,n.isControl=s,n.isLine=o,Sy(t,e);var x=t.props,E=x.roundRelative,T=x.minRoundControls,A=T===void 0?[0,0]:T,M=t.state,F=M.width,N=M.height;n.isRound=!0,n.prevDist=[0,0];var O=y7(t),U=g7(O||"",F,N,A,!0)||[];return n.controlPoses=U,M.borderRadiusState=tN(U,E,F,N).styles.join(" "),m},dragControl:function(t,e){var r=e.datas,n=r.controlPoses;if(!r.isRound||!r.isControl||!n.length)return!1;var i=r.controlIndex,a=Kt(Rd(e),2),s=a[0],o=a[1],c=[s,o],f=_i(c,r.prevDist),d=t.props.maxRoundControls,m=d===void 0?[4,4]:d,b=t.state,x=b.width,E=b.height,T=n[i],A=T.vertical,M=T.horizontal,F=n.map(function(O){var U=O.horizontal,j=O.vertical,H=[U*M*c[0],j*A*c[1]];if(U){if(m[0]===1)return H;if(m[0]<4&&U!==M)return H}else{if(m[1]===0)return H[1]=j*M*c[0]/x*E,H;if(A){if(m[1]===1)return H;if(m[1]<4&&j!==A)return H}}return[0,0]});F[i]=c;var N=n.map(function(O,U){return Wt(Wt({},O),{pos:Ma(O.pos,F[U])})});return i<4?N.slice(0,i+1).forEach(function(O){O.virtual=!1}):N.slice(4,i+1).forEach(function(O){O.virtual=!1}),r.prevDist=[s,o],m7(t,e,c,f,N)},dragControlEnd:function(t,e){var r=t.state;r.borderRadiusState="";var n=e.datas,i=e.isDouble;if(!n.isRound)return!1;var a=n.isControl,s=n.controlIndex,o=n.isLine,c=n.lineIndex,f=n.controlPoses,d=f.filter(function(M){var F=M.virtual;return F}).length,m=t.props.roundClickable,b=m===void 0?!0:m;if(i&&b){if(a&&(b===!0||b==="control"))o2e(f,s);else if(o&&(b===!0||b==="line")){var x=Kt(JZ(t,e),2),E=x[0],T=x[1];i2e(f,c,E,T)}d!==f.filter(function(M){var F=M.virtual;return F}).length&&m7(t,e,[0,0],[0,0],f)}var A=gf(t,e,{});return Wn(t,"onRoundEnd",A),r.borderRadiusState="",A},dragGroupControlStart:function(t,e){var r=this.dragControlStart(t,e);if(!r)return!1;var n=t.moveables,i=t.props.targets,a=Th(t,"roundable",e),s=Wt({targets:t.props.targets,events:a.map(function(o,c){return Wt(Wt({},o),{target:i[c],moveable:n[c],currentTarget:n[c]})})},r);return Wn(t,"onRoundGroupStart",s),r},dragGroupControl:function(t,e){var r=this.dragControl(t,e);if(!r)return!1;var n=t.moveables,i=t.props.targets,a=Th(t,"roundable",e),s=Wt({targets:t.props.targets,events:a.map(function(o,c){return Wt(Wt(Wt({},o),{target:i[c],moveable:n[c],currentTarget:n[c]}),vc({borderRadius:r.borderRadius},o))})},r);return Wn(t,"onRoundGroup",s),s},dragGroupControlEnd:function(t,e){var r=t.moveables,n=t.props.targets,i=Th(t,"roundable",e);f3(t,"onRound",function(o){var c=Wt({targets:t.props.targets,events:i.map(function(f,d){return Wt(Wt(Wt({},f),{target:n[d],moveable:r[d],currentTarget:r[d]}),vc({borderRadius:o.borderRadius},f))})},o);Wn(t,"onRoundGroup",c)});var a=this.dragControlEnd(t,e);if(!a)return!1;var s=Wt({targets:t.props.targets,events:i.map(function(o,c){var f;return Wt(Wt({},o),{target:n[c],moveable:r[c],currentTarget:r[c],lastEvent:(f=o.datas)===null||f===void 0?void 0:f.lastEvent})})},a);return Wn(t,"onRoundGroupEnd",s),s},unset:function(t){t.state.borderRadiusState=""}};function l2e(t,e){var r=e?4:3,n=Jo(r),i="matrix".concat(e?"3d":"","(").concat(n.join(","),")");return t===i||t==="matrix(1,0,0,1,0,0)"}var YK={isPinch:!0,name:"beforeRenderable",props:[],events:["beforeRenderStart","beforeRender","beforeRenderEnd","beforeRenderGroupStart","beforeRenderGroup","beforeRenderGroupEnd"],dragRelation:"weak",setTransform:function(t,e){var r=t.state,n=r.is3d,i=r.targetMatrix,a=r.inlineTransform,s=n?"matrix3d(".concat(i.join(","),")"):"matrix(".concat(jZ(i,!0),")"),o=!a||a==="none"?s:a;e.datas.startTransforms=l2e(o,n)?[]:Cg(o)},resetStyle:function(t){var e=t.datas;e.nextStyle={},e.nextTransforms=t.datas.startTransforms,e.nextTransformAppendedIndexes=[]},fillDragStartParams:function(t,e){return Ki(t,e,{setTransform:function(r){e.datas.startTransforms=su(r)?r:Cg(r)},isPinch:!!e.isPinch})},fillDragParams:function(t,e){return Ki(t,e,{isPinch:!!e.isPinch})},dragStart:function(t,e){this.setTransform(t,e),this.resetStyle(e),Wn(t,"onBeforeRenderStart",this.fillDragStartParams(t,e))},drag:function(t,e){e.datas.startTransforms||this.setTransform(t,e),this.resetStyle(e),Wn(t,"onBeforeRender",Ki(t,e,{isPinch:!!e.isPinch}))},dragEnd:function(t,e){e.datas.startTransforms||(this.setTransform(t,e),this.resetStyle(e)),Wn(t,"onBeforeRenderEnd",Ki(t,e,{isPinch:!!e.isPinch,isDrag:e.isDrag}))},dragGroupStart:function(t,e){var r=this;this.dragStart(t,e);var n=Th(t,"beforeRenderable",e),i=t.moveables,a=n.map(function(s,o){var c=i[o];return r.setTransform(c,s),r.resetStyle(s),r.fillDragStartParams(c,s)});Wn(t,"onBeforeRenderGroupStart",Ki(t,e,{isPinch:!!e.isPinch,targets:t.props.targets,setTransform:function(){},events:a}))},dragGroup:function(t,e){var r=this;this.drag(t,e);var n=Th(t,"beforeRenderable",e),i=t.moveables,a=n.map(function(s,o){var c=i[o];return r.resetStyle(s),r.fillDragParams(c,s)});Wn(t,"onBeforeRenderGroup",Ki(t,e,{isPinch:!!e.isPinch,targets:t.props.targets,events:a}))},dragGroupEnd:function(t,e){this.dragEnd(t,e),Wn(t,"onBeforeRenderGroupEnd",Ki(t,e,{isPinch:!!e.isPinch,isDrag:e.isDrag,targets:t.props.targets}))},dragControlStart:function(t,e){return this.dragStart(t,e)},dragControl:function(t,e){return this.drag(t,e)},dragControlEnd:function(t,e){return this.dragEnd(t,e)},dragGroupControlStart:function(t,e){return this.dragGroupStart(t,e)},dragGroupControl:function(t,e){return this.dragGroup(t,e)},dragGroupControlEnd:function(t,e){return this.dragGroupEnd(t,e)}},ZK={name:"renderable",props:[],events:["renderStart","render","renderEnd","renderGroupStart","renderGroup","renderGroupEnd"],dragRelation:"weak",dragStart:function(t,e){Wn(t,"onRenderStart",Ki(t,e,{isPinch:!!e.isPinch}))},drag:function(t,e){Wn(t,"onRender",this.fillDragParams(t,e))},dragAfter:function(t,e){return this.drag(t,e)},dragEnd:function(t,e){Wn(t,"onRenderEnd",this.fillDragEndParams(t,e))},dragGroupStart:function(t,e){Wn(t,"onRenderGroupStart",Ki(t,e,{isPinch:!!e.isPinch,targets:t.props.targets}))},dragGroup:function(t,e){var r=this,n=Th(t,"beforeRenderable",e),i=t.moveables,a=n.map(function(s,o){var c=i[o];return r.fillDragParams(c,s)});Wn(t,"onRenderGroup",Ki(t,e,Wt(Wt({isPinch:!!e.isPinch,targets:t.props.targets,transform:gw(e),transformObject:{}},vc(mw(e))),{events:a})))},dragGroupEnd:function(t,e){var r=this,n=Th(t,"beforeRenderable",e),i=t.moveables,a=n.map(function(s,o){var c=i[o];return r.fillDragEndParams(c,s)});Wn(t,"onRenderGroupEnd",Ki(t,e,Wt({isPinch:!!e.isPinch,isDrag:e.isDrag,targets:t.props.targets,events:a,transformObject:{},transform:gw(e)},vc(mw(e)))))},dragControlStart:function(t,e){return this.dragStart(t,e)},dragControl:function(t,e){return this.drag(t,e)},dragControlAfter:function(t,e){return this.dragAfter(t,e)},dragControlEnd:function(t,e){return this.dragEnd(t,e)},dragGroupControlStart:function(t,e){return this.dragGroupStart(t,e)},dragGroupControl:function(t,e){return this.dragGroup(t,e)},dragGroupControlEnd:function(t,e){return this.dragGroupEnd(t,e)},fillDragParams:function(t,e){var r={};return q0(iE(e)||[]).forEach(function(n){r[n.name]=n.functionValue}),Ki(t,e,Wt({isPinch:!!e.isPinch,transformObject:r,transform:gw(e)},vc(mw(e))))},fillDragEndParams:function(t,e){var r={};return q0(iE(e)||[]).forEach(function(n){r[n.name]=n.functionValue}),Ki(t,e,Wt({isPinch:!!e.isPinch,isDrag:e.isDrag,transformObject:r,transform:gw(e)},vc(mw(e))))}};function vb(t,e,r,n,i,a,s){a.clientDistX=a.distX,a.clientDistY=a.distY;var o=i==="Start",c=i==="End",f=i==="After",d=t.state.target,m=a.isRequest,b=n.indexOf("Control")>-1;if(!d||o&&b&&!m&&t.areaElement===a.inputEvent.target)return!1;var x=yn([],Kt(e),!1);if(m){var E=a.requestAble;x.some(function(G){return G.name===E})||x.push.apply(x,yn([],Kt(t.props.ables.filter(function(G){return G.name===E})),!1))}if(!x.length||x.every(function(G){return G.dragRelation}))return!1;var T=a.inputEvent,A;c&&T&&(A=document.elementFromPoint(a.clientX,a.clientY)||T.target);var M=!1,F=function(){var G;M=!0,(G=a.stop)===null||G===void 0||G.call(a)},N=o&&(!t.targetGesto||!t.controlGesto||!t.targetGesto.isFlag()||!t.controlGesto.isFlag());N&&t.updateRect(i,!0,!1);var O=a.datas,U=b?"controlGesto":"targetGesto",j=t[U],H=function(G,ae,se){if(!(ae in G)||j!==t[U])return!1;var fe=G.name,_e=O[fe]||(O[fe]={});if(o&&(_e.isEventStart=!se||!G[se]||G[se](t,a)),!_e.isEventStart)return!1;var Le=G[ae](t,Wt(Wt({},a),{stop:F,datas:_e,originalDatas:O,inputTarget:A}));return t._emitter.off(),o&&Le===!1&&(_e.isEventStart=!1),Le};N&&x.forEach(function(G){G.unset&&G.unset(t)}),H(YK,"drag".concat(n).concat(i));var W=0,X=0;r.forEach(function(G){if(M)return!1;var ae="".concat(G).concat(n).concat(i),se="".concat(G).concat(n,"Condition");i===""&&!m&&Rxe(t.state,a);var fe=x.filter(function(ye){return ye[ae]});fe=fe.filter(function(ye,Te){return ye.name&&fe.indexOf(ye)===Te});var _e=fe.filter(function(ye){return H(ye,ae,se)}),Le=_e.length;M&&++W,Le&&++X,!M&&o&&fe.length&&!Le&&(W+=fe.filter(function(ye){var Te=ye.name,Ie=O[Te];return Ie.isEventStart?ye.dragRelation!=="strong":!1}).length?1:0)}),(!f||X)&&H(ZK,"drag".concat(n).concat(i));var oe=j!==t[U]||W===r.length;if((c||M||oe)&&(t.state.gestos={},t.moveables&&t.moveables.forEach(function(G){G.state.gestos={}}),x.forEach(function(G){G.unset&&G.unset(t)})),o&&!oe&&!m&&X&&t.props.preventDefault&&a?.preventDefault(),t.isUnmounted||oe)return!1;if(!o&&X&&!s||c){var Q=t.props.flushSync||AK;Q(function(){t.updateRect(c?i:"",!0,!1),t.forceUpdate()})}return!o&&!c&&!f&&X&&!s&&vb(t,e,r,n,i+"After",a),!0}function nN(t,e){return function(r,n){var i;n===void 0&&(n=r.inputEvent.target);var a=n,s=t.areaElement,o=t._dragTarget;return!o||!e&&(!((i=t.controlGesto)===null||i===void 0)&&i.isFlag())?!1:a===o||o.contains(a)||a===s||!t.isMoveableElement(a)&&!t.controlBox.contains(a)||Bl(a,"moveable-area")||Bl(a,"moveable-padding")||Bl(a,"moveable-edgeDraggable")}}function KK(t,e,r){var n=t.controlBox,i=[],a=t.props,s=a.dragArea,o=t.state.target,c=a.dragTarget;i.push(n),(!s||c)&&i.push(e),!s&&c&&o&&e!==o&&a.dragTargetSelf&&i.push(o);var f=nN(t);return QK(t,i,"targetAbles",r,{dragStart:f,pinchStart:f})}function JK(t,e){var r=t.controlBox,n=[];n.push(r);var i=nN(t,!0),a=function(s,o){if(o===void 0&&(o=s.inputEvent.target),o===r)return!0;var c=i(s,o);return!c};return QK(t,n,"controlAbles",e,{dragStart:a,pinchStart:a})}function QK(t,e,r,n,i){i===void 0&&(i={});var a=r==="targetAbles",s=t.props,o=s.pinchOutside,c=s.pinchThreshold,f=s.preventClickEventOnDrag,d=s.preventClickDefault,m=s.checkInput,b=s.dragFocusedInput,x=s.preventDefault,E=x===void 0?!0:x,T=s.preventRightClick,A=T===void 0?!0:T,M=s.preventWheelClick,F=M===void 0?!0:M,N=s.dragContainer,O=bd(N,!0),U={preventDefault:E,preventRightClick:A,preventWheelClick:F,container:O||xg(t.getControlBoxElement()),pinchThreshold:c,pinchOutside:o,preventClickEventOnDrag:a?f:!1,preventClickEventOnDragStart:a?d:!1,preventClickEventByCondition:a?null:function(W){return t.controlBox.contains(W.target)},checkInput:a?m:!1,dragFocusedInput:b},j=new O1e(e,U),H=n==="Control";return["drag","pinch"].forEach(function(W){["Start","","End"].forEach(function(X){j.on("".concat(W).concat(X),function(oe){var Q,G=oe.eventType,ae=W==="drag"&&oe.isPinch;if(i[G]&&!i[G](oe)){oe.stop();return}if(!ae){var se=W==="drag"?[W]:["drag",W],fe=yn([],Kt(t[r]),!1),_e=vb(t,fe,se,n,X,oe);_e?(t.props.stopPropagation||X==="Start"&&H)&&((Q=oe?.inputEvent)===null||Q===void 0||Q.stopPropagation()):oe.stop()}})})}),j}var u2e=(function(){function t(e,r,n){var i=this;this.target=e,this.moveable=r,this.eventName=n,this.ables=[],this._onEvent=function(a){var s=i.eventName,o=i.moveable;o.state.disableNativeEvent||i.ables.forEach(function(c){c[s](o,{inputEvent:a})})},e.addEventListener(n.toLowerCase(),this._onEvent)}return t.prototype.setAbles=function(e){this.ables=e},t.prototype.destroy=function(){this.target.removeEventListener(this.eventName.toLowerCase(),this._onEvent),this.target=null,this.moveable=null},t})();function c2e(t,e,r,n){var i;r===void 0&&(r=e);var a=iK(t,e),s=a.matrixes,o=a.is3d,c=a.targetMatrix,f=a.transformOrigin,d=a.targetOrigin,m=a.offsetContainer,b=a.hasFixed,x=a.zoom,E=Ebe(m,r),T=E.matrixes,A=E.is3d,M=E.offsetContainer,F=E.zoom,N=n,O=4,U=t.tagName.toLowerCase()!=="svg"&&"ownerSVGElement"in t,j=c,H=Jo(O),W=Jo(O),X=Jo(O),oe=Jo(O),Q=s.length,G=T.map(function(Te){return Wt(Wt({},Te),{matrix:Te.matrix?yn([],Kt(Te.matrix),!1):void 0})}).reverse();s.reverse(),!o&&N&&(j=Ih(j,3,4),TR(s)),!A&&N&&TR(G),G.forEach(function(Te){W=wo(W,Te.matrix,O)});var ae=r||zg(t),se=((i=G[0])===null||i===void 0?void 0:i.target)||Xb(ae,ae,!0).offsetParent,fe=G.slice(1).reduce(function(Te,Ie){return wo(Te,Ie.matrix,O)},Jo(O));s.forEach(function(Te,Ie){if(Q-2===Ie&&(X=H.slice()),Q-1===Ie&&(oe=H.slice()),!Te.matrix){var Me=s[Ie+1],de=Axe(Te,Me,se,O,wo(fe,H,O));Te.matrix=ey(de,O)}H=wo(H,Te.matrix,O)});var _e=!U&&o;j||(j=Jo(_e?4:3));var Le=c3(U&&j.length===16?Ih(j,4,3):j,_e),ye=W;return W=BZ(W,O,O),{hasZoom:x!==1||F!==1,hasFixed:b,matrixes:s,rootMatrix:W,originalRootMatrix:ye,beforeMatrix:X,offsetMatrix:oe,allMatrix:H,targetMatrix:j,targetTransform:Le,inlineTransform:t.style.transform,transformOrigin:f,targetOrigin:d,is3d:N,offsetContainer:m,offsetRootContainer:M}}function f2e(t,e,r,n){r===void 0&&(r=e);var i=0,a=0,s=0,o={},c=RK(t);if(t&&(i=c.offsetWidth,a=c.offsetHeight),t){var f=c2e(t,e,r,n),d=P0(f.allMatrix,f.transformOrigin,i,a);o=Wt(Wt({},f),d);var m=P0(f.allMatrix,[50,50],100,100);s=MK([m.pos1,m.pos2],m.direction)}var b=4;return Wt(Wt(Wt({hasZoom:!1,width:i,height:a,rotation:s},c),{originalRootMatrix:Jo(b),rootMatrix:Jo(b),beforeMatrix:Jo(b),offsetMatrix:Jo(b),allMatrix:Jo(b),targetMatrix:Jo(b),targetTransform:"",inlineTransform:"",transformOrigin:[0,0],targetOrigin:[0,0],is3d:!0,left:0,top:0,right:0,bottom:0,origin:[0,0],pos1:[0,0],pos2:[0,0],pos3:[0,0],pos4:[0,0],direction:1,hasFixed:!1,offsetContainer:null,offsetRootContainer:null,matrixes:[]}),o)}function PR(t,e,r,n,i,a){a===void 0&&(a=[]);var s=1,o=[0,0],c=vw(),f=vw(),d=vw(),m=vw(),b=[0,0],x={},E=f2e(e,r,i,!0);if(e){var T=Fc(e);a.forEach(function(G){x[G]=T(G)});var A=E.is3d?4:3,M=P0(E.offsetMatrix,Ma(E.transformOrigin,zZ(E.targetMatrix,A)),E.width,E.height);s=M.direction,o=Ma(M.origin,[M.left-E.left,M.top-E.top]),m=yb(E.offsetRootContainer);var F=Xb(n,n,!0).offsetParent||E.offsetRootContainer;if(E.hasZoom){var N=P0(wo(E.originalRootMatrix,E.allMatrix),E.transformOrigin,E.width,E.height),O=P0(E.originalRootMatrix,lE(Fc(F)("transformOrigin")).map(function(G){return parseFloat(G)}),F.offsetWidth,F.offsetHeight);if(c=QA(N,m),d=QA(O,m,F,!0),t){var U=N.left,j=N.top;f=QA({left:U,top:j,bottom:j,right:j},m)}}else{c=yb(e),d=Sbe(F),t&&(f=yb(t));var H=d.left,W=d.top,X=d.clientLeft,oe=d.clientTop,Q=[c.left-H,c.top-W];b=_i(X0(E.rootMatrix,Q,4),[X+E.left,oe+E.top])}}return Wt({targetClientRect:c,containerClientRect:d,moveableClientRect:f,rootContainerClientRect:m,beforeDirection:s,beforeOrigin:o,originalBeforeOrigin:o,target:e,style:x,offsetDelta:b},E)}function v7(t){var e=t.pos1,r=t.pos2,n=t.pos3,i=t.pos4;if(!e||!r||!n||!i)return null;var a=ty([e,r,n,i]),s=[a.minX,a.minY],o=_i(t.origin,s);return e=_i(e,s),r=_i(r,s),n=_i(n,s),i=_i(i,s),Wt(Wt({},t),{left:t.left,top:t.top,posDelta:s,pos1:e,pos2:r,pos3:n,pos4:i,origin:o,beforeOrigin:o,isPersisted:!0})}var Y0=(function(t){jx(e,t);function e(){var r=t!==null&&t.apply(this,arguments)||this;return r.state=Wt({container:null,gestos:{},renderLines:[[[0,0],[0,0]],[[0,0],[0,0]],[[0,0],[0,0]],[[0,0],[0,0]]],renderPoses:[[0,0],[0,0],[0,0],[0,0]],disableNativeEvent:!1,posDelta:[0,0]},PR(null)),r.renderState={},r.enabledAbles=[],r.targetAbles=[],r.controlAbles=[],r.rotation=0,r.scale=[1,1],r.isMoveableMounted=!1,r.isUnmounted=!1,r.events={mouseEnter:null,mouseLeave:null},r._emitter=new NO,r._prevOriginalDragTarget=null,r._originalDragTarget=null,r._prevDragTarget=null,r._dragTarget=null,r._prevPropTarget=null,r._propTarget=null,r._prevDragArea=!1,r._isPropTargetChanged=!1,r._hasFirstTarget=!1,r._reiszeObserver=null,r._observerId=0,r._mutationObserver=null,r._rootContainer=null,r._viewContainer=null,r._viewClassNames=[],r._store={},r.checkUpdateRect=function(){if(!r.isDragging()){var n=r.props.parentMoveable;if(n){n.checkUpdateRect();return}X_e(r._observerId),r._observerId=DZ(function(){r.isDragging()||r.updateRect()})}},r._onPreventClick=function(n){n.stopPropagation(),n.preventDefault()},r}return e.prototype.render=function(){var r=this.props,n=this.getState(),i=r.parentPosition,a=r.className,s=r.target,o=r.zoom,c=r.cspNonce,f=r.translateZ,d=r.cssStyled,m=r.groupable,b=r.linePadding,x=r.controlPadding;this._checkUpdateRootContainer(),this.checkUpdate(),this.updateRenderPoses();var E=Kt(i||[0,0],2),T=E[0],A=E[1],M=n.left,F=n.top,N=n.target,O=n.direction,U=n.hasFixed,j=n.offsetDelta,H=r.targets,W=this.isDragging(),X={};this.getEnabledAbles().forEach(function(fe){X["data-able-".concat(fe.name.toLowerCase())]=!0});var oe=this._getAbleClassName(),Q=H&&H.length&&(N||m)||s||!this._hasFirstTarget&&this.state.isPersisted,G=this.controlBox||this.props.firstRenderState||this.props.persistData,ae=[M-T,F-A];!m&&r.useAccuratePosition&&(ae[0]+=j[0],ae[1]+=j[1]);var se={position:U?"fixed":"absolute",display:Q?"block":"none",visibility:G?"visible":"hidden",transform:"translate3d(".concat(ae[0],"px, ").concat(ae[1],"px, ").concat(f,")"),"--zoom":o,"--zoompx":"".concat(o,"px")};return b&&(se["--moveable-line-padding"]=b),x&&(se["--moveable-control-padding"]=x),te.createElement(d,Wt({cspNonce:c,ref:zm(this,"controlBox"),className:"".concat(yi("control-box",O===-1?"reverse":"",W?"dragging":"")," ").concat(oe," ").concat(a)},X,{onClick:this._onPreventClick,style:se}),this.renderAbles(),this._renderLines())},e.prototype.componentDidMount=function(){this.isMoveableMounted=!0,this.isUnmounted=!1;var r=this.props,n=r.parentMoveable,i=r.container;this._checkUpdateRootContainer(),this._checkUpdateViewContainer(),this._updateTargets(),this._updateNativeEvents(),this._updateEvents(),this.updateCheckInput(),this._updateObserver(this.props),!i&&!n&&!this.state.isPersisted&&(this.updateRect("",!1,!1),this.forceUpdate())},e.prototype.componentDidUpdate=function(r){this._checkUpdateRootContainer(),this._checkUpdateViewContainer(),this._updateNativeEvents(),this._updateTargets(),this._updateEvents(),this.updateCheckInput(),this._updateObserver(r)},e.prototype.componentWillUnmount=function(){var r,n;this.isMoveableMounted=!1,this.isUnmounted=!0,this._emitter.off(),(r=this._reiszeObserver)===null||r===void 0||r.disconnect(),(n=this._mutationObserver)===null||n===void 0||n.disconnect();var i=this._viewContainer;i&&this._changeAbleViewClassNames([]),h0(this,!1),h0(this,!0);var a=this.events;for(var s in a){var o=a[s];o&&o.destroy()}},e.prototype.getTargets=function(){var r=this.props.target;return r?[r]:[]},e.prototype.getAble=function(r){var n=this.props.ables||[];return pf(n,function(i){return i.name===r})},e.prototype.getContainer=function(){var r=this.props,n=r.parentMoveable,i=r.wrapperMoveable,a=r.container;return a||i&&i.getContainer()||n&&n.getContainer()||this.controlBox.parentElement},e.prototype.getControlBoxElement=function(){return this.controlBox},e.prototype.getDragElement=function(){return this._dragTarget},e.prototype.isMoveableElement=function(r){var n;return r&&(((n=r.getAttribute)===null||n===void 0?void 0:n.call(r,"class"))||"").indexOf(BO)>-1},e.prototype.dragStart=function(r,n){n===void 0&&(n=r.target);var i=this.targetGesto,a=this.controlGesto;return i&&nN(this)({inputEvent:r},n)?i.isFlag()||i.triggerDragStart(r):a&&this.isMoveableElement(n)&&(a.isFlag()||a.triggerDragStart(r)),this},e.prototype.hitTest=function(r){var n=this.state,i=n.target,a=n.pos1,s=n.pos2,o=n.pos3,c=n.pos4,f=n.targetClientRect;if(!i)return 0;var d;if(RO(r)){var m=r.getBoundingClientRect();d={left:m.left,top:m.top,width:m.width,height:m.height}}else d=Wt({width:0,height:0},r);var b=d.left,x=d.top,E=d.width,T=d.height,A=U9([a,s,c,o],f),M=I1e(A,[[b,x],[b+E,x],[b+E,x+T],[b,x+T]]),F=$Z(A);return!M||!F?0:Math.min(100,M/F*100)},e.prototype.isInside=function(r,n){var i=this.state,a=i.target,s=i.pos1,o=i.pos2,c=i.pos3,f=i.pos4,d=i.targetClientRect;return a?hR([r,n],U9([s,o,f,c],d)):!1},e.prototype.updateRect=function(r,n,i){i===void 0&&(i=!0);var a=this.props,s=!a.parentPosition&&!a.wrapperMoveable;s&&G0(!0);var o=a.parentMoveable,c=this.state,f=c.target||a.target,d=this.getContainer(),m=o?o._rootContainer:this._rootContainer,b=PR(this.controlBox,f,d,d,m||d,this._getRequestStyles());if(!f&&this._hasFirstTarget&&a.persistData){var x=v7(a.persistData);for(var E in x)b[E]=x[E]}s&&G0(),this.updateState(b,o?!1:i)},e.prototype.isDragging=function(r){var n,i,a=this.targetGesto,s=this.controlGesto;if(a?.isFlag()){if(!r)return!0;var o=a.getEventData();return!!(!((n=o[r])===null||n===void 0)&&n.isEventStart)}if(s?.isFlag()){if(!r)return!0;var o=s.getEventData();return!!(!((i=o[r])===null||i===void 0)&&i.isEventStart)}return!1},e.prototype.updateTarget=function(r){this.updateRect(r,!0)},e.prototype.getRect=function(){var r=this.state,n=Yf(this.state),i=Kt(n,4),a=i[0],s=i[1],o=i[2],c=i[3],f=Uf(n),d=r.width,m=r.height,b=f.width,x=f.height,E=f.left,T=f.top,A=[r.left,r.top],M=Ma(A,r.origin),F=Ma(A,r.beforeOrigin),N=r.transformOrigin;return{width:b,height:x,left:E,top:T,pos1:a,pos2:s,pos3:o,pos4:c,offsetWidth:d,offsetHeight:m,beforeOrigin:F,origin:M,transformOrigin:N,rotation:this.getRotation()}},e.prototype.getManager=function(){return this},e.prototype.stopDrag=function(r){if(!r||r==="target"){var n=this.targetGesto;n?.isIdle()===!1&&CR(this,!1),n?.stop()}if(!r||r==="control"){var n=this.controlGesto;n?.isIdle()===!1&&CR(this,!0),n?.stop()}},e.prototype.getRotation=function(){var r=this.state,n=r.pos1,i=r.pos2,a=r.direction;return Oxe(n,i,a)},e.prototype.request=function(r,n,i){n===void 0&&(n={});var a=this,s=a.props,o=s.parentMoveable||s.wrapperMoveable||a,c=o.props.ables,f=s.groupable,d=pf(c,function(M){return M.name===r});if(this.isDragging()||!d||!d.request)return{request:function(){return this},requestEnd:function(){return this}};var m=d.request(a),b=i||n.isInstant,x=m.isControl?"controlAbles":"targetAbles",E="".concat(f?"Group":"").concat(m.isControl?"Control":""),T=yn([],Kt(o[x]),!1),A={request:function(M){return vb(a,T,["drag"],E,"",Wt(Wt({},m.request(M)),{requestAble:r,isRequest:!0}),b),A},requestEnd:function(){return vb(a,T,["drag"],E,"End",Wt(Wt({},m.requestEnd()),{requestAble:r,isRequest:!0}),b),A}};return vb(a,T,["drag"],E,"Start",Wt(Wt({},m.requestStart(n)),{requestAble:r,isRequest:!0}),b),b?A.request(n).requestEnd():A},e.prototype.getMoveables=function(){return[this]},e.prototype.destroy=function(){this.componentWillUnmount()},e.prototype.updateRenderPoses=function(){var r=this.getState(),n=this.props,i=n.padding,a=r.originalBeforeOrigin,s=r.transformOrigin,o=r.allMatrix,c=r.is3d,f=r.pos1,d=r.pos2,m=r.pos3,b=r.pos4,x=r.left,E=r.top,T=r.isPersisted,A=n.zoom||1;if(!i&&A<=1){r.renderPoses=[f,d,m,b],r.renderLines=[[f,d],[d,b],[b,m],[m,f]];return}var M=VK(i||{}),F=M.left,N=M.top,O=M.bottom,U=M.right,j=c?4:3,H=[];T?H=s:this.controlBox&&n.groupable?H=a:H=Ma(a,[x,E]);var W=rE(j,ey(H.map(function(se){return-se}),j),o,ey(s,j)),X=kf(W,f,[-F,-N],j),oe=kf(W,d,[U,-N],j),Q=kf(W,m,[-F,O],j),G=kf(W,b,[U,O],j);r.renderPoses=[X,oe,Q,G],r.renderLines=[[X,oe],[oe,G],[G,Q],[Q,X]];{var ae=A/2;r.renderLines=[[kf(W,f,[-F-ae,-N],j),kf(W,d,[U+ae,-N],j)],[kf(W,d,[U,-N-ae],j),kf(W,b,[U,O+ae],j)],[kf(W,b,[U+ae,O],j),kf(W,m,[-F-ae,O],j)],[kf(W,m,[-F,O+ae],j),kf(W,f,[-F,-N-ae],j)]]}},e.prototype.checkUpdate=function(){this._isPropTargetChanged=!1;var r=this.props,n=r.target,i=r.container,a=r.parentMoveable,s=this.state,o=s.target,c=s.container;if(!(!o&&!n)){this.updateAbles();var f=!AR(o,n),d=f||!AR(c,i);if(d){var m=i||this.controlBox;m&&this.unsetAbles(),this.updateState({target:n,container:i}),!a&&m&&this.updateRect("End",!1,!1),this._isPropTargetChanged=f}}},e.prototype.waitToChangeTarget=function(){return new Promise(function(){})},e.prototype.triggerEvent=function(r,n){var i=this.props;if(this._emitter.trigger(r,n),i.parentMoveable&&n.isRequest&&!n.isRequestChild)return i.parentMoveable.triggerEvent(r,n,!0);var a=i[r];return a&&a(n)},e.prototype.useCSS=function(r,n){var i=this.props.customStyledMap,a=r+n;return i[a]||(i[a]=GZ(r,n)),i[a]},e.prototype.getState=function(){var r,n=this.props;(n.target||!((r=n.targets)===null||r===void 0)&&r.length)&&(this._hasFirstTarget=!0);var i=this.controlBox,a=n.persistData,s=n.firstRenderState;if(s&&!i)return s;if(!this._hasFirstTarget&&a){var o=v7(a);if(o)return this.updateState(o,!1),this.state}return this.state.isPersisted=!1,this.state},e.prototype.updateSelectors=function(){},e.prototype.unsetAbles=function(){var r=this;this.targetAbles.forEach(function(n){n.unset&&n.unset(r)})},e.prototype.updateAbles=function(r,n){r===void 0&&(r=this.props.ables),n===void 0&&(n="");var i=this.props,a=i.triggerAblesSimultaneously,s=this.getEnabledAbles(r),o="drag".concat(n,"Start"),c="pinch".concat(n,"Start"),f="drag".concat(n,"ControlStart"),d=_w(s,[o,c],a),m=_w(s,[f],a);this.enabledAbles=s,this.targetAbles=d,this.controlAbles=m},e.prototype.updateState=function(r,n){if(n){if(this.isUnmounted)return;this.setState(r)}else{var i=this.state;for(var a in r)i[a]=r[a]}},e.prototype.getEnabledAbles=function(r){r===void 0&&(r=this.props.ables);var n=this.props;return r.filter(function(i){return i&&(i.always&&n[i.name]!==!1||n[i.name])})},e.prototype.renderAbles=function(){var r=this,n=this.props,i=n.triggerAblesSimultaneously,a={createElement:te.createElement};return this.renderState={},kxe(BK(_w(this.getEnabledAbles(),["render"],i).map(function(s){var o=s.render;return o(r,a)||[]})).filter(function(s){return s}),function(s){var o=s.key;return o}).map(function(s){return s[0]})},e.prototype.updateCheckInput=function(){this.targetGesto&&(this.targetGesto.options.checkInput=this.props.checkInput)},e.prototype._getRequestStyles=function(){var r=this.getEnabledAbles().reduce(function(n,i){var a,s,o=(s=(a=i.requestStyle)===null||a===void 0?void 0:a.call(i))!==null&&s!==void 0?s:[];return yn(yn([],Kt(n),!1),Kt(o),!1)},yn([],Kt(this.props.requestStyles||[]),!1));return r},e.prototype._updateObserver=function(r){this._updateResizeObserver(r),this._updateMutationObserver(r)},e.prototype._updateEvents=function(){var r=this.targetAbles.length,n=this.controlAbles.length,i=this._dragTarget,a=!r&&this.targetGesto||this._isTargetChanged(!0);a&&(h0(this,!1),this.updateState({gestos:{}})),n||h0(this,!0),i&&r&&!this.targetGesto&&(this.targetGesto=KK(this,i,"")),!this.controlGesto&&n&&(this.controlGesto=JK(this,"Control"))},e.prototype._updateTargets=function(){var r=this.props;this._prevPropTarget=this._propTarget,this._prevDragTarget=this._dragTarget,this._prevOriginalDragTarget=this._originalDragTarget,this._prevDragArea=r.dragArea,this._propTarget=r.target,this._originalDragTarget=r.dragTarget||r.target,this._dragTarget=bd(this._originalDragTarget,!0)},e.prototype._renderLines=function(){var r=this.props,n=r,i=n.zoom,a=n.hideDefaultLines,s=n.hideChildMoveableDefaultLines,o=n.parentMoveable;if(a||o&&s)return[];var c=this.getState(),f={createElement:te.createElement};return c.renderLines.map(function(d,m){return Wb(f,"",d[0],d[1],i,"render-line-".concat(m))})},e.prototype._isTargetChanged=function(r){var n=this.props,i=n.dragTarget||n.target,a=this._prevOriginalDragTarget,s=this._prevDragArea,o=n.dragArea,c=!o&&a!==i,f=(r||o)&&s!==o;return c||f||this._prevPropTarget!=this._propTarget},e.prototype._updateNativeEvents=function(){var r=this,n=this.props,i=n.dragArea?this.areaElement:this.state.target,a=this.events,s=g_(a);if(this._isTargetChanged())for(var o in a){var c=a[o];c&&c.destroy(),a[o]=null}if(i){var f=this.enabledAbles;s.forEach(function(d){var m=_w(f,[d]),b=m.length>0,x=a[d];if(!b){x&&(x.destroy(),a[d]=null);return}x||(x=new u2e(i,r,d),a[d]=x),x.setAbles(m)})}},e.prototype._checkUpdateRootContainer=function(){var r=this.props.rootContainer;!this._rootContainer&&r&&(this._rootContainer=bd(r,!0))},e.prototype._checkUpdateViewContainer=function(){var r=this.props.viewContainer;!this._viewContainer&&r&&(this._viewContainer=bd(r,!0));var n=this._viewContainer;n&&this._changeAbleViewClassNames(yn(yn([],Kt(this._getAbleViewClassNames()),!1),[this.isDragging()?Uxe:""],!1))},e.prototype._changeAbleViewClassNames=function(r){var n=this._viewContainer,i=FK(r.filter(Boolean),function(f){return f}).map(function(f){var d=Kt(f,1),m=d[0];return m}),a=this._viewClassNames,s=OO(a,i),o=s.removed,c=s.added;o.forEach(function(f){LZ(n,a[f])}),c.forEach(function(f){NZ(n,i[f])}),this._viewClassNames=i},e.prototype._getAbleViewClassNames=function(){var r=this;return(this.getEnabledAbles().map(function(n){var i;return((i=n.viewClassName)===null||i===void 0?void 0:i.call(n,r))||""}).join(" ")+" ".concat(this._getAbleClassName("-view"))).split(/\s+/g)},e.prototype._getAbleClassName=function(r){var n=this;r===void 0&&(r="");var i=this.getEnabledAbles(),a=this.targetGesto,s=this.controlGesto,o=a?.isFlag()?a.getEventData():{},c=s?.isFlag()?s.getEventData():{};return i.map(function(f){var d,m,b,x=f.name,E=((d=f.className)===null||d===void 0?void 0:d.call(f,n))||"";return(!((m=o[x])===null||m===void 0)&&m.isEventStart||!((b=c[x])===null||b===void 0)&&b.isEventStart)&&(E+=" ".concat(yi("".concat(x).concat(r,"-dragging")))),E.trim()}).filter(Boolean).join(" ")},e.prototype._updateResizeObserver=function(r){var n,i=this.props,a=i.target,s=xg(this.getControlBoxElement());if(!s.ResizeObserver||!a||!i.useResizeObserver){(n=this._reiszeObserver)===null||n===void 0||n.disconnect();return}if(!(r.target===a&&this._reiszeObserver)){var o=new s.ResizeObserver(this.checkUpdateRect);o.observe(a,{box:"border-box"}),this._reiszeObserver=o}},e.prototype._updateMutationObserver=function(r){var n=this,i,a=this.props,s=a.target,o=xg(this.getControlBoxElement());if(!o.MutationObserver||!s||!a.useMutationObserver){(i=this._mutationObserver)===null||i===void 0||i.disconnect();return}if(!(r.target===s&&this._mutationObserver)){var c=new o.MutationObserver(function(f){var d,m;try{for(var b=H1e(f),x=b.next();!x.done;x=b.next()){var E=x.value;E.type==="attributes"&&E.attributeName==="style"&&n.checkUpdateRect()}}catch(T){d={error:T}}finally{try{x&&!x.done&&(m=b.return)&&m.call(b)}finally{if(d)throw d.error}}});c.observe(s,{attributes:!0}),this._mutationObserver=c}},e.defaultProps={dragTargetSelf:!1,target:null,dragTarget:null,container:null,rootContainer:null,origin:!0,parentMoveable:null,wrapperMoveable:null,isWrapperMounted:!1,parentPosition:null,warpSelf:!1,svgOrigin:"",dragContainer:null,useResizeObserver:!1,useMutationObserver:!1,preventDefault:!0,preventRightClick:!0,preventWheelClick:!0,linePadding:0,controlPadding:0,ables:[],pinchThreshold:20,dragArea:!1,passDragArea:!1,transformOrigin:"",className:"",zoom:1,triggerAblesSimultaneously:!1,padding:{},pinchOutside:!0,checkInput:!1,dragFocusedInput:!1,groupable:!1,hideDefaultLines:!1,cspNonce:"",translateZ:0,cssStyled:null,customStyledMap:{},props:{},stopPropagation:!1,preventClickDefault:!1,preventClickEventOnDrag:!0,flushSync:AK,firstRenderState:null,persistData:null,viewContainer:null,requestStyles:[],useAccuratePosition:!1},e})(te.PureComponent),iN={name:"groupable",props:["defaultGroupRotate","useDefaultGroupRotate","defaultGroupOrigin","groupable","groupableProps","targetGroups","hideChildMoveableDefaultLines"],events:[],render:function(t,e){var r,n=t.props,i=n.targets||[],a=t.getState(),s=a.left,o=a.top,c=a.isPersisted,f=n.zoom||1,d=t.renderGroupRects,m=((r=n.persistData)===null||r===void 0?void 0:r.children)||[];c?i=m.map(function(){return null}):m=[];var b=d0(t,"parentPosition",[s,o],function(E){return E.join(",")}),x=d0(t,"requestStyles",t.getRequestChildStyles(),function(E){return E.join(",")});return t.moveables=t.moveables.slice(0,i.length),yn(yn([],Kt(i.map(function(E,T){return e.createElement(Y0,{key:"moveable"+T,ref:PZ(t,"moveables",T),target:E,origin:!1,requestStyles:x,cssStyled:n.cssStyled,customStyledMap:n.customStyledMap,useResizeObserver:n.useResizeObserver,useMutationObserver:n.useMutationObserver,hideChildMoveableDefaultLines:n.hideChildMoveableDefaultLines,parentMoveable:t,parentPosition:[s,o],persistData:m[T],zoom:f})})),!1),Kt(BK(d.map(function(E,T){var A=E.pos1,M=E.pos2,F=E.pos3,N=E.pos4,O=[A,M,F,N];return[[0,1],[1,3],[3,2],[2,0]].map(function(U,j){var H=Kt(U,2),W=H[0],X=H[1];return Wb(e,"",_i(O[W],b),_i(O[X],b),f,"group-rect-".concat(T,"-").concat(j))})}))),!1)}},h2e=Ux("clickable",{props:["clickable"],events:["click","clickGroup"],always:!0,dragRelation:"weak",dragStart:function(){},dragControlStart:function(){},dragGroupStart:function(t,e){e.datas.inputTarget=e.inputEvent&&e.inputEvent.target},dragEnd:function(t,e){var r=t.props.target,n=e.inputEvent,i=e.inputTarget,a=t.isMoveableElement(i),s=!a&&t.controlBox.contains(i);if(!(!n||!i||e.isDrag||t.isMoveableElement(i)||s)){var o=r.contains(i);Wn(t,"onClick",Ki(t,e,{isDouble:e.isDouble,inputTarget:i,isTarget:r===i,moveableTarget:t.props.target,containsTarget:o}))}},dragGroupEnd:function(t,e){var r=e.inputEvent,n=e.inputTarget;if(!(!r||!n||e.isDrag||t.isMoveableElement(n)||e.datas.inputTarget===n)){var i=t.props.targets,a=i.indexOf(n),s=a>-1,o=!1;a===-1&&(a=Sp(i,function(c){return c.contains(n)}),o=a>-1),Wn(t,"onClickGroup",Ki(t,e,{isDouble:e.isDouble,targets:i,inputTarget:n,targetIndex:a,isTarget:s,containsTarget:o,moveableTarget:i[a]}))}},dragControlEnd:function(t,e){this.dragEnd(t,e)},dragGroupControlEnd:function(t,e){this.dragEnd(t,e)}});function vv(t){var e=t.originalDatas.draggable;return e||(t.originalDatas.draggable={},e=t.originalDatas.draggable),Wt(Wt({},t),{datas:e})}var d2e=Ux("edgeDraggable",{css:[`.edge.edgeDraggable.line {
cursor: move;
}`],render:function(t,e){var r=t.props,n=r.edgeDraggable;return n?sK(e,"edgeDraggable",n,t.getState().renderPoses,r.zoom):[]},dragCondition:function(t,e){var r,n=t.props,i=(r=e.inputEvent)===null||r===void 0?void 0:r.target;return!n.edgeDraggable||!i?!1:!n.draggable&&Bl(i,yi("direction"))&&Bl(i,yi("edge"))&&Bl(i,yi("edgeDraggable"))},dragStart:function(t,e){return gc.dragStart(t,vv(e))},drag:function(t,e){return gc.drag(t,vv(e))},dragEnd:function(t,e){return gc.dragEnd(t,vv(e))},dragGroupCondition:function(t,e){var r,n=t.props,i=(r=e.inputEvent)===null||r===void 0?void 0:r.target;return!n.edgeDraggable||!i?!1:!n.draggable&&Bl(i,yi("direction"))&&Bl(i,yi("line"))},dragGroupStart:function(t,e){return gc.dragGroupStart(t,vv(e))},dragGroup:function(t,e){return gc.dragGroup(t,vv(e))},dragGroupEnd:function(t,e){return gc.dragGroupEnd(t,vv(e))},unset:function(t){return gc.unset(t)}}),eJ={name:"individualGroupable",props:["individualGroupable","individualGroupableProps"],events:[]},p2e=[YK,HK,yxe,Lxe,gc,d2e,wR,Fxe,zxe,Qbe,qxe,Hxe,Vxe,n2e,r2e,s2e,iN,eJ,h2e,qK,ZK];function _7(t,e){var r=Kt(t,3),n=r[0],i=r[1],a=r[2];return(n*e[0]+i*e[1]+a)/Math.sqrt(n*n+i*i)}function ww(t,e){var r=Kt(t,2),n=r[0],i=r[1];return-n*e[0]-i*e[1]}function b7(t,e){return Math.max.apply(Math,yn([],Kt(t.map(function(r){var n=Kt(r,4),i=n[0],a=n[1],s=n[2],o=n[3];return Math.max(i[e],a[e],s[e],o[e])})),!1))}function x7(t,e){return Math.min.apply(Math,yn([],Kt(t.map(function(r){var n=Kt(r,4),i=n[0],a=n[1],s=n[2],o=n[3];return Math.min(i[e],a[e],s[e],o[e])})),!1))}function g2e(t,e){var r,n,i,a=[0,0],s=[0,0],o=[0,0],c=[0,0],f=0,d=0;if(!t.length)return{pos1:a,pos2:s,pos3:o,pos4:c,minX:0,minY:0,maxX:0,maxY:0,width:f,height:d,rotation:e};var m=Fi(e,xc);if(m%90){var b=m/180*Math.PI,x=Math.tan(b),E=-1/x,T=[vR,q9],A=[[0,0],[0,0]],M=[vR,q9],F=[[0,0],[0,0]];t.forEach(function(Se){Se.forEach(function(we){var De=_7([-x,1,0],we),Fe=_7([-E,1,0],we);T[0]>De&&(A[0]=we,T[0]=De),T[1]<De&&(A[1]=we,T[1]=De),M[0]>Fe&&(F[0]=we,M[0]=Fe),M[1]<Fe&&(F[1]=we,M[1]=Fe)})});var N=Kt(A,2),O=N[0],U=N[1],j=Kt(F,2),H=j[0],W=j[1],X=[-x,1,ww([-x,1],O)],oe=[-x,1,ww([-x,1],U)],Q=[-E,1,ww([-E,1],H)],G=[-E,1,ww([-E,1],W)];r=Kt([[X,Q],[X,G],[oe,Q],[oe,G]].map(function(Se){var we=Kt(Se,2),De=we[0],Fe=we[1];return LO(De,Fe)[0]}),4),a=r[0],s=r[1],o=r[2],c=r[3],f=M[1]-M[0],d=T[1]-T[0]}else{var ae=x7(t,0),se=x7(t,1),fe=b7(t,0),_e=b7(t,1);if(a=[ae,se],s=[fe,se],o=[ae,_e],c=[fe,_e],f=fe-ae,d=_e-se,m%180){var Le=[o,a,c,s];n=Kt(Le,4),a=n[0],s=n[1],o=n[2],c=n[3],f=_e-se,d=fe-ae}}if(m%360>180){var Le=[c,o,s,a];i=Kt(Le,4),a=i[0],s=i[1],o=i[2],c=i[3]}var ye=ty([a,s,o,c]),Te=ye.minX,Ie=ye.minY,Me=ye.maxX,de=ye.maxY;return{pos1:a,pos2:s,pos3:o,pos4:c,width:f,height:d,minX:Te,minY:Ie,maxX:Me,maxY:de,rotation:e}}function tJ(t,e){var r=e.map(function(n){if(su(n)){var i=tJ(t,n),a=i.length;return a>1?i:a===1?i[0]:null}else{var s=pf(t,function(o){var c=o.manager;return c.props.target===n});return s?(s.finded=!0,s.manager):null}}).filter(Boolean);return r.length===1&&su(r[0])?r[0]:r}var m2e=(function(t){jx(e,t);function e(){var r=t!==null&&t.apply(this,arguments)||this;return r.differ=new VZ,r.moveables=[],r.transformOrigin="50% 50%",r.renderGroupRects=[],r._targetGroups=[],r._hasFirstTargets=!1,r}return e.prototype.componentDidMount=function(){t.prototype.componentDidMount.call(this)},e.prototype.checkUpdate=function(){this._isPropTargetChanged=!1,this.updateAbles()},e.prototype.getTargets=function(){return this.props.targets},e.prototype.updateRect=function(r,n,i){var a;i===void 0&&(i=!0);var s=this.state;if(!this.controlBox||s.isPersisted)return;G0(!0),this.moveables.forEach(function(Be){Be.updateRect(r,!1,!1)});var o=this.props,c=this.moveables,f=s.target||o.target,d=c.map(function(Be){return{finded:!1,manager:Be}}),m=this.props.targetGroups||[],b=tJ(d,m),x=o.useDefaultGroupRotate;b.push.apply(b,yn([],Kt(d.filter(function(Be){var st=Be.finded;return!st}).map(function(Be){var st=Be.manager;return st})),!1));var E=[],T=!n||r!==""&&o.updateGroup,A=o.defaultGroupRotate||0;if(!this._hasFirstTargets){var M=(a=o.persistData)===null||a===void 0?void 0:a.rotation;M!=null&&(A=M)}function F(Be,st,Qe){var it=Be.map(function(cr){if(su(cr)){var _t=F(cr,st),gr=[_t.pos1,_t.pos2,_t.pos3,_t.pos4];return E.push(_t),{poses:gr,rotation:_t.rotation}}else return{poses:Yf(cr.state),rotation:cr.getRotation()}}),be=it.map(function(cr){var _t=cr.rotation;return _t}),Ot=0,at=be[0],$e=be.every(function(cr){return Math.abs(at-cr)<.1});T?Ot=!x&&$e?at:A:Ot=!x&&!Qe&&$e?at:st;var Xt=it.map(function(cr){var _t=cr.poses;return _t}),$t=g2e(Xt,Ot);return $t}var N=F(b,this.rotation,!0);T&&(this.rotation=N.rotation,this.transformOrigin=o.defaultGroupOrigin||"50% 50%",this.scale=[1,1]),this._targetGroups=m,this.renderGroupRects=E;var O=this.transformOrigin,U=this.rotation,j=this.scale,H=N.width,W=N.height,X=N.minX,oe=N.minY,Q=Nxe([[0,0],[H,0],[0,W],[H,W]],eN(O,H,W),this.rotation/180*Math.PI),G=ty(Q.result),ae=G.minX,se=G.minY,fe=" rotate(".concat(U,"deg)")+" scale(".concat(mc(j[0]),", ").concat(mc(j[1]),")"),_e="translate(".concat(-ae,"px, ").concat(-se,"px)").concat(fe);this.controlBox.style.transform="translate3d(".concat(X,"px, ").concat(oe,"px, ").concat(this.props.translateZ||0,")"),f.style.cssText+="left:0px;top:0px;"+"transform-origin:".concat(O,";")+"width:".concat(H,"px;height:").concat(W,"px;")+"transform: ".concat(_e),s.width=H,s.height=W;var Le=this.getContainer(),ye=PR(this.controlBox,f,this.controlBox,this.getContainer(),this._rootContainer||Le,[]),Te=[ye.left,ye.top],Ie=Kt(Yf(ye),4),Me=Ie[0],de=Ie[1],Se=Ie[2],we=Ie[3],De=ty([Me,de,Se,we]),Fe=[De.minX,De.minY],Xe=mc(j[0]*j[1]);ye.pos1=_i(Me,Fe),ye.pos2=_i(de,Fe),ye.pos3=_i(Se,Fe),ye.pos4=_i(we,Fe),ye.left=X-ye.left+Fe[0],ye.top=oe-ye.top+Fe[1],ye.origin=_i(Ma(Te,ye.origin),Fe),ye.beforeOrigin=_i(Ma(Te,ye.beforeOrigin),Fe),ye.originalBeforeOrigin=Ma(Te,ye.originalBeforeOrigin),ye.transformOrigin=_i(Ma(Te,ye.transformOrigin),Fe),f.style.transform="translate(".concat(-ae-Fe[0],"px, ").concat(-se-Fe[1],"px)")+fe,G0(),this.updateState(Wt(Wt({},ye),{posDelta:Fe,direction:Xe,beforeDirection:Xe}),i)},e.prototype.getRect=function(){return Wt(Wt({},t.prototype.getRect.call(this)),{children:this.moveables.map(function(r){return r.getRect()})})},e.prototype.triggerEvent=function(r,n,i){if(i||r.indexOf("Group")>-1)return t.prototype.triggerEvent.call(this,r,n);this._emitter.trigger(r,n)},e.prototype.getRequestChildStyles=function(){var r=this.getEnabledAbles().reduce(function(n,i){var a,s,o=(s=(a=i.requestChildStyle)===null||a===void 0?void 0:a.call(i))!==null&&s!==void 0?s:[];return yn(yn([],Kt(n),!1),Kt(o),!1)},[]);return r},e.prototype.getMoveables=function(){return yn([],Kt(this.moveables),!1)},e.prototype.updateAbles=function(){t.prototype.updateAbles.call(this,yn(yn([],Kt(this.props.ables),!1),[iN],!1),"Group")},e.prototype._updateTargets=function(){t.prototype._updateTargets.call(this),this._originalDragTarget=this.props.dragTarget||this.areaElement,this._dragTarget=bd(this._originalDragTarget,!0)},e.prototype._updateEvents=function(){var r=this.state,n=this.props,i=this._prevDragTarget,a=n.dragTarget||this.areaElement,s=n.targets,o=this.differ.update(s),c=o.added,f=o.changed,d=o.removed,m=c.length||d.length;(m||this._prevOriginalDragTarget!==this._originalDragTarget)&&(h0(this,!1),h0(this,!0),this.updateState({gestos:{}})),i!==a&&(r.target=null),r.target||(r.target=this.areaElement,this.controlBox.style.display="block"),r.target&&(this.targetGesto||(this.targetGesto=KK(this,this._dragTarget,"Group")),this.controlGesto||(this.controlGesto=JK(this,"GroupControl")));var b=!AR(r.container,n.container);b&&(r.container=n.container),(b||m||this.transformOrigin!==(n.defaultGroupOrigin||"50% 50%")||f.length||s.length&&!UK(this._targetGroups,n.targetGroups||[]))&&(this.updateRect(),this._hasFirstTargets=!0),this._isPropTargetChanged=!!m},e.prototype._updateObserver=function(){},e.defaultProps=Wt(Wt({},Y0.defaultProps),{transformOrigin:["50%","50%"],groupable:!0,dragArea:!0,keepRatio:!0,targets:[],defaultGroupRotate:0,defaultGroupOrigin:"50% 50%"}),e})(Y0),y2e=(function(t){jx(e,t);function e(){var r=t!==null&&t.apply(this,arguments)||this;return r.moveables=[],r}return e.prototype.render=function(){var r=this,n,i=this.props,a=i.cspNonce,s=i.cssStyled,o=i.persistData,c=i.targets||[],f=c.length,d=this.isUnmounted||!f,m=(n=o?.children)!==null&&n!==void 0?n:[];return d&&!f&&m.length?c=m.map(function(){return null}):d||(m=[]),te.createElement(s,{cspNonce:a,ref:zm(this,"controlBox"),className:yi("control-box")},c.map(function(b,x){var E,T,A=(T=(E=i.individualGroupableProps)===null||E===void 0?void 0:E.call(i,b,x))!==null&&T!==void 0?T:{};return te.createElement(Y0,Wt({key:"moveable"+x,ref:PZ(r,"moveables",x)},i,A,{target:b,wrapperMoveable:r,isWrapperMounted:r.isMoveableMounted,persistData:m[x]}))}))},e.prototype.componentDidMount=function(){},e.prototype.componentDidUpdate=function(){},e.prototype.getTargets=function(){return this.props.targets},e.prototype.updateRect=function(r,n,i){i===void 0&&(i=!0),G0(!0),this.moveables.forEach(function(a){a.updateRect(r,n,i)}),G0()},e.prototype.getRect=function(){return Wt(Wt({},t.prototype.getRect.call(this)),{children:this.moveables.map(function(r){return r.getRect()})})},e.prototype.request=function(r,n,i){n===void 0&&(n={});var a=this.moveables.map(function(c){return c.request(r,Wt(Wt({},n),{isInstant:!1}),!1)}),s=i||n.isInstant,o={request:function(c){return a.forEach(function(f){return f.request(c)}),this},requestEnd:function(){return a.forEach(function(c){return c.requestEnd()}),this}};return s?o.request(n).requestEnd():o},e.prototype.dragStart=function(r,n){n===void 0&&(n=r.target);var i=n,a=pf(this.moveables,function(s){var o=s.getTargets()[0],c=s.getControlBoxElement(),f=s.getDragElement();return!o||!f?!1:f===i||f.contains(i)||f!==o&&o===i||o.contains(i)||c===i||c.contains(i)});return a&&a.dragStart(r,n),this},e.prototype.hitTest=function(){return 0},e.prototype.isInside=function(){return!1},e.prototype.isDragging=function(){return!1},e.prototype.getDragElement=function(){return null},e.prototype.getMoveables=function(){return yn([],Kt(this.moveables),!1)},e.prototype.updateRenderPoses=function(){},e.prototype.checkUpdate=function(){},e.prototype.triggerEvent=function(){},e.prototype.updateAbles=function(){},e.prototype._updateEvents=function(){},e.prototype._updateObserver=function(){},e})(Y0);function rJ(t,e){var r=[];return t.forEach(function(n){if(n){if(kp(n)){e[n]&&r.push.apply(r,yn([],Kt(e[n]),!1));return}su(n)?r.push.apply(r,yn([],Kt(rJ(n,e)),!1)):r.push(n)}}),r}function nJ(t,e){var r=[];return t.forEach(function(n){if(n){if(kp(n)){e[n]&&r.push.apply(r,yn([],Kt(e[n]),!1));return}su(n)?r.push(nJ(n,e)):r.push(n)}}),r}function iJ(t,e){return t.length!==e.length||t.some(function(r,n){var i=e[n];return!r&&!i?!1:r!=i?su(r)&&su(i)?iJ(r,i):!0:!1})}var v2e=(function(t){jx(e,t);function e(){var r=t!==null&&t.apply(this,arguments)||this;return r.refTargets=[],r.selectorMap={},r._differ=new VZ,r._elementTargets=[],r._tmpRefTargets=[],r._tmpSelectorMap={},r._onChangeTargets=null,r}return e.makeStyled=function(){var r={},n=this.getTotalAbles();n.forEach(function(a){var s=a.css;s&&s.forEach(function(o){r[o]=!0})});var i=g_(r).join(`
`);this.defaultStyled=GZ("div",L_e(BO,rbe+i))},e.getTotalAbles=function(){return yn([HK,iN,eJ,qK],Kt(this.defaultAbles),!1)},e.prototype.render=function(){var r,n=this.constructor;n.defaultStyled||n.makeStyled();var i=this.props,a=i.ables,s=i.props,o=$1e(i,["ables","props"]),c=Kt(this._updateRefs(!0),2),f=c[0],d=c[1],m=rJ(f,d),b=m.length>1,x=n.getTotalAbles(),E=yn(yn([],Kt(x),!1),Kt(a||[]),!1),T=Wt(Wt(Wt({},o),s||{}),{ables:E,cssStyled:n.defaultStyled,customStyledMap:n.customStyledMap});this._elementTargets=m;var A=null,M=this.moveable,F=o.persistData;if(F?.children&&(b=!0),o.individualGroupable)return te.createElement(y2e,Wt({key:"individual-group",ref:zm(this,"moveable")},T,{target:null,targets:m}));if(b){var N=nJ(f,d);if(M&&!M.props.groupable&&!M.props.individualGroupable){var O=M.props.target;O&&m.indexOf(O)>-1&&(A=Wt({},M.state))}return te.createElement(m2e,Wt({key:"group",ref:zm(this,"moveable")},T,(r=o.groupableProps)!==null&&r!==void 0?r:{},{target:null,targets:m,targetGroups:N,firstRenderState:A}))}else{var U=m[0];if(M&&(M.props.groupable||M.props.individualGroupable)){var j=M.moveables||[],H=pf(j,function(W){return W.props.target===U});H&&(A=Wt({},H.state))}return te.createElement(Y0,Wt({key:"single",ref:zm(this,"moveable")},T,{target:U,firstRenderState:A}))}},e.prototype.componentDidMount=function(){this._checkChangeTargets()},e.prototype.componentDidUpdate=function(){this._checkChangeTargets()},e.prototype.componentWillUnmount=function(){this.selectorMap={},this.refTargets=[]},e.prototype.getTargets=function(){var r,n;return(n=(r=this.moveable)===null||r===void 0?void 0:r.getTargets())!==null&&n!==void 0?n:[]},e.prototype.updateSelectors=function(){this.selectorMap={},this._updateRefs(),this.forceUpdate()},e.prototype.waitToChangeTarget=function(){var r=this,n;return this._onChangeTargets=function(){r._onChangeTargets=null,n()},new Promise(function(i){n=i})},e.prototype.waitToChangeTargets=function(){return this.waitToChangeTarget()},e.prototype.getManager=function(){return this.moveable},e.prototype.getMoveables=function(){return this.moveable.getMoveables()},e.prototype.getDragElement=function(){return this.moveable.getDragElement()},e.prototype._updateRefs=function(r){var n=this.refTargets,i=QO(this.props.target||this.props.targets),a=typeof document<"u",s=iJ(n,i),o=this.selectorMap,c={};return this.refTargets.forEach(function f(d){if(kp(d)){var m=o[d];m?c[d]=o[d]:a&&(s=!0,c[d]=[].slice.call(document.querySelectorAll(d)))}else su(d)&&d.forEach(f)}),this._tmpRefTargets=i,this._tmpSelectorMap=c,[i,c,!r&&s]},e.prototype._checkChangeTargets=function(){var r,n,i;this.refTargets=this._tmpRefTargets,this.selectorMap=this._tmpSelectorMap;var a=this._differ.update(this._elementTargets),s=a.added,o=a.removed,c=s.length||o.length;c&&((n=(r=this.props).onChangeTargets)===null||n===void 0||n.call(r,{moveable:this.moveable,targets:this._elementTargets}),(i=this._onChangeTargets)===null||i===void 0||i.call(this));var f=Kt(this._updateRefs(),3),d=f[0],m=f[1],b=f[2];this.refTargets=d,this.selectorMap=m,b&&this.forceUpdate()},e.defaultAbles=[],e.customStyledMap={},e.defaultStyled=null,q1e([F_e(abe)],e.prototype,"moveable",void 0),e})(te.PureComponent),_2e=(function(t){jx(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.defaultAbles=p2e,e})(v2e),Ku=63710088e-1,aJ={centimeters:Ku*100,centimetres:Ku*100,degrees:360/(2*Math.PI),feet:Ku*3.28084,inches:Ku*39.37,kilometers:Ku/1e3,kilometres:Ku/1e3,meters:Ku,metres:Ku,miles:Ku/1609.344,millimeters:Ku*1e3,millimetres:Ku*1e3,nauticalmiles:Ku/1852,radians:1,yards:Ku*1.0936};function ny(t,e,r={}){const n={type:"Feature"};return(r.id===0||r.id)&&(n.id=r.id),r.bbox&&(n.bbox=r.bbox),n.properties=e||{},n.geometry=t,n}function Oc(t,e,r={}){if(!t)throw new Error("coordinates is required");if(!Array.isArray(t))throw new Error("coordinates must be an Array");if(t.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!kR(t[0])||!kR(t[1]))throw new Error("coordinates must contain numbers");return ny({type:"Point",coordinates:t},e,r)}function h3(t,e,r={}){for(const i of t){if(i.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");if(i[i.length-1].length!==i[0].length)throw new Error("First and last Position are not equivalent.");for(let a=0;a<i[i.length-1].length;a++)if(i[i.length-1][a]!==i[0][a])throw new Error("First and last Position are not equivalent.")}return ny({type:"Polygon",coordinates:t},e,r)}function Su(t,e,r={}){if(t.length<2)throw new Error("coordinates must be an array of two or more positions");return ny({type:"LineString",coordinates:t},e,r)}function Ep(t,e={}){const r={type:"FeatureCollection"};return e.id&&(r.id=e.id),e.bbox&&(r.bbox=e.bbox),r.features=t,r}function b2e(t,e,r={}){return ny({type:"MultiLineString",coordinates:t},e,r)}function oJ(t,e="kilometers"){const r=aJ[e];if(!r)throw new Error(e+" units is invalid");return t*r}function aN(t,e="kilometers"){const r=aJ[e];if(!r)throw new Error(e+" units is invalid");return t/r}function x2e(t,e){return hE(aN(t,e))}function hE(t){return t%(2*Math.PI)*180/Math.PI}function xh(t){return t%360*Math.PI/180}function kR(t){return!isNaN(t)&&t!==null&&!Array.isArray(t)}function oN(t){return t!==null&&typeof t=="object"&&!Array.isArray(t)}function Pg(t){if(!t)throw new Error("coord is required");if(!Array.isArray(t)){if(t.type==="Feature"&&t.geometry!==null&&t.geometry.type==="Point")return[...t.geometry.coordinates];if(t.type==="Point")return[...t.coordinates]}if(Array.isArray(t)&&t.length>=2&&!Array.isArray(t[0])&&!Array.isArray(t[1]))return[...t];throw new Error("coord must be GeoJSON Point or an Array of numbers")}function sJ(t){if(Array.isArray(t))return t;if(t.type==="Feature"){if(t.geometry!==null)return t.geometry.coordinates}else if(t.coordinates)return t.coordinates;throw new Error("coords must be GeoJSON Feature, Geometry Object or an Array")}function Yb(t){return t.type==="Feature"?t.geometry:t}function lJ(t,e){return t.type==="FeatureCollection"?"FeatureCollection":t.type==="GeometryCollection"?"GeometryCollection":t.type==="Feature"&&t.geometry!==null?t.geometry.type:t.type}function Zb(t,e,r={}){if(r.final===!0)return w2e(t,e);const n=Pg(t),i=Pg(e),a=xh(n[0]),s=xh(i[0]),o=xh(n[1]),c=xh(i[1]),f=Math.sin(s-a)*Math.cos(c),d=Math.cos(o)*Math.sin(c)-Math.sin(o)*Math.cos(c)*Math.cos(s-a);return hE(Math.atan2(f,d))}function w2e(t,e){let r=Zb(e,t);return r=(r+180)%360,r}function Z0(t,e,r,n={}){const i=Pg(t),a=xh(i[0]),s=xh(i[1]),o=xh(r),c=aN(e,n.units),f=Math.asin(Math.sin(s)*Math.cos(c)+Math.cos(s)*Math.sin(c)*Math.cos(o)),d=a+Math.atan2(Math.sin(o)*Math.sin(c)*Math.cos(s),Math.cos(c)-Math.sin(s)*Math.sin(f)),m=hE(d),b=hE(f);return Oc([m,b],n.properties)}function d3(t,e,r={}){var n=Pg(t),i=Pg(e),a=xh(i[1]-n[1]),s=xh(i[0]-n[0]),o=xh(n[1]),c=xh(i[1]),f=Math.pow(Math.sin(a/2),2)+Math.pow(Math.sin(s/2),2)*Math.cos(o)*Math.cos(c);return oJ(2*Math.atan2(Math.sqrt(f),Math.sqrt(1-f)),r.units)}function S2e(t,e,r={}){const i=Yb(t).coordinates;let a=0;for(let s=0;s<i.length&&!(e>=a&&s===i.length-1);s++)if(a>=e){const o=e-a;if(o){const c=Zb(i[s],i[s-1])-180;return Z0(i[s],o,c,r)}else return Oc(i[s])}else a+=d3(i[s],i[s+1],r);return Oc(i[i.length-1])}function Ty(t,e,r){if(t!==null)for(var n,i,a,s,o,c,f,d=0,m=0,b,x=t.type,E=x==="FeatureCollection",T=x==="Feature",A=E?t.features.length:1,M=0;M<A;M++){f=E?t.features[M].geometry:T?t.geometry:t,b=f?f.type==="GeometryCollection":!1,o=b?f.geometries.length:1;for(var F=0;F<o;F++){var N=0,O=0;if(s=b?f.geometries[F]:f,s!==null){c=s.coordinates;var U=s.type;switch(d=r&&(U==="Polygon"||U==="MultiPolygon")?1:0,U){case null:break;case"Point":if(e(c,m,M,N,O)===!1)return!1;m++,N++;break;case"LineString":case"MultiPoint":for(n=0;n<c.length;n++){if(e(c[n],m,M,N,O)===!1)return!1;m++,U==="MultiPoint"&&N++}U==="LineString"&&N++;break;case"Polygon":case"MultiLineString":for(n=0;n<c.length;n++){for(i=0;i<c[n].length-d;i++){if(e(c[n][i],m,M,N,O)===!1)return!1;m++}U==="MultiLineString"&&N++,U==="Polygon"&&O++}U==="Polygon"&&N++;break;case"MultiPolygon":for(n=0;n<c.length;n++){for(O=0,i=0;i<c[n].length;i++){for(a=0;a<c[n][i].length-d;a++){if(e(c[n][i][a],m,M,N,O)===!1)return!1;m++}O++}N++}break;case"GeometryCollection":for(n=0;n<s.geometries.length;n++)if(Ty(s.geometries[n],e,r)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function w7(t,e){if(t.type==="Feature")e(t,0);else if(t.type==="FeatureCollection")for(var r=0;r<t.features.length&&e(t.features[r],r)!==!1;r++);}function p3(t,e){var r,n,i,a,s,o,c,f,d,m,b=0,x=t.type==="FeatureCollection",E=t.type==="Feature",T=x?t.features.length:1;for(r=0;r<T;r++){for(o=x?t.features[r].geometry:E?t.geometry:t,f=x?t.features[r].properties:E?t.properties:{},d=x?t.features[r].bbox:E?t.bbox:void 0,m=x?t.features[r].id:E?t.id:void 0,c=o?o.type==="GeometryCollection":!1,s=c?o.geometries.length:1,i=0;i<s;i++){if(a=c?o.geometries[i]:o,a===null){if(e(null,b,f,d,m)===!1)return!1;continue}switch(a.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":{if(e(a,b,f,d,m)===!1)return!1;break}case"GeometryCollection":{for(n=0;n<a.geometries.length;n++)if(e(a.geometries[n],b,f,d,m)===!1)return!1;break}default:throw new Error("Unknown Geometry Type")}}b++}}function E2e(t,e,r){var n=r;return p3(t,function(i,a,s,o,c){n=e(n,i,a,s,o,c)}),n}function sN(t,e){p3(t,function(r,n,i,a,s){var o=r===null?null:r.type;switch(o){case null:case"Point":case"LineString":case"Polygon":return e(ny(r,i,{bbox:a,id:s}),n,0)===!1?!1:void 0}var c;switch(o){case"MultiPoint":c="Point";break;case"MultiLineString":c="LineString";break;case"MultiPolygon":c="Polygon";break}for(var f=0;f<r.coordinates.length;f++){var d=r.coordinates[f],m={type:c,coordinates:d};if(e(ny(m,i),n,f)===!1)return!1}})}function T2e(t,e){sN(t,function(r,n,i){var a=0;if(r.geometry){var s=r.geometry.type;if(!(s==="Point"||s==="MultiPoint")){var o,c=0,f=0,d=0;if(Ty(r,function(m,b,x,E,T){if(o===void 0||n>c||E>f||T>d){o=m,c=n,f=E,d=T,a=0;return}var A=Su([o,m],r.properties);if(e(A,n,i,T,a)===!1)return!1;a++,o=m})===!1)return!1}}})}function C2e(t,e,r){var n=r,i=!1;return T2e(t,function(a,s,o,c,f){i===!1&&r===void 0?n=a:n=e(n,a,s,o,c,f),i=!0}),n}function A2e(t){return E2e(t,(e,r)=>e+I2e(r),0)}function I2e(t){let e=0,r;switch(t.type){case"Polygon":return S7(t.coordinates);case"MultiPolygon":for(r=0;r<t.coordinates.length;r++)e+=S7(t.coordinates[r]);return e;case"Point":case"MultiPoint":case"LineString":case"MultiLineString":return 0}return 0}function S7(t){let e=0;if(t&&t.length>0){e+=Math.abs(E7(t[0]));for(let r=1;r<t.length;r++)e-=Math.abs(E7(t[r]))}return e}var P2e=Ku*Ku/2,r5=Math.PI/180;function E7(t){const e=t.length-1;if(e<=2)return 0;let r=0,n=0;for(;n<e;){const i=t[n],a=t[n+1===e?0:n+1],s=t[n+2>=e?(n+2)%e:n+2],o=i[0]*r5,c=a[1]*r5,f=s[0]*r5;r+=(f-o)*Math.sin(c),n++}return r*P2e}function mf(t,e={}){if(t.bbox!=null&&e.recompute!==!0)return t.bbox;const r=[1/0,1/0,-1/0,-1/0];return Ty(t,n=>{r[0]>n[0]&&(r[0]=n[0]),r[1]>n[1]&&(r[1]=n[1]),r[2]<n[0]&&(r[2]=n[0]),r[3]<n[1]&&(r[3]=n[1])}),r}function T7(t,e={}){const r=Number(t[0]),n=Number(t[1]),i=Number(t[2]),a=Number(t[3]);if(t.length===6)throw new Error("@turf/bbox-polygon does not support BBox with 6 positions");const s=[r,n];return h3([[s,[i,n],[i,a],[r,a],s]],e.properties,{bbox:t,id:e.id})}const yp=11102230246251565e-32,Wu=134217729,k2e=(3+8*yp)*yp;function n5(t,e,r,n,i){let a,s,o,c,f=e[0],d=n[0],m=0,b=0;d>f==d>-f?(a=f,f=e[++m]):(a=d,d=n[++b]);let x=0;if(m<t&&b<r)for(d>f==d>-f?(s=f+a,o=a-(s-f),f=e[++m]):(s=d+a,o=a-(s-d),d=n[++b]),a=s,o!==0&&(i[x++]=o);m<t&&b<r;)d>f==d>-f?(s=a+f,c=s-a,o=a-(s-c)+(f-c),f=e[++m]):(s=a+d,c=s-a,o=a-(s-c)+(d-c),d=n[++b]),a=s,o!==0&&(i[x++]=o);for(;m<t;)s=a+f,c=s-a,o=a-(s-c)+(f-c),f=e[++m],a=s,o!==0&&(i[x++]=o);for(;b<r;)s=a+d,c=s-a,o=a-(s-c)+(d-c),d=n[++b],a=s,o!==0&&(i[x++]=o);return(a!==0||x===0)&&(i[x++]=a),x}function R2e(t,e){let r=e[0];for(let n=1;n<t;n++)r+=e[n];return r}function qx(t){return new Float64Array(t)}const M2e=(3+16*yp)*yp,D2e=(2+12*yp)*yp,O2e=(9+64*yp)*yp*yp,_v=qx(4),C7=qx(8),A7=qx(12),I7=qx(16),fc=qx(4);function N2e(t,e,r,n,i,a,s){let o,c,f,d,m,b,x,E,T,A,M,F,N,O,U,j,H,W;const X=t-i,oe=r-i,Q=e-a,G=n-a;O=X*G,b=Wu*X,x=b-(b-X),E=X-x,b=Wu*G,T=b-(b-G),A=G-T,U=E*A-(O-x*T-E*T-x*A),j=Q*oe,b=Wu*Q,x=b-(b-Q),E=Q-x,b=Wu*oe,T=b-(b-oe),A=oe-T,H=E*A-(j-x*T-E*T-x*A),M=U-H,m=U-M,_v[0]=U-(M+m)+(m-H),F=O+M,m=F-O,N=O-(F-m)+(M-m),M=N-j,m=N-M,_v[1]=N-(M+m)+(m-j),W=F+M,m=W-F,_v[2]=F-(W-m)+(M-m),_v[3]=W;let ae=R2e(4,_v),se=D2e*s;if(ae>=se||-ae>=se||(m=t-X,o=t-(X+m)+(m-i),m=r-oe,f=r-(oe+m)+(m-i),m=e-Q,c=e-(Q+m)+(m-a),m=n-G,d=n-(G+m)+(m-a),o===0&&c===0&&f===0&&d===0)||(se=O2e*s+k2e*Math.abs(ae),ae+=X*d+G*o-(Q*f+oe*c),ae>=se||-ae>=se))return ae;O=o*G,b=Wu*o,x=b-(b-o),E=o-x,b=Wu*G,T=b-(b-G),A=G-T,U=E*A-(O-x*T-E*T-x*A),j=c*oe,b=Wu*c,x=b-(b-c),E=c-x,b=Wu*oe,T=b-(b-oe),A=oe-T,H=E*A-(j-x*T-E*T-x*A),M=U-H,m=U-M,fc[0]=U-(M+m)+(m-H),F=O+M,m=F-O,N=O-(F-m)+(M-m),M=N-j,m=N-M,fc[1]=N-(M+m)+(m-j),W=F+M,m=W-F,fc[2]=F-(W-m)+(M-m),fc[3]=W;const fe=n5(4,_v,4,fc,C7);O=X*d,b=Wu*X,x=b-(b-X),E=X-x,b=Wu*d,T=b-(b-d),A=d-T,U=E*A-(O-x*T-E*T-x*A),j=Q*f,b=Wu*Q,x=b-(b-Q),E=Q-x,b=Wu*f,T=b-(b-f),A=f-T,H=E*A-(j-x*T-E*T-x*A),M=U-H,m=U-M,fc[0]=U-(M+m)+(m-H),F=O+M,m=F-O,N=O-(F-m)+(M-m),M=N-j,m=N-M,fc[1]=N-(M+m)+(m-j),W=F+M,m=W-F,fc[2]=F-(W-m)+(M-m),fc[3]=W;const _e=n5(fe,C7,4,fc,A7);O=o*d,b=Wu*o,x=b-(b-o),E=o-x,b=Wu*d,T=b-(b-d),A=d-T,U=E*A-(O-x*T-E*T-x*A),j=c*f,b=Wu*c,x=b-(b-c),E=c-x,b=Wu*f,T=b-(b-f),A=f-T,H=E*A-(j-x*T-E*T-x*A),M=U-H,m=U-M,fc[0]=U-(M+m)+(m-H),F=O+M,m=F-O,N=O-(F-m)+(M-m),M=N-j,m=N-M,fc[1]=N-(M+m)+(m-j),W=F+M,m=W-F,fc[2]=F-(W-m)+(M-m),fc[3]=W;const Le=n5(_e,A7,4,fc,I7);return I7[Le-1]}function L2e(t,e,r,n,i,a){const s=(e-a)*(r-i),o=(t-i)*(n-a),c=s-o,f=Math.abs(s+o);return Math.abs(c)>=M2e*f?c:-N2e(t,e,r,n,i,a,f)}function F2e(t,e){var r,n,i=0,a,s,o,c,f,d,m,b=t[0],x=t[1],E=e.length;for(r=0;r<E;r++){n=0;var T=e[r],A=T.length-1;if(d=T[0],d[0]!==T[A][0]&&d[1]!==T[A][1])throw new Error("First and last coordinates in a ring must be the same");for(s=d[0]-b,o=d[1]-x,n;n<A;n++){if(m=T[n+1],c=m[0]-b,f=m[1]-x,o===0&&f===0){if(c<=0&&s>=0||s<=0&&c>=0)return 0}else if(f>=0&&o<=0||f<=0&&o>=0){if(a=L2e(s,c,o,f,0,0),a===0)return 0;(a>0&&f>0&&o<=0||a<0&&f<=0&&o>0)&&i++}d=m,o=f,s=c}}return i%2!==0}function g3(t,e,r={}){if(!t)throw new Error("point is required");if(!e)throw new Error("polygon is required");const n=Pg(t),i=Yb(e),a=i.type,s=e.bbox;let o=i.coordinates;if(s&&B2e(n,s)===!1)return!1;a==="Polygon"&&(o=[o]);let c=!1;for(var f=0;f<o.length;++f){const d=F2e(n,o[f]);if(d===0)return!r.ignoreBoundary;d&&(c=!0)}return c}function B2e(t,e){return e[0]<=t[0]&&e[1]<=t[1]&&e[2]>=t[0]&&e[3]>=t[1]}function Kb(t,e,r={}){const n=Pg(t),i=sJ(e);for(let a=0;a<i.length-1;a++){let s=!1;if(r.ignoreEndVertices&&(a===0&&(s="start"),a===i.length-2&&(s="end"),a===0&&a+1===i.length-1&&(s="both")),z2e(i[a],i[a+1],n,s,typeof r.epsilon>"u"?null:r.epsilon))return!0}return!1}function z2e(t,e,r,n,i){const a=r[0],s=r[1],o=t[0],c=t[1],f=e[0],d=e[1],m=r[0]-o,b=r[1]-c,x=f-o,E=d-c,T=m*E-b*x;if(i!==null){if(Math.abs(T)>i)return!1}else if(T!==0)return!1;if(Math.abs(x)===Math.abs(E)&&Math.abs(x)===0)return n?!1:r[0]===t[0]&&r[1]===t[1];if(n){if(n==="start")return Math.abs(x)>=Math.abs(E)?x>0?o<a&&a<=f:f<=a&&a<o:E>0?c<s&&s<=d:d<=s&&s<c;if(n==="end")return Math.abs(x)>=Math.abs(E)?x>0?o<=a&&a<f:f<a&&a<=o:E>0?c<=s&&s<d:d<s&&s<=c;if(n==="both")return Math.abs(x)>=Math.abs(E)?x>0?o<a&&a<f:f<a&&a<o:E>0?c<s&&s<d:d<s&&s<c}else return Math.abs(x)>=Math.abs(E)?x>0?o<=a&&a<=f:f<=a&&a<=o:E>0?c<=s&&s<=d:d<=s&&s<=c;return!1}function j2e(t,e){const r=Yb(t),n=Yb(e),i=r.type,a=n.type,s=r.coordinates,o=n.coordinates;switch(i){case"Point":switch(a){case"Point":return lN(s,o);default:throw new Error("feature2 "+a+" geometry not supported")}case"MultiPoint":switch(a){case"Point":return V2e(r,n);case"MultiPoint":return $2e(r,n);default:throw new Error("feature2 "+a+" geometry not supported")}case"LineString":switch(a){case"Point":return Kb(n,r,{ignoreEndVertices:!0});case"LineString":return G2e(r,n);case"MultiPoint":return q2e(r,n);default:throw new Error("feature2 "+a+" geometry not supported")}case"Polygon":switch(a){case"Point":return g3(n,r,{ignoreBoundary:!0});case"LineString":return W2e(r,n);case"Polygon":return uJ(r,n);case"MultiPoint":return H2e(r,n);default:throw new Error("feature2 "+a+" geometry not supported")}case"MultiPolygon":switch(a){case"Polygon":return U2e(r,n);default:throw new Error("feature2 "+a+" geometry not supported")}default:throw new Error("feature1 "+i+" geometry not supported")}}function U2e(t,e){return t.coordinates.some(r=>uJ({type:"Polygon",coordinates:r},e))}function V2e(t,e){let r,n=!1;for(r=0;r<t.coordinates.length;r++)if(lN(t.coordinates[r],e.coordinates)){n=!0;break}return n}function $2e(t,e){for(const r of e.coordinates){let n=!1;for(const i of t.coordinates)if(lN(r,i)){n=!0;break}if(!n)return!1}return!0}function q2e(t,e){let r=!1;for(const n of e.coordinates)if(Kb(n,t,{ignoreEndVertices:!0})&&(r=!0),!Kb(n,t))return!1;return!!r}function H2e(t,e){for(const r of e.coordinates)if(!g3(r,t,{ignoreBoundary:!0}))return!1;return!0}function G2e(t,e){let r=!1;for(const n of e.coordinates)if(Kb({type:"Point",coordinates:n},t,{ignoreEndVertices:!0})&&(r=!0),!Kb({type:"Point",coordinates:n},t,{ignoreEndVertices:!1}))return!1;return r}function W2e(t,e){let r=!1,n=0;const i=mf(t),a=mf(e);if(!cJ(i,a))return!1;for(n;n<e.coordinates.length-1;n++){const s=X2e(e.coordinates[n],e.coordinates[n+1]);if(g3({type:"Point",coordinates:s},t,{ignoreBoundary:!0})){r=!0;break}}return r}function uJ(t,e){if(t.type==="Feature"&&t.geometry===null||e.type==="Feature"&&e.geometry===null)return!1;const r=mf(t),n=mf(e);if(!cJ(r,n))return!1;const i=Yb(e).coordinates;for(const a of i)for(const s of a)if(!g3(s,t))return!1;return!0}function cJ(t,e){return!(t[0]>e[0]||t[2]<e[2]||t[1]>e[1]||t[3]<e[3])}function lN(t,e){return t[0]===e[0]&&t[1]===e[1]}function X2e(t,e){return[(t[0]+e[0])/2,(t[1]+e[1])/2]}function Y2e(t,e={}){const r=mf(t),n=(r[0]+r[2])/2,i=(r[1]+r[3])/2;return Oc([n,i],e.properties,e)}var vS={exports:{}},Z2e=vS.exports,P7;function K2e(){return P7||(P7=1,(function(t,e){(function(r,n){t.exports=n()})(Z2e,(function(){function r(I,y){(y==null||y>I.length)&&(y=I.length);for(var _=0,P=Array(y);_<y;_++)P[_]=I[_];return P}function n(I,y,_){return y=d(y),(function(P,$){if($&&(typeof $=="object"||typeof $=="function"))return $;if($!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return(function(ne){if(ne===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return ne})(P)})(I,b()?Reflect.construct(y,_||[],d(I).constructor):y.apply(I,_))}function i(I,y){if(!(I instanceof y))throw new TypeError("Cannot call a class as a function")}function a(I,y,_){if(b())return Reflect.construct.apply(null,arguments);var P=[null];P.push.apply(P,y);var $=new(I.bind.apply(I,P));return _&&x($,_.prototype),$}function s(I,y){for(var _=0;_<y.length;_++){var P=y[_];P.enumerable=P.enumerable||!1,P.configurable=!0,"value"in P&&(P.writable=!0),Object.defineProperty(I,A(P.key),P)}}function o(I,y,_){return y&&s(I.prototype,y),_&&s(I,_),Object.defineProperty(I,"prototype",{writable:!1}),I}function c(I,y){var _=typeof Symbol<"u"&&I[Symbol.iterator]||I["@@iterator"];if(!_){if(Array.isArray(I)||(_=M(I))||y){_&&(I=_);var P=0,$=function(){};return{s:$,n:function(){return P>=I.length?{done:!0}:{done:!1,value:I[P++]}},e:function(tt){throw tt},f:$}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var ne,me=!0,Oe=!1;return{s:function(){_=_.call(I)},n:function(){var tt=_.next();return me=tt.done,tt},e:function(tt){Oe=!0,ne=tt},f:function(){try{me||_.return==null||_.return()}finally{if(Oe)throw ne}}}}function f(){return f=typeof Reflect<"u"&&Reflect.get?Reflect.get.bind():function(I,y,_){var P=(function(ne,me){for(;!{}.hasOwnProperty.call(ne,me)&&(ne=d(ne))!==null;);return ne})(I,y);if(P){var $=Object.getOwnPropertyDescriptor(P,y);return $.get?$.get.call(arguments.length<3?I:_):$.value}},f.apply(null,arguments)}function d(I){return d=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(y){return y.__proto__||Object.getPrototypeOf(y)},d(I)}function m(I,y){if(typeof y!="function"&&y!==null)throw new TypeError("Super expression must either be null or a function");I.prototype=Object.create(y&&y.prototype,{constructor:{value:I,writable:!0,configurable:!0}}),Object.defineProperty(I,"prototype",{writable:!1}),y&&x(I,y)}function b(){try{var I=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch{}return(b=function(){return!!I})()}function x(I,y){return x=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(_,P){return _.__proto__=P,_},x(I,y)}function E(I,y,_,P){var $=f(d(1&P?I.prototype:I),y,_);return 2&P&&typeof $=="function"?function(ne){return $.apply(_,ne)}:$}function T(I){return(function(y){if(Array.isArray(y))return r(y)})(I)||(function(y){if(typeof Symbol<"u"&&y[Symbol.iterator]!=null||y["@@iterator"]!=null)return Array.from(y)})(I)||M(I)||(function(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)})()}function A(I){var y=(function(_,P){if(typeof _!="object"||!_)return _;var $=_[Symbol.toPrimitive];if($!==void 0){var ne=$.call(_,P);if(typeof ne!="object")return ne;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(_)})(I,"string");return typeof y=="symbol"?y:y+""}function M(I,y){if(I){if(typeof I=="string")return r(I,y);var _={}.toString.call(I).slice(8,-1);return _==="Object"&&I.constructor&&(_=I.constructor.name),_==="Map"||_==="Set"?Array.from(I):_==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(_)?r(I,y):void 0}}function F(I){var y=typeof Map=="function"?new Map:void 0;return F=function(_){if(_===null||!(function($){try{return Function.toString.call($).indexOf("[native code]")!==-1}catch{return typeof $=="function"}})(_))return _;if(typeof _!="function")throw new TypeError("Super expression must either be null or a function");if(y!==void 0){if(y.has(_))return y.get(_);y.set(_,P)}function P(){return a(_,arguments,d(this).constructor)}return P.prototype=Object.create(_.prototype,{constructor:{value:P,enumerable:!1,writable:!0,configurable:!0}}),x(P,_)},F(I)}var N=(function(){function I(){i(this,I),I.constructor_.apply(this,arguments)}return o(I,[{key:"getEndCapStyle",value:function(){return this._endCapStyle}},{key:"isSingleSided",value:function(){return this._isSingleSided}},{key:"setQuadrantSegments",value:function(y){this._quadrantSegments=y,this._quadrantSegments===0&&(this._joinStyle=I.JOIN_BEVEL),this._quadrantSegments<0&&(this._joinStyle=I.JOIN_MITRE,this._mitreLimit=Math.abs(this._quadrantSegments)),y<=0&&(this._quadrantSegments=1),this._joinStyle!==I.JOIN_ROUND&&(this._quadrantSegments=I.DEFAULT_QUADRANT_SEGMENTS)}},{key:"getJoinStyle",value:function(){return this._joinStyle}},{key:"setJoinStyle",value:function(y){this._joinStyle=y}},{key:"setSimplifyFactor",value:function(y){this._simplifyFactor=y<0?0:y}},{key:"getSimplifyFactor",value:function(){return this._simplifyFactor}},{key:"getQuadrantSegments",value:function(){return this._quadrantSegments}},{key:"setEndCapStyle",value:function(y){this._endCapStyle=y}},{key:"getMitreLimit",value:function(){return this._mitreLimit}},{key:"setMitreLimit",value:function(y){this._mitreLimit=y}},{key:"setSingleSided",value:function(y){this._isSingleSided=y}}],[{key:"constructor_",value:function(){if(this._quadrantSegments=I.DEFAULT_QUADRANT_SEGMENTS,this._endCapStyle=I.CAP_ROUND,this._joinStyle=I.JOIN_ROUND,this._mitreLimit=I.DEFAULT_MITRE_LIMIT,this._isSingleSided=!1,this._simplifyFactor=I.DEFAULT_SIMPLIFY_FACTOR,arguments.length!==0){if(arguments.length===1){var y=arguments[0];this.setQuadrantSegments(y)}else if(arguments.length===2){var _=arguments[0],P=arguments[1];this.setQuadrantSegments(_),this.setEndCapStyle(P)}else if(arguments.length===4){var $=arguments[0],ne=arguments[1],me=arguments[2],Oe=arguments[3];this.setQuadrantSegments($),this.setEndCapStyle(ne),this.setJoinStyle(me),this.setMitreLimit(Oe)}}}},{key:"bufferDistanceError",value:function(y){var _=Math.PI/2/y;return 1-Math.cos(_/2)}}])})();N.CAP_ROUND=1,N.CAP_FLAT=2,N.CAP_SQUARE=3,N.JOIN_ROUND=1,N.JOIN_MITRE=2,N.JOIN_BEVEL=3,N.DEFAULT_QUADRANT_SEGMENTS=8,N.DEFAULT_MITRE_LIMIT=5,N.DEFAULT_SIMPLIFY_FACTOR=.01;var O=(function(I){function y(_){var P;return i(this,y),(P=n(this,y,[_])).name=Object.keys({Exception:y})[0],P}return m(y,I),o(y,[{key:"toString",value:function(){return this.message}}])})(F(Error)),U=(function(I){function y(_){var P;return i(this,y),(P=n(this,y,[_])).name=Object.keys({IllegalArgumentException:y})[0],P}return m(y,I),o(y)})(O),j=(function(){return o((function I(){i(this,I)}),[{key:"filter",value:function(I){}}])})();function H(){}function W(){}function X(){}var oe,Q,G,ae,se,fe,_e,Le,ye=(function(){return o((function I(){i(this,I)}),null,[{key:"equalsWithTolerance",value:function(I,y,_){return Math.abs(I-y)<=_}}])})(),Te=(function(){return o((function I(y,_){i(this,I),this.low=_||0,this.high=y||0}),null,[{key:"toBinaryString",value:function(I){var y,_="";for(y=2147483648;y>0;y>>>=1)_+=(I.high&y)===y?"1":"0";for(y=2147483648;y>0;y>>>=1)_+=(I.low&y)===y?"1":"0";return _}}])})();function Ie(){}function Me(){}Ie.NaN=NaN,Ie.isNaN=function(I){return Number.isNaN(I)},Ie.isInfinite=function(I){return!Number.isFinite(I)},Ie.MAX_VALUE=Number.MAX_VALUE,Ie.POSITIVE_INFINITY=Number.POSITIVE_INFINITY,Ie.NEGATIVE_INFINITY=Number.NEGATIVE_INFINITY,typeof Float64Array=="function"&&typeof Int32Array=="function"?(fe=2146435072,_e=new Float64Array(1),Le=new Int32Array(_e.buffer),Ie.doubleToLongBits=function(I){_e[0]=I;var y=0|Le[0],_=0|Le[1];return(_&fe)===fe&&1048575&_&&y!==0&&(y=0,_=2146959360),new Te(_,y)},Ie.longBitsToDouble=function(I){return Le[0]=I.low,Le[1]=I.high,_e[0]}):(oe=1023,Q=Math.log2,G=Math.floor,ae=Math.pow,se=(function(){for(var I=53;I>0;I--){var y=ae(2,I)-1;if(G(Q(y))+1===I)return y}return 0})(),Ie.doubleToLongBits=function(I){var y,_,P,$,ne,me,Oe,tt,ft;if(I<0||1/I===Number.NEGATIVE_INFINITY?(me=1<<31,I=-I):me=0,I===0)return new Te(tt=me,ft=0);if(I===1/0)return new Te(tt=2146435072|me,ft=0);if(I!=I)return new Te(tt=2146959360,ft=0);if($=0,ft=0,(y=G(I))>1)if(y<=se)($=G(Q(y)))<=20?(ft=0,tt=y<<20-$&1048575):(ft=y%(_=ae(2,P=$-20))<<32-P,tt=y/_&1048575);else for(P=y,ft=0;(P=G(_=P/2))!==0;)$++,ft>>>=1,ft|=(1&tt)<<31,tt>>>=1,_!==P&&(tt|=524288);if(Oe=$+oe,ne=y===0,y=I-y,$<52&&y!==0)for(P=0;;){if((_=2*y)>=1?(y=_-1,ne?(Oe--,ne=!1):(P<<=1,P|=1,$++)):(y=_,ne?--Oe==0&&($++,ne=!1):(P<<=1,$++)),$===20)tt|=P,P=0;else if($===52){ft|=P;break}if(_===1){$<20?tt|=P<<20-$:$<52&&(ft|=P<<52-$);break}}return tt|=Oe<<20,new Te(tt|=me,ft)},Ie.longBitsToDouble=function(I){var y,_,P,$,ne=I.high,me=I.low,Oe=ne&1<<31?-1:1;for(P=((2146435072&ne)>>20)-oe,$=0,_=1<<19,y=1;y<=20;y++)ne&_&&($+=ae(2,-y)),_>>>=1;for(_=1<<31,y=21;y<=52;y++)me&_&&($+=ae(2,-y)),_>>>=1;if(P===-1023){if($===0)return 0*Oe;P=-1022}else{if(P===1024)return $===0?Oe/0:NaN;$+=1}return Oe*$*ae(2,P)});var de=(function(I){function y(_){var P;return i(this,y),(P=n(this,y,[_])).name=Object.keys({RuntimeException:y})[0],P}return m(y,I),o(y)})(O),Se=(function(I){function y(){var _;return i(this,y),_=n(this,y),y.constructor_.apply(_,arguments),_}return m(y,I),o(y,null,[{key:"constructor_",value:function(){if(arguments.length===0)de.constructor_.call(this);else if(arguments.length===1){var _=arguments[0];de.constructor_.call(this,_)}}}])})(de),we=(function(){function I(){i(this,I)}return o(I,null,[{key:"shouldNeverReachHere",value:function(){if(arguments.length===0)I.shouldNeverReachHere(null);else if(arguments.length===1){var y=arguments[0];throw new Se("Should never reach here"+(y!==null?": "+y:""))}}},{key:"isTrue",value:function(){if(arguments.length===1){var y=arguments[0];I.isTrue(y,null)}else if(arguments.length===2){var _=arguments[1];if(!arguments[0])throw _===null?new Se:new Se(_)}}},{key:"equals",value:function(){if(arguments.length===2){var y=arguments[0],_=arguments[1];I.equals(y,_,null)}else if(arguments.length===3){var P=arguments[0],$=arguments[1],ne=arguments[2];if(!$.equals(P))throw new Se("Expected "+P+" but encountered "+$+(ne!==null?": "+ne:""))}}}])})(),De=new ArrayBuffer(8),Fe=new Float64Array(De),Xe=new Int32Array(De),Be=(function(){function I(){i(this,I),I.constructor_.apply(this,arguments)}return o(I,[{key:"getM",value:function(){return Ie.NaN}},{key:"setOrdinate",value:function(y,_){switch(y){case I.X:this.x=_;break;case I.Y:this.y=_;break;case I.Z:this.setZ(_);break;default:throw new U("Invalid ordinate index: "+y)}}},{key:"equals2D",value:function(){if(arguments.length===1){var y=arguments[0];return this.x===y.x&&this.y===y.y}if(arguments.length===2){var _=arguments[0],P=arguments[1];return!!ye.equalsWithTolerance(this.x,_.x,P)&&!!ye.equalsWithTolerance(this.y,_.y,P)}}},{key:"setM",value:function(y){throw new U("Invalid ordinate index: "+I.M)}},{key:"getZ",value:function(){return this.z}},{key:"getOrdinate",value:function(y){switch(y){case I.X:return this.x;case I.Y:return this.y;case I.Z:return this.getZ()}throw new U("Invalid ordinate index: "+y)}},{key:"equals3D",value:function(y){return this.x===y.x&&this.y===y.y&&(this.getZ()===y.getZ()||Ie.isNaN(this.getZ())&&Ie.isNaN(y.getZ()))}},{key:"equals",value:function(y){return y instanceof I&&this.equals2D(y)}},{key:"equalInZ",value:function(y,_){return ye.equalsWithTolerance(this.getZ(),y.getZ(),_)}},{key:"setX",value:function(y){this.x=y}},{key:"compareTo",value:function(y){var _=y;return this.x<_.x?-1:this.x>_.x?1:this.y<_.y?-1:this.y>_.y?1:0}},{key:"getX",value:function(){return this.x}},{key:"setZ",value:function(y){this.z=y}},{key:"clone",value:function(){try{return null}catch(y){if(y instanceof CloneNotSupportedException)return we.shouldNeverReachHere("this shouldn't happen because this class is Cloneable"),null;throw y}}},{key:"copy",value:function(){return new I(this)}},{key:"toString",value:function(){return"("+this.x+", "+this.y+", "+this.getZ()+")"}},{key:"distance3D",value:function(y){var _=this.x-y.x,P=this.y-y.y,$=this.getZ()-y.getZ();return Math.sqrt(_*_+P*P+$*$)}},{key:"getY",value:function(){return this.y}},{key:"setY",value:function(y){this.y=y}},{key:"distance",value:function(y){var _=this.x-y.x,P=this.y-y.y;return Math.sqrt(_*_+P*P)}},{key:"hashCode",value:function(){var y=17;return y=37*(y=37*y+I.hashCode(this.x))+I.hashCode(this.y)}},{key:"setCoordinate",value:function(y){this.x=y.x,this.y=y.y,this.z=y.getZ()}},{key:"interfaces_",get:function(){return[H,W,X]}}],[{key:"constructor_",value:function(){if(this.x=null,this.y=null,this.z=null,arguments.length===0)I.constructor_.call(this,0,0);else if(arguments.length===1){var y=arguments[0];I.constructor_.call(this,y.x,y.y,y.getZ())}else if(arguments.length===2){var _=arguments[0],P=arguments[1];I.constructor_.call(this,_,P,I.NULL_ORDINATE)}else if(arguments.length===3){var $=arguments[0],ne=arguments[1],me=arguments[2];this.x=$,this.y=ne,this.z=me}}},{key:"hashCode",value:function(y){return Fe[0]=y,Xe[0]^Xe[1]}}])})(),st=(function(){function I(){i(this,I),I.constructor_.apply(this,arguments)}return o(I,[{key:"compare",value:function(y,_){var P=I.compare(y.x,_.x);if(P!==0)return P;var $=I.compare(y.y,_.y);return $!==0?$:this._dimensionsToTest<=2?0:I.compare(y.getZ(),_.getZ())}},{key:"interfaces_",get:function(){return[Me]}}],[{key:"constructor_",value:function(){if(this._dimensionsToTest=2,arguments.length===0)I.constructor_.call(this,2);else if(arguments.length===1){var y=arguments[0];if(y!==2&&y!==3)throw new U("only 2 or 3 dimensions may be specified");this._dimensionsToTest=y}}},{key:"compare",value:function(y,_){return y<_?-1:y>_?1:Ie.isNaN(y)?Ie.isNaN(_)?0:-1:Ie.isNaN(_)?1:0}}])})();Be.DimensionalComparator=st,Be.NULL_ORDINATE=Ie.NaN,Be.X=0,Be.Y=1,Be.Z=2,Be.M=3;var Qe=(function(){function I(){i(this,I),I.constructor_.apply(this,arguments)}return o(I,[{key:"getArea",value:function(){return this.getWidth()*this.getHeight()}},{key:"equals",value:function(y){if(!(y instanceof I))return!1;var _=y;return this.isNull()?_.isNull():this._maxx===_.getMaxX()&&this._maxy===_.getMaxY()&&this._minx===_.getMinX()&&this._miny===_.getMinY()}},{key:"intersection",value:function(y){if(this.isNull()||y.isNull()||!this.intersects(y))return new I;var _=this._minx>y._minx?this._minx:y._minx,P=this._miny>y._miny?this._miny:y._miny;return new I(_,this._maxx<y._maxx?this._maxx:y._maxx,P,this._maxy<y._maxy?this._maxy:y._maxy)}},{key:"isNull",value:function(){return this._maxx<this._minx}},{key:"getMaxX",value:function(){return this._maxx}},{key:"covers",value:function(){if(arguments.length===1){if(arguments[0]instanceof Be){var y=arguments[0];return this.covers(y.x,y.y)}if(arguments[0]instanceof I){var _=arguments[0];return!this.isNull()&&!_.isNull()&&_.getMinX()>=this._minx&&_.getMaxX()<=this._maxx&&_.getMinY()>=this._miny&&_.getMaxY()<=this._maxy}}else if(arguments.length===2){var P=arguments[0],$=arguments[1];return!this.isNull()&&P>=this._minx&&P<=this._maxx&&$>=this._miny&&$<=this._maxy}}},{key:"intersects",value:function(){if(arguments.length===1){if(arguments[0]instanceof I){var y=arguments[0];return!this.isNull()&&!y.isNull()&&!(y._minx>this._maxx||y._maxx<this._minx||y._miny>this._maxy||y._maxy<this._miny)}if(arguments[0]instanceof Be){var _=arguments[0];return this.intersects(_.x,_.y)}}else if(arguments.length===2){if(arguments[0]instanceof Be&&arguments[1]instanceof Be){var P=arguments[0],$=arguments[1];return!this.isNull()&&!((P.x<$.x?P.x:$.x)>this._maxx)&&!((P.x>$.x?P.x:$.x)<this._minx)&&!((P.y<$.y?P.y:$.y)>this._maxy)&&!((P.y>$.y?P.y:$.y)<this._miny)}if(typeof arguments[0]=="number"&&typeof arguments[1]=="number"){var ne=arguments[0],me=arguments[1];return!this.isNull()&&!(ne>this._maxx||ne<this._minx||me>this._maxy||me<this._miny)}}}},{key:"getMinY",value:function(){return this._miny}},{key:"getDiameter",value:function(){if(this.isNull())return 0;var y=this.getWidth(),_=this.getHeight();return Math.sqrt(y*y+_*_)}},{key:"getMinX",value:function(){return this._minx}},{key:"expandToInclude",value:function(){if(arguments.length===1){if(arguments[0]instanceof Be){var y=arguments[0];this.expandToInclude(y.x,y.y)}else if(arguments[0]instanceof I){var _=arguments[0];if(_.isNull())return null;this.isNull()?(this._minx=_.getMinX(),this._maxx=_.getMaxX(),this._miny=_.getMinY(),this._maxy=_.getMaxY()):(_._minx<this._minx&&(this._minx=_._minx),_._maxx>this._maxx&&(this._maxx=_._maxx),_._miny<this._miny&&(this._miny=_._miny),_._maxy>this._maxy&&(this._maxy=_._maxy))}}else if(arguments.length===2){var P=arguments[0],$=arguments[1];this.isNull()?(this._minx=P,this._maxx=P,this._miny=$,this._maxy=$):(P<this._minx&&(this._minx=P),P>this._maxx&&(this._maxx=P),$<this._miny&&(this._miny=$),$>this._maxy&&(this._maxy=$))}}},{key:"minExtent",value:function(){if(this.isNull())return 0;var y=this.getWidth(),_=this.getHeight();return y<_?y:_}},{key:"getWidth",value:function(){return this.isNull()?0:this._maxx-this._minx}},{key:"compareTo",value:function(y){var _=y;return this.isNull()?_.isNull()?0:-1:_.isNull()?1:this._minx<_._minx?-1:this._minx>_._minx?1:this._miny<_._miny?-1:this._miny>_._miny?1:this._maxx<_._maxx?-1:this._maxx>_._maxx?1:this._maxy<_._maxy?-1:this._maxy>_._maxy?1:0}},{key:"translate",value:function(y,_){if(this.isNull())return null;this.init(this.getMinX()+y,this.getMaxX()+y,this.getMinY()+_,this.getMaxY()+_)}},{key:"copy",value:function(){return new I(this)}},{key:"toString",value:function(){return"Env["+this._minx+" : "+this._maxx+", "+this._miny+" : "+this._maxy+"]"}},{key:"setToNull",value:function(){this._minx=0,this._maxx=-1,this._miny=0,this._maxy=-1}},{key:"disjoint",value:function(y){return!(!this.isNull()&&!y.isNull())||y._minx>this._maxx||y._maxx<this._minx||y._miny>this._maxy||y._maxy<this._miny}},{key:"getHeight",value:function(){return this.isNull()?0:this._maxy-this._miny}},{key:"maxExtent",value:function(){if(this.isNull())return 0;var y=this.getWidth(),_=this.getHeight();return y>_?y:_}},{key:"expandBy",value:function(){if(arguments.length===1){var y=arguments[0];this.expandBy(y,y)}else if(arguments.length===2){var _=arguments[0],P=arguments[1];if(this.isNull())return null;this._minx-=_,this._maxx+=_,this._miny-=P,this._maxy+=P,(this._minx>this._maxx||this._miny>this._maxy)&&this.setToNull()}}},{key:"contains",value:function(){if(arguments.length===1){if(arguments[0]instanceof I){var y=arguments[0];return this.covers(y)}if(arguments[0]instanceof Be){var _=arguments[0];return this.covers(_)}}else if(arguments.length===2){var P=arguments[0],$=arguments[1];return this.covers(P,$)}}},{key:"centre",value:function(){return this.isNull()?null:new Be((this.getMinX()+this.getMaxX())/2,(this.getMinY()+this.getMaxY())/2)}},{key:"init",value:function(){if(arguments.length===0)this.setToNull();else if(arguments.length===1){if(arguments[0]instanceof Be){var y=arguments[0];this.init(y.x,y.x,y.y,y.y)}else if(arguments[0]instanceof I){var _=arguments[0];this._minx=_._minx,this._maxx=_._maxx,this._miny=_._miny,this._maxy=_._maxy}}else if(arguments.length===2){var P=arguments[0],$=arguments[1];this.init(P.x,$.x,P.y,$.y)}else if(arguments.length===4){var ne=arguments[0],me=arguments[1],Oe=arguments[2],tt=arguments[3];ne<me?(this._minx=ne,this._maxx=me):(this._minx=me,this._maxx=ne),Oe<tt?(this._miny=Oe,this._maxy=tt):(this._miny=tt,this._maxy=Oe)}}},{key:"getMaxY",value:function(){return this._maxy}},{key:"distance",value:function(y){if(this.intersects(y))return 0;var _=0;this._maxx<y._minx?_=y._minx-this._maxx:this._minx>y._maxx&&(_=this._minx-y._maxx);var P=0;return this._maxy<y._miny?P=y._miny-this._maxy:this._miny>y._maxy&&(P=this._miny-y._maxy),_===0?P:P===0?_:Math.sqrt(_*_+P*P)}},{key:"hashCode",value:function(){var y=17;return y=37*(y=37*(y=37*(y=37*y+Be.hashCode(this._minx))+Be.hashCode(this._maxx))+Be.hashCode(this._miny))+Be.hashCode(this._maxy)}},{key:"interfaces_",get:function(){return[H,X]}}],[{key:"constructor_",value:function(){if(this._minx=null,this._maxx=null,this._miny=null,this._maxy=null,arguments.length===0)this.init();else if(arguments.length===1){if(arguments[0]instanceof Be){var y=arguments[0];this.init(y.x,y.x,y.y,y.y)}else if(arguments[0]instanceof I){var _=arguments[0];this.init(_)}}else if(arguments.length===2){var P=arguments[0],$=arguments[1];this.init(P.x,$.x,P.y,$.y)}else if(arguments.length===4){var ne=arguments[0],me=arguments[1],Oe=arguments[2],tt=arguments[3];this.init(ne,me,Oe,tt)}}},{key:"intersects",value:function(){if(arguments.length===3){var y=arguments[0],_=arguments[1],P=arguments[2];return P.x>=(y.x<_.x?y.x:_.x)&&P.x<=(y.x>_.x?y.x:_.x)&&P.y>=(y.y<_.y?y.y:_.y)&&P.y<=(y.y>_.y?y.y:_.y)}if(arguments.length===4){var $=arguments[0],ne=arguments[1],me=arguments[2],Oe=arguments[3],tt=Math.min(me.x,Oe.x),ft=Math.max(me.x,Oe.x),rr=Math.min($.x,ne.x),ur=Math.max($.x,ne.x);return!(rr>ft)&&!(ur<tt)&&(tt=Math.min(me.y,Oe.y),ft=Math.max(me.y,Oe.y),rr=Math.min($.y,ne.y),ur=Math.max($.y,ne.y),!(rr>ft)&&!(ur<tt))}}}])})(),it=(function(){function I(){i(this,I),I.constructor_.apply(this,arguments)}return o(I,[{key:"isGeometryCollection",value:function(){return this.getTypeCode()===I.TYPECODE_GEOMETRYCOLLECTION}},{key:"getFactory",value:function(){return this._factory}},{key:"getGeometryN",value:function(y){return this}},{key:"getArea",value:function(){return 0}},{key:"isRectangle",value:function(){return!1}},{key:"equalsExact",value:function(y){return this===y||this.equalsExact(y,0)}},{key:"geometryChanged",value:function(){this.apply(I.geometryChangedFilter)}},{key:"geometryChangedAction",value:function(){this._envelope=null}},{key:"equalsNorm",value:function(y){return y!==null&&this.norm().equalsExact(y.norm())}},{key:"getLength",value:function(){return 0}},{key:"getNumGeometries",value:function(){return 1}},{key:"compareTo",value:function(){var y;if(arguments.length===1){var _=arguments[0];return y=_,this.getTypeCode()!==y.getTypeCode()?this.getTypeCode()-y.getTypeCode():this.isEmpty()&&y.isEmpty()?0:this.isEmpty()?-1:y.isEmpty()?1:this.compareToSameClass(_)}if(arguments.length===2){var P=arguments[0],$=arguments[1];return y=P,this.getTypeCode()!==y.getTypeCode()?this.getTypeCode()-y.getTypeCode():this.isEmpty()&&y.isEmpty()?0:this.isEmpty()?-1:y.isEmpty()?1:this.compareToSameClass(P,$)}}},{key:"getUserData",value:function(){return this._userData}},{key:"getSRID",value:function(){return this._SRID}},{key:"getEnvelope",value:function(){return this.getFactory().toGeometry(this.getEnvelopeInternal())}},{key:"checkNotGeometryCollection",value:function(y){if(y.getTypeCode()===I.TYPECODE_GEOMETRYCOLLECTION)throw new U("This method does not support GeometryCollection arguments")}},{key:"equal",value:function(y,_,P){return P===0?y.equals(_):y.distance(_)<=P}},{key:"norm",value:function(){var y=this.copy();return y.normalize(),y}},{key:"reverse",value:function(){var y=this.reverseInternal();return this.envelope!=null&&(y.envelope=this.envelope.copy()),y.setSRID(this.getSRID()),y}},{key:"copy",value:function(){var y=this.copyInternal();return y.envelope=this._envelope==null?null:this._envelope.copy(),y._SRID=this._SRID,y._userData=this._userData,y}},{key:"getPrecisionModel",value:function(){return this._factory.getPrecisionModel()}},{key:"getEnvelopeInternal",value:function(){return this._envelope===null&&(this._envelope=this.computeEnvelopeInternal()),new Qe(this._envelope)}},{key:"setSRID",value:function(y){this._SRID=y}},{key:"setUserData",value:function(y){this._userData=y}},{key:"compare",value:function(y,_){for(var P=y.iterator(),$=_.iterator();P.hasNext()&&$.hasNext();){var ne=P.next(),me=$.next(),Oe=ne.compareTo(me);if(Oe!==0)return Oe}return P.hasNext()?1:$.hasNext()?-1:0}},{key:"hashCode",value:function(){return this.getEnvelopeInternal().hashCode()}},{key:"isEquivalentClass",value:function(y){return this.getClass()===y.getClass()}},{key:"isGeometryCollectionOrDerived",value:function(){return this.getTypeCode()===I.TYPECODE_GEOMETRYCOLLECTION||this.getTypeCode()===I.TYPECODE_MULTIPOINT||this.getTypeCode()===I.TYPECODE_MULTILINESTRING||this.getTypeCode()===I.TYPECODE_MULTIPOLYGON}},{key:"interfaces_",get:function(){return[W,H,X]}},{key:"getClass",value:function(){return I}}],[{key:"hasNonEmptyElements",value:function(y){for(var _=0;_<y.length;_++)if(!y[_].isEmpty())return!0;return!1}},{key:"hasNullElements",value:function(y){for(var _=0;_<y.length;_++)if(y[_]===null)return!0;return!1}}])})();it.constructor_=function(I){I&&(this._envelope=null,this._userData=null,this._factory=I,this._SRID=I.getSRID())},it.TYPECODE_POINT=0,it.TYPECODE_MULTIPOINT=1,it.TYPECODE_LINESTRING=2,it.TYPECODE_LINEARRING=3,it.TYPECODE_MULTILINESTRING=4,it.TYPECODE_POLYGON=5,it.TYPECODE_MULTIPOLYGON=6,it.TYPECODE_GEOMETRYCOLLECTION=7,it.TYPENAME_POINT="Point",it.TYPENAME_MULTIPOINT="MultiPoint",it.TYPENAME_LINESTRING="LineString",it.TYPENAME_LINEARRING="LinearRing",it.TYPENAME_MULTILINESTRING="MultiLineString",it.TYPENAME_POLYGON="Polygon",it.TYPENAME_MULTIPOLYGON="MultiPolygon",it.TYPENAME_GEOMETRYCOLLECTION="GeometryCollection",it.geometryChangedFilter={get interfaces_(){return[j]},filter:function(I){I.geometryChangedAction()}};var be=(function(){function I(){i(this,I)}return o(I,null,[{key:"toLocationSymbol",value:function(y){switch(y){case I.EXTERIOR:return"e";case I.BOUNDARY:return"b";case I.INTERIOR:return"i";case I.NONE:return"-"}throw new U("Unknown location value: "+y)}}])})();be.INTERIOR=0,be.BOUNDARY=1,be.EXTERIOR=2,be.NONE=-1;var Ot=(function(){return o((function I(){i(this,I)}),[{key:"add",value:function(){}},{key:"addAll",value:function(){}},{key:"isEmpty",value:function(){}},{key:"iterator",value:function(){}},{key:"size",value:function(){}},{key:"toArray",value:function(){}},{key:"remove",value:function(){}}])})(),at=(function(I){function y(_){var P;return i(this,y),(P=n(this,y,[_])).name=Object.keys({NoSuchElementException:y})[0],P}return m(y,I),o(y)})(O),$e=(function(I){function y(_){var P;return i(this,y),(P=n(this,y,[_])).name=Object.keys({UnsupportedOperationException:y})[0],P}return m(y,I),o(y)})(O),Xt=(function(I){function y(){return i(this,y),n(this,y,arguments)}return m(y,I),o(y,[{key:"contains",value:function(){}}])})(Ot),$t=(function(I){function y(_){var P;return i(this,y),(P=n(this,y)).map=new Map,_ instanceof Ot&&P.addAll(_),P}return m(y,I),o(y,[{key:"contains",value:function(_){var P=_.hashCode?_.hashCode():_;return!!this.map.has(P)}},{key:"add",value:function(_){var P=_.hashCode?_.hashCode():_;return!this.map.has(P)&&!!this.map.set(P,_)}},{key:"addAll",value:function(_){var P,$=c(_);try{for($.s();!(P=$.n()).done;){var ne=P.value;this.add(ne)}}catch(me){$.e(me)}finally{$.f()}return!0}},{key:"remove",value:function(){throw new $e}},{key:"size",value:function(){return this.map.size}},{key:"isEmpty",value:function(){return this.map.size===0}},{key:"toArray",value:function(){return Array.from(this.map.values())}},{key:"iterator",value:function(){return new cr(this.map)}},{key:Symbol.iterator,value:function(){return this.map}}])})(Xt),cr=(function(){return o((function I(y){i(this,I),this.iterator=y.values();var _=this.iterator.next(),P=_.done,$=_.value;this.done=P,this.value=$}),[{key:"next",value:function(){if(this.done)throw new at;var I=this.value,y=this.iterator.next(),_=y.done,P=y.value;return this.done=_,this.value=P,I}},{key:"hasNext",value:function(){return!this.done}},{key:"remove",value:function(){throw new $e}}])})(),_t=(function(){function I(){i(this,I)}return o(I,null,[{key:"opposite",value:function(y){return y===I.LEFT?I.RIGHT:y===I.RIGHT?I.LEFT:y}}])})();_t.ON=0,_t.LEFT=1,_t.RIGHT=2;var gr=(function(I){function y(_){var P;return i(this,y),(P=n(this,y,[_])).name=Object.keys({EmptyStackException:y})[0],P}return m(y,I),o(y)})(O),mr=(function(I){function y(_){var P;return i(this,y),(P=n(this,y,[_])).name=Object.keys({IndexOutOfBoundsException:y})[0],P}return m(y,I),o(y)})(O),ar=(function(I){function y(){return i(this,y),n(this,y,arguments)}return m(y,I),o(y,[{key:"get",value:function(){}},{key:"set",value:function(){}},{key:"isEmpty",value:function(){}}])})(Ot),Cr=(function(I){function y(){var _;return i(this,y),(_=n(this,y)).array=[],_}return m(y,I),o(y,[{key:"add",value:function(_){return this.array.push(_),!0}},{key:"get",value:function(_){if(_<0||_>=this.size())throw new mr;return this.array[_]}},{key:"push",value:function(_){return this.array.push(_),_}},{key:"pop",value:function(){if(this.array.length===0)throw new gr;return this.array.pop()}},{key:"peek",value:function(){if(this.array.length===0)throw new gr;return this.array[this.array.length-1]}},{key:"empty",value:function(){return this.array.length===0}},{key:"isEmpty",value:function(){return this.empty()}},{key:"search",value:function(_){return this.array.indexOf(_)}},{key:"size",value:function(){return this.array.length}},{key:"toArray",value:function(){return this.array.slice()}}])})(ar);function Er(I,y){return I.interfaces_&&I.interfaces_.indexOf(y)>-1}var Jt=(function(){return o((function I(y){i(this,I),this.str=y}),[{key:"append",value:function(I){this.str+=I}},{key:"setCharAt",value:function(I,y){this.str=this.str.substr(0,I)+y+this.str.substr(I+1)}},{key:"toString",value:function(){return this.str}}])})(),ot=(function(){function I(y){i(this,I),this.value=y}return o(I,[{key:"intValue",value:function(){return this.value}},{key:"compareTo",value:function(y){return this.value<y?-1:this.value>y?1:0}}],[{key:"compare",value:function(y,_){return y<_?-1:y>_?1:0}},{key:"isNan",value:function(y){return Number.isNaN(y)}},{key:"valueOf",value:function(y){return new I(y)}}])})(),Ce=(function(){return o((function I(){i(this,I)}),null,[{key:"isWhitespace",value:function(I){return I<=32&&I>=0||I===127}},{key:"toUpperCase",value:function(I){return I.toUpperCase()}}])})(),xe=(function(){function I(){i(this,I),I.constructor_.apply(this,arguments)}return o(I,[{key:"le",value:function(y){return this._hi<y._hi||this._hi===y._hi&&this._lo<=y._lo}},{key:"extractSignificantDigits",value:function(y,_){var P=this.abs(),$=I.magnitude(P._hi),ne=I.TEN.pow($);(P=P.divide(ne)).gt(I.TEN)?(P=P.divide(I.TEN),$+=1):P.lt(I.ONE)&&(P=P.multiply(I.TEN),$-=1);for(var me=$+1,Oe=new Jt,tt=I.MAX_PRINT_DIGITS-1,ft=0;ft<=tt;ft++){y&&ft===me&&Oe.append(".");var rr=Math.trunc(P._hi);if(rr<0)break;var ur=!1,qr=0;rr>9?(ur=!0,qr="9"):qr="0"+rr,Oe.append(qr),P=P.subtract(I.valueOf(rr)).multiply(I.TEN),ur&&P.selfAdd(I.TEN);var bn=!0,Dn=I.magnitude(P._hi);if(Dn<0&&Math.abs(Dn)>=tt-ft&&(bn=!1),!bn)break}return _[0]=$,Oe.toString()}},{key:"sqr",value:function(){return this.multiply(this)}},{key:"doubleValue",value:function(){return this._hi+this._lo}},{key:"subtract",value:function(){if(arguments[0]instanceof I){var y=arguments[0];return this.add(y.negate())}if(typeof arguments[0]=="number"){var _=arguments[0];return this.add(-_)}}},{key:"equals",value:function(){if(arguments.length===1&&arguments[0]instanceof I){var y=arguments[0];return this._hi===y._hi&&this._lo===y._lo}}},{key:"isZero",value:function(){return this._hi===0&&this._lo===0}},{key:"selfSubtract",value:function(){if(arguments[0]instanceof I){var y=arguments[0];return this.isNaN()?this:this.selfAdd(-y._hi,-y._lo)}if(typeof arguments[0]=="number"){var _=arguments[0];return this.isNaN()?this:this.selfAdd(-_,0)}}},{key:"getSpecialNumberString",value:function(){return this.isZero()?"0.0":this.isNaN()?"NaN ":null}},{key:"min",value:function(y){return this.le(y)?this:y}},{key:"selfDivide",value:function(){if(arguments.length===1){if(arguments[0]instanceof I){var y=arguments[0];return this.selfDivide(y._hi,y._lo)}if(typeof arguments[0]=="number"){var _=arguments[0];return this.selfDivide(_,0)}}else if(arguments.length===2){var P,$,ne,me,Oe=arguments[0],tt=arguments[1],ft=null,rr=null,ur=null,qr=null;return ne=this._hi/Oe,qr=(ft=(ur=I.SPLIT*ne)-(ft=ur-ne))*(rr=(qr=I.SPLIT*Oe)-(rr=qr-Oe))-(me=ne*Oe)+ft*($=Oe-rr)+(P=ne-ft)*rr+P*$,qr=ne+(ur=(this._hi-me-qr+this._lo-ne*tt)/Oe),this._hi=qr,this._lo=ne-qr+ur,this}}},{key:"dump",value:function(){return"DD<"+this._hi+", "+this._lo+">"}},{key:"divide",value:function(){if(arguments[0]instanceof I){var y,_,P,$,ne=arguments[0],me=null,Oe=null,tt=null,ft=null;return y=(P=this._hi/ne._hi)-(me=(tt=I.SPLIT*P)-(me=tt-P)),ft=me*(Oe=(ft=I.SPLIT*ne._hi)-(Oe=ft-ne._hi))-($=P*ne._hi)+me*(_=ne._hi-Oe)+y*Oe+y*_,new I(ft=P+(tt=(this._hi-$-ft+this._lo-P*ne._lo)/ne._hi),P-ft+tt)}if(typeof arguments[0]=="number"){var rr=arguments[0];return Ie.isNaN(rr)?I.createNaN():I.copy(this).selfDivide(rr,0)}}},{key:"ge",value:function(y){return this._hi>y._hi||this._hi===y._hi&&this._lo>=y._lo}},{key:"pow",value:function(y){if(y===0)return I.valueOf(1);var _=new I(this),P=I.valueOf(1),$=Math.abs(y);if($>1)for(;$>0;)$%2==1&&P.selfMultiply(_),($/=2)>0&&(_=_.sqr());else P=_;return y<0?P.reciprocal():P}},{key:"ceil",value:function(){if(this.isNaN())return I.NaN;var y=Math.ceil(this._hi),_=0;return y===this._hi&&(_=Math.ceil(this._lo)),new I(y,_)}},{key:"compareTo",value:function(y){var _=y;return this._hi<_._hi?-1:this._hi>_._hi?1:this._lo<_._lo?-1:this._lo>_._lo?1:0}},{key:"rint",value:function(){return this.isNaN()?this:this.add(.5).floor()}},{key:"setValue",value:function(){if(arguments[0]instanceof I){var y=arguments[0];return this.init(y),this}if(typeof arguments[0]=="number"){var _=arguments[0];return this.init(_),this}}},{key:"max",value:function(y){return this.ge(y)?this:y}},{key:"sqrt",value:function(){if(this.isZero())return I.valueOf(0);if(this.isNegative())return I.NaN;var y=1/Math.sqrt(this._hi),_=this._hi*y,P=I.valueOf(_),$=this.subtract(P.sqr())._hi*(.5*y);return P.add($)}},{key:"selfAdd",value:function(){if(arguments.length===1){if(arguments[0]instanceof I){var y=arguments[0];return this.selfAdd(y._hi,y._lo)}if(typeof arguments[0]=="number"){var _,P,$,ne,me,Oe=arguments[0],tt=null;return tt=($=this._hi+Oe)-(ne=$-this._hi),P=(me=(tt=Oe-ne+(this._hi-tt))+this._lo)+($-(_=$+me)),this._hi=_+P,this._lo=P+(_-this._hi),this}}else if(arguments.length===2){var ft,rr,ur,qr,bn=arguments[0],Dn=arguments[1],Xn=null,Fn=null,En=null;ur=this._hi+bn,rr=this._lo+Dn,Fn=ur-(En=ur-this._hi),Xn=rr-(qr=rr-this._lo);var na=(ft=ur+(En=(Fn=bn-En+(this._hi-Fn))+rr))+(En=(Xn=Dn-qr+(this._lo-Xn))+(En+(ur-ft))),ca=En+(ft-na);return this._hi=na,this._lo=ca,this}}},{key:"selfMultiply",value:function(){if(arguments.length===1){if(arguments[0]instanceof I){var y=arguments[0];return this.selfMultiply(y._hi,y._lo)}if(typeof arguments[0]=="number"){var _=arguments[0];return this.selfMultiply(_,0)}}else if(arguments.length===2){var P,$,ne=arguments[0],me=arguments[1],Oe=null,tt=null,ft=null,rr=null;Oe=(ft=I.SPLIT*this._hi)-this._hi,rr=I.SPLIT*ne,Oe=ft-Oe,P=this._hi-Oe,tt=rr-ne;var ur=(ft=this._hi*ne)+(rr=Oe*(tt=rr-tt)-ft+Oe*($=ne-tt)+P*tt+P*$+(this._hi*me+this._lo*ne)),qr=rr+(Oe=ft-ur);return this._hi=ur,this._lo=qr,this}}},{key:"selfSqr",value:function(){return this.selfMultiply(this)}},{key:"floor",value:function(){if(this.isNaN())return I.NaN;var y=Math.floor(this._hi),_=0;return y===this._hi&&(_=Math.floor(this._lo)),new I(y,_)}},{key:"negate",value:function(){return this.isNaN()?this:new I(-this._hi,-this._lo)}},{key:"clone",value:function(){try{return null}catch(y){if(y instanceof CloneNotSupportedException)return null;throw y}}},{key:"multiply",value:function(){if(arguments[0]instanceof I){var y=arguments[0];return y.isNaN()?I.createNaN():I.copy(this).selfMultiply(y)}if(typeof arguments[0]=="number"){var _=arguments[0];return Ie.isNaN(_)?I.createNaN():I.copy(this).selfMultiply(_,0)}}},{key:"isNaN",value:function(){return Ie.isNaN(this._hi)}},{key:"intValue",value:function(){return Math.trunc(this._hi)}},{key:"toString",value:function(){var y=I.magnitude(this._hi);return y>=-3&&y<=20?this.toStandardNotation():this.toSciNotation()}},{key:"toStandardNotation",value:function(){var y=this.getSpecialNumberString();if(y!==null)return y;var _=new Array(1).fill(null),P=this.extractSignificantDigits(!0,_),$=_[0]+1,ne=P;if(P.charAt(0)===".")ne="0"+P;else if($<0)ne="0."+I.stringOfChar("0",-$)+P;else if(P.indexOf(".")===-1){var me=$-P.length;ne=P+I.stringOfChar("0",me)+".0"}return this.isNegative()?"-"+ne:ne}},{key:"reciprocal",value:function(){var y,_,P,$,ne=null,me=null,Oe=null,tt=null;y=(P=1/this._hi)-(ne=(Oe=I.SPLIT*P)-(ne=Oe-P)),me=(tt=I.SPLIT*this._hi)-this._hi;var ft=P+(Oe=(1-($=P*this._hi)-(tt=ne*(me=tt-me)-$+ne*(_=this._hi-me)+y*me+y*_)-P*this._lo)/this._hi);return new I(ft,P-ft+Oe)}},{key:"toSciNotation",value:function(){if(this.isZero())return I.SCI_NOT_ZERO;var y=this.getSpecialNumberString();if(y!==null)return y;var _=new Array(1).fill(null),P=this.extractSignificantDigits(!1,_),$=I.SCI_NOT_EXPONENT_CHAR+_[0];if(P.charAt(0)==="0")throw new IllegalStateException("Found leading zero: "+P);var ne="";P.length>1&&(ne=P.substring(1));var me=P.charAt(0)+"."+ne;return this.isNegative()?"-"+me+$:me+$}},{key:"abs",value:function(){return this.isNaN()?I.NaN:this.isNegative()?this.negate():new I(this)}},{key:"isPositive",value:function(){return this._hi>0||this._hi===0&&this._lo>0}},{key:"lt",value:function(y){return this._hi<y._hi||this._hi===y._hi&&this._lo<y._lo}},{key:"add",value:function(){if(arguments[0]instanceof I){var y=arguments[0];return I.copy(this).selfAdd(y)}if(typeof arguments[0]=="number"){var _=arguments[0];return I.copy(this).selfAdd(_)}}},{key:"init",value:function(){if(arguments.length===1){if(typeof arguments[0]=="number"){var y=arguments[0];this._hi=y,this._lo=0}else if(arguments[0]instanceof I){var _=arguments[0];this._hi=_._hi,this._lo=_._lo}}else if(arguments.length===2){var P=arguments[0],$=arguments[1];this._hi=P,this._lo=$}}},{key:"gt",value:function(y){return this._hi>y._hi||this._hi===y._hi&&this._lo>y._lo}},{key:"isNegative",value:function(){return this._hi<0||this._hi===0&&this._lo<0}},{key:"trunc",value:function(){return this.isNaN()?I.NaN:this.isPositive()?this.floor():this.ceil()}},{key:"signum",value:function(){return this._hi>0?1:this._hi<0?-1:this._lo>0?1:this._lo<0?-1:0}},{key:"interfaces_",get:function(){return[X,H,W]}}],[{key:"constructor_",value:function(){if(this._hi=0,this._lo=0,arguments.length===0)this.init(0);else if(arguments.length===1){if(typeof arguments[0]=="number"){var y=arguments[0];this.init(y)}else if(arguments[0]instanceof I){var _=arguments[0];this.init(_)}else if(typeof arguments[0]=="string"){var P=arguments[0];I.constructor_.call(this,I.parse(P))}}else if(arguments.length===2){var $=arguments[0],ne=arguments[1];this.init($,ne)}}},{key:"determinant",value:function(){if(typeof arguments[3]=="number"&&typeof arguments[2]=="number"&&typeof arguments[0]=="number"&&typeof arguments[1]=="number"){var y=arguments[0],_=arguments[1],P=arguments[2],$=arguments[3];return I.determinant(I.valueOf(y),I.valueOf(_),I.valueOf(P),I.valueOf($))}if(arguments[3]instanceof I&&arguments[2]instanceof I&&arguments[0]instanceof I&&arguments[1]instanceof I){var ne=arguments[1],me=arguments[2],Oe=arguments[3];return arguments[0].multiply(Oe).selfSubtract(ne.multiply(me))}}},{key:"sqr",value:function(y){return I.valueOf(y).selfMultiply(y)}},{key:"valueOf",value:function(){if(typeof arguments[0]=="string"){var y=arguments[0];return I.parse(y)}if(typeof arguments[0]=="number")return new I(arguments[0])}},{key:"sqrt",value:function(y){return I.valueOf(y).sqrt()}},{key:"parse",value:function(y){for(var _=0,P=y.length;Ce.isWhitespace(y.charAt(_));)_++;var $=!1;if(_<P){var ne=y.charAt(_);ne!=="-"&&ne!=="+"||(_++,ne==="-"&&($=!0))}for(var me=new I,Oe=0,tt=0,ft=0,rr=!1;!(_>=P);){var ur=y.charAt(_);if(_++,Ce.isDigit(ur)){var qr=ur-"0";me.selfMultiply(I.TEN),me.selfAdd(qr),Oe++}else{if(ur!=="."){if(ur==="e"||ur==="E"){var bn=y.substring(_);try{ft=ot.parseInt(bn)}catch(na){throw na instanceof NumberFormatException?new NumberFormatException("Invalid exponent "+bn+" in string "+y):na}break}throw new NumberFormatException("Unexpected character '"+ur+"' at position "+_+" in string "+y)}tt=Oe,rr=!0}}var Dn=me;rr||(tt=Oe);var Xn=Oe-tt-ft;if(Xn===0)Dn=me;else if(Xn>0){var Fn=I.TEN.pow(Xn);Dn=me.divide(Fn)}else if(Xn<0){var En=I.TEN.pow(-Xn);Dn=me.multiply(En)}return $?Dn.negate():Dn}},{key:"createNaN",value:function(){return new I(Ie.NaN,Ie.NaN)}},{key:"copy",value:function(y){return new I(y)}},{key:"magnitude",value:function(y){var _=Math.abs(y),P=Math.log(_)/Math.log(10),$=Math.trunc(Math.floor(P));return 10*Math.pow(10,$)<=_&&($+=1),$}},{key:"stringOfChar",value:function(y,_){for(var P=new Jt,$=0;$<_;$++)P.append(y);return P.toString()}}])})();xe.PI=new xe(3.141592653589793,12246467991473532e-32),xe.TWO_PI=new xe(6.283185307179586,24492935982947064e-32),xe.PI_2=new xe(1.5707963267948966,6123233995736766e-32),xe.E=new xe(2.718281828459045,14456468917292502e-32),xe.NaN=new xe(Ie.NaN,Ie.NaN),xe.EPS=123259516440783e-46,xe.SPLIT=134217729,xe.MAX_PRINT_DIGITS=32,xe.TEN=xe.valueOf(10),xe.ONE=xe.valueOf(1),xe.SCI_NOT_EXPONENT_CHAR="E",xe.SCI_NOT_ZERO="0.0E0";var je=(function(){function I(){i(this,I)}return o(I,null,[{key:"orientationIndex",value:function(y,_,P){var $=I.orientationIndexFilter(y,_,P);if($<=1)return $;var ne=xe.valueOf(_.x).selfAdd(-y.x),me=xe.valueOf(_.y).selfAdd(-y.y),Oe=xe.valueOf(P.x).selfAdd(-_.x),tt=xe.valueOf(P.y).selfAdd(-_.y);return ne.selfMultiply(tt).selfSubtract(me.selfMultiply(Oe)).signum()}},{key:"signOfDet2x2",value:function(){if(arguments[3]instanceof xe&&arguments[2]instanceof xe&&arguments[0]instanceof xe&&arguments[1]instanceof xe){var y=arguments[1],_=arguments[2],P=arguments[3];return arguments[0].multiply(P).selfSubtract(y.multiply(_)).signum()}if(typeof arguments[3]=="number"&&typeof arguments[2]=="number"&&typeof arguments[0]=="number"&&typeof arguments[1]=="number"){var $=arguments[0],ne=arguments[1],me=arguments[2],Oe=arguments[3],tt=xe.valueOf($),ft=xe.valueOf(ne),rr=xe.valueOf(me),ur=xe.valueOf(Oe);return tt.multiply(ur).selfSubtract(ft.multiply(rr)).signum()}}},{key:"intersection",value:function(y,_,P,$){var ne=new xe(y.y).selfSubtract(_.y),me=new xe(_.x).selfSubtract(y.x),Oe=new xe(y.x).selfMultiply(_.y).selfSubtract(new xe(_.x).selfMultiply(y.y)),tt=new xe(P.y).selfSubtract($.y),ft=new xe($.x).selfSubtract(P.x),rr=new xe(P.x).selfMultiply($.y).selfSubtract(new xe($.x).selfMultiply(P.y)),ur=me.multiply(rr).selfSubtract(ft.multiply(Oe)),qr=tt.multiply(Oe).selfSubtract(ne.multiply(rr)),bn=ne.multiply(ft).selfSubtract(tt.multiply(me)),Dn=ur.selfDivide(bn).doubleValue(),Xn=qr.selfDivide(bn).doubleValue();return Ie.isNaN(Dn)||Ie.isInfinite(Dn)||Ie.isNaN(Xn)||Ie.isInfinite(Xn)?null:new Be(Dn,Xn)}},{key:"orientationIndexFilter",value:function(y,_,P){var $=null,ne=(y.x-P.x)*(_.y-P.y),me=(y.y-P.y)*(_.x-P.x),Oe=ne-me;if(ne>0){if(me<=0)return I.signum(Oe);$=ne+me}else{if(!(ne<0)||me>=0)return I.signum(Oe);$=-ne-me}var tt=I.DP_SAFE_EPSILON*$;return Oe>=tt||-Oe>=tt?I.signum(Oe):2}},{key:"signum",value:function(y){return y>0?1:y<0?-1:0}}])})();je.DP_SAFE_EPSILON=1e-15;var qe=(function(){return o((function I(){i(this,I)}),[{key:"getM",value:function(I){if(this.hasM()){var y=this.getDimension()-this.getMeasures();return this.getOrdinate(I,y)}return Ie.NaN}},{key:"setOrdinate",value:function(I,y,_){}},{key:"getZ",value:function(I){return this.hasZ()?this.getOrdinate(I,2):Ie.NaN}},{key:"size",value:function(){}},{key:"getOrdinate",value:function(I,y){}},{key:"getCoordinate",value:function(){}},{key:"getCoordinateCopy",value:function(I){}},{key:"createCoordinate",value:function(){}},{key:"getDimension",value:function(){}},{key:"hasM",value:function(){return this.getMeasures()>0}},{key:"getX",value:function(I){}},{key:"hasZ",value:function(){return this.getDimension()-this.getMeasures()>2}},{key:"getMeasures",value:function(){return 0}},{key:"expandEnvelope",value:function(I){}},{key:"copy",value:function(){}},{key:"getY",value:function(I){}},{key:"toCoordinateArray",value:function(){}},{key:"interfaces_",get:function(){return[W]}}])})();qe.X=0,qe.Y=1,qe.Z=2,qe.M=3;var Ge=(function(){function I(){i(this,I)}return o(I,null,[{key:"index",value:function(y,_,P){return je.orientationIndex(y,_,P)}},{key:"isCCW",value:function(){if(arguments[0]instanceof Array){var y=arguments[0],_=y.length-1;if(_<3)throw new U("Ring has fewer than 4 points, so orientation cannot be determined");for(var P=y[0],$=0,ne=1;ne<=_;ne++){var me=y[ne];me.y>P.y&&(P=me,$=ne)}var Oe=$;do(Oe-=1)<0&&(Oe=_);while(y[Oe].equals2D(P)&&Oe!==$);var tt=$;do tt=(tt+1)%_;while(y[tt].equals2D(P)&&tt!==$);var ft=y[Oe],rr=y[tt];if(ft.equals2D(P)||rr.equals2D(P)||ft.equals2D(rr))return!1;var ur=I.index(ft,P,rr);return ur===0?ft.x>rr.x:ur>0}if(Er(arguments[0],qe)){var qr=arguments[0],bn=qr.size()-1;if(bn<3)throw new U("Ring has fewer than 4 points, so orientation cannot be determined");for(var Dn=qr.getCoordinate(0),Xn=0,Fn=1;Fn<=bn;Fn++){var En=qr.getCoordinate(Fn);En.y>Dn.y&&(Dn=En,Xn=Fn)}var na=null,ca=Xn;do(ca-=1)<0&&(ca=bn),na=qr.getCoordinate(ca);while(na.equals2D(Dn)&&ca!==Xn);var so=null,ka=Xn;do ka=(ka+1)%bn,so=qr.getCoordinate(ka);while(so.equals2D(Dn)&&ka!==Xn);if(na.equals2D(Dn)||so.equals2D(Dn)||na.equals2D(so))return!1;var Ho=I.index(na,Dn,so);return Ho===0?na.x>so.x:Ho>0}}}])})();Ge.CLOCKWISE=-1,Ge.RIGHT=Ge.CLOCKWISE,Ge.COUNTERCLOCKWISE=1,Ge.LEFT=Ge.COUNTERCLOCKWISE,Ge.COLLINEAR=0,Ge.STRAIGHT=Ge.COLLINEAR;var Ft=(function(){return o((function I(){i(this,I),I.constructor_.apply(this,arguments)}),[{key:"getCoordinate",value:function(){return this._minCoord}},{key:"getRightmostSide",value:function(I,y){var _=this.getRightmostSideOfSegment(I,y);return _<0&&(_=this.getRightmostSideOfSegment(I,y-1)),_<0&&(this._minCoord=null,this.checkForRightmostCoordinate(I)),_}},{key:"findRightmostEdgeAtVertex",value:function(){var I=this._minDe.getEdge().getCoordinates();we.isTrue(this._minIndex>0&&this._minIndex<I.length,"rightmost point expected to be interior vertex of edge");var y=I[this._minIndex-1],_=I[this._minIndex+1],P=Ge.index(this._minCoord,_,y),$=!1;(y.y<this._minCoord.y&&_.y<this._minCoord.y&&P===Ge.COUNTERCLOCKWISE||y.y>this._minCoord.y&&_.y>this._minCoord.y&&P===Ge.CLOCKWISE)&&($=!0),$&&(this._minIndex=this._minIndex-1)}},{key:"getRightmostSideOfSegment",value:function(I,y){var _=I.getEdge().getCoordinates();if(y<0||y+1>=_.length||_[y].y===_[y+1].y)return-1;var P=_t.LEFT;return _[y].y<_[y+1].y&&(P=_t.RIGHT),P}},{key:"getEdge",value:function(){return this._orientedDe}},{key:"checkForRightmostCoordinate",value:function(I){for(var y=I.getEdge().getCoordinates(),_=0;_<y.length-1;_++)(this._minCoord===null||y[_].x>this._minCoord.x)&&(this._minDe=I,this._minIndex=_,this._minCoord=y[_])}},{key:"findRightmostEdgeAtNode",value:function(){var I=this._minDe.getNode().getEdges();this._minDe=I.getRightmostEdge(),this._minDe.isForward()||(this._minDe=this._minDe.getSym(),this._minIndex=this._minDe.getEdge().getCoordinates().length-1)}},{key:"findEdge",value:function(I){for(var y=I.iterator();y.hasNext();){var _=y.next();_.isForward()&&this.checkForRightmostCoordinate(_)}we.isTrue(this._minIndex!==0||this._minCoord.equals(this._minDe.getCoordinate()),"inconsistency in rightmost processing"),this._minIndex===0?this.findRightmostEdgeAtNode():this.findRightmostEdgeAtVertex(),this._orientedDe=this._minDe,this.getRightmostSide(this._minDe,this._minIndex)===_t.LEFT&&(this._orientedDe=this._minDe.getSym())}}],[{key:"constructor_",value:function(){this._minIndex=-1,this._minCoord=null,this._minDe=null,this._orientedDe=null}}])})(),Et=(function(I){function y(_,P){var $;return i(this,y),($=n(this,y,[P?_+" [ "+P+" ]":_])).pt=P?new Be(P):void 0,$.name=Object.keys({TopologyException:y})[0],$}return m(y,I),o(y,[{key:"getCoordinate",value:function(){return this.pt}}])})(de),mt=(function(){return o((function I(){i(this,I),this.array=[]}),[{key:"addLast",value:function(I){this.array.push(I)}},{key:"removeFirst",value:function(){return this.array.shift()}},{key:"isEmpty",value:function(){return this.array.length===0}}])})(),ct=(function(I){function y(_){var P;return i(this,y),(P=n(this,y)).array=[],_ instanceof Ot&&P.addAll(_),P}return m(y,I),o(y,[{key:"interfaces_",get:function(){return[ar,Ot]}},{key:"ensureCapacity",value:function(){}},{key:"add",value:function(_){return arguments.length===1?this.array.push(_):this.array.splice(arguments[0],0,arguments[1]),!0}},{key:"clear",value:function(){this.array=[]}},{key:"addAll",value:function(_){var P,$=c(_);try{for($.s();!(P=$.n()).done;){var ne=P.value;this.array.push(ne)}}catch(me){$.e(me)}finally{$.f()}}},{key:"set",value:function(_,P){var $=this.array[_];return this.array[_]=P,$}},{key:"iterator",value:function(){return new Qt(this)}},{key:"get",value:function(_){if(_<0||_>=this.size())throw new mr;return this.array[_]}},{key:"isEmpty",value:function(){return this.array.length===0}},{key:"sort",value:function(_){_?this.array.sort((function(P,$){return _.compare(P,$)})):this.array.sort()}},{key:"size",value:function(){return this.array.length}},{key:"toArray",value:function(){return this.array.slice()}},{key:"remove",value:function(_){for(var P=0,$=this.array.length;P<$;P++)if(this.array[P]===_)return!!this.array.splice(P,1);return!1}},{key:Symbol.iterator,value:function(){return this.array.values()}}])})(ar),Qt=(function(){return o((function I(y){i(this,I),this.arrayList=y,this.position=0}),[{key:"next",value:function(){if(this.position===this.arrayList.size())throw new at;return this.arrayList.get(this.position++)}},{key:"hasNext",value:function(){return this.position<this.arrayList.size()}},{key:"set",value:function(I){return this.arrayList.set(this.position-1,I)}},{key:"remove",value:function(){this.arrayList.remove(this.arrayList.get(this.position))}}])})(),Ht=(function(){return o((function I(){i(this,I),I.constructor_.apply(this,arguments)}),[{key:"clearVisitedEdges",value:function(){for(var I=this._dirEdgeList.iterator();I.hasNext();)I.next().setVisited(!1)}},{key:"getRightmostCoordinate",value:function(){return this._rightMostCoord}},{key:"computeNodeDepth",value:function(I){for(var y=null,_=I.getEdges().iterator();_.hasNext();){var P=_.next();if(P.isVisited()||P.getSym().isVisited()){y=P;break}}if(y===null)throw new Et("unable to find edge to compute depths at "+I.getCoordinate());I.getEdges().computeDepths(y);for(var $=I.getEdges().iterator();$.hasNext();){var ne=$.next();ne.setVisited(!0),this.copySymDepths(ne)}}},{key:"computeDepth",value:function(I){this.clearVisitedEdges();var y=this._finder.getEdge();y.getNode(),y.getLabel(),y.setEdgeDepths(_t.RIGHT,I),this.copySymDepths(y),this.computeDepths(y)}},{key:"create",value:function(I){this.addReachable(I),this._finder.findEdge(this._dirEdgeList),this._rightMostCoord=this._finder.getCoordinate()}},{key:"findResultEdges",value:function(){for(var I=this._dirEdgeList.iterator();I.hasNext();){var y=I.next();y.getDepth(_t.RIGHT)>=1&&y.getDepth(_t.LEFT)<=0&&!y.isInteriorAreaEdge()&&y.setInResult(!0)}}},{key:"computeDepths",value:function(I){var y=new $t,_=new mt,P=I.getNode();for(_.addLast(P),y.add(P),I.setVisited(!0);!_.isEmpty();){var $=_.removeFirst();y.add($),this.computeNodeDepth($);for(var ne=$.getEdges().iterator();ne.hasNext();){var me=ne.next().getSym();if(!me.isVisited()){var Oe=me.getNode();y.contains(Oe)||(_.addLast(Oe),y.add(Oe))}}}}},{key:"compareTo",value:function(I){var y=I;return this._rightMostCoord.x<y._rightMostCoord.x?-1:this._rightMostCoord.x>y._rightMostCoord.x?1:0}},{key:"getEnvelope",value:function(){if(this._env===null){for(var I=new Qe,y=this._dirEdgeList.iterator();y.hasNext();)for(var _=y.next().getEdge().getCoordinates(),P=0;P<_.length-1;P++)I.expandToInclude(_[P]);this._env=I}return this._env}},{key:"addReachable",value:function(I){var y=new Cr;for(y.add(I);!y.empty();){var _=y.pop();this.add(_,y)}}},{key:"copySymDepths",value:function(I){var y=I.getSym();y.setDepth(_t.LEFT,I.getDepth(_t.RIGHT)),y.setDepth(_t.RIGHT,I.getDepth(_t.LEFT))}},{key:"add",value:function(I,y){I.setVisited(!0),this._nodes.add(I);for(var _=I.getEdges().iterator();_.hasNext();){var P=_.next();this._dirEdgeList.add(P);var $=P.getSym().getNode();$.isVisited()||y.push($)}}},{key:"getNodes",value:function(){return this._nodes}},{key:"getDirectedEdges",value:function(){return this._dirEdgeList}},{key:"interfaces_",get:function(){return[H]}}],[{key:"constructor_",value:function(){this._finder=null,this._dirEdgeList=new ct,this._nodes=new ct,this._rightMostCoord=null,this._env=null,this._finder=new Ft}}])})(),Ir=(function(){return o((function I(){i(this,I)}),null,[{key:"intersection",value:function(I,y,_,P){var $=I.x<y.x?I.x:y.x,ne=I.y<y.y?I.y:y.y,me=I.x>y.x?I.x:y.x,Oe=I.y>y.y?I.y:y.y,tt=_.x<P.x?_.x:P.x,ft=_.y<P.y?_.y:P.y,rr=_.x>P.x?_.x:P.x,ur=_.y>P.y?_.y:P.y,qr=(($>tt?$:tt)+(me<rr?me:rr))/2,bn=((ne>ft?ne:ft)+(Oe<ur?Oe:ur))/2,Dn=I.x-qr,Xn=I.y-bn,Fn=y.x-qr,En=y.y-bn,na=_.x-qr,ca=_.y-bn,so=P.x-qr,ka=P.y-bn,Ho=Xn-En,Ks=Fn-Dn,Pl=Dn*En-Fn*Xn,hu=ca-ka,du=so-na,Ps=na*ka-so*ca,Gl=Ho*du-hu*Ks,Wl=(Ks*Ps-du*Pl)/Gl,Eo=(hu*Pl-Ho*Ps)/Gl;return Ie.isNaN(Wl)||Ie.isInfinite(Wl)||Ie.isNaN(Eo)||Ie.isInfinite(Eo)?null:new Be(Wl+qr,Eo+bn)}}])})(),Ar=(function(){return o((function I(){i(this,I)}),null,[{key:"arraycopy",value:function(I,y,_,P,$){for(var ne=0,me=y;me<y+$;me++)_[P+ne]=I[me],ne++}},{key:"getProperty",value:function(I){return{"line.separator":`
`}[I]}}])})(),$r=(function(){function I(){i(this,I)}return o(I,null,[{key:"log10",value:function(y){var _=Math.log(y);return Ie.isInfinite(_)||Ie.isNaN(_)?_:_/I.LOG_10}},{key:"min",value:function(y,_,P,$){var ne=y;return _<ne&&(ne=_),P<ne&&(ne=P),$<ne&&(ne=$),ne}},{key:"clamp",value:function(){if(typeof arguments[2]=="number"&&typeof arguments[0]=="number"&&typeof arguments[1]=="number"){var y=arguments[0],_=arguments[1],P=arguments[2];return y<_?_:y>P?P:y}if(Number.isInteger(arguments[2])&&Number.isInteger(arguments[0])&&Number.isInteger(arguments[1])){var $=arguments[0],ne=arguments[1],me=arguments[2];return $<ne?ne:$>me?me:$}}},{key:"wrap",value:function(y,_){return y<0?_- -y%_:y%_}},{key:"max",value:function(){if(arguments.length===3){var y=arguments[1],_=arguments[2],P=arguments[0];return y>P&&(P=y),_>P&&(P=_),P}if(arguments.length===4){var $=arguments[1],ne=arguments[2],me=arguments[3],Oe=arguments[0];return $>Oe&&(Oe=$),ne>Oe&&(Oe=ne),me>Oe&&(Oe=me),Oe}}},{key:"average",value:function(y,_){return(y+_)/2}}])})();$r.LOG_10=Math.log(10);var fn=(function(){function I(){i(this,I)}return o(I,null,[{key:"segmentToSegment",value:function(y,_,P,$){if(y.equals(_))return I.pointToSegment(y,P,$);if(P.equals($))return I.pointToSegment($,y,_);var ne=!1;if(Qe.intersects(y,_,P,$)){var me=(_.x-y.x)*($.y-P.y)-(_.y-y.y)*($.x-P.x);if(me===0)ne=!0;else{var Oe=(y.y-P.y)*($.x-P.x)-(y.x-P.x)*($.y-P.y),tt=((y.y-P.y)*(_.x-y.x)-(y.x-P.x)*(_.y-y.y))/me,ft=Oe/me;(ft<0||ft>1||tt<0||tt>1)&&(ne=!0)}}else ne=!0;return ne?$r.min(I.pointToSegment(y,P,$),I.pointToSegment(_,P,$),I.pointToSegment(P,y,_),I.pointToSegment($,y,_)):0}},{key:"pointToSegment",value:function(y,_,P){if(_.x===P.x&&_.y===P.y)return y.distance(_);var $=(P.x-_.x)*(P.x-_.x)+(P.y-_.y)*(P.y-_.y),ne=((y.x-_.x)*(P.x-_.x)+(y.y-_.y)*(P.y-_.y))/$;if(ne<=0)return y.distance(_);if(ne>=1)return y.distance(P);var me=((_.y-y.y)*(P.x-_.x)-(_.x-y.x)*(P.y-_.y))/$;return Math.abs(me)*Math.sqrt($)}},{key:"pointToLinePerpendicular",value:function(y,_,P){var $=(P.x-_.x)*(P.x-_.x)+(P.y-_.y)*(P.y-_.y),ne=((_.y-y.y)*(P.x-_.x)-(_.x-y.x)*(P.y-_.y))/$;return Math.abs(ne)*Math.sqrt($)}},{key:"pointToSegmentString",value:function(y,_){if(_.length===0)throw new U("Line array must contain at least one vertex");for(var P=y.distance(_[0]),$=0;$<_.length-1;$++){var ne=I.pointToSegment(y,_[$],_[$+1]);ne<P&&(P=ne)}return P}}])})(),zr=(function(){return o((function I(){i(this,I)}),[{key:"create",value:function(){if(arguments.length===1)arguments[0]instanceof Array||Er(arguments[0],qe);else if(arguments.length!==2){if(arguments.length===3){var I=arguments[0],y=arguments[1];return this.create(I,y)}}}}])})(),Mt=(function(){return o((function I(){i(this,I)}),[{key:"filter",value:function(I){}}])})(),en=(function(){return o((function I(){i(this,I)}),null,[{key:"ofLine",value:function(I){var y=I.size();if(y<=1)return 0;var _=0,P=new Be;I.getCoordinate(0,P);for(var $=P.x,ne=P.y,me=1;me<y;me++){I.getCoordinate(me,P);var Oe=P.x,tt=P.y,ft=Oe-$,rr=tt-ne;_+=Math.sqrt(ft*ft+rr*rr),$=Oe,ne=tt}return _}}])})(),jn=o((function I(){i(this,I)})),Qr=(function(){function I(){i(this,I)}return o(I,null,[{key:"copyCoord",value:function(y,_,P,$){for(var ne=Math.min(y.getDimension(),P.getDimension()),me=0;me<ne;me++)P.setOrdinate($,me,y.getOrdinate(_,me))}},{key:"isRing",value:function(y){var _=y.size();return _===0||!(_<=3)&&y.getOrdinate(0,qe.X)===y.getOrdinate(_-1,qe.X)&&y.getOrdinate(0,qe.Y)===y.getOrdinate(_-1,qe.Y)}},{key:"scroll",value:function(){if(arguments.length===2){if(Er(arguments[0],qe)&&Number.isInteger(arguments[1])){var y=arguments[0],_=arguments[1];I.scroll(y,_,I.isRing(y))}else if(Er(arguments[0],qe)&&arguments[1]instanceof Be){var P=arguments[0],$=arguments[1],ne=I.indexOf($,P);if(ne<=0)return null;I.scroll(P,ne)}}else if(arguments.length===3){var me=arguments[0],Oe=arguments[1],tt=arguments[2];if(Oe<=0)return null;for(var ft=me.copy(),rr=tt?me.size()-1:me.size(),ur=0;ur<rr;ur++)for(var qr=0;qr<me.getDimension();qr++)me.setOrdinate(ur,qr,ft.getOrdinate((Oe+ur)%rr,qr));if(tt)for(var bn=0;bn<me.getDimension();bn++)me.setOrdinate(rr,bn,me.getOrdinate(0,bn))}}},{key:"isEqual",value:function(y,_){var P=y.size();if(P!==_.size())return!1;for(var $=Math.min(y.getDimension(),_.getDimension()),ne=0;ne<P;ne++)for(var me=0;me<$;me++){var Oe=y.getOrdinate(ne,me),tt=_.getOrdinate(ne,me);if(y.getOrdinate(ne,me)!==_.getOrdinate(ne,me)&&(!Ie.isNaN(Oe)||!Ie.isNaN(tt)))return!1}return!0}},{key:"minCoordinateIndex",value:function(){if(arguments.length===1){var y=arguments[0];return I.minCoordinateIndex(y,0,y.size()-1)}if(arguments.length===3){for(var _=arguments[0],P=arguments[2],$=-1,ne=null,me=arguments[1];me<=P;me++){var Oe=_.getCoordinate(me);(ne===null||ne.compareTo(Oe)>0)&&(ne=Oe,$=me)}return $}}},{key:"extend",value:function(y,_,P){var $=y.create(P,_.getDimension()),ne=_.size();if(I.copy(_,0,$,0,ne),ne>0)for(var me=ne;me<P;me++)I.copy(_,ne-1,$,me,1);return $}},{key:"reverse",value:function(y){for(var _=y.size()-1,P=Math.trunc(_/2),$=0;$<=P;$++)I.swap(y,$,_-$)}},{key:"swap",value:function(y,_,P){if(_===P)return null;for(var $=0;$<y.getDimension();$++){var ne=y.getOrdinate(_,$);y.setOrdinate(_,$,y.getOrdinate(P,$)),y.setOrdinate(P,$,ne)}}},{key:"copy",value:function(y,_,P,$,ne){for(var me=0;me<ne;me++)I.copyCoord(y,_+me,P,$+me)}},{key:"ensureValidRing",value:function(y,_){var P=_.size();return P===0?_:P<=3?I.createClosedRing(y,_,4):_.getOrdinate(0,qe.X)===_.getOrdinate(P-1,qe.X)&&_.getOrdinate(0,qe.Y)===_.getOrdinate(P-1,qe.Y)?_:I.createClosedRing(y,_,P+1)}},{key:"indexOf",value:function(y,_){for(var P=0;P<_.size();P++)if(y.x===_.getOrdinate(P,qe.X)&&y.y===_.getOrdinate(P,qe.Y))return P;return-1}},{key:"createClosedRing",value:function(y,_,P){var $=y.create(P,_.getDimension()),ne=_.size();I.copy(_,0,$,0,ne);for(var me=ne;me<P;me++)I.copy(_,0,$,me,1);return $}},{key:"minCoordinate",value:function(y){for(var _=null,P=0;P<y.size();P++){var $=y.getCoordinate(P);(_===null||_.compareTo($)>0)&&(_=$)}return _}}])})(),nr=(function(){function I(){i(this,I)}return o(I,null,[{key:"toDimensionSymbol",value:function(y){switch(y){case I.FALSE:return I.SYM_FALSE;case I.TRUE:return I.SYM_TRUE;case I.DONTCARE:return I.SYM_DONTCARE;case I.P:return I.SYM_P;case I.L:return I.SYM_L;case I.A:return I.SYM_A}throw new U("Unknown dimension value: "+y)}},{key:"toDimensionValue",value:function(y){switch(Ce.toUpperCase(y)){case I.SYM_FALSE:return I.FALSE;case I.SYM_TRUE:return I.TRUE;case I.SYM_DONTCARE:return I.DONTCARE;case I.SYM_P:return I.P;case I.SYM_L:return I.L;case I.SYM_A:return I.A}throw new U("Unknown dimension symbol: "+y)}}])})();nr.P=0,nr.L=1,nr.A=2,nr.FALSE=-1,nr.TRUE=-2,nr.DONTCARE=-3,nr.SYM_FALSE="F",nr.SYM_TRUE="T",nr.SYM_DONTCARE="*",nr.SYM_P="0",nr.SYM_L="1",nr.SYM_A="2";var oi=(function(){return o((function I(){i(this,I)}),[{key:"filter",value:function(I){}}])})(),un=(function(){return o((function I(){i(this,I)}),[{key:"filter",value:function(I,y){}},{key:"isDone",value:function(){}},{key:"isGeometryChanged",value:function(){}}])})(),Kn=(function(I){function y(){var _;return i(this,y),_=n(this,y),y.constructor_.apply(_,arguments),_}return m(y,I),o(y,[{key:"computeEnvelopeInternal",value:function(){return this.isEmpty()?new Qe:this._points.expandEnvelope(new Qe)}},{key:"isRing",value:function(){return this.isClosed()&&this.isSimple()}},{key:"getCoordinates",value:function(){return this._points.toCoordinateArray()}},{key:"copyInternal",value:function(){return new y(this._points.copy(),this._factory)}},{key:"equalsExact",value:function(){if(arguments.length===2&&typeof arguments[1]=="number"&&arguments[0]instanceof it){var _=arguments[0],P=arguments[1];if(!this.isEquivalentClass(_))return!1;var $=_;if(this._points.size()!==$._points.size())return!1;for(var ne=0;ne<this._points.size();ne++)if(!this.equal(this._points.getCoordinate(ne),$._points.getCoordinate(ne),P))return!1;return!0}return E(y,"equalsExact",this,1).apply(this,arguments)}},{key:"normalize",value:function(){for(var _=0;_<Math.trunc(this._points.size()/2);_++){var P=this._points.size()-1-_;if(!this._points.getCoordinate(_).equals(this._points.getCoordinate(P))){if(this._points.getCoordinate(_).compareTo(this._points.getCoordinate(P))>0){var $=this._points.copy();Qr.reverse($),this._points=$}return null}}}},{key:"getCoordinate",value:function(){return this.isEmpty()?null:this._points.getCoordinate(0)}},{key:"getBoundaryDimension",value:function(){return this.isClosed()?nr.FALSE:0}},{key:"isClosed",value:function(){return!this.isEmpty()&&this.getCoordinateN(0).equals2D(this.getCoordinateN(this.getNumPoints()-1))}},{key:"reverseInternal",value:function(){var _=this._points.copy();return Qr.reverse(_),this.getFactory().createLineString(_)}},{key:"getEndPoint",value:function(){return this.isEmpty()?null:this.getPointN(this.getNumPoints()-1)}},{key:"getTypeCode",value:function(){return it.TYPECODE_LINESTRING}},{key:"getDimension",value:function(){return 1}},{key:"getLength",value:function(){return en.ofLine(this._points)}},{key:"getNumPoints",value:function(){return this._points.size()}},{key:"compareToSameClass",value:function(){if(arguments.length===1){for(var _=arguments[0],P=0,$=0;P<this._points.size()&&$<_._points.size();){var ne=this._points.getCoordinate(P).compareTo(_._points.getCoordinate($));if(ne!==0)return ne;P++,$++}return P<this._points.size()?1:$<_._points.size()?-1:0}if(arguments.length===2){var me=arguments[0];return arguments[1].compare(this._points,me._points)}}},{key:"apply",value:function(){if(Er(arguments[0],Mt))for(var _=arguments[0],P=0;P<this._points.size();P++)_.filter(this._points.getCoordinate(P));else if(Er(arguments[0],un)){var $=arguments[0];if(this._points.size()===0)return null;for(var ne=0;ne<this._points.size()&&($.filter(this._points,ne),!$.isDone());ne++);$.isGeometryChanged()&&this.geometryChanged()}else Er(arguments[0],oi)?arguments[0].filter(this):Er(arguments[0],j)&&arguments[0].filter(this)}},{key:"getBoundary",value:function(){throw new $e}},{key:"isEquivalentClass",value:function(_){return _ instanceof y}},{key:"getCoordinateN",value:function(_){return this._points.getCoordinate(_)}},{key:"getGeometryType",value:function(){return it.TYPENAME_LINESTRING}},{key:"getCoordinateSequence",value:function(){return this._points}},{key:"isEmpty",value:function(){return this._points.size()===0}},{key:"init",value:function(_){if(_===null&&(_=this.getFactory().getCoordinateSequenceFactory().create([])),_.size()===1)throw new U("Invalid number of points in LineString (found "+_.size()+" - must be 0 or >= 2)");this._points=_}},{key:"isCoordinate",value:function(_){for(var P=0;P<this._points.size();P++)if(this._points.getCoordinate(P).equals(_))return!0;return!1}},{key:"getStartPoint",value:function(){return this.isEmpty()?null:this.getPointN(0)}},{key:"getPointN",value:function(_){return this.getFactory().createPoint(this._points.getCoordinate(_))}},{key:"interfaces_",get:function(){return[jn]}}],[{key:"constructor_",value:function(){if(this._points=null,arguments.length!==0){if(arguments.length===2){var _=arguments[0],P=arguments[1];it.constructor_.call(this,P),this.init(_)}}}}])})(it),Re=o((function I(){i(this,I)})),He=(function(I){function y(){var _;return i(this,y),_=n(this,y),y.constructor_.apply(_,arguments),_}return m(y,I),o(y,[{key:"computeEnvelopeInternal",value:function(){if(this.isEmpty())return new Qe;var _=new Qe;return _.expandToInclude(this._coordinates.getX(0),this._coordinates.getY(0)),_}},{key:"getCoordinates",value:function(){return this.isEmpty()?[]:[this.getCoordinate()]}},{key:"copyInternal",value:function(){return new y(this._coordinates.copy(),this._factory)}},{key:"equalsExact",value:function(){if(arguments.length===2&&typeof arguments[1]=="number"&&arguments[0]instanceof it){var _=arguments[0],P=arguments[1];return!!this.isEquivalentClass(_)&&(!(!this.isEmpty()||!_.isEmpty())||this.isEmpty()===_.isEmpty()&&this.equal(_.getCoordinate(),this.getCoordinate(),P))}return E(y,"equalsExact",this,1).apply(this,arguments)}},{key:"normalize",value:function(){}},{key:"getCoordinate",value:function(){return this._coordinates.size()!==0?this._coordinates.getCoordinate(0):null}},{key:"getBoundaryDimension",value:function(){return nr.FALSE}},{key:"reverseInternal",value:function(){return this.getFactory().createPoint(this._coordinates.copy())}},{key:"getTypeCode",value:function(){return it.TYPECODE_POINT}},{key:"getDimension",value:function(){return 0}},{key:"getNumPoints",value:function(){return this.isEmpty()?0:1}},{key:"getX",value:function(){if(this.getCoordinate()===null)throw new IllegalStateException("getX called on empty Point");return this.getCoordinate().x}},{key:"compareToSameClass",value:function(){if(arguments.length===1){var _=arguments[0];return this.getCoordinate().compareTo(_.getCoordinate())}if(arguments.length===2){var P=arguments[0];return arguments[1].compare(this._coordinates,P._coordinates)}}},{key:"apply",value:function(){if(Er(arguments[0],Mt)){var _=arguments[0];if(this.isEmpty())return null;_.filter(this.getCoordinate())}else if(Er(arguments[0],un)){var P=arguments[0];if(this.isEmpty())return null;P.filter(this._coordinates,0),P.isGeometryChanged()&&this.geometryChanged()}else Er(arguments[0],oi)?arguments[0].filter(this):Er(arguments[0],j)&&arguments[0].filter(this)}},{key:"getBoundary",value:function(){return this.getFactory().createGeometryCollection()}},{key:"getGeometryType",value:function(){return it.TYPENAME_POINT}},{key:"getCoordinateSequence",value:function(){return this._coordinates}},{key:"getY",value:function(){if(this.getCoordinate()===null)throw new IllegalStateException("getY called on empty Point");return this.getCoordinate().y}},{key:"isEmpty",value:function(){return this._coordinates.size()===0}},{key:"init",value:function(_){_===null&&(_=this.getFactory().getCoordinateSequenceFactory().create([])),we.isTrue(_.size()<=1),this._coordinates=_}},{key:"isSimple",value:function(){return!0}},{key:"interfaces_",get:function(){return[Re]}}],[{key:"constructor_",value:function(){this._coordinates=null;var _=arguments[0],P=arguments[1];it.constructor_.call(this,P),this.init(_)}}])})(it),Tt=(function(){function I(){i(this,I)}return o(I,null,[{key:"ofRing",value:function(){if(arguments[0]instanceof Array){var y=arguments[0];return Math.abs(I.ofRingSigned(y))}if(Er(arguments[0],qe)){var _=arguments[0];return Math.abs(I.ofRingSigned(_))}}},{key:"ofRingSigned",value:function(){if(arguments[0]instanceof Array){var y=arguments[0];if(y.length<3)return 0;for(var _=0,P=y[0].x,$=1;$<y.length-1;$++){var ne=y[$].x-P,me=y[$+1].y;_+=ne*(y[$-1].y-me)}return _/2}if(Er(arguments[0],qe)){var Oe=arguments[0],tt=Oe.size();if(tt<3)return 0;var ft=new Be,rr=new Be,ur=new Be;Oe.getCoordinate(0,rr),Oe.getCoordinate(1,ur);var qr=rr.x;ur.x-=qr;for(var bn=0,Dn=1;Dn<tt-1;Dn++)ft.y=rr.y,rr.x=ur.x,rr.y=ur.y,Oe.getCoordinate(Dn+1,ur),ur.x-=qr,bn+=rr.x*(ft.y-ur.y);return bn/2}}}])})(),Gt=(function(){return o((function I(){i(this,I)}),null,[{key:"sort",value:function(){var I=arguments,y=arguments[0];if(arguments.length===1)y.sort((function(qr,bn){return qr.compareTo(bn)}));else if(arguments.length===2)y.sort((function(qr,bn){return I[1].compare(qr,bn)}));else if(arguments.length===3){var _=y.slice(arguments[1],arguments[2]);_.sort();var P=y.slice(0,arguments[1]).concat(_,y.slice(arguments[2],y.length));y.splice(0,y.length);var $,ne=c(P);try{for(ne.s();!($=ne.n()).done;){var me=$.value;y.push(me)}}catch(qr){ne.e(qr)}finally{ne.f()}}else if(arguments.length===4){var Oe=y.slice(arguments[1],arguments[2]);Oe.sort((function(qr,bn){return I[3].compare(qr,bn)}));var tt=y.slice(0,arguments[1]).concat(Oe,y.slice(arguments[2],y.length));y.splice(0,y.length);var ft,rr=c(tt);try{for(rr.s();!(ft=rr.n()).done;){var ur=ft.value;y.push(ur)}}catch(qr){rr.e(qr)}finally{rr.f()}}}},{key:"asList",value:function(I){var y,_=new ct,P=c(I);try{for(P.s();!(y=P.n()).done;){var $=y.value;_.add($)}}catch(ne){P.e(ne)}finally{P.f()}return _}},{key:"copyOf",value:function(I,y){return I.slice(0,y)}}])})(),Ut=o((function I(){i(this,I)})),Xr=(function(I){function y(){var _;return i(this,y),_=n(this,y),y.constructor_.apply(_,arguments),_}return m(y,I),o(y,[{key:"computeEnvelopeInternal",value:function(){return this._shell.getEnvelopeInternal()}},{key:"getCoordinates",value:function(){if(this.isEmpty())return[];for(var _=new Array(this.getNumPoints()).fill(null),P=-1,$=this._shell.getCoordinates(),ne=0;ne<$.length;ne++)_[++P]=$[ne];for(var me=0;me<this._holes.length;me++)for(var Oe=this._holes[me].getCoordinates(),tt=0;tt<Oe.length;tt++)_[++P]=Oe[tt];return _}},{key:"getArea",value:function(){var _=0;_+=Tt.ofRing(this._shell.getCoordinateSequence());for(var P=0;P<this._holes.length;P++)_-=Tt.ofRing(this._holes[P].getCoordinateSequence());return _}},{key:"copyInternal",value:function(){for(var _=this._shell.copy(),P=new Array(this._holes.length).fill(null),$=0;$<this._holes.length;$++)P[$]=this._holes[$].copy();return new y(_,P,this._factory)}},{key:"isRectangle",value:function(){if(this.getNumInteriorRing()!==0||this._shell===null||this._shell.getNumPoints()!==5)return!1;for(var _=this._shell.getCoordinateSequence(),P=this.getEnvelopeInternal(),$=0;$<5;$++){var ne=_.getX($);if(ne!==P.getMinX()&&ne!==P.getMaxX())return!1;var me=_.getY($);if(me!==P.getMinY()&&me!==P.getMaxY())return!1}for(var Oe=_.getX(0),tt=_.getY(0),ft=1;ft<=4;ft++){var rr=_.getX(ft),ur=_.getY(ft);if(rr!==Oe==(ur!==tt))return!1;Oe=rr,tt=ur}return!0}},{key:"equalsExact",value:function(){if(arguments.length===2&&typeof arguments[1]=="number"&&arguments[0]instanceof it){var _=arguments[0],P=arguments[1];if(!this.isEquivalentClass(_))return!1;var $=_,ne=this._shell,me=$._shell;if(!ne.equalsExact(me,P)||this._holes.length!==$._holes.length)return!1;for(var Oe=0;Oe<this._holes.length;Oe++)if(!this._holes[Oe].equalsExact($._holes[Oe],P))return!1;return!0}return E(y,"equalsExact",this,1).apply(this,arguments)}},{key:"normalize",value:function(){if(arguments.length===0){this._shell=this.normalized(this._shell,!0);for(var _=0;_<this._holes.length;_++)this._holes[_]=this.normalized(this._holes[_],!1);Gt.sort(this._holes)}else if(arguments.length===2){var P=arguments[0],$=arguments[1];if(P.isEmpty())return null;var ne=P.getCoordinateSequence(),me=Qr.minCoordinateIndex(ne,0,ne.size()-2);Qr.scroll(ne,me,!0),Ge.isCCW(ne)===$&&Qr.reverse(ne)}}},{key:"getCoordinate",value:function(){return this._shell.getCoordinate()}},{key:"getNumInteriorRing",value:function(){return this._holes.length}},{key:"getBoundaryDimension",value:function(){return 1}},{key:"reverseInternal",value:function(){for(var _=this.getExteriorRing().reverse(),P=new Array(this.getNumInteriorRing()).fill(null),$=0;$<P.length;$++)P[$]=this.getInteriorRingN($).reverse();return this.getFactory().createPolygon(_,P)}},{key:"getTypeCode",value:function(){return it.TYPECODE_POLYGON}},{key:"getDimension",value:function(){return 2}},{key:"getLength",value:function(){var _=0;_+=this._shell.getLength();for(var P=0;P<this._holes.length;P++)_+=this._holes[P].getLength();return _}},{key:"getNumPoints",value:function(){for(var _=this._shell.getNumPoints(),P=0;P<this._holes.length;P++)_+=this._holes[P].getNumPoints();return _}},{key:"convexHull",value:function(){return this.getExteriorRing().convexHull()}},{key:"normalized",value:function(_,P){var $=_.copy();return this.normalize($,P),$}},{key:"compareToSameClass",value:function(){if(arguments.length===1){var _=arguments[0],P=this._shell,$=_._shell;return P.compareToSameClass($)}if(arguments.length===2){var ne=arguments[1],me=arguments[0],Oe=this._shell,tt=me._shell,ft=Oe.compareToSameClass(tt,ne);if(ft!==0)return ft;for(var rr=this.getNumInteriorRing(),ur=me.getNumInteriorRing(),qr=0;qr<rr&&qr<ur;){var bn=this.getInteriorRingN(qr),Dn=me.getInteriorRingN(qr),Xn=bn.compareToSameClass(Dn,ne);if(Xn!==0)return Xn;qr++}return qr<rr?1:qr<ur?-1:0}}},{key:"apply",value:function(){if(Er(arguments[0],Mt)){var _=arguments[0];this._shell.apply(_);for(var P=0;P<this._holes.length;P++)this._holes[P].apply(_)}else if(Er(arguments[0],un)){var $=arguments[0];if(this._shell.apply($),!$.isDone())for(var ne=0;ne<this._holes.length&&(this._holes[ne].apply($),!$.isDone());ne++);$.isGeometryChanged()&&this.geometryChanged()}else if(Er(arguments[0],oi))arguments[0].filter(this);else if(Er(arguments[0],j)){var me=arguments[0];me.filter(this),this._shell.apply(me);for(var Oe=0;Oe<this._holes.length;Oe++)this._holes[Oe].apply(me)}}},{key:"getBoundary",value:function(){if(this.isEmpty())return this.getFactory().createMultiLineString();var _=new Array(this._holes.length+1).fill(null);_[0]=this._shell;for(var P=0;P<this._holes.length;P++)_[P+1]=this._holes[P];return _.length<=1?this.getFactory().createLinearRing(_[0].getCoordinateSequence()):this.getFactory().createMultiLineString(_)}},{key:"getGeometryType",value:function(){return it.TYPENAME_POLYGON}},{key:"getExteriorRing",value:function(){return this._shell}},{key:"isEmpty",value:function(){return this._shell.isEmpty()}},{key:"getInteriorRingN",value:function(_){return this._holes[_]}},{key:"interfaces_",get:function(){return[Ut]}}],[{key:"constructor_",value:function(){this._shell=null,this._holes=null;var _=arguments[0],P=arguments[1],$=arguments[2];if(it.constructor_.call(this,$),_===null&&(_=this.getFactory().createLinearRing()),P===null&&(P=[]),it.hasNullElements(P))throw new U("holes must not contain null elements");if(_.isEmpty()&&it.hasNonEmptyElements(P))throw new U("shell is empty but holes are not");this._shell=_,this._holes=P}}])})(it),Nn=(function(I){function y(){return i(this,y),n(this,y,arguments)}return m(y,I),o(y)})(Xt),Bi=(function(I){function y(_){var P;return i(this,y),(P=n(this,y)).array=[],_ instanceof Ot&&P.addAll(_),P}return m(y,I),o(y,[{key:"contains",value:function(_){var P,$=c(this.array);try{for($.s();!(P=$.n()).done;)if(P.value.compareTo(_)===0)return!0}catch(ne){$.e(ne)}finally{$.f()}return!1}},{key:"add",value:function(_){if(this.contains(_))return!1;for(var P=0,$=this.array.length;P<$;P++)if(this.array[P].compareTo(_)===1)return!!this.array.splice(P,0,_);return this.array.push(_),!0}},{key:"addAll",value:function(_){var P,$=c(_);try{for($.s();!(P=$.n()).done;){var ne=P.value;this.add(ne)}}catch(me){$.e(me)}finally{$.f()}return!0}},{key:"remove",value:function(){throw new $e}},{key:"size",value:function(){return this.array.length}},{key:"isEmpty",value:function(){return this.array.length===0}},{key:"toArray",value:function(){return this.array.slice()}},{key:"iterator",value:function(){return new Ci(this.array)}}])})(Nn),Ci=(function(){return o((function I(y){i(this,I),this.array=y,this.position=0}),[{key:"next",value:function(){if(this.position===this.array.length)throw new at;return this.array[this.position++]}},{key:"hasNext",value:function(){return this.position<this.array.length}},{key:"remove",value:function(){throw new $e}}])})(),Fr=(function(I){function y(){var _;return i(this,y),_=n(this,y),y.constructor_.apply(_,arguments),_}return m(y,I),o(y,[{key:"computeEnvelopeInternal",value:function(){for(var _=new Qe,P=0;P<this._geometries.length;P++)_.expandToInclude(this._geometries[P].getEnvelopeInternal());return _}},{key:"getGeometryN",value:function(_){return this._geometries[_]}},{key:"getCoordinates",value:function(){for(var _=new Array(this.getNumPoints()).fill(null),P=-1,$=0;$<this._geometries.length;$++)for(var ne=this._geometries[$].getCoordinates(),me=0;me<ne.length;me++)_[++P]=ne[me];return _}},{key:"getArea",value:function(){for(var _=0,P=0;P<this._geometries.length;P++)_+=this._geometries[P].getArea();return _}},{key:"copyInternal",value:function(){for(var _=new Array(this._geometries.length).fill(null),P=0;P<_.length;P++)_[P]=this._geometries[P].copy();return new y(_,this._factory)}},{key:"equalsExact",value:function(){if(arguments.length===2&&typeof arguments[1]=="number"&&arguments[0]instanceof it){var _=arguments[0],P=arguments[1];if(!this.isEquivalentClass(_))return!1;var $=_;if(this._geometries.length!==$._geometries.length)return!1;for(var ne=0;ne<this._geometries.length;ne++)if(!this._geometries[ne].equalsExact($._geometries[ne],P))return!1;return!0}return E(y,"equalsExact",this,1).apply(this,arguments)}},{key:"normalize",value:function(){for(var _=0;_<this._geometries.length;_++)this._geometries[_].normalize();Gt.sort(this._geometries)}},{key:"getCoordinate",value:function(){return this.isEmpty()?null:this._geometries[0].getCoordinate()}},{key:"getBoundaryDimension",value:function(){for(var _=nr.FALSE,P=0;P<this._geometries.length;P++)_=Math.max(_,this._geometries[P].getBoundaryDimension());return _}},{key:"reverseInternal",value:function(){for(var _=this._geometries.length,P=new ct(_),$=0;$<_;$++)P.add(this._geometries[$].reverse());return this.getFactory().buildGeometry(P)}},{key:"getTypeCode",value:function(){return it.TYPECODE_GEOMETRYCOLLECTION}},{key:"getDimension",value:function(){for(var _=nr.FALSE,P=0;P<this._geometries.length;P++)_=Math.max(_,this._geometries[P].getDimension());return _}},{key:"getLength",value:function(){for(var _=0,P=0;P<this._geometries.length;P++)_+=this._geometries[P].getLength();return _}},{key:"getNumPoints",value:function(){for(var _=0,P=0;P<this._geometries.length;P++)_+=this._geometries[P].getNumPoints();return _}},{key:"getNumGeometries",value:function(){return this._geometries.length}},{key:"compareToSameClass",value:function(){if(arguments.length===1){var _=arguments[0],P=new Bi(Gt.asList(this._geometries)),$=new Bi(Gt.asList(_._geometries));return this.compare(P,$)}if(arguments.length===2){for(var ne=arguments[1],me=arguments[0],Oe=this.getNumGeometries(),tt=me.getNumGeometries(),ft=0;ft<Oe&&ft<tt;){var rr=this.getGeometryN(ft),ur=me.getGeometryN(ft),qr=rr.compareToSameClass(ur,ne);if(qr!==0)return qr;ft++}return ft<Oe?1:ft<tt?-1:0}}},{key:"apply",value:function(){if(Er(arguments[0],Mt))for(var _=arguments[0],P=0;P<this._geometries.length;P++)this._geometries[P].apply(_);else if(Er(arguments[0],un)){var $=arguments[0];if(this._geometries.length===0)return null;for(var ne=0;ne<this._geometries.length&&(this._geometries[ne].apply($),!$.isDone());ne++);$.isGeometryChanged()&&this.geometryChanged()}else if(Er(arguments[0],oi)){var me=arguments[0];me.filter(this);for(var Oe=0;Oe<this._geometries.length;Oe++)this._geometries[Oe].apply(me)}else if(Er(arguments[0],j)){var tt=arguments[0];tt.filter(this);for(var ft=0;ft<this._geometries.length;ft++)this._geometries[ft].apply(tt)}}},{key:"getBoundary",value:function(){return it.checkNotGeometryCollection(this),we.shouldNeverReachHere(),null}},{key:"getGeometryType",value:function(){return it.TYPENAME_GEOMETRYCOLLECTION}},{key:"isEmpty",value:function(){for(var _=0;_<this._geometries.length;_++)if(!this._geometries[_].isEmpty())return!1;return!0}}],[{key:"constructor_",value:function(){if(this._geometries=null,arguments.length!==0){if(arguments.length===2){var _=arguments[0],P=arguments[1];if(it.constructor_.call(this,P),_===null&&(_=[]),it.hasNullElements(_))throw new U("geometries must not contain null elements");this._geometries=_}}}}])})(it),Mn=(function(I){function y(){var _;return i(this,y),_=n(this,y),y.constructor_.apply(_,arguments),_}return m(y,I),o(y,[{key:"copyInternal",value:function(){for(var _=new Array(this._geometries.length).fill(null),P=0;P<_.length;P++)_[P]=this._geometries[P].copy();return new y(_,this._factory)}},{key:"isValid",value:function(){return!0}},{key:"equalsExact",value:function(){if(arguments.length===2&&typeof arguments[1]=="number"&&arguments[0]instanceof it){var _=arguments[0],P=arguments[1];return!!this.isEquivalentClass(_)&&E(y,"equalsExact",this,1).call(this,_,P)}return E(y,"equalsExact",this,1).apply(this,arguments)}},{key:"getCoordinate",value:function(){if(arguments.length===1&&Number.isInteger(arguments[0])){var _=arguments[0];return this._geometries[_].getCoordinate()}return E(y,"getCoordinate",this,1).apply(this,arguments)}},{key:"getBoundaryDimension",value:function(){return nr.FALSE}},{key:"getTypeCode",value:function(){return it.TYPECODE_MULTIPOINT}},{key:"getDimension",value:function(){return 0}},{key:"getBoundary",value:function(){return this.getFactory().createGeometryCollection()}},{key:"getGeometryType",value:function(){return it.TYPENAME_MULTIPOINT}},{key:"interfaces_",get:function(){return[Re]}}],[{key:"constructor_",value:function(){var _=arguments[0],P=arguments[1];Fr.constructor_.call(this,_,P)}}])})(Fr),Bn=(function(I){function y(){var _;return i(this,y),_=n(this,y),y.constructor_.apply(_,arguments),_}return m(y,I),o(y,[{key:"copyInternal",value:function(){return new y(this._points.copy(),this._factory)}},{key:"getBoundaryDimension",value:function(){return nr.FALSE}},{key:"isClosed",value:function(){return!!this.isEmpty()||E(y,"isClosed",this,1).call(this)}},{key:"reverseInternal",value:function(){var _=this._points.copy();return Qr.reverse(_),this.getFactory().createLinearRing(_)}},{key:"getTypeCode",value:function(){return it.TYPECODE_LINEARRING}},{key:"validateConstruction",value:function(){if(!this.isEmpty()&&!E(y,"isClosed",this,1).call(this))throw new U("Points of LinearRing do not form a closed linestring");if(this.getCoordinateSequence().size()>=1&&this.getCoordinateSequence().size()<y.MINIMUM_VALID_SIZE)throw new U("Invalid number of points in LinearRing (found "+this.getCoordinateSequence().size()+" - must be 0 or >= 4)")}},{key:"getGeometryType",value:function(){return it.TYPENAME_LINEARRING}}],[{key:"constructor_",value:function(){var _=arguments[0],P=arguments[1];Kn.constructor_.call(this,_,P),this.validateConstruction()}}])})(Kn);Bn.MINIMUM_VALID_SIZE=4;var ei=(function(I){function y(){var _;return i(this,y),_=n(this,y),y.constructor_.apply(_,arguments),_}return m(y,I),o(y,[{key:"setOrdinate",value:function(_,P){switch(_){case y.X:this.x=P;break;case y.Y:this.y=P;break;default:throw new U("Invalid ordinate index: "+_)}}},{key:"getZ",value:function(){return Be.NULL_ORDINATE}},{key:"getOrdinate",value:function(_){switch(_){case y.X:return this.x;case y.Y:return this.y}throw new U("Invalid ordinate index: "+_)}},{key:"setZ",value:function(_){throw new U("CoordinateXY dimension 2 does not support z-ordinate")}},{key:"copy",value:function(){return new y(this)}},{key:"toString",value:function(){return"("+this.x+", "+this.y+")"}},{key:"setCoordinate",value:function(_){this.x=_.x,this.y=_.y,this.z=_.getZ()}}],[{key:"constructor_",value:function(){if(arguments.length===0)Be.constructor_.call(this);else if(arguments.length===1){if(arguments[0]instanceof y){var _=arguments[0];Be.constructor_.call(this,_.x,_.y)}else if(arguments[0]instanceof Be){var P=arguments[0];Be.constructor_.call(this,P.x,P.y)}}else if(arguments.length===2){var $=arguments[0],ne=arguments[1];Be.constructor_.call(this,$,ne,Be.NULL_ORDINATE)}}}])})(Be);ei.X=0,ei.Y=1,ei.Z=-1,ei.M=-1;var ua=(function(I){function y(){var _;return i(this,y),_=n(this,y),y.constructor_.apply(_,arguments),_}return m(y,I),o(y,[{key:"getM",value:function(){return this._m}},{key:"setOrdinate",value:function(_,P){switch(_){case y.X:this.x=P;break;case y.Y:this.y=P;break;case y.M:this._m=P;break;default:throw new U("Invalid ordinate index: "+_)}}},{key:"setM",value:function(_){this._m=_}},{key:"getZ",value:function(){return Be.NULL_ORDINATE}},{key:"getOrdinate",value:function(_){switch(_){case y.X:return this.x;case y.Y:return this.y;case y.M:return this._m}throw new U("Invalid ordinate index: "+_)}},{key:"setZ",value:function(_){throw new U("CoordinateXY dimension 2 does not support z-ordinate")}},{key:"copy",value:function(){return new y(this)}},{key:"toString",value:function(){return"("+this.x+", "+this.y+" m="+this.getM()+")"}},{key:"setCoordinate",value:function(_){this.x=_.x,this.y=_.y,this.z=_.getZ(),this._m=_.getM()}}],[{key:"constructor_",value:function(){if(this._m=null,arguments.length===0)Be.constructor_.call(this),this._m=0;else if(arguments.length===1){if(arguments[0]instanceof y){var _=arguments[0];Be.constructor_.call(this,_.x,_.y),this._m=_._m}else if(arguments[0]instanceof Be){var P=arguments[0];Be.constructor_.call(this,P.x,P.y),this._m=this.getM()}}else if(arguments.length===3){var $=arguments[0],ne=arguments[1],me=arguments[2];Be.constructor_.call(this,$,ne,Be.NULL_ORDINATE),this._m=me}}}])})(Be);ua.X=0,ua.Y=1,ua.Z=-1,ua.M=2;var ha=(function(I){function y(){var _;return i(this,y),_=n(this,y),y.constructor_.apply(_,arguments),_}return m(y,I),o(y,[{key:"getM",value:function(){return this._m}},{key:"setOrdinate",value:function(_,P){switch(_){case Be.X:this.x=P;break;case Be.Y:this.y=P;break;case Be.Z:this.z=P;break;case Be.M:this._m=P;break;default:throw new U("Invalid ordinate index: "+_)}}},{key:"setM",value:function(_){this._m=_}},{key:"getOrdinate",value:function(_){switch(_){case Be.X:return this.x;case Be.Y:return this.y;case Be.Z:return this.getZ();case Be.M:return this.getM()}throw new U("Invalid ordinate index: "+_)}},{key:"copy",value:function(){return new y(this)}},{key:"toString",value:function(){return"("+this.x+", "+this.y+", "+this.getZ()+" m="+this.getM()+")"}},{key:"setCoordinate",value:function(_){this.x=_.x,this.y=_.y,this.z=_.getZ(),this._m=_.getM()}}],[{key:"constructor_",value:function(){if(this._m=null,arguments.length===0)Be.constructor_.call(this),this._m=0;else if(arguments.length===1){if(arguments[0]instanceof y){var _=arguments[0];Be.constructor_.call(this,_),this._m=_._m}else if(arguments[0]instanceof Be){var P=arguments[0];Be.constructor_.call(this,P),this._m=this.getM()}}else if(arguments.length===4){var $=arguments[0],ne=arguments[1],me=arguments[2],Oe=arguments[3];Be.constructor_.call(this,$,ne,me),this._m=Oe}}}])})(Be),zn=(function(){function I(){i(this,I)}return o(I,null,[{key:"measures",value:function(y){return y instanceof ei?0:y instanceof ua||y instanceof ha?1:0}},{key:"dimension",value:function(y){return y instanceof ei?2:y instanceof ua?3:y instanceof ha?4:3}},{key:"create",value:function(){if(arguments.length===1){var y=arguments[0];return I.create(y,0)}if(arguments.length===2){var _=arguments[0],P=arguments[1];return _===2?new ei:_===3&&P===0?new Be:_===3&&P===1?new ua:_===4&&P===1?new ha:new Be}}}])})(),La=(function(I){function y(){var _;return i(this,y),_=n(this,y),y.constructor_.apply(_,arguments),_}return m(y,I),o(y,[{key:"getCoordinate",value:function(_){return this.get(_)}},{key:"addAll",value:function(){if(arguments.length===2&&typeof arguments[1]=="boolean"&&Er(arguments[0],Ot)){for(var _=arguments[1],P=!1,$=arguments[0].iterator();$.hasNext();)this.add($.next(),_),P=!0;return P}return E(y,"addAll",this,1).apply(this,arguments)}},{key:"clone",value:function(){for(var _=E(y,"clone",this,1).call(this),P=0;P<this.size();P++)_.add(P,this.get(P).clone());return _}},{key:"toCoordinateArray",value:function(){if(arguments.length===0)return this.toArray(y.coordArrayType);if(arguments.length===1){if(arguments[0])return this.toArray(y.coordArrayType);for(var _=this.size(),P=new Array(_).fill(null),$=0;$<_;$++)P[$]=this.get(_-$-1);return P}}},{key:"add",value:function(){if(arguments.length===1){var _=arguments[0];return E(y,"add",this,1).call(this,_)}if(arguments.length===2){if(arguments[0]instanceof Array&&typeof arguments[1]=="boolean"){var P=arguments[0],$=arguments[1];return this.add(P,$,!0),!0}if(arguments[0]instanceof Be&&typeof arguments[1]=="boolean"){var ne=arguments[0];if(!arguments[1]&&this.size()>=1&&this.get(this.size()-1).equals2D(ne))return null;E(y,"add",this,1).call(this,ne)}else if(arguments[0]instanceof Object&&typeof arguments[1]=="boolean"){var me=arguments[0],Oe=arguments[1];return this.add(me,Oe),!0}}else if(arguments.length===3){if(typeof arguments[2]=="boolean"&&arguments[0]instanceof Array&&typeof arguments[1]=="boolean"){var tt=arguments[0],ft=arguments[1];if(arguments[2])for(var rr=0;rr<tt.length;rr++)this.add(tt[rr],ft);else for(var ur=tt.length-1;ur>=0;ur--)this.add(tt[ur],ft);return!0}if(typeof arguments[2]=="boolean"&&Number.isInteger(arguments[0])&&arguments[1]instanceof Be){var qr=arguments[0],bn=arguments[1];if(!arguments[2]){var Dn=this.size();if(Dn>0&&(qr>0&&this.get(qr-1).equals2D(bn)||qr<Dn&&this.get(qr).equals2D(bn)))return null}E(y,"add",this,1).call(this,qr,bn)}}else if(arguments.length===4){var Xn=arguments[0],Fn=arguments[1],En=arguments[2],na=arguments[3],ca=1;En>na&&(ca=-1);for(var so=En;so!==na;so+=ca)this.add(Xn[so],Fn);return!0}}},{key:"closeRing",value:function(){if(this.size()>0){var _=this.get(0).copy();this.add(_,!1)}}}],[{key:"constructor_",value:function(){if(arguments.length!==0){if(arguments.length===1){var _=arguments[0];this.ensureCapacity(_.length),this.add(_,!0)}else if(arguments.length===2){var P=arguments[0],$=arguments[1];this.ensureCapacity(P.length),this.add(P,$)}}}}])})(ct);La.coordArrayType=new Array(0).fill(null);var Wi=(function(){function I(){i(this,I)}return o(I,null,[{key:"isRing",value:function(y){return!(y.length<4)&&!!y[0].equals2D(y[y.length-1])}},{key:"ptNotInList",value:function(y,_){for(var P=0;P<y.length;P++){var $=y[P];if(I.indexOf($,_)<0)return $}return null}},{key:"scroll",value:function(y,_){var P=I.indexOf(_,y);if(P<0)return null;var $=new Array(y.length).fill(null);Ar.arraycopy(y,P,$,0,y.length-P),Ar.arraycopy(y,0,$,y.length-P,P),Ar.arraycopy($,0,y,0,y.length)}},{key:"equals",value:function(){if(arguments.length===2){var y=arguments[0],_=arguments[1];if(y===_)return!0;if(y===null||_===null||y.length!==_.length)return!1;for(var P=0;P<y.length;P++)if(!y[P].equals(_[P]))return!1;return!0}if(arguments.length===3){var $=arguments[0],ne=arguments[1],me=arguments[2];if($===ne)return!0;if($===null||ne===null||$.length!==ne.length)return!1;for(var Oe=0;Oe<$.length;Oe++)if(me.compare($[Oe],ne[Oe])!==0)return!1;return!0}}},{key:"intersection",value:function(y,_){for(var P=new La,$=0;$<y.length;$++)_.intersects(y[$])&&P.add(y[$],!0);return P.toCoordinateArray()}},{key:"measures",value:function(y){if(y===null||y.length===0)return 0;var _,P=0,$=c(y);try{for($.s();!(_=$.n()).done;){var ne=_.value;P=Math.max(P,zn.measures(ne))}}catch(me){$.e(me)}finally{$.f()}return P}},{key:"hasRepeatedPoints",value:function(y){for(var _=1;_<y.length;_++)if(y[_-1].equals(y[_]))return!0;return!1}},{key:"removeRepeatedPoints",value:function(y){return I.hasRepeatedPoints(y)?new La(y,!1).toCoordinateArray():y}},{key:"reverse",value:function(y){for(var _=y.length-1,P=Math.trunc(_/2),$=0;$<=P;$++){var ne=y[$];y[$]=y[_-$],y[_-$]=ne}}},{key:"removeNull",value:function(y){for(var _=0,P=0;P<y.length;P++)y[P]!==null&&_++;var $=new Array(_).fill(null);if(_===0)return $;for(var ne=0,me=0;me<y.length;me++)y[me]!==null&&($[ne++]=y[me]);return $}},{key:"copyDeep",value:function(){if(arguments.length===1){for(var y=arguments[0],_=new Array(y.length).fill(null),P=0;P<y.length;P++)_[P]=y[P].copy();return _}if(arguments.length===5)for(var $=arguments[0],ne=arguments[1],me=arguments[2],Oe=arguments[3],tt=arguments[4],ft=0;ft<tt;ft++)me[Oe+ft]=$[ne+ft].copy()}},{key:"isEqualReversed",value:function(y,_){for(var P=0;P<y.length;P++){var $=y[P],ne=_[y.length-P-1];if($.compareTo(ne)!==0)return!1}return!0}},{key:"envelope",value:function(y){for(var _=new Qe,P=0;P<y.length;P++)_.expandToInclude(y[P]);return _}},{key:"toCoordinateArray",value:function(y){return y.toArray(I.coordArrayType)}},{key:"dimension",value:function(y){if(y===null||y.length===0)return 3;var _,P=0,$=c(y);try{for($.s();!(_=$.n()).done;){var ne=_.value;P=Math.max(P,zn.dimension(ne))}}catch(me){$.e(me)}finally{$.f()}return P}},{key:"atLeastNCoordinatesOrNothing",value:function(y,_){return _.length>=y?_:[]}},{key:"indexOf",value:function(y,_){for(var P=0;P<_.length;P++)if(y.equals(_[P]))return P;return-1}},{key:"increasingDirection",value:function(y){for(var _=0;_<Math.trunc(y.length/2);_++){var P=y.length-1-_,$=y[_].compareTo(y[P]);if($!==0)return $}return 1}},{key:"compare",value:function(y,_){for(var P=0;P<y.length&&P<_.length;){var $=y[P].compareTo(_[P]);if($!==0)return $;P++}return P<_.length?-1:P<y.length?1:0}},{key:"minCoordinate",value:function(y){for(var _=null,P=0;P<y.length;P++)(_===null||_.compareTo(y[P])>0)&&(_=y[P]);return _}},{key:"extract",value:function(y,_,P){_=$r.clamp(_,0,y.length);var $=(P=$r.clamp(P,-1,y.length))-_+1;P<0&&($=0),_>=y.length&&($=0),P<_&&($=0);var ne=new Array($).fill(null);if($===0)return ne;for(var me=0,Oe=_;Oe<=P;Oe++)ne[me++]=y[Oe];return ne}}])})(),hs=(function(){return o((function I(){i(this,I)}),[{key:"compare",value:function(I,y){var _=I,P=y;return Wi.compare(_,P)}},{key:"interfaces_",get:function(){return[Me]}}])})(),Ca=(function(){return o((function I(){i(this,I)}),[{key:"compare",value:function(I,y){var _=I,P=y;if(_.length<P.length)return-1;if(_.length>P.length)return 1;if(_.length===0)return 0;var $=Wi.compare(_,P);return Wi.isEqualReversed(_,P)?0:$}},{key:"OLDcompare",value:function(I,y){var _=I,P=y;if(_.length<P.length)return-1;if(_.length>P.length)return 1;if(_.length===0)return 0;for(var $=Wi.increasingDirection(_),ne=Wi.increasingDirection(P),me=$>0?0:_.length-1,Oe=ne>0?0:_.length-1,tt=0;tt<_.length;tt++){var ft=_[me].compareTo(P[Oe]);if(ft!==0)return ft;me+=$,Oe+=ne}return 0}},{key:"interfaces_",get:function(){return[Me]}}])})();Wi.ForwardComparator=hs,Wi.BidirectionalComparator=Ca,Wi.coordArrayType=new Array(0).fill(null);var Mo=(function(){return o((function I(y){i(this,I),this.str=y}),[{key:"append",value:function(I){this.str+=I}},{key:"setCharAt",value:function(I,y){this.str=this.str.substr(0,I)+y+this.str.substr(I+1)}},{key:"toString",value:function(){return this.str}}])})(),Ya=(function(){function I(){i(this,I),I.constructor_.apply(this,arguments)}return o(I,[{key:"getM",value:function(y){return this.hasM()?this._coordinates[y].getM():Ie.NaN}},{key:"setOrdinate",value:function(y,_,P){switch(_){case qe.X:this._coordinates[y].x=P;break;case qe.Y:this._coordinates[y].y=P;break;default:this._coordinates[y].setOrdinate(_,P)}}},{key:"getZ",value:function(y){return this.hasZ()?this._coordinates[y].getZ():Ie.NaN}},{key:"size",value:function(){return this._coordinates.length}},{key:"getOrdinate",value:function(y,_){switch(_){case qe.X:return this._coordinates[y].x;case qe.Y:return this._coordinates[y].y;default:return this._coordinates[y].getOrdinate(_)}}},{key:"getCoordinate",value:function(){if(arguments.length===1){var y=arguments[0];return this._coordinates[y]}if(arguments.length===2){var _=arguments[0];arguments[1].setCoordinate(this._coordinates[_])}}},{key:"getCoordinateCopy",value:function(y){var _=this.createCoordinate();return _.setCoordinate(this._coordinates[y]),_}},{key:"createCoordinate",value:function(){return zn.create(this.getDimension(),this.getMeasures())}},{key:"getDimension",value:function(){return this._dimension}},{key:"getX",value:function(y){return this._coordinates[y].x}},{key:"getMeasures",value:function(){return this._measures}},{key:"expandEnvelope",value:function(y){for(var _=0;_<this._coordinates.length;_++)y.expandToInclude(this._coordinates[_]);return y}},{key:"copy",value:function(){for(var y=new Array(this.size()).fill(null),_=0;_<this._coordinates.length;_++){var P=this.createCoordinate();P.setCoordinate(this._coordinates[_]),y[_]=P}return new I(y,this._dimension,this._measures)}},{key:"toString",value:function(){if(this._coordinates.length>0){var y=new Mo(17*this._coordinates.length);y.append("("),y.append(this._coordinates[0]);for(var _=1;_<this._coordinates.length;_++)y.append(", "),y.append(this._coordinates[_]);return y.append(")"),y.toString()}return"()"}},{key:"getY",value:function(y){return this._coordinates[y].y}},{key:"toCoordinateArray",value:function(){return this._coordinates}},{key:"interfaces_",get:function(){return[qe,X]}}],[{key:"constructor_",value:function(){if(this._dimension=3,this._measures=0,this._coordinates=null,arguments.length===1){if(arguments[0]instanceof Array){var y=arguments[0];I.constructor_.call(this,y,Wi.dimension(y),Wi.measures(y))}else if(Number.isInteger(arguments[0])){var _=arguments[0];this._coordinates=new Array(_).fill(null);for(var P=0;P<_;P++)this._coordinates[P]=new Be}else if(Er(arguments[0],qe)){var $=arguments[0];if($===null)return this._coordinates=new Array(0).fill(null),null;this._dimension=$.getDimension(),this._measures=$.getMeasures(),this._coordinates=new Array($.size()).fill(null);for(var ne=0;ne<this._coordinates.length;ne++)this._coordinates[ne]=$.getCoordinateCopy(ne)}}else if(arguments.length===2){if(arguments[0]instanceof Array&&Number.isInteger(arguments[1])){var me=arguments[0],Oe=arguments[1];I.constructor_.call(this,me,Oe,Wi.measures(me))}else if(Number.isInteger(arguments[0])&&Number.isInteger(arguments[1])){var tt=arguments[0],ft=arguments[1];this._coordinates=new Array(tt).fill(null),this._dimension=ft;for(var rr=0;rr<tt;rr++)this._coordinates[rr]=zn.create(ft)}}else if(arguments.length===3){if(Number.isInteger(arguments[2])&&arguments[0]instanceof Array&&Number.isInteger(arguments[1])){var ur=arguments[0],qr=arguments[1],bn=arguments[2];this._dimension=qr,this._measures=bn,this._coordinates=ur===null?new Array(0).fill(null):ur}else if(Number.isInteger(arguments[2])&&Number.isInteger(arguments[0])&&Number.isInteger(arguments[1])){var Dn=arguments[0],Xn=arguments[1],Fn=arguments[2];this._coordinates=new Array(Dn).fill(null),this._dimension=Xn,this._measures=Fn;for(var En=0;En<Dn;En++)this._coordinates[En]=this.createCoordinate()}}}}])})(),ol=(function(){function I(){i(this,I)}return o(I,[{key:"readResolve",value:function(){return I.instance()}},{key:"create",value:function(){if(arguments.length===1){if(arguments[0]instanceof Array)return new Ya(arguments[0]);if(Er(arguments[0],qe))return new Ya(arguments[0])}else{if(arguments.length===2){var y=arguments[1];return y>3&&(y=3),y<2&&(y=2),new Ya(arguments[0],y)}if(arguments.length===3){var _=arguments[2],P=arguments[1]-_;return _>1&&(_=1),P>3&&(P=3),P<2&&(P=2),new Ya(arguments[0],P+_,_)}}}},{key:"interfaces_",get:function(){return[zr,X]}}],[{key:"instance",value:function(){return I.instanceObject}}])})();ol.instanceObject=new ol;var xi=(function(I){function y(){var _;return i(this,y),_=n(this,y),y.constructor_.apply(_,arguments),_}return m(y,I),o(y,[{key:"copyInternal",value:function(){for(var _=new Array(this._geometries.length).fill(null),P=0;P<_.length;P++)_[P]=this._geometries[P].copy();return new y(_,this._factory)}},{key:"equalsExact",value:function(){if(arguments.length===2&&typeof arguments[1]=="number"&&arguments[0]instanceof it){var _=arguments[0],P=arguments[1];return!!this.isEquivalentClass(_)&&E(y,"equalsExact",this,1).call(this,_,P)}return E(y,"equalsExact",this,1).apply(this,arguments)}},{key:"getBoundaryDimension",value:function(){return 1}},{key:"getTypeCode",value:function(){return it.TYPECODE_MULTIPOLYGON}},{key:"getDimension",value:function(){return 2}},{key:"getBoundary",value:function(){if(this.isEmpty())return this.getFactory().createMultiLineString();for(var _=new ct,P=0;P<this._geometries.length;P++)for(var $=this._geometries[P].getBoundary(),ne=0;ne<$.getNumGeometries();ne++)_.add($.getGeometryN(ne));var me=new Array(_.size()).fill(null);return this.getFactory().createMultiLineString(_.toArray(me))}},{key:"getGeometryType",value:function(){return it.TYPENAME_MULTIPOLYGON}},{key:"interfaces_",get:function(){return[Ut]}}],[{key:"constructor_",value:function(){var _=arguments[0],P=arguments[1];Fr.constructor_.call(this,_,P)}}])})(Fr),zi=(function(){return o((function I(){i(this,I)}),[{key:"get",value:function(){}},{key:"put",value:function(){}},{key:"size",value:function(){}},{key:"values",value:function(){}},{key:"entrySet",value:function(){}}])})(),Iu=(function(I){function y(){var _;return i(this,y),(_=n(this,y)).map=new Map,_}return m(y,I),o(y,[{key:"get",value:function(_){return this.map.get(_)||null}},{key:"put",value:function(_,P){return this.map.set(_,P),P}},{key:"values",value:function(){for(var _=new ct,P=this.map.values(),$=P.next();!$.done;)_.add($.value),$=P.next();return _}},{key:"entrySet",value:function(){var _=new $t;return this.map.entries().forEach((function(P){return _.add(P)})),_}},{key:"size",value:function(){return this.map.size()}}])})(zi),ga=(function(){function I(){i(this,I),I.constructor_.apply(this,arguments)}return o(I,[{key:"equals",value:function(y){if(!(y instanceof I))return!1;var _=y;return this._modelType===_._modelType&&this._scale===_._scale}},{key:"compareTo",value:function(y){var _=y,P=this.getMaximumSignificantDigits(),$=_.getMaximumSignificantDigits();return ot.compare(P,$)}},{key:"getScale",value:function(){return this._scale}},{key:"isFloating",value:function(){return this._modelType===I.FLOATING||this._modelType===I.FLOATING_SINGLE}},{key:"getType",value:function(){return this._modelType}},{key:"toString",value:function(){var y="UNKNOWN";return this._modelType===I.FLOATING?y="Floating":this._modelType===I.FLOATING_SINGLE?y="Floating-Single":this._modelType===I.FIXED&&(y="Fixed (Scale="+this.getScale()+")"),y}},{key:"makePrecise",value:function(){if(typeof arguments[0]=="number"){var y=arguments[0];return Ie.isNaN(y)||this._modelType===I.FLOATING_SINGLE?y:this._modelType===I.FIXED?Math.round(y*this._scale)/this._scale:y}if(arguments[0]instanceof Be){var _=arguments[0];if(this._modelType===I.FLOATING)return null;_.x=this.makePrecise(_.x),_.y=this.makePrecise(_.y)}}},{key:"getMaximumSignificantDigits",value:function(){var y=16;return this._modelType===I.FLOATING?y=16:this._modelType===I.FLOATING_SINGLE?y=6:this._modelType===I.FIXED&&(y=1+Math.trunc(Math.ceil(Math.log(this.getScale())/Math.log(10)))),y}},{key:"setScale",value:function(y){this._scale=Math.abs(y)}},{key:"interfaces_",get:function(){return[X,H]}}],[{key:"constructor_",value:function(){if(this._modelType=null,this._scale=null,arguments.length===0)this._modelType=I.FLOATING;else if(arguments.length===1){if(arguments[0]instanceof Za){var y=arguments[0];this._modelType=y,y===I.FIXED&&this.setScale(1)}else if(typeof arguments[0]=="number"){var _=arguments[0];this._modelType=I.FIXED,this.setScale(_)}else if(arguments[0]instanceof I){var P=arguments[0];this._modelType=P._modelType,this._scale=P._scale}}}},{key:"mostPrecise",value:function(y,_){return y.compareTo(_)>=0?y:_}}])})(),Za=(function(){function I(){i(this,I),I.constructor_.apply(this,arguments)}return o(I,[{key:"readResolve",value:function(){return I.nameToTypeMap.get(this._name)}},{key:"toString",value:function(){return this._name}},{key:"interfaces_",get:function(){return[X]}}],[{key:"constructor_",value:function(){this._name=null;var y=arguments[0];this._name=y,I.nameToTypeMap.put(y,this)}}])})();Za.nameToTypeMap=new Iu,ga.Type=Za,ga.FIXED=new Za("FIXED"),ga.FLOATING=new Za("FLOATING"),ga.FLOATING_SINGLE=new Za("FLOATING SINGLE"),ga.maximumPreciseValue=9007199254740992;var ds=(function(I){function y(){var _;return i(this,y),_=n(this,y),y.constructor_.apply(_,arguments),_}return m(y,I),o(y,[{key:"copyInternal",value:function(){for(var _=new Array(this._geometries.length).fill(null),P=0;P<_.length;P++)_[P]=this._geometries[P].copy();return new y(_,this._factory)}},{key:"equalsExact",value:function(){if(arguments.length===2&&typeof arguments[1]=="number"&&arguments[0]instanceof it){var _=arguments[0],P=arguments[1];return!!this.isEquivalentClass(_)&&E(y,"equalsExact",this,1).call(this,_,P)}return E(y,"equalsExact",this,1).apply(this,arguments)}},{key:"getBoundaryDimension",value:function(){return this.isClosed()?nr.FALSE:0}},{key:"isClosed",value:function(){if(this.isEmpty())return!1;for(var _=0;_<this._geometries.length;_++)if(!this._geometries[_].isClosed())return!1;return!0}},{key:"getTypeCode",value:function(){return it.TYPECODE_MULTILINESTRING}},{key:"getDimension",value:function(){return 1}},{key:"getBoundary",value:function(){throw new $e}},{key:"getGeometryType",value:function(){return it.TYPENAME_MULTILINESTRING}},{key:"interfaces_",get:function(){return[jn]}}],[{key:"constructor_",value:function(){var _=arguments[0],P=arguments[1];Fr.constructor_.call(this,_,P)}}])})(Fr),Aa=(function(){function I(){i(this,I),I.constructor_.apply(this,arguments)}return o(I,[{key:"createEmpty",value:function(y){switch(y){case-1:return this.createGeometryCollection();case 0:return this.createPoint();case 1:return this.createLineString();case 2:return this.createPolygon();default:throw new U("Invalid dimension: "+y)}}},{key:"toGeometry",value:function(y){return y.isNull()?this.createPoint():y.getMinX()===y.getMaxX()&&y.getMinY()===y.getMaxY()?this.createPoint(new Be(y.getMinX(),y.getMinY())):y.getMinX()===y.getMaxX()||y.getMinY()===y.getMaxY()?this.createLineString([new Be(y.getMinX(),y.getMinY()),new Be(y.getMaxX(),y.getMaxY())]):this.createPolygon(this.createLinearRing([new Be(y.getMinX(),y.getMinY()),new Be(y.getMinX(),y.getMaxY()),new Be(y.getMaxX(),y.getMaxY()),new Be(y.getMaxX(),y.getMinY()),new Be(y.getMinX(),y.getMinY())]),null)}},{key:"createLineString",value:function(){if(arguments.length===0)return this.createLineString(this.getCoordinateSequenceFactory().create([]));if(arguments.length===1){if(arguments[0]instanceof Array){var y=arguments[0];return this.createLineString(y!==null?this.getCoordinateSequenceFactory().create(y):null)}if(Er(arguments[0],qe))return new Kn(arguments[0],this)}}},{key:"createMultiLineString",value:function(){return arguments.length===0?new ds(null,this):arguments.length===1?new ds(arguments[0],this):void 0}},{key:"buildGeometry",value:function(y){for(var _=null,P=!1,$=!1,ne=y.iterator();ne.hasNext();){var me=ne.next(),Oe=me.getTypeCode();_===null&&(_=Oe),Oe!==_&&(P=!0),me instanceof Fr&&($=!0)}if(_===null)return this.createGeometryCollection();if(P||$)return this.createGeometryCollection(I.toGeometryArray(y));var tt=y.iterator().next();if(y.size()>1){if(tt instanceof Xr)return this.createMultiPolygon(I.toPolygonArray(y));if(tt instanceof Kn)return this.createMultiLineString(I.toLineStringArray(y));if(tt instanceof He)return this.createMultiPoint(I.toPointArray(y));we.shouldNeverReachHere("Unhandled geometry type: "+tt.getGeometryType())}return tt}},{key:"createMultiPointFromCoords",value:function(y){return this.createMultiPoint(y!==null?this.getCoordinateSequenceFactory().create(y):null)}},{key:"createPoint",value:function(){if(arguments.length===0)return this.createPoint(this.getCoordinateSequenceFactory().create([]));if(arguments.length===1){if(arguments[0]instanceof Be){var y=arguments[0];return this.createPoint(y!==null?this.getCoordinateSequenceFactory().create([y]):null)}if(Er(arguments[0],qe))return new He(arguments[0],this)}}},{key:"getCoordinateSequenceFactory",value:function(){return this._coordinateSequenceFactory}},{key:"createPolygon",value:function(){if(arguments.length===0)return this.createPolygon(null,null);if(arguments.length===1){if(Er(arguments[0],qe)){var y=arguments[0];return this.createPolygon(this.createLinearRing(y))}if(arguments[0]instanceof Array){var _=arguments[0];return this.createPolygon(this.createLinearRing(_))}if(arguments[0]instanceof Bn){var P=arguments[0];return this.createPolygon(P,null)}}else if(arguments.length===2)return new Xr(arguments[0],arguments[1],this)}},{key:"getSRID",value:function(){return this._SRID}},{key:"createGeometryCollection",value:function(){return arguments.length===0?new Fr(null,this):arguments.length===1?new Fr(arguments[0],this):void 0}},{key:"getPrecisionModel",value:function(){return this._precisionModel}},{key:"createLinearRing",value:function(){if(arguments.length===0)return this.createLinearRing(this.getCoordinateSequenceFactory().create([]));if(arguments.length===1){if(arguments[0]instanceof Array){var y=arguments[0];return this.createLinearRing(y!==null?this.getCoordinateSequenceFactory().create(y):null)}if(Er(arguments[0],qe))return new Bn(arguments[0],this)}}},{key:"createMultiPolygon",value:function(){return arguments.length===0?new xi(null,this):arguments.length===1?new xi(arguments[0],this):void 0}},{key:"createMultiPoint",value:function(){if(arguments.length===0)return new Mn(null,this);if(arguments.length===1){if(arguments[0]instanceof Array)return new Mn(arguments[0],this);if(Er(arguments[0],qe)){var y=arguments[0];if(y===null)return this.createMultiPoint(new Array(0).fill(null));for(var _=new Array(y.size()).fill(null),P=0;P<y.size();P++){var $=this.getCoordinateSequenceFactory().create(1,y.getDimension(),y.getMeasures());Qr.copy(y,P,$,0,1),_[P]=this.createPoint($)}return this.createMultiPoint(_)}}}},{key:"interfaces_",get:function(){return[X]}}],[{key:"constructor_",value:function(){if(this._precisionModel=null,this._coordinateSequenceFactory=null,this._SRID=null,arguments.length===0)I.constructor_.call(this,new ga,0);else if(arguments.length===1){if(Er(arguments[0],zr)){var y=arguments[0];I.constructor_.call(this,new ga,0,y)}else if(arguments[0]instanceof ga){var _=arguments[0];I.constructor_.call(this,_,0,I.getDefaultCoordinateSequenceFactory())}}else if(arguments.length===2){var P=arguments[0],$=arguments[1];I.constructor_.call(this,P,$,I.getDefaultCoordinateSequenceFactory())}else if(arguments.length===3){var ne=arguments[0],me=arguments[1],Oe=arguments[2];this._precisionModel=ne,this._coordinateSequenceFactory=Oe,this._SRID=me}}},{key:"toMultiPolygonArray",value:function(y){var _=new Array(y.size()).fill(null);return y.toArray(_)}},{key:"toGeometryArray",value:function(y){if(y===null)return null;var _=new Array(y.size()).fill(null);return y.toArray(_)}},{key:"getDefaultCoordinateSequenceFactory",value:function(){return ol.instance()}},{key:"toMultiLineStringArray",value:function(y){var _=new Array(y.size()).fill(null);return y.toArray(_)}},{key:"toLineStringArray",value:function(y){var _=new Array(y.size()).fill(null);return y.toArray(_)}},{key:"toMultiPointArray",value:function(y){var _=new Array(y.size()).fill(null);return y.toArray(_)}},{key:"toLinearRingArray",value:function(y){var _=new Array(y.size()).fill(null);return y.toArray(_)}},{key:"toPointArray",value:function(y){var _=new Array(y.size()).fill(null);return y.toArray(_)}},{key:"toPolygonArray",value:function(y){var _=new Array(y.size()).fill(null);return y.toArray(_)}},{key:"createPointFromInternalCoord",value:function(y,_){return _.getPrecisionModel().makePrecise(y),_.getFactory().createPoint(y)}}])})(),ps="XY",Ul="XYZ",Fa="XYM",_a="XYZM",wc={POINT:"Point",LINE_STRING:"LineString",LINEAR_RING:"LinearRing",POLYGON:"Polygon",MULTI_POINT:"MultiPoint",MULTI_LINE_STRING:"MultiLineString",MULTI_POLYGON:"MultiPolygon",GEOMETRY_COLLECTION:"GeometryCollection",CIRCLE:"Circle"},sl="EMPTY",ts=1,oo=2,rs=3,Ba=4,Us=5,$c=6;for(var Pu in wc)wc[Pu].toUpperCase();var ee=(function(){return o((function I(y){i(this,I),this.wkt=y,this.index_=-1}),[{key:"isAlpha_",value:function(I){return I>="a"&&I<="z"||I>="A"&&I<="Z"}},{key:"isNumeric_",value:function(I,y){return I>="0"&&I<="9"||I=="."&&!(y!==void 0&&y)}},{key:"isWhiteSpace_",value:function(I){return I==" "||I=="	"||I=="\r"||I==`
`}},{key:"nextChar_",value:function(){return this.wkt.charAt(++this.index_)}},{key:"nextToken",value:function(){var I,y=this.nextChar_(),_=this.index_,P=y;if(y=="(")I=oo;else if(y==",")I=Us;else if(y==")")I=rs;else if(this.isNumeric_(y)||y=="-")I=Ba,P=this.readNumber_();else if(this.isAlpha_(y))I=ts,P=this.readText_();else{if(this.isWhiteSpace_(y))return this.nextToken();if(y!=="")throw new Error("Unexpected character: "+y);I=$c}return{position:_,value:P,type:I}}},{key:"readNumber_",value:function(){var I,y=this.index_,_=!1,P=!1;do I=="."?_=!0:I!="e"&&I!="E"||(P=!0),I=this.nextChar_();while(this.isNumeric_(I,_)||!P&&(I=="e"||I=="E")||P&&(I=="-"||I=="+"));return parseFloat(this.wkt.substring(y,this.index_--))}},{key:"readText_",value:function(){var I,y=this.index_;do I=this.nextChar_();while(this.isAlpha_(I));return this.wkt.substring(y,this.index_--).toUpperCase()}}])})(),pe=(function(){return o((function I(y,_){i(this,I),this.lexer_=y,this.token_,this.layout_=ps,this.factory=_}),[{key:"consume_",value:function(){this.token_=this.lexer_.nextToken()}},{key:"isTokenType",value:function(I){return this.token_.type==I}},{key:"match",value:function(I){var y=this.isTokenType(I);return y&&this.consume_(),y}},{key:"parse",value:function(){return this.consume_(),this.parseGeometry_()}},{key:"parseGeometryLayout_",value:function(){var I=ps,y=this.token_;if(this.isTokenType(ts)){var _=y.value;_==="Z"?I=Ul:_==="M"?I=Fa:_==="ZM"&&(I=_a),I!==ps&&this.consume_()}return I}},{key:"parseGeometryCollectionText_",value:function(){if(this.match(oo)){var I=[];do I.push(this.parseGeometry_());while(this.match(Us));if(this.match(rs))return I}else if(this.isEmptyGeometry_())return[];throw new Error(this.formatErrorMessage_())}},{key:"parsePointText_",value:function(){if(this.match(oo)){var I=this.parsePoint_();if(this.match(rs))return I}else if(this.isEmptyGeometry_())return null;throw new Error(this.formatErrorMessage_())}},{key:"parseLineStringText_",value:function(){if(this.match(oo)){var I=this.parsePointList_();if(this.match(rs))return I}else if(this.isEmptyGeometry_())return[];throw new Error(this.formatErrorMessage_())}},{key:"parsePolygonText_",value:function(){if(this.match(oo)){var I=this.parseLineStringTextList_();if(this.match(rs))return I}else if(this.isEmptyGeometry_())return[];throw new Error(this.formatErrorMessage_())}},{key:"parseMultiPointText_",value:function(){var I;if(this.match(oo)){if(I=this.token_.type==oo?this.parsePointTextList_():this.parsePointList_(),this.match(rs))return I}else if(this.isEmptyGeometry_())return[];throw new Error(this.formatErrorMessage_())}},{key:"parseMultiLineStringText_",value:function(){if(this.match(oo)){var I=this.parseLineStringTextList_();if(this.match(rs))return I}else if(this.isEmptyGeometry_())return[];throw new Error(this.formatErrorMessage_())}},{key:"parseMultiPolygonText_",value:function(){if(this.match(oo)){var I=this.parsePolygonTextList_();if(this.match(rs))return I}else if(this.isEmptyGeometry_())return[];throw new Error(this.formatErrorMessage_())}},{key:"parsePoint_",value:function(){for(var I=[],y=this.layout_.length,_=0;_<y;++_){var P=this.token_;if(!this.match(Ba))break;I.push(P.value)}if(I.length==y)return I;throw new Error(this.formatErrorMessage_())}},{key:"parsePointList_",value:function(){for(var I=[this.parsePoint_()];this.match(Us);)I.push(this.parsePoint_());return I}},{key:"parsePointTextList_",value:function(){for(var I=[this.parsePointText_()];this.match(Us);)I.push(this.parsePointText_());return I}},{key:"parseLineStringTextList_",value:function(){for(var I=[this.parseLineStringText_()];this.match(Us);)I.push(this.parseLineStringText_());return I}},{key:"parsePolygonTextList_",value:function(){for(var I=[this.parsePolygonText_()];this.match(Us);)I.push(this.parsePolygonText_());return I}},{key:"isEmptyGeometry_",value:function(){var I=this.isTokenType(ts)&&this.token_.value==sl;return I&&this.consume_(),I}},{key:"formatErrorMessage_",value:function(){return"Unexpected `"+this.token_.value+"` at position "+this.token_.position+" in `"+this.lexer_.wkt+"`"}},{key:"parseGeometry_",value:function(){var I=this.factory,y=function(Xn){return a(Be,T(Xn))},_=function(Xn){var Fn=Xn.map((function(En){return I.createLinearRing(En.map(y))}));return Fn.length>1?I.createPolygon(Fn[0],Fn.slice(1)):I.createPolygon(Fn[0])},P=this.token_;if(this.match(ts)){var $=P.value;if(this.layout_=this.parseGeometryLayout_(),$=="GEOMETRYCOLLECTION"){var ne=this.parseGeometryCollectionText_();return I.createGeometryCollection(ne)}switch($){case"POINT":var me=this.parsePointText_();return me?I.createPoint(a(Be,T(me))):I.createPoint();case"LINESTRING":var Oe=this.parseLineStringText_().map(y);return I.createLineString(Oe);case"LINEARRING":var tt=this.parseLineStringText_().map(y);return I.createLinearRing(tt);case"POLYGON":var ft=this.parsePolygonText_();return ft&&ft.length!==0?_(ft):I.createPolygon();case"MULTIPOINT":var rr=this.parseMultiPointText_();if(!rr||rr.length===0)return I.createMultiPoint();var ur=rr.map(y).map((function(Xn){return I.createPoint(Xn)}));return I.createMultiPoint(ur);case"MULTILINESTRING":var qr=this.parseMultiLineStringText_().map((function(Xn){return I.createLineString(Xn.map(y))}));return I.createMultiLineString(qr);case"MULTIPOLYGON":var bn=this.parseMultiPolygonText_();if(!bn||bn.length===0)return I.createMultiPolygon();var Dn=bn.map(_);return I.createMultiPolygon(Dn);default:throw new Error("Invalid geometry type: "+$)}}throw new Error(this.formatErrorMessage_())}}])})();function Ke(I){if(I.isEmpty())return"";var y=I.getCoordinate(),_=[y.x,y.y];return y.z===void 0||Number.isNaN(y.z)||_.push(y.z),y.m===void 0||Number.isNaN(y.m)||_.push(y.m),_.join(" ")}function It(I){for(var y=I.getCoordinates().map((function(ne){var me=[ne.x,ne.y];return ne.z===void 0||Number.isNaN(ne.z)||me.push(ne.z),ne.m===void 0||Number.isNaN(ne.m)||me.push(ne.m),me})),_=[],P=0,$=y.length;P<$;++P)_.push(y[P].join(" "));return _.join(", ")}function Vt(I){var y=[];y.push("("+It(I.getExteriorRing())+")");for(var _=0,P=I.getNumInteriorRing();_<P;++_)y.push("("+It(I.getInteriorRingN(_))+")");return y.join(", ")}var qt={Point:Ke,LineString:It,LinearRing:It,Polygon:Vt,MultiPoint:function(I){for(var y=[],_=0,P=I.getNumGeometries();_<P;++_)y.push("("+Ke(I.getGeometryN(_))+")");return y.join(", ")},MultiLineString:function(I){for(var y=[],_=0,P=I.getNumGeometries();_<P;++_)y.push("("+It(I.getGeometryN(_))+")");return y.join(", ")},MultiPolygon:function(I){for(var y=[],_=0,P=I.getNumGeometries();_<P;++_)y.push("("+Vt(I.getGeometryN(_))+")");return y.join(", ")},GeometryCollection:function(I){for(var y=[],_=0,P=I.getNumGeometries();_<P;++_)y.push(er(I.getGeometryN(_)));return y.join(", ")}};function er(I){var y=I.getGeometryType(),_=qt[y];y=y.toUpperCase();var P=(function($){var ne="";if($.isEmpty())return ne;var me=$.getCoordinate();return me.z===void 0||Number.isNaN(me.z)||(ne+="Z"),me.m===void 0||Number.isNaN(me.m)||(ne+="M"),ne})(I);return P.length>0&&(y+=" "+P),I.isEmpty()?y+" "+sl:y+" ("+_(I)+")"}var Yr=(function(){return o((function I(y){i(this,I),this.geometryFactory=y||new Aa,this.precisionModel=this.geometryFactory.getPrecisionModel()}),[{key:"read",value:function(I){var y=new ee(I);return new pe(y,this.geometryFactory).parse()}},{key:"write",value:function(I){return er(I)}}])})(),tn=(function(){return o((function I(y){i(this,I),this.parser=new Yr(y)}),[{key:"write",value:function(I){return this.parser.write(I)}}],[{key:"toLineString",value:function(I,y){if(arguments.length!==2)throw new Error("Not implemented");return"LINESTRING ( "+I.x+" "+I.y+", "+y.x+" "+y.y+" )"}}])})(),Gr=(function(){function I(){i(this,I),I.constructor_.apply(this,arguments)}return o(I,[{key:"getIndexAlongSegment",value:function(y,_){return this.computeIntLineIndex(),this._intLineIndex[y][_]}},{key:"getTopologySummary",value:function(){var y=new Mo;return this.isEndPoint()&&y.append(" endpoint"),this._isProper&&y.append(" proper"),this.isCollinear()&&y.append(" collinear"),y.toString()}},{key:"computeIntersection",value:function(y,_,P,$){this._inputLines[0][0]=y,this._inputLines[0][1]=_,this._inputLines[1][0]=P,this._inputLines[1][1]=$,this._result=this.computeIntersect(y,_,P,$)}},{key:"getIntersectionNum",value:function(){return this._result}},{key:"computeIntLineIndex",value:function(){if(arguments.length===0)this._intLineIndex===null&&(this._intLineIndex=Array(2).fill().map((function(){return Array(2)})),this.computeIntLineIndex(0),this.computeIntLineIndex(1));else if(arguments.length===1){var y=arguments[0];this.getEdgeDistance(y,0)>this.getEdgeDistance(y,1)?(this._intLineIndex[y][0]=0,this._intLineIndex[y][1]=1):(this._intLineIndex[y][0]=1,this._intLineIndex[y][1]=0)}}},{key:"isProper",value:function(){return this.hasIntersection()&&this._isProper}},{key:"setPrecisionModel",value:function(y){this._precisionModel=y}},{key:"isInteriorIntersection",value:function(){if(arguments.length===0)return!!this.isInteriorIntersection(0)||!!this.isInteriorIntersection(1);if(arguments.length===1){for(var y=arguments[0],_=0;_<this._result;_++)if(!this._intPt[_].equals2D(this._inputLines[y][0])&&!this._intPt[_].equals2D(this._inputLines[y][1]))return!0;return!1}}},{key:"getIntersection",value:function(y){return this._intPt[y]}},{key:"isEndPoint",value:function(){return this.hasIntersection()&&!this._isProper}},{key:"hasIntersection",value:function(){return this._result!==I.NO_INTERSECTION}},{key:"getEdgeDistance",value:function(y,_){return I.computeEdgeDistance(this._intPt[_],this._inputLines[y][0],this._inputLines[y][1])}},{key:"isCollinear",value:function(){return this._result===I.COLLINEAR_INTERSECTION}},{key:"toString",value:function(){return tn.toLineString(this._inputLines[0][0],this._inputLines[0][1])+" - "+tn.toLineString(this._inputLines[1][0],this._inputLines[1][1])+this.getTopologySummary()}},{key:"getEndpoint",value:function(y,_){return this._inputLines[y][_]}},{key:"isIntersection",value:function(y){for(var _=0;_<this._result;_++)if(this._intPt[_].equals2D(y))return!0;return!1}},{key:"getIntersectionAlongSegment",value:function(y,_){return this.computeIntLineIndex(),this._intPt[this._intLineIndex[y][_]]}}],[{key:"constructor_",value:function(){this._result=null,this._inputLines=Array(2).fill().map((function(){return Array(2)})),this._intPt=new Array(2).fill(null),this._intLineIndex=null,this._isProper=null,this._pa=null,this._pb=null,this._precisionModel=null,this._intPt[0]=new Be,this._intPt[1]=new Be,this._pa=this._intPt[0],this._pb=this._intPt[1],this._result=0}},{key:"computeEdgeDistance",value:function(y,_,P){var $=Math.abs(P.x-_.x),ne=Math.abs(P.y-_.y),me=-1;if(y.equals(_))me=0;else if(y.equals(P))me=$>ne?$:ne;else{var Oe=Math.abs(y.x-_.x),tt=Math.abs(y.y-_.y);(me=$>ne?Oe:tt)!==0||y.equals(_)||(me=Math.max(Oe,tt))}return we.isTrue(!(me===0&&!y.equals(_)),"Bad distance calculation"),me}},{key:"nonRobustComputeEdgeDistance",value:function(y,_,P){var $=y.x-_.x,ne=y.y-_.y,me=Math.sqrt($*$+ne*ne);return we.isTrue(!(me===0&&!y.equals(_)),"Invalid distance calculation"),me}}])})();Gr.DONT_INTERSECT=0,Gr.DO_INTERSECT=1,Gr.COLLINEAR=2,Gr.NO_INTERSECTION=0,Gr.POINT_INTERSECTION=1,Gr.COLLINEAR_INTERSECTION=2;var on=(function(I){function y(){return i(this,y),n(this,y)}return m(y,I),o(y,[{key:"isInSegmentEnvelopes",value:function(_){var P=new Qe(this._inputLines[0][0],this._inputLines[0][1]),$=new Qe(this._inputLines[1][0],this._inputLines[1][1]);return P.contains(_)&&$.contains(_)}},{key:"computeIntersection",value:function(){if(arguments.length!==3)return E(y,"computeIntersection",this,1).apply(this,arguments);var _=arguments[0],P=arguments[1],$=arguments[2];if(this._isProper=!1,Qe.intersects(P,$,_)&&Ge.index(P,$,_)===0&&Ge.index($,P,_)===0)return this._isProper=!0,(_.equals(P)||_.equals($))&&(this._isProper=!1),this._result=Gr.POINT_INTERSECTION,null;this._result=Gr.NO_INTERSECTION}},{key:"intersection",value:function(_,P,$,ne){var me=this.intersectionSafe(_,P,$,ne);return this.isInSegmentEnvelopes(me)||(me=new Be(y.nearestEndpoint(_,P,$,ne))),this._precisionModel!==null&&this._precisionModel.makePrecise(me),me}},{key:"checkDD",value:function(_,P,$,ne,me){var Oe=je.intersection(_,P,$,ne),tt=this.isInSegmentEnvelopes(Oe);Ar.out.println("DD in env = "+tt+"  --------------------- "+Oe),me.distance(Oe)>1e-4&&Ar.out.println("Distance = "+me.distance(Oe))}},{key:"intersectionSafe",value:function(_,P,$,ne){var me=Ir.intersection(_,P,$,ne);return me===null&&(me=y.nearestEndpoint(_,P,$,ne)),me}},{key:"computeCollinearIntersection",value:function(_,P,$,ne){var me=Qe.intersects(_,P,$),Oe=Qe.intersects(_,P,ne),tt=Qe.intersects($,ne,_),ft=Qe.intersects($,ne,P);return me&&Oe?(this._intPt[0]=$,this._intPt[1]=ne,Gr.COLLINEAR_INTERSECTION):tt&&ft?(this._intPt[0]=_,this._intPt[1]=P,Gr.COLLINEAR_INTERSECTION):me&&tt?(this._intPt[0]=$,this._intPt[1]=_,!$.equals(_)||Oe||ft?Gr.COLLINEAR_INTERSECTION:Gr.POINT_INTERSECTION):me&&ft?(this._intPt[0]=$,this._intPt[1]=P,!$.equals(P)||Oe||tt?Gr.COLLINEAR_INTERSECTION:Gr.POINT_INTERSECTION):Oe&&tt?(this._intPt[0]=ne,this._intPt[1]=_,!ne.equals(_)||me||ft?Gr.COLLINEAR_INTERSECTION:Gr.POINT_INTERSECTION):Oe&&ft?(this._intPt[0]=ne,this._intPt[1]=P,!ne.equals(P)||me||tt?Gr.COLLINEAR_INTERSECTION:Gr.POINT_INTERSECTION):Gr.NO_INTERSECTION}},{key:"computeIntersect",value:function(_,P,$,ne){if(this._isProper=!1,!Qe.intersects(_,P,$,ne))return Gr.NO_INTERSECTION;var me=Ge.index(_,P,$),Oe=Ge.index(_,P,ne);if(me>0&&Oe>0||me<0&&Oe<0)return Gr.NO_INTERSECTION;var tt=Ge.index($,ne,_),ft=Ge.index($,ne,P);return tt>0&&ft>0||tt<0&&ft<0?Gr.NO_INTERSECTION:me===0&&Oe===0&&tt===0&&ft===0?this.computeCollinearIntersection(_,P,$,ne):(me===0||Oe===0||tt===0||ft===0?(this._isProper=!1,_.equals2D($)||_.equals2D(ne)?this._intPt[0]=_:P.equals2D($)||P.equals2D(ne)?this._intPt[0]=P:me===0?this._intPt[0]=new Be($):Oe===0?this._intPt[0]=new Be(ne):tt===0?this._intPt[0]=new Be(_):ft===0&&(this._intPt[0]=new Be(P))):(this._isProper=!0,this._intPt[0]=this.intersection(_,P,$,ne)),Gr.POINT_INTERSECTION)}}],[{key:"nearestEndpoint",value:function(_,P,$,ne){var me=_,Oe=fn.pointToSegment(_,$,ne),tt=fn.pointToSegment(P,$,ne);return tt<Oe&&(Oe=tt,me=P),(tt=fn.pointToSegment($,_,P))<Oe&&(Oe=tt,me=$),(tt=fn.pointToSegment(ne,_,P))<Oe&&(Oe=tt,me=ne),me}}])})(Gr),kr=(function(){function I(){i(this,I),I.constructor_.apply(this,arguments)}return o(I,[{key:"countSegment",value:function(y,_){if(y.x<this._p.x&&_.x<this._p.x)return null;if(this._p.x===_.x&&this._p.y===_.y)return this._isPointOnSegment=!0,null;if(y.y===this._p.y&&_.y===this._p.y){var P=y.x,$=_.x;return P>$&&(P=_.x,$=y.x),this._p.x>=P&&this._p.x<=$&&(this._isPointOnSegment=!0),null}if(y.y>this._p.y&&_.y<=this._p.y||_.y>this._p.y&&y.y<=this._p.y){var ne=Ge.index(y,_,this._p);if(ne===Ge.COLLINEAR)return this._isPointOnSegment=!0,null;_.y<y.y&&(ne=-ne),ne===Ge.LEFT&&this._crossingCount++}}},{key:"isPointInPolygon",value:function(){return this.getLocation()!==be.EXTERIOR}},{key:"getLocation",value:function(){return this._isPointOnSegment?be.BOUNDARY:this._crossingCount%2==1?be.INTERIOR:be.EXTERIOR}},{key:"isOnSegment",value:function(){return this._isPointOnSegment}}],[{key:"constructor_",value:function(){this._p=null,this._crossingCount=0,this._isPointOnSegment=!1;var y=arguments[0];this._p=y}},{key:"locatePointInRing",value:function(){if(arguments[0]instanceof Be&&Er(arguments[1],qe)){for(var y=arguments[1],_=new I(arguments[0]),P=new Be,$=new Be,ne=1;ne<y.size();ne++)if(y.getCoordinate(ne,P),y.getCoordinate(ne-1,$),_.countSegment(P,$),_.isOnSegment())return _.getLocation();return _.getLocation()}if(arguments[0]instanceof Be&&arguments[1]instanceof Array){for(var me=arguments[1],Oe=new I(arguments[0]),tt=1;tt<me.length;tt++){var ft=me[tt],rr=me[tt-1];if(Oe.countSegment(ft,rr),Oe.isOnSegment())return Oe.getLocation()}return Oe.getLocation()}}}])})(),ti=(function(){function I(){i(this,I)}return o(I,null,[{key:"isOnLine",value:function(){if(arguments[0]instanceof Be&&Er(arguments[1],qe)){for(var y=arguments[0],_=arguments[1],P=new on,$=new Be,ne=new Be,me=_.size(),Oe=1;Oe<me;Oe++)if(_.getCoordinate(Oe-1,$),_.getCoordinate(Oe,ne),P.computeIntersection(y,$,ne),P.hasIntersection())return!0;return!1}if(arguments[0]instanceof Be&&arguments[1]instanceof Array){for(var tt=arguments[0],ft=arguments[1],rr=new on,ur=1;ur<ft.length;ur++){var qr=ft[ur-1],bn=ft[ur];if(rr.computeIntersection(tt,qr,bn),rr.hasIntersection())return!0}return!1}}},{key:"locateInRing",value:function(y,_){return kr.locatePointInRing(y,_)}},{key:"isInRing",value:function(y,_){return I.locateInRing(y,_)!==be.EXTERIOR}}])})(),Ri=(function(){function I(){i(this,I),I.constructor_.apply(this,arguments)}return o(I,[{key:"setAllLocations",value:function(y){for(var _=0;_<this.location.length;_++)this.location[_]=y}},{key:"isNull",value:function(){for(var y=0;y<this.location.length;y++)if(this.location[y]!==be.NONE)return!1;return!0}},{key:"setAllLocationsIfNull",value:function(y){for(var _=0;_<this.location.length;_++)this.location[_]===be.NONE&&(this.location[_]=y)}},{key:"isLine",value:function(){return this.location.length===1}},{key:"merge",value:function(y){if(y.location.length>this.location.length){var _=new Array(3).fill(null);_[_t.ON]=this.location[_t.ON],_[_t.LEFT]=be.NONE,_[_t.RIGHT]=be.NONE,this.location=_}for(var P=0;P<this.location.length;P++)this.location[P]===be.NONE&&P<y.location.length&&(this.location[P]=y.location[P])}},{key:"getLocations",value:function(){return this.location}},{key:"flip",value:function(){if(this.location.length<=1)return null;var y=this.location[_t.LEFT];this.location[_t.LEFT]=this.location[_t.RIGHT],this.location[_t.RIGHT]=y}},{key:"toString",value:function(){var y=new Jt;return this.location.length>1&&y.append(be.toLocationSymbol(this.location[_t.LEFT])),y.append(be.toLocationSymbol(this.location[_t.ON])),this.location.length>1&&y.append(be.toLocationSymbol(this.location[_t.RIGHT])),y.toString()}},{key:"setLocations",value:function(y,_,P){this.location[_t.ON]=y,this.location[_t.LEFT]=_,this.location[_t.RIGHT]=P}},{key:"get",value:function(y){return y<this.location.length?this.location[y]:be.NONE}},{key:"isArea",value:function(){return this.location.length>1}},{key:"isAnyNull",value:function(){for(var y=0;y<this.location.length;y++)if(this.location[y]===be.NONE)return!0;return!1}},{key:"setLocation",value:function(){if(arguments.length===1){var y=arguments[0];this.setLocation(_t.ON,y)}else if(arguments.length===2){var _=arguments[0],P=arguments[1];this.location[_]=P}}},{key:"init",value:function(y){this.location=new Array(y).fill(null),this.setAllLocations(be.NONE)}},{key:"isEqualOnSide",value:function(y,_){return this.location[_]===y.location[_]}},{key:"allPositionsEqual",value:function(y){for(var _=0;_<this.location.length;_++)if(this.location[_]!==y)return!1;return!0}}],[{key:"constructor_",value:function(){if(this.location=null,arguments.length===1){if(arguments[0]instanceof Array){var y=arguments[0];this.init(y.length)}else if(Number.isInteger(arguments[0])){var _=arguments[0];this.init(1),this.location[_t.ON]=_}else if(arguments[0]instanceof I){var P=arguments[0];if(this.init(P.location.length),P!==null)for(var $=0;$<this.location.length;$++)this.location[$]=P.location[$]}}else if(arguments.length===3){var ne=arguments[0],me=arguments[1],Oe=arguments[2];this.init(3),this.location[_t.ON]=ne,this.location[_t.LEFT]=me,this.location[_t.RIGHT]=Oe}}}])})(),$n=(function(){function I(){i(this,I),I.constructor_.apply(this,arguments)}return o(I,[{key:"getGeometryCount",value:function(){var y=0;return this.elt[0].isNull()||y++,this.elt[1].isNull()||y++,y}},{key:"setAllLocations",value:function(y,_){this.elt[y].setAllLocations(_)}},{key:"isNull",value:function(y){return this.elt[y].isNull()}},{key:"setAllLocationsIfNull",value:function(){if(arguments.length===1){var y=arguments[0];this.setAllLocationsIfNull(0,y),this.setAllLocationsIfNull(1,y)}else if(arguments.length===2){var _=arguments[0],P=arguments[1];this.elt[_].setAllLocationsIfNull(P)}}},{key:"isLine",value:function(y){return this.elt[y].isLine()}},{key:"merge",value:function(y){for(var _=0;_<2;_++)this.elt[_]===null&&y.elt[_]!==null?this.elt[_]=new Ri(y.elt[_]):this.elt[_].merge(y.elt[_])}},{key:"flip",value:function(){this.elt[0].flip(),this.elt[1].flip()}},{key:"getLocation",value:function(){if(arguments.length===1){var y=arguments[0];return this.elt[y].get(_t.ON)}if(arguments.length===2){var _=arguments[0],P=arguments[1];return this.elt[_].get(P)}}},{key:"toString",value:function(){var y=new Jt;return this.elt[0]!==null&&(y.append("A:"),y.append(this.elt[0].toString())),this.elt[1]!==null&&(y.append(" B:"),y.append(this.elt[1].toString())),y.toString()}},{key:"isArea",value:function(){if(arguments.length===0)return this.elt[0].isArea()||this.elt[1].isArea();if(arguments.length===1){var y=arguments[0];return this.elt[y].isArea()}}},{key:"isAnyNull",value:function(y){return this.elt[y].isAnyNull()}},{key:"setLocation",value:function(){if(arguments.length===2){var y=arguments[0],_=arguments[1];this.elt[y].setLocation(_t.ON,_)}else if(arguments.length===3){var P=arguments[0],$=arguments[1],ne=arguments[2];this.elt[P].setLocation($,ne)}}},{key:"isEqualOnSide",value:function(y,_){return this.elt[0].isEqualOnSide(y.elt[0],_)&&this.elt[1].isEqualOnSide(y.elt[1],_)}},{key:"allPositionsEqual",value:function(y,_){return this.elt[y].allPositionsEqual(_)}},{key:"toLine",value:function(y){this.elt[y].isArea()&&(this.elt[y]=new Ri(this.elt[y].location[0]))}}],[{key:"constructor_",value:function(){if(this.elt=new Array(2).fill(null),arguments.length===1){if(Number.isInteger(arguments[0])){var y=arguments[0];this.elt[0]=new Ri(y),this.elt[1]=new Ri(y)}else if(arguments[0]instanceof I){var _=arguments[0];this.elt[0]=new Ri(_.elt[0]),this.elt[1]=new Ri(_.elt[1])}}else if(arguments.length===2){var P=arguments[0],$=arguments[1];this.elt[0]=new Ri(be.NONE),this.elt[1]=new Ri(be.NONE),this.elt[P].setLocation($)}else if(arguments.length===3){var ne=arguments[0],me=arguments[1],Oe=arguments[2];this.elt[0]=new Ri(ne,me,Oe),this.elt[1]=new Ri(ne,me,Oe)}else if(arguments.length===4){var tt=arguments[0],ft=arguments[1],rr=arguments[2],ur=arguments[3];this.elt[0]=new Ri(be.NONE,be.NONE,be.NONE),this.elt[1]=new Ri(be.NONE,be.NONE,be.NONE),this.elt[tt].setLocations(ft,rr,ur)}}},{key:"toLineLabel",value:function(y){for(var _=new I(be.NONE),P=0;P<2;P++)_.setLocation(P,y.getLocation(P));return _}}])})(),_n=(function(){return o((function I(){i(this,I),I.constructor_.apply(this,arguments)}),[{key:"computeRing",value:function(){if(this._ring!==null)return null;for(var I=new Array(this._pts.size()).fill(null),y=0;y<this._pts.size();y++)I[y]=this._pts.get(y);this._ring=this._geometryFactory.createLinearRing(I),this._isHole=Ge.isCCW(this._ring.getCoordinates())}},{key:"isIsolated",value:function(){return this._label.getGeometryCount()===1}},{key:"computePoints",value:function(I){this._startDe=I;var y=I,_=!0;do{if(y===null)throw new Et("Found null DirectedEdge");if(y.getEdgeRing()===this)throw new Et("Directed Edge visited twice during ring-building at "+y.getCoordinate());this._edges.add(y);var P=y.getLabel();we.isTrue(P.isArea()),this.mergeLabel(P),this.addPoints(y.getEdge(),y.isForward(),_),_=!1,this.setEdgeRing(y,this),y=this.getNext(y)}while(y!==this._startDe)}},{key:"getLinearRing",value:function(){return this._ring}},{key:"getCoordinate",value:function(I){return this._pts.get(I)}},{key:"computeMaxNodeDegree",value:function(){this._maxNodeDegree=0;var I=this._startDe;do{var y=I.getNode().getEdges().getOutgoingDegree(this);y>this._maxNodeDegree&&(this._maxNodeDegree=y),I=this.getNext(I)}while(I!==this._startDe);this._maxNodeDegree*=2}},{key:"addPoints",value:function(I,y,_){var P=I.getCoordinates();if(y){var $=1;_&&($=0);for(var ne=$;ne<P.length;ne++)this._pts.add(P[ne])}else{var me=P.length-2;_&&(me=P.length-1);for(var Oe=me;Oe>=0;Oe--)this._pts.add(P[Oe])}}},{key:"isHole",value:function(){return this._isHole}},{key:"setInResult",value:function(){var I=this._startDe;do I.getEdge().setInResult(!0),I=I.getNext();while(I!==this._startDe)}},{key:"containsPoint",value:function(I){var y=this.getLinearRing();if(!y.getEnvelopeInternal().contains(I)||!ti.isInRing(I,y.getCoordinates()))return!1;for(var _=this._holes.iterator();_.hasNext();)if(_.next().containsPoint(I))return!1;return!0}},{key:"addHole",value:function(I){this._holes.add(I)}},{key:"isShell",value:function(){return this._shell===null}},{key:"getLabel",value:function(){return this._label}},{key:"getEdges",value:function(){return this._edges}},{key:"getMaxNodeDegree",value:function(){return this._maxNodeDegree<0&&this.computeMaxNodeDegree(),this._maxNodeDegree}},{key:"getShell",value:function(){return this._shell}},{key:"mergeLabel",value:function(){if(arguments.length===1){var I=arguments[0];this.mergeLabel(I,0),this.mergeLabel(I,1)}else if(arguments.length===2){var y=arguments[1],_=arguments[0].getLocation(y,_t.RIGHT);if(_===be.NONE)return null;if(this._label.getLocation(y)===be.NONE)return this._label.setLocation(y,_),null}}},{key:"setShell",value:function(I){this._shell=I,I!==null&&I.addHole(this)}},{key:"toPolygon",value:function(I){for(var y=new Array(this._holes.size()).fill(null),_=0;_<this._holes.size();_++)y[_]=this._holes.get(_).getLinearRing();return I.createPolygon(this.getLinearRing(),y)}}],[{key:"constructor_",value:function(){if(this._startDe=null,this._maxNodeDegree=-1,this._edges=new ct,this._pts=new ct,this._label=new $n(be.NONE),this._ring=null,this._isHole=null,this._shell=null,this._holes=new ct,this._geometryFactory=null,arguments.length!==0){if(arguments.length===2){var I=arguments[0],y=arguments[1];this._geometryFactory=y,this.computePoints(I),this.computeRing()}}}}])})(),Mr=(function(I){function y(){var _;return i(this,y),_=n(this,y),y.constructor_.apply(_,arguments),_}return m(y,I),o(y,[{key:"setEdgeRing",value:function(_,P){_.setMinEdgeRing(P)}},{key:"getNext",value:function(_){return _.getNextMin()}}],[{key:"constructor_",value:function(){var _=arguments[0],P=arguments[1];_n.constructor_.call(this,_,P)}}])})(_n),hn=(function(I){function y(){var _;return i(this,y),_=n(this,y),y.constructor_.apply(_,arguments),_}return m(y,I),o(y,[{key:"buildMinimalRings",value:function(){var _=new ct,P=this._startDe;do{if(P.getMinEdgeRing()===null){var $=new Mr(P,this._geometryFactory);_.add($)}P=P.getNext()}while(P!==this._startDe);return _}},{key:"setEdgeRing",value:function(_,P){_.setEdgeRing(P)}},{key:"linkDirectedEdgesForMinimalEdgeRings",value:function(){var _=this._startDe;do _.getNode().getEdges().linkMinimalDirectedEdges(this),_=_.getNext();while(_!==this._startDe)}},{key:"getNext",value:function(_){return _.getNext()}}],[{key:"constructor_",value:function(){var _=arguments[0],P=arguments[1];_n.constructor_.call(this,_,P)}}])})(_n),mn=(function(){return o((function I(){i(this,I),I.constructor_.apply(this,arguments)}),[{key:"setVisited",value:function(I){this._isVisited=I}},{key:"setInResult",value:function(I){this._isInResult=I}},{key:"isCovered",value:function(){return this._isCovered}},{key:"isCoveredSet",value:function(){return this._isCoveredSet}},{key:"setLabel",value:function(I){this._label=I}},{key:"getLabel",value:function(){return this._label}},{key:"setCovered",value:function(I){this._isCovered=I,this._isCoveredSet=!0}},{key:"updateIM",value:function(I){we.isTrue(this._label.getGeometryCount()>=2,"found partial label"),this.computeIM(I)}},{key:"isInResult",value:function(){return this._isInResult}},{key:"isVisited",value:function(){return this._isVisited}}],[{key:"constructor_",value:function(){if(this._label=null,this._isInResult=!1,this._isCovered=!1,this._isCoveredSet=!1,this._isVisited=!1,arguments.length!==0){if(arguments.length===1){var I=arguments[0];this._label=I}}}}])})(),fi=(function(I){function y(){var _;return i(this,y),_=n(this,y),y.constructor_.apply(_,arguments),_}return m(y,I),o(y,[{key:"isIncidentEdgeInResult",value:function(){for(var _=this.getEdges().getEdges().iterator();_.hasNext();)if(_.next().getEdge().isInResult())return!0;return!1}},{key:"isIsolated",value:function(){return this._label.getGeometryCount()===1}},{key:"getCoordinate",value:function(){return this._coord}},{key:"print",value:function(_){_.println("node "+this._coord+" lbl: "+this._label)}},{key:"computeIM",value:function(_){}},{key:"computeMergedLocation",value:function(_,P){var $=be.NONE;if($=this._label.getLocation(P),!_.isNull(P)){var ne=_.getLocation(P);$!==be.BOUNDARY&&($=ne)}return $}},{key:"setLabel",value:function(){if(arguments.length!==2||!Number.isInteger(arguments[1])||!Number.isInteger(arguments[0]))return E(y,"setLabel",this,1).apply(this,arguments);var _=arguments[0],P=arguments[1];this._label===null?this._label=new $n(_,P):this._label.setLocation(_,P)}},{key:"getEdges",value:function(){return this._edges}},{key:"mergeLabel",value:function(){if(arguments[0]instanceof y){var _=arguments[0];this.mergeLabel(_._label)}else if(arguments[0]instanceof $n)for(var P=arguments[0],$=0;$<2;$++){var ne=this.computeMergedLocation(P,$);this._label.getLocation($)===be.NONE&&this._label.setLocation($,ne)}}},{key:"add",value:function(_){this._edges.insert(_),_.setNode(this)}},{key:"setLabelBoundary",value:function(_){if(this._label===null)return null;var P=be.NONE;this._label!==null&&(P=this._label.getLocation(_));var $=null;switch(P){case be.BOUNDARY:$=be.INTERIOR;break;case be.INTERIOR:default:$=be.BOUNDARY}this._label.setLocation(_,$)}}],[{key:"constructor_",value:function(){this._coord=null,this._edges=null;var _=arguments[0],P=arguments[1];this._coord=_,this._edges=P,this._label=new $n(0,be.NONE)}}])})(mn),$i=(function(I){function y(){return i(this,y),n(this,y,arguments)}return m(y,I),o(y)})(zi);function ba(I){return I==null?0:I.color}function wi(I){return I==null?null:I.parent}function hi(I,y){I!==null&&(I.color=y)}function Ts(I){return I==null?null:I.left}function Vs(I){return I==null?null:I.right}var Mi=(function(I){function y(){var _;return i(this,y),(_=n(this,y)).root_=null,_.size_=0,_}return m(y,I),o(y,[{key:"get",value:function(_){for(var P=this.root_;P!==null;){var $=_.compareTo(P.key);if($<0)P=P.left;else{if(!($>0))return P.value;P=P.right}}return null}},{key:"put",value:function(_,P){if(this.root_===null)return this.root_={key:_,value:P,left:null,right:null,parent:null,color:0,getValue:function(){return this.value},getKey:function(){return this.key}},this.size_=1,null;var $,ne,me=this.root_;do if($=me,(ne=_.compareTo(me.key))<0)me=me.left;else{if(!(ne>0)){var Oe=me.value;return me.value=P,Oe}me=me.right}while(me!==null);var tt={key:_,left:null,right:null,value:P,parent:$,color:0,getValue:function(){return this.value},getKey:function(){return this.key}};return ne<0?$.left=tt:$.right=tt,this.fixAfterInsertion(tt),this.size_++,null}},{key:"fixAfterInsertion",value:function(_){var P;for(_.color=1;_!=null&&_!==this.root_&&_.parent.color===1;)wi(_)===Ts(wi(wi(_)))?ba(P=Vs(wi(wi(_))))===1?(hi(wi(_),0),hi(P,0),hi(wi(wi(_)),1),_=wi(wi(_))):(_===Vs(wi(_))&&(_=wi(_),this.rotateLeft(_)),hi(wi(_),0),hi(wi(wi(_)),1),this.rotateRight(wi(wi(_)))):ba(P=Ts(wi(wi(_))))===1?(hi(wi(_),0),hi(P,0),hi(wi(wi(_)),1),_=wi(wi(_))):(_===Ts(wi(_))&&(_=wi(_),this.rotateRight(_)),hi(wi(_),0),hi(wi(wi(_)),1),this.rotateLeft(wi(wi(_))));this.root_.color=0}},{key:"values",value:function(){var _=new ct,P=this.getFirstEntry();if(P!==null)for(_.add(P.value);(P=y.successor(P))!==null;)_.add(P.value);return _}},{key:"entrySet",value:function(){var _=new $t,P=this.getFirstEntry();if(P!==null)for(_.add(P);(P=y.successor(P))!==null;)_.add(P);return _}},{key:"rotateLeft",value:function(_){if(_!=null){var P=_.right;_.right=P.left,P.left!=null&&(P.left.parent=_),P.parent=_.parent,_.parent==null?this.root_=P:_.parent.left===_?_.parent.left=P:_.parent.right=P,P.left=_,_.parent=P}}},{key:"rotateRight",value:function(_){if(_!=null){var P=_.left;_.left=P.right,P.right!=null&&(P.right.parent=_),P.parent=_.parent,_.parent==null?this.root_=P:_.parent.right===_?_.parent.right=P:_.parent.left=P,P.right=_,_.parent=P}}},{key:"getFirstEntry",value:function(){var _=this.root_;if(_!=null)for(;_.left!=null;)_=_.left;return _}},{key:"size",value:function(){return this.size_}},{key:"containsKey",value:function(_){for(var P=this.root_;P!==null;){var $=_.compareTo(P.key);if($<0)P=P.left;else{if(!($>0))return!0;P=P.right}}return!1}}],[{key:"successor",value:function(_){var P;if(_===null)return null;if(_.right!==null){for(P=_.right;P.left!==null;)P=P.left;return P}P=_.parent;for(var $=_;P!==null&&$===P.right;)$=P,P=P.parent;return P}}])})($i),Cs=(function(){return o((function I(){i(this,I),I.constructor_.apply(this,arguments)}),[{key:"find",value:function(I){return this.nodeMap.get(I)}},{key:"addNode",value:function(){if(arguments[0]instanceof Be){var I=arguments[0],y=this.nodeMap.get(I);return y===null&&(y=this.nodeFact.createNode(I),this.nodeMap.put(I,y)),y}if(arguments[0]instanceof fi){var _=arguments[0],P=this.nodeMap.get(_.getCoordinate());return P===null?(this.nodeMap.put(_.getCoordinate(),_),_):(P.mergeLabel(_),P)}}},{key:"print",value:function(I){for(var y=this.iterator();y.hasNext();)y.next().print(I)}},{key:"iterator",value:function(){return this.nodeMap.values().iterator()}},{key:"values",value:function(){return this.nodeMap.values()}},{key:"getBoundaryNodes",value:function(I){for(var y=new ct,_=this.iterator();_.hasNext();){var P=_.next();P.getLabel().getLocation(I)===be.BOUNDARY&&y.add(P)}return y}},{key:"add",value:function(I){var y=I.getCoordinate();this.addNode(y).add(I)}}],[{key:"constructor_",value:function(){this.nodeMap=new Mi,this.nodeFact=null;var I=arguments[0];this.nodeFact=I}}])})(),oa=(function(){function I(){i(this,I)}return o(I,null,[{key:"isNorthern",value:function(y){return y===I.NE||y===I.NW}},{key:"isOpposite",value:function(y,_){return y!==_&&(y-_+4)%4===2}},{key:"commonHalfPlane",value:function(y,_){if(y===_)return y;if((y-_+4)%4===2)return-1;var P=y<_?y:_;return P===0&&(y>_?y:_)===3?3:P}},{key:"isInHalfPlane",value:function(y,_){return _===I.SE?y===I.SE||y===I.SW:y===_||y===_+1}},{key:"quadrant",value:function(){if(typeof arguments[0]=="number"&&typeof arguments[1]=="number"){var y=arguments[0],_=arguments[1];if(y===0&&_===0)throw new U("Cannot compute the quadrant for point ( "+y+", "+_+" )");return y>=0?_>=0?I.NE:I.SE:_>=0?I.NW:I.SW}if(arguments[0]instanceof Be&&arguments[1]instanceof Be){var P=arguments[0],$=arguments[1];if($.x===P.x&&$.y===P.y)throw new U("Cannot compute the quadrant for two identical points "+P);return $.x>=P.x?$.y>=P.y?I.NE:I.SE:$.y>=P.y?I.NW:I.SW}}}])})();oa.NE=0,oa.NW=1,oa.SW=2,oa.SE=3;var ku=(function(){function I(){i(this,I),I.constructor_.apply(this,arguments)}return o(I,[{key:"compareDirection",value:function(y){return this._dx===y._dx&&this._dy===y._dy?0:this._quadrant>y._quadrant?1:this._quadrant<y._quadrant?-1:Ge.index(y._p0,y._p1,this._p1)}},{key:"getDy",value:function(){return this._dy}},{key:"getCoordinate",value:function(){return this._p0}},{key:"setNode",value:function(y){this._node=y}},{key:"print",value:function(y){var _=Math.atan2(this._dy,this._dx),P=this.getClass().getName(),$=P.lastIndexOf("."),ne=P.substring($+1);y.print("  "+ne+": "+this._p0+" - "+this._p1+" "+this._quadrant+":"+_+"   "+this._label)}},{key:"compareTo",value:function(y){var _=y;return this.compareDirection(_)}},{key:"getDirectedCoordinate",value:function(){return this._p1}},{key:"getDx",value:function(){return this._dx}},{key:"getLabel",value:function(){return this._label}},{key:"getEdge",value:function(){return this._edge}},{key:"getQuadrant",value:function(){return this._quadrant}},{key:"getNode",value:function(){return this._node}},{key:"toString",value:function(){var y=Math.atan2(this._dy,this._dx),_=this.getClass().getName(),P=_.lastIndexOf(".");return"  "+_.substring(P+1)+": "+this._p0+" - "+this._p1+" "+this._quadrant+":"+y+"   "+this._label}},{key:"computeLabel",value:function(y){}},{key:"init",value:function(y,_){this._p0=y,this._p1=_,this._dx=_.x-y.x,this._dy=_.y-y.y,this._quadrant=oa.quadrant(this._dx,this._dy),we.isTrue(!(this._dx===0&&this._dy===0),"EdgeEnd with identical endpoints found")}},{key:"interfaces_",get:function(){return[H]}}],[{key:"constructor_",value:function(){if(this._edge=null,this._label=null,this._node=null,this._p0=null,this._p1=null,this._dx=null,this._dy=null,this._quadrant=null,arguments.length===1){var y=arguments[0];this._edge=y}else if(arguments.length===3){var _=arguments[0],P=arguments[1],$=arguments[2];I.constructor_.call(this,_,P,$,null)}else if(arguments.length===4){var ne=arguments[0],me=arguments[1],Oe=arguments[2],tt=arguments[3];I.constructor_.call(this,ne),this.init(me,Oe),this._label=tt}}}])})(),Ka=(function(I){function y(){var _;return i(this,y),_=n(this,y),y.constructor_.apply(_,arguments),_}return m(y,I),o(y,[{key:"getNextMin",value:function(){return this._nextMin}},{key:"getDepth",value:function(_){return this._depth[_]}},{key:"setVisited",value:function(_){this._isVisited=_}},{key:"computeDirectedLabel",value:function(){this._label=new $n(this._edge.getLabel()),this._isForward||this._label.flip()}},{key:"getNext",value:function(){return this._next}},{key:"setDepth",value:function(_,P){if(this._depth[_]!==-999&&this._depth[_]!==P)throw new Et("assigned depths do not match",this.getCoordinate());this._depth[_]=P}},{key:"isInteriorAreaEdge",value:function(){for(var _=!0,P=0;P<2;P++)this._label.isArea(P)&&this._label.getLocation(P,_t.LEFT)===be.INTERIOR&&this._label.getLocation(P,_t.RIGHT)===be.INTERIOR||(_=!1);return _}},{key:"setNextMin",value:function(_){this._nextMin=_}},{key:"print",value:function(_){E(y,"print",this,1).call(this,_),_.print(" "+this._depth[_t.LEFT]+"/"+this._depth[_t.RIGHT]),_.print(" ("+this.getDepthDelta()+")"),this._isInResult&&_.print(" inResult")}},{key:"setMinEdgeRing",value:function(_){this._minEdgeRing=_}},{key:"isLineEdge",value:function(){var _=this._label.isLine(0)||this._label.isLine(1),P=!this._label.isArea(0)||this._label.allPositionsEqual(0,be.EXTERIOR),$=!this._label.isArea(1)||this._label.allPositionsEqual(1,be.EXTERIOR);return _&&P&&$}},{key:"setEdgeRing",value:function(_){this._edgeRing=_}},{key:"getMinEdgeRing",value:function(){return this._minEdgeRing}},{key:"getDepthDelta",value:function(){var _=this._edge.getDepthDelta();return this._isForward||(_=-_),_}},{key:"setInResult",value:function(_){this._isInResult=_}},{key:"getSym",value:function(){return this._sym}},{key:"isForward",value:function(){return this._isForward}},{key:"getEdge",value:function(){return this._edge}},{key:"printEdge",value:function(_){this.print(_),_.print(" "),this._isForward?this._edge.print(_):this._edge.printReverse(_)}},{key:"setSym",value:function(_){this._sym=_}},{key:"setVisitedEdge",value:function(_){this.setVisited(_),this._sym.setVisited(_)}},{key:"setEdgeDepths",value:function(_,P){var $=this.getEdge().getDepthDelta();this._isForward||($=-$);var ne=1;_===_t.LEFT&&(ne=-1);var me=_t.opposite(_),Oe=P+$*ne;this.setDepth(_,P),this.setDepth(me,Oe)}},{key:"getEdgeRing",value:function(){return this._edgeRing}},{key:"isInResult",value:function(){return this._isInResult}},{key:"setNext",value:function(_){this._next=_}},{key:"isVisited",value:function(){return this._isVisited}}],[{key:"constructor_",value:function(){this._isForward=null,this._isInResult=!1,this._isVisited=!1,this._sym=null,this._next=null,this._nextMin=null,this._edgeRing=null,this._minEdgeRing=null,this._depth=[0,-999,-999];var _=arguments[0],P=arguments[1];if(ku.constructor_.call(this,_),this._isForward=P,P)this.init(_.getCoordinate(0),_.getCoordinate(1));else{var $=_.getNumPoints()-1;this.init(_.getCoordinate($),_.getCoordinate($-1))}this.computeDirectedLabel()}},{key:"depthFactor",value:function(_,P){return _===be.EXTERIOR&&P===be.INTERIOR?1:_===be.INTERIOR&&P===be.EXTERIOR?-1:0}}])})(ku),$s=(function(){return o((function I(){i(this,I)}),[{key:"createNode",value:function(I){return new fi(I,null)}}])})(),Vo=(function(){return o((function I(){i(this,I),I.constructor_.apply(this,arguments)}),[{key:"printEdges",value:function(I){I.println("Edges:");for(var y=0;y<this._edges.size();y++){I.println("edge "+y+":");var _=this._edges.get(y);_.print(I),_.eiList.print(I)}}},{key:"find",value:function(I){return this._nodes.find(I)}},{key:"addNode",value:function(){if(arguments[0]instanceof fi){var I=arguments[0];return this._nodes.addNode(I)}if(arguments[0]instanceof Be){var y=arguments[0];return this._nodes.addNode(y)}}},{key:"getNodeIterator",value:function(){return this._nodes.iterator()}},{key:"linkResultDirectedEdges",value:function(){for(var I=this._nodes.iterator();I.hasNext();)I.next().getEdges().linkResultDirectedEdges()}},{key:"debugPrintln",value:function(I){Ar.out.println(I)}},{key:"isBoundaryNode",value:function(I,y){var _=this._nodes.find(y);if(_===null)return!1;var P=_.getLabel();return P!==null&&P.getLocation(I)===be.BOUNDARY}},{key:"linkAllDirectedEdges",value:function(){for(var I=this._nodes.iterator();I.hasNext();)I.next().getEdges().linkAllDirectedEdges()}},{key:"matchInSameDirection",value:function(I,y,_,P){return!!I.equals(_)&&Ge.index(I,y,P)===Ge.COLLINEAR&&oa.quadrant(I,y)===oa.quadrant(_,P)}},{key:"getEdgeEnds",value:function(){return this._edgeEndList}},{key:"debugPrint",value:function(I){Ar.out.print(I)}},{key:"getEdgeIterator",value:function(){return this._edges.iterator()}},{key:"findEdgeInSameDirection",value:function(I,y){for(var _=0;_<this._edges.size();_++){var P=this._edges.get(_),$=P.getCoordinates();if(this.matchInSameDirection(I,y,$[0],$[1])||this.matchInSameDirection(I,y,$[$.length-1],$[$.length-2]))return P}return null}},{key:"insertEdge",value:function(I){this._edges.add(I)}},{key:"findEdgeEnd",value:function(I){for(var y=this.getEdgeEnds().iterator();y.hasNext();){var _=y.next();if(_.getEdge()===I)return _}return null}},{key:"addEdges",value:function(I){for(var y=I.iterator();y.hasNext();){var _=y.next();this._edges.add(_);var P=new Ka(_,!0),$=new Ka(_,!1);P.setSym($),$.setSym(P),this.add(P),this.add($)}}},{key:"add",value:function(I){this._nodes.add(I),this._edgeEndList.add(I)}},{key:"getNodes",value:function(){return this._nodes.values()}},{key:"findEdge",value:function(I,y){for(var _=0;_<this._edges.size();_++){var P=this._edges.get(_),$=P.getCoordinates();if(I.equals($[0])&&y.equals($[1]))return P}return null}}],[{key:"constructor_",value:function(){if(this._edges=new ct,this._nodes=null,this._edgeEndList=new ct,arguments.length===0)this._nodes=new Cs(new $s);else if(arguments.length===1){var I=arguments[0];this._nodes=new Cs(I)}}},{key:"linkResultDirectedEdges",value:function(I){for(var y=I.iterator();y.hasNext();)y.next().getEdges().linkResultDirectedEdges()}}])})(),Ru=(function(){function I(){i(this,I),I.constructor_.apply(this,arguments)}return o(I,[{key:"sortShellsAndHoles",value:function(y,_,P){for(var $=y.iterator();$.hasNext();){var ne=$.next();ne.isHole()?P.add(ne):_.add(ne)}}},{key:"computePolygons",value:function(y){for(var _=new ct,P=y.iterator();P.hasNext();){var $=P.next().toPolygon(this._geometryFactory);_.add($)}return _}},{key:"placeFreeHoles",value:function(y,_){for(var P=_.iterator();P.hasNext();){var $=P.next();if($.getShell()===null){var ne=I.findEdgeRingContaining($,y);if(ne===null)throw new Et("unable to assign hole to a shell",$.getCoordinate(0));$.setShell(ne)}}}},{key:"buildMinimalEdgeRings",value:function(y,_,P){for(var $=new ct,ne=y.iterator();ne.hasNext();){var me=ne.next();if(me.getMaxNodeDegree()>2){me.linkDirectedEdgesForMinimalEdgeRings();var Oe=me.buildMinimalRings(),tt=this.findShell(Oe);tt!==null?(this.placePolygonHoles(tt,Oe),_.add(tt)):P.addAll(Oe)}else $.add(me)}return $}},{key:"buildMaximalEdgeRings",value:function(y){for(var _=new ct,P=y.iterator();P.hasNext();){var $=P.next();if($.isInResult()&&$.getLabel().isArea()&&$.getEdgeRing()===null){var ne=new hn($,this._geometryFactory);_.add(ne),ne.setInResult()}}return _}},{key:"placePolygonHoles",value:function(y,_){for(var P=_.iterator();P.hasNext();){var $=P.next();$.isHole()&&$.setShell(y)}}},{key:"getPolygons",value:function(){return this.computePolygons(this._shellList)}},{key:"findShell",value:function(y){for(var _=0,P=null,$=y.iterator();$.hasNext();){var ne=$.next();ne.isHole()||(P=ne,_++)}return we.isTrue(_<=1,"found two shells in MinimalEdgeRing list"),P}},{key:"add",value:function(){if(arguments.length===1){var y=arguments[0];this.add(y.getEdgeEnds(),y.getNodes())}else if(arguments.length===2){var _=arguments[0],P=arguments[1];Vo.linkResultDirectedEdges(P);var $=this.buildMaximalEdgeRings(_),ne=new ct,me=this.buildMinimalEdgeRings($,this._shellList,ne);this.sortShellsAndHoles(me,this._shellList,ne),this.placeFreeHoles(this._shellList,ne)}}}],[{key:"constructor_",value:function(){this._geometryFactory=null,this._shellList=new ct;var y=arguments[0];this._geometryFactory=y}},{key:"findEdgeRingContaining",value:function(y,_){for(var P=y.getLinearRing(),$=P.getEnvelopeInternal(),ne=P.getCoordinateN(0),me=null,Oe=null,tt=_.iterator();tt.hasNext();){var ft=tt.next(),rr=ft.getLinearRing(),ur=rr.getEnvelopeInternal();if(!ur.equals($)&&ur.contains($)){ne=Wi.ptNotInList(P.getCoordinates(),rr.getCoordinates());var qr=!1;ti.isInRing(ne,rr.getCoordinates())&&(qr=!0),qr&&(me===null||Oe.contains(ur))&&(Oe=(me=ft).getLinearRing().getEnvelopeInternal())}}return me}}])})(),Mu=(function(){return o((function I(){i(this,I)}),[{key:"getBounds",value:function(){}}])})(),go=(function(){return o((function I(){i(this,I),I.constructor_.apply(this,arguments)}),[{key:"getItem",value:function(){return this._item}},{key:"getBounds",value:function(){return this._bounds}},{key:"interfaces_",get:function(){return[Mu,X]}}],[{key:"constructor_",value:function(){this._bounds=null,this._item=null;var I=arguments[0],y=arguments[1];this._bounds=I,this._item=y}}])})(),ji=(function(){return o((function I(){i(this,I),I.constructor_.apply(this,arguments)}),[{key:"poll",value:function(){if(this.isEmpty())return null;var I=this._items.get(1);return this._items.set(1,this._items.get(this._size)),this._size-=1,this.reorder(1),I}},{key:"size",value:function(){return this._size}},{key:"reorder",value:function(I){for(var y=null,_=this._items.get(I);2*I<=this._size&&((y=2*I)!==this._size&&this._items.get(y+1).compareTo(this._items.get(y))<0&&y++,this._items.get(y).compareTo(_)<0);I=y)this._items.set(I,this._items.get(y));this._items.set(I,_)}},{key:"clear",value:function(){this._size=0,this._items.clear()}},{key:"peek",value:function(){return this.isEmpty()?null:this._items.get(1)}},{key:"isEmpty",value:function(){return this._size===0}},{key:"add",value:function(I){this._items.add(null),this._size+=1;var y=this._size;for(this._items.set(0,I);I.compareTo(this._items.get(Math.trunc(y/2)))<0;y/=2)this._items.set(y,this._items.get(Math.trunc(y/2)));this._items.set(y,I)}}],[{key:"constructor_",value:function(){this._size=null,this._items=null,this._size=0,this._items=new ct,this._items.add(null)}}])})(),qs=(function(){return o((function I(){i(this,I)}),[{key:"insert",value:function(I,y){}},{key:"remove",value:function(I,y){}},{key:"query",value:function(){}}])})(),ii=(function(){return o((function I(){i(this,I),I.constructor_.apply(this,arguments)}),[{key:"getLevel",value:function(){return this._level}},{key:"size",value:function(){return this._childBoundables.size()}},{key:"getChildBoundables",value:function(){return this._childBoundables}},{key:"addChildBoundable",value:function(I){we.isTrue(this._bounds===null),this._childBoundables.add(I)}},{key:"isEmpty",value:function(){return this._childBoundables.isEmpty()}},{key:"getBounds",value:function(){return this._bounds===null&&(this._bounds=this.computeBounds()),this._bounds}},{key:"interfaces_",get:function(){return[Mu,X]}}],[{key:"constructor_",value:function(){if(this._childBoundables=new ct,this._bounds=null,this._level=null,arguments.length!==0){if(arguments.length===1){var I=arguments[0];this._level=I}}}}])})(),ri={reverseOrder:function(){return{compare:function(I,y){return y.compareTo(I)}}},min:function(I){return ri.sort(I),I.get(0)},sort:function(I,y){var _=I.toArray();y?Gt.sort(_,y):Gt.sort(_);for(var P=I.iterator(),$=0,ne=_.length;$<ne;$++)P.next(),P.set(_[$])},singletonList:function(I){var y=new ct;return y.add(I),y}},Do=(function(){function I(){i(this,I)}return o(I,null,[{key:"maxDistance",value:function(y,_,P,$,ne,me,Oe,tt){var ft=I.distance(y,_,ne,me);return ft=Math.max(ft,I.distance(y,_,Oe,tt)),ft=Math.max(ft,I.distance(P,$,ne,me)),ft=Math.max(ft,I.distance(P,$,Oe,tt))}},{key:"distance",value:function(y,_,P,$){var ne=P-y,me=$-_;return Math.sqrt(ne*ne+me*me)}},{key:"maximumDistance",value:function(y,_){var P=Math.min(y.getMinX(),_.getMinX()),$=Math.min(y.getMinY(),_.getMinY()),ne=Math.max(y.getMaxX(),_.getMaxX()),me=Math.max(y.getMaxY(),_.getMaxY());return I.distance(P,$,ne,me)}},{key:"minMaxDistance",value:function(y,_){var P=y.getMinX(),$=y.getMinY(),ne=y.getMaxX(),me=y.getMaxY(),Oe=_.getMinX(),tt=_.getMinY(),ft=_.getMaxX(),rr=_.getMaxY(),ur=I.maxDistance(P,$,P,me,Oe,tt,Oe,rr);return ur=Math.min(ur,I.maxDistance(P,$,P,me,Oe,tt,ft,tt)),ur=Math.min(ur,I.maxDistance(P,$,P,me,ft,rr,Oe,rr)),ur=Math.min(ur,I.maxDistance(P,$,P,me,ft,rr,ft,tt)),ur=Math.min(ur,I.maxDistance(P,$,ne,$,Oe,tt,Oe,rr)),ur=Math.min(ur,I.maxDistance(P,$,ne,$,Oe,tt,ft,tt)),ur=Math.min(ur,I.maxDistance(P,$,ne,$,ft,rr,Oe,rr)),ur=Math.min(ur,I.maxDistance(P,$,ne,$,ft,rr,ft,tt)),ur=Math.min(ur,I.maxDistance(ne,me,P,me,Oe,tt,Oe,rr)),ur=Math.min(ur,I.maxDistance(ne,me,P,me,Oe,tt,ft,tt)),ur=Math.min(ur,I.maxDistance(ne,me,P,me,ft,rr,Oe,rr)),ur=Math.min(ur,I.maxDistance(ne,me,P,me,ft,rr,ft,tt)),ur=Math.min(ur,I.maxDistance(ne,me,ne,$,Oe,tt,Oe,rr)),ur=Math.min(ur,I.maxDistance(ne,me,ne,$,Oe,tt,ft,tt)),ur=Math.min(ur,I.maxDistance(ne,me,ne,$,ft,rr,Oe,rr)),ur=Math.min(ur,I.maxDistance(ne,me,ne,$,ft,rr,ft,tt))}}])})(),ai=(function(){function I(){i(this,I),I.constructor_.apply(this,arguments)}return o(I,[{key:"maximumDistance",value:function(){return Do.maximumDistance(this._boundable1.getBounds(),this._boundable2.getBounds())}},{key:"expandToQueue",value:function(y,_){var P=I.isComposite(this._boundable1),$=I.isComposite(this._boundable2);if(P&&$)return I.area(this._boundable1)>I.area(this._boundable2)?(this.expand(this._boundable1,this._boundable2,!1,y,_),null):(this.expand(this._boundable2,this._boundable1,!0,y,_),null);if(P)return this.expand(this._boundable1,this._boundable2,!1,y,_),null;if($)return this.expand(this._boundable2,this._boundable1,!0,y,_),null;throw new U("neither boundable is composite")}},{key:"isLeaves",value:function(){return!(I.isComposite(this._boundable1)||I.isComposite(this._boundable2))}},{key:"compareTo",value:function(y){var _=y;return this._distance<_._distance?-1:this._distance>_._distance?1:0}},{key:"expand",value:function(y,_,P,$,ne){for(var me=y.getChildBoundables().iterator();me.hasNext();){var Oe=me.next(),tt=null;(tt=P?new I(_,Oe,this._itemDistance):new I(Oe,_,this._itemDistance)).getDistance()<ne&&$.add(tt)}}},{key:"getBoundable",value:function(y){return y===0?this._boundable1:this._boundable2}},{key:"getDistance",value:function(){return this._distance}},{key:"distance",value:function(){return this.isLeaves()?this._itemDistance.distance(this._boundable1,this._boundable2):this._boundable1.getBounds().distance(this._boundable2.getBounds())}},{key:"interfaces_",get:function(){return[H]}}],[{key:"constructor_",value:function(){this._boundable1=null,this._boundable2=null,this._distance=null,this._itemDistance=null;var y=arguments[0],_=arguments[1],P=arguments[2];this._boundable1=y,this._boundable2=_,this._itemDistance=P,this._distance=this.distance()}},{key:"area",value:function(y){return y.getBounds().getArea()}},{key:"isComposite",value:function(y){return y instanceof ii}}])})(),ue=(function(){return o((function I(){i(this,I)}),[{key:"visitItem",value:function(I){}}])})(),We=(function(){function I(){i(this,I),I.constructor_.apply(this,arguments)}return o(I,[{key:"queryInternal",value:function(){if(Er(arguments[2],ue)&&arguments[0]instanceof Object&&arguments[1]instanceof ii)for(var y=arguments[0],_=arguments[2],P=arguments[1].getChildBoundables(),$=0;$<P.size();$++){var ne=P.get($);this.getIntersectsOp().intersects(ne.getBounds(),y)&&(ne instanceof ii?this.queryInternal(y,ne,_):ne instanceof go?_.visitItem(ne.getItem()):we.shouldNeverReachHere())}else if(Er(arguments[2],ar)&&arguments[0]instanceof Object&&arguments[1]instanceof ii)for(var me=arguments[0],Oe=arguments[2],tt=arguments[1].getChildBoundables(),ft=0;ft<tt.size();ft++){var rr=tt.get(ft);this.getIntersectsOp().intersects(rr.getBounds(),me)&&(rr instanceof ii?this.queryInternal(me,rr,Oe):rr instanceof go?Oe.add(rr.getItem()):we.shouldNeverReachHere())}}},{key:"getNodeCapacity",value:function(){return this._nodeCapacity}},{key:"lastNode",value:function(y){return y.get(y.size()-1)}},{key:"size",value:function(){if(arguments.length===0)return this.isEmpty()?0:(this.build(),this.size(this._root));if(arguments.length===1){for(var y=0,_=arguments[0].getChildBoundables().iterator();_.hasNext();){var P=_.next();P instanceof ii?y+=this.size(P):P instanceof go&&(y+=1)}return y}}},{key:"removeItem",value:function(y,_){for(var P=null,$=y.getChildBoundables().iterator();$.hasNext();){var ne=$.next();ne instanceof go&&ne.getItem()===_&&(P=ne)}return P!==null&&(y.getChildBoundables().remove(P),!0)}},{key:"itemsTree",value:function(){if(arguments.length===0){this.build();var y=this.itemsTree(this._root);return y===null?new ct:y}if(arguments.length===1){for(var _=arguments[0],P=new ct,$=_.getChildBoundables().iterator();$.hasNext();){var ne=$.next();if(ne instanceof ii){var me=this.itemsTree(ne);me!==null&&P.add(me)}else ne instanceof go?P.add(ne.getItem()):we.shouldNeverReachHere()}return P.size()<=0?null:P}}},{key:"insert",value:function(y,_){we.isTrue(!this._built,"Cannot insert items into an STR packed R-tree after it has been built."),this._itemBoundables.add(new go(y,_))}},{key:"boundablesAtLevel",value:function(){if(arguments.length===1){var y=arguments[0],_=new ct;return this.boundablesAtLevel(y,this._root,_),_}if(arguments.length===3){var P=arguments[0],$=arguments[1],ne=arguments[2];if(we.isTrue(P>-2),$.getLevel()===P)return ne.add($),null;for(var me=$.getChildBoundables().iterator();me.hasNext();){var Oe=me.next();Oe instanceof ii?this.boundablesAtLevel(P,Oe,ne):(we.isTrue(Oe instanceof go),P===-1&&ne.add(Oe))}return null}}},{key:"query",value:function(){if(arguments.length===1){var y=arguments[0];this.build();var _=new ct;return this.isEmpty()||this.getIntersectsOp().intersects(this._root.getBounds(),y)&&this.queryInternal(y,this._root,_),_}if(arguments.length===2){var P=arguments[0],$=arguments[1];if(this.build(),this.isEmpty())return null;this.getIntersectsOp().intersects(this._root.getBounds(),P)&&this.queryInternal(P,this._root,$)}}},{key:"build",value:function(){if(this._built)return null;this._root=this._itemBoundables.isEmpty()?this.createNode(0):this.createHigherLevels(this._itemBoundables,-1),this._itemBoundables=null,this._built=!0}},{key:"getRoot",value:function(){return this.build(),this._root}},{key:"remove",value:function(){if(arguments.length===2){var y=arguments[0],_=arguments[1];return this.build(),!!this.getIntersectsOp().intersects(this._root.getBounds(),y)&&this.remove(y,this._root,_)}if(arguments.length===3){var P=arguments[0],$=arguments[1],ne=arguments[2],me=this.removeItem($,ne);if(me)return!0;for(var Oe=null,tt=$.getChildBoundables().iterator();tt.hasNext();){var ft=tt.next();if(this.getIntersectsOp().intersects(ft.getBounds(),P)&&ft instanceof ii&&(me=this.remove(P,ft,ne))){Oe=ft;break}}return Oe!==null&&Oe.getChildBoundables().isEmpty()&&$.getChildBoundables().remove(Oe),me}}},{key:"createHigherLevels",value:function(y,_){we.isTrue(!y.isEmpty());var P=this.createParentBoundables(y,_+1);return P.size()===1?P.get(0):this.createHigherLevels(P,_+1)}},{key:"depth",value:function(){if(arguments.length===0)return this.isEmpty()?0:(this.build(),this.depth(this._root));if(arguments.length===1){for(var y=0,_=arguments[0].getChildBoundables().iterator();_.hasNext();){var P=_.next();if(P instanceof ii){var $=this.depth(P);$>y&&(y=$)}}return y+1}}},{key:"createParentBoundables",value:function(y,_){we.isTrue(!y.isEmpty());var P=new ct;P.add(this.createNode(_));var $=new ct(y);ri.sort($,this.getComparator());for(var ne=$.iterator();ne.hasNext();){var me=ne.next();this.lastNode(P).getChildBoundables().size()===this.getNodeCapacity()&&P.add(this.createNode(_)),this.lastNode(P).addChildBoundable(me)}return P}},{key:"isEmpty",value:function(){return this._built?this._root.isEmpty():this._itemBoundables.isEmpty()}},{key:"interfaces_",get:function(){return[X]}}],[{key:"constructor_",value:function(){if(this._root=null,this._built=!1,this._itemBoundables=new ct,this._nodeCapacity=null,arguments.length===0)I.constructor_.call(this,I.DEFAULT_NODE_CAPACITY);else if(arguments.length===1){var y=arguments[0];we.isTrue(y>1,"Node capacity must be greater than 1"),this._nodeCapacity=y}}},{key:"compareDoubles",value:function(y,_){return y>_?1:y<_?-1:0}}])})();We.IntersectsOp=function(){},We.DEFAULT_NODE_CAPACITY=10;var bt=(function(){return o((function I(){i(this,I)}),[{key:"distance",value:function(I,y){}}])})(),zt=(function(I){function y(){var _;return i(this,y),_=n(this,y),y.constructor_.apply(_,arguments),_}return m(y,I),o(y,[{key:"createParentBoundablesFromVerticalSlices",value:function(_,P){we.isTrue(_.length>0);for(var $=new ct,ne=0;ne<_.length;ne++)$.addAll(this.createParentBoundablesFromVerticalSlice(_[ne],P));return $}},{key:"nearestNeighbourK",value:function(){if(arguments.length===2){var _=arguments[0],P=arguments[1];return this.nearestNeighbourK(_,Ie.POSITIVE_INFINITY,P)}if(arguments.length===3){var $=arguments[0],ne=arguments[2],me=arguments[1],Oe=new ji;Oe.add($);for(var tt=new ji;!Oe.isEmpty()&&me>=0;){var ft=Oe.poll(),rr=ft.getDistance();if(rr>=me)break;ft.isLeaves()?tt.size()<ne?tt.add(ft):(tt.peek().getDistance()>rr&&(tt.poll(),tt.add(ft)),me=tt.peek().getDistance()):ft.expandToQueue(Oe,me)}return y.getItems(tt)}}},{key:"createNode",value:function(_){return new lr(_)}},{key:"size",value:function(){return arguments.length===0?E(y,"size",this,1).call(this):E(y,"size",this,1).apply(this,arguments)}},{key:"insert",value:function(){if(!(arguments.length===2&&arguments[1]instanceof Object&&arguments[0]instanceof Qe))return E(y,"insert",this,1).apply(this,arguments);var _=arguments[0],P=arguments[1];if(_.isNull())return null;E(y,"insert",this,1).call(this,_,P)}},{key:"getIntersectsOp",value:function(){return y.intersectsOp}},{key:"verticalSlices",value:function(_,P){for(var $=Math.trunc(Math.ceil(_.size()/P)),ne=new Array(P).fill(null),me=_.iterator(),Oe=0;Oe<P;Oe++){ne[Oe]=new ct;for(var tt=0;me.hasNext()&&tt<$;){var ft=me.next();ne[Oe].add(ft),tt++}}return ne}},{key:"query",value:function(){if(arguments.length===1){var _=arguments[0];return E(y,"query",this,1).call(this,_)}if(arguments.length===2){var P=arguments[0],$=arguments[1];E(y,"query",this,1).call(this,P,$)}}},{key:"getComparator",value:function(){return y.yComparator}},{key:"createParentBoundablesFromVerticalSlice",value:function(_,P){return E(y,"createParentBoundables",this,1).call(this,_,P)}},{key:"remove",value:function(){if(arguments.length===2&&arguments[1]instanceof Object&&arguments[0]instanceof Qe){var _=arguments[0],P=arguments[1];return E(y,"remove",this,1).call(this,_,P)}return E(y,"remove",this,1).apply(this,arguments)}},{key:"depth",value:function(){return arguments.length===0?E(y,"depth",this,1).call(this):E(y,"depth",this,1).apply(this,arguments)}},{key:"createParentBoundables",value:function(_,P){we.isTrue(!_.isEmpty());var $=Math.trunc(Math.ceil(_.size()/this.getNodeCapacity())),ne=new ct(_);ri.sort(ne,y.xComparator);var me=this.verticalSlices(ne,Math.trunc(Math.ceil(Math.sqrt($))));return this.createParentBoundablesFromVerticalSlices(me,P)}},{key:"nearestNeighbour",value:function(){if(arguments.length===1){if(Er(arguments[0],bt)){var _=arguments[0];if(this.isEmpty())return null;var P=new ai(this.getRoot(),this.getRoot(),_);return this.nearestNeighbour(P)}if(arguments[0]instanceof ai){var $=arguments[0],ne=Ie.POSITIVE_INFINITY,me=null,Oe=new ji;for(Oe.add($);!Oe.isEmpty()&&ne>0;){var tt=Oe.poll(),ft=tt.getDistance();if(ft>=ne)break;tt.isLeaves()?(ne=ft,me=tt):tt.expandToQueue(Oe,ne)}return me===null?null:[me.getBoundable(0).getItem(),me.getBoundable(1).getItem()]}}else{if(arguments.length===2){var rr=arguments[0],ur=arguments[1];if(this.isEmpty()||rr.isEmpty())return null;var qr=new ai(this.getRoot(),rr.getRoot(),ur);return this.nearestNeighbour(qr)}if(arguments.length===3){var bn=arguments[2],Dn=new go(arguments[0],arguments[1]),Xn=new ai(this.getRoot(),Dn,bn);return this.nearestNeighbour(Xn)[0]}if(arguments.length===4){var Fn=arguments[2],En=arguments[3],na=new go(arguments[0],arguments[1]),ca=new ai(this.getRoot(),na,Fn);return this.nearestNeighbourK(ca,En)}}}},{key:"isWithinDistance",value:function(){if(arguments.length===2){var _=arguments[0],P=arguments[1],$=Ie.POSITIVE_INFINITY,ne=new ji;for(ne.add(_);!ne.isEmpty();){var me=ne.poll(),Oe=me.getDistance();if(Oe>P)return!1;if(me.maximumDistance()<=P)return!0;if(me.isLeaves()){if(($=Oe)<=P)return!0}else me.expandToQueue(ne,$)}return!1}if(arguments.length===3){var tt=arguments[0],ft=arguments[1],rr=arguments[2],ur=new ai(this.getRoot(),tt.getRoot(),ft);return this.isWithinDistance(ur,rr)}}},{key:"interfaces_",get:function(){return[qs,X]}}],[{key:"constructor_",value:function(){if(arguments.length===0)y.constructor_.call(this,y.DEFAULT_NODE_CAPACITY);else if(arguments.length===1){var _=arguments[0];We.constructor_.call(this,_)}}},{key:"centreX",value:function(_){return y.avg(_.getMinX(),_.getMaxX())}},{key:"avg",value:function(_,P){return(_+P)/2}},{key:"getItems",value:function(_){for(var P=new Array(_.size()).fill(null),$=0;!_.isEmpty();){var ne=_.poll();P[$]=ne.getBoundable(0).getItem(),$++}return P}},{key:"centreY",value:function(_){return y.avg(_.getMinY(),_.getMaxY())}}])})(We),lr=(function(I){function y(){var _;return i(this,y),_=n(this,y),y.constructor_.apply(_,arguments),_}return m(y,I),o(y,[{key:"computeBounds",value:function(){for(var _=null,P=this.getChildBoundables().iterator();P.hasNext();){var $=P.next();_===null?_=new Qe($.getBounds()):_.expandToInclude($.getBounds())}return _}}],[{key:"constructor_",value:function(){var _=arguments[0];ii.constructor_.call(this,_)}}])})(ii);zt.STRtreeNode=lr,zt.xComparator=new((function(){return o((function I(){i(this,I)}),[{key:"interfaces_",get:function(){return[Me]}},{key:"compare",value:function(I,y){return We.compareDoubles(zt.centreX(I.getBounds()),zt.centreX(y.getBounds()))}}])})()),zt.yComparator=new((function(){return o((function I(){i(this,I)}),[{key:"interfaces_",get:function(){return[Me]}},{key:"compare",value:function(I,y){return We.compareDoubles(zt.centreY(I.getBounds()),zt.centreY(y.getBounds()))}}])})()),zt.intersectsOp=new((function(){return o((function I(){i(this,I)}),[{key:"interfaces_",get:function(){return[IntersectsOp]}},{key:"intersects",value:function(I,y){return I.intersects(y)}}])})()),zt.DEFAULT_NODE_CAPACITY=10;var Nr=(function(){function I(){i(this,I)}return o(I,null,[{key:"relativeSign",value:function(y,_){return y<_?-1:y>_?1:0}},{key:"compare",value:function(y,_,P){if(_.equals2D(P))return 0;var $=I.relativeSign(_.x,P.x),ne=I.relativeSign(_.y,P.y);switch(y){case 0:return I.compareValue($,ne);case 1:return I.compareValue(ne,$);case 2:return I.compareValue(ne,-$);case 3:return I.compareValue(-$,ne);case 4:return I.compareValue(-$,-ne);case 5:return I.compareValue(-ne,-$);case 6:return I.compareValue(-ne,$);case 7:return I.compareValue($,-ne)}return we.shouldNeverReachHere("invalid octant value"),0}},{key:"compareValue",value:function(y,_){return y<0?-1:y>0?1:_<0?-1:_>0?1:0}}])})(),Zr=(function(){return o((function I(){i(this,I),I.constructor_.apply(this,arguments)}),[{key:"getCoordinate",value:function(){return this.coord}},{key:"print",value:function(I){I.print(this.coord),I.print(" seg # = "+this.segmentIndex)}},{key:"compareTo",value:function(I){var y=I;return this.segmentIndex<y.segmentIndex?-1:this.segmentIndex>y.segmentIndex?1:this.coord.equals2D(y.coord)?0:this._isInterior?y._isInterior?Nr.compare(this._segmentOctant,this.coord,y.coord):1:-1}},{key:"isEndPoint",value:function(I){return this.segmentIndex===0&&!this._isInterior||this.segmentIndex===I}},{key:"toString",value:function(){return this.segmentIndex+":"+this.coord.toString()}},{key:"isInterior",value:function(){return this._isInterior}},{key:"interfaces_",get:function(){return[H]}}],[{key:"constructor_",value:function(){this._segString=null,this.coord=null,this.segmentIndex=null,this._segmentOctant=null,this._isInterior=null;var I=arguments[0],y=arguments[1],_=arguments[2],P=arguments[3];this._segString=I,this.coord=new Be(y),this.segmentIndex=_,this._segmentOctant=P,this._isInterior=!y.equals2D(I.getCoordinate(_))}}])})(),Ln=(function(){return o((function I(){i(this,I)}),[{key:"hasNext",value:function(){}},{key:"next",value:function(){}},{key:"remove",value:function(){}}])})(),qn=(function(){return o((function I(){i(this,I),I.constructor_.apply(this,arguments)}),[{key:"getSplitCoordinates",value:function(){var I=new La;this.addEndpoints();for(var y=this.iterator(),_=y.next();y.hasNext();){var P=y.next();this.addEdgeCoordinates(_,P,I),_=P}return I.toCoordinateArray()}},{key:"addCollapsedNodes",value:function(){var I=new ct;this.findCollapsesFromInsertedNodes(I),this.findCollapsesFromExistingVertices(I);for(var y=I.iterator();y.hasNext();){var _=y.next().intValue();this.add(this._edge.getCoordinate(_),_)}}},{key:"createSplitEdgePts",value:function(I,y){var _=y.segmentIndex-I.segmentIndex+2;if(_===2)return[new Be(I.coord),new Be(y.coord)];var P=this._edge.getCoordinate(y.segmentIndex),$=y.isInterior()||!y.coord.equals2D(P);$||_--;var ne=new Array(_).fill(null),me=0;ne[me++]=new Be(I.coord);for(var Oe=I.segmentIndex+1;Oe<=y.segmentIndex;Oe++)ne[me++]=this._edge.getCoordinate(Oe);return $&&(ne[me]=new Be(y.coord)),ne}},{key:"print",value:function(I){I.println("Intersections:");for(var y=this.iterator();y.hasNext();)y.next().print(I)}},{key:"findCollapsesFromExistingVertices",value:function(I){for(var y=0;y<this._edge.size()-2;y++){var _=this._edge.getCoordinate(y);this._edge.getCoordinate(y+1);var P=this._edge.getCoordinate(y+2);_.equals2D(P)&&I.add(ot.valueOf(y+1))}}},{key:"addEdgeCoordinates",value:function(I,y,_){var P=this.createSplitEdgePts(I,y);_.add(P,!1)}},{key:"iterator",value:function(){return this._nodeMap.values().iterator()}},{key:"addSplitEdges",value:function(I){this.addEndpoints(),this.addCollapsedNodes();for(var y=this.iterator(),_=y.next();y.hasNext();){var P=y.next(),$=this.createSplitEdge(_,P);I.add($),_=P}}},{key:"findCollapseIndex",value:function(I,y,_){if(!I.coord.equals2D(y.coord))return!1;var P=y.segmentIndex-I.segmentIndex;return y.isInterior()||P--,P===1&&(_[0]=I.segmentIndex+1,!0)}},{key:"findCollapsesFromInsertedNodes",value:function(I){for(var y=new Array(1).fill(null),_=this.iterator(),P=_.next();_.hasNext();){var $=_.next();this.findCollapseIndex(P,$,y)&&I.add(ot.valueOf(y[0])),P=$}}},{key:"getEdge",value:function(){return this._edge}},{key:"addEndpoints",value:function(){var I=this._edge.size()-1;this.add(this._edge.getCoordinate(0),0),this.add(this._edge.getCoordinate(I),I)}},{key:"createSplitEdge",value:function(I,y){var _=this.createSplitEdgePts(I,y);return new Ui(_,this._edge.getData())}},{key:"add",value:function(I,y){var _=new Zr(this._edge,I,y,this._edge.getSegmentOctant(y)),P=this._nodeMap.get(_);return P!==null?(we.isTrue(P.coord.equals2D(I),"Found equal nodes with different coordinates"),P):(this._nodeMap.put(_,_),_)}},{key:"checkSplitEdgesCorrectness",value:function(I){var y=this._edge.getCoordinates(),_=I.get(0).getCoordinate(0);if(!_.equals2D(y[0]))throw new de("bad split edge start point at "+_);var P=I.get(I.size()-1).getCoordinates(),$=P[P.length-1];if(!$.equals2D(y[y.length-1]))throw new de("bad split edge end point at "+$)}}],[{key:"constructor_",value:function(){this._nodeMap=new Mi,this._edge=null;var I=arguments[0];this._edge=I}}])})(),Un=(function(){function I(){i(this,I)}return o(I,null,[{key:"octant",value:function(){if(typeof arguments[0]=="number"&&typeof arguments[1]=="number"){var y=arguments[0],_=arguments[1];if(y===0&&_===0)throw new U("Cannot compute the octant for point ( "+y+", "+_+" )");var P=Math.abs(y),$=Math.abs(_);return y>=0?_>=0?P>=$?0:1:P>=$?7:6:_>=0?P>=$?3:2:P>=$?4:5}if(arguments[0]instanceof Be&&arguments[1]instanceof Be){var ne=arguments[0],me=arguments[1],Oe=me.x-ne.x,tt=me.y-ne.y;if(Oe===0&&tt===0)throw new U("Cannot compute the octant for two identical points "+ne);return I.octant(Oe,tt)}}}])})(),ui=(function(){return o((function I(){i(this,I)}),[{key:"getCoordinates",value:function(){}},{key:"size",value:function(){}},{key:"getCoordinate",value:function(I){}},{key:"isClosed",value:function(){}},{key:"setData",value:function(I){}},{key:"getData",value:function(){}}])})(),Hn=(function(){return o((function I(){i(this,I)}),[{key:"addIntersection",value:function(I,y){}},{key:"interfaces_",get:function(){return[ui]}}])})(),Ui=(function(){function I(){i(this,I),I.constructor_.apply(this,arguments)}return o(I,[{key:"getCoordinates",value:function(){return this._pts}},{key:"size",value:function(){return this._pts.length}},{key:"getCoordinate",value:function(y){return this._pts[y]}},{key:"isClosed",value:function(){return this._pts[0].equals(this._pts[this._pts.length-1])}},{key:"getSegmentOctant",value:function(y){return y===this._pts.length-1?-1:this.safeOctant(this.getCoordinate(y),this.getCoordinate(y+1))}},{key:"setData",value:function(y){this._data=y}},{key:"safeOctant",value:function(y,_){return y.equals2D(_)?0:Un.octant(y,_)}},{key:"getData",value:function(){return this._data}},{key:"addIntersection",value:function(){if(arguments.length===2){var y=arguments[0],_=arguments[1];this.addIntersectionNode(y,_)}else if(arguments.length===4){var P=arguments[1],$=arguments[3],ne=new Be(arguments[0].getIntersection($));this.addIntersection(ne,P)}}},{key:"toString",value:function(){return tn.toLineString(new Ya(this._pts))}},{key:"getNodeList",value:function(){return this._nodeList}},{key:"addIntersectionNode",value:function(y,_){var P=_,$=P+1;if($<this._pts.length){var ne=this._pts[$];y.equals2D(ne)&&(P=$)}return this._nodeList.add(y,P)}},{key:"addIntersections",value:function(y,_,P){for(var $=0;$<y.getIntersectionNum();$++)this.addIntersection(y,_,P,$)}},{key:"interfaces_",get:function(){return[Hn]}}],[{key:"constructor_",value:function(){this._nodeList=new qn(this),this._pts=null,this._data=null;var y=arguments[0],_=arguments[1];this._pts=y,this._data=_}},{key:"getNodedSubstrings",value:function(){if(arguments.length===1){var y=arguments[0],_=new ct;return I.getNodedSubstrings(y,_),_}if(arguments.length===2)for(var P=arguments[1],$=arguments[0].iterator();$.hasNext();)$.next().getNodeList().addSplitEdges(P)}}])})(),Xi=(function(){function I(){i(this,I),I.constructor_.apply(this,arguments)}return o(I,[{key:"minX",value:function(){return Math.min(this.p0.x,this.p1.x)}},{key:"orientationIndex",value:function(){if(arguments[0]instanceof I){var y=arguments[0],_=Ge.index(this.p0,this.p1,y.p0),P=Ge.index(this.p0,this.p1,y.p1);return _>=0&&P>=0||_<=0&&P<=0?Math.max(_,P):0}if(arguments[0]instanceof Be){var $=arguments[0];return Ge.index(this.p0,this.p1,$)}}},{key:"toGeometry",value:function(y){return y.createLineString([this.p0,this.p1])}},{key:"isVertical",value:function(){return this.p0.x===this.p1.x}},{key:"equals",value:function(y){if(!(y instanceof I))return!1;var _=y;return this.p0.equals(_.p0)&&this.p1.equals(_.p1)}},{key:"intersection",value:function(y){var _=new on;return _.computeIntersection(this.p0,this.p1,y.p0,y.p1),_.hasIntersection()?_.getIntersection(0):null}},{key:"project",value:function(){if(arguments[0]instanceof Be){var y=arguments[0];if(y.equals(this.p0)||y.equals(this.p1))return new Be(y);var _=this.projectionFactor(y),P=new Be;return P.x=this.p0.x+_*(this.p1.x-this.p0.x),P.y=this.p0.y+_*(this.p1.y-this.p0.y),P}if(arguments[0]instanceof I){var $=arguments[0],ne=this.projectionFactor($.p0),me=this.projectionFactor($.p1);if(ne>=1&&me>=1||ne<=0&&me<=0)return null;var Oe=this.project($.p0);ne<0&&(Oe=this.p0),ne>1&&(Oe=this.p1);var tt=this.project($.p1);return me<0&&(tt=this.p0),me>1&&(tt=this.p1),new I(Oe,tt)}}},{key:"normalize",value:function(){this.p1.compareTo(this.p0)<0&&this.reverse()}},{key:"angle",value:function(){return Math.atan2(this.p1.y-this.p0.y,this.p1.x-this.p0.x)}},{key:"getCoordinate",value:function(y){return y===0?this.p0:this.p1}},{key:"distancePerpendicular",value:function(y){return fn.pointToLinePerpendicular(y,this.p0,this.p1)}},{key:"minY",value:function(){return Math.min(this.p0.y,this.p1.y)}},{key:"midPoint",value:function(){return I.midPoint(this.p0,this.p1)}},{key:"projectionFactor",value:function(y){if(y.equals(this.p0))return 0;if(y.equals(this.p1))return 1;var _=this.p1.x-this.p0.x,P=this.p1.y-this.p0.y,$=_*_+P*P;return $<=0?Ie.NaN:((y.x-this.p0.x)*_+(y.y-this.p0.y)*P)/$}},{key:"closestPoints",value:function(y){var _=this.intersection(y);if(_!==null)return[_,_];var P=new Array(2).fill(null),$=Ie.MAX_VALUE,ne=null,me=this.closestPoint(y.p0);$=me.distance(y.p0),P[0]=me,P[1]=y.p0;var Oe=this.closestPoint(y.p1);(ne=Oe.distance(y.p1))<$&&($=ne,P[0]=Oe,P[1]=y.p1);var tt=y.closestPoint(this.p0);(ne=tt.distance(this.p0))<$&&($=ne,P[0]=this.p0,P[1]=tt);var ft=y.closestPoint(this.p1);return(ne=ft.distance(this.p1))<$&&($=ne,P[0]=this.p1,P[1]=ft),P}},{key:"closestPoint",value:function(y){var _=this.projectionFactor(y);return _>0&&_<1?this.project(y):this.p0.distance(y)<this.p1.distance(y)?this.p0:this.p1}},{key:"maxX",value:function(){return Math.max(this.p0.x,this.p1.x)}},{key:"getLength",value:function(){return this.p0.distance(this.p1)}},{key:"compareTo",value:function(y){var _=y,P=this.p0.compareTo(_.p0);return P!==0?P:this.p1.compareTo(_.p1)}},{key:"reverse",value:function(){var y=this.p0;this.p0=this.p1,this.p1=y}},{key:"equalsTopo",value:function(y){return this.p0.equals(y.p0)&&this.p1.equals(y.p1)||this.p0.equals(y.p1)&&this.p1.equals(y.p0)}},{key:"lineIntersection",value:function(y){return Ir.intersection(this.p0,this.p1,y.p0,y.p1)}},{key:"maxY",value:function(){return Math.max(this.p0.y,this.p1.y)}},{key:"pointAlongOffset",value:function(y,_){var P=this.p0.x+y*(this.p1.x-this.p0.x),$=this.p0.y+y*(this.p1.y-this.p0.y),ne=this.p1.x-this.p0.x,me=this.p1.y-this.p0.y,Oe=Math.sqrt(ne*ne+me*me),tt=0,ft=0;if(_!==0){if(Oe<=0)throw new IllegalStateException("Cannot compute offset from zero-length line segment");tt=_*ne/Oe,ft=_*me/Oe}return new Be(P-ft,$+tt)}},{key:"setCoordinates",value:function(){if(arguments.length===1){var y=arguments[0];this.setCoordinates(y.p0,y.p1)}else if(arguments.length===2){var _=arguments[0],P=arguments[1];this.p0.x=_.x,this.p0.y=_.y,this.p1.x=P.x,this.p1.y=P.y}}},{key:"segmentFraction",value:function(y){var _=this.projectionFactor(y);return _<0?_=0:(_>1||Ie.isNaN(_))&&(_=1),_}},{key:"toString",value:function(){return"LINESTRING( "+this.p0.x+" "+this.p0.y+", "+this.p1.x+" "+this.p1.y+")"}},{key:"isHorizontal",value:function(){return this.p0.y===this.p1.y}},{key:"reflect",value:function(y){var _=this.p1.getY()-this.p0.getY(),P=this.p0.getX()-this.p1.getX(),$=this.p0.getY()*(this.p1.getX()-this.p0.getX())-this.p0.getX()*(this.p1.getY()-this.p0.getY()),ne=_*_+P*P,me=_*_-P*P,Oe=y.getX(),tt=y.getY();return new Be((-me*Oe-2*_*P*tt-2*_*$)/ne,(me*tt-2*_*P*Oe-2*P*$)/ne)}},{key:"distance",value:function(){if(arguments[0]instanceof I){var y=arguments[0];return fn.segmentToSegment(this.p0,this.p1,y.p0,y.p1)}if(arguments[0]instanceof Be){var _=arguments[0];return fn.pointToSegment(_,this.p0,this.p1)}}},{key:"pointAlong",value:function(y){var _=new Be;return _.x=this.p0.x+y*(this.p1.x-this.p0.x),_.y=this.p0.y+y*(this.p1.y-this.p0.y),_}},{key:"hashCode",value:function(){var y=Ie.doubleToLongBits(this.p0.x);y^=31*Ie.doubleToLongBits(this.p0.y);var _=Math.trunc(y)^Math.trunc(y>>32),P=Ie.doubleToLongBits(this.p1.x);return P^=31*Ie.doubleToLongBits(this.p1.y),_^(Math.trunc(P)^Math.trunc(P>>32))}},{key:"interfaces_",get:function(){return[H,X]}}],[{key:"constructor_",value:function(){if(this.p0=null,this.p1=null,arguments.length===0)I.constructor_.call(this,new Be,new Be);else if(arguments.length===1){var y=arguments[0];I.constructor_.call(this,y.p0,y.p1)}else if(arguments.length===2){var _=arguments[0],P=arguments[1];this.p0=_,this.p1=P}else if(arguments.length===4){var $=arguments[0],ne=arguments[1],me=arguments[2],Oe=arguments[3];I.constructor_.call(this,new Be($,ne),new Be(me,Oe))}}},{key:"midPoint",value:function(y,_){return new Be((y.x+_.x)/2,(y.y+_.y)/2)}}])})(),ra=(function(){return o((function I(){i(this,I),I.constructor_.apply(this,arguments)}),[{key:"overlap",value:function(){if(arguments.length!==2){if(arguments.length===4){var I=arguments[1],y=arguments[2],_=arguments[3];arguments[0].getLineSegment(I,this._overlapSeg1),y.getLineSegment(_,this._overlapSeg2),this.overlap(this._overlapSeg1,this._overlapSeg2)}}}}],[{key:"constructor_",value:function(){this._overlapSeg1=new Xi,this._overlapSeg2=new Xi}}])})(),Si=(function(){return o((function I(){i(this,I),I.constructor_.apply(this,arguments)}),[{key:"getLineSegment",value:function(I,y){y.p0=this._pts[I],y.p1=this._pts[I+1]}},{key:"computeSelect",value:function(I,y,_,P){var $=this._pts[y],ne=this._pts[_];if(_-y==1)return P.select(this,y),null;if(!I.intersects($,ne))return null;var me=Math.trunc((y+_)/2);y<me&&this.computeSelect(I,y,me,P),me<_&&this.computeSelect(I,me,_,P)}},{key:"getCoordinates",value:function(){for(var I=new Array(this._end-this._start+1).fill(null),y=0,_=this._start;_<=this._end;_++)I[y++]=this._pts[_];return I}},{key:"computeOverlaps",value:function(){if(arguments.length===2){var I=arguments[0],y=arguments[1];this.computeOverlaps(this._start,this._end,I,I._start,I._end,y)}else if(arguments.length===6){var _=arguments[0],P=arguments[1],$=arguments[2],ne=arguments[3],me=arguments[4],Oe=arguments[5];if(P-_==1&&me-ne==1)return Oe.overlap(this,_,$,ne),null;if(!this.overlaps(_,P,$,ne,me))return null;var tt=Math.trunc((_+P)/2),ft=Math.trunc((ne+me)/2);_<tt&&(ne<ft&&this.computeOverlaps(_,tt,$,ne,ft,Oe),ft<me&&this.computeOverlaps(_,tt,$,ft,me,Oe)),tt<P&&(ne<ft&&this.computeOverlaps(tt,P,$,ne,ft,Oe),ft<me&&this.computeOverlaps(tt,P,$,ft,me,Oe))}}},{key:"setId",value:function(I){this._id=I}},{key:"select",value:function(I,y){this.computeSelect(I,this._start,this._end,y)}},{key:"getEnvelope",value:function(){if(this._env===null){var I=this._pts[this._start],y=this._pts[this._end];this._env=new Qe(I,y)}return this._env}},{key:"overlaps",value:function(I,y,_,P,$){return Qe.intersects(this._pts[I],this._pts[y],_._pts[P],_._pts[$])}},{key:"getEndIndex",value:function(){return this._end}},{key:"getStartIndex",value:function(){return this._start}},{key:"getContext",value:function(){return this._context}},{key:"getId",value:function(){return this._id}}],[{key:"constructor_",value:function(){this._pts=null,this._start=null,this._end=null,this._env=null,this._context=null,this._id=null;var I=arguments[0],y=arguments[1],_=arguments[2],P=arguments[3];this._pts=I,this._start=y,this._end=_,this._context=P}}])})(),Ia=(function(){function I(){i(this,I)}return o(I,null,[{key:"findChainEnd",value:function(y,_){for(var P=_;P<y.length-1&&y[P].equals2D(y[P+1]);)P++;if(P>=y.length-1)return y.length-1;for(var $=oa.quadrant(y[P],y[P+1]),ne=_+1;ne<y.length&&!(!y[ne-1].equals2D(y[ne])&&oa.quadrant(y[ne-1],y[ne])!==$);)ne++;return ne-1}},{key:"getChains",value:function(){if(arguments.length===1){var y=arguments[0];return I.getChains(y,null)}if(arguments.length===2){var _=arguments[0],P=arguments[1],$=new ct,ne=0;do{var me=I.findChainEnd(_,ne),Oe=new Si(_,ne,me,P);$.add(Oe),ne=me}while(ne<_.length-1);return $}}}])})(),za=(function(){return o((function I(){i(this,I)}),[{key:"computeNodes",value:function(I){}},{key:"getNodedSubstrings",value:function(){}}])})(),Hs=(function(){return o((function I(){i(this,I),I.constructor_.apply(this,arguments)}),[{key:"setSegmentIntersector",value:function(I){this._segInt=I}},{key:"interfaces_",get:function(){return[za]}}],[{key:"constructor_",value:function(){if(this._segInt=null,arguments.length!==0){if(arguments.length===1){var I=arguments[0];this.setSegmentIntersector(I)}}}}])})(),ll=(function(I){function y(){var _;return i(this,y),_=n(this,y),y.constructor_.apply(_,arguments),_}return m(y,I),o(y,[{key:"getMonotoneChains",value:function(){return this._monoChains}},{key:"getNodedSubstrings",value:function(){return Ui.getNodedSubstrings(this._nodedSegStrings)}},{key:"getIndex",value:function(){return this._index}},{key:"add",value:function(_){for(var P=Ia.getChains(_.getCoordinates(),_).iterator();P.hasNext();){var $=P.next();$.setId(this._idCounter++),this._index.insert($.getEnvelope(),$),this._monoChains.add($)}}},{key:"computeNodes",value:function(_){this._nodedSegStrings=_;for(var P=_.iterator();P.hasNext();)this.add(P.next());this.intersectChains()}},{key:"intersectChains",value:function(){for(var _=new Gs(this._segInt),P=this._monoChains.iterator();P.hasNext();)for(var $=P.next(),ne=this._index.query($.getEnvelope()).iterator();ne.hasNext();){var me=ne.next();if(me.getId()>$.getId()&&($.computeOverlaps(me,_),this._nOverlaps++),this._segInt.isDone())return null}}}],[{key:"constructor_",value:function(){if(this._monoChains=new ct,this._index=new zt,this._idCounter=0,this._nodedSegStrings=null,this._nOverlaps=0,arguments.length!==0){if(arguments.length===1){var _=arguments[0];Hs.constructor_.call(this,_)}}}}])})(Hs),Gs=(function(I){function y(){var _;return i(this,y),_=n(this,y),y.constructor_.apply(_,arguments),_}return m(y,I),o(y,[{key:"overlap",value:function(){if(arguments.length!==4)return E(y,"overlap",this,1).apply(this,arguments);var _=arguments[1],P=arguments[2],$=arguments[3],ne=arguments[0].getContext(),me=P.getContext();this._si.processIntersections(ne,_,me,$)}}],[{key:"constructor_",value:function(){this._si=null;var _=arguments[0];this._si=_}}])})(ra);ll.SegmentOverlapAction=Gs;var $o=(function(){function I(){i(this,I),I.constructor_.apply(this,arguments)}return o(I,[{key:"isDeletable",value:function(y,_,P,$){var ne=this._inputLine[y],me=this._inputLine[_],Oe=this._inputLine[P];return!!this.isConcave(ne,me,Oe)&&!!this.isShallow(ne,me,Oe,$)&&this.isShallowSampled(ne,me,y,P,$)}},{key:"deleteShallowConcavities",value:function(){for(var y=1,_=this.findNextNonDeletedIndex(y),P=this.findNextNonDeletedIndex(_),$=!1;P<this._inputLine.length;){var ne=!1;this.isDeletable(y,_,P,this._distanceTol)&&(this._isDeleted[_]=I.DELETE,ne=!0,$=!0),y=ne?P:_,_=this.findNextNonDeletedIndex(y),P=this.findNextNonDeletedIndex(_)}return $}},{key:"isShallowConcavity",value:function(y,_,P,$){return Ge.index(y,_,P)===this._angleOrientation&&fn.pointToSegment(_,y,P)<$}},{key:"isShallowSampled",value:function(y,_,P,$,ne){var me=Math.trunc(($-P)/I.NUM_PTS_TO_CHECK);me<=0&&(me=1);for(var Oe=P;Oe<$;Oe+=me)if(!this.isShallow(y,_,this._inputLine[Oe],ne))return!1;return!0}},{key:"isConcave",value:function(y,_,P){var $=Ge.index(y,_,P)===this._angleOrientation;return $}},{key:"simplify",value:function(y){this._distanceTol=Math.abs(y),y<0&&(this._angleOrientation=Ge.CLOCKWISE),this._isDeleted=new Array(this._inputLine.length).fill(null);var _=!1;do _=this.deleteShallowConcavities();while(_);return this.collapseLine()}},{key:"findNextNonDeletedIndex",value:function(y){for(var _=y+1;_<this._inputLine.length&&this._isDeleted[_]===I.DELETE;)_++;return _}},{key:"isShallow",value:function(y,_,P,$){return fn.pointToSegment(_,y,P)<$}},{key:"collapseLine",value:function(){for(var y=new La,_=0;_<this._inputLine.length;_++)this._isDeleted[_]!==I.DELETE&&y.add(this._inputLine[_]);return y.toCoordinateArray()}}],[{key:"constructor_",value:function(){this._inputLine=null,this._distanceTol=null,this._isDeleted=null,this._angleOrientation=Ge.COUNTERCLOCKWISE;var y=arguments[0];this._inputLine=y}},{key:"simplify",value:function(y,_){return new I(y).simplify(_)}}])})();$o.INIT=0,$o.DELETE=1,$o.KEEP=1,$o.NUM_PTS_TO_CHECK=10;var Ws=(function(){function I(){i(this,I),I.constructor_.apply(this,arguments)}return o(I,[{key:"getCoordinates",value:function(){return this._ptList.toArray(I.COORDINATE_ARRAY_TYPE)}},{key:"setPrecisionModel",value:function(y){this._precisionModel=y}},{key:"addPt",value:function(y){var _=new Be(y);if(this._precisionModel.makePrecise(_),this.isRedundant(_))return null;this._ptList.add(_)}},{key:"reverse",value:function(){}},{key:"addPts",value:function(y,_){if(_)for(var P=0;P<y.length;P++)this.addPt(y[P]);else for(var $=y.length-1;$>=0;$--)this.addPt(y[$])}},{key:"isRedundant",value:function(y){if(this._ptList.size()<1)return!1;var _=this._ptList.get(this._ptList.size()-1);return y.distance(_)<this._minimimVertexDistance}},{key:"toString",value:function(){return new Aa().createLineString(this.getCoordinates()).toString()}},{key:"closeRing",value:function(){if(this._ptList.size()<1)return null;var y=new Be(this._ptList.get(0)),_=this._ptList.get(this._ptList.size()-1);if(y.equals(_))return null;this._ptList.add(y)}},{key:"setMinimumVertexDistance",value:function(y){this._minimimVertexDistance=y}}],[{key:"constructor_",value:function(){this._ptList=null,this._precisionModel=null,this._minimimVertexDistance=0,this._ptList=new ct}}])})();Ws.COORDINATE_ARRAY_TYPE=new Array(0).fill(null);var Pa=(function(){function I(){i(this,I)}return o(I,null,[{key:"toDegrees",value:function(y){return 180*y/Math.PI}},{key:"normalize",value:function(y){for(;y>Math.PI;)y-=I.PI_TIMES_2;for(;y<=-Math.PI;)y+=I.PI_TIMES_2;return y}},{key:"angle",value:function(){if(arguments.length===1){var y=arguments[0];return Math.atan2(y.y,y.x)}if(arguments.length===2){var _=arguments[0],P=arguments[1],$=P.x-_.x,ne=P.y-_.y;return Math.atan2(ne,$)}}},{key:"isAcute",value:function(y,_,P){var $=y.x-_.x,ne=y.y-_.y;return $*(P.x-_.x)+ne*(P.y-_.y)>0}},{key:"isObtuse",value:function(y,_,P){var $=y.x-_.x,ne=y.y-_.y;return $*(P.x-_.x)+ne*(P.y-_.y)<0}},{key:"interiorAngle",value:function(y,_,P){var $=I.angle(_,y),ne=I.angle(_,P);return Math.abs(ne-$)}},{key:"normalizePositive",value:function(y){if(y<0){for(;y<0;)y+=I.PI_TIMES_2;y>=I.PI_TIMES_2&&(y=0)}else{for(;y>=I.PI_TIMES_2;)y-=I.PI_TIMES_2;y<0&&(y=0)}return y}},{key:"angleBetween",value:function(y,_,P){var $=I.angle(_,y),ne=I.angle(_,P);return I.diff($,ne)}},{key:"diff",value:function(y,_){var P=null;return(P=y<_?_-y:y-_)>Math.PI&&(P=2*Math.PI-P),P}},{key:"toRadians",value:function(y){return y*Math.PI/180}},{key:"getTurn",value:function(y,_){var P=Math.sin(_-y);return P>0?I.COUNTERCLOCKWISE:P<0?I.CLOCKWISE:I.NONE}},{key:"angleBetweenOriented",value:function(y,_,P){var $=I.angle(_,y),ne=I.angle(_,P)-$;return ne<=-Math.PI?ne+I.PI_TIMES_2:ne>Math.PI?ne-I.PI_TIMES_2:ne}}])})();Pa.PI_TIMES_2=2*Math.PI,Pa.PI_OVER_2=Math.PI/2,Pa.PI_OVER_4=Math.PI/4,Pa.COUNTERCLOCKWISE=Ge.COUNTERCLOCKWISE,Pa.CLOCKWISE=Ge.CLOCKWISE,Pa.NONE=Ge.COLLINEAR;var Xs=(function(){function I(){i(this,I),I.constructor_.apply(this,arguments)}return o(I,[{key:"addNextSegment",value:function(y,_){if(this._s0=this._s1,this._s1=this._s2,this._s2=y,this._seg0.setCoordinates(this._s0,this._s1),this.computeOffsetSegment(this._seg0,this._side,this._distance,this._offset0),this._seg1.setCoordinates(this._s1,this._s2),this.computeOffsetSegment(this._seg1,this._side,this._distance,this._offset1),this._s1.equals(this._s2))return null;var P=Ge.index(this._s0,this._s1,this._s2),$=P===Ge.CLOCKWISE&&this._side===_t.LEFT||P===Ge.COUNTERCLOCKWISE&&this._side===_t.RIGHT;P===0?this.addCollinear(_):$?this.addOutsideTurn(P,_):this.addInsideTurn(P,_)}},{key:"addLineEndCap",value:function(y,_){var P=new Xi(y,_),$=new Xi;this.computeOffsetSegment(P,_t.LEFT,this._distance,$);var ne=new Xi;this.computeOffsetSegment(P,_t.RIGHT,this._distance,ne);var me=_.x-y.x,Oe=_.y-y.y,tt=Math.atan2(Oe,me);switch(this._bufParams.getEndCapStyle()){case N.CAP_ROUND:this._segList.addPt($.p1),this.addDirectedFillet(_,tt+Math.PI/2,tt-Math.PI/2,Ge.CLOCKWISE,this._distance),this._segList.addPt(ne.p1);break;case N.CAP_FLAT:this._segList.addPt($.p1),this._segList.addPt(ne.p1);break;case N.CAP_SQUARE:var ft=new Be;ft.x=Math.abs(this._distance)*Math.cos(tt),ft.y=Math.abs(this._distance)*Math.sin(tt);var rr=new Be($.p1.x+ft.x,$.p1.y+ft.y),ur=new Be(ne.p1.x+ft.x,ne.p1.y+ft.y);this._segList.addPt(rr),this._segList.addPt(ur)}}},{key:"getCoordinates",value:function(){return this._segList.getCoordinates()}},{key:"addMitreJoin",value:function(y,_,P,$){var ne=Ir.intersection(_.p0,_.p1,P.p0,P.p1);if(ne!==null&&($<=0?1:ne.distance(y)/Math.abs($))<=this._bufParams.getMitreLimit())return this._segList.addPt(ne),null;this.addLimitedMitreJoin(_,P,$,this._bufParams.getMitreLimit())}},{key:"addOutsideTurn",value:function(y,_){if(this._offset0.p1.distance(this._offset1.p0)<this._distance*I.OFFSET_SEGMENT_SEPARATION_FACTOR)return this._segList.addPt(this._offset0.p1),null;this._bufParams.getJoinStyle()===N.JOIN_MITRE?this.addMitreJoin(this._s1,this._offset0,this._offset1,this._distance):this._bufParams.getJoinStyle()===N.JOIN_BEVEL?this.addBevelJoin(this._offset0,this._offset1):(_&&this._segList.addPt(this._offset0.p1),this.addCornerFillet(this._s1,this._offset0.p1,this._offset1.p0,y,this._distance),this._segList.addPt(this._offset1.p0))}},{key:"createSquare",value:function(y){this._segList.addPt(new Be(y.x+this._distance,y.y+this._distance)),this._segList.addPt(new Be(y.x+this._distance,y.y-this._distance)),this._segList.addPt(new Be(y.x-this._distance,y.y-this._distance)),this._segList.addPt(new Be(y.x-this._distance,y.y+this._distance)),this._segList.closeRing()}},{key:"addSegments",value:function(y,_){this._segList.addPts(y,_)}},{key:"addFirstSegment",value:function(){this._segList.addPt(this._offset1.p0)}},{key:"addCornerFillet",value:function(y,_,P,$,ne){var me=_.x-y.x,Oe=_.y-y.y,tt=Math.atan2(Oe,me),ft=P.x-y.x,rr=P.y-y.y,ur=Math.atan2(rr,ft);$===Ge.CLOCKWISE?tt<=ur&&(tt+=2*Math.PI):tt>=ur&&(tt-=2*Math.PI),this._segList.addPt(_),this.addDirectedFillet(y,tt,ur,$,ne),this._segList.addPt(P)}},{key:"addLastSegment",value:function(){this._segList.addPt(this._offset1.p1)}},{key:"initSideSegments",value:function(y,_,P){this._s1=y,this._s2=_,this._side=P,this._seg1.setCoordinates(y,_),this.computeOffsetSegment(this._seg1,P,this._distance,this._offset1)}},{key:"addLimitedMitreJoin",value:function(y,_,P,$){var ne=this._seg0.p1,me=Pa.angle(ne,this._seg0.p0),Oe=Pa.angleBetweenOriented(this._seg0.p0,ne,this._seg1.p1)/2,tt=Pa.normalize(me+Oe),ft=Pa.normalize(tt+Math.PI),rr=$*P,ur=P-rr*Math.abs(Math.sin(Oe)),qr=ne.x+rr*Math.cos(ft),bn=ne.y+rr*Math.sin(ft),Dn=new Be(qr,bn),Xn=new Xi(ne,Dn),Fn=Xn.pointAlongOffset(1,ur),En=Xn.pointAlongOffset(1,-ur);this._side===_t.LEFT?(this._segList.addPt(Fn),this._segList.addPt(En)):(this._segList.addPt(En),this._segList.addPt(Fn))}},{key:"addDirectedFillet",value:function(y,_,P,$,ne){var me=$===Ge.CLOCKWISE?-1:1,Oe=Math.abs(_-P),tt=Math.trunc(Oe/this._filletAngleQuantum+.5);if(tt<1)return null;for(var ft=Oe/tt,rr=new Be,ur=0;ur<tt;ur++){var qr=_+me*ur*ft;rr.x=y.x+ne*Math.cos(qr),rr.y=y.y+ne*Math.sin(qr),this._segList.addPt(rr)}}},{key:"computeOffsetSegment",value:function(y,_,P,$){var ne=_===_t.LEFT?1:-1,me=y.p1.x-y.p0.x,Oe=y.p1.y-y.p0.y,tt=Math.sqrt(me*me+Oe*Oe),ft=ne*P*me/tt,rr=ne*P*Oe/tt;$.p0.x=y.p0.x-rr,$.p0.y=y.p0.y+ft,$.p1.x=y.p1.x-rr,$.p1.y=y.p1.y+ft}},{key:"addInsideTurn",value:function(y,_){if(this._li.computeIntersection(this._offset0.p0,this._offset0.p1,this._offset1.p0,this._offset1.p1),this._li.hasIntersection())this._segList.addPt(this._li.getIntersection(0));else if(this._hasNarrowConcaveAngle=!0,this._offset0.p1.distance(this._offset1.p0)<this._distance*I.INSIDE_TURN_VERTEX_SNAP_DISTANCE_FACTOR)this._segList.addPt(this._offset0.p1);else{if(this._segList.addPt(this._offset0.p1),this._closingSegLengthFactor>0){var P=new Be((this._closingSegLengthFactor*this._offset0.p1.x+this._s1.x)/(this._closingSegLengthFactor+1),(this._closingSegLengthFactor*this._offset0.p1.y+this._s1.y)/(this._closingSegLengthFactor+1));this._segList.addPt(P);var $=new Be((this._closingSegLengthFactor*this._offset1.p0.x+this._s1.x)/(this._closingSegLengthFactor+1),(this._closingSegLengthFactor*this._offset1.p0.y+this._s1.y)/(this._closingSegLengthFactor+1));this._segList.addPt($)}else this._segList.addPt(this._s1);this._segList.addPt(this._offset1.p0)}}},{key:"createCircle",value:function(y){var _=new Be(y.x+this._distance,y.y);this._segList.addPt(_),this.addDirectedFillet(y,0,2*Math.PI,-1,this._distance),this._segList.closeRing()}},{key:"addBevelJoin",value:function(y,_){this._segList.addPt(y.p1),this._segList.addPt(_.p0)}},{key:"init",value:function(y){this._distance=y,this._maxCurveSegmentError=y*(1-Math.cos(this._filletAngleQuantum/2)),this._segList=new Ws,this._segList.setPrecisionModel(this._precisionModel),this._segList.setMinimumVertexDistance(y*I.CURVE_VERTEX_SNAP_DISTANCE_FACTOR)}},{key:"addCollinear",value:function(y){this._li.computeIntersection(this._s0,this._s1,this._s1,this._s2),this._li.getIntersectionNum()>=2&&(this._bufParams.getJoinStyle()===N.JOIN_BEVEL||this._bufParams.getJoinStyle()===N.JOIN_MITRE?(y&&this._segList.addPt(this._offset0.p1),this._segList.addPt(this._offset1.p0)):this.addCornerFillet(this._s1,this._offset0.p1,this._offset1.p0,Ge.CLOCKWISE,this._distance))}},{key:"closeRing",value:function(){this._segList.closeRing()}},{key:"hasNarrowConcaveAngle",value:function(){return this._hasNarrowConcaveAngle}}],[{key:"constructor_",value:function(){this._maxCurveSegmentError=0,this._filletAngleQuantum=null,this._closingSegLengthFactor=1,this._segList=null,this._distance=0,this._precisionModel=null,this._bufParams=null,this._li=null,this._s0=null,this._s1=null,this._s2=null,this._seg0=new Xi,this._seg1=new Xi,this._offset0=new Xi,this._offset1=new Xi,this._side=0,this._hasNarrowConcaveAngle=!1;var y=arguments[0],_=arguments[1],P=arguments[2];this._precisionModel=y,this._bufParams=_,this._li=new on,this._filletAngleQuantum=Math.PI/2/_.getQuadrantSegments(),_.getQuadrantSegments()>=8&&_.getJoinStyle()===N.JOIN_ROUND&&(this._closingSegLengthFactor=I.MAX_CLOSING_SEG_LEN_FACTOR),this.init(P)}}])})();Xs.OFFSET_SEGMENT_SEPARATION_FACTOR=.001,Xs.INSIDE_TURN_VERTEX_SNAP_DISTANCE_FACTOR=.001,Xs.CURVE_VERTEX_SNAP_DISTANCE_FACTOR=1e-6,Xs.MAX_CLOSING_SEG_LEN_FACTOR=80;var Il=(function(){function I(){i(this,I),I.constructor_.apply(this,arguments)}return o(I,[{key:"getOffsetCurve",value:function(y,_){if(this._distance=_,_===0)return null;var P=_<0,$=Math.abs(_),ne=this.getSegGen($);y.length<=1?this.computePointCurve(y[0],ne):this.computeOffsetCurve(y,P,ne);var me=ne.getCoordinates();return P&&Wi.reverse(me),me}},{key:"computeSingleSidedBufferCurve",value:function(y,_,P){var $=this.simplifyTolerance(this._distance);if(_){P.addSegments(y,!0);var ne=$o.simplify(y,-$),me=ne.length-1;P.initSideSegments(ne[me],ne[me-1],_t.LEFT),P.addFirstSegment();for(var Oe=me-2;Oe>=0;Oe--)P.addNextSegment(ne[Oe],!0)}else{P.addSegments(y,!1);var tt=$o.simplify(y,$),ft=tt.length-1;P.initSideSegments(tt[0],tt[1],_t.LEFT),P.addFirstSegment();for(var rr=2;rr<=ft;rr++)P.addNextSegment(tt[rr],!0)}P.addLastSegment(),P.closeRing()}},{key:"computeRingBufferCurve",value:function(y,_,P){var $=this.simplifyTolerance(this._distance);_===_t.RIGHT&&($=-$);var ne=$o.simplify(y,$),me=ne.length-1;P.initSideSegments(ne[me-1],ne[0],_);for(var Oe=1;Oe<=me;Oe++){var tt=Oe!==1;P.addNextSegment(ne[Oe],tt)}P.closeRing()}},{key:"computeLineBufferCurve",value:function(y,_){var P=this.simplifyTolerance(this._distance),$=$o.simplify(y,P),ne=$.length-1;_.initSideSegments($[0],$[1],_t.LEFT);for(var me=2;me<=ne;me++)_.addNextSegment($[me],!0);_.addLastSegment(),_.addLineEndCap($[ne-1],$[ne]);var Oe=$o.simplify(y,-P),tt=Oe.length-1;_.initSideSegments(Oe[tt],Oe[tt-1],_t.LEFT);for(var ft=tt-2;ft>=0;ft--)_.addNextSegment(Oe[ft],!0);_.addLastSegment(),_.addLineEndCap(Oe[1],Oe[0]),_.closeRing()}},{key:"computePointCurve",value:function(y,_){switch(this._bufParams.getEndCapStyle()){case N.CAP_ROUND:_.createCircle(y);break;case N.CAP_SQUARE:_.createSquare(y)}}},{key:"getLineCurve",value:function(y,_){if(this._distance=_,this.isLineOffsetEmpty(_))return null;var P=Math.abs(_),$=this.getSegGen(P);if(y.length<=1)this.computePointCurve(y[0],$);else if(this._bufParams.isSingleSided()){var ne=_<0;this.computeSingleSidedBufferCurve(y,ne,$)}else this.computeLineBufferCurve(y,$);return $.getCoordinates()}},{key:"getBufferParameters",value:function(){return this._bufParams}},{key:"simplifyTolerance",value:function(y){return y*this._bufParams.getSimplifyFactor()}},{key:"getRingCurve",value:function(y,_,P){if(this._distance=P,y.length<=2)return this.getLineCurve(y,P);if(P===0)return I.copyCoordinates(y);var $=this.getSegGen(P);return this.computeRingBufferCurve(y,_,$),$.getCoordinates()}},{key:"computeOffsetCurve",value:function(y,_,P){var $=this.simplifyTolerance(this._distance);if(_){var ne=$o.simplify(y,-$),me=ne.length-1;P.initSideSegments(ne[me],ne[me-1],_t.LEFT),P.addFirstSegment();for(var Oe=me-2;Oe>=0;Oe--)P.addNextSegment(ne[Oe],!0)}else{var tt=$o.simplify(y,$),ft=tt.length-1;P.initSideSegments(tt[0],tt[1],_t.LEFT),P.addFirstSegment();for(var rr=2;rr<=ft;rr++)P.addNextSegment(tt[rr],!0)}P.addLastSegment()}},{key:"isLineOffsetEmpty",value:function(y){return y===0||y<0&&!this._bufParams.isSingleSided()}},{key:"getSegGen",value:function(y){return new Xs(this._precisionModel,this._bufParams,y)}}],[{key:"constructor_",value:function(){this._distance=0,this._precisionModel=null,this._bufParams=null;var y=arguments[0],_=arguments[1];this._precisionModel=y,this._bufParams=_}},{key:"copyCoordinates",value:function(y){for(var _=new Array(y.length).fill(null),P=0;P<_.length;P++)_[P]=new Be(y[P]);return _}}])})(),gs=(function(){return o((function I(){i(this,I),I.constructor_.apply(this,arguments)}),[{key:"findStabbedSegments",value:function(){if(arguments.length===1){for(var I=arguments[0],y=new ct,_=this._subgraphs.iterator();_.hasNext();){var P=_.next(),$=P.getEnvelope();I.y<$.getMinY()||I.y>$.getMaxY()||this.findStabbedSegments(I,P.getDirectedEdges(),y)}return y}if(arguments.length===3){if(Er(arguments[2],ar)&&arguments[0]instanceof Be&&arguments[1]instanceof Ka){for(var ne=arguments[0],me=arguments[1],Oe=arguments[2],tt=me.getEdge().getCoordinates(),ft=0;ft<tt.length-1;ft++)if(this._seg.p0=tt[ft],this._seg.p1=tt[ft+1],this._seg.p0.y>this._seg.p1.y&&this._seg.reverse(),!(Math.max(this._seg.p0.x,this._seg.p1.x)<ne.x||this._seg.isHorizontal()||ne.y<this._seg.p0.y||ne.y>this._seg.p1.y||Ge.index(this._seg.p0,this._seg.p1,ne)===Ge.RIGHT)){var rr=me.getDepth(_t.LEFT);this._seg.p0.equals(tt[ft])||(rr=me.getDepth(_t.RIGHT));var ur=new Di(this._seg,rr);Oe.add(ur)}}else if(Er(arguments[2],ar)&&arguments[0]instanceof Be&&Er(arguments[1],ar))for(var qr=arguments[0],bn=arguments[2],Dn=arguments[1].iterator();Dn.hasNext();){var Xn=Dn.next();Xn.isForward()&&this.findStabbedSegments(qr,Xn,bn)}}}},{key:"getDepth",value:function(I){var y=this.findStabbedSegments(I);return y.size()===0?0:ri.min(y)._leftDepth}}],[{key:"constructor_",value:function(){this._subgraphs=null,this._seg=new Xi;var I=arguments[0];this._subgraphs=I}}])})(),Di=(function(){return o((function I(){i(this,I),I.constructor_.apply(this,arguments)}),[{key:"compareTo",value:function(I){var y=I;if(this._upwardSeg.minX()>=y._upwardSeg.maxX())return 1;if(this._upwardSeg.maxX()<=y._upwardSeg.minX())return-1;var _=this._upwardSeg.orientationIndex(y._upwardSeg);return _!==0||(_=-1*y._upwardSeg.orientationIndex(this._upwardSeg))!==0?_:this._upwardSeg.compareTo(y._upwardSeg)}},{key:"compareX",value:function(I,y){var _=I.p0.compareTo(y.p0);return _!==0?_:I.p1.compareTo(y.p1)}},{key:"toString",value:function(){return this._upwardSeg.toString()}},{key:"interfaces_",get:function(){return[H]}}],[{key:"constructor_",value:function(){this._upwardSeg=null,this._leftDepth=null;var I=arguments[0],y=arguments[1];this._upwardSeg=new Xi(I),this._leftDepth=y}}])})();gs.DepthSegment=Di;var qo=(function(I){function y(){var _;return i(this,y),_=n(this,y),y.constructor_.apply(_,arguments),_}return m(y,I),o(y,null,[{key:"constructor_",value:function(){O.constructor_.call(this,"Projective point not representable on the Cartesian plane.")}}])})(O),Da=(function(){function I(){i(this,I),I.constructor_.apply(this,arguments)}return o(I,[{key:"getY",value:function(){var y=this.y/this.w;if(Ie.isNaN(y)||Ie.isInfinite(y))throw new qo;return y}},{key:"getX",value:function(){var y=this.x/this.w;if(Ie.isNaN(y)||Ie.isInfinite(y))throw new qo;return y}},{key:"getCoordinate",value:function(){var y=new Be;return y.x=this.getX(),y.y=this.getY(),y}}],[{key:"constructor_",value:function(){if(this.x=null,this.y=null,this.w=null,arguments.length===0)this.x=0,this.y=0,this.w=1;else if(arguments.length===1){var y=arguments[0];this.x=y.x,this.y=y.y,this.w=1}else if(arguments.length===2){if(typeof arguments[0]=="number"&&typeof arguments[1]=="number"){var _=arguments[0],P=arguments[1];this.x=_,this.y=P,this.w=1}else if(arguments[0]instanceof I&&arguments[1]instanceof I){var $=arguments[0],ne=arguments[1];this.x=$.y*ne.w-ne.y*$.w,this.y=ne.x*$.w-$.x*ne.w,this.w=$.x*ne.y-ne.x*$.y}else if(arguments[0]instanceof Be&&arguments[1]instanceof Be){var me=arguments[0],Oe=arguments[1];this.x=me.y-Oe.y,this.y=Oe.x-me.x,this.w=me.x*Oe.y-Oe.x*me.y}}else if(arguments.length===3){var tt=arguments[0],ft=arguments[1],rr=arguments[2];this.x=tt,this.y=ft,this.w=rr}else if(arguments.length===4){var ur=arguments[0],qr=arguments[1],bn=arguments[2],Dn=arguments[3],Xn=ur.y-qr.y,Fn=qr.x-ur.x,En=ur.x*qr.y-qr.x*ur.y,na=bn.y-Dn.y,ca=Dn.x-bn.x,so=bn.x*Dn.y-Dn.x*bn.y;this.x=Fn*so-ca*En,this.y=na*En-Xn*so,this.w=Xn*ca-na*Fn}}}])})(),ns=(function(){function I(){i(this,I),I.constructor_.apply(this,arguments)}return o(I,[{key:"area",value:function(){return I.area(this.p0,this.p1,this.p2)}},{key:"signedArea",value:function(){return I.signedArea(this.p0,this.p1,this.p2)}},{key:"interpolateZ",value:function(y){if(y===null)throw new U("Supplied point is null.");return I.interpolateZ(y,this.p0,this.p1,this.p2)}},{key:"longestSideLength",value:function(){return I.longestSideLength(this.p0,this.p1,this.p2)}},{key:"isAcute",value:function(){return I.isAcute(this.p0,this.p1,this.p2)}},{key:"circumcentre",value:function(){return I.circumcentre(this.p0,this.p1,this.p2)}},{key:"area3D",value:function(){return I.area3D(this.p0,this.p1,this.p2)}},{key:"centroid",value:function(){return I.centroid(this.p0,this.p1,this.p2)}},{key:"inCentre",value:function(){return I.inCentre(this.p0,this.p1,this.p2)}}],[{key:"constructor_",value:function(){this.p0=null,this.p1=null,this.p2=null;var y=arguments[0],_=arguments[1],P=arguments[2];this.p0=y,this.p1=_,this.p2=P}},{key:"area",value:function(y,_,P){return Math.abs(((P.x-y.x)*(_.y-y.y)-(_.x-y.x)*(P.y-y.y))/2)}},{key:"signedArea",value:function(y,_,P){return((P.x-y.x)*(_.y-y.y)-(_.x-y.x)*(P.y-y.y))/2}},{key:"det",value:function(y,_,P,$){return y*$-_*P}},{key:"interpolateZ",value:function(y,_,P,$){var ne=_.x,me=_.y,Oe=P.x-ne,tt=$.x-ne,ft=P.y-me,rr=$.y-me,ur=Oe*rr-tt*ft,qr=y.x-ne,bn=y.y-me,Dn=(rr*qr-tt*bn)/ur,Xn=(-ft*qr+Oe*bn)/ur;return _.getZ()+Dn*(P.getZ()-_.getZ())+Xn*($.getZ()-_.getZ())}},{key:"longestSideLength",value:function(y,_,P){var $=y.distance(_),ne=_.distance(P),me=P.distance(y),Oe=$;return ne>Oe&&(Oe=ne),me>Oe&&(Oe=me),Oe}},{key:"circumcentreDD",value:function(y,_,P){var $=xe.valueOf(y.x).subtract(P.x),ne=xe.valueOf(y.y).subtract(P.y),me=xe.valueOf(_.x).subtract(P.x),Oe=xe.valueOf(_.y).subtract(P.y),tt=xe.determinant($,ne,me,Oe).multiply(2),ft=$.sqr().add(ne.sqr()),rr=me.sqr().add(Oe.sqr()),ur=xe.determinant(ne,ft,Oe,rr),qr=xe.determinant($,ft,me,rr),bn=xe.valueOf(P.x).subtract(ur.divide(tt)).doubleValue(),Dn=xe.valueOf(P.y).add(qr.divide(tt)).doubleValue();return new Be(bn,Dn)}},{key:"isAcute",value:function(y,_,P){return!!Pa.isAcute(y,_,P)&&!!Pa.isAcute(_,P,y)&&!!Pa.isAcute(P,y,_)}},{key:"circumcentre",value:function(y,_,P){var $=P.x,ne=P.y,me=y.x-$,Oe=y.y-ne,tt=_.x-$,ft=_.y-ne,rr=2*I.det(me,Oe,tt,ft),ur=I.det(Oe,me*me+Oe*Oe,ft,tt*tt+ft*ft),qr=I.det(me,me*me+Oe*Oe,tt,tt*tt+ft*ft);return new Be($-ur/rr,ne+qr/rr)}},{key:"perpendicularBisector",value:function(y,_){var P=_.x-y.x,$=_.y-y.y,ne=new Da(y.x+P/2,y.y+$/2,1),me=new Da(y.x-$+P/2,y.y+P+$/2,1);return new Da(ne,me)}},{key:"angleBisector",value:function(y,_,P){var $=_.distance(y),ne=$/($+_.distance(P)),me=P.x-y.x,Oe=P.y-y.y;return new Be(y.x+ne*me,y.y+ne*Oe)}},{key:"area3D",value:function(y,_,P){var $=_.x-y.x,ne=_.y-y.y,me=_.getZ()-y.getZ(),Oe=P.x-y.x,tt=P.y-y.y,ft=P.getZ()-y.getZ(),rr=ne*ft-me*tt,ur=me*Oe-$*ft,qr=$*tt-ne*Oe,bn=rr*rr+ur*ur+qr*qr,Dn=Math.sqrt(bn)/2;return Dn}},{key:"centroid",value:function(y,_,P){var $=(y.x+_.x+P.x)/3,ne=(y.y+_.y+P.y)/3;return new Be($,ne)}},{key:"inCentre",value:function(y,_,P){var $=_.distance(P),ne=y.distance(P),me=y.distance(_),Oe=$+ne+me,tt=($*y.x+ne*_.x+me*P.x)/Oe,ft=($*y.y+ne*_.y+me*P.y)/Oe;return new Be(tt,ft)}}])})(),As=(function(){return o((function I(){i(this,I),I.constructor_.apply(this,arguments)}),[{key:"addRingSide",value:function(I,y,_,P,$){if(y===0&&I.length<Bn.MINIMUM_VALID_SIZE)return null;var ne=P,me=$;I.length>=Bn.MINIMUM_VALID_SIZE&&Ge.isCCW(I)&&(ne=$,me=P,_=_t.opposite(_));var Oe=this._curveBuilder.getRingCurve(I,_,y);this.addCurve(Oe,ne,me)}},{key:"addRingBothSides",value:function(I,y){this.addRingSide(I,y,_t.LEFT,be.EXTERIOR,be.INTERIOR),this.addRingSide(I,y,_t.RIGHT,be.INTERIOR,be.EXTERIOR)}},{key:"addPoint",value:function(I){if(this._distance<=0)return null;var y=I.getCoordinates(),_=this._curveBuilder.getLineCurve(y,this._distance);this.addCurve(_,be.EXTERIOR,be.INTERIOR)}},{key:"addPolygon",value:function(I){var y=this._distance,_=_t.LEFT;this._distance<0&&(y=-this._distance,_=_t.RIGHT);var P=I.getExteriorRing(),$=Wi.removeRepeatedPoints(P.getCoordinates());if(this._distance<0&&this.isErodedCompletely(P,this._distance)||this._distance<=0&&$.length<3)return null;this.addRingSide($,y,_,be.EXTERIOR,be.INTERIOR);for(var ne=0;ne<I.getNumInteriorRing();ne++){var me=I.getInteriorRingN(ne),Oe=Wi.removeRepeatedPoints(me.getCoordinates());this._distance>0&&this.isErodedCompletely(me,-this._distance)||this.addRingSide(Oe,y,_t.opposite(_),be.INTERIOR,be.EXTERIOR)}}},{key:"isTriangleErodedCompletely",value:function(I,y){var _=new ns(I[0],I[1],I[2]),P=_.inCentre();return fn.pointToSegment(P,_.p0,_.p1)<Math.abs(y)}},{key:"addLineString",value:function(I){if(this._curveBuilder.isLineOffsetEmpty(this._distance))return null;var y=Wi.removeRepeatedPoints(I.getCoordinates());if(Wi.isRing(y)&&!this._curveBuilder.getBufferParameters().isSingleSided())this.addRingBothSides(y,this._distance);else{var _=this._curveBuilder.getLineCurve(y,this._distance);this.addCurve(_,be.EXTERIOR,be.INTERIOR)}}},{key:"addCurve",value:function(I,y,_){if(I===null||I.length<2)return null;var P=new Ui(I,new $n(0,be.BOUNDARY,y,_));this._curveList.add(P)}},{key:"getCurves",value:function(){return this.add(this._inputGeom),this._curveList}},{key:"add",value:function(I){if(I.isEmpty())return null;if(I instanceof Xr)this.addPolygon(I);else if(I instanceof Kn)this.addLineString(I);else if(I instanceof He)this.addPoint(I);else if(I instanceof Mn)this.addCollection(I);else if(I instanceof ds)this.addCollection(I);else if(I instanceof xi)this.addCollection(I);else{if(!(I instanceof Fr))throw new $e(I.getGeometryType());this.addCollection(I)}}},{key:"isErodedCompletely",value:function(I,y){var _=I.getCoordinates();if(_.length<4)return y<0;if(_.length===4)return this.isTriangleErodedCompletely(_,y);var P=I.getEnvelopeInternal(),$=Math.min(P.getHeight(),P.getWidth());return y<0&&2*Math.abs(y)>$}},{key:"addCollection",value:function(I){for(var y=0;y<I.getNumGeometries();y++){var _=I.getGeometryN(y);this.add(_)}}}],[{key:"constructor_",value:function(){this._inputGeom=null,this._distance=null,this._curveBuilder=null,this._curveList=new ct;var I=arguments[0],y=arguments[1],_=arguments[2];this._inputGeom=I,this._distance=y,this._curveBuilder=_}}])})(),Ja=(function(){return o((function I(){i(this,I)}),[{key:"locate",value:function(I){}}])})(),rc=(function(){function I(){i(this,I),I.constructor_.apply(this,arguments)}return o(I,[{key:"next",value:function(){if(this._atStart)return this._atStart=!1,I.isAtomic(this._parent)&&this._index++,this._parent;if(this._subcollectionIterator!==null){if(this._subcollectionIterator.hasNext())return this._subcollectionIterator.next();this._subcollectionIterator=null}if(this._index>=this._max)throw new at;var y=this._parent.getGeometryN(this._index++);return y instanceof Fr?(this._subcollectionIterator=new I(y),this._subcollectionIterator.next()):y}},{key:"remove",value:function(){throw new $e(this.getClass().getName())}},{key:"hasNext",value:function(){if(this._atStart)return!0;if(this._subcollectionIterator!==null){if(this._subcollectionIterator.hasNext())return!0;this._subcollectionIterator=null}return!(this._index>=this._max)}},{key:"interfaces_",get:function(){return[Ln]}}],[{key:"constructor_",value:function(){this._parent=null,this._atStart=null,this._max=null,this._index=null,this._subcollectionIterator=null;var y=arguments[0];this._parent=y,this._atStart=!0,this._index=0,this._max=y.getNumGeometries()}},{key:"isAtomic",value:function(y){return!(y instanceof Fr)}}])})(),uu=(function(){function I(){i(this,I),I.constructor_.apply(this,arguments)}return o(I,[{key:"locate",value:function(y){return I.locate(y,this._geom)}},{key:"interfaces_",get:function(){return[Ja]}}],[{key:"constructor_",value:function(){this._geom=null;var y=arguments[0];this._geom=y}},{key:"locatePointInPolygon",value:function(y,_){if(_.isEmpty())return be.EXTERIOR;var P=_.getExteriorRing(),$=I.locatePointInRing(y,P);if($!==be.INTERIOR)return $;for(var ne=0;ne<_.getNumInteriorRing();ne++){var me=_.getInteriorRingN(ne),Oe=I.locatePointInRing(y,me);if(Oe===be.BOUNDARY)return be.BOUNDARY;if(Oe===be.INTERIOR)return be.EXTERIOR}return be.INTERIOR}},{key:"locatePointInRing",value:function(y,_){return _.getEnvelopeInternal().intersects(y)?ti.locateInRing(y,_.getCoordinates()):be.EXTERIOR}},{key:"containsPointInPolygon",value:function(y,_){return be.EXTERIOR!==I.locatePointInPolygon(y,_)}},{key:"locateInGeometry",value:function(y,_){if(_ instanceof Xr)return I.locatePointInPolygon(y,_);if(_ instanceof Fr)for(var P=new rc(_);P.hasNext();){var $=P.next();if($!==_){var ne=I.locateInGeometry(y,$);if(ne!==be.EXTERIOR)return ne}}return be.EXTERIOR}},{key:"isContained",value:function(y,_){return be.EXTERIOR!==I.locate(y,_)}},{key:"locate",value:function(y,_){return _.isEmpty()?be.EXTERIOR:_.getEnvelopeInternal().intersects(y)?I.locateInGeometry(y,_):be.EXTERIOR}}])})(),Ys=(function(){return o((function I(){i(this,I),I.constructor_.apply(this,arguments)}),[{key:"getNextCW",value:function(I){this.getEdges();var y=this._edgeList.indexOf(I),_=y-1;return y===0&&(_=this._edgeList.size()-1),this._edgeList.get(_)}},{key:"propagateSideLabels",value:function(I){for(var y=be.NONE,_=this.iterator();_.hasNext();){var P=_.next().getLabel();P.isArea(I)&&P.getLocation(I,_t.LEFT)!==be.NONE&&(y=P.getLocation(I,_t.LEFT))}if(y===be.NONE)return null;for(var $=y,ne=this.iterator();ne.hasNext();){var me=ne.next(),Oe=me.getLabel();if(Oe.getLocation(I,_t.ON)===be.NONE&&Oe.setLocation(I,_t.ON,$),Oe.isArea(I)){var tt=Oe.getLocation(I,_t.LEFT),ft=Oe.getLocation(I,_t.RIGHT);if(ft!==be.NONE){if(ft!==$)throw new Et("side location conflict",me.getCoordinate());tt===be.NONE&&we.shouldNeverReachHere("found single null side (at "+me.getCoordinate()+")"),$=tt}else we.isTrue(Oe.getLocation(I,_t.LEFT)===be.NONE,"found single null side"),Oe.setLocation(I,_t.RIGHT,$),Oe.setLocation(I,_t.LEFT,$)}}}},{key:"getCoordinate",value:function(){var I=this.iterator();return I.hasNext()?I.next().getCoordinate():null}},{key:"print",value:function(I){Ar.out.println("EdgeEndStar:   "+this.getCoordinate());for(var y=this.iterator();y.hasNext();)y.next().print(I)}},{key:"isAreaLabelsConsistent",value:function(I){return this.computeEdgeEndLabels(I.getBoundaryNodeRule()),this.checkAreaLabelsConsistent(0)}},{key:"checkAreaLabelsConsistent",value:function(I){var y=this.getEdges();if(y.size()<=0)return!0;var _=y.size()-1,P=y.get(_).getLabel().getLocation(I,_t.LEFT);we.isTrue(P!==be.NONE,"Found unlabelled area edge");for(var $=P,ne=this.iterator();ne.hasNext();){var me=ne.next().getLabel();we.isTrue(me.isArea(I),"Found non-area edge");var Oe=me.getLocation(I,_t.LEFT),tt=me.getLocation(I,_t.RIGHT);if(Oe===tt||tt!==$)return!1;$=Oe}return!0}},{key:"findIndex",value:function(I){this.iterator();for(var y=0;y<this._edgeList.size();y++)if(this._edgeList.get(y)===I)return y;return-1}},{key:"iterator",value:function(){return this.getEdges().iterator()}},{key:"getEdges",value:function(){return this._edgeList===null&&(this._edgeList=new ct(this._edgeMap.values())),this._edgeList}},{key:"getLocation",value:function(I,y,_){return this._ptInAreaLocation[I]===be.NONE&&(this._ptInAreaLocation[I]=uu.locate(y,_[I].getGeometry())),this._ptInAreaLocation[I]}},{key:"toString",value:function(){var I=new Jt;I.append("EdgeEndStar:   "+this.getCoordinate()),I.append(`
`);for(var y=this.iterator();y.hasNext();){var _=y.next();I.append(_),I.append(`
`)}return I.toString()}},{key:"computeEdgeEndLabels",value:function(I){for(var y=this.iterator();y.hasNext();)y.next().computeLabel(I)}},{key:"computeLabelling",value:function(I){this.computeEdgeEndLabels(I[0].getBoundaryNodeRule()),this.propagateSideLabels(0),this.propagateSideLabels(1);for(var y=[!1,!1],_=this.iterator();_.hasNext();)for(var P=_.next().getLabel(),$=0;$<2;$++)P.isLine($)&&P.getLocation($)===be.BOUNDARY&&(y[$]=!0);for(var ne=this.iterator();ne.hasNext();)for(var me=ne.next(),Oe=me.getLabel(),tt=0;tt<2;tt++)if(Oe.isAnyNull(tt)){var ft=be.NONE;if(y[tt])ft=be.EXTERIOR;else{var rr=me.getCoordinate();ft=this.getLocation(tt,rr,I)}Oe.setAllLocationsIfNull(tt,ft)}}},{key:"getDegree",value:function(){return this._edgeMap.size()}},{key:"insertEdgeEnd",value:function(I,y){this._edgeMap.put(I,y),this._edgeList=null}}],[{key:"constructor_",value:function(){this._edgeMap=new Mi,this._edgeList=null,this._ptInAreaLocation=[be.NONE,be.NONE]}}])})(),ja=(function(I){function y(){var _;return i(this,y),_=n(this,y),y.constructor_.apply(_,arguments),_}return m(y,I),o(y,[{key:"linkResultDirectedEdges",value:function(){this.getResultAreaEdges();for(var _=null,P=null,$=this._SCANNING_FOR_INCOMING,ne=0;ne<this._resultAreaEdgeList.size();ne++){var me=this._resultAreaEdgeList.get(ne),Oe=me.getSym();if(me.getLabel().isArea())switch(_===null&&me.isInResult()&&(_=me),$){case this._SCANNING_FOR_INCOMING:if(!Oe.isInResult())continue;P=Oe,$=this._LINKING_TO_OUTGOING;break;case this._LINKING_TO_OUTGOING:if(!me.isInResult())continue;P.setNext(me),$=this._SCANNING_FOR_INCOMING}}if($===this._LINKING_TO_OUTGOING){if(_===null)throw new Et("no outgoing dirEdge found",this.getCoordinate());we.isTrue(_.isInResult(),"unable to link last incoming dirEdge"),P.setNext(_)}}},{key:"insert",value:function(_){var P=_;this.insertEdgeEnd(P,P)}},{key:"getRightmostEdge",value:function(){var _=this.getEdges(),P=_.size();if(P<1)return null;var $=_.get(0);if(P===1)return $;var ne=_.get(P-1),me=$.getQuadrant(),Oe=ne.getQuadrant();return oa.isNorthern(me)&&oa.isNorthern(Oe)?$:oa.isNorthern(me)||oa.isNorthern(Oe)?$.getDy()!==0?$:ne.getDy()!==0?ne:(we.shouldNeverReachHere("found two horizontal edges incident on node"),null):ne}},{key:"print",value:function(_){Ar.out.println("DirectedEdgeStar: "+this.getCoordinate());for(var P=this.iterator();P.hasNext();){var $=P.next();_.print("out "),$.print(_),_.println(),_.print("in "),$.getSym().print(_),_.println()}}},{key:"getResultAreaEdges",value:function(){if(this._resultAreaEdgeList!==null)return this._resultAreaEdgeList;this._resultAreaEdgeList=new ct;for(var _=this.iterator();_.hasNext();){var P=_.next();(P.isInResult()||P.getSym().isInResult())&&this._resultAreaEdgeList.add(P)}return this._resultAreaEdgeList}},{key:"updateLabelling",value:function(_){for(var P=this.iterator();P.hasNext();){var $=P.next().getLabel();$.setAllLocationsIfNull(0,_.getLocation(0)),$.setAllLocationsIfNull(1,_.getLocation(1))}}},{key:"linkAllDirectedEdges",value:function(){this.getEdges();for(var _=null,P=null,$=this._edgeList.size()-1;$>=0;$--){var ne=this._edgeList.get($),me=ne.getSym();P===null&&(P=me),_!==null&&me.setNext(_),_=ne}P.setNext(_)}},{key:"computeDepths",value:function(){if(arguments.length===1){var _=arguments[0],P=this.findIndex(_),$=_.getDepth(_t.LEFT),ne=_.getDepth(_t.RIGHT),me=this.computeDepths(P+1,this._edgeList.size(),$);if(this.computeDepths(0,P,me)!==ne)throw new Et("depth mismatch at "+_.getCoordinate())}else if(arguments.length===3){for(var Oe=arguments[1],tt=arguments[2],ft=arguments[0];ft<Oe;ft++){var rr=this._edgeList.get(ft);rr.setEdgeDepths(_t.RIGHT,tt),tt=rr.getDepth(_t.LEFT)}return tt}}},{key:"mergeSymLabels",value:function(){for(var _=this.iterator();_.hasNext();){var P=_.next();P.getLabel().merge(P.getSym().getLabel())}}},{key:"linkMinimalDirectedEdges",value:function(_){for(var P=null,$=null,ne=this._SCANNING_FOR_INCOMING,me=this._resultAreaEdgeList.size()-1;me>=0;me--){var Oe=this._resultAreaEdgeList.get(me),tt=Oe.getSym();switch(P===null&&Oe.getEdgeRing()===_&&(P=Oe),ne){case this._SCANNING_FOR_INCOMING:if(tt.getEdgeRing()!==_)continue;$=tt,ne=this._LINKING_TO_OUTGOING;break;case this._LINKING_TO_OUTGOING:if(Oe.getEdgeRing()!==_)continue;$.setNextMin(Oe),ne=this._SCANNING_FOR_INCOMING}}ne===this._LINKING_TO_OUTGOING&&(we.isTrue(P!==null,"found null for first outgoing dirEdge"),we.isTrue(P.getEdgeRing()===_,"unable to link last incoming dirEdge"),$.setNextMin(P))}},{key:"getOutgoingDegree",value:function(){if(arguments.length===0){for(var _=0,P=this.iterator();P.hasNext();)P.next().isInResult()&&_++;return _}if(arguments.length===1){for(var $=arguments[0],ne=0,me=this.iterator();me.hasNext();)me.next().getEdgeRing()===$&&ne++;return ne}}},{key:"getLabel",value:function(){return this._label}},{key:"findCoveredLineEdges",value:function(){for(var _=be.NONE,P=this.iterator();P.hasNext();){var $=P.next(),ne=$.getSym();if(!$.isLineEdge()){if($.isInResult()){_=be.INTERIOR;break}if(ne.isInResult()){_=be.EXTERIOR;break}}}if(_===be.NONE)return null;for(var me=_,Oe=this.iterator();Oe.hasNext();){var tt=Oe.next(),ft=tt.getSym();tt.isLineEdge()?tt.getEdge().setCovered(me===be.INTERIOR):(tt.isInResult()&&(me=be.EXTERIOR),ft.isInResult()&&(me=be.INTERIOR))}}},{key:"computeLabelling",value:function(_){E(y,"computeLabelling",this,1).call(this,_),this._label=new $n(be.NONE);for(var P=this.iterator();P.hasNext();)for(var $=P.next().getEdge().getLabel(),ne=0;ne<2;ne++){var me=$.getLocation(ne);me!==be.INTERIOR&&me!==be.BOUNDARY||this._label.setLocation(ne,be.INTERIOR)}}}],[{key:"constructor_",value:function(){this._resultAreaEdgeList=null,this._label=null,this._SCANNING_FOR_INCOMING=1,this._LINKING_TO_OUTGOING=2}}])})(Ys),Is=(function(I){function y(){return i(this,y),n(this,y)}return m(y,I),o(y,[{key:"createNode",value:function(_){return new fi(_,new ja)}}])})($s),nc=(function(){function I(){i(this,I),I.constructor_.apply(this,arguments)}return o(I,[{key:"compareTo",value:function(y){var _=y;return I.compareOriented(this._pts,this._orientation,_._pts,_._orientation)}},{key:"interfaces_",get:function(){return[H]}}],[{key:"constructor_",value:function(){this._pts=null,this._orientation=null;var y=arguments[0];this._pts=y,this._orientation=I.orientation(y)}},{key:"orientation",value:function(y){return Wi.increasingDirection(y)===1}},{key:"compareOriented",value:function(y,_,P,$){for(var ne=_?1:-1,me=$?1:-1,Oe=_?y.length:-1,tt=$?P.length:-1,ft=_?0:y.length-1,rr=$?0:P.length-1;;){var ur=y[ft].compareTo(P[rr]);if(ur!==0)return ur;var qr=(ft+=ne)===Oe,bn=(rr+=me)===tt;if(qr&&!bn)return-1;if(!qr&&bn)return 1;if(qr&&bn)return 0}}}])})(),ic=(function(){return o((function I(){i(this,I),I.constructor_.apply(this,arguments)}),[{key:"print",value:function(I){I.print("MULTILINESTRING ( ");for(var y=0;y<this._edges.size();y++){var _=this._edges.get(y);y>0&&I.print(","),I.print("(");for(var P=_.getCoordinates(),$=0;$<P.length;$++)$>0&&I.print(","),I.print(P[$].x+" "+P[$].y);I.println(")")}I.print(")  ")}},{key:"addAll",value:function(I){for(var y=I.iterator();y.hasNext();)this.add(y.next())}},{key:"findEdgeIndex",value:function(I){for(var y=0;y<this._edges.size();y++)if(this._edges.get(y).equals(I))return y;return-1}},{key:"iterator",value:function(){return this._edges.iterator()}},{key:"getEdges",value:function(){return this._edges}},{key:"get",value:function(I){return this._edges.get(I)}},{key:"findEqualEdge",value:function(I){var y=new nc(I.getCoordinates());return this._ocaMap.get(y)}},{key:"add",value:function(I){this._edges.add(I);var y=new nc(I.getCoordinates());this._ocaMap.put(y,I)}}],[{key:"constructor_",value:function(){this._edges=new ct,this._ocaMap=new Mi}}])})(),ul=(function(){return o((function I(){i(this,I)}),[{key:"processIntersections",value:function(I,y,_,P){}},{key:"isDone",value:function(){}}])})(),cu=(function(){function I(){i(this,I),I.constructor_.apply(this,arguments)}return o(I,[{key:"isTrivialIntersection",value:function(y,_,P,$){if(y===P&&this._li.getIntersectionNum()===1){if(I.isAdjacentSegments(_,$))return!0;if(y.isClosed()){var ne=y.size()-1;if(_===0&&$===ne||$===0&&_===ne)return!0}}return!1}},{key:"getProperIntersectionPoint",value:function(){return this._properIntersectionPoint}},{key:"hasProperInteriorIntersection",value:function(){return this._hasProperInterior}},{key:"getLineIntersector",value:function(){return this._li}},{key:"hasProperIntersection",value:function(){return this._hasProper}},{key:"processIntersections",value:function(y,_,P,$){if(y===P&&_===$)return null;this.numTests++;var ne=y.getCoordinates()[_],me=y.getCoordinates()[_+1],Oe=P.getCoordinates()[$],tt=P.getCoordinates()[$+1];this._li.computeIntersection(ne,me,Oe,tt),this._li.hasIntersection()&&(this.numIntersections++,this._li.isInteriorIntersection()&&(this.numInteriorIntersections++,this._hasInterior=!0),this.isTrivialIntersection(y,_,P,$)||(this._hasIntersection=!0,y.addIntersections(this._li,_,0),P.addIntersections(this._li,$,1),this._li.isProper()&&(this.numProperIntersections++,this._hasProper=!0,this._hasProperInterior=!0)))}},{key:"hasIntersection",value:function(){return this._hasIntersection}},{key:"isDone",value:function(){return!1}},{key:"hasInteriorIntersection",value:function(){return this._hasInterior}},{key:"interfaces_",get:function(){return[ul]}}],[{key:"constructor_",value:function(){this._hasIntersection=!1,this._hasProper=!1,this._hasProperInterior=!1,this._hasInterior=!1,this._properIntersectionPoint=null,this._li=null,this._isSelfIntersection=null,this.numIntersections=0,this.numInteriorIntersections=0,this.numProperIntersections=0,this.numTests=0;var y=arguments[0];this._li=y}},{key:"isAdjacentSegments",value:function(y,_){return Math.abs(y-_)===1}}])})(),Oo=(function(){return o((function I(){i(this,I),I.constructor_.apply(this,arguments)}),[{key:"getSegmentIndex",value:function(){return this.segmentIndex}},{key:"getCoordinate",value:function(){return this.coord}},{key:"print",value:function(I){I.print(this.coord),I.print(" seg # = "+this.segmentIndex),I.println(" dist = "+this.dist)}},{key:"compareTo",value:function(I){var y=I;return this.compare(y.segmentIndex,y.dist)}},{key:"isEndPoint",value:function(I){return this.segmentIndex===0&&this.dist===0||this.segmentIndex===I}},{key:"toString",value:function(){return this.coord+" seg # = "+this.segmentIndex+" dist = "+this.dist}},{key:"getDistance",value:function(){return this.dist}},{key:"compare",value:function(I,y){return this.segmentIndex<I?-1:this.segmentIndex>I?1:this.dist<y?-1:this.dist>y?1:0}},{key:"interfaces_",get:function(){return[H]}}],[{key:"constructor_",value:function(){this.coord=null,this.segmentIndex=null,this.dist=null;var I=arguments[0],y=arguments[1],_=arguments[2];this.coord=new Be(I),this.segmentIndex=y,this.dist=_}}])})(),mo=(function(){return o((function I(){i(this,I),I.constructor_.apply(this,arguments)}),[{key:"print",value:function(I){I.println("Intersections:");for(var y=this.iterator();y.hasNext();)y.next().print(I)}},{key:"iterator",value:function(){return this._nodeMap.values().iterator()}},{key:"addSplitEdges",value:function(I){this.addEndpoints();for(var y=this.iterator(),_=y.next();y.hasNext();){var P=y.next(),$=this.createSplitEdge(_,P);I.add($),_=P}}},{key:"addEndpoints",value:function(){var I=this.edge.pts.length-1;this.add(this.edge.pts[0],0,0),this.add(this.edge.pts[I],I,0)}},{key:"createSplitEdge",value:function(I,y){var _=y.segmentIndex-I.segmentIndex+2,P=this.edge.pts[y.segmentIndex],$=y.dist>0||!y.coord.equals2D(P);$||_--;var ne=new Array(_).fill(null),me=0;ne[me++]=new Be(I.coord);for(var Oe=I.segmentIndex+1;Oe<=y.segmentIndex;Oe++)ne[me++]=this.edge.pts[Oe];return $&&(ne[me]=y.coord),new Va(ne,new $n(this.edge._label))}},{key:"add",value:function(I,y,_){var P=new Oo(I,y,_),$=this._nodeMap.get(P);return $!==null?$:(this._nodeMap.put(P,P),P)}},{key:"isIntersection",value:function(I){for(var y=this.iterator();y.hasNext();)if(y.next().coord.equals(I))return!0;return!1}}],[{key:"constructor_",value:function(){this._nodeMap=new Mi,this.edge=null;var I=arguments[0];this.edge=I}}])})(),Du=(function(){function I(){i(this,I),I.constructor_.apply(this,arguments)}return o(I,[{key:"isIntersects",value:function(){return!this.isDisjoint()}},{key:"isCovers",value:function(){return(I.isTrue(this._matrix[be.INTERIOR][be.INTERIOR])||I.isTrue(this._matrix[be.INTERIOR][be.BOUNDARY])||I.isTrue(this._matrix[be.BOUNDARY][be.INTERIOR])||I.isTrue(this._matrix[be.BOUNDARY][be.BOUNDARY]))&&this._matrix[be.EXTERIOR][be.INTERIOR]===nr.FALSE&&this._matrix[be.EXTERIOR][be.BOUNDARY]===nr.FALSE}},{key:"isCoveredBy",value:function(){return(I.isTrue(this._matrix[be.INTERIOR][be.INTERIOR])||I.isTrue(this._matrix[be.INTERIOR][be.BOUNDARY])||I.isTrue(this._matrix[be.BOUNDARY][be.INTERIOR])||I.isTrue(this._matrix[be.BOUNDARY][be.BOUNDARY]))&&this._matrix[be.INTERIOR][be.EXTERIOR]===nr.FALSE&&this._matrix[be.BOUNDARY][be.EXTERIOR]===nr.FALSE}},{key:"set",value:function(){if(arguments.length===1)for(var y=arguments[0],_=0;_<y.length;_++){var P=Math.trunc(_/3),$=_%3;this._matrix[P][$]=nr.toDimensionValue(y.charAt(_))}else if(arguments.length===3){var ne=arguments[0],me=arguments[1],Oe=arguments[2];this._matrix[ne][me]=Oe}}},{key:"isContains",value:function(){return I.isTrue(this._matrix[be.INTERIOR][be.INTERIOR])&&this._matrix[be.EXTERIOR][be.INTERIOR]===nr.FALSE&&this._matrix[be.EXTERIOR][be.BOUNDARY]===nr.FALSE}},{key:"setAtLeast",value:function(){if(arguments.length===1)for(var y=arguments[0],_=0;_<y.length;_++){var P=Math.trunc(_/3),$=_%3;this.setAtLeast(P,$,nr.toDimensionValue(y.charAt(_)))}else if(arguments.length===3){var ne=arguments[0],me=arguments[1],Oe=arguments[2];this._matrix[ne][me]<Oe&&(this._matrix[ne][me]=Oe)}}},{key:"setAtLeastIfValid",value:function(y,_,P){y>=0&&_>=0&&this.setAtLeast(y,_,P)}},{key:"isWithin",value:function(){return I.isTrue(this._matrix[be.INTERIOR][be.INTERIOR])&&this._matrix[be.INTERIOR][be.EXTERIOR]===nr.FALSE&&this._matrix[be.BOUNDARY][be.EXTERIOR]===nr.FALSE}},{key:"isTouches",value:function(y,_){return y>_?this.isTouches(_,y):(y===nr.A&&_===nr.A||y===nr.L&&_===nr.L||y===nr.L&&_===nr.A||y===nr.P&&_===nr.A||y===nr.P&&_===nr.L)&&this._matrix[be.INTERIOR][be.INTERIOR]===nr.FALSE&&(I.isTrue(this._matrix[be.INTERIOR][be.BOUNDARY])||I.isTrue(this._matrix[be.BOUNDARY][be.INTERIOR])||I.isTrue(this._matrix[be.BOUNDARY][be.BOUNDARY]))}},{key:"isOverlaps",value:function(y,_){return y===nr.P&&_===nr.P||y===nr.A&&_===nr.A?I.isTrue(this._matrix[be.INTERIOR][be.INTERIOR])&&I.isTrue(this._matrix[be.INTERIOR][be.EXTERIOR])&&I.isTrue(this._matrix[be.EXTERIOR][be.INTERIOR]):y===nr.L&&_===nr.L&&this._matrix[be.INTERIOR][be.INTERIOR]===1&&I.isTrue(this._matrix[be.INTERIOR][be.EXTERIOR])&&I.isTrue(this._matrix[be.EXTERIOR][be.INTERIOR])}},{key:"isEquals",value:function(y,_){return y===_&&I.isTrue(this._matrix[be.INTERIOR][be.INTERIOR])&&this._matrix[be.INTERIOR][be.EXTERIOR]===nr.FALSE&&this._matrix[be.BOUNDARY][be.EXTERIOR]===nr.FALSE&&this._matrix[be.EXTERIOR][be.INTERIOR]===nr.FALSE&&this._matrix[be.EXTERIOR][be.BOUNDARY]===nr.FALSE}},{key:"toString",value:function(){for(var y=new Mo("123456789"),_=0;_<3;_++)for(var P=0;P<3;P++)y.setCharAt(3*_+P,nr.toDimensionSymbol(this._matrix[_][P]));return y.toString()}},{key:"setAll",value:function(y){for(var _=0;_<3;_++)for(var P=0;P<3;P++)this._matrix[_][P]=y}},{key:"get",value:function(y,_){return this._matrix[y][_]}},{key:"transpose",value:function(){var y=this._matrix[1][0];return this._matrix[1][0]=this._matrix[0][1],this._matrix[0][1]=y,y=this._matrix[2][0],this._matrix[2][0]=this._matrix[0][2],this._matrix[0][2]=y,y=this._matrix[2][1],this._matrix[2][1]=this._matrix[1][2],this._matrix[1][2]=y,this}},{key:"matches",value:function(y){if(y.length!==9)throw new U("Should be length 9: "+y);for(var _=0;_<3;_++)for(var P=0;P<3;P++)if(!I.matches(this._matrix[_][P],y.charAt(3*_+P)))return!1;return!0}},{key:"add",value:function(y){for(var _=0;_<3;_++)for(var P=0;P<3;P++)this.setAtLeast(_,P,y.get(_,P))}},{key:"isDisjoint",value:function(){return this._matrix[be.INTERIOR][be.INTERIOR]===nr.FALSE&&this._matrix[be.INTERIOR][be.BOUNDARY]===nr.FALSE&&this._matrix[be.BOUNDARY][be.INTERIOR]===nr.FALSE&&this._matrix[be.BOUNDARY][be.BOUNDARY]===nr.FALSE}},{key:"isCrosses",value:function(y,_){return y===nr.P&&_===nr.L||y===nr.P&&_===nr.A||y===nr.L&&_===nr.A?I.isTrue(this._matrix[be.INTERIOR][be.INTERIOR])&&I.isTrue(this._matrix[be.INTERIOR][be.EXTERIOR]):y===nr.L&&_===nr.P||y===nr.A&&_===nr.P||y===nr.A&&_===nr.L?I.isTrue(this._matrix[be.INTERIOR][be.INTERIOR])&&I.isTrue(this._matrix[be.EXTERIOR][be.INTERIOR]):y===nr.L&&_===nr.L&&this._matrix[be.INTERIOR][be.INTERIOR]===0}},{key:"interfaces_",get:function(){return[W]}}],[{key:"constructor_",value:function(){if(this._matrix=null,arguments.length===0)this._matrix=Array(3).fill().map((function(){return Array(3)})),this.setAll(nr.FALSE);else if(arguments.length===1){if(typeof arguments[0]=="string"){var y=arguments[0];I.constructor_.call(this),this.set(y)}else if(arguments[0]instanceof I){var _=arguments[0];I.constructor_.call(this),this._matrix[be.INTERIOR][be.INTERIOR]=_._matrix[be.INTERIOR][be.INTERIOR],this._matrix[be.INTERIOR][be.BOUNDARY]=_._matrix[be.INTERIOR][be.BOUNDARY],this._matrix[be.INTERIOR][be.EXTERIOR]=_._matrix[be.INTERIOR][be.EXTERIOR],this._matrix[be.BOUNDARY][be.INTERIOR]=_._matrix[be.BOUNDARY][be.INTERIOR],this._matrix[be.BOUNDARY][be.BOUNDARY]=_._matrix[be.BOUNDARY][be.BOUNDARY],this._matrix[be.BOUNDARY][be.EXTERIOR]=_._matrix[be.BOUNDARY][be.EXTERIOR],this._matrix[be.EXTERIOR][be.INTERIOR]=_._matrix[be.EXTERIOR][be.INTERIOR],this._matrix[be.EXTERIOR][be.BOUNDARY]=_._matrix[be.EXTERIOR][be.BOUNDARY],this._matrix[be.EXTERIOR][be.EXTERIOR]=_._matrix[be.EXTERIOR][be.EXTERIOR]}}}},{key:"matches",value:function(){if(Number.isInteger(arguments[0])&&typeof arguments[1]=="string"){var y=arguments[0],_=arguments[1];return _===nr.SYM_DONTCARE||_===nr.SYM_TRUE&&(y>=0||y===nr.TRUE)||_===nr.SYM_FALSE&&y===nr.FALSE||_===nr.SYM_P&&y===nr.P||_===nr.SYM_L&&y===nr.L||_===nr.SYM_A&&y===nr.A}if(typeof arguments[0]=="string"&&typeof arguments[1]=="string"){var P=arguments[1];return new I(arguments[0]).matches(P)}}},{key:"isTrue",value:function(y){return y>=0||y===nr.TRUE}}])})(),Ua=(function(){function I(){i(this,I),I.constructor_.apply(this,arguments)}return o(I,[{key:"size",value:function(){return this._size}},{key:"addAll",value:function(y){return y===null||y.length===0?null:(this.ensureCapacity(this._size+y.length),Ar.arraycopy(y,0,this._data,this._size,y.length),void(this._size+=y.length))}},{key:"ensureCapacity",value:function(y){if(y<=this._data.length)return null;var _=Math.max(y,2*this._data.length);this._data=Gt.copyOf(this._data,_)}},{key:"toArray",value:function(){var y=new Array(this._size).fill(null);return Ar.arraycopy(this._data,0,y,0,this._size),y}},{key:"add",value:function(y){this.ensureCapacity(this._size+1),this._data[this._size]=y,++this._size}}],[{key:"constructor_",value:function(){if(this._data=null,this._size=0,arguments.length===0)I.constructor_.call(this,10);else if(arguments.length===1){var y=arguments[0];this._data=new Array(y).fill(null)}}}])})(),fu=(function(){function I(){i(this,I)}return o(I,[{key:"getChainStartIndices",value:function(y){var _=0,P=new Ua(Math.trunc(y.length/2));P.add(_);do{var $=this.findChainEnd(y,_);P.add($),_=$}while(_<y.length-1);return P.toArray()}},{key:"findChainEnd",value:function(y,_){for(var P=oa.quadrant(y[_],y[_+1]),$=_+1;$<y.length&&oa.quadrant(y[$-1],y[$])===P;)$++;return $-1}},{key:"OLDgetChainStartIndices",value:function(y){var _=0,P=new ct;P.add(_);do{var $=this.findChainEnd(y,_);P.add($),_=$}while(_<y.length-1);return I.toIntArray(P)}}],[{key:"toIntArray",value:function(y){for(var _=new Array(y.size()).fill(null),P=0;P<_.length;P++)_[P]=y.get(P).intValue();return _}}])})(),Zs=(function(){return o((function I(){i(this,I),I.constructor_.apply(this,arguments)}),[{key:"getCoordinates",value:function(){return this.pts}},{key:"getMaxX",value:function(I){var y=this.pts[this.startIndex[I]].x,_=this.pts[this.startIndex[I+1]].x;return y>_?y:_}},{key:"getMinX",value:function(I){var y=this.pts[this.startIndex[I]].x,_=this.pts[this.startIndex[I+1]].x;return y<_?y:_}},{key:"computeIntersectsForChain",value:function(){if(arguments.length===4){var I=arguments[0],y=arguments[1],_=arguments[2],P=arguments[3];this.computeIntersectsForChain(this.startIndex[I],this.startIndex[I+1],y,y.startIndex[_],y.startIndex[_+1],P)}else if(arguments.length===6){var $=arguments[0],ne=arguments[1],me=arguments[2],Oe=arguments[3],tt=arguments[4],ft=arguments[5];if(ne-$==1&&tt-Oe==1)return ft.addIntersections(this.e,$,me.e,Oe),null;if(!this.overlaps($,ne,me,Oe,tt))return null;var rr=Math.trunc(($+ne)/2),ur=Math.trunc((Oe+tt)/2);$<rr&&(Oe<ur&&this.computeIntersectsForChain($,rr,me,Oe,ur,ft),ur<tt&&this.computeIntersectsForChain($,rr,me,ur,tt,ft)),rr<ne&&(Oe<ur&&this.computeIntersectsForChain(rr,ne,me,Oe,ur,ft),ur<tt&&this.computeIntersectsForChain(rr,ne,me,ur,tt,ft))}}},{key:"overlaps",value:function(I,y,_,P,$){return Qe.intersects(this.pts[I],this.pts[y],_.pts[P],_.pts[$])}},{key:"getStartIndexes",value:function(){return this.startIndex}},{key:"computeIntersects",value:function(I,y){for(var _=0;_<this.startIndex.length-1;_++)for(var P=0;P<I.startIndex.length-1;P++)this.computeIntersectsForChain(_,I,P,y)}}],[{key:"constructor_",value:function(){this.e=null,this.pts=null,this.startIndex=null;var I=arguments[0];this.e=I,this.pts=I.getCoordinates();var y=new fu;this.startIndex=y.getChainStartIndices(this.pts)}}])})(),ms=(function(){function I(){i(this,I),I.constructor_.apply(this,arguments)}return o(I,[{key:"getDepth",value:function(y,_){return this._depth[y][_]}},{key:"setDepth",value:function(y,_,P){this._depth[y][_]=P}},{key:"isNull",value:function(){if(arguments.length===0){for(var y=0;y<2;y++)for(var _=0;_<3;_++)if(this._depth[y][_]!==I.NULL_VALUE)return!1;return!0}if(arguments.length===1){var P=arguments[0];return this._depth[P][1]===I.NULL_VALUE}if(arguments.length===2){var $=arguments[0],ne=arguments[1];return this._depth[$][ne]===I.NULL_VALUE}}},{key:"normalize",value:function(){for(var y=0;y<2;y++)if(!this.isNull(y)){var _=this._depth[y][1];this._depth[y][2]<_&&(_=this._depth[y][2]),_<0&&(_=0);for(var P=1;P<3;P++){var $=0;this._depth[y][P]>_&&($=1),this._depth[y][P]=$}}}},{key:"getDelta",value:function(y){return this._depth[y][_t.RIGHT]-this._depth[y][_t.LEFT]}},{key:"getLocation",value:function(y,_){return this._depth[y][_]<=0?be.EXTERIOR:be.INTERIOR}},{key:"toString",value:function(){return"A: "+this._depth[0][1]+","+this._depth[0][2]+" B: "+this._depth[1][1]+","+this._depth[1][2]}},{key:"add",value:function(){if(arguments.length===1)for(var y=arguments[0],_=0;_<2;_++)for(var P=1;P<3;P++){var $=y.getLocation(_,P);$!==be.EXTERIOR&&$!==be.INTERIOR||(this.isNull(_,P)?this._depth[_][P]=I.depthAtLocation($):this._depth[_][P]+=I.depthAtLocation($))}else if(arguments.length===3){var ne=arguments[0],me=arguments[1];arguments[2]===be.INTERIOR&&this._depth[ne][me]++}}}],[{key:"constructor_",value:function(){this._depth=Array(2).fill().map((function(){return Array(3)}));for(var y=0;y<2;y++)for(var _=0;_<3;_++)this._depth[y][_]=I.NULL_VALUE}},{key:"depthAtLocation",value:function(y){return y===be.EXTERIOR?0:y===be.INTERIOR?1:I.NULL_VALUE}}])})();ms.NULL_VALUE=-1;var Va=(function(I){function y(){var _;return i(this,y),_=n(this,y),y.constructor_.apply(_,arguments),_}return m(y,I),o(y,[{key:"getDepth",value:function(){return this._depth}},{key:"getCollapsedEdge",value:function(){var _=new Array(2).fill(null);return _[0]=this.pts[0],_[1]=this.pts[1],new y(_,$n.toLineLabel(this._label))}},{key:"isIsolated",value:function(){return this._isIsolated}},{key:"getCoordinates",value:function(){return this.pts}},{key:"setIsolated",value:function(_){this._isIsolated=_}},{key:"setName",value:function(_){this._name=_}},{key:"equals",value:function(_){if(!(_ instanceof y))return!1;var P=_;if(this.pts.length!==P.pts.length)return!1;for(var $=!0,ne=!0,me=this.pts.length,Oe=0;Oe<this.pts.length;Oe++)if(this.pts[Oe].equals2D(P.pts[Oe])||($=!1),this.pts[Oe].equals2D(P.pts[--me])||(ne=!1),!$&&!ne)return!1;return!0}},{key:"getCoordinate",value:function(){if(arguments.length===0)return this.pts.length>0?this.pts[0]:null;if(arguments.length===1){var _=arguments[0];return this.pts[_]}}},{key:"print",value:function(_){_.print("edge "+this._name+": "),_.print("LINESTRING (");for(var P=0;P<this.pts.length;P++)P>0&&_.print(","),_.print(this.pts[P].x+" "+this.pts[P].y);_.print(")  "+this._label+" "+this._depthDelta)}},{key:"computeIM",value:function(_){y.updateIM(this._label,_)}},{key:"isCollapsed",value:function(){return!!this._label.isArea()&&this.pts.length===3&&!!this.pts[0].equals(this.pts[2])}},{key:"isClosed",value:function(){return this.pts[0].equals(this.pts[this.pts.length-1])}},{key:"getMaximumSegmentIndex",value:function(){return this.pts.length-1}},{key:"getDepthDelta",value:function(){return this._depthDelta}},{key:"getNumPoints",value:function(){return this.pts.length}},{key:"printReverse",value:function(_){_.print("edge "+this._name+": ");for(var P=this.pts.length-1;P>=0;P--)_.print(this.pts[P]+" ");_.println("")}},{key:"getMonotoneChainEdge",value:function(){return this._mce===null&&(this._mce=new Zs(this)),this._mce}},{key:"getEnvelope",value:function(){if(this._env===null){this._env=new Qe;for(var _=0;_<this.pts.length;_++)this._env.expandToInclude(this.pts[_])}return this._env}},{key:"addIntersection",value:function(_,P,$,ne){var me=new Be(_.getIntersection(ne)),Oe=P,tt=_.getEdgeDistance($,ne),ft=Oe+1;if(ft<this.pts.length){var rr=this.pts[ft];me.equals2D(rr)&&(Oe=ft,tt=0)}this.eiList.add(me,Oe,tt)}},{key:"toString",value:function(){var _=new Mo;_.append("edge "+this._name+": "),_.append("LINESTRING (");for(var P=0;P<this.pts.length;P++)P>0&&_.append(","),_.append(this.pts[P].x+" "+this.pts[P].y);return _.append(")  "+this._label+" "+this._depthDelta),_.toString()}},{key:"isPointwiseEqual",value:function(_){if(this.pts.length!==_.pts.length)return!1;for(var P=0;P<this.pts.length;P++)if(!this.pts[P].equals2D(_.pts[P]))return!1;return!0}},{key:"setDepthDelta",value:function(_){this._depthDelta=_}},{key:"getEdgeIntersectionList",value:function(){return this.eiList}},{key:"addIntersections",value:function(_,P,$){for(var ne=0;ne<_.getIntersectionNum();ne++)this.addIntersection(_,P,$,ne)}}],[{key:"constructor_",value:function(){if(this.pts=null,this._env=null,this.eiList=new mo(this),this._name=null,this._mce=null,this._isIsolated=!0,this._depth=new ms,this._depthDelta=0,arguments.length===1){var _=arguments[0];y.constructor_.call(this,_,null)}else if(arguments.length===2){var P=arguments[0],$=arguments[1];this.pts=P,this._label=$}}},{key:"updateIM",value:function(){if(!(arguments.length===2&&arguments[1]instanceof Du&&arguments[0]instanceof $n))return E(y,"updateIM",this).apply(this,arguments);var _=arguments[0],P=arguments[1];P.setAtLeastIfValid(_.getLocation(0,_t.ON),_.getLocation(1,_t.ON),1),_.isArea()&&(P.setAtLeastIfValid(_.getLocation(0,_t.LEFT),_.getLocation(1,_t.LEFT),2),P.setAtLeastIfValid(_.getLocation(0,_t.RIGHT),_.getLocation(1,_t.RIGHT),2))}}])})(mn),Vl=(function(){function I(){i(this,I),I.constructor_.apply(this,arguments)}return o(I,[{key:"setWorkingPrecisionModel",value:function(y){this._workingPrecisionModel=y}},{key:"insertUniqueEdge",value:function(y){var _=this._edgeList.findEqualEdge(y);if(_!==null){var P=_.getLabel(),$=y.getLabel();_.isPointwiseEqual(y)||($=new $n(y.getLabel())).flip(),P.merge($);var ne=I.depthDelta($),me=_.getDepthDelta()+ne;_.setDepthDelta(me)}else this._edgeList.add(y),y.setDepthDelta(I.depthDelta(y.getLabel()))}},{key:"buildSubgraphs",value:function(y,_){for(var P=new ct,$=y.iterator();$.hasNext();){var ne=$.next(),me=ne.getRightmostCoordinate(),Oe=new gs(P).getDepth(me);ne.computeDepth(Oe),ne.findResultEdges(),P.add(ne),_.add(ne.getDirectedEdges(),ne.getNodes())}}},{key:"createSubgraphs",value:function(y){for(var _=new ct,P=y.getNodes().iterator();P.hasNext();){var $=P.next();if(!$.isVisited()){var ne=new Ht;ne.create($),_.add(ne)}}return ri.sort(_,ri.reverseOrder()),_}},{key:"createEmptyResultGeometry",value:function(){return this._geomFact.createPolygon()}},{key:"getNoder",value:function(y){if(this._workingNoder!==null)return this._workingNoder;var _=new ll,P=new on;return P.setPrecisionModel(y),_.setSegmentIntersector(new cu(P)),_}},{key:"buffer",value:function(y,_){var P=this._workingPrecisionModel;P===null&&(P=y.getPrecisionModel()),this._geomFact=y.getFactory();var $=new Il(P,this._bufParams),ne=new As(y,_,$).getCurves();if(ne.size()<=0)return this.createEmptyResultGeometry();this.computeNodedEdges(ne,P),this._graph=new Vo(new Is),this._graph.addEdges(this._edgeList.getEdges());var me=this.createSubgraphs(this._graph),Oe=new Ru(this._geomFact);this.buildSubgraphs(me,Oe);var tt=Oe.getPolygons();return tt.size()<=0?this.createEmptyResultGeometry():this._geomFact.buildGeometry(tt)}},{key:"computeNodedEdges",value:function(y,_){var P=this.getNoder(_);P.computeNodes(y);for(var $=P.getNodedSubstrings().iterator();$.hasNext();){var ne=$.next(),me=ne.getCoordinates();if(me.length!==2||!me[0].equals2D(me[1])){var Oe=ne.getData(),tt=new Va(ne.getCoordinates(),new $n(Oe));this.insertUniqueEdge(tt)}}}},{key:"setNoder",value:function(y){this._workingNoder=y}}],[{key:"constructor_",value:function(){this._bufParams=null,this._workingPrecisionModel=null,this._workingNoder=null,this._geomFact=null,this._graph=null,this._edgeList=new ic;var y=arguments[0];this._bufParams=y}},{key:"depthDelta",value:function(y){var _=y.getLocation(0,_t.LEFT),P=y.getLocation(0,_t.RIGHT);return _===be.INTERIOR&&P===be.EXTERIOR?1:_===be.EXTERIOR&&P===be.INTERIOR?-1:0}},{key:"convertSegStrings",value:function(y){for(var _=new Aa,P=new ct;y.hasNext();){var $=y.next(),ne=_.createLineString($.getCoordinates());P.add(ne)}return _.buildGeometry(P)}}])})(),cl=(function(){function I(){i(this,I),I.constructor_.apply(this,arguments)}return o(I,[{key:"rescale",value:function(){if(Er(arguments[0],Ot))for(var y=arguments[0].iterator();y.hasNext();){var _=y.next();this.rescale(_.getCoordinates())}else if(arguments[0]instanceof Array){for(var P=arguments[0],$=0;$<P.length;$++)P[$].x=P[$].x/this._scaleFactor+this._offsetX,P[$].y=P[$].y/this._scaleFactor+this._offsetY;P.length===2&&P[0].equals2D(P[1])&&Ar.out.println(P)}}},{key:"scale",value:function(){if(Er(arguments[0],Ot)){for(var y=arguments[0],_=new ct(y.size()),P=y.iterator();P.hasNext();){var $=P.next();_.add(new Ui(this.scale($.getCoordinates()),$.getData()))}return _}if(arguments[0]instanceof Array){for(var ne=arguments[0],me=new Array(ne.length).fill(null),Oe=0;Oe<ne.length;Oe++)me[Oe]=new Be(Math.round((ne[Oe].x-this._offsetX)*this._scaleFactor),Math.round((ne[Oe].y-this._offsetY)*this._scaleFactor),ne[Oe].getZ());return Wi.removeRepeatedPoints(me)}}},{key:"isIntegerPrecision",value:function(){return this._scaleFactor===1}},{key:"getNodedSubstrings",value:function(){var y=this._noder.getNodedSubstrings();return this._isScaled&&this.rescale(y),y}},{key:"computeNodes",value:function(y){var _=y;this._isScaled&&(_=this.scale(y)),this._noder.computeNodes(_)}},{key:"interfaces_",get:function(){return[za]}}],[{key:"constructor_",value:function(){if(this._noder=null,this._scaleFactor=null,this._offsetX=null,this._offsetY=null,this._isScaled=!1,arguments.length===2){var y=arguments[0],_=arguments[1];I.constructor_.call(this,y,_,0,0)}else if(arguments.length===4){var P=arguments[0],$=arguments[1];this._noder=P,this._scaleFactor=$,this._isScaled=!this.isIntegerPrecision()}}}])})(),fl=(function(){function I(){i(this,I),I.constructor_.apply(this,arguments)}return o(I,[{key:"checkEndPtVertexIntersections",value:function(){if(arguments.length===0)for(var y=this._segStrings.iterator();y.hasNext();){var _=y.next().getCoordinates();this.checkEndPtVertexIntersections(_[0],this._segStrings),this.checkEndPtVertexIntersections(_[_.length-1],this._segStrings)}else if(arguments.length===2){for(var P=arguments[0],$=arguments[1].iterator();$.hasNext();)for(var ne=$.next().getCoordinates(),me=1;me<ne.length-1;me++)if(ne[me].equals(P))throw new de("found endpt/interior pt intersection at index "+me+" :pt "+P)}}},{key:"checkInteriorIntersections",value:function(){if(arguments.length===0)for(var y=this._segStrings.iterator();y.hasNext();)for(var _=y.next(),P=this._segStrings.iterator();P.hasNext();){var $=P.next();this.checkInteriorIntersections(_,$)}else if(arguments.length===2)for(var ne=arguments[0],me=arguments[1],Oe=ne.getCoordinates(),tt=me.getCoordinates(),ft=0;ft<Oe.length-1;ft++)for(var rr=0;rr<tt.length-1;rr++)this.checkInteriorIntersections(ne,ft,me,rr);else if(arguments.length===4){var ur=arguments[0],qr=arguments[1],bn=arguments[2],Dn=arguments[3];if(ur===bn&&qr===Dn)return null;var Xn=ur.getCoordinates()[qr],Fn=ur.getCoordinates()[qr+1],En=bn.getCoordinates()[Dn],na=bn.getCoordinates()[Dn+1];if(this._li.computeIntersection(Xn,Fn,En,na),this._li.hasIntersection()&&(this._li.isProper()||this.hasInteriorIntersection(this._li,Xn,Fn)||this.hasInteriorIntersection(this._li,En,na)))throw new de("found non-noded intersection at "+Xn+"-"+Fn+" and "+En+"-"+na)}}},{key:"checkValid",value:function(){this.checkEndPtVertexIntersections(),this.checkInteriorIntersections(),this.checkCollapses()}},{key:"checkCollapses",value:function(){if(arguments.length===0)for(var y=this._segStrings.iterator();y.hasNext();){var _=y.next();this.checkCollapses(_)}else if(arguments.length===1)for(var P=arguments[0].getCoordinates(),$=0;$<P.length-2;$++)this.checkCollapse(P[$],P[$+1],P[$+2])}},{key:"hasInteriorIntersection",value:function(y,_,P){for(var $=0;$<y.getIntersectionNum();$++){var ne=y.getIntersection($);if(!ne.equals(_)&&!ne.equals(P))return!0}return!1}},{key:"checkCollapse",value:function(y,_,P){if(y.equals(P))throw new de("found non-noded collapse at "+I.fact.createLineString([y,_,P]))}}],[{key:"constructor_",value:function(){this._li=new on,this._segStrings=null;var y=arguments[0];this._segStrings=y}}])})();fl.fact=new Aa;var $l=(function(){function I(){i(this,I),I.constructor_.apply(this,arguments)}return o(I,[{key:"intersectsScaled",value:function(y,_){var P=Math.min(y.x,_.x),$=Math.max(y.x,_.x),ne=Math.min(y.y,_.y),me=Math.max(y.y,_.y),Oe=this._maxx<P||this._minx>$||this._maxy<ne||this._miny>me;if(Oe)return!1;var tt=this.intersectsToleranceSquare(y,_);return we.isTrue(!(Oe&&tt),"Found bad envelope test"),tt}},{key:"initCorners",value:function(y){var _=.5;this._minx=y.x-_,this._maxx=y.x+_,this._miny=y.y-_,this._maxy=y.y+_,this._corner[0]=new Be(this._maxx,this._maxy),this._corner[1]=new Be(this._minx,this._maxy),this._corner[2]=new Be(this._minx,this._miny),this._corner[3]=new Be(this._maxx,this._miny)}},{key:"intersects",value:function(y,_){return this._scaleFactor===1?this.intersectsScaled(y,_):(this.copyScaled(y,this._p0Scaled),this.copyScaled(_,this._p1Scaled),this.intersectsScaled(this._p0Scaled,this._p1Scaled))}},{key:"scale",value:function(y){return Math.round(y*this._scaleFactor)}},{key:"getCoordinate",value:function(){return this._originalPt}},{key:"copyScaled",value:function(y,_){_.x=this.scale(y.x),_.y=this.scale(y.y)}},{key:"getSafeEnvelope",value:function(){if(this._safeEnv===null){var y=I.SAFE_ENV_EXPANSION_FACTOR/this._scaleFactor;this._safeEnv=new Qe(this._originalPt.x-y,this._originalPt.x+y,this._originalPt.y-y,this._originalPt.y+y)}return this._safeEnv}},{key:"intersectsPixelClosure",value:function(y,_){return this._li.computeIntersection(y,_,this._corner[0],this._corner[1]),!!this._li.hasIntersection()||(this._li.computeIntersection(y,_,this._corner[1],this._corner[2]),!!this._li.hasIntersection()||(this._li.computeIntersection(y,_,this._corner[2],this._corner[3]),!!this._li.hasIntersection()||(this._li.computeIntersection(y,_,this._corner[3],this._corner[0]),!!this._li.hasIntersection())))}},{key:"intersectsToleranceSquare",value:function(y,_){var P=!1,$=!1;return this._li.computeIntersection(y,_,this._corner[0],this._corner[1]),!!this._li.isProper()||(this._li.computeIntersection(y,_,this._corner[1],this._corner[2]),!!this._li.isProper()||(this._li.hasIntersection()&&(P=!0),this._li.computeIntersection(y,_,this._corner[2],this._corner[3]),!!this._li.isProper()||(this._li.hasIntersection()&&($=!0),this._li.computeIntersection(y,_,this._corner[3],this._corner[0]),!!this._li.isProper()||!(!P||!$)||!!y.equals(this._pt)||!!_.equals(this._pt))))}},{key:"addSnappedNode",value:function(y,_){var P=y.getCoordinate(_),$=y.getCoordinate(_+1);return!!this.intersects(P,$)&&(y.addIntersection(this.getCoordinate(),_),!0)}}],[{key:"constructor_",value:function(){this._li=null,this._pt=null,this._originalPt=null,this._ptScaled=null,this._p0Scaled=null,this._p1Scaled=null,this._scaleFactor=null,this._minx=null,this._maxx=null,this._miny=null,this._maxy=null,this._corner=new Array(4).fill(null),this._safeEnv=null;var y=arguments[0],_=arguments[1],P=arguments[2];if(this._originalPt=y,this._pt=y,this._scaleFactor=_,this._li=P,_<=0)throw new U("Scale factor must be non-zero");_!==1&&(this._pt=new Be(this.scale(y.x),this.scale(y.y)),this._p0Scaled=new Be,this._p1Scaled=new Be),this.initCorners(this._pt)}}])})();$l.SAFE_ENV_EXPANSION_FACTOR=.75;var ql=(function(){return o((function I(){i(this,I),I.constructor_.apply(this,arguments)}),[{key:"select",value:function(){if(arguments.length!==1){if(arguments.length===2){var I=arguments[1];arguments[0].getLineSegment(I,this.selectedSegment),this.select(this.selectedSegment)}}}}],[{key:"constructor_",value:function(){this.selectedSegment=new Xi}}])})(),hl=(function(){return o((function I(){i(this,I),I.constructor_.apply(this,arguments)}),[{key:"snap",value:function(){if(arguments.length===1){var I=arguments[0];return this.snap(I,null,-1)}if(arguments.length===3){var y=arguments[0],_=arguments[1],P=arguments[2],$=y.getSafeEnvelope(),ne=new Hl(y,_,P);return this._index.query($,new((function(){return o((function me(){i(this,me)}),[{key:"interfaces_",get:function(){return[ue]}},{key:"visitItem",value:function(me){me.select($,ne)}}])})())),ne.isNodeAdded()}}}],[{key:"constructor_",value:function(){this._index=null;var I=arguments[0];this._index=I}}])})(),Hl=(function(I){function y(){var _;return i(this,y),_=n(this,y),y.constructor_.apply(_,arguments),_}return m(y,I),o(y,[{key:"isNodeAdded",value:function(){return this._isNodeAdded}},{key:"select",value:function(){if(!(arguments.length===2&&Number.isInteger(arguments[1])&&arguments[0]instanceof Si))return E(y,"select",this,1).apply(this,arguments);var _=arguments[1],P=arguments[0].getContext();if(this._parentEdge===P&&(_===this._hotPixelVertexIndex||_+1===this._hotPixelVertexIndex))return null;this._isNodeAdded|=this._hotPixel.addSnappedNode(P,_)}}],[{key:"constructor_",value:function(){this._hotPixel=null,this._parentEdge=null,this._hotPixelVertexIndex=null,this._isNodeAdded=!1;var _=arguments[0],P=arguments[1],$=arguments[2];this._hotPixel=_,this._parentEdge=P,this._hotPixelVertexIndex=$}}])})(ql);hl.HotPixelSnapAction=Hl;var Ou=(function(){return o((function I(){i(this,I),I.constructor_.apply(this,arguments)}),[{key:"processIntersections",value:function(I,y,_,P){if(I===_&&y===P)return null;var $=I.getCoordinates()[y],ne=I.getCoordinates()[y+1],me=_.getCoordinates()[P],Oe=_.getCoordinates()[P+1];if(this._li.computeIntersection($,ne,me,Oe),this._li.hasIntersection()&&this._li.isInteriorIntersection()){for(var tt=0;tt<this._li.getIntersectionNum();tt++)this._interiorIntersections.add(this._li.getIntersection(tt));I.addIntersections(this._li,y,0),_.addIntersections(this._li,P,1)}}},{key:"isDone",value:function(){return!1}},{key:"getInteriorIntersections",value:function(){return this._interiorIntersections}},{key:"interfaces_",get:function(){return[ul]}}],[{key:"constructor_",value:function(){this._li=null,this._interiorIntersections=null;var I=arguments[0];this._li=I,this._interiorIntersections=new ct}}])})(),tr=(function(){return o((function I(){i(this,I),I.constructor_.apply(this,arguments)}),[{key:"checkCorrectness",value:function(I){var y=Ui.getNodedSubstrings(I),_=new fl(y);try{_.checkValid()}catch(P){if(!(P instanceof O))throw P;P.printStackTrace()}}},{key:"getNodedSubstrings",value:function(){return Ui.getNodedSubstrings(this._nodedSegStrings)}},{key:"snapRound",value:function(I,y){var _=this.findInteriorIntersections(I,y);this.computeIntersectionSnaps(_),this.computeVertexSnaps(I)}},{key:"findInteriorIntersections",value:function(I,y){var _=new Ou(y);return this._noder.setSegmentIntersector(_),this._noder.computeNodes(I),_.getInteriorIntersections()}},{key:"computeVertexSnaps",value:function(){if(Er(arguments[0],Ot))for(var I=arguments[0].iterator();I.hasNext();){var y=I.next();this.computeVertexSnaps(y)}else if(arguments[0]instanceof Ui)for(var _=arguments[0],P=_.getCoordinates(),$=0;$<P.length;$++){var ne=new $l(P[$],this._scaleFactor,this._li);this._pointSnapper.snap(ne,_,$)&&_.addIntersection(P[$],$)}}},{key:"computeNodes",value:function(I){this._nodedSegStrings=I,this._noder=new ll,this._pointSnapper=new hl(this._noder.getIndex()),this.snapRound(I,this._li)}},{key:"computeIntersectionSnaps",value:function(I){for(var y=I.iterator();y.hasNext();){var _=y.next(),P=new $l(_,this._scaleFactor,this._li);this._pointSnapper.snap(P)}}},{key:"interfaces_",get:function(){return[za]}}],[{key:"constructor_",value:function(){this._pm=null,this._li=null,this._scaleFactor=null,this._noder=null,this._pointSnapper=null,this._nodedSegStrings=null;var I=arguments[0];this._pm=I,this._li=new on,this._li.setPrecisionModel(I),this._scaleFactor=I.getScale()}}])})(),vr=(function(){function I(){i(this,I),I.constructor_.apply(this,arguments)}return o(I,[{key:"bufferFixedPrecision",value:function(y){var _=new cl(new tr(new ga(1)),y.getScale()),P=new Vl(this._bufParams);P.setWorkingPrecisionModel(y),P.setNoder(_),this._resultGeometry=P.buffer(this._argGeom,this._distance)}},{key:"bufferReducedPrecision",value:function(){if(arguments.length===0){for(var y=I.MAX_PRECISION_DIGITS;y>=0;y--){try{this.bufferReducedPrecision(y)}catch(ne){if(!(ne instanceof Et))throw ne;this._saveException=ne}if(this._resultGeometry!==null)return null}throw this._saveException}if(arguments.length===1){var _=arguments[0],P=I.precisionScaleFactor(this._argGeom,this._distance,_),$=new ga(P);this.bufferFixedPrecision($)}}},{key:"computeGeometry",value:function(){if(this.bufferOriginalPrecision(),this._resultGeometry!==null)return null;var y=this._argGeom.getFactory().getPrecisionModel();y.getType()===ga.FIXED?this.bufferFixedPrecision(y):this.bufferReducedPrecision()}},{key:"setQuadrantSegments",value:function(y){this._bufParams.setQuadrantSegments(y)}},{key:"bufferOriginalPrecision",value:function(){try{var y=new Vl(this._bufParams);this._resultGeometry=y.buffer(this._argGeom,this._distance)}catch(_){if(!(_ instanceof de))throw _;this._saveException=_}}},{key:"getResultGeometry",value:function(y){return this._distance=y,this.computeGeometry(),this._resultGeometry}},{key:"setEndCapStyle",value:function(y){this._bufParams.setEndCapStyle(y)}}],[{key:"constructor_",value:function(){if(this._argGeom=null,this._distance=null,this._bufParams=new N,this._resultGeometry=null,this._saveException=null,arguments.length===1){var y=arguments[0];this._argGeom=y}else if(arguments.length===2){var _=arguments[0],P=arguments[1];this._argGeom=_,this._bufParams=P}}},{key:"bufferOp",value:function(){if(arguments.length===2){var y=arguments[1];return new I(arguments[0]).getResultGeometry(y)}if(arguments.length===3){if(Number.isInteger(arguments[2])&&arguments[0]instanceof it&&typeof arguments[1]=="number"){var _=arguments[1],P=arguments[2],$=new I(arguments[0]);return $.setQuadrantSegments(P),$.getResultGeometry(_)}if(arguments[2]instanceof N&&arguments[0]instanceof it&&typeof arguments[1]=="number"){var ne=arguments[1];return new I(arguments[0],arguments[2]).getResultGeometry(ne)}}else if(arguments.length===4){var me=arguments[1],Oe=arguments[2],tt=arguments[3],ft=new I(arguments[0]);return ft.setQuadrantSegments(Oe),ft.setEndCapStyle(tt),ft.getResultGeometry(me)}}},{key:"precisionScaleFactor",value:function(y,_,P){var $=y.getEnvelopeInternal(),ne=$r.max(Math.abs($.getMaxX()),Math.abs($.getMaxY()),Math.abs($.getMinX()),Math.abs($.getMinY()))+2*(_>0?_:0),me=P-Math.trunc(Math.log(ne)/Math.log(10)+1);return Math.pow(10,me)}}])})();vr.CAP_ROUND=N.CAP_ROUND,vr.CAP_BUTT=N.CAP_FLAT,vr.CAP_FLAT=N.CAP_FLAT,vr.CAP_SQUARE=N.CAP_SQUARE,vr.MAX_PRECISION_DIGITS=12;var dn=["Point","MultiPoint","LineString","MultiLineString","Polygon","MultiPolygon"],In=(function(){return o((function I(y){i(this,I),this.geometryFactory=y||new Aa}),[{key:"read",value:function(I){var y,_=(y=typeof I=="string"?JSON.parse(I):I).type;if(!vi[_])throw new Error("Unknown GeoJSON type: "+y.type);return dn.indexOf(_)!==-1?vi[_].call(this,y.coordinates):_==="GeometryCollection"?vi[_].call(this,y.geometries):vi[_].call(this,y)}},{key:"write",value:function(I){var y=I.getGeometryType();if(!Pn[y])throw new Error("Geometry is not supported");return Pn[y].call(this,I)}}])})(),vi={Feature:function(I){var y={};for(var _ in I)y[_]=I[_];if(I.geometry){var P=I.geometry.type;if(!vi[P])throw new Error("Unknown GeoJSON type: "+I.type);y.geometry=this.read(I.geometry)}return I.bbox&&(y.bbox=vi.bbox.call(this,I.bbox)),y},FeatureCollection:function(I){var y={};if(I.features){y.features=[];for(var _=0;_<I.features.length;++_)y.features.push(this.read(I.features[_]))}return I.bbox&&(y.bbox=this.parse.bbox.call(this,I.bbox)),y},coordinates:function(I){for(var y=[],_=0;_<I.length;++_){var P=I[_];y.push(a(Be,T(P)))}return y},bbox:function(I){return this.geometryFactory.createLinearRing([new Be(I[0],I[1]),new Be(I[2],I[1]),new Be(I[2],I[3]),new Be(I[0],I[3]),new Be(I[0],I[1])])},Point:function(I){var y=a(Be,T(I));return this.geometryFactory.createPoint(y)},MultiPoint:function(I){for(var y=[],_=0;_<I.length;++_)y.push(vi.Point.call(this,I[_]));return this.geometryFactory.createMultiPoint(y)},LineString:function(I){var y=vi.coordinates.call(this,I);return this.geometryFactory.createLineString(y)},MultiLineString:function(I){for(var y=[],_=0;_<I.length;++_)y.push(vi.LineString.call(this,I[_]));return this.geometryFactory.createMultiLineString(y)},Polygon:function(I){for(var y=vi.coordinates.call(this,I[0]),_=this.geometryFactory.createLinearRing(y),P=[],$=1;$<I.length;++$){var ne=I[$],me=vi.coordinates.call(this,ne),Oe=this.geometryFactory.createLinearRing(me);P.push(Oe)}return this.geometryFactory.createPolygon(_,P)},MultiPolygon:function(I){for(var y=[],_=0;_<I.length;++_){var P=I[_];y.push(vi.Polygon.call(this,P))}return this.geometryFactory.createMultiPolygon(y)},GeometryCollection:function(I){for(var y=[],_=0;_<I.length;++_){var P=I[_];y.push(this.read(P))}return this.geometryFactory.createGeometryCollection(y)}},Pn={coordinate:function(I){var y=[I.x,I.y];return I.z&&y.push(I.z),I.m&&y.push(I.m),y},Point:function(I){return{type:"Point",coordinates:Pn.coordinate.call(this,I.getCoordinate())}},MultiPoint:function(I){for(var y=[],_=0;_<I._geometries.length;++_){var P=I._geometries[_],$=Pn.Point.call(this,P);y.push($.coordinates)}return{type:"MultiPoint",coordinates:y}},LineString:function(I){for(var y=[],_=I.getCoordinates(),P=0;P<_.length;++P){var $=_[P];y.push(Pn.coordinate.call(this,$))}return{type:"LineString",coordinates:y}},MultiLineString:function(I){for(var y=[],_=0;_<I._geometries.length;++_){var P=I._geometries[_],$=Pn.LineString.call(this,P);y.push($.coordinates)}return{type:"MultiLineString",coordinates:y}},Polygon:function(I){var y=[],_=Pn.LineString.call(this,I._shell);y.push(_.coordinates);for(var P=0;P<I._holes.length;++P){var $=I._holes[P],ne=Pn.LineString.call(this,$);y.push(ne.coordinates)}return{type:"Polygon",coordinates:y}},MultiPolygon:function(I){for(var y=[],_=0;_<I._geometries.length;++_){var P=I._geometries[_],$=Pn.Polygon.call(this,P);y.push($.coordinates)}return{type:"MultiPolygon",coordinates:y}},GeometryCollection:function(I){for(var y=[],_=0;_<I._geometries.length;++_){var P=I._geometries[_],$=P.getGeometryType();y.push(Pn[$].call(this,P))}return{type:"GeometryCollection",geometries:y}}};return{BufferOp:vr,GeoJSONReader:(function(){return o((function I(y){i(this,I),this.parser=new In(y||new Aa)}),[{key:"read",value:function(I){return this.parser.read(I)}}])})(),GeoJSONWriter:(function(){return o((function I(){i(this,I),this.parser=new In(this.geometryFactory)}),[{key:"write",value:function(I){return this.parser.write(I)}}])})()}}))})(vS)),vS.exports}var J2e=K2e();const Q2e=Id(J2e);function jg(){return new dE}function dE(){this.reset()}dE.prototype={constructor:dE,reset:function(){this.s=this.t=0},add:function(t){k7(Sw,t,this.t),k7(this,Sw.s,this.s),this.s?this.t+=Sw.t:this.s=Sw.t},valueOf:function(){return this.s}};var Sw=new dE;function k7(t,e,r){var n=t.s=e+r,i=n-e,a=n-i;t.t=e-a+(r-i)}var zo=1e-6,Oa=Math.PI,dd=Oa/2,R7=Oa/4,Td=Oa*2,tg=180/Oa,Mf=Oa/180,au=Math.abs,ewe=Math.atan,K0=Math.atan2,xs=Math.cos,ws=Math.sin,__=Math.sqrt;function fJ(t){return t>1?0:t<-1?Oa:Math.acos(t)}function iy(t){return t>1?dd:t<-1?-dd:Math.asin(t)}function B1(){}function pE(t,e){t&&D7.hasOwnProperty(t.type)&&D7[t.type](t,e)}var M7={Feature:function(t,e){pE(t.geometry,e)},FeatureCollection:function(t,e){for(var r=t.features,n=-1,i=r.length;++n<i;)pE(r[n].geometry,e)}},D7={Sphere:function(t,e){e.sphere()},Point:function(t,e){t=t.coordinates,e.point(t[0],t[1],t[2])},MultiPoint:function(t,e){for(var r=t.coordinates,n=-1,i=r.length;++n<i;)t=r[n],e.point(t[0],t[1],t[2])},LineString:function(t,e){RR(t.coordinates,e,0)},MultiLineString:function(t,e){for(var r=t.coordinates,n=-1,i=r.length;++n<i;)RR(r[n],e,0)},Polygon:function(t,e){O7(t.coordinates,e)},MultiPolygon:function(t,e){for(var r=t.coordinates,n=-1,i=r.length;++n<i;)O7(r[n],e)},GeometryCollection:function(t,e){for(var r=t.geometries,n=-1,i=r.length;++n<i;)pE(r[n],e)}};function RR(t,e,r){var n=-1,i=t.length-r,a;for(e.lineStart();++n<i;)a=t[n],e.point(a[0],a[1],a[2]);e.lineEnd()}function O7(t,e){var r=-1,n=t.length;for(e.polygonStart();++r<n;)RR(t[r],e,1);e.polygonEnd()}function twe(t,e){t&&M7.hasOwnProperty(t.type)?M7[t.type](t,e):pE(t,e)}jg();jg();function MR(t){return[K0(t[1],t[0]),iy(t[2])]}function J0(t){var e=t[0],r=t[1],n=xs(r);return[n*xs(e),n*ws(e),ws(r)]}function Ew(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function gE(t,e){return[t[1]*e[2]-t[2]*e[1],t[2]*e[0]-t[0]*e[2],t[0]*e[1]-t[1]*e[0]]}function i5(t,e){t[0]+=e[0],t[1]+=e[1],t[2]+=e[2]}function Tw(t,e){return[t[0]*e,t[1]*e,t[2]*e]}function DR(t){var e=__(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]);t[0]/=e,t[1]/=e,t[2]/=e}jg();function hJ(t,e){function r(n,i){return n=t(n,i),e(n[0],n[1])}return t.invert&&e.invert&&(r.invert=function(n,i){return n=e.invert(n,i),n&&t.invert(n[0],n[1])}),r}function OR(t,e){return[t>Oa?t-Td:t<-Oa?t+Td:t,e]}OR.invert=OR;function rwe(t,e,r){return(t%=Td)?e||r?hJ(L7(t),F7(e,r)):L7(t):e||r?F7(e,r):OR}function N7(t){return function(e,r){return e+=t,[e>Oa?e-Td:e<-Oa?e+Td:e,r]}}function L7(t){var e=N7(t);return e.invert=N7(-t),e}function F7(t,e){var r=xs(t),n=ws(t),i=xs(e),a=ws(e);function s(o,c){var f=xs(c),d=xs(o)*f,m=ws(o)*f,b=ws(c),x=b*r+d*n;return[K0(m*i-x*a,d*r-b*n),iy(x*i+m*a)]}return s.invert=function(o,c){var f=xs(c),d=xs(o)*f,m=ws(o)*f,b=ws(c),x=b*i-m*a;return[K0(m*i+b*a,d*r+x*n),iy(x*r-d*n)]},s}function nwe(t,e,r,n,i,a){if(r){var s=xs(e),o=ws(e),c=n*r;i==null?(i=e+n*Td,a=e-c/2):(i=B7(s,i),a=B7(s,a),(n>0?i<a:i>a)&&(i+=n*Td));for(var f,d=i;n>0?d>a:d<a;d-=c)f=MR([s,-o*xs(d),-o*ws(d)]),t.point(f[0],f[1])}}function B7(t,e){e=J0(e),e[0]-=t,DR(e);var r=fJ(-e[1]);return((-e[2]<0?-r:r)+Td-zo)%Td}function dJ(){var t=[],e;return{point:function(r,n){e.push([r,n])},lineStart:function(){t.push(e=[])},lineEnd:B1,rejoin:function(){t.length>1&&t.push(t.pop().concat(t.shift()))},result:function(){var r=t;return t=[],e=null,r}}}function iwe(t,e,r,n,i,a){var s=t[0],o=t[1],c=e[0],f=e[1],d=0,m=1,b=c-s,x=f-o,E;if(E=r-s,!(!b&&E>0)){if(E/=b,b<0){if(E<d)return;E<m&&(m=E)}else if(b>0){if(E>m)return;E>d&&(d=E)}if(E=i-s,!(!b&&E<0)){if(E/=b,b<0){if(E>m)return;E>d&&(d=E)}else if(b>0){if(E<d)return;E<m&&(m=E)}if(E=n-o,!(!x&&E>0)){if(E/=x,x<0){if(E<d)return;E<m&&(m=E)}else if(x>0){if(E>m)return;E>d&&(d=E)}if(E=a-o,!(!x&&E<0)){if(E/=x,x<0){if(E>m)return;E>d&&(d=E)}else if(x>0){if(E<d)return;E<m&&(m=E)}return d>0&&(t[0]=s+d*b,t[1]=o+d*x),m<1&&(e[0]=s+m*b,e[1]=o+m*x),!0}}}}}function _S(t,e){return au(t[0]-e[0])<zo&&au(t[1]-e[1])<zo}function Cw(t,e,r,n){this.x=t,this.z=e,this.o=r,this.e=n,this.v=!1,this.n=this.p=null}function pJ(t,e,r,n,i){var a=[],s=[],o,c;if(t.forEach(function(E){if(!((T=E.length-1)<=0)){var T,A=E[0],M=E[T],F;if(_S(A,M)){for(i.lineStart(),o=0;o<T;++o)i.point((A=E[o])[0],A[1]);i.lineEnd();return}a.push(F=new Cw(A,E,null,!0)),s.push(F.o=new Cw(A,null,F,!1)),a.push(F=new Cw(M,E,null,!1)),s.push(F.o=new Cw(M,null,F,!0))}}),!!a.length){for(s.sort(e),z7(a),z7(s),o=0,c=s.length;o<c;++o)s[o].e=r=!r;for(var f=a[0],d,m;;){for(var b=f,x=!0;b.v;)if((b=b.n)===f)return;d=b.z,i.lineStart();do{if(b.v=b.o.v=!0,b.e){if(x)for(o=0,c=d.length;o<c;++o)i.point((m=d[o])[0],m[1]);else n(b.x,b.n.x,1,i);b=b.n}else{if(x)for(d=b.p.z,o=d.length-1;o>=0;--o)i.point((m=d[o])[0],m[1]);else n(b.x,b.p.x,-1,i);b=b.p}b=b.o,d=b.z,x=!x}while(!b.v);i.lineEnd()}}}function z7(t){if(e=t.length){for(var e,r=0,n=t[0],i;++r<e;)n.n=i=t[r],i.p=n,n=i;n.n=i=t[0],i.p=n}}function gJ(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function awe(t){return t.length===1&&(t=owe(t)),{left:function(e,r,n,i){for(n==null&&(n=0),i==null&&(i=e.length);n<i;){var a=n+i>>>1;t(e[a],r)<0?n=a+1:i=a}return n},right:function(e,r,n,i){for(n==null&&(n=0),i==null&&(i=e.length);n<i;){var a=n+i>>>1;t(e[a],r)>0?i=a:n=a+1}return n}}}function owe(t){return function(e,r){return gJ(t(e),r)}}awe(gJ);function mJ(t){for(var e=t.length,r,n=-1,i=0,a,s;++n<e;)i+=t[n].length;for(a=new Array(i);--e>=0;)for(s=t[e],r=s.length;--r>=0;)a[--i]=s[r];return a}var z1=1e9,Aw=-z1;function swe(t,e,r,n){function i(f,d){return t<=f&&f<=r&&e<=d&&d<=n}function a(f,d,m,b){var x=0,E=0;if(f==null||(x=s(f,m))!==(E=s(d,m))||c(f,d)<0^m>0)do b.point(x===0||x===3?t:r,x>1?n:e);while((x=(x+m+4)%4)!==E);else b.point(d[0],d[1])}function s(f,d){return au(f[0]-t)<zo?d>0?0:3:au(f[0]-r)<zo?d>0?2:1:au(f[1]-e)<zo?d>0?1:0:d>0?3:2}function o(f,d){return c(f.x,d.x)}function c(f,d){var m=s(f,1),b=s(d,1);return m!==b?m-b:m===0?d[1]-f[1]:m===1?f[0]-d[0]:m===2?f[1]-d[1]:d[0]-f[0]}return function(f){var d=f,m=dJ(),b,x,E,T,A,M,F,N,O,U,j,H={point:W,lineStart:G,lineEnd:ae,polygonStart:oe,polygonEnd:Q};function W(fe,_e){i(fe,_e)&&d.point(fe,_e)}function X(){for(var fe=0,_e=0,Le=x.length;_e<Le;++_e)for(var ye=x[_e],Te=1,Ie=ye.length,Me=ye[0],de,Se,we=Me[0],De=Me[1];Te<Ie;++Te)de=we,Se=De,Me=ye[Te],we=Me[0],De=Me[1],Se<=n?De>n&&(we-de)*(n-Se)>(De-Se)*(t-de)&&++fe:De<=n&&(we-de)*(n-Se)<(De-Se)*(t-de)&&--fe;return fe}function oe(){d=m,b=[],x=[],j=!0}function Q(){var fe=X(),_e=j&&fe,Le=(b=mJ(b)).length;(_e||Le)&&(f.polygonStart(),_e&&(f.lineStart(),a(null,null,1,f),f.lineEnd()),Le&&pJ(b,o,fe,a,f),f.polygonEnd()),d=f,b=x=E=null}function G(){H.point=se,x&&x.push(E=[]),U=!0,O=!1,F=N=NaN}function ae(){b&&(se(T,A),M&&O&&m.rejoin(),b.push(m.result())),H.point=W,O&&d.lineEnd()}function se(fe,_e){var Le=i(fe,_e);if(x&&E.push([fe,_e]),U)T=fe,A=_e,M=Le,U=!1,Le&&(d.lineStart(),d.point(fe,_e));else if(Le&&O)d.point(fe,_e);else{var ye=[F=Math.max(Aw,Math.min(z1,F)),N=Math.max(Aw,Math.min(z1,N))],Te=[fe=Math.max(Aw,Math.min(z1,fe)),_e=Math.max(Aw,Math.min(z1,_e))];iwe(ye,Te,t,e,r,n)?(O||(d.lineStart(),d.point(ye[0],ye[1])),d.point(Te[0],Te[1]),Le||d.lineEnd(),j=!1):Le&&(d.lineStart(),d.point(fe,_e),j=!1)}F=fe,N=_e,O=Le}return H}}var a5=jg();function lwe(t,e){var r=e[0],n=e[1],i=[ws(r),-xs(r),0],a=0,s=0;a5.reset();for(var o=0,c=t.length;o<c;++o)if(d=(f=t[o]).length)for(var f,d,m=f[d-1],b=m[0],x=m[1]/2+R7,E=ws(x),T=xs(x),A=0;A<d;++A,b=F,E=O,T=U,m=M){var M=f[A],F=M[0],N=M[1]/2+R7,O=ws(N),U=xs(N),j=F-b,H=j>=0?1:-1,W=H*j,X=W>Oa,oe=E*O;if(a5.add(K0(oe*H*ws(W),T*U+oe*xs(W))),a+=X?j+H*Td:j,X^b>=r^F>=r){var Q=gE(J0(m),J0(M));DR(Q);var G=gE(i,Q);DR(G);var ae=(X^j>=0?-1:1)*iy(G[2]);(n>ae||n===ae&&(Q[0]||Q[1]))&&(s+=X^j>=0?1:-1)}}return(a<-zo||a<zo&&a5<-zo)^s&1}jg();function j7(t){return t}jg();jg();var Q0=1/0,mE=Q0,Jb=-Q0,yE=Jb,U7={point:uwe,lineStart:B1,lineEnd:B1,polygonStart:B1,polygonEnd:B1,result:function(){var t=[[Q0,mE],[Jb,yE]];return Jb=yE=-(mE=Q0=1/0),t}};function uwe(t,e){t<Q0&&(Q0=t),t>Jb&&(Jb=t),e<mE&&(mE=e),e>yE&&(yE=e)}jg();function yJ(t,e,r,n){return function(i,a){var s=e(a),o=i.invert(n[0],n[1]),c=dJ(),f=e(c),d=!1,m,b,x,E={point:T,lineStart:M,lineEnd:F,polygonStart:function(){E.point=N,E.lineStart=O,E.lineEnd=U,b=[],m=[]},polygonEnd:function(){E.point=T,E.lineStart=M,E.lineEnd=F,b=mJ(b);var j=lwe(m,o);b.length?(d||(a.polygonStart(),d=!0),pJ(b,fwe,j,r,a)):j&&(d||(a.polygonStart(),d=!0),a.lineStart(),r(null,null,1,a),a.lineEnd()),d&&(a.polygonEnd(),d=!1),b=m=null},sphere:function(){a.polygonStart(),a.lineStart(),r(null,null,1,a),a.lineEnd(),a.polygonEnd()}};function T(j,H){var W=i(j,H);t(j=W[0],H=W[1])&&a.point(j,H)}function A(j,H){var W=i(j,H);s.point(W[0],W[1])}function M(){E.point=A,s.lineStart()}function F(){E.point=T,s.lineEnd()}function N(j,H){x.push([j,H]);var W=i(j,H);f.point(W[0],W[1])}function O(){f.lineStart(),x=[]}function U(){N(x[0][0],x[0][1]),f.lineEnd();var j=f.clean(),H=c.result(),W,X=H.length,oe,Q,G;if(x.pop(),m.push(x),x=null,!!X){if(j&1){if(Q=H[0],(oe=Q.length-1)>0){for(d||(a.polygonStart(),d=!0),a.lineStart(),W=0;W<oe;++W)a.point((G=Q[W])[0],G[1]);a.lineEnd()}return}X>1&&j&2&&H.push(H.pop().concat(H.shift())),b.push(H.filter(cwe))}}return E}}function cwe(t){return t.length>1}function fwe(t,e){return((t=t.x)[0]<0?t[1]-dd-zo:dd-t[1])-((e=e.x)[0]<0?e[1]-dd-zo:dd-e[1])}const V7=yJ(function(){return!0},hwe,pwe,[-Oa,-dd]);function hwe(t){var e=NaN,r=NaN,n=NaN,i;return{lineStart:function(){t.lineStart(),i=1},point:function(a,s){var o=a>0?Oa:-Oa,c=au(a-e);au(c-Oa)<zo?(t.point(e,r=(r+s)/2>0?dd:-dd),t.point(n,r),t.lineEnd(),t.lineStart(),t.point(o,r),t.point(a,r),i=0):n!==o&&c>=Oa&&(au(e-n)<zo&&(e-=n*zo),au(a-o)<zo&&(a-=o*zo),r=dwe(e,r,a,s),t.point(n,r),t.lineEnd(),t.lineStart(),t.point(o,r),i=0),t.point(e=a,r=s),n=o},lineEnd:function(){t.lineEnd(),e=r=NaN},clean:function(){return 2-i}}}function dwe(t,e,r,n){var i,a,s=ws(t-r);return au(s)>zo?ewe((ws(e)*(a=xs(n))*ws(r)-ws(n)*(i=xs(e))*ws(t))/(i*a*s)):(e+n)/2}function pwe(t,e,r,n){var i;if(t==null)i=r*dd,n.point(-Oa,i),n.point(0,i),n.point(Oa,i),n.point(Oa,0),n.point(Oa,-i),n.point(0,-i),n.point(-Oa,-i),n.point(-Oa,0),n.point(-Oa,i);else if(au(t[0]-e[0])>zo){var a=t[0]<e[0]?Oa:-Oa;i=r*a/2,n.point(-a,i),n.point(0,i),n.point(a,i)}else n.point(e[0],e[1])}function gwe(t,e){var r=xs(t),n=r>0,i=au(r)>zo;function a(d,m,b,x){nwe(x,t,e,b,d,m)}function s(d,m){return xs(d)*xs(m)>r}function o(d){var m,b,x,E,T;return{lineStart:function(){E=x=!1,T=1},point:function(A,M){var F=[A,M],N,O=s(A,M),U=n?O?0:f(A,M):O?f(A+(A<0?Oa:-Oa),M):0;if(!m&&(E=x=O)&&d.lineStart(),O!==x&&(N=c(m,F),(!N||_S(m,N)||_S(F,N))&&(F[0]+=zo,F[1]+=zo,O=s(F[0],F[1]))),O!==x)T=0,O?(d.lineStart(),N=c(F,m),d.point(N[0],N[1])):(N=c(m,F),d.point(N[0],N[1]),d.lineEnd()),m=N;else if(i&&m&&n^O){var j;!(U&b)&&(j=c(F,m,!0))&&(T=0,n?(d.lineStart(),d.point(j[0][0],j[0][1]),d.point(j[1][0],j[1][1]),d.lineEnd()):(d.point(j[1][0],j[1][1]),d.lineEnd(),d.lineStart(),d.point(j[0][0],j[0][1])))}O&&(!m||!_S(m,F))&&d.point(F[0],F[1]),m=F,x=O,b=U},lineEnd:function(){x&&d.lineEnd(),m=null},clean:function(){return T|(E&&x)<<1}}}function c(d,m,b){var x=J0(d),E=J0(m),T=[1,0,0],A=gE(x,E),M=Ew(A,A),F=A[0],N=M-F*F;if(!N)return!b&&d;var O=r*M/N,U=-r*F/N,j=gE(T,A),H=Tw(T,O),W=Tw(A,U);i5(H,W);var X=j,oe=Ew(H,X),Q=Ew(X,X),G=oe*oe-Q*(Ew(H,H)-1);if(!(G<0)){var ae=__(G),se=Tw(X,(-oe-ae)/Q);if(i5(se,H),se=MR(se),!b)return se;var fe=d[0],_e=m[0],Le=d[1],ye=m[1],Te;_e<fe&&(Te=fe,fe=_e,_e=Te);var Ie=_e-fe,Me=au(Ie-Oa)<zo,de=Me||Ie<zo;if(!Me&&ye<Le&&(Te=Le,Le=ye,ye=Te),de?Me?Le+ye>0^se[1]<(au(se[0]-fe)<zo?Le:ye):Le<=se[1]&&se[1]<=ye:Ie>Oa^(fe<=se[0]&&se[0]<=_e)){var Se=Tw(X,(-oe+ae)/Q);return i5(Se,H),[se,MR(Se)]}}}function f(d,m){var b=n?t:Oa-t,x=0;return d<-b?x|=1:d>b&&(x|=2),m<-b?x|=4:m>b&&(x|=8),x}return yJ(s,o,a,n?[0,-t]:[-Oa,t-Oa])}function vJ(t){return function(e){var r=new NR;for(var n in t)r[n]=t[n];return r.stream=e,r}}function NR(){}NR.prototype={constructor:NR,point:function(t,e){this.stream.point(t,e)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};function _J(t,e,r){var n=e[1][0]-e[0][0],i=e[1][1]-e[0][1],a=t.clipExtent&&t.clipExtent();t.scale(150).translate([0,0]),a!=null&&t.clipExtent(null),twe(r,t.stream(U7));var s=U7.result(),o=Math.min(n/(s[1][0]-s[0][0]),i/(s[1][1]-s[0][1])),c=+e[0][0]+(n-o*(s[1][0]+s[0][0]))/2,f=+e[0][1]+(i-o*(s[1][1]+s[0][1]))/2;return a!=null&&t.clipExtent(a),t.scale(o*150).translate([c,f])}function mwe(t,e,r){return _J(t,[[0,0],e],r)}var $7=16,ywe=xs(30*Mf);function q7(t,e){return+e?_we(t,e):vwe(t)}function vwe(t){return vJ({point:function(e,r){e=t(e,r),this.stream.point(e[0],e[1])}})}function _we(t,e){function r(n,i,a,s,o,c,f,d,m,b,x,E,T,A){var M=f-n,F=d-i,N=M*M+F*F;if(N>4*e&&T--){var O=s+b,U=o+x,j=c+E,H=__(O*O+U*U+j*j),W=iy(j/=H),X=au(au(j)-1)<zo||au(a-m)<zo?(a+m)/2:K0(U,O),oe=t(X,W),Q=oe[0],G=oe[1],ae=Q-n,se=G-i,fe=F*ae-M*se;(fe*fe/N>e||au((M*ae+F*se)/N-.5)>.3||s*b+o*x+c*E<ywe)&&(r(n,i,a,s,o,c,Q,G,X,O/=H,U/=H,j,T,A),A.point(Q,G),r(Q,G,X,O,U,j,f,d,m,b,x,E,T,A))}}return function(n){var i,a,s,o,c,f,d,m,b,x,E,T,A={point:M,lineStart:F,lineEnd:O,polygonStart:function(){n.polygonStart(),A.lineStart=U},polygonEnd:function(){n.polygonEnd(),A.lineStart=F}};function M(W,X){W=t(W,X),n.point(W[0],W[1])}function F(){m=NaN,A.point=N,n.lineStart()}function N(W,X){var oe=J0([W,X]),Q=t(W,X);r(m,b,d,x,E,T,m=Q[0],b=Q[1],d=W,x=oe[0],E=oe[1],T=oe[2],$7,n),n.point(m,b)}function O(){A.point=M,n.lineEnd()}function U(){F(),A.point=j,A.lineEnd=H}function j(W,X){N(i=W,X),a=m,s=b,o=x,c=E,f=T,A.point=N}function H(){r(m,b,d,x,E,T,a,s,i,o,c,f,$7,n),A.lineEnd=O,O()}return A}}var bwe=vJ({point:function(t,e){this.stream.point(t*Mf,e*Mf)}});function xwe(t){return wwe(function(){return t})()}function wwe(t){var e,r=150,n=480,i=250,a,s,o=0,c=0,f=0,d=0,m=0,b,x,E=null,T=V7,A=null,M,F,N,O=j7,U=.5,j=q7(Q,U),H,W;function X(se){return se=x(se[0]*Mf,se[1]*Mf),[se[0]*r+a,s-se[1]*r]}function oe(se){return se=x.invert((se[0]-a)/r,(s-se[1])/r),se&&[se[0]*tg,se[1]*tg]}function Q(se,fe){return se=e(se,fe),[se[0]*r+a,s-se[1]*r]}X.stream=function(se){return H&&W===se?H:H=bwe(T(b,j(O(W=se))))},X.clipAngle=function(se){return arguments.length?(T=+se?gwe(E=se*Mf,6*Mf):(E=null,V7),ae()):E*tg},X.clipExtent=function(se){return arguments.length?(O=se==null?(A=M=F=N=null,j7):swe(A=+se[0][0],M=+se[0][1],F=+se[1][0],N=+se[1][1]),ae()):A==null?null:[[A,M],[F,N]]},X.scale=function(se){return arguments.length?(r=+se,G()):r},X.translate=function(se){return arguments.length?(n=+se[0],i=+se[1],G()):[n,i]},X.center=function(se){return arguments.length?(o=se[0]%360*Mf,c=se[1]%360*Mf,G()):[o*tg,c*tg]},X.rotate=function(se){return arguments.length?(f=se[0]%360*Mf,d=se[1]%360*Mf,m=se.length>2?se[2]%360*Mf:0,G()):[f*tg,d*tg,m*tg]},X.precision=function(se){return arguments.length?(j=q7(Q,U=se*se),ae()):__(U)},X.fitExtent=function(se,fe){return _J(X,se,fe)},X.fitSize=function(se,fe){return mwe(X,se,fe)};function G(){x=hJ(b=rwe(f,d,m),e);var se=e(o,c);return a=n-se[0]*r,s=i+se[1]*r,ae()}function ae(){return H=W=null,X}return function(){return e=t.apply(this,arguments),X.invert=e.invert&&oe,G()}}function bJ(t){return function(e,r){var n=xs(e),i=xs(r),a=t(n*i);return[a*i*ws(e),a*ws(r)]}}function xJ(t){return function(e,r){var n=__(e*e+r*r),i=t(n),a=ws(i),s=xs(i);return[K0(e*a,n*s),iy(n&&r*a/n)]}}var Swe=bJ(function(t){return __(2/(1+t))});Swe.invert=xJ(function(t){return 2*iy(t/2)});var wJ=bJ(function(t){return(t=fJ(t))&&t/ws(t)});wJ.invert=xJ(function(t){return t});function Ewe(){return xwe(wJ).scale(79.4188).clipAngle(180-.001)}function H7(t,e){return[t,e]}H7.invert=H7;var{BufferOp:Twe,GeoJSONReader:Cwe,GeoJSONWriter:Awe}=Q2e;function Iwe(t,e,r){r=r||{};var n=r.units||"kilometers",i=r.steps||8;if(!t)throw new Error("geojson is required");if(typeof r!="object")throw new Error("options must be an object");if(typeof i!="number")throw new Error("steps must be an number");if(e===void 0)throw new Error("radius is required");if(i<=0)throw new Error("steps must be greater than 0");var a=[];switch(t.type){case"GeometryCollection":return p3(t,function(s){var o=bS(s,e,n,i);o&&a.push(o)}),Ep(a);case"FeatureCollection":return w7(t,function(s){var o=bS(s,e,n,i);o&&w7(o,function(c){c&&a.push(c)})}),Ep(a)}return bS(t,e,n,i)}function bS(t,e,r,n){var i=t.properties||{},a=t.type==="Feature"?t.geometry:t;if(a.type==="GeometryCollection"){var s=[];return p3(t,function(T){var A=bS(T,e,r,n);A&&s.push(A)}),Ep(s)}var o=Pwe(a),c={type:a.type,coordinates:EJ(a.coordinates,o)},f=new Cwe,d=f.read(c),m=oJ(aN(e,r),"meters"),b=Twe.bufferOp(d,m,n),x=new Awe;if(b=x.write(b),!SJ(b.coordinates)){var E={type:b.type,coordinates:TJ(b.coordinates,o)};return ny(E,i)}}function SJ(t){return Array.isArray(t[0])?SJ(t[0]):isNaN(t[0])}function EJ(t,e){return typeof t[0]!="object"?e(t):t.map(function(r){return EJ(r,e)})}function TJ(t,e){return typeof t[0]!="object"?e.invert(t):t.map(function(r){return TJ(r,e)})}function Pwe(t){var e=Y2e(t).geometry.coordinates,r=[-e[0],-e[1]];return Ewe().rotate(r).scale(Ku)}function G7(t,e={}){let r=0,n=0,i=0;return Ty(t,function(a){r+=a[0],n+=a[1],i++},!0),Oc([r/i,n/i],e.properties)}var Iw={exports:{}},xS={exports:{}},kwe=xS.exports,W7;function Rwe(){return W7||(W7=1,(function(t,e){(function(r,n){t.exports=n()})(kwe,function(){function r(F,N,O,U,j){(function H(W,X,oe,Q,G){for(;Q>oe;){if(Q-oe>600){var ae=Q-oe+1,se=X-oe+1,fe=Math.log(ae),_e=.5*Math.exp(2*fe/3),Le=.5*Math.sqrt(fe*_e*(ae-_e)/ae)*(se-ae/2<0?-1:1),ye=Math.max(oe,Math.floor(X-se*_e/ae+Le)),Te=Math.min(Q,Math.floor(X+(ae-se)*_e/ae+Le));H(W,X,ye,Te,G)}var Ie=W[X],Me=oe,de=Q;for(n(W,oe,X),G(W[Q],Ie)>0&&n(W,oe,Q);Me<de;){for(n(W,Me,de),Me++,de--;G(W[Me],Ie)<0;)Me++;for(;G(W[de],Ie)>0;)de--}G(W[oe],Ie)===0?n(W,oe,de):n(W,++de,Q),de<=X&&(oe=de+1),X<=de&&(Q=de-1)}})(F,N,O||0,U||F.length-1,j||i)}function n(F,N,O){var U=F[N];F[N]=F[O],F[O]=U}function i(F,N){return F<N?-1:F>N?1:0}var a=function(F){F===void 0&&(F=9),this._maxEntries=Math.max(4,F),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),this.clear()};function s(F,N,O){if(!O)return N.indexOf(F);for(var U=0;U<N.length;U++)if(O(F,N[U]))return U;return-1}function o(F,N){c(F,0,F.children.length,N,F)}function c(F,N,O,U,j){j||(j=A(null)),j.minX=1/0,j.minY=1/0,j.maxX=-1/0,j.maxY=-1/0;for(var H=N;H<O;H++){var W=F.children[H];f(j,F.leaf?U(W):W)}return j}function f(F,N){return F.minX=Math.min(F.minX,N.minX),F.minY=Math.min(F.minY,N.minY),F.maxX=Math.max(F.maxX,N.maxX),F.maxY=Math.max(F.maxY,N.maxY),F}function d(F,N){return F.minX-N.minX}function m(F,N){return F.minY-N.minY}function b(F){return(F.maxX-F.minX)*(F.maxY-F.minY)}function x(F){return F.maxX-F.minX+(F.maxY-F.minY)}function E(F,N){return F.minX<=N.minX&&F.minY<=N.minY&&N.maxX<=F.maxX&&N.maxY<=F.maxY}function T(F,N){return N.minX<=F.maxX&&N.minY<=F.maxY&&N.maxX>=F.minX&&N.maxY>=F.minY}function A(F){return{children:F,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function M(F,N,O,U,j){for(var H=[N,O];H.length;)if(!((O=H.pop())-(N=H.pop())<=U)){var W=N+Math.ceil((O-N)/U/2)*U;r(F,W,N,O,j),H.push(N,W,W,O)}}return a.prototype.all=function(){return this._all(this.data,[])},a.prototype.search=function(F){var N=this.data,O=[];if(!T(F,N))return O;for(var U=this.toBBox,j=[];N;){for(var H=0;H<N.children.length;H++){var W=N.children[H],X=N.leaf?U(W):W;T(F,X)&&(N.leaf?O.push(W):E(F,X)?this._all(W,O):j.push(W))}N=j.pop()}return O},a.prototype.collides=function(F){var N=this.data;if(!T(F,N))return!1;for(var O=[];N;){for(var U=0;U<N.children.length;U++){var j=N.children[U],H=N.leaf?this.toBBox(j):j;if(T(F,H)){if(N.leaf||E(F,H))return!0;O.push(j)}}N=O.pop()}return!1},a.prototype.load=function(F){if(!F||!F.length)return this;if(F.length<this._minEntries){for(var N=0;N<F.length;N++)this.insert(F[N]);return this}var O=this._build(F.slice(),0,F.length-1,0);if(this.data.children.length)if(this.data.height===O.height)this._splitRoot(this.data,O);else{if(this.data.height<O.height){var U=this.data;this.data=O,O=U}this._insert(O,this.data.height-O.height-1,!0)}else this.data=O;return this},a.prototype.insert=function(F){return F&&this._insert(F,this.data.height-1),this},a.prototype.clear=function(){return this.data=A([]),this},a.prototype.remove=function(F,N){if(!F)return this;for(var O,U,j,H=this.data,W=this.toBBox(F),X=[],oe=[];H||X.length;){if(H||(H=X.pop(),U=X[X.length-1],O=oe.pop(),j=!0),H.leaf){var Q=s(F,H.children,N);if(Q!==-1)return H.children.splice(Q,1),X.push(H),this._condense(X),this}j||H.leaf||!E(H,W)?U?(O++,H=U.children[O],j=!1):H=null:(X.push(H),oe.push(O),O=0,U=H,H=H.children[0])}return this},a.prototype.toBBox=function(F){return F},a.prototype.compareMinX=function(F,N){return F.minX-N.minX},a.prototype.compareMinY=function(F,N){return F.minY-N.minY},a.prototype.toJSON=function(){return this.data},a.prototype.fromJSON=function(F){return this.data=F,this},a.prototype._all=function(F,N){for(var O=[];F;)F.leaf?N.push.apply(N,F.children):O.push.apply(O,F.children),F=O.pop();return N},a.prototype._build=function(F,N,O,U){var j,H=O-N+1,W=this._maxEntries;if(H<=W)return o(j=A(F.slice(N,O+1)),this.toBBox),j;U||(U=Math.ceil(Math.log(H)/Math.log(W)),W=Math.ceil(H/Math.pow(W,U-1))),(j=A([])).leaf=!1,j.height=U;var X=Math.ceil(H/W),oe=X*Math.ceil(Math.sqrt(W));M(F,N,O,oe,this.compareMinX);for(var Q=N;Q<=O;Q+=oe){var G=Math.min(Q+oe-1,O);M(F,Q,G,X,this.compareMinY);for(var ae=Q;ae<=G;ae+=X){var se=Math.min(ae+X-1,G);j.children.push(this._build(F,ae,se,U-1))}}return o(j,this.toBBox),j},a.prototype._chooseSubtree=function(F,N,O,U){for(;U.push(N),!N.leaf&&U.length-1!==O;){for(var j=1/0,H=1/0,W=void 0,X=0;X<N.children.length;X++){var oe=N.children[X],Q=b(oe),G=(ae=F,se=oe,(Math.max(se.maxX,ae.maxX)-Math.min(se.minX,ae.minX))*(Math.max(se.maxY,ae.maxY)-Math.min(se.minY,ae.minY))-Q);G<H?(H=G,j=Q<j?Q:j,W=oe):G===H&&Q<j&&(j=Q,W=oe)}N=W||N.children[0]}var ae,se;return N},a.prototype._insert=function(F,N,O){var U=O?F:this.toBBox(F),j=[],H=this._chooseSubtree(U,this.data,N,j);for(H.children.push(F),f(H,U);N>=0&&j[N].children.length>this._maxEntries;)this._split(j,N),N--;this._adjustParentBBoxes(U,j,N)},a.prototype._split=function(F,N){var O=F[N],U=O.children.length,j=this._minEntries;this._chooseSplitAxis(O,j,U);var H=this._chooseSplitIndex(O,j,U),W=A(O.children.splice(H,O.children.length-H));W.height=O.height,W.leaf=O.leaf,o(O,this.toBBox),o(W,this.toBBox),N?F[N-1].children.push(W):this._splitRoot(O,W)},a.prototype._splitRoot=function(F,N){this.data=A([F,N]),this.data.height=F.height+1,this.data.leaf=!1,o(this.data,this.toBBox)},a.prototype._chooseSplitIndex=function(F,N,O){for(var U,j,H,W,X,oe,Q,G=1/0,ae=1/0,se=N;se<=O-N;se++){var fe=c(F,0,se,this.toBBox),_e=c(F,se,O,this.toBBox),Le=(j=fe,H=_e,W=void 0,X=void 0,oe=void 0,Q=void 0,W=Math.max(j.minX,H.minX),X=Math.max(j.minY,H.minY),oe=Math.min(j.maxX,H.maxX),Q=Math.min(j.maxY,H.maxY),Math.max(0,oe-W)*Math.max(0,Q-X)),ye=b(fe)+b(_e);Le<G?(G=Le,U=se,ae=ye<ae?ye:ae):Le===G&&ye<ae&&(ae=ye,U=se)}return U||O-N},a.prototype._chooseSplitAxis=function(F,N,O){var U=F.leaf?this.compareMinX:d,j=F.leaf?this.compareMinY:m;this._allDistMargin(F,N,O,U)<this._allDistMargin(F,N,O,j)&&F.children.sort(U)},a.prototype._allDistMargin=function(F,N,O,U){F.children.sort(U);for(var j=this.toBBox,H=c(F,0,N,j),W=c(F,O-N,O,j),X=x(H)+x(W),oe=N;oe<O-N;oe++){var Q=F.children[oe];f(H,F.leaf?j(Q):Q),X+=x(H)}for(var G=O-N-1;G>=N;G--){var ae=F.children[G];f(W,F.leaf?j(ae):ae),X+=x(W)}return X},a.prototype._adjustParentBBoxes=function(F,N,O){for(var U=O;U>=0;U--)f(N[U],F)},a.prototype._condense=function(F){for(var N=F.length-1,O=void 0;N>=0;N--)F[N].children.length===0?N>0?(O=F[N-1].children).splice(O.indexOf(F[N]),1):this.clear():o(F[N],this.toBBox)},a})})(xS)),xS.exports}class Mwe{constructor(e=[],r=Dwe){if(this.data=e,this.length=this.data.length,this.compare=r,this.length>0)for(let n=(this.length>>1)-1;n>=0;n--)this._down(n)}push(e){this.data.push(e),this.length++,this._up(this.length-1)}pop(){if(this.length===0)return;const e=this.data[0],r=this.data.pop();return this.length--,this.length>0&&(this.data[0]=r,this._down(0)),e}peek(){return this.data[0]}_up(e){const{data:r,compare:n}=this,i=r[e];for(;e>0;){const a=e-1>>1,s=r[a];if(n(i,s)>=0)break;r[e]=s,e=a}r[e]=i}_down(e){const{data:r,compare:n}=this,i=this.length>>1,a=r[e];for(;e<i;){let s=(e<<1)+1,o=r[s];const c=s+1;if(c<this.length&&n(r[c],o)<0&&(s=c,o=r[c]),n(o,a)>=0)break;r[e]=o,e=s}r[e]=a}}function Dwe(t,e){return t<e?-1:t>e?1:0}const Owe=Object.freeze(Object.defineProperty({__proto__:null,default:Mwe},Symbol.toStringTag,{value:"Module"})),Nwe=HW(Owe);var u1={exports:{}},o5,X7;function Lwe(){return X7||(X7=1,o5=function(e,r,n,i){var a=e[0],s=e[1],o=!1;n===void 0&&(n=0),i===void 0&&(i=r.length);for(var c=(i-n)/2,f=0,d=c-1;f<c;d=f++){var m=r[n+f*2+0],b=r[n+f*2+1],x=r[n+d*2+0],E=r[n+d*2+1],T=b>s!=E>s&&a<(x-m)*(s-b)/(E-b)+m;T&&(o=!o)}return o}),o5}var s5,Y7;function Fwe(){return Y7||(Y7=1,s5=function(e,r,n,i){var a=e[0],s=e[1],o=!1;n===void 0&&(n=0),i===void 0&&(i=r.length);for(var c=i-n,f=0,d=c-1;f<c;d=f++){var m=r[f+n][0],b=r[f+n][1],x=r[d+n][0],E=r[d+n][1],T=b>s!=E>s&&a<(x-m)*(s-b)/(E-b)+m;T&&(o=!o)}return o}),s5}var Z7;function Bwe(){if(Z7)return u1.exports;Z7=1;var t=Lwe(),e=Fwe();return u1.exports=function(n,i,a,s){return i.length>0&&Array.isArray(i[0])?e(n,i,a,s):t(n,i,a,s)},u1.exports.nested=e,u1.exports.flat=t,u1.exports}var j1={exports:{}},zwe=j1.exports,K7;function jwe(){return K7||(K7=1,(function(t,e){(function(r,n){n(e)})(zwe,function(r){const i=33306690738754706e-32;function a(T,A,M,F,N){let O,U,j,H,W=A[0],X=F[0],oe=0,Q=0;X>W==X>-W?(O=W,W=A[++oe]):(O=X,X=F[++Q]);let G=0;if(oe<T&&Q<M)for(X>W==X>-W?(j=O-((U=W+O)-W),W=A[++oe]):(j=O-((U=X+O)-X),X=F[++Q]),O=U,j!==0&&(N[G++]=j);oe<T&&Q<M;)X>W==X>-W?(j=O-((U=O+W)-(H=U-O))+(W-H),W=A[++oe]):(j=O-((U=O+X)-(H=U-O))+(X-H),X=F[++Q]),O=U,j!==0&&(N[G++]=j);for(;oe<T;)j=O-((U=O+W)-(H=U-O))+(W-H),W=A[++oe],O=U,j!==0&&(N[G++]=j);for(;Q<M;)j=O-((U=O+X)-(H=U-O))+(X-H),X=F[++Q],O=U,j!==0&&(N[G++]=j);return O===0&&G!==0||(N[G++]=O),G}function s(T){return new Float64Array(T)}const o=33306690738754716e-32,c=22204460492503146e-32,f=11093356479670487e-47,d=s(4),m=s(8),b=s(12),x=s(16),E=s(4);r.orient2d=function(T,A,M,F,N,O){const U=(A-O)*(M-N),j=(T-N)*(F-O),H=U-j;if(U===0||j===0||U>0!=j>0)return H;const W=Math.abs(U+j);return Math.abs(H)>=o*W?H:-(function(X,oe,Q,G,ae,se,fe){let _e,Le,ye,Te,Ie,Me,de,Se,we,De,Fe,Xe,Be,st,Qe,it,be,Ot;const at=X-ae,$e=Q-ae,Xt=oe-se,$t=G-se;Ie=(Qe=(Se=at-(de=(Me=134217729*at)-(Me-at)))*(De=$t-(we=(Me=134217729*$t)-(Me-$t)))-((st=at*$t)-de*we-Se*we-de*De))-(Fe=Qe-(be=(Se=Xt-(de=(Me=134217729*Xt)-(Me-Xt)))*(De=$e-(we=(Me=134217729*$e)-(Me-$e)))-((it=Xt*$e)-de*we-Se*we-de*De))),d[0]=Qe-(Fe+Ie)+(Ie-be),Ie=(Be=st-((Xe=st+Fe)-(Ie=Xe-st))+(Fe-Ie))-(Fe=Be-it),d[1]=Be-(Fe+Ie)+(Ie-it),Ie=(Ot=Xe+Fe)-Xe,d[2]=Xe-(Ot-Ie)+(Fe-Ie),d[3]=Ot;let cr=(function(Cr,Er){let Jt=Er[0];for(let ot=1;ot<Cr;ot++)Jt+=Er[ot];return Jt})(4,d),_t=c*fe;if(cr>=_t||-cr>=_t||(_e=X-(at+(Ie=X-at))+(Ie-ae),ye=Q-($e+(Ie=Q-$e))+(Ie-ae),Le=oe-(Xt+(Ie=oe-Xt))+(Ie-se),Te=G-($t+(Ie=G-$t))+(Ie-se),_e===0&&Le===0&&ye===0&&Te===0)||(_t=f*fe+i*Math.abs(cr),(cr+=at*Te+$t*_e-(Xt*ye+$e*Le))>=_t||-cr>=_t))return cr;Ie=(Qe=(Se=_e-(de=(Me=134217729*_e)-(Me-_e)))*(De=$t-(we=(Me=134217729*$t)-(Me-$t)))-((st=_e*$t)-de*we-Se*we-de*De))-(Fe=Qe-(be=(Se=Le-(de=(Me=134217729*Le)-(Me-Le)))*(De=$e-(we=(Me=134217729*$e)-(Me-$e)))-((it=Le*$e)-de*we-Se*we-de*De))),E[0]=Qe-(Fe+Ie)+(Ie-be),Ie=(Be=st-((Xe=st+Fe)-(Ie=Xe-st))+(Fe-Ie))-(Fe=Be-it),E[1]=Be-(Fe+Ie)+(Ie-it),Ie=(Ot=Xe+Fe)-Xe,E[2]=Xe-(Ot-Ie)+(Fe-Ie),E[3]=Ot;const gr=a(4,d,4,E,m);Ie=(Qe=(Se=at-(de=(Me=134217729*at)-(Me-at)))*(De=Te-(we=(Me=134217729*Te)-(Me-Te)))-((st=at*Te)-de*we-Se*we-de*De))-(Fe=Qe-(be=(Se=Xt-(de=(Me=134217729*Xt)-(Me-Xt)))*(De=ye-(we=(Me=134217729*ye)-(Me-ye)))-((it=Xt*ye)-de*we-Se*we-de*De))),E[0]=Qe-(Fe+Ie)+(Ie-be),Ie=(Be=st-((Xe=st+Fe)-(Ie=Xe-st))+(Fe-Ie))-(Fe=Be-it),E[1]=Be-(Fe+Ie)+(Ie-it),Ie=(Ot=Xe+Fe)-Xe,E[2]=Xe-(Ot-Ie)+(Fe-Ie),E[3]=Ot;const mr=a(gr,m,4,E,b);Ie=(Qe=(Se=_e-(de=(Me=134217729*_e)-(Me-_e)))*(De=Te-(we=(Me=134217729*Te)-(Me-Te)))-((st=_e*Te)-de*we-Se*we-de*De))-(Fe=Qe-(be=(Se=Le-(de=(Me=134217729*Le)-(Me-Le)))*(De=ye-(we=(Me=134217729*ye)-(Me-ye)))-((it=Le*ye)-de*we-Se*we-de*De))),E[0]=Qe-(Fe+Ie)+(Ie-be),Ie=(Be=st-((Xe=st+Fe)-(Ie=Xe-st))+(Fe-Ie))-(Fe=Be-it),E[1]=Be-(Fe+Ie)+(Ie-it),Ie=(Ot=Xe+Fe)-Xe,E[2]=Xe-(Ot-Ie)+(Fe-Ie),E[3]=Ot;const ar=a(mr,b,4,E,x);return x[ar-1]})(T,A,M,F,N,O,W)},r.orient2dfast=function(T,A,M,F,N,O){return(A-O)*(M-N)-(T-N)*(F-O)},Object.defineProperty(r,"__esModule",{value:!0})})})(j1,j1.exports)),j1.exports}var J7;function Uwe(){if(J7)return Iw.exports;J7=1;var t=Rwe(),e=Nwe,r=Bwe(),n=jwe().orient2d;e.default&&(e=e.default),Iw.exports=i,Iw.exports.default=i;function i(O,U,j){U=Math.max(0,U===void 0?2:U),j=j||0;var H=x(O),W=new t(16);W.toBBox=function(de){return{minX:de[0],minY:de[1],maxX:de[0],maxY:de[1]}},W.compareMinX=function(de,Se){return de[0]-Se[0]},W.compareMinY=function(de,Se){return de[1]-Se[1]},W.load(O);for(var X=[],oe=0,Q;oe<H.length;oe++){var G=H[oe];W.remove(G),Q=E(G,Q),X.push(Q)}var ae=new t(16);for(oe=0;oe<X.length;oe++)ae.insert(b(X[oe]));for(var se=U*U,fe=j*j;X.length;){var _e=X.shift(),Le=_e.p,ye=_e.next.p,Te=T(Le,ye);if(!(Te<fe)){var Ie=Te/se;G=a(W,_e.prev.p,Le,ye,_e.next.next.p,Ie,ae),G&&Math.min(T(G,Le),T(G,ye))<=Ie&&(X.push(_e),X.push(E(G,_e)),W.remove(G),ae.remove(_e),ae.insert(b(_e)),ae.insert(b(_e.next)))}}_e=Q;var Me=[];do Me.push(_e.p),_e=_e.next;while(_e!==Q);return Me.push(_e.p),Me}function a(O,U,j,H,W,X,oe){for(var Q=new e([],s),G=O.data;G;){for(var ae=0;ae<G.children.length;ae++){var se=G.children[ae],fe=G.leaf?A(se,j,H):o(j,H,se);fe>X||Q.push({node:se,dist:fe})}for(;Q.length&&!Q.peek().node.children;){var _e=Q.pop(),Le=_e.node,ye=A(Le,U,j),Te=A(Le,H,W);if(_e.dist<ye&&_e.dist<Te&&f(j,Le,oe)&&f(H,Le,oe))return Le}G=Q.pop(),G&&(G=G.node)}return null}function s(O,U){return O.dist-U.dist}function o(O,U,j){if(c(O,j)||c(U,j))return 0;var H=M(O[0],O[1],U[0],U[1],j.minX,j.minY,j.maxX,j.minY);if(H===0)return 0;var W=M(O[0],O[1],U[0],U[1],j.minX,j.minY,j.minX,j.maxY);if(W===0)return 0;var X=M(O[0],O[1],U[0],U[1],j.maxX,j.minY,j.maxX,j.maxY);if(X===0)return 0;var oe=M(O[0],O[1],U[0],U[1],j.minX,j.maxY,j.maxX,j.maxY);return oe===0?0:Math.min(H,W,X,oe)}function c(O,U){return O[0]>=U.minX&&O[0]<=U.maxX&&O[1]>=U.minY&&O[1]<=U.maxY}function f(O,U,j){for(var H=Math.min(O[0],U[0]),W=Math.min(O[1],U[1]),X=Math.max(O[0],U[0]),oe=Math.max(O[1],U[1]),Q=j.search({minX:H,minY:W,maxX:X,maxY:oe}),G=0;G<Q.length;G++)if(m(Q[G].p,Q[G].next.p,O,U))return!1;return!0}function d(O,U,j){return n(O[0],O[1],U[0],U[1],j[0],j[1])}function m(O,U,j,H){return O!==H&&U!==j&&d(O,U,j)>0!=d(O,U,H)>0&&d(j,H,O)>0!=d(j,H,U)>0}function b(O){var U=O.p,j=O.next.p;return O.minX=Math.min(U[0],j[0]),O.minY=Math.min(U[1],j[1]),O.maxX=Math.max(U[0],j[0]),O.maxY=Math.max(U[1],j[1]),O}function x(O){for(var U=O[0],j=O[0],H=O[0],W=O[0],X=0;X<O.length;X++){var oe=O[X];oe[0]<U[0]&&(U=oe),oe[0]>H[0]&&(H=oe),oe[1]<j[1]&&(j=oe),oe[1]>W[1]&&(W=oe)}var Q=[U,j,H,W],G=Q.slice();for(X=0;X<O.length;X++)r(O[X],Q)||G.push(O[X]);return N(G)}function E(O,U){var j={p:O,prev:null,next:null,minX:0,minY:0,maxX:0,maxY:0};return U?(j.next=U.next,j.prev=U,U.next.prev=j,U.next=j):(j.prev=j,j.next=j),j}function T(O,U){var j=O[0]-U[0],H=O[1]-U[1];return j*j+H*H}function A(O,U,j){var H=U[0],W=U[1],X=j[0]-H,oe=j[1]-W;if(X!==0||oe!==0){var Q=((O[0]-H)*X+(O[1]-W)*oe)/(X*X+oe*oe);Q>1?(H=j[0],W=j[1]):Q>0&&(H+=X*Q,W+=oe*Q)}return X=O[0]-H,oe=O[1]-W,X*X+oe*oe}function M(O,U,j,H,W,X,oe,Q){var G=j-O,ae=H-U,se=oe-W,fe=Q-X,_e=O-W,Le=U-X,ye=G*G+ae*ae,Te=G*se+ae*fe,Ie=se*se+fe*fe,Me=G*_e+ae*Le,de=se*_e+fe*Le,Se=ye*Ie-Te*Te,we,De,Fe,Xe,Be=Se,st=Se;Se===0?(De=0,Be=1,Xe=de,st=Ie):(De=Te*de-Ie*Me,Xe=ye*de-Te*Me,De<0?(De=0,Xe=de,st=Ie):De>Be&&(De=Be,Xe=de+Te,st=Ie)),Xe<0?(Xe=0,-Me<0?De=0:-Me>ye?De=Be:(De=-Me,Be=ye)):Xe>st&&(Xe=st,-Me+Te<0?De=0:-Me+Te>ye?De=Be:(De=-Me+Te,Be=ye)),we=De===0?0:De/Be,Fe=Xe===0?0:Xe/st;var Qe=(1-we)*O+we*j,it=(1-we)*U+we*H,be=(1-Fe)*W+Fe*oe,Ot=(1-Fe)*X+Fe*Q,at=be-Qe,$e=Ot-it;return at*at+$e*$e}function F(O,U){return O[0]===U[0]?O[1]-U[1]:O[0]-U[0]}function N(O){O.sort(F);for(var U=[],j=0;j<O.length;j++){for(;U.length>=2&&d(U[U.length-2],U[U.length-1],O[j])<=0;)U.pop();U.push(O[j])}for(var H=[],W=O.length-1;W>=0;W--){for(;H.length>=2&&d(H[H.length-2],H[H.length-1],O[W])<=0;)H.pop();H.push(O[W])}return H.pop(),U.pop(),U.concat(H)}return Iw.exports}var Vwe=Uwe();const $we=Id(Vwe);function qwe(t,e={}){e.concavity=e.concavity||1/0;const r=[];if(Ty(t,i=>{r.push([i[0],i[1]])}),!r.length)return null;const n=$we(r,e.concavity);return n.length>3?h3([n]):null}function uN(t,e={}){switch(lJ(t)){case"Point":return Oc(Pg(t),e.properties);case"Polygon":var r=[];Ty(t,function(O){r.push(O)});var n=G7(t,{properties:e.properties}),i=n.geometry.coordinates,a=0,s=0,o=0,c,f,d,m,b,x,E,T,A=r.map(function(O){return[O[0]-i[0],O[1]-i[1]]});for(c=0;c<r.length-1;c++)f=A[c],m=f[0],x=f[1],d=A[c+1],b=d[0],E=d[1],T=m*E-b*x,o+=T,a+=(m+b)*T,s+=(x+E)*T;if(o===0)return n;var M=o*.5,F=1/(6*M);return Oc([i[0]+F*a,i[1]+F*s],e.properties);default:var N=qwe(t);return N?uN(N,{properties:e.properties}):G7(t,{properties:e.properties})}}function CJ(t,e,r={}){const n=r.steps||64,i=r.properties?r.properties:!Array.isArray(t)&&t.type==="Feature"&&t.properties?t.properties:{},a=[];for(let s=0;s<n;s++)a.push(Z0(t,e,s*-360/n,r).geometry.coordinates);return a.push(a[0]),h3([a],i)}function Hwe(t){if(!t)throw new Error("geojson is required");switch(t.type){case"Feature":return AJ(t);case"FeatureCollection":return Gwe(t);case"Point":case"LineString":case"Polygon":case"MultiPoint":case"MultiLineString":case"MultiPolygon":case"GeometryCollection":return cN(t);default:throw new Error("unknown GeoJSON type")}}function AJ(t){const e={type:"Feature"};return Object.keys(t).forEach(r=>{switch(r){case"type":case"properties":case"geometry":return;default:e[r]=t[r]}}),e.properties=IJ(t.properties),t.geometry==null?e.geometry=null:e.geometry=cN(t.geometry),e}function IJ(t){const e={};return t&&Object.keys(t).forEach(r=>{const n=t[r];typeof n=="object"?n===null?e[r]=null:Array.isArray(n)?e[r]=n.map(i=>i):e[r]=IJ(n):e[r]=n}),e}function Gwe(t){const e={type:"FeatureCollection"};return Object.keys(t).forEach(r=>{switch(r){case"type":case"features":return;default:e[r]=t[r]}}),e.features=t.features.map(r=>AJ(r)),e}function cN(t){const e={type:t.type};return t.bbox&&(e.bbox=t.bbox),t.type==="GeometryCollection"?(e.geometries=t.geometries.map(r=>cN(r)),e):(e.coordinates=PJ(t.coordinates),e)}function PJ(t){const e=t;return typeof e[0]!="object"?e.slice():e.map(r=>PJ(r))}function Wwe(t){return t}function Xwe(t){if(t==null)return Wwe;var e,r,n=t.scale[0],i=t.scale[1],a=t.translate[0],s=t.translate[1];return function(o,c){c||(e=r=0);var f=2,d=o.length,m=new Array(d);for(m[0]=(e+=o[0])*n+a,m[1]=(r+=o[1])*i+s;f<d;)m[f]=o[f],++f;return m}}function Ywe(t,e){for(var r,n=t.length,i=n-e;i<--n;)r=t[i],t[i++]=t[n],t[n]=r}function Zwe(t,e){return typeof e=="string"&&(e=t.objects[e]),e.type==="GeometryCollection"?{type:"FeatureCollection",features:e.geometries.map(function(r){return Q7(t,r)})}:Q7(t,e)}function Q7(t,e){var r=e.id,n=e.bbox,i=e.properties==null?{}:e.properties,a=Kwe(t,e);return r==null&&n==null?{type:"Feature",properties:i,geometry:a}:n==null?{type:"Feature",id:r,properties:i,geometry:a}:{type:"Feature",id:r,bbox:n,properties:i,geometry:a}}function Kwe(t,e){var r=Xwe(t.transform),n=t.arcs;function i(d,m){m.length&&m.pop();for(var b=n[d<0?~d:d],x=0,E=b.length;x<E;++x)m.push(r(b[x],x));d<0&&Ywe(m,E)}function a(d){return r(d)}function s(d){for(var m=[],b=0,x=d.length;b<x;++b)i(d[b],m);return m.length<2&&m.push(m[0]),m}function o(d){for(var m=s(d);m.length<4;)m.push(m[0]);return m}function c(d){return d.map(o)}function f(d){var m=d.type,b;switch(m){case"GeometryCollection":return{type:m,geometries:d.geometries.map(f)};case"Point":b=a(d.coordinates);break;case"MultiPoint":b=d.coordinates.map(a);break;case"LineString":b=s(d.arcs);break;case"MultiLineString":b=d.arcs.map(s);break;case"Polygon":b=c(d.arcs);break;case"MultiPolygon":b=d.arcs.map(c);break;default:return null}return{type:m,coordinates:b}}return f(e)}function Qb(t,e={}){return C2e(t,(r,n)=>{const i=n.geometry.coordinates;return r+d3(i[0],i[1],e)},0)}function Jwe(t,e,r,n,i={}){const a=i.steps||64,s=ej(r),o=ej(n),c=!Array.isArray(t)&&t.type==="Feature"?t.properties:{};if(s===o)return Su(CJ(t,e,i).geometry.coordinates[0],c);const f=s,d=s<o?o:o+360;let m=f;const b=[];let x=0;const E=(d-f)/a;for(;m<=d;)b.push(Z0(t,e,m,i).geometry.coordinates),x++,m=f+x*E;return Su(b,c)}function ej(t){let e=t%360;return e<0&&(e+=360),e}function Qwe(t,e,r,n){if(n=n||{},!oN(n))throw new Error("options is invalid");var i,a=[];if(t.type==="Feature")i=t.geometry.coordinates;else if(t.type==="LineString")i=t.coordinates;else throw new Error("input must be a LineString Feature or Geometry");for(var s=i.length,o=0,c,f,d,m=0;m<i.length&&!(e>=o&&m===i.length-1);m++){if(o>e&&a.length===0){if(c=e-o,!c)return a.push(i[m]),Su(a);f=Zb(i[m],i[m-1])-180,d=Z0(i[m],c,f,n),a.push(d.geometry.coordinates)}if(o>=r)return c=r-o,c?(f=Zb(i[m],i[m-1])-180,d=Z0(i[m],c,f,n),a.push(d.geometry.coordinates),Su(a)):(a.push(i[m]),Su(a));if(o>=e&&a.push(i[m]),m===i.length-1)return Su(a);o+=d3(i[m],i[m+1],n)}if(o<e&&i.length===s)throw new Error("Start position is beyond line");var b=i[i.length-1];return Su([b,b])}function eSe(t,e,r){if(r=r||{},!oN(r))throw new Error("options is invalid");var n=r.units,i=r.reverse;if(!t)throw new Error("geojson is required");if(e<=0)throw new Error("segmentLength must be greater than 0");var a=[];return sN(t,function(s){i&&(s.geometry.coordinates=s.geometry.coordinates.reverse()),tSe(s,e,n,function(o){a.push(o)})}),Ep(a)}function tSe(t,e,r,n){var i=Qb(t,{units:r});if(i<=e)return n(t);var a=i/e;Number.isInteger(a)||(a=Math.floor(a)+1);for(var s=0;s<a;s++){var o=Qwe(t,e*s,e*(s+1),{units:r});n(o,s)}}function vE(t){var e=t[0],r=t[1];return[r[0]-e[0],r[1]-e[1]]}function LR(t,e){return t[0]*e[1]-e[0]*t[1]}function rSe(t,e){return[t[0]+e[0],t[1]+e[1]]}function nSe(t,e){return[t[0]-e[0],t[1]-e[1]]}function iSe(t,e){return[t*e[0],t*e[1]]}function aSe(t,e){var r=t[0],n=vE(t),i=e[0],a=vE(e),s=LR(n,a),o=nSe(i,r),c=LR(o,a),f=c/s,d=rSe(r,iSe(f,n));return d}function oSe(t,e){var r=vE(t),n=vE(e);return LR(r,n)===0}function sSe(t,e){return oSe(t,e)?!1:aSe(t,e)}function lSe(t,e,r){if(r=r||{},!oN(r))throw new Error("options is invalid");var n=r.units;if(!t)throw new Error("geojson is required");if(e==null||isNaN(e))throw new Error("distance is required");var i=lJ(t),a=t.properties;switch(i){case"LineString":return tj(t,e,n);case"MultiLineString":var s=[];return sN(t,function(o){s.push(tj(o,e,n).geometry.coordinates)}),b2e(s,a);default:throw new Error("geometry "+i+" is not supported")}}function tj(t,e,r){var n=[],i=x2e(e,r),a=sJ(t),s=[];return a.forEach(function(o,c){if(c!==a.length-1){var f=uSe(o,a[c+1],i);if(n.push(f),c>0){var d=n[c-1],m=sSe(f,d);m!==!1&&(d[1]=m,f[0]=m),s.push(d[0]),c===a.length-2&&(s.push(f[0]),s.push(f[1]))}a.length===2&&(s.push(f[0]),s.push(f[1]))}}),Su(s,t.properties)}function uSe(t,e,r){var n=Math.sqrt((t[0]-e[0])*(t[0]-e[0])+(t[1]-e[1])*(t[1]-e[1])),i=t[0]+r*(e[1]-t[1])/n,a=e[0]+r*(e[1]-t[1])/n,s=t[1]+r*(t[0]-e[0])/n,o=e[1]+r*(t[0]-e[0])/n;return[[i,s],[a,o]]}function rj(t,e={}){return cSe(t,"mercator",e)}function cSe(t,e,r={}){r=r||{};var n=r.mutate;if(!t)throw new Error("geojson is required");return Array.isArray(t)&&kR(t[0])?t=nj(t):(n!==!0&&(t=Hwe(t)),Ty(t,function(i){var a=nj(i);i[0]=a[0],i[1]=a[1]})),t}function nj(t){var e=Math.PI/180,r=6378137,n=20037508342789244e-9,i=Math.abs(t[0])<=180?t[0]:t[0]-fSe(t[0])*360,a=[r*i*e,r*Math.log(Math.tan(Math.PI*.25+.5*t[1]*e))];return a[0]>n&&(a[0]=n),a[0]<-n&&(a[0]=-n),a[1]>n&&(a[1]=n),a[1]<-n&&(a[1]=-n),a}function fSe(t){return t<0?-1:t>0?1:0}function hSe(t){const r=window.getComputedStyle(t,null).getPropertyValue("transform");let n=0;if(r!=="none"){const i=r.split("(")[1].split(")")[0].split(","),a=parseFloat(i[0]),s=parseFloat(i[1]);n=Math.round(Math.atan2(s,a)*(180/Math.PI))}return n<0?n+360:n}function Pw(t,e,r){const n=getComputedStyle(t),i=[e[0]-r[0],e[1]-r[1]],a=new DOMMatrixReadOnly(n.transform);return[i[0]*a.a+i[1]*a.c+a.e+r[0],i[0]*a.b+i[1]*a.d+a.f+r[1]]}const ij=10;function kw(t,e){const r=e.unproject(t),n=e.unproject([t[0]+ij,t[1]]),i=r.distanceTo(n);return ij/i}function FR(t){const e=HT({mapId:t.mapId,watch:{layers:!1,viewport:!0}}),r=te.useRef(null),n=te.useRef(null),i=te.useRef(null),a=te.useRef(document.querySelector(".mapContainer")),s=va({mapId:t.mapId});te.useEffect(()=>{if(!e?.viewport?.zoom||!s.map)return;const f=Math.round(s.map.map._container.clientWidth/2),d=Math.round(s.map.map._container.clientHeight/2);if(!t.options.scale){const m=1/kw([f,d],s.map.map);t.setOptions(b=>({...b,scale:[m,m]}))}if(!t.options.center){const m=s.map.map.unproject([f,d]);t.setOptions(b=>({...b,center:[m.lng,m.lat]}))}},[s.map,e.viewport?.zoom]),te.useEffect(()=>{if(!s.map)return;s.map.map.setPitch(0);const f=s.map.map.getMaxPitch();return s.map.map.setMaxPitch(0),()=>{s.map?.map.setMaxPitch(f)}},[s.map]);const o=te.useMemo(()=>t.options.orientation==="portrait"?[t.options.width/2,t.options.height/2]:[t.options.height/2,t.options.width/2],[t.options.orientation,t.options.width,t.options.height]),c=te.useMemo(()=>{if(!s.map||!t.options.scale)return"none";const f=s.map.map.project(t.options.center),d=f.x,m=f.y,b=t.options.scale[0]*kw([d,m],s.map.map),x=e?.viewport?.bearing?e.viewport?.bearing:0,E=`translate(${Math.floor(f.x-o[0])}px,${Math.floor(f.y-o[1])}px) rotate(${t.options.rotate-x}deg) scale(${b},${b})`;return r.current&&(r.current.style.transform=E),E},[s.map,e.viewport,t.options.scale,t.options.rotate,t.options.center,o]);return te.useEffect(()=>{i.current?.updateTarget()},[c]),te.useEffect(()=>{if(!s.map||!t.options.center||!t.options.fixedScale||typeof t.options.fixedScale<"u"&&n.current===t.options.fixedScale)return;n.current=t.options.fixedScale;const f=Oc(t.options.center),d=t.options.fixedScale*(t.options.width/1e3),x=Z0(f,d,90,{units:"meters"}),E=s.map.map.project(f.geometry.coordinates),T=s.map.map.project(x.geometry.coordinates),A=Math.round(T.x-E.x)/t.options.width*(1/kw([E.x,E.y],s.map.map));t.setOptions(M=>({...M,scale:[A,A]}))},[s.map,t.options.width,t.options.center,t.options.fixedScale]),te.useEffect(()=>{if(r.current&&s.map){let f=t.options.width,d=t.options.height;t.options.orientation==="portrait"?(r.current.style.width=t.options.width+"px",r.current.style.height=t.options.height+"px"):(r.current.style.width=t.options.height+"px",r.current.style.height=t.options.width+"px",f=t.options.height,d=t.options.width),i.current?.updateTarget();const m=s.map.map.unproject(Pw(r.current,[0,0],o)),b=s.map.map.unproject(Pw(r.current,[f,0],o)),x=s.map.map.unproject(Pw(r.current,[0,d],o)),E=s.map.map.unproject(Pw(r.current,[f,d],o)),T={type:"Feature",bbox:[m.lng,m.lat,E.lng,E.lat],geometry:{type:"Polygon",coordinates:[[[m.lng,m.lat],[b.lng,b.lat],[E.lng,E.lat],[x.lng,x.lat],[m.lng,m.lat]]]},properties:{bearing:hSe(r.current)}};t.geojsonRef.current=T}},[s,c,t.options.orientation,t.geojsonRef,e,r.current,o]),a.current?P1.createPortal(J.jsxs(J.Fragment,{children:[J.jsx("div",{className:"target",ref:r,style:{transform:c,transformOrigin:"center center"}}),J.jsx(_2e,{ref:i,target:r,container:null,origin:!0,keepRatio:!0,draggable:!0,onDrag:f=>{if(s.map){let d=f.transform.split("translate(");d=d[1].split("px)")[0].split("px, ");const m=s.map?.map.unproject([parseInt(d[0])+o[0],parseInt(d[1])+o[1]]);t.setOptions(b=>({...b,center:[m.lng,m.lat]}))}},scalable:!t.options.fixedScale,onScale:f=>{if(s.map){let d=f.drag.transform.split("scale(");d=d[1].split(")")[0].split(", ");const m=s.map.map.project(t.options.center),b=m.x,x=m.y,E=parseFloat(d[0])*(1/kw([b,x],s.map.map));t.setOptions(T=>({...T,scale:[E,E]}))}},rotatable:!0,onRotate:f=>{if(s.map&&e.viewport){const m=f.drag.transform.split("rotate(")[1].split("deg)")[0],b=e?.viewport?.bearing?e.viewport.bearing:0;t.setOptions(x=>({...x,rotate:parseFloat(m)+b}))}}})]}),a.current):J.jsx(J.Fragment,{})}try{FR.displayName="PdfPreview",FR.__docgenInfo={description:"PdfPreview component renders a transformable (drag, scale, rotate) preview of the desired export or print content",displayName:"PdfPreview",props:{mapId:{defaultValue:null,description:"Id of the target MapLibre instance in mapContext",name:"mapId",required:!1,type:{name:"string | undefined"}},geojsonRef:{defaultValue:null,description:"Polygon GeoJson Feature representing the printing area",name:"geojsonRef",required:!0,type:{name:"MutableRefObject<Feature<Geometry, GeoJsonProperties> | undefined>"}},options:{defaultValue:null,description:"a state variable containing the PDF previews current state",name:"options",required:!0,type:{name:"PdfPreviewOptions"}},setOptions:{defaultValue:null,description:"setter function to update the current PDF preview state",name:"setOptions",required:!0,type:{name:"(arg1: (val: PdfPreviewOptions) => PdfPreviewOptions) => void"}}}}}catch{}const dSe=[{value:0,label:"free scale"},{value:250,label:"1/250"},{value:500,label:"1/500"},{value:750,label:"1/750"},{value:1e3,label:"1/1000"},{value:1500,label:"1/1500"},{value:2e3,label:"1/2000"},{value:1e4,label:"1/10000"},{value:1e5,label:"1/100000"}],pSe=[{value:"72dpi",label:"Draft (72dpi)"},{value:"150dpi",label:"Medium (150dpi)"},{value:"300dpi",label:"High (300dpi)"}];function BR(t){const[e,r]=te.useState(!1),n=te.useContext(bZ),i=va({mapId:t.mapId}),a=_Z({mapId:t.mapId}),s=te.useCallback(()=>{if(i.map&&a.createExport&&n.template&&n.format&&n.options?.orientation&&n.geojsonRef?.current?.bbox&&n.geojsonRef?.current){r(!0);const f=mf(n.geojsonRef.current);a.createExport({width:n.template.width,height:n.template.height,bbox:f,bboxUnrotated:n.geojsonRef.current.bbox,bearing:n.geojsonRef.current?.properties?.bearing||0,format:n.format.toLowerCase(),orientation:n.options.orientation}).then(d=>d.createPdf()).then(d=>(typeof t.onCreatePdf=="function"&&(d.formData=new FormData(document.getElementById("createPdfFormID")),t.onCreatePdf(d)),r(!1),d.downloadPdf())).catch(d=>{console.log(d),r(!1)})}},[i.map,n]),o=Nx("(max-width: 950px)"),c=te.useMemo(()=>({margin:o?"1px 0 8px 0 ":"5px 0 15px 0 ",...t?.formControlStyles?{...t.formControlStyles}:{}}),[o,t.formControlStyles]);return J.jsx(J.Fragment,{children:J.jsxs("form",{id:"createPdfFormID",children:[J.jsxs(sf,{fullWidth:!0,sx:c,children:[J.jsx(ta,{variant:"contained",className:"createPdfButton",onClick:s,disabled:e,sx:{marginBottom:"16px"},children:"create PDF"}),e&&J.jsx(WT,{size:24,sx:{color:"primary.main",position:"absolute",top:"25%",left:"50%",marginTop:"-12px",marginLeft:"-12px"}})]}),J.jsxs(sf,{fullWidth:!0,sx:c,children:[J.jsx(_g,{sx:{marginTop:"3px"},id:"format-select-label",children:"Format"}),J.jsx(bg,{labelId:"format-select-label",id:"format-select",label:"Format",value:n.format,onChange:f=>{n.setFormat?.(f.target.value)},children:Object.keys(l0).map(f=>J.jsx(Fm,{value:f,children:f},f))})]}),J.jsxs(sf,{fullWidth:!0,sx:c,children:[J.jsx(gY,{id:"orientation-radio-buttons-group-label",children:"Orientation"}),J.jsxs(Eme,{row:!0,"aria-labelledby":"orientation-radio-buttons-group-label",name:"orientation-radio-buttons-group",value:n.options?.orientation,onChange:f=>{n.setOptions&&n.setOptions(d=>({...d,orientation:f.target.value}))},children:[J.jsx(qk,{value:"portrait",control:J.jsx(fz,{}),label:"Portrait"}),J.jsx(qk,{value:"landscape",control:J.jsx(fz,{}),label:"Landscape"})]})]}),J.jsxs(sf,{fullWidth:!0,sx:c,children:[J.jsx(_g,{id:"quality-select-label",children:"Quality"}),J.jsx(bg,{labelId:"quality-select-label",id:"quality-select",label:"Quality",value:n.quality,onChange:f=>{n.setQuality?.(f.target.value)},children:pSe.map(f=>J.jsx(Fm,{value:f.value,children:f.label},f.value))})]}),J.jsxs(sf,{fullWidth:!0,sx:c,children:[J.jsx(_g,{id:"scale-select-label",children:"Scale"}),J.jsx(bg,{labelId:"scale-select-label",id:"scale-select",label:"Scale",value:n?.options?.fixedScale,onChange:f=>{n.setOptions?.(d=>({...d,fixedScale:f.target.value}))},children:dSe.map((f,d)=>J.jsx(Fm,{value:f.value,children:f.label},d))})]}),t?.additionalFields,n.options&&n.setOptions&&J.jsx(FR,{options:n.options,setOptions:n.setOptions,geojsonRef:n.geojsonRef})]})})}try{BR.displayName="PdfForm",BR.__docgenInfo={description:"",displayName:"PdfForm",props:{mapId:{defaultValue:null,description:"Id of the target MapLibre instance in mapContext",name:"mapId",required:!1,type:{name:"string | undefined"}},onCreatePdf:{defaultValue:null,description:`Function that will be called before the PDF is created.
Allowing to access and manipulate the jspdf instance before the PDF is created.`,name:"onCreatePdf",required:!1,type:{name:"((options: createPdfResolverParams) => createPdfResolverParams) | undefined"}},formControlStyles:{defaultValue:null,description:"sx props that will be applied to the form control components",name:"formControlStyles",required:!1,type:{name:"SxProps | undefined"}},additionalFields:{defaultValue:null,description:`Define additional form fields that will be added to the bottom of the create-PDF form.
Values of form elements added this way are accessible inside the function passed to the onCreatePdf property using options.formData.get('{form_el_name}').
Make sure all form elements added this way have a name property defined to be able to access the value when rendering the PDF.`,name:"additionalFields",required:!1,type:{name:"ReactNode"}}}}}catch{}const aj=t=>J.jsx(J.Fragment,{children:J.jsx(iR,{children:J.jsx(BR,{...t})})});try{aj.displayName="MlCreatePdfForm",aj.__docgenInfo={description:"Create PDF Form Component",displayName:"MlCreatePdfForm",props:{mapId:{defaultValue:null,description:"Id of the target MapLibre instance in mapContext",name:"mapId",required:!1,type:{name:"string | undefined"}},onCreatePdf:{defaultValue:null,description:`Function that will be called before the PDF is created.
Allowing to access and manipulate the jspdf instance before the PDF is created.`,name:"onCreatePdf",required:!1,type:{name:"((options: createPdfResolverParams) => createPdfResolverParams) | undefined"}},formControlStyles:{defaultValue:null,description:"sx props that will be applied to the form control components",name:"formControlStyles",required:!1,type:{name:"SxProps | undefined"}},additionalFields:{defaultValue:null,description:`Define additional form fields that will be added to the bottom of the create-PDF form.
Values of form elements added this way are accessible inside the function passed to the onCreatePdf property using options.formData.get('{form_el_name}').
Make sure all form elements added this way have a name property defined to be able to access the value when rendering the PDF.`,name:"additionalFields",required:!1,type:{name:"ReactNode"}}}}}catch{}var wS={exports:{}},gSe=wS.exports,oj;function mSe(){return oj||(oj=1,(function(t,e){(function(r,n){t.exports=n()})(gSe,(function(){var r=function(ee,pe){var Ke={drag:[],click:[],mousemove:[],mousedown:[],mouseup:[],mouseout:[],keydown:[],keyup:[],touchstart:[],touchmove:[],touchend:[],tap:[]},It={on:function(qt,er,Yr){if(Ke[qt]===void 0)throw new Error("Invalid event type: "+qt);Ke[qt].push({selector:er,fn:Yr})},render:function(qt){pe.store.featureChanged(qt)}},Vt=function(qt,er){for(var Yr=Ke[qt],tn=Yr.length;tn--;){var Gr=Yr[tn];if(Gr.selector(er)){Gr.fn.call(It,er)||pe.store.render(),pe.ui.updateMapClasses();break}}};return ee.start.call(It),{render:ee.render,stop:function(){ee.stop&&ee.stop()},trash:function(){ee.trash&&(ee.trash(),pe.store.render())},combineFeatures:function(){ee.combineFeatures&&ee.combineFeatures()},uncombineFeatures:function(){ee.uncombineFeatures&&ee.uncombineFeatures()},drag:function(qt){Vt("drag",qt)},click:function(qt){Vt("click",qt)},mousemove:function(qt){Vt("mousemove",qt)},mousedown:function(qt){Vt("mousedown",qt)},mouseup:function(qt){Vt("mouseup",qt)},mouseout:function(qt){Vt("mouseout",qt)},keydown:function(qt){Vt("keydown",qt)},keyup:function(qt){Vt("keyup",qt)},touchstart:function(qt){Vt("touchstart",qt)},touchmove:function(qt){Vt("touchmove",qt)},touchend:function(qt){Vt("touchend",qt)},tap:function(qt){Vt("tap",qt)}}};function n(ee){return ee&&ee.__esModule&&Object.prototype.hasOwnProperty.call(ee,"default")?ee.default:ee}function i(ee){if(ee.__esModule)return ee;var pe=ee.default;if(typeof pe=="function"){var Ke=function It(){if(this instanceof It){var Vt=[null];Vt.push.apply(Vt,arguments);var qt=Function.bind.apply(pe,Vt);return new qt}return pe.apply(this,arguments)};Ke.prototype=pe.prototype}else Ke={};return Object.defineProperty(Ke,"__esModule",{value:!0}),Object.keys(ee).forEach((function(It){var Vt=Object.getOwnPropertyDescriptor(ee,It);Object.defineProperty(Ke,It,Vt.get?Vt:{enumerable:!0,get:function(){return ee[It]}})})),Ke}var a={},s={RADIUS:6378137},o=s;function c(ee){var pe=0;if(ee&&ee.length>0){pe+=Math.abs(f(ee[0]));for(var Ke=1;Ke<ee.length;Ke++)pe-=Math.abs(f(ee[Ke]))}return pe}function f(ee){var pe,Ke,It,Vt,qt,er,Yr=0,tn=ee.length;if(tn>2){for(er=0;er<tn;er++)er===tn-2?(It=tn-2,Vt=tn-1,qt=0):er===tn-1?(It=tn-1,Vt=0,qt=1):(It=er,Vt=er+1,qt=er+2),pe=ee[It],Ke=ee[Vt],Yr+=(d(ee[qt][0])-d(pe[0]))*Math.sin(d(Ke[1]));Yr=Yr*o.RADIUS*o.RADIUS/2}return Yr}function d(ee){return ee*Math.PI/180}a.geometry=function ee(pe){var Ke,It=0;switch(pe.type){case"Polygon":return c(pe.coordinates);case"MultiPolygon":for(Ke=0;Ke<pe.coordinates.length;Ke++)It+=c(pe.coordinates[Ke]);return It;case"Point":case"MultiPoint":case"LineString":case"MultiLineString":return 0;case"GeometryCollection":for(Ke=0;Ke<pe.geometries.length;Ke++)It+=ee(pe.geometries[Ke]);return It}},a.ring=f;var m={CONTROL_BASE:"mapboxgl-ctrl",CONTROL_PREFIX:"mapboxgl-ctrl-",CONTROL_BUTTON:"mapbox-gl-draw_ctrl-draw-btn",CONTROL_BUTTON_LINE:"mapbox-gl-draw_line",CONTROL_BUTTON_POLYGON:"mapbox-gl-draw_polygon",CONTROL_BUTTON_POINT:"mapbox-gl-draw_point",CONTROL_BUTTON_TRASH:"mapbox-gl-draw_trash",CONTROL_BUTTON_COMBINE_FEATURES:"mapbox-gl-draw_combine",CONTROL_BUTTON_UNCOMBINE_FEATURES:"mapbox-gl-draw_uncombine",CONTROL_GROUP:"mapboxgl-ctrl-group",ATTRIBUTION:"mapboxgl-ctrl-attrib",ACTIVE_BUTTON:"active",BOX_SELECT:"mapbox-gl-draw_boxselect"},b={HOT:"mapbox-gl-draw-hot",COLD:"mapbox-gl-draw-cold"},x={ADD:"add",MOVE:"move",DRAG:"drag",POINTER:"pointer",NONE:"none"},E={POLYGON:"polygon",LINE:"line_string",POINT:"point"},T={FEATURE:"Feature",POLYGON:"Polygon",LINE_STRING:"LineString",POINT:"Point",FEATURE_COLLECTION:"FeatureCollection",MULTI_PREFIX:"Multi",MULTI_POINT:"MultiPoint",MULTI_LINE_STRING:"MultiLineString",MULTI_POLYGON:"MultiPolygon"},A={DRAW_LINE_STRING:"draw_line_string",DRAW_POLYGON:"draw_polygon",DRAW_POINT:"draw_point",SIMPLE_SELECT:"simple_select",DIRECT_SELECT:"direct_select",STATIC:"static"},M={CREATE:"draw.create",DELETE:"draw.delete",UPDATE:"draw.update",SELECTION_CHANGE:"draw.selectionchange",MODE_CHANGE:"draw.modechange",ACTIONABLE:"draw.actionable",RENDER:"draw.render",COMBINE_FEATURES:"draw.combine",UNCOMBINE_FEATURES:"draw.uncombine"},F={MOVE:"move",CHANGE_COORDINATES:"change_coordinates"},N={FEATURE:"feature",MIDPOINT:"midpoint",VERTEX:"vertex"},O={ACTIVE:"true",INACTIVE:"false"},U=["scrollZoom","boxZoom","dragRotate","dragPan","keyboard","doubleClickZoom","touchZoomRotate"],j=-85,H=Object.freeze({__proto__:null,classes:m,sources:b,cursors:x,types:E,geojsonTypes:T,modes:A,events:M,updateActions:F,meta:N,activeStates:O,interactions:U,LAT_MIN:-90,LAT_RENDERED_MIN:j,LAT_MAX:90,LAT_RENDERED_MAX:85,LNG_MIN:-270,LNG_MAX:270}),W={Point:0,LineString:1,MultiLineString:1,Polygon:2};function X(ee,pe){var Ke=W[ee.geometry.type]-W[pe.geometry.type];return Ke===0&&ee.geometry.type===T.POLYGON?ee.area-pe.area:Ke}function oe(ee){return ee.map((function(pe){return pe.geometry.type===T.POLYGON&&(pe.area=a.geometry({type:T.FEATURE,property:{},geometry:pe.geometry})),pe})).sort(X).map((function(pe){return delete pe.area,pe}))}function Q(ee,pe){return pe===void 0&&(pe=0),[[ee.point.x-pe,ee.point.y-pe],[ee.point.x+pe,ee.point.y+pe]]}function G(ee){if(this._items={},this._nums={},this._length=ee?ee.length:0,ee)for(var pe=0,Ke=ee.length;pe<Ke;pe++)this.add(ee[pe]),ee[pe]!==void 0&&(typeof ee[pe]=="string"?this._items[ee[pe]]=pe:this._nums[ee[pe]]=pe)}G.prototype.add=function(ee){return this.has(ee)||(this._length++,typeof ee=="string"?this._items[ee]=this._length:this._nums[ee]=this._length),this},G.prototype.delete=function(ee){return this.has(ee)===!1||(this._length--,delete this._items[ee],delete this._nums[ee]),this},G.prototype.has=function(ee){return(typeof ee=="string"||typeof ee=="number")&&(this._items[ee]!==void 0||this._nums[ee]!==void 0)},G.prototype.values=function(){var ee=this,pe=[];return Object.keys(this._items).forEach((function(Ke){pe.push({k:Ke,v:ee._items[Ke]})})),Object.keys(this._nums).forEach((function(Ke){pe.push({k:JSON.parse(Ke),v:ee._nums[Ke]})})),pe.sort((function(Ke,It){return Ke.v-It.v})).map((function(Ke){return Ke.k}))},G.prototype.clear=function(){return this._length=0,this._items={},this._nums={},this};var ae=[N.FEATURE,N.MIDPOINT,N.VERTEX],se={click:function(ee,pe,Ke){return fe(ee,pe,Ke,Ke.options.clickBuffer)},touch:function(ee,pe,Ke){return fe(ee,pe,Ke,Ke.options.touchBuffer)}};function fe(ee,pe,Ke,It){if(Ke.map===null)return[];var Vt=ee?Q(ee,It):pe,qt={};Ke.options.styles&&(qt.layers=Ke.options.styles.map((function(Gr){return Gr.id})).filter((function(Gr){return Ke.map.getLayer(Gr)!=null})));var er=Ke.map.queryRenderedFeatures(Vt,qt).filter((function(Gr){return ae.indexOf(Gr.properties.meta)!==-1})),Yr=new G,tn=[];return er.forEach((function(Gr){var on=Gr.properties.id;Yr.has(on)||(Yr.add(on),tn.push(Gr))})),oe(tn)}function _e(ee,pe){var Ke=se.click(ee,null,pe),It={mouse:x.NONE};return Ke[0]&&(It.mouse=Ke[0].properties.active===O.ACTIVE?x.MOVE:x.POINTER,It.feature=Ke[0].properties.meta),pe.events.currentModeName().indexOf("draw")!==-1&&(It.mouse=x.ADD),pe.ui.queueMapClasses(It),pe.ui.updateMapClasses(),Ke[0]}function Le(ee,pe){var Ke=ee.x-pe.x,It=ee.y-pe.y;return Math.sqrt(Ke*Ke+It*It)}function ye(ee,pe,Ke){Ke===void 0&&(Ke={});var It=Ke.fineTolerance!=null?Ke.fineTolerance:4,Vt=Ke.grossTolerance!=null?Ke.grossTolerance:12,qt=Ke.interval!=null?Ke.interval:500;ee.point=ee.point||pe.point,ee.time=ee.time||pe.time;var er=Le(ee.point,pe.point);return er<It||er<Vt&&pe.time-ee.time<qt}function Te(ee,pe,Ke){Ke===void 0&&(Ke={});var It=Ke.tolerance!=null?Ke.tolerance:25,Vt=Ke.interval!=null?Ke.interval:250;return ee.point=ee.point||pe.point,ee.time=ee.time||pe.time,Le(ee.point,pe.point)<It&&pe.time-ee.time<Vt}var Ie={exports:{}},Me=Ie.exports=function(ee,pe){if(pe||(pe=16),ee===void 0&&(ee=128),ee<=0)return"0";for(var Ke=Math.log(Math.pow(2,ee))/Math.log(pe),It=2;Ke===1/0;It*=2)Ke=Math.log(Math.pow(2,ee/It))/Math.log(pe)*It;var Vt=Ke-Math.floor(Ke),qt="";for(It=0;It<Math.floor(Ke);It++)qt=Math.floor(Math.random()*pe).toString(pe)+qt;if(Vt){var er=Math.pow(pe,Vt);qt=Math.floor(Math.random()*er).toString(pe)+qt}var Yr=parseInt(qt,pe);return Yr!==1/0&&Yr>=Math.pow(2,ee)?Me(ee,pe):qt};Me.rack=function(ee,pe,Ke){var It=function(qt){var er=0;do{if(er++>10){if(!Ke)throw new Error("too many ID collisions, use more bits");ee+=Ke}var Yr=Me(ee,pe)}while(Object.hasOwnProperty.call(Vt,Yr));return Vt[Yr]=qt,Yr},Vt=It.hats={};return It.get=function(qt){return It.hats[qt]},It.set=function(qt,er){return It.hats[qt]=er,It},It.bits=ee||128,It.base=pe||16,It};var de=n(Ie.exports),Se=function(ee,pe){this.ctx=ee,this.properties=pe.properties||{},this.coordinates=pe.geometry.coordinates,this.id=pe.id||de(),this.type=pe.geometry.type};Se.prototype.changed=function(){this.ctx.store.featureChanged(this.id)},Se.prototype.incomingCoords=function(ee){this.setCoordinates(ee)},Se.prototype.setCoordinates=function(ee){this.coordinates=ee,this.changed()},Se.prototype.getCoordinates=function(){return JSON.parse(JSON.stringify(this.coordinates))},Se.prototype.setProperty=function(ee,pe){this.properties[ee]=pe},Se.prototype.toGeoJSON=function(){return JSON.parse(JSON.stringify({id:this.id,type:T.FEATURE,properties:this.properties,geometry:{coordinates:this.getCoordinates(),type:this.type}}))},Se.prototype.internal=function(ee){var pe={id:this.id,meta:N.FEATURE,"meta:type":this.type,active:O.INACTIVE,mode:ee};if(this.ctx.options.userProperties)for(var Ke in this.properties)pe["user_"+Ke]=this.properties[Ke];return{type:T.FEATURE,properties:pe,geometry:{coordinates:this.getCoordinates(),type:this.type}}};var we=function(ee,pe){Se.call(this,ee,pe)};(we.prototype=Object.create(Se.prototype)).isValid=function(){return typeof this.coordinates[0]=="number"&&typeof this.coordinates[1]=="number"},we.prototype.updateCoordinate=function(ee,pe,Ke){this.coordinates=arguments.length===3?[pe,Ke]:[ee,pe],this.changed()},we.prototype.getCoordinate=function(){return this.getCoordinates()};var De=function(ee,pe){Se.call(this,ee,pe)};(De.prototype=Object.create(Se.prototype)).isValid=function(){return this.coordinates.length>1},De.prototype.addCoordinate=function(ee,pe,Ke){this.changed();var It=parseInt(ee,10);this.coordinates.splice(It,0,[pe,Ke])},De.prototype.getCoordinate=function(ee){var pe=parseInt(ee,10);return JSON.parse(JSON.stringify(this.coordinates[pe]))},De.prototype.removeCoordinate=function(ee){this.changed(),this.coordinates.splice(parseInt(ee,10),1)},De.prototype.updateCoordinate=function(ee,pe,Ke){var It=parseInt(ee,10);this.coordinates[It]=[pe,Ke],this.changed()};var Fe=function(ee,pe){Se.call(this,ee,pe),this.coordinates=this.coordinates.map((function(Ke){return Ke.slice(0,-1)}))};(Fe.prototype=Object.create(Se.prototype)).isValid=function(){return this.coordinates.length!==0&&this.coordinates.every((function(ee){return ee.length>2}))},Fe.prototype.incomingCoords=function(ee){this.coordinates=ee.map((function(pe){return pe.slice(0,-1)})),this.changed()},Fe.prototype.setCoordinates=function(ee){this.coordinates=ee,this.changed()},Fe.prototype.addCoordinate=function(ee,pe,Ke){this.changed();var It=ee.split(".").map((function(Vt){return parseInt(Vt,10)}));this.coordinates[It[0]].splice(It[1],0,[pe,Ke])},Fe.prototype.removeCoordinate=function(ee){this.changed();var pe=ee.split(".").map((function(It){return parseInt(It,10)})),Ke=this.coordinates[pe[0]];Ke&&(Ke.splice(pe[1],1),Ke.length<3&&this.coordinates.splice(pe[0],1))},Fe.prototype.getCoordinate=function(ee){var pe=ee.split(".").map((function(It){return parseInt(It,10)})),Ke=this.coordinates[pe[0]];return JSON.parse(JSON.stringify(Ke[pe[1]]))},Fe.prototype.getCoordinates=function(){return this.coordinates.map((function(ee){return ee.concat([ee[0]])}))},Fe.prototype.updateCoordinate=function(ee,pe,Ke){this.changed();var It=ee.split("."),Vt=parseInt(It[0],10),qt=parseInt(It[1],10);this.coordinates[Vt]===void 0&&(this.coordinates[Vt]=[]),this.coordinates[Vt][qt]=[pe,Ke]};var Xe={MultiPoint:we,MultiLineString:De,MultiPolygon:Fe},Be=function(ee,pe,Ke,It,Vt){var qt=Ke.split("."),er=parseInt(qt[0],10),Yr=qt[1]?qt.slice(1).join("."):null;return ee[er][pe](Yr,It,Vt)},st=function(ee,pe){if(Se.call(this,ee,pe),delete this.coordinates,this.model=Xe[pe.geometry.type],this.model===void 0)throw new TypeError(pe.geometry.type+" is not a valid type");this.features=this._coordinatesToFeatures(pe.geometry.coordinates)};function Qe(ee){this.map=ee.map,this.drawConfig=JSON.parse(JSON.stringify(ee.options||{})),this._ctx=ee}(st.prototype=Object.create(Se.prototype))._coordinatesToFeatures=function(ee){var pe=this,Ke=this.model.bind(this);return ee.map((function(It){return new Ke(pe.ctx,{id:de(),type:T.FEATURE,properties:{},geometry:{coordinates:It,type:pe.type.replace("Multi","")}})}))},st.prototype.isValid=function(){return this.features.every((function(ee){return ee.isValid()}))},st.prototype.setCoordinates=function(ee){this.features=this._coordinatesToFeatures(ee),this.changed()},st.prototype.getCoordinate=function(ee){return Be(this.features,"getCoordinate",ee)},st.prototype.getCoordinates=function(){return JSON.parse(JSON.stringify(this.features.map((function(ee){return ee.type===T.POLYGON?ee.getCoordinates():ee.coordinates}))))},st.prototype.updateCoordinate=function(ee,pe,Ke){Be(this.features,"updateCoordinate",ee,pe,Ke),this.changed()},st.prototype.addCoordinate=function(ee,pe,Ke){Be(this.features,"addCoordinate",ee,pe,Ke),this.changed()},st.prototype.removeCoordinate=function(ee){Be(this.features,"removeCoordinate",ee),this.changed()},st.prototype.getFeatures=function(){return this.features},Qe.prototype.setSelected=function(ee){return this._ctx.store.setSelected(ee)},Qe.prototype.setSelectedCoordinates=function(ee){var pe=this;this._ctx.store.setSelectedCoordinates(ee),ee.reduce((function(Ke,It){return Ke[It.feature_id]===void 0&&(Ke[It.feature_id]=!0,pe._ctx.store.get(It.feature_id).changed()),Ke}),{})},Qe.prototype.getSelected=function(){return this._ctx.store.getSelected()},Qe.prototype.getSelectedIds=function(){return this._ctx.store.getSelectedIds()},Qe.prototype.isSelected=function(ee){return this._ctx.store.isSelected(ee)},Qe.prototype.getFeature=function(ee){return this._ctx.store.get(ee)},Qe.prototype.select=function(ee){return this._ctx.store.select(ee)},Qe.prototype.deselect=function(ee){return this._ctx.store.deselect(ee)},Qe.prototype.deleteFeature=function(ee,pe){return pe===void 0&&(pe={}),this._ctx.store.delete(ee,pe)},Qe.prototype.addFeature=function(ee){return this._ctx.store.add(ee)},Qe.prototype.clearSelectedFeatures=function(){return this._ctx.store.clearSelected()},Qe.prototype.clearSelectedCoordinates=function(){return this._ctx.store.clearSelectedCoordinates()},Qe.prototype.setActionableState=function(ee){ee===void 0&&(ee={});var pe={trash:ee.trash||!1,combineFeatures:ee.combineFeatures||!1,uncombineFeatures:ee.uncombineFeatures||!1};return this._ctx.events.actionable(pe)},Qe.prototype.changeMode=function(ee,pe,Ke){return pe===void 0&&(pe={}),Ke===void 0&&(Ke={}),this._ctx.events.changeMode(ee,pe,Ke)},Qe.prototype.updateUIClasses=function(ee){return this._ctx.ui.queueMapClasses(ee)},Qe.prototype.activateUIButton=function(ee){return this._ctx.ui.setActiveButton(ee)},Qe.prototype.featuresAt=function(ee,pe,Ke){if(Ke===void 0&&(Ke="click"),Ke!=="click"&&Ke!=="touch")throw new Error("invalid buffer type");return se[Ke](ee,pe,this._ctx)},Qe.prototype.newFeature=function(ee){var pe=ee.geometry.type;return pe===T.POINT?new we(this._ctx,ee):pe===T.LINE_STRING?new De(this._ctx,ee):pe===T.POLYGON?new Fe(this._ctx,ee):new st(this._ctx,ee)},Qe.prototype.isInstanceOf=function(ee,pe){if(ee===T.POINT)return pe instanceof we;if(ee===T.LINE_STRING)return pe instanceof De;if(ee===T.POLYGON)return pe instanceof Fe;if(ee==="MultiFeature")return pe instanceof st;throw new Error("Unknown feature class: "+ee)},Qe.prototype.doRender=function(ee){return this._ctx.store.featureChanged(ee)},Qe.prototype.onSetup=function(){},Qe.prototype.onDrag=function(){},Qe.prototype.onClick=function(){},Qe.prototype.onMouseMove=function(){},Qe.prototype.onMouseDown=function(){},Qe.prototype.onMouseUp=function(){},Qe.prototype.onMouseOut=function(){},Qe.prototype.onKeyUp=function(){},Qe.prototype.onKeyDown=function(){},Qe.prototype.onTouchStart=function(){},Qe.prototype.onTouchMove=function(){},Qe.prototype.onTouchEnd=function(){},Qe.prototype.onTap=function(){},Qe.prototype.onStop=function(){},Qe.prototype.onTrash=function(){},Qe.prototype.onCombineFeature=function(){},Qe.prototype.onUncombineFeature=function(){},Qe.prototype.toDisplayFeatures=function(){throw new Error("You must overwrite toDisplayFeatures")};var it={drag:"onDrag",click:"onClick",mousemove:"onMouseMove",mousedown:"onMouseDown",mouseup:"onMouseUp",mouseout:"onMouseOut",keyup:"onKeyUp",keydown:"onKeyDown",touchstart:"onTouchStart",touchmove:"onTouchMove",touchend:"onTouchEnd",tap:"onTap"},be=Object.keys(it);function Ot(ee){var pe=Object.keys(ee);return function(Ke,It){It===void 0&&(It={});var Vt={},qt=pe.reduce((function(er,Yr){return er[Yr]=ee[Yr],er}),new Qe(Ke));return{start:function(){var er=this;Vt=qt.onSetup(It),be.forEach((function(Yr){var tn,Gr=it[Yr],on=function(){return!1};ee[Gr]&&(on=function(){return!0}),er.on(Yr,on,(tn=Gr,function(kr){return qt[tn](Vt,kr)}))}))},stop:function(){qt.onStop(Vt)},trash:function(){qt.onTrash(Vt)},combineFeatures:function(){qt.onCombineFeatures(Vt)},uncombineFeatures:function(){qt.onUncombineFeatures(Vt)},render:function(er,Yr){qt.toDisplayFeatures(Vt,er,Yr)}}}}function at(ee){return[].concat(ee).filter((function(pe){return pe!==void 0}))}function $e(){var ee=this;if(!(ee.ctx.map&&ee.ctx.map.getSource(b.HOT)!==void 0))return tn();var pe=ee.ctx.events.currentModeName();ee.ctx.ui.queueMapClasses({mode:pe});var Ke=[],It=[];ee.isDirty?It=ee.getAllIds():(Ke=ee.getChangedIds().filter((function(Gr){return ee.get(Gr)!==void 0})),It=ee.sources.hot.filter((function(Gr){return Gr.properties.id&&Ke.indexOf(Gr.properties.id)===-1&&ee.get(Gr.properties.id)!==void 0})).map((function(Gr){return Gr.properties.id}))),ee.sources.hot=[];var Vt=ee.sources.cold.length;ee.sources.cold=ee.isDirty?[]:ee.sources.cold.filter((function(Gr){var on=Gr.properties.id||Gr.properties.parent;return Ke.indexOf(on)===-1}));var qt=Vt!==ee.sources.cold.length||It.length>0;function er(Gr,on){var kr=ee.get(Gr).internal(pe);ee.ctx.events.currentModeRender(kr,(function(ti){ee.sources[on].push(ti)}))}if(Ke.forEach((function(Gr){return er(Gr,"hot")})),It.forEach((function(Gr){return er(Gr,"cold")})),qt&&ee.ctx.map.getSource(b.COLD).setData({type:T.FEATURE_COLLECTION,features:ee.sources.cold}),ee.ctx.map.getSource(b.HOT).setData({type:T.FEATURE_COLLECTION,features:ee.sources.hot}),ee._emitSelectionChange&&(ee.ctx.map.fire(M.SELECTION_CHANGE,{features:ee.getSelected().map((function(Gr){return Gr.toGeoJSON()})),points:ee.getSelectedCoordinates().map((function(Gr){return{type:T.FEATURE,properties:{},geometry:{type:T.POINT,coordinates:Gr.coordinates}}}))}),ee._emitSelectionChange=!1),ee._deletedFeaturesToEmit.length){var Yr=ee._deletedFeaturesToEmit.map((function(Gr){return Gr.toGeoJSON()}));ee._deletedFeaturesToEmit=[],ee.ctx.map.fire(M.DELETE,{features:Yr})}function tn(){ee.isDirty=!1,ee.clearChangedIds()}tn(),ee.ctx.map.fire(M.RENDER,{})}function Xt(ee){var pe,Ke=this;this._features={},this._featureIds=new G,this._selectedFeatureIds=new G,this._selectedCoordinates=[],this._changedFeatureIds=new G,this._deletedFeaturesToEmit=[],this._emitSelectionChange=!1,this._mapInitialConfig={},this.ctx=ee,this.sources={hot:[],cold:[]},this.render=function(){pe||(pe=requestAnimationFrame((function(){pe=null,$e.call(Ke)})))},this.isDirty=!1}function $t(ee,pe){var Ke=ee._selectedCoordinates.filter((function(It){return ee._selectedFeatureIds.has(It.feature_id)}));ee._selectedCoordinates.length===Ke.length||pe.silent||(ee._emitSelectionChange=!0),ee._selectedCoordinates=Ke}Xt.prototype.createRenderBatch=function(){var ee=this,pe=this.render,Ke=0;return this.render=function(){Ke++},function(){ee.render=pe,Ke>0&&ee.render()}},Xt.prototype.setDirty=function(){return this.isDirty=!0,this},Xt.prototype.featureChanged=function(ee){return this._changedFeatureIds.add(ee),this},Xt.prototype.getChangedIds=function(){return this._changedFeatureIds.values()},Xt.prototype.clearChangedIds=function(){return this._changedFeatureIds.clear(),this},Xt.prototype.getAllIds=function(){return this._featureIds.values()},Xt.prototype.add=function(ee){return this.featureChanged(ee.id),this._features[ee.id]=ee,this._featureIds.add(ee.id),this},Xt.prototype.delete=function(ee,pe){var Ke=this;return pe===void 0&&(pe={}),at(ee).forEach((function(It){Ke._featureIds.has(It)&&(Ke._featureIds.delete(It),Ke._selectedFeatureIds.delete(It),pe.silent||Ke._deletedFeaturesToEmit.indexOf(Ke._features[It])===-1&&Ke._deletedFeaturesToEmit.push(Ke._features[It]),delete Ke._features[It],Ke.isDirty=!0)})),$t(this,pe),this},Xt.prototype.get=function(ee){return this._features[ee]},Xt.prototype.getAll=function(){var ee=this;return Object.keys(this._features).map((function(pe){return ee._features[pe]}))},Xt.prototype.select=function(ee,pe){var Ke=this;return pe===void 0&&(pe={}),at(ee).forEach((function(It){Ke._selectedFeatureIds.has(It)||(Ke._selectedFeatureIds.add(It),Ke._changedFeatureIds.add(It),pe.silent||(Ke._emitSelectionChange=!0))})),this},Xt.prototype.deselect=function(ee,pe){var Ke=this;return pe===void 0&&(pe={}),at(ee).forEach((function(It){Ke._selectedFeatureIds.has(It)&&(Ke._selectedFeatureIds.delete(It),Ke._changedFeatureIds.add(It),pe.silent||(Ke._emitSelectionChange=!0))})),$t(this,pe),this},Xt.prototype.clearSelected=function(ee){return ee===void 0&&(ee={}),this.deselect(this._selectedFeatureIds.values(),{silent:ee.silent}),this},Xt.prototype.setSelected=function(ee,pe){var Ke=this;return pe===void 0&&(pe={}),ee=at(ee),this.deselect(this._selectedFeatureIds.values().filter((function(It){return ee.indexOf(It)===-1})),{silent:pe.silent}),this.select(ee.filter((function(It){return!Ke._selectedFeatureIds.has(It)})),{silent:pe.silent}),this},Xt.prototype.setSelectedCoordinates=function(ee){return this._selectedCoordinates=ee,this._emitSelectionChange=!0,this},Xt.prototype.clearSelectedCoordinates=function(){return this._selectedCoordinates=[],this._emitSelectionChange=!0,this},Xt.prototype.getSelectedIds=function(){return this._selectedFeatureIds.values()},Xt.prototype.getSelected=function(){var ee=this;return this._selectedFeatureIds.values().map((function(pe){return ee.get(pe)}))},Xt.prototype.getSelectedCoordinates=function(){var ee=this;return this._selectedCoordinates.map((function(pe){return{coordinates:ee.get(pe.feature_id).getCoordinate(pe.coord_path)}}))},Xt.prototype.isSelected=function(ee){return this._selectedFeatureIds.has(ee)},Xt.prototype.setFeatureProperty=function(ee,pe,Ke){this.get(ee).setProperty(pe,Ke),this.featureChanged(ee)},Xt.prototype.storeMapConfig=function(){var ee=this;U.forEach((function(pe){ee.ctx.map[pe]&&(ee._mapInitialConfig[pe]=ee.ctx.map[pe].isEnabled())}))},Xt.prototype.restoreMapConfig=function(){var ee=this;Object.keys(this._mapInitialConfig).forEach((function(pe){ee._mapInitialConfig[pe]?ee.ctx.map[pe].enable():ee.ctx.map[pe].disable()}))},Xt.prototype.getInitialConfigValue=function(ee){return this._mapInitialConfig[ee]===void 0||this._mapInitialConfig[ee]};var cr=function(){for(var ee=arguments,pe={},Ke=0;Ke<arguments.length;Ke++){var It=ee[Ke];for(var Vt in It)_t.call(It,Vt)&&(pe[Vt]=It[Vt])}return pe},_t=Object.prototype.hasOwnProperty,gr=n(cr),mr=["mode","feature","mouse"];function ar(ee){var pe=null,Ke=null,It={onRemove:function(){return ee.map.off("load",It.connect),clearInterval(Ke),It.removeLayers(),ee.store.restoreMapConfig(),ee.ui.removeButtons(),ee.events.removeEventListeners(),ee.ui.clearMapClasses(),ee.boxZoomInitial&&ee.map.boxZoom.enable(),ee.map=null,ee.container=null,ee.store=null,pe&&pe.parentNode&&pe.parentNode.removeChild(pe),pe=null,this},connect:function(){ee.map.off("load",It.connect),clearInterval(Ke),It.addLayers(),ee.store.storeMapConfig(),ee.events.addEventListeners()},onAdd:function(Vt){var qt=Vt.fire;return Vt.fire=function(er,Yr){var tn=arguments;return qt.length===1&&arguments.length!==1&&(tn=[gr({},{type:er},Yr)]),qt.apply(Vt,tn)},ee.map=Vt,ee.events=(function(er){var Yr=Object.keys(er.options.modes).reduce((function(Mr,hn){return Mr[hn]=Ot(er.options.modes[hn]),Mr}),{}),tn={},Gr={},on={},kr=null,ti=null;on.drag=function(Mr,hn){hn({point:Mr.point,time:new Date().getTime()})?(er.ui.queueMapClasses({mouse:x.DRAG}),ti.drag(Mr)):Mr.originalEvent.stopPropagation()},on.mousedrag=function(Mr){on.drag(Mr,(function(hn){return!ye(tn,hn)}))},on.touchdrag=function(Mr){on.drag(Mr,(function(hn){return!Te(Gr,hn)}))},on.mousemove=function(Mr){if((Mr.originalEvent.buttons!==void 0?Mr.originalEvent.buttons:Mr.originalEvent.which)===1)return on.mousedrag(Mr);var hn=_e(Mr,er);Mr.featureTarget=hn,ti.mousemove(Mr)},on.mousedown=function(Mr){tn={time:new Date().getTime(),point:Mr.point};var hn=_e(Mr,er);Mr.featureTarget=hn,ti.mousedown(Mr)},on.mouseup=function(Mr){var hn=_e(Mr,er);Mr.featureTarget=hn,ye(tn,{point:Mr.point,time:new Date().getTime()})?ti.click(Mr):ti.mouseup(Mr)},on.mouseout=function(Mr){ti.mouseout(Mr)},on.touchstart=function(Mr){if(er.options.touchEnabled){Gr={time:new Date().getTime(),point:Mr.point};var hn=se.touch(Mr,null,er)[0];Mr.featureTarget=hn,ti.touchstart(Mr)}},on.touchmove=function(Mr){if(er.options.touchEnabled)return ti.touchmove(Mr),on.touchdrag(Mr)},on.touchend=function(Mr){if(Mr.originalEvent.preventDefault(),er.options.touchEnabled){var hn=se.touch(Mr,null,er)[0];Mr.featureTarget=hn,Te(Gr,{time:new Date().getTime(),point:Mr.point})?ti.tap(Mr):ti.touchend(Mr)}};var Ri=function(Mr){return!(Mr===8||Mr===46||Mr>=48&&Mr<=57)};function $n(Mr,hn,mn){mn===void 0&&(mn={}),ti.stop();var fi=Yr[Mr];if(fi===void 0)throw new Error(Mr+" is not valid");kr=Mr;var $i=fi(er,hn);ti=r($i,er),mn.silent||er.map.fire(M.MODE_CHANGE,{mode:Mr}),er.store.setDirty(),er.store.render()}on.keydown=function(Mr){(Mr.srcElement||Mr.target).classList.contains("mapboxgl-canvas")&&(Mr.keyCode!==8&&Mr.keyCode!==46||!er.options.controls.trash?Ri(Mr.keyCode)?ti.keydown(Mr):Mr.keyCode===49&&er.options.controls.point?$n(A.DRAW_POINT):Mr.keyCode===50&&er.options.controls.line_string?$n(A.DRAW_LINE_STRING):Mr.keyCode===51&&er.options.controls.polygon&&$n(A.DRAW_POLYGON):(Mr.preventDefault(),ti.trash()))},on.keyup=function(Mr){Ri(Mr.keyCode)&&ti.keyup(Mr)},on.zoomend=function(){er.store.changeZoom()},on.data=function(Mr){if(Mr.dataType==="style"){var hn=er.setup,mn=er.map,fi=er.options,$i=er.store;fi.styles.some((function(ba){return mn.getLayer(ba.id)}))||(hn.addLayers(),$i.setDirty(),$i.render())}};var _n={trash:!1,combineFeatures:!1,uncombineFeatures:!1};return{start:function(){kr=er.options.defaultMode,ti=r(Yr[kr](er),er)},changeMode:$n,actionable:function(Mr){var hn=!1;Object.keys(Mr).forEach((function(mn){if(_n[mn]===void 0)throw new Error("Invalid action type");_n[mn]!==Mr[mn]&&(hn=!0),_n[mn]=Mr[mn]})),hn&&er.map.fire(M.ACTIONABLE,{actions:_n})},currentModeName:function(){return kr},currentModeRender:function(Mr,hn){return ti.render(Mr,hn)},fire:function(Mr,hn){on[Mr]&&on[Mr](hn)},addEventListeners:function(){er.map.on("mousemove",on.mousemove),er.map.on("mousedown",on.mousedown),er.map.on("mouseup",on.mouseup),er.map.on("data",on.data),er.map.on("touchmove",on.touchmove),er.map.on("touchstart",on.touchstart),er.map.on("touchend",on.touchend),er.container.addEventListener("mouseout",on.mouseout),er.options.keybindings&&(er.container.addEventListener("keydown",on.keydown),er.container.addEventListener("keyup",on.keyup))},removeEventListeners:function(){er.map.off("mousemove",on.mousemove),er.map.off("mousedown",on.mousedown),er.map.off("mouseup",on.mouseup),er.map.off("data",on.data),er.map.off("touchmove",on.touchmove),er.map.off("touchstart",on.touchstart),er.map.off("touchend",on.touchend),er.container.removeEventListener("mouseout",on.mouseout),er.options.keybindings&&(er.container.removeEventListener("keydown",on.keydown),er.container.removeEventListener("keyup",on.keyup))},trash:function(Mr){ti.trash(Mr)},combineFeatures:function(){ti.combineFeatures()},uncombineFeatures:function(){ti.uncombineFeatures()},getMode:function(){return kr}}})(ee),ee.ui=(function(er){var Yr={},tn=null,Gr={mode:null,feature:null,mouse:null},on={mode:null,feature:null,mouse:null};function kr(Mr){on=gr(on,Mr)}function ti(){var Mr,hn;if(er.container){var mn=[],fi=[];mr.forEach((function($i){on[$i]!==Gr[$i]&&(mn.push($i+"-"+Gr[$i]),on[$i]!==null&&fi.push($i+"-"+on[$i]))})),mn.length>0&&(Mr=er.container.classList).remove.apply(Mr,mn),fi.length>0&&(hn=er.container.classList).add.apply(hn,fi),Gr=gr(Gr,on)}}function Ri(Mr,hn){hn===void 0&&(hn={});var mn=document.createElement("button");return mn.className=m.CONTROL_BUTTON+" "+hn.className,mn.setAttribute("title",hn.title),hn.container.appendChild(mn),mn.addEventListener("click",(function(fi){if(fi.preventDefault(),fi.stopPropagation(),fi.target===tn)return $n(),void hn.onDeactivate();_n(Mr),hn.onActivate()}),!0),mn}function $n(){tn&&(tn.classList.remove(m.ACTIVE_BUTTON),tn=null)}function _n(Mr){$n();var hn=Yr[Mr];hn&&hn&&Mr!=="trash"&&(hn.classList.add(m.ACTIVE_BUTTON),tn=hn)}return{setActiveButton:_n,queueMapClasses:kr,updateMapClasses:ti,clearMapClasses:function(){kr({mode:null,feature:null,mouse:null}),ti()},addButtons:function(){var Mr=er.options.controls,hn=document.createElement("div");return hn.className=m.CONTROL_GROUP+" "+m.CONTROL_BASE,Mr&&(Mr[E.LINE]&&(Yr[E.LINE]=Ri(E.LINE,{container:hn,className:m.CONTROL_BUTTON_LINE,title:"LineString tool "+(er.options.keybindings?"(l)":""),onActivate:function(){return er.events.changeMode(A.DRAW_LINE_STRING)},onDeactivate:function(){return er.events.trash()}})),Mr[E.POLYGON]&&(Yr[E.POLYGON]=Ri(E.POLYGON,{container:hn,className:m.CONTROL_BUTTON_POLYGON,title:"Polygon tool "+(er.options.keybindings?"(p)":""),onActivate:function(){return er.events.changeMode(A.DRAW_POLYGON)},onDeactivate:function(){return er.events.trash()}})),Mr[E.POINT]&&(Yr[E.POINT]=Ri(E.POINT,{container:hn,className:m.CONTROL_BUTTON_POINT,title:"Marker tool "+(er.options.keybindings?"(m)":""),onActivate:function(){return er.events.changeMode(A.DRAW_POINT)},onDeactivate:function(){return er.events.trash()}})),Mr.trash&&(Yr.trash=Ri("trash",{container:hn,className:m.CONTROL_BUTTON_TRASH,title:"Delete",onActivate:function(){er.events.trash()}})),Mr.combine_features&&(Yr.combine_features=Ri("combineFeatures",{container:hn,className:m.CONTROL_BUTTON_COMBINE_FEATURES,title:"Combine",onActivate:function(){er.events.combineFeatures()}})),Mr.uncombine_features&&(Yr.uncombine_features=Ri("uncombineFeatures",{container:hn,className:m.CONTROL_BUTTON_UNCOMBINE_FEATURES,title:"Uncombine",onActivate:function(){er.events.uncombineFeatures()}}))),hn},removeButtons:function(){Object.keys(Yr).forEach((function(Mr){var hn=Yr[Mr];hn.parentNode&&hn.parentNode.removeChild(hn),delete Yr[Mr]}))}}})(ee),ee.container=Vt.getContainer(),ee.store=new Xt(ee),pe=ee.ui.addButtons(),ee.options.boxSelect&&(ee.boxZoomInitial=Vt.boxZoom.isEnabled(),Vt.boxZoom.disable(),Vt.dragPan.disable(),Vt.dragPan.enable()),Vt.loaded()?It.connect():(Vt.on("load",It.connect),Ke=setInterval((function(){Vt.loaded()&&It.connect()}),16)),ee.events.start(),pe},addLayers:function(){ee.map.addSource(b.COLD,{data:{type:T.FEATURE_COLLECTION,features:[]},type:"geojson"}),ee.map.addSource(b.HOT,{data:{type:T.FEATURE_COLLECTION,features:[]},type:"geojson"}),ee.options.styles.forEach((function(Vt){ee.map.addLayer(Vt)})),ee.store.setDirty(!0),ee.store.render()},removeLayers:function(){ee.options.styles.forEach((function(Vt){ee.map.getLayer(Vt.id)&&ee.map.removeLayer(Vt.id)})),ee.map.getSource(b.COLD)&&ee.map.removeSource(b.COLD),ee.map.getSource(b.HOT)&&ee.map.removeSource(b.HOT)}};return ee.setup=It,It}var Cr=[{id:"gl-draw-polygon-fill-inactive",type:"fill",filter:["all",["==","active","false"],["==","$type","Polygon"],["!=","mode","static"]],paint:{"fill-color":"#3bb2d0","fill-outline-color":"#3bb2d0","fill-opacity":.1}},{id:"gl-draw-polygon-fill-active",type:"fill",filter:["all",["==","active","true"],["==","$type","Polygon"]],paint:{"fill-color":"#fbb03b","fill-outline-color":"#fbb03b","fill-opacity":.1}},{id:"gl-draw-polygon-midpoint",type:"circle",filter:["all",["==","$type","Point"],["==","meta","midpoint"]],paint:{"circle-radius":3,"circle-color":"#fbb03b"}},{id:"gl-draw-polygon-stroke-inactive",type:"line",filter:["all",["==","active","false"],["==","$type","Polygon"],["!=","mode","static"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#3bb2d0","line-width":2}},{id:"gl-draw-polygon-stroke-active",type:"line",filter:["all",["==","active","true"],["==","$type","Polygon"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#fbb03b","line-dasharray":[.2,2],"line-width":2}},{id:"gl-draw-line-inactive",type:"line",filter:["all",["==","active","false"],["==","$type","LineString"],["!=","mode","static"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#3bb2d0","line-width":2}},{id:"gl-draw-line-active",type:"line",filter:["all",["==","$type","LineString"],["==","active","true"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#fbb03b","line-dasharray":[.2,2],"line-width":2}},{id:"gl-draw-polygon-and-line-vertex-stroke-inactive",type:"circle",filter:["all",["==","meta","vertex"],["==","$type","Point"],["!=","mode","static"]],paint:{"circle-radius":5,"circle-color":"#fff"}},{id:"gl-draw-polygon-and-line-vertex-inactive",type:"circle",filter:["all",["==","meta","vertex"],["==","$type","Point"],["!=","mode","static"]],paint:{"circle-radius":3,"circle-color":"#fbb03b"}},{id:"gl-draw-point-point-stroke-inactive",type:"circle",filter:["all",["==","active","false"],["==","$type","Point"],["==","meta","feature"],["!=","mode","static"]],paint:{"circle-radius":5,"circle-opacity":1,"circle-color":"#fff"}},{id:"gl-draw-point-inactive",type:"circle",filter:["all",["==","active","false"],["==","$type","Point"],["==","meta","feature"],["!=","mode","static"]],paint:{"circle-radius":3,"circle-color":"#3bb2d0"}},{id:"gl-draw-point-stroke-active",type:"circle",filter:["all",["==","$type","Point"],["==","active","true"],["!=","meta","midpoint"]],paint:{"circle-radius":7,"circle-color":"#fff"}},{id:"gl-draw-point-active",type:"circle",filter:["all",["==","$type","Point"],["!=","meta","midpoint"],["==","active","true"]],paint:{"circle-radius":5,"circle-color":"#fbb03b"}},{id:"gl-draw-polygon-fill-static",type:"fill",filter:["all",["==","mode","static"],["==","$type","Polygon"]],paint:{"fill-color":"#404040","fill-outline-color":"#404040","fill-opacity":.1}},{id:"gl-draw-polygon-stroke-static",type:"line",filter:["all",["==","mode","static"],["==","$type","Polygon"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#404040","line-width":2}},{id:"gl-draw-line-static",type:"line",filter:["all",["==","mode","static"],["==","$type","LineString"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#404040","line-width":2}},{id:"gl-draw-point-static",type:"circle",filter:["all",["==","mode","static"],["==","$type","Point"]],paint:{"circle-radius":5,"circle-color":"#404040"}}];function Er(ee){return function(pe){var Ke=pe.featureTarget;return!!Ke&&!!Ke.properties&&Ke.properties.meta===ee}}function Jt(ee){return!!ee.originalEvent&&!!ee.originalEvent.shiftKey&&ee.originalEvent.button===0}function ot(ee){return!!ee.featureTarget&&!!ee.featureTarget.properties&&ee.featureTarget.properties.active===O.ACTIVE&&ee.featureTarget.properties.meta===N.FEATURE}function Ce(ee){return!!ee.featureTarget&&!!ee.featureTarget.properties&&ee.featureTarget.properties.active===O.INACTIVE&&ee.featureTarget.properties.meta===N.FEATURE}function xe(ee){return ee.featureTarget===void 0}function je(ee){return!!ee.featureTarget&&!!ee.featureTarget.properties&&ee.featureTarget.properties.meta===N.FEATURE}function qe(ee){var pe=ee.featureTarget;return!!pe&&!!pe.properties&&pe.properties.meta===N.VERTEX}function Ge(ee){return!!ee.originalEvent&&ee.originalEvent.shiftKey===!0}function Ft(ee){return ee.keyCode===27}function Et(ee){return ee.keyCode===13}var mt=Object.freeze({__proto__:null,isOfMetaType:Er,isShiftMousedown:Jt,isActiveFeature:ot,isInactiveFeature:Ce,noTarget:xe,isFeature:je,isVertex:qe,isShiftDown:Ge,isEscapeKey:Ft,isEnterKey:Et,isTrue:function(){return!0}}),ct=Qt;function Qt(ee,pe){this.x=ee,this.y=pe}Qt.prototype={clone:function(){return new Qt(this.x,this.y)},add:function(ee){return this.clone()._add(ee)},sub:function(ee){return this.clone()._sub(ee)},multByPoint:function(ee){return this.clone()._multByPoint(ee)},divByPoint:function(ee){return this.clone()._divByPoint(ee)},mult:function(ee){return this.clone()._mult(ee)},div:function(ee){return this.clone()._div(ee)},rotate:function(ee){return this.clone()._rotate(ee)},rotateAround:function(ee,pe){return this.clone()._rotateAround(ee,pe)},matMult:function(ee){return this.clone()._matMult(ee)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(ee){return this.x===ee.x&&this.y===ee.y},dist:function(ee){return Math.sqrt(this.distSqr(ee))},distSqr:function(ee){var pe=ee.x-this.x,Ke=ee.y-this.y;return pe*pe+Ke*Ke},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(ee){return Math.atan2(this.y-ee.y,this.x-ee.x)},angleWith:function(ee){return this.angleWithSep(ee.x,ee.y)},angleWithSep:function(ee,pe){return Math.atan2(this.x*pe-this.y*ee,this.x*ee+this.y*pe)},_matMult:function(ee){var pe=ee[0]*this.x+ee[1]*this.y,Ke=ee[2]*this.x+ee[3]*this.y;return this.x=pe,this.y=Ke,this},_add:function(ee){return this.x+=ee.x,this.y+=ee.y,this},_sub:function(ee){return this.x-=ee.x,this.y-=ee.y,this},_mult:function(ee){return this.x*=ee,this.y*=ee,this},_div:function(ee){return this.x/=ee,this.y/=ee,this},_multByPoint:function(ee){return this.x*=ee.x,this.y*=ee.y,this},_divByPoint:function(ee){return this.x/=ee.x,this.y/=ee.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var ee=this.y;return this.y=this.x,this.x=-ee,this},_rotate:function(ee){var pe=Math.cos(ee),Ke=Math.sin(ee),It=pe*this.x-Ke*this.y,Vt=Ke*this.x+pe*this.y;return this.x=It,this.y=Vt,this},_rotateAround:function(ee,pe){var Ke=Math.cos(ee),It=Math.sin(ee),Vt=pe.x+Ke*(this.x-pe.x)-It*(this.y-pe.y),qt=pe.y+It*(this.x-pe.x)+Ke*(this.y-pe.y);return this.x=Vt,this.y=qt,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},Qt.convert=function(ee){return ee instanceof Qt?ee:Array.isArray(ee)?new Qt(ee[0],ee[1]):ee};var Ht=n(ct);function Ir(ee,pe){var Ke=pe.getBoundingClientRect();return new Ht(ee.clientX-Ke.left-(pe.clientLeft||0),ee.clientY-Ke.top-(pe.clientTop||0))}function Ar(ee,pe,Ke,It){return{type:T.FEATURE,properties:{meta:N.VERTEX,parent:ee,coord_path:Ke,active:It?O.ACTIVE:O.INACTIVE},geometry:{type:T.POINT,coordinates:pe}}}function $r(ee,pe,Ke){var It=pe.geometry.coordinates,Vt=Ke.geometry.coordinates;if(It[1]>85||It[1]<j||Vt[1]>85||Vt[1]<j)return null;var qt={lng:(It[0]+Vt[0])/2,lat:(It[1]+Vt[1])/2};return{type:T.FEATURE,properties:{meta:N.MIDPOINT,parent:ee,lng:qt.lng,lat:qt.lat,coord_path:Ke.properties.coord_path},geometry:{type:T.POINT,coordinates:[qt.lng,qt.lat]}}}function fn(ee,pe,Ke){pe===void 0&&(pe={}),Ke===void 0&&(Ke=null);var It,Vt=ee.geometry,qt=Vt.type,er=Vt.coordinates,Yr=ee.properties&&ee.properties.id,tn=[];function Gr(kr,ti){var Ri="",$n=null;kr.forEach((function(_n,Mr){var hn=ti!=null?ti+"."+Mr:String(Mr),mn=Ar(Yr,_n,hn,on(hn));if(pe.midpoints&&$n){var fi=$r(Yr,$n,mn);fi&&tn.push(fi)}$n=mn;var $i=JSON.stringify(_n);Ri!==$i&&tn.push(mn),Mr===0&&(Ri=$i)}))}function on(kr){return!!pe.selectedPaths&&pe.selectedPaths.indexOf(kr)!==-1}return qt===T.POINT?tn.push(Ar(Yr,er,Ke,on(Ke))):qt===T.POLYGON?er.forEach((function(kr,ti){Gr(kr,Ke!==null?Ke+"."+ti:String(ti))})):qt===T.LINE_STRING?Gr(er,Ke):qt.indexOf(T.MULTI_PREFIX)===0&&(It=qt.replace(T.MULTI_PREFIX,""),er.forEach((function(kr,ti){var Ri={type:T.FEATURE,properties:ee.properties,geometry:{type:It,coordinates:kr}};tn=tn.concat(fn(Ri,pe,ti))}))),tn}var zr={enable:function(ee){setTimeout((function(){ee.map&&ee.map.doubleClickZoom&&ee._ctx&&ee._ctx.store&&ee._ctx.store.getInitialConfigValue&&ee._ctx.store.getInitialConfigValue("doubleClickZoom")&&ee.map.doubleClickZoom.enable()}),0)},disable:function(ee){setTimeout((function(){ee.map&&ee.map.doubleClickZoom&&ee.map.doubleClickZoom.disable()}),0)}},Mt={exports:{}},en=function(ee){if(!ee||!ee.type)return null;var pe=jn[ee.type];if(!pe)return null;if(pe==="geometry")return{type:"FeatureCollection",features:[{type:"Feature",properties:{},geometry:ee}]};if(pe==="feature")return{type:"FeatureCollection",features:[ee]};if(pe==="featurecollection")return ee},jn={Point:"geometry",MultiPoint:"geometry",LineString:"geometry",MultiLineString:"geometry",Polygon:"geometry",MultiPolygon:"geometry",GeometryCollection:"geometry",Feature:"feature",FeatureCollection:"featurecollection"},Qr=n(en),nr=Object.freeze({__proto__:null,default:function ee(pe){switch(pe&&pe.type||null){case"FeatureCollection":return pe.features=pe.features.reduce((function(Ke,It){return Ke.concat(ee(It))}),[]),pe;case"Feature":return pe.geometry?ee(pe.geometry).map((function(Ke){var It={type:"Feature",properties:JSON.parse(JSON.stringify(pe.properties)),geometry:Ke};return pe.id!==void 0&&(It.id=pe.id),It})):[pe];case"MultiPoint":return pe.coordinates.map((function(Ke){return{type:"Point",coordinates:Ke}}));case"MultiPolygon":return pe.coordinates.map((function(Ke){return{type:"Polygon",coordinates:Ke}}));case"MultiLineString":return pe.coordinates.map((function(Ke){return{type:"LineString",coordinates:Ke}}));case"GeometryCollection":return pe.geometries.map(ee).reduce((function(Ke,It){return Ke.concat(It)}),[]);case"Point":case"Polygon":case"LineString":return[pe]}}}),oi=en,un=i(nr),Kn=function(ee){return(function pe(Ke){return Array.isArray(Ke)&&Ke.length&&typeof Ke[0]=="number"?[Ke]:Ke.reduce((function(It,Vt){return Array.isArray(Vt)&&Array.isArray(Vt[0])?It.concat(pe(Vt)):(It.push(Vt),It)}),[])})(ee)};un instanceof Function||(un=un.default);var Re={exports:{}},He=Re.exports=function(ee){return new Tt(ee)};function Tt(ee){this.value=ee}function Gt(ee,pe,Ke){var It=[],Vt=[],qt=!0;return(function er(Yr){var tn=Ke?Ut(Yr):Yr,Gr={},on=!0,kr={node:tn,node_:Yr,path:[].concat(It),parent:Vt[Vt.length-1],parents:Vt,key:It.slice(-1)[0],isRoot:It.length===0,level:It.length,circular:null,update:function($n,_n){kr.isRoot||(kr.parent.node[kr.key]=$n),kr.node=$n,_n&&(on=!1)},delete:function($n){delete kr.parent.node[kr.key],$n&&(on=!1)},remove:function($n){Bi(kr.parent.node)?kr.parent.node.splice(kr.key,1):delete kr.parent.node[kr.key],$n&&(on=!1)},keys:null,before:function($n){Gr.before=$n},after:function($n){Gr.after=$n},pre:function($n){Gr.pre=$n},post:function($n){Gr.post=$n},stop:function(){qt=!1},block:function(){on=!1}};if(!qt)return kr;function ti(){if(typeof kr.node=="object"&&kr.node!==null){kr.keys&&kr.node_===kr.node||(kr.keys=Xr(kr.node)),kr.isLeaf=kr.keys.length==0;for(var $n=0;$n<Vt.length;$n++)if(Vt[$n].node_===Yr){kr.circular=Vt[$n];break}}else kr.isLeaf=!0,kr.keys=null;kr.notLeaf=!kr.isLeaf,kr.notRoot=!kr.isRoot}ti();var Ri=pe.call(kr,kr.node);return Ri!==void 0&&kr.update&&kr.update(Ri),Gr.before&&Gr.before.call(kr,kr.node),on&&(typeof kr.node!="object"||kr.node===null||kr.circular||(Vt.push(kr),ti(),Ci(kr.keys,(function($n,_n){It.push($n),Gr.pre&&Gr.pre.call(kr,kr.node[$n],$n);var Mr=er(kr.node[$n]);Ke&&Fr.call(kr.node,$n)&&(kr.node[$n]=Mr.node),Mr.isLast=_n==kr.keys.length-1,Mr.isFirst=_n==0,Gr.post&&Gr.post.call(kr,Mr),It.pop()})),Vt.pop()),Gr.after&&Gr.after.call(kr,kr.node)),kr})(ee).node}function Ut(ee){if(typeof ee=="object"&&ee!==null){var pe;if(Bi(ee))pe=[];else if(Nn(ee)==="[object Date]")pe=new Date(ee.getTime?ee.getTime():ee);else if((function(Vt){return Nn(Vt)==="[object RegExp]"})(ee))pe=new RegExp(ee);else if((function(Vt){return Nn(Vt)==="[object Error]"})(ee))pe={message:ee.message};else if((function(Vt){return Nn(Vt)==="[object Boolean]"})(ee))pe=new Boolean(ee);else if((function(Vt){return Nn(Vt)==="[object Number]"})(ee))pe=new Number(ee);else if((function(Vt){return Nn(Vt)==="[object String]"})(ee))pe=new String(ee);else if(Object.create&&Object.getPrototypeOf)pe=Object.create(Object.getPrototypeOf(ee));else if(ee.constructor===Object)pe={};else{var Ke=ee.constructor&&ee.constructor.prototype||ee.__proto__||{},It=function(){};It.prototype=Ke,pe=new It}return Ci(Xr(ee),(function(Vt){pe[Vt]=ee[Vt]})),pe}return ee}Tt.prototype.get=function(ee){for(var pe=this.value,Ke=0;Ke<ee.length;Ke++){var It=ee[Ke];if(!pe||!Fr.call(pe,It)){pe=void 0;break}pe=pe[It]}return pe},Tt.prototype.has=function(ee){for(var pe=this.value,Ke=0;Ke<ee.length;Ke++){var It=ee[Ke];if(!pe||!Fr.call(pe,It))return!1;pe=pe[It]}return!0},Tt.prototype.set=function(ee,pe){for(var Ke=this.value,It=0;It<ee.length-1;It++){var Vt=ee[It];Fr.call(Ke,Vt)||(Ke[Vt]={}),Ke=Ke[Vt]}return Ke[ee[It]]=pe,pe},Tt.prototype.map=function(ee){return Gt(this.value,ee,!0)},Tt.prototype.forEach=function(ee){return this.value=Gt(this.value,ee,!1),this.value},Tt.prototype.reduce=function(ee,pe){var Ke=arguments.length===1,It=Ke?this.value:pe;return this.forEach((function(Vt){this.isRoot&&Ke||(It=ee.call(this,It,Vt))})),It},Tt.prototype.paths=function(){var ee=[];return this.forEach((function(pe){ee.push(this.path)})),ee},Tt.prototype.nodes=function(){var ee=[];return this.forEach((function(pe){ee.push(this.node)})),ee},Tt.prototype.clone=function(){var ee=[],pe=[];return(function Ke(It){for(var Vt=0;Vt<ee.length;Vt++)if(ee[Vt]===It)return pe[Vt];if(typeof It=="object"&&It!==null){var qt=Ut(It);return ee.push(It),pe.push(qt),Ci(Xr(It),(function(er){qt[er]=Ke(It[er])})),ee.pop(),pe.pop(),qt}return It})(this.value)};var Xr=Object.keys||function(ee){var pe=[];for(var Ke in ee)pe.push(Ke);return pe};function Nn(ee){return Object.prototype.toString.call(ee)}var Bi=Array.isArray||function(ee){return Object.prototype.toString.call(ee)==="[object Array]"},Ci=function(ee,pe){if(ee.forEach)return ee.forEach(pe);for(var Ke=0;Ke<ee.length;Ke++)pe(ee[Ke],Ke,ee)};Ci(Xr(Tt.prototype),(function(ee){He[ee]=function(pe){var Ke=[].slice.call(arguments,1),It=new Tt(pe);return It[ee].apply(It,Ke)}}));var Fr=Object.hasOwnProperty||function(ee,pe){return pe in ee},Mn=Re.exports,Bn=ei;function ei(ee){if(!(this instanceof ei))return new ei(ee);this._bbox=ee||[1/0,1/0,-1/0,-1/0],this._valid=!!ee}ei.prototype.include=function(ee){return this._valid=!0,this._bbox[0]=Math.min(this._bbox[0],ee[0]),this._bbox[1]=Math.min(this._bbox[1],ee[1]),this._bbox[2]=Math.max(this._bbox[2],ee[0]),this._bbox[3]=Math.max(this._bbox[3],ee[1]),this},ei.prototype.equals=function(ee){var pe;return pe=ee instanceof ei?ee.bbox():ee,this._bbox[0]==pe[0]&&this._bbox[1]==pe[1]&&this._bbox[2]==pe[2]&&this._bbox[3]==pe[3]},ei.prototype.center=function(ee){return this._valid?[(this._bbox[0]+this._bbox[2])/2,(this._bbox[1]+this._bbox[3])/2]:null},ei.prototype.union=function(ee){var pe;return this._valid=!0,pe=ee instanceof ei?ee.bbox():ee,this._bbox[0]=Math.min(this._bbox[0],pe[0]),this._bbox[1]=Math.min(this._bbox[1],pe[1]),this._bbox[2]=Math.max(this._bbox[2],pe[2]),this._bbox[3]=Math.max(this._bbox[3],pe[3]),this},ei.prototype.bbox=function(){return this._valid?this._bbox:null},ei.prototype.contains=function(ee){if(!ee)return this._fastContains();if(!this._valid)return null;var pe=ee[0],Ke=ee[1];return this._bbox[0]<=pe&&this._bbox[1]<=Ke&&this._bbox[2]>=pe&&this._bbox[3]>=Ke},ei.prototype.intersect=function(ee){return this._valid?(pe=ee instanceof ei?ee.bbox():ee,!(this._bbox[0]>pe[2]||this._bbox[2]<pe[0]||this._bbox[3]<pe[1]||this._bbox[1]>pe[3])):null;var pe},ei.prototype._fastContains=function(){if(!this._valid)return new Function("return null;");var ee="return "+this._bbox[0]+"<= ll[0] &&"+this._bbox[1]+"<= ll[1] &&"+this._bbox[2]+">= ll[0] &&"+this._bbox[3]+">= ll[1]";return new Function("ll",ee)},ei.prototype.polygon=function(){return this._valid?{type:"Polygon",coordinates:[[[this._bbox[0],this._bbox[1]],[this._bbox[2],this._bbox[1]],[this._bbox[2],this._bbox[3]],[this._bbox[0],this._bbox[3]],[this._bbox[0],this._bbox[1]]]]}:null};var ua=function(ee){if(!ee)return[];var pe=un(oi(ee)),Ke=[];return pe.features.forEach((function(It){It.geometry&&(Ke=Ke.concat(Kn(It.geometry.coordinates)))})),Ke},ha=Mn,zn=Bn,La={features:["FeatureCollection"],coordinates:["Point","MultiPoint","LineString","MultiLineString","Polygon","MultiPolygon"],geometry:["Feature"],geometries:["GeometryCollection"]},Wi=Object.keys(La);function hs(ee){for(var pe=zn(),Ke=ua(ee),It=0;It<Ke.length;It++)pe.include(Ke[It]);return pe}Mt.exports=function(ee){return hs(ee).bbox()},Mt.exports.polygon=function(ee){return hs(ee).polygon()},Mt.exports.bboxify=function(ee){return ha(ee).map((function(pe){pe&&Wi.some((function(Ke){return!!pe[Ke]&&La[Ke].indexOf(pe.type)!==-1}))&&(pe.bbox=hs(pe).bbox(),this.update(pe))}))};var Ca=n(Mt.exports),Mo=-90;function Ya(ee,pe){var Ke=Mo,It=90,Vt=Mo,qt=90,er=270,Yr=-270;ee.forEach((function(Gr){var on=Ca(Gr),kr=on[1],ti=on[3],Ri=on[0],$n=on[2];kr>Ke&&(Ke=kr),ti<It&&(It=ti),ti>Vt&&(Vt=ti),kr<qt&&(qt=kr),Ri<er&&(er=Ri),$n>Yr&&(Yr=$n)}));var tn=pe;return Ke+tn.lat>85&&(tn.lat=85-Ke),Vt+tn.lat>90&&(tn.lat=90-Vt),It+tn.lat<-85&&(tn.lat=-85-It),qt+tn.lat<Mo&&(tn.lat=Mo-qt),er+tn.lng<=-270&&(tn.lng+=360*Math.ceil(Math.abs(tn.lng)/360)),Yr+tn.lng>=270&&(tn.lng-=360*Math.ceil(Math.abs(tn.lng)/360)),tn}function ol(ee,pe){var Ke=Ya(ee.map((function(It){return It.toGeoJSON()})),pe);ee.forEach((function(It){var Vt,qt=It.getCoordinates(),er=function(tn){var Gr={lng:tn[0]+Ke.lng,lat:tn[1]+Ke.lat};return[Gr.lng,Gr.lat]},Yr=function(tn){return tn.map((function(Gr){return er(Gr)}))};It.type===T.POINT?Vt=er(qt):It.type===T.LINE_STRING||It.type===T.MULTI_POINT?Vt=qt.map(er):It.type===T.POLYGON||It.type===T.MULTI_LINE_STRING?Vt=qt.map(Yr):It.type===T.MULTI_POLYGON&&(Vt=qt.map((function(tn){return tn.map((function(Gr){return Yr(Gr)}))}))),It.incomingCoords(Vt)}))}var xi={onSetup:function(ee){var pe=this,Ke={dragMoveLocation:null,boxSelectStartLocation:null,boxSelectElement:void 0,boxSelecting:!1,canBoxSelect:!1,dragMoving:!1,canDragMove:!1,initiallySelectedFeatureIds:ee.featureIds||[]};return this.setSelected(Ke.initiallySelectedFeatureIds.filter((function(It){return pe.getFeature(It)!==void 0}))),this.fireActionable(),this.setActionableState({combineFeatures:!0,uncombineFeatures:!0,trash:!0}),Ke},fireUpdate:function(){this.map.fire(M.UPDATE,{action:F.MOVE,features:this.getSelected().map((function(ee){return ee.toGeoJSON()}))})},fireActionable:function(){var ee=this,pe=this.getSelected(),Ke=pe.filter((function(Yr){return ee.isInstanceOf("MultiFeature",Yr)})),It=!1;if(pe.length>1){It=!0;var Vt=pe[0].type.replace("Multi","");pe.forEach((function(Yr){Yr.type.replace("Multi","")!==Vt&&(It=!1)}))}var qt=Ke.length>0,er=pe.length>0;this.setActionableState({combineFeatures:It,uncombineFeatures:qt,trash:er})},getUniqueIds:function(ee){return ee.length?ee.map((function(pe){return pe.properties.id})).filter((function(pe){return pe!==void 0})).reduce((function(pe,Ke){return pe.add(Ke),pe}),new G).values():[]},stopExtendedInteractions:function(ee){ee.boxSelectElement&&(ee.boxSelectElement.parentNode&&ee.boxSelectElement.parentNode.removeChild(ee.boxSelectElement),ee.boxSelectElement=null),this.map.dragPan.enable(),ee.boxSelecting=!1,ee.canBoxSelect=!1,ee.dragMoving=!1,ee.canDragMove=!1},onStop:function(){zr.enable(this)},onMouseMove:function(ee,pe){return je(pe)&&ee.dragMoving&&this.fireUpdate(),this.stopExtendedInteractions(ee),!0},onMouseOut:function(ee){return!ee.dragMoving||this.fireUpdate()}};xi.onTap=xi.onClick=function(ee,pe){return xe(pe)?this.clickAnywhere(ee,pe):Er(N.VERTEX)(pe)?this.clickOnVertex(ee,pe):je(pe)?this.clickOnFeature(ee,pe):void 0},xi.clickAnywhere=function(ee){var pe=this,Ke=this.getSelectedIds();Ke.length&&(this.clearSelectedFeatures(),Ke.forEach((function(It){return pe.doRender(It)}))),zr.enable(this),this.stopExtendedInteractions(ee)},xi.clickOnVertex=function(ee,pe){this.changeMode(A.DIRECT_SELECT,{featureId:pe.featureTarget.properties.parent,coordPath:pe.featureTarget.properties.coord_path,startPos:pe.lngLat}),this.updateUIClasses({mouse:x.MOVE})},xi.startOnActiveFeature=function(ee,pe){this.stopExtendedInteractions(ee),this.map.dragPan.disable(),this.doRender(pe.featureTarget.properties.id),ee.canDragMove=!0,ee.dragMoveLocation=pe.lngLat},xi.clickOnFeature=function(ee,pe){var Ke=this;zr.disable(this),this.stopExtendedInteractions(ee);var It=Ge(pe),Vt=this.getSelectedIds(),qt=pe.featureTarget.properties.id,er=this.isSelected(qt);if(!It&&er&&this.getFeature(qt).type!==T.POINT)return this.changeMode(A.DIRECT_SELECT,{featureId:qt});er&&It?(this.deselect(qt),this.updateUIClasses({mouse:x.POINTER}),Vt.length===1&&zr.enable(this)):!er&&It?(this.select(qt),this.updateUIClasses({mouse:x.MOVE})):er||It||(Vt.forEach((function(Yr){return Ke.doRender(Yr)})),this.setSelected(qt),this.updateUIClasses({mouse:x.MOVE})),this.doRender(qt)},xi.onMouseDown=function(ee,pe){return ot(pe)?this.startOnActiveFeature(ee,pe):this.drawConfig.boxSelect&&Jt(pe)?this.startBoxSelect(ee,pe):void 0},xi.startBoxSelect=function(ee,pe){this.stopExtendedInteractions(ee),this.map.dragPan.disable(),ee.boxSelectStartLocation=Ir(pe.originalEvent,this.map.getContainer()),ee.canBoxSelect=!0},xi.onTouchStart=function(ee,pe){if(ot(pe))return this.startOnActiveFeature(ee,pe)},xi.onDrag=function(ee,pe){return ee.canDragMove?this.dragMove(ee,pe):this.drawConfig.boxSelect&&ee.canBoxSelect?this.whileBoxSelect(ee,pe):void 0},xi.whileBoxSelect=function(ee,pe){ee.boxSelecting=!0,this.updateUIClasses({mouse:x.ADD}),ee.boxSelectElement||(ee.boxSelectElement=document.createElement("div"),ee.boxSelectElement.classList.add(m.BOX_SELECT),this.map.getContainer().appendChild(ee.boxSelectElement));var Ke=Ir(pe.originalEvent,this.map.getContainer()),It=Math.min(ee.boxSelectStartLocation.x,Ke.x),Vt=Math.max(ee.boxSelectStartLocation.x,Ke.x),qt=Math.min(ee.boxSelectStartLocation.y,Ke.y),er=Math.max(ee.boxSelectStartLocation.y,Ke.y),Yr="translate("+It+"px, "+qt+"px)";ee.boxSelectElement.style.transform=Yr,ee.boxSelectElement.style.WebkitTransform=Yr,ee.boxSelectElement.style.width=Vt-It+"px",ee.boxSelectElement.style.height=er-qt+"px"},xi.dragMove=function(ee,pe){ee.dragMoving=!0,pe.originalEvent.stopPropagation();var Ke={lng:pe.lngLat.lng-ee.dragMoveLocation.lng,lat:pe.lngLat.lat-ee.dragMoveLocation.lat};ol(this.getSelected(),Ke),ee.dragMoveLocation=pe.lngLat},xi.onTouchEnd=xi.onMouseUp=function(ee,pe){var Ke=this;if(ee.dragMoving)this.fireUpdate();else if(ee.boxSelecting){var It=[ee.boxSelectStartLocation,Ir(pe.originalEvent,this.map.getContainer())],Vt=this.featuresAt(null,It,"click"),qt=this.getUniqueIds(Vt).filter((function(er){return!Ke.isSelected(er)}));qt.length&&(this.select(qt),qt.forEach((function(er){return Ke.doRender(er)})),this.updateUIClasses({mouse:x.MOVE}))}this.stopExtendedInteractions(ee)},xi.toDisplayFeatures=function(ee,pe,Ke){pe.properties.active=this.isSelected(pe.properties.id)?O.ACTIVE:O.INACTIVE,Ke(pe),this.fireActionable(),pe.properties.active===O.ACTIVE&&pe.geometry.type!==T.POINT&&fn(pe).forEach(Ke)},xi.onTrash=function(){this.deleteFeature(this.getSelectedIds()),this.fireActionable()},xi.onCombineFeatures=function(){var ee=this.getSelected();if(!(ee.length===0||ee.length<2)){for(var pe=[],Ke=[],It=ee[0].type.replace("Multi",""),Vt=0;Vt<ee.length;Vt++){var qt=ee[Vt];if(qt.type.replace("Multi","")!==It)return;qt.type.includes("Multi")?qt.getCoordinates().forEach((function(Yr){pe.push(Yr)})):pe.push(qt.getCoordinates()),Ke.push(qt.toGeoJSON())}if(Ke.length>1){var er=this.newFeature({type:T.FEATURE,properties:Ke[0].properties,geometry:{type:"Multi"+It,coordinates:pe}});this.addFeature(er),this.deleteFeature(this.getSelectedIds(),{silent:!0}),this.setSelected([er.id]),this.map.fire(M.COMBINE_FEATURES,{createdFeatures:[er.toGeoJSON()],deletedFeatures:Ke})}this.fireActionable()}},xi.onUncombineFeatures=function(){var ee=this,pe=this.getSelected();if(pe.length!==0){for(var Ke=[],It=[],Vt=function(er){var Yr=pe[er];ee.isInstanceOf("MultiFeature",Yr)&&(Yr.getFeatures().forEach((function(tn){ee.addFeature(tn),tn.properties=Yr.properties,Ke.push(tn.toGeoJSON()),ee.select([tn.id])})),ee.deleteFeature(Yr.id,{silent:!0}),It.push(Yr.toGeoJSON()))},qt=0;qt<pe.length;qt++)Vt(qt);Ke.length>1&&this.map.fire(M.UNCOMBINE_FEATURES,{createdFeatures:Ke,deletedFeatures:It}),this.fireActionable()}};var zi=Er(N.VERTEX),Iu=Er(N.MIDPOINT),ga={fireUpdate:function(){this.map.fire(M.UPDATE,{action:F.CHANGE_COORDINATES,features:this.getSelected().map((function(ee){return ee.toGeoJSON()}))})},fireActionable:function(ee){this.setActionableState({combineFeatures:!1,uncombineFeatures:!1,trash:ee.selectedCoordPaths.length>0})},startDragging:function(ee,pe){this.map.dragPan.disable(),ee.canDragMove=!0,ee.dragMoveLocation=pe.lngLat},stopDragging:function(ee){this.map.dragPan.enable(),ee.dragMoving=!1,ee.canDragMove=!1,ee.dragMoveLocation=null},onVertex:function(ee,pe){this.startDragging(ee,pe);var Ke=pe.featureTarget.properties,It=ee.selectedCoordPaths.indexOf(Ke.coord_path);Ge(pe)||It!==-1?Ge(pe)&&It===-1&&ee.selectedCoordPaths.push(Ke.coord_path):ee.selectedCoordPaths=[Ke.coord_path];var Vt=this.pathsToCoordinates(ee.featureId,ee.selectedCoordPaths);this.setSelectedCoordinates(Vt)},onMidpoint:function(ee,pe){this.startDragging(ee,pe);var Ke=pe.featureTarget.properties;ee.feature.addCoordinate(Ke.coord_path,Ke.lng,Ke.lat),this.fireUpdate(),ee.selectedCoordPaths=[Ke.coord_path]},pathsToCoordinates:function(ee,pe){return pe.map((function(Ke){return{feature_id:ee,coord_path:Ke}}))},onFeature:function(ee,pe){ee.selectedCoordPaths.length===0?this.startDragging(ee,pe):this.stopDragging(ee)},dragFeature:function(ee,pe,Ke){ol(this.getSelected(),Ke),ee.dragMoveLocation=pe.lngLat},dragVertex:function(ee,pe,Ke){for(var It=ee.selectedCoordPaths.map((function(Yr){return ee.feature.getCoordinate(Yr)})),Vt=Ya(It.map((function(Yr){return{type:T.FEATURE,properties:{},geometry:{type:T.POINT,coordinates:Yr}}})),Ke),qt=0;qt<It.length;qt++){var er=It[qt];ee.feature.updateCoordinate(ee.selectedCoordPaths[qt],er[0]+Vt.lng,er[1]+Vt.lat)}},clickNoTarget:function(){this.changeMode(A.SIMPLE_SELECT)},clickInactive:function(){this.changeMode(A.SIMPLE_SELECT)},clickActiveFeature:function(ee){ee.selectedCoordPaths=[],this.clearSelectedCoordinates(),ee.feature.changed()},onSetup:function(ee){var pe=ee.featureId,Ke=this.getFeature(pe);if(!Ke)throw new Error("You must provide a featureId to enter direct_select mode");if(Ke.type===T.POINT)throw new TypeError("direct_select mode doesn't handle point features");var It={featureId:pe,feature:Ke,dragMoveLocation:ee.startPos||null,dragMoving:!1,canDragMove:!1,selectedCoordPaths:ee.coordPath?[ee.coordPath]:[]};return this.setSelectedCoordinates(this.pathsToCoordinates(pe,It.selectedCoordPaths)),this.setSelected(pe),zr.disable(this),this.setActionableState({trash:!0}),It},onStop:function(){zr.enable(this),this.clearSelectedCoordinates()},toDisplayFeatures:function(ee,pe,Ke){ee.featureId===pe.properties.id?(pe.properties.active=O.ACTIVE,Ke(pe),fn(pe,{map:this.map,midpoints:!0,selectedPaths:ee.selectedCoordPaths}).forEach(Ke)):(pe.properties.active=O.INACTIVE,Ke(pe)),this.fireActionable(ee)},onTrash:function(ee){ee.selectedCoordPaths.sort((function(pe,Ke){return Ke.localeCompare(pe,"en",{numeric:!0})})).forEach((function(pe){return ee.feature.removeCoordinate(pe)})),this.fireUpdate(),ee.selectedCoordPaths=[],this.clearSelectedCoordinates(),this.fireActionable(ee),ee.feature.isValid()===!1&&(this.deleteFeature([ee.featureId]),this.changeMode(A.SIMPLE_SELECT,{}))},onMouseMove:function(ee,pe){var Ke=ot(pe),It=zi(pe),Vt=Iu(pe),qt=ee.selectedCoordPaths.length===0;return Ke&&qt||It&&!qt?this.updateUIClasses({mouse:x.MOVE}):this.updateUIClasses({mouse:x.NONE}),(It||Ke||Vt)&&ee.dragMoving&&this.fireUpdate(),this.stopDragging(ee),!0},onMouseOut:function(ee){return ee.dragMoving&&this.fireUpdate(),!0}};ga.onTouchStart=ga.onMouseDown=function(ee,pe){return zi(pe)?this.onVertex(ee,pe):ot(pe)?this.onFeature(ee,pe):Iu(pe)?this.onMidpoint(ee,pe):void 0},ga.onDrag=function(ee,pe){if(ee.canDragMove===!0){ee.dragMoving=!0,pe.originalEvent.stopPropagation();var Ke={lng:pe.lngLat.lng-ee.dragMoveLocation.lng,lat:pe.lngLat.lat-ee.dragMoveLocation.lat};ee.selectedCoordPaths.length>0?this.dragVertex(ee,pe,Ke):this.dragFeature(ee,pe,Ke),ee.dragMoveLocation=pe.lngLat}},ga.onClick=function(ee,pe){return xe(pe)?this.clickNoTarget(ee,pe):ot(pe)?this.clickActiveFeature(ee,pe):Ce(pe)?this.clickInactive(ee,pe):void this.stopDragging(ee)},ga.onTap=function(ee,pe){return xe(pe)?this.clickNoTarget(ee,pe):ot(pe)?this.clickActiveFeature(ee,pe):Ce(pe)?this.clickInactive(ee,pe):void 0},ga.onTouchEnd=ga.onMouseUp=function(ee){ee.dragMoving&&this.fireUpdate(),this.stopDragging(ee)};var Za={};function ds(ee,pe){return!!ee.lngLat&&ee.lngLat.lng===pe[0]&&ee.lngLat.lat===pe[1]}Za.onSetup=function(){var ee=this.newFeature({type:T.FEATURE,properties:{},geometry:{type:T.POINT,coordinates:[]}});return this.addFeature(ee),this.clearSelectedFeatures(),this.updateUIClasses({mouse:x.ADD}),this.activateUIButton(E.POINT),this.setActionableState({trash:!0}),{point:ee}},Za.stopDrawingAndRemove=function(ee){this.deleteFeature([ee.point.id],{silent:!0}),this.changeMode(A.SIMPLE_SELECT)},Za.onTap=Za.onClick=function(ee,pe){this.updateUIClasses({mouse:x.MOVE}),ee.point.updateCoordinate("",pe.lngLat.lng,pe.lngLat.lat),this.map.fire(M.CREATE,{features:[ee.point.toGeoJSON()]}),this.changeMode(A.SIMPLE_SELECT,{featureIds:[ee.point.id]})},Za.onStop=function(ee){this.activateUIButton(),ee.point.getCoordinate().length||this.deleteFeature([ee.point.id],{silent:!0})},Za.toDisplayFeatures=function(ee,pe,Ke){var It=pe.properties.id===ee.point.id;if(pe.properties.active=It?O.ACTIVE:O.INACTIVE,!It)return Ke(pe)},Za.onTrash=Za.stopDrawingAndRemove,Za.onKeyUp=function(ee,pe){if(Ft(pe)||Et(pe))return this.stopDrawingAndRemove(ee,pe)};var Aa={onSetup:function(){var ee=this.newFeature({type:T.FEATURE,properties:{},geometry:{type:T.POLYGON,coordinates:[[]]}});return this.addFeature(ee),this.clearSelectedFeatures(),zr.disable(this),this.updateUIClasses({mouse:x.ADD}),this.activateUIButton(E.POLYGON),this.setActionableState({trash:!0}),{polygon:ee,currentVertexPosition:0}},clickAnywhere:function(ee,pe){if(ee.currentVertexPosition>0&&ds(pe,ee.polygon.coordinates[0][ee.currentVertexPosition-1]))return this.changeMode(A.SIMPLE_SELECT,{featureIds:[ee.polygon.id]});this.updateUIClasses({mouse:x.ADD}),ee.polygon.updateCoordinate("0."+ee.currentVertexPosition,pe.lngLat.lng,pe.lngLat.lat),ee.currentVertexPosition++,ee.polygon.updateCoordinate("0."+ee.currentVertexPosition,pe.lngLat.lng,pe.lngLat.lat)},clickOnVertex:function(ee){return this.changeMode(A.SIMPLE_SELECT,{featureIds:[ee.polygon.id]})},onMouseMove:function(ee,pe){ee.polygon.updateCoordinate("0."+ee.currentVertexPosition,pe.lngLat.lng,pe.lngLat.lat),qe(pe)&&this.updateUIClasses({mouse:x.POINTER})}};Aa.onTap=Aa.onClick=function(ee,pe){return qe(pe)?this.clickOnVertex(ee,pe):this.clickAnywhere(ee,pe)},Aa.onKeyUp=function(ee,pe){Ft(pe)?(this.deleteFeature([ee.polygon.id],{silent:!0}),this.changeMode(A.SIMPLE_SELECT)):Et(pe)&&this.changeMode(A.SIMPLE_SELECT,{featureIds:[ee.polygon.id]})},Aa.onStop=function(ee){this.updateUIClasses({mouse:x.NONE}),zr.enable(this),this.activateUIButton(),this.getFeature(ee.polygon.id)!==void 0&&(ee.polygon.removeCoordinate("0."+ee.currentVertexPosition),ee.polygon.isValid()?this.map.fire(M.CREATE,{features:[ee.polygon.toGeoJSON()]}):(this.deleteFeature([ee.polygon.id],{silent:!0}),this.changeMode(A.SIMPLE_SELECT,{},{silent:!0})))},Aa.toDisplayFeatures=function(ee,pe,Ke){var It=pe.properties.id===ee.polygon.id;if(pe.properties.active=It?O.ACTIVE:O.INACTIVE,!It)return Ke(pe);if(pe.geometry.coordinates.length!==0){var Vt=pe.geometry.coordinates[0].length;if(!(Vt<3)){if(pe.properties.meta=N.FEATURE,Ke(Ar(ee.polygon.id,pe.geometry.coordinates[0][0],"0.0",!1)),Vt>3){var qt=pe.geometry.coordinates[0].length-3;Ke(Ar(ee.polygon.id,pe.geometry.coordinates[0][qt],"0."+qt,!1))}if(Vt<=4){var er=[[pe.geometry.coordinates[0][0][0],pe.geometry.coordinates[0][0][1]],[pe.geometry.coordinates[0][1][0],pe.geometry.coordinates[0][1][1]]];if(Ke({type:T.FEATURE,properties:pe.properties,geometry:{coordinates:er,type:T.LINE_STRING}}),Vt===3)return}return Ke(pe)}}},Aa.onTrash=function(ee){this.deleteFeature([ee.polygon.id],{silent:!0}),this.changeMode(A.SIMPLE_SELECT)};var ps={onSetup:function(ee){var pe,Ke,It=(ee=ee||{}).featureId,Vt="forward";if(It){if(!(pe=this.getFeature(It)))throw new Error("Could not find a feature with the provided featureId");var qt=ee.from;if(qt&&qt.type==="Feature"&&qt.geometry&&qt.geometry.type==="Point"&&(qt=qt.geometry),qt&&qt.type==="Point"&&qt.coordinates&&qt.coordinates.length===2&&(qt=qt.coordinates),!qt||!Array.isArray(qt))throw new Error("Please use the `from` property to indicate which point to continue the line from");var er=pe.coordinates.length-1;if(pe.coordinates[er][0]===qt[0]&&pe.coordinates[er][1]===qt[1])Ke=er+1,pe.addCoordinate.apply(pe,[Ke].concat(pe.coordinates[er]));else{if(pe.coordinates[0][0]!==qt[0]||pe.coordinates[0][1]!==qt[1])throw new Error("`from` should match the point at either the start or the end of the provided LineString");Vt="backwards",Ke=0,pe.addCoordinate.apply(pe,[Ke].concat(pe.coordinates[0]))}}else pe=this.newFeature({type:T.FEATURE,properties:{},geometry:{type:T.LINE_STRING,coordinates:[]}}),Ke=0,this.addFeature(pe);return this.clearSelectedFeatures(),zr.disable(this),this.updateUIClasses({mouse:x.ADD}),this.activateUIButton(E.LINE),this.setActionableState({trash:!0}),{line:pe,currentVertexPosition:Ke,direction:Vt}},clickAnywhere:function(ee,pe){if(ee.currentVertexPosition>0&&ds(pe,ee.line.coordinates[ee.currentVertexPosition-1])||ee.direction==="backwards"&&ds(pe,ee.line.coordinates[ee.currentVertexPosition+1]))return this.changeMode(A.SIMPLE_SELECT,{featureIds:[ee.line.id]});this.updateUIClasses({mouse:x.ADD}),ee.line.updateCoordinate(ee.currentVertexPosition,pe.lngLat.lng,pe.lngLat.lat),ee.direction==="forward"?(ee.currentVertexPosition++,ee.line.updateCoordinate(ee.currentVertexPosition,pe.lngLat.lng,pe.lngLat.lat)):ee.line.addCoordinate(0,pe.lngLat.lng,pe.lngLat.lat)},clickOnVertex:function(ee){return this.changeMode(A.SIMPLE_SELECT,{featureIds:[ee.line.id]})},onMouseMove:function(ee,pe){ee.line.updateCoordinate(ee.currentVertexPosition,pe.lngLat.lng,pe.lngLat.lat),qe(pe)&&this.updateUIClasses({mouse:x.POINTER})}};ps.onTap=ps.onClick=function(ee,pe){if(qe(pe))return this.clickOnVertex(ee,pe);this.clickAnywhere(ee,pe)},ps.onKeyUp=function(ee,pe){Et(pe)?this.changeMode(A.SIMPLE_SELECT,{featureIds:[ee.line.id]}):Ft(pe)&&(this.deleteFeature([ee.line.id],{silent:!0}),this.changeMode(A.SIMPLE_SELECT))},ps.onStop=function(ee){zr.enable(this),this.activateUIButton(),this.getFeature(ee.line.id)!==void 0&&(ee.line.removeCoordinate(""+ee.currentVertexPosition),ee.line.isValid()?this.map.fire(M.CREATE,{features:[ee.line.toGeoJSON()]}):(this.deleteFeature([ee.line.id],{silent:!0}),this.changeMode(A.SIMPLE_SELECT,{},{silent:!0})))},ps.onTrash=function(ee){this.deleteFeature([ee.line.id],{silent:!0}),this.changeMode(A.SIMPLE_SELECT)},ps.toDisplayFeatures=function(ee,pe,Ke){var It=pe.properties.id===ee.line.id;if(pe.properties.active=It?O.ACTIVE:O.INACTIVE,!It)return Ke(pe);pe.geometry.coordinates.length<2||(pe.properties.meta=N.FEATURE,Ke(Ar(ee.line.id,pe.geometry.coordinates[ee.direction==="forward"?pe.geometry.coordinates.length-2:1],""+(ee.direction==="forward"?pe.geometry.coordinates.length-2:1),!1)),Ke(pe))};var Ul={simple_select:xi,direct_select:ga,draw_point:Za,draw_polygon:Aa,draw_line_string:ps},Fa={defaultMode:A.SIMPLE_SELECT,keybindings:!0,touchEnabled:!0,clickBuffer:2,touchBuffer:25,boxSelect:!0,displayControlsDefault:!0,styles:Cr,modes:Ul,controls:{},userProperties:!1},_a={point:!0,line_string:!0,polygon:!0,trash:!0,combine_features:!0,uncombine_features:!0},wc={point:!1,line_string:!1,polygon:!1,trash:!1,combine_features:!1,uncombine_features:!1};function sl(ee,pe){return ee.map((function(Ke){return Ke.source?Ke:gr(Ke,{id:Ke.id+"."+pe,source:pe==="hot"?b.HOT:b.COLD})}))}var ts={exports:{}};(function(ee,pe){var Ke="__lodash_hash_undefined__",It=9007199254740991,Vt="[object Arguments]",qt="[object Array]",er="[object Boolean]",Yr="[object Date]",tn="[object Error]",Gr="[object Function]",on="[object Map]",kr="[object Number]",ti="[object Object]",Ri="[object Promise]",$n="[object RegExp]",_n="[object Set]",Mr="[object String]",hn="[object Symbol]",mn="[object WeakMap]",fi="[object ArrayBuffer]",$i="[object DataView]",ba=/^\[object .+?Constructor\]$/,wi=/^(?:0|[1-9]\d*)$/,hi={};hi["[object Float32Array]"]=hi["[object Float64Array]"]=hi["[object Int8Array]"]=hi["[object Int16Array]"]=hi["[object Int32Array]"]=hi["[object Uint8Array]"]=hi["[object Uint8ClampedArray]"]=hi["[object Uint16Array]"]=hi["[object Uint32Array]"]=!0,hi[Vt]=hi[qt]=hi[fi]=hi[er]=hi[$i]=hi[Yr]=hi[tn]=hi[Gr]=hi[on]=hi[kr]=hi[ti]=hi[$n]=hi[_n]=hi[Mr]=hi[mn]=!1;var Ts=typeof cg=="object"&&cg&&cg.Object===Object&&cg,Vs=typeof self=="object"&&self&&self.Object===Object&&self,Mi=Ts||Vs||Function("return this")(),Cs=pe&&!pe.nodeType&&pe,oa=Cs&&ee&&!ee.nodeType&&ee,ku=oa&&oa.exports===Cs,Ka=ku&&Ts.process,$s=(function(){try{return Ka&&Ka.binding&&Ka.binding("util")}catch{}})(),Vo=$s&&$s.isTypedArray;function Ru(tr,vr){for(var dn=-1,In=tr==null?0:tr.length;++dn<In;)if(vr(tr[dn],dn,tr))return!0;return!1}function Mu(tr){var vr=-1,dn=Array(tr.size);return tr.forEach((function(In,vi){dn[++vr]=[vi,In]})),dn}function go(tr){var vr=-1,dn=Array(tr.size);return tr.forEach((function(In){dn[++vr]=In})),dn}var ji,qs,ii,ri=Array.prototype,Do=Function.prototype,ai=Object.prototype,ue=Mi["__core-js_shared__"],We=Do.toString,bt=ai.hasOwnProperty,zt=(ji=/[^.]+$/.exec(ue&&ue.keys&&ue.keys.IE_PROTO||""))?"Symbol(src)_1."+ji:"",lr=ai.toString,Nr=RegExp("^"+We.call(bt).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Zr=ku?Mi.Buffer:void 0,Ln=Mi.Symbol,qn=Mi.Uint8Array,Un=ai.propertyIsEnumerable,ui=ri.splice,Hn=Ln?Ln.toStringTag:void 0,Ui=Object.getOwnPropertySymbols,Xi=Zr?Zr.isBuffer:void 0,ra=(qs=Object.keys,ii=Object,function(tr){return qs(ii(tr))}),Si=mo(Mi,"DataView"),Ia=mo(Mi,"Map"),za=mo(Mi,"Promise"),Hs=mo(Mi,"Set"),ll=mo(Mi,"WeakMap"),Gs=mo(Object,"create"),$o=Zs(Si),Ws=Zs(Ia),Pa=Zs(za),Xs=Zs(Hs),Il=Zs(ll),gs=Ln?Ln.prototype:void 0,Di=gs?gs.valueOf:void 0;function qo(tr){var vr=-1,dn=tr==null?0:tr.length;for(this.clear();++vr<dn;){var In=tr[vr];this.set(In[0],In[1])}}function Da(tr){var vr=-1,dn=tr==null?0:tr.length;for(this.clear();++vr<dn;){var In=tr[vr];this.set(In[0],In[1])}}function ns(tr){var vr=-1,dn=tr==null?0:tr.length;for(this.clear();++vr<dn;){var In=tr[vr];this.set(In[0],In[1])}}function As(tr){var vr=-1,dn=tr==null?0:tr.length;for(this.__data__=new ns;++vr<dn;)this.add(tr[vr])}function Ja(tr){var vr=this.__data__=new Da(tr);this.size=vr.size}function rc(tr,vr){var dn=Vl(tr),In=!dn&&Va(tr),vi=!dn&&!In&&cl(tr),Pn=!dn&&!In&&!vi&&Hl(tr),I=dn||In||vi||Pn,y=I?(function($,ne){for(var me=-1,Oe=Array($);++me<$;)Oe[me]=ne(me);return Oe})(tr.length,String):[],_=y.length;for(var P in tr)!bt.call(tr,P)||I&&(P=="length"||vi&&(P=="offset"||P=="parent")||Pn&&(P=="buffer"||P=="byteLength"||P=="byteOffset")||fu(P,_))||y.push(P);return y}function uu(tr,vr){for(var dn=tr.length;dn--;)if(ms(tr[dn][0],vr))return dn;return-1}function Ys(tr){return tr==null?tr===void 0?"[object Undefined]":"[object Null]":Hn&&Hn in Object(tr)?(function(vr){var dn=bt.call(vr,Hn),In=vr[Hn];try{vr[Hn]=void 0;var vi=!0}catch{}var Pn=lr.call(vr);return vi&&(dn?vr[Hn]=In:delete vr[Hn]),Pn})(tr):(function(vr){return lr.call(vr)})(tr)}function ja(tr){return hl(tr)&&Ys(tr)==Vt}function Is(tr,vr,dn,In,vi){return tr===vr||(tr==null||vr==null||!hl(tr)&&!hl(vr)?tr!=tr&&vr!=vr:(function(Pn,I,y,_,P,$){var ne=Vl(Pn),me=Vl(I),Oe=ne?qt:Ua(Pn),tt=me?qt:Ua(I),ft=(Oe=Oe==Vt?ti:Oe)==ti,rr=(tt=tt==Vt?ti:tt)==ti,ur=Oe==tt;if(ur&&cl(Pn)){if(!cl(I))return!1;ne=!0,ft=!1}if(ur&&!ft)return $||($=new Ja),ne||Hl(Pn)?ul(Pn,I,y,_,P,$):(function(Fn,En,na,ca,so,ka,Ho){switch(na){case $i:if(Fn.byteLength!=En.byteLength||Fn.byteOffset!=En.byteOffset)return!1;Fn=Fn.buffer,En=En.buffer;case fi:return!(Fn.byteLength!=En.byteLength||!ka(new qn(Fn),new qn(En)));case er:case Yr:case kr:return ms(+Fn,+En);case tn:return Fn.name==En.name&&Fn.message==En.message;case $n:case Mr:return Fn==En+"";case on:var Ks=Mu;case _n:var Pl=1&ca;if(Ks||(Ks=go),Fn.size!=En.size&&!Pl)return!1;var hu=Ho.get(Fn);if(hu)return hu==En;ca|=2,Ho.set(Fn,En);var du=ul(Ks(Fn),Ks(En),ca,so,ka,Ho);return Ho.delete(Fn),du;case hn:if(Di)return Di.call(Fn)==Di.call(En)}return!1})(Pn,I,Oe,y,_,P,$);if(!(1&y)){var qr=ft&&bt.call(Pn,"__wrapped__"),bn=rr&&bt.call(I,"__wrapped__");if(qr||bn){var Dn=qr?Pn.value():Pn,Xn=bn?I.value():I;return $||($=new Ja),P(Dn,Xn,y,_,$)}}return ur?($||($=new Ja),(function(Fn,En,na,ca,so,ka){var Ho=1&na,Ks=cu(Fn),Pl=Ks.length,hu=cu(En).length;if(Pl!=hu&&!Ho)return!1;for(var du=Pl;du--;){var Ps=Ks[du];if(!(Ho?Ps in En:bt.call(En,Ps)))return!1}var Gl=ka.get(Fn);if(Gl&&ka.get(En))return Gl==En;var Wl=!0;ka.set(Fn,En),ka.set(En,Fn);for(var Eo=Ho;++du<Pl;){var ni=Fn[Ps=Ks[du]],Nu=En[Ps];if(ca)var th=Ho?ca(Nu,ni,Ps,En,Fn,ka):ca(ni,Nu,Ps,Fn,En,ka);if(!(th===void 0?ni===Nu||so(ni,Nu,na,ca,ka):th)){Wl=!1;break}Eo||(Eo=Ps=="constructor")}if(Wl&&!Eo){var bf=Fn.constructor,pu=En.constructor;bf==pu||!("constructor"in Fn)||!("constructor"in En)||typeof bf=="function"&&bf instanceof bf&&typeof pu=="function"&&pu instanceof pu||(Wl=!1)}return ka.delete(Fn),ka.delete(En),Wl})(Pn,I,y,_,P,$)):!1})(tr,vr,dn,In,Is,vi))}function nc(tr){return!(!ql(tr)||(function(vr){return!!zt&&zt in vr})(tr))&&(fl(tr)?Nr:ba).test(Zs(tr))}function ic(tr){if(dn=(vr=tr)&&vr.constructor,In=typeof dn=="function"&&dn.prototype||ai,vr!==In)return ra(tr);var vr,dn,In,vi=[];for(var Pn in Object(tr))bt.call(tr,Pn)&&Pn!="constructor"&&vi.push(Pn);return vi}function ul(tr,vr,dn,In,vi,Pn){var I=1&dn,y=tr.length,_=vr.length;if(y!=_&&!(I&&_>y))return!1;var P=Pn.get(tr);if(P&&Pn.get(vr))return P==vr;var $=-1,ne=!0,me=2&dn?new As:void 0;for(Pn.set(tr,vr),Pn.set(vr,tr);++$<y;){var Oe=tr[$],tt=vr[$];if(In)var ft=I?In(tt,Oe,$,vr,tr,Pn):In(Oe,tt,$,tr,vr,Pn);if(ft!==void 0){if(ft)continue;ne=!1;break}if(me){if(!Ru(vr,(function(rr,ur){if(qr=ur,!me.has(qr)&&(Oe===rr||vi(Oe,rr,dn,In,Pn)))return me.push(ur);var qr}))){ne=!1;break}}else if(Oe!==tt&&!vi(Oe,tt,dn,In,Pn)){ne=!1;break}}return Pn.delete(tr),Pn.delete(vr),ne}function cu(tr){return(function(vr,dn,In){var vi=dn(vr);return Vl(vr)?vi:(function(Pn,I){for(var y=-1,_=I.length,P=Pn.length;++y<_;)Pn[P+y]=I[y];return Pn})(vi,In(vr))})(tr,Ou,Du)}function Oo(tr,vr){var dn,In,vi=tr.__data__;return((In=typeof(dn=vr))=="string"||In=="number"||In=="symbol"||In=="boolean"?dn!=="__proto__":dn===null)?vi[typeof vr=="string"?"string":"hash"]:vi.map}function mo(tr,vr){var dn=(function(In,vi){return In?.[vi]})(tr,vr);return nc(dn)?dn:void 0}qo.prototype.clear=function(){this.__data__=Gs?Gs(null):{},this.size=0},qo.prototype.delete=function(tr){var vr=this.has(tr)&&delete this.__data__[tr];return this.size-=vr?1:0,vr},qo.prototype.get=function(tr){var vr=this.__data__;if(Gs){var dn=vr[tr];return dn===Ke?void 0:dn}return bt.call(vr,tr)?vr[tr]:void 0},qo.prototype.has=function(tr){var vr=this.__data__;return Gs?vr[tr]!==void 0:bt.call(vr,tr)},qo.prototype.set=function(tr,vr){var dn=this.__data__;return this.size+=this.has(tr)?0:1,dn[tr]=Gs&&vr===void 0?Ke:vr,this},Da.prototype.clear=function(){this.__data__=[],this.size=0},Da.prototype.delete=function(tr){var vr=this.__data__,dn=uu(vr,tr);return!(dn<0)&&(dn==vr.length-1?vr.pop():ui.call(vr,dn,1),--this.size,!0)},Da.prototype.get=function(tr){var vr=this.__data__,dn=uu(vr,tr);return dn<0?void 0:vr[dn][1]},Da.prototype.has=function(tr){return uu(this.__data__,tr)>-1},Da.prototype.set=function(tr,vr){var dn=this.__data__,In=uu(dn,tr);return In<0?(++this.size,dn.push([tr,vr])):dn[In][1]=vr,this},ns.prototype.clear=function(){this.size=0,this.__data__={hash:new qo,map:new(Ia||Da),string:new qo}},ns.prototype.delete=function(tr){var vr=Oo(this,tr).delete(tr);return this.size-=vr?1:0,vr},ns.prototype.get=function(tr){return Oo(this,tr).get(tr)},ns.prototype.has=function(tr){return Oo(this,tr).has(tr)},ns.prototype.set=function(tr,vr){var dn=Oo(this,tr),In=dn.size;return dn.set(tr,vr),this.size+=dn.size==In?0:1,this},As.prototype.add=As.prototype.push=function(tr){return this.__data__.set(tr,Ke),this},As.prototype.has=function(tr){return this.__data__.has(tr)},Ja.prototype.clear=function(){this.__data__=new Da,this.size=0},Ja.prototype.delete=function(tr){var vr=this.__data__,dn=vr.delete(tr);return this.size=vr.size,dn},Ja.prototype.get=function(tr){return this.__data__.get(tr)},Ja.prototype.has=function(tr){return this.__data__.has(tr)},Ja.prototype.set=function(tr,vr){var dn=this.__data__;if(dn instanceof Da){var In=dn.__data__;if(!Ia||In.length<199)return In.push([tr,vr]),this.size=++dn.size,this;dn=this.__data__=new ns(In)}return dn.set(tr,vr),this.size=dn.size,this};var Du=Ui?function(tr){return tr==null?[]:(tr=Object(tr),(function(vr,dn){for(var In=-1,vi=vr==null?0:vr.length,Pn=0,I=[];++In<vi;){var y=vr[In];dn(y,In,vr)&&(I[Pn++]=y)}return I})(Ui(tr),(function(vr){return Un.call(tr,vr)})))}:function(){return[]},Ua=Ys;function fu(tr,vr){return!!(vr=vr??It)&&(typeof tr=="number"||wi.test(tr))&&tr>-1&&tr%1==0&&tr<vr}function Zs(tr){if(tr!=null){try{return We.call(tr)}catch{}try{return tr+""}catch{}}return""}function ms(tr,vr){return tr===vr||tr!=tr&&vr!=vr}(Si&&Ua(new Si(new ArrayBuffer(1)))!=$i||Ia&&Ua(new Ia)!=on||za&&Ua(za.resolve())!=Ri||Hs&&Ua(new Hs)!=_n||ll&&Ua(new ll)!=mn)&&(Ua=function(tr){var vr=Ys(tr),dn=vr==ti?tr.constructor:void 0,In=dn?Zs(dn):"";if(In)switch(In){case $o:return $i;case Ws:return on;case Pa:return Ri;case Xs:return _n;case Il:return mn}return vr});var Va=ja((function(){return arguments})())?ja:function(tr){return hl(tr)&&bt.call(tr,"callee")&&!Un.call(tr,"callee")},Vl=Array.isArray,cl=Xi||function(){return!1};function fl(tr){if(!ql(tr))return!1;var vr=Ys(tr);return vr==Gr||vr=="[object GeneratorFunction]"||vr=="[object AsyncFunction]"||vr=="[object Proxy]"}function $l(tr){return typeof tr=="number"&&tr>-1&&tr%1==0&&tr<=It}function ql(tr){var vr=typeof tr;return tr!=null&&(vr=="object"||vr=="function")}function hl(tr){return tr!=null&&typeof tr=="object"}var Hl=Vo?(function(tr){return function(vr){return tr(vr)}})(Vo):function(tr){return hl(tr)&&$l(tr.length)&&!!hi[Ys(tr)]};function Ou(tr){return(vr=tr)!=null&&$l(vr.length)&&!fl(vr)?rc(tr):ic(tr);var vr}ee.exports=function(tr,vr){return Is(tr,vr)}})(ts,ts.exports);var oo=n(ts.exports);function rs(ee,pe){return ee.length===pe.length&&JSON.stringify(ee.map((function(Ke){return Ke})).sort())===JSON.stringify(pe.map((function(Ke){return Ke})).sort())}var Ba={Polygon:Fe,LineString:De,Point:we,MultiPolygon:st,MultiLineString:st,MultiPoint:st},Us=Object.freeze({__proto__:null,CommonSelectors:mt,constrainFeatureMovement:Ya,createMidPoint:$r,createSupplementaryPoints:fn,createVertex:Ar,doubleClickZoom:zr,euclideanDistance:Le,featuresAt:se,getFeatureAtAndSetCursors:_e,isClick:ye,isEventAtCoordinates:ds,isTap:Te,mapEventToBoundingBox:Q,ModeHandler:r,moveFeatures:ol,sortFeatures:oe,stringSetsAreEqual:rs,StringSet:G,theme:Cr,toDenseArray:at}),$c=function(ee,pe){var Ke={options:ee=(function(Vt){Vt===void 0&&(Vt={});var qt=gr(Vt);return Vt.controls||(qt.controls={}),Vt.displayControlsDefault===!1?qt.controls=gr(wc,Vt.controls):qt.controls=gr(_a,Vt.controls),(qt=gr(Fa,qt)).styles=sl(qt.styles,"cold").concat(sl(qt.styles,"hot")),qt})(ee)};pe=(function(Vt,qt){return qt.modes=A,qt.getFeatureIdsAt=function(er){return se.click({point:er},null,Vt).map((function(Yr){return Yr.properties.id}))},qt.getSelectedIds=function(){return Vt.store.getSelectedIds()},qt.getSelected=function(){return{type:T.FEATURE_COLLECTION,features:Vt.store.getSelectedIds().map((function(er){return Vt.store.get(er)})).map((function(er){return er.toGeoJSON()}))}},qt.getSelectedPoints=function(){return{type:T.FEATURE_COLLECTION,features:Vt.store.getSelectedCoordinates().map((function(er){return{type:T.FEATURE,properties:{},geometry:{type:T.POINT,coordinates:er.coordinates}}}))}},qt.set=function(er){if(er.type===void 0||er.type!==T.FEATURE_COLLECTION||!Array.isArray(er.features))throw new Error("Invalid FeatureCollection");var Yr=Vt.store.createRenderBatch(),tn=Vt.store.getAllIds().slice(),Gr=qt.add(er),on=new G(Gr);return(tn=tn.filter((function(kr){return!on.has(kr)}))).length&&qt.delete(tn),Yr(),Gr},qt.add=function(er){var Yr=JSON.parse(JSON.stringify(Qr(er))).features.map((function(tn){if(tn.id=tn.id||de(),tn.geometry===null)throw new Error("Invalid geometry: null");if(Vt.store.get(tn.id)===void 0||Vt.store.get(tn.id).type!==tn.geometry.type){var Gr=Ba[tn.geometry.type];if(Gr===void 0)throw new Error("Invalid geometry type: "+tn.geometry.type+".");var on=new Gr(Vt,tn);Vt.store.add(on)}else{var kr=Vt.store.get(tn.id);kr.properties=tn.properties,oo(kr.properties,tn.properties)||Vt.store.featureChanged(kr.id),oo(kr.getCoordinates(),tn.geometry.coordinates)||kr.incomingCoords(tn.geometry.coordinates)}return tn.id}));return Vt.store.render(),Yr},qt.get=function(er){var Yr=Vt.store.get(er);if(Yr)return Yr.toGeoJSON()},qt.getAll=function(){return{type:T.FEATURE_COLLECTION,features:Vt.store.getAll().map((function(er){return er.toGeoJSON()}))}},qt.delete=function(er){return Vt.store.delete(er,{silent:!0}),qt.getMode()!==A.DIRECT_SELECT||Vt.store.getSelectedIds().length?Vt.store.render():Vt.events.changeMode(A.SIMPLE_SELECT,void 0,{silent:!0}),qt},qt.deleteAll=function(){return Vt.store.delete(Vt.store.getAllIds(),{silent:!0}),qt.getMode()===A.DIRECT_SELECT?Vt.events.changeMode(A.SIMPLE_SELECT,void 0,{silent:!0}):Vt.store.render(),qt},qt.changeMode=function(er,Yr){return Yr===void 0&&(Yr={}),er===A.SIMPLE_SELECT&&qt.getMode()===A.SIMPLE_SELECT?(rs(Yr.featureIds||[],Vt.store.getSelectedIds())||(Vt.store.setSelected(Yr.featureIds,{silent:!0}),Vt.store.render()),qt):(er===A.DIRECT_SELECT&&qt.getMode()===A.DIRECT_SELECT&&Yr.featureId===Vt.store.getSelectedIds()[0]||Vt.events.changeMode(er,Yr,{silent:!0}),qt)},qt.getMode=function(){return Vt.events.getMode()},qt.trash=function(){return Vt.events.trash({silent:!0}),qt},qt.combineFeatures=function(){return Vt.events.combineFeatures({silent:!0}),qt},qt.uncombineFeatures=function(){return Vt.events.uncombineFeatures({silent:!0}),qt},qt.setFeatureProperty=function(er,Yr,tn){return Vt.store.setFeatureProperty(er,Yr,tn),qt},qt})(Ke,pe),Ke.api=pe;var It=ar(Ke);return pe.onAdd=It.onAdd,pe.onRemove=It.onRemove,pe.types=E,pe.options=ee,pe};function Pu(ee){$c(ee,this)}return Pu.modes=Ul,Pu.constants=H,Pu.lib=Us,Pu}))})(wS)),wS.exports}var ySe=mSe();const sj=Id(ySe);function vSe(){const t=Nx(r=>r.breakpoints.down("md"));return[{id:"gl-draw-polygon-fill-inactive",type:"fill",filter:["all",["==","active","false"],["==","$type","Polygon"],["!=","mode","static"]],paint:{"fill-color":"#009EE0","fill-outline-color":"#009EE0","fill-opacity":.3}},{id:"gl-draw-polygon-fill-active",type:"fill",filter:["all",["==","active","true"],["==","$type","Polygon"]],paint:{"fill-color":"#009EE0","fill-outline-color":"#009EE0","fill-opacity":.2}},{id:"gl-draw-polygon-stroke-inactive",type:"line",filter:["all",["==","active","false"],["==","$type","Polygon"],["!=","mode","static"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#009EE0","line-width":3}},{id:"gl-draw-polygon-stroke-active",type:"line",filter:["all",["==","active","true"],["==","$type","Polygon"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#009EE0","line-dasharray":[.2,2],"line-width":2}},{id:"gl-draw-line-inactive",type:"line",filter:["all",["==","active","false"],["==","$type","LineString"],["!=","mode","static"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#009EE0","line-width":4}},{id:"gl-draw-line-active",type:"line",filter:["all",["==","$type","LineString"],["==","active","true"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#009EE0","line-dasharray":[.2,2],"line-width":2}},{id:"gl-draw-polygon-midpoint",type:"circle",filter:["all",["==","$type","Point"],["==","meta","midpoint"]],paint:{"circle-radius":t?5:4,"circle-color":"#ffffff","circle-stroke-color":"#009EE0","circle-stroke-width":1}},{id:"gl-draw-polygon-and-line-vertex-stroke-inactive",type:"circle",filter:["all",["==","meta","vertex"],["==","$type","Point"],["!=","mode","static"]],paint:{"circle-radius":t?8:6,"circle-color":"#fff"}},{id:"gl-draw-polygon-and-line-vertex-inactive",type:"circle",filter:["all",["==","meta","vertex"],["==","$type","Point"],["!=","mode","static"]],paint:{"circle-radius":t?7:5,"circle-color":"#ffffff","circle-stroke-color":"#009EE0","circle-stroke-width":1}},{id:"gl-draw-point-point-stroke-inactive",type:"circle",filter:["all",["==","active","false"],["==","$type","Point"],["==","meta","feature"],["!=","mode","static"]],paint:{"circle-radius":t?10:9,"circle-opacity":1,"circle-color":"#009EE0"}},{id:"gl-draw-point-inactive",type:"circle",filter:["all",["==","active","false"],["==","$type","Point"],["==","meta","feature"],["!=","mode","static"]],paint:{"circle-radius":t?7.5:6.5,"circle-color":"#009EE0"}},{id:"gl-draw-point-stroke-active",type:"circle",filter:["all",["==","$type","Point"],["==","active","true"],["!=","meta","midpoint"]],paint:{"circle-radius":t?11:10,"circle-color":"#fff"}},{id:"gl-draw-point-active",type:"circle",filter:["all",["==","$type","Point"],["!=","meta","midpoint"],["==","active","true"]],paint:{"circle-radius":t?8.5:7.5,"circle-color":"#009EE0"}},{id:"gl-draw-polygon-fill-static",type:"fill",filter:["all",["==","mode","static"],["==","$type","Polygon"]],paint:{"fill-color":"#404040","fill-outline-color":"#404040","fill-opacity":.1}},{id:"gl-draw-polygon-stroke-static",type:"line",filter:["all",["==","mode","static"],["==","$type","Polygon"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#404040","line-width":2}},{id:"gl-draw-line-static",type:"line",filter:["all",["==","mode","static"],["==","$type","LineString"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#404040","line-width":2}},{id:"gl-draw-point-static",type:"circle",filter:["all",["==","mode","static"],["==","$type","Point"]],paint:{"circle-radius":t?8.5:6.5,"circle-color":"#404040"}}]}const zR=t=>{const e=te.useRef(null),r=va({mapId:t.mapId,waitForLayer:t.insertBeforeLayer}),n=te.useRef(!1),[i,a]=te.useState(!1),[s,o]=te.useState(),c=vSe(),f=te.useCallback(d=>{console.log("MlFeatureEditor mode change to "+d.mode),typeof t.onFinish=="function"&&d.mode==="simple_select"&&t.onFinish()},[t.onFinish]);return te.useEffect(()=>{r.map&&!n.current&&(n.current=!0,r.map.map.style&&r.map.map.getSource("mapbox-gl-draw-cold")&&e.current&&e.current?.remove(),e.current=new sj({displayControlsDefault:!1,defaultMode:t.mode||"simple_select",modes:Object.assign({},sj.modes),userProperties:!0,styles:c}),r.map.addControl(e.current,"top-left",r.componentId),r.map.on("draw.modechange",f,r.componentId),a(!0))},[r.map,t,n,f]),te.useEffect(()=>{if(!r.map||!i||!e.current)return;const d=m=>{const b=m?.features||[];o(b),t.onChange&&t.onChange(b)};return r.map.on("draw.create",d,r.componentId),r.map.on("draw.update",d,r.componentId),r.map.on("draw.delete",d,r.componentId),()=>{r.map&&(r.map.map.off("draw.create",d),r.map.map.off("draw.update",d),r.map.map.off("draw.delete",d))}},[i,r.map,t.onChange]),te.useEffect(()=>{e.current&&t.geojson?.geometry&&e.current.set({type:"FeatureCollection",features:[t.geojson]})},[t.geojson,i]),te.useEffect(()=>{t.mode&&e.current&&e.current?.getMode?.()!==t.mode&&(e.current?.changeMode?.(t.mode),t.mode!=="simple_select"&&t.mode!=="direct_select"&&e.current.set({type:"FeatureCollection",features:[]}))},[t.mode,r.map]),{feature:s,drawToolsReady:i,draw:e.current}};try{zR.displayName="useFeatureEditor",zR.__docgenInfo={description:"GeoJson Feature editor that allows to create or manipulate GeoJson data",displayName:"useFeatureEditor",props:{mapId:{defaultValue:null,description:"Id of the target MapLibre instance in mapContext",name:"mapId",required:!1,type:{name:"string | undefined"}},insertBeforeLayer:{defaultValue:null,description:`Id of an existing layer in the mapLibre instance to help specify the layer order
This layer will be visually beneath the layer with the "insertBeforeLayer" id.`,name:"insertBeforeLayer",required:!1,type:{name:"string | undefined"}},geojson:{defaultValue:null,description:"Input GeoJson data at initialization",name:"geojson",required:!1,type:{name:"Feature<Geometry, GeoJsonProperties> | undefined"}},onChange:{defaultValue:null,description:`Callback function that is called each time the GeoJson data has changed within MlFeatureEditor.
First parameter is the new GeoJson feature.`,name:"onChange",required:!1,type:{name:"((para: Feature<Geometry, GeoJsonProperties>[]) => void) | undefined"}},onFinish:{defaultValue:null,description:`Callback function that is called each time the GeoJson data within has been finished within MlFeatureEditor.
First parameter is the new GeoJson feature.`,name:"onFinish",required:!1,type:{name:"(() => void) | undefined"}},mode:{defaultValue:null,description:`Feature editor modes:
- draw_line_string
- draw_polygon
- draw_point
- simple_select
- direct_select`,name:"mode",required:!1,type:{name:"enum",value:[{value:"undefined"},{value:'"draw_line_string"'},{value:'"draw_polygon"'},{value:'"draw_point"'},{value:'"simple_select"'},{value:'"direct_select"'}]}}}}}catch{}const _E=t=>(zR({mode:t.mode,geojson:t.geojson,onChange:t.onChange,onFinish:t.onFinish,mapId:t.mapId}),J.jsx(J.Fragment,{}));try{_E.displayName="MlFeatureEditor",_E.__docgenInfo={description:"",displayName:"MlFeatureEditor",props:{mapId:{defaultValue:null,description:"Id of the target MapLibre instance in mapContext",name:"mapId",required:!1,type:{name:"string | undefined"}},insertBeforeLayer:{defaultValue:null,description:`Id of an existing layer in the mapLibre instance to help specify the layer order
This layer will be visually beneath the layer with the "insertBeforeLayer" id.`,name:"insertBeforeLayer",required:!1,type:{name:"string | undefined"}},geojson:{defaultValue:null,description:"Input GeoJson data at initialization",name:"geojson",required:!1,type:{name:"Feature<Geometry, GeoJsonProperties> | undefined"}},onChange:{defaultValue:null,description:`Callback function that is called each time the GeoJson data has changed within MlFeatureEditor.
First parameter is the new GeoJson feature.`,name:"onChange",required:!1,type:{name:"((para: Feature<Geometry, GeoJsonProperties>[]) => void) | undefined"}},onFinish:{defaultValue:null,description:`Callback function that is called each time the GeoJson data within has been finished within MlFeatureEditor.
First parameter is the new GeoJson feature.`,name:"onFinish",required:!1,type:{name:"(() => void) | undefined"}},mode:{defaultValue:null,description:`Feature editor modes:
- draw_line_string
- draw_polygon
- draw_point
- simple_select
- direct_select`,name:"mode",required:!1,type:{name:"enum",value:[{value:"undefined"},{value:'"draw_line_string"'},{value:'"draw_polygon"'},{value:'"draw_point"'},{value:'"simple_select"'},{value:'"direct_select"'}]}}}}}catch{}const lj=["fill","line","symbol","circle","heatmap","fill-extrusion","raster","hillshade","background"];function _Se(t){return typeof t.options.source=="string"?{source:t.options.source}:t.geojson&&(!t.options?.source||typeof t?.options?.source!="string"&&t.options?.source?.attribution&&!t.options?.source?.type)?{source:{type:"geojson",data:t.geojson||"",attribution:typeof t?.options?.source!="string"&&t.options.source?.attribution?t.options.source?.attribution:""}}:{}}function bSe(t,e){if(t?.insertBeforeLayer)return t.insertBeforeLayer;if(t?.insertBeforeFirstSymbolLayer)return e?.map?.firstSymbolLayer}function Tp(t){const e=va({mapId:t.mapId,waitForLayer:t.insertBeforeLayer}),r=te.useRef(""),n=te.useRef(""),i=te.useRef(""),[a,s]=te.useState(),o=te.useRef(t.layerId||(t.idPrefix?t.idPrefix:"Layer-")+e.componentId),c=te.useCallback(()=>{if(!e.map||e?.map.cancelled||(e.map.map.getLayer(o.current)&&e.cleanup(),typeof t?.options?.source!="string"&&e.map.map.getSource(o.current)&&e.map.map.removeSource(o.current),typeof t.options.source=="string"&&(t.options.source===""||!e.map.map.getSource(t.options.source)))||typeof t?.options?.source!="string"&&!t.geojson&&!t?.options?.source?.data&&t?.options?.type!=="background"||typeof t.options.type>"u")return;try{e.map.addLayer({...t.options,..._Se(t),id:o.current},bSe(t,e),e.componentId)}catch(m){console.error("Failed to add layer:",m)}s(()=>e.map?.map.getLayer(o.current));const f=()=>{e.map?.map.getLayer(o.current)||c()};e.map.on("styledata",f,e.componentId);const d=(m,b,{source_id:x})=>{e.map&&typeof t?.options?.source=="string"&&t.options.source===x&&c()};e.map.wrapper.on("addsource",d,e.componentId),n.current=JSON.stringify(t.options?.paint),i.current=JSON.stringify(t.options?.layout),r.current=t.options.type},[t,e]);return te.useEffect(()=>{e.map&&(!t.geojson&&!t.options.source&&t?.options?.type!=="background"||e.map?.cancelled===!1&&e?.map?.map?.getLayer?.(o.current)&&(lj.indexOf(t.options.type)===-1||lj.indexOf(t.options.type)!==-1&&t.options.type===r.current)||c())},[e.map,e.mapIsReady,t,c]),te.useEffect(()=>{e.map?.cancelled===!0||!e.map?.map?.getSource?.(o.current)||e.map.map.getSource(o.current)?.setData?.(t.geojson)},[t.geojson,e.map,t.options.type]),te.useEffect(()=>{if(e.map?.cancelled===!0||!e.map||!e.map?.map?.getLayer?.(o.current)||t.options.type!==r.current)return;let f;const d=JSON.stringify(t.options.layout);if(t.options.layout&&d!==i.current){const b=JSON.parse(i.current);for(f in t.options.layout)t.options.layout?.[f]&&t.options.layout[f]!==b[f]&&e.map.map.setLayoutProperty(o.current,f,t.options.layout[f]);i.current=d}const m=JSON.stringify(t.options.paint);if(m!==n.current){const b=JSON.parse(n.current);for(f in t.options.paint)t.options.paint?.[f]&&t.options.paint[f]!==b[f]&&e.map.map.setPaintProperty(o.current,f,t.options.paint[f]);n.current=m}},[t.options,e.map]),te.useEffect(()=>{!t.insertBeforeLayer||!e.map||!e.map.getLayer(t.insertBeforeLayer)||!e.map.getLayer(o.current)||e.map.moveLayer(o.current,t.insertBeforeLayer)},[e.map,t.insertBeforeLayer]),te.useEffect(()=>()=>{e.cleanup()},[]),te.useEffect(()=>{if(typeof t?.options?.source!="string"||!e.map)return;const f=()=>{typeof t?.options?.source=="string"&&e?.map?.getSource?.(t.options.source)&&!e.map.getLayer(o.current)&&c()};e.map.on("sourcedataloading",f);const d=(m,b,{source_id:x})=>{e.map&&typeof t?.options?.source=="string"&&t.options.source===x&&c()};return e.map.wrapper.on("addsource",d),()=>{e?.map&&(e.map.off("sourcedataloading",f),e.map.wrapper.off("addsource",d))}},[e.map,t.options?.source]),te.useEffect(()=>{if(!t.onClick||!e?.map||!e?.map?.getLayer?.(o.current))return;const f=t.onClick;return e.map?.on("click",o.current,f),()=>{f&&e?.map&&e.map?.off("click",o.current,f)}},[e.map,t.onClick]),te.useEffect(()=>{if(!t.onHover||!e?.map||!e?.map?.getLayer?.(o.current))return;const f=t.onHover;return e.map?.on("mousemove",o.current,f),()=>{f&&e?.map&&e.map?.off("mousemove",o.current,f)}},[e.map,t.onHover]),te.useEffect(()=>{if(!t.onLeave||!e?.map||!e?.map?.getLayer?.(o.current))return;const f=t.onLeave;return e.map?.on("mouseleave",o.current,f),()=>{f&&e?.map&&e.map?.off("mouseleave",o.current,f)}},[e.map,t.onLeave]),{map:e.map,layer:a,layerId:o.current,componentId:e.componentId,mapHook:e}}Tp.defaultProps={};const jR=t=>(Tp({mapId:t.mapId,layerId:t.layerId||"MlFillExtrusionLayer-"+_c(),options:{id:"",type:"fill-extrusion",source:t.sourceId||"openmaptiles","source-layer":t.sourceLayer||"building",minzoom:t.minZoom||6,paint:{...t.paint}},insertBeforeFirstSymbolLayer:!0}),J.jsx(J.Fragment,{}));jR.defaultProps={mapId:void 0,paint:{"fill-extrusion-color":"hsl(196, 61%, 83%)","fill-extrusion-height":{property:"render_height",type:"identity"},"fill-extrusion-base":{property:"render_min_height",type:"identity"},"fill-extrusion-opacity":1}};try{jR.displayName="MlFillExtrusionLayer",jR.__docgenInfo={description:"Adds a fill extrusion layer to the MapLibre instance reference by props.mapId",displayName:"MlFillExtrusionLayer",props:{mapId:{defaultValue:{value:"undefined"},description:"Id of the target MapLibre instance in mapContext",name:"mapId",required:!1,type:{name:"string | undefined"}},insertBeforeLayer:{defaultValue:null,description:`The layerId of an existing layer this layer should be rendered visually beneath
https://maplibre.org/maplibre-gl-js-docs/api/map/#map#addlayer - see "beforeId" property`,name:"insertBeforeLayer",required:!1,type:{name:"string | undefined"}},layerId:{defaultValue:null,description:"Id of the layer that will be added by this component",name:"layerId",required:!1,type:{name:"string | undefined"}},paint:{defaultValue:{value:`{
		'fill-extrusion-color': 'hsl(196, 61%, 83%)',
		'fill-extrusion-height': {
			property: 'render_height',
			type: 'identity',
		},
		'fill-extrusion-base': {
			property: 'render_min_height',
			type: 'identity',
		},
		'fill-extrusion-opacity': 1,
	}`},description:`Paint properties of the config object that is passed to the MapLibreGl.addLayer call. All
available properties are documented in the MapLibreGl documentation
https://maplibre.org/maplibre-gl-js-docs/style-spec/layers/#fill-extrusion`,name:"paint",required:!1,type:{name:"object | undefined"}},sourceId:{defaultValue:null,description:`Source id of a vector tile source containing the geometries to use for this fill-extrusion
layer.
https://maplibre.org/maplibre-gl-js-docs/style-spec/layers/#source-layer`,name:"sourceId",required:!1,type:{name:"string | undefined"}},sourceLayer:{defaultValue:null,description:`Layer id from a vector tile source containing the geometries to use for this fill-extrusion
layer.
https://maplibre.org/maplibre-gl-js-docs/style-spec/layers/#source-layer`,name:"sourceLayer",required:!1,type:{name:"string | undefined"}},minZoom:{defaultValue:null,description:`This layer will be hidden for zoom levels lower than defined on this property
https://maplibre.org/maplibre-gl-js-docs/style-spec/layers/#minzoom`,name:"minZoom",required:!1,type:{name:"number | undefined"}}}}}catch{}const kJ=(t,e)=>{switch(t){case"fill":return e?.fill?e.fill:{"fill-color":"#009EE0","fill-outline-color":"#009EE0"};case"line":return e?.line?(console.log(e.line),e.line):{"line-color":"#009EE0","line-width":4,"line-blur":0};case"circle":return e?.circle?e.circle:{"circle-color":"#009EE0","circle-stroke-color":"#fff","circle-stroke-width":2,"circle-radius":5};default:return{}}},uj={Position:"circle",Point:"circle",MultiPoint:"circle",LineString:"line",MultiLineString:"line",Polygon:"fill",MultiPolygon:"fill",GeometryCollection:"circle"},bE=t=>t?.type==="Feature"?uj?.[t?.geometry?.type]?uj[t.geometry.type]:"circle":t?.type==="FeatureCollection"?t.features.length?bE(t.features[0]):"circle":"fill";function fN(t){const e=va({mapId:t.mapId}),[r,n]=te.useState(),i=te.useRef(t.sourceId||(t.idPrefix?t.idPrefix:"Source-")+e.componentId),a=te.useCallback(()=>{if(e.map&&e.map?.style?._layers){for(const[o,c]of Object.entries(e.map.style._layers))c.source===i.current&&e.map.removeLayer(o);e.map.getSource(i.current)&&e.map.removeSource(i.current)}},[e.map]),s=te.useCallback(()=>{e.map&&(t.source.type==="geojson"&&!t.source.data||(e.map.map.getSource(i.current)&&a(),e.map?.addSource(i.current,{...t.source}),n(e.map.map.getSource(i.current))))},[t,e,a]);return te.useEffect(()=>{e.map?.map?.getSource(i.current)&&e.map.map.getSource(i.current)?.setData?.(t.source.data)},[t.source?.data]),te.useEffect(()=>{e?.map?.map?.getSource?.(t.sourceId)&&t.sourceId===i.current||(i.current=t.sourceId,s())},[e.map,t,s]),te.useEffect(()=>{if(!e.map)return;const o=()=>{e?.map?.getSource?.(t.sourceId)||s()};return e.map.on("styledata",o),()=>{e?.map&&e.map.off("styledata",o)}},[e.map,s]),te.useEffect(()=>()=>{a()},[a]),{map:e.map,source:r,componentId:e.componentId,mapHook:e}}const Nc=t=>{const e=t.type||bE(t.geojson),r=te.useRef(t.layerId||"MlGeoJsonLayer-"+_c()),n=`label-${r.current}`;return te.useEffect(()=>{t.layerId?r.current=t.layerId:r.current="MlGeoJsonLayer-"+_c()},[t.layerId]),fN({mapId:t.mapId,sourceId:"source-"+r.current,source:{type:"geojson",data:t.geojson,...typeof t?.options?.source<"u"&&typeof t?.options?.source!="string"?t.options.source:{}}}),Tp({mapId:t.mapId,layerId:r.current,options:{...typeof t?.options?.source<"u"&&typeof t?.options?.source=="string"?{source:t.options.source}:{source:"source-"+r.current},paint:{...t.paint||kJ(e,t.defaultPaintOverrides),...t?.options?.paint},layout:{...t?.layout||{},...t?.options?.layout},type:e},insertBeforeLayer:t.insertBeforeLayer,onHover:t.onHover,onClick:t.onClick,onLeave:t.onLeave}),Tp({mapId:t.mapId,options:{...typeof t?.options?.source<"u"&&typeof t?.options?.source=="string"?{source:t.options.source}:{source:"source-"+r.current},id:n,type:"symbol",maxzoom:24,minzoom:1,...t?.labelOptions?t.labelOptions:{},...t?.options?.filter?{filter:t.options.filter}:{},layout:{"text-font":["Open Sans Regular"],"text-field":`{${t.labelProp}}`,"text-size":12,"text-anchor":"top",...t?.labelOptions?.layout?t.labelOptions.layout:{},visibility:t?.layout?.visibility??t?.options?.layout?.visibility??"visible"},paint:{"text-halo-width":1,"text-halo-color":"#fefefe","text-color":"#121212",...t?.labelOptions?.paint?t.labelOptions.paint:{}}}}),J.jsx(J.Fragment,{})};try{Nc.displayName="MlGeoJsonLayer",Nc.__docgenInfo={description:"Adds source and layer to display GeoJSON data on the map.",displayName:"MlGeoJsonLayer",props:{mapId:{defaultValue:null,description:"Id of the target MapLibre instance in mapContext",name:"mapId",required:!1,type:{name:"string | undefined"}},insertBeforeLayer:{defaultValue:null,description:`Id of an existing layer in the mapLibre instance to help specify the layer order
This layer will be visually beneath the layer with the "insertBeforeLayer" id.
This layer will not be added to the maplibre-gl instance until a layer with an
id that matches the value of insertBeforeLayer is created.`,name:"insertBeforeLayer",required:!1,type:{name:"string | undefined"}},layerId:{defaultValue:null,description:"Id of the new layer and source that are added to the MapLibre instance",name:"layerId",required:!1,type:{name:"string | undefined"}},geojson:{defaultValue:null,description:"GeoJSON data that is supposed to be rendered by this component.",name:"geojson",required:!1,type:{name:"Feature<Geometry, GeoJsonProperties> | FeatureCollection<Geometry, GeoJsonProperties> | undefined"}},type:{defaultValue:null,description:`Type of the layer that will be added to the MapLibre instance.
All types from LayerSpecification union type are supported except the type from
RasterLayerSpecification`,name:"type",required:!1,type:{name:"enum",value:[{value:"undefined"},{value:'"symbol"'},{value:'"fill"'},{value:'"background"'},{value:'"circle"'},{value:'"line"'},{value:'"heatmap"'},{value:'"fill-extrusion"'},{value:'"hillshade"'},{value:'"color-relief"'}]}},paint:{defaultValue:null,description:`@deprecated The property should not be used. Please use the options.paint property instead. This will be removed in the next major release.
Paint property object, that is passed to the addLayer call.
Possible props depend on the layer type.
See https://maplibre.org/maplibre-gl-js-docs/style-spec/layers/
Some examples are:
https://maplibre.org/maplibre-gl-js-docs/style-spec/layers/#line
https://maplibre.org/maplibre-gl-js-docs/style-spec/layers/#circle
https://maplibre.org/maplibre-gl-js-docs/style-spec/layers/#fill
All paint types from LayerSpecification union type are supported except the paint type from
RasterLayerSpecification`,name:"paint",required:!1,type:{name:'{ "circle-radius"?: DataDrivenPropertyValueSpecification<number> | undefined; "circle-radius-transition"?: TransitionSpecification | undefined; ... 16 more ...; "circle-stroke-opacity-transition"?: TransitionSpecification | undefined; } | ... 8 more ... | undefined'}},layout:{defaultValue:null,description:`@deprecated The property should not be used. Please use the options.layout property instead. This will be removed in the next major release.
Layout property object, that is passed to the addLayer call.
Possible props depend on the layer type.
See https://maplibre.org/maplibre-gl-js-docs/style-spec/layers/
Some examples are:
https://maplibre.org/maplibre-gl-js-docs/style-spec/layers/#line
https://maplibre.org/maplibre-gl-js-docs/style-spec/layers/#circle
https://maplibre.org/maplibre-gl-js-docs/style-spec/layers/#fill
All layout types from LayerSpecification union type are supported except the layout type from
RasterLayerSpecification`,name:"layout",required:!1,type:{name:'{ "circle-sort-key"?: DataDrivenPropertyValueSpecification<number> | undefined; visibility?: VisibilitySpecification | undefined; } | ... 9 more ... | undefined'}},options:{defaultValue:null,description:"Javascript object that is spread into the addLayer commands first parameter.",name:"options",required:!1,type:{name:"Partial<LayerSpecification & { source?: string | GeoJSONSourceSpecification | undefined; id?: string | undefined; filter?: FilterSpecification | undefined; }> | undefined"}},defaultPaintOverrides:{defaultValue:null,description:'Javascript object with optional properties "fill", "line", "circle" to override implicit layer type default paint properties.',name:"defaultPaintOverrides",required:!1,type:{name:'{ circle?: { "circle-radius"?: DataDrivenPropertyValueSpecification<number> | undefined; "circle-radius-transition"?: TransitionSpecification | undefined; ... 16 more ...; "circle-stroke-opacity-transition"?: TransitionSpecification | undefined; } | undefined; fill?: { ...; } | undefined; line?: { ...; } | undefined...'}},labelProp:{defaultValue:null,description:"Property name in the GeoJSON object to be used as a label.",name:"labelProp",required:!1,type:{name:"string | undefined"}},labelOptions:{defaultValue:null,description:"Label configuration options.",name:"labelOptions",required:!1,type:{name:"Partial<LayerSpecification & { source?: string | GeoJSONSourceSpecification | undefined; id?: string | undefined; filter?: FilterSpecification | undefined; }> | undefined"}},onHover:{defaultValue:null,description:"Hover event handler that is executed whenever a geometry rendered by this component is hovered.",name:"onHover",required:!1,type:{name:"((ev: MapEventType) => void | Map$1) | undefined"}},onClick:{defaultValue:null,description:"Click event handler that is executed whenever a geometry rendered by this component is clicked.",name:"onClick",required:!1,type:{name:"((ev: MapEventType) => void | Map$1) | undefined"}},onLeave:{defaultValue:null,description:`Leave event handler that is executed whenever a geometry rendered by this component is
left/unhovered.`,name:"onLeave",required:!1,type:{name:"((ev: MapEventType) => void | Map$1) | undefined"}}}}}catch{}const hN=Ji(J.jsx("path",{d:"M12 8c-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4-1.79-4-4-4m8.94 3c-.46-4.17-3.77-7.48-7.94-7.94V1h-2v2.06C6.83 3.52 3.52 6.83 3.06 11H1v2h2.06c.46 4.17 3.77 7.48 7.94 7.94V23h2v-2.06c4.17-.46 7.48-3.77 7.94-7.94H23v-2zM12 19c-3.87 0-7-3.13-7-7s3.13-7 7-7 7 3.13 7 7-3.13 7-7 7"})),UR=t=>{const e=va({mapId:t.mapId,waitForLayer:t.insertBeforeLayer}),[r,n]=te.useState(!1),[i,a]=te.useState(),[s,o]=te.useState(!1),[c,f]=te.useState(),[d,m]=te.useState(0),b=te.useRef(!1),x=te.useCallback(M=>{if(!e.map||((!t.centerUserPosition&&!b.current||t.centerUserPosition)&&(t.useFlyTo?e.map.map.flyTo({center:[M.coords.longitude,M.coords.latitude],zoom:18,speed:1,curve:1}):e.map.map.setCenter([M.coords.longitude,M.coords.latitude]),b.current=!0),t.showUserLocation!==void 0&&!t.showUserLocation))return;const F=Oc([M.coords.longitude,M.coords.latitude]);a(F),f(CJ(F,M.coords.accuracy/1e3))},[e.map,t]),E=()=>{console.log("Access of user location denied"),o(!0)},T=te.useMemo(()=>{if(!i)return;const M=.02,F=d-15,N=d+15,j=Jwe(i,M,F,N,{steps:65});return j.geometry.coordinates.push(i.geometry.coordinates),j.geometry.coordinates.slice(0,0),j},[d,i]),A=M=>{M?.alpha&&m(-M.alpha)};return te.useEffect(()=>{if(r){const M=A;return window.addEventListener("deviceorientation",M),()=>{window.removeEventListener("deviceorientation",M)}}else b.current=!1},[r]),te.useEffect(()=>{if(e.map&&r){const M=navigator.geolocation.watchPosition(x,E);return()=>{navigator.geolocation.clearWatch(M)}}},[e.map,r,x]),te.useEffect(()=>{if(c?.type){const M=e.map?.getBounds(),F=[M?._ne.lng,M?._ne.lat,M?._sw.lng,M?._sw.lat],N=mf(c);j2e(T7(F),T7(N))||e.map?.fitBounds(N,{padding:{top:25,bottom:25}})}},[c]),J.jsxs(J.Fragment,{children:[r&&i&&J.jsx(Nc,{geojson:c,type:"fill",paint:{"fill-color":"#cbd300","fill-opacity":.3,...t.accuracyPaint},insertBeforeLayer:t.insertBeforeLayer}),r&&T&&J.jsx(Nc,{geojson:T,type:"fill",paint:{"fill-color":"#0000ff","fill-antialias":!1,"fill-opacity":.3,...t.orientationConePaint},insertBeforeLayer:t.insertBeforeLayer}),r&&i&&J.jsx(Nc,{geojson:i,type:"circle",paint:{"circle-color":"#009ee0","circle-radius":5,"circle-stroke-color":"#fafaff","circle-stroke-width":1,...t.circlePaint},insertBeforeLayer:t.insertBeforeLayer}),J.jsx(ta,{variant:"navtools","data-testid":"mlFollowGpsBtn",sx:{zIndex:1002,color:r?M=>M.palette.GPS.GPSActiveColor:M=>M.palette.GPS.GPSInactiveColor,backgroundColor:r?M=>M.palette.GPS.GPSActiveBackgroundColor:M=>M.palette.navigation.navColor},disabled:s,onClick:()=>{n(!r)},children:J.jsx(hN,{sx:{fontSize:{xs:"1.4em",md:"1em"}}})})]})};try{UR.displayName="MlFollowGps",UR.__docgenInfo={description:`Adds a button that makes the map follow the users GPS position using
navigator.geolocation.watchPosition if activated`,displayName:"MlFollowGps",props:{mapId:{defaultValue:null,description:"Id of the target MapLibre instance in mapContext",name:"mapId",required:!1,type:{name:"string | undefined"}},insertBeforeLayer:{defaultValue:null,description:`The layerId of an existing layer this layer should be rendered visually beneath
https://maplibre.org/maplibre-gl-js-docs/api/map/#map#addlayer - see "beforeId" property`,name:"insertBeforeLayer",required:!1,type:{name:"string | undefined"}},showUserLocation:{defaultValue:null,description:"By default a dot will be shown on the map at the user's location. Set to false to disable.",name:"showUserLocation",required:!1,type:{name:"boolean | undefined"}},showOrientation:{defaultValue:null,description:`By default a cone will be shown on the map at the user's location to indicate the device's orientation.
Set to false to disable.`,name:"showOrientation",required:!1,type:{name:"boolean | undefined"}},showAccuracyCircle:{defaultValue:null,description:`By default, if showUserLocation is true, a transparent circle will be drawn around the user location
indicating the accuracy (95% confidence level) of the user's location. Set to false to disable.`,name:"showAccuracyCircle",required:!1,type:{name:"boolean | undefined"}},useFlyTo:{defaultValue:null,description:`Use the MapLibre.flyTo function to center the map to the current users position if true.
Otherwise the MapLibre.setCenter function is used.`,name:"useFlyTo",required:!1,type:{name:"boolean | undefined"}},centerUserPosition:{defaultValue:null,description:`Center map to current position once updated location data is recieved.
"false" will center the map once on component activation and then display the updated user location on the map.`,name:"centerUserPosition",required:!1,type:{name:"boolean | undefined"}},orientationConePaint:{defaultValue:null,description:`Orientation cone paint property object, that is passed to the MlGeoJsonLayer responsible for drawing the orientation cone polygon.
Use any available paint prop from layer type "fill".
https://maplibre.org/maplibre-gl-js-docs/style-spec/layers/#fill`,name:"orientationConePaint",required:!1,type:{name:'{ "fill-antialias"?: PropertyValueSpecification<boolean> | undefined; "fill-opacity"?: DataDrivenPropertyValueSpecification<number> | undefined; ... 9 more ...; "fill-pattern-transition"?: TransitionSpecification | undefined; } | undefined'}},circlePaint:{defaultValue:null,description:`Position circle paint property object, that is passed to the MlGeoJsonLayer responsible for drawing the position circle.
Use any available paint prop from layer type "circle".
https://maplibre.org/maplibre-gl-js-docs/style-spec/layers/#circle`,name:"circlePaint",required:!1,type:{name:'{ "circle-radius"?: DataDrivenPropertyValueSpecification<number> | undefined; "circle-radius-transition"?: TransitionSpecification | undefined; ... 16 more ...; "circle-stroke-opacity-transition"?: TransitionSpecification | undefined; } | undefined'}},onColor:{defaultValue:null,description:"Active button font color",name:"onColor",required:!1,type:{name:"string | undefined"}},offColor:{defaultValue:null,description:"Inactive button font color",name:"offColor",required:!1,type:{name:"string | undefined"}},accuracyPaint:{defaultValue:null,description:`Accuracy paint property object, that is passed to the MlGeoJsonLayer responsible for drawing the accuracy polygon.
Use any available paint prop from layer type "fill".
https://maplibre.org/maplibre-gl-js-docs/style-spec/layers/#fill`,name:"accuracyPaint",required:!1,type:{name:'{ "fill-antialias"?: PropertyValueSpecification<boolean> | undefined; "fill-opacity"?: DataDrivenPropertyValueSpecification<number> | undefined; ... 9 more ...; "fill-pattern-transition"?: TransitionSpecification | undefined; } | undefined'}}}}}catch{}const cj=t=>{const e=va({mapId:t.mapId,waitForLayer:t.insertBeforeLayer}),[r,n]=te.useState(),i=te.useRef(t.imageId||"img_"+_c()),a=te.useRef(t.layerId||"MlImageMarkerLayer-"+e.componentId);Tp({geojson:t.options?.source?.data,layerId:a.current,options:{type:"symbol",layout:{...t.options?.layout,"icon-image":r||i.current},paint:{...t.options?.paint}}});const s=(o,c)=>{o.map&&c.imgSrc&&!o.map.map.hasImage(i.current)&&o.map.map.loadImage(c.imgSrc).then(function(f){if(!f?.data){console.log("image "+c.imgSrc+"could not be loaded");return}!o.map||o.map.map.hasImage(i.current)||(o.map.addImage(i.current,f.data,o.componentId),n(i.current))})};return te.useEffect(()=>{e.map&&t.imgSrc&&s(e,t)},[t,e]),J.jsx(J.Fragment,{})};try{cj.displayName="MlImageMarkerLayer",cj.__docgenInfo={description:"",displayName:"MlImageMarkerLayer",props:{mapId:{defaultValue:null,description:"Id of the target MapLibre instance in mapContext",name:"mapId",required:!1,type:{name:"string | undefined"}},insertBeforeLayer:{defaultValue:null,description:`The layerId of an existing layer this layer should be rendered visually beneath
https://maplibre.org/maplibre-gl-js-docs/api/map/#map#addlayer - see "beforeId" property`,name:"insertBeforeLayer",required:!1,type:{name:"string | undefined"}},layerId:{defaultValue:null,description:"Id of the layer that will be added by this component to the maplibre-gl instance",name:"layerId",required:!1,type:{name:"string | undefined"}},imageId:{defaultValue:null,description:"Id of the image that will be added by this component to the maplibre-gl instance",name:"imageId",required:!1,type:{name:"string | undefined"}},imgSrc:{defaultValue:null,description:"Path or URL to a supported raster image",name:"imgSrc",required:!1,type:{name:"string | undefined"}},options:{defaultValue:null,description:"Javascript object that is passed the addLayer command as first parameter.",name:"options",required:!1,type:{name:"{ source?: { type?: string | undefined; data: Feature<Geometry, GeoJsonProperties> | FeatureCollection<Geometry, GeoJsonProperties> | undefined; } | undefined; layout?: { ...; } | undefined; paint?: { ...; } | undefined; } | undefined"}}}}}catch{}function xSe(t){switch(t){case"meters":return 1;case"millimeters":return 1e3;case"centimeters":return 100;case"kilometers":return .001;case"miles":return 1/1609.344;case"nauticalmiles":return 1/1852;case"inches":return 39.3701;case"yards":return 1.09361;case"feet":return 3.28084;default:return 1}}function fj(t){switch(t){case"miles":return"mi";case"acres":return"ac";case"kilometers":return"km";case"meters":return"m";case"millimeters":return"mm";case"centimeters":return"cm";case"nauticalmiles":return"nm";case"inches":return"in";case"yards":return"yd";case"feet":return"ft";case"hectares":return"ha";default:return"m"}}const VR=t=>{const[e,r]=te.useState({value:0,label:""}),[n,i]=te.useState([]);return te.useEffect(()=>{if(n[0]){let a=0;if(t.measureType==="polygon"){if(a=A2e(n[0]),t.unit){const s=t.unit;s==="acres"?a=a/4046.8564224:s==="hectares"?a=a/1e4:a=a*xSe(t.unit)**2}}else a=Qb(n[0],{units:t.unit});typeof t.onChange=="function"&&t.onChange({value:a,unit:t.unit,geojson:n[0]}),a>=.1&&r({value:a,label:fj(t.unit)})}},[t.unit,n]),J.jsxs(J.Fragment,{children:[J.jsx(_E,{onChange:a=>{a&&i(a)},mode:t.measureType==="polygon"?"draw_polygon":"draw_line_string",onFinish:t.onFinish}),e.value.toLocaleString("de-DE",{minimumFractionDigits:2,maximumFractionDigits:2})," ",fj(t.unit),e.label&&t.measureType==="polygon"&&!["hectares","acres"].includes(t.unit||"")?" ":""]})};try{VR.displayName="MlMeasureTool",VR.__docgenInfo={description:"",displayName:"MlMeasureTool",props:{measureType:{defaultValue:null,description:'String that specify if the Tool measures an area ("polygon") or length ("line")',name:"measureType",required:!1,type:{name:"enum",value:[{value:"undefined"},{value:'"line"'},{value:'"polygon"'}]}},unit:{defaultValue:null,description:"String that dictates which unit of measurement is used",name:"unit",required:!1,type:{name:"enum",value:[{value:"undefined"},{value:'"meters"'},{value:'"metres"'},{value:'"millimeters"'},{value:'"millimetres"'},{value:'"centimeters"'},{value:'"centimetres"'},{value:'"kilometers"'},{value:'"kilometres"'},{value:'"miles"'},{value:'"nauticalmiles"'},{value:'"inches"'},{value:'"yards"'},{value:'"feet"'},{value:'"radians"'},{value:'"degrees"'}]}},onChange:{defaultValue:null,description:`Callback function that is called each time measurment geometry within has changed within MlMeasureTool.
First parameter is the new GeoJson feature.`,name:"onChange",required:!1,type:{name:"((options: MlMeasureToolOnChangeOptions) => void) | undefined"}},onFinish:{defaultValue:null,description:"Callback function that is called by the end of drawing geometries.",name:"onFinish",required:!1,type:{name:"(() => void) | undefined"}}}}}catch{}const RJ=Ji(J.jsx("path",{d:"M15 16v1.26l-6-3v-3.17L11.7 8H16V2h-6v4.9L7.3 10H3v6h5l7 3.5V22h6v-6z"})),MJ=Ji(J.jsx("path",{d:"m2 9 4 12h12l4-12-10-7z"})),wSe=Dr(Mh)({marginTop:"15px"});function $R(t){return J.jsx(wSe,{children:t?.children})}try{$R.displayName="LayerList",$R.__docgenInfo={description:"",displayName:"LayerList",props:{mapId:{defaultValue:null,description:"",name:"mapId",required:!1,type:{name:"string | undefined"}}}}}catch{}const Hx=Ji(J.jsx("path",{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6zM19 4h-3.5l-1-1h-5l-1 1H5v2h14z"})),dN=Ji(J.jsx("path",{d:"M3 17v2h6v-2zM3 5v2h10V5zm10 16v-2h8v-2h-8v-2h-2v6zM7 9v2H3v2h4v2h2V9zm14 4v-2H11v2zm-6-4h2V7h4V5h-4V3h-2z"})),DJ=Ji(J.jsx("path",{d:"m12 8-6 6 1.41 1.41L12 10.83l4.59 4.58L18 14z"})),xE=Ji(J.jsx("path",{d:"M16.59 8.59 12 13.17 7.41 8.59 6 10l6 6 6-6z"})),SSe=_y(Gf)({paddingRight:0,paddingLeft:0,paddingTop:0,paddingBottom:"4px"}),ESe=_y(Ub)({minWidth:"30px"}),TSe=_y(Rc)({marginRight:"0px",padding:"0px"}),CSe=_y($0)({padding:0,marginRight:"5px"}),ASe=_y(Ov)(({open:t})=>({display:t?"block":"none"})),ISe=_y(Mh)({marginLeft:"50px"});function qR({visible:t=!0,name:e,children:r,setVisible:n}){const[i,a]=te.useState(!1),[s,o]=te.useState(!0),c=te.useMemo(()=>t?s:!1,[t,s]),f=te.useMemo(()=>r?Array.isArray(r)?r.map(d=>gt.cloneElement(d,{visible:c})):gt.cloneElement(r,{visible:c}):J.jsx(J.Fragment,{}),[c]);return J.jsxs(J.Fragment,{children:[J.jsxs(SSe,{children:[J.jsxs(ESe,{children:[J.jsx(TSe,{edge:"end","aria-label":"open",onClick:()=>a(!i),children:i?J.jsx(xE,{}):J.jsx(DJ,{})}),J.jsx(CSe,{disabled:n?!1:!t,checked:n?t:s,onClick:()=>{n?n(d=>!d):o(d=>!d)}})]}),J.jsx(Lf,{primary:e,variant:"layerlist"})]}),J.jsx(ASe,{open:i,children:J.jsx(ISe,{disablePadding:!0,children:f})})]})}try{qR.displayName="LayerListFolder",qR.__docgenInfo={description:"",displayName:"LayerListFolder",props:{visible:{defaultValue:{value:"true"},description:"",name:"visible",required:!1,type:{name:"boolean"}},name:{defaultValue:null,description:"",name:"name",required:!1,type:{name:"ReactNode"}},setVisible:{defaultValue:null,description:"",name:"setVisible",required:!1,type:{name:"((visible: boolean | ((val: unknown) => boolean)) => void) | undefined"}}}}}catch{}var Cc={},bv={},l5,hj;function OJ(){if(hj)return l5;hj=1;var t=typeof cg=="object"&&cg&&cg.Object===Object&&cg;return l5=t,l5}var u5,dj;function Md(){if(dj)return u5;dj=1;var t=OJ(),e=typeof self=="object"&&self&&self.Object===Object&&self,r=t||e||Function("return this")();return u5=r,u5}var c5,pj;function Gx(){if(pj)return c5;pj=1;var t=Md(),e=t.Symbol;return c5=e,c5}var f5,gj;function PSe(){if(gj)return f5;gj=1;var t=Gx(),e=Object.prototype,r=e.hasOwnProperty,n=e.toString,i=t?t.toStringTag:void 0;function a(s){var o=r.call(s,i),c=s[i];try{s[i]=void 0;var f=!0}catch{}var d=n.call(s);return f&&(o?s[i]=c:delete s[i]),d}return f5=a,f5}var h5,mj;function kSe(){if(mj)return h5;mj=1;var t=Object.prototype,e=t.toString;function r(n){return e.call(n)}return h5=r,h5}var d5,yj;function Cy(){if(yj)return d5;yj=1;var t=Gx(),e=PSe(),r=kSe(),n="[object Null]",i="[object Undefined]",a=t?t.toStringTag:void 0;function s(o){return o==null?o===void 0?i:n:a&&a in Object(o)?e(o):r(o)}return d5=s,d5}var p5,vj;function Nh(){if(vj)return p5;vj=1;var t=Array.isArray;return p5=t,p5}var g5,_j;function Rp(){if(_j)return g5;_j=1;function t(e){return e!=null&&typeof e=="object"}return g5=t,g5}var m5,bj;function RSe(){if(bj)return m5;bj=1;var t=Cy(),e=Nh(),r=Rp(),n="[object String]";function i(a){return typeof a=="string"||!e(a)&&r(a)&&t(a)==n}return m5=i,m5}var y5,xj;function MSe(){if(xj)return y5;xj=1;function t(e){return function(r,n,i){for(var a=-1,s=Object(r),o=i(r),c=o.length;c--;){var f=o[e?c:++a];if(n(s[f],f,s)===!1)break}return r}}return y5=t,y5}var v5,wj;function DSe(){if(wj)return v5;wj=1;var t=MSe(),e=t();return v5=e,v5}var _5,Sj;function OSe(){if(Sj)return _5;Sj=1;function t(e,r){for(var n=-1,i=Array(e);++n<e;)i[n]=r(n);return i}return _5=t,_5}var b5,Ej;function NSe(){if(Ej)return b5;Ej=1;var t=Cy(),e=Rp(),r="[object Arguments]";function n(i){return e(i)&&t(i)==r}return b5=n,b5}var x5,Tj;function NJ(){if(Tj)return x5;Tj=1;var t=NSe(),e=Rp(),r=Object.prototype,n=r.hasOwnProperty,i=r.propertyIsEnumerable,a=t((function(){return arguments})())?t:function(s){return e(s)&&n.call(s,"callee")&&!i.call(s,"callee")};return x5=a,x5}var U1={exports:{}},w5,Cj;function LSe(){if(Cj)return w5;Cj=1;function t(){return!1}return w5=t,w5}U1.exports;var Aj;function pN(){return Aj||(Aj=1,(function(t,e){var r=Md(),n=LSe(),i=e&&!e.nodeType&&e,a=i&&!0&&t&&!t.nodeType&&t,s=a&&a.exports===i,o=s?r.Buffer:void 0,c=o?o.isBuffer:void 0,f=c||n;t.exports=f})(U1,U1.exports)),U1.exports}var S5,Ij;function LJ(){if(Ij)return S5;Ij=1;var t=9007199254740991,e=/^(?:0|[1-9]\d*)$/;function r(n,i){var a=typeof n;return i=i??t,!!i&&(a=="number"||a!="symbol"&&e.test(n))&&n>-1&&n%1==0&&n<i}return S5=r,S5}var E5,Pj;function gN(){if(Pj)return E5;Pj=1;var t=9007199254740991;function e(r){return typeof r=="number"&&r>-1&&r%1==0&&r<=t}return E5=e,E5}var T5,kj;function FSe(){if(kj)return T5;kj=1;var t=Cy(),e=gN(),r=Rp(),n="[object Arguments]",i="[object Array]",a="[object Boolean]",s="[object Date]",o="[object Error]",c="[object Function]",f="[object Map]",d="[object Number]",m="[object Object]",b="[object RegExp]",x="[object Set]",E="[object String]",T="[object WeakMap]",A="[object ArrayBuffer]",M="[object DataView]",F="[object Float32Array]",N="[object Float64Array]",O="[object Int8Array]",U="[object Int16Array]",j="[object Int32Array]",H="[object Uint8Array]",W="[object Uint8ClampedArray]",X="[object Uint16Array]",oe="[object Uint32Array]",Q={};Q[F]=Q[N]=Q[O]=Q[U]=Q[j]=Q[H]=Q[W]=Q[X]=Q[oe]=!0,Q[n]=Q[i]=Q[A]=Q[a]=Q[M]=Q[s]=Q[o]=Q[c]=Q[f]=Q[d]=Q[m]=Q[b]=Q[x]=Q[E]=Q[T]=!1;function G(ae){return r(ae)&&e(ae.length)&&!!Q[t(ae)]}return T5=G,T5}var C5,Rj;function mN(){if(Rj)return C5;Rj=1;function t(e){return function(r){return e(r)}}return C5=t,C5}var V1={exports:{}};V1.exports;var Mj;function yN(){return Mj||(Mj=1,(function(t,e){var r=OJ(),n=e&&!e.nodeType&&e,i=n&&!0&&t&&!t.nodeType&&t,a=i&&i.exports===n,s=a&&r.process,o=(function(){try{var c=i&&i.require&&i.require("util").types;return c||s&&s.binding&&s.binding("util")}catch{}})();t.exports=o})(V1,V1.exports)),V1.exports}var A5,Dj;function FJ(){if(Dj)return A5;Dj=1;var t=FSe(),e=mN(),r=yN(),n=r&&r.isTypedArray,i=n?e(n):t;return A5=i,A5}var I5,Oj;function BJ(){if(Oj)return I5;Oj=1;var t=OSe(),e=NJ(),r=Nh(),n=pN(),i=LJ(),a=FJ(),s=Object.prototype,o=s.hasOwnProperty;function c(f,d){var m=r(f),b=!m&&e(f),x=!m&&!b&&n(f),E=!m&&!b&&!x&&a(f),T=m||b||x||E,A=T?t(f.length,String):[],M=A.length;for(var F in f)(d||o.call(f,F))&&!(T&&(F=="length"||x&&(F=="offset"||F=="parent")||E&&(F=="buffer"||F=="byteLength"||F=="byteOffset")||i(F,M)))&&A.push(F);return A}return I5=c,I5}var P5,Nj;function vN(){if(Nj)return P5;Nj=1;var t=Object.prototype;function e(r){var n=r&&r.constructor,i=typeof n=="function"&&n.prototype||t;return r===i}return P5=e,P5}var k5,Lj;function zJ(){if(Lj)return k5;Lj=1;function t(e,r){return function(n){return e(r(n))}}return k5=t,k5}var R5,Fj;function BSe(){if(Fj)return R5;Fj=1;var t=zJ(),e=t(Object.keys,Object);return R5=e,R5}var M5,Bj;function zSe(){if(Bj)return M5;Bj=1;var t=vN(),e=BSe(),r=Object.prototype,n=r.hasOwnProperty;function i(a){if(!t(a))return e(a);var s=[];for(var o in Object(a))n.call(a,o)&&o!="constructor"&&s.push(o);return s}return M5=i,M5}var D5,zj;function b_(){if(zj)return D5;zj=1;function t(e){var r=typeof e;return e!=null&&(r=="object"||r=="function")}return D5=t,D5}var O5,jj;function jJ(){if(jj)return O5;jj=1;var t=Cy(),e=b_(),r="[object AsyncFunction]",n="[object Function]",i="[object GeneratorFunction]",a="[object Proxy]";function s(o){if(!e(o))return!1;var c=t(o);return c==n||c==i||c==r||c==a}return O5=s,O5}var N5,Uj;function m3(){if(Uj)return N5;Uj=1;var t=jJ(),e=gN();function r(n){return n!=null&&e(n.length)&&!t(n)}return N5=r,N5}var L5,Vj;function Wx(){if(Vj)return L5;Vj=1;var t=BJ(),e=zSe(),r=m3();function n(i){return r(i)?t(i):e(i)}return L5=n,L5}var F5,$j;function UJ(){if($j)return F5;$j=1;var t=DSe(),e=Wx();function r(n,i){return n&&t(n,i,e)}return F5=r,F5}var B5,qj;function VJ(){if(qj)return B5;qj=1;function t(e){return e}return B5=t,B5}var z5,Hj;function jSe(){if(Hj)return z5;Hj=1;var t=VJ();function e(r){return typeof r=="function"?r:t}return z5=e,z5}var j5,Gj;function _N(){if(Gj)return j5;Gj=1;var t=UJ(),e=jSe();function r(n,i){return n&&t(n,e(i))}return j5=r,j5}var U5,Wj;function bN(){if(Wj)return U5;Wj=1;var t=zJ(),e=t(Object.getPrototypeOf,Object);return U5=e,U5}var V5,Xj;function USe(){if(Xj)return V5;Xj=1;var t=Cy(),e=bN(),r=Rp(),n="[object Object]",i=Function.prototype,a=Object.prototype,s=i.toString,o=a.hasOwnProperty,c=s.call(Object);function f(d){if(!r(d)||t(d)!=n)return!1;var m=e(d);if(m===null)return!0;var b=o.call(m,"constructor")&&m.constructor;return typeof b=="function"&&b instanceof b&&s.call(b)==c}return V5=f,V5}var $5,Yj;function $J(){if(Yj)return $5;Yj=1;function t(e,r){for(var n=-1,i=e==null?0:e.length,a=Array(i);++n<i;)a[n]=r(e[n],n,e);return a}return $5=t,$5}var q5,Zj;function VSe(){if(Zj)return q5;Zj=1;function t(){this.__data__=[],this.size=0}return q5=t,q5}var H5,Kj;function xN(){if(Kj)return H5;Kj=1;function t(e,r){return e===r||e!==e&&r!==r}return H5=t,H5}var G5,Jj;function y3(){if(Jj)return G5;Jj=1;var t=xN();function e(r,n){for(var i=r.length;i--;)if(t(r[i][0],n))return i;return-1}return G5=e,G5}var W5,Qj;function $Se(){if(Qj)return W5;Qj=1;var t=y3(),e=Array.prototype,r=e.splice;function n(i){var a=this.__data__,s=t(a,i);if(s<0)return!1;var o=a.length-1;return s==o?a.pop():r.call(a,s,1),--this.size,!0}return W5=n,W5}var X5,eU;function qSe(){if(eU)return X5;eU=1;var t=y3();function e(r){var n=this.__data__,i=t(n,r);return i<0?void 0:n[i][1]}return X5=e,X5}var Y5,tU;function HSe(){if(tU)return Y5;tU=1;var t=y3();function e(r){return t(this.__data__,r)>-1}return Y5=e,Y5}var Z5,rU;function GSe(){if(rU)return Z5;rU=1;var t=y3();function e(r,n){var i=this.__data__,a=t(i,r);return a<0?(++this.size,i.push([r,n])):i[a][1]=n,this}return Z5=e,Z5}var K5,nU;function v3(){if(nU)return K5;nU=1;var t=VSe(),e=$Se(),r=qSe(),n=HSe(),i=GSe();function a(s){var o=-1,c=s==null?0:s.length;for(this.clear();++o<c;){var f=s[o];this.set(f[0],f[1])}}return a.prototype.clear=t,a.prototype.delete=e,a.prototype.get=r,a.prototype.has=n,a.prototype.set=i,K5=a,K5}var J5,iU;function WSe(){if(iU)return J5;iU=1;var t=v3();function e(){this.__data__=new t,this.size=0}return J5=e,J5}var Q5,aU;function XSe(){if(aU)return Q5;aU=1;function t(e){var r=this.__data__,n=r.delete(e);return this.size=r.size,n}return Q5=t,Q5}var e4,oU;function YSe(){if(oU)return e4;oU=1;function t(e){return this.__data__.get(e)}return e4=t,e4}var t4,sU;function ZSe(){if(sU)return t4;sU=1;function t(e){return this.__data__.has(e)}return t4=t,t4}var r4,lU;function KSe(){if(lU)return r4;lU=1;var t=Md(),e=t["__core-js_shared__"];return r4=e,r4}var n4,uU;function JSe(){if(uU)return n4;uU=1;var t=KSe(),e=(function(){var n=/[^.]+$/.exec(t&&t.keys&&t.keys.IE_PROTO||"");return n?"Symbol(src)_1."+n:""})();function r(n){return!!e&&e in n}return n4=r,n4}var i4,cU;function qJ(){if(cU)return i4;cU=1;var t=Function.prototype,e=t.toString;function r(n){if(n!=null){try{return e.call(n)}catch{}try{return n+""}catch{}}return""}return i4=r,i4}var a4,fU;function QSe(){if(fU)return a4;fU=1;var t=jJ(),e=JSe(),r=b_(),n=qJ(),i=/[\\^$.*+?()[\]{}|]/g,a=/^\[object .+?Constructor\]$/,s=Function.prototype,o=Object.prototype,c=s.toString,f=o.hasOwnProperty,d=RegExp("^"+c.call(f).replace(i,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function m(b){if(!r(b)||e(b))return!1;var x=t(b)?d:a;return x.test(n(b))}return a4=m,a4}var o4,hU;function eEe(){if(hU)return o4;hU=1;function t(e,r){return e?.[r]}return o4=t,o4}var s4,dU;function Ay(){if(dU)return s4;dU=1;var t=QSe(),e=eEe();function r(n,i){var a=e(n,i);return t(a)?a:void 0}return s4=r,s4}var l4,pU;function wN(){if(pU)return l4;pU=1;var t=Ay(),e=Md(),r=t(e,"Map");return l4=r,l4}var u4,gU;function _3(){if(gU)return u4;gU=1;var t=Ay(),e=t(Object,"create");return u4=e,u4}var c4,mU;function tEe(){if(mU)return c4;mU=1;var t=_3();function e(){this.__data__=t?t(null):{},this.size=0}return c4=e,c4}var f4,yU;function rEe(){if(yU)return f4;yU=1;function t(e){var r=this.has(e)&&delete this.__data__[e];return this.size-=r?1:0,r}return f4=t,f4}var h4,vU;function nEe(){if(vU)return h4;vU=1;var t=_3(),e="__lodash_hash_undefined__",r=Object.prototype,n=r.hasOwnProperty;function i(a){var s=this.__data__;if(t){var o=s[a];return o===e?void 0:o}return n.call(s,a)?s[a]:void 0}return h4=i,h4}var d4,_U;function iEe(){if(_U)return d4;_U=1;var t=_3(),e=Object.prototype,r=e.hasOwnProperty;function n(i){var a=this.__data__;return t?a[i]!==void 0:r.call(a,i)}return d4=n,d4}var p4,bU;function aEe(){if(bU)return p4;bU=1;var t=_3(),e="__lodash_hash_undefined__";function r(n,i){var a=this.__data__;return this.size+=this.has(n)?0:1,a[n]=t&&i===void 0?e:i,this}return p4=r,p4}var g4,xU;function oEe(){if(xU)return g4;xU=1;var t=tEe(),e=rEe(),r=nEe(),n=iEe(),i=aEe();function a(s){var o=-1,c=s==null?0:s.length;for(this.clear();++o<c;){var f=s[o];this.set(f[0],f[1])}}return a.prototype.clear=t,a.prototype.delete=e,a.prototype.get=r,a.prototype.has=n,a.prototype.set=i,g4=a,g4}var m4,wU;function sEe(){if(wU)return m4;wU=1;var t=oEe(),e=v3(),r=wN();function n(){this.size=0,this.__data__={hash:new t,map:new(r||e),string:new t}}return m4=n,m4}var y4,SU;function lEe(){if(SU)return y4;SU=1;function t(e){var r=typeof e;return r=="string"||r=="number"||r=="symbol"||r=="boolean"?e!=="__proto__":e===null}return y4=t,y4}var v4,EU;function b3(){if(EU)return v4;EU=1;var t=lEe();function e(r,n){var i=r.__data__;return t(n)?i[typeof n=="string"?"string":"hash"]:i.map}return v4=e,v4}var _4,TU;function uEe(){if(TU)return _4;TU=1;var t=b3();function e(r){var n=t(this,r).delete(r);return this.size-=n?1:0,n}return _4=e,_4}var b4,CU;function cEe(){if(CU)return b4;CU=1;var t=b3();function e(r){return t(this,r).get(r)}return b4=e,b4}var x4,AU;function fEe(){if(AU)return x4;AU=1;var t=b3();function e(r){return t(this,r).has(r)}return x4=e,x4}var w4,IU;function hEe(){if(IU)return w4;IU=1;var t=b3();function e(r,n){var i=t(this,r),a=i.size;return i.set(r,n),this.size+=i.size==a?0:1,this}return w4=e,w4}var S4,PU;function SN(){if(PU)return S4;PU=1;var t=sEe(),e=uEe(),r=cEe(),n=fEe(),i=hEe();function a(s){var o=-1,c=s==null?0:s.length;for(this.clear();++o<c;){var f=s[o];this.set(f[0],f[1])}}return a.prototype.clear=t,a.prototype.delete=e,a.prototype.get=r,a.prototype.has=n,a.prototype.set=i,S4=a,S4}var E4,kU;function dEe(){if(kU)return E4;kU=1;var t=v3(),e=wN(),r=SN(),n=200;function i(a,s){var o=this.__data__;if(o instanceof t){var c=o.__data__;if(!e||c.length<n-1)return c.push([a,s]),this.size=++o.size,this;o=this.__data__=new r(c)}return o.set(a,s),this.size=o.size,this}return E4=i,E4}var T4,RU;function EN(){if(RU)return T4;RU=1;var t=v3(),e=WSe(),r=XSe(),n=YSe(),i=ZSe(),a=dEe();function s(o){var c=this.__data__=new t(o);this.size=c.size}return s.prototype.clear=e,s.prototype.delete=r,s.prototype.get=n,s.prototype.has=i,s.prototype.set=a,T4=s,T4}var C4,MU;function pEe(){if(MU)return C4;MU=1;var t="__lodash_hash_undefined__";function e(r){return this.__data__.set(r,t),this}return C4=e,C4}var A4,DU;function gEe(){if(DU)return A4;DU=1;function t(e){return this.__data__.has(e)}return A4=t,A4}var I4,OU;function mEe(){if(OU)return I4;OU=1;var t=SN(),e=pEe(),r=gEe();function n(i){var a=-1,s=i==null?0:i.length;for(this.__data__=new t;++a<s;)this.add(i[a])}return n.prototype.add=n.prototype.push=e,n.prototype.has=r,I4=n,I4}var P4,NU;function yEe(){if(NU)return P4;NU=1;function t(e,r){for(var n=-1,i=e==null?0:e.length;++n<i;)if(r(e[n],n,e))return!0;return!1}return P4=t,P4}var k4,LU;function vEe(){if(LU)return k4;LU=1;function t(e,r){return e.has(r)}return k4=t,k4}var R4,FU;function HJ(){if(FU)return R4;FU=1;var t=mEe(),e=yEe(),r=vEe(),n=1,i=2;function a(s,o,c,f,d,m){var b=c&n,x=s.length,E=o.length;if(x!=E&&!(b&&E>x))return!1;var T=m.get(s),A=m.get(o);if(T&&A)return T==o&&A==s;var M=-1,F=!0,N=c&i?new t:void 0;for(m.set(s,o),m.set(o,s);++M<x;){var O=s[M],U=o[M];if(f)var j=b?f(U,O,M,o,s,m):f(O,U,M,s,o,m);if(j!==void 0){if(j)continue;F=!1;break}if(N){if(!e(o,function(H,W){if(!r(N,W)&&(O===H||d(O,H,c,f,m)))return N.push(W)})){F=!1;break}}else if(!(O===U||d(O,U,c,f,m))){F=!1;break}}return m.delete(s),m.delete(o),F}return R4=a,R4}var M4,BU;function GJ(){if(BU)return M4;BU=1;var t=Md(),e=t.Uint8Array;return M4=e,M4}var D4,zU;function _Ee(){if(zU)return D4;zU=1;function t(e){var r=-1,n=Array(e.size);return e.forEach(function(i,a){n[++r]=[a,i]}),n}return D4=t,D4}var O4,jU;function bEe(){if(jU)return O4;jU=1;function t(e){var r=-1,n=Array(e.size);return e.forEach(function(i){n[++r]=i}),n}return O4=t,O4}var N4,UU;function xEe(){if(UU)return N4;UU=1;var t=Gx(),e=GJ(),r=xN(),n=HJ(),i=_Ee(),a=bEe(),s=1,o=2,c="[object Boolean]",f="[object Date]",d="[object Error]",m="[object Map]",b="[object Number]",x="[object RegExp]",E="[object Set]",T="[object String]",A="[object Symbol]",M="[object ArrayBuffer]",F="[object DataView]",N=t?t.prototype:void 0,O=N?N.valueOf:void 0;function U(j,H,W,X,oe,Q,G){switch(W){case F:if(j.byteLength!=H.byteLength||j.byteOffset!=H.byteOffset)return!1;j=j.buffer,H=H.buffer;case M:return!(j.byteLength!=H.byteLength||!Q(new e(j),new e(H)));case c:case f:case b:return r(+j,+H);case d:return j.name==H.name&&j.message==H.message;case x:case T:return j==H+"";case m:var ae=i;case E:var se=X&s;if(ae||(ae=a),j.size!=H.size&&!se)return!1;var fe=G.get(j);if(fe)return fe==H;X|=o,G.set(j,H);var _e=n(ae(j),ae(H),X,oe,Q,G);return G.delete(j),_e;case A:if(O)return O.call(j)==O.call(H)}return!1}return N4=U,N4}var L4,VU;function WJ(){if(VU)return L4;VU=1;function t(e,r){for(var n=-1,i=r.length,a=e.length;++n<i;)e[a+n]=r[n];return e}return L4=t,L4}var F4,$U;function XJ(){if($U)return F4;$U=1;var t=WJ(),e=Nh();function r(n,i,a){var s=i(n);return e(n)?s:t(s,a(n))}return F4=r,F4}var B4,qU;function wEe(){if(qU)return B4;qU=1;function t(e,r){for(var n=-1,i=e==null?0:e.length,a=0,s=[];++n<i;){var o=e[n];r(o,n,e)&&(s[a++]=o)}return s}return B4=t,B4}var z4,HU;function YJ(){if(HU)return z4;HU=1;function t(){return[]}return z4=t,z4}var j4,GU;function TN(){if(GU)return j4;GU=1;var t=wEe(),e=YJ(),r=Object.prototype,n=r.propertyIsEnumerable,i=Object.getOwnPropertySymbols,a=i?function(s){return s==null?[]:(s=Object(s),t(i(s),function(o){return n.call(s,o)}))}:e;return j4=a,j4}var U4,WU;function ZJ(){if(WU)return U4;WU=1;var t=XJ(),e=TN(),r=Wx();function n(i){return t(i,r,e)}return U4=n,U4}var V4,XU;function SEe(){if(XU)return V4;XU=1;var t=ZJ(),e=1,r=Object.prototype,n=r.hasOwnProperty;function i(a,s,o,c,f,d){var m=o&e,b=t(a),x=b.length,E=t(s),T=E.length;if(x!=T&&!m)return!1;for(var A=x;A--;){var M=b[A];if(!(m?M in s:n.call(s,M)))return!1}var F=d.get(a),N=d.get(s);if(F&&N)return F==s&&N==a;var O=!0;d.set(a,s),d.set(s,a);for(var U=m;++A<x;){M=b[A];var j=a[M],H=s[M];if(c)var W=m?c(H,j,M,s,a,d):c(j,H,M,a,s,d);if(!(W===void 0?j===H||f(j,H,o,c,d):W)){O=!1;break}U||(U=M=="constructor")}if(O&&!U){var X=a.constructor,oe=s.constructor;X!=oe&&"constructor"in a&&"constructor"in s&&!(typeof X=="function"&&X instanceof X&&typeof oe=="function"&&oe instanceof oe)&&(O=!1)}return d.delete(a),d.delete(s),O}return V4=i,V4}var $4,YU;function EEe(){if(YU)return $4;YU=1;var t=Ay(),e=Md(),r=t(e,"DataView");return $4=r,$4}var q4,ZU;function TEe(){if(ZU)return q4;ZU=1;var t=Ay(),e=Md(),r=t(e,"Promise");return q4=r,q4}var H4,KU;function CEe(){if(KU)return H4;KU=1;var t=Ay(),e=Md(),r=t(e,"Set");return H4=r,H4}var G4,JU;function AEe(){if(JU)return G4;JU=1;var t=Ay(),e=Md(),r=t(e,"WeakMap");return G4=r,G4}var W4,QU;function x3(){if(QU)return W4;QU=1;var t=EEe(),e=wN(),r=TEe(),n=CEe(),i=AEe(),a=Cy(),s=qJ(),o="[object Map]",c="[object Object]",f="[object Promise]",d="[object Set]",m="[object WeakMap]",b="[object DataView]",x=s(t),E=s(e),T=s(r),A=s(n),M=s(i),F=a;return(t&&F(new t(new ArrayBuffer(1)))!=b||e&&F(new e)!=o||r&&F(r.resolve())!=f||n&&F(new n)!=d||i&&F(new i)!=m)&&(F=function(N){var O=a(N),U=O==c?N.constructor:void 0,j=U?s(U):"";if(j)switch(j){case x:return b;case E:return o;case T:return f;case A:return d;case M:return m}return O}),W4=F,W4}var X4,eV;function IEe(){if(eV)return X4;eV=1;var t=EN(),e=HJ(),r=xEe(),n=SEe(),i=x3(),a=Nh(),s=pN(),o=FJ(),c=1,f="[object Arguments]",d="[object Array]",m="[object Object]",b=Object.prototype,x=b.hasOwnProperty;function E(T,A,M,F,N,O){var U=a(T),j=a(A),H=U?d:i(T),W=j?d:i(A);H=H==f?m:H,W=W==f?m:W;var X=H==m,oe=W==m,Q=H==W;if(Q&&s(T)){if(!s(A))return!1;U=!0,X=!1}if(Q&&!X)return O||(O=new t),U||o(T)?e(T,A,M,F,N,O):r(T,A,H,M,F,N,O);if(!(M&c)){var G=X&&x.call(T,"__wrapped__"),ae=oe&&x.call(A,"__wrapped__");if(G||ae){var se=G?T.value():T,fe=ae?A.value():A;return O||(O=new t),N(se,fe,M,F,O)}}return Q?(O||(O=new t),n(T,A,M,F,N,O)):!1}return X4=E,X4}var Y4,tV;function KJ(){if(tV)return Y4;tV=1;var t=IEe(),e=Rp();function r(n,i,a,s,o){return n===i?!0:n==null||i==null||!e(n)&&!e(i)?n!==n&&i!==i:t(n,i,a,s,r,o)}return Y4=r,Y4}var Z4,rV;function PEe(){if(rV)return Z4;rV=1;var t=EN(),e=KJ(),r=1,n=2;function i(a,s,o,c){var f=o.length,d=f,m=!c;if(a==null)return!d;for(a=Object(a);f--;){var b=o[f];if(m&&b[2]?b[1]!==a[b[0]]:!(b[0]in a))return!1}for(;++f<d;){b=o[f];var x=b[0],E=a[x],T=b[1];if(m&&b[2]){if(E===void 0&&!(x in a))return!1}else{var A=new t;if(c)var M=c(E,T,x,a,s,A);if(!(M===void 0?e(T,E,r|n,c,A):M))return!1}}return!0}return Z4=i,Z4}var K4,nV;function JJ(){if(nV)return K4;nV=1;var t=b_();function e(r){return r===r&&!t(r)}return K4=e,K4}var J4,iV;function kEe(){if(iV)return J4;iV=1;var t=JJ(),e=Wx();function r(n){for(var i=e(n),a=i.length;a--;){var s=i[a],o=n[s];i[a]=[s,o,t(o)]}return i}return J4=r,J4}var Q4,aV;function QJ(){if(aV)return Q4;aV=1;function t(e,r){return function(n){return n==null?!1:n[e]===r&&(r!==void 0||e in Object(n))}}return Q4=t,Q4}var eI,oV;function REe(){if(oV)return eI;oV=1;var t=PEe(),e=kEe(),r=QJ();function n(i){var a=e(i);return a.length==1&&a[0][2]?r(a[0][0],a[0][1]):function(s){return s===i||t(s,i,a)}}return eI=n,eI}var tI,sV;function CN(){if(sV)return tI;sV=1;var t=Cy(),e=Rp(),r="[object Symbol]";function n(i){return typeof i=="symbol"||e(i)&&t(i)==r}return tI=n,tI}var rI,lV;function AN(){if(lV)return rI;lV=1;var t=Nh(),e=CN(),r=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,n=/^\w*$/;function i(a,s){if(t(a))return!1;var o=typeof a;return o=="number"||o=="symbol"||o=="boolean"||a==null||e(a)?!0:n.test(a)||!r.test(a)||s!=null&&a in Object(s)}return rI=i,rI}var nI,uV;function MEe(){if(uV)return nI;uV=1;var t=SN(),e="Expected a function";function r(n,i){if(typeof n!="function"||i!=null&&typeof i!="function")throw new TypeError(e);var a=function(){var s=arguments,o=i?i.apply(this,s):s[0],c=a.cache;if(c.has(o))return c.get(o);var f=n.apply(this,s);return a.cache=c.set(o,f)||c,f};return a.cache=new(r.Cache||t),a}return r.Cache=t,nI=r,nI}var iI,cV;function DEe(){if(cV)return iI;cV=1;var t=MEe(),e=500;function r(n){var i=t(n,function(s){return a.size===e&&a.clear(),s}),a=i.cache;return i}return iI=r,iI}var aI,fV;function OEe(){if(fV)return aI;fV=1;var t=DEe(),e=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,r=/\\(\\)?/g,n=t(function(i){var a=[];return i.charCodeAt(0)===46&&a.push(""),i.replace(e,function(s,o,c,f){a.push(c?f.replace(r,"$1"):o||s)}),a});return aI=n,aI}var oI,hV;function NEe(){if(hV)return oI;hV=1;var t=Gx(),e=$J(),r=Nh(),n=CN(),i=t?t.prototype:void 0,a=i?i.toString:void 0;function s(o){if(typeof o=="string")return o;if(r(o))return e(o,s)+"";if(n(o))return a?a.call(o):"";var c=o+"";return c=="0"&&1/o==-1/0?"-0":c}return oI=s,oI}var sI,dV;function LEe(){if(dV)return sI;dV=1;var t=NEe();function e(r){return r==null?"":t(r)}return sI=e,sI}var lI,pV;function eQ(){if(pV)return lI;pV=1;var t=Nh(),e=AN(),r=OEe(),n=LEe();function i(a,s){return t(a)?a:e(a,s)?[a]:r(n(a))}return lI=i,lI}var uI,gV;function w3(){if(gV)return uI;gV=1;var t=CN();function e(r){if(typeof r=="string"||t(r))return r;var n=r+"";return n=="0"&&1/r==-1/0?"-0":n}return uI=e,uI}var cI,mV;function tQ(){if(mV)return cI;mV=1;var t=eQ(),e=w3();function r(n,i){i=t(i,n);for(var a=0,s=i.length;n!=null&&a<s;)n=n[e(i[a++])];return a&&a==s?n:void 0}return cI=r,cI}var fI,yV;function FEe(){if(yV)return fI;yV=1;var t=tQ();function e(r,n,i){var a=r==null?void 0:t(r,n);return a===void 0?i:a}return fI=e,fI}var hI,vV;function BEe(){if(vV)return hI;vV=1;function t(e,r){return e!=null&&r in Object(e)}return hI=t,hI}var dI,_V;function zEe(){if(_V)return dI;_V=1;var t=eQ(),e=NJ(),r=Nh(),n=LJ(),i=gN(),a=w3();function s(o,c,f){c=t(c,o);for(var d=-1,m=c.length,b=!1;++d<m;){var x=a(c[d]);if(!(b=o!=null&&f(o,x)))break;o=o[x]}return b||++d!=m?b:(m=o==null?0:o.length,!!m&&i(m)&&n(x,m)&&(r(o)||e(o)))}return dI=s,dI}var pI,bV;function jEe(){if(bV)return pI;bV=1;var t=BEe(),e=zEe();function r(n,i){return n!=null&&e(n,i,t)}return pI=r,pI}var gI,xV;function UEe(){if(xV)return gI;xV=1;var t=KJ(),e=FEe(),r=jEe(),n=AN(),i=JJ(),a=QJ(),s=w3(),o=1,c=2;function f(d,m){return n(d)&&i(m)?a(s(d),m):function(b){var x=e(b,d);return x===void 0&&x===m?r(b,d):t(m,x,o|c)}}return gI=f,gI}var mI,wV;function VEe(){if(wV)return mI;wV=1;function t(e){return function(r){return r?.[e]}}return mI=t,mI}var yI,SV;function $Ee(){if(SV)return yI;SV=1;var t=tQ();function e(r){return function(n){return t(n,r)}}return yI=e,yI}var vI,EV;function qEe(){if(EV)return vI;EV=1;var t=VEe(),e=$Ee(),r=AN(),n=w3();function i(a){return r(a)?t(n(a)):e(a)}return vI=i,vI}var _I,TV;function HEe(){if(TV)return _I;TV=1;var t=REe(),e=UEe(),r=VJ(),n=Nh(),i=qEe();function a(s){return typeof s=="function"?s:s==null?r:typeof s=="object"?n(s)?e(s[0],s[1]):t(s):i(s)}return _I=a,_I}var bI,CV;function GEe(){if(CV)return bI;CV=1;var t=m3();function e(r,n){return function(i,a){if(i==null)return i;if(!t(i))return r(i,a);for(var s=i.length,o=n?s:-1,c=Object(i);(n?o--:++o<s)&&a(c[o],o,c)!==!1;);return i}}return bI=e,bI}var xI,AV;function WEe(){if(AV)return xI;AV=1;var t=UJ(),e=GEe(),r=e(t);return xI=r,xI}var wI,IV;function XEe(){if(IV)return wI;IV=1;var t=WEe(),e=m3();function r(n,i){var a=-1,s=e(n)?Array(n.length):[];return t(n,function(o,c,f){s[++a]=i(o,c,f)}),s}return wI=r,wI}var SI,PV;function YEe(){if(PV)return SI;PV=1;var t=$J(),e=HEe(),r=XEe(),n=Nh();function i(a,s){var o=n(a)?t:r;return o(a,e(s,3))}return SI=i,SI}var kV;function ZEe(){if(kV)return bv;kV=1,Object.defineProperty(bv,"__esModule",{value:!0}),bv.flattenNames=void 0;var t=RSe(),e=c(t),r=_N(),n=c(r),i=USe(),a=c(i),s=YEe(),o=c(s);function c(d){return d&&d.__esModule?d:{default:d}}var f=bv.flattenNames=function d(){var m=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],b=[];return(0,o.default)(m,function(x){Array.isArray(x)?d(x).map(function(E){return b.push(E)}):(0,a.default)(x)?(0,n.default)(x,function(E,T){E===!0&&b.push(T),b.push(T+"-"+E)}):(0,e.default)(x)&&b.push(x)}),b};return bv.default=f,bv}var xv={},EI,RV;function KEe(){if(RV)return EI;RV=1;function t(e,r){for(var n=-1,i=e==null?0:e.length;++n<i&&r(e[n],n,e)!==!1;);return e}return EI=t,EI}var TI,MV;function JEe(){if(MV)return TI;MV=1;var t=Ay(),e=(function(){try{var r=t(Object,"defineProperty");return r({},"",{}),r}catch{}})();return TI=e,TI}var CI,DV;function rQ(){if(DV)return CI;DV=1;var t=JEe();function e(r,n,i){n=="__proto__"&&t?t(r,n,{configurable:!0,enumerable:!0,value:i,writable:!0}):r[n]=i}return CI=e,CI}var AI,OV;function nQ(){if(OV)return AI;OV=1;var t=rQ(),e=xN(),r=Object.prototype,n=r.hasOwnProperty;function i(a,s,o){var c=a[s];(!(n.call(a,s)&&e(c,o))||o===void 0&&!(s in a))&&t(a,s,o)}return AI=i,AI}var II,NV;function S3(){if(NV)return II;NV=1;var t=nQ(),e=rQ();function r(n,i,a,s){var o=!a;a||(a={});for(var c=-1,f=i.length;++c<f;){var d=i[c],m=s?s(a[d],n[d],d,a,n):void 0;m===void 0&&(m=n[d]),o?e(a,d,m):t(a,d,m)}return a}return II=r,II}var PI,LV;function QEe(){if(LV)return PI;LV=1;var t=S3(),e=Wx();function r(n,i){return n&&t(i,e(i),n)}return PI=r,PI}var kI,FV;function eTe(){if(FV)return kI;FV=1;function t(e){var r=[];if(e!=null)for(var n in Object(e))r.push(n);return r}return kI=t,kI}var RI,BV;function tTe(){if(BV)return RI;BV=1;var t=b_(),e=vN(),r=eTe(),n=Object.prototype,i=n.hasOwnProperty;function a(s){if(!t(s))return r(s);var o=e(s),c=[];for(var f in s)f=="constructor"&&(o||!i.call(s,f))||c.push(f);return c}return RI=a,RI}var MI,zV;function IN(){if(zV)return MI;zV=1;var t=BJ(),e=tTe(),r=m3();function n(i){return r(i)?t(i,!0):e(i)}return MI=n,MI}var DI,jV;function rTe(){if(jV)return DI;jV=1;var t=S3(),e=IN();function r(n,i){return n&&t(i,e(i),n)}return DI=r,DI}var $1={exports:{}};$1.exports;var UV;function nTe(){return UV||(UV=1,(function(t,e){var r=Md(),n=e&&!e.nodeType&&e,i=n&&!0&&t&&!t.nodeType&&t,a=i&&i.exports===n,s=a?r.Buffer:void 0,o=s?s.allocUnsafe:void 0;function c(f,d){if(d)return f.slice();var m=f.length,b=o?o(m):new f.constructor(m);return f.copy(b),b}t.exports=c})($1,$1.exports)),$1.exports}var OI,VV;function iTe(){if(VV)return OI;VV=1;function t(e,r){var n=-1,i=e.length;for(r||(r=Array(i));++n<i;)r[n]=e[n];return r}return OI=t,OI}var NI,$V;function aTe(){if($V)return NI;$V=1;var t=S3(),e=TN();function r(n,i){return t(n,e(n),i)}return NI=r,NI}var LI,qV;function iQ(){if(qV)return LI;qV=1;var t=WJ(),e=bN(),r=TN(),n=YJ(),i=Object.getOwnPropertySymbols,a=i?function(s){for(var o=[];s;)t(o,r(s)),s=e(s);return o}:n;return LI=a,LI}var FI,HV;function oTe(){if(HV)return FI;HV=1;var t=S3(),e=iQ();function r(n,i){return t(n,e(n),i)}return FI=r,FI}var BI,GV;function sTe(){if(GV)return BI;GV=1;var t=XJ(),e=iQ(),r=IN();function n(i){return t(i,r,e)}return BI=n,BI}var zI,WV;function lTe(){if(WV)return zI;WV=1;var t=Object.prototype,e=t.hasOwnProperty;function r(n){var i=n.length,a=new n.constructor(i);return i&&typeof n[0]=="string"&&e.call(n,"index")&&(a.index=n.index,a.input=n.input),a}return zI=r,zI}var jI,XV;function PN(){if(XV)return jI;XV=1;var t=GJ();function e(r){var n=new r.constructor(r.byteLength);return new t(n).set(new t(r)),n}return jI=e,jI}var UI,YV;function uTe(){if(YV)return UI;YV=1;var t=PN();function e(r,n){var i=n?t(r.buffer):r.buffer;return new r.constructor(i,r.byteOffset,r.byteLength)}return UI=e,UI}var VI,ZV;function cTe(){if(ZV)return VI;ZV=1;var t=/\w*$/;function e(r){var n=new r.constructor(r.source,t.exec(r));return n.lastIndex=r.lastIndex,n}return VI=e,VI}var $I,KV;function fTe(){if(KV)return $I;KV=1;var t=Gx(),e=t?t.prototype:void 0,r=e?e.valueOf:void 0;function n(i){return r?Object(r.call(i)):{}}return $I=n,$I}var qI,JV;function hTe(){if(JV)return qI;JV=1;var t=PN();function e(r,n){var i=n?t(r.buffer):r.buffer;return new r.constructor(i,r.byteOffset,r.length)}return qI=e,qI}var HI,QV;function dTe(){if(QV)return HI;QV=1;var t=PN(),e=uTe(),r=cTe(),n=fTe(),i=hTe(),a="[object Boolean]",s="[object Date]",o="[object Map]",c="[object Number]",f="[object RegExp]",d="[object Set]",m="[object String]",b="[object Symbol]",x="[object ArrayBuffer]",E="[object DataView]",T="[object Float32Array]",A="[object Float64Array]",M="[object Int8Array]",F="[object Int16Array]",N="[object Int32Array]",O="[object Uint8Array]",U="[object Uint8ClampedArray]",j="[object Uint16Array]",H="[object Uint32Array]";function W(X,oe,Q){var G=X.constructor;switch(oe){case x:return t(X);case a:case s:return new G(+X);case E:return e(X,Q);case T:case A:case M:case F:case N:case O:case U:case j:case H:return i(X,Q);case o:return new G;case c:case m:return new G(X);case f:return r(X);case d:return new G;case b:return n(X)}}return HI=W,HI}var GI,e$;function pTe(){if(e$)return GI;e$=1;var t=b_(),e=Object.create,r=(function(){function n(){}return function(i){if(!t(i))return{};if(e)return e(i);n.prototype=i;var a=new n;return n.prototype=void 0,a}})();return GI=r,GI}var WI,t$;function gTe(){if(t$)return WI;t$=1;var t=pTe(),e=bN(),r=vN();function n(i){return typeof i.constructor=="function"&&!r(i)?t(e(i)):{}}return WI=n,WI}var XI,r$;function mTe(){if(r$)return XI;r$=1;var t=x3(),e=Rp(),r="[object Map]";function n(i){return e(i)&&t(i)==r}return XI=n,XI}var YI,n$;function yTe(){if(n$)return YI;n$=1;var t=mTe(),e=mN(),r=yN(),n=r&&r.isMap,i=n?e(n):t;return YI=i,YI}var ZI,i$;function vTe(){if(i$)return ZI;i$=1;var t=x3(),e=Rp(),r="[object Set]";function n(i){return e(i)&&t(i)==r}return ZI=n,ZI}var KI,a$;function _Te(){if(a$)return KI;a$=1;var t=vTe(),e=mN(),r=yN(),n=r&&r.isSet,i=n?e(n):t;return KI=i,KI}var JI,o$;function bTe(){if(o$)return JI;o$=1;var t=EN(),e=KEe(),r=nQ(),n=QEe(),i=rTe(),a=nTe(),s=iTe(),o=aTe(),c=oTe(),f=ZJ(),d=sTe(),m=x3(),b=lTe(),x=dTe(),E=gTe(),T=Nh(),A=pN(),M=yTe(),F=b_(),N=_Te(),O=Wx(),U=IN(),j=1,H=2,W=4,X="[object Arguments]",oe="[object Array]",Q="[object Boolean]",G="[object Date]",ae="[object Error]",se="[object Function]",fe="[object GeneratorFunction]",_e="[object Map]",Le="[object Number]",ye="[object Object]",Te="[object RegExp]",Ie="[object Set]",Me="[object String]",de="[object Symbol]",Se="[object WeakMap]",we="[object ArrayBuffer]",De="[object DataView]",Fe="[object Float32Array]",Xe="[object Float64Array]",Be="[object Int8Array]",st="[object Int16Array]",Qe="[object Int32Array]",it="[object Uint8Array]",be="[object Uint8ClampedArray]",Ot="[object Uint16Array]",at="[object Uint32Array]",$e={};$e[X]=$e[oe]=$e[we]=$e[De]=$e[Q]=$e[G]=$e[Fe]=$e[Xe]=$e[Be]=$e[st]=$e[Qe]=$e[_e]=$e[Le]=$e[ye]=$e[Te]=$e[Ie]=$e[Me]=$e[de]=$e[it]=$e[be]=$e[Ot]=$e[at]=!0,$e[ae]=$e[se]=$e[Se]=!1;function Xt($t,cr,_t,gr,mr,ar){var Cr,Er=cr&j,Jt=cr&H,ot=cr&W;if(_t&&(Cr=mr?_t($t,gr,mr,ar):_t($t)),Cr!==void 0)return Cr;if(!F($t))return $t;var Ce=T($t);if(Ce){if(Cr=b($t),!Er)return s($t,Cr)}else{var xe=m($t),je=xe==se||xe==fe;if(A($t))return a($t,Er);if(xe==ye||xe==X||je&&!mr){if(Cr=Jt||je?{}:E($t),!Er)return Jt?c($t,i(Cr,$t)):o($t,n(Cr,$t))}else{if(!$e[xe])return mr?$t:{};Cr=x($t,xe,Er)}}ar||(ar=new t);var qe=ar.get($t);if(qe)return qe;ar.set($t,Cr),N($t)?$t.forEach(function(Et){Cr.add(Xt(Et,cr,_t,Et,$t,ar))}):M($t)&&$t.forEach(function(Et,mt){Cr.set(mt,Xt(Et,cr,_t,mt,$t,ar))});var Ge=ot?Jt?d:f:Jt?U:O,Ft=Ce?void 0:Ge($t);return e(Ft||$t,function(Et,mt){Ft&&(mt=Et,Et=$t[mt]),r(Cr,mt,Xt(Et,cr,_t,mt,$t,ar))}),Cr}return JI=Xt,JI}var QI,s$;function xTe(){if(s$)return QI;s$=1;var t=bTe(),e=1,r=4;function n(i){return t(i,e|r)}return QI=n,QI}var l$;function wTe(){if(l$)return xv;l$=1,Object.defineProperty(xv,"__esModule",{value:!0}),xv.mergeClasses=void 0;var t=_N(),e=a(t),r=xTe(),n=a(r),i=Object.assign||function(o){for(var c=1;c<arguments.length;c++){var f=arguments[c];for(var d in f)Object.prototype.hasOwnProperty.call(f,d)&&(o[d]=f[d])}return o};function a(o){return o&&o.__esModule?o:{default:o}}var s=xv.mergeClasses=function(c){var f=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],d=c.default&&(0,n.default)(c.default)||{};return f.map(function(m){var b=c[m];return b&&(0,e.default)(b,function(x,E){d[E]||(d[E]={}),d[E]=i({},d[E],b[E])}),m}),d};return xv.default=s,xv}var wv={},u$;function STe(){if(u$)return wv;u$=1,Object.defineProperty(wv,"__esModule",{value:!0}),wv.autoprefix=void 0;var t=_N(),e=n(t),r=Object.assign||function(s){for(var o=1;o<arguments.length;o++){var c=arguments[o];for(var f in c)Object.prototype.hasOwnProperty.call(c,f)&&(s[f]=c[f])}return s};function n(s){return s&&s.__esModule?s:{default:s}}var i={borderRadius:function(o){return{msBorderRadius:o,MozBorderRadius:o,OBorderRadius:o,WebkitBorderRadius:o,borderRadius:o}},boxShadow:function(o){return{msBoxShadow:o,MozBoxShadow:o,OBoxShadow:o,WebkitBoxShadow:o,boxShadow:o}},userSelect:function(o){return{WebkitTouchCallout:o,KhtmlUserSelect:o,MozUserSelect:o,msUserSelect:o,WebkitUserSelect:o,userSelect:o}},flex:function(o){return{WebkitBoxFlex:o,MozBoxFlex:o,WebkitFlex:o,msFlex:o,flex:o}},flexBasis:function(o){return{WebkitFlexBasis:o,flexBasis:o}},justifyContent:function(o){return{WebkitJustifyContent:o,justifyContent:o}},transition:function(o){return{msTransition:o,MozTransition:o,OTransition:o,WebkitTransition:o,transition:o}},transform:function(o){return{msTransform:o,MozTransform:o,OTransform:o,WebkitTransform:o,transform:o}},absolute:function(o){var c=o&&o.split(" ");return{position:"absolute",top:c&&c[0],right:c&&c[1],bottom:c&&c[2],left:c&&c[3]}},extend:function(o,c){var f=c[o];return f||{extend:o}}},a=wv.autoprefix=function(o){var c={};return(0,e.default)(o,function(f,d){var m={};(0,e.default)(f,function(b,x){var E=i[x];E?m=r({},m,E(b)):m[x]=b}),c[d]=m}),c};return wv.default=a,wv}var Sv={},c$;function ETe(){if(c$)return Sv;c$=1,Object.defineProperty(Sv,"__esModule",{value:!0}),Sv.hover=void 0;var t=Object.assign||function(c){for(var f=1;f<arguments.length;f++){var d=arguments[f];for(var m in d)Object.prototype.hasOwnProperty.call(d,m)&&(c[m]=d[m])}return c},e=wx(),r=n(e);function n(c){return c&&c.__esModule?c:{default:c}}function i(c,f){if(!(c instanceof f))throw new TypeError("Cannot call a class as a function")}function a(c,f){if(!c)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return f&&(typeof f=="object"||typeof f=="function")?f:c}function s(c,f){if(typeof f!="function"&&f!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof f);c.prototype=Object.create(f&&f.prototype,{constructor:{value:c,enumerable:!1,writable:!0,configurable:!0}}),f&&(Object.setPrototypeOf?Object.setPrototypeOf(c,f):c.__proto__=f)}var o=Sv.hover=function(f){var d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"span";return(function(m){s(b,m);function b(){var x,E,T,A;i(this,b);for(var M=arguments.length,F=Array(M),N=0;N<M;N++)F[N]=arguments[N];return A=(E=(T=a(this,(x=b.__proto__||Object.getPrototypeOf(b)).call.apply(x,[this].concat(F))),T),T.state={hover:!1},T.handleMouseOver=function(){return T.setState({hover:!0})},T.handleMouseOut=function(){return T.setState({hover:!1})},T.render=function(){return r.default.createElement(d,{onMouseOver:T.handleMouseOver,onMouseOut:T.handleMouseOut},r.default.createElement(f,t({},T.props,T.state)))},E),a(T,A)}return b})(r.default.Component)};return Sv.default=o,Sv}var Ev={},f$;function TTe(){if(f$)return Ev;f$=1,Object.defineProperty(Ev,"__esModule",{value:!0}),Ev.active=void 0;var t=Object.assign||function(c){for(var f=1;f<arguments.length;f++){var d=arguments[f];for(var m in d)Object.prototype.hasOwnProperty.call(d,m)&&(c[m]=d[m])}return c},e=wx(),r=n(e);function n(c){return c&&c.__esModule?c:{default:c}}function i(c,f){if(!(c instanceof f))throw new TypeError("Cannot call a class as a function")}function a(c,f){if(!c)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return f&&(typeof f=="object"||typeof f=="function")?f:c}function s(c,f){if(typeof f!="function"&&f!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof f);c.prototype=Object.create(f&&f.prototype,{constructor:{value:c,enumerable:!1,writable:!0,configurable:!0}}),f&&(Object.setPrototypeOf?Object.setPrototypeOf(c,f):c.__proto__=f)}var o=Ev.active=function(f){var d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"span";return(function(m){s(b,m);function b(){var x,E,T,A;i(this,b);for(var M=arguments.length,F=Array(M),N=0;N<M;N++)F[N]=arguments[N];return A=(E=(T=a(this,(x=b.__proto__||Object.getPrototypeOf(b)).call.apply(x,[this].concat(F))),T),T.state={active:!1},T.handleMouseDown=function(){return T.setState({active:!0})},T.handleMouseUp=function(){return T.setState({active:!1})},T.render=function(){return r.default.createElement(d,{onMouseDown:T.handleMouseDown,onMouseUp:T.handleMouseUp},r.default.createElement(f,t({},T.props,T.state)))},E),a(T,A)}return b})(r.default.Component)};return Ev.default=o,Ev}var Rw={},h$;function CTe(){if(h$)return Rw;h$=1,Object.defineProperty(Rw,"__esModule",{value:!0});var t=function(r,n){var i={},a=function(o){var c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;i[o]=c};return r===0&&a("first-child"),r===n-1&&a("last-child"),(r===0||r%2===0)&&a("even"),Math.abs(r%2)===1&&a("odd"),a("nth-child",r),i};return Rw.default=t,Rw}var d$;function ATe(){if(d$)return Cc;d$=1,Object.defineProperty(Cc,"__esModule",{value:!0}),Cc.ReactCSS=Cc.loop=Cc.handleActive=Cc.handleHover=Cc.hover=void 0;var t=ZEe(),e=b(t),r=wTe(),n=b(r),i=STe(),a=b(i),s=ETe(),o=b(s),c=TTe(),f=b(c),d=CTe(),m=b(d);function b(E){return E&&E.__esModule?E:{default:E}}Cc.hover=o.default,Cc.handleHover=o.default,Cc.handleActive=f.default,Cc.loop=m.default;var x=Cc.ReactCSS=function(T){for(var A=arguments.length,M=Array(A>1?A-1:0),F=1;F<A;F++)M[F-1]=arguments[F];var N=(0,e.default)(M),O=(0,n.default)(T,N);return(0,a.default)(O)};return Cc.default=x,Cc}var kN=ATe();const Li=Id(kN);var ITe=function(e,r,n,i,a){var s=a.clientWidth,o=a.clientHeight,c=typeof e.pageX=="number"?e.pageX:e.touches[0].pageX,f=typeof e.pageY=="number"?e.pageY:e.touches[0].pageY,d=c-(a.getBoundingClientRect().left+window.pageXOffset),m=f-(a.getBoundingClientRect().top+window.pageYOffset);if(n==="vertical"){var b=void 0;if(m<0?b=0:m>o?b=1:b=Math.round(m*100/o)/100,r.a!==b)return{h:r.h,s:r.s,l:r.l,a:b,source:"rgb"}}else{var x=void 0;if(d<0?x=0:d>s?x=1:x=Math.round(d*100/s)/100,i!==x)return{h:r.h,s:r.s,l:r.l,a:x,source:"rgb"}}return null},eP={},PTe=function(e,r,n,i){if(typeof document>"u"&&!i)return null;var a=i?new i:document.createElement("canvas");a.width=n*2,a.height=n*2;var s=a.getContext("2d");return s?(s.fillStyle=e,s.fillRect(0,0,a.width,a.height),s.fillStyle=r,s.fillRect(0,0,n,n),s.translate(n,n),s.fillRect(0,0,n,n),a.toDataURL()):null},kTe=function(e,r,n,i){var a=e+"-"+r+"-"+n+(i?"-server":"");if(eP[a])return eP[a];var s=PTe(e,r,n,i);return eP[a]=s,s},p$=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},x_=function(e){var r=e.white,n=e.grey,i=e.size,a=e.renderers,s=e.borderRadius,o=e.boxShadow,c=e.children,f=Li({default:{grid:{borderRadius:s,boxShadow:o,absolute:"0px 0px 0px 0px",background:"url("+kTe(r,n,i,a.canvas)+") center left"}}});return te.isValidElement(c)?gt.cloneElement(c,p$({},c.props,{style:p$({},c.props.style,f.grid)})):gt.createElement("div",{style:f.grid})};x_.defaultProps={size:8,white:"transparent",grey:"rgba(0,0,0,.08)",renderers:{}};var RTe=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},MTe=(function(){function t(e,r){for(var n=0;n<r.length;n++){var i=r[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}})();function DTe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function g$(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e&&(typeof e=="object"||typeof e=="function")?e:t}function OTe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var RN=(function(t){OTe(e,t);function e(){var r,n,i,a;DTe(this,e);for(var s=arguments.length,o=Array(s),c=0;c<s;c++)o[c]=arguments[c];return a=(n=(i=g$(this,(r=e.__proto__||Object.getPrototypeOf(e)).call.apply(r,[this].concat(o))),i),i.handleChange=function(f){var d=ITe(f,i.props.hsl,i.props.direction,i.props.a,i.container);d&&typeof i.props.onChange=="function"&&i.props.onChange(d,f)},i.handleMouseDown=function(f){i.handleChange(f),window.addEventListener("mousemove",i.handleChange),window.addEventListener("mouseup",i.handleMouseUp)},i.handleMouseUp=function(){i.unbindEventListeners()},i.unbindEventListeners=function(){window.removeEventListener("mousemove",i.handleChange),window.removeEventListener("mouseup",i.handleMouseUp)},n),g$(i,a)}return MTe(e,[{key:"componentWillUnmount",value:function(){this.unbindEventListeners()}},{key:"render",value:function(){var n=this,i=this.props.rgb,a=Li({default:{alpha:{absolute:"0px 0px 0px 0px",borderRadius:this.props.radius},checkboard:{absolute:"0px 0px 0px 0px",overflow:"hidden",borderRadius:this.props.radius},gradient:{absolute:"0px 0px 0px 0px",background:"linear-gradient(to right, rgba("+i.r+","+i.g+","+i.b+`, 0) 0%,
           rgba(`+i.r+","+i.g+","+i.b+", 1) 100%)",boxShadow:this.props.shadow,borderRadius:this.props.radius},container:{position:"relative",height:"100%",margin:"0 3px"},pointer:{position:"absolute",left:i.a*100+"%"},slider:{width:"4px",borderRadius:"1px",height:"8px",boxShadow:"0 0 2px rgba(0, 0, 0, .6)",background:"#fff",marginTop:"1px",transform:"translateX(-2px)"}},vertical:{gradient:{background:"linear-gradient(to bottom, rgba("+i.r+","+i.g+","+i.b+`, 0) 0%,
           rgba(`+i.r+","+i.g+","+i.b+", 1) 100%)"},pointer:{left:0,top:i.a*100+"%"}},overwrite:RTe({},this.props.style)},{vertical:this.props.direction==="vertical",overwrite:!0});return gt.createElement("div",{style:a.alpha},gt.createElement("div",{style:a.checkboard},gt.createElement(x_,{renderers:this.props.renderers})),gt.createElement("div",{style:a.gradient}),gt.createElement("div",{style:a.container,ref:function(o){return n.container=o},onMouseDown:this.handleMouseDown,onTouchMove:this.handleChange,onTouchStart:this.handleChange},gt.createElement("div",{style:a.pointer},this.props.pointer?gt.createElement(this.props.pointer,this.props):gt.createElement("div",{style:a.slider}))))}}]),e})(te.PureComponent||te.Component),NTe=(function(){function t(e,r){for(var n=0;n<r.length;n++){var i=r[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}})();function LTe(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function FTe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function BTe(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e&&(typeof e=="object"||typeof e=="function")?e:t}function zTe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var jTe=1,aQ=38,UTe=40,VTe=[aQ,UTe],$Te=function(e){return VTe.indexOf(e)>-1},qTe=function(e){return Number(String(e).replace(/%/g,""))},HTe=1,ya=(function(t){zTe(e,t);function e(r){FTe(this,e);var n=BTe(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return n.handleBlur=function(){n.state.blurValue&&n.setState({value:n.state.blurValue,blurValue:null})},n.handleChange=function(i){n.setUpdatedValue(i.target.value,i)},n.handleKeyDown=function(i){var a=qTe(i.target.value);if(!isNaN(a)&&$Te(i.keyCode)){var s=n.getArrowOffset(),o=i.keyCode===aQ?a+s:a-s;n.setUpdatedValue(o,i)}},n.handleDrag=function(i){if(n.props.dragLabel){var a=Math.round(n.props.value+i.movementX);a>=0&&a<=n.props.dragMax&&n.props.onChange&&n.props.onChange(n.getValueObjectWithLabel(a),i)}},n.handleMouseDown=function(i){n.props.dragLabel&&(i.preventDefault(),n.handleDrag(i),window.addEventListener("mousemove",n.handleDrag),window.addEventListener("mouseup",n.handleMouseUp))},n.handleMouseUp=function(){n.unbindEventListeners()},n.unbindEventListeners=function(){window.removeEventListener("mousemove",n.handleDrag),window.removeEventListener("mouseup",n.handleMouseUp)},n.state={value:String(r.value).toUpperCase(),blurValue:String(r.value).toUpperCase()},n.inputId="rc-editable-input-"+HTe++,n}return NTe(e,[{key:"componentDidUpdate",value:function(n,i){this.props.value!==this.state.value&&(n.value!==this.props.value||i.value!==this.state.value)&&(this.input===document.activeElement?this.setState({blurValue:String(this.props.value).toUpperCase()}):this.setState({value:String(this.props.value).toUpperCase(),blurValue:!this.state.blurValue&&String(this.props.value).toUpperCase()}))}},{key:"componentWillUnmount",value:function(){this.unbindEventListeners()}},{key:"getValueObjectWithLabel",value:function(n){return LTe({},this.props.label,n)}},{key:"getArrowOffset",value:function(){return this.props.arrowOffset||jTe}},{key:"setUpdatedValue",value:function(n,i){var a=this.props.label?this.getValueObjectWithLabel(n):n;this.props.onChange&&this.props.onChange(a,i),this.setState({value:n})}},{key:"render",value:function(){var n=this,i=Li({default:{wrap:{position:"relative"}},"user-override":{wrap:this.props.style&&this.props.style.wrap?this.props.style.wrap:{},input:this.props.style&&this.props.style.input?this.props.style.input:{},label:this.props.style&&this.props.style.label?this.props.style.label:{}},"dragLabel-true":{label:{cursor:"ew-resize"}}},{"user-override":!0},this.props);return gt.createElement("div",{style:i.wrap},gt.createElement("input",{id:this.inputId,style:i.input,ref:function(s){return n.input=s},value:this.state.value,onKeyDown:this.handleKeyDown,onChange:this.handleChange,onBlur:this.handleBlur,placeholder:this.props.placeholder,spellCheck:"false"}),this.props.label&&!this.props.hideLabel?gt.createElement("label",{htmlFor:this.inputId,style:i.label,onMouseDown:this.handleMouseDown},this.props.label):null)}}]),e})(te.PureComponent||te.Component),GTe=function(e,r,n,i){var a=i.clientWidth,s=i.clientHeight,o=typeof e.pageX=="number"?e.pageX:e.touches[0].pageX,c=typeof e.pageY=="number"?e.pageY:e.touches[0].pageY,f=o-(i.getBoundingClientRect().left+window.pageXOffset),d=c-(i.getBoundingClientRect().top+window.pageYOffset);if(r==="vertical"){var m=void 0;if(d<0)m=359;else if(d>s)m=0;else{var b=-(d*100/s)+100;m=360*b/100}if(n.h!==m)return{h:m,s:n.s,l:n.l,a:n.a,source:"hsl"}}else{var x=void 0;if(f<0)x=0;else if(f>a)x=359;else{var E=f*100/a;x=360*E/100}if(n.h!==x)return{h:x,s:n.s,l:n.l,a:n.a,source:"hsl"}}return null},WTe=(function(){function t(e,r){for(var n=0;n<r.length;n++){var i=r[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}})();function XTe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function m$(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e&&(typeof e=="object"||typeof e=="function")?e:t}function YTe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var w_=(function(t){YTe(e,t);function e(){var r,n,i,a;XTe(this,e);for(var s=arguments.length,o=Array(s),c=0;c<s;c++)o[c]=arguments[c];return a=(n=(i=m$(this,(r=e.__proto__||Object.getPrototypeOf(e)).call.apply(r,[this].concat(o))),i),i.handleChange=function(f){var d=GTe(f,i.props.direction,i.props.hsl,i.container);d&&typeof i.props.onChange=="function"&&i.props.onChange(d,f)},i.handleMouseDown=function(f){i.handleChange(f),window.addEventListener("mousemove",i.handleChange),window.addEventListener("mouseup",i.handleMouseUp)},i.handleMouseUp=function(){i.unbindEventListeners()},n),m$(i,a)}return WTe(e,[{key:"componentWillUnmount",value:function(){this.unbindEventListeners()}},{key:"unbindEventListeners",value:function(){window.removeEventListener("mousemove",this.handleChange),window.removeEventListener("mouseup",this.handleMouseUp)}},{key:"render",value:function(){var n=this,i=this.props.direction,a=i===void 0?"horizontal":i,s=Li({default:{hue:{absolute:"0px 0px 0px 0px",borderRadius:this.props.radius,boxShadow:this.props.shadow},container:{padding:"0 2px",position:"relative",height:"100%",borderRadius:this.props.radius},pointer:{position:"absolute",left:this.props.hsl.h*100/360+"%"},slider:{marginTop:"1px",width:"4px",borderRadius:"1px",height:"8px",boxShadow:"0 0 2px rgba(0, 0, 0, .6)",background:"#fff",transform:"translateX(-2px)"}},vertical:{pointer:{left:"0px",top:-(this.props.hsl.h*100/360)+100+"%"}}},{vertical:a==="vertical"});return gt.createElement("div",{style:s.hue},gt.createElement("div",{className:"hue-"+a,style:s.container,ref:function(c){return n.container=c},onMouseDown:this.handleMouseDown,onTouchMove:this.handleChange,onTouchStart:this.handleChange},gt.createElement("style",null,`
            .hue-horizontal {
              background: linear-gradient(to right, #f00 0%, #ff0 17%, #0f0
                33%, #0ff 50%, #00f 67%, #f0f 83%, #f00 100%);
              background: -webkit-linear-gradient(to right, #f00 0%, #ff0
                17%, #0f0 33%, #0ff 50%, #00f 67%, #f0f 83%, #f00 100%);
            }

            .hue-vertical {
              background: linear-gradient(to top, #f00 0%, #ff0 17%, #0f0 33%,
                #0ff 50%, #00f 67%, #f0f 83%, #f00 100%);
              background: -webkit-linear-gradient(to top, #f00 0%, #ff0 17%,
                #0f0 33%, #0ff 50%, #00f 67%, #f0f 83%, #f00 100%);
            }
          `),gt.createElement("div",{style:s.pointer},this.props.pointer?gt.createElement(this.props.pointer,this.props):gt.createElement("div",{style:s.slider}))))}}]),e})(te.PureComponent||te.Component);function ZTe(){this.__data__=[],this.size=0}function Xx(t,e){return t===e||t!==t&&e!==e}function E3(t,e){for(var r=t.length;r--;)if(Xx(t[r][0],e))return r;return-1}var KTe=Array.prototype,JTe=KTe.splice;function QTe(t){var e=this.__data__,r=E3(e,t);if(r<0)return!1;var n=e.length-1;return r==n?e.pop():JTe.call(e,r,1),--this.size,!0}function e3e(t){var e=this.__data__,r=E3(e,t);return r<0?void 0:e[r][1]}function t3e(t){return E3(this.__data__,t)>-1}function r3e(t,e){var r=this.__data__,n=E3(r,t);return n<0?(++this.size,r.push([t,e])):r[n][1]=e,this}function Mp(t){var e=-1,r=t==null?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}Mp.prototype.clear=ZTe;Mp.prototype.delete=QTe;Mp.prototype.get=e3e;Mp.prototype.has=t3e;Mp.prototype.set=r3e;function n3e(){this.__data__=new Mp,this.size=0}function i3e(t){var e=this.__data__,r=e.delete(t);return this.size=e.size,r}function a3e(t){return this.__data__.get(t)}function o3e(t){return this.__data__.has(t)}var oQ=typeof global=="object"&&global&&global.Object===Object&&global,s3e=typeof self=="object"&&self&&self.Object===Object&&self,Lh=oQ||s3e||Function("return this")(),kg=Lh.Symbol,sQ=Object.prototype,l3e=sQ.hasOwnProperty,u3e=sQ.toString,c1=kg?kg.toStringTag:void 0;function c3e(t){var e=l3e.call(t,c1),r=t[c1];try{t[c1]=void 0;var n=!0}catch{}var i=u3e.call(t);return n&&(e?t[c1]=r:delete t[c1]),i}var f3e=Object.prototype,h3e=f3e.toString;function d3e(t){return h3e.call(t)}var p3e="[object Null]",g3e="[object Undefined]",y$=kg?kg.toStringTag:void 0;function Iy(t){return t==null?t===void 0?g3e:p3e:y$&&y$ in Object(t)?c3e(t):d3e(t)}function Zf(t){var e=typeof t;return t!=null&&(e=="object"||e=="function")}var m3e="[object AsyncFunction]",y3e="[object Function]",v3e="[object GeneratorFunction]",_3e="[object Proxy]";function MN(t){if(!Zf(t))return!1;var e=Iy(t);return e==y3e||e==v3e||e==m3e||e==_3e}var tP=Lh["__core-js_shared__"],v$=(function(){var t=/[^.]+$/.exec(tP&&tP.keys&&tP.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""})();function b3e(t){return!!v$&&v$ in t}var x3e=Function.prototype,w3e=x3e.toString;function Py(t){if(t!=null){try{return w3e.call(t)}catch{}try{return t+""}catch{}}return""}var S3e=/[\\^$.*+?()[\]{}|]/g,E3e=/^\[object .+?Constructor\]$/,T3e=Function.prototype,C3e=Object.prototype,A3e=T3e.toString,I3e=C3e.hasOwnProperty,P3e=RegExp("^"+A3e.call(I3e).replace(S3e,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function k3e(t){if(!Zf(t)||b3e(t))return!1;var e=MN(t)?P3e:E3e;return e.test(Py(t))}function R3e(t,e){return t?.[e]}function ky(t,e){var r=R3e(t,e);return k3e(r)?r:void 0}var ex=ky(Lh,"Map"),tx=ky(Object,"create");function M3e(){this.__data__=tx?tx(null):{},this.size=0}function D3e(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e}var O3e="__lodash_hash_undefined__",N3e=Object.prototype,L3e=N3e.hasOwnProperty;function F3e(t){var e=this.__data__;if(tx){var r=e[t];return r===O3e?void 0:r}return L3e.call(e,t)?e[t]:void 0}var B3e=Object.prototype,z3e=B3e.hasOwnProperty;function j3e(t){var e=this.__data__;return tx?e[t]!==void 0:z3e.call(e,t)}var U3e="__lodash_hash_undefined__";function V3e(t,e){var r=this.__data__;return this.size+=this.has(t)?0:1,r[t]=tx&&e===void 0?U3e:e,this}function ay(t){var e=-1,r=t==null?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}ay.prototype.clear=M3e;ay.prototype.delete=D3e;ay.prototype.get=F3e;ay.prototype.has=j3e;ay.prototype.set=V3e;function $3e(){this.size=0,this.__data__={hash:new ay,map:new(ex||Mp),string:new ay}}function q3e(t){var e=typeof t;return e=="string"||e=="number"||e=="symbol"||e=="boolean"?t!=="__proto__":t===null}function T3(t,e){var r=t.__data__;return q3e(e)?r[typeof e=="string"?"string":"hash"]:r.map}function H3e(t){var e=T3(this,t).delete(t);return this.size-=e?1:0,e}function G3e(t){return T3(this,t).get(t)}function W3e(t){return T3(this,t).has(t)}function X3e(t,e){var r=T3(this,t),n=r.size;return r.set(t,e),this.size+=r.size==n?0:1,this}function Dp(t){var e=-1,r=t==null?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}Dp.prototype.clear=$3e;Dp.prototype.delete=H3e;Dp.prototype.get=G3e;Dp.prototype.has=W3e;Dp.prototype.set=X3e;var Y3e=200;function Z3e(t,e){var r=this.__data__;if(r instanceof Mp){var n=r.__data__;if(!ex||n.length<Y3e-1)return n.push([t,e]),this.size=++r.size,this;r=this.__data__=new Dp(n)}return r.set(t,e),this.size=r.size,this}function xd(t){var e=this.__data__=new Mp(t);this.size=e.size}xd.prototype.clear=n3e;xd.prototype.delete=i3e;xd.prototype.get=a3e;xd.prototype.has=o3e;xd.prototype.set=Z3e;var wE=(function(){try{var t=ky(Object,"defineProperty");return t({},"",{}),t}catch{}})();function DN(t,e,r){e=="__proto__"&&wE?wE(t,e,{configurable:!0,enumerable:!0,value:r,writable:!0}):t[e]=r}function HR(t,e,r){(r!==void 0&&!Xx(t[e],r)||r===void 0&&!(e in t))&&DN(t,e,r)}function K3e(t){return function(e,r,n){for(var i=-1,a=Object(e),s=n(e),o=s.length;o--;){var c=s[++i];if(r(a[c],c,a)===!1)break}return e}}var lQ=K3e(),uQ=typeof exports=="object"&&exports&&!exports.nodeType&&exports,_$=uQ&&typeof module=="object"&&module&&!module.nodeType&&module,J3e=_$&&_$.exports===uQ,b$=J3e?Lh.Buffer:void 0;b$&&b$.allocUnsafe;function Q3e(t,e){return t.slice()}var SE=Lh.Uint8Array;function eCe(t){var e=new t.constructor(t.byteLength);return new SE(e).set(new SE(t)),e}function tCe(t,e){var r=eCe(t.buffer);return new t.constructor(r,t.byteOffset,t.length)}function rCe(t,e){var r=-1,n=t.length;for(e||(e=Array(n));++r<n;)e[r]=t[r];return e}var x$=Object.create,nCe=(function(){function t(){}return function(e){if(!Zf(e))return{};if(x$)return x$(e);t.prototype=e;var r=new t;return t.prototype=void 0,r}})();function cQ(t,e){return function(r){return t(e(r))}}var fQ=cQ(Object.getPrototypeOf,Object),iCe=Object.prototype;function ON(t){var e=t&&t.constructor,r=typeof e=="function"&&e.prototype||iCe;return t===r}function aCe(t){return typeof t.constructor=="function"&&!ON(t)?nCe(fQ(t)):{}}function Rg(t){return t!=null&&typeof t=="object"}var oCe="[object Arguments]";function w$(t){return Rg(t)&&Iy(t)==oCe}var hQ=Object.prototype,sCe=hQ.hasOwnProperty,lCe=hQ.propertyIsEnumerable,EE=w$((function(){return arguments})())?w$:function(t){return Rg(t)&&sCe.call(t,"callee")&&!lCe.call(t,"callee")},yf=Array.isArray,uCe=9007199254740991;function NN(t){return typeof t=="number"&&t>-1&&t%1==0&&t<=uCe}function S_(t){return t!=null&&NN(t.length)&&!MN(t)}function cCe(t){return Rg(t)&&S_(t)}function fCe(){return!1}var dQ=typeof exports=="object"&&exports&&!exports.nodeType&&exports,S$=dQ&&typeof module=="object"&&module&&!module.nodeType&&module,hCe=S$&&S$.exports===dQ,E$=hCe?Lh.Buffer:void 0,dCe=E$?E$.isBuffer:void 0,TE=dCe||fCe,pCe="[object Object]",gCe=Function.prototype,mCe=Object.prototype,pQ=gCe.toString,yCe=mCe.hasOwnProperty,vCe=pQ.call(Object);function _Ce(t){if(!Rg(t)||Iy(t)!=pCe)return!1;var e=fQ(t);if(e===null)return!0;var r=yCe.call(e,"constructor")&&e.constructor;return typeof r=="function"&&r instanceof r&&pQ.call(r)==vCe}var bCe="[object Arguments]",xCe="[object Array]",wCe="[object Boolean]",SCe="[object Date]",ECe="[object Error]",TCe="[object Function]",CCe="[object Map]",ACe="[object Number]",ICe="[object Object]",PCe="[object RegExp]",kCe="[object Set]",RCe="[object String]",MCe="[object WeakMap]",DCe="[object ArrayBuffer]",OCe="[object DataView]",NCe="[object Float32Array]",LCe="[object Float64Array]",FCe="[object Int8Array]",BCe="[object Int16Array]",zCe="[object Int32Array]",jCe="[object Uint8Array]",UCe="[object Uint8ClampedArray]",VCe="[object Uint16Array]",$Ce="[object Uint32Array]",Ko={};Ko[NCe]=Ko[LCe]=Ko[FCe]=Ko[BCe]=Ko[zCe]=Ko[jCe]=Ko[UCe]=Ko[VCe]=Ko[$Ce]=!0;Ko[bCe]=Ko[xCe]=Ko[DCe]=Ko[wCe]=Ko[OCe]=Ko[SCe]=Ko[ECe]=Ko[TCe]=Ko[CCe]=Ko[ACe]=Ko[ICe]=Ko[PCe]=Ko[kCe]=Ko[RCe]=Ko[MCe]=!1;function qCe(t){return Rg(t)&&NN(t.length)&&!!Ko[Iy(t)]}function HCe(t){return function(e){return t(e)}}var gQ=typeof exports=="object"&&exports&&!exports.nodeType&&exports,_b=gQ&&typeof module=="object"&&module&&!module.nodeType&&module,GCe=_b&&_b.exports===gQ,rP=GCe&&oQ.process,T$=(function(){try{var t=_b&&_b.require&&_b.require("util").types;return t||rP&&rP.binding&&rP.binding("util")}catch{}})(),C$=T$&&T$.isTypedArray,LN=C$?HCe(C$):qCe;function GR(t,e){if(!(e==="constructor"&&typeof t[e]=="function")&&e!="__proto__")return t[e]}var WCe=Object.prototype,XCe=WCe.hasOwnProperty;function YCe(t,e,r){var n=t[e];(!(XCe.call(t,e)&&Xx(n,r))||r===void 0&&!(e in t))&&DN(t,e,r)}function ZCe(t,e,r,n){var i=!r;r||(r={});for(var a=-1,s=e.length;++a<s;){var o=e[a],c=void 0;c===void 0&&(c=t[o]),i?DN(r,o,c):YCe(r,o,c)}return r}function KCe(t,e){for(var r=-1,n=Array(t);++r<t;)n[r]=e(r);return n}var JCe=9007199254740991,QCe=/^(?:0|[1-9]\d*)$/;function FN(t,e){var r=typeof t;return e=e??JCe,!!e&&(r=="number"||r!="symbol"&&QCe.test(t))&&t>-1&&t%1==0&&t<e}var eAe=Object.prototype,tAe=eAe.hasOwnProperty;function mQ(t,e){var r=yf(t),n=!r&&EE(t),i=!r&&!n&&TE(t),a=!r&&!n&&!i&&LN(t),s=r||n||i||a,o=s?KCe(t.length,String):[],c=o.length;for(var f in t)(e||tAe.call(t,f))&&!(s&&(f=="length"||i&&(f=="offset"||f=="parent")||a&&(f=="buffer"||f=="byteLength"||f=="byteOffset")||FN(f,c)))&&o.push(f);return o}function rAe(t){var e=[];if(t!=null)for(var r in Object(t))e.push(r);return e}var nAe=Object.prototype,iAe=nAe.hasOwnProperty;function aAe(t){if(!Zf(t))return rAe(t);var e=ON(t),r=[];for(var n in t)n=="constructor"&&(e||!iAe.call(t,n))||r.push(n);return r}function yQ(t){return S_(t)?mQ(t,!0):aAe(t)}function oAe(t){return ZCe(t,yQ(t))}function sAe(t,e,r,n,i,a,s){var o=GR(t,r),c=GR(e,r),f=s.get(c);if(f){HR(t,r,f);return}var d=a?a(o,c,r+"",t,e,s):void 0,m=d===void 0;if(m){var b=yf(c),x=!b&&TE(c),E=!b&&!x&&LN(c);d=c,b||x||E?yf(o)?d=o:cCe(o)?d=rCe(o):x?(m=!1,d=Q3e(c)):E?(m=!1,d=tCe(c)):d=[]:_Ce(c)||EE(c)?(d=o,EE(o)?d=oAe(o):(!Zf(o)||MN(o))&&(d=aCe(c))):m=!1}m&&(s.set(c,d),i(d,c,n,a,s),s.delete(c)),HR(t,r,d)}function vQ(t,e,r,n,i){t!==e&&lQ(e,function(a,s){if(i||(i=new xd),Zf(a))sAe(t,e,s,r,vQ,n,i);else{var o=n?n(GR(t,s),a,s+"",t,e,i):void 0;o===void 0&&(o=a),HR(t,s,o)}},yQ)}function C3(t){return t}function lAe(t,e,r){switch(r.length){case 0:return t.call(e);case 1:return t.call(e,r[0]);case 2:return t.call(e,r[0],r[1]);case 3:return t.call(e,r[0],r[1],r[2])}return t.apply(e,r)}var A$=Math.max;function uAe(t,e,r){return e=A$(e===void 0?t.length-1:e,0),function(){for(var n=arguments,i=-1,a=A$(n.length-e,0),s=Array(a);++i<a;)s[i]=n[e+i];i=-1;for(var o=Array(e+1);++i<e;)o[i]=n[i];return o[e]=r(s),lAe(t,this,o)}}function cAe(t){return function(){return t}}var fAe=wE?function(t,e){return wE(t,"toString",{configurable:!0,enumerable:!1,value:cAe(e),writable:!0})}:C3,hAe=800,dAe=16,pAe=Date.now;function gAe(t){var e=0,r=0;return function(){var n=pAe(),i=dAe-(n-r);if(r=n,i>0){if(++e>=hAe)return arguments[0]}else e=0;return t.apply(void 0,arguments)}}var mAe=gAe(fAe);function yAe(t,e){return mAe(uAe(t,e,C3),t+"")}function vAe(t,e,r){if(!Zf(r))return!1;var n=typeof e;return(n=="number"?S_(r)&&FN(e,r.length):n=="string"&&e in r)?Xx(r[e],t):!1}function _Ae(t){return yAe(function(e,r){var n=-1,i=r.length,a=i>1?r[i-1]:void 0,s=i>2?r[2]:void 0;for(a=t.length>3&&typeof a=="function"?(i--,a):void 0,s&&vAe(r[0],r[1],s)&&(a=i<3?void 0:a,i=1),e=Object(e);++n<i;){var o=r[n];o&&t(e,o,n,a)}return e})}var jc=_Ae(function(t,e,r){vQ(t,e,r)}),Yx=function(e){var r=e.zDepth,n=e.radius,i=e.background,a=e.children,s=e.styles,o=s===void 0?{}:s,c=Li(jc({default:{wrap:{position:"relative",display:"inline-block"},content:{position:"relative"},bg:{absolute:"0px 0px 0px 0px",boxShadow:"0 "+r+"px "+r*4+"px rgba(0,0,0,.24)",borderRadius:n,background:i}},"zDepth-0":{bg:{boxShadow:"none"}},"zDepth-1":{bg:{boxShadow:"0 2px 10px rgba(0,0,0,.12), 0 2px 5px rgba(0,0,0,.16)"}},"zDepth-2":{bg:{boxShadow:"0 6px 20px rgba(0,0,0,.19), 0 8px 17px rgba(0,0,0,.2)"}},"zDepth-3":{bg:{boxShadow:"0 17px 50px rgba(0,0,0,.19), 0 12px 15px rgba(0,0,0,.24)"}},"zDepth-4":{bg:{boxShadow:"0 25px 55px rgba(0,0,0,.21), 0 16px 28px rgba(0,0,0,.22)"}},"zDepth-5":{bg:{boxShadow:"0 40px 77px rgba(0,0,0,.22), 0 27px 24px rgba(0,0,0,.2)"}},square:{bg:{borderRadius:"0"}},circle:{bg:{borderRadius:"50%"}}},o),{"zDepth-1":r===1});return gt.createElement("div",{style:c.wrap},gt.createElement("div",{style:c.bg}),gt.createElement("div",{style:c.content},a))};Yx.propTypes={background:Rn.string,zDepth:Rn.oneOf([0,1,2,3,4,5]),radius:Rn.number,styles:Rn.object};Yx.defaultProps={background:"#fff",zDepth:1,radius:2,styles:{}};var nP=function(){return Lh.Date.now()},bAe=/\s/;function xAe(t){for(var e=t.length;e--&&bAe.test(t.charAt(e)););return e}var wAe=/^\s+/;function SAe(t){return t&&t.slice(0,xAe(t)+1).replace(wAe,"")}var EAe="[object Symbol]";function A3(t){return typeof t=="symbol"||Rg(t)&&Iy(t)==EAe}var I$=NaN,TAe=/^[-+]0x[0-9a-f]+$/i,CAe=/^0b[01]+$/i,AAe=/^0o[0-7]+$/i,IAe=parseInt;function P$(t){if(typeof t=="number")return t;if(A3(t))return I$;if(Zf(t)){var e=typeof t.valueOf=="function"?t.valueOf():t;t=Zf(e)?e+"":e}if(typeof t!="string")return t===0?t:+t;t=SAe(t);var r=CAe.test(t);return r||AAe.test(t)?IAe(t.slice(2),r?2:8):TAe.test(t)?I$:+t}var PAe="Expected a function",kAe=Math.max,RAe=Math.min;function _Q(t,e,r){var n,i,a,s,o,c,f=0,d=!1,m=!1,b=!0;if(typeof t!="function")throw new TypeError(PAe);e=P$(e)||0,Zf(r)&&(d=!!r.leading,m="maxWait"in r,a=m?kAe(P$(r.maxWait)||0,e):a,b="trailing"in r?!!r.trailing:b);function x(j){var H=n,W=i;return n=i=void 0,f=j,s=t.apply(W,H),s}function E(j){return f=j,o=setTimeout(M,e),d?x(j):s}function T(j){var H=j-c,W=j-f,X=e-H;return m?RAe(X,a-W):X}function A(j){var H=j-c,W=j-f;return c===void 0||H>=e||H<0||m&&W>=a}function M(){var j=nP();if(A(j))return F(j);o=setTimeout(M,T(j))}function F(j){return o=void 0,b&&n?x(j):(n=i=void 0,s)}function N(){o!==void 0&&clearTimeout(o),f=0,n=c=i=o=void 0}function O(){return o===void 0?s:F(nP())}function U(){var j=nP(),H=A(j);if(n=arguments,i=this,c=j,H){if(o===void 0)return E(c);if(m)return clearTimeout(o),o=setTimeout(M,e),x(c)}return o===void 0&&(o=setTimeout(M,e)),s}return U.cancel=N,U.flush=O,U}var MAe="Expected a function";function DAe(t,e,r){var n=!0,i=!0;if(typeof t!="function")throw new TypeError(MAe);return Zf(r)&&(n="leading"in r?!!r.leading:n,i="trailing"in r?!!r.trailing:i),_Q(t,e,{leading:n,maxWait:e,trailing:i})}var OAe=function(e,r,n){var i=n.getBoundingClientRect(),a=i.width,s=i.height,o=typeof e.pageX=="number"?e.pageX:e.touches[0].pageX,c=typeof e.pageY=="number"?e.pageY:e.touches[0].pageY,f=o-(n.getBoundingClientRect().left+window.pageXOffset),d=c-(n.getBoundingClientRect().top+window.pageYOffset);f<0?f=0:f>a&&(f=a),d<0?d=0:d>s&&(d=s);var m=f/a,b=1-d/s;return{h:r.h,s:m,v:b,a:r.a,source:"hsv"}},NAe=(function(){function t(e,r){for(var n=0;n<r.length;n++){var i=r[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}})();function LAe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function FAe(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e&&(typeof e=="object"||typeof e=="function")?e:t}function BAe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var I3=(function(t){BAe(e,t);function e(r){LAe(this,e);var n=FAe(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,r));return n.handleChange=function(i){typeof n.props.onChange=="function"&&n.throttle(n.props.onChange,OAe(i,n.props.hsl,n.container),i)},n.handleMouseDown=function(i){n.handleChange(i);var a=n.getContainerRenderWindow();a.addEventListener("mousemove",n.handleChange),a.addEventListener("mouseup",n.handleMouseUp)},n.handleMouseUp=function(){n.unbindEventListeners()},n.throttle=DAe(function(i,a,s){i(a,s)},50),n}return NAe(e,[{key:"componentWillUnmount",value:function(){this.throttle.cancel(),this.unbindEventListeners()}},{key:"getContainerRenderWindow",value:function(){for(var n=this.container,i=window;!i.document.contains(n)&&i.parent!==i;)i=i.parent;return i}},{key:"unbindEventListeners",value:function(){var n=this.getContainerRenderWindow();n.removeEventListener("mousemove",this.handleChange),n.removeEventListener("mouseup",this.handleMouseUp)}},{key:"render",value:function(){var n=this,i=this.props.style||{},a=i.color,s=i.white,o=i.black,c=i.pointer,f=i.circle,d=Li({default:{color:{absolute:"0px 0px 0px 0px",background:"hsl("+this.props.hsl.h+",100%, 50%)",borderRadius:this.props.radius},white:{absolute:"0px 0px 0px 0px",borderRadius:this.props.radius},black:{absolute:"0px 0px 0px 0px",boxShadow:this.props.shadow,borderRadius:this.props.radius},pointer:{position:"absolute",top:-(this.props.hsv.v*100)+100+"%",left:this.props.hsv.s*100+"%",cursor:"default"},circle:{width:"4px",height:"4px",boxShadow:`0 0 0 1.5px #fff, inset 0 0 1px 1px rgba(0,0,0,.3),
            0 0 1px 2px rgba(0,0,0,.4)`,borderRadius:"50%",cursor:"hand",transform:"translate(-2px, -2px)"}},custom:{color:a,white:s,black:o,pointer:c,circle:f}},{custom:!!this.props.style});return gt.createElement("div",{style:d.color,ref:function(b){return n.container=b},onMouseDown:this.handleMouseDown,onTouchMove:this.handleChange,onTouchStart:this.handleChange},gt.createElement("style",null,`
          .saturation-white {
            background: -webkit-linear-gradient(to right, #fff, rgba(255,255,255,0));
            background: linear-gradient(to right, #fff, rgba(255,255,255,0));
          }
          .saturation-black {
            background: -webkit-linear-gradient(to top, #000, rgba(0,0,0,0));
            background: linear-gradient(to top, #000, rgba(0,0,0,0));
          }
        `),gt.createElement("div",{style:d.white,className:"saturation-white"},gt.createElement("div",{style:d.black,className:"saturation-black"}),gt.createElement("div",{style:d.pointer},this.props.pointer?gt.createElement(this.props.pointer,this.props):gt.createElement("div",{style:d.circle}))))}}]),e})(te.PureComponent||te.Component);function zAe(t,e){for(var r=-1,n=t==null?0:t.length;++r<n&&e(t[r],r,t)!==!1;);return t}var jAe=cQ(Object.keys,Object),UAe=Object.prototype,VAe=UAe.hasOwnProperty;function $Ae(t){if(!ON(t))return jAe(t);var e=[];for(var r in Object(t))VAe.call(t,r)&&r!="constructor"&&e.push(r);return e}function BN(t){return S_(t)?mQ(t):$Ae(t)}function qAe(t,e){return t&&lQ(t,e,BN)}function HAe(t,e){return function(r,n){if(r==null)return r;if(!S_(r))return t(r,n);for(var i=r.length,a=-1,s=Object(r);++a<i&&n(s[a],a,s)!==!1;);return r}}var bQ=HAe(qAe);function GAe(t){return typeof t=="function"?t:C3}function WAe(t,e){var r=yf(t)?zAe:bQ;return r(t,GAe(e))}function CE(t){"@babel/helpers - typeof";return CE=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},CE(t)}var XAe=/^\s+/,YAe=/\s+$/;function li(t,e){if(t=t||"",e=e||{},t instanceof li)return t;if(!(this instanceof li))return new li(t,e);var r=ZAe(t);this._originalInput=t,this._r=r.r,this._g=r.g,this._b=r.b,this._a=r.a,this._roundA=Math.round(100*this._a)/100,this._format=e.format||r.format,this._gradientType=e.gradientType,this._r<1&&(this._r=Math.round(this._r)),this._g<1&&(this._g=Math.round(this._g)),this._b<1&&(this._b=Math.round(this._b)),this._ok=r.ok}li.prototype={isDark:function(){return this.getBrightness()<128},isLight:function(){return!this.isDark()},isValid:function(){return this._ok},getOriginalInput:function(){return this._originalInput},getFormat:function(){return this._format},getAlpha:function(){return this._a},getBrightness:function(){var e=this.toRgb();return(e.r*299+e.g*587+e.b*114)/1e3},getLuminance:function(){var e=this.toRgb(),r,n,i,a,s,o;return r=e.r/255,n=e.g/255,i=e.b/255,r<=.03928?a=r/12.92:a=Math.pow((r+.055)/1.055,2.4),n<=.03928?s=n/12.92:s=Math.pow((n+.055)/1.055,2.4),i<=.03928?o=i/12.92:o=Math.pow((i+.055)/1.055,2.4),.2126*a+.7152*s+.0722*o},setAlpha:function(e){return this._a=xQ(e),this._roundA=Math.round(100*this._a)/100,this},toHsv:function(){var e=R$(this._r,this._g,this._b);return{h:e.h*360,s:e.s,v:e.v,a:this._a}},toHsvString:function(){var e=R$(this._r,this._g,this._b),r=Math.round(e.h*360),n=Math.round(e.s*100),i=Math.round(e.v*100);return this._a==1?"hsv("+r+", "+n+"%, "+i+"%)":"hsva("+r+", "+n+"%, "+i+"%, "+this._roundA+")"},toHsl:function(){var e=k$(this._r,this._g,this._b);return{h:e.h*360,s:e.s,l:e.l,a:this._a}},toHslString:function(){var e=k$(this._r,this._g,this._b),r=Math.round(e.h*360),n=Math.round(e.s*100),i=Math.round(e.l*100);return this._a==1?"hsl("+r+", "+n+"%, "+i+"%)":"hsla("+r+", "+n+"%, "+i+"%, "+this._roundA+")"},toHex:function(e){return M$(this._r,this._g,this._b,e)},toHexString:function(e){return"#"+this.toHex(e)},toHex8:function(e){return e5e(this._r,this._g,this._b,this._a,e)},toHex8String:function(e){return"#"+this.toHex8(e)},toRgb:function(){return{r:Math.round(this._r),g:Math.round(this._g),b:Math.round(this._b),a:this._a}},toRgbString:function(){return this._a==1?"rgb("+Math.round(this._r)+", "+Math.round(this._g)+", "+Math.round(this._b)+")":"rgba("+Math.round(this._r)+", "+Math.round(this._g)+", "+Math.round(this._b)+", "+this._roundA+")"},toPercentageRgb:function(){return{r:Math.round(us(this._r,255)*100)+"%",g:Math.round(us(this._g,255)*100)+"%",b:Math.round(us(this._b,255)*100)+"%",a:this._a}},toPercentageRgbString:function(){return this._a==1?"rgb("+Math.round(us(this._r,255)*100)+"%, "+Math.round(us(this._g,255)*100)+"%, "+Math.round(us(this._b,255)*100)+"%)":"rgba("+Math.round(us(this._r,255)*100)+"%, "+Math.round(us(this._g,255)*100)+"%, "+Math.round(us(this._b,255)*100)+"%, "+this._roundA+")"},toName:function(){return this._a===0?"transparent":this._a<1?!1:h5e[M$(this._r,this._g,this._b,!0)]||!1},toFilter:function(e){var r="#"+D$(this._r,this._g,this._b,this._a),n=r,i=this._gradientType?"GradientType = 1, ":"";if(e){var a=li(e);n="#"+D$(a._r,a._g,a._b,a._a)}return"progid:DXImageTransform.Microsoft.gradient("+i+"startColorstr="+r+",endColorstr="+n+")"},toString:function(e){var r=!!e;e=e||this._format;var n=!1,i=this._a<1&&this._a>=0,a=!r&&i&&(e==="hex"||e==="hex6"||e==="hex3"||e==="hex4"||e==="hex8"||e==="name");return a?e==="name"&&this._a===0?this.toName():this.toRgbString():(e==="rgb"&&(n=this.toRgbString()),e==="prgb"&&(n=this.toPercentageRgbString()),(e==="hex"||e==="hex6")&&(n=this.toHexString()),e==="hex3"&&(n=this.toHexString(!0)),e==="hex4"&&(n=this.toHex8String(!0)),e==="hex8"&&(n=this.toHex8String()),e==="name"&&(n=this.toName()),e==="hsl"&&(n=this.toHslString()),e==="hsv"&&(n=this.toHsvString()),n||this.toHexString())},clone:function(){return li(this.toString())},_applyModification:function(e,r){var n=e.apply(null,[this].concat([].slice.call(r)));return this._r=n._r,this._g=n._g,this._b=n._b,this.setAlpha(n._a),this},lighten:function(){return this._applyModification(i5e,arguments)},brighten:function(){return this._applyModification(a5e,arguments)},darken:function(){return this._applyModification(o5e,arguments)},desaturate:function(){return this._applyModification(t5e,arguments)},saturate:function(){return this._applyModification(r5e,arguments)},greyscale:function(){return this._applyModification(n5e,arguments)},spin:function(){return this._applyModification(s5e,arguments)},_applyCombination:function(e,r){return e.apply(null,[this].concat([].slice.call(r)))},analogous:function(){return this._applyCombination(c5e,arguments)},complement:function(){return this._applyCombination(l5e,arguments)},monochromatic:function(){return this._applyCombination(f5e,arguments)},splitcomplement:function(){return this._applyCombination(u5e,arguments)},triad:function(){return this._applyCombination(O$,[3])},tetrad:function(){return this._applyCombination(O$,[4])}};li.fromRatio=function(t,e){if(CE(t)=="object"){var r={};for(var n in t)t.hasOwnProperty(n)&&(n==="a"?r[n]=t[n]:r[n]=q1(t[n]));t=r}return li(t,e)};function ZAe(t){var e={r:0,g:0,b:0},r=1,n=null,i=null,a=null,s=!1,o=!1;return typeof t=="string"&&(t=m5e(t)),CE(t)=="object"&&(tp(t.r)&&tp(t.g)&&tp(t.b)?(e=KAe(t.r,t.g,t.b),s=!0,o=String(t.r).substr(-1)==="%"?"prgb":"rgb"):tp(t.h)&&tp(t.s)&&tp(t.v)?(n=q1(t.s),i=q1(t.v),e=QAe(t.h,n,i),s=!0,o="hsv"):tp(t.h)&&tp(t.s)&&tp(t.l)&&(n=q1(t.s),a=q1(t.l),e=JAe(t.h,n,a),s=!0,o="hsl"),t.hasOwnProperty("a")&&(r=t.a)),r=xQ(r),{ok:s,format:t.format||o,r:Math.min(255,Math.max(e.r,0)),g:Math.min(255,Math.max(e.g,0)),b:Math.min(255,Math.max(e.b,0)),a:r}}function KAe(t,e,r){return{r:us(t,255)*255,g:us(e,255)*255,b:us(r,255)*255}}function k$(t,e,r){t=us(t,255),e=us(e,255),r=us(r,255);var n=Math.max(t,e,r),i=Math.min(t,e,r),a,s,o=(n+i)/2;if(n==i)a=s=0;else{var c=n-i;switch(s=o>.5?c/(2-n-i):c/(n+i),n){case t:a=(e-r)/c+(e<r?6:0);break;case e:a=(r-t)/c+2;break;case r:a=(t-e)/c+4;break}a/=6}return{h:a,s,l:o}}function JAe(t,e,r){var n,i,a;t=us(t,360),e=us(e,100),r=us(r,100);function s(f,d,m){return m<0&&(m+=1),m>1&&(m-=1),m<1/6?f+(d-f)*6*m:m<1/2?d:m<2/3?f+(d-f)*(2/3-m)*6:f}if(e===0)n=i=a=r;else{var o=r<.5?r*(1+e):r+e-r*e,c=2*r-o;n=s(c,o,t+1/3),i=s(c,o,t),a=s(c,o,t-1/3)}return{r:n*255,g:i*255,b:a*255}}function R$(t,e,r){t=us(t,255),e=us(e,255),r=us(r,255);var n=Math.max(t,e,r),i=Math.min(t,e,r),a,s,o=n,c=n-i;if(s=n===0?0:c/n,n==i)a=0;else{switch(n){case t:a=(e-r)/c+(e<r?6:0);break;case e:a=(r-t)/c+2;break;case r:a=(t-e)/c+4;break}a/=6}return{h:a,s,v:o}}function QAe(t,e,r){t=us(t,360)*6,e=us(e,100),r=us(r,100);var n=Math.floor(t),i=t-n,a=r*(1-e),s=r*(1-i*e),o=r*(1-(1-i)*e),c=n%6,f=[r,s,a,a,o,r][c],d=[o,r,r,s,a,a][c],m=[a,a,o,r,r,s][c];return{r:f*255,g:d*255,b:m*255}}function M$(t,e,r,n){var i=[wh(Math.round(t).toString(16)),wh(Math.round(e).toString(16)),wh(Math.round(r).toString(16))];return n&&i[0].charAt(0)==i[0].charAt(1)&&i[1].charAt(0)==i[1].charAt(1)&&i[2].charAt(0)==i[2].charAt(1)?i[0].charAt(0)+i[1].charAt(0)+i[2].charAt(0):i.join("")}function e5e(t,e,r,n,i){var a=[wh(Math.round(t).toString(16)),wh(Math.round(e).toString(16)),wh(Math.round(r).toString(16)),wh(wQ(n))];return i&&a[0].charAt(0)==a[0].charAt(1)&&a[1].charAt(0)==a[1].charAt(1)&&a[2].charAt(0)==a[2].charAt(1)&&a[3].charAt(0)==a[3].charAt(1)?a[0].charAt(0)+a[1].charAt(0)+a[2].charAt(0)+a[3].charAt(0):a.join("")}function D$(t,e,r,n){var i=[wh(wQ(n)),wh(Math.round(t).toString(16)),wh(Math.round(e).toString(16)),wh(Math.round(r).toString(16))];return i.join("")}li.equals=function(t,e){return!t||!e?!1:li(t).toRgbString()==li(e).toRgbString()};li.random=function(){return li.fromRatio({r:Math.random(),g:Math.random(),b:Math.random()})};function t5e(t,e){e=e===0?0:e||10;var r=li(t).toHsl();return r.s-=e/100,r.s=P3(r.s),li(r)}function r5e(t,e){e=e===0?0:e||10;var r=li(t).toHsl();return r.s+=e/100,r.s=P3(r.s),li(r)}function n5e(t){return li(t).desaturate(100)}function i5e(t,e){e=e===0?0:e||10;var r=li(t).toHsl();return r.l+=e/100,r.l=P3(r.l),li(r)}function a5e(t,e){e=e===0?0:e||10;var r=li(t).toRgb();return r.r=Math.max(0,Math.min(255,r.r-Math.round(255*-(e/100)))),r.g=Math.max(0,Math.min(255,r.g-Math.round(255*-(e/100)))),r.b=Math.max(0,Math.min(255,r.b-Math.round(255*-(e/100)))),li(r)}function o5e(t,e){e=e===0?0:e||10;var r=li(t).toHsl();return r.l-=e/100,r.l=P3(r.l),li(r)}function s5e(t,e){var r=li(t).toHsl(),n=(r.h+e)%360;return r.h=n<0?360+n:n,li(r)}function l5e(t){var e=li(t).toHsl();return e.h=(e.h+180)%360,li(e)}function O$(t,e){if(isNaN(e)||e<=0)throw new Error("Argument to polyad must be a positive number");for(var r=li(t).toHsl(),n=[li(t)],i=360/e,a=1;a<e;a++)n.push(li({h:(r.h+a*i)%360,s:r.s,l:r.l}));return n}function u5e(t){var e=li(t).toHsl(),r=e.h;return[li(t),li({h:(r+72)%360,s:e.s,l:e.l}),li({h:(r+216)%360,s:e.s,l:e.l})]}function c5e(t,e,r){e=e||6,r=r||30;var n=li(t).toHsl(),i=360/r,a=[li(t)];for(n.h=(n.h-(i*e>>1)+720)%360;--e;)n.h=(n.h+i)%360,a.push(li(n));return a}function f5e(t,e){e=e||6;for(var r=li(t).toHsv(),n=r.h,i=r.s,a=r.v,s=[],o=1/e;e--;)s.push(li({h:n,s:i,v:a})),a=(a+o)%1;return s}li.mix=function(t,e,r){r=r===0?0:r||50;var n=li(t).toRgb(),i=li(e).toRgb(),a=r/100,s={r:(i.r-n.r)*a+n.r,g:(i.g-n.g)*a+n.g,b:(i.b-n.b)*a+n.b,a:(i.a-n.a)*a+n.a};return li(s)};li.readability=function(t,e){var r=li(t),n=li(e);return(Math.max(r.getLuminance(),n.getLuminance())+.05)/(Math.min(r.getLuminance(),n.getLuminance())+.05)};li.isReadable=function(t,e,r){var n=li.readability(t,e),i,a;switch(a=!1,i=y5e(r),i.level+i.size){case"AAsmall":case"AAAlarge":a=n>=4.5;break;case"AAlarge":a=n>=3;break;case"AAAsmall":a=n>=7;break}return a};li.mostReadable=function(t,e,r){var n=null,i=0,a,s,o,c;r=r||{},s=r.includeFallbackColors,o=r.level,c=r.size;for(var f=0;f<e.length;f++)a=li.readability(t,e[f]),a>i&&(i=a,n=li(e[f]));return li.isReadable(t,n,{level:o,size:c})||!s?n:(r.includeFallbackColors=!1,li.mostReadable(t,["#fff","#000"],r))};var WR=li.names={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"0ff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"00f",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",burntsienna:"ea7e5d",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"0ff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"f0f",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"663399",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"},h5e=li.hexNames=d5e(WR);function d5e(t){var e={};for(var r in t)t.hasOwnProperty(r)&&(e[t[r]]=r);return e}function xQ(t){return t=parseFloat(t),(isNaN(t)||t<0||t>1)&&(t=1),t}function us(t,e){p5e(t)&&(t="100%");var r=g5e(t);return t=Math.min(e,Math.max(0,parseFloat(t))),r&&(t=parseInt(t*e,10)/100),Math.abs(t-e)<1e-6?1:t%e/parseFloat(e)}function P3(t){return Math.min(1,Math.max(0,t))}function rf(t){return parseInt(t,16)}function p5e(t){return typeof t=="string"&&t.indexOf(".")!=-1&&parseFloat(t)===1}function g5e(t){return typeof t=="string"&&t.indexOf("%")!=-1}function wh(t){return t.length==1?"0"+t:""+t}function q1(t){return t<=1&&(t=t*100+"%"),t}function wQ(t){return Math.round(parseFloat(t)*255).toString(16)}function N$(t){return rf(t)/255}var mh=(function(){var t="[-\\+]?\\d+%?",e="[-\\+]?\\d*\\.\\d+%?",r="(?:"+e+")|(?:"+t+")",n="[\\s|\\(]+("+r+")[,|\\s]+("+r+")[,|\\s]+("+r+")\\s*\\)?",i="[\\s|\\(]+("+r+")[,|\\s]+("+r+")[,|\\s]+("+r+")[,|\\s]+("+r+")\\s*\\)?";return{CSS_UNIT:new RegExp(r),rgb:new RegExp("rgb"+n),rgba:new RegExp("rgba"+i),hsl:new RegExp("hsl"+n),hsla:new RegExp("hsla"+i),hsv:new RegExp("hsv"+n),hsva:new RegExp("hsva"+i),hex3:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex4:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex8:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/}})();function tp(t){return!!mh.CSS_UNIT.exec(t)}function m5e(t){t=t.replace(XAe,"").replace(YAe,"").toLowerCase();var e=!1;if(WR[t])t=WR[t],e=!0;else if(t=="transparent")return{r:0,g:0,b:0,a:0,format:"name"};var r;return(r=mh.rgb.exec(t))?{r:r[1],g:r[2],b:r[3]}:(r=mh.rgba.exec(t))?{r:r[1],g:r[2],b:r[3],a:r[4]}:(r=mh.hsl.exec(t))?{h:r[1],s:r[2],l:r[3]}:(r=mh.hsla.exec(t))?{h:r[1],s:r[2],l:r[3],a:r[4]}:(r=mh.hsv.exec(t))?{h:r[1],s:r[2],v:r[3]}:(r=mh.hsva.exec(t))?{h:r[1],s:r[2],v:r[3],a:r[4]}:(r=mh.hex8.exec(t))?{r:rf(r[1]),g:rf(r[2]),b:rf(r[3]),a:N$(r[4]),format:e?"name":"hex8"}:(r=mh.hex6.exec(t))?{r:rf(r[1]),g:rf(r[2]),b:rf(r[3]),format:e?"name":"hex"}:(r=mh.hex4.exec(t))?{r:rf(r[1]+""+r[1]),g:rf(r[2]+""+r[2]),b:rf(r[3]+""+r[3]),a:N$(r[4]+""+r[4]),format:e?"name":"hex8"}:(r=mh.hex3.exec(t))?{r:rf(r[1]+""+r[1]),g:rf(r[2]+""+r[2]),b:rf(r[3]+""+r[3]),format:e?"name":"hex"}:!1}function y5e(t){var e,r;return t=t||{level:"AA",size:"small"},e=(t.level||"AA").toUpperCase(),r=(t.size||"small").toLowerCase(),e!=="AA"&&e!=="AAA"&&(e="AA"),r!=="small"&&r!=="large"&&(r="small"),{level:e,size:r}}var L$=function(e){var r=["r","g","b","a","h","s","l","v"],n=0,i=0;return WAe(r,function(a){if(e[a]&&(n+=1,isNaN(e[a])||(i+=1),a==="s"||a==="l")){var s=/^\d+%$/;s.test(e[a])&&(i+=1)}}),n===i?e:!1},H1=function(e,r){var n=e.hex?li(e.hex):li(e),i=n.toHsl(),a=n.toHsv(),s=n.toRgb(),o=n.toHex();i.s===0&&(i.h=r||0,a.h=r||0);var c=o==="000000"&&s.a===0;return{hsl:i,hex:c?"transparent":"#"+o,rgb:s,hsv:a,oldHue:e.h||r||i.h,source:e.source}},Ug=function(e){if(e==="transparent")return!0;var r=String(e).charAt(0)==="#"?1:0;return e.length!==4+r&&e.length<7+r&&li(e).isValid()},zN=function(e){if(!e)return"#fff";var r=H1(e);if(r.hex==="transparent")return"rgba(0,0,0,0.4)";var n=(r.rgb.r*299+r.rgb.g*587+r.rgb.b*114)/1e3;return n>=128?"#000":"#fff"},iP=function(e,r){var n=e.replace("","");return li(r+" ("+n+")")._ok},f1=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},v5e=(function(){function t(e,r){for(var n=0;n<r.length;n++){var i=r[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}})();function _5e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function b5e(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e&&(typeof e=="object"||typeof e=="function")?e:t}function x5e(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var Uc=function(e){var r=(function(n){x5e(i,n);function i(a){_5e(this,i);var s=b5e(this,(i.__proto__||Object.getPrototypeOf(i)).call(this));return s.handleChange=function(o,c){var f=L$(o);if(f){var d=H1(o,o.h||s.state.oldHue);s.setState(d),s.props.onChangeComplete&&s.debounce(s.props.onChangeComplete,d,c),s.props.onChange&&s.props.onChange(d,c)}},s.handleSwatchHover=function(o,c){var f=L$(o);if(f){var d=H1(o,o.h||s.state.oldHue);s.props.onSwatchHover&&s.props.onSwatchHover(d,c)}},s.state=f1({},H1(a.color,0)),s.debounce=_Q(function(o,c,f){o(c,f)},100),s}return v5e(i,[{key:"render",value:function(){var s={};return this.props.onSwatchHover&&(s.onSwatchHover=this.handleSwatchHover),gt.createElement(e,f1({},this.props,this.state,{onChange:this.handleChange},s))}}],[{key:"getDerivedStateFromProps",value:function(s,o){return f1({},H1(s.color,o.oldHue))}}]),i})(te.PureComponent||te.Component);return r.propTypes=f1({},e.propTypes),r.defaultProps=f1({},e.defaultProps,{color:{h:250,s:.5,l:.2,a:1}}),r},w5e=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},S5e=(function(){function t(e,r){for(var n=0;n<r.length;n++){var i=r[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}})();function E5e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function F$(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e&&(typeof e=="object"||typeof e=="function")?e:t}function T5e(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var C5e=function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"span";return(function(n){T5e(i,n);function i(){var a,s,o,c;E5e(this,i);for(var f=arguments.length,d=Array(f),m=0;m<f;m++)d[m]=arguments[m];return c=(s=(o=F$(this,(a=i.__proto__||Object.getPrototypeOf(i)).call.apply(a,[this].concat(d))),o),o.state={focus:!1},o.handleFocus=function(){return o.setState({focus:!0})},o.handleBlur=function(){return o.setState({focus:!1})},s),F$(o,c)}return S5e(i,[{key:"render",value:function(){return gt.createElement(r,{onFocus:this.handleFocus,onBlur:this.handleBlur},gt.createElement(e,w5e({},this.props,this.state)))}}]),i})(gt.Component)},B$=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},A5e=13,I5e=function(e){var r=e.color,n=e.style,i=e.onClick,a=i===void 0?function(){}:i,s=e.onHover,o=e.title,c=o===void 0?r:o,f=e.children,d=e.focus,m=e.focusStyle,b=m===void 0?{}:m,x=r==="transparent",E=Li({default:{swatch:B$({background:r,height:"100%",width:"100%",cursor:"pointer",position:"relative",outline:"none"},n,d?b:{})}}),T=function(O){return a(r,O)},A=function(O){return O.keyCode===A5e&&a(r,O)},M=function(O){return s(r,O)},F={};return s&&(F.onMouseOver=M),gt.createElement("div",B$({style:E.swatch,onClick:T,title:c,tabIndex:0,onKeyDown:A},F),f,x&&gt.createElement(x_,{borderRadius:E.swatch.borderRadius,boxShadow:"inset 0 0 0 1px rgba(0,0,0,0.1)"}))};const Ry=C5e(I5e);var P5e=function(e){var r=e.direction,n=Li({default:{picker:{width:"18px",height:"18px",borderRadius:"50%",transform:"translate(-9px, -1px)",backgroundColor:"rgb(248, 248, 248)",boxShadow:"0 1px 4px 0 rgba(0, 0, 0, 0.37)"}},vertical:{picker:{transform:"translate(-3px, -9px)"}}},{vertical:r==="vertical"});return gt.createElement("div",{style:n.picker})},k5e=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},SQ=function(e){var r=e.rgb,n=e.hsl,i=e.width,a=e.height,s=e.onChange,o=e.direction,c=e.style,f=e.renderers,d=e.pointer,m=e.className,b=m===void 0?"":m,x=Li({default:{picker:{position:"relative",width:i,height:a},alpha:{radius:"2px",style:c}}});return gt.createElement("div",{style:x.picker,className:"alpha-picker "+b},gt.createElement(RN,k5e({},x.alpha,{rgb:r,hsl:n,pointer:d,renderers:f,onChange:s,direction:o})))};SQ.defaultProps={width:"316px",height:"16px",direction:"horizontal",pointer:P5e};Uc(SQ);function EQ(t,e){for(var r=-1,n=t==null?0:t.length,i=Array(n);++r<n;)i[r]=e(t[r],r,t);return i}var R5e="__lodash_hash_undefined__";function M5e(t){return this.__data__.set(t,R5e),this}function D5e(t){return this.__data__.has(t)}function AE(t){var e=-1,r=t==null?0:t.length;for(this.__data__=new Dp;++e<r;)this.add(t[e])}AE.prototype.add=AE.prototype.push=M5e;AE.prototype.has=D5e;function O5e(t,e){for(var r=-1,n=t==null?0:t.length;++r<n;)if(e(t[r],r,t))return!0;return!1}function N5e(t,e){return t.has(e)}var L5e=1,F5e=2;function TQ(t,e,r,n,i,a){var s=r&L5e,o=t.length,c=e.length;if(o!=c&&!(s&&c>o))return!1;var f=a.get(t),d=a.get(e);if(f&&d)return f==e&&d==t;var m=-1,b=!0,x=r&F5e?new AE:void 0;for(a.set(t,e),a.set(e,t);++m<o;){var E=t[m],T=e[m];if(n)var A=s?n(T,E,m,e,t,a):n(E,T,m,t,e,a);if(A!==void 0){if(A)continue;b=!1;break}if(x){if(!O5e(e,function(M,F){if(!N5e(x,F)&&(E===M||i(E,M,r,n,a)))return x.push(F)})){b=!1;break}}else if(!(E===T||i(E,T,r,n,a))){b=!1;break}}return a.delete(t),a.delete(e),b}function B5e(t){var e=-1,r=Array(t.size);return t.forEach(function(n,i){r[++e]=[i,n]}),r}function z5e(t){var e=-1,r=Array(t.size);return t.forEach(function(n){r[++e]=n}),r}var j5e=1,U5e=2,V5e="[object Boolean]",$5e="[object Date]",q5e="[object Error]",H5e="[object Map]",G5e="[object Number]",W5e="[object RegExp]",X5e="[object Set]",Y5e="[object String]",Z5e="[object Symbol]",K5e="[object ArrayBuffer]",J5e="[object DataView]",z$=kg?kg.prototype:void 0,aP=z$?z$.valueOf:void 0;function Q5e(t,e,r,n,i,a,s){switch(r){case J5e:if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case K5e:return!(t.byteLength!=e.byteLength||!a(new SE(t),new SE(e)));case V5e:case $5e:case G5e:return Xx(+t,+e);case q5e:return t.name==e.name&&t.message==e.message;case W5e:case Y5e:return t==e+"";case H5e:var o=B5e;case X5e:var c=n&j5e;if(o||(o=z5e),t.size!=e.size&&!c)return!1;var f=s.get(t);if(f)return f==e;n|=U5e,s.set(t,e);var d=TQ(o(t),o(e),n,i,a,s);return s.delete(t),d;case Z5e:if(aP)return aP.call(t)==aP.call(e)}return!1}function e4e(t,e){for(var r=-1,n=e.length,i=t.length;++r<n;)t[i+r]=e[r];return t}function t4e(t,e,r){var n=e(t);return yf(t)?n:e4e(n,r(t))}function r4e(t,e){for(var r=-1,n=t==null?0:t.length,i=0,a=[];++r<n;){var s=t[r];e(s,r,t)&&(a[i++]=s)}return a}function n4e(){return[]}var i4e=Object.prototype,a4e=i4e.propertyIsEnumerable,j$=Object.getOwnPropertySymbols,o4e=j$?function(t){return t==null?[]:(t=Object(t),r4e(j$(t),function(e){return a4e.call(t,e)}))}:n4e;function U$(t){return t4e(t,BN,o4e)}var s4e=1,l4e=Object.prototype,u4e=l4e.hasOwnProperty;function c4e(t,e,r,n,i,a){var s=r&s4e,o=U$(t),c=o.length,f=U$(e),d=f.length;if(c!=d&&!s)return!1;for(var m=c;m--;){var b=o[m];if(!(s?b in e:u4e.call(e,b)))return!1}var x=a.get(t),E=a.get(e);if(x&&E)return x==e&&E==t;var T=!0;a.set(t,e),a.set(e,t);for(var A=s;++m<c;){b=o[m];var M=t[b],F=e[b];if(n)var N=s?n(F,M,b,e,t,a):n(M,F,b,t,e,a);if(!(N===void 0?M===F||i(M,F,r,n,a):N)){T=!1;break}A||(A=b=="constructor")}if(T&&!A){var O=t.constructor,U=e.constructor;O!=U&&"constructor"in t&&"constructor"in e&&!(typeof O=="function"&&O instanceof O&&typeof U=="function"&&U instanceof U)&&(T=!1)}return a.delete(t),a.delete(e),T}var XR=ky(Lh,"DataView"),YR=ky(Lh,"Promise"),ZR=ky(Lh,"Set"),KR=ky(Lh,"WeakMap"),V$="[object Map]",f4e="[object Object]",$$="[object Promise]",q$="[object Set]",H$="[object WeakMap]",G$="[object DataView]",h4e=Py(XR),d4e=Py(ex),p4e=Py(YR),g4e=Py(ZR),m4e=Py(KR),ag=Iy;(XR&&ag(new XR(new ArrayBuffer(1)))!=G$||ex&&ag(new ex)!=V$||YR&&ag(YR.resolve())!=$$||ZR&&ag(new ZR)!=q$||KR&&ag(new KR)!=H$)&&(ag=function(t){var e=Iy(t),r=e==f4e?t.constructor:void 0,n=r?Py(r):"";if(n)switch(n){case h4e:return G$;case d4e:return V$;case p4e:return $$;case g4e:return q$;case m4e:return H$}return e});var y4e=1,W$="[object Arguments]",X$="[object Array]",Mw="[object Object]",v4e=Object.prototype,Y$=v4e.hasOwnProperty;function _4e(t,e,r,n,i,a){var s=yf(t),o=yf(e),c=s?X$:ag(t),f=o?X$:ag(e);c=c==W$?Mw:c,f=f==W$?Mw:f;var d=c==Mw,m=f==Mw,b=c==f;if(b&&TE(t)){if(!TE(e))return!1;s=!0,d=!1}if(b&&!d)return a||(a=new xd),s||LN(t)?TQ(t,e,r,n,i,a):Q5e(t,e,c,r,n,i,a);if(!(r&y4e)){var x=d&&Y$.call(t,"__wrapped__"),E=m&&Y$.call(e,"__wrapped__");if(x||E){var T=x?t.value():t,A=E?e.value():e;return a||(a=new xd),i(T,A,r,n,a)}}return b?(a||(a=new xd),c4e(t,e,r,n,i,a)):!1}function jN(t,e,r,n,i){return t===e?!0:t==null||e==null||!Rg(t)&&!Rg(e)?t!==t&&e!==e:_4e(t,e,r,n,jN,i)}var b4e=1,x4e=2;function w4e(t,e,r,n){var i=r.length,a=i;if(t==null)return!a;for(t=Object(t);i--;){var s=r[i];if(s[2]?s[1]!==t[s[0]]:!(s[0]in t))return!1}for(;++i<a;){s=r[i];var o=s[0],c=t[o],f=s[1];if(s[2]){if(c===void 0&&!(o in t))return!1}else{var d=new xd,m;if(!(m===void 0?jN(f,c,b4e|x4e,n,d):m))return!1}}return!0}function CQ(t){return t===t&&!Zf(t)}function S4e(t){for(var e=BN(t),r=e.length;r--;){var n=e[r],i=t[n];e[r]=[n,i,CQ(i)]}return e}function AQ(t,e){return function(r){return r==null?!1:r[t]===e&&(e!==void 0||t in Object(r))}}function E4e(t){var e=S4e(t);return e.length==1&&e[0][2]?AQ(e[0][0],e[0][1]):function(r){return r===t||w4e(r,t,e)}}var T4e=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,C4e=/^\w*$/;function UN(t,e){if(yf(t))return!1;var r=typeof t;return r=="number"||r=="symbol"||r=="boolean"||t==null||A3(t)?!0:C4e.test(t)||!T4e.test(t)||e!=null&&t in Object(e)}var A4e="Expected a function";function VN(t,e){if(typeof t!="function"||e!=null&&typeof e!="function")throw new TypeError(A4e);var r=function(){var n=arguments,i=e?e.apply(this,n):n[0],a=r.cache;if(a.has(i))return a.get(i);var s=t.apply(this,n);return r.cache=a.set(i,s)||a,s};return r.cache=new(VN.Cache||Dp),r}VN.Cache=Dp;var I4e=500;function P4e(t){var e=VN(t,function(n){return r.size===I4e&&r.clear(),n}),r=e.cache;return e}var k4e=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,R4e=/\\(\\)?/g,M4e=P4e(function(t){var e=[];return t.charCodeAt(0)===46&&e.push(""),t.replace(k4e,function(r,n,i,a){e.push(i?a.replace(R4e,"$1"):n||r)}),e}),Z$=kg?kg.prototype:void 0,K$=Z$?Z$.toString:void 0;function IQ(t){if(typeof t=="string")return t;if(yf(t))return EQ(t,IQ)+"";if(A3(t))return K$?K$.call(t):"";var e=t+"";return e=="0"&&1/t==-1/0?"-0":e}function D4e(t){return t==null?"":IQ(t)}function PQ(t,e){return yf(t)?t:UN(t,e)?[t]:M4e(D4e(t))}function k3(t){if(typeof t=="string"||A3(t))return t;var e=t+"";return e=="0"&&1/t==-1/0?"-0":e}function kQ(t,e){e=PQ(e,t);for(var r=0,n=e.length;t!=null&&r<n;)t=t[k3(e[r++])];return r&&r==n?t:void 0}function O4e(t,e,r){var n=t==null?void 0:kQ(t,e);return n===void 0?r:n}function N4e(t,e){return t!=null&&e in Object(t)}function L4e(t,e,r){e=PQ(e,t);for(var n=-1,i=e.length,a=!1;++n<i;){var s=k3(e[n]);if(!(a=t!=null&&r(t,s)))break;t=t[s]}return a||++n!=i?a:(i=t==null?0:t.length,!!i&&NN(i)&&FN(s,i)&&(yf(t)||EE(t)))}function F4e(t,e){return t!=null&&L4e(t,e,N4e)}var B4e=1,z4e=2;function j4e(t,e){return UN(t)&&CQ(e)?AQ(k3(t),e):function(r){var n=O4e(r,t);return n===void 0&&n===e?F4e(r,t):jN(e,n,B4e|z4e)}}function U4e(t){return function(e){return e?.[t]}}function V4e(t){return function(e){return kQ(e,t)}}function $4e(t){return UN(t)?U4e(k3(t)):V4e(t)}function q4e(t){return typeof t=="function"?t:t==null?C3:typeof t=="object"?yf(t)?j4e(t[0],t[1]):E4e(t):$4e(t)}function H4e(t,e){var r=-1,n=S_(t)?Array(t.length):[];return bQ(t,function(i,a,s){n[++r]=e(i,a,s)}),n}function My(t,e){var r=yf(t)?EQ:H4e;return r(t,q4e(e))}var G4e=function(e){var r=e.colors,n=e.onClick,i=e.onSwatchHover,a=Li({default:{swatches:{marginRight:"-10px"},swatch:{width:"22px",height:"22px",float:"left",marginRight:"10px",marginBottom:"10px",borderRadius:"4px"},clear:{clear:"both"}}});return gt.createElement("div",{style:a.swatches},My(r,function(s){return gt.createElement(Ry,{key:s,color:s,style:a.swatch,onClick:n,onHover:i,focusStyle:{boxShadow:"0 0 4px "+s}})}),gt.createElement("div",{style:a.clear}))},$N=function(e){var r=e.onChange,n=e.onSwatchHover,i=e.hex,a=e.colors,s=e.width,o=e.triangle,c=e.styles,f=c===void 0?{}:c,d=e.className,m=d===void 0?"":d,b=i==="transparent",x=function(A,M){Ug(A)&&r({hex:A,source:"hex"},M)},E=Li(jc({default:{card:{width:s,background:"#fff",boxShadow:"0 1px rgba(0,0,0,.1)",borderRadius:"6px",position:"relative"},head:{height:"110px",background:i,borderRadius:"6px 6px 0 0",display:"flex",alignItems:"center",justifyContent:"center",position:"relative"},body:{padding:"10px"},label:{fontSize:"18px",color:zN(i),position:"relative"},triangle:{width:"0px",height:"0px",borderStyle:"solid",borderWidth:"0 10px 10px 10px",borderColor:"transparent transparent "+i+" transparent",position:"absolute",top:"-10px",left:"50%",marginLeft:"-10px"},input:{width:"100%",fontSize:"12px",color:"#666",border:"0px",outline:"none",height:"22px",boxShadow:"inset 0 0 0 1px #ddd",borderRadius:"4px",padding:"0 7px",boxSizing:"border-box"}},"hide-triangle":{triangle:{display:"none"}}},f),{"hide-triangle":o==="hide"});return gt.createElement("div",{style:E.card,className:"block-picker "+m},gt.createElement("div",{style:E.triangle}),gt.createElement("div",{style:E.head},b&&gt.createElement(x_,{borderRadius:"6px 6px 0 0"}),gt.createElement("div",{style:E.label},i)),gt.createElement("div",{style:E.body},gt.createElement(G4e,{colors:a,onClick:x,onSwatchHover:n}),gt.createElement(ya,{style:{input:E.input},value:i,onChange:x})))};$N.propTypes={width:Rn.oneOfType([Rn.string,Rn.number]),colors:Rn.arrayOf(Rn.string),triangle:Rn.oneOf(["top","hide"]),styles:Rn.object};$N.defaultProps={width:170,colors:["#D9E3F0","#F47373","#697689","#37D67A","#2CCCE4","#555555","#dce775","#ff8a65","#ba68c8"],triangle:"top",styles:{}};Uc($N);var Uv={100:"#ffcdd2",300:"#e57373",500:"#f44336",700:"#d32f2f",900:"#b71c1c"},Vv={100:"#f8bbd0",300:"#f06292",500:"#e91e63",700:"#c2185b",900:"#880e4f"},$v={100:"#e1bee7",300:"#ba68c8",500:"#9c27b0",700:"#7b1fa2",900:"#4a148c"},qv={100:"#d1c4e9",300:"#9575cd",500:"#673ab7",700:"#512da8",900:"#311b92"},Hv={100:"#c5cae9",300:"#7986cb",500:"#3f51b5",700:"#303f9f",900:"#1a237e"},Gv={100:"#bbdefb",300:"#64b5f6",500:"#2196f3",700:"#1976d2",900:"#0d47a1"},Wv={100:"#b3e5fc",300:"#4fc3f7",500:"#03a9f4",700:"#0288d1",900:"#01579b"},Xv={100:"#b2ebf2",300:"#4dd0e1",500:"#00bcd4",700:"#0097a7",900:"#006064"},Yv={100:"#b2dfdb",300:"#4db6ac",500:"#009688",700:"#00796b",900:"#004d40"},G1={100:"#c8e6c9",300:"#81c784",500:"#4caf50",700:"#388e3c"},Zv={100:"#dcedc8",300:"#aed581",500:"#8bc34a",700:"#689f38",900:"#33691e"},Kv={100:"#f0f4c3",300:"#dce775",500:"#cddc39",700:"#afb42b",900:"#827717"},Jv={100:"#fff9c4",300:"#fff176",500:"#ffeb3b",700:"#fbc02d",900:"#f57f17"},Qv={100:"#ffecb3",300:"#ffd54f",500:"#ffc107",700:"#ffa000",900:"#ff6f00"},e0={100:"#ffe0b2",300:"#ffb74d",500:"#ff9800",700:"#f57c00",900:"#e65100"},t0={100:"#ffccbc",300:"#ff8a65",500:"#ff5722",700:"#e64a19",900:"#bf360c"},r0={100:"#d7ccc8",300:"#a1887f",500:"#795548",700:"#5d4037",900:"#3e2723"},n0={100:"#cfd8dc",300:"#90a4ae",500:"#607d8b",700:"#455a64",900:"#263238"},RQ=function(e){var r=e.color,n=e.onClick,i=e.onSwatchHover,a=e.hover,s=e.active,o=e.circleSize,c=e.circleSpacing,f=Li({default:{swatch:{width:o,height:o,marginRight:c,marginBottom:c,transform:"scale(1)",transition:"100ms transform ease"},Swatch:{borderRadius:"50%",background:"transparent",boxShadow:"inset 0 0 0 "+(o/2+1)+"px "+r,transition:"100ms box-shadow ease"}},hover:{swatch:{transform:"scale(1.2)"}},active:{Swatch:{boxShadow:"inset 0 0 0 3px "+r}}},{hover:a,active:s});return gt.createElement("div",{style:f.swatch},gt.createElement(Ry,{style:f.Swatch,color:r,onClick:n,onHover:i,focusStyle:{boxShadow:f.Swatch.boxShadow+", 0 0 5px "+r}}))};RQ.defaultProps={circleSize:28,circleSpacing:14};const W4e=kN.handleHover(RQ);var qN=function(e){var r=e.width,n=e.onChange,i=e.onSwatchHover,a=e.colors,s=e.hex,o=e.circleSize,c=e.styles,f=c===void 0?{}:c,d=e.circleSpacing,m=e.className,b=m===void 0?"":m,x=Li(jc({default:{card:{width:r,display:"flex",flexWrap:"wrap",marginRight:-d,marginBottom:-d}}},f)),E=function(A,M){return n({hex:A,source:"hex"},M)};return gt.createElement("div",{style:x.card,className:"circle-picker "+b},My(a,function(T){return gt.createElement(W4e,{key:T,color:T,onClick:E,onSwatchHover:i,active:s===T.toLowerCase(),circleSize:o,circleSpacing:d})}))};qN.propTypes={width:Rn.oneOfType([Rn.string,Rn.number]),circleSize:Rn.number,circleSpacing:Rn.number,styles:Rn.object};qN.defaultProps={width:252,circleSize:28,circleSpacing:14,colors:[Uv[500],Vv[500],$v[500],qv[500],Hv[500],Gv[500],Wv[500],Xv[500],Yv[500],G1[500],Zv[500],Kv[500],Jv[500],Qv[500],e0[500],t0[500],r0[500],n0[500]],styles:{}};Uc(qN);function J$(t){return t===void 0}var Dw={},Q$;function X4e(){if(Q$)return Dw;Q$=1,Object.defineProperty(Dw,"__esModule",{value:!0});var t=Object.assign||function(s){for(var o=1;o<arguments.length;o++){var c=arguments[o];for(var f in c)Object.prototype.hasOwnProperty.call(c,f)&&(s[f]=c[f])}return s},e=wx(),r=n(e);function n(s){return s&&s.__esModule?s:{default:s}}function i(s,o){var c={};for(var f in s)o.indexOf(f)>=0||Object.prototype.hasOwnProperty.call(s,f)&&(c[f]=s[f]);return c}var a=24;return Dw.default=function(s){var o=s.fill,c=o===void 0?"currentColor":o,f=s.width,d=f===void 0?a:f,m=s.height,b=m===void 0?a:m,x=s.style,E=x===void 0?{}:x,T=i(s,["fill","width","height","style"]);return r.default.createElement("svg",t({viewBox:"0 0 "+a+" "+a,style:t({fill:c,width:d,height:b},E)},T),r.default.createElement("path",{d:"M12,18.17L8.83,15L7.42,16.41L12,21L16.59,16.41L15.17,15M12,5.83L15.17,9L16.58,7.59L12,3L7.41,7.59L8.83,9L12,5.83Z"}))},Dw}var Y4e=X4e();const Z4e=Id(Y4e);var K4e=(function(){function t(e,r){for(var n=0;n<r.length;n++){var i=r[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}})();function J4e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Q4e(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e&&(typeof e=="object"||typeof e=="function")?e:t}function eIe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var MQ=(function(t){eIe(e,t);function e(r){J4e(this,e);var n=Q4e(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return n.toggleViews=function(){n.state.view==="hex"?n.setState({view:"rgb"}):n.state.view==="rgb"?n.setState({view:"hsl"}):n.state.view==="hsl"&&(n.props.hsl.a===1?n.setState({view:"hex"}):n.setState({view:"rgb"}))},n.handleChange=function(i,a){i.hex?Ug(i.hex)&&n.props.onChange({hex:i.hex,source:"hex"},a):i.r||i.g||i.b?n.props.onChange({r:i.r||n.props.rgb.r,g:i.g||n.props.rgb.g,b:i.b||n.props.rgb.b,source:"rgb"},a):i.a?(i.a<0?i.a=0:i.a>1&&(i.a=1),n.props.onChange({h:n.props.hsl.h,s:n.props.hsl.s,l:n.props.hsl.l,a:Math.round(i.a*100)/100,source:"rgb"},a)):(i.h||i.s||i.l)&&(typeof i.s=="string"&&i.s.includes("%")&&(i.s=i.s.replace("%","")),typeof i.l=="string"&&i.l.includes("%")&&(i.l=i.l.replace("%","")),i.s==1?i.s=.01:i.l==1&&(i.l=.01),n.props.onChange({h:i.h||n.props.hsl.h,s:Number(J$(i.s)?n.props.hsl.s:i.s),l:Number(J$(i.l)?n.props.hsl.l:i.l),source:"hsl"},a))},n.showHighlight=function(i){i.currentTarget.style.background="#eee"},n.hideHighlight=function(i){i.currentTarget.style.background="transparent"},r.hsl.a!==1&&r.view==="hex"?n.state={view:"rgb"}:n.state={view:r.view},n}return K4e(e,[{key:"render",value:function(){var n=this,i=Li({default:{wrap:{paddingTop:"16px",display:"flex"},fields:{flex:"1",display:"flex",marginLeft:"-6px"},field:{paddingLeft:"6px",width:"100%"},alpha:{paddingLeft:"6px",width:"100%"},toggle:{width:"32px",textAlign:"right",position:"relative"},icon:{marginRight:"-4px",marginTop:"12px",cursor:"pointer",position:"relative"},iconHighlight:{position:"absolute",width:"24px",height:"28px",background:"#eee",borderRadius:"4px",top:"10px",left:"12px",display:"none"},input:{fontSize:"11px",color:"#333",width:"100%",borderRadius:"2px",border:"none",boxShadow:"inset 0 0 0 1px #dadada",height:"21px",textAlign:"center"},label:{textTransform:"uppercase",fontSize:"11px",lineHeight:"11px",color:"#969696",textAlign:"center",display:"block",marginTop:"12px"},svg:{fill:"#333",width:"24px",height:"24px",border:"1px transparent solid",borderRadius:"5px"}},disableAlpha:{alpha:{display:"none"}}},this.props,this.state),a=void 0;return this.state.view==="hex"?a=gt.createElement("div",{style:i.fields,className:"flexbox-fix"},gt.createElement("div",{style:i.field},gt.createElement(ya,{style:{input:i.input,label:i.label},label:"hex",value:this.props.hex,onChange:this.handleChange}))):this.state.view==="rgb"?a=gt.createElement("div",{style:i.fields,className:"flexbox-fix"},gt.createElement("div",{style:i.field},gt.createElement(ya,{style:{input:i.input,label:i.label},label:"r",value:this.props.rgb.r,onChange:this.handleChange})),gt.createElement("div",{style:i.field},gt.createElement(ya,{style:{input:i.input,label:i.label},label:"g",value:this.props.rgb.g,onChange:this.handleChange})),gt.createElement("div",{style:i.field},gt.createElement(ya,{style:{input:i.input,label:i.label},label:"b",value:this.props.rgb.b,onChange:this.handleChange})),gt.createElement("div",{style:i.alpha},gt.createElement(ya,{style:{input:i.input,label:i.label},label:"a",value:this.props.rgb.a,arrowOffset:.01,onChange:this.handleChange}))):this.state.view==="hsl"&&(a=gt.createElement("div",{style:i.fields,className:"flexbox-fix"},gt.createElement("div",{style:i.field},gt.createElement(ya,{style:{input:i.input,label:i.label},label:"h",value:Math.round(this.props.hsl.h),onChange:this.handleChange})),gt.createElement("div",{style:i.field},gt.createElement(ya,{style:{input:i.input,label:i.label},label:"s",value:Math.round(this.props.hsl.s*100)+"%",onChange:this.handleChange})),gt.createElement("div",{style:i.field},gt.createElement(ya,{style:{input:i.input,label:i.label},label:"l",value:Math.round(this.props.hsl.l*100)+"%",onChange:this.handleChange})),gt.createElement("div",{style:i.alpha},gt.createElement(ya,{style:{input:i.input,label:i.label},label:"a",value:this.props.hsl.a,arrowOffset:.01,onChange:this.handleChange})))),gt.createElement("div",{style:i.wrap,className:"flexbox-fix"},a,gt.createElement("div",{style:i.toggle},gt.createElement("div",{style:i.icon,onClick:this.toggleViews,ref:function(o){return n.icon=o}},gt.createElement(Z4e,{style:i.svg,onMouseOver:this.showHighlight,onMouseEnter:this.showHighlight,onMouseOut:this.hideHighlight}))))}}],[{key:"getDerivedStateFromProps",value:function(n,i){return n.hsl.a!==1&&i.view==="hex"?{view:"rgb"}:null}}]),e})(gt.Component);MQ.defaultProps={view:"hex"};var eq=function(){var e=Li({default:{picker:{width:"12px",height:"12px",borderRadius:"6px",transform:"translate(-6px, -1px)",backgroundColor:"rgb(248, 248, 248)",boxShadow:"0 1px 4px 0 rgba(0, 0, 0, 0.37)"}}});return gt.createElement("div",{style:e.picker})},tIe=function(){var e=Li({default:{picker:{width:"12px",height:"12px",borderRadius:"6px",boxShadow:"inset 0 0 0 1px #fff",transform:"translate(-6px, -6px)"}}});return gt.createElement("div",{style:e.picker})},HN=function(e){var r=e.width,n=e.onChange,i=e.disableAlpha,a=e.rgb,s=e.hsl,o=e.hsv,c=e.hex,f=e.renderers,d=e.styles,m=d===void 0?{}:d,b=e.className,x=b===void 0?"":b,E=e.defaultView,T=Li(jc({default:{picker:{width:r,background:"#fff",borderRadius:"2px",boxShadow:"0 0 2px rgba(0,0,0,.3), 0 4px 8px rgba(0,0,0,.3)",boxSizing:"initial",fontFamily:"Menlo"},saturation:{width:"100%",paddingBottom:"55%",position:"relative",borderRadius:"2px 2px 0 0",overflow:"hidden"},Saturation:{radius:"2px 2px 0 0"},body:{padding:"16px 16px 12px"},controls:{display:"flex"},color:{width:"32px"},swatch:{marginTop:"6px",width:"16px",height:"16px",borderRadius:"8px",position:"relative",overflow:"hidden"},active:{absolute:"0px 0px 0px 0px",borderRadius:"8px",boxShadow:"inset 0 0 0 1px rgba(0,0,0,.1)",background:"rgba("+a.r+", "+a.g+", "+a.b+", "+a.a+")",zIndex:"2"},toggles:{flex:"1"},hue:{height:"10px",position:"relative",marginBottom:"8px"},Hue:{radius:"2px"},alpha:{height:"10px",position:"relative"},Alpha:{radius:"2px"}},disableAlpha:{color:{width:"22px"},alpha:{display:"none"},hue:{marginBottom:"0px"},swatch:{width:"10px",height:"10px",marginTop:"0px"}}},m),{disableAlpha:i});return gt.createElement("div",{style:T.picker,className:"chrome-picker "+x},gt.createElement("div",{style:T.saturation},gt.createElement(I3,{style:T.Saturation,hsl:s,hsv:o,pointer:tIe,onChange:n})),gt.createElement("div",{style:T.body},gt.createElement("div",{style:T.controls,className:"flexbox-fix"},gt.createElement("div",{style:T.color},gt.createElement("div",{style:T.swatch},gt.createElement("div",{style:T.active}),gt.createElement(x_,{renderers:f}))),gt.createElement("div",{style:T.toggles},gt.createElement("div",{style:T.hue},gt.createElement(w_,{style:T.Hue,hsl:s,pointer:eq,onChange:n})),gt.createElement("div",{style:T.alpha},gt.createElement(RN,{style:T.Alpha,rgb:a,hsl:s,pointer:eq,renderers:f,onChange:n})))),gt.createElement(MQ,{rgb:a,hsl:s,hex:c,view:E,onChange:n,disableAlpha:i})))};HN.propTypes={width:Rn.oneOfType([Rn.string,Rn.number]),disableAlpha:Rn.bool,styles:Rn.object,defaultView:Rn.oneOf(["hex","rgb","hsl"])};HN.defaultProps={width:225,disableAlpha:!1,styles:{}};const rIe=Uc(HN);var nIe=function(e){var r=e.color,n=e.onClick,i=n===void 0?function(){}:n,a=e.onSwatchHover,s=e.active,o=Li({default:{color:{background:r,width:"15px",height:"15px",float:"left",marginRight:"5px",marginBottom:"5px",position:"relative",cursor:"pointer"},dot:{absolute:"5px 5px 5px 5px",background:zN(r),borderRadius:"50%",opacity:"0"}},active:{dot:{opacity:"1"}},"color-#FFFFFF":{color:{boxShadow:"inset 0 0 0 1px #ddd"},dot:{background:"#000"}},transparent:{dot:{background:"#000"}}},{active:s,"color-#FFFFFF":r==="#FFFFFF",transparent:r==="transparent"});return gt.createElement(Ry,{style:o.color,color:r,onClick:i,onHover:a,focusStyle:{boxShadow:"0 0 4px "+r}},gt.createElement("div",{style:o.dot}))},iIe=function(e){var r=e.hex,n=e.rgb,i=e.onChange,a=Li({default:{fields:{display:"flex",paddingBottom:"6px",paddingRight:"5px",position:"relative"},active:{position:"absolute",top:"6px",left:"5px",height:"9px",width:"9px",background:r},HEXwrap:{flex:"6",position:"relative"},HEXinput:{width:"80%",padding:"0px",paddingLeft:"20%",border:"none",outline:"none",background:"none",fontSize:"12px",color:"#333",height:"16px"},HEXlabel:{display:"none"},RGBwrap:{flex:"3",position:"relative"},RGBinput:{width:"70%",padding:"0px",paddingLeft:"30%",border:"none",outline:"none",background:"none",fontSize:"12px",color:"#333",height:"16px"},RGBlabel:{position:"absolute",top:"3px",left:"0px",lineHeight:"16px",textTransform:"uppercase",fontSize:"12px",color:"#999"}}}),s=function(c,f){c.r||c.g||c.b?i({r:c.r||n.r,g:c.g||n.g,b:c.b||n.b,source:"rgb"},f):i({hex:c.hex,source:"hex"},f)};return gt.createElement("div",{style:a.fields,className:"flexbox-fix"},gt.createElement("div",{style:a.active}),gt.createElement(ya,{style:{wrap:a.HEXwrap,input:a.HEXinput,label:a.HEXlabel},label:"hex",value:r,onChange:s}),gt.createElement(ya,{style:{wrap:a.RGBwrap,input:a.RGBinput,label:a.RGBlabel},label:"r",value:n.r,onChange:s}),gt.createElement(ya,{style:{wrap:a.RGBwrap,input:a.RGBinput,label:a.RGBlabel},label:"g",value:n.g,onChange:s}),gt.createElement(ya,{style:{wrap:a.RGBwrap,input:a.RGBinput,label:a.RGBlabel},label:"b",value:n.b,onChange:s}))},GN=function(e){var r=e.onChange,n=e.onSwatchHover,i=e.colors,a=e.hex,s=e.rgb,o=e.styles,c=o===void 0?{}:o,f=e.className,d=f===void 0?"":f,m=Li(jc({default:{Compact:{background:"#f6f6f6",radius:"4px"},compact:{paddingTop:"5px",paddingLeft:"5px",boxSizing:"initial",width:"240px"},clear:{clear:"both"}}},c)),b=function(E,T){E.hex?Ug(E.hex)&&r({hex:E.hex,source:"hex"},T):r(E,T)};return gt.createElement(Yx,{style:m.Compact,styles:c},gt.createElement("div",{style:m.compact,className:"compact-picker "+d},gt.createElement("div",null,My(i,function(x){return gt.createElement(nIe,{key:x,color:x,active:x.toLowerCase()===a,onClick:b,onSwatchHover:n})}),gt.createElement("div",{style:m.clear})),gt.createElement(iIe,{hex:a,rgb:s,onChange:b})))};GN.propTypes={colors:Rn.arrayOf(Rn.string),styles:Rn.object};GN.defaultProps={colors:["#4D4D4D","#999999","#FFFFFF","#F44E3B","#FE9200","#FCDC00","#DBDF00","#A4DD00","#68CCCA","#73D8FF","#AEA1FF","#FDA1FF","#333333","#808080","#cccccc","#D33115","#E27300","#FCC400","#B0BC00","#68BC00","#16A5A5","#009CE0","#7B64FF","#FA28FF","#000000","#666666","#B3B3B3","#9F0500","#C45100","#FB9E00","#808900","#194D33","#0C797D","#0062B1","#653294","#AB149E"],styles:{}};Uc(GN);var aIe=function(e){var r=e.hover,n=e.color,i=e.onClick,a=e.onSwatchHover,s={position:"relative",zIndex:"2",outline:"2px solid #fff",boxShadow:"0 0 5px 2px rgba(0,0,0,0.25)"},o=Li({default:{swatch:{width:"25px",height:"25px",fontSize:"0"}},hover:{swatch:s}},{hover:r});return gt.createElement("div",{style:o.swatch},gt.createElement(Ry,{color:n,onClick:i,onHover:a,focusStyle:s}))};const oIe=kN.handleHover(aIe);var WN=function(e){var r=e.width,n=e.colors,i=e.onChange,a=e.onSwatchHover,s=e.triangle,o=e.styles,c=o===void 0?{}:o,f=e.className,d=f===void 0?"":f,m=Li(jc({default:{card:{width:r,background:"#fff",border:"1px solid rgba(0,0,0,0.2)",boxShadow:"0 3px 12px rgba(0,0,0,0.15)",borderRadius:"4px",position:"relative",padding:"5px",display:"flex",flexWrap:"wrap"},triangle:{position:"absolute",border:"7px solid transparent",borderBottomColor:"#fff"},triangleShadow:{position:"absolute",border:"8px solid transparent",borderBottomColor:"rgba(0,0,0,0.15)"}},"hide-triangle":{triangle:{display:"none"},triangleShadow:{display:"none"}},"top-left-triangle":{triangle:{top:"-14px",left:"10px"},triangleShadow:{top:"-16px",left:"9px"}},"top-right-triangle":{triangle:{top:"-14px",right:"10px"},triangleShadow:{top:"-16px",right:"9px"}},"bottom-left-triangle":{triangle:{top:"35px",left:"10px",transform:"rotate(180deg)"},triangleShadow:{top:"37px",left:"9px",transform:"rotate(180deg)"}},"bottom-right-triangle":{triangle:{top:"35px",right:"10px",transform:"rotate(180deg)"},triangleShadow:{top:"37px",right:"9px",transform:"rotate(180deg)"}}},c),{"hide-triangle":s==="hide","top-left-triangle":s==="top-left","top-right-triangle":s==="top-right","bottom-left-triangle":s==="bottom-left","bottom-right-triangle":s==="bottom-right"}),b=function(E,T){return i({hex:E,source:"hex"},T)};return gt.createElement("div",{style:m.card,className:"github-picker "+d},gt.createElement("div",{style:m.triangleShadow}),gt.createElement("div",{style:m.triangle}),My(n,function(x){return gt.createElement(oIe,{color:x,key:x,onClick:b,onSwatchHover:a})}))};WN.propTypes={width:Rn.oneOfType([Rn.string,Rn.number]),colors:Rn.arrayOf(Rn.string),triangle:Rn.oneOf(["hide","top-left","top-right","bottom-left","bottom-right"]),styles:Rn.object};WN.defaultProps={width:200,colors:["#B80000","#DB3E00","#FCCB00","#008B02","#006B76","#1273DE","#004DCF","#5300EB","#EB9694","#FAD0C3","#FEF3BD","#C1E1C5","#BEDADC","#C4DEF6","#BED3F3","#D4C4FB"],triangle:"top-left",styles:{}};Uc(WN);var sIe=function(e){var r=e.direction,n=Li({default:{picker:{width:"18px",height:"18px",borderRadius:"50%",transform:"translate(-9px, -1px)",backgroundColor:"rgb(248, 248, 248)",boxShadow:"0 1px 4px 0 rgba(0, 0, 0, 0.37)"}},vertical:{picker:{transform:"translate(-3px, -9px)"}}},{vertical:r==="vertical"});return gt.createElement("div",{style:n.picker})},lIe=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},XN=function(e){var r=e.width,n=e.height,i=e.onChange,a=e.hsl,s=e.direction,o=e.pointer,c=e.styles,f=c===void 0?{}:c,d=e.className,m=d===void 0?"":d,b=Li(jc({default:{picker:{position:"relative",width:r,height:n},hue:{radius:"2px"}}},f)),x=function(T){return i({a:1,h:T.h,l:.5,s:1})};return gt.createElement("div",{style:b.picker,className:"hue-picker "+m},gt.createElement(w_,lIe({},b.hue,{hsl:a,pointer:o,onChange:x,direction:s})))};XN.propTypes={styles:Rn.object};XN.defaultProps={width:"316px",height:"16px",direction:"horizontal",pointer:sIe,styles:{}};Uc(XN);var uIe=function(e){var r=e.onChange,n=e.hex,i=e.rgb,a=e.styles,s=a===void 0?{}:a,o=e.className,c=o===void 0?"":o,f=Li(jc({default:{material:{width:"98px",height:"98px",padding:"16px",fontFamily:"Roboto"},HEXwrap:{position:"relative"},HEXinput:{width:"100%",marginTop:"12px",fontSize:"15px",color:"#333",padding:"0px",border:"0px",borderBottom:"2px solid "+n,outline:"none",height:"30px"},HEXlabel:{position:"absolute",top:"0px",left:"0px",fontSize:"11px",color:"#999999",textTransform:"capitalize"},Hex:{style:{}},RGBwrap:{position:"relative"},RGBinput:{width:"100%",marginTop:"12px",fontSize:"15px",color:"#333",padding:"0px",border:"0px",borderBottom:"1px solid #eee",outline:"none",height:"30px"},RGBlabel:{position:"absolute",top:"0px",left:"0px",fontSize:"11px",color:"#999999",textTransform:"capitalize"},split:{display:"flex",marginRight:"-10px",paddingTop:"11px"},third:{flex:"1",paddingRight:"10px"}}},s)),d=function(b,x){b.hex?Ug(b.hex)&&r({hex:b.hex,source:"hex"},x):(b.r||b.g||b.b)&&r({r:b.r||i.r,g:b.g||i.g,b:b.b||i.b,source:"rgb"},x)};return gt.createElement(Yx,{styles:s},gt.createElement("div",{style:f.material,className:"material-picker "+c},gt.createElement(ya,{style:{wrap:f.HEXwrap,input:f.HEXinput,label:f.HEXlabel},label:"hex",value:n,onChange:d}),gt.createElement("div",{style:f.split,className:"flexbox-fix"},gt.createElement("div",{style:f.third},gt.createElement(ya,{style:{wrap:f.RGBwrap,input:f.RGBinput,label:f.RGBlabel},label:"r",value:i.r,onChange:d})),gt.createElement("div",{style:f.third},gt.createElement(ya,{style:{wrap:f.RGBwrap,input:f.RGBinput,label:f.RGBlabel},label:"g",value:i.g,onChange:d})),gt.createElement("div",{style:f.third},gt.createElement(ya,{style:{wrap:f.RGBwrap,input:f.RGBinput,label:f.RGBlabel},label:"b",value:i.b,onChange:d})))))};Uc(uIe);var cIe=function(e){var r=e.onChange,n=e.rgb,i=e.hsv,a=e.hex,s=Li({default:{fields:{paddingTop:"5px",paddingBottom:"9px",width:"80px",position:"relative"},divider:{height:"5px"},RGBwrap:{position:"relative"},RGBinput:{marginLeft:"40%",width:"40%",height:"18px",border:"1px solid #888888",boxShadow:"inset 0 1px 1px rgba(0,0,0,.1), 0 1px 0 0 #ECECEC",marginBottom:"5px",fontSize:"13px",paddingLeft:"3px",marginRight:"10px"},RGBlabel:{left:"0px",top:"0px",width:"34px",textTransform:"uppercase",fontSize:"13px",height:"18px",lineHeight:"22px",position:"absolute"},HEXwrap:{position:"relative"},HEXinput:{marginLeft:"20%",width:"80%",height:"18px",border:"1px solid #888888",boxShadow:"inset 0 1px 1px rgba(0,0,0,.1), 0 1px 0 0 #ECECEC",marginBottom:"6px",fontSize:"13px",paddingLeft:"3px"},HEXlabel:{position:"absolute",top:"0px",left:"0px",width:"14px",textTransform:"uppercase",fontSize:"13px",height:"18px",lineHeight:"22px"},fieldSymbols:{position:"absolute",top:"5px",right:"-7px",fontSize:"13px"},symbol:{height:"20px",lineHeight:"22px",paddingBottom:"7px"}}}),o=function(f,d){f["#"]?Ug(f["#"])&&r({hex:f["#"],source:"hex"},d):f.r||f.g||f.b?r({r:f.r||n.r,g:f.g||n.g,b:f.b||n.b,source:"rgb"},d):(f.h||f.s||f.v)&&r({h:f.h||i.h,s:f.s||i.s,v:f.v||i.v,source:"hsv"},d)};return gt.createElement("div",{style:s.fields},gt.createElement(ya,{style:{wrap:s.RGBwrap,input:s.RGBinput,label:s.RGBlabel},label:"h",value:Math.round(i.h),onChange:o}),gt.createElement(ya,{style:{wrap:s.RGBwrap,input:s.RGBinput,label:s.RGBlabel},label:"s",value:Math.round(i.s*100),onChange:o}),gt.createElement(ya,{style:{wrap:s.RGBwrap,input:s.RGBinput,label:s.RGBlabel},label:"v",value:Math.round(i.v*100),onChange:o}),gt.createElement("div",{style:s.divider}),gt.createElement(ya,{style:{wrap:s.RGBwrap,input:s.RGBinput,label:s.RGBlabel},label:"r",value:n.r,onChange:o}),gt.createElement(ya,{style:{wrap:s.RGBwrap,input:s.RGBinput,label:s.RGBlabel},label:"g",value:n.g,onChange:o}),gt.createElement(ya,{style:{wrap:s.RGBwrap,input:s.RGBinput,label:s.RGBlabel},label:"b",value:n.b,onChange:o}),gt.createElement("div",{style:s.divider}),gt.createElement(ya,{style:{wrap:s.HEXwrap,input:s.HEXinput,label:s.HEXlabel},label:"#",value:a.replace("#",""),onChange:o}),gt.createElement("div",{style:s.fieldSymbols},gt.createElement("div",{style:s.symbol},""),gt.createElement("div",{style:s.symbol},"%"),gt.createElement("div",{style:s.symbol},"%")))},fIe=function(e){var r=e.hsl,n=Li({default:{picker:{width:"12px",height:"12px",borderRadius:"6px",boxShadow:"inset 0 0 0 1px #fff",transform:"translate(-6px, -6px)"}},"black-outline":{picker:{boxShadow:"inset 0 0 0 1px #000"}}},{"black-outline":r.l>.5});return gt.createElement("div",{style:n.picker})},hIe=function(){var e=Li({default:{triangle:{width:0,height:0,borderStyle:"solid",borderWidth:"4px 0 4px 6px",borderColor:"transparent transparent transparent #fff",position:"absolute",top:"1px",left:"1px"},triangleBorder:{width:0,height:0,borderStyle:"solid",borderWidth:"5px 0 5px 8px",borderColor:"transparent transparent transparent #555"},left:{Extend:"triangleBorder",transform:"translate(-13px, -4px)"},leftInside:{Extend:"triangle",transform:"translate(-8px, -5px)"},right:{Extend:"triangleBorder",transform:"translate(20px, -14px) rotate(180deg)"},rightInside:{Extend:"triangle",transform:"translate(-8px, -5px)"}}});return gt.createElement("div",{style:e.pointer},gt.createElement("div",{style:e.left},gt.createElement("div",{style:e.leftInside})),gt.createElement("div",{style:e.right},gt.createElement("div",{style:e.rightInside})))},tq=function(e){var r=e.onClick,n=e.label,i=e.children,a=e.active,s=Li({default:{button:{backgroundImage:"linear-gradient(-180deg, #FFFFFF 0%, #E6E6E6 100%)",border:"1px solid #878787",borderRadius:"2px",height:"20px",boxShadow:"0 1px 0 0 #EAEAEA",fontSize:"14px",color:"#000",lineHeight:"20px",textAlign:"center",marginBottom:"10px",cursor:"pointer"}},active:{button:{boxShadow:"0 0 0 1px #878787"}}},{active:a});return gt.createElement("div",{style:s.button,onClick:r},n||i)},dIe=function(e){var r=e.rgb,n=e.currentColor,i=Li({default:{swatches:{border:"1px solid #B3B3B3",borderBottom:"1px solid #F0F0F0",marginBottom:"2px",marginTop:"1px"},new:{height:"34px",background:"rgb("+r.r+","+r.g+", "+r.b+")",boxShadow:"inset 1px 0 0 #000, inset -1px 0 0 #000, inset 0 1px 0 #000"},current:{height:"34px",background:n,boxShadow:"inset 1px 0 0 #000, inset -1px 0 0 #000, inset 0 -1px 0 #000"},label:{fontSize:"14px",color:"#000",textAlign:"center"}}});return gt.createElement("div",null,gt.createElement("div",{style:i.label},"new"),gt.createElement("div",{style:i.swatches},gt.createElement("div",{style:i.new}),gt.createElement("div",{style:i.current})),gt.createElement("div",{style:i.label},"current"))},pIe=(function(){function t(e,r){for(var n=0;n<r.length;n++){var i=r[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}})();function gIe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function mIe(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e&&(typeof e=="object"||typeof e=="function")?e:t}function yIe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var YN=(function(t){yIe(e,t);function e(r){gIe(this,e);var n=mIe(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return n.state={currentColor:r.hex},n}return pIe(e,[{key:"render",value:function(){var n=this.props,i=n.styles,a=i===void 0?{}:i,s=n.className,o=s===void 0?"":s,c=Li(jc({default:{picker:{background:"#DCDCDC",borderRadius:"4px",boxShadow:"0 0 0 1px rgba(0,0,0,.25), 0 8px 16px rgba(0,0,0,.15)",boxSizing:"initial",width:"513px"},head:{backgroundImage:"linear-gradient(-180deg, #F0F0F0 0%, #D4D4D4 100%)",borderBottom:"1px solid #B1B1B1",boxShadow:"inset 0 1px 0 0 rgba(255,255,255,.2), inset 0 -1px 0 0 rgba(0,0,0,.02)",height:"23px",lineHeight:"24px",borderRadius:"4px 4px 0 0",fontSize:"13px",color:"#4D4D4D",textAlign:"center"},body:{padding:"15px 15px 0",display:"flex"},saturation:{width:"256px",height:"256px",position:"relative",border:"2px solid #B3B3B3",borderBottom:"2px solid #F0F0F0",overflow:"hidden"},hue:{position:"relative",height:"256px",width:"19px",marginLeft:"10px",border:"2px solid #B3B3B3",borderBottom:"2px solid #F0F0F0"},controls:{width:"180px",marginLeft:"10px"},top:{display:"flex"},previews:{width:"60px"},actions:{flex:"1",marginLeft:"20px"}}},a));return gt.createElement("div",{style:c.picker,className:"photoshop-picker "+o},gt.createElement("div",{style:c.head},this.props.header),gt.createElement("div",{style:c.body,className:"flexbox-fix"},gt.createElement("div",{style:c.saturation},gt.createElement(I3,{hsl:this.props.hsl,hsv:this.props.hsv,pointer:fIe,onChange:this.props.onChange})),gt.createElement("div",{style:c.hue},gt.createElement(w_,{direction:"vertical",hsl:this.props.hsl,pointer:hIe,onChange:this.props.onChange})),gt.createElement("div",{style:c.controls},gt.createElement("div",{style:c.top,className:"flexbox-fix"},gt.createElement("div",{style:c.previews},gt.createElement(dIe,{rgb:this.props.rgb,currentColor:this.state.currentColor})),gt.createElement("div",{style:c.actions},gt.createElement(tq,{label:"OK",onClick:this.props.onAccept,active:!0}),gt.createElement(tq,{label:"Cancel",onClick:this.props.onCancel}),gt.createElement(cIe,{onChange:this.props.onChange,rgb:this.props.rgb,hsv:this.props.hsv,hex:this.props.hex}))))))}}]),e})(gt.Component);YN.propTypes={header:Rn.string,styles:Rn.object};YN.defaultProps={header:"Color Picker",styles:{}};Uc(YN);var vIe=function(e){var r=e.onChange,n=e.rgb,i=e.hsl,a=e.hex,s=e.disableAlpha,o=Li({default:{fields:{display:"flex",paddingTop:"4px"},single:{flex:"1",paddingLeft:"6px"},alpha:{flex:"1",paddingLeft:"6px"},double:{flex:"2"},input:{width:"80%",padding:"4px 10% 3px",border:"none",boxShadow:"inset 0 0 0 1px #ccc",fontSize:"11px"},label:{display:"block",textAlign:"center",fontSize:"11px",color:"#222",paddingTop:"3px",paddingBottom:"4px",textTransform:"capitalize"}},disableAlpha:{alpha:{display:"none"}}},{disableAlpha:s}),c=function(d,m){d.hex?Ug(d.hex)&&r({hex:d.hex,source:"hex"},m):d.r||d.g||d.b?r({r:d.r||n.r,g:d.g||n.g,b:d.b||n.b,a:n.a,source:"rgb"},m):d.a&&(d.a<0?d.a=0:d.a>100&&(d.a=100),d.a/=100,r({h:i.h,s:i.s,l:i.l,a:d.a,source:"rgb"},m))};return gt.createElement("div",{style:o.fields,className:"flexbox-fix"},gt.createElement("div",{style:o.double},gt.createElement(ya,{style:{input:o.input,label:o.label},label:"hex",value:a.replace("#",""),onChange:c})),gt.createElement("div",{style:o.single},gt.createElement(ya,{style:{input:o.input,label:o.label},label:"r",value:n.r,onChange:c,dragLabel:"true",dragMax:"255"})),gt.createElement("div",{style:o.single},gt.createElement(ya,{style:{input:o.input,label:o.label},label:"g",value:n.g,onChange:c,dragLabel:"true",dragMax:"255"})),gt.createElement("div",{style:o.single},gt.createElement(ya,{style:{input:o.input,label:o.label},label:"b",value:n.b,onChange:c,dragLabel:"true",dragMax:"255"})),gt.createElement("div",{style:o.alpha},gt.createElement(ya,{style:{input:o.input,label:o.label},label:"a",value:Math.round(n.a*100),onChange:c,dragLabel:"true",dragMax:"100"})))},_Ie=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},DQ=function(e){var r=e.colors,n=e.onClick,i=n===void 0?function(){}:n,a=e.onSwatchHover,s=Li({default:{colors:{margin:"0 -10px",padding:"10px 0 0 10px",borderTop:"1px solid #eee",display:"flex",flexWrap:"wrap",position:"relative"},swatchWrap:{width:"16px",height:"16px",margin:"0 10px 10px 0"},swatch:{borderRadius:"3px",boxShadow:"inset 0 0 0 1px rgba(0,0,0,.15)"}},"no-presets":{colors:{display:"none"}}},{"no-presets":!r||!r.length}),o=function(f,d){i({hex:f,source:"hex"},d)};return gt.createElement("div",{style:s.colors,className:"flexbox-fix"},r.map(function(c){var f=typeof c=="string"?{color:c}:c,d=""+f.color+(f.title||"");return gt.createElement("div",{key:d,style:s.swatchWrap},gt.createElement(Ry,_Ie({},f,{style:s.swatch,onClick:o,onHover:a,focusStyle:{boxShadow:"inset 0 0 0 1px rgba(0,0,0,.15), 0 0 4px "+f.color}})))}))};DQ.propTypes={colors:Rn.arrayOf(Rn.oneOfType([Rn.string,Rn.shape({color:Rn.string,title:Rn.string})])).isRequired};var bIe=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},ZN=function(e){var r=e.width,n=e.rgb,i=e.hex,a=e.hsv,s=e.hsl,o=e.onChange,c=e.onSwatchHover,f=e.disableAlpha,d=e.presetColors,m=e.renderers,b=e.styles,x=b===void 0?{}:b,E=e.className,T=E===void 0?"":E,A=Li(jc({default:bIe({picker:{width:r,padding:"10px 10px 0",boxSizing:"initial",background:"#fff",borderRadius:"4px",boxShadow:"0 0 0 1px rgba(0,0,0,.15), 0 8px 16px rgba(0,0,0,.15)"},saturation:{width:"100%",paddingBottom:"75%",position:"relative",overflow:"hidden"},Saturation:{radius:"3px",shadow:"inset 0 0 0 1px rgba(0,0,0,.15), inset 0 0 4px rgba(0,0,0,.25)"},controls:{display:"flex"},sliders:{padding:"4px 0",flex:"1"},color:{width:"24px",height:"24px",position:"relative",marginTop:"4px",marginLeft:"4px",borderRadius:"3px"},activeColor:{absolute:"0px 0px 0px 0px",borderRadius:"2px",background:"rgba("+n.r+","+n.g+","+n.b+","+n.a+")",boxShadow:"inset 0 0 0 1px rgba(0,0,0,.15), inset 0 0 4px rgba(0,0,0,.25)"},hue:{position:"relative",height:"10px",overflow:"hidden"},Hue:{radius:"2px",shadow:"inset 0 0 0 1px rgba(0,0,0,.15), inset 0 0 4px rgba(0,0,0,.25)"},alpha:{position:"relative",height:"10px",marginTop:"4px",overflow:"hidden"},Alpha:{radius:"2px",shadow:"inset 0 0 0 1px rgba(0,0,0,.15), inset 0 0 4px rgba(0,0,0,.25)"}},x),disableAlpha:{color:{height:"10px"},hue:{height:"10px"},alpha:{display:"none"}}},x),{disableAlpha:f});return gt.createElement("div",{style:A.picker,className:"sketch-picker "+T},gt.createElement("div",{style:A.saturation},gt.createElement(I3,{style:A.Saturation,hsl:s,hsv:a,onChange:o})),gt.createElement("div",{style:A.controls,className:"flexbox-fix"},gt.createElement("div",{style:A.sliders},gt.createElement("div",{style:A.hue},gt.createElement(w_,{style:A.Hue,hsl:s,onChange:o})),gt.createElement("div",{style:A.alpha},gt.createElement(RN,{style:A.Alpha,rgb:n,hsl:s,renderers:m,onChange:o}))),gt.createElement("div",{style:A.color},gt.createElement(x_,null),gt.createElement("div",{style:A.activeColor}))),gt.createElement(vIe,{rgb:n,hsl:s,hex:i,onChange:o,disableAlpha:f}),gt.createElement(DQ,{colors:d,onClick:o,onSwatchHover:c}))};ZN.propTypes={disableAlpha:Rn.bool,width:Rn.oneOfType([Rn.string,Rn.number]),styles:Rn.object};ZN.defaultProps={disableAlpha:!1,width:200,styles:{},presetColors:["#D0021B","#F5A623","#F8E71C","#8B572A","#7ED321","#417505","#BD10E0","#9013FE","#4A90E2","#50E3C2","#B8E986","#000000","#4A4A4A","#9B9B9B","#FFFFFF"]};Uc(ZN);var h1=function(e){var r=e.hsl,n=e.offset,i=e.onClick,a=i===void 0?function(){}:i,s=e.active,o=e.first,c=e.last,f=Li({default:{swatch:{height:"12px",background:"hsl("+r.h+", 50%, "+n*100+"%)",cursor:"pointer"}},first:{swatch:{borderRadius:"2px 0 0 2px"}},last:{swatch:{borderRadius:"0 2px 2px 0"}},active:{swatch:{transform:"scaleY(1.8)",borderRadius:"3.6px/2px"}}},{active:s,first:o,last:c}),d=function(b){return a({h:r.h,s:.5,l:n,source:"hsl"},b)};return gt.createElement("div",{style:f.swatch,onClick:d})},xIe=function(e){var r=e.onClick,n=e.hsl,i=Li({default:{swatches:{marginTop:"20px"},swatch:{boxSizing:"border-box",width:"20%",paddingRight:"1px",float:"left"},clear:{clear:"both"}}}),a=.1;return gt.createElement("div",{style:i.swatches},gt.createElement("div",{style:i.swatch},gt.createElement(h1,{hsl:n,offset:".80",active:Math.abs(n.l-.8)<a&&Math.abs(n.s-.5)<a,onClick:r,first:!0})),gt.createElement("div",{style:i.swatch},gt.createElement(h1,{hsl:n,offset:".65",active:Math.abs(n.l-.65)<a&&Math.abs(n.s-.5)<a,onClick:r})),gt.createElement("div",{style:i.swatch},gt.createElement(h1,{hsl:n,offset:".50",active:Math.abs(n.l-.5)<a&&Math.abs(n.s-.5)<a,onClick:r})),gt.createElement("div",{style:i.swatch},gt.createElement(h1,{hsl:n,offset:".35",active:Math.abs(n.l-.35)<a&&Math.abs(n.s-.5)<a,onClick:r})),gt.createElement("div",{style:i.swatch},gt.createElement(h1,{hsl:n,offset:".20",active:Math.abs(n.l-.2)<a&&Math.abs(n.s-.5)<a,onClick:r,last:!0})),gt.createElement("div",{style:i.clear}))},wIe=function(){var e=Li({default:{picker:{width:"14px",height:"14px",borderRadius:"6px",transform:"translate(-7px, -1px)",backgroundColor:"rgb(248, 248, 248)",boxShadow:"0 1px 4px 0 rgba(0, 0, 0, 0.37)"}}});return gt.createElement("div",{style:e.picker})},KN=function(e){var r=e.hsl,n=e.onChange,i=e.pointer,a=e.styles,s=a===void 0?{}:a,o=e.className,c=o===void 0?"":o,f=Li(jc({default:{hue:{height:"12px",position:"relative"},Hue:{radius:"2px"}}},s));return gt.createElement("div",{style:f.wrap||{},className:"slider-picker "+c},gt.createElement("div",{style:f.hue},gt.createElement(w_,{style:f.Hue,hsl:r,pointer:i,onChange:n})),gt.createElement("div",{style:f.swatches},gt.createElement(xIe,{hsl:r,onClick:n})))};KN.propTypes={styles:Rn.object};KN.defaultProps={pointer:wIe,styles:{}};Uc(KN);var Ow={},rq;function SIe(){if(rq)return Ow;rq=1,Object.defineProperty(Ow,"__esModule",{value:!0});var t=Object.assign||function(s){for(var o=1;o<arguments.length;o++){var c=arguments[o];for(var f in c)Object.prototype.hasOwnProperty.call(c,f)&&(s[f]=c[f])}return s},e=wx(),r=n(e);function n(s){return s&&s.__esModule?s:{default:s}}function i(s,o){var c={};for(var f in s)o.indexOf(f)>=0||Object.prototype.hasOwnProperty.call(s,f)&&(c[f]=s[f]);return c}var a=24;return Ow.default=function(s){var o=s.fill,c=o===void 0?"currentColor":o,f=s.width,d=f===void 0?a:f,m=s.height,b=m===void 0?a:m,x=s.style,E=x===void 0?{}:x,T=i(s,["fill","width","height","style"]);return r.default.createElement("svg",t({viewBox:"0 0 "+a+" "+a,style:t({fill:c,width:d,height:b},E)},T),r.default.createElement("path",{d:"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"}))},Ow}var EIe=SIe();const TIe=Id(EIe);var CIe=function(e){var r=e.color,n=e.onClick,i=n===void 0?function(){}:n,a=e.onSwatchHover,s=e.first,o=e.last,c=e.active,f=Li({default:{color:{width:"40px",height:"24px",cursor:"pointer",background:r,marginBottom:"1px"},check:{color:zN(r),marginLeft:"8px",display:"none"}},first:{color:{overflow:"hidden",borderRadius:"2px 2px 0 0"}},last:{color:{overflow:"hidden",borderRadius:"0 0 2px 2px"}},active:{check:{display:"block"}},"color-#FFFFFF":{color:{boxShadow:"inset 0 0 0 1px #ddd"},check:{color:"#333"}},transparent:{check:{color:"#333"}}},{first:s,last:o,active:c,"color-#FFFFFF":r==="#FFFFFF",transparent:r==="transparent"});return gt.createElement(Ry,{color:r,style:f.color,onClick:i,onHover:a,focusStyle:{boxShadow:"0 0 4px "+r}},gt.createElement("div",{style:f.check},gt.createElement(TIe,null)))},AIe=function(e){var r=e.onClick,n=e.onSwatchHover,i=e.group,a=e.active,s=Li({default:{group:{paddingBottom:"10px",width:"40px",float:"left",marginRight:"10px"}}});return gt.createElement("div",{style:s.group},My(i,function(o,c){return gt.createElement(CIe,{key:o,color:o,active:o.toLowerCase()===a,first:c===0,last:c===i.length-1,onClick:r,onSwatchHover:n})}))},JN=function(e){var r=e.width,n=e.height,i=e.onChange,a=e.onSwatchHover,s=e.colors,o=e.hex,c=e.styles,f=c===void 0?{}:c,d=e.className,m=d===void 0?"":d,b=Li(jc({default:{picker:{width:r,height:n},overflow:{height:n,overflowY:"scroll"},body:{padding:"16px 0 6px 16px"},clear:{clear:"both"}}},f)),x=function(T,A){return i({hex:T,source:"hex"},A)};return gt.createElement("div",{style:b.picker,className:"swatches-picker "+m},gt.createElement(Yx,null,gt.createElement("div",{style:b.overflow},gt.createElement("div",{style:b.body},My(s,function(E){return gt.createElement(AIe,{key:E.toString(),group:E,active:o,onClick:x,onSwatchHover:a})}),gt.createElement("div",{style:b.clear})))))};JN.propTypes={width:Rn.oneOfType([Rn.string,Rn.number]),height:Rn.oneOfType([Rn.string,Rn.number]),colors:Rn.arrayOf(Rn.arrayOf(Rn.string)),styles:Rn.object};JN.defaultProps={width:320,height:240,colors:[[Uv[900],Uv[700],Uv[500],Uv[300],Uv[100]],[Vv[900],Vv[700],Vv[500],Vv[300],Vv[100]],[$v[900],$v[700],$v[500],$v[300],$v[100]],[qv[900],qv[700],qv[500],qv[300],qv[100]],[Hv[900],Hv[700],Hv[500],Hv[300],Hv[100]],[Gv[900],Gv[700],Gv[500],Gv[300],Gv[100]],[Wv[900],Wv[700],Wv[500],Wv[300],Wv[100]],[Xv[900],Xv[700],Xv[500],Xv[300],Xv[100]],[Yv[900],Yv[700],Yv[500],Yv[300],Yv[100]],["#194D33",G1[700],G1[500],G1[300],G1[100]],[Zv[900],Zv[700],Zv[500],Zv[300],Zv[100]],[Kv[900],Kv[700],Kv[500],Kv[300],Kv[100]],[Jv[900],Jv[700],Jv[500],Jv[300],Jv[100]],[Qv[900],Qv[700],Qv[500],Qv[300],Qv[100]],[e0[900],e0[700],e0[500],e0[300],e0[100]],[t0[900],t0[700],t0[500],t0[300],t0[100]],[r0[900],r0[700],r0[500],r0[300],r0[100]],[n0[900],n0[700],n0[500],n0[300],n0[100]],["#000000","#525252","#969696","#D9D9D9","#FFFFFF"]],styles:{}};Uc(JN);var QN=function(e){var r=e.onChange,n=e.onSwatchHover,i=e.hex,a=e.colors,s=e.width,o=e.triangle,c=e.styles,f=c===void 0?{}:c,d=e.className,m=d===void 0?"":d,b=Li(jc({default:{card:{width:s,background:"#fff",border:"0 solid rgba(0,0,0,0.25)",boxShadow:"0 1px 4px rgba(0,0,0,0.25)",borderRadius:"4px",position:"relative"},body:{padding:"15px 9px 9px 15px"},label:{fontSize:"18px",color:"#fff"},triangle:{width:"0px",height:"0px",borderStyle:"solid",borderWidth:"0 9px 10px 9px",borderColor:"transparent transparent #fff transparent",position:"absolute"},triangleShadow:{width:"0px",height:"0px",borderStyle:"solid",borderWidth:"0 9px 10px 9px",borderColor:"transparent transparent rgba(0,0,0,.1) transparent",position:"absolute"},hash:{background:"#F0F0F0",height:"30px",width:"30px",borderRadius:"4px 0 0 4px",float:"left",color:"#98A1A4",display:"flex",alignItems:"center",justifyContent:"center"},input:{width:"100px",fontSize:"14px",color:"#666",border:"0px",outline:"none",height:"28px",boxShadow:"inset 0 0 0 1px #F0F0F0",boxSizing:"content-box",borderRadius:"0 4px 4px 0",float:"left",paddingLeft:"8px"},swatch:{width:"30px",height:"30px",float:"left",borderRadius:"4px",margin:"0 6px 6px 0"},clear:{clear:"both"}},"hide-triangle":{triangle:{display:"none"},triangleShadow:{display:"none"}},"top-left-triangle":{triangle:{top:"-10px",left:"12px"},triangleShadow:{top:"-11px",left:"12px"}},"top-right-triangle":{triangle:{top:"-10px",right:"12px"},triangleShadow:{top:"-11px",right:"12px"}}},f),{"hide-triangle":o==="hide","top-left-triangle":o==="top-left","top-right-triangle":o==="top-right"}),x=function(T,A){Ug(T)&&r({hex:T,source:"hex"},A)};return gt.createElement("div",{style:b.card,className:"twitter-picker "+m},gt.createElement("div",{style:b.triangleShadow}),gt.createElement("div",{style:b.triangle}),gt.createElement("div",{style:b.body},My(a,function(E,T){return gt.createElement(Ry,{key:T,color:E,hex:E,style:b.swatch,onClick:x,onHover:n,focusStyle:{boxShadow:"0 0 4px "+E}})}),gt.createElement("div",{style:b.hash},"#"),gt.createElement(ya,{label:null,style:{input:b.input},value:i.replace("#",""),onChange:x}),gt.createElement("div",{style:b.clear})))};QN.propTypes={width:Rn.oneOfType([Rn.string,Rn.number]),triangle:Rn.oneOf(["hide","top-left","top-right"]),colors:Rn.arrayOf(Rn.string),styles:Rn.object};QN.defaultProps={width:276,colors:["#FF6900","#FCB900","#7BDCB5","#00D084","#8ED1FC","#0693E3","#ABB8C3","#EB144C","#F78DA7","#9900EF"],triangle:"top-left",styles:{}};Uc(QN);var eL=function(e){var r=Li({default:{picker:{width:"20px",height:"20px",borderRadius:"22px",border:"2px #fff solid",transform:"translate(-12px, -13px)",background:"hsl("+Math.round(e.hsl.h)+", "+Math.round(e.hsl.s*100)+"%, "+Math.round(e.hsl.l*100)+"%)"}}});return gt.createElement("div",{style:r.picker})};eL.propTypes={hsl:Rn.shape({h:Rn.number,s:Rn.number,l:Rn.number,a:Rn.number})};eL.defaultProps={hsl:{a:1,h:249.94,l:.2,s:.5}};var tL=function(e){var r=Li({default:{picker:{width:"20px",height:"20px",borderRadius:"22px",transform:"translate(-10px, -7px)",background:"hsl("+Math.round(e.hsl.h)+", 100%, 50%)",border:"2px white solid"}}});return gt.createElement("div",{style:r.picker})};tL.propTypes={hsl:Rn.shape({h:Rn.number,s:Rn.number,l:Rn.number,a:Rn.number})};tL.defaultProps={hsl:{a:1,h:249.94,l:.2,s:.5}};var IIe=function(e){var r=e.onChange,n=e.rgb,i=e.hsl,a=e.hex,s=e.hsv,o=function(x,E){if(x.hex)Ug(x.hex)&&r({hex:x.hex,source:"hex"},E);else if(x.rgb){var T=x.rgb.split(",");iP(x.rgb,"rgb")&&r({r:T[0],g:T[1],b:T[2],a:1,source:"rgb"},E)}else if(x.hsv){var A=x.hsv.split(",");iP(x.hsv,"hsv")&&(A[2]=A[2].replace("%",""),A[1]=A[1].replace("%",""),A[0]=A[0].replace("",""),A[1]==1?A[1]=.01:A[2]==1&&(A[2]=.01),r({h:Number(A[0]),s:Number(A[1]),v:Number(A[2]),source:"hsv"},E))}else if(x.hsl){var M=x.hsl.split(",");iP(x.hsl,"hsl")&&(M[2]=M[2].replace("%",""),M[1]=M[1].replace("%",""),M[0]=M[0].replace("",""),m[1]==1?m[1]=.01:m[2]==1&&(m[2]=.01),r({h:Number(M[0]),s:Number(M[1]),v:Number(M[2]),source:"hsl"},E))}},c=Li({default:{wrap:{display:"flex",height:"100px",marginTop:"4px"},fields:{width:"100%"},column:{paddingTop:"10px",display:"flex",justifyContent:"space-between"},double:{padding:"0px 4.4px",boxSizing:"border-box"},input:{width:"100%",height:"38px",boxSizing:"border-box",padding:"4px 10% 3px",textAlign:"center",border:"1px solid #dadce0",fontSize:"11px",textTransform:"lowercase",borderRadius:"5px",outline:"none",fontFamily:"Roboto,Arial,sans-serif"},input2:{height:"38px",width:"100%",border:"1px solid #dadce0",boxSizing:"border-box",fontSize:"11px",textTransform:"lowercase",borderRadius:"5px",outline:"none",paddingLeft:"10px",fontFamily:"Roboto,Arial,sans-serif"},label:{textAlign:"center",fontSize:"12px",background:"#fff",position:"absolute",textTransform:"uppercase",color:"#3c4043",width:"35px",top:"-6px",left:"0",right:"0",marginLeft:"auto",marginRight:"auto",fontFamily:"Roboto,Arial,sans-serif"},label2:{left:"10px",textAlign:"center",fontSize:"12px",background:"#fff",position:"absolute",textTransform:"uppercase",color:"#3c4043",width:"32px",top:"-6px",fontFamily:"Roboto,Arial,sans-serif"},single:{flexGrow:"1",margin:"0px 4.4px"}}}),f=n.r+", "+n.g+", "+n.b,d=Math.round(i.h)+", "+Math.round(i.s*100)+"%, "+Math.round(i.l*100)+"%",m=Math.round(s.h)+", "+Math.round(s.s*100)+"%, "+Math.round(s.v*100)+"%";return gt.createElement("div",{style:c.wrap,className:"flexbox-fix"},gt.createElement("div",{style:c.fields},gt.createElement("div",{style:c.double},gt.createElement(ya,{style:{input:c.input,label:c.label},label:"hex",value:a,onChange:o})),gt.createElement("div",{style:c.column},gt.createElement("div",{style:c.single},gt.createElement(ya,{style:{input:c.input2,label:c.label2},label:"rgb",value:f,onChange:o})),gt.createElement("div",{style:c.single},gt.createElement(ya,{style:{input:c.input2,label:c.label2},label:"hsv",value:m,onChange:o})),gt.createElement("div",{style:c.single},gt.createElement(ya,{style:{input:c.input2,label:c.label2},label:"hsl",value:d,onChange:o})))))},rL=function(e){var r=e.width,n=e.onChange,i=e.rgb,a=e.hsl,s=e.hsv,o=e.hex,c=e.header,f=e.styles,d=f===void 0?{}:f,m=e.className,b=m===void 0?"":m,x=Li(jc({default:{picker:{width:r,background:"#fff",border:"1px solid #dfe1e5",boxSizing:"initial",display:"flex",flexWrap:"wrap",borderRadius:"8px 8px 0px 0px"},head:{height:"57px",width:"100%",paddingTop:"16px",paddingBottom:"16px",paddingLeft:"16px",fontSize:"20px",boxSizing:"border-box",fontFamily:"Roboto-Regular,HelveticaNeue,Arial,sans-serif"},saturation:{width:"70%",padding:"0px",position:"relative",overflow:"hidden"},swatch:{width:"30%",height:"228px",padding:"0px",background:"rgba("+i.r+", "+i.g+", "+i.b+", 1)",position:"relative",overflow:"hidden"},body:{margin:"auto",width:"95%"},controls:{display:"flex",boxSizing:"border-box",height:"52px",paddingTop:"22px"},color:{width:"32px"},hue:{height:"8px",position:"relative",margin:"0px 16px 0px 16px",width:"100%"},Hue:{radius:"2px"}}},d));return gt.createElement("div",{style:x.picker,className:"google-picker "+b},gt.createElement("div",{style:x.head},c),gt.createElement("div",{style:x.swatch}),gt.createElement("div",{style:x.saturation},gt.createElement(I3,{hsl:a,hsv:s,pointer:eL,onChange:n})),gt.createElement("div",{style:x.body},gt.createElement("div",{style:x.controls,className:"flexbox-fix"},gt.createElement("div",{style:x.hue},gt.createElement(w_,{style:x.Hue,hsl:a,radius:"4px",pointer:tL,onChange:n}))),gt.createElement(IIe,{rgb:i,hsl:a,hex:o,hsv:s,onChange:n})))};rL.propTypes={width:Rn.oneOfType([Rn.string,Rn.number]),styles:Rn.object,header:Rn.string};rL.defaultProps={width:652,styles:{},header:"Color picker"};Uc(rL);const W1={rgba:t=>`rgba(${t.rgb.r}, ${t.rgb.g}, ${t.rgb.b}, ${t.rgb.a})`,rgb:t=>`rgb(${t.rgb.r}, ${t.rgb.g}, ${t.rgb.b})`,hex:t=>t.hex,rgba_rgb:t=>t.rgb.a===1?W1.rgb(t):W1.rgba(t),rgba_hex:t=>t.rgb.a===1?W1.hex(t):W1.rgba(t)},rx=({convert:t,...e})=>{const[r,n]=te.useState(!1),i=e?.value||"";return J.jsxs(J.Fragment,{children:[J.jsx(hp,{container:!0,sx:{flexWrap:"nowrap"},children:J.jsx(hp,{size:12,children:J.jsxs(ta,{variant:"outlined",onClick:()=>n(!0),sx:{minWidth:"100%",padding:"5px",marginBottom:"10px",justifyContent:"flex-start",borderColor:a=>a.palette.text.primary,color:a=>a.palette.text.primary},children:[J.jsx("div",{style:{width:"25px",height:"25px",marginRight:"10px",backgroundColor:i}}),i]})})}),r&&J.jsx("div",{style:{position:"relative",marginTop:0},children:J.jsxs("div",{style:{position:"absolute",zIndex:1e3},children:[J.jsx("div",{style:{position:"fixed",top:"0px",right:"0px",bottom:"0px",left:"0px"},onClick:()=>{n(!1)}}),J.jsx(rIe,{color:i,onChange:a=>{const s=W1[t](a);e?.onChange?.(s)}})]})})]})};rx.defaultProps={convert:"rgba_hex",label:"Color",name:"color"};try{rx.displayName="ColorPicker",rx.__docgenInfo={description:"",displayName:"ColorPicker",props:{onChange:{defaultValue:null,description:"",name:"onChange",required:!1,type:{name:"((value: string) => void) | undefined"}},convert:{defaultValue:{value:"rgba_hex"},description:"",name:"convert",required:!1,type:{name:"enum",value:[{value:'"rgb"'},{value:'"rgba"'},{value:'"rgba_hex"'},{value:'"hex"'},{value:'"rgba_rgb"'}]}},value:{defaultValue:null,description:"",name:"value",required:!1,type:{name:"string | undefined"}}}}}catch{}function JR({propKey:t,value:e,setPaintProps:r}){return J.jsx(rx,{value:e,label:"Color",onChange:n=>{r(i=>({...i,[t]:n}))}})}try{JR.displayName="PaintPropsColorPicker",JR.__docgenInfo={description:"",displayName:"PaintPropsColorPicker",props:{key:{defaultValue:null,description:"",name:"key",required:!0,type:{name:"string"}},value:{defaultValue:null,description:"",name:"value",required:!0,type:{name:"string"}},propKey:{defaultValue:null,description:"",name:"propKey",required:!0,type:{name:"string"}},setPaintProps:{defaultValue:null,description:"",name:"setPaintProps",required:!0,type:{name:"(paintProps: paintPropsType | ((current: paintPropsType) => paintPropsType)) => void"}}}}}catch{}const PIe=Dr(hf)({marginLeft:"-100px",marginRight:"-21px",paddingLeft:"53px",borderRadius:"0px",boxShadow:"none",backgroundColor:"rgb(0, 0, 0, 0)"}),kIe=Dr(Bo)({marginLeft:"61px"}),OQ={"circle-color":"colorpicker","circle-radius":"slider","circle-stroke-color":"colorpicker","circle-stroke-width":"slider","fill-color":"colorpicker","fill-outline-color":"colorpicker","line-color":"colorpicker","line-width":"slider","line-blur":"slider"},RIe=Object.keys(OQ),MIe={"circle-stroke-width":{step:1,min:1,max:20},"circle-radius":{step:1,min:1,max:100},"line-blur":{step:1,min:1,max:100},"line-width":{step:1,min:1,max:100}};function IE({paintProps:t={},setPaintProps:e}){const r=te.useRef(Math.round(Math.random()*1e10)),n=te.useCallback(i=>{if(RIe.indexOf(i)!==-1&&(typeof t[i]=="number"||typeof t[i]=="string")){const a=J.jsx(Ss,{id:i+"_label",gutterBottom:!0,children:i});switch(OQ[i]){case"slider":return J.jsxs(gt.Fragment,{children:[a,J.jsx(mO,{...MIe[i],value:t[i],valueLabelDisplay:"auto",onChange:(s,o)=>{o&&e(c=>({...c,[i]:o}))}})]},i);case"numberfield":return J.jsxs(gt.Fragment,{children:[a,J.jsx(e3,{inputProps:{inputMode:"decimal",pattern:"[0-9]*"},value:t[i],onChange:s=>{s?.target?.value&&e(o=>({...o,[i]:parseInt(s.target.value)}))}})]},i);case"colorpicker":return J.jsxs(gt.Fragment,{children:[a,J.jsx(Bo,{sx:{"& > div":{width:"initial !important"}},children:J.jsx(JR,{value:t[i],propKey:i,setPaintProps:e},i)})]},i)}}return null},[t]);return J.jsx(J.Fragment,{children:J.jsx(PIe,{children:J.jsx(Gf,{children:J.jsx(kIe,{children:Object.keys(t).map(i=>n(i))})},r+"_paintPropForm")})})}try{IE.displayName="LayerPropertyForm",IE.__docgenInfo={description:"",displayName:"LayerPropertyForm",props:{paintProps:{defaultValue:{value:"{}"},description:"",name:"paintProps",required:!1,type:{name:"paintPropsType"}},setPaintProps:{defaultValue:null,description:"",name:"setPaintProps",required:!0,type:{name:"(paintProps: paintPropsType | ((current: paintPropsType) => paintPropsType)) => void"}},layerType:{defaultValue:null,description:"",name:"layerType",required:!0,type:{name:"string"}}}}}catch{}const PE=Dr(Gf)(t=>({paddingRight:t?"56px":0,paddingLeft:0,paddingTop:0,paddingBottom:"4px"})),DIe=Dr(Rc)({padding:"4px",marginTop:"-3px"}),lp=Dr(Ub)({minWidth:"30px"}),up=Dr($0)({padding:0});function kE({configurable:t,vtProps:e,setVtProps:r,id:n,...i}){const[a,s]=te.useState(!1),[o,c]=te.useState(!0),[f,d]=te.useState(e.layers[n].paint);return te.useEffect(()=>{if(!r||typeof e.layers[n]?.layout?.visibility>"u"&&o||!o&&e.layers[n]?.layout?.visibility==="none"||o&&e.layers[n]?.layout?.visibility==="visible")return;const m=[...e.layers];m[n].layout?m[n].layout.visibility=o?"visible":"none":m[n].layout={visibility:o?"visible":"none"},r({...e,layers:m})},[o,n,r,e]),te.useEffect(()=>{c(!!i.visibleMaster)},[i.visibleMaster]),te.useEffect(()=>{if(r&&JSON.stringify(f)!==JSON.stringify(e.layers[n].paint)){const m={...f},b=[...e.layers];b[n].paint=m,r({...e,layers:b})}},[f,n,r,e]),J.jsxs(J.Fragment,{children:[J.jsxs(PE,{secondaryAction:t?J.jsx(DIe,{edge:"end","aria-label":"comments",onClick:()=>{s(m=>!m)},children:J.jsx(dN,{})}):void 0,children:[J.jsx(lp,{children:J.jsx(up,{checked:o,onClick:()=>{c(m=>!m)}})}),J.jsx(Lf,{primary:e.layers[n].id,variant:"layerlist"})]},n),t&&a&&J.jsx(IE,{paintProps:f,setPaintProps:d,layerType:e.layers[n].type})]})}kE.defaultProps={configurable:!0};try{PE.displayName="ListItemStyled",PE.__docgenInfo={description:"",displayName:"ListItemStyled",props:{}}}catch{}try{lp.displayName="CheckboxListItemIcon",lp.__docgenInfo={description:"",displayName:"CheckboxListItemIcon",props:{ref:{defaultValue:null,description:"",name:"ref",required:!1,type:{name:"Ref<unknown> | undefined"}}}}}catch{}try{up.displayName="CheckboxStyled",up.__docgenInfo={description:"",displayName:"CheckboxStyled",props:{component:{defaultValue:null,description:"",name:"component",required:!1,type:{name:"ElementType<any, keyof IntrinsicElements> | undefined"}},slots:{defaultValue:{value:"{}"},description:"The components used for each slot inside.",name:"slots",required:!1,type:{name:"Partial<CheckboxSlots> | undefined"}},slotProps:{defaultValue:{value:"{}"},description:"The props used for each slot inside.",name:"slotProps",required:!1,type:{name:"{ root?: SlotProps<ElementType<SwitchBaseProps, keyof IntrinsicElements>, CheckboxRootSlotPropsOverrides, CheckboxOwnerState> | undefined; input?: SlotProps<...> | undefined; } | undefined"}}}}}catch{}try{kE.displayName="LayerListItemVectorLayer",kE.__docgenInfo={description:"",displayName:"LayerListItemVectorLayer",props:{id:{defaultValue:null,description:"",name:"id",required:!0,type:{name:"string"}},configurable:{defaultValue:{value:"true"},description:"",name:"configurable",required:!1,type:{name:"boolean | undefined"}},vtProps:{defaultValue:null,description:"",name:"vtProps",required:!0,type:{name:"MlVectorTileLayerProps"}},setVtProps:{defaultValue:null,description:"",name:"setVtProps",required:!0,type:{name:"((state: unknown) => void) | undefined"}},visibleMaster:{defaultValue:null,description:"",name:"visibleMaster",required:!1,type:{name:"boolean | undefined"}}}}}catch{}function e_(t){return J.jsx(J.Fragment,{children:J.jsxs(uO,{open:t.open,onClose:t.onCancel,"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",children:[J.jsx(by,{id:"alert-dialog-title",children:t.title}),J.jsx(cO,{children:J.jsx(wpe,{id:"alert-dialog-description",children:t.text})}),J.jsxs(Ox,{children:[J.jsx(ta,{onClick:t.onCancel,children:"Cancel"}),J.jsx(ta,{onClick:t.onConfirm,autoFocus:!0,children:"Confirm"})]})]})})}e_.defaultProps={title:"Confirm",text:"Are you sure?"};try{e_.displayName="ConfirmDialog",e_.__docgenInfo={description:"",displayName:"ConfirmDialog",props:{open:{defaultValue:null,description:"",name:"open",required:!0,type:{name:"boolean"}},title:{defaultValue:{value:"Confirm"},description:"",name:"title",required:!1,type:{name:"string"}},text:{defaultValue:{value:"Are you sure?"},description:"",name:"text",required:!1,type:{name:"string"}},onConfirm:{defaultValue:null,description:"",name:"onConfirm",required:!0,type:{name:"() => void"}},onCancel:{defaultValue:null,description:"",name:"onCancel",required:!0,type:{name:"() => void"}}}}}catch{}function OIe(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];return te.useMemo(()=>n=>{e.forEach(i=>i(n))},e)}const R3=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function E_(t){const e=Object.prototype.toString.call(t);return e==="[object Window]"||e==="[object global]"}function nL(t){return"nodeType"in t}function Vc(t){var e,r;return t?E_(t)?t:nL(t)&&(e=(r=t.ownerDocument)==null?void 0:r.defaultView)!=null?e:window:window}function iL(t){const{Document:e}=Vc(t);return t instanceof e}function Zx(t){return E_(t)?!1:t instanceof Vc(t).HTMLElement}function NQ(t){return t instanceof Vc(t).SVGElement}function T_(t){return t?E_(t)?t.document:nL(t)?iL(t)?t:Zx(t)||NQ(t)?t.ownerDocument:document:document:document}const Cd=R3?te.useLayoutEffect:te.useEffect;function aL(t){const e=te.useRef(t);return Cd(()=>{e.current=t}),te.useCallback(function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return e.current==null?void 0:e.current(...n)},[])}function NIe(){const t=te.useRef(null),e=te.useCallback((n,i)=>{t.current=setInterval(n,i)},[]),r=te.useCallback(()=>{t.current!==null&&(clearInterval(t.current),t.current=null)},[]);return[e,r]}function nx(t,e){e===void 0&&(e=[t]);const r=te.useRef(t);return Cd(()=>{r.current!==t&&(r.current=t)},e),r}function Kx(t,e){const r=te.useRef();return te.useMemo(()=>{const n=t(r.current);return r.current=n,n},[...e])}function RE(t){const e=aL(t),r=te.useRef(null),n=te.useCallback(i=>{i!==r.current&&e?.(i,r.current),r.current=i},[]);return[r,n]}function QR(t){const e=te.useRef();return te.useEffect(()=>{e.current=t},[t]),e.current}let oP={};function Jx(t,e){return te.useMemo(()=>{if(e)return e;const r=oP[t]==null?0:oP[t]+1;return oP[t]=r,t+"-"+r},[t,e])}function LQ(t){return function(e){for(var r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];return n.reduce((a,s)=>{const o=Object.entries(s);for(const[c,f]of o){const d=a[c];d!=null&&(a[c]=d+t*f)}return a},{...e})}}const k0=LQ(1),ME=LQ(-1);function LIe(t){return"clientX"in t&&"clientY"in t}function oL(t){if(!t)return!1;const{KeyboardEvent:e}=Vc(t.target);return e&&t instanceof e}function FIe(t){if(!t)return!1;const{TouchEvent:e}=Vc(t.target);return e&&t instanceof e}function eM(t){if(FIe(t)){if(t.touches&&t.touches.length){const{clientX:e,clientY:r}=t.touches[0];return{x:e,y:r}}else if(t.changedTouches&&t.changedTouches.length){const{clientX:e,clientY:r}=t.changedTouches[0];return{x:e,y:r}}}return LIe(t)?{x:t.clientX,y:t.clientY}:null}const ix=Object.freeze({Translate:{toString(t){if(!t)return;const{x:e,y:r}=t;return"translate3d("+(e?Math.round(e):0)+"px, "+(r?Math.round(r):0)+"px, 0)"}},Scale:{toString(t){if(!t)return;const{scaleX:e,scaleY:r}=t;return"scaleX("+e+") scaleY("+r+")"}},Transform:{toString(t){if(t)return[ix.Translate.toString(t),ix.Scale.toString(t)].join(" ")}},Transition:{toString(t){let{property:e,duration:r,easing:n}=t;return e+" "+r+"ms "+n}}}),nq="a,frame,iframe,input:not([type=hidden]):not(:disabled),select:not(:disabled),textarea:not(:disabled),button:not(:disabled),*[tabindex]";function BIe(t){return t.matches(nq)?t:t.querySelector(nq)}const zIe={display:"none"};function jIe(t){let{id:e,value:r}=t;return gt.createElement("div",{id:e,style:zIe},r)}function UIe(t){let{id:e,announcement:r,ariaLiveType:n="assertive"}=t;const i={position:"fixed",top:0,left:0,width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0 0 0 0)",clipPath:"inset(100%)",whiteSpace:"nowrap"};return gt.createElement("div",{id:e,style:i,role:"status","aria-live":n,"aria-atomic":!0},r)}function VIe(){const[t,e]=te.useState("");return{announce:te.useCallback(n=>{n!=null&&e(n)},[]),announcement:t}}const FQ=te.createContext(null);function $Ie(t){const e=te.useContext(FQ);te.useEffect(()=>{if(!e)throw new Error("useDndMonitor must be used within a children of <DndContext>");return e(t)},[t,e])}function qIe(){const[t]=te.useState(()=>new Set),e=te.useCallback(n=>(t.add(n),()=>t.delete(n)),[t]);return[te.useCallback(n=>{let{type:i,event:a}=n;t.forEach(s=>{var o;return(o=s[i])==null?void 0:o.call(s,a)})},[t]),e]}const HIe={draggable:`
    To pick up a draggable item, press the space bar.
    While dragging, use the arrow keys to move the item.
    Press space again to drop the item in its new position, or press escape to cancel.
  `},GIe={onDragStart(t){let{active:e}=t;return"Picked up draggable item "+e.id+"."},onDragOver(t){let{active:e,over:r}=t;return r?"Draggable item "+e.id+" was moved over droppable area "+r.id+".":"Draggable item "+e.id+" is no longer over a droppable area."},onDragEnd(t){let{active:e,over:r}=t;return r?"Draggable item "+e.id+" was dropped over droppable area "+r.id:"Draggable item "+e.id+" was dropped."},onDragCancel(t){let{active:e}=t;return"Dragging was cancelled. Draggable item "+e.id+" was dropped."}};function WIe(t){let{announcements:e=GIe,container:r,hiddenTextDescribedById:n,screenReaderInstructions:i=HIe}=t;const{announce:a,announcement:s}=VIe(),o=Jx("DndLiveRegion"),[c,f]=te.useState(!1);if(te.useEffect(()=>{f(!0)},[]),$Ie(te.useMemo(()=>({onDragStart(m){let{active:b}=m;a(e.onDragStart({active:b}))},onDragMove(m){let{active:b,over:x}=m;e.onDragMove&&a(e.onDragMove({active:b,over:x}))},onDragOver(m){let{active:b,over:x}=m;a(e.onDragOver({active:b,over:x}))},onDragEnd(m){let{active:b,over:x}=m;a(e.onDragEnd({active:b,over:x}))},onDragCancel(m){let{active:b,over:x}=m;a(e.onDragCancel({active:b,over:x}))}}),[a,e])),!c)return null;const d=gt.createElement(gt.Fragment,null,gt.createElement(jIe,{id:n,value:i.draggable}),gt.createElement(UIe,{id:o,announcement:s}));return r?fp.createPortal(d,r):d}var Ll;(function(t){t.DragStart="dragStart",t.DragMove="dragMove",t.DragEnd="dragEnd",t.DragCancel="dragCancel",t.DragOver="dragOver",t.RegisterDroppable="registerDroppable",t.SetDroppableDisabled="setDroppableDisabled",t.UnregisterDroppable="unregisterDroppable"})(Ll||(Ll={}));function DE(){}function iq(t,e){return te.useMemo(()=>({sensor:t,options:e??{}}),[t,e])}function XIe(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];return te.useMemo(()=>[...e].filter(n=>n!=null),[...e])}const Ph=Object.freeze({x:0,y:0});function YIe(t,e){return Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))}function ZIe(t,e){let{data:{value:r}}=t,{data:{value:n}}=e;return r-n}function KIe(t,e){let{data:{value:r}}=t,{data:{value:n}}=e;return n-r}function JIe(t,e){if(!t||t.length===0)return null;const[r]=t;return r[e]}function aq(t,e,r){return e===void 0&&(e=t.left),r===void 0&&(r=t.top),{x:e+t.width*.5,y:r+t.height*.5}}const QIe=t=>{let{collisionRect:e,droppableRects:r,droppableContainers:n}=t;const i=aq(e,e.left,e.top),a=[];for(const s of n){const{id:o}=s,c=r.get(o);if(c){const f=YIe(aq(c),i);a.push({id:o,data:{droppableContainer:s,value:f}})}}return a.sort(ZIe)};function ePe(t,e){const r=Math.max(e.top,t.top),n=Math.max(e.left,t.left),i=Math.min(e.left+e.width,t.left+t.width),a=Math.min(e.top+e.height,t.top+t.height),s=i-n,o=a-r;if(n<i&&r<a){const c=e.width*e.height,f=t.width*t.height,d=s*o,m=d/(c+f-d);return Number(m.toFixed(4))}return 0}const tPe=t=>{let{collisionRect:e,droppableRects:r,droppableContainers:n}=t;const i=[];for(const a of n){const{id:s}=a,o=r.get(s);if(o){const c=ePe(o,e);c>0&&i.push({id:s,data:{droppableContainer:a,value:c}})}}return i.sort(KIe)};function rPe(t,e,r){return{...t,scaleX:e&&r?e.width/r.width:1,scaleY:e&&r?e.height/r.height:1}}function BQ(t,e){return t&&e?{x:t.left-e.left,y:t.top-e.top}:Ph}function nPe(t){return function(r){for(var n=arguments.length,i=new Array(n>1?n-1:0),a=1;a<n;a++)i[a-1]=arguments[a];return i.reduce((s,o)=>({...s,top:s.top+t*o.y,bottom:s.bottom+t*o.y,left:s.left+t*o.x,right:s.right+t*o.x}),{...r})}}const iPe=nPe(1);function aPe(t){if(t.startsWith("matrix3d(")){const e=t.slice(9,-1).split(/, /);return{x:+e[12],y:+e[13],scaleX:+e[0],scaleY:+e[5]}}else if(t.startsWith("matrix(")){const e=t.slice(7,-1).split(/, /);return{x:+e[4],y:+e[5],scaleX:+e[0],scaleY:+e[3]}}return null}function oPe(t,e,r){const n=aPe(e);if(!n)return t;const{scaleX:i,scaleY:a,x:s,y:o}=n,c=t.left-s-(1-i)*parseFloat(r),f=t.top-o-(1-a)*parseFloat(r.slice(r.indexOf(" ")+1)),d=i?t.width/i:t.width,m=a?t.height/a:t.height;return{width:d,height:m,top:f,right:c+d,bottom:f+m,left:c}}const sPe={ignoreTransform:!1};function C_(t,e){e===void 0&&(e=sPe);let r=t.getBoundingClientRect();if(e.ignoreTransform){const{transform:f,transformOrigin:d}=Vc(t).getComputedStyle(t);f&&(r=oPe(r,f,d))}const{top:n,left:i,width:a,height:s,bottom:o,right:c}=r;return{top:n,left:i,width:a,height:s,bottom:o,right:c}}function oq(t){return C_(t,{ignoreTransform:!0})}function lPe(t){const e=t.innerWidth,r=t.innerHeight;return{top:0,left:0,right:e,bottom:r,width:e,height:r}}function uPe(t,e){return e===void 0&&(e=Vc(t).getComputedStyle(t)),e.position==="fixed"}function cPe(t,e){e===void 0&&(e=Vc(t).getComputedStyle(t));const r=/(auto|scroll|overlay)/;return["overflow","overflowX","overflowY"].some(i=>{const a=e[i];return typeof a=="string"?r.test(a):!1})}function sL(t,e){const r=[];function n(i){if(e!=null&&r.length>=e||!i)return r;if(iL(i)&&i.scrollingElement!=null&&!r.includes(i.scrollingElement))return r.push(i.scrollingElement),r;if(!Zx(i)||NQ(i)||r.includes(i))return r;const a=Vc(t).getComputedStyle(i);return i!==t&&cPe(i,a)&&r.push(i),uPe(i,a)?r:n(i.parentNode)}return t?n(t):r}function zQ(t){const[e]=sL(t,1);return e??null}function sP(t){return!R3||!t?null:E_(t)?t:nL(t)?iL(t)||t===T_(t).scrollingElement?window:Zx(t)?t:null:null}function jQ(t){return E_(t)?t.scrollX:t.scrollLeft}function UQ(t){return E_(t)?t.scrollY:t.scrollTop}function tM(t){return{x:jQ(t),y:UQ(t)}}var iu;(function(t){t[t.Forward=1]="Forward",t[t.Backward=-1]="Backward"})(iu||(iu={}));function VQ(t){return!R3||!t?!1:t===document.scrollingElement}function $Q(t){const e={x:0,y:0},r=VQ(t)?{height:window.innerHeight,width:window.innerWidth}:{height:t.clientHeight,width:t.clientWidth},n={x:t.scrollWidth-r.width,y:t.scrollHeight-r.height},i=t.scrollTop<=e.y,a=t.scrollLeft<=e.x,s=t.scrollTop>=n.y,o=t.scrollLeft>=n.x;return{isTop:i,isLeft:a,isBottom:s,isRight:o,maxScroll:n,minScroll:e}}const fPe={x:.2,y:.2};function hPe(t,e,r,n,i){let{top:a,left:s,right:o,bottom:c}=r;n===void 0&&(n=10),i===void 0&&(i=fPe);const{isTop:f,isBottom:d,isLeft:m,isRight:b}=$Q(t),x={x:0,y:0},E={x:0,y:0},T={height:e.height*i.y,width:e.width*i.x};return!f&&a<=e.top+T.height?(x.y=iu.Backward,E.y=n*Math.abs((e.top+T.height-a)/T.height)):!d&&c>=e.bottom-T.height&&(x.y=iu.Forward,E.y=n*Math.abs((e.bottom-T.height-c)/T.height)),!b&&o>=e.right-T.width?(x.x=iu.Forward,E.x=n*Math.abs((e.right-T.width-o)/T.width)):!m&&s<=e.left+T.width&&(x.x=iu.Backward,E.x=n*Math.abs((e.left+T.width-s)/T.width)),{direction:x,speed:E}}function dPe(t){if(t===document.scrollingElement){const{innerWidth:a,innerHeight:s}=window;return{top:0,left:0,right:a,bottom:s,width:a,height:s}}const{top:e,left:r,right:n,bottom:i}=t.getBoundingClientRect();return{top:e,left:r,right:n,bottom:i,width:t.clientWidth,height:t.clientHeight}}function qQ(t){return t.reduce((e,r)=>k0(e,tM(r)),Ph)}function pPe(t){return t.reduce((e,r)=>e+jQ(r),0)}function gPe(t){return t.reduce((e,r)=>e+UQ(r),0)}function mPe(t,e){if(e===void 0&&(e=C_),!t)return;const{top:r,left:n,bottom:i,right:a}=e(t);zQ(t)&&(i<=0||a<=0||r>=window.innerHeight||n>=window.innerWidth)&&t.scrollIntoView({block:"center",inline:"center"})}const yPe=[["x",["left","right"],pPe],["y",["top","bottom"],gPe]];class lL{constructor(e,r){this.rect=void 0,this.width=void 0,this.height=void 0,this.top=void 0,this.bottom=void 0,this.right=void 0,this.left=void 0;const n=sL(r),i=qQ(n);this.rect={...e},this.width=e.width,this.height=e.height;for(const[a,s,o]of yPe)for(const c of s)Object.defineProperty(this,c,{get:()=>{const f=o(n),d=i[a]-f;return this.rect[c]+d},enumerable:!0});Object.defineProperty(this,"rect",{enumerable:!1})}}class bb{constructor(e){this.target=void 0,this.listeners=[],this.removeAll=()=>{this.listeners.forEach(r=>{var n;return(n=this.target)==null?void 0:n.removeEventListener(...r)})},this.target=e}add(e,r,n){var i;(i=this.target)==null||i.addEventListener(e,r,n),this.listeners.push([e,r,n])}}function vPe(t){const{EventTarget:e}=Vc(t);return t instanceof e?t:T_(t)}function lP(t,e){const r=Math.abs(t.x),n=Math.abs(t.y);return typeof e=="number"?Math.sqrt(r**2+n**2)>e:"x"in e&&"y"in e?r>e.x&&n>e.y:"x"in e?r>e.x:"y"in e?n>e.y:!1}var Of;(function(t){t.Click="click",t.DragStart="dragstart",t.Keydown="keydown",t.ContextMenu="contextmenu",t.Resize="resize",t.SelectionChange="selectionchange",t.VisibilityChange="visibilitychange"})(Of||(Of={}));function sq(t){t.preventDefault()}function _Pe(t){t.stopPropagation()}var Wa;(function(t){t.Space="Space",t.Down="ArrowDown",t.Right="ArrowRight",t.Left="ArrowLeft",t.Up="ArrowUp",t.Esc="Escape",t.Enter="Enter",t.Tab="Tab"})(Wa||(Wa={}));const HQ={start:[Wa.Space,Wa.Enter],cancel:[Wa.Esc],end:[Wa.Space,Wa.Enter,Wa.Tab]},bPe=(t,e)=>{let{currentCoordinates:r}=e;switch(t.code){case Wa.Right:return{...r,x:r.x+25};case Wa.Left:return{...r,x:r.x-25};case Wa.Down:return{...r,y:r.y+25};case Wa.Up:return{...r,y:r.y-25}}};class GQ{constructor(e){this.props=void 0,this.autoScrollEnabled=!1,this.referenceCoordinates=void 0,this.listeners=void 0,this.windowListeners=void 0,this.props=e;const{event:{target:r}}=e;this.props=e,this.listeners=new bb(T_(r)),this.windowListeners=new bb(Vc(r)),this.handleKeyDown=this.handleKeyDown.bind(this),this.handleCancel=this.handleCancel.bind(this),this.attach()}attach(){this.handleStart(),this.windowListeners.add(Of.Resize,this.handleCancel),this.windowListeners.add(Of.VisibilityChange,this.handleCancel),setTimeout(()=>this.listeners.add(Of.Keydown,this.handleKeyDown))}handleStart(){const{activeNode:e,onStart:r}=this.props,n=e.node.current;n&&mPe(n),r(Ph)}handleKeyDown(e){if(oL(e)){const{active:r,context:n,options:i}=this.props,{keyboardCodes:a=HQ,coordinateGetter:s=bPe,scrollBehavior:o="smooth"}=i,{code:c}=e;if(a.end.includes(c)){this.handleEnd(e);return}if(a.cancel.includes(c)){this.handleCancel(e);return}const{collisionRect:f}=n.current,d=f?{x:f.left,y:f.top}:Ph;this.referenceCoordinates||(this.referenceCoordinates=d);const m=s(e,{active:r,context:n.current,currentCoordinates:d});if(m){const b=ME(m,d),x={x:0,y:0},{scrollableAncestors:E}=n.current;for(const T of E){const A=e.code,{isTop:M,isRight:F,isLeft:N,isBottom:O,maxScroll:U,minScroll:j}=$Q(T),H=dPe(T),W={x:Math.min(A===Wa.Right?H.right-H.width/2:H.right,Math.max(A===Wa.Right?H.left:H.left+H.width/2,m.x)),y:Math.min(A===Wa.Down?H.bottom-H.height/2:H.bottom,Math.max(A===Wa.Down?H.top:H.top+H.height/2,m.y))},X=A===Wa.Right&&!F||A===Wa.Left&&!N,oe=A===Wa.Down&&!O||A===Wa.Up&&!M;if(X&&W.x!==m.x){const Q=T.scrollLeft+b.x,G=A===Wa.Right&&Q<=U.x||A===Wa.Left&&Q>=j.x;if(G&&!b.y){T.scrollTo({left:Q,behavior:o});return}G?x.x=T.scrollLeft-Q:x.x=A===Wa.Right?T.scrollLeft-U.x:T.scrollLeft-j.x,x.x&&T.scrollBy({left:-x.x,behavior:o});break}else if(oe&&W.y!==m.y){const Q=T.scrollTop+b.y,G=A===Wa.Down&&Q<=U.y||A===Wa.Up&&Q>=j.y;if(G&&!b.x){T.scrollTo({top:Q,behavior:o});return}G?x.y=T.scrollTop-Q:x.y=A===Wa.Down?T.scrollTop-U.y:T.scrollTop-j.y,x.y&&T.scrollBy({top:-x.y,behavior:o});break}}this.handleMove(e,k0(ME(m,this.referenceCoordinates),x))}}}handleMove(e,r){const{onMove:n}=this.props;e.preventDefault(),n(r)}handleEnd(e){const{onEnd:r}=this.props;e.preventDefault(),this.detach(),r()}handleCancel(e){const{onCancel:r}=this.props;e.preventDefault(),this.detach(),r()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll()}}GQ.activators=[{eventName:"onKeyDown",handler:(t,e,r)=>{let{keyboardCodes:n=HQ,onActivation:i}=e,{active:a}=r;const{code:s}=t.nativeEvent;if(n.start.includes(s)){const o=a.activatorNode.current;return o&&t.target!==o?!1:(t.preventDefault(),i?.({event:t.nativeEvent}),!0)}return!1}}];function lq(t){return!!(t&&"distance"in t)}function uq(t){return!!(t&&"delay"in t)}class uL{constructor(e,r,n){var i;n===void 0&&(n=vPe(e.event.target)),this.props=void 0,this.events=void 0,this.autoScrollEnabled=!0,this.document=void 0,this.activated=!1,this.initialCoordinates=void 0,this.timeoutId=null,this.listeners=void 0,this.documentListeners=void 0,this.windowListeners=void 0,this.props=e,this.events=r;const{event:a}=e,{target:s}=a;this.props=e,this.events=r,this.document=T_(s),this.documentListeners=new bb(this.document),this.listeners=new bb(n),this.windowListeners=new bb(Vc(s)),this.initialCoordinates=(i=eM(a))!=null?i:Ph,this.handleStart=this.handleStart.bind(this),this.handleMove=this.handleMove.bind(this),this.handleEnd=this.handleEnd.bind(this),this.handleCancel=this.handleCancel.bind(this),this.handleKeydown=this.handleKeydown.bind(this),this.removeTextSelection=this.removeTextSelection.bind(this),this.attach()}attach(){const{events:e,props:{options:{activationConstraint:r,bypassActivationConstraint:n}}}=this;if(this.listeners.add(e.move.name,this.handleMove,{passive:!1}),this.listeners.add(e.end.name,this.handleEnd),e.cancel&&this.listeners.add(e.cancel.name,this.handleCancel),this.windowListeners.add(Of.Resize,this.handleCancel),this.windowListeners.add(Of.DragStart,sq),this.windowListeners.add(Of.VisibilityChange,this.handleCancel),this.windowListeners.add(Of.ContextMenu,sq),this.documentListeners.add(Of.Keydown,this.handleKeydown),r){if(n!=null&&n({event:this.props.event,activeNode:this.props.activeNode,options:this.props.options}))return this.handleStart();if(uq(r)){this.timeoutId=setTimeout(this.handleStart,r.delay),this.handlePending(r);return}if(lq(r)){this.handlePending(r);return}}this.handleStart()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll(),setTimeout(this.documentListeners.removeAll,50),this.timeoutId!==null&&(clearTimeout(this.timeoutId),this.timeoutId=null)}handlePending(e,r){const{active:n,onPending:i}=this.props;i(n,e,this.initialCoordinates,r)}handleStart(){const{initialCoordinates:e}=this,{onStart:r}=this.props;e&&(this.activated=!0,this.documentListeners.add(Of.Click,_Pe,{capture:!0}),this.removeTextSelection(),this.documentListeners.add(Of.SelectionChange,this.removeTextSelection),r(e))}handleMove(e){var r;const{activated:n,initialCoordinates:i,props:a}=this,{onMove:s,options:{activationConstraint:o}}=a;if(!i)return;const c=(r=eM(e))!=null?r:Ph,f=ME(i,c);if(!n&&o){if(lq(o)){if(o.tolerance!=null&&lP(f,o.tolerance))return this.handleCancel();if(lP(f,o.distance))return this.handleStart()}if(uq(o)&&lP(f,o.tolerance))return this.handleCancel();this.handlePending(o,f);return}e.cancelable&&e.preventDefault(),s(c)}handleEnd(){const{onAbort:e,onEnd:r}=this.props;this.detach(),this.activated||e(this.props.active),r()}handleCancel(){const{onAbort:e,onCancel:r}=this.props;this.detach(),this.activated||e(this.props.active),r()}handleKeydown(e){e.code===Wa.Esc&&this.handleCancel()}removeTextSelection(){var e;(e=this.document.getSelection())==null||e.removeAllRanges()}}const xPe={cancel:{name:"pointercancel"},move:{name:"pointermove"},end:{name:"pointerup"}};class cL extends uL{constructor(e){const{event:r}=e,n=T_(r.target);super(e,xPe,n)}}cL.activators=[{eventName:"onPointerDown",handler:(t,e)=>{let{nativeEvent:r}=t,{onActivation:n}=e;return!r.isPrimary||r.button!==0?!1:(n?.({event:r}),!0)}}];const wPe={move:{name:"mousemove"},end:{name:"mouseup"}};var rM;(function(t){t[t.RightClick=2]="RightClick"})(rM||(rM={}));class WQ extends uL{constructor(e){super(e,wPe,T_(e.event.target))}}WQ.activators=[{eventName:"onMouseDown",handler:(t,e)=>{let{nativeEvent:r}=t,{onActivation:n}=e;return r.button===rM.RightClick?!1:(n?.({event:r}),!0)}}];const uP={cancel:{name:"touchcancel"},move:{name:"touchmove"},end:{name:"touchend"}};class SPe extends uL{constructor(e){super(e,uP)}static setup(){return window.addEventListener(uP.move.name,e,{capture:!1,passive:!1}),function(){window.removeEventListener(uP.move.name,e)};function e(){}}}SPe.activators=[{eventName:"onTouchStart",handler:(t,e)=>{let{nativeEvent:r}=t,{onActivation:n}=e;const{touches:i}=r;return i.length>1?!1:(n?.({event:r}),!0)}}];var xb;(function(t){t[t.Pointer=0]="Pointer",t[t.DraggableRect=1]="DraggableRect"})(xb||(xb={}));var OE;(function(t){t[t.TreeOrder=0]="TreeOrder",t[t.ReversedTreeOrder=1]="ReversedTreeOrder"})(OE||(OE={}));function EPe(t){let{acceleration:e,activator:r=xb.Pointer,canScroll:n,draggingRect:i,enabled:a,interval:s=5,order:o=OE.TreeOrder,pointerCoordinates:c,scrollableAncestors:f,scrollableAncestorRects:d,delta:m,threshold:b}=t;const x=CPe({delta:m,disabled:!a}),[E,T]=NIe(),A=te.useRef({x:0,y:0}),M=te.useRef({x:0,y:0}),F=te.useMemo(()=>{switch(r){case xb.Pointer:return c?{top:c.y,bottom:c.y,left:c.x,right:c.x}:null;case xb.DraggableRect:return i}},[r,i,c]),N=te.useRef(null),O=te.useCallback(()=>{const j=N.current;if(!j)return;const H=A.current.x*M.current.x,W=A.current.y*M.current.y;j.scrollBy(H,W)},[]),U=te.useMemo(()=>o===OE.TreeOrder?[...f].reverse():f,[o,f]);te.useEffect(()=>{if(!a||!f.length||!F){T();return}for(const j of U){if(n?.(j)===!1)continue;const H=f.indexOf(j),W=d[H];if(!W)continue;const{direction:X,speed:oe}=hPe(j,W,F,e,b);for(const Q of["x","y"])x[Q][X[Q]]||(oe[Q]=0,X[Q]=0);if(oe.x>0||oe.y>0){T(),N.current=j,E(O,s),A.current=oe,M.current=X;return}}A.current={x:0,y:0},M.current={x:0,y:0},T()},[e,O,n,T,a,s,JSON.stringify(F),JSON.stringify(x),E,f,U,d,JSON.stringify(b)])}const TPe={x:{[iu.Backward]:!1,[iu.Forward]:!1},y:{[iu.Backward]:!1,[iu.Forward]:!1}};function CPe(t){let{delta:e,disabled:r}=t;const n=QR(e);return Kx(i=>{if(r||!n||!i)return TPe;const a={x:Math.sign(e.x-n.x),y:Math.sign(e.y-n.y)};return{x:{[iu.Backward]:i.x[iu.Backward]||a.x===-1,[iu.Forward]:i.x[iu.Forward]||a.x===1},y:{[iu.Backward]:i.y[iu.Backward]||a.y===-1,[iu.Forward]:i.y[iu.Forward]||a.y===1}}},[r,e,n])}function APe(t,e){const r=e!=null?t.get(e):void 0,n=r?r.node.current:null;return Kx(i=>{var a;return e==null?null:(a=n??i)!=null?a:null},[n,e])}function IPe(t,e){return te.useMemo(()=>t.reduce((r,n)=>{const{sensor:i}=n,a=i.activators.map(s=>({eventName:s.eventName,handler:e(s.handler,n)}));return[...r,...a]},[]),[t,e])}var ax;(function(t){t[t.Always=0]="Always",t[t.BeforeDragging=1]="BeforeDragging",t[t.WhileDragging=2]="WhileDragging"})(ax||(ax={}));var nM;(function(t){t.Optimized="optimized"})(nM||(nM={}));const cq=new Map;function PPe(t,e){let{dragging:r,dependencies:n,config:i}=e;const[a,s]=te.useState(null),{frequency:o,measure:c,strategy:f}=i,d=te.useRef(t),m=A(),b=nx(m),x=te.useCallback(function(M){M===void 0&&(M=[]),!b.current&&s(F=>F===null?M:F.concat(M.filter(N=>!F.includes(N))))},[b]),E=te.useRef(null),T=Kx(M=>{if(m&&!r)return cq;if(!M||M===cq||d.current!==t||a!=null){const F=new Map;for(let N of t){if(!N)continue;if(a&&a.length>0&&!a.includes(N.id)&&N.rect.current){F.set(N.id,N.rect.current);continue}const O=N.node.current,U=O?new lL(c(O),O):null;N.rect.current=U,U&&F.set(N.id,U)}return F}return M},[t,a,r,m,c]);return te.useEffect(()=>{d.current=t},[t]),te.useEffect(()=>{m||x()},[r,m]),te.useEffect(()=>{a&&a.length>0&&s(null)},[JSON.stringify(a)]),te.useEffect(()=>{m||typeof o!="number"||E.current!==null||(E.current=setTimeout(()=>{x(),E.current=null},o))},[o,m,x,...n]),{droppableRects:T,measureDroppableContainers:x,measuringScheduled:a!=null};function A(){switch(f){case ax.Always:return!1;case ax.BeforeDragging:return r;default:return!r}}}function XQ(t,e){return Kx(r=>t?r||(typeof e=="function"?e(t):t):null,[e,t])}function kPe(t,e){return XQ(t,e)}function RPe(t){let{callback:e,disabled:r}=t;const n=aL(e),i=te.useMemo(()=>{if(r||typeof window>"u"||typeof window.MutationObserver>"u")return;const{MutationObserver:a}=window;return new a(n)},[n,r]);return te.useEffect(()=>()=>i?.disconnect(),[i]),i}function M3(t){let{callback:e,disabled:r}=t;const n=aL(e),i=te.useMemo(()=>{if(r||typeof window>"u"||typeof window.ResizeObserver>"u")return;const{ResizeObserver:a}=window;return new a(n)},[r]);return te.useEffect(()=>()=>i?.disconnect(),[i]),i}function MPe(t){return new lL(C_(t),t)}function fq(t,e,r){e===void 0&&(e=MPe);const[n,i]=te.useState(null);function a(){i(c=>{if(!t)return null;if(t.isConnected===!1){var f;return(f=c??r)!=null?f:null}const d=e(t);return JSON.stringify(c)===JSON.stringify(d)?c:d})}const s=RPe({callback(c){if(t)for(const f of c){const{type:d,target:m}=f;if(d==="childList"&&m instanceof HTMLElement&&m.contains(t)){a();break}}}}),o=M3({callback:a});return Cd(()=>{a(),t?(o?.observe(t),s?.observe(document.body,{childList:!0,subtree:!0})):(o?.disconnect(),s?.disconnect())},[t]),n}function DPe(t){const e=XQ(t);return BQ(t,e)}const hq=[];function OPe(t){const e=te.useRef(t),r=Kx(n=>t?n&&n!==hq&&t&&e.current&&t.parentNode===e.current.parentNode?n:sL(t):hq,[t]);return te.useEffect(()=>{e.current=t},[t]),r}function NPe(t){const[e,r]=te.useState(null),n=te.useRef(t),i=te.useCallback(a=>{const s=sP(a.target);s&&r(o=>o?(o.set(s,tM(s)),new Map(o)):null)},[]);return te.useEffect(()=>{const a=n.current;if(t!==a){s(a);const o=t.map(c=>{const f=sP(c);return f?(f.addEventListener("scroll",i,{passive:!0}),[f,tM(f)]):null}).filter(c=>c!=null);r(o.length?new Map(o):null),n.current=t}return()=>{s(t),s(a)};function s(o){o.forEach(c=>{const f=sP(c);f?.removeEventListener("scroll",i)})}},[i,t]),te.useMemo(()=>t.length?e?Array.from(e.values()).reduce((a,s)=>k0(a,s),Ph):qQ(t):Ph,[t,e])}function dq(t,e){e===void 0&&(e=[]);const r=te.useRef(null);return te.useEffect(()=>{r.current=null},e),te.useEffect(()=>{const n=t!==Ph;n&&!r.current&&(r.current=t),!n&&r.current&&(r.current=null)},[t]),r.current?ME(t,r.current):Ph}function LPe(t){te.useEffect(()=>{if(!R3)return;const e=t.map(r=>{let{sensor:n}=r;return n.setup==null?void 0:n.setup()});return()=>{for(const r of e)r?.()}},t.map(e=>{let{sensor:r}=e;return r}))}function FPe(t,e){return te.useMemo(()=>t.reduce((r,n)=>{let{eventName:i,handler:a}=n;return r[i]=s=>{a(s,e)},r},{}),[t,e])}function YQ(t){return te.useMemo(()=>t?lPe(t):null,[t])}const pq=[];function BPe(t,e){e===void 0&&(e=C_);const[r]=t,n=YQ(r?Vc(r):null),[i,a]=te.useState(pq);function s(){a(()=>t.length?t.map(c=>VQ(c)?n:new lL(e(c),c)):pq)}const o=M3({callback:s});return Cd(()=>{o?.disconnect(),s(),t.forEach(c=>o?.observe(c))},[t]),i}function zPe(t){if(!t)return null;if(t.children.length>1)return t;const e=t.children[0];return Zx(e)?e:t}function jPe(t){let{measure:e}=t;const[r,n]=te.useState(null),i=te.useCallback(f=>{for(const{target:d}of f)if(Zx(d)){n(m=>{const b=e(d);return m?{...m,width:b.width,height:b.height}:b});break}},[e]),a=M3({callback:i}),s=te.useCallback(f=>{const d=zPe(f);a?.disconnect(),d&&a?.observe(d),n(d?e(d):null)},[e,a]),[o,c]=RE(s);return te.useMemo(()=>({nodeRef:o,rect:r,setRef:c}),[r,o,c])}const UPe=[{sensor:cL,options:{}},{sensor:GQ,options:{}}],VPe={current:{}},SS={draggable:{measure:oq},droppable:{measure:oq,strategy:ax.WhileDragging,frequency:nM.Optimized},dragOverlay:{measure:C_}};class wb extends Map{get(e){var r;return e!=null&&(r=super.get(e))!=null?r:void 0}toArray(){return Array.from(this.values())}getEnabled(){return this.toArray().filter(e=>{let{disabled:r}=e;return!r})}getNodeFor(e){var r,n;return(r=(n=this.get(e))==null?void 0:n.node.current)!=null?r:void 0}}const $Pe={activatorEvent:null,active:null,activeNode:null,activeNodeRect:null,collisions:null,containerNodeRect:null,draggableNodes:new Map,droppableRects:new Map,droppableContainers:new wb,over:null,dragOverlay:{nodeRef:{current:null},rect:null,setRef:DE},scrollableAncestors:[],scrollableAncestorRects:[],measuringConfiguration:SS,measureDroppableContainers:DE,windowRect:null,measuringScheduled:!1},qPe={activatorEvent:null,activators:[],active:null,activeNodeRect:null,ariaDescribedById:{draggable:""},dispatch:DE,draggableNodes:new Map,over:null,measureDroppableContainers:DE},D3=te.createContext(qPe),ZQ=te.createContext($Pe);function HPe(){return{draggable:{active:null,initialCoordinates:{x:0,y:0},nodes:new Map,translate:{x:0,y:0}},droppable:{containers:new wb}}}function GPe(t,e){switch(e.type){case Ll.DragStart:return{...t,draggable:{...t.draggable,initialCoordinates:e.initialCoordinates,active:e.active}};case Ll.DragMove:return t.draggable.active==null?t:{...t,draggable:{...t.draggable,translate:{x:e.coordinates.x-t.draggable.initialCoordinates.x,y:e.coordinates.y-t.draggable.initialCoordinates.y}}};case Ll.DragEnd:case Ll.DragCancel:return{...t,draggable:{...t.draggable,active:null,initialCoordinates:{x:0,y:0},translate:{x:0,y:0}}};case Ll.RegisterDroppable:{const{element:r}=e,{id:n}=r,i=new wb(t.droppable.containers);return i.set(n,r),{...t,droppable:{...t.droppable,containers:i}}}case Ll.SetDroppableDisabled:{const{id:r,key:n,disabled:i}=e,a=t.droppable.containers.get(r);if(!a||n!==a.key)return t;const s=new wb(t.droppable.containers);return s.set(r,{...a,disabled:i}),{...t,droppable:{...t.droppable,containers:s}}}case Ll.UnregisterDroppable:{const{id:r,key:n}=e,i=t.droppable.containers.get(r);if(!i||n!==i.key)return t;const a=new wb(t.droppable.containers);return a.delete(r),{...t,droppable:{...t.droppable,containers:a}}}default:return t}}function WPe(t){let{disabled:e}=t;const{active:r,activatorEvent:n,draggableNodes:i}=te.useContext(D3),a=QR(n),s=QR(r?.id);return te.useEffect(()=>{if(!e&&!n&&a&&s!=null){if(!oL(a)||document.activeElement===a.target)return;const o=i.get(s);if(!o)return;const{activatorNode:c,node:f}=o;if(!c.current&&!f.current)return;requestAnimationFrame(()=>{for(const d of[c.current,f.current]){if(!d)continue;const m=BIe(d);if(m){m.focus();break}}})}},[n,e,i,s,a]),null}function XPe(t,e){let{transform:r,...n}=e;return t!=null&&t.length?t.reduce((i,a)=>a({transform:i,...n}),r):r}function YPe(t){return te.useMemo(()=>({draggable:{...SS.draggable,...t?.draggable},droppable:{...SS.droppable,...t?.droppable},dragOverlay:{...SS.dragOverlay,...t?.dragOverlay}}),[t?.draggable,t?.droppable,t?.dragOverlay])}function ZPe(t){let{activeNode:e,measure:r,initialRect:n,config:i=!0}=t;const a=te.useRef(!1),{x:s,y:o}=typeof i=="boolean"?{x:i,y:i}:i;Cd(()=>{if(!s&&!o||!e){a.current=!1;return}if(a.current||!n)return;const f=e?.node.current;if(!f||f.isConnected===!1)return;const d=r(f),m=BQ(d,n);if(s||(m.x=0),o||(m.y=0),a.current=!0,Math.abs(m.x)>0||Math.abs(m.y)>0){const b=zQ(f);b&&b.scrollBy({top:m.y,left:m.x})}},[e,s,o,n,r])}const KQ=te.createContext({...Ph,scaleX:1,scaleY:1});var og;(function(t){t[t.Uninitialized=0]="Uninitialized",t[t.Initializing=1]="Initializing",t[t.Initialized=2]="Initialized"})(og||(og={}));const KPe=te.memo(function(e){var r,n,i,a;let{id:s,accessibility:o,autoScroll:c=!0,children:f,sensors:d=UPe,collisionDetection:m=tPe,measuring:b,modifiers:x,...E}=e;const T=te.useReducer(GPe,void 0,HPe),[A,M]=T,[F,N]=qIe(),[O,U]=te.useState(og.Uninitialized),j=O===og.Initialized,{draggable:{active:H,nodes:W,translate:X},droppable:{containers:oe}}=A,Q=H!=null?W.get(H):null,G=te.useRef({initial:null,translated:null}),ae=te.useMemo(()=>{var zr;return H!=null?{id:H,data:(zr=Q?.data)!=null?zr:VPe,rect:G}:null},[H,Q]),se=te.useRef(null),[fe,_e]=te.useState(null),[Le,ye]=te.useState(null),Te=nx(E,Object.values(E)),Ie=Jx("DndDescribedBy",s),Me=te.useMemo(()=>oe.getEnabled(),[oe]),de=YPe(b),{droppableRects:Se,measureDroppableContainers:we,measuringScheduled:De}=PPe(Me,{dragging:j,dependencies:[X.x,X.y],config:de.droppable}),Fe=APe(W,H),Xe=te.useMemo(()=>Le?eM(Le):null,[Le]),Be=fn(),st=kPe(Fe,de.draggable.measure);ZPe({activeNode:H!=null?W.get(H):null,config:Be.layoutShiftCompensation,initialRect:st,measure:de.draggable.measure});const Qe=fq(Fe,de.draggable.measure,st),it=fq(Fe?Fe.parentElement:null),be=te.useRef({activatorEvent:null,active:null,activeNode:Fe,collisionRect:null,collisions:null,droppableRects:Se,draggableNodes:W,draggingNode:null,draggingNodeRect:null,droppableContainers:oe,over:null,scrollableAncestors:[],scrollAdjustedTranslate:null}),Ot=oe.getNodeFor((r=be.current.over)==null?void 0:r.id),at=jPe({measure:de.dragOverlay.measure}),$e=(n=at.nodeRef.current)!=null?n:Fe,Xt=j?(i=at.rect)!=null?i:Qe:null,$t=!!(at.nodeRef.current&&at.rect),cr=DPe($t?null:Qe),_t=YQ($e?Vc($e):null),gr=OPe(j?Ot??Fe:null),mr=BPe(gr),ar=XPe(x,{transform:{x:X.x-cr.x,y:X.y-cr.y,scaleX:1,scaleY:1},activatorEvent:Le,active:ae,activeNodeRect:Qe,containerNodeRect:it,draggingNodeRect:Xt,over:be.current.over,overlayNodeRect:at.rect,scrollableAncestors:gr,scrollableAncestorRects:mr,windowRect:_t}),Cr=Xe?k0(Xe,X):null,Er=NPe(gr),Jt=dq(Er),ot=dq(Er,[Qe]),Ce=k0(ar,Jt),xe=Xt?iPe(Xt,ar):null,je=ae&&xe?m({active:ae,collisionRect:xe,droppableRects:Se,droppableContainers:Me,pointerCoordinates:Cr}):null,qe=JIe(je,"id"),[Ge,Ft]=te.useState(null),Et=$t?ar:k0(ar,ot),mt=rPe(Et,(a=Ge?.rect)!=null?a:null,Qe),ct=te.useRef(null),Qt=te.useCallback((zr,Mt)=>{let{sensor:en,options:jn}=Mt;if(se.current==null)return;const Qr=W.get(se.current);if(!Qr)return;const nr=zr.nativeEvent,oi=new en({active:se.current,activeNode:Qr,event:nr,options:jn,context:be,onAbort(Kn){if(!W.get(Kn))return;const{onDragAbort:He}=Te.current,Tt={id:Kn};He?.(Tt),F({type:"onDragAbort",event:Tt})},onPending(Kn,Re,He,Tt){if(!W.get(Kn))return;const{onDragPending:Ut}=Te.current,Xr={id:Kn,constraint:Re,initialCoordinates:He,offset:Tt};Ut?.(Xr),F({type:"onDragPending",event:Xr})},onStart(Kn){const Re=se.current;if(Re==null)return;const He=W.get(Re);if(!He)return;const{onDragStart:Tt}=Te.current,Gt={activatorEvent:nr,active:{id:Re,data:He.data,rect:G}};fp.unstable_batchedUpdates(()=>{Tt?.(Gt),U(og.Initializing),M({type:Ll.DragStart,initialCoordinates:Kn,active:Re}),F({type:"onDragStart",event:Gt}),_e(ct.current),ye(nr)})},onMove(Kn){M({type:Ll.DragMove,coordinates:Kn})},onEnd:un(Ll.DragEnd),onCancel:un(Ll.DragCancel)});ct.current=oi;function un(Kn){return async function(){const{active:He,collisions:Tt,over:Gt,scrollAdjustedTranslate:Ut}=be.current;let Xr=null;if(He&&Ut){const{cancelDrop:Nn}=Te.current;Xr={activatorEvent:nr,active:He,collisions:Tt,delta:Ut,over:Gt},Kn===Ll.DragEnd&&typeof Nn=="function"&&await Promise.resolve(Nn(Xr))&&(Kn=Ll.DragCancel)}se.current=null,fp.unstable_batchedUpdates(()=>{M({type:Kn}),U(og.Uninitialized),Ft(null),_e(null),ye(null),ct.current=null;const Nn=Kn===Ll.DragEnd?"onDragEnd":"onDragCancel";if(Xr){const Bi=Te.current[Nn];Bi?.(Xr),F({type:Nn,event:Xr})}})}}},[W]),Ht=te.useCallback((zr,Mt)=>(en,jn)=>{const Qr=en.nativeEvent,nr=W.get(jn);if(se.current!==null||!nr||Qr.dndKit||Qr.defaultPrevented)return;const oi={active:nr};zr(en,Mt.options,oi)===!0&&(Qr.dndKit={capturedBy:Mt.sensor},se.current=jn,Qt(en,Mt))},[W,Qt]),Ir=IPe(d,Ht);LPe(d),Cd(()=>{Qe&&O===og.Initializing&&U(og.Initialized)},[Qe,O]),te.useEffect(()=>{const{onDragMove:zr}=Te.current,{active:Mt,activatorEvent:en,collisions:jn,over:Qr}=be.current;if(!Mt||!en)return;const nr={active:Mt,activatorEvent:en,collisions:jn,delta:{x:Ce.x,y:Ce.y},over:Qr};fp.unstable_batchedUpdates(()=>{zr?.(nr),F({type:"onDragMove",event:nr})})},[Ce.x,Ce.y]),te.useEffect(()=>{const{active:zr,activatorEvent:Mt,collisions:en,droppableContainers:jn,scrollAdjustedTranslate:Qr}=be.current;if(!zr||se.current==null||!Mt||!Qr)return;const{onDragOver:nr}=Te.current,oi=jn.get(qe),un=oi&&oi.rect.current?{id:oi.id,rect:oi.rect.current,data:oi.data,disabled:oi.disabled}:null,Kn={active:zr,activatorEvent:Mt,collisions:en,delta:{x:Qr.x,y:Qr.y},over:un};fp.unstable_batchedUpdates(()=>{Ft(un),nr?.(Kn),F({type:"onDragOver",event:Kn})})},[qe]),Cd(()=>{be.current={activatorEvent:Le,active:ae,activeNode:Fe,collisionRect:xe,collisions:je,droppableRects:Se,draggableNodes:W,draggingNode:$e,draggingNodeRect:Xt,droppableContainers:oe,over:Ge,scrollableAncestors:gr,scrollAdjustedTranslate:Ce},G.current={initial:Xt,translated:xe}},[ae,Fe,je,xe,W,$e,Xt,Se,oe,Ge,gr,Ce]),EPe({...Be,delta:X,draggingRect:xe,pointerCoordinates:Cr,scrollableAncestors:gr,scrollableAncestorRects:mr});const Ar=te.useMemo(()=>({active:ae,activeNode:Fe,activeNodeRect:Qe,activatorEvent:Le,collisions:je,containerNodeRect:it,dragOverlay:at,draggableNodes:W,droppableContainers:oe,droppableRects:Se,over:Ge,measureDroppableContainers:we,scrollableAncestors:gr,scrollableAncestorRects:mr,measuringConfiguration:de,measuringScheduled:De,windowRect:_t}),[ae,Fe,Qe,Le,je,it,at,W,oe,Se,Ge,we,gr,mr,de,De,_t]),$r=te.useMemo(()=>({activatorEvent:Le,activators:Ir,active:ae,activeNodeRect:Qe,ariaDescribedById:{draggable:Ie},dispatch:M,draggableNodes:W,over:Ge,measureDroppableContainers:we}),[Le,Ir,ae,Qe,M,Ie,W,Ge,we]);return gt.createElement(FQ.Provider,{value:N},gt.createElement(D3.Provider,{value:$r},gt.createElement(ZQ.Provider,{value:Ar},gt.createElement(KQ.Provider,{value:mt},f)),gt.createElement(WPe,{disabled:o?.restoreFocus===!1})),gt.createElement(WIe,{...o,hiddenTextDescribedById:Ie}));function fn(){const zr=fe?.autoScrollEnabled===!1,Mt=typeof c=="object"?c.enabled===!1:c===!1,en=j&&!zr&&!Mt;return typeof c=="object"?{...c,enabled:en}:{enabled:en}}}),JPe=te.createContext(null),gq="button",QPe="Draggable";function eke(t){let{id:e,data:r,disabled:n=!1,attributes:i}=t;const a=Jx(QPe),{activators:s,activatorEvent:o,active:c,activeNodeRect:f,ariaDescribedById:d,draggableNodes:m,over:b}=te.useContext(D3),{role:x=gq,roleDescription:E="draggable",tabIndex:T=0}=i??{},A=c?.id===e,M=te.useContext(A?KQ:JPe),[F,N]=RE(),[O,U]=RE(),j=FPe(s,e),H=nx(r);Cd(()=>(m.set(e,{id:e,key:a,node:F,activatorNode:O,data:H}),()=>{const X=m.get(e);X&&X.key===a&&m.delete(e)}),[m,e]);const W=te.useMemo(()=>({role:x,tabIndex:T,"aria-disabled":n,"aria-pressed":A&&x===gq?!0:void 0,"aria-roledescription":E,"aria-describedby":d.draggable}),[n,x,T,A,E,d.draggable]);return{active:c,activatorEvent:o,activeNodeRect:f,attributes:W,isDragging:A,listeners:n?void 0:j,node:F,over:b,setNodeRef:N,setActivatorNodeRef:U,transform:M}}function tke(){return te.useContext(ZQ)}const rke="Droppable",nke={timeout:25};function ike(t){let{data:e,disabled:r=!1,id:n,resizeObserverConfig:i}=t;const a=Jx(rke),{active:s,dispatch:o,over:c,measureDroppableContainers:f}=te.useContext(D3),d=te.useRef({disabled:r}),m=te.useRef(!1),b=te.useRef(null),x=te.useRef(null),{disabled:E,updateMeasurementsFor:T,timeout:A}={...nke,...i},M=nx(T??n),F=te.useCallback(()=>{if(!m.current){m.current=!0;return}x.current!=null&&clearTimeout(x.current),x.current=setTimeout(()=>{f(Array.isArray(M.current)?M.current:[M.current]),x.current=null},A)},[A]),N=M3({callback:F,disabled:E||!s}),O=te.useCallback((W,X)=>{N&&(X&&(N.unobserve(X),m.current=!1),W&&N.observe(W))},[N]),[U,j]=RE(O),H=nx(e);return te.useEffect(()=>{!N||!U.current||(N.disconnect(),m.current=!1,N.observe(U.current))},[U,N]),te.useEffect(()=>(o({type:Ll.RegisterDroppable,element:{id:n,key:a,disabled:r,node:U,rect:b,data:H}}),()=>o({type:Ll.UnregisterDroppable,key:a,id:n})),[n]),te.useEffect(()=>{r!==d.current.disabled&&(o({type:Ll.SetDroppableDisabled,id:n,key:a,disabled:r}),d.current.disabled=r)},[n,a,r,o]),{active:s,rect:b,isOver:c?.id===n,node:U,over:c,setNodeRef:j}}function JQ(t,e,r){const n=t.slice();return n.splice(r<0?n.length+r:r,0,n.splice(e,1)[0]),n}function ake(t,e){return t.reduce((r,n,i)=>{const a=e.get(n);return a&&(r[i]=a),r},Array(t.length))}function Nw(t){return t!==null&&t>=0}function oke(t,e){if(t===e)return!0;if(t.length!==e.length)return!1;for(let r=0;r<t.length;r++)if(t[r]!==e[r])return!1;return!0}function ske(t){return typeof t=="boolean"?{draggable:t,droppable:t}:t}const QQ=t=>{let{rects:e,activeIndex:r,overIndex:n,index:i}=t;const a=JQ(e,n,r),s=e[i],o=a[i];return!o||!s?null:{x:o.left-s.left,y:o.top-s.top,scaleX:o.width/s.width,scaleY:o.height/s.height}},Lw={scaleX:1,scaleY:1},lke=t=>{var e;let{activeIndex:r,activeNodeRect:n,index:i,rects:a,overIndex:s}=t;const o=(e=a[r])!=null?e:n;if(!o)return null;if(i===r){const f=a[s];return f?{x:0,y:r<s?f.top+f.height-(o.top+o.height):f.top-o.top,...Lw}:null}const c=uke(a,i,r);return i>r&&i<=s?{x:0,y:-o.height-c,...Lw}:i<r&&i>=s?{x:0,y:o.height+c,...Lw}:{x:0,y:0,...Lw}};function uke(t,e,r){const n=t[e],i=t[e-1],a=t[e+1];return n?r<e?i?n.top-(i.top+i.height):a?a.top-(n.top+n.height):0:a?a.top-(n.top+n.height):i?n.top-(i.top+i.height):0:0}const eee="Sortable",tee=gt.createContext({activeIndex:-1,containerId:eee,disableTransforms:!1,items:[],overIndex:-1,useDragOverlay:!1,sortedRects:[],strategy:QQ,disabled:{draggable:!1,droppable:!1}});function cke(t){let{children:e,id:r,items:n,strategy:i=QQ,disabled:a=!1}=t;const{active:s,dragOverlay:o,droppableRects:c,over:f,measureDroppableContainers:d}=tke(),m=Jx(eee,r),b=o.rect!==null,x=te.useMemo(()=>n.map(j=>typeof j=="object"&&"id"in j?j.id:j),[n]),E=s!=null,T=s?x.indexOf(s.id):-1,A=f?x.indexOf(f.id):-1,M=te.useRef(x),F=!oke(x,M.current),N=A!==-1&&T===-1||F,O=ske(a);Cd(()=>{F&&E&&d(x)},[F,x,E,d]),te.useEffect(()=>{M.current=x},[x]);const U=te.useMemo(()=>({activeIndex:T,containerId:m,disabled:O,disableTransforms:N,items:x,overIndex:A,useDragOverlay:b,sortedRects:ake(x,c),strategy:i}),[T,m,O.draggable,O.droppable,N,x,A,c,b,i]);return gt.createElement(tee.Provider,{value:U},e)}const fke=t=>{let{id:e,items:r,activeIndex:n,overIndex:i}=t;return JQ(r,n,i).indexOf(e)},hke=t=>{let{containerId:e,isSorting:r,wasDragging:n,index:i,items:a,newIndex:s,previousItems:o,previousContainerId:c,transition:f}=t;return!f||!n||o!==a&&i===s?!1:r?!0:s!==i&&e===c},dke={duration:200,easing:"ease"},ree="transform",pke=ix.Transition.toString({property:ree,duration:0,easing:"linear"}),gke={roleDescription:"sortable"};function mke(t){let{disabled:e,index:r,node:n,rect:i}=t;const[a,s]=te.useState(null),o=te.useRef(r);return Cd(()=>{if(!e&&r!==o.current&&n.current){const c=i.current;if(c){const f=C_(n.current,{ignoreTransform:!0}),d={x:c.left-f.left,y:c.top-f.top,scaleX:c.width/f.width,scaleY:c.height/f.height};(d.x||d.y)&&s(d)}}r!==o.current&&(o.current=r)},[e,r,n,i]),te.useEffect(()=>{a&&s(null)},[a]),a}function yke(t){let{animateLayoutChanges:e=hke,attributes:r,disabled:n,data:i,getNewIndex:a=fke,id:s,strategy:o,resizeObserverConfig:c,transition:f=dke}=t;const{items:d,containerId:m,activeIndex:b,disabled:x,disableTransforms:E,sortedRects:T,overIndex:A,useDragOverlay:M,strategy:F}=te.useContext(tee),N=vke(n,x),O=d.indexOf(s),U=te.useMemo(()=>({sortable:{containerId:m,index:O,items:d},...i}),[m,i,O,d]),j=te.useMemo(()=>d.slice(d.indexOf(s)),[d,s]),{rect:H,node:W,isOver:X,setNodeRef:oe}=ike({id:s,data:U,disabled:N.droppable,resizeObserverConfig:{updateMeasurementsFor:j,...c}}),{active:Q,activatorEvent:G,activeNodeRect:ae,attributes:se,setNodeRef:fe,listeners:_e,isDragging:Le,over:ye,setActivatorNodeRef:Te,transform:Ie}=eke({id:s,data:U,attributes:{...gke,...r},disabled:N.draggable}),Me=OIe(oe,fe),de=!!Q,Se=de&&!E&&Nw(b)&&Nw(A),we=!M&&Le,De=we&&Se?Ie:null,Xe=Se?De??(o??F)({rects:T,activeNodeRect:ae,activeIndex:b,overIndex:A,index:O}):null,Be=Nw(b)&&Nw(A)?a({id:s,items:d,activeIndex:b,overIndex:A}):O,st=Q?.id,Qe=te.useRef({activeId:st,items:d,newIndex:Be,containerId:m}),it=d!==Qe.current.items,be=e({active:Q,containerId:m,isDragging:Le,isSorting:de,id:s,index:O,items:d,newIndex:Qe.current.newIndex,previousItems:Qe.current.items,previousContainerId:Qe.current.containerId,transition:f,wasDragging:Qe.current.activeId!=null}),Ot=mke({disabled:!be,index:O,node:W,rect:H});return te.useEffect(()=>{de&&Qe.current.newIndex!==Be&&(Qe.current.newIndex=Be),m!==Qe.current.containerId&&(Qe.current.containerId=m),d!==Qe.current.items&&(Qe.current.items=d)},[de,Be,m,d]),te.useEffect(()=>{if(st===Qe.current.activeId)return;if(st!=null&&Qe.current.activeId==null){Qe.current.activeId=st;return}const $e=setTimeout(()=>{Qe.current.activeId=st},50);return()=>clearTimeout($e)},[st]),{active:Q,activeIndex:b,attributes:se,data:U,rect:H,index:O,newIndex:Be,items:d,isOver:X,isSorting:de,isDragging:Le,listeners:_e,node:W,overIndex:A,over:ye,setNodeRef:Me,setActivatorNodeRef:Te,setDroppableNodeRef:oe,setDraggableNodeRef:fe,transform:Ot??Xe,transition:at()};function at(){if(Ot||it&&Qe.current.newIndex===O)return pke;if(!(we&&!oL(G)||!f)&&(de||be))return ix.Transition.toString({...f,property:ree})}}function vke(t,e){var r,n;return typeof t=="boolean"?{draggable:t,droppable:!1}:{draggable:(r=t?.draggable)!=null?r:e.draggable,droppable:(n=t?.droppable)!=null?n:e.droppable}}Wa.Down,Wa.Right,Wa.Up,Wa.Left;function NE({children:t}){const e=te.useRef(_c()),{attributes:r,listeners:n,setNodeRef:i,transform:a}=yke({id:e.current}),s={transform:ix.Transform.toString(a)};return J.jsx("li",{ref:i,style:s,...r,...n,children:t})}try{NE.displayName="SortableContainer",NE.__docgenInfo={description:"",displayName:"SortableContainer",props:{}}}catch{}const _ke=Dr(Rc)({padding:"4px",marginTop:"-3px"}),bke=Dr(Rc)({marginLeft:"20px"});function dp({layerComponent:t,visible:e,type:r,name:n,description:i,configurable:a,setLayerState:s,...o}){const[c,f]=te.useState(!0),[d,m]=te.useState(!1),[b,x]=te.useState(!1),E=te.useRef(!1),T=te.useRef(e),[A,M]=te.useState(t?.props?.paint||t?.props?.options?.paint||kJ(t?.props?.type||bE(t.props.geojson))),F=te.useMemo(()=>e?c:!1,[e,c]);te.useEffect(()=>{if(!s||!t?.props?.layers||F===T.current)return;T.current=F;const j={...t?.props};switch(t.type.name){case"MlWmsLayer":break;case"MlVectorTileLayer":t?.props?.layers&&!E.current&&(j.layers=t?.props?.layers.map(H=>(H.layout?H.layout.visibility=F?"visible":"none":H.layout={visibility:F?"visible":"none"},H)),console.log("setLayerState",j.layers),s(j));break}},[F,s,t]),te.useEffect(()=>{!s||E.current||!A||t?.props?.layers||JSON.stringify(A)!==JSON.stringify(t.props?.paint)&&s({...t.props,paint:A})},[A,s,t.props?.paint]);const N=te.useMemo(()=>{if(t&&r==="layer")switch(t.type.displayName){case"MlWmsLayer":return gt.cloneElement(t,{...t?.props,visible:F});case"MlVectorTileLayer":return gt.cloneElement(t,{...t?.props});default:case"MlGeoJsonLayer":return gt.cloneElement(t,{layout:{visibility:F?"visible":"none"},options:{...t?.props?.options,...s?{}:{paint:A}}})}return J.jsx(J.Fragment,{})},[r,t,A,F,t?.props?.layers,s]),O=te.useMemo(()=>{if(t&&r==="layer"){if(t.props.type)return t.props.type;if(t.props.geojson)return bE(t.props.geojson)}},[t]),U=J.jsxs(PE,{sx:{...o.listItemSx},secondaryAction:a&&Object.keys(A)?.length>0?J.jsxs(J.Fragment,{children:[o?.buttons,J.jsx(_ke,{edge:"end","aria-label":"settings",onClick:()=>{m(j=>!j)},children:J.jsx(dN,{})})]}):void 0,children:[J.jsx(lp,{children:J.jsx(up,{disabled:!e,checked:c,onClick:()=>{f(j=>!j)}})}),J.jsx(Lf,{variant:"layerlist",primary:n,secondary:i,primaryTypographyProps:{overflow:"hidden"}})]});return J.jsxs(J.Fragment,{children:[o.sortable&&o.layerId&&!t?.props?.layers&&J.jsx(NE,{children:U}),!o.sortable&&!t?.props?.layers&&U,N,!t?.props?.layers&&Object.keys(A).length>0&&a&&d&&J.jsxs(J.Fragment,{children:[o.showDeleteButton&&J.jsxs(J.Fragment,{children:[J.jsx(bke,{edge:"end","aria-label":"delete",onClick:()=>{typeof s=="function"&&x(!0)},children:J.jsx(Hx,{})}),b&&J.jsx(e_,{open:b,onConfirm:()=>{typeof s=="function"&&(E.current=!0,s(!1),x(!1))},onCancel:()=>{x(!1)},title:"Delete layer",text:"Are you sure you want to delete this layer?"})]}),J.jsx(IE,{paintProps:A,setPaintProps:M,layerType:O})]}),t?.props?.layers&&J.jsx(qR,{visible:c,setVisible:f,name:n,children:t?.props?.layers?.map?.((j,H)=>J.jsx(kE,{vtProps:t?.props,setVtProps:s,id:""+H,visibleMaster:F},""+H))})]})}dp.defaultProps={type:"layer",visible:!0,showDeleteButton:!1,buttons:J.jsx(J.Fragment,{})};try{dp.displayName="LayerListItem",dp.__docgenInfo={description:"",displayName:"LayerListItem",props:{layerComponent:{defaultValue:null,description:"",name:"layerComponent",required:!0,type:{name:"Element"}},visible:{defaultValue:{value:"true"},description:"",name:"visible",required:!1,type:{name:"boolean"}},configurable:{defaultValue:null,description:"",name:"configurable",required:!0,type:{name:"boolean"}},type:{defaultValue:{value:"layer"},description:"",name:"type",required:!1,type:{name:"enum",value:[{value:"undefined"},{value:'"background"'},{value:'"layer"'},{value:'"background-labels"'},{value:'"wms-layer"'},{value:'"vector-tile-layer"'}]}},name:{defaultValue:null,description:"",name:"name",required:!0,type:{name:"ReactNode"}},description:{defaultValue:null,description:"",name:"description",required:!1,type:{name:"string | undefined"}},setLayerState:{defaultValue:null,description:"",name:"setLayerState",required:!1,type:{name:"Dispatch<any> | undefined"}},showDeleteButton:{defaultValue:{value:"false"},description:"",name:"showDeleteButton",required:!1,type:{name:"boolean | undefined"}},listItemSx:{defaultValue:null,description:"",name:"listItemSx",required:!1,type:{name:"SxProps | undefined"}},buttons:{defaultValue:{value:"<></>"},description:"",name:"buttons",required:!1,type:{name:"Element | undefined"}},layerId:{defaultValue:null,description:"",name:"layerId",required:!1,type:{name:"string | undefined"}},sortable:{defaultValue:null,description:"",name:"sortable",required:!1,type:{name:"boolean | undefined"}}}}}catch{}const nee=Ji(J.jsx("path",{d:"M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"})),xke=Dr("div")(()=>({display:"flex",alignItems:"center"})),wke=56,Ske=Dr(Bo)(({theme:t})=>({width:30,height:6,backgroundColor:t.palette.text.primary,borderRadius:3,position:"absolute",top:8,left:"calc(50% - 15px)"}));function iM({drawerPaperProps:t,drawerHeaderProps:e,setOpen:r,...n}){const i=Nx(c=>c.breakpoints.down("sm")),[a,s]=te.useState(!1),o=n.drawerBleeding?n.drawerBleeding:wke;return J.jsxs(J.Fragment,{children:[i?J.jsxs(Bo,{sx:{display:{xs:"flex",sm:"none"}},children:[J.jsx(oX,{styles:{".MuiDrawer-root > .MuiPaper-root":{height:`calc(50% - ${o}px)`,overflow:"visible"}}}),J.jsxs(Tye,{anchor:"bottom",open:typeof n.open>"u"?a:n.open,onClose:r?()=>{r?.(!1)}:()=>{s(!1)},onOpen:r?()=>{r?.(!0)}:()=>{s(!0)},swipeAreaWidth:o,disableSwipeToOpen:!1,hideBackdrop:!0,ModalProps:{keepMounted:!0,sx:{top:"calc(90%)"}},children:[J.jsxs(hf,{sx:{position:"absolute",top:-o,borderTopLeftRadius:8,borderTopRightRadius:8,visibility:"visible",right:0,left:0},children:[J.jsx(Ske,{}),J.jsx(Ss,{variant:"h6",sx:{p:"13px"},children:n.name})]}),J.jsx(hf,{sx:{px:"15px",pb:"15px",height:"100%",overflow:"auto",paddingTop:"20px"},children:n.children})]})]}):J.jsx(Bo,{sx:{display:{xs:"none",sm:"flex"},mr:1},children:J.jsxs(fO,{transitionDuration:0,variant:"persistent",anchor:"left",open:typeof n.open>"u"?a:n.open,PaperProps:{...t,sx:{maxWidth:{lg:"30%",md:"40%",sm:"50%",xs:"78%"},padding:{sm:"84px 20px 20px 20px",xs:"74px 10px 10px 10px"},width:{xs:"80%",sm:"60%",md:"350px",lg:"350px"},boxSizing:"border-box",...t?.sx}},sx:{flexGrow:1,zIndex:105,position:"absolute",bottom:0,display:"flex",flexDirection:"column",maxWidth:{lg:"30%",md:"40%",sm:"50%",xs:"78%"},...a?{}:{left:i?"-90vw":"-20vw"}},...n,children:[J.jsxs(xke,{...e,children:[J.jsx(Ss,{variant:"h6",children:n.name}),J.jsx(Rc,{onClick:r?()=>{r?.(!1)}:()=>{s(!1)},sx:{position:"absolute",right:"20px"},children:J.jsx(nee,{})})]}),J.jsx(Bo,{children:n.children})]})}),";"]})}try{iM.displayName="Sidebar",iM.__docgenInfo={description:"",displayName:"Sidebar",props:{drawerPaperProps:{defaultValue:null,description:"",name:"drawerPaperProps",required:!1,type:{name:"PaperProps | undefined"}},drawerHeaderProps:{defaultValue:null,description:"",name:"drawerHeaderProps",required:!1,type:{name:"Headers | undefined"}},children:{defaultValue:null,description:"The content of the component.",name:"children",required:!1,type:{name:"ReactNode"}},open:{defaultValue:{value:"false"},description:"If `true`, the component is shown.",name:"open",required:!1,type:{name:"boolean | undefined"}},setOpen:{defaultValue:null,description:"",name:"setOpen",required:!1,type:{name:"((val: boolean) => void) | undefined"}},name:{defaultValue:null,description:"",name:"name",required:!1,type:{name:"string | undefined"}},drawerBleeding:{defaultValue:null,description:"",name:"drawerBleeding",required:!1,type:{name:"number | undefined"}},component:{defaultValue:null,description:"",name:"component",required:!1,type:{name:"ElementType<any, keyof IntrinsicElements> | undefined"}},slots:{defaultValue:{value:"{}"},description:"The components used for each slot inside.",name:"slots",required:!1,type:{name:"Partial<DrawerSlots> | undefined"}},slotProps:{defaultValue:{value:"{}"},description:"The props used for each slot inside.",name:"slotProps",required:!1,type:{name:"{ root?: SlotProps<ElementType<ModalProps, keyof IntrinsicElements>, DrawerRootSlotPropsOverrides, DrawerOwnerState> | undefined; backdrop?: SlotProps<...> | undefined; docked?: SlotProps<...> | undefined; paper?: SlotProps<...> | undefined; transition?: SlotProps<...> | undefined; } | undefined"}}}}}catch{}const mq=t=>{const[e,r]=te.useState(!0),[n,i]=te.useState(t.measureType),[a,s]=te.useState(),o=va({mapId:t.mapId,waitForLayer:t.insertBeforeLayer}),[c,f]=te.useState(),[d,m]=te.useState("kilometers"),[b,x]=te.useState([]),[E,T]=te.useState(!1),A=()=>{d==="kilometers"&&m("miles"),d==="miles"&&m("kilometers")},M=N=>{x(O=>{const U=[...O];return U.splice(N,1),s(void 0),U})},F=N=>{f({measure:N.value,unit:N.unit,geojson:N.geojson})};return te.useEffect(()=>{E&&(T(!1),c&&x(N=>{const O=[...N];return O.push(c),O}))},[E]),te.useEffect(()=>{f(void 0)},[d]),J.jsx(J.Fragment,{children:J.jsxs(iM,{open:e,setOpen:r,name:"Multi Measure Tool",children:[J.jsxs(Bo,{sx:{flexGrow:1},children:[J.jsx("br",{}),J.jsxs(hp,{container:!0,spacing:4,justifyContent:"flex-start",children:[J.jsx(hp,{size:3,children:J.jsx(hg,{title:"Measure Area",children:J.jsx(ta,{variant:"outlined",sx:{backgroundColor:n==="polygon"?N=>N.palette.GPS.GPSActiveColor:N=>N.palette.GPS.GPSActiveBackgroundColor,color:n==="polygon"?N=>N.palette.GPS.GPSActiveBackgroundColor:N=>N.palette.GPS.GPSActiveColor},onClick:()=>{i("polygon"),f(void 0),T(!0)},children:J.jsx(MJ,{})})})}),J.jsx(hp,{size:3,children:J.jsx(hg,{title:"Measure Distance",children:J.jsx(ta,{variant:"outlined",sx:{backgroundColor:n==="line"?N=>N.palette.GPS.GPSActiveColor:N=>N.palette.GPS.GPSActiveBackgroundColor,color:n==="line"?N=>N.palette.GPS.GPSActiveBackgroundColor:N=>N.palette.GPS.GPSActiveColor},onClick:()=>{i("line"),f(void 0),T(!0)},children:J.jsx(RJ,{})})})})]})]}),J.jsx("br",{}),J.jsx(hp,{size:4,children:J.jsxs(sf,{children:[J.jsx(_g,{id:"unit-select-label",children:"Unit"}),J.jsxs(bg,{labelId:"unit-select-label",id:"unit-select",value:d,label:"Unit",onChange:N=>{m(N.target.value),f(void 0),T(!0)},children:[J.jsx(Fm,{value:"kilometers",children:"Kilometers"}),J.jsx(Fm,{value:"miles",children:"Miles"})]})]})}),J.jsx("br",{}),!E&&J.jsx(VR,{measureType:n,unit:d,onChange:F,...A,onFinish:()=>{T(!0)}}),J.jsxs($R,{children:[b?.map((N,O)=>J.jsx(J.Fragment,{children:J.jsxs(Bo,{sx:{display:"flex",flexDirection:"column"},children:[J.jsx("br",{}),J.jsx(Bo,{flexDirection:"row",sx:{"&:hover":{backgroundColor:"rgb(177, 177, 177, 0.2)"},marginTop:"25px"},onMouseOver:()=>{s(N.geojson)},onMouseLeave:()=>{s(void 0)},children:J.jsxs(te.Fragment,{children:[J.jsx(dp,{layerComponent:J.jsx(Nc,{mapId:t.mapId,geojson:N.geojson}),visible:!0,configurable:!0,type:"layer",name:N.geojson.geometry?.type==="LineString"?N.measure.toFixed(3).toString()+" "+N.unit:N.measure.toFixed(3).toString()+" "+N.unit+""},N.measure),J.jsx(hg,{title:"Delete",children:J.jsxs(ta,{onClick:()=>M(O),children:[" ",J.jsx(Hx,{})," "]})}),J.jsx(hg,{title:"Center Location",children:J.jsx(ta,{onClick:()=>{o?.map?.map.setCenter(N.geojson.geometry.type==="Point"?N.geojson.geometry.coordinates:uN(N.geojson).geometry.coordinates)},children:J.jsx(hN,{})})})]},N.measure+"-"+O)})]},N.measure)})),a&&J.jsx(Nc,{mapId:t.mapId,geojson:{type:"FeatureCollection",features:[a]},layerId:"highlightBorder",defaultPaintOverrides:{circle:{"circle-color":"#dd9900","circle-opacity":.4,"circle-radius":10},line:{"line-color":"#dd9900","line-opacity":.4,"line-width":10},fill:{"fill-color":"#dd9900","fill-opacity":.4}}})]})]})})};try{mq.displayName="MlMultiMeasureTool",mq.__docgenInfo={description:"",displayName:"MlMultiMeasureTool",props:{mapId:{defaultValue:null,description:"Id of the target MapLibre instance in mapContext",name:"mapId",required:!1,type:{name:"string | undefined"}},insertBeforeLayer:{defaultValue:null,description:`Id of an existing layer in the mapLibre instance to help specify the layer order
This layer will be visually beneath the layer with the "insertBeforeLayer" id.`,name:"insertBeforeLayer",required:!1,type:{name:"string | undefined"}},buttonStyleOverride:{defaultValue:null,description:`Style attribute for the button-style
https://mui.com/system/getting-started/the-sx-prop/`,name:"buttonStyleOverride",required:!1,type:{name:"SxProps | undefined"}},measureType:{defaultValue:null,description:'String that specify if the Tool measures an area ("polygon") or length ("line")',name:"measureType",required:!1,type:{name:"enum",value:[{value:"undefined"},{value:'"line"'},{value:'"polygon"'}]}},multiType:{defaultValue:null,description:"Boolean which decides if the user can switch between measure modes",name:"multiType",required:!1,type:{name:"boolean | undefined"}},unit:{defaultValue:null,description:"String that dictates which unit of measurement is used",name:"unit",required:!1,type:{name:"enum",value:[{value:"undefined"},{value:'"meters"'},{value:'"metres"'},{value:'"millimeters"'},{value:'"millimetres"'},{value:'"centimeters"'},{value:'"centimetres"'},{value:'"kilometers"'},{value:'"kilometres"'},{value:'"miles"'},{value:'"nauticalmiles"'},{value:'"inches"'},{value:'"yards"'},{value:'"feet"'},{value:'"radians"'},{value:'"degrees"'}]}},onChange:{defaultValue:null,description:`Callback function that is called each time measurment geometry within has changed within MlMeasureTool.
First parameter is the new GeoJson feature.`,name:"onChange",required:!1,type:{name:"((options: { value: number; unit?: string | undefined; geojson: Feature<Geometry, GeoJsonProperties>; geometries?: [] | undefined; }) => void) | undefined"}},onFinish:{defaultValue:null,description:"Callback function that is called by the end of drawing geometries.",name:"onFinish",required:!1,type:{name:"(() => void) | undefined"}}}}}catch{}const Eke=Ji(J.jsx("path",{d:"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6z"})),Tke=Ji(J.jsx("path",{d:"M19 13H5v-2h14z"})),aM=({className:t="",title:e,onClick:r,style:n})=>J.jsxs("svg",{width:"52",height:"53",viewBox:"0 0 52 53",fill:"none",className:t,onClick:r,role:e?"img":"presentation","aria-hidden":!e,style:n,children:[e&&J.jsx("title",{children:e}),J.jsx("circle",{cx:"26.0001",cy:"26.1843",r:"24",fill:"white",stroke:"#009EE0",strokeWidth:"2"}),J.jsx("path",{d:"M26.4915 7.59161C26.3524 8.07338 25.6698 8.07338 25.5307 7.59161L24.2998 3.3276C24.2075 3.0079 24.4474 2.68893 24.7802 2.68893H27.242C27.5748 2.68893 27.8147 3.0079 27.7224 3.3276L26.4915 7.59161Z",fill:"#009EE0"}),J.jsx("path",{d:"M25.5085 44.7598C25.6476 44.278 26.3302 44.278 26.4693 44.7598L27.7002 49.0238C27.7925 49.3435 27.5526 49.6625 27.2198 49.6625H24.758C24.4252 49.6625 24.1853 49.3435 24.2776 49.0238L25.5085 44.7598Z",fill:"#009EE0"}),J.jsx("path",{d:"M44.6641 26.4915C44.1823 26.3524 44.1823 25.6698 44.6641 25.5307L48.9281 24.2998C49.2478 24.2075 49.5668 24.4474 49.5668 24.7802V27.242C49.5668 27.5747 49.2478 27.8147 48.9281 27.7224L44.6641 26.4915Z",fill:"#009EE0"}),J.jsx("path",{d:"M7.3959 25.6085C7.87766 25.7476 7.87766 26.4302 7.3959 26.5693L3.13189 27.8002C2.81218 27.8925 2.49321 27.6526 2.49321 27.3198L2.49321 24.858C2.49321 24.5253 2.81218 24.2853 3.13189 24.3776L7.3959 25.6085Z",fill:"#009EE0"})]});try{aM.displayName="CompassBackground",aM.__docgenInfo={description:"",displayName:"CompassBackground",props:{className:{defaultValue:{value:""},description:"",name:"className",required:!1,type:{name:"string | undefined"}},title:{defaultValue:null,description:"",name:"title",required:!1,type:{name:"string | undefined"}},onClick:{defaultValue:null,description:"",name:"onClick",required:!1,type:{name:"(() => void) | undefined"}},style:{defaultValue:null,description:"",name:"style",required:!1,type:{name:"CSSProperties | undefined"}}}}}catch{}const oM=({className:t="",title:e,onClick:r,style:n})=>J.jsxs("svg",{width:"10",height:"40",viewBox:"0 0 10 40",fill:"none",className:t,onClick:r,role:e?"img":"presentation","aria-hidden":!e,style:n,children:[e&&J.jsx("title",{children:e}),J.jsxs("g",{transform:"translate(0.67544,-1.25e-5)",children:[J.jsx("path",{d:"m 3.34715,4.52028 c 0.22737,-1.05154 1.72745,-1.05154 1.95482,0 L 8.64912,20 H 0 Z",fill:"#cf003d"}),J.jsx("path",{d:"m 3.34715,35.4797 c 0.22737,1.0516 1.72745,1.0516 1.95482,0 L 8.64912,20 H 0 Z",fill:"#d3dcf0"})]})]});try{oM.displayName="CompassNeedle",oM.__docgenInfo={description:"",displayName:"CompassNeedle",props:{className:{defaultValue:{value:""},description:"",name:"className",required:!1,type:{name:"string | undefined"}},title:{defaultValue:null,description:"",name:"title",required:!1,type:{name:"string | undefined"}},onClick:{defaultValue:null,description:"",name:"onClick",required:!1,type:{name:"(() => void) | undefined"}},style:{defaultValue:null,description:"",name:"style",required:!1,type:{name:"CSSProperties | undefined"}}}}}catch{}const Cke=Dr(Bo)(({theme:t})=>({zIndex:1e3,cursor:"pointer",transform:"scale(1)",[t.breakpoints.down("md")]:{transform:"scale(1.6)"}})),Ake=Dr(Bo)(({theme:t})=>({position:"absolute",right:"-10px",top:"-52px",width:"52px",height:"52px",display:"flex",flexDirection:"row",justifyContent:"center",alignItems:"center",[t.breakpoints.down("md")]:{right:"0px",top:"-52px"},circle:{fill:t.palette.compass.compColor,stroke:t.palette.compass.compStroke},path:{fill:t.palette.compass.compStroke},"&:hover circle":{fill:t.palette.compass.compHover}})),Ike=Dr(Bo)(({theme:t})=>({display:"flex",flexDirection:"row","path:nth-of-type(2)":{fill:t.palette.compass.compSouth},"path:nth-of-type(1)":{fill:t.palette.compass.compNorth}})),sM=t=>{const e=va({mapId:t.mapId,waitForLayer:t.insertBeforeLayer}),[r,n]=te.useState(0),i=()=>{e.map?.map?.getBearing&&n(Math.round(e.map.map.getBearing()))};te.useEffect(()=>{if(e.map)return e.map.on("rotate",i,e.componentId),i(),()=>{e.map?.map.off("rotate",i)}},[e.map,t.mapId]);const a=()=>{r==0?e.map?.map.setBearing(-90):r==-90?e.map?.map.setBearing(180):r==180?e.map?.map.setBearing(90):e.map?.map.setBearing(0)};return J.jsx(J.Fragment,{children:J.jsx(Cke,{sx:{...t.style},children:J.jsxs(Ake,{onClick:a,sx:{...t.backgroundStyle},children:[J.jsx(aM,{style:{position:"absolute",top:0,left:0}}),J.jsx(Ike,{onClick:a,sx:{...t.needleStyle},children:J.jsx(oM,{style:{transform:"rotate("+(r>0?"-"+r:-1*r)+"deg)"}})})]})})})};try{sM.displayName="MlNavigationCompass",sM.__docgenInfo={description:`Navigation component that displays a compass component which indicates the current orientation of the map it is registered for and offers controls to turn the bearing 90 left/right or reset north to point up.

All style props are applied using`,displayName:"MlNavigationCompass",props:{mapId:{defaultValue:null,description:"Id of the target MapLibre instance in mapHook",name:"mapId",required:!1,type:{name:"string | undefined"}},insertBeforeLayer:{defaultValue:null,description:`The layerId of an existing layer this layer should be rendered visually beneath
https://maplibre.org/maplibre-gl-js-docs/api/map/#map#addlayer - see "beforeId" property`,name:"insertBeforeLayer",required:!1,type:{name:"string | undefined"}},style:{defaultValue:null,description:"Style object to adjust css definitions of the component.",name:"style",required:!1,type:{name:"CSSProperties | undefined"}},backgroundStyle:{defaultValue:null,description:"Style object to adjust css definitions of the background.",name:"backgroundStyle",required:!1,type:{name:"CSSProperties | undefined"}},needleStyle:{defaultValue:null,description:"Style object to adjust css definitions of the compass needle.",name:"needleStyle",required:!1,type:{name:"CSSProperties | undefined"}}}}}catch{}const Pke=Ji(J.jsx("path",{d:"m20.5 3-.16.03L15 5.1 9 3 3.36 4.9c-.21.07-.36.25-.36.48V20.5c0 .28.22.5.5.5l.16-.03L9 18.9l6 2.1 5.64-1.9c.21-.07.36-.25.36-.48V3.5c0-.28-.22-.5-.5-.5M15 19l-6-2.11V5l6 2.11z"})),kke=Ji(J.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m-1 17.93c-3.95-.49-7-3.85-7-7.93 0-.62.08-1.21.21-1.79L9 15v1c0 1.1.9 2 2 2zm6.9-2.54c-.26-.81-1-1.39-1.9-1.39h-1v-3c0-.55-.45-1-1-1H8v-2h2c.55 0 1-.45 1-1V7h2c1.1 0 2-.9 2-2v-.41c2.93 1.19 5 4.06 5 7.41 0 2.08-.8 3.97-2.1 5.39"})),Rke=Dr(ta)(({theme:t})=>({zIndex:1e3,color:t.palette.navigation.buttonColor,transform:"scale(1)"})),lM=t=>{const e=va({mapId:t.mapId,waitForLayer:t.insertBeforeLayer}),[r,n]=te.useState(t.mode||"mercator");te.useEffect(()=>{e.map?.map.getProjection?.()?.type!==r&&e.map?.setProjection({type:r})},[e.map]);const i=()=>{if(!e.map)return;const a=r==="globe"?"mercator":"globe";e.map.setProjection({type:a}),n(a)};return J.jsx(J.Fragment,{children:J.jsx(Rke,{variant:"navtools",onClick:i,style:t.style,children:r==="globe"?J.jsx(kke,{"data-testid":"PublicIcon",sx:{fontSize:{xs:"1.4em",md:"1em"}}}):J.jsx(Pke,{"data-testid":"MapIcon",sx:{fontSize:{xs:"1.4em",md:"1em"}}})})})};try{lM.displayName="MlGlobeButton",lM.__docgenInfo={description:"",displayName:"MlGlobeButton",props:{mapId:{defaultValue:null,description:"Id of the target MapLibre instance in mapContext",name:"mapId",required:!1,type:{name:"string | undefined"}},insertBeforeLayer:{defaultValue:null,description:`Id of an existing layer in the mapLibre instance to help specify the layer order
This layer will be visually beneath the layer with the "insertBeforeLayer" id.`,name:"insertBeforeLayer",required:!1,type:{name:"string | undefined"}},style:{defaultValue:null,description:"Style object to adjust css definitions of the component.",name:"style",required:!1,type:{name:"CSSProperties | undefined"}},mode:{defaultValue:null,description:"Initial projection mode of the map.",name:"mode",required:!1,type:{name:"enum",value:[{value:"undefined"},{value:'"globe"'},{value:'"mercator"'}]}}}}}catch{}const uM=t=>{const e=va({mapId:t.mapId,waitForLayer:t.insertBeforeLayer}),[r,n]=te.useState(0),i=Nx(f=>f.breakpoints.down("md")),a=Bc();te.useEffect(()=>{e.map&&(e.map.on("pitchend",()=>{e.map&&n(e.map.getPitch())},e.componentId),n(e.map.getPitch()))},[e.map,t.mapId]);const s=te.useCallback(()=>{e.map&&e.map.easeTo({zoom:e.map.getZoom()+.5})},[e.map]),o=te.useCallback(()=>{e.map&&e.map.easeTo({zoom:e.map.getZoom()-.5})},[e.map]),c=te.useCallback(()=>{if(!e.map)return;n(e.map.getPitch());const f=e.map.getPitch()!==0?0:60;e.map.easeTo({pitch:f})},[e.map]);return J.jsxs(Bo,{sx:{zIndex:501,position:"absolute",display:"flex",flexDirection:"column",right:i?"15px":"25px",bottom:i?"20px":"40px",...i?{margin:"80px 10px 50px 10px"}:{marginTop:"50px"},...t.sx},children:[J.jsx(sM,{}),t.show3DButton&&J.jsx(ta,{variant:"navtools",onClick:c,sx:{color:f=>f.palette.navigation.buttonColor},children:r<29?"2D":"3D"}),t.showGlobeButton&&J.jsx(lM,{}),t.showFollowGpsButton&&J.jsx(UR,{}),t.showCenterLocationButton&&J.jsx(Gk,{}),J.jsx(Vk,{orientation:"vertical",sx:{border:"none",Button:{minWidth:"20px !important",color:a.palette.navigation.buttonColor},"Button:hover":{border:"none"}},children:t.showZoomButtons&&J.jsxs(J.Fragment,{children:[J.jsx(ta,{variant:"navtools",onClick:s,sx:{borderBottomLeftRadius:0,borderBottomRightRadius:0,position:"relative"},children:J.jsx(Eke,{sx:{fontSize:{xs:"1.4em",md:"1em"}}})}),J.jsx(hf,{sx:{backgroundColor:"#fff"},children:J.jsx($k,{sx:{marginLeft:"6px",marginRight:"6px"}})}),J.jsx(ta,{variant:"navtools",onClick:o,sx:{margin:0,borderTopLeftRadius:0,borderTopRightRadius:0},children:J.jsx(Tke,{sx:{fontSize:{xs:"1.4em",md:"1em"}}})})]})}),t.children&&gt.cloneElement(t.children,{})]})};try{uM.displayName="MlNavigationTools",uM.__docgenInfo={description:"",displayName:"MlNavigationTools",props:{mapId:{defaultValue:null,description:"Id of the target MapLibre instance in mapContext",name:"mapId",required:!1,type:{name:"string | undefined"}},insertBeforeLayer:{defaultValue:null,description:`The layerId of an existing layer this layer should be rendered visually beneath
https://maplibre.org/maplibre-gl-js-docs/api/map/#map#addlayer - see "beforeId" property`,name:"insertBeforeLayer",required:!1,type:{name:"string | undefined"}},show3DButton:{defaultValue:null,description:"Show 3D button",name:"show3DButton",required:!1,type:{name:"boolean | undefined"}},showGlobeButton:{defaultValue:null,description:"Show global button",name:"showGlobeButton",required:!1,type:{name:"boolean | undefined"}},showZoomButtons:{defaultValue:null,description:"Show zoom button",name:"showZoomButtons",required:!1,type:{name:"boolean | undefined"}},showFollowGpsButton:{defaultValue:null,description:"Show follow GPS button",name:"showFollowGpsButton",required:!1,type:{name:"boolean | undefined"}},showCenterLocationButton:{defaultValue:null,description:"Show center on current position button",name:"showCenterLocationButton",required:!1,type:{name:"boolean | undefined"}},children:{defaultValue:null,description:"Additional JSX Elements to be rendered below MlNavigationTools buttons",name:"children",required:!1,type:{name:"Element | undefined"}},sx:{defaultValue:null,description:"Style attribute for NavigationTools container",name:"sx",required:!1,type:{name:"SxProps | undefined"}},mediaIsMobile:{defaultValue:null,description:"Style attribute for NavigationTools container",name:"mediaIsMobile",required:!1,type:{name:"boolean | undefined"}}}}}catch{}const LE=t=>(Tp({idPrefix:"MlLayer-",layerId:t.layerId,mapId:t.mapId,geojson:t.geojson||void 0,options:{type:"background",paint:{...t?.options?.type&&t.options.type!=="background"?{}:{"background-color":"rgba(0,0,0,0)"}},...t.options},insertBeforeLayer:t.insertBeforeLayer}),J.jsx(J.Fragment,{}));try{LE.displayName="MlLayer",LE.__docgenInfo={description:"Basic layer component that create a layer in a MapLibre-gl instance and keeps it updated according to it attribute configuration.",displayName:"MlLayer",props:{mapId:{defaultValue:null,description:"Id of the target MapLibre instance in mapContext",name:"mapId",required:!1,type:{name:"string | undefined"}},insertBeforeLayer:{defaultValue:null,description:`The layerId of an existing layer this layer should be rendered visually beneath
https://maplibre.org/maplibre-gl-js-docs/api/map/#map#addlayer - see "beforeId" property`,name:"insertBeforeLayer",required:!1,type:{name:"string | undefined"}},layerId:{defaultValue:null,description:"Id of the layer that will be added by this component to the maplibre-gl instance",name:"layerId",required:!1,type:{name:"string | undefined"}},options:{defaultValue:null,description:"Javascript object that is passed the addLayer command as first parameter.",name:"options",required:!1,type:{name:"Partial<LayerSpecification & { source?: string | GeoJSONSourceSpecification | undefined; id?: string | undefined; filter?: FilterSpecification | undefined; }> | undefined"}},geojson:{defaultValue:null,description:"GeoJSON data that is supposed to be rendered by this component.",name:"geojson",required:!1,type:{name:"Feature<Geometry, GeoJsonProperties> | FeatureCollection<Geometry, GeoJsonProperties> | undefined"}}}}}catch{}const yq=t=>{const e=te.useRef(0),r=va({mapId:t.mapId,waitForLayer:t.insertBeforeLayer}),[n,i]=te.useState(0),[a,s]=te.useState(""),o=te.useCallback(()=>{if(!r.map||r.map?.map.getZoom()===e.current)return;e.current=r.map?.map.getZoom();const m=t.maxWidth||100,b=r.map.map._container.clientHeight/2,x=r.map.map.unproject([0,b]),E=r.map.map.unproject([m,b]),T=x.distanceTo(E);if(t.unit==="imperial"){const A=3.2808*T;if(A>5280){const M=A/5280;c(m,M,r.map.map._getUIString("ScaleControl.Miles"))}else c(m,A,r.map.map._getUIString("ScaleControl.Feet"))}else if(t.unit==="nautical"){const A=T/1852;c(m,A,r.map.map._getUIString("ScaleControl.NauticalMiles"))}else T>=1e3?c(m,T/1e3,r.map.map._getUIString("ScaleControl.Kilometers")):c(m,T,r.map.map._getUIString("ScaleControl.Meters"))},[r.map,t.unit,t.maxWidth]);te.useEffect(()=>{if(!r.map)return;const m=o;return r.map.on("move",m,r.componentId),o(),()=>{r.map?.map.off("move",m)}},[r.map,o]);const c=(m,b,x)=>{const E=d(b),T=E/b;i(m*T),s(E+"&nbsp;"+x)},f=m=>{const b=Math.pow(10,Math.ceil(-Math.log(m)/Math.LN10));return Math.round(m*b)/b},d=m=>{const b=Math.pow(10,`${Math.floor(m)}`.length-1);let x=m/b;return x=x>=10?10:x>=5?5:x>=3?3:x>=2?2:x>=1?1:f(x),b*x};return J.jsx(J.Fragment,{children:J.jsx("div",{style:{backgroundColor:"hsla(0,0%,100%,.75)",fontSize:"10px",border:"2px solid #333",borderTop:"#333",padding:"0 5px",color:"#333",boxSizing:"border-box",width:n+"px",fontFamily:"sans-serif"},dangerouslySetInnerHTML:{__html:a}})})};try{yq.displayName="MlScaleReference",yq.__docgenInfo={description:"",displayName:"MlScaleReference",props:{mapId:{defaultValue:null,description:"",name:"mapId",required:!1,type:{name:"string | undefined"}},insertBeforeLayer:{defaultValue:null,description:"",name:"insertBeforeLayer",required:!1,type:{name:"string | undefined"}},maxWidth:{defaultValue:null,description:"",name:"maxWidth",required:!1,type:{name:"number | undefined"}},unit:{defaultValue:null,description:"",name:"unit",required:!1,type:{name:"string | undefined"}}}}}catch{}var cP,vq;function Mke(){if(vq)return cP;vq=1;function t(r,n){var i=r.getCenter(),a=r.getZoom(),s=r.getBearing(),o=r.getPitch();n.forEach(function(c){c.jumpTo({center:i,zoom:a,bearing:s,pitch:o})})}function e(){var r,n=arguments.length;if(n===1)r=arguments[0];else{r=[];for(var i=0;i<n;i++)r.push(arguments[i])}var a=[];r.forEach(function(f,d){a[d]=c.bind(null,f,r.filter(function(m,b){return b!==d}))});function s(){r.forEach(function(f,d){f.on("move",a[d])})}function o(){r.forEach(function(f,d){f.off("move",a[d])})}function c(f,d){o(),t(f,d),s()}return s(),function(){o(),a=[],r=[]}}return cP=e,cP}var Dke=Mke();const iee=Id(Dke),_q=t=>{const e=te.useContext(Ng),r=te.useRef(!1),n=te.useRef(()=>{}),[i,a]=te.useState(50),s=te.useRef(50),[o,c]=te.useState(50),f=te.useRef(50),d=te.useMemo(()=>t.magnifierRadius||200,[t.magnifierRadius]),m=te.useCallback(()=>!(!t.map1Id||!t.map2Id||!e.getMap(t.map1Id)||!e.getMap(t.map2Id)),[t,e]),b=te.useRef(()=>{m()&&E({clientX:s.current,clientY:f.current})});te.useEffect(()=>{window.addEventListener("resize",b.current);const N=b.current;return()=>{window.removeEventListener("resize",N),n.current()}},[]);const x=te.useCallback(N=>{if(!m())return;const O=e.maps[t.map1Id].getCanvas().getBoundingClientRect();let U=typeof N.touches<"u"&&typeof N.touches[0]<"u"?N.touches[0].clientX:0,j=typeof N.touches<"u"&&typeof N.touches[0]<"u"?N.touches[0].clientY:0;U-=O.x,j-=O.y;const H=parseFloat((U/O.width*100).toFixed(2)),W=parseFloat((j/O.height*100).toFixed(2));(s.current!==H||f.current!==W)&&(a(H),s.current=H,c(W),f.current=W,e.maps[t.map2Id].getContainer().style.clipPath=`circle(${d}px at `+s.current*O.width/100+"px "+f.current*O.height/100+"px)")},[e,m,t,d]),E=te.useCallback(N=>{if(!m())return;const O=e.maps[t.map1Id].getCanvas().getBoundingClientRect();let U=N.clientX,j=N.clientY;U-=O.x,j-=O.y;const H=parseFloat((U/O.width*100).toFixed(2)),W=parseFloat((j/O.height*100).toFixed(2));(s.current!==H||f.current!==W)&&(a(H),s.current=H,c(W),f.current=W,e.maps[t.map2Id].getContainer().style.clipPath=`circle(${d}px at `+s.current*O.width/100+"px "+f.current*O.height/100+"px)")},[e,m,t,d]);te.useEffect(()=>{!m()||r.current||(r.current=!0,n.current=iee(e.getMap(t.map1Id).map,e.getMap(t.map2Id).map),E({clientX:s.current,clientY:f.current}),E({clientX:e.maps[t.map1Id].getCanvas().clientWidth/2,clientY:e.maps[t.map1Id].getCanvas().clientHeight/2}))},[e.mapIds,e,m,t,E]);const T=N=>{N.nativeEvent instanceof TouchEvent?(document.addEventListener("touchmove",x),document.addEventListener("touchend",A)):(document.addEventListener("mousemove",E),document.addEventListener("mouseup",M))},A=()=>{document.removeEventListener("touchmove",x),document.removeEventListener("touchend",A)},M=()=>{document.removeEventListener("mousemove",E),document.removeEventListener("mouseup",M)},F=N=>{const O=new WheelEvent(N.type,N);e.map?.map.getCanvas().dispatchEvent(O)};return J.jsx("div",{style:{position:"absolute",left:i+"%",top:o+"%",borderRadius:"50%",width:d*2-2+"px",height:d*2-2+"px",background:"rgba(0,0,0,0)",border:"2px solid #fafafa",boxShadow:"1px 2px 2px rgba(19, 19, 19, .5), inset 1px 1px 1px rgba(19, 19, 19, .2)",cursor:"pointer",zIndex:"110",marginLeft:d*-1-1+"px",marginTop:d*-1-1+"px",textAlign:"center",lineHeight:"91px",fontSize:"2em",color:"#fafafa",userSelect:"none",...t.magnifierStyle},onTouchStart:T,onMouseDown:T,onWheel:F})};try{_q.displayName="MlLayerMagnify",_q.__docgenInfo={description:`
Hides the MapLibreMap referenced by props.map2Id except for the "magnifier"-circle that reveals
the map and can be dragged around on top of the MapLibreMap referenced by props.map1Id`,displayName:"MlLayerMagnify",props:{map1Id:{defaultValue:null,description:"Id of the first MapLibre instance",name:"map1Id",required:!0,type:{name:"string"}},map2Id:{defaultValue:null,description:"Id of the second MapLibre instance",name:"map2Id",required:!0,type:{name:"string"}},magnifierRadius:{defaultValue:null,description:'Size of the "magnifier"-circle',name:"magnifierRadius",required:!1,type:{name:"number | undefined"}},magnifierStyle:{defaultValue:null,description:"object (React.CSSProperties) that is added to the magnifier default style",name:"magnifierStyle",required:!0,type:{name:"CSSProperties | undefined"}}}}}catch{}const cM=({className:t="",title:e,onClick:r,style:n,color:i})=>J.jsxs("svg",{viewBox:"0 0 47 30",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:t,onClick:r,role:e?"img":"presentation","aria-hidden":!e,style:n,color:i,children:[J.jsx("path",{d:"M29.5 21.25L35.75 15L29.5 8.75V21.25Z",fill:"#009EE0"}),J.jsx("path",{d:"M17.5 8.75L11.25 15L17.5 21.25V8.75Z",fill:"#009EE0"})]});try{cM.displayName="SwipeIcon",cM.__docgenInfo={description:"",displayName:"SwipeIcon",props:{className:{defaultValue:{value:""},description:"",name:"className",required:!1,type:{name:"string | undefined"}},title:{defaultValue:null,description:"",name:"title",required:!1,type:{name:"string | undefined"}},onClick:{defaultValue:null,description:"",name:"onClick",required:!1,type:{name:"(() => void) | undefined"}},style:{defaultValue:null,description:"",name:"style",required:!1,type:{name:"CSSProperties | undefined"}},color:{defaultValue:null,description:"",name:"color",required:!1,type:{name:"string | undefined"}}}}}catch{}const bq=t=>{const e=te.useContext(Ng),r=te.useRef(!1),[n,i]=te.useState(50),a=te.useRef(0),s=te.useRef(()=>{}),o=te.useCallback(()=>!(!t.map1Id||!t.map2Id||!e.getMap(t.map1Id)||!e.getMap(t.map2Id)),[e,t.map1Id,t.map2Id]),c=()=>{s.current()},f=te.useCallback(T=>{if(!o())return;const A=e.maps[t.map1Id].getCanvas().getBoundingClientRect();let M=typeof T.touches<"u"&&typeof T.touches[0]<"u"?T.touches[0].clientX:0;M-=A.x;const F=parseFloat((M/A.width*100).toFixed(2));if(a.current!==F){i(F),a.current=F;const N="rect(0, "+a.current*A.width/100+"px, 999em, 0)";e.maps[t.map2Id].getContainer().style.clip=N}},[e,o,t.map1Id,t.map2Id]),d=te.useCallback(T=>{if(!o())return;const A=e.maps[t.map1Id].getCanvas().getBoundingClientRect();let M=T.clientX;M-=A.x;const F=parseFloat((M/A.width*100).toFixed(2));if(a.current!==F){i(F),a.current=F;const N="rect(0, "+a.current*A.width/100+"px, 999em, 0)";e.maps[t.map2Id].getContainer().style.clip=N}},[e,o,t.map1Id,t.map2Id]);te.useEffect(()=>c,[]),te.useEffect(()=>{!o()||r.current||(r.current=!0,s.current=iee(e.getMap(t.map1Id).map,e.getMap(t.map2Id).map),d({clientX:e.maps[t.map1Id].getCanvas().clientWidth/2}))},[e.mapIds,e,t,d,o]);const m=T=>{window?.TouchEvent&&T.nativeEvent instanceof window.TouchEvent?(document.addEventListener("touchmove",f),document.addEventListener("touchend",b)):(document.addEventListener("mousemove",d),document.addEventListener("mouseup",x))},b=()=>{document.removeEventListener("touchmove",f),document.removeEventListener("touchend",b)},x=()=>{document.removeEventListener("mousemove",d),document.removeEventListener("mouseup",x)};function E(){const T=parseFloat(e.maps[t.map2Id].getContainer().style.clip.split(",")[1].replace("px","")),A=e.maps[t.map1Id].getCanvas().getBoundingClientRect().width;if(T<A){const M=parseFloat((T/A*100).toFixed(2));i(M)}else{const M="rect(0, "+A/2+"px, 999em, 0)";e.maps[t.map2Id].getContainer().style.clip=M,i(50)}}return te.useEffect(()=>(window.addEventListener("resize",E),()=>{window.removeEventListener("resize",E)}),[e]),J.jsx("div",{style:{position:"absolute",left:n+"%",top:"50%",borderRadius:"50%",width:"65px",height:"65px",background:"rgba(234, 235, 241, 0.75)",border:"2px solid rgba(0, 158, 224, 0.75)",cursor:"pointer",zIndex:"110",marginLeft:"-35px",marginTop:"-50px",textAlign:"center",lineHeight:"91px",fontSize:"2em",color:"#fafafa",userSelect:"none",...t.buttonStyle},onTouchStart:m,onMouseDown:m,children:J.jsx(cM,{color:"#0066ff",style:{width:"65px",height:"65px",justifyContent:"center",zIndex:1100}})})};try{bq.displayName="MlLayerSwipe",bq.__docgenInfo={description:"creates a split view of 2 synchronised maplibre instances",displayName:"MlLayerSwipe",props:{map1Id:{defaultValue:null,description:"Id of the first MapLibre instance.",name:"map1Id",required:!0,type:{name:"string"}},map2Id:{defaultValue:null,description:"Id of the second MapLibre instance.",name:"map2Id",required:!0,type:{name:"string"}},buttonStyle:{defaultValue:null,description:"object (React.CSSProperties) that is added to the button default style",name:"buttonStyle",required:!0,type:{name:"CSSProperties | undefined"}}}}}catch{}const aee=function(t,e,r,n,i,a,s,o,c){if(typeof n.current[a.current]<"u"){const f=a.current+1===n.current.length?t.geojson:Su([...i.current,...n.current[a.current].geometry.coordinates]);c(f),typeof t.onTransitionFrame=="function"&&t.onTransitionFrame(f),a.current++,r.current&&a.current<n.current.length?o.current=setTimeout(()=>aee(...arguments),s):(typeof t.onTransitionEnd=="function"&&t.onTransitionEnd(t.geojson),r.current=!1)}},Oke=(t,e,r,n,i,a,s,o,c,f)=>{const d=[],m=[];let b=[],x=[];e.current=[];const E=i.current||{geometry:{type:"LineString",coordinates:[]},properties:{},type:"Feature"},T=t.geojson;let A=T,M=E,F=!1;if(typeof A.geometry>"u"&&typeof M.geometry<"u"&&M.geometry.coordinates.length>1)A=Su(M.geometry.coordinates.slice(0,2));else if(typeof M.geometry>"u"&&typeof A.geometry<"u"&&A.geometry.coordinates.length>1)M=Su(A.geometry.coordinates.slice(0,2));else if(typeof M.geometry>"u"&&typeof A.geometry>"u")return;if(A.geometry.coordinates.length<M.geometry.coordinates.length&&(A=E,M=T,F=!0),A&&M)for(let se=0,fe=A.geometry.coordinates.length;se<fe;se++)typeof M.geometry.coordinates[se]<"u"&&A.geometry.coordinates[se][0]===M.geometry.coordinates[se][0]&&A.geometry.coordinates[se][1]===M.geometry.coordinates[se][1]?e.current.push(A.geometry.coordinates[se]):(typeof A.geometry.coordinates[se]<"u"&&m.push(A.geometry.coordinates[se]),typeof M.geometry.coordinates[se]<"u"&&d.push(M.geometry.coordinates[se]));if(F?(b=d,x=m):(b=m,x=d),b.length<2&&x<2)return;const N=t.transitionTime/a,O=x.length>1?Math.round(Qb(Su(x))):0,U=b.length>1?Math.round(Qb(Su(b))):0,j=U+O,H=O/j,W=Math.round(N*H),X=Math.round(O/W*100)/100,oe=U/j,Q=Math.round(N*oe),G=Math.round(U/Q*100)/100;let ae;ae=[...xq(x,X,W)],ae.reverse(),ae=[...ae,...xq(b,G,Q)],ae.push(T),r.current=ae,s.current=1,n.current=!0,c.current=setTimeout(()=>aee(t,o,n,r,e,s,a,c,f),a)},xq=(t,e,r)=>{const n=[];if(t.length>1){const i=eSe(Su(t),e);let a=i.features[0];for(let s=0;s<r&&(n.push(a),typeof i.features[s]<"u");s++)a=Su([...a.geometry.coordinates,...i.features[s].geometry.coordinates])}return n},Nke=50,wq=t=>{const{geojson:e,...r}=t,n=va({mapId:t.mapId,waitForLayer:t.insertBeforeLayer}),i=te.useRef(!1),a=te.useRef(null),s=te.useRef(!1),o=te.useRef(void 0),c=te.useRef(!1),f=te.useRef([]),d=te.useRef([]),[m,b]=te.useState(Ep([]));te.useEffect(()=>()=>{o.current&&clearTimeout(o.current)},[]);const x=te.useCallback(()=>{Oke(t,d,f,s,a,Nke,c,n.map,o,b)},[t,n.map]);te.useEffect(()=>{!n.map||!i.current||(typeof t.transitionTime<"u"&&t.type==="line"&&a.current&&(s.current=!1,c.current=!1,f.current=[],d.current=[],x()),t.geojson&&(a.current=t.geojson))},[n.map,x,t]);const E=te.useCallback(()=>{t.type==="line"&&typeof t.transitionTime<"u"&&t.transitionTime&&typeof t.geojson<"u"&&JSON.stringify(a.current)!==JSON.stringify(t.geojson)&&(x(),a.current=t.geojson)},[t,x]);return te.useEffect(()=>{!n.mapIsReady||!t.geojson||(i.current=!0,E())},[n.mapIsReady,E,t]),J.jsx(J.Fragment,{children:J.jsx(Nc,{...r,geojson:m})})};try{wq.displayName="MlTransitionGeoJsonLayer",wq.__docgenInfo={description:'Adds source and layer of types "line", "fill" or "circle" to display GeoJSON data on the map.',displayName:"MlTransitionGeoJsonLayer",props:{mapId:{defaultValue:null,description:"Id of the target MapLibre instance in mapContext",name:"mapId",required:!1,type:{name:"string | undefined"}},insertBeforeLayer:{defaultValue:null,description:`Id of an existing layer in the mapLibre instance to help specify the layer order
This layer will be visually beneath the layer with the "insertBeforeLayer" id.
This layer will not be added to the maplibre-gl instance until a layer with an
id that matches the value of insertBeforeLayer is created.`,name:"insertBeforeLayer",required:!1,type:{name:"string | undefined"}},layerId:{defaultValue:null,description:"Id of the new layer and source that are added to the MapLibre instance",name:"layerId",required:!1,type:{name:"string | undefined"}},geojson:{defaultValue:null,description:"GeoJSON data that is supposed to be rendered by this component.",name:"geojson",required:!1,type:{name:"Feature<Geometry, GeoJsonProperties> | FeatureCollection<Geometry, GeoJsonProperties> | undefined"}},type:{defaultValue:null,description:`Type of the layer that will be added to the MapLibre instance.
All types from LayerSpecification union type are supported except the type from
RasterLayerSpecification`,name:"type",required:!1,type:{name:"enum",value:[{value:"undefined"},{value:'"symbol"'},{value:'"fill"'},{value:'"background"'},{value:'"circle"'},{value:'"line"'},{value:'"heatmap"'},{value:'"fill-extrusion"'},{value:'"hillshade"'},{value:'"color-relief"'}]}},paint:{defaultValue:null,description:`@deprecated The property should not be used. Please use the options.paint property instead. This will be removed in the next major release.
Paint property object, that is passed to the addLayer call.
Possible props depend on the layer type.
See https://maplibre.org/maplibre-gl-js-docs/style-spec/layers/
Some examples are:
https://maplibre.org/maplibre-gl-js-docs/style-spec/layers/#line
https://maplibre.org/maplibre-gl-js-docs/style-spec/layers/#circle
https://maplibre.org/maplibre-gl-js-docs/style-spec/layers/#fill
All paint types from LayerSpecification union type are supported except the paint type from
RasterLayerSpecification`,name:"paint",required:!1,type:{name:'{ "circle-radius"?: DataDrivenPropertyValueSpecification<number> | undefined; "circle-radius-transition"?: TransitionSpecification | undefined; ... 16 more ...; "circle-stroke-opacity-transition"?: TransitionSpecification | undefined; } | ... 8 more ... | undefined'}},layout:{defaultValue:null,description:`@deprecated The property should not be used. Please use the options.layout property instead. This will be removed in the next major release.
Layout property object, that is passed to the addLayer call.
Possible props depend on the layer type.
See https://maplibre.org/maplibre-gl-js-docs/style-spec/layers/
Some examples are:
https://maplibre.org/maplibre-gl-js-docs/style-spec/layers/#line
https://maplibre.org/maplibre-gl-js-docs/style-spec/layers/#circle
https://maplibre.org/maplibre-gl-js-docs/style-spec/layers/#fill
All layout types from LayerSpecification union type are supported except the layout type from
RasterLayerSpecification`,name:"layout",required:!1,type:{name:'{ "circle-sort-key"?: DataDrivenPropertyValueSpecification<number> | undefined; visibility?: VisibilitySpecification | undefined; } | ... 9 more ... | undefined'}},options:{defaultValue:null,description:"Javascript object that is spread into the addLayer commands first parameter.",name:"options",required:!1,type:{name:"Partial<LayerSpecification & { source?: string | GeoJSONSourceSpecification | undefined; id?: string | undefined; filter?: FilterSpecification | undefined; }> | undefined"}},defaultPaintOverrides:{defaultValue:null,description:'Javascript object with optional properties "fill", "line", "circle" to override implicit layer type default paint properties.',name:"defaultPaintOverrides",required:!1,type:{name:'{ circle?: { "circle-radius"?: DataDrivenPropertyValueSpecification<number> | undefined; "circle-radius-transition"?: TransitionSpecification | undefined; ... 16 more ...; "circle-stroke-opacity-transition"?: TransitionSpecification | undefined; } | undefined; fill?: { ...; } | undefined; line?: { ...; } | undefined...'}},labelProp:{defaultValue:null,description:"Property name in the GeoJSON object to be used as a label.",name:"labelProp",required:!1,type:{name:"string | undefined"}},labelOptions:{defaultValue:null,description:"Label configuration options.",name:"labelOptions",required:!1,type:{name:"Partial<LayerSpecification & { source?: string | GeoJSONSourceSpecification | undefined; id?: string | undefined; filter?: FilterSpecification | undefined; }> | undefined"}},onHover:{defaultValue:null,description:"Hover event handler that is executed whenever a geometry rendered by this component is hovered.",name:"onHover",required:!1,type:{name:"((ev: MapEventType) => void | Map$1) | undefined"}},onClick:{defaultValue:null,description:"Click event handler that is executed whenever a geometry rendered by this component is clicked.",name:"onClick",required:!1,type:{name:"((ev: MapEventType) => void | Map$1) | undefined"}},onLeave:{defaultValue:null,description:`Leave event handler that is executed whenever a geometry rendered by this component is
left/unhovered.`,name:"onLeave",required:!1,type:{name:"((ev: MapEventType) => void | Map$1) | undefined"}},transitionTime:{defaultValue:null,description:"",name:"transitionTime",required:!1,type:{name:"number | undefined"}}}}}catch{}const Lke=12,Sq=16,oee=4,Fke=16,Bke=Fke+oee,zke=200,jke=750,Uke=500,Vke=(t="top")=>{switch(t){case"bottom":return"translate(-50%, 0%)";case"left":return"translate(-100%, -50%)";case"right":return"translate(0%, -50%)";case"top-left":return"translate(-100%, -100%)";case"top-right":return"translate(0%, -100%)";case"bottom-left":return"translate(-100%, 0%)";case"bottom-right":return"translate(0%, 0%)";default:case"top":return"translate(-50%, -100%)"}};function $ke(t,e,r){const n=parseInt(String(r?.width||14),10),i=parseInt(String(r?.height||14),10),a={};switch(t){case"bottom":a.marginTop=`${e}px`;break;case"left":a.marginLeft=`-${e}px`;break;case"right":a.marginLeft=`${n+e}px`;break;case"top-left":a.marginTop=`-${i+e}px`,a.marginLeft=`-${e}px`;break;case"top-right":a.marginTop=`-${i+e}px`,a.marginLeft=`${n+e}px`;break;case"bottom-left":a.marginTop=`${e}px`,a.marginLeft=`-${e}px`;break;case"bottom-right":a.marginTop=`${e}px`,a.marginLeft=`${n+e}px`;break;case"top":default:a.marginTop=`-${i+e}px`;break}return a}const fM=({passEventsThrough:t=!0,contentOffset:e=5,showCloseButton:r=!0,...n})=>{const i=va({mapId:n.mapId,waitForLayer:n.insertBeforeLayer}),[a,s]=te.useState(null),[o,c]=te.useState(300),f=te.useRef(null),d=te.useRef(null),m=x=>{x.stopPropagation(),n.onClose?n.onClose():(a?.remove(),f.current?.remove())};te.useEffect(()=>{if(!i.map)return;f.current=document.createElement("div");const E={...{width:"12px",height:"12px",background:"linear-gradient(135deg, rgb(186, 208, 218) 0%, rgb(96, 209, 253) 100%)",border:"1px solid rgba(255, 255, 255, 0.7)",boxShadow:"0 2px 6px rgba(90, 0, 0, 0.2), 0 0 0 2px rgba(240, 147, 251, 0.2)",borderRadius:"50%"},...n.markerStyle},T=new vk.Marker({element:f.current,anchor:"center"}).setLngLat([n.lng,n.lat]).addTo(i.map.map);s(T);const A=document.createElement("div");return Object.entries(E).forEach(([M,F])=>{A.style.setProperty(M.replace(/([A-Z])/g,"-$1").toLowerCase(),String(F))}),f.current.appendChild(A),()=>{A.remove(),T.remove(),f.current?.remove()}},[i.map,n.lng,n.lat,n.markerStyle,n.anchor]),te.useEffect(()=>{a&&a.setLngLat([n.lng,n.lat])},[a,n.lng,n.lat]);function b(){const x=d.current?.contentWindow?.document;if(x&&d.current){const E=x.documentElement.scrollHeight,T=x.documentElement.scrollWidth;d.current.style.height=`${E}px`;const A=Math.max(zke,Math.min(T+Sq*2,jke));c(A)}}return f.current&&fp.createPortal(J.jsx(Bo,{sx:{position:"absolute",transform:Vke(n.anchor),...$ke(n.anchor,e,n.markerStyle),zIndex:-1,...n.containerStyle},children:J.jsxs(hf,{elevation:8,sx:{width:`${o}px`,maxWidth:"90vw",opacity:t?1:.85,pointerEvents:"auto",overflow:"hidden",position:"relative",transition:"opacity 0.2s ease-in-out, width 0.2s ease-in-out","&:hover":{opacity:1}},children:[r&&J.jsx(Rc,{onClick:m,sx:{position:"absolute",top:oee,right:Bke,zIndex:1,padding:"4px",backgroundColor:"rgba(255, 255, 255, 0.9)","&:hover":{backgroundColor:"rgba(255, 255, 255, 1)"}},size:"small",children:J.jsx(nee,{fontSize:"small"})}),J.jsx(Bo,{sx:{maxHeight:`${Uke}px`,overflowY:"auto",overflowX:"hidden"},children:J.jsx("iframe",{ref:d,onLoad:b,style:{width:"100%",border:"none",display:"block",...n.iframeStyle},srcDoc:`<div>
	<style>
		* {
			box-sizing: border-box;
		}
		body {
			margin: 0;
			padding: ${Lke}px ${Sq}px;
			${r?"padding-top: 40px;":""}
			background: transparent;
			font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen', 'Ubuntu', 'Cantarell', 'Fira Sans', 'Droid Sans', 'Helvetica Neue', sans-serif;
			font-size: 14px;
			line-height: 1.6;
			color: rgba(0, 0, 0, 0.87);
			-webkit-font-smoothing: antialiased;
			-moz-osx-font-smoothing: grayscale;
			overflow-x: hidden;
			${Object.entries(n.iframeBodyStyle||{}).map(([x,E])=>`${x.replace(/([A-Z])/g,"-$1").toLowerCase()}: ${E};`).join(" ")}
		}
		h1, h2, h3, h4, h5, h6 {
			margin: 0 0 8px 0;
			font-weight: 500;
		}
		p {
			margin: 0 0 8px 0;
		}
		table {
			border-collapse: collapse;
			width: 100%;
			max-width: 100%;
		}
		th, td {
			padding: 4px 8px;
			text-align: left;
			border-bottom: 1px solid rgba(0, 0, 0, 0.12);
			word-wrap: break-word;
		}
		th {
			font-weight: 500;
			color: rgba(0, 0, 0, 0.6);
		}
		img {
			max-width: 100%;
			height: auto;
		}
	</style>
	${n.content||""}
</div>`,sandbox:"allow-same-origin allow-popups-to-escape-sandbox allow-scripts",title:i.componentId})})]})}),f.current)};try{fM.displayName="MlMarker",fM.__docgenInfo={description:"",displayName:"MlMarker",props:{mapId:{defaultValue:null,description:"ID of the map to add the marker to",name:"mapId",required:!1,type:{name:"string | undefined"}},insertBeforeLayer:{defaultValue:null,description:"Layer ID before which to insert the marker",name:"insertBeforeLayer",required:!1,type:{name:"string | undefined"}},lng:{defaultValue:null,description:"Longitude of the marker position",name:"lng",required:!0,type:{name:"number"}},lat:{defaultValue:null,description:"Latitude of the marker position",name:"lat",required:!0,type:{name:"number"}},content:{defaultValue:null,description:"HTML content for the marker popup",name:"content",required:!1,type:{name:"string | undefined"}},markerStyle:{defaultValue:null,description:"CSS properties to apply to the marker dot",name:"markerStyle",required:!1,type:{name:"CSSProperties | undefined"}},containerStyle:{defaultValue:null,description:"CSS properties to apply to the content container",name:"containerStyle",required:!1,type:{name:"CSSProperties | undefined"}},iframeStyle:{defaultValue:null,description:"CSS properties to apply to the iframe element",name:"iframeStyle",required:!1,type:{name:"CSSProperties | undefined"}},iframeBodyStyle:{defaultValue:null,description:"CSS properties to apply to the body of the iframe",name:"iframeBodyStyle",required:!1,type:{name:"CSSProperties | undefined"}},contentOffset:{defaultValue:{value:"5"},description:"Offset in pixels between the marker and its content",name:"contentOffset",required:!1,type:{name:"number | undefined"}},passEventsThrough:{defaultValue:{value:"true"},description:"Whether mouse events pass through the marker content",name:"passEventsThrough",required:!1,type:{name:"boolean | undefined"}},showCloseButton:{defaultValue:{value:"true"},description:"Whether to show a close button to remove the marker",name:"showCloseButton",required:!1,type:{name:"boolean | undefined"}},onClose:{defaultValue:null,description:"Callback function when the close button is clicked",name:"onClose",required:!1,type:{name:"(() => void) | undefined"}},anchor:{defaultValue:null,description:"Anchor position of the marker relative to its coordinates",name:"anchor",required:!1,type:{name:"enum",value:[{value:"undefined"},{value:'"bottom"'},{value:'"left"'},{value:'"right"'},{value:'"top"'},{value:'"top-left"'},{value:'"top-right"'},{value:'"bottom-left"'},{value:'"bottom-right"'}]}}}}}catch{}var ma={},tu={},Eq;function A_(){if(Eq)return tu;Eq=1;function t(M,F,N){if(N===void 0&&(N=Array.prototype),M&&typeof N.find=="function")return N.find.call(M,F);for(var O=0;O<M.length;O++)if(r(M,O)){var U=M[O];if(F.call(void 0,U,O,M))return U}}function e(M,F){return F===void 0&&(F=Object),F&&typeof F.getOwnPropertyDescriptors=="function"&&(M=F.create(null,F.getOwnPropertyDescriptors(M))),F&&typeof F.freeze=="function"?F.freeze(M):M}function r(M,F){return Object.prototype.hasOwnProperty.call(M,F)}function n(M,F){if(M===null||typeof M!="object")throw new TypeError("target is not an object");for(var N in F)r(F,N)&&(M[N]=F[N]);return M}var i=e({allowfullscreen:!0,async:!0,autofocus:!0,autoplay:!0,checked:!0,controls:!0,default:!0,defer:!0,disabled:!0,formnovalidate:!0,hidden:!0,ismap:!0,itemscope:!0,loop:!0,multiple:!0,muted:!0,nomodule:!0,novalidate:!0,open:!0,playsinline:!0,readonly:!0,required:!0,reversed:!0,selected:!0});function a(M){return r(i,M.toLowerCase())}var s=e({area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function o(M){return r(s,M.toLowerCase())}var c=e({script:!1,style:!1,textarea:!0,title:!0});function f(M){var F=M.toLowerCase();return r(c,F)&&!c[F]}function d(M){var F=M.toLowerCase();return r(c,F)&&c[F]}function m(M){return M===x.HTML}function b(M){return m(M)||M===x.XML_XHTML_APPLICATION}var x=e({HTML:"text/html",XML_APPLICATION:"application/xml",XML_TEXT:"text/xml",XML_XHTML_APPLICATION:"application/xhtml+xml",XML_SVG_IMAGE:"image/svg+xml"}),E=Object.keys(x).map(function(M){return x[M]});function T(M){return E.indexOf(M)>-1}var A=e({HTML:"http://www.w3.org/1999/xhtml",SVG:"http://www.w3.org/2000/svg",XML:"http://www.w3.org/XML/1998/namespace",XMLNS:"http://www.w3.org/2000/xmlns/"});return tu.assign=n,tu.find=t,tu.freeze=e,tu.HTML_BOOLEAN_ATTRIBUTES=i,tu.HTML_RAW_TEXT_ELEMENTS=c,tu.HTML_VOID_ELEMENTS=s,tu.hasDefaultHTMLNamespace=b,tu.hasOwn=r,tu.isHTMLBooleanAttribute=a,tu.isHTMLRawTextElement=f,tu.isHTMLEscapableRawTextElement=d,tu.isHTMLMimeType=m,tu.isHTMLVoidElement=o,tu.isValidMimeType=T,tu.MIME_TYPE=x,tu.NAMESPACE=A,tu}var Tv={},Tq;function O3(){if(Tq)return Tv;Tq=1;var t=A_();function e(b,x){b.prototype=Object.create(Error.prototype,{constructor:{value:b},name:{value:b.name,enumerable:!0,writable:x}})}var r=t.freeze({Error:"Error",IndexSizeError:"IndexSizeError",DomstringSizeError:"DomstringSizeError",HierarchyRequestError:"HierarchyRequestError",WrongDocumentError:"WrongDocumentError",InvalidCharacterError:"InvalidCharacterError",NoDataAllowedError:"NoDataAllowedError",NoModificationAllowedError:"NoModificationAllowedError",NotFoundError:"NotFoundError",NotSupportedError:"NotSupportedError",InUseAttributeError:"InUseAttributeError",InvalidStateError:"InvalidStateError",SyntaxError:"SyntaxError",InvalidModificationError:"InvalidModificationError",NamespaceError:"NamespaceError",InvalidAccessError:"InvalidAccessError",ValidationError:"ValidationError",TypeMismatchError:"TypeMismatchError",SecurityError:"SecurityError",NetworkError:"NetworkError",AbortError:"AbortError",URLMismatchError:"URLMismatchError",QuotaExceededError:"QuotaExceededError",TimeoutError:"TimeoutError",InvalidNodeTypeError:"InvalidNodeTypeError",DataCloneError:"DataCloneError",EncodingError:"EncodingError",NotReadableError:"NotReadableError",UnknownError:"UnknownError",ConstraintError:"ConstraintError",DataError:"DataError",TransactionInactiveError:"TransactionInactiveError",ReadOnlyError:"ReadOnlyError",VersionError:"VersionError",OperationError:"OperationError",NotAllowedError:"NotAllowedError",OptOutError:"OptOutError"}),n=Object.keys(r);function i(b){return typeof b=="number"&&b>=1&&b<=25}function a(b){return typeof b=="string"&&b.substring(b.length-r.Error.length)===r.Error}function s(b,x){i(b)?(this.name=n[b],this.message=x||""):(this.message=b,this.name=a(x)?x:r.Error),Error.captureStackTrace&&Error.captureStackTrace(this,s)}e(s,!0),Object.defineProperties(s.prototype,{code:{enumerable:!0,get:function(){var b=n.indexOf(this.name);return i(b)?b:0}}});for(var o={INDEX_SIZE_ERR:1,DOMSTRING_SIZE_ERR:2,HIERARCHY_REQUEST_ERR:3,WRONG_DOCUMENT_ERR:4,INVALID_CHARACTER_ERR:5,NO_DATA_ALLOWED_ERR:6,NO_MODIFICATION_ALLOWED_ERR:7,NOT_FOUND_ERR:8,NOT_SUPPORTED_ERR:9,INUSE_ATTRIBUTE_ERR:10,INVALID_STATE_ERR:11,SYNTAX_ERR:12,INVALID_MODIFICATION_ERR:13,NAMESPACE_ERR:14,INVALID_ACCESS_ERR:15,VALIDATION_ERR:16,TYPE_MISMATCH_ERR:17,SECURITY_ERR:18,NETWORK_ERR:19,ABORT_ERR:20,URL_MISMATCH_ERR:21,QUOTA_EXCEEDED_ERR:22,TIMEOUT_ERR:23,INVALID_NODE_TYPE_ERR:24,DATA_CLONE_ERR:25},c=Object.entries(o),f=0;f<c.length;f++){var d=c[f][0];s[d]=c[f][1]}function m(b,x){this.message=b,this.locator=x,Error.captureStackTrace&&Error.captureStackTrace(this,m)}return e(m),Tv.DOMException=s,Tv.DOMExceptionName=r,Tv.ExceptionCode=o,Tv.ParseError=m,Tv}var Os={},Qi={},Cq;function see(){if(Cq)return Qi;Cq=1;function t(en){try{typeof en!="function"&&(en=RegExp);var jn=new en("","u").exec("");return!!jn&&jn[0].length===2}catch{}return!1}var e=t();function r(en){if(en.source[0]!=="[")throw new Error(en+" can not be used with chars");return en.source.slice(1,en.source.lastIndexOf("]"))}function n(en,jn){if(en.source[0]!=="[")throw new Error("/"+en.source+"/ can not be used with chars_without");if(!jn||typeof jn!="string")throw new Error(JSON.stringify(jn)+" is not a valid search");if(en.source.indexOf(jn)===-1)throw new Error('"'+jn+'" is not is /'+en.source+"/");if(jn==="-"&&en.source.indexOf(jn)!==1)throw new Error('"'+jn+'" is not at the first postion of /'+en.source+"/");return new RegExp(en.source.replace(jn,""),e?"u":"")}function i(en){var jn=this;return new RegExp(Array.prototype.slice.call(arguments).map(function(Qr){var nr=typeof Qr=="string";if(nr&&jn===void 0&&Qr==="|")throw new Error("use regg instead of reg to wrap expressions with `|`!");return nr?Qr:Qr.source}).join(""),e?"mu":"m")}function a(en){if(arguments.length===0)throw new Error("no parameters provided");return i.apply(a,["(?:"].concat(Array.prototype.slice.call(arguments),[")"]))}var s="",o=/[-\x09\x0A\x0D\x20-\x2C\x2E-\uD7FF\uE000-\uFFFD]/;e&&(o=i("[",r(o),"\\u{10000}-\\u{10FFFF}","]"));var c=/[\x20\x09\x0D\x0A]/,f=r(c),d=i(c,"+"),m=i(c,"*"),b=/[:_a-zA-Z\xC0-\xD6\xD8-\xF6\xF8-\u02FF\u0370-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/;e&&(b=i("[",r(b),"\\u{10000}-\\u{10FFFF}","]"));var x=r(b),E=i("[",x,r(/[-.0-9\xB7]/),r(/[\u0300-\u036F\u203F-\u2040]/),"]"),T=i(b,E,"*"),A=i(E,"+"),M=i("&",T,";"),F=a(/&#[0-9]+;|&#x[0-9a-fA-F]+;/),N=a(M,"|",F),O=i("%",T,";"),U=a(i('"',a(/[^%&"]/,"|",O,"|",N),"*",'"'),"|",i("'",a(/[^%&']/,"|",O,"|",N),"*","'")),j=a('"',a(/[^<&"]/,"|",N),"*",'"',"|","'",a(/[^<&']/,"|",N),"*","'"),H=n(b,":"),W=n(E,":"),X=i(H,W,"*"),oe=i(X,a(":",X),"?"),Q=i("^",oe,"$"),G=i("(",oe,")"),ae=a(/"[^"]*"|'[^']*'/),se=i(/^<\?/,"(",T,")",a(d,"(",o,"*?)"),"?",/\?>/),fe=/[\x20\x0D\x0Aa-zA-Z0-9-'()+,./:=?;!*#@$_%]/,_e=a('"',fe,'*"',"|","'",n(fe,"'"),"*'"),Le="<!--",ye="-->",Te=i(Le,a(n(o,"-"),"|",i("-",n(o,"-"))),"*",ye),Ie="#PCDATA",Me=a(i(/\(/,m,Ie,a(m,/\|/,m,oe),"*",m,/\)\*/),"|",i(/\(/,m,Ie,m,/\)/)),de=/[?*+]?/,Se=i(/\([^>]+\)/,de),we=a("EMPTY","|","ANY","|",Me,"|",Se),De="<!ELEMENT",Fe=i(De,d,a(oe,"|",O),d,a(we,"|",O),m,">"),Xe=i("NOTATION",d,/\(/,m,T,a(m,/\|/,m,T),"*",m,/\)/),Be=i(/\(/,m,A,a(m,/\|/,m,A),"*",m,/\)/),st=a(Xe,"|",Be),Qe=a(/CDATA|ID|IDREF|IDREFS|ENTITY|ENTITIES|NMTOKEN|NMTOKENS/,"|",st),it=a(/#REQUIRED|#IMPLIED/,"|",a(a("#FIXED",d),"?",j)),be=a(d,T,d,Qe,d,it),Ot="<!ATTLIST",at=i(Ot,d,T,be,"*",m,">"),$e="about:legacy-compat",Xt=a('"'+$e+'"',"|","'"+$e+"'"),$t="SYSTEM",cr="PUBLIC",_t=a(a($t,d,ae),"|",a(cr,d,_e,d,ae)),gr=i("^",a(a($t,d,"(?<SystemLiteralOnly>",ae,")"),"|",a(cr,d,"(?<PubidLiteral>",_e,")",d,"(?<SystemLiteral>",ae,")"))),mr=a(d,"NDATA",d,T),ar=a(U,"|",a(_t,mr,"?")),Cr="<!ENTITY",Er=i(Cr,d,T,d,ar,m,">"),Jt=a(U,"|",_t),ot=i(Cr,d,"%",d,T,d,Jt,m,">"),Ce=a(Er,"|",ot),xe=i(cr,d,_e),je=i("<!NOTATION",d,T,d,a(_t,"|",xe),m,">"),qe=i(m,"=",m),Ge=/1[.]\d+/,Ft=i(d,"version",qe,a("'",Ge,"'","|",'"',Ge,'"')),Et=/[A-Za-z][-A-Za-z0-9._]*/,mt=a(d,"encoding",qe,a('"',Et,'"',"|","'",Et,"'")),ct=a(d,"standalone",qe,a("'",a("yes","|","no"),"'","|",'"',a("yes","|","no"),'"')),Qt=i(/^<\?xml/,Ft,mt,"?",ct,"?",m,/\?>/),Ht="<!DOCTYPE",Ir="<![CDATA[",Ar="]]>",$r=/<!\[CDATA\[/,fn=/\]\]>/,zr=i(o,"*?",fn),Mt=i($r,zr);return Qi.chars=r,Qi.chars_without=n,Qi.detectUnicodeSupport=t,Qi.reg=i,Qi.regg=a,Qi.ABOUT_LEGACY_COMPAT=$e,Qi.ABOUT_LEGACY_COMPAT_SystemLiteral=Xt,Qi.AttlistDecl=at,Qi.CDATA_START=Ir,Qi.CDATA_END=Ar,Qi.CDSect=Mt,Qi.Char=o,Qi.Comment=Te,Qi.COMMENT_START=Le,Qi.COMMENT_END=ye,Qi.DOCTYPE_DECL_START=Ht,Qi.elementdecl=Fe,Qi.EntityDecl=Ce,Qi.EntityValue=U,Qi.ExternalID=_t,Qi.ExternalID_match=gr,Qi.Name=T,Qi.NotationDecl=je,Qi.Reference=N,Qi.PEReference=O,Qi.PI=se,Qi.PUBLIC=cr,Qi.PubidLiteral=_e,Qi.QName=oe,Qi.QName_exact=Q,Qi.QName_group=G,Qi.S=d,Qi.SChar_s=f,Qi.S_OPT=m,Qi.SYSTEM=$t,Qi.SystemLiteral=ae,Qi.UNICODE_REPLACEMENT_CHARACTER=s,Qi.UNICODE_SUPPORT=e,Qi.XMLDecl=Qt,Qi}var Aq;function lee(){if(Aq)return Os;Aq=1;var t=A_(),e=t.find,r=t.hasDefaultHTMLNamespace,n=t.hasOwn,i=t.isHTMLMimeType,a=t.isHTMLRawTextElement,s=t.isHTMLVoidElement,o=t.MIME_TYPE,c=t.NAMESPACE,f=Symbol(),d=O3(),m=d.DOMException,b=d.DOMExceptionName,x=see();function E(Re){if(Re!==f)throw new TypeError("Illegal constructor")}function T(Re){return Re!==""}function A(Re){return Re?Re.split(/[\t\n\f\r ]+/).filter(T):[]}function M(Re,He){return n(Re,He)||(Re[He]=!0),Re}function F(Re){if(!Re)return[];var He=A(Re);return Object.keys(He.reduce(M,{}))}function N(Re){return function(He){return Re&&Re.indexOf(He)!==-1}}function O(Re){if(!x.QName_exact.test(Re))throw new m(m.INVALID_CHARACTER_ERR,'invalid character in qualified name "'+Re+'"')}function U(Re,He){O(He),Re=Re||null;var Tt=null,Gt=He;if(He.indexOf(":")>=0){var Ut=He.split(":");Tt=Ut[0],Gt=Ut[1]}if(Tt!==null&&Re===null)throw new m(m.NAMESPACE_ERR,"prefix is non-null and namespace is null");if(Tt==="xml"&&Re!==t.NAMESPACE.XML)throw new m(m.NAMESPACE_ERR,'prefix is "xml" and namespace is not the XML namespace');if((Tt==="xmlns"||He==="xmlns")&&Re!==t.NAMESPACE.XMLNS)throw new m(m.NAMESPACE_ERR,'either qualifiedName or prefix is "xmlns" and namespace is not the XMLNS namespace');if(Re===t.NAMESPACE.XMLNS&&Tt!=="xmlns"&&He!=="xmlns")throw new m(m.NAMESPACE_ERR,'namespace is the XMLNS namespace and neither qualifiedName nor prefix is "xmlns"');return[Re,Tt,Gt]}function j(Re,He){for(var Tt in Re)n(Re,Tt)&&(He[Tt]=Re[Tt])}function H(Re,He){var Tt=Re.prototype;if(!(Tt instanceof He)){let Gt=function(){};Gt.prototype=He.prototype,Gt=new Gt,j(Tt,Gt),Re.prototype=Tt=Gt}Tt.constructor!=Re&&(typeof Re!="function"&&console.error("unknown Class:"+Re),Tt.constructor=Re)}var W={},X=W.ELEMENT_NODE=1,oe=W.ATTRIBUTE_NODE=2,Q=W.TEXT_NODE=3,G=W.CDATA_SECTION_NODE=4,ae=W.ENTITY_REFERENCE_NODE=5,se=W.ENTITY_NODE=6,fe=W.PROCESSING_INSTRUCTION_NODE=7,_e=W.COMMENT_NODE=8,Le=W.DOCUMENT_NODE=9,ye=W.DOCUMENT_TYPE_NODE=10,Te=W.DOCUMENT_FRAGMENT_NODE=11,Ie=W.NOTATION_NODE=12,Me=t.freeze({DOCUMENT_POSITION_DISCONNECTED:1,DOCUMENT_POSITION_PRECEDING:2,DOCUMENT_POSITION_FOLLOWING:4,DOCUMENT_POSITION_CONTAINS:8,DOCUMENT_POSITION_CONTAINED_BY:16,DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC:32});function de(Re,He){if(He.length<Re.length)return de(He,Re);var Tt=null;for(var Gt in Re){if(Re[Gt]!==He[Gt])return Tt;Tt=Re[Gt]}return Tt}function Se(Re){return Re.guid||(Re.guid=Math.random()),Re.guid}function we(){}we.prototype={length:0,item:function(Re){return Re>=0&&Re<this.length?this[Re]:null},toString:function(Re){for(var He=[],Tt=0;Tt<this.length;Tt++)nr(this[Tt],He,Re);return He.join("")},filter:function(Re){return Array.prototype.filter.call(this,Re)},indexOf:function(Re){return Array.prototype.indexOf.call(this,Re)}},we.prototype[Symbol.iterator]=function(){var Re=this,He=0;return{next:function(){return He<Re.length?{value:Re[He++],done:!1}:{done:!0}},return:function(){return{done:!0}}}};function De(Re,He){this._node=Re,this._refresh=He,Fe(this)}function Fe(Re){var He=Re._node._inc||Re._node.ownerDocument._inc;if(Re._inc!==He){var Tt=Re._refresh(Re._node);if(Kn(Re,"length",Tt.length),!Re.$$length||Tt.length<Re.$$length)for(var Gt=Tt.length;Gt in Re;Gt++)n(Re,Gt)&&delete Re[Gt];j(Tt,Re),Re._inc=He}}De.prototype.item=function(Re){return Fe(this),this[Re]||null},H(De,we);function Xe(){}function Be(Re,He){for(var Tt=0;Tt<Re.length;){if(Re[Tt]===He)return Tt;Tt++}}function st(Re,He,Tt,Gt){if(Gt?He[Be(He,Gt)]=Tt:(He[He.length]=Tt,He.length++),Re){Tt.ownerElement=Re;var Ut=Re.ownerDocument;Ut&&(Gt&&$t(Ut,Re,Gt),Xt(Ut,Re,Tt))}}function Qe(Re,He,Tt){var Gt=Be(He,Tt);if(Gt>=0){for(var Ut=He.length-1;Gt<=Ut;)He[Gt]=He[++Gt];if(He.length=Ut,Re){var Xr=Re.ownerDocument;Xr&&$t(Xr,Re,Tt),Tt.ownerElement=null}}}Xe.prototype={length:0,item:we.prototype.item,getNamedItem:function(Re){this._ownerElement&&this._ownerElement._isInHTMLDocumentAndNamespace()&&(Re=Re.toLowerCase());for(var He=0;He<this.length;){var Tt=this[He];if(Tt.nodeName===Re)return Tt;He++}return null},setNamedItem:function(Re){var He=Re.ownerElement;if(He&&He!==this._ownerElement)throw new m(m.INUSE_ATTRIBUTE_ERR);var Tt=this.getNamedItemNS(Re.namespaceURI,Re.localName);return Tt===Re?Re:(st(this._ownerElement,this,Re,Tt),Tt)},setNamedItemNS:function(Re){return this.setNamedItem(Re)},removeNamedItem:function(Re){var He=this.getNamedItem(Re);if(!He)throw new m(m.NOT_FOUND_ERR,Re);return Qe(this._ownerElement,this,He),He},removeNamedItemNS:function(Re,He){var Tt=this.getNamedItemNS(Re,He);if(!Tt)throw new m(m.NOT_FOUND_ERR,Re?Re+" : "+He:He);return Qe(this._ownerElement,this,Tt),Tt},getNamedItemNS:function(Re,He){Re||(Re=null);for(var Tt=0;Tt<this.length;){var Gt=this[Tt];if(Gt.localName===He&&Gt.namespaceURI===Re)return Gt;Tt++}return null}},Xe.prototype[Symbol.iterator]=function(){var Re=this,He=0;return{next:function(){return He<Re.length?{value:Re[He++],done:!1}:{done:!0}},return:function(){return{done:!0}}}};function it(){}it.prototype={hasFeature:function(Re,He){return!0},createDocument:function(Re,He,Tt){var Gt=o.XML_APPLICATION;Re===c.HTML?Gt=o.XML_XHTML_APPLICATION:Re===c.SVG&&(Gt=o.XML_SVG_IMAGE);var Ut=new $e(f,{contentType:Gt});if(Ut.implementation=this,Ut.childNodes=new we,Ut.doctype=Tt||null,Tt&&Ut.appendChild(Tt),He){var Xr=Ut.createElementNS(Re,He);Ut.appendChild(Xr)}return Ut},createDocumentType:function(Re,He,Tt,Gt){O(Re);var Ut=new Ht(f);return Ut.name=Re,Ut.nodeName=Re,Ut.publicId=He||"",Ut.systemId=Tt||"",Ut.internalSubset=Gt||"",Ut.childNodes=new we,Ut},createHTMLDocument:function(Re){var He=new $e(f,{contentType:o.HTML});if(He.implementation=this,He.childNodes=new we,Re!==!1){He.doctype=this.createDocumentType("html"),He.doctype.ownerDocument=He,He.appendChild(He.doctype);var Tt=He.createElement("html");He.appendChild(Tt);var Gt=He.createElement("head");if(Tt.appendChild(Gt),typeof Re=="string"){var Ut=He.createElement("title");Ut.appendChild(He.createTextNode(Re)),Gt.appendChild(Ut)}Tt.appendChild(He.createElement("body"))}return He}};function be(Re){E(Re)}be.prototype={firstChild:null,lastChild:null,previousSibling:null,nextSibling:null,parentNode:null,get parentElement(){return this.parentNode&&this.parentNode.nodeType===this.ELEMENT_NODE?this.parentNode:null},childNodes:null,ownerDocument:null,nodeValue:null,namespaceURI:null,prefix:null,localName:null,baseURI:"about:blank",get isConnected(){var Re=this.getRootNode();return Re&&Re.nodeType===Re.DOCUMENT_NODE},contains:function(Re){if(!Re)return!1;var He=Re;do{if(this===He)return!0;He=Re.parentNode}while(He);return!1},getRootNode:function(Re){var He=this;do{if(!He.parentNode)return He;He=He.parentNode}while(He)},isEqualNode:function(Re){if(!Re||this.nodeType!==Re.nodeType)return!1;switch(this.nodeType){case this.DOCUMENT_TYPE_NODE:if(this.name!==Re.name||this.publicId!==Re.publicId||this.systemId!==Re.systemId)return!1;break;case this.ELEMENT_NODE:if(this.namespaceURI!==Re.namespaceURI||this.prefix!==Re.prefix||this.localName!==Re.localName||this.attributes.length!==Re.attributes.length)return!1;for(var He=0;He<this.attributes.length;He++){var Tt=this.attributes.item(He);if(!Tt.isEqualNode(Re.getAttributeNodeNS(Tt.namespaceURI,Tt.localName)))return!1}break;case this.ATTRIBUTE_NODE:if(this.namespaceURI!==Re.namespaceURI||this.localName!==Re.localName||this.value!==Re.value)return!1;break;case this.PROCESSING_INSTRUCTION_NODE:if(this.target!==Re.target||this.data!==Re.data)return!1;break;case this.TEXT_NODE:case this.COMMENT_NODE:if(this.data!==Re.data)return!1;break}if(this.childNodes.length!==Re.childNodes.length)return!1;for(var He=0;He<this.childNodes.length;He++)if(!this.childNodes[He].isEqualNode(Re.childNodes[He]))return!1;return!0},isSameNode:function(Re){return this===Re},insertBefore:function(Re,He){return qe(this,Re,He)},replaceChild:function(Re,He){qe(this,Re,He,je),He&&this.removeChild(He)},removeChild:function(Re){return _t(this,Re)},appendChild:function(Re){return this.insertBefore(Re,null)},hasChildNodes:function(){return this.firstChild!=null},cloneNode:function(Re){return un(this.ownerDocument||this,this,Re)},normalize:function(){for(var Re=this.firstChild;Re;){var He=Re.nextSibling;He&&He.nodeType==Q&&Re.nodeType==Q?(this.removeChild(He),Re.appendData(He.data)):(Re.normalize(),Re=He)}},isSupported:function(Re,He){return this.ownerDocument.implementation.hasFeature(Re,He)},lookupPrefix:function(Re){for(var He=this;He;){var Tt=He._nsMap;if(Tt){for(var Gt in Tt)if(n(Tt,Gt)&&Tt[Gt]===Re)return Gt}He=He.nodeType==oe?He.ownerDocument:He.parentNode}return null},lookupNamespaceURI:function(Re){for(var He=this;He;){var Tt=He._nsMap;if(Tt&&n(Tt,Re))return Tt[Re];He=He.nodeType==oe?He.ownerDocument:He.parentNode}return null},isDefaultNamespace:function(Re){var He=this.lookupPrefix(Re);return He==null},compareDocumentPosition:function(Re){if(this===Re)return 0;var He=Re,Tt=this,Gt=null,Ut=null;if(He instanceof Ft&&(Gt=He,He=Gt.ownerElement),Tt instanceof Ft&&(Ut=Tt,Tt=Ut.ownerElement,Gt&&He&&Tt===He))for(var Xr=0,Nn;Nn=Tt.attributes[Xr];Xr++){if(Nn===Gt)return Me.DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC+Me.DOCUMENT_POSITION_PRECEDING;if(Nn===Ut)return Me.DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC+Me.DOCUMENT_POSITION_FOLLOWING}if(!He||!Tt||Tt.ownerDocument!==He.ownerDocument)return Me.DOCUMENT_POSITION_DISCONNECTED+Me.DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC+(Se(Tt.ownerDocument)>Se(He.ownerDocument)?Me.DOCUMENT_POSITION_FOLLOWING:Me.DOCUMENT_POSITION_PRECEDING);if(Ut&&He===Tt)return Me.DOCUMENT_POSITION_CONTAINS+Me.DOCUMENT_POSITION_PRECEDING;if(Gt&&He===Tt)return Me.DOCUMENT_POSITION_CONTAINED_BY+Me.DOCUMENT_POSITION_FOLLOWING;for(var Bi=[],Ci=He.parentNode;Ci;){if(!Ut&&Ci===Tt)return Me.DOCUMENT_POSITION_CONTAINED_BY+Me.DOCUMENT_POSITION_FOLLOWING;Bi.push(Ci),Ci=Ci.parentNode}Bi.reverse();for(var Fr=[],Mn=Tt.parentNode;Mn;){if(!Gt&&Mn===He)return Me.DOCUMENT_POSITION_CONTAINS+Me.DOCUMENT_POSITION_PRECEDING;Fr.push(Mn),Mn=Mn.parentNode}Fr.reverse();var Bn=de(Bi,Fr);for(var ei in Bn.childNodes){var ua=Bn.childNodes[ei];if(ua===Tt)return Me.DOCUMENT_POSITION_FOLLOWING;if(ua===He)return Me.DOCUMENT_POSITION_PRECEDING;if(Fr.indexOf(ua)>=0)return Me.DOCUMENT_POSITION_FOLLOWING;if(Bi.indexOf(ua)>=0)return Me.DOCUMENT_POSITION_PRECEDING}return 0}};function Ot(Re){return Re=="<"&&"&lt;"||Re==">"&&"&gt;"||Re=="&"&&"&amp;"||Re=='"'&&"&quot;"||"&#"+Re.charCodeAt()+";"}j(W,be),j(W,be.prototype),j(Me,be),j(Me,be.prototype);function at(Re,He){if(He(Re))return!0;if(Re=Re.firstChild)do if(at(Re,He))return!0;while(Re=Re.nextSibling)}function $e(Re,He){E(Re);var Tt=He||{};this.ownerDocument=this,this.contentType=Tt.contentType||o.XML_APPLICATION,this.type=i(this.contentType)?"html":"xml"}function Xt(Re,He,Tt){Re&&Re._inc++;var Gt=Tt.namespaceURI;Gt===c.XMLNS&&(He._nsMap[Tt.prefix?Tt.localName:""]=Tt.value)}function $t(Re,He,Tt,Gt){Re&&Re._inc++;var Ut=Tt.namespaceURI;Ut===c.XMLNS&&delete He._nsMap[Tt.prefix?Tt.localName:""]}function cr(Re,He,Tt){if(Re&&Re._inc){Re._inc++;var Gt=He.childNodes;if(Tt&&!Tt.nextSibling)Gt[Gt.length++]=Tt;else{for(var Ut=He.firstChild,Xr=0;Ut;)Gt[Xr++]=Ut,Ut=Ut.nextSibling;Gt.length=Xr,delete Gt[Gt.length]}}}function _t(Re,He){if(Re!==He.parentNode)throw new m(m.NOT_FOUND_ERR,"child's parent is not parent");var Tt=He.previousSibling,Gt=He.nextSibling;return Tt?Tt.nextSibling=Gt:Re.firstChild=Gt,Gt?Gt.previousSibling=Tt:Re.lastChild=Tt,cr(Re.ownerDocument,Re),He.parentNode=null,He.previousSibling=null,He.nextSibling=null,He}function gr(Re){return Re&&(Re.nodeType===be.DOCUMENT_NODE||Re.nodeType===be.DOCUMENT_FRAGMENT_NODE||Re.nodeType===be.ELEMENT_NODE)}function mr(Re){return Re&&(Re.nodeType===be.CDATA_SECTION_NODE||Re.nodeType===be.COMMENT_NODE||Re.nodeType===be.DOCUMENT_FRAGMENT_NODE||Re.nodeType===be.DOCUMENT_TYPE_NODE||Re.nodeType===be.ELEMENT_NODE||Re.nodeType===be.PROCESSING_INSTRUCTION_NODE||Re.nodeType===be.TEXT_NODE)}function ar(Re){return Re&&Re.nodeType===be.DOCUMENT_TYPE_NODE}function Cr(Re){return Re&&Re.nodeType===be.ELEMENT_NODE}function Er(Re){return Re&&Re.nodeType===be.TEXT_NODE}function Jt(Re,He){var Tt=Re.childNodes||[];if(e(Tt,Cr)||ar(He))return!1;var Gt=e(Tt,ar);return!(He&&Gt&&Tt.indexOf(Gt)>Tt.indexOf(He))}function ot(Re,He){var Tt=Re.childNodes||[];function Gt(Xr){return Cr(Xr)&&Xr!==He}if(e(Tt,Gt))return!1;var Ut=e(Tt,ar);return!(He&&Ut&&Tt.indexOf(Ut)>Tt.indexOf(He))}function Ce(Re,He,Tt){if(!gr(Re))throw new m(m.HIERARCHY_REQUEST_ERR,"Unexpected parent node type "+Re.nodeType);if(Tt&&Tt.parentNode!==Re)throw new m(m.NOT_FOUND_ERR,"child not in parent");if(!mr(He)||ar(He)&&Re.nodeType!==be.DOCUMENT_NODE)throw new m(m.HIERARCHY_REQUEST_ERR,"Unexpected node type "+He.nodeType+" for parent node type "+Re.nodeType)}function xe(Re,He,Tt){var Gt=Re.childNodes||[],Ut=He.childNodes||[];if(He.nodeType===be.DOCUMENT_FRAGMENT_NODE){var Xr=Ut.filter(Cr);if(Xr.length>1||e(Ut,Er))throw new m(m.HIERARCHY_REQUEST_ERR,"More than one element or text in fragment");if(Xr.length===1&&!Jt(Re,Tt))throw new m(m.HIERARCHY_REQUEST_ERR,"Element in fragment can not be inserted before doctype")}if(Cr(He)&&!Jt(Re,Tt))throw new m(m.HIERARCHY_REQUEST_ERR,"Only one element can be added and only after doctype");if(ar(He)){if(e(Gt,ar))throw new m(m.HIERARCHY_REQUEST_ERR,"Only one doctype is allowed");var Nn=e(Gt,Cr);if(Tt&&Gt.indexOf(Nn)<Gt.indexOf(Tt))throw new m(m.HIERARCHY_REQUEST_ERR,"Doctype can only be inserted before an element");if(!Tt&&Nn)throw new m(m.HIERARCHY_REQUEST_ERR,"Doctype can not be appended since element is present")}}function je(Re,He,Tt){var Gt=Re.childNodes||[],Ut=He.childNodes||[];if(He.nodeType===be.DOCUMENT_FRAGMENT_NODE){var Xr=Ut.filter(Cr);if(Xr.length>1||e(Ut,Er))throw new m(m.HIERARCHY_REQUEST_ERR,"More than one element or text in fragment");if(Xr.length===1&&!ot(Re,Tt))throw new m(m.HIERARCHY_REQUEST_ERR,"Element in fragment can not be inserted before doctype")}if(Cr(He)&&!ot(Re,Tt))throw new m(m.HIERARCHY_REQUEST_ERR,"Only one element can be added and only after doctype");if(ar(He)){if(e(Gt,function(Ci){return ar(Ci)&&Ci!==Tt}))throw new m(m.HIERARCHY_REQUEST_ERR,"Only one doctype is allowed");var Nn=e(Gt,Cr);if(Tt&&Gt.indexOf(Nn)<Gt.indexOf(Tt))throw new m(m.HIERARCHY_REQUEST_ERR,"Doctype can only be inserted before an element")}}function qe(Re,He,Tt,Gt){Ce(Re,He,Tt),Re.nodeType===be.DOCUMENT_NODE&&(Gt||xe)(Re,He,Tt);var Ut=He.parentNode;if(Ut&&Ut.removeChild(He),He.nodeType===Te){var Xr=He.firstChild;if(Xr==null)return He;var Nn=He.lastChild}else Xr=Nn=He;var Bi=Tt?Tt.previousSibling:Re.lastChild;Xr.previousSibling=Bi,Nn.nextSibling=Tt,Bi?Bi.nextSibling=Xr:Re.firstChild=Xr,Tt==null?Re.lastChild=Nn:Tt.previousSibling=Nn;do Xr.parentNode=Re;while(Xr!==Nn&&(Xr=Xr.nextSibling));return cr(Re.ownerDocument||Re,Re,He),He.nodeType==Te&&(He.firstChild=He.lastChild=null),He}$e.prototype={implementation:null,nodeName:"#document",nodeType:Le,doctype:null,documentElement:null,_inc:1,insertBefore:function(Re,He){if(Re.nodeType===Te){for(var Tt=Re.firstChild;Tt;){var Gt=Tt.nextSibling;this.insertBefore(Tt,He),Tt=Gt}return Re}return qe(this,Re,He),Re.ownerDocument=this,this.documentElement===null&&Re.nodeType===X&&(this.documentElement=Re),Re},removeChild:function(Re){var He=_t(this,Re);return He===this.documentElement&&(this.documentElement=null),He},replaceChild:function(Re,He){qe(this,Re,He,je),Re.ownerDocument=this,He&&this.removeChild(He),Cr(Re)&&(this.documentElement=Re)},importNode:function(Re,He){return oi(this,Re,He)},getElementById:function(Re){var He=null;return at(this.documentElement,function(Tt){if(Tt.nodeType==X&&Tt.getAttribute("id")==Re)return He=Tt,!0}),He},createElement:function(Re){var He=new Ge(f);He.ownerDocument=this,this.type==="html"&&(Re=Re.toLowerCase()),r(this.contentType)&&(He.namespaceURI=c.HTML),He.nodeName=Re,He.tagName=Re,He.localName=Re,He.childNodes=new we;var Tt=He.attributes=new Xe;return Tt._ownerElement=He,He},createDocumentFragment:function(){var Re=new fn(f);return Re.ownerDocument=this,Re.childNodes=new we,Re},createTextNode:function(Re){var He=new mt(f);return He.ownerDocument=this,He.childNodes=new we,He.appendData(Re),He},createComment:function(Re){var He=new ct(f);return He.ownerDocument=this,He.childNodes=new we,He.appendData(Re),He},createCDATASection:function(Re){var He=new Qt(f);return He.ownerDocument=this,He.childNodes=new we,He.appendData(Re),He},createProcessingInstruction:function(Re,He){var Tt=new zr(f);return Tt.ownerDocument=this,Tt.childNodes=new we,Tt.nodeName=Tt.target=Re,Tt.nodeValue=Tt.data=He,Tt},createAttribute:function(Re){if(!x.QName_exact.test(Re))throw new m(m.INVALID_CHARACTER_ERR,'invalid character in name "'+Re+'"');return this.type==="html"&&(Re=Re.toLowerCase()),this._createAttribute(Re)},_createAttribute:function(Re){var He=new Ft(f);return He.ownerDocument=this,He.childNodes=new we,He.name=Re,He.nodeName=Re,He.localName=Re,He.specified=!0,He},createEntityReference:function(Re){if(!x.Name.test(Re))throw new m(m.INVALID_CHARACTER_ERR,'not a valid xml name "'+Re+'"');if(this.type==="html")throw new m("document is an html document",b.NotSupportedError);var He=new $r(f);return He.ownerDocument=this,He.childNodes=new we,He.nodeName=Re,He},createElementNS:function(Re,He){var Tt=U(Re,He),Gt=new Ge(f),Ut=Gt.attributes=new Xe;return Gt.childNodes=new we,Gt.ownerDocument=this,Gt.nodeName=He,Gt.tagName=He,Gt.namespaceURI=Tt[0],Gt.prefix=Tt[1],Gt.localName=Tt[2],Ut._ownerElement=Gt,Gt},createAttributeNS:function(Re,He){var Tt=U(Re,He),Gt=new Ft(f);return Gt.ownerDocument=this,Gt.childNodes=new we,Gt.nodeName=He,Gt.name=He,Gt.specified=!0,Gt.namespaceURI=Tt[0],Gt.prefix=Tt[1],Gt.localName=Tt[2],Gt}},H($e,be);function Ge(Re){E(Re),this._nsMap=Object.create(null)}Ge.prototype={nodeType:X,attributes:null,getQualifiedName:function(){return this.prefix?this.prefix+":"+this.localName:this.localName},_isInHTMLDocumentAndNamespace:function(){return this.ownerDocument.type==="html"&&this.namespaceURI===c.HTML},hasAttributes:function(){return!!(this.attributes&&this.attributes.length)},hasAttribute:function(Re){return!!this.getAttributeNode(Re)},getAttribute:function(Re){var He=this.getAttributeNode(Re);return He?He.value:null},getAttributeNode:function(Re){return this._isInHTMLDocumentAndNamespace()&&(Re=Re.toLowerCase()),this.attributes.getNamedItem(Re)},setAttribute:function(Re,He){this._isInHTMLDocumentAndNamespace()&&(Re=Re.toLowerCase());var Tt=this.getAttributeNode(Re);Tt?Tt.value=Tt.nodeValue=""+He:(Tt=this.ownerDocument._createAttribute(Re),Tt.value=Tt.nodeValue=""+He,this.setAttributeNode(Tt))},removeAttribute:function(Re){var He=this.getAttributeNode(Re);He&&this.removeAttributeNode(He)},setAttributeNode:function(Re){return this.attributes.setNamedItem(Re)},setAttributeNodeNS:function(Re){return this.attributes.setNamedItemNS(Re)},removeAttributeNode:function(Re){return this.attributes.removeNamedItem(Re.nodeName)},removeAttributeNS:function(Re,He){var Tt=this.getAttributeNodeNS(Re,He);Tt&&this.removeAttributeNode(Tt)},hasAttributeNS:function(Re,He){return this.getAttributeNodeNS(Re,He)!=null},getAttributeNS:function(Re,He){var Tt=this.getAttributeNodeNS(Re,He);return Tt?Tt.value:null},setAttributeNS:function(Re,He,Tt){var Gt=U(Re,He),Ut=Gt[2],Xr=this.getAttributeNodeNS(Re,Ut);Xr?Xr.value=Xr.nodeValue=""+Tt:(Xr=this.ownerDocument.createAttributeNS(Re,He),Xr.value=Xr.nodeValue=""+Tt,this.setAttributeNode(Xr))},getAttributeNodeNS:function(Re,He){return this.attributes.getNamedItemNS(Re,He)},getElementsByClassName:function(Re){var He=F(Re);return new De(this,function(Tt){var Gt=[];return He.length>0&&at(Tt,function(Ut){if(Ut!==Tt&&Ut.nodeType===X){var Xr=Ut.getAttribute("class");if(Xr){var Nn=Re===Xr;if(!Nn){var Bi=F(Xr);Nn=He.every(N(Bi))}Nn&&Gt.push(Ut)}}}),Gt})},getElementsByTagName:function(Re){var He=(this.nodeType===Le?this:this.ownerDocument).type==="html",Tt=Re.toLowerCase();return new De(this,function(Gt){var Ut=[];return at(Gt,function(Xr){if(!(Xr===Gt||Xr.nodeType!==X))if(Re==="*")Ut.push(Xr);else{var Nn=Xr.getQualifiedName(),Bi=He&&Xr.namespaceURI===c.HTML?Tt:Re;Nn===Bi&&Ut.push(Xr)}}),Ut})},getElementsByTagNameNS:function(Re,He){return new De(this,function(Tt){var Gt=[];return at(Tt,function(Ut){Ut!==Tt&&Ut.nodeType===X&&(Re==="*"||Ut.namespaceURI===Re)&&(He==="*"||Ut.localName==He)&&Gt.push(Ut)}),Gt})}},$e.prototype.getElementsByClassName=Ge.prototype.getElementsByClassName,$e.prototype.getElementsByTagName=Ge.prototype.getElementsByTagName,$e.prototype.getElementsByTagNameNS=Ge.prototype.getElementsByTagNameNS,H(Ge,be);function Ft(Re){E(Re),this.namespaceURI=null,this.prefix=null,this.ownerElement=null}Ft.prototype.nodeType=oe,H(Ft,be);function Et(Re){E(Re)}Et.prototype={data:"",substringData:function(Re,He){return this.data.substring(Re,Re+He)},appendData:function(Re){Re=this.data+Re,this.nodeValue=this.data=Re,this.length=Re.length},insertData:function(Re,He){this.replaceData(Re,0,He)},deleteData:function(Re,He){this.replaceData(Re,He,"")},replaceData:function(Re,He,Tt){var Gt=this.data.substring(0,Re),Ut=this.data.substring(Re+He);Tt=Gt+Tt+Ut,this.nodeValue=this.data=Tt,this.length=Tt.length}},H(Et,be);function mt(Re){E(Re)}mt.prototype={nodeName:"#text",nodeType:Q,splitText:function(Re){var He=this.data,Tt=He.substring(Re);He=He.substring(0,Re),this.data=this.nodeValue=He,this.length=He.length;var Gt=this.ownerDocument.createTextNode(Tt);return this.parentNode&&this.parentNode.insertBefore(Gt,this.nextSibling),Gt}},H(mt,Et);function ct(Re){E(Re)}ct.prototype={nodeName:"#comment",nodeType:_e},H(ct,Et);function Qt(Re){E(Re)}Qt.prototype={nodeName:"#cdata-section",nodeType:G},H(Qt,mt);function Ht(Re){E(Re)}Ht.prototype.nodeType=ye,H(Ht,be);function Ir(Re){E(Re)}Ir.prototype.nodeType=Ie,H(Ir,be);function Ar(Re){E(Re)}Ar.prototype.nodeType=se,H(Ar,be);function $r(Re){E(Re)}$r.prototype.nodeType=ae,H($r,be);function fn(Re){E(Re)}fn.prototype.nodeName="#document-fragment",fn.prototype.nodeType=Te,H(fn,be);function zr(Re){E(Re)}zr.prototype.nodeType=fe,H(zr,Et);function Mt(){}Mt.prototype.serializeToString=function(Re,He){return en.call(Re,He)},be.prototype.toString=en;function en(Re){var He=[],Tt=this.nodeType===Le&&this.documentElement||this,Gt=Tt.prefix,Ut=Tt.namespaceURI;if(Ut&&Gt==null){var Gt=Tt.lookupPrefix(Ut);if(Gt==null)var Xr=[{namespace:Ut,prefix:null}]}return nr(this,He,Re,Xr),He.join("")}function jn(Re,He,Tt){var Gt=Re.prefix||"",Ut=Re.namespaceURI;if(!Ut||Gt==="xml"&&Ut===c.XML||Ut===c.XMLNS)return!1;for(var Xr=Tt.length;Xr--;){var Nn=Tt[Xr];if(Nn.prefix===Gt)return Nn.namespace!==Ut}return!0}function Qr(Re,He,Tt){Re.push(" ",He,'="',Tt.replace(/[<>&"\t\n\r]/g,Ot),'"')}function nr(Re,He,Tt,Gt){Gt||(Gt=[]);var Ut=Re.nodeType===Le?Re:Re.ownerDocument,Xr=Ut.type==="html";if(Tt)if(Re=Tt(Re),Re){if(typeof Re=="string"){He.push(Re);return}}else return;switch(Re.nodeType){case X:var Nn=Re.attributes,Bi=Nn.length,Ca=Re.firstChild,Ci=Re.tagName,Fr=Ci;if(!Xr&&!Re.prefix&&Re.namespaceURI){for(var Mn,Bn=0;Bn<Nn.length;Bn++)if(Nn.item(Bn).name==="xmlns"){Mn=Nn.item(Bn).value;break}if(!Mn)for(var ei=Gt.length-1;ei>=0;ei--){var ua=Gt[ei];if(ua.prefix===""&&ua.namespace===Re.namespaceURI){Mn=ua.namespace;break}}if(Mn!==Re.namespaceURI)for(var ei=Gt.length-1;ei>=0;ei--){var ua=Gt[ei];if(ua.namespace===Re.namespaceURI){ua.prefix&&(Fr=ua.prefix+":"+Ci);break}}}He.push("<",Fr);for(var ha=0;ha<Bi;ha++){var zn=Nn.item(ha);zn.prefix=="xmlns"?Gt.push({prefix:zn.localName,namespace:zn.value}):zn.nodeName=="xmlns"&&Gt.push({prefix:"",namespace:zn.value})}for(var ha=0;ha<Bi;ha++){var zn=Nn.item(ha);if(jn(zn,Xr,Gt)){var La=zn.prefix||"",Wi=zn.namespaceURI;Qr(He,La?"xmlns:"+La:"xmlns",Wi),Gt.push({prefix:La,namespace:Wi})}nr(zn,He,Tt,Gt)}if(Ci===Fr&&jn(Re,Xr,Gt)){var La=Re.prefix||"",Wi=Re.namespaceURI;Qr(He,La?"xmlns:"+La:"xmlns",Wi),Gt.push({prefix:La,namespace:Wi})}var hs=!Ca;if(hs&&(Xr||Re.namespaceURI===c.HTML)&&(hs=s(Ci)),hs)He.push("/>");else{if(He.push(">"),Xr&&a(Ci))for(;Ca;)Ca.data?He.push(Ca.data):nr(Ca,He,Tt,Gt.slice()),Ca=Ca.nextSibling;else for(;Ca;)nr(Ca,He,Tt,Gt.slice()),Ca=Ca.nextSibling;He.push("</",Fr,">")}return;case Le:case Te:for(var Ca=Re.firstChild;Ca;)nr(Ca,He,Tt,Gt.slice()),Ca=Ca.nextSibling;return;case oe:return Qr(He,Re.name,Re.value);case Q:return He.push(Re.data.replace(/[<&>]/g,Ot));case G:return He.push(x.CDATA_START,Re.data,x.CDATA_END);case _e:return He.push(x.COMMENT_START,Re.data,x.COMMENT_END);case ye:var Mo=Re.publicId,Ya=Re.systemId;He.push(x.DOCTYPE_DECL_START," ",Re.name),Mo?(He.push(" ",x.PUBLIC," ",Mo),Ya&&Ya!=="."&&He.push(" ",Ya)):Ya&&Ya!=="."&&He.push(" ",x.SYSTEM," ",Ya),Re.internalSubset&&He.push(" [",Re.internalSubset,"]"),He.push(">");return;case fe:return He.push("<?",Re.target," ",Re.data,"?>");case ae:return He.push("&",Re.nodeName,";");default:He.push("??",Re.nodeName)}}function oi(Re,He,Tt){var Gt;switch(He.nodeType){case X:Gt=He.cloneNode(!1),Gt.ownerDocument=Re;case Te:break;case oe:Tt=!0;break}if(Gt||(Gt=He.cloneNode(!1)),Gt.ownerDocument=Re,Gt.parentNode=null,Tt)for(var Ut=He.firstChild;Ut;)Gt.appendChild(oi(Re,Ut,Tt)),Ut=Ut.nextSibling;return Gt}function un(Re,He,Tt){var Gt=new He.constructor(f);for(var Ut in He)if(n(He,Ut)){var Xr=He[Ut];typeof Xr!="object"&&Xr!=Gt[Ut]&&(Gt[Ut]=Xr)}switch(He.childNodes&&(Gt.childNodes=new we),Gt.ownerDocument=Re,Gt.nodeType){case X:var Nn=He.attributes,Bi=Gt.attributes=new Xe,Ci=Nn.length;Bi._ownerElement=Gt;for(var Fr=0;Fr<Ci;Fr++)Gt.setAttributeNode(un(Re,Nn.item(Fr),!0));break;case oe:Tt=!0}if(Tt)for(var Mn=He.firstChild;Mn;)Gt.appendChild(un(Re,Mn,Tt)),Mn=Mn.nextSibling;return Gt}function Kn(Re,He,Tt){Re[He]=Tt}try{if(Object.defineProperty){let Re=function(He){switch(He.nodeType){case X:case Te:var Tt=[];for(He=He.firstChild;He;)He.nodeType!==7&&He.nodeType!==8&&Tt.push(Re(He)),He=He.nextSibling;return Tt.join("");default:return He.nodeValue}};Object.defineProperty(De.prototype,"length",{get:function(){return Fe(this),this.$$length}}),Object.defineProperty(be.prototype,"textContent",{get:function(){return Re(this)},set:function(He){switch(this.nodeType){case X:case Te:for(;this.firstChild;)this.removeChild(this.firstChild);(He||String(He))&&this.appendChild(this.ownerDocument.createTextNode(He));break;default:this.data=He,this.value=He,this.nodeValue=He}}}),Kn=function(He,Tt,Gt){He["$$"+Tt]=Gt}}}catch{}return Os._updateLiveList=Fe,Os.Attr=Ft,Os.CDATASection=Qt,Os.CharacterData=Et,Os.Comment=ct,Os.Document=$e,Os.DocumentFragment=fn,Os.DocumentType=Ht,Os.DOMImplementation=it,Os.Element=Ge,Os.Entity=Ar,Os.EntityReference=$r,Os.LiveNodeList=De,Os.NamedNodeMap=Xe,Os.Node=be,Os.NodeList=we,Os.Notation=Ir,Os.Text=mt,Os.ProcessingInstruction=zr,Os.XMLSerializer=Mt,Os}var hm={},fP={},Iq;function qke(){return Iq||(Iq=1,(function(t){var e=A_().freeze;t.XML_ENTITIES=e({amp:"&",apos:"'",gt:">",lt:"<",quot:'"'}),t.HTML_ENTITIES=e({Aacute:"",aacute:"",Abreve:"",abreve:"",ac:"",acd:"",acE:"",Acirc:"",acirc:"",acute:"",Acy:"",acy:"",AElig:"",aelig:"",af:"",Afr:"",afr:"",Agrave:"",agrave:"",alefsym:"",aleph:"",Alpha:"",alpha:"",Amacr:"",amacr:"",amalg:"",AMP:"&",amp:"&",And:"",and:"",andand:"",andd:"",andslope:"",andv:"",ang:"",ange:"",angle:"",angmsd:"",angmsdaa:"",angmsdab:"",angmsdac:"",angmsdad:"",angmsdae:"",angmsdaf:"",angmsdag:"",angmsdah:"",angrt:"",angrtvb:"",angrtvbd:"",angsph:"",angst:"",angzarr:"",Aogon:"",aogon:"",Aopf:"",aopf:"",ap:"",apacir:"",apE:"",ape:"",apid:"",apos:"'",ApplyFunction:"",approx:"",approxeq:"",Aring:"",aring:"",Ascr:"",ascr:"",Assign:"",ast:"*",asymp:"",asympeq:"",Atilde:"",atilde:"",Auml:"",auml:"",awconint:"",awint:"",backcong:"",backepsilon:"",backprime:"",backsim:"",backsimeq:"",Backslash:"",Barv:"",barvee:"",Barwed:"",barwed:"",barwedge:"",bbrk:"",bbrktbrk:"",bcong:"",Bcy:"",bcy:"",bdquo:"",becaus:"",Because:"",because:"",bemptyv:"",bepsi:"",bernou:"",Bernoullis:"",Beta:"",beta:"",beth:"",between:"",Bfr:"",bfr:"",bigcap:"",bigcirc:"",bigcup:"",bigodot:"",bigoplus:"",bigotimes:"",bigsqcup:"",bigstar:"",bigtriangledown:"",bigtriangleup:"",biguplus:"",bigvee:"",bigwedge:"",bkarow:"",blacklozenge:"",blacksquare:"",blacktriangle:"",blacktriangledown:"",blacktriangleleft:"",blacktriangleright:"",blank:"",blk12:"",blk14:"",blk34:"",block:"",bne:"=",bnequiv:"",bNot:"",bnot:"",Bopf:"",bopf:"",bot:"",bottom:"",bowtie:"",boxbox:"",boxDL:"",boxDl:"",boxdL:"",boxdl:"",boxDR:"",boxDr:"",boxdR:"",boxdr:"",boxH:"",boxh:"",boxHD:"",boxHd:"",boxhD:"",boxhd:"",boxHU:"",boxHu:"",boxhU:"",boxhu:"",boxminus:"",boxplus:"",boxtimes:"",boxUL:"",boxUl:"",boxuL:"",boxul:"",boxUR:"",boxUr:"",boxuR:"",boxur:"",boxV:"",boxv:"",boxVH:"",boxVh:"",boxvH:"",boxvh:"",boxVL:"",boxVl:"",boxvL:"",boxvl:"",boxVR:"",boxVr:"",boxvR:"",boxvr:"",bprime:"",Breve:"",breve:"",brvbar:"",Bscr:"",bscr:"",bsemi:"",bsim:"",bsime:"",bsol:"\\",bsolb:"",bsolhsub:"",bull:"",bullet:"",bump:"",bumpE:"",bumpe:"",Bumpeq:"",bumpeq:"",Cacute:"",cacute:"",Cap:"",cap:"",capand:"",capbrcup:"",capcap:"",capcup:"",capdot:"",CapitalDifferentialD:"",caps:"",caret:"",caron:"",Cayleys:"",ccaps:"",Ccaron:"",ccaron:"",Ccedil:"",ccedil:"",Ccirc:"",ccirc:"",Cconint:"",ccups:"",ccupssm:"",Cdot:"",cdot:"",cedil:"",Cedilla:"",cemptyv:"",cent:"",CenterDot:"",centerdot:"",Cfr:"",cfr:"",CHcy:"",chcy:"",check:"",checkmark:"",Chi:"",chi:"",cir:"",circ:"",circeq:"",circlearrowleft:"",circlearrowright:"",circledast:"",circledcirc:"",circleddash:"",CircleDot:"",circledR:"",circledS:"",CircleMinus:"",CirclePlus:"",CircleTimes:"",cirE:"",cire:"",cirfnint:"",cirmid:"",cirscir:"",ClockwiseContourIntegral:"",CloseCurlyDoubleQuote:"",CloseCurlyQuote:"",clubs:"",clubsuit:"",Colon:"",colon:":",Colone:"",colone:"",coloneq:"",comma:",",commat:"@",comp:"",compfn:"",complement:"",complexes:"",cong:"",congdot:"",Congruent:"",Conint:"",conint:"",ContourIntegral:"",Copf:"",copf:"",coprod:"",Coproduct:"",COPY:"",copy:"",copysr:"",CounterClockwiseContourIntegral:"",crarr:"",Cross:"",cross:"",Cscr:"",cscr:"",csub:"",csube:"",csup:"",csupe:"",ctdot:"",cudarrl:"",cudarrr:"",cuepr:"",cuesc:"",cularr:"",cularrp:"",Cup:"",cup:"",cupbrcap:"",CupCap:"",cupcap:"",cupcup:"",cupdot:"",cupor:"",cups:"",curarr:"",curarrm:"",curlyeqprec:"",curlyeqsucc:"",curlyvee:"",curlywedge:"",curren:"",curvearrowleft:"",curvearrowright:"",cuvee:"",cuwed:"",cwconint:"",cwint:"",cylcty:"",Dagger:"",dagger:"",daleth:"",Darr:"",dArr:"",darr:"",dash:"",Dashv:"",dashv:"",dbkarow:"",dblac:"",Dcaron:"",dcaron:"",Dcy:"",dcy:"",DD:"",dd:"",ddagger:"",ddarr:"",DDotrahd:"",ddotseq:"",deg:"",Del:"",Delta:"",delta:"",demptyv:"",dfisht:"",Dfr:"",dfr:"",dHar:"",dharl:"",dharr:"",DiacriticalAcute:"",DiacriticalDot:"",DiacriticalDoubleAcute:"",DiacriticalGrave:"`",DiacriticalTilde:"",diam:"",Diamond:"",diamond:"",diamondsuit:"",diams:"",die:"",DifferentialD:"",digamma:"",disin:"",div:"",divide:"",divideontimes:"",divonx:"",DJcy:"",djcy:"",dlcorn:"",dlcrop:"",dollar:"$",Dopf:"",dopf:"",Dot:"",dot:"",DotDot:"",doteq:"",doteqdot:"",DotEqual:"",dotminus:"",dotplus:"",dotsquare:"",doublebarwedge:"",DoubleContourIntegral:"",DoubleDot:"",DoubleDownArrow:"",DoubleLeftArrow:"",DoubleLeftRightArrow:"",DoubleLeftTee:"",DoubleLongLeftArrow:"",DoubleLongLeftRightArrow:"",DoubleLongRightArrow:"",DoubleRightArrow:"",DoubleRightTee:"",DoubleUpArrow:"",DoubleUpDownArrow:"",DoubleVerticalBar:"",DownArrow:"",Downarrow:"",downarrow:"",DownArrowBar:"",DownArrowUpArrow:"",DownBreve:"",downdownarrows:"",downharpoonleft:"",downharpoonright:"",DownLeftRightVector:"",DownLeftTeeVector:"",DownLeftVector:"",DownLeftVectorBar:"",DownRightTeeVector:"",DownRightVector:"",DownRightVectorBar:"",DownTee:"",DownTeeArrow:"",drbkarow:"",drcorn:"",drcrop:"",Dscr:"",dscr:"",DScy:"",dscy:"",dsol:"",Dstrok:"",dstrok:"",dtdot:"",dtri:"",dtrif:"",duarr:"",duhar:"",dwangle:"",DZcy:"",dzcy:"",dzigrarr:"",Eacute:"",eacute:"",easter:"",Ecaron:"",ecaron:"",ecir:"",Ecirc:"",ecirc:"",ecolon:"",Ecy:"",ecy:"",eDDot:"",Edot:"",eDot:"",edot:"",ee:"",efDot:"",Efr:"",efr:"",eg:"",Egrave:"",egrave:"",egs:"",egsdot:"",el:"",Element:"",elinters:"",ell:"",els:"",elsdot:"",Emacr:"",emacr:"",empty:"",emptyset:"",EmptySmallSquare:"",emptyv:"",EmptyVerySmallSquare:"",emsp:"",emsp13:"",emsp14:"",ENG:"",eng:"",ensp:"",Eogon:"",eogon:"",Eopf:"",eopf:"",epar:"",eparsl:"",eplus:"",epsi:"",Epsilon:"",epsilon:"",epsiv:"",eqcirc:"",eqcolon:"",eqsim:"",eqslantgtr:"",eqslantless:"",Equal:"",equals:"=",EqualTilde:"",equest:"",Equilibrium:"",equiv:"",equivDD:"",eqvparsl:"",erarr:"",erDot:"",Escr:"",escr:"",esdot:"",Esim:"",esim:"",Eta:"",eta:"",ETH:"",eth:"",Euml:"",euml:"",euro:"",excl:"!",exist:"",Exists:"",expectation:"",ExponentialE:"",exponentiale:"",fallingdotseq:"",Fcy:"",fcy:"",female:"",ffilig:"",fflig:"",ffllig:"",Ffr:"",ffr:"",filig:"",FilledSmallSquare:"",FilledVerySmallSquare:"",fjlig:"fj",flat:"",fllig:"",fltns:"",fnof:"",Fopf:"",fopf:"",ForAll:"",forall:"",fork:"",forkv:"",Fouriertrf:"",fpartint:"",frac12:"",frac13:"",frac14:"",frac15:"",frac16:"",frac18:"",frac23:"",frac25:"",frac34:"",frac35:"",frac38:"",frac45:"",frac56:"",frac58:"",frac78:"",frasl:"",frown:"",Fscr:"",fscr:"",gacute:"",Gamma:"",gamma:"",Gammad:"",gammad:"",gap:"",Gbreve:"",gbreve:"",Gcedil:"",Gcirc:"",gcirc:"",Gcy:"",gcy:"",Gdot:"",gdot:"",gE:"",ge:"",gEl:"",gel:"",geq:"",geqq:"",geqslant:"",ges:"",gescc:"",gesdot:"",gesdoto:"",gesdotol:"",gesl:"",gesles:"",Gfr:"",gfr:"",Gg:"",gg:"",ggg:"",gimel:"",GJcy:"",gjcy:"",gl:"",gla:"",glE:"",glj:"",gnap:"",gnapprox:"",gnE:"",gne:"",gneq:"",gneqq:"",gnsim:"",Gopf:"",gopf:"",grave:"`",GreaterEqual:"",GreaterEqualLess:"",GreaterFullEqual:"",GreaterGreater:"",GreaterLess:"",GreaterSlantEqual:"",GreaterTilde:"",Gscr:"",gscr:"",gsim:"",gsime:"",gsiml:"",Gt:"",GT:">",gt:">",gtcc:"",gtcir:"",gtdot:"",gtlPar:"",gtquest:"",gtrapprox:"",gtrarr:"",gtrdot:"",gtreqless:"",gtreqqless:"",gtrless:"",gtrsim:"",gvertneqq:"",gvnE:"",Hacek:"",hairsp:"",half:"",hamilt:"",HARDcy:"",hardcy:"",hArr:"",harr:"",harrcir:"",harrw:"",Hat:"^",hbar:"",Hcirc:"",hcirc:"",hearts:"",heartsuit:"",hellip:"",hercon:"",Hfr:"",hfr:"",HilbertSpace:"",hksearow:"",hkswarow:"",hoarr:"",homtht:"",hookleftarrow:"",hookrightarrow:"",Hopf:"",hopf:"",horbar:"",HorizontalLine:"",Hscr:"",hscr:"",hslash:"",Hstrok:"",hstrok:"",HumpDownHump:"",HumpEqual:"",hybull:"",hyphen:"",Iacute:"",iacute:"",ic:"",Icirc:"",icirc:"",Icy:"",icy:"",Idot:"",IEcy:"",iecy:"",iexcl:"",iff:"",Ifr:"",ifr:"",Igrave:"",igrave:"",ii:"",iiiint:"",iiint:"",iinfin:"",iiota:"",IJlig:"",ijlig:"",Im:"",Imacr:"",imacr:"",image:"",ImaginaryI:"",imagline:"",imagpart:"",imath:"",imof:"",imped:"",Implies:"",in:"",incare:"",infin:"",infintie:"",inodot:"",Int:"",int:"",intcal:"",integers:"",Integral:"",intercal:"",Intersection:"",intlarhk:"",intprod:"",InvisibleComma:"",InvisibleTimes:"",IOcy:"",iocy:"",Iogon:"",iogon:"",Iopf:"",iopf:"",Iota:"",iota:"",iprod:"",iquest:"",Iscr:"",iscr:"",isin:"",isindot:"",isinE:"",isins:"",isinsv:"",isinv:"",it:"",Itilde:"",itilde:"",Iukcy:"",iukcy:"",Iuml:"",iuml:"",Jcirc:"",jcirc:"",Jcy:"",jcy:"",Jfr:"",jfr:"",jmath:"",Jopf:"",jopf:"",Jscr:"",jscr:"",Jsercy:"",jsercy:"",Jukcy:"",jukcy:"",Kappa:"",kappa:"",kappav:"",Kcedil:"",kcedil:"",Kcy:"",kcy:"",Kfr:"",kfr:"",kgreen:"",KHcy:"",khcy:"",KJcy:"",kjcy:"",Kopf:"",kopf:"",Kscr:"",kscr:"",lAarr:"",Lacute:"",lacute:"",laemptyv:"",lagran:"",Lambda:"",lambda:"",Lang:"",lang:"",langd:"",langle:"",lap:"",Laplacetrf:"",laquo:"",Larr:"",lArr:"",larr:"",larrb:"",larrbfs:"",larrfs:"",larrhk:"",larrlp:"",larrpl:"",larrsim:"",larrtl:"",lat:"",lAtail:"",latail:"",late:"",lates:"",lBarr:"",lbarr:"",lbbrk:"",lbrace:"{",lbrack:"[",lbrke:"",lbrksld:"",lbrkslu:"",Lcaron:"",lcaron:"",Lcedil:"",lcedil:"",lceil:"",lcub:"{",Lcy:"",lcy:"",ldca:"",ldquo:"",ldquor:"",ldrdhar:"",ldrushar:"",ldsh:"",lE:"",le:"",LeftAngleBracket:"",LeftArrow:"",Leftarrow:"",leftarrow:"",LeftArrowBar:"",LeftArrowRightArrow:"",leftarrowtail:"",LeftCeiling:"",LeftDoubleBracket:"",LeftDownTeeVector:"",LeftDownVector:"",LeftDownVectorBar:"",LeftFloor:"",leftharpoondown:"",leftharpoonup:"",leftleftarrows:"",LeftRightArrow:"",Leftrightarrow:"",leftrightarrow:"",leftrightarrows:"",leftrightharpoons:"",leftrightsquigarrow:"",LeftRightVector:"",LeftTee:"",LeftTeeArrow:"",LeftTeeVector:"",leftthreetimes:"",LeftTriangle:"",LeftTriangleBar:"",LeftTriangleEqual:"",LeftUpDownVector:"",LeftUpTeeVector:"",LeftUpVector:"",LeftUpVectorBar:"",LeftVector:"",LeftVectorBar:"",lEg:"",leg:"",leq:"",leqq:"",leqslant:"",les:"",lescc:"",lesdot:"",lesdoto:"",lesdotor:"",lesg:"",lesges:"",lessapprox:"",lessdot:"",lesseqgtr:"",lesseqqgtr:"",LessEqualGreater:"",LessFullEqual:"",LessGreater:"",lessgtr:"",LessLess:"",lesssim:"",LessSlantEqual:"",LessTilde:"",lfisht:"",lfloor:"",Lfr:"",lfr:"",lg:"",lgE:"",lHar:"",lhard:"",lharu:"",lharul:"",lhblk:"",LJcy:"",ljcy:"",Ll:"",ll:"",llarr:"",llcorner:"",Lleftarrow:"",llhard:"",lltri:"",Lmidot:"",lmidot:"",lmoust:"",lmoustache:"",lnap:"",lnapprox:"",lnE:"",lne:"",lneq:"",lneqq:"",lnsim:"",loang:"",loarr:"",lobrk:"",LongLeftArrow:"",Longleftarrow:"",longleftarrow:"",LongLeftRightArrow:"",Longleftrightarrow:"",longleftrightarrow:"",longmapsto:"",LongRightArrow:"",Longrightarrow:"",longrightarrow:"",looparrowleft:"",looparrowright:"",lopar:"",Lopf:"",lopf:"",loplus:"",lotimes:"",lowast:"",lowbar:"_",LowerLeftArrow:"",LowerRightArrow:"",loz:"",lozenge:"",lozf:"",lpar:"(",lparlt:"",lrarr:"",lrcorner:"",lrhar:"",lrhard:"",lrm:"",lrtri:"",lsaquo:"",Lscr:"",lscr:"",Lsh:"",lsh:"",lsim:"",lsime:"",lsimg:"",lsqb:"[",lsquo:"",lsquor:"",Lstrok:"",lstrok:"",Lt:"",LT:"<",lt:"<",ltcc:"",ltcir:"",ltdot:"",lthree:"",ltimes:"",ltlarr:"",ltquest:"",ltri:"",ltrie:"",ltrif:"",ltrPar:"",lurdshar:"",luruhar:"",lvertneqq:"",lvnE:"",macr:"",male:"",malt:"",maltese:"",Map:"",map:"",mapsto:"",mapstodown:"",mapstoleft:"",mapstoup:"",marker:"",mcomma:"",Mcy:"",mcy:"",mdash:"",mDDot:"",measuredangle:"",MediumSpace:"",Mellintrf:"",Mfr:"",mfr:"",mho:"",micro:"",mid:"",midast:"*",midcir:"",middot:"",minus:"",minusb:"",minusd:"",minusdu:"",MinusPlus:"",mlcp:"",mldr:"",mnplus:"",models:"",Mopf:"",mopf:"",mp:"",Mscr:"",mscr:"",mstpos:"",Mu:"",mu:"",multimap:"",mumap:"",nabla:"",Nacute:"",nacute:"",nang:"",nap:"",napE:"",napid:"",napos:"",napprox:"",natur:"",natural:"",naturals:"",nbsp:"",nbump:"",nbumpe:"",ncap:"",Ncaron:"",ncaron:"",Ncedil:"",ncedil:"",ncong:"",ncongdot:"",ncup:"",Ncy:"",ncy:"",ndash:"",ne:"",nearhk:"",neArr:"",nearr:"",nearrow:"",nedot:"",NegativeMediumSpace:"",NegativeThickSpace:"",NegativeThinSpace:"",NegativeVeryThinSpace:"",nequiv:"",nesear:"",nesim:"",NestedGreaterGreater:"",NestedLessLess:"",NewLine:`
`,nexist:"",nexists:"",Nfr:"",nfr:"",ngE:"",nge:"",ngeq:"",ngeqq:"",ngeqslant:"",nges:"",nGg:"",ngsim:"",nGt:"",ngt:"",ngtr:"",nGtv:"",nhArr:"",nharr:"",nhpar:"",ni:"",nis:"",nisd:"",niv:"",NJcy:"",njcy:"",nlArr:"",nlarr:"",nldr:"",nlE:"",nle:"",nLeftarrow:"",nleftarrow:"",nLeftrightarrow:"",nleftrightarrow:"",nleq:"",nleqq:"",nleqslant:"",nles:"",nless:"",nLl:"",nlsim:"",nLt:"",nlt:"",nltri:"",nltrie:"",nLtv:"",nmid:"",NoBreak:"",NonBreakingSpace:"",Nopf:"",nopf:"",Not:"",not:"",NotCongruent:"",NotCupCap:"",NotDoubleVerticalBar:"",NotElement:"",NotEqual:"",NotEqualTilde:"",NotExists:"",NotGreater:"",NotGreaterEqual:"",NotGreaterFullEqual:"",NotGreaterGreater:"",NotGreaterLess:"",NotGreaterSlantEqual:"",NotGreaterTilde:"",NotHumpDownHump:"",NotHumpEqual:"",notin:"",notindot:"",notinE:"",notinva:"",notinvb:"",notinvc:"",NotLeftTriangle:"",NotLeftTriangleBar:"",NotLeftTriangleEqual:"",NotLess:"",NotLessEqual:"",NotLessGreater:"",NotLessLess:"",NotLessSlantEqual:"",NotLessTilde:"",NotNestedGreaterGreater:"",NotNestedLessLess:"",notni:"",notniva:"",notnivb:"",notnivc:"",NotPrecedes:"",NotPrecedesEqual:"",NotPrecedesSlantEqual:"",NotReverseElement:"",NotRightTriangle:"",NotRightTriangleBar:"",NotRightTriangleEqual:"",NotSquareSubset:"",NotSquareSubsetEqual:"",NotSquareSuperset:"",NotSquareSupersetEqual:"",NotSubset:"",NotSubsetEqual:"",NotSucceeds:"",NotSucceedsEqual:"",NotSucceedsSlantEqual:"",NotSucceedsTilde:"",NotSuperset:"",NotSupersetEqual:"",NotTilde:"",NotTildeEqual:"",NotTildeFullEqual:"",NotTildeTilde:"",NotVerticalBar:"",npar:"",nparallel:"",nparsl:"",npart:"",npolint:"",npr:"",nprcue:"",npre:"",nprec:"",npreceq:"",nrArr:"",nrarr:"",nrarrc:"",nrarrw:"",nRightarrow:"",nrightarrow:"",nrtri:"",nrtrie:"",nsc:"",nsccue:"",nsce:"",Nscr:"",nscr:"",nshortmid:"",nshortparallel:"",nsim:"",nsime:"",nsimeq:"",nsmid:"",nspar:"",nsqsube:"",nsqsupe:"",nsub:"",nsubE:"",nsube:"",nsubset:"",nsubseteq:"",nsubseteqq:"",nsucc:"",nsucceq:"",nsup:"",nsupE:"",nsupe:"",nsupset:"",nsupseteq:"",nsupseteqq:"",ntgl:"",Ntilde:"",ntilde:"",ntlg:"",ntriangleleft:"",ntrianglelefteq:"",ntriangleright:"",ntrianglerighteq:"",Nu:"",nu:"",num:"#",numero:"",numsp:"",nvap:"",nVDash:"",nVdash:"",nvDash:"",nvdash:"",nvge:"",nvgt:">",nvHarr:"",nvinfin:"",nvlArr:"",nvle:"",nvlt:"<",nvltrie:"",nvrArr:"",nvrtrie:"",nvsim:"",nwarhk:"",nwArr:"",nwarr:"",nwarrow:"",nwnear:"",Oacute:"",oacute:"",oast:"",ocir:"",Ocirc:"",ocirc:"",Ocy:"",ocy:"",odash:"",Odblac:"",odblac:"",odiv:"",odot:"",odsold:"",OElig:"",oelig:"",ofcir:"",Ofr:"",ofr:"",ogon:"",Ograve:"",ograve:"",ogt:"",ohbar:"",ohm:"",oint:"",olarr:"",olcir:"",olcross:"",oline:"",olt:"",Omacr:"",omacr:"",Omega:"",omega:"",Omicron:"",omicron:"",omid:"",ominus:"",Oopf:"",oopf:"",opar:"",OpenCurlyDoubleQuote:"",OpenCurlyQuote:"",operp:"",oplus:"",Or:"",or:"",orarr:"",ord:"",order:"",orderof:"",ordf:"",ordm:"",origof:"",oror:"",orslope:"",orv:"",oS:"",Oscr:"",oscr:"",Oslash:"",oslash:"",osol:"",Otilde:"",otilde:"",Otimes:"",otimes:"",otimesas:"",Ouml:"",ouml:"",ovbar:"",OverBar:"",OverBrace:"",OverBracket:"",OverParenthesis:"",par:"",para:"",parallel:"",parsim:"",parsl:"",part:"",PartialD:"",Pcy:"",pcy:"",percnt:"%",period:".",permil:"",perp:"",pertenk:"",Pfr:"",pfr:"",Phi:"",phi:"",phiv:"",phmmat:"",phone:"",Pi:"",pi:"",pitchfork:"",piv:"",planck:"",planckh:"",plankv:"",plus:"+",plusacir:"",plusb:"",pluscir:"",plusdo:"",plusdu:"",pluse:"",PlusMinus:"",plusmn:"",plussim:"",plustwo:"",pm:"",Poincareplane:"",pointint:"",Popf:"",popf:"",pound:"",Pr:"",pr:"",prap:"",prcue:"",prE:"",pre:"",prec:"",precapprox:"",preccurlyeq:"",Precedes:"",PrecedesEqual:"",PrecedesSlantEqual:"",PrecedesTilde:"",preceq:"",precnapprox:"",precneqq:"",precnsim:"",precsim:"",Prime:"",prime:"",primes:"",prnap:"",prnE:"",prnsim:"",prod:"",Product:"",profalar:"",profline:"",profsurf:"",prop:"",Proportion:"",Proportional:"",propto:"",prsim:"",prurel:"",Pscr:"",pscr:"",Psi:"",psi:"",puncsp:"",Qfr:"",qfr:"",qint:"",Qopf:"",qopf:"",qprime:"",Qscr:"",qscr:"",quaternions:"",quatint:"",quest:"?",questeq:"",QUOT:'"',quot:'"',rAarr:"",race:"",Racute:"",racute:"",radic:"",raemptyv:"",Rang:"",rang:"",rangd:"",range:"",rangle:"",raquo:"",Rarr:"",rArr:"",rarr:"",rarrap:"",rarrb:"",rarrbfs:"",rarrc:"",rarrfs:"",rarrhk:"",rarrlp:"",rarrpl:"",rarrsim:"",Rarrtl:"",rarrtl:"",rarrw:"",rAtail:"",ratail:"",ratio:"",rationals:"",RBarr:"",rBarr:"",rbarr:"",rbbrk:"",rbrace:"}",rbrack:"]",rbrke:"",rbrksld:"",rbrkslu:"",Rcaron:"",rcaron:"",Rcedil:"",rcedil:"",rceil:"",rcub:"}",Rcy:"",rcy:"",rdca:"",rdldhar:"",rdquo:"",rdquor:"",rdsh:"",Re:"",real:"",realine:"",realpart:"",reals:"",rect:"",REG:"",reg:"",ReverseElement:"",ReverseEquilibrium:"",ReverseUpEquilibrium:"",rfisht:"",rfloor:"",Rfr:"",rfr:"",rHar:"",rhard:"",rharu:"",rharul:"",Rho:"",rho:"",rhov:"",RightAngleBracket:"",RightArrow:"",Rightarrow:"",rightarrow:"",RightArrowBar:"",RightArrowLeftArrow:"",rightarrowtail:"",RightCeiling:"",RightDoubleBracket:"",RightDownTeeVector:"",RightDownVector:"",RightDownVectorBar:"",RightFloor:"",rightharpoondown:"",rightharpoonup:"",rightleftarrows:"",rightleftharpoons:"",rightrightarrows:"",rightsquigarrow:"",RightTee:"",RightTeeArrow:"",RightTeeVector:"",rightthreetimes:"",RightTriangle:"",RightTriangleBar:"",RightTriangleEqual:"",RightUpDownVector:"",RightUpTeeVector:"",RightUpVector:"",RightUpVectorBar:"",RightVector:"",RightVectorBar:"",ring:"",risingdotseq:"",rlarr:"",rlhar:"",rlm:"",rmoust:"",rmoustache:"",rnmid:"",roang:"",roarr:"",robrk:"",ropar:"",Ropf:"",ropf:"",roplus:"",rotimes:"",RoundImplies:"",rpar:")",rpargt:"",rppolint:"",rrarr:"",Rrightarrow:"",rsaquo:"",Rscr:"",rscr:"",Rsh:"",rsh:"",rsqb:"]",rsquo:"",rsquor:"",rthree:"",rtimes:"",rtri:"",rtrie:"",rtrif:"",rtriltri:"",RuleDelayed:"",ruluhar:"",rx:"",Sacute:"",sacute:"",sbquo:"",Sc:"",sc:"",scap:"",Scaron:"",scaron:"",sccue:"",scE:"",sce:"",Scedil:"",scedil:"",Scirc:"",scirc:"",scnap:"",scnE:"",scnsim:"",scpolint:"",scsim:"",Scy:"",scy:"",sdot:"",sdotb:"",sdote:"",searhk:"",seArr:"",searr:"",searrow:"",sect:"",semi:";",seswar:"",setminus:"",setmn:"",sext:"",Sfr:"",sfr:"",sfrown:"",sharp:"",SHCHcy:"",shchcy:"",SHcy:"",shcy:"",ShortDownArrow:"",ShortLeftArrow:"",shortmid:"",shortparallel:"",ShortRightArrow:"",ShortUpArrow:"",shy:"",Sigma:"",sigma:"",sigmaf:"",sigmav:"",sim:"",simdot:"",sime:"",simeq:"",simg:"",simgE:"",siml:"",simlE:"",simne:"",simplus:"",simrarr:"",slarr:"",SmallCircle:"",smallsetminus:"",smashp:"",smeparsl:"",smid:"",smile:"",smt:"",smte:"",smtes:"",SOFTcy:"",softcy:"",sol:"/",solb:"",solbar:"",Sopf:"",sopf:"",spades:"",spadesuit:"",spar:"",sqcap:"",sqcaps:"",sqcup:"",sqcups:"",Sqrt:"",sqsub:"",sqsube:"",sqsubset:"",sqsubseteq:"",sqsup:"",sqsupe:"",sqsupset:"",sqsupseteq:"",squ:"",Square:"",square:"",SquareIntersection:"",SquareSubset:"",SquareSubsetEqual:"",SquareSuperset:"",SquareSupersetEqual:"",SquareUnion:"",squarf:"",squf:"",srarr:"",Sscr:"",sscr:"",ssetmn:"",ssmile:"",sstarf:"",Star:"",star:"",starf:"",straightepsilon:"",straightphi:"",strns:"",Sub:"",sub:"",subdot:"",subE:"",sube:"",subedot:"",submult:"",subnE:"",subne:"",subplus:"",subrarr:"",Subset:"",subset:"",subseteq:"",subseteqq:"",SubsetEqual:"",subsetneq:"",subsetneqq:"",subsim:"",subsub:"",subsup:"",succ:"",succapprox:"",succcurlyeq:"",Succeeds:"",SucceedsEqual:"",SucceedsSlantEqual:"",SucceedsTilde:"",succeq:"",succnapprox:"",succneqq:"",succnsim:"",succsim:"",SuchThat:"",Sum:"",sum:"",sung:"",Sup:"",sup:"",sup1:"",sup2:"",sup3:"",supdot:"",supdsub:"",supE:"",supe:"",supedot:"",Superset:"",SupersetEqual:"",suphsol:"",suphsub:"",suplarr:"",supmult:"",supnE:"",supne:"",supplus:"",Supset:"",supset:"",supseteq:"",supseteqq:"",supsetneq:"",supsetneqq:"",supsim:"",supsub:"",supsup:"",swarhk:"",swArr:"",swarr:"",swarrow:"",swnwar:"",szlig:"",Tab:"	",target:"",Tau:"",tau:"",tbrk:"",Tcaron:"",tcaron:"",Tcedil:"",tcedil:"",Tcy:"",tcy:"",tdot:"",telrec:"",Tfr:"",tfr:"",there4:"",Therefore:"",therefore:"",Theta:"",theta:"",thetasym:"",thetav:"",thickapprox:"",thicksim:"",ThickSpace:"",thinsp:"",ThinSpace:"",thkap:"",thksim:"",THORN:"",thorn:"",Tilde:"",tilde:"",TildeEqual:"",TildeFullEqual:"",TildeTilde:"",times:"",timesb:"",timesbar:"",timesd:"",tint:"",toea:"",top:"",topbot:"",topcir:"",Topf:"",topf:"",topfork:"",tosa:"",tprime:"",TRADE:"",trade:"",triangle:"",triangledown:"",triangleleft:"",trianglelefteq:"",triangleq:"",triangleright:"",trianglerighteq:"",tridot:"",trie:"",triminus:"",TripleDot:"",triplus:"",trisb:"",tritime:"",trpezium:"",Tscr:"",tscr:"",TScy:"",tscy:"",TSHcy:"",tshcy:"",Tstrok:"",tstrok:"",twixt:"",twoheadleftarrow:"",twoheadrightarrow:"",Uacute:"",uacute:"",Uarr:"",uArr:"",uarr:"",Uarrocir:"",Ubrcy:"",ubrcy:"",Ubreve:"",ubreve:"",Ucirc:"",ucirc:"",Ucy:"",ucy:"",udarr:"",Udblac:"",udblac:"",udhar:"",ufisht:"",Ufr:"",ufr:"",Ugrave:"",ugrave:"",uHar:"",uharl:"",uharr:"",uhblk:"",ulcorn:"",ulcorner:"",ulcrop:"",ultri:"",Umacr:"",umacr:"",uml:"",UnderBar:"_",UnderBrace:"",UnderBracket:"",UnderParenthesis:"",Union:"",UnionPlus:"",Uogon:"",uogon:"",Uopf:"",uopf:"",UpArrow:"",Uparrow:"",uparrow:"",UpArrowBar:"",UpArrowDownArrow:"",UpDownArrow:"",Updownarrow:"",updownarrow:"",UpEquilibrium:"",upharpoonleft:"",upharpoonright:"",uplus:"",UpperLeftArrow:"",UpperRightArrow:"",Upsi:"",upsi:"",upsih:"",Upsilon:"",upsilon:"",UpTee:"",UpTeeArrow:"",upuparrows:"",urcorn:"",urcorner:"",urcrop:"",Uring:"",uring:"",urtri:"",Uscr:"",uscr:"",utdot:"",Utilde:"",utilde:"",utri:"",utrif:"",uuarr:"",Uuml:"",uuml:"",uwangle:"",vangrt:"",varepsilon:"",varkappa:"",varnothing:"",varphi:"",varpi:"",varpropto:"",vArr:"",varr:"",varrho:"",varsigma:"",varsubsetneq:"",varsubsetneqq:"",varsupsetneq:"",varsupsetneqq:"",vartheta:"",vartriangleleft:"",vartriangleright:"",Vbar:"",vBar:"",vBarv:"",Vcy:"",vcy:"",VDash:"",Vdash:"",vDash:"",vdash:"",Vdashl:"",Vee:"",vee:"",veebar:"",veeeq:"",vellip:"",Verbar:"",verbar:"|",Vert:"",vert:"|",VerticalBar:"",VerticalLine:"|",VerticalSeparator:"",VerticalTilde:"",VeryThinSpace:"",Vfr:"",vfr:"",vltri:"",vnsub:"",vnsup:"",Vopf:"",vopf:"",vprop:"",vrtri:"",Vscr:"",vscr:"",vsubnE:"",vsubne:"",vsupnE:"",vsupne:"",Vvdash:"",vzigzag:"",Wcirc:"",wcirc:"",wedbar:"",Wedge:"",wedge:"",wedgeq:"",weierp:"",Wfr:"",wfr:"",Wopf:"",wopf:"",wp:"",wr:"",wreath:"",Wscr:"",wscr:"",xcap:"",xcirc:"",xcup:"",xdtri:"",Xfr:"",xfr:"",xhArr:"",xharr:"",Xi:"",xi:"",xlArr:"",xlarr:"",xmap:"",xnis:"",xodot:"",Xopf:"",xopf:"",xoplus:"",xotime:"",xrArr:"",xrarr:"",Xscr:"",xscr:"",xsqcup:"",xuplus:"",xutri:"",xvee:"",xwedge:"",Yacute:"",yacute:"",YAcy:"",yacy:"",Ycirc:"",ycirc:"",Ycy:"",ycy:"",yen:"",Yfr:"",yfr:"",YIcy:"",yicy:"",Yopf:"",yopf:"",Yscr:"",yscr:"",YUcy:"",yucy:"",Yuml:"",yuml:"",Zacute:"",zacute:"",Zcaron:"",zcaron:"",Zcy:"",zcy:"",Zdot:"",zdot:"",zeetrf:"",ZeroWidthSpace:"",Zeta:"",zeta:"",Zfr:"",zfr:"",ZHcy:"",zhcy:"",zigrarr:"",Zopf:"",zopf:"",Zscr:"",zscr:"",zwj:"",zwnj:""}),t.entityMap=t.HTML_ENTITIES})(fP)),fP}var d1={},Pq;function Hke(){if(Pq)return d1;Pq=1;var t=A_(),e=see(),r=O3(),n=t.isHTMLEscapableRawTextElement,i=t.isHTMLMimeType,a=t.isHTMLRawTextElement,s=t.hasOwn,o=t.NAMESPACE,c=r.ParseError,f=r.DOMException,d=0,m=1,b=2,x=3,E=4,T=5,A=6,M=7;function F(){}F.prototype={parse:function(fe,_e,Le){var ye=this.domBuilder;ye.startDocument(),X(_e,_e=Object.create(null)),O(fe,_e,Le,ye,this.errorHandler),ye.endDocument()}};var N=/&#?\w+;?/g;function O(fe,_e,Le,ye,Te){var Ie=i(ye.mimeType);fe.indexOf(e.UNICODE_REPLACEMENT_CHARACTER)>=0&&Te.warning("Unicode replacement character detected, source encoding issues?");function Me(qe){if(qe>65535){qe-=65536;var Ge=55296+(qe>>10),Ft=56320+(qe&1023);return String.fromCharCode(Ge,Ft)}else return String.fromCharCode(qe)}function de(qe){var Ge=qe[qe.length-1]===";"?qe:qe+";";if(!Ie&&Ge!==qe)return Te.error("EntityRef: expecting ;"),qe;var Ft=e.Reference.exec(Ge);if(!Ft||Ft[0].length!==Ge.length)return Te.error("entity not matching Reference production: "+qe),qe;var Et=Ge.slice(1,-1);return s(Le,Et)?Le[Et]:Et.charAt(0)==="#"?Me(parseInt(Et.substring(1).replace("x","0x"))):(Te.error("entity not found:"+qe),qe)}function Se(qe){if(qe>it){var Ge=fe.substring(it,qe).replace(N,de);Xe&&Be(it),ye.characters(Ge,0,qe-it),it=qe}}var we=0,De=0,Fe=/\r\n?|\n|$/g,Xe=ye.locator;function Be(qe,Ge){for(;qe>=De&&(Ge=Fe.exec(fe));)we=De,De=Ge.index+Ge[0].length,Xe.lineNumber++;Xe.columnNumber=qe-we+1}for(var st=[{currentNSMap:_e}],Qe=[],it=0;;){try{var be=fe.indexOf("<",it);if(be<0){if(!Ie&&Qe.length>0)return Te.fatalError("unclosed xml tag(s): "+Qe.join(", "));if(!fe.substring(it).match(/^\s*$/)){var Ot=ye.doc,at=Ot.createTextNode(fe.substring(it));if(Ot.documentElement)return Te.error("Extra content at the end of the document");Ot.appendChild(at),ye.currentElement=at}return}if(be>it){var $e=fe.substring(it,be);!Ie&&Qe.length===0&&($e=$e.replace(new RegExp(e.S_OPT.source,"g"),""),$e&&Te.error("Unexpected content outside root element: '"+$e+"'")),Se(be)}switch(fe.charAt(be+1)){case"/":var Jt=fe.indexOf(">",be+2),Xt=fe.substring(be+2,Jt>0?Jt:void 0);if(!Xt)return Te.fatalError("end tag name missing");var $t=Jt>0&&e.reg("^",e.QName_group,e.S_OPT,"$").exec(Xt);if(!$t)return Te.fatalError('end tag name contains invalid characters: "'+Xt+'"');if(!ye.currentElement&&!ye.doc.documentElement)return;var cr=Qe[Qe.length-1]||ye.currentElement.tagName||ye.doc.documentElement.tagName||"";if(cr!==$t[1]){var _t=$t[1].toLowerCase();if(!Ie||cr.toLowerCase()!==_t)return Te.fatalError('Opening and ending tag mismatch: "'+cr+'" != "'+Xt+'"')}var gr=st.pop();Qe.pop();var mr=gr.localNSMap;if(ye.endElement(gr.uri,gr.localName,cr),mr)for(var ar in mr)s(mr,ar)&&ye.endPrefixMapping(ar);Jt++;break;case"?":Xe&&Be(be),Jt=ae(fe,be,ye,Te);break;case"!":Xe&&Be(be),Jt=G(fe,be,ye,Te,Ie);break;default:Xe&&Be(be);var Cr=new se,Er=st[st.length-1].currentNSMap,Jt=j(fe,be,Cr,Er,de,Te,Ie),ot=Cr.length;if(Cr.closed||(Ie&&t.isHTMLVoidElement(Cr.tagName)?Cr.closed=!0:Qe.push(Cr.tagName)),Xe&&ot){for(var Ce=U(Xe,{}),xe=0;xe<ot;xe++){var je=Cr[xe];Be(je.offset),je.locator=U(Xe,{})}ye.locator=Ce,H(Cr,ye,Er)&&st.push(Cr),ye.locator=Xe}else H(Cr,ye,Er)&&st.push(Cr);Ie&&!Cr.closed?Jt=W(fe,Jt,Cr.tagName,de,ye):Jt++}}catch(qe){if(qe instanceof c)throw qe;if(qe instanceof f)throw new c(qe.name+": "+qe.message,ye.locator,qe);Te.error("element parse error: "+qe),Jt=-1}Jt>it?it=Jt:Se(Math.max(be,it)+1)}}function U(fe,_e){return _e.lineNumber=fe.lineNumber,_e.columnNumber=fe.columnNumber,_e}function j(fe,_e,Le,ye,Te,Ie,Me){function de(Be,st,Qe){if(s(Le.attributeNames,Be))return Ie.fatalError("Attribute "+Be+" redefined");if(!Me&&st.indexOf("<")>=0)return Ie.fatalError("Unescaped '<' not allowed in attributes values");Le.addValue(Be,st.replace(/[\t\n\r]/g," ").replace(N,Te),Qe)}for(var Se,we,De=++_e,Fe=d;;){var Xe=fe.charAt(De);switch(Xe){case"=":if(Fe===m)Se=fe.slice(_e,De),Fe=x;else if(Fe===b)Fe=x;else throw new Error("attribute equal must after attrName");break;case"'":case'"':if(Fe===x||Fe===m)if(Fe===m&&(Ie.warning('attribute value must after "="'),Se=fe.slice(_e,De)),_e=De+1,De=fe.indexOf(Xe,_e),De>0)we=fe.slice(_e,De),de(Se,we,_e-1),Fe=T;else throw new Error("attribute value no end '"+Xe+"' match");else if(Fe==E)we=fe.slice(_e,De),de(Se,we,_e),Ie.warning('attribute "'+Se+'" missed start quot('+Xe+")!!"),_e=De+1,Fe=T;else throw new Error('attribute value must after "="');break;case"/":switch(Fe){case d:Le.setTagName(fe.slice(_e,De));case T:case A:case M:Fe=M,Le.closed=!0;case E:case m:break;case b:Le.closed=!0;break;default:throw new Error("attribute invalid close char('/')")}break;case"":return Ie.error("unexpected end of input"),Fe==d&&Le.setTagName(fe.slice(_e,De)),De;case">":switch(Fe){case d:Le.setTagName(fe.slice(_e,De));case T:case A:case M:break;case E:case m:we=fe.slice(_e,De),we.slice(-1)==="/"&&(Le.closed=!0,we=we.slice(0,-1));case b:Fe===b&&(we=Se),Fe==E?(Ie.warning('attribute "'+we+'" missed quot(")!'),de(Se,we,_e)):(Me||Ie.warning('attribute "'+we+'" missed value!! "'+we+'" instead!!'),de(we,we,_e));break;case x:if(!Me)return Ie.fatalError(`AttValue: ' or " expected`)}return De;case"":Xe=" ";default:if(Xe<=" ")switch(Fe){case d:Le.setTagName(fe.slice(_e,De)),Fe=A;break;case m:Se=fe.slice(_e,De),Fe=b;break;case E:var we=fe.slice(_e,De);Ie.warning('attribute "'+we+'" missed quot(")!!'),de(Se,we,_e);case T:Fe=A;break}else switch(Fe){case b:Me||Ie.warning('attribute "'+Se+'" missed value!! "'+Se+'" instead2!!'),de(Se,Se,_e),_e=De,Fe=m;break;case T:Ie.warning('attribute space is required"'+Se+'"!!');case A:Fe=m,_e=De;break;case x:Fe=E,_e=De;break;case M:throw new Error("elements closed character '/' and '>' must be connected to")}}De++}}function H(fe,_e,Le){for(var ye=fe.tagName,Te=null,Fe=fe.length;Fe--;){var Ie=fe[Fe],Me=Ie.qName,de=Ie.value,Xe=Me.indexOf(":");if(Xe>0)var Se=Ie.prefix=Me.slice(0,Xe),we=Me.slice(Xe+1),De=Se==="xmlns"&&we;else we=Me,Se=null,De=Me==="xmlns"&&"";Ie.localName=we,De!==!1&&(Te==null&&(Te=Object.create(null),X(Le,Le=Object.create(null))),Le[De]=Te[De]=de,Ie.uri=o.XMLNS,_e.startPrefixMapping(De,de))}for(var Fe=fe.length;Fe--;)Ie=fe[Fe],Ie.prefix&&(Ie.prefix==="xml"&&(Ie.uri=o.XML),Ie.prefix!=="xmlns"&&(Ie.uri=Le[Ie.prefix]));var Xe=ye.indexOf(":");Xe>0?(Se=fe.prefix=ye.slice(0,Xe),we=fe.localName=ye.slice(Xe+1)):(Se=null,we=fe.localName=ye);var Be=fe.uri=Le[Se||""];if(_e.startElement(Be,we,ye,fe),fe.closed){if(_e.endElement(Be,we,ye),Te)for(Se in Te)s(Te,Se)&&_e.endPrefixMapping(Se)}else return fe.currentNSMap=Le,fe.localNSMap=Te,!0}function W(fe,_e,Le,ye,Te){var Ie=n(Le);if(Ie||a(Le)){var Me=fe.indexOf("</"+Le+">",_e),de=fe.substring(_e+1,Me);return Ie&&(de=de.replace(N,ye)),Te.characters(de,0,de.length),Me}return _e+1}function X(fe,_e){for(var Le in fe)s(fe,Le)&&(_e[Le]=fe[Le])}function oe(fe,_e){var Le=_e;function ye(De){return De=De||0,fe.charAt(Le+De)}function Te(De){De=De||1,Le+=De}function Ie(){for(var De=0;Le<fe.length;){var Fe=ye();if(Fe!==" "&&Fe!==`
`&&Fe!=="	"&&Fe!=="\r")return De;De++,Te()}return-1}function Me(){return fe.substring(Le)}function de(De){return fe.substring(Le,Le+De.length)===De}function Se(De){return fe.substring(Le,Le+De.length).toUpperCase()===De.toUpperCase()}function we(De){var Fe=e.reg("^",De),Xe=Fe.exec(Me());return Xe?(Te(Xe[0].length),Xe[0]):null}return{char:ye,getIndex:function(){return Le},getMatch:we,getSource:function(){return fe},skip:Te,skipBlanks:Ie,substringFromIndex:Me,substringStartsWith:de,substringStartsWithCaseInsensitive:Se}}function Q(fe,_e){function Le(de,Se){var we=e.PI.exec(de.substringFromIndex());return we?we[1].toLowerCase()==="xml"?Se.fatalError("xml declaration is only allowed at the start of the document, but found at position "+de.getIndex()):(de.skip(we[0].length),we[0]):Se.fatalError("processing instruction is not well-formed at position "+de.getIndex())}var ye=fe.getSource();if(fe.char()==="["){fe.skip(1);for(var Te=fe.getIndex();fe.getIndex()<ye.length;){if(fe.skipBlanks(),fe.char()==="]"){var Ie=ye.substring(Te,fe.getIndex());return fe.skip(1),Ie}var Me=null;if(fe.char()==="<"&&fe.char(1)==="!")switch(fe.char(2)){case"E":fe.char(3)==="L"?Me=fe.getMatch(e.elementdecl):fe.char(3)==="N"&&(Me=fe.getMatch(e.EntityDecl));break;case"A":Me=fe.getMatch(e.AttlistDecl);break;case"N":Me=fe.getMatch(e.NotationDecl);break;case"-":Me=fe.getMatch(e.Comment);break}else if(fe.char()==="<"&&fe.char(1)==="?")Me=Le(fe,_e);else if(fe.char()==="%")Me=fe.getMatch(e.PEReference);else return _e.fatalError("Error detected in Markup declaration");if(!Me)return _e.fatalError("Error in internal subset at position "+fe.getIndex())}return _e.fatalError("doctype internal subset is not well-formed, missing ]")}}function G(fe,_e,Le,ye,Te){var Ie=oe(fe,_e);switch(Te?Ie.char(2).toUpperCase():Ie.char(2)){case"-":var Me=Ie.getMatch(e.Comment);return Me?(Le.comment(Me,e.COMMENT_START.length,Me.length-e.COMMENT_START.length-e.COMMENT_END.length),Ie.getIndex()):ye.fatalError("comment is not well-formed at position "+Ie.getIndex());case"[":var de=Ie.getMatch(e.CDSect);return de?!Te&&!Le.currentElement?ye.fatalError("CDATA outside of element"):(Le.startCDATA(),Le.characters(de,e.CDATA_START.length,de.length-e.CDATA_START.length-e.CDATA_END.length),Le.endCDATA(),Ie.getIndex()):ye.fatalError("Invalid CDATA starting at position "+_e);case"D":{if(Le.doc&&Le.doc.documentElement)return ye.fatalError("Doctype not allowed inside or after documentElement at position "+Ie.getIndex());if(Te?!Ie.substringStartsWithCaseInsensitive(e.DOCTYPE_DECL_START):!Ie.substringStartsWith(e.DOCTYPE_DECL_START))return ye.fatalError("Expected "+e.DOCTYPE_DECL_START+" at position "+Ie.getIndex());if(Ie.skip(e.DOCTYPE_DECL_START.length),Ie.skipBlanks()<1)return ye.fatalError("Expected whitespace after "+e.DOCTYPE_DECL_START+" at position "+Ie.getIndex());var Se={name:void 0,publicId:void 0,systemId:void 0,internalSubset:void 0};if(Se.name=Ie.getMatch(e.Name),!Se.name)return ye.fatalError("doctype name missing or contains unexpected characters at position "+Ie.getIndex());if(Te&&Se.name.toLowerCase()!=="html"&&ye.warning("Unexpected DOCTYPE in HTML document at position "+Ie.getIndex()),Ie.skipBlanks(),Ie.substringStartsWith(e.PUBLIC)||Ie.substringStartsWith(e.SYSTEM)){var we=e.ExternalID_match.exec(Ie.substringFromIndex());if(!we)return ye.fatalError("doctype external id is not well-formed at position "+Ie.getIndex());we.groups.SystemLiteralOnly!==void 0?Se.systemId=we.groups.SystemLiteralOnly:(Se.systemId=we.groups.SystemLiteral,Se.publicId=we.groups.PubidLiteral),Ie.skip(we[0].length)}else if(Te&&Ie.substringStartsWithCaseInsensitive(e.SYSTEM)){if(Ie.skip(e.SYSTEM.length),Ie.skipBlanks()<1)return ye.fatalError("Expected whitespace after "+e.SYSTEM+" at position "+Ie.getIndex());if(Se.systemId=Ie.getMatch(e.ABOUT_LEGACY_COMPAT_SystemLiteral),!Se.systemId)return ye.fatalError("Expected "+e.ABOUT_LEGACY_COMPAT+" in single or double quotes after "+e.SYSTEM+" at position "+Ie.getIndex())}return Te&&Se.systemId&&!e.ABOUT_LEGACY_COMPAT_SystemLiteral.test(Se.systemId)&&ye.warning("Unexpected doctype.systemId in HTML document at position "+Ie.getIndex()),Te||(Ie.skipBlanks(),Se.internalSubset=Q(Ie,ye)),Ie.skipBlanks(),Ie.char()!==">"?ye.fatalError("doctype not terminated with > at position "+Ie.getIndex()):(Ie.skip(1),Le.startDTD(Se.name,Se.publicId,Se.systemId,Se.internalSubset),Le.endDTD(),Ie.getIndex())}default:return ye.fatalError('Not well-formed XML starting with "<!" at position '+_e)}}function ae(fe,_e,Le,ye){var Te=fe.substring(_e).match(e.PI);if(!Te)return ye.fatalError("Invalid processing instruction starting at position "+_e);if(Te[1].toLowerCase()==="xml"){if(_e>0)return ye.fatalError("processing instruction at position "+_e+" is an xml declaration which is only at the start of the document");if(!e.XMLDecl.test(fe.substring(_e)))return ye.fatalError("xml declaration is not well-formed")}return Le.processingInstruction(Te[1],Te[2]),_e+Te[0].length}function se(){this.attributeNames=Object.create(null)}return se.prototype={setTagName:function(fe){if(!e.QName_exact.test(fe))throw new Error("invalid tagName:"+fe);this.tagName=fe},addValue:function(fe,_e,Le){if(!e.QName_exact.test(fe))throw new Error("invalid attribute:"+fe);this.attributeNames[fe]=this.length,this[this.length++]={qName:fe,value:_e,offset:Le}},length:0,getLocalName:function(fe){return this[fe].localName},getLocator:function(fe){return this[fe].locator},getQName:function(fe){return this[fe].qName},getURI:function(fe){return this[fe].uri},getValue:function(fe){return this[fe].value}},d1.XMLReader=F,d1.parseUtils=oe,d1.parseDoctypeCommentOrCData=G,d1}var kq;function Gke(){if(kq)return hm;kq=1;var t=A_(),e=lee(),r=O3(),n=qke(),i=Hke(),a=e.DOMImplementation,s=t.hasDefaultHTMLNamespace,o=t.isHTMLMimeType,c=t.isValidMimeType,f=t.MIME_TYPE,d=t.NAMESPACE,m=r.ParseError,b=i.XMLReader;function x(j){return j.replace(/\r[\n\u0085]/g,`
`).replace(/[\r\u0085\u2028\u2029]/g,`
`)}function E(j){if(j=j||{},j.locator===void 0&&(j.locator=!0),this.assign=j.assign||t.assign,this.domHandler=j.domHandler||T,this.onError=j.onError||j.errorHandler,j.errorHandler&&typeof j.errorHandler!="function")throw new TypeError("errorHandler object is no longer supported, switch to onError!");j.errorHandler&&j.errorHandler("warning","The `errorHandler` option has been deprecated, use `onError` instead!",this),this.normalizeLineEndings=j.normalizeLineEndings||x,this.locator=!!j.locator,this.xmlns=this.assign(Object.create(null),j.xmlns)}E.prototype.parseFromString=function(j,H){if(!c(H))throw new TypeError('DOMParser.parseFromString: the provided mimeType "'+H+'" is not valid.');var W=this.assign(Object.create(null),this.xmlns),X=n.XML_ENTITIES,oe=W[""]||null;s(H)?(X=n.HTML_ENTITIES,oe=d.HTML):H===f.XML_SVG_IMAGE&&(oe=d.SVG),W[""]=oe,W.xml=W.xml||d.XML;var Q=new this.domHandler({mimeType:H,defaultNamespace:oe,onError:this.onError}),G=this.locator?{}:void 0;this.locator&&Q.setDocumentLocator(G);var ae=new b;ae.errorHandler=Q,ae.domBuilder=Q;var se=!t.isHTMLMimeType(H);return se&&typeof j!="string"&&ae.errorHandler.fatalError("source is not a string"),ae.parse(this.normalizeLineEndings(String(j)),W,X),Q.doc.documentElement||ae.errorHandler.fatalError("missing root element"),Q.doc};function T(j){var H=j||{};this.mimeType=H.mimeType||f.XML_APPLICATION,this.defaultNamespace=H.defaultNamespace||null,this.cdata=!1,this.currentElement=void 0,this.doc=void 0,this.locator=void 0,this.onError=H.onError}function A(j,H){H.lineNumber=j.lineNumber,H.columnNumber=j.columnNumber}T.prototype={startDocument:function(){var j=new a;this.doc=o(this.mimeType)?j.createHTMLDocument(!1):j.createDocument(this.defaultNamespace,"")},startElement:function(j,H,W,X){var oe=this.doc,Q=oe.createElementNS(j,W||H),G=X.length;N(this,Q),this.currentElement=Q,this.locator&&A(this.locator,Q);for(var ae=0;ae<G;ae++){var j=X.getURI(ae),se=X.getValue(ae),W=X.getQName(ae),fe=oe.createAttributeNS(j,W);this.locator&&A(X.getLocator(ae),fe),fe.value=fe.nodeValue=se,Q.setAttributeNode(fe)}},endElement:function(j,H,W){this.currentElement=this.currentElement.parentNode},startPrefixMapping:function(j,H){},endPrefixMapping:function(j){},processingInstruction:function(j,H){var W=this.doc.createProcessingInstruction(j,H);this.locator&&A(this.locator,W),N(this,W)},ignorableWhitespace:function(j,H,W){},characters:function(j,H,W){if(j=F.apply(this,arguments),j){if(this.cdata)var X=this.doc.createCDATASection(j);else var X=this.doc.createTextNode(j);this.currentElement?this.currentElement.appendChild(X):/^\s*$/.test(j)&&this.doc.appendChild(X),this.locator&&A(this.locator,X)}},skippedEntity:function(j){},endDocument:function(){this.doc.normalize()},setDocumentLocator:function(j){j&&(j.lineNumber=0),this.locator=j},comment:function(j,H,W){j=F.apply(this,arguments);var X=this.doc.createComment(j);this.locator&&A(this.locator,X),N(this,X)},startCDATA:function(){this.cdata=!0},endCDATA:function(){this.cdata=!1},startDTD:function(j,H,W,X){var oe=this.doc.implementation;if(oe&&oe.createDocumentType){var Q=oe.createDocumentType(j,H,W,X);this.locator&&A(this.locator,Q),N(this,Q),this.doc.doctype=Q}},reportError:function(j,H){if(typeof this.onError=="function")try{this.onError(j,H,this)}catch(W){throw new m("Reporting "+j+' "'+H+'" caused '+W,this.locator)}else console.error("[xmldom "+j+"]	"+H,M(this.locator))},warning:function(j){this.reportError("warning",j)},error:function(j){this.reportError("error",j)},fatalError:function(j){throw this.reportError("fatalError",j),new m(j,this.locator)}};function M(j){if(j)return`
@#[line:`+j.lineNumber+",col:"+j.columnNumber+"]"}function F(j,H,W){return typeof j=="string"?j.substr(H,W):j.length>=H+W||H?new java.lang.String(j,H,W)+"":j}"endDTD,startEntity,endEntity,attributeDecl,elementDecl,externalEntityDecl,internalEntityDecl,resolveEntity,getExternalSubset,notationDecl,unparsedEntityDecl".replace(/\w+/g,function(j){T.prototype[j]=function(){return null}});function N(j,H){j.currentElement?j.currentElement.appendChild(H):j.doc.appendChild(H)}function O(j){if(j==="error")throw"onErrorStopParsing"}function U(){throw"onWarningStopParsing"}return hm.__DOMHandler=T,hm.DOMParser=E,hm.normalizeLineEndings=x,hm.onErrorStopParsing=O,hm.onWarningStopParsing=U,hm}var Rq;function Wke(){if(Rq)return ma;Rq=1;var t=A_();ma.assign=t.assign,ma.hasDefaultHTMLNamespace=t.hasDefaultHTMLNamespace,ma.isHTMLMimeType=t.isHTMLMimeType,ma.isValidMimeType=t.isValidMimeType,ma.MIME_TYPE=t.MIME_TYPE,ma.NAMESPACE=t.NAMESPACE;var e=O3();ma.DOMException=e.DOMException,ma.DOMExceptionName=e.DOMExceptionName,ma.ExceptionCode=e.ExceptionCode,ma.ParseError=e.ParseError;var r=lee();ma.Attr=r.Attr,ma.CDATASection=r.CDATASection,ma.CharacterData=r.CharacterData,ma.Comment=r.Comment,ma.Document=r.Document,ma.DocumentFragment=r.DocumentFragment,ma.DocumentType=r.DocumentType,ma.DOMImplementation=r.DOMImplementation,ma.Element=r.Element,ma.Entity=r.Entity,ma.EntityReference=r.EntityReference,ma.LiveNodeList=r.LiveNodeList,ma.NamedNodeMap=r.NamedNodeMap,ma.Node=r.Node,ma.NodeList=r.NodeList,ma.Notation=r.Notation,ma.ProcessingInstruction=r.ProcessingInstruction,ma.Text=r.Text,ma.XMLSerializer=r.XMLSerializer;var n=Gke();return ma.DOMParser=n.DOMParser,ma.normalizeLineEndings=n.normalizeLineEndings,ma.onErrorStopParsing=n.onErrorStopParsing,ma.onWarningStopParsing=n.onWarningStopParsing,ma}var Xke=Wke();const uee=(function(){const t=/\s*/g,e=/^\s*|\s*$/g,r=/\s+/;function n(O){if(!O||!O.length)return 0;for(var U=0,j=0;U<O.length;U++)j=(j<<5)-j+O.charCodeAt(U)|0;return j}function i(O,U){return O.getElementsByTagName(U)}function a(O,U){return O.getAttribute(U)}function s(O,U){return parseFloat(a(O,U))}function o(O,U){const j=i(O,U);return j.length?j[0]:null}function c(O){return O.normalize&&O.normalize(),O}function f(O){for(var U=0,j=[];U<O.length;U++)j[U]=parseFloat(O[U]);return j}function d(O){return O&&c(O),O&&O.textContent||""}function m(O,U){let j={},H,W;for(W=0;W<U.length;W++)H=o(O,U[W]),H&&(j[U[W]]=d(H));return j}function b(O,U){for(const j in U)O[j]=U[j]}function x(O){return f(O.replace(t,"").split(","))}function E(O){const U=O.replace(e,"").split(r),j=[];for(let H=0;H<U.length;H++)j.push(x(U[H]));return j}function T(O){let U=[s(O,"lon"),s(O,"lat")],j=o(O,"ele"),H=o(O,"gpxtpx:hr")||o(O,"hr"),W=o(O,"time"),X;return j&&(X=parseFloat(d(j)),isNaN(X)||U.push(X)),{coordinates:U,time:W?d(W):null,heartRate:H?parseFloat(d(H)):null}}function A(){return{type:"FeatureCollection",features:[]}}let M;if(typeof XMLSerializer<"u")M=new XMLSerializer;else{const O=typeof process=="object"&&!process.browser,U=typeof Titanium=="object";if(typeof exports=="object"&&(O||U))M=Xke.XMLSerializer;else throw new Error("Unable to initialize serializer")}function F(O){return O.xml!==void 0?O.xml:M.serializeToString(O)}return{kml:function(O){const U=A(),j={},H={},W={},X=["Polygon","LineString","Point","Track","gx:Track"],oe=i(O,"Placemark"),Q=i(O,"Style"),G=i(O,"StyleMap");for(let ye=0;ye<Q.length;ye++){const Te=n(F(Q[ye])).toString(16);j["#"+a(Q[ye],"id")]=Te,H[Te]=Q[ye]}for(let ye=0;ye<G.length;ye++){j["#"+a(G[ye],"id")]=n(F(G[ye])).toString(16);const Te=i(G[ye],"Pair"),Ie={};for(let Me=0;Me<Te.length;Me++)Ie[d(o(Te[Me],"key"))]=d(o(Te[Me],"styleUrl"));W["#"+a(G[ye],"id")]=Ie}for(let ye=0;ye<oe.length;ye++)U.features=U.features.concat(Le(oe[ye]));function ae(ye){let Te,Ie;return ye=ye||"",ye.substr(0,1)==="#"&&(ye=ye.substr(1)),(ye.length===6||ye.length===3)&&(Te=ye),ye.length===8&&(Ie=parseInt(ye.substr(0,2),16)/255,Te="#"+ye.substr(6,2)+ye.substr(4,2)+ye.substr(2,2)),[Te,isNaN(Ie)?void 0:Ie]}function se(ye){return f(ye.split(" "))}function fe(ye){let Te=i(ye,"coord"),Ie=[],Me=[];Te.length===0&&(Te=i(ye,"gx:coord"));for(let Se=0;Se<Te.length;Se++)Ie.push(se(d(Te[Se])));const de=i(ye,"when");for(let Se=0;Se<de.length;Se++)Me.push(d(de[Se]));return{coords:Ie,times:Me}}function _e(ye){let Te,Ie,Me,de,Se,we=[],De=[];if(o(ye,"MultiGeometry"))return _e(o(ye,"MultiGeometry"));if(o(ye,"MultiTrack"))return _e(o(ye,"MultiTrack"));if(o(ye,"gx:MultiTrack"))return _e(o(ye,"gx:MultiTrack"));for(Me=0;Me<X.length;Me++)if(Ie=i(ye,X[Me]),Ie){for(de=0;de<Ie.length;de++)if(Te=Ie[de],X[Me]==="Point")we.push({type:"Point",coordinates:x(d(o(Te,"coordinates")))});else if(X[Me]==="LineString")we.push({type:"LineString",coordinates:E(d(o(Te,"coordinates")))});else if(X[Me]==="Polygon"){const Fe=i(Te,"LinearRing"),Xe=[];for(Se=0;Se<Fe.length;Se++)Xe.push(E(d(o(Fe[Se],"coordinates"))));we.push({type:"Polygon",coordinates:Xe})}else if(X[Me]==="Track"||X[Me]==="gx:Track"){const Fe=fe(Te);we.push({type:"LineString",coordinates:Fe.coords}),Fe.times.length&&De.push(Fe.times)}}return{geoms:we,coordTimes:De}}function Le(ye){let Te=_e(ye),Ie,Me={},de=d(o(ye,"name")),Se=d(o(ye,"address")),we=d(o(ye,"styleUrl")),De=d(o(ye,"description")),Fe=o(ye,"TimeSpan"),Xe=o(ye,"TimeStamp"),Be=o(ye,"ExtendedData"),st=o(ye,"LineStyle"),Qe=o(ye,"PolyStyle"),it=o(ye,"visibility");if(!Te.geoms.length)return[];if(de&&(Me.name=de),Se&&(Me.address=Se),we){we[0]!=="#"&&(we="#"+we),Me.styleUrl=we,j[we]&&(Me.styleHash=j[we]),W[we]&&(Me.styleMapHash=W[we],Me.styleHash=j[W[we].normal]);const Ot=H[Me.styleHash];if(Ot){st||(st=o(Ot,"LineStyle")),Qe||(Qe=o(Ot,"PolyStyle"));const at=o(Ot,"IconStyle");if(at){const $e=o(at,"Icon");if($e){const Xt=d(o($e,"href"));Xt&&(Me.icon=Xt)}}}}if(De&&(Me.description=De),Fe){const Ot=d(o(Fe,"begin")),at=d(o(Fe,"end"));Me.timespan={begin:Ot,end:at}}if(Xe&&(Me.timestamp=d(o(Xe,"when"))),st){const Ot=ae(d(o(st,"color"))),at=Ot[0],$e=Ot[1],Xt=parseFloat(d(o(st,"width")));at&&(Me.stroke=at),isNaN($e)||(Me["stroke-opacity"]=$e),isNaN(Xt)||(Me["stroke-width"]=Xt)}if(Qe){const Ot=ae(d(o(Qe,"color"))),at=Ot[0],$e=Ot[1],Xt=d(o(Qe,"fill")),$t=d(o(Qe,"outline"));at&&(Me.fill=at),isNaN($e)||(Me["fill-opacity"]=$e),Xt&&(Me["fill-opacity"]=Xt==="1"?Me["fill-opacity"]||1:0),$t&&(Me["stroke-opacity"]=$t==="1"?Me["stroke-opacity"]||1:0)}if(Be){const Ot=i(Be,"Data"),at=i(Be,"SimpleData");for(Ie=0;Ie<Ot.length;Ie++)Me[Ot[Ie].getAttribute("name")]=d(o(Ot[Ie],"value"));for(Ie=0;Ie<at.length;Ie++)Me[at[Ie].getAttribute("name")]=d(at[Ie])}it&&(Me.visibility=d(it)),Te.coordTimes.length&&(Me.coordTimes=Te.coordTimes.length===1?Te.coordTimes[0]:Te.coordTimes);const be={type:"Feature",geometry:Te.geoms.length===1?Te.geoms[0]:{type:"GeometryCollection",geometries:Te.geoms},properties:Me};return a(ye,"id")&&(be.id=a(ye,"id")),[be]}return U},gpx:function(O){let U,j=i(O,"trk"),H=i(O,"rte"),W=i(O,"wpt"),X=A(),oe;for(U=0;U<j.length;U++)oe=ae(j[U]),oe&&X.features.push(oe);for(U=0;U<H.length;U++)oe=se(H[U]),oe&&X.features.push(oe);for(U=0;U<W.length;U++)X.features.push(fe(W[U]));function Q(ye,Te){for(let Ie=0;Ie<Te;Ie++)ye.push(null);return ye}function G(ye,Te){const Ie=i(ye,Te),Me=[],de=[],Se=[],we=Ie.length;if(we<2)return{};for(let De=0;De<we;De++){const Fe=T(Ie[De]);Me.push(Fe.coordinates),Fe.time&&de.push(Fe.time),(Fe.heartRate||Se.length)&&(Se.length||Q(Se,De),Se.push(Fe.heartRate||null))}return{line:Me,times:de,heartRates:Se}}function ae(ye){let Te=i(ye,"trkseg"),Ie=[],Me=[],de=[],Se;for(let De=0;De<Te.length;De++)if(Se=G(Te[De],"trkpt"),Se&&(Se.line&&Ie.push(Se.line),Se.times&&Se.times.length&&Me.push(Se.times),de.length||Se.heartRates&&Se.heartRates.length)){if(!de.length)for(let Fe=0;Fe<De;Fe++)de.push(Q([],Ie[Fe].length));Se.heartRates&&Se.heartRates.length?de.push(Se.heartRates):de.push(Q([],Se.line.length||0))}if(Ie.length===0)return;const we=Le(ye);return b(we,_e(o(ye,"extensions"))),Me.length&&(we.coordTimes=Ie.length===1?Me[0]:Me),de.length&&(we.heartRates=Ie.length===1?de[0]:de),{type:"Feature",properties:we,geometry:{type:Ie.length===1?"LineString":"MultiLineString",coordinates:Ie.length===1?Ie[0]:Ie}}}function se(ye){const Te=G(ye,"rtept");if(!Te.line)return;const Ie=Le(ye);return b(Ie,_e(o(ye,"extensions"))),{type:"Feature",properties:Ie,geometry:{type:"LineString",coordinates:Te.line}}}function fe(ye){const Te=Le(ye);return b(Te,m(ye,["sym"])),{type:"Feature",properties:Te,geometry:{type:"Point",coordinates:T(ye).coordinates}}}function _e(ye){const Te={};if(ye){const Ie=o(ye,"line");if(Ie){const Me=d(o(Ie,"color")),de=parseFloat(d(o(Ie,"opacity"))),Se=parseFloat(d(o(Ie,"width")));Me&&(Te.stroke=Me),isNaN(de)||(Te["stroke-opacity"]=de),isNaN(Se)||(Te["stroke-width"]=Se*96/25.4)}}return Te}function Le(ye){const Te=m(ye,["name","cmt","desc","type","time","keywords"]),Ie=i(ye,"link");Ie.length&&(Te.links=[]);for(let Me=0,de;Me<Ie.length;Me++)de={href:a(Ie[Me],"href")},b(de,m(Ie[Me],["text","type"])),Te.links.push(de);return Te}return X}}})(),FE=t=>{const[e,r]=te.useState(),[n,i]=te.useState([]),a=s=>{try{i([]);const c=new DOMParser().parseFromString(s,"application/xml");c.querySelector("metadata")?.childNodes.forEach(m=>{let b=m.textContent;const x=m.nodeName;if(m.nodeName==="link"&&(b=m.getAttribute("href")??""),b?.trim().length){const E={title:x,value:b,id:new Date().getTime()};i(T=>[...T,E])}});const d=uee.gpx(c);r(d)}catch(o){console.log(o)}};return te.useEffect(()=>{t.data&&a(t.data)},[t.data]),{geojson:e,metadata:n}};FE.defaultProps={data:void 0};try{FE.displayName="useGpx",FE.__docgenInfo={description:"useGpx hook converts GPX data to GeoJSON",displayName:"useGpx",props:{data:{defaultValue:{value:"undefined"},description:"a string containing GPX data that is supposed to be parsed and converted to GeoJSON by this hook",name:"data",required:!1,type:{name:"string | undefined"}}}}}catch{}const BE=t=>{const e=va({mapId:t.mapId,waitForLayer:t.layerId}),r=te.useRef(new AT.Popup({closeButton:!1,closeOnClick:!0}));return te.useEffect(()=>{!e.map||!t.layerId||e.map.on("mouseenter",t.layerId,n=>{if(!e.map)return;const i=n?.features?.[0].geometry.coordinates.slice();let a="";if(n?.features?.[0]&&typeof t.getPopupContent=="function"&&(a=t.getPopupContent(n.features[0])),i?.[0]){for(;Math.abs(n.lngLat.lng-i[0])>180;)i[0]+=n.lngLat.lng>i[0]?360:-360;r.current.setLngLat(i).setHTML(a).addTo(e.map.map)}},e.componentId)},[e.map]),J.jsx(J.Fragment,{})};BE.defaultProps={mapId:void 0};try{BE.displayName="LayerHoverPopup",BE.__docgenInfo={description:"useLayerHoverPopup hook registers a mouseenter event to display feature properties in a MapLibre popup if a feature on the configured layer is hovered",displayName:"LayerHoverPopup",props:{mapId:{defaultValue:{value:"undefined"},description:"Id of the target MapLibre instance in mapContext",name:"mapId",required:!1,type:{name:"string | undefined"}},layerId:{defaultValue:null,description:"Id of an existing layer in the mapLibre instance this event will be registered to",name:"layerId",required:!1,type:{name:"string | undefined"}},getPopupContent:{defaultValue:null,description:"",name:"getPopupContent",required:!0,type:{name:"(feature: Feature<Geometry, GeoJsonProperties>) => string"}}}}}catch{}const Mq=t=>{const e=FE({data:t.gpxData}),r=va({mapId:t.mapId,waitForLayer:t.insertBeforeLayer}),n=te.useRef("gpx-viewer-source-"+_c()),i=te.useRef("importer-layer-lines-"+_c()),a=te.useRef("importer-layer-points-"+_c());return BE({layerId:a.current,getPopupContent:s=>s?.properties?.name}),fN({mapId:t.mapId,sourceId:n.current,source:{type:"geojson",data:e.geojson||Ep([])}}),Tp({layerId:i.current,options:{type:"line",paint:{"line-width":4,"line-color":"rgba(212, 55, 23,0.5)"},source:n.current},insertBeforeLayer:t.insertBeforeLayer}),Tp({layerId:a.current,options:{type:"circle",paint:{"circle-color":"rgba(72, 77, 99,0.5)","circle-radius":7},filter:["==","$type","Point"],source:n.current},insertBeforeLayer:t.insertBeforeLayer}),te.useEffect(()=>{if(!r.map||!e.geojson)return;typeof t.onParseGpxData=="function"&&t.onParseGpxData(e);const s=mf(e.geojson);r.map.map.fitBounds(s)},[e]),J.jsx(J.Fragment,{})};try{Mq.displayName="MlGpxViewer",Mq.__docgenInfo={description:"MlGpxViewer visualizes a given GPX Track on the map",displayName:"MlGpxViewer",props:{mapId:{defaultValue:null,description:"Id of the target MapLibre instance in mapHook",name:"mapId",required:!1,type:{name:"string | undefined"}},insertBeforeLayer:{defaultValue:null,description:`The layerId of an existing layer this layer should be rendered visually beneath
https://maplibre.org/maplibre-gl-js-docs/api/map/#map#addlayer - see "beforeId" property`,name:"insertBeforeLayer",required:!1,type:{name:"string | undefined"}},idPrefix:{defaultValue:null,description:"Prefix of the component id this component uses when adding elements to the MapLibreGl-instance",name:"idPrefix",required:!1,type:{name:"string | undefined"}},gpxData:{defaultValue:null,description:"",name:"gpxData",required:!0,type:{name:"string | undefined"}},onParseGpxData:{defaultValue:null,description:"",name:"onParseGpxData",required:!0,type:{name:"(arg0: { geojson: FeatureCollection<Geometry, GeoJsonProperties> | undefined; metadata: MetadataType[]; }) => void"}}}}}catch{}const Yke=gt.createContext({}),Zke=Yke.Provider,Dq=({children:t})=>{const[e,r]=te.useState({type:"FeatureCollection",features:[]}),i={data:e,setData:r,getEmptyFeatureCollection:()=>({type:"FeatureCollection",features:[]})};return J.jsx(Zke,{value:i,children:t})};try{Dq.displayName="GeoJsonProvider",Dq.__docgenInfo={description:"",displayName:"GeoJsonProvider",props:{}}}catch{}const hM=()=>{const t=Object.fromEntries(new URLSearchParams(window.location.search));return t.layers=JSON.parse(t?.layers?t.layers:"[]"),t},hP=hM(),Oq=t=>{const e=te.useContext(Ng),r=te.useRef(!1),n=te.useRef(null),[i,a]=te.useState(void 0),s=te.useRef({}),o=te.useRef((t.idPrefix?t.idPrefix:"MlShareMapState-")+_c()),c=HT({watch:{viewport:!1,layers:!0,sources:!1},filter:{includeBaseLayers:!1}}),f=te.useRef(!1),d=te.useRef(null),m=te.useRef({viewport:{center:!1,bearing:!1,pitch:!1,zoom:!1},layers:{...s}}),b=te.useRef({}),x=te.useCallback(()=>{if(!t.active)return;const A=[];for(const N in c.layers)A.push({id:c.layers[N]?.id,type:c.layers[N]?.type,visible:c.layers[N]?.visible});E();const M=new URLSearchParams({...hM(),...b.current,layers:JSON.stringify(A)});JSON.parse(Object.fromEntries(M).layers).forEach(N=>{s.current[N.id]=!1});const F=new URLSearchParams(window.location.search);M.toString()!==F.toString()&&window.history.pushState({...b.current},document.title,"?"+M.toString())},[c.layers,t.active]);te.useEffect(()=>{const A=o.current;return b.current=hM(),()=>{n.current&&(n.current.cleanup(A),n.current=null),r.current=!1}},[]),te.useEffect(()=>{n.current&&x()},[x]),te.useEffect(()=>{if(!n.current)return;const A=x;return n.current.on("moveend",A,o.current),()=>{n.current?.map.off("moveend",A)}},[x,i]),te.useEffect(()=>{!e?.mapExists?.(t.mapId)||r.current||(r.current=!0,n.current=e.getMap(t.mapId),a(n.current),b.current.lat&&b.current.lng&&T())},[e.mapIds,e,t.mapId,t.active]),te.useEffect(()=>{if(c?.layers?.length){typeof d.current>"u"&&(d.current=null,hP?.layers?.forEach(A=>{d.current?.[A.id]&&(d.current[A.id]=!1)}));for(const A in d.current){let M=!0;if(d.current[A]===!1&&(M=!1),M)return}hP.layers&&hP.layers.forEach(A=>{n.current?.map.getLayer(A.id)&&d.current?.[A.id]===!1&&(d.current[A.id]=!0,n.current.map?.getLayer(A.id)?.setLayoutProperty("visibility",A.visible?"visible":"none"))})}},[c.layers,t.mapId,t.active]),te.useEffect(()=>{i&&c.layers&&(t.active||i.cleanup(o.current))},[t.active,i,c.layers]);const E=()=>{b.current.lat=n.current?.map.getCenter().lat,b.current.lng=n.current?.map.getCenter().lng,b.current.zoom=n.current?.map.getZoom(),b.current.bearing=n.current?.map.getBearing(),b.current.pitch=n.current?.map.getPitch()},T=()=>{m.current.viewport.center||(m.current.viewport.center=!0,b.current.lng&&b.current.lat&&n.current?.map.setCenter([b.current.lng,b.current.lat]),b.current.zoom&&n.current?.map.setZoom(b.current.zoom),b.current.bearing&&n.current?.map.setBearing(b.current.bearing),b.current.pitch&&n.current?.map.setPitch(b.current.pitch)),f.current=!0};return window.onpopstate=A=>{A.state&&A.state.lng&&A.state.lat&&A.state.zoom&&n.current?.map.easeTo({zoom:A.state.zoom,center:[A.state.lng,A.state.lat]})},J.jsx(J.Fragment,{})};try{Oq.displayName="MlShareMapState",Oq.__docgenInfo={description:"",displayName:"MlShareMapState",props:{mapId:{defaultValue:null,description:"",name:"mapId",required:!1,type:{name:"string | undefined"}},idPrefix:{defaultValue:null,description:"",name:"idPrefix",required:!1,type:{name:"string | undefined"}},active:{defaultValue:null,description:"",name:"active",required:!1,type:{name:"boolean | undefined"}}}}}catch{}function Kke(t,e){const r=(s,o,c,f,d)=>{const m=Su([[s,o],[f,d]]),b=lSe(m,5,{units:"meters"}),x=b.geometry.coordinates[0][0],E=b.geometry.coordinates[0][1],T=b.geometry.coordinates[1][0],A=b.geometry.coordinates[1][1];return h3([[[s,o],[f,d],[T,A],[x,E],[s,o]]],{height:c*e})},n=(s,o,c)=>s*(1-c)+o*c,i=[];return t.line.geometry.coordinates.forEach((s,o)=>{if(t.line.geometry.coordinates[o+1]&&Array.isArray(s)){let f=~~(d3([s[0],s[1]],[t.line.geometry.coordinates[o+1][0],t.line.geometry.coordinates[o+1][1]],{units:"kilometers"})*1e3/10);f=f<1?1:f;for(let d=0;d<f;d++){const m=n(t.line.geometry.coordinates[o][0],t.line.geometry.coordinates[o+1][0],d/f),b=n(t.line.geometry.coordinates[o][1],t.line.geometry.coordinates[o+1][1],d/f),x=n(t.line.geometry.coordinates[o][2]-t.min,t.line.geometry.coordinates[o+1][2]-t.min,d/f),E=n(t.line.geometry.coordinates[o][0],t.line.geometry.coordinates[o+1][0],(d+1)/f),T=n(t.line.geometry.coordinates[o][1],t.line.geometry.coordinates[o+1][1],(d+1)/f),A=r(m,b,x,E,T);i.push(A)}}}),Ep(i)}const Nq=["interpolate",["linear"],["get","height"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"yellow"],Lq=t=>{const e=te.useRef("elevationprofile-"+_c()),r=te.useRef("elevationprofile-layer-"+_c()),n=t.elevationFactor||1,i=te.useMemo(()=>{if(!t?.geojson?.features)return;const o=t.geojson.features?.find(m=>m.geometry.type==="LineString");if(!o||!o.geometry)return;const c=o.geometry.coordinates.map(m=>m[2]),f=Math.min(...c);let d=Math.max(...c)-f;return d=d===0?1:d,{max:d,min:f,line:o}},[t.geojson]),a=te.useMemo(()=>i?["interpolate",["linear"],["get","height"],0,"rgb(0,255,55)",i.max*n,"rgb(255,0,0)"]:Nq,[i,t.elevationFactor]),s=te.useMemo(()=>!t.geojson?.features||!i?void 0:Kke(i,n),[i,n]);return fN({mapId:t.mapId,sourceId:e.current,source:{type:"geojson",data:s||Ep([])}}),Tp({layerId:r.current,options:{source:e.current,type:"fill-extrusion",paint:{"fill-extrusion-height":["get","height"],"fill-extrusion-opacity":.9,"fill-extrusion-color":a||Nq}},insertBeforeLayer:t.insertBeforeLayer}),J.jsx(J.Fragment,{})};try{Lq.displayName="MlSpatialElevationProfile",Lq.__docgenInfo={description:"",displayName:"MlSpatialElevationProfile",props:{mapId:{defaultValue:null,description:"Id of the target MapLibre instance in mapContext",name:"mapId",required:!1,type:{name:"string | undefined"}},geojson:{defaultValue:null,description:"GeoJSON data that is supposed to be rendered by this component.",name:"geojson",required:!0,type:{name:"FeatureCollection<Geometry, GeoJsonProperties> | geojson | undefined"}},idPrefix:{defaultValue:null,description:"Prefix of the component id this component uses when adding elements to the MapLibreGl-instance",name:"idPrefix",required:!1,type:{name:"string | undefined"}},elevationFactor:{defaultValue:null,description:"Number describes the factor of the height of the elevation",name:"elevationFactor",required:!1,type:{name:"number | undefined"}},insertBeforeLayer:{defaultValue:null,description:`The layerId of an existing layer this layer should be rendered visually beneath
https://maplibre.org/maplibre-gl-js-docs/api/map/#map#addlayer - see "beforeId" property`,name:"insertBeforeLayer",required:!1,type:{name:"string | undefined"}}}}}catch{}const R0=t=>{const e=va({mapId:t.mapId,waitForLayer:t.insertBeforeLayer}),r=te.useRef(t.layerId||"MlVectorTileLayer-"+e.componentId),n=te.useRef({}),i=te.useRef({}),a=te.useRef(!1),s=te.useCallback(()=>{e.map&&(a.current=!0,e.map.map.getSource(r.current)&&e.cleanup(),e.map.map.getSource(r.current)||e.map.addSource(r.current,{type:"vector",tiles:[t.url||""],attribution:"",minzoom:0,maxzoom:14,...t.sourceOptions},e.componentId),t.layers.forEach(c=>{e.map&&(e.map.addLayer({source:r.current,minzoom:0,maxzoom:22,layout:{},paint:{"line-opacity":.5,"line-color":"rgb(80, 80, 80)","line-width":2},...c},t.insertBeforeLayer,e.componentId),n.current[c.id]=JSON.stringify(c.paint),i.current[c.id]=JSON.stringify(c.layout),e.map.on("styledata",()=>{a.current&&!e.map?.map.getSource(r.current)&&(console.log("Recreate Layer "+r.current),s())},e.componentId))}))},[e.map,t]),o=te.useCallback(()=>{a.current&&t.layers.forEach(c=>{if(e.map&&e.map.map.getLayer(c.id)){const f=JSON.stringify(c.paint);if(f!==n.current[c.id])for(const m in c.paint)e.map.setPaintProperty(c.id,m,c.paint[m]);n.current[c.id]=f;const d=JSON.stringify(c.layout);if(d!==i.current[c.id])for(const m in c.layout)e.map.setLayoutProperty(c.id,m,c.layout[m]);i.current[c.id]=d}})},[e.map,t.layers]);return te.useEffect(()=>{a.current||s()},[s]),te.useEffect(()=>{!e.map||!a.current||s()},[t.layers.length,e.map]),te.useEffect(()=>{!e.map||!a.current||o()},[t.layers,e.map]),J.jsx(J.Fragment,{})};try{R0.displayName="MlVectorTileLayer",R0.__docgenInfo={description:`Adds a vector-tile source and 0...n vector-tile-layers to the MapLibre instance referenced by
props.mapId`,displayName:"MlVectorTileLayer",props:{mapId:{defaultValue:null,description:"",name:"mapId",required:!1,type:{name:"string | undefined"}},insertBeforeLayer:{defaultValue:null,description:"",name:"insertBeforeLayer",required:!1,type:{name:"string | undefined"}},layerId:{defaultValue:null,description:"",name:"layerId",required:!1,type:{name:"string | undefined"}},sourceOptions:{defaultValue:null,description:"",name:"sourceOptions",required:!1,type:{name:"VectorSourceSpecification | undefined"}},url:{defaultValue:null,description:"",name:"url",required:!1,type:{name:"string | undefined"}},layers:{defaultValue:null,description:"",name:"layers",required:!0,type:{name:"ExtendedLayerSpecification[]"}}}}}catch{}const Fq=t=>{const[e,r]=te.useState(),n=va({mapId:t.mapId}),i=te.useRef(t.mlGeoJsonLayerProps?.layerId||"MlOgcApiFeature-"+n.componentId),a=()=>{const s=new URL(t.ogcApiUrl);if(t.ogcApiFeatureParams&&Object.entries(t.ogcApiFeatureParams).forEach(([o,c])=>{c!=null&&s.searchParams.append(o,c.toString())}),t.reloadFeaturesOnMapMove){const o=n?.map?.getBounds().getSouthWest(),c=n?.map?.getBounds().getNorthEast(),f=`${o?.lng},${o?.lat},${c?.lng},${c?.lat}`;s.searchParams.append("bbox",f)}return s.toString()};return te.useEffect(()=>{if(!n.map)return;const s=()=>{const o=a();fetch(o).then(c=>{if(!c.ok)throw new Error("Error fetching OGC features");return c.json()}).then(c=>{r(c)}).catch(c=>{console.log(c),r(void 0)})};return s(),t.reloadFeaturesOnMapMove&&n.map.on("moveend",s),()=>{n?.map?.off&&n.map.off("moveend",s)}},[n.map,t.ogcApiFeatureParams,t.ogcApiUrl]),te.useEffect(()=>{!n.map||!n.map.map.style.getLayer(i.current)||(t.visible?n.map.map.setLayoutProperty(i.current,"visibility","visible"):n.map.map.setLayoutProperty(i.current,"visibility","none"))},[t.visible,n.map]),J.jsx(J.Fragment,{children:e&&J.jsx(Nc,{geojson:e,layerId:i.current,...t.mlGeoJsonLayerProps})})};try{Fq.displayName="MlOgcApiFeatures",Fq.__docgenInfo={description:"",displayName:"MlOgcApiFeatures",props:{visible:{defaultValue:null,description:"",name:"visible",required:!1,type:{name:"boolean | undefined"}},mapId:{defaultValue:null,description:"Id of the target MapLibre instance in mapContext",name:"mapId",required:!1,type:{name:"string | undefined"}},ogcApiUrl:{defaultValue:null,description:"The url of OGC API",name:"ogcApiUrl",required:!0,type:{name:"URL"}},ogcApiFeatureParams:{defaultValue:null,description:"The additional query parameters of OGC API",name:"ogcApiFeatureParams",required:!1,type:{name:"OgcApiFeaturesParamsTypes | undefined"}},reloadFeaturesOnMapMove:{defaultValue:null,description:"Fetches the features everytime (based on the current bbox) when the map gets moved",name:"reloadFeaturesOnMapMove",required:!1,type:{name:"boolean | undefined"}},mlGeoJsonLayerProps:{defaultValue:null,description:"Geojson Layer props. But omit 'geojson' because it gets set from the OGC API Feature call",name:"mlGeoJsonLayerProps",required:!1,type:{name:'Omit<MlGeoJsonLayerProps, "geojson"> | undefined'}}}}}catch{}const Bq=t=>{const e=te.useContext(Ng),r=te.useRef(!1),n=te.useRef(void 0),i=te.useRef("MlWmsFeatureInfoPopup-"+_c());return te.useEffect(()=>{const a=i.current;return()=>{n.current&&(n.current.cleanup(a),n.current=void 0),r.current=!1}},[]),te.useEffect(()=>{!e.mapExists(t.mapId)||r.current||(r.current=!0,n.current=e.getMap(t.mapId),n.current.setCenter([7.132122000552613,50.716405378037706]))},[e.mapIds,e,t.mapId]),J.jsx(J.Fragment,{})};try{Bq.displayName="MlWmsFeatureInfoPopup",Bq.__docgenInfo={description:"TODO: Add short & useful description",displayName:"MlWmsFeatureInfoPopup",props:{mapId:{defaultValue:null,description:"Id of the target MapLibre instance in mapContext",name:"mapId",required:!1,type:{name:"string | undefined"}}}}}catch{}function pc(t,e){if(!t)return{};const r=t instanceof URLSearchParams?Array.from(t.entries()):Object.entries(t),n=e?r.filter(([i,a])=>e(i,a)):r;return Object.fromEntries(n.map(([i,a])=>[i.toUpperCase(),a]))}const Jke={urlParameters:{bbox:"{bbox-epsg-3857}",format:"image/png",service:"WMS",version:"1.1.1",request:"GetMap",srs:"EPSG:3857",crs:"EPSG:3857",width:"256",height:"256",Transparent:"true",styles:""}},zE=t=>{const e=va({mapId:t.mapId,waitForLayer:t.insertBeforeLayer}),r=te.useRef(!1),n=te.useRef(t.layerId||"MlWmsLayer-"+e.componentId),i=te.useMemo(()=>{let s,o=t.url;t.url.indexOf("?")!==-1&&(s=t.url.split("?"),o=s[0]);const c=new URLSearchParams(s?.[1]),f={...pc(Jke.urlParameters),...pc(c),...pc(t.urlParameters)},d=new URLSearchParams(f),m=decodeURIComponent(d.toString())+"".replace(/%2F/g,"/").replace(/%3A/g,":");return o+"?"+m},[t.urlParameters,t.url]),a=te.useCallback(()=>{e.map&&(r.current=!0,e.map.map.getLayer(n.current)&&e.cleanup(),e.map.addSource(n.current,{type:"raster",tiles:[i],tileSize:256,attribution:t.attribution??"",...t.sourceOptions},e.componentId),e.map.addLayer({id:n.current,type:"raster",source:n.current,...t.layerOptions},t.insertBeforeLayer,e.componentId),e.map.on("styledata",()=>{r.current&&!e.map?.map.getLayer(n.current)&&(console.log("Recreate Layer "+n.current),a())},e.componentId),t.visible===!1&&e.map.map.setLayoutProperty(n.current,"visibility","none"))},[e.map,t,i]);return te.useEffect(()=>{r.current&&e?.map?.map?.getSource?.(n.current)?.tiles?.[0]===i||a()},[a]),te.useEffect(()=>{!e.map||!r.current||(t.visible===void 0||t.visible?e.map.map.setLayoutProperty(n.current,"visibility","visible"):e.map.map.setLayoutProperty(n.current,"visibility","none"))},[t.visible,e.map]),J.jsx(J.Fragment,{})};try{zE.displayName="MlWmsLayer",zE.__docgenInfo={description:"Adds a WMS raster source & layer to the maplibre-gl instance",displayName:"MlWmsLayer",props:{urlParameters:{defaultValue:null,description:"",name:"urlParameters",required:!1,type:{name:"{ [key: string]: string; } | undefined"}},url:{defaultValue:null,description:"",name:"url",required:!0,type:{name:"string"}},visible:{defaultValue:null,description:"",name:"visible",required:!1,type:{name:"boolean | undefined"}},attribution:{defaultValue:null,description:"",name:"attribution",required:!1,type:{name:"string | undefined"}},mapId:{defaultValue:null,description:"",name:"mapId",required:!1,type:{name:"string | undefined"}},sourceOptions:{defaultValue:null,description:"",name:"sourceOptions",required:!1,type:{name:"RasterSourceSpecification | undefined"}},layerOptions:{defaultValue:null,description:"",name:"layerOptions",required:!1,type:{name:"RasterLayerSpecification | undefined"}},insertBeforeLayer:{defaultValue:null,description:"",name:"insertBeforeLayer",required:!1,type:{name:"string | undefined"}},layerId:{defaultValue:null,description:"",name:"layerId",required:!1,type:{name:"string | undefined"}}}}}catch{}/**
 * wms-capabilities @0.6.0
 * @description WMS service Capabilities > JSON, based on openlayers 
 * @license BSD-2-Clause
 * @preserve
 */var fa=t=>t!==void 0,cee=(t,e,r)=>e in t?t[e]:t[e]=r;const ox={ELEMENT:1,TEXT:3,CDATA_SECTION:4};class Qke{constructor(e){this._parser=new e}toDocument(e){return this._parser.parseFromString(e,"application/xml")}getAllTextContent(e,r){return N3(e,r).join("")}}function N3(t,e){return fee(t,e,[]).join("")}function fee(t,e,r){if(t.nodeType===ox.CDATA_SECTION||t.nodeType===ox.TEXT)e?r.push(String(t.nodeValue).replace(/(\r\n|\r|\n)/g,"")):r.push(t.nodeValue);else{var n;for(n=t.firstChild;n;n=n.nextSibling)fee(n,e,r)}return r}function eRe(t,e,r,n){for(var i=tRe(e);i;i=rRe(i)){var a=i.namespaceURI||null,s=t[a];if(fa(s)){var o=s[i.localName];fa(o)&&o.call(n,i,r)}}}function tRe(t){let e=t.firstElementChild||t.firstChild;for(;e&&e.nodeType!==ox.ELEMENT;)e=e.nextSibling;return e}function rRe(t){let e=t.nextElementSibling||t.nextSibling;for(;e&&e.nodeType!==ox.ELEMENT;)e=e.nextSibling;return e}function Cu(t,e,r){return nRe(t,e,r)}function nRe(t,e,r){var n=fa(r)?r:{},i,a;for(i=0,a=t.length;i<a;++i)n[t[i]]=e;return n}function hee(t,e){return(function(r,n){var i=t.call(fa(e)?e:this,r,n);if(fa(i)){var a=n[n.length-1];a.push(i)}})}function lu(t,e,r,n,i){return n.push(t),eRe(e,r,n,i),n.pop()}function si(t,e,r){return(function(n,i){let a=t.call(fa(r)?r:this,n,i);if(fa(a)){var s=i[i.length-1],o=fa(e)?e:n.localName;s[o]=a}})}function Ac(t,e,r){return(function(n,i){var a=t.call(fa(r)?r:this,n,i);if(fa(a)){var s=i[i.length-1],o=fa(e)?e:n.localName,c=cee(s,o,[]);c.push(a)}})}const iRe=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g;function aRe(t){return t.replace(iRe,"")}function jm(t){const e=/^\s*(true|1)|(false|0)\s*$/.exec(t);if(e)return fa(e[1])||!1}function p0(t){return pp(N3(t,!1))}function pp(t){const e=/^\s*([+\-]?\d*\.?\d+(?:e[+\-]?\d+)?)\s*$/i.exec(t);if(e)return parseFloat(e[1])}function dP(t){return jE(N3(t,!1))}function jE(t){const e=/^\s*(\d+)\s*$/.exec(t);if(e)return parseInt(e[1],10)}function Na(t){return aRe(N3(t,!1))}const oRe="http://www.w3.org/1999/xlink";function fL(t){return t.getAttributeNS(oRe,"href")}function sRe(t,e){return lu({},ORe,t,e)}function dee(t){return[pp(t.getAttribute("minx")),pp(t.getAttribute("miny")),pp(t.getAttribute("maxx")),pp(t.getAttribute("maxy"))]}function lRe(t,e){const r=dee(t),n=[pp(t.getAttribute("resx")),pp(t.getAttribute("resy"))];return{crs:t.getAttribute("CRS")||t.getAttribute("SRS"),extent:r,res:n}}function uRe(t,e){const r=dee(t);if(!(!fa(r[0])||!fa(r[1])||!fa(r[2])||!fa(r[3])))return r}function cRe(t,e){const r=parseFloat(t.getAttribute("min")),n=parseFloat(t.getAttribute("max"));return{min:r,max:n}}function fRe(t,e){const r=lu({},NRe,t,e);if(!fa(r))return;const n=r.westBoundLongitude,i=r.southBoundLatitude,a=r.eastBoundLongitude,s=r.northBoundLatitude;if(!(!fa(n)||!fa(i)||!fa(a)||!fa(s)))return[n,i,a,s]}function hRe(t,e){return lu({},IRe,t,e)}function dRe(t,e){return lu({},PRe,t,e)}function pRe(t,e){return lu({},kRe,t,e)}function gRe(t,e){return lu({},RRe,t,e)}function mRe(t,e){return lu({},MRe,t,e)}function yRe(t,e){return lu([],DRe,t,e)}function vRe(t,e){const r=jm(t.getAttribute("queryable"));return lu({queryable:fa(r)?r:!1},mee,t,e)}function _Re(t,e){var r=e[e.length-1];const n=lu({},mee,t,e);if(!fa(n))return;let i=jm(t.getAttribute("queryable"));fa(i)||(i=r.queryable),n.queryable=fa(i)?i:!1;let a=jE(t.getAttribute("cascaded"));fa(a)||(a=r.cascaded),n.cascaded=a;let s=jm(t.getAttribute("opaque"));fa(s)||(s=r.opaque),n.opaque=fa(s)?s:!1;let o=jm(t.getAttribute("noSubsets"));fa(o)||(o=r.noSubsets),n.noSubsets=fa(o)?o:!1;let c=pp(t.getAttribute("fixedWidth"));fa(c)||(c=r.fixedWidth),n.fixedWidth=c;let f=pp(t.getAttribute("fixedHeight"));fa(f)||(f=r.fixedHeight),n.fixedHeight=f;const d=["Style","CRS","AuthorityURL"];for(let b=0,x=d.length;b<x;b++){const E=d[b],T=r[E];if(fa(T)){let A=cee(n,E,[]);A=A.concat(T),n[E]=A}}const m=["EX_GeographicBoundingBox","BoundingBox","Dimension","Attribution","MinScaleDenominator","MaxScaleDenominator"];for(let b=0,x=m.length;b<x;b++){const E=m[b],T=n[E];if(!fa(T)){const A=r[E];n[E]=A}}return n}function bRe(t,e){return{name:t.getAttribute("name"),units:t.getAttribute("units"),unitSymbol:t.getAttribute("unitSymbol"),default:t.getAttribute("default"),multipleValues:jm(t.getAttribute("multipleValues")),nearestValue:jm(t.getAttribute("nearestValue")),current:jm(t.getAttribute("current")),values:Na(t)}}function Cp(t,e){return lu({},URe,t,e)}function xRe(t,e){return lu({},LRe,t,e)}function wRe(t,e){return lu({},BRe,t,e)}function SRe(t,e){return lu({},zRe,t,e)}function pP(t,e){return lu({},FRe,t,e)}function pee(t,e){var r=Cp(t,e);if(fa(r)){const n=[jE(t.getAttribute("width")),jE(t.getAttribute("height"))];return r.size=n,r}}function ERe(t,e){var r=Cp(t,e);if(fa(r))return r.name=t.getAttribute("name"),r}function TRe(t,e){var r=Cp(t,e);if(fa(r))return r.type=t.getAttribute("type"),r}function CRe(t,e){return lu({},jRe,t,e)}function gee(t,e){return lu([],VRe,t,e)}const Au=[null,"http://www.opengis.net/wms"],ARe=Cu(Au,{Service:si(dRe),Capability:si(hRe)}),IRe=Cu(Au,{Request:si(xRe),Exception:si(yRe),Layer:si(vRe)}),PRe=Cu(Au,{Name:si(Na),Title:si(Na),Abstract:si(Na),KeywordList:si(gee),OnlineResource:si(fL),ContactInformation:si(pRe),Fees:si(Na),AccessConstraints:si(Na),LayerLimit:si(dP),MaxWidth:si(dP),MaxHeight:si(dP)}),kRe=Cu(Au,{ContactPersonPrimary:si(gRe),ContactPosition:si(Na),ContactAddress:si(mRe),ContactVoiceTelephone:si(Na),ContactFacsimileTelephone:si(Na),ContactElectronicMailAddress:si(Na)}),RRe=Cu(Au,{ContactPerson:si(Na),ContactOrganization:si(Na)}),MRe=Cu(Au,{AddressType:si(Na),Address:si(Na),City:si(Na),StateOrProvince:si(Na),PostCode:si(Na),Country:si(Na)}),DRe=Cu(Au,{Format:hee(Na)}),mee=Cu(Au,{Name:si(Na),Title:si(Na),Abstract:si(Na),KeywordList:si(gee),CRS:Ac(Na),SRS:Ac(Na),EX_GeographicBoundingBox:si(fRe),LatLonBoundingBox:si(uRe),BoundingBox:Ac(lRe),Dimension:Ac(bRe),Attribution:si(sRe),AuthorityURL:Ac(ERe),Identifier:Ac(Na),MetadataURL:Ac(TRe),DataURL:Ac(Cp),FeatureListURL:Ac(Cp),Style:Ac(CRe),MinScaleDenominator:si(p0),MaxScaleDenominator:si(p0),ScaleHint:si(cRe),Layer:Ac(_Re)}),ORe=Cu(Au,{Title:si(Na),OnlineResource:si(fL),LogoURL:si(pee)}),NRe=Cu(Au,{westBoundLongitude:si(p0),eastBoundLongitude:si(p0),southBoundLatitude:si(p0),northBoundLatitude:si(p0)}),LRe=Cu(Au,{GetCapabilities:si(pP),GetMap:si(pP),GetFeatureInfo:si(pP)}),FRe=Cu(Au,{Format:Ac(Na),DCPType:Ac(wRe)}),BRe=Cu(Au,{HTTP:si(SRe)}),zRe=Cu(Au,{Get:si(Cp),Post:si(Cp)}),jRe=Cu(Au,{Name:si(Na),Title:si(Na),Abstract:si(Na),LegendURL:Ac(pee),StyleSheetURL:si(Cp),StyleURL:si(Cp)}),URe=Cu(Au,{Format:si(Na),OnlineResource:si(fL)}),VRe=Cu(Au,{Keyword:hee(Na)});class $Re{constructor(e,r){!r&&typeof window<"u"&&(r=window.DOMParser),this.version=void 0,this._parser=new Qke(r),this._data=e}data(e){return this._data=e,this}toJSON(e){return e=e||this._data,this.parse(e)}parse(e){return this.readFromDocument(this._parser.toDocument(e))}readFromDocument(e){for(let r=e.firstChild;r;r=r.nextSibling)if(r.nodeType==ox.ELEMENT)return this.readFromNode(r);return null}readFromNode(e){return this.version=e.getAttribute("version"),lu({version:this.version},ARe,e,[])||null}}function yee(t){const[e,r]=te.useState(),[n,i]=te.useState(t.url),[a,s]=te.useState(""),[o,c]=te.useState(),[f,d]=te.useState(),m=()=>{r(void 0),c(void 0),s("")};return te.useEffect(()=>{if(m(),d(void 0),!n)return;let b,x=n;n.indexOf("?")!==-1&&(b=n.split("?"),x=b[0]);const E=new URLSearchParams(b?.[1]),T={...pc(E),...pc(t.urlParameters)},A=Object.fromEntries(Object.entries(T).map(([N,O])=>[N,String(O)])),M=new URLSearchParams(A),F=decodeURIComponent(M.toString())+"".replace(/%2F/g,"/").replace(/%3A/g,":");fetch(x+"?"+F).then(N=>{if(N.ok)return N.text();throw Error(N.statusText+" ("+N.status+" - "+N.type+")")}).then(N=>{c(new $Re(N,window.DOMParser).toJSON())}).catch(N=>{m(),console.log(N),d(N.message)})},[n,t.urlParameters]),te.useEffect(()=>{o?.Service&&(s(o.Capability?.Request?.GetMap?.DCPType?.[0]?.HTTP?.Get?.OnlineResource),r(o.Capability?.Request?.GetFeatureInfo?.DCPType?.[0]?.HTTP?.Get?.OnlineResource))},[o]),{capabilities:o,getFeatureInfoUrl:e,wmsUrl:a,error:f,setUrl:i}}yee.defaultProps={url:"",urlParameters:{SERVICE:"WMS",VERSION:"1.3.0",REQUEST:"GetCapabilities"}};const zq=Ji(J.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m1 15h-2v-6h2zm0-8h-2V7h2z"})),Cv={mapId:void 0,featureInfoEnabled:!0,featureInfoMarkerEnabled:!0,zoomToExtent:!1,showDeleteButton:!1,showLayerList:!0},gP={SERVICE:"WMS",VERSION:"1.3.0"},qRe={},HRe={TRANSPARENT:"TRUE"},mP={FEATURE_COUNT:"10",STYLES:"",WIDTH:"100",HEIGHT:"100",SRS:"EPSG:3857",CRS:"EPSG:3857",X:"50",Y:"50",I:"50",J:"50"},dM=t=>{const e=JSON.stringify(t.baseUrlParameters),r=te.useMemo(()=>({...gP,...t.baseUrlParameters}),[e]),n=JSON.stringify(t.getCapabilitiesUrlParameters),i=te.useMemo(()=>({...qRe,...t.getCapabilitiesUrlParameters}),[n]),a=JSON.stringify(t.getMapUrlParameters),s=te.useMemo(()=>({...HRe,...t.getMapUrlParameters}),[a]),o=JSON.stringify(t.getFeatureInfoUrlParameters),c=te.useMemo(()=>({...mP,...t.getFeatureInfoUrlParameters}),[o]),f=te.useRef(t.featureInfoSuccess);f.current=t.featureInfoSuccess;const{mapId:d=Cv.mapId,featureInfoEnabled:m=Cv.featureInfoEnabled,featureInfoMarkerEnabled:b=Cv.featureInfoMarkerEnabled,zoomToExtent:x=Cv.zoomToExtent,showDeleteButton:E=Cv.showDeleteButton,showLayerList:T=Cv.showLayerList}=t,A=te.useMemo(()=>({...r,...i,REQUEST:"GetCapabilities"}),[r,i]),{capabilities:M,error:F,setUrl:N,getFeatureInfoUrl:O,wmsUrl:U}=yee({urlParameters:A}),[j,H]=te.useState(t?.config?.open||!1),[W,X]=te.useState(t?.config?.visible||!0),[oe,Q]=te.useState(!1),G=va({mapId:d}),[ae,se]=te.useState(t?.config?.layers||[]),[fe,_e]=te.useState(!1),[Le,ye]=te.useState(),[Te,Ie]=te.useState(void 0);te.useEffect(()=>{t.config||N(t.url)},[t.url]);const Me=te.useMemo(()=>t?.config?.wmsUrl||U,[t?.config?.wmsUrl,U]),de=te.useMemo(()=>t?.config?.getFeatureInfoUrl||O,[t?.config?.getFeatureInfoUrl,O]),Se=te.useMemo(()=>M,[M]),we=te.useMemo(()=>t?.name||t?.config?.name||Se?.Service?.Title,[t?.name,t?.config?.name,Se?.Service?.Title]),De=te.useMemo(()=>t?.setLayers&&t?.config?.layers||ae,[t?.config?.layers,ae]),Fe=te.useMemo(()=>t?.setLayers||se,[t?.setLayers,se]);te.useEffect(()=>{t?.onConfigChange?.({layers:De,getFeatureInfoUrl:de,wmsUrl:Me,visible:W,open:j,name:we})},[De,Se,de,Me,W,j,we]);const Xe=te.useMemo(()=>De.filter(be=>be.visible&&be?.Attribution?.Title).map(be=>be?.Attribution?.Title).filter((be,Ot,at)=>at.indexOf(be)===Ot).join(" "),[De]),Be=function(){ye(void 0),Ie(void 0)},st=te.useCallback(be=>{if(!G.map)return;Be();let Ot=de,at;Ot?.indexOf?.("?")!==-1&&(at=t?.url?.split("?")||t?.config?.wmsUrl?.split("?"),Ot=at?.[0]);const $e=new URLSearchParams(at?.[1]),Xt={...pc(gP),...pc(mP),...pc($e,Ce=>Ce.toUpperCase()!=="REQUEST"),...pc(r),...pc(c)},$t=Xt.CRS||Xt.SRS||"EPSG:3857",cr=String($t).toUpperCase(),_t=G.map.unproject([be.point.x,be.point.y]),gr=Oc([_t.lng,_t.lat]),mr=Iwe(gr,50,{units:"meters"}),ar=mr&&mf(mr);let Cr;if(cr==="EPSG:4326"||cr==="CRS:84")Cr=ar?[...ar]:void 0;else if(cr!=="EPSG:3857"&&cr!=="EPSG:900913"&&console.warn(`CRS "${cr}" is not explicitly supported for GetFeatureInfo BBOX conversion; BBOX will be computed in Web Mercator (EPSG:3857), which may be inaccurate for this CRS.`),ar){const Ce=rj(Oc([ar[0],ar[1]])),xe=rj(Oc([ar[2],ar[3]]));Cr=[...Ce.geometry.coordinates,...xe.geometry.coordinates]}const Er={REQUEST:"GetFeatureInfo",BBOX:Cr?.join(","),INFO_FORMAT:Se?.Capability?.Request?.GetFeatureInfo.Format.indexOf("text/html")!==-1?"text/html":"text/plain",LAYERS:De.map(Ce=>Ce.visible&&Ce.queryable?Ce.Name:void 0).filter(Ce=>Ce),QUERY_LAYERS:De.map(Ce=>Ce.visible&&Ce.queryable?Ce.Name:void 0).filter(Ce=>Ce)},Jt={...pc(gP),...pc(mP),...pc($e,Ce=>Ce.toUpperCase()!=="REQUEST"),...pc(r),...Er,...pc(c)},ot=new URLSearchParams(Jt);fetch(Ot+"?"+ot.toString()).then(Ce=>{if(!Ce.ok)throw new Error("FeatureInfo could not be fetched");return Ce.text()}).then(Ce=>{ye(be.lngLat),Ie(Ce),f.current?.(Ce,be.lngLat)}).catch(Ce=>console.log(Ce))},[Se,de,t?.url,t?.config?.wmsUrl,G,De,r,c]),Qe=te.useMemo(()=>(typeof t?.featureInfoActive<"u"&&t.featureInfoActive||fe)&&De?.some(be=>be.visible&&be.queryable)&&!!G.map,[t?.featureInfoActive,fe,De,G.map]);te.useEffect(()=>{if(!Qe){Be();return}const be=st;return G.map.map.on("click",be),()=>{G.map?.map.off?.("click",be)}},[Qe,st,G.map]),te.useEffect(()=>{if(!Se?.Service)return;let be=[];if(Se?.Capability?.Layer?.CRS?.indexOf?.("EPSG:3857")===-1&&Se?.Capability?.Layer?.CRS?.indexOf?.("CRS:84")===-1)console.log("MlWmsLoader ("+Se.Service.Title+"): No WGS 84/Pseudo-Mercator support");else{console.log("MlWmsLoader ("+Se.Service.Title+"): WGS 84/Pseudo-Mercator supported");let Ot=Se?.Capability?.Layer?.Layer.filter(at=>!at.Layer?.length).map((at,$e)=>($e===0&&(be=at.EX_GeographicBoundingBox||at?.LatLonBoundingBox||[]),{visible:t.visibleLayersAtStart?t.visibleLayersAtStart.includes(at.Name||""):!0,Attribution:{Title:""},...(({CRS:$t,...cr})=>cr)(at)}));Se?.Capability?.Layer?.Layer.forEach(at=>{const $e=at?.Layer?.filter(Xt=>Xt.CRS?.length).map((Xt,$t)=>($t===0&&(be=Xt.EX_GeographicBoundingBox||Xt?.LatLonBoundingBox||[]),{visible:t.visibleLayersAtStart?t.visibleLayersAtStart.includes(Xt.Name||""):!0,Attribution:{Title:""},...(({CRS:_t,...gr})=>gr)(Xt)}));$e&&(Ot=[...Ot,...$e])}),Fe(Ot),x&&G?.map&&be.length>3&&G?.map.fitBounds([[be[0],be[1]],[be[2],be[3]]])}},[Se,G.map]);const it=J.jsxs(Gf,{secondaryAction:J.jsxs(J.Fragment,{children:[t.buttons,m&&J.jsx(Rc,{sx:{padding:"4px",marginTop:"-3px",marginRight:"4px",background:be=>De?.some(Ot=>Ot.visible&&Ot.queryable)?Qe?be.palette.info.light:be.palette.grey[300]:"initial"},"aria-label":"featureinfo",onClick:()=>{typeof t?.setFeatureInfoActive=="function"?t.setFeatureInfoActive(be=>!be):_e(be=>!be)},disabled:!De?.some(be=>be.visible&&be.queryable),children:J.jsx(zq,{})}),J.jsx(Rc,{edge:E?!1:"end",sx:{padding:"4px",marginTop:"-3px",...E?{marginRight:"4px"}:{}},"aria-label":"open",onClick:()=>H(be=>!be),children:j?J.jsx(DJ,{}):J.jsx(xE,{})}),E&&J.jsxs(J.Fragment,{children:[J.jsx(Rc,{"aria-label":"delete",edge:"end",onClick:()=>{typeof t.onConfigChange=="function"&&Q(!0)},sx:{padding:"4px",marginTop:"-3px"},children:J.jsx(Hx,{})}),oe&&J.jsx(e_,{open:oe,onConfirm:()=>{typeof t.onConfigChange=="function"&&t.onConfigChange(!1)},onCancel:()=>{Q(!1)},title:"Delete layer",text:"Are you sure you want to delete this layer?"})]})]}),sx:{paddingRight:0,paddingLeft:0,paddingTop:0,paddingBottom:"4px"},children:[J.jsx(Ub,{sx:{minWidth:"30px"},children:J.jsx($0,{sx:{padding:0},checked:W,onClick:()=>{X(be=>!be)}})}),J.jsx(Lf,{primary:we,variant:"layerlist"})]});return J.jsxs(J.Fragment,{children:[F&&J.jsx(dye,{children:J.jsx(Bo,{children:F})}),Me&&J.jsxs(J.Fragment,{children:[T&&J.jsxs(J.Fragment,{children:[t.sortable&&J.jsx(NE,{children:it}),!t.sortable&&it,J.jsx(Bo,{sx:{display:j?"block":"none"},children:J.jsx(Mh,{dense:!0,component:"div",disablePadding:!0,sx:{paddingLeft:"18px"},children:Me&&De?.map?.((be,Ot)=>be?.Name?J.jsxs(Gf,{secondaryAction:J.jsx(J.Fragment,{children:be?.queryable&&J.jsx(zq,{})}),children:[J.jsx(Ub,{sx:{minWidth:"30px"},children:J.jsx($0,{checked:be.visible,sx:{padding:0},onClick:()=>{const at=[...De];at[Ot].visible=!at[Ot].visible,Fe([...at])}})}),J.jsx(Lf,{primary:be?.Title,variant:"layerlist"})]},be.Name+Ot):J.jsx(J.Fragment,{}))})})]}),Me&&De?.length&&J.jsx(zE,{layerId:t.layerId||G.componentId,url:Me,attribution:Xe,visible:W,urlParameters:{...r,...s,layers:De?.filter?.(be=>be.visible).map(be=>be.Name).reverse().join(",")},insertBeforeLayer:t?.insertBeforeLayer},G.componentId),m&&b&&Le&&J.jsx(fM,{...Le,content:Te})]})]})};try{dM.displayName="MlWmsLoader",dM.__docgenInfo={description:`Loads a WMS getCapabilities xml document and adds a MlWmsLayer component for each layer that is
offered by the WMS.`,displayName:"MlWmsLoader",props:{url:{defaultValue:null,description:"WMS URL",name:"url",required:!1,type:{name:"string | undefined"}},mapId:{defaultValue:null,description:"Id of the target MapLibre instance in mapContext",name:"mapId",required:!1,type:{name:"string | undefined"}},layerId:{defaultValue:null,description:"",name:"layerId",required:!1,type:{name:"string | undefined"}},insertBeforeLayer:{defaultValue:null,description:"",name:"insertBeforeLayer",required:!1,type:{name:"string | undefined"}},baseUrlParameters:{defaultValue:null,description:"Base URL parameters that will be used for all WMS requests (GetCapabilities, GetMap, GetFeatureInfo)",name:"baseUrlParameters",required:!1,type:{name:"{ [key: string]: string; } | undefined"}},getCapabilitiesUrlParameters:{defaultValue:null,description:"URL parameters specific to GetCapabilities requests",name:"getCapabilitiesUrlParameters",required:!1,type:{name:"{ [key: string]: string; } | undefined"}},getMapUrlParameters:{defaultValue:null,description:"URL parameters specific to GetMap requests",name:"getMapUrlParameters",required:!1,type:{name:"{ [key: string]: string; } | undefined"}},getFeatureInfoUrlParameters:{defaultValue:null,description:"URL parameters specific to GetFeatureInfo requests",name:"getFeatureInfoUrlParameters",required:!1,type:{name:"{ [key: string]: string; } | undefined"}},zoomToExtent:{defaultValue:null,description:"If true, zooms to the extent of the WMS layer after loading the getCapabilities response",name:"zoomToExtent",required:!1,type:{name:"boolean | undefined"}},name:{defaultValue:null,description:"The name of the ListItem element representing the WmsLoader",name:"name",required:!1,type:{name:"string | undefined"}},featureInfoEnabled:{defaultValue:null,description:"If true, enables the feature info functionality",name:"featureInfoEnabled",required:!1,type:{name:"boolean | undefined"}},featureInfoActive:{defaultValue:null,description:"If true, the feature info functionality is active",name:"featureInfoActive",required:!1,type:{name:"boolean | undefined"}},setFeatureInfoActive:{defaultValue:null,description:"A function to set the feature info active state",name:"setFeatureInfoActive",required:!1,type:{name:"((val: boolean | ((current: boolean) => boolean)) => void) | undefined"}},featureInfoSuccess:{defaultValue:null,description:"Callback function that is called after the featureInfoRequest has succeeded",name:"featureInfoSuccess",required:!1,type:{name:"((content: string, lngLat: { lng: number; lat: number; }) => void) | undefined"}},featureInfoMarkerEnabled:{defaultValue:null,description:"If true, displays a marker at the feature info location",name:"featureInfoMarkerEnabled",required:!1,type:{name:"boolean | undefined"}},config:{defaultValue:null,description:"The WMS configuration object",name:"config",required:!1,type:{name:"WmsConfig | undefined"}},onConfigChange:{defaultValue:null,description:"A function to handle changes to the WMS configuration",name:"onConfigChange",required:!1,type:{name:"((config: false | WmsConfig) => void) | undefined"}},setLayers:{defaultValue:null,description:"A function to update a LayerType config array that is passed to this component at props.config.layers",name:"setLayers",required:!1,type:{name:"((layers: LayerType[]) => void) | undefined"}},showDeleteButton:{defaultValue:null,description:"If true, shows the delete button for the WMSLoader",name:"showDeleteButton",required:!1,type:{name:"boolean | undefined"}},buttons:{defaultValue:null,description:"Custom buttons to display for the WMSLoader",name:"buttons",required:!1,type:{name:"Element | undefined"}},sortable:{defaultValue:null,description:"",name:"sortable",required:!1,type:{name:"boolean | undefined"}},visibleLayersAtStart:{defaultValue:null,description:"Array of layer Names (IDs) that should be visible at start. If not provided, default visibility logic applies.",name:"visibleLayersAtStart",required:!1,type:{name:"string[] | undefined"}},showLayerList:{defaultValue:null,description:"If true, renders the layer list UI. If false, only the WMS layer is rendered without UI controls.",name:"showLayerList",required:!1,type:{name:"boolean | undefined"}}}}}catch{}function pM(t){const e={"circle-color":"rgba(0,0,0,0)"},r={"fill-color":"rgba(0,0,0,0)","fill-outline-color":"rgba(0,0,0,0)"},n={"line-color":"rgba(0,0,0,0)"},i=["interpolate",["linear"],["get",t.timeField],t.currentVal-t.fadeIn*t.step,0,t.currentVal,1,t.currentVal+t.fadeOut*t.step,0],a=["interpolate",["linear"],["get",t.timeField],t.currentVal,1,t.currentVal+t.fadeOut*t.step,0],s={"fill-color":t.featuresColor,"fill-opacity":i,"fill-outline-color":["interpolate",["linear"],["get",t.timeField],t.currentVal-t.fadeIn*t.step,"rgba(255, 0, 0, 0)",t.currentVal,"rgb(0,0,0)",t.currentVal+t.fadeIn*t.step,"rgba(255, 0, 0, 0)"]},o={"circle-color":t.featuresColor,"circle-radius":["interpolate",["linear"],["get",t.timeField],t.currentVal-t.fadeIn*t.step,1,t.currentVal,20,t.currentVal+t.fadeOut*t.step,1],"circle-opacity":i},c={"line-color":t.featuresColor,"line-width":3,"line-opacity":i},f={"circle-color":t.featuresColor,"circle-radius":["interpolate",["linear"],["get",t.timeField],t.currentVal,20,t.currentVal+t.fadeOut*t.step,1],"circle-opacity":a},d={"fill-color":t.featuresColor,"fill-opacity":a,"fill-outline-color":["interpolate",["linear"],["get",t.timeField],t.currentVal,"rgb(0,0,0)",t.currentVal+t.fadeIn*t.step,"rgba(255, 0, 0, 0)"]},m={"line-color":t.featuresColor,"line-width":3,"line-opacity":a};if(t.userPaint!==void 0)return t.userPaint;switch(t.type){case"circle":return t.currentVal===t.minVal&&!t.isPlaying?e:t.accumulate?f:o;case"fill":return t.currentVal===t.minVal&&!t.isPlaying?r:t.accumulate?d:s;case"line":return t.currentVal===t.minVal&&!t.isPlaying?n:t.accumulate?m:c;case void 0:return t.currentVal===t.minVal&&!t.isPlaying?e:t.accumulate?f:o}}try{pM.displayName="paintPicker",pM.__docgenInfo={description:"",displayName:"paintPicker",props:{type:{defaultValue:null,description:"",name:"type",required:!0,type:{name:"enum",value:[{value:"undefined"},{value:'"fill"'},{value:'"circle"'},{value:'"line"'}]}},timeField:{defaultValue:null,description:"",name:"timeField",required:!0,type:{name:"string"}},currentVal:{defaultValue:null,description:"",name:"currentVal",required:!0,type:{name:"number"}},minVal:{defaultValue:null,description:"",name:"minVal",required:!0,type:{name:"number"}},isPlaying:{defaultValue:null,description:"",name:"isPlaying",required:!0,type:{name:"boolean"}},fadeIn:{defaultValue:null,description:"",name:"fadeIn",required:!0,type:{name:"number"}},fadeOut:{defaultValue:null,description:"",name:"fadeOut",required:!0,type:{name:"number"}},step:{defaultValue:null,description:"",name:"step",required:!0,type:{name:"number"}},featuresColor:{defaultValue:null,description:"",name:"featuresColor",required:!0,type:{name:"string"}},accumulate:{defaultValue:null,description:"",name:"accumulate",required:!0,type:{name:"boolean"}},userPaint:{defaultValue:null,description:"",name:"userPaint",required:!0,type:{name:'{ "circle-radius"?: DataDrivenPropertyValueSpecification<number> | undefined; "circle-radius-transition"?: TransitionSpecification | undefined; ... 16 more ...; "circle-stroke-opacity-transition"?: TransitionSpecification | undefined; } | { ...; } | { ...; } | undefined'}}}}}catch{}function gM(t){const e=t.currentVal-t.fadeIn*t.step,r=t.currentVal+t.fadeIn*t.step,n={"text-color":"rgba(0,0,0,0)"},i={"text-color":t.labelColor,"text-opacity":["interpolate",["linear"],["get",t.timeField],e,0,t.currentVal,1,r,0]},a={"text-color":t.labelColor,"text-opacity":["interpolate",["linear"],["get",t.timeField],t.currentVal,1,r,0]},s=()=>t.currentVal===t.minVal&&!t.isPlaying?n:t.accumulate?a:i,o={"text-field":["get",t.labelField],"text-font":["Metropolis Regular"]};return J.jsx(LE,{options:{type:"symbol",layout:t.labelLayout||o,paint:t.labelPaint||s()},geojson:t.data,layerId:"timeControllerLabels"})}try{gM.displayName="MlTemporalControllerLabels",gM.__docgenInfo={description:"",displayName:"MlTemporalControllerLabels",props:{data:{defaultValue:null,description:"",name:"data",required:!0,type:{name:"FeatureCollection<Geometry, GeoJsonProperties>"}},currentVal:{defaultValue:null,description:"",name:"currentVal",required:!0,type:{name:"number"}},fadeIn:{defaultValue:null,description:"",name:"fadeIn",required:!0,type:{name:"number"}},fadeOut:{defaultValue:null,description:"",name:"fadeOut",required:!0,type:{name:"number"}},step:{defaultValue:null,description:"",name:"step",required:!0,type:{name:"number"}},labelField:{defaultValue:null,description:"",name:"labelField",required:!0,type:{name:"string"}},labelColor:{defaultValue:null,description:"",name:"labelColor",required:!0,type:{name:"string"}},timeField:{defaultValue:null,description:"",name:"timeField",required:!0,type:{name:"string"}},minVal:{defaultValue:null,description:"",name:"minVal",required:!0,type:{name:"number"}},accumulate:{defaultValue:null,description:"",name:"accumulate",required:!0,type:{name:"boolean"}},isPlaying:{defaultValue:null,description:"",name:"isPlaying",required:!0,type:{name:"boolean"}},labelLayout:{defaultValue:null,description:"",name:"labelLayout",required:!1,type:{name:"any"}},labelPaint:{defaultValue:null,description:"",name:"labelPaint",required:!1,type:{name:"SymbolLayerSpecification | undefined"}}}}}catch{}const GRe=Ji(J.jsx("path",{d:"M8 5v14l11-7z"})),WRe=Ji(J.jsx("path",{d:"M6 19h4V5H6zm8-14v14h4V5z"})),XRe=Ji(J.jsx("path",{d:"M6 6h12v12H6z"})),YRe=Ji(J.jsx("path",{d:"m4 18 8.5-6L4 6zm9-12v12l8.5-6z"})),ZRe=Ji(J.jsx("path",{d:"M11 18V6l-8.5 6zm.5-6 8.5 6V6z"})),KRe={marginLeft:"15%",marginBottom:"3%",width:"70%",height:"90px",alignItems:"center"},JRe={top:"10%",height:"100px",alignItems:"center"};function mM(t){const[e,r]=te.useState(t.currentVal),[n,i]=te.useState(t.isPlaying),a=t.maxVal-t.minVal,s=te.useRef(null),o=Nx(E=>E.breakpoints.down("md"));te.useEffect(()=>()=>{s.current&&clearInterval(s.current)},[]),te.useEffect(()=>{t.returnCurrent(e),t.returnPlaying(n)},[e,n]);const c=gt.useCallback(()=>{let E=e-t.minVal;s.current&&clearInterval(s.current),s.current=setInterval(function(){E>=a?(s.current&&clearInterval(s.current),i(!1)):r(T=>T+t.step),E=E+t.step},t.interval)},[t.step,t.maxVal,e]),f=()=>{n?(i(!1),n&&s.current&&clearInterval(s.current)):(i(!0),c())},d=()=>{s.current&&clearInterval(s.current),r(t.minVal),i(!1)},m=()=>{n?(s.current&&clearInterval(s.current),r(e-a/10),c()):r(e-a/10)},b=()=>{n?(s.current&&clearInterval(s.current),r(e+a/10),c()):r(e+a/10)},x=(E,T)=>{n?E&&(s.current&&clearInterval(s.current),r(T),c()):r(T)};return J.jsx(J.Fragment,{children:J.jsxs(fO,{anchor:"bottom",open:t.open||!0,variant:"persistent",sx:{flexShrink:0,"& .MuiDrawer-paper":o?JRe:KRe},children:[J.jsxs(hp,{container:!0,alignItems:"center",justifyContent:"space-between",children:[J.jsxs(hp,{item:!0,xs:12,sm:10,textAlign:"center",children:[J.jsx(ta,{onClick:m,children:J.jsx(ZRe,{})}),J.jsx(ta,{onClick:d,children:J.jsx(XRe,{})}),J.jsx(ta,{onClick:f,children:n?J.jsx(WRe,{}):J.jsx(GRe,{})}),J.jsx(ta,{onClick:b,children:J.jsx(YRe,{})})]}),t.display&&!o&&J.jsx(hp,{item:!0,xs:12,sm:5,textAlign:"right",children:J.jsx(Ss,{variant:"h5",sx:{paddingRight:"25px"},children:Math.floor(e)})})]}),J.jsx(mO,{sx:{position:"flex",width:"95%",paddingTop:"10px",alignSelf:"center"},"aria-label":"Custom marks",defaultValue:t.minVal,value:e,step:t.step,onChange:x,min:t.minVal,max:t.maxVal}),o&&t.display&&J.jsx(Ss,{variant:"body1",textAlign:"right",children:Math.floor(e)})]})})}try{mM.displayName="TemporalControllerPlayer",mM.__docgenInfo={description:"",displayName:"TemporalControllerPlayer",props:{currentVal:{defaultValue:null,description:"",name:"currentVal",required:!0,type:{name:"number"}},isPlaying:{defaultValue:null,description:"",name:"isPlaying",required:!0,type:{name:"boolean"}},step:{defaultValue:null,description:"",name:"step",required:!0,type:{name:"number"}},interval:{defaultValue:null,description:"",name:"interval",required:!0,type:{name:"number"}},minVal:{defaultValue:null,description:"",name:"minVal",required:!0,type:{name:"number"}},maxVal:{defaultValue:null,description:"",name:"maxVal",required:!0,type:{name:"number"}},returnCurrent:{defaultValue:null,description:"",name:"returnCurrent",required:!0,type:{name:"Dispatch<SetStateAction<number>>"}},returnPlaying:{defaultValue:null,description:"",name:"returnPlaying",required:!0,type:{name:"Dispatch<SetStateAction<boolean>>"}},fadeIn:{defaultValue:null,description:"",name:"fadeIn",required:!0,type:{name:"number"}},open:{defaultValue:null,description:"",name:"open",required:!0,type:{name:"boolean"}},fadeOut:{defaultValue:null,description:"",name:"fadeOut",required:!0,type:{name:"number"}},featuresColor:{defaultValue:null,description:"",name:"featuresColor",required:!0,type:{name:"string"}},labels:{defaultValue:null,description:"",name:"labels",required:!0,type:{name:"boolean"}},labelColor:{defaultValue:null,description:"",name:"labelColor",required:!0,type:{name:"string"}},labelFadeIn:{defaultValue:null,description:"",name:"labelFadeIn",required:!0,type:{name:"number"}},labelFadeOut:{defaultValue:null,description:"",name:"labelFadeOut",required:!0,type:{name:"number"}},accumulate:{defaultValue:null,description:"",name:"accumulate",required:!0,type:{name:"boolean"}},display:{defaultValue:null,description:"",name:"display",required:!0,type:{name:"boolean"}}}}}catch{}function QRe(t,e){if(t?.features){const r=[...t.features?t.features:[]];return r.sort((n,i)=>n.properties?.[e]<i.properties?.[e]?1:-1),r[r.length-1]?.properties?.[e]||0}return 0}function eMe(t,e){if(t?.features){const r=[...t?.features?t.features:[]];return r.sort((n,i)=>n.properties?.[e]<i.properties?.[e]?-1:1),r[r.length-1]?.properties?.[e]||0}return 0}function yM(t){const e=va({mapId:t.mapId}),r=te.useMemo(()=>t.minVal?t.minVal:QRe(t.geojson,t.timeField),[t.minVal,t.geojson,t.timeField]),n=te.useMemo(()=>t.maxVal?t.maxVal:eMe(t.geojson,t.timeField),[t.maxVal,t.geojson,t.timeField]);return{filteredData:te.useMemo(()=>{if(t.geojson!==void 0&&e.map&&r&&n)return Ep(t.geojson.features.filter(a=>a.properties?.[t.timeField]>=r&&a.properties?.[t.timeField]<=n))},[t.geojson,e.map,t.timeField]),minVal:r,maxVal:n}}try{yM.displayName="useFilterData",yM.__docgenInfo={description:"",displayName:"useFilterData",props:{geojson:{defaultValue:null,description:"",name:"geojson",required:!0,type:{name:"FeatureCollection<Geometry, GeoJsonProperties>"}},timeField:{defaultValue:null,description:"",name:"timeField",required:!0,type:{name:"string"}},initialVal:{defaultValue:null,description:"",name:"initialVal",required:!1,type:{name:"number | undefined"}},minVal:{defaultValue:null,description:"",name:"minVal",required:!1,type:{name:"number | undefined"}},maxVal:{defaultValue:null,description:"",name:"maxVal",required:!1,type:{name:"number | undefined"}},mapId:{defaultValue:null,description:"",name:"mapId",required:!0,type:{name:"string | undefined"}}}}}catch{}const jq=({mapId:t=void 0,insertBeforeLayer:e,geojson:r,ownLayer:n=!0,attribution:i="",type:a="circle",timeField:s,minVal:o,maxVal:c,initialVal:f,accumulate:d=!1,fitBounds:m=!0,paint:b,featuresColor:x,step:E=1,interval:T=200,fadeIn:A=5,fadeOut:M=5,label:F=!0,labelColor:N,labelField:O=[],labelFadeIn:U=5,labelFadeOut:j=5,displayCurrentValue:H=!1,onClick:W,onHover:X,onLeave:oe,onStateChange:Q})=>{const G=va({mapId:t,waitForLayer:e}),{filteredData:ae,minVal:se,maxVal:fe}=yM({geojson:r,timeField:s,minVal:o,maxVal:c,mapId:t}),_e=Bc(),[Le,ye]=te.useState(f||se),Te=x||_e.palette.primary.main,Ie=N||_e.palette.text.primary,[Me,de]=te.useState(!1),Se=pM({type:a,timeField:s,currentVal:Le,minVal:se,isPlaying:Me,fadeIn:A,fadeOut:M,step:E,featuresColor:Te,accumulate:d,userPaint:b});return te.useEffect(()=>{!f&&se?ye(se):f&&ye(f)},[]),te.useEffect(()=>{typeof Q=="function"&&Q({current:Le,paint:Se})},[Q]),te.useEffect(()=>{if(m&&typeof ae<"u"){const we=mf(ae);G.map?.map.fitBounds(we)}},[ae]),te.useEffect(()=>{if(!G.map)return;let we,De,Fe;return W&&(we=W,G.map?.on("click","timeController",we)),X&&(De=X,G.map?.on("mouseenter","timeController",De)),oe&&(Fe=oe,G.map?.on("mouseleave","timeController",Fe)),()=>{we&&G.map?.off("click","timeController",we),De&&G.map?.off("mouseenter","timeController",De),Fe&&G.map?.off("mouseleave","timeController",Fe)}},[G.map,W,X,oe]),J.jsxs(J.Fragment,{children:[ae&&n&&J.jsx(Nc,{type:a,mapId:t,options:{source:{type:"geojson",attribution:i,data:ae},paint:{...b||Se},layout:{visibility:"visible"}}}),ae&&F&&J.jsx(gM,{data:ae,currentVal:Le,fadeIn:U,fadeOut:j,step:E,labelField:O,labelColor:Ie,timeField:s,minVal:se,accumulate:d,isPlaying:Me}),J.jsx(mM,{currentVal:Le,isPlaying:Me,step:E,interval:T,minVal:se,maxVal:fe,returnCurrent:ye,returnPlaying:de,open:!1,fadeIn:A,fadeOut:M,featuresColor:Te,labels:F,labelColor:Ie,labelFadeIn:U,labelFadeOut:j,accumulate:d,display:H})]})};try{jq.displayName="MlTemporalController",jq.__docgenInfo={description:"",displayName:"MlTemporalController",props:{mapId:{defaultValue:{value:"undefined"},description:"Id of the target MapLibre instance in mapContext",name:"mapId",required:!1,type:{name:"string | undefined"}},insertBeforeLayer:{defaultValue:null,description:`Id of an existing layer in the mapLibre instance to help specify the layer order.
This layer will be visually beneath the layer with the "insertBeforeLayer" id.`,name:"insertBeforeLayer",required:!1,type:{name:"string | undefined"}},geojson:{defaultValue:null,description:"GeoJSON data that is supposed to be rendered by this component.",name:"geojson",required:!0,type:{name:"FeatureCollection<Geometry, GeoJsonProperties>"}},ownLayer:{defaultValue:{value:"true"},description:"If true,the component creates and loads a MlGeoJsonLayer to show the data.",name:"ownLayer",required:!1,type:{name:"boolean | undefined"}},attribution:{defaultValue:{value:""},description:"MapLibre attribution shown in the bottom right of the map, if this layer is visible",name:"attribution",required:!1,type:{name:"string | undefined"}},type:{defaultValue:{value:"circle"},description:`Type of the layer that will be added to the MapLibre instance.
Possible values: "line", "circle", "fill"`,name:"type",required:!1,type:{name:"enum",value:[{value:"undefined"},{value:'"fill"'},{value:'"circle"'},{value:'"line"'}]}},timeField:{defaultValue:null,description:"Property field where the time informations is available.",name:"timeField",required:!0,type:{name:"string"}},minVal:{defaultValue:null,description:`Lowest time value to be shown in the time line.
By default, it is set to the lowest value in the time field.`,name:"minVal",required:!1,type:{name:"number | undefined"}},label:{defaultValue:{value:"true"},description:'When true, a label layer will be added by the component. In that case, the "labelField" propertie is mandatory.',name:"label",required:!1,type:{name:"boolean | undefined"}},labelField:{defaultValue:{value:"[]"},description:"Property field where the label information is available.",name:"labelField",required:!1,type:{name:"string | undefined"}},maxVal:{defaultValue:null,description:`Highest time value to be shown in the time line.
By default, it is set to the highest value in the time field.`,name:"maxVal",required:!1,type:{name:"number | undefined"}},initialVal:{defaultValue:null,description:`the value at which the component is to be loaded.
If not specified, the component starts at the minimum value.`,name:"initialVal",required:!1,type:{name:"number | undefined"}},accumulate:{defaultValue:{value:"false"},description:`When true, the features will be accumulated in the map.
This option ist by default false.`,name:"accumulate",required:!1,type:{name:"boolean | undefined"}},fitBounds:{defaultValue:{value:"true"},description:`When true, the component will fit the map bounds to the shown features.
This option ist by default true.`,name:"fitBounds",required:!1,type:{name:"boolean | undefined"}},showControls:{defaultValue:null,description:"Boolean value that disables and enables the controls drawer.",name:"showControls",required:!1,type:{name:"boolean | undefined"}},paint:{defaultValue:null,description:`Paint property object for the features layer.
Possible props depend on the layer type.
https://maplibre.org/maplibre-gl-js-docs/style-spec/layers/#line
https://maplibre.org/maplibre-gl-js-docs/style-spec/layers/#circle
https://maplibre.org/maplibre-gl-js-docs/style-spec/layers/#fill`,name:"paint",required:!1,type:{name:'{ "circle-radius"?: DataDrivenPropertyValueSpecification<number> | undefined; "circle-radius-transition"?: TransitionSpecification | undefined; ... 16 more ...; "circle-stroke-opacity-transition"?: TransitionSpecification | undefined; } | { ...; } | { ...; } | undefined'}},featuresColor:{defaultValue:null,description:"Sets the color of the features rendered by this component.",name:"featuresColor",required:!1,type:{name:"string | undefined"}},step:{defaultValue:{value:"1"},description:`How many units the timeline runs through at each step.
By default it is set to 1.`,name:"step",required:!1,type:{name:"number | undefined"}},interval:{defaultValue:{value:"200"},description:`The time between each addition to the counter, expressed in milliseconds.
By default, 200 ms.`,name:"interval",required:!1,type:{name:"number | undefined"}},fadeIn:{defaultValue:{value:"5"},description:`A numeric value that sets how many steps before the feature starts to appear.
By default it is set to 5 steps.`,name:"fadeIn",required:!1,type:{name:"number | undefined"}},fadeOut:{defaultValue:{value:"5"},description:`A numeric value that sets how many steps the feature fades out after it proper time value.
By default it is set to 5 steps.`,name:"fadeOut",required:!1,type:{name:"number | undefined"}},labelColor:{defaultValue:null,description:"Sets the color of the features rendered by this component.",name:"labelColor",required:!1,type:{name:"string | undefined"}},labelLayout:{defaultValue:null,description:`Layout property object, that is passed to the labels layer.
https://maplibre.org/maplibre-gl-js-docs/style-spec/layers/#symbol`,name:"labelLayout",required:!1,type:{name:"any"}},labelPaint:{defaultValue:null,description:`Paint property object for the features layer.
https://maplibre.org/maplibre-gl-js-docs/style-spec/layers/#symbol`,name:"labelPaint",required:!1,type:{name:"any"}},labelFadeIn:{defaultValue:{value:"5"},description:`A numeric value that sets how many steps before the labels start to appear.
By default it is set to 5 steps.`,name:"labelFadeIn",required:!1,type:{name:"number | undefined"}},labelFadeOut:{defaultValue:{value:"5"},description:`A numeric value that sets how many steps the labels fade out after their proper time value.
By default it is set to 5 steps.`,name:"labelFadeOut",required:!1,type:{name:"number | undefined"}},displayCurrentValue:{defaultValue:{value:"false"},description:"If true, the current time value will be displayed in the controlls panel.",name:"displayCurrentValue",required:!1,type:{name:"boolean | undefined"}},onClick:{defaultValue:null,description:"Click event handler that is executed whenever a geometry rendered by this component is clicked.",name:"onClick",required:!1,type:{name:"((ev: MapEventType) => void | Map$1) | undefined"}},onHover:{defaultValue:null,description:"Click event handler that is executed whenever a geometry rendered by this component is hovered.",name:"onHover",required:!1,type:{name:"((ev: MapEventType) => void | Map$1) | undefined"}},onLeave:{defaultValue:null,description:`Leave event handler that is executed whenever a geometry rendered by this component is
left/unhovered.`,name:"onLeave",required:!1,type:{name:"((ev: MapEventType) => void | Map$1) | undefined"}},onStateChange:{defaultValue:null,description:"Callback function defined by the user to recive the current time value and paint property in the parent component.",name:"onStateChange",required:!1,type:{name:"Dispatch<SetStateAction<TemporalControllerValues | undefined>> | undefined"}}}}}catch{}const UE=t=>{const e=t?.layerIds.toReversed();return J.jsx(J.Fragment,{children:e&&e.map((r,n)=>{const i=n>0?e[n-1]:t.insertBeforeLayer;return J.jsx(LE,{layerId:r,insertBeforeLayer:i},r)})})};try{UE.displayName="MlOrderLayers",UE.__docgenInfo={description:"Creates an invisible layer for each entry in props.layerIds with the id `order-{entry}` and a reliable order",displayName:"MlOrderLayers",props:{mapId:{defaultValue:null,description:"Id of the target MapLibre instance in mapContext",name:"mapId",required:!1,type:{name:"string | undefined"}},layerIds:{defaultValue:null,description:"",name:"layerIds",required:!0,type:{name:"string[]"}},insertBeforeLayer:{defaultValue:null,description:"",name:"insertBeforeLayer",required:!1,type:{name:"string | undefined"}}}}}catch{}const Uq=t=>{const e=va({mapId:"map_1"});return te.useEffect(()=>{if(e.map)return e.map.map.getSource("terrain")||e.map.map.addSource("terrain",{type:"raster-dem",encoding:"mapbox",maxzoom:12,minzoom:4,...t.sourceOptions}),e.map.map.setTerrain({source:"terrain",exaggeration:1,...t.terrainOptions}),e.map.addLayer({id:"hills",type:"hillshade",source:"terrain",layout:{visibility:"visible"},paint:{"hillshade-shadow-color":"rgba(71,59,36,0.4)"}}),()=>{e.map?.map.setTerrain(null),e.map?.map.getSource("terrain")&&(e.map.map.removeLayer("hills"),e.map.map.removeSource("terrain"))}},[e.map,t.sourceOptions,t.terrainOptions]),J.jsx(J.Fragment,{})};try{Uq.displayName="MlTerrainLayer",Uq.__docgenInfo={description:"Create Terrain Layer Component",displayName:"MlTerrainLayer",props:{mapId:{defaultValue:null,description:"Id of the target MapLibre instance in mapContext",name:"mapId",required:!1,type:{name:"string | undefined"}},sourceOptions:{defaultValue:null,description:"Source of tiles with possibles options",name:"sourceOptions",required:!1,type:{name:"object | undefined"}},terrainOptions:{defaultValue:null,description:"Options for new exaggeration value",name:"terrainOptions",required:!1,type:{name:"TerrainSpecification | undefined"}}}}}catch{}const tMe=Ji(J.jsx("path",{d:"M3 17.25V21h3.75L17.81 9.94l-3.75-3.75zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34a.996.996 0 0 0-1.41 0l-1.83 1.83 3.75 3.75z"})),rMe=Ji([J.jsx("circle",{cx:"7",cy:"14",r:"3"},"0"),J.jsx("circle",{cx:"11",cy:"6",r:"3"},"1"),J.jsx("circle",{cx:"16.6",cy:"17.6",r:"3"},"2")]),nMe=[{name:"Point",mode:"draw_point",icon:J.jsx(rMe,{})},{name:"LineString",mode:"draw_line_string",icon:J.jsx(RJ,{})},{name:"Polygon",mode:"draw_polygon",icon:J.jsx(MJ,{})}],Vq=t=>{const e=va({mapId:t.mapId,waitForLayer:t.insertBeforeLayer}),[r,n]=te.useState(),[i,a]=te.useState({activeGeometryIndex:void 0,selectedGeoJson:void 0,geometries:[],drawMode:void 0});console.log(i),te.useEffect(()=>{typeof t.onChange=="function"&&t.onChange(i)},[i,t.onChange]);const s={...t.buttonStyleOverride},o=m=>{let b;a(x=>(b=x.drawMode,{...x,drawMode:void 0,activeGeometryIndex:void 0,selectedGeoJson:void 0})),requestAnimationFrame(()=>{a(x=>(b==="draw_polygon"||b==="draw_line_string")&&m==="draw_point"?{...x,drawMode:void 0}:{...x,drawMode:m})})},c=m=>{a(b=>{const x=[...b.geometries];return x.splice(x.indexOf(m),1),{...b,drawMode:void 0,geometries:x,activeGeometryIndex:b.activeGeometryIndex?b.activeGeometryIndex-1:void 0}})},f=m=>{t.onShowInstructionChange?.(m.target.checked)},d=()=>J.jsx(J.Fragment,{children:nMe.map(m=>{const b=E=>i.drawMode===m.mode?E.palette.primary.main:E.palette.navigation.navColor,x=E=>i.drawMode!==m.mode?E.palette.primary.main:E.palette.navigation.navColor;return J.jsx(J.Fragment,{children:J.jsx(hg,{title:m.name,children:J.jsx(ta,{sx:{color:x,backgroundColor:b,"&:hover":{backgroundColor:b},...s},onClick:()=>o(m.mode),children:m.icon},m.name)})})})});return J.jsxs(J.Fragment,{children:[J.jsx(Ov,{sx:{zIndex:104},children:J.jsx(Vk,{children:J.jsx(d,{})})}),J.jsx(Ov,{sx:{marginTop:"10px"},children:J.jsx(pY,{children:J.jsx(qk,{control:J.jsx($0,{size:"small",checked:t.showInstruction,onChange:f}),label:"Show instructions"})})}),i.drawMode&&J.jsx(_E,{mode:i.drawMode,geojson:i.selectedGeoJson,onChange:m=>{console.log("Features: ",m),m?.[0]&&a(b=>{const x=[...i.geometries];if(typeof b.activeGeometryIndex>"u"){const T=m[0];T&&T.properties?T.properties.id=T.id:console.error("tempFeature or tempFeature.properties is null or undefined"),b.activeGeometryIndex=x.length,x.push(T)}else x[b.activeGeometryIndex]=m[0];return(()=>{if(b.selectedGeoJson&&typeof b.activeGeometryIndex<"u"&&b.geometries[b.activeGeometryIndex]&&b.geometries[b.activeGeometryIndex].geometry.type==="Point"){const T=b.selectedGeoJson?.geometry?.coordinates,A=b.geometries[b.activeGeometryIndex]?.geometry?.coordinates;return JSON.stringify(T)!==JSON.stringify(A)}return!1})()&&(b.drawMode=void 0),{...b,geometries:x}})},onFinish:()=>{a(m=>({...m,drawMode:void 0,activeGeometryIndex:void 0,selectedGeoJson:void 0}))}}),J.jsxs(Mh,{sx:{zIndex:105,marginBottom:"-10px"},children:[i.geometries.map((m,b)=>J.jsxs(Ov,{sx:{display:"flex",flexDirection:"column"},children:[J.jsx("br",{}),J.jsxs(Ov,{flexDirection:"row",sx:{"&:hover":{backgroundColor:"rgb(177, 177, 177, 0.2)"},marginTop:"25px"},onMouseOver:()=>{n(m)},onMouseLeave:()=>{n(void 0)},children:[!m.properties?.customName&&J.jsx("input",{type:"text",value:m.properties?.name||"",placeholder:"Assign name",onChange:x=>{const E=x.target.value;a(T=>{const A=[...T.geometries];return A[b].properties||(A[b].properties={}),A[b].properties&&(A[b].properties.name=E),{...T,geometries:A}})},style:{padding:"5px",border:"1px solid #ccc",borderRadius:"4px",outline:"none"},onFocus:x=>x.target.style.borderColor="#009ee0",onBlur:x=>{x.target.style.borderColor="#ccc",a(E=>{const T=[...E.geometries];return T[b].properties||(T[b].properties={}),T[b].properties&&(T[b].properties.customName=!0),{...E,geometries:T}})}}),J.jsx(dp,{listItemSx:s,configurable:!0,visible:!0,layerComponent:J.jsx(Nc,{mapId:t.mapId,geojson:m,layerId:String(m.id),defaultPaintOverrides:{fill:{"fill-opacity":.5}}}),type:"layer",name:J.jsx(Ss,{onClick:()=>{a(x=>{const E=[...x.geometries];return E[b].properties||(E[b].properties={}),E[b].properties&&(E[b].properties.customName=!1),{...x,geometries:E}})},sx:{cursor:"pointer",overflow:"hidden",whiteSpace:"nowrap"},children:m.properties?.name||String(m.id)}),description:m.geometry.type}),J.jsx(Ov,{sx:{padding:"3px 30px"},children:J.jsxs(Vk,{size:"small",children:[J.jsx(hg,{title:"Center",children:J.jsx(ta,{sx:{color:x=>x.palette.primary.main,backgroundColor:x=>x.palette.navigation.navColor,...s},onClick:()=>{e?.map?.map.setCenter(m.geometry.type==="Point"?m.geometry.coordinates:uN(m).geometry.coordinates)},children:J.jsx(hN,{})})}),J.jsx(hg,{title:"Edit",children:J.jsx(ta,{sx:{color:x=>i.drawMode==="simple_select"&&i.selectedGeoJson?.id===m.id?x.palette.navigation.navColor:x.palette.primary.main,backgroundColor:x=>i.drawMode==="simple_select"&&i.selectedGeoJson?.id===m.id?x.palette.primary.main:x.palette.navigation.navColor,...s},onClick:()=>{a(x=>{const E=x.drawMode==="simple_select"&&x.selectedGeoJson?.id===m.id?void 0:"simple_select";return{...x,selectedGeoJson:m,activeGeometryIndex:x.geometries.indexOf(m),drawMode:E}})},children:J.jsx(tMe,{})})}),J.jsx(hg,{title:"Delete",children:J.jsx(ta,{sx:{color:x=>x.palette.primary.main,backgroundColor:x=>x.palette.navigation.navColor,...s},onClick:()=>{c(m),n(void 0)},children:J.jsx(Hx,{})})})]})})]})]},m.id)),r&&J.jsx(Nc,{mapId:t.mapId,geojson:{type:"FeatureCollection",features:[r]},layerId:"highlightBorder",defaultPaintOverrides:{circle:{"circle-color":"#000000","circle-opacity":.2,"circle-radius":10},line:{"line-color":"#000000","line-opacity":.2,"line-width":10},fill:{"fill-color":"#000000","fill-opacity":.2}}})]})]})};try{Vq.displayName="MlSketchTool",Vq.__docgenInfo={description:"Component template",displayName:"MlSketchTool",props:{mapId:{defaultValue:null,description:"Id of the target MapLibre instance in mapContext",name:"mapId",required:!1,type:{name:"string | undefined"}},insertBeforeLayer:{defaultValue:null,description:`Id of an existing layer in the mapLibre instance to help specify the layer order
This layer will be visually beneath the layer with the "insertBeforeLayer" id.`,name:"insertBeforeLayer",required:!1,type:{name:"string | undefined"}},buttonStyleOverride:{defaultValue:null,description:`Style attribute for the button-style
https://mui.com/system/getting-started/the-sx-prop/`,name:"buttonStyleOverride",required:!1,type:{name:"SxProps | undefined"}},onChange:{defaultValue:null,description:"Callback function that is called each time GeoJson data has changed within MlSketchTool.\nFirst parameter contains all geometries in the `geometries` prop.",name:"onChange",required:!1,type:{name:"((para: SketchStateType) => void) | undefined"}},showInstruction:{defaultValue:null,description:"Determines whether the instruction text should be shown.",name:"showInstruction",required:!1,type:{name:"boolean | undefined"}},onShowInstructionChange:{defaultValue:null,description:'Callback function triggered when the "Show instructions" checkbox is toggled.',name:"onShowInstructionChange",required:!1,type:{name:"((value: boolean) => void) | undefined"}}}}}catch{}const vM=t=>{const e=te.useRef(!1),r=te.useRef(t.pause),n=te.useRef(t.zoom),i=te.useRef(t.pitch),a=te.useRef(1),s=te.useRef(t.speed),o=te.useRef(null),c=t.kmPerStep||.01,f=Qb(t.route),d=t.stepDuration||70,m=va({mapId:t.mapId,waitForLayer:t.insertBeforeLayer});te.useEffect(()=>{r.current=t.pause,r.current||T()},[t.pause]),te.useEffect(()=>{m.map&&(n.current=t.zoom,typeof n.current<"u"&&m.map.map.getZoom()!==n.current&&m.map.map.setZoom(n.current))},[m.map,t.zoom]),te.useEffect(()=>{m.map&&(i.current=t.pitch,typeof i.current<"u"&&i.current!==m.map.map.getPitch()&&m.map.map.setPitch(i.current))},[m.map,t.pitch]),te.useEffect(()=>{s.current=t.speed},[t.speed]);const b=te.useCallback(()=>{m.map&&(m.map.map.scrollZoom.disable(),m.map.map.boxZoom.disable(),m.map.map.dragRotate.disable(),m.map.map.dragPan.disable(),m.map.map.keyboard.disable(),m.map.map.doubleClickZoom.disable(),m.map.map.touchZoomRotate.disable())},[m.map]),x=te.useCallback(()=>{m.map&&(m.map.map.scrollZoom.enable(),m.map.map.boxZoom.enable(),m.map.map.dragRotate.enable(),m.map.map.dragPan.enable(),m.map.map.keyboard.enable(),m.map.map.doubleClickZoom.enable(),m.map.map.touchZoomRotate.enable())},[m.map]);function E(){if(!m.map||!t.route)return;const M=mf(t.route);let F;M&&M.length>3&&(F=[[M[0],M[1]],[M[2],M[3]]],m.map.map.fitBounds(F,{padding:100}))}function T(){if(m.map)if(r.current)x();else{b(),typeof n.current<"u"&&m.map.map.getZoom()!==n.current&&m.map.map.setZoom(n.current);const M=S2e(t.route,a.current*c).geometry.coordinates;a.current*c<f?(m.map.map.easeTo({center:M,bearing:Zb(Oc([m.map.map.getCenter().lng,m.map.map.getCenter().lat]),Oc(M)),duration:d,essential:!0}),typeof s.current<"u"?a.current=a.current+s.current:a.current++,console.log("PAN MOVE"),setTimeout(()=>{T()},100)):(m.map.map.setPitch(0),E(),x(),console.log("ENABLE CONTROLS"),a.current=1)}}function A(){m.map&&(E(),x(),a.current=1)}return te.useEffect(()=>{!m.map||e.current||(e.current=!0,E())},[m.map]),te.useEffect(()=>()=>{o.current&&clearTimeout(o.current)},[]),{play:T,reset:A}};vM.defaultProps={mapId:void 0,zoom:18};try{vM.displayName="useCameraFollowPath",vM.__docgenInfo={description:"Component template",displayName:"useCameraFollowPath",props:{mapId:{defaultValue:{value:"undefined"},description:"Id of the target MapLibre instance in mapContext",name:"mapId",required:!1,type:{name:"string | undefined"}},insertBeforeLayer:{defaultValue:null,description:`Id of an existing layer in the mapLibre instance to help specify the layer order
This layer will be visually beneath the layer with the "insertBeforeLayer" id.`,name:"insertBeforeLayer",required:!1,type:{name:"string | undefined"}},pause:{defaultValue:null,description:"",name:"pause",required:!1,type:{name:"boolean | undefined"}},zoom:{defaultValue:{value:"18"},description:"",name:"zoom",required:!1,type:{name:"number | undefined"}},pitch:{defaultValue:null,description:"",name:"pitch",required:!1,type:{name:"number | undefined"}},speed:{defaultValue:null,description:"",name:"speed",required:!1,type:{name:"number | undefined"}},kmPerStep:{defaultValue:null,description:"",name:"kmPerStep",required:!1,type:{name:"number | undefined"}},route:{defaultValue:null,description:"",name:"route",required:!1,type:{name:"any"}},stepDuration:{defaultValue:null,description:"",name:"stepDuration",required:!1,type:{name:"number | undefined"}},timeoutId:{defaultValue:null,description:"",name:"timeoutId",required:!1,type:{name:"number | undefined"}}}}}catch{}const iMe=()=>te.useContext(XD),VE=t=>(te.useEffect(()=>{if(!(!t.protocol||typeof t.handler!="function"))return vk.addProtocol(t.protocol,t.handler),()=>{vk.removeProtocol(t.protocol)}},[t]),{});VE.defaultProps={mapId:void 0};try{VE.displayName="useAddProtocol",VE.__docgenInfo={description:"Enables the use of custom protocols (basically custom tile load functions) in the maplibre-gl-js library.",displayName:"useAddProtocol",props:{protocol:{defaultValue:null,description:"the protocol string, for example `mbtiles`\nIn this example the handler function is called for all tile requests that start with the string `mbtiles://`",name:"protocol",required:!0,type:{name:"string"}},handler:{defaultValue:null,description:"Custom load tile function that will be called when using a source that starts with a custom url schema.",name:"handler",required:!0,type:{name:"AddProtocolAction"}}}}}catch{}function vee(t){return new Function("d","return {"+t.map(function(e,r){return JSON.stringify(e)+": d["+r+"]"}).join(",")+"}")}function aMe(t,e){var r=vee(t);return function(n,i){return e(r(n),i,t)}}function oMe(t){var e=Object.create(null),r=[];return t.forEach(function(n){for(var i in n)i in e||r.push(e[i]=i)}),r}function hL(t){var e=new RegExp('["'+t+`
]`),r=t.charCodeAt(0);function n(f,d){var m,b,x=i(f,function(E,T){if(m)return m(E,T-1);b=E,m=d?aMe(E,d):vee(E)});return x.columns=b,x}function i(f,d){var m={},b={},x=[],E=f.length,T=0,A=0,M,F;function N(){if(T>=E)return b;if(F)return F=!1,m;var U=T,j;if(f.charCodeAt(U)===34){for(var H=U;H++<E;)if(f.charCodeAt(H)===34){if(f.charCodeAt(H+1)!==34)break;++H}return T=H+2,j=f.charCodeAt(H+1),j===13?(F=!0,f.charCodeAt(H+2)===10&&++T):j===10&&(F=!0),f.slice(U+1,H).replace(/""/g,'"')}for(;T<E;){var W=1;if(j=f.charCodeAt(T++),j===10)F=!0;else if(j===13)F=!0,f.charCodeAt(T)===10&&(++T,++W);else if(j!==r)continue;return f.slice(U,T-W)}return f.slice(U)}for(;(M=N())!==b;){for(var O=[];M!==m&&M!==b;)O.push(M),M=N();d&&(O=d(O,A++))==null||x.push(O)}return x}function a(f,d){return d==null&&(d=oMe(f)),[d.map(c).join(t)].concat(f.map(function(m){return d.map(function(b){return c(m[b])}).join(t)})).join(`
`)}function s(f){return f.map(o).join(`
`)}function o(f){return f.map(c).join(t)}function c(f){return f==null?"":e.test(f+="")?'"'+f.replace(/\"/g,'""')+'"':f}return{parse:n,parseRows:i,format:a,formatRows:s}}var L3=hL(","),sMe=L3.parse,lMe=L3.parseRows,uMe=L3.format,cMe=L3.formatRows,F3=hL("	"),fMe=F3.parse,hMe=F3.parseRows,dMe=F3.format,pMe=F3.formatRows;const gMe=Object.freeze(Object.defineProperty({__proto__:null,csvFormat:uMe,csvFormatRows:cMe,csvParse:sMe,csvParseRows:lMe,dsvFormat:hL,tsvFormat:dMe,tsvFormatRows:pMe,tsvParse:fMe,tsvParseRows:hMe},Symbol.toStringTag,{value:"Module"})),mMe=HW(gMe);var dm={exports:{}},$q;function yMe(){if($q)return dm.exports;$q=1,dm.exports=t,dm.exports.pair=a,dm.exports.format=r,dm.exports.formatPair=e,dm.exports.coordToDMS=n;function t(o,c){var f=i(o,c);return f===null?null:f.val}function e(o){return r(o.lat,"lat")+" "+r(o.lon,"lon")}function r(o,c){var f=n(o,c);return f.whole+" "+(f.minutes?f.minutes+"' ":"")+(f.seconds?f.seconds+'" ':"")+f.dir}function n(o,c){var f={lat:["N","S"],lon:["E","W"]}[c]||"",d=f[o>=0?0:1],m=Math.abs(o),b=Math.floor(m),x=m-b,E=x*60,T=Math.floor(E),A=Math.floor((E-T)*60);return{whole:b,minutes:T,seconds:A,dir:d}}function i(o,c){if(c||(c="NSEW"),typeof o!="string")return null;o=o.toUpperCase();var f=/^[\s\,]*([NSEW])?\s*([\-|\|\]?[0-9.]+)[]?\s*(?:([0-9.]+)[']\s*)?(?:([0-9.]+)(?:''|"||)\s*)?([NSEW])?/,d=o.match(f);if(!d)return null;var m=d[0],b;if(d[1]&&d[5]?(b=d[1],m=m.slice(0,-1)):b=d[1]||d[5],b&&c.indexOf(b)===-1)return null;var x=d[2]?parseFloat(d[2]):0,E=d[3]?parseFloat(d[3])/60:0,T=d[4]?parseFloat(d[4])/3600:0,A=x<0?-1:1;return(b==="S"||b==="W")&&(A*=-1),{val:(Math.abs(x)+E+T)*A,dim:b,matched:m,remain:o.slice(m.length)}}function a(o,c){o=o.trim();var f=i(o,c);if(!f)return null;o=f.remain.trim();var d=i(o,c);return!d||d.remain?null:f.dim?s(f.val,d.val,f.dim):[f.val,d.val]}function s(o,c,f){if(f==="N"||f==="S")return[o,c];if(f==="W"||f==="E")return[c,o]}return dm.exports}var yP,qq;function vMe(){if(qq)return yP;qq=1;var t=mMe,e=yMe(),r=/(Lat)(itude)?/gi,n=/(L)(on|ng)(gitude)?/i;function i(A,M){var F,N,O;for(var U in A)N=U.match(M),N&&(!F||N[0].length/U.length>O)&&(O=N[0].length/U.length,F=U);return F}function a(A){return i(A,r)}function s(A){return i(A,n)}function o(A){return!!A.match(r)}function c(A){return!!A.match(n)}function f(A){return typeof A=="object"?Object.keys(A).length:0}function d(A){var M=[",",";","	","|"],F=[];return M.forEach(function(N){var O=t.dsvFormat(N).parse(A);if(O.length>=1){for(var U=f(O[0]),j=0;j<O.length;j++)if(f(O[j])!==U)return;F.push({delimiter:N,arity:Object.keys(O[0]).length})}}),F.length?F.sort(function(N,O){return O.arity-N.arity})[0].delimiter:null}function m(A){return delete A.columns,A}function b(A){var M=d(A);return M?m(t.dsvFormat(M).parse(A)):null}function x(A,M,F){F||(F=M,M={}),M.delimiter=M.delimiter||",";var N=M.latfield||"",O=M.lonfield||"",U=M.crs||"",j=[],H={type:"FeatureCollection",features:j};if(U!==""&&(H.crs={type:"name",properties:{name:U}}),M.delimiter==="auto"&&typeof A=="string"&&(M.delimiter=d(A),!M.delimiter)){F({type:"Error",message:"Could not autodetect delimiter"});return}var W=M.numericFields?M.numericFields.split(","):null,X=typeof A=="string"?t.dsvFormat(M.delimiter).parse(A,function(ye){if(W)for(var Te in ye)W.includes(Te)&&(ye[Te]=+ye[Te]);return ye}):A;if(!X.length){F(null,H);return}var oe=[],Q;N||(N=a(X[0])),O||(O=s(X[0]));var G=!N||!O;if(G){for(Q=0;Q<X.length;Q++)j.push({type:"Feature",properties:X[Q],geometry:null});F(oe.length?oe:null,H);return}for(Q=0;Q<X.length;Q++)if(X[Q][O]!==void 0&&X[Q][N]!==void 0){var ae=X[Q][O],se=X[Q][N],fe,_e,Le;Le=e(ae,"EW"),Le&&(ae=Le),Le=e(se,"NS"),Le&&(se=Le),fe=parseFloat(ae),_e=parseFloat(se),isNaN(fe)||isNaN(_e)?oe.push({message:"A row contained an invalid value for latitude or longitude",row:X[Q],index:Q}):(M.includeLatLon||(delete X[Q][O],delete X[Q][N]),j.push({type:"Feature",properties:X[Q],geometry:{type:"Point",coordinates:[parseFloat(fe),parseFloat(_e)]}}))}F(oe.length?oe:null,H)}function E(A){for(var M=A.features,F={type:"Feature",geometry:{type:"LineString",coordinates:[]}},N=0;N<M.length;N++)F.geometry.coordinates.push(M[N].geometry.coordinates);return F.properties=M.reduce(function(O,U){for(var j in U.properties)O[j]||(O[j]=[]),O[j].push(U.properties[j]);return O},{}),{type:"FeatureCollection",features:[F]}}function T(A){for(var M=A.features,F={type:"Feature",geometry:{type:"Polygon",coordinates:[[]]}},N=0;N<M.length;N++)F.geometry.coordinates[0].push(M[N].geometry.coordinates);return F.properties=M.reduce(function(O,U){for(var j in U.properties)O[j]||(O[j]=[]),O[j].push(U.properties[j]);return O},{}),{type:"FeatureCollection",features:[F]}}return yP={isLon:c,isLat:o,guessLatHeader:a,guessLonHeader:s,csv:t.csvParse,tsv:t.tsvParse,dsv:t,auto:b,csv2geojson:x,toLine:E,toPolygon:T},yP}var _Me=vMe();function B3(t){const e=t.split("?"),r=e[0].split("://"),n=r[0],s=(r.length>2?r[1]+"://"+r[2]:r[1]).split("/").join("/"),o=decodeURI(e[1]),c=Object.fromEntries(new URLSearchParams(o));return{protocolId:n,filename:s,options:c}}async function z3(t){try{return await(await fetch(t)).text()}catch(e){return console.error("File could not be loaded: ",e),e}}async function bMe(t,e){return await new Promise((n,i)=>{const a=e||{};t.substring(t.length-3)==="tsv"&&(e.delimiter="	"),z3(t).then(o=>{_Me.csv2geojson(o,a,(c,f)=>{c?i(c):n(f)})})})}const xMe=async t=>{const e=B3(t.url),r=await bMe(e.filename,e.options);if(r!==void 0)return{data:r};throw new Error("CSV not found "+e.filename)};var hc={},Hq;function Qx(){if(Hq)return hc;Hq=1,Object.defineProperty(hc,"__esModule",{value:!0}),hc.purgeProps=t,hc.first=e,hc.last=r,hc.coordsToKey=n,hc.addToMap=i,hc.removeFromMap=a,hc.getFirstFromMap=s,hc.isRing=o,hc.ringDirection=c,hc.pointInsidePolygon=f,hc.strArrayArrayToFloat=d,hc.strArrayToFloat=m;function t(b,x){if(b){const E=Object.assign({},b);if(x)for(const T of x)delete E[T];return E}return{}}function e(b){return b[0]}function r(b){return b[b.length-1]}function n(b){return b.join(",")}function i(b,x,E){const T=b[x];T?T.push(E):b[x]=[E]}function a(b,x,E){const T=b[x];let A=-1;T&&(A=T.indexOf(E)),A>=0&&T.splice(A,1)}function s(b,x){const E=b[x];return E&&E.length>0?E[0]:null}function o(b){return b.length>3&&n(e(b))===n(r(b))}function c(b,x,E){x=x||0,E=E||1;const T=b.reduce((X,oe,Q)=>b[X][x||0]>oe[x||0]?X:Q,0),A=T<=0?b.length-2:T-1,M=T>=b.length-1?1:T+1,F=b[A][x],N=b[T][x],O=b[M][x],U=b[A][E],j=b[T][E],H=b[M][E];return(N-F)*(H-U)-(O-F)*(j-U)<0?"clockwise":"counterclockwise"}function f(b,x,E,T){E=E||0,T=T||1;let A=!1;for(let M=0,F=x.length-1;M<x.length;F=M++)(x[M][E]<=b[E]&&b[E]<x[F][E]||x[F][E]<=b[E]&&b[E]<x[M][E])&&b[T]<(x[F][T]-x[M][T])*(b[E]-x[M][E])/(x[F][E]-x[M][E])+x[M][T]&&(A=!A);return A}function d(b){return b.map(m)}function m(b){return b.map(parseFloat)}return hc}var p1={},Gq;function wMe(){if(Gq)return p1;Gq=1,Object.defineProperty(p1,"__esModule",{value:!0}),p1.XmlParser=void 0;function t(i){return i.match(/^(.+?)\[(.+?)\]>$/g)!==null}function e(i){const a=/^(.+?)\[(.+?)\]>$/g.exec(i);return a?{evt:a[1]+">",exp:a[2]}:{evt:i}}function r(i){const a="return "+i.replace(/(\$.+?)(?=[=!.])/g,"node.$&")+";";return new Function("node",a)}class n{constructor(a){this.queryParent=!1,this.progressive=!1,this.parentMap=new WeakMap,a&&(this.queryParent=!!a.queryParent,this.progressive=a.progressive,this.queryParent&&(this.parentMap=new WeakMap)),this.evtListeners={}}parse(a,s,o){o=o?o+".":"";const c=/<([^ >\/]+)(.*?)>/mg,f=[];let d=c.exec(a);for(;d;){const m=d[1],b={$tag:m},x=o+m,E=d[2].trim();let T=!1;(E.endsWith("/")||m.startsWith("?")||m.startsWith("!"))&&(T=!0);const A=/([^ ]+?)="(.+?)"/g,M=/([^ ]+?)='(.+?)'/g;let F=A.exec(E),N=!1;for(;F;)N=!0,b[F[1]]=F[2],F=A.exec(E);if(!N)for(F=M.exec(E);F;)N=!0,b[F[1]]=F[2],F=M.exec(E);if(!N&&E!==""&&(b.text=E),this.progressive&&this.emit(`<${x}>`,b,s),!T){const O=new RegExp(`([^]+?)</${m}>`,"g");O.lastIndex=c.lastIndex;const U=O.exec(a);if(U&&U[1]){c.lastIndex=O.lastIndex;const j=this.parse(U[1],b,x);j.length>0?b.$innerNodes=j:b.$innerText=U[1]}}this.queryParent&&s&&this.parentMap.set(b,s),this.progressive&&this.emit(`</${x}>`,b,s),f.push(b),d=c.exec(a)}return f}getParent(a){return this.queryParent?this.parentMap.get(a):null}addListener(a,s){if(t(a)){const o=e(a);o.exp&&(s.condition=r(o.exp)),a=o.evt}this.$addListener(a,s)}removeListener(a,s){t(a)&&(a=e(a).evt),this.$removeListener(a,s)}on(a,s){this.addListener(a,s)}off(a,s){this.removeListener(a,s)}$addListener(a,s){const o=this.evtListeners[a];o?o.push(s):this.evtListeners[a]=[s]}$removeListener(a,s){const o=this.evtListeners[a];let c=-1;o&&(c=o.indexOf(s)),c>=0&&o.splice(c,1)}emit(a,...s){const o=this.evtListeners[a];if(o)for(const c of o)c.condition?c.condition.apply(null,s)===!0&&c.apply(null,s):c.apply(null,s)}}return p1.XmlParser=n,p1}var g1={},m1={},Wq;function dL(){if(Wq)return m1;Wq=1,Object.defineProperty(m1,"__esModule",{value:!0}),m1.OsmObject=void 0;class t{constructor(r,n,i){this.type=r,this.id=n,this.refElems=i,this.tags={},this.props={id:this.getCompositeId()},this.refCount=0,this.hasTag=!1,i&&i.add(this.getCompositeId(),this)}addTags(r){this.tags=Object.assign(this.tags,r),this.hasTag=!0}addTag(r,n){this.tags[r]=n,this.hasTag=!0}addProp(r,n){this.props[r]=n}addProps(r){this.props=Object.assign(this.props,r)}getCompositeId(){return`${this.type}/${this.id}`}getProps(){return Object.assign(this.props,this.tags)}}return m1.OsmObject=t,m1}var Xq;function _ee(){if(Xq)return g1;Xq=1,Object.defineProperty(g1,"__esModule",{value:!0}),g1.Node=void 0;const t=dL(),e=Qx();class r extends t.OsmObject{constructor(i,a){super("node",i,a)}setLatLng(i){this.latLng=i}toFeatureArray(){return this.latLng?[{type:"Feature",id:this.getCompositeId(),properties:this.getProps(),geometry:{type:"Point",coordinates:(0,e.strArrayToFloat)([this.latLng.lon,this.latLng.lat])}}]:[]}getLatLng(){return this.latLng}}return g1.Node=r,g1}var pm={},y1={},Yq;function bee(){if(Yq)return y1;Yq=1,Object.defineProperty(y1,"__esModule",{value:!0}),y1.LateBinder=void 0;class t{constructor(r,n,i,a){this.container=r,this.valueFunc=n,this.ctx=i,this.args=a}bind(){const r=this.valueFunc.apply(this.ctx,this.args),n=this.container.indexOf(this);if(n<0)return;const i=[n,1];r&&i.push(r),Array.prototype.splice.apply(this.container,i)}}return y1.LateBinder=t,y1}const SMe={},EMe={whitelist:["services","rest_area","escape","elevator"]},TMe={blacklist:["coastline","cliff","ridge","arete","tree_row"]},CMe={},AMe={whitelist:["riverbank","dock","boatyard","dam"]},IMe={},PMe={},kMe={whitelist:["city_wall","ditch","hedge","retaining_wall","wall","spikes"]},RMe={whitelist:["station","turntable","roundhouse","platform"]},MMe={},DMe={},OMe={blacklist:["cutline","embankment","pipeline"]},NMe={whitelist:["plant","substation","generator","transformer"]},LMe={},FMe={},BMe={blacklist:["taxiway"]},zMe={},jMe={},UMe={},VMe={},$Me={},qMe={},HMe={},GMe={},WMe={},XMe={building:SMe,highway:EMe,natural:TMe,landuse:CMe,waterway:AMe,amenity:IMe,leisure:PMe,barrier:kMe,railway:RMe,area:MMe,boundary:DMe,man_made:OMe,power:NMe,place:LMe,shop:FMe,aeroway:BMe,tourism:zMe,historic:jMe,public_transport:UMe,office:VMe,"building:part":{},military:$Me,ruins:qMe,"area:highway":{},craft:HMe,golf:GMe,indoor:WMe};var Zq;function xee(){if(Zq)return pm;Zq=1;var t=pm&&pm.__importDefault||function(s){return s&&s.__esModule?s:{default:s}};Object.defineProperty(pm,"__esModule",{value:!0}),pm.Way=void 0;const e=dL(),r=bee(),n=Qx(),i=t(XMe);class a extends e.OsmObject{constructor(o,c){super("way",o,c),this.latLngArray=[],this.isPolygon=!1}addLatLng(o){this.latLngArray.push(o)}setLatLngArray(o){this.latLngArray=o}addNodeRef(o){const c=new r.LateBinder(this.latLngArray,f=>{const d=this.refElems.get(`node/${f}`);if(d)return d.refCount++,d.getLatLng()},this,[o]);this.latLngArray.push(c),this.refElems.addBinder(c)}addTags(o){super.addTags(o);for(const[c,f]of Object.entries(o))this.analyzeTag(c,f)}addTag(o,c){super.addTag(o,c),this.analyzeTag(o,c)}toCoordsArray(){return this.latLngArray.map(o=>[o.lon,o.lat])}toFeatureArray(){let o=this.toCoordsArray();if(o.length>1){const c=(0,n.strArrayArrayToFloat)(o),f={type:"Feature",id:this.getCompositeId(),properties:this.getProps(),geometry:{type:"LineString",coordinates:c}};return this.isPolygon&&(0,n.isRing)(c)?((0,n.ringDirection)(c)!=="counterclockwise"&&c.reverse(),f.geometry={type:"Polygon",coordinates:[c]},[f]):[f]}return[]}analyzeTag(o,c){const f=i.default[o];f&&(this.isPolygon=!0,f.whitelist?this.isPolygon=f.whitelist.indexOf(c)>=0:f.blacklist&&(this.isPolygon=!(f.blacklist.indexOf(c)>=0)))}}return pm.Way=a,pm}var v1={},_1={},Kq;function YMe(){if(Kq)return _1;Kq=1,Object.defineProperty(_1,"__esModule",{value:!0}),_1.WayCollection=void 0;const t=Qx();class e extends Array{constructor(){super(),this.firstMap={},this.lastMap={}}addWay(n){const i=n.toCoordsArray();i.length>0&&(this.push(i),(0,t.addToMap)(this.firstMap,(0,t.coordsToKey)((0,t.first)(i)),i),(0,t.addToMap)(this.lastMap,(0,t.coordsToKey)((0,t.last)(i)),i))}mergeWays(){const n=[];let i=this.shift();for(;i;){(0,t.removeFromMap)(this.firstMap,(0,t.coordsToKey)((0,t.first)(i)),i),(0,t.removeFromMap)(this.lastMap,(0,t.coordsToKey)((0,t.last)(i)),i);let a=i,s;do{let o=this.getNextWay(a);s=o.next;let c=o.mergeType;if(s)switch(this.splice(this.indexOf(s),1),(0,t.removeFromMap)(this.firstMap,(0,t.coordsToKey)((0,t.first)(s)),s),(0,t.removeFromMap)(this.lastMap,(0,t.coordsToKey)((0,t.last)(s)),s),c){case 0:a=a.concat(s.slice(1));break;case 1:s.reverse(),a=a.concat(s.slice(1));break;case 2:a.reverse(),a=a.concat(s.slice(1));break;case 3:a=s.concat(a.slice(1));break}}while(s);n.push((0,t.strArrayArrayToFloat)(a)),i=this.shift()}return n}getNextWay(n){const i=(0,t.coordsToKey)((0,t.last)(n)),a=(0,t.coordsToKey)((0,t.first)(n));let s=this.length>0?this[0]:null;if(s){const o=(0,t.coordsToKey)((0,t.first)(s)),c=(0,t.coordsToKey)((0,t.last)(s));if(i===o)return{next:s,mergeType:0};if(i===c)return{next:s,mergeType:1};if(a===o)return{next:s,mergeType:2};if(a===c)return{next:s,mergeType:3}}return s=(0,t.getFirstFromMap)(this.firstMap,i),s?{next:s,mergeType:0}:(s=(0,t.getFirstFromMap)(this.lastMap,i),{next:s,mergeType:1})}toRings(n){const i=this.mergeWays(),a=[];let s=i.shift();for(;s;)(0,t.isRing)(s)&&((0,t.ringDirection)(s)!==n&&s.reverse(),a.push(s)),s=i.shift();return a}}return _1.WayCollection=e,_1}var Jq;function ZMe(){if(Jq)return v1;Jq=1,Object.defineProperty(v1,"__esModule",{value:!0}),v1.Relation=void 0;const t=dL(),e=xee(),r=_ee(),n=YMe(),i=bee(),a=Qx();class s extends t.OsmObject{constructor(c,f){super("relation",c,f),this.relations=[],this.nodes=[],this.bounds=void 0,this.ways=[],this.roles=[]}setBounds(c){this.bounds=c}addMember(c){switch(c.type){case"relation":let f=new i.LateBinder(this.relations,m=>{const b=this.refElems.get(`relation/${m}`);if(b)return b.refCount++,b},this,[c.ref]);this.relations.push(f),this.refElems.addBinder(f);break;case"way":if(c.role||(c.role=""),c.geometry){const m=new e.Way(c.ref,this.refElems);m.setLatLngArray(c.geometry),m.refCount++,this.ways.push(m),this.roles.push(c.role)}else if(c.nodes){const m=new e.Way(c.ref,this.refElems);for(const b of c.nodes)m.addNodeRef(b);m.refCount++,this.ways.push(m),this.roles.push(c.role)}else{let m=new i.LateBinder(this.ways,b=>{const x=this.refElems.get(`way/${b}`);if(x)return x.refCount++,x},this,[c.ref]);this.ways.push(m),this.roles.push(c.role),this.refElems.addBinder(m)}break;case"node":let d=null;if(c.lat&&c.lon){d=new r.Node(c.ref,this.refElems),d.setLatLng({lon:c.lon,lat:c.lat}),c.tags&&d.addTags(c.tags);for(const[m,b]of Object.entries(c))["id","type","lat","lon"].indexOf(m)<0&&d.addProp(m,b);d.refCount++,this.nodes.push(d)}else{let m=new i.LateBinder(this.nodes,b=>{const x=this.refElems.get(`node/${b}`);if(x)return x.refCount++,x},this,[c.ref]);this.nodes.push(m),this.refElems.addBinder(m)}break}}constructStringGeometry(c){const f=c?c.mergeWays():[];return f.length===0?null:{type:"MultiLineString",coordinates:f}}constructPolygonGeometry(c,f){const d=c?c.toRings("counterclockwise"):[],m=f?f.toRings("clockwise"):[];if(d.length>0){const b=[];let x;for(x of d)b.push([x]);for(x=m.shift();x;){for(const E in d)if((0,a.pointInsidePolygon)((0,a.first)(x),d[E])){b[E].push(x);break}x=m.shift()}return b.length===1?{type:"Polygon",coordinates:b[0]}:{type:"MultiPolygon",coordinates:b}}return null}toFeatureArray(){const c=[],f=[];let d=[];for(const b of this.relations)if(b)for(let x=0;x<b.ways.length;x++){const E=b.ways[x];this.ways.push(E),this.roles.push(b.roles[x])}let m={type:"Feature",id:this.getCompositeId(),bbox:this.bounds,properties:this.getProps(),geometry:null};if(this.bounds||delete m.bbox,this.roles.some(b=>b==="outer")){const b=new n.WayCollection,x=new n.WayCollection;for(let A=0;A<this.ways.length;A++){const M=this.ways[A],F=this.roles[A];F==="outer"?b.addWay(M):F==="inner"&&x.addWay(M)}let E=Object.assign({},m),T=this.constructPolygonGeometry(b,x);T&&(E.geometry=T,c.push(E))}else{const b=new n.WayCollection;for(let E of this.ways)b.addWay(E);let x=this.constructStringGeometry(b);if(x){let E=Object.assign({},m);E.geometry=x,f.push(E)}}for(let b of this.nodes)d=d.concat(b.toFeatureArray());return[...c,...f,...d]}}return v1.Relation=s,v1}var b1={},Qq;function KMe(){if(Qq)return b1;Qq=1,Object.defineProperty(b1,"__esModule",{value:!0}),b1.RefElements=void 0;class t extends Map{constructor(){super(),this.binders=[]}add(r,n){this.set(r,n)}addBinder(r){this.binders.push(r)}bindAll(){this.binders.forEach(r=>r.bind())}}return b1.RefElements=t,b1}var vP,eH;function JMe(){if(eH)return vP;eH=1;const t=Qx(),e=wMe(),r=_ee(),n=xee(),i=ZMe(),a=KMe();function s(m){if(!m)return{completeFeature:!1,renderTagged:!1,excludeWay:!0};let b=m.excludeWay===void 0||m.excludeWay,x=!!m.completeFeature,E=!!m.renderTagged;return{completeFeature:x,renderTagged:E,excludeWay:b}}function o(m){return m.elements?"json":m.indexOf("<osm")>=0?"xml":m.trim().startsWith("{")?"json-raw":"invalid"}function c(m,b){for(const x of m.elements)switch(x.type){case"node":const E=new r.Node(x.id,b);x.tags&&E.addTags(x.tags),E.addProps((0,t.purgeProps)(x,["id","type","tags","lat","lon"])),E.setLatLng(x);break;case"way":const T=new n.Way(x.id,b);if(x.tags&&T.addTags(x.tags),T.addProps((0,t.purgeProps)(x,["id","type","tags","nodes","geometry"])),x.geometry)T.setLatLngArray(x.geometry);else if(x.nodes)for(const M of x.nodes)T.addNodeRef(M);break;case"relation":const A=new i.Relation(x.id,b);if(x.bounds&&A.setBounds([parseFloat(x.bounds.minlon),parseFloat(x.bounds.minlat),parseFloat(x.bounds.maxlon),parseFloat(x.bounds.maxlat)]),x.tags&&A.addTags(x.tags),A.addProps((0,t.purgeProps)(x,["id","type","tags","bounds","members"])),x.members)for(const M of x.members)A.addMember(M)}}function f(m,b){const x=new e.XmlParser({progressive:!0});x.on("</osm.node>",E=>{const T=new r.Node(E.id,b);for(const[A,M]of Object.entries(E))!A.startsWith("$")&&["id","lon","lat"].indexOf(A)<0&&T.addProp(A,M);if(T.setLatLng(E),E.$innerNodes)for(const A of E.$innerNodes)A.$tag==="tag"&&T.addTag(A.k,A.v)}),x.on("</osm.way>",E=>{const T=new n.Way(E.id,b);for(const[A,M]of Object.entries(E))!A.startsWith("$")&&["id"].indexOf(A)<0&&T.addProp(A,M);if(E.$innerNodes)for(const A of E.$innerNodes)A.$tag==="nd"?A.lon&&A.lat?T.addLatLng(A):A.ref&&T.addNodeRef(A.ref):A.$tag==="tag"&&T.addTag(A.k,A.v)}),x.on("<osm.relation>",E=>new i.Relation(E.id,b)),x.on("</osm.relation.member>",(E,T)=>{const A=b.get(`relation/${T?.id}`),M={type:E.type,role:E.role?E.role:"",ref:E.ref};if(E.lat&&E.lon){M.lat=E.lat,M.lon=E.lon,M.tags={};for(const[F,N]of Object.entries(E))!F.startsWith("$")&&["type","lat","lon"].indexOf(F)<0&&(M[F]=N)}if(E.$innerNodes){const F=[],N=[];for(const O of E.$innerNodes)O.lat&&O.lon?F.push(O):O.ref&&N.push(O.ref);F.length>0?M.geometry=F:N.length>0&&(M.nodes=N)}A.addMember(M)}),x.on("</osm.relation.bounds>",(E,T)=>{b.get(`relation/${T?.id}`).setBounds([parseFloat(E.minlon),parseFloat(E.minlat),parseFloat(E.maxlon),parseFloat(E.maxlat)])}),x.on("</osm.relation.tag>",(E,T)=>{b.get(`relation/${T?.id}`).addTag(E.k,E.v)}),x.parse(m)}function d(m,b){let{completeFeature:x,renderTagged:E,excludeWay:T}=s(b),A=o(m);const M=new a.RefElements;let F=[];A==="json-raw"&&(m=JSON.parse(m),m.elements?A="json":A="invalid"),A==="json"?c(m,M):A==="xml"&&f(m,M),M.bindAll();for(const N of M.values()){if(N.refCount>0&&(!N.hasTag||!E||N instanceof n.Way&&T))continue;const O=N.toFeatureArray();if(N instanceof i.Relation&&!x&&O.length>0)return O[0].geometry;F=F.concat(O)}return{type:"FeatureCollection",features:F}}return vP=d,vP}var QMe=JMe();const eDe=Id(QMe);async function tDe(t){const e=t.options||{};return await new Promise((n,i)=>{z3(t.filename).then(a=>{const s=eDe(a,e);s?n(s):i("Conversion failed")})})}const rDe=async t=>{const e=B3(t.url),r=await tDe(e);if(r!==void 0)return{data:r};throw new Error("OSM File not found "+e.filename)};function nDe(t){const e=[];return t.features.forEach(r=>{r.features?r.features.forEach(n=>{e.push({type:n.type,geometry:n.geometry,properties:n.properties})}):e.push({type:r.type,geometry:r.geometry,properties:r.properties})}),e}async function iDe(t){return await new Promise(r=>{let n={type:"Topology",objects:{key:""},arcs:[]};z3(t.filename).then(i=>{try{n=JSON.parse(i)}catch(s){throw console.error("Error converting topojson",s),"Invalid TopoJson"}let a={type:"FeatureCollection",features:[]};if(n.type==="Topology"&&n.objects!==void 0){const s=n.objects;Object.keys(n.objects).map(o=>{s?.[o].type==="GeometryCollection"?s?.[o].geometries?.forEach(c=>c.properties={fromObject:o,...c.properties}):s?.[o]&&s?.[o]?.type!=="GeometryCollection"&&(s[o].properties={fromObject:o,...s?.[o].properties})}),a={type:"FeatureCollection",features:Object.keys(n.objects).map(o=>Zwe(n,o))},a.features=nDe(a)}r(a)})})}const aDe=async t=>{const e=B3(t.url),r=await iDe(e);if(r!==void 0)return{data:r};throw new Error("Topojson not found "+e.filename)};function nl(t,e){return Array.from(t.getElementsByTagName(e))}function $E(t){return t[0]==="#"?t:`#${t}`}function oDe(t,e,r){return Array.from(t.getElementsByTagNameNS(r,e))}function Es(t){return t?.normalize(),t?.textContent||""}function es(t,e,r){const n=t.getElementsByTagName(e),i=n.length?n[0]:null;return i&&r&&r(i),i}function vf(t,e,r){const n={};if(!t)return n;const i=t.getElementsByTagName(e),a=i.length?i[0]:null;return a&&r?r(a,n):n}function oy(t,e,r){const n=Es(es(t,e));return n&&r?r(n)||{}:{}}function tH(t,e,r){const n=Number.parseFloat(Es(es(t,e)));if(!Number.isNaN(n))return n&&r?r(n)||{}:{}}function Eu(t,e,r){const n=Number.parseFloat(Es(es(t,e)));if(!Number.isNaN(n))return r&&r(n),n}function sy(t,e){const r={};for(const n of e)oy(t,n,i=>{r[n]=i});return r}function e2(t){return t?.nodeType===1}function wee(t){let e=[];if(t===null)return e;for(const r of Array.from(t.childNodes)){if(!e2(r))continue;const n=sDe(r.nodeName);if(n==="gpxtpx:TrackPointExtension")e=e.concat(wee(r));else{const i=Es(r);e.push([n,lDe(i)])}}return e}function sDe(t){return["heart","gpxtpx:hr","hr"].includes(t)?"heart":t}function lDe(t){const e=Number.parseFloat(t);return Number.isNaN(e)?t:e}function See(t){const e=[Number.parseFloat(t.getAttribute("lon")||""),Number.parseFloat(t.getAttribute("lat")||"")];if(Number.isNaN(e[0])||Number.isNaN(e[1]))return null;Eu(t,"ele",n=>{e.push(n)});const r=es(t,"time");return{coordinates:e,time:r?Es(r):null,extendedValues:wee(es(t,"extensions"))}}function Eee(t){return vf(t,"line",e=>Object.assign({},oy(e,"color",n=>({stroke:`#${n}`})),tH(e,"opacity",n=>({"stroke-opacity":n})),tH(e,"width",n=>({"stroke-width":n*96/25.4}))))}function pL(t,e){const r=sy(e,["name","cmt","desc","type","time","keywords"]);for(const[i,a]of t)for(const s of Array.from(e.getElementsByTagNameNS(a,"*")))r[s.tagName.replace(":","_")]=Es(s)?.trim();const n=nl(e,"link");return n.length&&(r.links=n.map(i=>Object.assign({href:i.getAttribute("href")},sy(i,["text","type"])))),r}function Tee(t,e){const r=nl(t,e),n=[],i=[],a={};for(let s=0;s<r.length;s++){const o=See(r[s]);if(o){n.push(o.coordinates),o.time&&i.push(o.time);for(const[c,f]of o.extendedValues){const d=c==="heart"?c:`${c.replace("gpxtpx:","")}s`;a[d]||(a[d]=Array(r.length).fill(null)),a[d][s]=f}}}if(!(n.length<2))return{line:n,times:i,extendedValues:a}}function uDe(t,e){const r=Tee(e,"rtept");if(r)return{type:"Feature",properties:Object.assign({_gpxType:"rte"},pL(t,e),Eee(es(e,"extensions"))),geometry:{type:"LineString",coordinates:r.line}}}function cDe(t,e){const r=nl(e,"trkseg"),n=[],i=[],a=[];for(const c of r){const f=Tee(c,"trkpt");f&&(a.push(f),f.times?.length&&i.push(f.times))}if(a.length===0)return null;const s=a.length>1,o=Object.assign({_gpxType:"trk"},pL(t,e),Eee(es(e,"extensions")),i.length?{coordinateProperties:{times:s?i:i[0]}}:{});for(let c=0;c<a.length;c++){const f=a[c];n.push(f.line),o.coordinateProperties||(o.coordinateProperties={});const d=o.coordinateProperties;for(const[m,b]of Object.entries(f.extendedValues))s?(d[m]||(d[m]=a.map(x=>new Array(x.line.length).fill(null))),d[m][c]=b):d[m]=b}return{type:"Feature",properties:o,geometry:s?{type:"MultiLineString",coordinates:n}:{type:"LineString",coordinates:n[0]}}}function fDe(t,e){const r=Object.assign(pL(t,e),sy(e,["sym"])),n=See(e);return n?{type:"Feature",properties:r,geometry:{type:"Point",coordinates:n.coordinates}}:null}function*Cee(t){const e=t,r="gpxx",n="http://www.garmin.com/xmlschemas/GpxExtensions/v3",i=[[r,n]],a=e.getElementsByTagName("gpx")[0]?.attributes;if(a)for(const s of Array.from(a))s.name?.startsWith("xmlns:")&&s.value!==n&&i.push([s.name,s.value]);for(const s of nl(e,"trk")){const o=cDe(i,s);o&&(yield o)}for(const s of nl(e,"rte")){const o=uDe(i,s);o&&(yield o)}for(const s of nl(e,"wpt")){const o=fDe(i,s);o&&(yield o)}}function hDe(t){return{type:"FeatureCollection",features:Array.from(Cee(t))}}const dDe="http://www.garmin.com/xmlschemas/ActivityExtension/v2",pDe=[["heartRate","heartRates"],["Cadence","cadences"],["Speed","speeds"],["Watts","watts"]],gDe=[["TotalTimeSeconds","totalTimeSeconds"],["DistanceMeters","distanceMeters"],["MaximumSpeed","maxSpeed"],["AverageHeartRateBpm","avgHeartRate"],["MaximumHeartRateBpm","maxHeartRate"],["AvgSpeed","avgSpeed"],["AvgWatts","avgWatts"],["MaxWatts","maxWatts"]];function Aee(t,e){const r=[];for(const[n,i]of e){let a=es(t,n);if(!a){const o=t.getElementsByTagNameNS(dDe,n);o.length&&(a=o[0])}const s=Number.parseFloat(Es(a));Number.isNaN(s)||r.push([i,s])}return r}function mDe(t){const e=[Eu(t,"LongitudeDegrees"),Eu(t,"LatitudeDegrees")];if(e[0]===void 0||Number.isNaN(e[0])||e[1]===void 0||Number.isNaN(e[1]))return null;const r=es(t,"HeartRateBpm"),n=Es(es(t,"Time"));return es(t,"AltitudeMeters",i=>{const a=Number.parseFloat(Es(i));Number.isNaN(a)||e.push(a)}),{coordinates:e,time:n||null,heartRate:r?Number.parseFloat(Es(r)):null,extensions:Aee(t,pDe)}}function yDe(t){const e=nl(t,"Trackpoint"),r=[],n=[],i=[];if(e.length<2)return null;const a={},s={extendedProperties:a};for(let o=0;o<e.length;o++){const c=mDe(e[o]);if(c===null)continue;r.push(c.coordinates);const{time:f,heartRate:d,extensions:m}=c;f&&n.push(f),d&&i.push(d);for(const[b,x]of m)a[b]||(a[b]=Array(e.length).fill(null)),a[b][o]=x}return r.length<2?null:Object.assign(s,{line:r,times:n,heartRates:i})}function rH(t){const e=nl(t,"Track"),r=[],n=[],i=[],a=[];let s;const o=Object.assign(Object.fromEntries(Aee(t,gDe)),vf(t,"Name",c=>({name:Es(c)})));for(const c of e)s=yDe(c),s&&(r.push(s.line),s.times.length&&n.push(s.times),s.heartRates.length&&i.push(s.heartRates),a.push(s.extendedProperties));for(let c=0;c<a.length;c++){const f=a[c];for(const d in f)e.length===1?s&&(o[d]=s.extendedProperties[d]):(o[d]||(o[d]=r.map(m=>Array(m.length).fill(null))),o[d][c]=f[d])}return r.length===0?null:((n.length||i.length)&&(o.coordinateProperties=Object.assign(n.length?{times:r.length===1?n[0]:n}:{},i.length?{heart:r.length===1?i[0]:i}:{})),{type:"Feature",properties:o,geometry:r.length===1?{type:"LineString",coordinates:r[0]}:{type:"MultiLineString",coordinates:r}})}function*Iee(t){for(const e of nl(t,"Lap")){const r=rH(e);r&&(yield r)}for(const e of nl(t,"Courses")){const r=rH(e);r&&(yield r)}}function vDe(t){return{type:"FeatureCollection",features:Array.from(Iee(t))}}function Pee(t,e){const r={},n=e==="stroke"||e==="fill"?e:`${e}-color`;return t[0]==="#"&&(t=t.substring(1)),t.length===6||t.length===3?r[n]=`#${t}`:t.length===8&&(r[`${e}-opacity`]=Number.parseInt(t.substring(0,2),16)/255,r[n]=`#${t.substring(6,8)}${t.substring(4,6)}${t.substring(2,4)}`),r}function qE(t,e,r){const n={};return Eu(t,e,i=>{n[r]=i}),n}function gL(t,e){return vf(t,"color",r=>Pee(Es(r),e))}function mL(t){return vf(t,"Icon",(e,r)=>(oy(e,"href",n=>{r.icon=n}),r))}function _De(t){return vf(t,"IconStyle",e=>Object.assign(gL(e,"icon"),qE(e,"scale","icon-scale"),qE(e,"heading","icon-heading"),vf(e,"hotSpot",r=>{const n=Number.parseFloat(r.getAttribute("x")||""),i=Number.parseFloat(r.getAttribute("y")||""),a=r.getAttribute("xunits")||"",s=r.getAttribute("yunits")||"";return!Number.isNaN(n)&&!Number.isNaN(i)?{"icon-offset":[n,i],"icon-offset-units":[a,s]}:{}}),mL(e)))}function bDe(t){return vf(t,"LabelStyle",e=>Object.assign(gL(e,"label"),qE(e,"scale","label-scale")))}function xDe(t){return vf(t,"LineStyle",e=>Object.assign(gL(e,"stroke"),qE(e,"width","stroke-width")))}function wDe(t){return vf(t,"PolyStyle",(e,r)=>Object.assign(r,vf(e,"color",n=>Pee(Es(n),"fill")),oy(e,"fill",n=>{if(n==="0")return{"fill-opacity":0}}),oy(e,"outline",n=>{if(n==="0")return{"stroke-opacity":0}})))}function j3(t){return Object.assign({},wDe(t),xDe(t),bDe(t),_De(t))}const SDe=/\s*/g,EDe=/^\s*|\s*$/g,TDe=/\s+/;function kee(t){return t.replace(SDe,"").split(",").map(Number.parseFloat).filter(e=>!Number.isNaN(e)).slice(0,3)}function _M(t){return t.replace(EDe,"").split(TDe).map(kee).filter(e=>e.length>=2)}function CDe(t){let e=nl(t,"coord");e.length===0&&(e=oDe(t,"coord","*"));const r=e.map(n=>Es(n).split(" ").map(Number.parseFloat));return r.length===0?null:{geometry:r.length>2?{type:"LineString",coordinates:r}:{type:"Point",coordinates:r[0]},times:nl(t,"when").map(n=>Es(n))}}function Ree(t){if(t.length===0)return t;const e=t[0],r=t[t.length-1];let n=!0;for(let i=0;i<Math.max(e.length,r.length);i++)if(e[i]!==r[i]){n=!1;break}return n?t:t.concat([t[0]])}function ES(t){return Es(es(t,"coordinates"))}function Mee(t){let e=[],r=[];for(let n=0;n<t.childNodes.length;n++){const i=t.childNodes.item(n);if(e2(i))switch(i.tagName){case"MultiGeometry":case"MultiTrack":case"gx:MultiTrack":{const a=Mee(i);e=e.concat(a.geometries),r=r.concat(a.coordTimes);break}case"Point":{const a=kee(ES(i));a.length>=2&&e.push({type:"Point",coordinates:a});break}case"LinearRing":case"LineString":{const a=_M(ES(i));a.length>=2&&e.push({type:"LineString",coordinates:a});break}case"Polygon":{const a=[];for(const s of nl(i,"LinearRing")){const o=Ree(_M(ES(s)));o.length>=4&&a.push(o)}a.length&&e.push({type:"Polygon",coordinates:a});break}case"Track":case"gx:Track":{const a=CDe(i);if(!a)break;const{times:s,geometry:o}=a;e.push(o),s.length&&r.push(s);break}}}return{geometries:e,coordTimes:r}}const Av=t=>Number(t),bM={string:t=>t,int:Av,uint:Av,short:Av,ushort:Av,float:Av,double:Av,bool:t=>!!t};function yL(t,e){return vf(t,"ExtendedData",(r,n)=>{for(const i of nl(r,"Data"))n[i.getAttribute("name")||""]=Es(es(i,"value"));for(const i of nl(r,"SimpleData")){const a=i.getAttribute("name")||"",s=e[a]||bM.string;n[a]=s(Es(i))}return n})}function vL(t){const e=es(t,"description");for(const r of Array.from(e?.childNodes||[]))if(r.nodeType===4)return{description:{"@type":"html",value:Es(r)}};return{}}function _L(t){return vf(t,"TimeSpan",e=>({timespan:{begin:Es(es(e,"begin")),end:Es(es(e,"end"))}}))}function bL(t){return vf(t,"TimeStamp",e=>({timestamp:Es(es(e,"when"))}))}function xL(t,e){return oy(t,"styleUrl",r=>(r=$E(r),e[r]?Object.assign({styleUrl:r},e[r]):{styleUrl:r}))}var Rf;(function(t){t.ABSOLUTE="absolute",t.RELATIVE_TO_GROUND="relativeToGround",t.CLAMP_TO_GROUND="clampToGround",t.CLAMP_TO_SEAFLOOR="clampToSeaFloor",t.RELATIVE_TO_SEAFLOOR="relativeToSeaFloor"})(Rf||(Rf={}));function ADe(t){switch(t?.textContent){case Rf.ABSOLUTE:return Rf.ABSOLUTE;case Rf.CLAMP_TO_GROUND:return Rf.CLAMP_TO_GROUND;case Rf.CLAMP_TO_SEAFLOOR:return Rf.CLAMP_TO_SEAFLOOR;case Rf.RELATIVE_TO_GROUND:return Rf.RELATIVE_TO_GROUND;case Rf.RELATIVE_TO_SEAFLOOR:return Rf.RELATIVE_TO_SEAFLOOR}return null}function IDe(t){return es(t,"gx:LatLonQuad")?{geometry:{type:"Polygon",coordinates:[Ree(_M(ES(t)))]}}:RDe(t)}const PDe=Math.PI/180;function kDe(t,e,r){const n=[(t[0]+t[2])/2,(t[1]+t[3])/2];return[e[0].map(i=>{const a=i[1]-n[1],s=i[0]-n[0],o=Math.sqrt(a**2+s**2),c=Math.atan2(a,s)+r*PDe;return[n[0]+Math.cos(c)*o,n[1]+Math.sin(c)*o]})]}function RDe(t){const e=es(t,"LatLonBox");if(e){const r=Eu(e,"north"),n=Eu(e,"west"),i=Eu(e,"east"),a=Eu(e,"south"),s=Eu(e,"rotation");if(typeof r=="number"&&typeof a=="number"&&typeof n=="number"&&typeof i=="number"){const o=[n,a,i,r];let c=[[[n,r],[i,r],[i,a],[n,a],[n,r]]];return typeof s=="number"&&(c=kDe(o,c,s)),{bbox:o,geometry:{type:"Polygon",coordinates:c}}}}return null}function Dee(t,e,r,n){const i=IDe(t),a=i?.geometry||null;if(!a&&n.skipNullGeometry)return null;const s={type:"Feature",geometry:a,properties:Object.assign({"@geometry-type":"groundoverlay"},sy(t,["name","address","visibility","open","phoneNumber","description"]),vL(t),xL(t,e),j3(t),mL(t),yL(t,r),_L(t),bL(t))};i?.bbox&&(s.bbox=i.bbox),s.properties?.visibility!==void 0&&(s.properties.visibility=s.properties.visibility!=="0");const o=t.getAttribute("id");return o!==null&&o!==""&&(s.id=o),s}function MDe(t){const e=es(t,"Region");return e?{coordinateBox:ODe(e),lod:DDe(t)}:null}function DDe(t){const e=es(t,"Lod");return e?[Eu(e,"minLodPixels")??-1,Eu(e,"maxLodPixels")??-1,Eu(e,"minFadeExtent")??null,Eu(e,"maxFadeExtent")??null]:null}function ODe(t){const e=es(t,"LatLonAltBox");if(e){const r=Eu(e,"north"),n=Eu(e,"west"),i=Eu(e,"east"),a=Eu(e,"south");if(ADe(es(e,"altitudeMode")||es(e,"gx:altitudeMode"))&&console.debug("Encountered an unsupported feature of KML for togeojson: please contact developers for support of altitude mode."),typeof r=="number"&&typeof a=="number"&&typeof n=="number"&&typeof i=="number")return{bbox:[n,a,i,r],geometry:{type:"Polygon",coordinates:[[[n,r],[i,r],[i,a],[n,a],[n,r]]]}}}return null}function NDe(t){const e=es(t,"Link");return e?sy(e,["href","refreshMode","refreshInterval","viewRefreshMode","viewRefreshTime","viewBoundScale","viewFormat","httpQuery"]):{}}function Oee(t,e,r,n){const i=MDe(t),a=i?.coordinateBox?.geometry||null;if(!a&&n.skipNullGeometry)return null;const s={type:"Feature",geometry:a,properties:Object.assign({"@geometry-type":"networklink"},sy(t,["name","address","visibility","open","phoneNumber","styleUrl","refreshVisibility","flyToView","description"]),vL(t),xL(t,e),j3(t),mL(t),yL(t,r),_L(t),bL(t),NDe(t),i?.lod?{lod:i.lod}:{})};i?.coordinateBox?.bbox&&(s.bbox=i.coordinateBox.bbox),s.properties?.visibility!==void 0&&(s.properties.visibility=s.properties.visibility!=="0");const o=t.getAttribute("id");return o!==null&&o!==""&&(s.id=o),s}function LDe(t){return t.length===0?null:t.length===1?t[0]:{type:"GeometryCollection",geometries:t}}function Nee(t,e,r,n){const{coordTimes:i,geometries:a}=Mee(t),s=LDe(a);if(!s&&n.skipNullGeometry)return null;const o={type:"Feature",geometry:s,properties:Object.assign(sy(t,["name","address","visibility","open","phoneNumber","description"]),vL(t),xL(t,e),j3(t),yL(t,r),_L(t),bL(t),i.length?{coordinateProperties:{times:i.length===1?i[0]:i}}:{})};o.properties?.visibility!==void 0&&(o.properties.visibility=o.properties.visibility!=="0");const c=t.getAttribute("id");return c!==null&&c!==""&&(o.id=c),o}function FDe(t){let e=t.getAttribute("id");const r=t.parentNode;return!e&&e2(r)&&r.localName==="CascadingStyle"&&(e=r.getAttribute("kml:id")||r.getAttribute("id")),$E(e||"")}function Lee(t){const e={};for(const r of nl(t,"Style"))e[FDe(r)]=j3(r);for(const r of nl(t,"StyleMap")){const n=$E(r.getAttribute("id")||"");oy(r,"styleUrl",i=>{i=$E(i),e[i]&&(e[n]=e[i])})}return e}function Fee(t){const e={};for(const r of nl(t,"SimpleField"))e[r.getAttribute("name")||""]=bM[r.getAttribute("type")||""]||bM.string;return e}const BDe=["name","visibility","open","address","description","phoneNumber","visibility"];function zDe(t){const e={};for(const r of Array.from(t.childNodes))e2(r)&&BDe.includes(r.tagName)&&(e[r.tagName]=Es(r));return{type:"folder",meta:e,children:[]}}function jDe(t,e={skipNullGeometry:!1}){const r=t,n=Lee(r),i=Fee(r),a={type:"root",children:[]};function s(o,c,f){if(e2(o))switch(o.tagName){case"GroundOverlay":{const d=Dee(o,n,i,f);d&&c.children.push(d);break}case"Placemark":{const d=Nee(o,n,i,f);d&&c.children.push(d);break}case"Folder":{const d=zDe(o);c.children.push(d),c=d;break}case"NetworkLink":{const d=Oee(o,n,i,f);d&&c.children.push(d);break}}if(o.childNodes)for(let d=0;d<o.childNodes.length;d++)s(o.childNodes[d],c,f)}return s(r,a,e),a}function*Bee(t,e={skipNullGeometry:!1}){const r=t,n=Lee(r),i=Fee(r);for(const a of nl(r,"Placemark")){const s=Nee(a,n,i,e);s&&(yield s)}for(const a of nl(r,"GroundOverlay")){const s=Dee(a,n,i,e);s&&(yield s)}for(const a of nl(r,"NetworkLink")){const s=Oee(a,n,i,e);s&&(yield s)}}function UDe(t,e={skipNullGeometry:!1}){return{type:"FeatureCollection",features:Array.from(Bee(t,e))}}const VDe=Object.freeze(Object.defineProperty({__proto__:null,gpx:hDe,gpxGen:Cee,kml:UDe,kmlGen:Bee,kmlWithFolders:jDe,tcx:vDe,tcxGen:Iee},Symbol.toStringTag,{value:"Module"}));async function $De(t){return await new Promise((r,n)=>{z3(t.filename).then(i=>{const a=()=>t.protocolId==="tcx"?VDe[t.protocolId](new DOMParser().parseFromString(i,"text/xml")):uee[t.protocolId](new DOMParser().parseFromString(i,"text/xml"));a()?r(a()):n("Conversion failed")})})}const _P=async t=>{const e=B3(t.url),r=await $De(e);if(r!==void 0)return{data:r};throw new Error("XML not found "+e.filename)},xM=t=>{const e=va({mapId:void 0}),r=te.useRef(!1);te.useEffect(()=>{if(!(!e.map||r.current))return e.map?.loadImage(t.imagePath).then(function(n){if(!n?.data){console.log("image "+t.imagePath+"could not be loaded");return}e.map?.addImage(t.imageId,n.data)}),()=>{e.map?.removeImage(t.imageId)}},[e.map,t])};xM.defaultProps={mapId:void 0};try{xM.displayName="useAddImage",xM.__docgenInfo={description:"",displayName:"useAddImage",props:{imageId:{defaultValue:null,description:"",name:"imageId",required:!0,type:{name:"string"}},imagePath:{defaultValue:null,description:"",name:"imagePath",required:!0,type:{name:"string"}}}}}catch{}const qDe=gt.createContext({}),wM=qDe.Provider;try{wM.displayName="SimpleDataContextProvider",wM.__docgenInfo={description:"",displayName:"SimpleDataContextProvider",props:{}}}catch{}var HDe={value:()=>{}};function zee(){for(var t=0,e=arguments.length,r={},n;t<e;++t){if(!(n=arguments[t]+"")||n in r||/[\s.]/.test(n))throw new Error("illegal type: "+n);r[n]=[]}return new TS(r)}function TS(t){this._=t}function GDe(t,e){return t.trim().split(/^|\s+/).map(function(r){var n="",i=r.indexOf(".");if(i>=0&&(n=r.slice(i+1),r=r.slice(0,i)),r&&!e.hasOwnProperty(r))throw new Error("unknown type: "+r);return{type:r,name:n}})}TS.prototype=zee.prototype={constructor:TS,on:function(t,e){var r=this._,n=GDe(t+"",r),i,a=-1,s=n.length;if(arguments.length<2){for(;++a<s;)if((i=(t=n[a]).type)&&(i=WDe(r[i],t.name)))return i;return}if(e!=null&&typeof e!="function")throw new Error("invalid callback: "+e);for(;++a<s;)if(i=(t=n[a]).type)r[i]=nH(r[i],t.name,e);else if(e==null)for(i in r)r[i]=nH(r[i],t.name,null);return this},copy:function(){var t={},e=this._;for(var r in e)t[r]=e[r].slice();return new TS(t)},call:function(t,e){if((i=arguments.length-2)>0)for(var r=new Array(i),n=0,i,a;n<i;++n)r[n]=arguments[n+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(a=this._[t],n=0,i=a.length;n<i;++n)a[n].value.apply(e,r)},apply:function(t,e,r){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var n=this._[t],i=0,a=n.length;i<a;++i)n[i].value.apply(e,r)}};function WDe(t,e){for(var r=0,n=t.length,i;r<n;++r)if((i=t[r]).name===e)return i.value}function nH(t,e,r){for(var n=0,i=t.length;n<i;++n)if(t[n].name===e){t[n]=HDe,t=t.slice(0,n).concat(t.slice(n+1));break}return r!=null&&t.push({name:e,value:r}),t}var SM="http://www.w3.org/1999/xhtml";const iH={svg:"http://www.w3.org/2000/svg",xhtml:SM,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function U3(t){var e=t+="",r=e.indexOf(":");return r>=0&&(e=t.slice(0,r))!=="xmlns"&&(t=t.slice(r+1)),iH.hasOwnProperty(e)?{space:iH[e],local:t}:t}function XDe(t){return function(){var e=this.ownerDocument,r=this.namespaceURI;return r===SM&&e.documentElement.namespaceURI===SM?e.createElement(t):e.createElementNS(r,t)}}function YDe(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}function jee(t){var e=U3(t);return(e.local?YDe:XDe)(e)}function ZDe(){}function wL(t){return t==null?ZDe:function(){return this.querySelector(t)}}function KDe(t){typeof t!="function"&&(t=wL(t));for(var e=this._groups,r=e.length,n=new Array(r),i=0;i<r;++i)for(var a=e[i],s=a.length,o=n[i]=new Array(s),c,f,d=0;d<s;++d)(c=a[d])&&(f=t.call(c,c.__data__,d,a))&&("__data__"in c&&(f.__data__=c.__data__),o[d]=f);return new kh(n,this._parents)}function JDe(t){return t==null?[]:Array.isArray(t)?t:Array.from(t)}function QDe(){return[]}function Uee(t){return t==null?QDe:function(){return this.querySelectorAll(t)}}function eOe(t){return function(){return JDe(t.apply(this,arguments))}}function tOe(t){typeof t=="function"?t=eOe(t):t=Uee(t);for(var e=this._groups,r=e.length,n=[],i=[],a=0;a<r;++a)for(var s=e[a],o=s.length,c,f=0;f<o;++f)(c=s[f])&&(n.push(t.call(c,c.__data__,f,s)),i.push(c));return new kh(n,i)}function Vee(t){return function(){return this.matches(t)}}function $ee(t){return function(e){return e.matches(t)}}var rOe=Array.prototype.find;function nOe(t){return function(){return rOe.call(this.children,t)}}function iOe(){return this.firstElementChild}function aOe(t){return this.select(t==null?iOe:nOe(typeof t=="function"?t:$ee(t)))}var oOe=Array.prototype.filter;function sOe(){return Array.from(this.children)}function lOe(t){return function(){return oOe.call(this.children,t)}}function uOe(t){return this.selectAll(t==null?sOe:lOe(typeof t=="function"?t:$ee(t)))}function cOe(t){typeof t!="function"&&(t=Vee(t));for(var e=this._groups,r=e.length,n=new Array(r),i=0;i<r;++i)for(var a=e[i],s=a.length,o=n[i]=[],c,f=0;f<s;++f)(c=a[f])&&t.call(c,c.__data__,f,a)&&o.push(c);return new kh(n,this._parents)}function qee(t){return new Array(t.length)}function fOe(){return new kh(this._enter||this._groups.map(qee),this._parents)}function HE(t,e){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=e}HE.prototype={constructor:HE,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,e){return this._parent.insertBefore(t,e)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}};function hOe(t){return function(){return t}}function dOe(t,e,r,n,i,a){for(var s=0,o,c=e.length,f=a.length;s<f;++s)(o=e[s])?(o.__data__=a[s],n[s]=o):r[s]=new HE(t,a[s]);for(;s<c;++s)(o=e[s])&&(i[s]=o)}function pOe(t,e,r,n,i,a,s){var o,c,f=new Map,d=e.length,m=a.length,b=new Array(d),x;for(o=0;o<d;++o)(c=e[o])&&(b[o]=x=s.call(c,c.__data__,o,e)+"",f.has(x)?i[o]=c:f.set(x,c));for(o=0;o<m;++o)x=s.call(t,a[o],o,a)+"",(c=f.get(x))?(n[o]=c,c.__data__=a[o],f.delete(x)):r[o]=new HE(t,a[o]);for(o=0;o<d;++o)(c=e[o])&&f.get(b[o])===c&&(i[o]=c)}function gOe(t){return t.__data__}function mOe(t,e){if(!arguments.length)return Array.from(this,gOe);var r=e?pOe:dOe,n=this._parents,i=this._groups;typeof t!="function"&&(t=hOe(t));for(var a=i.length,s=new Array(a),o=new Array(a),c=new Array(a),f=0;f<a;++f){var d=n[f],m=i[f],b=m.length,x=yOe(t.call(d,d&&d.__data__,f,n)),E=x.length,T=o[f]=new Array(E),A=s[f]=new Array(E),M=c[f]=new Array(b);r(d,m,T,A,M,x,e);for(var F=0,N=0,O,U;F<E;++F)if(O=T[F]){for(F>=N&&(N=F+1);!(U=A[N])&&++N<E;);O._next=U||null}}return s=new kh(s,n),s._enter=o,s._exit=c,s}function yOe(t){return typeof t=="object"&&"length"in t?t:Array.from(t)}function vOe(){return new kh(this._exit||this._groups.map(qee),this._parents)}function _Oe(t,e,r){var n=this.enter(),i=this,a=this.exit();return typeof t=="function"?(n=t(n),n&&(n=n.selection())):n=n.append(t+""),e!=null&&(i=e(i),i&&(i=i.selection())),r==null?a.remove():r(a),n&&i?n.merge(i).order():i}function bOe(t){for(var e=t.selection?t.selection():t,r=this._groups,n=e._groups,i=r.length,a=n.length,s=Math.min(i,a),o=new Array(i),c=0;c<s;++c)for(var f=r[c],d=n[c],m=f.length,b=o[c]=new Array(m),x,E=0;E<m;++E)(x=f[E]||d[E])&&(b[E]=x);for(;c<i;++c)o[c]=r[c];return new kh(o,this._parents)}function xOe(){for(var t=this._groups,e=-1,r=t.length;++e<r;)for(var n=t[e],i=n.length-1,a=n[i],s;--i>=0;)(s=n[i])&&(a&&s.compareDocumentPosition(a)^4&&a.parentNode.insertBefore(s,a),a=s);return this}function wOe(t){t||(t=SOe);function e(m,b){return m&&b?t(m.__data__,b.__data__):!m-!b}for(var r=this._groups,n=r.length,i=new Array(n),a=0;a<n;++a){for(var s=r[a],o=s.length,c=i[a]=new Array(o),f,d=0;d<o;++d)(f=s[d])&&(c[d]=f);c.sort(e)}return new kh(i,this._parents).order()}function SOe(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function EOe(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this}function TOe(){return Array.from(this)}function COe(){for(var t=this._groups,e=0,r=t.length;e<r;++e)for(var n=t[e],i=0,a=n.length;i<a;++i){var s=n[i];if(s)return s}return null}function AOe(){let t=0;for(const e of this)++t;return t}function IOe(){return!this.node()}function POe(t){for(var e=this._groups,r=0,n=e.length;r<n;++r)for(var i=e[r],a=0,s=i.length,o;a<s;++a)(o=i[a])&&t.call(o,o.__data__,a,i);return this}function kOe(t){return function(){this.removeAttribute(t)}}function ROe(t){return function(){this.removeAttributeNS(t.space,t.local)}}function MOe(t,e){return function(){this.setAttribute(t,e)}}function DOe(t,e){return function(){this.setAttributeNS(t.space,t.local,e)}}function OOe(t,e){return function(){var r=e.apply(this,arguments);r==null?this.removeAttribute(t):this.setAttribute(t,r)}}function NOe(t,e){return function(){var r=e.apply(this,arguments);r==null?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,r)}}function LOe(t,e){var r=U3(t);if(arguments.length<2){var n=this.node();return r.local?n.getAttributeNS(r.space,r.local):n.getAttribute(r)}return this.each((e==null?r.local?ROe:kOe:typeof e=="function"?r.local?NOe:OOe:r.local?DOe:MOe)(r,e))}function Hee(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView}function FOe(t){return function(){this.style.removeProperty(t)}}function BOe(t,e,r){return function(){this.style.setProperty(t,e,r)}}function zOe(t,e,r){return function(){var n=e.apply(this,arguments);n==null?this.style.removeProperty(t):this.style.setProperty(t,n,r)}}function jOe(t,e,r){return arguments.length>1?this.each((e==null?FOe:typeof e=="function"?zOe:BOe)(t,e,r??"")):t_(this.node(),t)}function t_(t,e){return t.style.getPropertyValue(e)||Hee(t).getComputedStyle(t,null).getPropertyValue(e)}function UOe(t){return function(){delete this[t]}}function VOe(t,e){return function(){this[t]=e}}function $Oe(t,e){return function(){var r=e.apply(this,arguments);r==null?delete this[t]:this[t]=r}}function qOe(t,e){return arguments.length>1?this.each((e==null?UOe:typeof e=="function"?$Oe:VOe)(t,e)):this.node()[t]}function Gee(t){return t.trim().split(/^|\s+/)}function SL(t){return t.classList||new Wee(t)}function Wee(t){this._node=t,this._names=Gee(t.getAttribute("class")||"")}Wee.prototype={add:function(t){var e=this._names.indexOf(t);e<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var e=this._names.indexOf(t);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};function Xee(t,e){for(var r=SL(t),n=-1,i=e.length;++n<i;)r.add(e[n])}function Yee(t,e){for(var r=SL(t),n=-1,i=e.length;++n<i;)r.remove(e[n])}function HOe(t){return function(){Xee(this,t)}}function GOe(t){return function(){Yee(this,t)}}function WOe(t,e){return function(){(e.apply(this,arguments)?Xee:Yee)(this,t)}}function XOe(t,e){var r=Gee(t+"");if(arguments.length<2){for(var n=SL(this.node()),i=-1,a=r.length;++i<a;)if(!n.contains(r[i]))return!1;return!0}return this.each((typeof e=="function"?WOe:e?HOe:GOe)(r,e))}function YOe(){this.textContent=""}function ZOe(t){return function(){this.textContent=t}}function KOe(t){return function(){var e=t.apply(this,arguments);this.textContent=e??""}}function JOe(t){return arguments.length?this.each(t==null?YOe:(typeof t=="function"?KOe:ZOe)(t)):this.node().textContent}function QOe(){this.innerHTML=""}function eNe(t){return function(){this.innerHTML=t}}function tNe(t){return function(){var e=t.apply(this,arguments);this.innerHTML=e??""}}function rNe(t){return arguments.length?this.each(t==null?QOe:(typeof t=="function"?tNe:eNe)(t)):this.node().innerHTML}function nNe(){this.nextSibling&&this.parentNode.appendChild(this)}function iNe(){return this.each(nNe)}function aNe(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function oNe(){return this.each(aNe)}function sNe(t){var e=typeof t=="function"?t:jee(t);return this.select(function(){return this.appendChild(e.apply(this,arguments))})}function lNe(){return null}function uNe(t,e){var r=typeof t=="function"?t:jee(t),n=e==null?lNe:typeof e=="function"?e:wL(e);return this.select(function(){return this.insertBefore(r.apply(this,arguments),n.apply(this,arguments)||null)})}function cNe(){var t=this.parentNode;t&&t.removeChild(this)}function fNe(){return this.each(cNe)}function hNe(){var t=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function dNe(){var t=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function pNe(t){return this.select(t?dNe:hNe)}function gNe(t){return arguments.length?this.property("__data__",t):this.node().__data__}function mNe(t){return function(e){t.call(this,e,this.__data__)}}function yNe(t){return t.trim().split(/^|\s+/).map(function(e){var r="",n=e.indexOf(".");return n>=0&&(r=e.slice(n+1),e=e.slice(0,n)),{type:e,name:r}})}function vNe(t){return function(){var e=this.__on;if(e){for(var r=0,n=-1,i=e.length,a;r<i;++r)a=e[r],(!t.type||a.type===t.type)&&a.name===t.name?this.removeEventListener(a.type,a.listener,a.options):e[++n]=a;++n?e.length=n:delete this.__on}}}function _Ne(t,e,r){return function(){var n=this.__on,i,a=mNe(e);if(n){for(var s=0,o=n.length;s<o;++s)if((i=n[s]).type===t.type&&i.name===t.name){this.removeEventListener(i.type,i.listener,i.options),this.addEventListener(i.type,i.listener=a,i.options=r),i.value=e;return}}this.addEventListener(t.type,a,r),i={type:t.type,name:t.name,value:e,listener:a,options:r},n?n.push(i):this.__on=[i]}}function bNe(t,e,r){var n=yNe(t+""),i,a=n.length,s;if(arguments.length<2){var o=this.node().__on;if(o){for(var c=0,f=o.length,d;c<f;++c)for(i=0,d=o[c];i<a;++i)if((s=n[i]).type===d.type&&s.name===d.name)return d.value}return}for(o=e?_Ne:vNe,i=0;i<a;++i)this.each(o(n[i],e,r));return this}function Zee(t,e,r){var n=Hee(t),i=n.CustomEvent;typeof i=="function"?i=new i(e,r):(i=n.document.createEvent("Event"),r?(i.initEvent(e,r.bubbles,r.cancelable),i.detail=r.detail):i.initEvent(e,!1,!1)),t.dispatchEvent(i)}function xNe(t,e){return function(){return Zee(this,t,e)}}function wNe(t,e){return function(){return Zee(this,t,e.apply(this,arguments))}}function SNe(t,e){return this.each((typeof e=="function"?wNe:xNe)(t,e))}function*ENe(){for(var t=this._groups,e=0,r=t.length;e<r;++e)for(var n=t[e],i=0,a=n.length,s;i<a;++i)(s=n[i])&&(yield s)}var TNe=[null];function kh(t,e){this._groups=t,this._parents=e}function t2(){return new kh([[document.documentElement]],TNe)}function CNe(){return this}kh.prototype=t2.prototype={constructor:kh,select:KDe,selectAll:tOe,selectChild:aOe,selectChildren:uOe,filter:cOe,data:mOe,enter:fOe,exit:vOe,join:_Oe,merge:bOe,selection:CNe,order:xOe,sort:wOe,call:EOe,nodes:TOe,node:COe,size:AOe,empty:IOe,each:POe,attr:LOe,style:jOe,property:qOe,classed:XOe,text:JOe,html:rNe,raise:iNe,lower:oNe,append:sNe,insert:uNe,remove:fNe,clone:pNe,datum:gNe,on:bNe,dispatch:SNe,[Symbol.iterator]:ENe};function EL(t,e,r){t.prototype=e.prototype=r,r.constructor=t}function Kee(t,e){var r=Object.create(t.prototype);for(var n in e)r[n]=e[n];return r}function r2(){}var sx=.7,GE=1/sx,M0="\\s*([+-]?\\d+)\\s*",lx="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",wd="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",ANe=/^#([0-9a-f]{3,8})$/,INe=new RegExp(`^rgb\\(${M0},${M0},${M0}\\)$`),PNe=new RegExp(`^rgb\\(${wd},${wd},${wd}\\)$`),kNe=new RegExp(`^rgba\\(${M0},${M0},${M0},${lx}\\)$`),RNe=new RegExp(`^rgba\\(${wd},${wd},${wd},${lx}\\)$`),MNe=new RegExp(`^hsl\\(${lx},${wd},${wd}\\)$`),DNe=new RegExp(`^hsla\\(${lx},${wd},${wd},${lx}\\)$`),aH={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};EL(r2,ux,{copy(t){return Object.assign(new this.constructor,this,t)},displayable(){return this.rgb().displayable()},hex:oH,formatHex:oH,formatHex8:ONe,formatHsl:NNe,formatRgb:sH,toString:sH});function oH(){return this.rgb().formatHex()}function ONe(){return this.rgb().formatHex8()}function NNe(){return Jee(this).formatHsl()}function sH(){return this.rgb().formatRgb()}function ux(t){var e,r;return t=(t+"").trim().toLowerCase(),(e=ANe.exec(t))?(r=e[1].length,e=parseInt(e[1],16),r===6?lH(e):r===3?new kc(e>>8&15|e>>4&240,e>>4&15|e&240,(e&15)<<4|e&15,1):r===8?Fw(e>>24&255,e>>16&255,e>>8&255,(e&255)/255):r===4?Fw(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|e&240,((e&15)<<4|e&15)/255):null):(e=INe.exec(t))?new kc(e[1],e[2],e[3],1):(e=PNe.exec(t))?new kc(e[1]*255/100,e[2]*255/100,e[3]*255/100,1):(e=kNe.exec(t))?Fw(e[1],e[2],e[3],e[4]):(e=RNe.exec(t))?Fw(e[1]*255/100,e[2]*255/100,e[3]*255/100,e[4]):(e=MNe.exec(t))?fH(e[1],e[2]/100,e[3]/100,1):(e=DNe.exec(t))?fH(e[1],e[2]/100,e[3]/100,e[4]):aH.hasOwnProperty(t)?lH(aH[t]):t==="transparent"?new kc(NaN,NaN,NaN,0):null}function lH(t){return new kc(t>>16&255,t>>8&255,t&255,1)}function Fw(t,e,r,n){return n<=0&&(t=e=r=NaN),new kc(t,e,r,n)}function LNe(t){return t instanceof r2||(t=ux(t)),t?(t=t.rgb(),new kc(t.r,t.g,t.b,t.opacity)):new kc}function EM(t,e,r,n){return arguments.length===1?LNe(t):new kc(t,e,r,n??1)}function kc(t,e,r,n){this.r=+t,this.g=+e,this.b=+r,this.opacity=+n}EL(kc,EM,Kee(r2,{brighter(t){return t=t==null?GE:Math.pow(GE,t),new kc(this.r*t,this.g*t,this.b*t,this.opacity)},darker(t){return t=t==null?sx:Math.pow(sx,t),new kc(this.r*t,this.g*t,this.b*t,this.opacity)},rgb(){return this},clamp(){return new kc(Um(this.r),Um(this.g),Um(this.b),WE(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:uH,formatHex:uH,formatHex8:FNe,formatRgb:cH,toString:cH}));function uH(){return`#${Rm(this.r)}${Rm(this.g)}${Rm(this.b)}`}function FNe(){return`#${Rm(this.r)}${Rm(this.g)}${Rm(this.b)}${Rm((isNaN(this.opacity)?1:this.opacity)*255)}`}function cH(){const t=WE(this.opacity);return`${t===1?"rgb(":"rgba("}${Um(this.r)}, ${Um(this.g)}, ${Um(this.b)}${t===1?")":`, ${t})`}`}function WE(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function Um(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function Rm(t){return t=Um(t),(t<16?"0":"")+t.toString(16)}function fH(t,e,r,n){return n<=0?t=e=r=NaN:r<=0||r>=1?t=e=NaN:e<=0&&(t=NaN),new _h(t,e,r,n)}function Jee(t){if(t instanceof _h)return new _h(t.h,t.s,t.l,t.opacity);if(t instanceof r2||(t=ux(t)),!t)return new _h;if(t instanceof _h)return t;t=t.rgb();var e=t.r/255,r=t.g/255,n=t.b/255,i=Math.min(e,r,n),a=Math.max(e,r,n),s=NaN,o=a-i,c=(a+i)/2;return o?(e===a?s=(r-n)/o+(r<n)*6:r===a?s=(n-e)/o+2:s=(e-r)/o+4,o/=c<.5?a+i:2-a-i,s*=60):o=c>0&&c<1?0:s,new _h(s,o,c,t.opacity)}function BNe(t,e,r,n){return arguments.length===1?Jee(t):new _h(t,e,r,n??1)}function _h(t,e,r,n){this.h=+t,this.s=+e,this.l=+r,this.opacity=+n}EL(_h,BNe,Kee(r2,{brighter(t){return t=t==null?GE:Math.pow(GE,t),new _h(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=t==null?sx:Math.pow(sx,t),new _h(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=this.h%360+(this.h<0)*360,e=isNaN(t)||isNaN(this.s)?0:this.s,r=this.l,n=r+(r<.5?r:1-r)*e,i=2*r-n;return new kc(bP(t>=240?t-240:t+120,i,n),bP(t,i,n),bP(t<120?t+240:t-120,i,n),this.opacity)},clamp(){return new _h(hH(this.h),Bw(this.s),Bw(this.l),WE(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const t=WE(this.opacity);return`${t===1?"hsl(":"hsla("}${hH(this.h)}, ${Bw(this.s)*100}%, ${Bw(this.l)*100}%${t===1?")":`, ${t})`}`}}));function hH(t){return t=(t||0)%360,t<0?t+360:t}function Bw(t){return Math.max(0,Math.min(1,t||0))}function bP(t,e,r){return(t<60?e+(r-e)*t/60:t<180?r:t<240?e+(r-e)*(240-t)/60:e)*255}const Qee=t=>()=>t;function zNe(t,e){return function(r){return t+r*e}}function jNe(t,e,r){return t=Math.pow(t,r),e=Math.pow(e,r)-t,r=1/r,function(n){return Math.pow(t+n*e,r)}}function UNe(t){return(t=+t)==1?ete:function(e,r){return r-e?jNe(e,r,t):Qee(isNaN(e)?r:e)}}function ete(t,e){var r=e-t;return r?zNe(t,r):Qee(isNaN(t)?e:t)}const dH=(function t(e){var r=UNe(e);function n(i,a){var s=r((i=EM(i)).r,(a=EM(a)).r),o=r(i.g,a.g),c=r(i.b,a.b),f=ete(i.opacity,a.opacity);return function(d){return i.r=s(d),i.g=o(d),i.b=c(d),i.opacity=f(d),i+""}}return n.gamma=t,n})(1);function sg(t,e){return t=+t,e=+e,function(r){return t*(1-r)+e*r}}var TM=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,xP=new RegExp(TM.source,"g");function VNe(t){return function(){return t}}function $Ne(t){return function(e){return t(e)+""}}function qNe(t,e){var r=TM.lastIndex=xP.lastIndex=0,n,i,a,s=-1,o=[],c=[];for(t=t+"",e=e+"";(n=TM.exec(t))&&(i=xP.exec(e));)(a=i.index)>r&&(a=e.slice(r,a),o[s]?o[s]+=a:o[++s]=a),(n=n[0])===(i=i[0])?o[s]?o[s]+=i:o[++s]=i:(o[++s]=null,c.push({i:s,x:sg(n,i)})),r=xP.lastIndex;return r<e.length&&(a=e.slice(r),o[s]?o[s]+=a:o[++s]=a),o.length<2?c[0]?$Ne(c[0].x):VNe(e):(e=c.length,function(f){for(var d=0,m;d<e;++d)o[(m=c[d]).i]=m.x(f);return o.join("")})}var pH=180/Math.PI,CM={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function tte(t,e,r,n,i,a){var s,o,c;return(s=Math.sqrt(t*t+e*e))&&(t/=s,e/=s),(c=t*r+e*n)&&(r-=t*c,n-=e*c),(o=Math.sqrt(r*r+n*n))&&(r/=o,n/=o,c/=o),t*n<e*r&&(t=-t,e=-e,c=-c,s=-s),{translateX:i,translateY:a,rotate:Math.atan2(e,t)*pH,skewX:Math.atan(c)*pH,scaleX:s,scaleY:o}}var zw;function HNe(t){const e=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(t+"");return e.isIdentity?CM:tte(e.a,e.b,e.c,e.d,e.e,e.f)}function GNe(t){return t==null||(zw||(zw=document.createElementNS("http://www.w3.org/2000/svg","g")),zw.setAttribute("transform",t),!(t=zw.transform.baseVal.consolidate()))?CM:(t=t.matrix,tte(t.a,t.b,t.c,t.d,t.e,t.f))}function rte(t,e,r,n){function i(f){return f.length?f.pop()+" ":""}function a(f,d,m,b,x,E){if(f!==m||d!==b){var T=x.push("translate(",null,e,null,r);E.push({i:T-4,x:sg(f,m)},{i:T-2,x:sg(d,b)})}else(m||b)&&x.push("translate("+m+e+b+r)}function s(f,d,m,b){f!==d?(f-d>180?d+=360:d-f>180&&(f+=360),b.push({i:m.push(i(m)+"rotate(",null,n)-2,x:sg(f,d)})):d&&m.push(i(m)+"rotate("+d+n)}function o(f,d,m,b){f!==d?b.push({i:m.push(i(m)+"skewX(",null,n)-2,x:sg(f,d)}):d&&m.push(i(m)+"skewX("+d+n)}function c(f,d,m,b,x,E){if(f!==m||d!==b){var T=x.push(i(x)+"scale(",null,",",null,")");E.push({i:T-4,x:sg(f,m)},{i:T-2,x:sg(d,b)})}else(m!==1||b!==1)&&x.push(i(x)+"scale("+m+","+b+")")}return function(f,d){var m=[],b=[];return f=t(f),d=t(d),a(f.translateX,f.translateY,d.translateX,d.translateY,m,b),s(f.rotate,d.rotate,m,b),o(f.skewX,d.skewX,m,b),c(f.scaleX,f.scaleY,d.scaleX,d.scaleY,m,b),f=d=null,function(x){for(var E=-1,T=b.length,A;++E<T;)m[(A=b[E]).i]=A.x(x);return m.join("")}}}var WNe=rte(HNe,"px, ","px)","deg)"),XNe=rte(GNe,", ",")",")"),r_=0,X1=0,x1=0,nte=1e3,XE,Y1,YE=0,ly=0,V3=0,cx=typeof performance=="object"&&performance.now?performance:Date,ite=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function TL(){return ly||(ite(YNe),ly=cx.now()+V3)}function YNe(){ly=0}function ZE(){this._call=this._time=this._next=null}ZE.prototype=ate.prototype={constructor:ZE,restart:function(t,e,r){if(typeof t!="function")throw new TypeError("callback is not a function");r=(r==null?TL():+r)+(e==null?0:+e),!this._next&&Y1!==this&&(Y1?Y1._next=this:XE=this,Y1=this),this._call=t,this._time=r,AM()},stop:function(){this._call&&(this._call=null,this._time=1/0,AM())}};function ate(t,e,r){var n=new ZE;return n.restart(t,e,r),n}function ZNe(){TL(),++r_;for(var t=XE,e;t;)(e=ly-t._time)>=0&&t._call.call(void 0,e),t=t._next;--r_}function gH(){ly=(YE=cx.now())+V3,r_=X1=0;try{ZNe()}finally{r_=0,JNe(),ly=0}}function KNe(){var t=cx.now(),e=t-YE;e>nte&&(V3-=e,YE=t)}function JNe(){for(var t,e=XE,r,n=1/0;e;)e._call?(n>e._time&&(n=e._time),t=e,e=e._next):(r=e._next,e._next=null,e=t?t._next=r:XE=r);Y1=t,AM(n)}function AM(t){if(!r_){X1&&(X1=clearTimeout(X1));var e=t-ly;e>24?(t<1/0&&(X1=setTimeout(gH,t-cx.now()-V3)),x1&&(x1=clearInterval(x1))):(x1||(YE=cx.now(),x1=setInterval(KNe,nte)),r_=1,ite(gH))}}function mH(t,e,r){var n=new ZE;return e=e==null?0:+e,n.restart(i=>{n.stop(),t(i+e)},e,r),n}var QNe=zee("start","end","cancel","interrupt"),eLe=[],ote=0,yH=1,IM=2,CS=3,vH=4,PM=5,AS=6;function $3(t,e,r,n,i,a){var s=t.__transition;if(!s)t.__transition={};else if(r in s)return;tLe(t,r,{name:e,index:n,group:i,on:QNe,tween:eLe,time:a.time,delay:a.delay,duration:a.duration,ease:a.ease,timer:null,state:ote})}function CL(t,e){var r=Fh(t,e);if(r.state>ote)throw new Error("too late; already scheduled");return r}function Dd(t,e){var r=Fh(t,e);if(r.state>CS)throw new Error("too late; already running");return r}function Fh(t,e){var r=t.__transition;if(!r||!(r=r[e]))throw new Error("transition not found");return r}function tLe(t,e,r){var n=t.__transition,i;n[e]=r,r.timer=ate(a,0,r.time);function a(f){r.state=yH,r.timer.restart(s,r.delay,r.time),r.delay<=f&&s(f-r.delay)}function s(f){var d,m,b,x;if(r.state!==yH)return c();for(d in n)if(x=n[d],x.name===r.name){if(x.state===CS)return mH(s);x.state===vH?(x.state=AS,x.timer.stop(),x.on.call("interrupt",t,t.__data__,x.index,x.group),delete n[d]):+d<e&&(x.state=AS,x.timer.stop(),x.on.call("cancel",t,t.__data__,x.index,x.group),delete n[d])}if(mH(function(){r.state===CS&&(r.state=vH,r.timer.restart(o,r.delay,r.time),o(f))}),r.state=IM,r.on.call("start",t,t.__data__,r.index,r.group),r.state===IM){for(r.state=CS,i=new Array(b=r.tween.length),d=0,m=-1;d<b;++d)(x=r.tween[d].value.call(t,t.__data__,r.index,r.group))&&(i[++m]=x);i.length=m+1}}function o(f){for(var d=f<r.duration?r.ease.call(null,f/r.duration):(r.timer.restart(c),r.state=PM,1),m=-1,b=i.length;++m<b;)i[m].call(t,d);r.state===PM&&(r.on.call("end",t,t.__data__,r.index,r.group),c())}function c(){r.state=AS,r.timer.stop(),delete n[e];for(var f in n)return;delete t.__transition}}function rLe(t,e){var r=t.__transition,n,i,a=!0,s;if(r){e=e==null?null:e+"";for(s in r){if((n=r[s]).name!==e){a=!1;continue}i=n.state>IM&&n.state<PM,n.state=AS,n.timer.stop(),n.on.call(i?"interrupt":"cancel",t,t.__data__,n.index,n.group),delete r[s]}a&&delete t.__transition}}function nLe(t){return this.each(function(){rLe(this,t)})}function iLe(t,e){var r,n;return function(){var i=Dd(this,t),a=i.tween;if(a!==r){n=r=a;for(var s=0,o=n.length;s<o;++s)if(n[s].name===e){n=n.slice(),n.splice(s,1);break}}i.tween=n}}function aLe(t,e,r){var n,i;if(typeof r!="function")throw new Error;return function(){var a=Dd(this,t),s=a.tween;if(s!==n){i=(n=s).slice();for(var o={name:e,value:r},c=0,f=i.length;c<f;++c)if(i[c].name===e){i[c]=o;break}c===f&&i.push(o)}a.tween=i}}function oLe(t,e){var r=this._id;if(t+="",arguments.length<2){for(var n=Fh(this.node(),r).tween,i=0,a=n.length,s;i<a;++i)if((s=n[i]).name===t)return s.value;return null}return this.each((e==null?iLe:aLe)(r,t,e))}function AL(t,e,r){var n=t._id;return t.each(function(){var i=Dd(this,n);(i.value||(i.value={}))[e]=r.apply(this,arguments)}),function(i){return Fh(i,n).value[e]}}function ste(t,e){var r;return(typeof e=="number"?sg:e instanceof ux?dH:(r=ux(e))?(e=r,dH):qNe)(t,e)}function sLe(t){return function(){this.removeAttribute(t)}}function lLe(t){return function(){this.removeAttributeNS(t.space,t.local)}}function uLe(t,e,r){var n,i=r+"",a;return function(){var s=this.getAttribute(t);return s===i?null:s===n?a:a=e(n=s,r)}}function cLe(t,e,r){var n,i=r+"",a;return function(){var s=this.getAttributeNS(t.space,t.local);return s===i?null:s===n?a:a=e(n=s,r)}}function fLe(t,e,r){var n,i,a;return function(){var s,o=r(this),c;return o==null?void this.removeAttribute(t):(s=this.getAttribute(t),c=o+"",s===c?null:s===n&&c===i?a:(i=c,a=e(n=s,o)))}}function hLe(t,e,r){var n,i,a;return function(){var s,o=r(this),c;return o==null?void this.removeAttributeNS(t.space,t.local):(s=this.getAttributeNS(t.space,t.local),c=o+"",s===c?null:s===n&&c===i?a:(i=c,a=e(n=s,o)))}}function dLe(t,e){var r=U3(t),n=r==="transform"?XNe:ste;return this.attrTween(t,typeof e=="function"?(r.local?hLe:fLe)(r,n,AL(this,"attr."+t,e)):e==null?(r.local?lLe:sLe)(r):(r.local?cLe:uLe)(r,n,e))}function pLe(t,e){return function(r){this.setAttribute(t,e.call(this,r))}}function gLe(t,e){return function(r){this.setAttributeNS(t.space,t.local,e.call(this,r))}}function mLe(t,e){var r,n;function i(){var a=e.apply(this,arguments);return a!==n&&(r=(n=a)&&gLe(t,a)),r}return i._value=e,i}function yLe(t,e){var r,n;function i(){var a=e.apply(this,arguments);return a!==n&&(r=(n=a)&&pLe(t,a)),r}return i._value=e,i}function vLe(t,e){var r="attr."+t;if(arguments.length<2)return(r=this.tween(r))&&r._value;if(e==null)return this.tween(r,null);if(typeof e!="function")throw new Error;var n=U3(t);return this.tween(r,(n.local?mLe:yLe)(n,e))}function _Le(t,e){return function(){CL(this,t).delay=+e.apply(this,arguments)}}function bLe(t,e){return e=+e,function(){CL(this,t).delay=e}}function xLe(t){var e=this._id;return arguments.length?this.each((typeof t=="function"?_Le:bLe)(e,t)):Fh(this.node(),e).delay}function wLe(t,e){return function(){Dd(this,t).duration=+e.apply(this,arguments)}}function SLe(t,e){return e=+e,function(){Dd(this,t).duration=e}}function ELe(t){var e=this._id;return arguments.length?this.each((typeof t=="function"?wLe:SLe)(e,t)):Fh(this.node(),e).duration}function TLe(t,e){if(typeof e!="function")throw new Error;return function(){Dd(this,t).ease=e}}function CLe(t){var e=this._id;return arguments.length?this.each(TLe(e,t)):Fh(this.node(),e).ease}function ALe(t,e){return function(){var r=e.apply(this,arguments);if(typeof r!="function")throw new Error;Dd(this,t).ease=r}}function ILe(t){if(typeof t!="function")throw new Error;return this.each(ALe(this._id,t))}function PLe(t){typeof t!="function"&&(t=Vee(t));for(var e=this._groups,r=e.length,n=new Array(r),i=0;i<r;++i)for(var a=e[i],s=a.length,o=n[i]=[],c,f=0;f<s;++f)(c=a[f])&&t.call(c,c.__data__,f,a)&&o.push(c);return new Ap(n,this._parents,this._name,this._id)}function kLe(t){if(t._id!==this._id)throw new Error;for(var e=this._groups,r=t._groups,n=e.length,i=r.length,a=Math.min(n,i),s=new Array(n),o=0;o<a;++o)for(var c=e[o],f=r[o],d=c.length,m=s[o]=new Array(d),b,x=0;x<d;++x)(b=c[x]||f[x])&&(m[x]=b);for(;o<n;++o)s[o]=e[o];return new Ap(s,this._parents,this._name,this._id)}function RLe(t){return(t+"").trim().split(/^|\s+/).every(function(e){var r=e.indexOf(".");return r>=0&&(e=e.slice(0,r)),!e||e==="start"})}function MLe(t,e,r){var n,i,a=RLe(e)?CL:Dd;return function(){var s=a(this,t),o=s.on;o!==n&&(i=(n=o).copy()).on(e,r),s.on=i}}function DLe(t,e){var r=this._id;return arguments.length<2?Fh(this.node(),r).on.on(t):this.each(MLe(r,t,e))}function OLe(t){return function(){var e=this.parentNode;for(var r in this.__transition)if(+r!==t)return;e&&e.removeChild(this)}}function NLe(){return this.on("end.remove",OLe(this._id))}function LLe(t){var e=this._name,r=this._id;typeof t!="function"&&(t=wL(t));for(var n=this._groups,i=n.length,a=new Array(i),s=0;s<i;++s)for(var o=n[s],c=o.length,f=a[s]=new Array(c),d,m,b=0;b<c;++b)(d=o[b])&&(m=t.call(d,d.__data__,b,o))&&("__data__"in d&&(m.__data__=d.__data__),f[b]=m,$3(f[b],e,r,b,f,Fh(d,r)));return new Ap(a,this._parents,e,r)}function FLe(t){var e=this._name,r=this._id;typeof t!="function"&&(t=Uee(t));for(var n=this._groups,i=n.length,a=[],s=[],o=0;o<i;++o)for(var c=n[o],f=c.length,d,m=0;m<f;++m)if(d=c[m]){for(var b=t.call(d,d.__data__,m,c),x,E=Fh(d,r),T=0,A=b.length;T<A;++T)(x=b[T])&&$3(x,e,r,T,b,E);a.push(b),s.push(d)}return new Ap(a,s,e,r)}var BLe=t2.prototype.constructor;function zLe(){return new BLe(this._groups,this._parents)}function jLe(t,e){var r,n,i;return function(){var a=t_(this,t),s=(this.style.removeProperty(t),t_(this,t));return a===s?null:a===r&&s===n?i:i=e(r=a,n=s)}}function lte(t){return function(){this.style.removeProperty(t)}}function ULe(t,e,r){var n,i=r+"",a;return function(){var s=t_(this,t);return s===i?null:s===n?a:a=e(n=s,r)}}function VLe(t,e,r){var n,i,a;return function(){var s=t_(this,t),o=r(this),c=o+"";return o==null&&(c=o=(this.style.removeProperty(t),t_(this,t))),s===c?null:s===n&&c===i?a:(i=c,a=e(n=s,o))}}function $Le(t,e){var r,n,i,a="style."+e,s="end."+a,o;return function(){var c=Dd(this,t),f=c.on,d=c.value[a]==null?o||(o=lte(e)):void 0;(f!==r||i!==d)&&(n=(r=f).copy()).on(s,i=d),c.on=n}}function qLe(t,e,r){var n=(t+="")=="transform"?WNe:ste;return e==null?this.styleTween(t,jLe(t,n)).on("end.style."+t,lte(t)):typeof e=="function"?this.styleTween(t,VLe(t,n,AL(this,"style."+t,e))).each($Le(this._id,t)):this.styleTween(t,ULe(t,n,e),r).on("end.style."+t,null)}function HLe(t,e,r){return function(n){this.style.setProperty(t,e.call(this,n),r)}}function GLe(t,e,r){var n,i;function a(){var s=e.apply(this,arguments);return s!==i&&(n=(i=s)&&HLe(t,s,r)),n}return a._value=e,a}function WLe(t,e,r){var n="style."+(t+="");if(arguments.length<2)return(n=this.tween(n))&&n._value;if(e==null)return this.tween(n,null);if(typeof e!="function")throw new Error;return this.tween(n,GLe(t,e,r??""))}function XLe(t){return function(){this.textContent=t}}function YLe(t){return function(){var e=t(this);this.textContent=e??""}}function ZLe(t){return this.tween("text",typeof t=="function"?YLe(AL(this,"text",t)):XLe(t==null?"":t+""))}function KLe(t){return function(e){this.textContent=t.call(this,e)}}function JLe(t){var e,r;function n(){var i=t.apply(this,arguments);return i!==r&&(e=(r=i)&&KLe(i)),e}return n._value=t,n}function QLe(t){var e="text";if(arguments.length<1)return(e=this.tween(e))&&e._value;if(t==null)return this.tween(e,null);if(typeof t!="function")throw new Error;return this.tween(e,JLe(t))}function e6e(){for(var t=this._name,e=this._id,r=ute(),n=this._groups,i=n.length,a=0;a<i;++a)for(var s=n[a],o=s.length,c,f=0;f<o;++f)if(c=s[f]){var d=Fh(c,e);$3(c,t,r,f,s,{time:d.time+d.delay+d.duration,delay:0,duration:d.duration,ease:d.ease})}return new Ap(n,this._parents,t,r)}function t6e(){var t,e,r=this,n=r._id,i=r.size();return new Promise(function(a,s){var o={value:s},c={value:function(){--i===0&&a()}};r.each(function(){var f=Dd(this,n),d=f.on;d!==t&&(e=(t=d).copy(),e._.cancel.push(o),e._.interrupt.push(o),e._.end.push(c)),f.on=e}),i===0&&a()})}var r6e=0;function Ap(t,e,r,n){this._groups=t,this._parents=e,this._name=r,this._id=n}function ute(){return++r6e}var rp=t2.prototype;Ap.prototype={constructor:Ap,select:LLe,selectAll:FLe,selectChild:rp.selectChild,selectChildren:rp.selectChildren,filter:PLe,merge:kLe,selection:zLe,transition:e6e,call:rp.call,nodes:rp.nodes,node:rp.node,size:rp.size,empty:rp.empty,each:rp.each,on:DLe,attr:dLe,attrTween:vLe,style:qLe,styleTween:WLe,text:ZLe,textTween:QLe,remove:NLe,tween:oLe,delay:xLe,duration:ELe,ease:CLe,easeVarying:ILe,end:t6e,[Symbol.iterator]:rp[Symbol.iterator]};function n6e(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}var i6e={time:null,delay:0,duration:250,ease:n6e};function a6e(t,e){for(var r;!(r=t.__transition)||!(r=r[e]);)if(!(t=t.parentNode))throw new Error(`transition ${e} not found`);return r}function o6e(t){var e,r;t instanceof Ap?(e=t._id,t=t._name):(e=ute(),(r=i6e).time=TL(),t=t==null?null:t+"");for(var n=this._groups,i=n.length,a=0;a<i;++a)for(var s=n[a],o=s.length,c,f=0;f<o;++f)(c=s[f])&&$3(c,t,e,f,s,r||a6e(c,e));return new Ap(n,this._parents,t,e)}t2.prototype.interrupt=nLe;t2.prototype.transition=o6e;var _H={},wP={},SP=34,w1=10,EP=13;function cte(t){return new Function("d","return {"+t.map(function(e,r){return JSON.stringify(e)+": d["+r+'] || ""'}).join(",")+"}")}function s6e(t,e){var r=cte(t);return function(n,i){return e(r(n),i,t)}}function bH(t){var e=Object.create(null),r=[];return t.forEach(function(n){for(var i in n)i in e||r.push(e[i]=i)}),r}function Ic(t,e){var r=t+"",n=r.length;return n<e?new Array(e-n+1).join(0)+r:r}function l6e(t){return t<0?"-"+Ic(-t,6):t>9999?"+"+Ic(t,6):Ic(t,4)}function u6e(t){var e=t.getUTCHours(),r=t.getUTCMinutes(),n=t.getUTCSeconds(),i=t.getUTCMilliseconds();return isNaN(t)?"Invalid Date":l6e(t.getUTCFullYear())+"-"+Ic(t.getUTCMonth()+1,2)+"-"+Ic(t.getUTCDate(),2)+(i?"T"+Ic(e,2)+":"+Ic(r,2)+":"+Ic(n,2)+"."+Ic(i,3)+"Z":n?"T"+Ic(e,2)+":"+Ic(r,2)+":"+Ic(n,2)+"Z":r||e?"T"+Ic(e,2)+":"+Ic(r,2)+"Z":"")}function c6e(t){var e=new RegExp('["'+t+`
\r]`),r=t.charCodeAt(0);function n(m,b){var x,E,T=i(m,function(A,M){if(x)return x(A,M-1);E=A,x=b?s6e(A,b):cte(A)});return T.columns=E||[],T}function i(m,b){var x=[],E=m.length,T=0,A=0,M,F=E<=0,N=!1;m.charCodeAt(E-1)===w1&&--E,m.charCodeAt(E-1)===EP&&--E;function O(){if(F)return wP;if(N)return N=!1,_H;var j,H=T,W;if(m.charCodeAt(H)===SP){for(;T++<E&&m.charCodeAt(T)!==SP||m.charCodeAt(++T)===SP;);return(j=T)>=E?F=!0:(W=m.charCodeAt(T++))===w1?N=!0:W===EP&&(N=!0,m.charCodeAt(T)===w1&&++T),m.slice(H+1,j-1).replace(/""/g,'"')}for(;T<E;){if((W=m.charCodeAt(j=T++))===w1)N=!0;else if(W===EP)N=!0,m.charCodeAt(T)===w1&&++T;else if(W!==r)continue;return m.slice(H,j)}return F=!0,m.slice(H,E)}for(;(M=O())!==wP;){for(var U=[];M!==_H&&M!==wP;)U.push(M),M=O();b&&(U=b(U,A++))==null||x.push(U)}return x}function a(m,b){return m.map(function(x){return b.map(function(E){return d(x[E])}).join(t)})}function s(m,b){return b==null&&(b=bH(m)),[b.map(d).join(t)].concat(a(m,b)).join(`
`)}function o(m,b){return b==null&&(b=bH(m)),a(m,b).join(`
`)}function c(m){return m.map(f).join(`
`)}function f(m){return m.map(d).join(t)}function d(m){return m==null?"":m instanceof Date?u6e(m):e.test(m+="")?'"'+m.replace(/"/g,'""')+'"':m}return{parse:n,parseRows:i,format:s,formatBody:o,formatRows:c,formatRow:f,formatValue:d}}var f6e=c6e(","),h6e=f6e.parse;function d6e(t){if(!t.ok)throw new Error(t.status+" "+t.statusText);return t.text()}function fte(t,e){return fetch(t,e).then(d6e)}function p6e(t){return function(e,r,n){return arguments.length===2&&typeof r=="function"&&(n=r,r=void 0),fte(e,r).then(function(i){return t(i,n)})}}var g6e=p6e(h6e);function m6e(t){if(!t.ok)throw new Error(t.status+" "+t.statusText);if(!(t.status===204||t.status===205))return t.json()}function y6e(t,e){return fetch(t,e).then(m6e)}function v6e(t){return(e,r)=>fte(e,r).then(n=>new DOMParser().parseFromString(n,t))}const _6e=v6e("application/xml");function Z1(t,e,r){this.k=t,this.x=e,this.y=r}Z1.prototype={constructor:Z1,scale:function(t){return t===1?this:new Z1(this.k*t,this.x,this.y)},translate:function(t,e){return t===0&e===0?this:new Z1(this.k,this.x+this.k*t,this.y+this.k*e)},apply:function(t){return[t[0]*this.k+this.x,t[1]*this.k+this.y]},applyX:function(t){return t*this.k+this.x},applyY:function(t){return t*this.k+this.y},invert:function(t){return[(t[0]-this.x)/this.k,(t[1]-this.y)/this.k]},invertX:function(t){return(t-this.x)/this.k},invertY:function(t){return(t-this.y)/this.k},rescaleX:function(t){return t.copy().domain(t.range().map(this.invertX,this).map(t.invert,t))},rescaleY:function(t){return t.copy().domain(t.range().map(this.invertY,this).map(t.invert,t))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};Z1.prototype;const xH=t=>{const[e,r]=te.useState();te.useEffect(()=>{if(!t.url)return;let i=null;t.format==="json"?i=y6e(t.url):t.format==="csv"?i=g6e(t.url):t.format==="xml"&&(i=_6e(t.url)),i&&i.then(a=>{if(t.format==="xml"){if(t.nodeType){const s=[];a.querySelectorAll(t.nodeType).forEach(o=>{typeof t.formatData=="function"&&s.push(t.formatData(o))}),r(s)}}else{let s=a;t.data_property&&(s=a[t.data_property]),typeof t.formatData=="function"?r(s.map(t.formatData)):r(s)}typeof t.onData=="function"&&t.onData()})},[t.url,t]);const n={data:e,setData:r};return J.jsx(wM,{value:n,children:t.children})};try{xH.displayName="SimpleDataProvider",xH.__docgenInfo={description:"",displayName:"SimpleDataProvider",props:{url:{defaultValue:null,description:"",name:"url",required:!0,type:{name:"string"}},format:{defaultValue:null,description:"",name:"format",required:!0,type:{name:"enum",value:[{value:'"json"'},{value:'"csv"'},{value:'"xml"'}]}},nodeType:{defaultValue:null,description:"",name:"nodeType",required:!0,type:{name:"string"}},data_property:{defaultValue:null,description:"",name:"data_property",required:!0,type:{name:"string"}},formatData:{defaultValue:null,description:"",name:"formatData",required:!1,type:{name:"((data: any) => any) | undefined"}},onData:{defaultValue:null,description:"",name:"onData",required:!0,type:{name:"() => void"}}}}}catch{}const IS=Ji(J.jsx("path",{d:"M12 4c4.41 0 8 3.59 8 8s-3.59 8-8 8-8-3.59-8-8 3.59-8 8-8m0-2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m1 10V8h-2v4H8l4 4 4-4z"})),PS=Ji(J.jsx("path",{d:"M12 20c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8m0 2c5.52 0 10-4.48 10-10S17.52 2 12 2 2 6.48 2 12s4.48 10 10 10m-1-10v4h2v-4h3l-4-4-4 4z"})),TP=Ji(J.jsx("path",{d:"M5 15H3v4c0 1.1.9 2 2 2h4v-2H5zM5 5h4V3H5c-1.1 0-2 .9-2 2v4h2zm14-2h-4v2h4v4h2V5c0-1.1-.9-2-2-2m0 16h-4v2h4c1.1 0 2-.9 2-2v-4h-2zM12 8c-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4-1.79-4-4-4m0 6c-1.1 0-2-.9-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2"})),b6e=t=>{let{transform:e}=t;return{...e,x:0}},np=Dr(Rc)({padding:"4px",marginTop:"-3px",background:"none","&:hover":{background:"none"}});function kM(t){const e=iMe(),r=va({mapId:void 0});function n(m){const b=m.id&&r.map?.getLayer(m.id)?.source?r.map?.getLayer(m.id)?.source:void 0;let x=null;switch(m.type){case"geojson":if(m.config?.geojson)r.map?.fitBounds(mf(m.config?.geojson),t.fitBoundsOptions);else{if(!b)return;const E={type:"FeatureCollection",features:r.map?.querySourceFeatures(b)};E.features.length===0&&(r.map?.zoomTo(1),E.features=r.map?.querySourceFeatures(b)),x=mf(E)}break;case"vt":console.log("vt");break;case"wms":x=m?.config?.config?.layers?.[0]?.EX_GeographicBoundingBox;break;default:return}x&&r.map?.fitBounds(x,t.fitBoundsOptions)}const i=te.useMemo(()=>["order-background",...[...e.layers].map((b,x)=>"content_order_"+x),"order-labels"],[e.layers]),a=te.useMemo(()=>t.layers?t.layers:e?.layers?e.layers:[],[t.layers,e.layers]),s=te.useMemo(()=>t.setLayers?t.setLayers:e.setLayers,[t.setLayers,e.setLayers]),o=iq(cL,{activationConstraint:{distance:5}}),c=iq(WQ,{activationConstraint:{distance:5}}),f=XIe(c,o);function d(m){const b=m.active.id,x=m.over?.data?.current?.sortable.index;e.moveLayer(String(b),()=>x)}return J.jsxs(J.Fragment,{children:[J.jsx(UE,{layerIds:i,insertBeforeLayer:"_background"}),e?.symbolLayers?.length>0&&J.jsx(dp,{layerComponent:J.jsx(R0,{...e.vtLayerConfig,layers:e.symbolLayers,mapId:t?.mapId,insertBeforeLayer:"order-labels"}),setLayerState:m=>e.setSymbolLayers(m?.layers),visible:!0,configurable:!0,type:"layer",name:"Labels"},"background_labels"),J.jsx(KPe,{collisionDetection:QIe,sensors:f,onDragEnd:m=>d(m),modifiers:[b6e],children:J.jsxs(cke,{items:a,strategy:lke,children:[[...a].map((m,b)=>{if(!m?.id)return null;switch(m.type){case"geojson":return J.jsx(dp,{layerId:m.id,sortable:t.sortable,name:m?.name||m?.config?.type+" layer"||"unnamed layer",layerComponent:J.jsx(Nc,{...m.config,mapId:t?.mapId,layerId:m.id,insertBeforeLayer:"content_order_"+(a.length-1-b)}),buttons:J.jsxs(J.Fragment,{children:[J.jsx(np,{disabled:b===a.length-1,onClick:()=>{e.moveDown(m.id||"")},children:J.jsx(IS,{})}),J.jsx(np,{disabled:b===0,onClick:()=>{e.moveUp(m.id||"")},children:J.jsx(PS,{})}),J.jsx(np,{onClick:()=>n(m),children:J.jsx(TP,{})})]}),setLayerState:x=>s?.(E=>{const T=[...E];return x===!1?T.splice(b,1):T[b].config=x,T}),configurable:!0,showDeleteButton:!0},m.id);case"wms":return J.jsx(J.Fragment,{children:te.createElement(dM,{...m.config,key:m.id,layerId:m.id,sortable:t.sortable,mapId:t?.mapId,insertBeforeLayer:"content_order_"+(a.length-1-b),onConfigChange:x=>{s?.(E=>{const T=[...E];return x===!1?T.splice(b,1):T[b].config.config=x,T})},featureInfoActive:m?.config?.featureInfoActive||!1,setFeatureInfoActive:x=>{s?.(E=>{const T=[...E];return typeof x=="function"&&(T[b].config.featureInfoActive=x(T[b].config?.featureInfoActive||!1)),T})},showDeleteButton:!0,buttons:J.jsxs(J.Fragment,{children:[J.jsx(np,{disabled:b===a.length-1,onClick:()=>{e.moveDown(m.id||"")},children:J.jsx(IS,{})}),J.jsx(np,{disabled:b===0,onClick:()=>{e.moveUp(m.id||"")},children:J.jsx(PS,{})}),J.jsx(np,{onClick:()=>n(m),children:J.jsx(TP,{})})]})})});case"vt":return J.jsx(gt.Fragment,{children:J.jsx(dp,{name:m?.name||m?.type+" layer"||"unnamed layer",layerComponent:J.jsx(R0,{layers:m?.config?.layers||[],mapId:m?.config.mapId,sourceOptions:m?.config?.sourceOptions,layerId:m.id,url:m?.config?.url},m.id),buttons:J.jsxs(J.Fragment,{children:[J.jsx(np,{disabled:b===a.length-1,onClick:()=>{e.moveDown(m.id||"")},children:J.jsx(IS,{})},m.id+"_button1"),J.jsx(np,{disabled:b===0,onClick:()=>{e.moveUp(m.id||"")},children:J.jsx(PS,{})},m.id+"_button2"),J.jsx(np,{onClick:()=>n(m),children:J.jsx(TP,{})})]}),setLayerState:x=>s?.(E=>{const T=[...E];return x===!1?T.splice(b,1):T[b].config=x,T}),configurable:!0,showDeleteButton:!0},m.id)},m?.id+"_listItem");default:return null}}),e?.backgroundLayers?.length>0&&J.jsx(dp,{layerComponent:J.jsx(R0,{...e.vtLayerConfig,layers:e.backgroundLayers,mapId:t?.mapId,insertBeforeLayer:"order-background"}),setLayerState:m=>{e.setBackgroundLayers(m?.layers)},visible:!0,configurable:!0,type:"layer",name:"Background"},"background_geometry")]})})]})}kM.defaultProps={mapId:void 0};try{kM.displayName="LayerListItemFactory",kM.__docgenInfo={description:"",displayName:"LayerListItemFactory",props:{mapId:{defaultValue:{value:"undefined"},description:"",name:"mapId",required:!1,type:{name:"string | undefined"}},layers:{defaultValue:null,description:"",name:"layers",required:!0,type:{name:"LayerConfig[]"}},setLayers:{defaultValue:null,description:"",name:"setLayers",required:!1,type:{name:"((layers: LayerConfig[] | ((state: LayerConfig[]) => LayerConfig[])) => void) | undefined"}},insertBeforeLayer:{defaultValue:null,description:"",name:"insertBeforeLayer",required:!1,type:{name:"string | undefined"}},sortable:{defaultValue:null,description:"",name:"sortable",required:!1,type:{name:"boolean | undefined"}},fitBoundsOptions:{defaultValue:null,description:"",name:"fitBoundsOptions",required:!1,type:{name:"FitBoundsOptions | undefined"}}}}}catch{}const x6e=Ji(J.jsx("path",{d:"M14 10H3v2h11zm0-4H3v2h11zm4 8v-4h-2v4h-4v2h4v4h2v-4h4v-2zM3 16h7v-2H3z"})),w6e=["fill","line","circle"];function RM(t){const[e,r]=gt.useState({type:"circle"}),n=te.useMemo(()=>!(!e?.type||!e?.geojson),[e]);return J.jsxs(J.Fragment,{children:[J.jsx(by,{children:"GeoJSON layer"}),J.jsxs(sf,{fullWidth:!0,children:[J.jsx(_g,{id:"type-label",children:"Type"}),J.jsx(bg,{labelId:"type-label",value:e.type,label:"Type",onChange:i=>r(a=>({...a,type:i.target.value})),children:w6e.map(i=>J.jsx(Fm,{value:i,children:i},i))})]}),J.jsx(sf,{fullWidth:!0,children:J.jsxs(ta,{variant:"contained",component:"label",sx:{marginTop:"10px"},children:["Upload File",J.jsx("input",{type:"file",hidden:!0,onChange:i=>{i.target.files?.[0].text().then(a=>r(s=>({...s,geojson:JSON.parse(a)})))}})]})}),J.jsxs(Ox,{children:[J.jsx(ta,{onClick:t.onCancel,children:"Cancel"}),J.jsx(ta,{disabled:!n,onClick:()=>t.onSubmit(e),children:"Add"})]})]})}try{RM.displayName="GeoJsonLayerForm",RM.__docgenInfo={description:"",displayName:"GeoJsonLayerForm",props:{config:{defaultValue:null,description:"",name:"config",required:!1,type:{name:"MlGeoJsonLayerProps | undefined"}},onSubmit:{defaultValue:null,description:"",name:"onSubmit",required:!0,type:{name:"(config: MlGeoJsonLayerProps) => void"}},onCancel:{defaultValue:null,description:"",name:"onCancel",required:!0,type:{name:"() => void"}}}}}catch{}const S6e=Ji([J.jsx("path",{d:"M8 8H6v7c0 1.1.9 2 2 2h9v-2H8z"},"0"),J.jsx("path",{d:"M20 3h-8c-1.1 0-2 .9-2 2v6c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2m0 8h-8V7h8zM4 12H2v7c0 1.1.9 2 2 2h9v-2H4z"},"1")]),KE=t=>J.jsxs(J.Fragment,{children:[J.jsx(by,{children:t.layerTypes.length>1?"Select a layer type":"Load new layer"}),J.jsx(Mh,{children:t.layerTypes.map((e,r)=>J.jsx(Gf,{disableGutters:!0,children:J.jsxs(mY,{autoFocus:!0,onClick:()=>{t.onSelect(e)},children:[J.jsx(vY,{children:J.jsx(iY,{children:J.jsx(S6e,{})})}),J.jsx(Lf,{primary:e})]})},r))})]});KE.defaultProps={};try{KE.displayName="LayerTypeForm",KE.__docgenInfo={description:"",displayName:"LayerTypeForm",props:{onSelect:{defaultValue:null,description:"",name:"onSelect",required:!0,type:{name:"(type: string) => void"}},layerTypes:{defaultValue:null,description:"",name:"layerTypes",required:!0,type:{name:"string[]"}}}}}catch{}function MM(t){const[e,r]=gt.useState({url:""}),n=te.useMemo(()=>!!e?.url,[e]);return J.jsxs(J.Fragment,{children:[J.jsx(by,{children:"WMS layer"}),J.jsx(cO,{children:J.jsxs(sf,{fullWidth:!0,sx:{marginTop:"10px"},children:[J.jsx(_g,{htmlFor:"wms-url-input",children:"WMS URL"}),J.jsx(QT,{id:"wms-url-input",label:"WMS URL",value:e.url,onChange:i=>r({...e,url:i.target.value})})]})}),J.jsxs(Ox,{children:[J.jsx(ta,{onClick:t.onCancel,children:"Cancel"}),J.jsx(ta,{disabled:!n,onClick:()=>t.onSubmit(e),children:"Add"})]})]})}try{MM.displayName="WmsLayerForm",MM.__docgenInfo={description:"",displayName:"WmsLayerForm",props:{onSubmit:{defaultValue:null,description:"",name:"onSubmit",required:!0,type:{name:"(config: wmsConfig) => void"}},onCancel:{defaultValue:null,description:"",name:"onCancel",required:!0,type:{name:"() => void"}}}}}catch{}const hte=Ji(J.jsx("path",{d:"M19 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2m-2 10h-4v4h-2v-4H7v-2h4V7h2v4h4z"})),dte=Ji(J.jsx("path",{d:"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2m-2 10H7v-2h10z"})),E6e=["latfield","lonfield","delimiter"];function DM(t){const[e,r]=te.useState(!1);return J.jsxs(J.Fragment,{children:[J.jsx(Ss,{children:" Options "}),J.jsx(ta,{onClick:()=>r(!e),children:e?J.jsx(dte,{}):J.jsx(hte,{})}),J.jsx(Mh,{children:e&&E6e?.map(n=>J.jsxs(J.Fragment,{children:[J.jsx(Gf,{children:J.jsxs(Ss,{children:[" ",n," "]})}),J.jsx(Gf,{children:J.jsx(e3,{size:"small",onChange:i=>{const a={};a[n]=i.target.value,t.setter(a)}})})]}))})]})}try{DM.displayName="CSVOptionsFormular",DM.__docgenInfo={description:"",displayName:"CSVOptionsFormular",props:{setter:{defaultValue:null,description:"",name:"setter",required:!0,type:{name:"any"}}}}}catch{}const T6e=["completeFeature","allFeatures","renderTagged","excludeWay","suppressWay"];function OM(t){const[e,r]=te.useState(!1);return J.jsxs(J.Fragment,{children:[J.jsx(Ss,{children:" Options "}),J.jsx(ta,{onClick:()=>r(!e),children:e?J.jsx(dte,{}):J.jsx(hte,{})}),J.jsx(Mh,{children:e&&T6e?.map(n=>J.jsx(J.Fragment,{children:J.jsxs(Gf,{children:[J.jsxs(Ss,{children:[" ",n," "]}),J.jsx($0,{onChange:i=>{const a={};a[n]=i.target.value==="on",t.setter(a)}})]})}))})]})}try{OM.displayName="OsmOptionsFomular",OM.__docgenInfo={description:"",displayName:"OsmOptionsFomular",props:{setter:{defaultValue:null,description:"",name:"setter",required:!0,type:{name:"any"}}}}}catch{}const C6e={csv:xMe,topojson:aDe,osm:rDe,gpx:_P,kml:_P,tcx:_P},A6e=["fill","line","circle"];function NM(t){const[e,r]=te.useState({type:"circle"}),[n,i]=te.useState(),[a,s]=te.useState(),[o,c]=te.useState({}),f=va({mapId:t.mapId}),d="?"+new URLSearchParams(o).toString();VE({protocol:t.originType,handler:C6e[t.originType]});const m=te.useMemo(()=>e?.type?!!(a&&n):!1,[e,a,n]);te.useEffect(()=>(typeof n<"u"&&typeof a<"u"&&(f.map?.getSource(n)||f.map?.addSource(n,{type:"geojson",data:o?t.originType+"://"+a+d:t.originType+"://"+a}),e.options={source:n}),()=>{}),[n,f.map,a]),te.useEffect(()=>{a&&n&&f.map?.getLayer(n)&&URL.revokeObjectURL(a)},[n,a,f.map]);function b(x){const E={...o,...x};return c(E)}return J.jsxs(J.Fragment,{children:[J.jsxs(by,{children:["Layer from ",t.originType]}),J.jsxs(sf,{fullWidth:!0,children:[J.jsx(_g,{id:"type-label",children:"Type"}),J.jsx(bg,{labelId:"type-label",value:e.type,label:"Type",onChange:x=>r(E=>({...E,type:x.target.value})),children:A6e.map(x=>J.jsx(Fm,{value:x,children:x},x))})]}),J.jsxs(sf,{fullWidth:!0,children:[J.jsxs(ta,{variant:"contained",component:"label",sx:{marginTop:"10px"},children:["Select origin file",J.jsx("input",{type:"file",hidden:!0,accept:t.originType,onChange:x=>{if(i(x.target.files?.[0].name),x.target.files?.[0]){const E=URL.createObjectURL(x.target.files?.[0]);s(E)}}})]}),t.originType==="csv"&&J.jsx(DM,{setter:b}),t.originType==="osm"&&J.jsx(OM,{setter:b})]}),J.jsxs(Ox,{children:[J.jsx(ta,{onClick:t.onCancel,children:"Cancel"}),J.jsx(ta,{disabled:!m,onClick:()=>t.onSubmit(e),children:"Add"})]})]})}try{NM.displayName="ProtocolHandlerLayerForm",NM.__docgenInfo={description:"",displayName:"ProtocolHandlerLayerForm",props:{originType:{defaultValue:null,description:"",name:"originType",required:!0,type:{name:"string"}},config:{defaultValue:null,description:"",name:"config",required:!1,type:{name:"MlGeoJsonLayerProps | undefined"}},mapId:{defaultValue:null,description:"",name:"mapId",required:!1,type:{name:"string | undefined"}},onSubmit:{defaultValue:null,description:"",name:"onSubmit",required:!0,type:{name:"(config: MlGeoJsonLayerProps) => void"}},onCancel:{defaultValue:null,description:"",name:"onCancel",required:!0,type:{name:"() => void"}}}}}catch{}const I6e=["id","type","metadata","source","source-layer","layout","paint","options"];function LM(t){const[e,r]=te.useState([]),n={},i=["paint","layout","options","metadata"];te.useEffect(()=>{t.setter(e)},[e]);const a=()=>J.jsx(J.Fragment,{children:I6e.map(o=>J.jsx(gt.Fragment,{children:J.jsx(e3,{label:o,onChange:c=>n[o]=c.target.value})},o+"_fragment"))});function s(){i.map(o=>{if(typeof n[o]<"u")try{n[o]=JSON.parse(n[o])}catch{alert("Invalid JSON format, try again")}}),r(o=>o.length>0?[n,...o]:[n])}return J.jsxs(J.Fragment,{children:[J.jsx(sf,{fullWidth:!0,children:J.jsx(a,{})}),J.jsx(ta,{onClick:s,children:" Add"})]})}try{LM.displayName="MbtilesLayerPropFormular",LM.__docgenInfo={description:"",displayName:"MbtilesLayerPropFormular",props:{setter:{defaultValue:null,description:"",name:"setter",required:!0,type:{name:"Dispatch<SetStateAction<LayerSpecification[]>>"}}}}}catch{}const P6e=Ji(J.jsx("path",{d:"M7.41 8.59 12 13.17l4.59-4.58L18 10l-6 6-6-6z"})),k6e=Ji(J.jsx("path",{d:"M7.41 15.41 12 10.83l4.59 4.58L18 14l-6-6-6 6z"}));function FM(t){const[e,r]=gt.useState(t.config),[n,i]=te.useState(),[a,s]=te.useState(),[o,c]=te.useState([]),f=va({mapId:t.mapId}),[d,m]=te.useState(!1);console.log(o);const b=()=>J.jsx(J.Fragment,{children:o.map((E,T)=>J.jsxs(Ss,{variant:"body2",children:[T+1,": ",JSON.stringify(E)]},T))}),x=te.useMemo(()=>!!n,[n]);return te.useEffect(()=>{typeof n<"u"&&typeof a<"u"&&r({url:"mbtiles://"+a+"/{z}/{x}/{y}",layers:o,layerId:n,sourceOptions:{type:"vector",minzoom:0,maxzoom:1}})},[n,f.map,a,o]),J.jsxs(J.Fragment,{children:[J.jsx(by,{children:" Layer from mbtiles file"}),J.jsxs(cO,{children:[J.jsxs(ta,{variant:"contained",component:"label",sx:{marginTop:"10px"},children:["Select origin file",J.jsx("input",{type:"file",hidden:!0,accept:t.originType,onChange:E=>{if(i(E.target.files?.[0].name),E.target.files?.[0]){const T=URL.createObjectURL(E.target.files?.[0]);s(T)}}})]}),J.jsxs(Uce,{expanded:d,children:[J.jsxs(sfe,{"aria-controls":"panel1d-content",id:"panel1d-header",children:[J.jsx(Ss,{children:"MB-Tile Layer properties"}),J.jsx(ta,{onClick:()=>m(!d),children:d?J.jsx(k6e,{}):J.jsx(P6e,{})})]}),J.jsx(Ss,{variant:"body1",children:" Layers"}),o.length>0?J.jsx(b,{}):J.jsx(Ss,{variant:"body2",children:" 0 "}),J.jsx(LM,{setter:c})]})]}),J.jsxs(Ox,{children:[J.jsx(ta,{onClick:t.onCancel,children:"Cancel"}),J.jsx(ta,{disabled:!x,onClick:()=>t.onSubmit(e),children:"Add"})]})]})}try{FM.displayName="MbtilesLayerForm",FM.__docgenInfo={description:"",displayName:"MbtilesLayerForm",props:{originType:{defaultValue:null,description:"",name:"originType",required:!0,type:{name:"string"}},config:{defaultValue:null,description:"",name:"config",required:!0,type:{name:"MlVectorTileLayerProps"}},mapId:{defaultValue:null,description:"",name:"mapId",required:!1,type:{name:"string | undefined"}},onSubmit:{defaultValue:null,description:"",name:"onSubmit",required:!0,type:{name:"(config: MlVectorTileLayerProps) => void"}},onCancel:{defaultValue:null,description:"",name:"onCancel",required:!0,type:{name:"() => void"}}}}}catch{}const JE=t=>{const[e,r]=te.useState(t?.config),[n,i]=te.useState(),a=t.layerTypes,s=a.filter(m=>m!=="wms"&&m!=="geojson"&&m!=="mbtiles"),o=["wms","geojson","vt","csv","mbtiles","topojson","osm","gpx","kml","tcx"],c=m=>{i(m),s.includes(m)?r({type:"geojson",config:{}}):r(m==="mbtiles"?{type:"vt",config:{layers:[]}}:{type:m,config:{}})},f=()=>{t.setOpen(!1),r(void 0)},d=()=>J.jsx(J.Fragment,{children:s.map((m,b)=>J.jsx(J.Fragment,{children:e?.type==="geojson"&&n===m&&J.jsx(NM,{originType:m,onSubmit:x=>{t?.onComplete?.({...e,config:x,type:"geojson"}),f()},onCancel:f},b)}))});return J.jsxs(uO,{open:t.open,onClose:f,children:[!e?.type&&J.jsx(KE,{onSelect:m=>{o.includes(m)&&c(m)},layerTypes:a}),e?.type==="geojson"&&n==="geojson"&&J.jsx(RM,{onSubmit:m=>{t?.onComplete?.({...e,config:m}),f()},onCancel:f}),e?.type==="wms"&&J.jsx(MM,{onSubmit:m=>{t?.onComplete?.({...e,config:m}),f()},onCancel:f}),e?.type==="vt"&&n!==void 0&&J.jsx(FM,{config:e,originType:n,onSubmit:m=>{e&&(t?.onComplete?.({...e,config:m}),f())},onCancel:f}),J.jsx(d,{},"protocol")]})};JE.defaultProps={};try{JE.displayName="AddLayerPopup",JE.__docgenInfo={description:"",displayName:"AddLayerPopup",props:{open:{defaultValue:null,description:"",name:"open",required:!0,type:{name:"boolean"}},config:{defaultValue:null,description:"",name:"config",required:!1,type:{name:"LayerConfig | undefined"}},layerTypes:{defaultValue:null,description:"",name:"layerTypes",required:!0,type:{name:"string[]"}},setOpen:{defaultValue:null,description:"",name:"setOpen",required:!0,type:{name:"(open: boolean) => void"}},onChange:{defaultValue:null,description:"",name:"onChange",required:!1,type:{name:"((config: LayerConfig) => void) | undefined"}},onComplete:{defaultValue:null,description:"",name:"onComplete",required:!1,type:{name:"((config: LayerConfig) => void) | undefined"}}}}}catch{}const BM=t=>{const[e,r]=gt.useState(!1),n=t.layerTypes||["geojson","wms","csv","topojson","osm","gpx","kml","tcx"];return J.jsxs(J.Fragment,{children:[J.jsx(ta,{variant:"contained",sx:{marginTop:"10px",...t.sx},onClick:()=>r(!0),children:J.jsx(x6e,{})}),J.jsx(JE,{open:e,setOpen:r,onComplete:t?.onComplete,layerTypes:n})]})};BM.defaultProps={};try{BM.displayName="AddLayerButton",BM.__docgenInfo={description:"",displayName:"AddLayerButton",props:{sx:{defaultValue:null,description:"",name:"sx",required:!1,type:{name:"SxProps | undefined"}},layerTypes:{defaultValue:null,description:`An string array, to filter the supported file types that would be shown to the user
Default is: ['geojson', 'wms', 'csv', 'topojson', 'osm', 'gpx', 'kml', 'tcx']`,name:"layerTypes",required:!1,type:{name:"string[] | undefined"}},onComplete:{defaultValue:null,description:"",name:"onComplete",required:!1,type:{name:"((config: LayerConfig) => void) | undefined"}}}}}catch{}const R6e=Ji(J.jsx("path",{d:"M3 18h18v-2H3zm0-5h18v-2H3zm0-7v2h18V6z"})),IL="https://mapcomponents.github.io/react-map-components-maplibre/react-maplibre/",M6e=IL+"assets/WG-MapComponents-Logo_rgb.svg",D6e=IL+"assets/WG-MapComponents-Logo_rgb-weisse-schrift.svg",O6e=IL+"assets/mapcomponents_logo.png";function wH(t){const e=Bc(),[r,n]=te.useState(null),i=s=>{n(s.currentTarget)},a=()=>{n(null)};return J.jsx(Pfe,{sx:{minHeight:"62px",position:"absolute",zIndex:1300,top:0},children:J.jsxs(Pye,{disableGutters:!0,children:[t.logo||J.jsxs(J.Fragment,{children:[J.jsx(Bo,{sx:{marginLeft:"25px",display:{xs:"none",md:"flex"},flexGrow:{md:"30"}},children:J.jsx("img",{src:e.palette.mode==="dark"?D6e:M6e,style:{width:"100%",maxWidth:"250px"}})}),J.jsx(Bo,{sx:{marginLeft:"25px",display:{xs:"flex",sm:"flex",md:"none"},flexGrow:{xs:"500"},mr:{sm:"0px"}},children:J.jsx("img",{src:O6e,width:"50px",height:"50px"})})]}),J.jsx(Bo,{sx:{flexGrow:1,display:{xs:"flex"}},children:t.unmovableButtons}),t.buttons?J.jsxs(Bo,{sx:{flexGrow:22,display:{xs:"flex",sm:"none"}},children:[J.jsx(Rc,{onClick:i,children:J.jsx(R6e,{})}),J.jsx(xY,{id:"menu-appbar",anchorEl:r,anchorOrigin:{vertical:"bottom",horizontal:"left"},keepMounted:!0,transformOrigin:{vertical:"top",horizontal:"left"},open:!!r,onClose:a,PaperProps:{elevation:24,sx:{overflow:"visible",mt:"15px"}},sx:{display:{xs:"block",sm:"none"}},children:J.jsx(Bo,{sx:{paddingLeft:"10px",paddingRight:"10px"},onClick:a,children:t.buttons})})]}):"",J.jsx(Bo,{sx:{marginRight:"25px",display:{xs:"none",sm:"flex"}},children:t.buttons})]})})}try{wH.displayName="TopToolbar",wH.__docgenInfo={description:"",displayName:"TopToolbar",props:{unmovableButtons:{defaultValue:null,description:"",name:"unmovableButtons",required:!1,type:{name:"ReactNode"}},buttons:{defaultValue:null,description:"",name:"buttons",required:!1,type:{name:"ReactNode"}},logo:{defaultValue:null,description:"",name:"logo",required:!1,type:{name:"ReactNode"}}}}}catch{}const N6e=Ji(J.jsx("path",{d:"M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12zm-1 4 6 6v10c0 1.1-.9 2-2 2H7.99C6.89 23 6 22.1 6 21l.01-14c0-1.1.89-2 1.99-2zm-1 7h5.5L14 6.5z"}));function SH(t){const e=te.useRef(null),r=()=>{if(!e.current)return!1;const i=e.current?.files?.[0];if(!i)return!1;const a=new FileReader;a.onload=s=>{s&&typeof t.setData=="function"&&t.setData(s.currentTarget?.result)},a.readAsText(i)},n=()=>{e.current&&e.current.click()};return J.jsxs(J.Fragment,{children:[t.buttonComponent?gt.cloneElement(t.buttonComponent,{onClick:n}):J.jsx(ta,{onClick:n,children:J.jsx(N6e,{})}),J.jsx("input",{ref:e,onChange:r,type:"file",accept:t.accept,id:"input",multiple:!0,style:{display:"none"}})]})}try{SH.displayName="UploadButton",SH.__docgenInfo={description:"",displayName:"UploadButton",props:{setData:{defaultValue:null,description:"",name:"setData",required:!0,type:{name:"(data: string) => void"}},buttonComponent:{defaultValue:null,description:"",name:"buttonComponent",required:!0,type:{name:"any"}},accept:{defaultValue:null,description:"",name:"accept",required:!1,type:{name:"string | undefined"}}}}}catch{}const QE=t=>{const e=()=>{t.setOpen(!1)};return J.jsxs(uO,{open:t.open,onClose:e,PaperProps:{sx:{padding:"20px"}},children:[J.jsx(by,{children:"Select a style"}),J.jsx(Mh,{children:t?.styles?.map(r=>J.jsx(Gf,{disableGutters:!0,children:J.jsxs(mY,{autoFocus:!0,onClick:()=>{t?.onSelect?.(r)},children:[J.jsx(vY,{children:J.jsx(iY,{sx:{width:"50px",height:"50px"},alt:r.name,src:r?.name&&t?.styleThumbnailPaths?.[r.name]})}),J.jsx(Lf,{primary:r.name})]})},r.name))})]})};QE.defaultProps={styleThumbnailPaths:{}};try{QE.displayName="SelectStylePopup",QE.__docgenInfo={description:"",displayName:"SelectStylePopup",props:{open:{defaultValue:null,description:"",name:"open",required:!0,type:{name:"boolean"}},setOpen:{defaultValue:null,description:"",name:"setOpen",required:!0,type:{name:"(open: boolean) => void"}},styles:{defaultValue:null,description:"",name:"styles",required:!1,type:{name:"StyleSpecification[] | undefined"}},onSelect:{defaultValue:null,description:"",name:"onSelect",required:!1,type:{name:"((style: StyleSpecification) => void) | undefined"}},styleThumbnailPaths:{defaultValue:{value:"{}"},description:"",name:"styleThumbnailPaths",required:!1,type:{name:"{ [key: string]: string; } | undefined"}}}}}catch{}const L6e=Ji(J.jsx("path",{d:"M4 4h7V2H4c-1.1 0-2 .9-2 2v7h2zm6 9-4 5h12l-3-4-2.03 2.71zm7-4.5c0-.83-.67-1.5-1.5-1.5S14 7.67 14 8.5s.67 1.5 1.5 1.5S17 9.33 17 8.5M20 2h-7v2h7v7h2V4c0-1.1-.9-2-2-2m0 18h-7v2h7c1.1 0 2-.9 2-2v-7h-2zM4 13H2v7c0 1.1.9 2 2 2h7v-2H4z"})),F6e={version:8,name:"Monokai",center:[8.542,47.372],zoom:11.6,bearing:0,pitch:0,sources:{openmaptiles:{type:"vector",url:ec.source_openmaptiles_url}},sprite:ec.sprite,glyphs:ec.glyphs,layers:[{id:"background",type:"background",paint:{"background-color":"#282822"}},{id:"landcover-glacier",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landcover",filter:["==","subclass","glacier"],layout:{visibility:"visible"},paint:{"fill-color":"#AE81FF","fill-opacity":{base:1,stops:[[0,.9],[10,.3]]}}},{id:"landuse-residential",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landuse",filter:["==","class","residential"],paint:{"fill-color":"#75715E"}},{id:"landuse-commercial",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landuse",filter:["all",["==","$type","Polygon"],["==","class","commercial"]],paint:{"fill-color":"#837f6e"}},{id:"landuse-industrial",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landuse",filter:["all",["==","$type","Polygon"],["==","class","industrial"]],paint:{"fill-color":"#918d7e"}},{id:"park",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"park",filter:["==","$type","Polygon"],paint:{"fill-color":"#A6C22E","fill-opacity":{base:1.8,stops:[[9,.5],[12,.2]]}}},{id:"park-outline",type:"line",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"park",filter:["==","$type","Polygon"],layout:{},paint:{"line-color":"rgba(166,194,46,0.6)","line-dasharray":[3,3]}},{id:"landuse-cemetery",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landuse",filter:["==","class","cemetery"],paint:{"fill-color":"#e0ebad"}},{id:"landuse-hospital",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landuse",filter:["==","class","hospital"],paint:{"fill-color":"#FD971F"}},{id:"landuse-school",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landuse",filter:["==","class","school"],paint:{"fill-color":"rgba(253,151,31,0.8)"}},{id:"landuse-railway",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landuse",filter:["==","class","railway"],paint:{"fill-color":"rgba(18,5,68,0.4)"}},{id:"landcover-wood",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landcover",filter:["==","class","wood"],paint:{"fill-color":"#A6E22E","fill-opacity":.1,"fill-outline-color":"hsla(0, 0%, 0%, 0.03)","fill-antialias":{base:1,stops:[[0,!1],[9,!0]]}}},{id:"landcover-grass",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landcover",filter:["==","class","grass"],paint:{"fill-color":"#A6C22E","fill-opacity":1}},{id:"landcover-grass-park",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"park",filter:["==","class","public_park"],paint:{"fill-color":"#A6C22E","fill-opacity":.8}},{id:"waterway-other",type:"line",metadata:{"mapbox:group":"1444849382550.77"},source:"openmaptiles","source-layer":"waterway",filter:["!in","class","canal","river","stream"],layout:{"line-cap":"round"},paint:{"line-color":"#66D9EF","line-width":{base:1.3,stops:[[13,.5],[20,2]]}}},{id:"waterway-stream-canal",type:"line",metadata:{"mapbox:group":"1444849382550.77"},source:"openmaptiles","source-layer":"waterway",filter:["in","class","canal","stream"],layout:{"line-cap":"round"},paint:{"line-color":"#66D9EF","line-width":{base:1.3,stops:[[13,.5],[20,6]]}}},{id:"waterway-river",type:"line",metadata:{"mapbox:group":"1444849382550.77"},source:"openmaptiles","source-layer":"waterway",filter:["==","class","river"],layout:{"line-cap":"round"},paint:{"line-color":"#66D9EF","line-width":{base:1.2,stops:[[10,.8],[20,6]]}}},{id:"water-offset",type:"fill",metadata:{"mapbox:group":"1444849382550.77"},source:"openmaptiles","source-layer":"water",maxzoom:8,filter:["==","$type","Polygon"],layout:{visibility:"visible"},paint:{"fill-opacity":1,"fill-color":"#66D9EF","fill-translate":{base:1,stops:[[6,[2,0]],[8,[0,0]]]}}},{id:"water",type:"fill",metadata:{"mapbox:group":"1444849382550.77"},source:"openmaptiles","source-layer":"water",layout:{visibility:"visible"},paint:{"fill-color":"#21c8e8"}},{id:"water-pattern",type:"fill",metadata:{"mapbox:group":"1444849382550.77"},source:"openmaptiles","source-layer":"water",layout:{visibility:"visible"},paint:{"fill-translate":[0,2.5],"fill-pattern":"wave"}},{id:"landcover-ice-shelf",type:"fill",metadata:{"mapbox:group":"1444849382550.77"},source:"openmaptiles","source-layer":"landcover",filter:["==","subclass","ice_shelf"],layout:{visibility:"visible"},paint:{"fill-color":"#AE81FF","fill-opacity":{base:1,stops:[[0,.9],[10,.3]]}}},{id:"building",type:"fill",metadata:{"mapbox:group":"1444849364238.8171"},source:"openmaptiles","source-layer":"building",paint:{"fill-color":"#E6DB74","fill-antialias":!0}},{id:"building-top",type:"fill",metadata:{"mapbox:group":"1444849364238.8171"},source:"openmaptiles","source-layer":"building",layout:{visibility:"visible"},paint:{"fill-translate":{base:1,stops:[[14,[0,0]],[16,[-2,-2]]]},"fill-outline-color":"#dfdbd7","fill-color":"#eee69f","fill-opacity":{base:1,stops:[[13,0],[16,1]]}}},{id:"tunnel-service-track-casing",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["in","class","service","track"]],layout:{"line-join":"round"},paint:{"line-color":"#F92672","line-dasharray":[.5,.25],"line-width":{base:1.2,stops:[[15,1],[16,4],[20,11]]}}},{id:"tunnel-minor-casing",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["==","class","minor"]],layout:{"line-join":"round"},paint:{"line-color":"#F92672","line-opacity":{stops:[[12,0],[12.5,1]]},"line-width":{base:1.2,stops:[[12,.5],[13,1],[14,4],[20,15]]}}},{id:"tunnel-secondary-tertiary-casing",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["in","class","secondary","tertiary"]],layout:{"line-join":"round"},paint:{"line-color":"#F92672","line-opacity":1,"line-width":{base:1.2,stops:[[8,1.5],[20,17]]}}},{id:"tunnel-trunk-primary-casing",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["in","class","primary","trunk"]],layout:{"line-join":"round"},paint:{"line-color":"#F92672","line-width":{base:1.2,stops:[[5,.4],[6,.6],[7,1.5],[20,22]]}}},{id:"tunnel-motorway-casing",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["==","class","motorway"]],layout:{"line-join":"round",visibility:"visible"},paint:{"line-color":"#F92672","line-dasharray":[.5,.25],"line-width":{base:1.2,stops:[[5,.4],[6,.6],[7,1.5],[20,22]]}}},{id:"tunnel-path",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["==","brunnel","tunnel"],["==","class","path"]]],paint:{"line-color":"#fa5892","line-dasharray":[1.5,.75],"line-width":{base:1.2,stops:[[15,1.2],[20,4]]}}},{id:"tunnel-service-track",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["in","class","service","track"]],layout:{"line-join":"round"},paint:{"line-color":"#fa5892","line-width":{base:1.2,stops:[[15.5,0],[16,2],[20,7.5]]}}},{id:"tunnel-minor",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["==","class","minor_road"]],layout:{"line-join":"round"},paint:{"line-color":"#fa5892","line-opacity":1,"line-width":{base:1.2,stops:[[13.5,0],[14,2.5],[20,11.5]]}}},{id:"tunnel-secondary-tertiary",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["in","class","secondary","tertiary"]],layout:{"line-join":"round"},paint:{"line-color":"#fb70a2","line-width":{base:1.2,stops:[[6.5,0],[7,.5],[20,10]]}}},{id:"tunnel-trunk-primary",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["in","class","primary","trunk"]],layout:{"line-join":"round"},paint:{"line-color":"#F92672","line-width":{base:1.2,stops:[[6.5,0],[7,.5],[20,18]]}}},{id:"tunnel-motorway",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["==","class","motorway"]],layout:{"line-join":"round",visibility:"visible"},paint:{"line-color":"rgba(249,38,114,0.8)","line-width":{base:1.2,stops:[[6.5,0],[7,.5],[20,18]]}}},{id:"tunnel-railway",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["==","class","rail"]],paint:{"line-color":"#b40544","line-width":{base:1.4,stops:[[14,.4],[15,.75],[20,2]]},"line-dasharray":[2,2]}},{id:"aeroway-taxiway-casing",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"aeroway",minzoom:12,filter:["all",["in","class","taxiway"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#b40544","line-width":{base:1.5,stops:[[11,2],[17,12]]},"line-opacity":1}},{id:"aeroway-runway-casing",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"aeroway",minzoom:12,filter:["all",["in","class","runway"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#b40544","line-width":{base:1.5,stops:[[11,5],[17,55]]},"line-opacity":1}},{id:"aeroway-area",type:"fill",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"aeroway",minzoom:4,filter:["all",["==","$type","Polygon"],["in","class","runway","taxiway"]],layout:{visibility:"visible"},paint:{"fill-opacity":{base:1,stops:[[13,0],[14,1]]},"fill-color":"rgba(249,38,114,0.5)"}},{id:"aeroway-taxiway",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"aeroway",minzoom:4,filter:["all",["in","class","taxiway"],["==","$type","LineString"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#fb70a2","line-width":{base:1.5,stops:[[11,1],[17,10]]},"line-opacity":{base:1,stops:[[11,0],[12,1]]}}},{id:"aeroway-runway",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"aeroway",minzoom:4,filter:["all",["in","class","runway"],["==","$type","LineString"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#fb70a2","line-width":{base:1.5,stops:[[11,4],[17,50]]},"line-opacity":{base:1,stops:[[11,0],[12,1]]}}},{id:"highway-area",type:"fill",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["==","$type","Polygon"],layout:{visibility:"visible"},paint:{"fill-color":"#e60657","fill-outline-color":"#cfcdca","fill-opacity":.9,"fill-antialias":!1}},{id:"highway-motorway-link-casing",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",minzoom:12,filter:["all",["!in","brunnel","bridge","tunnel"],["==","class","motorway_link"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#F92672","line-opacity":1,"line-width":{base:1.2,stops:[[12,1],[13,3],[14,4],[20,15]]}}},{id:"highway-link-casing",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",minzoom:13,filter:["all",["!in","brunnel","bridge","tunnel"],["in","class","primary_link","secondary_link","tertiary_link","trunk_link"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#F92672","line-opacity":1,"line-width":{base:1.2,stops:[[12,1],[13,3],[14,4],[20,15]]}}},{id:"highway-minor-casing",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["!=","brunnel","tunnel"],["in","class","minor","service","track"]]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"rgba(249,38,114,0.8)","line-opacity":{stops:[[12,0],[12.5,1]]},"line-width":{base:1.2,stops:[[12,.5],[13,1],[14,4],[20,15]]}}},{id:"highway-secondary-tertiary-casing",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["!in","brunnel","bridge","tunnel"],["in","class","secondary","tertiary"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#F92672","line-opacity":1,"line-width":{base:1.2,stops:[[8,1.5],[20,17]]}}},{id:"highway-primary-casing",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",minzoom:5,filter:["all",["!in","brunnel","bridge","tunnel"],["in","class","primary"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#F92672","line-opacity":{stops:[[7,0],[8,1]]},"line-width":{base:1.2,stops:[[7,0],[8,.6],[9,1.5],[20,22]]}}},{id:"highway-trunk-casing",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",minzoom:5,filter:["all",["!in","brunnel","bridge","tunnel"],["in","class","trunk"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#F92672","line-opacity":{stops:[[5,0],[6,1]]},"line-width":{base:1.2,stops:[[5,0],[6,.6],[7,1.5],[20,22]]}}},{id:"highway-motorway-casing",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",minzoom:4,filter:["all",["!in","brunnel","bridge","tunnel"],["==","class","motorway"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#F92672","line-width":{base:1.2,stops:[[4,0],[5,.4],[6,.6],[7,1.5],[20,22]]},"line-opacity":{stops:[[4,0],[5,1]]}}},{id:"highway-path",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["!in","brunnel","bridge","tunnel"],["==","class","path"]]],paint:{"line-color":"#F8F8F2","line-dasharray":[1.5,.75],"line-width":{base:1.2,stops:[[15,1.2],[20,4]]}}},{id:"highway-motorway-link",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",minzoom:12,filter:["all",["!in","brunnel","bridge","tunnel"],["==","class","motorway_link"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#f92672","line-width":{base:1.2,stops:[[12.5,0],[13,1.5],[14,2.5],[20,11.5]]}}},{id:"highway-link",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",minzoom:13,filter:["all",["!in","brunnel","bridge","tunnel"],["in","class","primary_link","secondary_link","tertiary_link","trunk_link"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#F92672","line-width":{base:1.2,stops:[[12.5,0],[13,1.5],[14,2.5],[20,11.5]]}}},{id:"highway-minor",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["!=","brunnel","tunnel"],["in","class","minor","service","track"]]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#fc89b2","line-opacity":1,"line-width":{base:1.2,stops:[[13.5,0],[14,2.5],[20,11.5]]}}},{id:"highway-secondary-tertiary",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["!in","brunnel","bridge","tunnel"],["in","class","secondary","tertiary"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#F92672","line-width":{base:1.2,stops:[[6.5,0],[8,.5],[20,13]]}}},{id:"highway-primary",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["!in","brunnel","bridge","tunnel"],["in","class","primary"]]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#F92672","line-width":{base:1.2,stops:[[8.5,0],[9,.5],[20,18]]}}},{id:"highway-trunk",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["!in","brunnel","bridge","tunnel"],["in","class","trunk"]]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#F92672","line-width":{base:1.2,stops:[[6.5,0],[7,.5],[20,18]]}}},{id:"highway-motorway",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",minzoom:5,filter:["all",["==","$type","LineString"],["all",["!in","brunnel","bridge","tunnel"],["==","class","motorway"]]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#f92672","line-width":{base:1.2,stops:[[6.5,0],[7,.5],[20,18]]}}},{id:"railway-service",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["==","class","rail"],["has","service"]]],paint:{"line-color":"rgba(18,5,68,0.7)","line-width":{base:1.4,stops:[[14,.4],[20,1]]}}},{id:"railway-service-hatching",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["==","class","rail"],["has","service"]]],layout:{visibility:"visible"},paint:{"line-color":"rgba(18,5,68,0.7)","line-dasharray":[.2,8],"line-width":{base:1.4,stops:[[14.5,0],[15,2],[20,6]]}}},{id:"railway",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["!has","service"],["!in","brunnel","bridge","tunnel"],["==","class","rail"]]],paint:{"line-color":"#b40544","line-width":{base:1.4,stops:[[14,.4],[15,.75],[20,2]]}}},{id:"railway-hatching",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["!has","service"],["!in","brunnel","bridge","tunnel"],["==","class","rail"]]],paint:{"line-color":"#b40544","line-dasharray":[.2,8],"line-width":{base:1.4,stops:[[14.5,0],[15,3],[20,8]]}}},{id:"bridge-motorway-link-casing",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["==","class","motorway_link"]],layout:{"line-join":"round"},paint:{"line-color":"#F92672","line-opacity":1,"line-width":{base:1.2,stops:[[12,1],[13,3],[14,4],[20,15]]}}},{id:"bridge-link-casing",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["in","class","primary_link","secondary_link","tertiary_link","trunk_link"]],layout:{"line-join":"round"},paint:{"line-color":"#F92672","line-opacity":1,"line-width":{base:1.2,stops:[[12,1],[13,3],[14,4],[20,15]]}}},{id:"bridge-secondary-tertiary-casing",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["in","class","secondary","tertiary"]],layout:{"line-join":"round"},paint:{"line-color":"#F92672","line-opacity":1,"line-width":{base:1.2,stops:[[8,1.5],[20,28]]}}},{id:"bridge-trunk-primary-casing",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["in","class","primary","trunk"]],layout:{"line-join":"round"},paint:{"line-color":"#F92672","line-width":{base:1.2,stops:[[5,.4],[6,.6],[7,1.5],[20,26]]}}},{id:"bridge-motorway-casing",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["==","class","motorway"]],layout:{"line-join":"round"},paint:{"line-color":"#F92672","line-width":{base:1.2,stops:[[5,.4],[6,.6],[7,1.5],[20,22]]}}},{id:"bridge-path-casing",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["==","brunnel","bridge"],["==","class","path"]]],paint:{"line-color":"#fa5892","line-width":{base:1.2,stops:[[15,1.2],[20,18]]}}},{id:"bridge-path",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["==","brunnel","bridge"],["==","class","path"]]],paint:{"line-color":"#F8F8F2","line-width":{base:1.2,stops:[[15,1.2],[20,4]]},"line-dasharray":[1.5,.75]}},{id:"bridge-motorway-link",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["==","class","motorway_link"]],layout:{"line-join":"round"},paint:{"line-color":"#f92672","line-width":{base:1.2,stops:[[12.5,0],[13,1.5],[14,2.5],[20,11.5]]}}},{id:"bridge-link",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["in","class","primary_link","secondary_link","tertiary_link","trunk_link"]],layout:{"line-join":"round"},paint:{"line-color":"#F92672","line-width":{base:1.2,stops:[[12.5,0],[13,1.5],[14,2.5],[20,11.5]]}}},{id:"bridge-secondary-tertiary",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["in","class","secondary","tertiary"]],layout:{"line-join":"round"},paint:{"line-color":"#F92672","line-width":{base:1.2,stops:[[6.5,0],[7,.5],[20,20]]}}},{id:"bridge-trunk-primary",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["in","class","primary","trunk"]],layout:{"line-join":"round"},paint:{"line-color":"#F92672","line-width":{base:1.2,stops:[[6.5,0],[7,.5],[20,18]]}}},{id:"bridge-motorway",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["==","class","motorway"]],layout:{"line-join":"round"},paint:{"line-color":"#f92672","line-width":{base:1.2,stops:[[6.5,0],[7,.5],[20,18]]}}},{id:"bridge-railway",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["==","class","rail"]],paint:{"line-color":"#b40544","line-width":{base:1.4,stops:[[14,.4],[15,.75],[20,2]]}}},{id:"bridge-railway-hatching",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["==","class","rail"]],paint:{"line-color":"#b40544","line-dasharray":[.2,8],"line-width":{base:1.4,stops:[[14.5,0],[15,3],[20,8]]}}},{id:"boundary-land-level-4",type:"line",source:"openmaptiles","source-layer":"boundary",filter:["all",["in","admin_level",4,6,8],["!=","maritime",1]],layout:{"line-join":"round"},paint:{"line-color":"#E69F66","line-dasharray":[3,1,1,1],"line-width":{base:1.4,stops:[[4,.4],[5,1],[12,3]]}}},{id:"boundary-land-level-2",type:"line",source:"openmaptiles","source-layer":"boundary",filter:["all",["==","admin_level",2],["!=","maritime",1]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#E69F66","line-width":{base:1,stops:[[0,.6],[4,1.4],[5,2],[12,8]]}}},{id:"boundary-water",type:"line",source:"openmaptiles","source-layer":"boundary",filter:["all",["in","admin_level",2,4],["==","maritime",1]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#66D9EF","line-width":{base:1,stops:[[0,.6],[4,1.4],[5,2],[12,8]]},"line-opacity":{stops:[[6,.6],[10,1]]}}},{id:"waterway-name",type:"symbol",source:"openmaptiles","source-layer":"waterway",minzoom:13,filter:["all",["==","$type","LineString"],["has","name"],["!has","name:de"]],layout:{"text-font":["Open Sans Italic"],"text-size":14,"text-field":"{name:latin} {name:nonlatin}","text-max-width":5,"text-rotation-alignment":"map","symbol-placement":"line","text-letter-spacing":.2,"symbol-spacing":350},paint:{"text-color":"#fefefe","text-halo-width":1.5,"text-halo-color":"#74aee9"}},{id:"waterway-name-en",type:"symbol",source:"openmaptiles","source-layer":"waterway",minzoom:13,filter:["all",["==","$type","LineString"],["has","name"],["has","name:de"]],layout:{"text-font":["Open Sans Italic"],"text-size":14,"text-field":"{name:de} {name:nonlatin}","text-max-width":5,"text-rotation-alignment":"map","symbol-placement":"line","text-letter-spacing":.2,"symbol-spacing":350},paint:{"text-color":"#fefefe","text-halo-width":1.5,"text-halo-color":"#74aee9"}},{id:"water-name-lakeline",type:"symbol",source:"openmaptiles","source-layer":"water_name",filter:["all",["==","$type","LineString"],["!has","name:de"]],layout:{"text-font":["Open Sans Italic"],"text-size":14,"text-field":"{name:latin} {name:nonlatin}","text-max-width":5,"text-rotation-alignment":"map","symbol-placement":"line","symbol-spacing":350,"text-letter-spacing":.2},paint:{"text-color":"#fefefe","text-halo-width":1.5,"text-halo-color":"#74aee9"}},{id:"water-name-lakeline-en",type:"symbol",source:"openmaptiles","source-layer":"water_name",filter:["all",["==","$type","LineString"],["has","name:de"]],layout:{"text-font":["Open Sans Italic"],"text-size":14,"text-field":"{name:de} {name:nonlatin}","text-max-width":5,"text-rotation-alignment":"map","symbol-placement":"line","symbol-spacing":350,"text-letter-spacing":.2},paint:{"text-color":"#fefefe","text-halo-width":1.5,"text-halo-color":"#74aee9"}},{id:"water-name-ocean",type:"symbol",source:"openmaptiles","source-layer":"water_name",filter:["all",["==","$type","Point"],["==","class","ocean"],["!has","name:de"]],layout:{"text-font":["Open Sans Italic"],"text-size":14,"text-field":`{name:latin}
{name:nonlatin}`,"text-max-width":5,"text-rotation-alignment":"map","symbol-placement":"point","symbol-spacing":350,"text-letter-spacing":.2},paint:{"text-color":"#fefefe","text-halo-width":1.5,"text-halo-color":"#74aee9"}},{id:"water-name-ocean-en",type:"symbol",source:"openmaptiles","source-layer":"water_name",filter:["all",["==","$type","Point"],["==","class","ocean"],["has","name:de"]],layout:{"text-font":["Open Sans Italic"],"text-size":14,"text-field":`{name:de}
{name:nonlatin}`,"text-max-width":5,"text-rotation-alignment":"map","symbol-placement":"point","symbol-spacing":350,"text-letter-spacing":.2},paint:{"text-color":"#fefefe","text-halo-width":1.5,"text-halo-color":"#74aee9"}},{id:"water-name-other",type:"symbol",source:"openmaptiles","source-layer":"water_name",filter:["all",["==","$type","Point"],["!in","class","ocean"],["!has","name:de"]],layout:{"text-font":["Open Sans Italic"],"text-size":{stops:[[0,10],[6,14]]},"text-field":`{name:latin}
{name:nonlatin}`,"text-max-width":5,"text-rotation-alignment":"map","symbol-placement":"point","symbol-spacing":350,"text-letter-spacing":.2,visibility:"visible"},paint:{"text-color":"#fefefe","text-halo-width":1.5,"text-halo-color":"#74aee9"}},{id:"water-name-other-en",type:"symbol",source:"openmaptiles","source-layer":"water_name",filter:["all",["==","$type","Point"],["!in","class","ocean"],["has","name:de"]],layout:{"text-font":["Open Sans Italic"],"text-size":{stops:[[0,10],[6,14]]},"text-field":`{name:de}
{name:nonlatin}`,"text-max-width":5,"text-rotation-alignment":"map","symbol-placement":"point","symbol-spacing":350,"text-letter-spacing":.2,visibility:"visible"},paint:{"text-color":"#fefefe","text-halo-width":1.5,"text-halo-color":"#74aee9"}},{id:"poi-level-3",type:"symbol",source:"openmaptiles","source-layer":"poi",minzoom:16,filter:["all",["==","$type","Point"],[">=","rank",25],["!has","name:de"]],layout:{"text-padding":2,"text-font":["Open Sans Semibold"],"text-anchor":"top","icon-image":"{class}_11","text-field":`{name:latin}
{name:nonlatin}`,"text-offset":[0,.6],"text-size":12,"text-max-width":9},paint:{"text-halo-blur":.5,"text-color":"#fdfdfd","text-halo-width":1,"text-halo-color":"#633"}},{id:"poi-level-3-en",type:"symbol",source:"openmaptiles","source-layer":"poi",minzoom:16,filter:["all",["==","$type","Point"],[">=","rank",25],["has","name:de"]],layout:{"text-padding":2,"text-font":["Open Sans Semibold"],"text-anchor":"top","icon-image":"{class}_11","text-field":`{name:de}
{name:nonlatin}`,"text-offset":[0,.6],"text-size":12,"text-max-width":9},paint:{"text-halo-blur":.5,"text-color":"#fdfdfd","text-halo-width":1,"text-halo-color":"#633"}},{id:"poi-level-2",type:"symbol",source:"openmaptiles","source-layer":"poi",minzoom:15,filter:["all",["==","$type","Point"],["all",["<=","rank",24],[">=","rank",15]],["!has","name:de"]],layout:{"text-padding":2,"text-font":["Open Sans Semibold"],"text-anchor":"top","icon-image":"{class}_11","text-field":`{name:latin}
{name:nonlatin}`,"text-offset":[0,.6],"text-size":12,"text-max-width":9},paint:{"text-halo-blur":.5,"text-color":"#fdfdfd","text-halo-width":1,"text-halo-color":"#633"}},{id:"poi-level-2-en",type:"symbol",source:"openmaptiles","source-layer":"poi",minzoom:15,filter:["all",["==","$type","Point"],["all",["<=","rank",24],[">=","rank",15]],["has","name:de"]],layout:{"text-padding":2,"text-font":["Open Sans Semibold"],"text-anchor":"top","icon-image":"{class}_11","text-field":`{name:de}
{name:nonlatin}`,"text-offset":[0,.6],"text-size":12,"text-max-width":9},paint:{"text-halo-blur":.5,"text-color":"#fdfdfd","text-halo-width":1,"text-halo-color":"#633"}},{id:"poi-level-1",type:"symbol",source:"openmaptiles","source-layer":"poi",minzoom:14,filter:["all",["==","$type","Point"],["all",["<=","rank",14],["has","name"]],["!has","name:de"]],layout:{"text-padding":2,"text-font":["Open Sans Semibold"],"text-anchor":"top","icon-image":"{class}_11","text-field":`{name:latin}
{name:nonlatin}`,"text-offset":[0,.6],"text-size":12,"text-max-width":9},paint:{"text-halo-blur":.5,"text-color":"#fdfdfd","text-halo-width":1,"text-halo-color":"#633"}},{id:"poi-level-1-en",type:"symbol",source:"openmaptiles","source-layer":"poi",minzoom:14,filter:["all",["==","$type","Point"],["all",["<=","rank",14],["has","name"]],["has","name:de"]],layout:{"text-padding":2,"text-font":["Open Sans Semibold"],"text-anchor":"top","icon-image":"{class}_11","text-field":`{name:de}
{name:nonlatin}`,"text-offset":[0,.6],"text-size":12,"text-max-width":9},paint:{"text-halo-blur":.5,"text-color":"#fdfdfd","text-halo-width":1,"text-halo-color":"#633"}},{id:"highway-name-path",type:"symbol",source:"openmaptiles","source-layer":"transportation_name",minzoom:15.5,filter:["all",["==","class","path"],["!has","name:de"]],layout:{"text-size":{base:1,stops:[[13,12],[14,13]]},"text-font":["Open Sans Regular"],"text-field":"{name:latin} {name:nonlatin}","symbol-placement":"line","text-rotation-alignment":"map"},paint:{"text-halo-color":"#f8f4f0","text-color":"hsl(30, 23%, 62%)","text-halo-width":.5}},{id:"highway-name-path-en",type:"symbol",source:"openmaptiles","source-layer":"transportation_name",minzoom:15.5,filter:["all",["==","class","path"],["has","name:de"]],layout:{"text-size":{base:1,stops:[[13,12],[14,13]]},"text-font":["Open Sans Regular"],"text-field":"{name:de} {name:nonlatin}","symbol-placement":"line","text-rotation-alignment":"map"},paint:{"text-halo-color":"#f8f4f0","text-color":"hsl(30, 23%, 62%)","text-halo-width":.5}},{id:"highway-name-minor",type:"symbol",source:"openmaptiles","source-layer":"transportation_name",minzoom:15,filter:["all",["==","$type","LineString"],["in","class","minor","service","track"],["!has","name:de"]],layout:{"text-size":{base:1,stops:[[13,12],[14,13]]},"text-font":["Open Sans Regular"],"text-field":"{name:latin} {name:nonlatin}","symbol-placement":"line","text-rotation-alignment":"map"},paint:{"text-halo-blur":.5,"text-color":"#765","text-halo-width":1}},{id:"highway-name-minor-en",type:"symbol",source:"openmaptiles","source-layer":"transportation_name",minzoom:15,filter:["all",["==","$type","LineString"],["in","class","minor","service","track"],["has","name:de"]],layout:{"text-size":{base:1,stops:[[13,12],[14,13]]},"text-font":["Open Sans Regular"],"text-field":"{name:de} {name:nonlatin}","symbol-placement":"line","text-rotation-alignment":"map"},paint:{"text-halo-blur":.5,"text-color":"#765","text-halo-width":1}},{id:"highway-name-major",type:"symbol",source:"openmaptiles","source-layer":"transportation_name",minzoom:12.2,filter:["all",["in","class","primary","secondary","tertiary","trunk"],["!has","name:de"]],layout:{"text-size":{base:1,stops:[[13,12],[14,13]]},"text-font":["Open Sans Regular"],"text-field":"{name:latin} {name:nonlatin}","symbol-placement":"line","text-rotation-alignment":"map"},paint:{"text-halo-blur":.5,"text-color":"#765","text-halo-width":1}},{id:"highway-name-major-en",type:"symbol",source:"openmaptiles","source-layer":"transportation_name",minzoom:12.2,filter:["all",["in","class","primary","secondary","tertiary","trunk"],["has","name:de"]],layout:{"text-size":{base:1,stops:[[13,12],[14,13]]},"text-font":["Open Sans Regular"],"text-field":"{name:de} {name:nonlatin}","symbol-placement":"line","text-rotation-alignment":"map"},paint:{"text-halo-blur":.5,"text-color":"#765","text-halo-width":1}},{id:"highway-shield",type:"symbol",source:"openmaptiles","source-layer":"transportation_name",minzoom:8,filter:["all",["<=","ref_length",6],["==","$type","LineString"],["!in","network","us-interstate","us-highway","us-state"]],layout:{"text-size":10,"icon-image":"road_{ref_length}","icon-rotation-alignment":"viewport","symbol-spacing":200,"text-font":["Open Sans Semibold"],"symbol-placement":{base:1,stops:[[10,"point"],[11,"line"]]},"text-rotation-alignment":"viewport","icon-size":1,"text-field":"{ref}"},paint:{}},{id:"highway-shield-us-interstate",type:"symbol",source:"openmaptiles","source-layer":"transportation_name",minzoom:7,filter:["all",["<=","ref_length",6],["==","$type","LineString"],["in","network","us-interstate"]],layout:{"text-size":10,"icon-image":"{network}_{ref_length}","icon-rotation-alignment":"viewport","symbol-spacing":200,"text-font":["Open Sans Semibold"],"symbol-placement":{base:1,stops:[[7,"point"],[7,"line"],[8,"line"]]},"text-rotation-alignment":"viewport","icon-size":1,"text-field":"{ref}"},paint:{"text-color":"rgba(0, 0, 0, 1)"}},{id:"highway-shield-us-other",type:"symbol",source:"openmaptiles","source-layer":"transportation_name",minzoom:9,filter:["all",["<=","ref_length",6],["==","$type","LineString"],["in","network","us-highway","us-state"]],layout:{"text-size":10,"icon-image":"{network}_{ref_length}","icon-rotation-alignment":"viewport","symbol-spacing":200,"text-font":["Open Sans Semibold"],"symbol-placement":{base:1,stops:[[10,"point"],[11,"line"]]},"text-rotation-alignment":"viewport","icon-size":1,"text-field":"{ref}"},paint:{"text-color":"rgba(0, 0, 0, 1)"}},{id:"place-other",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["!in","class","city","town","village"],["!has","name:de"]],layout:{"text-letter-spacing":.1,"text-size":{base:1.2,stops:[[12,10],[15,14]]},"text-font":["Open Sans Bold"],"text-field":`{name:latin}
{name:nonlatin}`,"text-transform":"uppercase","text-max-width":9},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-other-en",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["!in","class","city","town","village"],["has","name:de"]],layout:{"text-letter-spacing":.1,"text-size":{base:1.2,stops:[[12,10],[15,14]]},"text-font":["Open Sans Bold"],"text-field":`{name:de}
{name:nonlatin}`,"text-transform":"uppercase","text-max-width":9},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-village",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","village"],["!has","name:de"]],layout:{"text-font":["Open Sans Regular"],"text-size":{base:1.2,stops:[[10,12],[15,22]]},"text-field":`{name:latin}
{name:nonlatin}`,"text-max-width":8},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-village-en",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","village"],["has","name:de"]],layout:{"text-font":["Open Sans Regular"],"text-size":{base:1.2,stops:[[10,12],[15,22]]},"text-field":`{name:de}
{name:nonlatin}`,"text-max-width":8},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-town",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","town"],["!has","name:de"]],layout:{"text-font":["Open Sans Regular"],"text-size":{base:1.2,stops:[[10,14],[15,24]]},"text-field":`{name:latin}
{name:nonlatin}`,"text-max-width":8},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-town-en",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","town"],["has","name:de"]],layout:{"text-font":["Open Sans Regular"],"text-size":{base:1.2,stops:[[10,14],[15,24]]},"text-field":`{name:de}
{name:nonlatin}`,"text-max-width":8},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-city",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["!=","capital",2],["==","class","city"],["!has","name:de"]],layout:{"text-font":["Open Sans Semibold"],"text-size":{base:1.2,stops:[[7,14],[11,24]]},"text-field":`{name:latin}
{name:nonlatin}`,"text-max-width":8},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-city-en",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["!=","capital",2],["==","class","city"],["has","name:de"]],layout:{"text-font":["Open Sans Semibold"],"text-size":{base:1.2,stops:[[7,14],[11,24]]},"text-field":`{name:de}
{name:nonlatin}`,"text-max-width":8},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-city-capital",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","capital",2],["==","class","city"],["!has","name:de"]],layout:{"text-font":["Open Sans Semibold"],"text-size":{base:1.2,stops:[[7,14],[11,24]]},"text-field":`{name:latin}
{name:nonlatin}`,"text-max-width":8,"icon-image":"star_11","text-offset":[.4,0],"icon-size":.8,"text-anchor":"left"},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-city-capital-en",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","capital",2],["==","class","city"],["has","name:de"]],layout:{"text-font":["Open Sans Semibold"],"text-size":{base:1.2,stops:[[7,14],[11,24]]},"text-field":`{name:de}
{name:nonlatin}`,"text-max-width":8,"icon-image":"star_11","text-offset":[.4,0],"icon-size":.8,"text-anchor":"left"},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-country-3",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","country"],[">=","rank",3],["!has","name:de"]],layout:{"text-font":["Open Sans Bold"],"text-field":`{name:latin}
{name:nonlatin}`,"text-size":{stops:[[3,11],[7,17]]},"text-transform":"uppercase","text-max-width":6.25},paint:{"text-halo-blur":1,"text-color":"#fdfdfd","text-halo-width":2,"text-halo-color":"#433"}},{id:"place-country-3-en",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","country"],[">=","rank",3],["has","name:de"]],layout:{"text-font":["Open Sans Bold"],"text-field":`{name:de}
{name:nonlatin}`,"text-size":{stops:[[3,11],[7,17]]},"text-transform":"uppercase","text-max-width":6.25},paint:{"text-halo-blur":1,"text-color":"#fdfdfd","text-halo-width":2,"text-halo-color":"#433"}},{id:"place-country-2",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","country"],["==","rank",2],["!has","name:de"]],layout:{"text-font":["Open Sans Bold"],"text-field":`{name:latin}
{name:nonlatin}`,"text-size":{stops:[[2,11],[5,17]]},"text-transform":"uppercase","text-max-width":6.25},paint:{"text-halo-blur":1,"text-color":"#fdfdfd","text-halo-width":2,"text-halo-color":"#433"}},{id:"place-country-2-en",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","country"],["==","rank",2],["has","name:de"]],layout:{"text-font":["Open Sans Bold"],"text-field":`{name:de}
{name:nonlatin}`,"text-size":{stops:[[2,11],[5,17]]},"text-transform":"uppercase","text-max-width":6.25},paint:{"text-halo-blur":1,"text-color":"#fdfdfd","text-halo-width":2,"text-halo-color":"#433"}},{id:"place-country-1",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","country"],["==","rank",1],["!has","name:de"]],layout:{"text-font":["Open Sans Bold"],"text-field":`{name:latin}
{name:nonlatin}`,"text-size":{stops:[[1,11],[4,17]]},"text-transform":"uppercase","text-max-width":6.25},paint:{"text-halo-blur":1,"text-color":"#fdfdfd","text-halo-width":2,"text-halo-color":"#433"}},{id:"place-country-1-en",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","country"],["==","rank",1],["has","name:de"]],layout:{"text-font":["Open Sans Bold"],"text-field":`{name:de}
{name:nonlatin}`,"text-size":{stops:[[1,11],[4,17]]},"text-transform":"uppercase","text-max-width":6.25},paint:{"text-halo-blur":1,"text-color":"#fdfdfd","text-halo-width":2,"text-halo-color":"#433"}},{id:"place-continent",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",maxzoom:1,filter:["all",["==","class","continent"],["!has","name:de"]],layout:{"text-font":["Open Sans Bold"],"text-field":`{name:latin}
{name:nonlatin}`,"text-size":14,"text-max-width":6.25,"text-transform":"uppercase"},paint:{"text-halo-blur":1,"text-color":"#fdfdfd","text-halo-width":2,"text-halo-color":"#433"}},{id:"place-continent-en",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",maxzoom:1,filter:["all",["==","class","continent"],["has","name:de"]],layout:{"text-font":["Open Sans Bold"],"text-field":`{name:de}
{name:nonlatin}`,"text-size":14,"text-max-width":6.25,"text-transform":"uppercase"},paint:{"text-halo-blur":1,"text-color":"#fdfdfd","text-halo-width":2,"text-halo-color":"#433"}}]},B6e={version:8,name:"Solarized",center:[8.542,47.372],zoom:11.6,bearing:0,pitch:0,sources:{openmaptiles:{type:"vector",url:ec.source_openmaptiles_url}},sprite:ec.sprite,glyphs:ec.glyphs,layers:[{id:"background",type:"background",paint:{"background-color":"#073642"}},{id:"landcover-glacier",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landcover",filter:["==","subclass","glacier"],layout:{visibility:"visible"},paint:{"fill-color":"#2aa198","fill-opacity":{base:1,stops:[[0,.9],[10,.3]]}}},{id:"landuse-residential",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landuse",filter:["==","class","residential"],paint:{"fill-color":"#657b83"}},{id:"landuse-commercial",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landuse",filter:["all",["==","$type","Polygon"],["==","class","commercial"]],paint:{"fill-color":"#74888f"}},{id:"landuse-industrial",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landuse",filter:["all",["==","$type","Polygon"],["==","class","industrial"]],paint:{"fill-color":"#84959c"}},{id:"park",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"park",filter:["==","$type","Polygon"],paint:{"fill-color":"#859900","fill-opacity":{base:1.8,stops:[[9,.5],[12,.2]]}}},{id:"park-outline",type:"line",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"park",filter:["==","$type","Polygon"],layout:{},paint:{"line-color":"rgba(133,153,0,0.6)","line-dasharray":[3,3]}},{id:"landuse-cemetery",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landuse",filter:["==","class","cemetery"],paint:{"fill-color":"#f2ff99"}},{id:"landuse-hospital",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landuse",filter:["==","class","hospital"],paint:{"fill-color":"#d30102"}},{id:"landuse-school",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landuse",filter:["==","class","school"],paint:{"fill-color":"rgba(211,1,2,0.8)"}},{id:"landuse-railway",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landuse",filter:["==","class","railway"],paint:{"fill-color":"rgba(58,63,144,0.4)"}},{id:"landcover-wood",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landcover",filter:["==","class","wood"],paint:{"fill-color":"#2aa198","fill-opacity":.1,"fill-outline-color":"hsla(0, 0%, 0%, 0.03)","fill-antialias":{base:1,stops:[[0,!1],[9,!0]]}}},{id:"landcover-grass",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landcover",filter:["==","class","grass"],paint:{"fill-color":"#859900","fill-opacity":1}},{id:"landcover-grass-park",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"park",filter:["==","class","public_park"],paint:{"fill-color":"#859900","fill-opacity":.8}},{id:"waterway-other",type:"line",metadata:{"mapbox:group":"1444849382550.77"},source:"openmaptiles","source-layer":"waterway",filter:["!in","class","canal","river","stream"],layout:{"line-cap":"round"},paint:{"line-color":"#268bd2","line-width":{base:1.3,stops:[[13,.5],[20,2]]}}},{id:"waterway-stream-canal",type:"line",metadata:{"mapbox:group":"1444849382550.77"},source:"openmaptiles","source-layer":"waterway",filter:["in","class","canal","stream"],layout:{"line-cap":"round"},paint:{"line-color":"#268bd2","line-width":{base:1.3,stops:[[13,.5],[20,6]]}}},{id:"waterway-river",type:"line",metadata:{"mapbox:group":"1444849382550.77"},source:"openmaptiles","source-layer":"waterway",filter:["==","class","river"],layout:{"line-cap":"round"},paint:{"line-color":"#268bd2","line-width":{base:1.2,stops:[[10,.8],[20,6]]}}},{id:"water-offset",type:"fill",metadata:{"mapbox:group":"1444849382550.77"},source:"openmaptiles","source-layer":"water",maxzoom:8,filter:["==","$type","Polygon"],layout:{visibility:"visible"},paint:{"fill-opacity":1,"fill-color":"#268bd2","fill-translate":{base:1,stops:[[6,[2,0]],[8,[0,0]]]}}},{id:"water",type:"fill",metadata:{"mapbox:group":"1444849382550.77"},source:"openmaptiles","source-layer":"water",layout:{visibility:"visible"},paint:{"fill-color":"#1a6091"}},{id:"water-pattern",type:"fill",metadata:{"mapbox:group":"1444849382550.77"},source:"openmaptiles","source-layer":"water",layout:{visibility:"visible"},paint:{"fill-translate":[0,2.5],"fill-pattern":"wave"}},{id:"landcover-ice-shelf",type:"fill",metadata:{"mapbox:group":"1444849382550.77"},source:"openmaptiles","source-layer":"landcover",filter:["==","subclass","ice_shelf"],layout:{visibility:"visible"},paint:{"fill-color":"#2aa198","fill-opacity":{base:1,stops:[[0,.9],[10,.3]]}}},{id:"building",type:"fill",metadata:{"mapbox:group":"1444849364238.8171"},source:"openmaptiles","source-layer":"building",paint:{"fill-color":"#eee8d5","fill-antialias":!0}},{id:"building-top",type:"fill",metadata:{"mapbox:group":"1444849364238.8171"},source:"openmaptiles","source-layer":"building",layout:{visibility:"visible"},paint:{"fill-translate":{base:1,stops:[[14,[0,0]],[16,[-2,-2]]]},"fill-outline-color":"#dfdbd7","fill-color":"#fdfcf9","fill-opacity":{base:1,stops:[[13,0],[16,1]]}}},{id:"tunnel-service-track-casing",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["in","class","service","track"]],layout:{"line-join":"round"},paint:{"line-color":"#6c71c4","line-dasharray":[.5,.25],"line-width":{base:1.2,stops:[[15,1],[16,4],[20,11]]}}},{id:"tunnel-minor-casing",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["==","class","minor"]],layout:{"line-join":"round"},paint:{"line-color":"#6c71c4","line-opacity":{stops:[[12,0],[12.5,1]]},"line-width":{base:1.2,stops:[[12,.5],[13,1],[14,4],[20,15]]}}},{id:"tunnel-secondary-tertiary-casing",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["in","class","secondary","tertiary"]],layout:{"line-join":"round"},paint:{"line-color":"#d33682","line-opacity":1,"line-width":{base:1.2,stops:[[8,1.5],[20,17]]}}},{id:"tunnel-trunk-primary-casing",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["in","class","primary","trunk"]],layout:{"line-join":"round"},paint:{"line-color":"#d33682","line-width":{base:1.2,stops:[[5,.4],[6,.6],[7,1.5],[20,22]]}}},{id:"tunnel-motorway-casing",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["==","class","motorway"]],layout:{"line-join":"round",visibility:"visible"},paint:{"line-color":"#d33682","line-dasharray":[.5,.25],"line-width":{base:1.2,stops:[[5,.4],[6,.6],[7,1.5],[20,22]]}}},{id:"tunnel-path",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["==","brunnel","tunnel"],["==","class","path"]]],paint:{"line-color":"#9094d3","line-dasharray":[1.5,.75],"line-width":{base:1.2,stops:[[15,1.2],[20,4]]}}},{id:"tunnel-service-track",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["in","class","service","track"]],layout:{"line-join":"round"},paint:{"line-color":"#9094d3","line-width":{base:1.2,stops:[[15.5,0],[16,2],[20,7.5]]}}},{id:"tunnel-minor",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["==","class","minor_road"]],layout:{"line-join":"round"},paint:{"line-color":"#9094d3","line-opacity":1,"line-width":{base:1.2,stops:[[13.5,0],[14,2.5],[20,11.5]]}}},{id:"tunnel-secondary-tertiary",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["in","class","secondary","tertiary"]],layout:{"line-join":"round"},paint:{"line-color":"#a3a6da","line-width":{base:1.2,stops:[[6.5,0],[7,.5],[20,10]]}}},{id:"tunnel-trunk-primary",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["in","class","primary","trunk"]],layout:{"line-join":"round"},paint:{"line-color":"#6c71c4","line-width":{base:1.2,stops:[[6.5,0],[7,.5],[20,18]]}}},{id:"tunnel-motorway",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["==","class","motorway"]],layout:{"line-join":"round",visibility:"visible"},paint:{"line-color":"rgba(108,113,196,0.8)","line-width":{base:1.2,stops:[[6.5,0],[7,.5],[20,18]]}}},{id:"tunnel-railway",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["==","class","rail"]],paint:{"line-color":"#3a3f90","line-width":{base:1.4,stops:[[14,.4],[15,.75],[20,2]]},"line-dasharray":[2,2]}},{id:"aeroway-taxiway-casing",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"aeroway",minzoom:12,filter:["all",["in","class","taxiway"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#3a3f90","line-width":{base:1.5,stops:[[11,2],[17,12]]},"line-opacity":1}},{id:"aeroway-runway-casing",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"aeroway",minzoom:12,filter:["all",["in","class","runway"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#3a3f90","line-width":{base:1.5,stops:[[11,5],[17,55]]},"line-opacity":1}},{id:"aeroway-area",type:"fill",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"aeroway",minzoom:4,filter:["all",["==","$type","Polygon"],["in","class","runway","taxiway"]],layout:{visibility:"visible"},paint:{"fill-opacity":{base:1,stops:[[13,0],[14,1]]},"fill-color":"rgba(108,113,196,0.5)"}},{id:"aeroway-taxiway",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"aeroway",minzoom:4,filter:["all",["in","class","taxiway"],["==","$type","LineString"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#a3a6da","line-width":{base:1.5,stops:[[11,1],[17,10]]},"line-opacity":{base:1,stops:[[11,0],[12,1]]}}},{id:"aeroway-runway",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"aeroway",minzoom:4,filter:["all",["in","class","runway"],["==","$type","LineString"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#a3a6da","line-width":{base:1.5,stops:[[11,4],[17,50]]},"line-opacity":{base:1,stops:[[11,0],[12,1]]}}},{id:"highway-area",type:"fill",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["==","$type","Polygon"],layout:{visibility:"visible"},paint:{"fill-color":"#484fb5","fill-outline-color":"#cfcdca","fill-opacity":.9,"fill-antialias":!1}},{id:"highway-motorway-link-casing",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",minzoom:12,filter:["all",["!in","brunnel","bridge","tunnel"],["==","class","motorway_link"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#d33682","line-opacity":1,"line-width":{base:1.2,stops:[[12,1],[13,3],[14,4],[20,15]]}}},{id:"highway-link-casing",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",minzoom:13,filter:["all",["!in","brunnel","bridge","tunnel"],["in","class","primary_link","secondary_link","tertiary_link","trunk_link"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#d33682","line-opacity":1,"line-width":{base:1.2,stops:[[12,1],[13,3],[14,4],[20,15]]}}},{id:"highway-minor-casing",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["!=","brunnel","tunnel"],["in","class","minor","service","track"]]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"rgba(108,113,196,0.8)","line-opacity":{stops:[[12,0],[12.5,1]]},"line-width":{base:1.2,stops:[[12,.5],[13,1],[14,4],[20,15]]}}},{id:"highway-secondary-tertiary-casing",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["!in","brunnel","bridge","tunnel"],["in","class","secondary","tertiary"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#d33682","line-opacity":1,"line-width":{base:1.2,stops:[[8,1.5],[20,17]]}}},{id:"highway-primary-casing",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",minzoom:5,filter:["all",["!in","brunnel","bridge","tunnel"],["in","class","primary"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#d33682","line-opacity":{stops:[[7,0],[8,1]]},"line-width":{base:1.2,stops:[[7,0],[8,.6],[9,1.5],[20,22]]}}},{id:"highway-trunk-casing",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",minzoom:5,filter:["all",["!in","brunnel","bridge","tunnel"],["in","class","trunk"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#d33682","line-opacity":{stops:[[5,0],[6,1]]},"line-width":{base:1.2,stops:[[5,0],[6,.6],[7,1.5],[20,22]]}}},{id:"highway-motorway-casing",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",minzoom:4,filter:["all",["!in","brunnel","bridge","tunnel"],["==","class","motorway"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#d33682","line-width":{base:1.2,stops:[[4,0],[5,.4],[6,.6],[7,1.5],[20,22]]},"line-opacity":{stops:[[4,0],[5,1]]}}},{id:"highway-path",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["!in","brunnel","bridge","tunnel"],["==","class","path"]]],paint:{"line-color":"#cb4b16","line-dasharray":[1.5,.75],"line-width":{base:1.2,stops:[[15,1.2],[20,4]]}}},{id:"highway-motorway-link",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",minzoom:12,filter:["all",["!in","brunnel","bridge","tunnel"],["==","class","motorway_link"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#6c71c4","line-width":{base:1.2,stops:[[12.5,0],[13,1.5],[14,2.5],[20,11.5]]}}},{id:"highway-link",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",minzoom:13,filter:["all",["!in","brunnel","bridge","tunnel"],["in","class","primary_link","secondary_link","tertiary_link","trunk_link"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#6c71c4","line-width":{base:1.2,stops:[[12.5,0],[13,1.5],[14,2.5],[20,11.5]]}}},{id:"highway-minor",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["!=","brunnel","tunnel"],["in","class","minor","service","track"]]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#e58ab6","line-opacity":1,"line-width":{base:1.2,stops:[[13.5,0],[14,2.5],[20,11.5]]}}},{id:"highway-secondary-tertiary",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["!in","brunnel","bridge","tunnel"],["in","class","secondary","tertiary"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#6c71c4","line-width":{base:1.2,stops:[[6.5,0],[8,.5],[20,13]]}}},{id:"highway-primary",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["!in","brunnel","bridge","tunnel"],["in","class","primary"]]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#6c71c4","line-width":{base:1.2,stops:[[8.5,0],[9,.5],[20,18]]}}},{id:"highway-trunk",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["!in","brunnel","bridge","tunnel"],["in","class","trunk"]]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#6c71c4","line-width":{base:1.2,stops:[[6.5,0],[7,.5],[20,18]]}}},{id:"highway-motorway",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",minzoom:5,filter:["all",["==","$type","LineString"],["all",["!in","brunnel","bridge","tunnel"],["==","class","motorway"]]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#6c71c4","line-width":{base:1.2,stops:[[6.5,0],[7,.5],[20,18]]}}},{id:"railway-service",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["==","class","rail"],["has","service"]]],paint:{"line-color":"rgba(58,63,144,0.7)","line-width":{base:1.4,stops:[[14,.4],[20,1]]}}},{id:"railway-service-hatching",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["==","class","rail"],["has","service"]]],layout:{visibility:"visible"},paint:{"line-color":"rgba(58,63,144,0.7)","line-dasharray":[.2,8],"line-width":{base:1.4,stops:[[14.5,0],[15,2],[20,6]]}}},{id:"railway",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["!has","service"],["!in","brunnel","bridge","tunnel"],["==","class","rail"]]],paint:{"line-color":"#3a3f90","line-width":{base:1.4,stops:[[14,.4],[15,.75],[20,2]]}}},{id:"railway-hatching",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["!has","service"],["!in","brunnel","bridge","tunnel"],["==","class","rail"]]],paint:{"line-color":"#3a3f90","line-dasharray":[.2,8],"line-width":{base:1.4,stops:[[14.5,0],[15,3],[20,8]]}}},{id:"bridge-motorway-link-casing",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["==","class","motorway_link"]],layout:{"line-join":"round"},paint:{"line-color":"#d33682","line-opacity":1,"line-width":{base:1.2,stops:[[12,1],[13,3],[14,4],[20,15]]}}},{id:"bridge-link-casing",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["in","class","primary_link","secondary_link","tertiary_link","trunk_link"]],layout:{"line-join":"round"},paint:{"line-color":"#d33682","line-opacity":1,"line-width":{base:1.2,stops:[[12,1],[13,3],[14,4],[20,15]]}}},{id:"bridge-secondary-tertiary-casing",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["in","class","secondary","tertiary"]],layout:{"line-join":"round"},paint:{"line-color":"#d33682","line-opacity":1,"line-width":{base:1.2,stops:[[8,1.5],[20,28]]}}},{id:"bridge-trunk-primary-casing",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["in","class","primary","trunk"]],layout:{"line-join":"round"},paint:{"line-color":"#d33682","line-width":{base:1.2,stops:[[5,.4],[6,.6],[7,1.5],[20,26]]}}},{id:"bridge-motorway-casing",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["==","class","motorway"]],layout:{"line-join":"round"},paint:{"line-color":"#d33682","line-width":{base:1.2,stops:[[5,.4],[6,.6],[7,1.5],[20,22]]}}},{id:"bridge-path-casing",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["==","brunnel","bridge"],["==","class","path"]]],paint:{"line-color":"#9094d3","line-width":{base:1.2,stops:[[15,1.2],[20,18]]}}},{id:"bridge-path",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["==","brunnel","bridge"],["==","class","path"]]],paint:{"line-color":"#cb4b16","line-width":{base:1.2,stops:[[15,1.2],[20,4]]},"line-dasharray":[1.5,.75]}},{id:"bridge-motorway-link",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["==","class","motorway_link"]],layout:{"line-join":"round"},paint:{"line-color":"#6c71c4","line-width":{base:1.2,stops:[[12.5,0],[13,1.5],[14,2.5],[20,11.5]]}}},{id:"bridge-link",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["in","class","primary_link","secondary_link","tertiary_link","trunk_link"]],layout:{"line-join":"round"},paint:{"line-color":"#6c71c4","line-width":{base:1.2,stops:[[12.5,0],[13,1.5],[14,2.5],[20,11.5]]}}},{id:"bridge-secondary-tertiary",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["in","class","secondary","tertiary"]],layout:{"line-join":"round"},paint:{"line-color":"#6c71c4","line-width":{base:1.2,stops:[[6.5,0],[7,.5],[20,20]]}}},{id:"bridge-trunk-primary",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["in","class","primary","trunk"]],layout:{"line-join":"round"},paint:{"line-color":"#6c71c4","line-width":{base:1.2,stops:[[6.5,0],[7,.5],[20,18]]}}},{id:"bridge-motorway",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["==","class","motorway"]],layout:{"line-join":"round"},paint:{"line-color":"#6c71c4","line-width":{base:1.2,stops:[[6.5,0],[7,.5],[20,18]]}}},{id:"bridge-railway",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["==","class","rail"]],paint:{"line-color":"#3a3f90","line-width":{base:1.4,stops:[[14,.4],[15,.75],[20,2]]}}},{id:"bridge-railway-hatching",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["==","class","rail"]],paint:{"line-color":"#3a3f90","line-dasharray":[.2,8],"line-width":{base:1.4,stops:[[14.5,0],[15,3],[20,8]]}}},{id:"boundary-land-level-4",type:"line",source:"openmaptiles","source-layer":"boundary",filter:["all",["in","admin_level",4,6,8],["!=","maritime",1]],layout:{"line-join":"round"},paint:{"line-color":"#268bd2","line-dasharray":[3,1,1,1],"line-width":{base:1.4,stops:[[4,.4],[5,1],[12,3]]}}},{id:"boundary-land-level-2",type:"line",source:"openmaptiles","source-layer":"boundary",filter:["all",["==","admin_level",2],["!=","maritime",1]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#268bd2","line-width":{base:1,stops:[[0,.6],[4,1.4],[5,2],[12,8]]}}},{id:"boundary-water",type:"line",source:"openmaptiles","source-layer":"boundary",filter:["all",["in","admin_level",2,4],["==","maritime",1]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#268bd2","line-width":{base:1,stops:[[0,.6],[4,1.4],[5,2],[12,8]]},"line-opacity":{stops:[[6,.6],[10,1]]}}},{id:"waterway-name",type:"symbol",source:"openmaptiles","source-layer":"waterway",minzoom:13,filter:["all",["==","$type","LineString"],["has","name"],["!has","name:de"]],layout:{"text-font":["Open Sans Italic"],"text-size":14,"text-field":"{name:latin} {name:nonlatin}","text-max-width":5,"text-rotation-alignment":"map","symbol-placement":"line","text-letter-spacing":.2,"symbol-spacing":350},paint:{"text-color":"#fefefe","text-halo-width":1.5,"text-halo-color":"#74aee9"}},{id:"waterway-name-en",type:"symbol",source:"openmaptiles","source-layer":"waterway",minzoom:13,filter:["all",["==","$type","LineString"],["has","name"],["has","name:de"]],layout:{"text-font":["Open Sans Italic"],"text-size":14,"text-field":"{name:de} {name:nonlatin}","text-max-width":5,"text-rotation-alignment":"map","symbol-placement":"line","text-letter-spacing":.2,"symbol-spacing":350},paint:{"text-color":"#fefefe","text-halo-width":1.5,"text-halo-color":"#74aee9"}},{id:"water-name-lakeline",type:"symbol",source:"openmaptiles","source-layer":"water_name",filter:["all",["==","$type","LineString"],["!has","name:de"]],layout:{"text-font":["Open Sans Italic"],"text-size":14,"text-field":"{name:latin} {name:nonlatin}","text-max-width":5,"text-rotation-alignment":"map","symbol-placement":"line","symbol-spacing":350,"text-letter-spacing":.2},paint:{"text-color":"#fefefe","text-halo-width":1.5,"text-halo-color":"#74aee9"}},{id:"water-name-lakeline-en",type:"symbol",source:"openmaptiles","source-layer":"water_name",filter:["all",["==","$type","LineString"],["has","name:de"]],layout:{"text-font":["Open Sans Italic"],"text-size":14,"text-field":"{name:de} {name:nonlatin}","text-max-width":5,"text-rotation-alignment":"map","symbol-placement":"line","symbol-spacing":350,"text-letter-spacing":.2},paint:{"text-color":"#fefefe","text-halo-width":1.5,"text-halo-color":"#74aee9"}},{id:"water-name-ocean",type:"symbol",source:"openmaptiles","source-layer":"water_name",filter:["all",["==","$type","Point"],["==","class","ocean"],["!has","name:de"]],layout:{"text-font":["Open Sans Italic"],"text-size":14,"text-field":`{name:latin}
{name:nonlatin}`,"text-max-width":5,"text-rotation-alignment":"map","symbol-placement":"point","symbol-spacing":350,"text-letter-spacing":.2},paint:{"text-color":"#fefefe","text-halo-width":1.5,"text-halo-color":"#74aee9"}},{id:"water-name-ocean-en",type:"symbol",source:"openmaptiles","source-layer":"water_name",filter:["all",["==","$type","Point"],["==","class","ocean"],["has","name:de"]],layout:{"text-font":["Open Sans Italic"],"text-size":14,"text-field":`{name:de}
{name:nonlatin}`,"text-max-width":5,"text-rotation-alignment":"map","symbol-placement":"point","symbol-spacing":350,"text-letter-spacing":.2},paint:{"text-color":"#fefefe","text-halo-width":1.5,"text-halo-color":"#74aee9"}},{id:"water-name-other",type:"symbol",source:"openmaptiles","source-layer":"water_name",filter:["all",["==","$type","Point"],["!in","class","ocean"],["!has","name:de"]],layout:{"text-font":["Open Sans Italic"],"text-size":{stops:[[0,10],[6,14]]},"text-field":`{name:latin}
{name:nonlatin}`,"text-max-width":5,"text-rotation-alignment":"map","symbol-placement":"point","symbol-spacing":350,"text-letter-spacing":.2,visibility:"visible"},paint:{"text-color":"#fefefe","text-halo-width":1.5,"text-halo-color":"#74aee9"}},{id:"water-name-other-en",type:"symbol",source:"openmaptiles","source-layer":"water_name",filter:["all",["==","$type","Point"],["!in","class","ocean"],["has","name:de"]],layout:{"text-font":["Open Sans Italic"],"text-size":{stops:[[0,10],[6,14]]},"text-field":`{name:de}
{name:nonlatin}`,"text-max-width":5,"text-rotation-alignment":"map","symbol-placement":"point","symbol-spacing":350,"text-letter-spacing":.2,visibility:"visible"},paint:{"text-color":"#fefefe","text-halo-width":1.5,"text-halo-color":"#74aee9"}},{id:"poi-level-3",type:"symbol",source:"openmaptiles","source-layer":"poi",minzoom:16,filter:["all",["==","$type","Point"],[">=","rank",25],["!has","name:de"]],layout:{"text-padding":2,"text-font":["Open Sans Semibold"],"text-anchor":"top","icon-image":"{class}_11","text-field":`{name:latin}
{name:nonlatin}`,"text-offset":[0,.6],"text-size":12,"text-max-width":9},paint:{"text-halo-blur":.5,"text-color":"#fdfdfd","text-halo-width":1,"text-halo-color":"#633"}},{id:"poi-level-3-en",type:"symbol",source:"openmaptiles","source-layer":"poi",minzoom:16,filter:["all",["==","$type","Point"],[">=","rank",25],["has","name:de"]],layout:{"text-padding":2,"text-font":["Open Sans Semibold"],"text-anchor":"top","icon-image":"{class}_11","text-field":`{name:de}
{name:nonlatin}`,"text-offset":[0,.6],"text-size":12,"text-max-width":9},paint:{"text-halo-blur":.5,"text-color":"#fdfdfd","text-halo-width":1,"text-halo-color":"#633"}},{id:"poi-level-2",type:"symbol",source:"openmaptiles","source-layer":"poi",minzoom:15,filter:["all",["==","$type","Point"],["all",["<=","rank",24],[">=","rank",15]],["!has","name:de"]],layout:{"text-padding":2,"text-font":["Open Sans Semibold"],"text-anchor":"top","icon-image":"{class}_11","text-field":`{name:latin}
{name:nonlatin}`,"text-offset":[0,.6],"text-size":12,"text-max-width":9},paint:{"text-halo-blur":.5,"text-color":"#fdfdfd","text-halo-width":1,"text-halo-color":"#633"}},{id:"poi-level-2-en",type:"symbol",source:"openmaptiles","source-layer":"poi",minzoom:15,filter:["all",["==","$type","Point"],["all",["<=","rank",24],[">=","rank",15]],["has","name:de"]],layout:{"text-padding":2,"text-font":["Open Sans Semibold"],"text-anchor":"top","icon-image":"{class}_11","text-field":`{name:de}
{name:nonlatin}`,"text-offset":[0,.6],"text-size":12,"text-max-width":9},paint:{"text-halo-blur":.5,"text-color":"#fdfdfd","text-halo-width":1,"text-halo-color":"#633"}},{id:"poi-level-1",type:"symbol",source:"openmaptiles","source-layer":"poi",minzoom:14,filter:["all",["==","$type","Point"],["all",["<=","rank",14],["has","name"]],["!has","name:de"]],layout:{"text-padding":2,"text-font":["Open Sans Semibold"],"text-anchor":"top","icon-image":"{class}_11","text-field":`{name:latin}
{name:nonlatin}`,"text-offset":[0,.6],"text-size":12,"text-max-width":9},paint:{"text-halo-blur":.5,"text-color":"#fdfdfd","text-halo-width":1,"text-halo-color":"#633"}},{id:"poi-level-1-en",type:"symbol",source:"openmaptiles","source-layer":"poi",minzoom:14,filter:["all",["==","$type","Point"],["all",["<=","rank",14],["has","name"]],["has","name:de"]],layout:{"text-padding":2,"text-font":["Open Sans Semibold"],"text-anchor":"top","icon-image":"{class}_11","text-field":`{name:de}
{name:nonlatin}`,"text-offset":[0,.6],"text-size":12,"text-max-width":9},paint:{"text-halo-blur":.5,"text-color":"#fdfdfd","text-halo-width":1,"text-halo-color":"#633"}},{id:"highway-name-path",type:"symbol",source:"openmaptiles","source-layer":"transportation_name",minzoom:15.5,filter:["all",["==","class","path"],["!has","name:de"]],layout:{"text-size":{base:1,stops:[[13,12],[14,13]]},"text-font":["Open Sans Regular"],"text-field":"{name:latin} {name:nonlatin}","symbol-placement":"line","text-rotation-alignment":"map"},paint:{"text-halo-color":"#f8f4f0","text-color":"hsl(30, 23%, 62%)","text-halo-width":.5}},{id:"highway-name-path-en",type:"symbol",source:"openmaptiles","source-layer":"transportation_name",minzoom:15.5,filter:["all",["==","class","path"],["has","name:de"]],layout:{"text-size":{base:1,stops:[[13,12],[14,13]]},"text-font":["Open Sans Regular"],"text-field":"{name:de} {name:nonlatin}","symbol-placement":"line","text-rotation-alignment":"map"},paint:{"text-halo-color":"#f8f4f0","text-color":"hsl(30, 23%, 62%)","text-halo-width":.5}},{id:"highway-name-minor",type:"symbol",source:"openmaptiles","source-layer":"transportation_name",minzoom:15,filter:["all",["==","$type","LineString"],["in","class","minor","service","track"],["!has","name:de"]],layout:{"text-size":{base:1,stops:[[13,12],[14,13]]},"text-font":["Open Sans Regular"],"text-field":"{name:latin} {name:nonlatin}","symbol-placement":"line","text-rotation-alignment":"map"},paint:{"text-halo-blur":.5,"text-color":"#765","text-halo-width":1}},{id:"highway-name-minor-en",type:"symbol",source:"openmaptiles","source-layer":"transportation_name",minzoom:15,filter:["all",["==","$type","LineString"],["in","class","minor","service","track"],["has","name:de"]],layout:{"text-size":{base:1,stops:[[13,12],[14,13]]},"text-font":["Open Sans Regular"],"text-field":"{name:de} {name:nonlatin}","symbol-placement":"line","text-rotation-alignment":"map"},paint:{"text-halo-blur":.5,"text-color":"#765","text-halo-width":1}},{id:"highway-name-major",type:"symbol",source:"openmaptiles","source-layer":"transportation_name",minzoom:12.2,filter:["all",["in","class","primary","secondary","tertiary","trunk"],["!has","name:de"]],layout:{"text-size":{base:1,stops:[[13,12],[14,13]]},"text-font":["Open Sans Regular"],"text-field":"{name:latin} {name:nonlatin}","symbol-placement":"line","text-rotation-alignment":"map"},paint:{"text-halo-blur":.5,"text-color":"#765","text-halo-width":1}},{id:"highway-name-major-en",type:"symbol",source:"openmaptiles","source-layer":"transportation_name",minzoom:12.2,filter:["all",["in","class","primary","secondary","tertiary","trunk"],["has","name:de"]],layout:{"text-size":{base:1,stops:[[13,12],[14,13]]},"text-font":["Open Sans Regular"],"text-field":"{name:de} {name:nonlatin}","symbol-placement":"line","text-rotation-alignment":"map"},paint:{"text-halo-blur":.5,"text-color":"#765","text-halo-width":1}},{id:"highway-shield",type:"symbol",source:"openmaptiles","source-layer":"transportation_name",minzoom:8,filter:["all",["<=","ref_length",6],["==","$type","LineString"],["!in","network","us-interstate","us-highway","us-state"]],layout:{"text-size":10,"icon-image":"road_{ref_length}","icon-rotation-alignment":"viewport","symbol-spacing":200,"text-font":["Open Sans Semibold"],"symbol-placement":{base:1,stops:[[10,"point"],[11,"line"]]},"text-rotation-alignment":"viewport","icon-size":1,"text-field":"{ref}"},paint:{}},{id:"highway-shield-us-interstate",type:"symbol",source:"openmaptiles","source-layer":"transportation_name",minzoom:7,filter:["all",["<=","ref_length",6],["==","$type","LineString"],["in","network","us-interstate"]],layout:{"text-size":10,"icon-image":"{network}_{ref_length}","icon-rotation-alignment":"viewport","symbol-spacing":200,"text-font":["Open Sans Semibold"],"symbol-placement":{base:1,stops:[[7,"point"],[7,"line"],[8,"line"]]},"text-rotation-alignment":"viewport","icon-size":1,"text-field":"{ref}"},paint:{"text-color":"rgba(0, 0, 0, 1)"}},{id:"highway-shield-us-other",type:"symbol",source:"openmaptiles","source-layer":"transportation_name",minzoom:9,filter:["all",["<=","ref_length",6],["==","$type","LineString"],["in","network","us-highway","us-state"]],layout:{"text-size":10,"icon-image":"{network}_{ref_length}","icon-rotation-alignment":"viewport","symbol-spacing":200,"text-font":["Open Sans Semibold"],"symbol-placement":{base:1,stops:[[10,"point"],[11,"line"]]},"text-rotation-alignment":"viewport","icon-size":1,"text-field":"{ref}"},paint:{"text-color":"rgba(0, 0, 0, 1)"}},{id:"place-other",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["!in","class","city","town","village"],["!has","name:de"]],layout:{"text-letter-spacing":.1,"text-size":{base:1.2,stops:[[12,10],[15,14]]},"text-font":["Open Sans Bold"],"text-field":`{name:latin}
{name:nonlatin}`,"text-transform":"uppercase","text-max-width":9},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-other-en",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["!in","class","city","town","village"],["has","name:de"]],layout:{"text-letter-spacing":.1,"text-size":{base:1.2,stops:[[12,10],[15,14]]},"text-font":["Open Sans Bold"],"text-field":`{name:de}
{name:nonlatin}`,"text-transform":"uppercase","text-max-width":9},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-village",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","village"],["!has","name:de"]],layout:{"text-font":["Open Sans Regular"],"text-size":{base:1.2,stops:[[10,12],[15,22]]},"text-field":`{name:latin}
{name:nonlatin}`,"text-max-width":8},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-village-en",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","village"],["has","name:de"]],layout:{"text-font":["Open Sans Regular"],"text-size":{base:1.2,stops:[[10,12],[15,22]]},"text-field":`{name:de}
{name:nonlatin}`,"text-max-width":8},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-town",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","town"],["!has","name:de"]],layout:{"text-font":["Open Sans Regular"],"text-size":{base:1.2,stops:[[10,14],[15,24]]},"text-field":`{name:latin}
{name:nonlatin}`,"text-max-width":8},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-town-en",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","town"],["has","name:de"]],layout:{"text-font":["Open Sans Regular"],"text-size":{base:1.2,stops:[[10,14],[15,24]]},"text-field":`{name:de}
{name:nonlatin}`,"text-max-width":8},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-city",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["!=","capital",2],["==","class","city"],["!has","name:de"]],layout:{"text-font":["Open Sans Semibold"],"text-size":{base:1.2,stops:[[7,14],[11,24]]},"text-field":`{name:latin}
{name:nonlatin}`,"text-max-width":8},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-city-en",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["!=","capital",2],["==","class","city"],["has","name:de"]],layout:{"text-font":["Open Sans Semibold"],"text-size":{base:1.2,stops:[[7,14],[11,24]]},"text-field":`{name:de}
{name:nonlatin}`,"text-max-width":8},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-city-capital",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","capital",2],["==","class","city"],["!has","name:de"]],layout:{"text-font":["Open Sans Semibold"],"text-size":{base:1.2,stops:[[7,14],[11,24]]},"text-field":`{name:latin}
{name:nonlatin}`,"text-max-width":8,"icon-image":"star_11","text-offset":[.4,0],"icon-size":.8,"text-anchor":"left"},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-city-capital-en",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","capital",2],["==","class","city"],["has","name:de"]],layout:{"text-font":["Open Sans Semibold"],"text-size":{base:1.2,stops:[[7,14],[11,24]]},"text-field":`{name:de}
{name:nonlatin}`,"text-max-width":8,"icon-image":"star_11","text-offset":[.4,0],"icon-size":.8,"text-anchor":"left"},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-country-3",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","country"],[">=","rank",3],["!has","name:de"]],layout:{"text-font":["Open Sans Bold"],"text-field":`{name:latin}
{name:nonlatin}`,"text-size":{stops:[[3,11],[7,17]]},"text-transform":"uppercase","text-max-width":6.25},paint:{"text-halo-blur":1,"text-color":"#fdfdfd","text-halo-width":2,"text-halo-color":"#433"}},{id:"place-country-3-en",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","country"],[">=","rank",3],["has","name:de"]],layout:{"text-font":["Open Sans Bold"],"text-field":`{name:de}
{name:nonlatin}`,"text-size":{stops:[[3,11],[7,17]]},"text-transform":"uppercase","text-max-width":6.25},paint:{"text-halo-blur":1,"text-color":"#fdfdfd","text-halo-width":2,"text-halo-color":"#433"}},{id:"place-country-2",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","country"],["==","rank",2],["!has","name:de"]],layout:{"text-font":["Open Sans Bold"],"text-field":`{name:latin}
{name:nonlatin}`,"text-size":{stops:[[2,11],[5,17]]},"text-transform":"uppercase","text-max-width":6.25},paint:{"text-halo-blur":1,"text-color":"#fdfdfd","text-halo-width":2,"text-halo-color":"#433"}},{id:"place-country-2-en",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","country"],["==","rank",2],["has","name:de"]],layout:{"text-font":["Open Sans Bold"],"text-field":`{name:de}
{name:nonlatin}`,"text-size":{stops:[[2,11],[5,17]]},"text-transform":"uppercase","text-max-width":6.25},paint:{"text-halo-blur":1,"text-color":"#fdfdfd","text-halo-width":2,"text-halo-color":"#433"}},{id:"place-country-1",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","country"],["==","rank",1],["!has","name:de"]],layout:{"text-font":["Open Sans Bold"],"text-field":`{name:latin}
{name:nonlatin}`,"text-size":{stops:[[1,11],[4,17]]},"text-transform":"uppercase","text-max-width":6.25},paint:{"text-halo-blur":1,"text-color":"#fdfdfd","text-halo-width":2,"text-halo-color":"#433"}},{id:"place-country-1-en",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","country"],["==","rank",1],["has","name:de"]],layout:{"text-font":["Open Sans Bold"],"text-field":`{name:de}
{name:nonlatin}`,"text-size":{stops:[[1,11],[4,17]]},"text-transform":"uppercase","text-max-width":6.25},paint:{"text-halo-blur":1,"text-color":"#fdfdfd","text-halo-width":2,"text-halo-color":"#433"}},{id:"place-continent",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",maxzoom:1,filter:["all",["==","class","continent"],["!has","name:de"]],layout:{"text-font":["Open Sans Bold"],"text-field":`{name:latin}
{name:nonlatin}`,"text-size":14,"text-max-width":6.25,"text-transform":"uppercase"},paint:{"text-halo-blur":1,"text-color":"#fdfdfd","text-halo-width":2,"text-halo-color":"#433"}},{id:"place-continent-en",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",maxzoom:1,filter:["all",["==","class","continent"],["has","name:de"]],layout:{"text-font":["Open Sans Bold"],"text-field":`{name:de}
{name:nonlatin}`,"text-size":14,"text-max-width":6.25,"text-transform":"uppercase"},paint:{"text-halo-blur":1,"text-color":"#fdfdfd","text-halo-width":2,"text-halo-color":"#433"}}]},z6e={version:8,name:"Oceanic Next",center:[8.542,47.372],zoom:11.6,bearing:0,pitch:0,sources:{openmaptiles:{type:"vector",url:ec.source_openmaptiles_url}},sprite:ec.sprite,glyphs:ec.glyphs,layers:[{id:"background",type:"background",paint:{"background-color":"#282822"}},{id:"landcover-glacier",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landcover",filter:["==","subclass","glacier"],layout:{visibility:"visible"},paint:{"fill-color":"#81a1c1","fill-opacity":{base:1,stops:[[0,.9],[10,.3]]}}},{id:"landuse-residential",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landuse",filter:["==","class","residential"],paint:{"fill-color":"#a3be8c"}},{id:"landuse-commercial",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landuse",filter:["all",["==","$type","Polygon"],["==","class","commercial"]],paint:{"fill-color":"#acc598"}},{id:"landuse-industrial",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landuse",filter:["all",["==","$type","Polygon"],["==","class","industrial"]],paint:{"fill-color":"#b5cba3"}},{id:"park",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"park",filter:["==","$type","Polygon"],paint:{"fill-color":"#a3be8c","fill-opacity":{base:1.8,stops:[[9,.5],[12,.2]]}}},{id:"park-outline",type:"line",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"park",filter:["==","$type","Polygon"],layout:{},paint:{"line-color":"rgba(163,19,14,0.6)","line-dasharray":[3,3]}},{id:"landuse-cemetery",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landuse",filter:["==","class","cemetery"],paint:{"fill-color":"#cbdabe"}},{id:"landuse-hospital",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landuse",filter:["==","class","hospital"],paint:{"fill-color":"#b48ead"}},{id:"landuse-school",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landuse",filter:["==","class","school"],paint:{"fill-color":"rgba(18,142,173,0.8)"}},{id:"landuse-railway",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landuse",filter:["==","class","railway"],paint:{"fill-color":"rgba(118,51,8,0.4)"}},{id:"landcover-wood",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landcover",filter:["==","class","wood"],paint:{"fill-color":"#81a1c1","fill-opacity":.1,"fill-outline-color":"hsla(0, 0%, 0%, 0.03)","fill-antialias":{base:1,stops:[[0,!1],[9,!0]]}}},{id:"landcover-grass",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landcover",filter:["==","class","grass"],paint:{"fill-color":"#a3be8c","fill-opacity":1}},{id:"landcover-grass-park",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"park",filter:["==","class","public_park"],paint:{"fill-color":"#a3be8c","fill-opacity":.8}},{id:"waterway-other",type:"line",metadata:{"mapbox:group":"1444849382550.77"},source:"openmaptiles","source-layer":"waterway",filter:["!in","class","canal","river","stream"],layout:{"line-cap":"round"},paint:{"line-color":"#8fbcbb","line-width":{base:1.3,stops:[[13,.5],[20,2]]}}},{id:"waterway-stream-canal",type:"line",metadata:{"mapbox:group":"1444849382550.77"},source:"openmaptiles","source-layer":"waterway",filter:["in","class","canal","stream"],layout:{"line-cap":"round"},paint:{"line-color":"#8fbcbb","line-width":{base:1.3,stops:[[13,.5],[20,6]]}}},{id:"waterway-river",type:"line",metadata:{"mapbox:group":"1444849382550.77"},source:"openmaptiles","source-layer":"waterway",filter:["==","class","river"],layout:{"line-cap":"round"},paint:{"line-color":"#8fbcbb","line-width":{base:1.2,stops:[[10,.8],[20,6]]}}},{id:"water-offset",type:"fill",metadata:{"mapbox:group":"1444849382550.77"},source:"openmaptiles","source-layer":"water",maxzoom:8,filter:["==","$type","Polygon"],layout:{visibility:"visible"},paint:{"fill-opacity":1,"fill-color":"#8fbcbb","fill-translate":{base:1,stops:[[6,[2,0]],[8,[0,0]]]}}},{id:"water",type:"fill",metadata:{"mapbox:group":"1444849382550.77"},source:"openmaptiles","source-layer":"water",layout:{visibility:"visible"},paint:{"fill-color":"#5f9f9e"}},{id:"water-pattern",type:"fill",metadata:{"mapbox:group":"1444849382550.77"},source:"openmaptiles","source-layer":"water",layout:{visibility:"visible"},paint:{"fill-translate":[0,2.5],"fill-pattern":"wave"}},{id:"landcover-ice-shelf",type:"fill",metadata:{"mapbox:group":"1444849382550.77"},source:"openmaptiles","source-layer":"landcover",filter:["==","subclass","ice_shelf"],layout:{visibility:"visible"},paint:{"fill-color":"#81a1c1","fill-opacity":{base:1,stops:[[0,.9],[10,.3]]}}},{id:"building",type:"fill",metadata:{"mapbox:group":"1444849364238.8171"},source:"openmaptiles","source-layer":"building",paint:{"fill-color":"#65737e","fill-antialias":!0}},{id:"building-top",type:"fill",metadata:{"mapbox:group":"1444849364238.8171"},source:"openmaptiles","source-layer":"building",layout:{visibility:"visible"},paint:{"fill-translate":{base:1,stops:[[14,[0,0]],[16,[-2,-2]]]},"fill-outline-color":"#dfdbd7","fill-color":"#7e8d98","fill-opacity":{base:1,stops:[[13,0],[16,1]]}}},{id:"tunnel-service-track-casing",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["in","class","service","track"]],layout:{"line-join":"round"},paint:{"line-color":"#d65d0e","line-dasharray":[.5,.25],"line-width":{base:1.2,stops:[[15,1],[16,4],[20,11]]}}},{id:"tunnel-minor-casing",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["==","class","minor"]],layout:{"line-join":"round"},paint:{"line-color":"#d65d0e","line-opacity":{stops:[[12,0],[12.5,1]]},"line-width":{base:1.2,stops:[[12,.5],[13,1],[14,4],[20,15]]}}},{id:"tunnel-secondary-tertiary-casing",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["in","class","secondary","tertiary"]],layout:{"line-join":"round"},paint:{"line-color":"#d65d0e","line-opacity":1,"line-width":{base:1.2,stops:[[8,1.5],[20,17]]}}},{id:"tunnel-trunk-primary-casing",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["in","class","primary","trunk"]],layout:{"line-join":"round"},paint:{"line-color":"#d65d0e","line-width":{base:1.2,stops:[[5,.4],[6,.6],[7,1.5],[20,22]]}}},{id:"tunnel-motorway-casing",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["==","class","motorway"]],layout:{"line-join":"round",visibility:"visible"},paint:{"line-color":"#d65d0e","line-dasharray":[.5,.25],"line-width":{base:1.2,stops:[[5,.4],[6,.6],[7,1.5],[20,22]]}}},{id:"tunnel-path",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["==","brunnel","tunnel"],["==","class","path"]]],paint:{"line-color":"#f17626","line-dasharray":[1.5,.75],"line-width":{base:1.2,stops:[[15,1.2],[20,4]]}}},{id:"tunnel-service-track",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["in","class","service","track"]],layout:{"line-join":"round"},paint:{"line-color":"#f17626","line-width":{base:1.2,stops:[[15.5,0],[16,2],[20,7.5]]}}},{id:"tunnel-minor",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["==","class","minor_road"]],layout:{"line-join":"round"},paint:{"line-color":"#f17626","line-opacity":1,"line-width":{base:1.2,stops:[[13.5,0],[14,2.5],[20,11.5]]}}},{id:"tunnel-secondary-tertiary",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["in","class","secondary","tertiary"]],layout:{"line-join":"round"},paint:{"line-color":"#f2853e","line-width":{base:1.2,stops:[[6.5,0],[7,.5],[20,10]]}}},{id:"tunnel-trunk-primary",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["in","class","primary","trunk"]],layout:{"line-join":"round"},paint:{"line-color":"#d65d0e","line-width":{base:1.2,stops:[[6.5,0],[7,.5],[20,18]]}}},{id:"tunnel-motorway",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["==","class","motorway"]],layout:{"line-join":"round",visibility:"visible"},paint:{"line-color":"rgba(235,219,178,0.8)","line-width":{base:1.2,stops:[[6.5,0],[7,.5],[20,18]]}}},{id:"tunnel-railway",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["==","class","rail"]],paint:{"line-color":"#763308","line-width":{base:1.4,stops:[[14,.4],[15,.75],[20,2]]},"line-dasharray":[2,2]}},{id:"aeroway-taxiway-casing",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"aeroway",minzoom:12,filter:["all",["in","class","taxiway"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#763308","line-width":{base:1.5,stops:[[11,2],[17,12]]},"line-opacity":1}},{id:"aeroway-runway-casing",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"aeroway",minzoom:12,filter:["all",["in","class","runway"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#763308","line-width":{base:1.5,stops:[[11,5],[17,55]]},"line-opacity":1}},{id:"aeroway-area",type:"fill",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"aeroway",minzoom:4,filter:["all",["==","$type","Polygon"],["in","class","runway","taxiway"]],layout:{visibility:"visible"},paint:{"fill-opacity":{base:1,stops:[[13,0],[14,1]]},"fill-color":"rgba(214,93,14,0.5)"}},{id:"aeroway-taxiway",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"aeroway",minzoom:4,filter:["all",["in","class","taxiway"],["==","$type","LineString"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#f2853e","line-width":{base:1.5,stops:[[11,1],[17,10]]},"line-opacity":{base:1,stops:[[11,0],[12,1]]}}},{id:"aeroway-runway",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"aeroway",minzoom:4,filter:["all",["in","class","runway"],["==","$type","LineString"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#f2853e","line-width":{base:1.5,stops:[[11,4],[17,50]]},"line-opacity":{base:1,stops:[[11,0],[12,1]]}}},{id:"highway-area",type:"fill",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["==","$type","Polygon"],layout:{visibility:"visible"},paint:{"fill-color":"#a6480b","fill-outline-color":"#cfcdca","fill-opacity":.9,"fill-antialias":!1}},{id:"highway-motorway-link-casing",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",minzoom:12,filter:["all",["!in","brunnel","bridge","tunnel"],["==","class","motorway_link"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#d65d0e","line-opacity":1,"line-width":{base:1.2,stops:[[12,1],[13,3],[14,4],[20,15]]}}},{id:"highway-link-casing",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",minzoom:13,filter:["all",["!in","brunnel","bridge","tunnel"],["in","class","primary_link","secondary_link","tertiary_link","trunk_link"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#d65d0e","line-opacity":1,"line-width":{base:1.2,stops:[[12,1],[13,3],[14,4],[20,15]]}}},{id:"highway-minor-casing",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["!=","brunnel","tunnel"],["in","class","minor","service","track"]]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"rgba(214,93,14,0.8)","line-opacity":{stops:[[12,0],[12.5,1]]},"line-width":{base:1.2,stops:[[12,.5],[13,1],[14,4],[20,15]]}}},{id:"highway-secondary-tertiary-casing",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["!in","brunnel","bridge","tunnel"],["in","class","secondary","tertiary"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#d65d0e","line-opacity":1,"line-width":{base:1.2,stops:[[8,1.5],[20,17]]}}},{id:"highway-primary-casing",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",minzoom:5,filter:["all",["!in","brunnel","bridge","tunnel"],["in","class","primary"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#d65d0e","line-opacity":{stops:[[7,0],[8,1]]},"line-width":{base:1.2,stops:[[7,0],[8,.6],[9,1.5],[20,22]]}}},{id:"highway-trunk-casing",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",minzoom:5,filter:["all",["!in","brunnel","bridge","tunnel"],["in","class","trunk"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#d65d0e","line-opacity":{stops:[[5,0],[6,1]]},"line-width":{base:1.2,stops:[[5,0],[6,.6],[7,1.5],[20,22]]}}},{id:"highway-motorway-casing",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",minzoom:4,filter:["all",["!in","brunnel","bridge","tunnel"],["==","class","motorway"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#d65d0e","line-width":{base:1.2,stops:[[4,0],[5,.4],[6,.6],[7,1.5],[20,22]]},"line-opacity":{stops:[[4,0],[5,1]]}}},{id:"highway-path",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["!in","brunnel","bridge","tunnel"],["==","class","path"]]],paint:{"line-color":"#b48ead","line-dasharray":[1.5,.75],"line-width":{base:1.2,stops:[[15,1.2],[20,4]]}}},{id:"highway-motorway-link",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",minzoom:12,filter:["all",["!in","brunnel","bridge","tunnel"],["==","class","motorway_link"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#ebdbb2","line-width":{base:1.2,stops:[[12.5,0],[13,1.5],[14,2.5],[20,11.5]]}}},{id:"highway-link",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",minzoom:13,filter:["all",["!in","brunnel","bridge","tunnel"],["in","class","primary_link","secondary_link","tertiary_link","trunk_link"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#ebdbb2","line-width":{base:1.2,stops:[[12.5,0],[13,1.5],[14,2.5],[20,11.5]]}}},{id:"highway-minor",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["!=","brunnel","tunnel"],["in","class","minor","service","track"]]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#f49456","line-opacity":1,"line-width":{base:1.2,stops:[[13.5,0],[14,2.5],[20,11.5]]}}},{id:"highway-secondary-tertiary",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["!in","brunnel","bridge","tunnel"],["in","class","secondary","tertiary"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#ebdbb2","line-width":{base:1.2,stops:[[6.5,0],[8,.5],[20,13]]}}},{id:"highway-primary",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["!in","brunnel","bridge","tunnel"],["in","class","primary"]]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#ebdbb2","line-width":{base:1.2,stops:[[8.5,0],[9,.5],[20,18]]}}},{id:"highway-trunk",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["!in","brunnel","bridge","tunnel"],["in","class","trunk"]]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#ebdbb2","line-width":{base:1.2,stops:[[6.5,0],[7,.5],[20,18]]}}},{id:"highway-motorway",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",minzoom:5,filter:["all",["==","$type","LineString"],["all",["!in","brunnel","bridge","tunnel"],["==","class","motorway"]]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#ebdbb2","line-width":{base:1.2,stops:[[6.5,0],[7,.5],[20,18]]}}},{id:"railway-service",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["==","class","rail"],["has","service"]]],paint:{"line-color":"rgba(118,51,8,0.7)","line-width":{base:1.4,stops:[[14,.4],[20,1]]}}},{id:"railway-service-hatching",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["==","class","rail"],["has","service"]]],layout:{visibility:"visible"},paint:{"line-color":"rgba(118,51,8,0.7)","line-dasharray":[.2,8],"line-width":{base:1.4,stops:[[14.5,0],[15,2],[20,6]]}}},{id:"railway",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["!has","service"],["!in","brunnel","bridge","tunnel"],["==","class","rail"]]],paint:{"line-color":"#763308","line-width":{base:1.4,stops:[[14,.4],[15,.75],[20,2]]}}},{id:"railway-hatching",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["!has","service"],["!in","brunnel","bridge","tunnel"],["==","class","rail"]]],paint:{"line-color":"#763308","line-dasharray":[.2,8],"line-width":{base:1.4,stops:[[14.5,0],[15,3],[20,8]]}}},{id:"bridge-motorway-link-casing",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["==","class","motorway_link"]],layout:{"line-join":"round"},paint:{"line-color":"#d65d0e","line-opacity":1,"line-width":{base:1.2,stops:[[12,1],[13,3],[14,4],[20,15]]}}},{id:"bridge-link-casing",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["in","class","primary_link","secondary_link","tertiary_link","trunk_link"]],layout:{"line-join":"round"},paint:{"line-color":"#d65d0e","line-opacity":1,"line-width":{base:1.2,stops:[[12,1],[13,3],[14,4],[20,15]]}}},{id:"bridge-secondary-tertiary-casing",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["in","class","secondary","tertiary"]],layout:{"line-join":"round"},paint:{"line-color":"#d65d0e","line-opacity":1,"line-width":{base:1.2,stops:[[8,1.5],[20,28]]}}},{id:"bridge-trunk-primary-casing",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["in","class","primary","trunk"]],layout:{"line-join":"round"},paint:{"line-color":"#d65d0e","line-width":{base:1.2,stops:[[5,.4],[6,.6],[7,1.5],[20,26]]}}},{id:"bridge-motorway-casing",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["==","class","motorway"]],layout:{"line-join":"round"},paint:{"line-color":"#d65d0e","line-width":{base:1.2,stops:[[5,.4],[6,.6],[7,1.5],[20,22]]}}},{id:"bridge-path-casing",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["==","brunnel","bridge"],["==","class","path"]]],paint:{"line-color":"#f17626","line-width":{base:1.2,stops:[[15,1.2],[20,18]]}}},{id:"bridge-path",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["==","brunnel","bridge"],["==","class","path"]]],paint:{"line-color":"#b48ead","line-width":{base:1.2,stops:[[15,1.2],[20,4]]},"line-dasharray":[1.5,.75]}},{id:"bridge-motorway-link",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["==","class","motorway_link"]],layout:{"line-join":"round"},paint:{"line-color":"#ebdbb2","line-width":{base:1.2,stops:[[12.5,0],[13,1.5],[14,2.5],[20,11.5]]}}},{id:"bridge-link",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["in","class","primary_link","secondary_link","tertiary_link","trunk_link"]],layout:{"line-join":"round"},paint:{"line-color":"#ebdbb2","line-width":{base:1.2,stops:[[12.5,0],[13,1.5],[14,2.5],[20,11.5]]}}},{id:"bridge-secondary-tertiary",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["in","class","secondary","tertiary"]],layout:{"line-join":"round"},paint:{"line-color":"#ebdbb2","line-width":{base:1.2,stops:[[6.5,0],[7,.5],[20,20]]}}},{id:"bridge-trunk-primary",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["in","class","primary","trunk"]],layout:{"line-join":"round"},paint:{"line-color":"#ebdbb2","line-width":{base:1.2,stops:[[6.5,0],[7,.5],[20,18]]}}},{id:"bridge-motorway",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["==","class","motorway"]],layout:{"line-join":"round"},paint:{"line-color":"#ebdbb2","line-width":{base:1.2,stops:[[6.5,0],[7,.5],[20,18]]}}},{id:"bridge-railway",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["==","class","rail"]],paint:{"line-color":"#763308","line-width":{base:1.4,stops:[[14,.4],[15,.75],[20,2]]}}},{id:"bridge-railway-hatching",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["==","class","rail"]],paint:{"line-color":"#763308","line-dasharray":[.2,8],"line-width":{base:1.4,stops:[[14.5,0],[15,3],[20,8]]}}},{id:"boundary-land-level-4",type:"line",source:"openmaptiles","source-layer":"boundary",filter:["all",["in","admin_level",4,6,8],["!=","maritime",1]],layout:{"line-join":"round"},paint:{"line-color":"#8fbcbb","line-dasharray":[3,1,1,1],"line-width":{base:1.4,stops:[[4,.4],[5,1],[12,3]]}}},{id:"boundary-land-level-2",type:"line",source:"openmaptiles","source-layer":"boundary",filter:["all",["==","admin_level",2],["!=","maritime",1]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#8fbcbb","line-width":{base:1,stops:[[0,.6],[4,1.4],[5,2],[12,8]]}}},{id:"boundary-water",type:"line",source:"openmaptiles","source-layer":"boundary",filter:["all",["in","admin_level",2,4],["==","maritime",1]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#8fbcbb","line-width":{base:1,stops:[[0,.6],[4,1.4],[5,2],[12,8]]},"line-opacity":{stops:[[6,.6],[10,1]]}}},{id:"waterway-name",type:"symbol",source:"openmaptiles","source-layer":"waterway",minzoom:13,filter:["all",["==","$type","LineString"],["has","name"],["!has","name:de"]],layout:{"text-font":["Open Sans Italic"],"text-size":14,"text-field":"{name:latin} {name:nonlatin}","text-max-width":5,"text-rotation-alignment":"map","symbol-placement":"line","text-letter-spacing":.2,"symbol-spacing":350},paint:{"text-color":"#fefefe","text-halo-width":1.5,"text-halo-color":"#74aee9"}},{id:"waterway-name-en",type:"symbol",source:"openmaptiles","source-layer":"waterway",minzoom:13,filter:["all",["==","$type","LineString"],["has","name"],["has","name:de"]],layout:{"text-font":["Open Sans Italic"],"text-size":14,"text-field":"{name:de} {name:nonlatin}","text-max-width":5,"text-rotation-alignment":"map","symbol-placement":"line","text-letter-spacing":.2,"symbol-spacing":350},paint:{"text-color":"#fefefe","text-halo-width":1.5,"text-halo-color":"#74aee9"}},{id:"water-name-lakeline",type:"symbol",source:"openmaptiles","source-layer":"water_name",filter:["all",["==","$type","LineString"],["!has","name:de"]],layout:{"text-font":["Open Sans Italic"],"text-size":14,"text-field":"{name:latin} {name:nonlatin}","text-max-width":5,"text-rotation-alignment":"map","symbol-placement":"line","symbol-spacing":350,"text-letter-spacing":.2},paint:{"text-color":"#fefefe","text-halo-width":1.5,"text-halo-color":"#74aee9"}},{id:"water-name-lakeline-en",type:"symbol",source:"openmaptiles","source-layer":"water_name",filter:["all",["==","$type","LineString"],["has","name:de"]],layout:{"text-font":["Open Sans Italic"],"text-size":14,"text-field":"{name:de} {name:nonlatin}","text-max-width":5,"text-rotation-alignment":"map","symbol-placement":"line","symbol-spacing":350,"text-letter-spacing":.2},paint:{"text-color":"#fefefe","text-halo-width":1.5,"text-halo-color":"#74aee9"}},{id:"water-name-ocean",type:"symbol",source:"openmaptiles","source-layer":"water_name",filter:["all",["==","$type","Point"],["==","class","ocean"],["!has","name:de"]],layout:{"text-font":["Open Sans Italic"],"text-size":14,"text-field":`{name:latin}
{name:nonlatin}`,"text-max-width":5,"text-rotation-alignment":"map","symbol-placement":"point","symbol-spacing":350,"text-letter-spacing":.2},paint:{"text-color":"#fefefe","text-halo-width":1.5,"text-halo-color":"#74aee9"}},{id:"water-name-ocean-en",type:"symbol",source:"openmaptiles","source-layer":"water_name",filter:["all",["==","$type","Point"],["==","class","ocean"],["has","name:de"]],layout:{"text-font":["Open Sans Italic"],"text-size":14,"text-field":`{name:de}
{name:nonlatin}`,"text-max-width":5,"text-rotation-alignment":"map","symbol-placement":"point","symbol-spacing":350,"text-letter-spacing":.2},paint:{"text-color":"#fefefe","text-halo-width":1.5,"text-halo-color":"#74aee9"}},{id:"water-name-other",type:"symbol",source:"openmaptiles","source-layer":"water_name",filter:["all",["==","$type","Point"],["!in","class","ocean"],["!has","name:de"]],layout:{"text-font":["Open Sans Italic"],"text-size":{stops:[[0,10],[6,14]]},"text-field":`{name:latin}
{name:nonlatin}`,"text-max-width":5,"text-rotation-alignment":"map","symbol-placement":"point","symbol-spacing":350,"text-letter-spacing":.2,visibility:"visible"},paint:{"text-color":"#fefefe","text-halo-width":1.5,"text-halo-color":"#74aee9"}},{id:"water-name-other-en",type:"symbol",source:"openmaptiles","source-layer":"water_name",filter:["all",["==","$type","Point"],["!in","class","ocean"],["has","name:de"]],layout:{"text-font":["Open Sans Italic"],"text-size":{stops:[[0,10],[6,14]]},"text-field":`{name:de}
{name:nonlatin}`,"text-max-width":5,"text-rotation-alignment":"map","symbol-placement":"point","symbol-spacing":350,"text-letter-spacing":.2,visibility:"visible"},paint:{"text-color":"#fefefe","text-halo-width":1.5,"text-halo-color":"#74aee9"}},{id:"poi-level-3",type:"symbol",source:"openmaptiles","source-layer":"poi",minzoom:16,filter:["all",["==","$type","Point"],[">=","rank",25],["!has","name:de"]],layout:{"text-padding":2,"text-font":["Open Sans Semibold"],"text-anchor":"top","icon-image":"{class}_11","text-field":`{name:latin}
{name:nonlatin}`,"text-offset":[0,.6],"text-size":12,"text-max-width":9},paint:{"text-halo-blur":.5,"text-color":"#fdfdfd","text-halo-width":1,"text-halo-color":"#633"}},{id:"poi-level-3-en",type:"symbol",source:"openmaptiles","source-layer":"poi",minzoom:16,filter:["all",["==","$type","Point"],[">=","rank",25],["has","name:de"]],layout:{"text-padding":2,"text-font":["Open Sans Semibold"],"text-anchor":"top","icon-image":"{class}_11","text-field":`{name:de}
{name:nonlatin}`,"text-offset":[0,.6],"text-size":12,"text-max-width":9},paint:{"text-halo-blur":.5,"text-color":"#fdfdfd","text-halo-width":1,"text-halo-color":"#633"}},{id:"poi-level-2",type:"symbol",source:"openmaptiles","source-layer":"poi",minzoom:15,filter:["all",["==","$type","Point"],["all",["<=","rank",24],[">=","rank",15]],["!has","name:de"]],layout:{"text-padding":2,"text-font":["Open Sans Semibold"],"text-anchor":"top","icon-image":"{class}_11","text-field":`{name:latin}
{name:nonlatin}`,"text-offset":[0,.6],"text-size":12,"text-max-width":9},paint:{"text-halo-blur":.5,"text-color":"#fdfdfd","text-halo-width":1,"text-halo-color":"#633"}},{id:"poi-level-2-en",type:"symbol",source:"openmaptiles","source-layer":"poi",minzoom:15,filter:["all",["==","$type","Point"],["all",["<=","rank",24],[">=","rank",15]],["has","name:de"]],layout:{"text-padding":2,"text-font":["Open Sans Semibold"],"text-anchor":"top","icon-image":"{class}_11","text-field":`{name:de}
{name:nonlatin}`,"text-offset":[0,.6],"text-size":12,"text-max-width":9},paint:{"text-halo-blur":.5,"text-color":"#fdfdfd","text-halo-width":1,"text-halo-color":"#633"}},{id:"poi-level-1",type:"symbol",source:"openmaptiles","source-layer":"poi",minzoom:14,filter:["all",["==","$type","Point"],["all",["<=","rank",14],["has","name"]],["!has","name:de"]],layout:{"text-padding":2,"text-font":["Open Sans Semibold"],"text-anchor":"top","icon-image":"{class}_11","text-field":`{name:latin}
{name:nonlatin}`,"text-offset":[0,.6],"text-size":12,"text-max-width":9},paint:{"text-halo-blur":.5,"text-color":"#fdfdfd","text-halo-width":1,"text-halo-color":"#633"}},{id:"poi-level-1-en",type:"symbol",source:"openmaptiles","source-layer":"poi",minzoom:14,filter:["all",["==","$type","Point"],["all",["<=","rank",14],["has","name"]],["has","name:de"]],layout:{"text-padding":2,"text-font":["Open Sans Semibold"],"text-anchor":"top","icon-image":"{class}_11","text-field":`{name:de}
{name:nonlatin}`,"text-offset":[0,.6],"text-size":12,"text-max-width":9},paint:{"text-halo-blur":.5,"text-color":"#fdfdfd","text-halo-width":1,"text-halo-color":"#633"}},{id:"highway-name-path",type:"symbol",source:"openmaptiles","source-layer":"transportation_name",minzoom:15.5,filter:["all",["==","class","path"],["!has","name:de"]],layout:{"text-size":{base:1,stops:[[13,12],[14,13]]},"text-font":["Open Sans Regular"],"text-field":"{name:latin} {name:nonlatin}","symbol-placement":"line","text-rotation-alignment":"map"},paint:{"text-halo-color":"#f8f4f0","text-color":"hsl(30, 23%, 62%)","text-halo-width":.5}},{id:"highway-name-path-en",type:"symbol",source:"openmaptiles","source-layer":"transportation_name",minzoom:15.5,filter:["all",["==","class","path"],["has","name:de"]],layout:{"text-size":{base:1,stops:[[13,12],[14,13]]},"text-font":["Open Sans Regular"],"text-field":"{name:de} {name:nonlatin}","symbol-placement":"line","text-rotation-alignment":"map"},paint:{"text-halo-color":"#f8f4f0","text-color":"hsl(30, 23%, 62%)","text-halo-width":.5}},{id:"highway-name-minor",type:"symbol",source:"openmaptiles","source-layer":"transportation_name",minzoom:15,filter:["all",["==","$type","LineString"],["in","class","minor","service","track"],["!has","name:de"]],layout:{"text-size":{base:1,stops:[[13,12],[14,13]]},"text-font":["Open Sans Regular"],"text-field":"{name:latin} {name:nonlatin}","symbol-placement":"line","text-rotation-alignment":"map"},paint:{"text-halo-blur":.5,"text-color":"#765","text-halo-width":1}},{id:"highway-name-minor-en",type:"symbol",source:"openmaptiles","source-layer":"transportation_name",minzoom:15,filter:["all",["==","$type","LineString"],["in","class","minor","service","track"],["has","name:de"]],layout:{"text-size":{base:1,stops:[[13,12],[14,13]]},"text-font":["Open Sans Regular"],"text-field":"{name:de} {name:nonlatin}","symbol-placement":"line","text-rotation-alignment":"map"},paint:{"text-halo-blur":.5,"text-color":"#765","text-halo-width":1}},{id:"highway-name-major",type:"symbol",source:"openmaptiles","source-layer":"transportation_name",minzoom:12.2,filter:["all",["in","class","primary","secondary","tertiary","trunk"],["!has","name:de"]],layout:{"text-size":{base:1,stops:[[13,12],[14,13]]},"text-font":["Open Sans Regular"],"text-field":"{name:latin} {name:nonlatin}","symbol-placement":"line","text-rotation-alignment":"map"},paint:{"text-halo-blur":.5,"text-color":"#765","text-halo-width":1}},{id:"highway-name-major-en",type:"symbol",source:"openmaptiles","source-layer":"transportation_name",minzoom:12.2,filter:["all",["in","class","primary","secondary","tertiary","trunk"],["has","name:de"]],layout:{"text-size":{base:1,stops:[[13,12],[14,13]]},"text-font":["Open Sans Regular"],"text-field":"{name:de} {name:nonlatin}","symbol-placement":"line","text-rotation-alignment":"map"},paint:{"text-halo-blur":.5,"text-color":"#765","text-halo-width":1}},{id:"highway-shield",type:"symbol",source:"openmaptiles","source-layer":"transportation_name",minzoom:8,filter:["all",["<=","ref_length",6],["==","$type","LineString"],["!in","network","us-interstate","us-highway","us-state"]],layout:{"text-size":10,"icon-image":"road_{ref_length}","icon-rotation-alignment":"viewport","symbol-spacing":200,"text-font":["Open Sans Semibold"],"symbol-placement":{base:1,stops:[[10,"point"],[11,"line"]]},"text-rotation-alignment":"viewport","icon-size":1,"text-field":"{ref}"},paint:{}},{id:"highway-shield-us-interstate",type:"symbol",source:"openmaptiles","source-layer":"transportation_name",minzoom:7,filter:["all",["<=","ref_length",6],["==","$type","LineString"],["in","network","us-interstate"]],layout:{"text-size":10,"icon-image":"{network}_{ref_length}","icon-rotation-alignment":"viewport","symbol-spacing":200,"text-font":["Open Sans Semibold"],"symbol-placement":{base:1,stops:[[7,"point"],[7,"line"],[8,"line"]]},"text-rotation-alignment":"viewport","icon-size":1,"text-field":"{ref}"},paint:{"text-color":"rgba(0, 0, 0, 1)"}},{id:"highway-shield-us-other",type:"symbol",source:"openmaptiles","source-layer":"transportation_name",minzoom:9,filter:["all",["<=","ref_length",6],["==","$type","LineString"],["in","network","us-highway","us-state"]],layout:{"text-size":10,"icon-image":"{network}_{ref_length}","icon-rotation-alignment":"viewport","symbol-spacing":200,"text-font":["Open Sans Semibold"],"symbol-placement":{base:1,stops:[[10,"point"],[11,"line"]]},"text-rotation-alignment":"viewport","icon-size":1,"text-field":"{ref}"},paint:{"text-color":"rgba(0, 0, 0, 1)"}},{id:"place-other",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["!in","class","city","town","village"],["!has","name:de"]],layout:{"text-letter-spacing":.1,"text-size":{base:1.2,stops:[[12,10],[15,14]]},"text-font":["Open Sans Bold"],"text-field":`{name:latin}
{name:nonlatin}`,"text-transform":"uppercase","text-max-width":9},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-other-en",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["!in","class","city","town","village"],["has","name:de"]],layout:{"text-letter-spacing":.1,"text-size":{base:1.2,stops:[[12,10],[15,14]]},"text-font":["Open Sans Bold"],"text-field":`{name:de}
{name:nonlatin}`,"text-transform":"uppercase","text-max-width":9},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-village",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","village"],["!has","name:de"]],layout:{"text-font":["Open Sans Regular"],"text-size":{base:1.2,stops:[[10,12],[15,22]]},"text-field":`{name:latin}
{name:nonlatin}`,"text-max-width":8},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-village-en",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","village"],["has","name:de"]],layout:{"text-font":["Open Sans Regular"],"text-size":{base:1.2,stops:[[10,12],[15,22]]},"text-field":`{name:de}
{name:nonlatin}`,"text-max-width":8},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-town",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","town"],["!has","name:de"]],layout:{"text-font":["Open Sans Regular"],"text-size":{base:1.2,stops:[[10,14],[15,24]]},"text-field":`{name:latin}
{name:nonlatin}`,"text-max-width":8},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-town-en",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","town"],["has","name:de"]],layout:{"text-font":["Open Sans Regular"],"text-size":{base:1.2,stops:[[10,14],[15,24]]},"text-field":`{name:de}
{name:nonlatin}`,"text-max-width":8},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-city",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["!=","capital",2],["==","class","city"],["!has","name:de"]],layout:{"text-font":["Open Sans Semibold"],"text-size":{base:1.2,stops:[[7,14],[11,24]]},"text-field":`{name:latin}
{name:nonlatin}`,"text-max-width":8},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-city-en",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["!=","capital",2],["==","class","city"],["has","name:de"]],layout:{"text-font":["Open Sans Semibold"],"text-size":{base:1.2,stops:[[7,14],[11,24]]},"text-field":`{name:de}
{name:nonlatin}`,"text-max-width":8},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-city-capital",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","capital",2],["==","class","city"],["!has","name:de"]],layout:{"text-font":["Open Sans Semibold"],"text-size":{base:1.2,stops:[[7,14],[11,24]]},"text-field":`{name:latin}
{name:nonlatin}`,"text-max-width":8,"icon-image":"star_11","text-offset":[.4,0],"icon-size":.8,"text-anchor":"left"},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-city-capital-en",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","capital",2],["==","class","city"],["has","name:de"]],layout:{"text-font":["Open Sans Semibold"],"text-size":{base:1.2,stops:[[7,14],[11,24]]},"text-field":`{name:de}
{name:nonlatin}`,"text-max-width":8,"icon-image":"star_11","text-offset":[.4,0],"icon-size":.8,"text-anchor":"left"},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-country-3",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","country"],[">=","rank",3],["!has","name:de"]],layout:{"text-font":["Open Sans Bold"],"text-field":`{name:latin}
{name:nonlatin}`,"text-size":{stops:[[3,11],[7,17]]},"text-transform":"uppercase","text-max-width":6.25},paint:{"text-halo-blur":1,"text-color":"#fdfdfd","text-halo-width":2,"text-halo-color":"#433"}},{id:"place-country-3-en",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","country"],[">=","rank",3],["has","name:de"]],layout:{"text-font":["Open Sans Bold"],"text-field":`{name:de}
{name:nonlatin}`,"text-size":{stops:[[3,11],[7,17]]},"text-transform":"uppercase","text-max-width":6.25},paint:{"text-halo-blur":1,"text-color":"#fdfdfd","text-halo-width":2,"text-halo-color":"#433"}},{id:"place-country-2",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","country"],["==","rank",2],["!has","name:de"]],layout:{"text-font":["Open Sans Bold"],"text-field":`{name:latin}
{name:nonlatin}`,"text-size":{stops:[[2,11],[5,17]]},"text-transform":"uppercase","text-max-width":6.25},paint:{"text-halo-blur":1,"text-color":"#fdfdfd","text-halo-width":2,"text-halo-color":"#433"}},{id:"place-country-2-en",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","country"],["==","rank",2],["has","name:de"]],layout:{"text-font":["Open Sans Bold"],"text-field":`{name:de}
{name:nonlatin}`,"text-size":{stops:[[2,11],[5,17]]},"text-transform":"uppercase","text-max-width":6.25},paint:{"text-halo-blur":1,"text-color":"#fdfdfd","text-halo-width":2,"text-halo-color":"#433"}},{id:"place-country-1",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","country"],["==","rank",1],["!has","name:de"]],layout:{"text-font":["Open Sans Bold"],"text-field":`{name:latin}
{name:nonlatin}`,"text-size":{stops:[[1,11],[4,17]]},"text-transform":"uppercase","text-max-width":6.25},paint:{"text-halo-blur":1,"text-color":"#fdfdfd","text-halo-width":2,"text-halo-color":"#433"}},{id:"place-country-1-en",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","country"],["==","rank",1],["has","name:de"]],layout:{"text-font":["Open Sans Bold"],"text-field":`{name:de}
{name:nonlatin}`,"text-size":{stops:[[1,11],[4,17]]},"text-transform":"uppercase","text-max-width":6.25},paint:{"text-halo-blur":1,"text-color":"#fdfdfd","text-halo-width":2,"text-halo-color":"#433"}},{id:"place-continent",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",maxzoom:1,filter:["all",["==","class","continent"],["!has","name:de"]],layout:{"text-font":["Open Sans Bold"],"text-field":`{name:latin}
{name:nonlatin}`,"text-size":14,"text-max-width":6.25,"text-transform":"uppercase"},paint:{"text-halo-blur":1,"text-color":"#fdfdfd","text-halo-width":2,"text-halo-color":"#433"}},{id:"place-continent-en",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",maxzoom:1,filter:["all",["==","class","continent"],["has","name:de"]],layout:{"text-font":["Open Sans Bold"],"text-field":`{name:de}
{name:nonlatin}`,"text-size":14,"text-max-width":6.25,"text-transform":"uppercase"},paint:{"text-halo-blur":1,"text-color":"#fdfdfd","text-halo-width":2,"text-halo-color":"#433"}}]},j6e={version:8,name:"Medieval Kingdom",center:[8.542,47.372],zoom:11.6,bearing:0,pitch:0,sources:{openmaptiles:{type:"vector",url:ec.source_openmaptiles_url}},sprite:ec.sprite,glyphs:ec.glyphs,layers:[{id:"background",type:"background",paint:{"background-color":"#ffd1a8"}},{id:"landcover-glacier",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landcover",filter:["==","subclass","glacier"],layout:{visibility:"visible"},paint:{"fill-color":"#228B22","fill-opacity":{base:1,stops:[[0,.9],[10,.3]]}}},{id:"landuse-residential",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landuse",filter:["==","class","residential"],paint:{"fill-color":"#bfa677"}},{id:"landuse-commercial",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landuse",filter:["all",["==","$type","Polygon"],["==","class","commercial"]],paint:{"fill-color":"#c5af85"}},{id:"landuse-industrial",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landuse",filter:["all",["==","$type","Polygon"],["==","class","industrial"]],paint:{"fill-color":"#ccb892"}},{id:"park",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"park",filter:["==","$type","Polygon"],paint:{"fill-color":"#556B2F","fill-opacity":{base:1.8,stops:[[9,.5],[12,.2]]}}},{id:"park-outline",type:"line",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"park",filter:["==","$type","Polygon"],layout:{},paint:{"line-color":"rgba(85,107,47,0.6)","line-dasharray":[3,3]}},{id:"landuse-cemetery",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landuse",filter:["==","class","cemetery"],paint:{"fill-color":"#d1e0b8"}},{id:"landuse-hospital",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landuse",filter:["==","class","hospital"],paint:{"fill-color":"#FFC0CB"}},{id:"landuse-school",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landuse",filter:["==","class","school"],paint:{"fill-color":"rgba(255,192,203,0.8)"}},{id:"landuse-railway",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landuse",filter:["==","class","railway"],paint:{"fill-color":"rgba(149,46,46,0.4)"}},{id:"landcover-wood",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landcover",filter:["==","class","wood"],paint:{"fill-color":"#228B22","fill-opacity":.1,"fill-outline-color":"hsla(0, 0%, 0%, 0.03)","fill-antialias":{base:1,stops:[[0,!1],[9,!0]]}}},{id:"landcover-grass",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landcover",filter:["==","class","grass"],paint:{"fill-color":"#556B2F","fill-opacity":1}},{id:"landcover-grass-park",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"park",filter:["==","class","public_park"],paint:{"fill-color":"#556B2F","fill-opacity":.8}},{id:"waterway-other",type:"line",metadata:{"mapbox:group":"1444849382550.77"},source:"openmaptiles","source-layer":"waterway",filter:["!in","class","canal","river","stream"],layout:{"line-cap":"round"},paint:{"line-color":"#1E90FF","line-width":{base:1.3,stops:[[13,.5],[20,2]]}}},{id:"waterway-stream-canal",type:"line",metadata:{"mapbox:group":"1444849382550.77"},source:"openmaptiles","source-layer":"waterway",filter:["in","class","canal","stream"],layout:{"line-cap":"round"},paint:{"line-color":"#1E90FF","line-width":{base:1.3,stops:[[13,.5],[20,6]]}}},{id:"waterway-river",type:"line",metadata:{"mapbox:group":"1444849382550.77"},source:"openmaptiles","source-layer":"waterway",filter:["==","class","river"],layout:{"line-cap":"round"},paint:{"line-color":"#1E90FF","line-width":{base:1.2,stops:[[10,.8],[20,6]]}}},{id:"water-offset",type:"fill",metadata:{"mapbox:group":"1444849382550.77"},source:"openmaptiles","source-layer":"water",maxzoom:8,filter:["==","$type","Polygon"],layout:{visibility:"visible"},paint:{"fill-opacity":1,"fill-color":"#1E90FF","fill-translate":{base:1,stops:[[6,[2,0]],[8,[0,0]]]}}},{id:"water",type:"fill",metadata:{"mapbox:group":"1444849382550.77"},source:"openmaptiles","source-layer":"water",layout:{visibility:"visible"},paint:{"fill-color":"#006ad1"}},{id:"water-pattern",type:"fill",metadata:{"mapbox:group":"1444849382550.77"},source:"openmaptiles","source-layer":"water",layout:{visibility:"visible"},paint:{"fill-translate":[0,2.5],"fill-pattern":"wave"}},{id:"landcover-ice-shelf",type:"fill",metadata:{"mapbox:group":"1444849382550.77"},source:"openmaptiles","source-layer":"landcover",filter:["==","subclass","ice_shelf"],layout:{visibility:"visible"},paint:{"fill-color":"#228B22","fill-opacity":{base:1,stops:[[0,.9],[10,.3]]}}},{id:"building",type:"fill",metadata:{"mapbox:group":"1444849364238.8171"},source:"openmaptiles","source-layer":"building",paint:{"fill-color":"#f9e9cb","fill-antialias":!0}},{id:"building-top",type:"fill",metadata:{"mapbox:group":"1444849364238.8171"},source:"openmaptiles","source-layer":"building",layout:{visibility:"visible"},paint:{"fill-translate":{base:1,stops:[[14,[0,0]],[16,[-2,-2]]]},"fill-outline-color":"#dfdbd7","fill-color":"#fefcf9","fill-opacity":{base:1,stops:[[13,0],[16,1]]}}},{id:"tunnel-service-track-casing",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["in","class","service","track"]],layout:{"line-join":"round"},paint:{"line-color":"#CD5C5C","line-dasharray":[.5,.25],"line-width":{base:1.2,stops:[[15,1],[16,4],[20,11]]}}},{id:"tunnel-minor-casing",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["==","class","minor"]],layout:{"line-join":"round"},paint:{"line-color":"#CD5C5C","line-opacity":{stops:[[12,0],[12.5,1]]},"line-width":{base:1.2,stops:[[12,.5],[13,1],[14,4],[20,15]]}}},{id:"tunnel-secondary-tertiary-casing",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["in","class","secondary","tertiary"]],layout:{"line-join":"round"},paint:{"line-color":"#CD5C5C","line-opacity":1,"line-width":{base:1.2,stops:[[8,1.5],[20,17]]}}},{id:"tunnel-trunk-primary-casing",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["in","class","primary","trunk"]],layout:{"line-join":"round"},paint:{"line-color":"#CD5C5C","line-width":{base:1.2,stops:[[5,.4],[6,.6],[7,1.5],[20,22]]}}},{id:"tunnel-motorway-casing",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["==","class","motorway"]],layout:{"line-join":"round",visibility:"visible"},paint:{"line-color":"#CD5C5C","line-dasharray":[.5,.25],"line-width":{base:1.2,stops:[[5,.4],[6,.6],[7,1.5],[20,22]]}}},{id:"tunnel-path",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["==","brunnel","tunnel"],["==","class","path"]]],paint:{"line-color":"#d98383","line-dasharray":[1.5,.75],"line-width":{base:1.2,stops:[[15,1.2],[20,4]]}}},{id:"tunnel-service-track",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["in","class","service","track"]],layout:{"line-join":"round"},paint:{"line-color":"#d98383","line-width":{base:1.2,stops:[[15.5,0],[16,2],[20,7.5]]}}},{id:"tunnel-minor",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["==","class","minor_road"]],layout:{"line-join":"round"},paint:{"line-color":"#d98383","line-opacity":1,"line-width":{base:1.2,stops:[[13.5,0],[14,2.5],[20,11.5]]}}},{id:"tunnel-secondary-tertiary",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["in","class","secondary","tertiary"]],layout:{"line-join":"round"},paint:{"line-color":"#df9797","line-width":{base:1.2,stops:[[6.5,0],[7,.5],[20,10]]}}},{id:"tunnel-trunk-primary",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["in","class","primary","trunk"]],layout:{"line-join":"round"},paint:{"line-color":"#CD5C5C","line-width":{base:1.2,stops:[[6.5,0],[7,.5],[20,18]]}}},{id:"tunnel-motorway",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["==","class","motorway"]],layout:{"line-join":"round",visibility:"visible"},paint:{"line-color":"rgba(139,94,6,0.8)","line-width":{base:1.2,stops:[[6.5,0],[7,.5],[20,18]]}}},{id:"tunnel-railway",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["==","class","rail"]],paint:{"line-color":"#952e2e","line-width":{base:1.4,stops:[[14,.4],[15,.75],[20,2]]},"line-dasharray":[2,2]}},{id:"aeroway-taxiway-casing",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"aeroway",minzoom:12,filter:["all",["in","class","taxiway"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#952e2e","line-width":{base:1.5,stops:[[11,2],[17,12]]},"line-opacity":1}},{id:"aeroway-runway-casing",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"aeroway",minzoom:12,filter:["all",["in","class","runway"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#952e2e","line-width":{base:1.5,stops:[[11,5],[17,55]]},"line-opacity":1}},{id:"aeroway-area",type:"fill",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"aeroway",minzoom:4,filter:["all",["==","$type","Polygon"],["in","class","runway","taxiway"]],layout:{visibility:"visible"},paint:{"fill-opacity":{base:1,stops:[[13,0],[14,1]]},"fill-color":"rgba(205,92,92,0.5)"}},{id:"aeroway-taxiway",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"aeroway",minzoom:4,filter:["all",["in","class","taxiway"],["==","$type","LineString"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#df9797","line-width":{base:1.5,stops:[[11,1],[17,10]]},"line-opacity":{base:1,stops:[[11,0],[12,1]]}}},{id:"aeroway-runway",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"aeroway",minzoom:4,filter:["all",["in","class","runway"],["==","$type","LineString"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#df9797","line-width":{base:1.5,stops:[[11,4],[17,50]]},"line-opacity":{base:1,stops:[[11,0],[12,1]]}}},{id:"highway-area",type:"fill",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["==","$type","Polygon"],layout:{visibility:"visible"},paint:{"fill-color":"#bc3a3a","fill-outline-color":"#cfcdca","fill-opacity":.9,"fill-antialias":!1}},{id:"highway-motorway-link-casing",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",minzoom:12,filter:["all",["!in","brunnel","bridge","tunnel"],["==","class","motorway_link"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#CD5C5C","line-opacity":1,"line-width":{base:1.2,stops:[[12,1],[13,3],[14,4],[20,15]]}}},{id:"highway-link-casing",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",minzoom:13,filter:["all",["!in","brunnel","bridge","tunnel"],["in","class","primary_link","secondary_link","tertiary_link","trunk_link"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#CD5C5C","line-opacity":1,"line-width":{base:1.2,stops:[[12,1],[13,3],[14,4],[20,15]]}}},{id:"highway-minor-casing",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["!=","brunnel","tunnel"],["in","class","minor","service","track"]]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"rgba(205,92,92,0.8)","line-opacity":{stops:[[12,0],[12.5,1]]},"line-width":{base:1.2,stops:[[12,.5],[13,1],[14,4],[20,15]]}}},{id:"highway-secondary-tertiary-casing",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["!in","brunnel","bridge","tunnel"],["in","class","secondary","tertiary"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#CD5C5C","line-opacity":1,"line-width":{base:1.2,stops:[[8,1.5],[20,17]]}}},{id:"highway-primary-casing",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",minzoom:5,filter:["all",["!in","brunnel","bridge","tunnel"],["in","class","primary"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#CD5C5C","line-opacity":{stops:[[7,0],[8,1]]},"line-width":{base:1.2,stops:[[7,0],[8,.6],[9,1.5],[20,22]]}}},{id:"highway-trunk-casing",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",minzoom:5,filter:["all",["!in","brunnel","bridge","tunnel"],["in","class","trunk"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#CD5C5C","line-opacity":{stops:[[5,0],[6,1]]},"line-width":{base:1.2,stops:[[5,0],[6,.6],[7,1.5],[20,22]]}}},{id:"highway-motorway-casing",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",minzoom:4,filter:["all",["!in","brunnel","bridge","tunnel"],["==","class","motorway"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#CD5C5C","line-width":{base:1.2,stops:[[4,0],[5,.4],[6,.6],[7,1.5],[20,22]]},"line-opacity":{stops:[[4,0],[5,1]]}}},{id:"highway-path",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["!in","brunnel","bridge","tunnel"],["==","class","path"]]],paint:{"line-color":"#FFC0CB","line-dasharray":[1.5,.75],"line-width":{base:1.2,stops:[[15,1.2],[20,4]]}}},{id:"highway-motorway-link",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",minzoom:12,filter:["all",["!in","brunnel","bridge","tunnel"],["==","class","motorway_link"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#8b5e3c","line-width":{base:1.2,stops:[[12.5,0],[13,1.5],[14,2.5],[20,11.5]]}}},{id:"highway-link",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",minzoom:13,filter:["all",["!in","brunnel","bridge","tunnel"],["in","class","primary_link","secondary_link","tertiary_link","trunk_link"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#8B5E3C","line-width":{base:1.2,stops:[[12.5,0],[13,1.5],[14,2.5],[20,11.5]]}}},{id:"highway-minor",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["!=","brunnel","tunnel"],["in","class","minor","service","track"]]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#e5aaaa","line-opacity":1,"line-width":{base:1.2,stops:[[13.5,0],[14,2.5],[20,11.5]]}}},{id:"highway-secondary-tertiary",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["!in","brunnel","bridge","tunnel"],["in","class","secondary","tertiary"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#8B5E3C","line-width":{base:1.2,stops:[[6.5,0],[8,.5],[20,13]]}}},{id:"highway-primary",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["!in","brunnel","bridge","tunnel"],["in","class","primary"]]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#8B5E3C","line-width":{base:1.2,stops:[[8.5,0],[9,.5],[20,18]]}}},{id:"highway-trunk",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["!in","brunnel","bridge","tunnel"],["in","class","trunk"]]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#8B5E3C","line-width":{base:1.2,stops:[[6.5,0],[7,.5],[20,18]]}}},{id:"highway-motorway",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",minzoom:5,filter:["all",["==","$type","LineString"],["all",["!in","brunnel","bridge","tunnel"],["==","class","motorway"]]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#8b5e3c","line-width":{base:1.2,stops:[[6.5,0],[7,.5],[20,18]]}}},{id:"railway-service",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["==","class","rail"],["has","service"]]],paint:{"line-color":"rgba(149,46,46,0.7)","line-width":{base:1.4,stops:[[14,.4],[20,1]]}}},{id:"railway-service-hatching",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["==","class","rail"],["has","service"]]],layout:{visibility:"visible"},paint:{"line-color":"rgba(149,46,46,0.7)","line-dasharray":[.2,8],"line-width":{base:1.4,stops:[[14.5,0],[15,2],[20,6]]}}},{id:"railway",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["!has","service"],["!in","brunnel","bridge","tunnel"],["==","class","rail"]]],paint:{"line-color":"#952e2e","line-width":{base:1.4,stops:[[14,.4],[15,.75],[20,2]]}}},{id:"railway-hatching",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["!has","service"],["!in","brunnel","bridge","tunnel"],["==","class","rail"]]],paint:{"line-color":"#952e2e","line-dasharray":[.2,8],"line-width":{base:1.4,stops:[[14.5,0],[15,3],[20,8]]}}},{id:"bridge-motorway-link-casing",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["==","class","motorway_link"]],layout:{"line-join":"round"},paint:{"line-color":"#CD5C5C","line-opacity":1,"line-width":{base:1.2,stops:[[12,1],[13,3],[14,4],[20,15]]}}},{id:"bridge-link-casing",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["in","class","primary_link","secondary_link","tertiary_link","trunk_link"]],layout:{"line-join":"round"},paint:{"line-color":"#CD5C5C","line-opacity":1,"line-width":{base:1.2,stops:[[12,1],[13,3],[14,4],[20,15]]}}},{id:"bridge-secondary-tertiary-casing",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["in","class","secondary","tertiary"]],layout:{"line-join":"round"},paint:{"line-color":"#CD5C5C","line-opacity":1,"line-width":{base:1.2,stops:[[8,1.5],[20,28]]}}},{id:"bridge-trunk-primary-casing",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["in","class","primary","trunk"]],layout:{"line-join":"round"},paint:{"line-color":"#CD5C5C","line-width":{base:1.2,stops:[[5,.4],[6,.6],[7,1.5],[20,26]]}}},{id:"bridge-motorway-casing",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["==","class","motorway"]],layout:{"line-join":"round"},paint:{"line-color":"#CD5C5C","line-width":{base:1.2,stops:[[5,.4],[6,.6],[7,1.5],[20,22]]}}},{id:"bridge-path-casing",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["==","brunnel","bridge"],["==","class","path"]]],paint:{"line-color":"#d98383","line-width":{base:1.2,stops:[[15,1.2],[20,18]]}}},{id:"bridge-path",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["==","brunnel","bridge"],["==","class","path"]]],paint:{"line-color":"#FFC0CB","line-width":{base:1.2,stops:[[15,1.2],[20,4]]},"line-dasharray":[1.5,.75]}},{id:"bridge-motorway-link",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["==","class","motorway_link"]],layout:{"line-join":"round"},paint:{"line-color":"#8b5e3c","line-width":{base:1.2,stops:[[12.5,0],[13,1.5],[14,2.5],[20,11.5]]}}},{id:"bridge-link",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["in","class","primary_link","secondary_link","tertiary_link","trunk_link"]],layout:{"line-join":"round"},paint:{"line-color":"#8B5E3C","line-width":{base:1.2,stops:[[12.5,0],[13,1.5],[14,2.5],[20,11.5]]}}},{id:"bridge-secondary-tertiary",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["in","class","secondary","tertiary"]],layout:{"line-join":"round"},paint:{"line-color":"#8B5E3C","line-width":{base:1.2,stops:[[6.5,0],[7,.5],[20,20]]}}},{id:"bridge-trunk-primary",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["in","class","primary","trunk"]],layout:{"line-join":"round"},paint:{"line-color":"#8B5E3C","line-width":{base:1.2,stops:[[6.5,0],[7,.5],[20,18]]}}},{id:"bridge-motorway",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["==","class","motorway"]],layout:{"line-join":"round"},paint:{"line-color":"#8b5e3c","line-width":{base:1.2,stops:[[6.5,0],[7,.5],[20,18]]}}},{id:"bridge-railway",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["==","class","rail"]],paint:{"line-color":"#952e2e","line-width":{base:1.4,stops:[[14,.4],[15,.75],[20,2]]}}},{id:"bridge-railway-hatching",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["==","class","rail"]],paint:{"line-color":"#952e2e","line-dasharray":[.2,8],"line-width":{base:1.4,stops:[[14.5,0],[15,3],[20,8]]}}},{id:"boundary-land-level-4",type:"line",source:"openmaptiles","source-layer":"boundary",filter:["all",["in","admin_level",4,6,8],["!=","maritime",1]],layout:{"line-join":"round"},paint:{"line-color":"#A0522D","line-dasharray":[3,1,1,1],"line-width":{base:1.4,stops:[[4,.4],[5,1],[12,3]]}}},{id:"boundary-land-level-2",type:"line",source:"openmaptiles","source-layer":"boundary",filter:["all",["==","admin_level",2],["!=","maritime",1]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#A0522D","line-width":{base:1,stops:[[0,.6],[4,1.4],[5,2],[12,8]]}}},{id:"boundary-water",type:"line",source:"openmaptiles","source-layer":"boundary",filter:["all",["in","admin_level",2,4],["==","maritime",1]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#1E90FF","line-width":{base:1,stops:[[0,.6],[4,1.4],[5,2],[12,8]]},"line-opacity":{stops:[[6,.6],[10,1]]}}},{id:"waterway-name",type:"symbol",source:"openmaptiles","source-layer":"waterway",minzoom:13,filter:["all",["==","$type","LineString"],["has","name"],["!has","name:de"]],layout:{"text-font":["Open Sans Italic"],"text-size":14,"text-field":"{name:latin} {name:nonlatin}","text-max-width":5,"text-rotation-alignment":"map","symbol-placement":"line","text-letter-spacing":.2,"symbol-spacing":350},paint:{"text-color":"#fefefe","text-halo-width":1.5,"text-halo-color":"#74aee9"}},{id:"waterway-name-en",type:"symbol",source:"openmaptiles","source-layer":"waterway",minzoom:13,filter:["all",["==","$type","LineString"],["has","name"],["has","name:de"]],layout:{"text-font":["Open Sans Italic"],"text-size":14,"text-field":"{name:de} {name:nonlatin}","text-max-width":5,"text-rotation-alignment":"map","symbol-placement":"line","text-letter-spacing":.2,"symbol-spacing":350},paint:{"text-color":"#fefefe","text-halo-width":1.5,"text-halo-color":"#74aee9"}},{id:"water-name-lakeline",type:"symbol",source:"openmaptiles","source-layer":"water_name",filter:["all",["==","$type","LineString"],["!has","name:de"]],layout:{"text-font":["Open Sans Italic"],"text-size":14,"text-field":"{name:latin} {name:nonlatin}","text-max-width":5,"text-rotation-alignment":"map","symbol-placement":"line","symbol-spacing":350,"text-letter-spacing":.2},paint:{"text-color":"#fefefe","text-halo-width":1.5,"text-halo-color":"#74aee9"}},{id:"water-name-lakeline-en",type:"symbol",source:"openmaptiles","source-layer":"water_name",filter:["all",["==","$type","LineString"],["has","name:de"]],layout:{"text-font":["Open Sans Italic"],"text-size":14,"text-field":"{name:de} {name:nonlatin}","text-max-width":5,"text-rotation-alignment":"map","symbol-placement":"line","symbol-spacing":350,"text-letter-spacing":.2},paint:{"text-color":"#fefefe","text-halo-width":1.5,"text-halo-color":"#74aee9"}},{id:"water-name-ocean",type:"symbol",source:"openmaptiles","source-layer":"water_name",filter:["all",["==","$type","Point"],["==","class","ocean"],["!has","name:de"]],layout:{"text-font":["Open Sans Italic"],"text-size":14,"text-field":`{name:latin}
{name:nonlatin}`,"text-max-width":5,"text-rotation-alignment":"map","symbol-placement":"point","symbol-spacing":350,"text-letter-spacing":.2},paint:{"text-color":"#fefefe","text-halo-width":1.5,"text-halo-color":"#74aee9"}},{id:"water-name-ocean-en",type:"symbol",source:"openmaptiles","source-layer":"water_name",filter:["all",["==","$type","Point"],["==","class","ocean"],["has","name:de"]],layout:{"text-font":["Open Sans Italic"],"text-size":14,"text-field":`{name:de}
{name:nonlatin}`,"text-max-width":5,"text-rotation-alignment":"map","symbol-placement":"point","symbol-spacing":350,"text-letter-spacing":.2},paint:{"text-color":"#fefefe","text-halo-width":1.5,"text-halo-color":"#74aee9"}},{id:"water-name-other",type:"symbol",source:"openmaptiles","source-layer":"water_name",filter:["all",["==","$type","Point"],["!in","class","ocean"],["!has","name:de"]],layout:{"text-font":["Open Sans Italic"],"text-size":{stops:[[0,10],[6,14]]},"text-field":`{name:latin}
{name:nonlatin}`,"text-max-width":5,"text-rotation-alignment":"map","symbol-placement":"point","symbol-spacing":350,"text-letter-spacing":.2,visibility:"visible"},paint:{"text-color":"#fefefe","text-halo-width":1.5,"text-halo-color":"#74aee9"}},{id:"water-name-other-en",type:"symbol",source:"openmaptiles","source-layer":"water_name",filter:["all",["==","$type","Point"],["!in","class","ocean"],["has","name:de"]],layout:{"text-font":["Open Sans Italic"],"text-size":{stops:[[0,10],[6,14]]},"text-field":`{name:de}
{name:nonlatin}`,"text-max-width":5,"text-rotation-alignment":"map","symbol-placement":"point","symbol-spacing":350,"text-letter-spacing":.2,visibility:"visible"},paint:{"text-color":"#fefefe","text-halo-width":1.5,"text-halo-color":"#74aee9"}},{id:"poi-level-3",type:"symbol",source:"openmaptiles","source-layer":"poi",minzoom:16,filter:["all",["==","$type","Point"],[">=","rank",25],["!has","name:de"]],layout:{"text-padding":2,"text-font":["Open Sans Semibold"],"text-anchor":"top","icon-image":"{class}_11","text-field":`{name:latin}
{name:nonlatin}`,"text-offset":[0,.6],"text-size":12,"text-max-width":9},paint:{"text-halo-blur":.5,"text-color":"#fdfdfd","text-halo-width":1,"text-halo-color":"#633"}},{id:"poi-level-3-en",type:"symbol",source:"openmaptiles","source-layer":"poi",minzoom:16,filter:["all",["==","$type","Point"],[">=","rank",25],["has","name:de"]],layout:{"text-padding":2,"text-font":["Open Sans Semibold"],"text-anchor":"top","icon-image":"{class}_11","text-field":`{name:de}
{name:nonlatin}`,"text-offset":[0,.6],"text-size":12,"text-max-width":9},paint:{"text-halo-blur":.5,"text-color":"#fdfdfd","text-halo-width":1,"text-halo-color":"#633"}},{id:"poi-level-2",type:"symbol",source:"openmaptiles","source-layer":"poi",minzoom:15,filter:["all",["==","$type","Point"],["all",["<=","rank",24],[">=","rank",15]],["!has","name:de"]],layout:{"text-padding":2,"text-font":["Open Sans Semibold"],"text-anchor":"top","icon-image":"{class}_11","text-field":`{name:latin}
{name:nonlatin}`,"text-offset":[0,.6],"text-size":12,"text-max-width":9},paint:{"text-halo-blur":.5,"text-color":"#fdfdfd","text-halo-width":1,"text-halo-color":"#633"}},{id:"poi-level-2-en",type:"symbol",source:"openmaptiles","source-layer":"poi",minzoom:15,filter:["all",["==","$type","Point"],["all",["<=","rank",24],[">=","rank",15]],["has","name:de"]],layout:{"text-padding":2,"text-font":["Open Sans Semibold"],"text-anchor":"top","icon-image":"{class}_11","text-field":`{name:de}
{name:nonlatin}`,"text-offset":[0,.6],"text-size":12,"text-max-width":9},paint:{"text-halo-blur":.5,"text-color":"#fdfdfd","text-halo-width":1,"text-halo-color":"#633"}},{id:"poi-level-1",type:"symbol",source:"openmaptiles","source-layer":"poi",minzoom:14,filter:["all",["==","$type","Point"],["all",["<=","rank",14],["has","name"]],["!has","name:de"]],layout:{"text-padding":2,"text-font":["Open Sans Semibold"],"text-anchor":"top","icon-image":"{class}_11","text-field":`{name:latin}
{name:nonlatin}`,"text-offset":[0,.6],"text-size":12,"text-max-width":9},paint:{"text-halo-blur":.5,"text-color":"#fdfdfd","text-halo-width":1,"text-halo-color":"#633"}},{id:"poi-level-1-en",type:"symbol",source:"openmaptiles","source-layer":"poi",minzoom:14,filter:["all",["==","$type","Point"],["all",["<=","rank",14],["has","name"]],["has","name:de"]],layout:{"text-padding":2,"text-font":["Open Sans Semibold"],"text-anchor":"top","icon-image":"{class}_11","text-field":`{name:de}
{name:nonlatin}`,"text-offset":[0,.6],"text-size":12,"text-max-width":9},paint:{"text-halo-blur":.5,"text-color":"#fdfdfd","text-halo-width":1,"text-halo-color":"#633"}},{id:"highway-name-path",type:"symbol",source:"openmaptiles","source-layer":"transportation_name",minzoom:15.5,filter:["all",["==","class","path"],["!has","name:de"]],layout:{"text-size":{base:1,stops:[[13,12],[14,13]]},"text-font":["Open Sans Regular"],"text-field":"{name:latin} {name:nonlatin}","symbol-placement":"line","text-rotation-alignment":"map"},paint:{"text-halo-color":"#f8f4f0","text-color":"hsl(30, 23%, 62%)","text-halo-width":.5}},{id:"highway-name-path-en",type:"symbol",source:"openmaptiles","source-layer":"transportation_name",minzoom:15.5,filter:["all",["==","class","path"],["has","name:de"]],layout:{"text-size":{base:1,stops:[[13,12],[14,13]]},"text-font":["Open Sans Regular"],"text-field":"{name:de} {name:nonlatin}","symbol-placement":"line","text-rotation-alignment":"map"},paint:{"text-halo-color":"#f8f4f0","text-color":"hsl(30, 23%, 62%)","text-halo-width":.5}},{id:"highway-name-minor",type:"symbol",source:"openmaptiles","source-layer":"transportation_name",minzoom:15,filter:["all",["==","$type","LineString"],["in","class","minor","service","track"],["!has","name:de"]],layout:{"text-size":{base:1,stops:[[13,12],[14,13]]},"text-font":["Open Sans Regular"],"text-field":"{name:latin} {name:nonlatin}","symbol-placement":"line","text-rotation-alignment":"map"},paint:{"text-halo-blur":.5,"text-color":"#765","text-halo-width":1}},{id:"highway-name-minor-en",type:"symbol",source:"openmaptiles","source-layer":"transportation_name",minzoom:15,filter:["all",["==","$type","LineString"],["in","class","minor","service","track"],["has","name:de"]],layout:{"text-size":{base:1,stops:[[13,12],[14,13]]},"text-font":["Open Sans Regular"],"text-field":"{name:de} {name:nonlatin}","symbol-placement":"line","text-rotation-alignment":"map"},paint:{"text-halo-blur":.5,"text-color":"#765","text-halo-width":1}},{id:"highway-name-major",type:"symbol",source:"openmaptiles","source-layer":"transportation_name",minzoom:12.2,filter:["all",["in","class","primary","secondary","tertiary","trunk"],["!has","name:de"]],layout:{"text-size":{base:1,stops:[[13,12],[14,13]]},"text-font":["Open Sans Regular"],"text-field":"{name:latin} {name:nonlatin}","symbol-placement":"line","text-rotation-alignment":"map"},paint:{"text-halo-blur":.5,"text-color":"#765","text-halo-width":1}},{id:"highway-name-major-en",type:"symbol",source:"openmaptiles","source-layer":"transportation_name",minzoom:12.2,filter:["all",["in","class","primary","secondary","tertiary","trunk"],["has","name:de"]],layout:{"text-size":{base:1,stops:[[13,12],[14,13]]},"text-font":["Open Sans Regular"],"text-field":"{name:de} {name:nonlatin}","symbol-placement":"line","text-rotation-alignment":"map"},paint:{"text-halo-blur":.5,"text-color":"#765","text-halo-width":1}},{id:"highway-shield",type:"symbol",source:"openmaptiles","source-layer":"transportation_name",minzoom:8,filter:["all",["<=","ref_length",6],["==","$type","LineString"],["!in","network","us-interstate","us-highway","us-state"]],layout:{"text-size":10,"icon-image":"road_{ref_length}","icon-rotation-alignment":"viewport","symbol-spacing":200,"text-font":["Open Sans Semibold"],"symbol-placement":{base:1,stops:[[10,"point"],[11,"line"]]},"text-rotation-alignment":"viewport","icon-size":1,"text-field":"{ref}"},paint:{}},{id:"highway-shield-us-interstate",type:"symbol",source:"openmaptiles","source-layer":"transportation_name",minzoom:7,filter:["all",["<=","ref_length",6],["==","$type","LineString"],["in","network","us-interstate"]],layout:{"text-size":10,"icon-image":"{network}_{ref_length}","icon-rotation-alignment":"viewport","symbol-spacing":200,"text-font":["Open Sans Semibold"],"symbol-placement":{base:1,stops:[[7,"point"],[7,"line"],[8,"line"]]},"text-rotation-alignment":"viewport","icon-size":1,"text-field":"{ref}"},paint:{"text-color":"rgba(0, 0, 0, 1)"}},{id:"highway-shield-us-other",type:"symbol",source:"openmaptiles","source-layer":"transportation_name",minzoom:9,filter:["all",["<=","ref_length",6],["==","$type","LineString"],["in","network","us-highway","us-state"]],layout:{"text-size":10,"icon-image":"{network}_{ref_length}","icon-rotation-alignment":"viewport","symbol-spacing":200,"text-font":["Open Sans Semibold"],"symbol-placement":{base:1,stops:[[10,"point"],[11,"line"]]},"text-rotation-alignment":"viewport","icon-size":1,"text-field":"{ref}"},paint:{"text-color":"rgba(0, 0, 0, 1)"}},{id:"place-other",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["!in","class","city","town","village"],["!has","name:de"]],layout:{"text-letter-spacing":.1,"text-size":{base:1.2,stops:[[12,10],[15,14]]},"text-font":["Open Sans Bold"],"text-field":`{name:latin}
{name:nonlatin}`,"text-transform":"uppercase","text-max-width":9},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-other-en",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["!in","class","city","town","village"],["has","name:de"]],layout:{"text-letter-spacing":.1,"text-size":{base:1.2,stops:[[12,10],[15,14]]},"text-font":["Open Sans Bold"],"text-field":`{name:de}
{name:nonlatin}`,"text-transform":"uppercase","text-max-width":9},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-village",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","village"],["!has","name:de"]],layout:{"text-font":["Open Sans Regular"],"text-size":{base:1.2,stops:[[10,12],[15,22]]},"text-field":`{name:latin}
{name:nonlatin}`,"text-max-width":8},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-village-en",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","village"],["has","name:de"]],layout:{"text-font":["Open Sans Regular"],"text-size":{base:1.2,stops:[[10,12],[15,22]]},"text-field":`{name:de}
{name:nonlatin}`,"text-max-width":8},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-town",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","town"],["!has","name:de"]],layout:{"text-font":["Open Sans Regular"],"text-size":{base:1.2,stops:[[10,14],[15,24]]},"text-field":`{name:latin}
{name:nonlatin}`,"text-max-width":8},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-town-en",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","town"],["has","name:de"]],layout:{"text-font":["Open Sans Regular"],"text-size":{base:1.2,stops:[[10,14],[15,24]]},"text-field":`{name:de}
{name:nonlatin}`,"text-max-width":8},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-city",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["!=","capital",2],["==","class","city"],["!has","name:de"]],layout:{"text-font":["Open Sans Semibold"],"text-size":{base:1.2,stops:[[7,14],[11,24]]},"text-field":`{name:latin}
{name:nonlatin}`,"text-max-width":8},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-city-en",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["!=","capital",2],["==","class","city"],["has","name:de"]],layout:{"text-font":["Open Sans Semibold"],"text-size":{base:1.2,stops:[[7,14],[11,24]]},"text-field":`{name:de}
{name:nonlatin}`,"text-max-width":8},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-city-capital",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","capital",2],["==","class","city"],["!has","name:de"]],layout:{"text-font":["Open Sans Semibold"],"text-size":{base:1.2,stops:[[7,14],[11,24]]},"text-field":`{name:latin}
{name:nonlatin}`,"text-max-width":8,"icon-image":"star_11","text-offset":[.4,0],"icon-size":.8,"text-anchor":"left"},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-city-capital-en",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","capital",2],["==","class","city"],["has","name:de"]],layout:{"text-font":["Open Sans Semibold"],"text-size":{base:1.2,stops:[[7,14],[11,24]]},"text-field":`{name:de}
{name:nonlatin}`,"text-max-width":8,"icon-image":"star_11","text-offset":[.4,0],"icon-size":.8,"text-anchor":"left"},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-country-3",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","country"],[">=","rank",3],["!has","name:de"]],layout:{"text-font":["Open Sans Bold"],"text-field":`{name:latin}
{name:nonlatin}`,"text-size":{stops:[[3,11],[7,17]]},"text-transform":"uppercase","text-max-width":6.25},paint:{"text-halo-blur":1,"text-color":"#fdfdfd","text-halo-width":2,"text-halo-color":"#433"}},{id:"place-country-3-en",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","country"],[">=","rank",3],["has","name:de"]],layout:{"text-font":["Open Sans Bold"],"text-field":`{name:de}
{name:nonlatin}`,"text-size":{stops:[[3,11],[7,17]]},"text-transform":"uppercase","text-max-width":6.25},paint:{"text-halo-blur":1,"text-color":"#fdfdfd","text-halo-width":2,"text-halo-color":"#433"}},{id:"place-country-2",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","country"],["==","rank",2],["!has","name:de"]],layout:{"text-font":["Open Sans Bold"],"text-field":`{name:latin}
{name:nonlatin}`,"text-size":{stops:[[2,11],[5,17]]},"text-transform":"uppercase","text-max-width":6.25},paint:{"text-halo-blur":1,"text-color":"#fdfdfd","text-halo-width":2,"text-halo-color":"#433"}},{id:"place-country-2-en",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","country"],["==","rank",2],["has","name:de"]],layout:{"text-font":["Open Sans Bold"],"text-field":`{name:de}
{name:nonlatin}`,"text-size":{stops:[[2,11],[5,17]]},"text-transform":"uppercase","text-max-width":6.25},paint:{"text-halo-blur":1,"text-color":"#fdfdfd","text-halo-width":2,"text-halo-color":"#433"}},{id:"place-country-1",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","country"],["==","rank",1],["!has","name:de"]],layout:{"text-font":["Open Sans Bold"],"text-field":`{name:latin}
{name:nonlatin}`,"text-size":{stops:[[1,11],[4,17]]},"text-transform":"uppercase","text-max-width":6.25},paint:{"text-halo-blur":1,"text-color":"#fdfdfd","text-halo-width":2,"text-halo-color":"#433"}},{id:"place-country-1-en",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","country"],["==","rank",1],["has","name:de"]],layout:{"text-font":["Open Sans Bold"],"text-field":`{name:de}
{name:nonlatin}`,"text-size":{stops:[[1,11],[4,17]]},"text-transform":"uppercase","text-max-width":6.25},paint:{"text-halo-blur":1,"text-color":"#fdfdfd","text-halo-width":2,"text-halo-color":"#433"}},{id:"place-continent",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",maxzoom:1,filter:["all",["==","class","continent"],["!has","name:de"]],layout:{"text-font":["Open Sans Bold"],"text-field":`{name:latin}
{name:nonlatin}`,"text-size":14,"text-max-width":6.25,"text-transform":"uppercase"},paint:{"text-halo-blur":1,"text-color":"#fdfdfd","text-halo-width":2,"text-halo-color":"#433"}},{id:"place-continent-en",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",maxzoom:1,filter:["all",["==","class","continent"],["has","name:de"]],layout:{"text-font":["Open Sans Bold"],"text-field":`{name:de}
{name:nonlatin}`,"text-size":14,"text-max-width":6.25,"text-transform":"uppercase"},paint:{"text-halo-blur":1,"text-color":"#fdfdfd","text-halo-width":2,"text-halo-color":"#433"}}]},U6e={version:8,name:"Gruvbox",center:[8.542,47.372],zoom:11.6,bearing:0,pitch:0,sources:{openmaptiles:{type:"vector",url:ec.source_openmaptiles_url}},sprite:ec.sprite,glyphs:ec.glyphs,layers:[{id:"background",type:"background",paint:{"background-color":"#282822"}},{id:"landcover-glacier",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landcover",filter:["==","subclass","glacier"],layout:{visibility:"visible"},paint:{"fill-color":"#83a598","fill-opacity":{base:1,stops:[[0,.9],[10,.3]]}}},{id:"landuse-residential",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landuse",filter:["==","class","residential"],paint:{"fill-color":"#b8bb26"}},{id:"landuse-commercial",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landuse",filter:["all",["==","$type","Polygon"],["==","class","commercial"]],paint:{"fill-color":"#bfc23c"}},{id:"landuse-industrial",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landuse",filter:["all",["==","$type","Polygon"],["==","class","industrial"]],paint:{"fill-color":"#c6c951"}},{id:"park",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"park",filter:["==","$type","Polygon"],paint:{"fill-color":"#b8bb26","fill-opacity":{base:1.8,stops:[[9,.5],[12,.2]]}}},{id:"park-outline",type:"line",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"park",filter:["==","$type","Polygon"],layout:{},paint:{"line-color":"rgba(184,187,38,0.6)","line-dasharray":[3,3]}},{id:"landuse-cemetery",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landuse",filter:["==","class","cemetery"],paint:{"fill-color":"#eceeaa"}},{id:"landuse-hospital",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landuse",filter:["==","class","hospital"],paint:{"fill-color":"#fe8019"}},{id:"landuse-school",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landuse",filter:["==","class","school"],paint:{"fill-color":"rgba(254,128,25,0.8)"}},{id:"landuse-railway",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landuse",filter:["==","class","railway"],paint:{"fill-color":"rgba(118,51,8,0.4)"}},{id:"landcover-wood",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landcover",filter:["==","class","wood"],paint:{"fill-color":"#83a598","fill-opacity":.1,"fill-outline-color":"hsla(0, 0%, 0%, 0.03)","fill-antialias":{base:1,stops:[[0,!1],[9,!0]]}}},{id:"landcover-grass",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landcover",filter:["==","class","grass"],paint:{"fill-color":"#b8bb26","fill-opacity":1}},{id:"landcover-grass-park",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"park",filter:["==","class","public_park"],paint:{"fill-color":"#b8bb26","fill-opacity":.8}},{id:"waterway-other",type:"line",metadata:{"mapbox:group":"1444849382550.77"},source:"openmaptiles","source-layer":"waterway",filter:["!in","class","canal","river","stream"],layout:{"line-cap":"round"},paint:{"line-color":"#83a598","line-width":{base:1.3,stops:[[13,.5],[20,2]]}}},{id:"waterway-stream-canal",type:"line",metadata:{"mapbox:group":"1444849382550.77"},source:"openmaptiles","source-layer":"waterway",filter:["in","class","canal","stream"],layout:{"line-cap":"round"},paint:{"line-color":"#83a598","line-width":{base:1.3,stops:[[13,.5],[20,6]]}}},{id:"waterway-river",type:"line",metadata:{"mapbox:group":"1444849382550.77"},source:"openmaptiles","source-layer":"waterway",filter:["==","class","river"],layout:{"line-cap":"round"},paint:{"line-color":"#83a598","line-width":{base:1.2,stops:[[10,.8],[20,6]]}}},{id:"water-offset",type:"fill",metadata:{"mapbox:group":"1444849382550.77"},source:"openmaptiles","source-layer":"water",maxzoom:8,filter:["==","$type","Polygon"],layout:{visibility:"visible"},paint:{"fill-opacity":1,"fill-color":"#83a598","fill-translate":{base:1,stops:[[6,[2,0]],[8,[0,0]]]}}},{id:"water",type:"fill",metadata:{"mapbox:group":"1444849382550.77"},source:"openmaptiles","source-layer":"water",layout:{visibility:"visible"},paint:{"fill-color":"#5c7f72"}},{id:"water-pattern",type:"fill",metadata:{"mapbox:group":"1444849382550.77"},source:"openmaptiles","source-layer":"water",layout:{visibility:"visible"},paint:{"fill-translate":[0,2.5],"fill-pattern":"wave"}},{id:"landcover-ice-shelf",type:"fill",metadata:{"mapbox:group":"1444849382550.77"},source:"openmaptiles","source-layer":"landcover",filter:["==","subclass","ice_shelf"],layout:{visibility:"visible"},paint:{"fill-color":"#83a598","fill-opacity":{base:1,stops:[[0,.9],[10,.3]]}}},{id:"building",type:"fill",metadata:{"mapbox:group":"1444849364238.8171"},source:"openmaptiles","source-layer":"building",paint:{"fill-color":"#928374","fill-antialias":!0}},{id:"building-top",type:"fill",metadata:{"mapbox:group":"1444849364238.8171"},source:"openmaptiles","source-layer":"building",layout:{visibility:"visible"},paint:{"fill-translate":{base:1,stops:[[14,[0,0]],[16,[-2,-2]]]},"fill-outline-color":"#dfdbd7","fill-color":"#a89c91","fill-opacity":{base:1,stops:[[13,0],[16,1]]}}},{id:"tunnel-service-track-casing",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["in","class","service","track"]],layout:{"line-join":"round"},paint:{"line-color":"#d65d0e","line-dasharray":[.5,.25],"line-width":{base:1.2,stops:[[15,1],[16,4],[20,11]]}}},{id:"tunnel-minor-casing",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["==","class","minor"]],layout:{"line-join":"round"},paint:{"line-color":"#d65d0e","line-opacity":{stops:[[12,0],[12.5,1]]},"line-width":{base:1.2,stops:[[12,.5],[13,1],[14,4],[20,15]]}}},{id:"tunnel-secondary-tertiary-casing",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["in","class","secondary","tertiary"]],layout:{"line-join":"round"},paint:{"line-color":"#d65d0e","line-opacity":1,"line-width":{base:1.2,stops:[[8,1.5],[20,17]]}}},{id:"tunnel-trunk-primary-casing",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["in","class","primary","trunk"]],layout:{"line-join":"round"},paint:{"line-color":"#d65d0e","line-width":{base:1.2,stops:[[5,.4],[6,.6],[7,1.5],[20,22]]}}},{id:"tunnel-motorway-casing",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["==","class","motorway"]],layout:{"line-join":"round",visibility:"visible"},paint:{"line-color":"#d65d0e","line-dasharray":[.5,.25],"line-width":{base:1.2,stops:[[5,.4],[6,.6],[7,1.5],[20,22]]}}},{id:"tunnel-path",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["==","brunnel","tunnel"],["==","class","path"]]],paint:{"line-color":"#f17626","line-dasharray":[1.5,.75],"line-width":{base:1.2,stops:[[15,1.2],[20,4]]}}},{id:"tunnel-service-track",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["in","class","service","track"]],layout:{"line-join":"round"},paint:{"line-color":"#f17626","line-width":{base:1.2,stops:[[15.5,0],[16,2],[20,7.5]]}}},{id:"tunnel-minor",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["==","class","minor_road"]],layout:{"line-join":"round"},paint:{"line-color":"#f17626","line-opacity":1,"line-width":{base:1.2,stops:[[13.5,0],[14,2.5],[20,11.5]]}}},{id:"tunnel-secondary-tertiary",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["in","class","secondary","tertiary"]],layout:{"line-join":"round"},paint:{"line-color":"#f2853e","line-width":{base:1.2,stops:[[6.5,0],[7,.5],[20,10]]}}},{id:"tunnel-trunk-primary",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["in","class","primary","trunk"]],layout:{"line-join":"round"},paint:{"line-color":"#d65d0e","line-width":{base:1.2,stops:[[6.5,0],[7,.5],[20,18]]}}},{id:"tunnel-motorway",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["==","class","motorway"]],layout:{"line-join":"round",visibility:"visible"},paint:{"line-color":"rgba(235,219,178,0.8)","line-width":{base:1.2,stops:[[6.5,0],[7,.5],[20,18]]}}},{id:"tunnel-railway",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["==","class","rail"]],paint:{"line-color":"#763308","line-width":{base:1.4,stops:[[14,.4],[15,.75],[20,2]]},"line-dasharray":[2,2]}},{id:"aeroway-taxiway-casing",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"aeroway",minzoom:12,filter:["all",["in","class","taxiway"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#763308","line-width":{base:1.5,stops:[[11,2],[17,12]]},"line-opacity":1}},{id:"aeroway-runway-casing",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"aeroway",minzoom:12,filter:["all",["in","class","runway"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#763308","line-width":{base:1.5,stops:[[11,5],[17,55]]},"line-opacity":1}},{id:"aeroway-area",type:"fill",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"aeroway",minzoom:4,filter:["all",["==","$type","Polygon"],["in","class","runway","taxiway"]],layout:{visibility:"visible"},paint:{"fill-opacity":{base:1,stops:[[13,0],[14,1]]},"fill-color":"rgba(214,93,14,0.5)"}},{id:"aeroway-taxiway",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"aeroway",minzoom:4,filter:["all",["in","class","taxiway"],["==","$type","LineString"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#f2853e","line-width":{base:1.5,stops:[[11,1],[17,10]]},"line-opacity":{base:1,stops:[[11,0],[12,1]]}}},{id:"aeroway-runway",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"aeroway",minzoom:4,filter:["all",["in","class","runway"],["==","$type","LineString"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#f2853e","line-width":{base:1.5,stops:[[11,4],[17,50]]},"line-opacity":{base:1,stops:[[11,0],[12,1]]}}},{id:"highway-area",type:"fill",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["==","$type","Polygon"],layout:{visibility:"visible"},paint:{"fill-color":"#a6480b","fill-outline-color":"#cfcdca","fill-opacity":.9,"fill-antialias":!1}},{id:"highway-motorway-link-casing",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",minzoom:12,filter:["all",["!in","brunnel","bridge","tunnel"],["==","class","motorway_link"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#d65d0e","line-opacity":1,"line-width":{base:1.2,stops:[[12,1],[13,3],[14,4],[20,15]]}}},{id:"highway-link-casing",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",minzoom:13,filter:["all",["!in","brunnel","bridge","tunnel"],["in","class","primary_link","secondary_link","tertiary_link","trunk_link"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#d65d0e","line-opacity":1,"line-width":{base:1.2,stops:[[12,1],[13,3],[14,4],[20,15]]}}},{id:"highway-minor-casing",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["!=","brunnel","tunnel"],["in","class","minor","service","track"]]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"rgba(214,93,14,0.8)","line-opacity":{stops:[[12,0],[12.5,1]]},"line-width":{base:1.2,stops:[[12,.5],[13,1],[14,4],[20,15]]}}},{id:"highway-secondary-tertiary-casing",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["!in","brunnel","bridge","tunnel"],["in","class","secondary","tertiary"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#d65d0e","line-opacity":1,"line-width":{base:1.2,stops:[[8,1.5],[20,17]]}}},{id:"highway-primary-casing",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",minzoom:5,filter:["all",["!in","brunnel","bridge","tunnel"],["in","class","primary"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#d65d0e","line-opacity":{stops:[[7,0],[8,1]]},"line-width":{base:1.2,stops:[[7,0],[8,.6],[9,1.5],[20,22]]}}},{id:"highway-trunk-casing",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",minzoom:5,filter:["all",["!in","brunnel","bridge","tunnel"],["in","class","trunk"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#d65d0e","line-opacity":{stops:[[5,0],[6,1]]},"line-width":{base:1.2,stops:[[5,0],[6,.6],[7,1.5],[20,22]]}}},{id:"highway-motorway-casing",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",minzoom:4,filter:["all",["!in","brunnel","bridge","tunnel"],["==","class","motorway"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#d65d0e","line-width":{base:1.2,stops:[[4,0],[5,.4],[6,.6],[7,1.5],[20,22]]},"line-opacity":{stops:[[4,0],[5,1]]}}},{id:"highway-path",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["!in","brunnel","bridge","tunnel"],["==","class","path"]]],paint:{"line-color":"#fe8019","line-dasharray":[1.5,.75],"line-width":{base:1.2,stops:[[15,1.2],[20,4]]}}},{id:"highway-motorway-link",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",minzoom:12,filter:["all",["!in","brunnel","bridge","tunnel"],["==","class","motorway_link"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#ebdbb2","line-width":{base:1.2,stops:[[12.5,0],[13,1.5],[14,2.5],[20,11.5]]}}},{id:"highway-link",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",minzoom:13,filter:["all",["!in","brunnel","bridge","tunnel"],["in","class","primary_link","secondary_link","tertiary_link","trunk_link"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#ebdbb2","line-width":{base:1.2,stops:[[12.5,0],[13,1.5],[14,2.5],[20,11.5]]}}},{id:"highway-minor",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["!=","brunnel","tunnel"],["in","class","minor","service","track"]]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#f49456","line-opacity":1,"line-width":{base:1.2,stops:[[13.5,0],[14,2.5],[20,11.5]]}}},{id:"highway-secondary-tertiary",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["!in","brunnel","bridge","tunnel"],["in","class","secondary","tertiary"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#ebdbb2","line-width":{base:1.2,stops:[[6.5,0],[8,.5],[20,13]]}}},{id:"highway-primary",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["!in","brunnel","bridge","tunnel"],["in","class","primary"]]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#ebdbb2","line-width":{base:1.2,stops:[[8.5,0],[9,.5],[20,18]]}}},{id:"highway-trunk",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["!in","brunnel","bridge","tunnel"],["in","class","trunk"]]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#ebdbb2","line-width":{base:1.2,stops:[[6.5,0],[7,.5],[20,18]]}}},{id:"highway-motorway",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",minzoom:5,filter:["all",["==","$type","LineString"],["all",["!in","brunnel","bridge","tunnel"],["==","class","motorway"]]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#ebdbb2","line-width":{base:1.2,stops:[[6.5,0],[7,.5],[20,18]]}}},{id:"railway-service",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["==","class","rail"],["has","service"]]],paint:{"line-color":"rgba(118,51,8,0.7)","line-width":{base:1.4,stops:[[14,.4],[20,1]]}}},{id:"railway-service-hatching",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["==","class","rail"],["has","service"]]],layout:{visibility:"visible"},paint:{"line-color":"rgba(118,51,8,0.7)","line-dasharray":[.2,8],"line-width":{base:1.4,stops:[[14.5,0],[15,2],[20,6]]}}},{id:"railway",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["!has","service"],["!in","brunnel","bridge","tunnel"],["==","class","rail"]]],paint:{"line-color":"#763308","line-width":{base:1.4,stops:[[14,.4],[15,.75],[20,2]]}}},{id:"railway-hatching",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["!has","service"],["!in","brunnel","bridge","tunnel"],["==","class","rail"]]],paint:{"line-color":"#763308","line-dasharray":[.2,8],"line-width":{base:1.4,stops:[[14.5,0],[15,3],[20,8]]}}},{id:"bridge-motorway-link-casing",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["==","class","motorway_link"]],layout:{"line-join":"round"},paint:{"line-color":"#d65d0e","line-opacity":1,"line-width":{base:1.2,stops:[[12,1],[13,3],[14,4],[20,15]]}}},{id:"bridge-link-casing",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["in","class","primary_link","secondary_link","tertiary_link","trunk_link"]],layout:{"line-join":"round"},paint:{"line-color":"#d65d0e","line-opacity":1,"line-width":{base:1.2,stops:[[12,1],[13,3],[14,4],[20,15]]}}},{id:"bridge-secondary-tertiary-casing",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["in","class","secondary","tertiary"]],layout:{"line-join":"round"},paint:{"line-color":"#d65d0e","line-opacity":1,"line-width":{base:1.2,stops:[[8,1.5],[20,28]]}}},{id:"bridge-trunk-primary-casing",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["in","class","primary","trunk"]],layout:{"line-join":"round"},paint:{"line-color":"#d65d0e","line-width":{base:1.2,stops:[[5,.4],[6,.6],[7,1.5],[20,26]]}}},{id:"bridge-motorway-casing",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["==","class","motorway"]],layout:{"line-join":"round"},paint:{"line-color":"#d65d0e","line-width":{base:1.2,stops:[[5,.4],[6,.6],[7,1.5],[20,22]]}}},{id:"bridge-path-casing",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["==","brunnel","bridge"],["==","class","path"]]],paint:{"line-color":"#f17626","line-width":{base:1.2,stops:[[15,1.2],[20,18]]}}},{id:"bridge-path",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["==","brunnel","bridge"],["==","class","path"]]],paint:{"line-color":"#fe8019","line-width":{base:1.2,stops:[[15,1.2],[20,4]]},"line-dasharray":[1.5,.75]}},{id:"bridge-motorway-link",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["==","class","motorway_link"]],layout:{"line-join":"round"},paint:{"line-color":"#ebdbb2","line-width":{base:1.2,stops:[[12.5,0],[13,1.5],[14,2.5],[20,11.5]]}}},{id:"bridge-link",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["in","class","primary_link","secondary_link","tertiary_link","trunk_link"]],layout:{"line-join":"round"},paint:{"line-color":"#ebdbb2","line-width":{base:1.2,stops:[[12.5,0],[13,1.5],[14,2.5],[20,11.5]]}}},{id:"bridge-secondary-tertiary",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["in","class","secondary","tertiary"]],layout:{"line-join":"round"},paint:{"line-color":"#ebdbb2","line-width":{base:1.2,stops:[[6.5,0],[7,.5],[20,20]]}}},{id:"bridge-trunk-primary",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["in","class","primary","trunk"]],layout:{"line-join":"round"},paint:{"line-color":"#ebdbb2","line-width":{base:1.2,stops:[[6.5,0],[7,.5],[20,18]]}}},{id:"bridge-motorway",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["==","class","motorway"]],layout:{"line-join":"round"},paint:{"line-color":"#ebdbb2","line-width":{base:1.2,stops:[[6.5,0],[7,.5],[20,18]]}}},{id:"bridge-railway",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["==","class","rail"]],paint:{"line-color":"#763308","line-width":{base:1.4,stops:[[14,.4],[15,.75],[20,2]]}}},{id:"bridge-railway-hatching",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["==","class","rail"]],paint:{"line-color":"#763308","line-dasharray":[.2,8],"line-width":{base:1.4,stops:[[14.5,0],[15,3],[20,8]]}}},{id:"boundary-land-level-4",type:"line",source:"openmaptiles","source-layer":"boundary",filter:["all",["in","admin_level",4,6,8],["!=","maritime",1]],layout:{"line-join":"round"},paint:{"line-color":"#fb4934","line-dasharray":[3,1,1,1],"line-width":{base:1.4,stops:[[4,.4],[5,1],[12,3]]}}},{id:"boundary-land-level-2",type:"line",source:"openmaptiles","source-layer":"boundary",filter:["all",["==","admin_level",2],["!=","maritime",1]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#fb4934","line-width":{base:1,stops:[[0,.6],[4,1.4],[5,2],[12,8]]}}},{id:"boundary-water",type:"line",source:"openmaptiles","source-layer":"boundary",filter:["all",["in","admin_level",2,4],["==","maritime",1]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#83a598","line-width":{base:1,stops:[[0,.6],[4,1.4],[5,2],[12,8]]},"line-opacity":{stops:[[6,.6],[10,1]]}}},{id:"waterway-name",type:"symbol",source:"openmaptiles","source-layer":"waterway",minzoom:13,filter:["all",["==","$type","LineString"],["has","name"],["!has","name:de"]],layout:{"text-font":["Open Sans Italic"],"text-size":14,"text-field":"{name:latin} {name:nonlatin}","text-max-width":5,"text-rotation-alignment":"map","symbol-placement":"line","text-letter-spacing":.2,"symbol-spacing":350},paint:{"text-color":"#fefefe","text-halo-width":1.5,"text-halo-color":"#74aee9"}},{id:"waterway-name-en",type:"symbol",source:"openmaptiles","source-layer":"waterway",minzoom:13,filter:["all",["==","$type","LineString"],["has","name"],["has","name:de"]],layout:{"text-font":["Open Sans Italic"],"text-size":14,"text-field":"{name:de} {name:nonlatin}","text-max-width":5,"text-rotation-alignment":"map","symbol-placement":"line","text-letter-spacing":.2,"symbol-spacing":350},paint:{"text-color":"#fefefe","text-halo-width":1.5,"text-halo-color":"#74aee9"}},{id:"water-name-lakeline",type:"symbol",source:"openmaptiles","source-layer":"water_name",filter:["all",["==","$type","LineString"],["!has","name:de"]],layout:{"text-font":["Open Sans Italic"],"text-size":14,"text-field":"{name:latin} {name:nonlatin}","text-max-width":5,"text-rotation-alignment":"map","symbol-placement":"line","symbol-spacing":350,"text-letter-spacing":.2},paint:{"text-color":"#fefefe","text-halo-width":1.5,"text-halo-color":"#74aee9"}},{id:"water-name-lakeline-en",type:"symbol",source:"openmaptiles","source-layer":"water_name",filter:["all",["==","$type","LineString"],["has","name:de"]],layout:{"text-font":["Open Sans Italic"],"text-size":14,"text-field":"{name:de} {name:nonlatin}","text-max-width":5,"text-rotation-alignment":"map","symbol-placement":"line","symbol-spacing":350,"text-letter-spacing":.2},paint:{"text-color":"#fefefe","text-halo-width":1.5,"text-halo-color":"#74aee9"}},{id:"water-name-ocean",type:"symbol",source:"openmaptiles","source-layer":"water_name",filter:["all",["==","$type","Point"],["==","class","ocean"],["!has","name:de"]],layout:{"text-font":["Open Sans Italic"],"text-size":14,"text-field":`{name:latin}
{name:nonlatin}`,"text-max-width":5,"text-rotation-alignment":"map","symbol-placement":"point","symbol-spacing":350,"text-letter-spacing":.2},paint:{"text-color":"#fefefe","text-halo-width":1.5,"text-halo-color":"#74aee9"}},{id:"water-name-ocean-en",type:"symbol",source:"openmaptiles","source-layer":"water_name",filter:["all",["==","$type","Point"],["==","class","ocean"],["has","name:de"]],layout:{"text-font":["Open Sans Italic"],"text-size":14,"text-field":`{name:de}
{name:nonlatin}`,"text-max-width":5,"text-rotation-alignment":"map","symbol-placement":"point","symbol-spacing":350,"text-letter-spacing":.2},paint:{"text-color":"#fefefe","text-halo-width":1.5,"text-halo-color":"#74aee9"}},{id:"water-name-other",type:"symbol",source:"openmaptiles","source-layer":"water_name",filter:["all",["==","$type","Point"],["!in","class","ocean"],["!has","name:de"]],layout:{"text-font":["Open Sans Italic"],"text-size":{stops:[[0,10],[6,14]]},"text-field":`{name:latin}
{name:nonlatin}`,"text-max-width":5,"text-rotation-alignment":"map","symbol-placement":"point","symbol-spacing":350,"text-letter-spacing":.2,visibility:"visible"},paint:{"text-color":"#fefefe","text-halo-width":1.5,"text-halo-color":"#74aee9"}},{id:"water-name-other-en",type:"symbol",source:"openmaptiles","source-layer":"water_name",filter:["all",["==","$type","Point"],["!in","class","ocean"],["has","name:de"]],layout:{"text-font":["Open Sans Italic"],"text-size":{stops:[[0,10],[6,14]]},"text-field":`{name:de}
{name:nonlatin}`,"text-max-width":5,"text-rotation-alignment":"map","symbol-placement":"point","symbol-spacing":350,"text-letter-spacing":.2,visibility:"visible"},paint:{"text-color":"#fefefe","text-halo-width":1.5,"text-halo-color":"#74aee9"}},{id:"poi-level-3",type:"symbol",source:"openmaptiles","source-layer":"poi",minzoom:16,filter:["all",["==","$type","Point"],[">=","rank",25],["!has","name:de"]],layout:{"text-padding":2,"text-font":["Open Sans Semibold"],"text-anchor":"top","icon-image":"{class}_11","text-field":`{name:latin}
{name:nonlatin}`,"text-offset":[0,.6],"text-size":12,"text-max-width":9},paint:{"text-halo-blur":.5,"text-color":"#fdfdfd","text-halo-width":1,"text-halo-color":"#633"}},{id:"poi-level-3-en",type:"symbol",source:"openmaptiles","source-layer":"poi",minzoom:16,filter:["all",["==","$type","Point"],[">=","rank",25],["has","name:de"]],layout:{"text-padding":2,"text-font":["Open Sans Semibold"],"text-anchor":"top","icon-image":"{class}_11","text-field":`{name:de}
{name:nonlatin}`,"text-offset":[0,.6],"text-size":12,"text-max-width":9},paint:{"text-halo-blur":.5,"text-color":"#fdfdfd","text-halo-width":1,"text-halo-color":"#633"}},{id:"poi-level-2",type:"symbol",source:"openmaptiles","source-layer":"poi",minzoom:15,filter:["all",["==","$type","Point"],["all",["<=","rank",24],[">=","rank",15]],["!has","name:de"]],layout:{"text-padding":2,"text-font":["Open Sans Semibold"],"text-anchor":"top","icon-image":"{class}_11","text-field":`{name:latin}
{name:nonlatin}`,"text-offset":[0,.6],"text-size":12,"text-max-width":9},paint:{"text-halo-blur":.5,"text-color":"#fdfdfd","text-halo-width":1,"text-halo-color":"#633"}},{id:"poi-level-2-en",type:"symbol",source:"openmaptiles","source-layer":"poi",minzoom:15,filter:["all",["==","$type","Point"],["all",["<=","rank",24],[">=","rank",15]],["has","name:de"]],layout:{"text-padding":2,"text-font":["Open Sans Semibold"],"text-anchor":"top","icon-image":"{class}_11","text-field":`{name:de}
{name:nonlatin}`,"text-offset":[0,.6],"text-size":12,"text-max-width":9},paint:{"text-halo-blur":.5,"text-color":"#fdfdfd","text-halo-width":1,"text-halo-color":"#633"}},{id:"poi-level-1",type:"symbol",source:"openmaptiles","source-layer":"poi",minzoom:14,filter:["all",["==","$type","Point"],["all",["<=","rank",14],["has","name"]],["!has","name:de"]],layout:{"text-padding":2,"text-font":["Open Sans Semibold"],"text-anchor":"top","icon-image":"{class}_11","text-field":`{name:latin}
{name:nonlatin}`,"text-offset":[0,.6],"text-size":12,"text-max-width":9},paint:{"text-halo-blur":.5,"text-color":"#fdfdfd","text-halo-width":1,"text-halo-color":"#633"}},{id:"poi-level-1-en",type:"symbol",source:"openmaptiles","source-layer":"poi",minzoom:14,filter:["all",["==","$type","Point"],["all",["<=","rank",14],["has","name"]],["has","name:de"]],layout:{"text-padding":2,"text-font":["Open Sans Semibold"],"text-anchor":"top","icon-image":"{class}_11","text-field":`{name:de}
{name:nonlatin}`,"text-offset":[0,.6],"text-size":12,"text-max-width":9},paint:{"text-halo-blur":.5,"text-color":"#fdfdfd","text-halo-width":1,"text-halo-color":"#633"}},{id:"highway-name-path",type:"symbol",source:"openmaptiles","source-layer":"transportation_name",minzoom:15.5,filter:["all",["==","class","path"],["!has","name:de"]],layout:{"text-size":{base:1,stops:[[13,12],[14,13]]},"text-font":["Open Sans Regular"],"text-field":"{name:latin} {name:nonlatin}","symbol-placement":"line","text-rotation-alignment":"map"},paint:{"text-halo-color":"#f8f4f0","text-color":"hsl(30, 23%, 62%)","text-halo-width":.5}},{id:"highway-name-path-en",type:"symbol",source:"openmaptiles","source-layer":"transportation_name",minzoom:15.5,filter:["all",["==","class","path"],["has","name:de"]],layout:{"text-size":{base:1,stops:[[13,12],[14,13]]},"text-font":["Open Sans Regular"],"text-field":"{name:de} {name:nonlatin}","symbol-placement":"line","text-rotation-alignment":"map"},paint:{"text-halo-color":"#f8f4f0","text-color":"hsl(30, 23%, 62%)","text-halo-width":.5}},{id:"highway-name-minor",type:"symbol",source:"openmaptiles","source-layer":"transportation_name",minzoom:15,filter:["all",["==","$type","LineString"],["in","class","minor","service","track"],["!has","name:de"]],layout:{"text-size":{base:1,stops:[[13,12],[14,13]]},"text-font":["Open Sans Regular"],"text-field":"{name:latin} {name:nonlatin}","symbol-placement":"line","text-rotation-alignment":"map"},paint:{"text-halo-blur":.5,"text-color":"#765","text-halo-width":1}},{id:"highway-name-minor-en",type:"symbol",source:"openmaptiles","source-layer":"transportation_name",minzoom:15,filter:["all",["==","$type","LineString"],["in","class","minor","service","track"],["has","name:de"]],layout:{"text-size":{base:1,stops:[[13,12],[14,13]]},"text-font":["Open Sans Regular"],"text-field":"{name:de} {name:nonlatin}","symbol-placement":"line","text-rotation-alignment":"map"},paint:{"text-halo-blur":.5,"text-color":"#765","text-halo-width":1}},{id:"highway-name-major",type:"symbol",source:"openmaptiles","source-layer":"transportation_name",minzoom:12.2,filter:["all",["in","class","primary","secondary","tertiary","trunk"],["!has","name:de"]],layout:{"text-size":{base:1,stops:[[13,12],[14,13]]},"text-font":["Open Sans Regular"],"text-field":"{name:latin} {name:nonlatin}","symbol-placement":"line","text-rotation-alignment":"map"},paint:{"text-halo-blur":.5,"text-color":"#765","text-halo-width":1}},{id:"highway-name-major-en",type:"symbol",source:"openmaptiles","source-layer":"transportation_name",minzoom:12.2,filter:["all",["in","class","primary","secondary","tertiary","trunk"],["has","name:de"]],layout:{"text-size":{base:1,stops:[[13,12],[14,13]]},"text-font":["Open Sans Regular"],"text-field":"{name:de} {name:nonlatin}","symbol-placement":"line","text-rotation-alignment":"map"},paint:{"text-halo-blur":.5,"text-color":"#765","text-halo-width":1}},{id:"highway-shield",type:"symbol",source:"openmaptiles","source-layer":"transportation_name",minzoom:8,filter:["all",["<=","ref_length",6],["==","$type","LineString"],["!in","network","us-interstate","us-highway","us-state"]],layout:{"text-size":10,"icon-image":"road_{ref_length}","icon-rotation-alignment":"viewport","symbol-spacing":200,"text-font":["Open Sans Semibold"],"symbol-placement":{base:1,stops:[[10,"point"],[11,"line"]]},"text-rotation-alignment":"viewport","icon-size":1,"text-field":"{ref}"},paint:{}},{id:"highway-shield-us-interstate",type:"symbol",source:"openmaptiles","source-layer":"transportation_name",minzoom:7,filter:["all",["<=","ref_length",6],["==","$type","LineString"],["in","network","us-interstate"]],layout:{"text-size":10,"icon-image":"{network}_{ref_length}","icon-rotation-alignment":"viewport","symbol-spacing":200,"text-font":["Open Sans Semibold"],"symbol-placement":{base:1,stops:[[7,"point"],[7,"line"],[8,"line"]]},"text-rotation-alignment":"viewport","icon-size":1,"text-field":"{ref}"},paint:{"text-color":"rgba(0, 0, 0, 1)"}},{id:"highway-shield-us-other",type:"symbol",source:"openmaptiles","source-layer":"transportation_name",minzoom:9,filter:["all",["<=","ref_length",6],["==","$type","LineString"],["in","network","us-highway","us-state"]],layout:{"text-size":10,"icon-image":"{network}_{ref_length}","icon-rotation-alignment":"viewport","symbol-spacing":200,"text-font":["Open Sans Semibold"],"symbol-placement":{base:1,stops:[[10,"point"],[11,"line"]]},"text-rotation-alignment":"viewport","icon-size":1,"text-field":"{ref}"},paint:{"text-color":"rgba(0, 0, 0, 1)"}},{id:"place-other",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["!in","class","city","town","village"],["!has","name:de"]],layout:{"text-letter-spacing":.1,"text-size":{base:1.2,stops:[[12,10],[15,14]]},"text-font":["Open Sans Bold"],"text-field":`{name:latin}
{name:nonlatin}`,"text-transform":"uppercase","text-max-width":9},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-other-en",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["!in","class","city","town","village"],["has","name:de"]],layout:{"text-letter-spacing":.1,"text-size":{base:1.2,stops:[[12,10],[15,14]]},"text-font":["Open Sans Bold"],"text-field":`{name:de}
{name:nonlatin}`,"text-transform":"uppercase","text-max-width":9},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-village",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","village"],["!has","name:de"]],layout:{"text-font":["Open Sans Regular"],"text-size":{base:1.2,stops:[[10,12],[15,22]]},"text-field":`{name:latin}
{name:nonlatin}`,"text-max-width":8},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-village-en",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","village"],["has","name:de"]],layout:{"text-font":["Open Sans Regular"],"text-size":{base:1.2,stops:[[10,12],[15,22]]},"text-field":`{name:de}
{name:nonlatin}`,"text-max-width":8},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-town",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","town"],["!has","name:de"]],layout:{"text-font":["Open Sans Regular"],"text-size":{base:1.2,stops:[[10,14],[15,24]]},"text-field":`{name:latin}
{name:nonlatin}`,"text-max-width":8},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-town-en",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","town"],["has","name:de"]],layout:{"text-font":["Open Sans Regular"],"text-size":{base:1.2,stops:[[10,14],[15,24]]},"text-field":`{name:de}
{name:nonlatin}`,"text-max-width":8},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-city",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["!=","capital",2],["==","class","city"],["!has","name:de"]],layout:{"text-font":["Open Sans Semibold"],"text-size":{base:1.2,stops:[[7,14],[11,24]]},"text-field":`{name:latin}
{name:nonlatin}`,"text-max-width":8},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-city-en",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["!=","capital",2],["==","class","city"],["has","name:de"]],layout:{"text-font":["Open Sans Semibold"],"text-size":{base:1.2,stops:[[7,14],[11,24]]},"text-field":`{name:de}
{name:nonlatin}`,"text-max-width":8},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-city-capital",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","capital",2],["==","class","city"],["!has","name:de"]],layout:{"text-font":["Open Sans Semibold"],"text-size":{base:1.2,stops:[[7,14],[11,24]]},"text-field":`{name:latin}
{name:nonlatin}`,"text-max-width":8,"icon-image":"star_11","text-offset":[.4,0],"icon-size":.8,"text-anchor":"left"},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-city-capital-en",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","capital",2],["==","class","city"],["has","name:de"]],layout:{"text-font":["Open Sans Semibold"],"text-size":{base:1.2,stops:[[7,14],[11,24]]},"text-field":`{name:de}
{name:nonlatin}`,"text-max-width":8,"icon-image":"star_11","text-offset":[.4,0],"icon-size":.8,"text-anchor":"left"},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-country-3",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","country"],[">=","rank",3],["!has","name:de"]],layout:{"text-font":["Open Sans Bold"],"text-field":`{name:latin}
{name:nonlatin}`,"text-size":{stops:[[3,11],[7,17]]},"text-transform":"uppercase","text-max-width":6.25},paint:{"text-halo-blur":1,"text-color":"#fdfdfd","text-halo-width":2,"text-halo-color":"#433"}},{id:"place-country-3-en",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","country"],[">=","rank",3],["has","name:de"]],layout:{"text-font":["Open Sans Bold"],"text-field":`{name:de}
{name:nonlatin}`,"text-size":{stops:[[3,11],[7,17]]},"text-transform":"uppercase","text-max-width":6.25},paint:{"text-halo-blur":1,"text-color":"#fdfdfd","text-halo-width":2,"text-halo-color":"#433"}},{id:"place-country-2",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","country"],["==","rank",2],["!has","name:de"]],layout:{"text-font":["Open Sans Bold"],"text-field":`{name:latin}
{name:nonlatin}`,"text-size":{stops:[[2,11],[5,17]]},"text-transform":"uppercase","text-max-width":6.25},paint:{"text-halo-blur":1,"text-color":"#fdfdfd","text-halo-width":2,"text-halo-color":"#433"}},{id:"place-country-2-en",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","country"],["==","rank",2],["has","name:de"]],layout:{"text-font":["Open Sans Bold"],"text-field":`{name:de}
{name:nonlatin}`,"text-size":{stops:[[2,11],[5,17]]},"text-transform":"uppercase","text-max-width":6.25},paint:{"text-halo-blur":1,"text-color":"#fdfdfd","text-halo-width":2,"text-halo-color":"#433"}},{id:"place-country-1",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","country"],["==","rank",1],["!has","name:de"]],layout:{"text-font":["Open Sans Bold"],"text-field":`{name:latin}
{name:nonlatin}`,"text-size":{stops:[[1,11],[4,17]]},"text-transform":"uppercase","text-max-width":6.25},paint:{"text-halo-blur":1,"text-color":"#fdfdfd","text-halo-width":2,"text-halo-color":"#433"}},{id:"place-country-1-en",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","country"],["==","rank",1],["has","name:de"]],layout:{"text-font":["Open Sans Bold"],"text-field":`{name:de}
{name:nonlatin}`,"text-size":{stops:[[1,11],[4,17]]},"text-transform":"uppercase","text-max-width":6.25},paint:{"text-halo-blur":1,"text-color":"#fdfdfd","text-halo-width":2,"text-halo-color":"#433"}},{id:"place-continent",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",maxzoom:1,filter:["all",["==","class","continent"],["!has","name:de"]],layout:{"text-font":["Open Sans Bold"],"text-field":`{name:latin}
{name:nonlatin}`,"text-size":14,"text-max-width":6.25,"text-transform":"uppercase"},paint:{"text-halo-blur":1,"text-color":"#fdfdfd","text-halo-width":2,"text-halo-color":"#433"}},{id:"place-continent-en",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",maxzoom:1,filter:["all",["==","class","continent"],["has","name:de"]],layout:{"text-font":["Open Sans Bold"],"text-field":`{name:de}
{name:nonlatin}`,"text-size":14,"text-max-width":6.25,"text-transform":"uppercase"},paint:{"text-halo-blur":1,"text-color":"#fdfdfd","text-halo-width":2,"text-halo-color":"#433"}}]},S1="https://mapcomponents.github.io/react-map-components-maplibre/assets/style_thumbnails/",EH=({sx:t,styles:e=[],defaultStyles:r=!0,styleThumbnailPaths:n})=>{const i=gt.useContext(XD),[a,s]=gt.useState(!1);return J.jsxs(J.Fragment,{children:[J.jsx(ta,{variant:"contained",sx:{marginTop:"10px",...t},onClick:()=>s(!0),children:J.jsx(L6e,{})}),J.jsx(QE,{styles:[...r?[F6e,B6e,z6e,j6e,U6e]:[],...e||[]],styleThumbnailPaths:{...n,...r?{Monokai:S1+"monokai.png",Gruvbox:S1+"gruvbox.png","Oceanic Next":S1+"oceanic_next.png",Solarized:S1+"solarized.png","Medieval Kingdom":S1+"medieval_kingdom.png"}:{}},open:a,setOpen:s,onSelect:o=>{i.setBackgroundLayers([]),setTimeout(()=>{i.updateStyle(o)},100),s(!1)}})]})};try{EH.displayName="SelectStyleButton",EH.__docgenInfo={description:"",displayName:"SelectStyleButton",props:{sx:{defaultValue:null,description:"",name:"sx",required:!1,type:{name:"SxProps | undefined"}},onComplete:{defaultValue:null,description:"",name:"onComplete",required:!1,type:{name:"((config: StyleSpecification[]) => void) | undefined"}},styles:{defaultValue:{value:"[]"},description:"",name:"styles",required:!1,type:{name:"StyleSpecification[] | undefined"}},defaultStyles:{defaultValue:{value:"true"},description:"",name:"defaultStyles",required:!1,type:{name:"boolean | undefined"}},styleThumbnailPaths:{defaultValue:null,description:"",name:"styleThumbnailPaths",required:!1,type:{name:"{ [key: string]: string; } | undefined"}}}}}catch{}var CP={exports:{}},AP={};/**
 * @license React
 * use-sync-external-store-with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var TH;function V6e(){if(TH)return AP;TH=1;var t=wx();function e(c,f){return c===f&&(c!==0||1/c===1/f)||c!==c&&f!==f}var r=typeof Object.is=="function"?Object.is:e,n=t.useSyncExternalStore,i=t.useRef,a=t.useEffect,s=t.useMemo,o=t.useDebugValue;return AP.useSyncExternalStoreWithSelector=function(c,f,d,m,b){var x=i(null);if(x.current===null){var E={hasValue:!1,value:null};x.current=E}else E=x.current;x=s(function(){function A(U){if(!M){if(M=!0,F=U,U=m(U),b!==void 0&&E.hasValue){var j=E.value;if(b(j,U))return N=j}return N=U}if(j=N,r(F,U))return j;var H=m(U);return b!==void 0&&b(j,H)?(F=U,j):(F=U,N=H)}var M=!1,F,N,O=d===void 0?null:d;return[function(){return A(f())},O===null?void 0:function(){return A(O())}]},[f,d,m,b]);var T=n(c,x[0],x[1]);return a(function(){E.hasValue=!0,E.value=T},[T]),o(T),T},AP}var CH;function $6e(){return CH||(CH=1,CP.exports=V6e()),CP.exports}var q6e=$6e(),H6e=Symbol.for("react-redux-context"),G6e=typeof globalThis<"u"?globalThis:{};function W6e(){if(!te.createContext)return{};const t=G6e[H6e]??=new Map;let e=t.get(te.createContext);return e||(e=te.createContext(null),t.set(te.createContext,e)),e}var uy=W6e();function PL(t=uy){return function(){return te.useContext(t)}}var pte=PL();function gte(t=uy){const e=t===uy?pte:PL(t),r=()=>{const{store:n}=e();return n};return Object.assign(r,{withTypes:()=>r}),r}var X6e=gte();function Y6e(t=uy){const e=t===uy?X6e:gte(t),r=()=>e().dispatch;return Object.assign(r,{withTypes:()=>r}),r}var mte=Y6e(),Z6e=(t,e)=>t===e;function K6e(t=uy){const e=t===uy?pte:PL(t),r=(n,i={})=>{const{equalityFn:a=Z6e}=typeof i=="function"?{equalityFn:i}:i,s=e(),{store:o,subscription:c,getServerState:f}=s;te.useRef(!0);const d=te.useCallback({[n.name](b){return n(b)}}[n.name],[n]),m=q6e.useSyncExternalStoreWithSelector(c.addNestedSub,o.getState,f||o.getState,d,a);return te.useDebugValue(m),m};return Object.assign(r,{withTypes:()=>r}),r}var Vm=K6e();function xu(t){return`Minified Redux error #${t}; visit https://redux.js.org/Errors?code=${t} for the full message or use the non-minified dev environment for full errors. `}var J6e=typeof Symbol=="function"&&Symbol.observable||"@@observable",AH=J6e,IP=()=>Math.random().toString(36).substring(7).split("").join("."),Q6e={INIT:`@@redux/INIT${IP()}`,REPLACE:`@@redux/REPLACE${IP()}`,PROBE_UNKNOWN_ACTION:()=>`@@redux/PROBE_UNKNOWN_ACTION${IP()}`},eT=Q6e;function kL(t){if(typeof t!="object"||t===null)return!1;let e=t;for(;Object.getPrototypeOf(e)!==null;)e=Object.getPrototypeOf(e);return Object.getPrototypeOf(t)===e||Object.getPrototypeOf(t)===null}function yte(t,e,r){if(typeof t!="function")throw new Error(xu(2));if(typeof e=="function"&&typeof r=="function"||typeof r=="function"&&typeof arguments[3]=="function")throw new Error(xu(0));if(typeof e=="function"&&typeof r>"u"&&(r=e,e=void 0),typeof r<"u"){if(typeof r!="function")throw new Error(xu(1));return r(yte)(t,e)}let n=t,i=e,a=new Map,s=a,o=0,c=!1;function f(){s===a&&(s=new Map,a.forEach((A,M)=>{s.set(M,A)}))}function d(){if(c)throw new Error(xu(3));return i}function m(A){if(typeof A!="function")throw new Error(xu(4));if(c)throw new Error(xu(5));let M=!0;f();const F=o++;return s.set(F,A),function(){if(M){if(c)throw new Error(xu(6));M=!1,f(),s.delete(F),a=null}}}function b(A){if(!kL(A))throw new Error(xu(7));if(typeof A.type>"u")throw new Error(xu(8));if(typeof A.type!="string")throw new Error(xu(17));if(c)throw new Error(xu(9));try{c=!0,i=n(i,A)}finally{c=!1}return(a=s).forEach(F=>{F()}),A}function x(A){if(typeof A!="function")throw new Error(xu(10));n=A,b({type:eT.REPLACE})}function E(){const A=m;return{subscribe(M){if(typeof M!="object"||M===null)throw new Error(xu(11));function F(){const O=M;O.next&&O.next(d())}return F(),{unsubscribe:A(F)}},[AH](){return this}}}return b({type:eT.INIT}),{dispatch:b,subscribe:m,getState:d,replaceReducer:x,[AH]:E}}function eFe(t){Object.keys(t).forEach(e=>{const r=t[e];if(typeof r(void 0,{type:eT.INIT})>"u")throw new Error(xu(12));if(typeof r(void 0,{type:eT.PROBE_UNKNOWN_ACTION()})>"u")throw new Error(xu(13))})}function tFe(t){const e=Object.keys(t),r={};for(let a=0;a<e.length;a++){const s=e[a];typeof t[s]=="function"&&(r[s]=t[s])}const n=Object.keys(r);let i;try{eFe(r)}catch(a){i=a}return function(s={},o){if(i)throw i;let c=!1;const f={};for(let d=0;d<n.length;d++){const m=n[d],b=r[m],x=s[m],E=b(x,o);if(typeof E>"u")throw o&&o.type,new Error(xu(14));f[m]=E,c=c||E!==x}return c=c||n.length!==Object.keys(s).length,c?f:s}}function tT(...t){return t.length===0?e=>e:t.length===1?t[0]:t.reduce((e,r)=>(...n)=>e(r(...n)))}function rFe(...t){return e=>(r,n)=>{const i=e(r,n);let a=()=>{throw new Error(xu(15))};const s={getState:i.getState,dispatch:(c,...f)=>a(c,...f)},o=t.map(c=>c(s));return a=tT(...o)(i.dispatch),{...i,dispatch:a}}}function nFe(t){return kL(t)&&"type"in t&&typeof t.type=="string"}var vte=Symbol.for("immer-nothing"),IH=Symbol.for("immer-draftable"),_f=Symbol.for("immer-state");function bh(t,...e){throw new Error(`[Immer] minified error nr: ${t}. Full error at: https://bit.ly/3cXEKWf`)}var n_=Object.getPrototypeOf;function cy(t){return!!t&&!!t[_f]}function Ip(t){return t?_te(t)||Array.isArray(t)||!!t[IH]||!!t.constructor?.[IH]||n2(t)||H3(t):!1}var iFe=Object.prototype.constructor.toString();function _te(t){if(!t||typeof t!="object")return!1;const e=n_(t);if(e===null)return!0;const r=Object.hasOwnProperty.call(e,"constructor")&&e.constructor;return r===Object?!0:typeof r=="function"&&Function.toString.call(r)===iFe}function rT(t,e){q3(t)===0?Reflect.ownKeys(t).forEach(r=>{e(r,t[r],t)}):t.forEach((r,n)=>e(n,r,t))}function q3(t){const e=t[_f];return e?e.type_:Array.isArray(t)?1:n2(t)?2:H3(t)?3:0}function zM(t,e){return q3(t)===2?t.has(e):Object.prototype.hasOwnProperty.call(t,e)}function bte(t,e,r){const n=q3(t);n===2?t.set(e,r):n===3?t.add(r):t[e]=r}function aFe(t,e){return t===e?t!==0||1/t===1/e:t!==t&&e!==e}function n2(t){return t instanceof Map}function H3(t){return t instanceof Set}function bm(t){return t.copy_||t.base_}function jM(t,e){if(n2(t))return new Map(t);if(H3(t))return new Set(t);if(Array.isArray(t))return Array.prototype.slice.call(t);const r=_te(t);if(e===!0||e==="class_only"&&!r){const n=Object.getOwnPropertyDescriptors(t);delete n[_f];let i=Reflect.ownKeys(n);for(let a=0;a<i.length;a++){const s=i[a],o=n[s];o.writable===!1&&(o.writable=!0,o.configurable=!0),(o.get||o.set)&&(n[s]={configurable:!0,writable:!0,enumerable:o.enumerable,value:t[s]})}return Object.create(n_(t),n)}else{const n=n_(t);if(n!==null&&r)return{...t};const i=Object.create(n);return Object.assign(i,t)}}function RL(t,e=!1){return G3(t)||cy(t)||!Ip(t)||(q3(t)>1&&Object.defineProperties(t,{set:{value:jw},add:{value:jw},clear:{value:jw},delete:{value:jw}}),Object.freeze(t),e&&Object.values(t).forEach(r=>RL(r,!0))),t}function jw(){bh(2)}function G3(t){return Object.isFrozen(t)}var oFe={};function fy(t){const e=oFe[t];return e||bh(0,t),e}var fx;function xte(){return fx}function sFe(t,e){return{drafts_:[],parent_:t,immer_:e,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function PH(t,e){e&&(fy("Patches"),t.patches_=[],t.inversePatches_=[],t.patchListener_=e)}function UM(t){VM(t),t.drafts_.forEach(lFe),t.drafts_=null}function VM(t){t===fx&&(fx=t.parent_)}function kH(t){return fx=sFe(fx,t)}function lFe(t){const e=t[_f];e.type_===0||e.type_===1?e.revoke_():e.revoked_=!0}function RH(t,e){e.unfinalizedDrafts_=e.drafts_.length;const r=e.drafts_[0];return t!==void 0&&t!==r?(r[_f].modified_&&(UM(e),bh(4)),Ip(t)&&(t=nT(e,t),e.parent_||iT(e,t)),e.patches_&&fy("Patches").generateReplacementPatches_(r[_f].base_,t,e.patches_,e.inversePatches_)):t=nT(e,r,[]),UM(e),e.patches_&&e.patchListener_(e.patches_,e.inversePatches_),t!==vte?t:void 0}function nT(t,e,r){if(G3(e))return e;const n=e[_f];if(!n)return rT(e,(i,a)=>MH(t,n,e,i,a,r)),e;if(n.scope_!==t)return e;if(!n.modified_)return iT(t,n.base_,!0),n.base_;if(!n.finalized_){n.finalized_=!0,n.scope_.unfinalizedDrafts_--;const i=n.copy_;let a=i,s=!1;n.type_===3&&(a=new Set(i),i.clear(),s=!0),rT(a,(o,c)=>MH(t,n,i,o,c,r,s)),iT(t,i,!1),r&&t.patches_&&fy("Patches").generatePatches_(n,r,t.patches_,t.inversePatches_)}return n.copy_}function MH(t,e,r,n,i,a,s){if(cy(i)){const o=a&&e&&e.type_!==3&&!zM(e.assigned_,n)?a.concat(n):void 0,c=nT(t,i,o);if(bte(r,n,c),cy(c))t.canAutoFreeze_=!1;else return}else s&&r.add(i);if(Ip(i)&&!G3(i)){if(!t.immer_.autoFreeze_&&t.unfinalizedDrafts_<1)return;nT(t,i),(!e||!e.scope_.parent_)&&typeof n!="symbol"&&(n2(r)?r.has(n):Object.prototype.propertyIsEnumerable.call(r,n))&&iT(t,i)}}function iT(t,e,r=!1){!t.parent_&&t.immer_.autoFreeze_&&t.canAutoFreeze_&&RL(e,r)}function uFe(t,e){const r=Array.isArray(t),n={type_:r?1:0,scope_:e?e.scope_:xte(),modified_:!1,finalized_:!1,assigned_:{},parent_:e,base_:t,draft_:null,copy_:null,revoke_:null,isManual_:!1};let i=n,a=ML;r&&(i=[n],a=hx);const{revoke:s,proxy:o}=Proxy.revocable(i,a);return n.draft_=o,n.revoke_=s,o}var ML={get(t,e){if(e===_f)return t;const r=bm(t);if(!zM(r,e))return cFe(t,r,e);const n=r[e];return t.finalized_||!Ip(n)?n:n===PP(t.base_,e)?(kP(t),t.copy_[e]=qM(n,t)):n},has(t,e){return e in bm(t)},ownKeys(t){return Reflect.ownKeys(bm(t))},set(t,e,r){const n=wte(bm(t),e);if(n?.set)return n.set.call(t.draft_,r),!0;if(!t.modified_){const i=PP(bm(t),e),a=i?.[_f];if(a&&a.base_===r)return t.copy_[e]=r,t.assigned_[e]=!1,!0;if(aFe(r,i)&&(r!==void 0||zM(t.base_,e)))return!0;kP(t),$M(t)}return t.copy_[e]===r&&(r!==void 0||e in t.copy_)||Number.isNaN(r)&&Number.isNaN(t.copy_[e])||(t.copy_[e]=r,t.assigned_[e]=!0),!0},deleteProperty(t,e){return PP(t.base_,e)!==void 0||e in t.base_?(t.assigned_[e]=!1,kP(t),$M(t)):delete t.assigned_[e],t.copy_&&delete t.copy_[e],!0},getOwnPropertyDescriptor(t,e){const r=bm(t),n=Reflect.getOwnPropertyDescriptor(r,e);return n&&{writable:!0,configurable:t.type_!==1||e!=="length",enumerable:n.enumerable,value:r[e]}},defineProperty(){bh(11)},getPrototypeOf(t){return n_(t.base_)},setPrototypeOf(){bh(12)}},hx={};rT(ML,(t,e)=>{hx[t]=function(){return arguments[0]=arguments[0][0],e.apply(this,arguments)}});hx.deleteProperty=function(t,e){return hx.set.call(this,t,e,void 0)};hx.set=function(t,e,r){return ML.set.call(this,t[0],e,r,t[0])};function PP(t,e){const r=t[_f];return(r?bm(r):t)[e]}function cFe(t,e,r){const n=wte(e,r);return n?"value"in n?n.value:n.get?.call(t.draft_):void 0}function wte(t,e){if(!(e in t))return;let r=n_(t);for(;r;){const n=Object.getOwnPropertyDescriptor(r,e);if(n)return n;r=n_(r)}}function $M(t){t.modified_||(t.modified_=!0,t.parent_&&$M(t.parent_))}function kP(t){t.copy_||(t.copy_=jM(t.base_,t.scope_.immer_.useStrictShallowCopy_))}var fFe=class{constructor(t){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.produce=(e,r,n)=>{if(typeof e=="function"&&typeof r!="function"){const a=r;r=e;const s=this;return function(c=a,...f){return s.produce(c,d=>r.call(this,d,...f))}}typeof r!="function"&&bh(6),n!==void 0&&typeof n!="function"&&bh(7);let i;if(Ip(e)){const a=kH(this),s=qM(e,void 0);let o=!0;try{i=r(s),o=!1}finally{o?UM(a):VM(a)}return PH(a,n),RH(i,a)}else if(!e||typeof e!="object"){if(i=r(e),i===void 0&&(i=e),i===vte&&(i=void 0),this.autoFreeze_&&RL(i,!0),n){const a=[],s=[];fy("Patches").generateReplacementPatches_(e,i,a,s),n(a,s)}return i}else bh(1,e)},this.produceWithPatches=(e,r)=>{if(typeof e=="function")return(s,...o)=>this.produceWithPatches(s,c=>e(c,...o));let n,i;return[this.produce(e,r,(s,o)=>{n=s,i=o}),n,i]},typeof t?.autoFreeze=="boolean"&&this.setAutoFreeze(t.autoFreeze),typeof t?.useStrictShallowCopy=="boolean"&&this.setUseStrictShallowCopy(t.useStrictShallowCopy)}createDraft(t){Ip(t)||bh(8),cy(t)&&(t=hFe(t));const e=kH(this),r=qM(t,void 0);return r[_f].isManual_=!0,VM(e),r}finishDraft(t,e){const r=t&&t[_f];(!r||!r.isManual_)&&bh(9);const{scope_:n}=r;return PH(n,e),RH(void 0,n)}setAutoFreeze(t){this.autoFreeze_=t}setUseStrictShallowCopy(t){this.useStrictShallowCopy_=t}applyPatches(t,e){let r;for(r=e.length-1;r>=0;r--){const i=e[r];if(i.path.length===0&&i.op==="replace"){t=i.value;break}}r>-1&&(e=e.slice(r+1));const n=fy("Patches").applyPatches_;return cy(t)?n(t,e):this.produce(t,i=>n(i,e))}};function qM(t,e){const r=n2(t)?fy("MapSet").proxyMap_(t,e):H3(t)?fy("MapSet").proxySet_(t,e):uFe(t,e);return(e?e.scope_:xte()).drafts_.push(r),r}function hFe(t){return cy(t)||bh(10,t),Ste(t)}function Ste(t){if(!Ip(t)||G3(t))return t;const e=t[_f];let r;if(e){if(!e.modified_)return e.base_;e.finalized_=!0,r=jM(t,e.scope_.immer_.useStrictShallowCopy_)}else r=jM(t,!0);return rT(r,(n,i)=>{bte(r,n,Ste(i))}),e&&(e.finalized_=!1),r}var dFe=new fFe,Ete=dFe.produce;function Tte(t){return({dispatch:r,getState:n})=>i=>a=>typeof a=="function"?a(r,n,t):i(a)}var pFe=Tte(),gFe=Tte,mFe=typeof window<"u"&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__:function(){if(arguments.length!==0)return typeof arguments[0]=="object"?tT:tT.apply(null,arguments)};function DH(t,e){function r(...n){if(e){let i=e(...n);if(!i)throw new Error(vp(0));return{type:t,payload:i.payload,..."meta"in i&&{meta:i.meta},..."error"in i&&{error:i.error}}}return{type:t,payload:n[0]}}return r.toString=()=>`${t}`,r.type=t,r.match=n=>nFe(n)&&n.type===t,r}var Cte=class K1 extends Array{constructor(...e){super(...e),Object.setPrototypeOf(this,K1.prototype)}static get[Symbol.species](){return K1}concat(...e){return super.concat.apply(this,e)}prepend(...e){return e.length===1&&Array.isArray(e[0])?new K1(...e[0].concat(this)):new K1(...e.concat(this))}};function OH(t){return Ip(t)?Ete(t,()=>{}):t}function Uw(t,e,r){return t.has(e)?t.get(e):t.set(e,r(e)).get(e)}function yFe(t){return typeof t=="boolean"}var vFe=()=>function(e){const{thunk:r=!0,immutableCheck:n=!0,serializableCheck:i=!0,actionCreatorCheck:a=!0}=e??{};let s=new Cte;return r&&(yFe(r)?s.push(pFe):s.push(gFe(r.extraArgument))),s},_Fe="RTK_autoBatch",NH=t=>e=>{setTimeout(e,t)},bFe=(t={type:"raf"})=>e=>(...r)=>{const n=e(...r);let i=!0,a=!1,s=!1;const o=new Set,c=t.type==="tick"?queueMicrotask:t.type==="raf"?typeof window<"u"&&window.requestAnimationFrame?window.requestAnimationFrame:NH(10):t.type==="callback"?t.queueNotification:NH(t.timeout),f=()=>{s=!1,a&&(a=!1,o.forEach(d=>d()))};return Object.assign({},n,{subscribe(d){const m=()=>i&&d(),b=n.subscribe(m);return o.add(d),()=>{b(),o.delete(d)}},dispatch(d){try{return i=!d?.meta?.[_Fe],a=!i,a&&(s||(s=!0,c(f))),n.dispatch(d)}finally{i=!0}}})},xFe=t=>function(r){const{autoBatch:n=!0}=r??{};let i=new Cte(t);return n&&i.push(bFe(typeof n=="object"?n:void 0)),i};function wFe(t){const e=vFe(),{reducer:r=void 0,middleware:n,devTools:i=!0,preloadedState:a=void 0,enhancers:s=void 0}=t||{};let o;if(typeof r=="function")o=r;else if(kL(r))o=tFe(r);else throw new Error(vp(1));let c;typeof n=="function"?c=n(e):c=e();let f=tT;i&&(f=mFe({trace:!1,...typeof i=="object"&&i}));const d=rFe(...c),m=xFe(d);let b=typeof s=="function"?s(m):m();const x=f(...b);return yte(o,a,x)}function Ate(t){const e={},r=[];let n;const i={addCase(a,s){const o=typeof a=="string"?a:a.type;if(!o)throw new Error(vp(28));if(o in e)throw new Error(vp(29));return e[o]=s,i},addAsyncThunk(a,s){return s.pending&&(e[a.pending.type]=s.pending),s.rejected&&(e[a.rejected.type]=s.rejected),s.fulfilled&&(e[a.fulfilled.type]=s.fulfilled),s.settled&&r.push({matcher:a.settled,reducer:s.settled}),i},addMatcher(a,s){return r.push({matcher:a,reducer:s}),i},addDefaultCase(a){return n=a,i}};return t(i),[e,r,n]}function SFe(t){return typeof t=="function"}function EFe(t,e){let[r,n,i]=Ate(e),a;if(SFe(t))a=()=>OH(t());else{const o=OH(t);a=()=>o}function s(o=a(),c){let f=[r[c.type],...n.filter(({matcher:d})=>d(c)).map(({reducer:d})=>d)];return f.filter(d=>!!d).length===0&&(f=[i]),f.reduce((d,m)=>{if(m)if(cy(d)){const x=m(d,c);return x===void 0?d:x}else{if(Ip(d))return Ete(d,b=>m(b,c));{const b=m(d,c);if(b===void 0){if(d===null)return d;throw Error("A case reducer on a non-draftable value must not return undefined")}return b}}return d},o)}return s.getInitialState=a,s}var TFe=Symbol.for("rtk-slice-createasyncthunk");function CFe(t,e){return`${t}/${e}`}function AFe({creators:t}={}){const e=t?.asyncThunk?.[TFe];return function(n){const{name:i,reducerPath:a=i}=n;if(!i)throw new Error(vp(11));const s=(typeof n.reducers=="function"?n.reducers(kFe()):n.reducers)||{},o=Object.keys(s),c={sliceCaseReducersByName:{},sliceCaseReducersByType:{},actionCreators:{},sliceMatchers:[]},f={addCase(N,O){const U=typeof N=="string"?N:N.type;if(!U)throw new Error(vp(12));if(U in c.sliceCaseReducersByType)throw new Error(vp(13));return c.sliceCaseReducersByType[U]=O,f},addMatcher(N,O){return c.sliceMatchers.push({matcher:N,reducer:O}),f},exposeAction(N,O){return c.actionCreators[N]=O,f},exposeCaseReducer(N,O){return c.sliceCaseReducersByName[N]=O,f}};o.forEach(N=>{const O=s[N],U={reducerName:N,type:CFe(i,N),createNotation:typeof n.reducers=="function"};MFe(O)?OFe(U,O,f,e):RFe(U,O,f)});function d(){const[N={},O=[],U=void 0]=typeof n.extraReducers=="function"?Ate(n.extraReducers):[n.extraReducers],j={...N,...c.sliceCaseReducersByType};return EFe(n.initialState,H=>{for(let W in j)H.addCase(W,j[W]);for(let W of c.sliceMatchers)H.addMatcher(W.matcher,W.reducer);for(let W of O)H.addMatcher(W.matcher,W.reducer);U&&H.addDefaultCase(U)})}const m=N=>N,b=new Map,x=new WeakMap;let E;function T(N,O){return E||(E=d()),E(N,O)}function A(){return E||(E=d()),E.getInitialState()}function M(N,O=!1){function U(H){let W=H[N];return typeof W>"u"&&O&&(W=Uw(x,U,A)),W}function j(H=m){const W=Uw(b,O,()=>new WeakMap);return Uw(W,H,()=>{const X={};for(const[oe,Q]of Object.entries(n.selectors??{}))X[oe]=IFe(Q,H,()=>Uw(x,H,A),O);return X})}return{reducerPath:N,getSelectors:j,get selectors(){return j(U)},selectSlice:U}}const F={name:i,reducer:T,actions:c.actionCreators,caseReducers:c.sliceCaseReducersByName,getInitialState:A,...M(a),injectInto(N,{reducerPath:O,...U}={}){const j=O??a;return N.inject({reducerPath:j,reducer:T},U),{...F,...M(j,!0)}}};return F}}function IFe(t,e,r,n){function i(a,...s){let o=e(a);return typeof o>"u"&&n&&(o=r()),t(o,...s)}return i.unwrapped=t,i}var PFe=AFe();function kFe(){function t(e,r){return{_reducerDefinitionType:"asyncThunk",payloadCreator:e,...r}}return t.withTypes=()=>t,{reducer(e){return Object.assign({[e.name](...r){return e(...r)}}[e.name],{_reducerDefinitionType:"reducer"})},preparedReducer(e,r){return{_reducerDefinitionType:"reducerWithPrepare",prepare:e,reducer:r}},asyncThunk:t}}function RFe({type:t,reducerName:e,createNotation:r},n,i){let a,s;if("reducer"in n){if(r&&!DFe(n))throw new Error(vp(17));a=n.reducer,s=n.prepare}else a=n;i.addCase(t,a).exposeCaseReducer(e,a).exposeAction(e,s?DH(t,s):DH(t))}function MFe(t){return t._reducerDefinitionType==="asyncThunk"}function DFe(t){return t._reducerDefinitionType==="reducerWithPrepare"}function OFe({type:t,reducerName:e},r,n,i){if(!i)throw new Error(vp(18));const{payloadCreator:a,fulfilled:s,pending:o,rejected:c,settled:f,options:d}=r,m=i(t,a,d);n.exposeAction(e,m),s&&n.addCase(m.fulfilled,s),o&&n.addCase(m.pending,o),c&&n.addCase(m.rejected,c),f&&n.addMatcher(m.settled,f),n.exposeCaseReducer(e,{fulfilled:s||Vw,pending:o||Vw,rejected:c||Vw,settled:f||Vw})}function Vw(){}function vp(t){return`Minified Redux Toolkit error #${t}; visit https://redux-toolkit.js.org/Errors?code=${t} for the full message or use the non-minified dev environment for full errors. `}function Ite(t,e,r){e.forEach(n=>{t(n,r),n.layers&&n.layers.length>0&&Ite(t,n.layers,n)})}const NFe={mapConfigs:{}},Pte=PFe({name:"mapConfig",initialState:NFe,reducers:{setMapConfig:(t,e)=>{const r=e.payload.mapConfig,n=e.payload.key;t.mapConfigs[n]=r},removeMapConfig:(t,e)=>{delete t.mapConfigs[e.payload.key]},setLayerInMapConfig:(t,e)=>{const{mapConfigKey:r,layer:n}=e.payload,i=t.mapConfigs[r];if(i){for(let a=0;a<i.layers.length;a++)if(i.layers[a].uuid===n.uuid){i.layers[a]=n;break}}},removeLayerFromMapConfig:(t,e)=>{const{mapConfigKey:r,layerUuid:n}=e.payload,i=t.mapConfigs[r];if(i){const a=i.layers.findIndex(s=>s.uuid===n);a!==-1&&(delete i.layers[a],Ite(function(s,o){o&&o.layers&&(o.layers=o.layers.filter(c=>c.uuid!==n))},i.layerOrder))}},updateLayerOrder:(t,e)=>{const{mapConfigKey:r,newOrder:n}=e.payload,i=t.mapConfigs[r];i&&(i.layerOrder=n)},setMasterVisible(t,e){const{mapConfigKey:r,layerId:n,masterVisible:i}=e.payload,a=t.mapConfigs[r];if(a){const s=a.layers.findIndex(o=>o.uuid===n);if(s!==-1){const o=a.layers[s];if(o){const c=[...a.layers];o.type==="folder"&&a.layerOrder.forEach(f=>{f.uuid===n&&f.layers?.forEach(d=>{const m=a.layers.findIndex(x=>x.uuid===d.uuid),b=c[m];c[m]={...b,masterVisible:i},b?.type==="vt"&&b?.config?.layers&&(b.config.layers=b.config.layers.map(x=>({...x,masterVisible:i})))})}),o.type==="vt"&&o?.config?.layers&&(o.config.layers=o.config.layers.map(f=>({...f,masterVisible:i}))),t.mapConfigs[r].layers=c}}}}}}),kte=(t,e)=>{const r=t.mapConfigs;for(const n in r){const i=r[n],a=i.layers.findIndex(o=>o.uuid===e),s=i.layers[a];if(s)return s}return null},LFe=(t,e)=>{const r=t.mapConfig.mapConfigs[e];if(!r)return[];const n=r.layerOrder,i=[];function a(s){s.forEach(o=>{i.push(o.uuid),o.layers&&o.layers.length>0&&a(o.layers)})}return a(n),i};wFe({reducer:{mapConfig:Pte.reducer}});const{setMapConfig:FWe,removeMapConfig:BWe,setLayerInMapConfig:Rte,removeLayerFromMapConfig:zWe,updateLayerOrder:FFe,setMasterVisible:BFe}=Pte.actions,LH=Ji(J.jsx("path",{d:"M8.59 16.59 13.17 12 8.59 7.41 10 6l6 6-6 6z"}));function HM(t){return J.jsx(rx,{value:t.value,label:"Color",onChange:e=>{typeof t.onChange=="function"&&t.onChange(e)}})}try{HM.displayName="PaintPropsColorPicker",HM.__docgenInfo={description:"",displayName:"PaintPropsColorPicker",props:{value:{defaultValue:null,description:"",name:"value",required:!0,type:{name:"string"}},onChange:{defaultValue:null,description:"",name:"onChange",required:!0,type:{name:"(value: string) => void"}}}}}catch{}const zFe=Dr(hf)({marginLeft:"-100px",marginRight:"-21px",paddingLeft:"53px",borderRadius:"0px",boxShadow:"none",backgroundColor:"rgb(0, 0, 0, 0)"}),jFe=Dr(Bo)({marginLeft:"61px"}),Mte={"circle-color":"colorpicker","circle-radius":"slider","circle-stroke-color":"colorpicker","circle-stroke-width":"slider","fill-color":"colorpicker","fill-outline-color":"colorpicker","line-color":"colorpicker","line-width":"slider","line-blur":"slider"},UFe=Object.keys(Mte),VFe={"circle-stroke-width":{step:1,min:1,max:20},"circle-radius":{step:1,min:1,max:100},"line-blur":{step:1,min:1,max:100},"line-width":{step:1,min:1,max:100}};function GM(t){const e=te.useRef(Math.round(Math.random()*1e10)),r=kte(Vm(o=>o.mapConfig),t.layerUuid),n=mte(),i=te.useMemo(()=>r?.config?.options?.paint?r?.config?.options?.paint:{},[r?.config?.options?.paint]),a=(o,c)=>{const f={...r,config:{...r?.config,options:{...r?.config?.options,paint:{...r?.config?.options?.paint,[o]:c}}}};n(Rte({mapConfigKey:t.mapConfigKey,layer:f}))},s=te.useCallback(o=>{if(i?.[o]&&UFe.indexOf(o)!==-1&&(typeof i[o]=="number"||typeof i[o]=="string")){const c=J.jsx(Ss,{id:o+"_label",gutterBottom:!0,children:o});switch(Mte[o]){case"slider":return J.jsxs(gt.Fragment,{children:[c,J.jsx(mO,{...VFe[o],value:i[o],valueLabelDisplay:"auto",onChange:(f,d)=>{d&&typeof d=="number"&&a(o,d)}})]},o);case"numberfield":return J.jsxs(gt.Fragment,{children:[c,J.jsx(e3,{inputProps:{inputMode:"decimal",pattern:"[0-9]*"},value:i[o],onChange:f=>{f?.target?.value&&a(o,parseInt(f.target.value))}})]},o);case"colorpicker":return J.jsxs(gt.Fragment,{children:[c,J.jsx(Bo,{sx:{"& > div":{width:"initial !important"}},children:J.jsx(HM,{value:i[o],onChange:f=>{a(o,f)}},o)})]},o)}}return null},[i]);return J.jsx(J.Fragment,{children:J.jsx(zFe,{children:J.jsx(Gf,{children:J.jsx(jFe,{children:i&&Object.keys(i).map(o=>s(o))})},e.current+"_paintPropForm")})})}try{GM.displayName="LayerPropertyForm",GM.__docgenInfo={description:"",displayName:"LayerPropertyForm",props:{layerUuid:{defaultValue:null,description:"",name:"layerUuid",required:!0,type:{name:"string"}},mapConfigKey:{defaultValue:null,description:"",name:"mapConfigKey",required:!0,type:{name:"string"}}}}}catch{}const $Fe=Dr(Rc)({padding:"4px",marginTop:"-3px"}),qFe=Dr(Rc)({marginLeft:"20px"}),E1=Dr(Gf)({paddingRight:0,paddingLeft:0,paddingTop:0,paddingBottom:"4px"}),RP=Dr(Ub)({minWidth:"30px"}),$w=Dr(Rc)({marginRight:"0px",padding:"0px"}),FH=Dr(Bo)(({open:t})=>({display:t?"block":"none"})),BH=Dr(Mh)({marginLeft:"50px"});function aT(t){const[e,r]=te.useState(!1),[n,i]=te.useState(!1),a=kte(Vm(A=>A.mapConfig),t.layerOrderConfig.uuid),[s,o]=te.useState(!1),c=mte(),f=Vm(A=>A.mapConfig.mapConfigs[t.mapConfigKey]);function d(A,M){const F=JSON.parse(JSON.stringify(f.layerOrder)),N=O=>{let U=!1;return O.forEach((j,H)=>{if(!U)if(j.uuid===A){const W=M(H);if(W<0||W>=O.length)throw new Error("New position is out of bounds");const[X]=O.splice(H,1);O.splice(W,0,X),U=!0}else j.layers&&N(j.layers)&&(U=!0)}),U};N(F),c(FFe({mapConfigKey:t.mapConfigKey,newOrder:F}))}const m=A=>{d(A,M=>M+1)},b=A=>{d(A,M=>M-1)};function x(A,M=""){const F=!A;a&&(E(a,F,M),(a.type==="folder"||a.type==="vt"&&M==="")&&c(BFe({mapConfigKey:t.mapConfigKey,layerId:a.uuid,masterVisible:F})))}function E(A,M,F){let N={...A};if(A?.type==="folder")N={...A,visible:!A.visible};else switch(A?.type){case"geojson":{N={...A,config:{...A.config,options:{...A?.config?.options,layout:{...A?.config?.options?.layout,visibility:M?"visible":"none"}}}};break}case"vt":{let O=!1;const U=A.config.layers.map(j=>j.id===F?(O=!0,{...j,layout:{...j.layout,visibility:M?"visible":"none"}}):j);O?N={...A,config:{...A.config,layers:U}}:N={...A,visible:M,config:{...A.config,layers:U}};break}case"wms":{N={...A,visible:M,config:{...A.config,visible:M}};break}}return c(Rte({mapConfigKey:t.mapConfigKey,layer:N})),N}function T(A){let M=!0;if(A?.type==="geojson")return M=A?.config?.options?.layout?.visibility!=="none",J.jsxs(J.Fragment,{children:[J.jsxs(E1,{sx:{...t.listItemSx},secondaryAction:J.jsxs(J.Fragment,{children:[t?.buttons,J.jsx($w,{disabled:!1,onClick:()=>{m(A.uuid)},children:J.jsx(IS,{})}),J.jsx($w,{disabled:!1,onClick:()=>{b(A.uuid)},children:J.jsx(PS,{})}),A.configurable&&J.jsx(J.Fragment,{children:J.jsx($Fe,{edge:"end","aria-label":"settings",onClick:()=>{r(F=>!F)},children:J.jsx(dN,{})})})]}),children:[J.jsx(lp,{children:J.jsx(up,{checked:M,disabled:A.masterVisible===!1,onClick:()=>x(M)})}),J.jsx(Lf,{variant:"layerlist",primary:A.name||"",secondary:t.description,primaryTypographyProps:{overflow:"hidden"}}),t.buttons]},A.uuid),A.configurable&&e&&J.jsxs(J.Fragment,{children:[t.showDeleteButton&&J.jsxs(J.Fragment,{children:[J.jsx(qFe,{edge:"end","aria-label":"delete",onClick:()=>{},children:J.jsx(Hx,{})}),n&&J.jsx(e_,{open:n,onConfirm:()=>{i(!1)},onCancel:()=>{i(!1)},title:"Delete layer",text:"Are you sure you want to delete this layer?"})]}),J.jsx(GM,{layerUuid:A.uuid,mapConfigKey:t.mapConfigKey})]})]});if(A?.type==="vt")return J.jsxs(J.Fragment,{children:[J.jsxs(E1,{sx:{...t.listItemSx},secondaryAction:void 0,children:[J.jsxs(RP,{children:[J.jsx($w,{edge:"end","aria-label":"open",onClick:()=>o(!s),children:s?J.jsx(xE,{}):J.jsx(LH,{})}),J.jsx(lp,{children:J.jsx(up,{checked:A.visible,disabled:A.masterVisible===!1,onClick:()=>x(A.visible??!1)})})]}),J.jsx(Lf,{primary:A.name,secondary:t.description,primaryTypographyProps:{overflow:"hidden"}})]},A.uuid),J.jsx(FH,{open:s,children:J.jsx(BH,{disablePadding:!0,children:A.config?.layers?.map(F=>J.jsxs(E1,{sx:{...t.listItemSx},secondaryAction:void 0,children:[" ",J.jsx(RP,{children:J.jsx(lp,{children:J.jsx(up,{checked:(F?.layout?.visibility??"visible")==="visible",disabled:F?.masterVisible===!1,onClick:()=>x(F?.layout?.visibility==="visible",F.id)})})}),J.jsx(Lf,{variant:"layerlist",primary:F["source-layer"],primaryTypographyProps:{overflow:"hidden"}},F.id)]},F.id))})},A.uuid+"_list")]});if(A?.type==="wms"){const F=A.config?.visible??!0;return J.jsx(J.Fragment,{children:J.jsxs(E1,{sx:{...t.listItemSx},secondaryAction:void 0,children:[J.jsx(lp,{children:J.jsx(up,{checked:F,disabled:A.masterVisible===!1,onClick:()=>x(F)})}),J.jsx(Lf,{primary:A.name,secondary:t.description,primaryTypographyProps:{overflow:"hidden"}})]},A.uuid)})}return A.type==="folder"?J.jsxs(J.Fragment,{children:[J.jsxs(E1,{sx:{...t.listItemSx},children:[J.jsxs(RP,{children:[J.jsx($w,{edge:"end","aria-label":"open",onClick:()=>o(!s),children:s?J.jsx(xE,{}):J.jsx(LH,{})}),J.jsx(lp,{children:J.jsx(up,{checked:A.visible,disabled:A.masterVisible,onClick:()=>x(A.visible?A.visible:!1)})})]}),J.jsx(Lf,{primary:A.name,secondary:t.description,primaryTypographyProps:{overflow:"hidden"}})]},A.uuid),J.jsx(FH,{open:s,children:J.jsx(BH,{disablePadding:!0,children:t?.layerOrderConfig?.layers?.map(F=>J.jsx(aT,{layerOrderConfig:F,mapConfigKey:t.mapConfigKey},F.uuid))})},A.uuid+"_list")]}):J.jsx(J.Fragment,{})}return J.jsx(J.Fragment,{children:a&&T(a)})}try{aT.displayName="LayerTreeListItem",aT.__docgenInfo={description:"",displayName:"LayerTreeListItem",props:{visible:{defaultValue:null,description:"",name:"visible",required:!1,type:{name:"boolean | undefined"}},type:{defaultValue:null,description:"",name:"type",required:!1,type:{name:"enum",value:[{value:"undefined"},{value:'"background"'},{value:'"layer"'},{value:'"background-labels"'},{value:'"wms-layer"'},{value:'"vector-tile-layer"'}]}},name:{defaultValue:null,description:"",name:"name",required:!1,type:{name:"string | undefined"}},description:{defaultValue:null,description:"",name:"description",required:!1,type:{name:"string | undefined"}},setLayerState:{defaultValue:null,description:"",name:"setLayerState",required:!1,type:{name:"((state: unknown) => void) | undefined"}},showDeleteButton:{defaultValue:null,description:"",name:"showDeleteButton",required:!1,type:{name:"boolean | undefined"}},listItemSx:{defaultValue:null,description:"",name:"listItemSx",required:!1,type:{name:"SxProps | undefined"}},buttons:{defaultValue:null,description:"",name:"buttons",required:!1,type:{name:"Element | undefined"}},sortable:{defaultValue:null,description:"",name:"sortable",required:!1,type:{name:"boolean | undefined"}},mapConfigKey:{defaultValue:null,description:"",name:"mapConfigKey",required:!0,type:{name:"string"}},layerOrderConfig:{defaultValue:null,description:"",name:"layerOrderConfig",required:!0,type:{name:"LayerOrderItem"}}}}}catch{}const HFe=Dr(Mh)({marginTop:"15px"});function zH(t){const e=Vm(r=>r.mapConfig.mapConfigs?.[t.mapConfigKey]?.layerOrder);return J.jsx(HFe,{children:e?.map?.(r=>J.jsx(aT,{layerOrderConfig:r,mapConfigKey:t.mapConfigKey},r.uuid))})}try{zH.displayName="LayerTree",zH.__docgenInfo={description:"",displayName:"LayerTree",props:{mapConfigKey:{defaultValue:null,description:"",name:"mapConfigKey",required:!0,type:{name:"string"}}}}}catch{}function jH(t){const e=Vm(c=>c.mapConfig.mapConfigs?.[t.mapConfigKey]?.layers),r=Vm(c=>c.mapConfig.mapConfigs?.[t.mapConfigKey]?.layerOrder),n=va({mapId:t?.mapId}),i=Vm(c=>LFe(c,t.mapConfigKey)),a=te.useRef([]);te.useEffect(()=>{if(!n.map||!r)return;const c=(d,m,b)=>{for(let x=0;x<d.length;x++){const E=d[x],T=m?m[x]:null;if(E.uuid!==T?.uuid&&b.getLayer(E.uuid)){const A=x>0?d[x-1].uuid:void 0;b.moveLayer(E.uuid,A)}if(E.layers&&E.layers.length>0){const A=T?.layers||[];c(E.layers,A,b)}}},f=a.current;c(r,f,n.map),a.current=r},[r,n.map]);const s=te.useMemo(()=>["order-background",...i.map(f=>"layer_id_"+f),"order-labels"],[i]);function o(c){const f=e.findIndex(m=>m.uuid===c.uuid),d=e[f];switch(d?.type){case"geojson":return J.jsx(Nc,{layerId:d.uuid,insertBeforeLayer:"layer_id_"+d.uuid,...d.config,options:{...d.config.options,layout:{...d?.config?.options?.layout,visibility:d.masterVisible===!1?"none":d?.config?.options?.layout?.visibility?d?.config?.options?.layout?.visibility:"visible"}}},d.uuid);case"vt":{const m=d.config.layers.map(b=>{const x={...b};return x.layout&&(x.layout={...x.layout,visibility:x.masterVisible===!1?"none":x.layout.visibility??"visible"}),x});return J.jsx(R0,{layerId:d.uuid,insertBeforeLayer:"layer_id_"+d.uuid,url:d.config.url,layers:m},d.uuid)}case"wms":{const m=d.masterVisible===!1?!1:d.config?.visible;return J.jsx(zE,{layerId:d.uuid,insertBeforeLayer:"layer_id_"+d.uuid,url:d.config?.url||"",urlParameters:d.config?.urlParameters,visible:m},d.uuid)}case"folder":return c?.layers?c.layers.map(m=>o(m)):J.jsx(J.Fragment,{});default:return null}}return J.jsxs(J.Fragment,{children:[J.jsx(UE,{layerIds:s}),r?.map?.(c=>o(c))]})}try{jH.displayName="LayerOnMap",jH.__docgenInfo={description:"",displayName:"LayerOnMap",props:{mapConfigKey:{defaultValue:null,description:"",name:"mapConfigKey",required:!0,type:{name:"string"}},mapId:{defaultValue:null,description:"",name:"mapId",required:!1,type:{name:"string | undefined"}}}}}catch{}function oT(t,e){if(!t)throw new Error(e||"loader assertion failed.")}const DL=!!(typeof process!="object"||String(process)!=="[object process]"||process.browser),UH=typeof process<"u"&&process.version&&/v([0-9]*)/.exec(process.version);UH&&parseFloat(UH[1]);const VH=globalThis,$H=globalThis.process||{},GFe=globalThis.navigator||{};function Dte(t){if(typeof window<"u"&&window.process?.type==="renderer"||typeof process<"u"&&process.versions?.electron)return!0;const r=typeof navigator<"u"&&navigator.userAgent;return!!(r&&r.indexOf("Electron")>=0)}function Dy(){return!(typeof process=="object"&&String(process)==="[object process]"&&!process?.browser)||Dte()}function WFe(t){return Dy()?Dte()?"Electron":(GFe.userAgent||"").indexOf("Edge")>-1?"Edge":globalThis.chrome?"Chrome":globalThis.safari?"Safari":globalThis.mozInnerScreenX?"Firefox":"Unknown":"Node"}const Ote="4.1.0";function XFe(t){try{const e=window[t],r="__storage_test__";return e.setItem(r,r),e.removeItem(r),e}catch{return null}}class YFe{constructor(e,r,n="sessionStorage"){this.storage=XFe(n),this.id=e,this.config=r,this._loadConfiguration()}getConfiguration(){return this.config}setConfiguration(e){if(Object.assign(this.config,e),this.storage){const r=JSON.stringify(this.config);this.storage.setItem(this.id,r)}}_loadConfiguration(){let e={};if(this.storage){const r=this.storage.getItem(this.id);e=r?JSON.parse(r):{}}return Object.assign(this.config,e),this}}function ZFe(t){let e;return t<10?e=`${t.toFixed(2)}ms`:t<100?e=`${t.toFixed(1)}ms`:t<1e3?e=`${t.toFixed(0)}ms`:e=`${(t/1e3).toFixed(2)}s`,e}function KFe(t,e=8){const r=Math.max(e-t.length,0);return`${" ".repeat(r)}${t}`}var sT;(function(t){t[t.BLACK=30]="BLACK",t[t.RED=31]="RED",t[t.GREEN=32]="GREEN",t[t.YELLOW=33]="YELLOW",t[t.BLUE=34]="BLUE",t[t.MAGENTA=35]="MAGENTA",t[t.CYAN=36]="CYAN",t[t.WHITE=37]="WHITE",t[t.BRIGHT_BLACK=90]="BRIGHT_BLACK",t[t.BRIGHT_RED=91]="BRIGHT_RED",t[t.BRIGHT_GREEN=92]="BRIGHT_GREEN",t[t.BRIGHT_YELLOW=93]="BRIGHT_YELLOW",t[t.BRIGHT_BLUE=94]="BRIGHT_BLUE",t[t.BRIGHT_MAGENTA=95]="BRIGHT_MAGENTA",t[t.BRIGHT_CYAN=96]="BRIGHT_CYAN",t[t.BRIGHT_WHITE=97]="BRIGHT_WHITE"})(sT||(sT={}));const JFe=10;function qH(t){return typeof t!="string"?t:(t=t.toUpperCase(),sT[t]||sT.WHITE)}function QFe(t,e,r){return!Dy&&typeof t=="string"&&(e&&(t=`\x1B[${qH(e)}m${t}\x1B[39m`),r&&(t=`\x1B[${qH(r)+JFe}m${t}\x1B[49m`)),t}function e8e(t,e=["constructor"]){const r=Object.getPrototypeOf(t),n=Object.getOwnPropertyNames(r),i=t;for(const a of n){const s=i[a];typeof s=="function"&&(e.find(o=>a===o)||(i[a]=s.bind(t)))}}function OL(t,e){if(!t)throw new Error("Assertion failed")}function Iv(){let t;if(Dy()&&VH.performance)t=VH?.performance?.now?.();else if("hrtime"in $H){const e=$H?.hrtime?.();t=e[0]*1e3+e[1]/1e6}else t=Date.now();return t}const Pv={debug:Dy()&&console.debug||console.log,log:console.log,info:console.info,warn:console.warn,error:console.error},t8e={enabled:!0,level:0};function kv(){}const HH={},GH={once:!0};class i2{constructor({id:e}={id:""}){this.VERSION=Ote,this._startTs=Iv(),this._deltaTs=Iv(),this.userData={},this.LOG_THROTTLE_TIMEOUT=0,this.id=e,this.userData={},this._storage=new YFe(`__probe-${this.id}__`,t8e),this.timeStamp(`${this.id} started`),e8e(this),Object.seal(this)}set level(e){this.setLevel(e)}get level(){return this.getLevel()}isEnabled(){return this._storage.config.enabled}getLevel(){return this._storage.config.level}getTotal(){return Number((Iv()-this._startTs).toPrecision(10))}getDelta(){return Number((Iv()-this._deltaTs).toPrecision(10))}set priority(e){this.level=e}get priority(){return this.level}getPriority(){return this.level}enable(e=!0){return this._storage.setConfiguration({enabled:e}),this}setLevel(e){return this._storage.setConfiguration({level:e}),this}get(e){return this._storage.config[e]}set(e,r){this._storage.setConfiguration({[e]:r})}settings(){console.table?console.table(this._storage.config):console.log(this._storage.config)}assert(e,r){if(!e)throw new Error(r||"Assertion failed")}warn(e){return this._getLogFunction(0,e,Pv.warn,arguments,GH)}error(e){return this._getLogFunction(0,e,Pv.error,arguments)}deprecated(e,r){return this.warn(`\`${e}\` is deprecated and will be removed in a later version. Use \`${r}\` instead`)}removed(e,r){return this.error(`\`${e}\` has been removed. Use \`${r}\` instead`)}probe(e,r){return this._getLogFunction(e,r,Pv.log,arguments,{time:!0,once:!0})}log(e,r){return this._getLogFunction(e,r,Pv.debug,arguments)}info(e,r){return this._getLogFunction(e,r,console.info,arguments)}once(e,r){return this._getLogFunction(e,r,Pv.debug||Pv.info,arguments,GH)}table(e,r,n){return r?this._getLogFunction(e,r,console.table||kv,n&&[n],{tag:n8e(r)}):kv}time(e,r){return this._getLogFunction(e,r,console.time?console.time:console.info)}timeEnd(e,r){return this._getLogFunction(e,r,console.timeEnd?console.timeEnd:console.info)}timeStamp(e,r){return this._getLogFunction(e,r,console.timeStamp||kv)}group(e,r,n={collapsed:!1}){const i=WH({logLevel:e,message:r,opts:n}),{collapsed:a}=n;return i.method=(a?console.groupCollapsed:console.group)||console.info,this._getLogFunction(i)}groupCollapsed(e,r,n={}){return this.group(e,r,Object.assign({},n,{collapsed:!0}))}groupEnd(e){return this._getLogFunction(e,"",console.groupEnd||kv)}withGroup(e,r,n){this.group(e,r)();try{n()}finally{this.groupEnd(e)()}}trace(){console.trace&&console.trace()}_shouldLog(e){return this.isEnabled()&&this.getLevel()>=Nte(e)}_getLogFunction(e,r,n,i,a){if(this._shouldLog(e)){a=WH({logLevel:e,message:r,args:i,opts:a}),n=n||a.method,OL(n),a.total=this.getTotal(),a.delta=this.getDelta(),this._deltaTs=Iv();const s=a.tag||a.message;if(a.once&&s)if(!HH[s])HH[s]=Iv();else return kv;return r=r8e(this.id,a.message,a),n.bind(console,r,...a.args)}return kv}}i2.VERSION=Ote;function Nte(t){if(!t)return 0;let e;switch(typeof t){case"number":e=t;break;case"object":e=t.logLevel||t.priority||0;break;default:return 0}return OL(Number.isFinite(e)&&e>=0),e}function WH(t){const{logLevel:e,message:r}=t;t.logLevel=Nte(e);const n=t.args?Array.from(t.args):[];for(;n.length&&n.shift()!==r;);switch(typeof e){case"string":case"function":r!==void 0&&n.unshift(r),t.message=e;break;case"object":Object.assign(t,e);break}typeof t.message=="function"&&(t.message=t.message());const i=typeof t.message;return OL(i==="string"||i==="object"),Object.assign(t,{args:n},t.opts)}function r8e(t,e,r){if(typeof e=="string"){const n=r.time?KFe(ZFe(r.total)):"";e=r.time?`${t}: ${n}  ${e}`:`${t}: ${e}`,e=QFe(e,r.color,r.background)}return e}function n8e(t){for(const e in t)for(const r in t[e])return r||"untitled";return"empty"}const MP="4.3.3",i8e=MP[0]>="0"&&MP[0]<="9"?`v${MP}`:"";function a8e(){const t=new i2({id:"loaders.gl"});return globalThis.loaders=globalThis.loaders||{},globalThis.loaders.log=t,globalThis.loaders.version=i8e,globalThis.probe=globalThis.probe||{},globalThis.probe.loaders=t,t}const o8e=a8e();function s8e(t,e){return Lte(t||{},e)}function Lte(t,e,r=0){if(r>3)return e;const n={...t};for(const[i,a]of Object.entries(e))a&&typeof a=="object"&&!Array.isArray(a)?n[i]=Lte(n[i]||{},e[i],r+1):n[i]=e[i];return n}const l8e="latest";function u8e(){return globalThis._loadersgl_?.version||(globalThis._loadersgl_=globalThis._loadersgl_||{},globalThis._loadersgl_.version="4.3.3"),globalThis._loadersgl_.version}const c8e=u8e();function Mg(t,e){if(!t)throw new Error(e||"loaders.gl assertion failed.")}const $m=typeof process!="object"||String(process)!=="[object process]"||process.browser,jWe=typeof importScripts=="function",f8e=typeof window<"u"&&typeof window.orientation<"u",XH=typeof process<"u"&&process.version&&/v([0-9]*)/.exec(process.version);XH&&parseFloat(XH[1]);class h8e{name;workerThread;isRunning=!0;result;_resolve=()=>{};_reject=()=>{};constructor(e,r){this.name=e,this.workerThread=r,this.result=new Promise((n,i)=>{this._resolve=n,this._reject=i})}postMessage(e,r){this.workerThread.postMessage({source:"loaders.gl",type:e,payload:r})}done(e){Mg(this.isRunning),this.isRunning=!1,this._resolve(e)}error(e){Mg(this.isRunning),this.isRunning=!1,this._reject(e)}}class DP{terminate(){}}const OP=new Map;function d8e(t){Mg(t.source&&!t.url||!t.source&&t.url);let e=OP.get(t.source||t.url);return e||(t.url&&(e=p8e(t.url),OP.set(t.url,e)),t.source&&(e=Fte(t.source),OP.set(t.source,e))),Mg(e),e}function p8e(t){if(!t.startsWith("http"))return t;const e=g8e(t);return Fte(e)}function Fte(t){const e=new Blob([t],{type:"application/javascript"});return URL.createObjectURL(e)}function g8e(t){return`try {
  importScripts('${t}');
} catch (error) {
  console.error(error);
  throw error;
}`}function Bte(t,e=!0,r){const n=r||new Set;if(t){if(YH(t))n.add(t);else if(YH(t.buffer))n.add(t.buffer);else if(!ArrayBuffer.isView(t)){if(e&&typeof t=="object")for(const i in t)Bte(t[i],e,n)}}return r===void 0?Array.from(n):[]}function YH(t){return t?t instanceof ArrayBuffer||typeof MessagePort<"u"&&t instanceof MessagePort||typeof ImageBitmap<"u"&&t instanceof ImageBitmap||typeof OffscreenCanvas<"u"&&t instanceof OffscreenCanvas:!1}const NP=()=>{};class WM{name;source;url;terminated=!1;worker;onMessage;onError;_loadableURL="";static isSupported(){return typeof Worker<"u"&&$m||typeof DP<"u"&&!$m}constructor(e){const{name:r,source:n,url:i}=e;Mg(n||i),this.name=r,this.source=n,this.url=i,this.onMessage=NP,this.onError=a=>console.log(a),this.worker=$m?this._createBrowserWorker():this._createNodeWorker()}destroy(){this.onMessage=NP,this.onError=NP,this.worker.terminate(),this.terminated=!0}get isRunning(){return!!this.onMessage}postMessage(e,r){r=r||Bte(e),this.worker.postMessage(e,r)}_getErrorFromErrorEvent(e){let r="Failed to load ";return r+=`worker ${this.name} from ${this.url}. `,e.message&&(r+=`${e.message} in `),e.lineno&&(r+=`:${e.lineno}:${e.colno}`),new Error(r)}_createBrowserWorker(){this._loadableURL=d8e({source:this.source,url:this.url});const e=new Worker(this._loadableURL,{name:this.name});return e.onmessage=r=>{r.data?this.onMessage(r.data):this.onError(new Error("No data received"))},e.onerror=r=>{this.onError(this._getErrorFromErrorEvent(r)),this.terminated=!0},e.onmessageerror=r=>console.error(r),e}_createNodeWorker(){let e;if(this.url){const n=this.url.includes(":/")||this.url.startsWith("/")?this.url:`./${this.url}`;e=new DP(n,{eval:!1})}else if(this.source)e=new DP(this.source,{eval:!0});else throw new Error("no worker");return e.on("message",r=>{this.onMessage(r)}),e.on("error",r=>{this.onError(r)}),e.on("exit",r=>{}),e}}class m8e{name="unnamed";source;url;maxConcurrency=1;maxMobileConcurrency=1;onDebug=()=>{};reuseWorkers=!0;props={};jobQueue=[];idleQueue=[];count=0;isDestroyed=!1;static isSupported(){return WM.isSupported()}constructor(e){this.source=e.source,this.url=e.url,this.setProps(e)}destroy(){this.idleQueue.forEach(e=>e.destroy()),this.isDestroyed=!0}setProps(e){this.props={...this.props,...e},e.name!==void 0&&(this.name=e.name),e.maxConcurrency!==void 0&&(this.maxConcurrency=e.maxConcurrency),e.maxMobileConcurrency!==void 0&&(this.maxMobileConcurrency=e.maxMobileConcurrency),e.reuseWorkers!==void 0&&(this.reuseWorkers=e.reuseWorkers),e.onDebug!==void 0&&(this.onDebug=e.onDebug)}async startJob(e,r=(i,a,s)=>i.done(s),n=(i,a)=>i.error(a)){const i=new Promise(a=>(this.jobQueue.push({name:e,onMessage:r,onError:n,onStart:a}),this));return this._startQueuedJob(),await i}async _startQueuedJob(){if(!this.jobQueue.length)return;const e=this._getAvailableWorker();if(!e)return;const r=this.jobQueue.shift();if(r){this.onDebug({message:"Starting job",name:r.name,workerThread:e,backlog:this.jobQueue.length});const n=new h8e(r.name,e);e.onMessage=i=>r.onMessage(n,i.type,i.payload),e.onError=i=>r.onError(n,i),r.onStart(n);try{await n.result}catch(i){console.error(`Worker exception: ${i}`)}finally{this.returnWorkerToQueue(e)}}}returnWorkerToQueue(e){!$m||this.isDestroyed||!this.reuseWorkers||this.count>this._getMaxConcurrency()?(e.destroy(),this.count--):this.idleQueue.push(e),this.isDestroyed||this._startQueuedJob()}_getAvailableWorker(){if(this.idleQueue.length>0)return this.idleQueue.shift()||null;if(this.count<this._getMaxConcurrency()){this.count++;const e=`${this.name.toLowerCase()} (#${this.count} of ${this.maxConcurrency})`;return new WM({name:e,source:this.source,url:this.url})}return null}_getMaxConcurrency(){return f8e?this.maxMobileConcurrency:this.maxConcurrency}}const y8e={maxConcurrency:3,maxMobileConcurrency:1,reuseWorkers:!0,onDebug:()=>{}};class ug{props;workerPools=new Map;static _workerFarm;static isSupported(){return WM.isSupported()}static getWorkerFarm(e={}){return ug._workerFarm=ug._workerFarm||new ug({}),ug._workerFarm.setProps(e),ug._workerFarm}constructor(e){this.props={...y8e},this.setProps(e),this.workerPools=new Map}destroy(){for(const e of this.workerPools.values())e.destroy();this.workerPools=new Map}setProps(e){this.props={...this.props,...e};for(const r of this.workerPools.values())r.setProps(this._getWorkerPoolProps())}getWorkerPool(e){const{name:r,source:n,url:i}=e;let a=this.workerPools.get(r);return a||(a=new m8e({name:r,source:n,url:i}),a.setProps(this._getWorkerPoolProps()),this.workerPools.set(r,a)),a}_getWorkerPoolProps(){return{maxConcurrency:this.props.maxConcurrency,maxMobileConcurrency:this.props.maxMobileConcurrency,reuseWorkers:this.props.reuseWorkers,onDebug:this.props.onDebug}}}function v8e(t,e={}){const r=e[t.id]||{},n=$m?`${t.id}-worker.js`:`${t.id}-worker-node.js`;let i=r.workerUrl;if(!i&&t.id==="compression"&&(i=e.workerUrl),e._workerType==="test"&&($m?i=`modules/${t.module}/dist/${n}`:i=`modules/${t.module}/src/workers/${t.id}-worker-node.ts`),!i){let a=t.version;a==="latest"&&(a=l8e);const s=a?`@${a}`:"";i=`https://unpkg.com/@loaders.gl/${t.module}${s}/dist/${n}`}return Mg(i),i}function _8e(t,e=c8e){Mg(t,"no worker provided");const r=t.version;return!(!e||!r)}function b8e(t,e){return!ug.isSupported()||!$m&&!e?._nodeWorkers?!1:t.worker&&e?.worker}async function x8e(t,e,r,n,i){const a=t.id,s=v8e(t,r),c=ug.getWorkerFarm(r).getWorkerPool({name:a,url:s});r=JSON.parse(JSON.stringify(r)),n=JSON.parse(JSON.stringify(n||{}));const f=await c.startJob("process-on-worker",w8e.bind(null,i));return f.postMessage("process",{input:e,options:r,context:n}),await(await f.result).result}async function w8e(t,e,r,n){switch(r){case"done":e.done(n);break;case"error":e.error(new Error(n.error));break;case"process":const{id:i,input:a,options:s}=n;try{const o=await t(a,s);e.postMessage("done",{id:i,result:o})}catch(o){const c=o instanceof Error?o.message:"unknown error";e.postMessage("error",{id:i,error:c})}break;default:console.warn(`parse-with-worker unknown message ${r}`)}}function S8e(t,e,r){if(r=r||t.byteLength,t.byteLength<r||e.byteLength<r)return!1;const n=new Uint8Array(t),i=new Uint8Array(e);for(let a=0;a<n.length;++a)if(n[a]!==i[a])return!1;return!0}function E8e(...t){return T8e(t)}function T8e(t){const e=t.map(a=>a instanceof ArrayBuffer?new Uint8Array(a):a),r=e.reduce((a,s)=>a+s.byteLength,0),n=new Uint8Array(r);let i=0;for(const a of e)n.set(a,i),i+=a.byteLength;return n.buffer}function UWe(t,e,r){const n=r!==void 0?new Uint8Array(t).subarray(e,e+r):new Uint8Array(t).subarray(e);return new Uint8Array(n).buffer}async function C8e(t){const e=[];for await(const r of t)e.push(r);return E8e(...e)}function ZH(){let t;if(typeof window<"u"&&window.performance)t=window.performance.now();else if(typeof process<"u"&&process.hrtime){const e=process.hrtime();t=e[0]*1e3+e[1]/1e6}else t=Date.now();return t}class KH{constructor(e,r){this.sampleSize=1,this.time=0,this.count=0,this.samples=0,this.lastTiming=0,this.lastSampleTime=0,this.lastSampleCount=0,this._count=0,this._time=0,this._samples=0,this._startTime=0,this._timerPending=!1,this.name=e,this.type=r,this.reset()}reset(){return this.time=0,this.count=0,this.samples=0,this.lastTiming=0,this.lastSampleTime=0,this.lastSampleCount=0,this._count=0,this._time=0,this._samples=0,this._startTime=0,this._timerPending=!1,this}setSampleSize(e){return this.sampleSize=e,this}incrementCount(){return this.addCount(1),this}decrementCount(){return this.subtractCount(1),this}addCount(e){return this._count+=e,this._samples++,this._checkSampling(),this}subtractCount(e){return this._count-=e,this._samples++,this._checkSampling(),this}addTime(e){return this._time+=e,this.lastTiming=e,this._samples++,this._checkSampling(),this}timeStart(){return this._startTime=ZH(),this._timerPending=!0,this}timeEnd(){return this._timerPending?(this.addTime(ZH()-this._startTime),this._timerPending=!1,this._checkSampling(),this):this}getSampleAverageCount(){return this.sampleSize>0?this.lastSampleCount/this.sampleSize:0}getSampleAverageTime(){return this.sampleSize>0?this.lastSampleTime/this.sampleSize:0}getSampleHz(){return this.lastSampleTime>0?this.sampleSize/(this.lastSampleTime/1e3):0}getAverageCount(){return this.samples>0?this.count/this.samples:0}getAverageTime(){return this.samples>0?this.time/this.samples:0}getHz(){return this.time>0?this.samples/(this.time/1e3):0}_checkSampling(){this._samples===this.sampleSize&&(this.lastSampleTime=this._time,this.lastSampleCount=this._count,this.count+=this._count,this.time+=this._time,this.samples+=this._samples,this._time=0,this._count=0,this._samples=0)}}class W3{constructor(e){this.stats={},this.id=e.id,this.stats={},this._initializeStats(e.stats),Object.seal(this)}get(e,r="count"){return this._getOrCreate({name:e,type:r})}get size(){return Object.keys(this.stats).length}reset(){for(const e of Object.values(this.stats))e.reset();return this}forEach(e){for(const r of Object.values(this.stats))e(r)}getTable(){const e={};return this.forEach(r=>{e[r.name]={time:r.time||0,count:r.count||0,average:r.getAverageTime()||0,hz:r.getHz()||0}}),e}_initializeStats(e=[]){e.forEach(r=>this._getOrCreate(r))}_getOrCreate(e){const{name:r,type:n}=e;let i=this.stats[r];return i||(e instanceof KH?i=e:i=new KH(r,n),this.stats[r]=i),i}}let A8e="";const JH={};function I8e(t){for(const e in JH)if(t.startsWith(e)){const r=JH[e];t=t.replace(e,r)}return!t.startsWith("http://")&&!t.startsWith("https://")&&(t=`${A8e}${t}`),t}function P8e(t){return t&&typeof t=="object"&&t.isBuffer}function zte(t){if(P8e(t))return t;if(t instanceof ArrayBuffer)return t;if(ArrayBuffer.isView(t))return t.byteOffset===0&&t.byteLength===t.buffer.byteLength?t.buffer:t.buffer.slice(t.byteOffset,t.byteOffset+t.byteLength);if(typeof t=="string"){const e=t;return new TextEncoder().encode(e).buffer}if(t&&typeof t=="object"&&t._toArrayBuffer)return t._toArrayBuffer();throw new Error("toArrayBuffer")}function k8e(){if(typeof process<"u"&&typeof process.cwd<"u")return process.cwd();const t=window.location?.pathname;return t?.slice(0,t.lastIndexOf("/")+1)||""}function jte(t){const e=t?t.lastIndexOf("/"):-1;return e>=0?t.substr(e+1):""}function R8e(t){const e=t?t.lastIndexOf("/"):-1;return e>=0?t.substr(0,e):""}function VWe(...t){const e=[];for(let a=0;a<t.length;a++)e[a]=t[a];let r="",n=!1,i;for(let a=e.length-1;a>=-1&&!n;a--){let s;a>=0?s=e[a]:(i===void 0&&(i=k8e()),s=i),s.length!==0&&(r=`${s}/${r}`,n=s.charCodeAt(0)===J1)}return r=M8e(r,!n),n?`/${r}`:r.length>0?r:"."}const J1=47,LP=46;function M8e(t,e){let r="",n=-1,i=0,a,s=!1;for(let o=0;o<=t.length;++o){if(o<t.length)a=t.charCodeAt(o);else{if(a===J1)break;a=J1}if(a===J1){if(!(n===o-1||i===1))if(n!==o-1&&i===2){if(r.length<2||!s||r.charCodeAt(r.length-1)!==LP||r.charCodeAt(r.length-2)!==LP){if(r.length>2){const c=r.length-1;let f=c;for(;f>=0&&r.charCodeAt(f)!==J1;--f);if(f!==c){r=f===-1?"":r.slice(0,f),n=o,i=0,s=!1;continue}}else if(r.length===2||r.length===1){r="",n=o,i=0,s=!1;continue}}e&&(r.length>0?r+="/..":r="..",s=!0)}else{const c=t.slice(n+1,o);r.length>0?r+=`/${c}`:r=c,s=!1}n=o,i=0}else a===LP&&i!==-1?++i:i=-1}return r}const D8e=t=>typeof t=="boolean",Sb=t=>typeof t=="function",a2=t=>t!==null&&typeof t=="object",QH=t=>a2(t)&&t.constructor==={}.constructor,O8e=t=>!!t&&typeof t[Symbol.iterator]=="function",N8e=t=>t&&typeof t[Symbol.asyncIterator]=="function",Oy=t=>typeof Response<"u"&&t instanceof Response||t&&t.arrayBuffer&&t.text&&t.json,Ny=t=>typeof Blob<"u"&&t instanceof Blob,L8e=t=>t&&typeof t=="object"&&t.isBuffer,F8e=t=>typeof ReadableStream<"u"&&t instanceof ReadableStream||a2(t)&&Sb(t.tee)&&Sb(t.cancel)&&Sb(t.getReader),B8e=t=>a2(t)&&Sb(t.read)&&Sb(t.pipe)&&D8e(t.readable),Ute=t=>F8e(t)||B8e(t);class z8e extends Error{constructor(e,r){super(e),this.reason=r.reason,this.url=r.url,this.response=r.response}reason;url;response}const j8e=/^data:([-\w.]+\/[-\w.+]+)(;|,)/,U8e=/^([-\w.]+\/[-\w.+]+)/;function eG(t,e){return t.toLowerCase()===e.toLowerCase()}function V8e(t){const e=U8e.exec(t);return e?e[1]:t}function tG(t){const e=j8e.exec(t);return e?e[1]:""}const Vte=/\?.*/;function $8e(t){const e=t.match(Vte);return e&&e[0]}function NL(t){return t.replace(Vte,"")}function q8e(t){if(t.length<50)return t;const e=t.slice(t.length-15);return`${t.substr(0,32)}...${e}`}function X3(t){return Oy(t)?t.url:Ny(t)?t.name||"":typeof t=="string"?t:""}function LL(t){if(Oy(t)){const e=t,r=e.headers.get("content-type")||"",n=NL(e.url);return V8e(r)||tG(n)}return Ny(t)?t.type||"":typeof t=="string"?tG(t):""}function H8e(t){return Oy(t)?t.headers["content-length"]||-1:Ny(t)?t.size:typeof t=="string"?t.length:t instanceof ArrayBuffer||ArrayBuffer.isView(t)?t.byteLength:-1}async function $te(t){if(Oy(t))return t;const e={},r=H8e(t);r>=0&&(e["content-length"]=String(r));const n=X3(t),i=LL(t);i&&(e["content-type"]=i);const a=await X8e(t);a&&(e["x-first-bytes"]=a),typeof t=="string"&&(t=new TextEncoder().encode(t));const s=new Response(t,{headers:e});return Object.defineProperty(s,"url",{value:n}),s}async function G8e(t){if(!t.ok)throw await W8e(t)}async function W8e(t){const e=q8e(t.url);let r=`Failed to fetch resource (${t.status}) ${t.statusText}: ${e}`;r=r.length>100?`${r.slice(0,100)}...`:r;const n={reason:t.statusText,url:t.url,response:t};try{const i=t.headers.get("Content-Type");n.reason=!t.bodyUsed&&i?.includes("application/json")?await t.json():await t.text()}catch{}return new z8e(r,n)}async function X8e(t){if(typeof t=="string")return`data:,${t.slice(0,5)}`;if(t instanceof Blob){const r=t.slice(0,5);return await new Promise(n=>{const i=new FileReader;i.onload=a=>n(a?.target?.result),i.readAsDataURL(r)})}if(t instanceof ArrayBuffer){const r=t.slice(0,5);return`data:base64,${Y8e(r)}`}return null}function Y8e(t){let e="";const r=new Uint8Array(t);for(let n=0;n<r.byteLength;n++)e+=String.fromCharCode(r[n]);return btoa(e)}function Z8e(t){return!K8e(t)&&!J8e(t)}function K8e(t){return t.startsWith("http:")||t.startsWith("https:")}function J8e(t){return t.startsWith("data:")}async function rG(t,e){if(typeof t=="string"){const r=I8e(t);return Z8e(r)&&globalThis.loaders?.fetchNode?globalThis.loaders?.fetchNode(r,e):await fetch(r,e)}return await $te(t)}const nG=new i2({id:"loaders.gl"});class Q8e{log(){return()=>{}}info(){return()=>{}}warn(){return()=>{}}error(){return()=>{}}}class eBe{console;constructor(){this.console=console}log(...e){return this.console.log.bind(this.console,...e)}info(...e){return this.console.info.bind(this.console,...e)}warn(...e){return this.console.warn.bind(this.console,...e)}error(...e){return this.console.error.bind(this.console,...e)}}const qte={fetch:null,mimeType:void 0,nothrow:!1,log:new eBe,useLocalLibraries:!1,CDN:"https://unpkg.com/@loaders.gl",worker:!0,maxConcurrency:3,maxMobileConcurrency:1,reuseWorkers:DL,_nodeWorkers:!1,_workerType:"",limit:0,_limitMB:0,batchSize:"auto",batchDebounceMs:0,metadata:!1,transforms:[]},tBe={throws:"nothrow",dataType:"(no longer used)",uri:"baseUri",method:"fetch.method",headers:"fetch.headers",body:"fetch.body",mode:"fetch.mode",credentials:"fetch.credentials",cache:"fetch.cache",redirect:"fetch.redirect",referrer:"fetch.referrer",referrerPolicy:"fetch.referrerPolicy",integrity:"fetch.integrity",keepalive:"fetch.keepalive",signal:"fetch.signal"};function Hte(){globalThis.loaders=globalThis.loaders||{};const{loaders:t}=globalThis;return t._state||(t._state={}),t._state}function Gte(){const t=Hte();return t.globalOptions=t.globalOptions||{...qte},t.globalOptions}function rBe(t,e,r,n){return r=r||[],r=Array.isArray(r)?r:[r],nBe(t,r),aBe(e,t,n)}function nBe(t,e){iG(t,null,qte,tBe,e);for(const r of e){const n=t&&t[r.id]||{},i=r.options&&r.options[r.id]||{},a=r.deprecatedOptions&&r.deprecatedOptions[r.id]||{};iG(n,r.id,i,a,e)}}function iG(t,e,r,n,i){const a=e||"Top level",s=e?`${e}.`:"";for(const o in t){const c=!e&&a2(t[o]),f=o==="baseUri"&&!e,d=o==="workerUrl"&&e;if(!(o in r)&&!f&&!d){if(o in n)nG.warn(`${a} loader option '${s}${o}' no longer supported, use '${n[o]}'`)();else if(!c){const m=iBe(o,i);nG.warn(`${a} loader option '${s}${o}' not recognized. ${m}`)()}}}}function iBe(t,e){const r=t.toLowerCase();let n="";for(const i of e)for(const a in i.options){if(t===a)return`Did you mean '${i.id}.${a}'?`;const s=a.toLowerCase();(r.startsWith(s)||s.startsWith(r))&&(n=n||`Did you mean '${i.id}.${a}'?`)}return n}function aBe(t,e,r){const i={...t.options||{}};return oBe(i,r),i.log===null&&(i.log=new Q8e),aG(i,Gte()),aG(i,e),i}function aG(t,e){for(const r in e)if(r in e){const n=e[r];QH(n)&&QH(t[r])?t[r]={...t[r],...e[r]}:t[r]=e[r]}}function oBe(t,e){e&&!("baseUri"in t)&&(t.baseUri=e)}function FL(t){return t?(Array.isArray(t)&&(t=t[0]),Array.isArray(t?.extensions)):!1}function BL(t){oT(t,"null loader"),oT(FL(t),"invalid loader");let e;return Array.isArray(t)&&(e=t[1],t=t[0],t={...t,options:{...t.options,...e}}),(t?.parseTextSync||t?.parseText)&&(t.text=!0),t.text||(t.binary=!0),t}const Wte=()=>{const t=Hte();return t.loaderRegistry=t.loaderRegistry||[],t.loaderRegistry};function sBe(t){const e=Wte();t=Array.isArray(t)?t:[t];for(const r of t){const n=BL(r);e.find(i=>n===i)||e.unshift(n)}}function lBe(){return Wte()}const uBe=/\.([^.]+)$/;async function cBe(t,e=[],r,n){if(!Xte(t))return null;let i=oG(t,e,{...r,nothrow:!0},n);if(i)return i;if(Ny(t)&&(t=await t.slice(0,10).arrayBuffer(),i=oG(t,e,r,n)),!i&&!r?.nothrow)throw new Error(Yte(t));return i}function oG(t,e=[],r,n){if(!Xte(t))return null;if(e&&!Array.isArray(e))return BL(e);let i=[];e&&(i=i.concat(e)),r?.ignoreRegisteredLoaders||i.push(...lBe()),hBe(i);const a=fBe(t,i,r,n);if(!a&&!r?.nothrow)throw new Error(Yte(t));return a}function fBe(t,e,r,n){const i=X3(t),a=LL(t),s=NL(i)||n?.url;let o=null,c="";return r?.mimeType&&(o=FP(e,r?.mimeType),c=`match forced by supplied MIME type ${r?.mimeType}`),o=o||dBe(e,s),c=c||(o?`matched url ${s}`:""),o=o||FP(e,a),c=c||(o?`matched MIME type ${a}`:""),o=o||gBe(e,t),c=c||(o?`matched initial data ${Zte(t)}`:""),r?.fallbackMimeType&&(o=o||FP(e,r?.fallbackMimeType),c=c||(o?`matched fallback MIME type ${a}`:"")),c&&o8e.log(1,`selectLoader selected ${o?.name}: ${c}.`),o}function Xte(t){return!(t instanceof Response&&t.status===204)}function Yte(t){const e=X3(t),r=LL(t);let n="No valid loader found (";n+=e?`${jte(e)}, `:"no url provided, ",n+=`MIME type: ${r?`"${r}"`:"not provided"}, `;const i=t?Zte(t):"";return n+=i?` first bytes: "${i}"`:"first bytes: not available",n+=")",n}function hBe(t){for(const e of t)BL(e)}function dBe(t,e){const r=e&&uBe.exec(e),n=r&&r[1];return n?pBe(t,n):null}function pBe(t,e){e=e.toLowerCase();for(const r of t)for(const n of r.extensions)if(n.toLowerCase()===e)return r;return null}function FP(t,e){for(const r of t)if(r.mimeTypes?.some(n=>eG(e,n))||eG(e,`application/x.${r.id}`))return r;return null}function gBe(t,e){if(!e)return null;for(const r of t)if(typeof e=="string"){if(mBe(e,r))return r}else if(ArrayBuffer.isView(e)){if(sG(e.buffer,e.byteOffset,r))return r}else if(e instanceof ArrayBuffer&&sG(e,0,r))return r;return null}function mBe(t,e){return e.testText?e.testText(t):(Array.isArray(e.tests)?e.tests:[e.tests]).some(n=>t.startsWith(n))}function sG(t,e,r){return(Array.isArray(r.tests)?r.tests:[r.tests]).some(i=>yBe(t,e,r,i))}function yBe(t,e,r,n){if(n instanceof ArrayBuffer)return S8e(n,t,n.byteLength);switch(typeof n){case"function":return n(t);case"string":const i=XM(t,e,n.length);return n===i;default:return!1}}function Zte(t,e=5){return typeof t=="string"?t.slice(0,e):ArrayBuffer.isView(t)?XM(t.buffer,t.byteOffset,e):t instanceof ArrayBuffer?XM(t,0,e):""}function XM(t,e,r){if(t.byteLength<e+r)return"";const n=new DataView(t);let i="";for(let a=0;a<r;a++)i+=String.fromCharCode(n.getUint8(e+a));return i}const vBe=256*1024;function*_Be(t,e){const r=e?.chunkSize||vBe;let n=0;const i=new TextEncoder;for(;n<t.length;){const a=Math.min(t.length-n,r),s=t.slice(n,n+a);n+=a,yield i.encode(s)}}const bBe=256*1024;function*xBe(t,e={}){const{chunkSize:r=bBe}=e;let n=0;for(;n<t.byteLength;){const i=Math.min(t.byteLength-n,r),a=new ArrayBuffer(i),s=new Uint8Array(t,n,i);new Uint8Array(a).set(s),n+=i,yield a}}const wBe=1024*1024;async function*SBe(t,e){const r=e?.chunkSize||wBe;let n=0;for(;n<t.size;){const i=n+r,a=await t.slice(n,i).arrayBuffer();n=i,yield a}}function lG(t,e){return DL?EBe(t,e):TBe(t)}async function*EBe(t,e){const r=t.getReader();let n;try{for(;;){const i=n||r.read();e?._streamReadAhead&&(n=r.read());const{done:a,value:s}=await i;if(a)return;yield zte(s)}}catch{r.releaseLock()}}async function*TBe(t,e){for await(const r of t)yield zte(r)}function CBe(t,e){if(typeof t=="string")return _Be(t,e);if(t instanceof ArrayBuffer)return xBe(t,e);if(Ny(t))return SBe(t,e);if(Ute(t))return lG(t,e);if(Oy(t))return lG(t.body,e);throw new Error("makeIterator")}const Kte="Cannot convert supplied data type";function ABe(t,e,r){if(e.text&&typeof t=="string")return t;if(L8e(t)&&(t=t.buffer),t instanceof ArrayBuffer){const n=t;return e.text&&!e.binary?new TextDecoder("utf8").decode(n):n}if(ArrayBuffer.isView(t)){if(e.text&&!e.binary)return new TextDecoder("utf8").decode(t);let n=t.buffer;const i=t.byteLength||t.length;return(t.byteOffset!==0||i!==n.byteLength)&&(n=n.slice(t.byteOffset,t.byteOffset+i)),n}throw new Error(Kte)}async function IBe(t,e,r){const n=t instanceof ArrayBuffer||ArrayBuffer.isView(t);if(typeof t=="string"||n)return ABe(t,e);if(Ny(t)&&(t=await $te(t)),Oy(t)){const i=t;return await G8e(i),e.binary?await i.arrayBuffer():await i.text()}if(Ute(t)&&(t=CBe(t,r)),O8e(t)||N8e(t))return C8e(t);throw new Error(Kte)}function Jte(t,e){const r=Gte(),n=t||r;return typeof n.fetch=="function"?n.fetch:a2(n.fetch)?i=>rG(i,n.fetch):e?.fetch?e?.fetch:rG}function PBe(t,e,r){if(r)return r;const n={fetch:Jte(e,t),...t};if(n.url){const i=NL(n.url);n.baseUrl=i,n.queryString=$8e(n.url),n.filename=jte(i),n.baseUrl=R8e(i)}return Array.isArray(n.loaders)||(n.loaders=null),n}function kBe(t,e){if(t&&!Array.isArray(t))return t;let r;if(t&&(r=Array.isArray(t)?t:[t]),e&&e.loaders){const n=Array.isArray(e.loaders)?e.loaders:[e.loaders];r=r?[...r,...n]:n}return r&&r.length?r:void 0}async function lT(t,e,r,n){e&&!Array.isArray(e)&&!FL(e)&&(n=void 0,r=e,e=void 0),t=await t,r=r||{};const i=X3(t),s=kBe(e,n),o=await cBe(t,s,r);return o?(r=rBe(r,o,s,i),n=PBe({url:i,_parse:lT,loaders:s},r,n||null),await RBe(o,t,r,n)):null}async function RBe(t,e,r,n){if(_8e(t),r=s8e(t.options,r),Oy(e)){const a=e,{ok:s,redirected:o,status:c,statusText:f,type:d,url:m}=a,b=Object.fromEntries(a.headers.entries());n.response={headers:b,ok:s,redirected:o,status:c,statusText:f,type:d,url:m}}e=await IBe(e,t,r);const i=t;if(i.parseTextSync&&typeof e=="string")return i.parseTextSync(e,r,n);if(b8e(t,r))return await x8e(t,e,r,n,lT);if(i.parseText&&typeof e=="string")return await i.parseText(e,r,n);if(i.parse)return await i.parse(e,r,n);throw Mg(!i.parseSync),new Error(`${t.id} loader - no parser found and worker is disabled`)}async function YM(t,e,r,n){let i,a;!Array.isArray(e)&&!FL(e)?(i=[],a=e):(i=e,a=r);const s=Jte(a);let o=t;return typeof t=="string"&&(o=await s(t)),Ny(t)&&(o=await s(t)),Array.isArray(i)?await lT(o,i,a):await lT(o,i,a)}const MBe="4.3.3",DBe=globalThis.loaders?.parseImageNode,ZM=typeof Image<"u",KM=typeof ImageBitmap<"u",OBe=!!DBe,JM=DL?!0:OBe;function NBe(t){switch(t){case"auto":return KM||ZM||JM;case"imagebitmap":return KM;case"image":return ZM;case"data":return JM;default:throw new Error(`@loaders.gl/images: image ${t} not supported in this environment`)}}function LBe(){if(KM)return"imagebitmap";if(ZM)return"image";if(JM)return"data";throw new Error("Install '@loaders.gl/polyfills' to parse images under Node.js")}function FBe(t){const e=zBe(t);if(!e)throw new Error("Not an image");return e}function BBe(t){switch(FBe(t)){case"data":return t;case"image":case"imagebitmap":const e=document.createElement("canvas"),r=e.getContext("2d");if(!r)throw new Error("getImageData");return e.width=t.width,e.height=t.height,r.drawImage(t,0,0),r.getImageData(0,0,t.width,t.height);default:throw new Error("getImageData")}}function zBe(t){return typeof ImageBitmap<"u"&&t instanceof ImageBitmap?"imagebitmap":typeof Image<"u"&&t instanceof Image?"image":t&&typeof t=="object"&&t.data&&t.width&&t.height?"data":null}const jBe=/^data:image\/svg\+xml/,UBe=/\.svg((\?|#).*)?$/;function zL(t){return t&&(jBe.test(t)||UBe.test(t))}function VBe(t,e){if(zL(e)){let n=new TextDecoder().decode(t);try{typeof unescape=="function"&&typeof encodeURIComponent=="function"&&(n=unescape(encodeURIComponent(n)))}catch(a){throw new Error(a.message)}return`data:image/svg+xml;base64,${btoa(n)}`}return Qte(t,e)}function Qte(t,e){if(zL(e))throw new Error("SVG cannot be parsed directly to imagebitmap");return new Blob([new Uint8Array(t)])}async function ere(t,e,r){const n=VBe(t,r),i=self.URL||self.webkitURL,a=typeof n!="string"&&i.createObjectURL(n);try{return await $Be(a||n,e)}finally{a&&i.revokeObjectURL(a)}}async function $Be(t,e){const r=new Image;return r.src=t,e.image&&e.image.decode&&r.decode?(await r.decode(),r):await new Promise((n,i)=>{try{r.onload=()=>n(r),r.onerror=a=>{const s=a instanceof Error?a.message:"error";i(new Error(s))}}catch(a){i(a)}})}const qBe={};let uG=!0;async function HBe(t,e,r){let n;zL(r)?n=await ere(t,e,r):n=Qte(t,r);const i=e&&e.imagebitmap;return await GBe(n,i)}async function GBe(t,e=null){if((WBe(e)||!uG)&&(e=null),e)try{return await createImageBitmap(t,e)}catch(r){console.warn(r),uG=!1}return await createImageBitmap(t)}function WBe(t){for(const e in t||qBe)return!1;return!0}function XBe(t){return!JBe(t,"ftyp",4)||(t[8]&96)===0?null:YBe(t)}function YBe(t){switch(ZBe(t,8,12).replace("\0"," ").trim()){case"avif":case"avis":return{extension:"avif",mimeType:"image/avif"};default:return null}}function ZBe(t,e,r){return String.fromCharCode(...t.slice(e,r))}function KBe(t){return[...t].map(e=>e.charCodeAt(0))}function JBe(t,e,r=0){const n=KBe(e);for(let i=0;i<n.length;++i)if(n[i]!==t[i+r])return!1;return!0}const fd=!1,Eb=!0;function tre(t){const e=o2(t);return eze(e)||nze(e)||tze(e)||rze(e)||QBe(e)}function QBe(t){const e=new Uint8Array(t instanceof DataView?t.buffer:t),r=XBe(e);return r?{mimeType:r.mimeType,width:0,height:0}:null}function eze(t){const e=o2(t);return e.byteLength>=24&&e.getUint32(0,fd)===2303741511?{mimeType:"image/png",width:e.getUint32(16,fd),height:e.getUint32(20,fd)}:null}function tze(t){const e=o2(t);return e.byteLength>=10&&e.getUint32(0,fd)===1195984440?{mimeType:"image/gif",width:e.getUint16(6,Eb),height:e.getUint16(8,Eb)}:null}function rze(t){const e=o2(t);return e.byteLength>=14&&e.getUint16(0,fd)===16973&&e.getUint32(2,Eb)===e.byteLength?{mimeType:"image/bmp",width:e.getUint32(18,Eb),height:e.getUint32(22,Eb)}:null}function nze(t){const e=o2(t);if(!(e.byteLength>=3&&e.getUint16(0,fd)===65496&&e.getUint8(2)===255))return null;const{tableMarkers:n,sofMarkers:i}=ize();let a=2;for(;a+9<e.byteLength;){const s=e.getUint16(a,fd);if(i.has(s))return{mimeType:"image/jpeg",height:e.getUint16(a+5,fd),width:e.getUint16(a+7,fd)};if(!n.has(s))return null;a+=2,a+=e.getUint16(a,fd)}return null}function ize(){const t=new Set([65499,65476,65484,65501,65534]);for(let r=65504;r<65520;++r)t.add(r);return{tableMarkers:t,sofMarkers:new Set([65472,65473,65474,65475,65477,65478,65479,65481,65482,65483,65485,65486,65487,65502])}}function o2(t){if(t instanceof DataView)return t;if(ArrayBuffer.isView(t))return new DataView(t.buffer);if(t instanceof ArrayBuffer)return new DataView(t);throw new Error("toDataView")}async function aze(t,e){const{mimeType:r}=tre(t)||{},n=globalThis.loaders?.parseImageNode;return oT(n),await n(t,r)}async function oze(t,e,r){e=e||{};const i=(e.image||{}).type||"auto",{url:a}=r||{},s=sze(i);let o;switch(s){case"imagebitmap":o=await HBe(t,e,a);break;case"image":o=await ere(t,e,a);break;case"data":o=await aze(t);break;default:oT(!1)}return i==="data"&&(o=BBe(o)),o}function sze(t){switch(t){case"auto":case"data":return LBe();default:return NBe(t),t}}const lze=["png","jpg","jpeg","gif","webp","bmp","ico","svg","avif"],uze=["image/png","image/jpeg","image/gif","image/webp","image/avif","image/bmp","image/vnd.microsoft.icon","image/svg+xml"],cze={image:{type:"auto",decode:!0}},fze={dataType:null,batchType:null,id:"image",module:"images",name:"Images",version:MBe,mimeTypes:uze,extensions:lze,parse:oze,tests:[t=>!!tre(new DataView(t))],options:cze},po=new i2({id:"deck"});let QM={};function hze(t){QM=t}function yc(t,e,r,n){po.level>0&&QM[t]&&QM[t].call(null,e,r,n)}function dze(t){const e=t[0],r=t[t.length-1];return e==="{"&&r==="}"||e==="["&&r==="]"}const pze={dataType:null,batchType:null,id:"JSON",name:"JSON",module:"",version:"",options:{},extensions:["json","geojson"],mimeTypes:["application/json","application/geo+json"],testText:dze,parseTextSync:JSON.parse};function gze(){const t="9.2.6",e=globalThis.deck&&globalThis.deck.VERSION;if(e&&e!==t)throw new Error(`deck.gl - multiple versions detected: ${e} vs ${t}`);return e||(po.log(1,`deck.gl ${t}`)(),globalThis.deck={...globalThis.deck,VERSION:t,version:t,log:po,_registerLoggers:hze},sBe([pze,[fze,{imagebitmap:{premultiplyAlpha:"none"}}]])),t}const mze=gze();function jL(t,e){if(!t)throw new Error(e||"shadertools: assertion failed.")}const BP={number:{type:"number",validate(t,e){return Number.isFinite(t)&&typeof e=="object"&&(e.max===void 0||t<=e.max)&&(e.min===void 0||t>=e.min)}},array:{type:"array",validate(t,e){return Array.isArray(t)||ArrayBuffer.isView(t)}}};function yze(t){const e={};for(const[r,n]of Object.entries(t))e[r]=vze(n);return e}function vze(t){let e=cG(t);if(e!=="object")return{value:t,...BP[e],type:e};if(typeof t=="object")return t?t.type!==void 0?{...t,...BP[t.type],type:t.type}:t.value===void 0?{type:"object",value:t}:(e=cG(t.value),{...t,...BP[e],type:e}):{type:"object",value:null};throw new Error("props")}function cG(t){return Array.isArray(t)||ArrayBuffer.isView(t)?"array":typeof t}const _ze=`#ifdef MODULE_LOGDEPTH
  logdepth_adjustPosition(gl_Position);
#endif
`,bze=`#ifdef MODULE_MATERIAL
  fragColor = material_filterColor(fragColor);
#endif

#ifdef MODULE_LIGHTING
  fragColor = lighting_filterColor(fragColor);
#endif

#ifdef MODULE_FOG
  fragColor = fog_filterColor(fragColor);
#endif

#ifdef MODULE_PICKING
  fragColor = picking_filterHighlightColor(fragColor);
  fragColor = picking_filterPickingColor(fragColor);
#endif

#ifdef MODULE_LOGDEPTH
  logdepth_setFragDepth();
#endif
`,xze={vertex:_ze,fragment:bze},fG=/void\s+main\s*\([^)]*\)\s*\{\n?/,hG=/}\n?[^{}]*$/,zP=[],kS="__LUMA_INJECT_DECLARATIONS__";function wze(t){const e={vertex:{},fragment:{}};for(const r in t){let n=t[r];const i=Sze(r);typeof n=="string"&&(n={order:0,injection:n}),e[i][r]=n}return e}function Sze(t){const e=t.slice(0,2);switch(e){case"vs":return"vertex";case"fs":return"fragment";default:throw new Error(e)}}function uT(t,e,r,n=!1){const i=e==="vertex";for(const a in r){const s=r[a];s.sort((c,f)=>c.order-f.order),zP.length=s.length;for(let c=0,f=s.length;c<f;++c)zP[c]=s[c].injection;const o=`${zP.join(`
`)}
`;switch(a){case"vs:#decl":i&&(t=t.replace(kS,o));break;case"vs:#main-start":i&&(t=t.replace(fG,c=>c+o));break;case"vs:#main-end":i&&(t=t.replace(hG,c=>o+c));break;case"fs:#decl":i||(t=t.replace(kS,o));break;case"fs:#main-start":i||(t=t.replace(fG,c=>c+o));break;case"fs:#main-end":i||(t=t.replace(hG,c=>o+c));break;default:t=t.replace(a,c=>c+o)}}return t=t.replace(kS,""),n&&(t=t.replace(/\}\s*$/,a=>a+xze[e])),t}function cT(t){t.map(e=>Eze(e))}function Eze(t){if(t.instance)return;cT(t.dependencies||[]);const{propTypes:e={},deprecations:r=[],inject:n={}}=t,i={normalizedInjections:wze(n),parsedDeprecations:Tze(r)};e&&(i.propValidators=yze(e)),t.instance=i;let a={};e&&(a=Object.entries(e).reduce((s,[o,c])=>{const f=c?.value;return f&&(s[o]=f),s},{})),t.defaultUniforms={...t.defaultUniforms,...a}}function rre(t,e,r){t.deprecations?.forEach(n=>{n.regex?.test(e)&&(n.deprecated?r.deprecated(n.old,n.new)():r.removed(n.old,n.new)())})}function Tze(t){return t.forEach(e=>{switch(e.type){case"function":e.regex=new RegExp(`\\b${e.old}\\(`);break;default:e.regex=new RegExp(`${e.type} ${e.old};`)}}),t}function UL(t){cT(t);const e={},r={};nre({modules:t,level:0,moduleMap:e,moduleDepth:r});const n=Object.keys(r).sort((i,a)=>r[a]-r[i]).map(i=>e[i]);return cT(n),n}function nre(t){const{modules:e,level:r,moduleMap:n,moduleDepth:i}=t;if(r>=5)throw new Error("Possible loop in shader dependency graph");for(const a of e)n[a.name]=a,(i[a.name]===void 0||i[a.name]<r)&&(i[a.name]=r);for(const a of e)a.dependencies&&nre({modules:a.dependencies,level:r+1,moduleMap:n,moduleDepth:i})}function Cze(t){switch(t?.gpu.toLowerCase()){case"apple":return`#define APPLE_GPU
// Apple optimizes away the calculation necessary for emulated fp64
#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1
#define LUMA_FP32_TAN_PRECISION_WORKAROUND 1
// Intel GPU doesn't have full 32 bits precision in same cases, causes overflow
#define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1
`;case"nvidia":return`#define NVIDIA_GPU
// Nvidia optimizes away the calculation necessary for emulated fp64
#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1
`;case"intel":return`#define INTEL_GPU
// Intel optimizes away the calculation necessary for emulated fp64
#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1
// Intel's built-in 'tan' function doesn't have acceptable precision
#define LUMA_FP32_TAN_PRECISION_WORKAROUND 1
// Intel GPU doesn't have full 32 bits precision in same cases, causes overflow
#define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1
`;case"amd":return`#define AMD_GPU
`;default:return`#define DEFAULT_GPU
// Prevent driver from optimizing away the calculation necessary for emulated fp64
#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1
// Headless Chrome's software shader 'tan' function doesn't have acceptable precision
#define LUMA_FP32_TAN_PRECISION_WORKAROUND 1
// If the GPU doesn't have full 32 bits precision, will causes overflow
#define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1
`}}function Aze(t,e){if(Number(t.match(/^#version[ \t]+(\d+)/m)?.[1]||100)!==300)throw new Error("luma.gl v9 only supports GLSL 3.00 shader sources");switch(e){case"vertex":return t=dG(t,Ize),t;case"fragment":return t=dG(t,Pze),t;default:throw new Error(e)}}const ire=[[/^(#version[ \t]+(100|300[ \t]+es))?[ \t]*\n/,`#version 300 es
`],[/\btexture(2D|2DProj|Cube)Lod(EXT)?\(/g,"textureLod("],[/\btexture(2D|2DProj|Cube)(EXT)?\(/g,"texture("]],Ize=[...ire,[eD("attribute"),"in $1"],[eD("varying"),"out $1"]],Pze=[...ire,[eD("varying"),"in $1"]];function dG(t,e){for(const[r,n]of e)t=t.replace(r,n);return t}function eD(t){return new RegExp(`\\b${t}[ \\t]+(\\w+[ \\t]+\\w+(\\[\\w+\\])?;)`,"g")}function are(t,e){let r="";for(const n in t){const i=t[n];if(r+=`void ${i.signature} {
`,i.header&&(r+=`  ${i.header}`),e[n]){const a=e[n];a.sort((s,o)=>s.order-o.order);for(const s of a)r+=`  ${s.injection}
`}i.footer&&(r+=`  ${i.footer}`),r+=`}
`}return r}function ore(t){const e={vertex:{},fragment:{}};for(const r of t){let n,i;typeof r!="string"?(n=r,i=n.hook):(n={},i=r),i=i.trim();const[a,s]=i.split(":"),o=i.replace(/\(.+/,""),c=Object.assign(n,{signature:s});switch(a){case"vs":e.vertex[o]=c;break;case"fs":e.fragment[o]=c;break;default:throw new Error(a)}}return e}function kze(t,e){return{name:Rze(t,e),language:"glsl",version:Mze(t)}}function Rze(t,e="unnamed"){const n=/#define[^\S\r\n]*SHADER_NAME[^\S\r\n]*([A-Za-z0-9_-]+)\s*/.exec(t);return n?n[1]:e}function Mze(t){let e=100;const r=t.match(/[^\s]+/g);if(r&&r.length>=2&&r[0]==="#version"){const n=parseInt(r[1],10);Number.isFinite(n)&&(e=n)}if(e!==100&&e!==300)throw new Error(`Invalid GLSL version ${e}`);return e}const sre=`

${kS}
`,Dze=`precision highp float;
`;function Oze(t){const e=UL(t.modules||[]);return{source:Lze(t.platformInfo,{...t,source:t.source,stage:"vertex",modules:e}),getUniforms:lre(e)}}function Nze(t){const{vs:e,fs:r}=t,n=UL(t.modules||[]);return{vs:pG(t.platformInfo,{...t,source:e,stage:"vertex",modules:n}),fs:pG(t.platformInfo,{...t,source:r,stage:"fragment",modules:n}),getUniforms:lre(n)}}function Lze(t,e){const{source:r,stage:n,modules:i,hookFunctions:a=[],inject:s={},log:o}=e;jL(typeof r=="string","shader source must be a string");const c=r;let f="";const d=ore(a),m={},b={},x={};for(const T in s){const A=typeof s[T]=="string"?{injection:s[T],order:0}:s[T],M=/^(v|f)s:(#)?([\w-]+)$/.exec(T);if(M){const F=M[2],N=M[3];F?N==="decl"?b[T]=[A]:x[T]=[A]:m[T]=[A]}else x[T]=[A]}const E=i;for(const T of E){o&&rre(T,c,o);const A=ure(T,"wgsl");f+=A;const M=T.injections?.[n]||{};for(const F in M){const N=/^(v|f)s:#([\w-]+)$/.exec(F);if(N){const U=N[2]==="decl"?b:x;U[F]=U[F]||[],U[F].push(M[F])}else m[F]=m[F]||[],m[F].push(M[F])}}return f+=sre,f=uT(f,n,b),f+=are(d[n],m),f+=c,f=uT(f,n,x),f}function pG(t,e){const{source:r,stage:n,language:i="glsl",modules:a,defines:s={},hookFunctions:o=[],inject:c={},prologue:f=!0,log:d}=e;jL(typeof r=="string","shader source must be a string");const m=i==="glsl"?kze(r).version:-1,b=t.shaderLanguageVersion,x=m===100?"#version 100":"#version 300 es",T=r.split(`
`).slice(1).join(`
`),A={};a.forEach(j=>{Object.assign(A,j.defines)}),Object.assign(A,s);let M="";switch(i){case"wgsl":break;case"glsl":M=f?`${x}

// ----- PROLOGUE -------------------------
${`#define SHADER_TYPE_${n.toUpperCase()}`}

${Cze(t)}
${n==="fragment"?Dze:""}

// ----- APPLICATION DEFINES -------------------------

${Fze(A)}

`:`${x}
`;break}const F=ore(o),N={},O={},U={};for(const j in c){const H=typeof c[j]=="string"?{injection:c[j],order:0}:c[j],W=/^(v|f)s:(#)?([\w-]+)$/.exec(j);if(W){const X=W[2],oe=W[3];X?oe==="decl"?O[j]=[H]:U[j]=[H]:N[j]=[H]}else U[j]=[H]}for(const j of a){d&&rre(j,T,d);const H=ure(j,n);M+=H;const W=j.instance?.normalizedInjections[n]||{};for(const X in W){const oe=/^(v|f)s:#([\w-]+)$/.exec(X);if(oe){const G=oe[2]==="decl"?O:U;G[X]=G[X]||[],G[X].push(W[X])}else N[X]=N[X]||[],N[X].push(W[X])}}return M+="// ----- MAIN SHADER SOURCE -------------------------",M+=sre,M=uT(M,n,O),M+=are(F[n],N),M+=T,M=uT(M,n,U),i==="glsl"&&m!==b&&(M=Aze(M,n)),M.trim()}function lre(t){return function(r){const n={};for(const i of t){const a=i.getUniforms?.(r,n);Object.assign(n,a)}return n}}function Fze(t={}){let e="";for(const r in t){const n=t[r];(n||Number.isFinite(n))&&(e+=`#define ${r.toUpperCase()} ${t[r]}
`)}return e}function ure(t,e){let r;switch(e){case"vertex":r=t.vs||"";break;case"fragment":r=t.fs||"";break;case"wgsl":r=t.source||"";break;default:jL(!1)}if(!t.name)throw new Error("Shader module must have a name");const n=t.name.toUpperCase().replace(/[^0-9a-z]/gi,"_");let i=`// ----- MODULE ${t.name} ---------------

`;return e!=="wgsl"&&(i+=`#define MODULE_${n}
`),i+=`${r}
`,i}const Bze=/^\s*\#\s*ifdef\s*([a-zA-Z_]+)\s*$/,zze=/^\s*\#\s*endif\s*$/;function jze(t,e){const r=t.split(`
`),n=[];let i=!0,a=null;for(const s of r){const o=s.match(Bze),c=s.match(zze);o?(a=o[1],i=!!e?.defines?.[a]):c?i=!0:i&&n.push(s)}return n.join(`
`)}class Mm{static defaultShaderAssembler;_hookFunctions=[];_defaultModules=[];static getDefaultShaderAssembler(){return Mm.defaultShaderAssembler=Mm.defaultShaderAssembler||new Mm,Mm.defaultShaderAssembler}addDefaultModule(e){this._defaultModules.find(r=>r.name===(typeof e=="string"?e:e.name))||this._defaultModules.push(e)}removeDefaultModule(e){const r=typeof e=="string"?e:e.name;this._defaultModules=this._defaultModules.filter(n=>n.name!==r)}addShaderHook(e,r){r&&(e=Object.assign(r,{hook:e})),this._hookFunctions.push(e)}assembleWGSLShader(e){const r=this._getModuleList(e.modules),n=this._hookFunctions,{source:i,getUniforms:a}=Oze({...e,source:e.source,modules:r,hookFunctions:n});return{source:e.platformInfo.shaderLanguage==="wgsl"?jze(i):i,getUniforms:a,modules:r}}assembleGLSLShaderPair(e){const r=this._getModuleList(e.modules),n=this._hookFunctions;return{...Nze({...e,vs:e.vs,fs:e.fs,modules:r,hookFunctions:n}),modules:r}}_getModuleList(e=[]){const r=new Array(this._defaultModules.length+e.length),n={};let i=0;for(let a=0,s=this._defaultModules.length;a<s;++a){const o=this._defaultModules[a],c=o.name;r[i++]=o,n[c]=!0}for(let a=0,s=e.length;a<s;++a){const o=e[a],c=o.name;n[c]||(r[i++]=o,n[c]=!0)}return r.length=i,cT(r),r}}const Uze=`out vec4 transform_output;
void main() {
  transform_output = vec4(0);
}`,Vze=`#version 300 es
${Uze}`;function $ze(t){const{input:e,inputChannels:r,output:n}={};if(!e)return Vze;if(!r)throw new Error("inputChannels");const i=qze(r),a=Hze(e,r);return`#version 300 es
in ${i} ${e};
out vec4 ${n};
void main() {
  ${n} = ${a};
}`}function qze(t){switch(t){case 1:return"float";case 2:return"vec2";case 3:return"vec3";case 4:return"vec4";default:throw new Error(`invalid channels: ${t}`)}}function Hze(t,e){switch(e){case 1:return`vec4(${t}, 0.0, 0.0, 1.0)`;case 2:return`vec4(${t}, 0.0, 1.0)`;case 3:return`vec4(${t}, 1.0)`;case 4:return t;default:throw new Error(`invalid channels: ${e}`)}}class Gze{stats=new Map;getStats(e){return this.get(e)}get(e){return this.stats.has(e)||this.stats.set(e,new W3({id:e})),this.stats.get(e)}}const cre=new Gze,rn=new i2({id:"luma.gl"}),jP={};function Y3(t="id"){jP[t]=jP[t]||1;const e=jP[t]++;return`${t}-${e}`}let So=class{static defaultProps={id:"undefined",handle:void 0,userData:void 0};toString(){return`${this[Symbol.toStringTag]||this.constructor.name}:"${this.id}"`}id;props;userData={};_device;destroyed=!1;allocatedBytes=0;_attachedResources=new Set;constructor(e,r,n){if(!e)throw new Error("no device");this._device=e,this.props=Wze(r,n);const i=this.props.id!=="undefined"?this.props.id:Y3(this[Symbol.toStringTag]);this.props.id=i,this.id=i,this.userData=this.props.userData||{},this.addStats()}destroy(){this.destroyResource()}delete(){return this.destroy(),this}getProps(){return this.props}attachResource(e){this._attachedResources.add(e)}detachResource(e){this._attachedResources.delete(e)}destroyAttachedResource(e){this._attachedResources.delete(e)&&e.destroy()}destroyAttachedResources(){for(const e of Object.values(this._attachedResources))e.destroy();this._attachedResources=new Set}destroyResource(){this.destroyAttachedResources(),this.removeStats(),this.destroyed=!0}removeStats(){const e=this._device.statsManager.getStats("Resource Counts"),r=this[Symbol.toStringTag];e.get(`${r}s Active`).decrementCount()}trackAllocatedMemory(e,r=this[Symbol.toStringTag]){const n=this._device.statsManager.getStats("Resource Counts");n.get("GPU Memory").addCount(e),n.get(`${r} Memory`).addCount(e),this.allocatedBytes=e}trackDeallocatedMemory(e=this[Symbol.toStringTag]){const r=this._device.statsManager.getStats("Resource Counts");r.get("GPU Memory").subtractCount(this.allocatedBytes),r.get(`${e} Memory`).subtractCount(this.allocatedBytes),this.allocatedBytes=0}addStats(){const e=this._device.statsManager.getStats("Resource Counts"),r=this[Symbol.toStringTag];e.get("Resources Created").incrementCount(),e.get(`${r}s Created`).incrementCount(),e.get(`${r}s Active`).incrementCount()}};function Wze(t,e){const r={...e};for(const n in t)t[n]!==void 0&&(r[n]=t[n]);return r}class jo extends So{static INDEX=16;static VERTEX=32;static UNIFORM=64;static STORAGE=128;static INDIRECT=256;static QUERY_RESOLVE=512;static MAP_READ=1;static MAP_WRITE=2;static COPY_SRC=4;static COPY_DST=8;get[Symbol.toStringTag](){return"Buffer"}usage;indexType;updateTimestamp;constructor(e,r){const n={...r};(r.usage||0)&jo.INDEX&&!r.indexType&&(r.data instanceof Uint32Array?n.indexType="uint32":r.data instanceof Uint16Array?n.indexType="uint16":r.data instanceof Uint8Array&&(n.indexType="uint8")),delete n.data,super(e,n,jo.defaultProps),this.usage=n.usage||0,this.indexType=n.indexType,this.updateTimestamp=e.incrementTimestamp()}clone(e){return this.device.createBuffer({...this.props,...e})}static DEBUG_DATA_MAX_LENGTH=32;debugData=new ArrayBuffer(0);_setDebugData(e,r,n){const i=ArrayBuffer.isView(e)?e.buffer:e,a=Math.min(e?e.byteLength:n,jo.DEBUG_DATA_MAX_LENGTH);i===null?this.debugData=new ArrayBuffer(a):r===0&&n===i.byteLength?this.debugData=i.slice(0,a):this.debugData=i.slice(r,r+a)}static defaultProps={...So.defaultProps,usage:0,byteLength:0,byteOffset:0,data:null,indexType:"uint16",onMapped:void 0}}function fre(t){const[e,r,n]=qL[t],i=t.includes("norm"),a=!i&&!t.startsWith("float"),s=t.startsWith("s");return{signedType:e,primitiveType:r,byteLength:n,normalized:i,integer:a,signed:s}}function Xze(t){const e=t;switch(e){case"uint8":return"unorm8";case"sint8":return"snorm8";case"uint16":return"unorm16";case"sint16":return"snorm16";default:return e}}function Yze(t,e){switch(e){case 1:return t;case 2:return t+t%2;default:return t+(4-t%4)%4}}function VL(t){const e=ArrayBuffer.isView(t)?t.constructor:t;if(e===Uint8ClampedArray)return"uint8";const r=Object.values(qL).find(n=>e===n[4]);if(!r)throw new Error(e.name);return r[0]}function $L(t){const[,,,,e]=qL[t];return e}const qL={uint8:["uint8","u32",1,!1,Uint8Array],sint8:["sint8","i32",1,!1,Int8Array],unorm8:["uint8","f32",1,!0,Uint8Array],snorm8:["sint8","f32",1,!0,Int8Array],uint16:["uint16","u32",2,!1,Uint16Array],sint16:["sint16","i32",2,!1,Int16Array],unorm16:["uint16","u32",2,!0,Uint16Array],snorm16:["sint16","i32",2,!0,Int16Array],float16:["float16","f16",2,!1,Uint16Array],float32:["float32","f32",4,!1,Float32Array],uint32:["uint32","u32",4,!1,Uint32Array],sint32:["sint32","i32",4,!1,Int32Array]};function HL(t){let e;t.endsWith("-webgl")&&(t.replace("-webgl",""),e=!0);const[r,n]=t.split("x"),i=r,a=n?parseInt(n):1,s=fre(i),o={type:i,components:a,byteLength:s.byteLength*a,integer:s.integer,signed:s.signed,normalized:s.normalized};return e&&(o.webglOnly=!0),o}function Zze(t,e,r){const n=r?Xze(t):t;switch(n){case"unorm8":return e===1?"unorm8":e===3?"unorm8x3-webgl":`${n}x${e}`;case"snorm8":case"uint8":case"sint8":case"uint16":case"sint16":case"unorm16":case"snorm16":case"float16":if(e===1||e===3)throw new Error(`size: ${e}`);return`${n}x${e}`;default:return e===1?n:`${n}x${e}`}}function Kze(t,e,r){if(!e||e>4)throw new Error(`size ${e}`);const n=e,i=VL(t);return Zze(i,n,r)}function Jze(t){let e;switch(t.primitiveType){case"f32":e="float32";break;case"i32":e="sint32";break;case"u32":e="uint32";break;case"f16":return t.components<=2?"float16x2":"float16x4"}return t.components===1?e:`${e}x${t.components}`}const Xu="texture-compression-bc",bo="texture-compression-astc",nd="texture-compression-etc2",Qze="texture-compression-etc1-webgl",qw="texture-compression-pvrtc-webgl",UP="texture-compression-atc-webgl",Hw="float32-renderable-webgl",VP="float16-renderable-webgl",e9e="rgb9e5ufloat-renderable-webgl",$P="snorm8-renderable-webgl",T1="norm16-renderable-webgl",qP="snorm16-renderable-webgl",Gw="float32-filterable",gG="float16-filterable-webgl";function hre(t){const e=n9e[t];if(!e)throw new Error(`Unsupported texture format ${t}`);return e}const t9e={r8unorm:{},rg8unorm:{},"rgb8unorm-webgl":{},rgba8unorm:{},"rgba8unorm-srgb":{},r8snorm:{render:$P},rg8snorm:{render:$P},"rgb8snorm-webgl":{},rgba8snorm:{render:$P},r8uint:{},rg8uint:{},rgba8uint:{},r8sint:{},rg8sint:{},rgba8sint:{},bgra8unorm:{},"bgra8unorm-srgb":{},r16unorm:{f:T1},rg16unorm:{render:T1},"rgb16unorm-webgl":{f:T1},rgba16unorm:{render:T1},r16snorm:{f:qP},rg16snorm:{render:qP},"rgb16snorm-webgl":{f:T1},rgba16snorm:{render:qP},r16uint:{},rg16uint:{},rgba16uint:{},r16sint:{},rg16sint:{},rgba16sint:{},r16float:{render:VP,filter:"float16-filterable-webgl"},rg16float:{render:VP,filter:gG},rgba16float:{render:VP,filter:gG},r32uint:{},rg32uint:{},rgba32uint:{},r32sint:{},rg32sint:{},rgba32sint:{},r32float:{render:Hw,filter:Gw},rg32float:{render:!1,filter:Gw},"rgb32float-webgl":{render:Hw,filter:Gw},rgba32float:{render:Hw,filter:Gw},"rgba4unorm-webgl":{channels:"rgba",bitsPerChannel:[4,4,4,4],packed:!0},"rgb565unorm-webgl":{channels:"rgb",bitsPerChannel:[5,6,5,0],packed:!0},"rgb5a1unorm-webgl":{channels:"rgba",bitsPerChannel:[5,5,5,1],packed:!0},rgb9e5ufloat:{channels:"rgb",packed:!0,render:e9e},rg11b10ufloat:{channels:"rgb",bitsPerChannel:[11,11,10,0],packed:!0,p:1,render:Hw},rgb10a2unorm:{channels:"rgba",bitsPerChannel:[10,10,10,2],packed:!0,p:1},rgb10a2uint:{channels:"rgba",bitsPerChannel:[10,10,10,2],packed:!0,p:1},stencil8:{attachment:"stencil",bitsPerChannel:[8,0,0,0],dataType:"uint8"},depth16unorm:{attachment:"depth",bitsPerChannel:[16,0,0,0],dataType:"uint16"},depth24plus:{attachment:"depth",bitsPerChannel:[24,0,0,0],dataType:"uint32"},depth32float:{attachment:"depth",bitsPerChannel:[32,0,0,0],dataType:"float32"},"depth24plus-stencil8":{attachment:"depth-stencil",bitsPerChannel:[24,8,0,0],packed:!0},"depth32float-stencil8":{attachment:"depth-stencil",bitsPerChannel:[32,8,0,0],packed:!0}},r9e={"bc1-rgb-unorm-webgl":{f:Xu},"bc1-rgb-unorm-srgb-webgl":{f:Xu},"bc1-rgba-unorm":{f:Xu},"bc1-rgba-unorm-srgb":{f:Xu},"bc2-rgba-unorm":{f:Xu},"bc2-rgba-unorm-srgb":{f:Xu},"bc3-rgba-unorm":{f:Xu},"bc3-rgba-unorm-srgb":{f:Xu},"bc4-r-unorm":{f:Xu},"bc4-r-snorm":{f:Xu},"bc5-rg-unorm":{f:Xu},"bc5-rg-snorm":{f:Xu},"bc6h-rgb-ufloat":{f:Xu},"bc6h-rgb-float":{f:Xu},"bc7-rgba-unorm":{f:Xu},"bc7-rgba-unorm-srgb":{f:Xu},"etc2-rgb8unorm":{f:nd},"etc2-rgb8unorm-srgb":{f:nd},"etc2-rgb8a1unorm":{f:nd},"etc2-rgb8a1unorm-srgb":{f:nd},"etc2-rgba8unorm":{f:nd},"etc2-rgba8unorm-srgb":{f:nd},"eac-r11unorm":{f:nd},"eac-r11snorm":{f:nd},"eac-rg11unorm":{f:nd},"eac-rg11snorm":{f:nd},"astc-4x4-unorm":{f:bo},"astc-4x4-unorm-srgb":{f:bo},"astc-5x4-unorm":{f:bo},"astc-5x4-unorm-srgb":{f:bo},"astc-5x5-unorm":{f:bo},"astc-5x5-unorm-srgb":{f:bo},"astc-6x5-unorm":{f:bo},"astc-6x5-unorm-srgb":{f:bo},"astc-6x6-unorm":{f:bo},"astc-6x6-unorm-srgb":{f:bo},"astc-8x5-unorm":{f:bo},"astc-8x5-unorm-srgb":{f:bo},"astc-8x6-unorm":{f:bo},"astc-8x6-unorm-srgb":{f:bo},"astc-8x8-unorm":{f:bo},"astc-8x8-unorm-srgb":{f:bo},"astc-10x5-unorm":{f:bo},"astc-10x5-unorm-srgb":{f:bo},"astc-10x6-unorm":{f:bo},"astc-10x6-unorm-srgb":{f:bo},"astc-10x8-unorm":{f:bo},"astc-10x8-unorm-srgb":{f:bo},"astc-10x10-unorm":{f:bo},"astc-10x10-unorm-srgb":{f:bo},"astc-12x10-unorm":{f:bo},"astc-12x10-unorm-srgb":{f:bo},"astc-12x12-unorm":{f:bo},"astc-12x12-unorm-srgb":{f:bo},"pvrtc-rgb4unorm-webgl":{f:qw},"pvrtc-rgba4unorm-webgl":{f:qw},"pvrtc-rbg2unorm-webgl":{f:qw},"pvrtc-rgba2unorm-webgl":{f:qw},"etc1-rbg-unorm-webgl":{f:Qze},"atc-rgb-unorm-webgl":{f:UP},"atc-rgba-unorm-webgl":{f:UP},"atc-rgbai-unorm-webgl":{f:UP}},n9e={...t9e,...r9e},i9e=["bc1","bc2","bc3","bc4","bc5","bc6","bc7","etc1","etc2","eac","atc","astc","pvrtc"],a9e=/^(r|rg|rgb|rgba|bgra)([0-9]*)([a-z]*)(-srgb)?(-webgl)?$/;class o9e{getInfo(e){return mG(e)}isColor(e){return e.startsWith("rgba")||e.startsWith("bgra")||e.startsWith("rgb")}isDepthStencil(e){return e.startsWith("depth")||e.startsWith("stencil")}isCompressed(e){return i9e.some(r=>e.startsWith(r))}getCapabilities(e){const r=hre(e),n={format:e,create:r.f??!0,render:r.render??!0,filter:r.filter??!0,blend:r.blend??!0,store:r.store??!0},i=mG(e),a=e.startsWith("depth")||e.startsWith("stencil"),s=i?.signed,o=i?.integer,c=i?.webgl;return n.render&&=!s,n.filter&&=!a&&!s&&!o&&!c,n}}const D0=new o9e;function mG(t){let e=s9e(t);if(D0.isCompressed(t)){e.channels="rgb",e.components=3,e.bytesPerPixel=1,e.srgb=!1,e.compressed=!0;const n=l9e(t);n&&(e.blockWidth=n.blockWidth,e.blockHeight=n.blockHeight)}const r=a9e.exec(t);if(r){const[,n,i,a,s,o]=r,c=`${a}${i}`,f=fre(c),d=f.byteLength*8,m=n.length,b=[d,m>=2?d:0,m>=3?d:0,m>=4?d:0];e={format:t,attachment:e.attachment,dataType:f.signedType,components:m,channels:n,integer:f.integer,signed:f.signed,normalized:f.normalized,bitsPerChannel:b,bytesPerPixel:f.byteLength*n.length,packed:e.packed,srgb:e.srgb},o==="-webgl"&&(e.webgl=!0),s==="-srgb"&&(e.srgb=!0)}return t.endsWith("-webgl")&&(e.webgl=!0),t.endsWith("-srgb")&&(e.srgb=!0),e}function s9e(t){const e=hre(t),r=e.bytesPerPixel||1,n=e.bitsPerChannel||[8,8,8,8];return delete e.bitsPerChannel,delete e.bytesPerPixel,delete e.f,delete e.render,delete e.filter,delete e.blend,delete e.store,{...e,format:t,attachment:e.attachment||"color",channels:e.channels||"r",components:e.components||e.channels?.length||1,bytesPerPixel:r,bitsPerChannel:n,dataType:e.dataType||"uint8",srgb:e.srgb??!1,packed:e.packed??!1,webgl:e.webgl??!1,integer:e.integer??!1,signed:e.signed??!1,normalized:e.normalized??!1,compressed:e.compressed??!1}}function l9e(t){const r=/.*-(\d+)x(\d+)-.*/.exec(t);if(r){const[,n,i]=r;return{blockWidth:Number(n),blockHeight:Number(i)}}return null}function u9e(t){return typeof ImageData<"u"&&t instanceof ImageData||typeof ImageBitmap<"u"&&t instanceof ImageBitmap||typeof HTMLImageElement<"u"&&t instanceof HTMLImageElement||typeof HTMLVideoElement<"u"&&t instanceof HTMLVideoElement||typeof VideoFrame<"u"&&t instanceof VideoFrame||typeof HTMLCanvasElement<"u"&&t instanceof HTMLCanvasElement||typeof OffscreenCanvas<"u"&&t instanceof OffscreenCanvas}function c9e(t){if(typeof ImageData<"u"&&t instanceof ImageData||typeof ImageBitmap<"u"&&t instanceof ImageBitmap||typeof HTMLCanvasElement<"u"&&t instanceof HTMLCanvasElement||typeof OffscreenCanvas<"u"&&t instanceof OffscreenCanvas)return{width:t.width,height:t.height};if(typeof HTMLImageElement<"u"&&t instanceof HTMLImageElement)return{width:t.naturalWidth,height:t.naturalHeight};if(typeof HTMLVideoElement<"u"&&t instanceof HTMLVideoElement)return{width:t.videoWidth,height:t.videoHeight};if(typeof VideoFrame<"u"&&t instanceof VideoFrame)return{width:t.displayWidth,height:t.displayHeight};throw new Error("Unknown image type")}class f9e{}class h9e{features;disabledFeatures;constructor(e=[],r){this.features=new Set(e),this.disabledFeatures=r||{}}*[Symbol.iterator](){yield*this.features}has(e){return!this.disabledFeatures?.[e]&&this.features.has(e)}}class hy{static defaultProps={id:null,powerPreference:"high-performance",failIfMajorPerformanceCaveat:!1,createCanvasContext:void 0,webgl:{},onError:(e,r)=>{},onResize:(e,r)=>{const[n,i]=e.getDevicePixelSize();rn.log(1,`${e} resized => ${n}x${i}px`)()},onPositionChange:(e,r)=>{const[n,i]=e.getPosition();rn.log(1,`${e} repositioned => ${n},${i}`)()},onVisibilityChange:e=>rn.log(1,`${e} Visibility changed ${e.isVisible}`)(),onDevicePixelRatioChange:(e,r)=>rn.log(1,`${e} DPR changed ${r.oldRatio} => ${e.devicePixelRatio}`)(),debug:rn.get("debug")||void 0,debugShaders:rn.get("debug-shaders")||void 0,debugFramebuffers:!!rn.get("debug-framebuffers"),debugFactories:!!rn.get("debug-factories"),debugWebGL:!!rn.get("debug-webgl"),debugSpectorJS:void 0,debugSpectorJSUrl:void 0,_reuseDevices:!1,_requestMaxLimits:!0,_cacheShaders:!1,_cachePipelines:!1,_cacheDestroyPolicy:"unused",_initializeFeatures:!0,_disabledFeatures:{"compilation-status-async-webgl":!0},_handle:void 0};get[Symbol.toStringTag](){return"Device"}toString(){return`Device(${this.id})`}id;props;userData={};statsManager=cre;timestamp=0;_reused=!1;_lumaData={};_textureCaps={};constructor(e){this.props={...hy.defaultProps,...e},this.id=this.props.id||Y3(this[Symbol.toStringTag].toLowerCase())}getVertexFormatInfo(e){return HL(e)}isVertexFormatSupported(e){return!0}getTextureFormatInfo(e){return D0.getInfo(e)}getTextureFormatCapabilities(e){let r=this._textureCaps[e];if(!r){const n=this._getDeviceTextureFormatCapabilities(e);r=this._getDeviceSpecificTextureFormatCapabilities(n),this._textureCaps[e]=r}return r}getMipLevelCount(e,r,n=1){const i=Math.max(e,r,n);return 1+Math.floor(Math.log2(i))}isExternalImage(e){return u9e(e)}getExternalImageSize(e){return c9e(e)}isTextureFormatSupported(e){return this.getTextureFormatCapabilities(e).create}isTextureFormatFilterable(e){return this.getTextureFormatCapabilities(e).filter}isTextureFormatRenderable(e){return this.getTextureFormatCapabilities(e).render}isTextureFormatCompressed(e){return D0.isCompressed(e)}pushDebugGroup(e){this.commandEncoder.pushDebugGroup(e)}popDebugGroup(){this.commandEncoder?.popDebugGroup()}insertDebugMarker(e){this.commandEncoder?.insertDebugMarker(e)}loseDevice(){return!1}incrementTimestamp(){return this.timestamp++}reportError(e,r,...n){return this.props.onError(e,r)?()=>{}:rn.error(e.message,r,...n)}debug(){if(this.props.debug)debugger;else rn.once(0,`'Type luma.log.set({debug: true}) in console to enable debug breakpoints',
or create a device with the 'debug: true' prop.`)()}getDefaultCanvasContext(){if(!this.canvasContext)throw new Error("Device has no default CanvasContext. See props.createCanvasContext");return this.canvasContext}beginRenderPass(e){return this.commandEncoder.beginRenderPass(e)}beginComputePass(e){return this.commandEncoder.beginComputePass(e)}getCanvasContext(){return this.getDefaultCanvasContext()}readPixelsToArrayWebGL(e,r){throw new Error("not implemented")}readPixelsToBufferWebGL(e,r){throw new Error("not implemented")}setParametersWebGL(e){throw new Error("not implemented")}getParametersWebGL(e){throw new Error("not implemented")}withParametersWebGL(e,r){throw new Error("not implemented")}clearWebGL(e){throw new Error("not implemented")}resetWebGL(){throw new Error("not implemented")}static _getCanvasContextProps(e){return e.createCanvasContext===!0?{}:e.createCanvasContext}_getDeviceTextureFormatCapabilities(e){const r=D0.getCapabilities(e),n=a=>(typeof a=="string"?this.features.has(a):a)??!0,i=n(r.create);return{format:e,create:i,render:i&&n(r.render),filter:i&&n(r.filter),blend:i&&n(r.blend),store:i&&n(r.store)}}_normalizeBufferProps(e){(e instanceof ArrayBuffer||ArrayBuffer.isView(e))&&(e={data:e});const r={...e};if((e.usage||0)&jo.INDEX&&(e.indexType||(e.data instanceof Uint32Array?r.indexType="uint32":e.data instanceof Uint16Array?r.indexType="uint16":e.data instanceof Uint8Array&&(r.data=new Uint16Array(e.data),r.indexType="uint16")),!r.indexType))throw new Error("indices buffer content must be of type uint16 or uint32");return r}}const d9e="set luma.log.level=1 (or higher) to trace rendering",yG="No matching device found. Ensure `@luma.gl/webgl` and/or `@luma.gl/webgpu` modules are imported.";class fT{static defaultProps={...hy.defaultProps,type:"best-available",adapters:void 0,waitForPageLoad:!0};stats=cre;log=rn;VERSION="9.2.6";spector;preregisteredAdapters=new Map;constructor(){if(globalThis.luma){if(globalThis.luma.VERSION!==this.VERSION)throw rn.error(`Found luma.gl ${globalThis.luma.VERSION} while initialzing ${this.VERSION}`)(),rn.error("'yarn why @luma.gl/core' can help identify the source of the conflict")(),new Error("luma.gl - multiple versions detected: see console log");rn.error("This version of luma.gl has already been initialized")()}rn.log(1,`${this.VERSION} - ${d9e}`)(),globalThis.luma=this}async createDevice(e={}){const r={...fT.defaultProps,...e},n=this.selectAdapter(r.type,r.adapters);if(!n)throw new Error(yG);return r.waitForPageLoad&&await n.pageLoaded,await n.create(r)}async attachDevice(e,r){const n=this._getTypeFromHandle(e,r.adapters),i=n&&this.selectAdapter(n,r.adapters);if(!i)throw new Error(yG);return await i?.attach?.(e,r)}registerAdapters(e){for(const r of e)this.preregisteredAdapters.set(r.type,r)}getSupportedAdapters(e=[]){const r=this._getAdapterMap(e);return Array.from(r).map(([,n])=>n).filter(n=>n.isSupported?.()).map(n=>n.type)}getBestAvailableAdapterType(e=[]){const r=["webgpu","webgl","null"],n=this._getAdapterMap(e);for(const i of r)if(n.get(i)?.isSupported?.())return i;return null}selectAdapter(e,r=[]){let n=e;e==="best-available"&&(n=this.getBestAvailableAdapterType(r));const i=this._getAdapterMap(r);return n&&i.get(n)||null}enforceWebGL2(e=!0,r=[]){const i=this._getAdapterMap(r).get("webgl");i||rn.warn("enforceWebGL2: webgl adapter not found")(),i?.enforceWebGL2?.(e)}setDefaultDeviceProps(e){Object.assign(fT.defaultProps,e)}_getAdapterMap(e=[]){const r=new Map(this.preregisteredAdapters);for(const n of e)r.set(n.type,n);return r}_getTypeFromHandle(e,r=[]){return e instanceof WebGL2RenderingContext?"webgl":typeof GPUDevice<"u"&&e instanceof GPUDevice||e?.queue?"webgpu":e===null?"null":(e instanceof WebGLRenderingContext?rn.warn("WebGL1 is not supported",e)():rn.warn("Unknown handle type",e)(),null)}}const tD=new fT;class p9e{get pageLoaded(){return y9e()}}const g9e=Dy()&&typeof document<"u",m9e=()=>g9e&&document.readyState==="complete";let Ww=null;function y9e(){return Ww||(m9e()||typeof window>"u"?Ww=Promise.resolve():Ww=new Promise(t=>window.addEventListener("load",()=>t()))),Ww}function v9e(){let t,e;return{promise:new Promise((n,i)=>{t=n,e=i}),resolve:t,reject:e}}class Dm{static isHTMLCanvas(e){return typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement}static isOffscreenCanvas(e){return typeof OffscreenCanvas<"u"&&e instanceof OffscreenCanvas}static defaultProps={id:void 0,canvas:null,width:800,height:600,useDevicePixels:!0,autoResize:!0,container:null,visible:!0,alphaMode:"opaque",colorSpace:"srgb",trackPosition:!1};id;props;canvas;htmlCanvas;offscreenCanvas;type;initialized;isInitialized=!1;isVisible=!0;cssWidth;cssHeight;devicePixelRatio;devicePixelWidth;devicePixelHeight;drawingBufferWidth;drawingBufferHeight;_initializedResolvers=v9e();_resizeObserver;_intersectionObserver;_position;destroyed=!1;toString(){return`${this[Symbol.toStringTag]}(${this.id})`}constructor(e){if(this.props={...Dm.defaultProps,...e},e=this.props,this.initialized=this._initializedResolvers.promise,Dy()?e.canvas?typeof e.canvas=="string"?this.canvas=b9e(e.canvas):this.canvas=e.canvas:this.canvas=x9e(e):this.canvas={width:e.width||1,height:e.height||1},Dm.isHTMLCanvas(this.canvas)?(this.id=e.id||this.canvas.id,this.type="html-canvas",this.htmlCanvas=this.canvas):Dm.isOffscreenCanvas(this.canvas)?(this.id=e.id||"offscreen-canvas",this.type="offscreen-canvas",this.offscreenCanvas=this.canvas):(this.id=e.id||"node-canvas-context",this.type="node"),this.cssWidth=this.htmlCanvas?.clientWidth||this.canvas.width,this.cssHeight=this.htmlCanvas?.clientHeight||this.canvas.height,this.devicePixelWidth=this.canvas.width,this.devicePixelHeight=this.canvas.height,this.drawingBufferWidth=this.canvas.width,this.drawingBufferHeight=this.canvas.height,this.devicePixelRatio=globalThis.devicePixelRatio||1,this._position=[0,0],Dm.isHTMLCanvas(this.canvas)){this._intersectionObserver=new IntersectionObserver(r=>this._handleIntersection(r)),this._intersectionObserver.observe(this.canvas),this._resizeObserver=new ResizeObserver(r=>this._handleResize(r));try{this._resizeObserver.observe(this.canvas,{box:"device-pixel-content-box"})}catch{this._resizeObserver.observe(this.canvas,{box:"content-box"})}setTimeout(()=>this._observeDevicePixelRatio(),0),this.props.trackPosition&&this._trackPosition()}}destroy(){this.destroyed=!0}setProps(e){return"useDevicePixels"in e&&(this.props.useDevicePixels=e.useDevicePixels||!1,this._updateDrawingBufferSize()),this}getCSSSize(){return[this.cssWidth,this.cssHeight]}getPosition(){return this._position}getDevicePixelSize(){return[this.devicePixelWidth,this.devicePixelHeight]}getDrawingBufferSize(){return[this.drawingBufferWidth,this.drawingBufferHeight]}getMaxDrawingBufferSize(){const e=this.device.limits.maxTextureDimension2D;return[e,e]}setDrawingBufferSize(e,r){this.canvas.width=e,this.canvas.height=r,this.drawingBufferWidth=e,this.drawingBufferHeight=r}getDevicePixelRatio(){return typeof window<"u"&&window.devicePixelRatio||1}cssToDevicePixels(e,r=!0){const n=this.cssToDeviceRatio(),[i,a]=this.getDrawingBufferSize();return w9e(e,n,i,a,r)}getPixelSize(){return this.getDevicePixelSize()}getAspect(){const[e,r]=this.getDevicePixelSize();return e/r}cssToDeviceRatio(){try{const[e]=this.getDrawingBufferSize(),[r]=this.getCSSSize();return r?e/r:1}catch{return 1}}resize(e){this.setDrawingBufferSize(e.width,e.height)}_setAutoCreatedCanvasId(e){this.htmlCanvas?.id==="lumagl-auto-created-canvas"&&(this.htmlCanvas.id=e)}_handleIntersection(e){const r=e.find(i=>i.target===this.canvas);if(!r)return;const n=r.isIntersecting;this.isVisible!==n&&(this.isVisible=n,this.device.props.onVisibilityChange(this))}_handleResize(e){const r=e.find(c=>c.target===this.canvas);if(!r)return;this.cssWidth=r.contentBoxSize[0].inlineSize,this.cssHeight=r.contentBoxSize[0].blockSize;const n=this.getDevicePixelSize(),i=r.devicePixelContentBoxSize?.[0].inlineSize||r.contentBoxSize[0].inlineSize*devicePixelRatio,a=r.devicePixelContentBoxSize?.[0].blockSize||r.contentBoxSize[0].blockSize*devicePixelRatio,[s,o]=this.getMaxDrawingBufferSize();this.devicePixelWidth=Math.max(1,Math.min(i,s)),this.devicePixelHeight=Math.max(1,Math.min(a,o)),this._updateDrawingBufferSize(),this.device.props.onResize(this,{oldPixelSize:n})}_updateDrawingBufferSize(){if(this.props.autoResize){if(typeof this.props.useDevicePixels=="number"){const e=this.props.useDevicePixels;this.setDrawingBufferSize(this.cssWidth*e,this.cssHeight*e)}else this.props.useDevicePixels?this.setDrawingBufferSize(this.devicePixelWidth,this.devicePixelHeight):this.setDrawingBufferSize(this.cssWidth,this.cssHeight);this._updateDevice()}this._initializedResolvers.resolve(),this.isInitialized=!0,this.updatePosition()}_observeDevicePixelRatio(){const e=this.devicePixelRatio;this.devicePixelRatio=window.devicePixelRatio,this.updatePosition(),this.device.props.onDevicePixelRatioChange(this,{oldRatio:e}),matchMedia(`(resolution: ${this.devicePixelRatio}dppx)`).addEventListener("change",()=>this._observeDevicePixelRatio(),{once:!0})}_trackPosition(e=100){const r=setInterval(()=>{this.destroyed?clearInterval(r):this.updatePosition()},e)}updatePosition(){const e=this.htmlCanvas?.getBoundingClientRect();if(e){const r=[e.left,e.top];if(this._position??=r,r[0]!==this._position[0]||r[1]!==this._position[1]){const i=this._position;this._position=r,this.device.props.onPositionChange?.(this,{oldPosition:i})}}}}function _9e(t){if(typeof t=="string"){const e=document.getElementById(t);if(!e)throw new Error(`${t} is not an HTML element`);return e}return t||document.body}function b9e(t){const e=document.getElementById(t);if(!Dm.isHTMLCanvas(e))throw new Error("Object is not a canvas element");return e}function x9e(t){const{width:e,height:r}=t,n=document.createElement("canvas");n.id=Y3("lumagl-auto-created-canvas"),n.width=e||1,n.height=r||1,n.style.width=Number.isFinite(e)?`${e}px`:"100%",n.style.height=Number.isFinite(r)?`${r}px`:"100%",t?.visible||(n.style.visibility="hidden");const i=_9e(t?.container||null);return i.insertBefore(n,i.firstChild),n}function w9e(t,e,r,n,i){const a=t,s=vG(a[0],e,r);let o=_G(a[1],e,n,i),c=vG(a[0]+1,e,r);const f=c===r-1?c:c-1;c=_G(a[1]+1,e,n,i);let d;return i?(c=c===0?c:c+1,d=o,o=c):d=c===n-1?c:c-1,{x:s,y:o,width:Math.max(f-s+1,1),height:Math.max(d-o+1,1)}}function vG(t,e,r){return Math.min(Math.round(t*e),r-1)}function _G(t,e,r,n){return n?Math.max(0,r-1-Math.round(t*e)):Math.min(Math.round(t*e),r-1)}class dy extends So{static defaultProps={...So.defaultProps,type:"color-sampler",addressModeU:"clamp-to-edge",addressModeV:"clamp-to-edge",addressModeW:"clamp-to-edge",magFilter:"nearest",minFilter:"nearest",mipmapFilter:"none",lodMinClamp:0,lodMaxClamp:32,compare:"less-equal",maxAnisotropy:1};get[Symbol.toStringTag](){return"Sampler"}constructor(e,r){r=dy.normalizeProps(e,r),super(e,r,dy.defaultProps)}static normalizeProps(e,r){return r}}const S9e={"1d":"1d","2d":"2d","2d-array":"2d",cube:"2d","cube-array":"2d","3d":"3d"};class Fl extends So{static SAMPLE=4;static STORAGE=8;static RENDER=16;static COPY_SRC=1;static COPY_DST=2;static TEXTURE=4;static RENDER_ATTACHMENT=16;dimension;baseDimension;format;width;height;depth;mipLevels;updateTimestamp;get[Symbol.toStringTag](){return"Texture"}toString(){return`Texture(${this.id},${this.format},${this.width}x${this.height})`}constructor(e,r){if(r=Fl.normalizeProps(e,r),super(e,r,Fl.defaultProps),this.dimension=this.props.dimension,this.baseDimension=S9e[this.dimension],this.format=this.props.format,this.width=this.props.width,this.height=this.props.height,this.depth=this.props.depth,this.mipLevels=this.props.mipLevels,this.props.width===void 0||this.props.height===void 0)if(e.isExternalImage(r.data)){const n=e.getExternalImageSize(r.data);this.width=n?.width||1,this.height=n?.height||1}else this.width=1,this.height=1,(this.props.width===void 0||this.props.height===void 0)&&rn.warn(`${this} created with undefined width or height. This is deprecated. Use AsyncTexture instead.`)();this.updateTimestamp=e.incrementTimestamp()}setSampler(e){this.sampler=e instanceof dy?e:this.device.createSampler(e)}clone(e){return this.device.createTexture({...this.props,...e})}static normalizeProps(e,r){const n={...r},{width:i,height:a}=n;return typeof i=="number"&&(n.width=Math.max(1,Math.ceil(i))),typeof a=="number"&&(n.height=Math.max(1,Math.ceil(a))),n}_initializeData(e){this.device.isExternalImage(e)?this.copyExternalImage({image:e,width:this.width,height:this.height,depth:this.depth,mipLevel:0,x:0,y:0,z:0,aspect:"all",colorSpace:"srgb",premultipliedAlpha:!1,flipY:!1}):e&&this.copyImageData({data:e,mipLevel:0,x:0,y:0,z:0,aspect:"all"})}_normalizeCopyImageDataOptions(e){const{width:r,height:n,depth:i}=this,a={...Fl.defaultCopyDataOptions,width:r,height:n,depth:i,...e},s=this.device.getTextureFormatInfo(this.format);if(!e.bytesPerRow&&!s.bytesPerPixel)throw new Error(`bytesPerRow must be provided for texture format ${this.format}`);return a.bytesPerRow=e.bytesPerRow||r*(s.bytesPerPixel||4),a.rowsPerImage=e.rowsPerImage||n,a}_normalizeCopyExternalImageOptions(e){const r=this.device.getExternalImageSize(e.image),n={...Fl.defaultCopyExternalImageOptions,...r,...e};return n.width=Math.min(n.width,this.width-n.x),n.height=Math.min(n.height,this.height-n.y),n}static defaultProps={...So.defaultProps,data:null,dimension:"2d",format:"rgba8unorm",usage:Fl.TEXTURE|Fl.RENDER_ATTACHMENT|Fl.COPY_DST,width:void 0,height:void 0,depth:1,mipLevels:1,samples:void 0,sampler:{},view:void 0};static defaultCopyDataOptions={data:void 0,byteOffset:0,bytesPerRow:void 0,rowsPerImage:void 0,mipLevel:0,x:0,y:0,z:0,aspect:"all"};static defaultCopyExternalImageOptions={image:void 0,sourceX:0,sourceY:0,width:void 0,height:void 0,depth:1,mipLevel:0,x:0,y:0,z:0,aspect:"all",colorSpace:"srgb",premultipliedAlpha:!1,flipY:!1}}class Z3 extends So{get[Symbol.toStringTag](){return"TextureView"}constructor(e,r){super(e,r,Z3.defaultProps)}static defaultProps={...So.defaultProps,format:void 0,dimension:void 0,aspect:"all",baseMipLevel:0,mipLevelCount:void 0,baseArrayLayer:0,arrayLayerCount:void 0}}function E9e(t,e,r){let n="";const i=e.split(/\r?\n/),a=t.slice().sort((s,o)=>s.lineNum-o.lineNum);switch(r?.showSourceCode||"no"){case"all":let s=0;for(let o=1;o<=i.length;o++)for(n+=dre(i[o-1],o,r);a.length>s&&a[s].lineNum===o;){const c=a[s++];n+=HP(c,i,c.lineNum,{...r,inlineSource:!1})}for(;a.length>s;){const o=a[s++];n+=HP(o,[],0,{...r,inlineSource:!1})}return n;case"issues":case"no":for(const o of t)n+=HP(o,i,o.lineNum,{inlineSource:r?.showSourceCode!=="no"});return n}}function HP(t,e,r,n){if(n?.inlineSource){const a=T9e(e,r),s=t.linePos>0?`${" ".repeat(t.linePos+5)}^^^
`:"";return`
${a}${s}${t.type.toUpperCase()}: ${t.message}

`}const i=t.type==="error"?"red":"#8B4000";return n?.html?`<div class='luma-compiler-log-error' style="color:${i};"><b> ${t.type.toUpperCase()}: ${t.message}</b></div>`:`${t.type.toUpperCase()}: ${t.message}`}function T9e(t,e,r){let n="";for(let i=e-2;i<=e;i++){const a=t[i-1];a!==void 0&&(n+=dre(a,e,r))}return n}function dre(t,e,r){const n=r?.html?A9e(t):t;return`${C9e(String(e),4)}: ${n}${r?.html?"<br/>":`
`}`}function C9e(t,e){let r="";for(let n=t.length;n<e;++n)r+=" ";return r+t}function A9e(t){return t.replaceAll("&","&amp;").replaceAll("<","&lt;").replaceAll(">","&gt;").replaceAll('"',"&quot;").replaceAll("'","&#039;")}class K3 extends So{get[Symbol.toStringTag](){return"Shader"}stage;source;compilationStatus="pending";constructor(e,r){r={...r,debugShaders:r.debugShaders||e.props.debugShaders||"errors"},super(e,{id:I9e(r),...r},K3.defaultProps),this.stage=this.props.stage,this.source=this.props.source}getCompilationInfoSync(){return null}getTranslatedSource(){return null}async debugShader(){const e=this.props.debugShaders;switch(e){case"never":return;case"errors":if(this.compilationStatus==="success")return;break}const r=await this.getCompilationInfo();e==="warnings"&&r?.length===0||this._displayShaderLog(r,this.id)}_displayShaderLog(e,r){if(typeof document>"u"||!document?.createElement)return;const n=r,i=`${this.stage} shader "${n}"`;let a=E9e(e,this.source,{showSourceCode:"all",html:!0});const s=this.getTranslatedSource();s&&(a+=`<br /><br /><h1>Translated Source</h1><br /><br /><code style="user-select:text;"><pre>${s}</pre></code>`);const o=document.createElement("Button");o.innerHTML=`
<h1>Compilation error in ${i}</h1><br /><br />
<code style="user-select:text;"><pre>
${a}
</pre></code>`,o.style.top="10px",o.style.left="10px",o.style.position="absolute",o.style.zIndex="9999",o.style.width="100%",o.style.textAlign="left",document.body.appendChild(o),document.getElementsByClassName("luma-compiler-log-error")[0]?.scrollIntoView(),o.onclick=()=>{const f=`data:text/plain,${encodeURIComponent(this.source)}`;navigator.clipboard.writeText(f)}}static defaultProps={...So.defaultProps,language:"auto",stage:void 0,source:"",sourceMap:null,entryPoint:"main",debugShaders:void 0}}function I9e(t){return P9e(t.source)||t.id||Y3(`unnamed ${t.stage}-shader`)}function P9e(t,e="unnamed"){const n=/#define[\s*]SHADER_NAME[\s*]([A-Za-z0-9_-]+)[\s*]/.exec(t);return n?n[1]:e}class J3 extends So{get[Symbol.toStringTag](){return"Framebuffer"}width;height;constructor(e,r={}){super(e,r,J3.defaultProps),this.width=this.props.width,this.height=this.props.height}clone(e){const r=this.colorAttachments.map(i=>i.texture.clone(e)),n=this.depthStencilAttachment&&this.depthStencilAttachment.texture.clone(e);return this.device.createFramebuffer({...this.props,colorAttachments:r,depthStencilAttachment:n})}resize(e){let r=!e;if(e){const[n,i]=Array.isArray(e)?e:[e.width,e.height];r=r||i!==this.height||n!==this.width,this.width=n,this.height=i}r&&(rn.log(2,`Resizing framebuffer ${this.id} to ${this.width}x${this.height}`)(),this.resizeAttachments(this.width,this.height))}autoCreateAttachmentTextures(){if(this.props.colorAttachments.length===0&&!this.props.depthStencilAttachment)throw new Error("Framebuffer has noattachments");this.colorAttachments=this.props.colorAttachments.map((r,n)=>{if(typeof r=="string"){const i=this.createColorTexture(r,n);return this.attachResource(i),i.view}return r instanceof Fl?r.view:r});const e=this.props.depthStencilAttachment;if(e)if(typeof e=="string"){const r=this.createDepthStencilTexture(e);this.attachResource(r),this.depthStencilAttachment=r.view}else e instanceof Fl?this.depthStencilAttachment=e.view:this.depthStencilAttachment=e}createColorTexture(e,r){return this.device.createTexture({id:`${this.id}-color-attachment-${r}`,usage:Fl.RENDER_ATTACHMENT,format:e,width:this.width,height:this.height,sampler:{magFilter:"linear",minFilter:"linear"}})}createDepthStencilTexture(e){return this.device.createTexture({id:`${this.id}-depth-stencil-attachment`,usage:Fl.RENDER_ATTACHMENT,format:e,width:this.width,height:this.height})}resizeAttachments(e,r){for(let n=0;n<this.colorAttachments.length;++n)if(this.colorAttachments[n]){const i=this.colorAttachments[n].texture.clone({width:e,height:r});this.destroyAttachedResource(this.colorAttachments[n]),this.colorAttachments[n]=i.view,this.attachResource(i.view)}if(this.depthStencilAttachment){const n=this.depthStencilAttachment.texture.clone({width:e,height:r});this.destroyAttachedResource(this.depthStencilAttachment),this.depthStencilAttachment=n.view,this.attachResource(n)}this.updateAttachments()}static defaultProps={...So.defaultProps,width:1,height:1,colorAttachments:[],depthStencilAttachment:null}}class qm extends So{get[Symbol.toStringTag](){return"RenderPipeline"}shaderLayout;bufferLayout;linkStatus="pending";hash="";constructor(e,r){super(e,r,qm.defaultProps),this.shaderLayout=this.props.shaderLayout,this.bufferLayout=this.props.bufferLayout||[]}static defaultProps={...So.defaultProps,vs:null,vertexEntryPoint:"vertexMain",vsConstants:{},fs:null,fragmentEntryPoint:"fragmentMain",fsConstants:{},shaderLayout:null,bufferLayout:[],topology:"triangle-list",colorAttachmentFormats:void 0,depthStencilAttachmentFormat:void 0,parameters:{},bindings:{},uniforms:{}}}class Am extends So{static defaultClearColor=[0,0,0,1];static defaultClearDepth=1;static defaultClearStencil=0;get[Symbol.toStringTag](){return"RenderPass"}constructor(e,r){r=Am.normalizeProps(e,r),super(e,r,Am.defaultProps)}static normalizeProps(e,r){return r}static defaultProps={...So.defaultProps,framebuffer:null,parameters:void 0,clearColor:Am.defaultClearColor,clearColors:void 0,clearDepth:Am.defaultClearDepth,clearStencil:Am.defaultClearStencil,depthReadOnly:!1,stencilReadOnly:!1,discard:!1,occlusionQuerySet:void 0,timestampQuerySet:void 0,beginTimestampIndex:void 0,endTimestampIndex:void 0}}class hT extends So{get[Symbol.toStringTag](){return"ComputePipeline"}hash="";shaderLayout;constructor(e,r){super(e,r,hT.defaultProps),this.shaderLayout=r.shaderLayout}static defaultProps={...So.defaultProps,shader:void 0,entryPoint:void 0,constants:{},shaderLayout:void 0}}class GL extends So{get[Symbol.toStringTag](){return"CommandEncoder"}constructor(e,r){super(e,r,GL.defaultProps)}static defaultProps={...So.defaultProps,measureExecutionTime:void 0}}class WL extends So{get[Symbol.toStringTag](){return"CommandBuffer"}constructor(e,r){super(e,r,WL.defaultProps)}static defaultProps={...So.defaultProps}}function pre(t){return D9e[t]}function k9e(t){const[e,r]=M9e[t],n=e==="i32"||e==="u32",i=e!=="u32",a=R9e[e]*r;return{primitiveType:e,components:r,byteLength:a,integer:n,signed:i}}const R9e={f32:4,f16:2,i32:4,u32:4},M9e={f32:["f32",1],"vec2<f32>":["f32",2],"vec3<f32>":["f32",3],"vec4<f32>":["f32",4],f16:["f16",1],"vec2<f16>":["f16",2],"vec3<f16>":["f16",3],"vec4<f16>":["f16",4],i32:["i32",1],"vec2<i32>":["i32",2],"vec3<i32>":["i32",3],"vec4<i32>":["i32",4],u32:["u32",1],"vec2<u32>":["u32",2],"vec3<u32>":["u32",3],"vec4<u32>":["u32",4]},D9e={f32:{type:"f32",components:1},f16:{type:"f16",components:1},i32:{type:"i32",components:1},u32:{type:"u32",components:1},"vec2<f32>":{type:"f32",components:2},"vec3<f32>":{type:"f32",components:3},"vec4<f32>":{type:"f32",components:4},"vec2<f16>":{type:"f16",components:2},"vec3<f16>":{type:"f16",components:3},"vec4<f16>":{type:"f16",components:4},"vec2<i32>":{type:"i32",components:2},"vec3<i32>":{type:"i32",components:3},"vec4<i32>":{type:"i32",components:4},"vec2<u32>":{type:"u32",components:2},"vec3<u32>":{type:"u32",components:3},"vec4<u32>":{type:"u32",components:4},"mat2x2<f32>":{type:"f32",components:4},"mat2x3<f32>":{type:"f32",components:6},"mat2x4<f32>":{type:"f32",components:8},"mat3x2<f32>":{type:"f32",components:6},"mat3x3<f32>":{type:"f32",components:9},"mat3x4<f32>":{type:"f32",components:12},"mat4x2<f32>":{type:"f32",components:8},"mat4x3<f32>":{type:"f32",components:12},"mat4x4<f32>":{type:"f32",components:16},"mat2x2<f16>":{type:"f16",components:4},"mat2x3<f16>":{type:"f16",components:6},"mat2x4<f16>":{type:"f16",components:8},"mat3x2<f16>":{type:"f16",components:6},"mat3x3<f16>":{type:"f16",components:9},"mat3x4<f16>":{type:"f16",components:12},"mat4x2<f16>":{type:"f16",components:8},"mat4x3<f16>":{type:"f16",components:12},"mat4x4<f16>":{type:"f16",components:16},"mat2x2<i32>":{type:"i32",components:4},"mat2x3<i32>":{type:"i32",components:6},"mat2x4<i32>":{type:"i32",components:8},"mat3x2<i32>":{type:"i32",components:6},"mat3x3<i32>":{type:"i32",components:9},"mat3x4<i32>":{type:"i32",components:12},"mat4x2<i32>":{type:"i32",components:8},"mat4x3<i32>":{type:"i32",components:12},"mat4x4<i32>":{type:"i32",components:16},"mat2x2<u32>":{type:"u32",components:4},"mat2x3<u32>":{type:"u32",components:6},"mat2x4<u32>":{type:"u32",components:8},"mat3x2<u32>":{type:"u32",components:6},"mat3x3<u32>":{type:"u32",components:9},"mat3x4<u32>":{type:"u32",components:12},"mat4x2<u32>":{type:"u32",components:8},"mat4x3<u32>":{type:"u32",components:12},"mat4x4<u32>":{type:"u32",components:16}};function gre(t,e){const r={};for(const n of t.attributes){const i=N9e(t,e,n.name);i&&(r[n.name]=i)}return r}function O9e(t,e,r=16){const n=gre(t,e),i=new Array(r).fill(null);for(const a of Object.values(n))i[a.location]=a;return i}function N9e(t,e,r){const n=L9e(t,r),i=F9e(e,r);if(!n)return null;const a=k9e(n.type),s=Jze(a),o=i?.vertexFormat||s,c=HL(o);return{attributeName:i?.attributeName||n.name,bufferName:i?.bufferName||n.name,location:n.location,shaderType:n.type,primitiveType:a.primitiveType,shaderComponents:a.components,vertexFormat:o,bufferDataType:c.type,bufferComponents:c.components,normalized:c.normalized,integer:a.integer,stepMode:i?.stepMode||n.stepMode||"vertex",byteOffset:i?.byteOffset||0,byteStride:i?.byteStride||0}}function L9e(t,e){const r=t.attributes.find(n=>n.name===e);return r||rn.warn(`shader layout attribute "${e}" not present in shader`),r||null}function F9e(t,e){B9e(t);let r=z9e(t,e);return r||(r=j9e(t,e),r)?r:(rn.warn(`layout for attribute "${e}" not present in buffer layout`),null)}function B9e(t){for(const e of t)(e.attributes&&e.format||!e.attributes&&!e.format)&&rn.warn(`BufferLayout ${name} must have either 'attributes' or 'format' field`)}function z9e(t,e){for(const r of t)if(r.format&&r.name===e)return{attributeName:r.name,bufferName:e,stepMode:r.stepMode,vertexFormat:r.format,byteOffset:0,byteStride:r.byteStride||0};return null}function j9e(t,e){for(const r of t){let n=r.byteStride;if(typeof r.byteStride!="number")for(const a of r.attributes||[]){const s=HL(a.format);n+=s.byteLength}const i=r.attributes?.find(a=>a.attribute===e);if(i)return{attributeName:i.attribute,bufferName:r.name,stepMode:r.stepMode,vertexFormat:i.format,byteOffset:i.byteOffset,byteStride:n}}return null}class XL extends So{static defaultProps={...So.defaultProps,shaderLayout:void 0,bufferLayout:[]};get[Symbol.toStringTag](){return"VertexArray"}maxVertexAttributes;attributeInfos;indexBuffer=null;attributes;constructor(e,r){super(e,r,XL.defaultProps),this.maxVertexAttributes=e.limits.maxVertexAttributes,this.attributes=new Array(this.maxVertexAttributes).fill(null),this.attributeInfos=O9e(r.shaderLayout,r.bufferLayout,this.maxVertexAttributes)}setConstantWebGL(e,r){this.device.reportError(new Error("constant attributes not supported"),this)()}}class YL extends So{static defaultProps={...So.defaultProps,layout:void 0,buffers:{}};get[Symbol.toStringTag](){return"TransformFeedback"}constructor(e,r){super(e,r,YL.defaultProps)}}class ZL extends So{get[Symbol.toStringTag](){return"QuerySet"}constructor(e,r){super(e,r,ZL.defaultProps)}static defaultProps={...So.defaultProps,type:void 0,count:void 0}}let Xw;function mre(t){return(!Xw||Xw.byteLength<t)&&(Xw=new ArrayBuffer(t)),Xw}function U9e(t,e){const r=mre(t.BYTES_PER_ELEMENT*e);return new t(r,0,e)}function V9e(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function dT(t){return Array.isArray(t)?t.length===0||typeof t[0]=="number":V9e(t)}const $9e=1024;class q9e{layout={};byteLength;constructor(e,r={}){let n=0;for(const[a,s]of Object.entries(e)){const o=pre(s),{type:c,components:f}=o,d=f*(r?.[a]??1);n=Yze(n,d);const m=n;n+=d,this.layout[a]={type:c,size:d,offset:m}}n+=(4-n%4)%4;const i=n*4;this.byteLength=Math.max(i,$9e)}getData(e){const r=mre(this.byteLength),n={i32:new Int32Array(r),u32:new Uint32Array(r),f32:new Float32Array(r),f16:new Uint16Array(r)};for(const[i,a]of Object.entries(e)){const s=this.layout[i];if(!s){rn.warn(`Supplied uniform value ${i} not present in uniform block layout`)();continue}const{type:o,size:c,offset:f}=s,d=n[o];if(c===1){if(typeof a!="number"&&typeof a!="boolean"){rn.warn(`Supplied value for single component uniform ${i} is not a number: ${a}`)();continue}d[f]=Number(a)}else{if(!dT(a)){rn.warn(`Supplied value for multi component / array uniform ${i} is not a numeric array: ${a}`)();continue}d.set(a,f)}}return new Uint8Array(r,0,this.byteLength)}has(e){return!!this.layout[e]}get(e){return this.layout[e]}}function H9e(t,e,r=16){if(t!==e)return!1;const n=t,i=e;if(!dT(n))return!1;if(dT(i)&&n.length===i.length){for(let a=0;a<n.length;++a)if(i[a]!==n[a])return!1}return!0}function G9e(t){return dT(t)?t.slice():t}class W9e{name;uniforms={};modifiedUniforms={};modified=!0;bindingLayout={};needsRedraw="initialized";constructor(e){if(this.name=e?.name||"unnamed",e?.name&&e?.shaderLayout){const r=e?.shaderLayout.bindings?.find(i=>i.type==="uniform"&&i.name===e?.name);if(!r)throw new Error(e?.name);const n=r;for(const i of n.uniforms||[])this.bindingLayout[i.name]=i}}setUniforms(e){for(const[r,n]of Object.entries(e))this._setUniform(r,n),this.needsRedraw||this.setNeedsRedraw(`${this.name}.${r}=${n}`)}setNeedsRedraw(e){this.needsRedraw=this.needsRedraw||e}getAllUniforms(){return this.modifiedUniforms={},this.needsRedraw=!1,this.uniforms||{}}_setUniform(e,r){H9e(this.uniforms[e],r)||(this.uniforms[e]=G9e(r),this.modifiedUniforms[e]=!0,this.modified=!0)}}class X9e{uniformBlocks=new Map;uniformBufferLayouts=new Map;uniformBuffers=new Map;constructor(e){for(const[r,n]of Object.entries(e)){const i=r,a=new q9e(n.uniformTypes??{},n.uniformSizes??{});this.uniformBufferLayouts.set(i,a);const s=new W9e({name:r});s.setUniforms(n.defaultUniforms||{}),this.uniformBlocks.set(i,s)}}destroy(){for(const e of this.uniformBuffers.values())e.destroy()}setUniforms(e){for(const[r,n]of Object.entries(e))this.uniformBlocks.get(r)?.setUniforms(n);this.updateUniformBuffers()}getUniformBufferByteLength(e){return this.uniformBufferLayouts.get(e)?.byteLength||0}getUniformBufferData(e){const r=this.uniformBlocks.get(e)?.getAllUniforms()||{};return this.uniformBufferLayouts.get(e)?.getData(r)}createUniformBuffer(e,r,n){n&&this.setUniforms(n);const i=this.getUniformBufferByteLength(r),a=e.createBuffer({usage:jo.UNIFORM|jo.COPY_DST,byteLength:i}),s=this.getUniformBufferData(r);return a.write(s),a}getManagedUniformBuffer(e,r){if(!this.uniformBuffers.get(r)){const n=this.getUniformBufferByteLength(r),i=e.createBuffer({usage:jo.UNIFORM|jo.COPY_DST,byteLength:n});this.uniformBuffers.set(r,i)}return this.uniformBuffers.get(r)}updateUniformBuffers(){let e=!1;for(const r of this.uniformBlocks.keys()){const n=this.updateUniformBuffer(r);e||=n}return e&&rn.log(3,`UniformStore.updateUniformBuffers(): ${e}`)(),e}updateUniformBuffer(e){const r=this.uniformBlocks.get(e);let n=this.uniformBuffers.get(e),i=!1;if(n&&r?.needsRedraw){i||=r.needsRedraw;const a=this.getUniformBufferData(e);n=this.uniformBuffers.get(e),n?.write(a);const s=this.uniformBlocks.get(e)?.getAllUniforms();rn.log(4,`Writing to uniform buffer ${String(e)}`,a,s)()}return i}}class Vf{constructor(e,r){this.name=e,this.attributes=r,this.size=0}get isArray(){return!1}get isStruct(){return!1}get isTemplate(){return!1}get isPointer(){return!1}getTypeName(){return this.name}}class bG{constructor(e,r,n){this.name=e,this.type=r,this.attributes=n,this.offset=0,this.size=0}get isArray(){return this.type.isArray}get isStruct(){return this.type.isStruct}get isTemplate(){return this.type.isTemplate}get align(){return this.type.isStruct?this.type.align:0}get members(){return this.type.isStruct?this.type.members:null}get format(){return this.type.isArray||this.type.isTemplate?this.type.format:null}get count(){return this.type.isArray?this.type.count:0}get stride(){return this.type.isArray?this.type.stride:this.size}}class mg extends Vf{constructor(e,r){super(e,r),this.members=[],this.align=0,this.startLine=-1,this.endLine=-1,this.inUse=!1}get isStruct(){return!0}}class wg extends Vf{constructor(e,r){super(e,r),this.count=0,this.stride=0}get isArray(){return!0}getTypeName(){return`array<${this.format.getTypeName()}, ${this.count}>`}}class rD extends Vf{constructor(e,r,n){super(e,n),this.format=r}get isPointer(){return!0}getTypeName(){return`&${this.format.getTypeName()}`}}class py extends Vf{constructor(e,r,n,i){super(e,n),this.format=r,this.access=i}get isTemplate(){return!0}getTypeName(){let e=this.name;if(this.format!==null){if(e==="vec2"||e==="vec3"||e==="vec4"||e==="mat2x2"||e==="mat2x3"||e==="mat2x4"||e==="mat3x2"||e==="mat3x3"||e==="mat3x4"||e==="mat4x2"||e==="mat4x3"||e==="mat4x4"){if(this.format.name==="f32")return e+="f",e;if(this.format.name==="i32")return e+="i",e;if(this.format.name==="u32")return e+="u",e;if(this.format.name==="bool")return e+="b",e;if(this.format.name==="f16")return e+="h",e}e+=`<${this.format.name}>`}else if(e==="vec2"||e==="vec3"||e==="vec4")return e;return e}}var lg;(t=>{t[t.Uniform=0]="Uniform",t[t.Storage=1]="Storage",t[t.Texture=2]="Texture",t[t.Sampler=3]="Sampler",t[t.StorageTexture=4]="StorageTexture"})(lg||(lg={}));class Yw{constructor(e,r,n,i,a,s,o){this.name=e,this.type=r,this.group=n,this.binding=i,this.attributes=a,this.resourceType=s,this.access=o}get isArray(){return this.type.isArray}get isStruct(){return this.type.isStruct}get isTemplate(){return this.type.isTemplate}get size(){return this.type.size}get align(){return this.type.isStruct?this.type.align:0}get members(){return this.type.isStruct?this.type.members:null}get format(){return this.type.isArray||this.type.isTemplate?this.type.format:null}get count(){return this.type.isArray?this.type.count:0}get stride(){return this.type.isArray?this.type.stride:this.size}}class Y9e{constructor(e,r){this.name=e,this.type=r}}class Z9e{constructor(e,r,n,i){this.name=e,this.type=r,this.locationType=n,this.location=i,this.interpolation=null}}class xG{constructor(e,r,n,i){this.name=e,this.type=r,this.locationType=n,this.location=i}}class K9e{constructor(e,r,n,i){this.name=e,this.type=r,this.attributes=n,this.id=i}}class J9e{constructor(e,r,n){this.name=e,this.type=r,this.attributes=n}}class Q9e{constructor(e,r=null,n){this.stage=null,this.inputs=[],this.outputs=[],this.arguments=[],this.returnType=null,this.resources=[],this.overrides=[],this.startLine=-1,this.endLine=-1,this.inUse=!1,this.calls=new Set,this.name=e,this.stage=r,this.attributes=n}}class e7e{constructor(){this.vertex=[],this.fragment=[],this.compute=[]}}function t7e(t){var e=(32768&t)>>15,r=(31744&t)>>10,n=1023&t;return r==0?(e?-1:1)*Math.pow(2,-14)*(n/Math.pow(2,10)):r==31?n?NaN:1/0*(e?-1:1):(e?-1:1)*Math.pow(2,r-15)*(1+n/Math.pow(2,10))}const yre=new Float32Array(1),r7e=new Int32Array(yre.buffer),Yu=new Uint16Array(1);function n7e(t){yre[0]=t;const e=r7e[0],r=e>>31&1;let n=e>>23&255,i=8388607&e;if(n===255)return Yu[0]=r<<15|31744|(i!==0?512:0),Yu[0];if(n===0){if(i===0)return Yu[0]=r<<15,Yu[0];i|=8388608;let a=113;for(;!(8388608&i);)i<<=1,a--;return n=127-a,i&=8388607,n>0?(i=(i>>126-n)+(i>>127-n&1),Yu[0]=r<<15|n<<10|i>>13,Yu[0]):(Yu[0]=r<<15,Yu[0])}return n=n-127+15,n>=31?(Yu[0]=r<<15|31744,Yu[0]):n<=0?n<-10?(Yu[0]=r<<15,Yu[0]):(i=(8388608|i)>>1-n,Yu[0]=r<<15|i>>13,Yu[0]):(i>>=13,Yu[0]=r<<15|n<<10|i,Yu[0])}const KL=new Uint32Array(1),vre=new Float32Array(KL.buffer,0,1);function wG(t){const e=112+(t>>6&31)<<23|(63&t)<<17;return KL[0]=e,vre[0]}function i7e(t,e,r,n,i,a,s,o,c){const f=n*(s>>=i)*(a>>=i)+r*s+e*o;switch(c){case"r8unorm":return[qa(t,f,"8unorm",1)[0]];case"r8snorm":return[qa(t,f,"8snorm",1)[0]];case"r8uint":return[qa(t,f,"8uint",1)[0]];case"r8sint":return[qa(t,f,"8sint",1)[0]];case"rg8unorm":{const d=qa(t,f,"8unorm",2);return[d[0],d[1]]}case"rg8snorm":{const d=qa(t,f,"8snorm",2);return[d[0],d[1]]}case"rg8uint":{const d=qa(t,f,"8uint",2);return[d[0],d[1]]}case"rg8sint":{const d=qa(t,f,"8sint",2);return[d[0],d[1]]}case"rgba8unorm-srgb":case"rgba8unorm":{const d=qa(t,f,"8unorm",4);return[d[0],d[1],d[2],d[3]]}case"rgba8snorm":{const d=qa(t,f,"8snorm",4);return[d[0],d[1],d[2],d[3]]}case"rgba8uint":{const d=qa(t,f,"8uint",4);return[d[0],d[1],d[2],d[3]]}case"rgba8sint":{const d=qa(t,f,"8sint",4);return[d[0],d[1],d[2],d[3]]}case"bgra8unorm-srgb":case"bgra8unorm":{const d=qa(t,f,"8unorm",4);return[d[2],d[1],d[0],d[3]]}case"r16uint":return[qa(t,f,"16uint",1)[0]];case"r16sint":return[qa(t,f,"16sint",1)[0]];case"r16float":return[qa(t,f,"16float",1)[0]];case"rg16uint":{const d=qa(t,f,"16uint",2);return[d[0],d[1]]}case"rg16sint":{const d=qa(t,f,"16sint",2);return[d[0],d[1]]}case"rg16float":{const d=qa(t,f,"16float",2);return[d[0],d[1]]}case"rgba16uint":{const d=qa(t,f,"16uint",4);return[d[0],d[1],d[2],d[3]]}case"rgba16sint":{const d=qa(t,f,"16sint",4);return[d[0],d[1],d[2],d[3]]}case"rgba16float":{const d=qa(t,f,"16float",4);return[d[0],d[1],d[2],d[3]]}case"r32uint":return[qa(t,f,"32uint",1)[0]];case"r32sint":return[qa(t,f,"32sint",1)[0]];case"depth16unorm":case"depth24plus":case"depth24plus-stencil8":case"depth32float":case"depth32float-stencil8":case"r32float":return[qa(t,f,"32float",1)[0]];case"rg32uint":{const d=qa(t,f,"32uint",2);return[d[0],d[1]]}case"rg32sint":{const d=qa(t,f,"32sint",2);return[d[0],d[1]]}case"rg32float":{const d=qa(t,f,"32float",2);return[d[0],d[1]]}case"rgba32uint":{const d=qa(t,f,"32uint",4);return[d[0],d[1],d[2],d[3]]}case"rgba32sint":{const d=qa(t,f,"32sint",4);return[d[0],d[1],d[2],d[3]]}case"rgba32float":{const d=qa(t,f,"32float",4);return[d[0],d[1],d[2],d[3]]}case"rg11b10ufloat":{const d=new Uint32Array(t.buffer,f,1)[0],m=(4192256&d)>>11,b=(4290772992&d)>>22;return[wG(2047&d),wG(m),(function(x){const E=112+(x>>5&31)<<23|(31&x)<<18;return KL[0]=E,vre[0]})(b),1]}}return null}function qa(t,e,r,n){const i=[0,0,0,0];for(let a=0;a<n;++a)switch(r){case"8unorm":i[a]=t[e]/255,e++;break;case"8snorm":i[a]=t[e]/255*2-1,e++;break;case"8uint":i[a]=t[e],e++;break;case"8sint":i[a]=t[e]-127,e++;break;case"16uint":i[a]=t[e]|t[e+1]<<8,e+=2;break;case"16sint":i[a]=(t[e]|t[e+1]<<8)-32768,e+=2;break;case"16float":i[a]=t7e(t[e]|t[e+1]<<8),e+=2;break;case"32uint":case"32sint":i[a]=t[e]|t[e+1]<<8|t[e+2]<<16|t[e+3]<<24,e+=4;break;case"32float":i[a]=new Float32Array(t.buffer,e,1)[0],e+=4}return i}function ao(t,e,r,n,i){for(let a=0;a<n;++a)switch(r){case"8unorm":t[e]=255*i[a],e++;break;case"8snorm":t[e]=.5*(i[a]+1)*255,e++;break;case"8uint":t[e]=i[a],e++;break;case"8sint":t[e]=i[a]+127,e++;break;case"16uint":new Uint16Array(t.buffer,e,1)[0]=i[a],e+=2;break;case"16sint":new Int16Array(t.buffer,e,1)[0]=i[a],e+=2;break;case"16float":{const s=n7e(i[a]);new Uint16Array(t.buffer,e,1)[0]=s,e+=2;break}case"32uint":new Uint32Array(t.buffer,e,1)[0]=i[a],e+=4;break;case"32sint":new Int32Array(t.buffer,e,1)[0]=i[a],e+=4;break;case"32float":new Float32Array(t.buffer,e,1)[0]=i[a],e+=4}return i}const GP={r8unorm:{bytesPerBlock:1,blockWidth:1,blockHeight:1,isCompressed:!1,channels:1},r8snorm:{bytesPerBlock:1,blockWidth:1,blockHeight:1,isCompressed:!1,channels:1},r8uint:{bytesPerBlock:1,blockWidth:1,blockHeight:1,isCompressed:!1,channels:1},r8sint:{bytesPerBlock:1,blockWidth:1,blockHeight:1,isCompressed:!1,channels:1},rg8unorm:{bytesPerBlock:2,blockWidth:1,blockHeight:1,isCompressed:!1,channels:2},rg8snorm:{bytesPerBlock:2,blockWidth:1,blockHeight:1,isCompressed:!1,channels:2},rg8uint:{bytesPerBlock:2,blockWidth:1,blockHeight:1,isCompressed:!1,channels:2},rg8sint:{bytesPerBlock:2,blockWidth:1,blockHeight:1,isCompressed:!1,channels:2},rgba8unorm:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},"rgba8unorm-srgb":{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},rgba8snorm:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},rgba8uint:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},rgba8sint:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},bgra8unorm:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},"bgra8unorm-srgb":{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},r16uint:{bytesPerBlock:2,blockWidth:1,blockHeight:1,isCompressed:!1,channels:1},r16sint:{bytesPerBlock:2,blockWidth:1,blockHeight:1,isCompressed:!1,channels:1},r16float:{bytesPerBlock:2,blockWidth:1,blockHeight:1,isCompressed:!1,channels:1},rg16uint:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:2},rg16sint:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:2},rg16float:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:2},rgba16uint:{bytesPerBlock:8,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},rgba16sint:{bytesPerBlock:8,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},rgba16float:{bytesPerBlock:8,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},r32uint:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:1},r32sint:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:1},r32float:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:1},rg32uint:{bytesPerBlock:8,blockWidth:1,blockHeight:1,isCompressed:!1,channels:2},rg32sint:{bytesPerBlock:8,blockWidth:1,blockHeight:1,isCompressed:!1,channels:2},rg32float:{bytesPerBlock:8,blockWidth:1,blockHeight:1,isCompressed:!1,channels:2},rgba32uint:{bytesPerBlock:16,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},rgba32sint:{bytesPerBlock:16,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},rgba32float:{bytesPerBlock:16,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},rgb10a2uint:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},rgb10a2unorm:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},rg11b10ufloat:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},stencil8:{bytesPerBlock:1,blockWidth:1,blockHeight:1,isCompressed:!1,isDepthStencil:!0,hasDepth:!1,hasStencil:!0,channels:1},depth16unorm:{bytesPerBlock:2,blockWidth:1,blockHeight:1,isCompressed:!1,isDepthStencil:!0,hasDepth:!0,hasStencil:!1,channels:1},depth24plus:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,isDepthStencil:!0,hasDepth:!0,hasStencil:!1,depthOnlyFormat:"depth32float",channels:1},"depth24plus-stencil8":{bytesPerBlock:8,blockWidth:1,blockHeight:1,isCompressed:!1,isDepthStencil:!0,hasDepth:!0,hasStencil:!0,depthOnlyFormat:"depth32float",channels:1},depth32float:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,isDepthStencil:!0,hasDepth:!0,hasStencil:!1,channels:1},"depth32float-stencil8":{bytesPerBlock:8,blockWidth:1,blockHeight:1,isCompressed:!1,isDepthStencil:!0,hasDepth:!0,hasStencil:!0,stencilOnlyFormat:"depth32float",channels:1},rgb9e5ufloat:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},"bc1-rgba-unorm":{bytesPerBlock:8,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"bc1-rgba-unorm-srgb":{bytesPerBlock:8,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"bc2-rgba-unorm":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"bc2-rgba-unorm-srgb":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"bc3-rgba-unorm":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"bc3-rgba-unorm-srgb":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"bc4-r-unorm":{bytesPerBlock:8,blockWidth:4,blockHeight:4,isCompressed:!0,channels:1},"bc4-r-snorm":{bytesPerBlock:8,blockWidth:4,blockHeight:4,isCompressed:!0,channels:1},"bc5-rg-unorm":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:2},"bc5-rg-snorm":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:2},"bc6h-rgb-ufloat":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"bc6h-rgb-float":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"bc7-rgba-unorm":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"bc7-rgba-unorm-srgb":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"etc2-rgb8unorm":{bytesPerBlock:8,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"etc2-rgb8unorm-srgb":{bytesPerBlock:8,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"etc2-rgb8a1unorm":{bytesPerBlock:8,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"etc2-rgb8a1unorm-srgb":{bytesPerBlock:8,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"etc2-rgba8unorm":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"etc2-rgba8unorm-srgb":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"eac-r11unorm":{bytesPerBlock:8,blockWidth:1,blockHeight:1,isCompressed:!0,channels:1},"eac-r11snorm":{bytesPerBlock:8,blockWidth:1,blockHeight:1,isCompressed:!0,channels:1},"eac-rg11unorm":{bytesPerBlock:16,blockWidth:1,blockHeight:1,isCompressed:!0,channels:2},"eac-rg11snorm":{bytesPerBlock:16,blockWidth:1,blockHeight:1,isCompressed:!0,channels:2},"astc-4x4-unorm":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"astc-4x4-unorm-srgb":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"astc-5x4-unorm":{bytesPerBlock:16,blockWidth:5,blockHeight:4,isCompressed:!0,channels:4},"astc-5x4-unorm-srgb":{bytesPerBlock:16,blockWidth:5,blockHeight:4,isCompressed:!0,channels:4},"astc-5x5-unorm":{bytesPerBlock:16,blockWidth:5,blockHeight:5,isCompressed:!0,channels:4},"astc-5x5-unorm-srgb":{bytesPerBlock:16,blockWidth:5,blockHeight:5,isCompressed:!0,channels:4},"astc-6x5-unorm":{bytesPerBlock:16,blockWidth:6,blockHeight:5,isCompressed:!0,channels:4},"astc-6x5-unorm-srgb":{bytesPerBlock:16,blockWidth:6,blockHeight:5,isCompressed:!0,channels:4},"astc-6x6-unorm":{bytesPerBlock:16,blockWidth:6,blockHeight:6,isCompressed:!0,channels:4},"astc-6x6-unorm-srgb":{bytesPerBlock:16,blockWidth:6,blockHeight:6,isCompressed:!0,channels:4},"astc-8x5-unorm":{bytesPerBlock:16,blockWidth:8,blockHeight:5,isCompressed:!0,channels:4},"astc-8x5-unorm-srgb":{bytesPerBlock:16,blockWidth:8,blockHeight:5,isCompressed:!0,channels:4},"astc-8x6-unorm":{bytesPerBlock:16,blockWidth:8,blockHeight:6,isCompressed:!0,channels:4},"astc-8x6-unorm-srgb":{bytesPerBlock:16,blockWidth:8,blockHeight:6,isCompressed:!0,channels:4},"astc-8x8-unorm":{bytesPerBlock:16,blockWidth:8,blockHeight:8,isCompressed:!0,channels:4},"astc-8x8-unorm-srgb":{bytesPerBlock:16,blockWidth:8,blockHeight:8,isCompressed:!0,channels:4},"astc-10x5-unorm":{bytesPerBlock:16,blockWidth:10,blockHeight:5,isCompressed:!0,channels:4},"astc-10x5-unorm-srgb":{bytesPerBlock:16,blockWidth:10,blockHeight:5,isCompressed:!0,channels:4},"astc-10x6-unorm":{bytesPerBlock:16,blockWidth:10,blockHeight:6,isCompressed:!0,channels:4},"astc-10x6-unorm-srgb":{bytesPerBlock:16,blockWidth:10,blockHeight:6,isCompressed:!0,channels:4},"astc-10x8-unorm":{bytesPerBlock:16,blockWidth:10,blockHeight:8,isCompressed:!0,channels:4},"astc-10x8-unorm-srgb":{bytesPerBlock:16,blockWidth:10,blockHeight:8,isCompressed:!0,channels:4},"astc-10x10-unorm":{bytesPerBlock:16,blockWidth:10,blockHeight:10,isCompressed:!0,channels:4},"astc-10x10-unorm-srgb":{bytesPerBlock:16,blockWidth:10,blockHeight:10,isCompressed:!0,channels:4},"astc-12x10-unorm":{bytesPerBlock:16,blockWidth:12,blockHeight:10,isCompressed:!0,channels:4},"astc-12x10-unorm-srgb":{bytesPerBlock:16,blockWidth:12,blockHeight:10,isCompressed:!0,channels:4},"astc-12x12-unorm":{bytesPerBlock:16,blockWidth:12,blockHeight:12,isCompressed:!0,channels:4},"astc-12x12-unorm-srgb":{bytesPerBlock:16,blockWidth:12,blockHeight:12,isCompressed:!0,channels:4}};class eh{constructor(){this.id=eh._id++,this.line=0}get isAstNode(){return!0}get astNodeType(){return""}search(e){e(this)}searchBlock(e,r){if(e){r(pT.instance);for(const n of e)n instanceof Array?this.searchBlock(n,r):n.search(r);r(gT.instance)}}constEvaluate(e,r){throw new Error("Cannot evaluate node")}constEvaluateString(e){return this.constEvaluate(e).toString()}}eh._id=0;class pT extends eh{}pT.instance=new pT;class gT extends eh{}gT.instance=new gT;const _re=new Set(["all","all","any","select","arrayLength","abs","acos","acosh","asin","asinh","atan","atanh","atan2","ceil","clamp","cos","cosh","countLeadingZeros","countOneBits","countTrailingZeros","cross","degrees","determinant","distance","dot","dot4U8Packed","dot4I8Packed","exp","exp2","extractBits","faceForward","firstLeadingBit","firstTrailingBit","floor","fma","fract","frexp","insertBits","inverseSqrt","ldexp","length","log","log2","max","min","mix","modf","normalize","pow","quantizeToF16","radians","reflect","refract","reverseBits","round","saturate","sign","sin","sinh","smoothStep","sqrt","step","tan","tanh","transpose","trunc","dpdx","dpdxCoarse","dpdxFine","dpdy","dpdyCoarse","dpdyFine","fwidth","fwidthCoarse","fwidthFine","textureDimensions","textureGather","textureGatherCompare","textureLoad","textureNumLayers","textureNumLevels","textureNumSamples","textureSample","textureSampleBias","textureSampleCompare","textureSampleCompareLevel","textureSampleGrad","textureSampleLevel","textureSampleBaseClampToEdge","textureStore","atomicLoad","atomicStore","atomicAdd","atomicSub","atomicMax","atomicMin","atomicAnd","atomicOr","atomicXor","atomicExchange","atomicCompareExchangeWeak","pack4x8snorm","pack4x8unorm","pack4xI8","pack4xU8","pack4x8Clamp","pack4xU8Clamp","pack2x16snorm","pack2x16unorm","pack2x16float","unpack4x8snorm","unpack4x8unorm","unpack4xI8","unpack4xU8","unpack2x16snorm","unpack2x16unorm","unpack2x16float","storageBarrier","textureBarrier","workgroupBarrier","workgroupUniformLoad","subgroupAdd","subgroupExclusiveAdd","subgroupInclusiveAdd","subgroupAll","subgroupAnd","subgroupAny","subgroupBallot","subgroupBroadcast","subgroupBroadcastFirst","subgroupElect","subgroupMax","subgroupMin","subgroupMul","subgroupExclusiveMul","subgroupInclusiveMul","subgroupOr","subgroupShuffle","subgroupShuffleDown","subgroupShuffleUp","subgroupShuffleXor","subgroupXor","quadBroadcast","quadSwapDiagonal","quadSwapX","quadSwapY"]);class fs extends eh{constructor(){super()}}class dx extends fs{constructor(e,r,n,i,a,s){super(),this.calls=new Set,this.name=e,this.args=r,this.returnType=n,this.body=i,this.startLine=a,this.endLine=s}get astNodeType(){return"function"}search(e){if(this.attributes)for(const r of this.attributes)e(r);e(this);for(const r of this.args)e(r);this.searchBlock(this.body,e)}}class a7e extends fs{constructor(e){super(),this.expression=e}get astNodeType(){return"staticAssert"}search(e){this.expression.search(e)}}class bre extends fs{constructor(e,r){super(),this.condition=e,this.body=r}get astNodeType(){return"while"}search(e){this.condition.search(e),this.searchBlock(this.body,e)}}class nD extends fs{constructor(e,r){super(),this.body=e,this.loopId=r}get astNodeType(){return"continuing"}search(e){this.searchBlock(this.body,e)}}class xre extends fs{constructor(e,r,n,i){super(),this.init=e,this.condition=r,this.increment=n,this.body=i}get astNodeType(){return"for"}search(e){var r,n,i;(r=this.init)===null||r===void 0||r.search(e),(n=this.condition)===null||n===void 0||n.search(e),(i=this.increment)===null||i===void 0||i.search(e),this.searchBlock(this.body,e)}}class cp extends fs{constructor(e,r,n,i,a){super(),this.attributes=null,this.name=e,this.type=r,this.storage=n,this.access=i,this.value=a}get astNodeType(){return"var"}search(e){var r;e(this),(r=this.value)===null||r===void 0||r.search(e)}}class JL extends fs{constructor(e,r,n){super(),this.attributes=null,this.name=e,this.type=r,this.value=n}get astNodeType(){return"override"}search(e){var r;(r=this.value)===null||r===void 0||r.search(e)}}class Tb extends fs{constructor(e,r,n,i,a){super(),this.attributes=null,this.name=e,this.type=r,this.storage=n,this.access=i,this.value=a}get astNodeType(){return"let"}search(e){var r;e(this),(r=this.value)===null||r===void 0||r.search(e)}}class RS extends fs{constructor(e,r,n,i,a){super(),this.attributes=null,this.name=e,this.type=r,this.storage=n,this.access=i,this.value=a}get astNodeType(){return"const"}constEvaluate(e,r){return this.value.constEvaluate(e,r)}search(e){var r;e(this),(r=this.value)===null||r===void 0||r.search(e)}}var g0,Q1,wr,or;(t=>{t.increment="++",t.decrement="--"})(g0||(g0={})),(t=>{t.parse=function(e){const r=e;if(r=="parse")throw new Error("Invalid value for IncrementOperator");return t[r]}})(g0||(g0={}));class wre extends fs{constructor(e,r){super(),this.operator=e,this.variable=r}get astNodeType(){return"increment"}search(e){this.variable.search(e)}}(t=>{t.assign="=",t.addAssign="+=",t.subtractAssin="-=",t.multiplyAssign="*=",t.divideAssign="/=",t.moduloAssign="%=",t.andAssign="&=",t.orAssign="|=",t.xorAssign="^=",t.shiftLeftAssign="<<=",t.shiftRightAssign=">>="})(Q1||(Q1={})),(t=>{t.parse=function(e){const r=e;if(r=="parse")throw new Error("Invalid value for AssignOperator");return r}})(Q1||(Q1={}));class Sre extends fs{constructor(e,r,n){super(),this.operator=e,this.variable=r,this.value=n}get astNodeType(){return"assign"}search(e){this.variable.search(e),this.value.search(e)}}class QL extends fs{constructor(e,r){super(),this.name=e,this.args=r}get astNodeType(){return"call"}isBuiltin(){return _re.has(this.name)}search(e){for(const r of this.args)r.search(e);e(this)}}class Ere extends fs{constructor(e,r){super(),this.body=e,this.continuing=r}get astNodeType(){return"loop"}search(e){var r;this.searchBlock(this.body,e),(r=this.continuing)===null||r===void 0||r.search(e)}}class Tre extends fs{constructor(e,r){super(),this.condition=e,this.cases=r}get astNodeType(){return"switch"}search(e){e(this);for(const r of this.cases)r.search(e)}}class Cre extends fs{constructor(e,r,n,i){super(),this.condition=e,this.body=r,this.elseif=n,this.else=i}get astNodeType(){return"if"}search(e){this.condition.search(e),this.searchBlock(this.body,e),this.searchBlock(this.elseif,e),this.searchBlock(this.else,e)}}class Are extends fs{constructor(e){super(),this.value=e}get astNodeType(){return"return"}search(e){var r;(r=this.value)===null||r===void 0||r.search(e)}}class o7e extends fs{constructor(e){super(),this.name=e}get astNodeType(){return"enable"}}class s7e extends fs{constructor(e){super(),this.extensions=e}get astNodeType(){return"requires"}}class Ire extends fs{constructor(e,r){super(),this.severity=e,this.rule=r}get astNodeType(){return"diagnostic"}}class e6 extends fs{constructor(e,r){super(),this.name=e,this.type=r}get astNodeType(){return"alias"}}class l7e extends fs{constructor(){super()}get astNodeType(){return"discard"}}class Pre extends fs{constructor(){super(),this.condition=null,this.loopId=-1}get astNodeType(){return"break"}}class kre extends fs{constructor(){super(),this.loopId=-1}get astNodeType(){return"continue"}}class Kr extends fs{constructor(e){super(),this.attributes=null,this.name=e}get astNodeType(){return"type"}get isStruct(){return!1}get isArray(){return!1}static maxFormatType(e){let r=e[0];if(r.name==="f32")return r;for(let n=1;n<e.length;++n){const i=Kr._priority.get(r.name);Kr._priority.get(e[n].name)<i&&(r=e[n])}return r.name==="x32"?Kr.i32:r}getTypeName(){return this.name}}Kr.x32=new Kr("x32"),Kr.f32=new Kr("f32"),Kr.i32=new Kr("i32"),Kr.u32=new Kr("u32"),Kr.f16=new Kr("f16"),Kr.bool=new Kr("bool"),Kr.void=new Kr("void"),Kr._priority=new Map([["f32",0],["f16",1],["u32",2],["i32",3],["x32",3]]);class SG extends Kr{constructor(e){super(e)}}class op extends Kr{constructor(e,r,n,i){super(e),this.members=r,this.startLine=n,this.endLine=i}get astNodeType(){return"struct"}get isStruct(){return!0}getMemberIndex(e){for(let r=0;r<this.members.length;r++)if(this.members[r].name==e)return r;return-1}search(e){for(const r of this.members)e(r)}}class fr extends Kr{constructor(e,r,n){super(e),this.format=r,this.access=n}get astNodeType(){return"template"}getTypeName(){let e=this.name;if(this.format!==null){if(e==="vec2"||e==="vec3"||e==="vec4"||e==="mat2x2"||e==="mat2x3"||e==="mat2x4"||e==="mat3x2"||e==="mat3x3"||e==="mat3x4"||e==="mat4x2"||e==="mat4x3"||e==="mat4x4"){if(this.format.name==="f32")return e+="f",e;if(this.format.name==="i32")return e+="i",e;if(this.format.name==="u32")return e+="u",e;if(this.format.name==="bool")return e+="b",e;if(this.format.name==="f16")return e+="h",e}e+=`<${this.format.name}>`}else if(e==="vec2"||e==="vec3"||e==="vec4")return e;return e}}fr.vec2f=new fr("vec2",Kr.f32,null),fr.vec3f=new fr("vec3",Kr.f32,null),fr.vec4f=new fr("vec4",Kr.f32,null),fr.vec2i=new fr("vec2",Kr.i32,null),fr.vec3i=new fr("vec3",Kr.i32,null),fr.vec4i=new fr("vec4",Kr.i32,null),fr.vec2u=new fr("vec2",Kr.u32,null),fr.vec3u=new fr("vec3",Kr.u32,null),fr.vec4u=new fr("vec4",Kr.u32,null),fr.vec2h=new fr("vec2",Kr.f16,null),fr.vec3h=new fr("vec3",Kr.f16,null),fr.vec4h=new fr("vec4",Kr.f16,null),fr.vec2b=new fr("vec2",Kr.bool,null),fr.vec3b=new fr("vec3",Kr.bool,null),fr.vec4b=new fr("vec4",Kr.bool,null),fr.mat2x2f=new fr("mat2x2",Kr.f32,null),fr.mat2x3f=new fr("mat2x3",Kr.f32,null),fr.mat2x4f=new fr("mat2x4",Kr.f32,null),fr.mat3x2f=new fr("mat3x2",Kr.f32,null),fr.mat3x3f=new fr("mat3x3",Kr.f32,null),fr.mat3x4f=new fr("mat3x4",Kr.f32,null),fr.mat4x2f=new fr("mat4x2",Kr.f32,null),fr.mat4x3f=new fr("mat4x3",Kr.f32,null),fr.mat4x4f=new fr("mat4x4",Kr.f32,null),fr.mat2x2h=new fr("mat2x2",Kr.f16,null),fr.mat2x3h=new fr("mat2x3",Kr.f16,null),fr.mat2x4h=new fr("mat2x4",Kr.f16,null),fr.mat3x2h=new fr("mat3x2",Kr.f16,null),fr.mat3x3h=new fr("mat3x3",Kr.f16,null),fr.mat3x4h=new fr("mat3x4",Kr.f16,null),fr.mat4x2h=new fr("mat4x2",Kr.f16,null),fr.mat4x3h=new fr("mat4x3",Kr.f16,null),fr.mat4x4h=new fr("mat4x4",Kr.f16,null),fr.mat2x2i=new fr("mat2x2",Kr.i32,null),fr.mat2x3i=new fr("mat2x3",Kr.i32,null),fr.mat2x4i=new fr("mat2x4",Kr.i32,null),fr.mat3x2i=new fr("mat3x2",Kr.i32,null),fr.mat3x3i=new fr("mat3x3",Kr.i32,null),fr.mat3x4i=new fr("mat3x4",Kr.i32,null),fr.mat4x2i=new fr("mat4x2",Kr.i32,null),fr.mat4x3i=new fr("mat4x3",Kr.i32,null),fr.mat4x4i=new fr("mat4x4",Kr.i32,null),fr.mat2x2u=new fr("mat2x2",Kr.u32,null),fr.mat2x3u=new fr("mat2x3",Kr.u32,null),fr.mat2x4u=new fr("mat2x4",Kr.u32,null),fr.mat3x2u=new fr("mat3x2",Kr.u32,null),fr.mat3x3u=new fr("mat3x3",Kr.u32,null),fr.mat3x4u=new fr("mat3x4",Kr.u32,null),fr.mat4x2u=new fr("mat4x2",Kr.u32,null),fr.mat4x3u=new fr("mat4x3",Kr.u32,null),fr.mat4x4u=new fr("mat4x4",Kr.u32,null);class MS extends Kr{constructor(e,r,n,i){super(e),this.storage=r,this.type=n,this.access=i}get astNodeType(){return"pointer"}}class Cb extends Kr{constructor(e,r,n,i){super(e),this.attributes=r,this.format=n,this.count=i}get astNodeType(){return"array"}get isArray(){return!0}}class eb extends Kr{constructor(e,r,n){super(e),this.format=r,this.access=n}get astNodeType(){return"sampler"}}class Bh extends eh{constructor(){super(),this.postfix=null}}class gy extends Bh{constructor(e){super(),this.value=e}get astNodeType(){return"stringExpr"}toString(){return this.value}constEvaluateString(){return this.value}}class sd extends Bh{constructor(e,r){super(),this.type=e,this.args=r}get astNodeType(){return"createExpr"}search(e){if(e(this),this.args)for(const r of this.args)r.search(e)}constEvaluate(e,r){return r&&(r[0]=this.type),e.evalExpression(this,e.context)}}class t6 extends Bh{constructor(e,r){super(),this.cachedReturnValue=null,this.name=e,this.args=r}get astNodeType(){return"callExpr"}setCachedReturnValue(e){this.cachedReturnValue=e}get isBuiltin(){return _re.has(this.name)}constEvaluate(e,r){return e.evalExpression(this,e.context)}search(e){for(const r of this.args)r.search(e);e(this)}}class af extends Bh{constructor(e){super(),this.name=e}get astNodeType(){return"varExpr"}search(e){e(this),this.postfix&&this.postfix.search(e)}constEvaluate(e,r){return e.evalExpression(this,e.context)}}class Rre extends Bh{constructor(e,r){super(),this.name=e,this.initializer=r}get astNodeType(){return"constExpr"}constEvaluate(e,r){if(this.initializer){const n=e.evalExpression(this.initializer,e.context);return n!==null&&this.postfix?n.getSubData(e,this.postfix,e.context):n}return null}search(e){this.initializer.search(e)}}class Ol extends Bh{constructor(e,r){super(),this.value=e,this.type=r}get astNodeType(){return"literalExpr"}constEvaluate(e,r){return r!==void 0&&(r[0]=this.type),this.value}get isScalar(){return this.value instanceof ir}get isVector(){return this.value instanceof kt||this.value instanceof Ii}get scalarValue(){return this.value instanceof ir?this.value.value:(console.error("Value is not scalar."),0)}get vectorValue(){return this.value instanceof kt||this.value instanceof Ii?this.value.data:(console.error("Value is not a vector or matrix."),new Float32Array(0))}}class Mre extends Bh{constructor(e,r){super(),this.type=e,this.value=r}get astNodeType(){return"bitcastExpr"}search(e){this.value.search(e)}}class i_ extends Bh{constructor(e){super(),this.index=e}search(e){this.index.search(e)}}class Dre extends Bh{constructor(){super()}}class wl extends Dre{constructor(e,r){super(),this.operator=e,this.right=r}get astNodeType(){return"unaryOp"}constEvaluate(e,r){return e.evalExpression(this,e.context)}search(e){this.right.search(e)}}class yh extends Dre{constructor(e,r,n){super(),this.operator=e,this.left=r,this.right=n}get astNodeType(){return"binaryOp"}_getPromotedType(e,r){return e.name===r.name?e:e.name==="f32"||r.name==="f32"?Kr.f32:e.name==="u32"||r.name==="u32"?Kr.u32:Kr.i32}constEvaluate(e,r){return e.evalExpression(this,e.context)}search(e){this.left.search(e),this.right.search(e)}}class Ore extends eh{constructor(e){super(),this.body=e}search(e){e(this),this.searchBlock(this.body,e)}}class DS extends Bh{constructor(){super()}get astNodeType(){return"default"}}class Nre extends Ore{constructor(e,r){super(r),this.selectors=e}get astNodeType(){return"case"}search(e){this.searchBlock(this.body,e)}}class Lre extends Ore{constructor(e){super(e)}get astNodeType(){return"default"}search(e){this.searchBlock(this.body,e)}}class EG extends eh{constructor(e,r,n){super(),this.name=e,this.type=r,this.attributes=n}get astNodeType(){return"argument"}}class u7e extends eh{constructor(e,r){super(),this.condition=e,this.body=r}get astNodeType(){return"elseif"}search(e){this.condition.search(e),this.searchBlock(this.body,e)}}class TG extends eh{constructor(e,r,n){super(),this.name=e,this.type=r,this.attributes=n}get astNodeType(){return"member"}}class Fre extends eh{constructor(e,r){super(),this.name=e,this.value=r}get astNodeType(){return"attribute"}}class Kf{constructor(e,r){this.parent=null,this.typeInfo=e,this.parent=r,this.id=Kf._id++}clone(){throw`Clone: Not implemented for ${this.constructor.name}`}setDataValue(e,r,n,i){console.error(`SetDataValue: Not implemented for ${this.constructor.name}`)}getSubData(e,r,n){return console.error(`GetDataValue: Not implemented for ${this.constructor.name}`),null}toString(){return`<${this.typeInfo.getTypeName()}>`}}Kf._id=0;class iD extends Kf{constructor(){super(new Vf("void",null),null)}toString(){return"void"}}iD.void=new iD;class Rv extends Kf{constructor(e){super(new rD("pointer",e.typeInfo,null),null),this.reference=e}clone(){return this}setDataValue(e,r,n,i){this.reference.setDataValue(e,r,n,i)}getSubData(e,r,n){return r?this.reference.getSubData(e,r,n):this}toString(){return`&${this.reference.toString()}`}}class ir extends Kf{constructor(e,r,n=null){super(r,n),e instanceof Int32Array||e instanceof Uint32Array||e instanceof Float32Array?this.data=e:this.typeInfo.name==="x32"?e-Math.floor(e)!==0?this.data=new Float32Array([e]):this.data=e>=0?new Uint32Array([e]):new Int32Array([e]):this.typeInfo.name==="i32"||this.typeInfo.name==="bool"?this.data=new Int32Array([e]):this.typeInfo.name==="u32"?this.data=new Uint32Array([e]):this.typeInfo.name==="f32"||this.typeInfo.name==="f16"?this.data=new Float32Array([e]):console.error("ScalarData2: Invalid type",r)}clone(){if(this.data instanceof Float32Array)return new ir(new Float32Array(this.data),this.typeInfo,null);if(this.data instanceof Int32Array)return new ir(new Int32Array(this.data),this.typeInfo,null);if(this.data instanceof Uint32Array)return new ir(new Uint32Array(this.data),this.typeInfo,null);throw"ScalarData: Invalid data type"}get value(){return this.data[0]}set value(e){this.data[0]=e}setDataValue(e,r,n,i){if(n)return void console.error("SetDataValue: Scalar data does not support postfix",n);if(!(r instanceof ir))return void console.error("SetDataValue: Invalid value",r);let a=r.data[0];this.typeInfo.name==="i32"||this.typeInfo.name==="u32"?a=Math.floor(a):this.typeInfo.name==="bool"&&(a=a?1:0),this.data[0]=a}getSubData(e,r,n){return r?(console.error("getSubData: Scalar data does not support postfix",r),null):this}toString(){return`${this.value}`}}function c7e(t,e,r){const n=e.length;return n===2?r==="f32"?new kt(new Float32Array(e),t.getTypeInfo("vec2f")):r==="i32"||r==="bool"?new kt(new Int32Array(e),t.getTypeInfo("vec2i")):r==="u32"?new kt(new Uint32Array(e),t.getTypeInfo("vec2u")):r==="f16"?new kt(new Float32Array(e),t.getTypeInfo("vec2h")):(console.error(`getSubData: Unknown format ${r}`),null):n===3?r==="f32"?new kt(new Float32Array(e),t.getTypeInfo("vec3f")):r==="i32"||r==="bool"?new kt(new Int32Array(e),t.getTypeInfo("vec3i")):r==="u32"?new kt(new Uint32Array(e),t.getTypeInfo("vec3u")):r==="f16"?new kt(new Float32Array(e),t.getTypeInfo("vec3h")):(console.error(`getSubData: Unknown format ${r}`),null):n===4?r==="f32"?new kt(new Float32Array(e),t.getTypeInfo("vec4f")):r==="i32"||r==="bool"?new kt(new Int32Array(e),t.getTypeInfo("vec4i")):r==="u32"?new kt(new Uint32Array(e),t.getTypeInfo("vec4u")):r==="f16"?new kt(new Float32Array(e),t.getTypeInfo("vec4h")):(console.error(`getSubData: Unknown format ${r}`),null):(console.error(`getSubData: Invalid vector size ${e.length}`),null)}class kt extends Kf{constructor(e,r,n=null){if(super(r,n),e instanceof Float32Array||e instanceof Uint32Array||e instanceof Int32Array)this.data=e;else{const i=this.typeInfo.name;i==="vec2f"||i==="vec3f"||i==="vec4f"?this.data=new Float32Array(e):i==="vec2i"||i==="vec3i"||i==="vec4i"?this.data=new Int32Array(e):i==="vec2u"||i==="vec3u"||i==="vec4u"?this.data=new Uint32Array(e):i==="vec2h"||i==="vec3h"||i==="vec4h"?this.data=new Float32Array(e):i==="vec2b"||i==="vec3b"||i==="vec4b"?this.data=new Int32Array(e):i==="vec2"||i==="vec3"||i==="vec4"?this.data=new Float32Array(e):console.error(`VectorData: Invalid type ${i}`)}}clone(){if(this.data instanceof Float32Array)return new kt(new Float32Array(this.data),this.typeInfo,null);if(this.data instanceof Int32Array)return new kt(new Int32Array(this.data),this.typeInfo,null);if(this.data instanceof Uint32Array)return new kt(new Uint32Array(this.data),this.typeInfo,null);throw"VectorData: Invalid data type"}setDataValue(e,r,n,i){n instanceof gy?console.error("TODO: Set vector postfix"):r instanceof kt?this.data=r.data:console.error("SetDataValue: Invalid value",r)}getSubData(e,r,n){if(r===null)return this;let i=e.getTypeInfo("f32");if(this.typeInfo instanceof py)i=this.typeInfo.format||i;else{const s=this.typeInfo.name;s==="vec2f"||s==="vec3f"||s==="vec4f"?i=e.getTypeInfo("f32"):s==="vec2i"||s==="vec3i"||s==="vec4i"?i=e.getTypeInfo("i32"):s==="vec2b"||s==="vec3b"||s==="vec4b"?i=e.getTypeInfo("bool"):s==="vec2u"||s==="vec3u"||s==="vec4u"?i=e.getTypeInfo("u32"):s==="vec2h"||s==="vec3h"||s==="vec4h"?i=e.getTypeInfo("f16"):console.error(`GetSubData: Unknown type ${s}`)}let a=this;for(;r!==null&&a!==null;){if(r instanceof i_){const s=r.index;let o=-1;if(s instanceof Ol){if(!(s.value instanceof ir))return console.error(`GetSubData: Invalid array index ${s.value}`),null;o=s.value.value}else{const c=e.evalExpression(s,n);if(!(c instanceof ir))return console.error("GetSubData: Unknown index type",s),null;o=c.value}if(o<0||o>=a.data.length)return console.error("GetSubData: Index out of range",o),null;if(a.data instanceof Float32Array){const c=new Float32Array(a.data.buffer,a.data.byteOffset+4*o,1);return new ir(c,i)}if(a.data instanceof Int32Array){const c=new Int32Array(a.data.buffer,a.data.byteOffset+4*o,1);return new ir(c,i)}if(a.data instanceof Uint32Array){const c=new Uint32Array(a.data.buffer,a.data.byteOffset+4*o,1);return new ir(c,i)}throw"GetSubData: Invalid data type"}if(!(r instanceof gy))return console.error("GetSubData: Unknown postfix",r),null;{const s=r.value.toLowerCase();if(s.length===1){let c=0;if(s==="x"||s==="r")c=0;else if(s==="y"||s==="g")c=1;else if(s==="z"||s==="b")c=2;else{if(s!=="w"&&s!=="a")return console.error(`GetSubData: Unknown member ${s}`),null;c=3}if(this.data instanceof Float32Array){let f=new Float32Array(this.data.buffer,this.data.byteOffset+4*c,1);return new ir(f,i,this)}if(this.data instanceof Int32Array){let f=new Int32Array(this.data.buffer,this.data.byteOffset+4*c,1);return new ir(f,i,this)}if(this.data instanceof Uint32Array){let f=new Uint32Array(this.data.buffer,this.data.byteOffset+4*c,1);return new ir(f,i,this)}}const o=[];for(const c of s)c==="x"||c==="r"?o.push(this.data[0]):c==="y"||c==="g"?o.push(this.data[1]):c==="z"||c==="b"?o.push(this.data[2]):c==="w"||c==="a"?o.push(this.data[3]):console.error(`GetDataValue: Unknown member ${c}`);a=c7e(e,o,i.name)}r=r.postfix}return a}toString(){let e=`${this.data[0]}`;for(let r=1;r<this.data.length;++r)e+=`, ${this.data[r]}`;return e}}class Ii extends Kf{constructor(e,r,n=null){super(r,n),e instanceof Float32Array?this.data=e:this.data=new Float32Array(e)}clone(){return new Ii(new Float32Array(this.data),this.typeInfo,null)}setDataValue(e,r,n,i){n instanceof gy?console.error("TODO: Set matrix postfix"):r instanceof Ii?this.data=r.data:console.error("SetDataValue: Invalid value",r)}getSubData(e,r,n){if(r===null)return this;const i=this.typeInfo.name;if(e.getTypeInfo("f32"),this.typeInfo instanceof py)this.typeInfo.format;else if(i.endsWith("f"))e.getTypeInfo("f32");else if(i.endsWith("i"))e.getTypeInfo("i32");else if(i.endsWith("u"))e.getTypeInfo("u32");else{if(!i.endsWith("h"))return console.error(`GetDataValue: Unknown type ${i}`),null;e.getTypeInfo("f16")}if(r instanceof i_){const a=r.index;let s=-1;if(a instanceof Ol){if(!(a.value instanceof ir))return console.error(`GetDataValue: Invalid array index ${a.value}`),null;s=a.value.value}else{const f=e.evalExpression(a,n);if(!(f instanceof ir))return console.error("GetDataValue: Unknown index type",a),null;s=f.value}if(s<0||s>=this.data.length)return console.error("GetDataValue: Index out of range",s),null;const o=i.endsWith("h")?"h":"f";let c;if(i==="mat2x2"||i==="mat2x2f"||i==="mat2x2h"||i==="mat3x2"||i==="mat3x2f"||i==="mat3x2h"||i==="mat4x2"||i==="mat4x2f"||i==="mat4x2h")c=new kt(new Float32Array(this.data.buffer,this.data.byteOffset+2*s*4,2),e.getTypeInfo(`vec2${o}`));else if(i==="mat2x3"||i==="mat2x3f"||i==="mat2x3h"||i==="mat3x3"||i==="mat3x3f"||i==="mat3x3h"||i==="mat4x3"||i==="mat4x3f"||i==="mat4x3h")c=new kt(new Float32Array(this.data.buffer,this.data.byteOffset+3*s*4,3),e.getTypeInfo(`vec3${o}`));else{if(i!=="mat2x4"&&i!=="mat2x4f"&&i!=="mat2x4h"&&i!=="mat3x4"&&i!=="mat3x4f"&&i!=="mat3x4h"&&i!=="mat4x4"&&i!=="mat4x4f"&&i!=="mat4x4h")return console.error(`GetDataValue: Unknown type ${i}`),null;c=new kt(new Float32Array(this.data.buffer,this.data.byteOffset+4*s*4,4),e.getTypeInfo(`vec4${o}`))}return r.postfix?c.getSubData(e,r.postfix,n):c}return console.error("GetDataValue: Invalid postfix",r),null}toString(){let e=`${this.data[0]}`;for(let r=1;r<this.data.length;++r)e+=`, ${this.data[r]}`;return e}}class js extends Kf{constructor(e,r,n=0,i=null){super(r,i),this.buffer=e instanceof ArrayBuffer?e:e.buffer,this.offset=n}clone(){const e=new Uint8Array(new Uint8Array(this.buffer,this.offset,this.typeInfo.size));return new js(e.buffer,this.typeInfo,0,null)}setDataValue(e,r,n,i){if(r===null)return void console.log("setDataValue: NULL data.");let a=this.offset,s=this.typeInfo;for(;n;){if(n instanceof i_)if(s instanceof wg){const o=n.index;if(o instanceof Ol){if(!(o.value instanceof ir))return void console.error(`SetDataValue: Invalid index type ${o.value}`);a+=o.value.value*s.stride}else{const c=e.evalExpression(o,i);if(!(c instanceof ir))return void console.error("SetDataValue: Unknown index type",o);a+=c.value*s.stride}s=s.format}else console.error(`SetDataValue: Type ${s.getTypeName()} is not an array`);else{if(!(n instanceof gy))return void console.error("SetDataValue: Unknown postfix type",n);{const o=n.value;if(s instanceof mg){let c=!1;for(const f of s.members)if(f.name===o){a+=f.offset,s=f.type,c=!0;break}if(!c)return void console.error(`SetDataValue: Member ${o} not found`)}else if(s instanceof Vf){const c=s.getTypeName();let f=0;if(o==="x"||o==="r")f=0;else if(o==="y"||o==="g")f=1;else if(o==="z"||o==="b")f=2;else{if(o!=="w"&&o!=="a")return void console.error(`SetDataValue: Unknown member ${o}`);f=3}if(!(r instanceof ir))return void console.error("SetDataValue: Invalid value",r);const d=r.value;return c==="vec2f"?void(new Float32Array(this.buffer,a,2)[f]=d):c==="vec3f"?void(new Float32Array(this.buffer,a,3)[f]=d):c==="vec4f"?void(new Float32Array(this.buffer,a,4)[f]=d):c==="vec2i"?void(new Int32Array(this.buffer,a,2)[f]=d):c==="vec3i"?void(new Int32Array(this.buffer,a,3)[f]=d):c==="vec4i"?void(new Int32Array(this.buffer,a,4)[f]=d):c==="vec2u"?void(new Uint32Array(this.buffer,a,2)[f]=d):c==="vec3u"?void(new Uint32Array(this.buffer,a,3)[f]=d):c==="vec4u"?void(new Uint32Array(this.buffer,a,4)[f]=d):void console.error(`SetDataValue: Type ${c} is not a struct`)}}}n=n.postfix}this.setData(e,r,s,a,i)}setData(e,r,n,i,a){const s=n.getTypeName();if(s!=="f32"&&s!=="f16")if(s!=="i32"&&s!=="atomic<i32>"&&s!=="x32")if(s!=="u32"&&s!=="atomic<u32>")if(s!=="bool"){if(s==="vec2f"||s==="vec2h"){const o=new Float32Array(this.buffer,i,2);return void(r instanceof kt?(o[0]=r.data[0],o[1]=r.data[1]):(o[0]=r[0],o[1]=r[1]))}if(s==="vec3f"||s==="vec3h"){const o=new Float32Array(this.buffer,i,3);return void(r instanceof kt?(o[0]=r.data[0],o[1]=r.data[1],o[2]=r.data[2]):(o[0]=r[0],o[1]=r[1],o[2]=r[2]))}if(s==="vec4f"||s==="vec4h"){const o=new Float32Array(this.buffer,i,4);return void(r instanceof kt?(o[0]=r.data[0],o[1]=r.data[1],o[2]=r.data[2],o[3]=r.data[3]):(o[0]=r[0],o[1]=r[1],o[2]=r[2],o[3]=r[3]))}if(s==="vec2i"){const o=new Int32Array(this.buffer,i,2);return void(r instanceof kt?(o[0]=r.data[0],o[1]=r.data[1]):(o[0]=r[0],o[1]=r[1]))}if(s==="vec3i"){const o=new Int32Array(this.buffer,i,3);return void(r instanceof kt?(o[0]=r.data[0],o[1]=r.data[1],o[2]=r.data[2]):(o[0]=r[0],o[1]=r[1],o[2]=r[2]))}if(s==="vec4i"){const o=new Int32Array(this.buffer,i,4);return void(r instanceof kt?(o[0]=r.data[0],o[1]=r.data[1],o[2]=r.data[2],o[3]=r.data[3]):(o[0]=r[0],o[1]=r[1],o[2]=r[2],o[3]=r[3]))}if(s==="vec2u"){const o=new Uint32Array(this.buffer,i,2);return void(r instanceof kt?(o[0]=r.data[0],o[1]=r.data[1]):(o[0]=r[0],o[1]=r[1]))}if(s==="vec3u"){const o=new Uint32Array(this.buffer,i,3);return void(r instanceof kt?(o[0]=r.data[0],o[1]=r.data[1],o[2]=r.data[2]):(o[0]=r[0],o[1]=r[1],o[2]=r[2]))}if(s==="vec4u"){const o=new Uint32Array(this.buffer,i,4);return void(r instanceof kt?(o[0]=r.data[0],o[1]=r.data[1],o[2]=r.data[2],o[3]=r.data[3]):(o[0]=r[0],o[1]=r[1],o[2]=r[2],o[3]=r[3]))}if(s==="vec2b"){const o=new Uint32Array(this.buffer,i,2);return void(r instanceof kt?(o[0]=r.data[0],o[1]=r.data[1]):(o[0]=r[0],o[1]=r[1]))}if(s==="vec3b"){const o=new Uint32Array(this.buffer,i,3);return void(r instanceof kt?(o[0]=r.data[0],o[1]=r.data[1],o[2]=r.data[2]):(o[0]=r[0],o[1]=r[1],o[2]=r[2]))}if(s==="vec4b"){const o=new Uint32Array(this.buffer,i,4);return void(r instanceof kt?(o[0]=r.data[0],o[1]=r.data[1],o[2]=r.data[2],o[3]=r.data[3]):(o[0]=r[0],o[1]=r[1],o[2]=r[2],o[3]=r[3]))}if(s==="mat2x2f"||s==="mat2x2h"){const o=new Float32Array(this.buffer,i,4);return void(r instanceof Ii?(o[0]=r.data[0],o[1]=r.data[1],o[2]=r.data[2],o[3]=r.data[3]):(o[0]=r[0],o[1]=r[1],o[2]=r[2],o[3]=r[3]))}if(s==="mat2x3f"||s==="mat2x3h"){const o=new Float32Array(this.buffer,i,6);return void(r instanceof Ii?(o[0]=r.data[0],o[1]=r.data[1],o[2]=r.data[2],o[3]=r.data[3],o[4]=r.data[4],o[5]=r.data[5]):(o[0]=r[0],o[1]=r[1],o[2]=r[2],o[3]=r[3],o[4]=r[4],o[5]=r[5]))}if(s==="mat2x4f"||s==="mat2x4h"){const o=new Float32Array(this.buffer,i,8);return void(r instanceof Ii?(o[0]=r.data[0],o[1]=r.data[1],o[2]=r.data[2],o[3]=r.data[3],o[4]=r.data[4],o[5]=r.data[5],o[6]=r.data[6],o[7]=r.data[7]):(o[0]=r[0],o[1]=r[1],o[2]=r[2],o[3]=r[3],o[4]=r[4],o[5]=r[5],o[6]=r[6],o[7]=r[7]))}if(s==="mat3x2f"||s==="mat3x2h"){const o=new Float32Array(this.buffer,i,6);return void(r instanceof Ii?(o[0]=r.data[0],o[1]=r.data[1],o[2]=r.data[2],o[3]=r.data[3],o[4]=r.data[4],o[5]=r.data[5]):(o[0]=r[0],o[1]=r[1],o[2]=r[2],o[3]=r[3],o[4]=r[4],o[5]=r[5]))}if(s==="mat3x3f"||s==="mat3x3h"){const o=new Float32Array(this.buffer,i,9);return void(r instanceof Ii?(o[0]=r.data[0],o[1]=r.data[1],o[2]=r.data[2],o[3]=r.data[3],o[4]=r.data[4],o[5]=r.data[5],o[6]=r.data[6],o[7]=r.data[7],o[8]=r.data[8]):(o[0]=r[0],o[1]=r[1],o[2]=r[2],o[3]=r[3],o[4]=r[4],o[5]=r[5],o[6]=r[6],o[7]=r[7],o[8]=r[8]))}if(s==="mat3x4f"||s==="mat3x4h"){const o=new Float32Array(this.buffer,i,12);return void(r instanceof Ii?(o[0]=r.data[0],o[1]=r.data[1],o[2]=r.data[2],o[3]=r.data[3],o[4]=r.data[4],o[5]=r.data[5],o[6]=r.data[6],o[7]=r.data[7],o[8]=r.data[8],o[9]=r.data[9],o[10]=r.data[10],o[11]=r.data[11]):(o[0]=r[0],o[1]=r[1],o[2]=r[2],o[3]=r[3],o[4]=r[4],o[5]=r[5],o[6]=r[6],o[7]=r[7],o[8]=r[8],o[9]=r[9],o[10]=r[10],o[11]=r[11]))}if(s==="mat4x2f"||s==="mat4x2h"){const o=new Float32Array(this.buffer,i,8);return void(r instanceof Ii?(o[0]=r.data[0],o[1]=r.data[1],o[2]=r.data[2],o[3]=r.data[3],o[4]=r.data[4],o[5]=r.data[5],o[6]=r.data[6],o[7]=r.data[7]):(o[0]=r[0],o[1]=r[1],o[2]=r[2],o[3]=r[3],o[4]=r[4],o[5]=r[5],o[6]=r[6],o[7]=r[7]))}if(s==="mat4x3f"||s==="mat4x3h"){const o=new Float32Array(this.buffer,i,12);return void(r instanceof Ii?(o[0]=r.data[0],o[1]=r.data[1],o[2]=r.data[2],o[3]=r.data[3],o[4]=r.data[4],o[5]=r.data[5],o[6]=r.data[6],o[7]=r.data[7],o[8]=r.data[8],o[9]=r.data[9],o[10]=r.data[10],o[11]=r.data[11]):(o[0]=r[0],o[1]=r[1],o[2]=r[2],o[3]=r[3],o[4]=r[4],o[5]=r[5],o[6]=r[6],o[7]=r[7],o[8]=r[8],o[9]=r[9],o[10]=r[10],o[11]=r[11]))}if(s==="mat4x4f"||s==="mat4x4h"){const o=new Float32Array(this.buffer,i,16);return void(r instanceof Ii?(o[0]=r.data[0],o[1]=r.data[1],o[2]=r.data[2],o[3]=r.data[3],o[4]=r.data[4],o[5]=r.data[5],o[6]=r.data[6],o[7]=r.data[7],o[8]=r.data[8],o[9]=r.data[9],o[10]=r.data[10],o[11]=r.data[11],o[12]=r.data[12],o[13]=r.data[13],o[14]=r.data[14],o[15]=r.data[15]):(o[0]=r[0],o[1]=r[1],o[2]=r[2],o[3]=r[3],o[4]=r[4],o[5]=r[5],o[6]=r[6],o[7]=r[7],o[8]=r[8],o[9]=r[9],o[10]=r[10],o[11]=r[11],o[12]=r[12],o[13]=r[13],o[14]=r[14],o[15]=r[15]))}if(r instanceof js){if(n===r.typeInfo)return void new Uint8Array(this.buffer,i,r.buffer.byteLength).set(new Uint8Array(r.buffer));console.error("SetDataValue: Type mismatch",s,r.typeInfo.getTypeName())}else console.error(`SetData: Unknown type ${s}`)}else r instanceof ir&&(new Int32Array(this.buffer,i,1)[0]=r.value);else r instanceof ir&&(new Uint32Array(this.buffer,i,1)[0]=r.value);else r instanceof ir&&(new Int32Array(this.buffer,i,1)[0]=r.value);else r instanceof ir&&(new Float32Array(this.buffer,i,1)[0]=r.value)}getSubData(e,r,n){var i,a,s;if(r===null)return this;let o=this.offset,c=this.typeInfo;for(;r;){if(r instanceof i_){const d=r.index,m=d instanceof Bh?e.evalExpression(d,n):d;let b=0;if(m instanceof ir?b=m.value:typeof m=="number"?b=m:console.error("GetDataValue: Invalid index type",d),c instanceof wg)o+=b*c.stride,c=c.format;else{const x=c.getTypeName();x==="mat4x4"||x==="mat4x4f"||x==="mat4x4h"?(o+=16*b,c=e.getTypeInfo("vec4f")):console.error(`getDataValue: Type ${c.getTypeName()} is not an array`)}}else{if(!(r instanceof gy))return console.error("GetDataValue: Unknown postfix type",r),null;{const d=r.value;if(c instanceof mg){let m=!1;for(const b of c.members)if(b.name===d){o+=b.offset,c=b.type,m=!0;break}if(!m)return console.error(`GetDataValue: Member ${d} not found`),null}else if(c instanceof Vf){const m=c.getTypeName();if(m==="vec2f"||m==="vec3f"||m==="vec4f"||m==="vec2i"||m==="vec3i"||m==="vec4i"||m==="vec2u"||m==="vec3u"||m==="vec4u"||m==="vec2b"||m==="vec3b"||m==="vec4b"||m==="vec2h"||m==="vec3h"||m==="vec4h"||m==="vec2"||m==="vec3"||m==="vec4"){if(d.length>0&&d.length<5){let b="f";const x=[];for(let E=0;E<d.length;++E){const T=d[E].toLowerCase();let A=0;if(T==="x"||T==="r")A=0;else if(T==="y"||T==="g")A=1;else if(T==="z"||T==="b")A=2;else{if(T!=="w"&&T!=="a")return console.error(`Unknown member ${d}`),null;A=3}if(d.length===1){if(m.endsWith("f"))return this.buffer.byteLength<o+4*A+4?(console.log("Insufficient buffer data"),null):new ir(new Float32Array(this.buffer,o+4*A,1),e.getTypeInfo("f32"),this);if(m.endsWith("h"))return new ir(new Float32Array(this.buffer,o+4*A,1),e.getTypeInfo("f16"),this);if(m.endsWith("i"))return new ir(new Int32Array(this.buffer,o+4*A,1),e.getTypeInfo("i32"),this);if(m.endsWith("b"))return new ir(new Int32Array(this.buffer,o+4*A,1),e.getTypeInfo("bool"),this);if(m.endsWith("u"))return new ir(new Uint32Array(this.buffer,o+4*A,1),e.getTypeInfo("i32"),this)}if(m==="vec2f")x.push(new Float32Array(this.buffer,o,2)[A]);else if(m==="vec3f"){if(o+12>=this.buffer.byteLength)return console.log("Insufficient buffer data"),null;const M=new Float32Array(this.buffer,o,3);x.push(M[A])}else if(m==="vec4f")x.push(new Float32Array(this.buffer,o,4)[A]);else if(m==="vec2i")b="i",x.push(new Int32Array(this.buffer,o,2)[A]);else if(m==="vec3i")b="i",x.push(new Int32Array(this.buffer,o,3)[A]);else if(m==="vec4i")b="i",x.push(new Int32Array(this.buffer,o,4)[A]);else if(m==="vec2u"){b="u";const M=new Uint32Array(this.buffer,o,2);x.push(M[A])}else m==="vec3u"?(b="u",x.push(new Uint32Array(this.buffer,o,3)[A])):m==="vec4u"&&(b="u",x.push(new Uint32Array(this.buffer,o,4)[A]))}return x.length===2?c=e.getTypeInfo(`vec2${b}`):x.length===3?c=e.getTypeInfo(`vec3${b}`):x.length===4?c=e.getTypeInfo(`vec4${b}`):console.error(`GetDataValue: Invalid vector length ${x.length}`),new kt(x,c,null)}return console.error(`GetDataValue: Unknown member ${d}`),null}return console.error(`GetDataValue: Type ${m} is not a struct`),null}}}r=r.postfix}const f=c.getTypeName();return f==="f32"?new ir(new Float32Array(this.buffer,o,1),c,this):f==="i32"?new ir(new Int32Array(this.buffer,o,1),c,this):f==="u32"?new ir(new Uint32Array(this.buffer,o,1),c,this):f==="vec2f"?new kt(new Float32Array(this.buffer,o,2),c,this):f==="vec3f"?new kt(new Float32Array(this.buffer,o,3),c,this):f==="vec4f"?new kt(new Float32Array(this.buffer,o,4),c,this):f==="vec2i"?new kt(new Int32Array(this.buffer,o,2),c,this):f==="vec3i"?new kt(new Int32Array(this.buffer,o,3),c,this):f==="vec4i"?new kt(new Int32Array(this.buffer,o,4),c,this):f==="vec2u"?new kt(new Uint32Array(this.buffer,o,2),c,this):f==="vec3u"?new kt(new Uint32Array(this.buffer,o,3),c,this):f==="vec4u"?new kt(new Uint32Array(this.buffer,o,4),c,this):c instanceof py&&c.name==="atomic"?((i=c.format)===null||i===void 0?void 0:i.name)==="u32"?new ir(new Uint32Array(this.buffer,o,1)[0],c.format,this):((a=c.format)===null||a===void 0?void 0:a.name)==="i32"?new ir(new Int32Array(this.buffer,o,1)[0],c.format,this):(console.error(`GetDataValue: Invalid atomic format ${(s=c.format)===null||s===void 0?void 0:s.name}`),null):new js(this.buffer,c,o,this)}toString(){let e="";if(this.typeInfo instanceof wg)if(this.typeInfo.format.name==="f32"){const r=new Float32Array(this.buffer,this.offset);e=`[${r[0]}`;for(let n=1;n<r.length;++n)e+=`, ${r[n]}`}else if(this.typeInfo.format.name==="i32"){const r=new Int32Array(this.buffer,this.offset);e=`[${r[0]}`;for(let n=1;n<r.length;++n)e+=`, ${r[n]}`}else if(this.typeInfo.format.name==="u32"){const r=new Uint32Array(this.buffer,this.offset);e=`[${r[0]}`;for(let n=1;n<r.length;++n)e+=`, ${r[n]}`}else if(this.typeInfo.format.name==="vec2f"){const r=new Float32Array(this.buffer,this.offset);e=`[${r[0]}, ${r[1]}]`;for(let n=1;n<r.length/2;++n)e+=`, [${r[2*n]}, ${r[2*n+1]}]`}else if(this.typeInfo.format.name==="vec3f"){const r=new Float32Array(this.buffer,this.offset);e=`[${r[0]}, ${r[1]}, ${r[2]}]`;for(let n=4;n<r.length;n+=4)e+=`, [${r[n]}, ${r[n+1]}, ${r[n+2]}]`}else if(this.typeInfo.format.name==="vec4f"){const r=new Float32Array(this.buffer,this.offset);e=`[${r[0]}, ${r[1]}, ${r[2]}, ${r[3]}]`;for(let n=4;n<r.length;n+=4)e+=`, [${r[n]}, ${r[n+1]}, ${r[n+2]}, ${r[n+3]}]`}else e="[...]";else this.typeInfo instanceof mg?e+="{...}":e="[...]";return e}}class sp extends Kf{constructor(e,r,n,i){super(r,null),this.data=e,this.descriptor=n,this.view=i}clone(){return new sp(this.data,this.typeInfo,this.descriptor,this.view)}get width(){var e,r;const n=this.descriptor.size;return n instanceof Array&&n.length>0?(e=n[0])!==null&&e!==void 0?e:0:n instanceof Object&&(r=n.width)!==null&&r!==void 0?r:0}get height(){var e,r;const n=this.descriptor.size;return n instanceof Array&&n.length>1?(e=n[1])!==null&&e!==void 0?e:0:n instanceof Object&&(r=n.height)!==null&&r!==void 0?r:0}get depthOrArrayLayers(){var e,r;const n=this.descriptor.size;return n instanceof Array&&n.length>2?(e=n[2])!==null&&e!==void 0?e:0:n instanceof Object&&(r=n.depthOrArrayLayers)!==null&&r!==void 0?r:0}get format(){var e;return this.descriptor&&(e=this.descriptor.format)!==null&&e!==void 0?e:"rgba8unorm"}get sampleCount(){var e;return this.descriptor&&(e=this.descriptor.sampleCount)!==null&&e!==void 0?e:1}get mipLevelCount(){var e;return this.descriptor&&(e=this.descriptor.mipLevelCount)!==null&&e!==void 0?e:1}get dimension(){var e;return this.descriptor&&(e=this.descriptor.dimension)!==null&&e!==void 0?e:"2d"}getMipLevelSize(e){if(e>=this.mipLevelCount)return[0,0,0];const r=[this.width,this.height,this.depthOrArrayLayers];for(let n=0;n<r.length;++n)r[n]=Math.max(1,r[n]>>e);return r}get texelByteSize(){const e=this.format,r=GP[e];return r?r.isDepthStencil?4:r.bytesPerBlock:0}get bytesPerRow(){return this.width*this.texelByteSize}get isDepthStencil(){const e=this.format,r=GP[e];return!!r&&r.isDepthStencil}getGpuSize(){const e=this.format,r=GP[e],n=this.width;if(!e||n<=0||!r)return-1;const i=this.height,a=this.depthOrArrayLayers,s=this.dimension;return n/r.blockWidth*(s==="1d"?1:i/r.blockHeight)*r.bytesPerBlock*a}getPixel(e,r,n=0,i=0){const a=this.texelByteSize,s=this.bytesPerRow,o=this.height,c=this.data[i];return i7e(new Uint8Array(c),e,r,n,i,o,s,a,this.format)}setPixel(e,r,n,i,a){const s=this.texelByteSize,o=this.bytesPerRow,c=this.height,f=this.data[i];(function(d,m,b,x,E,T,A,M,F,N){const O=x*(A>>=E)*(T>>=E)+b*A+m*M;switch(F){case"r8unorm":return void ao(d,O,"8unorm",1,N);case"r8snorm":return void ao(d,O,"8snorm",1,N);case"r8uint":return void ao(d,O,"8uint",1,N);case"r8sint":return void ao(d,O,"8sint",1,N);case"rg8unorm":return void ao(d,O,"8unorm",2,N);case"rg8snorm":return void ao(d,O,"8snorm",2,N);case"rg8uint":return void ao(d,O,"8uint",2,N);case"rg8sint":return void ao(d,O,"8sint",2,N);case"rgba8unorm-srgb":case"rgba8unorm":case"bgra8unorm-srgb":case"bgra8unorm":return void ao(d,O,"8unorm",4,N);case"rgba8snorm":return void ao(d,O,"8snorm",4,N);case"rgba8uint":return void ao(d,O,"8uint",4,N);case"rgba8sint":return void ao(d,O,"8sint",4,N);case"r16uint":return void ao(d,O,"16uint",1,N);case"r16sint":return void ao(d,O,"16sint",1,N);case"r16float":return void ao(d,O,"16float",1,N);case"rg16uint":return void ao(d,O,"16uint",2,N);case"rg16sint":return void ao(d,O,"16sint",2,N);case"rg16float":return void ao(d,O,"16float",2,N);case"rgba16uint":return void ao(d,O,"16uint",4,N);case"rgba16sint":return void ao(d,O,"16sint",4,N);case"rgba16float":return void ao(d,O,"16float",4,N);case"r32uint":return void ao(d,O,"32uint",1,N);case"r32sint":return void ao(d,O,"32sint",1,N);case"depth16unorm":case"depth24plus":case"depth24plus-stencil8":case"depth32float":case"depth32float-stencil8":case"r32float":return void ao(d,O,"32float",1,N);case"rg32uint":return void ao(d,O,"32uint",2,N);case"rg32sint":return void ao(d,O,"32sint",2,N);case"rg32float":return void ao(d,O,"32float",2,N);case"rgba32uint":return void ao(d,O,"32uint",4,N);case"rgba32sint":return void ao(d,O,"32sint",4,N);case"rgba32float":return void ao(d,O,"32float",4,N);case"rg11b10ufloat":console.error("TODO: rg11b10ufloat not supported for writing")}})(new Uint8Array(f),e,r,n,i,c,o,s,this.format,a)}}(t=>{t[t.token=0]="token",t[t.keyword=1]="keyword",t[t.reserved=2]="reserved"})(or||(or={}));class sr{constructor(e,r,n){this.name=e,this.type=r,this.rule=n}toString(){return this.name}}class vt{}wr=vt,vt.none=new sr("",or.reserved,""),vt.eof=new sr("EOF",or.token,""),vt.reserved={asm:new sr("asm",or.reserved,"asm"),bf16:new sr("bf16",or.reserved,"bf16"),do:new sr("do",or.reserved,"do"),enum:new sr("enum",or.reserved,"enum"),f16:new sr("f16",or.reserved,"f16"),f64:new sr("f64",or.reserved,"f64"),handle:new sr("handle",or.reserved,"handle"),i8:new sr("i8",or.reserved,"i8"),i16:new sr("i16",or.reserved,"i16"),i64:new sr("i64",or.reserved,"i64"),mat:new sr("mat",or.reserved,"mat"),premerge:new sr("premerge",or.reserved,"premerge"),regardless:new sr("regardless",or.reserved,"regardless"),typedef:new sr("typedef",or.reserved,"typedef"),u8:new sr("u8",or.reserved,"u8"),u16:new sr("u16",or.reserved,"u16"),u64:new sr("u64",or.reserved,"u64"),unless:new sr("unless",or.reserved,"unless"),using:new sr("using",or.reserved,"using"),vec:new sr("vec",or.reserved,"vec"),void:new sr("void",or.reserved,"void")},vt.keywords={array:new sr("array",or.keyword,"array"),atomic:new sr("atomic",or.keyword,"atomic"),bool:new sr("bool",or.keyword,"bool"),f32:new sr("f32",or.keyword,"f32"),i32:new sr("i32",or.keyword,"i32"),mat2x2:new sr("mat2x2",or.keyword,"mat2x2"),mat2x3:new sr("mat2x3",or.keyword,"mat2x3"),mat2x4:new sr("mat2x4",or.keyword,"mat2x4"),mat3x2:new sr("mat3x2",or.keyword,"mat3x2"),mat3x3:new sr("mat3x3",or.keyword,"mat3x3"),mat3x4:new sr("mat3x4",or.keyword,"mat3x4"),mat4x2:new sr("mat4x2",or.keyword,"mat4x2"),mat4x3:new sr("mat4x3",or.keyword,"mat4x3"),mat4x4:new sr("mat4x4",or.keyword,"mat4x4"),ptr:new sr("ptr",or.keyword,"ptr"),sampler:new sr("sampler",or.keyword,"sampler"),sampler_comparison:new sr("sampler_comparison",or.keyword,"sampler_comparison"),struct:new sr("struct",or.keyword,"struct"),texture_1d:new sr("texture_1d",or.keyword,"texture_1d"),texture_2d:new sr("texture_2d",or.keyword,"texture_2d"),texture_2d_array:new sr("texture_2d_array",or.keyword,"texture_2d_array"),texture_3d:new sr("texture_3d",or.keyword,"texture_3d"),texture_cube:new sr("texture_cube",or.keyword,"texture_cube"),texture_cube_array:new sr("texture_cube_array",or.keyword,"texture_cube_array"),texture_multisampled_2d:new sr("texture_multisampled_2d",or.keyword,"texture_multisampled_2d"),texture_storage_1d:new sr("texture_storage_1d",or.keyword,"texture_storage_1d"),texture_storage_2d:new sr("texture_storage_2d",or.keyword,"texture_storage_2d"),texture_storage_2d_array:new sr("texture_storage_2d_array",or.keyword,"texture_storage_2d_array"),texture_storage_3d:new sr("texture_storage_3d",or.keyword,"texture_storage_3d"),texture_depth_2d:new sr("texture_depth_2d",or.keyword,"texture_depth_2d"),texture_depth_2d_array:new sr("texture_depth_2d_array",or.keyword,"texture_depth_2d_array"),texture_depth_cube:new sr("texture_depth_cube",or.keyword,"texture_depth_cube"),texture_depth_cube_array:new sr("texture_depth_cube_array",or.keyword,"texture_depth_cube_array"),texture_depth_multisampled_2d:new sr("texture_depth_multisampled_2d",or.keyword,"texture_depth_multisampled_2d"),texture_external:new sr("texture_external",or.keyword,"texture_external"),u32:new sr("u32",or.keyword,"u32"),vec2:new sr("vec2",or.keyword,"vec2"),vec3:new sr("vec3",or.keyword,"vec3"),vec4:new sr("vec4",or.keyword,"vec4"),bitcast:new sr("bitcast",or.keyword,"bitcast"),block:new sr("block",or.keyword,"block"),break:new sr("break",or.keyword,"break"),case:new sr("case",or.keyword,"case"),continue:new sr("continue",or.keyword,"continue"),continuing:new sr("continuing",or.keyword,"continuing"),default:new sr("default",or.keyword,"default"),diagnostic:new sr("diagnostic",or.keyword,"diagnostic"),discard:new sr("discard",or.keyword,"discard"),else:new sr("else",or.keyword,"else"),enable:new sr("enable",or.keyword,"enable"),fallthrough:new sr("fallthrough",or.keyword,"fallthrough"),false:new sr("false",or.keyword,"false"),fn:new sr("fn",or.keyword,"fn"),for:new sr("for",or.keyword,"for"),function:new sr("function",or.keyword,"function"),if:new sr("if",or.keyword,"if"),let:new sr("let",or.keyword,"let"),const:new sr("const",or.keyword,"const"),loop:new sr("loop",or.keyword,"loop"),while:new sr("while",or.keyword,"while"),private:new sr("private",or.keyword,"private"),read:new sr("read",or.keyword,"read"),read_write:new sr("read_write",or.keyword,"read_write"),return:new sr("return",or.keyword,"return"),requires:new sr("requires",or.keyword,"requires"),storage:new sr("storage",or.keyword,"storage"),switch:new sr("switch",or.keyword,"switch"),true:new sr("true",or.keyword,"true"),alias:new sr("alias",or.keyword,"alias"),type:new sr("type",or.keyword,"type"),uniform:new sr("uniform",or.keyword,"uniform"),var:new sr("var",or.keyword,"var"),override:new sr("override",or.keyword,"override"),workgroup:new sr("workgroup",or.keyword,"workgroup"),write:new sr("write",or.keyword,"write"),r8unorm:new sr("r8unorm",or.keyword,"r8unorm"),r8snorm:new sr("r8snorm",or.keyword,"r8snorm"),r8uint:new sr("r8uint",or.keyword,"r8uint"),r8sint:new sr("r8sint",or.keyword,"r8sint"),r16uint:new sr("r16uint",or.keyword,"r16uint"),r16sint:new sr("r16sint",or.keyword,"r16sint"),r16float:new sr("r16float",or.keyword,"r16float"),rg8unorm:new sr("rg8unorm",or.keyword,"rg8unorm"),rg8snorm:new sr("rg8snorm",or.keyword,"rg8snorm"),rg8uint:new sr("rg8uint",or.keyword,"rg8uint"),rg8sint:new sr("rg8sint",or.keyword,"rg8sint"),r32uint:new sr("r32uint",or.keyword,"r32uint"),r32sint:new sr("r32sint",or.keyword,"r32sint"),r32float:new sr("r32float",or.keyword,"r32float"),rg16uint:new sr("rg16uint",or.keyword,"rg16uint"),rg16sint:new sr("rg16sint",or.keyword,"rg16sint"),rg16float:new sr("rg16float",or.keyword,"rg16float"),rgba8unorm:new sr("rgba8unorm",or.keyword,"rgba8unorm"),rgba8unorm_srgb:new sr("rgba8unorm_srgb",or.keyword,"rgba8unorm_srgb"),rgba8snorm:new sr("rgba8snorm",or.keyword,"rgba8snorm"),rgba8uint:new sr("rgba8uint",or.keyword,"rgba8uint"),rgba8sint:new sr("rgba8sint",or.keyword,"rgba8sint"),bgra8unorm:new sr("bgra8unorm",or.keyword,"bgra8unorm"),bgra8unorm_srgb:new sr("bgra8unorm_srgb",or.keyword,"bgra8unorm_srgb"),rgb10a2unorm:new sr("rgb10a2unorm",or.keyword,"rgb10a2unorm"),rg11b10float:new sr("rg11b10float",or.keyword,"rg11b10float"),rg32uint:new sr("rg32uint",or.keyword,"rg32uint"),rg32sint:new sr("rg32sint",or.keyword,"rg32sint"),rg32float:new sr("rg32float",or.keyword,"rg32float"),rgba16uint:new sr("rgba16uint",or.keyword,"rgba16uint"),rgba16sint:new sr("rgba16sint",or.keyword,"rgba16sint"),rgba16float:new sr("rgba16float",or.keyword,"rgba16float"),rgba32uint:new sr("rgba32uint",or.keyword,"rgba32uint"),rgba32sint:new sr("rgba32sint",or.keyword,"rgba32sint"),rgba32float:new sr("rgba32float",or.keyword,"rgba32float"),static_assert:new sr("static_assert",or.keyword,"static_assert")},vt.tokens={decimal_float_literal:new sr("decimal_float_literal",or.token,/((-?[0-9]*\.[0-9]+|-?[0-9]+\.[0-9]*)((e|E)(\+|-)?[0-9]+)?[fh]?)|(-?[0-9]+(e|E)(\+|-)?[0-9]+[fh]?)|(-?[0-9]+[fh])/),hex_float_literal:new sr("hex_float_literal",or.token,/-?0x((([0-9a-fA-F]*\.[0-9a-fA-F]+|[0-9a-fA-F]+\.[0-9a-fA-F]*)((p|P)(\+|-)?[0-9]+[fh]?)?)|([0-9a-fA-F]+(p|P)(\+|-)?[0-9]+[fh]?))/),int_literal:new sr("int_literal",or.token,/-?0x[0-9a-fA-F]+|0i?|-?[1-9][0-9]*i?/),uint_literal:new sr("uint_literal",or.token,/0x[0-9a-fA-F]+u|0u|[1-9][0-9]*u/),name:new sr("name",or.token,/([_\p{XID_Start}][\p{XID_Continue}]+)|([\p{XID_Start}])/u),ident:new sr("ident",or.token,/[_a-zA-Z][0-9a-zA-Z_]*/),and:new sr("and",or.token,"&"),and_and:new sr("and_and",or.token,"&&"),arrow:new sr("arrow ",or.token,"->"),attr:new sr("attr",or.token,"@"),forward_slash:new sr("forward_slash",or.token,"/"),bang:new sr("bang",or.token,"!"),bracket_left:new sr("bracket_left",or.token,"["),bracket_right:new sr("bracket_right",or.token,"]"),brace_left:new sr("brace_left",or.token,"{"),brace_right:new sr("brace_right",or.token,"}"),colon:new sr("colon",or.token,":"),comma:new sr("comma",or.token,","),equal:new sr("equal",or.token,"="),equal_equal:new sr("equal_equal",or.token,"=="),not_equal:new sr("not_equal",or.token,"!="),greater_than:new sr("greater_than",or.token,">"),greater_than_equal:new sr("greater_than_equal",or.token,">="),shift_right:new sr("shift_right",or.token,">>"),less_than:new sr("less_than",or.token,"<"),less_than_equal:new sr("less_than_equal",or.token,"<="),shift_left:new sr("shift_left",or.token,"<<"),modulo:new sr("modulo",or.token,"%"),minus:new sr("minus",or.token,"-"),minus_minus:new sr("minus_minus",or.token,"--"),period:new sr("period",or.token,"."),plus:new sr("plus",or.token,"+"),plus_plus:new sr("plus_plus",or.token,"++"),or:new sr("or",or.token,"|"),or_or:new sr("or_or",or.token,"||"),paren_left:new sr("paren_left",or.token,"("),paren_right:new sr("paren_right",or.token,")"),semicolon:new sr("semicolon",or.token,";"),star:new sr("star",or.token,"*"),tilde:new sr("tilde",or.token,"~"),underscore:new sr("underscore",or.token,"_"),xor:new sr("xor",or.token,"^"),plus_equal:new sr("plus_equal",or.token,"+="),minus_equal:new sr("minus_equal",or.token,"-="),times_equal:new sr("times_equal",or.token,"*="),division_equal:new sr("division_equal",or.token,"/="),modulo_equal:new sr("modulo_equal",or.token,"%="),and_equal:new sr("and_equal",or.token,"&="),or_equal:new sr("or_equal",or.token,"|="),xor_equal:new sr("xor_equal",or.token,"^="),shift_right_equal:new sr("shift_right_equal",or.token,">>="),shift_left_equal:new sr("shift_left_equal",or.token,"<<=")},vt.simpleTokens={"@":wr.tokens.attr,"{":wr.tokens.brace_left,"}":wr.tokens.brace_right,":":wr.tokens.colon,",":wr.tokens.comma,"(":wr.tokens.paren_left,")":wr.tokens.paren_right,";":wr.tokens.semicolon},vt.literalTokens={"&":wr.tokens.and,"&&":wr.tokens.and_and,"->":wr.tokens.arrow,"/":wr.tokens.forward_slash,"!":wr.tokens.bang,"[":wr.tokens.bracket_left,"]":wr.tokens.bracket_right,"=":wr.tokens.equal,"==":wr.tokens.equal_equal,"!=":wr.tokens.not_equal,">":wr.tokens.greater_than,">=":wr.tokens.greater_than_equal,">>":wr.tokens.shift_right,"<":wr.tokens.less_than,"<=":wr.tokens.less_than_equal,"<<":wr.tokens.shift_left,"%":wr.tokens.modulo,"-":wr.tokens.minus,"--":wr.tokens.minus_minus,".":wr.tokens.period,"+":wr.tokens.plus,"++":wr.tokens.plus_plus,"|":wr.tokens.or,"||":wr.tokens.or_or,"*":wr.tokens.star,"~":wr.tokens.tilde,_:wr.tokens.underscore,"^":wr.tokens.xor,"+=":wr.tokens.plus_equal,"-=":wr.tokens.minus_equal,"*=":wr.tokens.times_equal,"/=":wr.tokens.division_equal,"%=":wr.tokens.modulo_equal,"&=":wr.tokens.and_equal,"|=":wr.tokens.or_equal,"^=":wr.tokens.xor_equal,">>=":wr.tokens.shift_right_equal,"<<=":wr.tokens.shift_left_equal},vt.regexTokens={decimal_float_literal:wr.tokens.decimal_float_literal,hex_float_literal:wr.tokens.hex_float_literal,int_literal:wr.tokens.int_literal,uint_literal:wr.tokens.uint_literal,ident:wr.tokens.ident},vt.storage_class=[wr.keywords.function,wr.keywords.private,wr.keywords.workgroup,wr.keywords.uniform,wr.keywords.storage],vt.access_mode=[wr.keywords.read,wr.keywords.write,wr.keywords.read_write],vt.sampler_type=[wr.keywords.sampler,wr.keywords.sampler_comparison],vt.sampled_texture_type=[wr.keywords.texture_1d,wr.keywords.texture_2d,wr.keywords.texture_2d_array,wr.keywords.texture_3d,wr.keywords.texture_cube,wr.keywords.texture_cube_array],vt.multisampled_texture_type=[wr.keywords.texture_multisampled_2d],vt.storage_texture_type=[wr.keywords.texture_storage_1d,wr.keywords.texture_storage_2d,wr.keywords.texture_storage_2d_array,wr.keywords.texture_storage_3d],vt.depth_texture_type=[wr.keywords.texture_depth_2d,wr.keywords.texture_depth_2d_array,wr.keywords.texture_depth_cube,wr.keywords.texture_depth_cube_array,wr.keywords.texture_depth_multisampled_2d],vt.texture_external_type=[wr.keywords.texture_external],vt.any_texture_type=[...wr.sampled_texture_type,...wr.multisampled_texture_type,...wr.storage_texture_type,...wr.depth_texture_type,...wr.texture_external_type],vt.texel_format=[wr.keywords.r8unorm,wr.keywords.r8snorm,wr.keywords.r8uint,wr.keywords.r8sint,wr.keywords.r16uint,wr.keywords.r16sint,wr.keywords.r16float,wr.keywords.rg8unorm,wr.keywords.rg8snorm,wr.keywords.rg8uint,wr.keywords.rg8sint,wr.keywords.r32uint,wr.keywords.r32sint,wr.keywords.r32float,wr.keywords.rg16uint,wr.keywords.rg16sint,wr.keywords.rg16float,wr.keywords.rgba8unorm,wr.keywords.rgba8unorm_srgb,wr.keywords.rgba8snorm,wr.keywords.rgba8uint,wr.keywords.rgba8sint,wr.keywords.bgra8unorm,wr.keywords.bgra8unorm_srgb,wr.keywords.rgb10a2unorm,wr.keywords.rg11b10float,wr.keywords.rg32uint,wr.keywords.rg32sint,wr.keywords.rg32float,wr.keywords.rgba16uint,wr.keywords.rgba16sint,wr.keywords.rgba16float,wr.keywords.rgba32uint,wr.keywords.rgba32sint,wr.keywords.rgba32float],vt.const_literal=[wr.tokens.int_literal,wr.tokens.uint_literal,wr.tokens.decimal_float_literal,wr.tokens.hex_float_literal,wr.keywords.true,wr.keywords.false],vt.literal_or_ident=[wr.tokens.ident,wr.tokens.int_literal,wr.tokens.uint_literal,wr.tokens.decimal_float_literal,wr.tokens.hex_float_literal,wr.tokens.name],vt.element_count_expression=[wr.tokens.int_literal,wr.tokens.uint_literal,wr.tokens.ident],vt.template_types=[wr.keywords.vec2,wr.keywords.vec3,wr.keywords.vec4,wr.keywords.mat2x2,wr.keywords.mat2x3,wr.keywords.mat2x4,wr.keywords.mat3x2,wr.keywords.mat3x3,wr.keywords.mat3x4,wr.keywords.mat4x2,wr.keywords.mat4x3,wr.keywords.mat4x4,wr.keywords.atomic,wr.keywords.bitcast,...wr.any_texture_type],vt.attribute_name=[wr.tokens.ident,wr.keywords.block,wr.keywords.diagnostic],vt.assignment_operators=[wr.tokens.equal,wr.tokens.plus_equal,wr.tokens.minus_equal,wr.tokens.times_equal,wr.tokens.division_equal,wr.tokens.modulo_equal,wr.tokens.and_equal,wr.tokens.or_equal,wr.tokens.xor_equal,wr.tokens.shift_right_equal,wr.tokens.shift_left_equal],vt.increment_operators=[wr.tokens.plus_plus,wr.tokens.minus_minus];class CG{constructor(e,r,n,i,a){this.type=e,this.lexeme=r,this.line=n,this.start=i,this.end=a}toString(){return this.lexeme}isTemplateType(){return vt.template_types.indexOf(this.type)!=-1}isArrayType(){return this.type==vt.keywords.array}isArrayOrTemplateType(){return this.isArrayType()||this.isTemplateType()}}class f7e{constructor(e){this._tokens=[],this._start=0,this._current=0,this._line=1,this._source=e??""}scanTokens(){for(;!this._isAtEnd();)if(this._start=this._current,!this.scanToken())throw`Invalid syntax at line ${this._line}`;return this._tokens.push(new CG(vt.eof,"",this._line,this._current,this._current)),this._tokens}scanToken(){let e=this._advance();if(e==`
`)return this._line++,!0;if(this._isWhitespace(e))return!0;if(e=="/"){if(this._peekAhead()=="/"){for(;e!=`
`;){if(this._isAtEnd())return!0;e=this._advance()}return this._line++,!0}if(this._peekAhead()=="*"){this._advance();let s=1;for(;s>0;){if(this._isAtEnd())return!0;if(e=this._advance(),e==`
`)this._line++;else if(e=="*"){if(this._peekAhead()=="/"&&(this._advance(),s--,s==0))return!0}else e=="/"&&this._peekAhead()=="*"&&(this._advance(),s++)}return!0}}const r=vt.simpleTokens[e];if(r)return this._addToken(r),!0;let n=vt.none;const i=this._isAlpha(e),a=e==="_";if(this._isAlphaNumeric(e)){let s=this._peekAhead();for(;this._isAlphaNumeric(s);)e+=this._advance(),s=this._peekAhead()}if(i){const s=vt.keywords[e];if(s)return this._addToken(s),!0}if(i||a)return this._addToken(vt.tokens.ident),!0;for(;;){let s=this._findType(e);const o=this._peekAhead();if(e=="-"&&this._tokens.length>0){if(o=="=")return this._current++,e+=o,this._addToken(vt.tokens.minus_equal),!0;if(o=="-")return this._current++,e+=o,this._addToken(vt.tokens.minus_minus),!0;const c=this._tokens.length-1;if((vt.literal_or_ident.indexOf(this._tokens[c].type)!=-1||this._tokens[c].type==vt.tokens.paren_right)&&o!=">")return this._addToken(s),!0}if(e==">"&&(o==">"||o=="=")){let c=!1,f=this._tokens.length-1;for(let d=0;d<5&&f>=0&&vt.assignment_operators.indexOf(this._tokens[f].type)===-1;++d,--f)if(this._tokens[f].type===vt.tokens.less_than){f>0&&this._tokens[f-1].isArrayOrTemplateType()&&(c=!0);break}if(c)return this._addToken(s),!0}if(s===vt.none){let c=e,f=0;const d=2;for(let m=0;m<d;++m)if(c+=this._peekAhead(m),s=this._findType(c),s!==vt.none){f=m;break}if(s===vt.none)return n!==vt.none&&(this._current--,this._addToken(n),!0);e=c,this._current+=f+1}if(n=s,this._isAtEnd())break;e+=this._advance()}return n!==vt.none&&(this._addToken(n),!0)}_findType(e){for(const n in vt.regexTokens){const i=vt.regexTokens[n];if(this._match(e,i.rule))return i}return vt.literalTokens[e]||vt.none}_match(e,r){const n=r.exec(e);return n&&n.index==0&&n[0]==e}_isAtEnd(){return this._current>=this._source.length}_isAlpha(e){return!this._isNumeric(e)&&!this._isWhitespace(e)&&e!=="_"&&e!=="."&&e!=="("&&e!==")"&&e!=="["&&e!=="]"&&e!=="{"&&e!=="}"&&e!==","&&e!==";"&&e!==":"&&e!=="="&&e!=="!"&&e!=="<"&&e!==">"&&e!=="+"&&e!=="-"&&e!=="*"&&e!=="/"&&e!=="%"&&e!=="&"&&e!=="|"&&e!=="^"&&e!=="~"&&e!=="@"&&e!=="#"&&e!=="?"&&e!=="'"&&e!=="`"&&e!=='"'&&e!=="\\"&&e!==`
`&&e!=="\r"&&e!=="	"&&e!=="\0"}_isNumeric(e){return e>="0"&&e<="9"}_isAlphaNumeric(e){return this._isAlpha(e)||this._isNumeric(e)||e==="_"}_isWhitespace(e){return e==" "||e=="	"||e=="\r"}_advance(e=0){let r=this._source[this._current];return e=e||0,e++,this._current+=e,r}_peekAhead(e=0){return e=e||0,this._current+e>=this._source.length?"\0":this._source[this._current+e]}_addToken(e){const r=this._source.substring(this._start,this._current);this._tokens.push(new CG(e,r,this._line,this._start,this._current))}}function On(t){return Array.isArray(t)||t?.buffer instanceof ArrayBuffer}const mT=new Float32Array(1),h7e=new Uint32Array(mT.buffer),d7e=new Uint32Array(mT.buffer),yT=new Int32Array(1),p7e=new Float32Array(yT.buffer),g7e=new Uint32Array(yT.buffer),vT=new Uint32Array(1),m7e=new Float32Array(vT.buffer),y7e=new Int32Array(vT.buffer);function AG(t,e,r){if(e===r)return t;if(e==="f32"){if(r==="i32"||r==="x32")return mT[0]=t,h7e[0];if(r==="u32")return mT[0]=t,d7e[0]}else if(e==="i32"||e==="x32"){if(r==="f32")return yT[0]=t,p7e[0];if(r==="u32")return yT[0]=t,g7e[0]}else if(e==="u32"){if(r==="f32")return vT[0]=t,m7e[0];if(r==="i32"||r==="x32")return vT[0]=t,y7e[0]}return console.error(`Unsupported cast from ${e} to ${r}`),t}class v7e{constructor(e){this.resources=null,this.inUse=!1,this.info=null,this.node=e}}class Zw{constructor(e,r){this.align=e,this.size=r}}class pd{constructor(){this.uniforms=[],this.storage=[],this.textures=[],this.samplers=[],this.aliases=[],this.overrides=[],this.structs=[],this.entry=new e7e,this.functions=[],this._types=new Map,this._functions=new Map}_isStorageTexture(e){return e.name=="texture_storage_1d"||e.name=="texture_storage_2d"||e.name=="texture_storage_2d_array"||e.name=="texture_storage_3d"}updateAST(e){for(const r of e)r instanceof dx&&this._functions.set(r.name,new v7e(r));for(const r of e)if(r instanceof op){const n=this.getTypeInfo(r,null);n instanceof mg&&this.structs.push(n)}for(const r of e)if(r instanceof e6)this.aliases.push(this._getAliasInfo(r));else{if(r instanceof JL){const n=r,i=this._getAttributeNum(n.attributes,"id",0),a=n.type!=null?this.getTypeInfo(n.type,n.attributes):null;this.overrides.push(new K9e(n.name,a,n.attributes,i));continue}if(this._isUniformVar(r)){const n=r,i=this._getAttributeNum(n.attributes,"group",0),a=this._getAttributeNum(n.attributes,"binding",0),s=this.getTypeInfo(n.type,n.attributes),o=new Yw(n.name,s,i,a,n.attributes,lg.Uniform,n.access);o.access||(o.access="read"),this.uniforms.push(o);continue}if(this._isStorageVar(r)){const n=r,i=this._getAttributeNum(n.attributes,"group",0),a=this._getAttributeNum(n.attributes,"binding",0),s=this.getTypeInfo(n.type,n.attributes),o=this._isStorageTexture(s),c=new Yw(n.name,s,i,a,n.attributes,o?lg.StorageTexture:lg.Storage,n.access);c.access||(c.access="read"),this.storage.push(c);continue}if(this._isTextureVar(r)){const n=r,i=this._getAttributeNum(n.attributes,"group",0),a=this._getAttributeNum(n.attributes,"binding",0),s=this.getTypeInfo(n.type,n.attributes),o=this._isStorageTexture(s),c=new Yw(n.name,s,i,a,n.attributes,o?lg.StorageTexture:lg.Texture,n.access);c.access||(c.access="read"),o?this.storage.push(c):this.textures.push(c);continue}if(this._isSamplerVar(r)){const n=r,i=this._getAttributeNum(n.attributes,"group",0),a=this._getAttributeNum(n.attributes,"binding",0),s=this.getTypeInfo(n.type,n.attributes),o=new Yw(n.name,s,i,a,n.attributes,lg.Sampler,n.access);this.samplers.push(o);continue}}for(const r of e)if(r instanceof dx){const n=this._getAttribute(r,"vertex"),i=this._getAttribute(r,"fragment"),a=this._getAttribute(r,"compute"),s=n||i||a,o=new Q9e(r.name,s?.name,r.attributes);o.attributes=r.attributes,o.startLine=r.startLine,o.endLine=r.endLine,this.functions.push(o),this._functions.get(r.name).info=o,s&&(this._functions.get(r.name).inUse=!0,o.inUse=!0,o.resources=this._findResources(r,!!s),o.inputs=this._getInputs(r.args),o.outputs=this._getOutputs(r.returnType),this.entry[s.name].push(o)),o.arguments=r.args.map(c=>new J9e(c.name,this.getTypeInfo(c.type,c.attributes),c.attributes)),o.returnType=r.returnType?this.getTypeInfo(r.returnType,r.attributes):null;continue}for(const r of this._functions.values())r.info&&(r.info.inUse=r.inUse,this._addCalls(r.node,r.info.calls));for(const r of this._functions.values())r.node.search(n=>{var i,a,s;if(n instanceof Fre){if(n.value)if(On(n.value))for(const o of n.value)for(const c of this.overrides)o===c.name&&((i=r.info)===null||i===void 0||i.overrides.push(c));else for(const o of this.overrides)n.value===o.name&&((a=r.info)===null||a===void 0||a.overrides.push(o))}else if(n instanceof af)for(const o of this.overrides)n.name===o.name&&((s=r.info)===null||s===void 0||s.overrides.push(o))});for(const r of this.uniforms)this._markStructsInUse(r.type);for(const r of this.storage)this._markStructsInUse(r.type)}getFunctionInfo(e){for(const r of this.functions)if(r.name==e)return r;return null}getStructInfo(e){for(const r of this.structs)if(r.name==e)return r;return null}getOverrideInfo(e){for(const r of this.overrides)if(r.name==e)return r;return null}_markStructsInUse(e){if(e)if(e.isStruct){if(e.inUse=!0,e.members)for(const r of e.members)this._markStructsInUse(r.type)}else if(e.isArray)this._markStructsInUse(e.format);else if(e.isTemplate)e.format&&this._markStructsInUse(e.format);else{const r=this._getAlias(e.name);r&&this._markStructsInUse(r)}}_addCalls(e,r){var n;for(const i of e.calls){const a=(n=this._functions.get(i.name))===null||n===void 0?void 0:n.info;a&&r.add(a)}}findResource(e,r,n){if(n){for(const i of this.entry.compute)if(i.name===n){for(const a of i.resources)if(a.group==e&&a.binding==r)return a}for(const i of this.entry.vertex)if(i.name===n){for(const a of i.resources)if(a.group==e&&a.binding==r)return a}for(const i of this.entry.fragment)if(i.name===n){for(const a of i.resources)if(a.group==e&&a.binding==r)return a}}for(const i of this.uniforms)if(i.group==e&&i.binding==r)return i;for(const i of this.storage)if(i.group==e&&i.binding==r)return i;for(const i of this.textures)if(i.group==e&&i.binding==r)return i;for(const i of this.samplers)if(i.group==e&&i.binding==r)return i;return null}_findResource(e){for(const r of this.uniforms)if(r.name==e)return r;for(const r of this.storage)if(r.name==e)return r;for(const r of this.textures)if(r.name==e)return r;for(const r of this.samplers)if(r.name==e)return r;return null}_markStructsFromAST(e){const r=this.getTypeInfo(e,null);this._markStructsInUse(r)}_findResources(e,r){const n=[],i=this,a=[];return e.search(s=>{if(s instanceof pT)a.push({});else if(s instanceof gT)a.pop();else if(s instanceof cp){const o=s;r&&o.type!==null&&this._markStructsFromAST(o.type),a.length>0&&(a[a.length-1][o.name]=o)}else if(s instanceof sd){const o=s;r&&o.type!==null&&this._markStructsFromAST(o.type)}else if(s instanceof Tb){const o=s;r&&o.type!==null&&this._markStructsFromAST(o.type),a.length>0&&(a[a.length-1][o.name]=o)}else if(s instanceof af){const o=s;if(a.length>0&&a[a.length-1][o.name])return;const c=i._findResource(o.name);c&&n.push(c)}else if(s instanceof t6){const o=s,c=i._functions.get(o.name);c&&(r&&(c.inUse=!0),e.calls.add(c.node),c.resources===null&&(c.resources=i._findResources(c.node,r)),n.push(...c.resources))}else if(s instanceof QL){const o=s,c=i._functions.get(o.name);c&&(r&&(c.inUse=!0),e.calls.add(c.node),c.resources===null&&(c.resources=i._findResources(c.node,r)),n.push(...c.resources))}}),[...new Map(n.map(s=>[s.name,s])).values()]}getBindGroups(){const e=[];function r(n,i){n>=e.length&&(e.length=n+1),e[n]===void 0&&(e[n]=[]),i>=e[n].length&&(e[n].length=i+1)}for(const n of this.uniforms)r(n.group,n.binding),e[n.group][n.binding]=n;for(const n of this.storage)r(n.group,n.binding),e[n.group][n.binding]=n;for(const n of this.textures)r(n.group,n.binding),e[n.group][n.binding]=n;for(const n of this.samplers)r(n.group,n.binding),e[n.group][n.binding]=n;return e}_getOutputs(e,r=void 0){if(r===void 0&&(r=[]),e instanceof op)this._getStructOutputs(e,r);else{const n=this._getOutputInfo(e);n!==null&&r.push(n)}return r}_getStructOutputs(e,r){for(const n of e.members)if(n.type instanceof op)this._getStructOutputs(n.type,r);else{const i=this._getAttribute(n,"location")||this._getAttribute(n,"builtin");if(i!==null){const a=this.getTypeInfo(n.type,n.type.attributes),s=this._parseInt(i.value),o=new xG(n.name,a,i.name,s);r.push(o)}}}_getOutputInfo(e){const r=this._getAttribute(e,"location")||this._getAttribute(e,"builtin");if(r!==null){const n=this.getTypeInfo(e,e.attributes),i=this._parseInt(r.value);return new xG("",n,r.name,i)}return null}_getInputs(e,r=void 0){r===void 0&&(r=[]);for(const n of e)if(n.type instanceof op)this._getStructInputs(n.type,r);else{const i=this._getInputInfo(n);i!==null&&r.push(i)}return r}_getStructInputs(e,r){for(const n of e.members)if(n.type instanceof op)this._getStructInputs(n.type,r);else{const i=this._getInputInfo(n);i!==null&&r.push(i)}}_getInputInfo(e){const r=this._getAttribute(e,"location")||this._getAttribute(e,"builtin");if(r!==null){const n=this._getAttribute(e,"interpolation"),i=this.getTypeInfo(e.type,e.attributes),a=this._parseInt(r.value),s=new Z9e(e.name,i,r.name,a);return n!==null&&(s.interpolation=this._parseString(n.value)),s}return null}_parseString(e){return e instanceof Array&&(e=e[0]),e}_parseInt(e){e instanceof Array&&(e=e[0]);const r=parseInt(e);return isNaN(r)?e:r}_getAlias(e){for(const r of this.aliases)if(r.name==e)return r.type;return null}_getAliasInfo(e){return new Y9e(e.name,this.getTypeInfo(e.type,null))}getTypeInfoByName(e){for(const r of this.structs)if(r.name==e)return r;for(const r of this.aliases)if(r.name==e)return r.type;return null}getTypeInfo(e,r=null){if(this._types.has(e))return this._types.get(e);if(e instanceof MS){const i=e.type?this.getTypeInfo(e.type,e.attributes):null,a=new rD(e.name,i,r);return this._types.set(e,a),this._updateTypeInfo(a),a}if(e instanceof Cb){const i=e,a=i.format?this.getTypeInfo(i.format,i.attributes):null,s=new wg(i.name,r);return s.format=a,s.count=i.count,this._types.set(e,s),this._updateTypeInfo(s),s}if(e instanceof op){const i=e,a=new mg(i.name,r);a.startLine=i.startLine,a.endLine=i.endLine;for(const s of i.members){const o=this.getTypeInfo(s.type,s.attributes);a.members.push(new bG(s.name,o,s.attributes))}return this._types.set(e,a),this._updateTypeInfo(a),a}if(e instanceof eb){const i=e,a=i.format instanceof Kr,s=i.format?a?this.getTypeInfo(i.format,null):new Vf(i.format,null):null,o=new py(i.name,s,r,i.access);return this._types.set(e,o),this._updateTypeInfo(o),o}if(e instanceof fr){const i=e,a=i.format?this.getTypeInfo(i.format,null):null,s=new py(i.name,a,r,i.access);return this._types.set(e,s),this._updateTypeInfo(s),s}const n=new Vf(e.name,r);return this._types.set(e,n),this._updateTypeInfo(n),n}_updateTypeInfo(e){var r,n,i;const a=this._getTypeSize(e);if(e.size=(r=a?.size)!==null&&r!==void 0?r:0,e instanceof wg&&e.format){const s=this._getTypeSize(e.format);e.stride=Math.max((n=s?.size)!==null&&n!==void 0?n:0,(i=s?.align)!==null&&i!==void 0?i:0),this._updateTypeInfo(e.format)}e instanceof rD&&this._updateTypeInfo(e.format),e instanceof mg&&this._updateStructInfo(e)}_updateStructInfo(e){var r;let n=0,i=0,a=0,s=0;for(let o=0,c=e.members.length;o<c;++o){const f=e.members[o],d=this._getTypeSize(f);if(!d)continue;(r=this._getAlias(f.type.name))!==null&&r!==void 0||f.type;const m=d.align,b=d.size;n=this._roundUp(m,n+i),i=b,a=n,s=Math.max(s,m),f.offset=n,f.size=b,this._updateTypeInfo(f.type)}e.size=this._roundUp(s,a+i),e.align=s}_getTypeSize(e){var r,n;if(e==null)return null;const i=this._getAttributeNum(e.attributes,"size",0),a=this._getAttributeNum(e.attributes,"align",0);if(e instanceof bG&&(e=e.type),e instanceof Vf){const s=this._getAlias(e.name);s!==null&&(e=s)}{const s=pd._typeInfo[e.name];if(s!==void 0){const o=((r=e.format)===null||r===void 0?void 0:r.name)==="f16"?2:1;return new Zw(Math.max(a,s.align/o),Math.max(i,s.size/o))}}{const s=pd._typeInfo[e.name.substring(0,e.name.length-1)];if(s){const o=e.name[e.name.length-1]==="h"?2:1;return new Zw(Math.max(a,s.align/o),Math.max(i,s.size/o))}}if(e instanceof wg){let s=e,o=8,c=8;const f=this._getTypeSize(s.format);return f!==null&&(c=f.size,o=f.align),c=s.count*this._getAttributeNum((n=e?.attributes)!==null&&n!==void 0?n:null,"stride",this._roundUp(o,c)),i&&(c=i),new Zw(Math.max(a,o),Math.max(i,c))}if(e instanceof mg){let s=0,o=0,c=0,f=0,d=0;for(const m of e.members){const b=this._getTypeSize(m.type);b!==null&&(s=Math.max(b.align,s),c=this._roundUp(b.align,c+f),f=b.size,d=c)}return o=this._roundUp(s,d+f),new Zw(Math.max(a,s),Math.max(i,o))}return null}_isUniformVar(e){return e instanceof cp&&e.storage=="uniform"}_isStorageVar(e){return e instanceof cp&&e.storage=="storage"}_isTextureVar(e){return e instanceof cp&&e.type!==null&&pd._textureTypes.indexOf(e.type.name)!=-1}_isSamplerVar(e){return e instanceof cp&&e.type!==null&&pd._samplerTypes.indexOf(e.type.name)!=-1}_getAttribute(e,r){const n=e;if(!n||!n.attributes)return null;const i=n.attributes;for(let a of i)if(a.name==r)return a;return null}_getAttributeNum(e,r,n){if(e===null)return n;for(let i of e)if(i.name==r){let a=i!==null&&i.value!==null?i.value:n;return a instanceof Array&&(a=a[0]),typeof a=="number"?a:typeof a=="string"?parseInt(a):n}return n}_roundUp(e,r){return Math.ceil(r/e)*e}}pd._typeInfo={f16:{align:2,size:2},i32:{align:4,size:4},u32:{align:4,size:4},f32:{align:4,size:4},atomic:{align:4,size:4},vec2:{align:8,size:8},vec3:{align:16,size:12},vec4:{align:16,size:16},mat2x2:{align:8,size:16},mat3x2:{align:8,size:24},mat4x2:{align:8,size:32},mat2x3:{align:16,size:32},mat3x3:{align:16,size:48},mat4x3:{align:16,size:64},mat2x4:{align:16,size:32},mat3x4:{align:16,size:48},mat4x4:{align:16,size:64}},pd._textureTypes=vt.any_texture_type.map(t=>t.name),pd._samplerTypes=vt.sampler_type.map(t=>t.name);let r6=0;class n6{constructor(e,r,n){this.id=r6++,this.name=e,this.value=r,this.node=n}clone(){return new n6(this.name,this.value,this.node)}}class i6{constructor(e){this.id=r6++,this.name=e.name,this.node=e}clone(){return new i6(this.node)}}class a6{constructor(e){this.parent=null,this.variables=new Map,this.functions=new Map,this.currentFunctionName="",this.id=r6++,e&&(this.parent=e,this.currentFunctionName=e.currentFunctionName)}getVariable(e){var r;return this.variables.has(e)?(r=this.variables.get(e))!==null&&r!==void 0?r:null:this.parent?this.parent.getVariable(e):null}getFunction(e){var r;return this.functions.has(e)?(r=this.functions.get(e))!==null&&r!==void 0?r:null:this.parent?this.parent.getFunction(e):null}createVariable(e,r,n){this.variables.set(e,new n6(e,r,n??null))}setVariable(e,r,n){const i=this.getVariable(e);i!==null?i.value=r:this.createVariable(e,r,n)}getVariableValue(e){var r;const n=this.getVariable(e);return(r=n?.value)!==null&&r!==void 0?r:null}clone(){return new a6(this)}}class _7e{evalExpression(e,r){return null}getTypeInfo(e){return null}getVariableName(e,r){return""}}class b7e{constructor(e){this.exec=e}getTypeInfo(e){return this.exec.getTypeInfo(e)}All(e,r){const n=this.exec.evalExpression(e.args[0],r);let i=!0;if(n instanceof kt)return n.data.forEach(a=>{a||(i=!1)}),new ir(i?1:0,this.getTypeInfo("bool"));throw new Error(`All() expects a vector argument. Line ${e.line}`)}Any(e,r){const n=this.exec.evalExpression(e.args[0],r);if(n instanceof kt){const i=n.data.some(a=>a);return new ir(i?1:0,this.getTypeInfo("bool"))}throw new Error(`Any() expects a vector argument. Line ${e.line}`)}Select(e,r){const n=this.exec.evalExpression(e.args[2],r);if(!(n instanceof ir))throw new Error(`Select() expects a bool condition. Line ${e.line}`);return n.value?this.exec.evalExpression(e.args[1],r):this.exec.evalExpression(e.args[0],r)}ArrayLength(e,r){let n=e.args[0];n instanceof wl&&(n=n.right);const i=this.exec.evalExpression(n,r);if(i instanceof js&&i.typeInfo.size===0){const a=i.typeInfo,s=i.buffer.byteLength/a.stride;return new ir(s,this.getTypeInfo("u32"))}return new ir(i.typeInfo.size,this.getTypeInfo("u32"))}Abs(e,r){const n=this.exec.evalExpression(e.args[0],r);if(n instanceof kt)return new kt(n.data.map(a=>Math.abs(a)),n.typeInfo);const i=n;return new ir(Math.abs(i.value),i.typeInfo)}Acos(e,r){const n=this.exec.evalExpression(e.args[0],r);if(n instanceof kt)return new kt(n.data.map(a=>Math.acos(a)),n.typeInfo);const i=n;return new ir(Math.acos(i.value),n.typeInfo)}Acosh(e,r){const n=this.exec.evalExpression(e.args[0],r);if(n instanceof kt)return new kt(n.data.map(a=>Math.acosh(a)),n.typeInfo);const i=n;return new ir(Math.acosh(i.value),n.typeInfo)}Asin(e,r){const n=this.exec.evalExpression(e.args[0],r);if(n instanceof kt)return new kt(n.data.map(a=>Math.asin(a)),n.typeInfo);const i=n;return new ir(Math.asin(i.value),n.typeInfo)}Asinh(e,r){const n=this.exec.evalExpression(e.args[0],r);if(n instanceof kt)return new kt(n.data.map(a=>Math.asinh(a)),n.typeInfo);const i=n;return new ir(Math.asinh(i.value),n.typeInfo)}Atan(e,r){const n=this.exec.evalExpression(e.args[0],r);if(n instanceof kt)return new kt(n.data.map(a=>Math.atan(a)),n.typeInfo);const i=n;return new ir(Math.atan(i.value),n.typeInfo)}Atanh(e,r){const n=this.exec.evalExpression(e.args[0],r);if(n instanceof kt)return new kt(n.data.map(a=>Math.atanh(a)),n.typeInfo);const i=n;return new ir(Math.atanh(i.value),n.typeInfo)}Atan2(e,r){const n=this.exec.evalExpression(e.args[0],r),i=this.exec.evalExpression(e.args[1],r);if(n instanceof kt&&i instanceof kt)return new kt(n.data.map((o,c)=>Math.atan2(o,i.data[c])),n.typeInfo);const a=n,s=i;return new ir(Math.atan2(a.value,s.value),n.typeInfo)}Ceil(e,r){const n=this.exec.evalExpression(e.args[0],r);if(n instanceof kt)return new kt(n.data.map(a=>Math.ceil(a)),n.typeInfo);const i=n;return new ir(Math.ceil(i.value),n.typeInfo)}_clamp(e,r,n){return Math.min(Math.max(e,r),n)}Clamp(e,r){const n=this.exec.evalExpression(e.args[0],r),i=this.exec.evalExpression(e.args[1],r),a=this.exec.evalExpression(e.args[2],r);if(n instanceof kt&&i instanceof kt&&a instanceof kt)return new kt(n.data.map((f,d)=>this._clamp(f,i.data[d],a.data[d])),n.typeInfo);const s=n,o=i,c=a;return new ir(this._clamp(s.value,o.value,c.value),n.typeInfo)}Cos(e,r){const n=this.exec.evalExpression(e.args[0],r);if(n instanceof kt)return new kt(n.data.map(a=>Math.cos(a)),n.typeInfo);const i=n;return new ir(Math.cos(i.value),n.typeInfo)}Cosh(e,r){const n=this.exec.evalExpression(e.args[0],r);if(n instanceof kt)return new kt(n.data.map(a=>Math.cosh(a)),n.typeInfo);const i=n;return new ir(Math.cos(i.value),n.typeInfo)}CountLeadingZeros(e,r){const n=this.exec.evalExpression(e.args[0],r);if(n instanceof kt)return new kt(n.data.map(a=>Math.clz32(a)),n.typeInfo);const i=n;return new ir(Math.clz32(i.value),n.typeInfo)}_countOneBits(e){let r=0;for(;e!==0;)1&e&&r++,e>>=1;return r}CountOneBits(e,r){const n=this.exec.evalExpression(e.args[0],r);if(n instanceof kt)return new kt(n.data.map(a=>this._countOneBits(a)),n.typeInfo);const i=n;return new ir(this._countOneBits(i.value),n.typeInfo)}_countTrailingZeros(e){if(e===0)return 32;let r=0;for(;!(1&e);)e>>=1,r++;return r}CountTrailingZeros(e,r){const n=this.exec.evalExpression(e.args[0],r);if(n instanceof kt)return new kt(n.data.map(a=>this._countTrailingZeros(a)),n.typeInfo);const i=n;return new ir(this._countTrailingZeros(i.value),n.typeInfo)}Cross(e,r){const n=this.exec.evalExpression(e.args[0],r),i=this.exec.evalExpression(e.args[1],r);if(n instanceof kt&&i instanceof kt){if(n.data.length!==3||i.data.length!==3)return console.error(`Cross() expects 3D vectors. Line ${e.line}`),null;const a=n.data,s=i.data;return new kt([a[1]*s[2]-s[1]*a[2],a[2]*s[0]-s[2]*a[0],a[0]*s[1]-s[0]*a[1]],n.typeInfo)}return console.error(`Cross() expects vector arguments. Line ${e.line}`),null}Degrees(e,r){const n=this.exec.evalExpression(e.args[0],r),i=180/Math.PI;return n instanceof kt?new kt(n.data.map(a=>a*i),n.typeInfo):new ir(n.value*i,this.getTypeInfo("f32"))}Determinant(e,r){const n=this.exec.evalExpression(e.args[0],r);if(n instanceof Ii){const i=n.data,a=n.typeInfo.getTypeName(),s=a.endsWith("h")?this.getTypeInfo("f16"):this.getTypeInfo("f32");if(a==="mat2x2"||a==="mat2x2f"||a==="mat2x2h")return new ir(i[0]*i[3]-i[1]*i[2],s);if(a==="mat2x3"||a==="mat2x3f"||a==="mat2x3h")return new ir(i[0]*(i[4]*i[8]-i[5]*i[7])-i[1]*(i[3]*i[8]-i[5]*i[6])+i[2]*(i[3]*i[7]-i[4]*i[6]),s);if(a==="mat2x4"||a==="mat2x4f"||a==="mat2x4h")console.error(`TODO: Determinant for ${a}`);else if(a==="mat3x2"||a==="mat3x2f"||a==="mat3x2h")console.error(`TODO: Determinant for ${a}`);else{if(a==="mat3x3"||a==="mat3x3f"||a==="mat3x3h")return new ir(i[0]*(i[4]*i[8]-i[5]*i[7])-i[1]*(i[3]*i[8]-i[5]*i[6])+i[2]*(i[3]*i[7]-i[4]*i[6]),s);a==="mat3x4"||a==="mat3x4f"||a==="mat3x4h"||a==="mat4x2"||a==="mat4x2f"||a==="mat4x2h"||a==="mat4x3"||a==="mat4x3f"||a==="mat4x3h"?console.error(`TODO: Determinant for ${a}`):a!=="mat4x4"&&a!=="mat4x4f"&&a!=="mat4x4h"||console.error(`TODO: Determinant for ${a}`)}}return console.error(`Determinant expects a matrix argument. Line ${e.line}`),null}Distance(e,r){const n=this.exec.evalExpression(e.args[0],r),i=this.exec.evalExpression(e.args[1],r);if(n instanceof kt&&i instanceof kt){let o=0;for(let c=0;c<n.data.length;++c)o+=(n.data[c]-i.data[c])*(n.data[c]-i.data[c]);return new ir(Math.sqrt(o),this.getTypeInfo("f32"))}const a=n,s=i;return new ir(Math.abs(a.value-s.value),n.typeInfo)}_dot(e,r){let n=0;for(let i=0;i<e.length;++i)n+=r[i]*e[i];return n}Dot(e,r){const n=this.exec.evalExpression(e.args[0],r),i=this.exec.evalExpression(e.args[1],r);return n instanceof kt&&i instanceof kt?new ir(this._dot(n.data,i.data),this.getTypeInfo("f32")):(console.error(`Dot() expects vector arguments. Line ${e.line}`),null)}Dot4U8Packed(e,r){return console.error(`TODO: dot4U8Packed. Line ${e.line}`),null}Dot4I8Packed(e,r){return console.error(`TODO: dot4I8Packed. Line ${e.line}`),null}Exp(e,r){const n=this.exec.evalExpression(e.args[0],r);if(n instanceof kt)return new kt(n.data.map(a=>Math.exp(a)),n.typeInfo);const i=n;return new ir(Math.exp(i.value),n.typeInfo)}Exp2(e,r){const n=this.exec.evalExpression(e.args[0],r);if(n instanceof kt)return new kt(n.data.map(a=>Math.pow(2,a)),n.typeInfo);const i=n;return new ir(Math.pow(2,i.value),n.typeInfo)}ExtractBits(e,r){const n=this.exec.evalExpression(e.args[0],r),i=this.exec.evalExpression(e.args[1],r),a=this.exec.evalExpression(e.args[2],r);if(i.typeInfo.name!=="u32"&&i.typeInfo.name!=="x32")return console.error(`ExtractBits() expects an i32 offset argument. Line ${e.line}`),null;if(a.typeInfo.name!=="u32"&&a.typeInfo.name!=="x32")return console.error(`ExtractBits() expects an i32 count argument. Line ${e.line}`),null;const s=i.value,o=a.value;if(n instanceof kt)return new kt(n.data.map(f=>f>>s&(1<<o)-1),n.typeInfo);if(n.typeInfo.name!=="i32"&&n.typeInfo.name!=="x32")return console.error(`ExtractBits() expects an i32 argument. Line ${e.line}`),null;const c=n.value;return new ir(c>>s&(1<<o)-1,this.getTypeInfo("i32"))}FaceForward(e,r){const n=this.exec.evalExpression(e.args[0],r),i=this.exec.evalExpression(e.args[1],r),a=this.exec.evalExpression(e.args[2],r);if(n instanceof kt&&i instanceof kt&&a instanceof kt){const s=this._dot(i.data,a.data);return new kt(s<0?Array.from(n.data):n.data.map(o=>-o),n.typeInfo)}return console.error(`FaceForward() expects vector arguments. Line ${e.line}`),null}_firstLeadingBit(e){return e===0?-1:31-Math.clz32(e)}FirstLeadingBit(e,r){const n=this.exec.evalExpression(e.args[0],r);if(n instanceof kt)return new kt(n.data.map(a=>this._firstLeadingBit(a)),n.typeInfo);const i=n;return new ir(this._firstLeadingBit(i.value),n.typeInfo)}_firstTrailingBit(e){return e===0?-1:Math.log2(e&-e)}FirstTrailingBit(e,r){const n=this.exec.evalExpression(e.args[0],r);if(n instanceof kt)return new kt(n.data.map(a=>this._firstTrailingBit(a)),n.typeInfo);const i=n;return new ir(this._firstTrailingBit(i.value),n.typeInfo)}Floor(e,r){const n=this.exec.evalExpression(e.args[0],r);if(n instanceof kt)return new kt(n.data.map(a=>Math.floor(a)),n.typeInfo);const i=n;return new ir(Math.floor(i.value),n.typeInfo)}Fma(e,r){const n=this.exec.evalExpression(e.args[0],r),i=this.exec.evalExpression(e.args[1],r),a=this.exec.evalExpression(e.args[2],r);if(n instanceof kt&&i instanceof kt&&a instanceof kt)return n.data.length!==i.data.length||n.data.length!==a.data.length?(console.error(`Fma() expects vectors of the same length. Line ${e.line}`),null):new kt(n.data.map((f,d)=>f*i.data[d]+a.data[d]),n.typeInfo);const s=n,o=i,c=a;return new ir(s.value*o.value+c.value,s.typeInfo)}Fract(e,r){const n=this.exec.evalExpression(e.args[0],r);if(n instanceof kt)return new kt(n.data.map(a=>a-Math.floor(a)),n.typeInfo);const i=n;return new ir(i.value-Math.floor(i.value),n.typeInfo)}Frexp(e,r){return console.error(`TODO: frexp. Line ${e.line}`),null}InsertBits(e,r){const n=this.exec.evalExpression(e.args[0],r),i=this.exec.evalExpression(e.args[1],r),a=this.exec.evalExpression(e.args[2],r),s=this.exec.evalExpression(e.args[3],r);if(a.typeInfo.name!=="u32"&&a.typeInfo.name!=="x32")return console.error(`InsertBits() expects an i32 offset argument. Line ${e.line}`),null;const o=a.value,c=(1<<s.value)-1<<o,f=~c;if(n instanceof kt&&i instanceof kt)return new kt(n.data.map((b,x)=>b&f|i.data[x]<<o&c),n.typeInfo);const d=n.value,m=i.value;return new ir(d&f|m<<o&c,n.typeInfo)}InverseSqrt(e,r){const n=this.exec.evalExpression(e.args[0],r);if(n instanceof kt)return new kt(n.data.map(a=>1/Math.sqrt(a)),n.typeInfo);const i=n;return new ir(1/Math.sqrt(i.value),n.typeInfo)}Ldexp(e,r){return console.error(`TODO: ldexp. Line ${e.line}`),null}Length(e,r){const n=this.exec.evalExpression(e.args[0],r);if(n instanceof kt){let a=0;return n.data.forEach(s=>{a+=s*s}),new ir(Math.sqrt(a),this.getTypeInfo("f32"))}const i=n;return new ir(Math.abs(i.value),n.typeInfo)}Log(e,r){const n=this.exec.evalExpression(e.args[0],r);if(n instanceof kt)return new kt(n.data.map(a=>Math.log(a)),n.typeInfo);const i=n;return new ir(Math.log(i.value),n.typeInfo)}Log2(e,r){const n=this.exec.evalExpression(e.args[0],r);if(n instanceof kt)return new kt(n.data.map(a=>Math.log2(a)),n.typeInfo);const i=n;return new ir(Math.log2(i.value),n.typeInfo)}Max(e,r){const n=this.exec.evalExpression(e.args[0],r),i=this.exec.evalExpression(e.args[1],r);if(n instanceof kt&&i instanceof kt)return new kt(n.data.map((o,c)=>Math.max(o,i.data[c])),n.typeInfo);const a=n,s=i;return new ir(Math.max(a.value,s.value),n.typeInfo)}Min(e,r){const n=this.exec.evalExpression(e.args[0],r),i=this.exec.evalExpression(e.args[1],r);if(n instanceof kt&&i instanceof kt)return new kt(n.data.map((o,c)=>Math.min(o,i.data[c])),n.typeInfo);const a=n,s=i;return new ir(Math.min(a.value,s.value),n.typeInfo)}Mix(e,r){const n=this.exec.evalExpression(e.args[0],r),i=this.exec.evalExpression(e.args[1],r),a=this.exec.evalExpression(e.args[2],r);if(n instanceof kt&&i instanceof kt&&a instanceof kt)return new kt(n.data.map((c,f)=>n.data[f]*(1-a.data[f])+i.data[f]*a.data[f]),n.typeInfo);const s=i,o=a;return new ir(n.value*(1-o.value)+s.value*o.value,n.typeInfo)}Modf(e,r){const n=this.exec.evalExpression(e.args[0],r),i=this.exec.evalExpression(e.args[1],r);if(n instanceof kt&&i instanceof kt)return new kt(n.data.map((s,o)=>s%i.data[o]),n.typeInfo);const a=i;return new ir(n.value%a.value,n.typeInfo)}Normalize(e,r){const n=this.exec.evalExpression(e.args[0],r);if(n instanceof kt){const i=this.Length(e,r).value;return new kt(n.data.map(a=>a/i),n.typeInfo)}return console.error(`Normalize() expects a vector argument. Line ${e.line}`),null}Pow(e,r){const n=this.exec.evalExpression(e.args[0],r),i=this.exec.evalExpression(e.args[1],r);if(n instanceof kt&&i instanceof kt)return new kt(n.data.map((o,c)=>Math.pow(o,i.data[c])),n.typeInfo);const a=n,s=i;return new ir(Math.pow(a.value,s.value),n.typeInfo)}QuantizeToF16(e,r){const n=this.exec.evalExpression(e.args[0],r);return n instanceof kt?new kt(n.data.map(i=>i),n.typeInfo):new ir(n.value,n.typeInfo)}Radians(e,r){const n=this.exec.evalExpression(e.args[0],r);return n instanceof kt?new kt(n.data.map(i=>i*Math.PI/180),n.typeInfo):new ir(n.value*Math.PI/180,this.getTypeInfo("f32"))}Reflect(e,r){let n=this.exec.evalExpression(e.args[0],r),i=this.exec.evalExpression(e.args[1],r);if(n instanceof kt&&i instanceof kt){const a=this._dot(n.data,i.data);return new kt(n.data.map((s,o)=>s-2*a*i.data[o]),n.typeInfo)}return console.error(`Reflect() expects vector arguments. Line ${e.line}`),null}Refract(e,r){let n=this.exec.evalExpression(e.args[0],r),i=this.exec.evalExpression(e.args[1],r),a=this.exec.evalExpression(e.args[2],r);if(n instanceof kt&&i instanceof kt&&a instanceof ir){const s=this._dot(i.data,n.data);return new kt(n.data.map((o,c)=>{const f=1-a.value*a.value*(1-s*s);if(f<0)return 0;const d=Math.sqrt(f);return a.value*o-(a.value*s+d)*i.data[c]}),n.typeInfo)}return console.error(`Refract() expects vector arguments and a scalar argument. Line ${e.line}`),null}ReverseBits(e,r){return console.error(`TODO: reverseBits. Line ${e.line}`),null}Round(e,r){const n=this.exec.evalExpression(e.args[0],r);if(n instanceof kt)return new kt(n.data.map(a=>Math.round(a)),n.typeInfo);const i=n;return new ir(Math.round(i.value),n.typeInfo)}Saturate(e,r){const n=this.exec.evalExpression(e.args[0],r);if(n instanceof kt)return new kt(n.data.map(a=>Math.min(Math.max(a,0),1)),n.typeInfo);const i=n;return new ir(Math.min(Math.max(i.value,0),1),n.typeInfo)}Sign(e,r){const n=this.exec.evalExpression(e.args[0],r);if(n instanceof kt)return new kt(n.data.map(a=>Math.sign(a)),n.typeInfo);const i=n;return new ir(Math.sign(i.value),n.typeInfo)}Sin(e,r){const n=this.exec.evalExpression(e.args[0],r);if(n instanceof kt)return new kt(n.data.map(a=>Math.sin(a)),n.typeInfo);const i=n;return new ir(Math.sin(i.value),n.typeInfo)}Sinh(e,r){const n=this.exec.evalExpression(e.args[0],r);if(n instanceof kt)return new kt(n.data.map(a=>Math.sinh(a)),n.typeInfo);const i=n;return new ir(Math.sinh(i.value),n.typeInfo)}_smoothstep(e,r,n){const i=Math.min(Math.max((n-e)/(r-e),0),1);return i*i*(3-2*i)}SmoothStep(e,r){const n=this.exec.evalExpression(e.args[0],r),i=this.exec.evalExpression(e.args[1],r),a=this.exec.evalExpression(e.args[2],r);if(a instanceof kt&&n instanceof kt&&i instanceof kt)return new kt(a.data.map((f,d)=>this._smoothstep(n.data[d],i.data[d],f)),a.typeInfo);const s=n,o=i,c=a;return new ir(this._smoothstep(s.value,o.value,c.value),a.typeInfo)}Sqrt(e,r){const n=this.exec.evalExpression(e.args[0],r);if(n instanceof kt)return new kt(n.data.map(a=>Math.sqrt(a)),n.typeInfo);const i=n;return new ir(Math.sqrt(i.value),n.typeInfo)}Step(e,r){const n=this.exec.evalExpression(e.args[0],r),i=this.exec.evalExpression(e.args[1],r);if(i instanceof kt&&n instanceof kt)return new kt(i.data.map((s,o)=>s<n.data[o]?0:1),i.typeInfo);const a=n;return new ir(i.value<a.value?0:1,a.typeInfo)}Tan(e,r){const n=this.exec.evalExpression(e.args[0],r);if(n instanceof kt)return new kt(n.data.map(a=>Math.tan(a)),n.typeInfo);const i=n;return new ir(Math.tan(i.value),n.typeInfo)}Tanh(e,r){const n=this.exec.evalExpression(e.args[0],r);if(n instanceof kt)return new kt(n.data.map(a=>Math.tanh(a)),n.typeInfo);const i=n;return new ir(Math.tanh(i.value),n.typeInfo)}_getTransposeType(e){const r=e.getTypeName();return r==="mat2x2f"||r==="mat2x2h"?e:r==="mat2x3f"?this.getTypeInfo("mat3x2f"):r==="mat2x3h"?this.getTypeInfo("mat3x2h"):r==="mat2x4f"?this.getTypeInfo("mat4x2f"):r==="mat2x4h"?this.getTypeInfo("mat4x2h"):r==="mat3x2f"?this.getTypeInfo("mat2x3f"):r==="mat3x2h"?this.getTypeInfo("mat2x3h"):r==="mat3x3f"||r==="mat3x3h"?e:r==="mat3x4f"?this.getTypeInfo("mat4x3f"):r==="mat3x4h"?this.getTypeInfo("mat4x3h"):r==="mat4x2f"?this.getTypeInfo("mat2x4f"):r==="mat4x2h"?this.getTypeInfo("mat2x4h"):r==="mat4x3f"?this.getTypeInfo("mat3x4f"):r==="mat4x3h"?this.getTypeInfo("mat3x4h"):(r==="mat4x4f"||r==="mat4x4h"||console.error(`Invalid matrix type ${r}`),e)}Transpose(e,r){const n=this.exec.evalExpression(e.args[0],r);if(!(n instanceof Ii))return console.error(`Transpose() expects a matrix argument. Line ${e.line}`),null;const i=this._getTransposeType(n.typeInfo);if(n.typeInfo.name==="mat2x2"||n.typeInfo.name==="mat2x2f"||n.typeInfo.name==="mat2x2h"){const a=n.data;return new Ii([a[0],a[2],a[1],a[3]],i)}if(n.typeInfo.name==="mat2x3"||n.typeInfo.name==="mat2x3f"||n.typeInfo.name==="mat2x3h"){const a=n.data;return new Ii([a[0],a[3],a[6],a[1],a[4],a[7]],i)}if(n.typeInfo.name==="mat2x4"||n.typeInfo.name==="mat2x4f"||n.typeInfo.name==="mat2x4h"){const a=n.data;return new Ii([a[0],a[4],a[8],a[12],a[1],a[5],a[9],a[13]],i)}if(n.typeInfo.name==="mat3x2"||n.typeInfo.name==="mat3x2f"||n.typeInfo.name==="mat3x2h"){const a=n.data;return new Ii([a[0],a[3],a[1],a[4],a[2],a[5]],i)}if(n.typeInfo.name==="mat3x3"||n.typeInfo.name==="mat3x3f"||n.typeInfo.name==="mat3x3h"){const a=n.data;return new Ii([a[0],a[3],a[6],a[1],a[4],a[7],a[2],a[5],a[8]],i)}if(n.typeInfo.name==="mat3x4"||n.typeInfo.name==="mat3x4f"||n.typeInfo.name==="mat3x4h"){const a=n.data;return new Ii([a[0],a[4],a[8],a[12],a[1],a[5],a[9],a[13],a[2],a[6],a[10],a[14]],i)}if(n.typeInfo.name==="mat4x2"||n.typeInfo.name==="mat4x2f"||n.typeInfo.name==="mat4x2h"){const a=n.data;return new Ii([a[0],a[4],a[1],a[5],a[2],a[6]],i)}if(n.typeInfo.name==="mat4x3"||n.typeInfo.name==="mat4x3f"||n.typeInfo.name==="mat4x3h"){const a=n.data;return new Ii([a[0],a[4],a[8],a[1],a[5],a[9],a[2],a[6],a[10]],i)}if(n.typeInfo.name==="mat4x4"||n.typeInfo.name==="mat4x4f"||n.typeInfo.name==="mat4x4h"){const a=n.data;return new Ii([a[0],a[4],a[8],a[12],a[1],a[5],a[9],a[13],a[2],a[6],a[10],a[14],a[3],a[7],a[11],a[15]],i)}return console.error(`Invalid matrix type ${n.typeInfo.name}`),null}Trunc(e,r){const n=this.exec.evalExpression(e.args[0],r);if(n instanceof kt)return new kt(n.data.map(a=>Math.trunc(a)),n.typeInfo);const i=n;return new ir(Math.trunc(i.value),n.typeInfo)}Dpdx(e,r){return console.error(`TODO: dpdx. Line ${e.line}`),null}DpdxCoarse(e,r){return console.error(`TODO: dpdxCoarse. Line ${e.line}`),null}DpdxFine(e,r){return console.error("TODO: dpdxFine"),null}Dpdy(e,r){return console.error("TODO: dpdy"),null}DpdyCoarse(e,r){return console.error("TODO: dpdyCoarse"),null}DpdyFine(e,r){return console.error("TODO: dpdyFine"),null}Fwidth(e,r){return console.error("TODO: fwidth"),null}FwidthCoarse(e,r){return console.error("TODO: fwidthCoarse"),null}FwidthFine(e,r){return console.error("TODO: fwidthFine"),null}TextureDimensions(e,r){const n=e.args[0],i=e.args.length>1?this.exec.evalExpression(e.args[1],r).value:0;if(n instanceof af){const a=n.name,s=r.getVariableValue(a);if(s instanceof sp){if(i<0||i>=s.mipLevelCount)return console.error(`Invalid mip level for textureDimensions. Line ${e.line}`),null;const o=s.getMipLevelSize(i),c=s.dimension;return c==="1d"?new ir(o[0],this.getTypeInfo("u32")):c==="3d"?new kt(o,this.getTypeInfo("vec3u")):c==="2d"?new kt(o.slice(0,2),this.getTypeInfo("vec2u")):(console.error(`Invalid texture dimension ${c} not found. Line ${e.line}`),null)}return console.error(`Texture ${a} not found. Line ${e.line}`),null}return console.error(`Invalid texture argument for textureDimensions. Line ${e.line}`),null}TextureGather(e,r){return console.error("TODO: textureGather"),null}TextureGatherCompare(e,r){return console.error("TODO: textureGatherCompare"),null}TextureLoad(e,r){const n=e.args[0],i=this.exec.evalExpression(e.args[1],r),a=e.args.length>2?this.exec.evalExpression(e.args[2],r).value:0;if(!(i instanceof kt)||i.data.length!==2)return console.error(`Invalid UV argument for textureLoad. Line ${e.line}`),null;if(n instanceof af){const s=n.name,o=r.getVariableValue(s);if(o instanceof sp){const c=Math.floor(i.data[0]),f=Math.floor(i.data[1]);if(c<0||c>=o.width||f<0||f>=o.height)return console.error(`Texture ${s} out of bounds. Line ${e.line}`),null;const d=o.getPixel(c,f,0,a);return d===null?(console.error(`Invalid texture format for textureLoad. Line ${e.line}`),null):new kt(d,this.getTypeInfo("vec4f"))}return console.error(`Texture ${s} not found. Line ${e.line}`),null}return console.error(`Invalid texture argument for textureLoad. Line ${e.line}`),null}TextureNumLayers(e,r){const n=e.args[0];if(n instanceof af){const i=n.name,a=r.getVariableValue(i);return a instanceof sp?new ir(a.depthOrArrayLayers,this.getTypeInfo("u32")):(console.error(`Texture ${i} not found. Line ${e.line}`),null)}return console.error(`Invalid texture argument for textureNumLayers. Line ${e.line}`),null}TextureNumLevels(e,r){const n=e.args[0];if(n instanceof af){const i=n.name,a=r.getVariableValue(i);return a instanceof sp?new ir(a.mipLevelCount,this.getTypeInfo("u32")):(console.error(`Texture ${i} not found. Line ${e.line}`),null)}return console.error(`Invalid texture argument for textureNumLevels. Line ${e.line}`),null}TextureNumSamples(e,r){const n=e.args[0];if(n instanceof af){const i=n.name,a=r.getVariableValue(i);return a instanceof sp?new ir(a.sampleCount,this.getTypeInfo("u32")):(console.error(`Texture ${i} not found. Line ${e.line}`),null)}return console.error(`Invalid texture argument for textureNumSamples. Line ${e.line}`),null}TextureSample(e,r){return console.error("TODO: textureSample"),null}TextureSampleBias(e,r){return console.error("TODO: textureSampleBias"),null}TextureSampleCompare(e,r){return console.error("TODO: textureSampleCompare"),null}TextureSampleCompareLevel(e,r){return console.error("TODO: textureSampleCompareLevel"),null}TextureSampleGrad(e,r){return console.error("TODO: textureSampleGrad"),null}TextureSampleLevel(e,r){return console.error("TODO: textureSampleLevel"),null}TextureSampleBaseClampToEdge(e,r){return console.error("TODO: textureSampleBaseClampToEdge"),null}TextureStore(e,r){const n=e.args[0],i=this.exec.evalExpression(e.args[1],r),a=e.args.length===4?this.exec.evalExpression(e.args[2],r).value:0,s=e.args.length===4?this.exec.evalExpression(e.args[3],r).data:this.exec.evalExpression(e.args[2],r).data;if(s.length!==4)return console.error(`Invalid value argument for textureStore. Line ${e.line}`),null;if(!(i instanceof kt)||i.data.length!==2)return console.error(`Invalid UV argument for textureStore. Line ${e.line}`),null;if(n instanceof af){const o=n.name,c=r.getVariableValue(o);if(c instanceof sp){const f=c.getMipLevelSize(0),d=Math.floor(i.data[0]),m=Math.floor(i.data[1]);return d<0||d>=f[0]||m<0||m>=f[1]?(console.error(`Texture ${o} out of bounds. Line ${e.line}`),null):(c.setPixel(d,m,0,a,Array.from(s)),null)}return console.error(`Texture ${o} not found. Line ${e.line}`),null}return console.error(`Invalid texture argument for textureStore. Line ${e.line}`),null}AtomicLoad(e,r){let n=e.args[0];n instanceof wl&&(n=n.right);const i=this.exec.getVariableName(n,r);return r.getVariable(i).value.getSubData(this.exec,n.postfix,r)}AtomicStore(e,r){let n=e.args[0];n instanceof wl&&(n=n.right);const i=this.exec.getVariableName(n,r),a=r.getVariable(i);let s=e.args[1];const o=this.exec.evalExpression(s,r),c=a.value.getSubData(this.exec,n.postfix,r);return c instanceof ir&&o instanceof ir&&(c.value=o.value),a.value instanceof js&&a.value.setDataValue(this.exec,c,n.postfix,r),null}AtomicAdd(e,r){let n=e.args[0];n instanceof wl&&(n=n.right);const i=this.exec.getVariableName(n,r),a=r.getVariable(i);let s=e.args[1];const o=this.exec.evalExpression(s,r),c=a.value.getSubData(this.exec,n.postfix,r),f=new ir(c.value,c.typeInfo);return c instanceof ir&&o instanceof ir&&(c.value+=o.value),a.value instanceof js&&a.value.setDataValue(this.exec,c,n.postfix,r),f}AtomicSub(e,r){let n=e.args[0];n instanceof wl&&(n=n.right);const i=this.exec.getVariableName(n,r),a=r.getVariable(i);let s=e.args[1];const o=this.exec.evalExpression(s,r),c=a.value.getSubData(this.exec,n.postfix,r),f=new ir(c.value,c.typeInfo);return c instanceof ir&&o instanceof ir&&(c.value-=o.value),a.value instanceof js&&a.value.setDataValue(this.exec,c,n.postfix,r),f}AtomicMax(e,r){let n=e.args[0];n instanceof wl&&(n=n.right);const i=this.exec.getVariableName(n,r),a=r.getVariable(i);let s=e.args[1];const o=this.exec.evalExpression(s,r),c=a.value.getSubData(this.exec,n.postfix,r),f=new ir(c.value,c.typeInfo);return c instanceof ir&&o instanceof ir&&(c.value=Math.max(c.value,o.value)),a.value instanceof js&&a.value.setDataValue(this.exec,c,n.postfix,r),f}AtomicMin(e,r){let n=e.args[0];n instanceof wl&&(n=n.right);const i=this.exec.getVariableName(n,r),a=r.getVariable(i);let s=e.args[1];const o=this.exec.evalExpression(s,r),c=a.value.getSubData(this.exec,n.postfix,r),f=new ir(c.value,c.typeInfo);return c instanceof ir&&o instanceof ir&&(c.value=Math.min(c.value,o.value)),a.value instanceof js&&a.value.setDataValue(this.exec,c,n.postfix,r),f}AtomicAnd(e,r){let n=e.args[0];n instanceof wl&&(n=n.right);const i=this.exec.getVariableName(n,r),a=r.getVariable(i);let s=e.args[1];const o=this.exec.evalExpression(s,r),c=a.value.getSubData(this.exec,n.postfix,r),f=new ir(c.value,c.typeInfo);return c instanceof ir&&o instanceof ir&&(c.value=c.value&o.value),a.value instanceof js&&a.value.setDataValue(this.exec,c,n.postfix,r),f}AtomicOr(e,r){let n=e.args[0];n instanceof wl&&(n=n.right);const i=this.exec.getVariableName(n,r),a=r.getVariable(i);let s=e.args[1];const o=this.exec.evalExpression(s,r),c=a.value.getSubData(this.exec,n.postfix,r),f=new ir(c.value,c.typeInfo);return c instanceof ir&&o instanceof ir&&(c.value=c.value|o.value),a.value instanceof js&&a.value.setDataValue(this.exec,c,n.postfix,r),f}AtomicXor(e,r){let n=e.args[0];n instanceof wl&&(n=n.right);const i=this.exec.getVariableName(n,r),a=r.getVariable(i);let s=e.args[1];const o=this.exec.evalExpression(s,r),c=a.value.getSubData(this.exec,n.postfix,r),f=new ir(c.value,c.typeInfo);return c instanceof ir&&o instanceof ir&&(c.value=c.value^o.value),a.value instanceof js&&a.value.setDataValue(this.exec,c,n.postfix,r),f}AtomicExchange(e,r){let n=e.args[0];n instanceof wl&&(n=n.right);const i=this.exec.getVariableName(n,r),a=r.getVariable(i);let s=e.args[1];const o=this.exec.evalExpression(s,r),c=a.value.getSubData(this.exec,n.postfix,r),f=new ir(c.value,c.typeInfo);return c instanceof ir&&o instanceof ir&&(c.value=o.value),a.value instanceof js&&a.value.setDataValue(this.exec,c,n.postfix,r),f}AtomicCompareExchangeWeak(e,r){return console.error("TODO: atomicCompareExchangeWeak"),null}Pack4x8snorm(e,r){return console.error("TODO: pack4x8snorm"),null}Pack4x8unorm(e,r){return console.error("TODO: pack4x8unorm"),null}Pack4xI8(e,r){return console.error("TODO: pack4xI8"),null}Pack4xU8(e,r){return console.error("TODO: pack4xU8"),null}Pack4x8Clamp(e,r){return console.error("TODO: pack4x8Clamp"),null}Pack4xU8Clamp(e,r){return console.error("TODO: pack4xU8Clamp"),null}Pack2x16snorm(e,r){return console.error("TODO: pack2x16snorm"),null}Pack2x16unorm(e,r){return console.error("TODO: pack2x16unorm"),null}Pack2x16float(e,r){return console.error("TODO: pack2x16float"),null}Unpack4x8snorm(e,r){return console.error("TODO: unpack4x8snorm"),null}Unpack4x8unorm(e,r){return console.error("TODO: unpack4x8unorm"),null}Unpack4xI8(e,r){return console.error("TODO: unpack4xI8"),null}Unpack4xU8(e,r){return console.error("TODO: unpack4xU8"),null}Unpack2x16snorm(e,r){return console.error("TODO: unpack2x16snorm"),null}Unpack2x16unorm(e,r){return console.error("TODO: unpack2x16unorm"),null}Unpack2x16float(e,r){return console.error("TODO: unpack2x16float"),null}StorageBarrier(e,r){return null}TextureBarrier(e,r){return null}WorkgroupBarrier(e,r){return null}WorkgroupUniformLoad(e,r){return null}SubgroupAdd(e,r){return console.error("TODO: subgroupAdd"),null}SubgroupExclusiveAdd(e,r){return console.error("TODO: subgroupExclusiveAdd"),null}SubgroupInclusiveAdd(e,r){return console.error("TODO: subgroupInclusiveAdd"),null}SubgroupAll(e,r){return console.error("TODO: subgroupAll"),null}SubgroupAnd(e,r){return console.error("TODO: subgroupAnd"),null}SubgroupAny(e,r){return console.error("TODO: subgroupAny"),null}SubgroupBallot(e,r){return console.error("TODO: subgroupBallot"),null}SubgroupBroadcast(e,r){return console.error("TODO: subgroupBroadcast"),null}SubgroupBroadcastFirst(e,r){return console.error("TODO: subgroupBroadcastFirst"),null}SubgroupElect(e,r){return console.error("TODO: subgroupElect"),null}SubgroupMax(e,r){return console.error("TODO: subgroupMax"),null}SubgroupMin(e,r){return console.error("TODO: subgroupMin"),null}SubgroupMul(e,r){return console.error("TODO: subgroupMul"),null}SubgroupExclusiveMul(e,r){return console.error("TODO: subgroupExclusiveMul"),null}SubgroupInclusiveMul(e,r){return console.error("TODO: subgroupInclusiveMul"),null}SubgroupOr(e,r){return console.error("TODO: subgroupOr"),null}SubgroupShuffle(e,r){return console.error("TODO: subgroupShuffle"),null}SubgroupShuffleDown(e,r){return console.error("TODO: subgroupShuffleDown"),null}SubgroupShuffleUp(e,r){return console.error("TODO: subgroupShuffleUp"),null}SubgroupShuffleXor(e,r){return console.error("TODO: subgroupShuffleXor"),null}SubgroupXor(e,r){return console.error("TODO: subgroupXor"),null}QuadBroadcast(e,r){return console.error("TODO: quadBroadcast"),null}QuadSwapDiagonal(e,r){return console.error("TODO: quadSwapDiagonal"),null}QuadSwapX(e,r){return console.error("TODO: quadSwapX"),null}QuadSwapY(e,r){return console.error("TODO: quadSwapY"),null}}const WP={vec2:2,vec2f:2,vec2i:2,vec2u:2,vec2b:2,vec2h:2,vec3:3,vec3f:3,vec3i:3,vec3u:3,vec3b:3,vec3h:3,vec4:4,vec4f:4,vec4i:4,vec4u:4,vec4b:4,vec4h:4},dc={mat2x2:[2,2,4],mat2x2f:[2,2,4],mat2x2h:[2,2,4],mat2x3:[2,3,6],mat2x3f:[2,3,6],mat2x3h:[2,3,6],mat2x4:[2,4,8],mat2x4f:[2,4,8],mat2x4h:[2,4,8],mat3x2:[3,2,6],mat3x2f:[3,2,6],mat3x2h:[3,2,6],mat3x3:[3,3,9],mat3x3f:[3,3,9],mat3x3h:[3,3,9],mat3x4:[3,4,12],mat3x4f:[3,4,12],mat3x4h:[3,4,12],mat4x2:[4,2,8],mat4x2f:[4,2,8],mat4x2h:[4,2,8],mat4x3:[4,3,12],mat4x3f:[4,3,12],mat4x3h:[4,3,12],mat4x4:[4,4,16],mat4x4f:[4,4,16],mat4x4h:[4,4,16]};class Ju extends _7e{constructor(e,r){var n;super(),this.ast=e??[],this.reflection=new pd,this.reflection.updateAST(this.ast),this.context=(n=r?.clone())!==null&&n!==void 0?n:new a6,this.builtins=new b7e(this),this.typeInfo={bool:this.getTypeInfo(Kr.bool),i32:this.getTypeInfo(Kr.i32),u32:this.getTypeInfo(Kr.u32),f32:this.getTypeInfo(Kr.f32),f16:this.getTypeInfo(Kr.f16),vec2f:this.getTypeInfo(fr.vec2f),vec2u:this.getTypeInfo(fr.vec2u),vec2i:this.getTypeInfo(fr.vec2i),vec2h:this.getTypeInfo(fr.vec2h),vec3f:this.getTypeInfo(fr.vec3f),vec3u:this.getTypeInfo(fr.vec3u),vec3i:this.getTypeInfo(fr.vec3i),vec3h:this.getTypeInfo(fr.vec3h),vec4f:this.getTypeInfo(fr.vec4f),vec4u:this.getTypeInfo(fr.vec4u),vec4i:this.getTypeInfo(fr.vec4i),vec4h:this.getTypeInfo(fr.vec4h),mat2x2f:this.getTypeInfo(fr.mat2x2f),mat2x3f:this.getTypeInfo(fr.mat2x3f),mat2x4f:this.getTypeInfo(fr.mat2x4f),mat3x2f:this.getTypeInfo(fr.mat3x2f),mat3x3f:this.getTypeInfo(fr.mat3x3f),mat3x4f:this.getTypeInfo(fr.mat3x4f),mat4x2f:this.getTypeInfo(fr.mat4x2f),mat4x3f:this.getTypeInfo(fr.mat4x3f),mat4x4f:this.getTypeInfo(fr.mat4x4f)}}getVariableValue(e){var r,n;const i=(n=(r=this.context.getVariable(e))===null||r===void 0?void 0:r.value)!==null&&n!==void 0?n:null;if(i===null)return null;if(i instanceof ir)return i.value;if(i instanceof kt||i instanceof Ii)return Array.from(i.data);if(i instanceof js&&i.typeInfo instanceof wg){if(i.typeInfo.format.name==="u32")return Array.from(new Uint32Array(i.buffer,i.offset,i.typeInfo.count));if(i.typeInfo.format.name==="i32")return Array.from(new Int32Array(i.buffer,i.offset,i.typeInfo.count));if(i.typeInfo.format.name==="f32")return Array.from(new Float32Array(i.buffer,i.offset,i.typeInfo.count))}return console.error(`Unsupported return variable type ${i.typeInfo.name}`),null}execute(e){(e=e??{}).constants&&this._setOverrides(e.constants,this.context),this._execStatements(this.ast,this.context)}dispatchWorkgroups(e,r,n,i){const a=this.context.clone();(i=i??{}).constants&&this._setOverrides(i.constants,a),this._execStatements(this.ast,a);const s=a.getFunction(e);if(!s)return void console.error(`Function ${e} not found`);if(typeof r=="number")r=[r,1,1];else{if(r.length===0)return void console.error("Invalid dispatch count");r.length===1?r=[r[0],1,1]:r.length===2?r=[r[0],r[1],1]:r.length>3&&(r=[r[0],r[1],r[2]])}const o=r[0],c=r[1],f=r[2],d=this.getTypeInfo("vec3u");a.setVariable("@num_workgroups",new kt(r,d));const m=this.reflection.getFunctionInfo(e);m===null&&console.error(`Function ${e} not found in reflection data`);for(const b in n)for(const x in n[b]){const E=n[b][x];a.variables.forEach(T=>{var A;const M=T.node;if(M?.attributes){let F=null,N=null;for(const O of M.attributes)O.name==="binding"?F=O.value:O.name==="group"&&(N=O.value);if(x==F&&b==N){let O=!1;for(const U of m.resources)if(U.name===T.name&&U.group===parseInt(b)&&U.binding===parseInt(x)){O=!0;break}if(O)if(E.texture!==void 0&&E.descriptor!==void 0){const U=new sp(E.texture,this.getTypeInfo(M.type),E.descriptor,(A=E.texture.view)!==null&&A!==void 0?A:null);T.value=U}else E.uniform!==void 0?T.value=new js(E.uniform,this.getTypeInfo(M.type)):T.value=new js(E,this.getTypeInfo(M.type))}}})}for(let b=0;b<f;++b)for(let x=0;x<c;++x)for(let E=0;E<o;++E)a.setVariable("@workgroup_id",new kt([E,x,b],this.getTypeInfo("vec3u"))),this._dispatchWorkgroup(s,[E,x,b],a)}execStatement(e,r){if(e instanceof Are)return this.evalExpression(e.value,r);if(e instanceof Pre){if(e.condition){const n=this.evalExpression(e.condition,r);if(!(n instanceof ir))throw new Error("Invalid break-if condition");if(!n.value)return null}return Ju._breakObj}if(e instanceof kre)return Ju._continueObj;if(e instanceof Tb)this._let(e,r);else if(e instanceof cp)this._var(e,r);else if(e instanceof RS)this._const(e,r);else if(e instanceof dx)this._function(e,r);else{if(e instanceof Cre)return this._if(e,r);if(e instanceof Tre)return this._switch(e,r);if(e instanceof xre)return this._for(e,r);if(e instanceof bre)return this._while(e,r);if(e instanceof Ere)return this._loop(e,r);if(e instanceof nD){const n=r.clone();return n.currentFunctionName=r.currentFunctionName,this._execStatements(e.body,n)}if(e instanceof Sre)this._assign(e,r);else if(e instanceof wre)this._increment(e,r);else{if(e instanceof op)return null;if(e instanceof JL){const n=e.name;r.getVariable(n)===null&&r.setVariable(n,new ir(0,this.getTypeInfo("u32")))}else if(e instanceof QL)this._call(e,r);else{if(e instanceof Ire||e instanceof e6)return null;console.error("Invalid statement type.",e,`Line ${e.line}`)}}}return null}evalExpression(e,r){return e instanceof yh?this._evalBinaryOp(e,r):e instanceof Ol?this._evalLiteral(e,r):e instanceof af?this._evalVariable(e,r):e instanceof t6?this._evalCall(e,r):e instanceof sd?this._evalCreate(e,r):e instanceof Rre?this._evalConst(e,r):e instanceof Mre?this._evalBitcast(e,r):e instanceof wl?this._evalUnaryOp(e,r):(console.error("Invalid expression type",e,`Line ${e.line}`),null)}getTypeInfo(e){var r;if(e instanceof Kr){const i=this.reflection.getTypeInfo(e);if(i!==null)return i}let n=(r=this.typeInfo[e])!==null&&r!==void 0?r:null;return n!==null||(n=this.reflection.getTypeInfoByName(e)),n}_setOverrides(e,r){for(const n in e){const i=e[n],a=this.reflection.getOverrideInfo(n);a!==null?(a.type===null&&(a.type=this.getTypeInfo("u32")),a.type.name==="u32"||a.type.name==="i32"||a.type.name==="f32"||a.type.name==="f16"?r.setVariable(n,new ir(i,a.type)):a.type.name==="bool"?r.setVariable(n,new ir(i?1:0,a.type)):a.type.name==="vec2"||a.type.name==="vec3"||a.type.name==="vec4"||a.type.name==="vec2f"||a.type.name==="vec3f"||a.type.name==="vec4f"||a.type.name==="vec2i"||a.type.name==="vec3i"||a.type.name==="vec4i"||a.type.name==="vec2u"||a.type.name==="vec3u"||a.type.name==="vec4u"||a.type.name==="vec2h"||a.type.name==="vec3h"||a.type.name==="vec4h"?r.setVariable(n,new kt(i,a.type)):console.error(`Invalid constant type for ${n}`)):console.error(`Override ${n} does not exist in the shader.`)}}_dispatchWorkgroup(e,r,n){const i=[1,1,1];for(const d of e.node.attributes)if(d.name==="workgroup_size"){if(d.value.length>0){const m=n.getVariableValue(d.value[0]);i[0]=m instanceof ir?m.value:parseInt(d.value[0])}if(d.value.length>1){const m=n.getVariableValue(d.value[1]);i[1]=m instanceof ir?m.value:parseInt(d.value[1])}if(d.value.length>2){const m=n.getVariableValue(d.value[2]);i[2]=m instanceof ir?m.value:parseInt(d.value[2])}}const a=this.getTypeInfo("vec3u"),s=this.getTypeInfo("u32");n.setVariable("@workgroup_size",new kt(i,a));const o=i[0],c=i[1],f=i[2];for(let d=0,m=0;d<f;++d)for(let b=0;b<c;++b)for(let x=0;x<o;++x,++m){const E=[x,b,d],T=[x+r[0]*i[0],b+r[1]*i[1],d+r[2]*i[2]];n.setVariable("@local_invocation_id",new kt(E,a)),n.setVariable("@global_invocation_id",new kt(T,a)),n.setVariable("@local_invocation_index",new ir(m,s)),this._dispatchExec(e,n)}}_dispatchExec(e,r){for(const n of e.node.args)for(const i of n.attributes)if(i.name==="builtin"){const a=`@${i.value}`,s=r.getVariable(a);s!==void 0&&r.variables.set(n.name,s)}this._execStatements(e.node.body,r)}getVariableName(e,r){for(;e instanceof wl;)e=e.right;return e instanceof af?e.name:(console.error("Unknown variable type",e,"Line",e.line),null)}_execStatements(e,r){for(const n of e){if(n instanceof Array){const a=r.clone(),s=this._execStatements(n,a);if(s)return s;continue}const i=this.execStatement(n,r);if(i)return i}return null}_call(e,r){const n=r.clone();n.currentFunctionName=e.name;const i=r.getFunction(e.name);if(i){for(let a=0;a<i.node.args.length;++a){const s=i.node.args[a],o=this.evalExpression(e.args[a],n);n.setVariable(s.name,o,s)}this._execStatements(i.node.body,n)}else e.isBuiltin?this._callBuiltinFunction(e,n):this.getTypeInfo(e.name)&&this._evalCreate(e,r)}_increment(e,r){const n=this.getVariableName(e.variable,r),i=r.getVariable(n);i?e.operator==="++"?i.value instanceof ir?i.value.value++:console.error(`Variable ${n} is not a scalar. Line ${e.line}`):e.operator==="--"?i.value instanceof ir?i.value.value--:console.error(`Variable ${n} is not a scalar. Line ${e.line}`):console.error(`Unknown increment operator ${e.operator}. Line ${e.line}`):console.error(`Variable ${n} not found. Line ${e.line}`)}_getVariableData(e,r){if(e instanceof af){const n=this.getVariableName(e,r),i=r.getVariable(n);return i===null?(console.error(`Variable ${n} not found. Line ${e.line}`),null):i.value.getSubData(this,e.postfix,r)}if(e instanceof wl){if(e.operator==="*"){const n=this._getVariableData(e.right,r);return n instanceof Rv?n.reference.getSubData(this,e.postfix,r):(console.error(`Variable ${e.right} is not a pointer. Line ${e.line}`),null)}if(e.operator==="&"){const n=this._getVariableData(e.right,r);return new Rv(n)}}return null}_assign(e,r){let n=null,i="<var>",a=null;if(e.variable instanceof wl){const c=this._getVariableData(e.variable,r),f=this.evalExpression(e.value,r),d=e.operator;if(d==="="){if(c instanceof ir||c instanceof kt||c instanceof Ii){if(f instanceof ir||f instanceof kt||f instanceof Ii&&c.data.length===f.data.length)return void c.data.set(f.data);console.error(`Invalid assignment. Line ${e.line}`)}else if(c instanceof js&&f instanceof js&&c.buffer.byteLength-c.offset>=f.buffer.byteLength-f.offset)return void(c.buffer.byteLength%4==0?new Uint32Array(c.buffer,c.offset,c.typeInfo.size/4).set(new Uint32Array(f.buffer,f.offset,f.typeInfo.size/4)):new Uint8Array(c.buffer,c.offset,c.typeInfo.size).set(new Uint8Array(f.buffer,f.offset,f.typeInfo.size)));return console.error(`Invalid assignment. Line ${e.line}`),null}if(d==="+=")return c instanceof ir||c instanceof kt||c instanceof Ii?f instanceof ir||f instanceof kt||f instanceof Ii?void c.data.set(f.data.map((m,b)=>c.data[b]+m)):void console.error(`Invalid assignment . Line ${e.line}`):void console.error(`Invalid assignment. Line ${e.line}`);if(d==="-=")return(c instanceof ir||c instanceof kt||c instanceof Ii)&&(f instanceof ir||f instanceof kt||f instanceof Ii)?void c.data.set(f.data.map((m,b)=>c.data[b]-m)):void console.error(`Invalid assignment. Line ${e.line}`)}if(e.variable instanceof wl){if(e.variable.operator==="*"){i=this.getVariableName(e.variable.right,r);const c=r.getVariable(i);if(!(c&&c.value instanceof Rv))return void console.error(`Variable ${i} is not a pointer. Line ${e.line}`);n=c.value.reference;let f=e.variable.postfix;if(!f){let d=e.variable.right;for(;d instanceof wl;){if(d.postfix){f=d.postfix;break}d=d.right}}f&&(n=n.getSubData(this,f,r))}}else{a=e.variable.postfix,i=this.getVariableName(e.variable,r);const c=r.getVariable(i);if(c===null)return void console.error(`Variable ${i} not found. Line ${e.line}`);n=c.value}if(n instanceof Rv&&(n=n.reference),n===null)return void console.error(`Variable ${i} not found. Line ${e.line}`);const s=this.evalExpression(e.value,r),o=e.operator;if(o!=="="){const c=n.getSubData(this,a,r);if(c instanceof kt&&s instanceof ir){const f=c.data,d=s.value;if(o==="+=")for(let m=0;m<f.length;++m)f[m]+=d;else if(o==="-=")for(let m=0;m<f.length;++m)f[m]-=d;else if(o==="*=")for(let m=0;m<f.length;++m)f[m]*=d;else if(o==="/=")for(let m=0;m<f.length;++m)f[m]/=d;else if(o==="%=")for(let m=0;m<f.length;++m)f[m]%=d;else if(o==="&=")for(let m=0;m<f.length;++m)f[m]&=d;else if(o==="|=")for(let m=0;m<f.length;++m)f[m]|=d;else if(o==="^=")for(let m=0;m<f.length;++m)f[m]^=d;else if(o==="<<=")for(let m=0;m<f.length;++m)f[m]<<=d;else if(o===">>=")for(let m=0;m<f.length;++m)f[m]>>=d;else console.error(`Invalid operator ${o}. Line ${e.line}`)}else if(c instanceof kt&&s instanceof kt){const f=c.data,d=s.data;if(f.length!==d.length)return void console.error(`Vector length mismatch. Line ${e.line}`);if(o==="+=")for(let m=0;m<f.length;++m)f[m]+=d[m];else if(o==="-=")for(let m=0;m<f.length;++m)f[m]-=d[m];else if(o==="*=")for(let m=0;m<f.length;++m)f[m]*=d[m];else if(o==="/=")for(let m=0;m<f.length;++m)f[m]/=d[m];else if(o==="%=")for(let m=0;m<f.length;++m)f[m]%=d[m];else if(o==="&=")for(let m=0;m<f.length;++m)f[m]&=d[m];else if(o==="|=")for(let m=0;m<f.length;++m)f[m]|=d[m];else if(o==="^=")for(let m=0;m<f.length;++m)f[m]^=d[m];else if(o==="<<=")for(let m=0;m<f.length;++m)f[m]<<=d[m];else if(o===">>=")for(let m=0;m<f.length;++m)f[m]>>=d[m];else console.error(`Invalid operator ${o}. Line ${e.line}`)}else{if(!(c instanceof ir&&s instanceof ir))return void console.error(`Invalid type for ${e.operator} operator. Line ${e.line}`);o==="+="?c.value+=s.value:o==="-="?c.value-=s.value:o==="*="?c.value*=s.value:o==="/="?c.value/=s.value:o==="%="?c.value%=s.value:o==="&="?c.value&=s.value:o==="|="?c.value|=s.value:o==="^="?c.value^=s.value:o==="<<="?c.value<<=s.value:o===">>="?c.value>>=s.value:console.error(`Invalid operator ${o}. Line ${e.line}`)}return void(n instanceof js&&n.setDataValue(this,c,a,r))}if(n instanceof js)n.setDataValue(this,s,a,r);else if(a){if(!(n instanceof kt||n instanceof Ii))return void console.error(`Variable ${i} is not a vector or matrix. Line ${e.line}`);if(a instanceof i_){const c=this.evalExpression(a.index,r).value;if(n instanceof kt){if(!(s instanceof ir))return void console.error(`Invalid assignment to ${i}. Line ${e.line}`);n.data[c]=s.value}else{if(!(n instanceof Ii))return void console.error(`Invalid assignment to ${i}. Line ${e.line}`);{const f=this.evalExpression(a.index,r).value;if(f<0)return void console.error(`Invalid assignment to ${i}. Line ${e.line}`);if(!(s instanceof kt))return void console.error(`Invalid assignment to ${i}. Line ${e.line}`);{const d=n.typeInfo.getTypeName();if(d==="mat2x2"||d==="mat2x2f"||d==="mat2x2h"){if(!(f<2&&s.data.length===2))return void console.error(`Invalid assignment to ${i}. Line ${e.line}`);n.data[2*f]=s.data[0],n.data[2*f+1]=s.data[1]}else if(d==="mat2x3"||d==="mat2x3f"||d==="mat2x3h"){if(!(f<2&&s.data.length===3))return void console.error(`Invalid assignment to ${i}. Line ${e.line}`);n.data[3*f]=s.data[0],n.data[3*f+1]=s.data[1],n.data[3*f+2]=s.data[2]}else if(d==="mat2x4"||d==="mat2x4f"||d==="mat2x4h"){if(!(f<2&&s.data.length===4))return void console.error(`Invalid assignment to ${i}. Line ${e.line}`);n.data[4*f]=s.data[0],n.data[4*f+1]=s.data[1],n.data[4*f+2]=s.data[2],n.data[4*f+3]=s.data[3]}else if(d==="mat3x2"||d==="mat3x2f"||d==="mat3x2h"){if(!(f<3&&s.data.length===2))return void console.error(`Invalid assignment to ${i}. Line ${e.line}`);n.data[2*f]=s.data[0],n.data[2*f+1]=s.data[1]}else if(d==="mat3x3"||d==="mat3x3f"||d==="mat3x3h"){if(!(f<3&&s.data.length===3))return void console.error(`Invalid assignment to ${i}. Line ${e.line}`);n.data[3*f]=s.data[0],n.data[3*f+1]=s.data[1],n.data[3*f+2]=s.data[2]}else if(d==="mat3x4"||d==="mat3x4f"||d==="mat3x4h"){if(!(f<3&&s.data.length===4))return void console.error(`Invalid assignment to ${i}. Line ${e.line}`);n.data[4*f]=s.data[0],n.data[4*f+1]=s.data[1],n.data[4*f+2]=s.data[2],n.data[4*f+3]=s.data[3]}else if(d==="mat4x2"||d==="mat4x2f"||d==="mat4x2h"){if(!(f<4&&s.data.length===2))return void console.error(`Invalid assignment to ${i}. Line ${e.line}`);n.data[2*f]=s.data[0],n.data[2*f+1]=s.data[1]}else if(d==="mat4x3"||d==="mat4x3f"||d==="mat4x3h"){if(!(f<4&&s.data.length===3))return void console.error(`Invalid assignment to ${i}. Line ${e.line}`);n.data[3*f]=s.data[0],n.data[3*f+1]=s.data[1],n.data[3*f+2]=s.data[2]}else{if(d!=="mat4x4"&&d!=="mat4x4f"&&d!=="mat4x4h")return void console.error(`Invalid assignment to ${i}. Line ${e.line}`);if(!(f<4&&s.data.length===4))return void console.error(`Invalid assignment to ${i}. Line ${e.line}`);n.data[4*f]=s.data[0],n.data[4*f+1]=s.data[1],n.data[4*f+2]=s.data[2],n.data[4*f+3]=s.data[3]}}}}}else if(a instanceof gy){const c=a.value;if(!(n instanceof kt))return void console.error(`Invalid assignment to ${c}. Variable ${i} is not a vector. Line ${e.line}`);if(s instanceof ir){if(c.length>1)return void console.error(`Invalid assignment to ${c} for variable ${i}. Line ${e.line}`);if(c==="x")n.data[0]=s.value;else if(c==="y"){if(n.data.length<2)return void console.error(`Invalid assignment to ${c} for variable ${i}. Line ${e.line}`);n.data[1]=s.value}else if(c==="z"){if(n.data.length<3)return void console.error(`Invalid assignment to ${c} for variable ${i}. Line ${e.line}`);n.data[2]=s.value}else if(c==="w"){if(n.data.length<4)return void console.error(`Invalid assignment to ${c} for variable ${i}. Line ${e.line}`);n.data[3]=s.value}}else{if(!(s instanceof kt))return void console.error(`Invalid assignment to ${i}. Line ${e.line}`);if(c.length!==s.data.length)return void console.error(`Invalid assignment to ${c} for variable ${i}. Line ${e.line}`);for(let f=0;f<c.length;++f){const d=c[f];if(d==="x"||d==="r")n.data[0]=s.data[f];else if(d==="y"||d==="g"){if(s.data.length<2)return void console.error(`Invalid assignment to ${d} for variable ${i}. Line ${e.line}`);n.data[1]=s.data[f]}else if(d==="z"||d==="b"){if(s.data.length<3)return void console.error(`Invalid assignment to ${d} for variable ${i}. Line ${e.line}`);n.data[2]=s.data[f]}else{if(d!=="w"&&d!=="a")return void console.error(`Invalid assignment to ${d} for variable ${i}. Line ${e.line}`);if(s.data.length<4)return void console.error(`Invalid assignment to ${d} for variable ${i}. Line ${e.line}`);n.data[3]=s.data[f]}}}}}else n instanceof ir&&s instanceof ir?n.value=s.value:n instanceof kt&&s instanceof kt||n instanceof Ii&&s instanceof Ii?n.data.set(s.data):console.error(`Invalid assignment to ${i}. Line ${e.line}`)}_function(e,r){const n=new i6(e);r.functions.set(e.name,n)}_const(e,r){let n=null;e.value!==null&&(n=this.evalExpression(e.value,r)),r.createVariable(e.name,n,e)}_let(e,r){let n=null;if(e.value!==null){if(n=this.evalExpression(e.value,r),n===null)return void console.error(`Invalid value for variable ${e.name}. Line ${e.line}`);e.value instanceof wl||(n=n.clone())}else{const i=e.type.name;if(i==="f32"||i==="i32"||i==="u32"||i==="bool"||i==="f16"||i==="vec2"||i==="vec3"||i==="vec4"||i==="vec2f"||i==="vec3f"||i==="vec4f"||i==="vec2i"||i==="vec3i"||i==="vec4i"||i==="vec2u"||i==="vec3u"||i==="vec4u"||i==="vec2h"||i==="vec3h"||i==="vec4h"||i==="vec2b"||i==="vec3b"||i==="vec4b"||i==="mat2x2"||i==="mat2x3"||i==="mat2x4"||i==="mat3x2"||i==="mat3x3"||i==="mat3x4"||i==="mat4x2"||i==="mat4x3"||i==="mat4x4"||i==="mat2x2f"||i==="mat2x3f"||i==="mat2x4f"||i==="mat3x2f"||i==="mat3x3f"||i==="mat3x4f"||i==="mat4x2f"||i==="mat4x3f"||i==="mat4x4f"||i==="mat2x2h"||i==="mat2x3h"||i==="mat2x4h"||i==="mat3x2h"||i==="mat3x3h"||i==="mat3x4h"||i==="mat4x2h"||i==="mat4x3h"||i==="mat4x4h"||i==="array"){const a=new sd(e.type,[]);n=this._evalCreate(a,r)}}r.createVariable(e.name,n,e)}_var(e,r){let n=null;if(e.value!==null){if(n=this.evalExpression(e.value,r),n===null)return void console.error(`Invalid value for variable ${e.name}. Line ${e.line}`);e.value instanceof wl||(n=n.clone())}else{if(e.type===null)return void console.error(`Variable ${e.name} has no type. Line ${e.line}`);const i=e.type.name;if(i==="f32"||i==="i32"||i==="u32"||i==="bool"||i==="f16"||i==="vec2"||i==="vec3"||i==="vec4"||i==="vec2f"||i==="vec3f"||i==="vec4f"||i==="vec2i"||i==="vec3i"||i==="vec4i"||i==="vec2u"||i==="vec3u"||i==="vec4u"||i==="vec2h"||i==="vec3h"||i==="vec4h"||i==="vec2b"||i==="vec3b"||i==="vec4b"||i==="mat2x2"||i==="mat2x3"||i==="mat2x4"||i==="mat3x2"||i==="mat3x3"||i==="mat3x4"||i==="mat4x2"||i==="mat4x3"||i==="mat4x4"||i==="mat2x2f"||i==="mat2x3f"||i==="mat2x4f"||i==="mat3x2f"||i==="mat3x3f"||i==="mat3x4f"||i==="mat4x2f"||i==="mat4x3f"||i==="mat4x4f"||i==="mat2x2h"||i==="mat2x3h"||i==="mat2x4h"||i==="mat3x2h"||i==="mat3x3h"||i==="mat3x4h"||i==="mat4x2h"||i==="mat4x3h"||i==="mat4x4h"||e.type instanceof Cb||e.type instanceof op||e.type instanceof fr){const a=new sd(e.type,[]);n=this._evalCreate(a,r)}}r.createVariable(e.name,n,e)}_switch(e,r){r=r.clone();const n=this.evalExpression(e.condition,r);if(!(n instanceof ir))return console.error(`Invalid if condition. Line ${e.line}`),null;let i=null;for(const a of e.cases)if(a instanceof Nre)for(const s of a.selectors){if(s instanceof DS){i=a;continue}const o=this.evalExpression(s,r);if(!(o instanceof ir))return console.error(`Invalid case selector. Line ${e.line}`),null;if(o.value===n.value)return this._execStatements(a.body,r)}else a instanceof Lre&&(i=a);return i?this._execStatements(i.body,r):null}_if(e,r){r=r.clone();const n=this.evalExpression(e.condition,r);if(!(n instanceof ir))return console.error(`Invalid if condition. Line ${e.line}`),null;if(n.value)return this._execStatements(e.body,r);for(const i of e.elseif){const a=this.evalExpression(i.condition,r);if(!(a instanceof ir))return console.error(`Invalid if condition. Line ${e.line}`),null;if(a.value)return this._execStatements(i.body,r)}return e.else?this._execStatements(e.else,r):null}_getScalarValue(e){return e instanceof ir?e.value:(console.error("Expected scalar value.",e),0)}_for(e,r){for(r=r.clone(),this.execStatement(e.init,r);this._getScalarValue(this.evalExpression(e.condition,r));){const n=this._execStatements(e.body,r);if(n===Ju._breakObj)break;if(n!==null&&n!==Ju._continueObj)return n;this.execStatement(e.increment,r)}return null}_loop(e,r){for(r=r.clone();;){const n=this._execStatements(e.body,r);if(n===Ju._breakObj)break;if(n===Ju._continueObj){if(e.continuing&&this._execStatements(e.continuing.body,r)===Ju._breakObj)break}else if(n!==null)return n}return null}_while(e,r){for(r=r.clone();this._getScalarValue(this.evalExpression(e.condition,r));){const n=this._execStatements(e.body,r);if(n===Ju._breakObj)break;if(n!==Ju._continueObj&&n!==null)return n}return null}_evalBitcast(e,r){const n=this.evalExpression(e.value,r),i=e.type;if(n instanceof ir){const a=AG(n.value,n.typeInfo.name,i.name);return new ir(a,this.getTypeInfo(i))}if(n instanceof kt){const a=n.typeInfo.getTypeName();let s="";if(a.endsWith("f"))s="f32";else if(a.endsWith("i"))s="i32";else if(a.endsWith("u"))s="u32";else if(a.endsWith("b"))s="bool";else{if(!a.endsWith("h"))return console.error(`Unknown vector type ${a}. Line ${e.line}`),null;s="f16"}const o=i.getTypeName();let c="";if(o.endsWith("f"))c="f32";else if(o.endsWith("i"))c="i32";else if(o.endsWith("u"))c="u32";else if(o.endsWith("b"))c="bool";else{if(!o.endsWith("h"))return console.error(`Unknown vector type ${c}. Line ${e.line}`),null;c="f16"}const f=(function(d,m,b){if(m===b)return d;const x=new Array(d.length);for(let E=0;E<d.length;E++)x[E]=AG(d[E],m,b);return x})(Array.from(n.data),s,c);return new kt(f,this.getTypeInfo(i))}return console.error(`TODO: bitcast for ${n.typeInfo.name}. Line ${e.line}`),null}_evalConst(e,r){return r.getVariableValue(e.name).clone().getSubData(this,e.postfix,r)}_evalCreate(e,r){var n;if(e instanceof sd){if(e.type===null)return iD.void;switch(e.type.getTypeName()){case"bool":case"i32":case"u32":case"f32":case"f16":return this._callConstructorValue(e,r);case"vec2":case"vec3":case"vec4":case"vec2f":case"vec3f":case"vec4f":case"vec2h":case"vec3h":case"vec4h":case"vec2i":case"vec3i":case"vec4i":case"vec2u":case"vec3u":case"vec4u":case"vec2b":case"vec3b":case"vec4b":return this._callConstructorVec(e,r);case"mat2x2":case"mat2x2f":case"mat2x2h":case"mat2x3":case"mat2x3f":case"mat2x3h":case"mat2x4":case"mat2x4f":case"mat2x4h":case"mat3x2":case"mat3x2f":case"mat3x2h":case"mat3x3":case"mat3x3f":case"mat3x3h":case"mat3x4":case"mat3x4f":case"mat3x4h":case"mat4x2":case"mat4x2f":case"mat4x2h":case"mat4x3":case"mat4x3f":case"mat4x3h":case"mat4x4":case"mat4x4f":case"mat4x4h":return this._callConstructorMatrix(e,r)}}const i=e instanceof sd?e.type.name:e.name,a=e instanceof sd?this.getTypeInfo(e.type):this.getTypeInfo(e.name);if(a===null)return console.error(`Unknown type ${i}. Line ${e.line}`),null;if(a.size===0)return null;const s=new js(new ArrayBuffer(a.size),a,0);if(a instanceof mg){if(e.args)for(let o=0;o<e.args.length;++o){const c=a.members[o],f=e.args[o],d=this.evalExpression(f,r);s.setData(this,d,c.type,c.offset,r)}}else if(a instanceof wg){let o=0;if(e.args)for(let c=0;c<e.args.length;++c){const f=e.args[c],d=this.evalExpression(f,r);a.format===null&&(((n=d.typeInfo)===null||n===void 0?void 0:n.name)==="x32"?a.format=this.getTypeInfo("i32"):a.format=d.typeInfo),s.setData(this,d,a.format,o,r),o+=a.stride}}else console.error(`Unknown type "${i}". Line ${e.line}`);return e instanceof sd?s.getSubData(this,e.postfix,r):s}_evalLiteral(e,r){const n=this.getTypeInfo(e.type),i=n.name;return i==="x32"||i==="u32"||i==="f32"||i==="f16"||i==="i32"||i==="bool"?new ir(e.scalarValue,n):i==="vec2"||i==="vec3"||i==="vec4"||i==="vec2f"||i==="vec3f"||i==="vec4f"||i==="vec2h"||i==="vec3h"||i==="vec4h"||i==="vec2i"||i==="vec3i"||i==="vec4i"||i==="vec2u"||i==="vec3u"||i==="vec4u"?this._callConstructorVec(e,r):i==="mat2x2"||i==="mat2x3"||i==="mat2x4"||i==="mat3x2"||i==="mat3x3"||i==="mat3x4"||i==="mat4x2"||i==="mat4x3"||i==="mat4x4"||i==="mat2x2f"||i==="mat2x3f"||i==="mat2x4f"||i==="mat3x2f"||i==="mat3x3f"||i==="mat3x4f"||i==="mat4x2f"||i==="mat4x3f"||i==="mat4x4f"||i==="mat2x2h"||i==="mat2x3h"||i==="mat2x4h"||i==="mat3x2h"||i==="mat3x3h"||i==="mat3x4h"||i==="mat4x2h"||i==="mat4x3h"||i==="mat4x4h"?this._callConstructorMatrix(e,r):e.value}_evalVariable(e,r){const n=r.getVariableValue(e.name);return n===null?n:n.getSubData(this,e.postfix,r)}_maxFormatTypeInfo(e){let r=e[0];if(r.name==="f32")return r;for(let n=1;n<e.length;++n){const i=Ju._priority.get(r.name);Ju._priority.get(e[n].name)<i&&(r=e[n])}return r.name==="x32"?this.getTypeInfo("i32"):r}_evalUnaryOp(e,r){const n=this.evalExpression(e.right,r);if(e.operator==="&")return new Rv(n);if(e.operator==="*")return n instanceof Rv?n.reference.getSubData(this,e.postfix,r):(console.error(`Invalid dereference. Line ${e.line}`),null);const i=n instanceof ir?n.value:n instanceof kt?Array.from(n.data):null;switch(e.operator){case"+":{if(On(i)){const o=i.map((c,f)=>+c);return new kt(o,n.typeInfo)}const a=i,s=this._maxFormatTypeInfo([n.typeInfo,n.typeInfo]);return new ir(+a,s)}case"-":{if(On(i)){const o=i.map((c,f)=>-c);return new kt(o,n.typeInfo)}const a=i,s=this._maxFormatTypeInfo([n.typeInfo,n.typeInfo]);return new ir(-a,s)}case"!":{if(On(i)){const o=i.map((c,f)=>c?0:1);return new kt(o,n.typeInfo)}const a=i,s=this._maxFormatTypeInfo([n.typeInfo,n.typeInfo]);return new ir(a?0:1,s)}case"~":{if(On(i)){const o=i.map((c,f)=>~c);return new kt(o,n.typeInfo)}const a=i,s=this._maxFormatTypeInfo([n.typeInfo,n.typeInfo]);return new ir(~a,s)}}return console.error(`Invalid unary operator ${e.operator}. Line ${e.line}`),null}_evalBinaryOp(e,r){const n=this.evalExpression(e.left,r),i=this.evalExpression(e.right,r),a=n instanceof ir?n.value:n instanceof kt||n instanceof Ii?Array.from(n.data):null,s=i instanceof ir?i.value:i instanceof kt||i instanceof Ii?Array.from(i.data):null;switch(e.operator){case"+":{if(On(a)&&On(s)){const d=a,m=s;if(d.length!==m.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;const b=d.map((x,E)=>x+m[E]);return new kt(b,n.typeInfo)}if(On(a)){const d=s,m=a.map((b,x)=>b+d);return new kt(m,n.typeInfo)}if(On(s)){const d=a,m=s.map((b,x)=>d+b);return new kt(m,i.typeInfo)}const o=a,c=s,f=this._maxFormatTypeInfo([n.typeInfo,i.typeInfo]);return new ir(o+c,f)}case"-":{if(On(a)&&On(s)){const d=a,m=s;if(d.length!==m.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;const b=d.map((x,E)=>x-m[E]);return new kt(b,n.typeInfo)}if(On(a)){const d=s,m=a.map((b,x)=>b-d);return new kt(m,n.typeInfo)}if(On(s)){const d=a,m=s.map((b,x)=>d-b);return new kt(m,i.typeInfo)}const o=a,c=s,f=this._maxFormatTypeInfo([n.typeInfo,i.typeInfo]);return new ir(o-c,f)}case"*":{if(On(a)&&On(s)){const d=a,m=s;if(n instanceof Ii&&i instanceof Ii){const b=(function(A,M,F,N){if(dc[M.name]===void 0||dc[N.name]===void 0)return null;const O=dc[M.name][0],U=dc[M.name][1],j=dc[N.name][0];if(O!==dc[N.name][1])return null;const H=new Array(j*U);for(let W=0;W<U;W++)for(let X=0;X<j;X++){let oe=0;for(let Q=0;Q<O;Q++)oe+=A[Q*U+W]*F[X*O+Q];H[W*j+X]=oe}return H})(d,n.typeInfo,m,i.typeInfo);if(b===null)return console.error(`Matrix multiplication failed. Line ${e.line}.`),null;const x=dc[i.typeInfo.name][0],E=dc[n.typeInfo.name][1],T=this.getTypeInfo(`mat${x}x${E}f`);return new Ii(b,T)}if(n instanceof Ii&&i instanceof kt){const b=(function(x,E,T,A){if(dc[E.name]===void 0||WP[A.name]===void 0)return null;const M=dc[E.name][0],F=dc[E.name][1];if(M!==T.length)return null;const N=new Array(F);for(let O=0;O<F;O++){let U=0;for(let j=0;j<M;j++)U+=x[j*F+O]*T[j];N[O]=U}return N})(d,n.typeInfo,m,i.typeInfo);return b===null?(console.error(`Matrix vector multiplication failed. Line ${e.line}.`),null):new kt(b,i.typeInfo)}if(n instanceof kt&&i instanceof Ii){const b=(function(x,E,T,A){if(WP[E.name]===void 0||dc[A.name]===void 0)return null;const M=dc[A.name][0],F=dc[A.name][1];if(F!==x.length)return null;const N=[];for(let O=0;O<M;O++){let U=0;for(let j=0;j<F;j++)U+=x[j]*T[j*M+O];N[O]=U}return N})(d,n.typeInfo,m,i.typeInfo);return b===null?(console.error(`Matrix vector multiplication failed. Line ${e.line}.`),null):new kt(b,n.typeInfo)}{if(d.length!==m.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;const b=d.map((x,E)=>x*m[E]);return new kt(b,n.typeInfo)}}if(On(a)){const d=s,m=a.map((b,x)=>b*d);return n instanceof Ii?new Ii(m,n.typeInfo):new kt(m,n.typeInfo)}if(On(s)){const d=a,m=s.map((b,x)=>d*b);return i instanceof Ii?new Ii(m,i.typeInfo):new kt(m,i.typeInfo)}const o=a,c=s,f=this._maxFormatTypeInfo([n.typeInfo,i.typeInfo]);return new ir(o*c,f)}case"%":{if(On(a)&&On(s)){const d=a,m=s;if(d.length!==m.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;const b=d.map((x,E)=>x%m[E]);return new kt(b,n.typeInfo)}if(On(a)){const d=s,m=a.map((b,x)=>b%d);return new kt(m,n.typeInfo)}if(On(s)){const d=a,m=s.map((b,x)=>d%b);return new kt(m,i.typeInfo)}const o=a,c=s,f=this._maxFormatTypeInfo([n.typeInfo,i.typeInfo]);return new ir(o%c,f)}case"/":{if(On(a)&&On(s)){const d=a,m=s;if(d.length!==m.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;const b=d.map((x,E)=>x/m[E]);return new kt(b,n.typeInfo)}if(On(a)){const d=s,m=a.map((b,x)=>b/d);return new kt(m,n.typeInfo)}if(On(s)){const d=a,m=s.map((b,x)=>d/b);return new kt(m,i.typeInfo)}const o=a,c=s,f=this._maxFormatTypeInfo([n.typeInfo,i.typeInfo]);return new ir(o/c,f)}case"&":{if(On(a)&&On(s)){const d=a,m=s;if(d.length!==m.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;const b=d.map((x,E)=>x&m[E]);return new kt(b,n.typeInfo)}if(On(a)){const d=s,m=a.map((b,x)=>b&d);return new kt(m,n.typeInfo)}if(On(s)){const d=a,m=s.map((b,x)=>d&b);return new kt(m,i.typeInfo)}const o=a,c=s,f=this._maxFormatTypeInfo([n.typeInfo,i.typeInfo]);return new ir(o&c,f)}case"|":{if(On(a)&&On(s)){const d=a,m=s;if(d.length!==m.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;const b=d.map((x,E)=>x|m[E]);return new kt(b,n.typeInfo)}if(On(a)){const d=s,m=a.map((b,x)=>b|d);return new kt(m,n.typeInfo)}if(On(s)){const d=a,m=s.map((b,x)=>d|b);return new kt(m,i.typeInfo)}const o=a,c=s,f=this._maxFormatTypeInfo([n.typeInfo,i.typeInfo]);return new ir(o|c,f)}case"^":{if(On(a)&&On(s)){const d=a,m=s;if(d.length!==m.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;const b=d.map((x,E)=>x^m[E]);return new kt(b,n.typeInfo)}if(On(a)){const d=s,m=a.map((b,x)=>b^d);return new kt(m,n.typeInfo)}if(On(s)){const d=a,m=s.map((b,x)=>d^b);return new kt(m,i.typeInfo)}const o=a,c=s,f=this._maxFormatTypeInfo([n.typeInfo,i.typeInfo]);return new ir(o^c,f)}case"<<":{if(On(a)&&On(s)){const d=a,m=s;if(d.length!==m.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;const b=d.map((x,E)=>x<<m[E]);return new kt(b,n.typeInfo)}if(On(a)){const d=s,m=a.map((b,x)=>b<<d);return new kt(m,n.typeInfo)}if(On(s)){const d=a,m=s.map((b,x)=>d<<b);return new kt(m,i.typeInfo)}const o=a,c=s,f=this._maxFormatTypeInfo([n.typeInfo,i.typeInfo]);return new ir(o<<c,f)}case">>":{if(On(a)&&On(s)){const d=a,m=s;if(d.length!==m.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;const b=d.map((x,E)=>x>>m[E]);return new kt(b,n.typeInfo)}if(On(a)){const d=s,m=a.map((b,x)=>b>>d);return new kt(m,n.typeInfo)}if(On(s)){const d=a,m=s.map((b,x)=>d>>b);return new kt(m,i.typeInfo)}const o=a,c=s,f=this._maxFormatTypeInfo([n.typeInfo,i.typeInfo]);return new ir(o>>c,f)}case">":if(On(a)&&On(s)){const o=a,c=s;if(o.length!==c.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;const f=o.map((d,m)=>d>c[m]?1:0);return new kt(f,n.typeInfo)}if(On(a)){const o=s,c=a.map((f,d)=>f>o?1:0);return new kt(c,n.typeInfo)}if(On(s)){const o=a,c=s.map((f,d)=>o>f?1:0);return new kt(c,i.typeInfo)}return new ir(a>s?1:0,this.getTypeInfo("bool"));case"<":if(On(a)&&On(s)){const o=a,c=s;if(o.length!==c.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;const f=o.map((d,m)=>d<c[m]?1:0);return new kt(f,n.typeInfo)}if(On(a)){const o=s,c=a.map((f,d)=>f<o?1:0);return new kt(c,n.typeInfo)}if(On(s)){const o=a,c=s.map((f,d)=>o<f?1:0);return new kt(c,i.typeInfo)}return new ir(a<s?1:0,this.getTypeInfo("bool"));case"==":if(On(a)&&On(s)){const o=a,c=s;if(o.length!==c.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;const f=o.map((d,m)=>d===c[m]?1:0);return new kt(f,n.typeInfo)}if(On(a)){const o=s,c=a.map((f,d)=>f==o?1:0);return new kt(c,n.typeInfo)}if(On(s)){const o=a,c=s.map((f,d)=>o==f?1:0);return new kt(c,i.typeInfo)}return new ir(a===s?1:0,this.getTypeInfo("bool"));case"!=":if(On(a)&&On(s)){const o=a,c=s;if(o.length!==c.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;const f=o.map((d,m)=>d!==c[m]?1:0);return new kt(f,n.typeInfo)}if(On(a)){const o=s,c=a.map((f,d)=>f!==o?1:0);return new kt(c,n.typeInfo)}if(On(s)){const o=a,c=s.map((f,d)=>o!==f?1:0);return new kt(c,i.typeInfo)}return new ir(a!==s?1:0,this.getTypeInfo("bool"));case">=":if(On(a)&&On(s)){const o=a,c=s;if(o.length!==c.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;const f=o.map((d,m)=>d>=c[m]?1:0);return new kt(f,n.typeInfo)}if(On(a)){const o=s,c=a.map((f,d)=>f>=o?1:0);return new kt(c,n.typeInfo)}if(On(s)){const o=a,c=s.map((f,d)=>o>=f?1:0);return new kt(c,i.typeInfo)}return new ir(a>=s?1:0,this.getTypeInfo("bool"));case"<=":if(On(a)&&On(s)){const o=a,c=s;if(o.length!==c.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;const f=o.map((d,m)=>d<=c[m]?1:0);return new kt(f,n.typeInfo)}if(On(a)){const o=s,c=a.map((f,d)=>f<=o?1:0);return new kt(c,n.typeInfo)}if(On(s)){const o=a,c=s.map((f,d)=>o<=f?1:0);return new kt(c,i.typeInfo)}return new ir(a<=s?1:0,this.getTypeInfo("bool"));case"&&":if(On(a)&&On(s)){const o=a,c=s;if(o.length!==c.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;const f=o.map((d,m)=>d&&c[m]?1:0);return new kt(f,n.typeInfo)}if(On(a)){const o=s,c=a.map((f,d)=>f&&o?1:0);return new kt(c,n.typeInfo)}if(On(s)){const o=a,c=s.map((f,d)=>o&&f?1:0);return new kt(c,i.typeInfo)}return new ir(a&&s?1:0,this.getTypeInfo("bool"));case"||":if(On(a)&&On(s)){const o=a,c=s;if(o.length!==c.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;const f=o.map((d,m)=>d||c[m]?1:0);return new kt(f,n.typeInfo)}if(On(a)){const o=s,c=a.map((f,d)=>f||o?1:0);return new kt(c,n.typeInfo)}if(On(s)){const o=a,c=s.map((f,d)=>o||f?1:0);return new kt(c,i.typeInfo)}return new ir(a||s?1:0,this.getTypeInfo("bool"))}return console.error(`Unknown operator ${e.operator}. Line ${e.line}`),null}_evalCall(e,r){if(e.cachedReturnValue!==null)return e.cachedReturnValue;const n=r.clone();n.currentFunctionName=e.name;const i=r.getFunction(e.name);if(!i)return e.isBuiltin?this._callBuiltinFunction(e,n):this.getTypeInfo(e.name)?this._evalCreate(e,r):(console.error(`Unknown function "${e.name}". Line ${e.line}`),null);for(let a=0;a<i.node.args.length;++a){const s=i.node.args[a],o=this.evalExpression(e.args[a],n);n.createVariable(s.name,o,s)}return this._execStatements(i.node.body,n)}_callBuiltinFunction(e,r){switch(e.name){case"all":return this.builtins.All(e,r);case"any":return this.builtins.Any(e,r);case"select":return this.builtins.Select(e,r);case"arrayLength":return this.builtins.ArrayLength(e,r);case"abs":return this.builtins.Abs(e,r);case"acos":return this.builtins.Acos(e,r);case"acosh":return this.builtins.Acosh(e,r);case"asin":return this.builtins.Asin(e,r);case"asinh":return this.builtins.Asinh(e,r);case"atan":return this.builtins.Atan(e,r);case"atanh":return this.builtins.Atanh(e,r);case"atan2":return this.builtins.Atan2(e,r);case"ceil":return this.builtins.Ceil(e,r);case"clamp":return this.builtins.Clamp(e,r);case"cos":return this.builtins.Cos(e,r);case"cosh":return this.builtins.Cosh(e,r);case"countLeadingZeros":return this.builtins.CountLeadingZeros(e,r);case"countOneBits":return this.builtins.CountOneBits(e,r);case"countTrailingZeros":return this.builtins.CountTrailingZeros(e,r);case"cross":return this.builtins.Cross(e,r);case"degrees":return this.builtins.Degrees(e,r);case"determinant":return this.builtins.Determinant(e,r);case"distance":return this.builtins.Distance(e,r);case"dot":return this.builtins.Dot(e,r);case"dot4U8Packed":return this.builtins.Dot4U8Packed(e,r);case"dot4I8Packed":return this.builtins.Dot4I8Packed(e,r);case"exp":return this.builtins.Exp(e,r);case"exp2":return this.builtins.Exp2(e,r);case"extractBits":return this.builtins.ExtractBits(e,r);case"faceForward":return this.builtins.FaceForward(e,r);case"firstLeadingBit":return this.builtins.FirstLeadingBit(e,r);case"firstTrailingBit":return this.builtins.FirstTrailingBit(e,r);case"floor":return this.builtins.Floor(e,r);case"fma":return this.builtins.Fma(e,r);case"fract":return this.builtins.Fract(e,r);case"frexp":return this.builtins.Frexp(e,r);case"insertBits":return this.builtins.InsertBits(e,r);case"inverseSqrt":return this.builtins.InverseSqrt(e,r);case"ldexp":return this.builtins.Ldexp(e,r);case"length":return this.builtins.Length(e,r);case"log":return this.builtins.Log(e,r);case"log2":return this.builtins.Log2(e,r);case"max":return this.builtins.Max(e,r);case"min":return this.builtins.Min(e,r);case"mix":return this.builtins.Mix(e,r);case"modf":return this.builtins.Modf(e,r);case"normalize":return this.builtins.Normalize(e,r);case"pow":return this.builtins.Pow(e,r);case"quantizeToF16":return this.builtins.QuantizeToF16(e,r);case"radians":return this.builtins.Radians(e,r);case"reflect":return this.builtins.Reflect(e,r);case"refract":return this.builtins.Refract(e,r);case"reverseBits":return this.builtins.ReverseBits(e,r);case"round":return this.builtins.Round(e,r);case"saturate":return this.builtins.Saturate(e,r);case"sign":return this.builtins.Sign(e,r);case"sin":return this.builtins.Sin(e,r);case"sinh":return this.builtins.Sinh(e,r);case"smoothstep":return this.builtins.SmoothStep(e,r);case"sqrt":return this.builtins.Sqrt(e,r);case"step":return this.builtins.Step(e,r);case"tan":return this.builtins.Tan(e,r);case"tanh":return this.builtins.Tanh(e,r);case"transpose":return this.builtins.Transpose(e,r);case"trunc":return this.builtins.Trunc(e,r);case"dpdx":return this.builtins.Dpdx(e,r);case"dpdxCoarse":return this.builtins.DpdxCoarse(e,r);case"dpdxFine":return this.builtins.DpdxFine(e,r);case"dpdy":return this.builtins.Dpdy(e,r);case"dpdyCoarse":return this.builtins.DpdyCoarse(e,r);case"dpdyFine":return this.builtins.DpdyFine(e,r);case"fwidth":return this.builtins.Fwidth(e,r);case"fwidthCoarse":return this.builtins.FwidthCoarse(e,r);case"fwidthFine":return this.builtins.FwidthFine(e,r);case"textureDimensions":return this.builtins.TextureDimensions(e,r);case"textureGather":return this.builtins.TextureGather(e,r);case"textureGatherCompare":return this.builtins.TextureGatherCompare(e,r);case"textureLoad":return this.builtins.TextureLoad(e,r);case"textureNumLayers":return this.builtins.TextureNumLayers(e,r);case"textureNumLevels":return this.builtins.TextureNumLevels(e,r);case"textureNumSamples":return this.builtins.TextureNumSamples(e,r);case"textureSample":return this.builtins.TextureSample(e,r);case"textureSampleBias":return this.builtins.TextureSampleBias(e,r);case"textureSampleCompare":return this.builtins.TextureSampleCompare(e,r);case"textureSampleCompareLevel":return this.builtins.TextureSampleCompareLevel(e,r);case"textureSampleGrad":return this.builtins.TextureSampleGrad(e,r);case"textureSampleLevel":return this.builtins.TextureSampleLevel(e,r);case"textureSampleBaseClampToEdge":return this.builtins.TextureSampleBaseClampToEdge(e,r);case"textureStore":return this.builtins.TextureStore(e,r);case"atomicLoad":return this.builtins.AtomicLoad(e,r);case"atomicStore":return this.builtins.AtomicStore(e,r);case"atomicAdd":return this.builtins.AtomicAdd(e,r);case"atomicSub":return this.builtins.AtomicSub(e,r);case"atomicMax":return this.builtins.AtomicMax(e,r);case"atomicMin":return this.builtins.AtomicMin(e,r);case"atomicAnd":return this.builtins.AtomicAnd(e,r);case"atomicOr":return this.builtins.AtomicOr(e,r);case"atomicXor":return this.builtins.AtomicXor(e,r);case"atomicExchange":return this.builtins.AtomicExchange(e,r);case"atomicCompareExchangeWeak":return this.builtins.AtomicCompareExchangeWeak(e,r);case"pack4x8snorm":return this.builtins.Pack4x8snorm(e,r);case"pack4x8unorm":return this.builtins.Pack4x8unorm(e,r);case"pack4xI8":return this.builtins.Pack4xI8(e,r);case"pack4xU8":return this.builtins.Pack4xU8(e,r);case"pack4x8Clamp":return this.builtins.Pack4x8Clamp(e,r);case"pack4xU8Clamp":return this.builtins.Pack4xU8Clamp(e,r);case"pack2x16snorm":return this.builtins.Pack2x16snorm(e,r);case"pack2x16unorm":return this.builtins.Pack2x16unorm(e,r);case"pack2x16float":return this.builtins.Pack2x16float(e,r);case"unpack4x8snorm":return this.builtins.Unpack4x8snorm(e,r);case"unpack4x8unorm":return this.builtins.Unpack4x8unorm(e,r);case"unpack4xI8":return this.builtins.Unpack4xI8(e,r);case"unpack4xU8":return this.builtins.Unpack4xU8(e,r);case"unpack2x16snorm":return this.builtins.Unpack2x16snorm(e,r);case"unpack2x16unorm":return this.builtins.Unpack2x16unorm(e,r);case"unpack2x16float":return this.builtins.Unpack2x16float(e,r);case"storageBarrier":return this.builtins.StorageBarrier(e,r);case"textureBarrier":return this.builtins.TextureBarrier(e,r);case"workgroupBarrier":return this.builtins.WorkgroupBarrier(e,r);case"workgroupUniformLoad":return this.builtins.WorkgroupUniformLoad(e,r);case"subgroupAdd":return this.builtins.SubgroupAdd(e,r);case"subgroupExclusiveAdd":return this.builtins.SubgroupExclusiveAdd(e,r);case"subgroupInclusiveAdd":return this.builtins.SubgroupInclusiveAdd(e,r);case"subgroupAll":return this.builtins.SubgroupAll(e,r);case"subgroupAnd":return this.builtins.SubgroupAnd(e,r);case"subgroupAny":return this.builtins.SubgroupAny(e,r);case"subgroupBallot":return this.builtins.SubgroupBallot(e,r);case"subgroupBroadcast":return this.builtins.SubgroupBroadcast(e,r);case"subgroupBroadcastFirst":return this.builtins.SubgroupBroadcastFirst(e,r);case"subgroupElect":return this.builtins.SubgroupElect(e,r);case"subgroupMax":return this.builtins.SubgroupMax(e,r);case"subgroupMin":return this.builtins.SubgroupMin(e,r);case"subgroupMul":return this.builtins.SubgroupMul(e,r);case"subgroupExclusiveMul":return this.builtins.SubgroupExclusiveMul(e,r);case"subgroupInclusiveMul":return this.builtins.SubgroupInclusiveMul(e,r);case"subgroupOr":return this.builtins.SubgroupOr(e,r);case"subgroupShuffle":return this.builtins.SubgroupShuffle(e,r);case"subgroupShuffleDown":return this.builtins.SubgroupShuffleDown(e,r);case"subgroupShuffleUp":return this.builtins.SubgroupShuffleUp(e,r);case"subgroupShuffleXor":return this.builtins.SubgroupShuffleXor(e,r);case"subgroupXor":return this.builtins.SubgroupXor(e,r);case"quadBroadcast":return this.builtins.QuadBroadcast(e,r);case"quadSwapDiagonal":return this.builtins.QuadSwapDiagonal(e,r);case"quadSwapX":return this.builtins.QuadSwapX(e,r);case"quadSwapY":return this.builtins.QuadSwapY(e,r)}const n=r.getFunction(e.name);if(n){const i=r.clone();for(let a=0;a<n.node.args.length;++a){const s=n.node.args[a],o=this.evalExpression(e.args[a],i);i.setVariable(s.name,o,s)}return this._execStatements(n.node.body,i)}return null}_callConstructorValue(e,r){if(!e.args||e.args.length===0)return new ir(0,this.getTypeInfo(e.type));const n=this.evalExpression(e.args[0],r);return n.typeInfo=this.getTypeInfo(e.type),n.getSubData(this,e.postfix,r).clone()}_callConstructorVec(e,r){const n=this.getTypeInfo(e.type),i=e.type.getTypeName(),a=WP[i];if(a===void 0)return console.error(`Invalid vec constructor ${i}. Line ${e.line}`),null;const s=[];if(e instanceof Ol)if(e.isVector){const o=e.vectorValue;for(const c of o)s.push(c)}else s.push(e.scalarValue);else if(e.args)for(const o of e.args){const c=this.evalExpression(o,r);if(c instanceof kt){const f=c.data;for(let d=0;d<f.length;++d){let m=f[d];s.push(m)}}else if(c instanceof ir){let f=c.value;s.push(f)}}if(e.type instanceof fr&&e.type.format===null&&(e.type.format=fr.f32),s.length===0){const o=new Array(a).fill(0);return new kt(o,n).getSubData(this,e.postfix,r)}if(s.length===1)for(;s.length<a;)s.push(s[0]);return s.length<a?(console.error(`Invalid vec constructor. Line ${e.line}`),null):new kt(s.length>a?s.slice(0,a):s,n).getSubData(this,e.postfix,r)}_callConstructorMatrix(e,r){const n=this.getTypeInfo(e.type),i=e.type.getTypeName(),a=dc[i];if(a===void 0)return console.error(`Invalid matrix constructor ${i}. Line ${e.line}`),null;const s=[];if(e instanceof Ol)if(e.isVector){const o=e.vectorValue;for(const c of o)s.push(c)}else s.push(e.scalarValue);else if(e.args)for(const o of e.args){const c=this.evalExpression(o,r);c instanceof kt?s.push(...c.data):c instanceof ir?s.push(c.value):c instanceof Ii&&s.push(...c.data)}if(n instanceof py&&n.format===null&&(n.format=this.getTypeInfo("f32")),s.length===0){const o=new Array(a[2]).fill(0);return new Ii(o,n).getSubData(this,e.postfix,r)}return s.length!==a[2]?(console.error(`Invalid matrix constructor. Line ${e.line}`),null):new Ii(s,n).getSubData(this,e.postfix,r)}}Ju._breakObj=new Kf(new Vf("BREAK",null),null),Ju._continueObj=new Kf(new Vf("CONTINUE",null),null),Ju._priority=new Map([["f32",0],["f16",1],["u32",2],["i32",3],["x32",3]]);class x7e{constructor(){this.constants=new Map,this.aliases=new Map,this.structs=new Map}}class w7e{constructor(){this._tokens=[],this._current=0,this._currentLine=1,this._deferArrayCountEval=[],this._currentLoop=[],this._context=new x7e,this._exec=new Ju,this._forwardTypeCount=0}parse(e){this._initialize(e),this._deferArrayCountEval.length=0;const r=[];for(;!this._isAtEnd();){const n=this._global_decl_or_directive();if(!n)break;r.push(n)}if(this._deferArrayCountEval.length>0){for(const n of this._deferArrayCountEval){const i=n.arrayType,a=n.countNode;if(a instanceof af){const s=a.name,o=this._context.constants.get(s);if(o)try{const c=o.constEvaluate(this._exec);i.count=c}catch{}}}this._deferArrayCountEval.length=0}if(this._forwardTypeCount>0)for(const n of r)n.search(i=>{i instanceof TG||i instanceof MS?i.type=this._forwardType(i.type):i instanceof Cb?i.format=this._forwardType(i.format):i instanceof cp||i instanceof Tb||i instanceof RS?i.type=this._forwardType(i.type):i instanceof dx?i.returnType=this._forwardType(i.returnType):i instanceof EG&&(i.type=this._forwardType(i.type))});return r}_forwardType(e){if(e instanceof SG){const r=this._getType(e.name);if(r)return r}else e instanceof MS?e.type=this._forwardType(e.type):e instanceof Cb&&(e.format=this._forwardType(e.format));return e}_initialize(e){if(e)if(typeof e=="string"){const r=new f7e(e);this._tokens=r.scanTokens()}else this._tokens=e;else this._tokens=[];this._current=0}_updateNode(e,r){return e.line=r??this._currentLine,e}_error(e,r){return{token:e,message:r,toString:()=>`${r}`}}_isAtEnd(){return this._current>=this._tokens.length||this._peek().type==vt.eof}_match(e){if(e instanceof sr)return!!this._check(e)&&(this._advance(),!0);for(let r=0,n=e.length;r<n;++r){const i=e[r];if(this._check(i))return this._advance(),!0}return!1}_consume(e,r){if(this._check(e))return this._advance();throw this._error(this._peek(),`${r}. Line:${this._currentLine}`)}_check(e){if(this._isAtEnd())return!1;const r=this._peek();if(e instanceof Array){const n=r.type;let i=!1;for(const a of e){if(n===a)return!0;a===vt.tokens.name&&(i=!0)}if(i){const a=vt.tokens.name.rule.exec(r.lexeme);if(a&&a.index==0&&a[0]==r.lexeme)return!0}return!1}if(r.type===e)return!0;if(e===vt.tokens.name){const n=vt.tokens.name.rule.exec(r.lexeme);return n&&n.index==0&&n[0]==r.lexeme}return!1}_advance(){var e,r;return this._currentLine=(r=(e=this._peek())===null||e===void 0?void 0:e.line)!==null&&r!==void 0?r:-1,this._isAtEnd()||this._current++,this._previous()}_peek(){return this._tokens[this._current]}_previous(){return this._tokens[this._current-1]}_global_decl_or_directive(){for(;this._match(vt.tokens.semicolon)&&!this._isAtEnd(););if(this._match(vt.keywords.alias)){const r=this._type_alias();return this._consume(vt.tokens.semicolon,"Expected ';'"),this._exec.reflection.updateAST([r]),r}if(this._match(vt.keywords.diagnostic)){const r=this._diagnostic();return this._consume(vt.tokens.semicolon,"Expected ';'"),this._exec.reflection.updateAST([r]),r}if(this._match(vt.keywords.requires)){const r=this._requires_directive();return this._consume(vt.tokens.semicolon,"Expected ';'"),this._exec.reflection.updateAST([r]),r}if(this._match(vt.keywords.enable)){const r=this._enable_directive();return this._consume(vt.tokens.semicolon,"Expected ';'"),this._exec.reflection.updateAST([r]),r}const e=this._attribute();if(this._check(vt.keywords.var)){const r=this._global_variable_decl();return r!=null&&(r.attributes=e),this._consume(vt.tokens.semicolon,"Expected ';'."),this._exec.reflection.updateAST([r]),r}if(this._check(vt.keywords.override)){const r=this._override_variable_decl();return r!=null&&(r.attributes=e),this._consume(vt.tokens.semicolon,"Expected ';'."),this._exec.reflection.updateAST([r]),r}if(this._check(vt.keywords.let)){const r=this._global_let_decl();return r!=null&&(r.attributes=e),this._consume(vt.tokens.semicolon,"Expected ';'."),this._exec.reflection.updateAST([r]),r}if(this._check(vt.keywords.const)){const r=this._global_const_decl();return r!=null&&(r.attributes=e),this._consume(vt.tokens.semicolon,"Expected ';'."),this._exec.reflection.updateAST([r]),r}if(this._check(vt.keywords.struct)){const r=this._struct_decl();return r!=null&&(r.attributes=e),this._exec.reflection.updateAST([r]),r}if(this._check(vt.keywords.fn)){const r=this._function_decl();return r!=null&&(r.attributes=e),this._exec.reflection.updateAST([r]),r}return null}_function_decl(){if(!this._match(vt.keywords.fn))return null;const e=this._currentLine,r=this._consume(vt.tokens.ident,"Expected function name.").toString();this._consume(vt.tokens.paren_left,"Expected '(' for function arguments.");const n=[];if(!this._check(vt.tokens.paren_right))do{if(this._check(vt.tokens.paren_right))break;const o=this._attribute(),c=this._consume(vt.tokens.name,"Expected argument name.").toString();this._consume(vt.tokens.colon,"Expected ':' for argument type.");const f=this._attribute(),d=this._type_decl();d!=null&&(d.attributes=f,n.push(this._updateNode(new EG(c,d,o))))}while(this._match(vt.tokens.comma));this._consume(vt.tokens.paren_right,"Expected ')' after function arguments.");let i=null;if(this._match(vt.tokens.arrow)){const o=this._attribute();i=this._type_decl(),i!=null&&(i.attributes=o)}const a=this._compound_statement(),s=this._currentLine;return this._updateNode(new dx(r,n,i,a,e,s),e)}_compound_statement(){const e=[];for(this._consume(vt.tokens.brace_left,"Expected '{' for block.");!this._check(vt.tokens.brace_right);){const r=this._statement();r!==null&&e.push(r)}return this._consume(vt.tokens.brace_right,"Expected '}' for block."),e}_statement(){for(;this._match(vt.tokens.semicolon)&&!this._isAtEnd(););if(this._check(vt.tokens.attr)&&this._attribute(),this._check(vt.keywords.if))return this._if_statement();if(this._check(vt.keywords.switch))return this._switch_statement();if(this._check(vt.keywords.loop))return this._loop_statement();if(this._check(vt.keywords.for))return this._for_statement();if(this._check(vt.keywords.while))return this._while_statement();if(this._check(vt.keywords.continuing))return this._continuing_statement();if(this._check(vt.keywords.static_assert))return this._static_assert_statement();if(this._check(vt.tokens.brace_left))return this._compound_statement();let e=null;if(this._check(vt.keywords.return))e=this._return_statement();else if(this._check([vt.keywords.var,vt.keywords.let,vt.keywords.const]))e=this._variable_statement();else if(this._match(vt.keywords.discard))e=this._updateNode(new l7e);else if(this._match(vt.keywords.break)){const r=this._updateNode(new Pre);if(this._currentLoop.length>0){const n=this._currentLoop[this._currentLoop.length-1];r.loopId=n.id}e=r,this._check(vt.keywords.if)&&(this._advance(),r.condition=this._optional_paren_expression())}else if(this._match(vt.keywords.continue)){const r=this._updateNode(new kre);if(!(this._currentLoop.length>0))throw this._error(this._peek(),`Continue statement must be inside a loop. Line: ${r.line}`);{const n=this._currentLoop[this._currentLoop.length-1];r.loopId=n.id}e=r}else e=this._increment_decrement_statement()||this._func_call_statement()||this._assignment_statement();return e!=null&&this._consume(vt.tokens.semicolon,"Expected ';' after statement."),e}_static_assert_statement(){if(!this._match(vt.keywords.static_assert))return null;const e=this._currentLine,r=this._optional_paren_expression();return this._updateNode(new a7e(r),e)}_while_statement(){if(!this._match(vt.keywords.while))return null;const e=this._updateNode(new bre(null,null));return this._currentLoop.push(e),e.condition=this._optional_paren_expression(),this._check(vt.tokens.attr)&&this._attribute(),e.body=this._compound_statement(),this._currentLoop.pop(),e}_continuing_statement(){const e=this._currentLoop.length>0?this._currentLoop[this._currentLoop.length-1].id:-1;if(!this._match(vt.keywords.continuing))return null;const r=this._currentLine,n=this._compound_statement();return this._updateNode(new nD(n,e),r)}_for_statement(){if(!this._match(vt.keywords.for))return null;this._consume(vt.tokens.paren_left,"Expected '('.");const e=this._updateNode(new xre(null,null,null,null));return this._currentLoop.push(e),e.init=this._check(vt.tokens.semicolon)?null:this._for_init(),this._consume(vt.tokens.semicolon,"Expected ';'."),e.condition=this._check(vt.tokens.semicolon)?null:this._short_circuit_or_expression(),this._consume(vt.tokens.semicolon,"Expected ';'."),e.increment=this._check(vt.tokens.paren_right)?null:this._for_increment(),this._consume(vt.tokens.paren_right,"Expected ')'."),this._check(vt.tokens.attr)&&this._attribute(),e.body=this._compound_statement(),this._currentLoop.pop(),e}_for_init(){return this._variable_statement()||this._func_call_statement()||this._assignment_statement()}_for_increment(){return this._func_call_statement()||this._increment_decrement_statement()||this._assignment_statement()}_variable_statement(){if(this._check(vt.keywords.var)){const e=this._variable_decl();if(e===null)throw this._error(this._peek(),"Variable declaration expected.");let r=null;return this._match(vt.tokens.equal)&&(r=this._short_circuit_or_expression()),this._updateNode(new cp(e.name,e.type,e.storage,e.access,r),e.line)}if(this._match(vt.keywords.let)){const e=this._currentLine,r=this._consume(vt.tokens.name,"Expected name for let.").toString();let n=null;if(this._match(vt.tokens.colon)){const a=this._attribute();n=this._type_decl(),n!=null&&(n.attributes=a)}this._consume(vt.tokens.equal,"Expected '=' for let.");const i=this._short_circuit_or_expression();return this._updateNode(new Tb(r,n,null,null,i),e)}if(this._match(vt.keywords.const)){const e=this._currentLine,r=this._consume(vt.tokens.name,"Expected name for const.").toString();let n=null;if(this._match(vt.tokens.colon)){const a=this._attribute();n=this._type_decl(),n!=null&&(n.attributes=a)}this._consume(vt.tokens.equal,"Expected '=' for const.");const i=this._short_circuit_or_expression();return n===null&&i instanceof Ol&&(n=i.type),this._updateNode(new RS(r,n,null,null,i),e)}return null}_increment_decrement_statement(){const e=this._current,r=this._unary_expression();if(r==null)return null;if(!this._check(vt.increment_operators))return this._current=e,null;const n=this._consume(vt.increment_operators,"Expected increment operator");return this._updateNode(new wre(n.type===vt.tokens.plus_plus?g0.increment:g0.decrement,r))}_assignment_statement(){let e=null;const r=this._currentLine;if(this._check(vt.tokens.brace_right))return null;let n=this._match(vt.tokens.underscore);if(n||(e=this._unary_expression()),!n&&e==null)return null;const i=this._consume(vt.assignment_operators,"Expected assignment operator."),a=this._short_circuit_or_expression();return this._updateNode(new Sre(Q1.parse(i.lexeme),e,a),r)}_func_call_statement(){if(!this._check(vt.tokens.ident))return null;const e=this._currentLine,r=this._current,n=this._consume(vt.tokens.ident,"Expected function name."),i=this._argument_expression_list();return i===null?(this._current=r,null):this._updateNode(new QL(n.lexeme,i),e)}_loop_statement(){if(!this._match(vt.keywords.loop))return null;this._check(vt.tokens.attr)&&this._attribute(),this._consume(vt.tokens.brace_left,"Expected '{' for loop.");const e=this._updateNode(new Ere([],null));this._currentLoop.push(e);let r=this._statement();for(;r!==null;){if(Array.isArray(r))for(let n of r)e.body.push(n);else e.body.push(r);if(r instanceof nD){e.continuing=r;break}r=this._statement()}return this._currentLoop.pop(),this._consume(vt.tokens.brace_right,"Expected '}' for loop."),e}_switch_statement(){if(!this._match(vt.keywords.switch))return null;const e=this._updateNode(new Tre(null,[]));if(this._currentLoop.push(e),e.condition=this._optional_paren_expression(),this._check(vt.tokens.attr)&&this._attribute(),this._consume(vt.tokens.brace_left,"Expected '{' for switch."),e.cases=this._switch_body(),e.cases==null||e.cases.length==0)throw this._error(this._previous(),"Expected 'case' or 'default'.");return this._consume(vt.tokens.brace_right,"Expected '}' for switch."),this._currentLoop.pop(),e}_switch_body(){const e=[];let r=!1;for(;this._check([vt.keywords.default,vt.keywords.case]);){if(this._match(vt.keywords.case)){const n=this._case_selectors();for(const a of n)if(a instanceof DS){if(r)throw this._error(this._previous(),"Multiple default cases in switch statement.");r=!0;break}this._match(vt.tokens.colon),this._check(vt.tokens.attr)&&this._attribute(),this._consume(vt.tokens.brace_left,"Exected '{' for switch case.");const i=this._case_body();this._consume(vt.tokens.brace_right,"Exected '}' for switch case."),e.push(this._updateNode(new Nre(n,i)))}if(this._match(vt.keywords.default)){if(r)throw this._error(this._previous(),"Multiple default cases in switch statement.");this._match(vt.tokens.colon),this._check(vt.tokens.attr)&&this._attribute(),this._consume(vt.tokens.brace_left,"Exected '{' for switch default.");const n=this._case_body();this._consume(vt.tokens.brace_right,"Exected '}' for switch default."),e.push(this._updateNode(new Lre(n)))}}return e}_case_selectors(){const e=[];for(this._match(vt.keywords.default)?e.push(this._updateNode(new DS)):e.push(this._shift_expression());this._match(vt.tokens.comma);)this._match(vt.keywords.default)?e.push(this._updateNode(new DS)):e.push(this._shift_expression());return e}_case_body(){if(this._match(vt.keywords.fallthrough))return this._consume(vt.tokens.semicolon,"Expected ';'"),[];let e=this._statement();if(e==null)return[];e instanceof Array||(e=[e]);const r=this._case_body();return r.length==0?e:[...e,r[0]]}_if_statement(){if(!this._match(vt.keywords.if))return null;const e=this._currentLine,r=this._optional_paren_expression();this._check(vt.tokens.attr)&&this._attribute();const n=this._compound_statement();let i=[];this._match_elseif()&&(this._check(vt.tokens.attr)&&this._attribute(),i=this._elseif_statement(i));let a=null;return this._match(vt.keywords.else)&&(this._check(vt.tokens.attr)&&this._attribute(),a=this._compound_statement()),this._updateNode(new Cre(r,n,i,a),e)}_match_elseif(){return this._tokens[this._current].type===vt.keywords.else&&this._tokens[this._current+1].type===vt.keywords.if&&(this._advance(),this._advance(),!0)}_elseif_statement(e=[]){const r=this._optional_paren_expression(),n=this._compound_statement();return e.push(this._updateNode(new u7e(r,n))),this._match_elseif()&&(this._check(vt.tokens.attr)&&this._attribute(),this._elseif_statement(e)),e}_return_statement(){if(!this._match(vt.keywords.return))return null;const e=this._short_circuit_or_expression();return this._updateNode(new Are(e))}_short_circuit_or_expression(){let e=this._short_circuit_and_expr();for(;this._match(vt.tokens.or_or);)e=this._updateNode(new yh(this._previous().toString(),e,this._short_circuit_and_expr()));return e}_short_circuit_and_expr(){let e=this._inclusive_or_expression();for(;this._match(vt.tokens.and_and);)e=this._updateNode(new yh(this._previous().toString(),e,this._inclusive_or_expression()));return e}_inclusive_or_expression(){let e=this._exclusive_or_expression();for(;this._match(vt.tokens.or);)e=this._updateNode(new yh(this._previous().toString(),e,this._exclusive_or_expression()));return e}_exclusive_or_expression(){let e=this._and_expression();for(;this._match(vt.tokens.xor);)e=this._updateNode(new yh(this._previous().toString(),e,this._and_expression()));return e}_and_expression(){let e=this._equality_expression();for(;this._match(vt.tokens.and);)e=this._updateNode(new yh(this._previous().toString(),e,this._equality_expression()));return e}_equality_expression(){const e=this._relational_expression();return this._match([vt.tokens.equal_equal,vt.tokens.not_equal])?this._updateNode(new yh(this._previous().toString(),e,this._relational_expression())):e}_relational_expression(){let e=this._shift_expression();for(;this._match([vt.tokens.less_than,vt.tokens.greater_than,vt.tokens.less_than_equal,vt.tokens.greater_than_equal]);)e=this._updateNode(new yh(this._previous().toString(),e,this._shift_expression()));return e}_shift_expression(){let e=this._additive_expression();for(;this._match([vt.tokens.shift_left,vt.tokens.shift_right]);)e=this._updateNode(new yh(this._previous().toString(),e,this._additive_expression()));return e}_additive_expression(){let e=this._multiplicative_expression();for(;this._match([vt.tokens.plus,vt.tokens.minus]);)e=this._updateNode(new yh(this._previous().toString(),e,this._multiplicative_expression()));return e}_multiplicative_expression(){let e=this._unary_expression();for(;this._match([vt.tokens.star,vt.tokens.forward_slash,vt.tokens.modulo]);)e=this._updateNode(new yh(this._previous().toString(),e,this._unary_expression()));return e}_unary_expression(){return this._match([vt.tokens.minus,vt.tokens.bang,vt.tokens.tilde,vt.tokens.star,vt.tokens.and])?this._updateNode(new wl(this._previous().toString(),this._unary_expression())):this._singular_expression()}_singular_expression(){const e=this._primary_expression(),r=this._postfix_expression();return r&&(e.postfix=r),e}_postfix_expression(){if(this._match(vt.tokens.bracket_left)){const e=this._short_circuit_or_expression();this._consume(vt.tokens.bracket_right,"Expected ']'.");const r=this._updateNode(new i_(e)),n=this._postfix_expression();return n&&(r.postfix=n),r}if(this._match(vt.tokens.period)){const e=this._consume(vt.tokens.name,"Expected member name."),r=this._postfix_expression(),n=this._updateNode(new gy(e.lexeme));return r&&(n.postfix=r),n}return null}_getStruct(e){return this._context.aliases.has(e)?this._context.aliases.get(e).type:this._context.structs.has(e)?this._context.structs.get(e):null}_getType(e){const r=this._getStruct(e);if(r!==null)return r;switch(e){case"void":return Kr.void;case"bool":return Kr.bool;case"i32":return Kr.i32;case"u32":return Kr.u32;case"f32":return Kr.f32;case"f16":return Kr.f16;case"vec2f":return fr.vec2f;case"vec3f":return fr.vec3f;case"vec4f":return fr.vec4f;case"vec2i":return fr.vec2i;case"vec3i":return fr.vec3i;case"vec4i":return fr.vec4i;case"vec2u":return fr.vec2u;case"vec3u":return fr.vec3u;case"vec4u":return fr.vec4u;case"vec2h":return fr.vec2h;case"vec3h":return fr.vec3h;case"vec4h":return fr.vec4h;case"mat2x2f":return fr.mat2x2f;case"mat2x3f":return fr.mat2x3f;case"mat2x4f":return fr.mat2x4f;case"mat3x2f":return fr.mat3x2f;case"mat3x3f":return fr.mat3x3f;case"mat3x4f":return fr.mat3x4f;case"mat4x2f":return fr.mat4x2f;case"mat4x3f":return fr.mat4x3f;case"mat4x4f":return fr.mat4x4f;case"mat2x2h":return fr.mat2x2h;case"mat2x3h":return fr.mat2x3h;case"mat2x4h":return fr.mat2x4h;case"mat3x2h":return fr.mat3x2h;case"mat3x3h":return fr.mat3x3h;case"mat3x4h":return fr.mat3x4h;case"mat4x2h":return fr.mat4x2h;case"mat4x3h":return fr.mat4x3h;case"mat4x4h":return fr.mat4x4h;case"mat2x2i":return fr.mat2x2i;case"mat2x3i":return fr.mat2x3i;case"mat2x4i":return fr.mat2x4i;case"mat3x2i":return fr.mat3x2i;case"mat3x3i":return fr.mat3x3i;case"mat3x4i":return fr.mat3x4i;case"mat4x2i":return fr.mat4x2i;case"mat4x3i":return fr.mat4x3i;case"mat4x4i":return fr.mat4x4i;case"mat2x2u":return fr.mat2x2u;case"mat2x3u":return fr.mat2x3u;case"mat2x4u":return fr.mat2x4u;case"mat3x2u":return fr.mat3x2u;case"mat3x3u":return fr.mat3x3u;case"mat3x4u":return fr.mat3x4u;case"mat4x2u":return fr.mat4x2u;case"mat4x3u":return fr.mat4x3u;case"mat4x4u":return fr.mat4x4u}return null}_validateTypeRange(e,r){if(r.name==="i32"){if(e<-2147483648||e>2147483647)throw this._error(this._previous(),`Value out of range for i32: ${e}. Line: ${this._currentLine}.`)}else if(r.name==="u32"&&(e<0||e>4294967295))throw this._error(this._previous(),`Value out of range for u32: ${e}. Line: ${this._currentLine}.`)}_primary_expression(){if(this._match(vt.tokens.ident)){const n=this._previous().toString();if(this._check(vt.tokens.paren_left)){const i=this._argument_expression_list(),a=this._getType(n);return a!==null?this._updateNode(new sd(a,i)):this._updateNode(new t6(n,i))}if(this._context.constants.has(n)){const i=this._context.constants.get(n);return this._updateNode(new Rre(n,i.value))}return this._updateNode(new af(n))}if(this._match(vt.tokens.int_literal)){const n=this._previous().toString();let i=n.endsWith("i")||n.endsWith("i")?Kr.i32:n.endsWith("u")||n.endsWith("U")?Kr.u32:Kr.x32;const a=parseInt(n);return this._validateTypeRange(a,i),this._updateNode(new Ol(new ir(a,this._exec.getTypeInfo(i)),i))}if(this._match(vt.tokens.uint_literal)){const n=parseInt(this._previous().toString());return this._validateTypeRange(n,Kr.u32),this._updateNode(new Ol(new ir(n,this._exec.getTypeInfo(Kr.u32)),Kr.u32))}if(this._match([vt.tokens.decimal_float_literal,vt.tokens.hex_float_literal])){let n=this._previous().toString(),i=n.endsWith("h");i&&(n=n.substring(0,n.length-1));const a=parseFloat(n);this._validateTypeRange(a,i?Kr.f16:Kr.f32);const s=i?Kr.f16:Kr.f32;return this._updateNode(new Ol(new ir(a,this._exec.getTypeInfo(s)),s))}if(this._match([vt.keywords.true,vt.keywords.false])){let n=this._previous().toString()===vt.keywords.true.rule;return this._updateNode(new Ol(new ir(n?1:0,this._exec.getTypeInfo(Kr.bool)),Kr.bool))}if(this._check(vt.tokens.paren_left))return this._paren_expression();if(this._match(vt.keywords.bitcast)){this._consume(vt.tokens.less_than,"Expected '<'.");const n=this._type_decl();this._consume(vt.tokens.greater_than,"Expected '>'.");const i=this._paren_expression();return this._updateNode(new Mre(n,i))}const e=this._type_decl(),r=this._argument_expression_list();return this._updateNode(new sd(e,r))}_argument_expression_list(){if(!this._match(vt.tokens.paren_left))return null;const e=[];do{if(this._check(vt.tokens.paren_right))break;const r=this._short_circuit_or_expression();e.push(r)}while(this._match(vt.tokens.comma));return this._consume(vt.tokens.paren_right,"Expected ')' for agument list"),e}_optional_paren_expression(){this._match(vt.tokens.paren_left);const e=this._short_circuit_or_expression();return this._match(vt.tokens.paren_right),e}_paren_expression(){this._consume(vt.tokens.paren_left,"Expected '('.");const e=this._short_circuit_or_expression();return this._consume(vt.tokens.paren_right,"Expected ')'."),e}_struct_decl(){if(!this._match(vt.keywords.struct))return null;const e=this._currentLine,r=this._consume(vt.tokens.ident,"Expected name for struct.").toString();this._consume(vt.tokens.brace_left,"Expected '{' for struct body.");const n=[];for(;!this._check(vt.tokens.brace_right);){const s=this._attribute(),o=this._consume(vt.tokens.name,"Expected variable name.").toString();this._consume(vt.tokens.colon,"Expected ':' for struct member type.");const c=this._attribute(),f=this._type_decl();f!=null&&(f.attributes=c),this._check(vt.tokens.brace_right)?this._match(vt.tokens.comma):this._consume(vt.tokens.comma,"Expected ',' for struct member."),n.push(this._updateNode(new TG(o,f,s)))}this._consume(vt.tokens.brace_right,"Expected '}' after struct body.");const i=this._currentLine,a=this._updateNode(new op(r,n,e,i),e);return this._context.structs.set(r,a),a}_global_variable_decl(){const e=this._variable_decl();if(!e)return null;if(this._match(vt.tokens.equal)){const r=this._const_expression();e.value=r}if(e.type!==null&&e.value instanceof Ol){if(e.value.type.name!=="x32"&&e.type.getTypeName()!==e.value.type.getTypeName())throw this._error(this._peek(),`Invalid cast from ${e.value.type.name} to ${e.type.name}. Line:${this._currentLine}`);e.value.isScalar&&this._validateTypeRange(e.value.scalarValue,e.type),e.value.type=e.type}else e.type===null&&e.value instanceof Ol&&(e.type=e.value.type.name==="x32"?Kr.i32:e.value.type,e.value.isScalar&&this._validateTypeRange(e.value.scalarValue,e.type));return e}_override_variable_decl(){const e=this._override_decl();return e&&this._match(vt.tokens.equal)&&(e.value=this._const_expression()),e}_global_const_decl(){var e;if(!this._match(vt.keywords.const))return null;const r=this._consume(vt.tokens.name,"Expected variable name"),n=this._currentLine;let i=null;if(this._match(vt.tokens.colon)){const c=this._attribute();i=this._type_decl(),i!=null&&(i.attributes=c)}let a=null;this._consume(vt.tokens.equal,"const declarations require an assignment");const s=this._short_circuit_or_expression();try{let c=[Kr.f32],f=s.constEvaluate(this._exec,c);f instanceof ir&&this._validateTypeRange(f.value,c[0]),c[0]instanceof fr&&c[0].format===null&&f.typeInfo instanceof py&&f.typeInfo.format!==null&&(f.typeInfo.format.name==="f16"?c[0].format=Kr.f16:f.typeInfo.format.name==="f32"?c[0].format=Kr.f32:f.typeInfo.format.name==="i32"?c[0].format=Kr.i32:f.typeInfo.format.name==="u32"?c[0].format=Kr.u32:f.typeInfo.format.name==="bool"?c[0].format=Kr.bool:console.error(`TODO: impelement template format type ${f.typeInfo.format.name}`)),a=this._updateNode(new Ol(f,c[0])),this._exec.context.setVariable(r.toString(),f)}catch{a=s}if(i!==null&&a instanceof Ol){if(a.type.name!=="x32"&&i.getTypeName()!==a.type.getTypeName())throw this._error(this._peek(),`Invalid cast from ${a.type.name} to ${i.name}. Line:${this._currentLine}`);a.type=i,a.isScalar&&this._validateTypeRange(a.scalarValue,a.type)}else i===null&&a instanceof Ol&&(i=(e=a?.type)!==null&&e!==void 0?e:Kr.f32,i===Kr.x32&&(i=Kr.i32));const o=this._updateNode(new RS(r.toString(),i,"","",a),n);return this._context.constants.set(o.name,o),o}_global_let_decl(){if(!this._match(vt.keywords.let))return null;const e=this._currentLine,r=this._consume(vt.tokens.name,"Expected variable name");let n=null;if(this._match(vt.tokens.colon)){const a=this._attribute();n=this._type_decl(),n!=null&&(n.attributes=a)}let i=null;if(this._match(vt.tokens.equal)&&(i=this._const_expression()),n!==null&&i instanceof Ol){if(i.type.name!=="x32"&&n.getTypeName()!==i.type.getTypeName())throw this._error(this._peek(),`Invalid cast from ${i.type.name} to ${n.name}. Line:${this._currentLine}`);i.type=n}else n===null&&i instanceof Ol&&(n=i.type.name==="x32"?Kr.i32:i.type);return i instanceof Ol&&i.isScalar&&this._validateTypeRange(i.scalarValue,n),this._updateNode(new Tb(r.toString(),n,"","",i),e)}_const_expression(){return this._short_circuit_or_expression()}_variable_decl(){if(!this._match(vt.keywords.var))return null;const e=this._currentLine;let r="",n="";this._match(vt.tokens.less_than)&&(r=this._consume(vt.storage_class,"Expected storage_class.").toString(),this._match(vt.tokens.comma)&&(n=this._consume(vt.access_mode,"Expected access_mode.").toString()),this._consume(vt.tokens.greater_than,"Expected '>'."));const i=this._consume(vt.tokens.name,"Expected variable name");let a=null;if(this._match(vt.tokens.colon)){const s=this._attribute();a=this._type_decl(),a!=null&&(a.attributes=s)}return this._updateNode(new cp(i.toString(),a,r,n,null),e)}_override_decl(){if(!this._match(vt.keywords.override))return null;const e=this._consume(vt.tokens.name,"Expected variable name");let r=null;if(this._match(vt.tokens.colon)){const n=this._attribute();r=this._type_decl(),r!=null&&(r.attributes=n)}return this._updateNode(new JL(e.toString(),r,null))}_diagnostic(){this._consume(vt.tokens.paren_left,"Expected '('");const e=this._consume(vt.tokens.ident,"Expected severity control name.");this._consume(vt.tokens.comma,"Expected ','");let r=this._consume(vt.tokens.ident,"Expected diagnostic rule name.").toString();return this._match(vt.tokens.period)&&(r+=`.${this._consume(vt.tokens.ident,"Expected diagnostic message.").toString()}`),this._consume(vt.tokens.paren_right,"Expected ')'"),this._updateNode(new Ire(e.toString(),r))}_enable_directive(){const e=this._consume(vt.tokens.ident,"identity expected.");return this._updateNode(new o7e(e.toString()))}_requires_directive(){const e=[this._consume(vt.tokens.ident,"identity expected.").toString()];for(;this._match(vt.tokens.comma);){const r=this._consume(vt.tokens.ident,"identity expected.");e.push(r.toString())}return this._updateNode(new s7e(e))}_type_alias(){const e=this._consume(vt.tokens.ident,"identity expected.");this._consume(vt.tokens.equal,"Expected '=' for type alias.");let r=this._type_decl();if(r===null)throw this._error(this._peek(),"Expected Type for Alias.");this._context.aliases.has(r.name)&&(r=this._context.aliases.get(r.name).type);const n=this._updateNode(new e6(e.toString(),r));return this._context.aliases.set(n.name,n),n}_type_decl(){if(this._check([vt.tokens.ident,...vt.texel_format,vt.keywords.bool,vt.keywords.f32,vt.keywords.i32,vt.keywords.u32])){const n=this._advance().toString();if(this._context.structs.has(n))return this._context.structs.get(n);if(this._context.aliases.has(n))return this._context.aliases.get(n).type;if(!this._getType(n)){const i=this._updateNode(new SG(n));return this._forwardTypeCount++,i}return this._updateNode(new Kr(n))}let e=this._texture_sampler_types();if(e)return e;if(this._check(vt.template_types)){let n=this._advance().toString(),i=null,a=null;return this._match(vt.tokens.less_than)&&(i=this._type_decl(),a=null,this._match(vt.tokens.comma)&&(a=this._consume(vt.access_mode,"Expected access_mode for pointer").toString()),this._consume(vt.tokens.greater_than,"Expected '>' for type.")),this._updateNode(new fr(n,i,a))}if(this._match(vt.keywords.ptr)){let n=this._previous().toString();this._consume(vt.tokens.less_than,"Expected '<' for pointer.");const i=this._consume(vt.storage_class,"Expected storage_class for pointer");this._consume(vt.tokens.comma,"Expected ',' for pointer.");const a=this._type_decl();let s=null;return this._match(vt.tokens.comma)&&(s=this._consume(vt.access_mode,"Expected access_mode for pointer").toString()),this._consume(vt.tokens.greater_than,"Expected '>' for pointer."),this._updateNode(new MS(n,i.toString(),a,s))}const r=this._attribute();if(this._match(vt.keywords.array)){let n=null,i=-1;const a=this._previous();let s=null;if(this._match(vt.tokens.less_than)){n=this._type_decl(),this._context.aliases.has(n.name)&&(n=this._context.aliases.get(n.name).type);let c="";if(this._match(vt.tokens.comma)){s=this._shift_expression();try{c=s.constEvaluate(this._exec).toString(),s=null}catch{c="1"}}this._consume(vt.tokens.greater_than,"Expected '>' for array."),i=c?parseInt(c):0}const o=this._updateNode(new Cb(a.toString(),r,n,i));return s&&this._deferArrayCountEval.push({arrayType:o,countNode:s}),o}return null}_texture_sampler_types(){if(this._match(vt.sampler_type))return this._updateNode(new eb(this._previous().toString(),null,null));if(this._match(vt.depth_texture_type))return this._updateNode(new eb(this._previous().toString(),null,null));if(this._match(vt.sampled_texture_type)||this._match(vt.multisampled_texture_type)){const e=this._previous();this._consume(vt.tokens.less_than,"Expected '<' for sampler type.");const r=this._type_decl();return this._consume(vt.tokens.greater_than,"Expected '>' for sampler type."),this._updateNode(new eb(e.toString(),r,null))}if(this._match(vt.storage_texture_type)){const e=this._previous();this._consume(vt.tokens.less_than,"Expected '<' for sampler type.");const r=this._consume(vt.texel_format,"Invalid texel format.").toString();this._consume(vt.tokens.comma,"Expected ',' after texel format.");const n=this._consume(vt.access_mode,"Expected access mode for storage texture type.").toString();return this._consume(vt.tokens.greater_than,"Expected '>' for sampler type."),this._updateNode(new eb(e.toString(),r,n))}return null}_attribute(){let e=[];for(;this._match(vt.tokens.attr);){const r=this._consume(vt.attribute_name,"Expected attribute name"),n=this._updateNode(new Fre(r.toString(),null));if(this._match(vt.tokens.paren_left)){if(n.value=this._consume(vt.literal_or_ident,"Expected attribute value").toString(),this._check(vt.tokens.comma)){this._advance();do{const i=this._consume(vt.literal_or_ident,"Expected attribute value").toString();n.value instanceof Array||(n.value=[n.value]),n.value.push(i)}while(this._match(vt.tokens.comma))}this._consume(vt.tokens.paren_right,"Expected ')'")}e.push(n)}return e.length==0?null:e}}class S7e extends pd{constructor(e){super(),e&&this.update(e)}update(e){const r=new w7e().parse(e);this.updateAST(r)}}function E7e(t){const e={attributes:[],bindings:[]};let r;try{r=T7e(t)}catch(a){return rn.error(a.message)(),e}for(const a of r.uniforms){const s=[];for(const o of a.type?.members||[])s.push({name:o.name,type:IG(o.type)});e.bindings.push({type:"uniform",name:a.name,group:a.group,location:a.binding,members:s})}for(const a of r.textures)e.bindings.push({type:"texture",name:a.name,group:a.group,location:a.binding});for(const a of r.samplers)e.bindings.push({type:"sampler",name:a.name,group:a.group,location:a.binding});const n=r.entry.vertex[0],i=n?.inputs.length||0;for(let a=0;a<i;a++){const s=n.inputs[a];if(s.locationType==="location"){const o=IG(s.type);e.attributes.push({name:s.name,location:Number(s.location),type:o})}}return e}function IG(t){return t?.format?`${t.name}<${t.format.name}>`:t.name}function T7e(t){try{return new S7e(t)}catch(e){if(e instanceof Error)throw e;let r="WGSL parse error";throw typeof e=="object"&&e?.message&&(r+=`: ${e.message} `),typeof e=="object"&&e?.token&&(r+=e.token.line||""),new Error(r,{cause:e})}}const C7e=1/Math.PI*180,A7e=1/180*Math.PI,I7e={EPSILON:1e-12,debug:!1,precision:4,printTypes:!1,printDegrees:!1,printRowMajor:!0,_cartographicRadians:!1};globalThis.mathgl=globalThis.mathgl||{config:{...I7e}};const uf=globalThis.mathgl.config;function P7e(t,{precision:e=uf.precision}={}){return t=M7e(t),`${parseFloat(t.toPrecision(e))}`}function a_(t){return Array.isArray(t)||ArrayBuffer.isView(t)&&!(t instanceof DataView)}function qWe(t){return k7e(t)}function HWe(t){return R7e(t)}function k7e(t,e){return o6(t,r=>r*A7e,e)}function R7e(t,e){return o6(t,r=>r*C7e,e)}function gd(t,e,r){return o6(t,n=>Math.max(e,Math.min(r,n)))}function _T(t,e,r){return a_(t)?t.map((n,i)=>_T(n,e[i],r)):r*e+(1-r)*t}function px(t,e,r){const n=uf.EPSILON;r&&(uf.EPSILON=r);try{if(t===e)return!0;if(a_(t)&&a_(e)){if(t.length!==e.length)return!1;for(let i=0;i<t.length;++i)if(!px(t[i],e[i]))return!1;return!0}return t&&t.equals?t.equals(e):e&&e.equals?e.equals(t):typeof t=="number"&&typeof e=="number"?Math.abs(t-e)<=uf.EPSILON*Math.max(1,Math.abs(t),Math.abs(e)):!1}finally{uf.EPSILON=n}}function M7e(t){return Math.round(t/uf.EPSILON)*uf.EPSILON}function D7e(t){return t.clone?t.clone():new Array(t.length)}function o6(t,e,r){if(a_(t)){const n=t;r=r||D7e(n);for(let i=0;i<r.length&&i<n.length;++i){const a=typeof t=="number"?t:t[i];r[i]=e(a,i,r)}return r}return e(t)}class Bre extends Array{clone(){return new this.constructor().copy(this)}fromArray(e,r=0){for(let n=0;n<this.ELEMENTS;++n)this[n]=e[n+r];return this.check()}toArray(e=[],r=0){for(let n=0;n<this.ELEMENTS;++n)e[r+n]=this[n];return e}toObject(e){return e}from(e){return Array.isArray(e)?this.copy(e):this.fromObject(e)}to(e){return e===this?this:a_(e)?this.toArray(e):this.toObject(e)}toTarget(e){return e?this.to(e):this}toFloat32Array(){return new Float32Array(this)}toString(){return this.formatString(uf)}formatString(e){let r="";for(let n=0;n<this.ELEMENTS;++n)r+=(n>0?", ":"")+P7e(this[n],e);return`${e.printTypes?this.constructor.name:""}[${r}]`}equals(e){if(!e||this.length!==e.length)return!1;for(let r=0;r<this.ELEMENTS;++r)if(!px(this[r],e[r]))return!1;return!0}exactEquals(e){if(!e||this.length!==e.length)return!1;for(let r=0;r<this.ELEMENTS;++r)if(this[r]!==e[r])return!1;return!0}negate(){for(let e=0;e<this.ELEMENTS;++e)this[e]=-this[e];return this.check()}lerp(e,r,n){if(n===void 0)return this.lerp(this,e,r);for(let i=0;i<this.ELEMENTS;++i){const a=e[i],s=typeof r=="number"?r:r[i];this[i]=a+n*(s-a)}return this.check()}min(e){for(let r=0;r<this.ELEMENTS;++r)this[r]=Math.min(e[r],this[r]);return this.check()}max(e){for(let r=0;r<this.ELEMENTS;++r)this[r]=Math.max(e[r],this[r]);return this.check()}clamp(e,r){for(let n=0;n<this.ELEMENTS;++n)this[n]=Math.min(Math.max(this[n],e[n]),r[n]);return this.check()}add(...e){for(const r of e)for(let n=0;n<this.ELEMENTS;++n)this[n]+=r[n];return this.check()}subtract(...e){for(const r of e)for(let n=0;n<this.ELEMENTS;++n)this[n]-=r[n];return this.check()}scale(e){if(typeof e=="number")for(let r=0;r<this.ELEMENTS;++r)this[r]*=e;else for(let r=0;r<this.ELEMENTS&&r<e.length;++r)this[r]*=e[r];return this.check()}multiplyByScalar(e){for(let r=0;r<this.ELEMENTS;++r)this[r]*=e;return this.check()}check(){if(uf.debug&&!this.validate())throw new Error(`math.gl: ${this.constructor.name} some fields set to invalid numbers'`);return this}validate(){let e=this.length===this.ELEMENTS;for(let r=0;r<this.ELEMENTS;++r)e=e&&Number.isFinite(this[r]);return e}sub(e){return this.subtract(e)}setScalar(e){for(let r=0;r<this.ELEMENTS;++r)this[r]=e;return this.check()}addScalar(e){for(let r=0;r<this.ELEMENTS;++r)this[r]+=e;return this.check()}subScalar(e){return this.addScalar(-e)}multiplyScalar(e){for(let r=0;r<this.ELEMENTS;++r)this[r]*=e;return this.check()}divideScalar(e){return this.multiplyByScalar(1/e)}clampScalar(e,r){for(let n=0;n<this.ELEMENTS;++n)this[n]=Math.min(Math.max(this[n],e),r);return this.check()}get elements(){return this}}function O7e(t,e){if(t.length!==e)return!1;for(let r=0;r<t.length;++r)if(!Number.isFinite(t[r]))return!1;return!0}function nf(t){if(!Number.isFinite(t))throw new Error(`Invalid number ${JSON.stringify(t)}`);return t}function XP(t,e,r=""){if(uf.debug&&!O7e(t,e))throw new Error(`math.gl: ${r} some fields set to invalid numbers'`);return t}function PG(t,e){if(!t)throw new Error(`math.gl assertion ${e}`)}class N7e extends Bre{get x(){return this[0]}set x(e){this[0]=nf(e)}get y(){return this[1]}set y(e){this[1]=nf(e)}len(){return Math.sqrt(this.lengthSquared())}magnitude(){return this.len()}lengthSquared(){let e=0;for(let r=0;r<this.ELEMENTS;++r)e+=this[r]*this[r];return e}magnitudeSquared(){return this.lengthSquared()}distance(e){return Math.sqrt(this.distanceSquared(e))}distanceSquared(e){let r=0;for(let n=0;n<this.ELEMENTS;++n){const i=this[n]-e[n];r+=i*i}return nf(r)}dot(e){let r=0;for(let n=0;n<this.ELEMENTS;++n)r+=this[n]*e[n];return nf(r)}normalize(){const e=this.magnitude();if(e!==0)for(let r=0;r<this.ELEMENTS;++r)this[r]/=e;return this.check()}multiply(...e){for(const r of e)for(let n=0;n<this.ELEMENTS;++n)this[n]*=r[n];return this.check()}divide(...e){for(const r of e)for(let n=0;n<this.ELEMENTS;++n)this[n]/=r[n];return this.check()}lengthSq(){return this.lengthSquared()}distanceTo(e){return this.distance(e)}distanceToSquared(e){return this.distanceSquared(e)}getComponent(e){return PG(e>=0&&e<this.ELEMENTS,"index is out of range"),nf(this[e])}setComponent(e,r){return PG(e>=0&&e<this.ELEMENTS,"index is out of range"),this[e]=r,this.check()}addVectors(e,r){return this.copy(e).add(r)}subVectors(e,r){return this.copy(e).subtract(r)}multiplyVectors(e,r){return this.copy(e).multiply(r)}addScaledVector(e,r){return this.add(new this.constructor(e).multiplyScalar(r))}}const OS=1e-6;let my=typeof Float32Array<"u"?Float32Array:Array;function L7e(){const t=new my(2);return my!=Float32Array&&(t[0]=0,t[1]=0),t}function kG(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t}function F7e(t,e){return t[0]=-e[0],t[1]=-e[1],t}function zre(t,e,r,n){const i=e[0],a=e[1];return t[0]=i+n*(r[0]-i),t[1]=a+n*(r[1]-a),t}function GWe(t,e,r){const n=e[0],i=e[1];return t[0]=r[0]*n+r[2]*i,t[1]=r[1]*n+r[3]*i,t}function WWe(t,e,r){const n=e[0],i=e[1];return t[0]=r[0]*n+r[2]*i+r[4],t[1]=r[1]*n+r[3]*i+r[5],t}function XWe(t,e,r){const n=e[0],i=e[1];return t[0]=r[0]*n+r[3]*i+r[6],t[1]=r[1]*n+r[4]*i+r[7],t}function B7e(t,e,r){const n=e[0],i=e[1];return t[0]=r[0]*n+r[4]*i+r[12],t[1]=r[1]*n+r[5]*i+r[13],t}(function(){const t=L7e();return function(e,r,n,i,a,s){let o,c;for(r||(r=2),n||(n=0),i?c=Math.min(i*r+n,e.length):c=e.length,o=n;o<c;o+=r)t[0]=e[o],t[1]=e[o+1],a(t,t,s),e[o]=t[0],e[o+1]=t[1];return e}})();function z7e(t,e,r){const n=e[0],i=e[1],a=r[3]*n+r[7]*i||1;return t[0]=(r[0]*n+r[4]*i)/a,t[1]=(r[1]*n+r[5]*i)/a,t}function jre(t,e,r){const n=e[0],i=e[1],a=e[2],s=r[3]*n+r[7]*i+r[11]*a||1;return t[0]=(r[0]*n+r[4]*i+r[8]*a)/s,t[1]=(r[1]*n+r[5]*i+r[9]*a)/s,t[2]=(r[2]*n+r[6]*i+r[10]*a)/s,t}function j7e(t,e,r){const n=e[0],i=e[1];return t[0]=r[0]*n+r[2]*i,t[1]=r[1]*n+r[3]*i,t[2]=e[2],t}function YWe(t,e,r){const n=e[0],i=e[1];return t[0]=r[0]*n+r[2]*i,t[1]=r[1]*n+r[3]*i,t[2]=e[2],t[3]=e[3],t}function ZWe(t,e,r){const n=e[0],i=e[1],a=e[2];return t[0]=r[0]*n+r[3]*i+r[6]*a,t[1]=r[1]*n+r[4]*i+r[7]*a,t[2]=r[2]*n+r[5]*i+r[8]*a,t[3]=e[3],t}function U7e(){const t=new my(3);return my!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}function V7e(t){const e=t[0],r=t[1],n=t[2];return Math.sqrt(e*e+r*r+n*n)}function KWe(t,e,r){const n=new my(3);return n[0]=t,n[1]=e,n[2]=r,n}function $7e(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t}function q7e(t){const e=t[0],r=t[1],n=t[2];return e*e+r*r+n*n}function H7e(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t}function JWe(t,e){const r=e[0],n=e[1],i=e[2];let a=r*r+n*n+i*i;return a>0&&(a=1/Math.sqrt(a)),t[0]=e[0]*a,t[1]=e[1]*a,t[2]=e[2]*a,t}function G7e(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function W7e(t,e,r){const n=e[0],i=e[1],a=e[2],s=r[0],o=r[1],c=r[2];return t[0]=i*c-a*o,t[1]=a*s-n*c,t[2]=n*o-i*s,t}function X7e(t,e,r,n){const i=e[0],a=e[1],s=e[2];return t[0]=i+n*(r[0]-i),t[1]=a+n*(r[1]-a),t[2]=s+n*(r[2]-s),t}function Ure(t,e,r){const n=e[0],i=e[1],a=e[2];let s=r[3]*n+r[7]*i+r[11]*a+r[15];return s=s||1,t[0]=(r[0]*n+r[4]*i+r[8]*a+r[12])/s,t[1]=(r[1]*n+r[5]*i+r[9]*a+r[13])/s,t[2]=(r[2]*n+r[6]*i+r[10]*a+r[14])/s,t}function Y7e(t,e,r){const n=e[0],i=e[1],a=e[2];return t[0]=n*r[0]+i*r[3]+a*r[6],t[1]=n*r[1]+i*r[4]+a*r[7],t[2]=n*r[2]+i*r[5]+a*r[8],t}function Z7e(t,e,r){const n=r[0],i=r[1],a=r[2],s=r[3],o=e[0],c=e[1],f=e[2];let d=i*f-a*c,m=a*o-n*f,b=n*c-i*o,x=i*b-a*m,E=a*d-n*b,T=n*m-i*d;const A=s*2;return d*=A,m*=A,b*=A,x*=2,E*=2,T*=2,t[0]=o+d+x,t[1]=c+m+E,t[2]=f+b+T,t}function K7e(t,e,r,n){const i=[],a=[];return i[0]=e[0]-r[0],i[1]=e[1]-r[1],i[2]=e[2]-r[2],a[0]=i[0],a[1]=i[1]*Math.cos(n)-i[2]*Math.sin(n),a[2]=i[1]*Math.sin(n)+i[2]*Math.cos(n),t[0]=a[0]+r[0],t[1]=a[1]+r[1],t[2]=a[2]+r[2],t}function J7e(t,e,r,n){const i=[],a=[];return i[0]=e[0]-r[0],i[1]=e[1]-r[1],i[2]=e[2]-r[2],a[0]=i[2]*Math.sin(n)+i[0]*Math.cos(n),a[1]=i[1],a[2]=i[2]*Math.cos(n)-i[0]*Math.sin(n),t[0]=a[0]+r[0],t[1]=a[1]+r[1],t[2]=a[2]+r[2],t}function Q7e(t,e,r,n){const i=[],a=[];return i[0]=e[0]-r[0],i[1]=e[1]-r[1],i[2]=e[2]-r[2],a[0]=i[0]*Math.cos(n)-i[1]*Math.sin(n),a[1]=i[0]*Math.sin(n)+i[1]*Math.cos(n),a[2]=i[2],t[0]=a[0]+r[0],t[1]=a[1]+r[1],t[2]=a[2]+r[2],t}function eje(t,e){const r=t[0],n=t[1],i=t[2],a=e[0],s=e[1],o=e[2],c=Math.sqrt((r*r+n*n+i*i)*(a*a+s*s+o*o)),f=c&&G7e(t,e)/c;return Math.acos(Math.min(Math.max(f,-1),1))}const Vre=$7e,tje=V7e,YP=q7e;(function(){const t=U7e();return function(e,r,n,i,a,s){let o,c;for(r||(r=3),n||(n=0),i?c=Math.min(i*r+n,e.length):c=e.length,o=n;o<c;o+=r)t[0]=e[o],t[1]=e[o+1],t[2]=e[o+2],a(t,t,s),e[o]=t[0],e[o+1]=t[1],e[o+2]=t[2];return e}})();const ZP=[0,0,0];let Kw;class Ad extends N7e{static get ZERO(){return Kw||(Kw=new Ad(0,0,0),Object.freeze(Kw)),Kw}constructor(e=0,r=0,n=0){super(-0,-0,-0),arguments.length===1&&a_(e)?this.copy(e):(uf.debug&&(nf(e),nf(r),nf(n)),this[0]=e,this[1]=r,this[2]=n)}set(e,r,n){return this[0]=e,this[1]=r,this[2]=n,this.check()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this.check()}fromObject(e){return uf.debug&&(nf(e.x),nf(e.y),nf(e.z)),this[0]=e.x,this[1]=e.y,this[2]=e.z,this.check()}toObject(e){return e.x=this[0],e.y=this[1],e.z=this[2],e}get ELEMENTS(){return 3}get z(){return this[2]}set z(e){this[2]=nf(e)}angle(e){return eje(this,e)}cross(e){return W7e(this,this,e),this.check()}rotateX({radians:e,origin:r=ZP}){return K7e(this,this,r,e),this.check()}rotateY({radians:e,origin:r=ZP}){return J7e(this,this,r,e),this.check()}rotateZ({radians:e,origin:r=ZP}){return Q7e(this,this,r,e),this.check()}transform(e){return this.transformAsPoint(e)}transformAsPoint(e){return Ure(this,this,e),this.check()}transformAsVector(e){return jre(this,this,e),this.check()}transformByMatrix3(e){return Y7e(this,this,e),this.check()}transformByMatrix2(e){return j7e(this,this,e),this.check()}transformByQuaternion(e){return Z7e(this,this,e),this.check()}}class rje extends Bre{toString(){let e="[";if(uf.printRowMajor){e+="row-major:";for(let r=0;r<this.RANK;++r)for(let n=0;n<this.RANK;++n)e+=` ${this[n*this.RANK+r]}`}else{e+="column-major:";for(let r=0;r<this.ELEMENTS;++r)e+=` ${this[r]}`}return e+="]",e}getElementIndex(e,r){return r*this.RANK+e}getElement(e,r){return this[r*this.RANK+e]}setElement(e,r,n){return this[r*this.RANK+e]=nf(n),this}getColumn(e,r=new Array(this.RANK).fill(-0)){const n=e*this.RANK;for(let i=0;i<this.RANK;++i)r[i]=this[n+i];return r}setColumn(e,r){const n=e*this.RANK;for(let i=0;i<this.RANK;++i)this[n+i]=r[i];return this}}function nje(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function ije(t,e){if(t===e){const r=e[1],n=e[2],i=e[3],a=e[6],s=e[7],o=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=r,t[6]=e[9],t[7]=e[13],t[8]=n,t[9]=a,t[11]=e[14],t[12]=i,t[13]=s,t[14]=o}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15];return t}function aD(t,e){const r=e[0],n=e[1],i=e[2],a=e[3],s=e[4],o=e[5],c=e[6],f=e[7],d=e[8],m=e[9],b=e[10],x=e[11],E=e[12],T=e[13],A=e[14],M=e[15],F=r*o-n*s,N=r*c-i*s,O=r*f-a*s,U=n*c-i*o,j=n*f-a*o,H=i*f-a*c,W=d*T-m*E,X=d*A-b*E,oe=d*M-x*E,Q=m*A-b*T,G=m*M-x*T,ae=b*M-x*A;let se=F*ae-N*G+O*Q+U*oe-j*X+H*W;return se?(se=1/se,t[0]=(o*ae-c*G+f*Q)*se,t[1]=(i*G-n*ae-a*Q)*se,t[2]=(T*H-A*j+M*U)*se,t[3]=(b*j-m*H-x*U)*se,t[4]=(c*oe-s*ae-f*X)*se,t[5]=(r*ae-i*oe+a*X)*se,t[6]=(A*O-E*H-M*N)*se,t[7]=(d*H-b*O+x*N)*se,t[8]=(s*G-o*oe+f*W)*se,t[9]=(n*oe-r*G-a*W)*se,t[10]=(E*j-T*O+M*F)*se,t[11]=(m*O-d*j-x*F)*se,t[12]=(o*X-s*Q-c*W)*se,t[13]=(r*Q-n*X+i*W)*se,t[14]=(T*N-E*U-A*F)*se,t[15]=(d*U-m*N+b*F)*se,t):null}function aje(t){const e=t[0],r=t[1],n=t[2],i=t[3],a=t[4],s=t[5],o=t[6],c=t[7],f=t[8],d=t[9],m=t[10],b=t[11],x=t[12],E=t[13],T=t[14],A=t[15],M=e*s-r*a,F=e*o-n*a,N=r*o-n*s,O=f*E-d*x,U=f*T-m*x,j=d*T-m*E,H=e*j-r*U+n*O,W=a*j-s*U+o*O,X=f*N-d*F+m*M,oe=x*N-E*F+T*M;return c*H-i*W+A*X-b*oe}function Hm(t,e,r){const n=e[0],i=e[1],a=e[2],s=e[3],o=e[4],c=e[5],f=e[6],d=e[7],m=e[8],b=e[9],x=e[10],E=e[11],T=e[12],A=e[13],M=e[14],F=e[15];let N=r[0],O=r[1],U=r[2],j=r[3];return t[0]=N*n+O*o+U*m+j*T,t[1]=N*i+O*c+U*b+j*A,t[2]=N*a+O*f+U*x+j*M,t[3]=N*s+O*d+U*E+j*F,N=r[4],O=r[5],U=r[6],j=r[7],t[4]=N*n+O*o+U*m+j*T,t[5]=N*i+O*c+U*b+j*A,t[6]=N*a+O*f+U*x+j*M,t[7]=N*s+O*d+U*E+j*F,N=r[8],O=r[9],U=r[10],j=r[11],t[8]=N*n+O*o+U*m+j*T,t[9]=N*i+O*c+U*b+j*A,t[10]=N*a+O*f+U*x+j*M,t[11]=N*s+O*d+U*E+j*F,N=r[12],O=r[13],U=r[14],j=r[15],t[12]=N*n+O*o+U*m+j*T,t[13]=N*i+O*c+U*b+j*A,t[14]=N*a+O*f+U*x+j*M,t[15]=N*s+O*d+U*E+j*F,t}function bT(t,e,r){const n=r[0],i=r[1],a=r[2];let s,o,c,f,d,m,b,x,E,T,A,M;return e===t?(t[12]=e[0]*n+e[4]*i+e[8]*a+e[12],t[13]=e[1]*n+e[5]*i+e[9]*a+e[13],t[14]=e[2]*n+e[6]*i+e[10]*a+e[14],t[15]=e[3]*n+e[7]*i+e[11]*a+e[15]):(s=e[0],o=e[1],c=e[2],f=e[3],d=e[4],m=e[5],b=e[6],x=e[7],E=e[8],T=e[9],A=e[10],M=e[11],t[0]=s,t[1]=o,t[2]=c,t[3]=f,t[4]=d,t[5]=m,t[6]=b,t[7]=x,t[8]=E,t[9]=T,t[10]=A,t[11]=M,t[12]=s*n+d*i+E*a+e[12],t[13]=o*n+m*i+T*a+e[13],t[14]=c*n+b*i+A*a+e[14],t[15]=f*n+x*i+M*a+e[15]),t}function s6(t,e,r){const n=r[0],i=r[1],a=r[2];return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*i,t[5]=e[5]*i,t[6]=e[6]*i,t[7]=e[7]*i,t[8]=e[8]*a,t[9]=e[9]*a,t[10]=e[10]*a,t[11]=e[11]*a,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function oje(t,e,r,n){let i=n[0],a=n[1],s=n[2],o=Math.sqrt(i*i+a*a+s*s),c,f,d,m,b,x,E,T,A,M,F,N,O,U,j,H,W,X,oe,Q,G,ae,se,fe;return o<OS?null:(o=1/o,i*=o,a*=o,s*=o,f=Math.sin(r),c=Math.cos(r),d=1-c,m=e[0],b=e[1],x=e[2],E=e[3],T=e[4],A=e[5],M=e[6],F=e[7],N=e[8],O=e[9],U=e[10],j=e[11],H=i*i*d+c,W=a*i*d+s*f,X=s*i*d-a*f,oe=i*a*d-s*f,Q=a*a*d+c,G=s*a*d+i*f,ae=i*s*d+a*f,se=a*s*d-i*f,fe=s*s*d+c,t[0]=m*H+T*W+N*X,t[1]=b*H+A*W+O*X,t[2]=x*H+M*W+U*X,t[3]=E*H+F*W+j*X,t[4]=m*oe+T*Q+N*G,t[5]=b*oe+A*Q+O*G,t[6]=x*oe+M*Q+U*G,t[7]=E*oe+F*Q+j*G,t[8]=m*ae+T*se+N*fe,t[9]=b*ae+A*se+O*fe,t[10]=x*ae+M*se+U*fe,t[11]=E*ae+F*se+j*fe,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t)}function $re(t,e,r){const n=Math.sin(r),i=Math.cos(r),a=e[4],s=e[5],o=e[6],c=e[7],f=e[8],d=e[9],m=e[10],b=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=a*i+f*n,t[5]=s*i+d*n,t[6]=o*i+m*n,t[7]=c*i+b*n,t[8]=f*i-a*n,t[9]=d*i-s*n,t[10]=m*i-o*n,t[11]=b*i-c*n,t}function sje(t,e,r){const n=Math.sin(r),i=Math.cos(r),a=e[0],s=e[1],o=e[2],c=e[3],f=e[8],d=e[9],m=e[10],b=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=a*i-f*n,t[1]=s*i-d*n,t[2]=o*i-m*n,t[3]=c*i-b*n,t[8]=a*n+f*i,t[9]=s*n+d*i,t[10]=o*n+m*i,t[11]=c*n+b*i,t}function qre(t,e,r){const n=Math.sin(r),i=Math.cos(r),a=e[0],s=e[1],o=e[2],c=e[3],f=e[4],d=e[5],m=e[6],b=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=a*i+f*n,t[1]=s*i+d*n,t[2]=o*i+m*n,t[3]=c*i+b*n,t[4]=f*i-a*n,t[5]=d*i-s*n,t[6]=m*i-o*n,t[7]=b*i-c*n,t}function QWe(t,e){const r=e[0],n=e[1],i=e[2],a=e[4],s=e[5],o=e[6],c=e[8],f=e[9],d=e[10];return t[0]=Math.sqrt(r*r+n*n+i*i),t[1]=Math.sqrt(a*a+s*s+o*o),t[2]=Math.sqrt(c*c+f*f+d*d),t}function lje(t,e){const r=e[0],n=e[1],i=e[2],a=e[3],s=r+r,o=n+n,c=i+i,f=r*s,d=n*s,m=n*o,b=i*s,x=i*o,E=i*c,T=a*s,A=a*o,M=a*c;return t[0]=1-m-E,t[1]=d+M,t[2]=b-A,t[3]=0,t[4]=d-M,t[5]=1-f-E,t[6]=x+T,t[7]=0,t[8]=b+A,t[9]=x-T,t[10]=1-f-m,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function uje(t,e,r,n,i,a,s){const o=1/(r-e),c=1/(i-n),f=1/(a-s);return t[0]=a*2*o,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=a*2*c,t[6]=0,t[7]=0,t[8]=(r+e)*o,t[9]=(i+n)*c,t[10]=(s+a)*f,t[11]=-1,t[12]=0,t[13]=0,t[14]=s*a*2*f,t[15]=0,t}function cje(t,e,r,n,i){const a=1/Math.tan(e/2);if(t[0]=a/r,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=a,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,i!=null&&i!==1/0){const s=1/(n-i);t[10]=(i+n)*s,t[14]=2*i*n*s}else t[10]=-1,t[14]=-2*n;return t}const fje=cje;function hje(t,e,r,n,i,a,s){const o=1/(e-r),c=1/(n-i),f=1/(a-s);return t[0]=-2*o,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*c,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*f,t[11]=0,t[12]=(e+r)*o,t[13]=(i+n)*c,t[14]=(s+a)*f,t[15]=1,t}const dje=hje;function pje(t,e,r,n){let i,a,s,o,c,f,d,m,b,x;const E=e[0],T=e[1],A=e[2],M=n[0],F=n[1],N=n[2],O=r[0],U=r[1],j=r[2];return Math.abs(E-O)<OS&&Math.abs(T-U)<OS&&Math.abs(A-j)<OS?nje(t):(m=E-O,b=T-U,x=A-j,i=1/Math.sqrt(m*m+b*b+x*x),m*=i,b*=i,x*=i,a=F*x-N*b,s=N*m-M*x,o=M*b-F*m,i=Math.sqrt(a*a+s*s+o*o),i?(i=1/i,a*=i,s*=i,o*=i):(a=0,s=0,o=0),c=b*o-x*s,f=x*a-m*o,d=m*s-b*a,i=Math.sqrt(c*c+f*f+d*d),i?(i=1/i,c*=i,f*=i,d*=i):(c=0,f=0,d=0),t[0]=a,t[1]=c,t[2]=m,t[3]=0,t[4]=s,t[5]=f,t[6]=b,t[7]=0,t[8]=o,t[9]=d,t[10]=x,t[11]=0,t[12]=-(a*E+s*T+o*A),t[13]=-(c*E+f*T+d*A),t[14]=-(m*E+b*T+x*A),t[15]=1,t)}function gje(){const t=new my(4);return my!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[3]=0),t}function eXe(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t[3]=e[3]+r[3],t}function Hre(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t}function tXe(t){const e=t[0],r=t[1],n=t[2],i=t[3];return Math.sqrt(e*e+r*r+n*n+i*i)}function rXe(t){const e=t[0],r=t[1],n=t[2],i=t[3];return e*e+r*r+n*n+i*i}function nXe(t,e){const r=e[0],n=e[1],i=e[2],a=e[3];let s=r*r+n*n+i*i+a*a;return s>0&&(s=1/Math.sqrt(s)),t[0]=r*s,t[1]=n*s,t[2]=i*s,t[3]=a*s,t}function iXe(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]}function aXe(t,e,r,n){const i=e[0],a=e[1],s=e[2],o=e[3];return t[0]=i+n*(r[0]-i),t[1]=a+n*(r[1]-a),t[2]=s+n*(r[2]-s),t[3]=o+n*(r[3]-o),t}function I_(t,e,r){const n=e[0],i=e[1],a=e[2],s=e[3];return t[0]=r[0]*n+r[4]*i+r[8]*a+r[12]*s,t[1]=r[1]*n+r[5]*i+r[9]*a+r[13]*s,t[2]=r[2]*n+r[6]*i+r[10]*a+r[14]*s,t[3]=r[3]*n+r[7]*i+r[11]*a+r[15]*s,t}function oXe(t,e,r){const n=e[0],i=e[1],a=e[2],s=r[0],o=r[1],c=r[2],f=r[3],d=f*n+o*a-c*i,m=f*i+c*n-s*a,b=f*a+s*i-o*n,x=-s*n-o*i-c*a;return t[0]=d*f+x*-s+m*-c-b*-o,t[1]=m*f+x*-o+b*-s-d*-c,t[2]=b*f+x*-c+d*-o-m*-s,t[3]=e[3],t}(function(){const t=gje();return function(e,r,n,i,a,s){let o,c;for(r||(r=4),n||(n=0),i?c=Math.min(i*r+n,e.length):c=e.length,o=n;o<c;o+=r)t[0]=e[o],t[1]=e[o+1],t[2]=e[o+2],t[3]=e[o+3],a(t,t,s),e[o]=t[0],e[o+1]=t[1],e[o+2]=t[2],e[o+3]=t[3];return e}})();var oD;(function(t){t[t.COL0ROW0=0]="COL0ROW0",t[t.COL0ROW1=1]="COL0ROW1",t[t.COL0ROW2=2]="COL0ROW2",t[t.COL0ROW3=3]="COL0ROW3",t[t.COL1ROW0=4]="COL1ROW0",t[t.COL1ROW1=5]="COL1ROW1",t[t.COL1ROW2=6]="COL1ROW2",t[t.COL1ROW3=7]="COL1ROW3",t[t.COL2ROW0=8]="COL2ROW0",t[t.COL2ROW1=9]="COL2ROW1",t[t.COL2ROW2=10]="COL2ROW2",t[t.COL2ROW3=11]="COL2ROW3",t[t.COL3ROW0=12]="COL3ROW0",t[t.COL3ROW1=13]="COL3ROW1",t[t.COL3ROW2=14]="COL3ROW2",t[t.COL3ROW3=15]="COL3ROW3"})(oD||(oD={}));const mje=45*Math.PI/180,yje=1,KP=.1,JP=500,vje=Object.freeze([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]);class Rh extends rje{static get IDENTITY(){return bje()}static get ZERO(){return _je()}get ELEMENTS(){return 16}get RANK(){return 4}get INDICES(){return oD}constructor(e){super(-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0),arguments.length===1&&Array.isArray(e)?this.copy(e):this.identity()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this[3]=e[3],this[4]=e[4],this[5]=e[5],this[6]=e[6],this[7]=e[7],this[8]=e[8],this[9]=e[9],this[10]=e[10],this[11]=e[11],this[12]=e[12],this[13]=e[13],this[14]=e[14],this[15]=e[15],this.check()}set(e,r,n,i,a,s,o,c,f,d,m,b,x,E,T,A){return this[0]=e,this[1]=r,this[2]=n,this[3]=i,this[4]=a,this[5]=s,this[6]=o,this[7]=c,this[8]=f,this[9]=d,this[10]=m,this[11]=b,this[12]=x,this[13]=E,this[14]=T,this[15]=A,this.check()}setRowMajor(e,r,n,i,a,s,o,c,f,d,m,b,x,E,T,A){return this[0]=e,this[1]=a,this[2]=f,this[3]=x,this[4]=r,this[5]=s,this[6]=d,this[7]=E,this[8]=n,this[9]=o,this[10]=m,this[11]=T,this[12]=i,this[13]=c,this[14]=b,this[15]=A,this.check()}toRowMajor(e){return e[0]=this[0],e[1]=this[4],e[2]=this[8],e[3]=this[12],e[4]=this[1],e[5]=this[5],e[6]=this[9],e[7]=this[13],e[8]=this[2],e[9]=this[6],e[10]=this[10],e[11]=this[14],e[12]=this[3],e[13]=this[7],e[14]=this[11],e[15]=this[15],e}identity(){return this.copy(vje)}fromObject(e){return this.check()}fromQuaternion(e){return lje(this,e),this.check()}frustum(e){const{left:r,right:n,bottom:i,top:a,near:s=KP,far:o=JP}=e;return o===1/0?xje(this,r,n,i,a,s):uje(this,r,n,i,a,s,o),this.check()}lookAt(e){const{eye:r,center:n=[0,0,0],up:i=[0,1,0]}=e;return pje(this,r,n,i),this.check()}ortho(e){const{left:r,right:n,bottom:i,top:a,near:s=KP,far:o=JP}=e;return dje(this,r,n,i,a,s,o),this.check()}orthographic(e){const{fovy:r=mje,aspect:n=yje,focalDistance:i=1,near:a=KP,far:s=JP}=e;RG(r);const o=r/2,c=i*Math.tan(o),f=c*n;return this.ortho({left:-f,right:f,bottom:-c,top:c,near:a,far:s})}perspective(e){const{fovy:r=45*Math.PI/180,aspect:n=1,near:i=.1,far:a=500}=e;return RG(r),fje(this,r,n,i,a),this.check()}determinant(){return aje(this)}getScale(e=[-0,-0,-0]){return e[0]=Math.sqrt(this[0]*this[0]+this[1]*this[1]+this[2]*this[2]),e[1]=Math.sqrt(this[4]*this[4]+this[5]*this[5]+this[6]*this[6]),e[2]=Math.sqrt(this[8]*this[8]+this[9]*this[9]+this[10]*this[10]),e}getTranslation(e=[-0,-0,-0]){return e[0]=this[12],e[1]=this[13],e[2]=this[14],e}getRotation(e,r){e=e||[-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0],r=r||[-0,-0,-0];const n=this.getScale(r),i=1/n[0],a=1/n[1],s=1/n[2];return e[0]=this[0]*i,e[1]=this[1]*a,e[2]=this[2]*s,e[3]=0,e[4]=this[4]*i,e[5]=this[5]*a,e[6]=this[6]*s,e[7]=0,e[8]=this[8]*i,e[9]=this[9]*a,e[10]=this[10]*s,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}getRotationMatrix3(e,r){e=e||[-0,-0,-0,-0,-0,-0,-0,-0,-0],r=r||[-0,-0,-0];const n=this.getScale(r),i=1/n[0],a=1/n[1],s=1/n[2];return e[0]=this[0]*i,e[1]=this[1]*a,e[2]=this[2]*s,e[3]=this[4]*i,e[4]=this[5]*a,e[5]=this[6]*s,e[6]=this[8]*i,e[7]=this[9]*a,e[8]=this[10]*s,e}transpose(){return ije(this,this),this.check()}invert(){return aD(this,this),this.check()}multiplyLeft(e){return Hm(this,e,this),this.check()}multiplyRight(e){return Hm(this,this,e),this.check()}rotateX(e){return $re(this,this,e),this.check()}rotateY(e){return sje(this,this,e),this.check()}rotateZ(e){return qre(this,this,e),this.check()}rotateXYZ(e){return this.rotateX(e[0]).rotateY(e[1]).rotateZ(e[2])}rotateAxis(e,r){return oje(this,this,e,r),this.check()}scale(e){return s6(this,this,Array.isArray(e)?e:[e,e,e]),this.check()}translate(e){return bT(this,this,e),this.check()}transform(e,r){return e.length===4?(r=I_(r||[-0,-0,-0,-0],e,this),XP(r,4),r):this.transformAsPoint(e,r)}transformAsPoint(e,r){const{length:n}=e;let i;switch(n){case 2:i=B7e(r||[-0,-0],e,this);break;case 3:i=Ure(r||[-0,-0,-0],e,this);break;default:throw new Error("Illegal vector")}return XP(i,e.length),i}transformAsVector(e,r){let n;switch(e.length){case 2:n=z7e(r||[-0,-0],e,this);break;case 3:n=jre(r||[-0,-0,-0],e,this);break;default:throw new Error("Illegal vector")}return XP(n,e.length),n}transformPoint(e,r){return this.transformAsPoint(e,r)}transformVector(e,r){return this.transformAsPoint(e,r)}transformDirection(e,r){return this.transformAsVector(e,r)}makeRotationX(e){return this.identity().rotateX(e)}makeTranslation(e,r,n){return this.identity().translate([e,r,n])}}let Jw,Qw;function _je(){return Jw||(Jw=new Rh([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Object.freeze(Jw)),Jw}function bje(){return Qw||(Qw=new Rh,Object.freeze(Qw)),Qw}function RG(t){if(t>Math.PI*2)throw Error("expected radians")}function xje(t,e,r,n,i,a){const s=2*a/(r-e),o=2*a/(i-n),c=(r+e)/(r-e),f=(i+n)/(i-n),d=-1,m=-1,b=-2*a;return t[0]=s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=o,t[6]=0,t[7]=0,t[8]=c,t[9]=f,t[10]=d,t[11]=m,t[12]=0,t[13]=0,t[14]=b,t[15]=0,t}function Gre(t,e=[],r=0){const n=Math.fround(t),i=t-n;return e[r]=n,e[r+1]=i,e}function wje(t){return t-Math.fround(t)}function Sje(t){const e=new Float32Array(32);for(let r=0;r<4;++r)for(let n=0;n<4;++n){const i=r*4+n;Gre(t[n*4+r],e,i*2)}return e}const Eje=`#ifdef LUMA_FP32_TAN_PRECISION_WORKAROUND

// All these functions are for substituting tan() function from Intel GPU only
const float TWO_PI = 6.2831854820251465;
const float PI_2 = 1.5707963705062866;
const float PI_16 = 0.1963495463132858;

const float SIN_TABLE_0 = 0.19509032368659973;
const float SIN_TABLE_1 = 0.3826834261417389;
const float SIN_TABLE_2 = 0.5555702447891235;
const float SIN_TABLE_3 = 0.7071067690849304;

const float COS_TABLE_0 = 0.9807852506637573;
const float COS_TABLE_1 = 0.9238795042037964;
const float COS_TABLE_2 = 0.8314695954322815;
const float COS_TABLE_3 = 0.7071067690849304;

const float INVERSE_FACTORIAL_3 = 1.666666716337204e-01; // 1/3!
const float INVERSE_FACTORIAL_5 = 8.333333767950535e-03; // 1/5!
const float INVERSE_FACTORIAL_7 = 1.9841270113829523e-04; // 1/7!
const float INVERSE_FACTORIAL_9 = 2.75573188446287533e-06; // 1/9!

float sin_taylor_fp32(float a) {
  float r, s, t, x;

  if (a == 0.0) {
    return 0.0;
  }

  x = -a * a;
  s = a;
  r = a;

  r = r * x;
  t = r * INVERSE_FACTORIAL_3;
  s = s + t;

  r = r * x;
  t = r * INVERSE_FACTORIAL_5;
  s = s + t;

  r = r * x;
  t = r * INVERSE_FACTORIAL_7;
  s = s + t;

  r = r * x;
  t = r * INVERSE_FACTORIAL_9;
  s = s + t;

  return s;
}

void sincos_taylor_fp32(float a, out float sin_t, out float cos_t) {
  if (a == 0.0) {
    sin_t = 0.0;
    cos_t = 1.0;
  }
  sin_t = sin_taylor_fp32(a);
  cos_t = sqrt(1.0 - sin_t * sin_t);
}

float tan_taylor_fp32(float a) {
    float sin_a;
    float cos_a;

    if (a == 0.0) {
        return 0.0;
    }

    // 2pi range reduction
    float z = floor(a / TWO_PI);
    float r = a - TWO_PI * z;

    float t;
    float q = floor(r / PI_2 + 0.5);
    int j = int(q);

    if (j < -2 || j > 2) {
        return 1.0 / 0.0;
    }

    t = r - PI_2 * q;

    q = floor(t / PI_16 + 0.5);
    int k = int(q);
    int abs_k = int(abs(float(k)));

    if (abs_k > 4) {
        return 1.0 / 0.0;
    } else {
        t = t - PI_16 * q;
    }

    float u = 0.0;
    float v = 0.0;

    float sin_t, cos_t;
    float s, c;
    sincos_taylor_fp32(t, sin_t, cos_t);

    if (k == 0) {
        s = sin_t;
        c = cos_t;
    } else {
        if (abs(float(abs_k) - 1.0) < 0.5) {
            u = COS_TABLE_0;
            v = SIN_TABLE_0;
        } else if (abs(float(abs_k) - 2.0) < 0.5) {
            u = COS_TABLE_1;
            v = SIN_TABLE_1;
        } else if (abs(float(abs_k) - 3.0) < 0.5) {
            u = COS_TABLE_2;
            v = SIN_TABLE_2;
        } else if (abs(float(abs_k) - 4.0) < 0.5) {
            u = COS_TABLE_3;
            v = SIN_TABLE_3;
        }
        if (k > 0) {
            s = u * sin_t + v * cos_t;
            c = u * cos_t - v * sin_t;
        } else {
            s = u * sin_t - v * cos_t;
            c = u * cos_t + v * sin_t;
        }
    }

    if (j == 0) {
        sin_a = s;
        cos_a = c;
    } else if (j == 1) {
        sin_a = c;
        cos_a = -s;
    } else if (j == -1) {
        sin_a = -c;
        cos_a = s;
    } else {
        sin_a = -s;
        cos_a = -c;
    }
    return sin_a / cos_a;
}
#endif

float tan_fp32(float a) {
#ifdef LUMA_FP32_TAN_PRECISION_WORKAROUND
  return tan_taylor_fp32(a);
#else
  return tan(a);
#endif
}
`,Tje={name:"fp32",vs:Eje},Cje=`
uniform fp64arithmeticUniforms {
  uniform float ONE;
} fp64;

/*
About LUMA_FP64_CODE_ELIMINATION_WORKAROUND

The purpose of this workaround is to prevent shader compilers from
optimizing away necessary arithmetic operations by swapping their sequences
or transform the equation to some 'equivalent' form.

The method is to multiply an artifical variable, ONE, which will be known to
the compiler to be 1 only at runtime. The whole expression is then represented
as a polynomial with respective to ONE. In the coefficients of all terms, only one a
and one b should appear

err = (a + b) * ONE^6 - a * ONE^5 - (a + b) * ONE^4 + a * ONE^3 - b - (a + b) * ONE^2 + a * ONE
*/

// Divide float number to high and low floats to extend fraction bits
vec2 split(float a) {
  const float SPLIT = 4097.0;
  float t = a * SPLIT;
#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)
  float a_hi = t * fp64.ONE - (t - a);
  float a_lo = a * fp64.ONE - a_hi;
#else
  float a_hi = t - (t - a);
  float a_lo = a - a_hi;
#endif
  return vec2(a_hi, a_lo);
}

// Divide float number again when high float uses too many fraction bits
vec2 split2(vec2 a) {
  vec2 b = split(a.x);
  b.y += a.y;
  return b;
}

// Special sum operation when a > b
vec2 quickTwoSum(float a, float b) {
#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)
  float sum = (a + b) * fp64.ONE;
  float err = b - (sum - a) * fp64.ONE;
#else
  float sum = a + b;
  float err = b - (sum - a);
#endif
  return vec2(sum, err);
}

// General sum operation
vec2 twoSum(float a, float b) {
  float s = (a + b);
#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)
  float v = (s * fp64.ONE - a) * fp64.ONE;
  float err = (a - (s - v) * fp64.ONE) * fp64.ONE * fp64.ONE * fp64.ONE + (b - v);
#else
  float v = s - a;
  float err = (a - (s - v)) + (b - v);
#endif
  return vec2(s, err);
}

vec2 twoSub(float a, float b) {
  float s = (a - b);
#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)
  float v = (s * fp64.ONE - a) * fp64.ONE;
  float err = (a - (s - v) * fp64.ONE) * fp64.ONE * fp64.ONE * fp64.ONE - (b + v);
#else
  float v = s - a;
  float err = (a - (s - v)) - (b + v);
#endif
  return vec2(s, err);
}

vec2 twoSqr(float a) {
  float prod = a * a;
  vec2 a_fp64 = split(a);
#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)
  float err = ((a_fp64.x * a_fp64.x - prod) * fp64.ONE + 2.0 * a_fp64.x *
    a_fp64.y * fp64.ONE * fp64.ONE) + a_fp64.y * a_fp64.y * fp64.ONE * fp64.ONE * fp64.ONE;
#else
  float err = ((a_fp64.x * a_fp64.x - prod) + 2.0 * a_fp64.x * a_fp64.y) + a_fp64.y * a_fp64.y;
#endif
  return vec2(prod, err);
}

vec2 twoProd(float a, float b) {
  float prod = a * b;
  vec2 a_fp64 = split(a);
  vec2 b_fp64 = split(b);
  float err = ((a_fp64.x * b_fp64.x - prod) + a_fp64.x * b_fp64.y +
    a_fp64.y * b_fp64.x) + a_fp64.y * b_fp64.y;
  return vec2(prod, err);
}

vec2 sum_fp64(vec2 a, vec2 b) {
  vec2 s, t;
  s = twoSum(a.x, b.x);
  t = twoSum(a.y, b.y);
  s.y += t.x;
  s = quickTwoSum(s.x, s.y);
  s.y += t.y;
  s = quickTwoSum(s.x, s.y);
  return s;
}

vec2 sub_fp64(vec2 a, vec2 b) {
  vec2 s, t;
  s = twoSub(a.x, b.x);
  t = twoSub(a.y, b.y);
  s.y += t.x;
  s = quickTwoSum(s.x, s.y);
  s.y += t.y;
  s = quickTwoSum(s.x, s.y);
  return s;
}

vec2 mul_fp64(vec2 a, vec2 b) {
  vec2 prod = twoProd(a.x, b.x);
  // y component is for the error
  prod.y += a.x * b.y;
#if defined(LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND)
  prod = split2(prod);
#endif
  prod = quickTwoSum(prod.x, prod.y);
  prod.y += a.y * b.x;
#if defined(LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND)
  prod = split2(prod);
#endif
  prod = quickTwoSum(prod.x, prod.y);
  return prod;
}

vec2 div_fp64(vec2 a, vec2 b) {
  float xn = 1.0 / b.x;
#if defined(LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND)
  vec2 yn = mul_fp64(a, vec2(xn, 0));
#else
  vec2 yn = a * xn;
#endif
  float diff = (sub_fp64(a, mul_fp64(b, yn))).x;
  vec2 prod = twoProd(xn, diff);
  return sum_fp64(yn, prod);
}

vec2 sqrt_fp64(vec2 a) {
  if (a.x == 0.0 && a.y == 0.0) return vec2(0.0, 0.0);
  if (a.x < 0.0) return vec2(0.0 / 0.0, 0.0 / 0.0);

  float x = 1.0 / sqrt(a.x);
  float yn = a.x * x;
#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)
  vec2 yn_sqr = twoSqr(yn) * fp64.ONE;
#else
  vec2 yn_sqr = twoSqr(yn);
#endif
  float diff = sub_fp64(a, yn_sqr).x;
  vec2 prod = twoProd(x * 0.5, diff);
#if defined(LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND)
  return sum_fp64(split(yn), prod);
#else
  return sum_fp64(vec2(yn, 0.0), prod);
#endif
}
`,Aje={ONE:1},Ije={name:"fp64arithmetic",vs:Cje,defaultUniforms:Aje,uniformTypes:{ONE:"f32"},fp64ify:Gre,fp64LowPart:wje,fp64ifyMatrix4:Sje},Pje=[0,1,1,1],kje=`uniform pickingUniforms {
  float isActive;
  float isAttribute;
  float isHighlightActive;
  float useFloatColors;
  vec3 highlightedObjectColor;
  vec4 highlightColor;
} picking;

out vec4 picking_vRGBcolor_Avalid;

// Normalize unsigned byte color to 0-1 range
vec3 picking_normalizeColor(vec3 color) {
  return picking.useFloatColors > 0.5 ? color : color / 255.0;
}

// Normalize unsigned byte color to 0-1 range
vec4 picking_normalizeColor(vec4 color) {
  return picking.useFloatColors > 0.5 ? color : color / 255.0;
}

bool picking_isColorZero(vec3 color) {
  return dot(color, vec3(1.0)) < 0.00001;
}

bool picking_isColorValid(vec3 color) {
  return dot(color, vec3(1.0)) > 0.00001;
}

// Check if this vertex is highlighted 
bool isVertexHighlighted(vec3 vertexColor) {
  vec3 highlightedObjectColor = picking_normalizeColor(picking.highlightedObjectColor);
  return
    bool(picking.isHighlightActive) && picking_isColorZero(abs(vertexColor - highlightedObjectColor));
}

// Set the current picking color
void picking_setPickingColor(vec3 pickingColor) {
  pickingColor = picking_normalizeColor(pickingColor);

  if (bool(picking.isActive)) {
    // Use alpha as the validity flag. If pickingColor is [0, 0, 0] fragment is non-pickable
    picking_vRGBcolor_Avalid.a = float(picking_isColorValid(pickingColor));

    if (!bool(picking.isAttribute)) {
      // Stores the picking color so that the fragment shader can render it during picking
      picking_vRGBcolor_Avalid.rgb = pickingColor;
    }
  } else {
    // Do the comparison with selected item color in vertex shader as it should mean fewer compares
    picking_vRGBcolor_Avalid.a = float(isVertexHighlighted(pickingColor));
  }
}

void picking_setPickingAttribute(float value) {
  if (bool(picking.isAttribute)) {
    picking_vRGBcolor_Avalid.r = value;
  }
}

void picking_setPickingAttribute(vec2 value) {
  if (bool(picking.isAttribute)) {
    picking_vRGBcolor_Avalid.rg = value;
  }
}

void picking_setPickingAttribute(vec3 value) {
  if (bool(picking.isAttribute)) {
    picking_vRGBcolor_Avalid.rgb = value;
  }
}
`,Rje=`uniform pickingUniforms {
  float isActive;
  float isAttribute;
  float isHighlightActive;
  float useFloatColors;
  vec3 highlightedObjectColor;
  vec4 highlightColor;
} picking;

in vec4 picking_vRGBcolor_Avalid;

/*
 * Returns highlight color if this item is selected.
 */
vec4 picking_filterHighlightColor(vec4 color) {
  // If we are still picking, we don't highlight
  if (picking.isActive > 0.5) {
    return color;
  }

  bool selected = bool(picking_vRGBcolor_Avalid.a);

  if (selected) {
    // Blend in highlight color based on its alpha value
    float highLightAlpha = picking.highlightColor.a;
    float blendedAlpha = highLightAlpha + color.a * (1.0 - highLightAlpha);
    float highLightRatio = highLightAlpha / blendedAlpha;

    vec3 blendedRGB = mix(color.rgb, picking.highlightColor.rgb, highLightRatio);
    return vec4(blendedRGB, blendedAlpha);
  } else {
    return color;
  }
}

/*
 * Returns picking color if picking enabled else unmodified argument.
 */
vec4 picking_filterPickingColor(vec4 color) {
  if (bool(picking.isActive)) {
    if (picking_vRGBcolor_Avalid.a == 0.0) {
      discard;
    }
    return picking_vRGBcolor_Avalid;
  }
  return color;
}

/*
 * Returns picking color if picking is enabled if not
 * highlight color if this item is selected, otherwise unmodified argument.
 */
vec4 picking_filterColor(vec4 color) {
  vec4 highlightColor = picking_filterHighlightColor(color);
  return picking_filterPickingColor(highlightColor);
}
`,MG={props:{},uniforms:{},name:"picking",uniformTypes:{isActive:"f32",isAttribute:"f32",isHighlightActive:"f32",useFloatColors:"f32",highlightedObjectColor:"vec3<f32>",highlightColor:"vec4<f32>"},defaultUniforms:{isActive:!1,isAttribute:!1,isHighlightActive:!1,useFloatColors:!0,highlightedObjectColor:[0,0,0],highlightColor:Pje},vs:kje,fs:Rje,getUniforms:Mje};function Mje(t={},e){const r={};if(t.highlightedObjectColor!==void 0)if(t.highlightedObjectColor===null)r.isHighlightActive=!1;else{r.isHighlightActive=!0;const n=t.highlightedObjectColor.slice(0,3);r.highlightedObjectColor=n}if(t.highlightColor){const n=Array.from(t.highlightColor,i=>i/255);Number.isFinite(n[3])||(n[3]=1),r.highlightColor=n}return t.isActive!==void 0&&(r.isActive=!!t.isActive,r.isAttribute=!!t.isAttribute),t.useFloatColors!==void 0&&(r.useFloatColors=!!t.useFloatColors),r}const DG=`uniform layerUniforms {
  uniform float opacity;
} layer;
`,Dje={name:"layer",vs:DG,fs:DG,getUniforms:t=>({opacity:Math.pow(t.opacity,1/2.2)}),uniformTypes:{opacity:"f32"}},Oje=`const SMOOTH_EDGE_RADIUS: f32 = 0.5;

struct VertexGeometry {
  position: vec4<f32>,
  worldPosition: vec3<f32>,
  worldPositionAlt: vec3<f32>,
  normal: vec3<f32>,
  uv: vec2<f32>,
  pickingColor: vec3<f32>,
};

var<private> geometry_: VertexGeometry = VertexGeometry(
  vec4<f32>(0.0, 0.0, 1.0, 0.0),
  vec3<f32>(0.0, 0.0, 0.0),
  vec3<f32>(0.0, 0.0, 0.0),
  vec3<f32>(0.0, 0.0, 0.0),
  vec2<f32>(0.0, 0.0),
  vec3<f32>(0.0, 0.0, 0.0)
);

struct FragmentGeometry {
  uv: vec2<f32>,
};

var<private> fragmentGeometry: FragmentGeometry;

fn smoothedge(edge: f32, x: f32) -> f32 {
  return smoothstep(edge - SMOOTH_EDGE_RADIUS, edge + SMOOTH_EDGE_RADIUS, x);
}
`,Wre="#define SMOOTH_EDGE_RADIUS 0.5",Nje=`${Wre}

struct VertexGeometry {
  vec4 position;
  vec3 worldPosition;
  vec3 worldPositionAlt;
  vec3 normal;
  vec2 uv;
  vec3 pickingColor;
} geometry = VertexGeometry(
  vec4(0.0, 0.0, 1.0, 0.0),
  vec3(0.0),
  vec3(0.0),
  vec3(0.0),
  vec2(0.0),
  vec3(0.0)
);
`,Lje=`${Wre}

struct FragmentGeometry {
  vec2 uv;
} geometry;

float smoothedge(float edge, float x) {
  return smoothstep(edge - SMOOTH_EDGE_RADIUS, edge + SMOOTH_EDGE_RADIUS, x);
}
`,Xre={name:"geometry",source:Oje,vs:Nje,fs:Lje},Fje=25;var Cl;(function(t){t[t.Start=1]="Start",t[t.Move=2]="Move",t[t.End=4]="End",t[t.Cancel=8]="Cancel"})(Cl||(Cl={}));var Nl;(function(t){t[t.None=0]="None",t[t.Left=1]="Left",t[t.Right=2]="Right",t[t.Up=4]="Up",t[t.Down=8]="Down",t[t.Horizontal=3]="Horizontal",t[t.Vertical=12]="Vertical",t[t.All=15]="All"})(Nl||(Nl={}));var Gi;(function(t){t[t.Possible=1]="Possible",t[t.Began=2]="Began",t[t.Changed=4]="Changed",t[t.Ended=8]="Ended",t[t.Recognized=8]="Recognized",t[t.Cancelled=16]="Cancelled",t[t.Failed=32]="Failed"})(Gi||(Gi={}));const Bje="compute",zje="auto",sD="manipulation",NS="none",lD="pan-x",uD="pan-y";function jje(t){if(t.includes(NS))return NS;const e=t.includes(lD),r=t.includes(uD);return e&&r?NS:e||r?e?lD:uD:t.includes(sD)?sD:zje}class Uje{constructor(e,r){this.actions="",this.manager=e,this.set(r)}set(e){e===Bje&&(e=this.compute()),this.manager.element&&(this.manager.element.style.touchAction=e,this.actions=e)}update(){this.set(this.manager.options.touchAction)}compute(){let e=[];for(const r of this.manager.recognizers)r.options.enable&&(e=e.concat(r.getTouchAction()));return jje(e.join(" "))}}function xT(t){return t.trim().split(/\s+/g)}function QP(t,e,r){if(t)for(const n of xT(e))t.addEventListener(n,r,!1)}function ek(t,e,r){if(t)for(const n of xT(e))t.removeEventListener(n,r,!1)}function OG(t){return(t.ownerDocument||t).defaultView}function Vje(t,e){let r=t;for(;r;){if(r===e)return!0;r=r.parentNode}return!1}function Yre(t){const e=t.length;if(e===1)return{x:Math.round(t[0].clientX),y:Math.round(t[0].clientY)};let r=0,n=0,i=0;for(;i<e;)r+=t[i].clientX,n+=t[i].clientY,i++;return{x:Math.round(r/e),y:Math.round(n/e)}}function NG(t){const e=[];let r=0;for(;r<t.pointers.length;)e[r]={clientX:Math.round(t.pointers[r].clientX),clientY:Math.round(t.pointers[r].clientY)},r++;return{timeStamp:Date.now(),pointers:e,center:Yre(e),deltaX:t.deltaX,deltaY:t.deltaY}}function Zre(t,e){const r=e.x-t.x,n=e.y-t.y;return Math.sqrt(r*r+n*n)}function LG(t,e){const r=e.clientX-t.clientX,n=e.clientY-t.clientY;return Math.sqrt(r*r+n*n)}function $je(t,e){const r=e.x-t.x,n=e.y-t.y;return Math.atan2(n,r)*180/Math.PI}function FG(t,e){const r=e.clientX-t.clientX,n=e.clientY-t.clientY;return Math.atan2(n,r)*180/Math.PI}function Kre(t,e){return t===e?Nl.None:Math.abs(t)>=Math.abs(e)?t<0?Nl.Left:Nl.Right:e<0?Nl.Up:Nl.Down}function qje(t,e){const r=e.center;let n=t.offsetDelta,i=t.prevDelta;const a=t.prevInput;return(e.eventType===Cl.Start||a?.eventType===Cl.End)&&(i=t.prevDelta={x:a?.deltaX||0,y:a?.deltaY||0},n=t.offsetDelta={x:r.x,y:r.y}),{deltaX:i.x+(r.x-n.x),deltaY:i.y+(r.y-n.y)}}function Jre(t,e,r){return{x:e/t||0,y:r/t||0}}function Hje(t,e){return LG(e[0],e[1])/LG(t[0],t[1])}function Gje(t,e){return FG(e[1],e[0])-FG(t[1],t[0])}function Wje(t,e){const r=t.lastInterval||e,n=e.timeStamp-r.timeStamp;let i,a,s,o;if(e.eventType!==Cl.Cancel&&(n>Fje||r.velocity===void 0)){const c=e.deltaX-r.deltaX,f=e.deltaY-r.deltaY,d=Jre(n,c,f);a=d.x,s=d.y,i=Math.abs(d.x)>Math.abs(d.y)?d.x:d.y,o=Kre(c,f),t.lastInterval=e}else i=r.velocity,a=r.velocityX,s=r.velocityY,o=r.direction;e.velocity=i,e.velocityX=a,e.velocityY=s,e.direction=o}function Xje(t,e){const{session:r}=t,{pointers:n}=e,{length:i}=n;r.firstInput||(r.firstInput=NG(e)),i>1&&!r.firstMultiple?r.firstMultiple=NG(e):i===1&&(r.firstMultiple=!1);const{firstInput:a,firstMultiple:s}=r,o=s?s.center:a.center,c=e.center=Yre(n);e.timeStamp=Date.now(),e.deltaTime=e.timeStamp-a.timeStamp,e.angle=$je(o,c),e.distance=Zre(o,c);const{deltaX:f,deltaY:d}=qje(r,e);e.deltaX=f,e.deltaY=d,e.offsetDirection=Kre(e.deltaX,e.deltaY);const m=Jre(e.deltaTime,e.deltaX,e.deltaY);e.overallVelocityX=m.x,e.overallVelocityY=m.y,e.overallVelocity=Math.abs(m.x)>Math.abs(m.y)?m.x:m.y,e.scale=s?Hje(s.pointers,n):1,e.rotation=s?Gje(s.pointers,n):0,e.maxPointers=r.prevInput?e.pointers.length>r.prevInput.maxPointers?e.pointers.length:r.prevInput.maxPointers:e.pointers.length;let b=t.element;return Vje(e.srcEvent.target,b)&&(b=e.srcEvent.target),e.target=b,Wje(r,e),e}function Yje(t,e,r){const n=r.pointers.length,i=r.changedPointers.length,a=e&Cl.Start&&n-i===0,s=e&(Cl.End|Cl.Cancel)&&n-i===0;r.isFirst=!!a,r.isFinal=!!s,a&&(t.session={}),r.eventType=e;const o=Xje(t,r);t.emit("hammer.input",o),t.recognize(o),t.session.prevInput=o}let Zje=class{constructor(e){this.evEl="",this.evWin="",this.evTarget="",this.domHandler=r=>{this.manager.options.enable&&this.handler(r)},this.manager=e,this.element=e.element,this.target=e.options.inputTarget||e.element}callback(e,r){Yje(this.manager,e,r)}init(){QP(this.element,this.evEl,this.domHandler),QP(this.target,this.evTarget,this.domHandler),QP(OG(this.element),this.evWin,this.domHandler)}destroy(){ek(this.element,this.evEl,this.domHandler),ek(this.target,this.evTarget,this.domHandler),ek(OG(this.element),this.evWin,this.domHandler)}};const Kje={pointerdown:Cl.Start,pointermove:Cl.Move,pointerup:Cl.End,pointercancel:Cl.Cancel,pointerout:Cl.Cancel},Jje="pointerdown",Qje="pointermove pointerup pointercancel";class eUe extends Zje{constructor(e){super(e),this.evEl=Jje,this.evWin=Qje,this.store=this.manager.session.pointerEvents=[],this.init()}handler(e){const{store:r}=this;let n=!1;const i=Kje[e.type],a=e.pointerType,s=a==="touch";let o=r.findIndex(c=>c.pointerId===e.pointerId);i&Cl.Start&&(e.buttons||s)?o<0&&(r.push(e),o=r.length-1):i&(Cl.End|Cl.Cancel)&&(n=!0),!(o<0)&&(r[o]=e,this.callback(i,{pointers:r,changedPointers:[e],eventType:i,pointerType:a,srcEvent:e}),n&&r.splice(o,1))}}const tUe=["","webkit","Moz","MS","ms","o"];function rUe(t,e){const r=e[0].toUpperCase()+e.slice(1);for(const n of tUe){const i=n?n+r:e;if(i in t)return i}}const nUe=1,BG=2,zG={touchAction:"compute",enable:!0,inputTarget:null,cssProps:{userSelect:"none",userDrag:"none",touchCallout:"none",tapHighlightColor:"rgba(0,0,0,0)"}};class iUe{constructor(e,r){this.options={...zG,...r,cssProps:{...zG.cssProps,...r.cssProps},inputTarget:r.inputTarget||e},this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=e,this.input=new eUe(this),this.touchAction=new Uje(this,this.options.touchAction),this.toggleCssProps(!0)}set(e){return Object.assign(this.options,e),e.touchAction&&this.touchAction.update(),e.inputTarget&&(this.input.destroy(),this.input.target=e.inputTarget,this.input.init()),this}stop(e){this.session.stopped=e?BG:nUe}recognize(e){const{session:r}=this;if(r.stopped)return;this.session.prevented&&e.srcEvent.preventDefault();let n;const{recognizers:i}=this;let{curRecognizer:a}=r;(!a||a&&a.state&Gi.Recognized)&&(a=r.curRecognizer=null);let s=0;for(;s<i.length;)n=i[s],r.stopped!==BG&&(!a||n===a||n.canRecognizeWith(a))?n.recognize(e):n.reset(),!a&&n.state&(Gi.Began|Gi.Changed|Gi.Ended)&&(a=r.curRecognizer=n),s++}get(e){const{recognizers:r}=this;for(let n=0;n<r.length;n++)if(r[n].options.event===e)return r[n];return null}add(e){if(Array.isArray(e)){for(const n of e)this.add(n);return this}const r=this.get(e.options.event);return r&&this.remove(r),this.recognizers.push(e),e.manager=this,this.touchAction.update(),e}remove(e){if(Array.isArray(e)){for(const n of e)this.remove(n);return this}const r=typeof e=="string"?this.get(e):e;if(r){const{recognizers:n}=this,i=n.indexOf(r);i!==-1&&(n.splice(i,1),this.touchAction.update())}return this}on(e,r){if(!e||!r)return;const{handlers:n}=this;for(const i of xT(e))n[i]=n[i]||[],n[i].push(r)}off(e,r){if(!e)return;const{handlers:n}=this;for(const i of xT(e))r?n[i]&&n[i].splice(n[i].indexOf(r),1):delete n[i]}emit(e,r){const n=this.handlers[e]&&this.handlers[e].slice();if(!n||!n.length)return;const i=r;i.type=e,i.preventDefault=function(){r.srcEvent.preventDefault()};let a=0;for(;a<n.length;)n[a](i),a++}destroy(){this.toggleCssProps(!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}toggleCssProps(e){const{element:r}=this;if(r){for(const[n,i]of Object.entries(this.options.cssProps)){const a=rUe(r.style,n);e?(this.oldCssProps[a]=r.style[a],r.style[a]=i):r.style[a]=this.oldCssProps[a]||""}e||(this.oldCssProps={})}}}let aUe=1;function oUe(){return aUe++}function jG(t){return t&Gi.Cancelled?"cancel":t&Gi.Ended?"end":t&Gi.Changed?"move":t&Gi.Began?"start":""}class Qre{constructor(e){this.options=e,this.id=oUe(),this.state=Gi.Possible,this.simultaneous={},this.requireFail=[]}set(e){return Object.assign(this.options,e),this.manager.touchAction.update(),this}recognizeWith(e){if(Array.isArray(e)){for(const i of e)this.recognizeWith(i);return this}let r;if(typeof e=="string"){if(r=this.manager.get(e),!r)throw new Error(`Cannot find recognizer ${e}`)}else r=e;const{simultaneous:n}=this;return n[r.id]||(n[r.id]=r,r.recognizeWith(this)),this}dropRecognizeWith(e){if(Array.isArray(e)){for(const n of e)this.dropRecognizeWith(n);return this}let r;return typeof e=="string"?r=this.manager.get(e):r=e,r&&delete this.simultaneous[r.id],this}requireFailure(e){if(Array.isArray(e)){for(const i of e)this.requireFailure(i);return this}let r;if(typeof e=="string"){if(r=this.manager.get(e),!r)throw new Error(`Cannot find recognizer ${e}`)}else r=e;const{requireFail:n}=this;return n.indexOf(r)===-1&&(n.push(r),r.requireFailure(this)),this}dropRequireFailure(e){if(Array.isArray(e)){for(const n of e)this.dropRequireFailure(n);return this}let r;if(typeof e=="string"?r=this.manager.get(e):r=e,r){const n=this.requireFail.indexOf(r);n>-1&&this.requireFail.splice(n,1)}return this}hasRequireFailures(){return!!this.requireFail.find(e=>e.options.enable)}canRecognizeWith(e){return!!this.simultaneous[e.id]}emit(e){if(!e)return;const{state:r}=this;r<Gi.Ended&&this.manager.emit(this.options.event+jG(r),e),this.manager.emit(this.options.event,e),e.additionalEvent&&this.manager.emit(e.additionalEvent,e),r>=Gi.Ended&&this.manager.emit(this.options.event+jG(r),e)}tryEmit(e){this.canEmit()?this.emit(e):this.state=Gi.Failed}canEmit(){let e=0;for(;e<this.requireFail.length;){if(!(this.requireFail[e].state&(Gi.Failed|Gi.Possible)))return!1;e++}return!0}recognize(e){const r={...e};if(!this.options.enable){this.reset(),this.state=Gi.Failed;return}this.state&(Gi.Recognized|Gi.Cancelled|Gi.Failed)&&(this.state=Gi.Possible),this.state=this.process(r),this.state&(Gi.Began|Gi.Changed|Gi.Ended|Gi.Cancelled)&&this.tryEmit(r)}getEventNames(){return[this.options.event]}reset(){}}class ene extends Qre{attrTest(e){const r=this.options.pointers;return r===0||e.pointers.length===r}process(e){const{state:r}=this,{eventType:n}=e,i=r&(Gi.Began|Gi.Changed),a=this.attrTest(e);return i&&(n&Cl.Cancel||!a)?r|Gi.Cancelled:i||a?n&Cl.End?r|Gi.Ended:r&Gi.Began?r|Gi.Changed:Gi.Began:Gi.Failed}}class UG extends Qre{constructor(e={}){super({enable:!0,event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10,...e}),this.pTime=null,this.pCenter=null,this._timer=null,this._input=null,this.count=0}getTouchAction(){return[sD]}process(e){const{options:r}=this,n=e.pointers.length===r.pointers,i=e.distance<r.threshold,a=e.deltaTime<r.time;if(this.reset(),e.eventType&Cl.Start&&this.count===0)return this.failTimeout();if(i&&a&&n){if(e.eventType!==Cl.End)return this.failTimeout();const s=this.pTime?e.timeStamp-this.pTime<r.interval:!0,o=!this.pCenter||Zre(this.pCenter,e.center)<r.posThreshold;if(this.pTime=e.timeStamp,this.pCenter=e.center,!o||!s?this.count=1:this.count+=1,this._input=e,this.count%r.taps===0)return this.hasRequireFailures()?(this._timer=setTimeout(()=>{this.state=Gi.Recognized,this.tryEmit(this._input)},r.interval),Gi.Began):Gi.Recognized}return Gi.Failed}failTimeout(){return this._timer=setTimeout(()=>{this.state=Gi.Failed},this.options.interval),Gi.Failed}reset(){clearTimeout(this._timer)}emit(e){this.state===Gi.Recognized&&(e.tapCount=this.count,this.manager.emit(this.options.event,e))}}const sUe=["","start","move","end","cancel","up","down","left","right"];class VG extends ene{constructor(e={}){super({enable:!0,pointers:1,event:"pan",threshold:10,direction:Nl.All,...e}),this.pX=null,this.pY=null}getTouchAction(){const{options:{direction:e}}=this,r=[];return e&Nl.Horizontal&&r.push(uD),e&Nl.Vertical&&r.push(lD),r}getEventNames(){return sUe.map(e=>this.options.event+e)}directionTest(e){const{options:r}=this;let n=!0,{distance:i}=e,{direction:a}=e;const s=e.deltaX,o=e.deltaY;return a&r.direction||(r.direction&Nl.Horizontal?(a=s===0?Nl.None:s<0?Nl.Left:Nl.Right,n=s!==this.pX,i=Math.abs(e.deltaX)):(a=o===0?Nl.None:o<0?Nl.Up:Nl.Down,n=o!==this.pY,i=Math.abs(e.deltaY))),e.direction=a,n&&i>r.threshold&&!!(a&r.direction)}attrTest(e){return super.attrTest(e)&&(!!(this.state&Gi.Began)||!(this.state&Gi.Began)&&this.directionTest(e))}emit(e){this.pX=e.deltaX,this.pY=e.deltaY;const r=Nl[e.direction].toLowerCase();r&&(e.additionalEvent=this.options.event+r),super.emit(e)}}const lUe=["","start","move","end","cancel","in","out"];class uUe extends ene{constructor(e={}){super({enable:!0,event:"pinch",threshold:0,pointers:2,...e})}getTouchAction(){return[NS]}getEventNames(){return lUe.map(e=>this.options.event+e)}attrTest(e){return super.attrTest(e)&&(Math.abs(e.scale-1)>this.options.threshold||!!(this.state&Gi.Began))}emit(e){if(e.scale!==1){const r=e.scale<1?"in":"out";e.additionalEvent=this.options.event+r}super.emit(e)}}class Q3{constructor(e,r,n){this.element=e,this.callback=r,this.options=n}}const cUe=typeof navigator<"u"&&navigator.userAgent?navigator.userAgent.toLowerCase():"",fUe=cUe.indexOf("firefox")!==-1,$G=4.000244140625,hUe=40,dUe=.25;class pUe extends Q3{constructor(e,r,n){super(e,r,{enable:!0,...n}),this.handleEvent=i=>{if(!this.options.enable)return;let a=i.deltaY;globalThis.WheelEvent&&(fUe&&i.deltaMode===globalThis.WheelEvent.DOM_DELTA_PIXEL&&(a/=globalThis.devicePixelRatio),i.deltaMode===globalThis.WheelEvent.DOM_DELTA_LINE&&(a*=hUe)),a!==0&&a%$G===0&&(a=Math.floor(a/$G)),i.shiftKey&&a&&(a=a*dUe),this.callback({type:"wheel",center:{x:i.clientX,y:i.clientY},delta:-a,srcEvent:i,pointerType:"mouse",target:i.target})},e.addEventListener("wheel",this.handleEvent,{passive:!1})}destroy(){this.element.removeEventListener("wheel",this.handleEvent)}enableEventType(e,r){e==="wheel"&&(this.options.enable=r)}}const qG=["mousedown","mousemove","mouseup","mouseover","mouseout","mouseleave"];class gUe extends Q3{constructor(e,r,n){super(e,r,{enable:!0,...n}),this.handleEvent=a=>{this.handleOverEvent(a),this.handleOutEvent(a),this.handleEnterEvent(a),this.handleLeaveEvent(a),this.handleMoveEvent(a)},this.pressed=!1;const{enable:i}=this.options;this.enableMoveEvent=i,this.enableLeaveEvent=i,this.enableEnterEvent=i,this.enableOutEvent=i,this.enableOverEvent=i,qG.forEach(a=>e.addEventListener(a,this.handleEvent))}destroy(){qG.forEach(e=>this.element.removeEventListener(e,this.handleEvent))}enableEventType(e,r){switch(e){case"pointermove":this.enableMoveEvent=r;break;case"pointerover":this.enableOverEvent=r;break;case"pointerout":this.enableOutEvent=r;break;case"pointerenter":this.enableEnterEvent=r;break;case"pointerleave":this.enableLeaveEvent=r;break}}handleOverEvent(e){this.enableOverEvent&&e.type==="mouseover"&&this._emit("pointerover",e)}handleOutEvent(e){this.enableOutEvent&&e.type==="mouseout"&&this._emit("pointerout",e)}handleEnterEvent(e){this.enableEnterEvent&&e.type==="mouseenter"&&this._emit("pointerenter",e)}handleLeaveEvent(e){this.enableLeaveEvent&&e.type==="mouseleave"&&this._emit("pointerleave",e)}handleMoveEvent(e){if(this.enableMoveEvent)switch(e.type){case"mousedown":e.button>=0&&(this.pressed=!0);break;case"mousemove":e.buttons===0&&(this.pressed=!1),this.pressed||this._emit("pointermove",e);break;case"mouseup":this.pressed=!1;break}}_emit(e,r){this.callback({type:e,center:{x:r.clientX,y:r.clientY},srcEvent:r,pointerType:"mouse",target:r.target})}}const HG=["keydown","keyup"];class mUe extends Q3{constructor(e,r,n){super(e,r,{enable:!0,tabIndex:0,...n}),this.handleEvent=i=>{const a=i.target||i.srcElement;a.tagName==="INPUT"&&a.type==="text"||a.tagName==="TEXTAREA"||(this.enableDownEvent&&i.type==="keydown"&&this.callback({type:"keydown",srcEvent:i,key:i.key,target:i.target}),this.enableUpEvent&&i.type==="keyup"&&this.callback({type:"keyup",srcEvent:i,key:i.key,target:i.target}))},this.enableDownEvent=this.options.enable,this.enableUpEvent=this.options.enable,e.tabIndex=this.options.tabIndex,e.style.outline="none",HG.forEach(i=>e.addEventListener(i,this.handleEvent))}destroy(){HG.forEach(e=>this.element.removeEventListener(e,this.handleEvent))}enableEventType(e,r){e==="keydown"&&(this.enableDownEvent=r),e==="keyup"&&(this.enableUpEvent=r)}}class yUe extends Q3{constructor(e,r,n){super(e,r,n),this.handleEvent=i=>{this.options.enable&&this.callback({type:"contextmenu",center:{x:i.clientX,y:i.clientY},srcEvent:i,pointerType:"mouse",target:i.target})},e.addEventListener("contextmenu",this.handleEvent)}destroy(){this.element.removeEventListener("contextmenu",this.handleEvent)}enableEventType(e,r){e==="contextmenu"&&(this.options.enable=r)}}const GG=1,cD=2,WG=4,vUe={pointerdown:GG,pointermove:cD,pointerup:WG,mousedown:GG,mousemove:cD,mouseup:WG},_Ue=0,bUe=1,xUe=2,wUe=1,SUe=2,EUe=4;function TUe(t){const e=vUe[t.srcEvent.type];if(!e)return null;const{buttons:r,button:n}=t.srcEvent;let i=!1,a=!1,s=!1;return e===cD?(i=!!(r&wUe),a=!!(r&EUe),s=!!(r&SUe)):(i=n===_Ue,a=n===bUe,s=n===xUe),{leftButton:i,middleButton:a,rightButton:s}}function CUe(t,e){const r=t.center;if(!r)return null;const n=e.getBoundingClientRect(),i=n.width/e.offsetWidth||1,a=n.height/e.offsetHeight||1,s={x:(r.x-n.left-e.clientLeft)/i,y:(r.y-n.top-e.clientTop)/a};return{center:r,offsetCenter:s}}const AUe={srcElement:"root",priority:0};class IUe{constructor(e,r){this.handleEvent=n=>{if(this.isEmpty())return;const i=this._normalizeEvent(n);let a=n.srcEvent.target;for(;a&&a!==i.rootElement;){if(this._emit(i,a),i.handled)return;a=a.parentNode}this._emit(i,"root")},this.eventManager=e,this.recognizerName=r,this.handlers=[],this.handlersByElement=new Map,this._active=!1}isEmpty(){return!this._active}add(e,r,n,i=!1,a=!1){const{handlers:s,handlersByElement:o}=this,c={...AUe,...n};let f=o.get(c.srcElement);f||(f=[],o.set(c.srcElement,f));const d={type:e,handler:r,srcElement:c.srcElement,priority:c.priority};i&&(d.once=!0),a&&(d.passive=!0),s.push(d),this._active=this._active||!d.passive;let m=f.length-1;for(;m>=0&&!(f[m].priority>=d.priority);)m--;f.splice(m+1,0,d)}remove(e,r){const{handlers:n,handlersByElement:i}=this;for(let a=n.length-1;a>=0;a--){const s=n[a];if(s.type===e&&s.handler===r){n.splice(a,1);const o=i.get(s.srcElement);o.splice(o.indexOf(s),1),o.length===0&&i.delete(s.srcElement)}}this._active=n.some(a=>!a.passive)}_emit(e,r){const n=this.handlersByElement.get(r);if(n){let i=!1;const a=()=>{e.handled=!0},s=()=>{e.handled=!0,i=!0},o=[];for(let c=0;c<n.length;c++){const{type:f,handler:d,once:m}=n[c];if(d({...e,type:f,stopPropagation:a,stopImmediatePropagation:s}),m&&o.push(n[c]),i)break}for(let c=0;c<o.length;c++){const{type:f,handler:d}=o[c];this.remove(f,d)}}}_normalizeEvent(e){const r=this.eventManager.getElement();return{...e,...TUe(e),...CUe(e,r),preventDefault:()=>{e.srcEvent.preventDefault()},stopImmediatePropagation:null,stopPropagation:null,handled:!1,rootElement:r}}}function PUe(t){if("recognizer"in t)return t;let e;const r=Array.isArray(t)?[...t]:[t];if(typeof r[0]=="function"){const n=r.shift(),i=r.shift()||{};e=new n(i)}else e=r.shift();return{recognizer:e,recognizeWith:typeof r[0]=="string"?[r[0]]:r[0],requireFailure:typeof r[1]=="string"?[r[1]]:r[1]}}class kUe{constructor(e=null,r={}){if(this._onBasicInput=n=>{this.manager.emit(n.srcEvent.type,n)},this._onOtherEvent=n=>{this.manager.emit(n.type,n)},this.options={recognizers:[],events:{},touchAction:"compute",tabIndex:0,cssProps:{},...r},this.events=new Map,this.element=e,!!e){this.manager=new iUe(e,this.options);for(const n of this.options.recognizers){const{recognizer:i,recognizeWith:a,requireFailure:s}=PUe(n);this.manager.add(i),a&&i.recognizeWith(a),s&&i.requireFailure(s)}this.manager.on("hammer.input",this._onBasicInput),this.wheelInput=new pUe(e,this._onOtherEvent,{enable:!1}),this.moveInput=new gUe(e,this._onOtherEvent,{enable:!1}),this.keyInput=new mUe(e,this._onOtherEvent,{enable:!1,tabIndex:r.tabIndex}),this.contextmenuInput=new yUe(e,this._onOtherEvent,{enable:!1}),this.on(this.options.events)}}getElement(){return this.element}destroy(){this.element&&(this.wheelInput.destroy(),this.moveInput.destroy(),this.keyInput.destroy(),this.contextmenuInput.destroy(),this.manager.destroy())}on(e,r,n){this._addEventHandler(e,r,n,!1)}once(e,r,n){this._addEventHandler(e,r,n,!0)}watch(e,r,n){this._addEventHandler(e,r,n,!1,!0)}off(e,r){this._removeEventHandler(e,r)}_toggleRecognizer(e,r){const{manager:n}=this;if(!n)return;const i=n.get(e);i&&(i.set({enable:r}),n.touchAction.update()),this.wheelInput?.enableEventType(e,r),this.moveInput?.enableEventType(e,r),this.keyInput?.enableEventType(e,r),this.contextmenuInput?.enableEventType(e,r)}_addEventHandler(e,r,n,i,a){if(typeof e!="string"){n=r;for(const[f,d]of Object.entries(e))this._addEventHandler(f,d,n,i,a);return}const{manager:s,events:o}=this;if(!s)return;let c=o.get(e);if(!c){const f=this._getRecognizerName(e)||e;c=new IUe(this,f),o.set(e,c),s&&s.on(e,c.handleEvent)}c.add(e,r,n,i,a),c.isEmpty()||this._toggleRecognizer(c.recognizerName,!0)}_removeEventHandler(e,r){if(typeof e!="string"){for(const[a,s]of Object.entries(e))this._removeEventHandler(a,s);return}const{events:n}=this,i=n.get(e);if(i&&(i.remove(e,r),i.isEmpty())){const{recognizerName:a}=i;let s=!1;for(const o of n.values())if(o.recognizerName===a&&!o.isEmpty()){s=!0;break}s||this._toggleRecognizer(a,!1)}}_getRecognizerName(e){return this.manager.recognizers.find(r=>r.getEventNames().includes(e))?.options.event}}const Xa={DEFAULT:-1,LNGLAT:1,METER_OFFSETS:2,LNGLAT_OFFSETS:3,CARTESIAN:0};Object.defineProperty(Xa,"IDENTITY",{get:()=>(po.deprecated("COORDINATE_SYSTEM.IDENTITY","COORDINATE_SYSTEM.CARTESIAN")(),0)});const cf={WEB_MERCATOR:1,GLOBE:2,WEB_MERCATOR_AUTO_OFFSET:4,IDENTITY:0},wT={common:0,meters:1,pixels:2},fD={click:"onClick",dblclick:"onClick",panstart:"onDragStart",panmove:"onDrag",panend:"onDragEnd"},XG={multipan:[VG,{threshold:10,direction:Nl.Vertical,pointers:2}],pinch:[uUe,{},null,["multipan"]],pan:[VG,{threshold:1},["pinch"],["multipan"]],dblclick:[UG,{event:"dblclick",taps:2}],click:[UG,{event:"click"},null,["dblclick"]]};function RUe(t,e){if(t===e)return!0;if(Array.isArray(t)){const r=t.length;if(!e||e.length!==r)return!1;for(let n=0;n<r;n++)if(t[n]!==e[n])return!1;return!0}return!1}function s2(t){let e={},r;return n=>{for(const i in n)if(!RUe(n[i],e[i])){r=t(n),e=n;break}return r}}const YG=[0,0,0,0],MUe=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0],tne=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],DUe=[0,0,0],rne=[0,0,0],OUe=s2(FUe);function nne(t,e,r=rne){r.length<3&&(r=[r[0],r[1],0]);let n=r,i,a=!0;switch(e===Xa.LNGLAT_OFFSETS||e===Xa.METER_OFFSETS?i=r:i=t.isGeospatial?[Math.fround(t.longitude),Math.fround(t.latitude),0]:null,t.projectionMode){case cf.WEB_MERCATOR:(e===Xa.LNGLAT||e===Xa.CARTESIAN)&&(i=[0,0,0],a=!1);break;case cf.WEB_MERCATOR_AUTO_OFFSET:e===Xa.LNGLAT?n=i:e===Xa.CARTESIAN&&(n=[Math.fround(t.center[0]),Math.fround(t.center[1]),0],i=t.unprojectPosition(n),n[0]-=r[0],n[1]-=r[1],n[2]-=r[2]);break;case cf.IDENTITY:n=t.position.map(Math.fround),n[2]=n[2]||0;break;case cf.GLOBE:a=!1,i=null;break;default:a=!1}return{geospatialOrigin:i,shaderCoordinateOrigin:n,offsetMode:a}}function NUe(t,e,r){const{viewMatrixUncentered:n,projectionMatrix:i}=t;let{viewMatrix:a,viewProjectionMatrix:s}=t,o=YG,c=YG,f=t.cameraPosition;const{geospatialOrigin:d,shaderCoordinateOrigin:m,offsetMode:b}=nne(t,e,r);return b&&(c=t.projectPosition(d||m),f=[f[0]-c[0],f[1]-c[1],f[2]-c[2]],c[3]=1,o=I_([],c,s),a=n||a,s=Hm([],i,a),s=Hm([],s,MUe)),{viewMatrix:a,viewProjectionMatrix:s,projectionCenter:o,originCommon:c,cameraPosCommon:f,shaderCoordinateOrigin:m,geospatialOrigin:d}}function LUe({viewport:t,devicePixelRatio:e=1,modelMatrix:r=null,coordinateSystem:n=Xa.DEFAULT,coordinateOrigin:i=rne,autoWrapLongitude:a=!1}){n===Xa.DEFAULT&&(n=t.isGeospatial?Xa.LNGLAT:Xa.CARTESIAN);const s=OUe({viewport:t,devicePixelRatio:e,coordinateSystem:n,coordinateOrigin:i});return s.wrapLongitude=a,s.modelMatrix=r||tne,s}function FUe({viewport:t,devicePixelRatio:e,coordinateSystem:r,coordinateOrigin:n}){const{projectionCenter:i,viewProjectionMatrix:a,originCommon:s,cameraPosCommon:o,shaderCoordinateOrigin:c,geospatialOrigin:f}=NUe(t,r,n),d=t.getDistanceScales(),m=[t.width*e,t.height*e],b=I_([],[0,0,-t.focalDistance,1],t.projectionMatrix)[3]||1,x={coordinateSystem:r,projectionMode:t.projectionMode,coordinateOrigin:c,commonOrigin:s.slice(0,3),center:i,pseudoMeters:!!t._pseudoMeters,viewportSize:m,devicePixelRatio:e,focalDistance:b,commonUnitsPerMeter:d.unitsPerMeter,commonUnitsPerWorldUnit:d.unitsPerMeter,commonUnitsPerWorldUnit2:DUe,scale:t.scale,wrapLongitude:!1,viewProjectionMatrix:a,modelMatrix:tne,cameraPosition:o};if(f){const E=t.getDistanceScales(f);switch(r){case Xa.METER_OFFSETS:x.commonUnitsPerWorldUnit=E.unitsPerMeter,x.commonUnitsPerWorldUnit2=E.unitsPerMeter2;break;case Xa.LNGLAT:case Xa.LNGLAT_OFFSETS:t._pseudoMeters||(x.commonUnitsPerMeter=E.unitsPerMeter),x.commonUnitsPerWorldUnit=E.unitsPerDegree,x.commonUnitsPerWorldUnit2=E.unitsPerDegree2;break;case Xa.CARTESIAN:x.commonUnitsPerWorldUnit=[1,1,E.unitsPerMeter[2]],x.commonUnitsPerWorldUnit2=[0,0,E.unitsPerMeter2[2]];break}}return x}const BUe=Object.keys(Xa).map(t=>`const COORDINATE_SYSTEM_${t}: i32 = ${Xa[t]};`).join(""),zUe=Object.keys(cf).map(t=>`const PROJECTION_MODE_${t}: i32 = ${cf[t]};`).join(""),jUe=Object.keys(wT).map(t=>`const UNIT_${t.toUpperCase()}: i32 = ${wT[t]};`).join(""),UUe=`${BUe}
${zUe}
${jUe}

const TILE_SIZE: f32 = 512.0;
const PI: f32 = 3.1415926536;
const WORLD_SCALE: f32 = TILE_SIZE / (PI * 2.0);
const ZERO_64_LOW: vec3<f32> = vec3<f32>(0.0, 0.0, 0.0);
const EARTH_RADIUS: f32 = 6370972.0; // meters
const GLOBE_RADIUS: f32 = 256.0;

// -----------------------------------------------------------------------------
// Uniform block (converted from GLSL uniform block)
// -----------------------------------------------------------------------------
struct ProjectUniforms {
  wrapLongitude: i32,
  coordinateSystem: i32,
  commonUnitsPerMeter: vec3<f32>,
  projectionMode: i32,
  scale: f32,
  commonUnitsPerWorldUnit: vec3<f32>,
  commonUnitsPerWorldUnit2: vec3<f32>,
  center: vec4<f32>,
  modelMatrix: mat4x4<f32>,
  viewProjectionMatrix: mat4x4<f32>,
  viewportSize: vec2<f32>,
  devicePixelRatio: f32,
  focalDistance: f32,
  cameraPosition: vec3<f32>,
  coordinateOrigin: vec3<f32>,
  commonOrigin: vec3<f32>,
  pseudoMeters: i32,
};

@group(0) @binding(0)
var<uniform> project: ProjectUniforms;

// -----------------------------------------------------------------------------
// Geometry data
// (In your GLSL code, "geometry" was assumed to be available globally. In WGSL,
// you might supply this via vertex attributes or a uniform. Here we define a
// uniform struct for demonstration.)
// -----------------------------------------------------------------------------

// Structure to carry additional geometry data used by deck.gl filters.
struct Geometry {
  worldPosition: vec3<f32>,
  worldPositionAlt: vec3<f32>,
  position: vec4<f32>,
  normal: vec3<f32>,
  uv: vec2<f32>,
  pickingColor: vec3<f32>,
};

// @group(0) @binding(1)
var<private> geometry: Geometry;
`,VUe=`${UUe}

// -----------------------------------------------------------------------------
// Functions
// -----------------------------------------------------------------------------

// Returns an adjustment factor for commonUnitsPerMeter
fn _project_size_at_latitude(lat: f32) -> f32 {
  let y = clamp(lat, -89.9, 89.9);
  return 1.0 / cos(radians(y));
}

// Overloaded version: scales a value in meters at a given latitude.
fn _project_size_at_latitude_m(meters: f32, lat: f32) -> f32 {
  return meters * project.commonUnitsPerMeter.z * _project_size_at_latitude(lat);
}

// Computes a non-linear scale factor based on geometry.
// (Note: This function relies on "geometry" being provided.)
fn project_size() -> f32 {
  if (project.projectionMode == PROJECTION_MODE_WEB_MERCATOR &&
      project.coordinateSystem == COORDINATE_SYSTEM_LNGLAT &&
      project.pseudoMeters == 0) {
    if (geometry.position.w == 0.0) {
      return _project_size_at_latitude(geometry.worldPosition.y);
    }
    let y: f32 = geometry.position.y / TILE_SIZE * 2.0 - 1.0;
    let y2 = y * y;
    let y4 = y2 * y2;
    let y6 = y4 * y2;
    return 1.0 + 4.9348 * y2 + 4.0587 * y4 + 1.5642 * y6;
  }
  return 1.0;
}

// Overloads to scale offsets (meters to world units)
fn project_size_float(meters: f32) -> f32 {
  return meters * project.commonUnitsPerMeter.z * project_size();
}

fn project_size_vec2(meters: vec2<f32>) -> vec2<f32> {
  return meters * project.commonUnitsPerMeter.xy * project_size();
}

fn project_size_vec3(meters: vec3<f32>) -> vec3<f32> {
  return meters * project.commonUnitsPerMeter * project_size();
}

fn project_size_vec4(meters: vec4<f32>) -> vec4<f32> {
  return vec4<f32>(meters.xyz * project.commonUnitsPerMeter, meters.w);
}

// Returns a rotation matrix aligning the zaxis with the given up vector.
fn project_get_orientation_matrix(up: vec3<f32>) -> mat3x3<f32> {
  let uz = normalize(up);
  let ux = select(
    vec3<f32>(1.0, 0.0, 0.0),
    normalize(vec3<f32>(uz.y, -uz.x, 0.0)),
    abs(uz.z) == 1.0
  );
  let uy = cross(uz, ux);
  return mat3x3<f32>(ux, uy, uz);
}

// Since WGSL does not support "out" parameters, we return a struct.
struct RotationResult {
  needsRotation: bool,
  transform: mat3x3<f32>,
};

fn project_needs_rotation(commonPosition: vec3<f32>) -> RotationResult {
  if (project.projectionMode == PROJECTION_MODE_GLOBE) {
    return RotationResult(true, project_get_orientation_matrix(commonPosition));
  } else {
    return RotationResult(false, mat3x3<f32>());  // identity alternative if needed
  };
}

// Projects a normal vector from the current coordinate system to world space.
fn project_normal(vector: vec3<f32>) -> vec3<f32> {
  let normal_modelspace = project.modelMatrix * vec4<f32>(vector, 0.0);
  var n = normalize(normal_modelspace.xyz * project.commonUnitsPerMeter);
  let rotResult = project_needs_rotation(geometry.position.xyz);
  if (rotResult.needsRotation) {
    n = rotResult.transform * n;
  }
  return n;
}

// Applies a scale offset based on y-offset (dy)
fn project_offset_(offset: vec4<f32>) -> vec4<f32> {
  let dy: f32 = offset.y;
  let commonUnitsPerWorldUnit = project.commonUnitsPerWorldUnit + project.commonUnitsPerWorldUnit2 * dy;
  return vec4<f32>(offset.xyz * commonUnitsPerWorldUnit, offset.w);
}

// Projects lng/lat coordinates to a unit tile [0,1]
fn project_mercator_(lnglat: vec2<f32>) -> vec2<f32> {
  var x = lnglat.x;
  if (project.wrapLongitude != 0) {
    x = ((x + 180.0) % 360.0) - 180.0;
  }
  let y = clamp(lnglat.y, -89.9, 89.9);
  return vec2<f32>(
    radians(x) + PI,
    PI + log(tan(PI * 0.25 + radians(y) * 0.5))
  ) * WORLD_SCALE;
}

// Projects lng/lat/z coordinates for a globe projection.
fn project_globe_(lnglatz: vec3<f32>) -> vec3<f32> {
  let lambda = radians(lnglatz.x);
  let phi = radians(lnglatz.y);
  let cosPhi = cos(phi);
  let D = (lnglatz.z / EARTH_RADIUS + 1.0) * GLOBE_RADIUS;
  return vec3<f32>(
    sin(lambda) * cosPhi,
    -cos(lambda) * cosPhi,
    sin(phi)
  ) * D;
}

// Projects positions (with an optional 64-bit low part) from the input
// coordinate system to the common space.
fn project_position_vec4_f64(position: vec4<f32>, position64Low: vec3<f32>) -> vec4<f32> {
  var position_world = project.modelMatrix * position;

  // Work around for a Mac+NVIDIA bug:
  if (project.projectionMode == PROJECTION_MODE_WEB_MERCATOR) {
    if (project.coordinateSystem == COORDINATE_SYSTEM_LNGLAT) {
      return vec4<f32>(
        project_mercator_(position_world.xy),
        _project_size_at_latitude_m(position_world.z, position_world.y),
        position_world.w
      );
    }
    if (project.coordinateSystem == COORDINATE_SYSTEM_CARTESIAN) {
      position_world = vec4f(position_world.xyz + project.coordinateOrigin, position_world.w);
    }
  }
  if (project.projectionMode == PROJECTION_MODE_GLOBE) {
    if (project.coordinateSystem == COORDINATE_SYSTEM_LNGLAT) {
      return vec4<f32>(
        project_globe_(position_world.xyz),
        position_world.w
      );
    }
  }
  if (project.projectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET) {
    if (project.coordinateSystem == COORDINATE_SYSTEM_LNGLAT) {
      if (abs(position_world.y - project.coordinateOrigin.y) > 0.25) {
        return vec4<f32>(
          project_mercator_(position_world.xy) - project.commonOrigin.xy,
          project_size_float(position_world.z),
          position_world.w
        );
      }
    }
  }
  if (project.projectionMode == PROJECTION_MODE_IDENTITY ||
      (project.projectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET &&
       (project.coordinateSystem == COORDINATE_SYSTEM_LNGLAT ||
        project.coordinateSystem == COORDINATE_SYSTEM_CARTESIAN))) {
    position_world = vec4f(position_world.xyz - project.coordinateOrigin, position_world.w);
  }

  return project_offset_(position_world) +
         project_offset_(project.modelMatrix * vec4<f32>(position64Low, 0.0));
}

// Overloaded versions for different input types.
fn project_position_vec4_f32(position: vec4<f32>) -> vec4<f32> {
  return project_position_vec4_f64(position, ZERO_64_LOW);
}

fn project_position_vec3_f64(position: vec3<f32>, position64Low: vec3<f32>) -> vec3<f32> {
  let projected_position = project_position_vec4_f64(vec4<f32>(position, 1.0), position64Low);
  return projected_position.xyz;
}

fn project_position_vec3_f32(position: vec3<f32>) -> vec3<f32> {
  let projected_position = project_position_vec4_f64(vec4<f32>(position, 1.0), ZERO_64_LOW);
  return projected_position.xyz;
}

fn project_position_vec2_f32(position: vec2<f32>) -> vec2<f32> {
  let projected_position = project_position_vec4_f64(vec4<f32>(position, 0.0, 1.0), ZERO_64_LOW);
  return projected_position.xy;
}

// Transforms a common space position to clip space.
fn project_common_position_to_clipspace_with_projection(position: vec4<f32>, viewProjectionMatrix: mat4x4<f32>, center: vec4<f32>) -> vec4<f32> {
  return viewProjectionMatrix * position + center;
}

// Uses the project viewProjectionMatrix and center.
fn project_common_position_to_clipspace(position: vec4<f32>) -> vec4<f32> {
  return project_common_position_to_clipspace_with_projection(position, project.viewProjectionMatrix, project.center);
}

// Returns a clip space offset corresponding to a given number of screen pixels.
fn project_pixel_size_to_clipspace(pixels: vec2<f32>) -> vec2<f32> {
  let offset = pixels / project.viewportSize * project.devicePixelRatio * 2.0;
  return offset * project.focalDistance;
}

fn project_meter_size_to_pixel(meters: f32) -> f32 {
  return project_size_float(meters) * project.scale;
}

fn project_unit_size_to_pixel(size: f32, unit: i32) -> f32 {
  if (unit == UNIT_METERS) {
    return project_meter_size_to_pixel(size);
  } else if (unit == UNIT_COMMON) {
    return size * project.scale;
  }
  // UNIT_PIXELS: no scaling applied.
  return size;
}

fn project_pixel_size_float(pixels: f32) -> f32 {
  return pixels / project.scale;
}

fn project_pixel_size_vec2(pixels: vec2<f32>) -> vec2<f32> {
  return pixels / project.scale;
}
`,$Ue=Object.keys(Xa).map(t=>`const int COORDINATE_SYSTEM_${t} = ${Xa[t]};`).join(""),qUe=Object.keys(cf).map(t=>`const int PROJECTION_MODE_${t} = ${cf[t]};`).join(""),HUe=Object.keys(wT).map(t=>`const int UNIT_${t.toUpperCase()} = ${wT[t]};`).join(""),GUe=`${$Ue}
${qUe}
${HUe}
uniform projectUniforms {
bool wrapLongitude;
int coordinateSystem;
vec3 commonUnitsPerMeter;
int projectionMode;
float scale;
vec3 commonUnitsPerWorldUnit;
vec3 commonUnitsPerWorldUnit2;
vec4 center;
mat4 modelMatrix;
mat4 viewProjectionMatrix;
vec2 viewportSize;
float devicePixelRatio;
float focalDistance;
vec3 cameraPosition;
vec3 coordinateOrigin;
vec3 commonOrigin;
bool pseudoMeters;
} project;
const float TILE_SIZE = 512.0;
const float PI = 3.1415926536;
const float WORLD_SCALE = TILE_SIZE / (PI * 2.0);
const vec3 ZERO_64_LOW = vec3(0.0);
const float EARTH_RADIUS = 6370972.0;
const float GLOBE_RADIUS = 256.0;
float project_size_at_latitude(float lat) {
float y = clamp(lat, -89.9, 89.9);
return 1.0 / cos(radians(y));
}
float project_size() {
if (project.projectionMode == PROJECTION_MODE_WEB_MERCATOR &&
project.coordinateSystem == COORDINATE_SYSTEM_LNGLAT &&
project.pseudoMeters == false) {
if (geometry.position.w == 0.0) {
return project_size_at_latitude(geometry.worldPosition.y);
}
float y = geometry.position.y / TILE_SIZE * 2.0 - 1.0;
float y2 = y * y;
float y4 = y2 * y2;
float y6 = y4 * y2;
return 1.0 + 4.9348 * y2 + 4.0587 * y4 + 1.5642 * y6;
}
return 1.0;
}
float project_size_at_latitude(float meters, float lat) {
return meters * project.commonUnitsPerMeter.z * project_size_at_latitude(lat);
}
float project_size(float meters) {
return meters * project.commonUnitsPerMeter.z * project_size();
}
vec2 project_size(vec2 meters) {
return meters * project.commonUnitsPerMeter.xy * project_size();
}
vec3 project_size(vec3 meters) {
return meters * project.commonUnitsPerMeter * project_size();
}
vec4 project_size(vec4 meters) {
return vec4(meters.xyz * project.commonUnitsPerMeter, meters.w);
}
mat3 project_get_orientation_matrix(vec3 up) {
vec3 uz = normalize(up);
vec3 ux = abs(uz.z) == 1.0 ? vec3(1.0, 0.0, 0.0) : normalize(vec3(uz.y, -uz.x, 0));
vec3 uy = cross(uz, ux);
return mat3(ux, uy, uz);
}
bool project_needs_rotation(vec3 commonPosition, out mat3 transform) {
if (project.projectionMode == PROJECTION_MODE_GLOBE) {
transform = project_get_orientation_matrix(commonPosition);
return true;
}
return false;
}
vec3 project_normal(vec3 vector) {
vec4 normal_modelspace = project.modelMatrix * vec4(vector, 0.0);
vec3 n = normalize(normal_modelspace.xyz * project.commonUnitsPerMeter);
mat3 rotation;
if (project_needs_rotation(geometry.position.xyz, rotation)) {
n = rotation * n;
}
return n;
}
vec4 project_offset_(vec4 offset) {
float dy = offset.y;
vec3 commonUnitsPerWorldUnit = project.commonUnitsPerWorldUnit + project.commonUnitsPerWorldUnit2 * dy;
return vec4(offset.xyz * commonUnitsPerWorldUnit, offset.w);
}
vec2 project_mercator_(vec2 lnglat) {
float x = lnglat.x;
if (project.wrapLongitude) {
x = mod(x + 180., 360.0) - 180.;
}
float y = clamp(lnglat.y, -89.9, 89.9);
return vec2(
radians(x) + PI,
PI + log(tan_fp32(PI * 0.25 + radians(y) * 0.5))
) * WORLD_SCALE;
}
vec3 project_globe_(vec3 lnglatz) {
float lambda = radians(lnglatz.x);
float phi = radians(lnglatz.y);
float cosPhi = cos(phi);
float D = (lnglatz.z / EARTH_RADIUS + 1.0) * GLOBE_RADIUS;
return vec3(
sin(lambda) * cosPhi,
-cos(lambda) * cosPhi,
sin(phi)
) * D;
}
vec4 project_position(vec4 position, vec3 position64Low) {
vec4 position_world = project.modelMatrix * position;
if (project.projectionMode == PROJECTION_MODE_WEB_MERCATOR) {
if (project.coordinateSystem == COORDINATE_SYSTEM_LNGLAT) {
return vec4(
project_mercator_(position_world.xy),
project_size_at_latitude(position_world.z, position_world.y),
position_world.w
);
}
if (project.coordinateSystem == COORDINATE_SYSTEM_CARTESIAN) {
position_world.xyz += project.coordinateOrigin;
}
}
if (project.projectionMode == PROJECTION_MODE_GLOBE) {
if (project.coordinateSystem == COORDINATE_SYSTEM_LNGLAT) {
return vec4(
project_globe_(position_world.xyz),
position_world.w
);
}
}
if (project.projectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET) {
if (project.coordinateSystem == COORDINATE_SYSTEM_LNGLAT) {
if (abs(position_world.y - project.coordinateOrigin.y) > 0.25) {
return vec4(
project_mercator_(position_world.xy) - project.commonOrigin.xy,
project_size(position_world.z),
position_world.w
);
}
}
}
if (project.projectionMode == PROJECTION_MODE_IDENTITY ||
(project.projectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET &&
(project.coordinateSystem == COORDINATE_SYSTEM_LNGLAT ||
project.coordinateSystem == COORDINATE_SYSTEM_CARTESIAN))) {
position_world.xyz -= project.coordinateOrigin;
}
return project_offset_(position_world) + project_offset_(project.modelMatrix * vec4(position64Low, 0.0));
}
vec4 project_position(vec4 position) {
return project_position(position, ZERO_64_LOW);
}
vec3 project_position(vec3 position, vec3 position64Low) {
vec4 projected_position = project_position(vec4(position, 1.0), position64Low);
return projected_position.xyz;
}
vec3 project_position(vec3 position) {
vec4 projected_position = project_position(vec4(position, 1.0), ZERO_64_LOW);
return projected_position.xyz;
}
vec2 project_position(vec2 position) {
vec4 projected_position = project_position(vec4(position, 0.0, 1.0), ZERO_64_LOW);
return projected_position.xy;
}
vec4 project_common_position_to_clipspace(vec4 position, mat4 viewProjectionMatrix, vec4 center) {
return viewProjectionMatrix * position + center;
}
vec4 project_common_position_to_clipspace(vec4 position) {
return project_common_position_to_clipspace(position, project.viewProjectionMatrix, project.center);
}
vec2 project_pixel_size_to_clipspace(vec2 pixels) {
vec2 offset = pixels / project.viewportSize * project.devicePixelRatio * 2.0;
return offset * project.focalDistance;
}
float project_size_to_pixel(float meters) {
return project_size(meters) * project.scale;
}
float project_size_to_pixel(float size, int unit) {
if (unit == UNIT_METERS) return project_size_to_pixel(size);
if (unit == UNIT_COMMON) return size * project.scale;
return size;
}
float project_pixel_size(float pixels) {
return pixels / project.scale;
}
vec2 project_pixel_size(vec2 pixels) {
return pixels / project.scale;
}
`,WUe={};function XUe(t=WUe){return"viewport"in t?LUe(t):{}}const l6={name:"project",dependencies:[Tje,Xre],source:VUe,vs:GUe,getUniforms:XUe,uniformTypes:{wrapLongitude:"f32",coordinateSystem:"i32",commonUnitsPerMeter:"vec3<f32>",projectionMode:"i32",scale:"f32",commonUnitsPerWorldUnit:"vec3<f32>",commonUnitsPerWorldUnit2:"vec3<f32>",center:"vec4<f32>",modelMatrix:"mat4x4<f32>",viewProjectionMatrix:"mat4x4<f32>",viewportSize:"vec2<f32>",devicePixelRatio:"f32",focalDistance:"f32",cameraPosition:"vec3<f32>",coordinateOrigin:"vec3<f32>",commonOrigin:"vec3<f32>",pseudoMeters:"f32"}},YUe=`// Define a structure to hold both the clip-space position and the common position.
struct ProjectResult {
  clipPosition: vec4<f32>,
  commonPosition: vec4<f32>,
};

// This function mimics the GLSL version with the 'out' parameter by returning both values.
fn project_position_to_clipspace_and_commonspace(
    position: vec3<f32>,
    position64Low: vec3<f32>,
    offset: vec3<f32>
) -> ProjectResult {
  // Compute the projected position.
  let projectedPosition: vec3<f32> = project_position_vec3_f64(position, position64Low);

  // Start with the provided offset.
  var finalOffset: vec3<f32> = offset;

  // Get whether a rotation is needed and the rotation matrix.
  let rotationResult = project_needs_rotation(projectedPosition);

  // If rotation is needed, update the offset.
  if (rotationResult.needsRotation) {
    finalOffset = rotationResult.transform * offset;
  }

  // Compute the common position.
  let commonPosition: vec4<f32> = vec4<f32>(projectedPosition + finalOffset, 1.0);

  // Convert to clip-space.
  let clipPosition: vec4<f32> = project_common_position_to_clipspace(commonPosition);

  return ProjectResult(clipPosition, commonPosition);
}

// A convenience overload that returns only the clip-space position.
fn project_position_to_clipspace(
    position: vec3<f32>,
    position64Low: vec3<f32>,
    offset: vec3<f32>
) -> vec4<f32> {
  return project_position_to_clipspace_and_commonspace(position, position64Low, offset).clipPosition;
}
`,ZUe=`vec4 project_position_to_clipspace(
  vec3 position, vec3 position64Low, vec3 offset, out vec4 commonPosition
) {
  vec3 projectedPosition = project_position(position, position64Low);
  mat3 rotation;
  if (project_needs_rotation(projectedPosition, rotation)) {
    // offset is specified as ENU
    // when in globe projection, rotate offset so that the ground alighs with the surface of the globe
    offset = rotation * offset;
  }
  commonPosition = vec4(projectedPosition + offset, 1.0);
  return project_common_position_to_clipspace(commonPosition);
}

vec4 project_position_to_clipspace(
  vec3 position, vec3 position64Low, vec3 offset
) {
  vec4 commonPosition;
  return project_position_to_clipspace(position, position64Low, offset, commonPosition);
}
`,lXe={name:"project32",dependencies:[l6],source:YUe,vs:ZUe};function KUe(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function O0(t,e){const r=I_([],e,t);return Hre(r,r,1/r[3]),r}function ZG(t,e){const r=t%e;return r<0?e+r:r}function hD(t,e,r){return t<e?e:t>r?r:t}function JUe(t){return Math.log(t)*Math.LOG2E}const u6=Math.log2||JUe;function Pp(t,e){if(!t)throw new Error(e||"@math.gl/web-mercator: assertion failed.")}const Sh=Math.PI,ine=Sh/4,$f=Sh/180,dD=180/Sh,o_=512,ST=4003e4,md=85.051129,QUe=1.5;function eVe(t){return u6(t)}function gx(t){const[e,r]=t;Pp(Number.isFinite(e)),Pp(Number.isFinite(r)&&r>=-90&&r<=90,"invalid latitude");const n=e*$f,i=r*$f,a=o_*(n+Sh)/(2*Sh),s=o_*(Sh+Math.log(Math.tan(ine+i*.5)))/(2*Sh);return[a,s]}function s_(t){const[e,r]=t,n=e/o_*(2*Sh)-Sh,i=2*(Math.atan(Math.exp(r/o_*(2*Sh)-Sh))-ine);return[n*dD,i*dD]}function tVe(t){const{latitude:e}=t;Pp(Number.isFinite(e));const r=Math.cos(e*$f);return eVe(ST*r)-9}function LS(t){const e=Math.cos(t*$f);return o_/ST/e}function pD(t){const{latitude:e,longitude:r,highPrecision:n=!1}=t;Pp(Number.isFinite(e)&&Number.isFinite(r));const i=o_,a=Math.cos(e*$f),s=i/360,o=s/a,c=i/ST/a,f={unitsPerMeter:[c,c,c],metersPerUnit:[1/c,1/c,1/c],unitsPerDegree:[s,o,c],degreesPerUnit:[1/s,1/o,1/c]};if(n){const d=$f*Math.tan(e*$f)/a,m=s*d/2,b=i/ST*d,x=b/o*c;f.unitsPerDegree2=[0,m,b],f.unitsPerMeter2=[x,0,x]}return f}function ane(t,e){const[r,n,i]=t,[a,s,o]=e,{unitsPerMeter:c,unitsPerMeter2:f}=pD({longitude:r,latitude:n,highPrecision:!0}),d=gx(t);d[0]+=a*(c[0]+f[0]*s),d[1]+=s*(c[1]+f[1]*s);const m=s_(d),b=(i||0)+(o||0);return Number.isFinite(i)||Number.isFinite(o)?[m[0],m[1],b]:m}function rVe(t){const{height:e,pitch:r,bearing:n,altitude:i,scale:a,center:s}=t,o=KUe();bT(o,o,[0,0,-i]),$re(o,o,-r*$f),qre(o,o,n*$f);const c=a/e;return s6(o,o,[c,c,c]),s&&bT(o,o,H7e([],s)),o}function nVe(t){const{width:e,height:r,altitude:n,pitch:i=0,offset:a,center:s,scale:o,nearZMultiplier:c=1,farZMultiplier:f=1}=t;let{fovy:d=mx(QUe)}=t;n!==void 0&&(d=mx(n));const m=d*$f,b=i*$f,x=c6(d);let E=x;s&&(E+=s[2]*o/Math.cos(b)/r);const T=m*(.5+(a?a[1]:0)/r),A=Math.sin(T)*E/Math.sin(hD(Math.PI/2-b-T,.01,Math.PI-.01)),M=Math.sin(b)*A+E,F=E*10,N=Math.min(M*f,F);return{fov:m,aspect:e/r,focalDistance:x,near:c,far:N}}function mx(t){return 2*Math.atan(.5/t)*dD}function c6(t){return .5/Math.tan(.5*t*$f)}function one(t,e){const[r,n,i=0]=t;return Pp(Number.isFinite(r)&&Number.isFinite(n)&&Number.isFinite(i)),O0(e,[r,n,i,1])}function f6(t,e,r=0){const[n,i,a]=t;if(Pp(Number.isFinite(n)&&Number.isFinite(i),"invalid pixel coordinate"),Number.isFinite(a))return O0(e,[n,i,a,1]);const s=O0(e,[n,i,0,1]),o=O0(e,[n,i,1,1]),c=s[2],f=o[2],d=c===f?0:((r||0)-c)/(f-c);return zre([],s,o,d)}function iVe(t){const{width:e,height:r,bounds:n,minExtent:i=0,maxZoom:a=24,offset:s=[0,0]}=t,[[o,c],[f,d]]=n,m=aVe(t.padding),b=gx([o,hD(d,-md,md)]),x=gx([f,hD(c,-md,md)]),E=[Math.max(Math.abs(x[0]-b[0]),i),Math.max(Math.abs(x[1]-b[1]),i)],T=[e-m.left-m.right-Math.abs(s[0])*2,r-m.top-m.bottom-Math.abs(s[1])*2];Pp(T[0]>0&&T[1]>0);const A=T[0]/E[0],M=T[1]/E[1],F=(m.right-m.left)/2/A,N=(m.top-m.bottom)/2/M,O=[(x[0]+b[0])/2+F,(x[1]+b[1])/2+N],U=s_(O),j=Math.min(a,u6(Math.abs(Math.min(A,M))));return Pp(Number.isFinite(j)),{longitude:U[0],latitude:U[1],zoom:j}}function aVe(t=0){return typeof t=="number"?{top:t,bottom:t,left:t,right:t}:(Pp(Number.isFinite(t.top)&&Number.isFinite(t.bottom)&&Number.isFinite(t.left)&&Number.isFinite(t.right)),t)}const KG=Math.PI/180;function oVe(t,e=0){const{width:r,height:n,unproject:i}=t,a={targetZ:e},s=i([0,n],a),o=i([r,n],a);let c,f;const d=t.fovy?.5*t.fovy*KG:Math.atan(.5/t.altitude),m=(90-t.pitch)*KG;return d>m-.01?(c=JG(t,0,e),f=JG(t,r,e)):(c=i([0,0],a),f=i([r,0],a)),[s,o,f,c]}function JG(t,e,r){const{pixelUnprojectionMatrix:n}=t,i=O0(n,[e,0,1,1]),a=O0(n,[e,t.height,1,1]),o=(r*t.distanceScales.unitsPerMeter[2]-i[2])/(a[2]-i[2]),c=zre([],i,a,o),f=s_(c);return f.push(r),f}const QG=512;function sVe(t){const{width:e,height:r,pitch:n=0}=t;let{longitude:i,latitude:a,zoom:s,bearing:o=0}=t;(i<-180||i>180)&&(i=ZG(i+180,360)-180),(o<-180||o>180)&&(o=ZG(o+180,360)-180);const c=u6(r/QG);if(s<=c)s=c,a=0;else{const f=r/2/Math.pow(2,s),d=s_([0,f])[1];if(a<d)a=d;else{const m=s_([0,QG-f])[1];a>m&&(a=m)}}return{width:e,height:r,longitude:i,latitude:a,zoom:s,pitch:n,bearing:o}}const sne=`
uniform shadowUniforms {
  bool drawShadowMap;
  bool useShadowMap;
  vec4 color;
  highp int lightId;
  float lightCount;
  mat4 viewProjectionMatrix0;
  mat4 viewProjectionMatrix1;
  vec4 projectCenter0;
  vec4 projectCenter1;
} shadow;
`,lVe=`
const int max_lights = 2;

out vec3 shadow_vPosition[max_lights];

vec4 shadow_setVertexPosition(vec4 position_commonspace) {
  mat4 viewProjectionMatrices[max_lights];
  viewProjectionMatrices[0] = shadow.viewProjectionMatrix0;
  viewProjectionMatrices[1] = shadow.viewProjectionMatrix1;
  vec4 projectCenters[max_lights];
  projectCenters[0] = shadow.projectCenter0;
  projectCenters[1] = shadow.projectCenter1;

  if (shadow.drawShadowMap) {
    return project_common_position_to_clipspace(position_commonspace, viewProjectionMatrices[shadow.lightId], projectCenters[shadow.lightId]);
  }
  if (shadow.useShadowMap) {
    for (int i = 0; i < max_lights; i++) {
      if(i < int(shadow.lightCount)) {
        vec4 shadowMap_position = project_common_position_to_clipspace(position_commonspace, viewProjectionMatrices[i], projectCenters[i]);
        shadow_vPosition[i] = (shadowMap_position.xyz / shadowMap_position.w + 1.0) / 2.0;
      }
    }
  }
  return gl_Position;
}
`,uVe=`
${sne}
${lVe}
`,cVe=`
const int max_lights = 2;
uniform sampler2D shadow_uShadowMap0;
uniform sampler2D shadow_uShadowMap1;

in vec3 shadow_vPosition[max_lights];

const vec4 bitPackShift = vec4(1.0, 255.0, 65025.0, 16581375.0);
const vec4 bitUnpackShift = 1.0 / bitPackShift;
const vec4 bitMask = vec4(1.0 / 255.0, 1.0 / 255.0, 1.0 / 255.0,  0.0);

float shadow_getShadowWeight(vec3 position, sampler2D shadowMap) {
  vec4 rgbaDepth = texture(shadowMap, position.xy);

  float z = dot(rgbaDepth, bitUnpackShift);
  return smoothstep(0.001, 0.01, position.z - z);
}

vec4 shadow_filterShadowColor(vec4 color) {
  if (shadow.drawShadowMap) {
    vec4 rgbaDepth = fract(gl_FragCoord.z * bitPackShift);
    rgbaDepth -= rgbaDepth.gbaa * bitMask;
    return rgbaDepth;
  }
  if (shadow.useShadowMap) {
    float shadowAlpha = 0.0;
    shadowAlpha += shadow_getShadowWeight(shadow_vPosition[0], shadow_uShadowMap0);
    if(shadow.lightCount > 1.0) {
      shadowAlpha += shadow_getShadowWeight(shadow_vPosition[1], shadow_uShadowMap1);
    }
    shadowAlpha *= shadow.color.a / shadow.lightCount;
    float blendedAlpha = shadowAlpha + color.a * (1.0 - shadowAlpha);

    return vec4(
      mix(color.rgb, shadow.color.rgb, shadowAlpha / blendedAlpha),
      blendedAlpha
    );
  }
  return color;
}
`,fVe=`
${sne}
${cVe}
`,hVe=s2(yVe),dVe=s2(vVe),pVe=[0,0,0,1],gVe=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0];function mVe(t,e){const[r,n,i]=t,a=f6([r,n,i],e);return Number.isFinite(i)?a:[a[0],a[1],0]}function yVe({viewport:t,center:e}){return new Rh(t.viewProjectionMatrix).invert().transform(e)}function vVe({viewport:t,shadowMatrices:e}){const r=[],n=t.pixelUnprojectionMatrix,i=t.isGeospatial?void 0:1,a=[[0,0,i],[t.width,0,i],[0,t.height,i],[t.width,t.height,i],[0,0,-1],[t.width,0,-1],[0,t.height,-1],[t.width,t.height,-1]].map(s=>mVe(s,n));for(const s of e){const o=s.clone().translate(new Ad(t.center).negate()),c=a.map(d=>o.transform(d)),f=new Rh().ortho({left:Math.min(...c.map(d=>d[0])),right:Math.max(...c.map(d=>d[0])),bottom:Math.min(...c.map(d=>d[1])),top:Math.max(...c.map(d=>d[1])),near:Math.min(...c.map(d=>-d[2])),far:Math.max(...c.map(d=>-d[2]))});r.push(f.multiplyRight(s))}return r}function _Ve(t){const{shadowEnabled:e=!0,project:r}=t;if(!e||!r||!t.shadowMatrices||!t.shadowMatrices.length)return{drawShadowMap:!1,useShadowMap:!1,shadow_uShadowMap0:t.dummyShadowMap,shadow_uShadowMap1:t.dummyShadowMap};const n=l6.getUniforms(r),i=hVe({viewport:r.viewport,center:n.center}),a=[],s=dVe({shadowMatrices:t.shadowMatrices,viewport:r.viewport}).slice();for(let c=0;c<t.shadowMatrices.length;c++){const f=s[c],d=f.clone().translate(new Ad(r.viewport.center).negate());n.coordinateSystem===Xa.LNGLAT&&n.projectionMode===cf.WEB_MERCATOR?(s[c]=d,a[c]=i):(s[c]=f.clone().multiplyRight(gVe),a[c]=d.transform(i))}const o={drawShadowMap:!!t.drawToShadowMap,useShadowMap:t.shadowMaps?t.shadowMaps.length>0:!1,color:t.shadowColor||pVe,lightId:t.shadowLightId||0,lightCount:t.shadowMatrices.length,shadow_uShadowMap0:t.dummyShadowMap,shadow_uShadowMap1:t.dummyShadowMap};for(let c=0;c<s.length;c++)o[`viewProjectionMatrix${c}`]=s[c],o[`projectCenter${c}`]=a[c];for(let c=0;c<2;c++)o[`shadow_uShadowMap${c}`]=t.shadowMaps&&t.shadowMaps[c]||t.dummyShadowMap;return o}const eW={name:"shadow",dependencies:[l6],vs:uVe,fs:fVe,inject:{"vs:DECKGL_FILTER_GL_POSITION":`
    position = shadow_setVertexPosition(geometry.position);
    `,"fs:DECKGL_FILTER_COLOR":`
    color = shadow_filterShadowColor(color);
    `},getUniforms:_Ve,uniformTypes:{drawShadowMap:"f32",useShadowMap:"f32",color:"vec4<f32>",lightId:"i32",lightCount:"f32",viewProjectionMatrix0:"mat4x4<f32>",viewProjectionMatrix1:"mat4x4<f32>",projectCenter0:"vec4<f32>",projectCenter1:"vec4<f32>"}},uXe={...MG,defaultUniforms:{...MG.defaultUniforms,useFloatColors:!1},inject:{"vs:DECKGL_FILTER_GL_POSITION":`
    // for picking depth values
    picking_setPickingAttribute(position.z / position.w);
  `,"vs:DECKGL_FILTER_COLOR":`
  picking_setPickingColor(geometry.pickingColor);
  `,"fs:DECKGL_FILTER_COLOR":{order:99,injection:`
  // use highlight color if this fragment belongs to the selected object.
  color = picking_filterHighlightColor(color);

  // use picking color if rendering to picking FBO.
  color = picking_filterPickingColor(color);
    `}}},bVe=[Xre],xVe=["vs:DECKGL_FILTER_SIZE(inout vec3 size, VertexGeometry geometry)","vs:DECKGL_FILTER_GL_POSITION(inout vec4 position, VertexGeometry geometry)","vs:DECKGL_FILTER_COLOR(inout vec4 color, VertexGeometry geometry)","fs:DECKGL_FILTER_COLOR(inout vec4 color, FragmentGeometry geometry)"],wVe=[];function SVe(t){const e=Mm.getDefaultShaderAssembler();for(const n of bVe)e.addDefaultModule(n);e._hookFunctions.length=0;const r=t==="glsl"?xVe:wVe;for(const n of r)e.addShaderHook(n);return e}const EVe=[255,255,255],TVe=1;let CVe=0;class AVe{constructor(e={}){this.type="ambient";const{color:r=EVe}=e,{intensity:n=TVe}=e;this.id=e.id||`ambient-${CVe++}`,this.color=r,this.intensity=n}}const IVe=[255,255,255],PVe=1,kVe=[0,0,-1];let RVe=0;class tW{constructor(e={}){this.type="directional";const{color:r=IVe}=e,{intensity:n=PVe}=e,{direction:i=kVe}=e,{_shadow:a=!1}=e;this.id=e.id||`directional-${RVe++}`,this.color=r,this.intensity=n,this.type="directional",this.direction=new Ad(i).normalize().toArray(),this.shadow=a}getProjectedLight(e){return this}}class MVe{constructor(e,r={id:"pass"}){const{id:n}=r;this.id=n,this.device=e,this.props={...r}}setProps(e){Object.assign(this.props,e)}render(e){}cleanup(){}}class h6 extends MVe{constructor(){super(...arguments),this._lastRenderIndex=-1}render(e){const[r,n]=this.device.canvasContext.getDrawingBufferSize(),i=e.clearCanvas??!0,a=e.clearColor??(i?[0,0,0,0]:!1),s=i?1:!1,o=i?0:!1,c=e.colorMask??15,f={viewport:[0,0,r,n]};e.colorMask&&(f.colorMask=c),e.scissorRect&&(f.scissorRect=e.scissorRect);const d=this.device.beginRenderPass({framebuffer:e.target,parameters:f,clearColor:a,clearDepth:s,clearStencil:o});try{return this._drawLayers(d,e)}finally{d.end(),this.device.submit()}}_drawLayers(e,r){const{target:n,shaderModuleProps:i,viewports:a,views:s,onViewportActive:o,clearStack:c=!0}=r;r.pass=r.pass||"unknown",c&&(this._lastRenderIndex=-1);const f=[];for(const d of a){const m=s&&s[d.id];o?.(d);const b=this._getDrawLayerParams(d,r),x=d.subViewports||[d];for(const E of x){const T=this._drawLayersInViewport(e,{target:n,shaderModuleProps:i,viewport:E,view:m,pass:r.pass,layers:r.layers},b);f.push(T)}}return f}_getDrawLayerParams(e,{layers:r,pass:n,isPicking:i=!1,layerFilter:a,cullRect:s,effects:o,shaderModuleProps:c},f=!1){const d=[],m=lne(this._lastRenderIndex+1),b={layer:r[0],viewport:e,isPicking:i,renderPass:n,cullRect:s},x={};for(let E=0;E<r.length;E++){const T=r[E],A=this._shouldDrawLayer(T,b,a,x),M={shouldDrawLayer:A};A&&!f&&(M.shouldDrawLayer=!0,M.layerRenderIndex=m(T,A),M.shaderModuleProps=this._getShaderModuleProps(T,o,n,c),M.layerParameters={...T.context.deck?.props.parameters,...this.getLayerParameters(T,E,e)}),d[E]=M}return d}_drawLayersInViewport(e,{layers:r,shaderModuleProps:n,pass:i,target:a,viewport:s,view:o},c){const f=DVe(this.device,{shaderModuleProps:n,target:a,viewport:s});if(o){const{clear:m,clearColor:b,clearDepth:x,clearStencil:E}=o.props;if(m){let T=[0,0,0,0],A=1,M=0;Array.isArray(b)?T=[...b.slice(0,3),b[3]||255].map(N=>N/255):b===!1&&(T=!1),x!==void 0&&(A=x),E!==void 0&&(M=E),this.device.beginRenderPass({framebuffer:a,parameters:{viewport:f,scissorRect:f},clearColor:T,clearDepth:A,clearStencil:M}).end()}}const d={totalCount:r.length,visibleCount:0,compositeCount:0,pickableCount:0};e.setParameters({viewport:f});for(let m=0;m<r.length;m++){const b=r[m],x=c[m],{shouldDrawLayer:E}=x;if(E&&b.props.pickable&&d.pickableCount++,b.isComposite&&d.compositeCount++,b.isDrawable&&x.shouldDrawLayer){const{layerRenderIndex:T,shaderModuleProps:A,layerParameters:M}=x;d.visibleCount++,this._lastRenderIndex=Math.max(this._lastRenderIndex,T),A.project&&(A.project.viewport=s),b.context.renderPass=e;try{b._drawLayer({renderPass:e,shaderModuleProps:A,uniforms:{layerIndex:T},parameters:M})}catch(F){b.raiseError(F,`drawing ${b} to ${i}`)}}}return d}shouldDrawLayer(e){return!0}getShaderModuleProps(e,r,n){return null}getLayerParameters(e,r,n){return e.props.parameters}_shouldDrawLayer(e,r,n,i){if(!(e.props.visible&&this.shouldDrawLayer(e)))return!1;r.layer=e;let s=e.parent;for(;s;){if(!s.props.visible||!s.filterSubLayer(r))return!1;r.layer=s,s=s.parent}if(n){const o=r.layer.id;if(o in i||(i[o]=n(r)),!i[o])return!1}return e.activateViewport(r.viewport),!0}_getShaderModuleProps(e,r,n,i){const a=this.device.canvasContext.cssToDeviceRatio(),s=e.internalState?.propsInTransition||e.props,o={layer:s,picking:{isActive:!1},project:{viewport:e.context.viewport,devicePixelRatio:a,modelMatrix:s.modelMatrix,coordinateSystem:s.coordinateSystem,coordinateOrigin:s.coordinateOrigin,autoWrapLongitude:e.wrapLongitude}};if(r)for(const c of r)rW(o,c.getShaderModuleProps?.(e,o));return rW(o,this.getShaderModuleProps(e,r,o),i)}}function lne(t=0,e={}){const r={},n=(i,a)=>{const s=i.props._offset,o=i.id,c=i.parent&&i.parent.id;let f;if(c&&!(c in e)&&n(i.parent,!1),c in r){const d=r[c]=r[c]||lne(e[c],e);f=d(i,a),r[o]=d}else Number.isFinite(s)?(f=s+(e[c]||0),r[o]=null):f=t;return a&&f>=t&&(t=f+1),e[o]=f,f};return n}function DVe(t,{shaderModuleProps:e,target:r,viewport:n}){const i=e?.project?.devicePixelRatio??t.canvasContext.cssToDeviceRatio(),[,a]=t.canvasContext.getDrawingBufferSize(),s=r?r.height:a,o=n;return[o.x*i,s-(o.y+o.height)*i,o.width*i,o.height*i]}function rW(t,...e){for(const r of e)if(r)for(const n in r)t[n]?Object.assign(t[n],r[n]):t[n]=r[n];return t}class OVe extends h6{constructor(e,r){super(e,r);const n=e.createTexture({format:"rgba8unorm",width:1,height:1,sampler:{minFilter:"linear",magFilter:"linear",addressModeU:"clamp-to-edge",addressModeV:"clamp-to-edge"}}),i=e.createTexture({format:"depth16unorm",width:1,height:1});this.fbo=e.createFramebuffer({id:"shadowmap",width:1,height:1,colorAttachments:[n],depthStencilAttachment:i})}delete(){this.fbo&&(this.fbo.destroy(),this.fbo=null)}getShadowMap(){return this.fbo.colorAttachments[0].texture}render(e){const r=this.fbo,n=this.device.canvasContext.cssToDeviceRatio(),i=e.viewports[0],a=i.width*n,s=i.height*n,o=[1,1,1,1];(a!==r.width||s!==r.height)&&r.resize({width:a,height:s}),super.render({...e,clearColor:o,target:r,pass:"shadow"})}getLayerParameters(e,r,n){return{...e.props.parameters,blend:!1,depthWriteEnabled:!0,depthCompare:"less-equal"}}shouldDrawLayer(e){return e.props.shadowEnabled!==!1}getShaderModuleProps(e,r,n){return{shadow:{project:n.project,drawToShadowMap:!0}}}}const NVe={color:[255,255,255],intensity:1},nW=[{color:[255,255,255],intensity:1,direction:[-1,3,-1]},{color:[255,255,255],intensity:.9,direction:[1,-8,-2.5]}],LVe=[0,0,0,200/255];class une{constructor(e={}){this.id="lighting-effect",this.shadowColor=LVe,this.shadow=!1,this.directionalLights=[],this.pointLights=[],this.shadowPasses=[],this.dummyShadowMap=null,this.setProps(e)}setup(e){this.context=e;const{device:r,deck:n}=e;this.shadow&&!this.dummyShadowMap&&(this._createShadowPasses(r),n._addDefaultShaderModule(eW),this.dummyShadowMap=r.createTexture({width:1,height:1}))}setProps(e){this.ambientLight=void 0,this.directionalLights=[],this.pointLights=[];for(const r in e){const n=e[r];switch(n.type){case"ambient":this.ambientLight=n;break;case"directional":this.directionalLights.push(n);break;case"point":this.pointLights.push(n);break}}this._applyDefaultLights(),this.shadow=this.directionalLights.some(r=>r.shadow),this.context&&this.setup(this.context),this.props=e}preRender({layers:e,layerFilter:r,viewports:n,onViewportActive:i,views:a}){if(this.shadow){this.shadowMatrices=this._calculateMatrices();for(let s=0;s<this.shadowPasses.length;s++)this.shadowPasses[s].render({layers:e,layerFilter:r,viewports:n,onViewportActive:i,views:a,shaderModuleProps:{shadow:{shadowLightId:s,dummyShadowMap:this.dummyShadowMap,shadowMatrices:this.shadowMatrices}}})}}getShaderModuleProps(e,r){const n=this.shadow?{project:r.project,shadowMaps:this.shadowPasses.map(s=>s.getShadowMap()),dummyShadowMap:this.dummyShadowMap,shadowColor:this.shadowColor,shadowMatrices:this.shadowMatrices}:{},i={enabled:!0,ambientLight:this.ambientLight,directionalLights:this.directionalLights.map(s=>s.getProjectedLight({layer:e})),pointLights:this.pointLights.map(s=>s.getProjectedLight({layer:e}))},a=e.props.material;return{shadow:n,lighting:i,phongMaterial:a,gouraudMaterial:a}}cleanup(e){for(const r of this.shadowPasses)r.delete();this.shadowPasses.length=0,this.dummyShadowMap&&(this.dummyShadowMap.destroy(),this.dummyShadowMap=null,e.deck._removeDefaultShaderModule(eW))}_calculateMatrices(){const e=[];for(const r of this.directionalLights){const n=new Rh().lookAt({eye:new Ad(r.direction).negate()});e.push(n)}return e}_createShadowPasses(e){for(let r=0;r<this.directionalLights.length;r++){const n=new OVe(e);this.shadowPasses[r]=n}}_applyDefaultLights(){const{ambientLight:e,pointLights:r,directionalLights:n}=this;!e&&r.length===0&&n.length===0&&(this.ambientLight=new AVe(NVe),this.directionalLights.push(new tW(nW[0]),new tW(nW[1])))}}class FVe{constructor(e={}){this._pool=[],this.opts={overAlloc:2,poolSize:100},this.setOptions(e)}setOptions(e){Object.assign(this.opts,e)}allocate(e,r,{size:n=1,type:i,padding:a=0,copy:s=!1,initialize:o=!1,maxCount:c}){const f=i||e&&e.constructor||Float32Array,d=r*n+a;if(ArrayBuffer.isView(e)){if(d<=e.length)return e;if(d*e.BYTES_PER_ELEMENT<=e.buffer.byteLength)return new f(e.buffer,0,d)}let m=1/0;c&&(m=c*n+a);const b=this._allocate(f,d,o,m);return e&&s?b.set(e):o||b.fill(0,0,4),this._release(e),b}release(e){this._release(e)}_allocate(e,r,n,i){let a=Math.max(Math.ceil(r*this.opts.overAlloc),1);a>i&&(a=i);const s=this._pool,o=e.BYTES_PER_ELEMENT*a,c=s.findIndex(f=>f.byteLength>=o);if(c>=0){const f=new e(s.splice(c,1)[0],0,a);return n&&f.fill(0),f}return new e(a)}_release(e){if(!ArrayBuffer.isView(e))return;const r=this._pool,{buffer:n}=e,{byteLength:i}=n,a=r.findIndex(s=>s.byteLength>=i);a<0?r.push(n):(a>0||r.length<this.opts.poolSize)&&r.splice(a,0,n),r.length>this.opts.poolSize&&r.shift()}}const yx=new FVe;function tb(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function BVe(t,e){const r=t%e;return r<0?e+r:r}function zVe(t){return[t[12],t[13],t[14]]}function jVe(t){return{left:Mv(t[3]+t[0],t[7]+t[4],t[11]+t[8],t[15]+t[12]),right:Mv(t[3]-t[0],t[7]-t[4],t[11]-t[8],t[15]-t[12]),bottom:Mv(t[3]+t[1],t[7]+t[5],t[11]+t[9],t[15]+t[13]),top:Mv(t[3]-t[1],t[7]-t[5],t[11]-t[9],t[15]-t[13]),near:Mv(t[3]+t[2],t[7]+t[6],t[11]+t[10],t[15]+t[14]),far:Mv(t[3]-t[2],t[7]-t[6],t[11]-t[10],t[15]-t[14])}}const iW=new Ad;function Mv(t,e,r,n){iW.set(t,e,r);const i=iW.len();return{distance:n/i,normal:new Ad(-t/i,-e/i,-r/i)}}function UVe(t){return t-Math.fround(t)}let C1;function tk(t,e){const{size:r=1,startIndex:n=0}=e,i=e.endIndex!==void 0?e.endIndex:t.length,a=(i-n)/r;C1=yx.allocate(C1,a,{type:Float32Array,size:r*2});let s=n,o=0;for(;s<i;){for(let c=0;c<r;c++){const f=t[s++];C1[o+c]=f,C1[o+c+r]=UVe(f)}o+=r*2}return C1.subarray(0,a*r*2)}function VVe(t){let e=null,r=!1;for(const n of t)n&&(e?(r||(e=[[e[0][0],e[0][1]],[e[1][0],e[1][1]]],r=!0),e[0][0]=Math.min(e[0][0],n[0][0]),e[0][1]=Math.min(e[0][1],n[0][1]),e[1][0]=Math.max(e[1][0],n[1][0]),e[1][1]=Math.max(e[1][1],n[1][1])):e=n);return e}const $Ve=Math.PI/180,qVe=tb(),aW=[0,0,0],HVe={unitsPerMeter:[1,1,1],metersPerUnit:[1,1,1]};function GVe({width:t,height:e,orthographic:r,fovyRadians:n,focalDistance:i,padding:a,near:s,far:o}){const c=t/e,f=r?new Rh().orthographic({fovy:n,aspect:c,focalDistance:i,near:s,far:o}):new Rh().perspective({fovy:n,aspect:c,near:s,far:o});if(a){const{left:d=0,right:m=0,top:b=0,bottom:x=0}=a,E=gd((d+t-m)/2,0,t)-t/2,T=gd((b+e-x)/2,0,e)-e/2;f[8]-=E*2/t,f[9]+=T*2/e}return f}class P_{constructor(e={}){this._frustumPlanes={},this.id=e.id||this.constructor.displayName||"viewport",this.x=e.x||0,this.y=e.y||0,this.width=e.width||1,this.height=e.height||1,this.zoom=e.zoom||0,this.padding=e.padding,this.distanceScales=e.distanceScales||HVe,this.focalDistance=e.focalDistance||1,this.position=e.position||aW,this.modelMatrix=e.modelMatrix||null;const{longitude:r,latitude:n}=e;this.isGeospatial=Number.isFinite(n)&&Number.isFinite(r),this._initProps(e),this._initMatrices(e),this.equals=this.equals.bind(this),this.project=this.project.bind(this),this.unproject=this.unproject.bind(this),this.projectPosition=this.projectPosition.bind(this),this.unprojectPosition=this.unprojectPosition.bind(this),this.projectFlat=this.projectFlat.bind(this),this.unprojectFlat=this.unprojectFlat.bind(this)}get subViewports(){return null}get metersPerPixel(){return this.distanceScales.metersPerUnit[2]/this.scale}get projectionMode(){return this.isGeospatial?this.zoom<12?cf.WEB_MERCATOR:cf.WEB_MERCATOR_AUTO_OFFSET:cf.IDENTITY}equals(e){return e instanceof P_?this===e?!0:e.width===this.width&&e.height===this.height&&e.scale===this.scale&&px(e.projectionMatrix,this.projectionMatrix)&&px(e.viewMatrix,this.viewMatrix):!1}project(e,{topLeft:r=!0}={}){const n=this.projectPosition(e),i=one(n,this.pixelProjectionMatrix),[a,s]=i,o=r?s:this.height-s;return e.length===2?[a,o]:[a,o,i[2]]}unproject(e,{topLeft:r=!0,targetZ:n}={}){const[i,a,s]=e,o=r?a:this.height-a,c=n&&n*this.distanceScales.unitsPerMeter[2],f=f6([i,o,s],this.pixelUnprojectionMatrix,c),[d,m,b]=this.unprojectPosition(f);return Number.isFinite(s)?[d,m,b]:Number.isFinite(n)?[d,m,n]:[d,m]}projectPosition(e){const[r,n]=this.projectFlat(e),i=(e[2]||0)*this.distanceScales.unitsPerMeter[2];return[r,n,i]}unprojectPosition(e){const[r,n]=this.unprojectFlat(e),i=(e[2]||0)*this.distanceScales.metersPerUnit[2];return[r,n,i]}projectFlat(e){if(this.isGeospatial){const r=gx(e);return r[1]=gd(r[1],-318,830),r}return e}unprojectFlat(e){return this.isGeospatial?s_(e):e}getBounds(e={}){const r={targetZ:e.z||0},n=this.unproject([0,0],r),i=this.unproject([this.width,0],r),a=this.unproject([0,this.height],r),s=this.unproject([this.width,this.height],r);return[Math.min(n[0],i[0],a[0],s[0]),Math.min(n[1],i[1],a[1],s[1]),Math.max(n[0],i[0],a[0],s[0]),Math.max(n[1],i[1],a[1],s[1])]}getDistanceScales(e){return e&&this.isGeospatial?pD({longitude:e[0],latitude:e[1],highPrecision:!0}):this.distanceScales}containsPixel({x:e,y:r,width:n=1,height:i=1}){return e<this.x+this.width&&this.x<e+n&&r<this.y+this.height&&this.y<r+i}getFrustumPlanes(){return this._frustumPlanes.near?this._frustumPlanes:(Object.assign(this._frustumPlanes,jVe(this.viewProjectionMatrix)),this._frustumPlanes)}panByPosition(e,r,n){return null}_initProps(e){const r=e.longitude,n=e.latitude;this.isGeospatial&&(Number.isFinite(e.zoom)||(this.zoom=tVe({latitude:n})+Math.log2(this.focalDistance)),this.distanceScales=e.distanceScales||pD({latitude:n,longitude:r}));const i=Math.pow(2,this.zoom);this.scale=i;const{position:a,modelMatrix:s}=e;let o=aW;if(a&&(o=s?new Rh(s).transformAsVector(a,[]):a),this.isGeospatial){const c=this.projectPosition([r,n,0]);this.center=new Ad(o).scale(this.distanceScales.unitsPerMeter).add(c)}else this.center=this.projectPosition(o)}_initMatrices(e){const{viewMatrix:r=qVe,projectionMatrix:n=null,orthographic:i=!1,fovyRadians:a,fovy:s=75,near:o=.1,far:c=1e3,padding:f=null,focalDistance:d=1}=e;this.viewMatrixUncentered=r,this.viewMatrix=new Rh().multiplyRight(r).translate(new Ad(this.center).negate()),this.projectionMatrix=n||GVe({width:this.width,height:this.height,orthographic:i,fovyRadians:a||s*$Ve,focalDistance:d,padding:f,near:o,far:c});const m=tb();Hm(m,m,this.projectionMatrix),Hm(m,m,this.viewMatrix),this.viewProjectionMatrix=m,this.viewMatrixInverse=aD([],this.viewMatrix)||this.viewMatrix,this.cameraPosition=zVe(this.viewMatrixInverse);const b=tb(),x=tb();s6(b,b,[this.width/2,-this.height/2,1]),bT(b,b,[1,-1,0]),Hm(x,b,this.viewProjectionMatrix),this.pixelProjectionMatrix=x,this.pixelUnprojectionMatrix=aD(tb(),this.pixelProjectionMatrix),this.pixelUnprojectionMatrix||po.warn("Pixel project matrix not invertible")()}}P_.displayName="Viewport";class yy extends P_{constructor(e={}){const{latitude:r=0,longitude:n=0,zoom:i=0,pitch:a=0,bearing:s=0,nearZMultiplier:o=.1,farZMultiplier:c=1.01,nearZ:f,farZ:d,orthographic:m=!1,projectionMatrix:b,repeat:x=!1,worldOffset:E=0,position:T,padding:A,legacyMeterSizes:M=!1}=e;let{width:F,height:N,altitude:O=1.5}=e;const U=Math.pow(2,i);F=F||1,N=N||1;let j,H=null;if(b)O=b[5]/2,j=mx(O);else{e.fovy?(j=e.fovy,O=c6(j)):j=mx(O);let X;if(A){const{top:oe=0,bottom:Q=0}=A;X=[0,gd((oe+N-Q)/2,0,N)-N/2]}H=nVe({width:F,height:N,scale:U,center:T&&[0,0,T[2]*LS(r)],offset:X,pitch:a,fovy:j,nearZMultiplier:o,farZMultiplier:c}),Number.isFinite(f)&&(H.near=f),Number.isFinite(d)&&(H.far=d)}let W=rVe({height:N,pitch:a,bearing:s,scale:U,altitude:O});E&&(W=new Rh().translate([512*E,0,0]).multiplyLeft(W)),super({...e,width:F,height:N,viewMatrix:W,longitude:n,latitude:r,zoom:i,...H,fovy:j,focalDistance:O}),this.latitude=r,this.longitude=n,this.zoom=i,this.pitch=a,this.bearing=s,this.altitude=O,this.fovy=j,this.orthographic=m,this._subViewports=x?[]:null,this._pseudoMeters=M,Object.freeze(this)}get subViewports(){if(this._subViewports&&!this._subViewports.length){const e=this.getBounds(),r=Math.floor((e[0]+180)/360),n=Math.ceil((e[2]-180)/360);for(let i=r;i<=n;i++){const a=i?new yy({...this,worldOffset:i}):this;this._subViewports.push(a)}}return this._subViewports}projectPosition(e){if(this._pseudoMeters)return super.projectPosition(e);const[r,n]=this.projectFlat(e),i=(e[2]||0)*LS(e[1]);return[r,n,i]}unprojectPosition(e){if(this._pseudoMeters)return super.unprojectPosition(e);const[r,n]=this.unprojectFlat(e),i=(e[2]||0)/LS(n);return[r,n,i]}addMetersToLngLat(e,r){return ane(e,r)}panByPosition(e,r,n){const i=f6(r,this.pixelUnprojectionMatrix),a=this.projectFlat(e),s=kG([],a,F7e([],i)),o=kG([],this.center,s),[c,f]=this.unprojectFlat(o);return{longitude:c,latitude:f}}getBounds(e={}){const r=oVe(this,e.z||0);return[Math.min(r[0][0],r[1][0],r[2][0],r[3][0]),Math.min(r[0][1],r[1][1],r[2][1],r[3][1]),Math.max(r[0][0],r[1][0],r[2][0],r[3][0]),Math.max(r[0][1],r[1][1],r[2][1],r[3][1])]}fitBounds(e,r={}){const{width:n,height:i}=this,{longitude:a,latitude:s,zoom:o}=iVe({width:n,height:i,bounds:e,...r});return new yy({width:n,height:i,longitude:a,latitude:s,zoom:o})}}yy.displayName="WebMercatorViewport";const oW=[0,0,0];function rk(t,e,r=!1){const n=e.projectPosition(t);if(r&&e instanceof yy){const[i,a,s=0]=t,o=e.getDistanceScales([i,a]);n[2]=s*o.unitsPerMeter[2]}return n}function WVe(t){const{viewport:e,modelMatrix:r,coordinateOrigin:n}=t;let{coordinateSystem:i,fromCoordinateSystem:a,fromCoordinateOrigin:s}=t;return i===Xa.DEFAULT&&(i=e.isGeospatial?Xa.LNGLAT:Xa.CARTESIAN),a===void 0&&(a=i),s===void 0&&(s=n),{viewport:e,coordinateSystem:i,coordinateOrigin:n,modelMatrix:r,fromCoordinateSystem:a,fromCoordinateOrigin:s}}function cne(t,{viewport:e,modelMatrix:r,coordinateSystem:n,coordinateOrigin:i,offsetMode:a}){let[s,o,c=0]=t;switch(r&&([s,o,c]=I_([],[s,o,c,1],r)),n){case Xa.LNGLAT:return rk([s,o,c],e,a);case Xa.LNGLAT_OFFSETS:return rk([s+i[0],o+i[1],c+(i[2]||0)],e,a);case Xa.METER_OFFSETS:return rk(ane(i,[s,o,c]),e,a);case Xa.CARTESIAN:default:return e.isGeospatial?[s+i[0],o+i[1],c+i[2]]:e.projectPosition([s,o,c])}}function XVe(t,e){const{viewport:r,coordinateSystem:n,coordinateOrigin:i,modelMatrix:a,fromCoordinateSystem:s,fromCoordinateOrigin:o}=WVe(e),{autoOffset:c=!0}=e,{geospatialOrigin:f=oW,shaderCoordinateOrigin:d=oW,offsetMode:m=!1}=c?nne(r,n,i):{},b=cne(t,{viewport:r,modelMatrix:a,coordinateSystem:s,coordinateOrigin:o,offsetMode:m});if(m){const x=r.projectPosition(f||d);Vre(b,b,x)}return b}let YVe=1,ZVe=1;class fne{time=0;channels=new Map;animations=new Map;playing=!1;lastEngineTime=-1;constructor(){}addChannel(e){const{delay:r=0,duration:n=Number.POSITIVE_INFINITY,rate:i=1,repeat:a=1}=e,s=YVe++,o={time:0,delay:r,duration:n,rate:i,repeat:a};return this._setChannelTime(o,this.time),this.channels.set(s,o),s}removeChannel(e){this.channels.delete(e);for(const[r,n]of this.animations)n.channel===e&&this.detachAnimation(r)}isFinished(e){const r=this.channels.get(e);return r===void 0?!1:this.time>=r.delay+r.duration*r.repeat}getTime(e){if(e===void 0)return this.time;const r=this.channels.get(e);return r===void 0?-1:r.time}setTime(e){this.time=Math.max(0,e);const r=this.channels.values();for(const i of r)this._setChannelTime(i,this.time);const n=this.animations.values();for(const i of n){const{animation:a,channel:s}=i;a.setTime(this.getTime(s))}}play(){this.playing=!0}pause(){this.playing=!1,this.lastEngineTime=-1}reset(){this.setTime(0)}attachAnimation(e,r){const n=ZVe++;return this.animations.set(n,{animation:e,channel:r}),e.setTime(this.getTime(r)),n}detachAnimation(e){this.animations.delete(e)}update(e){this.playing&&(this.lastEngineTime===-1&&(this.lastEngineTime=e),this.setTime(this.time+(e-this.lastEngineTime)),this.lastEngineTime=e)}_setChannelTime(e,r){const n=r-e.delay,i=e.duration*e.repeat;n>=i?e.time=e.duration*e.rate:(e.time=Math.max(0,n)%e.duration,e.time*=e.rate)}}function KVe(t){return typeof window<"u"&&window.requestAnimationFrame?window.requestAnimationFrame(t):setTimeout(t,1e3/60)}function JVe(t){return typeof window<"u"&&window.cancelAnimationFrame?window.cancelAnimationFrame(t):clearTimeout(t)}let QVe=0;class d6{static defaultAnimationLoopProps={device:null,onAddHTML:()=>"",onInitialize:async()=>null,onRender:()=>{},onFinalize:()=>{},onError:e=>console.error(e),stats:tD.stats.get(`animation-loop-${QVe++}`),autoResizeViewport:!1};device=null;canvas=null;props;animationProps=null;timeline=null;stats;cpuTime;gpuTime;frameRate;display;needsRedraw="initialized";_initialized=!1;_running=!1;_animationFrameId=null;_nextFramePromise=null;_resolveNextFrame=null;_cpuStartTime=0;_error=null;constructor(e){if(this.props={...d6.defaultAnimationLoopProps,...e},e=this.props,!e.device)throw new Error("No device provided");this.stats=e.stats||new W3({id:"animation-loop-stats"}),this.cpuTime=this.stats.get("CPU Time"),this.gpuTime=this.stats.get("GPU Time"),this.frameRate=this.stats.get("Frame Rate"),this.setProps({autoResizeViewport:e.autoResizeViewport}),this.start=this.start.bind(this),this.stop=this.stop.bind(this),this._onMousemove=this._onMousemove.bind(this),this._onMouseleave=this._onMouseleave.bind(this)}destroy(){this.stop(),this._setDisplay(null)}delete(){this.destroy()}reportError(e){this.props.onError(e),this._error=e}setNeedsRedraw(e){return this.needsRedraw=this.needsRedraw||e,this}setProps(e){return"autoResizeViewport"in e&&(this.props.autoResizeViewport=e.autoResizeViewport||!1),this}async start(){if(this._running)return this;this._running=!0;try{let e;return this._initialized||(this._initialized=!0,await this._initDevice(),this._initialize(),await this.props.onInitialize(this._getAnimationProps())),this._running?(e!==!1&&(this._cancelAnimationFrame(),this._requestAnimationFrame()),this):null}catch(e){const r=e instanceof Error?e:new Error("Unknown error");throw this.props.onError(r),r}}stop(){return this._running&&(this.animationProps&&!this._error&&this.props.onFinalize(this.animationProps),this._cancelAnimationFrame(),this._nextFramePromise=null,this._resolveNextFrame=null,this._running=!1),this}redraw(){return this.device?.isLost||this._error?this:(this._beginFrameTimers(),this._setupFrame(),this._updateAnimationProps(),this._renderFrame(this._getAnimationProps()),this._clearNeedsRedraw(),this._resolveNextFrame&&(this._resolveNextFrame(this),this._nextFramePromise=null,this._resolveNextFrame=null),this._endFrameTimers(),this)}attachTimeline(e){return this.timeline=e,this.timeline}detachTimeline(){this.timeline=null}waitForRender(){return this.setNeedsRedraw("waitForRender"),this._nextFramePromise||(this._nextFramePromise=new Promise(e=>{this._resolveNextFrame=e})),this._nextFramePromise}async toDataURL(){if(this.setNeedsRedraw("toDataURL"),await this.waitForRender(),this.canvas instanceof HTMLCanvasElement)return this.canvas.toDataURL();throw new Error("OffscreenCanvas")}_initialize(){this._startEventHandling(),this._initializeAnimationProps(),this._updateAnimationProps(),this._resizeViewport()}_setDisplay(e){this.display&&(this.display.destroy(),this.display.animationLoop=null),e&&(e.animationLoop=this),this.display=e}_requestAnimationFrame(){this._running&&(this._animationFrameId=KVe(this._animationFrame.bind(this)))}_cancelAnimationFrame(){this._animationFrameId!==null&&(JVe(this._animationFrameId),this._animationFrameId=null)}_animationFrame(){this._running&&(this.redraw(),this._requestAnimationFrame())}_renderFrame(e){if(this.display){this.display._renderFrame(e);return}this.props.onRender(this._getAnimationProps()),this.device?.submit()}_clearNeedsRedraw(){this.needsRedraw=!1}_setupFrame(){this._resizeViewport()}_initializeAnimationProps(){const e=this.device?.getDefaultCanvasContext();if(!this.device||!e)throw new Error("loop");const r=e?.canvas,n=e.props.useDevicePixels;this.animationProps={animationLoop:this,device:this.device,canvasContext:e,canvas:r,useDevicePixels:n,timeline:this.timeline,needsRedraw:!1,width:1,height:1,aspect:1,time:0,startTime:Date.now(),engineTime:0,tick:0,tock:0,_mousePosition:null}}_getAnimationProps(){if(!this.animationProps)throw new Error("animationProps");return this.animationProps}_updateAnimationProps(){if(!this.animationProps)return;const{width:e,height:r,aspect:n}=this._getSizeAndAspect();(e!==this.animationProps.width||r!==this.animationProps.height)&&this.setNeedsRedraw("drawing buffer resized"),n!==this.animationProps.aspect&&this.setNeedsRedraw("drawing buffer aspect changed"),this.animationProps.width=e,this.animationProps.height=r,this.animationProps.aspect=n,this.animationProps.needsRedraw=this.needsRedraw,this.animationProps.engineTime=Date.now()-this.animationProps.startTime,this.timeline&&this.timeline.update(this.animationProps.engineTime),this.animationProps.tick=Math.floor(this.animationProps.time/1e3*60),this.animationProps.tock++,this.animationProps.time=this.timeline?this.timeline.getTime():this.animationProps.engineTime}async _initDevice(){if(this.device=await this.props.device,!this.device)throw new Error("No device provided");this.canvas=this.device.getDefaultCanvasContext().canvas||null}_createInfoDiv(){if(this.canvas&&this.props.onAddHTML){const e=document.createElement("div");document.body.appendChild(e),e.style.position="relative";const r=document.createElement("div");r.style.position="absolute",r.style.left="10px",r.style.bottom="10px",r.style.width="300px",r.style.background="white",this.canvas instanceof HTMLCanvasElement&&e.appendChild(this.canvas),e.appendChild(r);const n=this.props.onAddHTML(r);n&&(r.innerHTML=n)}}_getSizeAndAspect(){if(!this.device)return{width:1,height:1,aspect:1};const[e,r]=this.device?.getDefaultCanvasContext().getDevicePixelSize()||[1,1];let n=1;const i=this.device?.getDefaultCanvasContext().canvas;return i&&i.clientHeight?n=i.clientWidth/i.clientHeight:e>0&&r>0&&(n=e/r),{width:e,height:r,aspect:n}}_resizeViewport(){this.props.autoResizeViewport&&this.device.gl&&this.device.gl.viewport(0,0,this.device.gl.drawingBufferWidth,this.device.gl.drawingBufferHeight)}_beginFrameTimers(){this.frameRate.timeEnd(),this.frameRate.timeStart(),this.cpuTime.timeStart()}_endFrameTimers(){this.cpuTime.timeEnd()}_startEventHandling(){this.canvas&&(this.canvas.addEventListener("mousemove",this._onMousemove.bind(this)),this.canvas.addEventListener("mouseleave",this._onMouseleave.bind(this)))}_onMousemove(e){e instanceof MouseEvent&&(this._getAnimationProps()._mousePosition=[e.offsetX,e.offsetY])}_onMouseleave(e){this._getAnimationProps()._mousePosition=null}}const nk={};function l2(t="id"){nk[t]=nk[t]||1;const e=nk[t]++;return`${t}-${e}`}class sW{id;userData={};topology;bufferLayout=[];vertexCount;indices;attributes;constructor(e){if(this.id=e.id||l2("geometry"),this.topology=e.topology,this.indices=e.indices||null,this.attributes=e.attributes,this.vertexCount=e.vertexCount,this.bufferLayout=e.bufferLayout||[],this.indices&&!(this.indices.usage&jo.INDEX))throw new Error("Index buffer must have INDEX usage")}destroy(){this.indices?.destroy();for(const e of Object.values(this.attributes))e.destroy()}getVertexCount(){return this.vertexCount}getAttributes(){return this.attributes}getIndexes(){return this.indices||null}_calculateVertexCount(e){return e.byteLength/12}}function e$e(t,e){if(e instanceof sW)return e;const r=t$e(t,e),{attributes:n,bufferLayout:i}=r$e(t,e);return new sW({topology:e.topology||"triangle-list",bufferLayout:i,vertexCount:e.vertexCount,indices:r,attributes:n})}function t$e(t,e){if(!e.indices)return;const r=e.indices.value;return t.createBuffer({usage:jo.INDEX,data:r})}function r$e(t,e){const r=[],n={};for(const[a,s]of Object.entries(e.attributes)){let o=a;switch(a){case"POSITION":o="positions";break;case"NORMAL":o="normals";break;case"TEXCOORD_0":o="texCoords";break;case"COLOR_0":o="colors";break}if(s){n[o]=t.createBuffer({data:s.value,id:`${a}-buffer`});const{value:c,size:f,normalized:d}=s;r.push({name:o,format:Kze(c,f,d)})}}const i=e._calculateVertexCount(e.attributes,e.indices);return{attributes:n,bufferLayout:r,vertexCount:i}}class p6{static defaultProps={...qm.defaultProps};static getDefaultPipelineFactory(e){return e._lumaData.defaultPipelineFactory=e._lumaData.defaultPipelineFactory||new p6(e),e._lumaData.defaultPipelineFactory}device;cachingEnabled;destroyPolicy;debug;_hashCounter=0;_hashes={};_renderPipelineCache={};_computePipelineCache={};get[Symbol.toStringTag](){return"PipelineFactory"}toString(){return`PipelineFactory(${this.device.id})`}constructor(e){this.device=e,this.cachingEnabled=e.props._cachePipelines,this.destroyPolicy=e.props._cacheDestroyPolicy,this.debug=e.props.debugFactories}createRenderPipeline(e){if(!this.cachingEnabled)return this.device.createRenderPipeline(e);const r={...qm.defaultProps,...e},n=this._renderPipelineCache,i=this._hashRenderPipeline(r);let a=n[i]?.pipeline;return a?(n[i].useCount++,this.debug&&rn.log(3,`${this}: ${n[i].pipeline} reused, count=${n[i].useCount}, (id=${e.id})`)()):(a=this.device.createRenderPipeline({...r,id:r.id?`${r.id}-cached`:l2("unnamed-cached")}),a.hash=i,n[i]={pipeline:a,useCount:1},this.debug&&rn.log(3,`${this}: ${a} created, count=${n[i].useCount}`)()),a}createComputePipeline(e){if(!this.cachingEnabled)return this.device.createComputePipeline(e);const r={...hT.defaultProps,...e},n=this._computePipelineCache,i=this._hashComputePipeline(r);let a=n[i]?.pipeline;return a?(n[i].useCount++,this.debug&&rn.log(3,`${this}: ${n[i].pipeline} reused, count=${n[i].useCount}, (id=${e.id})`)()):(a=this.device.createComputePipeline({...r,id:r.id?`${r.id}-cached`:void 0}),a.hash=i,n[i]={pipeline:a,useCount:1},this.debug&&rn.log(3,`${this}: ${a} created, count=${n[i].useCount}`)()),a}release(e){if(!this.cachingEnabled){e.destroy();return}const r=this._getCache(e),n=e.hash;r[n].useCount--,r[n].useCount===0?(this._destroyPipeline(e),this.debug&&rn.log(3,`${this}: ${e} released and destroyed`)()):r[n].useCount<0?(rn.error(`${this}: ${e} released, useCount < 0, resetting`)(),r[n].useCount=0):this.debug&&rn.log(3,`${this}: ${e} released, count=${r[n].useCount}`)()}_destroyPipeline(e){const r=this._getCache(e);switch(this.destroyPolicy){case"never":return!1;case"unused":return delete r[e.hash],e.destroy(),!0}}_getCache(e){let r;if(e instanceof hT&&(r=this._computePipelineCache),e instanceof qm&&(r=this._renderPipelineCache),!r)throw new Error(`${this}`);if(!r[e.hash])throw new Error(`${this}: ${e} matched incorrect entry`);return r}_hashComputePipeline(e){const{type:r}=this.device,n=this._getHash(e.shader.source);return`${r}/C/${n}`}_hashRenderPipeline(e){const r=e.vs?this._getHash(e.vs.source):0,n=e.fs?this._getHash(e.fs.source):0,i="-",a=this._getHash(JSON.stringify(e.bufferLayout)),{type:s}=this.device;switch(s){case"webgl":return`${s}/R/${r}/${n}V${i}BL${a}`;case"webgpu":default:const o=this._getHash(JSON.stringify(e.parameters));return`${s}/R/${r}/${n}V${i}T${e.topology}P${o}BL${a}`}}_getHash(e){return this._hashes[e]===void 0&&(this._hashes[e]=this._hashCounter++),this._hashes[e]}}class g6{static defaultProps={...K3.defaultProps};static getDefaultShaderFactory(e){return e._lumaData.defaultShaderFactory||=new g6(e),e._lumaData.defaultShaderFactory}device;cachingEnabled;destroyPolicy;debug;_cache={};get[Symbol.toStringTag](){return"ShaderFactory"}toString(){return`${this[Symbol.toStringTag]}(${this.device.id})`}constructor(e){this.device=e,this.cachingEnabled=e.props._cacheShaders,this.destroyPolicy=e.props._cacheDestroyPolicy,this.debug=!0}createShader(e){if(!this.cachingEnabled)return this.device.createShader(e);const r=this._hashShader(e);let n=this._cache[r];if(n)n.useCount++,this.debug&&rn.log(3,`${this}: Reusing shader ${n.shader.id} count=${n.useCount}`)();else{const i=this.device.createShader({...e,id:e.id?`${e.id}-cached`:void 0});this._cache[r]=n={shader:i,useCount:1},this.debug&&rn.log(3,`${this}: Created new shader ${i.id}`)()}return n.shader}release(e){if(!this.cachingEnabled){e.destroy();return}const r=this._hashShader(e),n=this._cache[r];if(n)if(n.useCount--,n.useCount===0)this.destroyPolicy==="unused"&&(delete this._cache[r],n.shader.destroy(),this.debug&&rn.log(3,`${this}: Releasing shader ${e.id}, destroyed`)());else{if(n.useCount<0)throw new Error(`ShaderFactory: Shader ${e.id} released too many times`);this.debug&&rn.log(3,`${this}: Releasing shader ${e.id} count=${n.useCount}`)()}}_hashShader(e){return`${e.stage}:${e.source}`}}function n$e(t,e){const r={},n="Values";if(t.attributes.length===0&&!t.varyings?.length)return{"No attributes or varyings":{[n]:"N/A"}};for(const i of t.attributes)if(i){const a=`${i.location} ${i.name}: ${i.type}`;r[`in ${a}`]={[n]:i.stepMode||"vertex"}}for(const i of t.varyings||[]){const a=`${i.location} ${i.name}`;r[`out ${a}`]={[n]:JSON.stringify(i)}}return r}let ru=null,ik=null;function i$e(t,{id:e,minimap:r,opaque:n,top:i="0",left:a="0",rgbaScale:s=1}){ru||(ru=document.createElement("canvas"),ru.id=e,ru.title=e,ru.style.zIndex="100",ru.style.position="absolute",ru.style.top=i,ru.style.left=a,ru.style.border="blue 5px solid",ru.style.transform="scaleY(-1)",document.body.appendChild(ru),ik=ru.getContext("2d")),(ru.width!==t.width||ru.height!==t.height)&&(ru.width=t.width/2,ru.height=t.height/2,ru.style.width="400px",ru.style.height="400px");const o=t.device.readPixelsToArrayWebGL(t),c=ik?.createImageData(t.width,t.height);if(c){for(let d=0;d<o.length;d+=4)c.data[0+d+0]=o[d+0]*s,c.data[0+d+1]=o[d+1]*s,c.data[0+d+2]=o[d+2]*s,c.data[0+d+3]=n?255:o[d+3]*s;ik?.putImageData(c,0,0)}}function gD(t,e,r){if(t===e)return!0;if(!r||!t||!e)return!1;if(Array.isArray(t)){if(!Array.isArray(e)||t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(!gD(t[n],e[n],r-1))return!1;return!0}if(Array.isArray(e))return!1;if(typeof t=="object"&&typeof e=="object"){const n=Object.keys(t),i=Object.keys(e);if(n.length!==i.length)return!1;for(const a of n)if(!e.hasOwnProperty(a)||!gD(t[a],e[a],r-1))return!1;return!0}return!1}class ak{bufferLayouts;constructor(e){this.bufferLayouts=e}getBufferLayout(e){return this.bufferLayouts.find(r=>r.name===e)||null}getAttributeNamesForBuffer(e){return e.attributes?e.attributes?.map(r=>r.attribute):[e.name]}mergeBufferLayouts(e,r){const n=[...e];for(const i of r){const a=n.findIndex(s=>s.name===i.name);a<0?n.push(i):n[a]=i}return n}getBufferIndex(e){const r=this.bufferLayouts.findIndex(n=>n.name===e);return r===-1&&rn.warn(`BufferLayout: Missing buffer for "${e}".`)(),r}}function a$e(t,e){const r=Object.fromEntries(t.attributes.map(i=>[i.name,i.location])),n=e.slice();return n.sort((i,a)=>{const s=i.attributes?i.attributes.map(d=>d.attribute):[i.name],o=a.attributes?a.attributes.map(d=>d.attribute):[a.name],c=Math.min(...s.map(d=>r[d])),f=Math.min(...o.map(d=>r[d]));return c-f}),n}function o$e(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function s$e(t){return Array.isArray(t)?t.length===0||typeof t[0]=="number":!1}function l$e(t){return o$e(t)||s$e(t)}function u$e(t){return l$e(t)||typeof t=="number"||typeof t=="boolean"}function c$e(t){const e={bindings:{},uniforms:{}};return Object.keys(t).forEach(r=>{const n=t[r];u$e(n)?e.uniforms[r]=n:e.bindings[r]=n}),e}class f$e{options={disableWarnings:!1};modules;moduleUniforms;moduleBindings;constructor(e,r){Object.assign(this.options,r);const n=UL(Object.values(e).filter(i=>i.dependencies));for(const i of n)e[i.name]=i;rn.log(1,"Creating ShaderInputs with modules",Object.keys(e))(),this.modules=e,this.moduleUniforms={},this.moduleBindings={};for(const[i,a]of Object.entries(e))this._addModule(a),a.name&&i!==a.name&&!this.options.disableWarnings&&rn.warn(`Module name: ${i} vs ${a.name}`)()}destroy(){}setProps(e){for(const r of Object.keys(e)){const n=r,i=e[n]||{},a=this.modules[n];if(!a){this.options.disableWarnings||rn.warn(`Module ${r} not found`)();continue}const s=this.moduleUniforms[n],o=this.moduleBindings[n],c=a.getUniforms?.(i,s)||i,{uniforms:f,bindings:d}=c$e(c);this.moduleUniforms[n]={...s,...f},this.moduleBindings[n]={...o,...d}}}getModules(){return Object.values(this.modules)}getUniformValues(){return this.moduleUniforms}getBindingValues(){const e={};for(const r of Object.values(this.moduleBindings))Object.assign(e,r);return e}getDebugTable(){const e={};for(const[r,n]of Object.entries(this.moduleUniforms))for(const[i,a]of Object.entries(n))e[`${r}.${i}`]={type:this.modules[r].uniformTypes?.[i],value:String(a)};return e}_addModule(e){const r=e.name;this.moduleUniforms[r]=e.defaultUniforms||{},this.moduleBindings[r]={}}}let h$e="";async function d$e(t,e){const r=new Image;return r.crossOrigin="anonymous",r.src=t.startsWith("http")?t:h$e+t,await r.decode(),e?await createImageBitmap(r,e):await createImageBitmap(r)}const p$e=["+X","-X","+Y","-Y","+Z","-Z"],g$e=["+X","-X","+Y","-Y","+Z","-Z"];class Ab{device;id;props;texture;sampler;view;ready;isReady=!1;destroyed=!1;resolveReady=()=>{};rejectReady=()=>{};get[Symbol.toStringTag](){return"AsyncTexture"}toString(){return`AsyncTexture:"${this.id}"(${this.isReady?"ready":"loading"})`}constructor(e,r){this.device=e;const n=l2("async-texture");this.props={...Ab.defaultProps,id:n,...r},this.id=this.props.id,r={...r},typeof r?.data=="string"&&r.dimension==="2d"&&(r.data=d$e(r.data)),r.mipmaps&&(r.mipLevels="auto"),this.ready=new Promise((i,a)=>{this.resolveReady=()=>{this.isReady=!0,i()},this.rejectReady=a}),this.initAsync(r)}async initAsync(e){const r=e.data,n=await hne(r).then(void 0,this.rejectReady);if(this.destroyed)return;const i=this.props.width&&this.props.height?{width:this.props.width,height:this.props.height}:this.getTextureDataSize(n);if(!i)throw new Error("Texture size could not be determined");const a={...i,...e,data:void 0,mipLevels:1},s=this.device.getMipLevelCount(a.width,a.height);if(a.mipLevels=this.props.mipLevels==="auto"?s:Math.min(s,this.props.mipLevels),this.texture=this.device.createTexture(a),this.sampler=this.texture.sampler,this.view=this.texture.view,e.data)switch(this.props.dimension){case"1d":this._setTexture1DData(this.texture,n);break;case"2d":this._setTexture2DData(n);break;case"3d":this._setTexture3DData(this.texture,n);break;case"2d-array":this._setTextureArrayData(this.texture,n);break;case"cube":this._setTextureCubeData(this.texture,n);break;case"cube-array":this._setTextureCubeArrayData(this.texture,n);break}this.props.mipmaps&&this.generateMipmaps(),rn.info(1,`${this} loaded`),this.resolveReady()}destroy(){this.texture&&(this.texture.destroy(),this.texture=null),this.destroyed=!0}generateMipmaps(){this.texture.generateMipmapsWebGL()}setSampler(e={}){this.texture.setSampler(e instanceof dy?e:this.device.createSampler(e))}resize(e){if(!this.isReady)throw new Error("Cannot resize texture before it is ready");if(e.width===this.texture.width&&e.height===this.texture.height)return!1;if(this.texture){const r=this.texture;this.texture=r.clone(e),r.destroy()}return!0}isTextureLevelData(e){const r=e?.data;return ArrayBuffer.isView(r)}getTextureDataSize(e){if(!e||ArrayBuffer.isView(e))return null;if(Array.isArray(e))return this.getTextureDataSize(e[0]);if(this.device.isExternalImage(e))return this.device.getExternalImageSize(e);if(e&&typeof e=="object"&&e.constructor===Object){const n=Object.values(e)[0];return{width:n.width,height:n.height}}throw new Error("texture size deduction failed")}getCubeFaceDepth(e){switch(e){case"+X":return 0;case"-X":return 1;case"+Y":return 2;case"-Y":return 3;case"+Z":return 4;case"-Z":return 5;default:throw new Error(e)}}setTextureData(e){}_setTexture1DData(e,r){throw new Error("setTexture1DData not supported in WebGL.")}_setTexture2DData(e,r=0){if(!this.texture)throw new Error("Texture not initialized");const n=this._normalizeTextureData(e);n.length>1&&this.props.mipmaps!==!1&&rn.warn(`Texture ${this.id} mipmap and multiple LODs.`)();for(let i=0;i<n.length;i++){const a=n[i];this.device.isExternalImage(a)?this.texture.copyExternalImage({image:a,depth:r,mipLevel:i,flipY:!0}):this.texture.copyImageData({data:a.data,mipLevel:i})}}_setTexture3DData(e,r){if(this.texture?.props.dimension!=="3d")throw new Error(this.id);for(let n=0;n<r.length;n++)this._setTexture2DData(r[n],n)}_setTextureCubeData(e,r){if(this.texture?.props.dimension!=="cube")throw new Error(this.id);for(const[n,i]of Object.entries(r)){const a=g$e.indexOf(n);this._setTexture2DData(i,a)}}_setTextureArrayData(e,r){if(this.texture?.props.dimension!=="2d-array")throw new Error(this.id);for(let n=0;n<r.length;n++)this._setTexture2DData(r[n],n)}_setTextureCubeArrayData(e,r){throw new Error("setTextureCubeArrayData not supported in WebGL2.")}_setTextureCubeFaceData(e,r,n,i=0){Array.isArray(r)&&r.length>1&&this.props.mipmaps!==!1&&rn.warn(`${this.id} has mipmap and multiple LODs.`)();const a=p$e.indexOf(n);this._setTexture2DData(r,a)}_normalizeTextureData(e){const r=this.texture;let n;return ArrayBuffer.isView(e)?n=[{data:e,width:r.width,height:r.height}]:Array.isArray(e)?n=e:n=[e],n}static defaultProps={...Fl.defaultProps,data:null,mipmaps:!1}}async function hne(t){if(t=await t,Array.isArray(t))return await Promise.all(t.map(hne));if(t&&typeof t=="object"&&t.constructor===Object){const e=t,r=await Promise.all(Object.values(e)),n=Object.keys(e),i={};for(let a=0;a<n.length;a++)i[n[a]]=r[a];return i}return t}const gm=2,m$e=1e4;class ET{static defaultProps={...qm.defaultProps,source:void 0,vs:null,fs:null,id:"unnamed",handle:void 0,userData:{},defines:{},modules:[],geometry:null,indexBuffer:null,attributes:{},constantAttributes:{},varyings:[],isInstanced:void 0,instanceCount:0,vertexCount:0,shaderInputs:void 0,pipelineFactory:void 0,shaderFactory:void 0,transformFeedback:void 0,shaderAssembler:Mm.getDefaultShaderAssembler(),debugShaders:void 0,disableWarnings:void 0};device;id;source;vs;fs;pipelineFactory;shaderFactory;userData={};parameters;topology;bufferLayout;isInstanced=void 0;instanceCount=0;vertexCount;indexBuffer=null;bufferAttributes={};constantAttributes={};bindings={};vertexArray;transformFeedback=null;pipeline;shaderInputs;_uniformStore;_attributeInfos={};_gpuGeometry=null;props;_pipelineNeedsUpdate="newly created";_needsRedraw="initializing";_destroyed=!1;_lastDrawTimestamp=-1;get[Symbol.toStringTag](){return"Model"}toString(){return`Model(${this.id})`}constructor(e,r){this.props={...ET.defaultProps,...r},r=this.props,this.id=r.id||l2("model"),this.device=e,Object.assign(this.userData,r.userData);const n=Object.fromEntries(this.props.modules?.map(c=>[c.name,c])||[]),i=r.shaderInputs||new f$e(n,{disableWarnings:this.props.disableWarnings});this.setShaderInputs(i);const a=v$e(e),s=(this.props.modules?.length>0?this.props.modules:this.shaderInputs?.getModules())||[];if(this.device.type==="webgpu"&&this.props.source){const{source:c,getUniforms:f}=this.props.shaderAssembler.assembleWGSLShader({platformInfo:a,...this.props,modules:s});this.source=c,this._getModuleUniforms=f,this.props.shaderLayout||=E7e(this.source)}else{const{vs:c,fs:f,getUniforms:d}=this.props.shaderAssembler.assembleGLSLShaderPair({platformInfo:a,...this.props,modules:s});this.vs=c,this.fs=f,this._getModuleUniforms=d}this.vertexCount=this.props.vertexCount,this.instanceCount=this.props.instanceCount,this.topology=this.props.topology,this.bufferLayout=this.props.bufferLayout,this.parameters=this.props.parameters,r.geometry&&this.setGeometry(r.geometry),this.pipelineFactory=r.pipelineFactory||p6.getDefaultPipelineFactory(this.device),this.shaderFactory=r.shaderFactory||g6.getDefaultShaderFactory(this.device),this.pipeline=this._updatePipeline(),this.vertexArray=e.createVertexArray({shaderLayout:this.pipeline.shaderLayout,bufferLayout:this.pipeline.bufferLayout}),this._gpuGeometry&&this._setGeometryAttributes(this._gpuGeometry),"isInstanced"in r&&(this.isInstanced=r.isInstanced),r.instanceCount&&this.setInstanceCount(r.instanceCount),r.vertexCount&&this.setVertexCount(r.vertexCount),r.indexBuffer&&this.setIndexBuffer(r.indexBuffer),r.attributes&&this.setAttributes(r.attributes),r.constantAttributes&&this.setConstantAttributes(r.constantAttributes),r.bindings&&this.setBindings(r.bindings),r.transformFeedback&&(this.transformFeedback=r.transformFeedback),Object.seal(this)}destroy(){this._destroyed||(this.pipelineFactory.release(this.pipeline),this.shaderFactory.release(this.pipeline.vs),this.pipeline.fs&&this.shaderFactory.release(this.pipeline.fs),this._uniformStore.destroy(),this._gpuGeometry?.destroy(),this._destroyed=!0)}needsRedraw(){this._getBindingsUpdateTimestamp()>this._lastDrawTimestamp&&this.setNeedsRedraw("contents of bound textures or buffers updated");const e=this._needsRedraw;return this._needsRedraw=!1,e}setNeedsRedraw(e){this._needsRedraw||=e}predraw(){this.updateShaderInputs(),this.pipeline=this._updatePipeline()}draw(e){const r=this._areBindingsLoading();if(r)return rn.info(gm,`>>> DRAWING ABORTED ${this.id}: ${r} not loaded`)(),!1;try{e.pushDebugGroup(`${this}.predraw(${e})`),this.predraw()}finally{e.popDebugGroup()}let n;try{e.pushDebugGroup(`${this}.draw(${e})`),this._logDrawCallStart(),this.pipeline=this._updatePipeline();const i=this._getBindings();this.pipeline.setBindings(i,{disableWarnings:this.props.disableWarnings});const{indexBuffer:a}=this.vertexArray,s=a?a.byteLength/(a.indexType==="uint32"?4:2):void 0;n=this.pipeline.draw({renderPass:e,vertexArray:this.vertexArray,isInstanced:this.isInstanced,vertexCount:this.vertexCount,instanceCount:this.instanceCount,indexCount:s,transformFeedback:this.transformFeedback||void 0,parameters:this.parameters,topology:this.topology})}finally{e.popDebugGroup(),this._logDrawCallEnd()}return this._logFramebuffer(e),n?(this._lastDrawTimestamp=this.device.timestamp,this._needsRedraw=!1):this._needsRedraw="waiting for resource initialization",n}setGeometry(e){this._gpuGeometry?.destroy();const r=e&&e$e(this.device,e);if(r){this.setTopology(r.topology||"triangle-list");const n=new ak(this.bufferLayout);this.bufferLayout=n.mergeBufferLayouts(r.bufferLayout,this.bufferLayout),this.vertexArray&&this._setGeometryAttributes(r)}this._gpuGeometry=r}setTopology(e){e!==this.topology&&(this.topology=e,this._setPipelineNeedsUpdate("topology"))}setBufferLayout(e){const r=new ak(this.bufferLayout);this.bufferLayout=this._gpuGeometry?r.mergeBufferLayouts(e,this._gpuGeometry.bufferLayout):e,this._setPipelineNeedsUpdate("bufferLayout"),this.pipeline=this._updatePipeline(),this.vertexArray=this.device.createVertexArray({shaderLayout:this.pipeline.shaderLayout,bufferLayout:this.pipeline.bufferLayout}),this._gpuGeometry&&this._setGeometryAttributes(this._gpuGeometry)}setParameters(e){gD(e,this.parameters,2)||(this.parameters=e,this._setPipelineNeedsUpdate("parameters"))}setInstanceCount(e){this.instanceCount=e,this.isInstanced===void 0&&e>0&&(this.isInstanced=!0),this.setNeedsRedraw("instanceCount")}setVertexCount(e){this.vertexCount=e,this.setNeedsRedraw("vertexCount")}setShaderInputs(e){this.shaderInputs=e,this._uniformStore=new X9e(this.shaderInputs.modules);for(const[r,n]of Object.entries(this.shaderInputs.modules))if(y$e(n)){const i=this._uniformStore.getManagedUniformBuffer(this.device,r);this.bindings[`${r}Uniforms`]=i}this.setNeedsRedraw("shaderInputs")}updateShaderInputs(){this._uniformStore.setUniforms(this.shaderInputs.getUniformValues()),this.setBindings(this.shaderInputs.getBindingValues()),this.setNeedsRedraw("shaderInputs")}setBindings(e){Object.assign(this.bindings,e),this.setNeedsRedraw("bindings")}setTransformFeedback(e){this.transformFeedback=e,this.setNeedsRedraw("transformFeedback")}setIndexBuffer(e){this.vertexArray.setIndexBuffer(e),this.setNeedsRedraw("indexBuffer")}setAttributes(e,r){const n=r?.disableWarnings??this.props.disableWarnings;e.indices&&rn.warn(`Model:${this.id} setAttributes() - indexBuffer should be set using setIndexBuffer()`)(),this.bufferLayout=a$e(this.pipeline.shaderLayout,this.bufferLayout);const i=new ak(this.bufferLayout);for(const[a,s]of Object.entries(e)){const o=i.getBufferLayout(a);if(!o){n||rn.warn(`Model(${this.id}): Missing layout for buffer "${a}".`)();continue}const c=i.getAttributeNamesForBuffer(o);let f=!1;for(const d of c){const m=this._attributeInfos[d];if(m){const b=this.device.type==="webgpu"?i.getBufferIndex(m.bufferName):m.location;this.vertexArray.setBuffer(b,s),f=!0}}!f&&!n&&rn.warn(`Model(${this.id}): Ignoring buffer "${s.id}" for unknown attribute "${a}"`)()}this.setNeedsRedraw("attributes")}setConstantAttributes(e,r){for(const[n,i]of Object.entries(e)){const a=this._attributeInfos[n];a?this.vertexArray.setConstantWebGL(a.location,i):(r?.disableWarnings??this.props.disableWarnings)||rn.warn(`Model "${this.id}: Ignoring constant supplied for unknown attribute "${n}"`)()}this.setNeedsRedraw("constants")}_areBindingsLoading(){for(const e of Object.values(this.bindings))if(e instanceof Ab&&!e.isReady)return e.id;return!1}_getBindings(){const e={};for(const[r,n]of Object.entries(this.bindings))n instanceof Ab?n.isReady&&(e[r]=n.texture):e[r]=n;return e}_getBindingsUpdateTimestamp(){let e=0;for(const r of Object.values(this.bindings))r instanceof Z3?e=Math.max(e,r.texture.updateTimestamp):r instanceof jo||r instanceof Fl?e=Math.max(e,r.updateTimestamp):r instanceof Ab?e=r.texture?Math.max(e,r.texture.updateTimestamp):1/0:r instanceof dy||(e=Math.max(e,r.buffer.updateTimestamp));return e}_setGeometryAttributes(e){const r={...e.attributes};for(const[n]of Object.entries(r))!this.pipeline.shaderLayout.attributes.find(i=>i.name===n)&&n!=="positions"&&delete r[n];this.vertexCount=e.vertexCount,this.setIndexBuffer(e.indices||null),this.setAttributes(e.attributes,{disableWarnings:!0}),this.setAttributes(r,{disableWarnings:this.props.disableWarnings}),this.setNeedsRedraw("geometry attributes")}_setPipelineNeedsUpdate(e){this._pipelineNeedsUpdate||=e,this.setNeedsRedraw(e)}_updatePipeline(){if(this._pipelineNeedsUpdate){let e=null,r=null;this.pipeline&&(rn.log(1,`Model ${this.id}: Recreating pipeline because "${this._pipelineNeedsUpdate}".`)(),e=this.pipeline.vs,r=this.pipeline.fs),this._pipelineNeedsUpdate=!1;const n=this.shaderFactory.createShader({id:`${this.id}-vertex`,stage:"vertex",source:this.source||this.vs,debugShaders:this.props.debugShaders});let i=null;this.source?i=n:this.fs&&(i=this.shaderFactory.createShader({id:`${this.id}-fragment`,stage:"fragment",source:this.source||this.fs,debugShaders:this.props.debugShaders})),this.pipeline=this.pipelineFactory.createRenderPipeline({...this.props,bufferLayout:this.bufferLayout,topology:this.topology,parameters:this.parameters,bindings:this._getBindings(),vs:n,fs:i}),this._attributeInfos=gre(this.pipeline.shaderLayout,this.bufferLayout),e&&this.shaderFactory.release(e),r&&this.shaderFactory.release(r)}return this.pipeline}_lastLogTime=0;_logOpen=!1;_logDrawCallStart(){const e=rn.level>3?0:m$e;rn.level<2||Date.now()-this._lastLogTime<e||(this._lastLogTime=Date.now(),this._logOpen=!0,rn.group(gm,`>>> DRAWING MODEL ${this.id}`,{collapsed:rn.level<=2})())}_logDrawCallEnd(){if(this._logOpen){const e=n$e(this.pipeline.shaderLayout,this.id);rn.table(gm,e)();const r=this.shaderInputs.getDebugTable();rn.table(gm,r)();const n=this._getAttributeDebugTable();rn.table(gm,this._attributeInfos)(),rn.table(gm,n)(),rn.groupEnd(gm)(),this._logOpen=!1}}_drawCount=0;_logFramebuffer(e){const r=this.device.props.debugFramebuffers;if(this._drawCount++,!r)return;const n=e.props.framebuffer;n&&i$e(n,{id:n.id,minimap:!0})}_getAttributeDebugTable(){const e={};for(const[r,n]of Object.entries(this._attributeInfos)){const i=this.vertexArray.attributes[n.location];e[n.location]={name:r,type:n.shaderType,values:i?this._getBufferOrConstantValues(i,n.bufferDataType):"null"}}if(this.vertexArray.indexBuffer){const{indexBuffer:r}=this.vertexArray,n=r.indexType==="uint32"?new Uint32Array(r.debugData):new Uint16Array(r.debugData);e.indices={name:"indices",type:r.indexType,values:n.toString()}}return e}_getBufferOrConstantValues(e,r){const n=$L(r);return(e instanceof jo?new n(e.debugData):e).toString()}}function y$e(t){return!!(t.uniformTypes&&!_$e(t.uniformTypes))}function v$e(t){return{type:t.type,shaderLanguage:t.info.shadingLanguage,shaderLanguageVersion:t.info.shadingLanguageVersion,gpu:t.info.gpu,features:t.features}}function _$e(t){for(const e in t)return!1;return!0}class l_{device;model;transformFeedback;static defaultProps={...ET.defaultProps,outputs:void 0,feedbackBuffers:void 0};static isSupported(e){return e?.info?.type==="webgl"}constructor(e,r=l_.defaultProps){if(!l_.isSupported(e))throw new Error("BufferTransform not yet implemented on WebGPU");this.device=e,this.model=new ET(this.device,{id:r.id||"buffer-transform-model",fs:r.fs||$ze(),topology:r.topology||"point-list",varyings:r.outputs||r.varyings,...r}),this.transformFeedback=this.device.createTransformFeedback({layout:this.model.pipeline.shaderLayout,buffers:r.feedbackBuffers}),this.model.setTransformFeedback(this.transformFeedback),Object.seal(this)}destroy(){this.model&&this.model.destroy()}delete(){this.destroy()}run(e){e?.inputBuffers&&this.model.setAttributes(e.inputBuffers),e?.outputBuffers&&this.transformFeedback.setBuffers(e.outputBuffers);const r=this.device.beginRenderPass(e);this.model.draw(r),r.end()}getBuffer(e){return this.transformFeedback.getBuffer(e)}readAsync(e){const r=this.getBuffer(e);if(!r)throw new Error("BufferTransform#getBuffer");if(r instanceof jo)return r.readAsync();const{buffer:n,byteOffset:i=0,byteLength:a=n.byteLength}=r;return n.readAsync(i,a)}}class cXe{id;topology;vertexCount;indices;attributes;userData={};constructor(e){const{attributes:r={},indices:n=null,vertexCount:i=null}=e;this.id=e.id||l2("geometry"),this.topology=e.topology,n&&(this.indices=ArrayBuffer.isView(n)?{value:n,size:1}:n),this.attributes={};for(const[a,s]of Object.entries(r)){const o=ArrayBuffer.isView(s)?{value:s}:s;if(!ArrayBuffer.isView(o.value))throw new Error(`${this._print(a)}: must be typed array or object with value as typed array`);if((a==="POSITION"||a==="positions")&&!o.size&&(o.size=3),a==="indices"){if(this.indices)throw new Error("Multiple indices detected");this.indices=o}else this.attributes[a]=o}this.indices&&this.indices.isIndexed!==void 0&&(this.indices=Object.assign({},this.indices),delete this.indices.isIndexed),this.vertexCount=i||this._calculateVertexCount(this.attributes,this.indices)}getVertexCount(){return this.vertexCount}getAttributes(){return this.indices?{indices:this.indices,...this.attributes}:this.attributes}_print(e){return`Geometry ${this.id} attribute ${e}`}_setAttributes(e,r){return this}_calculateVertexCount(e,r){if(r)return r.value.length;let n=1/0;for(const i of Object.values(e)){const{value:a,size:s,constant:o}=i;!o&&a&&s!==void 0&&s>=1&&(n=Math.min(n,a.length/s))}return n}}const b$e={blendColorOperation:"add",blendColorSrcFactor:"one",blendColorDstFactor:"zero",blendAlphaOperation:"add",blendAlphaSrcFactor:"constant",blendAlphaDstFactor:"zero"};class dne extends h6{constructor(){super(...arguments),this._colorEncoderState=null}render(e){return"pickingFBO"in e?this._drawPickingBuffer(e):super.render(e)}_drawPickingBuffer({layers:e,layerFilter:r,views:n,viewports:i,onViewportActive:a,pickingFBO:s,deviceRect:{x:o,y:c,width:f,height:d},cullRect:m,effects:b,pass:x="picking",pickZ:E,shaderModuleProps:T}){this.pickZ=E;const A=this._resetColorEncoder(E),M=[o,c,f,d],F=super.render({target:s,layers:e,layerFilter:r,views:n,viewports:i,onViewportActive:a,cullRect:m,effects:b?.filter(O=>O.useInPicking),pass:x,isPicking:!0,shaderModuleProps:T,clearColor:[0,0,0,0],colorMask:15,scissorRect:M});return this._colorEncoderState=null,{decodePickingColor:A&&w$e.bind(null,A),stats:F}}shouldDrawLayer(e){const{pickable:r,operation:n}=e.props;return r&&n.includes("draw")||n.includes("terrain")||n.includes("mask")}getShaderModuleProps(e,r,n){return{picking:{isActive:1,isAttribute:this.pickZ},lighting:{enabled:!1}}}getLayerParameters(e,r,n){const i={...e.props.parameters},{pickable:a,operation:s}=e.props;return!this._colorEncoderState||s.includes("terrain")?i.blend=!1:a&&s.includes("draw")&&(Object.assign(i,b$e),i.blend=!0,i.blendColor=x$e(this._colorEncoderState,e,n)),i}_resetColorEncoder(e){return this._colorEncoderState=e?null:{byLayer:new Map,byAlpha:[]},this._colorEncoderState}}function x$e(t,e,r){const{byLayer:n,byAlpha:i}=t;let a,s=n.get(e);return s?(s.viewports.push(r),a=s.a):(a=n.size+1,a<=255?(s={a,layer:e,viewports:[r]},n.set(e,s),i[a]=s):(po.warn("Too many pickable layers, only picking the first 255")(),a=0)),[0,0,0,a/255]}function w$e(t,e){const r=t.byAlpha[e[3]];return r&&{pickedLayer:r.layer,pickedViewports:r.viewports,pickedObjectIndex:r.layer.decodePickingColor(e)}}const i0={NO_STATE:"Awaiting state",MATCHED:"Matched. State transferred from previous layer",INITIALIZED:"Initialized",AWAITING_GC:"Discarded. Awaiting garbage collection",AWAITING_FINALIZATION:"No longer matched. Awaiting garbage collection",FINALIZED:"Finalized! Awaiting garbage collection"},TT=Symbol.for("component"),Gm=Symbol.for("propTypes"),ok=Symbol.for("deprecatedProps"),N0=Symbol.for("asyncPropDefaults"),vy=Symbol.for("asyncPropOriginal"),yg=Symbol.for("asyncPropResolved");function Dg(t,e=()=>!0){return Array.isArray(t)?pne(t,e,[]):e(t)?[t]:[]}function pne(t,e,r){let n=-1;for(;++n<t.length;){const i=t[n];Array.isArray(i)?pne(i,e,r):e(i)&&r.push(i)}return r}function S$e({target:t,source:e,start:r=0,count:n=1}){const i=e.length,a=n*i;let s=0;for(let o=r;s<i;s++)t[o++]=e[s];for(;s<a;)s<a-s?(t.copyWithin(r+s,r,r+s),s*=2):(t.copyWithin(r+s,r,r+a-s),s=a);return t}class E$e{constructor(e,r,n){this._loadCount=0,this._subscribers=new Set,this.id=e,this.context=n,this.setData(r)}subscribe(e){this._subscribers.add(e)}unsubscribe(e){this._subscribers.delete(e)}inUse(){return this._subscribers.size>0}delete(){}getData(){return this.isLoaded?this._error?Promise.reject(this._error):this._content:this._loader.then(()=>this.getData())}setData(e,r){if(e===this._data&&!r)return;this._data=e;const n=++this._loadCount;let i=e;typeof e=="string"&&(i=YM(e)),i instanceof Promise?(this.isLoaded=!1,this._loader=i.then(a=>{this._loadCount===n&&(this.isLoaded=!0,this._error=void 0,this._content=a)}).catch(a=>{this._loadCount===n&&(this.isLoaded=!0,this._error=a||!0)})):(this.isLoaded=!0,this._error=void 0,this._content=e);for(const a of this._subscribers)a.onChange(this.getData())}}class T$e{constructor(e){this.protocol=e.protocol||"resource://",this._context={device:e.device,gl:e.device?.gl,resourceManager:this},this._resources={},this._consumers={},this._pruneRequest=null}contains(e){return e.startsWith(this.protocol)?!0:e in this._resources}add({resourceId:e,data:r,forceUpdate:n=!1,persistent:i=!0}){let a=this._resources[e];a?a.setData(r,n):(a=new E$e(e,r,this._context),this._resources[e]=a),a.persistent=i}remove(e){const r=this._resources[e];r&&(r.delete(),delete this._resources[e])}unsubscribe({consumerId:e}){const r=this._consumers[e];if(r){for(const n in r){const i=r[n],a=this._resources[i.resourceId];a&&a.unsubscribe(i)}delete this._consumers[e],this.prune()}}subscribe({resourceId:e,onChange:r,consumerId:n,requestId:i="default"}){const{_resources:a,protocol:s}=this;e.startsWith(s)&&(e=e.replace(s,""),a[e]||this.add({resourceId:e,data:null,persistent:!1}));const o=a[e];if(this._track(n,i,o,r),o)return o.getData()}prune(){this._pruneRequest||(this._pruneRequest=setTimeout(()=>this._prune(),0))}finalize(){for(const e in this._resources)this._resources[e].delete()}_track(e,r,n,i){const a=this._consumers,s=a[e]=a[e]||{};let o=s[r];const c=o&&o.resourceId&&this._resources[o.resourceId];c&&(c.unsubscribe(o),this.prune()),n&&(o?(o.onChange=i,o.resourceId=n.id):o={onChange:i,resourceId:n.id},s[r]=o,n.subscribe(o))}_prune(){this._pruneRequest=null;for(const e of Object.keys(this._resources)){const r=this._resources[e];!r.persistent&&!r.inUse()&&(r.delete(),delete this._resources[e])}}}const C$e="layerManager.setLayers",A$e="layerManager.activateViewport";class I$e{constructor(e,r){this._lastRenderedLayers=[],this._needsRedraw=!1,this._needsUpdate=!1,this._nextLayers=null,this._debug=!1,this._defaultShaderModulesChanged=!1,this.activateViewport=o=>{yc(A$e,this,o),o&&(this.context.viewport=o)};const{deck:n,stats:i,viewport:a,timeline:s}=r||{};this.layers=[],this.resourceManager=new T$e({device:e,protocol:"deck://"}),this.context={mousePosition:null,userData:{},layerManager:this,device:e,gl:e?.gl,deck:n,shaderAssembler:SVe(e?.info?.shadingLanguage||"glsl"),defaultShaderModules:[Dje],renderPass:void 0,stats:i||new W3({id:"deck.gl"}),viewport:a||new P_({id:"DEFAULT-INITIAL-VIEWPORT"}),timeline:s||new fne,resourceManager:this.resourceManager,onError:void 0},Object.seal(this)}finalize(){this.resourceManager.finalize();for(const e of this.layers)this._finalizeLayer(e)}needsRedraw(e={clearRedrawFlags:!1}){let r=this._needsRedraw;e.clearRedrawFlags&&(this._needsRedraw=!1);for(const n of this.layers){const i=n.getNeedsRedraw(e);r=r||i}return r}needsUpdate(){return this._nextLayers&&this._nextLayers!==this._lastRenderedLayers?"layers changed":this._defaultShaderModulesChanged?"shader modules changed":this._needsUpdate}setNeedsRedraw(e){this._needsRedraw=this._needsRedraw||e}setNeedsUpdate(e){this._needsUpdate=this._needsUpdate||e}getLayers({layerIds:e}={}){return e?this.layers.filter(r=>e.find(n=>r.id.indexOf(n)===0)):this.layers}setProps(e){"debug"in e&&(this._debug=e.debug),"userData"in e&&(this.context.userData=e.userData),"layers"in e&&(this._nextLayers=e.layers),"onError"in e&&(this.context.onError=e.onError)}setLayers(e,r){yc(C$e,this,r,e),this._lastRenderedLayers=e;const n=Dg(e,Boolean);for(const i of n)i.context=this.context;this._updateLayers(this.layers,n)}updateLayers(){const e=this.needsUpdate();e&&(this.setNeedsRedraw(`updating layers: ${e}`),this.setLayers(this._nextLayers||this._lastRenderedLayers,e)),this._nextLayers=null}addDefaultShaderModule(e){const{defaultShaderModules:r}=this.context;r.find(n=>n.name===e.name)||(r.push(e),this._defaultShaderModulesChanged=!0)}removeDefaultShaderModule(e){const{defaultShaderModules:r}=this.context,n=r.findIndex(i=>i.name===e.name);n>=0&&(r.splice(n,1),this._defaultShaderModulesChanged=!0)}_handleError(e,r,n){n.raiseError(r,`${e} of ${n}`)}_updateLayers(e,r){const n={};for(const s of e)n[s.id]?po.warn(`Multiple old layers with same id ${s.id}`)():n[s.id]=s;if(this._defaultShaderModulesChanged){for(const s of e)s.setNeedsUpdate(),s.setChangeFlags({extensionsChanged:!0});this._defaultShaderModulesChanged=!1}const i=[];this._updateSublayersRecursively(r,n,i),this._finalizeOldLayers(n);let a=!1;for(const s of i)if(s.hasUniformTransition()){a=`Uniform transition in ${s}`;break}this._needsUpdate=a,this.layers=i}_updateSublayersRecursively(e,r,n){for(const i of e){i.context=this.context;const a=r[i.id];a===null&&po.warn(`Multiple new layers with same id ${i.id}`)(),r[i.id]=null;let s=null;try{this._debug&&a!==i&&i.validateProps(),a?(this._transferLayerState(a,i),this._updateLayer(i)):this._initializeLayer(i),n.push(i),s=i.isComposite?i.getSubLayers():null}catch(o){this._handleError("matching",o,i)}s&&this._updateSublayersRecursively(s,r,n)}}_finalizeOldLayers(e){for(const r in e){const n=e[r];n&&this._finalizeLayer(n)}}_initializeLayer(e){try{e._initialize(),e.lifecycle=i0.INITIALIZED}catch(r){this._handleError("initialization",r,e)}}_transferLayerState(e,r){r._transferState(e),r.lifecycle=i0.MATCHED,r!==e&&(e.lifecycle=i0.AWAITING_GC)}_updateLayer(e){try{e._update()}catch(r){this._handleError("update",r,e)}}_finalizeLayer(e){this._needsRedraw=this._needsRedraw||`finalized ${e}`,e.lifecycle=i0.AWAITING_FINALIZATION;try{e._finalize(),e.lifecycle=i0.FINALIZED}catch(r){this._handleError("finalization",r,e)}}}function Bf(t,e,r){if(t===e)return!0;if(!r||!t||!e)return!1;if(Array.isArray(t)){if(!Array.isArray(e)||t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(!Bf(t[n],e[n],r-1))return!1;return!0}if(Array.isArray(e))return!1;if(typeof t=="object"&&typeof e=="object"){const n=Object.keys(t),i=Object.keys(e);if(n.length!==i.length)return!1;for(const a of n)if(!e.hasOwnProperty(a)||!Bf(t[a],e[a],r-1))return!1;return!0}return!1}class P$e{constructor(e){this.views=[],this.width=100,this.height=100,this.viewState={},this.controllers={},this.timeline=e.timeline,this._viewports=[],this._viewportMap={},this._isUpdating=!1,this._needsRedraw="First render",this._needsUpdate="Initialize",this._eventManager=e.eventManager,this._eventCallbacks={onViewStateChange:e.onViewStateChange,onInteractionStateChange:e.onInteractionStateChange},Object.seal(this),this.setProps(e)}finalize(){for(const e in this.controllers){const r=this.controllers[e];r&&r.finalize()}this.controllers={}}needsRedraw(e={clearRedrawFlags:!1}){const r=this._needsRedraw;return e.clearRedrawFlags&&(this._needsRedraw=!1),r}setNeedsUpdate(e){this._needsUpdate=this._needsUpdate||e,this._needsRedraw=this._needsRedraw||e}updateViewStates(){for(const e in this.controllers){const r=this.controllers[e];r&&r.updateTransition()}}getViewports(e){return e?this._viewports.filter(r=>r.containsPixel(e)):this._viewports}getViews(){const e={};return this.views.forEach(r=>{e[r.id]=r}),e}getView(e){return this.views.find(r=>r.id===e)}getViewState(e){const r=typeof e=="string"?this.getView(e):e,n=r&&this.viewState[r.getViewStateId()]||this.viewState;return r?r.filterViewState(n):n}getViewport(e){return this._viewportMap[e]}unproject(e,r){const n=this.getViewports(),i={x:e[0],y:e[1]};for(let a=n.length-1;a>=0;--a){const s=n[a];if(s.containsPixel(i)){const o=e.slice();return o[0]-=s.x,o[1]-=s.y,s.unproject(o,r)}}return null}setProps(e){e.views&&this._setViews(e.views),e.viewState&&this._setViewState(e.viewState),("width"in e||"height"in e)&&this._setSize(e.width,e.height),this._isUpdating||this._update()}_update(){this._isUpdating=!0,this._needsUpdate&&(this._needsUpdate=!1,this._rebuildViewports()),this._needsUpdate&&(this._needsUpdate=!1,this._rebuildViewports()),this._isUpdating=!1}_setSize(e,r){(e!==this.width||r!==this.height)&&(this.width=e,this.height=r,this.setNeedsUpdate("Size changed"))}_setViews(e){e=Dg(e,Boolean),this._diffViews(e,this.views)&&this.setNeedsUpdate("views changed"),this.views=e}_setViewState(e){e?(!Bf(e,this.viewState,3)&&this.setNeedsUpdate("viewState changed"),this.viewState=e):po.warn("missing `viewState` or `initialViewState`")()}_createController(e,r){const n=r.type;return new n({timeline:this.timeline,eventManager:this._eventManager,onViewStateChange:this._eventCallbacks.onViewStateChange,onStateChange:this._eventCallbacks.onInteractionStateChange,makeViewport:a=>this.getView(e.id)?.makeViewport({viewState:a,width:this.width,height:this.height})})}_updateController(e,r,n,i){const a=e.controller;if(a&&n){const s={...r,...a,id:e.id,x:n.x,y:n.y,width:n.width,height:n.height};return(!i||i.constructor!==a.type)&&(i=this._createController(e,s)),i&&i.setProps(s),i}return null}_rebuildViewports(){const{views:e}=this,r=this.controllers;this._viewports=[],this.controllers={};let n=!1;for(let i=e.length;i--;){const a=e[i],s=this.getViewState(a),o=a.makeViewport({viewState:s,width:this.width,height:this.height});let c=r[a.id];const f=!!a.controller;f&&!c&&(n=!0),(n||!f)&&c&&(c.finalize(),c=null),this.controllers[a.id]=this._updateController(a,s,o,c),o&&this._viewports.unshift(o)}for(const i in r){const a=r[i];a&&!this.controllers[i]&&a.finalize()}this._buildViewportMap()}_buildViewportMap(){this._viewportMap={},this._viewports.forEach(e=>{e.id&&(this._viewportMap[e.id]=this._viewportMap[e.id]||e)})}_diffViews(e,r){return e.length!==r.length?!0:e.some((n,i)=>!e[i].equals(r[i]))}}const k$e=/([0-9]+\.?[0-9]*)(%|px)/;function rg(t){switch(typeof t){case"number":return{position:t,relative:!1};case"string":const e=k$e.exec(t);if(e&&e.length>=3){const r=e[2]==="%",n=parseFloat(e[1]);return{position:r?n/100:n,relative:r}}default:throw new Error(`Could not parse position string ${t}`)}}function ng(t,e){return t.relative?Math.round(t.position*e):t.position}class gne{constructor(e){const{id:r,x:n=0,y:i=0,width:a="100%",height:s="100%",padding:o=null}=e;this.id=r||this.constructor.displayName||"view",this.props={...e,id:this.id},this._x=rg(n),this._y=rg(i),this._width=rg(a),this._height=rg(s),this._padding=o&&{left:rg(o.left||0),right:rg(o.right||0),top:rg(o.top||0),bottom:rg(o.bottom||0)},this.equals=this.equals.bind(this),Object.seal(this)}equals(e){return this===e?!0:this.constructor===e.constructor&&Bf(this.props,e.props,2)}clone(e){const r=this.constructor;return new r({...this.props,...e})}makeViewport({width:e,height:r,viewState:n}){n=this.filterViewState(n);const i=this.getDimensions({width:e,height:r});if(!i.height||!i.width)return null;const a=this.getViewportType(n);return new a({...n,...this.props,...i})}getViewStateId(){const{viewState:e}=this.props;return typeof e=="string"?e:e?.id||this.id}filterViewState(e){if(this.props.viewState&&typeof this.props.viewState=="object"){if(!this.props.viewState.id)return this.props.viewState;const r={...e};for(const n in this.props.viewState)n!=="id"&&(r[n]=this.props.viewState[n]);return r}return e}getDimensions({width:e,height:r}){const n={x:ng(this._x,e),y:ng(this._y,r),width:ng(this._width,e),height:ng(this._height,r)};return this._padding&&(n.padding={left:ng(this._padding.left,e),top:ng(this._padding.top,r),right:ng(this._padding.right,e),bottom:ng(this._padding.bottom,r)}),n}get controller(){const e=this.props.controller;return e?e===!0?{type:this.ControllerType}:typeof e=="function"?{type:e}:{type:this.ControllerType,...e}:null}}class eC{constructor(e){this._inProgress=!1,this._handle=null,this.time=0,this.settings={duration:0},this._timeline=e}get inProgress(){return this._inProgress}start(e){this.cancel(),this.settings=e,this._inProgress=!0,this.settings.onStart?.(this)}end(){this._inProgress&&(this._timeline.removeChannel(this._handle),this._handle=null,this._inProgress=!1,this.settings.onEnd?.(this))}cancel(){this._inProgress&&(this.settings.onInterrupt?.(this),this._timeline.removeChannel(this._handle),this._handle=null,this._inProgress=!1)}update(){if(!this._inProgress)return!1;if(this._handle===null){const{_timeline:e,settings:r}=this;this._handle=e.addChannel({delay:e.getTime(),duration:r.duration})}return this.time=this._timeline.getTime(this._handle),this._onUpdate(),this.settings.onUpdate?.(this),this._timeline.isFinished(this._handle)&&this.end(),!0}_onUpdate(){}}const lW=()=>{},mD={BREAK:1,SNAP_TO_END:2,IGNORE:3},R$e=t=>t,M$e=mD.BREAK;class D$e{constructor(e){this._onTransitionUpdate=r=>{const{time:n,settings:{interpolator:i,startProps:a,endProps:s,duration:o,easing:c}}=r,f=c(n/o),d=i.interpolateProps(a,s,f);this.propsInTransition=this.getControllerState({...this.props,...d}).getViewportProps(),this.onViewStateChange({viewState:this.propsInTransition,oldViewState:this.props})},this.getControllerState=e.getControllerState,this.propsInTransition=null,this.transition=new eC(e.timeline),this.onViewStateChange=e.onViewStateChange||lW,this.onStateChange=e.onStateChange||lW}finalize(){this.transition.cancel()}getViewportInTransition(){return this.propsInTransition}processViewStateChange(e){let r=!1;const n=this.props;if(this.props=e,!n||this._shouldIgnoreViewportChange(n,e))return!1;if(this._isTransitionEnabled(e)){let i=n;if(this.transition.inProgress){const{interruption:a,endProps:s}=this.transition.settings;i={...n,...a===mD.SNAP_TO_END?s:this.propsInTransition||n}}this._triggerTransition(i,e),r=!0}else this.transition.cancel();return r}updateTransition(){this.transition.update()}_isTransitionEnabled(e){const{transitionDuration:r,transitionInterpolator:n}=e;return(r>0||r==="auto")&&!!n}_isUpdateDueToCurrentTransition(e){return this.transition.inProgress&&this.propsInTransition?this.transition.settings.interpolator.arePropsEqual(e,this.propsInTransition):!1}_shouldIgnoreViewportChange(e,r){return this.transition.inProgress?this.transition.settings.interruption===mD.IGNORE||this._isUpdateDueToCurrentTransition(r):this._isTransitionEnabled(r)?r.transitionInterpolator.arePropsEqual(e,r):!0}_triggerTransition(e,r){const n=this.getControllerState(e),i=this.getControllerState(r).shortestPathFrom(n),a=r.transitionInterpolator,s=a.getDuration?a.getDuration(e,r):r.transitionDuration;if(s===0)return;const o=a.initializeProps(e,i);this.propsInTransition={};const c={duration:s,easing:r.transitionEasing||R$e,interpolator:a,interruption:r.transitionInterruption||M$e,startProps:o.start,endProps:o.end,onStart:r.onTransitionStart,onUpdate:this._onTransitionUpdate,onInterrupt:this._onTransitionEnd(r.onTransitionInterrupt),onEnd:this._onTransitionEnd(r.onTransitionEnd)};this.transition.start(c),this.onStateChange({inTransition:!0}),this.updateTransition()}_onTransitionEnd(e){return r=>{this.propsInTransition=null,this.onStateChange({inTransition:!1,isZooming:!1,isPanning:!1,isRotating:!1}),e?.(r)}}}function El(t,e){if(!t)throw new Error(e||"deck.gl: assertion failed.")}class O$e{constructor(e){const{compare:r,extract:n,required:i}=e;this._propsToCompare=r,this._propsToExtract=n||r,this._requiredProps=i}arePropsEqual(e,r){for(const n of this._propsToCompare)if(!(n in e)||!(n in r)||!px(e[n],r[n]))return!1;return!0}initializeProps(e,r){const n={},i={};for(const a of this._propsToExtract)(a in e||a in r)&&(n[a]=e[a],i[a]=r[a]);return this._checkRequiredProps(n),this._checkRequiredProps(i),{start:n,end:i}}getDuration(e,r){return r.transitionDuration}_checkRequiredProps(e){this._requiredProps&&this._requiredProps.forEach(r=>{const n=e[r];El(Number.isFinite(n)||Array.isArray(n),`${r} is required for transition`)})}}const eS=Math.PI/180,uW=180/Math.PI,FS=6370972,m0=256;function N$e(){const t=m0/FS,e=Math.PI/180*m0;return{unitsPerMeter:[t,t,t],unitsPerMeter2:[0,0,0],metersPerUnit:[1/t,1/t,1/t],unitsPerDegree:[e,e,t],unitsPerDegree2:[0,0,0],degreesPerUnit:[1/e,1/e,1/t]}}class m6 extends P_{constructor(e={}){const{longitude:r=0,zoom:n=0,nearZMultiplier:i=.5,farZMultiplier:a=1,resolution:s=10}=e;let{latitude:o=0,height:c,altitude:f=1.5,fovy:d}=e;o=Math.max(Math.min(o,md),-md),c=c||1,d?f=c6(d):d=mx(f);const m=Math.pow(2,n-y0(o)),b=e.nearZ??i,x=e.farZ??(f+m0*2*m/c)*a,E=new Rh().lookAt({eye:[0,-f,0],up:[0,0,1]});E.rotateX(o*eS),E.rotateZ(-r*eS),E.scale(m/c),super({...e,height:c,viewMatrix:E,longitude:r,latitude:o,zoom:n,distanceScales:N$e(),fovy:d,focalDistance:f,near:b,far:x}),this.scale=m,this.latitude=o,this.longitude=r,this.fovy=d,this.resolution=s}get projectionMode(){return cf.GLOBE}getDistanceScales(){return this.distanceScales}getBounds(e={}){const r={targetZ:e.z||0},n=this.unproject([0,this.height/2],r),i=this.unproject([this.width/2,0],r),a=this.unproject([this.width,this.height/2],r),s=this.unproject([this.width/2,this.height],r);return a[0]<this.longitude&&(a[0]+=360),n[0]>this.longitude&&(n[0]-=360),[Math.min(n[0],a[0],i[0],s[0]),Math.min(n[1],a[1],i[1],s[1]),Math.max(n[0],a[0],i[0],s[0]),Math.max(n[1],a[1],i[1],s[1])]}unproject(e,{topLeft:r=!0,targetZ:n}={}){const[i,a,s]=e,o=r?a:this.height-a,{pixelUnprojectionMatrix:c}=this;let f;if(Number.isFinite(s))f=sk(c,[i,o,s,1]);else{const x=sk(c,[i,o,-1,1]),E=sk(c,[i,o,1,1]),T=((n||0)/FS+1)*m0,A=YP(Vre([],x,E)),M=YP(x),F=YP(E),O=4*((4*M*F-(A-M-F)**2)/16)/A,U=Math.sqrt(M-O),j=Math.sqrt(Math.max(0,T*T-O)),H=(U-j)/Math.sqrt(A);f=X7e([],x,E,H)}const[d,m,b]=this.unprojectPosition(f);return Number.isFinite(s)?[d,m,b]:Number.isFinite(n)?[d,m,n]:[d,m]}projectPosition(e){const[r,n,i=0]=e,a=r*eS,s=n*eS,o=Math.cos(s),c=(i/FS+1)*m0;return[Math.sin(a)*o*c,-Math.cos(a)*o*c,Math.sin(s)*c]}unprojectPosition(e){const[r,n,i]=e,a=tje(e),s=Math.asin(i/a),c=Math.atan2(r,-n)*uW,f=s*uW,d=(a/m0-1)*FS;return[c,f,d]}projectFlat(e){return e}unprojectFlat(e){return e}panByPosition([e,r,n],i,a){const o=.25/Math.pow(2,this.zoom-y0(this.latitude)),c=e+o*(a[0]-i[0]);let f=r-o*(a[1]-i[1]);f=Math.max(Math.min(f,md),-md);const d={longitude:c,latitude:f,zoom:n-y0(r)};return d.zoom+=y0(d.latitude),d}}m6.displayName="GlobeViewport";function y0(t){const e=Math.PI*Math.cos(t*Math.PI/180);return Math.log2(e)}function sk(t,e){const r=I_([],e,t);return Hre(r,r,1/r[3]),r}const L$e=["longitude","latitude","zoom","bearing","pitch"],F$e=["longitude","latitude","zoom"];class y6 extends O$e{constructor(e={}){const r=Array.isArray(e)?e:e.transitionProps,n=Array.isArray(e)?{}:e;n.transitionProps=Array.isArray(r)?{compare:r,required:r}:r||{compare:L$e,required:F$e},super(n.transitionProps),this.opts=n}initializeProps(e,r){const n=super.initializeProps(e,r),{makeViewport:i,around:a}=this.opts;if(i&&a)if(i(e)instanceof m6)po.warn("around not supported in GlobeView")();else{const o=i(e),c=i(r),f=o.unproject(a);n.start.around=a,Object.assign(n.end,{around:c.project(f),aroundPosition:f,width:r.width,height:r.height})}return n}interpolateProps(e,r,n){const i={};for(const a of this._propsToExtract)i[a]=_T(e[a]||0,r[a]||0,n);if(r.aroundPosition&&this.opts.makeViewport){const a=this.opts.makeViewport({...r,...i});Object.assign(i,a.panByPosition(r.aroundPosition,_T(e.around,r.around,n)))}return i}}const ip={transitionDuration:0},B$e=300,tS=t=>1-(1-t)*(1-t),Dv={WHEEL:["wheel"],PAN:["panstart","panmove","panend"],PINCH:["pinchstart","pinchmove","pinchend"],MULTI_PAN:["multipanstart","multipanmove","multipanend"],DOUBLE_CLICK:["dblclick"],KEYBOARD:["keydown"]},mm={};class mne{constructor(e){this.state={},this._events={},this._interactionState={isDragging:!1},this._customEvents=[],this._eventStartBlocked=null,this._panMove=!1,this.invertPan=!1,this.dragMode="rotate",this.inertia=0,this.scrollZoom=!0,this.dragPan=!0,this.dragRotate=!0,this.doubleClickZoom=!0,this.touchZoom=!0,this.touchRotate=!1,this.keyboard=!0,this.transitionManager=new D$e({...e,getControllerState:r=>new this.ControllerState(r),onViewStateChange:this._onTransition.bind(this),onStateChange:this._setInteractionState.bind(this)}),this.handleEvent=this.handleEvent.bind(this),this.eventManager=e.eventManager,this.onViewStateChange=e.onViewStateChange||(()=>{}),this.onStateChange=e.onStateChange||(()=>{}),this.makeViewport=e.makeViewport}set events(e){this.toggleEvents(this._customEvents,!1),this.toggleEvents(e,!0),this._customEvents=e,this.props&&this.setProps(this.props)}finalize(){for(const e in this._events)this._events[e]&&this.eventManager?.off(e,this.handleEvent);this.transitionManager.finalize()}handleEvent(e){this._controllerState=void 0;const r=this._eventStartBlocked;switch(e.type){case"panstart":return r?!1:this._onPanStart(e);case"panmove":return this._onPan(e);case"panend":return this._onPanEnd(e);case"pinchstart":return r?!1:this._onPinchStart(e);case"pinchmove":return this._onPinch(e);case"pinchend":return this._onPinchEnd(e);case"multipanstart":return r?!1:this._onMultiPanStart(e);case"multipanmove":return this._onMultiPan(e);case"multipanend":return this._onMultiPanEnd(e);case"dblclick":return this._onDoubleClick(e);case"wheel":return this._onWheel(e);case"keydown":return this._onKeyDown(e);default:return!1}}get controllerState(){return this._controllerState=this._controllerState||new this.ControllerState({makeViewport:this.makeViewport,...this.props,...this.state}),this._controllerState}getCenter(e){const{x:r,y:n}=this.props,{offsetCenter:i}=e;return[i.x-r,i.y-n]}isPointInBounds(e,r){const{width:n,height:i}=this.props;if(r&&r.handled)return!1;const a=e[0]>=0&&e[0]<=n&&e[1]>=0&&e[1]<=i;return a&&r&&r.stopPropagation(),a}isFunctionKeyPressed(e){const{srcEvent:r}=e;return!!(r.metaKey||r.altKey||r.ctrlKey||r.shiftKey)}isDragging(){return this._interactionState.isDragging||!1}blockEvents(e){const r=setTimeout(()=>{this._eventStartBlocked===r&&(this._eventStartBlocked=null)},e);this._eventStartBlocked=r}setProps(e){e.dragMode&&(this.dragMode=e.dragMode),this.props=e,"transitionInterpolator"in e||(e.transitionInterpolator=this._getTransitionProps().transitionInterpolator),this.transitionManager.processViewStateChange(e);const{inertia:r}=e;this.inertia=Number.isFinite(r)?r:r===!0?B$e:0;const{scrollZoom:n=!0,dragPan:i=!0,dragRotate:a=!0,doubleClickZoom:s=!0,touchZoom:o=!0,touchRotate:c=!1,keyboard:f=!0}=e,d=!!this.onViewStateChange;this.toggleEvents(Dv.WHEEL,d&&n),this.toggleEvents(Dv.PAN,d),this.toggleEvents(Dv.PINCH,d&&(o||c)),this.toggleEvents(Dv.MULTI_PAN,d&&c),this.toggleEvents(Dv.DOUBLE_CLICK,d&&s),this.toggleEvents(Dv.KEYBOARD,d&&f),this.scrollZoom=n,this.dragPan=i,this.dragRotate=a,this.doubleClickZoom=s,this.touchZoom=o,this.touchRotate=c,this.keyboard=f}updateTransition(){this.transitionManager.updateTransition()}toggleEvents(e,r){this.eventManager&&e.forEach(n=>{this._events[n]!==r&&(this._events[n]=r,r?this.eventManager.on(n,this.handleEvent):this.eventManager.off(n,this.handleEvent))})}updateViewport(e,r=null,n={}){const i={...e.getViewportProps(),...r},a=this.controllerState!==e;if(this.state=e.getState(),this._setInteractionState(n),a){const s=this.controllerState&&this.controllerState.getViewportProps();this.onViewStateChange&&this.onViewStateChange({viewState:i,interactionState:this._interactionState,oldViewState:s,viewId:this.props.id})}}_onTransition(e){this.onViewStateChange({...e,interactionState:this._interactionState,viewId:this.props.id})}_setInteractionState(e){Object.assign(this._interactionState,e),this.onStateChange(this._interactionState)}_onPanStart(e){const r=this.getCenter(e);if(!this.isPointInBounds(r,e))return!1;let n=this.isFunctionKeyPressed(e)||e.rightButton||!1;(this.invertPan||this.dragMode==="pan")&&(n=!n);const i=this.controllerState[n?"panStart":"rotateStart"]({pos:r});return this._panMove=n,this.updateViewport(i,ip,{isDragging:!0}),!0}_onPan(e){return this.isDragging()?this._panMove?this._onPanMove(e):this._onPanRotate(e):!1}_onPanEnd(e){return this.isDragging()?this._panMove?this._onPanMoveEnd(e):this._onPanRotateEnd(e):!1}_onPanMove(e){if(!this.dragPan)return!1;const r=this.getCenter(e),n=this.controllerState.pan({pos:r});return this.updateViewport(n,ip,{isDragging:!0,isPanning:!0}),!0}_onPanMoveEnd(e){const{inertia:r}=this;if(this.dragPan&&r&&e.velocity){const n=this.getCenter(e),i=[n[0]+e.velocityX*r/2,n[1]+e.velocityY*r/2],a=this.controllerState.pan({pos:i}).panEnd();this.updateViewport(a,{...this._getTransitionProps(),transitionDuration:r,transitionEasing:tS},{isDragging:!1,isPanning:!0})}else{const n=this.controllerState.panEnd();this.updateViewport(n,null,{isDragging:!1,isPanning:!1})}return!0}_onPanRotate(e){if(!this.dragRotate)return!1;const r=this.getCenter(e),n=this.controllerState.rotate({pos:r});return this.updateViewport(n,ip,{isDragging:!0,isRotating:!0}),!0}_onPanRotateEnd(e){const{inertia:r}=this;if(this.dragRotate&&r&&e.velocity){const n=this.getCenter(e),i=[n[0]+e.velocityX*r/2,n[1]+e.velocityY*r/2],a=this.controllerState.rotate({pos:i}).rotateEnd();this.updateViewport(a,{...this._getTransitionProps(),transitionDuration:r,transitionEasing:tS},{isDragging:!1,isRotating:!0})}else{const n=this.controllerState.rotateEnd();this.updateViewport(n,null,{isDragging:!1,isRotating:!1})}return!0}_onWheel(e){if(!this.scrollZoom)return!1;const r=this.getCenter(e);if(!this.isPointInBounds(r,e))return!1;e.srcEvent.preventDefault();const{speed:n=.01,smooth:i=!1}=this.scrollZoom===!0?{}:this.scrollZoom,{delta:a}=e;let s=2/(1+Math.exp(-Math.abs(a*n)));a<0&&s!==0&&(s=1/s);const o=i?{...this._getTransitionProps({around:r}),transitionDuration:250}:ip,c=this.controllerState.zoom({pos:r,scale:s});return this.updateViewport(c,o,{isZooming:!0,isPanning:!0}),i||this._setInteractionState({isZooming:!1,isPanning:!1}),!0}_onMultiPanStart(e){const r=this.getCenter(e);if(!this.isPointInBounds(r,e))return!1;const n=this.controllerState.rotateStart({pos:r});return this.updateViewport(n,ip,{isDragging:!0}),!0}_onMultiPan(e){if(!this.touchRotate||!this.isDragging())return!1;const r=this.getCenter(e);r[0]-=e.deltaX;const n=this.controllerState.rotate({pos:r});return this.updateViewport(n,ip,{isDragging:!0,isRotating:!0}),!0}_onMultiPanEnd(e){if(!this.isDragging())return!1;const{inertia:r}=this;if(this.touchRotate&&r&&e.velocityY){const n=this.getCenter(e),i=[n[0],n[1]+=e.velocityY*r/2],a=this.controllerState.rotate({pos:i});this.updateViewport(a,{...this._getTransitionProps(),transitionDuration:r,transitionEasing:tS},{isDragging:!1,isRotating:!0}),this.blockEvents(r)}else{const n=this.controllerState.rotateEnd();this.updateViewport(n,null,{isDragging:!1,isRotating:!1})}return!0}_onPinchStart(e){const r=this.getCenter(e);if(!this.isPointInBounds(r,e))return!1;const n=this.controllerState.zoomStart({pos:r}).rotateStart({pos:r});return mm._startPinchRotation=e.rotation,mm._lastPinchEvent=e,this.updateViewport(n,ip,{isDragging:!0}),!0}_onPinch(e){if(!this.touchZoom&&!this.touchRotate||!this.isDragging())return!1;let r=this.controllerState;if(this.touchZoom){const{scale:n}=e,i=this.getCenter(e);r=r.zoom({pos:i,scale:n})}if(this.touchRotate){const{rotation:n}=e;r=r.rotate({deltaAngleX:mm._startPinchRotation-n})}return this.updateViewport(r,ip,{isDragging:!0,isPanning:this.touchZoom,isZooming:this.touchZoom,isRotating:this.touchRotate}),mm._lastPinchEvent=e,!0}_onPinchEnd(e){if(!this.isDragging())return!1;const{inertia:r}=this,{_lastPinchEvent:n}=mm;if(this.touchZoom&&r&&n&&e.scale!==n.scale){const i=this.getCenter(e);let a=this.controllerState.rotateEnd();const s=Math.log2(e.scale),o=(s-Math.log2(n.scale))/(e.deltaTime-n.deltaTime),c=Math.pow(2,s+o*r/2);a=a.zoom({pos:i,scale:c}).zoomEnd(),this.updateViewport(a,{...this._getTransitionProps({around:i}),transitionDuration:r,transitionEasing:tS},{isDragging:!1,isPanning:this.touchZoom,isZooming:this.touchZoom,isRotating:!1}),this.blockEvents(r)}else{const i=this.controllerState.zoomEnd().rotateEnd();this.updateViewport(i,null,{isDragging:!1,isPanning:!1,isZooming:!1,isRotating:!1})}return mm._startPinchRotation=null,mm._lastPinchEvent=null,!0}_onDoubleClick(e){if(!this.doubleClickZoom)return!1;const r=this.getCenter(e);if(!this.isPointInBounds(r,e))return!1;const n=this.isFunctionKeyPressed(e),i=this.controllerState.zoom({pos:r,scale:n?.5:2});return this.updateViewport(i,this._getTransitionProps({around:r}),{isZooming:!0,isPanning:!0}),this.blockEvents(100),!0}_onKeyDown(e){if(!this.keyboard)return!1;const r=this.isFunctionKeyPressed(e),{zoomSpeed:n,moveSpeed:i,rotateSpeedX:a,rotateSpeedY:s}=this.keyboard===!0?{}:this.keyboard,{controllerState:o}=this;let c;const f={};switch(e.srcEvent.code){case"Minus":c=r?o.zoomOut(n).zoomOut(n):o.zoomOut(n),f.isZooming=!0;break;case"Equal":c=r?o.zoomIn(n).zoomIn(n):o.zoomIn(n),f.isZooming=!0;break;case"ArrowLeft":r?(c=o.rotateLeft(a),f.isRotating=!0):(c=o.moveLeft(i),f.isPanning=!0);break;case"ArrowRight":r?(c=o.rotateRight(a),f.isRotating=!0):(c=o.moveRight(i),f.isPanning=!0);break;case"ArrowUp":r?(c=o.rotateUp(s),f.isRotating=!0):(c=o.moveUp(i),f.isPanning=!0);break;case"ArrowDown":r?(c=o.rotateDown(s),f.isRotating=!0):(c=o.moveDown(i),f.isPanning=!0);break;default:return!1}return this.updateViewport(c,this._getTransitionProps(),f),!0}_getTransitionProps(e){const{transition:r}=this;return!r||!r.transitionInterpolator?ip:e?{...r,transitionInterpolator:new y6({...e,...r.transitionInterpolator.opts,makeViewport:this.controllerState.makeViewport})}:r}}class z$e{constructor(e,r){this._viewportProps=this.applyConstraints(e),this._state=r}getViewportProps(){return this._viewportProps}getState(){return this._state}}const cW=5,j$e=1.2;class yne extends z$e{constructor(e){const{width:r,height:n,latitude:i,longitude:a,zoom:s,bearing:o=0,pitch:c=0,altitude:f=1.5,position:d=[0,0,0],maxZoom:m=20,minZoom:b=0,maxPitch:x=60,minPitch:E=0,startPanLngLat:T,startZoomLngLat:A,startRotatePos:M,startBearing:F,startPitch:N,startZoom:O,normalize:U=!0}=e;El(Number.isFinite(a)),El(Number.isFinite(i)),El(Number.isFinite(s)),super({width:r,height:n,latitude:i,longitude:a,zoom:s,bearing:o,pitch:c,altitude:f,maxZoom:m,minZoom:b,maxPitch:x,minPitch:E,normalize:U,position:d},{startPanLngLat:T,startZoomLngLat:A,startRotatePos:M,startBearing:F,startPitch:N,startZoom:O}),this.makeViewport=e.makeViewport}panStart({pos:e}){return this._getUpdatedState({startPanLngLat:this._unproject(e)})}pan({pos:e,startPos:r}){const n=this.getState().startPanLngLat||this._unproject(r);if(!n)return this;const a=this.makeViewport(this.getViewportProps()).panByPosition(n,e);return this._getUpdatedState(a)}panEnd(){return this._getUpdatedState({startPanLngLat:null})}rotateStart({pos:e}){return this._getUpdatedState({startRotatePos:e,startBearing:this.getViewportProps().bearing,startPitch:this.getViewportProps().pitch})}rotate({pos:e,deltaAngleX:r=0,deltaAngleY:n=0}){const{startRotatePos:i,startBearing:a,startPitch:s}=this.getState();if(!i||a===void 0||s===void 0)return this;let o;return e?o=this._getNewRotation(e,i,s,a):o={bearing:a+r,pitch:s+n},this._getUpdatedState(o)}rotateEnd(){return this._getUpdatedState({startBearing:null,startPitch:null})}zoomStart({pos:e}){return this._getUpdatedState({startZoomLngLat:this._unproject(e),startZoom:this.getViewportProps().zoom})}zoom({pos:e,startPos:r,scale:n}){let{startZoom:i,startZoomLngLat:a}=this.getState();if(a||(i=this.getViewportProps().zoom,a=this._unproject(r)||this._unproject(e)),!a)return this;const{maxZoom:s,minZoom:o}=this.getViewportProps();let c=i+Math.log2(n);c=gd(c,o,s);const f=this.makeViewport({...this.getViewportProps(),zoom:c});return this._getUpdatedState({zoom:c,...f.panByPosition(a,e)})}zoomEnd(){return this._getUpdatedState({startZoomLngLat:null,startZoom:null})}zoomIn(e=2){return this._zoomFromCenter(e)}zoomOut(e=2){return this._zoomFromCenter(1/e)}moveLeft(e=100){return this._panFromCenter([e,0])}moveRight(e=100){return this._panFromCenter([-e,0])}moveUp(e=100){return this._panFromCenter([0,e])}moveDown(e=100){return this._panFromCenter([0,-e])}rotateLeft(e=15){return this._getUpdatedState({bearing:this.getViewportProps().bearing-e})}rotateRight(e=15){return this._getUpdatedState({bearing:this.getViewportProps().bearing+e})}rotateUp(e=10){return this._getUpdatedState({pitch:this.getViewportProps().pitch+e})}rotateDown(e=10){return this._getUpdatedState({pitch:this.getViewportProps().pitch-e})}shortestPathFrom(e){const r=e.getViewportProps(),n={...this.getViewportProps()},{bearing:i,longitude:a}=n;return Math.abs(i-r.bearing)>180&&(n.bearing=i<0?i+360:i-360),Math.abs(a-r.longitude)>180&&(n.longitude=a<0?a+360:a-360),n}applyConstraints(e){const{maxZoom:r,minZoom:n,zoom:i}=e;e.zoom=gd(i,n,r);const{maxPitch:a,minPitch:s,pitch:o}=e;e.pitch=gd(o,s,a);const{normalize:c=!0}=e;return c&&Object.assign(e,sVe(e)),e}_zoomFromCenter(e){const{width:r,height:n}=this.getViewportProps();return this.zoom({pos:[r/2,n/2],scale:e})}_panFromCenter(e){const{width:r,height:n}=this.getViewportProps();return this.pan({startPos:[r/2,n/2],pos:[r/2+e[0],n/2+e[1]]})}_getUpdatedState(e){return new this.constructor({makeViewport:this.makeViewport,...this.getViewportProps(),...this.getState(),...e})}_unproject(e){const r=this.makeViewport(this.getViewportProps());return e&&r.unproject(e)}_getNewRotation(e,r,n,i){const a=e[0]-r[0],s=e[1]-r[1],o=e[1],c=r[1],{width:f,height:d}=this.getViewportProps(),m=a/f;let b=0;s>0?Math.abs(d-c)>cW&&(b=s/(c-d)*j$e):s<0&&c>cW&&(b=1-o/c),b=gd(b,-1,1);const{minPitch:x,maxPitch:E}=this.getViewportProps(),T=i+180*m;let A=n;return b>0?A=n+b*(E-n):b<0&&(A=n-b*(x-n)),{pitch:A,bearing:T}}}class U$e extends mne{constructor(){super(...arguments),this.ControllerState=yne,this.transition={transitionDuration:300,transitionInterpolator:new y6({transitionProps:{compare:["longitude","latitude","zoom","bearing","pitch","position"],required:["longitude","latitude","zoom"]}})},this.dragMode="pan"}setProps(e){e.position=e.position||[0,0,0];const r=this.props;super.setProps(e),(!r||r.height!==e.height)&&this.updateViewport(new this.ControllerState({makeViewport:this.makeViewport,...e,...this.state}))}}class v6 extends gne{constructor(e={}){super(e)}getViewportType(){return yy}get ControllerType(){return U$e}}v6.displayName="MapView";const V$e=new une;function $$e(t,e){const r=t.order??1/0,n=e.order??1/0;return r-n}class q$e{constructor(e){this._resolvedEffects=[],this._defaultEffects=[],this.effects=[],this._context=e,this._needsRedraw="Initial render",this._setEffects([])}addDefaultEffect(e){const r=this._defaultEffects;if(!r.find(n=>n.id===e.id)){const n=r.findIndex(i=>$$e(i,e)>0);n<0?r.push(e):r.splice(n,0,e),e.setup(this._context),this._setEffects(this.effects)}}setProps(e){"effects"in e&&(Bf(e.effects,this.effects,1)||this._setEffects(e.effects))}needsRedraw(e={clearRedrawFlags:!1}){const r=this._needsRedraw;return e.clearRedrawFlags&&(this._needsRedraw=!1),r}getEffects(){return this._resolvedEffects}_setEffects(e){const r={};for(const i of this.effects)r[i.id]=i;const n=[];for(const i of e){const a=r[i.id];let s=i;a&&a!==i?a.setProps?(a.setProps(i.props),s=a):a.cleanup(this._context):a||i.setup(this._context),n.push(s),delete r[i.id]}for(const i in r)r[i].cleanup(this._context);this.effects=n,this._resolvedEffects=n.concat(this._defaultEffects),e.some(i=>i instanceof une)||this._resolvedEffects.push(V$e),this._needsRedraw="effects changed"}finalize(){for(const e of this._resolvedEffects)e.cleanup(this._context);this.effects.length=0,this._resolvedEffects.length=0,this._defaultEffects.length=0}}class H$e extends h6{shouldDrawLayer(e){const{operation:r}=e.props;return r.includes("draw")||r.includes("terrain")}}const G$e="deckRenderer.renderLayers";class W$e{constructor(e){this.device=e,this.layerFilter=null,this.drawPickingColors=!1,this.drawLayersPass=new H$e(e),this.pickLayersPass=new dne(e),this.renderCount=0,this._needsRedraw="Initial render",this.renderBuffers=[],this.lastPostProcessEffect=null}setProps(e){this.layerFilter!==e.layerFilter&&(this.layerFilter=e.layerFilter,this._needsRedraw="layerFilter changed"),this.drawPickingColors!==e.drawPickingColors&&(this.drawPickingColors=e.drawPickingColors,this._needsRedraw="drawPickingColors changed")}renderLayers(e){if(!e.viewports.length)return;const r=this.drawPickingColors?this.pickLayersPass:this.drawLayersPass,n={layerFilter:this.layerFilter,isPicking:this.drawPickingColors,...e};n.effects&&this._preRender(n.effects,n);const i=this.lastPostProcessEffect?this.renderBuffers[0]:n.target;this.lastPostProcessEffect&&(n.clearColor=[0,0,0,0],n.clearCanvas=!0);const a=r.render({...n,target:i});n.effects&&(this.lastPostProcessEffect&&(n.clearCanvas=e.clearCanvas===void 0?!0:e.clearCanvas),this._postRender(n.effects,n)),this.renderCount++,yc(G$e,this,a,e)}needsRedraw(e={clearRedrawFlags:!1}){const r=this._needsRedraw;return e.clearRedrawFlags&&(this._needsRedraw=!1),r}finalize(){const{renderBuffers:e}=this;for(const r of e)r.delete();e.length=0}_preRender(e,r){this.lastPostProcessEffect=null,r.preRenderStats=r.preRenderStats||{};for(const n of e)r.preRenderStats[n.id]=n.preRender(r),n.postRender&&(this.lastPostProcessEffect=n.id);this.lastPostProcessEffect&&this._resizeRenderBuffers()}_resizeRenderBuffers(){const{renderBuffers:e}=this,r=this.device.canvasContext.getDrawingBufferSize(),[n,i]=r;e.length===0&&[0,1].map(a=>{const s=this.device.createTexture({sampler:{minFilter:"linear",magFilter:"linear"},width:n,height:i});e.push(this.device.createFramebuffer({id:`deck-renderbuffer-${a}`,colorAttachments:[s]}))});for(const a of e)a.resize(r)}_postRender(e,r){const{renderBuffers:n}=this,i={...r,inputBuffer:n[0],swapBuffer:n[1]};for(const a of e)if(a.postRender){i.target=a.id===this.lastPostProcessEffect?r.target:void 0;const s=a.postRender(i);i.inputBuffer=s,i.swapBuffer=s===n[0]?n[1]:n[0]}}}const X$e={pickedColor:null,pickedObjectIndex:-1};function fW({pickedColors:t,decodePickingColor:e,deviceX:r,deviceY:n,deviceRadius:i,deviceRect:a}){const{x:s,y:o,width:c,height:f}=a;let d=i*i,m=-1,b=0;for(let x=0;x<f;x++){const E=x+o-n,T=E*E;if(T>d)b+=4*c;else for(let A=0;A<c;A++){if(t[b+3]-1>=0){const F=A+s-r,N=F*F+T;N<=d&&(d=N,m=b)}b+=4}}if(m>=0){const x=t.slice(m,m+4),E=e(x);if(E){const T=Math.floor(m/4/c),A=m/4-T*c;return{...E,pickedColor:x,pickedX:s+A,pickedY:o+T}}po.error("Picked non-existent layer. Is picking buffer corrupt?")()}return X$e}function hW({pickedColors:t,decodePickingColor:e}){const r=new Map;if(t){for(let n=0;n<t.length;n+=4)if(t[n+3]-1>=0){const a=t.slice(n,n+4),s=a.join(",");if(!r.has(s)){const o=e(a);o?r.set(s,{...o,color:a}):po.error("Picked non-existent layer. Is picking buffer corrupt?")()}}}return Array.from(r.values())}function yD({pickInfo:t,viewports:e,pixelRatio:r,x:n,y:i,z:a}){let s=e[0];e.length>1&&(s=Y$e(t?.pickedViewports||e,{x:n,y:i}));let o;if(s){const c=[n-s.x,i-s.y];a!==void 0&&(c[2]=a),o=s.unproject(c)}return{color:null,layer:null,viewport:s,index:-1,picked:!1,x:n,y:i,pixel:[n,i],coordinate:o,devicePixel:t&&"pickedX"in t?[t.pickedX,t.pickedY]:void 0,pixelRatio:r}}function dW(t){const{pickInfo:e,lastPickedInfo:r,mode:n,layers:i}=t,{pickedColor:a,pickedLayer:s,pickedObjectIndex:o}=e,c=s?[s]:[];if(n==="hover"){const m=r.index,b=r.layerId,x=s?s.props.id:null;if(x!==b||o!==m){if(x!==b){const E=i.find(T=>T.props.id===b);E&&c.unshift(E)}r.layerId=x,r.index=o,r.info=null}}const f=yD(t),d=new Map;return d.set(null,f),c.forEach(m=>{let b={...f};m===s&&(b.color=a,b.index=o,b.picked=!0),b=vD({layer:m,info:b,mode:n});const x=b.layer;m===s&&n==="hover"&&(r.info=b),d.set(x.id,b),n==="hover"&&x.updateAutoHighlight(b)}),d}function vD({layer:t,info:e,mode:r}){for(;t&&e;){const n=e.layer||null;e.sourceLayer=n,e.layer=t,e=t.getPickingInfo({info:e,mode:r,sourceLayer:n}),t=t.parent}return e}function Y$e(t,e){for(let r=t.length-1;r>=0;r--){const n=t[r];if(n.containsPixel(e))return n}return t[0]}class Z$e{constructor(e){this._pickable=!0,this.device=e,this.pickLayersPass=new dne(e),this.lastPickedInfo={index:-1,layerId:null,info:null}}setProps(e){"layerFilter"in e&&(this.layerFilter=e.layerFilter),"_pickable"in e&&(this._pickable=e._pickable)}finalize(){this.pickingFBO&&this.pickingFBO.destroy(),this.depthFBO&&this.depthFBO.destroy()}pickObjectAsync(e){return this._pickClosestObjectAsync(e)}pickObjectsAsync(e){return this._pickVisibleObjectsAsync(e)}pickObject(e){return this._pickClosestObject(e)}pickObjects(e){return this._pickVisibleObjects(e)}getLastPickedObject({x:e,y:r,layers:n,viewports:i},a=this.lastPickedInfo.info){const s=a&&a.layer&&a.layer.id,o=a&&a.viewport&&a.viewport.id,c=s?n.find(b=>b.id===s):null,f=o&&i.find(b=>b.id===o)||i[0],d=f&&f.unproject([e-f.x,r-f.y]);return{...a,...{x:e,y:r,viewport:f,coordinate:d,layer:c}}}_resizeBuffer(){if(!this.pickingFBO&&(this.pickingFBO=this.device.createFramebuffer({colorAttachments:["rgba8unorm"],depthStencilAttachment:"depth16unorm"}),this.device.isTextureFormatRenderable("rgba32float"))){const r=this.device.createFramebuffer({colorAttachments:["rgba32float"],depthStencilAttachment:"depth16unorm"});this.depthFBO=r}const{canvas:e}=this.device.getDefaultCanvasContext();this.pickingFBO?.resize({width:e.width,height:e.height}),this.depthFBO?.resize({width:e.width,height:e.height})}_getPickable(e){if(this._pickable===!1)return null;const r=e.filter(n=>this.pickLayersPass.shouldDrawLayer(n)&&!n.isComposite);return r.length?r:null}async _pickClosestObjectAsync({layers:e,views:r,viewports:n,x:i,y:a,radius:s=0,depth:o=1,mode:c="query",unproject3D:f,onViewportActive:d,effects:m}){const b=this.device.canvasContext.cssToDeviceRatio(),x=this._getPickable(e);if(!x||n.length===0)return{result:[],emptyInfo:yD({viewports:n,x:i,y:a,pixelRatio:b})};this._resizeBuffer();const E=this.device.canvasContext.cssToDevicePixels([i,a],!0),T=[E.x+Math.floor(E.width/2),E.y+Math.floor(E.height/2)],A=Math.round(s*b),{width:M,height:F}=this.pickingFBO,N=this._getPickingRect({deviceX:T[0],deviceY:T[1],deviceRadius:A,deviceWidth:M,deviceHeight:F}),O={x:i-s,y:a-s,width:s*2+1,height:s*2+1};let U;const j=[],H=new Set;for(let W=0;W<o;W++){let X;if(N){const Q=this._drawAndSample({layers:x,views:r,viewports:n,onViewportActive:d,deviceRect:N,cullRect:O,effects:m,pass:`picking:${c}`});X=fW({...Q,deviceX:T[0],deviceY:T[1],deviceRadius:A,deviceRect:N})}else X={pickedColor:null,pickedObjectIndex:-1};let oe;if(X.pickedLayer&&f&&this.depthFBO){const{pickedColors:Q}=this._drawAndSample({layers:[X.pickedLayer],views:r,viewports:n,onViewportActive:d,deviceRect:{x:X.pickedX,y:X.pickedY,width:1,height:1},cullRect:O,effects:m,pass:`picking:${c}:z`},!0);Q[3]&&(oe=Q[0])}X.pickedLayer&&W+1<o&&(H.add(X.pickedLayer),X.pickedLayer.disablePickingIndex(X.pickedObjectIndex)),U=dW({pickInfo:X,lastPickedInfo:this.lastPickedInfo,mode:c,layers:x,viewports:n,x:i,y:a,z:oe,pixelRatio:b});for(const Q of U.values())Q.layer&&j.push(Q);if(!X.pickedColor)break}for(const W of H)W.restorePickingColors();return{result:j,emptyInfo:U.get(null)}}_pickClosestObject({layers:e,views:r,viewports:n,x:i,y:a,radius:s=0,depth:o=1,mode:c="query",unproject3D:f,onViewportActive:d,effects:m}){const b=this.device.canvasContext.cssToDeviceRatio(),x=this._getPickable(e);if(!x||n.length===0)return{result:[],emptyInfo:yD({viewports:n,x:i,y:a,pixelRatio:b})};this._resizeBuffer();const E=this.device.canvasContext.cssToDevicePixels([i,a],!0),T=[E.x+Math.floor(E.width/2),E.y+Math.floor(E.height/2)],A=Math.round(s*b),{width:M,height:F}=this.pickingFBO,N=this._getPickingRect({deviceX:T[0],deviceY:T[1],deviceRadius:A,deviceWidth:M,deviceHeight:F}),O={x:i-s,y:a-s,width:s*2+1,height:s*2+1};let U;const j=[],H=new Set;for(let W=0;W<o;W++){let X;if(N){const Q=this._drawAndSample({layers:x,views:r,viewports:n,onViewportActive:d,deviceRect:N,cullRect:O,effects:m,pass:`picking:${c}`});X=fW({...Q,deviceX:T[0],deviceY:T[1],deviceRadius:A,deviceRect:N})}else X={pickedColor:null,pickedObjectIndex:-1};let oe;if(X.pickedLayer&&f&&this.depthFBO){const{pickedColors:Q}=this._drawAndSample({layers:[X.pickedLayer],views:r,viewports:n,onViewportActive:d,deviceRect:{x:X.pickedX,y:X.pickedY,width:1,height:1},cullRect:O,effects:m,pass:`picking:${c}:z`},!0);Q[3]&&(oe=Q[0])}X.pickedLayer&&W+1<o&&(H.add(X.pickedLayer),X.pickedLayer.disablePickingIndex(X.pickedObjectIndex)),U=dW({pickInfo:X,lastPickedInfo:this.lastPickedInfo,mode:c,layers:x,viewports:n,x:i,y:a,z:oe,pixelRatio:b});for(const Q of U.values())Q.layer&&j.push(Q);if(!X.pickedColor)break}for(const W of H)W.restorePickingColors();return{result:j,emptyInfo:U.get(null)}}async _pickVisibleObjectsAsync({layers:e,views:r,viewports:n,x:i,y:a,width:s=1,height:o=1,mode:c="query",maxObjects:f=null,onViewportActive:d,effects:m}){const b=this._getPickable(e);if(!b||n.length===0)return[];this._resizeBuffer();const x=this.device.canvasContext.cssToDeviceRatio(),E=this.device.canvasContext.cssToDevicePixels([i,a],!0),T=E.x,A=E.y+E.height,M=this.device.canvasContext.cssToDevicePixels([i+s,a+o],!0),F=M.x+M.width,N=M.y,O={x:T,y:N,width:F-T,height:A-N},U=this._drawAndSample({layers:b,views:r,viewports:n,onViewportActive:d,deviceRect:O,cullRect:{x:i,y:a,width:s,height:o},effects:m,pass:`picking:${c}`}),j=hW(U),H=new Map,W=[],X=Number.isFinite(f);for(let oe=0;oe<j.length&&!(X&&W.length>=f);oe++){const Q=j[oe];let G={color:Q.pickedColor,layer:null,index:Q.pickedObjectIndex,picked:!0,x:i,y:a,pixelRatio:x};G=vD({layer:Q.pickedLayer,info:G,mode:c});const ae=G.layer.id;H.has(ae)||H.set(ae,new Set);const se=H.get(ae),fe=G.object??G.index;se.has(fe)||(se.add(fe),W.push(G))}return W}_pickVisibleObjects({layers:e,views:r,viewports:n,x:i,y:a,width:s=1,height:o=1,mode:c="query",maxObjects:f=null,onViewportActive:d,effects:m}){const b=this._getPickable(e);if(!b||n.length===0)return[];this._resizeBuffer();const x=this.device.canvasContext.cssToDeviceRatio(),E=this.device.canvasContext.cssToDevicePixels([i,a],!0),T=E.x,A=E.y+E.height,M=this.device.canvasContext.cssToDevicePixels([i+s,a+o],!0),F=M.x+M.width,N=M.y,O={x:T,y:N,width:F-T,height:A-N},U=this._drawAndSample({layers:b,views:r,viewports:n,onViewportActive:d,deviceRect:O,cullRect:{x:i,y:a,width:s,height:o},effects:m,pass:`picking:${c}`}),j=hW(U),H=new Map,W=[],X=Number.isFinite(f);for(let oe=0;oe<j.length&&!(X&&W.length>=f);oe++){const Q=j[oe];let G={color:Q.pickedColor,layer:null,index:Q.pickedObjectIndex,picked:!0,x:i,y:a,pixelRatio:x};G=vD({layer:Q.pickedLayer,info:G,mode:c});const ae=G.layer.id;H.has(ae)||H.set(ae,new Set);const se=H.get(ae),fe=G.object??G.index;se.has(fe)||(se.add(fe),W.push(G))}return W}async _drawAndSampleAsync({layers:e,views:r,viewports:n,onViewportActive:i,deviceRect:a,cullRect:s,effects:o,pass:c},f=!1){const d=f?this.depthFBO:this.pickingFBO,m={layers:e,layerFilter:this.layerFilter,views:r,viewports:n,onViewportActive:i,pickingFBO:d,deviceRect:a,cullRect:s,effects:o,pass:c,pickZ:f,preRenderStats:{},isPicking:!0};for(const F of o)F.useInPicking&&(m.preRenderStats[F.id]=F.preRender(m));const{decodePickingColor:b}=this.pickLayersPass.render(m),{x,y:E,width:T,height:A}=a,M=new(f?Float32Array:Uint8Array)(T*A*4);return this.device.readPixelsToArrayWebGL(d,{sourceX:x,sourceY:E,sourceWidth:T,sourceHeight:A,target:M}),{pickedColors:M,decodePickingColor:b}}_drawAndSample({layers:e,views:r,viewports:n,onViewportActive:i,deviceRect:a,cullRect:s,effects:o,pass:c},f=!1){const d=f?this.depthFBO:this.pickingFBO,m={layers:e,layerFilter:this.layerFilter,views:r,viewports:n,onViewportActive:i,pickingFBO:d,deviceRect:a,cullRect:s,effects:o,pass:c,pickZ:f,preRenderStats:{},isPicking:!0};for(const F of o)F.useInPicking&&(m.preRenderStats[F.id]=F.preRender(m));const{decodePickingColor:b}=this.pickLayersPass.render(m),{x,y:E,width:T,height:A}=a,M=new(f?Float32Array:Uint8Array)(T*A*4);return this.device.readPixelsToArrayWebGL(d,{sourceX:x,sourceY:E,sourceWidth:T,sourceHeight:A,target:M}),{pickedColors:M,decodePickingColor:b}}_getPickingRect({deviceX:e,deviceY:r,deviceRadius:n,deviceWidth:i,deviceHeight:a}){const s=Math.max(0,e-n),o=Math.max(0,r-n),c=Math.min(i,e+n+1)-s,f=Math.min(a,r+n+1)-o;return c<=0||f<=0?null:{x:s,y:o,width:c,height:f}}}const K$e={"top-left":{top:0,left:0},"top-right":{top:0,right:0},"bottom-left":{bottom:0,left:0},"bottom-right":{bottom:0,right:0},fill:{top:0,left:0,bottom:0,right:0}},J$e="top-left",pW="root";class Q$e{constructor({deck:e,parentElement:r}){this.defaultWidgets=[],this.widgets=[],this.resolvedWidgets=[],this.containers={},this.lastViewports={},this.deck=e,r?.classList.add("deck-widget-container"),this.parentElement=r}getWidgets(){return this.resolvedWidgets}setProps(e){if(e.widgets&&!Bf(e.widgets,this.widgets,1)){const r=e.widgets.filter(Boolean);this._setWidgets(r)}}finalize(){for(const e of this.getWidgets())this._removeWidget(e);this.defaultWidgets.length=0,this.resolvedWidgets.length=0;for(const e in this.containers)this.containers[e].remove()}addDefault(e){this.defaultWidgets.find(r=>r.id===e.id)||(this._addWidget(e),this.defaultWidgets.push(e),this._setWidgets(this.widgets))}onRedraw({viewports:e,layers:r}){const n=e.reduce((i,a)=>(i[a.id]=a,i),{});for(const i of this.getWidgets()){const{viewId:a}=i;if(a){const s=n[a];s&&(i.onViewportChange&&i.onViewportChange(s),i.onRedraw?.({viewports:[s],layers:r}))}else{if(i.onViewportChange)for(const s of e)i.onViewportChange(s);i.onRedraw?.({viewports:e,layers:r})}}this.lastViewports=n,this._updateContainers()}onHover(e,r){for(const n of this.getWidgets()){const{viewId:i}=n;(!i||i===e.viewport?.id)&&n.onHover?.(e,r)}}onEvent(e,r){const n=fD[r.type];if(n)for(const i of this.getWidgets()){const{viewId:a}=i;(!a||a===e.viewport?.id)&&i[n]?.(e,r)}}_setWidgets(e){const r={};for(const n of this.resolvedWidgets)r[n.id]=n;this.resolvedWidgets.length=0;for(const n of this.defaultWidgets)r[n.id]=null,this.resolvedWidgets.push(n);for(let n of e){const i=r[n.id];i?i.viewId!==n.viewId||i.placement!==n.placement?(this._removeWidget(i),this._addWidget(n)):n!==i&&(i.setProps(n.props),n=i):this._addWidget(n),r[n.id]=null,this.resolvedWidgets.push(n)}for(const n in r){const i=r[n];i&&this._removeWidget(i)}this.widgets=e}_addWidget(e){const{viewId:r=null,placement:n=J$e}=e,i=e.props._container??r;e.widgetManager=this,e.deck=this.deck,e.rootElement=e._onAdd({deck:this.deck,viewId:r}),e.rootElement&&this._getContainer(i,n).append(e.rootElement),e.updateHTML()}_removeWidget(e){e.onRemove?.(),e.rootElement&&e.rootElement.remove(),e.rootElement=void 0,e.deck=void 0,e.widgetManager=void 0}_getContainer(e,r){if(e&&typeof e!="string")return e;const n=e||pW;let i=this.containers[n];i||(i=document.createElement("div"),i.style.pointerEvents="none",i.style.position="absolute",i.style.overflow="hidden",this.parentElement?.append(i),this.containers[n]=i);let a=i.querySelector(`.${r}`);return a||(a=globalThis.document.createElement("div"),a.className=r,a.style.position="absolute",a.style.zIndex="2",Object.assign(a.style,K$e[r]),i.append(a)),a}_updateContainers(){const e=this.deck.width,r=this.deck.height;for(const n in this.containers){const i=this.lastViewports[n]||null,a=n===pW||i,s=this.containers[n];a?(s.style.display="block",s.style.left=`${i?i.x:0}px`,s.style.top=`${i?i.y:0}px`,s.style.width=`${i?i.width:e}px`,s.style.height=`${i?i.height:r}px`):s.style.display="none"}}}function gW(t,e){e&&Object.entries(e).map(([r,n])=>{r.startsWith("--")?t.style.setProperty(r,n):t.style[r]=n})}function eqe(t,e){e&&Object.keys(e).map(r=>{r.startsWith("--")?t.style.removeProperty(r):t.style[r]=""})}class _6{constructor(e){this.viewId=null,this.props={...this.constructor.defaultProps,...e},this.id=this.props.id}setProps(e){const r=this.props,n=this.rootElement;n&&r.className!==e.className&&(r.className&&n.classList.remove(r.className),e.className&&n.classList.add(e.className)),n&&!Bf(r.style,e.style,1)&&(eqe(n,r.style),gW(n,e.style)),Object.assign(this.props,e),this.updateHTML()}updateHTML(){this.rootElement&&this.onRenderHTML(this.rootElement)}onCreateRootElement(){const e=["deck-widget",this.className,this.props.className],r=document.createElement("div");return e.filter(n=>typeof n=="string"&&n.length>0).forEach(n=>r.classList.add(n)),gW(r,this.props.style),r}_onAdd(e){return this.onAdd(e)??this.onCreateRootElement()}onAdd(e){}onRemove(){}onViewportChange(e){}onRedraw(e){}onHover(e,r){}onClick(e,r){}onDrag(e,r){}onDragStart(e,r){}onDragEnd(e,r){}}_6.defaultProps={id:"widget",style:{},_container:null,className:""};const tqe={zIndex:"1",position:"absolute",pointerEvents:"none",color:"#a0a7b4",backgroundColor:"#29323c",padding:"10px",top:"0",left:"0",display:"none"};class vne extends _6{constructor(e={}){super(e),this.id="default-tooltip",this.placement="fill",this.className="deck-tooltip",this.isVisible=!1,this.setProps(e)}onCreateRootElement(){const e=document.createElement("div");return e.className=this.className,Object.assign(e.style,tqe),e}onRenderHTML(e){}onViewportChange(e){this.isVisible&&e.id===this.lastViewport?.id&&!e.equals(this.lastViewport)&&this.setTooltip(null),this.lastViewport=e}onHover(e){const{deck:r}=this,n=r&&r.props.getTooltip;if(!n)return;const i=n(e);this.setTooltip(i,e.x,e.y)}setTooltip(e,r,n){const i=this.rootElement;if(i){if(typeof e=="string")i.innerText=e;else if(e)e.text&&(i.innerText=e.text),e.html&&(i.innerHTML=e.html),e.className&&(i.className=e.className);else{this.isVisible=!1,i.style.display="none";return}this.isVisible=!0,i.style.display="block",i.style.transform=`translate(${r}px, ${n}px)`,e&&typeof e=="object"&&"style"in e&&Object.assign(i.style,e.style)}}}vne.defaultProps={..._6.defaultProps};var v0;(function(t){t[t.DEPTH_BUFFER_BIT=256]="DEPTH_BUFFER_BIT",t[t.STENCIL_BUFFER_BIT=1024]="STENCIL_BUFFER_BIT",t[t.COLOR_BUFFER_BIT=16384]="COLOR_BUFFER_BIT",t[t.POINTS=0]="POINTS",t[t.LINES=1]="LINES",t[t.LINE_LOOP=2]="LINE_LOOP",t[t.LINE_STRIP=3]="LINE_STRIP",t[t.TRIANGLES=4]="TRIANGLES",t[t.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",t[t.TRIANGLE_FAN=6]="TRIANGLE_FAN",t[t.ZERO=0]="ZERO",t[t.ONE=1]="ONE",t[t.SRC_COLOR=768]="SRC_COLOR",t[t.ONE_MINUS_SRC_COLOR=769]="ONE_MINUS_SRC_COLOR",t[t.SRC_ALPHA=770]="SRC_ALPHA",t[t.ONE_MINUS_SRC_ALPHA=771]="ONE_MINUS_SRC_ALPHA",t[t.DST_ALPHA=772]="DST_ALPHA",t[t.ONE_MINUS_DST_ALPHA=773]="ONE_MINUS_DST_ALPHA",t[t.DST_COLOR=774]="DST_COLOR",t[t.ONE_MINUS_DST_COLOR=775]="ONE_MINUS_DST_COLOR",t[t.SRC_ALPHA_SATURATE=776]="SRC_ALPHA_SATURATE",t[t.CONSTANT_COLOR=32769]="CONSTANT_COLOR",t[t.ONE_MINUS_CONSTANT_COLOR=32770]="ONE_MINUS_CONSTANT_COLOR",t[t.CONSTANT_ALPHA=32771]="CONSTANT_ALPHA",t[t.ONE_MINUS_CONSTANT_ALPHA=32772]="ONE_MINUS_CONSTANT_ALPHA",t[t.FUNC_ADD=32774]="FUNC_ADD",t[t.FUNC_SUBTRACT=32778]="FUNC_SUBTRACT",t[t.FUNC_REVERSE_SUBTRACT=32779]="FUNC_REVERSE_SUBTRACT",t[t.BLEND_EQUATION=32777]="BLEND_EQUATION",t[t.BLEND_EQUATION_RGB=32777]="BLEND_EQUATION_RGB",t[t.BLEND_EQUATION_ALPHA=34877]="BLEND_EQUATION_ALPHA",t[t.BLEND_DST_RGB=32968]="BLEND_DST_RGB",t[t.BLEND_SRC_RGB=32969]="BLEND_SRC_RGB",t[t.BLEND_DST_ALPHA=32970]="BLEND_DST_ALPHA",t[t.BLEND_SRC_ALPHA=32971]="BLEND_SRC_ALPHA",t[t.BLEND_COLOR=32773]="BLEND_COLOR",t[t.ARRAY_BUFFER_BINDING=34964]="ARRAY_BUFFER_BINDING",t[t.ELEMENT_ARRAY_BUFFER_BINDING=34965]="ELEMENT_ARRAY_BUFFER_BINDING",t[t.LINE_WIDTH=2849]="LINE_WIDTH",t[t.ALIASED_POINT_SIZE_RANGE=33901]="ALIASED_POINT_SIZE_RANGE",t[t.ALIASED_LINE_WIDTH_RANGE=33902]="ALIASED_LINE_WIDTH_RANGE",t[t.CULL_FACE_MODE=2885]="CULL_FACE_MODE",t[t.FRONT_FACE=2886]="FRONT_FACE",t[t.DEPTH_RANGE=2928]="DEPTH_RANGE",t[t.DEPTH_WRITEMASK=2930]="DEPTH_WRITEMASK",t[t.DEPTH_CLEAR_VALUE=2931]="DEPTH_CLEAR_VALUE",t[t.DEPTH_FUNC=2932]="DEPTH_FUNC",t[t.STENCIL_CLEAR_VALUE=2961]="STENCIL_CLEAR_VALUE",t[t.STENCIL_FUNC=2962]="STENCIL_FUNC",t[t.STENCIL_FAIL=2964]="STENCIL_FAIL",t[t.STENCIL_PASS_DEPTH_FAIL=2965]="STENCIL_PASS_DEPTH_FAIL",t[t.STENCIL_PASS_DEPTH_PASS=2966]="STENCIL_PASS_DEPTH_PASS",t[t.STENCIL_REF=2967]="STENCIL_REF",t[t.STENCIL_VALUE_MASK=2963]="STENCIL_VALUE_MASK",t[t.STENCIL_WRITEMASK=2968]="STENCIL_WRITEMASK",t[t.STENCIL_BACK_FUNC=34816]="STENCIL_BACK_FUNC",t[t.STENCIL_BACK_FAIL=34817]="STENCIL_BACK_FAIL",t[t.STENCIL_BACK_PASS_DEPTH_FAIL=34818]="STENCIL_BACK_PASS_DEPTH_FAIL",t[t.STENCIL_BACK_PASS_DEPTH_PASS=34819]="STENCIL_BACK_PASS_DEPTH_PASS",t[t.STENCIL_BACK_REF=36003]="STENCIL_BACK_REF",t[t.STENCIL_BACK_VALUE_MASK=36004]="STENCIL_BACK_VALUE_MASK",t[t.STENCIL_BACK_WRITEMASK=36005]="STENCIL_BACK_WRITEMASK",t[t.VIEWPORT=2978]="VIEWPORT",t[t.SCISSOR_BOX=3088]="SCISSOR_BOX",t[t.COLOR_CLEAR_VALUE=3106]="COLOR_CLEAR_VALUE",t[t.COLOR_WRITEMASK=3107]="COLOR_WRITEMASK",t[t.UNPACK_ALIGNMENT=3317]="UNPACK_ALIGNMENT",t[t.PACK_ALIGNMENT=3333]="PACK_ALIGNMENT",t[t.MAX_TEXTURE_SIZE=3379]="MAX_TEXTURE_SIZE",t[t.MAX_VIEWPORT_DIMS=3386]="MAX_VIEWPORT_DIMS",t[t.SUBPIXEL_BITS=3408]="SUBPIXEL_BITS",t[t.RED_BITS=3410]="RED_BITS",t[t.GREEN_BITS=3411]="GREEN_BITS",t[t.BLUE_BITS=3412]="BLUE_BITS",t[t.ALPHA_BITS=3413]="ALPHA_BITS",t[t.DEPTH_BITS=3414]="DEPTH_BITS",t[t.STENCIL_BITS=3415]="STENCIL_BITS",t[t.POLYGON_OFFSET_UNITS=10752]="POLYGON_OFFSET_UNITS",t[t.POLYGON_OFFSET_FACTOR=32824]="POLYGON_OFFSET_FACTOR",t[t.TEXTURE_BINDING_2D=32873]="TEXTURE_BINDING_2D",t[t.SAMPLE_BUFFERS=32936]="SAMPLE_BUFFERS",t[t.SAMPLES=32937]="SAMPLES",t[t.SAMPLE_COVERAGE_VALUE=32938]="SAMPLE_COVERAGE_VALUE",t[t.SAMPLE_COVERAGE_INVERT=32939]="SAMPLE_COVERAGE_INVERT",t[t.COMPRESSED_TEXTURE_FORMATS=34467]="COMPRESSED_TEXTURE_FORMATS",t[t.VENDOR=7936]="VENDOR",t[t.RENDERER=7937]="RENDERER",t[t.VERSION=7938]="VERSION",t[t.IMPLEMENTATION_COLOR_READ_TYPE=35738]="IMPLEMENTATION_COLOR_READ_TYPE",t[t.IMPLEMENTATION_COLOR_READ_FORMAT=35739]="IMPLEMENTATION_COLOR_READ_FORMAT",t[t.BROWSER_DEFAULT_WEBGL=37444]="BROWSER_DEFAULT_WEBGL",t[t.STATIC_DRAW=35044]="STATIC_DRAW",t[t.STREAM_DRAW=35040]="STREAM_DRAW",t[t.DYNAMIC_DRAW=35048]="DYNAMIC_DRAW",t[t.ARRAY_BUFFER=34962]="ARRAY_BUFFER",t[t.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",t[t.BUFFER_SIZE=34660]="BUFFER_SIZE",t[t.BUFFER_USAGE=34661]="BUFFER_USAGE",t[t.CURRENT_VERTEX_ATTRIB=34342]="CURRENT_VERTEX_ATTRIB",t[t.VERTEX_ATTRIB_ARRAY_ENABLED=34338]="VERTEX_ATTRIB_ARRAY_ENABLED",t[t.VERTEX_ATTRIB_ARRAY_SIZE=34339]="VERTEX_ATTRIB_ARRAY_SIZE",t[t.VERTEX_ATTRIB_ARRAY_STRIDE=34340]="VERTEX_ATTRIB_ARRAY_STRIDE",t[t.VERTEX_ATTRIB_ARRAY_TYPE=34341]="VERTEX_ATTRIB_ARRAY_TYPE",t[t.VERTEX_ATTRIB_ARRAY_NORMALIZED=34922]="VERTEX_ATTRIB_ARRAY_NORMALIZED",t[t.VERTEX_ATTRIB_ARRAY_POINTER=34373]="VERTEX_ATTRIB_ARRAY_POINTER",t[t.VERTEX_ATTRIB_ARRAY_BUFFER_BINDING=34975]="VERTEX_ATTRIB_ARRAY_BUFFER_BINDING",t[t.CULL_FACE=2884]="CULL_FACE",t[t.FRONT=1028]="FRONT",t[t.BACK=1029]="BACK",t[t.FRONT_AND_BACK=1032]="FRONT_AND_BACK",t[t.BLEND=3042]="BLEND",t[t.DEPTH_TEST=2929]="DEPTH_TEST",t[t.DITHER=3024]="DITHER",t[t.POLYGON_OFFSET_FILL=32823]="POLYGON_OFFSET_FILL",t[t.SAMPLE_ALPHA_TO_COVERAGE=32926]="SAMPLE_ALPHA_TO_COVERAGE",t[t.SAMPLE_COVERAGE=32928]="SAMPLE_COVERAGE",t[t.SCISSOR_TEST=3089]="SCISSOR_TEST",t[t.STENCIL_TEST=2960]="STENCIL_TEST",t[t.NO_ERROR=0]="NO_ERROR",t[t.INVALID_ENUM=1280]="INVALID_ENUM",t[t.INVALID_VALUE=1281]="INVALID_VALUE",t[t.INVALID_OPERATION=1282]="INVALID_OPERATION",t[t.OUT_OF_MEMORY=1285]="OUT_OF_MEMORY",t[t.CONTEXT_LOST_WEBGL=37442]="CONTEXT_LOST_WEBGL",t[t.CW=2304]="CW",t[t.CCW=2305]="CCW",t[t.DONT_CARE=4352]="DONT_CARE",t[t.FASTEST=4353]="FASTEST",t[t.NICEST=4354]="NICEST",t[t.GENERATE_MIPMAP_HINT=33170]="GENERATE_MIPMAP_HINT",t[t.BYTE=5120]="BYTE",t[t.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",t[t.SHORT=5122]="SHORT",t[t.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",t[t.INT=5124]="INT",t[t.UNSIGNED_INT=5125]="UNSIGNED_INT",t[t.FLOAT=5126]="FLOAT",t[t.DOUBLE=5130]="DOUBLE",t[t.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",t[t.ALPHA=6406]="ALPHA",t[t.RGB=6407]="RGB",t[t.RGBA=6408]="RGBA",t[t.LUMINANCE=6409]="LUMINANCE",t[t.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",t[t.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",t[t.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",t[t.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",t[t.FRAGMENT_SHADER=35632]="FRAGMENT_SHADER",t[t.VERTEX_SHADER=35633]="VERTEX_SHADER",t[t.COMPILE_STATUS=35713]="COMPILE_STATUS",t[t.DELETE_STATUS=35712]="DELETE_STATUS",t[t.LINK_STATUS=35714]="LINK_STATUS",t[t.VALIDATE_STATUS=35715]="VALIDATE_STATUS",t[t.ATTACHED_SHADERS=35717]="ATTACHED_SHADERS",t[t.ACTIVE_ATTRIBUTES=35721]="ACTIVE_ATTRIBUTES",t[t.ACTIVE_UNIFORMS=35718]="ACTIVE_UNIFORMS",t[t.MAX_VERTEX_ATTRIBS=34921]="MAX_VERTEX_ATTRIBS",t[t.MAX_VERTEX_UNIFORM_VECTORS=36347]="MAX_VERTEX_UNIFORM_VECTORS",t[t.MAX_VARYING_VECTORS=36348]="MAX_VARYING_VECTORS",t[t.MAX_COMBINED_TEXTURE_IMAGE_UNITS=35661]="MAX_COMBINED_TEXTURE_IMAGE_UNITS",t[t.MAX_VERTEX_TEXTURE_IMAGE_UNITS=35660]="MAX_VERTEX_TEXTURE_IMAGE_UNITS",t[t.MAX_TEXTURE_IMAGE_UNITS=34930]="MAX_TEXTURE_IMAGE_UNITS",t[t.MAX_FRAGMENT_UNIFORM_VECTORS=36349]="MAX_FRAGMENT_UNIFORM_VECTORS",t[t.SHADER_TYPE=35663]="SHADER_TYPE",t[t.SHADING_LANGUAGE_VERSION=35724]="SHADING_LANGUAGE_VERSION",t[t.CURRENT_PROGRAM=35725]="CURRENT_PROGRAM",t[t.NEVER=512]="NEVER",t[t.LESS=513]="LESS",t[t.EQUAL=514]="EQUAL",t[t.LEQUAL=515]="LEQUAL",t[t.GREATER=516]="GREATER",t[t.NOTEQUAL=517]="NOTEQUAL",t[t.GEQUAL=518]="GEQUAL",t[t.ALWAYS=519]="ALWAYS",t[t.KEEP=7680]="KEEP",t[t.REPLACE=7681]="REPLACE",t[t.INCR=7682]="INCR",t[t.DECR=7683]="DECR",t[t.INVERT=5386]="INVERT",t[t.INCR_WRAP=34055]="INCR_WRAP",t[t.DECR_WRAP=34056]="DECR_WRAP",t[t.NEAREST=9728]="NEAREST",t[t.LINEAR=9729]="LINEAR",t[t.NEAREST_MIPMAP_NEAREST=9984]="NEAREST_MIPMAP_NEAREST",t[t.LINEAR_MIPMAP_NEAREST=9985]="LINEAR_MIPMAP_NEAREST",t[t.NEAREST_MIPMAP_LINEAR=9986]="NEAREST_MIPMAP_LINEAR",t[t.LINEAR_MIPMAP_LINEAR=9987]="LINEAR_MIPMAP_LINEAR",t[t.TEXTURE_MAG_FILTER=10240]="TEXTURE_MAG_FILTER",t[t.TEXTURE_MIN_FILTER=10241]="TEXTURE_MIN_FILTER",t[t.TEXTURE_WRAP_S=10242]="TEXTURE_WRAP_S",t[t.TEXTURE_WRAP_T=10243]="TEXTURE_WRAP_T",t[t.TEXTURE_2D=3553]="TEXTURE_2D",t[t.TEXTURE=5890]="TEXTURE",t[t.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",t[t.TEXTURE_BINDING_CUBE_MAP=34068]="TEXTURE_BINDING_CUBE_MAP",t[t.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",t[t.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",t[t.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",t[t.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",t[t.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",t[t.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z",t[t.MAX_CUBE_MAP_TEXTURE_SIZE=34076]="MAX_CUBE_MAP_TEXTURE_SIZE",t[t.TEXTURE0=33984]="TEXTURE0",t[t.ACTIVE_TEXTURE=34016]="ACTIVE_TEXTURE",t[t.REPEAT=10497]="REPEAT",t[t.CLAMP_TO_EDGE=33071]="CLAMP_TO_EDGE",t[t.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT",t[t.TEXTURE_WIDTH=4096]="TEXTURE_WIDTH",t[t.TEXTURE_HEIGHT=4097]="TEXTURE_HEIGHT",t[t.FLOAT_VEC2=35664]="FLOAT_VEC2",t[t.FLOAT_VEC3=35665]="FLOAT_VEC3",t[t.FLOAT_VEC4=35666]="FLOAT_VEC4",t[t.INT_VEC2=35667]="INT_VEC2",t[t.INT_VEC3=35668]="INT_VEC3",t[t.INT_VEC4=35669]="INT_VEC4",t[t.BOOL=35670]="BOOL",t[t.BOOL_VEC2=35671]="BOOL_VEC2",t[t.BOOL_VEC3=35672]="BOOL_VEC3",t[t.BOOL_VEC4=35673]="BOOL_VEC4",t[t.FLOAT_MAT2=35674]="FLOAT_MAT2",t[t.FLOAT_MAT3=35675]="FLOAT_MAT3",t[t.FLOAT_MAT4=35676]="FLOAT_MAT4",t[t.SAMPLER_2D=35678]="SAMPLER_2D",t[t.SAMPLER_CUBE=35680]="SAMPLER_CUBE",t[t.LOW_FLOAT=36336]="LOW_FLOAT",t[t.MEDIUM_FLOAT=36337]="MEDIUM_FLOAT",t[t.HIGH_FLOAT=36338]="HIGH_FLOAT",t[t.LOW_INT=36339]="LOW_INT",t[t.MEDIUM_INT=36340]="MEDIUM_INT",t[t.HIGH_INT=36341]="HIGH_INT",t[t.FRAMEBUFFER=36160]="FRAMEBUFFER",t[t.RENDERBUFFER=36161]="RENDERBUFFER",t[t.RGBA4=32854]="RGBA4",t[t.RGB5_A1=32855]="RGB5_A1",t[t.RGB565=36194]="RGB565",t[t.DEPTH_COMPONENT16=33189]="DEPTH_COMPONENT16",t[t.STENCIL_INDEX=6401]="STENCIL_INDEX",t[t.STENCIL_INDEX8=36168]="STENCIL_INDEX8",t[t.DEPTH_STENCIL=34041]="DEPTH_STENCIL",t[t.RENDERBUFFER_WIDTH=36162]="RENDERBUFFER_WIDTH",t[t.RENDERBUFFER_HEIGHT=36163]="RENDERBUFFER_HEIGHT",t[t.RENDERBUFFER_INTERNAL_FORMAT=36164]="RENDERBUFFER_INTERNAL_FORMAT",t[t.RENDERBUFFER_RED_SIZE=36176]="RENDERBUFFER_RED_SIZE",t[t.RENDERBUFFER_GREEN_SIZE=36177]="RENDERBUFFER_GREEN_SIZE",t[t.RENDERBUFFER_BLUE_SIZE=36178]="RENDERBUFFER_BLUE_SIZE",t[t.RENDERBUFFER_ALPHA_SIZE=36179]="RENDERBUFFER_ALPHA_SIZE",t[t.RENDERBUFFER_DEPTH_SIZE=36180]="RENDERBUFFER_DEPTH_SIZE",t[t.RENDERBUFFER_STENCIL_SIZE=36181]="RENDERBUFFER_STENCIL_SIZE",t[t.FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE=36048]="FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE",t[t.FRAMEBUFFER_ATTACHMENT_OBJECT_NAME=36049]="FRAMEBUFFER_ATTACHMENT_OBJECT_NAME",t[t.FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL=36050]="FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL",t[t.FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE=36051]="FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE",t[t.COLOR_ATTACHMENT0=36064]="COLOR_ATTACHMENT0",t[t.DEPTH_ATTACHMENT=36096]="DEPTH_ATTACHMENT",t[t.STENCIL_ATTACHMENT=36128]="STENCIL_ATTACHMENT",t[t.DEPTH_STENCIL_ATTACHMENT=33306]="DEPTH_STENCIL_ATTACHMENT",t[t.NONE=0]="NONE",t[t.FRAMEBUFFER_COMPLETE=36053]="FRAMEBUFFER_COMPLETE",t[t.FRAMEBUFFER_INCOMPLETE_ATTACHMENT=36054]="FRAMEBUFFER_INCOMPLETE_ATTACHMENT",t[t.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT=36055]="FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT",t[t.FRAMEBUFFER_INCOMPLETE_DIMENSIONS=36057]="FRAMEBUFFER_INCOMPLETE_DIMENSIONS",t[t.FRAMEBUFFER_UNSUPPORTED=36061]="FRAMEBUFFER_UNSUPPORTED",t[t.FRAMEBUFFER_BINDING=36006]="FRAMEBUFFER_BINDING",t[t.RENDERBUFFER_BINDING=36007]="RENDERBUFFER_BINDING",t[t.READ_FRAMEBUFFER=36008]="READ_FRAMEBUFFER",t[t.DRAW_FRAMEBUFFER=36009]="DRAW_FRAMEBUFFER",t[t.MAX_RENDERBUFFER_SIZE=34024]="MAX_RENDERBUFFER_SIZE",t[t.INVALID_FRAMEBUFFER_OPERATION=1286]="INVALID_FRAMEBUFFER_OPERATION",t[t.UNPACK_FLIP_Y_WEBGL=37440]="UNPACK_FLIP_Y_WEBGL",t[t.UNPACK_PREMULTIPLY_ALPHA_WEBGL=37441]="UNPACK_PREMULTIPLY_ALPHA_WEBGL",t[t.UNPACK_COLORSPACE_CONVERSION_WEBGL=37443]="UNPACK_COLORSPACE_CONVERSION_WEBGL",t[t.READ_BUFFER=3074]="READ_BUFFER",t[t.UNPACK_ROW_LENGTH=3314]="UNPACK_ROW_LENGTH",t[t.UNPACK_SKIP_ROWS=3315]="UNPACK_SKIP_ROWS",t[t.UNPACK_SKIP_PIXELS=3316]="UNPACK_SKIP_PIXELS",t[t.PACK_ROW_LENGTH=3330]="PACK_ROW_LENGTH",t[t.PACK_SKIP_ROWS=3331]="PACK_SKIP_ROWS",t[t.PACK_SKIP_PIXELS=3332]="PACK_SKIP_PIXELS",t[t.TEXTURE_BINDING_3D=32874]="TEXTURE_BINDING_3D",t[t.UNPACK_SKIP_IMAGES=32877]="UNPACK_SKIP_IMAGES",t[t.UNPACK_IMAGE_HEIGHT=32878]="UNPACK_IMAGE_HEIGHT",t[t.MAX_3D_TEXTURE_SIZE=32883]="MAX_3D_TEXTURE_SIZE",t[t.MAX_ELEMENTS_VERTICES=33e3]="MAX_ELEMENTS_VERTICES",t[t.MAX_ELEMENTS_INDICES=33001]="MAX_ELEMENTS_INDICES",t[t.MAX_TEXTURE_LOD_BIAS=34045]="MAX_TEXTURE_LOD_BIAS",t[t.MAX_FRAGMENT_UNIFORM_COMPONENTS=35657]="MAX_FRAGMENT_UNIFORM_COMPONENTS",t[t.MAX_VERTEX_UNIFORM_COMPONENTS=35658]="MAX_VERTEX_UNIFORM_COMPONENTS",t[t.MAX_ARRAY_TEXTURE_LAYERS=35071]="MAX_ARRAY_TEXTURE_LAYERS",t[t.MIN_PROGRAM_TEXEL_OFFSET=35076]="MIN_PROGRAM_TEXEL_OFFSET",t[t.MAX_PROGRAM_TEXEL_OFFSET=35077]="MAX_PROGRAM_TEXEL_OFFSET",t[t.MAX_VARYING_COMPONENTS=35659]="MAX_VARYING_COMPONENTS",t[t.FRAGMENT_SHADER_DERIVATIVE_HINT=35723]="FRAGMENT_SHADER_DERIVATIVE_HINT",t[t.RASTERIZER_DISCARD=35977]="RASTERIZER_DISCARD",t[t.VERTEX_ARRAY_BINDING=34229]="VERTEX_ARRAY_BINDING",t[t.MAX_VERTEX_OUTPUT_COMPONENTS=37154]="MAX_VERTEX_OUTPUT_COMPONENTS",t[t.MAX_FRAGMENT_INPUT_COMPONENTS=37157]="MAX_FRAGMENT_INPUT_COMPONENTS",t[t.MAX_SERVER_WAIT_TIMEOUT=37137]="MAX_SERVER_WAIT_TIMEOUT",t[t.MAX_ELEMENT_INDEX=36203]="MAX_ELEMENT_INDEX",t[t.RED=6403]="RED",t[t.RGB8=32849]="RGB8",t[t.RGBA8=32856]="RGBA8",t[t.RGB10_A2=32857]="RGB10_A2",t[t.TEXTURE_3D=32879]="TEXTURE_3D",t[t.TEXTURE_WRAP_R=32882]="TEXTURE_WRAP_R",t[t.TEXTURE_MIN_LOD=33082]="TEXTURE_MIN_LOD",t[t.TEXTURE_MAX_LOD=33083]="TEXTURE_MAX_LOD",t[t.TEXTURE_BASE_LEVEL=33084]="TEXTURE_BASE_LEVEL",t[t.TEXTURE_MAX_LEVEL=33085]="TEXTURE_MAX_LEVEL",t[t.TEXTURE_COMPARE_MODE=34892]="TEXTURE_COMPARE_MODE",t[t.TEXTURE_COMPARE_FUNC=34893]="TEXTURE_COMPARE_FUNC",t[t.SRGB=35904]="SRGB",t[t.SRGB8=35905]="SRGB8",t[t.SRGB8_ALPHA8=35907]="SRGB8_ALPHA8",t[t.COMPARE_REF_TO_TEXTURE=34894]="COMPARE_REF_TO_TEXTURE",t[t.RGBA32F=34836]="RGBA32F",t[t.RGB32F=34837]="RGB32F",t[t.RGBA16F=34842]="RGBA16F",t[t.RGB16F=34843]="RGB16F",t[t.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",t[t.TEXTURE_BINDING_2D_ARRAY=35869]="TEXTURE_BINDING_2D_ARRAY",t[t.R11F_G11F_B10F=35898]="R11F_G11F_B10F",t[t.RGB9_E5=35901]="RGB9_E5",t[t.RGBA32UI=36208]="RGBA32UI",t[t.RGB32UI=36209]="RGB32UI",t[t.RGBA16UI=36214]="RGBA16UI",t[t.RGB16UI=36215]="RGB16UI",t[t.RGBA8UI=36220]="RGBA8UI",t[t.RGB8UI=36221]="RGB8UI",t[t.RGBA32I=36226]="RGBA32I",t[t.RGB32I=36227]="RGB32I",t[t.RGBA16I=36232]="RGBA16I",t[t.RGB16I=36233]="RGB16I",t[t.RGBA8I=36238]="RGBA8I",t[t.RGB8I=36239]="RGB8I",t[t.RED_INTEGER=36244]="RED_INTEGER",t[t.RGB_INTEGER=36248]="RGB_INTEGER",t[t.RGBA_INTEGER=36249]="RGBA_INTEGER",t[t.R8=33321]="R8",t[t.RG8=33323]="RG8",t[t.R16F=33325]="R16F",t[t.R32F=33326]="R32F",t[t.RG16F=33327]="RG16F",t[t.RG32F=33328]="RG32F",t[t.R8I=33329]="R8I",t[t.R8UI=33330]="R8UI",t[t.R16I=33331]="R16I",t[t.R16UI=33332]="R16UI",t[t.R32I=33333]="R32I",t[t.R32UI=33334]="R32UI",t[t.RG8I=33335]="RG8I",t[t.RG8UI=33336]="RG8UI",t[t.RG16I=33337]="RG16I",t[t.RG16UI=33338]="RG16UI",t[t.RG32I=33339]="RG32I",t[t.RG32UI=33340]="RG32UI",t[t.R8_SNORM=36756]="R8_SNORM",t[t.RG8_SNORM=36757]="RG8_SNORM",t[t.RGB8_SNORM=36758]="RGB8_SNORM",t[t.RGBA8_SNORM=36759]="RGBA8_SNORM",t[t.RGB10_A2UI=36975]="RGB10_A2UI",t[t.TEXTURE_IMMUTABLE_FORMAT=37167]="TEXTURE_IMMUTABLE_FORMAT",t[t.TEXTURE_IMMUTABLE_LEVELS=33503]="TEXTURE_IMMUTABLE_LEVELS",t[t.UNSIGNED_INT_2_10_10_10_REV=33640]="UNSIGNED_INT_2_10_10_10_REV",t[t.UNSIGNED_INT_10F_11F_11F_REV=35899]="UNSIGNED_INT_10F_11F_11F_REV",t[t.UNSIGNED_INT_5_9_9_9_REV=35902]="UNSIGNED_INT_5_9_9_9_REV",t[t.FLOAT_32_UNSIGNED_INT_24_8_REV=36269]="FLOAT_32_UNSIGNED_INT_24_8_REV",t[t.UNSIGNED_INT_24_8=34042]="UNSIGNED_INT_24_8",t[t.HALF_FLOAT=5131]="HALF_FLOAT",t[t.RG=33319]="RG",t[t.RG_INTEGER=33320]="RG_INTEGER",t[t.INT_2_10_10_10_REV=36255]="INT_2_10_10_10_REV",t[t.CURRENT_QUERY=34917]="CURRENT_QUERY",t[t.QUERY_RESULT=34918]="QUERY_RESULT",t[t.QUERY_RESULT_AVAILABLE=34919]="QUERY_RESULT_AVAILABLE",t[t.ANY_SAMPLES_PASSED=35887]="ANY_SAMPLES_PASSED",t[t.ANY_SAMPLES_PASSED_CONSERVATIVE=36202]="ANY_SAMPLES_PASSED_CONSERVATIVE",t[t.MAX_DRAW_BUFFERS=34852]="MAX_DRAW_BUFFERS",t[t.DRAW_BUFFER0=34853]="DRAW_BUFFER0",t[t.DRAW_BUFFER1=34854]="DRAW_BUFFER1",t[t.DRAW_BUFFER2=34855]="DRAW_BUFFER2",t[t.DRAW_BUFFER3=34856]="DRAW_BUFFER3",t[t.DRAW_BUFFER4=34857]="DRAW_BUFFER4",t[t.DRAW_BUFFER5=34858]="DRAW_BUFFER5",t[t.DRAW_BUFFER6=34859]="DRAW_BUFFER6",t[t.DRAW_BUFFER7=34860]="DRAW_BUFFER7",t[t.DRAW_BUFFER8=34861]="DRAW_BUFFER8",t[t.DRAW_BUFFER9=34862]="DRAW_BUFFER9",t[t.DRAW_BUFFER10=34863]="DRAW_BUFFER10",t[t.DRAW_BUFFER11=34864]="DRAW_BUFFER11",t[t.DRAW_BUFFER12=34865]="DRAW_BUFFER12",t[t.DRAW_BUFFER13=34866]="DRAW_BUFFER13",t[t.DRAW_BUFFER14=34867]="DRAW_BUFFER14",t[t.DRAW_BUFFER15=34868]="DRAW_BUFFER15",t[t.MAX_COLOR_ATTACHMENTS=36063]="MAX_COLOR_ATTACHMENTS",t[t.COLOR_ATTACHMENT1=36065]="COLOR_ATTACHMENT1",t[t.COLOR_ATTACHMENT2=36066]="COLOR_ATTACHMENT2",t[t.COLOR_ATTACHMENT3=36067]="COLOR_ATTACHMENT3",t[t.COLOR_ATTACHMENT4=36068]="COLOR_ATTACHMENT4",t[t.COLOR_ATTACHMENT5=36069]="COLOR_ATTACHMENT5",t[t.COLOR_ATTACHMENT6=36070]="COLOR_ATTACHMENT6",t[t.COLOR_ATTACHMENT7=36071]="COLOR_ATTACHMENT7",t[t.COLOR_ATTACHMENT8=36072]="COLOR_ATTACHMENT8",t[t.COLOR_ATTACHMENT9=36073]="COLOR_ATTACHMENT9",t[t.COLOR_ATTACHMENT10=36074]="COLOR_ATTACHMENT10",t[t.COLOR_ATTACHMENT11=36075]="COLOR_ATTACHMENT11",t[t.COLOR_ATTACHMENT12=36076]="COLOR_ATTACHMENT12",t[t.COLOR_ATTACHMENT13=36077]="COLOR_ATTACHMENT13",t[t.COLOR_ATTACHMENT14=36078]="COLOR_ATTACHMENT14",t[t.COLOR_ATTACHMENT15=36079]="COLOR_ATTACHMENT15",t[t.SAMPLER_3D=35679]="SAMPLER_3D",t[t.SAMPLER_2D_SHADOW=35682]="SAMPLER_2D_SHADOW",t[t.SAMPLER_2D_ARRAY=36289]="SAMPLER_2D_ARRAY",t[t.SAMPLER_2D_ARRAY_SHADOW=36292]="SAMPLER_2D_ARRAY_SHADOW",t[t.SAMPLER_CUBE_SHADOW=36293]="SAMPLER_CUBE_SHADOW",t[t.INT_SAMPLER_2D=36298]="INT_SAMPLER_2D",t[t.INT_SAMPLER_3D=36299]="INT_SAMPLER_3D",t[t.INT_SAMPLER_CUBE=36300]="INT_SAMPLER_CUBE",t[t.INT_SAMPLER_2D_ARRAY=36303]="INT_SAMPLER_2D_ARRAY",t[t.UNSIGNED_INT_SAMPLER_2D=36306]="UNSIGNED_INT_SAMPLER_2D",t[t.UNSIGNED_INT_SAMPLER_3D=36307]="UNSIGNED_INT_SAMPLER_3D",t[t.UNSIGNED_INT_SAMPLER_CUBE=36308]="UNSIGNED_INT_SAMPLER_CUBE",t[t.UNSIGNED_INT_SAMPLER_2D_ARRAY=36311]="UNSIGNED_INT_SAMPLER_2D_ARRAY",t[t.MAX_SAMPLES=36183]="MAX_SAMPLES",t[t.SAMPLER_BINDING=35097]="SAMPLER_BINDING",t[t.PIXEL_PACK_BUFFER=35051]="PIXEL_PACK_BUFFER",t[t.PIXEL_UNPACK_BUFFER=35052]="PIXEL_UNPACK_BUFFER",t[t.PIXEL_PACK_BUFFER_BINDING=35053]="PIXEL_PACK_BUFFER_BINDING",t[t.PIXEL_UNPACK_BUFFER_BINDING=35055]="PIXEL_UNPACK_BUFFER_BINDING",t[t.COPY_READ_BUFFER=36662]="COPY_READ_BUFFER",t[t.COPY_WRITE_BUFFER=36663]="COPY_WRITE_BUFFER",t[t.COPY_READ_BUFFER_BINDING=36662]="COPY_READ_BUFFER_BINDING",t[t.COPY_WRITE_BUFFER_BINDING=36663]="COPY_WRITE_BUFFER_BINDING",t[t.FLOAT_MAT2x3=35685]="FLOAT_MAT2x3",t[t.FLOAT_MAT2x4=35686]="FLOAT_MAT2x4",t[t.FLOAT_MAT3x2=35687]="FLOAT_MAT3x2",t[t.FLOAT_MAT3x4=35688]="FLOAT_MAT3x4",t[t.FLOAT_MAT4x2=35689]="FLOAT_MAT4x2",t[t.FLOAT_MAT4x3=35690]="FLOAT_MAT4x3",t[t.UNSIGNED_INT_VEC2=36294]="UNSIGNED_INT_VEC2",t[t.UNSIGNED_INT_VEC3=36295]="UNSIGNED_INT_VEC3",t[t.UNSIGNED_INT_VEC4=36296]="UNSIGNED_INT_VEC4",t[t.UNSIGNED_NORMALIZED=35863]="UNSIGNED_NORMALIZED",t[t.SIGNED_NORMALIZED=36764]="SIGNED_NORMALIZED",t[t.VERTEX_ATTRIB_ARRAY_INTEGER=35069]="VERTEX_ATTRIB_ARRAY_INTEGER",t[t.VERTEX_ATTRIB_ARRAY_DIVISOR=35070]="VERTEX_ATTRIB_ARRAY_DIVISOR",t[t.TRANSFORM_FEEDBACK_BUFFER_MODE=35967]="TRANSFORM_FEEDBACK_BUFFER_MODE",t[t.MAX_TRANSFORM_FEEDBACK_SEPARATE_COMPONENTS=35968]="MAX_TRANSFORM_FEEDBACK_SEPARATE_COMPONENTS",t[t.TRANSFORM_FEEDBACK_VARYINGS=35971]="TRANSFORM_FEEDBACK_VARYINGS",t[t.TRANSFORM_FEEDBACK_BUFFER_START=35972]="TRANSFORM_FEEDBACK_BUFFER_START",t[t.TRANSFORM_FEEDBACK_BUFFER_SIZE=35973]="TRANSFORM_FEEDBACK_BUFFER_SIZE",t[t.TRANSFORM_FEEDBACK_PRIMITIVES_WRITTEN=35976]="TRANSFORM_FEEDBACK_PRIMITIVES_WRITTEN",t[t.MAX_TRANSFORM_FEEDBACK_INTERLEAVED_COMPONENTS=35978]="MAX_TRANSFORM_FEEDBACK_INTERLEAVED_COMPONENTS",t[t.MAX_TRANSFORM_FEEDBACK_SEPARATE_ATTRIBS=35979]="MAX_TRANSFORM_FEEDBACK_SEPARATE_ATTRIBS",t[t.INTERLEAVED_ATTRIBS=35980]="INTERLEAVED_ATTRIBS",t[t.SEPARATE_ATTRIBS=35981]="SEPARATE_ATTRIBS",t[t.TRANSFORM_FEEDBACK_BUFFER=35982]="TRANSFORM_FEEDBACK_BUFFER",t[t.TRANSFORM_FEEDBACK_BUFFER_BINDING=35983]="TRANSFORM_FEEDBACK_BUFFER_BINDING",t[t.TRANSFORM_FEEDBACK=36386]="TRANSFORM_FEEDBACK",t[t.TRANSFORM_FEEDBACK_PAUSED=36387]="TRANSFORM_FEEDBACK_PAUSED",t[t.TRANSFORM_FEEDBACK_ACTIVE=36388]="TRANSFORM_FEEDBACK_ACTIVE",t[t.TRANSFORM_FEEDBACK_BINDING=36389]="TRANSFORM_FEEDBACK_BINDING",t[t.FRAMEBUFFER_ATTACHMENT_COLOR_ENCODING=33296]="FRAMEBUFFER_ATTACHMENT_COLOR_ENCODING",t[t.FRAMEBUFFER_ATTACHMENT_COMPONENT_TYPE=33297]="FRAMEBUFFER_ATTACHMENT_COMPONENT_TYPE",t[t.FRAMEBUFFER_ATTACHMENT_RED_SIZE=33298]="FRAMEBUFFER_ATTACHMENT_RED_SIZE",t[t.FRAMEBUFFER_ATTACHMENT_GREEN_SIZE=33299]="FRAMEBUFFER_ATTACHMENT_GREEN_SIZE",t[t.FRAMEBUFFER_ATTACHMENT_BLUE_SIZE=33300]="FRAMEBUFFER_ATTACHMENT_BLUE_SIZE",t[t.FRAMEBUFFER_ATTACHMENT_ALPHA_SIZE=33301]="FRAMEBUFFER_ATTACHMENT_ALPHA_SIZE",t[t.FRAMEBUFFER_ATTACHMENT_DEPTH_SIZE=33302]="FRAMEBUFFER_ATTACHMENT_DEPTH_SIZE",t[t.FRAMEBUFFER_ATTACHMENT_STENCIL_SIZE=33303]="FRAMEBUFFER_ATTACHMENT_STENCIL_SIZE",t[t.FRAMEBUFFER_DEFAULT=33304]="FRAMEBUFFER_DEFAULT",t[t.DEPTH24_STENCIL8=35056]="DEPTH24_STENCIL8",t[t.DRAW_FRAMEBUFFER_BINDING=36006]="DRAW_FRAMEBUFFER_BINDING",t[t.READ_FRAMEBUFFER_BINDING=36010]="READ_FRAMEBUFFER_BINDING",t[t.RENDERBUFFER_SAMPLES=36011]="RENDERBUFFER_SAMPLES",t[t.FRAMEBUFFER_ATTACHMENT_TEXTURE_LAYER=36052]="FRAMEBUFFER_ATTACHMENT_TEXTURE_LAYER",t[t.FRAMEBUFFER_INCOMPLETE_MULTISAMPLE=36182]="FRAMEBUFFER_INCOMPLETE_MULTISAMPLE",t[t.UNIFORM_BUFFER=35345]="UNIFORM_BUFFER",t[t.UNIFORM_BUFFER_BINDING=35368]="UNIFORM_BUFFER_BINDING",t[t.UNIFORM_BUFFER_START=35369]="UNIFORM_BUFFER_START",t[t.UNIFORM_BUFFER_SIZE=35370]="UNIFORM_BUFFER_SIZE",t[t.MAX_VERTEX_UNIFORM_BLOCKS=35371]="MAX_VERTEX_UNIFORM_BLOCKS",t[t.MAX_FRAGMENT_UNIFORM_BLOCKS=35373]="MAX_FRAGMENT_UNIFORM_BLOCKS",t[t.MAX_COMBINED_UNIFORM_BLOCKS=35374]="MAX_COMBINED_UNIFORM_BLOCKS",t[t.MAX_UNIFORM_BUFFER_BINDINGS=35375]="MAX_UNIFORM_BUFFER_BINDINGS",t[t.MAX_UNIFORM_BLOCK_SIZE=35376]="MAX_UNIFORM_BLOCK_SIZE",t[t.MAX_COMBINED_VERTEX_UNIFORM_COMPONENTS=35377]="MAX_COMBINED_VERTEX_UNIFORM_COMPONENTS",t[t.MAX_COMBINED_FRAGMENT_UNIFORM_COMPONENTS=35379]="MAX_COMBINED_FRAGMENT_UNIFORM_COMPONENTS",t[t.UNIFORM_BUFFER_OFFSET_ALIGNMENT=35380]="UNIFORM_BUFFER_OFFSET_ALIGNMENT",t[t.ACTIVE_UNIFORM_BLOCKS=35382]="ACTIVE_UNIFORM_BLOCKS",t[t.UNIFORM_TYPE=35383]="UNIFORM_TYPE",t[t.UNIFORM_SIZE=35384]="UNIFORM_SIZE",t[t.UNIFORM_BLOCK_INDEX=35386]="UNIFORM_BLOCK_INDEX",t[t.UNIFORM_OFFSET=35387]="UNIFORM_OFFSET",t[t.UNIFORM_ARRAY_STRIDE=35388]="UNIFORM_ARRAY_STRIDE",t[t.UNIFORM_MATRIX_STRIDE=35389]="UNIFORM_MATRIX_STRIDE",t[t.UNIFORM_IS_ROW_MAJOR=35390]="UNIFORM_IS_ROW_MAJOR",t[t.UNIFORM_BLOCK_BINDING=35391]="UNIFORM_BLOCK_BINDING",t[t.UNIFORM_BLOCK_DATA_SIZE=35392]="UNIFORM_BLOCK_DATA_SIZE",t[t.UNIFORM_BLOCK_ACTIVE_UNIFORMS=35394]="UNIFORM_BLOCK_ACTIVE_UNIFORMS",t[t.UNIFORM_BLOCK_ACTIVE_UNIFORM_INDICES=35395]="UNIFORM_BLOCK_ACTIVE_UNIFORM_INDICES",t[t.UNIFORM_BLOCK_REFERENCED_BY_VERTEX_SHADER=35396]="UNIFORM_BLOCK_REFERENCED_BY_VERTEX_SHADER",t[t.UNIFORM_BLOCK_REFERENCED_BY_FRAGMENT_SHADER=35398]="UNIFORM_BLOCK_REFERENCED_BY_FRAGMENT_SHADER",t[t.OBJECT_TYPE=37138]="OBJECT_TYPE",t[t.SYNC_CONDITION=37139]="SYNC_CONDITION",t[t.SYNC_STATUS=37140]="SYNC_STATUS",t[t.SYNC_FLAGS=37141]="SYNC_FLAGS",t[t.SYNC_FENCE=37142]="SYNC_FENCE",t[t.SYNC_GPU_COMMANDS_COMPLETE=37143]="SYNC_GPU_COMMANDS_COMPLETE",t[t.UNSIGNALED=37144]="UNSIGNALED",t[t.SIGNALED=37145]="SIGNALED",t[t.ALREADY_SIGNALED=37146]="ALREADY_SIGNALED",t[t.TIMEOUT_EXPIRED=37147]="TIMEOUT_EXPIRED",t[t.CONDITION_SATISFIED=37148]="CONDITION_SATISFIED",t[t.WAIT_FAILED=37149]="WAIT_FAILED",t[t.SYNC_FLUSH_COMMANDS_BIT=1]="SYNC_FLUSH_COMMANDS_BIT",t[t.COLOR=6144]="COLOR",t[t.DEPTH=6145]="DEPTH",t[t.STENCIL=6146]="STENCIL",t[t.MIN=32775]="MIN",t[t.MAX=32776]="MAX",t[t.DEPTH_COMPONENT24=33190]="DEPTH_COMPONENT24",t[t.STREAM_READ=35041]="STREAM_READ",t[t.STREAM_COPY=35042]="STREAM_COPY",t[t.STATIC_READ=35045]="STATIC_READ",t[t.STATIC_COPY=35046]="STATIC_COPY",t[t.DYNAMIC_READ=35049]="DYNAMIC_READ",t[t.DYNAMIC_COPY=35050]="DYNAMIC_COPY",t[t.DEPTH_COMPONENT32F=36012]="DEPTH_COMPONENT32F",t[t.DEPTH32F_STENCIL8=36013]="DEPTH32F_STENCIL8",t[t.INVALID_INDEX=4294967295]="INVALID_INDEX",t[t.TIMEOUT_IGNORED=-1]="TIMEOUT_IGNORED",t[t.MAX_CLIENT_WAIT_TIMEOUT_WEBGL=37447]="MAX_CLIENT_WAIT_TIMEOUT_WEBGL",t[t.UNMASKED_VENDOR_WEBGL=37445]="UNMASKED_VENDOR_WEBGL",t[t.UNMASKED_RENDERER_WEBGL=37446]="UNMASKED_RENDERER_WEBGL",t[t.MAX_TEXTURE_MAX_ANISOTROPY_EXT=34047]="MAX_TEXTURE_MAX_ANISOTROPY_EXT",t[t.TEXTURE_MAX_ANISOTROPY_EXT=34046]="TEXTURE_MAX_ANISOTROPY_EXT",t[t.R16_EXT=33322]="R16_EXT",t[t.RG16_EXT=33324]="RG16_EXT",t[t.RGB16_EXT=32852]="RGB16_EXT",t[t.RGBA16_EXT=32859]="RGBA16_EXT",t[t.R16_SNORM_EXT=36760]="R16_SNORM_EXT",t[t.RG16_SNORM_EXT=36761]="RG16_SNORM_EXT",t[t.RGB16_SNORM_EXT=36762]="RGB16_SNORM_EXT",t[t.RGBA16_SNORM_EXT=36763]="RGBA16_SNORM_EXT",t[t.COMPRESSED_RGB_S3TC_DXT1_EXT=33776]="COMPRESSED_RGB_S3TC_DXT1_EXT",t[t.COMPRESSED_RGBA_S3TC_DXT1_EXT=33777]="COMPRESSED_RGBA_S3TC_DXT1_EXT",t[t.COMPRESSED_RGBA_S3TC_DXT3_EXT=33778]="COMPRESSED_RGBA_S3TC_DXT3_EXT",t[t.COMPRESSED_RGBA_S3TC_DXT5_EXT=33779]="COMPRESSED_RGBA_S3TC_DXT5_EXT",t[t.COMPRESSED_SRGB_S3TC_DXT1_EXT=35916]="COMPRESSED_SRGB_S3TC_DXT1_EXT",t[t.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT=35917]="COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT",t[t.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT=35918]="COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT",t[t.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT=35919]="COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT",t[t.COMPRESSED_RED_RGTC1_EXT=36283]="COMPRESSED_RED_RGTC1_EXT",t[t.COMPRESSED_SIGNED_RED_RGTC1_EXT=36284]="COMPRESSED_SIGNED_RED_RGTC1_EXT",t[t.COMPRESSED_RED_GREEN_RGTC2_EXT=36285]="COMPRESSED_RED_GREEN_RGTC2_EXT",t[t.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT=36286]="COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT",t[t.COMPRESSED_RGBA_BPTC_UNORM_EXT=36492]="COMPRESSED_RGBA_BPTC_UNORM_EXT",t[t.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT=36493]="COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT",t[t.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT=36494]="COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT",t[t.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT=36495]="COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT",t[t.COMPRESSED_R11_EAC=37488]="COMPRESSED_R11_EAC",t[t.COMPRESSED_SIGNED_R11_EAC=37489]="COMPRESSED_SIGNED_R11_EAC",t[t.COMPRESSED_RG11_EAC=37490]="COMPRESSED_RG11_EAC",t[t.COMPRESSED_SIGNED_RG11_EAC=37491]="COMPRESSED_SIGNED_RG11_EAC",t[t.COMPRESSED_RGB8_ETC2=37492]="COMPRESSED_RGB8_ETC2",t[t.COMPRESSED_RGBA8_ETC2_EAC=37493]="COMPRESSED_RGBA8_ETC2_EAC",t[t.COMPRESSED_SRGB8_ETC2=37494]="COMPRESSED_SRGB8_ETC2",t[t.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC=37495]="COMPRESSED_SRGB8_ALPHA8_ETC2_EAC",t[t.COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2=37496]="COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2",t[t.COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2=37497]="COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2",t[t.COMPRESSED_RGB_PVRTC_4BPPV1_IMG=35840]="COMPRESSED_RGB_PVRTC_4BPPV1_IMG",t[t.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG=35842]="COMPRESSED_RGBA_PVRTC_4BPPV1_IMG",t[t.COMPRESSED_RGB_PVRTC_2BPPV1_IMG=35841]="COMPRESSED_RGB_PVRTC_2BPPV1_IMG",t[t.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG=35843]="COMPRESSED_RGBA_PVRTC_2BPPV1_IMG",t[t.COMPRESSED_RGB_ETC1_WEBGL=36196]="COMPRESSED_RGB_ETC1_WEBGL",t[t.COMPRESSED_RGB_ATC_WEBGL=35986]="COMPRESSED_RGB_ATC_WEBGL",t[t.COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL=35986]="COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL",t[t.COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL=34798]="COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL",t[t.COMPRESSED_RGBA_ASTC_4x4_KHR=37808]="COMPRESSED_RGBA_ASTC_4x4_KHR",t[t.COMPRESSED_RGBA_ASTC_5x4_KHR=37809]="COMPRESSED_RGBA_ASTC_5x4_KHR",t[t.COMPRESSED_RGBA_ASTC_5x5_KHR=37810]="COMPRESSED_RGBA_ASTC_5x5_KHR",t[t.COMPRESSED_RGBA_ASTC_6x5_KHR=37811]="COMPRESSED_RGBA_ASTC_6x5_KHR",t[t.COMPRESSED_RGBA_ASTC_6x6_KHR=37812]="COMPRESSED_RGBA_ASTC_6x6_KHR",t[t.COMPRESSED_RGBA_ASTC_8x5_KHR=37813]="COMPRESSED_RGBA_ASTC_8x5_KHR",t[t.COMPRESSED_RGBA_ASTC_8x6_KHR=37814]="COMPRESSED_RGBA_ASTC_8x6_KHR",t[t.COMPRESSED_RGBA_ASTC_8x8_KHR=37815]="COMPRESSED_RGBA_ASTC_8x8_KHR",t[t.COMPRESSED_RGBA_ASTC_10x5_KHR=37816]="COMPRESSED_RGBA_ASTC_10x5_KHR",t[t.COMPRESSED_RGBA_ASTC_10x6_KHR=37817]="COMPRESSED_RGBA_ASTC_10x6_KHR",t[t.COMPRESSED_RGBA_ASTC_10x8_KHR=37818]="COMPRESSED_RGBA_ASTC_10x8_KHR",t[t.COMPRESSED_RGBA_ASTC_10x10_KHR=37819]="COMPRESSED_RGBA_ASTC_10x10_KHR",t[t.COMPRESSED_RGBA_ASTC_12x10_KHR=37820]="COMPRESSED_RGBA_ASTC_12x10_KHR",t[t.COMPRESSED_RGBA_ASTC_12x12_KHR=37821]="COMPRESSED_RGBA_ASTC_12x12_KHR",t[t.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR=37840]="COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR",t[t.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR=37841]="COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR",t[t.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR=37842]="COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR",t[t.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR=37843]="COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR",t[t.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR=37844]="COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR",t[t.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR=37845]="COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR",t[t.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR=37846]="COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR",t[t.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR=37847]="COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR",t[t.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR=37848]="COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR",t[t.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR=37849]="COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR",t[t.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR=37850]="COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR",t[t.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR=37851]="COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR",t[t.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR=37852]="COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR",t[t.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR=37853]="COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR",t[t.QUERY_COUNTER_BITS_EXT=34916]="QUERY_COUNTER_BITS_EXT",t[t.CURRENT_QUERY_EXT=34917]="CURRENT_QUERY_EXT",t[t.QUERY_RESULT_EXT=34918]="QUERY_RESULT_EXT",t[t.QUERY_RESULT_AVAILABLE_EXT=34919]="QUERY_RESULT_AVAILABLE_EXT",t[t.TIME_ELAPSED_EXT=35007]="TIME_ELAPSED_EXT",t[t.TIMESTAMP_EXT=36392]="TIMESTAMP_EXT",t[t.GPU_DISJOINT_EXT=36795]="GPU_DISJOINT_EXT",t[t.COMPLETION_STATUS_KHR=37297]="COMPLETION_STATUS_KHR",t[t.DEPTH_CLAMP_EXT=34383]="DEPTH_CLAMP_EXT",t[t.FIRST_VERTEX_CONVENTION_WEBGL=36429]="FIRST_VERTEX_CONVENTION_WEBGL",t[t.LAST_VERTEX_CONVENTION_WEBGL=36430]="LAST_VERTEX_CONVENTION_WEBGL",t[t.PROVOKING_VERTEX_WEBL=36431]="PROVOKING_VERTEX_WEBL",t[t.POLYGON_MODE_WEBGL=2880]="POLYGON_MODE_WEBGL",t[t.POLYGON_OFFSET_LINE_WEBGL=10754]="POLYGON_OFFSET_LINE_WEBGL",t[t.LINE_WEBGL=6913]="LINE_WEBGL",t[t.FILL_WEBGL=6914]="FILL_WEBGL",t[t.MAX_CLIP_DISTANCES_WEBGL=3378]="MAX_CLIP_DISTANCES_WEBGL",t[t.MAX_CULL_DISTANCES_WEBGL=33529]="MAX_CULL_DISTANCES_WEBGL",t[t.MAX_COMBINED_CLIP_AND_CULL_DISTANCES_WEBGL=33530]="MAX_COMBINED_CLIP_AND_CULL_DISTANCES_WEBGL",t[t.CLIP_DISTANCE0_WEBGL=12288]="CLIP_DISTANCE0_WEBGL",t[t.CLIP_DISTANCE1_WEBGL=12289]="CLIP_DISTANCE1_WEBGL",t[t.CLIP_DISTANCE2_WEBGL=12290]="CLIP_DISTANCE2_WEBGL",t[t.CLIP_DISTANCE3_WEBGL=12291]="CLIP_DISTANCE3_WEBGL",t[t.CLIP_DISTANCE4_WEBGL=12292]="CLIP_DISTANCE4_WEBGL",t[t.CLIP_DISTANCE5_WEBGL=12293]="CLIP_DISTANCE5_WEBGL",t[t.CLIP_DISTANCE6_WEBGL=12294]="CLIP_DISTANCE6_WEBGL",t[t.CLIP_DISTANCE7_WEBGL=12295]="CLIP_DISTANCE7_WEBGL",t[t.POLYGON_OFFSET_CLAMP_EXT=36379]="POLYGON_OFFSET_CLAMP_EXT",t[t.LOWER_LEFT_EXT=36001]="LOWER_LEFT_EXT",t[t.UPPER_LEFT_EXT=36002]="UPPER_LEFT_EXT",t[t.NEGATIVE_ONE_TO_ONE_EXT=37726]="NEGATIVE_ONE_TO_ONE_EXT",t[t.ZERO_TO_ONE_EXT=37727]="ZERO_TO_ONE_EXT",t[t.CLIP_ORIGIN_EXT=37724]="CLIP_ORIGIN_EXT",t[t.CLIP_DEPTH_MODE_EXT=37725]="CLIP_DEPTH_MODE_EXT",t[t.SRC1_COLOR_WEBGL=35065]="SRC1_COLOR_WEBGL",t[t.SRC1_ALPHA_WEBGL=34185]="SRC1_ALPHA_WEBGL",t[t.ONE_MINUS_SRC1_COLOR_WEBGL=35066]="ONE_MINUS_SRC1_COLOR_WEBGL",t[t.ONE_MINUS_SRC1_ALPHA_WEBGL=35067]="ONE_MINUS_SRC1_ALPHA_WEBGL",t[t.MAX_DUAL_SOURCE_DRAW_BUFFERS_WEBGL=35068]="MAX_DUAL_SOURCE_DRAW_BUFFERS_WEBGL",t[t.MIRROR_CLAMP_TO_EDGE_EXT=34627]="MIRROR_CLAMP_TO_EDGE_EXT"})(v0||(v0={}));const rqe={WEBGL_depth_texture:{UNSIGNED_INT_24_8_WEBGL:34042},OES_element_index_uint:{},OES_texture_float:{},OES_texture_half_float:{HALF_FLOAT_OES:5131},EXT_color_buffer_float:{},OES_standard_derivatives:{FRAGMENT_SHADER_DERIVATIVE_HINT_OES:35723},EXT_frag_depth:{},EXT_blend_minmax:{MIN_EXT:32775,MAX_EXT:32776},EXT_shader_texture_lod:{}},nqe=t=>({drawBuffersWEBGL(e){return t.drawBuffers(e)},COLOR_ATTACHMENT0_WEBGL:36064,COLOR_ATTACHMENT1_WEBGL:36065,COLOR_ATTACHMENT2_WEBGL:36066,COLOR_ATTACHMENT3_WEBGL:36067}),iqe=t=>({VERTEX_ARRAY_BINDING_OES:34229,createVertexArrayOES(){return t.createVertexArray()},deleteVertexArrayOES(e){return t.deleteVertexArray(e)},isVertexArrayOES(e){return t.isVertexArray(e)},bindVertexArrayOES(e){return t.bindVertexArray(e)}}),aqe=t=>({VERTEX_ATTRIB_ARRAY_DIVISOR_ANGLE:35070,drawArraysInstancedANGLE(...e){return t.drawArraysInstanced(...e)},drawElementsInstancedANGLE(...e){return t.drawElementsInstanced(...e)},vertexAttribDivisorANGLE(...e){return t.vertexAttribDivisor(...e)}});function oqe(t=!0){const e=HTMLCanvasElement.prototype;if(!t&&e.originalGetContext){e.getContext=e.originalGetContext,e.originalGetContext=void 0;return}e.originalGetContext=e.getContext,e.getContext=function(r,n){if(r==="webgl"||r==="experimental-webgl"){const i=this.originalGetContext("webgl2",n);return i instanceof HTMLElement&&sqe(i),i}return this.originalGetContext(r,n)}}function sqe(t){t.getExtension("EXT_color_buffer_float");const e={...rqe,WEBGL_disjoint_timer_query:t.getExtension("EXT_disjoint_timer_query_webgl2"),WEBGL_draw_buffers:nqe(t),OES_vertex_array_object:iqe(t),ANGLE_instanced_arrays:aqe(t)},r=t.getExtension;t.getExtension=function(i){const a=r.call(t,i);return a||(i in e?e[i]:null)};const n=t.getSupportedExtensions;t.getSupportedExtensions=function(){return(n.apply(t)||[])?.concat(Object.keys(e))}}async function _ne(t,e){const r=document.getElementsByTagName("head")[0];if(!r)throw new Error("loadScript");const n=document.createElement("script");return n.setAttribute("type","text/javascript"),n.setAttribute("src",t),new Promise((i,a)=>{n.onload=i,n.onerror=s=>a(new Error(`Unable to load script '${t}': ${s}`)),r.appendChild(n)})}const lqe=1;let ef=null,mW=!1;const b6={debugSpectorJS:rn.get("debug-spectorjs"),debugSpectorJSUrl:"https://cdn.jsdelivr.net/npm/spectorjs@0.9.30/dist/spector.bundle.js",gl:void 0};async function uqe(t){if(!globalThis.SPECTOR)try{await _ne(t.debugSpectorJSUrl||b6.debugSpectorJSUrl)}catch(e){rn.warn(String(e))}}function cqe(t){if(t={...b6,...t},!t.debugSpectorJS)return null;if(!ef&&globalThis.SPECTOR&&!globalThis.luma?.spector){rn.probe(lqe,"SPECTOR found and initialized. Start with `luma.spector.displayUI()`")();const{Spector:e}=globalThis.SPECTOR;ef=new e,globalThis.luma&&(globalThis.luma.spector=ef)}if(!ef)return null;if(mW||(mW=!0,ef.spyCanvases(),ef?.onCaptureStarted.add(e=>rn.info("Spector capture started:",e)()),ef?.onCapture.add(e=>{rn.info("Spector capture complete:",e)(),ef?.getResultUI(),ef?.resultView.display(),ef?.resultView.addCapture(e)})),t.gl){const e=t.gl,r=e.device;ef?.startCapture(t.gl,500),e.device=r,new Promise(n=>setTimeout(n,2e3)).then(n=>{rn.info("Spector capture stopped after 2 seconds")(),ef?.stopCapture()})}return ef}const fqe="https://unpkg.com/webgl-debug@2.0.1/index.js";function bne(t){return t.luma=t.luma||{},t.luma}async function hqe(){Dy()&&!globalThis.WebGLDebugUtils&&(globalThis.global=globalThis.global||globalThis,globalThis.global.module={},await _ne(fqe))}function dqe(t,e={}){return e.debugWebGL||e.traceWebGL?gqe(t,e):pqe(t)}function pqe(t){const e=bne(t);return e.realContext?e.realContext:t}function gqe(t,e){if(!globalThis.WebGLDebugUtils)return rn.warn("webgl-debug not loaded")(),t;const r=bne(t);if(r.debugContext)return r.debugContext;globalThis.WebGLDebugUtils.init({...v0,...t});const n=globalThis.WebGLDebugUtils.makeDebugContext(t,mqe.bind(null,e),yqe.bind(null,e));for(const s in v0)!(s in n)&&typeof v0[s]=="number"&&(n[s]=v0[s]);class i{}Object.setPrototypeOf(n,Object.getPrototypeOf(t)),Object.setPrototypeOf(i,n);const a=Object.create(i);return r.realContext=t,r.debugContext=a,a.debug=!0,a}function yW(t,e){e=Array.from(e).map(n=>n===void 0?"undefined":n);let r=globalThis.WebGLDebugUtils.glFunctionArgsToString(t,e);return r=`${r.slice(0,100)}${r.length>100?"...":""}`,`gl.${t}(${r})`}function mqe(t,e,r,n){n=Array.from(n).map(o=>o===void 0?"undefined":o);const i=globalThis.WebGLDebugUtils.glEnumToString(e),a=globalThis.WebGLDebugUtils.glFunctionArgsToString(r,n),s=`${i} in gl.${r}(${a})`;rn.error(s)();debugger}function yqe(t,e,r){let n="";rn.level>=1&&(n=yW(e,r),t.traceWebGL&&rn.log(1,n)());for(const i of r)if(i===void 0){n=n||yW(e,r);debugger}}const rS=1;class vqe extends p9e{type="webgl";constructor(){super(),hy.defaultProps={...hy.defaultProps,...b6}}enforceWebGL2(e){oqe(e)}isSupported(){return typeof WebGL2RenderingContext<"u"}isDeviceHandle(e){return typeof WebGL2RenderingContext<"u"&&e instanceof WebGL2RenderingContext?!0:(typeof WebGLRenderingContext<"u"&&e instanceof WebGLRenderingContext&&rn.warn("WebGL1 is not supported",e)(),!1)}async attach(e,r={}){const{WebGLDevice:n}=await ib(async()=>{const{WebGLDevice:a}=await Promise.resolve().then(()=>DW);return{WebGLDevice:a}},void 0,import.meta.url);if(e instanceof n)return e;if(e?.device instanceof n)return e.device;if(!_qe(e))throw new Error("Invalid WebGL2RenderingContext");const i=r.createCanvasContext===!0?{}:r.createCanvasContext;return new n({...r,_handle:e,createCanvasContext:{canvas:e.canvas,autoResize:!1,...i}})}async create(e={}){const{WebGLDevice:r}=await ib(async()=>{const{WebGLDevice:n}=await Promise.resolve().then(()=>DW);return{WebGLDevice:n}},void 0,import.meta.url);rn.groupCollapsed(rS,"WebGLDevice created")();try{const n=[];(e.debugWebGL||e.debug)&&n.push(hqe()),e.debugSpectorJS&&n.push(uqe(e));const i=await Promise.allSettled(n);for(const o of i)o.status==="rejected"&&rn.error(`Failed to initialize debug libraries ${o.reason}`)();const a=new r(e),s=`${a._reused?"Reusing":"Created"} device with WebGL2 ${a.props.debug?"debug ":""}context: ${a.info.vendor}, ${a.info.renderer} for canvas: ${a.canvasContext.id}`;return rn.probe(rS,s)(),rn.table(rS,a.info)(),a}finally{rn.groupEnd(rS)()}}}function _qe(t){return typeof WebGL2RenderingContext<"u"&&t instanceof WebGL2RenderingContext?!0:!!(t&&Number.isFinite(t._version))}const lk=new vqe,x6={3042:!1,32773:new Float32Array([0,0,0,0]),32777:32774,34877:32774,32969:1,32968:0,32971:1,32970:0,3106:new Float32Array([0,0,0,0]),3107:[!0,!0,!0,!0],2884:!1,2885:1029,2929:!1,2931:1,2932:513,2928:new Float32Array([0,1]),2930:!0,3024:!0,35725:null,36006:null,36007:null,34229:null,34964:null,2886:2305,33170:4352,2849:1,32823:!1,32824:0,10752:0,32926:!1,32928:!1,32938:1,32939:!1,3089:!1,3088:new Int32Array([0,0,1024,1024]),2960:!1,2961:0,2968:4294967295,36005:4294967295,2962:519,2967:0,2963:4294967295,34816:519,36003:0,36004:4294967295,2964:7680,2965:7680,2966:7680,34817:7680,34818:7680,34819:7680,2978:[0,0,1024,1024],36389:null,36662:null,36663:null,35053:null,35055:null,35723:4352,36010:null,35977:!1,3333:4,3317:4,37440:!1,37441:!1,37443:37444,3330:0,3332:0,3331:0,3314:0,32878:0,3316:0,3315:0,32877:0},bl=(t,e,r)=>e?t.enable(r):t.disable(r),vW=(t,e,r)=>t.hint(r,e),tf=(t,e,r)=>t.pixelStorei(r,e),_W=(t,e,r)=>{const n=r===36006?36009:36008;return t.bindFramebuffer(n,e)},A1=(t,e,r)=>{const i={34964:34962,36662:36662,36663:36663,35053:35051,35055:35052}[r];t.bindBuffer(i,e)};function uk(t){return Array.isArray(t)||ArrayBuffer.isView(t)&&!(t instanceof DataView)}const bqe={3042:bl,32773:(t,e)=>t.blendColor(...e),32777:"blendEquation",34877:"blendEquation",32969:"blendFunc",32968:"blendFunc",32971:"blendFunc",32970:"blendFunc",3106:(t,e)=>t.clearColor(...e),3107:(t,e)=>t.colorMask(...e),2884:bl,2885:(t,e)=>t.cullFace(e),2929:bl,2931:(t,e)=>t.clearDepth(e),2932:(t,e)=>t.depthFunc(e),2928:(t,e)=>t.depthRange(...e),2930:(t,e)=>t.depthMask(e),3024:bl,35723:vW,35725:(t,e)=>t.useProgram(e),36007:(t,e)=>t.bindRenderbuffer(36161,e),36389:(t,e)=>t.bindTransformFeedback?.(36386,e),34229:(t,e)=>t.bindVertexArray(e),36006:_W,36010:_W,34964:A1,36662:A1,36663:A1,35053:A1,35055:A1,2886:(t,e)=>t.frontFace(e),33170:vW,2849:(t,e)=>t.lineWidth(e),32823:bl,32824:"polygonOffset",10752:"polygonOffset",35977:bl,32926:bl,32928:bl,32938:"sampleCoverage",32939:"sampleCoverage",3089:bl,3088:(t,e)=>t.scissor(...e),2960:bl,2961:(t,e)=>t.clearStencil(e),2968:(t,e)=>t.stencilMaskSeparate(1028,e),36005:(t,e)=>t.stencilMaskSeparate(1029,e),2962:"stencilFuncFront",2967:"stencilFuncFront",2963:"stencilFuncFront",34816:"stencilFuncBack",36003:"stencilFuncBack",36004:"stencilFuncBack",2964:"stencilOpFront",2965:"stencilOpFront",2966:"stencilOpFront",34817:"stencilOpBack",34818:"stencilOpBack",34819:"stencilOpBack",2978:(t,e)=>t.viewport(...e),34383:bl,10754:bl,12288:bl,12289:bl,12290:bl,12291:bl,12292:bl,12293:bl,12294:bl,12295:bl,3333:tf,3317:tf,37440:tf,37441:tf,37443:tf,3330:tf,3332:tf,3331:tf,3314:tf,32878:tf,3316:tf,3315:tf,32877:tf,framebuffer:(t,e)=>{const r=e&&"handle"in e?e.handle:e;return t.bindFramebuffer(36160,r)},blend:(t,e)=>e?t.enable(3042):t.disable(3042),blendColor:(t,e)=>t.blendColor(...e),blendEquation:(t,e)=>{const r=typeof e=="number"?[e,e]:e;t.blendEquationSeparate(...r)},blendFunc:(t,e)=>{const r=e?.length===2?[...e,...e]:e;t.blendFuncSeparate(...r)},clearColor:(t,e)=>t.clearColor(...e),clearDepth:(t,e)=>t.clearDepth(e),clearStencil:(t,e)=>t.clearStencil(e),colorMask:(t,e)=>t.colorMask(...e),cull:(t,e)=>e?t.enable(2884):t.disable(2884),cullFace:(t,e)=>t.cullFace(e),depthTest:(t,e)=>e?t.enable(2929):t.disable(2929),depthFunc:(t,e)=>t.depthFunc(e),depthMask:(t,e)=>t.depthMask(e),depthRange:(t,e)=>t.depthRange(...e),dither:(t,e)=>e?t.enable(3024):t.disable(3024),derivativeHint:(t,e)=>{t.hint(35723,e)},frontFace:(t,e)=>t.frontFace(e),mipmapHint:(t,e)=>t.hint(33170,e),lineWidth:(t,e)=>t.lineWidth(e),polygonOffsetFill:(t,e)=>e?t.enable(32823):t.disable(32823),polygonOffset:(t,e)=>t.polygonOffset(...e),sampleCoverage:(t,e)=>t.sampleCoverage(e[0],e[1]||!1),scissorTest:(t,e)=>e?t.enable(3089):t.disable(3089),scissor:(t,e)=>t.scissor(...e),stencilTest:(t,e)=>e?t.enable(2960):t.disable(2960),stencilMask:(t,e)=>{e=uk(e)?e:[e,e];const[r,n]=e;t.stencilMaskSeparate(1028,r),t.stencilMaskSeparate(1029,n)},stencilFunc:(t,e)=>{e=uk(e)&&e.length===3?[...e,...e]:e;const[r,n,i,a,s,o]=e;t.stencilFuncSeparate(1028,r,n,i),t.stencilFuncSeparate(1029,a,s,o)},stencilOp:(t,e)=>{e=uk(e)&&e.length===3?[...e,...e]:e;const[r,n,i,a,s,o]=e;t.stencilOpSeparate(1028,r,n,i),t.stencilOpSeparate(1029,a,s,o)},viewport:(t,e)=>t.viewport(...e)};function Ns(t,e,r){return e[t]!==void 0?e[t]:r[t]}const xqe={blendEquation:(t,e,r)=>t.blendEquationSeparate(Ns(32777,e,r),Ns(34877,e,r)),blendFunc:(t,e,r)=>t.blendFuncSeparate(Ns(32969,e,r),Ns(32968,e,r),Ns(32971,e,r),Ns(32970,e,r)),polygonOffset:(t,e,r)=>t.polygonOffset(Ns(32824,e,r),Ns(10752,e,r)),sampleCoverage:(t,e,r)=>t.sampleCoverage(Ns(32938,e,r),Ns(32939,e,r)),stencilFuncFront:(t,e,r)=>t.stencilFuncSeparate(1028,Ns(2962,e,r),Ns(2967,e,r),Ns(2963,e,r)),stencilFuncBack:(t,e,r)=>t.stencilFuncSeparate(1029,Ns(34816,e,r),Ns(36003,e,r),Ns(36004,e,r)),stencilOpFront:(t,e,r)=>t.stencilOpSeparate(1028,Ns(2964,e,r),Ns(2965,e,r),Ns(2966,e,r)),stencilOpBack:(t,e,r)=>t.stencilOpSeparate(1029,Ns(34817,e,r),Ns(34818,e,r),Ns(34819,e,r))},bW={enable:(t,e)=>t({[e]:!0}),disable:(t,e)=>t({[e]:!1}),pixelStorei:(t,e,r)=>t({[e]:r}),hint:(t,e,r)=>t({[e]:r}),useProgram:(t,e)=>t({35725:e}),bindRenderbuffer:(t,e,r)=>t({36007:r}),bindTransformFeedback:(t,e,r)=>t({36389:r}),bindVertexArray:(t,e)=>t({34229:e}),bindFramebuffer:(t,e,r)=>{switch(e){case 36160:return t({36006:r,36010:r});case 36009:return t({36006:r});case 36008:return t({36010:r});default:return null}},bindBuffer:(t,e,r)=>{const n={34962:[34964],36662:[36662],36663:[36663],35051:[35053],35052:[35055]}[e];return n?t({[n]:r}):{valueChanged:!0}},blendColor:(t,e,r,n,i)=>t({32773:new Float32Array([e,r,n,i])}),blendEquation:(t,e)=>t({32777:e,34877:e}),blendEquationSeparate:(t,e,r)=>t({32777:e,34877:r}),blendFunc:(t,e,r)=>t({32969:e,32968:r,32971:e,32970:r}),blendFuncSeparate:(t,e,r,n,i)=>t({32969:e,32968:r,32971:n,32970:i}),clearColor:(t,e,r,n,i)=>t({3106:new Float32Array([e,r,n,i])}),clearDepth:(t,e)=>t({2931:e}),clearStencil:(t,e)=>t({2961:e}),colorMask:(t,e,r,n,i)=>t({3107:[e,r,n,i]}),cullFace:(t,e)=>t({2885:e}),depthFunc:(t,e)=>t({2932:e}),depthRange:(t,e,r)=>t({2928:new Float32Array([e,r])}),depthMask:(t,e)=>t({2930:e}),frontFace:(t,e)=>t({2886:e}),lineWidth:(t,e)=>t({2849:e}),polygonOffset:(t,e,r)=>t({32824:e,10752:r}),sampleCoverage:(t,e,r)=>t({32938:e,32939:r}),scissor:(t,e,r,n,i)=>t({3088:new Int32Array([e,r,n,i])}),stencilMask:(t,e)=>t({2968:e,36005:e}),stencilMaskSeparate:(t,e,r)=>t({[e===1028?2968:36005]:r}),stencilFunc:(t,e,r,n)=>t({2962:e,2967:r,2963:n,34816:e,36003:r,36004:n}),stencilFuncSeparate:(t,e,r,n,i)=>t({[e===1028?2962:34816]:r,[e===1028?2967:36003]:n,[e===1028?2963:36004]:i}),stencilOp:(t,e,r,n)=>t({2964:e,2965:r,2966:n,34817:e,34818:r,34819:n}),stencilOpSeparate:(t,e,r,n,i)=>t({[e===1028?2964:34817]:r,[e===1028?2965:34818]:n,[e===1028?2966:34819]:i}),viewport:(t,e,r,n,i)=>t({2978:[e,r,n,i]})},id=(t,e)=>t.isEnabled(e),xW={3042:id,2884:id,2929:id,3024:id,32823:id,32926:id,32928:id,3089:id,2960:id,35977:id},wqe=new Set([34016,36388,36387,35983,35368,34965,35739,35738,3074,34853,34854,34855,34856,34857,34858,34859,34860,34861,34862,34863,34864,34865,34866,34867,34868,35097,32873,35869,32874,34068]);function k_(t,e){if(Eqe(e))return;const r={};for(const i in e){const a=Number(i),s=bqe[i];s&&(typeof s=="string"?r[s]=!0:s(t,e[i],a))}const n=t.state&&t.state.cache;if(n)for(const i in r){const a=xqe[i];a(t,e,n)}}function xne(t,e=x6){if(typeof e=="number"){const i=e,a=xW[i];return a?a(t,i):t.getParameter(i)}const r=Array.isArray(e)?e:Object.keys(e),n={};for(const i of r){const a=xW[i];n[i]=a?a(t,Number(i)):t.getParameter(Number(i))}return n}function Sqe(t){k_(t,x6)}function Eqe(t){for(const e in t)return!1;return!0}function Tqe(t,e){if(t===e)return!0;if(wW(t)&&wW(e)&&t.length===e.length){for(let r=0;r<t.length;++r)if(t[r]!==e[r])return!1;return!0}return!1}function wW(t){return Array.isArray(t)||ArrayBuffer.isView(t)}class Wm{static get(e){return e.state}gl;program=null;stateStack=[];enable=!0;cache=null;log;initialized=!1;constructor(e,r){this.gl=e,this.log=r?.log||(()=>{}),this._updateCache=this._updateCache.bind(this),Object.seal(this)}push(e={}){this.stateStack.push({})}pop(){const e=this.stateStack[this.stateStack.length-1];k_(this.gl,e),this.stateStack.pop()}trackState(e,r){if(this.cache=r?.copyState?xne(e):Object.assign({},x6),this.initialized)throw new Error("WebGLStateTracker");this.initialized=!0,this.gl.state=this,Aqe(e);for(const n in bW){const i=bW[n];Cqe(e,n,i)}SW(e,"getParameter"),SW(e,"isEnabled")}_updateCache(e){let r=!1,n;const i=this.stateStack.length>0?this.stateStack[this.stateStack.length-1]:null;for(const a in e){const s=e[a],o=this.cache[a];Tqe(s,o)||(r=!0,n=o,i&&!(a in i)&&(i[a]=o),this.cache[a]=s)}return{valueChanged:r,oldValue:n}}}function SW(t,e){const r=t[e].bind(t);t[e]=function(i){if(i===void 0||wqe.has(i))return r(i);const a=Wm.get(t);return i in a.cache||(a.cache[i]=r(i)),a.enable?a.cache[i]:r(i)},Object.defineProperty(t[e],"name",{value:`${e}-from-cache`,configurable:!1})}function Cqe(t,e,r){if(!t[e])return;const n=t[e].bind(t);t[e]=function(...a){const s=Wm.get(t),{valueChanged:o,oldValue:c}=r(s._updateCache,...a);return o&&n(...a),c},Object.defineProperty(t[e],"name",{value:`${e}-to-cache`,configurable:!1})}function Aqe(t){const e=t.useProgram.bind(t);t.useProgram=function(n){const i=Wm.get(t);i.program!==n&&(e(n),i.program=n)}}function Iqe(t,e,r){let n="";const i={preserveDrawingBuffer:!0,...r};let a=null;if(a||=t.getContext("webgl2",i),i.failIfMajorPerformanceCaveat&&(n||="Only software GPU is available. Set `failIfMajorPerformanceCaveat: false` to allow."),!a&&!r.failIfMajorPerformanceCaveat&&(i.failIfMajorPerformanceCaveat=!1,a=t.getContext("webgl2",i),a.luma||={},a.luma.softwareRenderer=!0),a||(a=t.getContext("webgl",{}),a&&(a=null,n||="Your browser only supports WebGL1")),!a)throw n||="Your browser does not support WebGL",new Error(`Failed to create WebGL context: ${n}`);const{onContextLost:s,onContextRestored:o}=e;return t.addEventListener("webglcontextlost",c=>s(c),!1),t.addEventListener("webglcontextrestored",c=>o(c),!1),a.luma||={},a}function u_(t,e,r){return r[e]===void 0&&(r[e]=t.getExtension(e)||null),r[e]}function Pqe(t,e){const r=t.getParameter(7936),n=t.getParameter(7937);u_(t,"WEBGL_debug_renderer_info",e);const i=e.WEBGL_debug_renderer_info,a=t.getParameter(i?i.UNMASKED_VENDOR_WEBGL:7936),s=t.getParameter(i?i.UNMASKED_RENDERER_WEBGL:7937),o=a||r,c=s||n,f=t.getParameter(7938),d=wne(o,c),m=kqe(o,c),b=Rqe(o,c);return{type:"webgl",gpu:d,gpuType:b,gpuBackend:m,vendor:o,renderer:c,version:f,shadingLanguage:"glsl",shadingLanguageVersion:300}}function wne(t,e){return/NVIDIA/i.exec(t)||/NVIDIA/i.exec(e)?"nvidia":/INTEL/i.exec(t)||/INTEL/i.exec(e)?"intel":/Apple/i.exec(t)||/Apple/i.exec(e)?"apple":/AMD/i.exec(t)||/AMD/i.exec(e)||/ATI/i.exec(t)||/ATI/i.exec(e)?"amd":/SwiftShader/i.exec(t)||/SwiftShader/i.exec(e)?"software":"unknown"}function kqe(t,e){return/Metal/i.exec(t)||/Metal/i.exec(e)?"metal":/ANGLE/i.exec(t)||/ANGLE/i.exec(e)?"opengl":"unknown"}function Rqe(t,e){if(/SwiftShader/i.exec(t)||/SwiftShader/i.exec(e))return"cpu";switch(wne(t,e)){case"intel":return"integrated";case"software":return"cpu";case"unknown":return"unknown";default:return"discrete"}}function Sne(t){switch(t){case"uint8":return 5121;case"sint8":return 5120;case"unorm8":return 5121;case"snorm8":return 5120;case"uint16":return 5123;case"sint16":return 5122;case"unorm16":return 5123;case"snorm16":return 5122;case"uint32":return 5125;case"sint32":return 5124;case"float16":return 5131;case"float32":return 5126}throw new Error(String(t))}const rb="WEBGL_compressed_texture_s3tc",nb="WEBGL_compressed_texture_s3tc_srgb",_0="EXT_texture_compression_rgtc",b0="EXT_texture_compression_bptc",Mqe="WEBGL_compressed_texture_etc",Dqe="WEBGL_compressed_texture_astc",Oqe="WEBGL_compressed_texture_etc1",Nqe="WEBGL_compressed_texture_pvrtc",Lqe="WEBGL_compressed_texture_atc",EW="EXT_texture_norm16",TW="EXT_render_snorm",Fqe="EXT_color_buffer_float",w6={"float32-renderable-webgl":["EXT_color_buffer_float"],"float16-renderable-webgl":["EXT_color_buffer_half_float"],"rgb9e5ufloat-renderable-webgl":["WEBGL_render_shared_exponent"],"snorm8-renderable-webgl":[TW],"norm16-renderable-webgl":[EW],"snorm16-renderable-webgl":[EW,TW],"float32-filterable":["OES_texture_float_linear"],"float16-filterable-webgl":["OES_texture_half_float_linear"],"texture-filterable-anisotropic-webgl":["EXT_texture_filter_anisotropic"],"texture-blend-float-webgl":["EXT_float_blend"],"texture-compression-bc":[rb,nb,_0,b0],"texture-compression-bc5-webgl":[_0],"texture-compression-bc7-webgl":[b0],"texture-compression-etc2":[Mqe],"texture-compression-astc":[Dqe],"texture-compression-etc1-webgl":[Oqe],"texture-compression-pvrtc-webgl":[Nqe],"texture-compression-atc-webgl":[Lqe]};function Bqe(t){return t in w6}function zqe(t,e,r){return(w6[e]||[]).every(i=>u_(t,i,r))}const S6={r8unorm:{gl:33321,rb:!0},r8snorm:{gl:36756},r8uint:{gl:33330,rb:!0},r8sint:{gl:33329,rb:!0},rg8unorm:{gl:33323,rb:!0},rg8snorm:{gl:36757},rg8uint:{gl:33336,rb:!0},rg8sint:{gl:33335,rb:!0},r16uint:{gl:33332,rb:!0},r16sint:{gl:33331,rb:!0},r16float:{gl:33325,rb:!0},r16unorm:{gl:33322,rb:!0},r16snorm:{gl:36760},"rgba4unorm-webgl":{gl:32854,rb:!0},"rgb565unorm-webgl":{gl:36194,rb:!0},"rgb5a1unorm-webgl":{gl:32855,rb:!0},"rgb8unorm-webgl":{gl:32849},"rgb8snorm-webgl":{gl:36758},rgba8unorm:{gl:32856},"rgba8unorm-srgb":{gl:35907},rgba8snorm:{gl:36759},rgba8uint:{gl:36220},rgba8sint:{gl:36238},bgra8unorm:{},"bgra8unorm-srgb":{},rg16uint:{gl:33338},rg16sint:{gl:33337},rg16float:{gl:33327,rb:!0},rg16unorm:{gl:33324},rg16snorm:{gl:36761},r32uint:{gl:33334,rb:!0},r32sint:{gl:33333,rb:!0},r32float:{gl:33326},rgb9e5ufloat:{gl:35901},rg11b10ufloat:{gl:35898,rb:!0},rgb10a2unorm:{gl:32857,rb:!0},rgb10a2uint:{gl:36975,rb:!0},"rgb16unorm-webgl":{gl:32852},"rgb16snorm-webgl":{gl:36762},rg32uint:{gl:33340,rb:!0},rg32sint:{gl:33339,rb:!0},rg32float:{gl:33328,rb:!0},rgba16uint:{gl:36214,rb:!0},rgba16sint:{gl:36232,rb:!0},rgba16float:{gl:34842},rgba16unorm:{gl:32859,rb:!0},rgba16snorm:{gl:36763},"rgb32float-webgl":{gl:34837,x:Fqe,dataFormat:6407,types:[5126]},rgba32uint:{gl:36208,rb:!0},rgba32sint:{gl:36226,rb:!0},rgba32float:{gl:34836,rb:!0},stencil8:{gl:36168,rb:!0},depth16unorm:{gl:33189,dataFormat:6402,types:[5123],rb:!0},depth24plus:{gl:33190,dataFormat:6402,types:[5125]},depth32float:{gl:36012,dataFormat:6402,types:[5126],rb:!0},"depth24plus-stencil8":{gl:35056,rb:!0,depthTexture:!0,dataFormat:34041,types:[34042]},"depth32float-stencil8":{gl:36013,dataFormat:34041,types:[36269],rb:!0},"bc1-rgb-unorm-webgl":{gl:33776,x:rb},"bc1-rgb-unorm-srgb-webgl":{gl:35916,x:nb},"bc1-rgba-unorm":{gl:33777,x:rb},"bc1-rgba-unorm-srgb":{gl:35916,x:nb},"bc2-rgba-unorm":{gl:33778,x:rb},"bc2-rgba-unorm-srgb":{gl:35918,x:nb},"bc3-rgba-unorm":{gl:33779,x:rb},"bc3-rgba-unorm-srgb":{gl:35919,x:nb},"bc4-r-unorm":{gl:36283,x:_0},"bc4-r-snorm":{gl:36284,x:_0},"bc5-rg-unorm":{gl:36285,x:_0},"bc5-rg-snorm":{gl:36286,x:_0},"bc6h-rgb-ufloat":{gl:36495,x:b0},"bc6h-rgb-float":{gl:36494,x:b0},"bc7-rgba-unorm":{gl:36492,x:b0},"bc7-rgba-unorm-srgb":{gl:36493,x:b0},"etc2-rgb8unorm":{gl:37492},"etc2-rgb8unorm-srgb":{gl:37494},"etc2-rgb8a1unorm":{gl:37496},"etc2-rgb8a1unorm-srgb":{gl:37497},"etc2-rgba8unorm":{gl:37493},"etc2-rgba8unorm-srgb":{gl:37495},"eac-r11unorm":{gl:37488},"eac-r11snorm":{gl:37489},"eac-rg11unorm":{gl:37490},"eac-rg11snorm":{gl:37491},"astc-4x4-unorm":{gl:37808},"astc-4x4-unorm-srgb":{gl:37840},"astc-5x4-unorm":{gl:37809},"astc-5x4-unorm-srgb":{gl:37841},"astc-5x5-unorm":{gl:37810},"astc-5x5-unorm-srgb":{gl:37842},"astc-6x5-unorm":{gl:37811},"astc-6x5-unorm-srgb":{gl:37843},"astc-6x6-unorm":{gl:37812},"astc-6x6-unorm-srgb":{gl:37844},"astc-8x5-unorm":{gl:37813},"astc-8x5-unorm-srgb":{gl:37845},"astc-8x6-unorm":{gl:37814},"astc-8x6-unorm-srgb":{gl:37846},"astc-8x8-unorm":{gl:37815},"astc-8x8-unorm-srgb":{gl:37847},"astc-10x5-unorm":{gl:37819},"astc-10x5-unorm-srgb":{gl:37851},"astc-10x6-unorm":{gl:37817},"astc-10x6-unorm-srgb":{gl:37849},"astc-10x8-unorm":{gl:37818},"astc-10x8-unorm-srgb":{gl:37850},"astc-10x10-unorm":{gl:37819},"astc-10x10-unorm-srgb":{gl:37851},"astc-12x10-unorm":{gl:37820},"astc-12x10-unorm-srgb":{gl:37852},"astc-12x12-unorm":{gl:37821},"astc-12x12-unorm-srgb":{gl:37853},"pvrtc-rgb4unorm-webgl":{gl:35840},"pvrtc-rgba4unorm-webgl":{gl:35842},"pvrtc-rbg2unorm-webgl":{gl:35841},"pvrtc-rgba2unorm-webgl":{gl:35843},"etc1-rbg-unorm-webgl":{gl:36196},"atc-rgb-unorm-webgl":{gl:35986},"atc-rgba-unorm-webgl":{gl:35986},"atc-rgbai-unorm-webgl":{gl:34798}};function jqe(t,e,r){let n=e.create;const i=S6[e.format];return i?.gl===void 0&&(n=!1),i?.x&&(n=n&&!!u_(t,i.x,r)),{format:e.format,create:n&&e.create,render:n&&e.render,filter:n&&e.filter,blend:n&&e.blend,store:n&&e.store}}function Ene(t){const e=S6[t],r=$qe(t),n=D0.getInfo(t);return n.compressed&&(e.dataFormat=r),{internalFormat:r,format:e?.dataFormat||Vqe(n.channels,n.integer,n.normalized,r),type:n.dataType?Sne(n.dataType):e?.types?.[0]||5121,compressed:n.compressed||!1}}function Uqe(t){switch(D0.getInfo(t).attachment){case"depth":return 36096;case"stencil":return 36128;case"depth-stencil":return 33306;default:throw new Error(`Not a depth stencil format: ${t}`)}}function Vqe(t,e,r,n){if(n===6408||n===6407)return n;switch(t){case"r":return e&&!r?36244:6403;case"rg":return e&&!r?33320:33319;case"rgb":return e&&!r?36248:6407;case"rgba":return e&&!r?36249:6408;case"bgra":throw new Error("bgra pixels not supported by WebGL");default:return 6408}}function $qe(t){const r=S6[t]?.gl;if(r===void 0)throw new Error(`Unsupported texture format ${t}`);return r}const CW={"depth-clip-control":"EXT_depth_clamp","timer-query-webgl":"EXT_disjoint_timer_query_webgl2","compilation-status-async-webgl":"KHR_parallel_shader_compile","polygon-mode-webgl":"WEBGL_polygon_mode","provoking-vertex-webgl":"WEBGL_provoking_vertex","shader-clip-cull-distance-webgl":"WEBGL_clip_cull_distance","shader-noperspective-interpolation-webgl":"NV_shader_noperspective_interpolation","shader-conservative-depth-webgl":"EXT_conservative_depth"};class qqe extends h9e{gl;extensions;testedFeatures=new Set;constructor(e,r,n){super([],n),this.gl=e,this.extensions=r,u_(e,"EXT_color_buffer_float",r)}*[Symbol.iterator](){const e=this.getFeatures();for(const r of e)this.has(r)&&(yield r);return[]}has(e){return this.disabledFeatures?.[e]?!1:(this.testedFeatures.has(e)||(this.testedFeatures.add(e),Bqe(e)&&zqe(this.gl,e,this.extensions)&&this.features.add(e),this.getWebGLFeature(e)&&this.features.add(e)),this.features.has(e))}initializeFeatures(){const e=this.getFeatures().filter(r=>r!=="polygon-mode-webgl");for(const r of e)this.has(r)}getFeatures(){return[...Object.keys(CW),...Object.keys(w6)]}getWebGLFeature(e){const r=CW[e];return typeof r=="string"?!!u_(this.gl,r,this.extensions):!!r}}class Hqe extends f9e{get maxTextureDimension1D(){return 0}get maxTextureDimension2D(){return this.getParameter(3379)}get maxTextureDimension3D(){return this.getParameter(32883)}get maxTextureArrayLayers(){return this.getParameter(35071)}get maxBindGroups(){return 0}get maxDynamicUniformBuffersPerPipelineLayout(){return 0}get maxDynamicStorageBuffersPerPipelineLayout(){return 0}get maxSampledTexturesPerShaderStage(){return this.getParameter(35660)}get maxSamplersPerShaderStage(){return this.getParameter(35661)}get maxStorageBuffersPerShaderStage(){return 0}get maxStorageTexturesPerShaderStage(){return 0}get maxUniformBuffersPerShaderStage(){return this.getParameter(35375)}get maxUniformBufferBindingSize(){return this.getParameter(35376)}get maxStorageBufferBindingSize(){return 0}get minUniformBufferOffsetAlignment(){return this.getParameter(35380)}get minStorageBufferOffsetAlignment(){return 0}get maxVertexBuffers(){return 16}get maxVertexAttributes(){return this.getParameter(34921)}get maxVertexBufferArrayStride(){return 2048}get maxInterStageShaderVariables(){return this.getParameter(35659)}get maxComputeWorkgroupStorageSize(){return 0}get maxComputeInvocationsPerWorkgroup(){return 0}get maxComputeWorkgroupSizeX(){return 0}get maxComputeWorkgroupSizeY(){return 0}get maxComputeWorkgroupSizeZ(){return 0}get maxComputeWorkgroupsPerDimension(){return 0}gl;limits={};constructor(e){super(),this.gl=e}getParameter(e){return this.limits[e]===void 0&&(this.limits[e]=this.gl.getParameter(e)),this.limits[e]||0}}class Ib extends J3{device;gl;handle;colorAttachments=[];depthStencilAttachment=null;constructor(e,r){super(e,r);const n=r.handle===null;this.device=e,this.gl=e.gl,this.handle=this.props.handle||n?this.props.handle:this.gl.createFramebuffer(),n||(e._setWebGLDebugMetadata(this.handle,this,{spector:this.props}),this.autoCreateAttachmentTextures(),this.updateAttachments())}destroy(){super.destroy(),!this.destroyed&&this.handle!==null&&this.gl.deleteFramebuffer(this.handle)}updateAttachments(){const e=this.gl.bindFramebuffer(36160,this.handle);for(let r=0;r<this.colorAttachments.length;++r){const n=this.colorAttachments[r];if(n){const i=36064+r;this._attachTextureView(i,n)}}if(this.depthStencilAttachment){const r=Uqe(this.depthStencilAttachment.props.format);this._attachTextureView(r,this.depthStencilAttachment)}if(this.device.props.debug){const r=this.gl.checkFramebufferStatus(36160);if(r!==36053)throw new Error(`Framebuffer ${Wqe(r)}`)}this.gl.bindFramebuffer(36160,e)}_attachTextureView(e,r){const{gl:n}=this.device,{texture:i}=r,a=r.props.baseMipLevel,s=r.props.baseArrayLayer;switch(n.bindTexture(i.glTarget,i.handle),i.glTarget){case 35866:case 32879:n.framebufferTextureLayer(36160,e,i.handle,a,s);break;case 34067:const o=Gqe(s);n.framebufferTexture2D(36160,e,o,i.handle,a);break;case 3553:n.framebufferTexture2D(36160,e,3553,i.handle,a);break;default:throw new Error("Illegal texture type")}n.bindTexture(i.glTarget,null)}}function Gqe(t){return t<34069?t+34069:t}function Wqe(t){switch(t){case 36053:return"success";case 36054:return"Mismatched attachments";case 36055:return"No attachments";case 36057:return"Height/width mismatch";case 36061:return"Unsupported or split attachments";case 36182:return"Samples mismatch";default:return`${t}`}}class Xqe extends Dm{device;handle=null;_framebuffer=null;get[Symbol.toStringTag](){return"WebGLCanvasContext"}constructor(e,r){super(r),this.device=e,this._setAutoCreatedCanvasId(`${this.device.id}-canvas`),this._updateDevice()}getCurrentFramebuffer(){return this._framebuffer=this._framebuffer||new Ib(this.device,{handle:null}),this._framebuffer}_updateDevice(){}}const ck={};function Yqe(t="id"){ck[t]=ck[t]||1;const e=ck[t]++;return`${t}-${e}`}class Pb extends jo{device;gl;handle;glTarget;glUsage;glIndexType=5123;byteLength=0;bytesUsed=0;constructor(e,r={}){super(e,r),this.device=e,this.gl=this.device.gl;const n=typeof r=="object"?r.handle:void 0;this.handle=n||this.gl.createBuffer(),e._setWebGLDebugMetadata(this.handle,this,{spector:{...this.props,data:typeof this.props.data}}),this.glTarget=Zqe(this.props.usage),this.glUsage=Kqe(this.props.usage),this.glIndexType=this.props.indexType==="uint32"?5125:5123,r.data?this._initWithData(r.data,r.byteOffset,r.byteLength):this._initWithByteLength(r.byteLength||0)}destroy(){!this.destroyed&&this.handle&&(this.removeStats(),this.trackDeallocatedMemory(),this.gl.deleteBuffer(this.handle),this.destroyed=!0,this.handle=null)}_initWithData(e,r=0,n=e.byteLength+r){const i=this.glTarget;this.gl.bindBuffer(i,this.handle),this.gl.bufferData(i,n,this.glUsage),this.gl.bufferSubData(i,r,e),this.gl.bindBuffer(i,null),this.bytesUsed=n,this.byteLength=n,this._setDebugData(e,r,n),this.trackAllocatedMemory(n)}_initWithByteLength(e){let r=e;e===0&&(r=new Float32Array(0));const n=this.glTarget;return this.gl.bindBuffer(n,this.handle),this.gl.bufferData(n,r,this.glUsage),this.gl.bindBuffer(n,null),this.bytesUsed=e,this.byteLength=e,this._setDebugData(null,0,e),this.trackAllocatedMemory(e),this}write(e,r=0){const n=ArrayBuffer.isView(e)?e:new Uint8Array(e),i=36663;this.gl.bindBuffer(i,this.handle),this.gl.bufferSubData(i,r,n),this.gl.bindBuffer(i,null),this._setDebugData(e,r,e.byteLength)}async mapAndWriteAsync(e,r=0,n=this.byteLength-r){const i=new ArrayBuffer(n);await e(i,"copied"),this.write(i,r)}async readAsync(e=0,r){return this.readSyncWebGL(e,r)}async mapAndReadAsync(e,r=0,n){const i=await this.readAsync(r,n);return await e(i.buffer,"copied")}readSyncWebGL(e=0,r){r=r??this.byteLength-e;const n=new Uint8Array(r),i=0;return this.gl.bindBuffer(36662,this.handle),this.gl.getBufferSubData(36662,e,n,i,r),this.gl.bindBuffer(36662,null),this._setDebugData(n,e,r),n}}function Zqe(t){return t&jo.INDEX?34963:t&jo.VERTEX?34962:t&jo.UNIFORM?35345:34962}function Kqe(t){return t&jo.INDEX||t&jo.VERTEX?35044:t&jo.UNIFORM?35048:35044}function Jqe(t){const e=t.split(/\r?\n/),r=[];for(const n of e){if(n.length<=1)continue;const i=n.split(":");if(i.length===2){const[m,b]=i;r.push({message:b.trim(),type:AW(m),lineNum:0,linePos:0});continue}const[a,s,o,...c]=i;let f=parseInt(o,10);isNaN(f)&&(f=0);let d=parseInt(s,10);isNaN(d)&&(d=0),r.push({message:c.join(":").trim(),type:AW(a),lineNum:f,linePos:d})}return r}function AW(t){const e=["warning","error","info"],r=t.toLowerCase();return e.includes(r)?r:"info"}class Qqe extends K3{device;handle;constructor(e,r){switch(super(e,r),this.device=e,this.props.stage){case"vertex":this.handle=this.props.handle||this.device.gl.createShader(35633);break;case"fragment":this.handle=this.props.handle||this.device.gl.createShader(35632);break;default:throw new Error(this.props.stage)}e._setWebGLDebugMetadata(this.handle,this,{spector:this.props}),this._compile(this.source)}destroy(){this.handle&&(this.removeStats(),this.device.gl.deleteShader(this.handle),this.destroyed=!0,this.handle.destroyed=!0)}get asyncCompilationStatus(){return this._waitForCompilationComplete().then(()=>(this._getCompilationStatus(),this.compilationStatus))}async getCompilationInfo(){return await this._waitForCompilationComplete(),this.getCompilationInfoSync()}getCompilationInfoSync(){const e=this.device.gl.getShaderInfoLog(this.handle);return e?Jqe(e):[]}getTranslatedSource(){return this.device.getExtension("WEBGL_debug_shaders").WEBGL_debug_shaders?.getTranslatedShaderSource(this.handle)||null}async _compile(e){e=e.startsWith("#version ")?e:`#version 300 es
${e}`;const{gl:r}=this.device;if(r.shaderSource(this.handle,e),r.compileShader(this.handle),!this.device.props.debug){this.compilationStatus="pending";return}if(!this.device.features.has("compilation-status-async-webgl")){if(this._getCompilationStatus(),this.debugShader(),this.compilationStatus==="error")throw new Error(`GLSL compilation errors in ${this.props.stage} shader ${this.props.id}`);return}rn.once(1,"Shader compilation is asynchronous")(),await this._waitForCompilationComplete(),rn.info(2,`Shader ${this.id} - async compilation complete: ${this.compilationStatus}`)(),this._getCompilationStatus(),this.debugShader()}async _waitForCompilationComplete(){const e=async i=>await new Promise(a=>setTimeout(a,i));if(!this.device.features.has("compilation-status-async-webgl")){await e(10);return}const{gl:n}=this.device;for(;;){if(n.getShaderParameter(this.handle,37297))return;await e(10)}}_getCompilationStatus(){this.compilationStatus=this.device.gl.getShaderParameter(this.handle,35713)?"success":"error"}}function eHe(t,e,r,n){if(iHe(e))return n(t);const i=t;i.pushState();try{return tHe(t,e),k_(i.gl,r),n(t)}finally{i.popState()}}function tHe(t,e){const r=t,{gl:n}=r;if(e.cullMode)switch(e.cullMode){case"none":n.disable(2884);break;case"front":n.enable(2884),n.cullFace(1028);break;case"back":n.enable(2884),n.cullFace(1029);break}if(e.frontFace&&n.frontFace(Xm("frontFace",e.frontFace,{ccw:2305,cw:2304})),e.unclippedDepth&&t.features.has("depth-clip-control")&&n.enable(34383),e.depthBias!==void 0&&(n.enable(32823),n.polygonOffset(e.depthBias,e.depthBiasSlopeScale||0)),e.provokingVertex&&t.features.has("provoking-vertex-webgl")){const a=r.getExtension("WEBGL_provoking_vertex").WEBGL_provoking_vertex,s=Xm("provokingVertex",e.provokingVertex,{first:36429,last:36430});a?.provokingVertexWEBGL(s)}if((e.polygonMode||e.polygonOffsetLine)&&t.features.has("polygon-mode-webgl")){if(e.polygonMode){const a=r.getExtension("WEBGL_polygon_mode").WEBGL_polygon_mode,s=Xm("polygonMode",e.polygonMode,{fill:6914,line:6913});a?.polygonModeWEBGL(1028,s),a?.polygonModeWEBGL(1029,s)}e.polygonOffsetLine&&n.enable(10754)}if(t.features.has("shader-clip-cull-distance-webgl")&&(e.clipDistance0&&n.enable(12288),e.clipDistance1&&n.enable(12289),e.clipDistance2&&n.enable(12290),e.clipDistance3&&n.enable(12291),e.clipDistance4&&n.enable(12292),e.clipDistance5&&n.enable(12293),e.clipDistance6&&n.enable(12294),e.clipDistance7&&n.enable(12295)),e.depthWriteEnabled!==void 0&&n.depthMask(nHe("depthWriteEnabled",e.depthWriteEnabled)),e.depthCompare&&(e.depthCompare!=="always"?n.enable(2929):n.disable(2929),n.depthFunc(_D("depthCompare",e.depthCompare))),e.stencilWriteMask){const i=e.stencilWriteMask;n.stencilMaskSeparate(1028,i),n.stencilMaskSeparate(1029,i)}if(e.stencilReadMask&&rn.warn("stencilReadMask not supported under WebGL"),e.stencilCompare){const i=e.stencilReadMask||4294967295,a=_D("depthCompare",e.stencilCompare);e.stencilCompare!=="always"?n.enable(2960):n.disable(2960),n.stencilFuncSeparate(1028,a,0,i),n.stencilFuncSeparate(1029,a,0,i)}if(e.stencilPassOperation&&e.stencilFailOperation&&e.stencilDepthFailOperation){const i=fk("stencilPassOperation",e.stencilPassOperation),a=fk("stencilFailOperation",e.stencilFailOperation),s=fk("stencilDepthFailOperation",e.stencilDepthFailOperation);n.stencilOpSeparate(1028,a,s,i),n.stencilOpSeparate(1029,a,s,i)}switch(e.blend){case!0:n.enable(3042);break;case!1:n.disable(3042);break}if(e.blendColorOperation||e.blendAlphaOperation){const i=IW("blendColorOperation",e.blendColorOperation||"add"),a=IW("blendAlphaOperation",e.blendAlphaOperation||"add");n.blendEquationSeparate(i,a);const s=nS("blendColorSrcFactor",e.blendColorSrcFactor||"one"),o=nS("blendColorDstFactor",e.blendColorDstFactor||"zero"),c=nS("blendAlphaSrcFactor",e.blendAlphaSrcFactor||"one"),f=nS("blendAlphaDstFactor",e.blendAlphaDstFactor||"zero");n.blendFuncSeparate(s,o,c,f)}}function _D(t,e){return Xm(t,e,{never:512,less:513,equal:514,"less-equal":515,greater:516,"not-equal":517,"greater-equal":518,always:519})}function fk(t,e){return Xm(t,e,{keep:7680,zero:0,replace:7681,invert:5386,"increment-clamp":7682,"decrement-clamp":7683,"increment-wrap":34055,"decrement-wrap":34056})}function IW(t,e){return Xm(t,e,{add:32774,subtract:32778,"reverse-subtract":32779,min:32775,max:32776})}function nS(t,e,r="color"){return Xm(t,e,{one:1,zero:0,src:768,"one-minus-src":769,dst:774,"one-minus-dst":775,"src-alpha":770,"one-minus-src-alpha":771,"dst-alpha":772,"one-minus-dst-alpha":773,"src-alpha-saturated":776,constant:r==="color"?32769:32771,"one-minus-constant":r==="color"?32770:32772,src1:768,"one-minus-src1":769,"src1-alpha":770,"one-minus-src1-alpha":771})}function rHe(t,e){return`Illegal parameter ${e} for ${t}`}function Xm(t,e,r){if(!(e in r))throw new Error(rHe(t,e));return r[e]}function nHe(t,e){return e}function iHe(t){let e=!0;for(const r in t){e=!1;break}return e}function Tne(t){const e={};return t.addressModeU&&(e[10242]=hk(t.addressModeU)),t.addressModeV&&(e[10243]=hk(t.addressModeV)),t.addressModeW&&(e[32882]=hk(t.addressModeW)),t.magFilter&&(e[10240]=bD(t.magFilter)),(t.minFilter||t.mipmapFilter)&&(e[10241]=aHe(t.minFilter||"linear",t.mipmapFilter)),t.lodMinClamp!==void 0&&(e[33082]=t.lodMinClamp),t.lodMaxClamp!==void 0&&(e[33083]=t.lodMaxClamp),t.type==="comparison-sampler"&&(e[34892]=34894),t.compare&&(e[34893]=_D("compare",t.compare)),t.maxAnisotropy&&(e[34046]=t.maxAnisotropy),e}function hk(t){switch(t){case"clamp-to-edge":return 33071;case"repeat":return 10497;case"mirror-repeat":return 33648}}function bD(t){switch(t){case"nearest":return 9728;case"linear":return 9729}}function aHe(t,e="none"){if(!e)return bD(t);switch(e){case"none":return bD(t);case"nearest":switch(t){case"nearest":return 9984;case"linear":return 9985}break;case"linear":switch(t){case"nearest":return 9986;case"linear":return 9987}}}class oHe extends dy{device;handle;parameters;constructor(e,r){super(e,r),this.device=e,this.parameters=Tne(r),this.handle=r.handle||this.device.gl.createSampler(),this._setSamplerParameters(this.parameters)}destroy(){this.handle&&(this.device.gl.deleteSampler(this.handle),this.handle=void 0)}toString(){return`Sampler(${this.id},${JSON.stringify(this.props)})`}_setSamplerParameters(e){for(const[r,n]of Object.entries(e)){const i=Number(r);switch(i){case 33082:case 33083:this.device.gl.samplerParameterf(this.handle,i,n);break;default:this.device.gl.samplerParameteri(this.handle,i,n);break}}}}function vx(t,e,r){if(sHe(e))return r(t);const{nocatch:n=!0}=e,i=Wm.get(t);i.push(),k_(t,e);let a;if(n)a=r(t),i.pop();else try{a=r(t)}finally{i.pop()}return a}function sHe(t){for(const e in t)return!1;return!0}class x0 extends Z3{device;gl;handle;texture;constructor(e,r){super(e,{...Fl.defaultProps,...r}),this.device=e,this.gl=this.device.gl,this.handle=null,this.texture=r.texture}}class kb extends Fl{device;gl;handle;sampler=void 0;view;glTarget;glFormat;glType;glInternalFormat;compressed;_textureUnit=0;constructor(e,r){super(e,r),this.device=e,this.gl=this.device.gl;const n=Ene(this.props.format);this.glTarget=lHe(this.props.dimension),this.glInternalFormat=n.internalFormat,this.glFormat=n.format,this.glType=n.type,this.compressed=n.compressed,this.handle=this.props.handle||this.gl.createTexture(),this.device._setWebGLDebugMetadata(this.handle,this,{spector:this.props}),this.gl.bindTexture(this.glTarget,this.handle);const{dimension:i,width:a,height:s,depth:o,mipLevels:c,glTarget:f,glInternalFormat:d}=this;switch(i){case"2d":case"cube":this.gl.texStorage2D(f,c,d,a,s);break;case"2d-array":case"3d":this.gl.texStorage3D(f,c,d,a,s,o);break;default:throw new Error(i)}this.gl.bindTexture(this.glTarget,null),this._initializeData(r.data),this.setSampler(this.props.sampler),this.view=new x0(this.device,{...this.props,texture:this}),Object.seal(this)}destroy(){this.handle&&(this.gl.deleteTexture(this.handle),this.removeStats(),this.trackDeallocatedMemory("Texture"),this.destroyed=!0)}createView(e){return new x0(this.device,{...e,texture:this})}setSampler(e={}){super.setSampler(e);const r=Tne(this.sampler.props);this._setSamplerParameters(r)}copyImageData(e){const r=this._normalizeCopyImageDataOptions(e),n=r.data,{width:i,height:a,depth:s}=this,{mipLevel:o=0,byteOffset:c=0,x:f=0,y:d=0,z:m=0}=r,{glFormat:b,glType:x,compressed:E}=this,T=PW(this.glTarget,this.dimension,m);let A;if(!this.compressed){const{bytesPerPixel:F}=this.device.getTextureFormatInfo(this.format);if(F){if(r.bytesPerRow%F!==0)throw new Error(`bytesPerRow (${r.bytesPerRow}) must be a multiple of bytesPerPixel (${F}) for ${this.format}`);A=r.bytesPerRow/F}}const M=this.compressed?{}:{...A!==void 0?{3314:A}:{},32878:r.rowsPerImage};this.gl.bindTexture(T,this.handle),vx(this.gl,M,()=>{switch(this.dimension){case"2d":case"cube":E?this.gl.compressedTexSubImage2D(T,o,f,d,i,a,b,n,c):this.gl.texSubImage2D(T,o,f,d,i,a,b,x,n,c);break;case"2d-array":case"3d":E?this.gl.compressedTexSubImage3D(T,o,f,d,m,i,a,s,b,n,c):this.gl.texSubImage3D(T,o,f,d,m,i,a,s,b,x,n,c);break;default:}}),this.gl.bindTexture(T,null)}copyExternalImage(e){const r=this._normalizeCopyExternalImageOptions(e);if(r.sourceX||r.sourceY)throw new Error("WebGL does not support sourceX/sourceY)");const{glFormat:n,glType:i}=this,{image:a,depth:s,mipLevel:o,x:c,y:f,z:d,width:m,height:b}=r,x=PW(this.glTarget,this.dimension,s),E=r.flipY?{37440:!0}:{};return this.gl.bindTexture(this.glTarget,this.handle),vx(this.gl,E,()=>{switch(this.dimension){case"2d":case"cube":this.gl.texSubImage2D(x,o,c,f,m,b,n,i,a);break;case"2d-array":case"3d":this.gl.texSubImage3D(x,o,c,f,d,m,b,s,n,i,a);break;default:}}),this.gl.bindTexture(this.glTarget,null),{width:r.width,height:r.height}}generateMipmapsWebGL(e){if(!(!(this.device.isTextureFormatRenderable(this.props.format)&&this.device.isTextureFormatFilterable(this.props.format))&&(rn.warn(`${this} is not renderable or filterable, may not be able to generate mipmaps`)(),!e?.force)))try{this.gl.bindTexture(this.glTarget,this.handle),this.gl.generateMipmap(this.glTarget)}catch(n){rn.warn(`Error generating mipmap for ${this}: ${n.message}`)()}finally{this.gl.bindTexture(this.glTarget,null)}}_setSamplerParameters(e){rn.log(2,`${this.id} sampler parameters`,this.device.getGLKeys(e))(),this.gl.bindTexture(this.glTarget,this.handle);for(const[r,n]of Object.entries(e)){const i=Number(r),a=n;switch(i){case 33082:case 33083:this.gl.texParameterf(this.glTarget,i,a);break;case 10240:case 10241:this.gl.texParameteri(this.glTarget,i,a);break;case 10242:case 10243:case 32882:this.gl.texParameteri(this.glTarget,i,a);break;case 34046:this.device.features.has("texture-filterable-anisotropic-webgl")&&this.gl.texParameteri(this.glTarget,i,a);break;case 34892:case 34893:this.gl.texParameteri(this.glTarget,i,a);break}}this.gl.bindTexture(this.glTarget,null)}_getActiveUnit(){return this.gl.getParameter(34016)-33984}_bind(e){const{gl:r}=this;return e!==void 0&&(this._textureUnit=e,r.activeTexture(33984+e)),r.bindTexture(this.glTarget,this.handle),e}_unbind(e){const{gl:r}=this;return e!==void 0&&(this._textureUnit=e,r.activeTexture(33984+e)),r.bindTexture(this.glTarget,null),e}}function lHe(t){switch(t){case"1d":break;case"2d":return 3553;case"3d":return 32879;case"cube":return 34067;case"2d-array":return 35866}throw new Error(t)}function PW(t,e,r){return e==="cube"?34069+r:t}function uHe(t){return dHe[t]}function E6(t){return hHe[t]}function cHe(t){return!!Cne[t]}function fHe(t){return Cne[t]}const hHe={5126:"f32",35664:"vec2<f32>",35665:"vec3<f32>",35666:"vec4<f32>",5124:"i32",35667:"vec2<i32>",35668:"vec3<i32>",35669:"vec4<i32>",5125:"u32",36294:"vec2<u32>",36295:"vec3<u32>",36296:"vec4<u32>",35670:"f32",35671:"vec2<f32>",35672:"vec3<f32>",35673:"vec4<f32>",35674:"mat2x2<f32>",35685:"mat2x3<f32>",35686:"mat2x4<f32>",35687:"mat3x2<f32>",35675:"mat3x3<f32>",35688:"mat3x4<f32>",35689:"mat4x2<f32>",35690:"mat4x3<f32>",35676:"mat4x4<f32>"},Cne={35678:{viewDimension:"2d",sampleType:"float"},35680:{viewDimension:"cube",sampleType:"float"},35679:{viewDimension:"3d",sampleType:"float"},35682:{viewDimension:"3d",sampleType:"depth"},36289:{viewDimension:"2d-array",sampleType:"float"},36292:{viewDimension:"2d-array",sampleType:"depth"},36293:{viewDimension:"cube",sampleType:"float"},36298:{viewDimension:"2d",sampleType:"sint"},36299:{viewDimension:"3d",sampleType:"sint"},36300:{viewDimension:"cube",sampleType:"sint"},36303:{viewDimension:"2d-array",sampleType:"uint"},36306:{viewDimension:"2d",sampleType:"uint"},36307:{viewDimension:"3d",sampleType:"uint"},36308:{viewDimension:"cube",sampleType:"uint"},36311:{viewDimension:"2d-array",sampleType:"uint"}},dHe={uint8:5121,sint8:5120,unorm8:5121,snorm8:5120,uint16:5123,sint16:5122,unorm16:5123,snorm16:5122,uint32:5125,sint32:5124,float16:5131,float32:5126};function pHe(t,e){const r={attributes:[],bindings:[]};r.attributes=gHe(t,e);const n=vHe(t,e);for(const o of n){const c=o.uniforms.map(f=>({name:f.name,format:f.format,byteOffset:f.byteOffset,byteStride:f.byteStride,arrayLength:f.arrayLength}));r.bindings.push({type:"uniform",name:o.name,group:0,location:o.location,visibility:(o.vertex?1:0)&(o.fragment?2:0),minBindingSize:o.byteLength,uniforms:c})}const i=yHe(t,e);let a=0;for(const o of i)if(cHe(o.type)){const{viewDimension:c,sampleType:f}=fHe(o.type);r.bindings.push({type:"texture",name:o.name,group:0,location:a,viewDimension:c,sampleType:f}),o.textureUnit=a,a+=1}i.length&&(r.uniforms=i);const s=mHe(t,e);return s?.length&&(r.varyings=s),r}function gHe(t,e){const r=[],n=t.getProgramParameter(e,35721);for(let i=0;i<n;i++){const a=t.getActiveAttrib(e,i);if(!a)throw new Error("activeInfo");const{name:s,type:o}=a,c=t.getAttribLocation(e,s);if(c>=0){const f=E6(o),d=/instance/i.test(s)?"instance":"vertex";r.push({name:s,location:c,stepMode:d,type:f})}}return r.sort((i,a)=>i.location-a.location),r}function mHe(t,e){const r=[],n=t.getProgramParameter(e,35971);for(let i=0;i<n;i++){const a=t.getTransformFeedbackVarying(e,i);if(!a)throw new Error("activeInfo");const{name:s,type:o,size:c}=a,f=E6(o),{type:d,components:m}=pre(f);r.push({location:i,name:s,type:d,size:c*m})}return r.sort((i,a)=>i.location-a.location),r}function yHe(t,e){const r=[],n=t.getProgramParameter(e,35718);for(let i=0;i<n;i++){const a=t.getActiveUniform(e,i);if(!a)throw new Error("activeInfo");const{name:s,size:o,type:c}=a,{name:f,isArray:d}=_He(s);let m=t.getUniformLocation(e,f);const b={location:m,name:f,size:o,type:c,isArray:d};if(r.push(b),b.size>1)for(let x=0;x<b.size;x++){const E=`${f}[${x}]`;m=t.getUniformLocation(e,E);const T={...b,name:E,location:m};r.push(T)}}return r}function vHe(t,e){const r=(a,s)=>t.getActiveUniformBlockParameter(e,a,s),n=[],i=t.getProgramParameter(e,35382);for(let a=0;a<i;a++){const s={name:t.getActiveUniformBlockName(e,a)||"",location:r(a,35391),byteLength:r(a,35392),vertex:r(a,35396),fragment:r(a,35398),uniformCount:r(a,35394),uniforms:[]},o=r(a,35395)||[],c=t.getActiveUniforms(e,o,35383),f=t.getActiveUniforms(e,o,35384),d=t.getActiveUniforms(e,o,35387),m=t.getActiveUniforms(e,o,35388);for(let b=0;b<s.uniformCount;++b){const x=t.getActiveUniform(e,o[b]);if(!x)throw new Error("activeInfo");const E=E6(c[b]);s.uniforms.push({name:x.name,format:E,type:c[b],arrayLength:f[b],byteOffset:d[b],byteStride:m[b]})}n.push(s)}return n.sort((a,s)=>a.location-s.location),n}function _He(t){if(t[t.length-1]!=="]")return{name:t,length:1,isArray:!1};const r=/([^[]*)(\[[0-9]+\])?/.exec(t);if(!r||r.length<2)throw new Error(`Failed to parse GLSL uniform name ${t}`);return{name:r[1],length:r[2]?1:0,isArray:!!r[2]}}function bHe(t,e,r,n){const i=t;let a=n;a===!0&&(a=1),a===!1&&(a=0);const s=typeof a=="number"?[a]:a;switch(r){case 35678:case 35680:case 35679:case 35682:case 36289:case 36292:case 36293:case 36298:case 36299:case 36300:case 36303:case 36306:case 36307:case 36308:case 36311:if(typeof n!="number")throw new Error("samplers must be set to integers");return t.uniform1i(e,n);case 5126:return t.uniform1fv(e,s);case 35664:return t.uniform2fv(e,s);case 35665:return t.uniform3fv(e,s);case 35666:return t.uniform4fv(e,s);case 5124:return t.uniform1iv(e,s);case 35667:return t.uniform2iv(e,s);case 35668:return t.uniform3iv(e,s);case 35669:return t.uniform4iv(e,s);case 35670:return t.uniform1iv(e,s);case 35671:return t.uniform2iv(e,s);case 35672:return t.uniform3iv(e,s);case 35673:return t.uniform4iv(e,s);case 5125:return i.uniform1uiv(e,s,1);case 36294:return i.uniform2uiv(e,s,2);case 36295:return i.uniform3uiv(e,s,3);case 36296:return i.uniform4uiv(e,s,4);case 35674:return t.uniformMatrix2fv(e,!1,s);case 35675:return t.uniformMatrix3fv(e,!1,s);case 35676:return t.uniformMatrix4fv(e,!1,s);case 35685:return i.uniformMatrix2x3fv(e,!1,s);case 35686:return i.uniformMatrix2x4fv(e,!1,s);case 35687:return i.uniformMatrix3x2fv(e,!1,s);case 35688:return i.uniformMatrix3x4fv(e,!1,s);case 35689:return i.uniformMatrix4x2fv(e,!1,s);case 35690:return i.uniformMatrix4x3fv(e,!1,s)}throw new Error("Illegal uniform")}function xHe(t){switch(t){case"point-list":return 0;case"line-list":return 1;case"line-strip":return 3;case"triangle-list":return 4;case"triangle-strip":return 5;default:throw new Error(t)}}function wHe(t){switch(t){case"point-list":return 0;case"line-list":return 1;case"line-strip":return 1;case"triangle-list":return 4;case"triangle-strip":return 4;default:throw new Error(t)}}const kW=4;class SHe extends qm{device;handle;vs;fs;introspectedLayout;uniforms={};bindings={};varyings=null;_uniformCount=0;_uniformSetters={};get[Symbol.toStringTag](){return"WEBGLRenderPipeline"}constructor(e,r){super(e,r),this.device=e,this.handle=this.props.handle||this.device.gl.createProgram(),this.device._setWebGLDebugMetadata(this.handle,this,{spector:{id:this.props.id}}),this.vs=r.vs,this.fs=r.fs;const{varyings:n,bufferMode:i=35981}=r;n&&n.length>0&&(this.varyings=n,this.device.gl.transformFeedbackVaryings(this.handle,n,i)),this._linkShaders(),rn.time(3,`RenderPipeline ${this.id} - shaderLayout introspection`)(),this.introspectedLayout=pHe(this.device.gl,this.handle),rn.timeEnd(3,`RenderPipeline ${this.id} - shaderLayout introspection`)(),this.shaderLayout=r.shaderLayout?EHe(this.introspectedLayout,r.shaderLayout):this.introspectedLayout}destroy(){this.handle&&(this.device.gl.useProgram(null),this.device.gl.deleteProgram(this.handle),this.destroyed=!0,this.handle.destroyed=!0,this.handle=null)}setBindings(e,r){for(const[n,i]of Object.entries(e)){const a=this.shaderLayout.bindings.find(s=>s.name===n)||this.shaderLayout.bindings.find(s=>s.name===`${n}Uniforms`);if(!a){const s=this.shaderLayout.bindings.map(o=>`"${o.name}"`).join(", ");r?.disableWarnings||rn.warn(`No binding "${n}" in render pipeline "${this.id}", expected one of ${s}`,i)();continue}switch(i||rn.warn(`Unsetting binding "${n}" in render pipeline "${this.id}"`)(),a.type){case"uniform":if(!(i instanceof Pb)&&!(i.buffer instanceof Pb))throw new Error("buffer value");break;case"texture":if(!(i instanceof x0||i instanceof kb||i instanceof Ib))throw new Error(`${this} Bad texture binding for ${n}`);break;case"sampler":rn.warn(`Ignoring sampler ${n}`)();break;default:throw new Error(a.type)}this.bindings[n]=i}}draw(e){const{renderPass:r,parameters:n=this.props.parameters,topology:i=this.props.topology,vertexArray:a,vertexCount:s,instanceCount:o,isInstanced:c=!1,firstVertex:f=0,transformFeedback:d}=e,m=xHe(i),b=!!a.indexBuffer,x=a.indexBuffer?.glIndexType;if(this.linkStatus!=="success")return rn.info(2,`RenderPipeline:${this.id}.draw() aborted - waiting for shader linking`)(),!1;if(!this._areTexturesRenderable())return rn.info(2,`RenderPipeline:${this.id}.draw() aborted - textures not yet loaded`)(),!1;this.device.gl.useProgram(this.handle),a.bindBeforeRender(r),d&&d.begin(this.props.topology),this._applyBindings(),this._applyUniforms();const E=r;return eHe(this.device,n,E.glParameters,()=>{b&&c?this.device.gl.drawElementsInstanced(m,s||0,x,f,o||0):b?this.device.gl.drawElements(m,s||0,x,f):c?this.device.gl.drawArraysInstanced(m,f,s||0,o||0):this.device.gl.drawArrays(m,f,s||0),d&&d.end()}),a.unbindAfterRender(r),!0}async _linkShaders(){const{gl:e}=this.device;if(e.attachShader(this.handle,this.vs.handle),e.attachShader(this.handle,this.fs.handle),rn.time(kW,`linkProgram for ${this.id}`)(),e.linkProgram(this.handle),rn.timeEnd(kW,`linkProgram for ${this.id}`)(),rn.level,!this.device.features.has("compilation-status-async-webgl")){const n=this._getLinkStatus();this._reportLinkStatus(n);return}rn.once(1,"RenderPipeline linking is asynchronous")(),await this._waitForLinkComplete(),rn.info(2,`RenderPipeline ${this.id} - async linking complete: ${this.linkStatus}`)();const r=this._getLinkStatus();this._reportLinkStatus(r)}async _reportLinkStatus(e){switch(e){case"success":return;default:const r=e==="link-error"?"Link error":"Validation error";switch(this.vs.compilationStatus){case"error":throw this.vs.debugShader(),new Error(`${this} ${r} during compilation of ${this.vs}`);case"pending":await this.vs.asyncCompilationStatus,this.vs.debugShader();break}switch(this.fs?.compilationStatus){case"error":throw this.fs.debugShader(),new Error(`${this} ${r} during compilation of ${this.fs}`);case"pending":await this.fs.asyncCompilationStatus,this.fs.debugShader();break}const n=this.device.gl.getProgramInfoLog(this.handle);this.device.reportError(new Error(`${r} during ${e}: ${n}`),this)(),this.device.debug()}}_getLinkStatus(){const{gl:e}=this.device;return e.getProgramParameter(this.handle,35714)?(e.validateProgram(this.handle),e.getProgramParameter(this.handle,35715)?(this.linkStatus="success","success"):(this.linkStatus="error","validation-error")):(this.linkStatus="error","link-error")}async _waitForLinkComplete(){const e=async i=>await new Promise(a=>setTimeout(a,i));if(!this.device.features.has("compilation-status-async-webgl")){await e(10);return}const{gl:n}=this.device;for(;;){if(n.getProgramParameter(this.handle,37297))return;await e(10)}}_areTexturesRenderable(){let e=!0;for(const r of this.shaderLayout.bindings)!this.bindings[r.name]&&!this.bindings[r.name.replace(/Uniforms$/,"")]&&(rn.warn(`Binding ${r.name} not found in ${this.id}`)(),e=!1);return e}_applyBindings(){if(this.linkStatus!=="success")return;const{gl:e}=this.device;e.useProgram(this.handle);let r=0,n=0;for(const i of this.shaderLayout.bindings){const a=this.bindings[i.name]||this.bindings[i.name.replace(/Uniforms$/,"")];if(!a)throw new Error(`No value for binding ${i.name} in ${this.id}`);switch(i.type){case"uniform":const{name:s}=i,o=e.getUniformBlockIndex(this.handle,s);if(o===4294967295)throw new Error(`Invalid uniform block name ${s}`);e.uniformBlockBinding(this.handle,n,o),a instanceof Pb?e.bindBufferBase(35345,n,a.handle):e.bindBufferRange(35345,n,a.buffer.handle,a.offset||0,a.size||a.buffer.byteLength-a.offset),n+=1;break;case"texture":if(!(a instanceof x0||a instanceof kb||a instanceof Ib))throw new Error("texture");let c;if(a instanceof x0)c=a.texture;else if(a instanceof kb)c=a;else if(a instanceof Ib&&a.colorAttachments[0]instanceof x0)rn.warn("Passing framebuffer in texture binding may be deprecated. Use fbo.colorAttachments[0] instead")(),c=a.colorAttachments[0].texture;else throw new Error("No texture");e.activeTexture(33984+r),e.bindTexture(c.glTarget,c.handle),r+=1;break;case"sampler":break;case"storage":case"read-only-storage":throw new Error(`binding type '${i.type}' not supported in WebGL`)}}}_applyUniforms(){for(const e of this.shaderLayout.uniforms||[]){const{name:r,location:n,type:i,textureUnit:a}=e,s=this.uniforms[r]??a;s!==void 0&&bHe(this.device.gl,n,i,s)}}}function EHe(t,e){const r={...t,attributes:t.attributes.map(n=>({...n}))};for(const n of e?.attributes||[]){const i=r.attributes.find(a=>a.name===n.name);i?(i.type=n.type||i.type,i.stepMode=n.stepMode||i.stepMode):rn.warn(`shader layout attribute ${n.name} not present in shader`)}return r}class THe extends WL{device;handle=null;commands=[];constructor(e){super(e,{}),this.device=e}_executeCommands(e=this.commands){for(const r of e)switch(r.name){case"copy-buffer-to-buffer":CHe(this.device,r.options);break;case"copy-buffer-to-texture":AHe(this.device,r.options);break;case"copy-texture-to-buffer":IHe(this.device,r.options);break;case"copy-texture-to-texture":PHe(this.device,r.options);break;default:throw new Error(r.name)}}}function CHe(t,e){const r=e.sourceBuffer,n=e.destinationBuffer;t.gl.bindBuffer(36662,r.handle),t.gl.bindBuffer(36663,n.handle),t.gl.copyBufferSubData(36662,36663,e.sourceOffset??0,e.destinationOffset??0,e.size),t.gl.bindBuffer(36662,null),t.gl.bindBuffer(36663,null)}function AHe(t,e){throw new Error("Not implemented")}function IHe(t,e){const{sourceTexture:r,mipLevel:n=0,aspect:i="all",width:a=e.sourceTexture.width,height:s=e.sourceTexture.height,depthOrArrayLayers:o=0,origin:c=[0,0],destinationBuffer:f,byteOffset:d=0,bytesPerRow:m,rowsPerImage:b}=e;if(i!=="all")throw new Error("aspect not supported in WebGL");if(n!==0||o!==0||m||b)throw new Error("not implemented");const{framebuffer:x,destroyFramebuffer:E}=Ane(r);let T;try{const A=f,M=a||x.width,F=s||x.height,N=Ene(x.colorAttachments[0].texture.props.format),O=N.format,U=N.type;t.gl.bindBuffer(35051,A.handle),T=t.gl.bindFramebuffer(36160,x.handle),t.gl.readPixels(c[0],c[1],M,F,O,U,d)}finally{t.gl.bindBuffer(35051,null),T!==void 0&&t.gl.bindFramebuffer(36160,T),E&&x.destroy()}}function PHe(t,e){const{sourceTexture:r,destinationMipLevel:n=0,origin:i=[0,0],destinationOrigin:a=[0,0],destinationTexture:s}=e;let{width:o=e.destinationTexture.width,height:c=e.destinationTexture.height}=e;const{framebuffer:f,destroyFramebuffer:d}=Ane(r),[m,b]=i,[x,E,T]=a,A=t.gl.bindFramebuffer(36160,f.handle);let M,F;if(s instanceof kb)M=s,o=Number.isFinite(o)?o:M.width,c=Number.isFinite(c)?c:M.height,M._bind(0),F=M.glTarget;else throw new Error("invalid destination");switch(F){case 3553:case 34067:t.gl.copyTexSubImage2D(F,n,x,E,m,b,o,c);break;case 35866:case 32879:t.gl.copyTexSubImage3D(F,n,x,E,T,m,b,o,c);break}M&&M._unbind(),t.gl.bindFramebuffer(36160,A),d&&f.destroy()}function Ane(t){if(t instanceof Fl){const{width:e,height:r,id:n}=t;return{framebuffer:t.device.createFramebuffer({id:`framebuffer-for-${n}`,width:e,height:r,colorAttachments:[t]}),destroyFramebuffer:!0}}return{framebuffer:t,destroyFramebuffer:!1}}const kHe=[1,2,4,8];class RHe extends Am{device;handle=null;glParameters={};constructor(e,r){super(e,r),this.device=e;let n;if(!r?.parameters?.viewport)if(r?.framebuffer){const{width:a,height:s}=r.framebuffer;n=[0,0,a,s]}else{const[a,s]=e.getDefaultCanvasContext().getDrawingBufferSize();n=[0,0,a,s]}this.device.pushState(),this.setParameters({viewport:n,...this.props.parameters});const i=this.props.framebuffer;if(this.props.framebuffer&&i?.handle){const a=this.props.framebuffer.colorAttachments.map((s,o)=>36064+o);this.device.gl.drawBuffers(a)}else this.device.gl.drawBuffers([1029]);this.clear()}end(){this.device.popState()}pushDebugGroup(e){}popDebugGroup(){}insertDebugMarker(e){}setParameters(e={}){const r={...this.glParameters};r.framebuffer=this.props.framebuffer||null,this.props.depthReadOnly&&(r.depthMask=!this.props.depthReadOnly),r.stencilMask=this.props.stencilReadOnly?0:1,r[35977]=this.props.discard,e.viewport&&(e.viewport.length>=6?(r.viewport=e.viewport.slice(0,4),r.depthRange=[e.viewport[4],e.viewport[5]]):r.viewport=e.viewport),e.scissorRect&&(r.scissorTest=!0,r.scissor=e.scissorRect),e.blendConstant&&(r.blendColor=e.blendConstant),e.stencilReference&&(console.warn("RenderPassParameters.stencilReference not yet implemented in WebGL"),r[2967]=e.stencilReference),"colorMask"in e&&(r.colorMask=kHe.map(n=>!!(n&e.colorMask))),this.glParameters=r,k_(this.device.gl,r)}beginOcclusionQuery(e){this.props.occlusionQuerySet?.beginOcclusionQuery()}endOcclusionQuery(){this.props.occlusionQuerySet?.endOcclusionQuery()}clear(){const e={...this.glParameters};let r=0;this.props.clearColors&&this.props.clearColors.forEach((n,i)=>{n&&this.clearColorBuffer(i,n)}),this.props.clearColor!==!1&&this.props.clearColors===void 0&&(r|=16384,e.clearColor=this.props.clearColor),this.props.clearDepth!==!1&&(r|=256,e.clearDepth=this.props.clearDepth),this.props.clearStencil!==!1&&(r|=1024,e.clearStencil=this.props.clearStencil),r!==0&&vx(this.device.gl,e,()=>{this.device.gl.clear(r)})}clearColorBuffer(e=0,r=[0,0,0,0]){vx(this.device.gl,{framebuffer:this.props.framebuffer},()=>{switch(r.constructor){case Int8Array:case Int16Array:case Int32Array:this.device.gl.clearBufferiv(6144,e,r);break;case Uint8Array:case Uint8ClampedArray:case Uint16Array:case Uint32Array:this.device.gl.clearBufferuiv(6144,e,r);break;case Float32Array:this.device.gl.clearBufferfv(6144,e,r);break;default:throw new Error("clearColorBuffer: color must be typed array")}})}}class RW extends GL{device;handle=null;commandBuffer;constructor(e,r){super(e,r),this.device=e,this.commandBuffer=new THe(e)}destroy(){}finish(){return this.commandBuffer}beginRenderPass(e){return new RHe(this.device,e)}beginComputePass(e){throw new Error("ComputePass not supported in WebGL")}copyBufferToBuffer(e){this.commandBuffer.commands.push({name:"copy-buffer-to-buffer",options:e})}copyBufferToTexture(e){this.commandBuffer.commands.push({name:"copy-buffer-to-texture",options:e})}copyTextureToBuffer(e){this.commandBuffer.commands.push({name:"copy-texture-to-buffer",options:e})}copyTextureToTexture(e){this.commandBuffer.commands.push({name:"copy-texture-to-texture",options:e})}pushDebugGroup(e){}popDebugGroup(){}insertDebugMarker(e){}resolveQuerySet(e,r,n){}}function MHe(t){const{target:e,source:r,start:n=0,count:i=1}=t,a=r.length,s=i*a;let o=0;for(let c=n;o<a;o++)e[c++]=r[o];for(;o<s;)o<s-o?(e.copyWithin(n+o,n,n+o),o*=2):(e.copyWithin(n+o,n,n+s-o),o=s);return t.target}class T6 extends XL{get[Symbol.toStringTag](){return"VertexArray"}device;handle;buffer=null;bufferValue=null;static isConstantAttributeZeroSupported(e){return WFe()==="Chrome"}constructor(e,r){super(e,r),this.device=e,this.handle=this.device.gl.createVertexArray()}destroy(){super.destroy(),this.buffer&&this.buffer?.destroy(),this.handle&&(this.device.gl.deleteVertexArray(this.handle),this.handle=void 0)}setIndexBuffer(e){const r=e;if(r&&r.glTarget!==34963)throw new Error("Use .setBuffer()");this.device.gl.bindVertexArray(this.handle),this.device.gl.bindBuffer(34963,r?r.handle:null),this.indexBuffer=r,this.device.gl.bindVertexArray(null)}setBuffer(e,r){const n=r;if(n.glTarget===34963)throw new Error("Use .setIndexBuffer()");const{size:i,type:a,stride:s,offset:o,normalized:c,integer:f,divisor:d}=this._getAccessor(e);this.device.gl.bindVertexArray(this.handle),this.device.gl.bindBuffer(34962,n.handle),f?this.device.gl.vertexAttribIPointer(e,i,a,s,o):this.device.gl.vertexAttribPointer(e,i,a,c,s,o),this.device.gl.bindBuffer(34962,null),this.device.gl.enableVertexAttribArray(e),this.device.gl.vertexAttribDivisor(e,d||0),this.attributes[e]=n,this.device.gl.bindVertexArray(null)}setConstantWebGL(e,r){this._enable(e,!1),this.attributes[e]=r}bindBeforeRender(){this.device.gl.bindVertexArray(this.handle),this._applyConstantAttributes()}unbindAfterRender(){this.device.gl.bindVertexArray(null)}_applyConstantAttributes(){for(let e=0;e<this.maxVertexAttributes;++e){const r=this.attributes[e];ArrayBuffer.isView(r)&&this.device.setConstantAttributeWebGL(e,r)}}_getAccessor(e){const r=this.attributeInfos[e];if(!r)throw new Error(`Unknown attribute location ${e}`);const n=Sne(r.bufferDataType);return{size:r.bufferComponents,type:n,stride:r.byteStride,offset:r.byteOffset,normalized:r.normalized,integer:r.integer,divisor:r.stepMode==="instance"?1:0}}_enable(e,r=!0){const i=T6.isConstantAttributeZeroSupported(this.device)||e!==0;(r||i)&&(e=Number(e),this.device.gl.bindVertexArray(this.handle),r?this.device.gl.enableVertexAttribArray(e):this.device.gl.disableVertexAttribArray(e),this.device.gl.bindVertexArray(null))}getConstantBuffer(e,r){const n=DHe(r),i=n.byteLength*e,a=n.length*e;if(this.buffer&&i!==this.buffer.byteLength)throw new Error(`Buffer size is immutable, byte length ${i} !== ${this.buffer.byteLength}.`);let s=!this.buffer;if(this.buffer=this.buffer||this.device.createBuffer({byteLength:i}),s||=!OHe(n,this.bufferValue),s){const o=U9e(r.constructor,a);MHe({target:o,source:n,start:0,count:a}),this.buffer.write(o),this.bufferValue=r}return this.buffer}}function DHe(t){return Array.isArray(t)?new Float32Array(t):t}function OHe(t,e){if(!t||!e||t.length!==e.length||t.constructor!==e.constructor)return!1;for(let r=0;r<t.length;++r)if(t[r]!==e[r])return!1;return!0}class NHe extends YL{device;gl;handle;layout;buffers={};unusedBuffers={};bindOnUse=!0;_bound=!1;constructor(e,r){super(e,r),this.device=e,this.gl=e.gl,this.handle=this.props.handle||this.gl.createTransformFeedback(),this.layout=this.props.layout,r.buffers&&this.setBuffers(r.buffers),Object.seal(this)}destroy(){this.gl.deleteTransformFeedback(this.handle),super.destroy()}begin(e="point-list"){this.gl.bindTransformFeedback(36386,this.handle),this.bindOnUse&&this._bindBuffers(),this.gl.beginTransformFeedback(wHe(e))}end(){this.gl.endTransformFeedback(),this.bindOnUse&&this._unbindBuffers(),this.gl.bindTransformFeedback(36386,null)}setBuffers(e){this.buffers={},this.unusedBuffers={},this.bind(()=>{for(const r in e)this.setBuffer(r,e[r])})}setBuffer(e,r){const n=this._getVaryingIndex(e),{buffer:i,byteLength:a,byteOffset:s}=this._getBufferRange(r);if(n<0){this.unusedBuffers[e]=i,rn.warn(`${this.id} unusedBuffers varying buffer ${e}`)();return}this.buffers[n]={buffer:i,byteLength:a,byteOffset:s},this.bindOnUse||this._bindBuffer(n,i,s,a)}getBuffer(e){if(MW(e))return this.buffers[e]||null;const r=this._getVaryingIndex(e);return r>=0?this.buffers[r]:null}bind(e=this.handle){if(typeof e!="function")return this.gl.bindTransformFeedback(36386,e),this;let r;return this._bound?r=e():(this.gl.bindTransformFeedback(36386,this.handle),this._bound=!0,r=e(),this._bound=!1,this.gl.bindTransformFeedback(36386,null)),r}unbind(){this.bind(null)}_getBufferRange(e){if(e instanceof Pb)return{buffer:e,byteOffset:0,byteLength:e.byteLength};const{buffer:r,byteOffset:n=0,byteLength:i=e.buffer.byteLength}=e;return{buffer:r,byteOffset:n,byteLength:i}}_getVaryingIndex(e){if(MW(e))return Number(e);for(const r of this.layout.varyings||[])if(e===r.name)return r.location;return-1}_bindBuffers(){for(const e in this.buffers){const{buffer:r,byteLength:n,byteOffset:i}=this._getBufferRange(this.buffers[e]);this._bindBuffer(Number(e),r,i,n)}}_unbindBuffers(){for(const e in this.buffers)this.gl.bindBufferBase(35982,Number(e),null)}_bindBuffer(e,r,n=0,i){const a=r&&r.handle;!a||i===void 0?this.gl.bindBufferBase(35982,e,a):this.gl.bindBufferRange(35982,e,a,n,i)}}function MW(t){return typeof t=="number"?Number.isInteger(t):/^\d+$/.test(t)}class LHe extends ZL{device;handle;target=null;_queryPending=!1;_pollingPromise=null;get[Symbol.toStringTag](){return"Query"}constructor(e,r){if(super(e,r),this.device=e,r.count>1)throw new Error("WebGL QuerySet can only have one value");const n=this.device.gl.createQuery();if(!n)throw new Error("WebGL query not supported");this.handle=n,Object.seal(this)}destroy(){this.device.gl.deleteQuery(this.handle)}beginTimestampQuery(){return this._begin(35007)}endTimestampQuery(){this._end()}beginOcclusionQuery(e){return this._begin(e?.conservative?36202:35887)}endOcclusionQuery(){this._end()}beginTransformFeedbackQuery(){return this._begin(35976)}endTransformFeedbackQuery(){this._end()}async resolveQuery(){return[await this.pollQuery()]}_begin(e){this._queryPending||(this.target=e,this.device.gl.beginQuery(this.target,this.handle))}_end(){this._queryPending||this.target&&(this.device.gl.endQuery(this.target),this.target=null,this._queryPending=!0)}isResultAvailable(){if(!this._queryPending)return!1;const e=this.device.gl.getQueryParameter(this.handle,34919);return e&&(this._queryPending=!1),e}isTimerDisjoint(){return this.device.gl.getParameter(36795)}getResult(){return this.device.gl.getQueryParameter(this.handle,34918)}getTimerMilliseconds(){return this.getResult()/1e6}pollQuery(e=Number.POSITIVE_INFINITY){if(this._pollingPromise)return this._pollingPromise;let r=0;return this._pollingPromise=new Promise((n,i)=>{const a=()=>{this.isResultAvailable()?(n(this.getResult()),this._pollingPromise=null):r++>e?(i("Timed out"),this._pollingPromise=null):requestAnimationFrame(a)};requestAnimationFrame(a)}),this._pollingPromise}}function Ine(t){switch(t){case 6406:case 33326:case 6403:case 36244:return 1;case 33339:case 33340:case 33328:case 33320:case 33319:return 2;case 6407:case 36248:case 34837:return 3;case 6408:case 36249:case 34836:return 4;default:return 0}}function FHe(t){switch(t){case 5121:return 1;case 33635:case 32819:case 32820:return 2;case 5126:return 4;default:return 0}}function BHe(t){return zHe[t]}const zHe={5124:"sint32",5125:"uint32",5122:"sint16",5123:"uint16",5120:"sint8",5121:"uint8",5126:"float32",5131:"float16",33635:"uint16",32819:"uint16",32820:"uint16",33640:"uint32",35899:"uint32",35902:"uint32",34042:"uint32",36269:"uint32"};function jHe(t,e){const{sourceX:r=0,sourceY:n=0,sourceAttachment:i=0}=e||{};let{target:a=null,sourceWidth:s,sourceHeight:o,sourceDepth:c,sourceFormat:f,sourceType:d}=e||{};const{framebuffer:m,deleteFramebuffer:b}=Pne(t),{gl:x,handle:E}=m;s||=m.width,o||=m.height;const T=m.colorAttachments[i]?.texture;if(!T)throw new Error(`Invalid framebuffer attachment ${i}`);c=T?.depth||1,f||=T?.glFormat||6408,d||=T?.glType||5121,a=$He(a,d,f,s,o);const A=VL(a);d=d||uHe(A);const M=x.bindFramebuffer(36160,E);return x.readBuffer(36064+i),x.readPixels(r,n,s,o,f,d,a),x.readBuffer(36064),x.bindFramebuffer(36160,M||null),b&&m.destroy(),a}function UHe(t,e){const{target:r,sourceX:n=0,sourceY:i=0,sourceFormat:a=6408,targetByteOffset:s=0}=e||{};let{sourceWidth:o,sourceHeight:c,sourceType:f}=e||{};const{framebuffer:d,deleteFramebuffer:m}=Pne(t);o=o||d.width,c=c||d.height;const b=d;f=f||5121;let x=r;if(!x){const T=Ine(a),A=FHe(f),M=s+o*c*T*A;x=b.device.createBuffer({byteLength:M})}const E=t.device.createCommandEncoder();return E.copyTextureToBuffer({sourceTexture:t,width:o,height:c,origin:[n,i],destinationBuffer:x,byteOffset:s}),E.destroy(),m&&d.destroy(),x}function Pne(t){return t instanceof J3?{framebuffer:t,deleteFramebuffer:!1}:{framebuffer:VHe(t),deleteFramebuffer:!0}}function VHe(t,e){const{device:r,width:n,height:i,id:a}=t;return r.createFramebuffer({...e,id:`framebuffer-for-${a}`,width:n,height:i,colorAttachments:[t]})}function $He(t,e,r,n,i,a){if(t)return t;e||=5121;const s=BHe(e),o=$L(s),c=Ine(r);return new o(n*i*c)}class xD extends hy{type="webgl";handle;features;limits;info;canvasContext;preferredColorFormat="rgba8unorm";preferredDepthFormat="depth24plus";commandEncoder;lost;_resolveContextLost;gl;_constants;_extensions={};_polyfilled=!1;spectorJS;get[Symbol.toStringTag](){return"WebGLDevice"}toString(){return`${this[Symbol.toStringTag]}(${this.id})`}isVertexFormatSupported(e){switch(e){case"unorm8x4-bgra":return!1;default:return!0}}constructor(e){super({...e,id:e.id||Yqe("webgl-device")});const r=hy._getCanvasContextProps(e);if(!r)throw new Error("WebGLDevice requires props.createCanvasContext to be set");let n=r.canvas?.gl?.device;if(n)throw new Error(`WebGL context already attached to device ${n.id}`);this.canvasContext=new Xqe(this,r),this.lost=new Promise(d=>{this._resolveContextLost=d});const i={...e.webgl};r.alphaMode==="premultiplied"&&(i.premultipliedAlpha=!0),e.powerPreference!==void 0&&(i.powerPreference=e.powerPreference);const s=this.props._handle||Iqe(this.canvasContext.canvas,{onContextLost:d=>this._resolveContextLost?.({reason:"destroyed",message:"Entered sleep mode, or too many apps or browser tabs are using the GPU."}),onContextRestored:d=>console.log("WebGL context restored")},i);if(!s)throw new Error("WebGL context creation failed");if(n=s.device,n){if(e._reuseDevices)return rn.log(1,`Not creating a new Device, instead returning a reference to Device ${n.id} already attached to WebGL context`,n)(),n._reused=!0,n;throw new Error(`WebGL context already attached to device ${n.id}`)}this.handle=s,this.gl=s,this.spectorJS=cqe({...this.props,gl:this.handle}),this.gl.device=this,this.gl._version=2,this.info=Pqe(this.gl,this._extensions),this.limits=new Hqe(this.gl),this.features=new qqe(this.gl,this._extensions,this.props._disabledFeatures),this.props._initializeFeatures&&this.features.initializeFeatures(),new Wm(this.gl,{log:(...d)=>rn.log(1,...d)()}).trackState(this.gl,{copyState:!1});const c=e.debugWebGL||e.debug,f=e.debugWebGL;c&&(this.gl=dqe(this.gl,{debugWebGL:c,traceWebGL:f}),rn.warn("WebGL debug mode activated. Performance reduced.")(),e.debugWebGL&&(rn.level=Math.max(rn.level,1))),this.commandEncoder=new RW(this,{id:`${this}-command-encoder`})}destroy(){!this.props._reuseDevices&&!this._reused&&delete this.gl.device}get isLost(){return this.gl.isContextLost()}getTextureByteAlignment(){return 4}createCanvasContext(e){throw new Error("WebGL only supports a single canvas")}createBuffer(e){const r=this._normalizeBufferProps(e);return new Pb(this,r)}createTexture(e){return new kb(this,e)}createExternalTexture(e){throw new Error("createExternalTexture() not implemented")}createSampler(e){return new oHe(this,e)}createShader(e){return new Qqe(this,e)}createFramebuffer(e){return new Ib(this,e)}createVertexArray(e){return new T6(this,e)}createTransformFeedback(e){return new NHe(this,e)}createQuerySet(e){return new LHe(this,e)}createRenderPipeline(e){return new SHe(this,e)}createComputePipeline(e){throw new Error("ComputePipeline not supported in WebGL")}createCommandEncoder(e={}){return new RW(this,e)}submit(e){e||(e=this.commandEncoder.finish(),this.commandEncoder.destroy(),this.commandEncoder=this.createCommandEncoder({id:`${this.id}-default-encoder`})),e._executeCommands()}readPixelsToArrayWebGL(e,r){return jHe(e,r)}readPixelsToBufferWebGL(e,r){return UHe(e,r)}setParametersWebGL(e){k_(this.gl,e)}getParametersWebGL(e){return xne(this.gl,e)}withParametersWebGL(e,r){return vx(this.gl,e,r)}resetWebGL(){rn.warn("WebGLDevice.resetWebGL is deprecated, use only for debugging")(),Sqe(this.gl)}_getDeviceSpecificTextureFormatCapabilities(e){return jqe(this.gl,e,this._extensions)}loseDevice(){let e=!1;const n=this.getExtension("WEBGL_lose_context").WEBGL_lose_context;return n&&(e=!0,n.loseContext()),this._resolveContextLost?.({reason:"destroyed",message:"Application triggered context loss"}),e}pushState(){Wm.get(this.gl).push()}popState(){Wm.get(this.gl).pop()}getGLKey(e,r){const n=Number(e);for(const i in this.gl)if(this.gl[i]===n)return`GL.${i}`;return r?.emptyIfUnknown?"":String(e)}getGLKeys(e){const r={emptyIfUnknown:!0};return Object.entries(e).reduce((n,[i,a])=>(n[`${i}:${this.getGLKey(i,r)}`]=`${a}:${this.getGLKey(a,r)}`,n),{})}setConstantAttributeWebGL(e,r){const n=this.limits.maxVertexAttributes;this._constants=this._constants||new Array(n).fill(null);const i=this._constants[e];switch(i&&WHe(i,r)&&rn.info(1,`setConstantAttributeWebGL(${e}) could have been skipped, value unchanged`)(),this._constants[e]=r,r.constructor){case Float32Array:qHe(this,e,r);break;case Int32Array:HHe(this,e,r);break;case Uint32Array:GHe(this,e,r);break;default:throw new Error("constant")}}getExtension(e){return u_(this.gl,e,this._extensions),this._extensions}_setWebGLDebugMetadata(e,r,n){e.luma=r;const i={props:n.spector,id:n.spector.id};e.__SPECTOR_Metadata=i}}function qHe(t,e,r){switch(r.length){case 1:t.gl.vertexAttrib1fv(e,r);break;case 2:t.gl.vertexAttrib2fv(e,r);break;case 3:t.gl.vertexAttrib3fv(e,r);break;case 4:t.gl.vertexAttrib4fv(e,r);break}}function HHe(t,e,r){t.gl.vertexAttribI4iv(e,r)}function GHe(t,e,r){t.gl.vertexAttribI4uiv(e,r)}function WHe(t,e){if(!t||!e||t.length!==e.length||t.constructor!==e.constructor)return!1;for(let r=0;r<t.length;++r)if(t[r]!==e[r])return!1;return!0}const DW=Object.freeze(Object.defineProperty({__proto__:null,WebGLDevice:xD},Symbol.toStringTag,{value:"Module"}));function ig(){}const XHe=({isDragging:t})=>t?"grabbing":"grab",kne={id:"",width:"100%",height:"100%",style:null,viewState:null,initialViewState:null,pickingRadius:0,layerFilter:null,parameters:{},parent:null,device:null,deviceProps:{},gl:null,canvas:null,layers:[],effects:[],views:null,controller:null,useDevicePixels:!0,touchAction:"none",eventRecognizerOptions:{},_framebuffer:null,_animate:!1,_pickable:!0,_typedArrayManagerProps:{},_customRender:null,widgets:[],onDeviceInitialized:ig,onWebGLInitialized:ig,onResize:ig,onViewStateChange:ig,onInteractionStateChange:ig,onBeforeRender:ig,onAfterRender:ig,onLoad:ig,onError:t=>po.error(t.message,t.cause)(),onHover:null,onClick:null,onDragStart:null,onDrag:null,onDragEnd:null,_onMetrics:null,getCursor:XHe,getTooltip:null,debug:!1,drawPickingColors:!1};class _x{constructor(e){this.width=0,this.height=0,this.userData={},this.device=null,this.canvas=null,this.viewManager=null,this.layerManager=null,this.effectManager=null,this.deckRenderer=null,this.deckPicker=null,this.eventManager=null,this.widgetManager=null,this.tooltip=null,this.animationLoop=null,this.cursorState={isHovering:!1,isDragging:!1},this.stats=new W3({id:"deck.gl"}),this.metrics={fps:0,setPropsTime:0,updateAttributesTime:0,framesRedrawn:0,pickTime:0,pickCount:0,gpuTime:0,gpuTimePerFrame:0,cpuTime:0,cpuTimePerFrame:0,bufferMemory:0,textureMemory:0,renderbufferMemory:0,gpuMemory:0},this._metricsCounter=0,this._needsRedraw="Initial render",this._pickRequest={mode:"hover",x:-1,y:-1,radius:0,event:null},this._lastPointerDownInfo=null,this._onPointerMove=n=>{const{_pickRequest:i}=this;if(n.type==="pointerleave")i.x=-1,i.y=-1,i.radius=0;else{if(n.leftButton||n.rightButton)return;{const a=n.offsetCenter;if(!a)return;i.x=a.x,i.y=a.y,i.radius=this.props.pickingRadius}}this.layerManager&&(this.layerManager.context.mousePosition={x:i.x,y:i.y}),i.event=n},this._onEvent=n=>{const i=fD[n.type],a=n.offsetCenter;if(!i||!a||!this.layerManager)return;const s=this.layerManager.getLayers(),o=this.deckPicker.getLastPickedObject({x:a.x,y:a.y,layers:s,viewports:this.getViewports(a)},this._lastPointerDownInfo),{layer:c}=o,f=c&&(c[i]||c.props[i]),d=this.props[i];let m=!1;f&&(m=f.call(c,o,n)),m||(d?.(o,n),this.widgetManager.onEvent(o,n))},this._onPointerDown=n=>{if(this.device?.type==="webgpu")return;const i=n.offsetCenter,a=this._pick("pickObject","pickObject Time",{x:i.x,y:i.y,radius:this.props.pickingRadius});this._lastPointerDownInfo=a.result[0]||a.emptyInfo},this.props={...kne,...e},e=this.props,e.viewState&&e.initialViewState&&po.warn("View state tracking is disabled. Use either `initialViewState` for auto update or `viewState` for manual update.")(),this.viewState=this.props.initialViewState,e.device&&(this.device=e.device);let r=this.device;if(!r&&e.gl){e.gl instanceof WebGLRenderingContext&&po.error("WebGL1 context not supported.")();const n=this.props.deviceProps?.onResize;r=lk.attach(e.gl,{...this.props.deviceProps,onResize:(i,a)=>{const{width:s,height:o}=i.canvas;i.drawingBufferWidth=s,i.drawingBufferHeight=o,this._needsRedraw="Canvas resized",n?.(i,a)}})}r||(r=this._createDevice(e)),this.animationLoop=this._createAnimationLoop(r,e),this.setProps(e),e._typedArrayManagerProps&&yx.setOptions(e._typedArrayManagerProps),this.animationLoop.start()}finalize(){this.animationLoop?.stop(),this.animationLoop?.destroy(),this.animationLoop=null,this._lastPointerDownInfo=null,this.layerManager?.finalize(),this.layerManager=null,this.viewManager?.finalize(),this.viewManager=null,this.effectManager?.finalize(),this.effectManager=null,this.deckRenderer?.finalize(),this.deckRenderer=null,this.deckPicker?.finalize(),this.deckPicker=null,this.eventManager?.destroy(),this.eventManager=null,this.widgetManager?.finalize(),this.widgetManager=null,!this.props.canvas&&!this.props.device&&!this.props.gl&&this.canvas&&(this.canvas.parentElement?.removeChild(this.canvas),this.canvas=null)}setProps(e){this.stats.get("setProps Time").timeStart(),"onLayerHover"in e&&po.removed("onLayerHover","onHover")(),"onLayerClick"in e&&po.removed("onLayerClick","onClick")(),e.initialViewState&&!Bf(this.props.initialViewState,e.initialViewState,3)&&(this.viewState=e.initialViewState),Object.assign(this.props,e),this._setCanvasSize(this.props);const r=Object.create(this.props);Object.assign(r,{views:this._getViews(),width:this.width,height:this.height,viewState:this._getViewState()}),e.device&&e.device.id!==this.device?.id&&(this.animationLoop?.stop(),this.canvas!==e.device.canvasContext?.canvas&&(this.canvas?.remove(),this.eventManager?.destroy(),this.canvas=null),po.log(`recreating animation loop for new device! id=${e.device.id}`)(),this.animationLoop=this._createAnimationLoop(e.device,e),this.animationLoop.start()),this.animationLoop?.setProps(r),e.useDevicePixels!==void 0&&this.device?.canvasContext&&this.device.canvasContext.setProps({useDevicePixels:e.useDevicePixels}),this.layerManager&&(this.viewManager.setProps(r),this.layerManager.activateViewport(this.getViewports()[0]),this.layerManager.setProps(r),this.effectManager.setProps(r),this.deckRenderer.setProps(r),this.deckPicker.setProps(r),this.widgetManager.setProps(r)),this.stats.get("setProps Time").timeEnd()}needsRedraw(e={clearRedrawFlags:!1}){if(!this.layerManager)return!1;if(this.props._animate)return"Deck._animate";let r=this._needsRedraw;e.clearRedrawFlags&&(this._needsRedraw=!1);const n=this.viewManager.needsRedraw(e),i=this.layerManager.needsRedraw(e),a=this.effectManager.needsRedraw(e),s=this.deckRenderer.needsRedraw(e);return r=r||n||i||a||s,r}redraw(e){if(!this.layerManager)return;let r=this.needsRedraw({clearRedrawFlags:!0});r=e||r,r&&(this.stats.get("Redraw Count").incrementCount(),this.props._customRender?this.props._customRender(r):this._drawLayers(r))}get isInitialized(){return this.viewManager!==null}getViews(){return El(this.viewManager),this.viewManager.views}getViewports(e){return El(this.viewManager),this.viewManager.getViewports(e)}getCanvas(){return this.canvas}pickObject(e){const r=this._pick("pickObject","pickObject Time",e).result;return r.length?r[0]:null}pickMultipleObjects(e){return e.depth=e.depth||10,this._pick("pickObject","pickMultipleObjects Time",e).result}pickObjects(e){return this._pick("pickObjects","pickObjects Time",e)}_addResources(e,r=!1){for(const n in e)this.layerManager.resourceManager.add({resourceId:n,data:e[n],forceUpdate:r})}_removeResources(e){for(const r of e)this.layerManager.resourceManager.remove(r)}_addDefaultEffect(e){this.effectManager.addDefaultEffect(e)}_addDefaultShaderModule(e){this.layerManager.addDefaultShaderModule(e)}_removeDefaultShaderModule(e){this.layerManager?.removeDefaultShaderModule(e)}_pick(e,r,n){El(this.deckPicker);const{stats:i}=this;i.get("Pick Count").incrementCount(),i.get(r).timeStart();const a=this.deckPicker[e]({layers:this.layerManager.getLayers(n),views:this.viewManager.getViews(),viewports:this.getViewports(n),onViewportActive:this.layerManager.activateViewport,effects:this.effectManager.getEffects(),...n});return i.get(r).timeEnd(),a}_createCanvas(e){let r=e.canvas;return typeof r=="string"&&(r=document.getElementById(r),El(r)),r||(r=document.createElement("canvas"),r.id=e.id||"deckgl-overlay",e.width&&typeof e.width=="number"&&(r.width=e.width),e.height&&typeof e.height=="number"&&(r.height=e.height),(e.parent||document.body).appendChild(r)),Object.assign(r.style,e.style),r}_setCanvasSize(e){if(!this.canvas)return;const{width:r,height:n}=e;if(r||r===0){const i=Number.isFinite(r)?`${r}px`:r;this.canvas.style.width=i}if(n||n===0){const i=Number.isFinite(n)?`${n}px`:n;this.canvas.style.position=e.style?.position||"absolute",this.canvas.style.height=i}}_updateCanvasSize(){const{canvas:e}=this;if(!e)return;const r=e.clientWidth??e.width,n=e.clientHeight??e.height;(r!==this.width||n!==this.height)&&(this.width=r,this.height=n,this.viewManager?.setProps({width:r,height:n}),this.layerManager?.activateViewport(this.getViewports()[0]),this.props.onResize({width:r,height:n}))}_createAnimationLoop(e,r){const{gl:n,onError:i}=r;return new d6({device:e,autoResizeDrawingBuffer:!n,autoResizeViewport:!1,onInitialize:a=>this._setDevice(a.device),onRender:this._onRenderFrame.bind(this),onError:i})}_createDevice(e){const r=this.props.deviceProps?.createCanvasContext,n=typeof r=="object"?r:void 0,i={adapters:[],_cacheShaders:!0,_cachePipelines:!0,...e.deviceProps};i.adapters.includes(lk)||i.adapters.push(lk);const a={alphaMode:this.props.deviceProps?.type==="webgpu"?"premultiplied":void 0},s=this.props.deviceProps?.onResize;return tD.createDevice({_reuseDevices:!0,type:"webgl",...i,createCanvasContext:{...a,...n,canvas:this._createCanvas(e),useDevicePixels:this.props.useDevicePixels,autoResize:!0},onResize:(o,c)=>{this._needsRedraw="Canvas resized",s?.(o,c)}})}_getViewState(){return this.props.viewState||this.viewState}_getViews(){const{views:e}=this.props,r=Array.isArray(e)?e:e?[e]:[new v6({id:"default-view"})];return r.length&&this.props.controller&&(r[0].props.controller=this.props.controller),r}_onContextLost(){const{onError:e}=this.props;this.animationLoop&&e&&e(new Error("WebGL context is lost"))}_pickAndCallback(){if(this.device?.type==="webgpu")return;const{_pickRequest:e}=this;if(e.event){const{result:r,emptyInfo:n}=this._pick("pickObject","pickObject Time",e);this.cursorState.isHovering=r.length>0;let i=n,a=!1;for(const s of r)i=s,a=s.layer?.onHover(s,e.event)||a;a||(this.props.onHover?.(i,e.event),this.widgetManager.onHover(i,e.event)),e.event=null}}_updateCursor(){const e=this.props.parent||this.canvas;e&&(e.style.cursor=this.props.getCursor(this.cursorState))}_setDevice(e){if(this.device=e,!this.animationLoop)return;this.canvas||(this.canvas=this.device.canvasContext?.canvas,!this.canvas.isConnected&&this.props.parent&&this.props.parent.insertBefore(this.canvas,this.props.parent.firstChild)),this.device.type==="webgl"&&this.device.setParametersWebGL({blend:!0,blendFunc:[770,771,1,771],polygonOffsetFill:!0,depthTest:!0,depthFunc:515}),this.props.onDeviceInitialized(this.device),this.device.type==="webgl"&&this.props.onWebGLInitialized(this.device.gl);const r=new fne;r.play(),this.animationLoop.attachTimeline(r),this.eventManager=new kUe(this.props.parent||this.canvas,{touchAction:this.props.touchAction,recognizers:Object.keys(XG).map(i=>{const[a,s,o,c]=XG[i],f=this.props.eventRecognizerOptions?.[i],d={...s,...f,event:i};return{recognizer:new a(d),recognizeWith:o,requestFailure:c}}),events:{pointerdown:this._onPointerDown,pointermove:this._onPointerMove,pointerleave:this._onPointerMove}});for(const i in fD)this.eventManager.on(i,this._onEvent);this.viewManager=new P$e({timeline:r,eventManager:this.eventManager,onViewStateChange:this._onViewStateChange.bind(this),onInteractionStateChange:this._onInteractionStateChange.bind(this),views:this._getViews(),viewState:this._getViewState(),width:this.width,height:this.height});const n=this.viewManager.getViewports()[0];this.layerManager=new I$e(this.device,{deck:this,stats:this.stats,viewport:n,timeline:r}),this.effectManager=new q$e({deck:this,device:this.device}),this.deckRenderer=new W$e(this.device),this.deckPicker=new Z$e(this.device),this.widgetManager=new Q$e({deck:this,parentElement:this.canvas?.parentElement}),this.widgetManager.addDefault(new vne),this.setProps(this.props),this._updateCanvasSize(),this.props.onLoad()}_drawLayers(e,r){const{device:n,gl:i}=this.layerManager.context;this.props.onBeforeRender({device:n,gl:i});const a={target:this.props._framebuffer,layers:this.layerManager.getLayers(),viewports:this.viewManager.getViewports(),onViewportActive:this.layerManager.activateViewport,views:this.viewManager.getViews(),pass:"screen",effects:this.effectManager.getEffects(),...r};this.deckRenderer?.renderLayers(a),a.pass==="screen"&&this.widgetManager.onRedraw({viewports:a.viewports,layers:a.layers}),this.props.onAfterRender({device:n,gl:i})}_onRenderFrame(){this._getFrameStats(),this._metricsCounter++%60===0&&(this._getMetrics(),this.stats.reset(),po.table(4,this.metrics)(),this.props._onMetrics&&this.props._onMetrics(this.metrics)),this._updateCanvasSize(),this._updateCursor(),this.layerManager.updateLayers(),this.device?.type!=="webgpu"&&this._pickAndCallback(),this.redraw(),this.viewManager&&this.viewManager.updateViewStates()}_onViewStateChange(e){const r=this.props.onViewStateChange(e)||e.viewState;this.viewState&&(this.viewState={...this.viewState,[e.viewId]:r},this.props.viewState||this.viewManager&&this.viewManager.setProps({viewState:this.viewState}))}_onInteractionStateChange(e){this.cursorState.isDragging=e.isDragging||!1,this.props.onInteractionStateChange(e)}_getFrameStats(){const{stats:e}=this;e.get("frameRate").timeEnd(),e.get("frameRate").timeStart();const r=this.animationLoop.stats;e.get("GPU Time").addTime(r.get("GPU Time").lastTiming),e.get("CPU Time").addTime(r.get("CPU Time").lastTiming)}_getMetrics(){const{metrics:e,stats:r}=this;e.fps=r.get("frameRate").getHz(),e.setPropsTime=r.get("setProps Time").time,e.updateAttributesTime=r.get("Update Attributes").time,e.framesRedrawn=r.get("Redraw Count").count,e.pickTime=r.get("pickObject Time").time+r.get("pickMultipleObjects Time").time+r.get("pickObjects Time").time,e.pickCount=r.get("Pick Count").count,e.gpuTime=r.get("GPU Time").time,e.cpuTime=r.get("CPU Time").time,e.gpuTimePerFrame=r.get("GPU Time").getAverageTime(),e.cpuTimePerFrame=r.get("CPU Time").getAverageTime();const n=tD.stats.get("Memory Usage");e.bufferMemory=n.get("Buffer Memory").count,e.textureMemory=n.get("Texture Memory").count,e.renderbufferMemory=n.get("Renderbuffer Memory").count,e.gpuMemory=n.get("GPU Memory").count}}_x.defaultProps=kne;_x.VERSION=mze;function YHe(t){switch(t){case"float64":return Float64Array;case"uint8":case"unorm8":return Uint8ClampedArray;default:return $L(t)}}const ZHe=VL;function iS(t,e,r){const n=r==="webgpu"&&e.type==="uint8"?"unorm8":e.type;return{attribute:t,format:e.size>1?`${n}x${e.size}`:e.type,byteOffset:e.offset||0}}function Om(t){return t.stride||t.size*t.bytesPerElement}function KHe(t,e){return t.type===e.type&&t.size===e.size&&Om(t)===Om(e)&&(t.offset||0)===(e.offset||0)}function wD(t,e){e.offset&&po.removed("shaderAttribute.offset","vertexOffset, elementOffset")();const r=Om(t),n=e.vertexOffset!==void 0?e.vertexOffset:t.vertexOffset||0,i=e.elementOffset||0,a=n*r+i*t.bytesPerElement+(t.offset||0);return{...e,offset:a,stride:r}}function JHe(t,e){const r=wD(t,e);return{high:r,low:{...r,offset:r.offset+t.size*4}}}class QHe{constructor(e,r,n){this._buffer=null,this.device=e,this.id=r.id||"",this.size=r.size||1;const i=r.logicalType||r.type,a=i==="float64";let{defaultValue:s}=r;s=Number.isFinite(s)?[s]:s||new Array(this.size).fill(0);let o;a?o="float32":!i&&r.isIndexed?o="uint32":o=i||"float32";let c=YHe(i||o);this.doublePrecision=a,a&&r.fp64===!1&&(c=Float32Array),this.value=null,this.settings={...r,defaultType:c,defaultValue:s,logicalType:i,type:o,normalized:o.includes("norm"),size:this.size,bytesPerElement:c.BYTES_PER_ELEMENT},this.state={...n,externalBuffer:null,bufferAccessor:this.settings,allocatedValue:null,numInstances:0,bounds:null,constant:!1}}get isConstant(){return this.state.constant}get buffer(){return this._buffer}get byteOffset(){const e=this.getAccessor();return e.vertexOffset?e.vertexOffset*Om(e):0}get numInstances(){return this.state.numInstances}set numInstances(e){this.state.numInstances=e}delete(){this._buffer&&(this._buffer.delete(),this._buffer=null),yx.release(this.state.allocatedValue)}getBuffer(){return this.state.constant?null:this.state.externalBuffer||this._buffer}getValue(e=this.id,r=null){const n={};if(this.state.constant){const i=this.value;if(r){const a=wD(this.getAccessor(),r),s=a.offset/i.BYTES_PER_ELEMENT,o=a.size||this.size;n[e]=i.subarray(s,s+o)}else n[e]=i}else n[e]=this.getBuffer();return this.doublePrecision&&(this.value instanceof Float64Array?n[`${e}64Low`]=n[e]:n[`${e}64Low`]=new Float32Array(this.size)),n}_getBufferLayout(e=this.id,r=null){const n=this.getAccessor(),i=[],a={name:this.id,byteStride:Om(n),attributes:i};if(this.doublePrecision){const s=JHe(n,r||{});i.push(iS(e,{...n,...s.high},this.device.type),iS(`${e}64Low`,{...n,...s.low},this.device.type))}else if(r){const s=wD(n,r);i.push(iS(e,{...n,...s},this.device.type))}else i.push(iS(e,n,this.device.type));return a}setAccessor(e){this.state.bufferAccessor=e}getAccessor(){return this.state.bufferAccessor}getBounds(){if(this.state.bounds)return this.state.bounds;let e=null;if(this.state.constant&&this.value){const r=Array.from(this.value);e=[r,r]}else{const{value:r,numInstances:n,size:i}=this,a=n*i;if(r&&a&&r.length>=a){const s=new Array(i).fill(1/0),o=new Array(i).fill(-1/0);for(let c=0;c<a;)for(let f=0;f<i;f++){const d=r[c++];d<s[f]&&(s[f]=d),d>o[f]&&(o[f]=d)}e=[s,o]}}return this.state.bounds=e,e}setData(e){const{state:r}=this;let n;ArrayBuffer.isView(e)?n={value:e}:e instanceof jo?n={buffer:e}:n=e;const i={...this.settings,...n};if(ArrayBuffer.isView(n.value)){if(!n.type)if(this.doublePrecision&&n.value instanceof Float64Array)i.type="float32";else{const s=ZHe(n.value);i.type=i.normalized?s.replace("int","norm"):s}i.bytesPerElement=n.value.BYTES_PER_ELEMENT,i.stride=Om(i)}if(r.bounds=null,n.constant){let a=n.value;if(a=this._normalizeValue(a,[],0),this.settings.normalized&&(a=this.normalizeConstant(a)),!(!r.constant||!this._areValuesEqual(a,this.value)))return!1;r.externalBuffer=null,r.constant=!0,this.value=ArrayBuffer.isView(a)?a:new Float32Array(a)}else if(n.buffer){const a=n.buffer;r.externalBuffer=a,r.constant=!1,this.value=n.value||null}else if(n.value){this._checkExternalBuffer(n);let a=n.value;r.externalBuffer=null,r.constant=!1,this.value=a;let{buffer:s}=this;const o=Om(i),c=(i.vertexOffset||0)*o;if(this.doublePrecision&&a instanceof Float64Array&&(a=tk(a,i)),this.settings.isIndexed){const d=this.settings.defaultType;a.constructor!==d&&(a=new d(a))}const f=a.byteLength+c+o*2;(!s||s.byteLength<f)&&(s=this._createBuffer(f)),s.write(a,c)}return this.setAccessor(i),!0}updateSubBuffer(e={}){this.state.bounds=null;const r=this.value,{startOffset:n=0,endOffset:i}=e;this.buffer.write(this.doublePrecision&&r instanceof Float64Array?tk(r,{size:this.size,startIndex:n,endIndex:i}):r.subarray(n,i),n*r.BYTES_PER_ELEMENT+this.byteOffset)}allocate(e,r=!1){const{state:n}=this,i=n.allocatedValue,a=yx.allocate(i,e+1,{size:this.size,type:this.settings.defaultType,copy:r});this.value=a;const{byteOffset:s}=this;let{buffer:o}=this;return(!o||o.byteLength<a.byteLength+s)&&(o=this._createBuffer(a.byteLength+s),r&&i&&o.write(i instanceof Float64Array?tk(i,this):i,s)),n.allocatedValue=a,n.constant=!1,n.externalBuffer=null,this.setAccessor(this.settings),!0}_checkExternalBuffer(e){const{value:r}=e;if(!ArrayBuffer.isView(r))throw new Error(`Attribute ${this.id} value is not TypedArray`);const n=this.settings.defaultType;let i=!1;if(this.doublePrecision&&(i=r.BYTES_PER_ELEMENT<4),i)throw new Error(`Attribute ${this.id} does not support ${r.constructor.name}`);!(r instanceof n)&&this.settings.normalized&&!("normalized"in e)&&po.warn(`Attribute ${this.id} is normalized`)()}normalizeConstant(e){switch(this.settings.type){case"snorm8":return new Float32Array(e).map(r=>(r+128)/255*2-1);case"snorm16":return new Float32Array(e).map(r=>(r+32768)/65535*2-1);case"unorm8":return new Float32Array(e).map(r=>r/255);case"unorm16":return new Float32Array(e).map(r=>r/65535);default:return e}}_normalizeValue(e,r,n){const{defaultValue:i,size:a}=this.settings;if(Number.isFinite(e))return r[n]=e,r;if(!e){let s=a;for(;--s>=0;)r[n+s]=i[s];return r}switch(a){case 4:r[n+3]=Number.isFinite(e[3])?e[3]:i[3];case 3:r[n+2]=Number.isFinite(e[2])?e[2]:i[2];case 2:r[n+1]=Number.isFinite(e[1])?e[1]:i[1];case 1:r[n+0]=Number.isFinite(e[0])?e[0]:i[0];break;default:let s=a;for(;--s>=0;)r[n+s]=Number.isFinite(e[s])?e[s]:i[s]}return r}_areValuesEqual(e,r){if(!e||!r)return!1;const{size:n}=this;for(let i=0;i<n;i++)if(e[i]!==r[i])return!1;return!0}_createBuffer(e){this._buffer&&this._buffer.destroy();const{isIndexed:r,type:n}=this.settings;return this._buffer=this.device.createBuffer({...this._buffer?.props,id:this.id,usage:(r?jo.INDEX:jo.VERTEX)|jo.COPY_DST,indexType:r?n:void 0,byteLength:e}),this._buffer}}const OW=[],NW=[];function eGe(t,e=0,r=1/0){let n=OW;const i={index:-1,data:t,target:[]};return t?typeof t[Symbol.iterator]=="function"?n=t:t.length>0&&(NW.length=t.length,n=NW):n=OW,(e>0||Number.isFinite(r))&&(n=(Array.isArray(n)?n:Array.from(n)).slice(e,r),i.index=e-1),{iterable:n,objectInfo:i}}function Rne(t){return t&&t[Symbol.asyncIterator]}function tGe(t,e){const{size:r,stride:n,offset:i,startIndices:a,nested:s}=e,o=t.BYTES_PER_ELEMENT,c=n?n/o:r,f=i?i/o:0,d=Math.floor((t.length-f)/c);return(m,{index:b,target:x})=>{if(!a){const M=b*c+f;for(let F=0;F<r;F++)x[F]=t[M+F];return x}const E=a[b],T=a[b+1]||d;let A;if(s){A=new Array(T-E);for(let M=E;M<T;M++){const F=M*c+f;x=new Array(r);for(let N=0;N<r;N++)x[N]=t[F+N];A[M-E]=x}}else if(c===r)A=t.subarray(E*r+f,T*r+f);else{A=new t.constructor((T-E)*r);let M=0;for(let F=E;F<T;F++){const N=F*c+f;for(let O=0;O<r;O++)A[M++]=t[N+O]}}return A}}const rGe=[],BS=[[0,1/0]];function nGe(t,e){if(t===BS||(e[0]<0&&(e[0]=0),e[0]>=e[1]))return t;const r=[],n=t.length;let i=0;for(let a=0;a<n;a++){const s=t[a];s[1]<e[0]?(r.push(s),i=a+1):s[0]>e[1]?r.push(s):e=[Math.min(s[0],e[0]),Math.max(s[1],e[1])]}return r.splice(i,0,e),r}const iGe={interpolation:{duration:0,easing:t=>t},spring:{stiffness:.05,damping:.5}};function Mne(t,e){if(!t)return null;Number.isFinite(t)&&(t={type:"interpolation",duration:t});const r=t.type||"interpolation";return{...iGe[r],...e,...t,type:r}}class Dne extends QHe{constructor(e,r){super(e,r,{startIndices:null,lastExternalBuffer:null,binaryValue:null,binaryAccessor:null,needsUpdate:!0,needsRedraw:!1,layoutChanged:!1,updateRanges:BS}),this.constant=!1,this.settings.update=r.update||(r.accessor?this._autoUpdater:void 0),Object.seal(this.settings),Object.seal(this.state),this._validateAttributeUpdaters()}get startIndices(){return this.state.startIndices}set startIndices(e){this.state.startIndices=e}needsUpdate(){return this.state.needsUpdate}needsRedraw({clearChangedFlags:e=!1}={}){const r=this.state.needsRedraw;return this.state.needsRedraw=r&&!e,r}layoutChanged(){return this.state.layoutChanged}setAccessor(e){var r;(r=this.state).layoutChanged||(r.layoutChanged=!KHe(e,this.getAccessor())),super.setAccessor(e)}getUpdateTriggers(){const{accessor:e}=this.settings;return[this.id].concat(typeof e!="function"&&e||[])}supportsTransition(){return!!this.settings.transition}getTransitionSetting(e){if(!e||!this.supportsTransition())return null;const{accessor:r}=this.settings,n=this.settings.transition,i=Array.isArray(r)?e[r.find(a=>e[a])]:e[r];return Mne(i,n)}setNeedsUpdate(e=this.id,r){if(this.state.needsUpdate=this.state.needsUpdate||e,this.setNeedsRedraw(e),r){const{startRow:n=0,endRow:i=1/0}=r;this.state.updateRanges=nGe(this.state.updateRanges,[n,i])}else this.state.updateRanges=BS}clearNeedsUpdate(){this.state.needsUpdate=!1,this.state.updateRanges=rGe}setNeedsRedraw(e=this.id){this.state.needsRedraw=this.state.needsRedraw||e}allocate(e){const{state:r,settings:n}=this;return n.noAlloc?!1:n.update?(super.allocate(e,r.updateRanges!==BS),!0):!1}updateBuffer({numInstances:e,data:r,props:n,context:i}){if(!this.needsUpdate())return!1;const{state:{updateRanges:a},settings:{update:s,noAlloc:o}}=this;let c=!0;if(s){for(const[f,d]of a)s.call(i,this,{data:r,startRow:f,endRow:d,props:n,numInstances:e});if(this.value)if(this.constant||!this.buffer||this.buffer.byteLength<this.value.byteLength+this.byteOffset)this.setData({value:this.value,constant:this.constant}),this.constant=!1;else for(const[f,d]of a){const m=Number.isFinite(f)?this.getVertexOffset(f):0,b=Number.isFinite(d)?this.getVertexOffset(d):o||!Number.isFinite(e)?this.value.length:e*this.size;super.updateSubBuffer({startOffset:m,endOffset:b})}this._checkAttributeArray()}else c=!1;return this.clearNeedsUpdate(),this.setNeedsRedraw(),c}setConstantValue(e,r){const n=this.device.type==="webgpu";if(n||r===void 0||typeof r=="function"){if(n&&typeof r!="function"){const s=this._normalizeValue(r,[],0);this._areValuesEqual(s,this.value)||this.setNeedsUpdate("WebGPU constant updated")}return!1}const i=this.settings.transform&&e?this.settings.transform.call(e,r):r;return this.setData({constant:!0,value:i})&&this.setNeedsRedraw(),this.clearNeedsUpdate(),!0}setExternalBuffer(e){const{state:r}=this;return e?(this.clearNeedsUpdate(),r.lastExternalBuffer===e||(r.lastExternalBuffer=e,this.setNeedsRedraw(),this.setData(e)),!0):(r.lastExternalBuffer=null,!1)}setBinaryValue(e,r=null){const{state:n,settings:i}=this;if(!e)return n.binaryValue=null,n.binaryAccessor=null,!1;if(i.noAlloc)return!1;if(n.binaryValue===e)return this.clearNeedsUpdate(),!0;if(n.binaryValue=e,this.setNeedsRedraw(),i.transform||r!==this.startIndices){ArrayBuffer.isView(e)&&(e={value:e});const s=e;El(ArrayBuffer.isView(s.value),`invalid ${i.accessor}`);const o=!!s.size&&s.size!==this.size;return n.binaryAccessor=tGe(s.value,{size:s.size||this.size,stride:s.stride,offset:s.offset,startIndices:r,nested:o}),!1}return this.clearNeedsUpdate(),this.setData(e),!0}getVertexOffset(e){const{startIndices:r}=this;return(r?e<r.length?r[e]:this.numInstances:e)*this.size}getValue(){const e=this.settings.shaderAttributes,r=super.getValue();if(!e)return r;for(const n in e)Object.assign(r,super.getValue(n,e[n]));return r}getBufferLayout(e){this.state.layoutChanged=!1;const r=this.settings.shaderAttributes,n=super._getBufferLayout(),{stepMode:i}=this.settings;if(i==="dynamic"?n.stepMode=e?e.isInstanced?"instance":"vertex":"instance":n.stepMode=i??"vertex",!r)return n;for(const a in r){const s=super._getBufferLayout(a,r[a]);n.attributes.push(...s.attributes)}return n}_autoUpdater(e,{data:r,startRow:n,endRow:i,props:a,numInstances:s}){if(e.constant&&this.context.device.type!=="webgpu")return;const{settings:o,state:c,value:f,size:d,startIndices:m}=e,{accessor:b,transform:x}=o;let E=c.binaryAccessor||(typeof b=="function"?b:a[b]);typeof E!="function"&&typeof b=="string"&&(E=()=>a[b]),El(typeof E=="function",`accessor "${b}" is not a function`);let T=e.getVertexOffset(n);const{iterable:A,objectInfo:M}=eGe(r,n,i);for(const F of A){M.index++;let N=E(F,M);if(x&&(N=x.call(this,N)),m){const O=(M.index<m.length-1?m[M.index+1]:s)-m[M.index];if(N&&Array.isArray(N[0])){let U=T;for(const j of N)e._normalizeValue(j,f,U),U+=d}else N&&N.length>d?f.set(N,T):(e._normalizeValue(N,M.target,0),S$e({target:f,source:M.target,start:T,count:O}));T+=O*d}else e._normalizeValue(N,f,T),T+=d}}_validateAttributeUpdaters(){const{settings:e}=this;if(!(e.noAlloc||typeof e.update=="function"))throw new Error(`Attribute ${this.id} missing update or accessor`)}_checkAttributeArray(){const{value:e}=this,r=Math.min(4,this.size);if(e&&e.length>=r){let n=!0;switch(r){case 4:n=n&&Number.isFinite(e[3]);case 3:n=n&&Number.isFinite(e[2]);case 2:n=n&&Number.isFinite(e[1]);case 1:n=n&&Number.isFinite(e[0]);break;default:n=!1}if(!n)throw new Error(`Illegal attribute generated for ${this.id}`)}}}function dk(t){const{source:e,target:r,start:n=0,size:i,getData:a}=t,s=t.end||r.length,o=e.length,c=s-n;if(o>c){r.set(e.subarray(0,c),n);return}if(r.set(e,n),!a)return;let f=o;for(;f<c;){const d=a(f,e);for(let m=0;m<i;m++)r[n+f]=d[m]||0,f++}}function aGe({source:t,target:e,size:r,getData:n,sourceStartIndices:i,targetStartIndices:a}){if(!i||!a)return dk({source:t,target:e,size:r,getData:n}),e;let s=0,o=0;const c=n&&((d,m)=>n(d+o,m)),f=Math.min(i.length,a.length);for(let d=1;d<f;d++){const m=i[d]*r,b=a[d]*r;dk({source:t.subarray(s,m),target:e,start:o,end:b,size:r,getData:c}),s=m,o=b}return o<e.length&&dk({source:[],target:e,start:o,size:r,getData:c}),e}function oGe(t){const{device:e,settings:r,value:n}=t,i=new Dne(e,r);return i.setData({value:n instanceof Float64Array?new Float64Array(0):new Float32Array(0),normalized:r.normalized}),i}function One(t){switch(t){case 1:return"float";case 2:return"vec2";case 3:return"vec3";case 4:return"vec4";default:throw new Error(`No defined attribute type for size "${t}"`)}}function Nne(t){switch(t){case 1:return"float32";case 2:return"float32x2";case 3:return"float32x3";case 4:return"float32x4";default:throw new Error("invalid type size")}}function Lne(t){t.push(t.shift())}function sGe(t,e){const{doublePrecision:r,settings:n,value:i,size:a}=t,s=r&&i instanceof Float64Array?2:1;let o=0;const{shaderAttributes:c}=t.settings;if(c)for(const f of Object.values(c))o=Math.max(o,f.vertexOffset??0);return(n.noAlloc?i.length:(e+o)*a)*s}function Fne({device:t,source:e,target:r}){return(!r||r.byteLength<e.byteLength)&&(r?.destroy(),r=t.createBuffer({byteLength:e.byteLength,usage:e.usage})),r}function Bne({device:t,buffer:e,attribute:r,fromLength:n,toLength:i,fromStartIndices:a,getData:s=o=>o}){const o=r.doublePrecision&&r.value instanceof Float64Array?2:1,c=r.size*o,f=r.byteOffset,d=r.settings.bytesPerElement<4?f/r.settings.bytesPerElement*4:f,m=r.startIndices,b=a&&m,x=r.isConstant;if(!b&&e&&n>=i)return e;const E=r.value instanceof Float64Array?Float32Array:r.value.constructor,T=x?r.value:new E(r.getBuffer().readSyncWebGL(f,i*E.BYTES_PER_ELEMENT).buffer);if(r.settings.normalized&&!x){const N=s;s=(O,U)=>r.normalizeConstant(N(O,U))}const A=x?(N,O)=>s(T,O):(N,O)=>s(T.subarray(N+f,N+f+c),O),M=e?new Float32Array(e.readSyncWebGL(d,n*4).buffer):new Float32Array(0),F=new Float32Array(i);return aGe({source:M,target:F,sourceStartIndices:a,targetStartIndices:m,size:c,getData:A}),(!e||e.byteLength<F.byteLength+d)&&(e?.destroy(),e=t.createBuffer({byteLength:F.byteLength+d,usage:35050})),e.write(F,d),e}class zne{constructor({device:e,attribute:r,timeline:n}){this.buffers=[],this.currentLength=0,this.device=e,this.transition=new eC(n),this.attribute=r,this.attributeInTransition=oGe(r),this.currentStartIndices=r.startIndices}get inProgress(){return this.transition.inProgress}start(e,r,n=1/0){this.settings=e,this.currentStartIndices=this.attribute.startIndices,this.currentLength=sGe(this.attribute,r),this.transition.start({...e,duration:n})}update(){const e=this.transition.update();return e&&this.onUpdate(),e}setBuffer(e){this.attributeInTransition.setData({buffer:e,normalized:this.attribute.settings.normalized,value:this.attributeInTransition.value})}cancel(){this.transition.cancel()}delete(){this.cancel();for(const e of this.buffers)e.destroy();this.buffers.length=0}}class lGe extends zne{constructor({device:e,attribute:r,timeline:n}){super({device:e,attribute:r,timeline:n}),this.type="interpolation",this.transform=hGe(e,r)}start(e,r){const n=this.currentLength,i=this.currentStartIndices;if(super.start(e,r,e.duration),e.duration<=0){this.transition.cancel();return}const{buffers:a,attribute:s}=this;Lne(a),a[0]=Bne({device:this.device,buffer:a[0],attribute:s,fromLength:n,toLength:this.currentLength,fromStartIndices:i,getData:e.enter}),a[1]=Fne({device:this.device,source:a[0],target:a[1]}),this.setBuffer(a[1]);const{transform:o}=this,c=o.model;let f=Math.floor(this.currentLength/s.size);jne(s)&&(f/=2),c.setVertexCount(f),s.isConstant?(c.setAttributes({aFrom:a[0]}),c.setConstantAttributes({aTo:s.value})):c.setAttributes({aFrom:a[0],aTo:s.getBuffer()}),o.transformFeedback.setBuffers({vCurrent:a[1]})}onUpdate(){const{duration:e,easing:r}=this.settings,{time:n}=this.transition;let i=n/e;r&&(i=r(i));const{model:a}=this.transform,s={time:i};a.shaderInputs.setProps({interpolation:s}),this.transform.run({discard:!0})}delete(){super.delete(),this.transform.destroy()}}const uGe=`uniform interpolationUniforms {
  float time;
} interpolation;
`,LW={name:"interpolation",vs:uGe,uniformTypes:{time:"f32"}},cGe=`#version 300 es
#define SHADER_NAME interpolation-transition-vertex-shader

in ATTRIBUTE_TYPE aFrom;
in ATTRIBUTE_TYPE aTo;
out ATTRIBUTE_TYPE vCurrent;

void main(void) {
  vCurrent = mix(aFrom, aTo, interpolation.time);
  gl_Position = vec4(0.0);
}
`,fGe=`#version 300 es
#define SHADER_NAME interpolation-transition-vertex-shader

in ATTRIBUTE_TYPE aFrom;
in ATTRIBUTE_TYPE aFrom64Low;
in ATTRIBUTE_TYPE aTo;
in ATTRIBUTE_TYPE aTo64Low;
out ATTRIBUTE_TYPE vCurrent;
out ATTRIBUTE_TYPE vCurrent64Low;

vec2 mix_fp64(vec2 a, vec2 b, float x) {
  vec2 range = sub_fp64(b, a);
  return sum_fp64(a, mul_fp64(range, vec2(x, 0.0)));
}

void main(void) {
  for (int i=0; i<ATTRIBUTE_SIZE; i++) {
    vec2 value = mix_fp64(vec2(aFrom[i], aFrom64Low[i]), vec2(aTo[i], aTo64Low[i]), interpolation.time);
    vCurrent[i] = value.x;
    vCurrent64Low[i] = value.y;
  }
  gl_Position = vec4(0.0);
}
`;function jne(t){return t.doublePrecision&&t.value instanceof Float64Array}function hGe(t,e){const r=e.size,n=One(r),i=Nne(r),a=e.getBufferLayout();return jne(e)?new l_(t,{vs:fGe,bufferLayout:[{name:"aFrom",byteStride:8*r,attributes:[{attribute:"aFrom",format:i,byteOffset:0},{attribute:"aFrom64Low",format:i,byteOffset:4*r}]},{name:"aTo",byteStride:8*r,attributes:[{attribute:"aTo",format:i,byteOffset:0},{attribute:"aTo64Low",format:i,byteOffset:4*r}]}],modules:[Ije,LW],defines:{ATTRIBUTE_TYPE:n,ATTRIBUTE_SIZE:r},moduleSettings:{},varyings:["vCurrent","vCurrent64Low"],bufferMode:35980,disableWarnings:!0}):new l_(t,{vs:cGe,bufferLayout:[{name:"aFrom",format:i},{name:"aTo",format:a.attributes[0].format}],modules:[LW],defines:{ATTRIBUTE_TYPE:n},varyings:["vCurrent"],disableWarnings:!0})}class dGe extends zne{constructor({device:e,attribute:r,timeline:n}){super({device:e,attribute:r,timeline:n}),this.type="spring",this.texture=_Ge(e),this.framebuffer=bGe(e,this.texture),this.transform=vGe(e,r)}start(e,r){const n=this.currentLength,i=this.currentStartIndices;super.start(e,r);const{buffers:a,attribute:s}=this;for(let c=0;c<2;c++)a[c]=Bne({device:this.device,buffer:a[c],attribute:s,fromLength:n,toLength:this.currentLength,fromStartIndices:i,getData:e.enter});a[2]=Fne({device:this.device,source:a[0],target:a[2]}),this.setBuffer(a[1]);const{model:o}=this.transform;o.setVertexCount(Math.floor(this.currentLength/s.size)),s.isConstant?o.setConstantAttributes({aTo:s.value}):o.setAttributes({aTo:s.getBuffer()})}onUpdate(){const{buffers:e,transform:r,framebuffer:n,transition:i}=this,a=this.settings;r.model.setAttributes({aPrev:e[0],aCur:e[1]}),r.transformFeedback.setBuffers({vNext:e[2]});const s={stiffness:a.stiffness,damping:a.damping};r.model.shaderInputs.setProps({spring:s}),r.run({framebuffer:n,discard:!1,parameters:{viewport:[0,0,1,1]},clearColor:[0,0,0,0]}),Lne(e),this.setBuffer(e[1]),this.device.readPixelsToArrayWebGL(n)[0]>0||i.end()}delete(){super.delete(),this.transform.destroy(),this.texture.destroy(),this.framebuffer.destroy()}}const pGe=`uniform springUniforms {
  float damping;
  float stiffness;
} spring;
`,gGe={name:"spring",vs:pGe,uniformTypes:{damping:"f32",stiffness:"f32"}},mGe=`#version 300 es
#define SHADER_NAME spring-transition-vertex-shader

#define EPSILON 0.00001

in ATTRIBUTE_TYPE aPrev;
in ATTRIBUTE_TYPE aCur;
in ATTRIBUTE_TYPE aTo;
out ATTRIBUTE_TYPE vNext;
out float vIsTransitioningFlag;

ATTRIBUTE_TYPE getNextValue(ATTRIBUTE_TYPE cur, ATTRIBUTE_TYPE prev, ATTRIBUTE_TYPE dest) {
  ATTRIBUTE_TYPE velocity = cur - prev;
  ATTRIBUTE_TYPE delta = dest - cur;
  ATTRIBUTE_TYPE force = delta * spring.stiffness;
  ATTRIBUTE_TYPE resistance = velocity * spring.damping;
  return force - resistance + velocity + cur;
}

void main(void) {
  bool isTransitioning = length(aCur - aPrev) > EPSILON || length(aTo - aCur) > EPSILON;
  vIsTransitioningFlag = isTransitioning ? 1.0 : 0.0;

  vNext = getNextValue(aCur, aPrev, aTo);
  gl_Position = vec4(0, 0, 0, 1);
  gl_PointSize = 100.0;
}
`,yGe=`#version 300 es
#define SHADER_NAME spring-transition-is-transitioning-fragment-shader

in float vIsTransitioningFlag;

out vec4 fragColor;

void main(void) {
  if (vIsTransitioningFlag == 0.0) {
    discard;
  }
  fragColor = vec4(1.0);
}`;function vGe(t,e){const r=One(e.size),n=Nne(e.size);return new l_(t,{vs:mGe,fs:yGe,bufferLayout:[{name:"aPrev",format:n},{name:"aCur",format:n},{name:"aTo",format:e.getBufferLayout().attributes[0].format}],varyings:["vNext"],modules:[gGe],defines:{ATTRIBUTE_TYPE:r},parameters:{depthCompare:"always",blendColorOperation:"max",blendColorSrcFactor:"one",blendColorDstFactor:"one",blendAlphaOperation:"max",blendAlphaSrcFactor:"one",blendAlphaDstFactor:"one"}})}function _Ge(t){return t.createTexture({data:new Uint8Array(4),format:"rgba8unorm",width:1,height:1})}function bGe(t,e){return t.createFramebuffer({id:"spring-transition-is-transitioning-framebuffer",width:1,height:1,colorAttachments:[e]})}const xGe={interpolation:lGe,spring:dGe};class wGe{constructor(e,{id:r,timeline:n}){if(!e)throw new Error("AttributeTransitionManager is constructed without device");this.id=r,this.device=e,this.timeline=n,this.transitions={},this.needsRedraw=!1,this.numInstances=1}finalize(){for(const e in this.transitions)this._removeTransition(e)}update({attributes:e,transitions:r,numInstances:n}){this.numInstances=n||1;for(const i in e){const a=e[i],s=a.getTransitionSetting(r);s&&this._updateAttribute(i,a,s)}for(const i in this.transitions){const a=e[i];(!a||!a.getTransitionSetting(r))&&this._removeTransition(i)}}hasAttribute(e){const r=this.transitions[e];return r&&r.inProgress}getAttributes(){const e={};for(const r in this.transitions){const n=this.transitions[r];n.inProgress&&(e[r]=n.attributeInTransition)}return e}run(){if(this.numInstances===0)return!1;for(const r in this.transitions)this.transitions[r].update()&&(this.needsRedraw=!0);const e=this.needsRedraw;return this.needsRedraw=!1,e}_removeTransition(e){this.transitions[e].delete(),delete this.transitions[e]}_updateAttribute(e,r,n){const i=this.transitions[e];let a=!i||i.type!==n.type;if(a){i&&this._removeTransition(e);const s=xGe[n.type];s?this.transitions[e]=new s({attribute:r,timeline:this.timeline,device:this.device}):(po.error(`unsupported transition type '${n.type}'`)(),a=!1)}(a||r.needsRedraw())&&(this.needsRedraw=!0,this.transitions[e].start(n,this.numInstances))}}const FW="attributeManager.invalidate",SGe="attributeManager.updateStart",EGe="attributeManager.updateEnd",TGe="attribute.updateStart",CGe="attribute.allocate",AGe="attribute.updateEnd";class IGe{constructor(e,{id:r="attribute-manager",stats:n,timeline:i}={}){this.mergeBoundsMemoized=s2(VVe),this.id=r,this.device=e,this.attributes={},this.updateTriggers={},this.needsRedraw=!0,this.userData={},this.stats=n,this.attributeTransitionManager=new wGe(e,{id:`${r}-transitions`,timeline:i}),Object.seal(this)}finalize(){for(const e in this.attributes)this.attributes[e].delete();this.attributeTransitionManager.finalize()}getNeedsRedraw(e={clearRedrawFlags:!1}){const r=this.needsRedraw;return this.needsRedraw=this.needsRedraw&&!e.clearRedrawFlags,r&&this.id}setNeedsRedraw(){this.needsRedraw=!0}add(e){this._add(e)}addInstanced(e){this._add(e,{stepMode:"instance"})}remove(e){for(const r of e)this.attributes[r]!==void 0&&(this.attributes[r].delete(),delete this.attributes[r])}invalidate(e,r){const n=this._invalidateTrigger(e,r);yc(FW,this,e,n)}invalidateAll(e){for(const r in this.attributes)this.attributes[r].setNeedsUpdate(r,e);yc(FW,this,"all")}update({data:e,numInstances:r,startIndices:n=null,transitions:i,props:a={},buffers:s={},context:o={}}){let c=!1;yc(SGe,this),this.stats&&this.stats.get("Update Attributes").timeStart();for(const f in this.attributes){const d=this.attributes[f],m=d.settings.accessor;d.startIndices=n,d.numInstances=r,a[f]&&po.removed(`props.${f}`,`data.attributes.${f}`)(),d.setExternalBuffer(s[f])||d.setBinaryValue(typeof m=="string"?s[m]:void 0,e.startIndices)||typeof m=="string"&&!s[m]&&d.setConstantValue(o,a[m])||d.needsUpdate()&&(c=!0,this._updateAttribute({attribute:d,numInstances:r,data:e,props:a,context:o})),this.needsRedraw=this.needsRedraw||d.needsRedraw()}c&&yc(EGe,this,r),this.stats&&this.stats.get("Update Attributes").timeEnd(),this.attributeTransitionManager.update({attributes:this.attributes,numInstances:r,transitions:i})}updateTransition(){const{attributeTransitionManager:e}=this,r=e.run();return this.needsRedraw=this.needsRedraw||r,r}getAttributes(){return{...this.attributes,...this.attributeTransitionManager.getAttributes()}}getBounds(e){const r=e.map(n=>this.attributes[n]?.getBounds());return this.mergeBoundsMemoized(r)}getChangedAttributes(e={clearChangedFlags:!1}){const{attributes:r,attributeTransitionManager:n}=this,i={...n.getAttributes()};for(const a in r){const s=r[a];s.needsRedraw(e)&&!n.hasAttribute(a)&&(i[a]=s)}return i}getBufferLayouts(e){return Object.values(this.getAttributes()).map(r=>r.getBufferLayout(e))}_add(e,r){for(const n in e){const i=e[n],a={...i,id:n,size:i.isIndexed&&1||i.size||1,...r};this.attributes[n]=new Dne(this.device,a)}this._mapUpdateTriggersToAttributes()}_mapUpdateTriggersToAttributes(){const e={};for(const r in this.attributes)this.attributes[r].getUpdateTriggers().forEach(i=>{e[i]||(e[i]=[]),e[i].push(r)});this.updateTriggers=e}_invalidateTrigger(e,r){const{attributes:n,updateTriggers:i}=this,a=i[e];return a&&a.forEach(s=>{const o=n[s];o&&o.setNeedsUpdate(o.id,r)}),a}_updateAttribute(e){const{attribute:r,numInstances:n}=e;if(yc(TGe,r),r.constant){r.setConstantValue(e.context,r.value);return}r.allocate(n)&&yc(CGe,r,n),r.updateBuffer(e)&&(this.needsRedraw=!0,yc(AGe,r,n))}}class PGe extends eC{get value(){return this._value}_onUpdate(){const{time:e,settings:{fromValue:r,toValue:n,duration:i,easing:a}}=this,s=a(e/i);this._value=_T(r,n,s)}}const BW=1e-5;function zW(t,e,r,n,i){const a=e-t,o=(r-e)*i,c=-a*n;return o+c+a+e}function kGe(t,e,r,n,i){if(Array.isArray(r)){const a=[];for(let s=0;s<r.length;s++)a[s]=zW(t[s],e[s],r[s],n,i);return a}return zW(t,e,r,n,i)}function jW(t,e){if(Array.isArray(t)){let r=0;for(let n=0;n<t.length;n++){const i=t[n]-e[n];r+=i*i}return Math.sqrt(r)}return Math.abs(t-e)}class RGe extends eC{get value(){return this._currValue}_onUpdate(){const{fromValue:e,toValue:r,damping:n,stiffness:i}=this.settings,{_prevValue:a=e,_currValue:s=e}=this;let o=kGe(a,s,r,n,i);const c=jW(o,r),f=jW(o,s);c<BW&&f<BW&&(o=r,this.end()),this._prevValue=s,this._currValue=o}}const MGe={interpolation:PGe,spring:RGe};class DGe{constructor(e){this.transitions=new Map,this.timeline=e}get active(){return this.transitions.size>0}add(e,r,n,i){const{transitions:a}=this;if(a.has(e)){const c=a.get(e),{value:f=c.settings.fromValue}=c;r=f,this.remove(e)}if(i=Mne(i),!i)return;const s=MGe[i.type];if(!s){po.error(`unsupported transition type '${i.type}'`)();return}const o=new s(this.timeline);o.start({...i,fromValue:r,toValue:n}),a.set(e,o)}remove(e){const{transitions:r}=this;r.has(e)&&(r.get(e).cancel(),r.delete(e))}update(){const e={};for(const[r,n]of this.transitions)n.update(),e[r]=n.value,n.inProgress||this.remove(r);return e}clear(){for(const e of this.transitions.keys())this.remove(e)}}function OGe(t){const e=t[Gm];for(const r in e){const n=e[r],{validate:i}=n;if(i&&!i(t[r],n))throw new Error(`Invalid prop ${r}: ${t[r]}`)}}function NGe(t,e){const r=Une({newProps:t,oldProps:e,propTypes:t[Gm],ignoreProps:{data:null,updateTriggers:null,extensions:null,transitions:null}}),n=FGe(t,e);let i=!1;return n||(i=BGe(t,e)),{dataChanged:n,propsChanged:r,updateTriggersChanged:i,extensionsChanged:zGe(t,e),transitionsChanged:LGe(t,e)}}function LGe(t,e){if(!t.transitions)return!1;const r={},n=t[Gm];let i=!1;for(const a in t.transitions){const s=n[a],o=s&&s.type;(o==="number"||o==="color"||o==="array")&&SD(t[a],e[a],s)&&(r[a]=!0,i=!0)}return i?r:!1}function Une({newProps:t,oldProps:e,ignoreProps:r={},propTypes:n={},triggerName:i="props"}){if(e===t)return!1;if(typeof t!="object"||t===null)return`${i} changed shallowly`;if(typeof e!="object"||e===null)return`${i} changed shallowly`;for(const a of Object.keys(t))if(!(a in r)){if(!(a in e))return`${i}.${a} added`;const s=SD(t[a],e[a],n[a]);if(s)return`${i}.${a} ${s}`}for(const a of Object.keys(e))if(!(a in r)){if(!(a in t))return`${i}.${a} dropped`;if(!Object.hasOwnProperty.call(t,a)){const s=SD(t[a],e[a],n[a]);if(s)return`${i}.${a} ${s}`}}return!1}function SD(t,e,r){let n=r&&r.equal;return n&&!n(t,e,r)||!n&&(n=t&&e&&t.equals,n&&!n.call(t,e))?"changed deeply":!n&&e!==t?"changed shallowly":null}function FGe(t,e){if(e===null)return"oldProps is null, initial diff";let r=!1;const{dataComparator:n,_dataDiff:i}=t;return n?n(t.data,e.data)||(r="Data comparator detected a change"):t.data!==e.data&&(r="A new data container was supplied"),r&&i&&(r=i(t.data,e.data)||r),r}function BGe(t,e){if(e===null)return{all:!0};if("all"in t.updateTriggers&&UW(t,e,"all"))return{all:!0};const r={};let n=!1;for(const i in t.updateTriggers)i!=="all"&&UW(t,e,i)&&(r[i]=!0,n=!0);return n?r:!1}function zGe(t,e){if(e===null)return!0;const r=e.extensions,{extensions:n}=t;if(n===r)return!1;if(!r||!n||n.length!==r.length)return!0;for(let i=0;i<n.length;i++)if(!n[i].equals(r[i]))return!0;return!1}function UW(t,e,r){let n=t.updateTriggers[r];n=n??{};let i=e.updateTriggers[r];return i=i??{},Une({oldProps:i,newProps:n,triggerName:r})}const jGe="count(): argument not an object",UGe="count(): argument not a container";function VGe(t){if(!qGe(t))throw new Error(jGe);if(typeof t.count=="function")return t.count();if(Number.isFinite(t.size))return t.size;if(Number.isFinite(t.length))return t.length;if($Ge(t))return Object.keys(t).length;throw new Error(UGe)}function $Ge(t){return t!==null&&typeof t=="object"&&t.constructor===Object}function qGe(t){return t!==null&&typeof t=="object"}function VW(t,e){if(!e)return t;const r={...t,...e};if("defines"in e&&(r.defines={...t.defines,...e.defines}),"modules"in e&&(r.modules=(t.modules||[]).concat(e.modules),e.modules.some(n=>n.name==="project64"))){const n=r.modules.findIndex(i=>i.name==="project32");n>=0&&r.modules.splice(n,1)}if("inject"in e)if(!t.inject)r.inject=e.inject;else{const n={...t.inject};for(const i in e.inject)n[i]=(n[i]||"")+e.inject[i];r.inject=n}return r}const HGe={minFilter:"linear",mipmapFilter:"linear",magFilter:"linear",addressModeU:"clamp-to-edge",addressModeV:"clamp-to-edge"},ED={};function GGe(t,e,r,n){if(r instanceof Fl)return r;r.constructor&&r.constructor.name!=="Object"&&(r={data:r});let i=null;r.compressed&&(i={minFilter:"linear",mipmapFilter:r.data.length>1?"nearest":"linear"});const{width:a,height:s}=r.data,o=e.createTexture({...r,sampler:{...HGe,...i,...n},mipLevels:e.getMipLevelCount(a,s)});return o.generateMipmapsWebGL(),ED[o.id]=t,o}function WGe(t,e){!e||!(e instanceof Fl)||ED[e.id]===t&&(e.delete(),delete ED[e.id])}const XGe={boolean:{validate(t,e){return!0},equal(t,e,r){return!!t==!!e}},number:{validate(t,e){return Number.isFinite(t)&&(!("max"in e)||t<=e.max)&&(!("min"in e)||t>=e.min)}},color:{validate(t,e){return e.optional&&!t||TD(t)&&(t.length===3||t.length===4)},equal(t,e,r){return Bf(t,e,1)}},accessor:{validate(t,e){const r=CT(t);return r==="function"||r===CT(e.value)},equal(t,e,r){return typeof e=="function"?!0:Bf(t,e,1)}},array:{validate(t,e){return e.optional&&!t||TD(t)},equal(t,e,r){const{compare:n}=r,i=Number.isInteger(n)?n:n?1:0;return n?Bf(t,e,i):t===e}},object:{equal(t,e,r){if(r.ignore)return!0;const{compare:n}=r,i=Number.isInteger(n)?n:n?1:0;return n?Bf(t,e,i):t===e}},function:{validate(t,e){return e.optional&&!t||typeof t=="function"},equal(t,e,r){return!r.compare&&r.ignore!==!1||t===e}},data:{transform:(t,e,r)=>{if(!t)return t;const{dataTransform:n}=r.props;return n?n(t):typeof t.shape=="string"&&t.shape.endsWith("-table")&&Array.isArray(t.data)?t.data:t}},image:{transform:(t,e,r)=>{const n=r.context;return!n||!n.device?null:GGe(r.id,n.device,t,{...e.parameters,...r.props.textureParameters})},release:(t,e,r)=>{WGe(r.id,t)}}};function YGe(t){const e={},r={},n={};for(const[i,a]of Object.entries(t)){const s=a?.deprecatedFor;if(s)n[i]=Array.isArray(s)?s:[s];else{const o=ZGe(i,a);e[i]=o,r[i]=o.value}}return{propTypes:e,defaultProps:r,deprecatedProps:n}}function ZGe(t,e){switch(CT(e)){case"object":return I1(t,e);case"array":return I1(t,{type:"array",value:e,compare:!1});case"boolean":return I1(t,{type:"boolean",value:e});case"number":return I1(t,{type:"number",value:e});case"function":return I1(t,{type:"function",value:e,compare:!0});default:return{name:t,type:"unknown",value:e}}}function I1(t,e){return"type"in e?{name:t,...XGe[e.type],...e}:"value"in e?{name:t,type:CT(e.value),...e}:{name:t,type:"object",value:e}}function TD(t){return Array.isArray(t)||ArrayBuffer.isView(t)}function CT(t){return TD(t)?"array":t===null?"null":typeof t}function KGe(t,e){let r;for(let a=e.length-1;a>=0;a--){const s=e[a];"extensions"in s&&(r=s.extensions)}const n=CD(t.constructor,r),i=Object.create(n);i[TT]=t,i[vy]={},i[yg]={};for(let a=0;a<e.length;++a){const s=e[a];for(const o in s)i[o]=s[o]}return Object.freeze(i),i}const JGe="_mergedDefaultProps";function CD(t,e){if(!(t instanceof tC.constructor))return{};let r=JGe;if(e)for(const i of e){const a=i.constructor;a&&(r+=`:${a.extensionName||a.name}`)}const n=Vne(t,r);return n||(t[r]=QGe(t,e||[]))}function QGe(t,e){if(!t.prototype)return null;const n=Object.getPrototypeOf(t),i=CD(n),a=Vne(t,"defaultProps")||{},s=YGe(a),o=Object.assign(Object.create(null),i,s.defaultProps),c=Object.assign(Object.create(null),i?.[Gm],s.propTypes),f=Object.assign(Object.create(null),i?.[ok],s.deprecatedProps);for(const d of e){const m=CD(d.constructor);m&&(Object.assign(o,m),Object.assign(c,m[Gm]),Object.assign(f,m[ok]))}return eWe(o,t),rWe(o,c),tWe(o,f),o[Gm]=c,o[ok]=f,e.length===0&&!C6(t,"_propTypes")&&(t._propTypes=c),o}function eWe(t,e){const r=iWe(e);Object.defineProperties(t,{id:{writable:!0,value:r}})}function tWe(t,e){for(const r in e)Object.defineProperty(t,r,{enumerable:!1,set(n){const i=`${this.id}: ${r}`;for(const a of e[r])C6(this,a)||(this[a]=n);po.deprecated(i,e[r].join("/"))()}})}function rWe(t,e){const r={},n={};for(const i in e){const a=e[i],{name:s,value:o}=a;a.async&&(r[s]=o,n[s]=nWe(s))}t[N0]=r,t[vy]={},Object.defineProperties(t,n)}function nWe(t){return{enumerable:!0,set(e){typeof e=="string"||e instanceof Promise||Rne(e)?this[vy][t]=e:this[yg][t]=e},get(){if(this[yg]){if(t in this[yg])return this[yg][t]||this[N0][t];if(t in this[vy]){const e=this[TT]&&this[TT].internalState;if(e&&e.hasAsyncProp(t))return e.getAsyncProp(t)||this[N0][t]}}return this[N0][t]}}}function C6(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function Vne(t,e){return C6(t,e)&&t[e]}function iWe(t){const e=t.componentName;return e||po.warn(`${t.name}.componentName not specified`)(),e||t.name}let aWe=0;class tC{constructor(...e){this.props=KGe(this,e),this.id=this.props.id,this.count=aWe++}clone(e){const{props:r}=this,n={};for(const i in r[N0])i in r[yg]?n[i]=r[yg][i]:i in r[vy]&&(n[i]=r[vy][i]);return new this.constructor({...r,...n,...e})}}tC.componentName="Component";tC.defaultProps={};const oWe=Object.freeze({});class sWe{constructor(e){this.component=e,this.asyncProps={},this.onAsyncPropUpdated=()=>{},this.oldProps=null,this.oldAsyncProps=null}finalize(){for(const e in this.asyncProps){const r=this.asyncProps[e];r&&r.type&&r.type.release&&r.type.release(r.resolvedValue,r.type,this.component)}this.asyncProps={},this.component=null,this.resetOldProps()}getOldProps(){return this.oldAsyncProps||this.oldProps||oWe}resetOldProps(){this.oldAsyncProps=null,this.oldProps=this.component?this.component.props:null}hasAsyncProp(e){return e in this.asyncProps}getAsyncProp(e){const r=this.asyncProps[e];return r&&r.resolvedValue}isAsyncPropLoading(e){if(e){const r=this.asyncProps[e];return!!(r&&r.pendingLoadCount>0&&r.pendingLoadCount!==r.resolvedLoadCount)}for(const r in this.asyncProps)if(this.isAsyncPropLoading(r))return!0;return!1}reloadAsyncProp(e,r){this._watchPromise(e,Promise.resolve(r))}setAsyncProps(e){this.component=e[TT]||this.component;const r=e[yg]||{},n=e[vy]||e,i=e[N0]||{};for(const a in r){const s=r[a];this._createAsyncPropData(a,i[a]),this._updateAsyncProp(a,s),r[a]=this.getAsyncProp(a)}for(const a in n){const s=n[a];this._createAsyncPropData(a,i[a]),this._updateAsyncProp(a,s)}}_fetch(e,r){return null}_onResolve(e,r){}_onError(e,r){}_updateAsyncProp(e,r){if(this._didAsyncInputValueChange(e,r)){if(typeof r=="string"&&(r=this._fetch(e,r)),r instanceof Promise){this._watchPromise(e,r);return}if(Rne(r)){this._resolveAsyncIterable(e,r);return}this._setPropValue(e,r)}}_freezeAsyncOldProps(){if(!this.oldAsyncProps&&this.oldProps){this.oldAsyncProps=Object.create(this.oldProps);for(const e in this.asyncProps)Object.defineProperty(this.oldAsyncProps,e,{enumerable:!0,value:this.oldProps[e]})}}_didAsyncInputValueChange(e,r){const n=this.asyncProps[e];return r===n.resolvedValue||r===n.lastValue?!1:(n.lastValue=r,!0)}_setPropValue(e,r){this._freezeAsyncOldProps();const n=this.asyncProps[e];n&&(r=this._postProcessValue(n,r),n.resolvedValue=r,n.pendingLoadCount++,n.resolvedLoadCount=n.pendingLoadCount)}_setAsyncPropValue(e,r,n){const i=this.asyncProps[e];i&&n>=i.resolvedLoadCount&&r!==void 0&&(this._freezeAsyncOldProps(),i.resolvedValue=r,i.resolvedLoadCount=n,this.onAsyncPropUpdated(e,r))}_watchPromise(e,r){const n=this.asyncProps[e];if(n){n.pendingLoadCount++;const i=n.pendingLoadCount;r.then(a=>{this.component&&(a=this._postProcessValue(n,a),this._setAsyncPropValue(e,a,i),this._onResolve(e,a))}).catch(a=>{this._onError(e,a)})}}async _resolveAsyncIterable(e,r){if(e!=="data"){this._setPropValue(e,r);return}const n=this.asyncProps[e];if(!n)return;n.pendingLoadCount++;const i=n.pendingLoadCount;let a=[],s=0;for await(const o of r){if(!this.component)return;const{dataTransform:c}=this.component.props;c?a=c(o,a):a=a.concat(o),Object.defineProperty(a,"__diff",{enumerable:!1,value:[{startRow:s,endRow:a.length}]}),s=a.length,this._setAsyncPropValue(e,a,i)}this._onResolve(e,a)}_postProcessValue(e,r){const n=e.type;return n&&this.component&&(n.release&&n.release(e.resolvedValue,n,this.component),n.transform)?n.transform(r,n,this.component):r}_createAsyncPropData(e,r){if(!this.asyncProps[e]){const i=this.component&&this.component.props[Gm];this.asyncProps[e]={type:i&&i[e],lastValue:null,resolvedValue:r,pendingLoadCount:0,resolvedLoadCount:0}}}}class lWe extends sWe{constructor({attributeManager:e,layer:r}){super(r),this.attributeManager=e,this.needsRedraw=!0,this.needsUpdate=!0,this.subLayers=null,this.usesPickingColorCache=!1}get layer(){return this.component}_fetch(e,r){const n=this.layer,i=n?.props.fetch;return i?i(r,{propName:e,layer:n}):super._fetch(e,r)}_onResolve(e,r){const n=this.layer;if(n){const i=n.props.onDataLoad;e==="data"&&i&&i(r,{propName:e,layer:n})}}_onError(e,r){const n=this.layer;n&&n.raiseError(r,`loading ${e} of ${this.layer}`)}}const uWe="layer.changeFlag",cWe="layer.initialize",fWe="layer.update",hWe="layer.finalize",dWe="layer.matched",$W=2**24-1,pWe=Object.freeze([]),gWe=s2(({oldViewport:t,viewport:e})=>t.equals(e));let gh=new Uint8ClampedArray(0);const mWe={data:{type:"data",value:pWe,async:!0},dataComparator:{type:"function",value:null,optional:!0},_dataDiff:{type:"function",value:t=>t&&t.__diff,optional:!0},dataTransform:{type:"function",value:null,optional:!0},onDataLoad:{type:"function",value:null,optional:!0},onError:{type:"function",value:null,optional:!0},fetch:{type:"function",value:(t,{propName:e,layer:r,loaders:n,loadOptions:i,signal:a})=>{const{resourceManager:s}=r.context;i=i||r.getLoadOptions(),n=n||r.props.loaders,a&&(i={...i,fetch:{...i?.fetch,signal:a}});let o=s.contains(t);return!o&&!i&&(s.add({resourceId:t,data:YM(t,n),persistent:!1}),o=!0),o?s.subscribe({resourceId:t,onChange:c=>r.internalState?.reloadAsyncProp(e,c),consumerId:r.id,requestId:e}):YM(t,n,i)}},updateTriggers:{},visible:!0,pickable:!1,opacity:{type:"number",min:0,max:1,value:1},operation:"draw",onHover:{type:"function",value:null,optional:!0},onClick:{type:"function",value:null,optional:!0},onDragStart:{type:"function",value:null,optional:!0},onDrag:{type:"function",value:null,optional:!0},onDragEnd:{type:"function",value:null,optional:!0},coordinateSystem:Xa.DEFAULT,coordinateOrigin:{type:"array",value:[0,0,0],compare:!0},modelMatrix:{type:"array",value:null,compare:!0,optional:!0},wrapLongitude:!1,positionFormat:"XYZ",colorFormat:"RGBA",parameters:{type:"object",value:{},optional:!0,compare:2},loadOptions:{type:"object",value:null,optional:!0,ignore:!0},transitions:null,extensions:[],loaders:{type:"array",value:[],optional:!0,ignore:!0},getPolygonOffset:{type:"function",value:({layerIndex:t})=>[0,-t*100]},highlightedObjectIndex:null,autoHighlight:!1,highlightColor:{type:"accessor",value:[0,0,128,128]}};class $ne extends tC{constructor(){super(...arguments),this.internalState=null,this.lifecycle=i0.NO_STATE,this.parent=null}static get componentName(){return Object.prototype.hasOwnProperty.call(this,"layerName")?this.layerName:""}get root(){let e=this;for(;e.parent;)e=e.parent;return e}toString(){return`${this.constructor.layerName||this.constructor.name}({id: '${this.props.id}'})`}project(e){El(this.internalState);const r=this.internalState.viewport||this.context.viewport,n=cne(e,{viewport:r,modelMatrix:this.props.modelMatrix,coordinateOrigin:this.props.coordinateOrigin,coordinateSystem:this.props.coordinateSystem}),[i,a,s]=one(n,r.pixelProjectionMatrix);return e.length===2?[i,a]:[i,a,s]}unproject(e){return El(this.internalState),(this.internalState.viewport||this.context.viewport).unproject(e)}projectPosition(e,r){El(this.internalState);const n=this.internalState.viewport||this.context.viewport;return XVe(e,{viewport:n,modelMatrix:this.props.modelMatrix,coordinateOrigin:this.props.coordinateOrigin,coordinateSystem:this.props.coordinateSystem,...r})}get isComposite(){return!1}get isDrawable(){return!0}setState(e){this.setChangeFlags({stateChanged:!0}),Object.assign(this.state,e),this.setNeedsRedraw()}setNeedsRedraw(){this.internalState&&(this.internalState.needsRedraw=!0)}setNeedsUpdate(){this.internalState&&(this.context.layerManager.setNeedsUpdate(String(this)),this.internalState.needsUpdate=!0)}get isLoaded(){return this.internalState?!this.internalState.isAsyncPropLoading():!1}get wrapLongitude(){return this.props.wrapLongitude}isPickable(){return this.props.pickable&&this.props.visible}getModels(){const e=this.state;return e&&(e.models||e.model&&[e.model])||[]}setShaderModuleProps(...e){for(const r of this.getModels())r.shaderInputs.setProps(...e)}getAttributeManager(){return this.internalState&&this.internalState.attributeManager}getCurrentLayer(){return this.internalState&&this.internalState.layer}getLoadOptions(){return this.props.loadOptions}use64bitPositions(){const{coordinateSystem:e}=this.props;return e===Xa.DEFAULT||e===Xa.LNGLAT||e===Xa.CARTESIAN}onHover(e,r){return this.props.onHover&&this.props.onHover(e,r)||!1}onClick(e,r){return this.props.onClick&&this.props.onClick(e,r)||!1}nullPickingColor(){return[0,0,0]}encodePickingColor(e,r=[]){return r[0]=e+1&255,r[1]=e+1>>8&255,r[2]=e+1>>8>>8&255,r}decodePickingColor(e){El(e instanceof Uint8Array);const[r,n,i]=e;return r+n*256+i*65536-1}getNumInstances(){return Number.isFinite(this.props.numInstances)?this.props.numInstances:this.state&&this.state.numInstances!==void 0?this.state.numInstances:VGe(this.props.data)}getStartIndices(){return this.props.startIndices?this.props.startIndices:this.state&&this.state.startIndices?this.state.startIndices:null}getBounds(){return this.getAttributeManager()?.getBounds(["positions","instancePositions"])}getShaders(e){e=VW(e,{disableWarnings:!0,modules:this.context.defaultShaderModules});for(const r of this.props.extensions)e=VW(e,r.getShaders.call(this,r));return e}shouldUpdateState(e){return e.changeFlags.propsOrDataChanged}updateState(e){const r=this.getAttributeManager(),{dataChanged:n}=e.changeFlags;if(n&&r)if(Array.isArray(n))for(const i of n)r.invalidateAll(i);else r.invalidateAll();if(r){const{props:i}=e,a=this.internalState.hasPickingBuffer,s=Number.isInteger(i.highlightedObjectIndex)||i.pickable||i.extensions.some(o=>o.getNeedsPickingBuffer.call(this,o));if(a!==s){this.internalState.hasPickingBuffer=s;const{pickingColors:o,instancePickingColors:c}=r.attributes,f=o||c;f&&(s&&f.constant&&(f.constant=!1,r.invalidate(f.id)),!f.value&&!s&&(f.constant=!0,f.value=[0,0,0]))}}}finalizeState(e){for(const n of this.getModels())n.destroy();const r=this.getAttributeManager();r&&r.finalize(),this.context&&this.context.resourceManager.unsubscribe({consumerId:this.id}),this.internalState&&(this.internalState.uniformTransitions.clear(),this.internalState.finalize())}draw(e){for(const r of this.getModels())r.draw(e.renderPass)}getPickingInfo({info:e,mode:r,sourceLayer:n}){const{index:i}=e;return i>=0&&Array.isArray(this.props.data)&&(e.object=this.props.data[i]),e}raiseError(e,r){r&&(e=new Error(`${r}: ${e.message}`,{cause:e})),this.props.onError?.(e)||this.context?.onError?.(e,this)}getNeedsRedraw(e={clearRedrawFlags:!1}){return this._getNeedsRedraw(e)}needsUpdate(){return this.internalState?this.internalState.needsUpdate||this.hasUniformTransition()||this.shouldUpdateState(this._getUpdateParams()):!1}hasUniformTransition(){return this.internalState?.uniformTransitions.active||!1}activateViewport(e){if(!this.internalState)return;const r=this.internalState.viewport;this.internalState.viewport=e,(!r||!gWe({oldViewport:r,viewport:e}))&&(this.setChangeFlags({viewportChanged:!0}),this.isComposite?this.needsUpdate()&&this.setNeedsUpdate():this._update())}invalidateAttribute(e="all"){const r=this.getAttributeManager();r&&(e==="all"?r.invalidateAll():r.invalidate(e))}updateAttributes(e){let r=!1;for(const n in e)e[n].layoutChanged()&&(r=!0);for(const n of this.getModels())this._setModelAttributes(n,e,r)}_updateAttributes(){const e=this.getAttributeManager();if(!e)return;const r=this.props,n=this.getNumInstances(),i=this.getStartIndices();e.update({data:r.data,numInstances:n,startIndices:i,props:r,transitions:r.transitions,buffers:r.data.attributes,context:this});const a=e.getChangedAttributes({clearChangedFlags:!0});this.updateAttributes(a)}_updateAttributeTransition(){const e=this.getAttributeManager();e&&e.updateTransition()}_updateUniformTransition(){const{uniformTransitions:e}=this.internalState;if(e.active){const r=e.update(),n=Object.create(this.props);for(const i in r)Object.defineProperty(n,i,{value:r[i]});return n}return this.props}calculateInstancePickingColors(e,{numInstances:r}){if(e.constant)return;const n=Math.floor(gh.length/4);if(this.internalState.usesPickingColorCache=!0,n<r){r>$W&&po.warn("Layer has too many data objects. Picking might not be able to distinguish all objects.")(),gh=yx.allocate(gh,r,{size:4,copy:!0,maxCount:Math.max(r,$W)});const i=Math.floor(gh.length/4),a=[0,0,0];for(let s=n;s<i;s++)this.encodePickingColor(s,a),gh[s*4+0]=a[0],gh[s*4+1]=a[1],gh[s*4+2]=a[2],gh[s*4+3]=0}e.value=gh.subarray(0,r*4)}_setModelAttributes(e,r,n=!1){if(!Object.keys(r).length)return;if(n){const o=this.getAttributeManager();e.setBufferLayout(o.getBufferLayouts(e)),r=o.getAttributes()}const i=e.userData?.excludeAttributes||{},a={},s={};for(const o in r){if(i[o])continue;const c=r[o].getValue();for(const f in c){const d=c[f];d instanceof jo?r[o].settings.isIndexed?e.setIndexBuffer(d):a[f]=d:d&&(s[f]=d)}}e.setAttributes(a),e.setConstantAttributes(s)}disablePickingIndex(e){const r=this.props.data;if(!("attributes"in r)){this._disablePickingIndex(e);return}const{pickingColors:n,instancePickingColors:i}=this.getAttributeManager().attributes,a=n||i,s=a&&r.attributes&&r.attributes[a.id];if(s&&s.value){const o=s.value,c=this.encodePickingColor(e);for(let f=0;f<r.length;f++){const d=a.getVertexOffset(f);o[d]===c[0]&&o[d+1]===c[1]&&o[d+2]===c[2]&&this._disablePickingIndex(f)}}else this._disablePickingIndex(e)}_disablePickingIndex(e){const{pickingColors:r,instancePickingColors:n}=this.getAttributeManager().attributes,i=r||n;if(!i)return;const a=i.getVertexOffset(e),s=i.getVertexOffset(e+1);i.buffer.write(new Uint8Array(s-a),a)}restorePickingColors(){const{pickingColors:e,instancePickingColors:r}=this.getAttributeManager().attributes,n=e||r;n&&(this.internalState.usesPickingColorCache&&n.value.buffer!==gh.buffer&&(n.value=gh.subarray(0,n.value.length)),n.updateSubBuffer({startOffset:0}))}_initialize(){El(!this.internalState),El(Number.isFinite(this.props.coordinateSystem)),yc(cWe,this);const e=this._getAttributeManager();e&&e.addInstanced({instancePickingColors:{type:"uint8",size:4,noAlloc:!0,update:this.calculateInstancePickingColors}}),this.internalState=new lWe({attributeManager:e,layer:this}),this._clearChangeFlags(),this.state={},Object.defineProperty(this.state,"attributeManager",{get:()=>(po.deprecated("layer.state.attributeManager","layer.getAttributeManager()")(),e)}),this.internalState.uniformTransitions=new DGe(this.context.timeline),this.internalState.onAsyncPropUpdated=this._onAsyncPropUpdated.bind(this),this.internalState.setAsyncProps(this.props),this.initializeState(this.context);for(const r of this.props.extensions)r.initializeState.call(this,this.context,r);this.setChangeFlags({dataChanged:"init",propsChanged:"init",viewportChanged:!0,extensionsChanged:!0}),this._update()}_transferState(e){yc(dWe,this,this===e);const{state:r,internalState:n}=e;this!==e&&(this.internalState=n,this.state=r,this.internalState.setAsyncProps(this.props),this._diffProps(this.props,this.internalState.getOldProps()))}_update(){const e=this.needsUpdate();if(yc(fWe,this,e),!e)return;const r=this.props,n=this.context,i=this.internalState,a=n.viewport,s=this._updateUniformTransition();i.propsInTransition=s,n.viewport=i.viewport||a,this.props=s;try{const o=this._getUpdateParams(),c=this.getModels();if(n.device)this.updateState(o);else try{this.updateState(o)}catch{}for(const d of this.props.extensions)d.updateState.call(this,o,d);this.setNeedsRedraw(),this._updateAttributes();const f=this.getModels()[0]!==c[0];this._postUpdate(o,f)}finally{n.viewport=a,this.props=r,this._clearChangeFlags(),i.needsUpdate=!1,i.resetOldProps()}}_finalize(){yc(hWe,this),this.finalizeState(this.context);for(const e of this.props.extensions)e.finalizeState.call(this,this.context,e)}_drawLayer({renderPass:e,shaderModuleProps:r=null,uniforms:n={},parameters:i={}}){this._updateAttributeTransition();const a=this.props,s=this.context;this.props=this.internalState.propsInTransition||a;try{r&&this.setShaderModuleProps(r);const{getPolygonOffset:o}=this.props,c=o&&o(n)||[0,0];s.device instanceof xD&&s.device.setParametersWebGL({polygonOffset:c});for(const f of this.getModels())f.device.type==="webgpu"?f.setParameters({...f.parameters,...i}):f.setParameters(i);if(s.device instanceof xD)s.device.withParametersWebGL(i,()=>{const f={renderPass:e,shaderModuleProps:r,uniforms:n,parameters:i,context:s};for(const d of this.props.extensions)d.draw.call(this,f,d);this.draw(f)});else{const f={renderPass:e,shaderModuleProps:r,uniforms:n,parameters:i,context:s};for(const d of this.props.extensions)d.draw.call(this,f,d);this.draw(f)}}finally{this.props=a}}getChangeFlags(){return this.internalState?.changeFlags}setChangeFlags(e){if(!this.internalState)return;const{changeFlags:r}=this.internalState;for(const i in e)if(e[i]){let a=!1;switch(i){case"dataChanged":const s=e[i],o=r[i];s&&Array.isArray(o)&&(r.dataChanged=Array.isArray(s)?o.concat(s):s,a=!0);default:r[i]||(r[i]=e[i],a=!0)}a&&yc(uWe,this,i,e)}const n=!!(r.dataChanged||r.updateTriggersChanged||r.propsChanged||r.extensionsChanged);r.propsOrDataChanged=n,r.somethingChanged=n||r.viewportChanged||r.stateChanged}_clearChangeFlags(){this.internalState.changeFlags={dataChanged:!1,propsChanged:!1,updateTriggersChanged:!1,viewportChanged:!1,stateChanged:!1,extensionsChanged:!1,propsOrDataChanged:!1,somethingChanged:!1}}_diffProps(e,r){const n=NGe(e,r);if(n.updateTriggersChanged)for(const i in n.updateTriggersChanged)n.updateTriggersChanged[i]&&this.invalidateAttribute(i);if(n.transitionsChanged)for(const i in n.transitionsChanged)this.internalState.uniformTransitions.add(i,r[i],e[i],e.transitions?.[i]);return this.setChangeFlags(n)}validateProps(){OGe(this.props)}updateAutoHighlight(e){this.props.autoHighlight&&!Number.isInteger(this.props.highlightedObjectIndex)&&this._updateAutoHighlight(e)}_updateAutoHighlight(e){const r={highlightedObjectColor:e.picked?e.color:null},{highlightColor:n}=this.props;e.picked&&typeof n=="function"&&(r.highlightColor=n(e)),this.setShaderModuleProps({picking:r}),this.setNeedsRedraw()}_getAttributeManager(){const e=this.context;return new IGe(e.device,{id:this.props.id,stats:e.stats,timeline:e.timeline})}_postUpdate(e,r){const{props:n,oldProps:i}=e,a=this.state.model;a?.isInstanced&&a.setInstanceCount(this.getNumInstances());const{autoHighlight:s,highlightedObjectIndex:o,highlightColor:c}=n;if(r||i.autoHighlight!==s||i.highlightedObjectIndex!==o||i.highlightColor!==c){const f={};Array.isArray(c)&&(f.highlightColor=c),(r||i.autoHighlight!==s||o!==i.highlightedObjectIndex)&&(f.highlightedObjectColor=Number.isFinite(o)&&o>=0?this.encodePickingColor(o):null),this.setShaderModuleProps({picking:f})}}_getUpdateParams(){return{props:this.props,oldProps:this.internalState.getOldProps(),context:this.context,changeFlags:this.internalState.changeFlags}}_getNeedsRedraw(e){if(!this.internalState)return!1;let r=!1;r=r||this.internalState.needsRedraw&&this.id;const n=this.getAttributeManager(),i=n?n.getNeedsRedraw(e):!1;if(r=r||i,r)for(const a of this.props.extensions)a.onNeedsRedraw.call(this,a);return this.internalState.needsRedraw=this.internalState.needsRedraw&&!e.clearRedrawFlags,r}_onAsyncPropUpdated(){this._diffProps(this.props,this.internalState.getOldProps()),this.setNeedsUpdate()}}$ne.defaultProps=mWe;$ne.layerName="Layer";class yWe extends yne{constructor(e){const{startPanPos:r,...n}=e;super(n),r!==void 0&&(this._state.startPanPos=r)}panStart({pos:e}){const{latitude:r,longitude:n,zoom:i}=this.getViewportProps();return this._getUpdatedState({startPanLngLat:[n,r],startPanPos:e,startZoom:i})}pan({pos:e,startPos:r}){const n=this.getState(),i=n.startPanLngLat||this._unproject(r);if(!i)return this;const a=n.startZoom??this.getViewportProps().zoom,s=n.startPanPos||r,o=[i[0],i[1],a],f=this.makeViewport(this.getViewportProps()).panByPosition(o,e,s);return this._getUpdatedState(f)}panEnd(){return this._getUpdatedState({startPanLngLat:null,startPanPos:null,startZoom:null})}zoom({scale:e}){const n=(this.getState().startZoom||this.getViewportProps().zoom)+Math.log2(e);return this._getUpdatedState({zoom:n})}applyConstraints(e){const{longitude:r,latitude:n,maxZoom:i,minZoom:a,zoom:s}=e,o=y0(0),c=y0(n)-o;return e.zoom=gd(s,a+c,i+c),(r<-180||r>180)&&(e.longitude=BVe(r+180,360)-180),e.latitude=gd(n,-md,md),e}}class vWe extends mne{constructor(){super(...arguments),this.ControllerState=yWe,this.transition={transitionDuration:300,transitionInterpolator:new y6(["longitude","latitude","zoom"])},this.dragMode="pan"}setProps(e){super.setProps(e),this.dragRotate=!1,this.touchRotate=!1}}class qne extends gne{constructor(e={}){super(e)}getViewportType(e){return e.zoom>12?yy:m6}get ControllerType(){return vWe}}qne.displayName="GlobeView";const bx="mapbox",pk=512,_We=Math.PI/180;function A6({map:t,gl:e,deck:r}){if(t.__deck)return t.__deck;const n=r?.props._customRender,i=r?.props.onLoad,a={...r?.props,_customRender:()=>{t.triggerRepaint(),n?.("")}};a.parameters={...zS(t,!0),...a.parameters},a.views||(a.views=Rb(t));let s;return(!r||r.props.gl===e)&&(Object.assign(a,{gl:e,width:null,height:null,touchAction:"unset",viewState:xx(t)}),r?.isInitialized?qW(r,t):a.onLoad=()=>{i?.(),qW(s,t)}),r?(s=r,r.setProps(a),r.userData.isExternal=!0):(s=new _x(a),t.on("remove",()=>{Hne(t)})),s.userData.mapboxLayers=new Set,t.__deck=s,t.on("render",()=>{s.isInitialized&&CWe(s,t)}),s}function qW(t,e){const r=()=>{t.isInitialized?AWe(t,e):e.off("move",r)};e.on("move",r)}function Hne(t){t.__deck?.finalize(),t.__deck=null}function zS(t,e){const r=e?{depthWriteEnabled:!0,depthCompare:"less-equal",depthBias:0,blend:!0,blendColorSrcFactor:"src-alpha",blendColorDstFactor:"one-minus-src-alpha",blendAlphaSrcFactor:"one",blendAlphaDstFactor:"one-minus-src-alpha",blendColorOperation:"add",blendAlphaOperation:"add"}:{};return I6(t)==="globe"&&(r.cullMode="back"),r}function bWe(t,e){t.userData.mapboxLayers.add(e),k6(t)}function xWe(t,e){t.userData.mapboxLayers.delete(e),k6(t)}function wWe(t,e){k6(t)}function SWe(t,e,r,n){let{currentViewport:i}=t.userData,a=!1;i||(i=P6(t,e,n),t.userData.currentViewport=i,a=!0),t.isInitialized&&t._drawLayers("mapbox-repaint",{viewports:[i],layerFilter:s=>(!t.props.layerFilter||t.props.layerFilter(s))&&(r.id===s.layer.id||s.layer.props.operation.includes("terrain")),clearStack:a,clearCanvas:!1})}function EWe(t,e,r,n){let{currentViewport:i}=t.userData,a=!1;i||(i=P6(t,e,n),t.userData.currentViewport=i,a=!0),t.isInitialized&&t._drawLayers("mapbox-repaint",{viewports:[i],layerFilter:s=>{if(t.props.layerFilter&&!t.props.layerFilter(s))return!1;const o=s.layer;return o.props.beforeId===r.beforeId&&o.props.slot===r.slot},clearStack:a,clearCanvas:!1})}function I6(t){const e=t.getProjection?.(),r=e?.type||e?.name;if(r==="globe")return"globe";if(r&&r!=="mercator")throw new Error("Unsupported projection");return"mercator"}function Rb(t){return I6(t)==="globe"?new qne({id:bx}):new v6({id:bx})}function xx(t){const{lng:e,lat:r}=t.getCenter(),n={longitude:(e+540)%360-180,latitude:r,zoom:t.getZoom(),bearing:t.getBearing(),pitch:t.getPitch(),padding:t.getPadding(),repeat:t.getRenderWorldCopies()};return t.getTerrain?.()&&TWe(t,n),n}function TWe(t,e){if(t.getFreeCameraOptions){const{position:r}=t.getFreeCameraOptions();if(!r||r.z===void 0)return;const n=t.transform.height,{longitude:i,latitude:a,pitch:s}=e,o=r.x*pk,c=(1-r.y)*pk,f=r.z*pk,d=gx([i,a]),m=o-d[0],b=c-d[1],x=Math.sqrt(m*m+b*b),E=s*_We,T=1.5*n,A=E<.001?T*Math.cos(E)/f:T*Math.sin(E)/x;e.zoom=Math.log2(A);const M=T*Math.cos(E)/A,F=f-M;e.position=[0,0,F/LS(a)]}else typeof t.transform.elevation=="number"&&(e.position=[0,0,t.transform.elevation])}function P6(t,e,r){const n=xx(e),{views:i}=t.props,a=i&&Dg(i).find(c=>c.id===bx)||Rb(e);r&&(a.props.nearZMultiplier=.2);const s=r?.nearZ??e.transform._nearZ,o=r?.farZ??e.transform._farZ;return Number.isFinite(s)&&(n.nearZ=s/e.transform.height,n.farZ=o/e.transform.height),a.makeViewport({width:t.width,height:t.height,viewState:n})}function CWe(t,e){const{mapboxLayers:r,isExternal:n}=t.userData;if(n){const i=Array.from(r,d=>d.id),s=Dg(t.props.layers,Boolean).some(d=>d&&!i.includes(d.id));let o=t.getViewports();const c=o.findIndex(d=>d.id===bx),f=o.length>1||c<0;(s||f)&&(c>=0&&(o=o.slice(),o[c]=P6(t,e)),t._drawLayers("mapbox-repaint",{viewports:o,layerFilter:d=>(!t.props.layerFilter||t.props.layerFilter(d))&&(d.viewport.id!==bx||!i.includes(d.layer.id)),clearCanvas:!1}))}t.userData.currentViewport=null}function AWe(t,e){t.setProps({viewState:xx(e)}),t.needsRedraw({clearRedrawFlags:!0})}function k6(t){if(t.userData.isExternal)return;const e=[];t.userData.mapboxLayers.forEach(r=>{const n=r.props.type,i=new n(r.props);e.push(i)}),t.setProps({layers:e})}class IWe{constructor(e){if(!e.id)throw new Error("Layer must have an unique id");this.id=e.id,this.type="custom",this.renderingMode=e.renderingMode||"3d",this.slot=e.slot,this.map=null,this.deck=null,this.props=e}onAdd(e,r){this.map=e,this.deck=A6({map:e,gl:r,deck:this.props.deck}),bWe(this.deck,this)}onRemove(){this.deck&&xWe(this.deck,this)}setProps(e){Object.assign(this.props,e,{id:this.id}),this.deck&&wWe(this.deck)}render(e,r){SWe(this.deck,this.map,this,r)}}const gk="__UNDEFINED__";function PWe(t,e,r,n){if(!t||!e||!t.style||!t.style._loaded)return;const i=Dg(n,Boolean);if(r!==n){const o=Dg(r,Boolean),c=new Set(o.map(f=>f.id));for(const f of i)c.delete(f.id);for(const f of c)t.getLayer(f)&&t.removeLayer(f)}for(const o of i){const c=t.getLayer(o.id);c?(c.implementation||c).setProps(o.props):t.addLayer(new IWe({id:o.id,deck:e,slot:o.props.slot}),o.props.beforeId)}const a=t.style._order,s={};for(const o of i){let{beforeId:c}=o.props;(!c||!a.includes(c))&&(c=gk),s[c]=s[c]||[],s[c].push(o.id)}for(const o in s){const c=s[o];let f=o===gk?a.length:a.indexOf(o),d=o===gk?void 0:o;for(let m=c.length-1;m>=0;m--){const b=c[m],x=a.indexOf(b);x!==f-1&&(t.moveLayer(b,d),x>f&&f++),f--,d=b}}}class kWe{constructor(e){El(e.id,"id is required"),this.id=e.id,this.type="custom",this.renderingMode=e.renderingMode||"3d",this.slot=e.slot,this.beforeId=e.beforeId,this.map=null,this.deck=null}onAdd(e,r){this.map=e,this.deck=A6({map:e,gl:r})}render(e,r){!this.deck||!this.map||EWe(this.deck,this.map,this,r)}}const mk="__UNDEFINED__";function yk(t){return t.props.beforeId?`deck-layer-group-before:${t.props.beforeId}`:t.props.slot?`deck-layer-group-slot:${t.props.slot}`:"deck-layer-group-last"}function RWe(t,e,r){if(!t||!t.style||!t.style._loaded)return;const n=Dg(r,Boolean);if(e!==r){const s=Dg(e,Boolean),o=new Set(s.map(f=>yk(f))),c=new Set(n.map(f=>yk(f)));for(const f of o)c.has(f)||t.getLayer(f)&&t.removeLayer(f)}const i={};for(const s of n){const o=yk(s),c=t.getLayer(o);if(c){const f=c.implementation||c;i[o]=f}else{const f=new kWe({id:o,slot:s.props.slot,beforeId:s.props.beforeId});i[o]=f,t.addLayer(f,s.props.beforeId)}}const a=t.style._order;for(const[s,o]of Object.entries(i)){const c=o.beforeId||mk,f=c===mk?a.length:a.indexOf(c);if(a.indexOf(s)!==f-1){const m=c===mk?void 0:c;t.moveLayer(s,m)}}}class MWe{constructor(e){this._handleStyleChange=()=>{if(this._resolveLayers(this._map,this._deck,this._props.layers,this._props.layers),!this._map)return;I6(this._map)&&!this._props.views&&this._deck?.setProps({views:Rb(this._map)})},this._updateContainerSize=()=>{if(this._map&&this._container){const{clientWidth:n,clientHeight:i}=this._map.getContainer();Object.assign(this._container.style,{width:`${n}px`,height:`${i}px`})}},this._updateViewState=()=>{const n=this._deck,i=this._map;n&&i&&(n.setProps({views:this._props.views||Rb(i),viewState:xx(i)}),n.isInitialized&&n.redraw())},this._handleMouseEvent=n=>{const i=this._deck;if(!i||!i.isInitialized)return;const a={type:n.type,offsetCenter:n.point,srcEvent:n},s=this._lastMouseDownPoint;switch(!n.point&&s&&(a.deltaX=n.originalEvent.clientX-s.clientX,a.deltaY=n.originalEvent.clientY-s.clientY,a.offsetCenter={x:s.x+a.deltaX,y:s.y+a.deltaY}),a.type){case"mousedown":i._onPointerDown(a),this._lastMouseDownPoint={...n.point,clientX:n.originalEvent.clientX,clientY:n.originalEvent.clientY};break;case"dragstart":a.type="panstart",i._onEvent(a);break;case"drag":a.type="panmove",i._onEvent(a);break;case"dragend":a.type="panend",i._onEvent(a);break;case"click":a.tapCount=1,i._onEvent(a);break;case"dblclick":a.type="click",a.tapCount=2,i._onEvent(a);break;case"mousemove":a.type="pointermove",i._onPointerMove(a);break;case"mouseout":a.type="pointerleave",i._onPointerMove(a);break;default:return}};const{interleaved:r=!1}=e;this._interleaved=r,this._renderLayersInGroups=e._renderLayersInGroups||!1,this._props=this.filterProps(e)}filterProps(e){const{interleaved:r=!1,useDevicePixels:n,...i}=e;return!r&&n!==void 0&&(i.useDevicePixels=n),i}setProps(e){this._interleaved&&e.layers&&this._resolveLayers(this._map,this._deck,this._props.layers,e.layers),Object.assign(this._props,this.filterProps(e)),this._deck&&this._map&&this._deck.setProps({...this._props,parameters:{...zS(this._map,this._interleaved),...this._props.parameters}})}onAdd(e){return this._map=e,this._interleaved?this._onAddInterleaved(e):this._onAddOverlaid(e)}_onAddOverlaid(e){const r=document.createElement("div");return Object.assign(r.style,{position:"absolute",left:0,top:0,textAlign:"initial",pointerEvents:"none"}),this._container=r,this._deck=new _x({...this._props,parent:r,parameters:{...zS(e,!1),...this._props.parameters},views:this._props.views||Rb(e),viewState:xx(e)}),e.on("resize",this._updateContainerSize),e.on("render",this._updateViewState),e.on("mousedown",this._handleMouseEvent),e.on("dragstart",this._handleMouseEvent),e.on("drag",this._handleMouseEvent),e.on("dragend",this._handleMouseEvent),e.on("mousemove",this._handleMouseEvent),e.on("mouseout",this._handleMouseEvent),e.on("click",this._handleMouseEvent),e.on("dblclick",this._handleMouseEvent),this._updateContainerSize(),r}_onAddInterleaved(e){const r=e.painter.context.gl;return r instanceof WebGLRenderingContext&&po.warn("Incompatible basemap library. See: https://deck.gl/docs/api-reference/mapbox/overview#compatibility")(),this._deck=A6({map:e,gl:r,deck:new _x({...this._props,gl:r,parameters:{...zS(e,!0),...this._props.parameters}})}),e.on("styledata",this._handleStyleChange),this._resolveLayers(e,this._deck,[],this._props.layers),document.createElement("div")}_resolveLayers(e,r,n,i){this._renderLayersInGroups?RWe(e,n,i):PWe(e,r,n,i)}onRemove(){const e=this._map;e&&(this._interleaved?this._onRemoveInterleaved(e):this._onRemoveOverlaid(e)),this._deck=void 0,this._map=void 0,this._container=void 0}_onRemoveOverlaid(e){e.off("resize",this._updateContainerSize),e.off("render",this._updateViewState),e.off("mousedown",this._handleMouseEvent),e.off("dragstart",this._handleMouseEvent),e.off("drag",this._handleMouseEvent),e.off("dragend",this._handleMouseEvent),e.off("mousemove",this._handleMouseEvent),e.off("mouseout",this._handleMouseEvent),e.off("click",this._handleMouseEvent),e.off("dblclick",this._handleMouseEvent),this._deck?.finalize()}_onRemoveInterleaved(e){e.off("styledata",this._handleStyleChange),this._resolveLayers(e,this._deck,this._props.layers,[]),Hne(e)}getDefaultPosition(){return"top-left"}pickObject(e){return El(this._deck),this._deck.pickObject(e)}pickMultipleObjects(e){return El(this._deck),this._deck.pickMultipleObjects(e)}pickObjects(e){return El(this._deck),this._deck.pickObjects(e)}finalize(){this._map&&this._map.removeControl(this)}getCanvas(){return this._map?this._interleaved?this._map.getCanvas():this._deck.getCanvas():null}}const DWe="deckgl-layer",Gne=gt.createContext({}),AD=({mapId:t,children:e})=>{const r=va({mapId:t}),n=te.useRef(void 0),[i,a]=te.useState([]),[s,o]=te.useState([]);te.useEffect(()=>{if(r.map)return n.current=new MWe({id:DWe,interleaved:!0}),r.map.addControl(n.current),()=>{n.current&&r.map?.removeControl(n.current),n.current=void 0}},[r.map]),te.useEffect(()=>{n.current&&n.current.setProps({layers:[...i],effects:[...s]})},[i,s]);const c={deckGlLayerArray:i,setDeckGlLayerArray:a,deckGlEffectArray:s,setDeckGlEffectArray:o};return J.jsx(Gne.Provider,{value:c,children:e})};try{AD.displayName="DeckGlContextProvider",AD.__docgenInfo={description:"",displayName:"DeckGlContextProvider",props:{mapId:{defaultValue:null,description:"",name:"mapId",required:!0,type:{name:"string"}}}}}catch{}const fXe=[(t,e)=>{const r=te.useMemo(()=>FX(e?.globals?.theme),[e?.globals?.theme]);return J.jsx("div",{className:"fullscreen_map",children:J.jsx(Pk,{children:J.jsxs(LX,{theme:r,children:[J.jsx(AD,{mapId:e.mapId,children:J.jsx(t,{})}),J.jsx(zX,{options:e?.parameters?.mapOptions?{style:"https://wms.wheregroup.com/tileserver/style/osm-bright.json",...e.parameters.mapOptions}:{zoom:14.5,style:"https://wms.wheregroup.com/tileserver/style/osm-bright.json",center:[7.0851268,50.73884]},mapId:"map_1"}),J.jsx(uM,{showZoomButtons:!1,mapId:"map_1"})]})})})}];function hXe(){const t=te.useContext(Gne);function e(a){t.setDeckGlEffectArray(s=>[...s,a])}function r(a){t.setDeckGlEffectArray(s=>s.filter(o=>o!==a))}function n(a){t.setDeckGlLayerArray(s=>[...s,a])}function i(a){t.setDeckGlLayerArray(s=>s.filter(o=>o!==a))}return{addEffect:e,removeEffect:r,addLayer:n,removeLayer:i}}export{Ure as $,UWe as A,VWe as B,Xa as C,va as D,hXe as E,fXe as F,cXe as G,Bf as H,l_ as I,IGe as J,eGe as K,i2 as L,ET as M,P_ as N,Dg as O,Gm as P,yc as Q,rn as R,W3 as S,Fl as T,wT as U,N7e as V,$m as W,Mg as X,c8e as Y,jWe as Z,DL as _,nf as a,ZWe as a0,YWe as a1,Z7e as a2,my as a3,rje as a4,Y7e as a5,XP as a6,tXe as a7,rXe as a8,iXe as a9,eXe as aa,aXe as ab,Hre as ac,U7e as ad,KWe as ae,W7e as af,tje as ag,JWe as ah,nXe as ai,OS as aj,Bre as ak,oXe as al,l2 as am,tre as an,BBe as ao,fze as ap,ho as aq,XWe as b,uf as c,WWe as d,GWe as e,$ne as f,uXe as g,Ad as h,a_ as i,QWe as j,PG as k,px as l,po as m,HWe as n,qWe as o,lXe as p,G7e as q,V7e as r,Rh as s,B7e as t,oT as u,z7e as v,R7e as w,YM as x,R8e as y,gd as z};
